[2014-02-01 00:06:59 -0500] glen: is there difference of @new_resource and new_resource in lrwp?
[2014-02-01 00:25:08 -0500] sbrinkmeyer: hello
[2014-02-01 00:25:21 -0500] Majost: Does chefspec support the .and compound matcher expression?
[2014-02-01 00:26:00 -0500] Majost: I am getting a undefined method error -- but I would expect chefspec to add to the rspec-expectations instead of replace it
[2014-02-01 00:26:02 -0500] sbrinkmeyer: has anyone used groovy (gradle) to get at chef data bags?
[2014-02-01 00:27:34 -0500] sbrinkmeyer: i guess groovy could pull in jruby, then groovy could connect to the kitchen ....
[2014-02-01 00:27:50 -0500] Majost: why would you do that?
[2014-02-01 00:27:54 -0500] Majost: that sounds painful
[2014-02-01 00:28:26 -0500] Majost: why not just use the client to dump it as json and parse it from gradle?
[2014-02-01 00:28:54 -0500] Majost: granted its a shell out.. but its probably a lot less of a headache.
[2014-02-01 00:34:52 -0500] sbrinkmeyer: heh
[2014-02-01 00:34:59 -0500] sbrinkmeyer: we we gradle
[2014-02-01 00:35:22 -0500] sbrinkmeyer: we want to do smoke test running in our continuous integration environment
[2014-02-01 00:35:36 -0500] sbrinkmeyer: so you have a build agent running gradle on a chef controled build agent
[2014-02-01 00:36:10 -0500] sbrinkmeyer: you could write a task that loads the environment, node, database, connection information from the agent for the build integration test to use
[2014-02-01 00:36:25 -0500] sbrinkmeyer: without hardcoding a properties file
[2014-02-01 00:36:32 -0500] sbrinkmeyer: but ... you make a good point
[2014-02-01 00:36:33 -0500] lukecarrier: urgh
[2014-02-01 00:36:47 -0500] lukecarrier: Chef on Ubuntu 14.04 is totally broken
[2014-02-01 00:37:09 -0500] lukecarrier: nice that opscode kept apt.opscode.com up to date
[2014-02-01 00:39:27 -0500] Majost: lukecarrier: You can't use the omnibus installer?
[2014-02-01 00:40:03 -0500] Majost: I really don't know -- I haven't tried 14.04 with Chef just yet.
[2014-02-01 00:42:20 -0500] fleish: hi all, I have an iptables template defined in a firewall recipe. it specifics "notifies :restart, "service[firewall]"" which I thought should only trigger the restart if the resulting iptables template file has changed - however it seems to be triggering every time the chef recipe runs.
[2014-02-01 00:42:27 -0500] lukecarrier: Majost, if the website wasn't screwed I'd try
[2014-02-01 00:42:45 -0500] lukecarrier: the packages Canonical ship have broken dependencies, though
[2014-02-01 00:42:57 -0500] troyready: Broken on 14.04 you mean?
[2014-02-01 00:43:07 -0500] lukecarrier: correct
[2014-02-01 00:43:11 -0500] Majost: yeah, don't use their debs
[2014-02-01 00:43:23 -0500] lukecarrier: well, opscode don't even build any
[2014-02-01 00:43:23 -0500] troyready: Ah -- what's different now in 14.04 that's breaking it?
[2014-02-01 00:43:33 -0500] lukecarrier: lord knows what happened to apt.opscode.com, that's an absolute joke
[2014-02-01 00:43:47 -0500] lukecarrier: troyready, ruby-net-ssh-multi
[2014-02-01 00:43:52 -0500] Majost: lukecarrier:  https://opscode-omnibus-packages.s3.amazonaws.com/ubuntu/13.04/x86_64/chef_11.8.2-1.ubuntu.13.04_amd64.deb
[2014-02-01 00:44:04 -0500] lukecarrier: Majost, tried that exact package IIRC
[2014-02-01 00:44:05 -0500] Majost: Assuming you want 11.8.2 and AMD64
[2014-02-01 00:44:14 -0500] troyready: Well, it's stale and shouldn't be around anymore, but it's not suprising that the apt repo is out of date. It's no longer supported
[2014-02-01 00:44:27 -0500] Majost: that *should* work on 14.04 even though its for 13.04/13.10
[2014-02-01 00:45:18 -0500] Majost: also can try this: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2014-02-01 00:45:38 -0500] Majost: the latter basically pulls down the deb for you.
[2014-02-01 00:46:03 -0500] troyready: What's different about ruby-net-ssh-multi in trusty? Does the deb specifically require < 1.2 or something?
[2014-02-01 00:46:16 -0500] lukecarrier: troyready, yep, I cba screwing around patching it
[2014-02-01 00:46:32 -0500] lukecarrier: if it's broke, I'll drop chef-solo in favour of something less dep-heavy
[2014-02-01 00:47:12 -0500] lukecarrier: canonical dropped it and re-adopted in the space of a year and I hate opscode's approach to releases, just cba rewriting everything
[2014-02-01 00:47:34 -0500] Majost: troyready: I would advise against the ubuntu/debian packages for any of it though and opt for the omnibus version. Its updated more frequently and gets security fixes faster
[2014-02-01 00:47:58 -0500] lukecarrier: Majost, what is the difference?
[2014-02-01 00:48:01 -0500] troyready: Majost, I think we're having some terminology issue
[2014-02-01 00:48:14 -0500] Majost: Omnibus basically has all the ruby deps self-contained
[2014-02-01 00:48:15 -0500] troyready: the install.sh is still installing Chef via a debian package file
[2014-02-01 00:48:16 -0500] lukecarrier: I'm sure opscode could use apt properly if they tried
[2014-02-01 00:48:38 -0500] Majost: ah, yes -- true
[2014-02-01 00:49:04 -0500] troyready: lukecarrier, I'm sure you're right, and I actually agree -- it's not exactly what I'd prefer
[2014-02-01 00:49:06 -0500] Majost: When I reference the ubuntu/debian packages -- I mean the ones in their apt repo
[2014-02-01 00:49:31 -0500] Majost: not the .deb distributed by the company formally known as Opscode
[2014-02-01 00:49:42 -0500] troyready: :)
[2014-02-01 00:50:24 -0500] Majost: and their apt repo, I mean canonical and debian.org
[2014-02-01 00:51:29 -0500] troyready: Hmm, where in a deb are the dependencies set? I'm trying to find the problem in the omnibus package and i don't see any dependencies listed in the control file
[2014-02-01 00:51:34 -0500] Majost: Honestly, I think they could still have maintained an apt repo in s3 with reprepro.
[2014-02-01 00:51:55 -0500] Majost: but whatever... its at least a deb.
[2014-02-01 00:52:21 -0500] fleish: yeah, but it might as well be a tarball ;)
[2014-02-01 00:52:22 -0500] lukecarrier: troyready, sorry, I'm being a dick. it's not in the actual deb control file, but you get a rubygems error on executing any chef* command
[2014-02-01 00:52:23 -0500] troyready: And the install script seems like it's generic enough to keep working. lukecarrier, what is the exact ruby-net-ssh-multi error that's coming up?
[2014-02-01 00:52:50 -0500] Majost: troyready: they are all bundled within
[2014-02-01 00:52:59 -0500] lukecarrier: "could not find net-ssh-multi (~> 1.1.0)"
[2014-02-01 00:53:04 -0500] Majost: it really comes down to the fact that ruby is not a compiled language
[2014-02-01 00:53:09 -0500] glen: 02:06:59  glen> is there difference of @new_resource and new_resource in lrwp?
[2014-02-01 00:53:21 -0500] fleish: anyone have any ideas on what's causing my firewall service restart posted above
[2014-02-01 00:53:43 -0500] troyready: lukecarrier, sounds like you also have the chef gem installed in your system or profile?
[2014-02-01 00:53:55 -0500] fleish: am I wildly misunderstanding notifies? seems like I'm using them in lots of other places and the restart/reload/$action only takes place if something changes
[2014-02-01 00:53:58 -0500] lukecarrier: troyready, nope, just net-ssh-multi 1.2
[2014-02-01 00:54:14 -0500] lukecarrier: this user acct has no rbenv/gems/rvm junk
[2014-02-01 00:54:22 -0500] lukecarrier: Majost, we run a legacy systems management system at work, written in python with about 40 deps
[2014-02-01 00:54:35 -0500] lukecarrier: Majost, we use system python and grab our deps via pip, it's never been an issue
[2014-02-01 00:54:36 -0500] troyready: lukecarrier, weird. So /opt/chef/bin/knife commands give the same error?
[2014-02-01 00:54:50 -0500] lukecarrier: troyready, yep
[2014-02-01 00:54:57 -0500] lukecarrier: we'll see what install.sh does
[2014-02-01 00:55:06 -0500] lukecarrier: it looks to be dling newer packages so maybe all will work
[2014-02-01 00:55:22 -0500] Majost: luke: great -- now try distributing that single piece of software with 40 deps to hundreds of thousands of customers.
[2014-02-01 00:55:25 -0500] Majost: ;)
[2014-02-01 00:55:41 -0500] lukecarrier: Majost, that's what dependencies and post-inst hooks are for
[2014-02-01 00:56:09 -0500] lukecarrier: I write software for a living, I work in chaotic open source ecosystems all day every day
[2014-02-01 00:56:10 -0500] lukecarrier: it's not hard
[2014-02-01 00:56:19 -0500] Majost: but porting the various deps to various platforms as deps and packages is not a small job
[2014-02-01 00:56:45 -0500] lukecarrier: Majost, true, so you build config profiles into your platforms and abstract over the differences
[2014-02-01 00:56:58 -0500] lukecarrier: it's not small, but with a good enough test suite it's not a massive problem either
[2014-02-01 00:57:31 -0500] Majost: I am confident they went through the options and found omnibus to be the best solution for the time being.
[2014-02-01 00:58:05 -0500] troyready: Yeah, I have to agree
[2014-02-01 00:58:18 -0500] Majost: This issue is the heart of why Packer is in go lang. Not my first choice for a solution, but I get it nevertheless.
[2014-02-01 00:58:32 -0500] troyready: Even as it is, so many support issues end up in here due to people's various ruby/gems configs
[2014-02-01 00:58:39 -0500] Majost: yep
[2014-02-01 00:58:48 -0500] lukecarrier: Ruby is terrible at dep management
[2014-02-01 00:59:01 -0500] lukecarrier: RubyGems is far too overengineered compared to other langsd
[2014-02-01 00:59:41 -0500] lukecarrier: Ruby is a wonderful lang, but I definitely would choose py3k and virtualenv over ruby 1.9 and rbenv
[2014-02-01 01:00:09 -0500] lukecarrier: I still think bundling so many deps is poor practice, but hey, I don't have time to fix it
[2014-02-01 01:00:14 -0500] Majost: I would argue, it's not the inability to manage dependencies as much as it is integrating complex systems of multiple software components which have their own deps is the issue
[2014-02-01 01:00:20 -0500] Majost: even python has this problem
[2014-02-01 01:00:46 -0500] lukecarrier: Majost, Python is considerably simpler in its approach; just bung the files into dirs on sys.path and stop caring
[2014-02-01 01:00:47 -0500] Majost: when you combine several projects together, somewhere along the line something is going to want a conflicting version
[2014-02-01 01:01:11 -0500] Majost: potentially with symbol mismatches
[2014-02-01 01:01:19 -0500] Majost: and who knows what else
[2014-02-01 01:01:41 -0500] lukecarrier: Majost, test suites will pick up on a screwup of that magnitude immediately
[2014-02-01 01:01:52 -0500] Majost: no doubt
[2014-02-01 01:02:01 -0500] Majost: but its not chef that had the issue per say
[2014-02-01 01:02:06 -0500] lukecarrier: no, it's ruby
[2014-02-01 01:02:26 -0500] Majost: Yes.
[2014-02-01 01:02:32 -0500] lukecarrier: gg s3 sucks
[2014-02-01 01:02:38 -0500] lukecarrier: 40kB/s
[2014-02-01 01:02:59 -0500] lukecarrier: not quite how I planned to spend my Friday night...
[2014-02-01 01:03:32 -0500] Majost: it varies... they primarily only guarantee data integrity... they have cloudfront for CDN
[2014-02-01 01:05:21 -0500] Majost: Anyone know if chefspec supports compound matcher expressions such as, ".and", and ".or"??
[2014-02-01 01:06:36 -0500] lukecarrier: "could not find mixlib-log"
[2014-02-01 01:07:25 -0500] lukecarrier: #omnibusfail
[2014-02-01 01:07:44 -0500] Majost: full error?
[2014-02-01 01:10:49 -0500] lukecarrier: Majost, http://pastebin.com/04kadYbd
[2014-02-01 01:11:22 -0500] Majost: That looks like it is using your system ruby.
[2014-02-01 01:11:27 -0500] Majost: which chef-solo
[2014-02-01 01:12:08 -0500] lukecarrier: /usr/local/bin/chef-solo
[2014-02-01 01:12:15 -0500] Majost: hrm
[2014-02-01 01:12:42 -0500] Majost: which ruby && ruby -v
[2014-02-01 01:12:46 -0500] troyready: I was curious, so I just installed the 2014-01-31 trusty server daily
[2014-02-01 01:13:18 -0500] troyready: Installed the chef omnibus deb via install.sh (pulled down the 13.04 version with the big warning about not being tested on 14.04)
[2014-02-01 01:13:53 -0500] troyready: Copied over my credentials and it seems to be working fine. At least for my 'knife role list's and what not
[2014-02-01 01:13:58 -0500] Majost: There is an RC1 of chef-client 11.10
[2014-02-01 01:14:00 -0500] Majost: one sec
[2014-02-01 01:14:33 -0500] Majost: curl -L "https://www.opscode.com/chef/install.sh <https://www.opscode.com/chef/install.sh>" | sudo bash -s -- -p 11.10.0.rc.0
[2014-02-01 01:14:42 -0500] lukecarrier: ' still fails: /opt/chef-server/embedded/bin/ruby /usr/local/bin/chef-solo
[2014-02-01 01:14:44 -0500] lukecarrier: same issue
[2014-02-01 01:14:57 -0500] Majost: huh
[2014-02-01 01:15:47 -0500] lukecarrier: tons of symlinks in /usr/local because opscode don't understand PATH very well, then all the actual omnibus junk is in /opt/chef
[2014-02-01 01:15:57 -0500] Majost: do you have a clean system without any system ruby stuff installed by any chance?
[2014-02-01 01:17:10 -0500] Majost: The tell I am looking at is: "/usr/lib/ruby/1.9.1/rubygems/dependency.rb"
[2014-02-01 01:17:13 -0500] lukecarrier: rbenv under other users, not this one
[2014-02-01 01:17:22 -0500] lukecarrier: system ruby is installed for other apps, can't remove
[2014-02-01 01:17:47 -0500] lukecarrier: I get the same error even when using the binary in  /opt/chef-server
[2014-02-01 01:17:55 -0500] Majost: It's definitely picking up the system stuff
[2014-02-01 01:19:57 -0500] troyready: Yeah, it definitely can't be just because the system packages are installed. I just installed the 'ruby' metapackage in my 14.04 vm, and it hasn't hampered me in using knife with my omnibus install
[2014-02-01 01:20:01 -0500] lukecarrier: -rwxr-xr-x 1 1001 bumblebee 12K Dec  4 11:09 /opt/chef-server/embedded/bin/ruby
[2014-02-01 01:20:08 -0500] lukecarrier: lol that's hilarious
[2014-02-01 01:20:24 -0500] Majost: yeah, thats what omnibus is
[2014-02-01 01:20:34 -0500] lukecarrier: apparently opscode can't check other packages to ensure their uids/gids don't conflict
[2014-02-01 01:20:35 -0500] Majost: it includes an isolated version of all the deps.
[2014-02-01 01:20:54 -0500] lukecarrier: bumblebee is responsible for optimus discrete/onboard switching
[2014-02-01 01:20:54 -0500] Majost: did you install it as root?
[2014-02-01 01:20:58 -0500] lukecarrier: yep
[2014-02-01 01:21:02 -0500] lukecarrier: as instructed
[2014-02-01 01:21:24 -0500] Majost: actually, I think that is a bug
[2014-02-01 01:22:04 -0500] Majost: shouldn't matter too much... but still.
[2014-02-01 01:22:39 -0500] troyready: Hmm, weird -- all my omnibus embedded/bin files are user:group 999. I wonder what's off in the package that's not making it root
[2014-02-01 01:23:02 -0500] Majost: they didn't use fakeroot to build it
[2014-02-01 01:23:22 -0500] Majost: so the uid/gid values in the package are set to the user which built the package
[2014-02-01 01:23:28 -0500] Majost: I am going to file this issue
[2014-02-01 01:23:34 -0500] Majost: good catch
[2014-02-01 01:23:58 -0500] lukecarrier: starting to believe I should trust canonical's judgement more than opscode's to be honest
[2014-02-01 01:24:07 -0500] lukecarrier: sure as hell put me off paying for "professional" services
[2014-02-01 01:24:36 -0500] lukecarrier: i expect this kind of lax approach to verification from intern frontend devs, not people developing infra management tools
[2014-02-01 01:26:41 -0500] lukecarrier: if I manually set RUBYLIB it finds its deps
[2014-02-01 01:27:01 -0500] resno: any book recommendations to learn chef?
[2014-02-01 01:27:04 -0500] lukecarrier: env | grep RUBY | wc -l #=> 0
[2014-02-01 01:27:41 -0500] lukecarrier: balls to it, I'll throw some aliases in to botch around it
[2014-02-01 01:29:52 -0500] troyready: As I said earlier, even with dead-simple omnibus packaging (mostly inconsequential but embarrassing uid assignment aside), people still are in here constantly with ruby problems. Mind boggling
[2014-02-01 01:30:12 -0500] chip-: Interesting, I just threw up a from-scratch OSS chef-server via the Vagrantfile at https://github.com/opscode-cookbooks/chef-server and /var/opt/chef-server is owned 1001:1001
[2014-02-01 01:30:22 -0500] chip-: and /var/opt/chef is owned 999:999
[2014-02-01 01:30:34 -0500] chip-: definitely recent bugs. Usually those are root:root
[2014-02-01 01:30:49 -0500] lukecarrier: troyready, so surely that proves that this ridiculous approach to dependency management also fails to solve the problem and, in my case, is just adding to the complexity totally unnecessarily
[2014-02-01 01:31:05 -0500] Majost: CHEF-4996 is created
[2014-02-01 01:31:12 -0500] Majost: I cant submit a fix for this obviously though
[2014-02-01 01:31:13 -0500] Majost: heh
[2014-02-01 01:31:38 -0500] lukecarrier: if opscode made a conscious effort to work with distribution maintainers I am certain they could make it work like every other open source project (on the whole!) manages
[2014-02-01 01:32:09 -0500] lukecarrier: this is just hermit kingdom behaviour, microsoft-level ignorance of the wider community
[2014-02-01 01:32:33 -0500] troyready: Well, you seem to have an opinion on how every design decision they've made is wrong -- I'm surprised that you can't take that knowledge and figure out what you changed on your system to cause the issues
[2014-02-01 01:33:34 -0500] lukecarrier: I know what changed, troyready. I did a dist upgrade to an alpha to see whether things worked, and they didn't until I started screwing around with the omnibus-installed ruby
[2014-02-01 01:34:20 -0500] lukecarrier: maybe if the scripts linked to /usr/local/bin actually had shebangs and added the chef paths in /opt properly, it might not bomb out ;-)
[2014-02-01 01:34:21 -0500] troyready: Hmm, I probably don't have as much experience as you, but just seems weird to me that my alpha install doesn't have the same reported issues
[2014-02-01 01:36:20 -0500] gsymons-di: So, I'm seeing something really weird... one of my nodes is refusing to pick up the latest version of one of its cookbooks.
[2014-02-01 01:36:56 -0500] lukecarrier: troyready, fresh install or upgrade?
[2014-02-01 01:37:03 -0500] gsymons-di: No constraints in the environment (it's the dev environment) and the cookbook and all its dependencies are on the server.
[2014-02-01 01:37:10 -0500] Majost: gsymons-di: you probably have it pinned to a version in the envrionment it is in
[2014-02-01 01:37:17 -0500] gsymons-di: Anybody ever see anything like that.
[2014-02-01 01:37:33 -0500] troyready: lukecarrier, fresh install
[2014-02-01 01:37:37 -0500] lukecarrier: there must be something funky in my env somewhere, but either way it's easily worked around in those files
[2014-02-01 01:38:10 -0500] lukecarrier: I did an upgrade from 13.10, so there's one window of opportunity for breakage
[2014-02-01 01:38:16 -0500] Majost: gsymons-di: check the node environment first, if that doesn't call out the specific version then you may want to check whatever is declaring the dependency to ensure its not set to a specific version
[2014-02-01 01:38:59 -0500] chip-: lukecarrier: Is there a berksfile lock around?
[2014-02-01 01:39:21 -0500] chip-: er, sorry
[2014-02-01 01:39:27 -0500] chip-: gsymons-di: berksfile.lock around?
[2014-02-01 01:39:46 -0500] Majost: that too
[2014-02-01 01:39:47 -0500] Majost: heh
[2014-02-01 01:39:47 -0500] troyready: yeah, I hear that. If you think the specific /usr/local/bin wrappers could be improved, I'd encourage you to sign the CLA and submit a pull request to improve them
[2014-02-01 01:39:52 -0500] gsymons-di: Maybe... but that shouldn't affect chef-client...
[2014-02-01 01:40:50 -0500] Majost: I'm out... ttyl.
[2014-02-01 01:43:17 -0500] gsymons-di: It's not a cookbook pulled in through a dependency. it's right there in the run list, and it's a top-level cookbook (i.e. nothing depends on it). I could understand if one of the dependencies wasn't getting updated because of a conflict, but there's nothing that can be conflicting here.
[2014-02-01 01:46:30 -0500] gsymons-di: Aha! I got it.
[2014-02-01 01:46:49 -0500] gsymons-di: It was a conflict in the dependencies... I just thought I'd resolved it.
[2014-02-01 01:46:56 -0500] chip-: gsymons-di: A+
[2014-02-01 01:47:24 -0500] gsymons-di: I had to delete all the older versions of the cookbook from the server to surface it.
[2014-02-01 01:48:13 -0500] chip-: Ouch.
[2014-02-01 01:49:52 -0500] gsymons-di: I wish there was a better way to find these problems. Something like an ivy resolutions report would be nice.
[2014-02-01 01:50:14 -0500] lukecarrier: chip-, not that I can see
[2014-02-01 02:04:34 -0500] dogmover: using the clinet install script, it connects, and does the download starts "Starting Chef Client..., but ends with Creating a new client identity for compute1 using the validator key.
[2014-02-01 02:04:34 -0500] dogmover: [2014-01-31T20:03:52-06:00] ERROR: Connection refused connecting to 10.0.2.15:443 for /clients, retry 1/5
[2014-02-01 02:04:35 -0500] dogmover:  and both machines end with
[2014-02-01 02:05:18 -0500] dogmover: Is that something to do with the chef server not accepting their credentials?
[2014-02-01 02:55:32 -0500] sethvargo: Ohai Chefs! I just released ChefSpec v3.2.0 https://github.com/sethvargo/chefspec/releases/tag/v3.2.0
[2014-02-01 05:09:42 -0500] salimkapadia: hello
[2014-02-01 05:13:17 -0500] mrconfused: hey guys i just reboostraped my node and then did knife node edit nodename and added the recipe under the run list
[2014-02-01 05:13:27 -0500] mrconfused: i logged into the node and did sudo chef-client
[2014-02-01 05:13:43 -0500] mrconfused: access its coobooks (HTTP 403).
[2014-02-01 05:13:45 -0500] mrconfused: To access its cookbooks, a client needs to be able to read its environment and
[2014-02-01 05:13:46 -0500] mrconfused: all of the cookbooks in its expanded run list.
[2014-02-01 05:14:45 -0500] mrconfused: This client is not authorized to read some of the information required to access its coobooks (HTTP 403).
[2014-02-01 05:14:52 -0500] mrconfused: what is the issue ?
[2014-02-01 08:28:01 -0500] sneak: hey, is there a way to make "knife node run_list add" work without a chef server? i just want it to edit my json node file in nodes/ for chef-solo
[2014-02-01 08:28:23 -0500] sneak: i'm trying to script a "make a new vm, knife solo prepare it, add the base role, then converge it" process
[2014-02-01 14:01:42 -0500] Maddeth: Afternoon all
[2014-02-01 14:02:00 -0500] Maddeth: or morning/evening wherever you are
[2014-02-01 14:04:20 -0500] Maddeth: I'm trying to determine what management software to use, I have looked at puppet, bcfg2 and CFEngine, I was wondering if anyone could give me reason why you would use Chef over them.
[2014-02-01 14:04:43 -0500] Maddeth: I am still in the early stages of research, but want to choose one to build by infrastructure around
[2014-02-01 14:17:10 -0500] zaargy: Maddeth: you can do teh same with all of them but chef has the most active community and that's a huge benefit
[2014-02-01 14:17:28 -0500] zaargy: it is the most advacned when it comes to doing tdd of infrastructure etc
[2014-02-01 14:18:05 -0500] zaargy: and i would say with chef server it's the easiest solution to sharing node info with other nodes (to populate load balancers etc)
[2014-02-01 14:18:41 -0500] zaargy: with puppet you are constantly fighting the dsl and it is known to have some massive flaws
[2014-02-01 14:19:00 -0500] Maddeth: thanks zaargy, that's helpful
[2014-02-01 14:19:35 -0500] Maddeth: I think I have pretty much narrowed it to chef, but wanted from input from the community
[2014-02-01 14:20:36 -0500] Maddeth: and being a Saturday wasn't exactly expecting a response :)
[2014-02-01 14:26:07 -0500] mornap_: qq, I'm trying to set up a short training session with hosted chef, can someone provide me with the Hosted Chef IP addresses/ports I will need open up ACLs to so hosted chef can talk to servers in my network?
[2014-02-01 14:26:22 -0500] mornap_: or point me to some documentation.
[2014-02-01 14:44:04 -0500] Maddeth: I have no idea what I am doing, but is this any help mornap_? http://status.opscode.com/post/34859232768/ip-change-for-hosted-chef
[2014-02-01 15:05:51 -0500] mornap_: Thanks Maddeth, that looks like what I was looking for.  I'm training a small group of 5 on my team and wanted to use our Corporate vSphere environment, but need to open up the connectivity from hosted chef to it.
[2014-02-01 15:07:53 -0500] mornap_: I assume port 443 will need to be opened, anyone know of any other ports that Hosted Chef need/uses to connect to clients?
[2014-02-01 15:14:20 -0500] Maddeth: not a clue sorry mornap_
[2014-02-01 16:15:43 -0500] andrew____: Hey, newbie question - I'm trying to configure a Rails app with chef-solo, and I'm kinda drowning in options.  Which of the various cookbooks do I want?
[2014-02-01 16:18:25 -0500] aujt74: andrew____: application_ruby is probably the best starting point for that. That handles deploying the app itself from SCM.
[2014-02-01 16:19:18 -0500] andrew____: Thanks aujt74, I'll concentrate on bashing my head against that particular brick wall then :)
[2014-02-01 16:19:26 -0500] aujt74: After that, your choice of cookbook depends on what stack you are using. For instance: passenger_apache2, apache2, postgresql.
[2014-02-01 16:21:15 -0500] aujt74: No problem. Make sure you refer to the application cookbook as well, the _ruby flavour inherits a lot of it's functionality from that. e.g. the _ruby README might not mention a particular option but that doesn't mean you can't use it because it's inherited from the application cookbook :)
[2014-02-01 16:21:42 -0500] andrew____: I'm stuck on the error "Cannot find a resource for apt_installed? on ubuntu version 13.10", and Google isn't being particularly helpful.  Is there a good place to go to decode these error messages?
[2014-02-01 16:22:12 -0500] aujt74: Error from a chef run andrew____?
[2014-02-01 16:22:50 -0500] andrew____: aujt74: yeah, sudo chef-solo -c solo.rb -j web.json
[2014-02-01 16:24:15 -0500] aujt74: what's the run list in web.json?
[2014-02-01 16:25:33 -0500] andrew____: { "run_list": ["recipe[web]"] }
[2014-02-01 16:25:46 -0500] andrew____: The actual script is copy/pasted from http://www.concreteinteractive.com/how-to-deploy-a-rails-application-anywhere-with-chef/
[2014-02-01 16:27:04 -0500] aujt74: Ok, and the apt cookbook is avaliable in the cookbook path set in solo.rb?
[2014-02-01 16:29:19 -0500] andrew____: aujt74: So far as I can tell - solo.rb is as described in the "Chef Solo" section on that page, and `ls cookbooks/apt/` shows the expected.
[2014-02-01 16:34:59 -0500] aujt74: andrew____: Hmm, well, apt_installed? is just this: https://github.com/opscode-cookbooks/apt/blob/master/libraries/helpers.rb#L26
[2014-02-01 16:36:00 -0500] aujt74: Stupid question: does "which apt-get" actually return the path to apt-get on your system, right?
[2014-02-01 16:36:49 -0500] andrew____: Yeah.
[2014-02-01 16:40:23 -0500] andrew____: Ah, so it's not that apt-get isn't found, it's that the function "apt_installed?" isn't found.
[2014-02-01 16:40:34 -0500] aujt74: Hmm, anyway that's irrelevant since it's not finding it. Coming back to that error message, "Cannot find a resource for apt_installed? on ubuntu version 13.10"....
[2014-02-01 16:41:16 -0500] aujt74: Yeah andrew____. I'd forgotten what the error message was :P
[2014-02-01 16:42:35 -0500] aujt74: One last try before I need to head off. Can you post a link to the chef-solo output? Pastebin, github gist etc
[2014-02-01 16:43:15 -0500] andrew____: http://pastebin.com/V2h6b2ve
[2014-02-01 16:45:43 -0500] aujt74: Ok, and "/home/ubuntu/chef-repo/cookbooks/apt/libraries/helpers.rb" exists right? With a definition of "apt_installed?" as that Github link?
[2014-02-01 16:45:53 -0500] aujt74: apt cookbook version 2.3.4?
[2014-02-01 16:46:31 -0500] andrew____: Yes `grep apt_installed /home/ubuntu/chef-repo/cookbooks/apt/libraries/helpers.rb` shows what you'd expect.
[2014-02-01 16:46:47 -0500] aujt74: Well, I'm stumped.
[2014-02-01 16:46:56 -0500] andrew____: Oh well, at least it's not just me :)
[2014-02-01 16:47:03 -0500] andrew____: Thanks anyway.
[2014-02-01 16:47:57 -0500] aujt74: It's clearly loading the apt cookbook since it's executing the default recipe, so I can't imagine a reason why it can't access helpers.rb in libraries...
[2014-02-01 16:49:11 -0500] aujt74: Anyway, good luck with it andrew____. I'm sure someone else will be able to solve it if you don't before then :)
[2014-02-01 19:47:36 -0500] MindfulMonk: Hi, I narrowed my decision to Chef or Ansible, but can't find any good comparisons of them. Can someone help me decide which one to pick?
[2014-02-01 20:35:46 -0500] lumbendil: hi
[2014-02-01 20:37:44 -0500] lumbendil: how can you call a command defined in another file? In my case, the recipe apt defines apt-get update, and I want to force a call on that. I usually used "notifies" but I noticed that include_recipe ignores that
[2014-02-01 20:41:14 -0500] jbz: lumbendil: If it is being defined in the 'definitions' file, you should be able to call it like a resource from any other recipe in the runlist...
[2014-02-01 20:42:11 -0500] jbz: lumbendil: but I'm not sure you're talking about Chef definitions.  Are you using the community apt cookbook?
[2014-02-01 20:44:39 -0500] jbz: If your'e talking about the execute resource in apt::default (the second one), you can notify it from another cookbook's code.  You don't need to use include_recipe during the notify, so long as the recipe which defines it has been called either from the runlist or from an include_recipe call prior to the notification.
[2014-02-01 20:44:41 -0500] jbz: (I think).
[2014-02-01 20:46:28 -0500] lumbendil: jbz, sorry, I got distracted
[2014-02-01 20:46:32 -0500] lumbendil: I know about notifying
[2014-02-01 20:46:34 -0500] lumbendil: the thing is
[2014-02-01 20:46:46 -0500] lumbendil: I need to call it after an include_recipe
[2014-02-01 20:47:16 -0500] lumbendil: mongodb::10gen_repo, which includes the apt repository
[2014-02-01 20:47:32 -0500] jbz: I see, so you first have to set up the repo and then call it?
[2014-02-01 20:47:35 -0500] jbz: ok
[2014-02-01 20:47:36 -0500] jbz: no problem
[2014-02-01 20:47:48 -0500] lumbendil: the thing is, doing: http://pastebin.com/tAt7hTi7
[2014-02-01 20:47:53 -0500] lumbendil: didn't notifie
[2014-02-01 20:48:01 -0500] lumbendil: didn't notify*
[2014-02-01 20:48:18 -0500] jbz: 1) put the community apt cookbook in the runlist prior to the mongodb cookbook.  That'll run its default, and set up apt
[2014-02-01 20:49:04 -0500] jbz: 2) use that notify.  It should work, because the prior run of the apt cookbook has defined the execute resource to be notified.
[2014-02-01 20:49:07 -0500] lumbendil: the thing is, default defines the execute with action :nothing so it's not called
[2014-02-01 20:49:21 -0500] jbz: you notify it with an action
[2014-02-01 20:49:37 -0500] lumbendil: include_recipe is considered an action?
[2014-02-01 20:49:44 -0500] jbz: no, :run is
[2014-02-01 20:49:47 -0500] jbz: hm
[2014-02-01 20:49:47 -0500] jbz: wait
[2014-02-01 20:49:49 -0500] jbz: one sec
[2014-02-01 20:49:55 -0500] jbz: oh
[2014-02-01 20:50:00 -0500] jbz: I don't think include_recipe is a resource
[2014-02-01 20:50:05 -0500] jbz: so I don't think you can notify on that
[2014-02-01 20:50:07 -0500] lumbendil: I meant if "include_recipe" can define notifies
[2014-02-01 20:50:13 -0500] lumbendil: :(
[2014-02-01 20:50:20 -0500] lumbendil: so how should I trigger it?
[2014-02-01 20:50:34 -0500] lumbendil: dummy execute?
[2014-02-01 20:50:39 -0500] jbz: you can just create an execute resource that doesn't do anything but that notifies it to execute
[2014-02-01 20:50:44 -0500] jbz: yeah, that should work
[2014-02-01 20:50:54 -0500] jbz: I'm looking here though, hm
[2014-02-01 20:51:05 -0500] jbz: so what you're trying to do is have the mongodb recipe set up its repo, right?
[2014-02-01 20:51:08 -0500] jbz: and then do an update?
[2014-02-01 20:51:10 -0500] lumbendil: yes
[2014-02-01 20:51:28 -0500] jbz: is that a community cookbook? That recipe should do the update when it sets up the repo
[2014-02-01 20:51:36 -0500] lumbendil: I expected it to do so
[2014-02-01 20:51:44 -0500] lumbendil: it's not from opscode-cookbooks
[2014-02-01 20:51:58 -0500] lumbendil: didn't find any recipe for mongodb there
[2014-02-01 20:52:21 -0500] jbz: oh wait
[2014-02-01 20:52:23 -0500] jbz: no
[2014-02-01 20:52:31 -0500] lumbendil: http://community.opscode.com/cookbooks/mongodb found it here
[2014-02-01 20:52:32 -0500] jbz: the apt cookbook itself should call an update
[2014-02-01 20:52:44 -0500] jbz: after adding a new repo using the provider in the apt cookbook
[2014-02-01 20:53:05 -0500] lumbendil: but I don't think that cookbook uses the provider in the apt cookbook
[2014-02-01 20:53:11 -0500] jbz: ohhhhh
[2014-02-01 20:53:12 -0500] jbz: hmm
[2014-02-01 20:53:15 -0500] jbz: looking
[2014-02-01 20:53:19 -0500] lumbendil: though it depends on it
[2014-02-01 20:53:49 -0500] lumbendil: it doesn't have a notify
[2014-02-01 20:55:28 -0500] jbz: uh
[2014-02-01 20:55:36 -0500] jbz: it calls apt_repository
[2014-02-01 20:55:50 -0500] lumbendil: yup, I saw that, but it has no notify
[2014-02-01 20:55:51 -0500] lumbendil: :S
[2014-02-01 20:55:57 -0500] jbz: no
[2014-02-01 20:55:59 -0500] jbz: shouldn't matter
[2014-02-01 20:56:06 -0500] jbz: it calls the *provider* repository in the apt cookbook
[2014-02-01 20:56:11 -0500] jbz: (apt_repository)
[2014-02-01 20:56:18 -0500] jbz: and as part of the :add action for that provider,
[2014-02-01 20:56:25 -0500] jbz: the apt cookbook code calls an update
[2014-02-01 20:56:30 -0500] lumbendil: maybe it's delayed?
[2014-02-01 20:57:17 -0500] lumbendil: or maybe I have an old version of apt cookbook
[2014-02-01 20:57:25 -0500] jbz: it's flagged immediately, if a flag to rebuild the cache is set
[2014-02-01 20:57:27 -0500] jbz: look here:
[2014-02-01 20:57:27 -0500] jbz: https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb
[2014-02-01 20:57:32 -0500] jbz: in the "action :add" section
[2014-02-01 20:57:59 -0500] jbz: The 'file' resource that sets up the new repo file in /etc/apt/repos.d has a notify to the apt-get update resource
[2014-02-01 20:58:21 -0500] jbz: ahve you tried just adding the repo and seeing if it updates, without you calling something?
[2014-02-01 20:58:22 -0500] lumbendil: if new_resource.cache_rebuild
[2014-02-01 20:58:25 -0500] jbz: Does that error out?
[2014-02-01 20:58:32 -0500] lumbendil: yup
[2014-02-01 20:58:51 -0500] lumbendil: I'm using vagrant, give me a second and I give you a paste of my full main recipe
[2014-02-01 20:59:13 -0500] jbz: ha so
[2014-02-01 20:59:14 -0500] jbz: wait
[2014-02-01 20:59:32 -0500] jbz: it looks like you might need to add a cache_rebuild TRUE into the mongodb recipe code that calls apt_repository
[2014-02-01 20:59:45 -0500] jbz: No, wait
[2014-02-01 20:59:46 -0500] jbz: I'm wrong
[2014-02-01 20:59:48 -0500] jbz: ok
[2014-02-01 21:00:00 -0500] jbz: cache_rebuild is set to TRUE by default in the apt cookbooks' repository provider
[2014-02-01 21:00:00 -0500] jbz: ok
[2014-02-01 21:00:31 -0500] jbz: so you should just be able to run the mongodb::10gen_repo recipe, and it *should just work*
[2014-02-01 21:01:20 -0500] lumbendil: jbz, http://pastebin.com/wNJXNZ5s
[2014-02-01 21:01:27 -0500] lumbendil: this is my main file
[2014-02-01 21:01:38 -0500] lumbendil: and when doing a vagrant up, after destroying the VM to ensure clean state
[2014-02-01 21:02:56 -0500] bettyclamp: knife is not updating environments, i.e., this doesn't work: "knife environment from file foo.rb". Any idea why?
[2014-02-01 21:03:28 -0500] jbz: bettyclamp: Any errors being pitched?
[2014-02-01 21:03:33 -0500] bettyclamp: The response at the command line says the env was updated, but the chef server itself shows no change.
[2014-02-01 21:04:09 -0500] jbz: bettyclamp: so knife environment show immediately afterward doesn't reflect the changes?
[2014-02-01 21:06:19 -0500] lumbendil: jbz, http://pastebin.com/4XM3vRNR log, the cookbook I showed you goes kaboom
[2014-02-01 21:06:30 -0500] lumbendil: the recipe i showed you*
[2014-02-01 21:08:20 -0500] jbz: lumbendil: looking
[2014-02-01 21:09:18 -0500] lumbendil: [2014-02-01T21:05:00+00:00] INFO: execute[install-key 7F0CEB10] ran successfully
[2014-02-01 21:09:42 -0500] lumbendil: it creates the 10gen.list file, but doesn't update the cache, thus messing it up :(
[2014-02-01 21:10:08 -0500] lumbendil: on another case, when using gearman, I had to write the notifies :inmediately myself
[2014-02-01 21:12:56 -0500] bettyclamp: jbz: nvm, my foo.rb had an error inside it.
[2014-02-01 21:13:02 -0500] jbz: bettyclamp: ah.
[2014-02-01 21:13:35 -0500] jbz: lumbendil: still looking, sorry
[2014-02-01 21:15:09 -0500] lumbendil: jbz, no hurry, you're doing a lot already by looking into it, thanks :D
[2014-02-01 21:15:29 -0500] lumbendil: jbz, burn me
[2014-02-01 21:15:40 -0500] lumbendil: I updated the apt cookbook
[2014-02-01 21:15:44 -0500] lumbendil: and it's working
[2014-02-01 21:15:49 -0500] lumbendil: sorry for wasting your time :(
[2014-02-01 21:16:04 -0500] jbz: no problem :-)
[2014-02-01 21:16:07 -0500] jbz: glad it's working
[2014-02-01 21:16:16 -0500] jbz: always ask, better to ask.
[2014-02-01 21:21:20 -0500] lumbendil: well, development environment setup, I should do some coding now :P
