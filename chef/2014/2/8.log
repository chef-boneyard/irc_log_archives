[2014-02-08 00:11:30 -0500] strictlyb: anyone here using openstack that has a moment to chat?
[2014-02-08 01:53:07 -0500] zbp: If my chef managed nodes are on a different subnet than the chef server do I only have to open port 443 from managed node to server?
[2014-02-08 01:53:22 -0500] zbp: old documentation says port 4000 but netstat on my chef server shows 4000 not open
[2014-02-08 02:07:47 -0500] storme_away: so i'm somewhat confused. i have two servers, one OSC and one PEC. i'm running berks upload on the same set of cookbooks to both servers. the PEC upload runs fine, but there's one cookbook that is erroring out on the open source chef server with a ridley sandbox crash. any ideas what to look into? other cbs upload fine, it's just crashing out on this one.
[2014-02-08 02:08:32 -0500] stormerider: zbp: chef 11 defaults to 443, yes
[2014-02-08 02:08:45 -0500] zbp: thx
[2014-02-08 02:08:57 -0500] stormerider: zbp: 10 used 4000 and something else i can't remember offhand
[2014-02-08 02:09:22 -0500] zbp: so um, do I have to do anything to harden the chef server?
[2014-02-08 02:09:35 -0500] zbp: is the web administration feature available by default?
[2014-02-08 02:09:39 -0500] zbp: if my managed node is in a dmz
[2014-02-08 02:09:51 -0500] binamov`: zbp also see this http://docs.opscode.com/server_firewalls_and_ports.html
[2014-02-08 02:10:11 -0500] zbp: if it gets compromised, I don't want the compromised node in the DMZ to access tho admin panel of chef server via 443
[2014-02-08 03:00:34 -0500] phutchin1: exit
[2014-02-08 03:00:38 -0500] phutchin1: ewps
[2014-02-08 04:07:28 -0500] resno: im confused, ive got version 3.0.4 of yum installed and on upload im getting Cookbook nagios depends on cookbook 'yum' version '< 3.0'
[2014-02-08 04:17:14 -0500] atomic-penguin: resno, welcome to hell, dependency hell
[2014-02-08 04:19:23 -0500] resno: i dunno how but i got it shaken out
[2014-02-08 04:19:43 -0500] resno: dependencies are always fun
[2014-02-08 15:46:23 -0500] pythonsnake: hi
[2014-02-08 15:48:03 -0500] pythonsnake: I have still not read documentation about cookbooks yet, but is it right to assume that I can find runit nginx script in there?
[2014-02-08 15:48:06 -0500] pythonsnake: https://github.com/opscode-cookbooks/nginx
[2014-02-08 15:50:18 -0500] cheeseplus: pythonsnake: there is runit support for the source build
[2014-02-08 15:50:33 -0500] bean__: https://github.com/opscode-cookbooks/nginx/blob/ffbf353d57b51589a0a5d77be783e97bce32178b/recipes/source.rb#L117
[2014-02-08 15:50:55 -0500] cheeseplus: you'll need to have the runit cookbook available as well though
[2014-02-08 15:51:49 -0500] pythonsnake: hm, so it is like automatically built from a template by chef?
[2014-02-08 15:52:00 -0500] pythonsnake: this deploy thing concept intrigues me
[2014-02-08 15:53:49 -0500] cheeseplus: pythonsnake: the nginx recipe loads the runit recipe which has an LWRP for creating the runit files necessary
[2014-02-08 15:53:53 -0500] cheeseplus: runit_service 'nginx'
[2014-02-08 15:53:56 -0500] pythonsnake: so if I got it right, chef is like a bot to which i provide system templates so it builds a "clone system" for me?
[2014-02-08 15:54:18 -0500] cheeseplus: it's a configuration management system
[2014-02-08 15:54:51 -0500] cheeseplus: you could think of it like that but it's actually going through and building things out (installing packages, setting configs, restarting services)
[2014-02-08 15:59:29 -0500] pythonsnake: awesome
[2014-02-08 15:59:43 -0500] pythonsnake: hm, does it make sense to use it for only one server?
[2014-02-08 16:01:23 -0500] cheeseplus: pythonsnake: definitely
[2014-02-08 16:01:43 -0500] cheeseplus: the idea is that you can easily move or rebuild the server without having to remember all the things you tweaked
[2014-02-08 16:04:03 -0500] cheeseplus: also makes developing locally very easy if you're using something like vagrant
[2014-02-08 16:05:43 -0500] pythonsnake: cheeseplus: but with a single server instance do I still need server/client?
[2014-02-08 16:06:04 -0500] cheeseplus: pythonsnake: nope you can use chef-solo
[2014-02-08 16:06:26 -0500] cheeseplus: or if you wanted the server stuff you can used Hosted Chef
[2014-02-08 16:11:59 -0500] pythonsnake: cheeseplus: awesome, I understand now :D
[2014-02-08 16:12:15 -0500] cheeseplus: have fun ;)
[2014-02-08 16:12:30 -0500] pythonsnake: one last thing I've been wondering.. can we install recipes/pkgs to local directories?
[2014-02-08 16:12:39 -0500] pythonsnake: as in our /home or something without root
[2014-02-08 16:13:24 -0500] cheeseplus: well you could have the cookbook do that if you configured it as such (that is more of an installing from source issue)
[2014-02-08 16:13:41 -0500] cheeseplus: but the chef-client/chef-solo is usually executed as root (so you can install stuff)
[2014-02-08 16:14:24 -0500] cheeseplus: pythonsnake: but you can run chef-client as non-root as shown here: http://docs.opscode.com/ctl_chef_client.html#run-as-non-root-user
[2014-02-08 16:15:19 -0500] pythonsnake: so in a case where I have to execute it as non-root, I'll just have to replace the config vars so I dont touch anything rootish right?
[2014-02-08 16:15:20 -0500] cheeseplus: the recipes themselves aren't exactly installed, they do get copied to a directory (when using chef-client and server) but they are just instructions
[2014-02-08 16:15:29 -0500] cheeseplus: pythonsnake: yep
[2014-02-08 16:15:49 -0500] cheeseplus: most chef cookbooks expect root though
[2014-02-08 16:16:07 -0500] cheeseplus: so you might have to modify cookbooks or use a "wrapper" cookbook to change things
[2014-02-08 16:17:39 -0500] someara: pythonsnake its possible to run chef as non-root, but it severly cripples it
[2014-02-08 16:18:37 -0500] cheeseplus: ^
[2014-02-08 16:18:51 -0500] someara: you'll be %100 custom in everything you do
[2014-02-08 16:19:28 -0500] pythonsnake: cheeseplus: hm, according to that doc we still need one node running as root?
[2014-02-08 16:19:36 -0500] someara: you may be able to use the yum cookbook to configure yum to install packages into a chroot
[2014-02-08 16:19:48 -0500] someara: but the services facility is still going to want root
[2014-02-08 16:20:03 -0500] someara: you can specify commands to manipulate processes
[2014-02-08 16:20:05 -0500] someara: etc
[2014-02-08 16:21:16 -0500] someara: avoiding root on ephemeral nodes is usually techological shamanism unless you're bound by some external compliance policy
[2014-02-08 16:22:10 -0500] someara: http://c59951.r51.cf2.rackcdn.com/5849-61823-couch.pdf
[2014-02-08 16:23:06 -0500] pythonsnake: someara: but for the services thing there are service manager that allows non-root lik erunit?
[2014-02-08 16:23:29 -0500] someara: the runit cookbook can run things as non-root, sure
[2014-02-08 16:23:39 -0500] someara: but to configure runit to do that in the first place, you'll need root
[2014-02-08 16:23:46 -0500] someara: egg, meet chicken.
[2014-02-08 16:24:23 -0500] someara: so can systemd, upstart, and old fashioned sysV init scripts
[2014-02-08 16:24:46 -0500] pythonsnake: well I have already a runit instance set up by my admin to run stuff as non-root
[2014-02-08 16:24:57 -0500] someara: awesome.
[2014-02-08 16:24:59 -0500] pythonsnake: is that enough?
[2014-02-08 16:25:14 -0500] someara: if she set it up correctly, sure
[2014-02-08 16:25:24 -0500] pythonsnake: she? lol
[2014-02-08 16:25:42 -0500] someara: =)
[2014-02-08 16:28:11 -0500] pythonsnake: hm, why is that shamanism? sometimes you just don't get root access lol
[2014-02-08 16:28:35 -0500] pythonsnake: "What's wrong with that?" indeed
[2014-02-08 16:29:23 -0500] someara: if you're running your processes as user bob, its operating on data as user bob, your files are owned by user bob, etc
[2014-02-08 16:29:29 -0500] someara: you dont need root
[2014-02-08 16:29:54 -0500] someara: you're just creating huge pains in your ass
[2014-02-08 16:30:12 -0500] someara: imho
[2014-02-08 16:31:16 -0500] someara: now, if its a long running machine with multiple users and persistent databass
[2014-02-08 16:31:19 -0500] someara: then its another story
[2014-02-08 16:32:53 -0500] someara: also root gives you access to raw sockets and the ability to put interfaces into promisc mode, etc
[2014-02-08 16:32:59 -0500] someara: do it depends on the situation
[2014-02-08 16:33:05 -0500] someara: s/do/so/
[2014-02-08 16:34:39 -0500] pythonsnake: well this server is "shared"
[2014-02-08 16:34:57 -0500] pythonsnake: for example those public shells where you dont get root
[2014-02-08 16:35:04 -0500] pythonsnake: it makes sense to use shamnism
[2014-02-08 16:35:39 -0500] pythonsnake: anyways, thanks for all the answers :D
[2014-02-08 16:35:51 -0500] someara: well in that case its not shaminism =)
[2014-02-08 16:36:29 -0500] pythonsnake: glad you agree haha, i thought i was about to get beaten by arguments lol
[2014-02-08 16:38:44 -0500] kewubenduben: There's a bug in chef 11.10.0, where do I report it?
[2014-02-08 16:40:20 -0500] juliancdunn: kewubenduben: tickets.opscode.com
[2014-02-08 16:42:26 -0500] kewubenduben: juliancdunn, thanks
[2014-02-08 16:54:48 -0500] zeknox: i feel like im missing something in the workflow when using berkshelf + vagrant, once I have a kitchen created, how can I deploy with knife solo?
[2014-02-08 17:08:35 -0500] cheeseplus: zeknox: typically you'll run "kitchen test REGEX" which will either succeed or fail
[2014-02-08 17:08:58 -0500] cheeseplus: that creates, tests, and if successful destroys the kitchen
[2014-02-08 17:09:52 -0500] zeknox: so im having issues seeing the big picture here... im creating cookbooks, receipes, etc using berkshelf methodologies, running vagrant up and VM is getting deployed the way I want... now what is the next step to get that onto a production system
[2014-02-08 17:10:38 -0500] cheeseplus: so kitchen (test-kitchen) is just a testing framework
[2014-02-08 17:11:11 -0500] zeknox: cheeseplus: ok, i think i used wrong terminology when i stated kitchen
[2014-02-08 17:11:22 -0500] cheeseplus: gotcha
[2014-02-08 17:11:25 -0500] cheeseplus: was wondering that
[2014-02-08 17:11:32 -0500] zeknox: cheeseplus: im working off this guide http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-02-08 17:11:55 -0500] zeknox: im at the step of upload cookbooks, and im not certain if I want to use hosted chef, so now i dont know what to do
[2014-02-08 17:12:32 -0500] cheeseplus: so that would be the next step
[2014-02-08 17:12:47 -0500] cheeseplus: if you don't want to setup your own chef server or use hosted chef, then your option is to use chef-solo
[2014-02-08 17:13:11 -0500] cheeseplus: berkshelf can vendor the cookbooks into a bundle that you can run chef-solo against
[2014-02-08 17:14:26 -0500] cheeseplus: zeknox: http://spin.atomicobject.com/2013/01/03/berks-simplifying-chef-solo-cookbook-management-with-berkshelf/
[2014-02-08 17:15:15 -0500] zeknox: cheeseplus: thanks man, haven't read that yet, but might be what I need
[2014-02-08 17:15:42 -0500] zeknox: this chef world is so large in some ways, that its so difficult to perform simple tasks at times (atleast until I figure out the ways of the force)
[2014-02-08 17:15:47 -0500] cheeseplus: there is also berkshelf-solo but I haven't used it
[2014-02-08 17:15:47 -0500] cheeseplus: https://github.com/kontera-technologies/berkshelf-solo
[2014-02-08 17:16:18 -0500] zeknox: cheeseplus: thanks man, stay tuned, gonna start reading the article
[2014-02-08 17:16:20 -0500] cheeseplus: zeknox: there are a lot of ways to use it
[2014-02-08 17:16:53 -0500] zeknox: cheeseplus: yeah i see that, all i want is a simple rails + psql + redis + application on a single box
[2014-02-08 17:26:09 -0500] zeknox: cheeseplus: so i read the article you posted, my question is that knife solo uses node files in my experiences, this article mentions nothing about that?
[2014-02-08 17:28:25 -0500] cheeseplus: then this might help: http://www.captnswing.net/2013/01/from-vagrant-to-ec2-with-knife-solo.html
[2014-02-08 17:30:04 -0500] cheeseplus: zeknox: I've not actually used knife-solo myself in ages (I'm almost always working with a Chef server if it's going to prod)
[2014-02-08 17:30:25 -0500] zeknox: cheeseplus: should I just bite the bullet and use chef hosted to learn?
[2014-02-08 17:30:46 -0500] zeknox: seems like every tutorial i try to follow uses some form of hosted and then i can finish the walkthrough guide
[2014-02-08 17:30:56 -0500] zeknox: can't*
[2014-02-08 17:31:50 -0500] cheeseplus: you certainly can but the last step isn't really that bad, knife-solo is just not as common
[2014-02-08 17:32:09 -0500] zeknox: cheeseplus: hosted chef is free for like 5 nodes right?
[2014-02-08 17:32:39 -0500] cheeseplus: zeknox: at one point it was, not sure if it's changed - I'm still running my free account with 3 nodes
[2014-02-08 17:33:28 -0500] zeknox: cheeseplus: how do you typically go about tuning the community cookbooks? for example, you want to create a default account with psql, or edit the hba_conf file, etc...
[2014-02-08 17:34:43 -0500] cheeseplus: zeknox: wrapper cookbooks
[2014-02-08 17:34:59 -0500] cheeseplus: part of the berkshelf way ;)
[2014-02-08 17:35:43 -0500] zeknox: this learning curve is killing me...
[2014-02-08 17:36:11 -0500] cheeseplus: zeknox: http://www.getchef.com/blog/2013/11/19/chef-roles-arent-evil/
[2014-02-08 17:36:21 -0500] cheeseplus: I'll give you the tl;dr
[2014-02-08 17:36:27 -0500] bettyclamp: The attributes in one of my wrapper cookbooks doesn't seem to be overriding those in the wrapped cookbook. Any ideas why?
[2014-02-08 17:36:52 -0500] bettyclamp: Everything's properly uploaded to the server, environments are set right, etc....but no joy :-(
[2014-02-08 17:37:11 -0500] cheeseplus: bettyclamp: attribute precedence may be biting you
[2014-02-08 17:38:00 -0500] cheeseplus: also depends where you're including the recipe in the wrapper and where you're trying to set the attribute in the wrapper
[2014-02-08 17:39:13 -0500] cheeseplus: zeknox: the wrapper cookbooks are more explicit ways to do what roles can do
[2014-02-08 17:39:43 -0500] cheeseplus: zeknox: wrapper cookbooks make it easier to manage community dependencies so you aren't hacking up/forking the community ones and then never pulling from upstream
[2014-02-08 17:39:58 -0500] geggam: chef-server is easy to install
[2014-02-08 17:40:07 -0500] geggam: opensource version that is
[2014-02-08 17:40:11 -0500] bettyclamp: cheeseplus: the attributes in both wrapper and wrapped are default, and I'm just copying what I did in other wrappers (that do work). I must be making some other kind of mistake?
[2014-02-08 17:40:23 -0500] zeknox: cheeseplus: are wrapper cookbooks like overiding the defaults?
[2014-02-08 17:40:39 -0500] cheeseplus: zeknox: so instead of having three cookbooks that you apply, you have one wrapper that loads three cookbooks/recipes and then does anything else custom you want that isn't in the community cookbooks
[2014-02-08 17:41:02 -0500] cheeseplus: zeknox: they can do that but they can also do more if you want them to
[2014-02-08 17:41:13 -0500] zeknox: cheeseplus: do you typically define this wrapper cookbook in Berksfile, or where should it go?
[2014-02-08 17:42:33 -0500] cheeseplus: the wrapper can go in the berksfile or it could just exist in your chef repo
[2014-02-08 17:43:24 -0500] cheeseplus: zeknox: julian also wrote a post on this that was helpful for me: http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-02-08 17:44:52 -0500] zeknox: cheeseplus: thanks for all the resources, ive been reading through them as i can
[2014-02-08 17:45:15 -0500] cheeseplus: np, there is a learning curve and I remember being there
[2014-02-08 17:46:04 -0500] someara: ug I hate chef-rewind with such a hot firey passion
[2014-02-08 17:46:45 -0500] zeknox: cheeseplus: yeah man, this is one of the toughest things I've tried to tackle, tried it 2 weeks ago and felt defeated by the end of the weekend, this is round II
[2014-02-08 17:47:52 -0500] cheeseplus: zeknox: trial and error is your friend here
[2014-02-08 17:48:30 -0500] zeknox: cheeseplus: you mind if i pm?
[2014-02-08 17:49:59 -0500] bettyclamp: cheeseplus (or anyone else): both wrapped and wrapper attributes are 'default'. Is that what's wrong? (If so, why is it working in my other wrappers?)
[2014-02-08 17:50:31 -0500] cheeseplus: bettyclamp: then they'll be evaluated in order, I'd honestly use node.set in the wrapper cookbooks
[2014-02-08 17:50:48 -0500] bettyclamp: cheeseplus: ok, thanks, I'll try that.
[2014-02-08 17:51:43 -0500] cheeseplus: bettyclamp: precedence level interaction being unpredictable (it's not but sometimes seems magic) is one of the reasons why wrapper cookbooks came onto the scene
[2014-02-08 18:34:02 -0500] zeknox: how can i create 2 users when installing postgres, this json doesn't appear to work properly:  http://pastie.org/8712568
[2014-02-08 18:38:32 -0500] epcim: Anybody who uses test-kitchen, chef-zero, search, encrypted_databags? I am running knife search within the VM, the search from CLI returns encrypted entries. The provisioning do not fined entries in databags.
[2014-02-08 18:52:36 -0500] bettyclamp: I'm trying to figure out how to express conditionals in the logstash cookbook. It's README (https://github.com/lusis/chef-logstash) has a section on conditionals that says very little and instead shows a cryptic example (what language is that? Not Ruby. Not logstash conf. Not JSON. So, what?). Anyone have any clues?
[2014-02-08 18:52:48 -0500] bettyclamp: (It's -> Its)
[2014-02-08 19:07:32 -0500] bettyclamp: My bad (it's an alternative Ruby syntax).
[2014-02-08 19:19:07 -0500] thun_: How do I create a function... like the apache2 recipe, where I could call it like myRecipeFunction do blah blah blah end
[2014-02-08 19:20:33 -0500] jbz: thun_:  If your function exists primarily to group resources together to use common data, check out Definitions: http://docs.opscode.com/essentials_cookbook_definitions.html
[2014-02-08 19:22:00 -0500] thun_: jbz: ty perfect
[2014-02-08 19:22:11 -0500] jbz: Great! Glad it helped. :-)
[2014-02-08 19:45:51 -0500] bettyclamp: Can someone help me understand the 'Conditional' section of https://github.com/lusis/chef-logstash? Why does the block in that example not need to be associated with a key? Logstash predictably throws error when I try to associate a fake key with it. Help would be much appreciated.
[2014-02-08 19:53:11 -0500] bettyclamp: Nvm, solved it.
[2014-02-08 21:14:36 -0500] plasku: I am using knife search on several different servers, and getting different results. I have no idea why. What am I doing wrong? Let me paste some examples.
[2014-02-08 21:18:18 -0500] plasku: http://pastebin.com/XPUdSQ09 -- missing information, http://pastebin.com/ieTJv1rW -- full information
[2014-02-08 21:19:51 -0500] plasku: What can make knife search give so different answers on different machines?
[2014-02-08 21:21:40 -0500] jbz: plasku: are you sure you're using the same version of knife and the same gemset on both machines?
[2014-02-08 23:11:04 -0500] gaulia: can anyone help me figure out why chefspec is giving me the error "Cookbook build-essential:: not found." Here is my Berksfile, metadata, and recipes paste. http://pastie.org/private/wzqpus68xkpg8485wwhtwg
[2014-02-08 23:11:16 -0500] gaulia: getting spec paste..
[2014-02-08 23:17:57 -0500] gaulia: http://pastie.org/private/kqsvj3a11kgif4yfzvuiw spec_helper, spec/webserver.rb, and output from chefspec coverage
[2014-02-08 23:18:14 -0500] gaulia: I guess I just don't understand because i'm including depends 'build-essential'
[2014-02-08 23:18:18 -0500] gaulia: but that's its complaint
[2014-02-08 23:18:24 -0500] gaulia: berks says its there too
[2014-02-08 23:29:44 -0500] tjr9898: extra s in the metadata.rb
[2014-02-08 23:29:55 -0500] tjr9898: gaulia: ^^
[2014-02-08 23:47:30 -0500] gaulia: tjr9898: aw I actually just changed that as a test, it is literally still giving that error without the s
