[2014-02-27 00:16:41 -0500] icarus: what would the opposite value of "include_recipe 'cookbook::recipe'" be?
[2014-02-27 00:16:50 -0500] icarus: for a file.rb
[2014-02-27 00:17:04 -0500] icarus: to specifically remove a recipe inclusion
[2014-02-27 00:18:31 -0500] flaccid: i don't think thats possible but i'm not sure why you do it
[2014-02-27 00:18:58 -0500] icarus: i suppose i could simply remove the include line, and that recipe wouldn't be included
[2014-02-27 00:19:14 -0500] icarus: im running the community apache2 cookbook
[2014-02-27 00:19:29 -0500] icarus: which for some reason has mod_pagespeed set to install by default
[2014-02-27 00:19:43 -0500] icarus: im trying to get that not to be the case through a vendor custom cookbook
[2014-02-27 00:19:47 -0500] flaccid: weird
[2014-02-27 00:21:07 -0500] icarus: mod_pagespeed is causing a ton of php white pages on some client sites
[2014-02-27 00:23:33 -0500] silk: chef-rewind will let you modify or remove a resource
[2014-02-27 00:23:44 -0500] silk: but I dont think it edits the run_list
[2014-02-27 00:25:57 -0500] coderanger: icarus: There is no generic thing, but for that cookbook in particular you can set a node attribute (via a role or wrapper cookbook too) to change the default module
[2014-02-27 00:34:51 -0500] flaccid: is node['hostname'] basically hostname --fqdn?
[2014-02-27 00:35:50 -0500] coderanger: flaccid: No, that would be node['fqdn']
[2014-02-27 00:35:56 -0500] coderanger: hostname is the hostname
[2014-02-27 00:36:05 -0500] flaccid: hostname = from_cmd("hostname")
[2014-02-27 00:36:08 -0500] flaccid: i see
[2014-02-27 00:36:11 -0500] coderanger: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/hostname.rb#L115-L122
[2014-02-27 00:36:12 -0500] coderanger: yep
[2014-02-27 00:37:02 -0500] flaccid: hmm, it does do hostname -s in some cases
[2014-02-27 00:37:24 -0500] flaccid: is there a node attribute for hostname -s specifically?
[2014-02-27 00:38:19 -0500] coderanger: flaccid: Read that code I just posted :P
[2014-02-27 00:39:10 -0500] flaccid: do you really think i'm that smart and you are here for me hehe
[2014-02-27 00:39:56 -0500] flaccid: i guess it is right # hostname : short hostname
[2014-02-27 00:40:10 -0500] flaccid: hostname from_cmd("hostname -s")
[2014-02-27 00:43:00 -0500] icarus: i really appreciate the input from you guys over the last few days, it has pointed me in the right direction many times
[2014-02-27 00:50:21 -0500] tscanausa: is anyone else using knife ssh and password prompting?
[2014-02-27 03:04:54 -0500] pushnell: if anyone is alive, I'm perplexed by my sudden lack of knife-ec2 after upgrading to the latest chef omnibus on my workstation .... http://pastebin.com/RCmuhnP2
[2014-02-27 03:06:46 -0500] juliancdunn: what's the output of 'which gem' ?
[2014-02-27 03:12:30 -0500] pushnell: juliancdunn: /usr/bin/gem
[2014-02-27 03:15:11 -0500] flaccid: path is wrong i guess if it was in your omnibus env
[2014-02-27 03:15:39 -0500] juliancdunn: yup
[2014-02-27 03:15:52 -0500] flaccid: unless its a symlink
[2014-02-27 03:16:13 -0500] flaccid: but i don't think we actually symlnk gem or set GEM_* or anything
[2014-02-27 03:16:17 -0500] flaccid: thats your own install
[2014-02-27 03:16:30 -0500] juliancdunn: yeah, the omnibus installer won't make a symlink to /usr/bin/gem
[2014-02-27 03:16:41 -0500] juliancdunn: so chances are, that's the system ruby
[2014-02-27 03:17:47 -0500] flaccid: it does do this though /usr/bin/knife: symbolic link to `/opt/chef/bin/knife'
[2014-02-27 03:18:06 -0500] juliancdunn: that's correct, it does do knife, and chef-client
[2014-02-27 03:19:06 -0500] flaccid: the shebang used in that script is #!/usr/bin/env ruby
[2014-02-27 03:20:10 -0500] pushnell: so should I do `/opt/chef/embedded/bin/gem install` ?
[2014-02-27 03:20:43 -0500] flaccid: i'm thinkin maybe
[2014-02-27 03:20:48 -0500] pushnell: heh
[2014-02-27 03:20:48 -0500] pushnell: k
[2014-02-27 03:20:51 -0500] flaccid: i have not actually installed gems for it heh
[2014-02-27 03:21:00 -0500] flaccid: me not a good person to advise on this subject
[2014-02-27 03:22:04 -0500] juliancdunn: pushnell: yes, do /opt/chef/embedded/bin/gem install knife-ec2
[2014-02-27 03:22:08 -0500] juliancdunn: then you should be good to go
[2014-02-27 03:22:30 -0500] pushnell: today has been one of those days where you end up fixing the yak shear sharpener handle adjustment tool guidance system
[2014-02-27 03:24:09 -0500] juliancdunn: too long to OH
[2014-02-27 03:24:22 -0500] juliancdunn: ;-)
[2014-02-27 03:24:56 -0500] flaccid: ruby, the land of different
[2014-02-27 03:29:34 -0500] pushnell: ok, `knife ec2` exists again.
[2014-02-27 03:29:37 -0500] pushnell: thanks everyone
[2014-02-27 03:29:49 -0500] flaccid: coolio
[2014-02-27 06:48:36 -0500] nikkie: Just upgraded base box 12.04 to 13.10, and upgraded chef along with because of virtualbox issues.  Now my php recipe won't start.  Any ideas?  Error is: Ran /etc/init.d/php5-fpm stop returned 1
[2014-02-27 06:49:18 -0500] nikkie: When I run sudo /etc/init.d/php5-fpm stop in the vm it executes without error.
[2014-02-27 06:53:08 -0500] Koti: permission issue?
[2014-02-27 07:27:05 -0500] nikkie: turns out php5-fpm doesn't allow to be started with init in 13.10, which is the default provider.  Fixed with this: https://github.com/fxposter/cookbook-php-fpm/commit/d7c90229846367ac2e07dcd3dc4584bab91dae20
[2014-02-27 07:35:42 -0500] flaccid: nikkie: that looks pretty messy but i guess its not your cookbook
[2014-02-27 07:35:43 -0500] flaccid: i found this a good way to support that kind of thing https://github.com/xhost-cookbooks/system/blob/master/providers/hostname.rb#L38
[2014-02-27 07:36:14 -0500] nikkie: flaccid: yeah, since I know I am on 13.10 I just hard-coded the provider.
[2014-02-27 07:37:02 -0500] flaccid: ubuntu has used upstart for ages, not sure what changed, maybe they removed their sysv compat
[2014-02-27 07:37:55 -0500] flaccid: systemd > upstart
[2014-02-27 07:53:26 -0500] nikkie: is there a correct way to enable the multiverse with opscode apt package?  It says it is enabled by default, but definitely wasn't for me.
[2014-02-27 07:54:56 -0500] flaccid: nikkie: use https://github.com/opscode-cookbooks/apt#apt_repository
[2014-02-27 07:56:37 -0500] nikkie: flaccid: awesome, thanks.
[2014-02-27 09:16:23 -0500] gnagno: hello
[2014-02-27 09:17:27 -0500] gnagno: I made a system install of rvm using the fnichol/chef-rvm cookbook, the problem is that not all users in the server can use rvm.... any hint?
[2014-02-27 09:20:04 -0500] ocholetras: gnagno:  permissions
[2014-02-27 09:21:46 -0500] gnagno: ocholetras, doesn't look like a permissions problem, I mean, they don't have the rvm command in the path at all
[2014-02-27 09:21:58 -0500] ocholetras: umm
[2014-02-27 09:24:12 -0500] ocholetras: never used that cookbook
[2014-02-27 09:24:26 -0500] ocholetras: what you get on "which rvm"
[2014-02-27 09:24:37 -0500] ocholetras: on the user that can use it
[2014-02-27 09:24:37 -0500] ocholetras: ?
[2014-02-27 09:24:43 -0500] chef092: hi
[2014-02-27 09:25:10 -0500] chef092: while installing the tomcat on centos 6.5 using bootstrap command i am getting error
[2014-02-27 09:25:39 -0500] chef092: Error is : Error executing action `install` on resource 'package[java-1.6.0-openjdk-devel]'
[2014-02-27 09:25:43 -0500] gnagno: ocholetras, which cookbook do you use for installing rvm then?
[2014-02-27 09:27:10 -0500] chef092: for java also i am facing same issue
[2014-02-27 09:27:43 -0500] Prashant: Hi
[2014-02-27 09:29:06 -0500] Prashant: does anybody know
[2014-02-27 09:29:17 -0500] Prashant: whether chef can be used to create Topologies
[2014-02-27 09:31:37 -0500] Prashant: Hi Bryan
[2014-02-27 09:32:04 -0500] flaccid: Prashant: yes
[2014-02-27 09:32:44 -0500] Prashant: I wanted to know what are best industry practice to use Chef for creating Infra toplogies
[2014-02-27 09:32:45 -0500] Prashant: ?
[2014-02-27 09:32:58 -0500] flaccid: whats an infra topology?
[2014-02-27 09:33:04 -0500] Prashant: means
[2014-02-27 09:34:07 -0500] Prashant: creating like 1) new VM, 2) file system 3) network or DNS setting/changes 4) ceating Weserver 5) loandbalance on top of that6) any java container
[2014-02-27 09:34:25 -0500] Prashant: like High availability topologies
[2014-02-27 09:34:29 -0500] flaccid: thats not a topology
[2014-02-27 09:34:34 -0500] flaccid: thats a stack
[2014-02-27 09:34:39 -0500] flaccid: and yes you can do it with chef
[2014-02-27 09:34:55 -0500] Prashant: where i can find information on this
[2014-02-27 09:35:06 -0500] Prashant: and what are those industry best practices
[2014-02-27 09:35:08 -0500] flaccid: google.com and learn chef
[2014-02-27 09:35:19 -0500] Prashant: ok
[2014-02-27 09:35:21 -0500] flaccid: the industry best practice is to do it with chef cookbooks
[2014-02-27 09:35:38 -0500] Prashant: can we install OS also with chef ?
[2014-02-27 09:35:55 -0500] flaccid: Prashant: have you used chef before?
[2014-02-27 09:35:59 -0500] Prashant: yes
[2014-02-27 09:36:18 -0500] Prashant: i had created tomcat and apache cookbook as per my enviornment
[2014-02-27 09:36:21 -0500] flaccid: you could 'install OS'
[2014-02-27 09:36:35 -0500] Prashant: now i need to create complest stack
[2014-02-27 09:36:44 -0500] Prashant: without dependecies on our env
[2014-02-27 09:36:59 -0500] flaccid: sounds like a plan
[2014-02-27 09:37:00 -0500] Prashant: if i run cookbookes it should create that stack
[2014-02-27 09:37:06 -0500] Prashant: yes
[2014-02-27 09:37:15 -0500] flaccid: it should yes
[2014-02-27 09:37:30 -0500] Prashant: i wanted to know with chef experts , whether i am going in correct direction or not
[2014-02-27 09:37:40 -0500] Prashant: to create such stack
[2014-02-27 09:37:43 -0500] flaccid: yes you are
[2014-02-27 09:37:49 -0500] Prashant: with industry best practice
[2014-02-27 09:38:24 -0500] flaccid: there is no industry best practice because there isn't such a de factor thing. its subjective.
[2014-02-27 09:38:36 -0500] Prashant: ok
[2014-02-27 09:38:49 -0500] flaccid: good luck my friend
[2014-02-27 09:39:06 -0500] Prashant: thanks Bryan
[2014-02-27 09:39:20 -0500] flaccid: my name is chris
[2014-02-27 09:39:29 -0500] Prashant: sorry Chris
[2014-02-27 09:43:50 -0500] chef092: hi
[2014-02-27 09:44:22 -0500] chef092: pls help me i am stuck while installing the tomcat recipe on centos 6.4
[2014-02-27 09:44:47 -0500] flaccid: sorry to hear
[2014-02-27 09:45:50 -0500] chef092: below error shows ERROR: package[java-1.6.0-openjdk-devel] (java::openjdk line 37) had an error: Chef::Exceptions::Exec:  returned 1, expected 0
[2014-02-27 09:45:55 -0500] chef092:  [2014-02-27T13:21:27+05:30] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
[2014-02-27 09:46:56 -0500] chef092: i am a beginner for chef
[2014-02-27 09:52:25 -0500] Prashant: try to install that package seperatly
[2014-02-27 09:52:27 -0500] Prashant: and run
[2014-02-27 09:52:30 -0500] Prashant: again
[2014-02-27 09:54:26 -0500] chef092: i tried to install that package seperatly also but still i am getting error
[2014-02-27 09:55:55 -0500] Junaid: Is there a nagios plugin to monitor Chef client? Anyone?
[2014-02-27 10:09:02 -0500] aberrios: is it possible to knife tag create nested tags?
[2014-02-27 10:09:15 -0500] aberrios: i want a tag what would be node['tags']['cluster']
[2014-02-27 10:18:15 -0500] bwm: wondering where I can get help with a suspected bug in the apache2 recipe
[2014-02-27 10:19:50 -0500] aberrios: pastebin the error, I'll see if I can help
[2014-02-27 10:19:56 -0500] aberrios: no promises ;)
[2014-02-27 10:20:03 -0500] bwm: Thanks.
[2014-02-27 10:20:50 -0500] bwm: I've not got a specific error message - more a failure to function right - I'll explain
[2014-02-27 10:22:41 -0500] bwm: I'm running on Centos 6.4.  The recipe has a perl script to set up the mods-enabled directory.  mods-enabled has no entry for mod_proxy_http after the recipe completes.
[2014-02-27 10:23:44 -0500] bwm: The script is (not) run by an execute block that has an action of :nothing.  I can't find anywhere that notifies that block to run and I don't see why it would delay anyway.  I'm wondering whether the action should be :run
[2014-02-27 10:24:05 -0500] bwm: If I set it to :run - then I get my mods-enabled set up the way I would expect.
[2014-02-27 10:26:05 -0500] bwm: looking for a pointer to the recipe - but my dns is glitching
[2014-02-27 10:26:56 -0500] bwm: The recipe is at https://github.com/opscode-cookbooks/apache2/blob/master/recipes/default.rb
[2014-02-27 10:27:06 -0500] aberrios: yeah i'm looking at it
[2014-02-27 10:27:15 -0500] aberrios: which perl script is it inparticular?
[2014-02-27 10:27:35 -0500] bwm: The block is at line 68
[2014-02-27 10:28:23 -0500] bwm: line 70 action :nothing
[2014-02-27 10:28:23 -0500] aberrios: i see
[2014-02-27 10:28:47 -0500] bwm: btw: thanks for looking at for me aberrios
[2014-02-27 10:29:03 -0500] aberrios: what do you have in your run list for this node
[2014-02-27 10:29:37 -0500] aberrios: looks you wanna include recipe[apache2::mod_proxy_http]
[2014-02-27 10:29:51 -0500] aberrios: looks like*
[2014-02-27 10:30:46 -0500] bwm: I have my own recipe for setting up the mode and that includes apache2
[2014-02-27 10:30:59 -0500] bwm: looking for the code snippet ...
[2014-02-27 10:31:37 -0500] bwm: embarrasment: I don't have the code immediately to hand
[2014-02-27 10:32:53 -0500] bwm: That won't work - all that recipe does is enable mod_proxy_http.  It does not install it into mods-available.
[2014-02-27 10:33:14 -0500] bwm: s/mode/node/
[2014-02-27 10:35:49 -0500] bwm: I have tried it - I could try it again.  What I did do was include mod_proxy_http in the list of default modules ['apache2']['default_modules']
[2014-02-27 10:36:23 -0500] aberrios: ah
[2014-02-27 10:36:37 -0500] aberrios: you want apache_module
[2014-02-27 10:36:43 -0500] bwm: Digging into why it wasn't working I found no entry for mod_proxy_http in mods-available.
[2014-02-27 10:37:14 -0500] aberrios: apache module "mod_proxy_http" do
[2014-02-27 10:37:23 -0500] aberrios: apache_module "mod_proxy_http" do
[2014-02-27 10:37:46 -0500] aberrios: enable true
[2014-02-27 10:37:47 -0500] aberrios: end
[2014-02-27 10:38:00 -0500] bwm: Ok - thanks - I'll give that a go.
[2014-02-27 10:38:06 -0500] bwm: Much appreciated.
[2014-02-27 10:38:26 -0500] aberrios: https://github.com/opscode-cookbooks/apache2#apache_module
[2014-02-27 10:38:53 -0500] aberrios: now back to my problem, you wouldn't know if its possible to create nested tags with knife?
[2014-02-27 10:39:10 -0500] aberrios: i want a tag like node['tags']['cluster']
[2014-02-27 10:39:15 -0500] aberrios: for seaching purposes
[2014-02-27 11:34:49 -0500] daxroc: When creating LWRPs is it ok to wrap chef resources in conditional logic rather than not_if. How else would you updated_by_last_action true|false ?
[2014-02-27 11:36:07 -0500] daxroc: Should it be  s = script  and condition and s.run ?
[2014-02-27 11:42:10 -0500] daxroc: NM
[2014-02-27 11:53:24 -0500] ocholetras: What cookbook of the comunity is a good reference for apply testing to my cookbooks
[2014-02-27 11:53:25 -0500] ocholetras: ?
[2014-02-27 11:56:56 -0500] omphe: The kids at atalanta-systems (@Cope) have put together a cookiecutter implementation for scafolding out a new Berskshelf cookbook including chefspec , test-kitchen, etc: https://github.com/Atalanta/stencil
[2014-02-27 11:57:33 -0500] omphe: That'll stand up a new cookbook, but doesn't have the examples you might be looking for.
[2014-02-27 12:08:19 -0500] ocholetras: can i access attributes on spec testing?
[2014-02-27 12:08:21 -0500] ocholetras: i mean
[2014-02-27 12:08:43 -0500] ocholetras: if i expect that a file is owned by a user that is on node['management-user]
[2014-02-27 12:08:52 -0500] ocholetras: how can i get that value on the spec tests file?
[2014-02-27 12:10:00 -0500] StefanS: Any way to access the Metadata in a cookbook recipe?
[2014-02-27 12:10:15 -0500] StefanS: like what version of cookbook is running?
[2014-02-27 12:10:38 -0500] ocholetras: you can put that version on an attribute
[2014-02-27 12:10:43 -0500] ocholetras: as a working pattern
[2014-02-27 12:10:46 -0500] ocholetras: for your cookbooks
[2014-02-27 12:10:58 -0500] StefanS: rather just read what is in the metafile already than having to add attributes
[2014-02-27 12:11:24 -0500] StefanS: arent those values in the node object somewhere?
[2014-02-27 12:12:39 -0500] omphe: ocholetras: we set up the attributes in a let(:chef_run) {} block for the specs
[2014-02-27 12:13:06 -0500] ocholetras: omphe: im lost with that
[2014-02-27 12:13:17 -0500] ocholetras: started with ruby a month ago..
[2014-02-27 12:13:20 -0500] ocholetras: ><
[2014-02-27 12:13:28 -0500] ocholetras: just give me a place to dig in
[2014-02-27 12:18:26 -0500] ocholetras: omphe: im starting with test-kitchen and serverspec
[2014-02-27 12:18:35 -0500] ocholetras: as the test-kitchen tutorial says..
[2014-02-27 12:19:01 -0500] ocholetras: do you recomend me use chefspec instead serverspec?
[2014-02-27 12:19:46 -0500] omphe: Both
[2014-02-27 12:20:12 -0500] omphe: Chefspec will assert that your chef code is expressing what you want it to.
[2014-02-27 12:20:34 -0500] omphe: Serverspec will assert that your configuration has been applied to an instance.  Unit vs Integration.
[2014-02-27 12:20:52 -0500] ocholetras: aha
[2014-02-27 12:21:37 -0500] omphe: I didn't really get this until I'd paired with someone doing both.
[2014-02-27 12:27:31 -0500] ocholetras: omphe thx !
[2014-02-27 12:27:43 -0500] ocholetras: do you know if i can use chefspec with test-kitchen?
[2014-02-27 12:33:42 -0500] gnagno: how can I run a single cookbook against my running vagrant server?
[2014-02-27 12:34:19 -0500] ocholetras: http://kitchen.ci
[2014-02-27 12:58:13 -0500] chef263: hi
[2014-02-27 12:58:37 -0500] chef263: i am getting the error while installing java from knife bootstrap
[2014-02-27 12:59:01 -0500] chef263: Error executing action `install` on resource 'package[java-1.7.0-openjdk]' is error
[2014-02-27 12:59:58 -0500] chef263: my boostrap command is knife bootstrap chef_client_ip -x username -P password -p 22 -r "recipe[java]"
[2014-02-27 13:00:54 -0500] chef263: i am beginner to chef and no idea why it's failing
[2014-02-27 13:02:44 -0500] chef263: any one idea why this failing my chef-client os is centos 6.5
[2014-02-27 13:18:52 -0500] mivaho_: chef263: Did you try without the quotes?
[2014-02-27 13:19:11 -0500] workmad3: chef263: could you put the entire error message up using gist.github.com please
[2014-02-27 13:54:29 -0500] bmhatfield: Does anyone know about the estatsd install that's included with open-source chef?
[2014-02-27 13:54:58 -0500] bmhatfield: I can't seem to find documentation, but if 'estatsd' is an erlang statsd port, I'd love to forward the metrics on to my Graphite install.
[2014-02-27 13:55:16 -0500] bmhatfield: Anyone know what configuring that looks like?
[2014-02-27 14:23:45 -0500] estebistec: so, is anybody really proud of how they're processing or distributing static assets with chef?
[2014-02-27 14:35:52 -0500] workmad3: estebistec: why would you process static assets? :/
[2014-02-27 14:36:17 -0500] estebistec: compress / minify scripts and styles
[2014-02-27 14:36:19 -0500] estebistec: that's a basic starter
[2014-02-27 14:36:35 -0500] estebistec: it's not a technical challenge, we have a way we're doing it now, just curious if others have ideas
[2014-02-27 14:36:44 -0500] estebistec: compiling less into css is another
[2014-02-27 14:37:19 -0500] workmad3: estebistec: ah, I don't do any of that within chef... I just kick start the appropriate process (e.g. a rake assets:compile) with execute or similar in a chef deployment
[2014-02-27 14:38:07 -0500] workmad3: estebistec: when you talked about processing static files, I was thinking 'why would you put something as a cookbook file and then modify it instead of just using a template?'
[2014-02-27 14:38:48 -0500] estebistec: hehe
[2014-02-27 14:38:51 -0500] estebistec: no, I don't hate myself :P
[2014-02-27 14:39:07 -0500] estebistec: then do you move those to other servers, e.g., some apache or nginx that serves the folder, maybe a CDN or amazon s3+cloudfront?
[2014-02-27 14:40:44 -0500] workmad3: estebistec: I'm still figuring that sort of stuff out... my ideal would be to have a jenkins build server do that as a final step in a build, then package up the compiled assets into a .deb file that I could then just install on a server :)
[2014-02-27 14:41:45 -0500] daxroc: dpkg -i too_easy.deb :D
[2014-02-27 14:42:03 -0500] estebistec: I currently just do rsync :P (but that's not from chef)
[2014-02-27 14:42:55 -0500] estebistec: rsync does it's job well and only moves things that need moving
[2014-02-27 14:43:14 -0500] daxroc: workmad3: Pipe dream for me currently .. way down the list
[2014-02-27 14:43:37 -0500] workmad3: daxroc: same... I have a trello board with my thoughts on how to get that stuff done, that's as far as I am :(
[2014-02-27 14:43:38 -0500] srenatus: estebistec: you shouldn't have to serve files from S3, right?  They are HTTP-accessible, they serve that for you...
[2014-02-27 14:43:59 -0500] workmad3: srenatus: you still need to upload them as part of a deploy ;)
[2014-02-27 14:44:45 -0500] srenatus: workmad3: uploading. yes :D
[2014-02-27 14:44:50 -0500] daxroc: *want's no source compilation before packages :D, need a cross platform tool chain first, heck need to get an actual configure & or make script
[2014-02-27 14:58:07 -0500] dadleyy: morning all! is there any way to split attribute files up? we've adopted a one cookbook with many recipes" approach for our application deployment recipes and the attribute file is getting pretty large.
[2014-02-27 14:59:03 -0500] mattupstate: dadleyy: make as many separate attribute files as you like
[2014-02-27 14:59:06 -0500] mattupstate: they'll all get loaded
[2014-02-27 14:59:06 -0500] dadleyy: I've tried simply making new rb files and using a "require" in the main default.rb file but knife isnt picking up the others
[2014-02-27 14:59:21 -0500] dadleyy: hmm
[2014-02-27 14:59:23 -0500] dadleyy: i'll try again
[2014-02-27 14:59:26 -0500] mattupstate: dont bother with require
[2014-02-27 14:59:48 -0500] dadleyy: im confused
[2014-02-27 14:59:56 -0500] mattupstate: dadleyy: example: https://github.com/tas50/nagios/tree/master/attributes
[2014-02-27 15:00:34 -0500] dadleyy: soo "client.rb" "server.rb" and "default.rb" all get picked up by knife upload?
[2014-02-27 15:00:41 -0500] mattupstate: yup
[2014-02-27 15:00:54 -0500] dadleyy: that. is. the. best. news. ever!
[2014-02-27 15:00:58 -0500] dadleyy: thanks man!
[2014-02-27 15:01:01 -0500] mattupstate: ;-)
[2014-02-27 15:01:04 -0500] mattupstate: no sweat
[2014-02-27 15:01:13 -0500] dadleyy: are those node environment dependent or anything?
[2014-02-27 15:01:24 -0500] mattupstate: not sure what you mean
[2014-02-27 15:01:55 -0500] dadleyy: are the names client and server just names you chose
[2014-02-27 15:02:07 -0500] mattupstate: yes, they are arbitrary
[2014-02-27 15:02:13 -0500] mattupstate: use whatever makes sense for your cookbook
[2014-02-27 15:02:13 -0500] dadleyy: oh thank god
[2014-02-27 15:02:16 -0500] dadleyy: nice!!!
[2014-02-27 15:02:35 -0500] dadleyy: this is going to be a great day
[2014-02-27 15:10:44 -0500] shlant: Anyone have experience with kerberos? Is there a way to add all users from a kerberos servers with chef, or do I have to manually specify with something like the users cookbook?
[2014-02-27 15:45:54 -0500] shlant: anyone use the generic-users cookbook? is it better than the opscode users one?
[2014-02-27 16:02:50 -0500] bryano_: Chef noob question - if I was deploying a plain node/php/html-static site, is the application cookbook the best way to go?
[2014-02-27 16:03:48 -0500] mattupstate: bryano_: i suppose i'm confused if you lump node in with php and static html
[2014-02-27 16:04:23 -0500] bryano_: mattupstate: mostly because my node apps are relatively simple ones, but I was meaning for generic webapps
[2014-02-27 16:04:45 -0500] mattupstate: with node you need to manage a process, where as php (depending) and static html you can just plop files into a directory for nginx or apache to deal with
[2014-02-27 16:05:29 -0500] mattupstate: regardless, i would suggest avoiding the application cookbook, it has some limitations
[2014-02-27 16:05:39 -0500] mattupstate: and just use the deploy resource
[2014-02-27 16:05:51 -0500] mattupstate: application just adds some semantics around it
[2014-02-27 16:05:55 -0500] bryano_: gotcha
[2014-02-27 16:05:57 -0500] bryano_: thankies :)
[2014-02-27 16:06:22 -0500] mattupstate: but, it assumes you're deploying your files from a git repo
[2014-02-27 16:06:51 -0500] bryano_: in our case that's fine, we use github
[2014-02-27 16:07:10 -0500] bryano_: another guy uses bitbucket
[2014-02-27 16:07:24 -0500] mattupstate: then you should be good
[2014-02-27 16:08:11 -0500] mattupstate: FWIW, i think the main limitation with the application cookbook is that it doesn't handle configuration changes unless your code changes, so you'd have to manage the configuration outside the scope of the application LWRP
[2014-02-27 16:08:37 -0500] mattupstate: so you might as well just setup your own handles and notify other resources on your own
[2014-02-27 16:08:37 -0500] bryano_: You mean web app configuration?
[2014-02-27 16:08:42 -0500] mattupstate: yeah
[2014-02-27 16:08:49 -0500] mattupstate: say your node app has a config file
[2014-02-27 16:09:09 -0500] bryano_: yeah, that's kinda annoying, each dev had his own config theme, there's no uniformity at all
[2014-02-27 16:09:10 -0500] mattupstate: the application LWRP wont rerender it and restart your app unless you have a code change
[2014-02-27 16:09:40 -0500] mattupstate: unless you set `force true`
[2014-02-27 16:09:42 -0500] mattupstate: which is annoying
[2014-02-27 16:10:09 -0500] bryano_: half of my work is working around their idiosynratic natures
[2014-02-27 16:10:33 -0500] bryano_: in a room full of drama queens, I am the court jester
[2014-02-27 16:10:46 -0500] mattupstate: would you say that to their faces? ;)
[2014-02-27 16:11:09 -0500] bryano_: I would but it would bounce off their titanium plated ego's
[2014-02-27 16:11:50 -0500] workmad3: heh :) I know what I'd do if someone called me a drama queen...
[2014-02-27 16:11:56 -0500] workmad3: mince off in a flurry of dandruff....
[2014-02-27 16:12:05 -0500] bryano_: oh, maybe i'm just having my dyslexic moment's but is there a way in knife cookbook site download command to also download all the dependencies?
[2014-02-27 16:12:17 -0500] bryano_: good answer ;)
[2014-02-27 16:12:24 -0500] mattsurabian: lulz workmad3
[2014-02-27 16:12:30 -0500] workmad3: bryano_: considered using berkshelf?
[2014-02-27 16:12:56 -0500] bryano_: never heard of it (bear in mind my experience with chef can be measured in a fortnight :)
[2014-02-27 16:13:28 -0500] mattupstate: welcome to the beginning of the end
[2014-02-27 16:13:31 -0500] workmad3: bryano_: separate tool that helps with dependency resolution and version locking :)
[2014-02-27 16:13:33 -0500] bmhatfield: Can anyone point me in the right direction for handing etstatsd and open-source chef?
[2014-02-27 16:13:48 -0500] bryano_: I like to think of this as the end of the beginning :)
[2014-02-27 16:14:46 -0500] mattupstate: took me about two years to finally feel like i fully understood chef
[2014-02-27 16:14:55 -0500] mattupstate: granted, i dont use it full time
[2014-02-27 16:15:13 -0500] bryano_: well that can be a factor
[2014-02-27 16:15:41 -0500] workmad3: mattupstate: not sure how long it took me, but it definitely took me about 3 infrastructures to really get a good feel for it :)
[2014-02-27 16:15:42 -0500] bryano_: lots of tools I use I am nowhere near a master of, but I am past the "how do you turn it on?" point
[2014-02-27 16:16:26 -0500] mattupstate: workmad3: i'm about on my third major iteration, i'd say
[2014-02-27 16:17:05 -0500] bryano_: is it just me or is the "getting it installed and going" a completely different sort of learning experience than the everyday use and maintenance?
[2014-02-27 16:17:37 -0500] Dairenn: Hey how come some of my clients run version 11.8.0 while others run 11.8.2 even though they were bootstrapped all on the same day?
[2014-02-27 16:17:55 -0500] bryano_: or in another context, maintaining and repairing a car isn't the same experience as building one from scratch
[2014-02-27 16:17:59 -0500] docwhat: I'm having a hard time finding any good documentation on the CHANGELOG.md file in cookbooks.  I'm wholly subscribed to the notion that cookbooks should be individual git repositories, but I'm not seeing any tools to build that file automatically from "git log".  (I don't use community nor Jira at the moment)
[2014-02-27 16:18:12 -0500] docwhat: Help?
[2014-02-27 16:18:46 -0500] workmad3: bryano_: I'd guess so, if I'm understanding you correctly... although the fun of chef is that you can use chef to install and upgrade your chef-server :)
[2014-02-27 16:19:28 -0500] mattupstate: docwhat: there are no rules surrounding that workflow
[2014-02-27 16:19:38 -0500] mattupstate: there are tools to help, but nothing required
[2014-02-27 16:20:15 -0500] docwhat: mattupstate: Is there any tools like bundler's 'rake release'? I found emeril and stove, but both seem to oriented to Jira and Community...neither I want to use, yet.
[2014-02-27 16:21:04 -0500] mattupstate: i'm not aware of any, i've never done any official releases of ruby code
[2014-02-27 16:21:22 -0500] mattupstate: i've managed my changelogs manually
[2014-02-27 16:21:52 -0500] workmad3: automatic changelog... isn't that just 'git log'? :P
[2014-02-27 16:22:17 -0500] mattupstate: https://github.com/securactive/gitchangelog
[2014-02-27 16:22:27 -0500] mattupstate: i googled that for everyone ;)
[2014-02-27 16:34:32 -0500] polysics: hello!
[2014-02-27 16:34:40 -0500] polysics: trying to use knife-solo to bootstrap a box
[2014-02-27 16:34:48 -0500] polysics: I do not have a password for the box
[2014-02-27 16:34:56 -0500] polysics: only a copied key
[2014-02-27 16:35:10 -0500] polysics: -i seems to not work out, however
[2014-02-27 16:36:08 -0500] polysics: I know I can log in without a password
[2014-02-27 16:51:24 -0500] obryan: oi
[2014-02-27 17:03:07 -0500] tubbo: hi guys, does anyone here use Chef with their PXE server? I'm wondering if there are any plugins for Knife that will first preseed a server and reboot before running `knife bootstrap`...before I go ahead and make one myself. :P
[2014-02-27 17:06:50 -0500] polysics: how do I get knife-solo to use my id_rsa, please?
[2014-02-27 17:20:24 -0500] __marku__: I'm pretty new to chef and am struggling to load some configuration values from a file. I've tried this:
[2014-02-27 17:20:25 -0500] __marku__: cnf = YAML::load(File.open('processes.yml'))  cnf['processes'][0].each do | name, cmd |   supervisor_service name do     command "bash -c \"#{ cmd }\""     user "my_user"     directory "/home/my_user/#{ node[:my_vars][:application] }/"     action :enable     autostart true     stdout_logfile "/var/log/supervisor/#{ name }.log"     stderr_logfile "syslog"     startsecs 10     stopsignal "QUIT"     stopasgroup true     killasgroup true  
[2014-02-27 17:21:33 -0500] __marku__: Here it is as a gist: https://gist.github.com/markunsworth/9254703
[2014-02-27 17:21:58 -0500] __marku__: but the file doesn't exist when the compilation phase runs so it blows up
[2014-02-27 17:22:28 -0500] __marku__: the file is pulled from git when I deploy the code
[2014-02-27 18:30:49 -0500] dcparker: can i use a wildcard in a case statement? like when "tt*"
[2014-02-27 18:32:40 -0500] AntelopeSalad: dcparker: in ruby? you could use a regex in the "when" condition
[2014-02-27 18:32:41 -0500] bean: dcparker: "when /tt.*/" i'd think
[2014-02-27 18:32:47 -0500] mondo: Without using a template, what's the best way to add a line to a file if it doesn't exist?  Should I just use a bash block with an unless statement that greps the file?
[2014-02-27 18:33:02 -0500] dcparker: bean: thanks
[2014-02-27 18:33:18 -0500] dcparker: AntelopeSalad: yeah in the when condition. I'll try bean 's answer
[2014-02-27 18:33:30 -0500] AntelopeSalad: bean's answer is a regex
[2014-02-27 18:33:38 -0500] AntelopeSalad: but tt* seems like you want the thing to start with tt
[2014-02-27 18:33:47 -0500] AntelopeSalad: so you might want to start the regex off with ^
[2014-02-27 18:34:47 -0500] mondo: nm seems like execute would be more appropriate
[2014-02-27 18:35:19 -0500] bean: AntelopeSalad is correct with the ^ on the front, if you want it to start with TT
[2014-02-27 18:38:19 -0500] jwuenschel: mondo: http://stackoverflow.com/questions/14848110/how-i-can-change-a-file-with-chef/19167106#19167106
[2014-02-27 18:38:35 -0500] jwuenschel: make sure you read everything there though, especially the comments from Stephen King
[2014-02-27 18:39:20 -0500] dcparker: AntelopeSalad: ok. thanks. yeah I want it to start with tt and then any character after
[2014-02-27 18:40:18 -0500] mondo: jwuenschel: very cool, thanks!
[2014-02-27 18:41:24 -0500] jwuenschel: no problem. i'd still try to template it though btw, if at all possible, in order to have a reproducible state. but sometimes you have to do dirty things, and this would be less dirty than an execute block
[2014-02-27 18:45:05 -0500] viglesias: is there a place where chef client stores its full log?
[2014-02-27 18:45:16 -0500] viglesias: so far i have only found the chef-stacktrace.out
[2014-02-27 18:55:41 -0500] jbz: viglesias: you can set that in your client.rb
[2014-02-27 19:03:54 -0500] viglesias: jbz: cool is that log_level set to DEBUG?
[2014-02-27 19:03:57 -0500] docwhat: mattupstate: Hah... I didn't think to look for a generic solution. :-)
[2014-02-27 19:04:06 -0500] viglesias: ah verbose_logging?
[2014-02-27 19:04:39 -0500] jbz: viglesias: I don't recall what the default is if you haven't set it manually, sorry
[2014-02-27 19:04:54 -0500] viglesias: jbz: np ill poke around
[2014-02-27 19:14:17 -0500] zanshin: I have an application cookbook `foo` that depends upon another cookbook `bar`. `bar` installs tomcat and sets up a service for it. How can I trigger the :restart action in `bar` from `foo`?
[2014-02-27 19:18:52 -0500] AntelopeSalad: hmm is there a hard cap to the number of env variables you can send to the environment method in the execute resource?
[2014-02-27 19:20:10 -0500] traviscline: the chef-server omnibus installer fails pretty badly inside a conatiner as it needs initctl to behave well (and doesn't deal with faliures well)
[2014-02-27 19:21:07 -0500] zanshin: found my own answer: in `foo`: notifies :restart, "service[tomcat]".
[2014-02-27 19:24:40 -0500] docwhat: What is the important of the Node name?  Can I change it to something other than the fqdn?  Will that impact the Client?
[2014-02-27 19:24:49 -0500] docwhat: s/important/importance/
[2014-02-27 19:27:12 -0500] jidar: docwhat: are you running chef-server?
[2014-02-27 19:27:21 -0500] j^2: docwhat: it's what the chef-server knows as the machine
[2014-02-27 19:27:34 -0500] docwhat: jidar: I am running a chef-server.
[2014-02-27 19:28:00 -0500] docwhat: I wanted to know because typing "knife node show blah.example.com" is so long. I'd prefer to type just "knife node show blah"
[2014-02-27 19:28:31 -0500] docwhat: Where my "blah" is a bunch of numbers and letters and my "example.com" is about 20 characters.
[2014-02-27 19:28:48 -0500] docwhat: I'd actually prefer to give meaningful names "BuildSlave01" instead.
[2014-02-27 19:30:09 -0500] j^2: docwhat: yeah you can totally do that
[2014-02-27 19:30:36 -0500] docwhat: j^2:  Cool! I wasn't sure if I could just use 'knife node edit' and change it safely or not.
[2014-02-27 19:31:07 -0500] TrinitronX: is there a valid setting in .kitchen.yml for role_path ?
[2014-02-27 19:31:32 -0500] docwhat: j^2: WARNING: Changing the name of a node results in a new node being created, paste.bigdatalab.ibm.com will not be modified or removed.
[2014-02-27 19:31:39 -0500] docwhat: Do I delete the old one then?
[2014-02-27 19:31:45 -0500] jidar: yea
[2014-02-27 19:31:56 -0500] j^2: :-/
[2014-02-27 19:31:57 -0500] jidar: you'll have to migrate the runlist etc
[2014-02-27 19:31:59 -0500] j^2: docwhat: ^^
[2014-02-27 19:32:31 -0500] docwhat: j^2: What do you mean?
[2014-02-27 19:32:59 -0500] j^2: docwhat: that warning is scary. But a "new node" should be fine
[2014-02-27 19:33:18 -0500] docwhat: j^2: What do I do with the old node left behind? Delete it? Leave it?
[2014-02-27 19:33:26 -0500] docwhat: What happens if I don't delete it?
[2014-02-27 19:33:53 -0500] j^2: not sure, i'd test it out ;)
[2014-02-27 19:36:34 -0500] ikanusim: chef's built-in deploy resource comes with dcm providers for git and svn
[2014-02-27 19:36:45 -0500] ikanusim: I'm wondering what's the best way to deploy from a local directory
[2014-02-27 19:37:22 -0500] ikanusim: that is to say, my application source is already on the machine, I just need to put it into the target directory
[2014-02-27 19:37:31 -0500] ikanusim: but I don't want to give up the other goodies of the deploy resource
[2014-02-27 19:37:39 -0500] ikanusim: like deploy hooks, symlinks
[2014-02-27 19:37:52 -0500] ikanusim: what's the best way to tackle that?
[2014-02-27 19:38:39 -0500] AntelopeSalad: ikanusim: the deploy resource lets you put a local repo path
[2014-02-27 19:39:24 -0500] ikanusim: I know, let me explain why I want to get away from local repos
[2014-02-27 19:39:43 -0500] ikanusim: in the beginning I only used git and svn repos to deploy from
[2014-02-27 19:40:05 -0500] ikanusim: then I wanted to support arbitrary archives (zip, tgz, tbz2) as deploy sources
[2014-02-27 19:40:52 -0500] ikanusim: so I figured the cheap way to support this was downloading archives, extracting them, and creating git repos of the contents on the fly
[2014-02-27 19:41:02 -0500] ikanusim: just cd there, git init, git add .
[2014-02-27 19:41:10 -0500] ikanusim: and pass the result to the deploy resource
[2014-02-27 19:41:18 -0500] ikanusim: that works in many cases
[2014-02-27 19:41:29 -0500] AntelopeSalad: yeah
[2014-02-27 19:41:47 -0500] ikanusim: but breaks, or at least gets hairy, for bare repos
[2014-02-27 19:41:51 -0500] AntelopeSalad: so somewhere before your deploy resource you just need to create a new bit git repo only if it doesn't exist
[2014-02-27 19:41:51 -0500] ikanusim: or submodules
[2014-02-27 19:42:03 -0500] AntelopeSalad: *bit = bare
[2014-02-27 19:42:41 -0500] ikanusim: oh, you mean the repo I should be creating should be a bare one?
[2014-02-27 19:42:57 -0500] AntelopeSalad: it depends on what you want to do i guess
[2014-02-27 19:43:03 -0500] ikanusim: right now I'm creating a regular one, not a bare one
[2014-02-27 19:43:24 -0500] ikanusim: and customers report that when the archive they use *contains* a bare repo, it breaks
[2014-02-27 19:43:36 -0500] ikanusim: another issue is that for large archives, this can take a lot of time
[2014-02-27 19:43:41 -0500] ikanusim: or it can even fail
[2014-02-27 19:43:57 -0500] ikanusim: because all of this runs on ec2 instances, sometimes small ones
[2014-02-27 19:44:25 -0500] ikanusim: and creating the git repo eats up a lot of memory, so the OOM killer kicks in and the chef run dies
[2014-02-27 19:44:54 -0500] anthroprose: ikan: I use s3_file for things like that, but not in combo with deploy
[2014-02-27 19:45:14 -0500] AntelopeSalad: are the contents of the archives themselves not already a git repo?
[2014-02-27 19:45:36 -0500] ikanusim: not necessarily
[2014-02-27 19:45:48 -0500] ikanusim: in fact, if there is a top-level .git directory, I always delete it first
[2014-02-27 19:45:57 -0500] ikanusim: because otherwise creating the git repo fails
[2014-02-27 19:46:08 -0500] ikanusim: sure, you could argue that in that case I could just re-use the existing one
[2014-02-27 19:46:12 -0500] ikanusim: haven't tried that
[2014-02-27 19:46:17 -0500] ikanusim: but it's also not a general solution
[2014-02-27 19:46:29 -0500] ikanusim: because in many cases, the archive contents are really not a git repo
[2014-02-27 19:46:35 -0500] AntelopeSalad: oh
[2014-02-27 19:46:54 -0500] AntelopeSalad: so it sounds like you're forced to make a full git repo if it doesn't exist
[2014-02-27 19:47:11 -0500] ikanusim: I was hoping I could get around without it
[2014-02-27 19:47:21 -0500] ikanusim: I prototyped something quickly
[2014-02-27 19:47:27 -0500] ikanusim: a custom scm provider
[2014-02-27 19:47:44 -0500] ikanusim: that just copies contents from one directory to another one
[2014-02-27 19:47:45 -0500] AntelopeSalad: maybe you can mess around with the internals of the the deploy resource and overwrite some stuff for your exact use case?
[2014-02-27 19:47:52 -0500] ikanusim: exactly
[2014-02-27 19:48:10 -0500] ikanusim: but in the middle of my prototyping I thought I ask around here quickly
[2014-02-27 19:48:18 -0500] ikanusim: because I don't think my use case is that uncommon
[2014-02-27 19:48:23 -0500] ikanusim: I might be wrong there, of course
[2014-02-27 19:48:43 -0500] methods: any way to debug why chef_gem would install a gem system wide instead of into the embedded ruby ?
[2014-02-27 19:48:51 -0500] AntelopeSalad: yeah i dunno, i've experimented with push and pull based deploys using the deploy resource but in all cases it involves a git repo already
[2014-02-27 19:49:08 -0500] AntelopeSalad: in the push case, i created a bare repo which gets pushed to from another machine only if it didn't exist
[2014-02-27 19:49:12 -0500] ikanusim: git or svn, right
[2014-02-27 19:49:33 -0500] ikanusim: what exactly were you doing for the push case?
[2014-02-27 19:49:51 -0500] AntelopeSalad: i was getting used to using the deploy resource and didn't want to mess around with the ssh wrapper stuff
[2014-02-27 19:50:10 -0500] AntelopeSalad: it was easier to just push an existing repo from my workstation onto the node for testing
[2014-02-27 19:50:18 -0500] ikanusim: interesting
[2014-02-27 19:51:23 -0500] AntelopeSalad: it looked like this https://gist.github.com/AntelopeSalad/9258030
[2014-02-27 19:51:51 -0500] AntelopeSalad: so it just makes a new bare repo if it's not already there
[2014-02-27 19:52:25 -0500] ikanusim: got it
[2014-02-27 19:52:35 -0500] ikanusim: so I guess I will look into polishing that simple scm provider I'm prototyping
[2014-02-27 19:52:36 -0500] AntelopeSalad: i updated the gist
[2014-02-27 19:53:04 -0500] AntelopeSalad: so then the deploy resource does its thing and pulls from the local repo
[2014-02-27 19:53:24 -0500] ikanusim: right, that's not too different from what I am doing
[2014-02-27 19:53:35 -0500] ikanusim: besides I'm creating a non-bare repo
[2014-02-27 19:53:41 -0500] ikanusim: plus some edge case handling
[2014-02-27 19:53:42 -0500] AntelopeSalad: yeah the only difference is i git push a full git repo from another machine
[2014-02-27 19:54:01 -0500] AntelopeSalad: which would be pretty horrible in a real setup i think but i wanted to get rolling asap with using the deploy resource
[2014-02-27 19:54:28 -0500] AntelopeSalad: because if you do the git push route, then your first chef run is guaranteed to fail because it'll try to deploy from a bare repo
[2014-02-27 19:54:36 -0500] AntelopeSalad: since you can't push to a server that isn't provisioned yet heh
[2014-02-27 19:54:39 -0500] Majost: Is there a knife argument to set the ~/.chef directory to use?
[2014-02-27 19:55:18 -0500] ikanusim: alright, I'll see how far I get
[2014-02-27 19:55:22 -0500] ikanusim: thanks for your help so far
[2014-02-27 19:55:27 -0500] Majost: the -c argument only partially works as it doesn't override the .chef path
[2014-02-27 19:55:34 -0500] AntelopeSalad: np
[2014-02-27 20:05:51 -0500] AntelopeSalad: chef 11.x is using ruby 1.9.3 right?
[2014-02-27 20:09:40 -0500] binamov: AntelopeSalad yes
[2014-02-27 20:12:34 -0500] AntelopeSalad: i'm getting extremely unexpected results, it's like the code is being executed differently on the node when ran in a chef run
[2014-02-27 20:13:31 -0500] AntelopeSalad: if someone can explain this, i'll give them a gold star
[2014-02-27 20:13:32 -0500] AntelopeSalad: https://gist.github.com/AntelopeSalad/59f038454238da3c5c5a
[2014-02-27 20:15:57 -0500] mondo: is there an official cookbook that just installs packages?  I realize this is really simple, but it seems so simple there should be an official cookbook.  I just want to pass some package names in a role and make sure they're installed
[2014-02-27 20:17:03 -0500] binamov: mondo http://docs.opscode.com/resource_package.html
[2014-02-27 20:21:05 -0500] AntelopeSalad: it's like the .match method is not doing what ruby 1.9.3 normally does and i'm not sure how to get around it
[2014-02-27 20:22:35 -0500] btm: knife code review (different twitter client, sorry): https://twitter.com/btmspox/status/439132894486102016
[2014-02-27 20:26:08 -0500] shlant1: anyone use the users cookbook with chef-solo?
[2014-02-27 20:27:06 -0500] j^2: shlant1: yep
[2014-02-27 20:27:20 -0500] j^2: oh, which users cookbook?
[2014-02-27 20:27:25 -0500] j^2: there's a couple
[2014-02-27 20:30:19 -0500] shlant1: the opscode one
[2014-02-27 20:30:33 -0500] shlant1: I can't get chef-solo-search to work
[2014-02-27 20:30:42 -0500] shlant1: I ahve it in depends so the users cookbook doesn't complain
[2014-02-27 20:30:53 -0500] shlant1: but it doesn't create the users from data bags
[2014-02-27 20:30:58 -0500] binamov: no search in solo afaik
[2014-02-27 20:30:59 -0500] shlant1: works with chef-client
[2014-02-27 20:31:22 -0500] shlant1: binamov: that' why the users cookbook requires chef-solo-search cookbook for use with solo
[2014-02-27 20:31:29 -0500] shlant1: but it doesn't seem to be wroing...
[2014-02-27 20:31:31 -0500] shlant1: working*
[2014-02-27 20:31:53 -0500] shlant1: j^2: sorry I said all that without pinging you :p
[2014-02-27 20:31:59 -0500] shlant1: ^^
[2014-02-27 20:32:08 -0500] binamov: oh i see what you're trying to do, sorry shlant1
[2014-02-27 20:32:23 -0500] shlant1: binamov: np :)
[2014-02-27 20:32:40 -0500] j^2: shlant1: no worries, but yeah binamov is right
[2014-02-27 20:33:16 -0500] shlant1: j^2: https://github.com/edelight/chef-solo-search
[2014-02-27 20:38:44 -0500] AntelopeSalad: is there any way to use chef's version of ruby directly from a terminal?
[2014-02-27 20:39:27 -0500] EricL: Is there a way to just run a single recipe on a node without running the full chef-client run or over-riding the regular run_list permanently?
[2014-02-27 20:40:15 -0500] sersut: EricL: this might help you: http://docs.opscode.com/ctl_chef_apply.html
[2014-02-27 20:41:21 -0500] sersut: AntelopeSalad: maybe you can invoke the ruby directly from the installation directory. e.g.: /opt/chef/embedded/bin/ruby
[2014-02-27 20:42:07 -0500] EricL: sersut: Nope, that's not it.
[2014-02-27 20:42:14 -0500] AntelopeSalad: sersut, awesome that works
[2014-02-27 20:42:20 -0500] EricL: I want to run the recipe from one of the cookbooks.
[2014-02-27 20:51:21 -0500] sersut: EricL: then you can use -o / --override-runlist option of chef-client it will not replace the run_list permanently. It will use the given run_list only during the invoked run.
[2014-02-27 20:52:17 -0500] AntelopeSalad: sersut: that embedded version of ruby is not modified at all when chef actually runs it right?
[2014-02-27 20:52:21 -0500] EricL: sersut: When I use -o, it overrides the run_list permanently.
[2014-02-27 20:52:28 -0500] EricL: Is that something I am doing wrong?
[2014-02-27 20:55:51 -0500] sersut: EricL: we recently found a bug around this functionality with 11.10.0 where -o overrides the run_list permanently when the run_list for the node didn't exist
[2014-02-27 20:55:52 -0500] sersut: https://tickets.opscode.com/browse/CHEF-5016
[2014-02-27 20:56:03 -0500] sersut: also more details here: http://www.getchef.com/blog/2014/02/18/chef-client-release-11-10-2-10-30-4/
[2014-02-27 20:56:23 -0500] sersut: -o shouldn't update the existing run_list unless it's the first run
[2014-02-27 20:56:36 -0500] EricL: We are on 11.10
[2014-02-27 21:21:57 -0500] estebist_: man, I've gotta re-arrange my calendar if I'm ever going to get on these opscode code review sessions to talk about my jiras/pulls :/
[2014-02-27 21:25:17 -0500] sersut: EricL: Does the node have a run_list at the time when you're using -o flag?
[2014-02-27 21:25:33 -0500] EricL: YEs.
[2014-02-27 21:26:17 -0500] sersut: cool... can you send over the logs with "-l debug" to me serdar@getchef.com and I can take a quick peek?
[2014-02-27 21:26:55 -0500] EricL: I'm in the middle of troubleshooting a problem with a cookbook (which is why I only wanted to run the recipe for that cookbook).
[2014-02-27 21:27:03 -0500] EricL: I need a little bit and I'll send it over soon.
[2014-02-27 21:47:44 -0500] methods: why don't i see any output when i pipe chef-client to a file even though I'm using -l debug ?  I'm also not really seeing debug messages as far as I can tell..
[2014-02-27 21:48:05 -0500] coderanger: methods: Do you have log_location set to STDOUT?
[2014-02-27 21:48:16 -0500] methods: yea that's the default i beleve
[2014-02-27 21:48:47 -0500] coderanger: better option is probably to just use chef-client -l debug -L /path/to/file
[2014-02-27 21:48:48 -0500] coderanger: :)
[2014-02-27 21:49:08 -0500] methods: rather strange behavior
[2014-02-27 21:49:14 -0500] AntelopeSalad: hey coderanger, are you up for solving one of the greatest mysteries of man kind?
[2014-02-27 21:49:36 -0500] coderanger: AntelopeSalad: Maybe? Also trying to get $dayjob stuff done today
[2014-02-27 21:50:12 -0500] AntelopeSalad: coderanger: if you get a chance , https://gist.github.com/AntelopeSalad/59f038454238da3c5c5a , i'm wondering if this might be a bug with chef
[2014-02-27 21:54:00 -0500] coderanger: AntelopeSalad: All I can say is, again, those semantics of Hash#[] are _not documented_ and I highly encourage not using them
[2014-02-27 21:54:18 -0500] AntelopeSalad: coderanger: i replaced using Hash[] with inject and it's the same problem
[2014-02-27 21:54:36 -0500] coderanger: Then display the intermediary values and see what gets read
[2014-02-27 21:54:39 -0500] AntelopeSalad: it all works on 4 different environments and running it against chef's version of ruby, but not during the chef run
[2014-02-27 21:54:55 -0500] coderanger: AntelopeSalad: Remember that you are running that code at compile time
[2014-02-27 21:55:00 -0500] coderanger: so the resource hasn't happened yet
[2014-02-27 21:55:10 -0500] AntelopeSalad: the chef run always picks up that one RAILS_ENV='production' value from /etc/profile
[2014-02-27 21:55:14 -0500] AntelopeSalad: but it ignores the rest
[2014-02-27 21:55:34 -0500] AntelopeSalad: the /etc/profile that it's reading from is already fully populated by the time it gets to the point where i read from it tho
[2014-02-27 21:57:49 -0500] coderanger: AntelopeSalad: To check that, log intermediary values :)
[2014-02-27 21:58:27 -0500] coderanger: http://hastebin.com/qebibevaku.rb
[2014-02-27 21:58:34 -0500] coderanger: #tap is built for this kind of thing
[2014-02-27 21:58:55 -0500] AntelopeSalad: i'm doing a run now to log File.read('/etc/profile') at the same point i tried to log env_hash
[2014-02-27 22:00:06 -0500] AntelopeSalad: the output of that log that i just setup is the fully finished /etc/profile, all env variables in tact
[2014-02-27 22:00:37 -0500] AntelopeSalad: going to try using your tap method, will let you know in a few
[2014-02-27 22:05:16 -0500] AntelopeSalad: coderanger: i'm not getting any output from #tap
[2014-02-27 22:10:32 -0500] kitopastorino: what's the best way to add deploy keys to a machine via chef? have some encrypted info in a data bag? or just update github with a newly generated key per machine?
[2014-02-27 22:13:35 -0500] coderanger: AntelopeSalad: Are you running with -l debug?
[2014-02-27 22:14:05 -0500] AntelopeSalad: coderanger: nope, i am now
[2014-02-27 22:14:30 -0500] coderanger: kitopastorino: Short answer: there isn't a great way. Longer answer: if you are using AWS look at the citadel cookbook, otherwise chef-vault is okay if a bit cranky
[2014-02-27 22:14:39 -0500] AntelopeSalad: i also moved the function call to the library inline, same results
[2014-02-27 22:15:09 -0500] kitopastorino: coderanger: thanks! i'm on aws, so i'll look at citadel
[2014-02-27 22:17:32 -0500] AntelopeSalad: coderanger: what am i looking for? lol there's so much spam
[2014-02-27 22:18:40 -0500] coderanger: AntelopeSalad: For that output from Chef::Log.debug?
[2014-02-27 22:18:53 -0500] AntelopeSalad: i don't even know what it's supposed to output
[2014-02-27 22:19:37 -0500] coderanger: AntelopeSalad: The file contents from that point in time
[2014-02-27 22:20:18 -0500] AntelopeSalad: i'll re-run it and remove all of my custom log calls
[2014-02-27 22:22:03 -0500] AntelopeSalad: i see nothing from the tap still
[2014-02-27 22:23:22 -0500] coderanger: AntelopeSalad: Should be towards the start of the run
[2014-02-27 22:24:37 -0500] AntelopeSalad: coderanger: what would it even be prefixed with?
[2014-02-27 22:26:45 -0500] coderanger: AntelopeSalad: Nothing?
[2014-02-27 22:26:59 -0500] coderanger: thats just a raw logging call
[2014-02-27 22:27:05 -0500] coderanger: if you want to add a prefix, add one
[2014-02-27 22:27:05 -0500] Joel: any idea on why I keep getting a deploy branch checked out and set as my default? https://gist.github.com/jjshoe/a16913d8fa03185f77a4
[2014-02-27 22:27:26 -0500] coderanger: Joel: Thats how the git resource works, 11.10.0 added a flag to disable it
[2014-02-27 22:27:57 -0500] Joel: coderanger: the f. what's the flag? why would anyone want that? ew.
[2014-02-27 22:28:20 -0500] AntelopeSalad: coderanger: i added a ZZZ prefix and writing the output to a file, will let you know
[2014-02-27 22:28:25 -0500] coderanger: Joel: It is how the git resource does idempotence checks internally even if the branch name changes
[2014-02-27 22:28:56 -0500] AntelopeSalad: here are the manual tests i've done tho https://gist.github.com/AntelopeSalad/59f038454238da3c5c5a#file-recipe-rb
[2014-02-27 22:29:09 -0500] Joel: coderanger: I'm running 11.10.4, any idea where to find the flag? Nothing in the doc sticks out.
[2014-02-27 22:29:26 -0500] Joel: Anyone have any idea if http://docs.opscode.com/resource_git.html exists in git itself somewhere?
[2014-02-27 22:29:27 -0500] coderanger: Joel: I think the docs haven't been updated for some reason, check the 11.10 release announcement
[2014-02-27 22:30:10 -0500] coderanger: Joel: https://tickets.opscode.com/browse/CHEF-3734 is the ticket
[2014-02-27 22:30:18 -0500] Joel: coderanger: found it
[2014-02-27 22:30:46 -0500] AntelopeSalad: coderanger, here's the only thing tap output https://gist.github.com/AntelopeSalad/59f038454238da3c5c5a#file-recipe-rb-L12
[2014-02-27 22:30:56 -0500] AntelopeSalad: am i doing that right?
[2014-02-27 22:31:24 -0500] coderanger: AntelopeSalad: No, remove the grep, there are probably more lines ...
[2014-02-27 22:33:18 -0500] AntelopeSalad: it's 8200 lines and i'm using nano to page through it
[2014-02-27 22:33:35 -0500] coderanger: AntelopeSalad: Don't?
[2014-02-27 22:33:40 -0500] coderanger: Less has regex searching
[2014-02-27 22:33:46 -0500] coderanger: I mean so does nano for that matter
[2014-02-27 22:33:47 -0500] AntelopeSalad: i don't know what i'm supposed to be looking for tho
[2014-02-27 22:34:19 -0500] coderanger: AntelopeSalad: Look for the ZZZZ tag and then scroll down
[2014-02-27 22:34:30 -0500] coderanger: and make sure that the file content matches what you expect
[2014-02-27 22:34:49 -0500] AntelopeSalad: not sure how to search for that in nano or less
[2014-02-27 22:34:57 -0500] AntelopeSalad: without grepping it
[2014-02-27 22:35:13 -0500] Joel: coderanger: I can find https://github.com/opscode/chef-docs/blob/master/chef_master/source/resource_git.rst, any idea where the content comes from?
[2014-02-27 22:36:08 -0500] coderanger: Joel: I can never make heads or tails of the docs, I just grep for stuff
[2014-02-27 22:36:28 -0500] coderanger: Its a bajillion transcludes everywhere
[2014-02-27 22:36:46 -0500] Joel: coderanger: so I see, each little example... holy fuck. terrible.
[2014-02-27 22:36:49 -0500] coderanger: Joel: Of note, don't try viewing it using github's ReST renderer
[2014-02-27 22:36:59 -0500] methods: is there a way to run chef without redownloading hte cookbook ?
[2014-02-27 22:36:59 -0500] coderanger: since that doesn't grok Sphinx markup
[2014-02-27 22:37:04 -0500] Joel: how do they expect the community to help them keep this up to date?
[2014-02-27 22:37:08 -0500] coderanger: methods: Not sure what that means
[2014-02-27 22:37:22 -0500] coderanger: Joel: I cannot answer that question with profanity, sorry
[2014-02-27 22:37:44 -0500] Joel: coderanger: without? ;)
[2014-02-27 22:37:52 -0500] coderanger: Joel: Yeah, that
[2014-02-27 22:38:08 -0500] methods: i made some changes quickly in /var/chef/cache/cookbooks just for testing and it looks like it got overwritten with a clean copy
[2014-02-27 22:38:27 -0500] coderanger: methods: Yes, thats how chef-client works
[2014-02-27 22:38:30 -0500] AntelopeSalad: coderanger: it's the same...
[2014-02-27 22:38:36 -0500] AntelopeSalad: the output is identical to what i logged
[2014-02-27 22:38:38 -0500] coderanger: methods: You have to upload changes to the chef-server
[2014-02-27 22:38:51 -0500] methods: i just want to do a quick test i don't want to upload
[2014-02-27 22:39:02 -0500] coderanger: AntelopeSalad: Then move the tap further down in the pipeline until you find the the unexpected bit
[2014-02-27 22:39:07 -0500] coderanger: methods: Then use chef-solo
[2014-02-27 22:39:25 -0500] AntelopeSalad: coderanger: the tap output is the entire /etc/profile file -- same as when i logged in 45min ago
[2014-02-27 22:39:38 -0500] methods: can i point chef-solo at that cookbook folder ?
[2014-02-27 22:39:41 -0500] coderanger: AntelopeSalad: Yes, thats the point
[2014-02-27 22:39:42 -0500] AntelopeSalad: it's the correctly populated "final" version of it with all the env variables that the method is supposed to pickup
[2014-02-27 22:39:49 -0500] coderanger: methods: I wouldn't, but maybe
[2014-02-27 22:40:04 -0500] AntelopeSalad: the tap isn't telling me anything tho
[2014-02-27 22:40:06 -0500] coderanger: methods: Thats not a useful workflow though, do your testing with test-kitchen
[2014-02-27 22:40:10 -0500] AntelopeSalad: it's just outputting the file's contents
[2014-02-27 22:40:29 -0500] coderanger: AntelopeSalad: Yes, thats what that code does, you need to find out why the expected inputs aren't producing the expected outputs
[2014-02-27 22:40:33 -0500] coderanger: This is debugging 101
[2014-02-27 22:40:59 -0500] coderanger: AntelopeSalad: So just keep narrowing the area of unexpected results until you find exactly when the unexpected thing happens
[2014-02-27 22:41:00 -0500] AntelopeSalad: we know the code works to parse the ENVs, and we know the file is correctly populated
[2014-02-27 22:41:02 -0500] coderanger: and then fix it
[2014-02-27 22:41:04 -0500] AntelopeSalad: isn't it guaranteed that chef has a bug?
[2014-02-27 22:41:16 -0500] coderanger: AntelopeSalad: No, Chef isn't involved in that code ...
[2014-02-27 22:41:55 -0500] AntelopeSalad: i dunno man, if i run /opt/chef/embedded/bin/ruby on the server and parse the identical /etc/profile it's the correct output
[2014-02-27 22:42:37 -0500] coderanger: AntelopeSalad: Like I said, you need to debug it, this is just standard programming-y stuff
[2014-02-27 22:42:47 -0500] AntelopeSalad: i don't even know where to begin though
[2014-02-27 22:42:47 -0500] coderanger: Keep outputting stuff until you find the bug then fix it
[2014-02-27 22:42:55 -0500] coderanger: AntelopeSalad: I've told you now three or four times
[2014-02-27 22:43:01 -0500] AntelopeSalad: you told me to move the tap down
[2014-02-27 22:43:16 -0500] coderanger: Display intermediary values during you computation until you find where exactly something unexpected happens
[2014-02-27 22:43:19 -0500] AntelopeSalad: if i move the tap down 1 line, isn't it going to just output the file again?
[2014-02-27 22:43:24 -0500] AntelopeSalad: i already know the file is correct
[2014-02-27 22:43:46 -0500] coderanger: No, tap passes the current object in the processing chain to the block
[2014-02-27 22:47:06 -0500] AntelopeSalad: coderanger: i think i just found the bug
[2014-02-27 22:47:56 -0500] AntelopeSalad: thanks for getting me to think properly, i won't be able to confirm for another 3-4min (waiting on the run to finish) but i'm 90% sure this is it
[2014-02-27 22:53:08 -0500] coderanger: AntelopeSalad: Is it that you didn't upcase the cookbook name?
[2014-02-27 22:53:34 -0500] AntelopeSalad: yes
[2014-02-27 22:53:40 -0500] coderanger: :-)
[2014-02-27 22:54:04 -0500] AntelopeSalad: in my local tests i wasn't dealing with a cookbook name directly, so i just capped it manually when i passed it into the function
[2014-02-27 22:54:27 -0500] coderanger: Like I said, debugging is all about finding the point where things go from expected to unexpected :)
[2014-02-27 22:54:45 -0500] AntelopeSalad: yeah, that debugging line you said maybe me think that i should try to simplify as much as possible
[2014-02-27 22:55:02 -0500] AntelopeSalad: so i took out the cookbook_name variable and just hard coded the thing with caps manually and it worked
[2014-02-27 22:55:16 -0500] AntelopeSalad: *made me think
[2014-02-27 23:18:58 -0500] Otterley: hey, I've got a chicken-egg problem I wanted to run by y'all
[2014-02-27 23:19:51 -0500] Otterley: I'm working on a new PKI-based secrets system.  The client has a cookbook that, when run, generates a key pair, stores it on disk, then adds the public key to a persistent attribute.
[2014-02-27 23:20:17 -0500] Otterley: The vault server performs a Chef search and puts all the public keys into a CA file so that it can authenticate the clients that want to access the secrets.
[2014-02-27 23:21:14 -0500] Otterley: The client cookbook also adds an instance method to node to access the secrets.  (The method is old and had a different underlying implementation before.)
[2014-02-27 23:21:54 -0500] Otterley: Ever since Chef changed its -o behavior, I can't just run the client recipe on an existing node to have it generate the key pair and save the attributes to the server, because -o changed so it no longer does a save on exit.
[2014-02-27 23:22:20 -0500] Otterley: And I can't do a full Chef run because secrets are accessed at compilation, and since the vault server doesn't have the key yet, it refuses to respond.
[2014-02-27 23:22:28 -0500] coderanger: Otterley: Just use -j
[2014-02-27 23:23:00 -0500] coderanger: Or, alternatively, call node.save yourself within the recipe code
[2014-02-27 23:23:02 -0500] Otterley:  what I *really* want is a "partial save" that doesn't touch the existing Chef attributes stored on the server.
[2014-02-27 23:23:21 -0500] coderanger: Otterley: Okay, so do that
[2014-02-27 23:23:25 -0500] Otterley: is that possible?
[2014-02-27 23:23:31 -0500] Otterley: I thought save was atomic.
[2014-02-27 23:23:34 -0500] coderanger: Otterley: Its race-condition-y as hell, but sure
[2014-02-27 23:23:43 -0500] coderanger: No, save is as far from atomic as humanly possible
[2014-02-27 23:23:55 -0500] coderanger: Chef's API doesn't support atomic operations in fact
[2014-02-27 23:24:12 -0500] Otterley: I don't follow.  You can save only a subset of node attributes, without disturbing the others?
[2014-02-27 23:24:57 -0500] Otterley: the implementation of node.save is chef_server_rest.put_rest("nodes/#{name}", self)
[2014-02-27 23:25:35 -0500] coderanger: No, you need to do a Chef API get and put on your own
[2014-02-27 23:25:42 -0500] Otterley: *holds nose*
[2014-02-27 23:26:18 -0500] coderanger: n = chef_server_rest.get_rest("nodes/#{node.name}"); n['foo'] = ' bar'; chef_server_rest.put_rest("nodes/#{node.name}", n)
[2014-02-27 23:26:50 -0500] coderanger: but remember that at the end of the chef run it will save whatever it thinks the start is which will fully overwrite your PUT
[2014-02-27 23:27:09 -0500] Otterley: that's OK with me.
[2014-02-27 23:27:14 -0500] Otterley: they won't be inconsistent
[2014-02-27 23:27:33 -0500] Otterley: or, at least, the full state will be a strict superset of the partial state
[2014-02-27 23:27:48 -0500] coderanger: Then go for it :)
[2014-02-27 23:52:59 -0500] coalbe: Is it possible to add logic to a role.rb? Eg: if the node.env = dev, load this recipe, otherwise load this one.
[2014-02-27 23:53:25 -0500] mattray: coalbe: you'll want to look at environment specific run lists
[2014-02-27 23:53:37 -0500] mattray: coalbe: little-used feature, check docs.opscode.com
[2014-02-27 23:54:38 -0500] coderanger: Or, alternatively, stop using roles :-)
[2014-02-27 23:55:22 -0500] coalbe: ughh, lol. they just point to a wrapper anyways, calm down ;)
[2014-02-27 23:55:55 -0500] coalbe: im just looking for a simple way to load mongo_replica vs mongo_standalone in prod vs dev.
[2014-02-27 23:56:15 -0500] coderanger: coalbe: Either way works then
[2014-02-27 23:56:42 -0500] methods: anyone know a better way to set http proxy with chef_gem() than these approaches ? https://gist.github.com/chino/1cd83fd0227227a9e125
[2014-02-27 23:57:02 -0500] coalbe: i was hoping to just stick a case in my mongo role
[2014-02-27 23:59:01 -0500] coderanger: coalbe: No, the .rb format for roles is just a helper, they are baked to JSON before uploading
[2014-02-27 23:59:26 -0500] coalbe: ahh, that makes sense.
