[2014-05-13 00:09:15 -0400] sauraus: How do I test for the existence of a data bag on the chef server?
[2014-05-13 00:09:27 -0400] coderanger: sauraus: Try to grab it and catch the 404
[2014-05-13 00:09:51 -0400] sauraus: Ugh that's a nasty way of doing it :(
[2014-05-13 00:09:53 -0400] sauraus: but ok
[2014-05-13 00:10:22 -0400] coderanger: sauraus: I mean you can also grab the list of them
[2014-05-13 00:10:28 -0400] coderanger: sauraus: But thats both slower and race-y
[2014-05-13 00:11:14 -0400] sauraus: Yeah I was kind of hoping the search function would just return a nil if no bad exists for which I can then test before accesing it ;)
[2014-05-13 00:11:23 -0400] sauraus: bag ^^ :D
[2014-05-13 00:11:43 -0400] coderanger: sauraus: Thats roughly comperable to just getting the list
[2014-05-13 00:11:59 -0400] coderanger: sauraus: node.chef_server_rest.get_rest('data')
[2014-05-13 00:12:06 -0400] coderanger: sauraus: That will return a hash
[2014-05-13 00:12:16 -0400] coderanger: sauraus: so !!node.chef_server_rest.get_rest('data')[name]
[2014-05-13 00:12:29 -0400] coderanger: More compact code, but slower
[2014-05-13 00:13:23 -0400] sauraus: I am right now more concerned with 'proper' code than having the fastest code need to lead by example ;)
[2014-05-13 00:13:43 -0400] coderanger: sauraus: Then yeah, trying to load it and catching the 404 exception
[2014-05-13 00:17:11 -0400] yser: q: Whats the problem when I get the message "ERROR: Excon::Errors::SocketError: getaddrinfo: Name or service not known (SocketError)" when executing "knife ec2 server list". did i miss some config?
[2014-05-13 00:17:27 -0400] coderanger: yser: You can't contact the AWS API?
[2014-05-13 00:18:56 -0400] yser: coderanger: yes but whats exact problem?...whats the message if e.g. the keys are wrong?
[2014-05-13 00:19:36 -0400] coderanger: yser: Thats not a specific error, just a DNS lookup failure
[2014-05-13 00:20:36 -0400] yser: coderanger: ah thx, that helped a lot ;)
[2014-05-13 00:33:13 -0400] hot_karl: hi everyone
[2014-05-13 00:33:23 -0400] coderanger: Alo
[2014-05-13 00:33:46 -0400] hot_karl: anyone have any experience using the jenkins cookbook?
[2014-05-13 00:33:51 -0400] coderanger: Which one
[2014-05-13 00:34:05 -0400] hot_karl: https://github.com/opscode-cookbooks/jenkins
[2014-05-13 00:34:06 -0400] coderanger: current opscode, old opscode, or other
[2014-05-13 00:34:11 -0400] hot_karl: current
[2014-05-13 00:35:05 -0400] hot_karl: so i have everything in my cookbook working except one last piece
[2014-05-13 00:35:23 -0400] coderanger: Sorry, only have experience with my own :)
[2014-05-13 00:37:27 -0400] hot_karl: well the question is more general
[2014-05-13 00:37:33 -0400] hot_karl: Im trying to use the AD auth plugin (https://wiki.jenkins-ci.org/display/JENKINS/Active+Directory+Plugin) and it requires a Bind Password which is encrypted in the config.xml file.  And Im wondering how people handle passing in values like that in general in recipes.
[2014-05-13 00:38:02 -0400] coderanger: hot_karl: There isn't a good answer unless do things my way, which most people don't :-(
[2014-05-13 00:38:11 -0400] coderanger: hot_karl: secrets management is haaaaaard
[2014-05-13 00:38:38 -0400] hot_karl: i mean id be happy with a hack like finding out which files it uses to encrypt with and make sure those are statiuc
[2014-05-13 00:38:48 -0400] hot_karl: and then just keeping the same string :P
[2014-05-13 00:39:26 -0400] coderanger: hot_karl: Do you know how if it is using the normal Jenkins encryption system?
[2014-05-13 00:39:48 -0400] hot_karl: i assume so since i am doing a vanilla war install
[2014-05-13 00:40:04 -0400] sauraus: hot_karl: if you figure out the AD plugin let me know :)
[2014-05-13 00:40:04 -0400] coderanger: hot_karl: Let me find my code for that
[2014-05-13 00:40:08 -0400] coderanger: its super cranky
[2014-05-13 00:40:33 -0400] hot_karl: coderanger: tyvm
[2014-05-13 00:41:06 -0400] coderanger: hot_karl: https://github.com/balanced-cookbooks/ci/blob/master/generate_secrets.rb
[2014-05-13 00:41:18 -0400] coderanger: Thats what I used for creating the API tokens outside of Jenkins
[2014-05-13 00:41:30 -0400] coderanger: It is probably similar to what you need
[2014-05-13 00:41:57 -0400] hot_karl: thank you so much.  Let me play around with this a bit
[2014-05-13 00:42:28 -0400] coderanger: hot_karl: Please note that this all TERRRIBLE
[2014-05-13 00:42:39 -0400] coderanger: hot_karl: and provides almost no security
[2014-05-13 00:43:04 -0400] coderanger: So you should take steps to protect the key even once "encrypted" just as you would any other password
[2014-05-13 00:43:21 -0400] hot_karl: got it
[2014-05-13 00:43:28 -0400] coderanger: though in reality the issues with ECB mode are unlikely to manifest on something that short
[2014-05-13 00:43:35 -0400] coderanger: but still, it is sadpanda
[2014-05-13 00:43:39 -0400] hot_karl: haha yeah
[2014-05-13 00:46:13 -0400] yser: coderanger: just for the protocol, the SocketError was a misconfiguration in the knife.rb with knife[:region] = "eu-west-1c" where knife[:region] = "eu-west-1" is the correct value ;)
[2014-05-13 00:55:39 -0400] Brad_K: I don't suppose anyone knows if/when https://github.com/acrmp/foodcritic/pull/224 will be merged and a new version of the gem cut?
[2014-05-13 00:57:01 -0400] coderanger: https://github.com/acrmp/foodcritic/pull/217 was already merged
[2014-05-13 00:58:18 -0400] Brad_K: coderanger: okay, so what about issuing a new version of the gem?
[2014-05-13 00:58:41 -0400] coderanger: Brad_K: That I can't speak to
[2014-05-13 01:00:21 -0400] Brad_K: I don't suppose you have any suggestions of pages we should read to learn how to build our own version of the gem from the master branch and have that over-ride the version from rubygems?
[2014-05-13 01:00:40 -0400] coderanger: Brad_K: Just drop it in your gemfile
[2014-05-13 01:00:53 -0400] coderanger: Brad_K: gem 'foodcritic', github: 'acrmp/foodcritic'
[2014-05-13 01:01:07 -0400] Brad_K: ahh, okay.  thanks!
[2014-05-13 01:04:20 -0400] bricker`LA: spheromak: ping
[2014-05-13 01:09:12 -0400] spheromak: bricker`LA: sup
[2014-05-13 01:09:54 -0400] bricker`LA: spheromak: So the dhcp setup I have works fine, but I've run into this chicken/egg situation that I think you mentioned I might
[2014-05-13 01:10:29 -0400] bricker`LA: spheromak: basically dhcp needs the macaddress attribute to create the DHCP host, but that attribute isn't available until 'chef-client' is run for the first time. So I can't login to the node until that happens automatically.
[2014-05-13 01:10:36 -0400] bricker`LA: spheromak: is this a common problem?
[2014-05-13 01:10:46 -0400] bricker`LA: spheromak: and how would I get around this?
[2014-05-13 01:11:11 -0400] spheromak: yea its why you shouldn't be doing it based on search
[2014-05-13 01:11:30 -0400] spheromak: but instead based on a wrapper cook you put on your dhcp servers that defines your nodes
[2014-05-13 01:11:42 -0400] spheromak: also why it was originally in bags.
[2014-05-13 01:12:24 -0400] spheromak: like an asset db or spreadsheet of mac addrs. you can just parse and generate resources
[2014-05-13 01:12:50 -0400] spheromak: yea but you need the dhcp presumably to bootstrap the machines.
[2014-05-13 01:13:03 -0400] bricker`LA: spheromak: My main problem was manually typing in the macaddress was becoming a cumbersome step of setting up a VM, and if I replace a VM but use the same chef node, the macaddress changes
[2014-05-13 01:13:05 -0400] spheromak: In my infras i only have a few static machines like this
[2014-05-13 01:13:56 -0400] spheromak: bricker`LA: i think where your messing up is having static entries in the first place :P
[2014-05-13 01:14:13 -0400] bricker`LA: spheromak: sorry, I don't follow
[2014-05-13 01:14:22 -0400] spheromak: well no need to have each mac in here
[2014-05-13 01:14:33 -0400] bradbeam: you might be able to pull that information via lldp and build up your list form there
[2014-05-13 01:14:37 -0400] spheromak: you could have a naming policy based on ip or mac addr, and let them all be dynamic
[2014-05-13 01:14:59 -0400] spheromak: dhcp_host is for static host entries or special casing
[2014-05-13 01:15:34 -0400] spheromak: you could even set it up so that hosts can request the dhcp/dns name they want
[2014-05-13 01:15:42 -0400] spheromak: to simplify bootstrsapping
[2014-05-13 01:15:58 -0400] spheromak: *bootstrapping
[2014-05-13 01:16:00 -0400] bricker`LA: spheromak: that's what I'm trying to do - set a "private_ipaddress" attribute on a node and the DHCP will be setup for it.
[2014-05-13 01:16:17 -0400] spheromak: ah so they are already getting a dynamic address/name
[2014-05-13 01:16:22 -0400] spheromak: and you are adding another address/name ?
[2014-05-13 01:16:26 -0400] bricker`LA: spheromak: I am new to setting up DHCP so I don't understand the "naming policy"/"dynamic" approach
[2014-05-13 01:16:32 -0400] spheromak: ah
[2014-05-13 01:16:50 -0400] bricker`LA: spheromak: well, the hosts entries are being created on the dhcp server, and are pulling the IP and mac from the node attributes
[2014-05-13 01:16:53 -0400] spheromak: https://github.com/spheromak/dhcp-cook/blob/master/attributes/default.rb#L38
[2014-05-13 01:16:55 -0400] spheromak: bricker`LA:
[2014-05-13 01:17:03 -0400] spheromak: that sets the default naming policy for hte dhcp server
[2014-05-13 01:17:27 -0400] spheromak: by default if you have no mac/ip/hosts in your dhcp and define the pool
[2014-05-13 01:17:41 -0400] spheromak: then anyhost will assign its mac address as a hostname, and get an ip from the pool
[2014-05-13 01:17:59 -0400] spheromak: you can read up in the isc docs of dhcp for that
[2014-05-13 01:18:15 -0400] spheromak: my point is: do you need to statically assign ip and name to all these hosts ?
[2014-05-13 01:18:20 -0400] spheromak: does it matter ?
[2014-05-13 01:18:39 -0400] spheromak: cause your sorta circumventing what is sweet about dhcp in the firstplace
[2014-05-13 01:18:53 -0400] bricker`LA: spheromak: not really, I just like being able to have consistent IPs (like a master and slave server would have sequential IPs), but that's not mandatory
[2014-05-13 01:19:11 -0400] spheromak: yea better served with metadata/chef
[2014-05-13 01:19:19 -0400] spheromak: so if you remove all your hosts entry stuff
[2014-05-13 01:19:22 -0400] spheromak: your nodes will just work
[2014-05-13 01:19:28 -0400] spheromak: but they will have macaddr for a name
[2014-05-13 01:19:33 -0400] spheromak: with my base cook there
[2014-05-13 01:19:43 -0400] bricker`LA: interesting
[2014-05-13 01:19:51 -0400] spheromak: you can define the name option as a per-pool setting as well
[2014-05-13 01:20:00 -0400] spheromak: and you can play with the host-name option settings
[2014-05-13 01:20:15 -0400] spheromak: http://www.ipamworldwide.com/server-configuration-parameters.html
[2014-05-13 01:20:18 -0400] spheromak: :D
[2014-05-13 01:21:28 -0400] spheromak: bricker`LA: this is meant to tie into dns as well
[2014-05-13 01:21:57 -0400] spheromak: I've used it in a configuration where clients can specify their name. so your knife bootstrapp can set hostname that dhcp uses to populate dns
[2014-05-13 01:22:09 -0400] spheromak: tho theres security implications of letting clients do that
[2014-05-13 01:22:31 -0400] bricker`LA: spheromak: so: remove the hosts entries on the dhcp server; reboot each server to get the dynamically-assigned info? I am still confused about how it will then connect an IP to a server without the hosts entries
[2014-05-13 01:22:44 -0400] spheromak: ?
[2014-05-13 01:22:45 -0400] digitalchild: whats the best way to run setfacl in a recipe?
[2014-05-13 01:22:55 -0400] spheromak: bricker`LA: thats what dhcp does. gives ip's to hosts.
[2014-05-13 01:23:11 -0400] spheromak: bricker`LA: if you tie dhcp to bind then the dns gets updated with that name
[2014-05-13 01:23:32 -0400] bricker`LA: spheromak: So the dhcp server is responsible for updating the 'ifconfig' information?
[2014-05-13 01:23:38 -0400] spheromak: bricker`LA: indeed
[2014-05-13 01:23:42 -0400] bricker`LA: spheromak: ah hah
[2014-05-13 01:23:43 -0400] spheromak: well dhcp-client
[2014-05-13 01:23:48 -0400] spheromak: but yea
[2014-05-13 01:23:48 -0400] bricker`LA: right
[2014-05-13 01:24:09 -0400] spheromak: server tells clients the nameservers/routers/and ip it should have depending on the network segment
[2014-05-13 01:24:10 -0400] bricker`LA: spheromak: I just leveled up thanks to you
[2014-05-13 01:24:20 -0400] spheromak: bricker`LA: no problem glad i could help.
[2014-05-13 01:25:07 -0400] spheromak: bricker`LA: all this can be based on groups too. not just pools
[2014-05-13 01:25:40 -0400] spheromak: bricker`LA: reading up on dhcp server is higly reccomended
[2014-05-13 01:25:47 -0400] spheromak: its quite powerfull.
[2014-05-13 01:28:55 -0400] bricker`LA: spheromak: will I have to disable "use_databags" or anything else special for this to work?
[2014-05-13 01:29:43 -0400] spheromak: nop
[2014-05-13 01:29:54 -0400] spheromak: i mean if your not using databags don't use them
[2014-05-13 01:29:57 -0400] spheromak: i.e. disable it :D
[2014-05-13 01:35:25 -0400] bricker`LA: got it
[2014-05-13 01:36:30 -0400] digitalchild: how would you do a conditional in an erb template?
[2014-05-13 01:36:50 -0400] bricker`LA: <% if something %>something<% else %>not something<% end %>
[2014-05-13 01:36:56 -0400] digitalchild: sweet
[2014-05-13 01:36:57 -0400] digitalchild: thanks
[2014-05-13 01:37:07 -0400] digitalchild: can something just be the standard ruby stuff ?
[2014-05-13 01:37:17 -0400] digitalchild: like if node.run_list.roles.include?('somerole')
[2014-05-13 01:37:30 -0400] bricker`LA: digitalchild: yep, everything between <% %> gets interpreted as Ruby
[2014-05-13 01:37:35 -0400] digitalchild: thanks
[2014-05-13 01:37:37 -0400] bricker`LA: hence "Embedded RuBy"
[2014-05-13 01:37:49 -0400] digitalchild: still kinda new to all this
[2014-05-13 01:37:52 -0400] bricker`LA: :)
[2014-05-13 01:39:32 -0400] digitalchild: should i be using full <%= ?
[2014-05-13 01:39:39 -0400] bricker`LA: digitalchild: not for conditionals
[2014-05-13 01:39:40 -0400] digitalchild: for good practice
[2014-05-13 01:39:42 -0400] digitalchild: ok
[2014-05-13 01:39:57 -0400] bricker`LA: digitalchild: <%= "This will be printed" %> <% "this will not be" %>
[2014-05-13 01:40:15 -0400] digitalchild: thanks
[2014-05-13 01:40:42 -0400] digitalchild: trying to make sure my ntp cookbook handles my samba dcs for time sync
[2014-05-13 01:41:17 -0400] darkside_: isn't the community cookbook good? :)
[2014-05-13 01:41:20 -0400] darkside_: for ntp
[2014-05-13 01:41:47 -0400] digitalchild: im learning so im writing everything from scratch
[2014-05-13 01:42:43 -0400] darkside_: me too, i'm writing my company's application cookbook from scratch and abusing the public cookbooks as much as i can :)
[2014-05-13 01:43:21 -0400] digitalchild: i've written 37 cookbooks in the last 2 weeks
[2014-05-13 01:43:52 -0400] digitalchild: instead of a mega cookbook i just have lots of little ones then assign those to the roles
[2014-05-13 01:44:19 -0400] digitalchild: i'm sure that'll probably bite me in the ass at some point but so far its working :)
[2014-05-13 02:08:02 -0400] nyeedi: Hi all
[2014-05-13 02:08:39 -0400] nyeedi: can we use include_recipe in ruby_block
[2014-05-13 02:09:56 -0400] coderanger: nyeedi: No
[2014-05-13 02:11:24 -0400] nyeedi: Codemonkey, any other options to call another recipe inside ruby_block
[2014-05-13 02:29:13 -0400] cwj: any windows chefs here who could help shed some light on using 'knife winrm' via ssl transport?
[2014-05-13 02:29:46 -0400] cwj: i have credentials that work via plaintext but not over ssl (https), i am confused
[2014-05-13 02:35:59 -0400] bricker`LA: spheromak: dhcp server's 'INTERFACES' config is set to eth1, our external interface, but the dhcp server is only used to serve internal IPs. Does this sound correct? It still works somehow.
[2014-05-13 02:36:14 -0400] spheromak: hrm
[2014-05-13 02:36:16 -0400] bricker`LA: The internal interface is eth0
[2014-05-13 02:36:20 -0400] spheromak: bricker`LA: sounds like a bug!
[2014-05-13 02:36:37 -0400] bricker`LA: :O
[2014-05-13 02:37:00 -0400] bricker`LA: interesting
[2014-05-13 02:37:04 -0400] bricker`LA: I wonder how it's working then
[2014-05-13 02:37:28 -0400] bricker`LA: I'm afraid to change stuff around, we have some production services running on this :(
[2014-05-13 02:52:56 -0400] brauliobo_: hello all, i'm pretty new to chef, so I have a basic question. I wan't to have multiple wordpress sites on a computer, so I've modified the cookbook to support them in multiple dirs. But now I don't understand how to config it. All of them would need to use the key 'wordpress' on the node's json! That's the problem! How can I configure that?
[2014-05-13 02:53:48 -0400] brauliobo_: or should I create another node (using a different domain name) json that somehow 'inherits' the other json configuration?
[2014-05-13 02:55:39 -0400] digitalchild: hmm what am i missing to have knife ssh 'name:somenode' 'sudo chef-client' --ssh-user root
[2014-05-13 02:55:58 -0400] digitalchild: im getting 'does not have the required attribute to establist the connection..
[2014-05-13 02:58:54 -0400] robawt: hey yawls
[2014-05-13 02:59:01 -0400] robawt: what's the best way to upgrade chef?
[2014-05-13 02:59:22 -0400] robawt: if i used the install.sh to initially install it, is that the only method?
[2014-05-13 03:00:26 -0400] bricker`LA: spheromak: ah... eth0 is the external interface for the dhcp server is running on... everything else has it flipped. That's confusing.
[2014-05-13 03:08:04 -0400] spheromak: ah
[2014-05-13 03:08:14 -0400] spheromak: bricker`LA: heh cool glad its not a bug
[2014-05-13 03:25:57 -0400] digitalchild: i'm getting an error when trying to install the vmware-tools-esx-nox but its not a very helpful error
[2014-05-13 03:26:13 -0400] digitalchild: returned 1, expected -
[2014-05-13 03:26:16 -0400] digitalchild: err, expected 0
[2014-05-13 03:26:40 -0400] digitalchild: and the declared block from file is even reading the correct version number from yum...
[2014-05-13 03:54:59 -0400] bricker`LA: Using chef enterprise, if I have a node "web001", the client permissions (for client web001) aren't automatically added to the node, so I have to go in and do it manually for every node. How do I do this automatically?
[2014-05-13 04:30:01 -0400] digitalchild: worked out my vmware issue. forgot to import the pub key for the repo..
[2014-05-13 04:30:03 -0400] digitalchild: whoops
[2014-05-13 04:31:43 -0400] robawt: digitalchild: that'll happen
[2014-05-13 04:53:02 -0400] ssd7: Ohai chefs
[2014-05-13 04:57:29 -0400] Brad_K: Ohai!
[2014-05-13 05:24:44 -0400] bricker`LA: Is it a bad idea to put multiple load balancers (i.e. instances of haproxy) on a single VM?
[2014-05-13 05:28:21 -0400] digitalchild: wouldn't that defeat the purpose of a load balancer..
[2014-05-13 05:41:04 -0400] bricker`LA: digitalchild: I don't think so, the lb is only a proxy to the servers doing the real work (of running the app and serving the requests)
[2014-05-13 05:43:19 -0400] digitalchild: i haven't played with them enough
[2014-05-13 06:03:15 -0400] bricker`LA: spheromak: still there? (sorry to keep bothering you)
[2014-05-13 06:16:42 -0400] cloudgeek: I am hiring Chef guys in India , no of opening is 5. does it right way ? or else I need to talk with admin
[2014-05-13 06:34:19 -0400] Cope: bricker`LA: I think it'd be fine, as long as you're comfortable with losing access to all your backend services if you lose your one vm
[2014-05-13 06:34:26 -0400] Cope: but haproxy doesn't use much resource
[2014-05-13 06:34:47 -0400] bricker`LA: I have a template with an "only_if" block which is returning false, and a "notifies", but the "notifies" isn't checking the "only_if" block, and fails because the service isn't available. How do I get around this?
[2014-05-13 06:35:31 -0400] Cope: could you show the code, please?
[2014-05-13 06:35:53 -0400] bricker`LA: Cope: yep, one sec
[2014-05-13 06:36:03 -0400] bricker`LA: Cope: good point re: single-point-of-failure
[2014-05-13 06:37:18 -0400] bricker`LA: Cope: https://gist.github.com/bricker/77e757e8ba3f3781dc04
[2014-05-13 06:38:00 -0400] Cope: aha
[2014-05-13 06:38:09 -0400] Cope:  service[nginx] cannot be found in the resource collectio
[2014-05-13 06:38:19 -0400] Cope: that's your problem
[2014-05-13 06:38:40 -0400] bricker`LA: Cope: exactly, but I would expect the resource to be skipped completely (including the reload) if the "only_if" block is false
[2014-05-13 06:38:47 -0400] Cope: ah no
[2014-05-13 06:38:57 -0400] Cope: that's not how chef works :)
[2014-05-13 06:39:17 -0400] bricker`LA: Cope: Since it's not, how do I work around this? This is an application cookbook which will be installed on servers which may have nginx and which may not
[2014-05-13 06:39:29 -0400] Cope: bricker`LA: define your service
[2014-05-13 06:39:37 -0400] Cope: aha, interesting
[2014-05-13 06:40:03 -0400] bricker`LA: Cope: should I wrap the entire "template" resource in the conditional? eg: `if ::File.exists?(...); template ...; end
[2014-05-13 06:40:11 -0400] shimo: btw are you using /etc/hginx on purpose?
[2014-05-13 06:40:16 -0400] bricker`LA: I guess that probably won't work
[2014-05-13 06:40:21 -0400] Cope: it seems to be that you wouldn't want to use this code at all on a machine without nginx
[2014-05-13 06:40:37 -0400] bricker`LA: shimo: heh, no, gist typo :)
[2014-05-13 06:40:48 -0400] bricker`LA: shimo: (I replaced a variable with its value for gisty purposes)
[2014-05-13 06:40:58 -0400] Cope: so I'd just put any nginx-specific logic somewhere where it'd be used by webservers
[2014-05-13 06:41:12 -0400] Cope: and only use that on machines that need it
[2014-05-13 06:41:41 -0400] bricker`LA: Cope: indeed! Great idea, I'll make another recipe in this cookbook and add it to the webhead runlists only
[2014-05-13 06:41:45 -0400] bricker`LA: Cope: thanks
[2014-05-13 06:43:00 -0400] Cope: coderanger: if you're awake... incoming hug, just because I was thinking of you this morning, and you're awesome. That's all.
[2014-05-13 06:45:38 -0400] JensOfSweden: Anyone know how i should format a json array for a post request to the chef server to add a new node?
[2014-05-13 06:46:44 -0400] coderanger: JensOfSweden: Not sure what you mean
[2014-05-13 06:47:00 -0400] spheromak: knife node from file
[2014-05-13 06:47:05 -0400] coderanger: the body of the POST should be a hash, not an array
[2014-05-13 06:47:28 -0400] spheromak: otherwise if your posting to the server directly, and assumning you have auth headers. http://docs.opscode.com/api_chef_server.html
[2014-05-13 06:47:48 -0400] spheromak: coderanger: bah you give to much
[2014-05-13 06:47:50 -0400] spheromak: ;)
[2014-05-13 06:48:09 -0400] JensOfSweden: coderanger: so if i dont do a .to_json at the end of the hash it might work =)
[2014-05-13 06:48:51 -0400] coderanger: spheromak: Just passing through :-) finished Child of Light so I've got a few minutes before bedtime :)
[2014-05-13 06:48:58 -0400] Malkav: Hey guys. Is there a way to modify a specific line in a text file in chef?
[2014-05-13 06:49:09 -0400] coderanger: JensOfSweden: Can you pastebin your code? Most HTTP libs encode to JSON for you
[2014-05-13 06:49:38 -0400] JensOfSweden: spheromak: i got the headers since i use Chefs own rest gem to post
[2014-05-13 06:49:40 -0400] spheromak: yea bed time for me.
[2014-05-13 06:49:42 -0400] Malkav: I know the line number and the exact text that will be there, so can I just replace it?
[2014-05-13 06:49:54 -0400] coderanger: Malkav: There are two answers
[2014-05-13 06:49:57 -0400] JensOfSweden: getting 400 bad request witch seems to indicate malformed array
[2014-05-13 06:50:13 -0400] spheromak: malformed body
[2014-05-13 06:50:17 -0400] coderanger: The good answer is "don't do that its really fragile", the more correct answer is "use chef fileedit"
[2014-05-13 06:50:49 -0400] coderanger: Malkav: http://ruby-doc.org/gems/docs/n/naked-chef-0.9.15.3/Chef/Util/FileEdit.html + ruby_block
[2014-05-13 06:51:02 -0400] coderanger: Malkav: Here be dragons though
[2014-05-13 06:51:03 -0400] Malkav: coderanger I know it's fragile, but I need to enable a repo by default
[2014-05-13 06:51:20 -0400] coderanger: Malkav: Putting the file fully under the control of Chef is a much better option
[2014-05-13 06:51:26 -0400] Malkav: so all the other receipes will be able to use it
[2014-05-13 06:51:37 -0400] coderanger: JensOfSweden: 400 is just generic "there was something wrong"
[2014-05-13 06:52:13 -0400] JensOfSweden: coderanger: http://pastebin.com/F2fvjArP
[2014-05-13 06:52:21 -0400] Malkav: coderanger you mean putting it into a template?
[2014-05-13 06:52:41 -0400] coderanger: Malkav: Yeah, template or cookbook file
[2014-05-13 06:52:56 -0400] coderanger: Malkav: Basically Chef is best at convergent things, stuff where you know the desired state
[2014-05-13 06:53:06 -0400] coderanger: Malkav: FileEdit is more or less a delta, or a diff
[2014-05-13 06:53:27 -0400] Malkav: ok, got it
[2014-05-13 06:53:55 -0400] JensOfSweden: coderanger: i want to be able to create nodes and remove nodes or update nodes with rest trough a ruby program when an event occurs in openstack, got all but the creation down =)
[2014-05-13 06:54:24 -0400] Malkav: another one: I need to run some code (I use bash to do it) only if a specific file is not present. How can I do that?
[2014-05-13 06:54:32 -0400] coderanger: JensOfSweden: Sec
[2014-05-13 06:55:05 -0400] coderanger: Malkav: bash resource, only_if { ! File.exists?('/path/to/whatever') }
[2014-05-13 06:55:16 -0400] coderanger: Malkav: not_if and only_if are supported on all resources
[2014-05-13 06:57:29 -0400] Malkav: great, thanks
[2014-05-13 06:57:58 -0400] JensOfSweden: coderanger: i got such wierd requests all the time =)
[2014-05-13 06:58:07 -0400] coderanger: JensOfSweden: Would I be correct in guessing you are mostly familiar with PHP?
[2014-05-13 06:58:29 -0400] JensOfSweden: coderanger: im mostly familiar with bash and perl =)
[2014-05-13 06:59:08 -0400] coderanger: JensOfSweden: I know its not super helpful, but https://github.com/sethvargo/chef-api is probably going to be much easier to use, let me try and digest this code though
[2014-05-13 07:01:10 -0400] coderanger: JensOfSweden: Okay, so you don't want the to_json on chef_array, chef does that for you in the HTTP client
[2014-05-13 07:01:25 -0400] coderanger: JensOfSweden: And you need to include the default, override, and automatic levels even if they are empty
[2014-05-13 07:03:07 -0400] coderanger: JensOfSweden: Also the json_class must be Chef::Node, caps matter
[2014-05-13 07:04:52 -0400] JensOfSweden: coderanger: Ill test those changes
[2014-05-13 07:06:45 -0400] coderanger: JensOfSweden: Good luck :-) Unfortunately I think Perl might be the only major dynamic lang that doesn't have a native client library for Chef, but ChefAPI (Ruby) or PyChef (Python) might be helpful for little scripts like that
[2014-05-13 07:07:08 -0400] coderanger: JensOfSweden: And there is also knife exec, which gives you at least a little bit of a wrapper around the the chef gem
[2014-05-13 07:08:31 -0400] JensOfSweden: coderanger: Yea, trying to do more then just chef in the end, like update DNS and setup pools in the loadbalancer on instance create and remove everything on instance delete in openstack =)
[2014-05-13 07:09:27 -0400] JensOfSweden: Sleep tight
[2014-05-13 09:10:23 -0400] mcmenace: hi
[2014-05-13 09:10:29 -0400] mcmenace: have some basic chef questions
[2014-05-13 09:10:33 -0400] mcmenace: anyone can help
[2014-05-13 09:10:38 -0400] mcmenace: have a chef repo
[2014-05-13 09:11:12 -0400] mcmenace: trying to figure out which recipes can be called from outsite
[2014-05-13 09:11:21 -0400] mcmenace: roles respectively
[2014-05-13 09:11:36 -0400] mcmenace: or how to execute the chef procedure
[2014-05-13 09:11:38 -0400] mcmenace: ?
[2014-05-13 09:14:46 -0400] ambientsound: mcmenace: try reading the documentation for knife bootstrap and knife cookbook.
[2014-05-13 09:15:13 -0400] ambientsound: bootstrap tells the node its run list, where you can specify e.g. recipe[foo] and role[bar]
[2014-05-13 09:18:37 -0400] JensOfSw_: mcmenace: what do you meen with called from outside?
[2014-05-13 09:28:12 -0400] zmack: hey there. anyone happen to know what i can pass to easy_install_package to have it install a package from github ?
[2014-05-13 09:28:36 -0400] zmack: should i do that whole business where i set up a local file to do a wget and then shove that into the source ?
[2014-05-13 09:30:37 -0400] mcmenace: ambientsound: where are the recipe specified that I can call with knife?
[2014-05-13 09:30:53 -0400] mcmenace: In Cheffile as cookbook 'callme'
[2014-05-13 09:30:57 -0400] mcmenace: ?
[2014-05-13 09:31:48 -0400] mcmenace: refering to your example: where is foo and bar specified?
[2014-05-13 09:33:11 -0400] ambientsound: mcmenace: in cookbooks/foo and roles/bar.rb, respectively
[2014-05-13 09:33:28 -0400] ambientsound: try "knife cookbook create foo"
[2014-05-13 09:33:41 -0400] mcmenace: I have no cookboos in the repo only site-cookbooks
[2014-05-13 09:33:44 -0400] ambientsound: or "knife cookbook site install apt"
[2014-05-13 09:35:26 -0400] mcmenace: ok, maybe I must be more specific
[2014-05-13 09:36:05 -0400] mcmenace: I am working with a virtualization server solution that supplies a git repo where you can push chef-repos
[2014-05-13 09:36:29 -0400] mcmenace: when creating the server I need to specify a recipe or a role that should be executed by the automation process
[2014-05-13 09:36:49 -0400] mcmenace: the repo (which I did not create myself) was pushed
[2014-05-13 09:36:53 -0400] mcmenace: automation starts
[2014-05-13 09:37:06 -0400] mcmenace: but never finds the given recipe/role
[2014-05-13 09:37:35 -0400] mcmenace: so I am wondering how I can find out from a chef-repo which recipes/roles are contained and could be executed
[2014-05-13 09:37:48 -0400] mcmenace: so that I can provide the virtualization solution with the right recipe
[2014-05-13 09:45:22 -0400] mcmenace: ??
[2014-05-13 09:55:53 -0400] StFS: Hi. We are trying to figure out environments and not quite getting it. We have a cookbook and use test-kitchen. We were able to specify an environment in out kitchen.yaml and that simply went and found an attributes/env-name.rb file and that worked beutifully (we simply overwrote attributes in that file that we wanted for that environment).
[2014-05-13 09:57:02 -0400] StFS: However, now we're trying to do the same thing when deploying to an actual server and we're having problems. Running "knife solo -E env_name ..." doesn't seem to work the same as with test-kitchen.
[2014-05-13 09:57:59 -0400] StFS: Is there some trick to this? Does the -E env_name not just result in the env_name.rb file being loaded from the attributes directory and overwriting attributes?
[2014-05-13 11:57:47 -0400] whiteadam: fart noises
[2014-05-13 12:06:12 -0400] Evangael: hey guys, when you have multiple cookbooks, which depends on a bunch of other cookbooks too, and, obviously, you run daily in the dreadful dependencies hell, how many goat do you sacrifice and too which god? :P
[2014-05-13 12:06:31 -0400] n1ko: berkshelf
[2014-05-13 12:07:46 -0400] Evangael: Berkshelf 3 I guess ? We are on Version 2
[2014-05-13 12:08:04 -0400] n1ko: yep
[2014-05-13 12:08:13 -0400] whiteadam: Evangael: yeah, i sacrifice them to berkshelf.
[2014-05-13 12:08:44 -0400] workmad3: Evangael: berkshelf has all my goats, which were used to purchase a local berkshelf-api that indexes the community site and my chef server
[2014-05-13 12:08:46 -0400] whiteadam: Evangael: This may help, it helped me tons: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-05-13 12:11:35 -0400] Evangael_: n1ko, whiteadam, thank you. I guess I have to upgrade that then. Do I absolutely need the berkshelf-api servers too?
[2014-05-13 12:11:49 -0400] n1ko: we dont use them
[2014-05-13 12:11:58 -0400] n1ko: git tags seems to be enough
[2014-05-13 12:12:11 -0400] n1ko: (for private cookbooks)
[2014-05-13 12:12:23 -0400] whiteadam: yeah, same here
[2014-05-13 12:12:39 -0400] whiteadam: I'm too dumb to get too complicated with it
[2014-05-13 12:12:41 -0400] workmad3: n1ko: do git tags work for private cookbooks that depend on other private cookbooks?
[2014-05-13 12:12:54 -0400] workmad3: (they didn't when I started running berkshelf-api locally :) )
[2014-05-13 12:19:01 -0400] whiteadam: workmad3: good question, i have no idea
[2014-05-13 12:19:32 -0400] whiteadam: workmad3: Might be one for #berkshelf. I'm not fully awake, but in this case you might want the API server
[2014-05-13 12:19:33 -0400] Evangael_: I'm curious about that too. I guess I'll have to mock a test for that
[2014-05-13 12:20:12 -0400] whiteadam: Evangael_: Me too, but at this point I am tired of creating servers
[2014-05-13 12:20:16 -0400] whiteadam: :)
[2014-05-13 12:20:18 -0400] workmad3: whiteadam: I just run it locally when I need to
[2014-05-13 12:20:33 -0400] whiteadam: workmad3: ohhh, I see what you mean
[2014-05-13 12:21:15 -0400] workmad3: although I do intend to set up a more persistent endpoint at some point (probably on my chef server)
[2014-05-13 12:21:27 -0400] Evangael_: whiteadam, yeah, I can relate to that, but I'm also tired of wasting time in dependencies hell :p
[2014-05-13 12:22:36 -0400] whiteadam: Evangael_: amen. Right now my nightmare is needing an LDAP, which I hate, so I'm like.. ugh, more reading
[2014-05-13 12:24:44 -0400] Evangael_: whiteadam: seems we have a similar life, then, there was some talk around here of integrating a LDAP too. -_-'
[2014-05-13 12:26:22 -0400] whiteadam: Evangael_: I'm looking at FreeIPA at the moment. Seems legit, but I can't say I have much experience with LDAP and the like. I wish there was just a SaaS that could do it.
[2014-05-13 12:31:43 -0400] Evangael_: whiteadam: Why not openldap ? There's a chef cookbook all ready to be used
[2014-05-13 12:33:30 -0400] whiteadam: Evangael_: So, from what I have learned... OpenLDAP is just LDAP, whereas FreeIPA is OpenLDAP, along with all of ther other crap needed to properly do things.
[2014-05-13 12:34:13 -0400] StFS: whiteadam: I recommend FreeIPA
[2014-05-13 12:34:18 -0400] whiteadam: Evangael_: Not sure which flavor you use, but this is what I'm reading now: https://access.redhat.com/site/documentation/en-US/Red_Hat_Enterprise_Linux/6/html/Identity_Management_Guide/index.html
[2014-05-13 12:34:48 -0400] whiteadam: StFS: Do you use all of the built in DNS and stuff? I'm wary of that at the moment.
[2014-05-13 12:35:33 -0400] Evangael_: whiteadam: Ughhh. That's quite lengthy. I'll try to handle that hot potato to somebody else in the team!
[2014-05-13 12:35:53 -0400] StFS: whiteadam: no... we integrated it into an existing windows environment (didn't go all the way though, we didn't have sync set up) but we were using the kerberos stuff
[2014-05-13 12:35:57 -0400] StFS: whiteadam: I
[2014-05-13 12:35:58 -0400] whiteadam: Evangael_: I know! That's why I am dreading it.
[2014-05-13 12:36:29 -0400] whiteadam: StFS: Yeah, luckly our corporate IT won't allow that, so we get to build a new one for our "cloud systems"
[2014-05-13 12:36:41 -0400] whiteadam: StFS: I just don't want to have to manage it myself.
[2014-05-13 12:37:14 -0400] StFS: whiteadam: I'm not an expert in that by any stretch of that concept... but what we got up and running worked well and it had a lot of potential to go further (as I understand it now has certificate management integrated via dogtag which we could have used)
[2014-05-13 12:37:47 -0400] whiteadam: StFS: Yeah. They are all topics far from me as well. When it says key management, is means the ssh keys, right?
[2014-05-13 12:38:18 -0400] StFS: whiteadam: I think it basically means any certificates you want... including SSL certificates for webservers etc
[2014-05-13 12:38:29 -0400] whiteadam: StFS: fancy!
[2014-05-13 12:38:44 -0400] StFS: but again... take this with a grain (or a bag) of salt
[2014-05-13 12:39:08 -0400] whiteadam: StFS: No worries, I don't trust you one bit :)
[2014-05-13 12:39:25 -0400] StFS: whiteadam: you sound like a smart guy
[2014-05-13 12:40:30 -0400] StFS: whiteadam: http://pki.fedoraproject.org/wiki/PKI_Main_Page (see Key Features)
[2014-05-13 12:41:28 -0400] whiteadam: StFS: That's pretty sweet. We have all kinds of whacky use cases with clients that it can help with. PCI, HIPPA, people who know everything
[2014-05-13 12:42:37 -0400] StFS: whiteadam: my (wet) dream would be to set up a cloud environment using this for everything... including DNS management.. integrating with Chef sounds like a cherry on top of that :)
[2014-05-13 12:47:15 -0400] whiteadam: StFS: Yeah, that's what I'm trying to construct in my brain. As long as I can eliminate the SPoFs, I'll be good.
[2014-05-13 13:17:22 -0400] b-dean: I'm getting a seg fault from a chef 11.12.4's remote_file provider on CentOS. Anyone have any ideas on what to do to figure out what's wrong?
[2014-05-13 13:18:29 -0400] b-dean: I was able to reproduce it on a co-worker's machine as well
[2014-05-13 13:20:34 -0400] bmurt: im just starting to get chef setup on my os x laptop (i've been a puppet user, but new company = new tool :) )... anyways, im trying to follow along with the learning chef and attempting to create a new cookbook via knife, but running into an error. any ideas on https://gist.github.com/bmurt/2a192dbbece526c99616
[2014-05-13 13:21:09 -0400] bmurt: b-dean: if anything, i'd assume you should gist or pastie the example code & result/trace then possibly file a bug
[2014-05-13 13:21:18 -0400] bmurt: i'm following https://learnchef.opscode.com/tutorials/create-your-first-cookbook/#configureapacheonlinux
[2014-05-13 13:21:56 -0400] bmurt: this is suppose to be a workstation w/ vagrant that ill be using for testing
[2014-05-13 13:33:49 -0400] jperry: anyone know if there is a way to generate a metadata.json from a metadata.rb file?
[2014-05-13 13:34:04 -0400] jperry: sorry I meant the other way around metadata.json -> metadata.rb
[2014-05-13 13:34:21 -0400] StFS: curiosity question (sorry if this is a touchy subject), but is there any good OSS web ui alternative for chef server? I know about Chef Enterprise but we're not going there, at least not just yet.
[2014-05-13 13:34:51 -0400] b-dean: bmurt: I've never used their tutorials but just from looking at your error it looks like  your knife.rb is saying  your cookbook directory is /var/chef where you (apparently) don't have permissions. Here's their docs on knife.rb: http://docs.opscode.com/config_rb_knife.html
[2014-05-13 13:35:17 -0400] gchristensen: StFS: most people move away from using the web UI, instead of working harder to use it
[2014-05-13 13:36:06 -0400] gchristensen: StFS: by implementing more automation, and enforcing all changes go through version control
[2014-05-13 13:36:10 -0400] StFS: gchristensen: yeah I'm not really asking for a web ui to administer chef... more of a dashboard type of thing to view the current status
[2014-05-13 13:38:50 -0400] StFS: and now that I said that  I realized I should be googling "chef dashboard"
[2014-05-13 13:42:55 -0400] StFS: I just watched a talk from ChefConf 2014 about container integration for Chef (http://www.youtube.com/watch?v=Fo4dtt6fXNc). I'm not quite clear on whether this is a Chef Enterprise feature or is it a part of OSS Chef?
[2014-05-13 14:15:26 -0400] Neozonz: can i put something like redis_server = node[:redis_server] in attributes?
[2014-05-13 14:17:07 -0400] brauliobo: hello all, i'm pretty new to chef, so I have a basic question. I wan't to have multiple wordpress sites on one server, so I've modified the cookbook to install them in multiple dirs. But now I don't understand how to config them. All of them would need to use the key 'wordpress' on the node's json! That's the problem! How can I configure that?
[2014-05-13 14:18:43 -0400] Neozonz: How are you using chef?
[2014-05-13 14:24:27 -0400] CPS: brauliobo_: attributes
[2014-05-13 14:24:42 -0400] CPS: you can use roles or environments to set attributes and have recipes act on them
[2014-05-13 14:33:21 -0400] brauliobo_: CPS: nice! i couldn't yet find how to use roles, could you please give me some reference
[2014-05-13 14:34:23 -0400] CPS: http://docs.opscode.com/essentials_roles.html
[2014-05-13 14:34:37 -0400] CPS: you can do knife role create <name> to get an empty role
[2014-05-13 14:35:11 -0400] CPS: in our setup, our production servers are in 1 of 5 data centers, so we have 5 roles that all set the "geo" attribute to a different value
[2014-05-13 14:35:24 -0400] CPS: that value is used to pull configuration data from a data bag
[2014-05-13 14:37:53 -0400] mmzyk: Your daily reminder that OSC 11.1.0 RC is out http://www.getchef.com/blog/2014/05/09/release-candidate-for-open-source-chef-server-11-1-0/
[2014-05-13 14:38:13 -0400] helal: Anyone else running into UTF-8 encoding issues when using remote_file to get a binary?
[2014-05-13 14:38:21 -0400] mmzyk: Try it out, if you find any issues let me know. So far I know of nothing that has come up, so well look to officially release soonish.
[2014-05-13 14:38:36 -0400] helal: We are using omnibus chef-client and remote_file downloads blow up due to encoding issues.
[2014-05-13 14:41:52 -0400] mmzyk: helal my guess would be youre running into this bug: https://tickets.opscode.com/browse/CHEF-4746
[2014-05-13 14:42:26 -0400] helal: haha - yes, we have looked at that bug report and cried
[2014-05-13 14:42:35 -0400] helal: looking for ideas about workarounds
[2014-05-13 14:43:08 -0400] helal: installing ruby 2.0 and then gem-installing chef seems to work, but it's pretty painful from a bootstrapping point of view
[2014-05-13 14:43:30 -0400] mmzyk: I unfortunately dont have enough background knowledge to offer any work arounds.
[2014-05-13 14:43:59 -0400] helal: mmzyk: are you having this issue?
[2014-05-13 14:44:23 -0400] helal: we are just trying to find out if there's something we can do to avoid (like use an older chef-client gem, etc)
[2014-05-13 14:44:36 -0400] mmzyk: No, but then Im probably not executing chef runs as much as you are, given Im a chef engineer who works on the server.
[2014-05-13 14:45:27 -0400] mmzyk: helal It apperas to have been reported in 11.8.0 of the client. I have no clue if versions older than that run into the issue or not.
[2014-05-13 14:45:51 -0400] mmzyk: It appears, from the ticket, that its slated to be fixed in the next release, but I dont have a timeframe on that.
[2014-05-13 14:48:41 -0400] mw1987: hell, I'm new to chef, what does the communicate "Cookbook git not found. If you're loading git from another cookbook, make sure you configure the dependency in your metadata"
[2014-05-13 14:48:55 -0400] mw1987: so I guess it means I have to install "git cookbook"
[2014-05-13 14:50:46 -0400] mmzyk: mw1987 Yeah, you have a dependency on the git cookbook somewhere and it isnt being found. You need to ensure its present on your server and if a cookbook needs it that its declared in the cookbook metadata that is using it.
[2014-05-13 14:51:15 -0400] helal: mmzyk thank you for your help
[2014-05-13 14:51:33 -0400] mmzyk: helal not sure I was much help on that. :)
[2014-05-13 14:52:14 -0400] helal: mmzyk: do you have a commit hash for the fix for chef-client?
[2014-05-13 14:52:29 -0400] helal: we could install the gem from pre-release code (directly from github)
[2014-05-13 14:53:39 -0400] mmzyk: helal Im not sure a fix has yet been commited, its just marked to be fixed by the next release.
[2014-05-13 14:54:29 -0400] CPS: helal: have you considered notepad++ for that linefeed thing?
[2014-05-13 14:54:42 -0400] helal: CPS: we aren't using windows
[2014-05-13 14:54:44 -0400] CPS: it can convert one to the other and retain source encoding/linefeeds
[2014-05-13 14:54:49 -0400] CPS: oh
[2014-05-13 14:54:52 -0400] helal: it happens to us with tarballs
[2014-05-13 14:54:58 -0400] helal: that we don't controll
[2014-05-13 15:00:06 -0400] jonlives: benner: lietuviskai?
[2014-05-13 15:00:58 -0400] benner: oops
[2014-05-13 15:01:51 -0400] jonlives: benner: nesvarbu ;)
[2014-05-13 15:03:43 -0400] frots: I'm having trouble with the knife-azure plugin. After the virtual machine is launched, bootstrapping fails because of an HTTP-401 error (authentication). I can use WinRM with the same credentials though. Anyone with knife-azure / winrm experience?
[2014-05-13 15:10:50 -0400] mondo: Is the source for some of the built in resources available somewhere?  Specifically I'm looking for the source to the built in cron resource
[2014-05-13 15:12:02 -0400] mmzyk: mondo knife is bundled as a part of the chef-client, so its all open sourced
[2014-05-13 15:12:15 -0400] mmzyk: mondo https://github.com/opscode/chef
[2014-05-13 15:12:17 -0400] CPS: https://github.com/opscode-cookbooks/cron
[2014-05-13 15:12:40 -0400] mondo: found what I needed https://github.com/opscode/chef/blob/master/lib/chef/resource/cron.rb, thanks mmzyk
[2014-05-13 15:13:10 -0400] mh8: hi - need help w/ the following:  ERROR: Chef::EncryptedDataBagItem::DecryptionFailure: Error decrypting data bag value: 'wrong final block length'. Most likely the provided key is incorrect
[2014-05-13 15:13:43 -0400] mmzyk: mh8 It sounds like you answered your own question?
[2014-05-13 15:13:44 -0400] mh8: i generated the key then created the data bag w/ that key
[2014-05-13 15:14:31 -0400] mmzyk: mh8 Where are you decrypting the databag? Maybe the client/node in question needs the key?
[2014-05-13 15:14:48 -0400] CPS: mmzyk: key not present gives a different error
[2014-05-13 15:14:59 -0400] mh8: the target node was bootstrapped w/ the same key
[2014-05-13 15:15:18 -0400] mh8: here's a knife example
[2014-05-13 15:15:22 -0400] CPS: mh8: have you compared the node's file to the original?
[2014-05-13 15:15:31 -0400] CPS: possibly corrupted
[2014-05-13 15:15:44 -0400] mh8: yes there's a 1 byte diff (xtra line)
[2014-05-13 15:16:05 -0400] CPS: there's your problem
[2014-05-13 15:16:06 -0400] mh8: but knife and chef-client are acting the same re the err
[2014-05-13 15:16:39 -0400] CPS: 1 byte diff will fuck up decryption
[2014-05-13 15:16:50 -0400] mh8: knife data bag show avwm_id_stg AVWMBPMS1
[2014-05-13 15:17:06 -0400] mh8: shows id, encrypt pass, port, db
[2014-05-13 15:17:25 -0400] mh8: knife data bag show avwm_id_stg AVWMBPMS1 --secret-file C:/Users/nkcx2it/.chef/secret_key ERROR: Chef::EncryptedDataBagItem::DecryptionFailure: Error decrypting data bag value: 'wrong final block length'. Most likely the provided key is incorrect
[2014-05-13 15:17:49 -0400] CPS: edit the file, remove the line
[2014-05-13 15:18:25 -0400] mh8: so if the key is fine to encrypt then why would it not work unencrypt/
[2014-05-13 15:18:56 -0400] CPS: because the file and the password are different
[2014-05-13 15:19:26 -0400] CPS: you said the file is the password plus newline
[2014-05-13 15:19:35 -0400] mh8: on the target
[2014-05-13 15:20:28 -0400] mh8: knife is w/ the repo
[2014-05-13 15:20:47 -0400] mh8: separating the 2
[2014-05-13 15:21:07 -0400] mh8: forget about the target node for a min
[2014-05-13 15:21:26 -0400] mh8: why is knife not able to decrypt
[2014-05-13 15:21:36 -0400] mh8: when i used to encrypt
[2014-05-13 15:22:03 -0400] mh8: how to determine corruption?
[2014-05-13 15:22:30 -0400] CPS: what command did you run to create the data bag?
[2014-05-13 15:23:34 -0400] mh8: knife data bag create --secret-file C:/Users/nkcx2it/.chef/secret_key avwm_id_stg AVWMBPMS1
[2014-05-13 15:24:00 -0400] brauliobo_: CPS: thanks! studying it now
[2014-05-13 15:24:10 -0400] mh8: then added comma to the end of the id and added password field
[2014-05-13 15:24:41 -0400] mh8: then ran knife data bag edit avwm_id_stg AVWMBMPS1
[2014-05-13 15:24:48 -0400] CPS: try creating another data bag, then decrypting it
[2014-05-13 15:24:50 -0400] mh8: to add port and db fields
[2014-05-13 15:25:16 -0400] CPS: wait did you do edit without passing --secret-file?
[2014-05-13 15:25:29 -0400] mh8: correct
[2014-05-13 15:25:39 -0400] CPS: that will probably break it
[2014-05-13 15:25:54 -0400] mh8: ok so just need to pass the secret file again
[2014-05-13 15:26:05 -0400] mh8: i don't want to encrypt anything but the password
[2014-05-13 15:26:09 -0400] CPS: i don't know about how chef works, but in general you can't mix encrypted and unencrypted data in the same container
[2014-05-13 15:26:26 -0400] CPS: use a different data bag then
[2014-05-13 15:26:40 -0400] mh8: give it a shot thx
[2014-05-13 15:34:04 -0400] billyoung: i'm trying to enable vagrant to use my local users ssh key to "git clone" a repository during an "up/provision" run - has anyone solved this problem?
[2014-05-13 15:34:59 -0400] billyoung: i am able to login and git clone, but not on a converge
[2014-05-13 15:55:30 -0400] gyre007_: why is bootstrap_version in my knife config ignore when creating servers with knife ec2 ? mm should it be ?
[2014-05-13 15:55:31 -0400] _pingu: when i wrote tests with chefspec or defined a kitchen.yml, I expected to define a node and all is fine, because the node already contains a run_list and an environment. instead i always have to define that separate. Why??
[2014-05-13 16:16:52 -0400] runfromnowhere: Alrightie so I tracked down my issue of yesterday but I'm not sure what's to blame - I have a cookbook that stores a value generated by the target system as a node.override attribute.  Chef server saves this attribute persistently, however when chef-client retrieves a node's object from the server for its initial run, the first thing it does is blow away node.override attributes (to replace with attributes specified via ...
[2014-05-13 16:16:58 -0400] runfromnowhere: ... command-line I believe).  Is this the proper Chef behavior and the cookbook shouldn't be storing data there?  Or is this improper behavior and chef-client shouldn't be blowing away the values retrieved from the server?
[2014-05-13 16:17:41 -0400] geggam: :environment => node[:node][:chef_environment] ... why is that not working..
[2014-05-13 16:20:35 -0400] runfromnowhere: geggam: Mebbe try node.environment although that returns the whole environment object as opposed to just the name...node.environment.to_s would be just the name
[2014-05-13 16:30:37 -0400] CPS: runfromnowhere: geggam i've been using node.chef_environment to compare to strings and it's been working fine
[2014-05-13 16:31:24 -0400] CPS: runfromnowhere: that's a ruby thing. you're reassigning the hash instead of adding to it
[2014-05-13 16:34:39 -0400] phil_s_stein: Are chef setup questions appropriate here? Or is there a #chef_n00b channel I should use?
[2014-05-13 16:35:25 -0400] savant: ask her
[2014-05-13 16:35:26 -0400] savant: here
[2014-05-13 16:35:44 -0400] phil_s_stein: Ok, thanks.
[2014-05-13 16:35:54 -0400] runfromnowhere: CPS: I though => was used in dynamic hash creation as well
[2014-05-13 16:35:57 -0400] runfromnowhere: thought, rather
[2014-05-13 16:36:59 -0400] phil_s_stein: I'm using knife bootstrap to install chef on a client. The install works, but then in attempts to register itself using a localhost URL:
[2014-05-13 16:37:03 -0400] phil_s_stein: Connection refused connecting to https://localhost/clients,
[2014-05-13 16:37:07 -0400] CPS: try using the merge function runfromnowhere
[2014-05-13 16:37:31 -0400] phil_s_stein: Where do I tell knife/chef to tell the client to use another server URL?
[2014-05-13 16:37:31 -0400] CPS: i'm not a ruby guru but what you describe is pretty straightforward
[2014-05-13 16:37:58 -0400] phil_s_stein: runfromnowhere: funny to see you here. Hello!
[2014-05-13 16:38:10 -0400] runfromnowhere: CPS: Wait, LOL sorry I'm a little out of it - is this in response to my question or in response to my response to geggam
[2014-05-13 16:38:23 -0400] runfromnowhere: phil_s_stein: <_<....>_>....hahah good to see you too :).  Seems we're in similar lines of work!
[2014-05-13 16:38:31 -0400] phil_s_stein: I guess so. :)
[2014-05-13 16:38:53 -0400] CPS: regarding the node attributes thing
[2014-05-13 16:39:08 -0400] CPS: i tagged you in both actually
[2014-05-13 16:39:14 -0400] runfromnowhere: Hahah yeah that's why I was confused
[2014-05-13 16:39:47 -0400] runfromnowhere: CPS: The problem is that chef-client is what's blowing away the override attributes on the node object it pulls down from the server during startup.  I'm trying to understand whether that's intentional behavior.
[2014-05-13 16:40:11 -0400] CPS: ah ok
[2014-05-13 16:40:31 -0400] CPS: read http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2014-05-13 16:40:48 -0400] CPS: set your custom attr at the level where it won't get overwritten
[2014-05-13 16:41:11 -0400] runfromnowhere: Which I can do
[2014-05-13 16:41:16 -0400] runfromnowhere: But it's ceph's cookbook that's doing it :P
[2014-05-13 16:41:38 -0400] runfromnowhere: I'm trying to figure out which is wrong so I know who to submit the fix to
[2014-05-13 16:41:43 -0400] CPS: at least you know who to blame :V
[2014-05-13 16:41:56 -0400] runfromnowhere: LOL not sure which, because that attribute precedence doesn't include node-level attributes
[2014-05-13 16:42:00 -0400] runfromnowhere: But chef-server will store them :P
[2014-05-13 16:42:22 -0400] runfromnowhere: Also there's mixed behavior from chef-server
[2014-05-13 16:42:31 -0400] runfromnowhere: So something seems off
[2014-05-13 16:42:40 -0400] CPS: very possible
[2014-05-13 16:43:42 -0400] geggam: the more i use chef the less i use attributes and the more i use databags
[2014-05-13 16:44:09 -0400] runfromnowhere: The attributes I'm looking for are properly stored on and retrieved from the server....but chef-client explicitly clears any node.override attributes AFTER chef-server happily passes my saved attributes down to it.  If I pull a new node object from the server during my recipe with a search(), that object has the attribute I'm looking for on it.  But the existing "self" node object chef-client maintains has it removed at runtime.
[2014-05-13 16:44:29 -0400] CPS: geggam: do like me and use attributes to get to your data bags :D
[2014-05-13 16:45:03 -0400] CPS: that's really strange runfromnowhere
[2014-05-13 16:45:48 -0400] geggam: lol CPS
[2014-05-13 16:45:58 -0400] geggam: i try to simplify everything
[2014-05-13 16:46:42 -0400] eliklein: is ranjib dey on here by chance?
[2014-05-13 16:47:47 -0400] runfromnowhere: CPS: It was until I looked at the source for chef-client :P.  The answer might be "You shouldn't be storing node.override attributes on the server but the server is just too nice and stores them anyway"...but I'd like an official word if possible
[2014-05-13 16:50:26 -0400] caddyman67: Does anyone know why chef will start a service with no problem if I do sudo chef-client on the node, but if I bootstrap the node with the same cookbooks, it doesn't start the service
[2014-05-13 16:50:51 -0400] phil_s_stein: Why would knife bootstrap be ignoring my --server-url argument? The client I'm installing chef on is trying to contact http://localhost/client.
[2014-05-13 16:51:31 -0400] caddyman67: in the cookbook, I have service "nuxeo" do supports :status => true action :start end
[2014-05-13 16:51:42 -0400] caddyman67: works if I run chef-client locally, not via bootstrap
[2014-05-13 16:52:55 -0400] CPS: runfromnowhere: that's interesting documentation. I use override attributes, but they're inside roles and are applied every time, so no issue
[2014-05-13 16:53:02 -0400] CPS: maybe just change how it's being set?
[2014-05-13 16:54:20 -0400] josephholsten: isn't there an ohai plugin for collecting installed packages?
[2014-05-13 16:56:30 -0400] runfromnowhere: CPS: Yeah - override attributes in genereal should be fine, and on roles they're fine too, it's just override attributes set to a node.  I can change it but that means changing ceph's cookbooks...this isn't any kind of Huge Problem or anything, just want to get some guidance so I apply my efforts in the right direction :)
[2014-05-13 16:57:18 -0400] josephholsten: ah https://github.com/demonccc/chef-repo/tree/master/plugins/ohai/linux
[2014-05-13 16:58:16 -0400] newbie259: anyone here use chef metal?
[2014-05-13 16:58:26 -0400] newbie259: I have some basic questions
[2014-05-13 16:58:37 -0400] josephholsten: newbie259: only for inspiration
[2014-05-13 16:59:03 -0400] newbie259: I dont know what that means
[2014-05-13 16:59:04 -0400] josephholsten: newbie259: don't ask to ask, just ask ;-)
[2014-05-13 16:59:11 -0400] newbie259: oh gotcha
[2014-05-13 16:59:12 -0400] egn: hi, I'm getting this error on "chef-server-ctl reconfigure" on a clean Ubuntu 12.04 64bit install using Chef Server 11.0.12-1 https://gist.github.com/eriknomitch/d5ea41719be4c82b8fa5
[2014-05-13 17:00:53 -0400] newbie259: Im trying to use a chef metal recipe to build several machines that depend on each other. I was looking through the code to see if I could find all of the options of the Machine resource but couldnt find it. I can see in the examples that you can use tag but I would really like to be able to override not attributes. is there a way to do that?
[2014-05-13 17:01:22 -0400] jkeiser: What does "override not attributes" mean?
[2014-05-13 17:01:30 -0400] newbie259: whoops
[2014-05-13 17:01:34 -0400] newbie259: node attributes
[2014-05-13 17:04:15 -0400] jkeiser: newbie259: use attribute name, value
[2014-05-13 17:05:44 -0400] newbie259: awesome. how did you find this?
[2014-05-13 17:06:52 -0400] jkeiser: newbie259: if it's an attribute deep in, do attribute ['a', 'b', 'c'], 'value' to just modify that one attribute
[2014-05-13 17:06:57 -0400] jkeiser: newbie259: I wrote it :)
[2014-05-13 17:07:13 -0400] jkeiser: docs are being worked on and will be all ready for the 1.0 release
[2014-05-13 17:08:37 -0400] newbie259: oh awesome. I have the right man on here then
[2014-05-13 17:11:54 -0400] txfalcon: hello I am new to irc and apologize in advance for breaking the rules of an irc channel
[2014-05-13 17:14:17 -0400] txfalcon: i am in the process of installing a freeipa server.  I am trying to write the code that will answer the questions when executing the command "ipa-server-install".  In bash this can be done easily with a expect file.  I need to know how to do it in ruby.
[2014-05-13 17:16:32 -0400] troyready: txfalcon, I recommend the greenletters gem for that
[2014-05-13 17:17:15 -0400] txfalcon: thank you will take a look
[2014-05-13 17:34:04 -0400] mmzyk: One more reminder: RC for open source chef server 11.1.0 is out. Try it out if you want and if you find any issues, let me know. http://www.getchef.com/blog/2014/05/09/release-candidate-for-open-source-chef-server-11-1-0/
[2014-05-13 17:37:32 -0400] dgarstang: Is this ssl verify stuff on the client always required now? Do I actually have to put the crt of the chef server in the trusted certs directory on the client?
[2014-05-13 17:46:15 -0400] stormerider: i believe it defaults to required but you can always override it.
[2014-05-13 17:49:09 -0400] dgarstang: stormerider: Seems like I can't. I dunno.
[2014-05-13 17:50:57 -0400] dgarstang: Can't find any docs on subject, so I really don't know.
[2014-05-13 17:51:06 -0400] caddyman67: I already asked , but I'll ask again in case someone else is looking... anyone know why a service won't start (using service command or bash script command) from management host
[2014-05-13 17:51:23 -0400] caddyman67: if the cookbooks are run locally from the node, it works (bash and service)
[2014-05-13 17:54:03 -0400] mmzyk: dgarstand http://docs.opscode.com/server_security.html
[2014-05-13 17:54:10 -0400] mmzyk: You probably want the ssl_verify_mode option.
[2014-05-13 17:54:34 -0400] mmzyk: And Im not actually sure why those client settings are hidden on a server page.
[2014-05-13 17:54:54 -0400] mmzyk: Scroll to the bottom of the page, fyi.
[2014-05-13 17:55:41 -0400] wmz: hi, is there anyway to run something like content json.pretty_generate(node[cookbook][attributes]?
[2014-05-13 17:58:24 -0400] dgarstang: I am confused. chef-solo with packer...
[2014-05-13 18:00:41 -0400] mmzyk: dgarstang Im not following your confusion and am equally confused, b/c I have no idea where chef-solo and packer come in.
[2014-05-13 18:01:37 -0400] dgarstang: mmzyk: right here http://www.packer.io/docs/provisioners/chef-solo.html
[2014-05-13 18:01:38 -0400] mmzyk: Also, I left you a message above, but apparently misspelled your name, dgarstang
[2014-05-13 18:02:02 -0400] dgarstang: mmzyk: kk, multiple issues going on here.
[2014-05-13 18:03:08 -0400] dgarstang: basically, I want chef-solo to run when packer is doing a build (but not start the chef service) but also configure chef to run as a service so that when an instacne is created, it willstart chef. I had this running several weeks back but can't seem to reproduce it.
[2014-05-13 18:03:16 -0400] stormerider: what's a good knife search query to find nodes with an empty run_list?
[2014-05-13 18:06:29 -0400] dgarstang: I would think having chef-solo run at build time, and then having it configure chef to run as a service (on next boot - but not now) would be a pretty standard thing to do
[2014-05-13 18:09:15 -0400] sauraus: Anyone know when the node['jenkins']['executor']['private_key'] is set on a run of the Jenkins cookbook? I have a situation which is puzzling to say the least, the attribute file makes it nil but when I run jenkins::'war' the node already contains a key value at the very begining which is inexplicable. :(
[2014-05-13 18:11:07 -0400] dgarstang: very strange. the chef cookbook when using the service recipies seems to always start the service now. I don't get it.
[2014-05-13 18:13:15 -0400] jperry: anyone reason why the user chef resource doesn't create the home directory for you in centos 5.10?
[2014-05-13 18:13:44 -0400] jperry: always run into cookbook bugs where it complains the home directory doesn't exist
[2014-05-13 18:14:10 -0400] troyready: dgarstang, is that surprising? https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/upstart_service.rb#L34
[2014-05-13 18:14:43 -0400] troyready: or https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/init_service.rb#L34 , etc
[2014-05-13 18:15:10 -0400] dgarstang: troyready: it is surprising. configuring chef to run as an upstart service doesn't necessarily mean you want to start it right now.
[2014-05-13 18:15:48 -0400] dgarstang: troyready: That's like packages insisting on running the service as soon as they are installed, but before you have a chance to drop in a config file, and as a result, a broken half confifgured service gets started
[2014-05-13 18:17:34 -0400] troyready: It's a sane default for most people -- unlike system packages, with the chef-client cookbook it's expected that it's finished configuring the chef-client service by the time it gets to that setp
[2014-05-13 18:17:36 -0400] troyready: *step
[2014-05-13 18:18:12 -0400] troyready: Fine that your use case is different, but I think it's safe to say that it's the most logical default
[2014-05-13 18:18:35 -0400] dgarstang: troyready: so, this also means to build AMI's with packer, your chef server has to be up and reachable.
[2014-05-13 18:19:31 -0400] dgarstang: it also means I don't know how to run chef solo on the machine. I'm not sure what recipe to use from the client.
[2014-05-13 18:19:48 -0400] troyready: Sure. And easy to change the recipe for your corner-case scenario
[2014-05-13 18:21:18 -0400] dgarstang: dunno now. confused.
[2014-05-13 18:22:28 -0400] dgarstang: if I just use the chef-solo provisioner, chef is installed (but I can't get it to install any cookbooks because then it will run the client), and when the instance comes up it doesn't start chef.
[2014-05-13 18:35:32 -0400] heavystorm: If I have a machine thats part of role:X, and role:X contains recipe:ABC, can I use knife node run_list remove to remove just one recipe (lets say B) from that one machine but have it still part of role:X ?
[2014-05-13 18:36:00 -0400] CPS: don't think so
[2014-05-13 19:28:06 -0400] phil_s_stein: Is there a way to install a downloaded cookbook without access to opscode.com?
[2014-05-13 19:29:27 -0400] phil_s_stein: i.e. can I just do my own git commands and untar the cookbook in place?
[2014-05-13 19:29:47 -0400] CPS: if you have it downloaded just add it to your own repo
[2014-05-13 19:30:30 -0400] newbie259: jkeiser: I have another chef-metal question for you
[2014-05-13 19:31:15 -0400] c_t: hrm
[2014-05-13 19:31:30 -0400] c_t: ohai 7 doesn't seem to report the distro codename anymoe?
[2014-05-13 19:32:13 -0400] newbie259: where do i see the list of all the resource attributes for the machine resource?
[2014-05-13 19:34:35 -0400] phil_s_stein: When I untar in ./cookbooks 'knife cookbook list' doesn't show the untarred cookbook. Any idea why?
[2014-05-13 19:34:47 -0400] dgarstang: How do I get rid of these annoying "SSL validation of HTTPS requests is disabled." messages with chef-solo and vagrant?
[2014-05-13 19:34:48 -0400] newbie259: also how would i store a node attribute from one machine and use it in another?
[2014-05-13 19:46:04 -0400] tempname: I am having an issue provisioning new nodes. This is extremely recent, just came up with in the last 2 hours. I was able to provision 10+ nodes this morning with out issue, but now I am seeing this erorr
[2014-05-13 19:46:05 -0400] tempname: For example, libxml2-2.9.0 and higher are currently known to be broken and thus unsupported by nokogiri, due to compatibility problems and XPath optimization bugs. ************************************************************************ ERROR:  Error installing fog:   ERROR: Failed to build gem native extension.         /opt/chef/embedded/bin/ruby extconf.rb Building nokogiri using packaged libraries. checking for iconv.h... yes chec
[2014-05-13 19:46:57 -0400] tempname: I am using chef 11.12.4-1. This error shows up during bundle install right after installing chef
[2014-05-13 19:52:13 -0400] gyoza: i had to fix cake today
[2014-05-13 19:52:22 -0400] gyoza: what is with 4 letter c words and difficulty level
[2014-05-13 20:00:41 -0400] dgarstang: How do I get rid of these annoying "SSL validation of HTTPS requests is disabled." messages with chef-solo and vagrant?
[2014-05-13 20:10:08 -0400] workmad3: dgarstang: add 'ssl_verify_mode :verify_peer' to your solo.rb file, I'd guess
[2014-05-13 20:12:13 -0400] coderanger: read: do exactly what it says
[2014-05-13 20:16:05 -0400] jeffcara: Has anybody had an issue with Chefspec being able to read recipes? I have been following the Readme to a t, but it isn't even recognizing that I have written tests
[2014-05-13 20:19:58 -0400] sauraus: sethvargo you around? I've got a weird Jenkins cookbook error where if I create a user this will auto trigger the creation of the jenkins-key file
[2014-05-13 20:24:15 -0400] dgarstang: *sigh* How do I create an initial berkshelf config file? "berks configure' gets me 'Could not find command "configure".'
[2014-05-13 20:24:43 -0400] jmreicha_: coderanger:  Did you give a talk at monitorama?
[2014-05-13 20:24:49 -0400] coderanger: I did
[2014-05-13 20:25:16 -0400] jmreicha_: Very nice.  Do you happen to know if they will be posted to YouTube?
[2014-05-13 20:25:29 -0400] jmreicha_: they -> all the talks
[2014-05-13 20:26:52 -0400] coderanger: jmreicha_: No, they are going up on Vimeo
[2014-05-13 20:26:57 -0400] coderanger: First day is uploaded already
[2014-05-13 20:27:04 -0400] coderanger: jmreicha: http://vimeo.com/channels/740885
[2014-05-13 20:27:36 -0400] coderanger: Mine should be up shortly
[2014-05-13 20:28:26 -0400] zanshin: I'm revisiting a node that's been running for a while. It had nginx 1.7.0 on it and the current version of that cookbook is now 2.6.2. The node no longer converges and it appears to me that since nginx was previous setup on the node, the new cookbook isn't completing and therefore there are directories the default recipe expects missing. How do I force the nginx cookbook to run even if it thinks `package[nginx] action install (up to date)`?
[2014-05-13 20:28:57 -0400] sauraus: dgarstang RTFM www.berkshelf.com ;)
[2014-05-13 20:29:17 -0400] jmreicha_: coderanger:  Oh cool, I am looking forward to watching :)
[2014-05-13 20:29:39 -0400] coderanger: jmreicha: https://speakerdeck.com/coderanger/is-there-an-echo-in-here-signal-analysis-for-ops-with-notes is the deck w/ notes
[2014-05-13 20:29:49 -0400] jmreicha_: ty
[2014-05-13 20:33:17 -0400] a13x212: anyone using the route53 cookbook?
[2014-05-13 20:33:26 -0400] coderanger: jmreicha: http://www.lowlevelmanager.com/2014/05/monitorama-slides-2014.html might be of interest to you as well
[2014-05-13 20:33:48 -0400] dgarstang: sauraus: installed the gem, and there's no configure option in my help output
[2014-05-13 20:34:22 -0400] coderanger: dgarstang: Not sure why you would think there would be
[2014-05-13 20:34:39 -0400] coderanger: No such command exists in the documentation either
[2014-05-13 20:34:45 -0400] dgarstang: coderanger: because... that's what berkshelf.com says. i await my snarky reply.
[2014-05-13 20:35:03 -0400] sauraus: dgarstang: read the fine documention on www.berkshelf.com
[2014-05-13 20:35:08 -0400] dgarstang: 'berks configure             # Create a new Berkshelf configuration file'
[2014-05-13 20:35:42 -0400] sauraus: dgarstang try the #berkshelf channel :)
[2014-05-13 20:35:53 -0400] dgarstang: seems thats old docs...
[2014-05-13 20:36:05 -0400] coderanger: dgarstang: Can you be more specific where you see that? Ctrl-F doesn't find that anywhere on berkshelf.com
[2014-05-13 20:36:33 -0400] dgarstang: coderanger: http://berkshelf.com/v2.0/ ... that's where google took me first
[2014-05-13 20:36:46 -0400] coderanger: dgarstang: If you run berks --version, you will notice you aren't running 2.0 ...
[2014-05-13 20:36:57 -0400] coderanger: Is that an acceptably snarky response?
[2014-05-13 20:37:02 -0400] dgarstang: in any case, with (whatever newer version i have) how do I generate a basic config.json file?
[2014-05-13 20:37:12 -0400] dgarstang: coderanger: a little.
[2014-05-13 20:37:24 -0400] coderanger: You don't, you rarely need to directly configure berkshelf
[2014-05-13 20:37:59 -0400] dgarstang: coderanger: Well, I'd like to get the config file so I can modify it
[2014-05-13 20:38:19 -0400] coderanger: dgarstang: What are you trying to modify?
[2014-05-13 20:38:48 -0400] dgarstang: coderanger: we have multiple chef servers. I need to put each chef server into a different config file and alias it. With v2 I could do that
[2014-05-13 20:39:01 -0400] coderanger: berks gets most of its config data via knife.rb
[2014-05-13 20:39:38 -0400] coderanger: Having two chef servers is not a workflow the berks supports super well, just go dig in to the code
[2014-05-13 20:40:03 -0400] dgarstang: ah ruby
[2014-05-13 20:40:41 -0400] coderanger: Actually the config options are all documented
[2014-05-13 20:40:49 -0400] coderanger: so you don't even need to do that, just as stated before, RTFM
[2014-05-13 20:41:12 -0400] coderanger: Funny how well that works
[2014-05-13 20:41:17 -0400] coderanger: Almost like you should do that first
[2014-05-13 20:41:34 -0400] coderanger: a13x212: A little, though with heavy modification
[2014-05-13 20:41:55 -0400] tempname: boooo Unable to connect to apt.opscode.com
[2014-05-13 20:42:20 -0400] dgarstang: coderanger: the format of the json file is not documented.
[2014-05-13 20:42:22 -0400] coderanger: tempname: Should still be running, but you shouldn't be using it
[2014-05-13 20:42:31 -0400] coderanger: dgarstang: Configuring Berkshelf, seriously, go read it
[2014-05-13 20:42:42 -0400] tempname: what do you mean?
[2014-05-13 20:42:49 -0400] coderanger: tempname: I don't think thats been updated since Chef ~0.9
[2014-05-13 20:42:57 -0400] dgarstang: coderanger: the doc does not say which options go at the root level, and in lower levels and so on.
[2014-05-13 20:43:18 -0400] tempname: I am using chef 10.30.4
[2014-05-13 20:43:41 -0400] coderanger: dgarstang: Consider yourself muted until you read every word of that page :-)
[2014-05-13 20:43:50 -0400] coderanger: dgarstang: You're a smart lad, I'm sure you can figure it out
[2014-05-13 20:44:09 -0400] coderanger: tempname: Okay, you still can't use that repo
[2014-05-13 20:44:19 -0400] tempname: Is there a replacement for it
[2014-05-13 20:44:58 -0400] dgarstang: coderanger: Your typical contempt for me would seem to indicate the contrary.
[2014-05-13 20:45:17 -0400] coderanger: tempname: Opscode does not maintain an apt repository, you can either use the omnitruck installer bash script or download/install the debs yourself
[2014-05-13 20:45:34 -0400] daos: i'm running hosted chef and while running `chef-client` from the command line always works, then the chef-client service runs (on the 30 minute interval) it always fails w/ 403 Forbidden (no more specific errors are given)
[2014-05-13 20:45:39 -0400] daos: anyone run into this?
[2014-05-13 20:46:15 -0400] daos: (it's failing on a separate node)
[2014-05-13 20:48:00 -0400] dgarstang: Not sure how I am going to reverse engineer the config.json format. Darn it.
[2014-05-13 20:48:47 -0400] tempname: coderanger thanks that was very help!
[2014-05-13 20:48:50 -0400] tempname: ful
[2014-05-13 20:49:04 -0400] doomviking: omnibitchincamaro
[2014-05-13 20:51:26 -0400] coderanger: tempname: If you want to make your own apt repo, you can do that too, I built a handy tool to do it :)
[2014-05-13 20:51:38 -0400] coderanger: tempname: If Opscode doesn't offer an apt repo Very Soon I'll probably just do
[2014-05-13 20:51:45 -0400] coderanger: maybe I'll go do that today in fact
[2014-05-13 20:51:51 -0400] tempname: omnitruck seems to kind of do what I want.
[2014-05-13 20:53:49 -0400] daos: anyone see inexplicable 403 Forbidden errors in /var/log/chef/client.log but running `chef-client` by hand works w/o complaint?
[2014-05-13 20:55:21 -0400] coderanger: daos: What URL do they correspond to?
[2014-05-13 20:56:31 -0400] daos: the error is frustratingly unspecific
[2014-05-13 20:56:40 -0400] daos: i'll paste
[2014-05-13 20:56:42 -0400] coderanger: daos: :-(
[2014-05-13 20:57:04 -0400] daos: https://gist.github.com/malbin/6b5b033e96a0cfb5ae1d
[2014-05-13 20:57:42 -0400] coderanger: daos: Can you pastebin the stack trace too?
[2014-05-13 20:58:32 -0400] daos: updated: https://gist.github.com/malbin/6b5b033e96a0cfb5ae1d
[2014-05-13 20:59:30 -0400] coderanger: Okay, but it does work by hand, hmmm
[2014-05-13 21:00:40 -0400] daos: haha yep! running `chef-client` works without issue
[2014-05-13 21:01:25 -0400] coderanger: daos: Might want to throw log_level :debug in your client.rb
[2014-05-13 21:01:33 -0400] daos: ok will do
[2014-05-13 21:01:53 -0400] daos: done
[2014-05-13 21:02:37 -0400] coderanger: Any slightly more useful logging?
[2014-05-13 21:02:50 -0400] daos: i wish
[2014-05-13 21:02:53 -0400] daos: i'll come back with debug logs
[2014-05-13 21:03:00 -0400] daos: thanks coderanger
[2014-05-13 21:03:25 -0400] coderanger: Cheers, /me wanders off to find lunch
[2014-05-13 21:19:35 -0400] dgarstang: maybe I should quit my day job. with knife spork... "ERROR: TypeError: no implicit conversion of nil into String"
[2014-05-13 21:34:06 -0400] dgarstang: I'm playing around with knife spork here and it automatically freezes uploaded cookbooks. Can I stop that?
[2014-05-13 21:37:33 -0400] coderanger: No
[2014-05-13 21:38:35 -0400] tempname: coderanger have you ever run into this issue with nokigiri?
[2014-05-13 21:38:36 -0400] tempname: https://gist.github.com/rottmanj/2a45bfc01ea81c189368
[2014-05-13 21:38:42 -0400] sauraus: sethvargo you around?
[2014-05-13 21:39:12 -0400] dgarstang: coderanger: what if it's a dev/test chef server?
[2014-05-13 21:39:34 -0400] dgarstang: coderanger: or rather, how do you update a cookbook that's been frozen?
[2014-05-13 21:39:51 -0400] redondos: with --force?
[2014-05-13 21:40:25 -0400] dgarstang: redondos: actually I'm using knife-spork, or trying to...
[2014-05-13 21:40:55 -0400] dgarstang: I guess I'm rather confused on the freezing stuff.
[2014-05-13 21:41:06 -0400] redondos: option :freeze, :long => '--freeze', :description => 'Freeze this version of the cookbook so that it cannot be overwritten', :boolean => true
[2014-05-13 21:41:11 -0400] coderanger: dgarstang: knife-spork, like berkshelf, comes with a pretty specific workflow
[2014-05-13 21:41:17 -0400] redondos: you can set that to false if you don't want to freeze it
[2014-05-13 21:41:33 -0400] coderanger: dgarstang: You should be testing locally with test-kitchen and chefspec, not on a server
[2014-05-13 21:41:44 -0400] coderanger: redondos: I don't think thats actually used anymore
[2014-05-13 21:41:58 -0400] coderanger: redondos: If it is, its deep in other code
[2014-05-13 21:42:07 -0400] devjj: Anyone available to provide some assistance with the Java cookbook? I'm getting what appears to have been a fixed issue: https://tickets.opscode.com/browse/COOK-2996?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2014-05-13 21:42:09 -0400] dgarstang: coderanger: even if that's true, you upload it to the test server, and later you need to update it, what do you do? delete it and start again?
[2014-05-13 21:42:13 -0400] redondos: it's in HEAD, but I understand it's not supposed to be used.
[2014-05-13 21:42:24 -0400] coderanger: dgarstang: No, you make a new release with a new version number
[2014-05-13 21:42:30 -0400] coderanger: dgarstang: Just like any other piece of software
[2014-05-13 21:42:55 -0400] dgarstang: coderanger: your assuming everyone that uses chef is a software engineer by training, and they are not.
[2014-05-13 21:43:07 -0400] coderanger: Yes, by definition you are now
[2014-05-13 21:43:13 -0400] coderanger: Possibly one with much to learn, but you are :)
[2014-05-13 21:43:25 -0400] redondos: hehe. whatever they call themselves, they have to be methodical about systems configuration now
[2014-05-13 21:43:30 -0400] sauraus: dgarstang versioning changes has nothing to do with being a software engineer ;)
[2014-05-13 21:43:38 -0400] dgarstang: coderanger: ok, so a major bump gets over the freeze. i suspected that but it's not documented anywhere
[2014-05-13 21:43:49 -0400] coderanger: I mean you don't have to be, chef offers low-level unopinionated tools
[2014-05-13 21:43:51 -0400] dgarstang: saurus: what's it to do with then?
[2014-05-13 21:44:07 -0400] coderanger: berkshelf and spork are just _very_ opinionated
[2014-05-13 21:44:10 -0400] sauraus: dgarstang 'knife cookbook delete YOURCOOKBOOKNAMEHERE; berks upload' done :)
[2014-05-13 21:44:17 -0400] redondos: `knife spork check' will give you an idea of what's going on with your versions, dgarstang
[2014-05-13 21:44:37 -0400] dgarstang: ok maybe spork ain't the right tool then. maybe vi and edit damn metadata.rb is
[2014-05-13 21:44:47 -0400] devjj: Anyone? I've verified that the tarball is downloaded correctly, and it extracts fine if I sign into the box and do it manually. I'm at a loss.
[2014-05-13 21:44:52 -0400] coderanger: dgarstang: I'll let you go look up cookbook freezes and find it is quite documented
[2014-05-13 21:45:03 -0400] dgarstang: coderanger: already looked.
[2014-05-13 21:45:19 -0400] sauraus: dgarstang versioning of changes is a common practice across the board on IT systems, whether you are a sys admin/software engineer or a script kiddie, not versioning changes will bite you
[2014-05-13 21:45:51 -0400] coderanger: dgarstang: Here is what I'm going to do, I'm going to quote you the relevant docs and then silence you until tomorrow so you have some time to read the docs
[2014-05-13 21:45:52 -0400] dgarstang: sauraus: duh.
[2014-05-13 21:46:00 -0400] coderanger: "A cookbook version can be frozen, which will prevent updates from being made to that version of a cookbook. (A user can always upload a new version of a cookbook.)"
[2014-05-13 21:46:02 -0400] doomviking: haha
[2014-05-13 21:47:23 -0400] doug1: lalala
[2014-05-13 21:47:28 -0400] coderanger: Listening is an under-appreciated art
[2014-05-13 21:47:49 -0400] sauraus: coderanger: I believe you meant to say 'reading' :D
[2014-05-13 21:48:08 -0400] coderanger: sauraus: one is a subset of the other
[2014-05-13 21:48:22 -0400] sauraus: LOL
[2014-05-13 21:51:49 -0400] devjj: Anyone with experience with the Java cookbook available for some support?
[2014-05-13 21:52:02 -0400] sauraus: devjj what's up
[2014-05-13 21:52:13 -0400] sauraus: I have 8 minutes till my next meeting
[2014-05-13 21:52:19 -0400] devjj: sauraus: I'm running into what appears to be a known+fixed issue. https://tickets.opscode.com/browse/COOK-2996?page=com.atlassian.jira.plugin.system.issuetabpanels:all-tabpanel
[2014-05-13 21:52:35 -0400] devjj: The tarball downloads, but tar exits with a status code of "1", which causes the run to fail.
[2014-05-13 21:53:57 -0400] sauraus: Sorry not familiar with that problem, did you give this java cookbook a try: https://github.com/socrata-cookbooks/java
[2014-05-13 21:54:02 -0400] devjj: sauraus: Here's the output I'm seeing: http://pastebin.com/AcQzzfz1
[2014-05-13 21:54:11 -0400] devjj: hmm, no I'm running the official one. I'll take a look.
[2014-05-13 21:55:44 -0400] devjj: Actually, they look the same.
[2014-05-13 21:56:42 -0400] devjj: sauraus: Yeah, I take it back. It's the same as what's referenced on the community site, so yes, that's what I'm using.
[2014-05-13 21:57:25 -0400] sauraus: devjj sorry can't help you on that issue, I've never run into problems as I've always needed JAVA 7 on all my systems
[2014-05-13 21:57:43 -0400] devjj: sauraus: That's what I'm trying to install. This worked yesterday.
[2014-05-13 21:59:04 -0400] sauraus: devjj I will be back in 30-60 minutes sorry meeting, I can only say I am installing JAVA 7 oracle on CentOS 6.5 right now just fine using that cookbook
[2014-05-13 21:59:36 -0400] devjj: This is on 12.04, but thanks. I'll see if you're around in an hour. This is driving me nuts.
[2014-05-13 22:00:48 -0400] devjj: Anyone else available to help? I'm running into issues w/ the java cookbook on Ubuntu 12.04.
[2014-05-13 22:00:53 -0400] MikeTLive: question about community and wrapper cookbooks
[2014-05-13 22:01:02 -0400] coderanger: MikeTLive: Go for it
[2014-05-13 22:01:02 -0400] MikeTLive: i grab the community java cookbook.
[2014-05-13 22:01:11 -0400] MikeTLive: i create a wrapper cookbook
[2014-05-13 22:01:18 -0400] coderanger: devjj: Sorry, haven
[2014-05-13 22:01:20 -0400] MikeTLive: which one would you call "java"
[2014-05-13 22:01:23 -0400] coderanger: devjj: Haven't seen that issues
[2014-05-13 22:01:34 -0400] coderanger: MikeTLive: No, the wrapper would be companyname-java
[2014-05-13 22:01:36 -0400] coderanger: (usually)
[2014-05-13 22:01:43 -0400] devjj: coderanger: Could you help me debug it?
[2014-05-13 22:01:56 -0400] coderanger: devjj: Trying to get some work done right now, perhaps in a bit
[2014-05-13 22:03:09 -0400] MikeTLive: but the community cookbook, you would call simply "java"
[2014-05-13 22:03:36 -0400] coderanger: MikeTLive: Yes
[2014-05-13 22:03:49 -0400] coderanger: I mean it is called java, you don't get to pick what to call it
[2014-05-13 22:04:32 -0400] MikeTLive: why would the community cookbook be automatically elevated to one true cookbook status for a given object
[2014-05-13 22:04:50 -0400] MikeTLive: say i have freds-book and johns-book and i need to do my wrapper-book
[2014-05-13 22:05:51 -0400] MikeTLive: it seems like the highest elevation of a cookbook is for it to become a community book that is shared and thus removes its prefix
[2014-05-13 22:06:01 -0400] coderanger: MikeTLive: Because the opscode community site is a single flat namespace
[2014-05-13 22:06:06 -0400] coderanger: MikeTLive: Its a Problem
[2014-05-13 22:06:15 -0400] coderanger: but not one being worked on right now, despite my efforts
[2014-05-13 22:06:16 -0400] coderanger: :-(
[2014-05-13 22:06:16 -0400] MikeTLive: i'm not so sure that it is a problem.
[2014-05-13 22:06:40 -0400] coderanger: MikeTLive: The definition of "community cookbook" is just anything uploaded to the community site
[2014-05-13 22:06:41 -0400] MikeTLive: i beliee the problem is that the other books are not adequately versioned or having their pedigree called out.
[2014-05-13 22:06:47 -0400] coderanger: there is no special status beyond that
[2014-05-13 22:07:04 -0400] coderanger: And due to the namespace issues, not all shared cookbooks are uploaded to the community site
[2014-05-13 22:07:13 -0400] coderanger: For example, almost none of mine are because the names are already taken
[2014-05-13 22:07:20 -0400] MikeTLive: exactly the problem.
[2014-05-13 22:07:34 -0400] MikeTLive: the lack of the pedigree portion of the naming creates an inevitable collision.
[2014-05-13 22:08:12 -0400] coderanger: Quality is an obligate intangible, you can't try to judge cookbooks on abstract quality and keep your sanity
[2014-05-13 22:08:35 -0400] coderanger: The fix is likely to be removing the flat namespace of the community site
[2014-05-13 22:08:42 -0400] MikeTLive: it seems like berkshelf is a way to do an end-run around fixing the books and using a checksum of the contents as part of the name instead of enforcing a naming..
[2014-05-13 22:08:45 -0400] coderanger: so that many cookbooks of the same name can coexist
[2014-05-13 22:08:56 -0400] coderanger: MikeTLive: No, berks does not fix this
[2014-05-13 22:09:00 -0400] someara: then adding support to chef, librarian, berkshelf, knife, and chef-server all at the same time
[2014-05-13 22:09:10 -0400] coderanger: It just lets you ignore it is you squint really hard
[2014-05-13 22:09:15 -0400] coderanger: someara: yep!
[2014-05-13 22:09:28 -0400] MikeTLive: i dont want to fork books, i want to wrap them.
[2014-05-13 22:09:31 -0400] geggam: if you want it done right ... do it yourself... if you want to cut corners and just get it done.. dont look under the covers
[2014-05-13 22:09:32 -0400] coderanger: someara: The storm is coming, y'all can't put it off forever ;-)
[2014-05-13 22:09:38 -0400] MikeTLive: i need to maintain theour pedigree to do this..
[2014-05-13 22:09:49 -0400] someara: lets get supermarket deployed first
[2014-05-13 22:09:52 -0400] coderanger: MikeTLive: I've lost you, sorry
[2014-05-13 22:09:53 -0400] MikeTLive: source-book would do this
[2014-05-13 22:09:54 -0400] someara: then we can go hackering
[2014-05-13 22:10:06 -0400] MikeTLive: community-java
[2014-05-13 22:10:29 -0400] MikeTLive: mycorp-java (wrapper around whchever we like at my company)
[2014-05-13 22:10:32 -0400] coderanger: MikeTLive: Yes, that would be the same as the proposed fix for the community site
[2014-05-13 22:10:48 -0400] coderanger: MikeTLive: including the username of the creator in the unique ID
[2014-05-13 22:10:56 -0400] MikeTLive: they can all coexist in the flat space.
[2014-05-13 22:11:01 -0400] coderanger: MikeTLive: But its a big change to everything that does dependency solution
[2014-05-13 22:11:10 -0400] coderanger: MikeTLive: I mean that isn't flat anymore, but sure
[2014-05-13 22:11:24 -0400] MikeTLive: like apache-httpd  apache-tomcat spring-tomcat
[2014-05-13 22:11:29 -0400] MikeTLive: mycompany-tomcat
[2014-05-13 22:11:58 -0400] coderanger: Indeed, as I said, that is my recommendation to the fullstack team, but there are other things that have to get done first
[2014-05-13 22:12:00 -0400] MikeTLive: set up the dependency in the correct order, like you would withthe unix path, and i can still use the common "tomcat" recipe name that is inside
[2014-05-13 22:12:02 -0400] coderanger: so for now it kind of sucks
[2014-05-13 22:12:20 -0400] MikeTLive: i am building out a flat space and avoiding berks.
[2014-05-13 22:12:32 -0400] coderanger: We all just try to ignore it as best we can
[2014-05-13 22:13:03 -0400] MikeTLive: the idea of pulling anything from anywhere doesnt mix well and feels like as awesome a piece of software that it is, this part - the multi-versions part - is a bug it should not be solving.
[2014-05-13 22:13:14 -0400] MikeTLive: instead quality of the recipes and a standardization of that naming
[2014-05-13 22:13:28 -0400] coderanger: MikeTLive: Again, yes, this is (vaguely) planned
[2014-05-13 22:13:39 -0400] coderanger: well, minus the quality mining
[2014-05-13 22:13:43 -0400] MikeTLive: heh
[2014-05-13 22:13:50 -0400] coderanger: But it isn't possible right now
[2014-05-13 22:13:56 -0400] MikeTLive: quality comes from a culture that demands it
[2014-05-13 22:14:04 -0400] coderanger: MikeTLive: No, thats not the point
[2014-05-13 22:14:08 -0400] MikeTLive: and enough use and dependence on the thing too :)
[2014-05-13 22:14:12 -0400] coderanger: measuring code quality is folly
[2014-05-13 22:14:19 -0400] coderanger: You can't put a number on it
[2014-05-13 22:14:24 -0400] MikeTLive: yes. i agree.
[2014-05-13 22:14:31 -0400] coderanger: So don't try, just report a few concrete metrics like test status
[2014-05-13 22:14:33 -0400] coderanger: and move on
[2014-05-13 22:15:54 -0400] MikeTLive: i would like to use the communitu cookbooks, as is  - no forking - but that means that they become the default name. "java" means community/java
[2014-05-13 22:16:05 -0400] coderanger: MikeTLive: Well it would become opscode/java
[2014-05-13 22:16:06 -0400] MikeTLive: in my fantasy land it would be community-java
[2014-05-13 22:16:20 -0400] coderanger: since "community" isn't a thing
[2014-05-13 22:16:36 -0400] MikeTLive: but opscode isnt a thing anymore either, so it would be chef-java
[2014-05-13 22:16:54 -0400] coderanger: I refuse to use that name on the basis that its uselessly unclear
[2014-05-13 22:17:09 -0400] coderanger: :-)
[2014-05-13 22:18:20 -0400] MikeTLive: to manage collisions internally, we are enforcing naming conventions for teams - we have dozens of small ops teams each with dozens of projects.
[2014-05-13 22:18:52 -0400] coderanger: Yep, thats why the chef community has settled on some standards at least
[2014-05-13 22:18:57 -0400] MikeTLive: we have them use a prefix of "project" (their project team name). for the things that collide when rolled up into the single workspace
[2014-05-13 22:19:00 -0400] coderanger: but the community site predates all that
[2014-05-13 22:19:20 -0400] robawt: coderanger: where can i find those standards?
[2014-05-13 22:19:36 -0400] robawt: i'm new enough i'd like to know more
[2014-05-13 22:20:30 -0400] coderanger: robawt: Basically just what MikeTLive described, companyname-foo for wrappers, foo_test for test helpers, companyname-base for base image cookbooks
[2014-05-13 22:20:32 -0400] MikeTLive: so my project team's cookbooks are project_cookbook  and we have project_databag and
[2014-05-13 22:21:34 -0400] coderanger: robawt: Check out reset's blog for a good summary of the patterns
[2014-05-13 22:21:54 -0400] MikeTLive: when we have a reusable object, it can start with the project team inside their space. and they can move fast only discussing among themselves.
[2014-05-13 22:22:10 -0400] MikeTLive: when its to go to other project teams, it can drop into contrib_cookbook ...
[2014-05-13 22:23:03 -0400] coderanger: robawt: You can also check out my jenkins and ci cookbooks as examples of how to build for extensibility
[2014-05-13 22:23:09 -0400] robawt: thx coderanger!
[2014-05-13 22:23:11 -0400] MikeTLive: when its vetted out and for all to consume because we say so  then it becomes a wrapper cookbook
[2014-05-13 22:23:17 -0400] robawt: awesome ok
[2014-05-13 22:23:50 -0400] MikeTLive: biut managing that set of source_book is still squishy in my head
[2014-05-13 22:25:55 -0400] coderanger: MikeTLive: When you factor in the poise style/structure it becomes a bit easier :)
[2014-05-13 22:26:45 -0400] MikeTLive: id like to grab community cookbooks and put them as vendor/opscode.com/community/bookname  or something like that
[2014-05-13 22:27:11 -0400] coderanger: MikeTLive: Thats what a chef server is for
[2014-05-13 22:27:20 -0400] MikeTLive: or simply vendor/opscode-bookname
[2014-05-13 22:27:24 -0400] coderanger: it acts as a release control point for cookbooks, vendored or otherwise
[2014-05-13 22:28:27 -0400] MikeTLive: with many small teams, we need to allow them to pick and chose until and unless there is a better default that emerges
[2014-05-13 22:28:41 -0400] MikeTLive: example - one forked a mysql cookbook.
[2014-05-13 22:28:47 -0400] MikeTLive: they spent some real time on that.
[2014-05-13 22:28:50 -0400] MikeTLive: and like it.
[2014-05-13 22:28:56 -0400] MikeTLive: and OK. good they can keep on using it.
[2014-05-13 22:28:57 -0400] coderanger: MikeTLive: Yeah, that gets to be tricky
[2014-05-13 22:29:13 -0400] MikeTLive: meantime, i need to find the best source-of-truth mysql cookbook.
[2014-05-13 22:29:24 -0400] MikeTLive: in my dream world, mysql themselves offer one up.
[2014-05-13 22:29:48 -0400] coderanger: MikeTLive: So my solution for that is poise + subclasses for extension
[2014-05-13 22:29:52 -0400] MikeTLive: which is oracle, i think now, so it would be oracle-mysql
[2014-05-13 22:30:31 -0400] MikeTLive: we can assume that everything comes from somebody, and thus scratch out the "/vendor/" part.
[2014-05-13 22:30:53 -0400] coderanger: MikeTLive: Yep, this is basically the github namespace model
[2014-05-13 22:31:34 -0400] coderanger: MikeTLive: There is a ticket on the supermarket repo about this, let me go find it
[2014-05-13 22:31:39 -0400] MikeTLive: what do you mean "poise" it suddenly dawns on me you didnt mean what i thought you meant and in fact you dont. https://github.com/coderanger/talk-ideas/blob/master/poise.md
[2014-05-13 22:31:56 -0400] coderanger: MikeTLive: https://github.com/opscode/supermarket/issues/217
[2014-05-13 22:32:17 -0400] coderanger: MikeTLive: That was a talk I gave at chefconf on it. https://github.com/poise/poise is the code
[2014-05-13 22:32:33 -0400] coderanger: MikeTLive: and https://www.youtube.com/watch?v=vVsSAKtgOYs is the talk
[2014-05-13 22:33:12 -0400] coderanger: Oh god I hate listening to myself speak >_<
[2014-05-13 22:33:45 -0400] MikeTLive: BINGO - existing cookbooks that are short named, "java" "mysql" need to be prefixed and chef, itself, needs to manage the abstraction to select which you use by leeting the client recipe say "java" and find the right one
[2014-05-13 22:34:15 -0400] coderanger: MikeTLive: I've been pushing for this for literally 3 years now
[2014-05-13 22:34:21 -0400] coderanger: Its been a slow battle
[2014-05-13 22:34:21 -0400] coderanger: :(
[2014-05-13 22:34:53 -0400] MikeTLive: (i talked for an hour about the culture/philosophy of why i am trying to setup chef the way i a am, and i cant listen to it either. problem is, its not written anywhere.
[2014-05-13 22:35:07 -0400] MikeTLive: dont like hearing me either.
[2014-05-13 22:36:48 -0400] MikeTLive: i come from a cooking background and so the ideas of master recipes, and refering to other recipes in recipes and things makes much sense to me.
[2014-05-13 22:37:08 -0400] MikeTLive:  you are this guy with the beard?
[2014-05-13 22:37:59 -0400] MikeTLive: you speak with passion and heart.
[2014-05-13 22:38:16 -0400] coderanger: MikeTLive: Thats me
[2014-05-13 22:44:51 -0400] _automan: Trying to install vagrant-omnibus plugin... getting "Net::HTTPNotFound: No gems found matching "vagrant-vmware-workstation" "2.3.6" nil". That's not nice.
[2014-05-13 22:48:56 -0400] coderanger: _automan: Hmm, I don't think there are any dependencies like that
[2014-05-13 22:49:05 -0400] coderanger: _automan: Is that a plugin you installed in the past?
[2014-05-13 22:50:34 -0400] _automan: coderanger: nope, it's a relatively clean workstation. I did a 'vagrant plugin install vagrant-omnibus' and got an error saying that nokogiri had to be installed manually. did that, and ran the vagrant plugin install vagrant-omnibus again and got that
[2014-05-13 22:51:28 -0400] coderanger: _automan: There are definitely no deps on the gem, if you do vagrant plugin list, what do you see?
[2014-05-13 22:55:36 -0400] _automan: coderanger: how bizarre.  now nokogiri is failing to install. it must have failed the first time and I must have missed it
[2014-05-13 22:56:05 -0400] coderanger: _automan: Nokogiri is the worst :-(
[2014-05-13 22:57:44 -0400] _automan: coderanger: yah so "sudo /opt/chef/embedded/bin/gem install nokogiri -- --use-system-libraries" is now complaining about Makefiles. FFS
[2014-05-13 22:58:12 -0400] coderanger: _automan: That would be installing it into omnibus chef, not vagrant
[2014-05-13 22:58:20 -0400] _automan: hm "libxml2 version 2.6.21 or later is required!"
[2014-05-13 22:59:03 -0400] _automan: forget it. I'll stick with chef in the box
[2014-05-13 22:59:28 -0400] coderanger: _automan: Test-kitchen ftw
[2014-05-13 23:01:26 -0400] c_t: "You shall not press down upon the brow of ops this crown of gem; you shall not crucify mankind upon a cross of CPAN."
[2014-05-13 23:01:30 -0400] c_t: er
[2014-05-13 23:01:35 -0400] c_t: s/mankind/devs/
[2014-05-13 23:01:38 -0400] c_t: bluh
[2014-05-13 23:06:44 -0400] Cope: wow wtf? Response: The '_default' environment cannot be modified.  ... I thought this was when a cookbook was frozen, but with --force I still get the error
[2014-05-13 23:07:16 -0400] coderanger: Cope: Not sure what you mean, you can't edit _default, it is just a placeholder with no data
[2014-05-13 23:07:22 -0400] Cope: no thats the error
[2014-05-13 23:07:26 -0400] Cope: when I do knife cookbook upload
[2014-05-13 23:07:40 -0400] coderanger: Cope: Do you have -E _default on the command?
[2014-05-13 23:07:41 -0400] Cope: which I am sure is the error you get when a cookbook is frozen
[2014-05-13 23:08:06 -0400] Cope: no... I don't have -E anything, just teh default
[2014-05-13 23:08:52 -0400] coderanger: Cope: Hmmmm, do you have any knife defaults set in knife.rb?
[2014-05-13 23:10:48 -0400] Cope: well waddya know.. someone had indeed placed knife[:environment] in there
[2014-05-13 23:10:54 -0400] Cope: good spot, thanks
[2014-05-13 23:10:57 -0400] coderanger: \o/
[2014-05-13 23:11:13 -0400] coderanger: Cope: That should definitely be fixed though
[2014-05-13 23:11:24 -0400] coderanger: better to have knife cookbook upload ignore -E _default rather than error
[2014-05-13 23:11:44 -0400] coderanger: Cope: you want to file the ticket or should I? :)
[2014-05-13 23:11:49 -0400] Cope: i shall
[2014-05-13 23:12:09 -0400] coderanger: Roger
[2014-05-13 23:12:56 -0400] _automan: oh that's interesting. The omnibus installer gives the warning about ssl certs.
[2014-05-13 23:13:14 -0400] coderanger: _automan: Warning?
[2014-05-13 23:14:04 -0400] _automan: coderanger: I think it is. It's really hard to tell if the box is being used from the kitchen.yml file or the Vagrantfile. "SSL validation of HTTPS requests is disabled. HTTPS connections are still" and so on.
[2014-05-13 23:14:33 -0400] coderanger: _automan: Ahh, yeah, solo still prints the error even if you aren't using a server
[2014-05-13 23:14:50 -0400] coderanger: _automan: (which is still valid since remote_file doesn't get validated and should be)
[2014-05-13 23:14:50 -0400] _automan: coderanger: Hm, ok. thanks
[2014-05-13 23:14:58 -0400] coderanger: _automan: it will get fixed in TK soon I'm sure
[2014-05-13 23:16:25 -0400] Cope: oh ffs, really? "Please detail your operating system type, version and any other relevant details"
[2014-05-13 23:16:41 -0400] Cope: it's centos 6.5 - been around 5 months... come one
[2014-05-13 23:17:23 -0400] Cope: actually that doesn't make any sense.. because my tk 6.5 box works fine
[2014-05-13 23:19:00 -0400] someara: cope do you have selinux-fu?
[2014-05-13 23:19:37 -0400] Cope: someara: it's currently 'enforcing' - once chef runs it won't be
[2014-05-13 23:19:52 -0400] someara: ha
[2014-05-13 23:20:05 -0400] Cope: so selinux stops omnibus seeing centos version?
[2014-05-13 23:20:13 -0400] dtrott: cope: SE Fu enlightment reached ..
[2014-05-13 23:20:25 -0400] someara: no, I'm just trying to debug some shit and am looking for help
[2014-05-13 23:20:45 -0400] Cope: ohhh sorry
[2014-05-13 23:20:49 -0400] Cope: being dense
[2014-05-13 23:21:06 -0400] Cope: right... sorry, yeah, I know some shit about selinux, but up against a deadline atm, and need to press on
[2014-05-13 23:21:17 -0400] someara: nah I just jumped in with a non-sequitur
[2014-05-13 23:21:39 -0400] coderanger: someara: I used to know selinux ~10 years ago
[2014-05-13 23:22:26 -0400] someara: so I'm attempting to learn selinux while developing a cookbook with it turned on.....
[2014-05-13 23:22:38 -0400] someara: slash watching a video tutorial
[2014-05-13 23:22:43 -0400] someara: and right out the gate: https://gist.github.com/someara/23edd4b477e6dc5474e0
[2014-05-13 23:22:53 -0400] someara: things that should not be
[2014-05-13 23:23:04 -0400] someara: so I'm trying to figure out how to repair that first before proceeding
[2014-05-13 23:23:10 -0400] someara: reading gentoo wikis and shit
[2014-05-13 23:23:16 -0400] coderanger: lolol
[2014-05-13 23:23:26 -0400] coderanger: someara: How did you install apache?
[2014-05-13 23:23:26 -0400] _automan: in kitchen.. are the cookbooks in the platform runlist appended to the cookbooks in the suites run list when doing a converge, or am I misunderstanding this?
[2014-05-13 23:23:32 -0400] someara: yum -y install httpd
[2014-05-13 23:23:39 -0400] coderanger: _automan: Yes, they should be
[2014-05-13 23:23:48 -0400] _automan: ok
[2014-05-13 23:23:49 -0400] coderanger: someara: Okay, so that should come tagged
[2014-05-13 23:23:55 -0400] someara: yep
[2014-05-13 23:24:08 -0400] someara: the only thing on the box not runnint as kernel_t is sshd
[2014-05-13 23:24:17 -0400] someara: s/runnint/running/
[2014-05-13 23:24:35 -0400] coderanger: someara: Hmm, did you install from EPEL maybe? I have no idea if those packages are tagged sanely
[2014-05-13 23:24:44 -0400] someara: no epel
[2014-05-13 23:24:59 -0400] someara: the image came with selinux disabled, so I had to set it to permissive, fixfiles on boot, and reboot
[2014-05-13 23:25:15 -0400] coderanger: someara: Welp, I mena fixfiles is what you want to repair it
[2014-05-13 23:25:29 -0400] coderanger: but its a pain
[2014-05-13 23:25:51 -0400] coderanger: or maybe restorecon?
[2014-05-13 23:25:57 -0400] Cope: this looks like it should work:
[2014-05-13 23:26:07 -0400] someara: the labels on the filesystem for various things the package drops off look correct
[2014-05-13 23:26:29 -0400] someara: trying to figure out how and why the service is being started and not transitioning to the proper thing
[2014-05-13 23:26:49 -0400] Cope: https://gist.github.com/Atalanta/fc18314219c59993e7f1
[2014-05-13 23:26:56 -0400] coderanger: someara: I think my knowledge is a bit out of date for that :-(
[2014-05-13 23:27:16 -0400] Cope: so we have a platform, so test "x$platform" = "x" should not pass
[2014-05-13 23:27:35 -0400] Cope: so we shouldn't get: Unable to determine platform version!
[2014-05-13 23:27:38 -0400] coderanger: someara: I think I last futzed with this around red hat 9  O:-)
[2014-05-13 23:30:39 -0400] Cope: someara: you can relabel the whole system if you want to reset it
[2014-05-13 23:30:47 -0400] Cope: touch /.autorelabel && shutdown -r now
[2014-05-13 23:31:01 -0400] Cope: that will get you to sane state
[2014-05-13 23:31:36 -0400] Cope: now, omeara, git blame has you on the latest bourne script that gets run to try to install a package
[2014-05-13 23:31:57 -0400] Cope: so why the fuck isn't it recognizing  my system? eh? and don't blame lamont
[2014-05-13 23:33:20 -0400] Cope: curiously it works if I curl the script myself and run it
[2014-05-13 23:34:03 -0400] doomviking: I blame Lamont. but not your Lamont.
[2014-05-13 23:36:05 -0400] _automan: I know I'm doing this wrong. I have two cookbooks, comp-role-base and comp-users. I want to be able to unit test the comp-users cookbook and i guess 'converge' them so that I can test both on the same vagrant vm. With kitchen, if I put comp-role-base in the run_list in kitchen.yml, then I have to also put in the metadata.rb file... but it's not a dependancy...
[2014-05-13 23:36:41 -0400] coderanger: _automan: So you want to use the berksfile for this
[2014-05-13 23:36:53 -0400] coderanger: _automan: Thats where you pull in test-specific-but-not-dependency cookbooks
[2014-05-13 23:37:10 -0400] coderanger: _automan: Use a group like test or integration
[2014-05-13 23:37:18 -0400] _automan: coderanger: ok. thanks. checking that
[2014-05-13 23:37:24 -0400] coderanger: _automan: ex. https://github.com/poise/poise/blob/master/Berksfile#L23-L27
[2014-05-13 23:40:06 -0400] _automan: coderanger: what's the link between that and the kitchen.yml file?
[2014-05-13 23:40:31 -0400] coderanger: _automan: then just include the cookbook in your test run list
[2014-05-13 23:41:30 -0400] _automan: coderanger: and conversely use berks upload and specify the group?
[2014-05-13 23:41:39 -0400] coderanger: _automan: berks upload -e test
[2014-05-13 23:41:41 -0400] coderanger: but yeah
[2014-05-13 23:41:59 -0400] _automan: k
[2014-05-13 23:51:31 -0400] someara: cope the only things I've PRed to the script ever has been some smartossy stuff
[2014-05-13 23:51:39 -0400] someara: iirc
[2014-05-13 23:53:09 -0400] Cope: only teasing you
[2014-05-13 23:53:21 -0400] Cope: did your relabel help?
[2014-05-13 23:55:49 -0400] someara: yep!
[2014-05-13 23:55:53 -0400] someara: thanks!
[2014-05-13 23:57:59 -0400] someara: I wonder what the difference between "fixfiles onreboot" and the ./authrelabel was
[2014-05-13 23:58:07 -0400] someara: auto
