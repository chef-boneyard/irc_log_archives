[2014-05-22 00:08:17 -0400] jpic: thanks for answering coderanger
[2014-05-22 00:08:49 -0400] jpic: i don't understand where to define the list of nodes for an environment in chef, i've read the manual: https://wiki.opscode.com/display/ChefCN/Environments any pointer please ?
[2014-05-22 00:10:12 -0400] coderanger: jpic: You don't define an explicit list
[2014-05-22 00:10:25 -0400] coderanger: jpic: each node just is marked with which environment it is in
[2014-05-22 00:28:45 -0400] jpic: coderanger: ok, but should i bootstrap each node manually or is there a way to define a list of nodes for a chef recipe to create all the instances in libvirt for example before doing the run_list ?
[2014-05-22 01:10:59 -0400] jpic: hi all, any idea how does that Vagrantfile get it's vm definition from ? http://dpaste.com/0X3N25T/ i've been searching for quite some time in vain so any clue would be appreciated ;)
[2014-05-22 01:26:30 -0400] elebertus: just put this together for some guys at work, might be useful https://github.com/elebertus/chef_tools_install_docs
[2014-05-22 01:26:35 -0400] elebertus: also: chefdk kids
[2014-05-22 01:26:37 -0400] elebertus: it saves lives
[2014-05-22 01:28:56 -0400] storme_away: still working on switching to berks 3 myself
[2014-05-22 02:00:53 -0400] meth: is there a way to test some recipe code in a repl quickly just for testing?
[2014-05-22 02:08:53 -0400] cheeseplus: meth: http://docs.opscode.com/chef_shell.html
[2014-05-22 02:09:30 -0400] Neozonz: I see some templates using <%= blah blah ruby code %>      and some using <% blah blah ruby code -%>
[2014-05-22 02:09:40 -0400] meth: hm
[2014-05-22 02:09:43 -0400] Neozonz: what is the difference between the <%- and <%=
[2014-05-22 02:09:59 -0400] meth: <%= replaces the line with the return value into the resulting text
[2014-05-22 02:10:02 -0400] digitalchild: output into the template
[2014-05-22 02:10:09 -0400] digitalchild: or ruby to do something with the template
[2014-05-22 02:10:11 -0400] meth: -%> simply doesn't include a new line at the end
[2014-05-22 02:10:24 -0400] Neozonz: so what would one use for an if condition?
[2014-05-22 02:10:29 -0400] digitalchild: <% %> is for if statments
[2014-05-22 02:10:37 -0400] Neozonz: oh cool
[2014-05-22 02:10:38 -0400] Neozonz: thanks
[2014-05-22 02:10:54 -0400] digitalchild: <%= somevariab you want to output into the template %>
[2014-05-22 02:11:18 -0400] Neozonz: so would this work <% if node[:blah] == "blah" %>  outputthistext  <% end %>
[2014-05-22 02:11:29 -0400] digitalchild: it should
[2014-05-22 02:11:35 -0400] digitalchild: if that ruby is correct syntax
[2014-05-22 02:11:43 -0400] meth: well it's ruby so nothing stops you from doing  <%= if x; true else false end %>   but yea if you wanted to do   <% if xyz -%> some text <% end -%> and note the -%> removes the extra new line that would be created
[2014-05-22 02:11:44 -0400] Neozonz: ok cool :D
[2014-05-22 02:12:16 -0400] Neozonz: but theres no real difference in using -%> and %>
[2014-05-22 02:12:19 -0400] Neozonz: other then line saving?
[2014-05-22 02:12:22 -0400] Neozonz: no code impact?
[2014-05-22 02:12:27 -0400] meth: nope
[2014-05-22 02:12:49 -0400] meth: like you may have <% if foo %> on a line by it self which adds a new line to the output
[2014-05-22 02:13:12 -0400] Neozonz: what would happen if i did the if statement in <%=
[2014-05-22 02:13:57 -0400] meth: not sure
[2014-05-22 02:14:37 -0400] digitalchild: it wont work
[2014-05-22 02:14:38 -0400] meth: i might be wrong but i think <%= basically just maps to `print`
[2014-05-22 02:41:15 -0400] meth: I'm amazed using chef omnibus with rvm isn't considered more critical https://tickets.opscode.com/browse/CHEF-3581
[2014-05-22 02:45:28 -0400] ianblenke: I thought the point of omnibus was that it not require any ruby as it has an embedded ruby If that is the case, running chef under rbenv/rvm/system ruby is kinda undefined when using omnibus.
[2014-05-22 03:09:06 -0400] stormerider: ianblenke: +1
[2014-05-22 03:09:06 -0400] meth: if that was the case then why not just install ruby? why go through the trouble?
[2014-05-22 03:09:07 -0400] meth: a big part of the reason for omnibus I believe is to isolate the environment from side affects like gem dependencies
[2014-05-22 03:09:07 -0400] stormerider: meth: the idea of omnibus is to provide a more consistent experience across OSes than dealing with various OS versions of ruby (especially 1.8)
[2014-05-22 03:09:08 -0400] meth: surely you don't think vagrant author also expects you to not have ruby installed?
[2014-05-22 03:09:08 -0400] meth: stormerider:  yea that's another great reason
[2014-05-22 03:09:09 -0400] stormerider: meth: just because you might have ruby installed doesnt mean that you should necessarily be using that ruby for chef itself
[2014-05-22 03:09:09 -0400] meth: right.. but the problem in that ticket above is that rvm sets GEM_* environment variables that an omnibus installation should by default ignore just like vagrant does
[2014-05-22 03:09:10 -0400] stormerider: rvm in particular is known to break onmnibus with the way it mucks with GEM_PATH and such
[2014-05-22 03:09:41 -0400] stormerider: the general impression i've gotten is that the chef folks have a high disdain for rvm compared to rbenv/chruby/etc
[2014-05-22 03:09:57 -0400] meth: well GEM_* env variables was created for a reason and it's a valid use case.. an omnibus installation wants to be totally self isolated so it should protect it self and allow GEM_* to be modified with an extra option perhaps
[2014-05-22 03:10:41 -0400] meth: how does rbenv and chruby achieve the same affect?  do they even manage gemsets for you?
[2014-05-22 03:11:36 -0400] stormerider: coderanger can probably expound on more detail. i dont know enough about the varied systems, nor do i care to dive into them; i use omnibus as it was intended.
[2014-05-22 03:11:59 -0400] coderanger: You raaaaaaang?
[2014-05-22 03:12:22 -0400] stormerider: coderanger: meth has questions about omnibus and rvm vs rbenv vs chruby etc
[2014-05-22 03:12:22 -0400] meth: intended = isolated from system install = not correctly working
[2014-05-22 03:12:39 -0400] stormerider: i know ive heard you expound upon it before
[2014-05-22 03:13:00 -0400] meth: I just expect this ticket to have higher propriety since it's such an easy fix and so many people use rvm https://tickets.opscode.com/browse/CHEF-3581
[2014-05-22 03:13:09 -0400] coderanger: meth: Whats your question? not seeing it from a quick scan
[2014-05-22 03:13:59 -0400] meth: it's just basically that rvm uses GEM_* env variables to switch between gemsets and an omnibus installation should generally protect against that by default which is what vagrant did as an example in there
[2014-05-22 03:14:12 -0400] coderanger: Yeah, there is no way to fix that without literally breaking Ruby
[2014-05-22 03:14:25 -0400] coderanger: rvm is a terrible tool and you should never ever use it
[2014-05-22 03:14:53 -0400] coderanger: The only option is to make a wrapper script for bin/ruby in the omnibus install that unsets those env vars
[2014-05-22 03:15:01 -0400] coderanger: but then you can't actually use them if you want to
[2014-05-22 03:15:12 -0400] meth: well vagrant basically ignores GEM_*  https://github.com/mitchellh/vagrant/blob/7ef6c5d9d7d4753a219d3ab35afae0d475430cae/plugins/commands/plugin/gem_helper.rb#L20
[2014-05-22 03:15:20 -0400] coderanger: and rvm usage is waning rapidly, so no one has bothered
[2014-05-22 03:16:02 -0400] coderanger: meth: Yep, thats the only real option, and as I said, its just such an edge case at this point it hasn't been a priority
[2014-05-22 03:16:04 -0400] meth: I'm curious then how rbenv and chruby are achieving it
[2014-05-22 03:16:07 -0400] coderanger: rvm is functionally dead
[2014-05-22 03:16:22 -0400] coderanger: meth: They set the gem path at build time
[2014-05-22 03:16:32 -0400] meth: then how do you switch gem sets?
[2014-05-22 03:16:36 -0400] meth: rvm supports multiple gemsets
[2014-05-22 03:16:41 -0400] coderanger: There is no such thing as gemsets
[2014-05-22 03:16:47 -0400] coderanger: bundler made them entirely obsolete
[2014-05-22 03:16:56 -0400] meth: well I've been using rvm for years now and i think it's pretty dam awesome
[2014-05-22 03:17:26 -0400] coderanger: No "awesome" software overrides cd
[2014-05-22 03:17:34 -0400] coderanger: Pretty sure thats like a rule :)
[2014-05-22 03:18:09 -0400] meth: yea i did find that a bit annoying but it can be disabled and if someone finds that useful then that's up to them i guess
[2014-05-22 03:20:18 -0400] gkra: anyone know if it's possible to use the opscode nginx cookbook to install nginx via package and passenger via source?
[2014-05-22 03:20:19 -0400] meth: I have honestly never used gemsets really
[2014-05-22 03:21:10 -0400] gkra: or do I need to use the passenger cookbook if I want to do that?
[2014-05-22 03:21:55 -0400] coderanger: meth: Indeed, as I said, bundler and its vendor mode makes them obsolete
[2014-05-22 03:26:59 -0400] meth: but I'm sooooo lazy to go learn a new ruby manager lol
[2014-05-22 03:27:40 -0400] stormerider: meth: then i think the standard response is "patches welcome" :)
[2014-05-22 03:30:56 -0400] meth: well based on https://github.com/postmodern/chruby it looks like it also modifies GEM_HOME and GEM_PATH
[2014-05-22 03:31:25 -0400] meth: GEM_ROOT and some others too
[2014-05-22 03:33:40 -0400] coderanger: meth: I just don't use any, I don't generally need multiple rubies locally
[2014-05-22 03:34:28 -0400] cheeseplus: meth: vagrant moved to omnibus style packaging as well
[2014-05-22 03:34:46 -0400] cheeseplus: woops scrollback fail irccloud
[2014-05-22 03:34:46 -0400] meth: well another great feature rvm was ability to build whichever ruby you want on any system .. and having jruby is also very useful for certain tools
[2014-05-22 03:34:48 -0400] cheeseplus: ignore me
[2014-05-22 03:35:11 -0400] coderanger: meth: ruby-build works fine for that
[2014-05-22 03:35:25 -0400] coderanger: meth: When I need weird things like jruby, it's in homebrew
[2014-05-22 03:35:53 -0400] meth: i don't run osx on my servers
[2014-05-22 03:36:17 -0400] coderanger: Definitely never use any of these on a server
[2014-05-22 03:36:33 -0400] coderanger: hell, I think installing gcc on a server is flat out wrong
[2014-05-22 03:36:54 -0400] coderanger: poise-ruby has recent versions for debian and ubuntu, and SCL has recent versions for RHEL/CentOS
[2014-05-22 03:37:07 -0400] coderanger: and really you should be building containers either via omnibus, packer, whatever
[2014-05-22 03:37:12 -0400] coderanger: at which point it stops mattering
[2014-05-22 03:38:04 -0400] meth: we're moving in that direction but it's a long road to switch large existing installs over
[2014-05-22 03:52:40 -0400] gkra: so... is there a good cookbook that will let me install phusion passenger in a user-specific rvm ruby?
[2014-05-22 03:52:47 -0400] meth: coderanger:  i do mostly agree with everything you said and it's very good points so thanks for chat
[2014-05-22 04:03:30 -0400] meth: hm SCL is still back on 1.9.3
[2014-05-22 04:05:34 -0400] gkra: coderanger: I'd love to not have any build tools on servers, but it seems like a lot of the chef community doesn't seem to think that way.
[2014-05-22 04:06:35 -0400] gkra: "This foobaz cookbook will install and configure foobaz. It requires build-essentials and direct, unfettered web access."
[2014-05-22 04:08:34 -0400] gkra: postgres, nginx and runit cookbooks all require build-essential, which just makes me cringe.
[2014-05-22 04:09:57 -0400] coderanger: gkra: Yeah, I'm working on it >_<
[2014-05-22 04:10:03 -0400] gkra: and chef-client requires runit...
[2014-05-22 04:10:13 -0400] gkra: so boom, all your chef-clients get build-essentials
[2014-05-22 04:10:14 -0400] coderanger: nginx at least only requires build-essential if you specifically run it in source mode
[2014-05-22 04:10:31 -0400] coderanger: well, it only uses it I should say
[2014-05-22 04:11:27 -0400] gkra: so... any recommendations for cookbooks to park passenger in a specific rvm user-install?
[2014-05-22 04:11:48 -0400] gkra: I foolishly tried an rvm system install of ruby 2.1.2, and chef-client promptly vomited on the next attempt to run it.
[2014-05-22 04:12:15 -0400] gkra: which doesn't make sense, since we installed the chef-client RPM, which I thought was more-or-less the omnibus.
[2014-05-22 04:19:10 -0400] gkra: any idea why chef-client would barf with a rvm system install of 2.1.2?
[2014-05-22 04:19:26 -0400] coderanger: gkra: What kind of barf?
[2014-05-22 04:19:36 -0400] gkra: 'cause it's looking like the system install of 2.1.2 would make it really easier to use the nginx::passenger cookbook...
[2014-05-22 04:19:50 -0400] gkra: heh, I'd have to break it all over again to show you.
[2014-05-22 04:21:21 -0400] gkra: wait, that's as easy as "chef-client -o rvm::system" :)
[2014-05-22 04:21:41 -0400] coderanger: My general understanding of passenger is you just need to set the ruby path to point at whatever ruby you want it to build against
[2014-05-22 04:21:45 -0400] coderanger: but I've never actually used it
[2014-05-22 04:22:03 -0400] gkra: yeah, i did that and it installed in the CentOS ruby 1.8
[2014-05-22 04:23:37 -0400] gkra: apparently there's a great cookbook for unicorn.
[2014-05-22 04:23:43 -0400] gkra: but not so much for passenger
[2014-05-22 04:24:19 -0400] gkra: ruby is building, just a moment
[2014-05-22 04:25:59 -0400] gkra: coderanger: here you go: https://gist.github.com/gkra/30431a498fafe02d27d7
[2014-05-22 04:26:09 -0400] gkra: post rvm::system of ruby-2.1.2
[2014-05-22 04:26:54 -0400] coderanger: gkra: Check your environment for GEM_PATH or GEM_HOME
[2014-05-22 04:27:00 -0400] coderanger: gkra: Really just don't use rvm on a server
[2014-05-22 04:27:08 -0400] gkra: okay...
[2014-05-22 04:27:18 -0400] coderanger: gkra: use ruby-build if absolutely needed, but chances are you can use poise-ruby or SCL
[2014-05-22 04:27:28 -0400] gkra: poise-ruby, eh?
[2014-05-22 04:28:42 -0400] gkra: and now I find: https://github.com/fnichol/chef-ruby_build
[2014-05-22 04:28:46 -0400] gkra: *facepalm*
[2014-05-22 04:28:57 -0400] gkra: okay, I start over tomorrow. I've had enough for today. :)
[2014-05-22 04:29:03 -0400] gkra: coderanger: thanks for your help :)
[2014-05-22 04:29:10 -0400] coderanger: No problem
[2014-05-22 04:29:15 -0400] coderanger: Just pretend rvm doesn't exist
[2014-05-22 04:29:19 -0400] coderanger: you'll be happier all around
[2014-05-22 04:29:20 -0400] gkra: gladly
[2014-05-22 05:04:38 -0400] ignatz: viva ruby-install
[2014-05-22 08:49:03 -0400] whysthatso: hey all
[2014-05-22 08:50:38 -0400] SJM: Hi, any ideas why my chef server ip is being appended with ".cloud.opsource.net/..." when i try to upload cookbooks?
[2014-05-22 08:51:11 -0400] whysthatso: bootstrapping a node with "knife ec2 server create" i'm having problems with the tagging: i define 3 tags (i.e. --tags Environment=test, Role=file_server, Cname=fs.lan) but during the run only the std tags get set: (printout during knife run: Tags: Environment: test, Name: ip-10-20-10-60.aws1.lan )
[2014-05-22 08:51:38 -0400] whysthatso: my AWS api user has admin rights, so should be able to set tags and their values
[2014-05-22 08:51:41 -0400] whysthatso: am i missing something?
[2014-05-22 09:28:51 -0400] dopus: hi
[2014-05-22 09:41:11 -0400] Matt_P1: Hi there, I'm running chef 10.18.2 and attribute files from different cookbooks are not loading in the order of the runlist. This seems to be bug https://tickets.opscode.com/browse/CHEF-2903 . Is there anyway to workaround this ?
[2014-05-22 09:54:57 -0400] srenatus: Matt_P1: I guess you've been advised this quite a lot already, but what keeps you from upgrading to chef 11?
[2014-05-22 09:55:11 -0400] uplate_: Hows it going?
[2014-05-22 09:56:00 -0400] uplate_: Is this the right place to ask some questionarooonies?
[2014-05-22 09:57:37 -0400] Matt_P1: srenatus: That's what i'm doing in parallel but I was looking for a workaround to fix my broken recipes faster
[2014-05-22 10:05:58 -0400] uplate_: Anyone have some time to help me figure out a knife cookbook upload error?
[2014-05-22 10:06:56 -0400] jonlives: uplate_: you'd be better off just asking the question, then anyone who knows the answer can help - don't ask to ask :)
[2014-05-22 10:07:33 -0400] uplate_: @jonlives thanks!
[2014-05-22 10:08:10 -0400] uplate_: Im getting ERROR: Errno::EACCES: Permission denied - /var/chef when i try to run knife cookbook upload *name* -o /file/bla/bla
[2014-05-22 10:08:41 -0400] jonlives: uplate_: is /var/chef mentioned anywhere in your knife.rb?
[2014-05-22 10:08:47 -0400] uplate_: nope
[2014-05-22 10:08:58 -0400] uplate_: here is the -vv output
[2014-05-22 10:09:13 -0400] uplate_: ~/.rvm/rubies/ruby-1.9.3-p545/lib/ruby/1.9.1/fileutils.rb:247:in `mkdir': Permission denied - /var/chef (Errno::EACCES)
[2014-05-22 10:09:51 -0400] uplate_: From what i've read it sounds like knife is trying to write locally to /var/chef (which doesn't exist on my local machine)
[2014-05-22 10:10:40 -0400] jonlives: uplate_: yeah I think it might be trying to write temporary files, just checking if that's correct
[2014-05-22 10:11:46 -0400] jonlives: uplate_: could you gist the full stacktrace please?
[2014-05-22 10:12:29 -0400] jonlives: uplate_: you might also want to try adding this line to your knife.rb: cache_options( :path => '/path/that/exists/checksums' )
[2014-05-22 10:13:06 -0400] srenatus: Matt_P1: I assume order matters because you've got precedences used multiple times... so one workaround would be to increase precedence for the values you want to end up with
[2014-05-22 10:13:22 -0400] srenatus: Matt_P1: you can do  normal[:foo] = :bar in attributes files
[2014-05-22 10:14:05 -0400] jonlives: uplate_: yeah I think it's trying to write checksums locally while it generates the stuff to upload for your cookbook, and that defaults to /var/chef.
[2014-05-22 10:14:08 -0400] uplate_: jonlives: i just added the folder paths knife was complaining about, and now have moved onto a new erro
[2014-05-22 10:14:15 -0400] jonlives: uplate_: progress!!
[2014-05-22 10:14:20 -0400] jonlives: let's see the new one :p
[2014-05-22 10:14:20 -0400] uplate_: aww yisss
[2014-05-22 10:14:36 -0400] uplate_: kk, i think this one makes more sense, its an 403 "forbidden
[2014-05-22 10:14:54 -0400] jpic: hi all, how to execute chef-client on a node ? getting some error: $ knife ssh "name:db2" "sudo chef-client" -x vagrant
[2014-05-22 10:14:55 -0400] jonlives: uplate_: so that likely means the client key you're using in knife.rb doesn't have admin permissions on the server.
[2014-05-22 10:14:57 -0400] jpic: WARNING: Failed to connect to db2 -- SocketError: getaddrinfo: Name or service not known
[2014-05-22 10:15:08 -0400] uplate_: jonlives: Thats kind of what im thinking
[2014-05-22 10:15:39 -0400] jonlives: uplate_: do you have admin permissions on the server?
[2014-05-22 10:15:45 -0400] jonlives: or do you know anybody who does? :p
[2014-05-22 10:15:51 -0400] uplate_: jonlives: I should
[2014-05-22 10:16:01 -0400] uplate_: jonlives: we have 3 chef servers, 2 are 10, 1 is 11
[2014-05-22 10:16:12 -0400] jonlives: uplate_: ok - are the node_name and client_key params in your knife.rb set to the correct node and client key?
[2014-05-22 10:16:14 -0400] uplate_: jonlives: so its a hot mess, let me see fi i can get into this chef10
[2014-05-22 10:16:32 -0400] uplate_: jonlives: they are, but im using the "generic" right now, not mine, so let me change that and see how we do
[2014-05-22 10:16:41 -0400] jonlives: uplate_: ah that might not be an admin key
[2014-05-22 10:17:00 -0400] jonlives: uplate_: if you use your key, and then do "knife client edit generic_client_name", it will probably say admin:false
[2014-05-22 10:17:13 -0400] jonlives: if so, that's why you can't upload with it :0
[2014-05-22 10:18:43 -0400] uplate_: jonlives: i think you are onto it
[2014-05-22 10:19:22 -0400] jonlives: aha
[2014-05-22 10:20:11 -0400] jpic: hi all, i don't understand why chef client uses a wrong chef server url, not the one in my knife.rb: http://dpaste.com/0YBVJQC/ any idea please ?
[2014-05-22 10:20:36 -0400] Er00: jpic: if you run knife configure is it definitely looking at the knife.rb you think it's looking at?
[2014-05-22 10:21:22 -0400] jonlives: jpic: that error is coming from chef-client on the node, which can't find /etc/chef/client.rb and is using defaults
[2014-05-22 10:21:35 -0400] jonlives: the config from your knife.rb doesn't affect what the node tries to run.
[2014-05-22 10:22:30 -0400] jonlives: you need to get a valid client.rb onto the node first.
[2014-05-22 10:22:54 -0400] jpic: $ knife configure -> Overwrite /home/jpic/work/numergy-chef-repo/.chef/knife.rb? (Y/N) that's the right one
[2014-05-22 10:23:38 -0400] jonlives: jpic: you're confusing knife.rb which lives on your local node with client.rb which lives on the node you're running chef-client on
[2014-05-22 10:23:59 -0400] jpic: jonlives: thanks, is there a good way to get client.rb to be setup on bootstrap ?
[2014-05-22 10:24:03 -0400] jonlives: when you run that knife-ssh command, it runs chef-client on the node, which by default looks for settings in /etc/chef/client.rb
[2014-05-22 10:24:12 -0400] jonlives: jpic: you might wanna look into knife bootstrap
[2014-05-22 10:24:25 -0400] jonlives: http://docs.opscode.com/knife_bootstrap.html
[2014-05-22 10:24:32 -0400] jpic: yes, thanks !
[2014-05-22 10:24:39 -0400] jonlives: no worries!
[2014-05-22 10:28:39 -0400] bixu: Chef peeps, I have fairly low-level omnibus questions.  Is this the right channel?
[2014-05-22 10:29:15 -0400] jonlives: bixu: don't ask to ask as they say, ask away and then anybody who knows can answer :)
[2014-05-22 10:29:43 -0400] jonlives: you could also try #chef-hacking if nobody knows in here
[2014-05-22 10:30:51 -0400] bixu: Okay - gist of the errors I'm seeing is coming up.
[2014-05-22 10:31:33 -0400] bixu: I'm seeing a failure building omnibus/chef-client on SmartOS - here's the error output:
[2014-05-22 10:31:42 -0400] bixu: https://gist.github.com/bixu/696d4ff69c7cb139f239
[2014-05-22 10:33:15 -0400] jonlives: bixu: I don't use SmartOS, but it looks like the error is essentially this: " #error GNU libiconv not in use but included iconv.h is from libiconv"
[2014-05-22 10:34:02 -0400] bixu: jonlives: Yes, but I don't know what that means.  I do definitely have gnu libiconv on the system - maybe I need to specify some env var to tell omnibus where it is?
[2014-05-22 10:34:28 -0400] jonlives: bixu: possibly helpful: http://www.linuxforums.org/forum/applications/61260-problems-installing-glib-libiconv-not-used.html
[2014-05-22 10:34:35 -0400] bixu: danke
[2014-05-22 10:35:00 -0400] jonlives: np!
[2014-05-22 10:36:34 -0400] jpic: so I should setup a chefclient role that sets up client.rb and whatever I need (in occurrence I also need a hostname entry)
[2014-05-22 10:38:20 -0400] gyre007_: why on earth is knife ignoring bootstrap version and installing the latest one ? https://gist.github.com/milosgajdos83/89fae14dab4f3ac106ca
[2014-05-22 10:39:27 -0400] gyre007_: something's dodgy with the powershell scripts....
[2014-05-22 11:52:37 -0400] jpic: hi all, i don't understand, i created a cookbook in chef-repo/cookbooks/my_percona, added depends 'percona' in chef-repo/cookbooks/my_percona/metadata.rb, but when trying to deploy it it fails The following cookbooks are required by the client but don't exist on the server: * percona. Any clue please ?
[2014-05-22 11:53:06 -0400] whiteadam: jpic: Did you also include it in the recipe cookbook?
[2014-05-22 11:53:31 -0400] jpic: whiteadam: yes, with include_recipe
[2014-05-22 11:55:08 -0400] jonlives: jpic: have you uploaded the percona cookbook to the server too?
[2014-05-22 11:55:08 -0400] jpic: it's true that i don't see percona in https://chef-server/cookbooks, what's the right way to get cookbooks to upload **with** their dependencies ?
[2014-05-22 11:55:19 -0400] jonlives: knife cookbook upload foo --include-dependencies
[2014-05-22 11:55:31 -0400] whiteadam: jpic: Are you using Berkshelf?
[2014-05-22 11:55:43 -0400] jonlives: one sec, might be the wrong option..
[2014-05-22 11:56:29 -0400] jonlives: ignore what I said, that was wrong.
[2014-05-22 11:56:35 -0400] whiteadam: jpic: If so, I believe it's: berks upload
[2014-05-22 11:56:45 -0400] whiteadam: but I may be wrong because it is early
[2014-05-22 11:57:06 -0400] jonlives: ah - no it wasn't
[2014-05-22 11:57:15 -0400] jonlives: jpic: so knife cookbook upload foo --include-dependencies definitely will do it
[2014-05-22 11:57:20 -0400] jonlives: sorry for the confusion
[2014-05-22 12:01:18 -0400] jpic: thanks for your advice, that didn't do the trick, but by doing a site install of percona and an upload it worked: http://dpaste.com/3XVDSCV/
[2014-05-22 12:05:02 -0400] jpic: whiteadam: but would i have to run berks upload from every coobook using berks in my chef-repo/cookbooks/ ?
[2014-05-22 12:12:39 -0400] mattt: quick question -- got a recipe that shells out at execution time and sets a variable w/ results, however i want to use that variable in a template, which gets built at compile time
[2014-05-22 12:12:48 -0400] mattt: what's the best pattern to overcome this ?
[2014-05-22 12:22:23 -0400] jbz: [
[2014-05-22 12:29:44 -0400] nobody18188181: with chef bug CHEF-3694; how does one properly handle resource cloning when using a list? e.g. yum_package with a list in a loop?
[2014-05-22 12:30:44 -0400] phutchins: Hey, anyone seen "404 Domain not served here" when using remote_file resource?
[2014-05-22 12:30:56 -0400] phutchins: a wget on the file works perfectly from the box...
[2014-05-22 12:37:20 -0400] whiteadam: Anyone know of something that can analyze AWS security groups and print a nice little map for me?
[2014-05-22 12:46:49 -0400] dyer: whiteadam, yes
[2014-05-22 12:47:07 -0400] dyer: not sure I wuold call it "pretty" but its definitely a picture :)
[2014-05-22 12:47:44 -0400] dyer: trying to find it again
[2014-05-22 12:48:20 -0400] whiteadam: dyer: hah, thanks. I'm trying to clean up someone else's mess and it's pretty rough
[2014-05-22 12:49:20 -0400] dyer: yea, good luck
[2014-05-22 12:49:21 -0400] dyer: aws-security-viz
[2014-05-22 12:49:29 -0400] dyer: https://github.com/anaynayak/aws-security-viz
[2014-05-22 12:49:34 -0400] whiteadam: dyer: thanks man
[2014-05-22 12:49:38 -0400] dyer: np, been there
[2014-05-22 12:49:49 -0400] dyer: "been"..... thats actually funnny
[2014-05-22 12:49:53 -0400] dyer: I am still there
[2014-05-22 12:50:02 -0400] whiteadam: hahah, I know the feeling
[2014-05-22 12:50:21 -0400] dyer: hope your using vpc ?
[2014-05-22 12:50:25 -0400] dyer: makes fixing the problem a lot easier
[2014-05-22 12:50:29 -0400] whiteadam: Our talking heads have decided to move everything to SoftLayer, so I'm about to be there in droves... cuz I don't think it works the way they think it workds
[2014-05-22 12:50:52 -0400] dyer: We are hybrid in softlayer and aws as well
[2014-05-22 12:51:10 -0400] dyer: You can get direct connect to their some of their pops
[2014-05-22 12:51:23 -0400] whiteadam: Is SL as different from AWS as it looks>
[2014-05-22 12:51:41 -0400] dyer: We only use softlayer for bare metal
[2014-05-22 12:51:46 -0400] whiteadam: damnit
[2014-05-22 12:52:03 -0400] whiteadam: Do they manage the hypervisor or is it all yours?
[2014-05-22 12:52:27 -0400] dyer: Anyone know if a version constraint in an environment is higher or lower then one set in a runlist directly in a role ?
[2014-05-22 12:52:42 -0400] dyer: We are not using virtualization at softlayer
[2014-05-22 12:52:51 -0400] whiteadam: Ah
[2014-05-22 12:53:01 -0400] dyer: we have some components that are very sensitive to virtualization ( real time media processing )
[2014-05-22 12:53:10 -0400] dyer: so those need to be on bare metal
[2014-05-22 12:53:15 -0400] iverson0881: whiteadam: i'd personally recommend their baremetal service. particularly because their vm service doesn't offer ext4 support...if that's important to you
[2014-05-22 12:53:29 -0400] iverson0881: whiteadam: plus it's cheaper than an aws instnace
[2014-05-22 12:53:49 -0400] dyer: whiteadam, their prices are negotiable too
[2014-05-22 12:54:00 -0400] dyer: depending on your commitment
[2014-05-22 12:54:08 -0400] iverson0881: whiteadam: we've been using SL for the last 2 years and have been very happy with their service over aws
[2014-05-22 12:54:19 -0400] iverson0881: whiteadam: agreed...their prices are VERY negotiable
[2014-05-22 12:54:33 -0400] dyer: We are paying like 250 for a single quad core w/ 16gb of ram and a 500gb hdd
[2014-05-22 12:54:43 -0400] whiteadam: Yeah, we just signed a partner deal and the prices are crazy low
[2014-05-22 12:55:02 -0400] dyer: w/ dual PSU's and in racks w/ dual switches
[2014-05-22 12:55:11 -0400] whiteadam: I'm mostly curious about how they do DNS, Load Balancers, firewalls, all that fun stuff.
[2014-05-22 12:55:34 -0400] dyer: be careful though, some of their models dont offer redundant PSU's and some data centers only have single switches at the tops of the racks
[2014-05-22 12:55:44 -0400] dyer: whiteadam - we still use route53 for DNS
[2014-05-22 12:56:05 -0400] dyer: just started using their LB for a POC deployment, so far so good
[2014-05-22 12:56:15 -0400] whiteadam: That's what I was thinking I'd do, or set up an IPA server to handle internal stuff.
[2014-05-22 12:56:17 -0400] iverson0881: whiteadam: softlayer doesnt really do DNS and i'd suggest to look elsewhere for it...you can continue to use route53
[2014-05-22 12:56:43 -0400] dyer: iverson0881 - yes they do
[2014-05-22 12:56:59 -0400] dyer: well, I see the option in the portal, but I have never actually used it
[2014-05-22 12:57:02 -0400] iverson0881: dyer: oh ok...i'd still suggest to look elsewhere haha
[2014-05-22 12:57:12 -0400] dyer: iverson0881 - I would agree :)
[2014-05-22 12:57:32 -0400] iverson0881: whiteadam: their load balancer offerings are fairly good...particularly since it's a dedicated hardware load balancer if you're getting that. haven't looked at their shared load balancer offering
[2014-05-22 12:58:16 -0400] iverson0881: whiteadam: as far as firewall you can always do local iptables managed by some configuration management tool or you can get a dedicated fortinet based device to cover an entire vlan
[2014-05-22 12:58:35 -0400] dyer: Going to ask this again since it might have been missed.... Does anyone know if a version constraint in an environment takes higher or lower precedence then one set in a runlist  directly in a role ?
[2014-05-22 12:58:44 -0400] whiteadam: iverson0881: Yeah, I was worried it would be that way. We have a bunch of sysadmins, so now I just have to push more automation.
[2014-05-22 12:59:02 -0400] iverson0881: whiteadam: one thing I'd suggest and push hard for is to get a large subnet under a vlan and not divvy it up
[2014-05-22 12:59:33 -0400] iverson0881: whiteadam: it'll make your life easier
[2014-05-22 12:59:55 -0400] whiteadam: thanks for the advice... I feel that this is going to be a shock for these guys who have been using AWS for the past 3-4 years
[2014-05-22 12:59:57 -0400] iverson0881: whiteadam: only exception would be PCI compliancy type stuff
[2014-05-22 13:00:09 -0400] whiteadam: iverson0881: Yeah, we have to worry about that.
[2014-05-22 13:00:50 -0400] n1ko: why push for large subnet
[2014-05-22 13:01:04 -0400] n1ko: and in my experience the hw lb's are crappy crap crappazoid
[2014-05-22 13:01:18 -0400] iverson0881: whiteadam: yeah when we made  the switch everything got faster and more consistent performance...and our bill dropped. (damn i sound like a advert)
[2014-05-22 13:01:26 -0400] n1ko: you pay arm and leg for them and they are a) complicated and b) limited
[2014-05-22 13:02:26 -0400] n1ko: isnt softlayer the one that was bought by ibm?
[2014-05-22 13:02:38 -0400] n1ko: we previously used ibm smartcloud and that was the crappiest platform ever
[2014-05-22 13:02:50 -0400] n1ko: hopefully the softlayer guys are still running the show and not ibm
[2014-05-22 13:03:05 -0400] whiteadam: n1ko: Yeah, they are.
[2014-05-22 13:03:17 -0400] iverson0881: n1ko: particularly to ensure that you're not having vlan sprawl and if you having rapid growth...also if you have different subnets under the same vlan they will have to go to a Core switch and come back down to your ToR even if they were in the same rack but in a different subnet due to the way l3 routing works
[2014-05-22 13:04:07 -0400] iverson0881: n1ko: yes softlayer was bought earlier this year...not much has changed so far...it is a separate offering than ibm smartcloud afaik and haven't ever used that...
[2014-05-22 13:04:32 -0400] iverson0881: n1ko: what do you suggest? nginx + keepaliveD?
[2014-05-22 13:06:57 -0400] n1ko: ibm smartcloud was actually shut down
[2014-05-22 13:07:09 -0400] n1ko: and ibm suggested that existing customers should migrate to sl
[2014-05-22 13:07:12 -0400] n1ko: (manually)
[2014-05-22 13:07:22 -0400] n1ko: wonder how many customers they lost...
[2014-05-22 13:07:52 -0400] n1ko: and yeah, nginx and your-best-ha-solution is the way i would suggest
[2014-05-22 13:08:17 -0400] n1ko: iverson0881: but big subnets... the security is hard
[2014-05-22 13:08:31 -0400] n1ko: if you run external hw firewalls
[2014-05-22 13:09:54 -0400] iverson0881: n1ko: sure...depends on your environment...obviously anything covered in the PCI compliance world would likely need to be in its own subnet for additional protection
[2014-05-22 13:11:03 -0400] gyre007_: why on earth is knife ec2 ignoring my ssh user and tries to bootstrap windows node with default user ie root ->> Net::SSH::AuthenticationFailed: Authentication failed for user root@ec2
[2014-05-22 13:11:05 -0400] gyre007_: rrrr
[2014-05-22 13:11:31 -0400] gyre007_: passing -x USER makes no difference...it just simply ignores it ;-)
[2014-05-22 13:12:00 -0400] iverson0881: anyway i gotta get going...later all
[2014-05-22 13:21:59 -0400] tier: anyone here familiar with the zabbix community cookbook?
[2014-05-22 13:26:55 -0400] jpic: hi all, how to make chef update other servers running chef-client as a service which have the same role ? ie. when chef deploys db-node-2, it'll search for ip of db-node-1 and use it in its config, i'd like db-node-1 to re-run its run_list so that its config gets updated with the ip of db-node-2 ... does that make any sense ? what's the right way ?
[2014-05-22 13:27:37 -0400] jpic: do i have to run chef-client manually on db-node-1 ?
[2014-05-22 13:28:52 -0400] srenatus: jpic: push jobs are currently enterprise chef only, AFAIK: http://docs.opscode.com/pushy.html
[2014-05-22 13:29:25 -0400] srenatus: jpic: but there's other options, such as integrating serf (serfdom.io) with chef... or just run chef-client every <often enough> minutes ;)
[2014-05-22 13:31:08 -0400] jpic: thanks for the heads up srenatus
[2014-05-22 13:32:02 -0400] srenatus: :)
[2014-05-22 13:34:41 -0400] ShayneC: hoping to get some help with a knife search command
[2014-05-22 13:35:05 -0400] jonlives: ShayneC: don't ask to ask ;)
[2014-05-22 13:35:10 -0400] ShayneC: if I want to return multiple attributes using the -a flag how can I do that?
[2014-05-22 13:35:28 -0400] ShayneC: for example, I can run this ok:  knife search node 'awsstackname:foo' -a hostname
[2014-05-22 13:35:43 -0400] ShayneC: but if I want to return the hostname and ipaddress
[2014-05-22 13:35:53 -0400] ShayneC: I cannot run this knife search node 'awsstackname:foo' -a hostname ipaddress
[2014-05-22 13:36:23 -0400] jonlives: ShayneC: try -a hostname -a ipaddress
[2014-05-22 13:37:11 -0400] ShayneC: tried that, but unfortunately it only acts on the last -a value so in this case I end up with only the ipaddress
[2014-05-22 13:37:55 -0400] jonlives: ShayneC: what version of knife? works for me using 11.10.4
[2014-05-22 13:38:13 -0400] ShayneC: 11.8.0
[2014-05-22 13:38:25 -0400] ShayneC: lemmee upgrade if that does the trick
[2014-05-22 13:38:27 -0400] ShayneC: thanks!
[2014-05-22 13:38:30 -0400] jonlives: np!
[2014-05-22 13:41:46 -0400] cyrusdavid: hi, how do I debug this error?
[2014-05-22 13:41:47 -0400] cyrusdavid: Option name's value (none) does not match regular expression /^[\-[:alnum:]_:.]+$/
[2014-05-22 13:45:20 -0400] jonlives: cyrusdavid: what are you doing to get that error?
[2014-05-22 13:45:23 -0400] jonlives: or trying to do, rather
[2014-05-22 13:45:38 -0400] jpic: how does chef client knows if it has to make a run ?
[2014-05-22 13:45:56 -0400] gleam: has anyone had issues using 'real' ssl certificates with open source chef server? it gets installed to nginx just fine, but erchef fails to verify the cert when it's connecting for bookshelf
[2014-05-22 13:46:10 -0400] cyrusdavid: jonlives, running a run list. I actually noticed the server's hostname changed to "none"
[2014-05-22 13:46:31 -0400] jonlives: jpic: chef client can run in daemonized mode, where it kicks off a run every <interval> seconds
[2014-05-22 13:47:00 -0400] jonlives: jpic: if there's an init.d script for chef-client, that's what it's doing.
[2014-05-22 13:47:14 -0400] jonlives: cyrusdavid: ah - that might be it, no idea why it'd have changed tho :p
[2014-05-22 13:47:18 -0400] jpic: jonlives: thanks, i'm worried that it can cause service interruption for no reason (no cookbook update, no nothing)
[2014-05-22 13:47:40 -0400] jpic: because it might include a recipe that does a service restart
[2014-05-22 13:47:54 -0400] jonlives: jpic: right, so you make sure your recipes don't do that :p
[2014-05-22 13:48:09 -0400] jpic: ok, so i should do that manually ?
[2014-05-22 13:48:22 -0400] jonlives: jpic: at Etsy we use foodcritic rules to look for that: https://github.com/etsy/foodcritic-rules#etsy005---action-restart-sent-to-a-core-service
[2014-05-22 13:48:45 -0400] jonlives: foodcritic integrates with knife-spork, which is our workflow tool, but you could also run it in jenkins etc
[2014-05-22 13:49:23 -0400] jpic: ok, thanks !
[2014-05-22 13:49:48 -0400] jonlives: jpic: I would say it's better to make sure your recipes are safe to run (ie idempotent) rather than chef-client being scary to leave running.
[2014-05-22 13:51:07 -0400] jpic: i see, thanks for your advice
[2014-05-22 13:51:10 -0400] jonlives: np!
[2014-05-22 13:51:43 -0400] jonlives: jpic: if anecdotes help, we're running chef every 10 mins on ~1500 servers :)
[2014-05-22 13:53:06 -0400] whiteadam: dyer: Having trouble with this AWS sec viz... Any idea what version of ruby you used?
[2014-05-22 13:56:28 -0400] Neozonz: What is the easiest way to remove text from a while via chef?
[2014-05-22 13:56:48 -0400] Neozonz: looking to remove a line from /etc/hosts
[2014-05-22 13:57:00 -0400] gleam: https://github.com/someara/line-cookbook
[2014-05-22 13:59:05 -0400] Neozonz: thank you good sir
[2014-05-22 14:00:47 -0400] dadleyy: is anyone here using the IIS cookbook? I'm having trouble when creating multiple iis_site resources consecutively with application pools. It sometimes fails with "The process cannot access the file because it is being used by another process". It seems like the appcmd execution is conflicting with itself
[2014-05-22 14:01:25 -0400] dadleyy: it doesnt fail at the same place every time though which is strange
[2014-05-22 14:02:02 -0400] rayrod2030: berks api having issues again
[2014-05-22 14:02:36 -0400] dadleyy: right now my solution is to use the "retry" attribute to brute force it but has anyone else run into this issue?
[2014-05-22 14:02:47 -0400] rayrod2030: so is there a way to set a fall back depsolver endpoint in a berksfile?  Can I have api.berkshelf and my chef server as a fallback?
[2014-05-22 14:12:35 -0400] gyre007_: anyone here who is using Chef with windows ?
[2014-05-22 14:17:38 -0400] mmzyk: gyre007 I know a fair number of people here do, although I couldnt tell you which ones.
[2014-05-22 14:17:54 -0400] mmzyk: If you have a question, it might be best to ask it directly and see who can help out. :)
[2014-05-22 14:18:51 -0400] gyre007_: mmzyk: I have asked...few times :-)
[2014-05-22 14:19:08 -0400] gyre007_: but some people may have come later after I had asked...
[2014-05-22 14:19:18 -0400] mmzyk: Sorry, I must have missed it.
[2014-05-22 14:19:21 -0400] gyre007_: hence asking directly about windows as oppose to posting the same question again
[2014-05-22 14:19:39 -0400] mmzyk: Im not a windows person, but Ill do what I can to help you out.
[2014-05-22 14:19:59 -0400] gyre007_: basically the problem im dealing with is that knife ec2 create is logging to the windows box via ssh as root user and is ignoring -x switch
[2014-05-22 14:20:06 -0400] gyre007_: which makes me facepalm...
[2014-05-22 14:21:27 -0400] mmzyk: gryre007 huh. You running with any debug output to see why it might be doing that?
[2014-05-22 14:21:41 -0400] gyre007_: you mean verbose ?
[2014-05-22 14:21:43 -0400] gyre007_: yes I did
[2014-05-22 14:21:54 -0400] gyre007_: not of any help
[2014-05-22 14:21:57 -0400] mmzyk: okay.
[2014-05-22 14:22:50 -0400] mmzyk: gyre007 Has this worked before for you?
[2014-05-22 14:23:23 -0400] gyre007_: mmzyk: nope....BUT knife bootstrap ssh does
[2014-05-22 14:23:50 -0400] mmzyk: And can you post the command youre running? scrubbed of any info you dont want to share?
[2014-05-22 14:23:51 -0400] gyre007_: so when I create machine manually by clicking in the console and then do knife bootstrap it works like a charm...
[2014-05-22 14:23:56 -0400] mmzyk: And what output are you getting back when its run?
[2014-05-22 14:24:16 -0400] mmzyk: Maybe gisting these commands might be best, to be easier to read.
[2014-05-22 14:24:21 -0400] allaire: Hey guys, build-essential is never triggered, any ideas why?
[2014-05-22 14:24:23 -0400] allaire: I've set the parameter to true correctly and everything
[2014-05-22 14:24:28 -0400] gyre007_: sure..I think I already have done that...
[2014-05-22 14:24:43 -0400] gyre007_: let me check if those are still public gists
[2014-05-22 14:27:14 -0400] allaire: @coderanger are you around? I saw your name in some commits msg in the build-essential cookbook, and I think you might know the issue :)
[2014-05-22 14:27:45 -0400] mmzyk: allaire Hes on the west coast, so its a bit early for him.
[2014-05-22 14:28:48 -0400] allaire: mmzyk: Right, thanks for the heads up
[2014-05-22 14:29:32 -0400] allaire: mmzyk: Are you familiar with the cookbook?
[2014-05-22 14:29:47 -0400] allaire: I get this error when I try to install the pg cookbook: https://gist.github.com/allaire/a2ceb272460ad503c97e
[2014-05-22 14:30:07 -0400] allaire: mmzyk: but they set the config to true: https://github.com/hw-cookbooks/postgresql/blob/master/recipes/ruby.rb#L35-L37
[2014-05-22 14:30:20 -0400] mmzyk: No, Im not, but I can take a look and see if I can devine anything.
[2014-05-22 14:30:55 -0400] mmzyk: allaire so this is a postgresql cookbook? Im not clear on what the build-essential part is.
[2014-05-22 14:31:23 -0400] mmzyk: duh, its another recipe. If I would just read the cookbook myself 
[2014-05-22 14:31:32 -0400] allaire: mmzyk: Yes this is a postgresql cookbook. the build-essential part is required to install the pg gem
[2014-05-22 14:31:47 -0400] allaire: mmzyk: And I saw this commit: https://github.com/opscode-cookbooks/build-essential/commit/47c4517e95390293c1b7c3348ab4c7fc328eaea8
[2014-05-22 14:32:30 -0400] allaire: mmzyk: Anyway, build-essential is never trigered and I have to manually install the packages it installs: https://github.com/opscode-cookbooks/build-essential/blob/master/recipes/_debian.rb
[2014-05-22 14:32:48 -0400] allaire: After installing them manually, the postgresql cookbook successfully install, really weird...
[2014-05-22 14:33:52 -0400] mmzyk: allaire what parameter have you set to true?
[2014-05-22 14:34:06 -0400] allaire: mmzyk: ['build-essential']['compile_time'] = true
[2014-05-22 14:34:12 -0400] gyre007_: mmzyk: I got thsi figured out
[2014-05-22 14:34:20 -0400] gyre007_: its the same bug I opened in Jira ages ago
[2014-05-22 14:34:34 -0400] gyre007_: basicall -x USER is not overriding whatever is in your knife.rb
[2014-05-22 14:34:35 -0400] allaire: mmzyk: But I shouldn't have to anyway, since postgresql cookbook set it: https://github.com/hw-cookbooks/postgresql/blob/master/recipes/ruby.rb#L35
[2014-05-22 14:35:04 -0400] mmzyk: gyre007 Glad you figured it out. Sorry about the bug. Maybe touch it again to surface it on someones radar?
[2014-05-22 14:35:41 -0400] mmzyk: allaire So are you sure that code you highlighted is being run? Its in a rescue block that might not run if this is true: https://github.com/hw-cookbooks/postgresql/blob/master/recipes/ruby.rb#L24-L26
[2014-05-22 14:36:38 -0400] allaire: mmzyk: Yes I'm sure, cause it outputs: https://github.com/hw-cookbooks/postgresql/blob/master/recipes/ruby.rb#L69
[2014-05-22 14:36:43 -0400] allaire: when I install
[2014-05-22 14:38:19 -0400] allaire: mmzyk: and I also set the parameter to true in my role (just to be sure), and nada...
[2014-05-22 14:40:23 -0400] mmzyk: allaire Since you linked to a commit in build essential that change how a node value is set, are you sure youre running an updated version of the recipe that is going to respect that value?
[2014-05-22 14:40:31 -0400] mmzyk: Its a silly thing, but it happens.
[2014-05-22 14:40:56 -0400] mmzyk: Looks like node.set was added in v2.0 of build-essential
[2014-05-22 14:51:37 -0400] allaire: mmzyk: Back, taking a looK!
[2014-05-22 14:51:41 -0400] allaire: look*
[2014-05-22 14:52:35 -0400] sanguisdex: good day all
[2014-05-22 14:52:38 -0400] allaire: mmzyk: oh gosh: build-essential (1.4.4)
[2014-05-22 14:53:05 -0400] mmzyk: allaire Its think that might explain it.
[2014-05-22 14:53:16 -0400] mmzyk: er, *I think*
[2014-05-22 14:53:30 -0400] gyre007_: looks like knife-windows bootstrap is DIFFERENT from knife-ec2 create windows machine bootstrap....
[2014-05-22 14:53:32 -0400] gyre007_: oh boy
[2014-05-22 14:53:44 -0400] allaire: mmzyk: I don't get why it does not fetch the latest version, no cookbook set a hard dep. on v 1.x
[2014-05-22 14:54:26 -0400] mmzyk: allaire Im not sure. It could be the depsolver didnt see any reason that 1.4.4 wouldnt work, so it just went with it.
[2014-05-22 14:55:39 -0400] allaire: mmzyk: is berkshelf using depsolver too?
[2014-05-22 14:55:50 -0400] gyoza: i love lamp
[2014-05-22 14:56:51 -0400] mmzyk: allaire Yeah, what version are you on? And what server are you running?
[2014-05-22 14:57:15 -0400] mmzyk: As of bookshelf 3, OSC 11.1 and all EC version (including hosted), the depsolver is gecode across the board.
[2014-05-22 14:57:16 -0400] gyoza: anybody else hate dealing with backups?
[2014-05-22 14:57:26 -0400] gchristensen: gyoza: I think everybody doe
[2014-05-22 14:57:43 -0400] gyoza: gchristensen: hehehe
[2014-05-22 14:57:47 -0400] jblack: real men don't back up because they never make mistakes.
[2014-05-22 14:57:48 -0400] mmzyk: er, bershelf 3. bookshelf is the server cookbook store.
[2014-05-22 14:57:55 -0400] gyoza: jblack: haha
[2014-05-22 14:59:13 -0400] gyoza: coworker isnt here yet
[2014-05-22 14:59:15 -0400] gyoza: starting to worry
[2014-05-22 14:59:31 -0400] gyoza: we've moving to aws and stuff and hes like yea bro get chef going
[2014-05-22 14:59:45 -0400] gyoza: and as im learning chef hes written  bash script to bootstrap machines
[2014-05-22 14:59:48 -0400] jblack: He's right.
[2014-05-22 14:59:50 -0400] gyoza: and im like.. you know thats what chef is for right? ..
[2014-05-22 15:00:11 -0400] gyoza: whos right
[2014-05-22 15:00:30 -0400] dpetzel: anyone seen, or aware of issues with community site? Could not get http://community.opscode.com/api/v1/cookbooks/nginx/versions/2_2_0 because 502 Bad Gateway!
[2014-05-22 15:00:34 -0400] jblack: To get chef going. Not so much on the bash.
[2014-05-22 15:00:36 -0400] gyoza: danny bonaduche?
[2014-05-22 15:00:46 -0400] allaire: mmzyk: Man: Unable to find a solution for demands: build-essential (~> 2.0)
[2014-05-22 15:00:49 -0400] allaire: using berkshelf 3
[2014-05-22 15:00:49 -0400] gyoza: well yea
[2014-05-22 15:01:01 -0400] gyoza: lol
[2014-05-22 15:01:08 -0400] gyoza: I feel bad now cause he spent a lot of time on it and its hella nice
[2014-05-22 15:01:22 -0400] gyoza: im gonna integrate it somehow..
[2014-05-22 15:02:35 -0400] jblack: there's a bash resource...
[2014-05-22 15:02:58 -0400] daxroc: Can you get the result from a bash block  from the resource instance like  result = bash .. do ..      result.?
[2014-05-22 15:03:17 -0400] gyre007_: is tehre any way how I can AVOID bootstrap in knife ec2 ?
[2014-05-22 15:03:24 -0400] gyre007_: I just want to create the server...
[2014-05-22 15:03:28 -0400] gyre007_: not bootstrap it
[2014-05-22 15:05:29 -0400] gyoza: yea
[2014-05-22 15:05:31 -0400] gyoza: i think so
[2014-05-22 15:05:34 -0400] jblack: Im' sure you can find an AMI that alreayd has chef-client on it
[2014-05-22 15:06:35 -0400] jblack: you'll still have to get the validation key and client.rb on there, then you can just run chef-client
[2014-05-22 15:06:49 -0400] gyoza: hmmm
[2014-05-22 15:07:06 -0400] jblack: "just". :)
[2014-05-22 15:07:12 -0400] gyoza: thats the complete opposite of what i am doing
[2014-05-22 15:07:18 -0400] gyoza: so im thinking lol
[2014-05-22 15:07:28 -0400] jblack: Let's take a step back. what do you want to do?
[2014-05-22 15:07:34 -0400] gyoza: not me
[2014-05-22 15:07:35 -0400] gyoza: gyre
[2014-05-22 15:07:52 -0400] jblack: pardon. gyre, tell us a story about what your ideal world looks like?
[2014-05-22 15:07:57 -0400] gyoza: DOUBLE ZERO SEVEN.
[2014-05-22 15:08:27 -0400] jblack: hmmm, gyoza.. that reminds me of canned mexican food.
[2014-05-22 15:08:43 -0400] gyoza: yuck:(
[2014-05-22 15:09:20 -0400] gyre007_: basically
[2014-05-22 15:09:28 -0400] gyre007_: im trying to create and bootstrap windows node
[2014-05-22 15:09:58 -0400] gyoza: didnt you say you didnt want to bootstrap 2 minutes ago? heh
[2014-05-22 15:10:28 -0400] gyre007_: after fixing like 3 bugs in knife-windows I realized that bootstrap in knife-windows uses different codebase than bootstrap in ec2
[2014-05-22 15:10:42 -0400] gyoza: Sucks you have to deal with windows:(
[2014-05-22 15:10:48 -0400] gyre007_: I have the bootstap working in knife-windows but the knife ec2 one is crashing
[2014-05-22 15:10:55 -0400] gyre007_: oh cheers for help then :-)
[2014-05-22 15:11:07 -0400] gyoza: im not saying im not gonna try to help you:P
[2014-05-22 15:11:12 -0400] gyre007_: :-)
[2014-05-22 15:11:15 -0400] gyoza: so where does it crash?
[2014-05-22 15:11:22 -0400] gyoza: immediately?
[2014-05-22 15:11:35 -0400] r3dk1ng|2: morning all
[2014-05-22 15:11:46 -0400] gyoza: sup
[2014-05-22 15:11:51 -0400] gyre007_: https://gist.github.com/milosgajdos83/b2908e369c8d3329e6be
[2014-05-22 15:12:03 -0400] jblack: you could install ssh on your ami.. I'm working on that on a windows right now as we speek.
[2014-05-22 15:12:13 -0400] gyoza: so
[2014-05-22 15:12:16 -0400] gyre007_: but when I log on via SSH and run msiexec.exe /qn /i chefclient.msi ALL goes fine
[2014-05-22 15:12:19 -0400] gyoza: Do you have the windows installer service running?
[2014-05-22 15:12:22 -0400] gyre007_: yes
[2014-05-22 15:12:38 -0400] r3dk1ng|2: does anyone have experience using the AWS cookbook?  Basically I am in a shop where I need to convert from the right_aws gem to the new fork'd 'aws' gem.  I was wondering if anyone had experiencing doing something like this....
[2014-05-22 15:12:49 -0400] gyre007_: otherwise I couldnt get this done via ssh as I said.... msiexec.exe /qn /i chefclient.msi does the job WHEN I log on via ssh
[2014-05-22 15:12:54 -0400] gyoza: run it with logging
[2014-05-22 15:13:17 -0400] gyoza: oh you are
[2014-05-22 15:13:20 -0400] gyoza: there is nothing in the log?
[2014-05-22 15:13:20 -0400] gyre007_: ...
[2014-05-22 15:13:25 -0400] gyre007_: no
[2014-05-22 15:13:28 -0400] gyre007_: ah
[2014-05-22 15:13:55 -0400] gyoza: does it execute without the /q
[2014-05-22 15:13:58 -0400] gyre007_: when I do it via knife ec2 ? yes...very helpful: Failed to connect to server. Error: 0x8007045B
[2014-05-22 15:13:59 -0400] gyre007_: :-D
[2014-05-22 15:14:01 -0400] gyoza: (i know it will create dialog windows)
[2014-05-22 15:14:17 -0400] medya: is it possible to change the operating system of a physical node through vagrant provisioning ?
[2014-05-22 15:14:51 -0400] gyre007_: yeah
[2014-05-22 15:14:58 -0400] gyoza: 0x8007045B is a windows update error.
[2014-05-22 15:15:08 -0400] gyoza: according to the googlez
[2014-05-22 15:15:14 -0400] gyre007_: w00t ?
[2014-05-22 15:15:17 -0400] medya: gyre007 did you say yeah to me ?
[2014-05-22 15:15:19 -0400] gyoza: but probably not in that regard.
[2014-05-22 15:15:24 -0400] gyre007_: medya: no
[2014-05-22 15:15:56 -0400] medya: so does anyone know the answer?
[2014-05-22 15:16:19 -0400] mmzyk: allaire It needs to go in the cookbook metadata, the required version info: http://docs.opscode.com/essentials_cookbook_versions.html
[2014-05-22 15:16:22 -0400] gyre007_: medya: your question makes no sense....sorry ...can you ask again ?
[2014-05-22 15:16:26 -0400] allaire: mmzyk: Found it :)
[2014-05-22 15:16:26 -0400] r3dk1ng|2: medya: why do you need to do that?
[2014-05-22 15:16:37 -0400] gyoza: What version of windows gyre?
[2014-05-22 15:16:38 -0400] allaire: it works, thanks!!
[2014-05-22 15:16:47 -0400] mmzyk: allaire awesome, glad we got it sorted out.
[2014-05-22 15:16:48 -0400] medya: to automate infrastructure?
[2014-05-22 15:16:54 -0400] gyre007_: gyoza: 2008r2
[2014-05-22 15:17:35 -0400] gyoza: some stuff about corrupted WMI
[2014-05-22 15:17:50 -0400] gyoza: http://windowsandsms2003.blogspot.com/2012/06/steps-to-recreate-wmi-and-repair.html
[2014-05-22 15:17:51 -0400] gyoza: check this out
[2014-05-22 15:18:09 -0400] gyoza: could be related
[2014-05-22 15:18:12 -0400] gyoza: windows is mysterious like that
[2014-05-22 15:18:45 -0400] medya: okay here is my question reworded, I know vagrant can provision a virtualbox, or a physical node, with softwares using cookbooks, can I also provision a physical node with an operating system?
[2014-05-22 15:19:04 -0400] gyoza: yes
[2014-05-22 15:19:05 -0400] gyoza: wait
[2014-05-22 15:19:08 -0400] gyre007_: byt gyoza when I run the command manually via ssh it does go through....https://gist.github.com/milosgajdos83/ccce2861ba4f8bea446f
[2014-05-22 15:19:09 -0400] r3dk1ng|2: So medya, you have a Vagrant file with all of the stuff in it you already like, and you want to swap out the underlying OS from something to something else?  Can you give me an example of what youa re trying to do?
[2014-05-22 15:19:15 -0400] gyoza: You mean install onto a pysical node?
[2014-05-22 15:19:32 -0400] gyoza: Install OS to physical node ?
[2014-05-22 15:19:45 -0400] medya: or change the os.
[2014-05-22 15:19:50 -0400] medya: let say it already has ubuntu
[2014-05-22 15:19:53 -0400] medya: you wanna change it to redhat
[2014-05-22 15:20:00 -0400] gyoza: well
[2014-05-22 15:20:06 -0400] medya: is it possible to do that through vagrant
[2014-05-22 15:20:17 -0400] gyoza: well vagrant is for testing your cookbooks
[2014-05-22 15:20:29 -0400] gyoza: i dont know if you can use it for actual production machines
[2014-05-22 15:20:34 -0400] gyoza: unless you have everything running on virtual box?
[2014-05-22 15:20:39 -0400] gyoza: does vagrant connect to esx? i have no idea
[2014-05-22 15:20:45 -0400] gyoza: or aws?
[2014-05-22 15:20:50 -0400] medya: yeah it does connect to aws
[2014-05-22 15:20:57 -0400] gyoza: i dont see why not then
[2014-05-22 15:21:05 -0400] medya: and there is a plugin you can provision remote machines using ssh
[2014-05-22 15:21:06 -0400] medya: https://github.com/tknerr/vagrant-managed-servers
[2014-05-22 15:21:21 -0400] medya: but I cant imagnie how could it provision something withn operating system
[2014-05-22 15:21:36 -0400] gyoza: i mean as long as you make sure your cookbook retains all the needed configurations from the ubuntu server you can stand up a redhat machine with new configs for redhat
[2014-05-22 15:21:42 -0400] medya: for provisioning , there has to be a provisioner installed on the node
[2014-05-22 15:22:03 -0400] gyoza: sounds like you'd be better off using chef?
[2014-05-22 15:22:55 -0400] medya: you mean I should not use chef?
[2014-05-22 15:23:01 -0400] gyoza: no y ou should
[2014-05-22 15:23:12 -0400] medya: well I thought vagrant is part of chf
[2014-05-22 15:23:13 -0400] medya: chef
[2014-05-22 15:23:24 -0400] gyoza: kind of?
[2014-05-22 15:23:31 -0400] gyoza: I mean i use vagrant for testing only
[2014-05-22 15:23:38 -0400] gyoza: i use knife to provision servers agianst my chef server.
[2014-05-22 15:23:49 -0400] mmzyk: No, vagrant is its own thing, produced outside of chef, medya.
[2014-05-22 15:24:00 -0400] gyoza: but i am also new to this, maybe there is cool things vagrant does that makes it worthwhile
[2014-05-22 15:24:09 -0400] medya: does vagrant uses chef cookbooks to provision ?
[2014-05-22 15:24:13 -0400] gyoza: yes
[2014-05-22 15:24:17 -0400] mmzyk: Its basically a nice way to spin up vms and abstract some of the low level stuff away.
[2014-05-22 15:24:23 -0400] gyre007_: lol it's a different error this time...Windows is like playing lottery :-D
[2014-05-22 15:24:30 -0400] gyoza: medya: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-05-22 15:24:31 -0400] mmzyk: You can use chef/puppet/ansible/bash/etc to provision the vms vagrant spins up
[2014-05-22 15:24:41 -0400] gyoza: ^^ best
[2014-05-22 15:24:47 -0400] mmzyk: You see vagrant used with chef alot as a way to manage and spin up vms for testing cookbooks
[2014-05-22 15:25:01 -0400] r3dk1ng|2: Anyone using the Chef-AWS cookbook?
[2014-05-22 15:25:46 -0400] medya: I have a vertex which I can create lots of virtual machines on it, I wanna mange all of them using chef, but the first part of it, installing the operating system, has to be manual ???
[2014-05-22 15:25:57 -0400] medya: then chef can take it from there and provision it with software?
[2014-05-22 15:26:03 -0400] medya: can I automate the installing os part too?
[2014-05-22 15:26:17 -0400] mmzyk: medya You can, but chef doesnt have that tooling built in.
[2014-05-22 15:26:36 -0400] medya: what should I use
[2014-05-22 15:27:10 -0400] mmzyk: Youd need to look into options like Razor (which came out of puppet) or Foreman, or Im sure there are other options, medya
[2014-05-22 15:27:24 -0400] medya: so I could use Razor with chef?
[2014-05-22 15:27:25 -0400] gyoza: i love all the new names of stuff
[2014-05-22 15:27:25 -0400] gyoza: haha
[2014-05-22 15:27:29 -0400] mmzyk: That enable provisioning bare metal, if thats what youre looking for.
[2014-05-22 15:27:36 -0400] medya: yeah exactly
[2014-05-22 15:27:40 -0400] medya: provisioning bare metal
[2014-05-22 15:27:52 -0400] gyoza: man
[2014-05-22 15:27:53 -0400] mmzyk: medya Yeah, I believe someone made razor work with chef, but Ive never used or done it.
[2014-05-22 15:27:58 -0400] gyoza: Im so glad I dont have to deal with hardware anymoer
[2014-05-22 15:28:12 -0400] mmzyk: I know forman has recently added chef support
[2014-05-22 15:28:16 -0400] gyoza: at least in a year
[2014-05-22 15:28:23 -0400] r3dk1ng|2: Anyone using the Chef-AWS cookbook?
[2014-05-22 15:28:27 -0400] mmzyk: there was a chef conf talk on foreman and its chef support
[2014-05-22 15:28:43 -0400] mmzyk: This is my area, so I might be saying something wrong, so feel free to correct me anyone.
[2014-05-22 15:28:50 -0400] mmzyk: *isnt*
[2014-05-22 15:29:14 -0400] gyoza: same
[2014-05-22 15:29:16 -0400] medya: so forman and razor are both provisioning tools like vagrant but lower level ?
[2014-05-22 15:29:33 -0400] gyoza: vagrant is designed to run on workstations in my opinion
[2014-05-22 15:29:40 -0400] gyoza: its not an enterprise level management system
[2014-05-22 15:29:55 -0400] mmzyk: Yeah, vagrant is more for testing/develpment than prod I would say
[2014-05-22 15:30:09 -0400] mmzyk: but yeah, razor and foreman are for bare metal provisioning.
[2014-05-22 15:30:31 -0400] mmzyk: chef-metal is our answer to provisioning vms in the cloud/production systems. Its just starting development and is in the early stages.
[2014-05-22 15:30:53 -0400] gyoza: man
[2014-05-22 15:30:58 -0400] gyoza: bare metal:(
[2014-05-22 15:31:11 -0400] bdha: chef-metal is super.
[2014-05-22 15:31:25 -0400] gyoza: nice, hope i never have to use it
[2014-05-22 15:31:28 -0400] medya: can you tell me more about chef-metal ?
[2014-05-22 15:31:36 -0400] gyoza: i think google can
[2014-05-22 15:31:37 -0400] medya: should I consider that rather than razor ?
[2014-05-22 15:31:49 -0400] mmzyk: Its for vms currently medya, so if you need bare metal, chef metal wont currently work
[2014-05-22 15:31:57 -0400] jkeiser: metal will also work with razor/foreman/ipxe when drivers are written
[2014-05-22 15:32:03 -0400] jkeiser: right now it does vms, containers and cloud
[2014-05-22 15:32:08 -0400] bdha: jkeiser++
[2014-05-22 15:32:11 -0400] mmzyk: https://github.com/opscode/chef-metal
[2014-05-22 15:32:19 -0400] medya: what do you mean of containers
[2014-05-22 15:32:33 -0400] mmzyk: medya Docker, basically. :)
[2014-05-22 15:32:41 -0400] mmzyk: containters being linux containers.
[2014-05-22 15:33:10 -0400] jkeiser: both docker and lxc are supported, ya
[2014-05-22 15:33:21 -0400] jkeiser: solaris zones is another (though no driver yet)
[2014-05-22 15:34:10 -0400] medya: interesting ...
[2014-05-22 15:38:13 -0400] medya: so vagrant is only good for testing locally before you go into productions.
[2014-05-22 15:38:24 -0400] medya: how can I have multiple vagrant virtualboxes in one workstation
[2014-05-22 15:38:33 -0400] medya: when you say vagrant up
[2014-05-22 15:38:41 -0400] medya: how would it know which one it will turn on
[2014-05-22 15:38:48 -0400] whiteadam: The directory you're in
[2014-05-22 15:39:06 -0400] whiteadam: Read teh vagrantfile in that di
[2014-05-22 15:39:08 -0400] whiteadam: dir
[2014-05-22 15:39:12 -0400] whiteadam: It reads*
[2014-05-22 15:40:41 -0400] medya: so I make a diffrent vagrantfile in difffrent directories
[2014-05-22 15:40:51 -0400] medya: and go inside the directories and say vagrant up
[2014-05-22 15:40:59 -0400] whiteadam: Yeah, if you want to run multiple VMs with Vagrant
[2014-05-22 15:41:01 -0400] medya: but I believe that would make a port conflict
[2014-05-22 15:41:27 -0400] whiteadam: Ah, I see what you mean. Maybe.
[2014-05-22 15:43:44 -0400] mc_fail: hi guys, why i can't see attributes that has been wroten with node.set_unless in search results?
[2014-05-22 15:43:59 -0400] whysthatso: hey all
[2014-05-22 15:44:02 -0400] whysthatso: bootstrapping a node with "knife ec2 server create" i'm having problems with the tagging: i define 3 tags (i.e. --tags Environment=test, Role=file_server, Cname=fs.lan) but during the run only the std tags get set: (printout during knife run: Tags: Environment: test, Name: ip-10-20-10-60.aws1.lan )
[2014-05-22 15:44:06 -0400] whysthatso: my AWS api user has admin rights, so should be able to set tags and their values
[2014-05-22 15:44:08 -0400] whysthatso: am i missing something?
[2014-05-22 15:44:43 -0400] mc_fail: for example, i have a     node.set_unless['tg-flf_pubkey'] = File.read("/home/tg-flf/.ssh/id_rsa.pub")
[2014-05-22 15:44:55 -0400] gyre007_: gave up on knife ec2 and windows.......aws tools for the rescue...
[2014-05-22 15:45:01 -0400] gyre007_: been a pleasure gents
[2014-05-22 15:45:34 -0400] mc_fail: but when i'm trying to find it with search(:node, "hostname:#{pull['host']}"), i can't see it in hash
[2014-05-22 15:47:00 -0400] Neozonz: Is it possible to override a single template for a specific recipe?
[2014-05-22 15:47:17 -0400] Neozonz: ie for the /etc/hosts I want to override this template : https://github.com/aws/opsworks-cookbooks/blob/master-chef-11.4/opsworks_stack_state_sync/templates/default/hosts.erb
[2014-05-22 15:47:48 -0400] r3dk1ng|2: When will the AWS-Cookbook that replaces right_aws with aws-sdk come out?
[2014-05-22 15:52:05 -0400] jtimberman: r3dk1ng|2: no ETA. Ticket: https://tickets.opscode.com/browse/COOK-833
[2014-05-22 15:52:20 -0400] jtimberman: it's not insignificant to rewrite.
[2014-05-22 15:53:00 -0400] r3dk1ng|2: Can right_aws be simply replaced by aws?  Looks like a forked branch from right_aws
[2014-05-22 15:53:24 -0400] r3dk1ng|2: getting strage api version errors using the old right_aws library
[2014-05-22 15:54:30 -0400] FireBeyond: What are common causes of a knife error "You have not provided a valid image (AMI) value." - I'm using -I ami-23c08522 (standard ubuntu 12.04 cloud image with EBS), hard-specifying my region
[2014-05-22 15:54:44 -0400] gyoza: This is what happens when you become a chef master
[2014-05-22 15:54:45 -0400] gyoza: http://i.imgur.com/1FCppEB.gif
[2014-05-22 15:58:08 -0400] cybermer_: hi all, getting 404 errors trying to bootstrap a centos 6.5 server, appears to be unable to download Omnibus 11.14.0.alpha.1 ?
[2014-05-22 15:58:25 -0400] srenatus: Neozonz: check https://github.com/bryanwb/chef-rewind, never used it with opsworks, though
[2014-05-22 15:58:37 -0400] medya: could somone explain me how chef-metal-ssh would help me in provisioning ? is it a layer on the top of the chef-client chef-server ? or it can be used without them?
[2014-05-22 15:58:48 -0400] medya: I am reffering to this chef-metal-shh https://github.com/double-z/chef-metal-ssh
[2014-05-22 15:59:34 -0400] gyoza: cybermer_: had that same problem, remove --bootstrap-version and do --prerelease
[2014-05-22 15:59:51 -0400] gyoza: works fine
[2014-05-22 15:59:56 -0400] cybermer_: gyoza: thanks
[2014-05-22 16:00:06 -0400] gyoza: BUT
[2014-05-22 16:00:15 -0400] gyoza: people said that using --prerelease could bite you in the ass
[2014-05-22 16:00:16 -0400] gyoza: or me
[2014-05-22 16:00:21 -0400] whiteadam: it could
[2014-05-22 16:00:35 -0400] whiteadam: but maybe it will lick your ass instead
[2014-05-22 16:03:06 -0400] gyoza: hmm could
[2014-05-22 16:04:11 -0400] rayrod2030: :-o
[2014-05-22 16:04:17 -0400] rayrod2030: haha
[2014-05-22 16:04:38 -0400] GodsMadClown: Has anyone got experience overriding upstream templates in wrapper cookbooks?
[2014-05-22 16:04:45 -0400] rayrod2030: little bit
[2014-05-22 16:04:50 -0400] jkeiser: medya: as written, its primary job is to run recipes on your servers.  You don't need chef-server but it will definitely install chef-client on them
[2014-05-22 16:04:50 -0400] cybermer_: no luck using prerelease, appears to try and use the same version 11.14.0.alpha.1 version which gets a 404 error, any idea where I can get a list of valid versions ?
[2014-05-22 16:05:11 -0400] rayrod2030: godsmadclown: is the cookbook you are wrapping got hooks for introducing your own template?
[2014-05-22 16:05:25 -0400] GodsMadClown: Ruby is still to much of a black box to this Perl dude.
[2014-05-22 16:06:06 -0400] GodsMadClown: The cookbook that I'm using hasn't been updated in about 2 years.
[2014-05-22 16:06:16 -0400] a13x212: trying to override node attributes via the chef-client -j but doesn't seemt to work, http://pastebin.com/uk3hz6jj
[2014-05-22 16:06:16 -0400] rayrod2030: "The Perl Dude"
[2014-05-22 16:06:30 -0400] GodsMadClown: hehe
[2014-05-22 16:06:41 -0400] jamesf_: GodsMadClown: that means it should be super safe then if it was perfected 2 years ago
[2014-05-22 16:07:09 -0400] GodsMadClown: Not realy.  There are year old pull requests on it.  :-)
[2014-05-22 16:07:49 -0400] medya: @jkeiser so you mean it is like a chef-client for my chef-server ? or for any other server?
[2014-05-22 16:08:18 -0400] rayrod2030: you should walk around in a robe
[2014-05-22 16:08:34 -0400] Neozonz: srenatus, well I could just create a replica of the template and it would override it, but the only issue is if i do this it would apply for all instances that reference my cookbooks... would rather limit to a recipe if possible
[2014-05-22 16:09:05 -0400] jkeiser: medya: chef-metal's job, in general, is to let you write down your infrastructure in code. A recipe that has your list of machines in it, and their configuration (like run lists).  chef-metal-ssh is a driver that hooks one of those recipes up to your bare metal, ssh-capable machines.
[2014-05-22 16:09:05 -0400] GodsMadClown: Fat chance.  I get weird looks for wearing t-shirts at work.
[2014-05-22 16:09:23 -0400] Neozonz: https://github.com/aws/opsworks-cookbooks/issues/51  looks like this would override the /etc/hosts file
[2014-05-22 16:09:35 -0400] Neozonz: but... no idea how to do this for a specific recipe if possible
[2014-05-22 16:10:16 -0400] jkeiser: medya: it relates tangentially to chef servers. Its primary purpose is about describing the set of machines you need to provision a given cluster, so that you can version that description in source control, and so that you can reuse it to create not only production, but test, dev and staging environments, all using the same Metal recipe
[2014-05-22 16:11:06 -0400] jkeiser: medya: you can hook it up to a chef server if you want. You can use it to describe and deploy a new chef server if you want, as long as you have cookbooks that can do that. You can cut the chef server out of the loop entirely if you want, with local mode.
[2014-05-22 16:13:01 -0400] GodsMadClown: I'm getting a bunch of this when I try to override an upstream template.  Cannot find a resource matching template[/usr/local/tomcat/default/conf/server.xml] (did you define it first?)
[2014-05-22 16:13:08 -0400] jkeiser: medya: this blog post has a decent explanation of chef-metal's whys and wherefores.
[2014-05-22 16:13:14 -0400] jkeiser: medya: http://www.getchef.com/blog/2014/03/04/chef-metal-0-2-release/
[2014-05-22 16:17:17 -0400] StFS: Hi. I can't seem to find a good tutorial on how I should go about setting my nodes up such that they run chef-client regularly. When I bootstrap the node chef gets installed but chef-client is only run once. Is the idea that you should create a recipe that specifies that chef-client should be run (as a service/cron/daemon) and that added to the node after
[2014-05-22 16:17:18 -0400] StFS: it's been bootstrapped?
[2014-05-22 16:18:43 -0400] davidordave: @StFS, I think the accepted practice is to use the chef-client cookbook
[2014-05-22 16:18:58 -0400] StFS: allright... thought as much :)
[2014-05-22 16:19:02 -0400] StFS: thanks
[2014-05-22 16:23:43 -0400] GodsMadClown: rayrod2030: How would I know if it has these hooks that you speak of?
[2014-05-22 16:25:01 -0400] medya: thanks jkeiser
[2014-05-22 16:32:06 -0400] rayrod2030: godsmadclown: they will look something like this: https://github.com/lusis/chef-logstash/blob/master/recipes/server.rb#L133
[2014-05-22 16:32:33 -0400] rayrod2030: see how the template source and cookbook values are set from an attribute?
[2014-05-22 16:32:46 -0400] rayrod2030: that's a hook for you to introduce your own template through a wrapper cookbook
[2014-05-22 16:33:56 -0400] rayrod2030: This article has some other examples as well: http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-05-22 16:34:12 -0400] rayrod2030: including doing stuff with resources
[2014-05-22 16:34:30 -0400] rayrod2030: also chef-rewind.
[2014-05-22 16:38:15 -0400] GodsMadClown: rayrod2030: I don't have that.  I wish that I did.  I've got this:  https://github.com/bryanwb/chef-tomcat/blob/master/providers/default.rb#L105
[2014-05-22 16:38:51 -0400] GodsMadClown: I tried rewind.  I tried that wrapper cookbooks right thing too.
[2014-05-22 16:38:58 -0400] sanguisdex: I am seeing cron functions and a cron cookbook (with no documentation) is there a best practice here?
[2014-05-22 16:40:05 -0400] rayrod2030: is that the official tomcat community cookbook?
[2014-05-22 16:40:23 -0400] rayrod2030: https://github.com/opscode-cookbooks/tomcat
[2014-05-22 16:40:32 -0400] rayrod2030: any reason why you aren't using that tomcat cookbook?
[2014-05-22 16:40:52 -0400] GodsMadClown: Because I couldn't get it to work with tomcat7 on centos
[2014-05-22 16:41:17 -0400] rayrod2030: was it an epel thing?
[2014-05-22 16:41:42 -0400] GodsMadClown: Because it wants to use packages to install it.  I don't want to do that.  I want to poiint it at a vanilla apache release and install from there.
[2014-05-22 16:41:55 -0400] GodsMadClown: Yes,There was also an EPEL thing.
[2014-05-22 16:42:28 -0400] GodsMadClown: the opscode cookbook was looking for a package named tomcat7 and EPEL had it as tomcat
[2014-05-22 16:43:39 -0400] GodsMadClown: Fuck Redhat and thier bizarrely archaic package ecosystem
[2014-05-22 16:45:49 -0400] a13x212: how do i override a attribute with chef-client?
[2014-05-22 16:48:42 -0400] GodsMadClown: a13x212: chef-client -j attributes.json has worked for me in the past.
[2014-05-22 16:49:35 -0400] a13x212: i tried http://pastebin.com/uk3hz6jj but didn't work
[2014-05-22 16:49:58 -0400] brandonsiegel: Anyone else here seeing 502s trying to fetch cookbooks from community.opscode.com ? Has been happening for me on multiple machines the past couple of days.
[2014-05-22 16:50:07 -0400] GodsMadClown: rayrod2030:  Maybe I just need to do some more inpection of the resource structure in the chef run.
[2014-05-22 16:50:25 -0400] rayrod2030: yeah that looks to be your best bet
[2014-05-22 16:50:29 -0400] dyer: whiteadam - no, I dont remember, been a while. Pretty sure it was an old one
[2014-05-22 16:50:55 -0400] rayrod2030: I'd bring up your centos tomcat7 package issue with someara if you can.  Probably as a cook ticket
[2014-05-22 16:51:17 -0400] rayrod2030: or whoever is maintaining that cb
[2014-05-22 16:52:24 -0400] rayrod2030: sweet jesus berkshelf api is being a fucking jerk today
[2014-05-22 16:52:44 -0400] GodsMadClown: I'd be happy to.  How do I find out where the bug repo for the opscode cookbook is?
[2014-05-22 16:53:19 -0400] rayrod2030: https://github.com/opscode-cookbooks/tomcat/blob/master/CONTRIBUTING
[2014-05-22 16:54:05 -0400] GodsMadClown: a13x212: It' less complicated that. --json-attributes '{ "attribute" : { "key" : "value" } }'
[2014-05-22 16:54:10 -0400] rayrod2030: https://tickets.opscode.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+COOK+AND+resolution+%3D+Unresolved+AND+component+%3D+tomcat+ORDER+BY+priority+DESC&mode=hide
[2014-05-22 16:55:36 -0400] Neozonz: srenatus, just an update it worked perfectly :0
[2014-05-22 16:55:59 -0400] Neozonz: Anyone know how to add a variables attribute to the ruby block here >> http://syshero.org/post/67727745605/override-templates-from-third-party-cookbooks-on-chef
[2014-05-22 16:56:42 -0400] Neozonz: would it just be t.variables =  "variables(:opsworks => node[:opsworks])
[2014-05-22 16:56:43 -0400] Neozonz: "
[2014-05-22 16:57:38 -0400] sanguisdex: if I am logged into a node, what is the best way to find out the nodes name?
[2014-05-22 16:58:28 -0400] r3dk1ng|2: hostname
[2014-05-22 16:59:08 -0400] sanguisdex: r3dk1ng|2: thanks
[2014-05-22 17:01:35 -0400] GodsMadClown: rayrod2030: https://tickets.opscode.com/browse/COOK-4467?focusedCommentId=49895&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-49895
[2014-05-22 17:01:53 -0400] GodsMadClown: We'll see if it gets any eyes. <shrug>
[2014-05-22 17:02:49 -0400] rayrod2030: It's just a surprising issue because the kitchen file specifically tests against centos6+ and tomcat 7 so I'm confused.
[2014-05-22 17:03:02 -0400] phutchin1: Anyone seen this? (/var/chef/cache/cookbooks/tar/providers/extract.rb line 37) had an error: Net::HTTPServerException: 404 "Domain not served here"
[2014-05-22 17:03:15 -0400] phutchin1: I can get the file manually with wget... not sure why chef's not able to get the file
[2014-05-22 17:03:24 -0400] phutchin1: and not seen domain not served here error before
[2014-05-22 17:04:17 -0400] rayrod2030: what's a good way to set an environment variable for a jenkins user?
[2014-05-22 17:05:07 -0400] phutchin1: rayrod2030: isn't that more of a jenkins type question?
[2014-05-22 17:05:20 -0400] rayrod2030: phutchin1: I meant through chef
[2014-05-22 17:05:38 -0400] phutchin1: well where do you want the variable to be set? setting it through chef should be easy once you determine that
[2014-05-22 17:05:45 -0400] rayrod2030: for the jenkins user
[2014-05-22 17:06:05 -0400] phutchin1: in .bashrc?
[2014-05-22 17:06:39 -0400] phutchin1: you need to find out what shell the jenkins user is using, then say, if its bash, add the variable to the .bashrc file (depending on if its a login shell or not)
[2014-05-22 17:07:17 -0400] phutchin1: so if thats the case you could just create a chef templaet (.erb) in templates/default for your bashrc file and fill it out with your desired variable for that ENV variable
[2014-05-22 17:07:42 -0400] rayrod2030: yup sounds about right.  thanks.
[2014-05-22 17:07:49 -0400] phutchin1: np
[2014-05-22 17:19:04 -0400] phutchin1: Nobody seen "domain not served here" with remove_file?
[2014-05-22 17:19:54 -0400] r3dk1ng|2: phutchin1: where are you seeing that error?
[2014-05-22 17:52:09 -0400] pedahzur: Somewhat of a newbie question, but I can't seem to get this to work. In the Java recipe, the attributes.rb file has this line: default["java"]["install_flavor"] = "openjdk"  I've tried overriding it a couple different ways, but it hasn't seem to stick.  Right now, in my JSON file I have: "override_attributes": { "java" : { "install_flavor" : "ibm" } } but it still seems to be using the default (openjdk) recipe.  I've tried looking up the
[2014-05-22 17:52:10 -0400] pedahzur: docs, but it doesn't seem clean *how* to override attributes, or where in the "node" object the default attributes live.  Help?
[2014-05-22 17:52:14 -0400] BrianJ: How can I view a node's attributes from within a recipe?
[2014-05-22 17:52:31 -0400] BrianJ: Chef::Log node?
[2014-05-22 17:54:37 -0400] sanguisdex: how can I set the machines IP as template variable?
[2014-05-22 17:55:10 -0400] sanguisdex: s/machines/node's/
[2014-05-22 17:55:12 -0400] shlant: BrianJ: yea, just use the log resource
[2014-05-22 17:55:33 -0400] mattupstate: sanguisdex: you don't have to, you can access node attributes in a template
[2014-05-22 17:55:52 -0400] shlant: sanguisdex: do you want to set the ip or acces it?
[2014-05-22 17:56:08 -0400] shlant: node['ipaddress'] to access
[2014-05-22 17:56:15 -0400] mattupstate: <%= node['ipaddress'] %>
[2014-05-22 17:56:23 -0400] shlant: in template ^
[2014-05-22 17:56:43 -0400] phutchin1: r3dk1ng|2: I'm trying to get a file with tar_extract resource which is then calling remote_file to get the file before extract. The chef run fails and I get a Net::HTTPServerException: 404 "domain not served here"
[2014-05-22 17:56:54 -0400] sanguisdex: thanks mattupstate and shlant
[2014-05-22 17:58:11 -0400] shlant: pedahzur: when you say JSON file, what are you referring to? a role?
[2014-05-22 17:58:23 -0400] pedahzur: shlant: Sorry...a solo file.
[2014-05-22 17:58:36 -0400] pedahzur: shlant: Wasn't it obvious? :)
[2014-05-22 17:59:04 -0400] shlant: pedahzur: so your specifying a solo.json when running chef?
[2014-05-22 18:00:30 -0400] pedahzur: shlant: Yes. I initially tried overriding it in the role first, but that didn't work, so I was trying to override it in the solo file.  If you have an example or doc on overriding something of the form default["java"]["install_flavor"] = "openjdk" in the role or solo file, I'm a happy camper.  It just wasn't working like my previous understanding had lead me to believe.
[2014-05-22 18:02:04 -0400] shlant: pedahzur: what OS?
[2014-05-22 18:02:17 -0400] pedahzur: shlant: linux.  RHEL 6.5 PPC, if it matters. :)
[2014-05-22 18:02:53 -0400] pedahzur: shlant: Thus the reason in this case to extend and override the Java defaults, since openjdk isn't available on PPC (EPEL doesn't compile for PPC).
[2014-05-22 18:06:25 -0400] whiteadam: mmm, ppc
[2014-05-22 18:06:40 -0400] shlant: pedahzur: I think you need to set ["java"]["ibm"]["accept_ibm_download_terms"] = true, ["java"]["ibm"]["url"] and  ["java"]["ibm"]["checksum"] if you are using that flavor
[2014-05-22 18:07:27 -0400] prometheanfire: can you submit node data BEFORE the convergance is complete (kinda like an ohai reload)?
[2014-05-22 18:08:00 -0400] shlant: pedahzur: see README https://github.com/socrata-cookbooks/java/blob/master/README.md
[2014-05-22 18:08:16 -0400] shlant: To install IBM flavored Java Example
[2014-05-22 18:08:21 -0400] prometheanfire: I'm having problems with search returning empty results for because nodes pre-bootstrap are returned in search data
[2014-05-22 18:10:04 -0400] pedahzur: shlant: No, if I directly set default["java"]["install_flavor"] = "ibm" it uses my new java::ibm recipe and installs fine (from the Redhat RPM).  So that's not the issue. It's that when I've tried to override it with a stock attributes/default.rb file, it still tries to install openjdk and fails...I'm trying to figure out how to override default["java"]["install_flavor"]. I've already proven the recipe works. :)
[2014-05-22 18:11:09 -0400] shlant: prometheanfire: I don't think node data is available until after first run
[2014-05-22 18:11:30 -0400] prometheanfire: ya, I've noticed :P
[2014-05-22 18:12:01 -0400] shlant: pedahzur: so you have a custom java wrapper cookbook that works?
[2014-05-22 18:12:13 -0400] prometheanfire: it breaks first runs for me.    Right now I have to wait for it to fail, submit the node data, then rerun and have it succeed
[2014-05-22 18:12:18 -0400] prometheanfire: not very nice :P
[2014-05-22 18:12:45 -0400] pedahzur: shlant: Yes.  java::ibm just sets the package names to ["java-1.6.0-ibm","java-1.6.0-ibm-devel"] similar to how the others do it.
[2014-05-22 18:12:56 -0400] whiteadam: dyer: I got it to work with just the json export. I guess the CLI piece is broken.
[2014-05-22 18:22:03 -0400] shlant: pedahzur: and you have tried using something like default.force['java']['install_flavor'] = 'ibm' in your wrappers attributes?
[2014-05-22 18:22:30 -0400] pedahzur: shlant: You're saying that would go in my role?
[2014-05-22 18:22:54 -0400] shlant: pedahzur: in your wrapper cookbook attribute file. attributes/default.rb
[2014-05-22 18:29:17 -0400] pedahzur: shlant: Sorry, it's not a wrapper cookbook. I just added java::ibm to the java recipe.  I'm trying to find a way of overriding the java recipe's attributes/default.rb file.
[2014-05-22 18:30:19 -0400] shlant: pedahzur: and you are running this with a role?
[2014-05-22 18:30:55 -0400] pedahzur: It's actually getting included by another recipe (a Jenkins recipe), but yes, it is invoked from a solo file, which has a role in its run list.
[2014-05-22 18:31:38 -0400] shlant: can you share the role?
[2014-05-22 18:40:50 -0400] atomic-penguin: Trying to roll an omnibus package, so I looked at omnibus-chef for an example.  What is 'preparation'?
[2014-05-22 18:43:37 -0400] pcn: sounds pharmacy-like
[2014-05-22 18:43:38 -0400] mmzyk: atomic-penguin Where are you seeing that?
[2014-05-22 18:43:55 -0400] atomic-penguin: when I do an omnibus build
[2014-05-22 18:44:10 -0400] atomic-penguin: its a dependency in each component
[2014-05-22 18:46:20 -0400] mmzyk: Im actually not sure.
[2014-05-22 18:46:52 -0400] jpic: hi all, i don't understand why berks upload fails to connect to the chef server wheras knife has no problem: http://dpaste.com/1W5NDTN/
[2014-05-22 18:47:36 -0400] mmzyk: atomic-penguin I found it.
[2014-05-22 18:48:18 -0400] mmzyk: So omnibus, which is located in the omnibus-ruby repo, uses the omnibus-software repo, which defines a lot of common software definitions for use in omnibus builds.
[2014-05-22 18:48:32 -0400] mmzyk: preparation is one of those and can be found in the omnibus-software repo here: https://github.com/opscode/omnibus-software/blob/master/config/software/preparation.rb
[2014-05-22 18:48:46 -0400] mmzyk: omnibus pulls in the omnibus-software repo automatically.
[2014-05-22 18:50:21 -0400] pedahzur: shlant: I can, but it doesn't have anything in it referencing the java recipe at this point (took it out, because it wasn't working).  Isn't there a simple, easy-to-communicate way (or documentation) saying "This is how to override a value in a recipe's attributes/default.rb?
[2014-05-22 18:51:27 -0400] shlant: pedahzur: there are many places where you can set attributes: http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2014-05-22 18:52:44 -0400] pedahzur: shlant: I understand that, but what is the syntax for the line I would put in the role to override the value of default["java"]["install_flavor"] found in a recipe's attributes/default.rb file?
[2014-05-22 18:57:52 -0400] shlant: pedahzur: if its a JSON role then it would be
[2014-05-22 18:57:53 -0400] shlant:   default_attributes": {
[2014-05-22 18:57:53 -0400] shlant:     java": {
[2014-05-22 18:57:54 -0400] shlant:       install_flavor": ibm"
[2014-05-22 18:57:55 -0400] shlant:     }
[2014-05-22 18:57:55 -0400] shlant:   },
[2014-05-22 18:58:18 -0400] shlant: you don't need to override in the role because it takes precedence over attribute files anyway
[2014-05-22 18:59:03 -0400] shlant: remove that last comma if it's the last entry
[2014-05-22 19:02:47 -0400] pedahzur: shlant: I actually do (eventually) want to override in the role, because then I can test for things like arch == PPC (not sure of that syntax yet) which is what I would need to do so we install the right package on our PPC nodes.
[2014-05-22 19:04:45 -0400] rhys: does anyone know where the list of opscode maintained platforms are for test-kitchen?
[2014-05-22 19:04:47 -0400] shlant: pedahzur: no i mean you don't need to use override_attributes, just default_attributes due to precedence. It will still "override" or "overwrite" the java attribute
[2014-05-22 19:05:05 -0400] pedahzur: Ah, gotcha.
[2014-05-22 19:05:11 -0400] shlant: yea it's confusing wording haah
[2014-05-22 19:06:07 -0400] pedahzur: shlant: Hmm...this line in my solo file: "default_attributes": { "java" : { "install_flavor" : "ibm" } } doesn't seem to be taking effect.  Still trying to install openjdk.
[2014-05-22 19:10:20 -0400] scott2449: Having windows chef issue, we already have depends windows in metadata and ran chef cookbook site install windows and the cookbooks are there and all looks well but getting the following: FATAL: NoMethodError: No resource or method named `w indows_zipfile' for `Chef::Recipe "default"' Ideas? I am experienced with chef on linux but first time windows
[2014-05-22 19:12:19 -0400] shlant: scott2449: there is a space in 'w indows_zipfile'?
[2014-05-22 19:12:55 -0400] scott2449: just a chat issue, went from cmd to gmail to irc =D
[2014-05-22 19:13:11 -0400] shlant: pedahzur: I've never actually used solo.json. Can you try putting that code directly in the role and seeing if it works? just for troubleshooting
[2014-05-22 19:13:22 -0400] pedahzur: shlant:
[2014-05-22 19:13:26 -0400] pedahzur: shlant: sure
[2014-05-22 19:14:22 -0400] shlant: scott2449: do you have the full chef error?
[2014-05-22 19:14:28 -0400] shlant: need context
[2014-05-22 19:16:49 -0400] scott2449: yes here is the whole output
[2014-05-22 19:16:50 -0400] scott2449: https://gist.github.com/scott2449/3346b201000de3a0b98d
[2014-05-22 19:17:16 -0400] martinisoft: Anyone have some experience making organization-wide spork configurations that work with Berkshelf?
[2014-05-22 19:17:29 -0400] pedahzur: shlant: Thank you! This worked in the role (compressed to one line): default_attributes "java" => {"install_flavor" => "ibm"}  Mental note for the future: if attributes/default.rb sets something like default['something'] then "something" is your first hash key for default_attributes in the role.Thank you very much!
[2014-05-22 19:18:24 -0400] scott2449: maybe because we are executing a recipe directly?
[2014-05-22 19:19:07 -0400] jpic: hi all, is berks able to install dependencies from cookbooks/*/metadata.rb and cookbooks/*/Gemfile ?
[2014-05-22 19:19:52 -0400] scott2449: @shlant ideas?
[2014-05-22 19:19:53 -0400] shlant: scott2449: can you try putting include_recipe "windows" in the groupmanager recipe?
[2014-05-22 19:20:54 -0400] scott2449: We tried both with and without, same result
[2014-05-22 19:21:43 -0400] scott2449: we are executing with solo: chef-solo -c solo.rb -o recipe[groupmanager::default]
[2014-05-22 19:22:58 -0400] sanguisdex: so test kitchen is like awesome!
[2014-05-22 19:23:10 -0400] sanguisdex: just had to say it
[2014-05-22 19:23:31 -0400] shlant: sanguisdex: let them know over at #kitchen-ci :)
[2014-05-22 19:23:42 -0400] shlant: nopde
[2014-05-22 19:24:01 -0400] sanguisdex: shlant: noted!
[2014-05-22 19:24:03 -0400] shlant: #kitchenci
[2014-05-22 19:25:21 -0400] shlant: scott2449: can you try running solo on a new instance?
[2014-05-22 19:25:46 -0400] shlant: knife-solo
[2014-05-22 19:26:19 -0400] shlant: knife solo bootstrap
[2014-05-22 19:28:10 -0400] scott2449: we are just trying on the local workstation to get the most basic stuff running before we even go through the effort of provisioning or creating vm
[2014-05-22 19:39:40 -0400] bricker: spheromak: ping :)
[2014-05-22 19:48:45 -0400] jeitnier: does anyone know whats going on with the berkshelf API?
[2014-05-22 19:49:27 -0400] tier: looks to be ok... https://api.berkshelf.com/status
[2014-05-22 19:49:52 -0400] jeitnier: im getting Error retrieving universe from source: https://api.berkshelf.com
[2014-05-22 19:49:53 -0400] jeitnier:   * [Berkshelf::APIClient::ServiceUnavaiable] service unavailable at: https://api.berkshelf.com
[2014-05-22 19:50:18 -0400] jeitnier: with a normal vagrant environment
[2014-05-22 19:52:31 -0400] mmzyk: jeitnier Its reporting its okay http://api.berkshelf.com/status
[2014-05-22 19:53:03 -0400] jeitnier: ill try again
[2014-05-22 19:53:26 -0400] jeitnier: yeah its ok now, thx
[2014-05-22 19:56:40 -0400] r3dk1ng|2: is it possible to assign a custom attribute to a node directly?  without having to have a recipe?
[2014-05-22 19:56:56 -0400] r3dk1ng|2: For the sake of testing something
[2014-05-22 19:57:40 -0400] mmzyk: r3dk1ng|2 knife node edit I believe does the trick.
[2014-05-22 19:57:50 -0400] r3dk1ng|2: excellent
[2014-05-22 19:58:01 -0400] r3dk1ng|2: duh I knew that, I just forgot
[2014-05-22 19:59:24 -0400] bricker: knowing is half the battle
[2014-05-22 19:59:29 -0400] bricker: not forgetting is the other half
[2014-05-22 20:00:24 -0400] Evangael: I'm quite sure there's a third half too!
[2014-05-22 20:04:43 -0400] r3dk1ng|2: so I have a test node, that I do not want to assign to an existing env.  I have a particular data bag that is called from a recipe that applies attributes to nodes that get assigned to the enviornment.  However with the test node, I want to assign different attributes to it that are somewhat similar to the data bag entries, how can I do this without having to create new databags or assign a recipe
[2014-05-22 20:07:49 -0400] spheromak: bricker: hi
[2014-05-22 20:08:01 -0400] bricker: r3dk1ng|2: on the node you set override attributes
[2014-05-22 20:08:09 -0400] bricker: spheromak: ahhh, my resisdent DHCP expert :)
[2014-05-22 20:08:17 -0400] bricker: resident*
[2014-05-22 20:08:22 -0400] r3dk1ng|2: How?  Where do they go?
[2014-05-22 20:08:26 -0400] spheromak: negative, I am no expert I just read some man pages
[2014-05-22 20:08:41 -0400] bricker: spheromak: well you've certainly used it more than I have
[2014-05-22 20:08:45 -0400] spheromak: :P
[2014-05-22 20:09:15 -0400] praste: : I am unable to add comment on "http://community.opscode.com/cookbooks/java/comments"
[2014-05-22 20:09:30 -0400] bricker: r3dk1ng|2: add an "override" object to your attributes
[2014-05-22 20:09:38 -0400] praste: I keep getting error. Looks like I am getting 302 back
[2014-05-22 20:09:51 -0400] praste: where should I report this
[2014-05-22 20:10:08 -0400] bricker: spheromak: by the way I have DHCP all setup and dynamically assigning IPs now, it's beautiful, so thank you for your help before
[2014-05-22 20:10:39 -0400] praste: how can I install multiple JDK versions (flavor = oracle) on the target machine using java cookbook?
[2014-05-22 20:10:56 -0400] spheromak: bricker: awesome .. it is great when it works!
[2014-05-22 20:11:45 -0400] bricker: spheromak: I now have a bunch of apps pointing to internal services (database, cache, etc) via those dynamically-assigned private IPs. For these services, if I were to create a new VM/node to replace the old one, the IP would change as well. How do you overcome this? I know I can add a host entry but I wonder if I shouldn't be using the dynamic IPs at all.
[2014-05-22 20:11:59 -0400] spheromak: service discovery
[2014-05-22 20:12:11 -0400] spheromak: load balancers
[2014-05-22 20:12:21 -0400] spheromak: keepalived..
[2014-05-22 20:12:30 -0400] anthonyacquanita: silly ?:  Am I supposed to put knife plugins in /opt/chef/embedded along with knife?
[2014-05-22 20:12:34 -0400] spheromak: another way thats the most easy way is using CNAMES
[2014-05-22 20:12:44 -0400] bricker: spheromak: ah-hah
[2014-05-22 20:12:52 -0400] spheromak: but that is brittle
[2014-05-22 20:12:54 -0400] spheromak: ;)
[2014-05-22 20:13:01 -0400] spheromak: so when you migrate you will have to update the CNAME
[2014-05-22 20:13:18 -0400] spheromak: service discovery using ZK/etcd/consul  is the 'better' way IMO
[2014-05-22 20:13:36 -0400] spheromak: but depending on your scale/freequency of change in that realm it could be overkill
[2014-05-22 20:14:00 -0400] spheromak: bricker: I really wanted to build a lwrp for nsupdate. So you could code some of this into cooks
[2014-05-22 20:14:16 -0400] spheromak: for the simple case using SRV/CNAME/HINFO dns records
[2014-05-22 20:14:27 -0400] bricker: hmmmm
[2014-05-22 20:14:32 -0400] bricker: *strokes beard*
[2014-05-22 20:14:46 -0400] spheromak: ya lotsa ways to slice it
[2014-05-22 20:15:15 -0400] spheromak: I wrot the jn_services gem to manage service discovery/registration with an etcd backend.
[2014-05-22 20:15:39 -0400] spheromak: bricker: https://github.com/spheromak/services
[2014-05-22 20:15:46 -0400] spheromak: but again might be overkill
[2014-05-22 20:15:53 -0400] bricker: spheromak: I do like the hostname idea
[2014-05-22 20:16:15 -0400] spheromak: cname
[2014-05-22 20:16:19 -0400] bricker: spheromak: My only concern really is that 10+ apps will be using these private IPs, so I don't want to update them if I have to replace a node
[2014-05-22 20:16:22 -0400] bricker: spheromak: right
[2014-05-22 20:16:29 -0400] spheromak: LB
[2014-05-22 20:16:32 -0400] spheromak: ?
[2014-05-22 20:16:47 -0400] bricker: spheromak: so I'm not worried if I have to go in and change the CNAME record every once in a while
[2014-05-22 20:16:52 -0400] spheromak: oh yea cnames for sure, for the service
[2014-05-22 20:16:53 -0400] bricker: spheromak: LB is a possibility too
[2014-05-22 20:17:32 -0400] spheromak: should do that anyways, as cnames generally aren't cached.  so for flipping things around its the best way  (assuming you are using names which you should IMO)
[2014-05-22 20:17:45 -0400] jpic: hi all, i don't understand vagrant-chef-zero: i have installed the plugin but it crashes : http://dpaste.com/3GDJPQ1/
[2014-05-22 20:23:46 -0400] storme_away: question, i'm customizing a variant of nagios::default in my own cookbook, and one of the template files calls ip_to_monitor(n) which is a library function in the nagios cookbook. if my cookbook depends on nagios, will that be pulled in, or do i need to namespace it somehow or manually include the library?
[2014-05-22 20:23:52 -0400] jpic: also: is it ok to have a Berksfile in a chef-repo or was that made specifically for cookbooks ?
[2014-05-22 20:24:23 -0400] jpic: ie. i have a repo that has roles which rely on external cookbooks, should i have them in my chef-repo Berksfile or is there another way ?
[2014-05-22 20:25:32 -0400] ianblenke: jpic: typically, that's what a cookbook's metadata.rb depends are for.
[2014-05-22 20:32:13 -0400] jpic: i understand, but what if a role i define depends on a cookbook ? where should i declare it ?
[2014-05-22 20:34:33 -0400] jpic: i think it's a bit of a waste to add a submodule for each cookbook
[2014-05-22 20:35:08 -0400] cheeseplus: jpic: put it in the Berksfile
[2014-05-22 20:35:30 -0400] jpic: ok, so it's ok to have a Berksfile in a chef-repo, thanks
[2014-05-22 20:35:36 -0400] cheeseplus: berks can use your metadata.rb or explicit definitions
[2014-05-22 20:35:56 -0400] cheeseplus: jpic: well you can but if you're using berks the model changes a little
[2014-05-22 20:42:48 -0400] vigith: what is the best way to enable logrotate for /var/log/chef-server/nginx/ .. i want to keep logs for 30 days
[2014-05-22 20:43:00 -0400] jpic: cheeseplus: right, that means i'm going to have to install them on the server too, probably not the best idea, thanks
[2014-05-22 20:44:05 -0400] cheeseplus: jpic: exactly - it'll get weird to manage
[2014-05-22 20:44:23 -0400] cheeseplus: was living in that situation a bit ago and it's best to just go full in on one method
[2014-05-22 20:45:35 -0400] vigith: is it enough to drop a file in logrotate.d with a postrotate script (with pid file set to /opt/chef-server/sv/nginx/supervise/pid)?
[2014-05-22 21:00:07 -0400] medya: when you download a cookbook from the community site, are you typically supposed to and advised to change the recepies ? like change username/password and then upload it back to your own chef server  ? what is the common practice
[2014-05-22 21:00:19 -0400] coderanger: medya: No, make a wrapper cookbook
[2014-05-22 21:00:27 -0400] medya: what is a wrapper cookbook
[2014-05-22 21:00:35 -0400] medya: and how does that work
[2014-05-22 21:00:49 -0400] coderanger: medya: Make a new cookbook that depends on the community one (usually named companyname-cookbookname)
[2014-05-22 21:00:56 -0400] coderanger: and then in that set the overrides you want
[2014-05-22 21:01:09 -0400] medya: oh is there any example that I can look at it?
[2014-05-22 21:01:42 -0400] coderanger: medya: Which community cookbook are you trying to use?
[2014-05-22 21:01:51 -0400] behemphi: Hey @medya http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-05-22 21:02:18 -0400] medya: Thanks a lot !
[2014-05-22 21:02:31 -0400] medya: coderanger I was trying to use jBoss
[2014-05-22 21:02:46 -0400] coderanger: medya: Then yeah, all you should need is attribute overrides hopefully
[2014-05-22 21:02:47 -0400] behemphi: If you are using Berkshelf, then berkshelf.com is a good resource to learn about it as well
[2014-05-22 21:03:07 -0400] coderanger: medya: The quality of "reusable cookbooks" is veeeeeeery varying though
[2014-05-22 21:03:09 -0400] behemphi: and Berkshelf itself is a great way to manage the community cookbooks as dependencies
[2014-05-22 21:03:09 -0400] coderanger: so caveat emptor
[2014-05-22 21:04:00 -0400] behemphi: what @coderanger said is very true, always read the cookbook for two reasons
[2014-05-22 21:04:06 -0400] medya: #coderanger how would using berkshelf affect it ?
[2014-05-22 21:04:08 -0400] behemphi: so you know what it does
[2014-05-22 21:04:19 -0400] coderanger: medya: Yes, it makes it much easier :)
[2014-05-22 21:04:20 -0400] behemphi: and so you learn what to change in the wrapper cookbook
[2014-05-22 21:04:44 -0400] coderanger: behemphi: with berkshelf you no longer need to worry directly about the upstream cookbook, just list it as a dependency and you're done
[2014-05-22 21:04:53 -0400] coderanger: er medya ^^
[2014-05-22 21:04:55 -0400] medya: does berkshelf help me to know what to change in the wrapper cookbook ? I thought it only manages the dependecie, and downloads the dependency cookbooks
[2014-05-22 21:05:10 -0400] behemphi: @coderanger true but that does not obviate you quality concern.
[2014-05-22 21:05:20 -0400] behemphi: it still makes sense to learn what the cookbook is doing yes?
[2014-05-22 21:05:22 -0400] coderanger: medya: No, it doesn't help with the wrapper specifically, just deals with pulling in the community cookbook code itself
[2014-05-22 21:05:33 -0400] medya: gotcha
[2014-05-22 21:05:34 -0400] coderanger: Yeah, you still should read it like you would any library you are about to use
[2014-05-22 21:05:37 -0400] behemphi: and good to "see" you again.
[2014-05-22 21:05:37 -0400] medya: Thanks
[2014-05-22 21:06:06 -0400] medya: @behemphi  haha yeah now I am a big fan
[2014-05-22 21:08:02 -0400] whiteadam: cleaning up other people's firewall rules is fun
[2014-05-22 21:08:24 -0400] maraca: hey guys - is it possible to do a knife search using a recipe?
[2014-05-22 21:08:49 -0400] coderanger: behemphi: yahrrrr, surviving the summer down there?
[2014-05-22 21:08:49 -0400] maraca: something like knife search 'chef_environment:production AND recipes:nginx::default'
[2014-05-22 21:08:51 -0400] coderanger: maraca: You mean use search within a recipe?
[2014-05-22 21:08:58 -0400] coderanger: or to search for a node the runs a specific recipe
[2014-05-22 21:09:04 -0400] maraca: coderanger, the later
[2014-05-22 21:09:18 -0400] coderanger: Ahh, thats correct overall, but you probably need to escape the :s in the recipe name
[2014-05-22 21:09:28 -0400] coderanger: 'chef_environment:production AND recipes:nginx\:\:default'
[2014-05-22 21:09:36 -0400] coderanger: I always have to fiddle with the number of slashes though
[2014-05-22 21:09:42 -0400] maraca: YES
[2014-05-22 21:09:43 -0400] maraca: you rule
[2014-05-22 21:09:46 -0400] maraca: thanks coderanger  :)
[2014-05-22 21:18:07 -0400] medya: how can I write a wrapper for jboss cookbook that it will download the jboss not from the internet but from a local repository ? (lets say I have 10 clients I dont want all of them use internet to download jboss)
[2014-05-22 21:18:32 -0400] coderanger: medya: Does the upstream cookbook expose an attribute doe that?
[2014-05-22 21:18:54 -0400] medya: I dont think so, how would I know
[2014-05-22 21:19:32 -0400] medya: do they usualy provide such attribute or is it an unusual thing that I am asking
[2014-05-22 21:19:52 -0400] coderanger: medya: Assuming you mean http://community.opscode.com/cookbooks/jboss, it has a dl_url attribute
[2014-05-22 21:20:08 -0400] medya: oh I see
[2014-05-22 21:20:11 -0400] coderanger: medya: But download it an read the cookbook code to be sure
[2014-05-22 21:20:32 -0400] medya: what if it was a package that get installed by apt-get in ubuntu or yum in redhat
[2014-05-22 21:20:36 -0400] medya: how could I make that download from locally
[2014-05-22 21:20:50 -0400] medya: or how could I make it that once one of them download from internet , all others download from local ?
[2014-05-22 21:21:56 -0400] coderanger: medya: You could rehost the package in a local apt/yum repo and set up that repository as a higher priority source
[2014-05-22 21:22:11 -0400] coderanger: (the apt and yum cookbooks each have an LWRP for configuring repos)
[2014-05-22 21:22:42 -0400] medya: but do I need to fill up thte local apt repo manualy?
[2014-05-22 21:22:57 -0400] coderanger: Yes
[2014-05-22 21:23:08 -0400] coderanger: I mean its up to you where you want to install from
[2014-05-22 21:23:13 -0400] medya: could I make it manualy that the first time if it is not in the local download from internet and put it in local rpeo?
[2014-05-22 21:23:46 -0400] coderanger: Technically yes, but that would really be a misuse of chef
[2014-05-22 21:24:04 -0400] coderanger: Anything you can do, Chef can do, but that doesn't make it a good idea
[2014-05-22 21:24:18 -0400] coderanger: If you want to run an internal package cache or mirror, there are things for that
[2014-05-22 21:24:32 -0400] coderanger: Might be overkill for a single package though
[2014-05-22 21:30:41 -0400] feliupe: hi
[2014-05-22 21:30:54 -0400] feliupe: i'am new here. someone over there?
[2014-05-22 21:33:12 -0400] coderanger: feliupe: Many of us, welcome
[2014-05-22 21:33:34 -0400] feliupe: thx, ranger
[2014-05-22 21:34:13 -0400] feliupe: o passed the entire morning trying to prove myself that chef is a good choice to install softwares
[2014-05-22 21:34:20 -0400] pwelch: hey everyone. does anyone know of a solution that deploys chef to a node with capistrano? Similar to supply_drop for puppet: https://github.com/pitluga/supply_drop
[2014-05-22 21:34:27 -0400] pwelch: Looks like Knife-Solo might be the closest option
[2014-05-22 21:34:36 -0400] feliupe: but, until now: nothing. Some can say if worth the effort?
[2014-05-22 21:36:35 -0400] coderanger: pwelch: I don't know about 'with capistrano' but if you just mean 'from my workstation' that comes standard with `knife boostrap`
[2014-05-22 21:36:45 -0400] coderanger: feliupe: What kind of "software"?
[2014-05-22 21:36:50 -0400] feliupe: apache
[2014-05-22 21:36:58 -0400] feliupe: for real
[2014-05-22 21:37:00 -0400] feliupe: php
[2014-05-22 21:37:04 -0400] coderanger: feliupe: What are you using currently for infra automation?
[2014-05-22 21:37:07 -0400] pwelch: well the scope of the project I am working on now is requiring to push stuff via ssh and with solo for now.
[2014-05-22 21:37:12 -0400] pwelch: possibly use chef-server later
[2014-05-22 21:37:24 -0400] coderanger: pwelch: Then knife-solo is probably your best bet
[2014-05-22 21:37:44 -0400] feliupe: have some packs on github using chef and I trying to use them
[2014-05-22 21:38:09 -0400] coderanger: feliupe: Chef, in general, is just a tool to create repeatable, code-driven setups for your servers
[2014-05-22 21:38:46 -0400] coderanger: feliupe: If you are asking "why use configuration management at all?" thats pretty much the reason, it makes things repeatable, which means testable and disaster resilient
[2014-05-22 21:39:05 -0400] pwelch: coderanger:
[2014-05-22 21:39:27 -0400] pwelch: coderanger: thanks, Wanted to make sure it was the most popular project solving that problem
[2014-05-22 21:39:58 -0400] feliupe: oh.. thx, thought that would be useful to install softwares on my linux in a automated way
[2014-05-22 21:40:21 -0400] coderanger: pwelch: Yeah, an alternate option is berkflow but thats very young and has very very specific workflows that come along with it
[2014-05-22 21:40:28 -0400] coderanger: feliupe: It is indeed
[2014-05-22 21:40:38 -0400] ianblenke: coderanger: and not chef-zero?
[2014-05-22 21:40:49 -0400] coderanger: ianblenke: Hmm?
[2014-05-22 21:41:44 -0400] ianblenke: if chef-solo and knife-solo fulfills the use case, wouldn't chef-zero and a berks upload suffice the purpose as well, without the chef-solo weirdness with attribute saving, etc?
[2014-05-22 21:42:10 -0400] coderanger: ianblenke: No, in that chef-zero isn't a distribution solution
[2014-05-22 21:42:24 -0400] feliupe: coderanger: do you think worth the effort to learn for this purpose? maybe after I can use in some job
[2014-05-22 21:42:24 -0400] coderanger: ianblenke: You would still need to get the code to the target machine somehow
[2014-05-22 21:42:44 -0400] coderanger: feliupe: I mean you are asking someone that works on/with Chef every day, so I'm more than a little biased, but I think so
[2014-05-22 21:43:00 -0400] ianblenke: coderanger: knife bootstrap isn't enough for that?
[2014-05-22 21:43:06 -0400] coderanger: ianblenke: No
[2014-05-22 21:43:13 -0400] coderanger: ianblenke: That just installs Chef itself
[2014-05-22 21:43:15 -0400] ianblenke: ok. I'm probably not understanding then.
[2014-05-22 21:43:30 -0400] ianblenke: chef-metal-ssh then?
[2014-05-22 21:43:33 -0400] coderanger: ianblenke: knife-solo also handles copying over cookbooks/roles/databags to the target machine
[2014-05-22 21:43:40 -0400] ianblenke: that requires a provisioning node though
[2014-05-22 21:43:50 -0400] coderanger: ianblenke: No, you do it directly from your workstation
[2014-05-22 21:44:10 -0400] feliupe: coderanger: thx!
[2014-05-22 21:44:11 -0400] coderanger: ianblenke: If you are saying "you can use chef-server instead of knife-solo" then yes, you are correct, but thats not generally a helpful observation :)
[2014-05-22 21:44:21 -0400] ianblenke: ah. and sshing and running chef-client isn't going to help if the chef-client doesn't know how to talk to the chef-zero you're running locally, gotcha.
[2014-05-22 21:45:07 -0400] coderanger: ianblenke: They are just two very different workflows
[2014-05-22 21:45:30 -0400] evaryont: Hello #chef! I'm curious, what's the default/ subdirectory in files/ & templates/ used for? I haven't seen any other directories there.
[2014-05-22 21:46:13 -0400] coderanger: evaryont: Sighhhh
[2014-05-22 21:46:28 -0400] coderanger: evaryont: There is the real answer and the answer as far as you shoud ever care, which do you want?
[2014-05-22 21:47:07 -0400] evaryont: coderanger: hah, both preferably. But if I missed some documentation, that would be easier :)
[2014-05-22 21:47:45 -0400] coderanger: evaryont: So the simple answer is "it is legacy cruft, just treat it as boilerplate and it will go away when coderanger gets his ass in gear and merges the patch for it"
[2014-05-22 21:48:07 -0400] coderanger: evaryont: The real answer is http://docs.opscode.com/essentials_cookbook_files.html#file-specificity
[2014-05-22 21:48:24 -0400] evaryont: coderanger: haha, patches are always in the queue ;)
[2014-05-22 21:48:52 -0400] coderanger: The patch to fix it just bitrotted too much to merge as is
[2014-05-22 21:49:03 -0400] coderanger: And I've not had the cycles to get back to it
[2014-05-22 21:49:08 -0400] evaryont: interesting. I wonder if anyone ever used that.
[2014-05-22 21:49:20 -0400] coderanger: Some people use it, but its a vanishing minority
[2014-05-22 21:49:29 -0400] coderanger: the whole layout of cookbooks is highly suspect
[2014-05-22 21:49:31 -0400] coderanger: :-)
[2014-05-22 21:52:45 -0400] shlant: anyone know how to reference knife.rb entries in Vagrantfile?
[2014-05-22 21:53:00 -0400] shlant: is this wrong?
[2014-05-22 21:53:00 -0400] shlant: require 'chef'
[2014-05-22 21:53:01 -0400] shlant: Chef::Config.from_file(File.join(File.dirname(__FILE__), '.chef', 'knife.rb'))
[2014-05-22 21:53:20 -0400] coderanger: shlant: What are you trying to do?
[2014-05-22 21:53:37 -0400] coderanger: I think that should probably work off the top of my head
[2014-05-22 21:53:48 -0400] shlant: coderanger: reference knife.rb entries in Vagrantfile
[2014-05-22 21:53:52 -0400] shlant: like chef.cookbooks_path = Chef::Config[:cookbook_path]
[2014-05-22 21:54:13 -0400] shlant: if I use that code it complains "Message: cannot load such file -- chef"
[2014-05-22 21:54:18 -0400] coderanger: shlant: So the only problem is that inside vagrant you are using their internal ruby, so chef isn't installed there
[2014-05-22 21:54:34 -0400] coderanger: shlant: Yeah, that :)
[2014-05-22 21:54:52 -0400] shlant: coderanger: do I have to install a plugin?
[2014-05-22 21:55:00 -0400] shlant: or how do I install vagrant gems?
[2014-05-22 21:55:06 -0400] coderanger: shlant: You kind of can't  :-/
[2014-05-22 21:55:18 -0400] coderanger: shlant: You could do vagrant plugin install chef
[2014-05-22 21:55:27 -0400] coderanger: and then update your plugins.json manually to remove that?
[2014-05-22 21:55:38 -0400] coderanger: I don't know what happens if you try to load something as a plugin that isn't actually one
[2014-05-22 21:55:42 -0400] coderanger: maybe it would be harmless?
[2014-05-22 21:56:01 -0400] shlant: so install chef plugin and remove reference from plugins.json
[2014-05-22 21:56:06 -0400] coderanger: You can also manually set $GEM_HOME to ~/.vagrant.d/gems (or whatever it is now)
[2014-05-22 21:56:10 -0400] coderanger: and then gem install
[2014-05-22 21:56:19 -0400] coderanger: But thats pretty far down the path of breaking things :)
[2014-05-22 21:56:57 -0400] evaryont: coderanger: `vagrant plugin install` just calls the embedded gem command, there isn't anything special about it
[2014-05-22 21:57:14 -0400] coderanger: evaryont: It also updates the plugins.json
[2014-05-22 21:57:16 -0400] evaryont: Vagrant itself looks for a vagrant_plugin.rb in it's GEMPATH, ala Rubygems plugins, and that's the list.
[2014-05-22 21:57:26 -0400] evaryont: indeed, but it's harmless to keep that reference
[2014-05-22 21:57:35 -0400] coderanger: Then yeah, plugin install chef should work :)
[2014-05-22 21:57:52 -0400] shlant: Net::HTTPNotFound: No gems found matching "vagrant-login" "0.9.0" nil
[2014-05-22 21:58:00 -0400] shlant: from plugin install
[2014-05-22 21:58:20 -0400] shlant: I feel myself falling down the rabbit hole already...
[2014-05-22 21:58:35 -0400] evaryont: shlant: should already have that installed, it's a plugin to vagrant included by default...
[2014-05-22 21:58:46 -0400] evaryont: ls /opt/vagrant/embedded/gems/gems/vagrant-login-1.0.1/
[2014-05-22 21:59:12 -0400] shlant: evaryont: indeed it is
[2014-05-22 21:59:13 -0400] coderanger: shlant: You can also go even further down the rabbithole and install vagrant as a gem via bundler
[2014-05-22 21:59:17 -0400] shlant: $ vagrant plugin list                                                                                                          2 
[2014-05-22 21:59:18 -0400] shlant: vagrant-aws (0.4.1)
[2014-05-22 21:59:18 -0400] shlant: vagrant-berkshelf (2.0.1)
[2014-05-22 21:59:19 -0400] shlant:   - Version Constraint: 2.0.1
[2014-05-22 21:59:20 -0400] shlant: vagrant-login (1.0.1, system)
[2014-05-22 21:59:20 -0400] shlant: vagrant-share (1.0.1, system)
[2014-05-22 21:59:25 -0400] coderanger: Thats what I do when I am forced to use it directly
[2014-05-22 21:59:37 -0400] shlant: coderanger: I though the vagrant gem wasn't maintained or something?
[2014-05-22 21:59:40 -0400] shlant: deprecated
[2014-05-22 21:59:47 -0400] shlant: i would lvoe to unstall vagrant as a gem ahah
[2014-05-22 21:59:50 -0400] coderanger: shlant: It is still a gem, it just isn't releated on rubygems
[2014-05-22 22:00:15 -0400] coderanger: shlant: gem 'vagrant', github: 'mitchellh/vagrant', ref: 'v1.whatever'
[2014-05-22 22:00:17 -0400] evaryont: indeed, just look at the embedded gems directory and there is vagrant, all packaged up as a gem :-)
[2014-05-22 22:00:54 -0400] coderanger: But if that breaks, you get to keep all the pieces
[2014-05-22 22:01:10 -0400] shlant: i feel like using knife.rb refs isn't worth it haha
[2014-05-22 22:01:15 -0400] coderanger: Yeah
[2014-05-22 22:01:20 -0400] shlant: I thought I had it working before
[2014-05-22 22:01:22 -0400] coderanger: Or just use it via test-kitchen
[2014-05-22 22:01:23 -0400] shlant: but maybe not
[2014-05-22 22:02:11 -0400] coderanger: shlant: There are other ways to make it work, but they get progressively weirder, like "shell out to the normal ruby and serialize the chef config to json and then load it in the vagrant process"
[2014-05-22 22:02:45 -0400] shlant: sounds horrible haah
[2014-05-22 22:02:49 -0400] evaryont: is there documentation that'll kinda hand-hold a person from 0-to-60 with an empty chef-repo using Berkshelf?
[2014-05-22 22:02:51 -0400] shlant: i'll just manually have the entries
[2014-05-22 22:02:55 -0400] shlant: or use env vars
[2014-05-22 22:03:11 -0400] coderanger: evaryont: Hmm, learnchef has a little bit, but not much
[2014-05-22 22:03:18 -0400] coderanger: evaryont: You can just ask on here though
[2014-05-22 22:03:29 -0400] coderanger: evaryont: Or hire me to do training :P
[2014-05-22 22:03:59 -0400] evaryont: coderanger: hah! Can I get you, in Markdown format? :P
[2014-05-22 22:04:20 -0400] coderanger: evaryont: Sure, if you want to pay me to write docs :)
[2014-05-22 22:04:38 -0400] evaryont: mostly just wanted a place to point people to when I get the inevitable questsions about the new workflow I'm pushing onto $WORK
[2014-05-22 22:04:47 -0400] evaryont: please let me upgrade from chef 0.9 T_T
[2014-05-22 22:05:07 -0400] coderanger: evaryont: berkshelf.com is kind of it, or maybe Chef In Action from Manning
[2014-05-22 22:07:56 -0400] mosez: hi
[2014-05-22 22:08:06 -0400] shlant: coderanger: anyway to specify to vagrant what provider to user without the flag?
[2014-05-22 22:08:08 -0400] coderanger: mosez: Alo
[2014-05-22 22:08:13 -0400] mosez: does it work to access a chef 10 server with the chef 11 client?
[2014-05-22 22:08:17 -0400] shlant: i though metadata.json do I have to point to it?
[2014-05-22 22:08:22 -0400] coderanger: shlant: I don't think so, but its been a while
[2014-05-22 22:08:27 -0400] coderanger: mosez: No
[2014-05-22 22:08:34 -0400] coderanger: mosez: Wait, yes, it should
[2014-05-22 22:08:40 -0400] mosez: somebody told me that this should work :(
[2014-05-22 22:08:44 -0400] coderanger: mosez: Thinking of the wrong version
[2014-05-22 22:09:11 -0400] coderanger: mosez: 10 to 11 was a compatible rewrite from Ruby to Erlang, that should work unless you depend on some old APIs
[2014-05-22 22:09:16 -0400] coderanger: (which chef-client itself doesn't)
[2014-05-22 22:10:07 -0400] mosez: ok... so i will try it
[2014-05-22 22:10:08 -0400] shlant: coderanger: found it: VAGRANT_DEFAULT_PROVIDER
[2014-05-22 22:10:15 -0400] coderanger: mosez: Its a special case though, overall that isn't guaranteed between major versions, the server will always be backwards compatible, but not always forward compatible
[2014-05-22 22:10:26 -0400] coderanger: (unless mmzyk wants to promise that :)
[2014-05-22 22:10:51 -0400] mosez: normaly we are running a chef 10 setup, but i need a current bunny version within the app where chef client gets included. so i thought about updating only the client :)
[2014-05-22 22:11:07 -0400] coderanger: mosez: Any reason to not upgrade the server?
[2014-05-22 22:11:39 -0400] mosez: coderanger: yes... the switch from ruby to erlang and the crazy erlang dependencies :)
[2014-05-22 22:12:06 -0400] mosez: coderanger: and as i'm working for a linux distribution it's no option to ship the omnibus installation :)
[2014-05-22 22:12:09 -0400] coderanger: mosez: Thats all wrapped up in the omnibus package, you don't need to touch any of it yourself
[2014-05-22 22:12:32 -0400] coderanger: mosez: Eh, installing without omnibus will never be any easier, and will probably only get harder over time
[2014-05-22 22:12:51 -0400] coderanger: mosez: On the plus side, chef 11 server no longer needs couch
[2014-05-22 22:13:05 -0400] mosez: for personal usage omnibus is ok... but if you are working on an enterprise linux it doesnt work
[2014-05-22 22:13:24 -0400] someara: what do you mean
[2014-05-22 22:13:27 -0400] coderanger: mosez: I've found the opposite in fact
[2014-05-22 22:13:58 -0400] coderanger: mosez: In a large enterprise, static containers are the _only_ way to ship software the works, the OS packages are a wasteland of locked version and custom overrides
[2014-05-22 22:14:34 -0400] mosez: but we are packaging everything and i can not change that -.-
[2014-05-22 22:14:57 -0400] mosez: rubygem packaging works quite good :)
[2014-05-22 22:15:01 -0400] coderanger: lolno
[2014-05-22 22:15:36 -0400] mosez: before my job i thought it should not work... but i found the first distribution where it works quite good :)
[2014-05-22 22:16:38 -0400] coderanger: ::shrug:: you shouldn't be trying to use chef 11 then, since there really aren't firm guarantees of the forward compat being maintained indefinitely
[2014-05-22 22:17:01 -0400] coderanger: I don't think there is any way it could be broken without a major version, but its probably not worth the risk
[2014-05-22 22:17:53 -0400] mosez: i know... a colleague tries to package chef 11 nice for weeks :)
[2014-05-22 22:18:22 -0400] someara: whats wrong with the omnibus packaging?
[2014-05-22 22:18:38 -0400] someara:  /opt/allthethings. done
[2014-05-22 22:19:30 -0400] mosez: someara: it's ok if you are not distributing a linux distro :)
[2014-05-22 22:19:38 -0400] someara: aha
[2014-05-22 22:19:40 -0400] mosez: coderanger: https://build.opensuse.org/package/show/systemsmanagement:chef:master/erchef currently broken :(
[2014-05-22 22:20:02 -0400] coderanger: mosez: Not surprised, but also not my problem, y'all are building it Wrong
[2014-05-22 22:20:11 -0400] mosez: :)
[2014-05-22 22:20:45 -0400] mosez: it's not my decision
[2014-05-22 22:20:57 -0400] mosez: i try to do the best with the things i've got :)
[2014-05-22 22:24:33 -0400] evaryont: mosez: doubtful this works for you, but at $WORK we just package the entire /opt/chef directory as an rpm and push that around. omnibus and native packages!
[2014-05-22 22:25:22 -0400] coderanger: evaryont: I mean that is exactly what the omnibus package is
[2014-05-22 22:25:33 -0400] rfergu: Hiya, so I've got an encrypted databag up on opscode, and I want to make a new role from a file.  I have the line "settings = Chef::EncryptedDataBagItem.load("ctrl", "github")".  It errors with:
[2014-05-22 22:25:34 -0400] rfergu: ERROR: ArgumentError: No secret specified to load_secret and no secret found at /etc/chef/encrypted_data_bag_secret
[2014-05-22 22:25:43 -0400] rfergu: Does that mean its looking on my machine instead of opscode?
[2014-05-22 22:25:59 -0400] coderanger: rfergu: Yes
[2014-05-22 22:26:36 -0400] rfergu: shame it doesn't know to look in what is specified in my .chef directory
[2014-05-22 22:26:58 -0400] coderanger: fujin: The "my machine" is the box running chef-client
[2014-05-22 22:27:02 -0400] coderanger: er rfergu ^^
[2014-05-22 22:27:13 -0400] coderanger: rfergu: Presumably you don't have a .chef folder there
[2014-05-22 22:27:39 -0400] coderanger: rfergu: When you run knife boostrap, it does copy over whatever secret your local knife was configured with
[2014-05-22 22:27:54 -0400] coderanger: fujin: Don't make me get out the butterfly nets
[2014-05-22 22:29:41 -0400] mosez: evaryont: not really the thing that i can do :)
[2014-05-22 23:22:32 -0400] caryp: just trying out chefdk on my old Macbook Pro
[2014-05-22 23:22:57 -0400] caryp: looks like OSX 10.8.5 isn't currently supported
[2014-05-22 23:22:58 -0400] caryp: https://github.com/opscode/chef-dk/issues/14
[2014-05-22 23:23:13 -0400] caryp: :(
[2014-05-22 23:23:41 -0400] caryp: anybody know if this is being worked on?
[2014-05-22 23:25:01 -0400] coderanger: caryp: As stated in the ticket you linked, it is
[2014-05-22 23:26:22 -0400] evaryont: is there documenation for the API available to knife plugins?
[2014-05-22 23:26:51 -0400] coderanger: evaryont: I don't know of any, but its just one class really (aside from standard chef internals)
[2014-05-22 23:27:04 -0400] evaryont: m.
[2014-05-22 23:27:12 -0400] Seedling: hello got a q about attributes
[2014-05-22 23:27:12 -0400] Seedling: I have a basic cookbook for mysql
[2014-05-22 23:27:15 -0400] Seedling: default['mysql']['port'] = '3306'
[2014-05-22 23:27:15 -0400] Seedling: is set in attributes
[2014-05-22 23:27:16 -0400] Seedling: template has
[2014-05-22 23:27:16 -0400] Seedling: port              = <%= @port %>
[2014-05-22 23:27:17 -0400] Seedling: but when the chef run goes it is empty
[2014-05-22 23:27:17 -0400] Seedling: port              =
[2014-05-22 23:27:18 -0400] Seedling: the recipe isn't passing variables
[2014-05-22 23:27:18 -0400] Seedling: and I don't want it too
[2014-05-22 23:27:19 -0400] Seedling: i want it to inherit all attributes to the template from the attributes in the cookbook attributes file
[2014-05-22 23:27:19 -0400] Seedling: and then get overridden in the env or role
[2014-05-22 23:27:20 -0400] evaryont: is there documenation on reading a cookbook's metadata?
[2014-05-22 23:28:07 -0400] coderanger: evaryont: What kind of metadata?
[2014-05-22 23:28:35 -0400] coderanger: Seedling: Variables have to be passed explicitly in the resrouce
[2014-05-22 23:28:54 -0400] evaryont: coderanger: I'm writing a sanity checker for our $WORK cookbooks to make sure description is filled in and not the default/generic templated words, has a license, etc.
[2014-05-22 23:28:55 -0400] coderanger: Seedling: You would need "variables port: node['mysql']['port']"
[2014-05-22 23:29:26 -0400] evaryont: so I'd like to read metadata.rb for each of our cookbooks (prefixed, so all that match xyz-*) and issue the various warnings
[2014-05-22 23:29:29 -0400] coderanger: evaryont: You would just have to copy the code from knife cookbook upload, it is unpleasant
[2014-05-22 23:29:40 -0400] coderanger: evaryont: I would just do it statically via regexes
[2014-05-22 23:29:44 -0400] Seedling: @coderanger - there's no other way? I have like 50 "default" attributes that I need for various envs that I don't want to have a huge list for in the recipe
[2014-05-22 23:29:52 -0400] caryp: coderanger: good point. thx.  I guess I am really looking for an eta.  I'd love to start using it
[2014-05-22 23:30:09 -0400] coderanger: Seedling: You could pass something like "variables node['mysql']" so it uses that whole hash
[2014-05-22 23:30:28 -0400] coderanger: Seedling: You can also directly reference the node object in the template, but really don't, it makes things impossible to debug
[2014-05-22 23:30:41 -0400] Seedling: but the node will take precedence then over env attributes. at least from my testing
[2014-05-22 23:30:42 -0400] coderanger: evaryont: Check if foodcritic has stuff for this btw
[2014-05-22 23:30:58 -0400] evaryont: oh right!
[2014-05-22 23:31:11 -0400] evaryont: foodcritic would be excellent instead of hacking a knife plugin together
[2014-05-22 23:31:12 -0400] coderanger: Seedling: All attributes from the node, roles, envs, and cookbooks gets merged in to the node object at run time
[2014-05-22 23:31:30 -0400] coderanger: evaryont: Yahr, if nothing else I would build it as a foodcritic plugin instead of a knife plugin :)
[2014-05-22 23:31:32 -0400] Seedling: yeah but one must supersede the other
[2014-05-22 23:31:40 -0400] coderanger: (if it doesn't already exist)
[2014-05-22 23:32:11 -0400] coderanger: Seedling: Yes, the full merge order is http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2014-05-22 23:32:18 -0400] Seedling: i guess i don't understand why the attributes file has default when i then need to explicitly set them as variables in the recipe
[2014-05-22 23:33:38 -0400] Seedling: I guess I have no choice but to pass the whole list of attributes as variables in the recipe then override
[2014-05-22 23:33:47 -0400] coderanger: Seedling: Template variables don't have to come from attributes, they are intentionally disconnected
[2014-05-22 23:34:14 -0400] coderanger: Seedling: Cookbooks generally set sane defaults for all their attributes, and then you would override them as needed in roles/envs
[2014-05-22 23:34:20 -0400] coderanger: (or wrapper cookbooks)
[2014-05-22 23:34:55 -0400] Seedling: that's fair  but i'm having trouble with having to set the variables in the recipe iteself to write to the template
[2014-05-22 23:35:05 -0400] Seedling: why don't they just populate from the attributes file?
[2014-05-22 23:35:14 -0400] coderanger: Seedling: As I said, you can pass the whole sub-hash to the template
[2014-05-22 23:35:23 -0400] Seedling: true
[2014-05-22 23:35:27 -0400] Seedling: maybe that's the only way
[2014-05-22 23:35:35 -0400] coderanger: It is less clear, but if there are a ton it is sometimes nicer
[2014-05-22 23:35:46 -0400] Seedling: cool coderanger
[2014-05-22 23:35:49 -0400] Seedling: thanks for the help
[2014-05-22 23:39:52 -0400] evaryont: coderanger: yeah, foodcritic includes ways to check the cookbook's metadata. (f.ex FC008)
[2014-05-22 23:40:01 -0400] coderanger: evaryont: \o/
[2014-05-22 23:42:37 -0400] evaryont: coderanger: ...ish. it exposes the metadata.rb as a ruby AST. *sigh*
[2014-05-22 23:42:45 -0400] evaryont: better than regexes I guess :)
[2014-05-22 23:54:26 -0400] rfergu: If I have Chef::EncryptedDataBagItem.load in my recipe, how does knife know what secret file to use to decrypt it?
[2014-05-22 23:56:39 -0400] coderanger: rfergu: It uses whatever chef is configured with in the client.rb (or solo.rb)
[2014-05-22 23:57:05 -0400] coderanger: rfergu: See https://github.com/opscode/chef/blob/master/lib/chef/encrypted_data_bag_item.rb#L127-L152
[2014-05-22 23:57:52 -0400] evaryont: anyone know what the return value of a rule block in foodcritic is supposed to return?
