[2014-05-21 01:25:34 -0400] xeno: Okay, despite the way I read the learnchef.com tutorial, I feel I am seeing evidence that I need to install chef on the client before I do the bootstrap.  Is this correct?
[2014-05-21 01:34:11 -0400] tylerhannan: @xeno Im actually running through learnchef tutorial now.  the knife bootstrap install the chef client on the target node.
[2014-05-21 01:35:15 -0400] tylerhannan: http://docs.opscode.com/install_bootstrap.html is also rather helpful.
[2014-05-21 01:36:14 -0400] jameson__: wrote a splunk_monitor resource :\ but I can only gurantee it will work with somethat that has GNU grep +_+
[2014-05-21 01:55:21 -0400] coderanger: xeno: No, bootstrap is what installs that
[2014-05-21 03:24:42 -0400] a13x212: can i start a service immediately?
[2014-05-21 03:28:41 -0400] iverson0881: a13x212: you can use the notifies directive to do just that
[2014-05-21 03:29:37 -0400] a13x212: the service hasn't started yet though
[2014-05-21 03:46:59 -0400] dyer: Is it possible to run two provisioners in test-kitchen ? For example I would like to run my bootstrap via a shell provisioner and then kick off chef_zero run afterward
[2014-05-21 06:40:01 -0400] lyken: hmm trying to go through this getting started writing chef cookbooks the berkshelf way and i can't get the vagrant up to work, just errors out :/
[2014-05-21 06:42:42 -0400] srenatus: digitalchild: vagrant can fail in thousands of ways, you'd get a better chance at someone being able to help when you paste the output somewhere (hastebin, pastebin, ...). if it's not a detailed error message, try: VAGRANT_LOG=debug vagrant up
[2014-05-21 06:43:23 -0400] digitalchild: srenatus: thanks, ill try enabling logging, im sure its just an id 10t error
[2014-05-21 06:51:20 -0400] digitalchild: wrong, berkshelf plugin version, whoops
[2014-05-21 06:56:23 -0400] bobdobalina: morning all
[2014-05-21 06:58:31 -0400] bobdobalina: have a quick question, hopefully a simple one, what is the best way to make chef run without making changes so it updates it's node data on the system, and also can you do a encaps include_recipe inside a guard , like only run this recipe if file x does not exist?
[2014-05-21 07:11:00 -0400] jblack: Hi. I've been comparing chef encrypted data bags with chef-vault and a couple other things. I haven't yet found something sufficiently magical to handle sensitive attributes. Any advice?
[2014-05-21 08:00:51 -0400] gfunky: jblack: best i've come up with so far is encrypted data bags with a per-environment encryption key. chef-vault looks cool, but i'm not sure how it would scale and haven't figure out how to pre-provision access a client needs for bootstrap with runlist.
[2014-05-21 08:17:36 -0400] jblack: I was considering using role based keys,  and using a knife bootstrap -s that would send over the various keys munged together.
[2014-05-21 08:18:30 -0400] jblack: then I can parse the file on the other side an split it apart appropriately
[2014-05-21 08:29:23 -0400] Breaking_Pitt: Hi!
[2014-05-21 08:29:41 -0400] Breaking_Pitt: Is there anyway to disable this behavior when bootstraping a client?
[2014-05-21 08:29:42 -0400] Breaking_Pitt: 192.168.99.92 Resolving www.opscode.com (www.opscode.com)... failed: Name or service not known.
[2014-05-21 08:29:54 -0400] Breaking_Pitt: I have some errors yesterday with my network...
[2014-05-21 08:30:16 -0400] Breaking_Pitt: So I was thinking in storing the chef-client in my own network.. It's possible?
[2014-05-21 08:30:45 -0400] mattt: 192.168.99.92 ?
[2014-05-21 08:48:38 -0400] jblack: Yeah, looks like your dns is broken, Breaking_Pitt
[2014-05-21 08:49:14 -0400] jblack: You might be interested in chef-solo. That's chef without a chef server.
[2014-05-21 08:49:39 -0400] Breaking_Pitt: jblack yes... but I would like to know if its possible to change the download from opscode to a server in my network
[2014-05-21 08:50:18 -0400] jblack: Yes, you can install your own chef server.
[2014-05-21 08:50:27 -0400] mattt: jblack: he's asking about the client
[2014-05-21 08:51:44 -0400] mattt: Breaking_Pitt: you're using knife bootstrap or something similar ?
[2014-05-21 08:51:49 -0400] Breaking_Pitt: instead going to opscode.com to download the client in order to bootstrap the node download it from my own network
[2014-05-21 08:51:49 -0400] jblack: ahh. "gem install chef" if you like ruby, "apt-get install chef" if you have a debian based setup and don't mind a probably much older chef...
[2014-05-21 08:51:50 -0400] Breaking_Pitt: yes
[2014-05-21 08:52:09 -0400] pellis: hi all. i'm trying to bootstrap via SSH. but knife client just drops after saying 'Bootstrapping Chef on .." without any error at all. this is also with the --verbose flag.
[2014-05-21 08:52:36 -0400] jblack: pellis: I would try sshing to the target system to make sure there isn't a firewall dropping ssh packets
[2014-05-21 08:52:53 -0400] jblack: If you can't ssh, knife can't either
[2014-05-21 08:53:16 -0400] pellis: jblack: SSH to machine works
[2014-05-21 08:53:27 -0400] mattt: Breaking_Pitt: i'm not sure how you can boostrap using a different location for client
[2014-05-21 08:53:29 -0400] pellis: jblack: i've also installed Ruby on it just in case chef was failing due to that
[2014-05-21 08:53:47 -0400] jblack: Oh, I missed the without any error.. Do you mean completely back to shell?
[2014-05-21 08:54:09 -0400] jblack: check to see if the node is in knife status?
[2014-05-21 08:54:23 -0400] jblack: Perhaps the node has alreayd been bootstrapped, and has an empty runlist.
[2014-05-21 08:55:38 -0400] pellis: jblack: yes, completely back, no error
[2014-05-21 08:55:44 -0400] mattt: Breaking_Pitt: check this http://docs.opscode.com/knife_bootstrap.html#custom-templates
[2014-05-21 08:55:50 -0400] mattt: Breaking_Pitt: maybe it's possible by specifying a template ?
[2014-05-21 08:56:11 -0400] pellis: jblack: checked that too.. node isn't bootstrapped. i also changed node name just to be sure. also checked that the chef server is reachable and returns good results on some queries with knife
[2014-05-21 08:56:13 -0400] jblack: pellis: Yeah, possibly an empty runlist. Look to see if it's there with "knife status",  then try a knife node edit nodename to see what it's runlist is
[2014-05-21 08:56:15 -0400] Breaking_Pitt: thanks mattt  I'll take a lookt at
[2014-05-21 08:56:39 -0400] jblack: pellis: You've got me then
[2014-05-21 08:57:36 -0400] mattt: Breaking_Pitt: yeah a template will do it, the location is specified in there
[2014-05-21 08:57:48 -0400] mattt: Breaking_Pitt: so you could run a custom template w/ a location on an internal web server or whatever
[2014-05-21 08:58:22 -0400] pellis: jblack: so only way is to go into knife code and spit 'puts' all over the place?
[2014-05-21 08:58:24 -0400] mattt: Breaking_Pitt: Breaking_Pitt root@stackforge-chef:~# gem contents chef | grep chef-full.erb
[2014-05-21 08:58:40 -0400] mattt: Breaking_Pitt: that should give you the location of teh default template it uses (i think)
[2014-05-21 09:00:28 -0400] jblack: pellis: I don't have any advice. :(
[2014-05-21 09:00:45 -0400] pellis: jblack: i think i got a direction. checking
[2014-05-21 09:03:23 -0400] pellis: jblack: im trying to bootstrap with 'root' but looks like chef forced it to 'ubuntu'
[2014-05-21 09:03:51 -0400] jblack: ahh, that's definitely odd.
[2014-05-21 09:04:07 -0400] jblack: maybe you're having template issues too. :/
[2014-05-21 09:04:08 -0400] pellis: because that's what in my knife.rb. but i'm trying to pass 'root' via CLI
[2014-05-21 09:04:36 -0400] jblack: how are you setting your username in knife.rb?
[2014-05-21 09:04:46 -0400] pellis: yup fixing on knife.rb works
[2014-05-21 09:04:53 -0400] jblack: cool
[2014-05-21 09:04:56 -0400] pellis: i can guarantee it worked around 2 months ago without this workaround
[2014-05-21 09:05:05 -0400] pellis: also - i think i can submit a pull request :)
[2014-05-21 09:05:12 -0400] jblack: I've never put target system info in my knife.rb, so I"m little confused as to how you're setup
[2014-05-21 09:05:13 -0400] pellis: do chef require a special CLA?
[2014-05-21 09:05:32 -0400] pellis: jblack: i had a knife[:ssh_user] variable set to 'ubuntu' in knife.rb
[2014-05-21 09:05:52 -0400] jblack: https://wiki.opscode.com/display/chef/How+to+Contribute has a CLA
[2014-05-21 09:06:18 -0400] jblack: Heh, that would do it. =(
[2014-05-21 09:06:45 -0400] pellis: looks like it is fixed: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap.rb#L229
[2014-05-21 09:07:02 -0400] pellis: on master, they have an if-else. in my version there's no 'else'. so it failed silently
[2014-05-21 09:07:06 -0400] jblack: sounds like you've changed from a more standard ubuntu image (which typically expects ubuntu+sudo) to one with your ssh key in root's setup ?
[2014-05-21 09:07:47 -0400] pellis: jblack: yes i'm trying to provision a hardware VM now, just for a POC, while usually i provision EC2 instances
[2014-05-21 09:07:55 -0400] bobdobalina: hey again all
[2014-05-21 09:08:11 -0400] pellis: found the bug :) https://github.com/opscode/chef/commit/e0333f44880878a9d47094e213017add64b3c66b
[2014-05-21 09:08:42 -0400] jblack: Yeah, I can see where that wedged up
[2014-05-21 09:08:49 -0400] bobdobalina: can I ask you thoughts, what is the nicest cleanest way in chef to update files like /etc/sysctl for tuning of nginx? should I create the file with entries or append additions ?
[2014-05-21 09:09:02 -0400] jblack: make a recipe that enables the service.
[2014-05-21 09:09:20 -0400] jblack: There's a service resource that's right up your alley, bob. =)
[2014-05-21 09:09:41 -0400] bobdobalina: i've made the wrapper cookbook that installs it from source and creates users, files etc
[2014-05-21 09:09:48 -0400] bobdobalina: just wanted to add in some kernel tuning
[2014-05-21 09:09:58 -0400] bobdobalina: to /etc/sysctl and /etc/security/limits.conf
[2014-05-21 09:10:48 -0400] bobdobalina: not really keen to dump an entire file on as part of the recipe, would rather have just appended to teh file if entries do not exist
[2014-05-21 09:11:06 -0400] jblack: oh, there's a sysctl cookbook
[2014-05-21 09:11:18 -0400] jblack: I"m sorry.  Igot thrown off by nginx. You're actually asking something different. ;)
[2014-05-21 09:11:40 -0400] bobdobalina: aaah oki
[2014-05-21 09:11:42 -0400] jblack: http://community.opscode.com/cookbooks/sysctl
[2014-05-21 09:11:47 -0400] bobdobalina: i'll take a look
[2014-05-21 09:12:22 -0400] jblack: In youur cookbook to configure nginx,  you can use sysctl::apply, which whould work with  node[:sysctl][:params]
[2014-05-21 09:12:24 -0400] bobdobalina: i was thinking of even just using the file resource with 'content' attrib
[2014-05-21 09:12:41 -0400] jblack: I suppose you could, but why reinvent the wheel. =)
[2014-05-21 09:12:48 -0400] bobdobalina: indeed
[2014-05-21 09:13:08 -0400] bobdobalina: i'm still very new to chef tbh, just managed to break the back of it this weekend
[2014-05-21 09:13:22 -0400] jblack: ahhhh,, mind a word of advice?
[2014-05-21 09:13:30 -0400] bobdobalina: sure
[2014-05-21 09:14:06 -0400] jblack: Sometimes wrapper cookbooks are the right thing to do, but probably not for you for nginx.
[2014-05-21 09:14:14 -0400] bobdobalina: hmm
[2014-05-21 09:14:31 -0400] jblack: You probably want your very own cookbook, that includes nginx recipes, and uses resources that it supplies.
[2014-05-21 09:14:41 -0400] bobdobalina: for nginx, i need to compile for source and also use some custom files, dir's etc
[2014-05-21 09:14:49 -0400] bobdobalina: from source*
[2014-05-21 09:15:32 -0400] bobdobalina: the custom module is the main reason i created the wrapper really
[2014-05-21 09:16:06 -0400] jblack: Did your cookbook start off as a clone of nginx's cookbook?
[2014-05-21 09:16:56 -0400] bobdobalina: nope
[2014-05-21 09:17:11 -0400] jblack: Ok,  then you're good.
[2014-05-21 09:17:16 -0400] bobdobalina: sweet
[2014-05-21 09:17:51 -0400] bobdobalina: i'm using it with a few other bits and pieces like certificates and encrypted data bags etc
[2014-05-21 09:17:58 -0400] bobdobalina: the wrapper that is
[2014-05-21 09:18:01 -0400] jblack: I was worried that instead of making Bob's cookbook to use the untouched nginx cookbook (an actual wrapper), that you had instead forked it and added your own stuff in place..
[2014-05-21 09:18:10 -0400] jblack: Yeah, that's the right way to do it
[2014-05-21 09:18:38 -0400] jblack: You're already using encrypted data bags?  And this is your first week, you say?
[2014-05-21 09:18:42 -0400] bobdobalina: thank god, cause i won't pretend i didn't have a few issues getting everything to work :)
[2014-05-21 09:19:13 -0400] bobdobalina: well, i've briefly touched it over the last year but never actually knocked up a cookbook for use
[2014-05-21 09:19:41 -0400] jblack: Are you running your own chef server, or using hosted chef?
[2014-05-21 09:19:52 -0400] bobdobalina: i'm using knife to bootstrap into aws using proxies for apt and git and all that jazz
[2014-05-21 09:19:58 -0400] bobdobalina: and built the chef server aye
[2014-05-21 09:20:11 -0400] bobdobalina: this week has been teh baptism of fire
[2014-05-21 09:20:13 -0400] jblack: You're doing pretty good, bob. =)
[2014-05-21 09:20:45 -0400] bobdobalina: cheers, feels like i'm finally getting somewhere
[2014-05-21 09:21:05 -0400] jblack: Have you run into knife-ec2 yet ?
[2014-05-21 09:21:17 -0400] bobdobalina: yep, thats how i built the nodes
[2014-05-21 09:21:53 -0400] jblack: You're definitely in good shape, man. I spent a month provisioning online, then later knife bootstrapping.
[2014-05-21 09:22:21 -0400] bobdobalina: yeah, i've tried to learn it all at once, i has been erm....character building to say the least
[2014-05-21 09:22:42 -0400] bobdobalina: chef, aws, openstack, docker, vagrant, ruby, json, berks, etc etc
[2014-05-21 09:23:21 -0400] jblack: all you're missing is a bit of rightscale. :)
[2014-05-21 09:23:41 -0400] bobdobalina: omg, no more pleaaaase lol
[2014-05-21 09:24:05 -0400] jblack: Nah, stay away from rightscale.
[2014-05-21 09:24:28 -0400] jblack: I mean, rightscale is awesome and cool. everyone should use it
[2014-05-21 09:26:18 -0400] bobdobalina: :)
[2014-05-21 09:26:36 -0400] bobdobalina: right, i got to go and build some stuff, back later and thanks for your help sir
[2014-05-21 09:26:48 -0400] jblack: :)
[2014-05-21 09:42:35 -0400] rmoriz: hi
[2014-05-21 09:43:01 -0400] rmoriz: is there a way to check in chefspec the variables() part of a template ressource?
[2014-05-21 09:45:43 -0400] bixu: Having some issues with omnibus-software when doing a bundle for omnibus-chef
[2014-05-21 09:45:47 -0400] bixu: "You passed :github as an option for gem 'omnibus-software', but it is invalid."
[2014-05-21 09:45:55 -0400] bixu: *scratches head*
[2014-05-21 10:31:38 -0400] as2techno: hi
[2014-05-21 11:01:37 -0400] whiteadam: someone fax me some coffee
[2014-05-21 11:17:01 -0400] sahilsk: Hi, all
[2014-05-21 11:17:14 -0400] whiteadam: hola
[2014-05-21 11:17:18 -0400] sahilsk: i'm looking for a way to add entry in /etc/services file. any helpl would be great
[2014-05-21 11:17:19 -0400] sahilsk: *help
[2014-05-21 11:30:51 -0400] whiteadam: With Chef?
[2014-05-21 12:17:59 -0400] bmurt: morning folks
[2014-05-21 12:52:01 -0400] dyer: Hey guys, question... Is it possible to run two provisioners in test-kitchen ?  I would like to run a bootstrap via something like a shell provisioner and then kick off chef_zero run afterward.
[2014-05-21 13:31:04 -0400] Malkav: Hey guys
[2014-05-21 13:36:59 -0400] whiteadam: ohai
[2014-05-21 13:37:02 -0400] jsilverman: hello nice people.. quick question about omnbibus installer... on ubuntu for chef 11 how do i get the omnibus to install a startup script?
[2014-05-21 13:37:38 -0400] jsilverman: i.e. /etc/init.d/chef-client
[2014-05-21 13:39:21 -0400] jsilverman: from the faq, chef won't install a service startup script. however, there is one on github... is that gihub one packaged somewhere that I can get it easily/automatically?
[2014-05-21 13:40:42 -0400] whiteadam: jsilverman: I do it with a wrapper for the chef-client package on github
[2014-05-21 13:41:43 -0400] jsilverman: ok.. but, something you wrote? or something in the wild somewhere?
[2014-05-21 13:42:18 -0400] whiteadam: So, not, I se the opscode chef-client cookbook
[2014-05-21 13:42:24 -0400] whiteadam: use*
[2014-05-21 13:42:30 -0400] jsilverman: ah
[2014-05-21 13:42:32 -0400] jsilverman: ic
[2014-05-21 13:42:37 -0400] jsilverman: hmmm
[2014-05-21 13:43:02 -0400] jsilverman: how do you bootstrap, though? best answer to that would be a docs page that describes that
[2014-05-21 13:43:33 -0400] NukePuppy: i have a wrapper cookbook in my base role which includes the chef-client with the options i want for upgrades/startup/intervals
[2014-05-21 13:43:45 -0400] NukePuppy: maybe something like that is what you're talking about not sure
[2014-05-21 13:43:53 -0400] jsilverman: right, it probably is
[2014-05-21 13:43:54 -0400] whiteadam: I do the same as NukePuppy
[2014-05-21 13:44:06 -0400] jsilverman: but how do you get that on there without already having chef-client on there?
[2014-05-21 13:44:21 -0400] NukePuppy: during bootstrap you put them into that 'role'
[2014-05-21 13:44:28 -0400] NukePuppy: one sec for example
[2014-05-21 13:44:48 -0400] jsilverman: actually, i think I have an idea...
[2014-05-21 13:45:07 -0400] NukePuppy: knife bootstrap some_server -r 'role[linux_base]' -E staging
[2014-05-21 13:45:10 -0400] jsilverman: if chef-client is installed, you can just run that CLI-wise to bootstrap
[2014-05-21 13:45:21 -0400] NukePuppy: and in linux_base i just have that chef-client cookbook in it along with some other very basic ones
[2014-05-21 13:45:24 -0400] jsilverman: ok
[2014-05-21 13:45:27 -0400] jsilverman: thanks, this is helpful
[2014-05-21 13:45:35 -0400] jsilverman: see? i knew y'all were nice people
[2014-05-21 13:45:40 -0400] NukePuppy: doubtful
[2014-05-21 13:45:45 -0400] whiteadam: lol
[2014-05-21 13:45:45 -0400] jsilverman: anyone listen to foodfighshow?
[2014-05-21 13:46:15 -0400] NukePuppy: ived tried.. i dont have patience sometimes
[2014-05-21 13:47:44 -0400] jsilverman: ah
[2014-05-21 13:48:14 -0400] jsilverman: yeah, i can understand that. the april 30 show was interesting to me
[2014-05-21 13:48:47 -0400] the_drow: Is there a way to control salt using chef?
[2014-05-21 13:49:03 -0400] the_drow: I'm asking because of opsworks
[2014-05-21 13:50:18 -0400] NukePuppy: btw jsilverman instead of rebootstrapping you can also do something like  knife node run_list add yourbox 'recipe[some_newcookbook_withchef-client]'
[2014-05-21 13:50:31 -0400] NukePuppy: could just run that in a loop of all your servers for example that need chef client
[2014-05-21 13:50:58 -0400] NukePuppy: unless you wanna edit some json by hand for x boxes
[2014-05-21 13:51:16 -0400] jsilverman: ok
[2014-05-21 13:52:28 -0400] poolpog: tis me, i changed me 'andle
[2014-05-21 14:03:53 -0400] dagan: All, I'm having a problem uploading just cookbooks to a new chef server. I get an error saying cannot update sandbox, the following checksums have not been uploaded. However, when I check the bookshelf's data store, the files are all there and intact. Thoughts?
[2014-05-21 14:11:48 -0400] daxroc: How does the omnibus installer figure out the platform, I'm installing it in a docker container and it can't detect the platform ?
[2014-05-21 14:38:02 -0400] daos: i recently moved a bunch of nodes to a new role -- i'm now trying to use 'knife ssh' to execute a command on all of them, but the search doesn't return any nodes. is there a way to force the solr server to reindex stuff? or to find out why the search is returning no results for the given role?
[2014-05-21 14:40:18 -0400] srenatus: daos: there's "knife reindex" IIRC but I'm not sure if it's going to help
[2014-05-21 14:40:42 -0400] srenatus: daos: btw what did you do exactly?  and what do you query for?  are you aware of role: vs roles: ?
[2014-05-21 14:40:43 -0400] daos: hmm
[2014-05-21 14:40:57 -0400] daos: srenatus: i am not aware of role vs roles
[2014-05-21 14:41:06 -0400] daos: i did 'knife ssh "role:$role" "$cmd"
[2014-05-21 14:42:22 -0400] daos: what is the difference?
[2014-05-21 14:43:09 -0400] srenatus: daos: try "knife search '*:*' -a roles -a role"
[2014-05-21 14:43:56 -0400] srenatus: roles: is the expanded role list, e.g. if you have run_list role[foo] and role[foo] expands to recipe[foo], role[bar]; then role should be foo; and roles: foo, bar
[2014-05-21 14:44:13 -0400] srenatus: plus some of these might only be written to the chef server on a node.save, this could have hit you
[2014-05-21 14:44:25 -0400] srenatus: daos: if you can, just do another chef run, maybe your query will work then
[2014-05-21 14:44:46 -0400] daos: srenatus: many chef-runs have completed since the nodes have been moved to the different role
[2014-05-21 14:45:11 -0400] srenatus: hm
[2014-05-21 14:45:31 -0400] daos: node.save is interestign
[2014-05-21 14:45:42 -0400] daos: i'm going to try it on an example node and see if i can get it returning
[2014-05-21 14:45:58 -0400] daos: do you know if i can run that in chef-shell ?
[2014-05-21 14:46:57 -0400] gchristensen: IIRC, node.save is generally good to avoid
[2014-05-21 14:48:26 -0400] brauliobo_: hello all, I can't create a postgresql user, I get the error: Peer authentication failed for user "postgres"
[2014-05-21 14:48:38 -0400] srenatus: daos: you can, but you might not want to, as gchristensen said
[2014-05-21 14:49:02 -0400] srenatus: daos: in chef-shell, your node object only resembles something you'd want to have on the chef server when your run there was successful
[2014-05-21 14:49:03 -0400] daos: ok
[2014-05-21 14:49:08 -0400] srenatus: daos: but then, you might just do a chef run
[2014-05-21 14:49:33 -0400] srenatus: did you examine role: and roles: ? what are they set to?
[2014-05-21 14:50:56 -0400] brauliobo_: is there a way to run postgresql_database_user using the user postgres?
[2014-05-21 14:51:06 -0400] brauliobo_: that is, is there a way to run a resource using another user
[2014-05-21 14:55:39 -0400] daos: srenatus: here's an exmple: Roles:       base, bttf-prod
[2014-05-21 14:55:47 -0400] daos: so i'm trying to search by 'bttf-prod'
[2014-05-21 14:56:02 -0400] daos: eg: knife ssh "roles:bttf-prod" "hostname"
[2014-05-21 14:58:24 -0400] srenatus: daos: knife ssh is actually just doing an ssh to the fqdn of the nodes that are returned by knife search, so "knife search roles:bttf-prod" is empty, I guess?
[2014-05-21 14:59:56 -0400] daos: checking
[2014-05-21 15:00:31 -0400] daos: nope it returns all of the nodes that i expect!
[2014-05-21 15:00:43 -0400] daos: now i'm really confused :)
[2014-05-21 15:01:12 -0400] geofflan: I'm using chef via amazon OpsWorks. How can I make it download the latest version of php instead of the default 5.3.10? I'd like to get 5.5.10 (or better)
[2014-05-21 15:02:55 -0400] geofflan: * my instance is running on ubuntu
[2014-05-21 15:12:09 -0400] daos: srenatus: did you see above?
[2014-05-21 15:12:49 -0400] joshua__: Hola, am assuming that the chef service for windows clients doesn't do any sort of log rotation right?
[2014-05-21 15:14:06 -0400] daos: srenatus: is it possible that even though I updated the runlist (knofe node run_list remove ... && knife node run_list add ...) the roles (according to `knife node show ...`) are still old?
[2014-05-21 15:14:39 -0400] daos: i'm seeing weird discrepancies such as: Run List: role[foo] and then below Roles: bar
[2014-05-21 15:15:19 -0400] dagan: daos: have you tried chef-server-ctl reindex. I think it does the samething as knife reindex, but worth a shot
[2014-05-21 15:15:27 -0400] daos: dagan: nope i haven't
[2014-05-21 15:15:30 -0400] daos: i'll try that now thanks for the tip
[2014-05-21 15:15:36 -0400] srenatus: daos: weird, that search/ssh discrepancy
[2014-05-21 15:15:49 -0400] daos: trying a reindex now
[2014-05-21 15:15:53 -0400] daos: should that be on a cronjob?
[2014-05-21 15:15:58 -0400] dagan: I dont' think so
[2014-05-21 15:16:23 -0400] daos: reindexed--checking now
[2014-05-21 15:17:14 -0400] daos: ok now that everything is reindexed knife search is returning no data
[2014-05-21 15:17:28 -0400] dagan: Well, at least it's consistent now.
[2014-05-21 15:17:29 -0400] dagan: :-)
[2014-05-21 15:18:45 -0400] dagan: daos: even a knife search node '*'?
[2014-05-21 15:19:05 -0400] daos: trying that now
[2014-05-21 15:19:11 -0400] daos: that works
[2014-05-21 15:19:21 -0400] dagan: So it's just the role?
[2014-05-21 15:19:44 -0400] dagan: what about knife search 'role:*'
[2014-05-21 15:20:08 -0400] daos: returns all
[2014-05-21 15:20:18 -0400] dagan: What about any other role?
[2014-05-21 15:20:24 -0400] daos: ...
[2014-05-21 15:20:25 -0400] daos: it's working now
[2014-05-21 15:20:29 -0400] daos: the search is
[2014-05-21 15:20:36 -0400] dagan: k, so now ssh
[2014-05-21 15:20:57 -0400] daos: trying now
[2014-05-21 15:21:17 -0400] daos: still nothign!
[2014-05-21 15:21:21 -0400] daos: knife ssh 'role:bttf-prod' 'hostname'
[2014-05-21 15:21:24 -0400] daos: returns my hostname
[2014-05-21 15:22:31 -0400] srenatus: daos: can you do "knife ssh QUERY -a ipaddress -- hostname" ?
[2014-05-21 15:23:54 -0400] morgajel_: hi guys, I'm looking to give chef a try, but I'm having a hell of a time getting set up. end goal for this is ubuntu workstation, centos server, and windows node. right now "sudo chef-server-ctl reconfigure" is failing and I can't figure out why
[2014-05-21 15:24:28 -0400] daos: srenatus: trying
[2014-05-21 15:25:16 -0400] iartarisi: Hi! I was wondering how everyone is handling the move to heavywater for opscode cookbooks maintainership? e.g. for database, postgresql. Heavywater seem to be very unresponsive. Has everyone just forked their own or are there some new upstreams established for these cookbooks?
[2014-05-21 15:25:41 -0400] daos: srenatus: ah that won't work
[2014-05-21 15:25:50 -0400] daos: srenatus: the IP addresses that those nodes spun up w/ are stale
[2014-05-21 15:25:58 -0400] daos: srenatus: and i'm not sure how to update them :)
[2014-05-21 15:26:06 -0400] daos: they should be able to connect via the FQDN
[2014-05-21 15:27:15 -0400] srenatus: daos: just wondering since it gives you _your_ hostname...
[2014-05-21 15:27:43 -0400] daos: yeah
[2014-05-21 15:27:59 -0400] daos: it's just executing the given command locally
[2014-05-21 15:28:01 -0400] srenatus: morgajel_: when you start out, just use hosted chef's five free nodes...
[2014-05-21 15:28:15 -0400] daos: instead of on the roles specificed in the QUERY
[2014-05-21 15:28:38 -0400] dagan: daos: What's the FQDN of the target node(s)?
[2014-05-21 15:28:52 -0400] srenatus: daos: tried to increase debugging?  the fact that it outputs anything seems to me like it was connecting somewhere.  are you able to ssh yourself, 127.0.0.1 ..?
[2014-05-21 15:28:54 -0400] dagan: Specifally, is it resolvable fro the chef server?
[2014-05-21 15:29:07 -0400] daos: dagan: definitely
[2014-05-21 15:29:11 -0400] daos: they are all publicly accessible
[2014-05-21 15:29:22 -0400] dagan: But is the registered FQDN accurate?
[2014-05-21 15:29:40 -0400] dagan: What happens if you ping it from your box?
[2014-05-21 15:29:45 -0400] daos: i drop ICMP
[2014-05-21 15:29:49 -0400] daos: but I can ssh
[2014-05-21 15:30:13 -0400] dagan: so if you get the node(s), chef has the correct fqdn?
[2014-05-21 15:30:19 -0400] daos: yes
[2014-05-21 15:30:20 -0400] daos: 100%
[2014-05-21 15:30:23 -0400] dagan: k
[2014-05-21 15:34:01 -0400] morgajel_: srenatus: unfortunately I can't take that shortcut
[2014-05-21 15:34:54 -0400] zr2d2: I'm trying to deploy a django app, but when i try and use the application_python cookbook, i get errors. does anyone use the application and django lwrp
[2014-05-21 15:34:58 -0400] zr2d2: ?
[2014-05-21 15:36:36 -0400] srenatus: daos: try adding -V
[2014-05-21 15:36:42 -0400] srenatus: aehm, -VV
[2014-05-21 15:36:50 -0400] srenatus: lots of output, but...
[2014-05-21 15:36:56 -0400] daos: ok to the `knife ssh`?
[2014-05-21 15:37:03 -0400] srenatus: yepp
[2014-05-21 15:37:26 -0400] srenatus: hmm not that useful sorry
[2014-05-21 15:37:47 -0400] daos: srenatus: slight update: this is not limited to a 'node' search. i'm experiencing the same issue with `knife ssh 'name:$node_name' '$command'`
[2014-05-21 15:37:54 -0400] daos: i'll pastebin
[2014-05-21 15:38:30 -0400] zr2d2: when i add the django sub-resource lwrp, it skips with action :nothing
[2014-05-21 15:38:37 -0400] zr2d2: * application_python_django[demo] action nothing (skipped due to action :nothing)
[2014-05-21 15:42:05 -0400] daos: srenatus: https://gist.github.com/malbin/a5219de9fbfc497bf746
[2014-05-21 15:42:16 -0400] daos: the command was `knife ssh 'name:eur-x4' 'hostname'
[2014-05-21 15:42:22 -0400] daos: the output was 'jah.duckduckgo.com' (my node)
[2014-05-21 15:43:34 -0400] zr2d2: my recipe is here: https://gist.github.com/zr2d2/f36e4190d92c8be9a862
[2014-05-21 15:44:20 -0400] srenatus: daos: you're with ddg? cool. great.
[2014-05-21 15:44:40 -0400] daos: :D
[2014-05-21 15:44:45 -0400] daos: haha yeah
[2014-05-21 15:45:03 -0400] srenatus: keep it up :)
[2014-05-21 15:45:11 -0400] daos: thanks m8
[2014-05-21 15:45:16 -0400] gchristensen: daos: is it actually as private as we're lead to believe?
[2014-05-21 15:45:26 -0400] daos: yes
[2014-05-21 15:45:27 -0400] srenatus: so, you're really connecting to your node but you see your workstation's hostname
[2014-05-21 15:45:33 -0400] gchristensen: daos: sweet
[2014-05-21 15:45:53 -0400] joshua__: People managing windows boxes with chef: what are you using for log rotation?
[2014-05-21 15:46:06 -0400] daos: srenatus: where do you see it connecting to the specified node?
[2014-05-21 15:46:20 -0400] srenatus: daos: I dont... can't be like that after all
[2014-05-21 15:46:30 -0400] daos: i read that as it is actually ssh'ing to my local node
[2014-05-21 15:46:37 -0400] gchristensen: joshua__: I have a coworker that doesn't rotate logs and just reimages when their disks fill up. ... its terrible, but he does.
[2014-05-21 15:46:52 -0400] joshua__: gchristensen: jesus
[2014-05-21 15:46:52 -0400] srenatus: daos: https://gist.github.com/malbin/a5219de9fbfc497bf746#file-gistfile1-txt-L32 <<
[2014-05-21 15:47:07 -0400] daos: right but i think that's my workstation
[2014-05-21 15:47:10 -0400] srenatus: but well, that doesn't help...
[2014-05-21 15:47:13 -0400] srenatus: why...
[2014-05-21 15:47:50 -0400] srenatus: daos: https://github.com/opscode/chef/blob/master/lib/chef/knife/ssh.rb#L174-L180  can you check these?
[2014-05-21 15:47:53 -0400] daos: because it's running the command on my machine
[2014-05-21 15:48:26 -0400] srenatus: daos: when node['cloud'] is set, it will connect to node[:cloud][:public_hostname]
[2014-05-21 15:48:36 -0400] srenatus: daos: which could be the problem, ie. something that resolves to your machine
[2014-05-21 15:48:54 -0400] daos: i should check node['cloud'] on the remote node?
[2014-05-21 15:49:12 -0400] srenatus: daos: yep
[2014-05-21 15:49:21 -0400] srenatus: knife node show ... -a cloud.public_hostname
[2014-05-21 15:49:43 -0400] daos: ah
[2014-05-21 15:49:45 -0400] daos: it's set
[2014-05-21 15:49:49 -0400] srenatus: ...to?
[2014-05-21 15:49:51 -0400] srenatus: *drumroll*
[2014-05-21 15:50:06 -0400] daos: nada
[2014-05-21 15:50:07 -0400] zr2d2: any help for a noob like me?
[2014-05-21 15:50:13 -0400] daos: va-xl1: cloud.public_hostname:
[2014-05-21 15:50:19 -0400] daos: wtf
[2014-05-21 15:50:21 -0400] srenatus: daos: hmm
[2014-05-21 15:50:26 -0400] daos: literally blank
[2014-05-21 15:50:42 -0400] srenatus: but cloud is true?  well, it's ec2, I guess, you could check ohai's output
[2014-05-21 15:50:48 -0400] daos: yeah
[2014-05-21 15:50:49 -0400] srenatus: "ohai | less" on the node, looking for cloud
[2014-05-21 15:51:08 -0400] daos: i just did node['cloud'] in chef-shell
[2014-05-21 15:51:13 -0400] daos: if you want i can give you that output
[2014-05-21 15:51:32 -0400] srenatus: daos: ok
[2014-05-21 15:51:56 -0400] srenatus: it makes you wonder, though, public_hostname being empty leading to a proper ssh connection?
[2014-05-21 15:51:57 -0400] gyre007_: anyone here actually does something with Chef on windows ?
[2014-05-21 15:52:26 -0400] gyre007_: im trying to bootstrap chef on a 2008r2 server machine
[2014-05-21 15:52:28 -0400] daos: srenatus: https://gist.github.com/malbin/a5219de9fbfc497bf746
[2014-05-21 15:52:50 -0400] gyre007_: after fighting knife-windows which is full of bugs and fixing them locally I managed to get as far as this https://gist.github.com/milosgajdos83/1916a134b578bf0eadd0
[2014-05-21 15:53:24 -0400] gyre007_: looks like some windows awesomeness is failing to create a file ..
[2014-05-21 15:53:30 -0400] gyre007_: anyone has come across something like this ?
[2014-05-21 15:53:41 -0400] srenatus: daos: ohai's ec2 metadata plugin doesn't produce a public_hostname attribute: https://github.com/opscode/ohai/blob/master/lib/ohai/mixin/ec2_metadata.rb
[2014-05-21 15:54:04 -0400] daos: srenatus: interesting 1 sec on the phone
[2014-05-21 15:54:05 -0400] srenatus: daos: it might be best to just add "-a fqdn" to the "knife ssh", e.g. knife ssh QUERY -a fqdn -- hotname"
[2014-05-21 15:54:09 -0400] srenatus: haha, hostname.
[2014-05-21 16:00:10 -0400] zr2d2: anyone use the django sub_resource to deploy django apps?
[2014-05-21 16:01:56 -0400] daos: srenatus: sorry--back
[2014-05-21 16:02:06 -0400] srenatus: daos: I was a bit too quick claiming that ohai's ec2 plugin doesn't provide that metadata snippet.  (I was just grepping the mixin source... it actually eats every key/val it is given, I think)  You'd have to check it yourself from the instance, i.e. 'curl -v http://169.254.169.254/', just check latest...
[2014-05-21 16:04:23 -0400] daos: srenatus: hostname is wrong there
[2014-05-21 16:05:03 -0400] srenatus: daos: wrong as in empty-string?
[2014-05-21 16:05:03 -0400] daos: https://gist.github.com/malbin/a5219de9fbfc497bf746
[2014-05-21 16:05:59 -0400] daos: wrong as in the default amazon hostname never got changed
[2014-05-21 16:06:51 -0400] dgarstang: hif anyone is thinking of using the community mongodb cookbook for sharding, it's broken.
[2014-05-21 16:06:59 -0400] jblack: oh?
[2014-05-21 16:07:16 -0400] srenatus: daos: you can override (-a) from the knife.rb, https://github.com/opscode/chef/blob/master/lib/chef/knife/ssh.rb#L411
[2014-05-21 16:07:37 -0400] srenatus: daos: so if you just add knife[:ssh_attribute] = 'fqdn' in your knife.rb, you might be fine
[2014-05-21 16:07:49 -0400] dgarstang: jblack: moi?
[2014-05-21 16:07:53 -0400] srenatus: regardless of what ec2 metadata gives your ohai, hence your chef-server...
[2014-05-21 16:08:02 -0400] daos: srenatus: interesting--going to try that now
[2014-05-21 16:08:03 -0400] jblack: dgarstang: youi!
[2014-05-21 16:08:09 -0400] zr2d2: is there a better place to ask for chef help?
[2014-05-21 16:08:16 -0400] dgarstang: jblack: chttps://github.com/edelight/chef-mongodb/issues/297 ...
[2014-05-21 16:09:08 -0400] srenatus: daos: gtg, sorry. good luck
[2014-05-21 16:09:17 -0400] daos: srenatus: np thanks very much for the help!
[2014-05-21 16:09:40 -0400] srenatus: :) your welcome
[2014-05-21 16:09:45 -0400] srenatus: s/your/you're/ haha
[2014-05-21 16:09:45 -0400] daos: srenatus: that's it
[2014-05-21 16:09:48 -0400] daos: you solved it
[2014-05-21 16:09:54 -0400] daos: thank you!
[2014-05-21 16:09:57 -0400] jblack: dgarstang: that looks facepalm bad.
[2014-05-21 16:09:58 -0400] dgarstang: jblack: cant imagine why passing incorect shard name is by design, or how they could claim the cookbook supports sharding when that's obviously broken
[2014-05-21 16:10:12 -0400] jblack: I read it as "by misdesign"
[2014-05-21 16:10:13 -0400] dgarstang: very
[2014-05-21 16:10:47 -0400] dgarstang: heh. An update to the readme saying 'Sharding doesn't work becase ....' would have been REALLY nice to know.
[2014-05-21 16:12:38 -0400] jblack: This looks awesome: http://community.opscode.com/cookbooks/gluster
[2014-05-21 16:13:36 -0400] jblack: https://github.com/biola/chef-cookbooks/tree/master/gluster looks better
[2014-05-21 16:19:24 -0400] daos: hopping out for awhile
[2014-05-21 16:19:38 -0400] daos: thanks again srenatus and dagan
[2014-05-21 16:22:44 -0400] xeno: So, is it necessary to install with omnibus to a client before doing knife bootstrap for that client from the ws, or not?
[2014-05-21 16:22:59 -0400] jblack: no, it's not.
[2014-05-21 16:23:06 -0400] jblack: knife bootstrap will do an omnibus install for you
[2014-05-21 16:25:29 -0400] xeno: Ok.  Thank you.  So, if I don't see chef daemons on a client, and omnibus install native fails for me, and it is late model Ubuntu 64bit, is this a known problem, or should I just reboot and try again, or let's say reboot andn try bootstrap.
[2014-05-21 16:26:06 -0400] take_it_t: hey guys, using chef solo with vagrant for development. whats the most ideal way for handling secrets? encrypted data bags? reading a bunch of env variables to the vagrantfile? using chef-client with a server instead?
[2014-05-21 16:26:50 -0400] jidar: http://jtimberman.housepub.org/blog/2013/09/10/managing-secrets-with-chef-vault/
[2014-05-21 16:27:15 -0400] xeno:   to file /tmp/install.sh.1069/chef_11.12.4-1_amd64.deb trying wget...
[2014-05-21 16:27:21 -0400] xeno: That's where it blocks forever.
[2014-05-21 16:27:22 -0400] dgarstang: jidar: if your on ec2 (exclusively) https://github.com/balanced-cookbooks/citadel
[2014-05-21 16:27:30 -0400] xeno: The rest of my networking commands seemm to work fine.
[2014-05-21 16:28:10 -0400] xeno: Never mind.  This time it did it.
[2014-05-21 16:39:24 -0400] kbarry: Looking for some guidance on adding domain accounts to a windows box with chef.
[2014-05-21 16:39:43 -0400] kbarry: I "Think" its possible with the  "user" resource, but I was hoping for some examples?
[2014-05-21 16:51:15 -0400] shlant: anyone know how to rerun chef on ec2 if the initial bootstrap fails?
[2014-05-21 16:56:19 -0400] gyre007_: is there any way I can force SSH bootstrap over WINRM bootstrap on windows machine via knife ec2 ??
[2014-05-21 16:56:34 -0400] gyre007_: by default it seems to be using winrm
[2014-05-21 16:56:52 -0400] brauliobo_: I need to declare an init.d service and the init.d file is created using a template. the problem is that for some reason the template isn't being created and so the service can't find it. how to create a template before service resource is run?
[2014-05-21 16:57:41 -0400] whiteadam: mattray: Haven't seen you since breakfast. Did I miss anything?
[2014-05-21 16:57:42 -0400] double_p: brauliobo_: "notify" the service from the template
[2014-05-21 16:58:14 -0400] mattray: whiteadam: slowly running out of caffeine from the N cups of coffee I drank
[2014-05-21 16:58:26 -0400] whiteadam: mattray: n+1 that problem
[2014-05-21 16:58:46 -0400] brauliobo_: double_p: On the template dsl I have: notifies :restart, "service[#{node[:noosfero][:service_name]}]"
[2014-05-21 16:59:05 -0400] brauliobo_: double_p: and on the service I only have: action :enable
[2014-05-21 16:59:23 -0400] brauliobo_: the 'template "/etc/init.d/#{node[:noosfero][:service_name]}" do ' comes before 'service node[:noosfero][:service_name] do '
[2014-05-21 16:59:25 -0400] double_p: well, duh
[2014-05-21 16:59:52 -0400] brauliobo_: double_p: ?
[2014-05-21 17:01:17 -0400] whiteadam: Anyone know of an open source way to do "file integrity monitoring" ?
[2014-05-21 17:01:47 -0400] double_p: brauliobo_: before? in the same recipe?
[2014-05-21 17:01:57 -0400] brauliobo_: yeah, in the same recipe
[2014-05-21 17:02:02 -0400] brauliobo_: i'm gonna to commit the file
[2014-05-21 17:02:58 -0400] double_p: the notation is a bit weird to me, but might be valid.. some more senior should judge that
[2014-05-21 17:04:11 -0400] brauliobo_: double_p: here it is: https://github.com/coletivoEITA/noosfero-cookbook/blob/master/recipes/init.rb
[2014-05-21 17:04:28 -0400] chefNOOB: hi Chef usrs how are we
[2014-05-21 17:04:40 -0400] whiteadam: I just pooped, so I'm great
[2014-05-21 17:04:59 -0400] double_p: brauliobo_: i cannot help, sorry
[2014-05-21 17:05:13 -0400] chefNOOB: Needing some help with setting up SSH cert between two of my computers one is my ubuntu box one is my win32 box
[2014-05-21 17:05:16 -0400] brauliobo_: double_p: ok, thanks
[2014-05-21 17:05:45 -0400] whiteadam: chefNOOB: What's the problem?
[2014-05-21 17:06:14 -0400] chefNOOB: basically want it to use verify_api_cert and setting it to :verify_peer, but im unsure what this is actually checking for
[2014-05-21 17:06:40 -0400] cheeseplus: whiteadam: http://aide.sourceforge.net/
[2014-05-21 17:08:08 -0400] dgarstang: chefNOOB: Ditto
[2014-05-21 17:08:12 -0400] whiteadam: cheeseplus: Thanks, it doesn't looked actively developed... I thought of just using Guard in ruby and throwing the notify to syslog
[2014-05-21 17:08:40 -0400] cheeseplus: whiteadam: yea we used that at a university, there are others like it but it's been a bit since i've looked
[2014-05-21 17:13:02 -0400] mattray: whiteadam: https://github.com/jtimberman/ossec-cookbook
[2014-05-21 17:15:25 -0400] whiteadam: mattray: Yeah, I was just reading about OSSEC
[2014-05-21 17:17:41 -0400] chefNOOB: guys?
[2014-05-21 17:19:04 -0400] NukePuppy: chefNOOB what about it?
[2014-05-21 17:19:06 -0400] NukePuppy: you need keys?
[2014-05-21 17:19:19 -0400] NukePuppy: SSH keys?
[2014-05-21 17:19:23 -0400] chefNOOB: any guidance on this one?
[2014-05-21 17:19:32 -0400] NukePuppy: http://arbib.it/tag/shortest-passwordless-ssh-tutorial/
[2014-05-21 17:19:34 -0400] NukePuppy: try that.. :)
[2014-05-21 17:19:39 -0400] NukePuppy: im assuming it is what you want
[2014-05-21 17:19:40 -0400] chefNOOB: yea, not sure how to create them between windows and linux
[2014-05-21 17:20:00 -0400] chefNOOB: is that what verify_peer is looking for?
[2014-05-21 17:20:01 -0400] NukePuppy: oh i see..  can you say what you need more specifically?
[2014-05-21 17:20:04 -0400] NukePuppy: no -.-
[2014-05-21 17:20:08 -0400] NukePuppy: you said SSH so...
[2014-05-21 17:20:14 -0400] saintish: Morning folks. Quick question, hopefully it's not too dumb: When a chef recipe runs, how..exactly does it get interpreted? Does the chef-client basically translate recipes to ruby code, and pass it to the ruby interpreter, or does the chef daemon itself do all of the ruby interpretation stuff? I'm thinking it's the latter, but I wanted to be sure.
[2014-05-21 17:20:25 -0400] NukePuppy: guessing you meant SSL :(
[2014-05-21 17:25:32 -0400] shlant: coderanger: I getting "Unable to load secrets from S3, no S3 credentials found" with citadel even though it's on ec2
[2014-05-21 17:28:38 -0400] shlant: how do I attach a role to an ec2 instance
[2014-05-21 17:29:45 -0400] mattupstate: shlant: you dont add a role to an ec2 instance, per say
[2014-05-21 17:29:50 -0400] mattupstate: you add a role to a node
[2014-05-21 17:30:02 -0400] mattupstate: by adding "role[role_name]" to the node's run list
[2014-05-21 17:31:33 -0400] shlant: mattupstate:  I'm taking about IAM roles. I think I found the flag
[2014-05-21 17:31:51 -0400] shlant: --iam-profile
[2014-05-21 17:33:29 -0400] mattupstate: well thats not chef related ;-)
[2014-05-21 17:35:32 -0400] zr2d2: coderanger: when using the application lwrp, do sub_resorces like django disable it?
[2014-05-21 17:43:52 -0400] bencaron: is there a way to find which Chef admin uploaded a specific version of a cookbook on the server?
[2014-05-21 17:44:08 -0400] bencaron: grepping the logs return so much noise
[2014-05-21 17:47:24 -0400] brauliobo_: bencaron: berksshelf wouldn't assure that?
[2014-05-21 17:48:07 -0400] bencaron: so far, berkshelf is more often then not the one that upload things that should not...
[2014-05-21 17:48:21 -0400] bencaron: we have a few cookbooks forked from community
[2014-05-21 17:48:28 -0400] bencaron: with some patches
[2014-05-21 17:48:58 -0400] bencaron: what happens is that the berks setup of somebody is uploading the version from community instead of our own
[2014-05-21 17:49:07 -0400] brauliobo_: bencaron: me too, i get you, but I'm afraid I don't know how to find that out
[2014-05-21 17:49:32 -0400] bencaron: i was hoping to find a trace in erchef.log.* but nothing so far
[2014-05-21 17:49:43 -0400] bencaron: ah well
[2014-05-21 17:50:01 -0400] bencaron: I'll yell in our hipchat ;)
[2014-05-21 17:50:10 -0400] bencaron: thx brauliobo_
[2014-05-21 17:56:24 -0400] coderanger: zr2d2: Not sure what you mean
[2014-05-21 18:02:02 -0400] zr2d2: coderang, actually, it looks like it's the subresource
[2014-05-21 18:02:39 -0400] zr2d2: application_python_django[demo] action nothing (skipped due to action :nothing)
[2014-05-21 18:05:26 -0400] shlant: coderanger: any way to rerun chef after a failed knife ec2 server create?
[2014-05-21 18:05:44 -0400] shlant: do I have to run a seperate bootstrap?
[2014-05-21 18:06:04 -0400] coderanger: zr2d2: Yeah, the subresources aren't converged like normal resources, they are used as callbacks effectively
[2014-05-21 18:06:11 -0400] coderanger: shlant: Yeah, just run the bootstrap yourself
[2014-05-21 18:06:35 -0400] shlant: coderanger: ew
[2014-05-21 18:06:41 -0400] shlant: what a PITA
[2014-05-21 18:07:24 -0400] coderanger: shlant: All ec2 server create does is fog.create + knife bootstrap
[2014-05-21 18:08:01 -0400] zr2d2: coderanger: so how late do i need to run it? Is there a recomended callback to use? after_migrate?
[2014-05-21 18:08:15 -0400] coderanger: zr2d2: Again, not sure what you mean
[2014-05-21 18:08:26 -0400] coderanger: You don't run them, the application framework does
[2014-05-21 18:09:05 -0400] zr2d2: you can specify which callback to use, though
[2014-05-21 18:11:25 -0400] coderanger: zr2d2: No, thats just part of the subresource
[2014-05-21 18:11:50 -0400] coderanger: All of the app* subresources implement all the callback hooks, they have to, some are just just noops
[2014-05-21 18:12:04 -0400] zr2d2: then what does the action attribute do on the subresource?
[2014-05-21 18:12:16 -0400] coderanger: You don't, they don't have actions like a normal chef resource
[2014-05-21 18:12:36 -0400] coderanger: Its a terribad design that will hopefully be corrected soon
[2014-05-21 18:12:49 -0400] zr2d2: oh, alright
[2014-05-21 18:12:55 -0400] coderanger: basically the deploy resource is really bad and basing on it was a huge mistake
[2014-05-21 18:15:23 -0400] zr2d2: coderangerso i can't delay the gunicorn subresorce?
[2014-05-21 18:15:31 -0400] coderanger: delay?
[2014-05-21 18:16:07 -0400] zr2d2: it's looking for a folder that doesn't exist
[2014-05-21 18:16:44 -0400] imduffy15: Hi all. What is the best/most-correct way of downloading/executing a remote script and discarding it when the recipe is finished?
[2014-05-21 18:18:01 -0400] zr2d2: coderanger: that folder gets created by the django subresorce when i comment out the gunicorn subreource
[2014-05-21 18:18:30 -0400] zr2d2: i guess i can't use the subresource, then
[2014-05-21 18:21:08 -0400] bobdobalina: hey all, quick one, is it clean and best practice to have an 'include_recipe' inside a ruby block if statement?
[2014-05-21 18:21:56 -0400] bobdobalina: as in, only execute the recipe if <file> does not exist
[2014-05-21 18:26:06 -0400] davidordave: @bobdobalina, I don't think you want an include_recipe in a ruby block. Pretty sure the compile converge phases would mess you up.
[2014-05-21 18:27:32 -0400] tier: is there a standard to follow regarding version control of cookbooks? as i'm just getting started with chef it makes sense to version the chef-repo but then individual cookbooks should be versioned as well. should they be treated as git submodules for instance or is there a better way?
[2014-05-21 18:32:07 -0400] mattupstate: tier: i wouldn't bother with submodules, but your organization's cookbooks should each have their own repository
[2014-05-21 18:33:59 -0400] tier: fair enough. looking at the new chef-dk it seems like the chef-repo concept kinda goes by the wayside though where you can use chef generate app to create an app specific repo of sorts
[2014-05-21 18:35:43 -0400] mattupstate: i have a chef repo, but its strictly for data bags, environment(s), and role(s)
[2014-05-21 18:36:34 -0400] tier: using berks for your cookbooks then?
[2014-05-21 18:36:53 -0400] stuarte: Im also finding the chef-repo a useful place to stash utility scripts as well
[2014-05-21 18:37:37 -0400] kallistec: tier: BTW, the 'app' thing is a bit of an experiment. Where we're going is to focus your development efforts around creating a collection of cookbooks that you develop, test, and "deploy" as a unit. The 'app' layout is the beginning of an attempt to find a file system layout that reflects this "artifact-centric" concept
[2014-05-21 18:38:23 -0400] mattupstate: tier: yes
[2014-05-21 18:38:35 -0400] mattupstate: stuarte: i have a few as well
[2014-05-21 18:39:35 -0400] tier: kallistec: that makes sense then. just trying to get a feel for where things are going i guess.
[2014-05-21 18:41:06 -0400] kallistec: tier: yep. just want to be clear that the 'app' layout isn't 100% a finished product and we're gonna need to get some of the code around it working before we know if it's good or not
[2014-05-21 18:45:48 -0400] jblack: has anyone tried installing sql-server enterprise via  chef?
[2014-05-21 18:51:15 -0400] bobdobalina: thanks david, just saw your reply
[2014-05-21 18:51:47 -0400] dgarstang: *sigh* I wish there was a functional community cookbook for mongo.
[2014-05-21 18:52:04 -0400] dgarstang: jblack: y u crazy?
[2014-05-21 18:52:33 -0400] jblack: no. I'm just not paid to do the easy stuff. :p
[2014-05-21 18:53:15 -0400] tcotav: looks like it supports unattended.  that's good news :D
[2014-05-21 18:54:06 -0400] kennon:  jblack: https://github.com/opscode-cookbooks/sql_server ?
[2014-05-21 18:54:21 -0400] jblack: Yup. Found that on msdn. And I just found http://community.opscode.com/cookbooks/isomounter
[2014-05-21 18:55:05 -0400] tcotav: you are 90% of the way to creating the OFFICIAL ms sqlserver cookbook!
[2014-05-21 18:55:24 -0400] tcotav: the last 10% will presumably be powershell
[2014-05-21 18:55:33 -0400] jblack: the other 10% is the loaded gun that I left back at home
[2014-05-21 18:55:39 -0400] kbarry: hahahaha
[2014-05-21 18:56:26 -0400] rayrod2030: invention is 1% inspiration and 99% shell scripts.
[2014-05-21 18:56:28 -0400] shlant: coderanger: any reason why I'm getting "could not read Username for 'https://github.com': No such device or address" for this? https://gist.github.com/MrMMorris/afb717be730e1c4c8c65
[2014-05-21 18:56:34 -0400] shlant: is it not suing the deploy_key?
[2014-05-21 18:56:41 -0400] kbarry: Got disconnected earlier, but was asking: How are you adding domain accounts to local groups (Like a domain administrator account as a member of the local administrators group)
[2014-05-21 18:57:58 -0400] jblack: ffs, isomounter isn't a standalone repo. it's inside of a cookbooks repo
[2014-05-21 18:59:16 -0400] rayrod2030: jblack: you can still reference it from withing a Berksfile
[2014-05-21 18:59:27 -0400] jblack: Oh? NICE
[2014-05-21 18:59:28 -0400] rayrod2030: but yeah makes it a pain to fork
[2014-05-21 18:59:47 -0400] rayrod2030: cookbook "rightscale", git: "https://github.com/rightscale/rightscale_cookbooks.git", rel: "cookbooks/rightscale"
[2014-05-21 19:00:10 -0400] jblack: That's very close to what I ened. THanks Ray!
[2014-05-21 19:00:17 -0400] rayrod2030: np
[2014-05-21 19:01:26 -0400] jblack: he has other goodies too
[2014-05-21 19:19:08 -0400] joshua__: anyone in here using the git resource on windows nodes?
[2014-05-21 19:24:00 -0400] bobdobalina: i'm back again guys, after some more best practice tips
[2014-05-21 19:24:31 -0400] bobdobalina: in my wrapper cookbook for nginx, it seems to download the nginx source everytime i run chef-client on a node
[2014-05-21 19:24:44 -0400] bobdobalina: what's the best condition to prevent this ?
[2014-05-21 19:27:09 -0400] NukePuppy: not_if (something like /usr/sbin/nginx or whatever)   though i dont use the nginx from ospcode :(
[2014-05-21 19:27:23 -0400] bobdobalina: can i use that for a recipe?
[2014-05-21 19:27:34 -0400] bobdobalina: someone said it breaks the converge
[2014-05-21 19:28:10 -0400] NukePuppy: i would of guessed that.. they would of done that already
[2014-05-21 19:28:19 -0400] NukePuppy: as in made sure it doesnt compile it everytime
[2014-05-21 19:28:29 -0400] NukePuppy: or is it just 'downloaded' everytime?
[2014-05-21 19:30:00 -0400] bobdobalina: it's cause i'm building from source and using custom modules
[2014-05-21 19:30:27 -0400] shlant: bobdobalina: are you using the nginx cookbook?
[2014-05-21 19:30:38 -0400] bobdobalina: i'm using a wrapper
[2014-05-21 19:30:48 -0400] bobdobalina: and including the nginx cookbook recipe
[2014-05-21 19:31:25 -0400] shlant: bobdobalina: because the nginx cookbook should check for previous installs: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L105-L110
[2014-05-21 19:31:38 -0400] bobdobalina: hmm
[2014-05-21 19:32:13 -0400] bobdobalina: i'll have a closer watch of what it's doing, i thought it was dl'ing and recompiling then moving on
[2014-05-21 19:32:24 -0400] bobdobalina: thanks for the link though fella
[2014-05-21 19:32:31 -0400] shlant: no problem
[2014-05-21 19:32:41 -0400] shlant: the nginx cookbook is the bain of my existence haha
[2014-05-21 19:32:43 -0400] shlant: or used to be
[2014-05-21 19:33:05 -0400] bobdobalina: hahah
[2014-05-21 19:33:17 -0400] bobdobalina: i could have done wth speaking to you a while back then
[2014-05-21 19:33:50 -0400] bobdobalina: but i'm good now, install works, custom modules, encrypted bags for ssl certs and some other custom stuff
[2014-05-21 19:35:12 -0400] bobdobalina: i'm just reworking teh wrapper now and role to sort out ntp , log rotation and clean up the dirs
[2014-05-21 19:36:17 -0400] bobdobalina: one other thing i'm not that clear on is use of variables, at the moment i'm doing the dirty stuff like "path "/opt/nginx-1.x.x"
[2014-05-21 19:36:37 -0400] joshua__: set that in attributes bobdobalina
[2014-05-21 19:36:41 -0400] bobdobalina: i'd like to put that version into a var and reuse in my recipe, should this go into attributes?
[2014-05-21 19:36:51 -0400] bobdobalina: kk , can i make up any crap i like and use it?
[2014-05-21 19:37:11 -0400] joshua__: any crap you like
[2014-05-21 19:37:53 -0400] bobdobalina: can you give me an example of the format? do I start with node.
[2014-05-21 19:38:17 -0400] joshua__: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2014-05-21 19:38:28 -0400] joshua__: Have a look at community cookbooks, there are plenty of good example around..
[2014-05-21 19:38:32 -0400] bobdobalina: ok ta
[2014-05-21 19:38:33 -0400] dgarstang: How do I debug errors like "undefined method `>' for nil:NilClass" ?
[2014-05-21 19:38:33 -0400] joshua__: probably plenty of bad too :)
[2014-05-21 19:38:38 -0400] bobdobalina: :)
[2014-05-21 19:39:28 -0400] bobdobalina: i did look at the docs on atrributes, was just unsure as my attributes were getting ignored for nginx so i moved into a role
[2014-05-21 19:39:37 -0400] bobdobalina: and due to time i just pressed on
[2014-05-21 19:40:27 -0400] bobdobalina: in my attributes, if i define something like default['custom']['nginx_version'] = 1.4.4
[2014-05-21 19:40:45 -0400] bobdobalina: can i just re-use it in my recipes?
[2014-05-21 19:41:49 -0400] bobdobalina: apologies for the noob sounding question, i'm currently learning about 6 other things at the same time whilst building a platform that needs to be ready yesterday :)
[2014-05-21 19:42:15 -0400] bobdobalina: couldn't quite get when i should use node and whent to use default
[2014-05-21 19:43:30 -0400] shlant: dgarstang: what's the context?
[2014-05-21 19:45:40 -0400] shlant: dgarstang: usually it means a attribute isn't set
[2014-05-21 19:48:40 -0400] dgarstang: shlant: I know... the question is how to determine that attribute?
[2014-05-21 19:49:11 -0400] shlant: dgarstang: again, it depends on the context. Do you have a chef run output?
[2014-05-21 19:49:21 -0400] dgarstang: shlant: yes, hang on
[2014-05-21 19:49:44 -0400] coderanger: shlant: That sounds like an OS error, what specifically is throwing it?
[2014-05-21 19:50:29 -0400] dgarstang: shlant: http://pastebin.com/2gmnsgxB
[2014-05-21 19:50:56 -0400] shlant: coderanger: the deploy resource is complaining. It's on CentOS (Linux AMI)
[2014-05-21 19:51:01 -0400] shlant: AMI
[2014-05-21 19:51:37 -0400] coderanger: shlant: What specific line? I'm guessing its the actual git clone thats failing
[2014-05-21 19:51:58 -0400] coderanger: shlant: On a train right now so my debugging options are limited
[2014-05-21 19:52:05 -0400] dgarstang: ugh. Why do people code stuff like foo['a']['b']=bar without first checking foo['a'] exists?
[2014-05-21 19:52:31 -0400] coderanger: dgarstang: Because in node attributes, it doesn't have to
[2014-05-21 19:52:45 -0400] coderanger: dgarstang: intermediary levels are autovivified
[2014-05-21 19:52:52 -0400] dgarstang: coderanger: not what I've seen
[2014-05-21 19:53:04 -0400] dgarstang: coderanger: I've had many a time where that's caused chef to croak
[2014-05-21 19:53:25 -0400] daos: can i use knife search to find a node that has a specific item in its run list?
[2014-05-21 19:53:46 -0400] dgarstang: actually this specific example isn't node data, but anywho
[2014-05-21 19:53:53 -0400] dgarstang: shlant: *jab* :)
[2014-05-21 19:53:54 -0400] shlant: dgarstang: what is this? node[mongo-shard-s1-n1.prod.footest.com]
[2014-05-21 19:54:06 -0400] dgarstang: shlant: it's a node...
[2014-05-21 19:54:21 -0400] shlant: can you check that it exists? log node[mongo-shard-s1-n1.prod.footest.com]
[2014-05-21 19:54:46 -0400] coderanger: dgarstang: How often am I wrong? ;-)
[2014-05-21 19:54:47 -0400] coderanger: daos: Yes, is it a role or recipe?
[2014-05-21 19:54:53 -0400] dgarstang: shlant: good thing I forked the cookbook, so I suppose I can add log statements. impossible without. it does open with a knife edit btw
[2014-05-21 19:54:58 -0400] daos: coderanger: recipe
[2014-05-21 19:55:26 -0400] coderanger: daos: knife search 'recipes:foo'
[2014-05-21 19:58:15 -0400] shlant: coderanger: it's the deploy_revision that fails
[2014-05-21 19:58:24 -0400] daos: coderanger: sweet thanks
[2014-05-21 19:58:42 -0400] coderanger: shlant: Can you pastebin the real Ruby traceback?
[2014-05-21 20:01:18 -0400] shlant: coderanger: http://pastebin.com/tBV8UUKt
[2014-05-21 20:02:02 -0400] coderanger: shlant: Will look in a moment, about to head underwater
[2014-05-21 20:03:12 -0400] dgarstang: This is so frustrating. I put a log statement where I THINK the error is and I don't see it. I'm not even sure it's in the right place. The bt on the chef-client run might as well be in Swahili for how clear it is
[2014-05-21 20:03:19 -0400] shlant: dgarstang: I feel like I have never been able to get that cookbook to work without a fork for as long as I can remember :p
[2014-05-21 20:04:10 -0400] shlant: dgarstang: log "=======================#{node[mongo-shard-s1-n1.http://prod.footest.com/]}================"
[2014-05-21 20:04:57 -0400] dgarstang: shlant: oh yah I know that. it's majorly broken. https://github.com/edelight/chef-mongodb/issues/297 ... they're passing the shard name to create a shard rather tbn the replicaset name. 'By Design'? WTF?
[2014-05-21 20:05:36 -0400] dgarstang: shlant: apparently log doeesn't work in a library. had to use Chef::log
[2014-05-21 20:06:26 -0400] coderanger: shlant: The error is coming from git
[2014-05-21 20:06:46 -0400] shlant: coderanger: yes, but why is it wanting a username/pass?
[2014-05-21 20:06:47 -0400] coderanger: shlant: if I had to guess, it is failing to read a config file somehwere
[2014-05-21 20:06:53 -0400] shlant: shouldn't it use the deploy_key?
[2014-05-21 20:07:06 -0400] coderanger: shlant: It doesn't want a password, just a ustname
[2014-05-21 20:07:41 -0400] coderanger: shlant: Regardless, you just need to go debug git
[2014-05-21 20:07:42 -0400] shlant: coderanger: yes, but If I try that command manually, it asks for a password after the username
[2014-05-21 20:08:13 -0400] coderanger: shlant: Then perhaps your deploy key isn't being accepted
[2014-05-21 20:08:15 -0400] shlant: I haven't used the deploy resource before which is why i'm a little confused..
[2014-05-21 20:08:22 -0400] cygoonda: Experts: I hope you experts dont mind a beginner question: How do I the attributes it collects on each node? Nodes driven by a server I inherited get the authorization attributes but a newly built chef server does not
[2014-05-21 20:08:26 -0400] shlant: coderanger: i'll doublecheck
[2014-05-21 20:08:28 -0400] coderanger: shlant: You can test by just SSHing to git@github.com
[2014-05-21 20:09:05 -0400] coderanger: cygoonda: I think you missed a word in there somewhere, unsure what you are trying to do
[2014-05-21 20:09:11 -0400] shlant: coderanger: the key I provide is set as a deploy key for that repo. Is that all that's required?
[2014-05-21 20:09:18 -0400] shlant: or does it need to be a key for the account
[2014-05-21 20:09:35 -0400] coderanger: shlant: That should grant read-only access, but like I said, test with SSH
[2014-05-21 20:09:48 -0400] coderanger: shlant: Oh derp, I'm not reading
[2014-05-21 20:09:51 -0400] joshua__: any chef windows users here who are using the git resource on windows nodes?
[2014-05-21 20:09:55 -0400] cygoonda: coderanger: I would like ohai to collect the attributes under authorization, but its not collecting them. I assume this is a configuration somewhere but Im not sure
[2014-05-21 20:09:57 -0400] coderanger: shlant: You set the git repo URL as https://
[2014-05-21 20:10:01 -0400] coderanger: shlant: That doesn't support SSH :)
[2014-05-21 20:10:05 -0400] shlant: ah
[2014-05-21 20:10:51 -0400] coderanger: cygoonda: ohai gathers system information, not your own custom settings, those are merged together at the start of the converge cycle
[2014-05-21 20:12:17 -0400] cygoonda: coderanger: well I have one chef server that is showing it gathered a bunch of data under an attribute called authorizaation, and another server that doesnt have this data. Does that mean the data is being pulled by a custom ohai plugin?
[2014-05-21 20:15:23 -0400] bobdobalina: before i rewrite my entire recipe, can you tell me if this is legit in my attributes  ? ......default['nginx_wrapper']['nginx_version'] = "1.4.4" default['nginx_wrapper'] <newline> ['nginx_installdir'] = "/usr/local/nginx-#{node['nginx_wrapper']['nginx_version']}"
[2014-05-21 20:16:35 -0400] bobdobalina: is that ok to use if I don't for whatever reason want to use the attributes set in nginx recipe
[2014-05-21 20:17:12 -0400] mattupstate: bobdobalina: are you trying to override the default attributes from the nginx cookbook?
[2014-05-21 20:17:30 -0400] bobdobalina: nope, just to define some attributes i can use in my wrapper for various things
[2014-05-21 20:17:41 -0400] bobdobalina: i dont want to use or interfere with the nginx attributes
[2014-05-21 20:18:41 -0400] bobdobalina: newline should have been after the 1.4.4 btw :)
[2014-05-21 20:18:46 -0400] mattupstate: bobdobalina: a paste service would be better to illustrate with
[2014-05-21 20:18:53 -0400] mattupstate: but otherwise it looks like you're fine
[2014-05-21 20:19:04 -0400] bobdobalina: ok thanks
[2014-05-21 20:19:20 -0400] bobdobalina: getting there slowly but surely
[2014-05-21 20:21:36 -0400] bobdobalina: one last one question (for now :) ) and i'm good to go
[2014-05-21 20:21:55 -0400] coderanger: cygoonda: Not all attributes come from ohai
[2014-05-21 20:21:58 -0400] coderanger: cygoonda: attributes can also be set on roles, environments, nodes, or via cookbooks
[2014-05-21 20:22:20 -0400] bobdobalina: what is the nicest way to open various files, check for if a file exists, if it doesn't create it, and if it does, replace it ?
[2014-05-21 20:22:29 -0400] dgarstang: If I run node show <node> .... and I'm not seeing any :q!
[2014-05-21 20:22:33 -0400] dgarstang: argh
[2014-05-21 20:22:51 -0400] bobdobalina: files i'm working with are /etc/sysctl.conf, /etc/security/limits.conf and others similar, with out 45 lines to check and append
[2014-05-21 20:22:58 -0400] coderanger: bobdobalina: Are you just asking if it is kosher to interpolate existing attrs in later ones?
[2014-05-21 20:23:05 -0400] cygoonda: coderanger, got it. thanks!
[2014-05-21 20:23:27 -0400] bobdobalina: that was the first question aye, i thought for some reason it might have been bad
[2014-05-21 20:23:40 -0400] dgarstang: I got a node here, and it's roles, platform etc are empty... does that only get populated after a successful chef-client run?
[2014-05-21 20:24:06 -0400] bobdobalina: 2nd quesiton was about updating multiple files without clobbering the entire file or duplicating the same values
[2014-05-21 20:24:32 -0400] dgarstang: This is really confusing. A knife node show shows two roles in the run list, yet a knife node show has empty roles. Why?
[2014-05-21 20:24:44 -0400] dgarstang: node edit on that second one
[2014-05-21 20:25:09 -0400] coderanger: bobdobalina: The first thing is allowed, but not a good idea
[2014-05-21 20:25:19 -0400] bobdobalina: :(
[2014-05-21 20:25:24 -0400] coderanger: bobdobalina: The second, again doable but even more of a bad idea, better to have chef manage the whole file
[2014-05-21 20:26:15 -0400] bobdobalina: ok, how about if i let chef manage the file, but then needed to make a change for whatrever reason to the file manually, would the next chef run remove the changes ?
[2014-05-21 20:26:56 -0400] coderanger: Yes
[2014-05-21 20:27:02 -0400] bobdobalina: ok
[2014-05-21 20:27:18 -0400] bobdobalina: so it's all about following good practice and making sure updates go via chef
[2014-05-21 20:27:23 -0400] bobdobalina: roger bilco
[2014-05-21 20:27:25 -0400] coderanger: Yep
[2014-05-21 20:27:32 -0400] coderanger: Thats "wilco" :P
[2014-05-21 20:27:39 -0400] bobdobalina: :)
[2014-05-21 20:27:46 -0400] coderanger: (short for "will comply")
[2014-05-21 20:28:08 -0400] bobdobalina: so i've been saying it wrong for like 30 years?
[2014-05-21 20:28:35 -0400] coderanger: Apparently :)
[2014-05-21 20:29:50 -0400] dgarstang: This is really confusing. A knife node show shows two roles in the run list, yet a knife node edit has empty roles. Why?
[2014-05-21 20:30:55 -0400] tier: is it just me or is the berkshelf api hosed at the moment?
[2014-05-21 20:31:19 -0400] bobdobalina: is the interpolation a really bad idea then, cause it kind of feels like it makes sense
[2014-05-21 20:31:39 -0400] tier: getting this when trying to provision a vagrant box: Fetching cookbook index from https://api.berkshelf.com... Error retrieving universe from source: https://api.berkshelf.com  * [Berkshelf::APIClient::ServiceUnavaiable] service unavailable at: https://api.berkshelf.com
[2014-05-21 20:31:52 -0400] coderanger: tier: The cache is regenerating
[2014-05-21 20:31:56 -0400] coderanger: tier: Give it a few minutes
[2014-05-21 20:32:01 -0400] tier: good deal. thanks?
[2014-05-21 20:32:03 -0400] tier: err thanks!
[2014-05-21 20:32:12 -0400] coderanger: bobdobalina: Its not a really bad idea, just a medium bad idea :)
[2014-05-21 20:32:39 -0400] coderanger: bobdobalina: The problem is that one the interpolation is done, changing the first attribute won't change the second
[2014-05-21 20:32:51 -0400] coderanger: bobdobalina: So if you try to override it in a later cookbook, you need to override both
[2014-05-21 20:33:01 -0400] bobdobalina: aaaahhhhhh ok
[2014-05-21 20:33:27 -0400] coderanger: bobdobalina: A better option is to use string templates
[2014-05-21 20:33:45 -0400] coderanger: bobdobalina: like 'nginx_installdir'] = "/usr/local/nginx-%{version}"
[2014-05-21 20:33:46 -0400] dgarstang: Let me dumb this down. knife node show... no FQDN... does that only get set after a chef run?
[2014-05-21 20:34:19 -0400] coderanger: bobdobalina: and then in the recipe code do "install_dir = node['nginx_installdir'] % {version: node['nginx_version']}
[2014-05-21 20:34:32 -0400] coderanger: bobdobalina: That delays the interpolation until right when you need to use it
[2014-05-21 20:35:01 -0400] coderanger: dgarstang: Yes, all non-normal node attributes are only set after completion
[2014-05-21 20:35:22 -0400] dgarstang: coderanger: k
[2014-05-21 20:35:34 -0400] bobdobalina: thanks dude, i literally have copied that and pasted in an email to myself
[2014-05-21 20:35:56 -0400] bobdobalina: i'll contine just for now while i'm getting started with my medium bad practice with the intention to improve soon
[2014-05-21 20:36:01 -0400] coderanger: bobdobalina: :-)
[2014-05-21 20:36:39 -0400] bobdobalina: the advice is very much appreciated though
[2014-05-21 20:37:13 -0400] dgarstang: coderanger: is there a way to see node attributes? Because... i have two nodes both belonging to the same roles and one is showing me almost nothing with knife node show -l and another ... lots of stuff
[2014-05-21 20:38:10 -0400] coderanger: dgarstang: Which attributes do you mean?
[2014-05-21 20:38:26 -0400] chef488: in chef-client output, I have a line which shows some code being run. how can i tell who the caller of this code was?
[2014-05-21 20:38:44 -0400] coderanger: chef488: It should say above it
[2014-05-21 20:38:56 -0400] coderanger: chef488: Something like (recipename line 123)
[2014-05-21 20:40:20 -0400] dgarstang: coderanger:  so, both nodes have a mongo recipe in runlist. one has the attributes from that, and another does not.
[2014-05-21 20:40:30 -0400] dgarstang: i think I'll just respin this node. something is wrong
[2014-05-21 20:40:40 -0400] coderanger: dgarstang: Have both completed a successful converge?
[2014-05-21 20:41:17 -0400] dgarstang: coderanger: the one that has the data, not sure. The one that hasn't, not sure. However, if node data is there before a successful run...
[2014-05-21 20:41:29 -0400] coderanger: dgarstang: As I said, it isn't
[2014-05-21 20:41:32 -0400] dgarstang: oh, the one that does not have the data, has not run
[2014-05-21 20:41:40 -0400] coderanger: (except for normal attrs set directly on the node)
[2014-05-21 20:41:41 -0400] dgarstang: coderanger: not even node data?
[2014-05-21 20:41:49 -0400] coderanger: dgarstang: I have no idea what "node data" is
[2014-05-21 20:42:04 -0400] dgarstang: coderanger: node.default['foo']
[2014-05-21 20:43:19 -0400] coderanger: dgarstang: Reread my previous comments and you'll have your answer
[2014-05-21 20:43:29 -0400] dgarstang: here we go again
[2014-05-21 20:44:13 -0400] dyer: is it possible to override the top level provisioner in .kitchen.yml ?   I have 2 suites in my kitchen file.  The first I want to use chef_zero the second I want to use chef_solo
[2014-05-21 20:44:25 -0400] dgarstang: well, i think I need to recommend we don't use chef for mongo deploy. The fact the community cookbook is relying on data that hasn't been popuated yet, because chef has not run, borks it.
[2014-05-21 20:44:48 -0400] coderanger: dgarstang: lmao if you think "the community cookbook" has any bearing on things
[2014-05-21 20:45:04 -0400] someara: dat namespace
[2014-05-21 20:45:23 -0400] coderanger: dgarstang: Don't blame it on the tool that you don't want to write things correctly, also PLEASE STOP USING CHEF
[2014-05-21 20:45:30 -0400] dgarstang: coderanger: it has bearing to me and possibly others who want to implement mongo with chef.
[2014-05-21 20:45:46 -0400] coderanger: lmao if you think I care about people that want mongo :)
[2014-05-21 20:46:10 -0400] coderanger: dyer: Yep, you can override it per platform or per suite
[2014-05-21 20:46:22 -0400] dgarstang: coderanger: I find your attitude disrespectful.
[2014-05-21 20:46:25 -0400] coderanger: dyer: `kitchen diagnose` is awesome for this
[2014-05-21 20:47:09 -0400] dyer: ok, hrm, so I tried that and it is working... I guess I should have looked at `kitchen list` before I screamed wolf
[2014-05-21 20:47:15 -0400] dyer: I think I have other problems then
[2014-05-21 20:47:29 -0400] chefNOOB: hey guys
[2014-05-21 20:48:23 -0400] chefNOOB: I have set up chef node, but for some reason it just stops once it connects to the server, tells me the pid then stops, as if its waiting for something
[2014-05-21 20:48:36 -0400] chefNOOB: this is from a windows machine
[2014-05-21 20:48:38 -0400] shlant: coderanger: i'm a bit confused on the use of the application cookbook. If I wanted to deploy a nodejs application with express, would I have 2 separate application resources, one for express and one for nodejs?
[2014-05-21 20:48:43 -0400] coderanger: chefNOOB: Is another copy of chef-client running?
[2014-05-21 20:48:44 -0400] dgarstang: chefNOOB: you and coderanger are gonna get along just swell.
[2014-05-21 20:49:07 -0400] coderanger: chefNOOB: Sorry about that
[2014-05-21 20:49:37 -0400] chefNOOB: just one instance on the client
[2014-05-21 20:49:51 -0400] chefNOOB: newly set up node
[2014-05-21 20:50:10 -0400] coderanger: shlant: I'm not actually super familiar with the node pieces, those were contributed by someone else. I really don't recommend using the current app* cookbooks though, they are due for a serious rewrite (hopefully next week)
[2014-05-21 20:51:12 -0400] chefNOOB: i know about the sec settings for winrm but didn't think that was needed if i wasn't bootstrapping the client
[2014-05-21 20:51:38 -0400] coderanger: chefNOOB: Hmm, I'm not actually 100% on how the client locks work on Windows, from the code it looks like it uses a named mutex, kallistec jkeiser ^^
[2014-05-21 20:51:42 -0400] shlant: coderanger: sounds good. I'll just manually code the deploy for now
[2014-05-21 20:51:49 -0400] chefNOOB: don't want to have vulnerabilities on the node
[2014-05-21 20:52:00 -0400] coderanger: shlant: a git resource and a few execute blocks are really all you need in most cases :)
[2014-05-21 20:52:21 -0400] coderanger: chefNOOB: I don't think its a security issue, it just thinks another copy of chef-client is running and is waiting for it to finish
[2014-05-21 20:52:27 -0400] shlant: coderanger: yea and from the amount fo complaining I've heard about the deploy resource around here, I might be saving some headache ;)
[2014-05-21 20:53:06 -0400] coderanger: shlant: The deploy resource is just a mistake, it needs to removed from chef
[2014-05-21 20:53:28 -0400] coderanger: shlant: Its high on my funemployment fixes list though
[2014-05-21 20:54:00 -0400] chefNOOB: but there is only one instance running
[2014-05-21 20:54:20 -0400] coderanger: chefNOOB: Yeah, it just means the kernel mutex is still locked somehow
[2014-05-21 20:54:32 -0400] coderanger: chefNOOB: But I don't know enough windowsfu to know how to fix that
[2014-05-21 20:55:04 -0400] chefNOOB: quit
[2014-05-21 20:58:45 -0400] saintish: Morning folks. Quick question, hopefully it's not too dumb: When a chef recipe runs, how..exactly does it get interpreted? Does the chef-client basically translate recipes to ruby code, and pass it to the ruby interpreter, or does the chef daemon itself do all of the ruby interpretation stuff? I'm thinking it's the latter, but I wanted to be sure.
[2014-05-21 20:58:56 -0400] saintish: Er, afternoon really.
[2014-05-21 20:58:56 -0400] chef488: so the chef-client run as logged on the console is a purely sequential record of the run?
[2014-05-21 20:59:24 -0400] gyoza: I just came to tell you all
[2014-05-21 20:59:27 -0400] gyoza: that I love chef.
[2014-05-21 20:59:28 -0400] gyoza: This is all.
[2014-05-21 20:59:38 -0400] coderanger: saintish: The chef-client executes all the recipe code, building an in-memory collection of resource objects
[2014-05-21 20:59:50 -0400] coderanger: saintish: And then runs the requested actions on each
[2014-05-21 21:00:02 -0400] chef488: in purely linear sequence?
[2014-05-21 21:00:03 -0400] coderanger: gyoza: \o/
[2014-05-21 21:00:10 -0400] coderanger: chef488: Mostly, yeah
[2014-05-21 21:00:25 -0400] coderanger: chef488: Some bits can get fancier if you use LWRPs or other features like that
[2014-05-21 21:00:32 -0400] gyoza: lwrps are my favorite
[2014-05-21 21:00:36 -0400] gyoza: personally
[2014-05-21 21:00:44 -0400] coderanger: chef488: But straight recipe code is just a two-pass compile/converge system
[2014-05-21 21:00:49 -0400] gyoza: chef learning curve is kind of high
[2014-05-21 21:00:51 -0400] gyoza: but once you "get" it
[2014-05-21 21:00:52 -0400] saintish: coderanger: Alright, that makes sense. I ask because we had a recipe earlier that was calling delete_if on a hash, but only deleting keys if the value
[2014-05-21 21:00:55 -0400] gyoza: it becomes SOOOO easy
[2014-05-21 21:01:23 -0400] saintish: value's didn't match. Suffice it to say, it didn't like the fact that we were sending a symbol, but worked with a string. This change came about after a chef-client upgrade, so i was just curious
[2014-05-21 21:02:21 -0400] coderanger: saintish: Some bits of chef allow either string or symbol keys for simplicity, but its a leaky abstraction at best :)
[2014-05-21 21:02:47 -0400] saintish: coderanger: Noted lol. Appreciate the help
[2014-05-21 21:04:28 -0400] gyoza: hmmm
[2014-05-21 21:04:35 -0400] gyoza: cant tell if my cron isnt running or if i am impatient.........
[2014-05-21 21:04:46 -0400] gyoza: prob both
[2014-05-21 21:24:48 -0400] slyness_: any chef on windows hackers around that have experience using DISM to install features through a caching proxy like squid?
[2014-05-21 21:41:25 -0400] doomviking: update template in cookbook; upload cookbook to chef server; chef-client on server; template not changed. Did I miss something?
[2014-05-21 21:41:44 -0400] coderanger: doomviking: Check for version restrictions
[2014-05-21 21:44:23 -0400] doomviking: coderanger: yeah I thought of that too, never have done it with this cookbook. bumped the version and I can see it on the chef server gui
[2014-05-21 21:44:52 -0400] coderanger: doomviking: You can use knife-solve to see what versions would be executing on a node
[2014-05-21 21:45:04 -0400] coderanger: doomviking: Or you can check the chef cache folder on the target machine
[2014-05-21 21:45:06 -0400] cheeseplus: any env restrictions?
[2014-05-21 21:46:24 -0400] chef488: sure would be nice if chef-client showed, below the run list / roles / recipes line a methods line, where it would attempt to report on the methods being run (all of them) in sequence
[2014-05-21 21:46:52 -0400] doomviking: oh there it is. the cookbook isn't included in the env_run_lists for this particular env. PEBKAC as usual, thank you :)
[2014-05-21 21:47:52 -0400] coderanger: cheeseplus: Not sure what you mean
[2014-05-21 21:47:58 -0400] coderanger: er, chef488 ^^
[2014-05-21 21:48:06 -0400] coderanger: cheeseplus: My tab key just likes you apparently
[2014-05-21 21:48:19 -0400] cheeseplus: coderanger: s'ok, mine like you back
[2014-05-21 21:48:26 -0400] coderanger: cheeseplus: tabbros
[2014-05-21 21:49:11 -0400] qhartman: so I'm just starting to work with chef 11. (late to the party, I know) and have found the chef-shell -z will fail in the same way that a chef-client will, if for example I have sometthing hat is trying to accessa method on a nilClass
[2014-05-21 21:50:03 -0400] coderanger: qhartman: That sounds correct, yes.
[2014-05-21 21:50:07 -0400] qhartman: I used to use "shef -z" to troubleshoot these sorts of problems from the client's context. Is there a way that I can invoke chef-shell so that it simulates the client's environment, but won't bomb out if it hits errors like that?
[2014-05-21 21:51:33 -0400] rayrod20_: found out today that fog supports "use_iam_profile" for auth but still requires aws credentials.  I just want to use iam roles for auth instead of creds.  That's the whole point!
[2014-05-21 21:51:37 -0400] kallistec: qhartman: you could maybe use pry instead? it would be a little different than chef-shell...
[2014-05-21 21:51:56 -0400] rayrod20_: trying to run kitchen-ec2 without aws keys
[2014-05-21 21:54:24 -0400] qhartman: kallistec, that wouldn't have all the chef context loaded in it though, would it? I'm specifically using this to try to figure out why certain node attributes that I'm expecting to be set are not (and similar things)
[2014-05-21 21:54:44 -0400] kallistec: qhartman: the way you'd do it, is you would add `binding.pry` right above where it fails in the cookbook, then you'll get a ruby shell with that context
[2014-05-21 21:54:52 -0400] kallistec: plus a bunch of magic stuff that pry does
[2014-05-21 21:54:54 -0400] coderanger: rayrod20_: I don't think kitchen-ec2 had stuff rigged up to support the token field
[2014-05-21 21:55:13 -0400] qhartman: kallistec, huh, interesting. Any docs you like that have more details?
[2014-05-21 21:55:14 -0400] rayrod20_: coderanger: I'm running a fork simply passing use_iam_profile
[2014-05-21 21:55:30 -0400] kallistec: qhartman: start with pry homepage http://pryrepl.org
[2014-05-21 21:55:42 -0400] rayrod20_: coderanger: But fog still requires the cred attributes and if you pass anything in them it tries to connect with the creds instead of the iam generated ones.
[2014-05-21 21:56:05 -0400] coderanger: rayrod20_: Hmm, that doesn't sound right, pretty sure I've used that feature before
[2014-05-21 21:56:14 -0400] qhartman: kallistec, thx, I'll look into that
[2014-05-21 21:56:43 -0400] kallistec: qhartman: OTOH, you'll lose some of the chef-specific stuff that chef-shell adds. But pry is pretty amazing, we've thought about replacing chef-shell with a bunch of pre-set pry breakpoints
[2014-05-21 21:56:52 -0400] rayrod20_: coderanger: maybe you used the token field?
[2014-05-21 21:57:21 -0400] rayrod20_: aws_session_token
[2014-05-21 21:57:46 -0400] coderanger: rayrod20_: Hmm, so searching for use_iam on fog master has no results
[2014-05-21 21:57:58 -0400] coderanger: rayrod20_: It is possible the auto-load feature was removed or renamed
[2014-05-21 21:58:11 -0400] rayrod20_: https://github.com/fog/fog/search?q=use_iam_profile&ref=cmdform
[2014-05-21 21:58:31 -0400] coderanger: Weird https://github.com/fog/fog/search?q=use_iam&type=Code
[2014-05-21 21:58:37 -0400] coderanger: Go go gadget github
[2014-05-21 21:58:43 -0400] rayrod20_: How does anything work!
[2014-05-21 21:58:44 -0400] rayrod20_: :)
[2014-05-21 21:58:50 -0400] rayrod20_: zomg
[2014-05-21 22:00:57 -0400] qhartman: kallistec, Really the only thing I've ever used chef-shell for was troubleshooting failed chef runs, so in it's current state it's kinda lost all utility for me. If the pry approach restores the ability to poke around with the complete client context, I'd be all for it.
[2014-05-21 22:01:38 -0400] coderanger: rayrod20_: Hmm, whats your code look like?
[2014-05-21 22:02:18 -0400] rayrod20_: https://github.com/sailthru-cookbooks/kitchen-ec2/blob/master/lib/kitchen/driver/ec2.rb
[2014-05-21 22:02:35 -0400] qhartman: though being forced to change the cookbook to put the pry stuff in there is kind of a hassle, especially if I have something that's only breaking in some environments, but works fine in others. In order to make that safe to run in the functioning environments, I'd have to do the version pinning dance
[2014-05-21 22:02:47 -0400] rayrod20_: I'm just passing use_iam_profile from kitchen-ec2 on to fog in the compute.new
[2014-05-21 22:03:49 -0400] rayrod20_: https://github.com/sailthru-cookbooks/kitchen-ec2/compare/test-kitchen:master...master
[2014-05-21 22:03:51 -0400] coderanger: rayrod20_: Try passing the key and secret as nil
[2014-05-21 22:03:54 -0400] rayrod20_: that's a better diff
[2014-05-21 22:04:19 -0400] rayrod20_: ok I'll give that shot.  I figured not including the config in .kitchen.yml would have the same effect but maybe not.
[2014-05-21 22:04:22 -0400] iroller: Hey Chefs. Do I understand correct that omnibus-chef is unable to utilize Vagrant and build packages for any platform I want and not only one I'm running it on?
[2014-05-21 22:04:40 -0400] kallistec: qhartman: you can guard the expression with an if, like `binding.pry if ENV["DEBUG_CHEF_WITH_PRY_PLZ"] == "true"`
[2014-05-21 22:04:44 -0400] coderanger: iroller: Not sure I grok the question
[2014-05-21 22:05:10 -0400] qhartman: kallistec, that's true
[2014-05-21 22:05:27 -0400] coderanger: iroller: omnibus-chef includes the standard vagrant-based build lab, though I don't think Opscode uses it
[2014-05-21 22:05:46 -0400] qhartman: kallistec, still more involved than "damn, wtf did that fail?.... shef -z....poke poke.... oh! fixed!"
[2014-05-21 22:05:55 -0400] iroller: coderanger: can omnibus-ruby build packages for multiple platforms at once, not only the one I'm running it on?
[2014-05-21 22:06:47 -0400] coderanger: iroller: Not on its own, no, but it ships an example config to use vagrant or test-kitchen for this
[2014-05-21 22:06:48 -0400] kallistec: qhartman: yeah, unfortunately the behavior you were relying on was actually a bug that went unnoticed for a while :(
[2014-05-21 22:07:20 -0400] coderanger: iroller: It is not a cross-compiler if thats what you are asking
[2014-05-21 22:07:37 -0400] rayrod20_: coderanger: ok I'll keep working on this yak.  I'm off to a chef-nyc meetup at digital ocean.  I'll ping you if I make any progress.
[2014-05-21 22:07:38 -0400] qhartman: kallistec, It's not a bug! It's a feature! ;)
[2014-05-21 22:07:48 -0400] coderanger: rayrod20_: Have fun
[2014-05-21 22:07:59 -0400] coderanger: DO is still on my grumpy-at list from earlier this week >_<
[2014-05-21 22:08:18 -0400] iroller: coderanger: I'm asking if it's able to spin up a couple VM's in Vagrant, for example UBuntu and Centos while running on MacOSX, build all needed packages for me and shut the down
[2014-05-21 22:08:20 -0400] iroller: *them
[2014-05-21 22:08:45 -0400] coderanger: iroller: Yes, when you make a new omnibus project it includes configs to do just that
[2014-05-21 22:09:02 -0400] iroller: coderanger: hmm... just created one, looking
[2014-05-21 22:10:08 -0400] coderanger: iroller: I think current omnibus generates a test-kitchen config for you
[2014-05-21 22:11:49 -0400] iroller: coderanger: ah, I see, thanks. Now need to understand how to make it working
[2014-05-21 22:14:30 -0400] bobdobalina: goodnight all
[2014-05-21 22:14:48 -0400] bobdobalina: thanks for the help on here, im finally chef'ing and it feels gooooooood
[2014-05-21 22:22:37 -0400] doomviking: chefatize!
[2014-05-21 22:31:47 -0400] Neozonz: what does the following do> myid = server_hosts.find_index(node.name)
[2014-05-21 22:32:49 -0400] coderanger: Neozonz: Returns the index in the array or nil if it isn't found
[2014-05-21 22:33:49 -0400] Neozonz: Tyring to understand the following : https://github.com/stigkj/chef-zookeeper/blob/master/recipes/server.rb#L21-L23
[2014-05-21 22:34:16 -0400] Neozonz: so it just takes all the servers contained in hosts, and adds 1 to the count?
[2014-05-21 22:34:33 -0400] coderanger: So given an array of hosts it looks for where the current node is in that list
[2014-05-21 22:34:35 -0400] coderanger: and then adds one
[2014-05-21 22:34:51 -0400] coderanger: Neozonz: Really though, this is just bad code
[2014-05-21 22:35:19 -0400] Neozonz: I'm looking for a solution to set the myid file to an integer
[2014-05-21 22:35:22 -0400] coderanger: Neozonz: The error case of nil gets checked below that, but it will never trigger
[2014-05-21 22:35:27 -0400] Neozonz: it must be unique and it is the id of the server
[2014-05-21 22:35:43 -0400] coderanger: Neozonz: Use the MAC address
[2014-05-21 22:35:54 -0400] Neozonz: they are EC2 servers
[2014-05-21 22:36:14 -0400] Neozonz: so mac/ips change :(
[2014-05-21 22:36:18 -0400] coderanger: Neozonz: then use the instance ID
[2014-05-21 22:36:31 -0400] Neozonz: oh
[2014-05-21 22:36:33 -0400] Neozonz: haha
[2014-05-21 22:36:44 -0400] coderanger: :-)
[2014-05-21 22:36:50 -0400] Neozonz: i feel stupid now :p
[2014-05-21 22:37:11 -0400] Neozonz: gonna go find where the instance id is kept now :p
[2014-05-21 22:37:25 -0400] coderanger: Neozonz: node['ec2']['instance_id'] I think
[2014-05-21 22:37:35 -0400] coderanger: though that would be a hex number so you need to convert to an int
[2014-05-21 22:37:54 -0400] Neozonz: node[:opsworks][:instance][:hostname]
[2014-05-21 22:37:58 -0400] Neozonz: might just use that instead
[2014-05-21 22:39:32 -0400] coderanger: Neozonz: node['ec2']['instance_id'][2..-1].hex
[2014-05-21 22:41:44 -0400] _coderanger: chefatise!
[2014-05-21 22:44:45 -0400] doomviking: righteous
[2014-05-21 22:57:44 -0400] iroller: coderanger: heh, it got way more complicated to build multi-platform package versions with the latest omnibus and test-kitchen. Previously you just had to run `vagrant provision` and that's it - you've got your packages in pkg
[2014-05-21 22:58:35 -0400] iroller: coderanger: and now with test-kitchen you have to login into the VM, cd to project dir, bundle install and manually run omnibus build prject
[2014-05-21 22:59:03 -0400] iroller: that's weird, am I missing something?
[2014-05-21 22:59:07 -0400] coderanger: iroller: I've never actually used the included build lab in favor of my own, so can't really comment there
[2014-05-21 23:13:45 -0400] jpic: hi all, is sthere already a cookbook that iterates over the environment hash and creates all the libvirt vms and networks ?
[2014-05-21 23:22:19 -0400] coderanger: jpic: I'm not aware of one
