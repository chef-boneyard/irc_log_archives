[2014-01-24 04:35:34 -0500] sniperd: I am using Chef::Log.info inside of a library, and while bootstrapping a new node of course the default log level is :auto, causing this log to be hidden, how do I get a log message raised up in the auto log level?
[2014-01-24 04:51:45 -0500] sniperd: I guess the answer to that would just use warn
[2014-01-24 06:23:29 -0500] brucelee: yo
[2014-01-24 06:23:33 -0500] brucelee: sup y'all :)
[2014-01-24 06:23:40 -0500] brucelee: got my recipe working finally
[2014-01-24 06:42:15 -0500] brucelee: what happens when using a template and a "source" is not specified?
[2014-01-24 06:44:01 -0500] flaccid: brucelee: did you give it a try and see?
[2014-01-24 07:02:40 -0500] brucelee: flaccid: yah
[2014-01-24 07:02:47 -0500] brucelee: flaccid: figured it out, it would just be the name of the source :p
[2014-01-24 07:08:21 -0500] brucelee: * Currently have some users already manually added to servers. If i create databag for users in chef, some of which are already added without chef, will there be problems?
[2014-01-24 07:08:30 -0500] brucelee: woops, bad paste :p
[2014-01-24 07:11:12 -0500] estebistec: probably n00b question: can I not use "package" inside of an execute block?
[2014-01-24 07:12:35 -0500] brucelee: i think execute block is executing a bash command
[2014-01-24 07:12:44 -0500] brucelee: "package" is a chef 'function
[2014-01-24 07:29:59 -0500] blackice2999: good morning from germany
[2014-01-24 07:31:56 -0500] blackice2999: i am relative new to chef and have a question. If i use the "mysql" receipt in combination with a chef server it will be create the passwords like root password automaticaly and store them on the node attributes. How secure is it ? I cant find any documentation about node attributes and security. Is there a common practice to work with such values?
[2014-01-24 07:34:02 -0500] brucelee: hey
[2014-01-24 07:34:26 -0500] brucelee: supposedly you only have access to them
[2014-01-24 07:34:29 -0500] brucelee: on your server
[2014-01-24 07:34:32 -0500] brucelee: and your chef-server
[2014-01-24 07:34:33 -0500] brucelee: so
[2014-01-24 07:34:38 -0500] brucelee: depending on who you give access to your workstation
[2014-01-24 07:34:42 -0500] brucelee: and chef-server
[2014-01-24 07:34:47 -0500] brucelee: is how secure that password is :p
[2014-01-24 07:35:49 -0500] blackice2999: thanks. So only the node who owns this attributes and the chef-server can read this data?
[2014-01-24 07:55:32 -0500] masterkorp: Hello chefs
[2014-01-24 07:55:57 -0500] masterkorp: what does you guys do to simulate search results on test-kitchen ?
[2014-01-24 08:30:33 -0500] jaykatta: how to obtain the return code of recepe ?
[2014-01-24 09:21:11 -0500] brucelee: hey
[2014-01-24 09:21:26 -0500] brucelee: how do i use chef for already provisioned servers
[2014-01-24 09:21:32 -0500] brucelee: how does chef behave in those situations/
[2014-01-24 09:26:47 -0500] jaykatta: how to obtain the return code of recepe ?
[2014-01-24 09:27:24 -0500] jaykatta: how to obtain the return code of recipe?
[2014-01-24 09:37:17 -0500] brucelee: jaykatta: im not sure
[2014-01-24 10:28:22 -0500] brucelee: how does chef work with already deployed servers?
[2014-01-24 10:28:34 -0500] brucelee: lets say it already has nginx installed
[2014-01-24 10:28:53 -0500] brucelee: and i create a cookbook that more or less replicates its configuration
[2014-01-24 10:29:04 -0500] brucelee: what would happen if i run chef client on that server?
[2014-01-24 10:29:11 -0500] brucelee: does it all depend on the cookbook?
[2014-01-24 10:31:33 -0500] zaargy: if you write the cookbook in the correct way (e.g. make it idempotent) when you run it again nothing will happen
[2014-01-24 10:47:43 -0500] brucelee: sounds like the rule of thumb is to not apply it to existing servers
[2014-01-24 10:47:50 -0500] brucelee: i want to setup chef client on a bunch of existing servers
[2014-01-24 10:48:21 -0500] brucelee: so when i need to create a user, i wouldnt have to manually log in to all the servers in the cluster and manually add em
[2014-01-24 12:33:03 -0500] op: Hi , trying to run test-kitchen on windows having an issue where it's not running the tests , seems to be trying to run sudo via ssh rather than winrm into the vagrant virtual box. Can anyone help me out , not used test kitchen before so on a learning curve
[2014-01-24 12:33:25 -0500] op: Using chef_handler (1.1.4) [36m       Removing non-cookbook files before transfer [0m[36m       /bin/sh: -c: line 0: unexpected EOF while looking for matching `'' [0m[36m       /bin/sh: -c: line 13: syntax error: unexpected end of file [0m[36m       /bin/sh: sudo: command not found [0m[36m       Transfering files to <default-win2012> [0m[36m       Finished converging <default-win2012> (0m28.36s).
[2014-01-24 12:36:38 -0500] CaptainQuirk: Hi there !
[2014-01-24 12:37:12 -0500] CaptainQuirk: Can a chef run store some data in memory during a run and make this data available for a recipe at the end ?
[2014-01-24 13:03:06 -0500] evtuhovich: Hi
[2014-01-24 13:03:23 -0500] evtuhovich: Only problem is to determine "the end"
[2014-01-24 14:03:06 -0500] dwradcliffe: can a heavy resource inherit from a lightweight resource?
[2014-01-24 14:14:19 -0500] k4v: do you guys prefer debian or ubuntu for nodes?
[2014-01-24 14:29:16 -0500] wizgeeky: Awesome. So I wasn't able to join the webinar yesterday to learn chef, and am looking for transcript or resources from the webinar to improve our chef usage
[2014-01-24 14:32:24 -0500] shlant: wizgeeky: is this what you were looking to join? https://learnchef.opscode.com/screencasts/fundi-webinar-week-1/
[2014-01-24 14:41:33 -0500] rkesters: Hi I am running the omnibus install on RHEL 6 and the reconfigure step fails on the status check, when I tail the log sqerl is failing to access the database... any clue why this would be
[2014-01-24 14:41:41 -0500] rkesters: postgress is running
[2014-01-24 14:51:52 -0500] rkesters: has anyone had problems with sqerl not being able to connect to the database?
[2014-01-24 14:54:58 -0500] ajn: i'm trying to use the knife plugin for google compute engine and keep getting a Google::APIClient not found error, can anyone help with this?
[2014-01-24 14:56:19 -0500] masterkorp: Guys how do you deal with recipes that have the search function on them with test-kitchen ?
[2014-01-24 15:10:31 -0500] jtimberman: masterkorp: i just did that w/ a cookbook refactor. the solution was to use the chef-zero provisioner instead of chef-solo, and then drop off fake nodes in test/integration/nodes/
[2014-01-24 15:10:35 -0500] jtimberman: worked like a champ
[2014-01-24 15:11:26 -0500] masterkorp: yeah i was using chef-zezo i had a badly formulated query
[2014-01-24 15:11:46 -0500] masterkorp: how do i search for nodes that contains a certain recipe ?
[2014-01-24 15:11:55 -0500] jtimberman: i wouldn't tbh
[2014-01-24 15:12:27 -0500] jtimberman: for recipe-based search, i've grown to dislike the pattern of searching for things in the nodes [expanded] run list.
[2014-01-24 15:12:39 -0500] jtimberman: at least for community-shared cookbooks.
[2014-01-24 15:12:56 -0500] jtimberman: i think it's a better practice to search for a particular attribute, or a node's tag.
[2014-01-24 15:13:07 -0500] masterkorp: makes sense
[2014-01-24 15:13:33 -0500] jtimberman: because a) someone might rename a cookbook, or not have the one you think or b) they're not using roles
[2014-01-24 15:13:53 -0500] jtimberman: tags are super duper easy to add/remove since there's a knife plugin :)
[2014-01-24 15:14:00 -0500] wizgeeky: ty shlant - sorry got called into a quick meeting
[2014-01-24 15:14:32 -0500] jtimberman: gotta run :)
[2014-01-24 15:14:36 -0500] jtimberman: will have a blog post on this soon
[2014-01-24 15:15:23 -0500] wizgeeky: that could be it - lol - i feel kinda dumb not realizing the screencasts were up on the learnchef site
[2014-01-24 15:15:30 -0500] wizgeeky: s'all good though - tis friday
[2014-01-24 15:22:22 -0500] masterkorp: i need yet another coffe
[2014-01-24 15:23:03 -0500] shlant: wizgeeky: have fun learning chef! :)
[2014-01-24 15:23:24 -0500] masterkorp: jtimberman: hmm, and how can I mock some results ?
[2014-01-24 15:23:29 -0500] masterkorp: that would be nicce
[2014-01-24 15:23:31 -0500] wastrel: i didn't even kow there was a webinar
[2014-01-24 15:36:44 -0500] zeroXten: what logic does execute use for notifies... if the exit code was 0 for example?
[2014-01-24 15:47:30 -0500] bmhatfield: Hi, I'm trying to follow the documentation for making a custom ohai plugin and the documentation is wrong in a way I don't understand.
[2014-01-24 15:47:31 -0500] bmhatfield: http://docs.opscode.com/ohai.html#custom-plugins
[2014-01-24 15:47:44 -0500] bmhatfield: I always get "undefined method `plugin' for Ohai:Module"
[2014-01-24 15:47:56 -0500] bmhatfield: Even though I just copy/pasted from the example code
[2014-01-24 15:48:30 -0500] bmhatfield: The only results on Google are from people asking the same question in here and being ignored :-(
[2014-01-24 15:53:48 -0500] bmhatfield: help?
[2014-01-24 16:08:50 -0500] wizgeeky: bmhatfield: I had an issue with a Chef cookbook - forget which one.. But I just ended up executing my own shell commands via the 'execute' method.. If you know what to do with Ohai via a shell this may be the best approach for you
[2014-01-24 16:09:59 -0500] wizgeeky: also - i had an issue with the php-fpm cookbook running without errors all over the place and just used: package "php55-fpm"
[2014-01-24 16:10:27 -0500] wizgeeky: If ohai is available in your distro's repo it may be easier to use that method to install a package
[2014-01-24 16:10:39 -0500] wizgeeky: not sure what your issues are but hopefully one of these approaches can help you along
[2014-01-24 16:11:34 -0500] wizgeeky: all in all chef is a fantastic product.. I don't know how I survived so long without it
[2014-01-24 16:11:47 -0500] wizgeeky: Helps me achieve my goals of being a lazy admin ;)
[2014-01-24 16:12:51 -0500] s2r2_: poll: shellout to uuidgen or require uuidtools ?
[2014-01-24 16:19:48 -0500] bmhatfield: wizgeeky: Thanks for your response, but I don't think it applies in this circumstance
[2014-01-24 16:20:04 -0500] bmhatfield: I'm trying to implement a custom plugin as documented on the site, and the documentation doesn't work.
[2014-01-24 16:20:52 -0500] wizgeeky: bmhatfield: got some links? maybe I can help ya figure it out
[2014-01-24 16:21:22 -0500] bmhatfield: Sure: http://docs.opscode.com/ohai.html#custom-plugins
[2014-01-24 16:21:39 -0500] bmhatfield: I'm specifically interested in the syntax of a plugin, as documented in the syntax section.
[2014-01-24 16:22:03 -0500] bmhatfield: However, if you include the Ohai.plugin line (line 1 in the example) it fails.
[2014-01-24 16:22:12 -0500] bmhatfield: No method 'plugin' in module Ohai
[2014-01-24 16:22:31 -0500] bmhatfield: This wrapper code is littered all over the documentation but it doesn't work.
[2014-01-24 16:22:38 -0500] wizgeeky: looking now
[2014-01-24 16:23:28 -0500] bmhatfield: Thanks :-)
[2014-01-24 16:24:12 -0500] wizgeeky: what is the fail error you're getting?
[2014-01-24 16:25:46 -0500] bmhatfield: $ /etc/chef/ohai_plugins/ipaddress-vagrant.rb:1:in `from_file': undefined method `plugin' for Ohai:Module (NoMethodError)
[2014-01-24 16:25:57 -0500] wizgeeky: Just to test something do you get a fail if you only do: Ohai.plugin do ... end
[2014-01-24 16:26:23 -0500] wizgeeky: Without the (:Name)
[2014-01-24 16:26:30 -0500] bmhatfield: Yep, confirmed, same error
[2014-01-24 16:26:38 -0500] bmhatfield: ohai -f /etc/chef/ohai_plugins/ipaddress-vagrant.rb
[2014-01-24 16:26:42 -0500] bmhatfield: I'm running it like that
[2014-01-24 16:27:23 -0500] bmhatfield: Running: Ohai: 6.16.0
[2014-01-24 16:27:40 -0500] wizgeeky: what happens if you try bundle exec ohai ...
[2014-01-24 16:28:08 -0500] bmhatfield: I don't have bundle, ohai is installed as part of an omnibus chef install
[2014-01-24 16:28:42 -0500] bmhatfield: If I do something like this: https://gist.github.com/bmhatfield/8600671
[2014-01-24 16:28:43 -0500] bmhatfield: it works
[2014-01-24 16:28:48 -0500] wizgeeky: Kk.. In your cookbook - is ohai at the top of your run list?
[2014-01-24 16:29:35 -0500] bmhatfield: Yep. In this particular case, I am running on the command line to test the ohai plugins by hand, so the runlist doesn't really apply
[2014-01-24 16:29:48 -0500] bmhatfield: See my gist for a functioning form of this plugin
[2014-01-24 16:30:12 -0500] bmhatfield: What I am trying to understand is why it's so very different than the documented syntax
[2014-01-24 16:31:30 -0500] bmhatfield: I've found example code here: https://coderwall.com/p/hwiohg and here: http://johntdyer.com/blog/2013/01/25/ohai/ which my plugin is modeled on
[2014-01-24 16:32:15 -0500] wizgeeky: hmm.. what happens when you run: ohai -df /path/to/plugin.rb -l debug
[2014-01-24 16:32:19 -0500] wizgeeky: ?
[2014-01-24 16:33:28 -0500] wizgeeky: Also serverfault recommends adding the following line to your client.rb: Ohai::Config[:plugin_path] << "/etc/chef/ohai_plugins"
[2014-01-24 16:33:46 -0500] wizgeeky: of course relevant to your actual directory structure
[2014-01-24 16:33:58 -0500] wizgeeky: http://serverfault.com/questions/518793/opscode-chef-ohai-plugin-how-to-get-a-custom-plugin-to-run-automatically
[2014-01-24 16:35:01 -0500] bmhatfield: So to be clear: I can get the plugin to run
[2014-01-24 16:35:10 -0500] bmhatfield: The one I pasted in the gist that is
[2014-01-24 16:35:29 -0500] bmhatfield: but the plugin I pasted in my gist is /dramatically/ different than the syntax that's documented on the ohai documentation page
[2014-01-24 16:35:47 -0500] bmhatfield: no Ohai.plugin, no calls to collect_data, etc
[2014-01-24 16:36:21 -0500] bmhatfield: I have no issues getting the plugin detected given the right command line parameters. But the documented form of the plugin throws an exception for a missing method.
[2014-01-24 16:36:45 -0500] wizgeeky: The would mean Chef itself isn't running the plugin though doesn't it? Your syntax appears to be using ohai directly - i've never used Ohai.. You're leagues ahead what i've been doing with Chef just trying to help ya brainstorm
[2014-01-24 16:36:46 -0500] bmhatfield: I am trying to understand why the documentation explicitly states to use a method that doesn't appear to exist in the Ohai codebase
[2014-01-24 16:36:47 -0500] wizgeeky: hgehe
[2014-01-24 16:37:12 -0500] wizgeeky: It exists, i'm thinking it's not getting loaded.. Can't find the method because it's not loading Ohai plugin
[2014-01-24 16:37:27 -0500] bmhatfield: Oh, sorry for being unclear: it is indeed loading the ohai plugin
[2014-01-24 16:37:37 -0500] bmhatfield: I can print out the results of other ohai plugins, etc
[2014-01-24 16:38:04 -0500] wizgeeky: Alternatively, you could scrap using the plugin and try one of the ohai cookbooks, migght work better for your needs
[2014-01-24 16:38:13 -0500] wizgeeky: Hmm...
[2014-01-24 16:38:24 -0500] wizgeeky: I wonder if it's outdated documentation then
[2014-01-24 16:39:27 -0500] bmhatfield: I guess I'll see if I can file a ticket against the documentation
[2014-01-24 16:40:25 -0500] wizgeeky: i had a problem with knife-ec2 not be exactly what the guide staqted and had to figure it out - but knife-ec2 was admittedly easier than ohai lol
[2014-01-24 16:50:21 -0500] j^2: any good resources on ohai other than the offical docs? i'm looking for a tutorial to show a non-technical-technical-leadership
[2014-01-24 16:51:00 -0500] bmhatfield: Got a comment on my ticket: https://tickets.opscode.com/browse/OHAI-549?page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel&focusedCommentId=46187#comment-46187
[2014-01-24 16:51:02 -0500] wizgeeky: Hmm.. Here's a blog post regarding ohai: http://www.getchef.com/blog/2010/06/21/chef-0-9-0-and-ohai-0-5-6-released/
[2014-01-24 16:51:36 -0500] bmhatfield: Apparently they changed the syntax dramatically on Monday.
[2014-01-24 16:51:42 -0500] wizgeeky: doh, bmhatfield.. well - that would do it
[2014-01-24 16:51:50 -0500] j^2: wizgeeky: yeah not perfect :(
[2014-01-24 16:51:59 -0500] wizgeeky: Doesn't that mean you can checkout the 7 dev release from github?
[2014-01-24 16:52:34 -0500] wizgeeky: Wait a sec though.. I found a tweet from Nov 2013 about the same issue you have
[2014-01-24 16:53:01 -0500] wizgeeky: http://community.opscode.com/chat/chef/2013-11-25
[2014-01-24 16:53:34 -0500] wizgeeky: Top message from stevedomin is identical to what you're experiencing is it not?
[2014-01-24 16:54:00 -0500] shlant: anyone know if you HAVE to berks update/install after changes before vagrant up?
[2014-01-24 16:54:40 -0500] wizgeeky: no idea shlant.. I use berks - but because we focus on AWS i use knife-ec2 and knife-elb which are fabulous
[2014-01-24 16:56:22 -0500] stevedomin: j^2: best resource I've found on ohai at the time was the ohai source code itself
[2014-01-24 16:56:47 -0500] j^2: stevedomin: :-/ this seems like an oppertunity for me to figure it out and write something up :P
[2014-01-24 16:59:06 -0500] bmhatfield: wizgeeky: thanks for playing along btw
[2014-01-24 16:59:51 -0500] wizgeeky: hehehe - i try
[2014-01-24 16:59:53 -0500] wizgeeky: :) gl man
[2014-01-24 17:00:01 -0500] wizgeeky: curious to see how it works out for yoj
[2014-01-24 17:00:04 -0500] wizgeeky: you*
[2014-01-24 17:17:57 -0500] jroh: anyone familiar with chef+windows ?
[2014-01-24 17:18:17 -0500] j^2: jroh: a little bit
[2014-01-24 17:18:25 -0500] jroh: "Cannot find a resource for windows_package on windows version 6.0.6002" when trying to use the firefox cookbook, but it looks like does a proper depends on the windows cookbook
[2014-01-24 17:18:56 -0500] jroh: I tried looking for that error in the windows cookbook in case it would only work for certain versions of windows but it seems like it must be coming from higher up
[2014-01-24 17:19:12 -0500] j^2: have you uploaded the windows coookbook to your chef-server?
[2014-01-24 17:19:49 -0500] jroh: yep and it's on the client
[2014-01-24 17:20:06 -0500] jroh: 10... [2014..] INFO: Loading cookbooks [redacted, chef-client, cron, firefox, logrotate, windows]
[2014-01-24 17:20:18 -0500] j^2: heh that's about as far as i can help you ;) i just got some directorys and crap worring with windows and an msi or two installed
[2014-01-24 17:24:32 -0500] surge_: This is more of a ruby/command-line question, but is it possible to pass a hash to a chef handler?
[2014-01-24 17:27:15 -0500] surge_: I was thinking of trying a quoted hash and then using eval to convert it
[2014-01-24 18:16:00 -0500] cwj: surge_: is this with regard to the silencing handler?
[2014-01-24 18:16:47 -0500] cwj: sensu silencing handler that is :)
[2014-01-24 18:16:48 -0500] surge_: totally forgot i asked about this in here haha. yeah. I was going to use eval but that's ... dangerous
[2014-01-24 18:17:32 -0500] surge_: then i found a regex 1liner on SO but that was ugly... i didnt want to add a thousand options to this .. it shouldnt be a complicated handler to configure
[2014-01-24 18:17:53 -0500] surge_: and the 1 liner changed symbols to strings and i was having issues keeping it as a symbol
[2014-01-24 18:17:56 -0500] surge_: so i gave up on that
[2014-01-24 18:18:16 -0500] surge_: so i'm back to the simple 1 string per option route
[2014-01-24 18:18:36 -0500] blackice2999: hi what is common practice for attribute overriding in cookbooks ? using attributes files or use node.override in recipe ?
[2014-01-24 18:18:56 -0500] surge_: Yes ^
[2014-01-24 18:19:14 -0500] surge_: Or ... I've been doing it wrong this whole time >_>
[2014-01-24 18:19:38 -0500] cwj: blackice2999: i try to stick to node.default myself, but override will work
[2014-01-24 18:19:49 -0500] surge_: blackice2999: As in within the context of a wrapper cookbook right?
[2014-01-24 18:19:56 -0500] blackice2999: surge_: yes
[2014-01-24 18:20:01 -0500] cwj: surge_: can you just pass a hash in here https://github.com/needle-cookbooks/chef-sensu-handler/blob/master/recipes/default.rb#L44 ?
[2014-01-24 18:20:18 -0500] shlant: blackice2999: use attribute files to override community cookbooks and attributes in recipes to override those. Try not to actually use override unless absolutely necessary
[2014-01-24 18:20:24 -0500] cwj: e.g. :http_options
[2014-01-24 18:21:30 -0500] AlainODea_: is there a way to have attributes across recipes that aren't stored in the node on the server? I want to load credentials in one recipe and use them in others
[2014-01-24 18:22:05 -0500] surge_: cwj: Tried that.I put a 'puts "options = #{options}"'  in the handler for sanity and it showed up empty. That's when I passed a typical ruby hash in the form of { :key => 'value' }
[2014-01-24 18:22:18 -0500] blackice2999: AlainODea_: i am self new on chef but for me this sounds more like an "data bag"
[2014-01-24 18:22:55 -0500] enricostn: hi there, first time with Chef-solo. I'm getting the following error
[2014-01-24 18:23:00 -0500] enricostn: FATAL: NameError: runit_service[nginx] (nginx::source line 121) had an error: NameError: Cannot find a resource for load_new_resource_state on ubuntu version 12.04
[2014-01-24 18:23:13 -0500] AlainODea_: blackice2999: thank you.  I am storing the credentials in an encryped data bag. I want to avoid copy-pasting the line that loads credentials to every recipe.
[2014-01-24 18:23:37 -0500] enricostn: I'm following this tutorial http://leopard.in.ua/2013/01/04/chef-solo-getting-started-part-1/
[2014-01-24 18:24:15 -0500] AlainODea_: this is what I am hoping to share between recipes without copy/pasting it: credentials = Chef::EncryptedDataBagItem.load("credentials", node.chef_environment)
[2014-01-24 18:24:17 -0500] enricostn: I found out that it's something related to Chef version
[2014-01-24 18:24:21 -0500] surge_: cwj: I'm gonna clean up this PR and you can take a look.
[2014-01-24 18:24:26 -0500] cwj: surge_: rgr
[2014-01-24 18:24:53 -0500] enricostn: actually running vagrant up I see INFO: *** Chef 10.14.2 ***
[2014-01-24 18:25:33 -0500] enricostn: but bundler says Using chef (11.8.2)
[2014-01-24 18:25:43 -0500] enricostn: I'm confused, any hint?
[2014-01-24 18:25:50 -0500] blackice2999: shlant: if i understand you right - you would use an attribute file in a wrapper cookbook with "default[...]" right ? and only using override on special cases (that i dont see at the moment)
[2014-01-24 18:27:31 -0500] enricostn: here is the related issue https://github.com/hw-cookbooks/runit/pull/23
[2014-01-24 18:27:35 -0500] enricostn: I guess...
[2014-01-24 18:27:59 -0500] blackice2999: cwj, shlant, surge_ thanks for your help
[2014-01-24 18:28:21 -0500] cwj: enricostn: i take it that you are reading the output of bundler in the repo where you are running vagrant on your host? that doesnt necessarily correlate to the version of chef installed inside the vagrant box you are using.
[2014-01-24 18:28:41 -0500] enricostn: oh
[2014-01-24 18:28:55 -0500] cwj: enricostn: you may want to look at the vagrant-omnibus plugin which can be very helpful in ensuring your boxes have the expected version of chef installed
[2014-01-24 18:29:19 -0500] enricostn: ok thanks I'll give a look
[2014-01-24 18:31:15 -0500] rava: greetings, i'm having an issue with hosted chef where nodes seem to require the update permission, but only some of seem to
[2014-01-24 18:31:43 -0500] rava: they run the client just fine, and converge, but the last step where they attempt to PUT against the api fails with a 403
[2014-01-24 18:34:15 -0500] shlant: blackice2999:  yea, try and use close precedence instead of going straight for override http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence
[2014-01-24 18:41:37 -0500] enricostn: cwj, it works! many thanks!
[2014-01-24 18:41:46 -0500] cwj: enricostn: \m/
[2014-01-24 18:47:39 -0500] rava: answered my own question, turns out not deleting the node before trying to reregister it makes it so it doesn't create the right perms
[2014-01-24 18:53:33 -0500] bmhatfield: Okay, so I have an ohai custom attribute that properly loads
[2014-01-24 18:53:38 -0500] bmhatfield: Unfortunately it loads too late
[2014-01-24 18:53:52 -0500] bmhatfield: after attributes in recipes have been assigned
[2014-01-24 18:54:10 -0500] bmhatfield: Because the mysql cookbook does this:
[2014-01-24 18:54:11 -0500] bmhatfield: default['mysql']['bind_address']               = node.attribute?('cloud') && node['cloud']['local_ipv4'] ? node['cloud']['local_ipv4'] : node['ipaddress']
[2014-01-24 18:54:24 -0500] bmhatfield: node['ipaddress'] uses the wrong interface
[2014-01-24 18:54:33 -0500] bmhatfield: My plugin uses the right one
[2014-01-24 18:54:39 -0500] AlainODea_: it looks like Chef Libraries are the solution.  I'm trying to define a credentials method in Chef::Recipe now using that approach
[2014-01-24 18:55:04 -0500] bmhatfield: but it gets compiled in after node['mysql']['bind_address'] is already assigned
[2014-01-24 18:56:38 -0500] bmhatfield: Anyway to get that compiled in earlier?
[2014-01-24 18:56:40 -0500] wastrel: :[
[2014-01-24 19:06:48 -0500] kbarry: Struggling to get chef working,
[2014-01-24 19:06:52 -0500] kbarry: Very very new,
[2014-01-24 19:06:57 -0500] kbarry: Tryign to get my client setup,
[2014-01-24 19:07:16 -0500] kbarry: I can query and get a response fusing knife client list
[2014-01-24 19:07:23 -0500] kbarry: I am on windows 7,
[2014-01-24 19:08:00 -0500] kbarry: when I run "knife bootstrap windows winrm [servername]" i get :
[2014-01-24 19:08:02 -0500] kbarry: Bootstrapping Chef on windows
[2014-01-24 19:08:03 -0500] kbarry: ERROR: Network Error: getaddrinfo: No such host is known.
[2014-01-24 19:15:12 -0500] sn0wb1rd: looks like gmail is down!
[2014-01-24 19:18:02 -0500] wdilly: for me too.
[2014-01-24 19:18:19 -0500] d2r: same here
[2014-01-24 19:20:59 -0500] CPS: it's everybody
[2014-01-24 19:21:50 -0500] jhayden: does anyone know if it is possible to use aws-sdk from inside an ohai plugin?
[2014-01-24 19:21:53 -0500] jbz: Yeah they finally updated the status board, which means "We can't hide this anymore."
[2014-01-24 19:25:26 -0500] drrk: jbz: it's back for me now
[2014-01-24 19:25:43 -0500] jbz: I see an interface, but it won't load mail
[2014-01-24 19:26:57 -0500] drrk: odd, all fine for me
[2014-01-24 19:28:03 -0500] wdilly: its working again
[2014-01-24 19:28:20 -0500] kristianpaul: Howdy
[2014-01-24 19:30:00 -0500] kristianpaul: juliancdunn, Can a databag been generated by a chefrecipe?
[2014-01-24 19:31:36 -0500] jbz: kristianpaul: You probably *could*, but I don't think that's the intended use case.  If one node needs to learn information about another node's state, that's what attributes are for.
[2014-01-24 19:32:14 -0500] jbz: YMMV, but I use data bags for 'reference information' that nodes need to know - information placed there by humans or at least by processes outside the chef-o-sphere.
[2014-01-24 19:32:28 -0500] shlant: speaking of attributes, anyone know how to have an attribute that each recipe can add a value to and then have them all work with .each?
[2014-01-24 19:32:58 -0500] shlant: I have recipes that need different git repos
[2014-01-24 19:33:07 -0500] shlant: and I have one git recipe to check out the code
[2014-01-24 19:33:59 -0500] kristianpaul: (by humans). Indeed
[2014-01-24 19:34:37 -0500] shlant: anyone? attribute merge? how do I set that up
[2014-01-24 19:35:33 -0500] AlainODea_: shlant: you can definitely have and iterate over data bag attributes that are arrays.  I'm not sure about adding to them.
[2014-01-24 19:35:55 -0500] jbz: shlant: you can have arrays as attributes, sure.
[2014-01-24 19:36:12 -0500] shlant: but is that not the way to do it? https://coderanger.net/2013/06/arrays-and-chef/
[2014-01-24 19:37:06 -0500] shlant: what would I start with in my attribute file? no attribute? empty?
[2014-01-24 19:37:41 -0500] jbz: shlant: I stand corrected.
[2014-01-24 19:37:53 -0500] AlainODea_: shlant: I can't see any barrier to adding to an array attribute in a node or data bag attribute.  You should be able to use Ruby methods to modify the attribute and then set it back.  You should start with empty I think.  Starting with Nil may cause issues
[2014-01-24 19:39:07 -0500] shlant: basically I could do it with attributes at the same precedence, but according to coderanger that's not a good way..
[2014-01-24 19:39:42 -0500] shlant: AlainODea_: how ot I make sure it is adding to the attribute and not overwriting?
[2014-01-24 19:39:58 -0500] shlant: does the same precedence thing apply there too?
[2014-01-24 19:40:41 -0500] shlant: so would I have this in my attribute file?
[2014-01-24 19:40:45 -0500] shlant: default['git']['repos'] = ''
[2014-01-24 19:40:50 -0500] shlant: or default['git']['repos'] = []?
[2014-01-24 19:40:55 -0500] shlant: or neither
[2014-01-24 19:45:58 -0500] shlant: is this node.default['git']['repos'] = 'strike' the same as this? node.default['git']['repos'] = ['strike']
[2014-01-24 19:46:34 -0500] jtimberman: shlant: no. the first is a string, the second is an array with a string as the only element.
[2014-01-24 19:47:06 -0500] jtimberman: 2.0.0 (main):0 > 'strike'.class #=> String
[2014-01-24 19:47:17 -0500] jtimberman: 2.0.0 (main):0 > ['strike'].class #=> Array
[2014-01-24 19:47:26 -0500] shlant: jtimberman: which do I want to use if I want to add the value to the attribute and not overrite
[2014-01-24 19:47:41 -0500] jtimberman: i'd use an array
[2014-01-24 19:47:52 -0500] jtimberman: but be careful about how arrays are merged
[2014-01-24 19:48:04 -0500] shlant: that's my whole confusion
[2014-01-24 19:48:20 -0500] shlant: I want an attribute that recipes can append values to
[2014-01-24 19:48:31 -0500] jtimberman: https://coderanger.net/2013/06/arrays-and-chef/
[2014-01-24 19:48:39 -0500] shlant: yep, read that a few times
[2014-01-24 19:49:01 -0500] shlant: the example he give of arrays being confusing actually seems like the approach I want..
[2014-01-24 19:49:25 -0500] shlant: basically I have a bunch of recipes
[2014-01-24 19:49:32 -0500] shlant: they all need various git repos
[2014-01-24 19:49:39 -0500] shlant: and I have a git checkout recipe
[2014-01-24 19:49:53 -0500] shlant: I want each recipe that needs a repo to add that repo name to an attribute
[2014-01-24 19:50:00 -0500] shlant: and then the git checkout recipe to check them all out
[2014-01-24 19:50:48 -0500] shlant: would I start with default['git']['repos'] = [] in my attributes file? jtimberman
[2014-01-24 19:51:07 -0500] shlant: and then add like node.default['git']['repos'] = ['strike']?
[2014-01-24 19:52:08 -0500] AlainODea_: shlant: default['git']['repos'] = ['strike'] won't add, it will reset
[2014-01-24 19:52:35 -0500] shlant: AlainODea_: the first one will due to precedence of attribute files and recipes
[2014-01-24 19:52:39 -0500] shlant: but won't the rest add?
[2014-01-24 19:52:46 -0500] shlant: if they are all default in recipes?
[2014-01-24 19:53:09 -0500] shlant: like the first overwrites the empty default and then the recipe level one's add to it
[2014-01-24 19:54:54 -0500] enricostn: Error executing action `install` on resource 'package[libxml2-dev]'
[2014-01-24 19:55:18 -0500] enricostn: I'm getting a 404 from ubuntu servers
[2014-01-24 19:55:52 -0500] justizin: enricostn: have you apt-get update lately? sometimes you are still using an older index, which references a package version that's been removed from the archive
[2014-01-24 19:56:29 -0500] enricostn: justizin, mh how should I add it to my chef config?
[2014-01-24 19:56:44 -0500] justizin: the apt cookbook will do it for you
[2014-01-24 19:56:49 -0500] justizin: iirc, it should
[2014-01-24 19:56:50 -0500] AlainODea_: shlant: my intuition is that each recipe would need to perform some kind of append operation.  I would repos=node['git']['repos'] and then default['git']['repos'] = (repos << 'strike')
[2014-01-24 19:57:21 -0500] enricostn: justizin, I using apt cookbook but where I suppused to call the update?
[2014-01-24 19:57:27 -0500] enricostn: sorry... my first chef try
[2014-01-24 19:57:31 -0500] enricostn: :)
[2014-01-24 19:58:47 -0500] AlainODea_: enricostn: try the apt cookbook. https://github.com/opscode-cookbooks/apt
[2014-01-24 19:59:04 -0500] enricostn: I found this issue http://stackoverflow.com/questions/9246786/how-can-i-get-chef-to-run-apt-get-update-before-running-other-recipes
[2014-01-24 19:59:15 -0500] AlainODea_: enricostn: that's what I use when bootstrapping Ubuntu nodes so that APT is up to date.
[2014-01-24 19:59:33 -0500] shlant: enricostn: are you using the ubuntu cookbook as well?
[2014-01-24 19:59:44 -0500] enricostn: mmh.. nope
[2014-01-24 19:59:45 -0500] AlainODea_: enricostn: --run-list 'recipe[apt],recipe[yourstuff],...'
[2014-01-24 20:00:04 -0500] AlainODea_: enricostn: or put it in a role run list
[2014-01-24 20:00:24 -0500] shlant: or
[2014-01-24 20:00:29 -0500] shlant: in your custom recipe
[2014-01-24 20:00:46 -0500] shlant: execute "apt-get update" do
[2014-01-24 20:00:46 -0500] shlant:   ignore_failure true
[2014-01-24 20:00:49 -0500] shlant: end
[2014-01-24 20:00:50 -0500] enricostn: ok thanks Il give it a try
[2014-01-24 20:01:24 -0500] dee5: is there a best practice for accessing private github repos?
[2014-01-24 20:01:39 -0500] justizin: dee5: deploy keys, for starters
[2014-01-24 20:01:45 -0500] shlant: enricostn: actually, add include_recipe "apt" to the beginning fo your custom recipe
[2014-01-24 20:01:55 -0500] shlant: no need to put in role
[2014-01-24 20:02:00 -0500] shlant: or run list
[2014-01-24 20:02:23 -0500] shlant: dee5: http://docs.opscode.com/resource_git.html
[2014-01-24 20:02:39 -0500] AlainODea_: shlant: enricostn: include_recipe gets old fast when you have dozens of cookbooks ;)
[2014-01-24 20:02:53 -0500] kmoy: hello, im having some issues running a bootstrap w/ sudo, can someone help a noob figure out whats going on?
[2014-01-24 20:02:55 -0500] geggam: no shutty off ec2 cloud chef server... IP all change and new keys must be made
[2014-01-24 20:03:31 -0500] shlant: AlainODea_:  true
[2014-01-24 20:03:59 -0500] shlant: enricostn: this is what you want
[2014-01-24 20:04:08 -0500] AlainODea_: geggam: I accidentally deleted my Chef server while in R&D.  Good lesson to learn early.  It hurt even then :)
[2014-01-24 20:04:29 -0500] shlant: enricostn: execute "apt-get-update" do
[2014-01-24 20:04:29 -0500] shlant:   command "apt-get update"
[2014-01-24 20:04:30 -0500] shlant:   action :run
[2014-01-24 20:04:30 -0500] shlant: end
[2014-01-24 20:04:57 -0500] dee5: shlant: thanks, my next question is if there is a best practice for deploying the private ssh keys?
[2014-01-24 20:05:00 -0500] AlainODea_: geggam: it's helped a lot by using an Elastic IP and DNS
[2014-01-24 20:05:25 -0500] enricostn: shlant, I suppose that I'll have to put it in my app recipe
[2014-01-24 20:05:39 -0500] shlant: dee5: http://docs.opscode.com/chef/essentials_data_bags.html#encrypt-a-data-bag-item
[2014-01-24 20:06:20 -0500] enricostn: for ex I'm trying to provision a vagrant VM for a Rails app, so I'll create a cookbook for it and there I'll add apt get update etc
[2014-01-24 20:06:32 -0500] enricostn: more or less...
[2014-01-24 20:06:46 -0500] shlant: enricostn: if you need an update before something in your cookbook, then add that code
[2014-01-24 20:06:53 -0500] dee5: shlant: Awesome! That was what I really needed! Thanks tons!
[2014-01-24 20:07:04 -0500] shlant: dee5: happy to help
[2014-01-24 20:07:07 -0500] geggam: i can imagine AlainODea_ ... i might do that later but right now ill just delete all the nodes and recreate them :)
[2014-01-24 20:07:28 -0500] geggam: production will need something a bit more dedicated :)
[2014-01-24 20:09:57 -0500] geggam: really didnt know that the hostname / IP thing went away tho... good lesson to learn pre production :)
[2014-01-24 20:11:21 -0500] shlant: AlainODea_: so your append Idea is probably the closest so far, but it would result in duplicates
[2014-01-24 20:12:42 -0500] enricostn: vagrant is still thinking with no output, I think that's the update
[2014-01-24 20:13:01 -0500] enricostn: I was expecting a little more of output
[2014-01-24 20:16:39 -0500] enricostn: well it's the first apt update for that VM.... maybe it's normal
[2014-01-24 20:20:58 -0500] enricostn: ok it's stil alive and ruby 2 is installed
[2014-01-24 20:21:17 -0500] enricostn: now I just need to use it for the given user
[2014-01-24 20:31:03 -0500] sfiggins: I ran into a recipe order problem I don't fully understand.  Maybe someone here can explain it to me.
[2014-01-24 20:31:27 -0500] shlant: sfiggins: shoot
[2014-01-24 20:31:28 -0500] sfiggins: I'm trying to use the postfix cookbook https://github.com/opscode-cookbooks/postfix
[2014-01-24 20:31:57 -0500] enricostn: shlant, any suggestion about a good postgres cookbook?
[2014-01-24 20:31:59 -0500] sfiggins: I decided I wanted to handle some client/alias stuff on all my servers, so put postfix::aliases in my base runlist.
[2014-01-24 20:32:29 -0500] sfiggins: But I also have an smtp server that I want to configure so I made a role for that and called postfix::server for it
[2014-01-24 20:32:37 -0500] shlant: enricostn: is there more than one? http://community.opscode.com/cookbooks/postgresql
[2014-01-24 20:33:32 -0500] sfiggins: the trick is that with the aliases running first, some of the configuration settings appear to be set early, and so the smtp server settings don't all show up in the configuration file.
[2014-01-24 20:34:11 -0500] sfiggins: Any attributes overriden after inclusion of postfix::aliases don't show up.
[2014-01-24 20:35:13 -0500] shlant: sfiggins: so what does your run list look like?
[2014-01-24 20:35:20 -0500] sfiggins: Happens even if you just put aliases then server in your runlist.
[2014-01-24 20:36:08 -0500] shlant: sfiggins: well attributes get pulled and precedence decided at the start of the chef run
[2014-01-24 20:36:25 -0500] sfiggins: run_list   recipe[postfix::aliases], recipe[postfix::server] will reproduce the error for at least one setting.
[2014-01-24 20:37:22 -0500] shlant: sfiggins: which setting?
[2014-01-24 20:37:37 -0500] sfiggins: server overrides ['postfix']['main']['inet_interfaces'], but the config file will have the setting from default.
[2014-01-24 20:37:53 -0500] sfiggins: reverse the order and it works.
[2014-01-24 20:38:58 -0500] sfiggins: It looks like whatever is set the first time postfix::default gets called and defines the template resource, is what you get.
[2014-01-24 20:40:15 -0500] sfiggins: well, almost, if you add a postfix main attribute after it's defined, it will show up in the config but if you override one, the overrided value does not.
[2014-01-24 20:40:53 -0500] shlant: sfiggins: that's weird
[2014-01-24 20:40:59 -0500] shlant: looks like it should override
[2014-01-24 20:41:21 -0500] alephant: Ahoy, ahoy!
[2014-01-24 20:41:58 -0500] sfiggins: It should but maybe it's because once it's in settings, chef doesn't know the precedence of the origin anymore it may not know whether to override or not.
[2014-01-24 20:42:13 -0500] alephant: Is it relatively easy to iterate over a list of users that I get from an LDAP query? Rather than manually filling  a data bag?
[2014-01-24 20:44:12 -0500] sfiggins: Is there a way to tag a template resource definition to delay it's evaluation until the end of the first pass?
[2014-01-24 20:44:12 -0500] shlant: sfiggins: but at the start of the run, it should take all the values set for that attribute and then decide that the override takes precedence
[2014-01-24 20:45:17 -0500] sfiggins: You can see the template definitions for master and main here: https://github.com/opscode-cookbooks/postfix/blob/master/recipes/default.rb
[2014-01-24 20:47:16 -0500] sfiggins: One thing I tried was changing the cookbook template by overriding ['postfix']['main_template_source']   but ran into a bit of an order problem there as well, that override has to come before the first call to postfix::default or it's ignored as well.
[2014-01-24 20:47:31 -0500] sfiggins: doh
[2014-01-24 20:49:07 -0500] shlant: sfiggins: yea I'm not sure what's going on there, sorry
[2014-01-24 20:49:28 -0500] sfiggins: alephant: I haven't tried that. as long as your node has permission to query the ldap server I suppose it would work.  Getting an ldap library into an omnibus chef install might be a pain though.
[2014-01-24 20:49:49 -0500] alephant: Let me generalize a bit:
[2014-01-24 20:50:00 -0500] alephant: How in a chef recipe can I iterate over the output of a shell script?
[2014-01-24 20:50:17 -0500] alephant: e.g. for f in $(ls /etc/ | grep -v rc); do ...
[2014-01-24 20:50:24 -0500] alephant: ?
[2014-01-24 20:50:45 -0500] sfiggins: it's ruby.
[2014-01-24 20:51:07 -0500] sfiggins: so the question is maybe how do you iterate over the output of a shell script in ruby.
[2014-01-24 20:51:34 -0500] alephant: absolutely
[2014-01-24 20:51:39 -0500] alephant: I was analogizing :-)
[2014-01-24 20:52:16 -0500] sfiggins: mylist = %x[some_script_thing]
[2014-01-24 20:52:29 -0500] alephant: I'll try that, thanks!
[2014-01-24 20:52:37 -0500] sfiggins: mylist.each do
[2014-01-24 20:58:31 -0500] ggolin: hey all
[2014-01-24 20:59:08 -0500] ggolin: does chef11 not support extrapolating attributes in attribute files?
[2014-01-24 20:59:52 -0500] ggolin: eg default['foo']='bar'; default['baz']="#{node['foo']}"
[2014-01-24 21:00:49 -0500] spheromak: well you can do this by just setting a var
[2014-01-24 21:00:53 -0500] spheromak: foo='bar'
[2014-01-24 21:01:03 -0500] spheromak: default['foo'] = foo
[2014-01-24 21:01:11 -0500] spheromak: default['baz'] = foo
[2014-01-24 21:01:29 -0500] spheromak: tho makes it anoyting for people to override in a wrapper.
[2014-01-24 21:02:44 -0500] ggolin: im hating on this roles cookbook thing, yes
[2014-01-24 21:04:08 -0500] spheromak: no need to hate. It is just one way to solve a problem :)
[2014-01-24 21:04:48 -0500] coderanger: shlant: You pinged me?
[2014-01-24 21:08:30 -0500] geggam: roles are awesome
[2014-01-24 21:08:57 -0500] coderanger: geggam: trololol
[2014-01-24 21:15:22 -0500] geggam: im just a bit annoyed that rebooting an ec2 cloud system is so damned painful when its a chef server
[2014-01-24 21:15:34 -0500] geggam: learned even more about the server :)
[2014-01-24 21:16:01 -0500] geggam: have to write a fix the damn configs recipe
[2014-01-24 21:16:22 -0500] djustin: I've been searching for the command to create an ecnrypted data bag's 'secret file'...no luck.  Anyone know of one offhand?  Windows box.
[2014-01-24 21:16:39 -0500] djustin: create a new one, that is
[2014-01-24 21:16:45 -0500] mattupstate: djustin: there isn't one, create it yourself
[2014-01-24 21:16:54 -0500] djustin: alright, thanks
[2014-01-24 21:17:04 -0500] mattupstate: use a nice random string
[2014-01-24 21:20:57 -0500] geggam: people are using windows as a server ?
[2014-01-24 21:21:06 -0500] coderanger: geggam: No, client
[2014-01-24 21:21:33 -0500] geggam: ive wondered about that as a business model coderanger ... wanna join me.... we can start managing peoples desktops for them
[2014-01-24 21:21:47 -0500] geggam: 5/month to let them connect to chef
[2014-01-24 21:22:13 -0500] coderanger: ?
[2014-01-24 21:22:21 -0500] RSTJNII: I'm getting ERROR: undefined method `state_attrs' against a class I'm using to represent a resource in a custom LWRP when the resource is initially created.  (action name: :update)  I'm not finding much documentation on state_attrs, can someone clarify what Chef is expecting here?  I see no mention if it in http://docs.opscode.com/lwrp_custom_provider_ruby.html
[2014-01-24 21:22:31 -0500] coderanger: Setting up a windows workstation with Chef is relatively easy
[2014-01-24 21:22:57 -0500] coderanger: RSTJNII: Please pastebin the code
[2014-01-24 21:22:57 -0500] geggam: yes it is coderanger ... how many home endusers cant even upgrade windows without disaster ?
[2014-01-24 21:23:04 -0500] geggam: think about it ;)
[2014-01-24 21:23:24 -0500] RSTJNII: coderanger: https://github.com/rackspace-cookbooks/cookbook-cloudmonitoring/blob/rackspace-rebuild/providers/entity.rb
[2014-01-24 21:23:44 -0500] RSTJNII: https://github.com/rackspace-cookbooks/cookbook-cloudmonitoring/blob/rackspace-rebuild/libraries/cloud_monitoring.rb
[2014-01-24 21:24:24 -0500] coderanger: RSTJNII: Can you pastebin the traceback too?
[2014-01-24 21:24:54 -0500] RSTJNII: coderanger: Let me regenerate it, I had debug on so it is flipping huge
[2014-01-24 21:27:04 -0500] coderanger: RSTJNII: Just need the ruby traceback from the end :)
[2014-01-24 21:28:39 -0500] geggam: coderanger, does the database keep the hostname somewhere ?
[2014-01-24 21:28:56 -0500] coderanger: geggam: node['fqdn']
[2014-01-24 21:28:58 -0500] RSTJNII: coderanger: http://pastebin.com/1ssLrZjw
[2014-01-24 21:30:06 -0500] shlant: coderanger: yea I had a question in relation to your post about attribute arrays
[2014-01-24 21:30:13 -0500] shlant: heres the situation
[2014-01-24 21:30:22 -0500] shlant: I have a bunch of git repos
[2014-01-24 21:30:26 -0500] shlant: and a git repo cookbook
[2014-01-24 21:30:32 -0500] coderanger: RSTJNII: Reading, sec
[2014-01-24 21:30:49 -0500] shlant: each of my recipes need different repos
[2014-01-24 21:31:01 -0500] RSTJNII: coderanger: And it only happens when I update the resource.  Follow-up runs with the resource up to date succeed.
[2014-01-24 21:31:17 -0500] shlant: I want to have an attribute that each recipe can append their repo to, and then the git checkout recipe can check them all out
[2014-01-24 21:31:38 -0500] coderanger: RSTJNII: The thing erroring isn't a chef resource, so I have no idea why its ending up in the resource collection
[2014-01-24 21:31:50 -0500] spheromak: coderanger: you use or know of any other iptables cook thats better than simple_iptables ?
[2014-01-24 21:31:55 -0500] RSTJNII: coderanger: Yea, that's where I'm confused, too
[2014-01-24 21:32:07 -0500] coderanger: spheromak: No, I've mostly used the firewall and ufw ones
[2014-01-24 21:32:38 -0500] spheromak: iptables-ng i haven't looked at yet
[2014-01-24 21:33:05 -0500] spheromak: not happy with all the node.settin' going down in iptables_simple
[2014-01-24 21:33:09 -0500] spheromak: some bad races there
[2014-01-24 21:33:29 -0500] coderanger: shlant: Why not make a resource?
[2014-01-24 21:33:34 -0500] coderanger: shlant: and then put that resource in each recipe
[2014-01-24 21:35:24 -0500] coderanger: RSTJNII: Oh
[2014-01-24 21:35:25 -0500] coderanger: @current_resource = CMEntity.new(CMCredentials.new(node, @new_resource), @new_resource.label)
[2014-01-24 21:35:34 -0500] coderanger: RSTJNII: Thats just broken
[2014-01-24 21:36:30 -0500] shlant: coderanger: I wanted to do that initially, but didn't really understand the approach. Would the resource basically just be a wrapper for the git resource, specifying global values and taking in repo names?
[2014-01-24 21:37:14 -0500] coderanger: shlant: Basically, depends on your exact needs, either a wrapper or a subclass of the git resource
[2014-01-24 21:38:16 -0500] shlant: coderanger: basically, what I have now is the git resource in every recipe that needs it and repos needed are specified in the recipe
[2014-01-24 21:38:27 -0500] coderanger: shlant: Whats wrong with that?
[2014-01-24 21:38:50 -0500] coderanger: RSTJNII: Oh, are you writing that code?
[2014-01-24 21:39:07 -0500] shlant: coderanger: nothing "wrong" I guess but have like 8-10 lines of almost the same code in every recipe seems unnecessary
[2014-01-24 21:39:12 -0500] RSTJNII: coderanger: Refactoring
[2014-01-24 21:39:36 -0500] RSTJNII: I wrote the classes, but the use of @current_resource was mimicking the old code
[2014-01-24 21:39:45 -0500] coderanger: RSTJNII: I really need to do some "teach RS how to Chef" classes or something :-)
[2014-01-24 21:39:57 -0500] coderanger: RSTJNII: but short version, current_resource has to actually be a resource
[2014-01-24 21:40:12 -0500] allaire: How can I send a restart notification to a service like mysql, normaly I use notifies in a block, but now I just want to send it a restart, so I can't use notifies in let say a template block
[2014-01-24 21:40:20 -0500] coderanger: the reporting code analyzes provider.current_resource and provider.new_resource to build diffs
[2014-01-24 21:40:41 -0500] RSTJNII: coderanger: Okay.  So my class object contains the state of the entity.  How do I hook that into current_resource, if that is even required?
[2014-01-24 21:40:46 -0500] coderanger: allaire: No difference, just notifies :restart, 'service[mysql]'
[2014-01-24 21:41:01 -0500] coderanger: RSTJNII: Your class object that models the state of things should be a Chef resource
[2014-01-24 21:41:09 -0500] coderanger: thats the definition of a chef resource in fact :)
[2014-01-24 21:41:19 -0500] allaire: @coderanger: ah, I thought it obligatory had to go in a ressource :)
[2014-01-24 21:41:30 -0500] coderanger: allaire: It does?
[2014-01-24 21:41:45 -0500] coderanger: allaire: Whats the thing doing the notification?
[2014-01-24 21:42:01 -0500] coderanger: notifications are an expression of state deltas
[2014-01-24 21:42:13 -0500] shlant: allaire: service "service_name" do
[2014-01-24 21:42:14 -0500] shlant:   action :restart
[2014-01-24 21:42:14 -0500] shlant: end
[2014-01-24 21:42:32 -0500] allaire: even if the service is already declared?
[2014-01-24 21:42:50 -0500] coderanger: Yes
[2014-01-24 21:43:04 -0500] coderanger: but thats just an unconditional restart, very rarely what you want to do
[2014-01-24 21:43:16 -0500] allaire: roger that, thank you
[2014-01-24 21:43:18 -0500] fohand: Having trouble with azure knife.  Getting "ERROR: Failed to create the server -- exception being rescued: undefined method `content' for nil:NilClass" and not sure how to investigate.
[2014-01-24 21:43:38 -0500] shlant: coderanger: so would a wrapper or subclass be what I'm looking ofr?
[2014-01-24 21:43:59 -0500] coderanger: shlant: Whats wrong with just using the git resource? Can you give me an example of the code?
[2014-01-24 21:44:17 -0500] coderanger: Is there something more complex you need to do when checking out each repo?
[2014-01-24 21:45:09 -0500] geggam: ok... so aside from /etc/chef-server/chef-server-running.json where is the bookshelf url defined ?
[2014-01-24 21:45:24 -0500] shlant: coderanger: not really, I have an ssh wrapper
[2014-01-24 21:45:39 -0500] coderanger: shlant: Whats it do?
[2014-01-24 21:45:41 -0500] shlant: my git resource is 10 lines
[2014-01-24 21:45:57 -0500] coderanger: geggam: etc/chef-server/chef-server.rb, which doesn't exist by default
[2014-01-24 21:46:10 -0500] coderanger: shlant: then a subclass of git seems like it would be what you want, just set some default params
[2014-01-24 21:47:28 -0500] shlant: coderanger: anywhere where I coud find an example of one?
[2014-01-24 21:47:37 -0500] coderanger: shlant: Probably nowhere :-)
[2014-01-24 21:47:39 -0500] coderanger: One sec
[2014-01-24 21:49:15 -0500] coderanger: shlant: Can you pastebin your git resource
[2014-01-24 21:49:20 -0500] coderanger: or at least one or two lines of it
[2014-01-24 21:50:07 -0500] shlant: coderanger: https://gist.github.com/MrMMorris/223ac6bf011e18e3fcba
[2014-01-24 21:51:25 -0500] coderanger: shlant: Reload your gist
[2014-01-24 21:51:31 -0500] coderanger: shlant: I left an example as a comment
[2014-01-24 21:52:30 -0500] Dairenn: Chicken and egg issue with the "postgres" (root user) role.  You have to set its password if you connect to the Postgres server at 127.0.0.1, but, if the password is not set to anything yet, what should you put in the default attribute for the postgres Cookbook in order to make that initial connection?
[2014-01-24 21:53:11 -0500] shlant: coderanger: awesome! and then how would I use it in recipes?
[2014-01-24 21:53:41 -0500] dgarstang1: Anyone here use pychef?
[2014-01-24 21:53:46 -0500] shlant: specifying the repo name
[2014-01-24 21:54:17 -0500] dgarstang1: coderanger: :-\
[2014-01-24 21:56:59 -0500] cnk_: dgarstang1: no, but thanks for bringing it up. It might be nice in my group here at $work
[2014-01-24 21:58:06 -0500] dgarstang1: cnk_: oh, you didn't know about it? Yah, tis handy. :)
[2014-01-24 21:58:33 -0500] cnk_: just getting into chef - which I like for its rubyness
[2014-01-24 21:58:43 -0500] cnk_: but others prefer the snakes
[2014-01-24 21:58:53 -0500] dgarstang1: cnk_: Works well, except Search i think has an issue. Was hoping the author Mr Coderanger was watching
[2014-01-24 21:59:13 -0500] coderanger: shlant: my_git 'asdf' do  end
[2014-01-24 21:59:20 -0500] coderanger: shlant: Same as the git resource
[2014-01-24 21:59:26 -0500] cnk_: I am getting used to them
[2014-01-24 21:59:29 -0500] coderanger: dgarstang1: Hmm?
[2014-01-24 21:59:37 -0500] coderanger: dgarstang1: Also doing $dayjob stuff, whats up?
[2014-01-24 22:01:05 -0500] dgarstang1: coderanger: Search... didn't seem to work. I had a node calle abc01-eu2.foo.net which a knife node list was returning. Doing that with pychef, Search('node', 'name:abc01-eu2.foo.net') wasn't returning anyway, but it does when I leave the name of
[2014-01-24 22:01:19 -0500] dgarstang1: ie and filter result
[2014-01-24 22:01:21 -0500] geggam:  thanks again coderanger ... server.rb was what i needed
[2014-01-24 22:01:36 -0500] coderanger: dgarstang1: Does it work with knife search?
[2014-01-24 22:02:41 -0500] shlant: coderanger: thanks so much. been bugging me for a while :)
[2014-01-24 22:03:03 -0500] coderanger: shlant: It's all Ruby, all the way down
[2014-01-24 22:03:05 -0500] coderanger: :)
[2014-01-24 22:04:13 -0500] coderanger: Dairenn: The iniital conn is made locally using the postgres user, which should have domain socket ident auth enabled
[2014-01-24 22:04:56 -0500] Dairenn: So in other words, chef-client will connect as though I did a sudo su postgres -c "pgsql" from the bash prompt...
[2014-01-24 22:05:18 -0500] Dairenn: Does that mean then I should not be using these host and port vars?
[2014-01-24 22:05:44 -0500] coderanger: Dairenn: What are you trying to do?
[2014-01-24 22:25:31 -0500] Cope: ohai coderanger :)
[2014-01-24 22:25:35 -0500] coderanger: Cope: Yo
[2014-01-24 22:41:20 -0500] funjon: is anyone else using hosted chef seeing an issue where uploaded cookbooks aren't being passed along to clients?
[2014-01-24 23:06:55 -0500] Cope: funjon: no... but if you are, are you can reproduce it... support@ would like to hear about it, I'm sure
[2014-01-24 23:07:12 -0500] funjon: yeah, that was weird
[2014-01-24 23:07:21 -0500] funjon: i had to delete all versions of my cookbook and reupload to make it start going again
[2014-01-24 23:07:29 -0500] Cope: :(
[2014-01-24 23:07:37 -0500] funjon: i blame google
[2014-01-24 23:07:39 -0500] kallen: i asked in #berkshelf, but i see opscode is taking over stewardship of it, so i'll ask here about berkshelf. the setup:
[2014-01-24 23:07:47 -0500] kallen: i create an example cookbook using berks -- "berks cookbook example"
[2014-01-24 23:07:56 -0500] kallen: in example's metadata.rb i set "depends 'java'"
[2014-01-24 23:08:08 -0500] kallen: i run berks install, and the java cookbook is dl'd into ~/.berkshelf/cookbooks/java-1.19.0
[2014-01-24 23:08:17 -0500] kallen: then, i want to use chef-solo to test the cookbook. my solo.rb is like so:
[2014-01-24 23:08:25 -0500] kallen: root = File.absolute_path(File.dirname(__FILE__))
[2014-01-24 23:08:30 -0500] kallen: cookbook_path [ root + '/cookbooks', '/home/kallen/.berkshelf/cookbooks' ]
[2014-01-24 23:08:39 -0500] kallen: however, when running chef-solo on the cookbook, it can't find the java cookbook
[2014-01-24 23:08:48 -0500] kallen: as a workaround, i symlink ~/.berkshelf/cookbooks/java-1.19.0 to ~/.berkshelf/cookbooks/java, then it works
[2014-01-24 23:08:55 -0500] kallen: is that expected? is there something i'm missing?
[2014-01-24 23:09:02 -0500] rkesters2: sqerl unable to connect to database after install with omnibuss
[2014-01-24 23:09:18 -0500] rkesters2: any clue how to fix, running on RHEL 6
[2014-01-24 23:12:40 -0500] rkesters2: kallen that is how bershelf works, I believe if you vendor the cookbook it will remove the version number
[2014-01-24 23:12:58 -0500] kallen: how do i "vendor the cookbook"?
[2014-01-24 23:13:02 -0500] rkesters2: vendor by using berks install --path vendor/cookbooks
[2014-01-24 23:13:25 -0500] kallen: i'll try that. thx.
[2014-01-24 23:16:39 -0500] kallen: let's say my dir structure for development is ~/chef-repo/cookbooks/[cookbook-names]
[2014-01-24 23:17:04 -0500] kallen: the Berksfile for the 'example' cookbook is in ~/chef-repo/cookbooks/example/Berksfile
[2014-01-24 23:17:32 -0500] kallen: at what place in the dir structure do i run 'berks install --path vendor/cookbooks' ?
[2014-01-24 23:18:14 -0500] kallen: i would think i might want the vendor cookbooks to appear in ~/chef-repo/vendor .. and i'd add vendor to .gitignore
[2014-01-24 23:18:55 -0500] kallen: so i wonder if this invocation will work: cd ~/chef-repo; berks install --path vendor/cookbooks -c cookbooks/example/Berksfile
[2014-01-24 23:20:52 -0500] kallen: when i try that, i get error: No Berksfile or Berksfile.lock found at '/home/kallen/chef-repo'!
[2014-01-24 23:21:40 -0500] Cope: kallen: you need to run berks .... at a place in the filesystem where there's a berksfile
[2014-01-24 23:21:49 -0500] Cope: --path can refer to anywhere you like
[2014-01-24 23:21:58 -0500] kallen: ohai
[2014-01-24 23:22:12 -0500] Cope: berks install --path /home/cider/is/yummy/and/so/is/bacon/cookbooks
[2014-01-24 23:22:28 -0500] Cope: iirc it even creates the intermediate directories if they're not present
[2014-01-24 23:22:32 -0500] Cope: but don't hold me to that
[2014-01-24 23:23:36 -0500] kallen: ok. that worked. thanks. and, i wonder why it created both 'java' and 'example' under ~/chef-repo/vendor/cookbooks
[2014-01-24 23:23:49 -0500] ggolin: how evil is putting things into run_state?
[2014-01-24 23:26:36 -0500] Cope: ggolin: very
[2014-01-24 23:26:54 -0500] ggolin: why?
[2014-01-24 23:27:02 -0500] Cope: well
[2014-01-24 23:27:32 -0500] Cope: it's a servicable hack... I first used it back in the ancient times of the very first application cookbook
[2014-01-24 23:28:05 -0500] Cope: but i feel uncomfortable about it - why do you need to store intermediate state during a chef run?
[2014-01-24 23:28:16 -0500] Cope: could you rearchitect what you'r doing?
[2014-01-24 23:29:40 -0500] Cope: imo it falls into the category of: just because you can, doesn't mean you should
[2014-01-24 23:30:12 -0500] ggolin: well
[2014-01-24 23:30:16 -0500] ggolin: (haha)
[2014-01-24 23:30:36 -0500] coderanger: ggolin: Do as I say not as I do
[2014-01-24 23:30:58 -0500] ggolin: is that an observation or an order, coderanger ?
[2014-01-24 23:31:46 -0500] funjon: fiddling with run_state is kind of like sticking your dick in the pickle slicer.
[2014-01-24 23:31:57 -0500] funjon: maybe you get a thrill, and maybe everything works out ok, but for the love of god just don't do it
[2014-01-24 23:32:09 -0500] coderanger: ggolin: Is there a difference?
[2014-01-24 23:32:11 -0500] ggolin: ive tried one of these things and i can attest its not like the other.
[2014-01-24 23:32:37 -0500] Cope: ggolin: did you get a thrill?
[2014-01-24 23:32:50 -0500] ggolin: i got a new slicer
[2014-01-24 23:33:03 -0500] ggolin: but whatever the case may be.
[2014-01-24 23:33:04 -0500] funjon: sounds like everything did not work out ok, then, now did it
[2014-01-24 23:33:05 -0500] Cope: how's your dick?
[2014-01-24 23:33:18 -0500] ggolin: good, thanks for asking, hows yours? :)
[2014-01-24 23:33:29 -0500] Cope: fine! ... moving on :)
[2014-01-24 23:33:33 -0500] ggolin: ahahah
[2014-01-24 23:34:46 -0500] Cope: ggolin: so in all seriousness... what problem are you trying to solve?
[2014-01-24 23:36:02 -0500] rkesters2: Has anyone been able to get chef-server to install on RHEL 6, I keep getting an error that sqerl can't connect to the DB
[2014-01-24 23:36:21 -0500] ggolin: just moving a piece of data between recipes
[2014-01-24 23:36:38 -0500] Cope: ggolin: why
[2014-01-24 23:42:21 -0500] dee5: What is the benefit of defining a start_command, stop_command, and reset_command of a server over just using the commands themselves? Can those commands be used repeatedly?
[2014-01-24 23:42:49 -0500] coderanger: dee5: Service resources can be used more easily with stuff like notifications
[2014-01-24 23:48:09 -0500] Majost: Anyone know if there is a trick to testing users with chefspec which are populated with the users cookbook
[2014-01-24 23:49:09 -0500] Cope: Majost: I wouldn't use chefspec for that
[2014-01-24 23:49:19 -0500] Cope: what are you actually trying to test?
[2014-01-24 23:51:28 -0500] Cope: Majost: chefspec is for unit testing at the resource level; it's optimal for the author of the cookbook to verify signal <-> out
[2014-01-24 23:52:23 -0500] Cope: if you want to verify that the cookbook you are usinh has delivered the functionality you desire, post-converge, I'd use kitchenci + whateveryouliketotestwith
[2014-01-24 23:58:49 -0500] Majost: yeah
[2014-01-24 23:58:52 -0500] Majost: in this case
[2014-01-24 23:58:57 -0500] Majost: I need a set of users to be dropped
[2014-01-24 23:59:09 -0500] Majost: and I want to validate that works
[2014-01-24 23:59:20 -0500] Cope: tbh I delegate all that shit to ldap these days
[2014-01-24 23:59:36 -0500] Cope: trying to manage users at any scale using chef seems like a bit of a ballache
[2014-01-24 23:59:52 -0500] Majost: its a service account set
[2014-01-24 23:59:57 -0500] Cope: really afk now! but will check back in a bit
