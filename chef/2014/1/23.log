[2014-01-23 00:02:56 -0500] programmerq: so, this question is directed more at the opscode folks. Does opscode have any kind of "chef certification" or anything? Does opscode have any issues with people advertising chef expertise (like for contract work)? any trademark or other requirements to be aware of?
[2014-01-23 00:11:15 -0500] coderanger: programmerq: There is no certification, though its been vaguely talked about as maybe one day
[2014-01-23 00:11:45 -0500] coderanger: programmerq: As for advertising, nominative use is a thing :)
[2014-01-23 00:12:12 -0500] coderanger: So you can use the Chef mark and logo to indicate Chef itself, you couldn't, for example, alter the Chef logo to make your own logo
[2014-01-23 00:13:09 -0500] coderanger: programmerq: There isn't anything official for advertising your services, dice/monster/etc are more where I would look for that
[2014-01-23 00:53:38 -0500] doomviking: just say "I'm the man. I'm bad. I'm so bad I should be in detention. I'm the man."
[2014-01-23 01:23:43 -0500] kcb_: hoping to ask sean omeara a question, don't know his nick though if he's around...
[2014-01-23 01:24:15 -0500] flaccid: someara ^
[2014-01-23 01:24:26 -0500] kcb_: flaccid, lol, of course
[2014-01-23 01:24:29 -0500] someara: sup
[2014-01-23 01:46:55 -0500] jtimberman: programmerq: trademark policy: http://getchef.com/trademark-policy/
[2014-01-23 01:51:13 -0500] rmg: is there a way populate attributes at compile time from the contents of a file?
[2014-01-23 01:51:38 -0500] rmg: in plain old Ruby, I'd just do something like:cheksums = Hash[ IO.read('SHASUM256.txt').lines.map(&:split).map(&:reverse) ]
[2014-01-23 01:52:02 -0500] flaccid: rmg: use an node.json with your run or use roles
[2014-01-23 01:55:17 -0500] rmg: flaccid: the data is not node or role specific
[2014-01-23 01:55:37 -0500] flaccid: rmg: whats it for?
[2014-01-23 01:55:52 -0500] rmg: checksums for verifying remote_file downloads
[2014-01-23 01:56:51 -0500] flaccid: rmg: are the checksums all in the one file or one file per checksum?
[2014-01-23 01:57:38 -0500] rmg: flaccid: checksums are all in one file, as is the convention
[2014-01-23 01:58:04 -0500] coderanger: jtimberman: That page is a really long version of "nominative use"
[2014-01-23 01:58:11 -0500] flaccid: well i'd probably IO.read from the files/ and use it with the checksum attribute of remote_file
[2014-01-23 01:58:59 -0500] rmg: flaccid: yes, but how?
[2014-01-23 01:59:22 -0500] flaccid: rmg: do you have code already you are playing with?
[2014-01-23 01:59:46 -0500] rmg: that's what my example above was.. I'm failing to find the Chef way of accessing the file
[2014-01-23 02:02:12 -0500] rmg: do I seriously have to copy the file to every node and re-read it from there?
[2014-01-23 02:02:41 -0500] flaccid: someone like coderanger might know the best way to reference the location of the file you might have to do joins relative to __FILE__
[2014-01-23 02:02:47 -0500] coderanger: Hmm?
[2014-01-23 02:02:50 -0500] coderanger: Whats the goal?
[2014-01-23 02:03:05 -0500] flaccid: or yeah cookbook_file install it to the system and then have the remote_file resource use that
[2014-01-23 02:03:17 -0500] coderanger: yeah, you can't access stuff relative to recipe files
[2014-01-23 02:03:26 -0500] coderanger: since its only downloaded as needed
[2014-01-23 02:03:42 -0500] flaccid: right, that explains it
[2014-01-23 02:03:51 -0500] coderanger: so either use the an API to get the data you need, or cookbook_file + ruby_block
[2014-01-23 02:04:02 -0500] coderanger: Hint: Chef isn't a database
[2014-01-23 02:04:24 -0500] flaccid: cookbook_file to the chef cache i guess would be reasonable
[2014-01-23 02:04:39 -0500] coderanger: Where is this data coming from?
[2014-01-23 02:04:55 -0500] coderanger: If its just part of the cookbook, put it in a recipe file and use it directly
[2014-01-23 02:05:04 -0500] rmg: coderanger: a checksum file stored in the cookbook
[2014-01-23 02:05:07 -0500] coderanger: if its coming from an external system, query that system from the recipe code
[2014-01-23 02:05:31 -0500] coderanger: rmg: Sure, so throw a heredoc at the top of your recipe file
[2014-01-23 02:05:34 -0500] coderanger: end of problem :)
[2014-01-23 02:05:47 -0500] kcb_: if your external system isn't queryable, perhaps data bags?
[2014-01-23 02:06:12 -0500] coderanger: (but really, they are)
[2014-01-23 02:09:41 -0500] rmg: coderanger: I was hoping to avoid modifying the file every time I re-import it into the repo for updates
[2014-01-23 02:09:51 -0500] coderanger: rmg: Where are you importing it from?
[2014-01-23 02:09:54 -0500] kcb_: lol, so are roles but whatev
[2014-01-23 02:10:03 -0500] coderanger: and why not just query that system directly
[2014-01-23 02:10:13 -0500] flaccid: rmg: if you don't want to manage the file in the cookbook, you can just remote_file it
[2014-01-23 02:10:45 -0500] coderanger: flaccid: If its on a remote server, no need to remote_file + IO.read, just make the HTTP request yourself :)
[2014-01-23 02:10:56 -0500] rmg: coderanger: downloading from the same website as the binaries the checksums are for..
[2014-01-23 02:11:39 -0500] flaccid: coderanger: with what exactly? that seems to diverge from chef convention
[2014-01-23 02:11:39 -0500] coderanger: rmg: Okay, so just use your Ruby HTTP client of choice and grab the data in your recipe code
[2014-01-23 02:11:49 -0500] coderanger: flaccid: Net::HTTP or RestClient
[2014-01-23 02:11:55 -0500] coderanger: (or Faraday, etc)
[2014-01-23 02:12:38 -0500] rmg: coderanger: that defeats the purpose of verifying the checksums other than for download corruption
[2014-01-23 02:13:04 -0500] flaccid: personally, i'd want to treat the checksum file as a resource but if for some reason the sums change i guess you can just be totally arbitrary but when the http response is garbage your run will explode
[2014-01-23 02:13:22 -0500] coderanger: rmg: How are you verifying them otherwise?
[2014-01-23 02:13:45 -0500] coderanger: rmg: if they are coming from the same place, you have to presume that can be MitM'd just as much as the files
[2014-01-23 02:14:13 -0500] rmg: download the checksum file, manually verify that the sums are for trusted files, store sums with cookbook
[2014-01-23 02:14:17 -0500] flaccid: thats the thing, you are trusting whatever if you don't have at least one static sum to check in your cookbook
[2014-01-23 02:14:24 -0500] coderanger: rmg: That is not actually secure
[2014-01-23 02:14:38 -0500] coderanger: rmg: You're just saying "if there was a compromise, it was over a long time"
[2014-01-23 02:14:46 -0500] rmg: then at a later time you can download the binaries and ensure that the same files were downloaded as you verified locally
[2014-01-23 02:15:09 -0500] coderanger: rmg: Yes, but you have no way to know if thats the Correct content or not
[2014-01-23 02:15:36 -0500] rmg: coderanger: you do if you're paranoid
[2014-01-23 02:16:05 -0500] coderanger: rmg: No, if you're paranoid you would be resigning the packages with an asym key of some kind :)
[2014-01-23 02:16:44 -0500] flaccid: if you were really paranoid you wouldn't even use anything remote :p
[2014-01-23 02:18:48 -0500] rmg: coderanger: new question then... repeat all of the above and pretend the file is a GPG signature and I still don't want to modify it each time I regenerate it
[2014-01-23 02:19:20 -0500] coderanger: rmg: So in your recipe code, Net::HTTP.get('https://whatever/foo.pem')
[2014-01-23 02:19:29 -0500] coderanger: rmg: And then use that to verify your download
[2014-01-23 02:19:58 -0500] coderanger: rmg: "it's just ruby code" :D
[2014-01-23 02:20:46 -0500] rmg: coderanger: unless you're trying to read arbitrary files in the same directory as your ruby code, apparently
[2014-01-23 02:21:13 -0500] flaccid: either way, NSA will read your shiz
[2014-01-23 02:21:34 -0500] coderanger: rmg: Heh, you could do a similar thing using the Chef API via chef_server_rest.get_rest('cookbooks/foo/1.0.0/files/etc'
[2014-01-23 02:21:45 -0500] coderanger: rmg: But its easier to explain if you just use a normal HTTP server
[2014-01-23 02:21:56 -0500] rmg: flaccid: it's all good as long as they aren't modifying it
[2014-01-23 02:23:53 -0500] flaccid: hehe
[2014-01-23 02:24:09 -0500] rmg: it's just the execution model I'm struggling with.. "it's just ruby" should be more like: ssh user@remote ruby -e 'puts "it\'s just ruby"'
[2014-01-23 02:26:28 -0500] coderanger: rmg: So recipes are "just ruby" but they are instance_eval'd against the body of a class, not run directly
[2014-01-23 02:26:38 -0500] coderanger: so some bits of scoping don't work as you would expect
[2014-01-23 02:27:27 -0500] rmg: ya, the useful bits of scoping :P
[2014-01-23 02:27:36 -0500] coderanger: rmg: Protip, stop writing recipes
[2014-01-23 02:28:15 -0500] rmg: coderanger: as in give up on Chef, or use Chef another way?
[2014-01-23 02:28:23 -0500] coderanger: rmg: Write resources :)
[2014-01-23 02:29:07 -0500] coderanger: rmg: Example: https://github.com/balanced-cookbooks/jenkins/blob/master/libraries/jenkins_job.rb
[2014-01-23 02:29:24 -0500] coderanger: rmg: For those, its Really Really Just Ruby Code
[2014-01-23 02:29:26 -0500] rmg: coderanger: I'd love to, where are the docs?
[2014-01-23 02:29:33 -0500] coderanger: rmg: You're talking to 'em
[2014-01-23 02:30:39 -0500] flaccid: classic
[2014-01-23 02:31:53 -0500] coderanger: flaccid: They don't call it "bleeding edge" for the extra tourists
[2014-01-23 02:32:36 -0500] flaccid: enterprise
[2014-01-23 02:33:02 -0500] coderanger: flaccid: Enterprise http://www.iowascribe.com/uploads/6/9/0/1/6901504/4926612_orig.jpg
[2014-01-23 02:33:08 -0500] rmg: I'd really really rather just RTFM.. if I could find TFM I'm looking for
[2014-01-23 02:33:59 -0500] coderanger: rmg: Spelunking the depths away from the DSL is not particularly documented and we're all still trying to figure out how to do it best
[2014-01-23 02:34:01 -0500] flaccid: well there is docs for writing lwrps and libraries
[2014-01-23 02:35:27 -0500] rmg: ah, this might work for me: http://www.rubydoc.info/github/opscode/chef/master/frames/index
[2014-01-23 02:36:27 -0500] coderanger: rmg: Here Be Dragons
[2014-01-23 02:37:11 -0500] rmg: coderanger: should I be reading the source instead?
[2014-01-23 02:37:37 -0500] coderanger: rmg: Just saying that you are off the beaten path and I recommend asking questions often :)
[2014-01-23 02:41:52 -0500] rmg: coderanger: usually my last resort, but I'll keep it in mind
[2014-01-23 02:53:42 -0500] sonofuns: Has anyone stumbled on a feature comparison matrix of AWS Opsworks vs Opscode Enterprise Private vs Opscode Enterprise Hosted vs Community server?
[2014-01-23 02:54:26 -0500] coderanger: sonofuns: Hmm
[2014-01-23 02:54:41 -0500] coderanger: so OpsWorks vs. chef-server is almost incomparable
[2014-01-23 02:55:22 -0500] coderanger: FOSS vs. Enterprise, the paid one gets you more granular ACLs, resource reporting, a nicer (usable) webui, and HA support
[2014-01-23 02:57:40 -0500] sonofuns: Specifically I am looking for the best approach with auth that supports installing a client to an existing instance and magics control over the machine from then on as opposed to it controlling making making fresh builds and all layers. I have some legacy that needs remain as is before Chef touches it and when I redo all the images as layers I should be right to go the pure model of instantiating
[2014-01-23 02:57:41 -0500] sonofuns: vanillas and builing up from there.
[2014-01-23 02:59:31 -0500] joonas: coderanger: I'm curious, do you use https://github.com/coderanger/chef-sentry-handler in production
[2014-01-23 02:59:39 -0500] flaccid: cloud management platforms that support chef are also an option here
[2014-01-23 02:59:41 -0500] rmg: according to the AWS docs, "AWS OpsWorks is based on Chef Solo, and currently supports version 0.9 and 11.4 (usually referred to as Chef 11)."
[2014-01-23 03:00:03 -0500] sonofuns: at this point its all baked AWS ec2 ami fodder unfortunately.
[2014-01-23 03:00:37 -0500] flaccid: you don't has to bakes  if you use cloud-init
[2014-01-23 03:01:01 -0500] coderanger: rmg: It also uses ruby 1.8, and as such in incompatible with a lot of cookbooks
[2014-01-23 03:01:12 -0500] joonas: if you are curious about opsworks, foodfighshow has a pretty good episode on it
[2014-01-23 03:01:32 -0500] coderanger: joonas: I don't oddly enough, I used to but I just haven't gotten to deploying it at $NEWJOB
[2014-01-23 03:01:38 -0500] coderanger: joonas: getsentry uses it though :-)
[2014-01-23 03:01:45 -0500] joonas: coderanger: neat
[2014-01-23 03:01:55 -0500] joonas: coderanger: btw grats on the $NEWJOB, they are a great bunhc
[2014-01-23 03:02:00 -0500] joonas: bunch
[2014-01-23 03:02:13 -0500] sonofuns: flaccid: yeh the cloud init and equiv in cloudformation (another experiment) are in use but its not fantastically sustainable for me. Thus Chef is of interest.
[2014-01-23 03:02:36 -0500] rmg: coderanger: good to know
[2014-01-23 03:02:53 -0500] coderanger: sonofuns: CF and friends are provisioning management, thats separate from server config
[2014-01-23 03:03:13 -0500] coderanger: sonofuns: Chef doesn't do provisioning management at all (unless you count knife or something) so the two are orthogonal
[2014-01-23 03:04:13 -0500] sonofuns: coderanger: that much I have learned and is precisely the unsustainable aspect of it. CI-wise I guess. Knife provider for ec2 is something I did stumble on in the starter kit there at opscode
[2014-01-23 03:04:28 -0500] flaccid: i prefer using something that is multicloud, not cloud specific only
[2014-01-23 03:04:28 -0500] coderanger: sonofuns: knife-ec2 is a toy, not something I would use to manage production systems
[2014-01-23 03:04:36 -0500] coderanger: its nice for "I need a test server right now" though
[2014-01-23 03:04:49 -0500] coderanger: flaccid: In your completely unbiased opinion, of course ;-)
[2014-01-23 03:04:52 -0500] flaccid: and also not something that requires ssh on the instance
[2014-01-23 03:05:01 -0500] flaccid: coderanger: totally
[2014-01-23 03:06:50 -0500] sonofuns: coderanger: urgh. So could anyone recommend a cloud-init to bootstrap in chef client to become a node and then it register to server. ie. community server should be appropriate. The hosted aspect of it did interest me though portwise I wasnt sure on what I needed open. Opswork makes a dogs breakfast of security groups to do what it does.
[2014-01-23 03:07:10 -0500] coderanger: sonofuns: That is literally what we do
[2014-01-23 03:07:25 -0500] coderanger: CF + cloudinit + self-bootstrapping + FOSS chef server
[2014-01-23 03:08:02 -0500] coderanger: You have to drink a lot of AWS kool aid, but it works
[2014-01-23 03:08:25 -0500] coderanger: (for definitions of "works" that mostly include "I want to whip every person that worked on these services")
[2014-01-23 03:08:33 -0500] sonofuns: sorry, is CF = Cloudformation to automagic your chef server environment?
[2014-01-23 03:08:55 -0500] coderanger: Yes, cloudformation by way of troposphere
[2014-01-23 03:09:29 -0500] coderanger: cloudformation is basically just a declarative form of "here are some autoscaling groups (ASGs), go start them"
[2014-01-23 03:10:36 -0500] coderanger: Sorry for the buzzword bingo, its a gnarly topic >_<
[2014-01-23 03:11:09 -0500] flaccid: its all good if you don't mind being locked in to aws
[2014-01-23 03:11:59 -0500] coderanger: flaccid: Don't make me come over there :P
[2014-01-23 03:12:07 -0500] sonofuns: coderanger: The use of a windows workstation to control the whole shebang seems something opscode promote(?). Is this evil (caveat ridden compared to say any other platform for the role?)
[2014-01-23 03:12:28 -0500] coderanger: (for those playing along at home, flaccid is 100% right, he just also happens to work for a cross-cloud competitor)
[2014-01-23 03:12:49 -0500] coderanger: sonofuns: Workstation, yes. Windows, no.
[2014-01-23 03:13:04 -0500] coderanger: I mean you could, but there is no predisposition towards Windows for the management systems
[2014-01-23 03:13:16 -0500] coderanger: Personally I use OS X, though we have a few Linux users here too
[2014-01-23 03:13:44 -0500] flaccid: i wouldn't say we compete with IaaS though
[2014-01-23 03:14:20 -0500] sonofuns: coderanger: the mind was that when the virtual workstation service is released to the wild I could have profiles for particular user levels of the management station.
[2014-01-23 03:14:38 -0500] flaccid: for workstation i use arch linux or os x. cli is no fun on windows thats for sure but you can do stuff if you wanted
[2014-01-23 03:14:43 -0500] coderanger: sonofuns: I'm afraid I don't follow, sorry
[2014-01-23 03:14:59 -0500] coderanger: sonofuns: Your workstation is your actual workstation, the thing you work on every day
[2014-01-23 03:15:05 -0500] flaccid: maybe they are in the business of VDI
[2014-01-23 03:15:33 -0500] coderanger: Heh, possible
[2014-01-23 03:16:41 -0500] sonofuns: flaccid: yes the service is in preview (to accepted use case preview customers)
[2014-01-23 03:17:37 -0500] coderanger: sonofuns: You are talking about Amazon's virtual workstations thingy?
[2014-01-23 03:17:39 -0500] flaccid: looks like you an aussie too sonofuns?
[2014-01-23 03:18:08 -0500] sonofuns: flaccid: Aussie as!
[2014-01-23 03:18:35 -0500] coderanger: Damn upside down people
[2014-01-23 03:18:36 -0500] flaccid: cool, i'm in sydney
[2014-01-23 03:18:58 -0500] flaccid: well you guys are actually in the past, coz we are +10/11 utc
[2014-01-23 03:19:39 -0500] wastrel: hi i tried to read the chef intro on the chef website on my android but it the page crashed the browser
[2014-01-23 03:20:24 -0500] sonofuns: VDI from AWS will be $30 a month with 5 blattable profiles. I work with Windows folks but have no religious attachment to any OS, they all disappoint at one time or another. Interestingly Powershell isnt poopooed so much and seems 'enterprise' enough for AWS to API for it etc. so no aversion here with me to using it in a WIndows shop especially.
[2014-01-23 03:21:26 -0500] flaccid: personally, i don't see much need for VDI, but i guess there is some suitable use cases
[2014-01-23 03:23:17 -0500] coderanger: sonofuns: So you _could_ use that with chef, but chef as a workflow doesn't care
[2014-01-23 03:25:31 -0500] sonofuns: coderanger: management workstation is a pawn right, I could expend it and install to another station whenever whereever if its just knifing and pushing to a remote git?
[2014-01-23 03:26:22 -0500] coderanger: sonofuns: Sure, its the the place where you are running knife, it isn't a single thing, like everyone here has knife installed and does management-y things
[2014-01-23 03:27:41 -0500] flaccid: you could soe that management box and it could work for multiple users
[2014-01-23 03:28:17 -0500] flaccid: take a no drift approach. you could even work out a way to backup data such as logs and output from cli commands if you wanted to make it auditable
[2014-01-23 03:33:31 -0500] sonofuns: flaccid: yes, precisely, SOE is the issue for me. Not proliferating access to control systems. Instead I want to lock right down even though its a pity git and a knife could do nicely to allow it from anywhere. The VDI makes the machine under the control of the enterprise and the laptop can be riddled with virus or whatever and happily sending/receiving display to the VDI. I cant manage laptops
[2014-01-23 03:33:31 -0500] sonofuns: of users basically its a big step up especially when contractors have their own.
[2014-01-23 03:34:54 -0500] flaccid: sonofuns: are you reselling http://aws.amazon.com/workspaces/ or doing your own thing with ec2 ?
[2014-01-23 03:36:10 -0500] sonofuns: flaccid: Nah, just a user. I just dont like pain coming knocking on my doorstep unnecessarily. It knocks at the worst times I find.
[2014-01-23 03:36:58 -0500] flaccid: then don't use windows :)
[2014-01-23 03:37:27 -0500] sonofuns: hardware = pain for me. Windows does invite pain, yes.
[2014-01-23 03:37:54 -0500] flaccid: i live in the freedom of arch linux with 4 displays
[2014-01-23 03:38:13 -0500] flaccid: and 2 of those are rotated
[2014-01-23 03:39:44 -0500] wastrel: i have a laptop
[2014-01-23 03:39:47 -0500] wastrel: it is widescreen
[2014-01-23 03:40:10 -0500] flaccid: excellent
[2014-01-23 03:40:52 -0500] sonofuns: Benchmark wise, is there a rule of thumb overhead for CHEFified node versus say AMI'd instance? Opsworks does not cheer me up with its turnaround.
[2014-01-23 03:40:58 -0500] wastrel: i can't go to the chef meetup this week :[
[2014-01-23 03:43:03 -0500] joonas: flaccid: where do you work?
[2014-01-23 03:44:31 -0500] joonas: oh I see
[2014-01-23 03:46:59 -0500] rmg: sonofuns: I tried using chef-solo with packer to create base AMIs for my Jenkins cluster... it was so slow I gave up and just used my own shell scripts
[2014-01-23 03:48:54 -0500] sonofuns: rms: I'm hearing you loud and clear there. I do here interestingly that solo is somewhat 'cloudier' than using server. If only it could be made to work effectively and I dont think Opswork has hit it yet. The search index for a start is something I think Im going to really like with server.
[2014-01-23 03:49:30 -0500] sonofuns: sorry, typo, i meant hear.
[2014-01-23 04:06:48 -0500] rmg: sonofuns: presumably you also meant rmg instead of rms
[2014-01-23 04:07:47 -0500] flaccid: joonas: rightscale
[2014-01-23 04:09:13 -0500] flaccid: i'm not sure these days how standard opsworks is with their chef in a practical sense, but i hope the mileage is good now that its chef 11
[2014-01-23 04:19:27 -0500] joonas: flaccid: cool
[2014-01-23 08:16:11 -0500] krz: hi
[2014-01-23 08:16:55 -0500] brucelee: hmm
[2014-01-23 08:17:02 -0500] krz: anyone have experience with eye? im trying to execute eye in opsworks. and am wondering if i should be running this as a service or running the command via execute?
[2014-01-23 08:17:02 -0500] brucelee: krz do you use test-kitchen?
[2014-01-23 08:17:24 -0500] krz: brucelee: no
[2014-01-23 08:18:28 -0500] krz: the same question i have above can apply to other monitoring tools like monit,god, bluepill, etc
[2014-01-23 08:25:22 -0500] brucelee: anyone here use test-kitchen?
[2014-01-23 08:25:44 -0500] brucelee: im having really weird behaviors, that i cant sort out
[2014-01-23 08:26:16 -0500] brucelee: first off, its creating a VM that's getting an IP in my VPN's network
[2014-01-23 08:26:24 -0500] brucelee: how does it determine what ip to get?
[2014-01-23 08:51:13 -0500] krz: what do i need to look at to start a process as a service?
[2014-01-23 08:54:46 -0500] brucelee__: krz are you talking about windows?
[2014-01-23 08:54:51 -0500] brucelee__: krz: is that what youre doing
[2014-01-23 08:54:55 -0500] brucelee__: using chef for windows?
[2014-01-23 09:40:58 -0500] brucelee__: just did vagrant up and its downloading all my cookbooks in my cookbooks folder
[2014-01-23 09:41:01 -0500] brucelee__: at least it seems like it
[2014-01-23 09:41:03 -0500] brucelee__: anyone know why?
[2014-01-23 09:41:14 -0500] brucelee__: the cookbook in the run list is only "my_cookbook"
[2014-01-23 09:41:23 -0500] brucelee__: the only dependency is iptables
[2014-01-23 09:42:49 -0500] flaccid: brucelee__: cookbooks are are source path, i dont think vagrant is designed to work out which ones are only needed and upload those
[2014-01-23 09:43:03 -0500] flaccid: i.e. i don't think it traverses the metadata
[2014-01-23 09:48:04 -0500] brucelee__: flaccid: so it just downloads all the cookbooks on chef server?
[2014-01-23 09:48:22 -0500] brucelee__: flaccid: i thought it just downloads and installs the ones on its run list
[2014-01-23 09:48:48 -0500] flaccid: you are using a plugin for it to hook up to a chef server?
[2014-01-23 09:48:53 -0500] brucelee__: just vagrant
[2014-01-23 09:49:02 -0500] flaccid: vagrant does chef solo
[2014-01-23 09:49:09 -0500] brucelee__: hmm
[2014-01-23 09:49:16 -0500] brucelee__: let me paste the vagrantfile
[2014-01-23 09:49:28 -0500] flaccid: http://docs.vagrantup.com/v2/provisioning/chef_solo.html
[2014-01-23 09:49:47 -0500] flaccid: ah sorry, not sure when this came out but there is http://docs.vagrantup.com/v2/provisioning/chef_client.html
[2014-01-23 09:50:27 -0500] brucelee__: yah
[2014-01-23 09:50:28 -0500] brucelee__: http://hastebin.com/nexagavimu.avrasm
[2014-01-23 09:51:08 -0500] flaccid: i havnt used that yet, but perhaps thats what it does
[2014-01-23 09:51:42 -0500] flaccid: does normal chef-client only download the cookbooks it needs for the run?
[2014-01-23 09:52:00 -0500] brucelee__: hmm
[2014-01-23 09:52:04 -0500] brucelee__: im not sure :p
[2014-01-23 09:52:09 -0500] brucelee__: first time trying to get it to work
[2014-01-23 09:52:14 -0500] brucelee__: but it did download "my_cookbook"
[2014-01-23 09:52:17 -0500] flaccid: me neither actually, but i hope not
[2014-01-23 09:52:34 -0500] brucelee__: let me paste what happened
[2014-01-23 09:53:35 -0500] brucelee__: flaccid: http://hastebin.com/xanavosata.vhdl
[2014-01-23 09:56:35 -0500] brucelee__: so from that paste did it even run my_cookbook?
[2014-01-23 09:56:41 -0500] brucelee__: it recognized that it was added to the run list
[2014-01-23 09:56:47 -0500] flaccid: i'd be trying to solve this first [default] Warning: Chef run list is empty. This may not be what you want.
[2014-01-23 09:57:56 -0500] brucelee__: when i first did vagrant up, i didnt have anything in the run list
[2014-01-23 09:58:03 -0500] brucelee__: and then i logged into my hosted chef
[2014-01-23 09:58:12 -0500] brucelee__: i added my_cookbook onto the vagrant nodes runlist
[2014-01-23 09:58:26 -0500] brucelee__: and then i did "vagrant provision"
[2014-01-23 09:58:33 -0500] brucelee__: then it detected the cookbook
[2014-01-23 09:58:53 -0500] flaccid: not sure i can be of much help, ive never used that provisioner
[2014-01-23 09:59:03 -0500] brucelee__: which provisioner do you use?
[2014-01-23 09:59:10 -0500] flaccid: try googling and #vagrant i guess too
[2014-01-23 09:59:16 -0500] flaccid: for now i just use the chef solo one
[2014-01-23 09:59:17 -0500] brucelee__: ok
[2014-01-23 09:59:27 -0500] brucelee__: tahnks anyway :)
[2014-01-23 10:00:00 -0500] flaccid: np, i dunno if peeps are alive in much atm
[2014-01-23 10:05:23 -0500] brucelee__: yah
[2014-01-23 10:05:27 -0500] brucelee__: seems everyone is afk
[2014-01-23 10:05:28 -0500] brucelee__: :p
[2014-01-23 10:05:43 -0500] brucelee__: Cope: sup
[2014-01-23 10:05:54 -0500] Cope: workin' coffee-drinkin'
[2014-01-23 10:05:59 -0500] brucelee__: Cope: http://hastebin.com/xanavosata.vhdl know why theres so many cookbooks in my run list? :p
[2014-01-23 10:06:09 -0500] brucelee__: in hosted chef it just shows my run list as "my_cookbook"
[2014-01-23 10:06:12 -0500] brucelee__: and not part of any roles
[2014-01-23 10:06:31 -0500] brucelee__: Cope: line 115 is where i did a "vagrant provision"
[2014-01-23 10:06:39 -0500] brucelee__: maybe you can solve this really quick :p
[2014-01-23 10:08:11 -0500] brucelee__: so it adds apt, ntp, cron, iptables, etc all to my runlist
[2014-01-23 10:08:29 -0500] brucelee__: all those cookbooks are in my berkshelf cookbooks folder
[2014-01-23 10:08:36 -0500] brucelee__: so maybe thats why it uploads all those
[2014-01-23 10:08:50 -0500] Cope: looks perfectly normal to me
[2014-01-23 10:09:28 -0500] Cope: what's in the my_cookbook?
[2014-01-23 10:09:34 -0500] Cope: in the metadata
[2014-01-23 10:09:44 -0500] brucelee__: let me see
[2014-01-23 10:09:53 -0500] brucelee__: just "depends iptables"
[2014-01-23 10:10:05 -0500] Cope: unless the answer is 'nothing' I would expect to see that, as the cehf server recursively solves deps and pushes the cookbooks to the edge
[2014-01-23 10:10:06 -0500] brucelee__: ill paste the recipe, its supposed to do something, like create a file called /etc/iptables/general
[2014-01-23 10:10:15 -0500] Cope: dude it looks completely normal
[2014-01-23 10:10:23 -0500] brucelee__: my_cookbook didnt run though
[2014-01-23 10:10:27 -0500] brucelee__: because when i vagrant ssh in
[2014-01-23 10:10:28 -0500] Cope: I'm sorry
[2014-01-23 10:10:49 -0500] brucelee__: it didnt do what the recipes supposed to do :p
[2014-01-23 10:10:56 -0500] Cope: I thought the issue was: why is chef giving me a tonne of cookbooks
[2014-01-23 10:11:06 -0500] Cope: I have to get back to work, but can check in again in a bit
[2014-01-23 10:11:08 -0500] brucelee__: ok
[2014-01-23 10:11:12 -0500] brucelee__: thanks :P
[2014-01-23 10:11:16 -0500] brucelee__: i think its just berkshelf
[2014-01-23 10:11:30 -0500] brucelee__: most of those cookbooks arent depencies or part of any recursive dependancy
[2014-01-23 10:12:12 -0500] brucelee__: only cookbook thats a dependancy is iptables, which is a dependancy of my_cookbook
[2014-01-23 10:13:27 -0500] flaccid: i didn't know berskshelf was somehow being used in here too..
[2014-01-23 10:26:06 -0500] brucelee__: my bad
[2014-01-23 10:26:17 -0500] brucelee__: i looked at the contents of the cookbook from the chef server
[2014-01-23 10:26:21 -0500] brucelee__: and it seems the cookbook was out of date
[2014-01-23 10:26:34 -0500] brucelee__: and i dont think i was able to upload it because by default knife doesnt overwrite the cookbooks
[2014-01-23 10:26:37 -0500] brucelee__: if it already exist
[2014-01-23 10:26:57 -0500] brucelee__: i had to do a knife cookbook upload my_cookbook --force
[2014-01-23 10:27:04 -0500] brucelee__: just noob mistakes :p
[2014-01-23 12:08:47 -0500] davsharyan33: hey ppl, I need to tag a node and find it in the same recipe. But it takes time for chef-server to return it. So I have to wait and run chef-client 2nd time . My backup solution is to run bash sleep, but maybe there is another way to do that ?
[2014-01-23 12:09:48 -0500] Xeron: node attributes being written on the end of chefrun
[2014-01-23 12:10:07 -0500] Xeron: so you'll always get it on the second run
[2014-01-23 12:10:37 -0500] davsharyan33: but this code works on first run, if tagged?("cas_node")
[2014-01-23 12:10:37 -0500] davsharyan33:    Chef::Log.info("I'm a normal node : #{node[:tags]}")
[2014-01-23 12:10:38 -0500] davsharyan33: end
[2014-01-23 12:11:04 -0500] davsharyan33: why search can't catch it too ?
[2014-01-23 12:12:21 -0500] Xeron: because search uses data from server, but your new tag isn't written before chefrun ends
[2014-01-23 12:12:41 -0500] davsharyan33: got it, so there is no way. need to run second time
[2014-01-23 12:13:34 -0500] Xeron: you could try to add tag on the bootstrap step
[2014-01-23 12:14:44 -0500] Xeron: for example bootstrap with empty runlist + tag so node attributes will be posted to the server
[2014-01-23 12:14:45 -0500] davsharyan33: how you mean ?
[2014-01-23 12:15:20 -0500] Xeron: but it still two chef-runs, yes
[2014-01-23 12:15:58 -0500] davsharyan33: hmmm, I launch my servers in one click, need to think how to do that. Thanks
[2014-01-23 12:39:35 -0500] mkirk_sysop: ohai chefs! I'm having a little trouble interpreting the haproxy opscode cookbook documentation. Is anyone here familiar with this cookbook that could help me out?
[2014-01-23 12:43:48 -0500] mkirk_sysop: I just want to know if the haproxy_lb LWRP resource works if you have enable_default_http set to false.
[2014-01-23 12:44:40 -0500] mkirk_sysop: When I try the part of the template that is responsible for reading the node attrs that are set by the resource doesn't output anything.
[2014-01-23 12:48:12 -0500] CaptainQuirk: Hi there !
[2014-01-23 12:48:51 -0500] CaptainQuirk: How would you name a cookbook that conains a recipe that writes content to .bash_profile ?
[2014-01-23 12:51:37 -0500] mil0: I'm looking for a way to automate the creation of VMs more. Ideally I would like to use common node json files that I could you for bot ec2 and digital ocean. I'd say this has been already created, but I can't find anything - my google-fu is not strong today. Does anyone know of tools for this?
[2014-01-23 12:53:37 -0500] mil0: CaptainQuirk - we do this in our companyname-users cookbook
[2014-01-23 12:57:38 -0500] Chandra_: An application error has occurred. Please try again later. (Error 10000)
[2014-01-23 12:57:54 -0500] Chandra_: gettign this error in editing permission can someone help me on this
[2014-01-23 13:34:01 -0500] epcim: Hi, I have a cookbook zoneupdate that updates BIND's named.conf however the bind's cookbook is run later than my cookbook (not a wrapper). The run precedence is set in role file recipe[bind],recipe[zoneupdate]. How that is possible? Anybody to explain?
[2014-01-23 13:35:24 -0500] epcim: is that something with chef two pass flow?
[2014-01-23 13:35:39 -0500] workmad3: epcim: how are you updating the named.conf?
[2014-01-23 13:40:27 -0500] epcim: workmad3: well I actuall use insert_line_if_no_match .. but the issue is not in the update of named.conf bat the fact the bind is installed later than my script runs.
[2014-01-23 13:41:31 -0500] epcim: workmad3: the actual issue I have is that the node['bind']['group'] is beeing not created at the time thus all attempts to write cfg files etc.. are broken
[2014-01-23 14:18:46 -0500] Xeron: epcim it's possible because a lot of resources being compiled at the start of chefrun
[2014-01-23 14:20:59 -0500] Xeron: so if you have for example not_if {read /etc/named.conf and check if it include something} chef possibly could check it before this file will be written by bind cookbook
[2014-01-23 14:22:04 -0500] Xeron: modifying same file from different cookbook is bad idea btw
[2014-01-23 14:22:10 -0500] broconne: Is it your bind cookbook epcim?  or someone else?
[2014-01-23 14:22:20 -0500] Xeron: AFAIK bind supports including in named.conf
[2014-01-23 14:23:45 -0500] epcim: broconne: no I use the community at the end
[2014-01-23 14:24:38 -0500] broconne: ok, if it was yours,k was going to say you could make the action you need execute at compile time instead.. but if its not yours, that would be tricky.
[2014-01-23 14:25:00 -0500] epcim: Xeron: I agree modifing the bind's files from another cookbook is bad idea. Actually I don't want to do it from bind's cookbook or wrapper since I want to specify the usage of zoneupdate cookbook in the node run_list
[2014-01-23 14:25:44 -0500] epcim: I have reloved it, using notifies from other action creating a config files at a time they are already created by bind cookbook
[2014-01-23 14:27:15 -0500] epcim: broconne: It's not mine cookbook but I have a wrapper cookbook on it
[2014-01-23 14:27:42 -0500] mil0: I'm looking for a way to automate the creation of VMs more. Ideally I would like to use common node json files that I could use for both ec2 and digital ocean. I'd say this has been already created, but I can't find anything - my google-fu is not strong today. Does anyone know of tools for this?
[2014-01-23 14:27:54 -0500] epcim: broconne: what actions are run at compile time? how would you do it - briefly?
[2014-01-23 14:28:42 -0500] epcim: mil0: have a look on deis.io
[2014-01-23 14:29:30 -0500] mil0: We're running deis :)
[2014-01-23 14:30:08 -0500] mil0: But that's limited to proxy & runtime layers - no db, cache etc
[2014-01-23 14:30:09 -0500] epcim: :-D
[2014-01-23 14:31:02 -0500] mil0: I'm looking form something that abstracts my "knife digital_ocean droplet create --server-name db01" commands
[2014-01-23 14:31:03 -0500] epcim: mil0: I have seen tutorial using paid RightScale solution
[2014-01-23 14:31:54 -0500] davsharyan33: seems service resource doesn't support only_if , how can I start service only if I get true from grep ?
[2014-01-23 14:32:17 -0500] workmad3: davsharyan33: all resources support only_if, I believe
[2014-01-23 14:33:01 -0500] davsharyan33: workmad3: this code doesn't work http://paste2.org/ELe62Get
[2014-01-23 14:33:03 -0500] workmad3: davsharyan33: is it possible that the 'only_if' condition is evaluated at recipe compile time, but the condition you want to check has changed in the course of the run?
[2014-01-23 14:33:17 -0500] workmad3: davsharyan33: drop the {}
[2014-01-23 14:33:24 -0500] workmad3: davsharyan33: if you want to pass a shell command, you don't use a block
[2014-01-23 14:33:33 -0500] davsharyan33: ko, one sec
[2014-01-23 14:34:01 -0500] workmad3: davsharyan33: what you did there was return a 'truthy' value from the block (as all values apart from nil and false in ruby evaluate to 'true' for conditionals)
[2014-01-23 14:37:28 -0500] davsharyan33: workmad3: it works, thanks
[2014-01-23 14:37:37 -0500] workmad3: davsharyan33: cool :)
[2014-01-23 14:37:45 -0500] davsharyan33: cassandra is tricky
[2014-01-23 14:38:00 -0500] davsharyan33: specially when you want to build a multidc cluster with chef
[2014-01-23 14:41:07 -0500] davsharyan33: workmad3: is it possible to have node attributes in not_if ?
[2014-01-23 14:41:30 -0500] davsharyan33: "grep node[:cassandra][:sometihng]" like this
[2014-01-23 14:41:38 -0500] workmad3: davsharyan33: you can interpolate it in
[2014-01-23 14:41:49 -0500] workmad3: davsharyan33: so "grep #{node[:cassandra][:something]"
[2014-01-23 14:42:06 -0500] davsharyan33: got it
[2014-01-23 14:42:25 -0500] workmad3: davsharyan33: just be aware that the interpolation will happen at compile-time, so if the attribute is set later on in the run, your string won't get the correct value
[2014-01-23 14:42:53 -0500] davsharyan33: it's gonna take from attributes/default.r
[2014-01-23 14:43:01 -0500] davsharyan33: should be okai
[2014-01-23 14:43:09 -0500] workmad3: yeah, that should be fine :)
[2014-01-23 14:43:18 -0500] workmad3: just warning you in case things don't go to plan now or in the future ;)
[2014-01-23 14:43:28 -0500] workmad3: (oh, and I forgot the closing }... don't forget that either)
[2014-01-23 14:44:57 -0500] Xeron: if you want to use node attrs you can use not_if {}
[2014-01-23 14:45:09 -0500] Xeron: like not_if {node[:some][:thing].include?"some"}
[2014-01-23 14:45:24 -0500] workmad3: that too
[2014-01-23 14:46:09 -0500] davsharyan33: yeah, but in my case it's mix of bash and attributes .
[2014-01-23 14:47:56 -0500] Xeron: in such cases I prefer to use shell_out outside resource declaration, save result and use it inside not_if {}
[2014-01-23 15:43:24 -0500] shlant: anyone know how to have the same permissions on a recursively created directory applied to all? instead of just the leaf
[2014-01-23 15:43:44 -0500] shlant: Do I have to break it up into seperate directory resources?
[2014-01-23 15:49:02 -0500] davsharyan33: shlant: use array  %w( dir1 dir2 ).each do | d | RESOURCE
[2014-01-23 15:52:37 -0500] shlant: davsharyan33: but then what about the path for the directory resource? how do I have to so it adds the next dir onto the previous?
[2014-01-23 15:53:23 -0500] shlant: %w{company graphite conf} do |dir|
[2014-01-23 15:53:23 -0500] shlant: directory "/etc/#{dir}" do
[2014-01-23 15:53:23 -0500] shlant:   user "user"
[2014-01-23 15:53:24 -0500] shlant:   group "user"
[2014-01-23 15:53:24 -0500] shlant:   mode "755"
[2014-01-23 15:53:24 -0500] shlant:   action :create
[2014-01-23 15:53:25 -0500] shlant: end
[2014-01-23 15:53:31 -0500] shlant: like that would just create the three dirs in /etc
[2014-01-23 15:53:40 -0500] shlant: how do I create them as a tree
[2014-01-23 15:54:35 -0500] davsharyan33: try with %w( "company/graphite/conf")
[2014-01-23 16:00:29 -0500] shlant: davsharyan33: Parent directory /etc/company/graphite does not exist, cannot create /etc/company/graphite/conf
[2014-01-23 16:00:40 -0500] shlant: I'll try with recursive
[2014-01-23 16:00:46 -0500] tcate: does anyone know if you can override cookbook_versions for just one node in an environment?
[2014-01-23 16:01:22 -0500] freerobby: Are there any debugging tools for chef, e.g. a way to step through a recipe as it executes and inspect the values of things?
[2014-01-23 16:01:45 -0500] davsharyan33: shlant: recursive should work
[2014-01-23 16:01:57 -0500] davsharyan33: freerobby: chef-shell -z     , does partially
[2014-01-23 16:03:17 -0500] shlant: tcate: is this for testing purposes or something?
[2014-01-23 16:03:53 -0500] tcate: yeah, I have a half dozen nodes in staging and I'd like to try this recipe on just one of them
[2014-01-23 16:03:58 -0500] freerobby: davsharyan33: Thanks, I'll take a look.
[2014-01-23 16:04:03 -0500] tcate: so I don't accidently break them all
[2014-01-23 16:04:06 -0500] hdee: tcate, why not create a new environment and put the one node in it?
[2014-01-23 16:04:27 -0500] tcate: staging-exactly-like-other-staging-but-for-one-node?
[2014-01-23 16:05:19 -0500] shlant: tcate: take a look at https://github.com/jonlives/knife-flip
[2014-01-23 16:06:01 -0500] tcate: interesting, kinda frustrating that you can't just override that for one node though
[2014-01-23 16:06:37 -0500] jonlives: tcate: flip will let you move just one node into a different env
[2014-01-23 16:06:49 -0500] jonlives: tcate: we have an unconstrained testing environment that we use for that purpose
[2014-01-23 16:07:01 -0500] jonlives: so flip into testing, test, flip back to production
[2014-01-23 16:07:03 -0500] tcate: yeah, but I need to copy the entire env, also we have some configs that written based on env that might get jacked up
[2014-01-23 16:07:13 -0500] jonlives: tcate: aah
[2014-01-23 16:07:41 -0500] tcate: heh this is testing, so if it breaks it's not to bad
[2014-01-23 16:07:46 -0500] tcate: just don't want to have to fix them all
[2014-01-23 16:09:46 -0500] shlant: davsharyan33: unfortunately, that results in the same thing: only the leaf having the specified permissions.
[2014-01-23 16:10:00 -0500] shlant: I guess I'll have to tripple the lines of code with multiple resources...
[2014-01-23 16:25:58 -0500] shlant: davsharyan33: found the answer
[2014-01-23 16:25:59 -0500] shlant: %w[ /foo /foo/bar /foo/bar/baz ].each do |path|
[2014-01-23 16:26:00 -0500] shlant:   directory path do
[2014-01-23 16:26:00 -0500] shlant:     owner "root"
[2014-01-23 16:26:01 -0500] shlant:     group "root"
[2014-01-23 16:26:01 -0500] shlant:   end
[2014-01-23 16:26:01 -0500] shlant: end
[2014-01-23 16:26:05 -0500] shlant: thanks for your input :)
[2014-01-23 16:39:38 -0500] bixu: Is it possible to do a knife server create without the chef bootstrap?
[2014-01-23 16:40:05 -0500] shlant: what provider are you using?
[2014-01-23 16:40:12 -0500] shlant: aws?
[2014-01-23 16:40:16 -0500] shlant: openstack?
[2014-01-23 16:40:25 -0500] shlant: none?
[2014-01-23 16:40:39 -0500] bixu: aws and/or joyent
[2014-01-23 16:40:50 -0500] bixu: testing w joyent at the moment
[2014-01-23 16:41:08 -0500] bixu: so maybe it's something that i need in the knife-joyent gem?
[2014-01-23 16:41:52 -0500] bixu: I guess I could cheat by using a custom bootstrap file that didn't do anything...
[2014-01-23 16:41:59 -0500] shlant: if it's supported or there a knife plugin for it, most providers will have some sort of server create command which creates and bootstraps at the same time
[2014-01-23 16:42:04 -0500] bixu: s/didn't/doesn't/
[2014-01-23 16:42:05 -0500] shlant: like this
[2014-01-23 16:42:06 -0500] shlant: http://docs.opscode.com/plugin_knife_ec2.html#server-create
[2014-01-23 16:42:29 -0500] bixu: i'm going to try my hack idea - thanks for that link!
[2014-01-23 16:42:33 -0500] shlant: np
[2014-01-23 16:43:16 -0500] shlant: bixu: you should be able to knife joyent server create
[2014-01-23 16:43:29 -0500] bixu: shlant: I totally can.
[2014-01-23 16:43:33 -0500] shlant: as long as knife.rb is correct
[2014-01-23 16:43:40 -0500] bixu: I just don't want to put a .pem key or install chef just yet.
[2014-01-23 16:43:54 -0500] bixu: knife-joyent assumes you are bootstrapping, I think.
[2014-01-23 16:45:38 -0500] shlant: if you want to just create a server from command line, that would be a provider question, not a chef question :)
[2014-01-23 16:46:08 -0500] CPS: anyone know how to find out a computer's domain using ruby?
[2014-01-23 16:47:20 -0500] shlant: CPS: something like hostname = Socket.gethostbyname(Socket.gethostname).first
[2014-01-23 16:47:39 -0500] shlant: see http://stackoverflow.com/questions/151545/how-can-i-get-the-fqdn-of-the-current-host-in-ruby
[2014-01-23 16:48:08 -0500] mil0: We're switching from chef-solo to chef server. I have lots of nodes defined in json files. How can I use these with chef server?
[2014-01-23 16:48:22 -0500] shlant: CPS: domainname = %[hostname -f]
[2014-01-23 16:48:52 -0500] shlant: i guess that's still fwdn
[2014-01-23 16:48:57 -0500] shlant: fqdn
[2014-01-23 16:49:06 -0500] CPS: that socket thing seems to work
[2014-01-23 16:49:10 -0500] CPS: thanks
[2014-01-23 16:49:13 -0500] shlant: np
[2014-01-23 16:49:20 -0500] amy12: hoping someone can help me. I am getting "RedirectLimitExceeded" errors. This is happening at the sync cookbooks stage of the chef-client run. I can run this on aws just fine. I am having all my trouble on rackspace. I have seen various levels of success- sometimes it will sync all the cookbooks, sometimes only some of the cookbooks, and once I even got all the way to the end of the chef-client run before seeing the error. I have looked 
[2014-01-23 16:50:34 -0500] stormerider: CPS: domain = %{dnsdomainname} ?
[2014-01-23 16:51:09 -0500] stormerider: er replace with []'s
[2014-01-23 16:51:39 -0500] CPS: that just prints a string in rib
[2014-01-23 16:51:42 -0500] shlant: mil0: are you talking about VM's or cookbooks/recipes?
[2014-01-23 16:51:58 -0500] CPS: irb*
[2014-01-23 16:53:05 -0500] shlant: amy12: are your knife.rb settings correct?
[2014-01-23 16:54:01 -0500] CPS: %[dnsdomainname] prints "dnsdomainname"
[2014-01-23 16:55:04 -0500] shlant: amy12: I would need to see the error with all the chef run
[2014-01-23 16:57:57 -0500] mil0: shlant: VMs. Let me refrase to what I'm trying to do now. I'm trying to build a postgres server with knife. Everything works until one of our cookbooks wants to use an attribute that we used to set in the hostname.json
[2014-01-23 16:58:53 -0500] mil0: Maybe I should move these attributes to roles
[2014-01-23 16:59:46 -0500] shlant: mil0: do you have output with errors?
[2014-01-23 17:00:18 -0500] shlant: where is that hostname.json? is it a data bag?
[2014-01-23 17:01:06 -0500] mil0: no. Well I think it is used as such, but it's not in our databag folder :)
[2014-01-23 17:01:25 -0500] amy12: shlant: my knife.rb settings in the rackspace test setup are same as in my aws test setup (except for the username). There's not much more to the error than this: Chef::Exceptions::RedirectLimitExceeded: Chef::Exceptions::RedirectLimitExceeded
[2014-01-23 17:02:27 -0500] shlant: mil0: how is hostname.json references in the recipe?
[2014-01-23 17:02:34 -0500] shlant: referenced*
[2014-01-23 17:02:38 -0500] mil0: we have a nodes folder next to cookbooks and roles, and that folder contains all hostname.json files, which define things as IP, hostname, role
[2014-01-23 17:02:50 -0500] shlant: amy12: it's not in relation to any specific cookbook?
[2014-01-23 17:03:20 -0500] shlant: mil0: and you're moving to chef server, yes?
[2014-01-23 17:03:24 -0500] bmhatfield: So I'm running across this: http://docs.opscode.com/essentials_search.html#nested-fields
[2014-01-23 17:03:47 -0500] bmhatfield: How do I search for roles and ensure I don't get back nodes that match a NESTED ATTRIBUTE called roles?
[2014-01-23 17:03:51 -0500] mil0: the file isn't referenced, but attributes it sets are, ie private_ipv4
[2014-01-23 17:04:42 -0500] mil0: Yes, we're moving. For now I'm not concerned with the running machines, but trying to provision a new one
[2014-01-23 17:06:10 -0500] shlant: mil0: a new one on chef-server correct?
[2014-01-23 17:06:23 -0500] mil0: yes
[2014-01-23 17:06:56 -0500] shlant: what you'll have to do is move those json's to the data_bag folder. Then, upload them using knife data bag from file
[2014-01-23 17:06:59 -0500] bmhatfield: Can someone point me at a reference for help, pretty please?
[2014-01-23 17:07:01 -0500] bmhatfield: http://docs.opscode.com/essentials_search.html#roles-in-run-lists
[2014-01-23 17:07:21 -0500] shlant: mil0: after they are on the chef-server, you will reference them like this: http://docs.opscode.com/dsl_recipe_method_data_bag.html
[2014-01-23 17:07:21 -0500] mil0: I think for IP I should rewrite our recipes to use node['ipaddress'], though I'm not sure how that will work with private/public IP's
[2014-01-23 17:07:21 -0500] amy12: shlant: it's not consistent. Sometimes I will get the error after a couple cookbooks have been syncd, Sometimes I get the error right after "Synchronizing Cookbooks:". Once I got to the end of the run, with only a couple things left to finish, and it happened.
[2014-01-23 17:07:28 -0500] bmhatfield: Searches for "role:whatever" are returning nodes that have a "role:whatever" nested attribute
[2014-01-23 17:07:37 -0500] bmhatfield: Which is obviously terrible
[2014-01-23 17:09:11 -0500] mil0: this is how it breaks now: http://pastebin.com/u8srvTXP
[2014-01-23 17:11:02 -0500] amy12: shlant: I have tried this with an aws server/workstation with an aws client/node, and then a rackspace client/node. I have also tried a rackspace server/workstation with a rackspace client/node, and then an aws client/node. Any combination involving rackspace gives me the issue.
[2014-01-23 17:12:12 -0500] shlant: mil0: is node[private_ip] set explicitly? the default is node[ipaddress]
[2014-01-23 17:14:41 -0500] mil0: Yes, we used to set it in the hostname.json
[2014-01-23 17:14:49 -0500] shlant: amy12: are you using knife-reackspace?
[2014-01-23 17:15:26 -0500] amy12: shlant: no. Nor am I doing that for aws.
[2014-01-23 17:15:32 -0500] shlant: mil0: if this is on a hcef-server and there is no data bag with the hostname.json data, then that block will come up with nothing
[2014-01-23 17:16:38 -0500] shlant: mil0: I don;t think it can find hostnmae.json because it's in a root directory which isn't the default chef tree
[2014-01-23 17:16:42 -0500] masterkorp: Hello chef, how do you consolidate indiviual cookbook development with the usage of the same on your infrastruture?
[2014-01-23 17:17:02 -0500] shlant: masterkorp: not sure what you mean
[2014-01-23 17:17:17 -0500] amy12: shlant: one time I got a 404 not found when the syncing of cookbooks failed, but every other failure has been the "RedirectLimitExceeded' error
[2014-01-23 17:17:58 -0500] shlant: amy12: seems like an issue with the connection between rackspace and the chef-server
[2014-01-23 17:18:01 -0500] masterkorp: shlant: i mean having the cookbook on indivudual git repositories, or having them in your chef repo
[2014-01-23 17:18:06 -0500] shlant: might have to consult rackspcae with that
[2014-01-23 17:18:12 -0500] masterkorp: separate usable code from company stuff
[2014-01-23 17:18:48 -0500] shlant: mil0: try setting up the data bag and referencing it in the recipe like I mentioned
[2014-01-23 17:18:51 -0500] amy12: shlant: it's failed from rackspace to rackspace as well, same data center
[2014-01-23 17:19:44 -0500] shlant: amy12: definitely still a rackspace issue. try pinging from chef-server to node and see if there are blips
[2014-01-23 17:19:51 -0500] mil0: Would chef understand it when I previously upload the databag as hostname.json ? (that is, before I run the knife command to create the VM)
[2014-01-23 17:19:51 -0500] amy12: shlant: what does this error have to do with? I get lots of matches in google, people running into the same error and asking the same thing, but no link provide answers
[2014-01-23 17:20:39 -0500] shlant: amy12: seems to me like it's a network connection error and there's no one answer for that
[2014-01-23 17:20:53 -0500] shlant: could just be intermittent. How long has this been happening?
[2014-01-23 17:21:26 -0500] shlant: mil0: as long as the recipe knows where to find the data (ie from the data bag)
[2014-01-23 17:21:46 -0500] shlant: you would have to update the recipe to use data bags, then do a chef run
[2014-01-23 17:22:08 -0500] amy12: shlant: but in general, what's the thing trying to do when it exceeds a redirect limit? What's being redirected? Just trying to understand what's going on under the hood
[2014-01-23 17:22:56 -0500] bmhatfield: Here's a relevant bug against chef-zero that I just filed: https://github.com/opscode/chef-zero/issues/54
[2014-01-23 17:23:01 -0500] mil0: the recipe used to do this:
[2014-01-23 17:23:02 -0500] mil0:     ip = *(node[:private_ip] \
[2014-01-23 17:23:02 -0500] mil0:             || (node[:cloud][:private_ipv4] rescue nil) \
[2014-01-23 17:23:02 -0500] mil0:             || (node[:automatic][:cloud][:private_ipv4] rescue nil) \
[2014-01-23 17:23:08 -0500] shlant: masterkorp: are you asking how, after you move them to seperate repos, do you bring them together for uploading/testing?
[2014-01-23 17:23:46 -0500] mil0: So I should rewrite this? Or could I upload the databag in a way that this just works?
[2014-01-23 17:24:43 -0500] CPS: mil0: use gist.github.com to paste code
[2014-01-23 17:25:06 -0500] shlant: mil0: you can keep that part, but you have to use data bags to get the ip into node['private_ip']
[2014-01-23 17:26:07 -0500] shlant: hostname = data_bag_item("something", "hostname")
[2014-01-23 17:26:31 -0500] shlant: then ip = *(hostname[:private_ip] \
[2014-01-23 17:26:45 -0500] shlant: see http://docs.opscode.com/dsl_recipe_method_data_bag.html#data-bag-data-bag-item-methods
[2014-01-23 17:27:16 -0500] shlant: afk for a bit
[2014-01-23 17:29:22 -0500] amy12: shlant: pings look good. .373 ms or thereabouts. I attempted chef-client several times in a row, no-go
[2014-01-23 17:32:46 -0500] amy12: shlant: is there a command that will execute just the "syncing cookbooks" part of the chef-client run?
[2014-01-23 17:34:38 -0500] arthurdent: so when i try to bootstrap a linux mint machine, i get weird errors. "Syntax error: newline unexpected"
[2014-01-23 17:36:11 -0500] arthurdent: it seems to be trying to run the deb as an sh instead of using dpkg
[2014-01-23 17:36:47 -0500] masterkorp: guys what is the syntax of node search for a node that has a following recipe
[2014-01-23 17:36:51 -0500] masterkorp: http://docs.opscode.com/essentials_search.html
[2014-01-23 17:37:02 -0500] masterkorp: it doesn't have an example here
[2014-01-23 17:37:22 -0500] masterkorp: knife search node "recipe:postgresql::server"
[2014-01-23 17:37:27 -0500] masterkorp: does not work
[2014-01-23 17:40:38 -0500] juliancdunn: knife search node 'recipe:postgresql\:\:server' ?
[2014-01-23 17:41:30 -0500] masterkorp: that works, forgot that, thank you
[2014-01-23 17:47:31 -0500] user21468: hi, anyone had to deal with erchef going nuts and burning all cpu? (omnibus server 11.0.6) there's nothing useful in the logs to indicate why
[2014-01-23 17:55:25 -0500] mil0: I just removed a node from chef server, tried to recreate with knife and get a authorization  error:  Your validation client is not authorized to create the client for this node (HTTP 403). Is that expected?
[2014-01-23 17:55:38 -0500] workmad3: mil0: you also need to remove the client
[2014-01-23 17:55:57 -0500] mil0: ah, thanx
[2014-01-23 18:06:12 -0500] arthurdent: whenever i do knife ssh <nodename> <command> for my one test machine (new to chef), I get "FATAL: No nodes returned from search!"
[2014-01-23 18:06:22 -0500] arthurdent: but if i put the exact nodename into knife search, it returns data about the node
[2014-01-23 18:08:39 -0500] Lefty: <nodename> in your command line is a search
[2014-01-23 18:08:42 -0500] Lefty: not a specific node name
[2014-01-23 18:08:57 -0500] shlant: arthurdent: it should be knife ssh name:<nodename> <command>
[2014-01-23 18:09:02 -0500] arthurdent: shlant: thanks
[2014-01-23 18:09:57 -0500] arthurdent: now I get Net::SSH::AuthenticationFailed: root@machine
[2014-01-23 18:10:02 -0500] arthurdent: did i misconfigure something?
[2014-01-23 18:11:36 -0500] user21468: any hints on erchef consuming excessive (all) cpu?  the logs don't really offer anything helpful, unfortunately
[2014-01-23 18:13:21 -0500] shlant: user21468: could it be related to this? https://tickets.opscode.com/browse/CHEF-3921
[2014-01-23 18:13:44 -0500] user21468: i've tried mining for dependency problems, but i'm coming up empty
[2014-01-23 18:14:08 -0500] mil0: I'm still having a hard time to wrap my head around the databag setup. I've succeeded in creating a databag for the machine I'm trying to create, but I'm not sure where I should reference it and how
[2014-01-23 18:14:21 -0500] shlant: user21468: I've seen a few people come in here asking about similar problems, but haven't seen answers
[2014-01-23 18:14:52 -0500] shlant: arthurdent: you'll have to make sure you are passing proper ssh passwords/keyd
[2014-01-23 18:14:59 -0500] user21468: i saw one recommendation to wipe and reload all cookbooks, but that's seriously non trivial :( i've got 130 cookbooks and 2100 nodes
[2014-01-23 18:15:10 -0500] shlant: arthurdent: see http://docs.opscode.com/knife_ssh.html#options
[2014-01-23 18:15:25 -0500] arthurdent: shlant: thanks
[2014-01-23 18:15:49 -0500] shlant: user21468: yea, it seems to be a huge problem. I would try chef mailing list
[2014-01-23 18:16:20 -0500] shlant: or check jira for answers: https://tickets.opscode.com/secure/Dashboard.jspa
[2014-01-23 18:16:50 -0500] shlant: mil0: you should be referencing it wherever you need the data bag info
[2014-01-23 18:16:58 -0500] shlant: such as that recipe that needs the private_ip
[2014-01-23 18:17:05 -0500] user21468: thanks, hopefully i'll find something soon
[2014-01-23 18:22:42 -0500] CPS: can someone give me some insight into this error? https://gist.github.com/anonymous/8583961
[2014-01-23 18:25:55 -0500] mil0: I can't seem to figure this out.. You said I could keep the code segment I posted. So I should add hostname = data_bag_item("something", "hostname") \ ip = *(hostname[:private_ip] to my recipes default.rb?
[2014-01-23 18:26:07 -0500] mil0: (sorry for the n00b questions)
[2014-01-23 18:29:13 -0500] mil0: Ah, I found some existing code of us that uses data_bags, that should help
[2014-01-23 18:30:56 -0500] stormerider: what's up with this Adobe webinar... the host hasn't arrived yet and it's 30m in?
[2014-01-23 18:31:21 -0500] chip-: It's been running.
[2014-01-23 18:31:37 -0500] chip-: Sitting there right now!
[2014-01-23 18:33:25 -0500] stormerider: blah. then someone sent out a bad link to a webex session for it
[2014-01-23 18:33:43 -0500] CPS: i'm getting a consistent crash on an execute block that makes no sense to me https://gist.github.com/anonymous/8583961
[2014-01-23 18:33:50 -0500] CPS: the command when run in isolation runs fine
[2014-01-23 18:34:21 -0500] stormerider: is there going to be a recording of it to review?
[2014-01-23 18:34:30 -0500] chip-: There's a recording, sure.
[2014-01-23 18:34:36 -0500] chip-: We're up to the Q&A
[2014-01-23 18:34:38 -0500] stormerider: cool, thanks.
[2014-01-23 18:34:41 -0500] stormerider: yeah, i just got in
[2014-01-23 18:34:43 -0500] chip-: But it did move to GoTo from Webex
[2014-01-23 18:35:16 -0500] stormerider: got delayed with an email and didn't realize how long i'd been waiting to check in
[2014-01-23 18:36:21 -0500] CPS: derp wasn't escaping my slashes
[2014-01-23 18:37:51 -0500] sneak: hi, i'm using test-kitchen to test a recipe that does a node search to build an /etc/hosts. how do i tell chef-zero in test kitchen to use some json for the server node list so i can actually test out my recipe?
[2014-01-23 18:43:47 -0500] CPS: is it possible to have multiple boxes set up as workstations for a chef server?
[2014-01-23 18:44:16 -0500] sneak: CPS: you mean to use 'knife'? if so, absolutely
[2014-01-23 18:44:25 -0500] CPS: cool, thanks
[2014-01-23 18:44:38 -0500] sneak: they are clients of the server like any other
[2014-01-23 18:44:45 -0500] sneak: they just need authentication keys
[2014-01-23 18:44:57 -0500] sneak: you put the config in ~/.chef/knife.rb and away you go
[2014-01-23 18:45:08 -0500] mil0: Would this work?         data_bag('node').map do |item|
[2014-01-23 18:45:08 -0500] mil0:           data_bag_item('node', item)
[2014-01-23 18:46:29 -0500] mil0: I give up for today
[2014-01-23 18:57:12 -0500] fgs: Hi. I'm new to chef and have a question. I want to have a smtp and a imap role, which in turn are part of the mailserver role but can be applied separately.
[2014-01-23 18:57:21 -0500] fgs: Does that sound like the right approach?
[2014-01-23 18:57:50 -0500] freerobby: We are using the percona cookbook and I was hoping to use the opscode database cookbook with it for the mysql providers. Unfortunately we have some apt conflicts that break (see: https://gist.github.com/freerobby/3a060e3a40cf3be98513 ). Does anybody know of ways I could patch this or do I need to fork the whole database and/or mysql cookbooks to make this work?
[2014-01-23 19:02:56 -0500] tscanausa: freerobby: that is caused by apt-cache being out of date.
[2014-01-23 19:10:46 -0500] arthurdent: say I boostrap a machine and then clone the disk to another machine, what will happen?
[2014-01-23 19:11:02 -0500] arthurdent: changing the hostname but nothing else on the cloned machine
[2014-01-23 19:11:12 -0500] jmartin: arthurdent: wont work, you need new keys
[2014-01-23 19:11:29 -0500] arthurdent: will there be a problem with re-boostrapping the cloned machine?
[2014-01-23 19:11:57 -0500] stormerider: you'll need to delete the client.pem file, iirc,
[2014-01-23 19:13:00 -0500] arthurdent: thanks
[2014-01-23 19:13:49 -0500] arthurdent: it wont just overwrite it?
[2014-01-23 19:18:43 -0500] arthurdent: what happens if I want to boostrap a machine with a hostname that is already in the list of clients?
[2014-01-23 19:18:54 -0500] arthurdent: will it overwrite the entry on the server?
[2014-01-23 19:19:32 -0500] enefesdi: hi.  I've seen a couple # questions for a fatal chef-client exception on solaris 10 for "ERROR: \xC3 something something US-ASCII"
[2014-01-23 19:19:46 -0500] enefesdi: ain't what seen no other mention of it elseways
[2014-01-23 19:20:21 -0500] stormerider: arthurdent: the client key is never overwritten; if it's present, it's used, if it's not, it uses the validator to generate a new one.
[2014-01-23 19:21:12 -0500] enefesdi: wondering if anyone watching happens to have seen this before, or run into it themselves
[2014-01-23 19:21:29 -0500] enefesdi: this is sol 5.10 on x86 hardware iirc
[2014-01-23 19:21:33 -0500] arthurdent: so do I need to delete client.pem if i re-boostrap or not?
[2014-01-23 19:21:37 -0500] enefesdi: SOME of our 5.10 hosts akshuly work fine
[2014-01-23 19:21:50 -0500] enefesdi: been making ourselves nuts trying to find the difference; can't seem to find it
[2014-01-23 19:21:55 -0500] stormerider: as for the other question, if the node and client previously exist, then you wouldn't be able to rebootstrap that client without deleting the client from the server iirc
[2014-01-23 19:22:20 -0500] stormerider: if you have the node entry but not the client, then it'd overwrite the previous node data
[2014-01-23 19:22:39 -0500] arthurdent: ok cool
[2014-01-23 19:22:54 -0500] stormerider: enefesdi: at a guess i'd say locale issues, but i dont have solaris boxes powered up to test with
[2014-01-23 19:24:44 -0500] Dairenn: Does Chef have a built-in HTTP resource?  Does it have a default timeout value?  I'm trying to find out where this timeout I'm experiencing could be coming from.
[2014-01-23 19:25:36 -0500] tscanausa: Dairenn: I believe there are httpish resources.
[2014-01-23 19:25:38 -0500] Majost: Does anyone know in chefspec if write_log is the only way to check the value of an overridden attribute?
[2014-01-23 19:26:14 -0500] Dairenn: I remember seeing some class like Net::HTTP or something like that.  I just can't think of where I might be able to find it.  i'm about to open up a ticket with my networking department, but first, I need to know exactly how this recipe I've been given is doing what it's doing.
[2014-01-23 19:27:39 -0500] Dairenn: I might be dealing with a know issue actually..  (CHEF-4202)
[2014-01-23 19:28:04 -0500] tscanausa: Dairenn: what is the error?
[2014-01-23 19:28:48 -0500] Dairenn: Errno::ETIMEDOUT: remote_file[/etc/pki/rpm-gpg/dag-gpg.key] (private_yum::dcs_mirrors line 55) had an error: Errno::ETIMEDOUT: Error connecting to http://Private.Repo.URL Connection timed out - connect(2)
[2014-01-23 19:29:05 -0500] Dairenn: That URL is a real one but I santized it since it's, well, private. ;)
[2014-01-23 19:29:13 -0500] Dairenn: And yes, it works brilliantly using curl.
[2014-01-23 19:29:44 -0500] tscanausa: it is using http://docs.opscode.com/resource_remote_file.html
[2014-01-23 19:30:02 -0500] gchristensen: Dairenn: I was going to make a snarky joke about how that URl times out for me too :)
[2014-01-23 19:30:07 -0500] Dairenn: ;)
[2014-01-23 19:30:46 -0500] Dairenn: Oh but yes indeed it is.  Let's see.
[2014-01-23 19:32:44 -0500] enefesdi: i would believe that it's a locale issue too, but when we set all the environment variables to the same LC* as the working boxes, everything still breaks.
[2014-01-23 19:33:23 -0500] shawn_sher: enefesdi: You might want to make sure that if you are using non-ascii characters in some ruby, you will want to put "#encoding: utf-8" in your ruby files
[2014-01-23 19:34:06 -0500] enefesdi: we've even gone so far as to roll everything back before the chef-client install, set up LC* appropriately, reinstall the client, and still hit this error
[2014-01-23 19:34:11 -0500] shawn_sher: Or at least, that's my fragment of memory from a similar experience
[2014-01-23 19:34:25 -0500] enefesdi: also of note; there are zero items in the runlist for the node
[2014-01-23 19:34:57 -0500] enefesdi: well that's very helpful
[2014-01-23 19:35:02 -0500] enefesdi: i'll try it again to make sure we didn't miss anything
[2014-01-23 19:41:13 -0500] shawn_sher: This was in Vagrant, but I think it could happen in other cases. Check your metadata.rb files for weirdness, since they are still read in somtimes
[2014-01-23 19:42:25 -0500] shawn_sher: enefesdi: That's what bit us, a global constant was set in an unrelated metadata.rb that affected the whole chef run.
[2014-01-23 19:45:24 -0500] brucelee: Currently have some users already manually added to servers. If i create databag for users in chef, some of which are already added without chef, will there be problems?
[2014-01-23 19:46:10 -0500] tscanausa: brucelee: Not sure, I dont think so but try it on a "test" server
[2014-01-23 19:46:45 -0500] brucelee: tscanausa: ok
[2014-01-23 19:50:34 -0500] stormerider: brucelee: it works ok unless you're specifying different uids in the data bags than what's on the system
[2014-01-23 19:51:05 -0500] stormerider: if you're not specifying a uid it'll just update the existing user
[2014-01-23 19:54:06 -0500] mhulan: hello, what's the best way to set some default role for a node during it's first run (when it registers itself using validation cert)?
[2014-01-23 19:56:35 -0500] jbz: mhulan: You can set attributes in a JSON file and pass them to the chef-client when you start the service.  For the first run of that daemon, it will use the attributes (including a runlist) which are provided by the file, so the first time it runs it will have a runlist.
[2014-01-23 19:57:32 -0500] mhulan: jbz: thanks, can I then set a role for that node by some recipe? I want this node to have such role from now on...
[2014-01-23 19:58:25 -0500] jbz: mhulan:  You probably *can*um, lessee, you would set the runlist and then do a node.save, I guess.  The next run, it would use the list you'd given it.
[2014-01-23 19:59:07 -0500] tscanausa: I believe boostrap with a role in the run list persists.
[2014-01-23 19:59:11 -0500] mhulan: jbz: does not sound like a common use case :-)
[2014-01-23 19:59:16 -0500] mhulan: tscanausa: will try, thanks
[2014-01-23 19:59:21 -0500] jbz: mhulan: What I've done, in the past, is to have a 'parent role' which the box gets when it comes in.  If I want to change its runlist, I change that role.
[2014-01-23 19:59:59 -0500] mhulan: jbz: yeah, my desire is to set this 'parent role' to every new node that is registered by default
[2014-01-23 19:59:59 -0500] mveitas: anybody know of an example LWRP that uses a list of items?
[2014-01-23 20:00:02 -0500] jbz: That way I know all machines are working off a common runlist.  I don't like changing runlists on particular nodes other than to put base roles (or role cookbooks) on them.
[2014-01-23 20:00:18 -0500] jbz: mhulan: Well, if you do that, you can't control its runlist later by modding the role, unless you mod *every node*.
[2014-01-23 20:01:15 -0500] mhulan: jbz: yeah that's ok, this default role just sets some essentials that I want to have on every node..
[2014-01-23 20:01:19 -0500] tscanausa: I generally  run bootstrap -r "role[prefix-base]" then then it is time for it to actaully go into production I just change the role
[2014-01-23 20:02:08 -0500] mhulan: I see
[2014-01-23 20:02:49 -0500] tscanausa: as part of my base I setup chef-client as a daemon, so when I change the role it updates to the new thing role on next run
[2014-01-23 20:03:41 -0500] timg_: the php cookbook is broken and nobody cares :P https://github.com/opscode-cookbooks/php/pull/54
[2014-01-23 20:12:01 -0500] Dairenn: timg_: Heh, lovely.
[2014-01-23 20:15:21 -0500] Doc_IX: anyone know if there's a method to do password management for users under OS X using the standard 'user' resource?  The docs reference 'ruby-shadow' and say how to get that for Debian, but make no mention of any other platforms.
[2014-01-23 20:28:44 -0500] MattStratton: trying to puzzle this out - let's say I want to have the chef client installed on a vm, but not use knife to bootstrap it, and I also don't want to have to manually create the client in chef server. Is there a way to preload the config and the .pem files on the client?
[2014-01-23 20:29:12 -0500] MattStratton: I know that I can do that with the validation pem file, but everything seems to indicate that I need to create a separate client.pem for each node
[2014-01-23 20:31:29 -0500] Doc_X: looks like the chef user resource tries to access '/var/db/shadow/hash/' which doesn't exist after OS X 10.6. whee :(
[2014-01-23 20:35:06 -0500] Doc_X: and looks like it's reported in https://tickets.opscode.com/browse/CHEF-2813 but not yet fixed.  *sadface*
[2014-01-23 21:06:40 -0500] freerobby: Is it possible to bootstrap via knife ec2 server create or knife rackspace server create with forward-agent enabled?
[2014-01-23 21:06:53 -0500] freerobby: It seems unsupported but I find that hard to believe, as any recipe using github without deploy keys would break
[2014-01-23 21:15:55 -0500] CPS: is there a way to suppress the diff output when a template resource is run?
[2014-01-23 21:22:43 -0500] oof_: halp
[2014-01-23 21:22:57 -0500] oof_: Can anyone help me configure knife
[2014-01-23 21:31:03 -0500] camwest: Hey I'm unable to run chef-client on my node all of a sudden. Is there an issue with api.opscode.com?
[2014-01-23 21:36:25 -0500] shlant: camwest: what's the error?
[2014-01-23 21:42:00 -0500] luimemee: hello
[2014-01-23 21:42:40 -0500] luimemee: what is the fastest way to sync th node json information from chef ? API call are a little slow on our chef-server and i would prefer the DB or something is there a cache somewhere ?
[2014-01-23 21:52:45 -0500] luimemee: or is there a way to save the node attributes localy like chef-client do on the server ?
[2014-01-23 21:53:19 -0500] hron84: Hi! chef 11 can load data bags from ruby dsl? If yes, can anyone give me a working example?
[2014-01-23 21:53:35 -0500] hron84: i just can't figure out a right syntax
[2014-01-23 21:58:18 -0500] shlant: hron84: have you seen this? https://gist.github.com/jtimberman/2359433
[2014-01-23 21:58:31 -0500] shlant: not sure if that's what you're looking for
[2014-01-23 21:58:41 -0500] hron84: shlant: yeah, and does not works. it says id is nil
[2014-01-23 21:58:58 -0500] hron84: so that's why i expect a _working_ example
[2014-01-23 21:59:22 -0500] shlant: id?
[2014-01-23 21:59:27 -0500] shlant: do you have error output?
[2014-01-23 21:59:37 -0500] hron84: hmm... so knife cannot load rb files by default?
[2014-01-23 22:07:16 -0500] benner: can anyone recommend how to properly test cookbook with search() inside it (using kitchen)?
[2014-01-23 22:09:45 -0500] gchristensen: benner: chef-zero
[2014-01-23 22:10:23 -0500] sn0wb1rd: benner: You might want to put the search() call inside this condition 'if Chef::Config[:solo]'
[2014-01-23 22:10:24 -0500] gchristensen: benner: https://github.com/pressable/chef-zk-php-wrapper/tree/master/test/integration/nodes
[2014-01-23 22:12:38 -0500] benner: i'm using chef-zero, but my problem is that i can't find anything becouse there is no other nodes
[2014-01-23 22:13:42 -0500] gchristensen: benner: check out that link I sent on how to add nodes :)
[2014-01-23 22:14:06 -0500] docwhat: If I use node.set() in a recipe, will that data be available via knife? (assuming using chef-server)
[2014-01-23 22:14:31 -0500] docwhat: I'm wondering because I'm looking at the Jenkins cookbook and it suggests:
[2014-01-23 22:14:32 -0500] benner: gchristensen: checking. thanks
[2014-01-23 22:14:36 -0500] docwhat: private_key = encrypted_data_bag_item('jenkins', 'keys')['private_key']
[2014-01-23 22:14:36 -0500] docwhat: node.set['jenkins']['executor']['private_key'] = private_key
[2014-01-23 22:14:55 -0500] docwhat: But I'm afraid it'll be available to everyone who can look up a node's attributes.
[2014-01-23 22:15:52 -0500] gchristensen: it would be
[2014-01-23 22:17:37 -0500] docwhat: That seems wrong...
[2014-01-23 22:18:29 -0500] docwhat: gchristensen: Is there a pattern for accessing a data_bag (encrypted) in a cookbook?  Do I just assume they've organized the data_bags in a specific way, or do I let then set the name and item in an attribute?
[2014-01-23 22:18:39 -0500] docwhat: What's the "nice" way to do that?
[2014-01-23 22:19:20 -0500] gchristensen: I like my cookbooks to set sane rules, but override them
[2014-01-23 22:19:26 -0500] gchristensen: but also provide ways to override them*
[2014-01-23 22:42:13 -0500] gswallow: I have a question!
[2014-01-23 22:42:42 -0500] gchristensen: Okay!
[2014-01-23 22:42:47 -0500] gchristensen: me too!
[2014-01-23 22:43:35 -0500] gswallow: https://gist.github.com/gswallow/8588328
[2014-01-23 22:44:06 -0500] gswallow: Does anyone know how I can download the erb file *inside* the template?
[2014-01-23 22:44:18 -0500] gswallow: s/template/ruby block.  sorry.
[2014-01-23 22:44:30 -0500] coderanger: gswallow: Not sure what you mean
[2014-01-23 22:44:50 -0500] segv: gmm
[2014-01-23 22:44:53 -0500] segv: hmm* even
[2014-01-23 22:45:04 -0500] gswallow: without filling out the junk template in /tmp *first*, the ruby block fails to fetch the erb file from Chef server.
[2014-01-23 22:45:14 -0500] coderanger: gswallow: Just calling .new on a resource won't actually converge it
[2014-01-23 22:45:19 -0500] gswallow: Right.
[2014-01-23 22:45:37 -0500] gswallow: I can call .converge, then?
[2014-01-23 22:45:41 -0500] gswallow: (or something close)
[2014-01-23 22:45:46 -0500] coderanger: so two things
[2014-01-23 22:45:55 -0500] coderanger:  first you need to pass the run_context as the second init arg
[2014-01-23 22:46:11 -0500] gswallow: ok
[2014-01-23 22:46:15 -0500] coderanger: second call .run_action(:create)
[2014-01-23 22:47:00 -0500] gswallow: I'm already doing that.
[2014-01-23 22:47:13 -0500] gswallow: Let me give your first hint a shot.
[2014-01-23 22:52:45 -0500] AcesWayUpHigh: is it better to use chef to deploy code, or use a "deployment" tool like capistrano or octopus deploy?
[2014-01-23 22:52:57 -0500] gswallow: @aceswayuphigh I used to use capistrano
[2014-01-23 22:53:04 -0500] coderanger: AcesWayUpHigh: Up to you, I use chef for all of it
[2014-01-23 22:53:24 -0500] gswallow: Nowadays I use the application cookbook which does pretty much the same thing, but it benefits from search and not having to juggle two different DSLs.
[2014-01-23 22:53:38 -0500] AcesWayUpHigh: ah
[2014-01-23 22:54:06 -0500] coderanger: Hopefuilly application 2.0 will be coming soon :)
[2014-01-23 22:54:17 -0500] gswallow: @coderanger by jove I think it works.
[2014-01-23 22:55:04 -0500] gswallow: I don't really *get* what a run context is but whatevs.  some day I will actually learn enough about Ruby to speak intelligently.  Thanks!
[2014-01-23 22:55:30 -0500] coderanger: gswallow: it holds all the information about the current converge run
[2014-01-23 22:55:44 -0500] coderanger: like which cookbooks are being used, which resources have been loaded, etc
[2014-01-23 22:56:57 -0500] gswallow: oh, wait.  perhaps I didn't quite remove the template from chef's cache.
[2014-01-23 22:59:42 -0500] gswallow: Yeah, still fails :/
[2014-01-23 23:01:01 -0500] gswallow: I updated the gist, in case anyone's still interested.
[2014-01-23 23:04:38 -0500] coderanger: gswallow: Oh, no
[2014-01-23 23:04:43 -0500] coderanger: don't make a new run_context
[2014-01-23 23:04:49 -0500] coderanger: you need to propagate the existing one
[2014-01-23 23:05:13 -0500] coderanger: pass it in from your recipe code
[2014-01-23 23:07:43 -0500] gswallow: is that just node.run_context?
[2014-01-23 23:07:59 -0500] coderanger: Or just plain run_context
[2014-01-23 23:08:26 -0500] coderanger: Also I have to giggle a bit
[2014-01-23 23:08:35 -0500] coderanger: because https://github.com/opscode/chef/blob/master/lib/chef/recipe.rb#L74-L76 is the definition of "node" in a recipe context
[2014-01-23 23:08:36 -0500] coderanger: :-)
[2014-01-23 23:12:26 -0500] gswallow: wow it's that simple.
[2014-01-23 23:13:07 -0500] magoo: okay, I've got a developer writing his rails app in rvm and we'd like to deploy it with an application cookbook and simply use the ruby version being developed against
[2014-01-23 23:13:23 -0500] magoo: i'd really like to keep this simple and not have to install rvm, etc
[2014-01-23 23:14:01 -0500] magoo: i'm seeing a lot of seemingly overcomplicated solutions
[2014-01-23 23:14:33 -0500] magoo: this should be really straight forward. If we just package install ruby 1.9.3 can the application spec that?
[2014-01-23 23:15:22 -0500] flaccid: magoo: try the application_ruby cookbook
[2014-01-23 23:16:09 -0500] magoo: can we pass in the ruby environment to be used with that cookbook
[2014-01-23 23:16:13 -0500] magoo: that's what's not clear to me
[2014-01-23 23:16:14 -0500] flaccid: magoo: i also built this kind of frontend / wrapper cookbook to it https://github.com/flaccid/cookbooks/tree/master/cookbooks/rails_app
[2014-01-23 23:16:40 -0500] magoo: okay, 1 sec
[2014-01-23 23:17:51 -0500] magoo: so when you use the application_ruby lwrps, you can specify the ruby version to be installed/used without going through rvm
[2014-01-23 23:18:05 -0500] magoo: since I know i can have multiple system rubies
[2014-01-23 23:18:13 -0500] flaccid: can you?
[2014-01-23 23:18:33 -0500] magoo: yeah, the default will remain 1.9.1
[2014-01-23 23:19:03 -0500] magoo: it's just multiple paths i beleive
[2014-01-23 23:19:11 -0500] flaccid: which lwrp and attribute?
[2014-01-23 23:19:59 -0500] magoo: n/m, apparently when you install 1.9.3 in ubuntu, it's really just symlinking 1.9.1
[2014-01-23 23:20:39 -0500] flaccid: magoo: there is a long story to that, but there is ruby1.9.3 package, maybe it is just ruby1.9.1
[2014-01-23 23:20:49 -0500] magoo: flaccid: i don't know, I'm just asking if this is possible
[2014-01-23 23:21:03 -0500] magoo: we're afraid to actually upgrade the system ruby
[2014-01-23 23:21:11 -0500] magoo: but that's the simplest option
[2014-01-23 23:21:21 -0500] flaccid: http://packages.ubuntu.com/search?suite=raring&searchon=names&keywords=ruby1.9.3
[2014-01-23 23:21:21 -0500] magoo: update-alternatives and all taht
[2014-01-23 23:22:46 -0500] flaccid: looks like https://github.com/jtimberman/ruby-cookbook/blob/master/definitions/ruby_packages.rb could use contrib to support 1.9.3
[2014-01-23 23:25:21 -0500] Majost: I am not sure if this chefspec is bad practice or not: expect(subject).to create_user(subject.node['user_attr'])
[2014-01-23 23:25:23 -0500] Majost: thoughts?
[2014-01-23 23:26:59 -0500] magoo: flaccid: what version of ruby does this wrapper use?
[2014-01-23 23:27:07 -0500] magoo: it looks like it would just be default system ruby
[2014-01-23 23:28:54 -0500] flaccid: magoo: yeah i didn't employ rvm or rbenv or anything because the instance wouldn't share ruby. can't say i really finished the project
