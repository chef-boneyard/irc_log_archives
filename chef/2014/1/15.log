[2014-01-15 00:04:04 -0500] Guest81523: I have a bash script that does gpg gen-key and import. It works well when I execute in the shell, but when I run chef (soloist), it does work as well.
[2014-01-15 00:04:10 -0500] Guest81523: How can I debug such issues?
[2014-01-15 00:04:37 -0500] flaccid: by looking at the chef output
[2014-01-15 00:05:26 -0500] Guest81523: Chef output: gpg: can't create `(null)': Permission denied - doesn't happen when I execute the bash script.
[2014-01-15 00:05:48 -0500] flaccid: could be an error in your code
[2014-01-15 00:06:05 -0500] Guest81523: the chef code?
[2014-01-15 00:06:06 -0500] flaccid: but we also can't see the whole chef output, you have not provided enough specific information unfortunately
[2014-01-15 00:06:10 -0500] flaccid: yes
[2014-01-15 00:06:31 -0500] Guest81523: cookbook_file "/tmp/import_gpg_key.sh" do
[2014-01-15 00:06:32 -0500] Guest81523:   source "gpg/import_gpg_key.sh"
[2014-01-15 00:06:32 -0500] Guest81523:   mode 0755
[2014-01-15 00:06:32 -0500] Guest81523: end
[2014-01-15 00:06:45 -0500] flaccid: why would yo do that?
[2014-01-15 00:06:46 -0500] Guest81523: execute "generate key" do
[2014-01-15 00:06:46 -0500] Guest81523:   #command "sh /tmp/import_gpg_key.sh >/dev/null 2>/dev/null"
[2014-01-15 00:06:46 -0500] Guest81523:   command "sh /tmp/import_gpg_key.sh"
[2014-01-15 00:06:46 -0500] Guest81523:   action :run
[2014-01-15 00:06:47 -0500] Guest81523: end
[2014-01-15 00:07:05 -0500] Guest81523: is there a better way?
[2014-01-15 00:07:22 -0500] flaccid: yes, but it depends what you are trying to actually achieve
[2014-01-15 00:07:27 -0500] timsmith1: what class should methods in a library be in so they can be accessed by LWRPs?
[2014-01-15 00:08:22 -0500] Guest81523: flaccid, I should explain. I'm trying to setup a encrypted backups. That requires gpg, which means I have to either generate the GPG key for the backup user or, import it.
[2014-01-15 00:08:48 -0500] Guest81523: Given that I don't know enough about chef, I figured it would have been easier to use a combination of imports and bash scripts.
[2014-01-15 00:08:55 -0500] Guest81523: Though that's probably not as efficient.
[2014-01-15 00:09:13 -0500] flaccid: there is quite a few gpg cookbooks available
[2014-01-15 00:09:19 -0500] Guest81523: There are?!
[2014-01-15 00:09:27 -0500] flaccid: google is amazing :)
[2014-01-15 00:10:04 -0500] Guest81523: You know... when I type chef gpg cookbook, I get only a few results that I can't really make sense out of.
[2014-01-15 00:10:19 -0500] Guest81523: seems like I'm missing something. Yeah?
[2014-01-15 00:10:30 -0500] Guest81523: note, I'm completely new to chef
[2014-01-15 00:11:16 -0500] flaccid: Guest81523: i'd help with your initial problem but its simply not the right way to do it and we don't have a copy of the sh script you are using anyway
[2014-01-15 00:11:51 -0500] Guest81523: I would rather learn the right way than to subject you to my flawed logic.
[2014-01-15 00:12:02 -0500] Guest81523: I'm not in love with my work.
[2014-01-15 00:12:28 -0500] flaccid: basically from google, check out those gpg cookbooks, we know that it will at least install gpg stuff. see if they provide functionality to generate keys and such, if they don't you can contrib
[2014-01-15 00:29:54 -0500] ponyofdeath: hi, trying to upgrade my chef server from 11.0.4 to 11.0.10 http://paste.ubuntu.com/6753508
[2014-01-15 00:29:58 -0500] ponyofdeath: any ideas?
[2014-01-15 00:30:50 -0500] ponyofdeath: figured it out had to do a start first
[2014-01-15 00:36:37 -0500] timsmith1: what class should methods in a library be in so they can be accessed by LWRPs?
[2014-01-15 00:53:04 -0500] choey: anyone have ideas how to work around strange knife search behavior when using NOT in the start of a search?
[2014-01-15 00:53:22 -0500] choey: for example knife search node "chef_environment:dev AND NOT name:webapp1234"
[2014-01-15 00:53:26 -0500] choey: that works fine
[2014-01-15 00:53:40 -0500] choey: but put the NOT in the start of the query and its invalid
[2014-01-15 00:53:47 -0500] Guest81523: Ok....
[2014-01-15 00:53:49 -0500] choey: is that to be expected?
[2014-01-15 00:54:15 -0500] choey: it is biting me in search based hostgroups for nagios cookbook
[2014-01-15 00:54:18 -0500] Guest81523: Using https://github.com/hw-cookbooks/gpg - I'm not sure how I generate a key for a different user. It seems there is a way, but I'm too dense to figure it out.
[2014-01-15 00:54:21 -0500] Guest81523: Suggestions?
[2014-01-15 00:54:42 -0500] MrBIOS: Hi folks, I just did an upgrade from Chef Server 11.0.8 to 11.0.10 to address some security vulnerabilities, and now the attributes/values that were previously displaying in the "environment default and override attributes" section of the edit pane in the WebUI is blank
[2014-01-15 00:56:29 -0500] prometheanfire: coderanger: it was a namespace issue, thanks for the patience :D
[2014-01-15 00:56:59 -0500] flaccid: Guest81523: you need to set the attribute node['gpg']['user'] to what you want
[2014-01-15 00:57:24 -0500] Guest81523: thx flaccid. That's enough to get my going.
[2014-01-15 02:14:52 -0500] choey: created a ticket for my search issue mentioned earlier https://tickets.opscode.com/browse/CHEF-4959
[2014-01-15 02:35:08 -0500] broconne: for people who create a git project for every cookbook...  how do your coworkers know which cookbooks are available?
[2014-01-15 02:38:47 -0500] flaccid: broconne: its under the one org
[2014-01-15 02:38:54 -0500] flaccid: (on github)
[2014-01-15 02:39:28 -0500] broconne: we aren't using github, just using ssh to another server..
[2014-01-15 02:39:48 -0500] broconne: so, when its under one org.. that means they can browse it on github.. I assume?  but do they do a git fetch for hte org?
[2014-01-15 02:39:50 -0500] broconne: err clone
[2014-01-15 02:40:45 -0500] broconne: is the org level, essentially a github feature - not a standard git feature?
[2014-01-15 02:41:13 -0500] flaccid: i don't know what problem you are trying to solve. if you are not using something like github, basic human communication works well
[2014-01-15 02:41:21 -0500] flaccid: or using an internal wiki or what not
[2014-01-15 02:41:30 -0500] flaccid: a github org is available to all github accounts
[2014-01-15 02:41:38 -0500] flaccid: its not a git feature
[2014-01-15 02:42:20 -0500] broconne: ok, that is what I figured.. would have to generate something ourselves to make it clear what projects are available.
[2014-01-15 02:42:26 -0500] broconne: s/projects/cookbooks
[2014-01-15 02:43:31 -0500] broconne: Somewhat new to git here.. would submodules not be the way to handle this?  If I wanted to checkout a single project that had all the cookbooks in it, yet have a cookbook per repo still?
[2014-01-15 02:43:33 -0500] flaccid: well generally companies would only have private git repos for stuff specific to them, everything else should be open source :)
[2014-01-15 02:43:48 -0500] flaccid: broconne: the question is, why would you do that?
[2014-01-15 02:43:56 -0500] flaccid: what are you using the cookbooks with?
[2014-01-15 02:44:21 -0500] broconne: Having Jenkins automatically kick off foodcritic and our test kitchen stuff - leads us to one cookbook per repo.
[2014-01-15 02:44:31 -0500] flaccid: certainly you can submodule within 1 repo, thats going to be pretty fat, but what purpose or problem would it actually solve
[2014-01-15 02:44:55 -0500] broconne: Having a team of several hundred people and not wanting to maintain a wiki of every cookbook was the reason to do sub modules.
[2014-01-15 02:45:01 -0500] flaccid: just add each new cookbook repo to jenkins
[2014-01-15 02:45:11 -0500] broconne: yes, the jenkins is solved easily
[2014-01-15 02:45:27 -0500] flaccid: submodules is pointless
[2014-01-15 02:45:53 -0500] broconne: so presently.. what we do is a simple.  git clone
[2014-01-15 02:45:59 -0500] broconne: and it pulls down all of our cookbooks
[2014-01-15 02:46:21 -0500] broconne: well, cookbooks, data_bags, environments, roles
[2014-01-15 02:46:33 -0500] flaccid: are you just talking about users doing dev/test stuff?
[2014-01-15 02:46:34 -0500] broconne: when we move to a cookbook per git repo.. we are going to lose that simplicity
[2014-01-15 02:46:53 -0500] broconne: not limited to dev/test.
[2014-01-15 02:47:10 -0500] broconne: people having to update an attribute, etc.
[2014-01-15 02:47:13 -0500] flaccid: why would that apply to production? cookbooks are generally uploaded to the chef server with knife
[2014-01-15 02:47:42 -0500] flaccid: right so they clone the repo, commit and push that change back to it
[2014-01-15 02:47:54 -0500] broconne: so..
[2014-01-15 02:48:01 -0500] flaccid: if all cookbooks share a repo, thats not going to help with anything namespace contextual for things like branches and tags
[2014-01-15 02:48:01 -0500] broconne: lets say.. I have.. I don't know 100 cookbooks
[2014-01-15 02:48:12 -0500] broconne: do they do 100 git clones to pull down every cookbook
[2014-01-15 02:48:27 -0500] broconne: since each one is in the git repo
[2014-01-15 02:48:27 -0500] flaccid: nope, they use berkshelf or librarian-chef
[2014-01-15 02:48:29 -0500] broconne: in its own
[2014-01-15 02:49:37 -0500] broconne: so, berkshelf - from what i can tell.. you still need a berksfile and its a berksfile per cookbook.
[2014-01-15 02:50:01 -0500] broconne: so if I wanted to pull down the cookbooks, to look at them, how does berkshelf solve that problem?
[2014-01-15 02:50:27 -0500] flaccid: well you can do it in one file afaik, but i don't use it
[2014-01-15 02:50:33 -0500] flaccid: i use librarian-chef with one Cheffile
[2014-01-15 02:51:02 -0500] broconne: I will tak ea look at librian-chef and see if it fits us better than berks does.
[2014-01-15 02:51:04 -0500] flaccid: the point is, you wouldn't want to arbitrarily pull down 'all' repositories anyway, you would define that in some sort of file
[2014-01-15 02:51:47 -0500] flaccid: broconne: example https://github.com/chef-blueprints/linux_box/blob/master/Cheffile
[2014-01-15 02:53:15 -0500] broconne: I will take a look at that.. and I don't want to pull down all of the external dependencies.. just our cookbooks.. simply.. so someone can look across them, or even say search across them with a find.
[2014-01-15 02:53:36 -0500] broconne: which is easy when you have one git repo for all your cookbooks...  but doesn't seem to be so simple with a repo per cookbook model
[2014-01-15 02:58:50 -0500] iverson0881: is that a bit like composer for php?
[2014-01-15 02:59:52 -0500] flaccid: broconne: it won't pull down deps unless the cookbooks are on the community site via its api and defined as such in the file
[2014-01-15 03:00:07 -0500] flaccid: iverson0881: php, yeek
[2014-01-15 03:00:48 -0500] broconne: at this point, we use zero community cookbooks.. its our cookbooks that I am trying to solve.
[2014-01-15 03:01:06 -0500] flaccid: broconne: sure, then its already solved :)
[2014-01-15 03:01:17 -0500] broconne: not if I want a repo per cookbook
[2014-01-15 03:01:18 -0500] broconne: it seems
[2014-01-15 03:01:34 -0500] broconne: and the ability for someone to pull down all our cookbooks without cloning each one individually
[2014-01-15 03:01:39 -0500] flaccid: broconne: the link i gave you shows how to do that
[2014-01-15 03:01:55 -0500] broconne: ok, great.. will take a look at librian.  thanks
[2014-01-15 03:01:56 -0500] broconne: !
[2014-01-15 03:02:07 -0500] flaccid: broconne: wrong approach that. there is no api to say hey, give me all your cookbooks
[2014-01-15 03:02:25 -0500] broconne: it certainly appears that way.
[2014-01-15 03:02:28 -0500] flaccid: well, you can iterate through all the directories if thats how your git server is setup, that just seems silly to me
[2014-01-15 03:02:31 -0500] broconne: the cookbook per repo model may not fit our model.
[2014-01-15 03:02:41 -0500] flaccid: your model is wrong
[2014-01-15 03:06:54 -0500] masterkorp: guys how do I run test-kitchen in debug mode ?
[2014-01-15 03:09:08 -0500] flaccid: masterkorp: try http://kitchen.ci/docs/getting-started/getting-help or maybe it doesn't have that mode
[2014-01-15 03:10:14 -0500] broconne: flaccid:  when I read the docs for librian-chef it indicates not use it to manage projects that are inherently part of your infrastructure repository.. FYI
[2014-01-15 03:10:38 -0500] flaccid: broconne: URL?
[2014-01-15 03:10:49 -0500] broconne: https://github.com/applicationsonline/librarian-chef
[2014-01-15 03:11:00 -0500] broconne: If you have cookbooks which are, rather than being separate projects, inherently part of your infrastructure repository, then they should go in a separate directory, like yoursite-cookbooks/directory, and you do not need to use Librarian-Chef to manage them.
[2014-01-15 03:11:28 -0500] flaccid: well thats the opposite of what you are doing and site-cookbooks is basically deprecated
[2014-01-15 03:11:45 -0500] flaccid: that should be updated, you can raise a pull request to do so
[2014-01-15 03:11:55 -0500] broconne: so backing up..
[2014-01-15 03:12:04 -0500] broconne: I have 100 cookbooks that we have written
[2014-01-15 03:12:20 -0500] broconne: theese are not from open source or any other repository
[2014-01-15 03:12:22 -0500] broconne: intenral cookbooks
[2014-01-15 03:12:59 -0500] flaccid: internal would be 'any other repository' :)
[2014-01-15 03:13:53 -0500] broconne: it does look like librarian can just pull everything down based on the chef-file so will continue to look at that.
[2014-01-15 03:14:03 -0500] broconne: thanks
[2014-01-15 03:14:18 -0500] flaccid: yeah that was my proposition, the git source can be a git:///
[2014-01-15 03:14:27 -0500] flaccid: i'm just using https because its on github
[2014-01-15 03:17:21 -0500] flaccid: masterkorp: i can haz arch pr?
[2014-01-15 03:20:08 -0500] masterkorp: pr ?
[2014-01-15 03:20:20 -0500] flaccid: pull request
[2014-01-15 03:20:33 -0500] masterkorp: first work, then play :)
[2014-01-15 03:20:51 -0500] flaccid: well, i'm curious on what you want to change tehre
[2014-01-15 03:21:13 -0500] flaccid: one note is that i won't accept deps that are version suffixed in package name, just to let you know
[2014-01-15 03:22:32 -0500] wateronsand: hi all, trying to set an attribute from within my recipe, relevant line: node.set["exhibitor"]["opts"]["s3config"] = "mycompany-zookeeper-config-bucket:" + File.read('/home/ubuntu/clusteridfile')
[2014-01-15 03:22:48 -0500] wateronsand: that attribute isn't mentioned elsewhere in the cookbook
[2014-01-15 03:23:05 -0500] wateronsand: but the value winds up empty in the upstart command line
[2014-01-15 03:23:40 -0500] broconne: should you be sing node.set (or node.default or node.override) based on the context?
[2014-01-15 03:24:03 -0500] wateronsand: i've tried node.override, thinking i could brute-force it, but same result
[2014-01-15 03:24:16 -0500] flaccid: there isn't really enough info there to help
[2014-01-15 03:24:30 -0500] wateronsand: what else can i offer to narrow it down
[2014-01-15 03:24:32 -0500] wateronsand: ?
[2014-01-15 03:24:32 -0500] broconne: to help with troubleshooting.. if you take our the File.read part.. do you get the first part where you expect it?
[2014-01-15 03:24:44 -0500] flaccid: wateronsand: the cookbook, your cookbook, the chef output
[2014-01-15 03:24:48 -0500] wateronsand: broconne: good succestion, will try that
[2014-01-15 03:24:52 -0500] wateronsand: *suggestion
[2014-01-15 03:26:14 -0500] flaccid: i don't know what upstart command line is either
[2014-01-15 03:30:29 -0500] wateronsand: flaccid: the cookbook is zookeeper 1.4.7 from the opscode community site
[2014-01-15 03:31:24 -0500] flaccid: wateronsand: you do realize you don't need a cookbook to set a node attribute right?
[2014-01-15 03:32:09 -0500] wateronsand: yes
[2014-01-15 03:32:40 -0500] flaccid: i don't see that attribute in https://github.com/SimpleFinance/chef-zookeeper/blob/master/attributes/default.rb looks like they are doing something non standard
[2014-01-15 03:33:37 -0500] wateronsand: line 31, it's commented out
[2014-01-15 03:33:46 -0500] wateronsand: there's no defailt being set in their cookbook
[2014-01-15 03:33:47 -0500] broconne: its there, its commented out...  wateronsand - you are setting all 4 attributes right?
[2014-01-15 03:34:12 -0500] flaccid: what they are doing is wrong, they don't even have the dep in https://github.com/SimpleFinance/chef-zookeeper/blob/master/metadata.rb#L8
[2014-01-15 03:34:47 -0500] wateronsand: broconne: yes, in the attributes file, i need to set the s3config opt in the recipe so it can include the contents of a file
[2014-01-15 03:35:08 -0500] flaccid: looking at https://github.com/SimpleFinance/chef-zookeeper/blob/master/recipes/exhibitor.rb they are namespacing wrong thats for sure. alas if you set the node attribute on the node itself i don't see the problem. you don't need a cookbook to do that
[2014-01-15 03:35:22 -0500] flaccid: but you have not cited the actual issue
[2014-01-15 03:35:28 -0500] wateronsand: i should say,i'm setting 3 of them in the attributes file
[2014-01-15 03:35:37 -0500] broconne: default[:exhibitor][:opts][:configtype] = "file"   -- did you set that to s3?
[2014-01-15 03:35:38 -0500] flaccid: you don't edit upstream cookbooks
[2014-01-15 03:36:06 -0500] wateronsand: broconne: in my cookbook's attribute's file:
[2014-01-15 03:36:07 -0500] wateronsand: override['exhibitor']['opts']['configtype'] = "s3"
[2014-01-15 03:36:07 -0500] wateronsand: override['exhibitor']['opts']['s3credentials'] = "/opt/zookeeper/s3credentials.properties"
[2014-01-15 03:36:08 -0500] wateronsand: override['exhibitor']['opts']['s3region'] = "us-east-1"
[2014-01-15 03:36:10 -0500] broconne: by set, I mean ovverride?
[2014-01-15 03:36:17 -0500] wateronsand: my cookbook includes the community one
[2014-01-15 03:36:43 -0500] wateronsand: include_recipe "zookeeper::exhibitor"
[2014-01-15 03:36:44 -0500] flaccid: cept you don't need to set attributes by cookbook, you can do it with node.json, knife, ui etc.
[2014-01-15 03:37:02 -0500] broconne: minor style thing, should use single quotes unless you are doing replacment in the values.   but that isn't your issue.
[2014-01-15 03:37:42 -0500] broconne: of course, the cookbook you are using is using double quotes.. so.. whatever I guess :-)
[2014-01-15 03:38:02 -0500] flaccid: wateronsand: if you really really want to needlessly wrap like that do https://github.com/rightscale-cookbooks/rs-base/blob/master/recipes/ntp.rb#L20
[2014-01-15 03:39:01 -0500] wateronsand: flaccid: style/necessity aside, *should* i be able to set this attribute in the recipe, and if so, how?
[2014-01-15 03:39:12 -0500] flaccid: and ensure teh recipe is in the run_list before
[2014-01-15 03:39:25 -0500] wateronsand: https://wiki.opscode.com/display/chef/Attributes+Cookbook says i can set attributes in a recipe by prefixing with node.
[2014-01-15 03:39:28 -0500] flaccid: wateronsand: i just pasted an example on that
[2014-01-15 03:39:42 -0500] flaccid: ^^
[2014-01-15 03:40:33 -0500] broconne: wateronsand - what you have looks ok to me.. based on what you said.. what is the upstart issue you are seeing?
[2014-01-15 03:43:04 -0500] wateronsand: broconne: the upstart config generated by the cookbook doesn't contain the value of the s3config attribute as it does for the other 3 attributes
[2014-01-15 03:43:21 -0500] broconne: ok - so the override on the others is working just fine..
[2014-01-15 03:43:24 -0500] broconne: right?
[2014-01-15 03:43:41 -0500] wateronsand: yes, but those are set in attributes/default.rb
[2014-01-15 03:43:42 -0500] broconne: and to verify.. you do your node.set or node.override BEFORE you do the include_recipe, right?
[2014-01-15 03:43:50 -0500] wateronsand: if i set the s3config attribute in the attributes/default.rb file, the s3config value shows up in the generated file
[2014-01-15 03:44:13 -0500] wateronsand: broconne: no, i set it *after* - order of operations?
[2014-01-15 03:44:17 -0500] broconne: yes
[2014-01-15 03:44:22 -0500] broconne: that will be the issue
[2014-01-15 03:44:27 -0500] flaccid: wateronsand: study https://github.com/SimpleFinance/chef-zookeeper/blob/master/templates/default/exhibitor.upstart.conf.erb
[2014-01-15 03:45:12 -0500] broconne: when you call include_recipe.. its better to think of it as if it were named "run_recipe" because that is essentially what it does.
[2014-01-15 03:45:13 -0500] flaccid: wow, uses sudo instead of su as well, what a fail
[2014-01-15 03:45:24 -0500] broconne: So, anything you set after that wont have any impact.
[2014-01-15 03:45:29 -0500] flaccid: no it doesn't it compiles the include, it doesn't run it
[2014-01-15 03:45:45 -0500] wateronsand: broconne: that did it. thanks, folks!
[2014-01-15 03:46:10 -0500] broconne: but the compilation may use the values at that point in time.. but good point flaccid
[2014-01-15 03:46:13 -0500] broconne: np
[2014-01-15 03:46:39 -0500] flaccid: oh you never actually included the recipe or had it in the run_list?
[2014-01-15 03:47:33 -0500] wateronsand: flaccid: it was included in my recipe, but *before* I set the attribute
[2014-01-15 03:48:40 -0500] flaccid: oh, this is why its better to just set the attribute on the node, but you'll see that same flow of include after from the url i referred https://github.com/rightscale-cookbooks/rs-base/blob/master/recipes/ntp.rb#L20
[2014-01-15 03:49:01 -0500] flaccid: thats the right pattern if you want to wrap around an upstream cookbook with attributes in a different namespace
[2014-01-15 03:51:15 -0500] flaccid: basically the node.* methods inject into the compile phase there which is why ordering matters
[2014-01-15 03:52:25 -0500] wateronsand: thanks for the style suggestion/corrections, still wrapping my head around chef. appreciate the help!
[2014-01-15 03:54:48 -0500] flaccid: nps y0, there is always caveats with all da hackeries available
[2014-01-15 05:26:33 -0500] brucelee: :p
[2014-01-15 05:26:53 -0500] brucelee: sup guys, whats everyone up to?
[2014-01-15 05:28:45 -0500] brucelee: anyone want to get iptables setup with me :p
[2014-01-15 05:49:29 -0500] samsonasu: im running chef-client on a node and it's not downloading the latest versions of my cookbooks from my chef server, any idea why?  it just seems stuck on an old version
[2014-01-15 05:54:15 -0500] flaccid: brucelee: no
[2014-01-15 06:05:42 -0500] brucelee: flaccid:  :p
[2014-01-15 06:05:59 -0500] brucelee: if i create a cookbook on my workstation, how do i delete it?
[2014-01-15 06:06:11 -0500] brucelee: i havent uploaded it to the chef server yet
[2014-01-15 06:06:29 -0500] brucelee: i guess i just remove the folder?
[2014-01-15 06:06:36 -0500] brucelee: i know theres a knife cookbook delete function
[2014-01-15 06:31:19 -0500] flaccid: brucelee: rm works good
[2014-01-15 06:54:06 -0500] brucelee: flaccid: just got vagrant set up, and berkshelf set up
[2014-01-15 06:54:12 -0500] brucelee: flaccid: im ready to do this!!!!
[2014-01-15 06:54:16 -0500] brucelee: flaccid: are you ready
[2014-01-15 07:06:15 -0500] someara: anyone want to test my iptables cookbook? http://github.com/someara/dyn-iptables
[2014-01-15 07:13:22 -0500] flaccid: brucelee: ready for what?
[2014-01-15 07:38:21 -0500] scairbus: any reason why this won't work in a recipe? results = search(:databag, "id:#{variable}"). I keep getting "bad request", it doesn't like my #{variable}... am I initializing it wrong?
[2014-01-15 08:07:14 -0500] Cope: scairbus: the index isn't called databag
[2014-01-15 08:07:21 -0500] Cope: it's the name of your databag
[2014-01-15 08:07:26 -0500] scairbus: I know, that's just for the example
[2014-01-15 08:07:29 -0500] Cope: sorry :)
[2014-01-15 08:07:34 -0500] scairbus: np
[2014-01-15 08:07:52 -0500] scairbus: I'm reading variable using back ticks, looking to see if that's my problem
[2014-01-15 08:08:07 -0500] Cope: could you show the code?
[2014-01-15 08:08:21 -0500] Cope: someara: w00t
[2014-01-15 08:08:36 -0500] scairbus: yeah, this isn't proprietary hehe
[2014-01-15 08:08:52 -0500] scairbus: service_tag = `cat /etc/service_tag`
[2014-01-15 08:08:53 -0500] scairbus: bootstrap = search(:systems, %Q{id:"#{service_tag}"})
[2014-01-15 08:08:57 -0500] someara: wat
[2014-01-15 08:09:23 -0500] scairbus: I have a bunch of data bags in systems that are ID'ed by their (Dell) Service Tag
[2014-01-15 08:13:16 -0500] ag839: hey all - first time working with the opscode community cookbook for php - somewhat baffled as to how to use it to install anything other than PHP 5.3.3.  Attemped on RHEL6 and CentOS6 with same results - after attempting to ovveride the default attributes for version number and install_method.  Hoping someone here can set me straight..
[2014-01-15 08:13:17 -0500] Cope: scairbus: I'd write an ohai plugin that surfaces the service tag
[2014-01-15 08:13:30 -0500] Cope: and then you'd have it as a node attribute wherever you like
[2014-01-15 08:13:48 -0500] scairbus: would that work early in the boot process?
[2014-01-15 08:14:24 -0500] scairbus: would I still be able to search for data bags with node['service_tag'] then?
[2014-01-15 08:15:06 -0500] Cope: could you clarify what you mean by 'early in the boot process' ?
[2014-01-15 08:15:47 -0500] scairbus: during preseed/pxe
[2014-01-15 08:16:12 -0500] Cope: you run chef as part of the preseed?
[2014-01-15 08:16:24 -0500] scairbus: yeah, with the pxe_dust cookbook
[2014-01-15 08:16:55 -0500] Cope: ok - yeah that should be fine; when chef runs, ohai data is used to build the node
[2014-01-15 08:16:57 -0500] scairbus: I put system details in a databag, system preseeds, runs chef to grab it's config and apply it
[2014-01-15 08:17:30 -0500] scairbus: ok cool thanks. haven't tried writing an ohai plugin before, I'll take a look
[2014-01-15 08:17:38 -0500] Cope: it's pretty easy
[2014-01-15 08:17:52 -0500] scairbus: I just need to run dmidecode and assign it to an attribute
[2014-01-15 08:17:55 -0500] Cope: but wait a sec... just trying to check your ordering
[2014-01-15 08:18:02 -0500] scairbus: seems straight forward
[2014-01-15 08:18:20 -0500] Cope: so you know the service tags in advance? and you'll populate a databag with them?
[2014-01-15 08:18:42 -0500] Cope: then when chef runs, ohai finds the service tag, chef does it's thing... that's all fine
[2014-01-15 08:19:54 -0500] scairbus: yeah
[2014-01-15 08:20:22 -0500] Cope: great - you should be golden then :)
[2014-01-15 08:20:51 -0500] scairbus: cool thanks. make the system do all the work once this is done :-)
[2014-01-15 08:20:58 -0500] Cope: wicked!
[2014-01-15 08:25:00 -0500] brucelee: flaccid: ready to help me get this iptables recipe under control :p
[2014-01-15 08:35:12 -0500] zxd: I have this in a template file
[2014-01-15 08:35:17 -0500] zxd: is it valid syntax  http://pastebin.com/aGjXcfN1  ??
[2014-01-15 08:39:54 -0500] flaccid: brucelee: is the pope jewish?
[2014-01-15 08:40:51 -0500] flaccid: zxd: did you try it ?
[2014-01-15 08:41:21 -0500] flaccid: zxd: you should do the logic in the recipe not the template
[2014-01-15 08:41:36 -0500] Chakri: I am trying to install chef server on Fedora 17, it freezes at supervise_rabbitmq_sleep
[2014-01-15 08:41:38 -0500] flaccid: the template resource has a variables option
[2014-01-15 08:41:44 -0500] Chakri: any workaround ?
[2014-01-15 08:41:55 -0500] flaccid: Chakri: try debian
[2014-01-15 08:42:22 -0500] Chakri: @flaccid, all our vms are fedora
[2014-01-15 08:42:39 -0500] Chakri: I wish I have a choice
[2014-01-15 08:42:56 -0500] Chakri: ruby_block[supervise_rabbitmq_sleep] action run - freezes here
[2014-01-15 08:43:18 -0500] flaccid: there is no ombnibus package you can use?
[2014-01-15 08:44:02 -0500] Chakri: ombnibus ? sorry I am new to chef. Just started working on it.
[2014-01-15 08:44:30 -0500] Cope: Chakri: https://opscode-omnibus-packages.s3.amazonaws.com/el/6/x86_64/chef-server-11.0.10-1.el6.x86_64.rpm
[2014-01-15 08:44:33 -0500] Cope: install that
[2014-01-15 08:44:37 -0500] flaccid: Chakri: https://github.com/opscode/omnibus-chef-server
[2014-01-15 08:44:58 -0500] Chakri: Cool, let me try. Thx folks
[2014-01-15 08:45:09 -0500] flaccid: yeah in the rpm world somehow any rpm distro = el
[2014-01-15 08:45:43 -0500] flaccid: 11.0.10 seems very old
[2014-01-15 08:47:08 -0500] zxd: flaccid: I can't do the logic in recipe because the code under providers/ overwrites it
[2014-01-15 08:47:28 -0500] zxd: flaccid: is it possible to overwrite the values under providers ?
[2014-01-15 08:47:47 -0500] zxd: flaccid: if I run the resource then my code underneath it in the recipe ?
[2014-01-15 08:48:31 -0500] flaccid: [19:41] <flaccid> zxd: you should do the logic in the recipe not the template
[2014-01-15 08:50:35 -0500] Cope: flaccid: really? it's the newest on the download page, but I don't run my own chef server, so I don't really know.
[2014-01-15 08:51:23 -0500] flaccid: Cope: thats the problem
[2014-01-15 08:51:39 -0500] Cope: that teh download page has an old package?
[2014-01-15 08:53:07 -0500] Chakri: flaccid - how do I install using omnibus? should I git clone and run commands ?
[2014-01-15 08:53:30 -0500] Cope: Chakri: omnibus is the tool used to create packages which contain all you need in one place
[2014-01-15 08:53:35 -0500] flaccid: Cope Chakri fedora is not supported http://www.getchef.com/chef/install/
[2014-01-15 08:54:14 -0500] Chakri: I am running on fedora.
[2014-01-15 08:54:15 -0500] Cope: flaccid: f17 will very likely be fine with an el6 package - it's definitely worth a try.  I'd be very surprised if it didn't just work.
[2014-01-15 08:54:18 -0500] flaccid: if you want to build a package with omnibus, the link i provided will show you how
[2014-01-15 08:54:27 -0500] zxd: flaccid: the providers/default.rb looks like this  http://pastebin.com/gH1Vr2a9  , can you tell me what to put in the recipe so that the logic I pasted overwrites @home to go in the template ??
[2014-01-15 08:54:38 -0500] Cope: Chakri: so you can use it to build your own package, using the link flaccid gave you
[2014-01-15 08:54:39 -0500] Chakri: cope - I tried it. didnt work
[2014-01-15 08:54:40 -0500] flaccid: Cope: sure, go ahead and support that
[2014-01-15 08:55:03 -0500] Chakri: sure. let me try
[2014-01-15 08:55:04 -0500] flaccid: didn't work = can't help you
[2014-01-15 08:55:14 -0500] Cope: Chakri: you tried what? you tried installing the el6 rpm?  what didn't work?
[2014-01-15 08:55:50 -0500] Chakri: yes, tried e16 rpm. it freeze at same location. supervise_rabbitmq_sleep
[2014-01-15 08:55:59 -0500] flaccid: zxd: can't help sorry
[2014-01-15 08:56:38 -0500] Cope: Chakri: ah ok... hmm; prolly need to delve into what that ruby block does and what is hanging.
[2014-01-15 08:57:32 -0500] Cope: Chakri: you really can't run a centos vm? you have no way to make the argument? f17 is pretty old now.... seems like an odd choice
[2014-01-15 08:58:06 -0500] Chakri: cope - we have all f17's. we are upgrading to f20
[2014-01-15 08:58:16 -0500] Chakri: cope - same error exist on f20 ?
[2014-01-15 08:58:37 -0500] Cope: Chakri: not sure! try it!  we need more infor really to find out what is actually causing the stall
[2014-01-15 08:59:05 -0500] Cope: but the 'correct' answer is: chef server isn't 'supported' on fedora; use debian or a rhel/rhel-cline
[2014-01-15 08:59:19 -0500] flaccid: or just use hosted chef
[2014-01-15 08:59:27 -0500] Cope: right - this is what I do
[2014-01-15 08:59:55 -0500] Cope: because my business isn't running chef servers - I pay 'chef' to do that
[2014-01-15 08:59:58 -0500] flaccid: you are on your own if you run a chef server without support
[2014-01-15 09:00:08 -0500] Cope: +1
[2014-01-15 09:00:10 -0500] Chakri: Cope Flaccid - thanks for support. we have servers in internal network.
[2014-01-15 09:00:28 -0500] flaccid: Chakri: get  opscode support
[2014-01-15 09:00:33 -0500] Cope: Chakri: also, 'enterprise chef' isn't expensive
[2014-01-15 09:00:40 -0500] flaccid: rather 'Chef support'
[2014-01-15 09:00:45 -0500] Cope: yeah that too
[2014-01-15 09:00:48 -0500] flaccid: whatever its called
[2014-01-15 09:00:52 -0500] Chakri: ah ok. let me explore
[2014-01-15 09:00:57 -0500] Cope: erm - nods
[2014-01-15 09:01:28 -0500] brucelee: flaccid: :p
[2014-01-15 09:03:22 -0500] flaccid: digressing, i have no idea why you would use fedora
[2014-01-15 09:07:07 -0500] brucelee: hmm
[2014-01-15 09:07:13 -0500] brucelee: just trying using berkshelf install
[2014-01-15 09:07:15 -0500] brucelee: and i got this: http://www.fpaste.org/68532/77681113/
[2014-01-15 09:07:34 -0500] brucelee: some library not loaded
[2014-01-15 09:08:09 -0500] brucelee: anyone have an idea how i can fix this
[2014-01-15 09:12:25 -0500] Cope: flaccid: well... it has a tonne of extra selinux stuff you might want, a modern kernel, and already packaged new stuff eg httpd 2.4 etc
[2014-01-15 09:12:26 -0500] brucelee: just googled a little
[2014-01-15 09:12:30 -0500] brucelee: reinstalling nokogiri
[2014-01-15 09:12:38 -0500] Cope: but yeah, an odd choice
[2014-01-15 09:13:08 -0500] Cope: Chakri: i'd be interested to know the rationale
[2014-01-15 09:15:45 -0500] brucelee: ok got it running
[2014-01-15 09:29:17 -0500] flaccid: Cope: i use archlinux so thats already behind
[2014-01-15 09:39:24 -0500] flaccid: Cope: arch linux already has the latest of all of that because its rolling release
[2014-01-15 09:39:55 -0500] flaccid: sorry, time for dinner i think
[2014-01-15 09:40:48 -0500] flaccid: cyas
[2014-01-15 09:47:36 -0500] kisoku: omnitruck makes me sad
[2014-01-15 10:00:24 -0500] daxroc: Has anyone else got the random 403 response from S3 within a chef run ( a second run succeeds ). From what I've gathered it's because of time skew, aws s3 expects timestamps to be correct with a tolerance of 15 minutes. Does remote_file have a retry ?
[2014-01-15 10:01:35 -0500] Cope: kisoku: ohai!
[2014-01-15 10:03:08 -0500] brucelee: can anyone explain to me how to branching works when downloading cookbooks from opscode using knife
[2014-01-15 10:03:19 -0500] brucelee: i heard it automatically downloads them to a vendor branch
[2014-01-15 10:03:33 -0500] brucelee: and commits the cookbooks there
[2014-01-15 10:04:00 -0500] brucelee: so whats the point of doing this
[2014-01-15 10:05:54 -0500] brucelee: or does it download a copy to the master branch
[2014-01-15 10:06:04 -0500] brucelee: and then branches off to vendor
[2014-01-15 10:06:09 -0500] brucelee: and commits to vendor as well
[2014-01-15 10:06:25 -0500] brucelee: so now theres two branches that point to the cookbook?
[2014-01-15 10:33:15 -0500] kisoku: Cope: ohai2u
[2014-01-15 10:47:08 -0500] Junaid_: Is it possible to add default and override attributes through chef?
[2014-01-15 10:47:16 -0500] Junaid_: sorry though nodes
[2014-01-15 10:48:09 -0500] dsa: Junaid_: yes. -> knife node edit
[2014-01-15 10:51:56 -0500] ekarlso: I /win 38
[2014-01-15 10:54:11 -0500] Junaid_: <dsa>. When ever I did my role and add override or any other attributes to it and save and exit. The changes are not being made in the node file.
[2014-01-15 10:55:06 -0500] Junaid_: When ever I edit my node and add override or any other attributes to it and save and exit. The changes are not being made in the node file.
[2014-01-15 10:55:11 -0500] Junaid_: Any ideas?
[2014-01-15 10:57:36 -0500] workmad3: Junaid_: how are you editing the node?
[2014-01-15 10:57:57 -0500] Junaid_: knife node edit nodename
[2014-01-15 10:58:19 -0500] workmad3: Junaid_: yeah, that edits the node on the server, not any local copies
[2014-01-15 10:59:11 -0500] workmad3: Junaid_: you'd really want the command 'knife node edit nodename && knife node show -fj nodename > path/to/node.json'
[2014-01-15 10:59:14 -0500] dsa: Junaid_: file ?
[2014-01-15 10:59:34 -0500] dsa: Junaid_: they get directly actuallized inside of the chef server
[2014-01-15 10:59:38 -0500] dsa: Junaid_: the file is ontouched
[2014-01-15 10:59:56 -0500] Junaid_: Yes. And say I edited the file and saved it. When I run knife node edit nodename again. it doesnt show my changes.
[2014-01-15 11:00:02 -0500] workmad3: Junaid_: or you edit the node json file you have in your chef-repo, and do 'knife node from file path/to/node.json' after editing it to upload changes
[2014-01-15 11:00:15 -0500] dsa: Junaid_: workmad3 posted the right answer
[2014-01-15 11:00:40 -0500] dsa: Junaid_: knife node edit -> edits directly inside of the chef server.... you could say
[2014-01-15 11:01:46 -0500] Junaid_: okay. So in that case, if I just make my changes in the nodes/nodename.json and then do a knife node from file ../pathtonodename.json that should do it right?
[2014-01-15 11:02:27 -0500] workmad3: Junaid_: that's one way, yes
[2014-01-15 11:02:42 -0500] workmad3: Junaid_: bear in mind that too much specialisation of individual nodes isn't good
[2014-01-15 11:03:15 -0500] Junaid_: Okay. That seems simpler to me. Im gonna give that a try.
[2014-01-15 11:03:36 -0500] Junaid_: Yeah I guess so. But this is more of a test I'm doing to check the preferences
[2014-01-15 11:04:07 -0500] Junaid_: of attributes. Im going to be passing most of my attributes through roles. and I want to check for nodes just incase there is a special case.
[2014-01-15 11:08:24 -0500] dsa: Junaid_: like workmad3 sayed. for testing you can do - but a good advice is to not keep this inside of roles or node attributes. keep important flags attritubes inside of you cookbook.
[2014-01-15 11:08:37 -0500] dsa: your
[2014-01-15 11:13:48 -0500] gyre007: can I use / refer to tags in ATRRIBUTES file ?
[2014-01-15 11:17:47 -0500] zeroXten: anyone recommand a chef rails cookbook/tutorial? Something that sort of works out of the box with minimal fuss?
[2014-01-15 11:24:48 -0500] dsa: zeroXten: google is your friend -> http://www.concreteinteractive.com/how-to-deploy-a-rails-application-anywhere-with-chef/
[2014-01-15 11:25:24 -0500] dsa: gyre007: not really. the search doesnt work inside of attribute files... ASFAIK
[2014-01-15 11:25:48 -0500] kes89newbee1: Hi All
[2014-01-15 11:26:12 -0500] kes89newbee1: I was checking out the git recipe
[2014-01-15 11:26:25 -0500] kes89newbee1: and found that action sync keeps on pulling new commits
[2014-01-15 11:26:39 -0500] workmad3: kes89newbee1: yes, that's what 'sync' means
[2014-01-15 11:26:42 -0500] kes89newbee1: but is there any way to stop it?
[2014-01-15 11:26:44 -0500] workmad3: kes89newbee1: keeps it in sync
[2014-01-15 11:26:59 -0500] kes89newbee1: What i need is when I bootstrap a server with a git repo
[2014-01-15 11:27:13 -0500] workmad3: kes89newbee1: http://docs.opscode.com/resource_git.html check the actions there
[2014-01-15 11:27:14 -0500] kes89newbee1: it should be with that repo only
[2014-01-15 11:28:40 -0500] workmad3: kes89newbee1: you can also specify a revision or other git reference for a git resource to check out (e.g. you could have a git bootstrap repo that has a separate branch for each server that gets checked out)
[2014-01-15 11:30:32 -0500] kes89newbee1: Ah
[2014-01-15 11:30:37 -0500] kes89newbee1: I think that can be done
[2014-01-15 11:30:46 -0500] kes89newbee1: @workmad3 Thanks
[2014-01-15 11:35:09 -0500] zxd: is there a cookbook for editing user's .bashrc and running git clone ?
[2014-01-15 11:36:42 -0500] zxd: ah there is
[2014-01-15 11:36:48 -0500] zxd: but for git clone?
[2014-01-15 12:02:52 -0500] dsa: zxd: http://docs.opscode.com/resource_git.html
[2014-01-15 12:03:25 -0500] zxd:  depends cookbook  , in metadata dosen't load anycode in the wrapper cookbook correct?
[2014-01-15 12:03:44 -0500] zxd: to the wrapper's cookbook
[2014-01-15 12:05:31 -0500] zxd: attribute :login,       :kind_of => String, :name_attribute => true
[2014-01-15 12:05:37 -0500] zxd: what does name_attribute mean?
[2014-01-15 12:05:42 -0500] zxd: dsa: thanks
[2014-01-15 12:07:37 -0500] Junaid_: I'm having a strange problem. In my node if I add attribute values under the normal tag it works. But If i add my attributes under the default attributes inside the node file. It doesnt work.
[2014-01-15 12:10:04 -0500] Junaid_: http://pastebin.com/nMtnUhNY - Thats my node file with default attributes
[2014-01-15 12:11:40 -0500] Junaid_: http://pastebin.com/ghqsA6kV - Thats my node file with normal attributes
[2014-01-15 12:12:18 -0500] Junaid_: When I put in my normal attributes the file gets saved and show the content. If I edit that same node with default attribute it doesnt work.
[2014-01-15 12:15:52 -0500] railsraider: Junaid_: 1) there are no normal attributes for role
[2014-01-15 12:16:11 -0500] railsraider: 2) dont use normal attributes use oveerride_attributes or default
[2014-01-15 12:16:23 -0500] railsraider: normal is saved on the node no matter what
[2014-01-15 12:16:30 -0500] railsraider: default get reset every run
[2014-01-15 12:16:53 -0500] railsraider: override will be in higher priority
[2014-01-15 12:17:21 -0500] railsraider: and theres no need se defaulkt environment as its is the default
[2014-01-15 12:20:04 -0500] Carcass: Hi guys!
[2014-01-15 12:27:05 -0500] Carcass: I have a strange problem with chef.   Chef client freezes and I get a timeout error. After run client with -l debug I saw problem on API request "POST /environments/_default/cookbook_versions HTTP/1.1" 504.  Who experienced this?
[2014-01-15 12:29:24 -0500] Junaid_: railsraider, Its strange. Only when I have my syntax with the normal bit in it the node file is getting saved. Otherwise its not.
[2014-01-15 12:32:05 -0500] railsraider: Junaid_: use override_attributes
[2014-01-15 12:37:30 -0500] Junaid_: <railsraider>, No luck with override attributes.
[2014-01-15 12:37:39 -0500] Junaid_: Ill show you my file
[2014-01-15 12:38:05 -0500] railsraider: try shef -z
[2014-01-15 12:38:22 -0500] railsraider: and make sure you set the node to run the role
[2014-01-15 12:39:37 -0500] Junaid_: http://pastebin.com/kH5sh0ek
[2014-01-15 12:40:09 -0500] Junaid_: Thats what I have.
[2014-01-15 12:41:08 -0500] Junaid_: Basically I have some default attributes in my recipe, some in my role. Now I want my node to be able to override the attributes of both the recipe and the role that its assigned to and just use the values I have specified in the node.
[2014-01-15 12:42:02 -0500] railsraider: Junaid_: default_attributes should not be a hash
[2014-01-15 12:42:23 -0500] railsraider: its like a method default_attributes( )
[2014-01-15 12:42:43 -0500] railsraider: so dont put all the hash inside another  hash
[2014-01-15 12:43:47 -0500] railsraider: are you showing me the json output or the role itself
[2014-01-15 12:43:48 -0500] railsraider: ?
[2014-01-15 12:43:56 -0500] railsraider: show me the role
[2014-01-15 12:43:59 -0500] railsraider: the rb file
[2014-01-15 12:45:19 -0500] Junaid_: Im trying to add these values in the node not on the role. On the role the default attributes and override both are working fine.
[2014-01-15 12:45:30 -0500] drrk: win 75
[2014-01-15 12:46:20 -0500] railsraider: thats because node attribute will always be normal if you add them directly on the node
[2014-01-15 12:46:52 -0500] railsraider: you can use override and default which reset on evry run to temp (for the run only) change the node attribute
[2014-01-15 12:47:51 -0500] railsraider: if you want to save the node attribute on the node for good, use attribute file with normal['my_attribute']['yada']['yada']['yada']
[2014-01-15 12:49:37 -0500] Junaid_: Okay. It makes sense now. So say I have a node, a special one that needs some special settings and does not change often. For that I will use a normal value of the node. For every other server I have for which I might make changes I can use my roles.
[2014-01-15 12:49:42 -0500] Junaid_: right?
[2014-01-15 12:50:36 -0500] railsraider: or use attribute file with default
[2014-01-15 12:52:04 -0500] Junaid_: Yes. Got it. Thanks railsraider. Im gonna go on a long vacation after the nagios cookbook is setup:)
[2014-01-15 12:54:08 -0500] zeroXten: dsa: thanks. Not very "out of the box", but will try to get it actually doing something useful
[2014-01-15 13:05:15 -0500] rgsteele: Got a spec file for my Chefspec tests (http://pastie.org/8635566), but I keep running into issues with the 'chef_run' variable.
[2014-01-15 13:06:03 -0500] rgsteele: Specifically, it seems to never be defined.  I also tried setting it outside of the contexts (that's actually what I'd prefer & what I tried first, since I don't actually need to converge twice), but ran into the same problem.
[2014-01-15 13:08:44 -0500] dsa: zeroXten: you should first use the chef guide to learn the basic. after that creating your rails app should be no problem. because its all ruby
[2014-01-15 13:08:51 -0500] rgsteele: When I change 'context' to 'it', it works.
[2014-01-15 13:09:35 -0500] rgsteele: I have no idea why...
[2014-01-15 13:14:37 -0500] zeroXten: dsa: I'm pretty familiar with chef, i'm much better at chef than I am at rails.. getting a rails app running locally is really easy, but making it work properly in prod seems to be a bit harder
[2014-01-15 13:14:46 -0500] zeroXten: compared to say, dropping a war file
[2014-01-15 13:36:02 -0500] isbaran: hello, can anyone confirm that command line arguments to knife override settings in knife.rb ? I'm seeing weird behaviour ( using 11.8.2 )
[2014-01-15 14:04:53 -0500] ocholetras: hi guys!
[2014-01-15 14:05:16 -0500] ocholetras: knife search 'environment:staging' should return nodes with "ha_staging" environment?
[2014-01-15 14:05:28 -0500] ocholetras: i mean, search is exact matching, right?
[2014-01-15 14:07:41 -0500] zxd: it isn't clear from bash resource , if I have code attribute what happens to the name "name is the name of the resource block; when the command attribute is not specified as part of a recipe, name is also the name of the command to be executed"
[2014-01-15 14:07:52 -0500] zxd: I only need to execute what's under code
[2014-01-15 14:07:57 -0500] zxd: attribute...
[2014-01-15 14:17:11 -0500] zxd: how do I write to a file using a specific user inside a recipe ?
[2014-01-15 14:19:46 -0500] CPS: zxd: http://docs.opscode.com/resource_file.html
[2014-01-15 14:23:36 -0500] zxd: CPS: does it append to a file or overwrite?
[2014-01-15 14:23:42 -0500] zxd: CPS: is there an append option?
[2014-01-15 14:24:09 -0500] zxd: want to check for a string in a file if it isn't there to append something
[2014-01-15 14:25:00 -0500] CPS: see if http://stackoverflow.com/questions/16879469/using-a-chef-recipe-to-append-multiple-lines-to-a-config-file helps
[2014-01-15 14:51:53 -0500] zxd: hmm
[2014-01-15 14:51:57 -0500] zxd: I found Chef::Util::FileEdit  CPS
[2014-01-15 14:52:06 -0500] zxd: insert_line_if_no_match
[2014-01-15 14:52:13 -0500] zxd: question is how do I run this as a specific user
[2014-01-15 14:52:20 -0500] zxd: so the file has right permissions
[2014-01-15 14:52:45 -0500] CPS: can you not use the file resource user and mode options?
[2014-01-15 14:53:06 -0500] bbssysop: hello! i have a question about the gui ruby: http://paste.ubuntu.com/6756519/ which is /opt/chef-server/embedded/service/chef-server-webui/app/views/nodes/index.html.haml. (I would like to put a 'lol.jpg' next to any node that has 'detroit' in the text)
[2014-01-15 14:53:14 -0500] bbssysop: and ideas how to modify that ruby to do so?
[2014-01-15 14:56:06 -0500] aujt74: With test-kitchen and busser-bats, is it possible to refer to cookbook/node attributes? I need to check that a log file has been created at a path. the log wasn't directly created by Chef, the location was configured in a config file for an apache module via node attribute. trying to write a bats test, without hard coding a path, to verify that the module is working as intended
[2014-01-15 14:57:36 -0500] broconne: auj74: AFAIK, sadly, it is not possible.
[2014-01-15 14:58:16 -0500] broconne: generally, in those situations.. I test the "default" path.
[2014-01-15 14:58:41 -0500] broconne: apparently, generally, I also use quotes for no reason in irc.
[2014-01-15 14:59:32 -0500] aujt74: broconne: Thanks, fair enough. Do any of the bussers support that?
[2014-01-15 15:00:19 -0500] broconne: not as far as I know.  The node object does not seem to get exposed to them..  someone else might know better.. but I have not seen it anywhere in my travels.
[2014-01-15 15:01:10 -0500] aujt74: My issue is that the default path differs on different platforms, the attributes platform_family switch, and I override the path anyway in my own use of the cookbook in question.
[2014-01-15 15:03:30 -0500] aujt74: it's not a major issue, the successful chef run is a reasonable indicator of success. would just have liked a simple cross-platform way via a test-kitchen test that everything was actually successful.
[2014-01-15 15:04:11 -0500] aujt74: broconne: thanks anyway, thought as much when I couldn't find anything about the node being exposed to the test run
[2014-01-15 15:05:40 -0500] MrBIOS: Hi folks, I just did an upgrade from Chef Server 11.0.8 to 11.0.10 to address some security vulnerabilities, and now the attributes/values that were previously displaying in the "environment default and override attributes" section of the edit pane in the WebUI is blank
[2014-01-15 15:14:20 -0500] bbssysop: is there a recipe for adding/ensuring a yum repo is present?
[2014-01-15 15:16:46 -0500] zxd: http://pastebin.com/Ts6gGAq4  anyone know why it dosen't read  #{user['home']} variable under  ruby_block  and git ?
[2014-01-15 15:17:05 -0500] broconne: bbssysop.. there is a yum cookbook out there.. did you look at that?
[2014-01-15 15:17:16 -0500] bbssysop: just found it. thank you!
[2014-01-15 15:20:58 -0500] epcim: Hi, what is the best practice to deploy certificates and keys. Do you have custom databas per cookbook. One common. I have multiple environments.
[2014-01-15 15:23:24 -0500] gchristensen: epcim: I use the certificate cookbook
[2014-01-15 15:25:00 -0500] epcim: gchristensen: the opscode or atomic-penguin/cookbook-certificate ?
[2014-01-15 15:25:33 -0500] epcim: gchristensen: sorry.. they are the same :-D
[2014-01-15 15:25:35 -0500] gchristensen: :)
[2014-01-15 15:30:41 -0500] Jamin: Any ideas how I can run a block only_if the node name is equal to xyz
[2014-01-15 15:31:03 -0500] Jamin: eg. only_if { node.chef_environment == "Production" } for machines in production environment
[2014-01-15 15:31:41 -0500] Jamin: how can I run a block if the node name is xyz?
[2014-01-15 15:33:08 -0500] epcim: Jamin: try {node.fqdn}
[2014-01-15 15:34:21 -0500] Jamin: I was hoping it would be something easy
[2014-01-15 15:34:34 -0500] Jamin: is there a man page anywhere that documents these 'attributes'
[2014-01-15 15:39:03 -0500] bbssysop: how do you write this to work in a role?
[2014-01-15 15:39:04 -0500] bbssysop: default_attributes(
[2014-01-15 15:39:04 -0500] bbssysop:   :yum => {
[2014-01-15 15:39:05 -0500] bbssysop:     :epel => {
[2014-01-15 15:39:05 -0500] bbssysop:       :enabled => {
[2014-01-15 15:39:06 -0500] bbssysop:         false
[2014-01-15 15:39:06 -0500] bbssysop:        }
[2014-01-15 15:39:08 -0500] bbssysop:      }
[2014-01-15 15:39:10 -0500] bbssysop:    }
[2014-01-15 15:39:12 -0500] bbssysop:  )
[2014-01-15 15:39:27 -0500] Doc_X: bbyssysop: please use pastebin or some alternative for pasting code :-)
[2014-01-15 15:39:38 -0500] bbssysop: oops! no prob.
[2014-01-15 15:39:55 -0500] bbssysop: http://paste.ubuntu.com/6756763/
[2014-01-15 15:40:01 -0500] bbssysop: that doesnt work in a role
[2014-01-15 15:43:53 -0500] Doc_X: here's a modified version of a role we use: http://paste.ubuntu.com/6756777/
[2014-01-15 15:44:12 -0500] Doc_X: forgot to include the command prompt on the first line.
[2014-01-15 15:44:39 -0500] CPS: bbssysop: roles are json files and I'm not sure => is valid in json
[2014-01-15 15:44:50 -0500] Doc_X: but it's somewhat different syntactically than what you have.... try using that as a guide for what you're trying to do.
[2014-01-15 15:44:59 -0500] bbssysop: right. thats from the official yum-epel dox tho.
[2014-01-15 15:45:07 -0500] bbssysop: https://github.com/opscode-cookbooks/yum-epel
[2014-01-15 15:45:15 -0500] Doc_X: it looks like you're trying to build values in ruby, based on the syntax
[2014-01-15 15:45:18 -0500] bbssysop: "usage example"
[2014-01-15 15:45:27 -0500] bbssysop: i just want to enable epel
[2014-01-15 15:45:29 -0500] bbssysop: thats all.
[2014-01-15 15:45:31 -0500] bbssysop: from a role
[2014-01-15 15:46:06 -0500] CPS: oh, they're using ruby dsl
[2014-01-15 15:46:08 -0500] CPS: http://docs.opscode.com/essentials_roles.html#role-formats
[2014-01-15 15:46:37 -0500] slbmeh: i'm trying to create a recipe that makes use of the application_python cookbook and i'm hitting a NoMethodError for path on DeployRevision
[2014-01-15 15:46:55 -0500] Doc_X: bbssysop: yeah, i'd suggest using JSON over the Ruby DSL, but that's just me.
[2014-01-15 15:49:05 -0500] bbssysop: Doc_X: json is the way to go for me. i edit roles from command line with vim. so thats default.
[2014-01-15 15:59:35 -0500] jslusher: My encrypted data bag keys suddenly don't work in chef-client
[2014-01-15 15:59:49 -0500] jslusher: I can decrypt the data bag using knife
[2014-01-15 16:00:13 -0500] Doc_X: bbssysop: yeah, i'd just drop the JSON into a file, do a 'knife role from file role.json' and add it that way. Ruby DSL, while interesting, is not what i tend to use or what i would suggest.
[2014-01-15 16:00:31 -0500] jslusher: when I apply the file to the server and run chef-client, it gives me the following:
[2014-01-15 16:00:32 -0500] jslusher: ERROR: Error decrypting data bag value: 'bad decrypt'. Most likely the provided key is incorrect
[2014-01-15 16:00:43 -0500] jslusher: I've recreated the key
[2014-01-15 16:00:55 -0500] jslusher: I even used a known working key and renamed it
[2014-01-15 16:01:08 -0500] jslusher: everything fails in chef-client
[2014-01-15 16:01:15 -0500] jslusher: but not using knife
[2014-01-15 16:01:36 -0500] jslusher: the key was created without the newline characters
[2014-01-15 16:01:48 -0500] jslusher: totally stuck now.
[2014-01-15 16:14:10 -0500] zxd: is there an option to git resource to force creating parent directory?  git_user/providers/default.rb line 58) had an error: Chef::Exceptions::MissingParentDirectory: Cannot clone git[/home/deploy/src/git-prompt] to /home/deploy/src/git-prompt, the enclosing directory /home/deploy/src does not exist
[2014-01-15 16:15:10 -0500] workmad3: zxd: no, but there's the directory resource for that
[2014-01-15 16:16:08 -0500] kristianpaul: Hello all
[2014-01-15 16:18:08 -0500] kristianpaul: There is  way to run knife bootstrap without a chef server?
[2014-01-15 16:18:10 -0500] slbmeh: anyone know how i can go about making mercurial a full blown scm provider so it works with the deploy providers?
[2014-01-15 16:18:46 -0500] kristianpaul: Tought -z option may help but dint
[2014-01-15 16:20:31 -0500] slbmeh: kristianpaul: have you looked into chef-zero?
[2014-01-15 16:20:50 -0500] kristianpaul: nope
[2014-01-15 16:21:25 -0500] kristianpaul: Is it upstream?
[2014-01-15 16:22:28 -0500] slbmeh: kristianpaul: https://github.com/opscode/chef-zero it bootstraps a server locally, never tried to use it on the local machine, i use it a lot with vagrant
[2014-01-15 16:23:56 -0500] slbmeh: kristianpaul: knife has settings for chef-zero enabled as well
[2014-01-15 16:24:44 -0500] kristianpaul: let me see
[2014-01-15 16:26:42 -0500] broconne: Is there a good strategy out there for executing something on a remote host as part of a recipe..  For example, this product is a client server product.  As part of the installation, the server needs to authorize the client.. And the rest of the runlist should not execute until the server part is done.. That is the rest of the recipe relies on that server component being complete.
[2014-01-15 16:27:09 -0500] slbmeh: kristianpaul: also, there's a blog post about using chef-client locally http://www.getchef.com/blog/2013/10/31/chef-client-z-from-zero-to-chef-in-8-5-seconds/
[2014-01-15 16:29:07 -0500] jslusher: regarding the data bag decryption posted earlier. if you use "--secret" and not "secret-file" well obviously no matter what file you use to try to decrypt it will work
[2014-01-15 16:32:33 -0500] methods: can I use http auth with Chef::Provider::RemoteFile::Deploy ?
[2014-01-15 16:32:40 -0500] slbmeh: jslusher: do you possibly have a secret set in your knife.rb that isn't letting secret-file work?  not sure on the argument order of precedence there but --secret param will override secret in config
[2014-01-15 16:38:50 -0500] jslusher: slbmeh: secret-file works, I just had it wrong on the command line
[2014-01-15 16:39:19 -0500] jslusher: slbmeh: what made it confusing is that even using '--secret-file' to decrypt it using knife it worked
[2014-01-15 16:39:38 -0500] jslusher: even though I created it using '--secret'
[2014-01-15 16:40:45 -0500] abhishek_: Hi Guys is there any way to set attributes from command line using knife so that if i wants to install particular version of my application rpm on node so i can set it from command line?
[2014-01-15 16:43:09 -0500] CPS: abhishek_: look up documentation on the 'knife node' command
[2014-01-15 16:52:23 -0500] abhishek_: CPS: i did not found something on knife node document where it mention how to set attribute from command line
[2014-01-15 16:52:58 -0500] CPS: http://docs.opscode.com/knife_node.html see examples
[2014-01-15 16:55:31 -0500] masterkorp: hello chefs
[2014-01-15 16:58:49 -0500] juliancdunn: ohai
[2014-01-15 17:00:00 -0500] freezey: antipatterns shmantipatterns
[2014-01-15 17:04:45 -0500] abhishek_: CPC: my question is more like in puppet people can set facts from command line like FACTER_(factname)=value, i did not find something like this in chef while going through doc or google
[2014-01-15 17:04:54 -0500] rgsteele: So, I have an LWRP that creates a template, but chefspec's render_file('/foo/bar').with_content(/^baz$/) only seems to detect a cookbook_file, file, or template resource is declared directly.
[2014-01-15 17:05:54 -0500] workmad3: rgsteele: custom lwrps aren't stepped into with chefspec by default
[2014-01-15 17:06:07 -0500] workmad3: rgsteele: it's all documented in the README on the gh repo for chefspec
[2014-01-15 17:07:32 -0500] rgsteele: Right, I saw that.  So, I tried overriding the RenderFileMatcher (http://pastie.org/8636159), but no such luck.  I think that's because there's more to it than just the find_resource.  Specifically, the methods in lib/chefspec/matchers/render_file_matcher.rb
[2014-01-15 17:07:33 -0500] workmad3: rgsteele: the idea is that you create a resource matcher for your lwrp so you can do 'expect(chef_run).to foo_my_bar_resource("name")' and then unit test lwrps in separate tests that step into one at a time
[2014-01-15 17:07:56 -0500] workmad3: rgsteele: you don't need to override stuff
[2014-01-15 17:08:12 -0500] workmad3: rgsteele: you just need to do your chef run with 'step_into: ["my_custom_resource"]'
[2014-01-15 17:09:15 -0500] rgsteele: workmad3: Well, I did create a ResourceMatcher for the LWRP, but I'm interested in the rendered content.
[2014-01-15 17:09:25 -0500] workmad3: rgsteele: right... so you need to *step into it*
[2014-01-15 17:09:33 -0500] workmad3: rgsteele: which the README tells you
[2014-01-15 17:09:57 -0500] workmad3: rgsteele: as it stands, the action for the custom LWRP isn't executed... at all
[2014-01-15 17:10:52 -0500] rgsteele: workmad3: Well, I didn't want to step into it from another cookbook, since the README warns against doing it.
[2014-01-15 17:11:05 -0500] workmad3: rgsteele: yes, because it's a bad idea
[2014-01-15 17:11:21 -0500] workmad3: rgsteele: you should test the LWRP in isolation to verify that it works correctly then trust that in other cookbooks
[2014-01-15 17:11:46 -0500] rgsteele: workmad3: Yeah, I guess that's true.
[2014-01-15 17:11:47 -0500] workmad3: rgsteele: but if you want to test the actual behaviour of a custom LWRP from another cookbook, you need to step into it
[2014-01-15 17:12:12 -0500] workmad3: rgsteele: otherwise, nothing inside that lwrp action is run, so there's no resources to do anything with
[2014-01-15 17:13:33 -0500] rgsteele: workmad3: Yeah, I guess I didn't read that section of the README carefully enough.  I'll give stepping into the LWRP a shot.
[2014-01-15 17:13:39 -0500] rgsteele: thanks
[2014-01-15 17:18:55 -0500] rgsteele: workmad3: Did exactly what I was looking for.  Thanks again.
[2014-01-15 18:00:59 -0500] kristianpaul: Thanks slyness
[2014-01-15 18:01:51 -0500] slyness: kristianpaul hi. what's that?
[2014-01-15 18:03:08 -0500] kristianpaul: oh sorry
[2014-01-15 18:03:10 -0500] fede_: Hi, could I get help starting a ruby script as a chef service?
[2014-01-15 18:03:17 -0500] aujt74: broconne: came up with a solution to my issue with cross-platform differences in paths for tests with test-kitchen. as you suggested, I'm testing the default path but I've created two suites, one for debian & rhel derivatives. Excluding the rhel platforms from the debian suite and vice versa. best I could come up with!
[2014-01-15 18:03:21 -0500] kristianpaul: i meant slbmeh
[2014-01-15 18:03:29 -0500] kristianpaul: but he left already
[2014-01-15 18:04:05 -0500] fede_: I haven't been able to run it in the correct ruby environment
[2014-01-15 18:04:08 -0500] slyness: kristianpaul no worries. good morning.
[2014-01-15 18:04:18 -0500] broconne: aujt74:  good solution
[2014-01-15 18:04:27 -0500] kristianpaul: slyness: morning dude
[2014-01-15 18:05:35 -0500] masterkorp: Guys there a way to check if an attribute is set ? on the recipe ?
[2014-01-15 18:05:39 -0500] aujt74: thanks for cleaning it up for me broconne, was sure there must be a way to solve it and you pointed me in the right direction!
[2014-01-15 18:06:14 -0500] aujt74: *clearing
[2014-01-15 18:06:30 -0500] masterkorp: node.attribute?("ec2") ?
[2014-01-15 18:06:58 -0500] masterkorp: but what about ["one"]["two"]["tree"] attributes ?
[2014-01-15 18:07:32 -0500] Vitor: Is possible run notifies execute from another cookbook?
[2014-01-15 18:08:31 -0500] Vitor: I have a cookbook jboss that when finish restart jboss, but I have another cookbook jbpm tha need to use an execute command with jboss service manipulation, the problem is jboss is restarting.
[2014-01-15 18:10:23 -0500] dynomist: can someone tell me if I should be forking the chef cookbooks and maintaining changes in the fork (rebasing periodically) or should I be using custom recipes instead? I have been trying to avoid editing cookbooks but lately I'm getting the feeling I should be maintaining a fork...
[2014-01-15 18:10:57 -0500] masterkorp:          5>>   only_if node.attribute?(["taskwarrior"]["server"]["organization"])
[2014-01-15 18:11:00 -0500] masterkorp: using this
[2014-01-15 18:11:07 -0500] masterkorp: [2014-01-15T18:10:37+00:00] ERROR: can't convert String into Integer
[2014-01-15 18:11:09 -0500] masterkorp: i get this
[2014-01-15 18:11:12 -0500] masterkorp: any ideas
[2014-01-15 18:11:22 -0500] Marcs_1: hello all, I am using a self hosted chef-server, I am trying to setup a user on the client, I am using the users cookbook. I have created the databag users with the remote user and all its info. and added a users_manage block to my cookbook, yet no users are being created. any one know how I cna force the actual user creation?
[2014-01-15 18:12:13 -0500] dynomist: masterkorp: what about node.attribute?(["taskwarrior"]) && node.attribute?(["taskwarrior"]["server"]) && node.attribute?(["taskwarrior"]["server"]["organization"]) ?
[2014-01-15 18:12:35 -0500] dynomist: not sure if that is going to work - my ruby is not great
[2014-01-15 18:14:14 -0500] masterkorp: gchristensen: hmm, i just want to check the final one
[2014-01-15 18:14:21 -0500] masterkorp: the others exist for sure
[2014-01-15 18:15:10 -0500] dynomist: "for sure" - how do you know if you don't check them
[2014-01-15 18:17:04 -0500] masterkorp: dynomist: because i set them as default attributes ?
[2014-01-15 18:17:27 -0500] dynomist: just sayin something is broken...
[2014-01-15 18:17:46 -0500] masterkorp: i am pretty sure i am using the wrong syntax
[2014-01-15 18:18:29 -0500] masterkorp: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2014-01-15 18:18:37 -0500] masterkorp: on the bottom of the page
[2014-01-15 18:18:41 -0500] dynomist: i'd probably clone one of the opscode cookbooks and search for how they do it
[2014-01-15 18:20:15 -0500] masterkorp: hmm, do you know a cookbook that uses that function ?
[2014-01-15 18:21:24 -0500] dynomist: trial and error
[2014-01-15 18:21:32 -0500] dynomist: get one of the big cookbooks
[2014-01-15 18:26:17 -0500] masterkorp: https://github.com/search?q=node.attribute%3F&source=cc&type=Code
[2014-01-15 18:26:21 -0500] masterkorp: found it
[2014-01-15 18:26:29 -0500] masterkorp: thank god github search
[2014-01-15 18:27:09 -0500] allaire: is php-fpm support coming soon in the php official cookbook?
[2014-01-15 18:27:23 -0500] Vitor: Is it possible: run notifies execute from another cookbook or wait a service start to run another execute command?
[2014-01-15 18:29:07 -0500] broconne: Vitor - what exactly are you asking?
[2014-01-15 18:29:22 -0500] broconne: from the same node?
[2014-01-15 18:30:35 -0500] Vitor: broconne: I have a cookbook jboss that restart jboss when finished and after I have a cookbook jbpm that want call a jboss service (jboss-cli) ... Its fail beacause jboss is restarting.
[2014-01-15 18:31:02 -0500] broconne: ah, the restart hasn't completed...
[2014-01-15 18:31:34 -0500] Vitor: yes :S
[2014-01-15 18:32:58 -0500] broconne: I don't have a good situation that doesn't involve putting a sleep in an execute block...
[2014-01-15 18:33:05 -0500] broconne: and that sounds like a horrible solution
[2014-01-15 18:33:33 -0500] broconne: might be better doing a retry on your jboss-cli call?
[2014-01-15 18:33:50 -0500] broconne: could do retry_delay and retries?
[2014-01-15 18:33:54 -0500] broconne: probably a better oslution.
[2014-01-15 18:34:11 -0500] broconne: would that work in your situation?
[2014-01-15 18:37:05 -0500] Vitor: but, is retry_delay is available in execute resource
[2014-01-15 18:37:08 -0500] Vitor: ?
[2014-01-15 18:37:17 -0500] broconne: retry_delay is available in all resources
[2014-01-15 18:37:29 -0500] broconne: http://docs.opscode.com/chef/resources.html
[2014-01-15 18:37:51 -0500] Vitor:  wow .. good news... my fault .. i will try this
[2014-01-15 18:38:14 -0500] Vitor: thanks
[2014-01-15 18:38:21 -0500] broconne: np
[2014-01-15 18:57:08 -0500] sbrink: hello
[2014-01-15 18:57:20 -0500] sbrink: has anybody else encountered this?
[2014-01-15 18:57:31 -0500] sbrink: ERROR: Chef::EncryptedDataBagItem::UnacceptableEncryptedDataBagItemFormat: The encrypted data bag item has format version `'
[2014-01-15 18:58:15 -0500] sbrink: @jtimberman or @coderanger can either of you help me on this?
[2014-01-15 19:01:34 -0500] CPS: sbrink: paste the output to gist.github.com
[2014-01-15 19:02:03 -0500] shlant1: has this been fixed?
[2014-01-15 19:02:03 -0500] shlant1: https://tickets.opscode.com/browse/CHEF-3740
[2014-01-15 19:02:58 -0500] shlant1: or do I need to separate out the bash into resources for notifies to work correctly?
[2014-01-15 19:03:15 -0500] sbrink: https://gist.github.com/anonymous/8442222
[2014-01-15 19:05:16 -0500] CPS: sbrink: you're missing knife options if you're working with an encrypted data bag http://docs.opscode.com/knife_data_bag.html
[2014-01-15 19:05:32 -0500] CPS: --secret or --secret-file
[2014-01-15 19:06:00 -0500] sbrink: CPS that info is stored in my knife.rb file
[2014-01-15 19:06:02 -0500] Marcs_1: anyone know how to use the users cookbook to create users incorporating the databag?
[2014-01-15 19:08:22 -0500] CPS: dunno then
[2014-01-15 19:08:45 -0500] CPS: looks like you don't have a version number set but it's looking for one
[2014-01-15 19:11:16 -0500] sbrink: CPS yup yup the version wasn't in my knife or client rb and now after an upgrade of the chef gem to 11.8.2 i start getting this error
[2014-01-15 19:11:30 -0500] sbrink: @jtimberman or @coderanger can either of you help me on this?
[2014-01-15 19:11:37 -0500] sbrink: https://gist.github.com/anonymous/8442222
[2014-01-15 19:12:16 -0500] CPS: http://docs.opscode.com/breaking_changes_chef_11.html
[2014-01-15 19:12:35 -0500] CPS: there were some changes in data bag encryption from 10 to 11, maybe it's that?
[2014-01-15 19:14:01 -0500] sbrink: CPS thank you i did see those breaking changes, i created the data bag with ... 11.2 or 11.6 and am now at 11.8.2
[2014-01-15 19:14:24 -0500] sbrink: i have tried all combinations of 0, 1, 2 in both my knife.rb and my client.rb
[2014-01-15 19:15:20 -0500] ddyke: Good afternoon. I am having an issue when my client is resolving cookbook run lists; that call is timing out from the chef-server. The clinet can communicate to the chef server becauise I see the client/node being created after bootstrap
[2014-01-15 19:15:29 -0500] ddyke: What would cause the resolving runlist call to time out?
[2014-01-15 19:17:40 -0500] kaimi: ddyke, im experiencing a similar issue. erchef on the server spikes to 100% cpu, logs say connection to rabbit is refused. chef-client gets no response and runs into a timeout.
[2014-01-15 19:19:12 -0500] sbrink: ddyke: there is a known issue with depresolver that is fixed in ... 11.8 or so
[2014-01-15 19:20:01 -0500] sbrink: ddyke: we ran in to this as well
[2014-01-15 19:20:03 -0500] sbrink: 2 ways
[2014-01-15 19:20:16 -0500] sbrink: we are pinning versions in our environment file with a =
[2014-01-15 19:20:34 -0500] ddyke: sbrink: is this fixed on chef-server 11.8?
[2014-01-15 19:20:35 -0500] sbrink: 1) we deleted some cookbooks from the kitchen and that killed it
[2014-01-15 19:20:53 -0500] ddyke: yeah, it all started when i deleted all cookbook version for this particular cookbook
[2014-01-15 19:21:07 -0500] sbrink: 2) we have a = pinned in environment and a recipe require of a ~
[2014-01-15 19:21:26 -0500] sbrink: we fixed 1 by putting a dummy recipe and version back in to the kitchen
[2014-01-15 19:21:36 -0500] sbrink: you still have to bounce chef server
[2014-01-15 19:22:45 -0500] sbrink: we fixed 2 by removing the ~ pin and either changing to = pin in recipe require and or removing the recipe require entirely
[2014-01-15 19:22:49 -0500] ddyke: I see, I just logged into the chef server and i see beam.smp using 100% cpu
[2014-01-15 19:22:59 -0500] sbrink: either which way ... you have to bounce
[2014-01-15 19:23:17 -0500] ddyke: I already put a dummp cookbook up there, going to try and bounce the chef-server now
[2014-01-15 19:23:21 -0500] lmickh: is anyone familiar with the diptables cookbook?  I'm getting a fatal message saying that the iptables resource can't be enforced since diptables doesn't run afterwards.  Not exactly sure how to fix it.
[2014-01-15 19:28:08 -0500] ddyke: qq sorry never bounced the chef-server service before
[2014-01-15 19:28:13 -0500] ddyke: does it have to be ran as the chef_server user?
[2014-01-15 19:29:00 -0500] AndHeiberg_: Error: Your private key could not be loaded from /etc/chef/client.pem
[2014-01-15 19:29:16 -0500] AndHeiberg_: Why would I need that if I'm only using it without server
[2014-01-15 19:31:01 -0500] savant: is there a merge window today?
[2014-01-15 19:32:59 -0500] teukka: AndHeiberg_: something is trying to use a server api. normally a search or node.save in a cookbook. or you're trying to use environments on an old chef version which doesn't support it
[2014-01-15 19:34:04 -0500] AndHeiberg_: teukka: okay... so one cannot download cookbooks with knife without a privatekey?
[2014-01-15 19:34:51 -0500] teukka: not from a chef server =)
[2014-01-15 19:35:25 -0500] AndHeiberg_: but I don't want a chef server? can't I just use knife solo?
[2014-01-15 19:35:46 -0500] ddyke: sbrink: i have bounced the services, but still no dice :-/
[2014-01-15 19:35:50 -0500] AndHeiberg_: I've been downloading them my self and it worked until it didn't :)
[2014-01-15 19:36:39 -0500] kaimi: AndHeiberg_, `knife cookbook download`  `knife cookbook site download`? (just a guess)
[2014-01-15 19:36:45 -0500] teukka: AndHeiberg_: what command?
[2014-01-15 19:37:11 -0500] teukka: AndHeiberg_: and I would recommend using berkshelf or librarian-chef to manage cookbooks
[2014-01-15 19:37:16 -0500] teukka: knife solo supports both
[2014-01-15 19:37:47 -0500] AndHeiberg_: but I thought I was using knife solo... what is the command to download a cookbook with knife solo?
[2014-01-15 19:38:22 -0500] teukka: AndHeiberg_: download from where?
[2014-01-15 19:38:46 -0500] AndHeiberg_: isn't there a repository for cookbooks?
[2014-01-15 19:38:49 -0500] teukka: knife solo *uploads* the cookbooks from your workstation to the node. automatically
[2014-01-15 19:39:19 -0500] AndHeiberg_: like instead of going to github download the cookbook and place it in cookbooks
[2014-01-15 19:39:19 -0500] teukka: AndHeiberg_: I guess you mean the community site. that is `knife cookbook site download` as kaimi said
[2014-01-15 19:39:28 -0500] AndHeiberg_: okay
[2014-01-15 19:39:43 -0500] AndHeiberg_: what is the difference between knife cookbook download and ... site download?
[2014-01-15 19:39:58 -0500] teukka: AndHeiberg_: the first one downloads from your chef server
[2014-01-15 19:40:05 -0500] AndHeiberg_: ahh okay
[2014-01-15 19:40:19 -0500] AndHeiberg_: Really liking chef so far
[2014-01-15 19:40:24 -0500] AndHeiberg_: other that that hole problem
[2014-01-15 19:41:26 -0500] teukka: AndHeiberg_: but anyway, instead of downloading and managing the cookbooks manually, you might be much happier with berkshelf of librarian-chef
[2014-01-15 19:42:00 -0500] teukka: then you just specify the wanted cookbooks and knife solo fetches them automatically before cooking
[2014-01-15 19:42:45 -0500] AndHeiberg_: okay will look into it
[2014-01-15 19:44:18 -0500] AndHeiberg_: teukka: seams really weird that something like that isn't build into chef
[2014-01-15 19:44:40 -0500] teukka: not yet =)
[2014-01-15 19:45:14 -0500] AndHeiberg_: I'm just used to using composer which is so good at this stuff
[2014-01-15 19:48:12 -0500] ddyke: i broke it
[2014-01-15 19:49:13 -0500] shlant1: can someone confirm that using 'notifies :restart' means that it restarts the service only at the end and only once?
[2014-01-15 19:49:28 -0500] shlant1: does that mean once as in for all notifies?
[2014-01-15 19:49:41 -0500] shlant1: cause I am getting 2 apache2 restarts from apache2::default alone
[2014-01-15 19:50:04 -0500] shlant1: and one from a custom cookbook
[2014-01-15 19:50:15 -0500] ddyke: kaimi: was the issue isolated to a specific cookbook? or across all nodes on the chef-server
[2014-01-15 19:50:27 -0500] ddyke: Ijust tested with a separate node and I am able to resolve run list and go
[2014-01-15 19:53:31 -0500] CPS: can i specify override attributes in a node? use knife node edit to add override attributes to a node?
[2014-01-15 19:55:01 -0500] shlant1: CPS: http://stackoverflow.com/questions/19021289/how-can-i-edit-a-chef-attribute-of-an-ec2-node-using-knife
[2014-01-15 20:01:43 -0500] AndHeiberg_: teukka: how can I make librarian-chef install backages from a github repo?
[2014-01-15 20:02:01 -0500] AndHeiberg_: cause using :git => 'repo' doesn't work
[2014-01-15 20:08:03 -0500] CPS: shlant1: that's not super helpful. I'm trying to find a way to have a common attribute name with a different value for each node. The environment defines the default version number, but our dev nodes might all be using different versions, for example
[2014-01-15 20:09:53 -0500] bbssysop: hi all. can someone point me to an step-by-step howto for creating an ohai plugin that greps an ip, and turns that ip into a usable variable?
[2014-01-15 20:10:07 -0500] bbssysop: or something similar that i can hack.
[2014-01-15 20:10:08 -0500] ddyke: now i asee somethin weird.
[2014-01-15 20:10:37 -0500] shlant1: CPS: and you want to automate the assigning of version numbers?
[2014-01-15 20:10:54 -0500] CPS: no, i'd like developers to be able to set their own
[2014-01-15 20:11:05 -0500] ddyke: cookbook foo has version 1.0.2 1.0.1 and 1.0.0 on the chef server. I removed all pins in the metadata (that fixed the timeout:: thank you sbrink) but when the cookbook syncs now it is only pulling 1.0.0; shouldn't it pull the latest version on the chef server?
[2014-01-15 20:11:24 -0500] CPS: either with knife or the web ui
[2014-01-15 20:14:00 -0500] shlant1: CPS: something like this? https://github.com/amian84/knife-set-attribute
[2014-01-15 20:14:15 -0500] teukka: AndHeiberg_: it should. cookbook "foo", git: "https://github.com/bar/foo"
[2014-01-15 20:14:25 -0500] teukka: AndHeiberg_: even the readme has those examples: https://github.com/applicationsonline/librarian-chef
[2014-01-15 20:14:32 -0500] shlant1: CPS: are you looking to change a bunch of nodes at once?
[2014-01-15 20:15:27 -0500] AndHeiberg_: teukka: I was using it correctly... but I had an extra comment in another line
[2014-01-15 20:16:06 -0500] CPS: shlant1: no, i'd like the developers to be able to change their own node
[2014-01-15 20:16:26 -0500] CPS: whenever they want
[2014-01-15 20:16:33 -0500] CPS: that plugin might work
[2014-01-15 20:16:36 -0500] bbssysop: do ohai plugins go into the ohai cookbook repo?
[2014-01-15 20:16:54 -0500] bbssysop: or do you push them to the client first?
[2014-01-15 20:20:21 -0500] bbssysop: in a template, is there a way to say "If adapater eth0:1, or bond0:1 exists, then use that IP, else, use ipaddress"?
[2014-01-15 20:20:48 -0500] AndHeiberg_: teukka: sorry to bug you again... have you seen this before?
[2014-01-15 20:20:49 -0500] AndHeiberg_: undefined local variable or method `use_inline_resources'
[2014-01-15 20:21:17 -0500] juliancdunn: bbssysop: you can use conditionals in your templates
[2014-01-15 20:21:41 -0500] bbssysop: that would be <%= %> correct
[2014-01-15 20:21:42 -0500] bbssysop: ?
[2014-01-15 20:22:01 -0500] juliancdunn: bbssysop: no, <% if node['something']['whatever'] -%>
[2014-01-15 20:22:11 -0500] teukka: AndHeiberg_: yep. too old chef version. that came in chef 11 I think
[2014-01-15 20:22:12 -0500] bbssysop: cool. thank you.
[2014-01-15 20:22:27 -0500] bbssysop: but -- what is the ruby equivalent of 'isset'?
[2014-01-15 20:22:29 -0500] AndHeiberg_: teukka: Chef: 11.8.2
[2014-01-15 20:22:40 -0500] teukka: AndHeiberg_: on the node?
[2014-01-15 20:22:48 -0500] bbssysop: juliancdunn: "if bond:01 is not empty, then blah, else blah"
[2014-01-15 20:23:08 -0500] AndHeiberg_: by node you mean?
[2014-01-15 20:23:29 -0500] teukka: AndHeiberg_: the server. where you are actually running the chef
[2014-01-15 20:23:33 -0500] juliancdunn: bbssysop: for positive assertions you can just test it directly
[2014-01-15 20:23:48 -0500] juliancdunn: <% if node['network']['interfaces']['bond0'] -%>
[2014-01-15 20:24:17 -0500] AndHeiberg_: Chef: 10.14.2 hmm how do I update it? is there a chef cookbook for that :D
[2014-01-15 20:24:41 -0500] teukka: AndHeiberg_: is that a Vagrant VM?
[2014-01-15 20:24:46 -0500] AndHeiberg_: yes
[2014-01-15 20:24:59 -0500] teukka: AndHeiberg_: then vagrant-omnibus plugin is your friend
[2014-01-15 20:25:15 -0500] teukka: AndHeiberg_: but there is also for example omnibus_updater cookbook
[2014-01-15 20:25:35 -0500] AndHeiberg_: that would be easier I guess?
[2014-01-15 20:26:18 -0500] teukka: I've been starting to hate that chef version. guess that's a default precise box from vagrantup.com? =)
[2014-01-15 20:27:43 -0500] AndHeiberg_: yes
[2014-01-15 20:27:58 -0500] AndHeiberg_: installing omnibus gives me vagrant errors
[2014-01-15 20:28:12 -0500] AndHeiberg_: arnings:
[2014-01-15 20:28:12 -0500] AndHeiberg_: * Unknown configuration section 'omnibus'. If this section was part of
[2014-01-15 20:28:12 -0500] AndHeiberg_: a Vagrant 1.0.x plugin, note that 1.0.x plugins are incompatible with 1.1+.
[2014-01-15 20:28:44 -0500] teukka: vagrant plugin install vagrant-omnibus ?
[2014-01-15 20:28:59 -0500] teukka: run with --debug to get the stack trace
[2014-01-15 20:29:18 -0500] AndHeiberg_: yes
[2014-01-15 20:29:37 -0500] AndHeiberg_: it gives that warning when doing vagrant reload afterwards
[2014-01-15 20:29:48 -0500] AndHeiberg_: also it didn't fix the problem
[2014-01-15 20:30:12 -0500] teukka: that error means that the plugin is not loaded or even installed
[2014-01-15 20:30:23 -0500] teukka: does `vagrant plugin list` have it?
[2014-01-15 20:31:02 -0500] bbssysop: i am having no end of trouble getting this to work. I have removed my horrible code and replaced it with the intention. Could someone point me in the right direction here? http://paste.ubuntu.com/6758239/
[2014-01-15 20:31:22 -0500] bbssysop: ive tried it 20 different ways and gotten nowhere.
[2014-01-15 20:31:51 -0500] AndHeiberg_: yeah it's there vagrant-omnibus (1.2.1) teukka
[2014-01-15 20:32:12 -0500] juliancdunn: bbssysop: I would do that kind of logic in the recipe first, and pass the IP to the template as a variable
[2014-01-15 20:34:42 -0500] teukka: AndHeiberg_: feels like typo/error in Vagrantfile
[2014-01-15 20:35:01 -0500] teukka: AndHeiberg_: could you share it? and/or `vagrant status --debug` output
[2014-01-15 20:35:40 -0500] teukka: AndHeiberg_: we should actually jump into #vagrant :)
[2014-01-15 20:35:46 -0500] bbssysop: juliancdunn: ill try that. ill paste it up in a few minutes. thank you!
[2014-01-15 20:35:54 -0500] AndHeiberg_: https://www.irccloud.com/pastebin/Phg350Gz
[2014-01-15 20:36:17 -0500] AndHeiberg_: teukka: ^^
[2014-01-15 20:37:13 -0500] teukka: AndHeiberg_: ah, your Vagrantfile is in V1 format
[2014-01-15 20:38:05 -0500] teukka: AndHeiberg_: change the first line to `Vagrant.configure("2") do |config|`
[2014-01-15 20:38:30 -0500] teukka: should be compatible otherwise
[2014-01-15 20:39:00 -0500] AndHeiberg_: teukka: what about line 60?
[2014-01-15 20:39:07 -0500] teukka: AndHeiberg_: but networking and shared folder configuration has changed. so if you try to use those check the docs for new keys
[2014-01-15 20:39:29 -0500] AndHeiberg_: okay
[2014-01-15 20:39:59 -0500] teukka: AndHeiberg_: that's an empty block so you could even remove it totally
[2014-01-15 20:40:02 -0500] bbssysop: juliancdunn: ive mocked up the recipe,. but im still at the pseudo-code point : http://paste.ubuntu.com/6758291/
[2014-01-15 20:40:04 -0500] AndHeiberg_: works now I think
[2014-01-15 20:40:07 -0500] ddyke: How can I tell what version of chef-server is running?
[2014-01-15 20:40:31 -0500] bbssysop: juliancdunn: i know logically thats what i want, and in php/bash i can write it. but ruby im unsure.
[2014-01-15 20:40:32 -0500] AndHeiberg_: teukka: well it's commented out, but i'm going to remove the comments
[2014-01-15 20:40:37 -0500] teukka: AndHeiberg_: if you want to add another provisioner you can do it in the one and only `configure` block
[2014-01-15 20:40:53 -0500] teukka: AndHeiberg_: the provisioners are run in the same order that specified
[2014-01-15 20:41:15 -0500] chrisstreeter_: is there a way to run this apt-get block from another cookbook? https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb#L64
[2014-01-15 20:41:31 -0500] teukka: AndHeiberg_: config.vm.provision :shell, inline: "chmod 777 -R /vagrant/app/storage"
[2014-01-15 20:41:33 -0500] juliancdunn: bbssysop: let me write a possible implementation and I'll gist it
[2014-01-15 20:42:21 -0500] bbssysop: juliancdunn: that would be the nicest thing anyone has ever done! tis a horrible feeling being able to write in one language and not another!
[2014-01-15 20:42:22 -0500] CPS: is there a way I can check for the existence of an item in a data bag without throwing an exception? bag[environment][field] may or may not exist and I need to do if/else on that
[2014-01-15 20:42:43 -0500] chrisstreeter_: basically, i want to run an apt-get update only if it hasn't run in the duration time, but from another cookbook
[2014-01-15 20:42:55 -0500] chrisstreeter_: and i wanted to avoid having to copy the whole execute block into my cookbook
[2014-01-15 20:43:30 -0500] teukka: AndHeiberg_: btw, if /vagrant is a synced folder, the chmod command might not do anything. a better option normally is to specify mount options and set perms there
[2014-01-15 20:44:47 -0500] juliancdunn: bbssysop: https://gist.github.com/juliandunn/0ce909579359eab4f120
[2014-01-15 20:45:11 -0500] juliancdunn: obvs you want some better error-handing around getting bond0's ipaddress and where in the data structure it lives, etc. but that should be a good first start
[2014-01-15 20:46:57 -0500] bbssysop: this is wonderful! thanks for helping me out of my mess!
[2014-01-15 20:47:52 -0500] juliancdunn: np
[2014-01-15 20:48:47 -0500] vigith: i have upgraded the chef server from 10 to 11.. but every node is trying to talk to chef server via port 4000 and they are getting connection refused
[2014-01-15 20:49:21 -0500] vigith: how do i solve it? other than updating client.rb in each box
[2014-01-15 20:50:40 -0500] juliancdunn: update the client.rb on each box :-)
[2014-01-15 20:51:05 -0500] juliancdunn: or temporarily set up a proxy to redirect port 4000 to port 80 and use Chef to fix the clients
[2014-01-15 20:54:41 -0500] vigith: juliancdunn: what about iptable routing?
[2014-01-15 20:56:44 -0500] savant: Is there a merge window today?
[2014-01-15 20:57:03 -0500] savant: For opscode-cookbook repositories
[2014-01-15 20:59:47 -0500] juliancdunn: vigith: yeah, whatever's a short term fix till you can update everyone's client.rb
[2014-01-15 21:05:23 -0500] shlant1: anyone know if it's possible to only restart a service once no matter how many times it's notified?
[2014-01-15 21:06:31 -0500] CPS: shlant1: you could use a flag variable
[2014-01-15 21:06:44 -0500] kaimi: ddyke, all nodes. even the client on the chef server itself which basically just pulls some dot files
[2014-01-15 21:07:08 -0500] CPS: if true, set it to false, do thing
[2014-01-15 21:07:39 -0500] ddyke: kaimi: hrmm... This is only being affected by the one cookbook
[2014-01-15 21:07:40 -0500] freezey: .
[2014-01-15 21:07:42 -0500] juliancdunn: shlant1: it will only restart once by default, unless you're using :immediately
[2014-01-15 21:08:18 -0500] ddyke: I am running chefserver 11.0.8-rc.2 going to update it... tired of this
[2014-01-15 21:08:25 -0500] allaire: Anybody can confirm me that the upstart script for the nginx cookbook supports the "reload" command?
[2014-01-15 21:08:32 -0500] shlant1: juliancdunn: that's what I thought, but the apache::default recipe calls apache2 restart twice and the multiple restarts is resulting in downtime
[2014-01-15 21:09:19 -0500] shlant1: I have a total of 3 apache2 restarts at the end: 2 from apache::default and one from custom recipe
[2014-01-15 21:09:21 -0500] Yoteco: Hi! Can somebody tell me the difference between the "bash" and "execute" resource? And which one should be used in which case.
[2014-01-15 21:09:52 -0500] CPS: shlant1: node tags
[2014-01-15 21:09:53 -0500] juliancdunn: shlant1: that's weird. no :immediately anywhere?
[2014-01-15 21:10:29 -0500] shlant1: Yoteco: bash runs as bash, execute can run as other interpreters
[2014-01-15 21:10:46 -0500] juliancdunn: I'd have to see the code specifically, but by design, Chef processes all delayed notifications at the end and uniquifies them
[2014-01-15 21:10:54 -0500] shlant1: juliancdunn: nope, or it would be run in the middle of the run. They are all at the end
[2014-01-15 21:10:55 -0500] mondo: Can someone please briefly explain this behavior:  I have a machine with some roles and I do a vmware snapshot of it.  I then modify its run list and then execute the chef-client.  Later I roll back to my snapshot and run chef-client, and suprisingly the roles on the server have also been rolled back.
[2014-01-15 21:10:59 -0500] Yoteco: shanlar: sounds fair :) Thanks!
[2014-01-15 21:12:01 -0500] shlant1: juliancdunn: in apache::default it's all   notifies :restart, "service[apache2]"
[2014-01-15 21:12:15 -0500] shlant1: maybe I need to update the apache2 cookbook
[2014-01-15 21:12:23 -0500] shlant1: might be a bug
[2014-01-15 21:12:32 -0500] shlant1: but it seems like it's a bug with notifies
[2014-01-15 21:14:11 -0500] Guest1332: so like
[2014-01-15 21:14:29 -0500] Guest1332: i got a ruby/chef::knife::ssh question
[2014-01-15 21:14:52 -0500] Guest1332: i'm able to run a command using the gem/class
[2014-01-15 21:14:58 -0500] shlant1: juliancdunn: I think this is the issue: https://tickets.opscode.com/browse/COOK-3018
[2014-01-15 21:15:04 -0500] shlant1: I need to update
[2014-01-15 21:15:08 -0500] Guest1332: but the log goes to STDOUT
[2014-01-15 21:15:16 -0500] Guest1332: even if i specify a file
[2014-01-15 21:15:31 -0500] Guest1332: knife_ssh = Chef::Knife::Ssh.new()
[2014-01-15 21:15:36 -0500] Guest1332: knife_ssh.config[:log_location] = log_file
[2014-01-15 21:15:49 -0500] juliancdunn: shlant1: good find.
[2014-01-15 21:15:50 -0500] Guest1332: or if i load a config with the log_location set to the file
[2014-01-15 21:15:55 -0500] sbrink: knife ssh starts a pty session so that it is interactive ... that might be an issue
[2014-01-15 21:16:03 -0500] Guest1332: okay
[2014-01-15 21:16:10 -0500] Guest1332: so make it non-interactive?
[2014-01-15 21:16:18 -0500] sbrink: ?good question?
[2014-01-15 21:16:27 -0500] sbrink: i accidentally found that
[2014-01-15 21:16:47 -0500] Guest1332: i want to redirect the output to either a file or variable
[2014-01-15 21:16:48 -0500] sbrink: i'd have to dig back through the gem source to see if you can
[2014-01-15 21:16:54 -0500] sbrink: right
[2014-01-15 21:17:02 -0500] Guest1332: thx sbrink
[2014-01-15 21:17:14 -0500] Guest1332: i've been diggin through this stuff for a couple days now
[2014-01-15 21:17:17 -0500] sbrink: no thx yet ;)
[2014-01-15 21:17:23 -0500] Guest1332: just happy i got the command to exec
[2014-01-15 21:17:33 -0500] Guest1332: docs are sparse
[2014-01-15 21:17:44 -0500] Guest1332: and i'm not super experinced in the ruby
[2014-01-15 21:17:56 -0500] bbssysop: i attempted to boostrap a node and got this: ERROR: cannot verify www.opscode.com's certificate, issued by `/C=US/O=DigiCert Inc/CN=DigiCert Secure Server CA':
[2014-01-15 21:17:59 -0500] bbssysop: any ideas why?
[2014-01-15 21:18:11 -0500] Guest1332: i managed to cobble together a sinatra web interface
[2014-01-15 21:18:17 -0500] Guest1332: what os bbssysop
[2014-01-15 21:18:27 -0500] bbssysop: centos 5.somehting
[2014-01-15 21:18:28 -0500] AndHeiberg_: anyone know a oh-my-zsh cookbook that works? I think i've tried them all
[2014-01-15 21:18:29 -0500] Guest1332: cacerts may need to be updated
[2014-01-15 21:18:48 -0500] bbssysop: CentOS release 5.7 (Final)
[2014-01-15 21:19:01 -0500] bbssysop: cacerts updated?
[2014-01-15 21:19:13 -0500] bbssysop: east command for that?
[2014-01-15 21:19:18 -0500] bbssysop: *easy
[2014-01-15 21:19:59 -0500] sbrink: Guest1332: inside /lib/chef/knife/ssh.rb, there is only one subsession.open_channel and that uses ch.request_pty, ...  so it looks like it is always interactive?
[2014-01-15 21:20:43 -0500] Guest1332: yum update openssl -y && curl http://curl.haxx.se/ca/cacert.pem -o /etc/pki/tls/certs/ca-bundle.crt
[2014-01-15 21:21:02 -0500] bbssysop: whoa. thanks for the quick reply! ill give that a try.
[2014-01-15 21:21:05 -0500] Guest1332: that will update openssl and get the cacert from that random website.
[2014-01-15 21:21:16 -0500] Guest1332: you can find a more legit one, but it should work
[2014-01-15 21:21:21 -0500] Guest1332: dont know if its trusted or not
[2014-01-15 21:21:34 -0500] Guest1332: yeah
[2014-01-15 21:22:06 -0500] Guest1332: sbrink thx... i found that too, but i seem to recall there was a way to change it. i gotta find the docs i found
[2014-01-15 21:22:08 -0500] bbssysop: cool. updating openssl imported a cert automatically
[2014-01-15 21:22:11 -0500] bbssysop: thanks man.
[2014-01-15 21:22:20 -0500] Guest1332: np. been there before myself
[2014-01-15 21:23:40 -0500] tabjunki: sbrink
[2014-01-15 21:23:43 -0500] tabjunki: i was looking into http://docs.opscode.com/plugin_knife_custom.html
[2014-01-15 21:23:56 -0500] tabjunki: and they initiate their own session to be able to log to a file
[2014-01-15 21:24:01 -0500] tabjunki: i might have to go down that road
[2014-01-15 21:26:53 -0500] tabjunki: also, i only changed log_location in the script and the knife.rb. I havent tried to change it in my client.rb
[2014-01-15 21:26:56 -0500] tabjunki: i'll try that
[2014-01-15 21:31:28 -0500] bluepojo: I'm using Chef 11.8.2 and am getting an error in some core_ext code in mixlib-shellout... strange bit is that it's mixlib 1.2.0. Isn't 1.3.0 supposed to be in Chef 11.8.2?
[2014-01-15 21:31:53 -0500] sbrink: tabjunk: have you look in there under the screen, tmux and what not sessions?
[2014-01-15 21:31:59 -0500] tabjunki: gem install mixlib and specify the version?
[2014-01-15 21:32:08 -0500] tabjunki: screen is to run in a screen
[2014-01-15 21:32:16 -0500] bluepojo: it's a fresh chef install
[2014-01-15 21:32:17 -0500] tabjunki: i looked into sessions
[2014-01-15 21:32:40 -0500] tabjunki: yeah, and its supposed to use rbenv or the other ruby env bluepojo
[2014-01-15 21:32:45 -0500] sbrink: poo, yeah you're probably going to have to inject you ssh session in to it
[2014-01-15 21:32:49 -0500] tabjunki: yeah
[2014-01-15 21:32:59 -0500] tabjunki: no biggie. I'll keep stabbing at it sbrink
[2014-01-15 21:33:03 -0500] tabjunki: thanks for your time
[2014-01-15 21:33:04 -0500] tabjunki: http://dev.nuclearrooster.com/2011/05/10/chef-notifying-and-logging-updated-resources/
[2014-01-15 21:33:35 -0500] sbrink: question though for you
[2014-01-15 21:34:13 -0500] tabjunki: yes?
[2014-01-15 21:34:13 -0500] sbrink: i'm not the brightest knife in the drawer but screen dumps stuff in to a tempfile knife-ssh-screen
[2014-01-15 21:34:27 -0500] tabjunki: true
[2014-01-15 21:34:31 -0500] tabjunki: https://github.com/opscode/chef/commit/9716a8e1fa7a315dc1d0a2cedcfad9d49c2f9017
[2014-01-15 21:34:39 -0500] tabjunki: looks like at least in this version logs were removed from knife
[2014-01-15 21:34:50 -0500] bbssysop: juliancdunn: Cannot find a resource for vhost_ipaddress
[2014-01-15 21:35:03 -0500] bbssysop: im getting that error, once i got all the files modified.
[2014-01-15 21:35:09 -0500] tabjunki: logs directly to stdout
[2014-01-15 21:35:48 -0500] juliancdunn: you have an equals sign? bbssysop
[2014-01-15 21:36:21 -0500] bbssysop: http://paste.ubuntu.com/6758594/
[2014-01-15 21:36:29 -0500] bbssysop: recipe and template is there...
[2014-01-15 21:36:36 -0500] bbssysop: i thought i used everythign correctly.
[2014-01-15 21:36:51 -0500] bbssysop: ah
[2014-01-15 21:37:00 -0500] bbssysop: i see.. that else statement is missing = yeah?
[2014-01-15 21:37:49 -0500] juliancdunn: yeah you need to assign the variable :)
[2014-01-15 21:38:52 -0500] bbssysop: heh. woops!
[2014-01-15 21:40:59 -0500] savant: Did I miss the merge window again?
[2014-01-15 21:52:56 -0500] gyre007: if I Include SAME recipe in diferent recipes
[2014-01-15 21:53:10 -0500] gyre007: it will only be loaded and executed once right ?
[2014-01-15 21:56:40 -0500] AndHeiberg_: anyone know how to setup vhosts automatically? I think apache_site is the answer? but I don't know how to configure it
[2014-01-15 22:00:54 -0500] tscanausa: AndHeiberg_: that sounds right, you will probably need to write your own wrapper cookbook
[2014-01-15 22:00:58 -0500] Will: Alo
[2014-01-15 22:01:29 -0500] AndHeiberg_: tscanausa: yeah that's what I'm reading now aswell
[2014-01-15 22:01:32 -0500] bosszaru: chef 11.8.2 on win2012 is failing to chef 11.4.4 on linux server throws the following error http://pastebin.ca/2542730 ssl end of file, couldn't find it in the google
[2014-01-15 22:01:37 -0500] AndHeiberg_: tscanausa: which seams annoying
[2014-01-15 22:01:57 -0500] Guest80426: Using https://github.com/VendaTech/chef-cookbook-gpg - when it generates a GPG key. Is there a way for the cookbook to report the public key ID value? any thoughts on how I can achieve that?
[2014-01-15 22:02:07 -0500] tscanausa: AndHeiberg_: its part of best practice to write wrapper cookbooks
[2014-01-15 22:02:58 -0500] AndHeiberg_: tscanausa: okay :) just started using vagrant and chef today, but it seams weird to me... What do you gain from this over using a config?
[2014-01-15 22:03:16 -0500] tscanausa: what do you mean using a config?
[2014-01-15 22:05:01 -0500] savant: ok i guess i missed the merge window
[2014-01-15 22:05:48 -0500] savant: some day i will have that pr on mysql merged
[2014-01-15 22:05:59 -0500] AndHeiberg_: tscanausa: like add something to chef.json.merge!({ or data_bags
[2014-01-15 22:08:31 -0500] tscanausa: AndHeiberg_: I dont know the history completely, but I seem to like the library functions for common traits you need more then 1 of and the config for things that are one off like version number.
[2014-01-15 22:10:21 -0500] tscanausa: AndHeiberg_: here is an example of what I have in a wrapper cookbook for the nginx_site function https://gist.github.com/canausa/9962adaf5711779a522f
[2014-01-15 22:14:15 -0500] fak3r: berks up fails, never seen this before... Ridley::Errors::ConnectionFailed: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed
[2014-01-15 22:17:47 -0500] jmickle: is it possible to do a node.has_key?
[2014-01-15 22:17:58 -0500] jmickle: whats the best way to check if a key exists on the node context?
[2014-01-15 22:18:08 -0500] jmickle: for example node.has_key('redisio')
[2014-01-15 22:20:54 -0500] jmickle: ah it is possible
[2014-01-15 22:21:20 -0500] rusticules: I have a ridley issue. Any chef object that I fetch and then try to save fails because there is an empty string key in the JSON.  For example for a node I see at the end of the JSON ",\"\":\"Ridley::NodeObject\"}". This causes the save to blow chunks. Anybody seen this?
[2014-01-15 22:24:59 -0500] coderanger: jmickle: Or just node['redisio']
[2014-01-15 22:26:06 -0500] jleveque: Hello, I have a question about defining and modifying variables in a erb template . I have the following problem :
[2014-01-15 22:26:40 -0500] jleveque:  16: <% other_nodes = @cluster_nodes %> 17: <% other_nodes.delete(node) %> . Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
[2014-01-15 22:27:04 -0500] jleveque: I do node understabnd how it is related to node attributes, and how can I solve my problem
[2014-01-15 22:27:26 -0500] coderanger: jleveque: What is @cluster_nodes set to?
[2014-01-15 22:27:36 -0500] coderanger: Probably node['something'] ?
[2014-01-15 22:27:47 -0500] jleveque: coderanger, it is an array on strings containing cluster nodes fqdn
[2014-01-15 22:27:58 -0500] jleveque: and @node is the current node
[2014-01-15 22:27:59 -0500] coderanger: Yeah, but its coming from a node attribute
[2014-01-15 22:28:11 -0500] jleveque: and I want to iterate to all the node but the current one
[2014-01-15 22:28:48 -0500] coderanger: <% other_nodes = @cluster_nodes.to_ary %
[2014-01-15 22:28:52 -0500] coderanger: Will probably fix it
[2014-01-15 22:28:56 -0500] jleveque: but here the problem refers to other_nodes wich in my mind was a local var that i defined within the erb file ? no ?
[2014-01-15 22:29:10 -0500] jmickle: thx coderanger
[2014-01-15 22:29:11 -0500] jleveque: ok thanks
[2014-01-15 22:29:22 -0500] coderanger: jleveque: Doesn't matter that you assigned it to a variable, it is still a pointer to the internal state of the node
[2014-01-15 22:29:25 -0500] coderanger: and that is r/o
[2014-01-15 22:29:41 -0500] jleveque: ok, thx
[2014-01-15 22:29:52 -0500] coderanger: You could also do something like @cluster_nodes.filter{|n| n != node}
[2014-01-15 22:30:01 -0500] coderanger: which doesn't mutate anything, it returns a new array
[2014-01-15 22:32:23 -0500] jleveque: coderanger, cool I was looking for that in the beggining, thx
[2014-01-15 22:35:20 -0500] jleveque: ptroblem is there is no filter
[2014-01-15 22:36:11 -0500] coderanger: jleveque: Hmm?
[2014-01-15 22:36:23 -0500] jleveque: I did not found any method that does the same function as Array#delete but returns self
[2014-01-15 22:36:57 -0500] coderanger: Let me check the Enumerable docs, I might have my python wires crossed again
[2014-01-15 22:37:03 -0500] coderanger: been switching rapid-fire today
[2014-01-15 22:37:03 -0500] jleveque: I'm a beginner in ruby, so I do not know what you mean by filter
[2014-01-15 22:37:21 -0500] coderanger: Derp, right
[2014-01-15 22:37:24 -0500] coderanger: Enumerable#select
[2014-01-15 22:37:37 -0500] jleveque: thanks ;)
[2014-01-15 22:37:38 -0500] coderanger: so .select{|n| n != node}
[2014-01-15 22:50:01 -0500] dgarstang1: can the apt module do an 'apt-get upgrade' ?
[2014-01-15 22:52:18 -0500] mallu: hi, I'm trying to use vagrant omnibus to download chef-client. However I'm getting "Connecting to www.opscode.com|184.106.28.90|:443... failed: Connection timed out"
[2014-01-15 22:52:31 -0500] mallu: --2014-01-15 22:50:28--  (try: 9)  https://www.opscode.com/chef/metadata?v=11.8.2
[2014-01-15 22:52:50 -0500] mallu: am I doing seomthing wrong? Or the site is down?
[2014-01-15 22:53:44 -0500] hdee: site is available for sure
[2014-01-15 22:54:29 -0500] mallu: I'm wondering is the URL it is trying is wrong
[2014-01-15 22:57:57 -0500] stormerider: https://www.opscode.com/chef/metadata?v=11.8.2 gives me an internal server error
[2014-01-15 22:58:47 -0500] mallu: I think it is going to https://www.opscode.com/chef/metadata?v=11.4.0&prerelease=false&p=el&pv=6&m=x86_64
[2014-01-15 22:59:25 -0500] mallu: that is redirecting to amazon S3
[2014-01-15 23:01:47 -0500] hdee: is there a way of overriding a node attribute set by ohhai?
[2014-01-15 23:01:52 -0500] hdee: specifically platform_version
[2014-01-15 23:01:55 -0500] juliancdunn: nope
[2014-01-15 23:02:06 -0500] juliancdunn: you can't pretend a system is something it's not :)
[2014-01-15 23:02:10 -0500] hdee: are you just saying that or is it really nope
[2014-01-15 23:02:19 -0500] hdee: i have a legitimate use
[2014-01-15 23:02:20 -0500] hdee: heh
[2014-01-15 23:02:21 -0500] juliancdunn: no, I'm not just saying that
[2014-01-15 23:02:40 -0500] hdee: i couldn't find any documentation saying it's read only
[2014-01-15 23:03:04 -0500] juliancdunn: well, it's "automatic" precedence level, which is the highest and can't be overridden
[2014-01-15 23:03:08 -0500] juliancdunn: what is your use case?
[2014-01-15 23:05:49 -0500] hdee: i'm correcting an action opscode yum cookbook is taking, ohai detects this amazon ami as rhel but since it's not actually rhel, platform_version shows up as 2013.09 instead of 5 or 6
[2014-01-15 23:06:02 -0500] hdee: which messes up opscode yum cookbook when selecting a template for yum.conf
[2014-01-15 23:06:46 -0500] hdee: so i was hoping to force platform_version to 6 for this OS so that yum cookbook works without modi
[2014-01-15 23:08:07 -0500] hdee: ahh man
[2014-01-15 23:08:17 -0500] hdee: node.automatic is exactly how i should be setting it
[2014-01-15 23:08:36 -0500] hdee: i was able to set it
[2014-01-15 23:09:02 -0500] juliancdunn: oh, look at that
[2014-01-15 23:09:05 -0500] juliancdunn: so I was wrong :)
[2014-01-15 23:09:26 -0500] hdee: the farthest i went was force_override
[2014-01-15 23:09:27 -0500] hdee: lol
[2014-01-15 23:10:32 -0500] juliancdunn: also, I think the newest yum cookbook is a *lot* different, so I'd be surprised if it still had such a problem
[2014-01-15 23:11:32 -0500] hdee: oh wow i'm way behind
[2014-01-15 23:11:36 -0500] hdee: still on 2.4.4
[2014-01-15 23:15:00 -0500] Guest80426: Using https://github.com/VendaTech/chef-cookbook-gpg - did I understand this module can distribute gpg keys?
[2014-01-15 23:15:12 -0500] Guest80426: what is the data bag?
[2014-01-15 23:15:58 -0500] thehar_: looks like it's gpg_keys
[2014-01-15 23:16:00 -0500] Guest80426: nvm, found the answer: http://docs.opscode.com/essentials_data_bags.html
[2014-01-15 23:16:18 -0500] Guest80426: at least for the data bag, but still, can I use the data bag to distribute the gpg keys?
[2014-01-15 23:16:31 -0500] Guest80426: I'm trying to figure out a good way to issue gpg keys for certain users.
[2014-01-15 23:17:07 -0500] Guest80426: this cookbook seems like does all of that, but given my n00biness I'm trying to decipher most of it.
[2014-01-15 23:22:31 -0500] carmstrong: Guest80426: a data bag makes sense for that use case, yep
[2014-01-15 23:22:44 -0500] Guest80426: ah. k.
[2014-01-15 23:23:18 -0500] carmstrong: Guest80426: looks like the data bag name is specified in the node[:gpg][:keys_data_bag] attribute
[2014-01-15 23:23:21 -0500] carmstrong: which, by default, is gpg_keys
[2014-01-15 23:23:22 -0500] carmstrong: default[:gpg][:keys_data_bag] = 'gpg_keys'
[2014-01-15 23:23:43 -0500] Guest80426: So that's the data bag name, which I need to create, yeah?
[2014-01-15 23:24:19 -0500] carmstrong: yep
[2014-01-15 23:26:55 -0500] carmstrong: knife data bag create gpg keys
[2014-01-15 23:28:13 -0500] Guest80426: That means I need to install knife.
[2014-01-15 23:28:15 -0500] Guest80426: ok.
[2014-01-15 23:42:10 -0500] magoo: if your chef config contains the pointer to the encrypted data bag secret, how can one display the unencrypted data bag contents without commenting out the secret file reference in client.rb
[2014-01-15 23:42:49 -0500] magoo: i need a --disable-secret flag or the like
[2014-01-15 23:42:59 -0500] magoo: but maybe there's a quick n' easy way
