[2014-01-10 00:24:15 -0500] jhunter: easy question.. interview question
[2014-01-10 00:24:24 -0500] jhunter: how to escape => in an .erb?
[2014-01-10 00:24:42 -0500] jhunter: i'm assigning val => <%= variable1 %>
[2014-01-10 00:24:51 -0500] jhunter: and that => is breaking things
[2014-01-10 00:36:56 -0500] gchristensen: jhunter: you could do <%= '=>' %>...
[2014-01-10 00:55:46 -0500] jhunter: oyea
[2014-01-10 00:55:47 -0500] jhunter: :DD
[2014-01-10 01:31:33 -0500] budd: hi all -- in a recipe, is it possible to only restart the service if the rest of the recipe was run? if there were no changes, no point in restarting the service kind of thing?
[2014-01-10 01:32:08 -0500] gchristensen: budd: use notifications or subscriptions :)
[2014-01-10 01:37:08 -0500] budd: so,.. in my template snmp.conf,.. i added notifies :restart, "service[snmpd]", :delayed
[2014-01-10 01:37:15 -0500] budd: seem about right?
[2014-01-10 01:37:30 -0500] budd: i meant my template section.. not in the template itself
[2014-01-10 01:37:53 -0500] budd: so,.. if that template section triggers -- and needs to be run -- then restart snmpd will happen?
[2014-01-10 01:50:04 -0500] budd: hi all -- ive written a very good recipe,.. and now that im at the end, i need to log into a different server and add some text. how do i go about connecting to a different server from chef, from the same recipe?
[2014-01-10 01:50:33 -0500] budd: sort of like: on server A, do this that and the other,.. and now connect to server B and let it know.
[2014-01-10 01:50:44 -0500] budd: from one recipe
[2014-01-10 03:35:04 -0500] Guest80353: hello! i have a little recipe, to add a host to a monitor via ssh. im not sure this is the best way, but its the only way i can think of. problem is -- cant use ssh keys, i need to provide a password,.. any ideas:
[2014-01-10 03:35:04 -0500] Guest80353: bash "add_to_monitor" do         code <<-EOH         ssh -oStrictHostKeyChecking=no 1.2.3.4 "cd /opt/observium; ./add_device.php #hostname# woopie_read v2c 161 tcp; chown -R www-data:www-data ."         EOH         action :nothing end
[2014-01-10 04:50:03 -0500] zanshin: Hello. I'm having trouble getting Oracle Java 7 to install via the java cookbook. Instead of Java, the tar seems to contain an HTML page. Not useful. On the surface there doesn't appear to be a way to tell the java cookbook to use a local (pre-downloaded) JDK tar. Does anyone have a favorite alternate java cookbook that will work with a local tar?
[2014-01-10 04:54:28 -0500] flaccid: zanshin: maybe you run into the important note https://github.com/socrata-cookbooks/java#description
[2014-01-10 04:54:31 -0500] zanshin: Or can I get away with overriding the 'java' 'jdk' '7' x86_64' 'url' attribute (and the checksum its paired with) to point to my local copy?
[2014-01-10 04:55:04 -0500] zanshin: flaccid: I've got the oracle accept terms deal set to true.
[2014-01-10 04:55:24 -0500] zanshin: I've had this cookbook working in the past, but it appears that Oracle has moved the goal posts. Again.
[2014-01-10 04:55:40 -0500] flaccid: zanshin: you can override the attribute i would assume https://github.com/socrata-cookbooks/java/blob/master/attributes/default.rb#L89
[2014-01-10 04:56:36 -0500] zanshin: Yes, and the line below too to make sure the checksum is from the tar I grabbed manually
[2014-01-10 04:56:44 -0500] flaccid: cool
[2014-01-10 04:57:09 -0500] zanshin: Okay. I'l try that. Wanted to vet the idea here first though. It's been a long day and wasn't sure if my though would hold water or not
[2014-01-10 04:57:38 -0500] flaccid: you might like to consider contributing that cookbook to fix it up if oracle foo'd it, would help everyone
[2014-01-10 04:58:52 -0500] zanshin: All I'm going to due is override those two attributes in my role to point to a local copy of the JDK tarball. Not really changing the cookbook, but subverting it to my needs. :)
[2014-01-10 04:59:37 -0500] flaccid: well, if its just an out of date url at oracle..
[2014-01-10 08:35:00 -0500] enbergj: I'm getting repeatedly weird issues, "Error connecting to https://s3-external-1.amazonaws.com/opscode-platform-production-data/organization-......  - Connection timed out - connect(2)" .. then if I slap that URL to curl -I, it will connect just fine, but get a 403
[2014-01-10 08:35:43 -0500] enbergj: oh, and now the 15th time that was just running in the background decided to continue .. any ideas what was going on?
[2014-01-10 08:36:49 -0500] prognostikos: enbergj: hosted chef? your best bet is probably opscode support
[2014-01-10 08:42:10 -0500] enbergj: yeah, hosted chef
[2014-01-10 08:43:10 -0500] enbergj: I was sort of hoping there would be others here with the same issue so I'd know for sure it's an issue with opscode and their status page saying "all is ok" is lying
[2014-01-10 08:48:10 -0500] flaccid: enbergj: contact their support
[2014-01-10 09:29:24 -0500] daxroc: can you specify the version of a cookbook on the runlist?
[2014-01-10 09:48:10 -0500] borntyping: daxroc: no, you can only restrict cookbook versions in environments
[2014-01-10 09:49:06 -0500] daxroc: Does any one use chef to deploy the same product where multiple versions are applied in the same environment? What method do you use to deploy ? Does the Maximum version apply here? Would it be acceptable to enforce a cookbook::recipe@version per node with this approach ?
[2014-01-10 10:05:29 -0500] epcim: daxroc: you can have just "latest" version of your cookbooks in the environment (if I am aware) with chef server. With chef solo you might use tag/branch of your git repo for that purpose.
[2014-01-10 10:06:54 -0500] epcim: daxroc: I assume to have an application cookbook, that will be ONE but capable to deploy multiple versions. like check node['app']['version'] from attr and than branch the procedure to deploy it.
[2014-01-10 10:06:59 -0500] daxroc: That's what I was thinking, You can workaround this with wrappers to depend on version = 1.1.x  of your cookbook. Does that seem practical
[2014-01-10 10:08:09 -0500] daxroc: epcim: That's exactly how I had thought to do it.
[2014-01-10 10:08:25 -0500] epcim: daxroc: Have a look on computed attributes issues. If I am aware of the situation, the wrapper cookbook is do not overload default "calculated" attributes. In this case I put version spec. in the ROLE override_attributes rather than in the cookbook
[2014-01-10 10:08:55 -0500] daxroc: the cookbook recipe decides based on a sane default for the version or can be override by application cookbook or even node ?
[2014-01-10 10:09:15 -0500] epcim: daxroc: have a look here http://www.prashantrajan.com/posts/2013/06/leveling-up-chef-best-practices/ (I like Berkshelf way and the Antipatterns)
[2014-01-10 10:24:41 -0500] Abhishek: Hi Guys I just wanted to know "Does chef provides multi tier app deployment and rolling upgrade out of the box or we have to write custom script to achieve this"?
[2014-01-10 11:13:03 -0500] epcim: Abhishek: Yes multi tier, it is supported ootb.
[2014-01-10 11:15:06 -0500] epcim: Abhishek: rolling upgrade for apps.. it's a task for cookbook not for the tooling that deploys cookbooks. I assume rolling upgrade as feasible. But no experience. Would like to know what reverse operations are supported.
[2014-01-10 11:16:35 -0500] epcim: Does anybody has experience with  atomic-penguin / cookbook-bind ? I simply fail to define Zones in the databag or Attributes.
[2014-01-10 11:41:25 -0500] zer0: hello
[2014-01-10 11:42:09 -0500] Guest12008: hello!
[2014-01-10 11:42:54 -0500] Guest12008: how can i add ohai plugin path to /etc/chef/client.rb, i tried this -   Ohai::Config[:plugin_path] << '/etc/chef/ohai/plugins', but it did not work
[2014-01-10 12:07:39 -0500] UukGoblin: seeing multiple timeouts connecting to https://api.opscode.com...
[2014-01-10 12:07:45 -0500] UukGoblin: (from my chef runs)
[2014-01-10 12:22:09 -0500] flaccid: UukGoblin: contact opscode support
[2014-01-10 12:23:21 -0500] UukGoblin: flaccid, are they not here? ;-)
[2014-01-10 12:32:21 -0500] workmad3: UukGoblin: some opscode maintainers are here, but I doubt any of their website support staff are (or if they are, they won't be using it for status issues ;) )
[2014-01-10 12:37:22 -0500] flaccid: UukGoblin: not that i know of, not sure sorry
[2014-01-10 12:37:41 -0500] flaccid: would be nice if there were
[2014-01-10 12:37:56 -0500] UukGoblin: yeah I was hoping other people would see it too
[2014-01-10 12:38:16 -0500] UukGoblin: will see if it's still there after lunch ;-]
[2014-01-10 12:51:05 -0500] Srini: Hi can somebody help me with create an empty .profile file in the user's home directory?
[2014-01-10 12:51:25 -0500] Srini: or pointer to some cookbook it does it on linux
[2014-01-10 12:51:34 -0500] Srini: all my tricks went in vain so far
[2014-01-10 12:51:55 -0500] workmad3: Srini: file "/home/username/.profile" do; owner username; end
[2014-01-10 12:52:15 -0500] Srini: workmad3, No action command is required?
[2014-01-10 12:52:17 -0500] workmad3: Srini: that'll ensure the file exists without stamping over the contents
[2014-01-10 12:52:23 -0500] workmad3: default action is :create
[2014-01-10 12:52:36 -0500] Srini: ok
[2014-01-10 12:52:44 -0500] workmad3: you could also put a content param in there and use action :create_if_missing
[2014-01-10 12:52:57 -0500] Srini: ther owner username is optional or compulsory to specify?
[2014-01-10 12:53:00 -0500] flaccid: i wonder if a user* cookbook would create this
[2014-01-10 12:53:01 -0500] workmad3: which would create the file with the contents specified
[2014-01-10 12:53:09 -0500] flaccid: manage a user instead of a file..
[2014-01-10 12:53:24 -0500] workmad3: Srini: optional, but if you omit it it'll default to the user running the chef-client run (so probably root)
[2014-01-10 12:53:39 -0500] Srini: flaccid, actually I am trying to update a path statement in the .bash_profile of a user
[2014-01-10 12:53:43 -0500] workmad3: Srini: you might also want to specify the group and the mode
[2014-01-10 12:54:04 -0500] flaccid: Srini: then the right thing to do is use chef to manage that whole file
[2014-01-10 12:54:31 -0500] Srini: flaccid, could you elaborate a bit on that please?
[2014-01-10 12:54:45 -0500] flaccid: Srini: chef isn't intended to be sed
[2014-01-10 12:55:14 -0500] flaccid: config files are managed with resources such as the template resource for the whole file
[2014-01-10 12:55:21 -0500] Srini: flaccid, do you mean to suggest using a template kind of stuff
[2014-01-10 12:55:43 -0500] flaccid: Srini: yes, at the minimum
[2014-01-10 12:56:08 -0500] workmad3: Srini: my preference would be (and this may be what you're doing) to manage the .bash_profile entirely with chef using a template and, if it's intended that a user can customise their profile specifically, add a line in the template '. $HOME/.user_bash_profile' and use chef to ensure that file exists
[2014-01-10 12:56:58 -0500] Srini: flaccid, workmad3 ... Thanks for your help!
[2014-01-10 12:57:04 -0500] flaccid: np
[2014-01-10 12:59:03 -0500] Srini: So that means that the complete new configuration of the profile file has to be templated.... or we can replace a particular value like PATH in the template? (sorry I am asking becuase I am damn new to it)
[2014-01-10 12:59:34 -0500] workmad3: Srini: complete configuration
[2014-01-10 12:59:53 -0500] workmad3: Srini: as flaccid said, chef isn't sed and isn't intended to be used like sed... it's much more painless to manage complete files
[2014-01-10 13:00:20 -0500] workmad3: Srini: a common convention is to slap a comment at the top of chef-managed files warning anyone looking that the file is likely to just be replaced
[2014-01-10 13:01:00 -0500] Srini: workmad3, Yup I got it..!
[2014-01-10 13:03:33 -0500] flaccid: # this file is managed by the overlord, chef
[2014-01-10 13:04:05 -0500] workmad3: flaccid: # Abandon Hope, all ye who make edits here. Sincere regards, chef
[2014-01-10 13:04:24 -0500] flaccid: +1
[2014-01-10 13:06:21 -0500] workmad3: flaccid: the smart-ass version would be to add in a second line with a # Reason for last change: <%= get_random_what_the_commit_line %>
[2014-01-10 13:18:30 -0500] epcim: Does anybody has experience with  atomic-penguin / cookbook-bind ? I simply fail to define Zones in the databag or Attributes.
[2014-01-10 13:19:16 -0500] epcim: Q: How can I overload an "cookbook_file" definition from wrapper cookbook?
[2014-01-10 13:59:32 -0500] UukGoblin: this is weird...
[2014-01-10 13:59:46 -0500] UukGoblin: chef-clients are getting timeouts while connecting, but I can curl that same host just fine...
[2014-01-10 14:00:02 -0500] UukGoblin: and doing the same query (partial_search) in chef-shell also works fine...
[2014-01-10 14:00:13 -0500] UukGoblin: does opscode have a api rate limit?
[2014-01-10 14:01:25 -0500] pcn: Probably.
[2014-01-10 14:01:41 -0500] pcn: They definitely depend on the client to backoff and retry in response to backpressure
[2014-01-10 14:02:48 -0500] pcn: By "depend" I mean expect the client to do that.  I understand their infrastructure doesn't rely on this, just that it is how the client must work.  It has to expect that it will re-try.
[2014-01-10 14:02:50 -0500] UukGoblin: yeah, partial_search is not restarting after a timeout... but it hits the time out pretty much every single time in chef-client, and pretty much never when I run it from chef-shell...
[2014-01-10 14:03:27 -0500] UukGoblin: hmm now I'm seeing 500s :-O
[2014-01-10 14:03:32 -0500] pcn: Maybe open a ticket with their support?  I've had good experiences with them in the past.
[2014-01-10 14:03:46 -0500] UukGoblin: yeah will do... just not sure if the issue isn't on my end yet...
[2014-01-10 14:08:29 -0500] epcim: Q: Anybody smart enough to resolve overloading of "cookbook_file" source in wrapper cookbook: http://stackoverflow.com/questions/21045855/chef-rewind-cookbook-file-definition-from-a-wrapper-cookbook-recipe
[2014-01-10 14:10:14 -0500] mveitas: is there a clean way to check to see if an nested node attribute exists?  example:  node['foo']['bar']['baz']?
[2014-01-10 14:30:02 -0500] CPS: what would be the best way to export a file out of SVN and run it via Chef?
[2014-01-10 14:31:26 -0500] shlant: CPS:http://docs.opscode.com/resource_subversion.html
[2014-01-10 14:31:42 -0500] CPS: shlant: http://stackoverflow.com/questions/21029766/downloading-a-file-from-svn-using-chef-on-windows
[2014-01-10 14:32:01 -0500] CPS: tried that, didn't work
[2014-01-10 14:32:09 -0500] zack_: When you are bootstrapping to you chef server, do you use the user name and pass for your VM or for the Chef Server
[2014-01-10 14:32:32 -0500] shlant: the VM
[2014-01-10 14:32:38 -0500] shlant: those are ssh credentials
[2014-01-10 14:32:52 -0500] shlant: CPS: have you checked to see if the file downloads?
[2014-01-10 14:32:59 -0500] zack_: I do that and I get the error Bootstrapping Chef on 127.0.0.1 ERROR: Network Error: Connection refused - connect(2) Check your knife configuration and network settings
[2014-01-10 14:33:05 -0500] shlant: or run in debug mode?
[2014-01-10 14:33:13 -0500] CPS: shlant: the file does not appear anywhere on my system
[2014-01-10 14:33:26 -0500] shlant: CPS: try the chef tun with -l debug
[2014-01-10 14:33:33 -0500] CPS: i'll give that a go'
[2014-01-10 14:33:47 -0500] shlant: zack_: does you knife.rb have your chef server url and credentials?
[2014-01-10 14:34:51 -0500] zack_: chef_server_url          "https://127.0.0.1/organizations/eng"
[2014-01-10 14:34:56 -0500] zack_: is has that
[2014-01-10 14:35:25 -0500] shlant: do you have your own chef server lcoally?
[2014-01-10 14:35:29 -0500] shlant: locally
[2014-01-10 14:35:37 -0500] zack_: I hav an enterprise chef server locally
[2014-01-10 14:35:43 -0500] zack_: have*
[2014-01-10 14:36:46 -0500] shlant: zack_: so you have set up your own chef sever? it's not hosted on getchef?
[2014-01-10 14:36:55 -0500] BryanWB: someara, ping, got a q for u about lvm cookbook and some changes i want to make to it
[2014-01-10 14:37:05 -0500] zack_: it is hosted on my VM
[2014-01-10 14:37:14 -0500] zack_: I can connect to it, no problems.
[2014-01-10 14:37:17 -0500] shlant: ok
[2014-01-10 14:37:37 -0500] zack_: but I cannot bootstrap to it
[2014-01-10 14:37:45 -0500] zack_: nor do I have a client??
[2014-01-10 14:37:55 -0500] shlant: wait are you trying to bootsrap the chef server?
[2014-01-10 14:38:08 -0500] zack_: yes I'm trying to eventually create a node
[2014-01-10 14:38:27 -0500] zack_: knife bootstrap 127.0.0.1 --sudo -x root -P releaseteam -N "target"
[2014-01-10 14:38:44 -0500] shlant: if you already have a chef server online, you shouldn't be bootstrapping it
[2014-01-10 14:38:54 -0500] shlant: you should be bootstrapping a node on another VM
[2014-01-10 14:39:17 -0500] shlant: bootstrapping installs chef on a blank vm
[2014-01-10 14:39:21 -0500] zack_: How would I bootstrap another node
[2014-01-10 14:39:23 -0500] shlant: blank = only OS
[2014-01-10 14:39:27 -0500] shlant: spin up another VM
[2014-01-10 14:39:37 -0500] shlant: and then run that bootstrap comand on that
[2014-01-10 14:39:43 -0500] shlant: what are you using for VMs?
[2014-01-10 14:40:23 -0500] bubu: Hosted chef having any issues at the moment? Trying to provision a few nodes and [2014-01-10T14:37:00+00:00] FATAL: Errno::ETIMEDOUT: Error connecting to https://s3-external-1.amazonaws.com/opscode-platform-production-data/organizationREDACTED - - Connection timed out - connect(2)
[2014-01-10 14:40:43 -0500] shlant: that looks like an ec2 issue
[2014-01-10 14:43:02 -0500] shlant: does anyone know the benefit of using an ssh_wrapper vs a wildcard host entry?
[2014-01-10 14:43:29 -0500] bubu: shlant: an ec2 issue or an s3 issue?
[2014-01-10 14:43:45 -0500] shlant: bubu: sorry, s3
[2014-01-10 14:43:50 -0500] shlant: amzon issue
[2014-01-10 14:43:51 -0500] shlant: haha
[2014-01-10 14:45:56 -0500] shlant: bubu: do you have permissions on that bucket? at what point in the run does it fail?
[2014-01-10 14:47:16 -0500] bubu: It's trying to sync cookbooks
[2014-01-10 14:48:40 -0500] UukGoblin: bubu, seeing similar stuff, yes, since about 1am today
[2014-01-10 14:48:58 -0500] UukGoblin: bubu, timeouts and 500s trying to do things like running searches
[2014-01-10 14:49:13 -0500] UukGoblin: just raised a ticket with support
[2014-01-10 14:50:04 -0500] CPS: shlant: mystery solved http://stackoverflow.com/questions/21029766/downloading-a-file-from-svn-using-chef-on-windows/21047291#21047291
[2014-01-10 14:50:09 -0500] CPS: it's a chef bug
[2014-01-10 14:50:25 -0500] bubu: UukGoblin: ok thanks
[2014-01-10 14:51:02 -0500] bubu: UukGoblin: got a ticket url? :)
[2014-01-10 14:51:46 -0500] UukGoblin: bubu, https://www.getchef.com/support/tickets/16573 but I doubt you'd have access to it... unless you work for opscode ;-)
[2014-01-10 14:52:19 -0500] bubu: ah, no, unfortunately not :)
[2014-01-10 14:52:34 -0500] bubu: would have thought support tickets would be visibile to all
[2014-01-10 14:52:42 -0500] UukGoblin: would have hoped not!
[2014-01-10 14:53:01 -0500] UukGoblin: there might be some organization secrets in them ;-]
[2014-01-10 14:53:10 -0500] bubu: then redact them? :)
[2014-01-10 14:53:19 -0500] UukGoblin: but they might be relevant to the problem ;-]
[2014-01-10 14:53:48 -0500] UukGoblin: I want opscode to know what I'm trying to do
[2014-01-10 14:54:33 -0500] UukGoblin: so is it only the 2 of us?
[2014-01-10 14:54:43 -0500] UukGoblin: doesn't anyone else in this channel use hosted chef? :-)
[2014-01-10 14:56:05 -0500] UukGoblin: bubu, actually... you had an issue connecting to s3-external-1.amazonaws.com, it seems
[2014-01-10 14:56:24 -0500] UukGoblin: bubu, I'm seeing ETIMEDOUTs connecting to https://api.opscode.com/organizations/REDACTED
[2014-01-10 14:56:53 -0500] bubu: UukGoblin: I've had them too while doing chef runs
[2014-01-10 14:58:38 -0500] shlant: CPS: figures. haha
[2014-01-10 14:58:49 -0500] CPS: yep
[2014-01-10 14:59:03 -0500] CPS: this is like the 3rd or 4th big deal bug i've run into
[2014-01-10 15:01:13 -0500] shlant: CPS: yea the windows support is not great yet
[2014-01-10 15:02:15 -0500] shlant: anyone know the best way to handle difference recipes needing different git repos?
[2014-01-10 15:02:24 -0500] shlant: should you have a code_checkout recipe?
[2014-01-10 15:02:31 -0500] shlant: and have a repo attribute?
[2014-01-10 15:02:40 -0500] shlant: or git resource in each recipe
[2014-01-10 15:07:56 -0500] ajn: i'm trying to use the git resource on a debian7 VM, however the apt-get seems to be trying to pull a bad deb file, is this a chef issue?
[2014-01-10 15:09:58 -0500] gregkare: ajn: Make sure you do an apt-get update before trying to install a package
[2014-01-10 15:11:07 -0500] ajn: gregkare: that was it, sorry i figured the intial nginx install would run the apt-get before i got to the section that needed git
[2014-01-10 15:13:31 -0500] juliancdunn: CPS: what are the other ones?
[2014-01-10 15:22:14 -0500] jidar: hahah, how about the knife-1 bug
[2014-01-10 15:22:24 -0500] jidar: https://tickets.opscode.com/browse/KNIFE-1
[2014-01-10 15:22:37 -0500] jidar: check my last comment there, you need to double quote single quote the recipe list
[2014-01-10 15:23:23 -0500] CPS: juliancdunn: the two big ones that come to mind were fixed in server 11.8
[2014-01-10 15:24:04 -0500] CPS: web ui bugs that would have made node management a big headache
[2014-01-10 15:24:35 -0500] juliancdunn: CPS: ah ok
[2014-01-10 15:25:14 -0500] daxroc: How do you read from an attribute in 11 eg: "test = node.myface.paths[node.chef_environment]" results in Chef::Exceptions::ImmutableAttributeModification
[2014-01-10 15:25:30 -0500] juliancdunn: KNIFE-1! my god, we should fix that already :-)
[2014-01-10 15:27:15 -0500] juliancdunn: daxroc: test = node['myface']['paths'][node.chef_environment] ?
[2014-01-10 15:27:53 -0500] bashbash: good morning all - im looking to do this pseudo code in a recipe: if ohai variable bond0:1 exists use its ip address, if not use ohai ipaddress instead. any pointers?
[2014-01-10 15:28:37 -0500] jidar: juliancdunn: I'm not good enough with ruby to track down where the problem is happening but I did look into it. If I could just get a stack trace or run the knife command through a debugger I might be able to figure it out :/ but I don't know how
[2014-01-10 15:30:22 -0500] helfire: any info on ruby 2 and chef? just was reading about 1.9.3 end of development
[2014-01-10 15:30:23 -0500] juliancdunn: jidar: you're not running under Cygwin, are you?
[2014-01-10 15:30:26 -0500] jidar: my personal problems right now are that the basic recipe_mode / breakpoint example in the chef_shell document doesn't appear to work
[2014-01-10 15:30:30 -0500] jidar: juliancdunn: no native
[2014-01-10 15:30:42 -0500] matticulous: having an issue with omnibus ruby vs. system ruby that i'm hoping someone can help with: https://gist.github.com/matticulous/8356392
[2014-01-10 15:30:57 -0500] daxroc: juliancdunn: assumption was correct. but it's still the same exception
[2014-01-10 15:31:03 -0500] juliancdunn: helfire: Chef will run under Ruby 2.0.0 and we're fixing support for 2.1.0, but haven't shipped an omnibus with it yet
[2014-01-10 15:31:30 -0500] matticulous: symlink test using system ruby (rbenv) returns true; embedded (omnibus) returns false for the same file.
[2014-01-10 15:33:22 -0500] bashbash: [updated question] im looking to do this pseudo code in a recipe, in a bash 'code' section: if ohai variable bond0:1 exists use its ip address, if not use ohai ipaddress instead. any pointers?
[2014-01-10 15:33:22 -0500] daxroc: juliancdunn: sorry your were correct.
[2014-01-10 15:33:56 -0500] juliancdunn: daxroc: we know of an issue where the Cygwin command parser destroys square brackets and/or quotes, but haven't investigated further
[2014-01-10 15:34:50 -0500] daxroc: juliancdunn: It was refering to an error later where (test << test2).flatten.each do 
[2014-01-10 15:36:47 -0500] juliancdunn: bashbash: test for existence of node['network']['interfaces']['bond0:1'] first, if it exists, find the IP of the bonded interface, otherwise use node['ipaddress']
[2014-01-10 15:37:18 -0500] juliancdunn: daxroc: right, because 'test' is just a reference to the attribute
[2014-01-10 15:37:41 -0500] juliancdunn: use test = node['foo']['bar'].dup to make a copy that you can write to
[2014-01-10 15:40:37 -0500] juliancdunn: matticulous: dunno, must be something to do with that dir? it works for me on /tmp https://gist.github.com/juliandunn/6fd871193b0c8f4f8239
[2014-01-10 15:40:52 -0500] daxroc: juliancdunn: much appreciate it
[2014-01-10 15:43:32 -0500] matticulous: juliancdunn: really strange. i get the exact same behavior for /tmp (replicated your gist). false for embedded; true for system.
[2014-01-10 15:44:38 -0500] bashbash: juliancdunn: right. thats the method i wish to use. and in bash, php, python i could bang that out in an instant. but i cant seem to find how to test isset for a variable, THEN do this, OR do this, in a bash 'code' section. or any other section really.
[2014-01-10 15:45:17 -0500] bashbash: juliancdunn: have any keywords i could search for, or a link to a working example?
[2014-01-10 15:47:53 -0500] bashbash: to answer my own question: http://docs.opscode.com/chef/dsl_recipe.html under the 'include' section. 'include' seems to be == to 'isset'
[2014-01-10 15:49:59 -0500] juliancdunn: bashbash: if things aren't set in Ruby they are nil
[2014-01-10 15:50:17 -0500] juliancdunn: you can prototype some of this in chef-shell
[2014-01-10 15:51:00 -0500] juliancdunn: chef:recipe > node['network']['interfaces']['bond0:1'] => nil
[2014-01-10 15:52:48 -0500] bashbash: juliancdunn: if i wanted to turn that into an 'if' statement?
[2014-01-10 15:53:02 -0500] bashbash: would this work: if include?node['network']['interfaces']['bond0:1']
[2014-01-10 15:53:18 -0500] bashbash: or is there something like: if defined?node['network']['interfaces']['bond0:1']
[2014-01-10 15:53:26 -0500] bashbash: which would make it a lot more readable.
[2014-01-10 15:54:10 -0500] bashbash: searching for 'chef if variable defined' just brings up pages about ruby.
[2014-01-10 15:54:53 -0500] juliancdunn: you just need "if node['network']['interfaces']['bond0:1'].nil?"
[2014-01-10 15:55:13 -0500] daxroc: Why do I get http://pastebin.ca/2532875 warning?
[2014-01-10 15:55:15 -0500] sanguisdex: I can't find documentation on how to define a cookbook version  in a runlist, any links would be great
[2014-01-10 15:55:32 -0500] bashbash: is that saying 'if this variable is empty, then ..."
[2014-01-10 15:55:35 -0500] daxroc: sanguisdex: with knife ?
[2014-01-10 15:55:39 -0500] juliancdunn: bashbash: correct
[2014-01-10 15:55:48 -0500] bashbash: can i throw a !not in there somewhere?
[2014-01-10 15:56:11 -0500] bashbash: as i only want it to run if its not empty.
[2014-01-10 15:56:27 -0500] AntelopeSalad: is it good practice to always send in variables to a template instead of using attributes directly?
[2014-01-10 15:56:33 -0500] juliancdunn: bashbash: yeah, you can either put '!' before node, or write it as an unless
[2014-01-10 15:56:40 -0500] daxroc: sanguisdex: knife node run_list set <node> 'role[myrole]' cookbook, cookbook::recipe
[2014-01-10 15:56:41 -0500] juliancdunn: unless node['.....'].nil?
[2014-01-10 15:56:49 -0500] bashbash: thanks soooo much for your help.
[2014-01-10 15:56:56 -0500] bashbash: this was everything i needed.
[2014-01-10 15:57:14 -0500] bashbash: hard to come from a different background to ruby at first. i appreciate your time and effort.
[2014-01-10 15:57:21 -0500] juliancdunn: no probs.
[2014-01-10 15:58:21 -0500] BriGuy: is there anyway to use a remote_file as the source for a template with HTTP auth?
[2014-01-10 15:58:59 -0500] daxroc: Anyone know why I get the above pastebin ? it's for every block thats iterated over ? Is this ok to ignore ?
[2014-01-10 15:59:20 -0500] juliancdunn: daxroc: it's telling you that you're defining the same resource twice
[2014-01-10 16:00:01 -0500] juliancdunn: and that the second time, it's gonna copy the attributes from the first declaration
[2014-01-10 16:00:42 -0500] sanguisdex: daxroc: I want to run the mysql cookbook version 3.0.12 and not 4.0.08 (both are on my server)
[2014-01-10 16:00:52 -0500] sanguisdex: within my runlist
[2014-01-10 16:01:05 -0500] juliancdunn: BriGuy: not easily
[2014-01-10 16:02:07 -0500] daxroc: sanguisdex: you could look at wrapper cookbooks. just to get it to install you could try cookbook::default@version  where version is in the form of 0.0.0
[2014-01-10 16:03:29 -0500] juliancdunn: sanguisdex: put your node into an environment that has the cookbook version constraint in it
[2014-01-10 16:03:39 -0500] juliancdunn: run lists don't have version constraints; environments do
[2014-01-10 16:04:03 -0500] BriGuy: juliancdunn: I didn't think so, I haven't found anything at all - is there any other way to have a centrally managed file be used as a template? Want my other admins to be able to make config changes w/o needing to know a lot about Chef.
[2014-01-10 16:04:18 -0500] daxroc: juliancdunn: can't you specify the version like above? or is that just hackish
[2014-01-10 16:04:32 -0500] juliancdunn: daxroc: it's hackish... don't do it :)
[2014-01-10 16:05:52 -0500] sanguisdex: juliancdunn: cheers thanks
[2014-01-10 16:06:03 -0500] juliancdunn: BriGuy: I can't think of a good way without some development work
[2014-01-10 16:06:19 -0500] juliancdunn: i.e. monkeypatching the template provider to take local files :0
[2014-01-10 16:08:19 -0500] BriGuy: juliancdunn: ok thanks, was hoping to keep all functionality within Chef and not shell out or something along those lines. Patching providers is outside my ambitions =)
[2014-01-10 16:08:24 -0500] BriGuy: juliancdunn: TY
[2014-01-10 16:16:32 -0500] BriGuy: Is there anyway to implement a timeout for the service resource? some services take a long time to start up and Chef errors on waiting.
[2014-01-10 16:19:36 -0500] juliancdunn: every resource has a 'timeout' attribute that you can set
[2014-01-10 16:21:25 -0500] paulczar: anyone know of a good cookbook for GlusterFS ?
[2014-01-10 16:22:32 -0500] BriGuy: juliancdunn: it is not specifically documented for the service resource in the opscode docs - is it just a "timeout" attribute then?
[2014-01-10 16:24:43 -0500] juliancdunn: just a sec, let me make sure I'm not wrong BriGuy :-)
[2014-01-10 16:25:51 -0500] BriGuy: sweet - TY - not sure if I am missing something, as it seems like it should be there
[2014-01-10 16:26:41 -0500] juliancdunn: hmm, looks like 'service' doesn't have timeout
[2014-01-10 16:27:42 -0500] BriGuy: so is the other option just the execute resource with a timeout, and shelling out the start command?
[2014-01-10 16:28:20 -0500] juliancdunn: yep... gross, but life is gross :)
[2014-01-10 16:30:30 -0500] BriGuy: I feel the same way about that... can you at least return an exit code to the Chef execute or bash resources?
[2014-01-10 16:32:39 -0500] BriGuy: * and then do something with it
[2014-01-10 16:37:41 -0500] noarthur: Hi. A little question from a chef noob. When I bootstrap a node without --bootstrap-version, my node is set up with an old chef-client (10.24.0) and I don't know why.
[2014-01-10 16:39:46 -0500] bean: noarthur: likely your chef version on your local machine
[2014-01-10 16:40:41 -0500] AntelopeSalad: is there a way to access the cookbook name as an attribute? i couldn't find anything in the docs
[2014-01-10 16:41:49 -0500] noarthur: bean : 11.8.2
[2014-01-10 16:41:59 -0500] bean: hmm, then im not sure
[2014-01-10 16:42:42 -0500] noarthur: I may have a hint, probably a problem with my ruby/gem version
[2014-01-10 16:43:32 -0500] savant: Hi all
[2014-01-10 16:43:37 -0500] savant: where do I go to get a pr merged?
[2014-01-10 16:43:43 -0500] savant: i think the merge window is today, right?
[2014-01-10 16:50:01 -0500] notromda: Well I have a cookbook recipe done and works great on my vagrant machine.   Time to try it on a production environment.   I have a new rackspace server set up, I have ssh access with sudo time to bootstrap.
[2014-01-10 16:57:20 -0500] shlant1: anyone know how best to check if a package was installed or upgraded
[2014-01-10 16:57:53 -0500] shlant1: I only want to restart a service if the package was changed
[2014-01-10 16:58:29 -0500] chefuser012: hello! i have yum_package working in a recipe,.. what is the best way to go about checking 60 packages? is there a for_each kind of thing in chef?
[2014-01-10 17:00:08 -0500] shlant1: chefuser012: you could have an array and then pass it into the resource using %w{#{array}.each do |package|
[2014-01-10 17:00:19 -0500] gchristensen: shlant1: use notifications
[2014-01-10 17:00:52 -0500] shlant1: chefuser012: %w{#{array}}.each do |package|
[2014-01-10 17:01:48 -0500] chefuser012: shlant1: excellent. but where in the recipe do i put that? i have yum_package "net-snmp-perl" do         action :install         not_if "rpm -qa | grep net-snmp-perl"  end
[2014-01-10 17:03:07 -0500] chefuser012: do i enclose the yum_package in this array loop? then call out the variable in the yum_package line, and grep line?
[2014-01-10 17:03:26 -0500] chefuser012: to -- you know, check to make sure each package isnt installed before installing it?
[2014-01-10 17:03:57 -0500] chefuser012: im surprised i cant find an example of anyone doing this. does no one else require lots of packages? so strange.
[2014-01-10 17:04:34 -0500] cheeseplus: chefuser012: usually there are individual cookbooks handling not only the install but configuration
[2014-01-10 17:05:20 -0500] shlant1: %w{#{array}}.each do |package|
[2014-01-10 17:05:21 -0500] shlant1:   yum_package "#{package}"
[2014-01-10 17:05:21 -0500] shlant1:     :action install
[2014-01-10 17:05:21 -0500] shlant1:   not_if...
[2014-01-10 17:05:22 -0500] shlant1:   end
[2014-01-10 17:05:22 -0500] shlant1: end
[2014-01-10 17:05:37 -0500] sneak: hi
[2014-01-10 17:05:56 -0500] sneak: is there an option i can put on a file resource to make it mkdir -p the parent? i'm getting Chef::Exceptions::EnclosingDirectoryDoesNotExist and it's stupid
[2014-01-10 17:06:21 -0500] chefuser012: shlant1: wonderful. just what i need
[2014-01-10 17:07:17 -0500] shlant1: chefuser012: I don't think you need :action install as it's deaful;t
[2014-01-10 17:07:20 -0500] shlant1: default
[2014-01-10 17:07:23 -0500] cheeseplus: sneak: the directory resource has a recursive option: http://docs.opscode.com/resource_directory.html
[2014-01-10 17:07:50 -0500] sneak: i'm creating files
[2014-01-10 17:07:51 -0500] sneak: not directories
[2014-01-10 17:08:00 -0500] sneak: do i have to have a separate directory resource?!
[2014-01-10 17:08:16 -0500] chefuser012: shlant1: noted. thanks much.
[2014-01-10 17:08:18 -0500] shlant1: %w{#{pkg1, pkg2}}.each do |package|
[2014-01-10 17:08:19 -0500] shlant1:  yum_package "#{package}" do
[2014-01-10 17:08:19 -0500] shlant1:   :action install
[2014-01-10 17:08:19 -0500] shlant1:  not_if...
[2014-01-10 17:08:19 -0500] shlant1:  end
[2014-01-10 17:08:20 -0500] shlant1: end
[2014-01-10 17:08:22 -0500] shlant1: syntax fix
[2014-01-10 17:08:42 -0500] shlant1: you could pass in an attribute that
[2014-01-10 17:08:52 -0500] shlant1: 's an array but I don't think that's advised
[2014-01-10 17:09:04 -0500] shlant1: due to merge confusion
[2014-01-10 17:09:24 -0500] cheeseplus: sneak: it's only 3 loc but I don't see any recursive options on the file
[2014-01-10 17:09:44 -0500] shlant1: chefuser012: see https://coderanger.net/2013/06/arrays-and-chef/
[2014-01-10 17:10:00 -0500] shlant1: not really an issue if you're not overriding the array
[2014-01-10 17:10:15 -0500] chefuser012: shlant1: whats the rule on multiline arrays? can i just end the line at a comma, and go to the next, or do i have to backslash..?
[2014-01-10 17:10:16 -0500] sneak: cheeseplus: the problem is that i have several resources in different files that depend on it, and it's 3loc in each of them and i'd prefer to not repeat the code
[2014-01-10 17:10:33 -0500] chefuser012: 60 packages not going to fit on one line
[2014-01-10 17:10:36 -0500] chefuser012: and be readable
[2014-01-10 17:10:44 -0500] notromda: Is there a point to using knife bootstrap when I already have a login on a server, or should I just log in and install chef omnibus?
[2014-01-10 17:11:21 -0500] cheeseplus: notromda: with bootstrap it puts your keys and such in place automatically
[2014-01-10 17:11:34 -0500] cheeseplus: assuming your local workstation is already configured
[2014-01-10 17:11:51 -0500] shlant1: chefuser012: %w{item1
[2014-01-10 17:11:54 -0500] shlant1: oops
[2014-01-10 17:12:01 -0500] shlant1: just have each item on a new line
[2014-01-10 17:12:06 -0500] shlant1: and then .split(/\n/)
[2014-01-10 17:12:16 -0500] shlant1: .split(/\n/).each
[2014-01-10 17:12:18 -0500] shlant1: i thinkl
[2014-01-10 17:12:30 -0500] cheeseplus: sneak: can you not just have a recipe create all the desired directories?
[2014-01-10 17:12:41 -0500] sneak: obviously that's what i have to do
[2014-01-10 17:12:47 -0500] sneak: i can do any of it
[2014-01-10 17:13:09 -0500] cheeseplus: ah, ok - I've always just lived with it but others may have a more elegant solution
[2014-01-10 17:13:11 -0500] sneak: but it would be a lot nicer to have an option for a file resource that creates it if it doesn't exist
[2014-01-10 17:16:45 -0500] shlant1: chefuser012: don't take my word for it on the new line thing. :p
[2014-01-10 17:17:13 -0500] chefuser012: heh. no prob. thanks for the info.
[2014-01-10 17:18:18 -0500] _sp0k_: hello!
[2014-01-10 17:31:03 -0500] chef0123: http://docs.opscode.com/essentials_cookbook_recipes.html#loop-over-array shows how to "loop over an array",.. so i made an array and tried to loop over it, according to this chef document.
[2014-01-10 17:31:05 -0500] chef0123: ['this', 'that'].each do |package|         yum_package "#{package}"                 :action install                 not_if "rpm -qa | grep #{package}"         end  end
[2014-01-10 17:31:40 -0500] chef0123: which gives this error syntax error, unexpected tIDENTIFIER, expecting keyword_end
[2014-01-10 17:31:51 -0500] chef0123: so, which part of that example didnt i get right?
[2014-01-10 17:35:30 -0500] cheeseplus: chef0123: one too many ends?
[2014-01-10 17:36:07 -0500] chef0123: cheeseplus:same result
[2014-01-10 17:36:07 -0500] CPS: chef0123: i believe each,  yum_package, and if all need ends
[2014-01-10 17:36:17 -0500] cheeseplus: chef0123: also, it's much easier to read if you could put it in a gist/pastebin
[2014-01-10 17:37:00 -0500] chef0123: here you are:
[2014-01-10 17:37:01 -0500] chef0123: http://pastebin.com/eHt8z1Fg
[2014-01-10 17:37:14 -0500] chef0123: adding, deleting additional 'end's does nothing.
[2014-01-10 17:37:45 -0500] gsandie: chef0123:  missing a do at the end of "yum_package" line
[2014-01-10 17:38:18 -0500] chef0123: syntax error, unexpected tIDENTIFIER, expecting keyword_end (this is with 0 ends, 1 end, 2 ends, 3 ends, 4 ends)
[2014-01-10 17:38:26 -0500] chef0123: ahh.
[2014-01-10 17:41:27 -0500] chef0123: no luck. same error
[2014-01-10 17:41:46 -0500] shlant: chef0123: ['this', 'that'].each do |package| should be #{'this', 'that'}.each do |package|
[2014-01-10 17:41:54 -0500] shlant: nope
[2014-01-10 17:42:06 -0500] shlant: %w{'this', 'that'}.each do |package|
[2014-01-10 17:42:41 -0500] chef0123: http://docs.opscode.com/essentials_cookbook_recipes.html#loop-over-array is this documentation incorrect?
[2014-01-10 17:42:50 -0500] shlant: %w{this, that}.each do |package|
[2014-01-10 17:42:50 -0500] JayF: shlant: ['foo', 'bar'] ~= %w{foo bar}
[2014-01-10 17:43:10 -0500] JayF: shlant: %w{"foo", "bar"} will return array ['"foo",', '"bar"']
[2014-01-10 17:43:56 -0500] shlant: jayF: didn't know those were equivalent, good to know
[2014-01-10 17:44:17 -0500] JayF: yeah, %w{} is just shorthand for making an array without having to worry about escaping/quoting
[2014-01-10 17:44:46 -0500] JayF: if you wanna play with it some, just load up irb and type in the different syntaxes and hit enter, and it'll show what the interpreter returns
[2014-01-10 17:45:38 -0500] chef0123: i actually just want to trust the chef documentation to work. i dont see mention of this %w thing anywhere.
[2014-01-10 17:45:45 -0500] allaire: Is nit normal that when an attribute is wrapped by some ohai conditions, that in my wrapper cookbook I also have to wrap the default attribute within the same ohai attr condition? ie. https://gist.github.com/allaire/67fd94eca1763e9402d9
[2014-01-10 17:46:01 -0500] c_t: %w{} isn't a chef thing as such, it's a ruby thing
[2014-01-10 17:46:53 -0500] chef0123: ah. excellent.
[2014-01-10 17:47:12 -0500] chef0123: so googling 'ruby loop array' will benefit me more than 'chef recipe loop array'
[2014-01-10 17:47:22 -0500] c_t: yes
[2014-01-10 17:47:27 -0500] chef0123: noted. thanks for the pointers!
[2014-01-10 17:49:06 -0500] shawn_sher: "Just enough ruby for chef" is nowhere near enough
[2014-01-10 17:50:39 -0500] chef0123: that still doenst work: http://paste.ubuntu.com/6727860/
[2014-01-10 17:50:48 -0500] chef0123: recipes/default.rb:3: syntax error, unexpected tIDENTIFIER, expecting keyword_end
[2014-01-10 17:51:16 -0500] chef0123: ive tried it with do at the end of the yum statement as well
[2014-01-10 17:51:55 -0500] chef0123: has anyone ever used an array successfully in a chef recipe? am i trying to do somethign that isnt supported as such?
[2014-01-10 17:52:36 -0500] c_t: possibly relevant
[2014-01-10 17:52:46 -0500] c_t: you don't need the comma in this, that
[2014-01-10 17:53:29 -0500] notromda: yes, the point of %w is that you don't need the comma, it works on whitespace
[2014-01-10 17:53:49 -0500] notromda: if you feel more comfortable, use ["this","that"]
[2014-01-10 17:53:59 -0500] c_t: that should totally work though
[2014-01-10 17:54:05 -0500] notromda: and yum_package needs a do
[2014-01-10 17:54:10 -0500] workmad3: chef0123: 'yum_package "name" do'
[2014-01-10 17:54:17 -0500] workmad3: heh, notromda beat me to it :)
[2014-01-10 17:54:23 -0500] c_t: https://gist.github.com/ctdk/8359172
[2014-01-10 17:54:33 -0500] notromda: you have more ends than dos
[2014-01-10 17:54:36 -0500] workmad3: chef0123: what you're getting there is an error from having more 'end's than you have 'do's
[2014-01-10 17:54:41 -0500] workmad3: notromda: gah :P
[2014-01-10 17:55:11 -0500] notromda: Hey - I'm newb at chef, but ruby is my thing. :D
[2014-01-10 17:55:34 -0500] workmad3: notromda: why aren't you in #ruby then? :P
[2014-01-10 17:55:46 -0500] workmad3: notromda: or #ruby-lang? :)
[2014-01-10 17:56:16 -0500] notromda: cause I don't need help with it? lol
[2014-01-10 17:56:24 -0500] chef0123: workmad3: ive tried multiple combinations of ends, do's and such. how would you suggest fixing it?
[2014-01-10 17:56:33 -0500] workmad3: pfft, I don't sit in those channels because *I* need help
[2014-01-10 17:56:47 -0500] workmad3: I sit there because other people do... and I enjoy conversations about AI :)
[2014-01-10 17:56:51 -0500] chef0123: also tried these array examples http://ruby.learncodethehardway.org/book/ex32.html which do not work
[2014-01-10 17:56:52 -0500] c_t: as others said, yum_package needs a do
[2014-01-10 17:57:01 -0500] chef0123: tried that as well.
[2014-01-10 17:57:01 -0500] c_t: look at that gist I pasted in
[2014-01-10 17:57:12 -0500] notromda: I haven't been in irc for quite a while.. and Ihaven't even been able to follow all the conversation here. lol
[2014-01-10 17:57:16 -0500] workmad3: chef0123: you need a 'do' on the yum_package to get rid of the syntax error
[2014-01-10 17:57:16 -0500] c_t: doesn't use yum_package, but it should get the point across
[2014-01-10 17:57:32 -0500] workmad3: chef0123: and you need to drop the , in the %w array, otherwise you're trying to install the package 'this,'
[2014-01-10 17:57:36 -0500] workmad3: chef0123: rather than 'this'
[2014-01-10 17:58:14 -0500] workmad3: chef0123: you can also drop the "#{package}" in favour of 'yum_package package do'
[2014-01-10 17:58:45 -0500] workmad3: chef0123: and I'd suggest you use 'pkg' rather than 'package' as the variable name (otherwise you shadow the more general 'package' resource
[2014-01-10 17:58:48 -0500] workmad3: )
[2014-01-10 17:58:55 -0500] notromda: also, I'm not sure this will work:  not_if "rpm -qa | grep #{package}"
[2014-01-10 17:59:02 -0500] notromda: rpm is a shell command
[2014-01-10 17:59:04 -0500] workmad3: yeah, I'm pretty sure you don't need that
[2014-01-10 17:59:17 -0500] notromda: do not_if run shell commands, or does it need to be a block?
[2014-01-10 17:59:25 -0500] workmad3: notromda: if it's a string, it's a shell command
[2014-01-10 17:59:32 -0500] workmad3: notromda: block - ruby code
[2014-01-10 17:59:35 -0500] notromda: ah, cook
[2014-01-10 17:59:37 -0500] notromda: cool
[2014-01-10 17:59:57 -0500] chef0123: thanks all. ive added all suggestions. and it doesnt work.
[2014-01-10 17:59:58 -0500] chef0123: http://paste.ubuntu.com/6727893/
[2014-01-10 18:00:04 -0500] workmad3: notromda: so 'not_if "test -e some_file" ' and 'not_if { ::File.exists?("some_file")' are equivalent :)
[2014-01-10 18:00:08 -0500] chef0123: any other ideas?
[2014-01-10 18:00:12 -0500] notromda: Oh yes, change the package - if it tries to run the package function in the string, that could do weird things
[2014-01-10 18:00:29 -0500] workmad3: chef0123: oh, also, it's 'action :install' not ':action install'
[2014-01-10 18:01:28 -0500] shawn_sher: I think that using double quotes for the "rpm -qa | grep #{package}" make it a string which always evaluates to true
[2014-01-10 18:01:33 -0500] notromda: action :install
[2014-01-10 18:01:34 -0500] workmad3: shawn_sher: no
[2014-01-10 18:01:38 -0500] chef0123: hooray!
[2014-01-10 18:01:39 -0500] notromda: ah beat me to it
[2014-01-10 18:01:42 -0500] workmad3: shawn_sher: it makes it a string that does interpolation
[2014-01-10 18:01:43 -0500] chef0123: action :install it is.
[2014-01-10 18:01:56 -0500] chef0123: thank you both
[2014-01-10 18:02:06 -0500] workmad3: chef0123: you really don't need that not_if though
[2014-01-10 18:02:07 -0500] shawn_sher: Yeah, it's interpolated
[2014-01-10 18:02:17 -0500] workmad3: chef0123: yum_package already does an existence check ;)
[2014-01-10 18:02:20 -0500] notromda: final result
[2014-01-10 18:02:21 -0500] notromda: https://gist.github.com/dgm/8359337
[2014-01-10 18:02:28 -0500] shawn_sher: I'm saying that the string evaluates to true, and no command is run
[2014-01-10 18:02:34 -0500] workmad3: shawn_sher: no
[2014-01-10 18:03:01 -0500] chef0123: cool. even better.
[2014-01-10 18:03:02 -0500] shawn_sher: boolean-wise
[2014-01-10 18:03:17 -0500] workmad3: shawn_sher: I mean, yes the string is truthy (as is anything other than false and nil in ruby) but no - not_if takes a string or a block, it doesn't take a boolean
[2014-01-10 18:03:22 -0500] shawn_sher: if "foobar" will be treated as true is what I mean
[2014-01-10 18:03:29 -0500] workmad3: shawn_sher: if it gets a string, it shells out and runs the string as a command
[2014-01-10 18:03:50 -0500] workmad3: shawn_sher: if it gets a block, it calls the block and uses the result as a boolean to determine if to run or not
[2014-01-10 18:04:33 -0500] workmad3: shawn_sher: and not_if isn't the same as an 'if' keyword ;)
[2014-01-10 18:04:40 -0500] notromda: some style tips, chef0123:
[2014-01-10 18:04:42 -0500] notromda: %w()  or %w{} or %w|| ... you can change the characters used to delineate the list.   %() is most common.
[2014-01-10 18:04:57 -0500] shawn_sher: Yeah, it's a function
[2014-01-10 18:05:02 -0500] notromda: look at my gist for reference
[2014-01-10 18:05:13 -0500] notromda: use pkg and not "#{pkg}"
[2014-01-10 18:05:31 -0500] notromda: there's no need for interpolation if it is the only thing in the string
[2014-01-10 18:05:33 -0500] workmad3: shawn_sher: method in ruby parlance (because it's on an object... ruby only has methods, not functions :) )
[2014-01-10 18:05:47 -0500] chef0123: very nice. great tips.
[2014-01-10 18:05:51 -0500] notromda: and use 2 space indents
[2014-01-10 18:06:17 -0500] shawn_sher: fair enough
[2014-01-10 18:06:22 -0500] workmad3: chef0123: also, :install is the default action for yum_package... as such, you can just do 'yum_package pkg' with no block
[2014-01-10 18:07:16 -0500] sbrink: workmad3: i'm at the tail end of this ... why not just package and let the os sort out the package installer
[2014-01-10 18:07:18 -0500] chef0123: awesome. my script is getting smaller and smaller.
[2014-01-10 18:07:38 -0500] workmad3: sbrink: I'd just not gotten around to mentioning that yet :)
[2014-01-10 18:07:51 -0500] sbrink: chef0123: right but is it still readable by anyone wanting to look at it
[2014-01-10 18:08:22 -0500] chef0123: correct. i like that its getting smaller - that means its getting compact and correct.
[2014-01-10 18:08:41 -0500] chef0123: any hints on installing a cpan module from a recipe?
[2014-01-10 18:08:53 -0500] notromda: So the easiest way to do that whole script is %(this that).each {|p| yum_package p}
[2014-01-10 18:08:54 -0500] workmad3: chef0123: sbrink's point is that you can make things too compact and turn them into an unreadable one-liner
[2014-01-10 18:09:01 -0500] sbrink: and for th %w stuff keep in mind what ruby style guide will want as food critic likes %w()
[2014-01-10 18:09:02 -0500] workmad3: but that's not the case here, I think :)
[2014-01-10 18:09:11 -0500] chef0123: whew. thats good news.
[2014-01-10 18:09:24 -0500] workmad3: notromda: %(this that).each {|p| package p}
[2014-01-10 18:09:41 -0500] notromda: right
[2014-01-10 18:09:46 -0500] workmad3: although I do tend to prefer using a 3-line do/end block for iteration in recipes
[2014-01-10 18:09:58 -0500] notromda: cause that will work on contos or ubuntu
[2014-01-10 18:10:09 -0500] workmad3: assuming the package names are correct for both, yes
[2014-01-10 18:10:24 -0500] chef0123: which doesnt happen often in ubuntu/rhel
[2014-01-10 18:10:28 -0500] notromda: true
[2014-01-10 18:10:49 -0500] chef0123: i have my platform as rhel in this case.
[2014-01-10 18:10:54 -0500] sbrink: hey on ? on the gist
[2014-01-10 18:10:55 -0500] chef0123: because of the name differences.
[2014-01-10 18:10:56 -0500] workmad3: chef0123: yes, but you can then set the array as a node attribute based off the platform (or platform family) and not have to change the recipe for multi-platform support ;)
[2014-01-10 18:10:58 -0500] sbrink: the not_if line
[2014-01-10 18:11:11 -0500] sbrink: it's got the wrong var in the grep
[2014-01-10 18:11:21 -0500] workmad3: sbrink: the not_if is gone now
[2014-01-10 18:11:37 -0500] notromda: ARG.   I thought I was ready to run my new script on a server  and my sudo access is broken.
[2014-01-10 18:11:38 -0500] workmad3: sbrink: considering it was testing for if the package was installed, it was somewhat redundant :)
[2014-01-10 18:11:47 -0500] sbrink: oh i was looking at 8359337
[2014-01-10 18:11:49 -0500] notromda: I have to wait till someone with root can fix it.
[2014-01-10 18:12:02 -0500] workmad3: sbrink: not sure if chef0123 did a new pastie since removing it though
[2014-01-10 18:12:37 -0500] workmad3: anyway, I'm off now... time for food
[2014-01-10 18:12:38 -0500] chef0123: here yo uare http://paste.ubuntu.com/6727964/
[2014-01-10 18:12:44 -0500] chef0123: that works well
[2014-01-10 18:12:52 -0500] notromda: I updated https://gist.github.com/dgm/8359337
[2014-01-10 18:13:12 -0500] workmad3: chef0123: heh :) 'yum_package p' not 'yum_package "#{p}" ' :P
[2014-01-10 18:13:20 -0500] chef0123: have to remove that comma as well
[2014-01-10 18:13:32 -0500] notromda: arg
[2014-01-10 18:14:05 -0500] notromda: hows that
[2014-01-10 18:14:15 -0500] notromda: added the shorter version too
[2014-01-10 18:14:37 -0500] chef0123: perfect. works on my end.
[2014-01-10 18:14:41 -0500] sbrink: much as i hate one liners workmad3 nailed it wtih %(node[PKG_LIST]).each{ |the_pkg| package the_pkg}
[2014-01-10 18:15:36 -0500] sbrink: it's all thats needed and in the attributes have the line injected with your target specific package list
[2014-01-10 18:18:25 -0500] notromda: is the ubuntu paste adding those hideous tabs?
[2014-01-10 18:19:16 -0500] sbrink: notromda: ?hideous tabs?
[2014-01-10 18:19:46 -0500] notromda: 8 spaces instead of 2
[2014-01-10 18:20:53 -0500] notromda: ruby and chef style is 2 space indentation
[2014-01-10 18:40:45 -0500] teukka: 8 tabs
[2014-01-10 18:59:08 -0500] shlant: action :enable on a service is only so that the service is started when a reboot happens, right?
[2014-01-10 19:00:20 -0500] AntelopeSalad: i think i found a potential bug in chef, but i'm not sure -- normally you can access attributes as strings or symbols
[2014-01-10 19:00:55 -0500] AntelopeSalad: but when you load an encrypted databag you must use strings to access the properties, is this a bug/oversight or expected?
[2014-01-10 19:06:47 -0500] juliancdunn: if you use symbols, they are coerced to strings to start with
[2014-01-10 19:07:13 -0500] juliancdunn: so I wouldn't be surprised if it's just by design
[2014-01-10 19:07:26 -0500] AntelopeSalad: juliancdunn: yeah but if you access a property in an encrypted data bag as a symbol the return value is an empty string
[2014-01-10 19:08:35 -0500] juliancdunn: AntelopeSalad: that's because it's just a piece of JSON at that point
[2014-01-10 19:08:49 -0500] juliancdunn: at that point, :foo and 'foo' are two different things
[2014-01-10 19:09:18 -0500] AntelopeSalad: yeah but that seems pretty unexpected behavior to me, considering it has a to_hash method on it
[2014-01-10 19:09:29 -0500] AntelopeSalad: you would think it would react like the attributes hash?
[2014-01-10 19:09:56 -0500] juliancdunn: .to_hash is just a built in Ruby method; that's not gonna do type coercion on the keys
[2014-01-10 19:10:50 -0500] AntelopeSalad: but they overwrote to_hash specifically
[2014-01-10 19:11:09 -0500] AntelopeSalad: https://github.com/opscode/chef/blob/master/lib/chef/encrypted_data_bag_item.rb#L70
[2014-01-10 19:11:57 -0500] juliancdunn: does the same behavior happen for a non-encrypted data bag item? I'd say the two should be consistent
[2014-01-10 19:11:59 -0500] AntelopeSalad: the variable name even implies the data is a hash
[2014-01-10 19:12:05 -0500] AntelopeSalad: look at the initializer
[2014-01-10 19:12:32 -0500] juliancdunn: yeah but a hash need not have symbols as keys
[2014-01-10 19:12:39 -0500] AntelopeSalad: so if chef is going to convert symbols to strings for attributes (these are hashes right?), it would make sense for it to do it here but it doesn't
[2014-01-10 19:12:55 -0500] AntelopeSalad: i don't know about non-encrypted data bags, i never used one before
[2014-01-10 19:24:37 -0500] teukka: AntelopeSalad: chef uses its own Mash class for attribus. but data bags are raw data from json. so they are different things. but I guess nothing would stop using Mashes with data bag items too
[2014-01-10 19:25:12 -0500] teukka: attribus, attributes, omnibus, whatever =)
[2014-01-10 19:25:34 -0500] AntelopeSalad: ok, so it would be nice if they added it but it's technically not a bug?
[2014-01-10 19:26:16 -0500] teukka: well, data bags are not node attributes so *I* wouldn't consider as a bug. maybe a missing feature sure
[2014-01-10 19:26:39 -0500] teukka: still it seems that the 'key' strings are most recommended with node attributes too
[2014-01-10 19:26:59 -0500] AntelopeSalad: maybe i'm just too inexperienced still, i see it as "chef lets me use symbols for anything that looks like a hash, but it doesn't this for me for data bags"
[2014-01-10 19:28:31 -0500] teukka: AntelopeSalad: good that you didn't find the dot syntax ;)
[2014-01-10 19:30:05 -0500] AntelopeSalad: teukka: i did, but there was a good argument to not use it
[2014-01-10 19:30:12 -0500] AntelopeSalad: because you may run into names with a hyphen, etc.
[2014-01-10 19:30:34 -0500] teukka: AntelopeSalad: haha, good
[2014-01-10 19:30:56 -0500] AntelopeSalad: i like symbols because it's less typing, they are more efficient and they look cooler in my editor
[2014-01-10 19:31:43 -0500] tscanausa: is there a way to access specific data bag items without an each loop?
[2014-01-10 19:32:15 -0500] chef0123: when trying to bootstrap, i am getting an ERROR 404.  and also this: bash: line 83: chef-client: command not found
[2014-01-10 19:32:22 -0500] chef0123: anyone else seeing this? or just me
[2014-01-10 19:32:23 -0500] AntelopeSalad: tscanausa: if it works like encrypted data bags then yeah, you just load it and then you can do: my_bag['foo']
[2014-01-10 19:33:29 -0500] teukka: AntelopeSalad: btw, this should work ;)  node.my.send('nice-attr').with.hyphen
[2014-01-10 19:33:30 -0500] chef0123: full output here: http://paste.ubuntu.com/6728367/
[2014-01-10 19:33:44 -0500] AntelopeSalad: teukka: let's not get crazy now
[2014-01-10 19:34:48 -0500] tscanausa: AntelopeSalad: I have items = search('bag_name', "*:*") but it wont let me access anything via items['item1']
[2014-01-10 19:37:33 -0500] AntelopeSalad: tscanausa: i'm not sure about searching them, but here's how i'm reading a specific bag item https://gist.github.com/AntelopeSalad/8361067
[2014-01-10 19:37:46 -0500] AntelopeSalad: i would guess it's similar for non-encrypted bags but maybe not?
[2014-01-10 19:38:33 -0500] tscanausa: I would do, there just seems to be no documentation
[2014-01-10 19:40:27 -0500] teukka: chef0123: the prereleases are normally released as gems
[2014-01-10 19:40:47 -0500] tscanausa: AntelopeSalad: that worked, thanks
[2014-01-10 19:41:05 -0500] AntelopeSalad: np
[2014-01-10 19:41:16 -0500] teukka: chef0123: so if you want the prerelease version on the node you might need to use gems there too
[2014-01-10 19:41:41 -0500] teukka: chef0123: if you're fine with the released version, you can specify `--bootstrap-version` to `knife bootstrap`
[2014-01-10 19:41:42 -0500] chef0123: teukka: thanks. i bootstrapped over a hundred nodes fine, and this one is giving me issues. how do i fix it?
[2014-01-10 19:41:50 -0500] chef0123: teukka: ah.
[2014-01-10 19:42:22 -0500] chef0123: what argument should i use in that case?
[2014-01-10 19:42:30 -0500] teukka: chef0123: `knife bootsrtap` uses by default the same version than your workstation. did you upgrade your knife recently?
[2014-01-10 19:42:41 -0500] chef0123: no
[2014-01-10 19:42:56 -0500] chef0123: it was within minutes that this happened from a previously working knife.
[2014-01-10 19:43:01 -0500] chef0123: no updates.
[2014-01-10 19:43:23 -0500] teukka: chef0123: oh, really... then maybe it *was* released as a omnibus package too. dunno
[2014-01-10 19:43:39 -0500] teukka: chef0123: do the other nodes have the alpha version now?
[2014-01-10 19:44:04 -0500] chef0123: no. 11.8.2
[2014-01-10 19:44:35 -0500] chef0123: knife bootstrap hostname.com --bootstrap-version 11.8.2
[2014-01-10 19:44:37 -0500] chef0123: that worked
[2014-01-10 19:44:46 -0500] teukka: chef0123: well, now your workstation has the 11.10.0.alpha.1
[2014-01-10 19:44:46 -0500] chef0123: unsure why its tring to install a dif version now.
[2014-01-10 19:44:58 -0500] chef0123: wonderful
[2014-01-10 19:45:04 -0500] chef0123: any way to roll that back?
[2014-01-10 19:46:15 -0500] teukka: chef0123: check `which knife` and `knife --version`. and `gem list chef`
[2014-01-10 19:46:44 -0500] teukka: chef0123: gem uninstall chef --version 11.10.0.alpha.1
[2014-01-10 19:46:47 -0500] teukka: probably
[2014-01-10 19:51:37 -0500] notromda: when setting up a server to use chef client, what is common - a personal user account with sudo access, or a role "chef" user with sudo access?   I assume not root?
[2014-01-10 19:54:26 -0500] Liquid--: hello, I have the following custom service that I have created and it seems to be running ever time chef-client runs...does adding :restart => true tell it that it's okay for chef-client to restart the service when it runs?
[2014-01-10 19:54:27 -0500] Liquid--: service "my-service" do
[2014-01-10 19:54:27 -0500] Liquid--:   supports :status => true, :restart => true
[2014-01-10 19:54:29 -0500] Liquid--:   action :enable
[2014-01-10 19:54:29 -0500] Liquid--: end
[2014-01-10 19:55:36 -0500] Liquid--: I thought enable just told it to throw it in the start scripts at boot...and then the support statement just gave it the ability to respond to those parameters. Is there something that I'm missing?
[2014-01-10 19:56:15 -0500] chef0123: hello! what does this mean in chef-client output: WARN: Cloning resource attributes for yum_package[net-snmp-perl] from prior resource (CHEF-3694)
[2014-01-10 19:58:21 -0500] juliancdunn: chef0123: it means you've already declared that resource somewhere else and you're redeclaring it
[2014-01-10 20:00:55 -0500] zilla2: I assume this is a stupid question but I have a directory resource with an explicit user/group and on chef 10 it worked great but in chef 11 the ownership never gets set.  Even if I delete the directory and let chef create it, it still is owned by root:root
[2014-01-10 20:00:59 -0500] zilla2: any insight?
[2014-01-10 20:01:35 -0500] AntelopeSalad: zilla2: can you gist it?
[2014-01-10 20:01:47 -0500] AntelopeSalad: i just setup a directory with chef 11.x and the ownership is correct
[2014-01-10 20:03:17 -0500] zilla2: https://gist.github.com/anonymous/8361572
[2014-01-10 20:03:36 -0500] rep0st: ohai chefs. was wondering if there's a way to search for a specific version of a cookbook in use by a node via knife?
[2014-01-10 20:03:43 -0500] zilla2: the reason I use ID's instead of usernames is because they are LDAP accounts and dont exist at bootstrap time
[2014-01-10 20:03:54 -0500] rep0st: i tried knife search recipes:mycookbook@1.0.0 which doesn't seem tow rok
[2014-01-10 20:04:06 -0500] AntelopeSalad: zilla2: hmm, my setup looks the same except i'm using usernames but it shouldn't matter
[2014-01-10 20:10:12 -0500] zilla2: dammit.  just changed it to username instead of ID and it worked
[2014-01-10 20:10:17 -0500] zilla2: this is not good :)
[2014-01-10 20:13:01 -0500] AntelopeSalad: zilla2: i guess that's good, because now you know it's not a chef 11.x issue
[2014-01-10 20:13:13 -0500] AntelopeSalad: unless the ids worked in 10.x?
[2014-01-10 20:17:08 -0500] zilla2: yeah the ID's work in 10 for sure.  ive been using this cookbook forever
[2014-01-10 20:17:29 -0500] zilla2: I can work around it, but it just surprises me that it completely ignores those fields
[2014-01-10 20:19:16 -0500] AntelopeSalad: yeah i dunno, i never used IDs before but that sounds like something that would have hanged me up for half a day
[2014-01-10 20:19:54 -0500] zilla2: lol not quite that long here but close
[2014-01-10 20:23:53 -0500] shlant: is there a better way to do this?
[2014-01-10 20:23:53 -0500] shlant: %w{#{node["git"]["repo"]}}.each do |repo|
[2014-01-10 20:30:10 -0500] cwj: shlant: is node[git][repo] expected to be a string or an array?
[2014-01-10 20:30:39 -0500] cwj: either way i think youve got some redundancy going on there
[2014-01-10 20:31:36 -0500] shlant: its a list of repos seperated by a space
[2014-01-10 20:31:48 -0500] shlant: so a string
[2014-01-10 20:31:56 -0500] shlant: would array be better?
[2014-01-10 20:32:04 -0500] cwj: you can probably lose the #{} then
[2014-01-10 20:32:13 -0500] cwj: er actually, no you cant
[2014-01-10 20:32:48 -0500] cwj: theres a case to be made for avoiding using arrays in chef node attributes
[2014-01-10 20:32:55 -0500] cwj: e.g. https://coderanger.net/2013/06/arrays-and-chef/
[2014-01-10 20:33:02 -0500] shlant: yea i actually read that today haah
[2014-01-10 20:33:10 -0500] shlant: so maybe what I have is best?
[2014-01-10 20:33:22 -0500] shlant: it just seemed gross to look at
[2014-01-10 20:33:48 -0500] cwj: adding some spaces might make it easier to read :)
[2014-01-10 20:35:05 -0500] shawn_sher: that looks gross to me too
[2014-01-10 20:35:57 -0500] shawn_sher: The article I mean
[2014-01-10 20:39:32 -0500] shawn_sher: I think unioning the arrays together is about all you can do, but I can see where you'd get tricked pretty easily if you didn't know where all the overrides were being done.
[2014-01-10 20:43:38 -0500] masterkorp: How do I ser attriutes from recipes
[2014-01-10 20:44:04 -0500] MrHeavy: masterkorp: You know about precedence levels?
[2014-01-10 20:44:14 -0500] MrHeavy: default, normal, override, etc?
[2014-01-10 20:44:34 -0500] masterkorp: MrHeavy: hmm, yes, i want to set the attribute upon an action
[2014-01-10 20:44:49 -0500] masterkorp: background: I initialize a database of service
[2014-01-10 20:44:56 -0500] masterkorp: but only on firt run
[2014-01-10 20:45:14 -0500] masterkorp: and I want the attribute to prevail between runs
[2014-01-10 20:45:16 -0500] MrHeavy: node.set[:my_cookbook][:database_initialized] = true
[2014-01-10 20:45:25 -0500] MrHeavy: (.set is an alias for .normal)
[2014-01-10 20:45:39 -0500] gabemc_: Hey, I have a question about `node.automatic_attrs`: What the hell are they and how do I set them?
[2014-01-10 20:45:44 -0500] MrHeavy: That will get stored with your node data, assuming you're using Chef Server
[2014-01-10 20:46:05 -0500] MrHeavy: I'm having a problem where ignore_failure on a service is not really ignoring failures, and it's just aborting my run. Anyone have any ideas?
[2014-01-10 20:46:25 -0500] gabemc_: I can't seem to get `node.automatic_attrs['nginx']['version']` to not be nil.
[2014-01-10 20:46:52 -0500] masterkorp: MrHeavy: thank you sir
[2014-01-10 20:47:28 -0500] MrHeavy: gabemc_, automatic_attrs are set by Ohai and you don't manipulate them directly
[2014-01-10 20:47:36 -0500] MrHeavy: You want to override them using one of the normal attribute precedence levels
[2014-01-10 20:48:05 -0500] gabemc_: MrHeavy: I've tried 'node.set' 'node.override' -- all to no effect.
[2014-01-10 20:48:13 -0500] MrHeavy: Got a gist?
[2014-01-10 20:48:54 -0500] MrHeavy: If you node.set[:something] = "butt", abort node[:something].inspect right after to make sure the attribute's what you expect when it's queried back
[2014-01-10 20:49:13 -0500] gabemc_: I'm working on a tengine wrapper cookbook around the nginx cookbook. So, what I'm really looking at is: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L106-L109
[2014-01-10 20:49:34 -0500] gabemc_: I can't keep it from recompiling from source each time.
[2014-01-10 20:49:53 -0500] gabemc_: I think it's that the node.automatic_attrs['version'] is set to nil each time.
[2014-01-10 20:50:56 -0500] MrHeavy: So you don't want to be looking there
[2014-01-10 20:51:02 -0500] MrHeavy: You can't update that outside of Ohai
[2014-01-10 20:51:11 -0500] MrHeavy: You need to figure out why Ohai is returning different values from what you expect
[2014-01-10 20:51:17 -0500] gabemc_: Oy.
[2014-01-10 20:51:28 -0500] alxism: hi there,
[2014-01-10 20:51:29 -0500] alxism: I have a cookbook which name contains underscore, foo_bar, and a resource, deploy.
[2014-01-10 20:51:29 -0500] alxism: the resource "DSL name" will be "foo_bar_deploy" , but what is the corresponding class name? Chef::Resource::FooBarDeploy, ::FoobarDeploy ?
[2014-01-10 20:51:45 -0500] alxism: I can't make rspec happy
[2014-01-10 20:52:12 -0500] gabemc_: That sounds like a serious amount of time to invest. I know little about Ohai. Is it parsing the version string returned by nginx? How is it getting that data?
[2014-01-10 20:53:09 -0500] MrHeavy: https://github.com/opscode-cookbooks/nginx/blob/master/templates/default/plugins/nginx.rb.erb#L47
[2014-01-10 20:53:29 -0500] MrHeavy: It's calling nginx -V, where nginx is node['nginx']['binary']
[2014-01-10 20:54:18 -0500] MrHeavy: First, make sure you actually have that plugin loaded
[2014-01-10 20:54:31 -0500] MrHeavy: Check ohai on the node and make sure you see an nginx key
[2014-01-10 20:54:51 -0500] MrHeavy: So, anyone have any ideas about my ignore_failure problem?
[2014-01-10 20:54:52 -0500] gabemc_: MrHeavy: Thanks very much. I'll take a look.
[2014-01-10 20:55:54 -0500] jidar: is there any way to tell how a erb will render on a node?
[2014-01-10 21:02:59 -0500] btm: Cookbook Code Review: Join: bit.ly/1aetYDd watch: bit.ly/1aetWvb
[2014-01-10 21:04:33 -0500] sb-: is there a way to have recipes run in a specific order within calling them from a recipe not a runlist?
[2014-01-10 21:05:34 -0500] AntelopeSalad: sb-: the cases i've used them they were executed in order
[2014-01-10 21:05:53 -0500] sb-: with include_recipe?
[2014-01-10 21:06:04 -0500] AntelopeSalad: yeah
[2014-01-10 21:06:07 -0500] MrHeavy: jidar: That depends on an awful lot of things and the short answer is "it really depends on the template"
[2014-01-10 21:06:24 -0500] MrHeavy: The template can execute whatever random Ruby it wants and hook into the Chef runtime state in lots of weird ways
[2014-01-10 21:06:39 -0500] AntelopeSalad: i have a default recipe file that includes other recipes and when the machine provisions it seems to go in order from top to bottom
[2014-01-10 21:07:28 -0500] jidar: MrHeavy: I was really hoping I could just open up the chef-shell, become_node and determine how it would render
[2014-01-10 21:08:37 -0500] jidar: well, haha, I suppose become_node would have to work at all for that to happen :/
[2014-01-10 21:08:59 -0500] jidar: :windows => fail
[2014-01-10 21:10:56 -0500] sb-: AntelopeSalad
[2014-01-10 21:11:03 -0500] sb-: looks like
[2014-01-10 21:11:04 -0500] sb-: node.default['build_essential']['compiletime'] = true
[2014-01-10 21:11:09 -0500] sb-: is the needful
[2014-01-10 21:12:37 -0500] AntelopeSalad: hmm?
[2014-01-10 21:28:18 -0500] CPS: is there a shorthand way to get a recipe's files directory path?
[2014-01-10 21:36:30 -0500] markp1: if you make write some module in a cookbook's library ....
[2014-01-10 21:36:49 -0500] markp1: what is the ideal way to call the functions in those modules?
[2014-01-10 21:40:54 -0500] notromda: Cookbook 'mysql' (4.0.18) does not contain a file at any of these locations:
[2014-01-10 21:41:08 -0500] notromda: This worked on my local vagrant, but fails on rackspace
[2014-01-10 21:41:12 -0500] scalp42: hey folks, how can I require a gem in a LWRP ?
[2014-01-10 21:41:34 -0500] masterkorp: Guys, on test-kitchen i have the following recipe http://pastie.org/private/fep1linvqkr46tm1dlkk9q on the last block, the it seems to run every converge
[2014-01-10 21:42:07 -0500] scalp42: if anyone has an idea, thanks in advance
[2014-01-10 21:42:07 -0500] masterkorp: is this a test-kitchen problem or it will happen on chef server too ?
[2014-01-10 21:42:49 -0500] masterkorp: scalp42: you can require it on the cookbook it self
[2014-01-10 21:42:53 -0500] jidar: anybody bootstraping ec2 instances that are in autoscale with chef?
[2014-01-10 21:43:14 -0500] scalp42: mmh I have a provider with 'require my_gem'
[2014-01-10 21:43:25 -0500] scalp42: it blows up because my node doesnt get a chance to converge
[2014-01-10 21:43:49 -0500] scalp42: I've looked at http://opscode.biz/sympa/arc/chef-dev/2013-05/msg00006.html
[2014-01-10 21:44:01 -0500] scalp42: but doesnt help much, cant include twice my recipe
[2014-01-10 21:46:13 -0500] notromda: Is the mysql cookbook broken?  https://gist.github.com/dgm/7ee4f6a8eb32a52641c2
[2014-01-10 21:46:32 -0500] scalp42: masterkorp could you explain ? do you mean chef_gem my_gem in the recipe?
[2014-01-10 21:46:50 -0500] masterkorp: i would use chef_gem
[2014-01-10 21:47:08 -0500] scalp42: but I dont even have a chance to get to this, because the provider gets loaded before the recipes
[2014-01-10 21:47:12 -0500] masterkorp: well i have no idea how to solve that
[2014-01-10 21:47:16 -0500] masterkorp: but i would try it
[2014-01-10 21:47:20 -0500] scalp42: if it makes sense
[2014-01-10 21:47:55 -0500] masterkorp: chef does a resource collection pre run
[2014-01-10 21:48:03 -0500] masterkorp: chef_gem goes into that
[2014-01-10 21:48:08 -0500] masterkorp: might worth a try
[2014-01-10 21:48:17 -0500] masterkorp: btw any help on mine ?
[2014-01-10 21:51:42 -0500] kebabski: Hi, what's the best way to exist a chef-run without it being an error/raise/fatal type?
[2014-01-10 21:52:42 -0500] rbattula: kebabski some resources (eg. execute) have a 'returns' directive. you can look for that type of thing for whatever you are working with
[2014-01-10 21:54:00 -0500] kebabski: err.. my bad on *exist*. I mean *Exit*
[2014-01-10 21:54:50 -0500] rbattula: I figured :)
[2014-01-10 21:58:38 -0500] kebabski: rbattula, got a sample code? I've tried anything I could find and still not getting a good exit for chef-run
[2014-01-10 21:59:01 -0500] notromda: looks like a bug in the mysql cookbook.
[2014-01-10 21:59:02 -0500] notromda: https://github.com/opscode-cookbooks/mysql/pull/147
[2014-01-10 22:00:19 -0500] notromda: how can I get that included?
[2014-01-10 22:00:50 -0500] rbattula: kebabski unfortunately not, but refer to the chef docs for a particular resource
[2014-01-10 22:02:50 -0500] Sauraus: Hi there folks
[2014-01-10 22:03:02 -0500] Sauraus: Is there a way to rename an environment?
[2014-01-10 22:04:03 -0500] scalp42: Sauraus: knife node edit [environment_name]
[2014-01-10 22:04:10 -0500] scalp42: and change the name in the json
[2014-01-10 22:04:23 -0500] scalp42: sory
[2014-01-10 22:04:33 -0500] scalp42: Sauraus: knife environment edit
[2014-01-10 22:05:21 -0500] Sauraus: trying :)
[2014-01-10 22:06:48 -0500] Sauraus: Won't allow me to change the name of the environment (Object unchanged, not saving) is the response
[2014-01-10 22:07:09 -0500] masterkorp: Guys, on test-kitchen i have the following recipe http://pastie.org/private/fep1linvqkr46tm1dlkk9q on the last block, the it seems to run every converge
[2014-01-10 22:13:13 -0500] MrHeavy: I'm having a problem where ignore_failure on a service notes that it's supposed to ignore my failure, and then just aborts my run anyway. Anyone have any ideas?
[2014-01-10 22:13:29 -0500] scalp42: weird Sauraus works for me
[2014-01-10 22:14:04 -0500] gchristensen: scalp42, Sauraus - perhaps because the environment has nodes in it?
[2014-01-10 22:14:26 -0500] scalp42: it should not matter though, mine has shit tons of nodes in it
[2014-01-10 22:14:34 -0500] scalp42: sorry *lot of nodes in it
[2014-01-10 22:18:48 -0500] trappiste: could someone help me understand what's going on at lib/chef/application/solo.rb:189, if I'm reading the regex correctly, it's trying to match against paths of the form /foo/bar/cookbooks/////// ??
[2014-01-10 22:20:35 -0500] trappiste: if this is the case, then cookbook_path isn't being extracted correctly from solo.rb when recipe_url is being used
[2014-01-10 22:21:04 -0500] byoung_: i have an odd case where i'm overriding an attribute of a cookbook within a wrapper cookbook. but the attribute i'm overriding is used in the "sub" cookbook to interpolate other attributes, and even though i've overridden that particular attribute, the sub cookbook interpolates the default value instead. anyone seen this before?
[2014-01-10 22:29:44 -0500] chef-newb: Hi, does anyone know of any way to completely unset an attribute for a particular role?
[2014-01-10 22:33:39 -0500] chef-newb: <chef-newb> -- Checkout chef-rewind on GitHub
[2014-01-10 22:37:03 -0500] masterkorp: chef-newb: do you have tour roles in repository
[2014-01-10 22:37:05 -0500] masterkorp: ?
[2014-01-10 22:47:06 -0500] chef-newb: Masterkorp:  We do have roles set up in our repository, however I haven't been able to find a way to unset attributes set by the environment, other than setting the attribute to nil in overrides
[2014-01-10 23:03:49 -0500] magoo: i know i'm too pedantic but what are you guys using as prefixes when converting roles to recipes?
[2014-01-10 23:04:10 -0500] MrHeavy: I have a single <company>_roles cookbook with each role represented by a recipe inside
[2014-01-10 23:04:30 -0500] magoo: hadn't thought about breaking it out into its own cookbook
[2014-01-10 23:04:32 -0500] magoo: not a bad idea
[2014-01-10 23:04:43 -0500] MrHeavy: I still use each role, because it's easier for search
[2014-01-10 23:05:24 -0500] borntyping: What's the reasoning behind replacing roles with recipes?
[2014-01-10 23:05:49 -0500] magoo: look up berkshelf
[2014-01-10 23:06:03 -0500] magoo: it's part of a greater migration I'm going through
[2014-01-10 23:06:27 -0500] magoo: essentially, you can version cookbooks/recipes
[2014-01-10 23:06:31 -0500] magoo: you can't do this with roles
[2014-01-10 23:06:50 -0500] magoo: so it makes controlling migrations to new "roles" difficult to control
[2014-01-10 23:07:12 -0500] magoo: someone else can probably explain better than I
[2014-01-10 23:07:13 -0500] AntelopeSalad: what do you mean by prefix?
[2014-01-10 23:07:23 -0500] magoo: for the recipe naming
[2014-01-10 23:07:29 -0500] AntelopeSalad: i just name them for what they are
[2014-01-10 23:07:48 -0500] AntelopeSalad: recipes/webserver.rb, recipes/database.rb, recipes/cache.rb, etc.
[2014-01-10 23:08:28 -0500] magoo: the only reason I'm asking is because I wanted a quick way to glance through my cookbook and see the recipes that are for assigning roles
[2014-01-10 23:09:25 -0500] AntelopeSalad: they are namespaced by the cookbook name
[2014-01-10 23:09:41 -0500] borntyping: Wouldn't a roles cookbook have to depend on *all* the cookbooks any role would include?
[2014-01-10 23:10:32 -0500] AntelopeSalad: that's the neat thing about the app cookbook style, all you have to do is make a recipe that combines recipe to have your "role"
[2014-01-10 23:11:24 -0500] borntyping: Yeah, but to include a recipe in you 'role' recipe the cookbook has to depend on it - which means every cookbook will get pulled onto a chef-client when it runs
[2014-01-10 23:12:02 -0500] AntelopeSalad: you would be using it as an alternative to roles
[2014-01-10 23:12:18 -0500] magoo: AntelopeSalad: this is more for the purpose of directory browsing
[2014-01-10 23:12:33 -0500] magoo: my_awesome_cookbook/type_database.rb
[2014-01-10 23:12:40 -0500] magoo: probably going to go with "type_"
[2014-01-10 23:12:49 -0500] magoo: i'd name it role but I don't want to be confusing
[2014-01-10 23:13:07 -0500] magoo: so when you do an ls -l, you see all of the type_ recipes lumped together
[2014-01-10 23:13:22 -0500] AntelopeSalad: what type of recipes would you have that aren't types?
[2014-01-10 23:13:26 -0500] magoo: of course, if I just go with a separate company_roles cookbook, that's a moot point
[2014-01-10 23:13:51 -0500] magoo: type_database is just going to replace role database
[2014-01-10 23:14:02 -0500] AntelopeSalad: right, but what other recipes would you have that are not types?
[2014-01-10 23:14:05 -0500] magoo: which is both postgresql and the databases we deploy to postgres
[2014-01-10 23:14:38 -0500] magoo: our application recipes are much more granular than a type
[2014-01-10 23:14:46 -0500] AntelopeSalad: you would have just have a myapp/recipes/database.rb that contains all of the postgres stuff no?
[2014-01-10 23:15:04 -0500] AntelopeSalad: and then you would probably expose some variables in an attributes file
[2014-01-10 23:15:37 -0500] magoo: and that recipe depends on individual recipes for adding different databases
[2014-01-10 23:15:46 -0500] magoo: so you have a directory full of recipes
[2014-01-10 23:15:59 -0500] magoo: and i want a visual way to separate those recipes based on what they are
[2014-01-10 23:16:02 -0500] magoo: hence a prefix
[2014-01-10 23:16:22 -0500] AntelopeSalad: if you're talking about different databases i would probably make those cookbooks
[2014-01-10 23:16:40 -0500] magoo: that seems like overkill
[2014-01-10 23:16:50 -0500] AntelopeSalad: you might as well just use role_ then imo
[2014-01-10 23:16:50 -0500] magoo: i'm talking about different schemas within a single postgres database
[2014-01-10 23:17:06 -0500] magoo: the whole point of moving away from roles is the versioning thing i mentioned earlier
[2014-01-10 23:17:21 -0500] AntelopeSalad: it might be confusing to some people but it makes the most sense when glancing at it from an unbiased perspective
[2014-01-10 23:17:48 -0500] magoo: until you have to go through iterations with changing roles
[2014-01-10 23:17:51 -0500] magoo: then you're fucked
[2014-01-10 23:18:01 -0500] AntelopeSalad: yeah i'm new to chef and i was using app cookbooks from day 1
[2014-01-10 23:18:23 -0500] magoo: oh, my bad
[2014-01-10 23:18:28 -0500] magoo: i thought you said to use roles above
[2014-01-10 23:18:33 -0500] AntelopeSalad: nope
[2014-01-10 23:18:33 -0500] magoo: you just meant role_ prefix
[2014-01-10 23:18:35 -0500] magoo: yeah
[2014-01-10 23:18:37 -0500] magoo: sorry bout that
[2014-01-10 23:19:01 -0500] AntelopeSalad: or if you want to really avoid that, maybe server_type
[2014-01-10 23:19:07 -0500] magoo: I'm still migrating from oldschool chef code
[2014-01-10 23:19:10 -0500] magoo: it's a process
[2014-01-10 23:19:15 -0500] AntelopeSalad: because type_ from an outsider's pov isn't really clear
[2014-01-10 23:19:22 -0500] magoo: true
[2014-01-10 23:19:36 -0500] magoo: server_ isn't a bad idea
[2014-01-10 23:21:38 -0500] AntelopeSalad: service_ seems reasonable too
[2014-01-10 23:22:12 -0500] magoo: god, if only I could hit the reset button on all this code
[2014-01-10 23:23:57 -0500] borntyping: that's what vcs'es are for
[2014-01-10 23:24:36 -0500] magoo: haha, I mean start over knowing what I know now
[2014-01-10 23:25:33 -0500] AntelopeSalad: on the bright side it shouldn't be too bad right
[2014-01-10 23:25:45 -0500] borntyping: That's pretty normal when it comes to any sort of programming
[2014-01-10 23:25:46 -0500] AntelopeSalad: moving old working code into newer better code is a lot easier than doing it with nothing
[2014-01-10 23:26:01 -0500] magoo: borntyping: yeah, I've said this often of all my work
[2014-01-10 23:26:13 -0500] borntyping: You can always look back on what you've done and know you could have done it much better
[2014-01-10 23:26:39 -0500] magoo: AntelopeSalad: yup
[2014-01-10 23:26:55 -0500] AntelopeSalad: it took me a long time of bike shedding to finally realize that
[2014-01-10 23:26:57 -0500] magoo: once we get the remaining wrapper cookbooks in place, I think it'll be smooth sailing
[2014-01-10 23:27:03 -0500] magoo: we're just doing it as we can
