[2014-01-16 00:49:38 -0500] shlant: anyone here?
[2014-01-16 00:50:31 -0500] hippiehacker: chefs in the shadows ;)
[2014-01-16 00:51:32 -0500] shlant: do you know whether or not when you set knife[:secret_file] in knife.rb will it create all data bags as encrypted?
[2014-01-16 00:52:38 -0500] magoo: pretty sure it won't
[2014-01-16 00:52:45 -0500] magoo: it'll just auto decrypt for your pleasure
[2014-01-16 00:52:56 -0500] magoo: you still need to specify --secret-file to encrypt
[2014-01-16 00:53:02 -0500] shlant: ok awesome
[2014-01-16 00:53:06 -0500] shlant: as it should be
[2014-01-16 00:54:19 -0500] magoo: the problem comes in when you need to get the actual json that you need to commit to your repo
[2014-01-16 00:54:36 -0500] magoo: you'll need to comment out the knife entry because there's no flag to turn off auto decrypt
[2014-01-16 00:55:16 -0500] magoo: not a huge deal i guess
[2014-01-16 01:11:53 -0500] maplebed: Hi, anybody here used the Ridley gem from RiotGames?
[2014-01-16 01:12:14 -0500] maplebed: Trying to use it I get a bunch of spam no std(out|err) when my script finishes.
[2014-01-16 01:12:17 -0500] maplebed: http://pastebin.com/A999D5ry
[2014-01-16 01:12:29 -0500] maplebed: am I supposed to close something before exitting the script?
[2014-01-16 01:12:41 -0500] maplebed: the same thing happens when I use it in irb and exit the irb session.
[2014-01-16 01:13:35 -0500] maplebed: googling shows it seems to be from celluloid (rather than ridley) but the only suggestions I can find are to change the LogLevel to suppress the messages.
[2014-01-16 03:10:37 -0500] strictlyb: guys
[2014-01-16 03:10:41 -0500] strictlyb: when i run chef-client
[2014-01-16 03:11:00 -0500] strictlyb: it hangs before this happened i deleted/recreated production environment,
[2014-01-16 03:11:08 -0500] strictlyb: does anyone have any idea what can be happening/what to do to fix?
[2014-01-16 03:49:18 -0500] spheromak: whee new etcd-cook uploaded to community
[2014-01-16 06:14:35 -0500] fleish: hi all, can someone help me figure out how to manipulate/translate an ip address of a chef node into something else so I can use it in a template?
[2014-01-16 06:19:14 -0500] flaccid: fleish: manipulate?
[2014-01-16 06:26:39 -0500] fleish: flaccid: I want to take a node's network ipaddress and transform it so the first 3 octets are something different
[2014-01-16 06:26:59 -0500] flaccid: fleish: sounds like a ruby question, not chef
[2014-01-16 06:27:17 -0500] fleish: flaccid: yup, trying to do it w/gsub ... figured someone here might know
[2014-01-16 06:27:44 -0500] flaccid: fleish: there is #ruby and google
[2014-01-16 06:29:02 -0500] manfred: irb(main):007:0> this='1.2.3.4'
[2014-01-16 06:29:05 -0500] manfred: => "1.2.3.4"
[2014-01-16 06:29:07 -0500] manfred: irb(main):008:0> this.split('.').take(3).join('.')
[2014-01-16 06:29:09 -0500] manfred: => "1.2.3"
[2014-01-16 06:29:15 -0500] manfred: i am sure there is a better way to do it, but meh
[2014-01-16 06:29:21 -0500] flaccid: there is libraries, like http://marcoceresa.com/ipaddress/classes/IPAddress/IPv4.html
[2014-01-16 06:30:04 -0500] flaccid: actually quite a few of them if you look on google
[2014-01-16 06:30:26 -0500] flaccid: in stdlib there is http://www.ruby-doc.org/stdlib-2.1.0/libdoc/ipaddr/rdoc/IPAddr.html which is probably all you need
[2014-01-16 06:31:49 -0500] manfred: I would just split it on the ., and then redefine the entries and then join it back together :)
[2014-01-16 06:33:17 -0500] fleish: I tried this in the template:  <%= node['network']['ipaddress'].gsub("y.y.y.","x.x.x.") %>
[2014-01-16 06:33:34 -0500] silk1: gsub! isnt it?
[2014-01-16 06:33:47 -0500] fleish: butu got undefined method `gsub' for nil:NilClass
[2014-01-16 06:33:52 -0500] silk1: oh no, ignore me i hate ruby
[2014-01-16 06:34:22 -0500] manfred: fleish: why not assign the variable in chef block, then just use @ in your template
[2014-01-16 06:34:31 -0500] fleish: yeah, I'm looking at another example that seems to indicate gsub should do it
[2014-01-16 06:35:26 -0500] fleish: manfred: I was thinking about something like that, but figured it would be easier to just substitute it on the fly
[2014-01-16 06:36:25 -0500] silk: fleish, do you see node['network]['ipaddress'] ? node.ipaddress.gsub('10', '20') works for me
[2014-01-16 06:37:53 -0500] fleish: silk: where would I see that?
[2014-01-16 06:38:09 -0500] silk: I mean, is it an attribute
[2014-01-16 06:38:14 -0500] silk: try it in shef -z
[2014-01-16 06:39:24 -0500] fleish: what I"m looking at that makes me think the template should work is <%= node['php']['conf_dir'].gsub("/", "\\") %>
[2014-01-16 06:40:15 -0500] fleish: chef > node['network]['ipaddress'] ? node.ipaddress.gsub('10', '20')
[2014-01-16 06:40:15 -0500] fleish: chef'>
[2014-01-16 06:40:21 -0500] fleish: nada?
[2014-01-16 06:40:49 -0500] fleish: oh wait, there's a missing '
[2014-01-16 06:41:36 -0500] fleish: chef > node['network']['ipaddress'] ? node.ipaddress.gsub('10', '20')
[2014-01-16 06:41:36 -0500] fleish: SyntaxError: (irb):1: syntax error, unexpected $end, expecting ':'
[2014-01-16 06:44:23 -0500] coderanger: fleish: Are you trying to use the ternary operator?
[2014-01-16 06:44:28 -0500] coderanger: x ? y : z
[2014-01-16 06:44:31 -0500] coderanger: Works like in C
[2014-01-16 06:48:17 -0500] silk: no, I think my putting two statements on teh same line confused him
[2014-01-16 06:48:20 -0500] fleish: coderanger: not sure tbh, ruby/C not really my think
[2014-01-16 06:48:26 -0500] fleish: ^think^thing
[2014-01-16 06:48:44 -0500] silk: fleish, what does node['network']['ipaddress'] return
[2014-01-16 06:48:52 -0500] silk: inside shef -z
[2014-01-16 06:49:14 -0500] fleish: *doh*
[2014-01-16 06:49:20 -0500] fleish: big fat nil
[2014-01-16 06:49:35 -0500] fleish: it's just node['ipaddress']
[2014-01-16 06:49:40 -0500] fleish: (facepalm)
[2014-01-16 06:49:49 -0500] silk: thats where I was headsing
[2014-01-16 06:53:53 -0500] fleish: it's what I get for copy & pasta-ing between chef repos
[2014-01-16 06:54:10 -0500] brucelee: trying to wrap my head around chef, vagrant, berkshelf, with vagrant-berkshelf plugin. error while reading Berksfile, and then it says Could not open or read: '/Users/peter/chef-repo/metadata.rb', but thats because i don't have a metadata.rb there. Am i supposed to have one?
[2014-01-16 06:54:36 -0500] brucelee: inside my chef-repo/Berksfile, i have site: opscode and then nextline is metadata
[2014-01-16 06:56:30 -0500] brucelee: is there supposed to be a Berksfile in chef-repo
[2014-01-16 06:56:30 -0500] brucelee: ?
[2014-01-16 06:59:59 -0500] brucelee: berkshelf website says to put Berksfile in the cookbook's root
[2014-01-16 07:00:26 -0500] brucelee: so whys there a Berksfile in ~/chef-repo with the starter kit
[2014-01-16 07:00:28 -0500] brucelee: :/
[2014-01-16 07:05:19 -0500] coderanger: brucelee: So there are two ways you can use berkshelf
[2014-01-16 07:05:33 -0500] coderanger: brucelee: One is the more modern "every cookbook is its own repo" mode
[2014-01-16 07:06:06 -0500] coderanger: but you can also use it more like the Gemfile in a rails app where its just pulling in external dependencies for a monolithic shared chef repo
[2014-01-16 07:06:16 -0500] coderanger: the starter kit was aimed at the latter because its easier
[2014-01-16 07:08:17 -0500] brucelee: coderanger: ah, so with the latter mode, its put inside ~/chef-repo right?
[2014-01-16 07:08:51 -0500] coderanger: yeah, at the base of the repo
[2014-01-16 07:09:01 -0500] coderanger: just like Gemfile or requirements.txt goes at the base of the app code
[2014-01-16 07:09:20 -0500] brucelee: coderanger: for this case, do i put site: opscode, and metadata
[2014-01-16 07:09:34 -0500] coderanger: site :opscode, yes
[2014-01-16 07:09:41 -0500] coderanger: but not metadata as there is none
[2014-01-16 07:09:48 -0500] brucelee: and eerytime i run berks install, it will pull down all the dependancy workbooks of my entire chef-repo (all my cookbooks)
[2014-01-16 07:10:10 -0500] brucelee: so no metadata, i basically manually put in all the cookbooks
[2014-01-16 07:10:43 -0500] coderanger: What you would do is something like "chef_api :config\nsite :opscode\ncookbook 'foo', path: 'cookbooks/foo'\ncookbook 'bar', path: 'cookbooks/bar'"
[2014-01-16 07:10:45 -0500] coderanger: and so on
[2014-01-16 07:11:48 -0500] brucelee: whats the use case for using Berksfile like this?
[2014-01-16 07:12:30 -0500] brucelee: if i create a cookbook, instead of specifying what the dependent cookbooks are in the cookbook, i declare it in Berksfile?
[2014-01-16 07:12:46 -0500] coderanger: No, deps always go in the cookbook
[2014-01-16 07:13:00 -0500] coderanger: berkshelf is just a downloader for those, and an uploader
[2014-01-16 07:13:34 -0500] coderanger: (an exception to that statement is that deps that are only used when testing in test-kitchen go only in the berksfile)
[2014-01-16 07:14:00 -0500] brucelee: how does this help make things easier? how would things be harder without berkshelf in this case?
[2014-01-16 07:14:29 -0500] coderanger: Something needs to fetch all your dependencies from the community site or github and upload them to your chef server
[2014-01-16 07:14:34 -0500] coderanger: berkshelf is that something
[2014-01-16 07:14:57 -0500] brucelee: oh you mean instead of manually downloading, and uploading the dependent cookbooks with knife
[2014-01-16 07:15:01 -0500] coderanger: Indeed
[2014-01-16 07:15:08 -0500] brucelee: declaring them in berksfile would do that
[2014-01-16 07:15:11 -0500] brucelee: i see..
[2014-01-16 07:15:26 -0500] brucelee: and the next time i create a new cookbook, i'd have to edit the Berksfile, and remove all those cookbooks, and put in the new ones right?
[2014-01-16 07:16:44 -0500] coderanger: No, you just add a pointer to each of your cookbooks
[2014-01-16 07:16:53 -0500] coderanger: You could also automate that with some ruby code if you tried
[2014-01-16 07:17:33 -0500] Abhishek: Hey guys how can we manage /etc/hosts entries using chef?
[2014-01-16 07:18:41 -0500] brucelee: so lets say i have cookbook A, and it has dependancies A1, A2, A3. I include A1, A2, A3 in Berksfile and it will download and upload them to the chef server
[2014-01-16 07:18:46 -0500] brucelee: but now i am creating cookbook B
[2014-01-16 07:18:56 -0500] brucelee: and it has dependancies B1, B2, B3
[2014-01-16 07:19:07 -0500] brucelee: do i simply add those 3 dependancies to Berksfile, so now it has a total of A1, A2, A3, B1, B2, B3?
[2014-01-16 07:19:12 -0500] coderanger: Abhishek: 1) there are several hostsfile cookbooks
[2014-01-16 07:19:29 -0500] coderanger: brucelee: No, like I said, dependencies live only in the cookbook's metadata.rb
[2014-01-16 07:19:37 -0500] coderanger: brucelee: You only add _your cookbooks_
[2014-01-16 07:19:54 -0500] coderanger: Abhishek: 2) Don't, use a DNS server like Dnsmasq, you'll thank me in six months
[2014-01-16 07:20:18 -0500] Abhishek: coderanger: is there no such chef resource to manage host enteries like puppet host?
[2014-01-16 07:20:31 -0500] coderanger: Abhishek: No, it would just be a template file
[2014-01-16 07:20:36 -0500] enbergj: I ran into an issue with locking a package to a specific version .. the package depends on other packages, and the versions need to match, if I just use version "2.0.3-1" for package "dsc20", it will not use the same version for "cassandra", which it depends on and then APT gives me "dsc20 : Depends: cassandra (= 2.0.3) but 2.0.4 is to be installed" .. should it be enough if I just manually also define the cassandra package and it's version or will the
[2014-01-16 07:20:42 -0500] brucelee: coderanger: ah, so berksfile will look in each of the cookbook's metadata.rb for dependancies? or does it not even care about metadata.rb
[2014-01-16 07:21:02 -0500] coderanger: brucelee: Yes, berkshelf compiles the metadata for each cookbook and recursively expands dependencies
[2014-01-16 07:21:43 -0500] coderanger: enbergj: apt's dependency solver is  not good
[2014-01-16 07:22:03 -0500] brucelee: coderanger: so now im trying to do it in a different way, where i use vagrant, and just run 'vagrant up' and it will run berkshelf like the case we just discussed
[2014-01-16 07:22:04 -0500] coderanger: enbergj: Generally you'll have to pin every version of everything all the way down the chain
[2014-01-16 07:22:06 -0500] enbergj: coderanger: most things with apt are not good, yet I'm half-way stuck with it for now ;)
[2014-01-16 07:22:32 -0500] brucelee: coderanger: how does the berkshelf file have to be for this to work? I take it, its no longer just a single file in the ~/chef-repo ir
[2014-01-16 07:22:33 -0500] coderanger: enbergj: basically apt will never backtrack, its a greedy solver algorithm
[2014-01-16 07:22:35 -0500] brucelee: dir*
[2014-01-16 07:22:56 -0500] coderanger: brucelee: Are you talking about the "every cookbook is its own repo" model?
[2014-01-16 07:23:13 -0500] brucelee: coderanger: if thats the way it works, then yeah
[2014-01-16 07:23:22 -0500] brucelee: coderanger: im not sure, have you worked with the vagrant berkshelf plugin?
[2014-01-16 07:23:42 -0500] brucelee: coderanger: i have a book here, and im following the instructions, doesn't work though
[2014-01-16 07:23:54 -0500] coderanger: brucelee: There are multiple, very very different ways to use berkshelf
[2014-01-16 07:24:14 -0500] coderanger: brucelee: If you are starting with the idea of a "chef repo" you are off the tracks from any berkshelf docs
[2014-01-16 07:24:22 -0500] coderanger: which assume you are following The Berkshelf Way
[2014-01-16 07:24:29 -0500] coderanger: in which there is no central chef repo anymore
[2014-01-16 07:24:29 -0500] enbergj: coderanger: yeah, ok, looks like I have to create something like /etc/apt/preferences.d/cassandra with rules to pin the packages, though in this case the internet seems to think it's not that many things that require pinning .. thanks
[2014-01-16 07:25:03 -0500] coderanger: enbergj: Just make sure you install stuff in the right order
[2014-01-16 07:25:33 -0500] coderanger: brucelee: So I need to know which model you are using to advise you :)
[2014-01-16 07:26:42 -0500] brucelee: haha, i wish i could tell you which model
[2014-01-16 07:26:52 -0500] brucelee: but im learning berkshelf myself :P
[2014-01-16 07:26:55 -0500] brucelee: so far i just know the model you told me
[2014-01-16 07:27:08 -0500] brucelee: but im trying to get this other model to work, im guessing its a different model
[2014-01-16 07:27:20 -0500] brucelee: it starts off like this:
[2014-01-16 07:27:39 -0500] brucelee: the same thing pretty much with what you just explained to me
[2014-01-16 07:27:51 -0500] brucelee: but instead of putting in "my cookbooks" in the Berksfile
[2014-01-16 07:28:02 -0500] brucelee: i put in site:opscode \nmetadata
[2014-01-16 07:28:19 -0500] coderanger: brucelee: Do you have a folder with things like "cookbooks/" "roles/" and "data_bags/"?
[2014-01-16 07:28:50 -0500] brucelee: coderanger: yeah
[2014-01-16 07:28:56 -0500] brucelee: coderanger: chef-repo/cookbooks
[2014-01-16 07:29:11 -0500] brucelee: chef-repo/roles
[2014-01-16 07:29:15 -0500] brucelee: no data_bags
[2014-01-16 07:30:31 -0500] coderanger: Okay, so you are not following The Berkshelf Way
[2014-01-16 07:30:41 -0500] coderanger: in which case you are just using berkshelf as a downloader/uploader
[2014-01-16 07:31:44 -0500] brucelee: heres what it says "and we tell berkshelf to read the metadata.rb. this is the simplest way when working inside a single cookbook"
[2014-01-16 07:31:55 -0500] brucelee: so i guess it assumes that i have a single cookbook
[2014-01-16 07:32:13 -0500] brucelee: but why would it tell me to put Berksfile inside ~/chef-repo
[2014-01-16 07:32:28 -0500] brucelee: if im working with a single cookbook, it should be inside ~/chef-repo/cookbooks/my_cookbook right?
[2014-01-16 07:32:49 -0500] coderanger: No, because you aren't following that model
[2014-01-16 07:32:53 -0500] coderanger: I mean you could do that too
[2014-01-16 07:33:17 -0500] coderanger: but as I said before, the berkshelf docs, and most tutorials with it, assume you are following the berkshelf way
[2014-01-16 07:33:24 -0500] brucelee: i see
[2014-01-16 07:33:30 -0500] brucelee: and the berkshelf way is the way we discusseD?
[2014-01-16 07:33:31 -0500] coderanger: and since you are not, you can't follow those guides directly
[2014-01-16 07:34:07 -0500] coderanger: The Berkshelf Way is every cookbook goes in its own repo, you don't use roles (or data bags mostly), and all interproject resolution is handled by berkshelf
[2014-01-16 07:35:41 -0500] coderanger: Its a very different way to use chef, though personally I highly recommend it as 100% superior to the original opscode workflow
[2014-01-16 07:36:26 -0500] brucelee: every cookbook goes in its own repo instead of a master repo?
[2014-01-16 07:36:39 -0500] brucelee: when you download a cookbook using knife, it goes into a 'vendor' branch
[2014-01-16 07:36:49 -0500] brucelee: when you say "goes in its own repo"
[2014-01-16 07:36:50 -0500] brucelee: what do you mean
[2014-01-16 07:37:00 -0500] brucelee: for me i have ~/chef-repo
[2014-01-16 07:37:09 -0500] brucelee: if im using the berkshelf way, are you saying i have ~/cookbook1
[2014-01-16 07:37:11 -0500] brucelee: ~/cookbook2
[2014-01-16 07:37:12 -0500] brucelee: etc?
[2014-01-16 07:37:26 -0500] coderanger: First thing, never use knife cookbook site install, its just bad
[2014-01-16 07:37:32 -0500] coderanger: Second, yes
[2014-01-16 07:37:40 -0500] brucelee: :p
[2014-01-16 07:37:47 -0500] brucelee: ok
[2014-01-16 07:37:54 -0500] brucelee: i think ill go with that workflow
[2014-01-16 07:38:01 -0500] coderanger: http://hastebin.com/masamiheqe.txt
[2014-01-16 07:38:02 -0500] brucelee: but that means i have to scrap all this  :O
[2014-01-16 07:38:07 -0500] coderanger: Thats my work code folder, for example
[2014-01-16 07:38:17 -0500] coderanger: No, you just have to migrate each cookbook to a repo
[2014-01-16 07:38:39 -0500] brucelee: so are you saying each cookbook will be its own branch
[2014-01-16 07:38:46 -0500] brucelee: or will i have to git init each cookbook as its own repo
[2014-01-16 07:39:15 -0500] coderanger: Every cookbook is its own repo and is completely independent from all other cookbooks
[2014-01-16 07:39:33 -0500] coderanger: each is managed as a software library/component on its own, with normal CI, test, and release cycles
[2014-01-16 07:40:13 -0500] brucelee: i like the sound of that
[2014-01-16 07:40:35 -0500] brucelee: im going to adopt that but first i want to at least understand this workflow
[2014-01-16 07:40:39 -0500] brucelee: so i can compare
[2014-01-16 07:41:33 -0500] brucelee: anyway, with this workflow, i think i have to create a berksfile in the repo root, and put site: opscode and then cookbook 'mycookbook1', cookbook 'mycookbook2'
[2014-01-16 07:41:36 -0500] brucelee: etc
[2014-01-16 07:41:46 -0500] brucelee: but this is what i get when i run vagrant up
[2014-01-16 07:41:53 -0500] brucelee: this is using the berkshelf vagrant plugin
[2014-01-16 07:42:25 -0500] brucelee: it seems to work
[2014-01-16 07:42:28 -0500] coderanger: You keep saying "this"
[2014-01-16 07:42:32 -0500] coderanger: without qualifying which you mean
[2014-01-16 07:42:39 -0500] coderanger: Please be more precise
[2014-01-16 07:42:42 -0500] brucelee: sorry
[2014-01-16 07:42:56 -0500] brucelee: so this is all new workflow, nothing we discussed
[2014-01-16 07:43:09 -0500] brucelee: it involves a berksfile in the chef-repo root
[2014-01-16 07:43:20 -0500] coderanger: There is no chef-repo
[2014-01-16 07:43:28 -0500] coderanger: the concept is entirely removed
[2014-01-16 07:43:37 -0500] brucelee: ?
[2014-01-16 07:43:50 -0500] brucelee: since when?
[2014-01-16 07:44:01 -0500] brucelee: i have a ~/chef-repo
[2014-01-16 07:44:13 -0500] coderanger: If following the full berkshelf workflow, you have no need for one
[2014-01-16 07:45:59 -0500] brucelee: ok brb really quick...
[2014-01-16 07:46:03 -0500] brucelee: bathroom
[2014-01-16 08:02:37 -0500] brucelee: ok back
[2014-01-16 08:02:45 -0500] brucelee: coderanger: still there? ;p
[2014-01-16 08:02:54 -0500] coderanger: Yes, though probably heading to bed soon
[2014-01-16 08:03:02 -0500] brucelee: what time is it over there
[2014-01-16 08:03:05 -0500] coderanger: midnight
[2014-01-16 08:03:08 -0500] coderanger: UTC-8
[2014-01-16 08:03:25 -0500] brucelee: pacific standard time?
[2014-01-16 08:03:29 -0500] brucelee: san francisco here
[2014-01-16 08:03:32 -0500] brucelee: same :)
[2014-01-16 08:03:36 -0500] coderanger: yes, I live in the east bay
[2014-01-16 08:03:41 -0500] brucelee: ahhhh
[2014-01-16 08:03:43 -0500] brucelee: where do you work?
[2014-01-16 08:04:01 -0500] brucelee: coderanger: we should meet up and become study buddies :P
[2014-01-16 08:04:07 -0500] brucelee: for opscode :p
[2014-01-16 08:04:14 -0500] brucelee: of course it will be one sided :p
[2014-01-16 08:04:34 -0500] coderanger: brucelee: You are always welcome to come by the office, we have a big open door policy :)
[2014-01-16 08:04:54 -0500] brucelee: awesome, i used to work in the east bay
[2014-01-16 08:04:56 -0500] brucelee: oakland, near lake merrit
[2014-01-16 08:05:04 -0500] coderanger: I work in SoMa
[2014-01-16 08:05:10 -0500] brucelee: pinterest?
[2014-01-16 08:05:14 -0500] coderanger: Balanced
[2014-01-16 08:05:19 -0500] brucelee: i work in soma too
[2014-01-16 08:05:20 -0500] coderanger: Pinterest is all Puppet AFAIK
[2014-01-16 08:05:21 -0500] brucelee: opswat
[2014-01-16 08:05:42 -0500] brucelee: trying to think where Blanaced is
[2014-01-16 08:06:41 -0500] coderanger: mission, between 5th and 6th
[2014-01-16 08:08:04 -0500] brucelee: im a block away from zynga
[2014-01-16 08:08:09 -0500] brucelee: :p
[2014-01-16 08:08:14 -0500] brucelee: we're so close, kind of
[2014-01-16 08:08:20 -0500] fleish: hey guys, one more Q from me. I'm trying to append a recipe to my first-boot.json. threw in a simple sed line to do it which runs fine manually from the cmdline, but fails when it's done via the bootstrap  sed -i 's/]}/,"recipe[firewall::default]"]}/' /etc/chef/first-boot.json which should turn {"run_list":["role[somerole]"]} into {"run_list":["role[somerole]","recipe[firewall::default]"]} ... but for some reason the double-quotes aren'
[2014-01-16 08:08:20 -0500] fleish: working and I end up with {"run_list":["role[somerole]",recipe[firewall::default]]}
[2014-01-16 08:08:26 -0500] brucelee: youre near that big architectural looking building
[2014-01-16 08:08:29 -0500] brucelee: federal building
[2014-01-16 08:08:42 -0500] coderanger: Yeah, its a block or so away
[2014-01-16 08:08:43 -0500] coderanger: https://www.facebook.com/balancedpayments/page_map
[2014-01-16 08:09:04 -0500] brucelee: hows working for balanced payments? ;p
[2014-01-16 08:09:14 -0500] brucelee: i thought you worked for opscode
[2014-01-16 08:09:19 -0500] brucelee: and lived in germany
[2014-01-16 08:09:22 -0500] coderanger: I used to work at Opscode
[2014-01-16 08:09:28 -0500] coderanger: and have never lived in Germany :P
[2014-01-16 08:09:40 -0500] brucelee: :p
[2014-01-16 08:10:19 -0500] brucelee: well i guess balanced payments is better than working for opscode :p
[2014-01-16 08:10:47 -0500] coderanger: Balanced basically just lets me do the stuff I do anyway, my job is to fix the brokenness of the Ops ecosystem
[2014-01-16 08:11:26 -0500] coderanger: fleish: Why are you trying to edit JSON using sed?
[2014-01-16 08:13:47 -0500] fleish: coderanger: b/c I'm a masochist :P
[2014-01-16 08:14:13 -0500] fleish: but really b/c I first hacked it to do what I wanted on the cmdline and then tried to lazily stuff it into the chef bootstrap
[2014-01-16 08:14:54 -0500] coderanger: fleish: Lets step back, how are you bootstrapping chef?
[2014-01-16 08:15:07 -0500] coderanger: fleish: is it via knife bootstrap?
[2014-01-16 08:15:33 -0500] fleish: coderanger: yup
[2014-01-16 08:15:59 -0500] coderanger: So just do -r 'role[somerole],recipe[firewall]'
[2014-01-16 08:17:41 -0500] brucelee: coderanger: so essentially i have a chef-repo/Berksfile, which has sites: opscode\ncookbook 'my_cookbook', path: './cookbooks/my_cookbook'
[2014-01-16 08:17:58 -0500] brucelee: coderanger: but when i run vagrant up, it says Berkshelf::ChefConnectionError: There was an error connecting to the Chef Server
[2014-01-16 08:18:06 -0500] fleish: coderanger: actually I should clarify, I'm technically doing knife openstack server create -r $role --template-file=$bootstrap_file -d $my-gems-file ... which I assume is calling knife bootstrap later
[2014-01-16 08:18:12 -0500] brucelee: so it sounds like the berkshelf part is working, but the connection to chef is not
[2014-01-16 08:18:17 -0500] brucelee: im using hosted chef btw
[2014-01-16 08:18:38 -0500] coderanger: fleish: Yes, you can just tweak your -r option there
[2014-01-16 08:18:42 -0500] coderanger: fleish: It gets passed down
[2014-01-16 08:19:11 -0500] coderanger: brucelee: From the same folder, does `knife client list` work?
[2014-01-16 08:19:28 -0500] coderanger: Unless you create a berkshelf config file, it defaults to using your ambient chef credentials
[2014-01-16 08:19:51 -0500] brucelee: coderanger: let me paste mine
[2014-01-16 08:20:08 -0500] coderanger: brucelee: Just does it work at all, the values don't matter
[2014-01-16 08:20:27 -0500] brucelee: knife client list works
[2014-01-16 08:21:22 -0500] fleish: coderanger: cool, as soon as I fight my way back in (think I got sed to work, but my firewall ruleset seems to have forgotten about dhcp) I'll try that
[2014-01-16 08:21:25 -0500] coderanger: okay, did you create berkshelf config file?
[2014-01-16 08:21:35 -0500] brucelee: yeah let me codepad it
[2014-01-16 08:21:52 -0500] fleish: ^fight my way back in^destroy and recreate it
[2014-01-16 08:22:13 -0500] brucelee: site :opscode
[2014-01-16 08:22:13 -0500] brucelee: cookbook 'my_cookbook', path: './cookbooks/my_cookbook'
[2014-01-16 08:22:31 -0500] brucelee: coderanger: thats literally the entire 2 lines
[2014-01-16 08:22:49 -0500] coderanger: brucelee: Thats the berksfile, separate from that is the berkshelf config file
[2014-01-16 08:22:54 -0500] brucelee: oh
[2014-01-16 08:23:05 -0500] brucelee: i think its using the default one for that
[2014-01-16 08:23:09 -0500] brucelee: i dont remmeber ever touching a berkshelf config file
[2014-01-16 08:23:35 -0500] brucelee: i have a vagrant file though
[2014-01-16 08:24:18 -0500] coderanger: okay, what command are you running specifically
[2014-01-16 08:24:49 -0500] brucelee: http://www.fpaste.org/68877/13898606/
[2014-01-16 08:24:53 -0500] brucelee: thats the Vagrantfile
[2014-01-16 08:25:00 -0500] brucelee: the command im running is 'vagrant up;
[2014-01-16 08:25:05 -0500] brucelee: 'vagrant up'
[2014-01-16 08:25:53 -0500] coderanger: Okay, does `berks install` work?
[2014-01-16 08:26:07 -0500] coderanger: that will get berkshelf to go out and download the dependencies
[2014-01-16 08:26:50 -0500] brucelee: let me see...
[2014-01-16 08:26:58 -0500] brucelee: i know that works
[2014-01-16 08:27:16 -0500] brucelee: yah that works
[2014-01-16 08:27:37 -0500] brucelee: http://www.fpaste.org/68880/13898608/
[2014-01-16 08:27:47 -0500] coderanger: Okay, so what precise error are you seeing from vagrant?
[2014-01-16 08:28:33 -0500] brucelee: http://www.fpaste.org/68881/38986090/
[2014-01-16 08:28:37 -0500] brucelee: thats the exact paste of everything
[2014-01-16 08:29:21 -0500] brucelee: could be some certificate thing
[2014-01-16 08:29:33 -0500] coderanger: Oh, you are using chef_client in vagrant?
[2014-01-16 08:29:39 -0500] coderanger: Thats probably going to come back to bite you
[2014-01-16 08:29:46 -0500] coderanger: But the fix for that is easy
[2014-01-16 08:29:49 -0500] coderanger: Are you on OS X?
[2014-01-16 08:29:52 -0500] brucelee: yah
[2014-01-16 08:30:01 -0500] coderanger: derp, yeah, in your prompt
[2014-01-16 08:30:15 -0500] brucelee: ? :P
[2014-01-16 08:30:50 -0500] coderanger: brew install curl-ca-bundle
[2014-01-16 08:31:09 -0500] coderanger: And add this to your shellrc of choice
[2014-01-16 08:31:09 -0500] coderanger: export SSL_CERT_FILE="$(brew --prefix curl-ca-bundle)/share/ca-bundle.crt"
[2014-01-16 08:32:16 -0500] brucelee: brew install curl-ca-bundle? :p
[2014-01-16 08:32:22 -0500] brucelee: is brew some os x yum equivalent?
[2014-01-16 08:32:33 -0500] brucelee: im new to OS X too :)
[2014-01-16 08:33:11 -0500] coderanger: http://brew.sh/
[2014-01-16 08:33:23 -0500] coderanger: More like a mac version of ports/portage
[2014-01-16 08:33:46 -0500] woltage: brew ftw!
[2014-01-16 08:34:04 -0500] brucelee: nice
[2014-01-16 08:34:05 -0500] brucelee: :
[2014-01-16 08:34:54 -0500] coderanger: Yeah, I sometimes forget it isn't standard issue
[2014-01-16 08:35:27 -0500] coderanger: You can also just go download the Curl CA bundle yourself and cram it somewhere
[2014-01-16 08:35:38 -0500] coderanger: http://curl.haxx.se/docs/caextract.html
[2014-01-16 08:35:43 -0500] coderanger: Its just that one pem file
[2014-01-16 08:36:41 -0500] brucelee: http://www.fpaste.org/68882/38986139/
[2014-01-16 08:37:04 -0500] brucelee: i see, so the chef-client doesnt work well in the mac osx
[2014-01-16 08:37:18 -0500] brucelee: that got rid of the SSL thing, but now i get that
[2014-01-16 08:37:23 -0500] fleish: seems like comcast is hint it's time for sleep ... at least a modem powercycle jarred me back online for now
[2014-01-16 08:37:41 -0500] fleish: I really need to install a remote switch for that
[2014-01-16 08:38:13 -0500] coderanger: brucelee: Berkshelf, unlike Chef, verifies SSL connections by default
[2014-01-16 08:38:19 -0500] coderanger: This is a mistake on Chef's part
[2014-01-16 08:38:33 -0500] coderanger: but the default CA list on OS X is rather sparse
[2014-01-16 08:38:42 -0500] brucelee: i see
[2014-01-16 08:38:48 -0500] coderanger: so using the mozilla bundle (by way of the curl team) gives you better defaults
[2014-01-16 08:39:00 -0500] coderanger: I mean technically you could also disable ssl verification
[2014-01-16 08:39:03 -0500] coderanger: this would be a bad idea though
[2014-01-16 08:39:09 -0500] brucelee: yeah
[2014-01-16 08:39:20 -0500] brucelee: but it gets other errors now though
[2014-01-16 08:39:37 -0500] brucelee: "invalid element in "template"."
[2014-01-16 08:39:59 -0500] coderanger: Sounds like you have something weird with your templates
[2014-01-16 08:40:07 -0500] brucelee: hmm
[2014-01-16 08:40:22 -0500] brucelee: thats probably my iptables recipe
[2014-01-16 08:40:35 -0500] brucelee: in my cookbook, i have to create these .erb files, each of which is basically 1 iptables rule
[2014-01-16 08:40:47 -0500] brucelee: so i have an http.erb which has the http iptables rules
[2014-01-16 08:41:08 -0500] coderanger: okay, got to go pass out
[2014-01-16 08:41:14 -0500] brucelee: ok coderanger
[2014-01-16 08:41:20 -0500] brucelee: me too :)
[2014-01-16 08:41:24 -0500] brucelee: i work at 9am starting
[2014-01-16 08:41:28 -0500] brucelee: coderanger: thanks a lot though
[2014-01-16 08:41:32 -0500] fleish: thanks for the help coderanger
[2014-01-16 08:41:52 -0500] brucelee: coderanger: i will be at balanced tomorrow and you can help me sort this out in 5 minutes in person :p
[2014-01-16 08:42:32 -0500] coderanger: brucelee: Heh, best bet tomorrow is some time after 4, I think I'm in meetings before then
[2014-01-16 08:42:43 -0500] brucelee: haha really? :P i was just kidding
[2014-01-16 08:42:51 -0500] coderanger: Sure, like I said, open door.
[2014-01-16 08:43:05 -0500] brucelee: i would never do tha, im sure you have better thing sto do after work :P
[2014-01-16 08:43:48 -0500] brucelee: but ill seriously take you up on that offer if you are down :)
[2014-01-16 08:43:53 -0500] brucelee: i wouldnt mind
[2014-01-16 08:44:09 -0500] brucelee: ill buy you dinner :O
[2014-01-16 09:47:05 -0500] AikiLinux: how can i remove an attribute from a node through a chef run, i have a recipe that set some attributes, and now it is no longer needed, and want to attributes to be removed,but not as a manual process
[2014-01-16 09:51:57 -0500] laurent\: tried the delete method instead of the set one ?
[2014-01-16 09:55:23 -0500] AikiLinux: no, i am reading the docs and it is not mentioned
[2014-01-16 10:02:51 -0500] mancdaz: AikiLinux: can you work with setting it to nil ?
[2014-01-16 10:03:08 -0500] mancdaz: iirc it's a bit of a pain to fully delete an attr
[2014-01-16 10:13:57 -0500] tt8888: hi all ... question to the chef gurus from a noob
[2014-01-16 10:14:23 -0500] tt8888: we want to write a component cookbook for a popular middleware product
[2014-01-16 10:15:12 -0500] tt8888: so my idea is to write this component cookbook with recipes to do various actions, such as install product, then create the server instances, then create cluster, then configure .. etc
[2014-01-16 10:15:39 -0500] tt8888: and then we will write application cookbook that will call the component cookbook ...
[2014-01-16 10:16:23 -0500] tt8888: so that we are in situation where we have multiple application on the same run_list ... appA, appB .. all calling the same component cookbook
[2014-01-16 10:17:07 -0500] tt8888: how do we ensure we can call some of the recipe in the component cookbook multiple of times to do same thing .. like creating instances ...
[2014-01-16 10:17:38 -0500] tt8888: since include_receipe will only be run once within the same run_list
[2014-01-16 10:17:53 -0500] tt8888: pls shout if i'm not clear.. ?
[2014-01-16 10:17:57 -0500] gregkare: You probably want to write a LWRP
[2014-01-16 10:18:17 -0500] tt8888: so a LWRP to create instance ... as an example?
[2014-01-16 10:19:15 -0500] tt8888: so component cookbook will have LWRP to install binary, and LWRP will have test to ensure it won't run if it's installed already ... ?
[2014-01-16 10:20:05 -0500] tt8888: but for once we could repeatly use, we can scope the test to be more specific, for example creating cluster, if the cluster name X is there don't do it again .. ?
[2014-01-16 11:22:38 -0500] shay-: hi, If I use knife ssh on centos6 like knife ssh role:webserver "service watcherd start" I does not really startup: watcherd dead but subsys locked -- If i do it with ssh webserver "service watcherd start" is works well, any ideas?
[2014-01-16 11:28:18 -0500] ruaok: Hello!
[2014-01-16 11:28:35 -0500] ruaok: I'm trying to run an instance of chef-solo, but it hangs shortly after startup.
[2014-01-16 11:28:42 -0500] ruaok: Some details here: https://gist.github.com/mayhem/8453392
[2014-01-16 11:28:57 -0500] ruaok: if anyone could nudge me in the right direction, I would deeply appreciate it.
[2014-01-16 11:29:11 -0500] AikiLinux: if i remove an attribute file form a recipe - will that cause the attributes defined in that file to be removed ?
[2014-01-16 12:06:57 -0500] henk76: Hi guys. hope you are all doing fine. Quick question. If i enter the "environment" variable in the client.rb file. Does it overrule everything else? for example a manual change from the commandline to put a machine into another environment?
[2014-01-16 12:31:32 -0500] CaptainQuirk: Hi there
[2014-01-16 12:32:22 -0500] CaptainQuirk: I want to create some sort of master cookbook that include other recipes
[2014-01-16 12:32:35 -0500] CaptainQuirk: is there a preferred directory structure to do that ?
[2014-01-16 12:34:36 -0500] zeroXten: what? how can my attribute not exist.. i have two of them :( a default and an override
[2014-01-16 12:34:55 -0500] zeroXten: CaptainQuirk: looked at librarian or berkshelf as an approach?
[2014-01-16 12:36:21 -0500] CaptainQuirk: zeroXten, no indeed
[2014-01-16 12:37:26 -0500] zeroXten: worth looking at
[2014-01-16 12:37:42 -0500] CaptainQuirk: would you advise berkshelf event if  the last stable version isn't under development
[2014-01-16 12:38:58 -0500] CaptainQuirk: But its used mainly to organize dependencies, that's not what I need
[2014-01-16 12:39:22 -0500] CaptainQuirk: I don't think I'll use my own cookbooks as dependencies of a master one
[2014-01-16 12:41:35 -0500] zeroXten: i'm using berkshelf 3 yeah, it's 2014.. i wouldn't assume anything is 'stable'
[2014-01-16 12:51:54 -0500] cyx^: I'm trying to use edelight/chef-mongodb but always receiving "NoMethodError: undefined method `[]' for nil:NilClass"... I'm stumped. Any help please?
[2014-01-16 12:52:37 -0500] zeroXten: cyx^: heh, i'm getting something similar but for something else. Doesn't like my attributes for some reason
[2014-01-16 12:53:26 -0500] cyx^: Such a helpful error message... NOT..
[2014-01-16 12:53:43 -0500] zeroXten: well, technically it is correct
[2014-01-16 12:53:50 -0500] _dumfries: cyx^: can you paste the entire stack trace?
[2014-01-16 12:54:13 -0500] zeroXten: cyx^: is yours during recipe compilation?
[2014-01-16 12:54:59 -0500] cyx^: /var/chef/cache/chef-stacktrace.out: http://hastebin.com/bacoxemoji.vbs
[2014-01-16 12:55:30 -0500] cyx^: All I did is add the edelight/chef-mongodb as submodule and add "recipe[mongodb::10gen_repo]" to my role
[2014-01-16 12:55:46 -0500] cyx^: I didn't set any attributes, the defaults are fine for me
[2014-01-16 12:55:58 -0500] zeroXten: wanna bet? ;)
[2014-01-16 12:55:59 -0500] _dumfries: cyx^: There should be more output related to the actual error you're receiving.
[2014-01-16 12:56:43 -0500] cyx^: _dumfries: yeah.. this stacktrace is talking about some missing pem.. weird.
[2014-01-16 12:56:57 -0500] _dumfries: The output you've presented there relates to node authentication.
[2014-01-16 12:57:23 -0500] cyx^: This is the actual console output: http://hastebin.com/yohiyakoma.vbs
[2014-01-16 12:58:48 -0500] _dumfries: cyx^: do me a favour, can you converge the node with debug output?
[2014-01-16 12:59:21 -0500] cyx^: _dumfries: I'll do it gladly. Not sure what you're asking though
[2014-01-16 12:59:32 -0500] _dumfries: cyx^: run "chef-client -l debug" on the host.
[2014-01-16 12:59:51 -0500] _dumfries: Looking to see exactly where it's bailing.
[2014-01-16 13:00:47 -0500] cyx^: Hmm, I'm using vagrant, and apparently I do not have a 'chef-client' executable in host
[2014-01-16 13:01:10 -0500] _dumfries: It's usually in /opt/chef
[2014-01-16 13:01:39 -0500] cyx^: Nope.. trying to 'find' it..
[2014-01-16 13:03:52 -0500] cyx^: I'm so new to this, and it's so complicated geez. This is all I got: http://hastebin.com/xumanapeje.avrasm
[2014-01-16 13:05:36 -0500] _dumfries: cyx^: Right, vagrant is using the chef solo provisioner here.
[2014-01-16 13:06:36 -0500] cyx^: _dumfries: So maybe I should really install chef standalone? https://aur.archlinux.org/packages/ruby-chef/
[2014-01-16 13:07:16 -0500] _dumfries: cyx^: Nah, it's fine ot use this approach, if you're planning to use searching features you may want to switch the chef_client provisioner.
[2014-01-16 13:09:36 -0500] cyx^: _dumfries: Searching of what? So should I install `gem install chef` to get the chef-client to debug? I'm confused sorry.
[2014-01-16 13:10:06 -0500] _dumfries: iirc you can get verbose output from the provisioner by including --debug
[2014-01-16 13:10:19 -0500] cyx^: oh cool
[2014-01-16 13:16:24 -0500] zeroXten: hmm, i wasn't allowed to use node[] in application>rails>database when that cookbook was being included by another cookbook... ;)
[2014-01-16 13:17:02 -0500] ruaok: I'm trying to run an instance of chef-solo, but it hangs shortly after startup.
[2014-01-16 13:17:02 -0500] zeroXten: moved the references to the attributes into the main body of the recipe and used variables and that worked
[2014-01-16 13:17:12 -0500] ruaok: Some details here: https://gist.github.com/mayhem/8453392
[2014-01-16 13:17:20 -0500] ruaok: if anyone has any clues...
[2014-01-16 13:19:39 -0500] cyx^: _dumfries: Here's the debug output: https://gist.github.com/rafi/1160cf7e91e85298632c
[2014-01-16 13:23:58 -0500] cyx^: I still can't find anything helpful in that debug dump.. arghhhh
[2014-01-16 13:38:39 -0500] cyx^: I'll just add 10gen's apt repo and install package myself..
[2014-01-16 13:47:08 -0500] henk76: Quick question. If i enter the "environment" variable in the client.rb file. Does it overrule everything else? for example a manual change from the commandline to put a machine into another environment?
[2014-01-16 13:59:05 -0500] denniswisnia: Hey, any way to monitor the Chef Server and it fails if the chef-client is not successfull?
[2014-01-16 14:06:03 -0500] zxd: [2014-01-16T15:59:51+02:00] ERROR: can't convert String into Integer
[2014-01-16 14:06:08 -0500] zxd: what cases could I get this error
[2014-01-16 14:06:16 -0500] zxd: I am getting this with rvm cookbook
[2014-01-16 14:06:45 -0500] GreatSUN_: Hi all
[2014-01-16 14:07:01 -0500] ocholetras: hi!
[2014-01-16 14:07:17 -0500] ocholetras: anyone knows if the behaviour with array attributes still the same?
[2014-01-16 14:07:19 -0500] ocholetras: I mean
[2014-01-16 14:07:31 -0500] GreatSUN_: small question: does someone of you guys know how I could set a node attribute from within a library that is beeing loaded before node object is existing / attribute files are loaded?
[2014-01-16 14:08:06 -0500] GreatSUN_: ocholetras: you mean?
[2014-01-16 14:08:43 -0500] ocholetras: Cookbook1: default['foo'] = ["bar"] + Cookbook2: default['foo'] = ["bar2"] ---> results on  node['foo'] being ["bar","bar2"]
[2014-01-16 14:09:01 -0500] ocholetras: Same level array attributes gets merged
[2014-01-16 14:09:28 -0500] ocholetras: https://coderanger.net/2013/06/arrays-and-chef/
[2014-01-16 14:09:34 -0500] threeturn: Hi guys, anyone from chef/opscode on the channel?
[2014-01-16 14:10:20 -0500] GreatSUN_: threeturn: why you need someone from opscode?
[2014-01-16 14:11:54 -0500] threeturn: I'm struggling with jira, the password recovery doesn't work for me.
[2014-01-16 14:12:03 -0500] GreatSUN_: ocholetras: I thought that this was as described only when combined roles and attributes
[2014-01-16 14:12:38 -0500] GreatSUN_: threeturn: I don't think that someone of opscode is a jira expert
[2014-01-16 14:13:45 -0500] threeturn: of course but i mean the jura that opscode use for the issue tracking
[2014-01-16 14:14:42 -0500] GreatSUN_: threeturn: well, I did never use it up to now
[2014-01-16 14:16:15 -0500] zxd: http://pastebin.com/bREgu8Hi  prints ERROR: can't convert String into Integer
[2014-01-16 14:17:14 -0500] ocholetras: GreatSUN_: where can you see attribute array merging described as roles + attribute files ?
[2014-01-16 14:17:15 -0500] ocholetras: O_o
[2014-01-16 14:18:08 -0500] GreatSUN__: back, sorry, internet connection is not really stable
[2014-01-16 14:18:21 -0500] tscanausa: ocholetras: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2014-01-16 14:19:21 -0500] GreatSUN__: so, how can I set node attributes at load time where node object is not existing and attribute files might not have been loaded?
[2014-01-16 14:19:41 -0500] workmad3: threeturn: I'd suggest looking for a support email on the jira site (maybe in a contact page?)
[2014-01-16 14:20:10 -0500] workmad3: threeturn: because while there are some opscode people here, afaik they tend to be more cookbook devs rather than IT support staff
[2014-01-16 14:20:55 -0500] workmad3: GreatSUN_: before the node object has been created? I doubt you can set node attributes at that point...
[2014-01-16 14:21:10 -0500] workmad3: GreatSUN_: after all, what would you set them on? :)
[2014-01-16 14:21:39 -0500] GreatSUN_: workmad3: I would like to add additional attributes at that time
[2014-01-16 14:21:48 -0500] GreatSUN_: so that they'd get merged later on+
[2014-01-16 14:22:07 -0500] workmad3: GreatSUN_: yes, but you have a problem in that the node *doesn't exist* at that point
[2014-01-16 14:22:07 -0500] GreatSUN_: another choice would be an extension of the part where node object is created
[2014-01-16 14:22:36 -0500] workmad3: GreatSUN_: tbh, it sounds more like you're wanting to add extra attributes at something like ohai run time, which would mean an ohai plugin
[2014-01-16 14:22:38 -0500] GreatSUN_: but I'd like to know where this is done though, cause I didn't see where node object is created on code site
[2014-01-16 14:23:31 -0500] GreatSUN_: workmad3: it could be an ohai plugin, but I'd prefere to have it standalone
[2014-01-16 14:24:55 -0500] workmad3: GreatSUN_: why?
[2014-01-16 14:26:46 -0500] workmad3: GreatSUN_: oh, just a sec... you're in a file in libraries?
[2014-01-16 14:27:45 -0500] workmad3: GreatSUN_: the node has been created at that point... it's just that a file in the libraries/ directory is loaded outside of the context of most chef stuff, so the top-level doesn't have automatic access to things like 'node' without jumping through some hoops
[2014-01-16 14:28:13 -0500] workmad3: GreatSUN_: I'd missed that bit of info in the scrollback :)
[2014-01-16 14:30:22 -0500] GreatSUN_: workmad3: yes, a file in libraries
[2014-01-16 14:30:27 -0500] GreatSUN_: sorry, I am in a meeting atm
[2014-01-16 14:30:34 -0500] workmad3: np
[2014-01-16 14:31:07 -0500] GreatSUN_: workmad3: so would it be possible at this state to add some attribute to the node?
[2014-01-16 14:31:19 -0500] GreatSUN_: workmad3: do you have an idea how, if that is possible?
[2014-01-16 14:31:52 -0500] threeturn: workmad3: on the password recovery page I get "If the email does not arrive, please contact your JIRA administrators." message. But i'm wondering who is in charge of jira administration :)
[2014-01-16 14:33:52 -0500] workmad3: GreatSUN_: not sure if it is possible, it would depend a lot on the internal structure of a chef run
[2014-01-16 14:34:21 -0500] workmad3: GreatSUN_: is there a reason you can't use an attributes file? :)
[2014-01-16 14:35:36 -0500] GreatSUN_: workmad3: I want to load a json file from a database and merge it with node attributes
[2014-01-16 14:36:32 -0500] GreatSUN_: workmad3: additionally it should be done kind of automatical instead of manual (that you have to add the code in an attribute file)
[2014-01-16 14:39:15 -0500] workmad3: GreatSUN_: hmm... I'd really suggest using an ohai plugin for that tbh
[2014-01-16 14:43:35 -0500] ocholetras: tscanausa: so...? there is no array attributes reference!
[2014-01-16 14:44:38 -0500] tscanausa: I am not sure what you are saying
[2014-01-16 14:45:58 -0500] tscanausa: ocholetras: the link I sent you describes how attributes are merged from the various locations that attributes can come from.
[2014-01-16 14:48:54 -0500] slbmeh: what affects the order of execution of a run list?
[2014-01-16 14:54:56 -0500] heathsnow_: mornin' all
[2014-01-16 14:58:03 -0500] workmad3: slbmeh: afaik, nothing
[2014-01-16 14:58:18 -0500] workmad3: slbmeh: the order of execution is always just the order of items in the run list
[2014-01-16 14:59:08 -0500] cyx^: slbmeh: I'm new, but I would think it's the order you call your roles/recipes. But there must be some precedence conditions I would think..
[2014-01-16 15:00:27 -0500] slbmeh: workmad3: i was running in to an issue where items at the end of a run list were being executed before items in a base role which is listed first
[2014-01-16 15:02:02 -0500] slbmeh: ah... i see what is going on...
[2014-01-16 15:02:49 -0500] slbmeh: i'm calling chef_gem 'mysql' and that is run immediately
[2014-01-16 15:03:49 -0500] slbmeh: what is a good way to ensure that my recipe has the mysql gem but also ensure that the mysql client recipe is done prior?
[2014-01-16 15:03:57 -0500] slbmeh: stick chef_gem in a ruby block?
[2014-01-16 15:05:44 -0500] mmazing: i've got a bunch of directories on a server that periodically need to be cleaned up, for instance inside "base_dir/" i would have "sub_dir1", "sub_dir2", "sub_dir3", and would only like to keep the "sub_dir" that was created most recently
[2014-01-16 15:06:00 -0500] mmazing: i could easily do this with a bash script, trying to figure out how to do it with chef
[2014-01-16 15:06:14 -0500] strictlyb: has anyone had any issues were bean.snp process spikes causing my chef-client runs to drag insanely slow?
[2014-01-16 15:06:23 -0500] daxroc: If you use not_if on a remote_file is the checksum attribute ignored?
[2014-01-16 15:13:55 -0500] bbssysop: hi all. i am using a bash statement in a recipe to do an rsync. sometimes rsync throws an error, but i want to ignore it. how do i go about handling the rsync error in chef?
[2014-01-16 15:14:55 -0500] slbmeh: daxroc1: i believe not_if is processed at the generic resource level prior to any processing by the provider
[2014-01-16 15:23:46 -0500] slbmeh: bbssysop: i know the execute block has an ignore_failure option
[2014-01-16 15:24:55 -0500] slbmeh: bbssysop: if you're doing it within a bash script you can always pipe the command through true which will always exit 0
[2014-01-16 15:25:37 -0500] bbssysop: cool. i have a bash code block in a recipe. i added the ignore_failure true to the end of it. going to test now.
[2014-01-16 15:29:10 -0500] siddc: When running chef-client in daemon mode, is there anyway to tell it to randomize the run time between certain values?
[2014-01-16 15:30:09 -0500] workmad3: siddc: set the --splay
[2014-01-16 15:30:26 -0500] siddc: <wordmad3>: Thanks
[2014-01-16 15:31:01 -0500] workmad3: siddc: which is a modification of the interval to randomise by +/- up to the splay amount
[2014-01-16 15:31:17 -0500] siddc: yup
[2014-01-16 15:34:32 -0500] siddc: Another question. Is there a builtin notification to notify sysadmins if the daemon dies for some reason?
[2014-01-16 15:35:05 -0500] workmad3: not afaik
[2014-01-16 15:35:27 -0500] heathsnow_: cron job cookbook to monitor service and send email eh?
[2014-01-16 15:35:52 -0500] workmad3: heathsnow_: I'd rather an alert came up on my newrelic monitor or similar personally ;)
[2014-01-16 15:36:08 -0500] workmad3: but I do also run chef-client with runit, so if it crashes then runit will restart
[2014-01-16 15:36:31 -0500] slbmeh: not quite possible for an application that is not running to inform you that it is not running... monitoring utilities do much better
[2014-01-16 15:36:33 -0500] heathsnow_: even better :)
[2014-01-16 15:37:08 -0500] siddc: I see. Thanks for the options guys
[2014-01-16 15:39:12 -0500] masterkorp: guys i need help
[2014-01-16 15:39:14 -0500] masterkorp:       99>>     not_if ::File.directory?("#{node["taskwarrior"]["server"]["data_dir"]}/orgs/#{u["taskwarrior"]["organization"]}")
[2014-01-16 15:39:23 -0500] masterkorp: Invalid only_if/not_if command: true (TrueClass)
[2014-01-16 15:39:29 -0500] masterkorp: gives me this ^
[2014-01-16 15:39:37 -0500] masterkorp: i did not had coffee yet
[2014-01-16 15:39:47 -0500] masterkorp: so what the thing about this
[2014-01-16 15:39:55 -0500] masterkorp: this should return bool
[2014-01-16 15:41:31 -0500] masterkorp: ok coffee ingested
[2014-01-16 15:41:38 -0500] masterkorp: and i see i missed the do block
[2014-01-16 15:42:04 -0500] slbmeh: masterkorp: right, that gives a bool and i believe it is expecting a string to execute
[2014-01-16 15:42:25 -0500] masterkorp: ot_if do ::File.directory?("#{node["taskwarrior"]["server"]["data_dir"]}/orgs/#{u["taskwarrior"]["organization"]}") end
[2014-01-16 15:42:28 -0500] masterkorp: this works
[2014-01-16 15:42:36 -0500] slbmeh: ah
[2014-01-16 15:42:39 -0500] masterkorp: slbmeh: i need to enforce that its a ruby block
[2014-01-16 15:42:48 -0500] masterkorp: slbmeh: coffee is a magic thing
[2014-01-16 15:43:56 -0500] slbmeh: still getting used to the whole ruby thing... never would have figured that one out if i had the issue
[2014-01-16 15:44:35 -0500] masterkorp: n 1 ruby rule
[2014-01-16 15:44:40 -0500] masterkorp: everything is a block
[2014-01-16 15:46:45 -0500] slbmeh: i think the major thing throwing me off is learning ruby through setting up chef/vagrant and some things are executed linear... and others are at "compile" time...
[2014-01-16 15:47:40 -0500] masterkorp: yeah that takes time
[2014-01-16 15:47:51 -0500] masterkorp: slbmeh: but the docs are decent now
[2014-01-16 15:48:44 -0500] slbmeh: ya, that's been my savior this past week, if only i could write my recipies in python or php
[2014-01-16 15:49:31 -0500] masterkorp: eww php
[2014-01-16 15:49:42 -0500] masterkorp: i would just strangled you now
[2014-01-16 15:50:05 -0500] workmad3: masterkorp: eww, you'd contaminate yourself by touching a PHPer? :)
[2014-01-16 15:50:15 -0500] masterkorp: I worked with php (and the people that usually work it with) and it was awful
[2014-01-16 15:50:29 -0500] masterkorp: they barely new what a version control system was
[2014-01-16 15:50:33 -0500] masterkorp: let alone use it
[2014-01-16 15:51:03 -0500] slbmeh: my role in the land of php for my company is to ensure the web team utilizes the best practices
[2014-01-16 15:51:22 -0500] slbmeh: such as vcs, unit testing, dry, ci, etc...
[2014-01-16 15:51:29 -0500] masterkorp: best pracices is not to use it
[2014-01-16 15:51:33 -0500] masterkorp: dun dun dun
[2014-01-16 15:51:36 -0500] masterkorp: and I am out
[2014-01-16 15:51:40 -0500] workmad3: hehe
[2014-01-16 15:51:47 -0500] slbmeh: i've been stuck doing this devops stuff lately though
[2014-01-16 15:53:56 -0500] cyx^: well finally managed to install mongodb from a little recipe I've made. if anyone's interested: https://gist.github.com/rafi/8457238
[2014-01-16 15:54:45 -0500] workmad3: cyx^: it would be better if you made a proper git repo with it in and a proper cookbook structure ;)
[2014-01-16 15:55:05 -0500] workmad3: cyx^: so potential users don't need to guess dependencies and whatnot, and you can version it
[2014-01-16 15:55:39 -0500] freezey: cyx^: i have a cookbook where you can assign replica members and arbiters if interested
[2014-01-16 15:55:48 -0500] workmad3: cyx^: also, line 27-31... that would be better done with a file resource to delete the file and a service resource, IMO
[2014-01-16 15:56:23 -0500] workmad3: cyx^: and the prevent start? why not a file resource to set the content? :)
[2014-01-16 15:59:29 -0500] cyx^: I'm really new to this. It's taking me so much freakin' time to do it. And we gotta prepare a dev-box with weird stuff all the 6 of us need to work on. It took me 20hours to setup apache2/php5.4/postgres/mongodb/npm/nodejs/nsis/compass/sass/bundler/bower/grunt and run custom scripts... I don't want to overwrite configuration files and we don't need all the madness for dev machines..
[2014-01-16 16:00:15 -0500] cyx^: less is better for me right now.. :)
[2014-01-16 16:01:39 -0500] workmad3: cyx^: heh :) in that vein, any reason you didn't use this mongodb cookbook? https://github.com/edelight/chef-mongodb
[2014-01-16 16:02:13 -0500] cyx^: I tried for hours. see my despair here in the logs ~5hours ago
[2014-01-16 16:02:17 -0500] thebishop: how can (or should i?) I have platform conditions around dependencies (e.g. only depends 'yum' on redhat-derived platforms)
[2014-01-16 16:03:55 -0500] workmad3: cyx^: fair enough :) pragmatism sometimes wins
[2014-01-16 16:04:05 -0500] basic`: i have a somewhat odd operation i need to do with chef... I need to set up 2 yum repos and do a couple package installs, but then no longer manage the yum.repos.d/*.repo files that it creates
[2014-01-16 16:04:09 -0500] basic`: is this possibly somehow?
[2014-01-16 16:04:42 -0500] thebishop: basic`, no longer manage as in you don't want them to update if the package updates?
[2014-01-16 16:05:15 -0500] basic`: thebishop: right, ex. there's another system that will manage the repo files after chef adds them
[2014-01-16 16:05:27 -0500] thebishop: basic`, why not install the rpms directly?
[2014-01-16 16:05:36 -0500] basic`: hmm
[2014-01-16 16:05:40 -0500] basic`: that's a good idea
[2014-01-16 16:05:46 -0500] thebishop: seems like downloading/installing would be just as easy as adding/removing the repo
[2014-01-16 16:06:03 -0500] cyx^: for a non-rubyist, chef made me dislike ruby advertly
[2014-01-16 16:06:24 -0500] thebishop: cyx^, haha i feel that too. it's not *that* much different than python which i enjoy though
[2014-01-16 16:06:28 -0500] basic`: thebishop: that would work, good idea.  I'm guessing there's no way to do a "copy once" sort of operation?
[2014-01-16 16:07:13 -0500] thebishop: basic`, i think you'd want some conditional to see if the package is installed or not
[2014-01-16 16:07:25 -0500] borntyping: basic`: :create_if_missing
[2014-01-16 16:07:35 -0500] borntyping: (on the file and template resources)
[2014-01-16 16:07:46 -0500] thebishop: borntyping, what about packages?
[2014-01-16 16:07:47 -0500] cyx^: thebishop: I'm kinda' thinking about trying 'ansible'
[2014-01-16 16:08:01 -0500] basic`: thebishop: for packages, i could just :install
[2014-01-16 16:08:17 -0500] basic`: that won't update, but will check it's installed
[2014-01-16 16:08:31 -0500] thebishop: basic`, right, but once you install an rpm, it'll be in yum's database, just not in a repo
[2014-01-16 16:08:41 -0500] thebishop: the OS 'knows' you've installed that rpm
[2014-01-16 16:08:57 -0500] basic`: ah i see what you mean
[2014-01-16 16:08:58 -0500] thebishop: basic`, i'm thinking you'd want to do a check against the OS package management to see if your rpm is installed
[2014-01-16 16:09:19 -0500] thebishop: shouldn't be too terrible to do that manually, but i'd be surprised if there wasn't a provider
[2014-01-16 16:09:46 -0500] zeroXten: ah classic. Problems downloading startkit
[2014-01-16 16:10:19 -0500] slbmeh: thebishop: you can put ruby code in a metadata.rb, but all in all it's just metadata i think it's better to have it all there
[2014-01-16 16:10:21 -0500] basic`: thebishop: ya, i think doing the repo rpm install from the cookbook will work nicely
[2014-01-16 16:10:37 -0500] basic`: thebishop: it's more direct, and i know won't cause problems
[2014-01-16 16:10:43 -0500] GreatSUN_: can someone shortly tell me, if I am writing an ohai plugin, what do I have to do, to influence the attributes for the node?
[2014-01-16 16:10:47 -0500] basic`: thanks for the tip :)
[2014-01-16 16:10:56 -0500] thebishop: basic`, sure thing
[2014-01-16 16:11:25 -0500] thebishop: slbmeh, yeah i guess there's no big downside to pulling an unused cookbook as long as the recipe itself has a platform check
[2014-01-16 16:12:47 -0500] slbmeh: thebishop: if it didn't have a platform check the recipe probably wouldn't work for another platform anyhow
[2014-01-16 16:13:01 -0500] thebishop: slbmeh, right
[2014-01-16 16:13:26 -0500] slbmeh: thebishop: i have noticed that using librarian or berkshelf i've had to put platform conditionals in the dependency files
[2014-01-16 16:13:42 -0500] thebishop: slbmeh, interesting. i'm using berks
[2014-01-16 16:14:08 -0500] thebishop: slbmeh, "dependency files" being the Berksfile or the metadata.rb?
[2014-01-16 16:14:37 -0500] slbmeh: thebishop: strange dependency resolution issue with the windows cookbook when you're not using windows so i force it to an old version that doesn't have the additional deps when not on windows
[2014-01-16 16:14:55 -0500] slbmeh: thebishop: the Berksfile
[2014-01-16 16:15:26 -0500] thebishop: slbmeh, hmm... so provisioning would just fail if Berks couldn't find a dependency for the node platform
[2014-01-16 16:15:53 -0500] thebishop: well, wait... why would it fail?
[2014-01-16 16:16:06 -0500] thebishop: it should be able to find the cookbook, that's not platform specific
[2014-01-16 16:16:55 -0500] slbmeh: thebishop: i can't remember what the exact issue was, but it was caused by dependency changes on the windows cookbook
[2014-01-16 16:17:10 -0500] slbmeh: it worked on windows machines just fine
[2014-01-16 16:17:12 -0500] AndHeiberg_: What does this mean? Error executing action `sync` on resource 'git[/home/vagrant/.oh-my-zsh]' is the repo down?
[2014-01-16 16:17:24 -0500] thebishop: slbmeh, hmm, well the upside is that won't apply to me, but still worrying
[2014-01-16 16:17:43 -0500] slbmeh: the mac machines here were choking on it so i put a check in for platform
[2014-01-16 16:17:43 -0500] thebishop: AndHeiberg_, is that path a git repo?
[2014-01-16 16:18:09 -0500] AndHeiberg_: thebishop: no..
[2014-01-16 16:18:20 -0500] slbmeh: and if it wasn't a windows maching i would explicitly require the windows cookbook at an earlier revision that would work
[2014-01-16 16:18:27 -0500] slbmeh: because it wasn't used at all
[2014-01-16 16:18:35 -0500] AndHeiberg_: https://www.irccloud.com/pastebin/RIClwGqs
[2014-01-16 16:19:00 -0500] AndHeiberg_: The recipe is using git to download a repo I guess
[2014-01-16 16:20:07 -0500] thebishop: AndHeiberg_, are the permissions on that path writable?
[2014-01-16 16:20:56 -0500] AndHeiberg_: workmad3: yeah mean it doesn't exist on the repo or on the machine?
[2014-01-16 16:20:58 -0500] AndHeiberg_: thebishop: I think so
[2014-01-16 16:21:01 -0500] workmad3: AndHeiberg_: on the machine
[2014-01-16 16:21:11 -0500] AndHeiberg_: workmad3: that is correct
[2014-01-16 16:21:26 -0500] workmad3: AndHeiberg_: it needs to exist on the machine if you want to run the check out command as that user
[2014-01-16 16:21:26 -0500] AndHeiberg_: why would it try to do that
[2014-01-16 16:22:24 -0500] workmad3: AndHeiberg_: because that's what you told it to do? the 'user' attribute for the git resource is the (local) user that should own the repository and run the git command to check it out
[2014-01-16 16:22:40 -0500] workmad3: AndHeiberg_: and you've passed 'vagrant' as that user... which doesn't exist
[2014-01-16 16:25:37 -0500] AndHeiberg_: workmad3: that part I do understand I just found it weird :) but thanks I think I've figured it out
[2014-01-16 16:26:02 -0500] workmad3: AndHeiberg_: well, looking at it, it seems you're doing 'user login' where the value in the login variable is vagrant
[2014-01-16 16:26:17 -0500] AndHeiberg_: workmad3: you are correct
[2014-01-16 16:26:20 -0500] GreatSUN_: can someone shortly tell me, if I am writing an ohai plugin, what do I have to do, to influence the attributes for the node?
[2014-01-16 16:27:59 -0500] fak3r: I have some old nodes (in QA) and I want to update them to run the newest chef - howto? Just download the install.sh and let it install over them?
[2014-01-16 16:29:48 -0500] thebishop: fak3r, knife bootstrap might update chef node installs i'm not sure
[2014-01-16 16:30:10 -0500] fak3r: thebishop: ya, good idea, will try that 1st thanks
[2014-01-16 16:30:21 -0500] tscanausa: fak3r: I think the chef-client recipe can take care of it as well
[2014-01-16 16:30:35 -0500] thebishop: bootstrap with chef-client recipe
[2014-01-16 16:30:36 -0500] thebishop: haha
[2014-01-16 16:30:56 -0500] tscanausa: thebishop: that is exactly what I do.
[2014-01-16 16:31:05 -0500] thebishop: tscanausa, perfect
[2014-01-16 16:31:20 -0500] tscanausa: bootstrap -r "recipe[base]"
[2014-01-16 16:33:00 -0500] allaire: Anyone use the php cookbook here?
[2014-01-16 16:33:24 -0500] tscanausa: allaire: which one?
[2014-01-16 16:33:34 -0500] allaire: tscanausa: official
[2014-01-16 16:33:41 -0500] tscanausa: link?
[2014-01-16 16:33:43 -0500] allaire: github.com/opscode-cookbooks/php
[2014-01-16 16:34:17 -0500] slbmeh: allaire: i use it
[2014-01-16 16:34:31 -0500] tscanausa: I use it as well
[2014-01-16 16:34:40 -0500] allaire: Do you guys use php with apache2 as well?
[2014-01-16 16:35:02 -0500] tscanausa: No, nginx and php-fpm
[2014-01-16 16:35:21 -0500] allaire: Cause currently, I can only change the php.ini config only to one thing, by default php-cli
[2014-01-16 16:35:58 -0500] slbmeh: php-fpm with apache2
[2014-01-16 16:36:03 -0500] allaire: I have another php.ini in /etc/apache2/php.ini
[2014-01-16 16:37:04 -0500] slbmeh: what platform?
[2014-01-16 16:38:09 -0500] allaire: ubuntu
[2014-01-16 16:38:50 -0500] zxd_: I have a question about .json attributes saved in role and environment
[2014-01-16 16:38:53 -0500] allaire: i need to go, ill brb in 1h
[2014-01-16 16:38:55 -0500] zxd_: why are they saved in json?
[2014-01-16 16:38:58 -0500] zxd_: in the server
[2014-01-16 16:39:53 -0500] slbmeh: zxd: what would you expect otherwise?
[2014-01-16 16:40:11 -0500] tscanausa: zxd: because someone decided it was an easy  and flexible format, so they went with it
[2014-01-16 16:41:03 -0500] zxd: yes but the code in chef coobooks is ruby, how do the values translate later back to ruby
[2014-01-16 16:41:14 -0500] zxd: they are saved in json then translated to ruby ?
[2014-01-16 16:41:28 -0500] tscanausa: zxd: simply put yes
[2014-01-16 16:42:39 -0500] tscanausa: many of the scripty languages can easily translate back and forth between language hashes and json, and it is language independant.
[2014-01-16 16:42:49 -0500] zxd: ok, so there is a bug in one of a cookbook I downloaded, I think the attributes I uploaded via role file don't translate back to ruby properly, per example it thinks it's an array or because I get can't convert String to integer error
[2014-01-16 16:43:00 -0500] zxd: but if I put the attributes directly in the cookbook it works
[2014-01-16 16:44:28 -0500] tscanausa: zxd: can you gist the relavent parts and someone might be able to help you
[2014-01-16 16:47:26 -0500] trilitheus: hi - any way to bulk edit a run list with knife run_list add? i.e. for all rhel 6 servers
[2014-01-16 16:48:21 -0500] tscanausa: update your wrapper cookbook?
[2014-01-16 16:49:27 -0500] zxd: tscanausa: gist?
[2014-01-16 16:50:28 -0500] tscanausa: zxd: its a pastebin run by github, but someway of showing everyone what is wrong
[2014-01-16 16:52:42 -0500] j^2_: zxd: there's  great cli app for it too. $> gist blah.sh
[2014-01-16 16:53:48 -0500] zxd: I see
[2014-01-16 16:53:52 -0500] zxd: ok one sec
[2014-01-16 16:55:47 -0500] slbmeh: emacs integration for gist as well
[2014-01-16 16:56:28 -0500] trilitheus: it's to add a arwapper cookbook
[2014-01-16 16:59:34 -0500] zxd: tscanausa : http://pastebin.com/2fVZydA8
[2014-01-16 16:59:41 -0500] zxd: I pasted there what I have
[2014-01-16 16:59:59 -0500] zxd: if I put it in json file and upload it then the rvm cookbook fails to compile what that error
[2014-01-16 17:00:09 -0500] j^2_: slbmeh: and vim ;)
[2014-01-16 17:00:14 -0500] zxd: if I remove from json and put the attributes in default.rb  it works
[2014-01-16 17:03:39 -0500] workmad3: zxd: what you've been putting in the json file and what you've been putting in the attributes aren't equivalent
[2014-01-16 17:05:13 -0500] GreatSUN_: hey guys
[2014-01-16 17:05:30 -0500] GreatSUN_: still trying to create some ohai plugin that adds some attribute to the node
[2014-01-16 17:05:50 -0500] GreatSUN_: but somehow I even don't get a return value from ohai when I call the plugin directly
[2014-01-16 17:06:54 -0500] zxd: you are right but if I leave up to { 'user'          => 'deploy',    and remove the rest  it same syntax correct?
[2014-01-16 17:06:56 -0500] zxd: just did that
[2014-01-16 17:07:12 -0500] zxd: and it works just with { 'user'          => 'deploy',   but in attributes/default.rb
[2014-01-16 17:07:17 -0500] slbmeh: zxd: in your override attributes for the role you don't have a hash within an array like you do in the default attributes file...
[2014-01-16 17:07:18 -0500] zxd: workmad3
[2014-01-16 17:07:28 -0500] zxd: oh
[2014-01-16 17:07:41 -0500] zxd: slbmeh: how should it look ? what I am missing
[2014-01-16 17:07:48 -0500] workmad3: zxd: as slbmeh said, and the way you've written your recipe you need a hash inside an array
[2014-01-16 17:08:42 -0500] workmad3: zxd: otherwise what your 'rvm_user' variable looks like is ['user', 'deploy'] (the two items in the hash) and then when you try to do 'rvm_user["user"]' you get that 'cannot convert string to integer' error that characterises trying to access an array with a string
[2014-01-16 17:09:00 -0500] workmad3: zxd: wrap the { "user": "deploy"} JSON object in []
[2014-01-16 17:09:26 -0500] workmad3: zxd: so it becomes "user_installs": [ { "user": "deploy"} ]
[2014-01-16 17:10:48 -0500] bimlendu: hey guys
[2014-01-16 17:11:13 -0500] bimlendu: I am unable to run the pedant tests.. chef-server-ctl test .
[2014-01-16 17:11:34 -0500] bimlendu: getting this error. Failed to authenticate as 'admin'. Ensure that your node_name and client key are correct.
[2014-01-16 17:12:02 -0500] bimlendu: I am on an open-source chef server ..
[2014-01-16 17:12:10 -0500] bimlendu: and its a fresh install
[2014-01-16 17:13:21 -0500] zxd: thanks workmad3 slbmeh
[2014-01-16 17:13:47 -0500] aujt74: hi everyone, anyone know why the apache_module definition in the apache2 cookbook only drops off the module .load file for platform_family?('rhel', 'fedora', 'arch', 'suse', 'freebsd')? Means I need to manually manage the .load file just on debian. https://github.com/opscode-cookbooks/apache2/blob/master/definitions/apache_module.rb
[2014-01-16 17:23:14 -0500] slbmeh: aujt74: i'm pretty sure they're already there on ubuntu, that probably has something to do with not doing it for the debian family
[2014-01-16 17:26:43 -0500] allaire: slbmeh: Still there?
[2014-01-16 17:26:49 -0500] aujt74: slbmeh: that's true for packaged modules but the module in question here is being built from source. on the platform families mentioned above I just override apache_module definition to output the right paths, module name etc in the .load file but for the debian family I need an inverse of the above platform_family if condition to drop off the .load file in that case.
[2014-01-16 17:29:45 -0500] slbmeh: aujt74: didn't even think about modules from source
[2014-01-16 17:32:18 -0500] slbmeh: aujt74: i now wonder why it is that way
[2014-01-16 17:32:56 -0500] aujt74: slbmeh: ha yeah... I'm trying to whip ckbk.it/mod_security cookbook into shape, hasn't been touched since 2011. and building from source is preferable given the packaged versions are often too old to support the latest owasp common rulesets
[2014-01-16 17:33:07 -0500] aujt74: *core rule sets
[2014-01-16 17:35:23 -0500] slbmeh: aujt74: looks like that's there for COOK-1021
[2014-01-16 17:35:55 -0500] aujt74: I've worked around it, I do literally just have a if inverse of that platform_family list around the .load file the cookbook drops off. the cookbook just dropped it and the .conf off into mods-enabled. so it now drops it off into mods-avaliable and uses apache_module to activate.
[2014-01-16 17:35:56 -0500] slbmeh: maybe not
[2014-01-16 17:36:23 -0500] aujt74: *the cookbook previously just dropped it...
[2014-01-16 17:39:14 -0500] aujt74: slbmeh: I was mildly confused when the debian based platforms failed and rhel etc didn't with test-kitchen when I changed it to use apache_module to enable the mod. It's not an obvious behaviour for a cookbook trying to smooth out cross-platform differences
[2014-01-16 17:44:12 -0500] spokrandt: just started getting error uploading recipe to server..
[2014-01-16 17:44:28 -0500] spokrandt: Uploading ark            [0.4.2]
[2014-01-16 17:44:29 -0500] spokrandt: /System/Library/Frameworks/Ruby.framework/Versions/2.0/usr/lib/ruby/2.0.0/net/http.rb:878:in `initialize': getaddrinfo: nodename nor servname provided, or not known (SocketError)
[2014-01-16 17:44:36 -0500] spokrandt: any ideas?
[2014-01-16 17:44:42 -0500] spokrandt: google is no help
[2014-01-16 17:45:53 -0500] tscanausa: spokrandt: looks like dns failed
[2014-01-16 17:46:12 -0500] spokrandt: other recipes upload fine
[2014-01-16 17:47:56 -0500] GreatSUN_: does someone of you know how I can tell chef at the time libraries are loaded to reload ohai attributes?
[2014-01-16 17:50:07 -0500] slbmeh: GreatSUN_: i never did find a chef way to do it... but i've done it before
[2014-01-16 17:50:16 -0500] slbmeh: GreatSUN_: https://github.com/slbmeh/chef-solo-node/blob/master/recipes/default.rb
[2014-01-16 17:51:20 -0500] GreatSUN_: I know the way with the ohai resource, but this will not be working within a library
[2014-01-16 17:51:40 -0500] slbmeh: i'm not quite sure i understand?
[2014-01-16 17:52:04 -0500] GreatSUN_: slbmeh: not ment onto your code ;-)
[2014-01-16 17:52:24 -0500] GreatSUN_: slbmeh: but do you know if node_set will be working within a library?
[2014-01-16 17:52:59 -0500] GreatSUN_: anyhow node object is not there at the time / within the context when loading library
[2014-01-16 17:53:59 -0500] slbmeh: GreatSUN_: oh, that node_set isn't required for the Ohai reload
[2014-01-16 17:54:57 -0500] slbmeh: GreatSUN_: nor is the require_plugin call, those pieces are implementation specific for that recipe
[2014-01-16 17:55:34 -0500] allaire: someara: You around?
[2014-01-16 17:55:56 -0500] allaire: someara: Ping me if you have a minute :)
[2014-01-16 17:56:08 -0500] GreatSUN_: slbmeh: might be ohai will be reloaded then, but node attributes won't be reset/updated though
[2014-01-16 17:56:19 -0500] GreatSUN_: but this is exactly what I want
[2014-01-16 17:56:51 -0500] GreatSUN_: slbmeh: or are you sure that this is resulting in the refresh of the node attribtues?
[2014-01-16 17:57:18 -0500] slbmeh: GreatSUN_: right, it only reloads ohai and updates the automatic stuff
[2014-01-16 17:57:42 -0500] GreatSUN_: slbmeh: automatic stuff doesnt mean node attributes, right?
[2014-01-16 17:58:03 -0500] slbmeh: GreatSUN_: correct, the node attributes populated by ohai
[2014-01-16 18:00:31 -0500] GreatSUN_: slbmeh: query pls ;-)
[2014-01-16 18:01:15 -0500] dorgan: So I am trying to build a box image using packer.io using virtualbox is there a way to reference the iso_url inside of another parameter, meaning is there a token i can use for that value??
[2014-01-16 18:02:13 -0500] tscanausa: dorgan: kinda a question for #packer-tool
[2014-01-16 18:06:31 -0500] shlant: what is the best way to sleep only if package is update/installeD?
[2014-01-16 18:06:45 -0500] dorgan: tscanausa: thanks couldnt find the right room
[2014-01-16 18:06:45 -0500] workmad3: shlant: why would you sleep in a chef run?
[2014-01-16 18:07:00 -0500] helfire: i have a really odd problem. My init script is in a template and is unix linefeed on my mac, i upload the cookbook and when it runs i get ^M in the script. I've deleted and uploaded it again, still same issue. I've dos2unix before uploading, no help. Any ideas?
[2014-01-16 18:07:16 -0500] coderanger: workmad3: It comes up when you have to wait for a service to come up before configuring it
[2014-01-16 18:13:02 -0500] slbmeh: helfire: could be a setting in the git repo
[2014-01-16 18:15:18 -0500] helfire: slbmeh: ya, but i'm even uploading right after i do a dos2unix, git doesnt show diff, and I tried forcing to lf
[2014-01-16 18:15:31 -0500] helfire: bumped the version, seeing if it's cached somewhere
[2014-01-16 18:16:01 -0500] shlant: workmad3: our custom cookbook has a sleep after dnsmasq package install to give it time to get running
[2014-01-16 18:16:07 -0500] shlant: don't ask why haha
[2014-01-16 18:16:45 -0500] GreatSUN_: hey coderanger :-)
[2014-01-16 18:16:51 -0500] GreatSUN_: nice to see ya :-)
[2014-01-16 18:17:49 -0500] GreatSUN_: does anyone of you guys know how I can reload node attributes from ohai from within a library at the time the library is loaded before we are getting into recipes?
[2014-01-16 18:18:52 -0500] GreatSUN_: currently I am extending ohai with a custom plugin from within a library which is loaded and executed automatically (to be honest, it is no real library code, it is just ruby-code)
[2014-01-16 18:19:11 -0500] GreatSUN_: after the plugin is placed, ohai delivers a new attribute
[2014-01-16 18:19:20 -0500] slbmeh: helfire: what does  git config --list | grep -E "core.(crlf|eol|attributes|whitespace)" do?
[2014-01-16 18:19:36 -0500] GreatSUN_: but up to now every effort to get this attribute into the node attributes at the same chef-run was failing
[2014-01-16 18:19:51 -0500] GreatSUN_: when I run chef again, the attribute persists
[2014-01-16 18:20:49 -0500] helfire: slbmeh: core.eol=lf
[2014-01-16 18:24:06 -0500] slbmeh: helfire: that could be it, core.eol ensures your working tree will have lf
[2014-01-16 18:24:29 -0500] helfire: slbmeh: lf==unix ?
[2014-01-16 18:24:40 -0500] aaronfeng: is it possible to use remote_file resource with local file?  ie source file:///foo.bar  the documentation seems to say it's possible.  however, i'm running into issues like http://stackoverflow.com/questions/19877271/chefs-remote-file-with-local-file-source
[2014-01-16 18:24:43 -0500] helfire: crlf == win ?
[2014-01-16 18:24:51 -0500] helfire: or is it just hiding it from me
[2014-01-16 18:24:55 -0500] slbmeh: helfire: even if the file was committed with crlf you'll always see lf
[2014-01-16 18:25:00 -0500] helfire: gah!
[2014-01-16 18:28:35 -0500] CPS: question about ERBs. I've got a list of objects set up like this: "name" : {object fields}. how do I access the name of each object in the array?
[2014-01-16 18:29:30 -0500] freezey: CPS: whats the full structure?
[2014-01-16 18:29:35 -0500] freezey: databag?
[2014-01-16 18:29:49 -0500] CPS: i'm pulling from a databag
[2014-01-16 18:29:56 -0500] CPS: but it's an array of that kind of object
[2014-01-16 18:30:06 -0500] CPS: string name : {fields}
[2014-01-16 18:31:20 -0500] freezey: i would do something like n = search(databag, id:something) and in the erb @n.each do |x| something like that
[2014-01-16 18:31:36 -0500] freezey: or just <%= @n %>
[2014-01-16 18:31:57 -0500] freezey: be easier to tell from what your looking at
[2014-01-16 18:32:03 -0500] helfire: slbmeh: took all that out, but still get ^M in the cookbook on the server, really odd, vagrant works
[2014-01-16 18:32:19 -0500] CPS: won't @n just print the object?
[2014-01-16 18:32:35 -0500] slbmeh: helfire: after you drop that setting you need to renormalize
[2014-01-16 18:33:02 -0500] slbmeh: helfire: git rm --cached -r . ; git reset --hard
[2014-01-16 18:33:11 -0500] freezey: forgot 1 part which would be n['idnane']
[2014-01-16 18:33:24 -0500] freezey: that will push through whatever the id starts with
[2014-01-16 18:34:17 -0500] CPS: what is idnane?
[2014-01-16 18:34:21 -0500] help123: Hello, need some help with http://pastie.org/private/t6bftvxdatvmm0ehgfowww. Basically would like to run that command whenever the file changes or gets added then if exit is 0 restart the service.
[2014-01-16 18:34:53 -0500] helfire: slbmeh: odd, still nothing
[2014-01-16 18:35:48 -0500] freezey: CPS: whats the full databag structure.. is it literally just { "name" : "value", "name" : "value"}
[2014-01-16 18:36:32 -0500] slbmeh: helfire: so you don't see windows line endings after doing that
[2014-01-16 18:36:51 -0500] helfire: well i'll re-upload, but i dont see a change either way
[2014-01-16 18:37:15 -0500] CPS: freezey: https://gist.github.com/anonymous/8460678
[2014-01-16 18:37:25 -0500] CPS: i need to iterate over that and access each field
[2014-01-16 18:37:36 -0500] CPS: the internals I can do, it's "name" i don't know how to access
[2014-01-16 18:37:54 -0500] freezey: you would assign it
[2014-01-16 18:38:05 -0500] freezey: so what i did which could be wrong is once you get the databag in a search
[2014-01-16 18:38:15 -0500] freezey: so like n = databag
[2014-01-16 18:38:20 -0500] freezey: n['name']
[2014-01-16 18:38:27 -0500] freezey: you can assign that
[2014-01-16 18:38:29 -0500] freezey: and just flip through it
[2014-01-16 18:38:45 -0500] freezey: so 1 sec i will write it up
[2014-01-16 18:41:26 -0500] marbly: hiya! (hopefully) quick question... on windows, I'm trying to add notepad++ to shell context menu via registry_key... the problem is that the data I need to edit is for the value named (default)... is there a particular way to access that? going with :name => "(Default)" just creates an additional value called "(Default)"... which doesn't help matters
[2014-01-16 18:42:02 -0500] marbly: sorry, should mention that this is using the registry_key resource
[2014-01-16 18:43:46 -0500] ddyke: Good afternoon. Still having that issue with the node timing out when trying to pull the run list. After tailing the logs on the chef-server. I see that the node times out when trying to POST to /environments/development/cookbook_versions
[2014-01-16 18:45:16 -0500] mondo: Is anyone managing RHN channel subscriptions with Chef?
[2014-01-16 18:47:09 -0500] freezey: CPS: actually here is a decent example
[2014-01-16 18:47:09 -0500] freezey: http://stackoverflow.com/questions/11490781/chef-and-ruby-templates-hw-to-loop-though-key-value-pairs
[2014-01-16 18:49:20 -0500] helfire: i really really dont get why my nodes think there are windows new lines in the init script
[2014-01-16 18:49:38 -0500] geggam: because windows suck
[2014-01-16 18:49:56 -0500] helfire: well, i agree, but i'm on a mac, and they're linux servers :)
[2014-01-16 18:50:10 -0500] geggam: what editor creating files with ?
[2014-01-16 18:50:13 -0500] helfire: vi
[2014-01-16 18:50:45 -0500] geggam: you prolly have rouge dev adding windows newlines to piss you off
[2014-01-16 18:50:58 -0500] helfire: it's only on my mac and the chef-server right now
[2014-01-16 18:51:10 -0500] geggam: nsa
[2014-01-16 18:53:25 -0500] rombob: somebody have idea why template resource failing with 403 response from chef server? some templates pass OK and some are failing, also failure can appear and disappear, can be timeout or networking problem? the failure doesnt appear while testing with chef zero
[2014-01-16 19:00:17 -0500] ddyke: Has anyone ever seen checksum errors from the postgres log on the chef server when uploading a new cookbook
[2014-01-16 19:02:27 -0500] fleish: hi all, cross posting from openstack since I don't have any issues with nodes I don't build with knife ... I'm having an issue where nodes I create with chef's knife utility have issues on reboot. they don't seem to poll the nova controller for their data (or if they do, the nova controller never receives it) and therefore throw "no instance data found in start-local" ... and then "cloud-init-nonet waiting 120 seconds for a network device
[2014-01-16 19:02:28 -0500] fleish: until they timeout. during this time though, I can ping the node ip address so it seems it manages to dhcp correctly. but I don't see anything in the nova-api.log file indicating it asks for its data. any ideas?
[2014-01-16 19:09:34 -0500] helfire: so a co-worker uploaded the cookbook and now it works. I'm blowing away all my git config
[2014-01-16 19:11:35 -0500] matticulous: hoping some python folks can help: trying to use the graphite cb. it's erroring on amzn linux (2013.09) in the python cb complaining "Wheel installs require setuptools >= 0.8 for dist-info support." things run successfully in a cents 6.5 vagrant machine. can someone help me learn my way?
[2014-01-16 19:13:25 -0500] borntyping: matticulous: That would imply you have a recent version of pip (the package manager) but an old version of setuptools (a libary it uses)
[2014-01-16 19:13:51 -0500] slbmeh: matticulous: i actually saw a similar issue yesterday, i just did an execute 'easy_install setuptools' block before i installed pip
[2014-01-16 19:14:27 -0500] borntyping: `pip upgrade setuptools` or `python_pip "setuptools" do action :upgrade end` should solve things if that's the case
[2014-01-16 19:15:26 -0500] matticulous: borntyping: how can i verify? pip -V on both machines produces pip 1.5
[2014-01-16 19:15:33 -0500] slbmeh: borntyping: thats a much better way than what i did, now to remember where i did that and change it
[2014-01-16 19:20:32 -0500] borntyping: matticulous: python -c "import setuptools; print(setuptools.__version__)"
[2014-01-16 19:21:19 -0500] matticulous: borntyping: aha! 0.6 on amazon; 0.8 on my vagrant vm.
[2014-01-16 19:22:07 -0500] borntyping: pip, setuptools and virtualenv are all useful to have at the latest versions
[2014-01-16 19:22:31 -0500] matticulous: would the install just have been skipped totally on amazon?
[2014-01-16 19:22:48 -0500] borntyping: matticulous: ?
[2014-01-16 19:23:51 -0500] matticulous: borntyping: sorry. crummy question. :) i just made an assumpting that setup of python-related things would have been consistent across the 2 machines since they are both using the python cb.
[2014-01-16 19:24:32 -0500] Dairenn: If I want to use a variable like #{app_path} across two different recipes, say default.rb and somethingelse.rb--I'd want to define that in, like, attributes/default.rb, right?
[2014-01-16 19:24:53 -0500] borntyping: matticulous: I don't think the python cookbook installs setuptools
[2014-01-16 19:26:46 -0500] matticulous: borntyping: looks like it does: execute "install-setuptools" do .. end
[2014-01-16 19:26:59 -0500] matticulous: but there is a 'not_if "#{node['python']['binary']} -c 'import setuptools'"'
[2014-01-16 19:27:27 -0500] matticulous: so my assumption is that since it is finding at least a version (0.6) it isn't running
[2014-01-16 19:28:47 -0500] borntyping: matticulous: that sounds about right
[2014-01-16 19:30:22 -0500] CPS: thanks freezey that helped
[2014-01-16 19:31:16 -0500] freezey: yep
[2014-01-16 19:36:07 -0500] shlant: is there a reason why vagrant puts client.rb in /tmp and then looks for it on subsequent runs in /etc/chef?
[2014-01-16 19:36:22 -0500] shlant: is there something I need in the Vagrantfile?
[2014-01-16 19:37:21 -0500] slbmeh: shlant: i do chef.provisioning_path "/etc/chef"
[2014-01-16 19:38:00 -0500] shlant: slbmeh: can that be put in knife.rb?
[2014-01-16 19:38:21 -0500] slbmeh: shlant: that's in the provisioning block in my Vagrantfile
[2014-01-16 19:39:03 -0500] slbmeh: shlant: i use chef solo provisioner and that puts solo.rb in /etc/chef, but i'm sure chef client works the same
[2014-01-16 19:43:51 -0500] shlant: slbmeh: just testing now
[2014-01-16 19:48:32 -0500] shlant: slbmeh: working. thanks!
[2014-01-16 19:51:52 -0500] rep0st: ohai guys. I'm trying to figure out how to do a knife search against a specific cookbook version
[2014-01-16 20:06:51 -0500] allaire: what do you guys use to install php-fpm
[2014-01-16 20:15:28 -0500] tscanausa: php-fpm cookbook
[2014-01-16 20:30:48 -0500] allaire: tscanausa: Do you also use the php cookbook (https://github.com/opscode-cookbooks/php) ?
[2014-01-16 20:30:52 -0500] allaire: Or only php-fpm cookbookk
[2014-01-16 20:31:00 -0500] tscanausa: I use both
[2014-01-16 20:31:04 -0500] allaire: what for
[2014-01-16 20:31:30 -0500] tscanausa: I use the php one for pecl / pear and php-fpm for managing pools
[2014-01-16 20:32:33 -0500] allaire: tscanausa: Ok but you dont include php::default to install php5, php-cgi from package or source, correct?
[2014-01-16 20:35:07 -0500] tscanausa: allaire: here is my run list https://gist.github.com/canausa/8462937
[2014-01-16 20:35:27 -0500] allaire: tscanausa: oh ok so you also install php5
[2014-01-16 20:35:32 -0500] allaire: any reason why?
[2014-01-16 20:36:10 -0500] tscanausa: Unfortunate we have a bunch of command line tools that require php5
[2014-01-16 20:36:30 -0500] allaire: tscanausa: okok
[2014-01-16 20:37:34 -0500] allaire: tscanausa: so u use /usr/bin/php or /usr/bin/php5 ?
[2014-01-16 20:39:10 -0500] allaire: nvm it's the same :)
[2014-01-16 20:43:25 -0500] EricL: Is there a howto on launching ec2 instances inside VPC?
[2014-01-16 20:43:51 -0500] EricL: I am trying to cobble information together from StackOverflow responses and my marginal understanding of Chef.  I feel like there must be a better way.
[2014-01-16 20:57:56 -0500] tscanausa: EricL: what do you mean launching? I am not sure how chef plays into it
[2014-01-16 20:58:57 -0500] EricL: I want to do an ec2 server create in a vpc.  Normally Chef tries to talk on private IPs which is clearly a problem.
[2014-01-16 21:00:25 -0500] tscanausa: EricL: I think most people in a vpc situation use a nat server to handle it.
[2014-01-16 21:00:56 -0500] tscanausa: or they put the chef server in a dmz with the vpc
[2014-01-16 21:01:37 -0500] EricL: I was hoping to not have to manage a second chef server or add a VPN machine.
[2014-01-16 21:04:36 -0500] tscanausa: EricL: I am very limited but it looks like vpc either have EIPs or use a nat instance to talk to the internet
[2014-01-16 21:05:28 -0500] tscanausa: http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenarios.html
[2014-01-16 21:05:45 -0500] EricL: tscanausa: So I have to run an AWS API command to create an EIP and then separately run knife ec2 server create with the --associate-epi $address that was just created?
[2014-01-16 21:06:07 -0500] EricL: iow. Chef won't automate the creation of machines inside a VPC without me doing an additional step?
[2014-01-16 21:06:36 -0500] tscanausa: Chef does not create anything.
[2014-01-16 21:08:08 -0500] rep0st: there are knife plugins that allow integration with creating instances
[2014-01-16 21:08:30 -0500] rep0st: in my use case i use the knife-xenserver plugin in order to integrate configuring my machines while creating machines
[2014-01-16 21:08:45 -0500] rep0st: the creating and configuration are seperate functions
[2014-01-16 21:10:18 -0500] EricL: I use knife ec2. But it doesn't appear that knife ec2 can create the eip on the fly.
[2014-01-16 21:12:25 -0500] tscanausa: EricL: That is probably a limitation of fog / ec2 plugin and not really chef's fault
[2014-01-16 21:17:05 -0500] EricL: I wasn't trying to *blame* chef.  I was trying to figure out how to leverage chef to automate the rest of the process.
[2014-01-16 21:18:20 -0500] ddyke: Question. I bumped a cookbook from version 0.1.3 -> 0.1.4
[2014-01-16 21:18:29 -0500] ddyke: however when i run chef-client on the node, it only pulls 0.1.3
[2014-01-16 21:18:49 -0500] ddyke: if i delete the cached cookbook, still pulles 0.1.3. if i bump version again to 0.1.5, only pulls 0.1.3. Has anyone run into this before?
[2014-01-16 21:18:51 -0500] iverson0881: ddyke: is the chef environment hardcoded to a specific cookbook version?
[2014-01-16 21:18:51 -0500] tscanausa: EricL: unfortunately I dont think you can.
[2014-01-16 21:19:03 -0500] ddyke: iverson0881: negative.
[2014-01-16 21:19:33 -0500] heathsnow_: ddyke: perhaps a role is hardcoded to a specified version?
[2014-01-16 21:20:04 -0500] ddyke: iverson0881: node is a fresh bootstrap, there arn't any roles applied. For sanity. How would I check the environment specific version (I have not set anything, but  just for peace of midn)
[2014-01-16 21:20:58 -0500] wdilly: does chef 11 use couchdb?
[2014-01-16 21:21:13 -0500] ddyke: iverson0881: i ran knife environment show environment -Fj
[2014-01-16 21:21:28 -0500] EricL: tscanausa: Ok, thanks.
[2014-01-16 21:21:36 -0500] wdilly: because my chef 11 server is being consumed by bean.smp which appears to be a couchdb process....
[2014-01-16 21:21:54 -0500] bean: beambeam.smp
[2014-01-16 21:21:57 -0500] bean: beam.smp*
[2014-01-16 21:22:07 -0500] wdilly: true story!
[2014-01-16 21:22:08 -0500] wdilly: beam!
[2014-01-16 21:22:40 -0500] wdilly: beam.smp
[2014-01-16 21:22:49 -0500] davidordave: @wdilly http://docs.opscode.com/server_deploy_standalone.html
[2014-01-16 21:23:03 -0500] davidordave: assuming that it is updated, it includes couchdb
[2014-01-16 21:24:36 -0500] wdilly: davidordave, okay, it is a version 11.0
[2014-01-16 21:24:55 -0500] wdilly: davidordave, but my load is astronomical for no apparent reason and beam.smp is eating my cpu
[2014-01-16 21:27:02 -0500] davidordave: Just checked an instance I have running, and beam is the top process, but not in the astronomical territory. Sorry, I don't have the technical info to know why it would eat your processor.
[2014-01-16 21:42:50 -0500] shlant: ok chefs
[2014-01-16 21:42:55 -0500] shlant: I have a conundrum
[2014-01-16 21:43:21 -0500] shlant: I need to get my encrypted_data_bag_secret onto 30+ serves
[2014-01-16 21:43:29 -0500] shlant: what are my options?
[2014-01-16 21:43:37 -0500] shlant: I was going to go with scp
[2014-01-16 21:43:45 -0500] shlant: but /etc/chef is restricted
[2014-01-16 21:46:11 -0500] slbmeh: shlant: can you scp the other direction? you can use knife ssh with a search string to get all of the nodes and scp at once
[2014-01-16 21:47:03 -0500] gchristensen: shlant: cat .chef/encrypted_data_bag_secret | ssh $1 sudo tee /etc/chef/encrypted_data_bag_secret; ssh $1 sudo chown root:root /etc/chef/encrypted_data_bag_secret ssh $1 sudo chmod 600 /etc/chef/encrypted_data_bag_secret
[2014-01-16 21:47:27 -0500] gchristensen: shlant: cat .chef/encrypted_data_bag_secret | ssh $1 sudo tee /etc/chef/encrypted_data_bag_secret; ssh $1 sudo chown root:root /etc/chef/encrypted_data_bag_secret; ssh $1 sudo chmod 600 /etc/chef/encrypted_data_bag_secret
[2014-01-16 21:47:31 -0500] gchristensen: ^ forgot a semi-colon
[2014-01-16 21:47:37 -0500] doomviking: assuming theres passwordless sudo
[2014-01-16 21:47:49 -0500] shlant: nope haha
[2014-01-16 21:47:54 -0500] gchristensen: if you need to enter a password, add -t to the ssh command and it'll prompt
[2014-01-16 21:47:57 -0500] gchristensen: it'll be a PITA but ...
[2014-01-16 21:48:19 -0500] shlant: i'll try em out
[2014-01-16 21:48:41 -0500] gchristensen: shlant: I have that in a bash script ... ./bin/add-data-bag-secret <host>
[2014-01-16 22:18:29 -0500] shlant: slbmeh: this is what I used to get it to work. It's a doozy!
[2014-01-16 22:18:30 -0500] shlant: knife ssh "role:web" "sudo apt-get install sshpass; sudo sshpass -p 'password' scp -o stricthostkeychecking=no  shlant@192.168.168.1:~/.chef/encrypted_data_bag_secret /etc/chef" -p 6000 -x user -P 'password' -a ipaddress --no-host-key-verify
[2014-01-16 22:56:38 -0500] wdilly: Im trying to change the group of a directory, but it wont let me because its not in /etc/group presumably, however, the group is in ldap... can i force it somehow?
[2014-01-16 22:57:58 -0500] helfire: wdilly: can you do it via commandline? if it's not in /etc/group the system doesnt know. You may be able to just set the group id
[2014-01-16 22:58:12 -0500] wdilly: i can with chgrp
[2014-01-16 22:59:45 -0500] helfire: is chgrp provided by something other than the os like centrify or whatever you're using for ldap auth?
[2014-01-16 22:59:55 -0500] wdilly: no, im using openldap
[2014-01-16 23:00:32 -0500] wdilly: also the instance in question is a working ldap client
[2014-01-16 23:01:09 -0500] wdilly: helfire, also, i am doing the chgrp with the gid not the name, and doing the same in my recipe
[2014-01-16 23:03:11 -0500] helfire: can you enable debugging and see what the actual command chef is trying to do? i've found that usefull when debugging a symlync
[2014-01-16 23:03:15 -0500] helfire: link*
[2014-01-16 23:20:27 -0500] dgarstang1: does search work inside vagrant?
[2014-01-16 23:20:46 -0500] flaccid: dgarstang1: no, its chef solo
[2014-01-16 23:21:03 -0500] dgarstang1: flaccid: any best practices way to develop and test it in that case?
[2014-01-16 23:21:20 -0500] flaccid: dgarstang1: design the cookbooks to support chef solo
[2014-01-16 23:21:57 -0500] dgarstang1: flaccid: it'd be better if the coobook didn't know the difference
[2014-01-16 23:22:09 -0500] douglaswth: flaccid, dgarstang1: you can use chef server and chef zero in vagrant
[2014-01-16 23:22:37 -0500] flaccid: dgarstang1: it certainly would
[2014-01-16 23:22:50 -0500] chip-: dgarstang1: use the vagrant-chefzero plugin and the chef zero provisioner.
[2014-01-16 23:22:57 -0500] dgarstang1: yeah I guess I'd just like a way to even test that and see what chef search returns from within a recipe
[2014-01-16 23:23:15 -0500] flaccid: cool i need to check those out
[2014-01-16 23:24:11 -0500] rberger: Anyone know of a knife-docker plugin that will treat docker containers inside a Vagrent VM (ala dvm or docker-osx) so you can create/bootstrap docker containers?
[2014-01-16 23:24:45 -0500] rberger: I already see the two older knife-dockers on github but they are more for creating containers
[2014-01-16 23:25:07 -0500] chip-: rberger: Best I've seen is the kitchen-docker, which does that via the docker API, but not as a knife plugin
[2014-01-16 23:25:33 -0500] rberger: chip: yeah. Need a knife-docker plugin to work with Spiceweasel
[2014-01-16 23:26:54 -0500] mattray: dgarstang1: use vagrant-chef-zero instead of chef-solo
[2014-01-16 23:27:15 -0500] mattray: oops, chip- already mentioned it
[2014-01-16 23:27:29 -0500] dgarstang1: mattray: off to a great start, running with chef-zero it can't find my roles.
[2014-01-16 23:28:17 -0500] mattray: dgarstang1: it only knows about .json ones, I had an branch to vagrant-chef-zero adding ruby ones but it got broken by ruby dependencies
[2014-01-16 23:28:40 -0500] dgarstang1: ugh
[2014-01-16 23:28:41 -0500] mattray: dgarstang1: ruby and I are not currently friends
[2014-01-16 23:28:51 -0500] dgarstang1: mattray: ruby and I have never been friends
[2014-01-16 23:29:04 -0500] mattray: dgarstang1: correction. The Ruby ecosystem and I are not currently friends
[2014-01-16 23:29:32 -0500] dgarstang1: *sigh* do I want to go down this path right now
[2014-01-16 23:30:00 -0500] dgarstang1: so I basically can't go chef.run_list = [ "role[foo]" ]
[2014-01-16 23:32:01 -0500] dgarstang1: which also means none of my data bags will work
[2014-01-16 23:32:07 -0500] dgarstang1: or rather, no recipes that use data bags will work
[2014-01-16 23:36:19 -0500] dgarstang1: ok, so here's another question... knife-eu2 search node "role:role_redis_master" ... the IP is empty... y?
[2014-01-16 23:44:32 -0500] Dairenn: I'd like to write an if statement that tests on whether :status => true for a service - what does that look like?
[2014-01-16 23:45:58 -0500] WindowsChef: Have a question regarding running batch files from within recipes.. I've found the windows_batch stuff, but not sure how to get my batch files (.cmd, .sql files) to copy to the chef node along with the recipes, do I put them in the "files" folder?
[2014-01-16 23:46:20 -0500] Dairenn: Yes, unless you want those files to be different depending on where they go.
[2014-01-16 23:46:34 -0500] Dairenn: In which case, I would make those files into templates
[2014-01-16 23:47:12 -0500] WindowsChef: I added them to the /files folder, but I'm not seeing them in the C:\chef\cache\cookbooks\etc.. on the remote machine
[2014-01-16 23:47:30 -0500] WindowsChef: Thanks btw Dairenn
[2014-01-16 23:47:32 -0500] Dairenn: Try files/default
[2014-01-16 23:47:45 -0500] Dairenn: You also have to use cookbook_file to make sure it gets to its destination
[2014-01-16 23:48:33 -0500] WindowsChef: so you have to write a recipe to move the files to somewhere, they can't be accessed from the cache directly
[2014-01-16 23:48:40 -0500] Dairenn: Correct.
[2014-01-16 23:48:44 -0500] WindowsChef: okay
[2014-01-16 23:48:48 -0500] WindowsChef: ill look into that
