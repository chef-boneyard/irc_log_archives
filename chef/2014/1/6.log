[2014-01-06 18:58:05 -0500] mveitas: does anybody have a script to cleanup stale chef nodes/clients?
[2014-01-06 19:00:09 -0500] gchristensen: mveitas: if all your nodes check in on a regular basis, you could delet nodes that haven't checked in within X grace period
[2014-01-06 19:01:23 -0500] mveitas: Right now we are a converge once and done model... just seeing if anybody had anything before I write a small script to do the cleanup!
[2014-01-06 19:01:34 -0500] gchristensen: nope
[2014-01-06 19:02:08 -0500] mveitas: thanks
[2014-01-06 19:23:15 -0500] dgarstang1: in a template, does if @foo test foo exists is just not empty? I think it's only testing not empty. How do I test if foo is defined?
[2014-01-06 19:27:07 -0500] AntelopeSalad: does anyone know of a really good tutorial for deploying apps with chef? the resource_deploy docs are ok but it doesn't have enough examples
[2014-01-06 19:32:00 -0500] dgarstang1: well, ruby docs say instance_variable_defined? should work. Nope.
[2014-01-06 19:32:39 -0500] ssd7: dgarstang1: Now that sounds like a case where you /would/ want defined? but I haven't tried it in a template specifically; however, I'd look hard at why you care about whether something is empty vs whether it is defined and see if that is really the design you want.
[2014-01-06 19:33:22 -0500] dgarstang1: ssd7: empty may be valid. undefined rarely is.
[2014-01-06 19:34:19 -0500] ssd7: dgarstang1: What do you mean by empty though?  If you mean containing nil, then there is no difference since you will get nil back if you reference a previously undefined instance variable.
[2014-01-06 19:35:11 -0500] dgarstang1: ssd7: if it hasn't been defined previously as an attribute, then do use some dumb default.
[2014-01-06 19:35:27 -0500] gchristensen: anyone know of a .ini writing helper for hashes?
[2014-01-06 19:35:42 -0500] dgarstang1: ssd7: if it has been previously defined (which may be nil), then use that and dont use the dumb default.
[2014-01-06 19:36:11 -0500] ssd7: dgarstang1: Ahh, I see what you mean now.
[2014-01-06 19:36:36 -0500] spiffytech: What's the standard Chef way to configure a server's DNS server? I see a community cookbook "resolvconf", but 90 downloads.
[2014-01-06 19:36:52 -0500] spiffytech: * but I'd expect something so common for organizations to have more than 90 downloads
[2014-01-06 19:37:06 -0500] dgarstang1: ssd7: i could use has_key but then I'd have to check every key
[2014-01-06 19:38:04 -0500] miah: sup
[2014-01-06 19:38:20 -0500] dgarstang1: Well, looks like <% if defined?('@moxi_user') -%> works... at least it gives expected behaviour
[2014-01-06 19:38:50 -0500] miah: you should use .fetch(:key) { CallSomeDefaultFunctionIfItDoesntExist }
[2014-01-06 19:39:10 -0500] miah: also. you should dry up code before you go into templates. unless you like pain.
[2014-01-06 19:39:16 -0500] dgarstang1: miah: and check every single parent key?
[2014-01-06 19:39:37 -0500] miah: yes, and this is why i say. 'dont use so many damned node attributes'
[2014-01-06 19:39:44 -0500] dgarstang1: it's 2 levels...
[2014-01-06 19:39:47 -0500] miah: global variables ftl.
[2014-01-06 19:40:00 -0500] dgarstang1: a moxi user is hardly deserving of global scope
[2014-01-06 19:40:14 -0500] miah: well, if you8're using node attributes you're giving it global scope.
[2014-01-06 19:40:32 -0500] dgarstang1: miah: but it's node['moxi']['user']
[2014-01-06 19:40:42 -0500] zanshin1: Trying to upload a cookbook via `berks upload` and I get the following error. I've got the validator.pem, and my account pem. Not sure what is missing.
[2014-01-06 19:40:42 -0500] zanshin1: Uploading ome_tomcat (0.1.0) to: 'https://est-config1.campus.ksu.edu:443/'
[2014-01-06 19:40:42 -0500] zanshin1: Ridley::Errors::HTTPUnauthorized: {"error":["Invalid signature for user or client 'est-config1.campus.ksu.edu'"]}
[2014-01-06 19:40:49 -0500] miah: i have no idea what a moxi is. and i honestly dont care.
[2014-01-06 19:41:00 -0500] dgarstang1: miah: doesnt matter what it is
[2014-01-06 19:41:10 -0500] dgarstang1: it's a cookbook specific user and pass
[2014-01-06 19:41:26 -0500] miah: i'd .fetch(:moxi) and set defaults if it doesnt exist.
[2014-01-06 19:41:30 -0500] miah: totally not difficult
[2014-01-06 19:41:57 -0500] dgarstang1: there's multiple attributes
[2014-01-06 19:42:20 -0500] miah: welcome to programming
[2014-01-06 19:42:35 -0500] borntyping: dgarstang1: instead of checking if an attribute exists, set a sensible default (i.e. nil)
[2014-01-06 19:42:48 -0500] miah: nil isn't a sensible default.
[2014-01-06 19:42:49 -0500] dgarstang1: miah: wow that was condascending. Thanks for your help. :)
[2014-01-06 19:43:25 -0500] miah: as always, i make a recommendation. you tell me thats too hard.
[2014-01-06 19:43:29 -0500] borntyping: nil is a sensible default, it's much more sane to check if the attr is nil than it is to check if the attr exists
[2014-01-06 19:43:36 -0500] laurent\: gosh i see the nagios cookbook is no more a opscode cookbook
[2014-01-06 19:43:44 -0500] dgarstang1: miah: Thanks for your help. :)
[2014-01-06 19:44:12 -0500] dgarstang1: borntyping: unless checking the key causes an error cuz the parent key doesn't exist
[2014-01-06 19:44:38 -0500] miah: https://www.ruby-forum.com/topic/179328
[2014-01-06 19:44:41 -0500] Dairenn: I'm getting a little lost on this.  I want to do a case node["roles"] and then lines like: when "some_role A" when "role B" (etc) end.  Can I do that?  I don't think it's working.  Possibly because the node is in more than one row, so the attribute is an array.  I feel like this will lead to having to do some kind of regex to match any element that will match?
[2014-01-06 19:44:56 -0500] borntyping: dgarstang1: that's the problem having nil as a deafult attribute solves
[2014-01-06 19:46:02 -0500] borntyping: miah: that's not really relevant to chef attributes
[2014-01-06 19:46:15 -0500] miah: ya. ok.
[2014-01-06 19:46:24 -0500] miah: i'll just shutup and let ya'll keep on going
[2014-01-06 19:46:41 -0500] dgarstang1: jeez
[2014-01-06 19:46:45 -0500] ssd7: dgarstang1: miah Well, one thing that I think everyone can agree on, is that you probably don't want that kind of logic in the /template/ but want to clean up the values before feeing them to the template.
[2014-01-06 19:46:56 -0500] ssd7: well, I /think/ that is something most people agree on at this point.
[2014-01-06 19:47:06 -0500] dgarstang1: ssd7: i would imagine good code checks in both places.
[2014-01-06 19:49:24 -0500] ssd7: dgarstang1: It is a matter of preference perhap.  I treat templates much like private libraries where the caller should know how to call the relevant functions.  Personally, I don't like cluttering such functions with a lot of error checking.
[2014-01-06 19:51:38 -0500] spheromak: ssd7: guess i go back to MVC with templates, and call them views.  try to put logic in recipes / libs where you can, and just pass valid things to be displayed/rendered to templates.  This is imo 101 level good stuff.
[2014-01-06 19:52:05 -0500] spheromak: ssd7: tl;dr agreed :D
[2014-01-06 19:52:31 -0500] ssd7: spheromak: Yeah, the "views" angle works as well, I just do less of that kind of programming (to the extent that I do any these days)
[2014-01-06 19:53:34 -0500] spheromak: I think as conceptual bridge if someone groks MVC you can break recipe/libs/lwrp -> C  templates -> V  bags roles attribs -> M (*with caveats)
[2014-01-06 19:54:14 -0500] c_t: spheromak: freezing data & search index to disk is coming very soon
[2014-01-06 19:54:17 -0500] c_t: (wooo)
[2014-01-06 19:54:27 -0500] spheromak: c_t: thats sweet
[2014-01-06 19:54:31 -0500] ssd7: c_t: Is that re your go chef-server?
[2014-01-06 19:54:37 -0500] c_t: ja
[2014-01-06 19:54:40 -0500] ssd7: Sweet
[2014-01-06 19:54:49 -0500] c_t: needs some testing & docs first
[2014-01-06 19:55:01 -0500] c_t: and I'm strongly considering compressing the files as they're written
[2014-01-06 19:55:14 -0500] spheromak: c_t: im refactoring the whole post stuff in the go-chef client lib to make it moar awesomer
[2014-01-06 19:55:22 -0500] c_t: awesome
[2014-01-06 19:55:44 -0500] spheromak: works good for reading from chef-server not somuch ifyou want to manage objects.. yet
[2014-01-06 19:55:53 -0500] c_t: spheromak: one of the main reasons I started on said project was to learn go better
[2014-01-06 19:55:59 -0500] spheromak: yep
[2014-01-06 19:56:08 -0500] c_t: so I fully expect there is non-optimal coding in there, especially from early on
[2014-01-06 19:56:14 -0500] spheromak: we had this convo i started working on a chef-server thinggy in go as well for the same reason ;)
[2014-01-06 19:56:22 -0500] c_t: oh right
[2014-01-06 19:56:35 -0500] spheromak: moved onto a knife-thinggy
[2014-01-06 19:56:57 -0500] c_t: speaking of, what's the usual syntax for specifying search order with knife search?
[2014-01-06 19:57:10 -0500] spheromak: what do you mean ?
[2014-01-06 19:57:16 -0500] c_t: searching works pretty well, far as chef-pedant indicates, but it's not ordering yet
[2014-01-06 19:57:23 -0500] spheromak: oh
[2014-01-06 19:57:44 -0500] spheromak: ddidn't think there was ordering on the API
[2014-01-06 19:57:50 -0500] c_t: like is it "<key> ASC/DESC", or is it somewhat different?
[2014-01-06 19:57:54 -0500] spheromak: or its not exposed by knife
[2014-01-06 19:58:07 -0500] c_t: it just gets passed through to solr or equivalent
[2014-01-06 19:58:08 -0500] spheromak: i could just be totally ignorant to it
[2014-01-06 19:58:21 -0500] c_t: there's not much specific on the internets about it
[2014-01-06 19:58:36 -0500] spheromak: -o SORT aparently
[2014-01-06 19:58:45 -0500] c_t: right, that I understand
[2014-01-06 19:58:57 -0500] c_t: I meant what goes in the SORT part, if that makes sense
[2014-01-06 19:59:04 -0500] spheromak: nfi
[2014-01-06 20:00:18 -0500] c_t: should be fairly straightforward to add
[2014-01-06 20:00:40 -0500] Dairenn: I'm getting a little lost on this.  I want to do a case node["roles"] and then lines like: when "some_role A" when "role
[2014-01-06 20:00:40 -0500] Dairenn: +B" (etc) end.  Can I do that?  I don't think it's working.  Possibly because the node is in more than one row, so the
[2014-01-06 20:00:40 -0500] Dairenn: +attribute is an array.  I feel like this will lead to having to do some kind of regex to match any element that will
[2014-01-06 20:00:53 -0500] Dairenn:  um match.  Man that got messed up kinda bad.
[2014-01-06 20:01:00 -0500] spheromak: c_t: is that implemented in knife or in the server tho
[2014-01-06 20:01:36 -0500] c_t: server
[2014-01-06 20:01:51 -0500] c_t: it just occurred to me I just need to look at the solr docs
[2014-01-06 20:02:21 -0500] spheromak:           q.search(@type, escaped_query, config[:sort], start, rows) do |item|
[2014-01-06 20:02:50 -0500] spheromak: yea
[2014-01-06 20:03:11 -0500] spheromak: its in server api.. pedant passes on your impl ? does it not exercise that ?
[2014-01-06 20:03:19 -0500] c_t: strangely, no
[2014-01-06 20:03:24 -0500] btm: @getchefdotcom chef/ohai code review: join: bit.ly/198xZy2, watch:  bit.ly/198xYKi
[2014-01-06 20:04:08 -0500] spheromak: c_t: seems like a tickets.opscode issue ;)
[2014-01-06 20:07:09 -0500] spheromak: c_t: $ knife search node "*:*" -o 'X_CHEF_id_CHEF_X asc'
[2014-01-06 20:07:23 -0500] spheromak: must be the solr string
[2014-01-06 20:07:28 -0500] spheromak: field + order
[2014-01-06 20:09:13 -0500] spheromak: might run that through the parser too. so  -o 'attrib order'
[2014-01-06 20:09:15 -0500] spheromak: -o 'ipaddress asc'
[2014-01-06 20:09:28 -0500] spheromak: neet learned stuff today
[2014-01-06 20:09:31 -0500] spheromak: :)
[2014-01-06 20:14:34 -0500] c_t: should be able to implement that pretty easy
[2014-01-06 20:15:01 -0500] c_t: anyway, I'll be sending my latest changes before too long
[2014-01-06 20:15:13 -0500] c_t: probably tonight some time (real job right now)
[2014-01-06 20:18:45 -0500] jidar: btm: see if they'll look at my issue :P https://tickets.opscode.com/browse/KNIFE-1
[2014-01-06 20:37:04 -0500] dgarstang1: is there any way I can iterate over an array in a template with map but still insert some text into each element in the output?
[2014-01-06 20:37:07 -0500] Dairenn: Looks like the case node["roles"] approach is not the way.  The right way is to put what you want to do into different recipes that go into the run_list of each role.
[2014-01-06 20:38:07 -0500] Dairenn: (I mainly wrote that for http://community.opscode.com/chat/chef SEO juice.  Just in case anyone else wonders how to do what I was trying to do.)
[2014-01-06 20:39:11 -0500] supercom32: When running an executable installer via chef on a node someplace, if the installer invokes a visible window (But does not require the user to interact with it - ie. unattended install) does that cause any issues with chef client? The reason I ask is because I know some things behave differently when they run without an actual user being logged in (desktop session).
[2014-01-06 20:56:49 -0500] phutchin2: I've got a chef server that is eating up every bit of CPU on its host and isnt' giving any useful errors in the logs that I can see. I try to run chef-client against it and it takes forever to try to start then 404's...
[2014-01-06 20:56:54 -0500] phutchin2: Any thoguhts on how to continue to troubleshoot?
[2014-01-06 20:57:46 -0500] phutchin2: I see entries in erchef.log for erchef@127.0.0.1 and thats the last thing that happens before it hangs for a logn time...
[2014-01-06 20:57:50 -0500] gchristensen: is there a way to use python_pip from poise and do pip install -r /path/to/requirements.txt from within a virtualenv?
[2014-01-06 20:59:43 -0500] brandont: Is the cookbook code review happening today?
[2014-01-06 21:00:06 -0500] dgarstang1: How the heck would I get a pipe delimeter between these two elements? http://pastebin.com/VMe4M7XM I can't use join cuz I gotta add stuff to the start of each
[2014-01-06 21:00:52 -0500] spheromak: dgarstang1: foo.map {|i| "foo #{i}" }  (re itterate)
[2014-01-06 21:01:24 -0500] dgarstang1: spheromak: thanks. trying
[2014-01-06 21:01:55 -0500] spheromak: dgarstang1: re your paste your data prob has a pipe in it ;) need to see the in and out data
[2014-01-06 21:02:23 -0500] spheromak: phutchin2: sounds like you might be bittent by unsolvable run_list
[2014-01-06 21:02:49 -0500] spheromak: phutchin2: what version of chef11 server are you running ?
[2014-01-06 21:03:30 -0500] dgarstang1: Nope... <%= @moxi_servers.map {|i| "foo #{i}" } %> gets me the array printed, ie ['a','b']
[2014-01-06 21:03:55 -0500] spheromak: yea
[2014-01-06 21:04:02 -0500] spheromak: you wnat it not being the array ?
[2014-01-06 21:04:10 -0500] spheromak:  map {}.join
[2014-01-06 21:04:35 -0500] dgarstang1: spheromak: right. i want each element with a delimter, which I'd use join for, but also with some text added to the beginning of each element
[2014-01-06 21:04:45 -0500] spheromak: ok
[2014-01-06 21:04:52 -0500] spheromak: so exaclty that with join "delimiter"
[2014-01-06 21:05:03 -0500] spheromak: [3] pry(main)> a.map {|i| "foo #{1}" }.join "HHH"
[2014-01-06 21:05:04 -0500] spheromak: => "foo 1HHHfoo 1HHHfoo 1"
[2014-01-06 21:05:14 -0500] dgarstang1: err, no, cuz that is printing the array verbatim
[2014-01-06 21:05:20 -0500] spheromak: err no
[2014-01-06 21:05:28 -0500] spheromak: cause that code works ^^ :)
[2014-01-06 21:05:36 -0500] dgarstang1: lemme see
[2014-01-06 21:05:45 -0500] spheromak: map returns an aray
[2014-01-06 21:05:46 -0500] btm: @getchefdotcom cookbook code review: join: bit.ly/1dqSQIO, watch: bit.ly/1dqSS3m
[2014-01-06 21:06:37 -0500] btm: jidar: knife issues get looked at on thursdays. I don't see a patch on KNIFE-1 to review: https://wiki.opscode.com/display/chef/Code+Review
[2014-01-06 21:07:37 -0500] jidar: btm: you think I should dig into it and try and figure it out? I don't find very good debugging information out of knife commands for windows
[2014-01-06 21:07:47 -0500] dgarstang1: spheromak: thank, that's it. just spent 3 hours on that
[2014-01-06 21:08:17 -0500] spheromak: map returns an array.  The way to turn an array into a string is join
[2014-01-06 21:08:32 -0500] dgarstang1: spheromak: it's the ruby syntax that gets me, always is
[2014-01-06 21:09:06 -0500] spheromak:  the .'s or the {}'s ?
[2014-01-06 21:09:34 -0500] dgarstang1: spheromak: {}| mostly
[2014-01-06 21:10:05 -0500] spheromak: {||} ?? just short form  do  |blah|  end
[2014-01-06 21:10:15 -0500] dgarstang1: oh but wait. i have <%= @moxi_servers.map {|i| "#{i}/pools/default/bucketsStreaming" }.join "|" %> ... i have to get another chef variable in after the 'Streaming' ...
[2014-01-06 21:10:18 -0500] spheromak: block definition
[2014-01-06 21:10:39 -0500] spheromak: you can do it in a loop
[2014-01-06 21:10:41 -0500] spheromak: same stuff
[2014-01-06 21:10:46 -0500] dgarstang1: pretty sure I can't nest <%= %>
[2014-01-06 21:10:57 -0500] spheromak: <% moxi_servers.each |blah| do %>
[2014-01-06 21:11:32 -0500] spheromak: you can map and use sthat as your incoming array, but you really want 2 values
[2014-01-06 21:11:35 -0500] spheromak: is what you are saying
[2014-01-06 21:11:36 -0500] dgarstang1: yes but how do I insert a 2nd chef var in there?
[2014-01-06 21:11:44 -0500] spheromak: whats the input and desired output :D
[2014-01-06 21:11:50 -0500] spheromak: what 2nd chef var
[2014-01-06 21:12:42 -0500] dgarstang1: spheromak: http://pastebin.com/vV843MA3
[2014-01-06 21:13:00 -0500] dgarstang1: the 2nd default at the end of the url is from @moxi_bucket
[2014-01-06 21:13:08 -0500] dgarstang1: or, should be, rather
[2014-01-06 21:13:17 -0500] spheromak: so you have 2 arrays
[2014-01-06 21:13:31 -0500] spheromak: ?
[2014-01-06 21:13:36 -0500] dgarstang1: no, just one. @moxi_servers. the bucket is common
[2014-01-06 21:13:47 -0500] dgarstang1: N servers. 1 shared bucket
[2014-01-06 21:14:20 -0500] spheromak: i see I think
[2014-01-06 21:15:03 -0500] dgarstang1: just wanna take <%= @moxi_servers.map {|i| "#{i}/pools/default/bucketsStreaming" }.join "|" %> and put @moxi_bucket after the URL once for each element
[2014-01-06 21:15:57 -0500] spheromak: a.map {|i| "foo #{i}|#{i}/somestuff" }.join " "
[2014-01-06 21:16:04 -0500] spheromak: ^^ more like what  you want ?
[2014-01-06 21:16:19 -0500] spheromak: => "foo 1|1/somestuff foo 2|2/somestuff foo 3|3/somestuff"
[2014-01-06 21:17:31 -0500] spheromak: since you are just wantint to concat some strings while looping the array right ?
[2014-01-06 21:17:41 -0500] dgarstang1: spheromak: would a.map {|i| "foo #{i}|#{i}/somestuff" }.join " " work?
[2014-01-06 21:17:47 -0500] dgarstang1: hang on, now I'm just confused
[2014-01-06 21:18:48 -0500] dgarstang1: but the string is another chef var, and I can't put <%= @moxi_bucket %> in the middle of that
[2014-01-06 21:18:59 -0500] spheromak: no
[2014-01-06 21:19:08 -0500] spheromak: you are already in a ruby escape in your erb
[2014-01-06 21:19:14 -0500] spheromak: <% RUBY HERE  %>
[2014-01-06 21:19:14 -0500] dgarstang1: yah
[2014-01-06 21:19:27 -0500] spheromak: so  array.map {|i|}
[2014-01-06 21:19:44 -0500] spheromak: ^^ say loop over each item and do some code in the block '{}
[2014-01-06 21:19:53 -0500] spheromak: assigning each array element to the variable i
[2014-01-06 21:20:17 -0500] spheromak: so foo.map{|i|  "REGULAR RUBY STRING" }
[2014-01-06 21:20:31 -0500] spheromak: so foo.map{|i|  "#{i} #{@instance_var}" }
[2014-01-06 21:20:32 -0500] dgarstang1: isn't that what I got already?
[2014-01-06 21:20:54 -0500] spheromak: i gave you the code to get what you wanted. but you didn't use it how i showed :)
[2014-01-06 21:21:06 -0500] spheromak:  a.map {|i| "foo #{i}|#{@foo}/somestuff" }.join
[2014-01-06 21:21:11 -0500] spheromak: "
[2014-01-06 21:21:46 -0500] dgarstang1: you gave me ... a.map {|i| "foo #{i}|#{i}/somestuff" }.join " " the first time. :)
[2014-01-06 21:21:55 -0500] spheromak: yea
[2014-01-06 21:21:56 -0500] spheromak: i know
[2014-01-06 21:22:03 -0500] spheromak: but i thought you understood that i was just any ruby var
[2014-01-06 21:22:10 -0500] dgarstang1: lemme try the 2nd one...
[2014-01-06 21:22:21 -0500] spheromak: and that @foo is an instance var that you can inseert where i goes
[2014-01-06 21:23:51 -0500] dgarstang1: ok <%= @moxi_servers.map {|i| "#{i}/pools/default/bucketsStreaming/#{@moxi_bucket}" }.join "|" %> did it.
[2014-01-06 21:23:53 -0500] dgarstang1: thanks
[2014-01-06 21:26:36 -0500] spheromak: awesome
[2014-01-06 21:40:39 -0500] gchristensen: I feel like opscode lost something good when they relocated the cookbooks from opscode-cookbooks to random users
[2014-01-06 21:41:06 -0500] gchristensen: not that the random users aren't doing a fine job, but the sheer number of github accounts I have to remember now is monstrous
[2014-01-06 21:43:04 -0500] shlant: how many people here have each cookbook as a separate repo?
[2014-01-06 21:45:50 -0500] jtimberman: gchristensen: the intention was always that cookbooks are consumed through the community site :-|
[2014-01-06 21:45:58 -0500] jidar: I hate what that did to my SourceTree window shlant
[2014-01-06 21:46:04 -0500] c_t: huh
[2014-01-06 21:46:22 -0500] c_t: preliminary investigation indicates that -o "sort term" doesn't actually change the output
[2014-01-06 21:48:24 -0500] gchristensen: jtimberman: yeah, but if you're doing anything other than downloading the cookbook or looking for a decent one, its not very helpful. going right to the source was great. and being able to know almost without fail where it existed was even better. the redirects are good, but I have to double-check that I went where I meant to every time. old habit, but having it owned by a trusted user was definitely nice.
[2014-01-06 21:48:41 -0500] shlant: jtimberman: is the currently recommend practice to have each cookbook as a separate repo? or is it whatever works for you?
[2014-01-06 21:49:18 -0500] gchristensen: shlant: the community has almost entirely moved to separate repos per cookbook
[2014-01-06 21:49:48 -0500] shlant: ok, so it's better for me to that sooner rather than later...
[2014-01-06 21:50:05 -0500] gchristensen: definitely less painful :)
[2014-01-06 21:50:09 -0500] shlant: gchristensen: does it break anything in terms of how chef works? or just how cookbooks are developed?
[2014-01-06 21:50:16 -0500] gchristensen: nope, not really
[2014-01-06 21:50:20 -0500] coderanger: gchristensen: At least the Python stuff was moved all together, hopefully that helps a bit :)
[2014-01-06 21:50:34 -0500] YayMeo: Quick question, looking at just doing some Chef testing to get started on analyzing it for our purposes: Is it significantly different using the Enterprise Chef vs. a local install? I'd rather do a local install to start testing and inspecting but if enterprise works very differently my results may not translate
[2014-01-06 21:50:48 -0500] borntyping: shlant: you can you a mix of both, and the only major change it'll normally introduce is something like librarian or berkshelf
[2014-01-06 21:51:45 -0500] gchristensen: coderanger: a bit :)
[2014-01-06 21:51:51 -0500] shlant: borntyping: If it's only really myself developing cookbooks right now (and in the near future) is it worth it for me to separate them out ?
[2014-01-06 21:51:51 -0500] AntelopeSalad: coderanger: earlier you mentioned forking pg, would the fix be very involved?
[2014-01-06 21:52:13 -0500] coderanger: AntelopeSalad: Don't think so, just append that snippet to the extconf.rb
[2014-01-06 21:52:43 -0500] AntelopeSalad: coderanger: could you point out the -exact- lines i need to append?
[2014-01-06 21:53:15 -0500] coderanger: AntelopeSalad: Not right now
[2014-01-06 21:53:31 -0500] YayMeo: Anybody have an answer for me off-hand?
[2014-01-06 21:53:41 -0500] AntelopeSalad: ok, i figure forking pg is likely the easiest option to get things going with poise-ruby yeah?
[2014-01-06 21:53:46 -0500] jidar: YayMeo: I think functionally they are the same
[2014-01-06 21:53:58 -0500] coderanger: YayMeo: You can install enterprise chef locally
[2014-01-06 21:54:13 -0500] c_t: the open source version might not have partial search, but I'm not entirely certain
[2014-01-06 21:54:17 -0500] YayMeo: okey dokey, then I'll do a local install and assume if we end up going the enterprise route with hosting that it will work identically
[2014-01-06 21:54:20 -0500] borntyping: shlant: I'm probably not the best person to ask - if you're just using a small chef repo for a small set of stuff, it probably isn't (and there are tools to create git repos from existing history of a subfolder); if you plan on open sourcing them or using them with more than 2/3 people (or want to go with current 'best practice'), then you should probably split them
[2014-01-06 21:54:22 -0500] YayMeo: thanks
[2014-01-06 21:54:30 -0500] coderanger: YayMeo: enterprise chef offers a few features not found in the FOSS release, object ACLs, multi-tenancy, reporting
[2014-01-06 21:54:32 -0500] AntelopeSalad: because someone who maintains pg said the logs i provided him don't make it clear
[2014-01-06 21:54:44 -0500] AntelopeSalad: so who knows how long it'll take them to fix it heh
[2014-01-06 21:54:55 -0500] YayMeo: coderanger: Yeah I get that, I just mean as far as usability goes like I'll be analyzing how easy it is to use and interoperate with our infrastructure etc
[2014-01-06 21:54:56 -0500] coderanger: AntelopeSalad: I think the answer is you need to go learn how Ruby builds C extensions, sorry
[2014-01-06 21:55:06 -0500] coderanger: YayMeo: Nah, Chef itself is the same either way
[2014-01-06 21:55:14 -0500] YayMeo: Cool
[2014-01-06 21:55:29 -0500] shlant: borntyping: makes sense, thanks
[2014-01-06 21:55:31 -0500] AntelopeSalad: but you just mentioned appending some copy/paste will fix it?
[2014-01-06 21:55:56 -0500] coderanger: AntelopeSalad: Maybe, this isn't a simple issue
[2014-01-06 21:56:21 -0500] coderanger: AntelopeSalad: And as this isn't the problem you want to be solving, I would recommend moving on
[2014-01-06 21:56:42 -0500] borntyping: shlant: I use chef-solo for my own dev machines, and that's a good example of a case where individual repos isn't so useful
[2014-01-06 21:56:43 -0500] AntelopeSalad: moving on means to use rbenv
[2014-01-06 21:56:47 -0500] jidar: I'm having some trouble understanding my problem: I've got two test cases, one where I take the powershell_script, fill in the two scripts I want to run and execute them. When doing this, the process fails on bootstrap after the initial install almost without fail as long as I put the larger file first (in order), if I do the same process using the `execute` param, and cookbook_file each powershell script previously done via the...
[2014-01-06 21:56:53 -0500] jidar: ...`powershell_script` command it works without fail. The error I get is often obsfuscated, Out of Memory, or Failed to Load, or some other generic issue
[2014-01-06 21:57:54 -0500] jidar: this would lead me to believe the way powershell_script is being executed is different than the 'cookbook_file' -> 'execute foo.ps1' method I've employed as a solution
[2014-01-06 21:58:10 -0500] shlant: borntyping: yea I don't currently use chef-solo and not sure I will. Do you see any problems with using a production chef server for testing?
[2014-01-06 21:58:31 -0500] shlant: or should a dev server be created
[2014-01-06 21:58:50 -0500] shlant: assuming env are set up and cookbooks frozen
[2014-01-06 22:00:44 -0500] borntyping: shlant: We use a single chef server where I work, and I think that's the usual way of doing it - though I've found a second chef server useful when making very major changes
[2014-01-06 22:01:55 -0500] shlant: borntyping: that's what I'm used to as well, but I definitely seen the benefits of a separate one. Right now I just use a personal account for dev server as I think the sysadmin would have a heart attack if he new I used the prod server
[2014-01-06 22:02:23 -0500] shlant: but I will most likely move to using prod when I have envs set up
[2014-01-06 22:02:29 -0500] dgarstang1: evironments.... roles or chef environments? :)
[2014-01-06 22:03:17 -0500] shlant: dgarstang1: me?
[2014-01-06 22:03:22 -0500] michaelpjohnson: borntyping: How do you control access? What if you have a team writing a cookbook for their project and you don't want them to have access to another team's cookbook?
[2014-01-06 22:03:33 -0500] dgarstang1: shlant: anyone. :)
[2014-01-06 22:04:13 -0500] shlant: dgarstang1: I don't understand the question
[2014-01-06 22:04:35 -0500] shlant: michaelpjohnson: that's where having separate cookbook repos would come in handy
[2014-01-06 22:04:38 -0500] dgarstang1: shlant: opinions on the best way to handle environments with chef. Ie prod/stage. By using chef environments or chef roles
[2014-01-06 22:04:58 -0500] shlant: dgarstang1: chef environements
[2014-01-06 22:05:09 -0500] shlant: roles are more for types of servers
[2014-01-06 22:05:17 -0500] shlant: ie. web/edge/cache
[2014-01-06 22:05:49 -0500] dgarstang1: shlant: ok, cuz some have said roles are better
[2014-01-06 22:06:37 -0500] borntyping: michaelpjohnson: I can't answer that - In our setup the operations team deal with chef entirely, dev teams don't manage cookbooks
[2014-01-06 22:07:17 -0500] borntyping: But that's definitly a situation where multiple cookbook repos would be a sensible setup (+ github/bitbucket/similar)
[2014-01-06 22:07:19 -0500] michaelpjohnson: borntyping: That makes sense to me (as an SA). We have some developers who want to write their own, but it's not clear to me how to secure that
[2014-01-06 22:07:39 -0500] shlant: dgarstang1: I'm not sure who would be saying that. I think they talk about proper use in this video: http://foodfightshow.org/2013/01/roles2.html
[2014-01-06 22:07:41 -0500] shlant: might be part 1
[2014-01-06 22:08:20 -0500] borntyping: michaelpjohnson: You can mix internal and external cookbooks, so you could consider having repos for the developers cookbooks
[2014-01-06 22:09:02 -0500] borntyping: michaelpjohnson: or you could use a code review model, when devs can push to branches but not merge into master (i.e. leaving control with the SAs)
[2014-01-06 22:09:53 -0500] borntyping: I feel like I should be attaching a disclaimer to a lot of what I'm saying, I've not actually be doing this kinda thing all that long :P
[2014-01-06 22:10:10 -0500] michaelpjohnson: borntyping: I think the code review/pull request method is the best. It still involves Ops, but devs can write their own recipes.
[2014-01-06 22:10:24 -0500] michaelpjohnson: I've been an SA for a while, but new to chef/git
[2014-01-06 22:10:32 -0500] shlant: borntyping: nobody really knows the best answer, sometimes there's more than one
[2014-01-06 22:10:45 -0500] michaelpjohnson: I agree completely shlant
[2014-01-06 22:10:47 -0500] JayF: someone said once that devops means the devs get root. I said it means chef gets root and everyone commits to git ;)
[2014-01-06 22:10:58 -0500] borntyping: shlant: very true :)
[2014-01-06 22:11:12 -0500] borntyping: JayF: devops means very different things to different people
[2014-01-06 22:11:15 -0500] shlant: borntyping: I am fairly new to this too (~1 year) but I like to think I can have an opinion on some things
[2014-01-06 22:11:23 -0500] JayF: IMO you shouldn't even do "devs commit and PR -> SAs review", most like, everyone commits and does pull requests to the chef repo, and everyone gets to review and have input
[2014-01-06 22:11:57 -0500] shlant: borntyping: this is my job so I have to know SOMETHING, right? haah
[2014-01-06 22:12:00 -0500] dgarstang1: every time I read the chef attribute precedence doc my head wants to explode
[2014-01-06 22:12:27 -0500] michaelpjohnson: JayF: Agreed, I hate being the gatekeeper, but in a large prod environment like a need for some controls
[2014-01-06 22:12:29 -0500] borntyping: shlant: yeah - hopefully, most of us wouldn't be in these jobs if we didn't know what we were doing :p
[2014-01-06 22:12:46 -0500] shlant: dgarstang1: It's pretty garbled. Check out the 2 parts of the video I linked, I think they talk about what they think is easiest
[2014-01-06 22:13:03 -0500] borntyping: dgarstang1: took me the better part of a few months and Chef 11 before I had much idea how it works, and I still have bits I'm confused on
[2014-01-06 22:13:07 -0500] shlant: borntyping: either way, fake it till you make it
[2014-01-06 22:13:28 -0500] jidar: anybody know offhand how to decode the knife base64 data you're posting to the chef server?
[2014-01-06 22:13:44 -0500] michaelpjohnson: shlant: That seems to the be the "devops" mantra these days.
[2014-01-06 22:13:46 -0500] jidar: I'm trying to determine if my bug with setting node roles is the knife client or the server's response
[2014-01-06 22:14:00 -0500] dgarstang1: well now I gotta look at the doc again and try and work out how envs will fit in with our use of roles, and yes, it's all spelled out in the doc, but hell if it ain't confusing
[2014-01-06 22:14:07 -0500] shlant: dgarstang1: The general Idea is use attributes in as few different places as possible (i.e. roles/attribute files/recipes) and only use override when absolutely necessary
[2014-01-06 22:14:48 -0500] shlant: the more places they are set, the harder it is to understand precedence
[2014-01-06 22:14:51 -0500] borntyping: Attributes get a lot more simple if you ignore everything except default, normal and automatic
[2014-01-06 22:15:34 -0500] dgarstang1: shlant: most of ours are in a few location/cluster roles right now
[2014-01-06 22:15:56 -0500] shlant: that's how a lot of things are with chef: it can be really complicated if you try and use everything that's available
[2014-01-06 22:16:09 -0500] shlant: use as little as possible until necessary
[2014-01-06 22:16:17 -0500] dgarstang1: shlant: you mean roles and envs? sorry that's what we need tho
[2014-01-06 22:17:12 -0500] shlant: dgarstang1: you can set attributes in roles and envs, but make sure you know what take precedence and it works how you want
[2014-01-06 22:17:32 -0500] shlant: i'm not saying don't put them there
[2014-01-06 22:17:38 -0500] shlant: but the less locations, the less complicated
[2014-01-06 22:18:39 -0500] shlant: michaelpjohnson: well nobody really know wtf "devops" is anyways so you just have to utilize what you know, and learn what you don't
[2014-01-06 22:19:03 -0500] michaelpjohnson: shlant: truer words...
[2014-01-06 22:19:31 -0500] dgarstang1: with default attributes, roles takes precedence. With override attributes, environments take precedence. Some cookbooks use default and some use overrides. We can't control that if we use upstream cookbooks. So, this would mean that where the data goes (role/env) may be different in every cookbook
[2014-01-06 22:20:01 -0500] shlant: michaelpjohnson: I kind of like devop engineer as a job title just for the fact that it's easier to search, but people would catch on fire if I made that known
[2014-01-06 22:20:05 -0500] coderanger: devops: everyone is a software engineer, get over it
[2014-01-06 22:20:17 -0500] borntyping: I generally take devops to mean communication between the two groups, everyone just has different implementations :P
[2014-01-06 22:20:24 -0500] dgarstang1: coderanger: yes, but not everyone is an operations engineer.
[2014-01-06 22:20:39 -0500] coderanger: borntyping: If you have two different groups, you are doing it wrong
[2014-01-06 22:20:58 -0500] coderanger: dgarstang1: No, everyone is
[2014-01-06 22:21:08 -0500] mattupstate: as an app developer you should have some knowledge as to how your app should be deployed and scaled
[2014-01-06 22:21:15 -0500] coderanger: If you work on a thing, you are responsible for its operation, QED
[2014-01-06 22:21:41 -0500] dgarstang1: coderanger: different mentalities I'm afraid.
[2014-01-06 22:21:50 -0500] borntyping: coderanger: I didn't say I was doing it at all
[2014-01-06 22:22:07 -0500] shlant: coderanger: you are describing a perfect work of which most are not ahah
[2014-01-06 22:22:11 -0500] shlant: world*
[2014-01-06 22:22:14 -0500] dgarstang1: yah
[2014-01-06 22:22:24 -0500] shlant: but we can all dream and strive for better
[2014-01-06 22:22:39 -0500] coderanger: shlant: Meh, if your company won't fix their culture, Balanced is hiring ;-)
[2014-01-06 22:22:43 -0500] dgarstang1: developer comes over and says to ops. I got this new thing I wanna put on the prod boxes. Ok, how do you install it? how do you start it? how do you monitor it? Developer, err I dunno.
[2014-01-06 22:22:43 -0500] borntyping: As said, everyone has different definitions and implementations of "devops", that's just the most general definition I've been able to work out
[2014-01-06 22:22:55 -0500] coderanger: dgarstang1: That dev should be fired
[2014-01-06 22:23:04 -0500] dgarstang1: coderanger: That's 90% of devs.
[2014-01-06 22:23:10 -0500] mattupstate: coderanger: maybe one day i'll join you
[2014-01-06 22:23:29 -0500] coderanger: dgarstang1: Turns out we've built an industry on really bad software, so pretty much yeah
[2014-01-06 22:23:33 -0500] shlant: coderanger: I'm mostly here to get some more experience and the requirements for a T1 Visa then I'll be looking to San Fran or New York haha
[2014-01-06 22:23:37 -0500] borntyping: dgarstang1: just as much as 90% of Ops are "I wanna do $thing" -> "No."
[2014-01-06 22:23:57 -0500] dgarstang1: coderanger: wasn't saying it shoudln't be the way you described, just saying that's reality atm.
[2014-01-06 22:23:58 -0500] mattupstate: mahmoud was asking me about helping test some new stuff you guys were working on, but i never heard back
[2014-01-06 22:24:00 -0500] stormerider: borntyping: i sometimes resemble that remark. :)
[2014-01-06 22:24:05 -0500] michaelpjohnson: coderanger: ever tried to tell a developer that they're going to start getting pages at 2am when their code fails? The Ops portion of devops gets tested then..
[2014-01-06 22:24:26 -0500] stormerider: michaelpjohnson: *evil grin*
[2014-01-06 22:24:29 -0500] dgarstang1: borntyping: yeah cuz dev didn't think that running ./start.sh would be fine
[2014-01-06 22:24:51 -0500] coderanger: michaelpjohnson: Yes, I've told many devs that
[2014-01-06 22:25:01 -0500] coderanger: michaelpjohnson: They then stop writing such failure-prone software
[2014-01-06 22:25:08 -0500] robawt: coderanger++
[2014-01-06 22:25:11 -0500] stormerider: whats more fun that telling them that'll happen is actually _doing_ that
[2014-01-06 22:25:20 -0500] stormerider: s/that/than/
[2014-01-06 22:25:23 -0500] robawt: developers are not above cellphone alerts if they knowlingly submit poor code
[2014-01-06 22:25:25 -0500] coderanger: I'm the closest thing Balanced has to a dedicated ops guy, and I'm actually not on the primary on call rotation at all
[2014-01-06 22:25:27 -0500] dgarstang1: different mentality. a dev would turn their phone off
[2014-01-06 22:25:28 -0500] juliancdunn: the fact that our industry has gotten to a point where responsibility for "cause" and "effect" is spread across two groups is the main blocker to forward progress
[2014-01-06 22:25:41 -0500] stormerider: dgarstang1: not where i work.
[2014-01-06 22:25:54 -0500] coderanger: juliancdunn: backpressure on bad software ftw
[2014-01-06 22:25:56 -0500] michaelpjohnson: coderanger: I think I'll just start doing it and see how quickly their code gets fixed
[2014-01-06 22:25:57 -0500] dgarstang1: stormerider: I was being a little dramatic. :-\
[2014-01-06 22:26:14 -0500] dgarstang1: how do you make devs think in an ops way tho...
[2014-01-06 22:26:23 -0500] michaelpjohnson: dgarstang1: it's not that dramatic. It happens all the time
[2014-01-06 22:26:24 -0500] stormerider: squeaky wheels get code fixed.
[2014-01-06 22:26:33 -0500] c_t: I've always thought of "devops" as "the stuff I've been doing for years, but with a new word for it"
[2014-01-06 22:26:39 -0500] michaelpjohnson: squeaky wheel gets kill -9
[2014-01-06 22:26:40 -0500] dgarstang1: c_t: ditto
[2014-01-06 22:26:45 -0500] robawt: c_t++
[2014-01-06 22:27:42 -0500] coderanger: There isn't "a dev way" and an "ops way", you are an engineer making software for a user, you answer only to that
[2014-01-06 22:27:45 -0500] juliancdunn: dgarstang1: find some way of making devs accountable for their code blowing up in prouction
[2014-01-06 22:28:42 -0500] dgarstang1: juliancdunn: even before that. they think that because they run start.sh on their dev machine, that's the end of the story
[2014-01-06 22:29:47 -0500] juliancdunn: yes, and devs need to be re-educated, because there's a total misalignment of incentives there
[2014-01-06 22:29:52 -0500] dgarstang1: :)
[2014-01-06 22:30:16 -0500] dgarstang1: and they also need to learn some ops stuff.
[2014-01-06 22:30:22 -0500] michaelpjohnson: coderanger: That's exactly how I define devops too, it's just changing an already dev OR  ops entrenched culture that makes this difficult
[2014-01-06 22:30:25 -0500] AntelopeSalad: dgarstang1: you ask them to deploy their app to a barebones instance
[2014-01-06 22:30:29 -0500] juliancdunn: otherwise, there are lots of Ops jobs for people who are sick of being abused by devs that just want to throw things over the wall
[2014-01-06 22:30:48 -0500] dgarstang1: AntelopeSalad: que?
[2014-01-06 22:30:52 -0500] coderanger: michaelpjohnson: If you are in SF, I can bring my own flamethrower to your next department meeting.
[2014-01-06 22:31:09 -0500] AntelopeSalad: you asked how do you get devs think in an ops-ish way
[2014-01-06 22:31:13 -0500] AntelopeSalad: *to think
[2014-01-06 22:31:53 -0500] AntelopeSalad: if you ask them to deploy their app and they manually setup a server they will quickly look for a way to automate it after they do it once or twice
[2014-01-06 22:32:14 -0500] dgarstang1: AntelopeSalad: not sure that's the right direction. eg: their app logs stuff, fills up root disk. if they thought like an ops person they'd think about where to put that
[2014-01-06 22:32:14 -0500] michaelpjohnson: coderanger: Haha, in NYC. But thanks.
[2014-01-06 22:32:37 -0500] DandyPandy: On my last production product, we had an ops and a dev person on call at all times. And the dev manager was on pretty much every outage conference call.
[2014-01-06 22:33:01 -0500] AntelopeSalad: dgarstang1: i'm one of those dev people learning about operations now, you only learn things when you fail
[2014-01-06 22:33:05 -0500] AntelopeSalad: and then you learn from your mistakes
[2014-01-06 22:34:23 -0500] borntyping: Getting devs to think like ops or ops to think like devs isn't going to work - you want the whole team to be thinking about building and deploying stuff in the context of the whole platform
[2014-01-06 22:34:46 -0500] DandyPandy: ^^^ +1
[2014-01-06 22:35:22 -0500] AntelopeSalad: it's very easy to be shielded by the complexity of managing servers as a typical developer
[2014-01-06 22:36:00 -0500] AntelopeSalad: drop $5-7/month on some shared hosting and you're good to go for a lot of applications
[2014-01-06 22:36:33 -0500] flaccid: CD
[2014-01-06 22:37:17 -0500] dgarstang1: borntyping: people don't go to school though wanting to do that. They want to be a developer.
[2014-01-06 22:37:40 -0500] mattupstate: it starts even earlier!
[2014-01-06 22:38:23 -0500] borntyping: dgarstang1: so?
[2014-01-06 22:38:54 -0500] borntyping: (company scale) culture and organisation can be changed and improved
[2014-01-06 22:38:56 -0500] dgarstang1: borntyping: so, "you want the whole team to be thinking about building and deploying stuff" is tricky
[2014-01-06 22:39:25 -0500] borntyping: dgarstang1: very, but imo if you want to go the 'devops' route, its the way you have to go
[2014-01-06 22:39:40 -0500] borntyping: I'm not actually advocating for devops though
[2014-01-06 22:39:43 -0500] coderanger: Making things is hard, either get better at it or get out of my way.
[2014-01-06 22:40:11 -0500] dgarstang1: so... no one is using roles to implement environments then? :)
[2014-01-06 22:40:18 -0500] coderanger: http://weknowmemes.com/wp-content/uploads/2012/05/choo-choo-motherfucker.jpg
[2014-01-06 22:40:26 -0500] mattupstate: i dont like roles much anymore
[2014-01-06 22:40:53 -0500] mattupstate: i still use them, but they only really have one or things in the run list, never attributes
[2014-01-06 22:41:21 -0500] dgarstang1: hm
[2014-01-06 22:42:02 -0500] mattupstate: they're useful for node responsibility and search
[2014-01-06 22:42:16 -0500] borntyping: mattupstate: isn't that the whole point of them?
[2014-01-06 22:42:35 -0500] dgarstang1: it seems like implementing envs with roles would be a whole lot less confusing that trying to interpret the attribute predence, especially when some upstream cookbooks use default, some override and so on (where the precence then switches for reasons I don't understand)
[2014-01-06 22:42:57 -0500] mattupstate: i started out using roles for attributes, but then switched to attribute overrides in wrapper/application cookbooks
[2014-01-06 22:43:12 -0500] borntyping: dgarstang1: yeah, but in both cases roles and environments override cookbooks, don't they?
[2014-01-06 22:43:46 -0500] mattupstate: the only real trouble i ran into was with the nginx cookbook
[2014-01-06 22:43:52 -0500] mattupstate: but thats just me
[2014-01-06 22:44:24 -0500] dgarstang1: borntyping: depends. a default attribute in a role overrides a default attribute in a environment. However, with overrides it's reversed
[2014-01-06 22:45:04 -0500] borntyping: dgarstang1: yeah, but things will get confusing anyway if your roles and envs override each other
[2014-01-06 22:45:23 -0500] dgarstang1: borntyping: if your using upstream cookbooks, you can't control that
[2014-01-06 22:45:48 -0500] borntyping: dgarstang1: er, why not?
[2014-01-06 22:46:09 -0500] dgarstang1: borntyping: because sometimes the upstream cookbooks use default, sometimes override
[2014-01-06 22:46:23 -0500] borntyping: yeah, but neither of them use roles/envs
[2014-01-06 22:46:27 -0500] dgarstang1: heck, I've seen normal too
[2014-01-06 22:46:56 -0500] mattupstate: wrap that cookbook!
[2014-01-06 22:47:02 -0500] dgarstang1: borntyping: but we may need to override some of those base on role/env
[2014-01-06 22:47:28 -0500] dgarstang1: mattupstate: we are. i tried overriding upstream atteibutes. it was a nightmare
[2014-01-06 22:47:45 -0500] dgarstang1: the whole attributes thing after 4 months still makes very little sense to me
[2014-01-06 22:48:38 -0500] jleveque: Hello , I would like to know if it is safe to run chef-server-ctl rabbitmq restart on a production chef server ?
[2014-01-06 22:49:34 -0500] AntelopeSalad: btw coderanger: the original author of the pg gem isn't convinced it's a pg issue but he's open for suggestions on how to fix it from pg's side
[2014-01-06 22:49:37 -0500] AntelopeSalad: he just replied to the ticket
[2014-01-06 22:49:51 -0500] mattupstate: dgarstang1: nightmare seems dramaticno offense
[2014-01-06 22:50:11 -0500] dgarstang1: mattupstate: ok, it didnt work and reasons as to why still unknown
[2014-01-06 22:50:15 -0500] mattupstate: have you looked into controlling the attribute load order with `include_attribute`?
[2014-01-06 22:52:03 -0500] mattupstate: thats how i control things in a wrapper cookbook
[2014-01-06 22:53:48 -0500] geggam: if you dont write the cookbooks how do you know what is going on inside them ?
[2014-01-06 22:54:05 -0500] geggam: always is a nagging thought that drives me to write my own
[2014-01-06 22:54:20 -0500] silk: For hosted chef, does knife use api.opscode.com or does it use a different endpoint?
[2014-01-06 22:54:23 -0500] borntyping: geggam: err, you review them before using them, right?
[2014-01-06 22:54:55 -0500] geggam: that and some of you cookbook writers think all i want to run is recipes
[2014-01-06 22:55:14 -0500] geggam: review is one thing... its pretty easy to sneak crap in if you want to
[2014-01-06 22:55:31 -0500] borntyping: Then you aren't reviewing it well enough
[2014-01-06 22:55:33 -0500] mattupstate: huh?
[2014-01-06 22:55:45 -0500] geggam: simpler to write them... that way you know
[2014-01-06 22:55:58 -0500] mattupstate: maybe for you ;)
[2014-01-06 22:56:04 -0500] borntyping: https://en.wikipedia.org/wiki/Not_invented_here
[2014-01-06 22:56:17 -0500] stormerider: borntyping: indeed
[2014-01-06 22:56:58 -0500] geggam: ever hear of security ? ... that isnt invented here either
[2014-01-06 22:57:43 -0500] borntyping: errr...
[2014-01-06 22:57:56 -0500] mattupstate: here we go...
[2014-01-06 22:58:12 -0500] mattupstate: i'd just use shell scripts in that case
[2014-01-06 23:01:01 -0500] coderanger: silk: It uses api.opscode.com/organizations/<name>
[2014-01-06 23:01:24 -0500] geggam: sup coderanger
[2014-01-06 23:01:34 -0500] coderanger: Yo
[2014-01-06 23:02:12 -0500] silk: coderanger, ok so why does it feel like I am getting cached results when querying the api directly
[2014-01-06 23:02:22 -0500] coderanger: silk: Which API call?
[2014-01-06 23:02:26 -0500] paulczar: test-kitchen  what's the difference between kitchen test and kitchen verify ?
[2014-01-06 23:02:55 -0500] silk: environment
[2014-01-06 23:03:05 -0500] coderanger: paulczar: kitchen test == kitchen create + converge + verify
[2014-01-06 23:03:17 -0500] coderanger: (and possibly destroy)
[2014-01-06 23:03:40 -0500] coderanger: paulczar: _but_ the state machine knows to create before converge, and converge before verify
[2014-01-06 23:03:49 -0500] silk: well, environments/$env
[2014-01-06 23:04:00 -0500] coderanger: paulczar: but running verify twice doesn't re-create, whereas test would
[2014-01-06 23:04:03 -0500] paulczar: sweet!   so I should use `kitchen test --destroy=always` for fun and profit in CI ?
[2014-01-06 23:04:06 -0500] coderanger: silk: No caching there
[2014-01-06 23:04:30 -0500] coderanger: paulczar: yep https://github.com/poise/poise/blob/master/.travis.yml#L12
[2014-01-06 23:05:34 -0500] silk: I believe you, but it just seems to be otherwise. ill go hunting, thanks
[2014-01-06 23:05:50 -0500] paulczar: pooh thanks for the travis sample   you just made me remember another question!
[2014-01-06 23:06:37 -0500] paulczar: using deployment/binstubs in your bundler installs stuff to ./vendor   then when you run rubocop  it tests all your newly vendored gems
[2014-01-06 23:06:45 -0500] paulczar: same with other tests
[2014-01-06 23:07:32 -0500] paulczar: travis seems to run --deployment by default if not specified  do you know of a way to disable --deployment ?   or at least deploy to /tmp/vendor or similar ?
[2014-01-06 23:07:46 -0500] coderanger: paulczar: mhmm, for rubocop just pass it paths
[2014-01-06 23:07:55 -0500] coderanger: paulczar: rubocop libraries recipes, for example
[2014-01-06 23:08:18 -0500] paulczar: yeah, that's just an example  I've had some other stuff   maybe it was knife cookbook test that didn't seem to have a way to exclude paths
[2014-01-06 23:08:23 -0500] YayMeo: Does Chef on windows only work with 32-bit ruby?
[2014-01-06 23:08:48 -0500] coderanger: paulczar: You can just not use deployment mode if you need
[2014-01-06 23:08:53 -0500] coderanger: just manually bundle exec all the things
[2014-01-06 23:09:01 -0500] coderanger: YayMeo: Chef ships its own Ruby
[2014-01-06 23:09:28 -0500] YayMeo: coderanger: ? I couldn't find a download link, just a signup link so I grabbed from github instead
[2014-01-06 23:09:48 -0500] YayMeo: bundle install appeared to work fine
[2014-01-06 23:09:59 -0500] paulczar: coderanger: yeah,  without bundler_args: set  travis seems to default to using --deployment  haven't worked out how to stop that
[2014-01-06 23:10:02 -0500] coderanger: YayMeo: http://www.getchef.com/chef/install/
[2014-01-06 23:10:10 -0500] YayMeo: but not it's not altogether clear to me how to run it, the scripts throw errors
[2014-01-06 23:10:19 -0500] coderanger: paulczar: Just specify the bundler_args
[2014-01-06 23:10:33 -0500] coderanger: YayMeo: Select your platform in there, it will give you the MSI link
[2014-01-06 23:11:11 -0500] YayMeo: coderanger: Cool grabbing that, there really should have been a link there heh
[2014-01-06 23:11:31 -0500] paulczar: coderanger: oh yeah, derp,  if I specify some args in there it'll probably not run the default
[2014-01-06 23:11:54 -0500] coderanger: paulczar: Yeah, just set it to '' if you must
[2014-01-06 23:11:55 -0500] YayMeo: coderanger: So how do I get this local build to work all the same out of curiosity? It executed the bundle install without errors
[2014-01-06 23:12:24 -0500] YayMeo: Does it require a specific version of ruby? I have the most recent, and x64. Does it only support x86?
[2014-01-06 23:12:31 -0500] coderanger: YayMeo: You would need a couple of windows-support gems, and then run bin/knife or bin/chef-client
[2014-01-06 23:12:47 -0500] coderanger: YayMeo: And Chef ships with 193, but should work on 200, no idea on 210
[2014-01-06 23:12:59 -0500] YayMeo: which windows-support gems? I can just gem install them, no? I have a proper MinGW/Msys install on this machine
[2014-01-06 23:13:19 -0500] coderanger: YayMeo: No idea, I've never built it by hand on windows
[2014-01-06 23:13:33 -0500] coderanger: you can dig through the omnibus and MSI build configs though
[2014-01-06 23:13:34 -0500] YayMeo: Any clue where to look? My google-fu failed.
[2014-01-06 23:13:47 -0500] coderanger: YayMeo: github.com/opscode/omnibus-chef
[2014-01-06 23:14:12 -0500] geggam: if windows punt()
[2014-01-06 23:14:25 -0500] YayMeo: geggam: Helpful! Much appreciated!
[2014-01-06 23:14:37 -0500] YayMeo: coderanger: I already cloned that, that's what I bundle installed locally
[2014-01-06 23:14:43 -0500] coderanger: Opscode has Very Smart People that know things about windows, I am happy to simply use the fruits of their labors
[2014-01-06 23:14:51 -0500] geggam: *grin* ... cant stand that platform YayMeo ...
[2014-01-06 23:14:55 -0500] coderanger: YayMeo: Oh, thats not chef, thats just a build system for chef
[2014-01-06 23:15:05 -0500] coderanger: YayMeo: Chef itself is opscode/chef
[2014-01-06 23:15:17 -0500] YayMeo: coderanger: That's what you linked me to...
[2014-01-06 23:15:18 -0500] coderanger: YayMeo: Omnibus is a framework for building packages
[2014-01-06 23:15:32 -0500] coderanger: Yes, thats where you would look to see how it installs things
[2014-01-06 23:15:43 -0500] coderanger: Thats (part of) the thing that builds the MSIs
[2014-01-06 23:15:59 -0500] coderanger: https://github.com/opscode/omnibus-chef/blob/master/config/projects/chef-windows.rb
[2014-01-06 23:16:00 -0500] YayMeo: coderanger: Oh, for some reason it redirected me back to chef at first... I'll look at this omnibus thing then, thanks
[2014-01-06 23:16:12 -0500] waziers: hi guys, i'm on private entreprise chef with the new reporting interface - i can't find how to create a new user?
[2014-01-06 23:16:36 -0500] coderanger: waziers: Click on the Admin tab, then the Users section in the sidebar
[2014-01-06 23:16:46 -0500] coderanger: should be Create link in its sidebar section
[2014-01-06 23:16:58 -0500] coderanger: (assuming it hasn't changed too much)
[2014-01-06 23:17:09 -0500] waziers: i don;t have an admin tab anymore
[2014-01-06 23:17:19 -0500] waziers: though i am in the admins group
[2014-01-06 23:17:41 -0500] waziers: and i can invite users to my organization, but only using an existing username, not creating a new one
[2014-01-06 23:17:57 -0500] coderanger: waziers: Yes, thats correct
[2014-01-06 23:18:10 -0500] coderanger: I don't think you can create users directly, they have to sign up, not sure if that changed for on-prem
[2014-01-06 23:18:32 -0500] jleveque: Hello, I have the erchef process which is taking too much CPU on my chef server and everything fails or run slow, but  is still lots of  RAM available : do you have a link to a guide on erchef troubleshooting and optimisation for open source chef? I searched docs.opscode.con with no sucess
[2014-01-06 23:18:35 -0500] coderanger: Might have been added after I last saw the code
[2014-01-06 23:18:47 -0500] coderanger: jleveque: Almost always it is depsolver
[2014-01-06 23:19:22 -0500] sfalcon: jleveque: that sounds like you are hitting a known bug in the dep solving code :( We have a patch for it in the nightly builds but nothing released yet.
[2014-01-06 23:19:35 -0500] coderanger: sfalcon: :-(
[2014-01-06 23:19:39 -0500] waziers: on the homepage of my privately hosted page, there no signup anymore, they can only create a new chef organization with new credentials
[2014-01-06 23:19:58 -0500] coderanger: waziers: Did you disable signups in the chef-server.rb config file?
[2014-01-06 23:20:14 -0500] waziers: i'll check on that, thanks
[2014-01-06 23:20:24 -0500] coderanger: waziers: I think this might be beyond my knowledge of webui2 though, your best bet is to email support@getchef.com
[2014-01-06 23:22:09 -0500] jleveque: coderanger, sfalcon : thanks for the tip , do you have a link or a workaround for that, or a way for me to verify that the depsolver is the source of the problem ?
[2014-01-06 23:23:38 -0500] sfalcon: jleveque: here's the ticket tracking the issue https://tickets.opscode.com/browse/CHEF-3921
[2014-01-06 23:24:07 -0500] jleveque: sfalcon, thanks a lot
[2014-01-06 23:24:45 -0500] jleveque:  coderanger, sfalcon : can I safely do a chef-server-ctl erchef restart ? ( the server is production)
[2014-01-06 23:24:50 -0500] coderanger: jleveque: knife exec -E 'puts api.post("/environments/production/cookbook_versions", "run_list" => ["nginx@2.0.4"])'
[2014-01-06 23:25:00 -0500] sfalcon: jleveque: np. I hope a release with the proper fix will be available soon.
[2014-01-06 23:25:08 -0500] coderanger: jleveque: Fill in your own env name and run list, and see if it takes forever to return
[2014-01-06 23:25:17 -0500] jleveque: thx
[2014-01-06 23:25:28 -0500] sfalcon: jleveque: I think: chef-server-ctl restart erchef, but that should be OK.
[2014-01-06 23:34:56 -0500] AntelopeSalad: if you successfully provision a server and your next chef client run comes across a bad package location or some other issue, is the entire server going to get into a weird state or will chef just say "ok, it's already working, it's ok to ignore this bad package location because we already have it"?
[2014-01-06 23:35:19 -0500] flaccid: AntelopeSalad: whats a package location?
[2014-01-06 23:35:23 -0500] AntelopeSalad: my situation is, i really want to use chef to deploy my rails apps instead of capistrano but
[2014-01-06 23:35:40 -0500] AntelopeSalad: i'm afraid that if something weird happens during the chef-client run then my server might go down
[2014-01-06 23:35:53 -0500] AntelopeSalad: and the weirdness would be things i can't control like an apt resource not being there anymore, etc.
[2014-01-06 23:36:01 -0500] flaccid: the server will stay up, but the application may not be available depending where it fails
[2014-01-06 23:36:03 -0500] bluepojo: AntelopeSalad: chef won't change anything on your machine unless you change the cookbook
[2014-01-06 23:36:24 -0500] AntelopeSalad: bluepojo: right, but i would be changing the cookbook on every app deployment i think
[2014-01-06 23:36:29 -0500] AntelopeSalad: by bumping the version at least right?
[2014-01-06 23:36:40 -0500] flaccid: the availability of remote servers is out of the control of chef, alas it won't need to install packages if they are already installed
[2014-01-06 23:36:50 -0500] AntelopeSalad: right flaccid, my thought process is
[2014-01-06 23:37:01 -0500] AntelopeSalad: if i use chef to provision the server once, then i only have to make sure all is good once
[2014-01-06 23:37:11 -0500] AntelopeSalad: but if i push a new build 5 time a day then i'm running chef-client 5 times a day
[2014-01-06 23:37:21 -0500] bluepojo: if it's just your software changing, you shouldn't have a problem
[2014-01-06 23:37:41 -0500] bluepojo: your cookbook need not change to push a new version of your app
[2014-01-06 23:37:51 -0500] bluepojo: just bump app.version in the environment and rerun chef-client
[2014-01-06 23:37:57 -0500] AntelopeSalad: it's like 180 chances to fail per year vs 1 chance to fail
[2014-01-06 23:37:59 -0500] bluepojo: presuming you use an attribute for your version
[2014-01-06 23:38:06 -0500] flaccid: if you change your app in vcs, there is no coookbook code change unless you badly hardcoded what to checkout
[2014-01-06 23:38:27 -0500] AntelopeSalad: i have not figured out how to deploy apps yet with chef, all i did was glance at the deploy resource
[2014-01-06 23:38:46 -0500] AntelopeSalad: there are not too many tutorials on that subject unfortunately
[2014-01-06 23:38:50 -0500] flaccid: well this is how you do it https://github.com/flaccid/cookbooks/blob/master/cookbooks/rails_app/recipes/application.rb#L29
[2014-01-06 23:38:53 -0500] AntelopeSalad: so it will be a very big investment to learn
[2014-01-06 23:38:57 -0500] AntelopeSalad: probably weeks
[2014-01-06 23:39:10 -0500] flaccid: i already did it for you ;p
[2014-01-06 23:39:26 -0500] AntelopeSalad: flaccid: so you've migrated from cap deploys to chef for your rails apps?
[2014-01-06 23:39:32 -0500] flaccid: upstream cookbooks are maintained by coderanger heh
[2014-01-06 23:39:38 -0500] AntelopeSalad: if so you're the best, because that's what i'm in the process of doing now
[2014-01-06 23:39:43 -0500] flaccid: AntelopeSalad: i don't run any rails apps
[2014-01-06 23:39:55 -0500] flaccid: the deploy resource is analog to capistrano
[2014-01-06 23:40:08 -0500] flaccid: the application cookbooks implement/use that resource
[2014-01-06 23:40:28 -0500] flaccid: this cookbook does work though
[2014-01-06 23:40:29 -0500] AntelopeSalad: i'm not sure what i'm looking at in the link you provided
[2014-01-06 23:40:46 -0500] flaccid: AntelopeSalad: study the application and application_ruby cookbooks
[2014-01-06 23:40:49 -0500] flaccid: they have readmes
[2014-01-06 23:40:50 -0500] AntelopeSalad: what is the rails block?
[2014-01-06 23:40:58 -0500] AntelopeSalad: ok
[2014-01-06 23:41:11 -0500] flaccid: its explained in that
[2014-01-06 23:41:14 -0500] flaccid: its a sub-resource
[2014-01-06 23:41:28 -0500] AntelopeSalad: it shouldn't change much if i'm using puma/nginx right?
[2014-01-06 23:41:49 -0500] flaccid: yes it will
[2014-01-06 23:42:26 -0500] AntelopeSalad: i wonder if i go down this route, then i wouldn't even need to use foreman anymore?
[2014-01-06 23:42:43 -0500] AntelopeSalad: right now i use foreman to export upstart scripts for a sidekiq worker and puma
[2014-01-06 23:42:45 -0500] flaccid: application_ruby can do unicorn or apache2/passenger so if you want something else you need to implement
[2014-01-06 23:42:55 -0500] AntelopeSalad: yeah i don't use apache or passenger
[2014-01-06 23:43:02 -0500] AntelopeSalad: or unicorn :<
[2014-01-06 23:43:21 -0500] flaccid: the right thing to do would be to do the dev and submit it back via pull request
[2014-01-06 23:43:25 -0500] AntelopeSalad: but everything works flawlessly with capistrano and my config is only like 30 lines long
[2014-01-06 23:43:35 -0500] AntelopeSalad: i wouldn't even know where to being to convert it all to chef
[2014-01-06 23:43:44 -0500] flaccid: however your cookbook could simply deploy the application with the application resource and then you code the rest
[2014-01-06 23:43:53 -0500] flaccid: ^^
[2014-01-06 23:44:07 -0500] AntelopeSalad: so i should ignore the artifact_deploy resource provided by riot?
[2014-01-06 23:44:29 -0500] flaccid: i'm not familiar with that sorry
[2014-01-06 23:44:45 -0500] coderanger: AntelopeSalad: Unless you have a nexus server somewhere, I don't see that helping you a lot
[2014-01-06 23:45:00 -0500] AntelopeSalad: i don't
[2014-01-06 23:45:44 -0500] AntelopeSalad: right now i just git push to the server directly and then run cap
[2014-01-06 23:46:37 -0500] AntelopeSalad: i've also never used runit before, this application_ruby cookbook seems really daunting
[2014-01-06 23:50:14 -0500] AntelopeSalad: the rails resource looks good though
[2014-01-06 23:52:08 -0500] coderanger: AntelopeSalad: You can't use the rails subresource independently, it is just a part of the app cookbook framework
[2014-01-06 23:52:43 -0500] AntelopeSalad: unfortunately the rails resource is the only thing that's common to my rails app
[2014-01-06 23:53:36 -0500] coderanger: Then write appcb plugins for the rest
[2014-01-06 23:53:44 -0500] coderanger: They are just LWRPs
[2014-01-06 23:53:46 -0500] AntelopeSalad: what is an appcb?
[2014-01-06 23:53:54 -0500] coderanger: application_* coobook
[2014-01-06 23:54:19 -0500] AntelopeSalad: so i need to write an application_ruby_puma_nginx_redis plugin?
[2014-01-06 23:54:20 -0500] coderanger: Or just don't use it
[2014-01-06 23:54:31 -0500] coderanger: No, just puma
[2014-01-06 23:54:43 -0500] coderanger: and maybe redis if you want to deploy it via the appcb framework (I wouldn't)
[2014-01-06 23:54:52 -0500] coderanger: The default one uses unicorn
[2014-01-06 23:55:01 -0500] coderanger: so you just need to make something similar but that uses puma
[2014-01-06 23:55:06 -0500] AntelopeSalad: a background worker lib i use requires redis
[2014-01-06 23:55:13 -0500] AntelopeSalad: so it's heavily tied into my app
[2014-01-06 23:55:15 -0500] coderanger: Sure, just use the normal redis cookbook
[2014-01-06 23:55:25 -0500] AntelopeSalad: and changes to my app require restarting the redis process (sometimes)
[2014-01-06 23:55:47 -0500] coderanger: That seems broken, what changes in your app require bouncing redis
[2014-01-06 23:56:07 -0500] DanS1978: does anyone know how I can use the results from a search query in a bash resource?
[2014-01-06 23:56:20 -0500] coderanger: DanS1978: String interpolation?
[2014-01-06 23:56:30 -0500] AntelopeSalad: i remember getting errors once with a background email task when the class name changed that called the task
[2014-01-06 23:56:38 -0500] AntelopeSalad: and restarting redis was the only way to fix it
[2014-01-06 23:56:56 -0500] coderanger: AntelopeSalad: Do you mean restarting redis just to clear the database?
[2014-01-06 23:57:15 -0500] DanS1978: what I want to do is run a search(:node, "tags:appserver"), and use the resulting hostnames in a bash loop.
[2014-01-06 23:57:21 -0500] AntelopeSalad: i'm not sure, all i know is when i started sidekiq (the background worker using redis) with puma
[2014-01-06 23:57:29 -0500] coderanger: If so, then either your worker system needs to drop unknown data, or your app should drop the DB as part of your migrations
[2014-01-06 23:57:34 -0500] AntelopeSalad: it spit out a bunch of errors, and then i killed the worker and restarted it
[2014-01-06 23:57:37 -0500] AntelopeSalad: and all was fine again
[2014-01-06 23:57:57 -0500] AntelopeSalad: all of that stuff is abstracted away from me with capistrano
[2014-01-06 23:58:25 -0500] coderanger: DanS1978: bash "asdf" do command "foo #{search(:node, 'tags:appserver').map{|n| n['fqdn']}.join(' ')}"; end
[2014-01-06 23:58:37 -0500] coderanger: AntelopeSalad: You need to learn about the software you are using
[2014-01-06 23:58:50 -0500] coderanger: AntelopeSalad: Chef is not a tool to hide complexity
[2014-01-06 23:58:52 -0500] AntelopeSalad: to get it all working with cap required me to include sidekiq/capistrano
[2014-01-06 23:58:58 -0500] AntelopeSalad: and i was good to go in literally 5 seconds
[2014-01-06 23:59:14 -0500] coderanger: AntelopeSalad: Personal question: why are you not using heroku?
[2014-01-06 23:59:22 -0500] coderanger: You seem to be very early on in learning about all this
[2014-01-06 23:59:25 -0500] AntelopeSalad: because the costs are absolutely insane
[2014-01-06 23:59:31 -0500] coderanger: and their system is probably better suited to learning slowly
[2014-01-06 23:59:37 -0500] DanS1978: thank you so much!
[2014-01-06 23:59:47 -0500] AntelopeSalad: it would have cost like $300/month to use heroku
[2014-01-06 23:59:55 -0500] coderanger: AntelopeSalad: To run a single dyno is free ...
[2014-01-06 23:59:57 -0500] AntelopeSalad: but it costs $0 using amazon's free tier and then $5/month when i move to DO
