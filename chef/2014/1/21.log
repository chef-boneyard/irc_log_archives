[2014-01-21 00:08:40 -0500] sethvargo: Ohai Chef, I just released Chef Zero v2.0.2 with some important bug fixes: https://github.com/opscode/chef-zero/releases/tag/v2.0.2
[2014-01-21 00:34:25 -0500] cgeer: Evening all.I'm running into an issue setting up a server using chef where I'm updating the resolv.conf file but the current chef-client run doesn't seem to want to use those changes. Is there a way to force a reload of DNS setting during a chef-client run?
[2014-01-21 00:44:08 -0500] ninjitsu: anybody have experience configuring a custom distro for clients that have no internet access? i.e. a local clone of the "chef-full" distro?
[2014-01-21 02:50:38 -0500] isr37: ping
[2014-01-21 02:51:17 -0500] savant: pong
[2014-01-21 02:51:22 -0500] krz: poing
[2014-01-21 02:51:25 -0500] savant: sorry about the latency
[2014-01-21 03:13:13 -0500] freerobby: Can anybody help me? I just changed our instance type to an m1.medium, and now I can't access my chef server on port 80 or 443
[2014-01-21 03:13:21 -0500] freerobby: chef-server-ctl indicates everything is running fine
[2014-01-21 03:13:24 -0500] freerobby: but connections fail
[2014-01-21 03:13:34 -0500] freerobby: security groups, etc. did not change
[2014-01-21 03:14:46 -0500] isr37: just had a quick question about remote_directory
[2014-01-21 03:15:08 -0500] isr37: i want to clone a bunch of binaries to multiple systems, using basic https auth
[2014-01-21 03:18:16 -0500] bettyclamp: My Berksfile stipulates that an upstream cookbook should be gotten directly from git, but when I run berks install, the cookbook is gotten from community.opscode.com instead. Any idea what I'm doing wrong?
[2014-01-21 03:18:26 -0500] bettyclamp: (git -> github)
[2014-01-21 03:18:38 -0500] bettyclamp: (gotten -> fetched)
[2014-01-21 03:18:45 -0500] gchristensen: bettyclamp: did you specify the git repo to source from?
[2014-01-21 03:18:50 -0500] bettyclamp: yes
[2014-01-21 03:19:02 -0500] gchristensen: try removing your berksfile.lock if possible
[2014-01-21 03:19:48 -0500] bettyclamp: gchristensen: I tried that already, but I'll try it again now...
[2014-01-21 03:19:56 -0500] gchristensen: and then do a berks update
[2014-01-21 03:21:18 -0500] bettyclamp: not a berks install?
[2014-01-21 03:21:22 -0500] bettyclamp: first?
[2014-01-21 03:27:14 -0500] bettyclamp: Well, we found the solution and I'm not happy about it. Turns out the 'site :opscode' at the top of a Berksfile is not merely a default, but *overrides* any per-cookbook github: path. Is this not counterintuitive?
[2014-01-21 03:42:31 -0500] freerobby: Does anybody here have experience upgrading a chef server aws instance type?
[2014-01-21 03:42:39 -0500] freerobby: I'm trying to figure out what might have broken.
[2014-01-21 04:01:50 -0500] yuppers: does anyone know how can I specify the provisioner version in test-kitchen? https://github.com/opscode/chef-zero/issues/48#issuecomment-32631612 would lead me to believe that there's an option for doing so, but I'm not sure..
[2014-01-21 04:09:11 -0500] isr37: is there something like remote_file to clone directories?
[2014-01-21 04:13:33 -0500] flaccid: isr37: clone directories?
[2014-01-21 04:14:00 -0500] isr37: flaccid: yeah copy a directory tree from a remote web server
[2014-01-21 04:14:24 -0500] flaccid: isr37: well there isn't technically a protocol for that unless you use webdav
[2014-01-21 04:16:25 -0500] isr37: so remote_directory is a stupid name
[2014-01-21 04:16:42 -0500] isr37: it does nothing like what it says
[2014-01-21 04:16:51 -0500] isr37: remote_file maybe slightly more useful
[2014-01-21 04:17:52 -0500] flaccid: well http://docs.opscode.com/resource_remote_directory.html
[2014-01-21 04:18:14 -0500] flaccid: The remote_directory resource is used to recursively transfer a directory from a cookbooks files or default directory.
[2014-01-21 04:18:31 -0500] flaccid: not a web server
[2014-01-21 04:18:46 -0500] flaccid: why you would want to do this though probably isn't right
[2014-01-21 04:19:47 -0500] isr37: don't worry about it, there are damn good reasons to do it
[2014-01-21 04:20:07 -0500] flaccid: like what isr37?
[2014-01-21 04:21:08 -0500] isr37: i have a bunch of files on a webserver that i need to distribute, occasionally there is an added file but just once every few months
[2014-01-21 04:21:24 -0500] isr37: so ever node needs to have those files
[2014-01-21 04:21:33 -0500] flaccid: what files are they?
[2014-01-21 04:21:40 -0500] isr37: wtf do you care
[2014-01-21 04:21:44 -0500] isr37: its a simple question
[2014-01-21 04:22:02 -0500] isr37: the tree is big so idont want to stuff it into a cookbook
[2014-01-21 04:22:10 -0500] flaccid: i care because we have things like vcs
[2014-01-21 04:22:10 -0500] isr37: but its minimally incrementing
[2014-01-21 04:22:49 -0500] isr37: a VCS is not meant to store binaries, thats just moronic
[2014-01-21 04:22:50 -0500] flaccid: the use case/why is important
[2014-01-21 04:23:00 -0500] flaccid: exactly, this is wtf i care and asked
[2014-01-21 04:23:27 -0500] flaccid: what kind of binaries are they?
[2014-01-21 04:23:38 -0500] isr37: big ones
[2014-01-21 04:23:51 -0500] flaccid: packages, programs ?
[2014-01-21 04:24:17 -0500] isr37: not packages
[2014-01-21 04:24:36 -0500] isr37: i don't want to make a package on every release but the tar ball is always there and i can just explode that
[2014-01-21 04:24:44 -0500] isr37: remote_file will work
[2014-01-21 04:24:45 -0500] flaccid: ok, so they are tarballs
[2014-01-21 04:25:11 -0500] isr37: but it would be easier if i could just clone a tree
[2014-01-21 04:25:27 -0500] flaccid: you probably don't won't to do a arbitrary recursive, but if you want to basically mirror it, i'd use rsync or some other protocol thats not http
[2014-01-21 04:25:49 -0500] flaccid: there are programs that can traverse a index file though
[2014-01-21 04:26:30 -0500] krz: when i do <%= @database.to_yaml %>
[2014-01-21 04:26:37 -0500] krz: i get:
[2014-01-21 04:26:52 -0500] krz: staging: !map:Chef::Node::ImmutableMash
[2014-01-21 04:26:59 -0500] krz: whats up with that?
[2014-01-21 04:55:49 -0500] krz: when installing OS packages. is it enough to use Chef resources (http://docs.opscode.com/resource.html) instead of something like the yum-qa cookbook (https://github.com/cookbooks/yum)
[2014-01-21 04:56:28 -0500] flaccid: krz: the package resource works well right?
[2014-01-21 04:58:39 -0500] krz: flaccid: i havent tried, currently using the yum-qa cookbook
[2014-01-21 04:59:44 -0500] flaccid: krz: that cookbook has different functions to installing packages
[2014-01-21 05:00:32 -0500] krz: flaccid: right, all i need is to install OS packages. so both do the same thing?
[2014-01-21 05:00:57 -0500] flaccid: krz: the cookbook does this https://github.com/cookbooks/yum#description
[2014-01-21 05:01:03 -0500] flaccid: the package resource is used to install packages
[2014-01-21 05:01:20 -0500] krz: so is the yum-qa cookbook
[2014-01-21 05:01:43 -0500] flaccid: i don't know what this yum-qa is
[2014-01-21 05:02:09 -0500] flaccid: i wrote this recipe though to install an arbitrary array of packages by node attribute though, https://github.com/xhost-cookbooks/system/blob/master/recipes/install_packages.rb
[2014-01-21 05:03:11 -0500] krz: yea was thinking of writing a custom cookbook just like that
[2014-01-21 05:03:45 -0500] flaccid: krz: now you don't have to :)
[2014-01-21 05:05:20 -0500] krz: thanks flaccid
[2014-01-21 05:05:53 -0500] isr37: and that works as designed
[2014-01-21 05:06:46 -0500] krz: flaccid: btw, how does your custom chef json look like?
[2014-01-21 05:07:08 -0500] flaccid: krz: sorry i'm not sure what you mean
[2014-01-21 05:07:19 -0500] yuppers: grr
[2014-01-21 05:07:30 -0500] yuppers: why isn't there an option to specify that I want to use a specific version of chef-zero
[2014-01-21 05:07:41 -0500] yuppers: inside of test-kitchen
[2014-01-21 05:08:41 -0500] krz: flaccid: k ill have mine like "packages": ["nodejs", "libcurl", "libcurl-devel", "libxml2", "postgresql-devel"]
[2014-01-21 05:10:01 -0500] flaccid: krz: its system/packages/install or system/packages/install_compile_time
[2014-01-21 05:11:28 -0500] krz: flaccid: the values for node['system']['packages']['install'] is an array right?
[2014-01-21 05:12:05 -0500] flaccid: krz: yep https://github.com/xhost-cookbooks/system/blob/master/attributes/default.rb#L25
[2014-01-21 05:14:13 -0500] krz: cool
[2014-01-21 05:14:56 -0500] krz: flaccid: btw, how are you upgrading your packages?
[2014-01-21 05:15:35 -0500] flaccid: krz: https://github.com/xhost-cookbooks/system/blob/master/recipes/upgrade_packages.rb
[2014-01-21 05:15:39 -0500] flaccid: (KISS)
[2014-01-21 05:51:01 -0500] brucelee: Codemonkey:  you there? :p
[2014-01-21 06:31:28 -0500] brucelee: vagrant berkshelf plugin doesnt seem to work. I edit ~/chef-repo/Vagrantfile and added config.berkshelf.enabled = true, and then vagrant up brings up the VM, but i dont think my cookbook executed. Heres the output of my vagrant file, berksfile, what happens when i run vagrant up, and my ~/chef-repo/cookbooks/recipe/default.rb: http://www.hastebin.com/dokuyanabu.cmake
[2014-01-21 06:31:33 -0500] brucelee: anyone have any ideas?
[2014-01-21 06:40:40 -0500] freezey: brucelee: trying to test the cookbook?
[2014-01-21 07:02:39 -0500] gokul: How do I use 'include_recipe' with 'not_if'
[2014-01-21 07:12:10 -0500] flaccid: gokul: i don't think thats supported yet, i use unless (ruby)
[2014-01-21 07:12:26 -0500] flaccid: well, basically use control flow in ruby, if or unless
[2014-01-21 07:13:31 -0500] flaccid: rofl http://stackoverflow.com/questions/15961496/is-it-possible-to-chef-include-recipe-and-indicate-only-if-not-if-condition
[2014-01-21 07:14:59 -0500] gokul: flaccid, that won't serve my purpose. I want to check if '/usr/bin/command' exists in the system before running include_recipe.
[2014-01-21 07:15:52 -0500] flaccid: gokul: sp basically the compile time evaluation won't work because /usr/bin/command is provided by a resource in execute phase?
[2014-01-21 07:16:24 -0500] flaccid: sp=so
[2014-01-21 07:18:34 -0500] gokul: Didn't get you.
[2014-01-21 07:19:19 -0500] flaccid: gokul: well why is a if not suitable? i'd liket to know more about what you are trying to accomplish though, its probably not the right technique
[2014-01-21 07:20:46 -0500] gokul: Ok. I want to install mysql::server with the community cookbook. But I want replace the root user of mysql with something else. But If I replace the root user of mysql the recipe will break next time.
[2014-01-21 07:21:14 -0500] brucelee: freeformz: yeah
[2014-01-21 07:21:19 -0500] gokul: So I want to make sure /usr/sbin/mysqld is not present before including the recipe.
[2014-01-21 07:21:22 -0500] brucelee: oops
[2014-01-21 07:22:04 -0500] brucelee: vagrant berkshelf plugin doesnt seem to work. I edit ~/chef-repo/Vagrantfile and added config.berkshelf.enabled = true, and then vagrant up brings up the VM, but i dont think my cookbook executed. Heres the output of my vagrant file, berksfile, what happens when i run vagrant up, and my ~/chef-repo/cookbooks/recipe/default.rb: http://www.hastebin.com/dokuyanabu.cmake , anyone have any ideas whats going wrong?
[2014-01-21 07:22:51 -0500] flaccid: gokul: you are changing the root user in mysql.user table for obscurity?
[2014-01-21 07:23:23 -0500] gokul: Yes.
[2014-01-21 07:24:00 -0500] gokul: And it's not supported by mysql cookbook. And I don't want to write a custom one.
[2014-01-21 07:24:31 -0500] flaccid: gokul: the right thing to do is to fork the cookbook, create a topic branch, develop the feature and then issue pull request :)
[2014-01-21 07:25:30 -0500] gokul: :),  For now I am using a ruby block with system('/usr/sbin/mysqld --version')
[2014-01-21 07:26:48 -0500] flaccid: gokul: well i don't see why you can't do the if
[2014-01-21 07:27:31 -0500] gokul: if 'some string'; end #is always true.
[2014-01-21 07:29:01 -0500] gokul: I guess when using 'not_if' it will actually execute the string.
[2014-01-21 07:29:36 -0500] flaccid: gokul: http://mywiki.wooledge.org/BashFAQ/081
[2014-01-21 07:30:37 -0500] flaccid: include_recipe "mysql::server" unless `type -P /usr/bin/mysqld >/dev/null`
[2014-01-21 07:31:07 -0500] flaccid: the fact is its still just a hack because you won't be able to update state
[2014-01-21 07:31:32 -0500] gokul: Yeah, that's true.
[2014-01-21 07:32:04 -0500] flaccid: is there a reason to change root user? that isn't in pci or something is it?
[2014-01-21 07:32:20 -0500] gokul: Company Policy :)
[2014-01-21 07:32:30 -0500] flaccid: i see
[2014-01-21 07:32:46 -0500] flaccid: the good ol security through obscurity
[2014-01-21 07:33:06 -0500] gokul: :)
[2014-01-21 07:33:08 -0500] flaccid: when all that is needed is to lock down the hosts in the user table
[2014-01-21 07:34:13 -0500] gokul: Another layer, I guess.
[2014-01-21 07:34:19 -0500] flaccid: gokul: show your company requirement 2 and just tell them to comply to that http://www.percona.com/files/presentations/UC2010-Achieving-PCI-Compliance-with-MySQL.pdf
[2014-01-21 07:35:14 -0500] flaccid: the funny thing here is that you don't rename root user of system. if someone gets root, they can do what they want still
[2014-01-21 07:35:44 -0500] gokul: That is very true.
[2014-01-21 07:43:18 -0500] flaccid: foodcritic is interesting in terms of the offences heh
[2014-01-21 07:43:55 -0500] flaccid: well so is rubocop. i will trust what they say even though i don't always agree!
[2014-01-21 07:50:47 -0500] gokul: Haven't tried both.
[2014-01-21 08:01:43 -0500] ribo: Talk cannot cook rice. - Charlie Chan
[2014-01-21 08:02:03 -0500] ribo: It is fool in hurry who drink tea with fork. - Charlie Chan
[2014-01-21 08:04:28 -0500] flaccid: Don't paste quotes here. - flaccid
[2014-01-21 08:05:14 -0500] ribo: Anything possible. - Charlie Chan
[2014-01-21 08:05:21 -0500] flaccid: wt
[2014-01-21 08:16:02 -0500] henk76: guys, i've got a chef community server and a client. if i execute a knife upload cookbook, will it upload the complete cookbook to the chef server?
[2014-01-21 08:17:02 -0500] zxd: morning
[2014-01-21 08:18:02 -0500] henk76: mornin
[2014-01-21 08:20:53 -0500] flaccid: henk76: i hope so
[2014-01-21 08:23:55 -0500] henk76: yeah flaccid, but i've been using a cookbook now which holds some files with it. is there any way i can find them on the chef server? it's because of diskspace
[2014-01-21 08:25:29 -0500] flaccid: henk76:  you put blobs in your coookbooks?
[2014-01-21 08:26:57 -0500] henk76: well, we have some files we want to distribute. so i used the remote_directory for it.
[2014-01-21 08:27:43 -0500] flaccid: i can't recall where they get stored on the disk, maybe in /var/chef or something, google might help. like i was saying before, i wouldn't 'distribute' files like this
[2014-01-21 08:28:09 -0500] flaccid: you can always use gnu find
[2014-01-21 08:30:19 -0500] henk76: yeah. i did search for the cookbook's name. but couldn't find it. i'll search with grep then.  I do know it's not the preferred method, but I'm not that expert to figure out other ways.
[2014-01-21 08:30:38 -0500] flaccid: use find
[2014-01-21 08:30:48 -0500] flaccid: if you are lazy, do find / | grep foo
[2014-01-21 08:33:20 -0500] henk76: thanks flaccid
[2014-01-21 08:37:10 -0500] flaccid: henk76: np
[2014-01-21 08:46:32 -0500] flaccid: i keep on seeing 'C: Use the new Ruby 1.9 hash syntax.' https://travis-ci.org/xhost-cookbooks/system/jobs/17327213 i just don't know what that is, can i get an example?
[2014-01-21 08:49:34 -0500] ocholetras: how can i include a recipe only if the package X is installed on the system?
[2014-01-21 08:53:14 -0500] henk76: flaccid, for me its /var/opt/chef-server btw ;)
[2014-01-21 08:54:14 -0500] maniac: ocholetras, include_recipe if { ::File.exists?("/path/to/file") }  something like this
[2014-01-21 08:56:09 -0500] flaccid: ocholetras: curious on the use case there
[2014-01-21 08:56:14 -0500] flaccid: henk76: coolio
[2014-01-21 09:06:07 -0500] flaccid: ocholetras: hey why you do it like that y0?
[2014-01-21 09:24:47 -0500] ocholetras: flaccid: i want to apply apache hats with my apparmor cookbook when apache2 is installed
[2014-01-21 09:25:04 -0500] ocholetras: to prevent insecure apache2 installations by hand
[2014-01-21 09:25:38 -0500] flaccid: ocholetras: ok, you should make that explicity then
[2014-01-21 09:25:39 -0500] ocholetras: iknow we should control our servers but, it's to prevent
[2014-01-21 09:26:00 -0500] ocholetras: flaccid: what you mean with making it explicity?
[2014-01-21 09:26:44 -0500] ocholetras: i was thinking on someching like: include "apparmor::apache_hats" if "dpkg -L apache2"
[2014-01-21 09:26:47 -0500] flaccid: ocholetras: well the question is what cookbook/recipe manages/installs the package
[2014-01-21 09:27:07 -0500] ocholetras: but it includes the recipe even if dpkg -L exits with 1 status
[2014-01-21 09:27:31 -0500] ocholetras: yep, but im talking about the situation when somebody installs apache2 by hand
[2014-01-21 09:27:36 -0500] flaccid: include "apparmor::apache_hats" if `dpkg -L apache2`
[2014-01-21 09:27:55 -0500] flaccid: thats a situation that should be killed
[2014-01-21 09:30:28 -0500] denniswisnia: hey guys, getting the error "ERROR: TypeError: can't convert nil into String" after trying to create a cookbook
[2014-01-21 09:30:41 -0500] denniswisnia: google doesnt help me :(
[2014-01-21 09:30:51 -0500] flaccid: denniswisnia: how are you creating the cookbook?
[2014-01-21 09:30:58 -0500] denniswisnia: with knife
[2014-01-21 09:31:04 -0500] denniswisnia: command "knife cookbook create"
[2014-01-21 09:31:29 -0500] flaccid: use knife cookbook create foobar
[2014-01-21 09:31:39 -0500] denniswisnia: yea, i did
[2014-01-21 09:32:20 -0500] flaccid: denniswisnia: so what is the actual command you are using?
[2014-01-21 09:32:33 -0500] denniswisnia: dennis-t3n@kathy ~ $ knife cookbook create psad
[2014-01-21 09:32:33 -0500] denniswisnia: ERROR: TypeError: can't convert nil into String
[2014-01-21 09:33:37 -0500] flaccid: denniswisnia: strange. what does knife -v say?
[2014-01-21 09:33:44 -0500] denniswisnia: Chef: 11.8.2
[2014-01-21 09:34:05 -0500] ocholetras: flaccid: you are absolutely right
[2014-01-21 09:34:09 -0500] flaccid: denniswisnia: maybe you have an error in your knife configuration file
[2014-01-21 09:34:11 -0500] ocholetras: thanks a lot
[2014-01-21 09:34:17 -0500] flaccid: ocholetras: np
[2014-01-21 09:35:16 -0500] denniswisnia: flaccid: thats my knife.rb: http://pastebin.com/UzDtVmjW
[2014-01-21 09:36:04 -0500] flaccid: denniswisnia: you could try renaming that file and see if it works
[2014-01-21 09:36:17 -0500] denniswisnia: which file? ;)
[2014-01-21 09:36:32 -0500] flaccid: the knife.rb
[2014-01-21 09:36:47 -0500] flaccid: you don't need all those directives to create a cookbook
[2014-01-21 09:36:52 -0500] flaccid: it would at least rule in or out the problem
[2014-01-21 09:37:21 -0500] denniswisnia: tried it, no difference
[2014-01-21 09:37:49 -0500] flaccid: there can be user and system knife files being used
[2014-01-21 09:37:49 -0500] denniswisnia: goddamnit, i cry :(
[2014-01-21 09:38:05 -0500] flaccid: denniswisnia: you can run it with irb
[2014-01-21 09:38:53 -0500] flaccid: so like cat `which knife` | head -n 1
[2014-01-21 09:39:20 -0500] flaccid: depends on install, but run the knife command under irb and not ruby
[2014-01-21 09:39:56 -0500] flaccid: at least then you can get a trace
[2014-01-21 09:40:45 -0500] denniswisnia: i think, it was since the gem update on mac os x
[2014-01-21 09:41:04 -0500] flaccid: sounds right, its typical gem hell
[2014-01-21 09:41:26 -0500] flaccid: your best bet is to upgrade to mavericks and then re-install chef
[2014-01-21 09:41:43 -0500] denniswisnia: already on mavericks
[2014-01-21 09:42:29 -0500] flaccid: re-install chef, but i mean you could have dep gems that are wrong too
[2014-01-21 09:42:41 -0500] denniswisnia: :(
[2014-01-21 09:42:42 -0500] denniswisnia: okay
[2014-01-21 09:42:48 -0500] denniswisnia: I do it.
[2014-01-21 09:43:17 -0500] flaccid: i don't think it exists but there needs to be a ominbus chef installer for os x
[2014-01-21 09:43:18 -0500] denniswisnia: but as a workaround: did knife anything else at cookbook create  other than create some folders and files?
[2014-01-21 09:43:21 -0500] flaccid: or a mac port
[2014-01-21 09:43:46 -0500] flaccid: well it just creates a skel
[2014-01-21 09:43:59 -0500] jonlives: flaccid: for the server or client?
[2014-01-21 09:44:04 -0500] jonlives: there's a mac os x client installer at http://www.getchef.com/chef/install/
[2014-01-21 09:44:12 -0500] tealc210: Hi
[2014-01-21 09:44:40 -0500] flaccid: jonlives: only up to 10.7
[2014-01-21 09:44:49 -0500] denniswisnia: jonlives: did it overwrites any configs?
[2014-01-21 09:45:25 -0500] tealc210: I would like to now how to get the setup tmpdir variable in hooks?
[2014-01-21 09:46:09 -0500] tealc210: *the value of tmpdir
[2014-01-21 09:52:53 -0500] jonlives: flaccid: ah you're right
[2014-01-21 09:53:01 -0500] jonlives: yeah we really need a mavericks installer.
[2014-01-21 09:53:14 -0500] jonlives: that said, I've never had too many issues with the chef gem
[2014-01-21 09:56:33 -0500] flaccid: jonlives: the good thing about mavericks is that you get ruby 2
[2014-01-21 09:57:00 -0500] jonlives: yeah, finally an uprade from 1.8
[2014-01-21 09:57:06 -0500] flaccid: i can't remember how i installed it on my mbp but it was probably by gem
[2014-01-21 10:11:03 -0500] maniac: guys how can i install more than one cookbook with the same name but with different tags with berkshelf ? for exmaple i need something like this :
[2014-01-21 10:11:05 -0500] maniac: cookbook "httpd", git: "ssh://git@<host>:<port>/httpd.git", tag: "v0.2.0"
[2014-01-21 10:11:05 -0500] maniac: cookbook "httpd", git: "ssh://git@<host>:<port>/httpd.git", tag: "v0.3.0
[2014-01-21 10:11:51 -0500] maniac: erkshelf complains on multiple sources and suggests to use groups
[2014-01-21 10:12:03 -0500] maniac: but when i use group only 1 cookbook get installed with berkshelf
[2014-01-21 10:12:41 -0500] gregkare: What are you trying to do with multiple versions of the same cookbook?
[2014-01-21 10:13:58 -0500] brucelee: yo
[2014-01-21 10:14:00 -0500] brucelee: anyone still here?
[2014-01-21 10:14:04 -0500] brucelee: vagrant berkshelf plugin doesnt seem to work. I edit ~/chef-repo/Vagrantfile and added config.berkshelf.enabled = true, and then vagrant up brings up the VM, but i dont think my cookbook executed. Heres the output of my vagrant file, berksfile, what happens when i run vagrant up, and my ~/chef-repo/cookbooks/recipe/default.rb: http://www.hastebin.com/dokuyanabu.cmake , anyone have any ideas whats going wrong?
[2014-01-21 10:14:10 -0500] brucelee: :P
[2014-01-21 10:14:17 -0500] brucelee: still trying to get some help with this
[2014-01-21 10:15:30 -0500] maniac: gregkare: for example i have projects .. 1 uses this cookbook version and the other 2nd cookbook version ..  and after berksfile update i want to run tests and upload them with CI server into my chef-server
[2014-01-21 10:20:40 -0500] GreatSUN: hi all
[2014-01-21 10:21:13 -0500] GreatSUN: is one of our ops from opscode already active? ;-)
[2014-01-21 10:21:38 -0500] GreatSUN: I'd like to discuss some idea for opscode with ya ;-)
[2014-01-21 10:25:55 -0500] flaccid: maniac: that wouldn't be teh right way to handle it. would be better done with git tags
[2014-01-21 10:26:11 -0500] flaccid: GreatSUN: opscode is now chef
[2014-01-21 10:27:22 -0500] GreatSUN: flaccid: ok :-) nice
[2014-01-21 10:27:44 -0500] maniac: flaccid, but how i can handle in with git tags if not using them in the Berksfile?
[2014-01-21 10:27:46 -0500] GreatSUN: but that doesn't matter for the idea :D
[2014-01-21 10:27:59 -0500] flaccid: GreatSUN: what idea
[2014-01-21 10:28:26 -0500] flaccid: maniac: you can use any berksfile you would like, just don't use more than 1 source of a cookbook
[2014-01-21 10:32:32 -0500] tealc210: And for me, is there somebody to answer my question? :-)
[2014-01-21 10:32:50 -0500] maniac: flaccid: i have separate repo for each of the cookbook with git tags applied .. i have separate chef-repo with environments,roles,data_bags and Berksfile .. i just want to upload automatically using CI and bershelf when chef-repo's berksfile changes  but i guess i'm not doing it correct whats the best practice for it ?
[2014-01-21 10:33:18 -0500] flaccid: maniac: i don't know sorry, i don't even use berks
[2014-01-21 10:34:56 -0500] Cope: maniac: it would really help if you could be more specific
[2014-01-21 10:35:08 -0500] Cope: what isn't working? why do you guess you're not doing it right?
[2014-01-21 10:35:34 -0500] Cope: apologies if you said earlier and i missed it..
[2014-01-21 10:38:37 -0500] GreatSUN: flaccid: later... meetings
[2014-01-21 10:40:55 -0500] flaccid: GreatSUN: goodnight
[2014-01-21 10:42:43 -0500] maniac: Cope: How i see it  i made changes in my cookbook and made a git push with a new tag .. after that i change tag on this cookbook in berksfile .. and my CI sees that git repo has been update  it executes tests and if successful uploads updated cookbooks with berks command on my chef-server.The problem is what if i had to work with the same cookbook but different versions of them if i cant use them both in the same Berksfile?How this should be done bette
[2014-01-21 10:43:13 -0500] maniac: i'm bringing with this great administrative overhead  that's why i think i'm doing something wrong
[2014-01-21 10:46:41 -0500] maniac: however i can set group for this cookbook and add additional command to my CI berks update only="mygroup"  but is this a correct way actually?
[2014-01-21 11:01:23 -0500] ocholetras: flaccid: the line you put earlier always do the include, whatever you put inside ``
[2014-01-21 11:01:26 -0500] ocholetras: :S
[2014-01-21 11:01:37 -0500] ocholetras: i'm testing with log
[2014-01-21 11:01:55 -0500] ocholetras: log "Failing ..." if  `service inexistent status`
[2014-01-21 11:02:02 -0500] ocholetras: log "Failing ..." if  `service ssh status`
[2014-01-21 11:02:07 -0500] ocholetras: both writes to the log
[2014-01-21 11:05:45 -0500] flaccid: ocholetras: sure, they are returning non zero
[2014-01-21 11:06:22 -0500] ocholetras: flaccid: nop
[2014-01-21 11:06:28 -0500] ocholetras: service ssh status returns 0
[2014-01-21 11:06:47 -0500] ocholetras: # service asd status
[2014-01-21 11:06:47 -0500] ocholetras: asd: unrecognized service
[2014-01-21 11:06:52 -0500] ocholetras: # echo $?
[2014-01-21 11:06:52 -0500] ocholetras: 1
[2014-01-21 11:06:58 -0500] ocholetras: service ssh status
[2014-01-21 11:06:58 -0500] ocholetras: ssh start/running, process 833
[2014-01-21 11:07:02 -0500] ocholetras: echo $?
[2014-01-21 11:07:02 -0500] ocholetras: 0
[2014-01-21 11:07:06 -0500] ocholetras: so, wtf? O_o
[2014-01-21 11:07:21 -0500] flaccid: ocholetras: i think you need to use popen
[2014-01-21 11:07:36 -0500] flaccid: but that also looks like upstart
[2014-01-21 11:07:48 -0500] flaccid: aka ubuntu crap
[2014-01-21 11:10:36 -0500] ocholetras: umm
[2014-01-21 11:13:59 -0500] ocholetras: jeje
[2014-01-21 11:14:11 -0500] ocholetras: so
[2014-01-21 11:14:29 -0500] ocholetras: if i will try to exec some file
[2014-01-21 11:14:33 -0500] ocholetras: or watever bash commadn
[2014-01-21 11:14:38 -0500] ocholetras: the $? output
[2014-01-21 11:14:41 -0500] ocholetras: will be ignored
[2014-01-21 11:14:51 -0500] ocholetras: and cant be used to put inside an if
[2014-01-21 11:14:57 -0500] ocholetras: if `bla bla bla`
[2014-01-21 11:15:01 -0500] ocholetras: always evaluate to true..
[2014-01-21 11:15:17 -0500] ocholetras: despite of ubuntu crap
[2014-01-21 11:15:17 -0500] ocholetras: xDD
[2014-01-21 11:15:40 -0500] workmad3: ocholetras: correct, `` will return the stdout of the process run
[2014-01-21 11:15:48 -0500] workmad3: ocholetras: which will be a string... and therefore in ruby, always truthy
[2014-01-21 11:16:13 -0500] flaccid: which is why if you need to do that hackery with chef, you need to use popen
[2014-01-21 11:16:13 -0500] ocholetras: so i need the $? value
[2014-01-21 11:16:38 -0500] workmad3: ocholetras: you could use system
[2014-01-21 11:16:38 -0500] ocholetras: flaccid: got it! :)
[2014-01-21 11:16:48 -0500] workmad3: which returns true/false depending on the exit status
[2014-01-21 11:16:48 -0500] ocholetras: lets have a look at system and popen
[2014-01-21 11:16:53 -0500] ocholetras: jumm
[2014-01-21 11:17:02 -0500] workmad3: e.g. 'system("true")' will be true, 'system("false")' will be false
[2014-01-21 11:17:02 -0500] ocholetras: now system looks like the good one
[2014-01-21 11:17:03 -0500] ocholetras: jaja
[2014-01-21 11:17:09 -0500] flaccid: whichever gets you there in this situation yeah
[2014-01-21 11:17:19 -0500] workmad3: but you have no way of getting the stdout with system
[2014-01-21 11:17:31 -0500] flaccid: yeah that is the catch
[2014-01-21 11:17:32 -0500] ocholetras: this time i only need exitstatus
[2014-01-21 11:17:37 -0500] ocholetras: so perfect
[2014-01-21 11:17:40 -0500] workmad3: yeah :)
[2014-01-21 11:17:41 -0500] flaccid: right
[2014-01-21 11:17:59 -0500] flaccid: system() instead of `` sure
[2014-01-21 11:18:18 -0500] flaccid: or spend the time doing it properly in the cookbook hehe
[2014-01-21 11:19:38 -0500] ocholetras: properly would be not to check if apache2 is installed
[2014-01-21 11:19:40 -0500] ocholetras: isntead
[2014-01-21 11:19:48 -0500] ocholetras: apply apparmor hats with apache2 recipe
[2014-01-21 11:19:50 -0500] workmad3: ocholetras: you could use the execute resource ;)
[2014-01-21 11:20:07 -0500] flaccid: enhance the upstream cookbook
[2014-01-21 11:20:25 -0500] workmad3: ocholetras: or a 'not_if'
[2014-01-21 11:20:48 -0500] workmad3: ocholetras: which can take a string command and interprets the exit status from that run as a shell command as true/false
[2014-01-21 11:21:08 -0500] workmad3: ocholetras: e.g. 'not_if "false"' and 'not_if {system("false")}' are equivalent
[2014-01-21 11:21:14 -0500] flaccid: except you can't do that with include_recipe
[2014-01-21 11:21:33 -0500] workmad3: no, you'd probably need to add that with a chef rewind, or fork and update the cookbook
[2014-01-21 11:22:39 -0500] ocholetras: the right way
[2014-01-21 11:23:04 -0500] ocholetras: is to use only_if on the resources, because all ubuntu installs will have apparmor cookbook on their runlists
[2014-01-21 11:23:58 -0500] flaccid: well no, you don't assume, you enforce state,
[2014-01-21 11:24:18 -0500] flaccid: there is no harm in including
[2014-01-21 11:25:36 -0500] ocholetras: So you apply apparmor::apache explicit on node runlist?
[2014-01-21 11:26:28 -0500] ocholetras: when i include apparmor::apache, the recipe is doing work, restarting service etc... so service should exists, etc...
[2014-01-21 11:27:08 -0500] flaccid: thats a different situation
[2014-01-21 11:27:15 -0500] ocholetras: so i think only way to enforce that is to put each recipe on the runlist: recipe[apache2], recipe[apparmor], recipe[apparmor::apache]
[2014-01-21 11:27:32 -0500] ocholetras: Im allways applying apparmor default to ubuntu nodes
[2014-01-21 11:27:36 -0500] flaccid: sure that is the high level
[2014-01-21 11:28:01 -0500] ocholetras: i just was trying to include apache recipe from apparmor cookbook, when apache2 was installed.
[2014-01-21 11:28:40 -0500] ocholetras: Someway its an implicit way instead of explicit.. wich is not so good way of doing things on chef right?
[2014-01-21 11:37:02 -0500] workmad3: ocholetras: you can create a wrapper cookbook for your infrastructure
[2014-01-21 11:37:12 -0500] ocholetras: i have one :D
[2014-01-21 11:37:15 -0500] ocholetras: well
[2014-01-21 11:37:16 -0500] workmad3: ocholetras: that depends on the apache2 cookbook and the apparmor cookbook
[2014-01-21 11:37:23 -0500] ocholetras: umm
[2014-01-21 11:37:26 -0500] ocholetras: not that way
[2014-01-21 11:37:28 -0500] ocholetras: he he
[2014-01-21 11:37:38 -0500] ocholetras: i have and apache2 wrapper cookbook
[2014-01-21 11:37:43 -0500] workmad3: ocholetras: and then the recipe in that cookbook does 'include_recipe "apache2"; include_recipe "apparmor"; include_recipe "apparmor::apache"'
[2014-01-21 11:38:07 -0500] ocholetras: The thing here is where to putt apparmor apache2 hats
[2014-01-21 11:38:15 -0500] ocholetras: apache2::apparmor_hats recipe
[2014-01-21 11:38:22 -0500] ocholetras: or apparmor::apache2_hats recipe
[2014-01-21 11:38:22 -0500] workmad3: ocholetras: inside that wrapper recipe
[2014-01-21 11:38:25 -0500] ocholetras: Xd
[2014-01-21 11:38:52 -0500] workmad3: ocholetras: my-apache2-with-apparmor::apache2_hats (or just in the default)
[2014-01-21 11:39:03 -0500] ocholetras: umm
[2014-01-21 11:39:09 -0500] ocholetras: ajajaja
[2014-01-21 11:39:31 -0500] ocholetras: workmad3: it sounds a little bit redundant
[2014-01-21 11:39:41 -0500] ocholetras: if you want to config somethin related with apache2
[2014-01-21 11:39:47 -0500] ocholetras: do it on apache2 cookbook
[2014-01-21 11:39:55 -0500] ocholetras: if you whant to configure apparmor
[2014-01-21 11:40:00 -0500] ocholetras: do it on apparmor cookbook
[2014-01-21 11:40:01 -0500] ocholetras: right?
[2014-01-21 11:40:03 -0500] ocholetras: O_o
[2014-01-21 11:40:39 -0500] flaccid: in an ideal world yes. now its all about wrappin'
[2014-01-21 11:41:10 -0500] ocholetras: yeap
[2014-01-21 11:41:13 -0500] workmad3: ocholetras: you have 3 bits though... you have a cookbook about apache2, you have a cookbook about apparmor, and you need a bit about how to integrate the two
[2014-01-21 11:41:28 -0500] workmad3: ocholetras: the bit on how to integrate the two == your wrapper cookbook for your infrastructure
[2014-01-21 11:41:40 -0500] ocholetras: If i have a shorewall cookbook, and i want to install apache2 on a node
[2014-01-21 11:42:04 -0500] flaccid:  cookbooks don't = runlists
[2014-01-21 11:42:08 -0500] ocholetras: is the apache2 recipe responsible of open port 80 and 443 through node['shorewall'] attributes
[2014-01-21 11:42:09 -0500] ocholetras: right?
[2014-01-21 11:42:38 -0500] workmad3: ocholetras: that would require the apache2 recipe to be conflated with knowledge of every possible firewall setup
[2014-01-21 11:42:44 -0500] flaccid: no it doesnt use
[2014-01-21 11:42:45 -0500] workmad3: ocholetras: which would get messy and unmaintainable
[2014-01-21 11:42:49 -0500] ocholetras: i mean
[2014-01-21 11:42:56 -0500] ocholetras: myorg_apache2 cookbook
[2014-01-21 11:43:07 -0500] ocholetras: wrapper cookbook depends on apache2 ^^
[2014-01-21 11:43:13 -0500] ocholetras: im always talking about wrapped cookbooks
[2014-01-21 11:43:19 -0500] ocholetras: myorg_cookbookname
[2014-01-21 11:43:32 -0500] flaccid: so
[2014-01-21 11:43:41 -0500] workmad3: ocholetras: personally, I have a 'myorg_webserver' cookbook that's responsible for setting up a webserver
[2014-01-21 11:43:53 -0500] workmad3: ocholetras: and then a webserver has just that in the run list
[2014-01-21 11:44:05 -0500] ocholetras: and use apache2 or nginx or lighthttpd?
[2014-01-21 11:44:13 -0500] ocholetras: or you have a recipe for each one of them?
[2014-01-21 11:44:38 -0500] workmad3: ocholetras: I'm currently using nginx, and I've got my own company resource for installing an nginx server
[2014-01-21 11:45:17 -0500] workmad3: ocholetras: if I wanted to change to apache2, I'd sort out a resource or cookbook for that, and pull it into the webserver cookbook (in a new version)
[2014-01-21 11:45:34 -0500] ocholetras: Umm
[2014-01-21 11:45:53 -0500] workmad3: ocholetras: then I can adjust the environment cookbook version pins to test the new version
[2014-01-21 11:45:53 -0500] flaccid: keep in mind that a prefix cookbook for your org doesn't actually solve the generic problem, it only solves it for that 'org'
[2014-01-21 11:46:01 -0500] workmad3: ^^
[2014-01-21 11:47:10 -0500] ocholetras: workmad3: im using attributes on my wrapper cookbooks to change behaviour of community ones.. and rewind a resource that i need to change i.e. template that i overwrited ... etc..
[2014-01-21 11:47:28 -0500] ocholetras: think that is the right way of use "library" cookbooks..
[2014-01-21 11:47:35 -0500] ocholetras: not rewriting recipes..
[2014-01-21 11:47:40 -0500] ocholetras: you are repeating work..
[2014-01-21 11:47:45 -0500] ocholetras: in my opinion..
[2014-01-21 11:47:49 -0500] workmad3: ocholetras: personally, I don't think that library cookbooks should distribute recipes
[2014-01-21 11:47:58 -0500] workmad3: ocholetras: at least not more than an example of using a resource
[2014-01-21 11:47:58 -0500] ocholetras: but i have only 2 months with chef now.. -_-'
[2014-01-21 11:48:17 -0500] flaccid: welcome to chef
[2014-01-21 11:48:29 -0500] ocholetras: there are some generic work that could be definetly implemented on library ones
[2014-01-21 11:48:40 -0500] workmad3: ocholetras: sure, and that should be wrapped into resources
[2014-01-21 11:48:41 -0500] ocholetras: read attributes and build config files..
[2014-01-21 11:48:44 -0500] flaccid: ocholetras: contribute then
[2014-01-21 11:49:13 -0500] ocholetras: flaccid: the thing is that the library cookbooks i'm using, works that way xD
[2014-01-21 11:49:15 -0500] ocholetras: O_o
[2014-01-21 11:49:25 -0500] ocholetras: it does the generic stuff..
[2014-01-21 11:49:35 -0500] flaccid: ocholetras: you can enhance and change it
[2014-01-21 11:49:36 -0500] ocholetras: then you can do the tricky stuff..
[2014-01-21 11:49:45 -0500] ocholetras: flaccid: sure!
[2014-01-21 11:49:52 -0500] flaccid: excellent
[2014-01-21 11:49:55 -0500] ocholetras: flaccid: i'll try :D
[2014-01-21 11:50:19 -0500] workmad3: ocholetras: I agree with that ;) I just don't think that recipes (especially not ones that build on node attributes) are a good way to distribute the generic stuff
[2014-01-21 11:50:19 -0500] ocholetras: flaccid: but we now are talking about ways of implementing things..
[2014-01-21 11:50:48 -0500] ocholetras: workmad3: good point
[2014-01-21 11:51:01 -0500] workmad3: ocholetras: resources that only rely on data passed in as resource attributes make it much easier, IMO, to handle more fiddly stuff
[2014-01-21 11:51:14 -0500] flaccid: ocholetras: thats what chef ends up being
[2014-01-21 11:51:37 -0500] workmad3: ocholetras: and then you can configure the default values
[2014-01-21 11:52:13 -0500] workmad3: ocholetras: and me, as a user of your resource, can come along and tweak it as I desire, without having to compromise and shove things like passwords into node attributes (instead I can pass them directly to the resource from a data bag)
[2014-01-21 11:53:29 -0500] ocholetras: workmad3: aggree with that
[2014-01-21 11:53:31 -0500] ocholetras: but
[2014-01-21 11:54:17 -0500] ocholetras: If you want to build a django server, you  make a djangoserver cookbook, write a recipe with nginx resource with diferent config (that te one on your webserver cookbook), and any other gunicorn or apache stuff..
[2014-01-21 11:54:41 -0500] ocholetras: And then if you want rproxy server you create an rproxy cookbook, write a recipe with other nginx resource with diferent config etc..
[2014-01-21 11:55:15 -0500] ocholetras: dont you think that you are repeating too much stuff?
[2014-01-21 11:55:30 -0500] ocholetras: YOu always install nginx, you only change config and modules
[2014-01-21 11:55:41 -0500] ocholetras: So you define package, and config resource once..
[2014-01-21 11:55:46 -0500] ocholetras: then change attributes to fit your service..
[2014-01-21 11:56:25 -0500] ocholetras: If you need passwords manage it on your wrapper cookbook with data bags and whatever..
[2014-01-21 12:00:51 -0500] workmad3: ocholetras: the stuff that's repeated become the default values for resource attributes
[2014-01-21 12:01:34 -0500] ocholetras: You have to rewrite resource once and once again each cookbook, if you have to modify the resource due to an update or change, you have to modify that N times..
[2014-01-21 12:01:51 -0500] workmad3: ocholetras: seriously, my line in my webserver recipe to install nginx is 'nginx_server node[:fqdn]'
[2014-01-21 12:02:51 -0500] workmad3: ocholetras: if I could have gotten away without needing a resource name, that would have been 'nginx_server'
[2014-01-21 12:05:08 -0500] ocholetras: workmad3: ok, nice look. Sounds good, some library cookbooks have an empty default recipe. so you can include them and start using their resources. Think that is the pattern you are talking about.
[2014-01-21 12:05:21 -0500] workmad3: ocholetras: you don't even need to include the default recipe
[2014-01-21 12:05:29 -0500] workmad3: ocholetras: just depend on them in metadata.rb
[2014-01-21 12:05:32 -0500] ocholetras: depends is enough
[2014-01-21 12:05:38 -0500] ocholetras: it evaluates resources also?
[2014-01-21 12:05:42 -0500] ocholetras: thought only attributes-.
[2014-01-21 12:06:00 -0500] workmad3: it loads any resource definitions and files in libraries too
[2014-01-21 12:06:17 -0500] ocholetras: aha
[2014-01-21 12:06:26 -0500] ocholetras: wow good to know
[2014-01-21 12:06:32 -0500] ocholetras: so in your opinion
[2014-01-21 12:06:42 -0500] ocholetras: library cookbooks should have no recipes inside, right?
[2014-01-21 12:06:47 -0500] workmad3: ideally, yes
[2014-01-21 12:07:07 -0500] workmad3: or, at most, a recipe showing an example of a simple setup
[2014-01-21 12:07:34 -0500] ocholetras: then al logic should go inside the resource. And recipes will be only a series of resource definitions, right?
[2014-01-21 12:07:38 -0500] ocholetras: al = all
[2014-01-21 12:07:42 -0500] workmad3: IMO, yes
[2014-01-21 12:07:50 -0500] workmad3: recipes should be declarative, saying 'I want this, and this and this'
[2014-01-21 12:08:06 -0500] workmad3: and binding those resources to the appropriate data
[2014-01-21 12:08:07 -0500] ocholetras: i think that are the runlists
[2014-01-21 12:08:24 -0500] ocholetras: yeah
[2014-01-21 12:08:41 -0500] ocholetras: sounds no so crazy your point ^^
[2014-01-21 12:10:19 -0500] workmad3: ocholetras: the problem with runlists is that it's difficult to manage the inter-resource dependencies with them... e.g. you have your firewall recipe and your apache recipe... how do you express that the firewall should always open the apache listening port(s)
[2014-01-21 12:11:55 -0500] workmad3: ocholetras: without repeating the ports in both the apache_listen_ports array and the shorewall_allowed_ports array (or whatever the attributes are called)? :)
[2014-01-21 12:11:56 -0500] workmad3: ocholetras: or, in your situation, how do you express that when you have both apache and apparmor installed, that you should then also always apply the apparmor::apache recipe and your own apparmor apache hats?
[2014-01-21 12:24:09 -0500] ocholetras: workmad3: i thing you can check if shorewall is on the node runlist and then the ports you need showrewall to open if you want integration cookbooks need to be aware of their environment, i think..
[2014-01-21 12:24:40 -0500] ocholetras: the other way is to create a myorgwebserver cookbook that i write with the knowledge of the environment im deploying..
[2014-01-21 12:25:55 -0500] ocholetras: i agree with you that generic cookbook should never assume you have shorewall or iptables or whatever.. but you can check if shorewall cookbook will be applied
[2014-01-21 12:28:44 -0500] ocholetras: im remembering a "pattern" that says: "A cookbook should never "depends" on attributes declared on other cookbooks." The meaning of the sentence depends of your understanding of "depends"  haha omg!
[2014-01-21 12:28:45 -0500] ocholetras: XD
[2014-01-21 12:29:34 -0500] ocholetras: workmad3: in your webserver cookbook, how do you open http and https ports on the node local firewall?
[2014-01-21 12:48:26 -0500] workmad3: ocholetras: I set a firewall rule for them
[2014-01-21 12:48:59 -0500] CaptainQuirk: Hi there
[2014-01-21 12:49:01 -0500] ocholetras: workmad3: taking the port from nginx attributes?
[2014-01-21 12:49:19 -0500] CaptainQuirk: I would like to write something in my xinitrc file
[2014-01-21 12:49:41 -0500] CaptainQuirk: actually, I would like to add a line so that the fluxbox desktop be started
[2014-01-21 12:49:57 -0500] CaptainQuirk: is it better to make a file resource call in the fluxbox recipe
[2014-01-21 12:50:03 -0500] workmad3: ocholetras: in my first iteration, I just hardcoded it to 80 and 443, seeing as those are the values I set as default for the nginx resource
[2014-01-21 12:50:09 -0500] CaptainQuirk: or create a dummy one for X just to do this operation ?
[2014-01-21 12:50:25 -0500] flaccid: CaptainQuirk: template resource
[2014-01-21 12:50:55 -0500] workmad3: ocholetras: if I needed to vary that, I'd assign a variable in the recipe 'nginx_ports = [80, 443]' and use that variable for both firewall rules and for the nginx resource
[2014-01-21 12:50:57 -0500] CaptainQuirk: flaccid, why template over file ?
[2014-01-21 12:51:49 -0500] flaccid: CaptainQuirk: because templates are dynamic
[2014-01-21 12:51:54 -0500] CaptainQuirk: flaccid, ok
[2014-01-21 12:52:02 -0500] CaptainQuirk: but should I create an X cookbook for that ?
[2014-01-21 12:52:08 -0500] CaptainQuirk: I guess one exists already
[2014-01-21 12:53:12 -0500] CaptainQuirk: a community one
[2014-01-21 12:53:21 -0500] CaptainQuirk: it's more a question of where to put the code
[2014-01-21 12:53:28 -0500] CaptainQuirk: rather than the code itself
[2014-01-21 12:53:30 -0500] flaccid: CaptainQuirk: yeah i believe so. if it doesn't address user dotfiles then enhance
[2014-01-21 12:53:46 -0500] workmad3: CaptainQuirk: does xinitrc allow you to specify a directory to load extra config files from? e.g. an /etc/xinitrc.d/ directory?
[2014-01-21 12:54:01 -0500] CaptainQuirk: workmad3, hi !
[2014-01-21 12:54:06 -0500] CaptainQuirk: not a single clue, why ?
[2014-01-21 12:54:18 -0500] workmad3: CaptainQuirk: because that's how I tend to handle that sort of config... I template out a base template which does some config and then loads that directory
[2014-01-21 12:54:34 -0500] workmad3: CaptainQuirk: and then you can just use a file resource with a content param to add extra config
[2014-01-21 12:55:03 -0500] workmad3: CaptainQuirk: rather than needing to know the entire config at one point and using rewinds to alter it
[2014-01-21 12:56:43 -0500] ocholetras: workmad3: thx 4 the feedback :)
[2014-01-21 12:56:54 -0500] workmad3: ocholetras: np :)
[2014-01-21 12:57:03 -0500] CaptainQuirk: workmad3, doesn't look like it, no
[2014-01-21 12:57:15 -0500] CaptainQuirk: flaccid, can't find a community cookbook for X
[2014-01-21 12:57:22 -0500] flaccid: workmad3: X willl include that anyway
[2014-01-21 12:57:24 -0500] workmad3: ocholetras: end of the day, no single strategy for organising stuff works for all situations... you just need to think it through and decide on one that causes you the least amount of pain :)
[2014-01-21 12:57:46 -0500] flaccid: CaptainQuirk: if there really isn't one, then you are ground zero
[2014-01-21 12:58:17 -0500] CaptainQuirk: doesn't matter, if it's limited to a dummy dotfile
[2014-01-21 12:58:20 -0500] CaptainQuirk: or more
[2014-01-21 12:58:47 -0500] CaptainQuirk: but it wont be dynamic actually
[2014-01-21 12:59:00 -0500] workmad3: CaptainQuirk: wait, isn't xinitrc just a shell script?
[2014-01-21 12:59:45 -0500] flaccid: workmad3: yes and it should be bourne shell shebang
[2014-01-21 13:00:42 -0500] workmad3: CaptainQuirk: so you could use the strategy here: https://wiki.archlinux.org/index.php/xinitrc#Getting_started
[2014-01-21 13:01:03 -0500] workmad3: CaptainQuirk: namely, iterate over the files in an xinitrc.d directory with a shell for loop, loading them with a .
[2014-01-21 13:03:41 -0500] flaccid: workmad3: that is merely a default in the file for arch. funny i am on arch
[2014-01-21 13:04:24 -0500] flaccid: i'm actually using 4 monitors too with mate
[2014-01-21 13:05:26 -0500] workmad3: flaccid: heh :)
[2014-01-21 13:06:00 -0500] CaptainQuirk: workmad3, so, I would create as root an /etc/xinitrc.d directory ?
[2014-01-21 13:06:05 -0500] CaptainQuirk: sounds weird to me
[2014-01-21 13:06:15 -0500] CaptainQuirk: this really is user defined configuration
[2014-01-21 13:06:17 -0500] workmad3: flaccid: a joy of chef - picking the config strategy you like the most for an app/service, chefifying it and using it on any distro :)
[2014-01-21 13:06:23 -0500] CaptainQuirk: won't need it for other users
[2014-01-21 13:06:32 -0500] flaccid: CaptainQuirk: arch does it because Xorg hasn't done it natively
[2014-01-21 13:06:58 -0500] CaptainQuirk: flaccid, but in /etc/ ?
[2014-01-21 13:07:10 -0500] workmad3: CaptainQuirk: you can stamp out the user's .xinitrc.d to load global config from e.g. /etc/xinitrc.d and user config from $HOME/.xinitrc.d
[2014-01-21 13:07:43 -0500] flaccid: CaptainQuirk: yeah, but you don't need to do that
[2014-01-21 13:08:23 -0500] workmad3: CaptainQuirk: it's just a shell script, after all ;)
[2014-01-21 13:08:54 -0500] CaptainQuirk: stamp out ?
[2014-01-21 13:09:14 -0500] workmad3: CaptainQuirk: sorry, just how I refer to creating a file in chef from a template or a content param
[2014-01-21 13:09:34 -0500] tealc210: Hi, is there somebody to help me with chef hooks?
[2014-01-21 13:09:52 -0500] workmad3: CaptainQuirk: as in 'here's a carved potato stamp, go and stamp out X copies of the carving'
[2014-01-21 13:10:07 -0500] CaptainQuirk: I'm confused
[2014-01-21 13:10:27 -0500] CaptainQuirk: you would load both global and user config ?
[2014-01-21 13:10:40 -0500] workmad3: CaptainQuirk: it depends on what you need
[2014-01-21 13:10:48 -0500] workmad3: CaptainQuirk: I'd probably leave the option open personally
[2014-01-21 13:11:12 -0500] CaptainQuirk: For the moment, I just need to have an .xinitrc that contains exec startfluxbox
[2014-01-21 13:11:20 -0500] CaptainQuirk: shouldn't be that difficult
[2014-01-21 13:11:48 -0500] CaptainQuirk: but you would create a file /etc/xinitrc.d/desktop that would contain this file
[2014-01-21 13:12:07 -0500] CaptainQuirk: and my xinitrc would loop over all the files in this directory, and source them all ?
[2014-01-21 13:12:21 -0500] workmad3: CaptainQuirk: well, for the WM to exec, I'd probably provide an extra variable to the template
[2014-01-21 13:15:24 -0500] workmad3: CaptainQuirk: you can only have one WM to exec after all, as aiui you can't omit it... so I'd template the file so that it looked a bit like this: https://gist.github.com/workmad3/8539805
[2014-01-21 13:16:16 -0500] workmad3: CaptainQuirk: then provide a template resource with 'variables window_manager: "startfluxbox", global_conf_dir: "/etc/xinitrc.d" '
[2014-01-21 13:19:46 -0500] CaptainQuirk: workmad3, looks pretty elaborate
[2014-01-21 13:20:16 -0500] workmad3: CaptainQuirk: not particularly
[2014-01-21 13:20:40 -0500] CaptainQuirk: I'll have to look into it later, work calls back on me
[2014-01-21 13:21:17 -0500] workmad3: CaptainQuirk: it's just somewhat easier, IMO, to customise config by dropping a named file into a directory rather than editing one monolithic file, finding the right block (assuming you remembered to comment it sensibly) and making changes :)
[2014-01-21 13:22:30 -0500] workmad3: CaptainQuirk: the elaborate version would provide separate available/enabled directories ala /etc/nginx/sites-available and a couple of scripts to enable and disable config files ;)
[2014-01-21 13:23:49 -0500] maniac: guys can anyone shares of his usecases of berkshelf for chef client-server interactions ? experiencing problems in understanding of usage for this tool =( for vagrant i see its advantages  is there experienced guy with this tool ?
[2014-01-21 13:25:20 -0500] ocholetras: workmad3: one thing about using depends on your webserver cookbook is that if you want to search for all nodes using nginx you cant search for runlist or recpies i.e. knife search 'recipes:nginx'
[2014-01-21 13:25:26 -0500] ocholetras: workmad3: am i right?
[2014-01-21 13:26:07 -0500] workmad3: ocholetras: correct... so I tend to add a tag in my resources to allow that sort of searching
[2014-01-21 13:26:32 -0500] workmad3: ocholetras: e.g. search 'tags:nginx_server' instead of search 'recipes:nginx'
[2014-01-21 13:27:41 -0500] ocholetras: Yo tag the servers on the webserver recipe?
[2014-01-21 13:27:49 -0500] ocholetras: or by editing node object?
[2014-01-21 13:30:03 -0500] workmad3: ocholetras: I'll add the tag to node[:tags] inside my nginx_server provider
[2014-01-21 13:30:14 -0500] workmad3: ocholetras: so that any recipe that uses that resource gets the tag
[2014-01-21 13:30:21 -0500] ocholetras: :D
[2014-01-21 13:31:25 -0500] ocholetras: so you have your own nginx_server provider
[2014-01-21 13:31:30 -0500] workmad3: ocholetras: I don't do it with all my resources, just the ones that I want to search for (so my backup client resource, ossec agents, nginx server)
[2014-01-21 13:31:33 -0500] workmad3: ocholetras: yes
[2014-01-21 13:31:34 -0500] ocholetras: dont use the community nginx cookbook
[2014-01-21 13:31:35 -0500] ocholetras: ?
[2014-01-21 13:32:07 -0500] workmad3: ocholetras: community nginx cookbook distributes the nginx setup as a recipe, bound to node attributes... as per previous conversation, I don't agree with this :)
[2014-01-21 13:32:28 -0500] ocholetras: he he
[2014-01-21 13:33:30 -0500] ocholetras: just to confirm  loyalty to your principles
[2014-01-21 13:33:33 -0500] ocholetras: hehe ^^
[2014-01-21 13:35:11 -0500] workmad3: ocholetras: not so much loyalty to principles, more like I started my current infrastructure work with the idea of using community recipes... and I got royally pissed off with having to jump through hoops to tweak and fiddle with node attributes to customise cookbooks because that was the only way to customise them
[2014-01-21 13:35:57 -0500] flaccid: you can set node attributes without doing code
[2014-01-21 13:36:05 -0500] flaccid: anyway can i get some love? https://travis-ci.org/xhost-cookbooks/system/jobs/17339766
[2014-01-21 13:36:23 -0500] flaccid: C: Align the parameters of a method call if they span more than one line.
[2014-01-21 13:36:51 -0500] workmad3: ocholetras: so I started building my own resources out for these things... starting with base stuff like getting keys onto the nodes with openssl, setting up ossec, generating secure admin passwords on a node and encrypting them into node data, and it kinda snowballed into resourcifying all my building blocks :)
[2014-01-21 13:37:48 -0500] workmad3: flaccid: it's a lint violation
[2014-01-21 13:38:13 -0500] workmad3: flaccid: where your hash keys aren't aligned to the first argument of your attribute calls in metadata.rb
[2014-01-21 13:38:43 -0500] flaccid: workmad3: it loooks fine to me. what did i do wrong?
[2014-01-21 13:39:17 -0500] workmad3: flaccid: https://github.com/xhost-cookbooks/system/blob/master/metadata.rb#L24-L25
[2014-01-21 13:39:32 -0500] workmad3: flaccid: e.g. :display_name should be aligned with 'system/timezone'
[2014-01-21 13:39:44 -0500] workmad3: flaccid: and so on down the file
[2014-01-21 13:41:03 -0500] Xeron: Do attributes files support platform-specific loading? I mean, if I have attributes/debian_{6,7}.rb will Chef load only _7 for wheezy and only _6 for squeeze like it does for template files?
[2014-01-21 13:41:25 -0500] flaccid: workmad3: ok thanks i'll give it a try even though its silly
[2014-01-21 13:41:35 -0500] workmad3: flaccid: it's a lint violation, of course it's silly :)
[2014-01-21 13:41:49 -0500] ocholetras: Xeron: yes with case node['platform']..
[2014-01-21 13:42:18 -0500] workmad3: Xeron: not through the filename... which is why you see case statements on the platform, platform_family etc inside attribute files
[2014-01-21 13:42:34 -0500] Xeron: so sad
[2014-01-21 13:44:08 -0500] Xeron: It was implemented for template filenames, I believe it would be good to have same behavior for attribute files.
[2014-01-21 13:45:36 -0500] workmad3: Xeron: I can see some kinks that might need sorting out, but I don't necessarily disagree :)
[2014-01-21 13:46:01 -0500] bbssysop: hi all. i am simply trying to upload the yumrepo cookbook, and it reports that 'yum' cookbook is missing which it is not. here is a pastebin dump: http://paste.ubuntu.com/6791657/
[2014-01-21 13:46:28 -0500] bbssysop: any pointers on debugging?
[2014-01-21 13:46:28 -0500] workmad3: Xeron: namely, take the example of you have attributes/default.rb and attributes/debian/default.rb... should both be loaded? which one should be loaded first?
[2014-01-21 13:47:42 -0500] flaccid: bbssysop: maybe what it says is true
[2014-01-21 13:47:59 -0500] bbssysop: flaccid: if you look at the pastebin, you can see its not.
[2014-01-21 13:48:14 -0500] bbssysop: flaccid: yum 3.0.4 is installed and works fine.
[2014-01-21 13:48:15 -0500] flaccid: bbssysop: check knife cookbook list
[2014-01-21 13:48:30 -0500] bbssysop: again: yum                    3.0.4
[2014-01-21 13:48:56 -0500] workmad3: bbssysop: yumrepo depends on yum less than version 3.0.0
[2014-01-21 13:49:04 -0500] workmad3: bbssysop: yum 3.0.4 is greater than version 3.0.0
[2014-01-21 13:49:17 -0500] flaccid: yep
[2014-01-21 13:49:47 -0500] bbssysop: need to check my eyes -- could have swore that was greater than. or i wouldnt be asking.
[2014-01-21 13:49:52 -0500] workmad3: bbssysop: :)
[2014-01-21 13:50:13 -0500] bbssysop: soo.. installing a specific version with knife then..
[2014-01-21 13:50:19 -0500] flaccid: well i'm still failing, https://travis-ci.org/xhost-cookbooks/system/jobs/17340639
[2014-01-21 13:51:23 -0500] workmad3: flaccid: you fixed it for the first attribute, not the rest of them
[2014-01-21 13:51:53 -0500] drrk: is there any update in CHEF-4423 - slow cookbook synchronization?
[2014-01-21 13:51:58 -0500] flaccid: workmad3: thanks. man this is stupid
[2014-01-21 13:52:12 -0500] workmad3: flaccid: indeed... I'd personally investigate how to turn off linting as a build failure
[2014-01-21 13:52:51 -0500] flaccid: workmad3: yeah i'm just doing what chef and the community does
[2014-01-21 13:53:17 -0500] Xeron: workmad3 yes there're lot of corner cases, but I think it could be done in some way. For example for you case  load both with platform-specific priority.
[2014-01-21 13:53:33 -0500] workmad3: flaccid: my indenting is whatever 'G=gg' in vim provides, usually ;)
[2014-01-21 13:53:36 -0500] Xeron: we already have a lot of attribute levels, why don't add more :D
[2014-01-21 13:54:11 -0500] workmad3: flaccid: and screw the linters that quibble over where exactly my arguments should be aligned (as I've seen linters complain in both directions there)
[2014-01-21 13:54:36 -0500] workmad3: Xeron: devil's advocate - because it makes it even harder to figure out what value an attribute will end up as? :)
[2014-01-21 13:56:09 -0500] flaccid: workmad3: well not really. this aint python unfortunately and rubocop and other tests want it to past
[2014-01-21 13:56:15 -0500] flaccid: *pass
[2014-01-21 13:56:36 -0500] Xeron: wm3|lunch right :)
[2014-01-21 13:56:40 -0500] wm3|lunch: flaccid: if it was python, I'd be more anal about it ;)
[2014-01-21 13:57:01 -0500] flaccid: wm3|lunch: if it was python we wouldn't have this issue at all
[2014-01-21 14:12:06 -0500] GreatSUN: re
[2014-01-21 14:16:07 -0500] bbssysop: what is the ruby operator for... 'preg_match'? like <% if preg_match("google", node['domain']) then -%>
[2014-01-21 14:18:39 -0500] laurent\: bbssysop: node['domain'].match(/google/)
[2014-01-21 14:19:57 -0500] wm3|lunch: bbssysop: as in matching a regex?
[2014-01-21 14:20:10 -0500] wm3|lunch: bbssysop: <% if node['domain'] =~ 'google' %>
[2014-01-21 14:20:23 -0500] bbssysop: both great answers. thank you!
[2014-01-21 14:20:45 -0500] bbssysop: very similar to python
[2014-01-21 14:47:50 -0500] jpoole: anyone know of an easy way to assign a variable within a recipe that is the value of an environment variable?
[2014-01-21 14:50:39 -0500] sthulb: jpoole: node.set[:blah] = ENV['foo'] ?
[2014-01-21 14:50:43 -0500] sthulb: maybe
[2014-01-21 14:50:53 -0500] jpoole: yeah i'm trying that now
[2014-01-21 14:51:02 -0500] jpoole: foo = ENV['var']
[2014-01-21 14:51:16 -0500] jpoole: yup
[2014-01-21 14:51:17 -0500] jpoole: that's it
[2014-01-21 14:51:18 -0500] jpoole: thanks
[2014-01-21 15:06:51 -0500] ribo: One grain of luck sometimes worth more than whole rice field of wisdom. - Charlie Chan
[2014-01-21 15:24:19 -0500] allaire: when using the service resource, if I put :restart => true in the supports attribute, do I also need to put stop and start?
[2014-01-21 15:24:30 -0500] allaire: Also, can someone explain me what the :enable action does (in the case of Upstart)
[2014-01-21 15:34:00 -0500] workmad3: allaire: no, you don't need to say a resource supports stop and start (they're kinda the minimum required for a service script)
[2014-01-21 15:34:11 -0500] workmad3: allaire: and :enable hooks the service up to run on system boot
[2014-01-21 15:34:31 -0500] allaire: in the case of upstart, this is not out of the box?
[2014-01-21 15:35:03 -0500] docwhat: I'm trying to write a recipe that: a) fetching JSON data from a URL (which has LastModified support). b) parse the data. c) and create a file with the resulting data.  How do I do this in a "chef" way that doesn't make changes when not needed?
[2014-01-21 15:35:13 -0500] allaire: workmad3
[2014-01-21 15:35:27 -0500] workmad3: allaire: you can always check the source ;) https://github.com/opscode/chef/blob/master/lib/chef/provider/service/upstart.rb#L199-L203
[2014-01-21 15:35:42 -0500] workmad3: allaire: in the case of upstart, it makes sure the service is starting on boot by editing the upstart config
[2014-01-21 15:37:14 -0500] allaire: workmad3: Thanks mate! Just a last one, Most of the time I see what have to run initctl reload-configuration after adding an upstart script, is this handled by chef somehwere? I don't see it in the source
[2014-01-21 15:38:57 -0500] workmad3: allaire: pass on that, I'm afraid
[2014-01-21 15:39:08 -0500] allaire: no worries, thanks again!
[2014-01-21 15:39:16 -0500] workmad3: allaire: I only use upstart for services that come with upstart scripts out of packages... I use runit for all my own services
[2014-01-21 15:39:28 -0500] workmad3: allaire: best I can suggest is to just try and see :)
[2014-01-21 15:39:44 -0500] allaire: runit, never played with that one
[2014-01-21 15:40:04 -0500] geggam: meh.... cron monit and sysvinit are still very functional
[2014-01-21 15:40:12 -0500] geggam: simple too ;)
[2014-01-21 15:40:43 -0500] workmad3: geggam: runit is also pretty simple as a process supervisor rather than an init replacement :)
[2014-01-21 15:41:05 -0500] workmad3: part of why I use it is that a runit script is pretty much just a normal script
[2014-01-21 15:41:50 -0500] geggam: found monit and it works... so i didnt look for anything else workmad3 ... ive seen lots of people use runit and i really dont care... what i dont like is the fact most linux distros are attempting to recreate the inetd mess during the init process aka upstart or systemd
[2014-01-21 15:41:51 -0500] gleam: runit is good stuff
[2014-01-21 15:42:14 -0500] geggam: but that is totally oftopic and getting to be a vi emacs sort of discussion :)
[2014-01-21 15:42:19 -0500] workmad3: yeah :)
[2014-01-21 15:42:33 -0500] workmad3: process supervision is good, the rest is pretty much just yak shaving ;)
[2014-01-21 15:42:46 -0500] allaire: I like turtles
[2014-01-21 15:42:46 -0500] workmad3: at least in most cases
[2014-01-21 15:42:54 -0500] geggam: turtle soup is good
[2014-01-21 15:43:02 -0500] workmad3: it's turtles all the way down!
[2014-01-21 15:43:03 -0500] allaire: O_o
[2014-01-21 15:43:07 -0500] geggam: didnt know chinese ate that too ...
[2014-01-21 15:44:49 -0500] allaire: Talking about monit, i'm creating an m/monit cookbook at the moment :)
[2014-01-21 15:45:03 -0500] allaire: m/monit is pretty slick
[2014-01-21 15:45:09 -0500] geggam: very lightweight too
[2014-01-21 15:45:15 -0500] drrk: We are having an issue since upgrading to Chef 11 server where 'Storing updated cookbooks' takes a very long time, and ends up failing with a 403
[2014-01-21 15:45:33 -0500] drrk: talking 45 minutes or more before it fails
[2014-01-21 15:45:57 -0500] geggam: m/monit is good to give to the L1/2 guys so you dont need to let them into the servers allaire  :)
[2014-01-21 15:46:24 -0500] geggam: here is your button... push that... if it doesnt work call me
[2014-01-21 15:46:34 -0500] drrk: I think it might be CHEF-4423 but i'm not sure
[2014-01-21 15:46:41 -0500] allaire: geggam: Right now, I'm L[1-10] :)
[2014-01-21 15:46:54 -0500] geggam: im never l1
[2014-01-21 15:46:56 -0500] geggam: or 2
[2014-01-21 15:47:05 -0500] geggam: pagers are for people who can handle no sleep
[2014-01-21 15:47:14 -0500] freerobby: We have a problem where we can't deploy any new boxes, but old ones deploy just fine. New boxes hang here: https://gist.github.com/freerobby/86427edfecc5511022ad
[2014-01-21 15:47:19 -0500] freerobby: Anybody have ideas on what the issue might be?
[2014-01-21 15:47:20 -0500] allaire: You Level-Boss
[2014-01-21 15:47:41 -0500] geggam: L3+
[2014-01-21 15:47:56 -0500] geggam: i have bossed peoples but i find it annoying to tell people what to do
[2014-01-21 15:48:00 -0500] geggam: rather automate it
[2014-01-21 15:48:54 -0500] geggam: less worrying about hurting sensitive feelings that way :)
[2014-01-21 15:50:06 -0500] anandrew: if some jerk ( me ) deleted the validator client in hosted chef, is there any way to fix , other than a support ticket? tried recreating the client & regenerating the validation key to no avail
[2014-01-21 15:53:31 -0500] pcn: anandrew: regenerating it works
[2014-01-21 15:54:16 -0500] pcn: It may be that if you re-create it you need to re-set the appropriate permissions?
[2014-01-21 15:55:13 -0500] bbssysop: i have 1k vhost files. what does the experts think i should do as far as configuring chef to distribute them? use a bash rsycn command? use the /files/ dir?
[2014-01-21 15:56:04 -0500] jmartin: bbssysop: generate them with a cookbook instead?
[2014-01-21 15:56:14 -0500] jmartin: or do you mean the actual site content?
[2014-01-21 15:56:23 -0500] bbssysop: just vhosts
[2014-01-21 15:56:42 -0500] geggam: bbssysop, have you ever thought of using powerdns with an sql backend ?
[2014-01-21 15:56:55 -0500] geggam: o wait.... u said vhost
[2014-01-21 15:56:58 -0500] geggam: ignore
[2014-01-21 15:57:27 -0500] masterkorp: Guys what is the default link to the chef-webui ?
[2014-01-21 15:58:08 -0500] geggam: port 443 / masterkorp
[2014-01-21 15:58:26 -0500] bbssysop: If there were a way to pull them in to a template, i would. but 1,000+ vhosts with aliases, rewrite rules etc would take an age to massge into usable data.
[2014-01-21 15:59:16 -0500] geggam: that age is only getting bigger bbssysop ... better handle it while its still a small mountain :)
[2014-01-21 15:59:30 -0500] geggam: big mountains suck
[2014-01-21 16:00:02 -0500] bbssysop: i normally agree. whats the advantage.
[2014-01-21 16:00:52 -0500] geggam: if you cant see one im not the person to convince you... it gives me the same amount of pain either way ;)
[2014-01-21 16:01:06 -0500] bbssysop: 1) i make a dir on a central fileserver. 2) i make edits on the vhots there. 3) an rsync job keeps them up to date on all servers.
[2014-01-21 16:01:20 -0500] bbssysop: or 1) convert it to chef, over the next 6 months.
[2014-01-21 16:01:29 -0500] bbssysop: 2) to do the same thing really.
[2014-01-21 16:02:20 -0500] freerobby: Does this error message look correct to you guys? https://gist.github.com/freerobby/1ea8e88b5873e86521e6 Is it really possible a brand new ec2 instance clock drifts so much that chef can't authenticate for a first chef run?
[2014-01-21 16:02:34 -0500] geggam: welcome to virtuals... yes
[2014-01-21 16:03:12 -0500] freerobby: Yikes So is it impossible for me to bootstrap an EC2 instance from an ubuntu AMI? I need to make my own AMI and install NTP on it?
[2014-01-21 16:03:32 -0500] geggam: it can happen... but usually wont all the time :)
[2014-01-21 16:03:41 -0500] geggam: software clock vs hardware clock
[2014-01-21 16:04:16 -0500] bbssysop: geggam: so if i were to .. use the /files/ dir in chef, with a thousand vhosts, how many hours would chef take to check/copy them each time? is there a performance stat you know of?
[2014-01-21 16:04:41 -0500] bbssysop: geggam: or perhaps chef is fast as rsync and would take less than a second?
[2014-01-21 16:04:59 -0500] geggam: dude.. in ec2 for example... i can do the same chef run ... sometimes it takes 2 minutes sometimes it takes 20
[2014-01-21 16:05:12 -0500] geggam: attempting to benchmark stuff in the cloud is silly
[2014-01-21 16:05:20 -0500] bbssysop: no cloud.
[2014-01-21 16:05:29 -0500] geggam: unless you are buying dedicated IO
[2014-01-21 16:05:29 -0500] bbssysop: lan.
[2014-01-21 16:05:29 -0500] freerobby: geggam: Thanks. We haven't gotten a single ec2 instance to work for past 20 hours sadly.
[2014-01-21 16:05:41 -0500] geggam: then bench it yourself bbssysop
[2014-01-21 16:05:59 -0500] geggam: your environment is unique and only you can make that determination
[2014-01-21 16:06:41 -0500] pcn: Is anyone from opscode here?
[2014-01-21 16:07:14 -0500] pcn: The docs at http://docs.opscode.com/manage_server_hosted_clients.html point to an anchor that doesn't seem to answer the question of how to re-create the validator.
[2014-01-21 16:08:20 -0500] j^2: pcn: chef11 or chef10?
[2014-01-21 16:08:36 -0500] pcn: hosted chef
[2014-01-21 16:08:41 -0500] j^2: ah
[2014-01-21 16:08:43 -0500] j^2: not me then ;)
[2014-01-21 16:14:25 -0500] freerobby: geggam: It doesn't work even after I do an ntp sync any idea what could be the problem?
[2014-01-21 16:16:18 -0500] geggam: check your security settings to see that your instances can reach chef freerobby
[2014-01-21 16:16:42 -0500] geggam: ec2-54-203-143-82.us-west-2.compute.amazonaws.com [2014-01-21T15:38:57+00:00] ERROR: Timeout connecting to https://chef.wistia.com/environments/production/cookbook_versions, retry 1/5
[2014-01-21 16:17:17 -0500] freerobby: geggam: i'm using a security group that allows all traffic on all ports :\
[2014-01-21 16:17:28 -0500] geggam: evidently its misconfigured
[2014-01-21 16:17:54 -0500] freerobby: but why would it work for our existing chef boxes in the same group?
[2014-01-21 16:18:09 -0500] freerobby: (i'm not disputing you, i just don't understand what i might be doing wrong)
[2014-01-21 16:18:14 -0500] geggam: so i do this for a living... want to see my hourly rate :)
[2014-01-21 16:19:20 -0500] jmartin: freerobby: check your logs, find out what its complaining about specifically
[2014-01-21 16:19:20 -0500] freerobby: quite possibly.
[2014-01-21 16:19:27 -0500] garylabronz: is there like knife test.ping ?
[2014-01-21 16:19:32 -0500] freerobby: happens on rackspace as well
[2014-01-21 16:19:38 -0500] freerobby: jmartin: thanks, will look
[2014-01-21 16:21:41 -0500] jpoole: on ubuntu 12.04, i want a script to run only on termination/shutdown of a system, would this suffice?
[2014-01-21 16:21:42 -0500] jpoole: update-rc.d chef-shutdown start 10 0 .
[2014-01-21 16:25:42 -0500] masterkorp: Guys do i need the validation pem to use knife ?
[2014-01-21 16:25:51 -0500] j^2: masterkorp: nop
[2014-01-21 16:25:53 -0500] j^2: e
[2014-01-21 16:25:58 -0500] j^2: you need a client key
[2014-01-21 16:26:00 -0500] jonlives: masterkorp: not if you already have a valid client key
[2014-01-21 16:26:04 -0500] masterkorp: i just created a client with admin rights and knife
[2014-01-21 16:26:06 -0500] masterkorp: knifeERROR: Connection refused connecting to http://boobierack.masterkorp.net:4000/search/node?q=*:*&sort=X_CHEF_id_CHEF_X%20asc&start=0&rows=1000, retry 1/5
[2014-01-21 16:26:19 -0500] masterkorp: i created the client with webui
[2014-01-21 16:26:28 -0500] jmartin: masterkorp: what version of chef? 10 or 11?
[2014-01-21 16:26:33 -0500] masterkorp: 11
[2014-01-21 16:26:39 -0500] jonlives: masterkorp: try just a knife node list
[2014-01-21 16:26:41 -0500] freerobby: geggam: If it changes anything, I can CURL/lynx chef urls just fine.
[2014-01-21 16:26:46 -0500] jmartin: yeah, looks like your knife config is wrong then
[2014-01-21 16:26:58 -0500] masterkorp: knifeERROR: Connection refused connecting to http://boobierack.masterkorp.net:4000/nodes, retry 1/5
[2014-01-21 16:26:59 -0500] jmartin: :4000 iirc is old school
[2014-01-21 16:27:04 -0500] masterkorp: jmartin: smake
[2014-01-21 16:27:10 -0500] jmartin: try https
[2014-01-21 16:27:11 -0500] masterkorp: jmartin: oh, what the new port ?
[2014-01-21 16:27:34 -0500] jonlives: masterkorp: should be port 80, or 443 if ssl
[2014-01-21 16:27:41 -0500] masterkorp: i see
[2014-01-21 16:27:42 -0500] jonlives: masterkorp: just use http:// or https:// and leave off the port
[2014-01-21 16:27:46 -0500] jmartin: indeed
[2014-01-21 16:27:53 -0500] jonlives: can't recall if https is enabled by default
[2014-01-21 16:28:09 -0500] masterkorp: jonlives: 443 did the trick
[2014-01-21 16:28:11 -0500] workmad3: jonlives: yes
[2014-01-21 16:28:13 -0500] jonlives: masterkorp: w00t
[2014-01-21 16:28:18 -0500] jonlives: workmad3: ack, thanks
[2014-01-21 16:28:55 -0500] workmad3: jonlives: defaults to a self-signed cert generated on chef-server install
[2014-01-21 16:29:11 -0500] jonlives: gravy
[2014-01-21 16:29:15 -0500] workmad3: jonlives: but it's possible to set your own cert through some node attributes (along with customising the SSL ciphers, if that's your desire)
[2014-01-21 16:29:31 -0500] jonlives: been ages since we installed our chef server so I couldn't remember if we enabled https ourselves or not :p
[2014-01-21 16:29:44 -0500] workmad3: https everywhere IMO :)
[2014-01-21 16:29:48 -0500] workmad3: forget http exists
[2014-01-21 16:29:49 -0500] jonlives: ^ this
[2014-01-21 16:30:23 -0500] geggam: heh... irony...self signed certs are more secure see :NSA
[2014-01-21 16:30:53 -0500] workmad3: geggam: depends on how you generated your root CA ;)
[2014-01-21 16:31:12 -0500] freerobby: jonlives: By default it uses https and has http redirect to https.
[2014-01-21 16:31:16 -0500] jmartin: clearly the best option is to write it down on a napkin
[2014-01-21 16:31:18 -0500] freerobby: Also includes options to disable http or serve on it.
[2014-01-21 16:31:26 -0500] geggam: well... as long as the browser bitches about it and you can verify it then  you are one step up from verisign workmad3  :)
[2014-01-21 16:31:35 -0500] freerobby: haha
[2014-01-21 16:31:51 -0500] jonlives: freerobby: yep - I knew we used https, just couldn't recall if we enabled it or not.
[2014-01-21 16:32:00 -0500] workmad3: geggam: unless you used a backdoored setup to generate the certs... :P
[2014-01-21 16:32:04 -0500] freerobby: i believe all you need to do to make it secure is put this on your site somewhere: data:image/jpeg;base64,/9j/4AAQSkZJRgABAQAAAQABAAD/2wCEAAkGBxQHBhUUBxQWFREXGCAaGBcYGB8dIRsXIBogHRwdIBgdHCggIyAmIh0bIjMiJykrMC8uHB8zOjMsNygtLisBCgoKDg0OGxAPGy8jHyU3MTcxMDcsLy8vLC83NTcsNDc3LzAsNy0rNy0tNTI0NzQ0LzcsNyw3NywvLjQsLDAsLP/AABEIAKEBOgMBIgACEQEDEQH/xAAcAAEAAgMBAQEAAAAAAAAAAAAABgcEBQgDAgH/xABOEAABAwIEAwQFBQ4EAgsBAAABAAIDBBEFBhIhBzFBE1FhcRQiMoGhQlJykbI
[2014-01-21 16:32:17 -0500] geggam: if they want you that much workmad3  ... they are going to get you :)
[2014-01-21 16:32:50 -0500] workmad3: geggam: it's possible that the default RNG in openssl was backdoored though ;)
[2014-01-21 16:33:02 -0500] drrk: We are having an issue since upgrading to Chef 11 server where  'Storing updated cookbooks' takes a very long time, and ends up  failing with a 403
[2014-01-21 16:33:03 -0500] geggam: heh... i use openbsd @home ;)
[2014-01-21 16:33:19 -0500] drrk: can take 45mins or some before it fails
[2014-01-21 16:33:54 -0500] workmad3: geggam: does openbsd not use openssl?
[2014-01-21 16:35:53 -0500] EricL: Has there been a fix implemented for the python_pip issue with virtualenvs?
[2014-01-21 16:37:44 -0500] geggam: they seed with prng iirc workmad3
[2014-01-21 16:37:52 -0500] geggam: then use rng in openssl
[2014-01-21 16:38:21 -0500] geggam: http://www.openbsd.org/crypto.html
[2014-01-21 16:42:26 -0500] workmad3: geggam: :)
[2014-01-21 16:43:28 -0500] geggam: its not perfect workmad3 but it makes me feel like im running faster than the others the bear is chasing :)
[2014-01-21 16:44:06 -0500] workmad3: geggam: you just need to hope that it is a bear, and not a pack of wolves surrounding the entire herd ;)
[2014-01-21 16:44:39 -0500] geggam: but it is a pack... and i intend to sneak out of the herd and go hide in a cave... be a luddite and whatnot workmad3
[2014-01-21 16:45:22 -0500] workmad3: :)
[2014-01-21 16:45:42 -0500] ninjitsu: hey - anybody have experience setting up an OFFLINE "chef-full" distro for bootstrapping clients without internet/proxy access?
[2014-01-21 16:46:29 -0500] geggam: why not pxeboot and install chef-client  that way ninjitsu
[2014-01-21 16:46:42 -0500] geggam: seems like a simpler way
[2014-01-21 16:47:45 -0500] ninjitsu: i can't tell if that's sarcasm :)
[2014-01-21 16:48:22 -0500] ninjitsu: ultimatelyl i'd like to have it work during kickstart's "post", but maybe less than 1% of our servers have internet access
[2014-01-21 16:48:23 -0500] garylabronz: how do you guys handle using a locked ssh key?
[2014-01-21 16:48:38 -0500] garylabronz: at the moment i get asked by all 10 ssh sessions with knife, to unlock it
[2014-01-21 16:49:04 -0500] workmad3: garylabronz: read up about running an ssh-agent
[2014-01-21 16:49:51 -0500] geggam: dead serious ninjitsu ... its how i would do it...
[2014-01-21 16:50:15 -0500] geggam: chef is a config management platform... not a boostrapping installer
[2014-01-21 16:51:35 -0500] geggam: you can manage the pxeboot framework with chef tho ninjitsu
[2014-01-21 16:52:32 -0500] gchristensen: geggam: isn't that what he's talking about? using kickstart, similar to pxeboot
[2014-01-21 16:52:55 -0500] geggam: yes
[2014-01-21 16:53:13 -0500] geggam: kickstart is pxeboot
[2014-01-21 16:53:14 -0500] gchristensen: so how does that solve the issue of him not having internet to it
[2014-01-21 16:53:16 -0500] jonlives: ninjitsu: do you mean installing chef client on your non-internet access servers, or installing an actual chef server?
[2014-01-21 16:53:23 -0500] geggam: why do you need internet for pxe ?
[2014-01-21 16:53:38 -0500] geggam: me too
[2014-01-21 16:53:48 -0500] gchristensen: ninjitsu: what are you having a hard time with? specifically, what step?
[2014-01-21 16:54:22 -0500] ninjitsu: chef client
[2014-01-21 16:54:50 -0500] ninjitsu: so any future system that gets built would get the chef client installed during kickstart - but these clients are not internet connected, so the call out to opscode.com for the bootstrapping process would fail
[2014-01-21 16:55:27 -0500] ninjitsu: i'm trying to avoid having to have a proxy server created and would like to keep this offline if at all possible due to some company crap
[2014-01-21 16:56:54 -0500] geggam: you want to change where chef download the client
[2014-01-21 16:57:17 -0500] geggam: i cant remember the spot but its possible ninjitsu
[2014-01-21 16:57:42 -0500] ninjitsu: geggan - you realize that during bootstrapping, the knife bootstrap process reaches out to opscode.com to pull down the distro specified (or default) which is typically off on opscode.com, requiring internet access for the client getting bootstrapped?
[2014-01-21 16:57:49 -0500] geggam: yep
[2014-01-21 16:58:12 -0500] ninjitsu: ya so that's what i'm trying to work around - since we don't have internet access on the vast majority of our clients machines.
[2014-01-21 16:58:29 -0500] geggam: one of these guys can answer that... ive chnaged it but forgot where i did it :)
[2014-01-21 16:59:01 -0500] ninjitsu: i know you can specify a different distro to use, but am not finding many examples of how to create an offline distro - ideally there's an easy way to make a clone of the chef-full distro setup specifically for offline use.
[2014-01-21 17:00:14 -0500] drywheat: i want to build a cookbook for setting up my application (deploy user, rails setup, unicorn, monit) and i'm having a little trouble naming it
[2014-01-21 17:00:34 -0500] mattray: ninjitsu: I've done some of that with the pxe_dust cookbook: https://github.com/mattray/pxe_dust-cookbook/
[2014-01-21 17:00:46 -0500] drywheat: is it better practice to be generic or specific with cookbook names?
[2014-01-21 17:00:48 -0500] mattray: ninjitsu: local mirrors of chef-clients and customized bootstraps?
[2014-01-21 17:01:47 -0500] ninjitsu: mattray - one chef server per DC - clients in the DC would bootstrap to their local chef server and ideally pull down a chef-repo using a bootstrap distro that could provide all required components from the chef-server in their local DC directly.
[2014-01-21 17:02:10 -0500] mattray: ninjitsu: yup, that's about what I'm running
[2014-01-21 17:02:25 -0500] mattray: https://github.com/mattray/lab-repo
[2014-01-21 17:02:36 -0500] mattray: my lab has a bastion box running chef-server and pxe_dust
[2014-01-21 17:02:48 -0500] ninjitsu: mattray - the first link you sent looks ideal :)
[2014-01-21 17:03:08 -0500] mattray: ninjitsu: I've tried to make it modular so you don't have to do pxe booting if you don't want to
[2014-01-21 17:03:22 -0500] ninjitsu: we use pxe for building out new servers
[2014-01-21 17:03:27 -0500] ninjitsu: but will have to retrofit existing servers
[2014-01-21 17:03:45 -0500] mattray: ninjitsu: here's a write-up of my lab: http://docs.opscode.com/openstack_example.html
[2014-01-21 17:04:08 -0500] mattray: it's changed a little, but feel free to ask any questions
[2014-01-21 17:04:11 -0500] ninjitsu: and pxe dumps into kickstart which would have a %post section that would hopefully be able to install/configure the client
[2014-01-21 17:04:42 -0500] mattray: ninjitsu: yeah, pxe_dust is currently only preseeds with Debian/Ubuntu. Some magical day I'll get around to kickstarts for CentOS
[2014-01-21 17:05:00 -0500] mattray: but the chef-client mirroring works independently
[2014-01-21 17:05:39 -0500] mattray: if you're feeling ambitious, you could even stand up your own omnitruck service (that's the service that serves up chef-client downloads)
[2014-01-21 17:05:52 -0500] mattray: it's on GitHub, no idea if anyone's looked at it
[2014-01-21 17:06:04 -0500] mattray: I mean, except for Chef employees of course
[2014-01-21 17:07:08 -0500] ninjitsu: mattray - this is my first go-round learning / deploying / kind of architecting a chef deployment, and i'm not trying to reinvent any wheels - i'm trying to stick closely to any deployment conventions that work with how we operate, and create workarounds only when absolutely necessary
[2014-01-21 17:07:37 -0500] CPS_: getting a weird compile bug: https://gist.github.com/anonymous/8543908
[2014-01-21 17:07:38 -0500] mattray: ninjitsu: pxe booting is lacking standardization, everyone has opinions (myself included)
[2014-01-21 17:07:38 -0500] bbssysop: hello all. id like to add a link next to logout, in the chef-gui. has anyone ever done this succesfully?
[2014-01-21 17:07:46 -0500] CPS_: no such method 'message' for log resource
[2014-01-21 17:07:54 -0500] mattray: ninjitsu: so I can gladly answer any questions
[2014-01-21 17:09:07 -0500] ninjitsu: mattray - thanks for the links - let me try and wrap my brain around what you've provided and i'll come back with any questions / status on how i'm progressing - thanks so much.
[2014-01-21 17:09:19 -0500] mattray: ninjitsu: my pleasure, good luck
[2014-01-21 17:10:30 -0500] geggam: ninjitsu, look in here too  embedded/lib/ruby/gems/1.9.1/gems/chef-11.4.0/lib/chef/knife/bootstrap/chef-full.erb
[2014-01-21 17:12:15 -0500] mattray: geggam: yeah, the bootstrap templates are meant to be customized. https://github.com/opscode-cookbooks/pxe_dust/blob/master/recipes/bootstrap_template.rb writes out localized ones that point to your local chef-client mirror
[2014-01-21 17:12:36 -0500] j^2_: hls -la
[2014-01-21 17:14:11 -0500] bbssysop: http://paste.ubuntu.com/6792633/ : Id like to make that ### link work, any ideas how?
[2014-01-21 17:14:30 -0500] bbssysop: sort of a requirement.
[2014-01-21 17:16:25 -0500] workmad3: bbssysop: that looks like rails...
[2014-01-21 17:17:05 -0500] bbssysop: its the chef gui?
[2014-01-21 17:17:21 -0500] bbssysop: /opt/chef-server/embedded/service/chef-server-webui/app/views
[2014-01-21 17:26:12 -0500] CPS_: hmm apparently my problem was a bug fixed in chef client 11.something
[2014-01-21 17:33:23 -0500] lgbr: https://www.opscode.com/chef/metadata?v=&prerelease=false&p=arch&pv=rolling&m=x86_64 This is giving me an internal server error, but it's what's in https://learnchef.opscode.com/quickstart/workstation-setup/#linux   Any ideas?
[2014-01-21 17:36:30 -0500] ribo: D:
[2014-01-21 17:38:58 -0500] lgbr: ribo: YOU
[2014-01-21 17:42:23 -0500] ribo: YOU!
[2014-01-21 17:42:45 -0500] ribo: mr laser guided buny rabbit
[2014-01-21 17:44:09 -0500] freerobby: geggam: Got it! If you or anyone else is curious it's actually this bug: https://tickets.opscode.com/browse/CHEF-3921
[2014-01-21 17:45:23 -0500] workmad3: lgbr: http://www.getchef.com/chef/install/
[2014-01-21 17:45:42 -0500] workmad3: lgbr: the urls changed recently, so I'm guessing that the quickstart you have there hasn't been updated yet
[2014-01-21 17:48:36 -0500] lgbr: workmad3: ok, the URL on there is also incorrect, but I'll install the gem and move on. Thanks!
[2014-01-21 17:50:43 -0500] workmad3: lgbr: hmm... that gives me the url 'https://www.opscode.com/chef/install.sh' which works fine
[2014-01-21 17:51:00 -0500] workmad3: lgbr: and looking at it... I can't find the url you've got there :/
[2014-01-21 17:51:39 -0500] ribo: lgbr: you still working at that same place?
[2014-01-21 18:01:35 -0500] lgbr: ribo: In Berlin now
[2014-01-21 18:01:43 -0500] ribo: ah, nice
[2014-01-21 18:29:01 -0500] broconne: Is it possible to test only a specific suite with test kitchen?  I don't see an option for it, but seems liket hat would be something possible.
[2014-01-21 18:32:29 -0500] CPS_: how do i access files stored in a cookbook's files folder in a recipe?
[2014-01-21 18:33:03 -0500] wachpwnski: anyone know the proper way to make a cronjob recipe?
[2014-01-21 18:35:01 -0500] wachpwnski: resource cron seems to say I need to create it first, but what does that mean? Does that mean it will not execute the cron, and I need something that monitors the crontab? Or does it mean it will outright not add the entry into the crontab, but only modify an existing entry?
[2014-01-21 18:35:41 -0500] gleam: use the cron_d lwrp in the cron cookbook
[2014-01-21 18:35:43 -0500] gleam: is my suggestion
[2014-01-21 18:35:47 -0500] gleam: otherwise drop a file in /etc/cron.d
[2014-01-21 18:35:59 -0500] jblack: Hi. I have a bit of a problem with a cookbook that's registered, but doesn't actually exist?  ...:4040/cookbooks lists a cookbook named bonnie.  When I click on the cookbook, I get a "404 not found" in mesasges within the chef web ui
[2014-01-21 18:36:11 -0500] jblack: and I get a file not found when I try knife download cookbook bonnie
[2014-01-21 18:36:21 -0500] gleam: you can use the cron resource to edit the crontab directly if you want
[2014-01-21 18:36:41 -0500] gleam: it can create them fine, use action :create
[2014-01-21 18:36:51 -0500] gleam: (which is hte defeault)
[2014-01-21 18:36:55 -0500] gleam: the default, lord
[2014-01-21 18:37:10 -0500] jblack: Is there a way for me to tell the chef server to purge all knowledge of that cookbook?
[2014-01-21 18:37:34 -0500] gleam: knife cookbook delete bonnie not work?
[2014-01-21 18:37:47 -0500] jblack: Nope.
[2014-01-21 18:38:19 -0500] jblack: I did a grep of /var/lib/chef/cookbook_index, and I can see that the cookbook might actually be in there somewhere...
[2014-01-21 18:38:28 -0500] jblack: ./cookbook_index/60/605ac16b5d732a0d23f36413ab21bdfe:description      'Installs/Configures mcap-cookbook-test-bonnie'
[2014-01-21 18:43:56 -0500] cap10morgan: I'm getting a Fog::Compute::AWS::Error: SignatureDoesNotMatch error when trying to use knife ec2 server create (server list works, so I know the credentials are right). anyone seen that?
[2014-01-21 18:50:31 -0500] op__: hi can anyone help me I am trying to add my first node (my laptop) to hosted chef , I seem to get a HTTP 400 when it tries to register (I am running windows)
[2014-01-21 18:51:50 -0500] op__: my client.rb looks like this "log_level        :info log_location     STDOUT chef_server_url  'https://manage.opscode.com/' validation_key "C:\\chef\\daveperry-validator.pem""
[2014-01-21 18:52:01 -0500] op__: I don't know if the url is correct
[2014-01-21 18:53:24 -0500] qurve: What do you guys recommend using to install a specific version of ruby on a production server? In this case the host is Ubuntu 12.04.
[2014-01-21 18:54:02 -0500] qurve: I can't use apt because it is restricted to ruby 1.9.1 on 12.04 out of the box, and I took a crack at using RVM, using chef-rvm cookbook but that just seems like a horrid idea and I hate RVM.
[2014-01-21 18:54:29 -0500] gleam: you could try rbenv instead
[2014-01-21 18:54:36 -0500] jmartin: qurve: rbenv...err yeah ^
[2014-01-21 18:54:45 -0500] gleam: https://github.com/fnichol/chef-rbenv
[2014-01-21 18:54:47 -0500] qurve: I've heard of it, isn't it generally the same problems as RVM though?
[2014-01-21 18:54:50 -0500] wachpwnski: gleam: shouldn't this create a cronjob? http://pastebin.com/iNshsXYh
[2014-01-21 18:55:06 -0500] qurve: I don't need multiple rubies/gemsets/etc.
[2014-01-21 18:55:29 -0500] gleam: yes, you don't see it if you do crontab -u myuser -l?
[2014-01-21 18:55:56 -0500] wachpwnski: gleam it wont' load that recipe
[2014-01-21 18:57:12 -0500] qurve: Can anyone offer an opinion on the ebenv gem by RiotGames? I use Berkshelf, they seem to be clued.
[2014-01-21 18:57:15 -0500] qurve: rbenv*
[2014-01-21 18:57:30 -0500] shlant: qurve: that's good you don't need multiple versions because that is a hole you don't want to fall into. Maybe try the scripts in the comments? https://gist.github.com/bartimaeus/2845824
[2014-01-21 18:57:47 -0500] qurve: Yeah, that's the fallback shlant.
[2014-01-21 18:57:56 -0500] qurve: ruby is slow as fuck to build, I'm trying to avoid that if at all possible.
[2014-01-21 18:58:19 -0500] qurve: Might just have to suck it up, or bake AMIs in advance.
[2014-01-21 18:58:27 -0500] shlant: qurve: I hear ya.
[2014-01-21 18:58:31 -0500] shlant: was jsut oging to say that
[2014-01-21 18:58:34 -0500] shlant: pre packaged images
[2014-01-21 18:58:40 -0500] shlant: with ruby
[2014-01-21 18:58:42 -0500] EricL: Has there been a fix implemented for the python_pip issue with virtualenvs?
[2014-01-21 18:58:43 -0500] qurve: Thankfully packer makes it easy these days.
[2014-01-21 18:59:26 -0500] shlant: qurve: might be your best bet
[2014-01-21 18:59:38 -0500] shlant: having chef handle rvm/rbenv is a nightmare and not advised
[2014-01-21 18:59:40 -0500] qurve: I'm actually surprised that there isn't a good solution to this problem yet, or at least it doesn't feel like there is one.
[2014-01-21 19:00:00 -0500] qurve: shlant: Yeah, I used chef-rvm on a branch just to try it out. I knew it would be horrible, it was.
[2014-01-21 19:00:17 -0500] gleam: you could always use hte brightbox ppa and use their packaged rubies?
[2014-01-21 19:00:39 -0500] qurve: The question is how reliable they are.
[2014-01-21 19:00:48 -0500] qurve: Although I guess I could snag their .deb and put it right into my cookbook.
[2014-01-21 19:03:15 -0500] jblack: Let me take this up a level...  knife cookbook list  shows a cookbook named "mcap-cookbook-bonnie++"    knife cookbook delete --purge mcap-cookbook-bonnie++  says "ERROR: Cannot find a cookbook named mcap-cookbook-bonnie++ to delete"
[2014-01-21 19:04:29 -0500] arthurdent: how can i check node["platform"] on a machine before i've installed chef? i need to add something so it knows to reconfigure with upstart
[2014-01-21 19:04:50 -0500] arthurdent: it's mint, but adding the string "mint" didn't work
[2014-01-21 19:07:19 -0500] gleam: they've had that ppa for forever and i've never heard bad things. they run a rails hosting service
[2014-01-21 19:07:44 -0500] qurve: I'll do a POC.
[2014-01-21 19:07:53 -0500] qurve: Thanks for thei nput/opinions guys.
[2014-01-21 19:14:29 -0500] arthurdent: chef-server-ctl reconfigure is locking up on ruby_block[supervise_rabbitmq_sleep] action run
[2014-01-21 19:15:02 -0500] arthurdent: is there a way to get more verbose output, or does anyone know what's wrong?
[2014-01-21 19:15:31 -0500] TheMystic: Hey all, trying to bootstrap a node on an EC2 instance (in a VPC). knife-ec2 successfully creates the instance, but fails when it tries to bootstrap it.
[2014-01-21 19:15:46 -0500] TheMystic: I get:
[2014-01-21 19:15:46 -0500] TheMystic: Bootstrapping Chef on 10.10.1.71
[2014-01-21 19:15:47 -0500] TheMystic: ERROR: Errno::EISDIR: Is a directory - /path/to/my/chef/repo
[2014-01-21 19:19:28 -0500] CPS_: is there a way to get the path for a recipe's files directory?
[2014-01-21 19:29:03 -0500] seryl: Is there anyway to set a default notification for a LWRP?
[2014-01-21 19:38:01 -0500] jmickle: is there an easy way to query for which chef server is currently installed
[2014-01-21 19:38:03 -0500] jmickle: on a server?
[2014-01-21 19:38:32 -0500] shlant: jmickle: like the chef server version?
[2014-01-21 19:38:36 -0500] jmickle: yes
[2014-01-21 19:40:08 -0500] shlant: I was a bit confused by that too
[2014-01-21 19:40:17 -0500] shlant: is it not sudo chef-server -v
[2014-01-21 19:40:20 -0500] shlant: sorry
[2014-01-21 19:40:24 -0500] shlant: sudo chef-client -v
[2014-01-21 19:41:42 -0500] clayb: But the client's different than the server right; e.g. chef-client returns a version even if the server's no where to be found
[2014-01-21 19:42:28 -0500] shlant: jmickle: sudo cat /etc/chef-server-running.json | grep api_version
[2014-01-21 19:42:40 -0500] jmickle: ty
[2014-01-21 19:43:56 -0500] shlant: jmickle: idealy they would have it somewhere on the webui, but I can't find it
[2014-01-21 19:44:03 -0500] jmickle: yeah agreed
[2014-01-21 19:44:21 -0500] avleen: afternoon :-)
[2014-01-21 19:44:24 -0500] shlant: ello
[2014-01-21 19:44:58 -0500] avleen: i has question. hopefully an interesting one, regarding environments.
[2014-01-21 19:46:20 -0500] avleen: we store our environments in files (and in git) rather than editing them on the server. Problem is, when multiple people want to update the environment are roughly the same time (eg, they both upload new versions of different cookbooks), they can potentially end up clobbering each others changes.
[2014-01-21 19:46:53 -0500] avleen: I'm wondering if there's some way around this. breaking the environment file into one-file-per-cookbook would be one way, but I'm not sure how to really achieve that.
[2014-01-21 19:47:11 -0500] avleen: editing directly on the server might work too, but that's fraught with other dangers.
[2014-01-21 19:47:20 -0500] jmickle: hmm
[2014-01-21 19:47:21 -0500] shlant: avleen: I think you're looking for wrapper cookbooks
[2014-01-21 19:47:24 -0500] gchristensen: avleen: we use a CI environment which when the builds pass and are code reviewed, get merged and auto-uploaded
[2014-01-21 19:47:25 -0500] jmickle: it says api_version is 11.0.2
[2014-01-21 19:47:30 -0500] jmickle: even though i just ran the 11.0.10
[2014-01-21 19:47:31 -0500] scarolan: avleen: have a look at this https://github.com/jonlives/knife-spork
[2014-01-21 19:47:39 -0500] shlant: or wait
[2014-01-21 19:47:42 -0500] shlant: that's for roles
[2014-01-21 19:47:43 -0500] gchristensen: avleen: the other thing is - shlant is right, we avoid environment attributes for anything but version pinning.
[2014-01-21 19:47:50 -0500] avleen: scarolan: I work with jon, who wrote that :-)
[2014-01-21 19:48:05 -0500] avleen: we're making changes so fast that the process is breaking
[2014-01-21 19:48:14 -0500] avleen: the only thing we do is pin cookbook versions
[2014-01-21 19:48:30 -0500] avleen: jon's looking at it too, but he's a busy guy so I thought I'd go digging too.
[2014-01-21 19:48:55 -0500] gchristensen: avleen: automate the process of uploading environments to the server, and single-thread it :)
[2014-01-21 19:49:01 -0500] gchristensen: and put a code review process in front of it
[2014-01-21 19:49:20 -0500] avleen: noooo, we want things to go *faster*! not slower lol. I see what you mean though, we did think about this too.
[2014-01-21 19:49:27 -0500] avleen: and acutally, the CI method isn't bad at all.
[2014-01-21 19:49:30 -0500] avleen: has some other benefits.
[2014-01-21 19:49:44 -0500] avleen: does slow and serialise things, which I was hoping to avoid
[2014-01-21 19:49:45 -0500] shlant: jmickle: dpkg -s chef-server | grep 'Version'
[2014-01-21 19:49:56 -0500] gchristensen: the most dangerous thing (IMO) re not automating it, is not being certwain that all your databags and roles and environments match prod.
[2014-01-21 19:50:16 -0500] gchristensen: s/prod/the server/
[2014-01-21 19:50:24 -0500] jmickle: shlant: yeah i got that one i just wanted to make sure it was actually running that ver
[2014-01-21 19:50:52 -0500] avleen: gchristensen: yup. knife-spork helpfully warns you when you might be able to do something, which causes that kind of scenario.
[2014-01-21 19:50:54 -0500] jmickle: looks like there is a /version path now
[2014-01-21 19:50:55 -0500] jmickle: that works
[2014-01-21 19:52:21 -0500] shlant: it's too bad you can't freeze envs haha
[2014-01-21 19:52:49 -0500] gchristensen: avleen: you could revoke peoples' ability to upload environments and roles, solves the issue! ;)
[2014-01-21 19:53:04 -0500] avleen: gchristensen++
[2014-01-21 19:53:06 -0500] avleen: :-)
[2014-01-21 19:56:37 -0500] queuetip: for open source chef server, what protocol is used to talk to the server itself? 443? 22?
[2014-01-21 19:56:52 -0500] avleen: so i should make clear. when i said we use spork, it's awesome and really works. I'm really looking at something I think is an ineffiency in chef when working at high speed.
[2014-01-21 19:56:54 -0500] queuetip: i mean for nodes, bootstrapping nodes
[2014-01-21 19:58:43 -0500] queuetip: is there like a document that has the network communication mapped out for OS chef server, clients and nodes?
[2014-01-21 20:03:02 -0500] queuetip: i'm asking here because for instance this is still in the official docs: The Management Console runs on port 4040 by default. Navigate in a browser to http://chef.example.com:4040/ (replacing chef.example.com with the actual hostname of the server).
[2014-01-21 20:03:06 -0500] queuetip: which is no longer true
[2014-01-21 20:04:56 -0500] qurve: As a follow-up, the Brightbox source was by far the fastest/easiest way to provision the machine. I'll probably move forward with that while I evaluate the risks associated with relying on it.
[2014-01-21 20:06:37 -0500] acts_as_coder: queuetip - it's my understanding that nodes communicate with the chef-server exclusively via http or https, depending on what's in the nodes client.rb. My recollection is that chef-server 11.x defaults to https (whereas chef-server 10.x defaulted to http, I *think*)
[2014-01-21 20:08:01 -0500] mattray: acts_as_coder: correct. Hosted was already https
[2014-01-21 20:08:05 -0500] docwhat: How do I install a package only if a resource is available: e.g. Only install libyaml-devel if yum-epel is in the run_list.
[2014-01-21 20:08:48 -0500] acts_as_coder: mattray: also looks like Chef 11.x dropped the concept of running the API vs. the Web UI on different ports?
[2014-01-21 20:08:57 -0500] acts_as_coder: looks like it's all 443 now?
[2014-01-21 20:09:05 -0500] acts_as_coder: (by default, at least)
[2014-01-21 20:09:29 -0500] queuetip: acts_as_coder: yeah, https is default in the nginx config but i wasn't sure how nodes connected, ithought that's how you reached the web ui
[2014-01-21 20:09:38 -0500] mattray: acts_as_coder: sounds possible, I'd have to check the release notes
[2014-01-21 20:11:19 -0500] acts_as_coder: I'm having some trouble understanding attribute precedence for environments. If I have a bunch of attributes in a nested hash and I only want to override one of those values in an environment it seems like they all get wiped out.
[2014-01-21 20:12:33 -0500] acts_as_coder: example is something like this in my cookbook's attributes/default.rb -> default['mycompany']['product_name'] = { 'uno' => 1, 'dos' => 2 }
[2014-01-21 20:13:48 -0500] CPS_: can someone explain to me how the cookbook_file does and what it's purpose is? i'm having some trouble getting it to do what i want and I want to make sure i'm using the right resource
[2014-01-21 20:14:11 -0500] acts_as_coder: then in my environment rb file I put this --> default_attributes "mycompany" => { "product_name" => { 'uno' => 99 } }  then I seem to lose the 'dos' key from my hash. This look familiar to anyone?
[2014-01-21 20:14:58 -0500] CPS_: acts_as_coder: what you're doing there is direct reassignment
[2014-01-21 20:15:05 -0500] CPS_: look up how to do hash updates in ruby
[2014-01-21 20:15:13 -0500] CPS_: i don't know off the top of my head
[2014-01-21 20:16:02 -0500] acts_as_coder: CPS_: I guess I was thinking that Chef was going to merge the hashes for me since it has a whole precedence hierarchy in place?
[2014-01-21 20:16:54 -0500] CPS_: it runs on ruby though
[2014-01-21 20:17:38 -0500] acts_as_coder: the apache examples on http://docs.opscode.com/essentials_environments.html seem to imply that they are merged -- "An environment attribute will be applied to all nodes within the environment, ***except in places where it is overridden by an attribute with higher precedence***"
[2014-01-21 20:18:37 -0500] acts_as_coder: But it looks like I'm wiping out the entire hash and the values in the cookbooks attributes/default.rb aren't even considered
[2014-01-21 20:18:59 -0500] acts_as_coder: since environment attributes > cookbook attribute file
[2014-01-21 20:19:25 -0500] ChefBob: Chefs, I need some help writing a resource provider
[2014-01-21 20:19:38 -0500] ChefBob: Is it possible to write a LWRP that just uses resources from another cookbook?
[2014-01-21 20:20:48 -0500] jchauncey: @sethvargo how do you specify a version of chef_zero in the kitchen yml - https://github.com/opscode/chef/pull/1189
[2014-01-21 20:21:00 -0500] jchauncey: rather - https://github.com/opscode/chef-zero/issues/48
[2014-01-21 20:22:59 -0500] CPS_: acts_as_coder: that's what overriding is. blowing out and reassigning
[2014-01-21 20:25:14 -0500] acts_as_coder: CPS_: Right, I guess I need to manually merge the hashes myself via Ruby (or pursue another path). I can't figure out a way to only override pieces of a hash of attributes via Chef.
[2014-01-21 20:26:01 -0500] CPS_: acts_as_coder: try http://stackoverflow.com/questions/5215713/ruby-what-is-the-easiest-method-to-update-hash-values
[2014-01-21 20:26:31 -0500] jmartin: acts_as_coder: what do you mean only override pieces?
[2014-01-21 20:26:51 -0500] CPS_: yeah he wants to change one hash key and leave another alone
[2014-01-21 20:27:04 -0500] jmartin: wants to change the key itself or the value?
[2014-01-21 20:27:09 -0500] acts_as_coder: jmartin: value
[2014-01-21 20:27:20 -0500] jmartin: then why not specify that specific key only?
[2014-01-21 20:27:47 -0500] jmartin: node.override["stuff"]["key"] = new_value
[2014-01-21 20:28:08 -0500] jmartin: (or override only depending on context)
[2014-01-21 20:28:15 -0500] acts_as_coder: jmartin: I'd like to only override a single value using an environment
[2014-01-21 20:28:52 -0500] jmartin: acts_as_coder: right...so im not sure what issue you are running into then?
[2014-01-21 20:29:08 -0500] acts_as_coder: jmartin: Let's say that in my cookbook's attributes/default.rb I have specificied 10 attributes, but they are nested deeply like "default['mycompany']['myproduct']['setting1'] = 'one'" and "default['mycompany']['myproduct']['setting2'] = 'two'"
[2014-01-21 20:29:43 -0500] acts_as_coder: and in an environment I only want to override the default value for default['mycompany']['myproduct']['setting2']
[2014-01-21 20:30:33 -0500] acts_as_coder: and not specify *anything* about "setting1" or whatever else might be in the hash in the coobook's attributes/default.rb
[2014-01-21 20:30:35 -0500] mondo: What's the data bag syntax to add all of my .js files in a data bag directory?
[2014-01-21 20:30:42 -0500] mondo: Like I want to do: knife data bag from file users -a
[2014-01-21 20:30:55 -0500] lrr: hi. I'm having an issue with chef and fedora 19. It keeps erroring out when trying to iterate over a list of packages to install with a "nil to String" error even though the list is not empty?
[2014-01-21 20:30:56 -0500] mondo: and have it load all of the .js files from data_bags/users/
[2014-01-21 20:31:07 -0500] acts_as_coder: mondo: I never found a way to do this -- I used a bash loop + knife.
[2014-01-21 20:31:21 -0500] jmartin: acts_as_coder: right, so whats holding you back from doing that? afaik, it wont just wipe the rest of the hash
[2014-01-21 20:31:35 -0500] lrr: sfilter
[2014-01-21 20:31:37 -0500] lrr: er
[2014-01-21 20:31:38 -0500] mondo: acts_as_coder yeah I'll just do that, thanks.  Don't understand the -a option, though.
[2014-01-21 20:31:45 -0500] CPS_: lrr: how are you iterating? could be an off by one thing
[2014-01-21 20:32:09 -0500] acts_as_coder: mondo: for f in `ls *.js`; do knife data bag from file $f; done
[2014-01-21 20:32:26 -0500] acts_as_coder: mondo: or something _close_ to that ;)
[2014-01-21 20:32:35 -0500] jmartin: acts_as_coder: http://docs.opscode.com/essentials_environments.html for examples on override_attributes
[2014-01-21 20:32:59 -0500] mondo: acts_as_coder: just did find . -name "*.js" -exec knife data bag from file users {} \;
[2014-01-21 20:33:08 -0500] lrr: CPS_: http://pastebin.osuosl.org/5191/
[2014-01-21 20:33:16 -0500] lrr: CPS_: it owkrs just fine in centos 6
[2014-01-21 20:33:20 -0500] lrr: works*
[2014-01-21 20:34:21 -0500] kbarry: I can't find what EOB and EOH mean (I see them in recipes.....)
[2014-01-21 20:34:33 -0500] kbarry: I'm failing with google.
[2014-01-21 20:34:47 -0500] acts_as_coder: jmartin: Hmm... I see "When nested attributes are present, they will be preserved." which is what I'd expect. Going to double-check everything again b/c seems like it should be working.
[2014-01-21 20:35:06 -0500] acts_as_coder: kbarry: does it start with something like "somevar <- EOB" ?
[2014-01-21 20:35:35 -0500] kbarry: acts_as_coder: "code<<-EOB"
[2014-01-21 20:35:44 -0500] kbarry: Ohh, is it "End of Block"?
[2014-01-21 20:35:46 -0500] acts_as_coder: kbarry: that's Ruby's version of a "heredoc"
[2014-01-21 20:36:12 -0500] acts_as_coder: http://rubyquicktips.com/post/4438542511/heredoc-and-indent
[2014-01-21 20:36:44 -0500] acts_as_coder: kbarry: so, "EOB" and "EOH" have no special meaning -- just a string somebody is using.
[2014-01-21 20:36:51 -0500] jena-: any one see anything like this:  http://pastebin.com/CmRvxU3Y  it's an install of vagrant on Osx mavericks and chef-client is on there for our main chef server, and I guess chef-solo and vagrants berkshelf is now on there?  Not sure why it's puking
[2014-01-21 20:37:01 -0500] kbarry: It could be "Popsicles"
[2014-01-21 20:37:06 -0500] jmartin: anyone from opscode floating around? had some questions on an order that im not getting traction on :D
[2014-01-21 20:37:20 -0500] kbarry: it denoted the betinning, and end? <<-Popsicle ... Popsicle
[2014-01-21 20:37:36 -0500] kbarry: ???
[2014-01-21 20:38:15 -0500] acts_as_coder: kbarry: yep, although there *might* be some rules about it being all CAPs or something like that. Don't know that off the top of my head, but you can mostly think of it as an arbitrary string.
[2014-01-21 20:38:35 -0500] kbarry: Awesome, Thanks for the succinct response.
[2014-01-21 20:38:49 -0500] acts_as_coder: kbarry: and it also *might* need to be a string that does not occur in the string you are trying to capture. Again, not 100% sure on that.
[2014-01-21 20:43:08 -0500] acts_as_coder: jena-: what's the Vagrantfile look like for that error?
[2014-01-21 20:43:28 -0500] lrr: CPS_: nvm. i wrote that install part incorrectly
[2014-01-21 20:43:40 -0500] jena-: Let me paste it...
[2014-01-21 20:45:12 -0500] Cope: evening chefs: I need to implement a wait_for_ssh method in a recipe - if you've done this, could you let me know / show me? Right now looking into borrowing code from Kitchen::Driver::SSHBase - but open to other options.
[2014-01-21 20:45:47 -0500] CPS_: lrr: that's good because i can't find fault with what you sent me
[2014-01-21 20:45:54 -0500] jena-: and here's the Vagrantfile.... http://pastebin.com/mg1CyY2D
[2014-01-21 20:46:13 -0500] shlant: anyone know the best solution to needing different git repos for each recipe?
[2014-01-21 20:47:21 -0500] acts_as_coder: jena-: So I guess the real question is where did that Vagrantfile come from? Is that shipping with Vagrant now? Tried just setting "config.berkshelf.enabled = false" ?
[2014-01-21 20:47:43 -0500] CPS_: I can't get the cookbook_file resource to work in windows
[2014-01-21 20:48:04 -0500] jena-: Thats a leftover froma  fellow op, and he passed it on to me, and I did customization.  Shuld I generate a clean one, and then add my crap it?
[2014-01-21 20:53:05 -0500] shlant: is the rule of thumb small recipes, big cookbooks or the other way around?
[2014-01-21 20:53:21 -0500] shlant: I don't even know where I read it
[2014-01-21 20:53:45 -0500] gchristensen: small recipes (put logic in ruby libraries!) and small cookbooks (less blast radius when deploying) seem sane to me
[2014-01-21 20:53:57 -0500] acts_as_coder: jena-: yeah, why not just generate a fresh Vagrantfile using most recent berkshelf. Or do you even intend to use Berkshelf?
[2014-01-21 20:54:46 -0500] jena-: Yes, berkshelf is good, defintely need to use it to stay consistent with the corp setup
[2014-01-21 20:55:00 -0500] jena-: I'll try to generate  a fresh one.
[2014-01-21 20:55:49 -0500] acts_as_coder: jena-: I'll sometimes just do something like "berks cookbook dummy" to get a fresh view of things, including a new empty Vagrantfile done TheBerkshelfWay
[2014-01-21 20:56:26 -0500] acts_as_coder: both Berkshelf and Vagrant are pretty fast-moving though so seems like I run into compatibility issue rather frequently, particularly when bringing on new devs
[2014-01-21 20:57:15 -0500] kbarry: acts_as_coder: Very new to chef. Just noticing some things that seem quirky in our environment. I noticed that the "default attribute mode" is json, (When looking at the web interface of the chef server), I personally don't like the way its displaying the variables in jason here, but in the recipe, its in ruby (or something  else,) the point is, I want them to look the same.
[2014-01-21 20:57:48 -0500] kbarry: IS it possible to change the default mode for displaying, so its closer or possibly even identicle to how it is in the recipe?
[2014-01-21 20:58:15 -0500] acts_as_coder: kbarry: confused as to where the values are displaying that you are talking about
[2014-01-21 20:58:46 -0500] kbarry: Looking on a role page
[2014-01-21 20:58:58 -0500] kbarry: acts_as_coder:  (sorry, very new)
[2014-01-21 20:59:20 -0500] acts_as_coder: kbarry: but generally speaking, for most (all?) Chef config files (nodes, environments, roles, data bags?) you can choose between JSON or a Chef-specific Ruby DSL.
[2014-01-21 20:59:21 -0500] kbarry: At the bottom of the page, ther eis a "Defaults and Override Attributes" section,
[2014-01-21 20:59:53 -0500] shlant: kbarry: i believe chef-servers convert ruby to json on upload. I don't think you can display it as ruby in the webgui
[2014-01-21 21:00:18 -0500] kbarry: OK, I tohught it might be possible since it shows "Mode: NATIVE JSON
[2014-01-21 21:00:39 -0500] shlant: kberry: not sure what that's for
[2014-01-21 21:00:49 -0500] kbarry: http://docs.opscode.com/breaking_changes_chef_11.html
[2014-01-21 21:01:00 -0500] prometheanfire: anyone here running kitchen test though jenkins? having an issue where jenkins can't ssh into the node once it's built but I can when running kitchen test manually
[2014-01-21 21:01:16 -0500] acts_as_coder: kbarry: where in the UI does it show that? Never seen it before. Chef 11 open source? Hosted?
[2014-01-21 21:01:19 -0500] kbarry: take a look at this section : Shef is now chef-shell
[2014-01-21 21:01:24 -0500] prometheanfire: kitchen diagnose all was the same between manual run and jenkins run
[2014-01-21 21:01:34 -0500] kbarry: chef 11 opensource
[2014-01-21 21:02:24 -0500] kbarry: Clicked on "Role" the on the name of one of our roles "Base"
[2014-01-21 21:02:50 -0500] kbarry: IT appSorry, Role, then clicked "Edit" to the right of the name.
[2014-01-21 21:02:57 -0500] CPS_: how can i trigger a reboot after a recipe has been executed?
[2014-01-21 21:03:11 -0500] kbarry: It appears as a section at the bottom of the "Edit" view of a role.
[2014-01-21 21:03:43 -0500] acts_as_coder: kbarry: on the "show" tab?
[2014-01-21 21:03:48 -0500] kbarry: (BTW, Thanks for the help, I'm trying to jump in and get a better understanting."
[2014-01-21 21:04:10 -0500] kbarry: The Edit tab.
[2014-01-21 21:04:30 -0500] acts_as_coder: kbarry: yeah, that's always going to be json. Chef converts anything in the Ruby DSL format to JSON upon upload to chef-server.
[2014-01-21 21:05:18 -0500] kbarry: IT just seems like its changable since its showing the format, as if its an option
[2014-01-21 21:05:23 -0500] acts_as_coder: kbarry: I kinda like to go all-json for the config files instead of the Ruby DSL because it feels "more standard" and can then can be easily consumed by other clients if that need ever arises.
[2014-01-21 21:06:22 -0500] acts_as_coder: kbarry: btw, I don't think "chef-shell" is in play when you're using the web UI so those release notes aren't relevant in this case AFAIK
[2014-01-21 21:21:50 -0500] joe_k: has anyone successfully bootstrapped a win2012R2 machine as the local administrator?
[2014-01-21 21:21:56 -0500] joe_k: via winrm
[2014-01-21 21:25:17 -0500] lrr: how do I upload updated community cookbooks to my chef server?
[2014-01-21 21:25:51 -0500] EricL: lrr: Increment the metadata.rb if it requires it and then "knife cookbook upload new_cookbook"
[2014-01-21 21:26:27 -0500] EricL: lrr: Well, make sure you update the cookbook locally first.  You only need to increment the metadata.rb version if the new_cookbook has an equivalent or older version than the old cookbook.
[2014-01-21 21:26:34 -0500] lrr: EricL: i have,  and this is the output: http://pastebin.osuosl.org/5196/
[2014-01-21 21:28:04 -0500] EricL: What version of the chef-client cookbook do you have?
[2014-01-21 21:30:01 -0500] joe_k: yay. some chef gem started requiring a native extension
[2014-01-21 21:30:06 -0500] joe_k: THAT DOESNT WORK ON WINDOWS PEOPLE
[2014-01-21 21:30:27 -0500] lrr: EricL: on the ser, we have 2.2.2
[2014-01-21 21:30:47 -0500] lrr: EricL: shouldn't uploading the cookbook cause the server to dl the required community cookbook?
[2014-01-21 21:31:34 -0500] jpoole: who uses windows?
[2014-01-21 21:31:35 -0500] jpoole: ;)
[2014-01-21 21:31:48 -0500] joe_k: funny.
[2014-01-21 21:32:09 -0500] joe_k: dont pretend to support it while paying customers bang their head on the wall over and over and over
[2014-01-21 21:33:51 -0500] jpoole: you could convert the gem
[2014-01-21 21:34:20 -0500] joe_k: i just want to get it to work. i dont know anything about publishing ruby gems and I dont want to
[2014-01-21 21:34:44 -0500] jpoole: well, that's what I would do, to get_it_to_work.
[2014-01-21 21:34:47 -0500] joe_k: i just want the system to work out of the box
[2014-01-21 21:35:00 -0500] jpoole: you could just yell and fuss, perhaps that may get it to work, but i have not tried that
[2014-01-21 21:35:20 -0500] mattsurabian: I have a silly question Within the recipes directory is it acceptable to also have child directories? Say for a cookbook with many recipes?
[2014-01-21 21:35:26 -0500] joe_k: i am looking for other people who have done this successfully, to know it has even succeeded before
[2014-01-21 21:35:36 -0500] EricL: lrr: Only if you are using something like Berkshelf.
[2014-01-21 21:36:02 -0500] jpoole: sure, i've successfully converted a native gem to a binary one and used it on windows.
[2014-01-21 21:36:09 -0500] EricL: lrr: I prefer to maintain all cookbooks locally in the git repo.  Then upload each of then as needed to make sure I can rebuild the chef srever cookbook bookshelf from scratch if I need.
[2014-01-21 21:36:12 -0500] jpoole: out of the box.
[2014-01-21 21:38:29 -0500] joe_k: jpoole: if only I was as cool as you, maybe I could make it work
[2014-01-21 21:38:56 -0500] jpoole: not sure what you're getting at, noone is THAT cool, come'on now.
[2014-01-21 21:39:12 -0500] joe_k: i am struggling with making this work, i'
[2014-01-21 21:39:15 -0500] joe_k: i've spent hours on it
[2014-01-21 21:39:22 -0500] jpoole: well..
[2014-01-21 21:39:28 -0500] jpoole: i've spent years on my chef repo...
[2014-01-21 21:39:31 -0500] jpoole: still not where i want it.
[2014-01-21 21:39:41 -0500] jpoole: do a bit of google-fu...
[2014-01-21 21:39:42 -0500] jpoole: http://rubylearning.com/blog/how-do-i-install-a-ruby-gem-with-native-extensions-on-windows/
[2014-01-21 21:40:12 -0500] jpoole: build the gem (and perhaps any other native ones that are in the bundle), and move on with the next iteration
[2014-01-21 21:40:24 -0500] jpoole: if evreything worked out of the box, what would you do then?
[2014-01-21 21:41:04 -0500] joe_k: id get this slave configured and be on my way. goal is not to be a ruby/chef expert. it's to get my build machine up
[2014-01-21 21:45:16 -0500] joe_k: fyi i have devkit installed, it bails with compilation errors.  Native extensions have caused numerous problems in our dev team because of how brittle they are to get built on Windows
[2014-01-21 21:48:00 -0500] jpoole: do you have make, gcc, sh, and simular *nix build tools installed?
[2014-01-21 21:48:25 -0500] joe_k: they are installed as part of devkit; i also have git bash and its toolset on there
[2014-01-21 21:48:39 -0500] jpoole: git bash really doesn't help with building, but anyhow.
[2014-01-21 21:48:56 -0500] jpoole: what are the compilation errors
[2014-01-21 21:48:56 -0500] joe_k: you asked about sh.
[2014-01-21 21:49:01 -0500] jpoole: sh is not git.
[2014-01-21 21:49:11 -0500] drogoh: berkshelf claims it uploads all of my cookbooks, but a single cookbook isn't uploading. running with -d doesn't give any indicators as to why this single cookbook isn't uploading
[2014-01-21 21:49:32 -0500] joe_k: dude. no shit. but gitbash _is_ sh
[2014-01-21 21:49:33 -0500] jpoole: dragoh increase teh version number in the metadata
[2014-01-21 21:49:40 -0500] drogoh: already did that
[2014-01-21 21:49:42 -0500] jpoole: dude, sh, is not bash.
[2014-01-21 21:49:47 -0500] joe_k: *** Couldn't reserve space for cygwin's heap, Win32 error 0
[2014-01-21 21:49:50 -0500] jpoole: but anyhow, you're the fucking expert now aren't you.
[2014-01-21 21:50:04 -0500] joe_k: i have a lot of years of experience with sh, bash, and the rest, so yes
[2014-01-21 21:50:21 -0500] jpoole: perfect, then you this problem you're having should be pretty easy for an expert of your nature.
[2014-01-21 21:50:33 -0500] jpoole: why are you even here?
[2014-01-21 21:50:39 -0500] joe_k: i am NOT an expert at making ruby work
[2014-01-21 21:50:50 -0500] jpoole: this isn't really a ruby problem either.
[2014-01-21 21:50:55 -0500] joe_k: because I am trying to use chef according to the examples, and i am hitting a wall
[2014-01-21 21:51:09 -0500] jpoole: well with your experience, why is this making your panties all knotty
[2014-01-21 21:51:28 -0500] joe_k: if chef can't be used as the documentation shows, because of a problem with its choice of prereqs, I'd expect to find something here
[2014-01-21 21:51:42 -0500] jpoole: you have high expectations
[2014-01-21 21:51:57 -0500] joe_k: i do?
[2014-01-21 21:52:01 -0500] joe_k: what should I expect?
[2014-01-21 21:52:02 -0500] jpoole: chef can be used as the documentation shows, but you're unwillingless to figure out simple memory issues.
[2014-01-21 21:52:12 -0500] jpoole: with 'your years of experience'
[2014-01-21 21:52:35 -0500] jpoole: anyhow, since you are unwilling to cooperate, and a genuine prick, i'm off.
[2014-01-21 21:52:44 -0500] joe_k: good riddance
[2014-01-21 21:53:29 -0500] joe_k: Has anyone boostrapped a Windows 2012R2 machine as the local admin, over WinRM?
[2014-01-21 21:54:22 -0500] drogoh: just bumped the version again in metadata, no dice
[2014-01-21 21:57:34 -0500] Cope: joe_k: yes
[2014-01-21 21:57:40 -0500] Cope: lots of times
[2014-01-21 21:58:46 -0500] joe_k: i thought i had all the winrm bits adjusted, but I'm getting a "ERROR: Failed to authenticate to some-machine" / 401 even though the username/password appears correct, wondering if you're ever surmounted that issue
[2014-01-21 21:58:59 -0500] joe_k: you've
[2014-01-21 21:59:51 -0500] joe_k: it seemed to be ignoring the -x command line option in preference of ~/.chef/knife.rb , so I commented out the username in knife.rb .... now appears to be using the right username but still no dice
[2014-01-21 22:00:00 -0500] Cope: i found breaking out pry and using the winrm gem and connecting manually was a good way to troubleshoot
[2014-01-21 22:00:42 -0500] Cope: once you've got that connecting, you're golden
[2014-01-21 22:01:34 -0500] Cope: i remember a few fiddly things with win2k12 that were a non-issue with win2k8
[2014-01-21 22:01:57 -0500] Cope: i don't recognise your specific symptoms, but it's certainly very possible
[2014-01-21 22:02:15 -0500] Cope: so you'll get there, with some perseverence and patience :)
[2014-01-21 22:06:53 -0500] drogoh: strange. I get version numbers back when I do knife cookbook show [cookbook], but provisioning bails saying the cookbook can't be found
[2014-01-21 22:07:14 -0500] drogoh: additionally, I can't see the cookbook in the ui
[2014-01-21 22:24:07 -0500] Yoteco: Hi! I have a recipe which uses a template resource. In the template (*.erb) I'm using <% xxx.each_pair ... %> and it works very well when I run it with Vagrant and chef solo provisioner. But when I try to use the same recipe with chef bootstrap I receive the following error: Chef::Mixin::Template::TemplateError (undefined method `each_pair' for nil:NilClass)
[2014-01-21 22:24:19 -0500] Yoteco: Does somebody know what the problem could be?
[2014-01-21 22:25:05 -0500] acts_as_coder: yoteco: I'm guessing the value os 'xxx' comes from a node attribute?
[2014-01-21 22:25:40 -0500] Yoteco: acts_as_coder: Here's the line -> <% @external_config.each_pair do |key, value| %>
[2014-01-21 22:25:42 -0500] acts_as_coder: yoteco: that's a Ruby error telling you that the 'xxx' variable is nil
[2014-01-21 22:26:11 -0500] Doc_X: is there a way to download a chef-repository from the chef web GUI?
[2014-01-21 22:26:35 -0500] acts_as_coder: yoteco: ok, so you must have a corresponding line that starts with "variables" in the template block in your recipe. What's being passed in to @external_config ?
[2014-01-21 22:27:03 -0500] acts_as_coder: Doc_X: what are you referring to as "a chef-repository"?
[2014-01-21 22:27:14 -0500] Doc_X: i know the repo should be kept in git/svn/whatever, but i don't quite have the repo permissions yet, but still want to be able to run knife commands.
[2014-01-21 22:27:39 -0500] Yoteco: acts_as_coder: :external_config => node[:external_config]. But the value :external_config is only set for a given environment. And I forgot to specify the environment, this has to be the error.
[2014-01-21 22:28:00 -0500] Doc_X: "chef-repository" == "files that will allow me to run knife commands against the chef server and perhaps contain data bags, roles, environments, cookbooks, etc"
[2014-01-21 22:29:30 -0500] acts_as_coder: Doc_X: If you already have knife access to a chef server then you can use knife to download cookbooks, etc. "knife cookbook download COOKBOOK [VERSION] (options)"
[2014-01-21 22:30:18 -0500] acts_as_coder: Doc_X: but that's a weird way to do it... I'm sure you'll ruin someone's day if you download a cookbook, change it, and re-upload it outside of a version control system ;)
[2014-01-21 22:33:17 -0500] Doc_X: acts_as_coder: i don't have knife access yet.... i have access to the chef web GUI, but not an environment from which i can run knife commands.  that's what i'm looking to achieve.
[2014-01-21 22:33:54 -0500] Doc_X: acts_as_coder: and i'm definitely not going to do any uploading of cookbooks/data bags/environments or modifying of nodes. . . just wanting to do querying right now.
[2014-01-21 22:34:20 -0500] Doc_X: and there's a world of difference between navigating things via knife and doing so via the web gui.
[2014-01-21 22:40:47 -0500] Doc_X: guessing there's not really an easy way to generate a command-line environment only having access to the gui based on the resounding silence.
[2014-01-21 22:41:06 -0500] acts_as_coder: Doc_X: That doesn't make sense to me. What do you hope to achieve with knife? Or do you wish to download the cookbooks so you can browse the source code? The main purpose of knife is to interact with a chef-server via its API, so I suspect you're misunderstanding knife's role in all this.
[2014-01-21 22:41:38 -0500] acts_as_coder: Doc_X: specifically, "navigating things via knife" doesn't make sense to me
[2014-01-21 22:42:00 -0500] Doc_X: knife node list; knife node show nodename; knife role list;
[2014-01-21 22:42:31 -0500] Doc_X: i know what knife's role is.  perhaps not explaining things well, but i want to be able to query the chef organization and see how things are config'd in this particular org
[2014-01-21 22:42:54 -0500] Doc_X: i'm moving from one group to another... have done plenty of chef, but am not quite in place with the new group for source code and such.
[2014-01-21 22:43:06 -0500] acts_as_coder: Doc_X: Do you have admin rights in the web gui? If so, you can grant yourself access to use knife.
[2014-01-21 22:43:12 -0500] Doc_X: have my pem.  have my org invite and such.
[2014-01-21 22:43:45 -0500] Doc_X: yeah, have admin rights.
[2014-01-21 22:44:20 -0500] acts_as_coder: Doc_X: ok, I guess I'm confused then. If you have a valid pem I don't see why you couldn't configure your knife client (most likely via a knife.rb file) to connect to the chef server's API using knife from your computer.
[2014-01-21 22:46:58 -0500] Doc_X: acts_as_coder: pretty sure i'm not explaining well and it's time for me to head out from work anyway.
[2014-01-21 22:59:31 -0500] Yoteco: Is it right that I have to create a folder named "environments" and then create a MyEnv.rb for each environment to define environment specific attributes?
[2014-01-21 22:59:51 -0500] Yoteco: So for example environments/Development.rb
[2014-01-21 23:00:26 -0500] Yoteco: When I take a look to my cookbook on the chef-server it doesn't seem to take my environment attributes.
[2014-01-21 23:00:40 -0500] acts_as_coder: Yoteco: to flip it around, what's wrong with that approach?
[2014-01-21 23:01:09 -0500] acts_as_coder: Yoteco: your cookbook won't know anything about the environment. A "node" will have the environment which in turn executes the cookbook.
[2014-01-21 23:01:48 -0500] acts_as_coder: Yoteco: to clarify, just looking at a cookbook on the chef server there is no connection to any variables in an environment
[2014-01-21 23:02:27 -0500] Yoteco: acts_as_coder: Yes, but when I bootstrap a server with --environment Development the attributes are not taken
[2014-01-21 23:02:46 -0500] Yoteco: acts_as_coder: I mean the attributes I defined in the Development.rb file
[2014-01-21 23:03:13 -0500] masterkorp: guys what are your tough on emeril vs stove ?
[2014-01-21 23:12:51 -0500] Yoteco: It looks like the environments folder wasn't uploaded to the chef server
[2014-01-21 23:13:23 -0500] Yoteco: At least it's not present in the /var/chef/cache/cookbook/my-cookbook folder...
[2014-01-21 23:15:33 -0500] Yoteco: BTW I'm working with berkshelf and I use berks upload to upload my cookbook
[2014-01-21 23:18:27 -0500] lrr: I'm having an issue wit hthe chef-client cookbook on fedora19, mainly chef-client::cron
[2014-01-21 23:18:36 -0500] lrr: http://pastebin.osuosl.org/5206/
[2014-01-21 23:18:40 -0500] lrr: any help ^^?
[2014-01-21 23:32:10 -0500] doomviking: lrr: its telling you what the issue is. cant find the source file
[2014-01-21 23:33:30 -0500] lrr: doomviking: problem is, this is a community cookbook and it claims to support fedora
[2014-01-21 23:33:45 -0500] lrr: but the cron recipe doesn't show ANY support for fedora
[2014-01-21 23:33:52 -0500] lrr: the cchef-client::cron*
[2014-01-21 23:34:19 -0500] doomviking: ah hm
[2014-01-21 23:34:58 -0500] lrr: and since fedora isn't part of the rhel platform family, we're kinda stuck
[2014-01-21 23:35:30 -0500] Cope: lrr: change the init method
[2014-01-21 23:36:25 -0500] lrr: Cope: to what? right now it's set to none
[2014-01-21 23:37:58 -0500] Cope: scratch that - i mesread your error
[2014-01-21 23:38:14 -0500] Cope: doomviking has already told you the issue
[2014-01-21 23:38:19 -0500] Cope: as has chef
[2014-01-21 23:39:11 -0500] Cope: https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/cron.rb#L42-L47
[2014-01-21 23:39:53 -0500] Cope: your error shows: templates/fedora-19//init.d/chef-client.erb
[2014-01-21 23:39:56 -0500] Cope: notice //
[2014-01-21 23:39:58 -0500] Cope: look at the code
[2014-01-21 23:40:11 -0500] lrr: Cope: it works perfectly in centos
[2014-01-21 23:40:22 -0500] Cope: that doesn't surprise me at all
[2014-01-21 23:40:23 -0500] lrr: and notice how just above that section, it doesn't set ANYTHING for fedora
[2014-01-21 23:40:31 -0500] lrr: https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/cron.rb#L35-L38
[2014-01-21 23:40:31 -0500] Cope: yes... what does that tell you
[2014-01-21 23:40:52 -0500] lrr: Cope: it tells me that this cookbook assumes fedora was and is still in the rhel/redhat family
[2014-01-21 23:40:59 -0500] lrr: but it's not
[2014-01-21 23:41:16 -0500] Cope: yep, that's my reading too:
[2014-01-21 23:41:26 -0500] Cope: value_for_platform_family doesn't return rhel for fedora
[2014-01-21 23:41:37 -0500] lrr: damnit, i didn't want to have to fork this repo...
[2014-01-21 23:41:48 -0500] Cope: do you have to run it in cron?
[2014-01-21 23:42:07 -0500] lrr: how else would i run it? (besides for manually)
[2014-01-21 23:42:55 -0500] Cope: https://github.com/opscode-cookbooks/chef-client#service-recipes
[2014-01-21 23:44:25 -0500] Cope: basically you have a choice - run it out of cron, or as a service
[2014-01-21 23:44:38 -0500] Cope: given that cron isn't working on fedora (for which you should raise an issue)
[2014-01-21 23:44:53 -0500] Cope: i'd suggest using a service option.
[2014-01-21 23:44:58 -0500] Cope: I tend to use runit for everything.
[2014-01-21 23:48:14 -0500] coderanger: schisamo: You around?
[2014-01-21 23:54:18 -0500] lrr: Cope: thanks for the suggestion. got it working by using init and the init service
[2014-01-21 23:54:21 -0500] lrr: as the*
[2014-01-21 23:58:10 -0500] kevinburke: hello
[2014-01-21 23:59:05 -0500] kevinburke: I was curious if anyone knew the timeline for a chef 11.10 release?
