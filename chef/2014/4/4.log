[2014-04-04 00:00:04 -0400] gchristensen: bluepojo: you could just do Process.exit(0)
[2014-04-04 00:01:39 -0400] coderanger: gchristensen: Not in forking mode
[2014-04-04 00:01:41 -0400] bluepojo: gchristensen: that's precisely what Chef::Application#exit! calls
[2014-04-04 00:01:53 -0400] bluepojo: but because it's forked, the parent catches that and reports "exit" as an error
[2014-04-04 00:01:58 -0400] gchristensen: oh awesome
[2014-04-04 00:02:00 -0400] gchristensen: hah
[2014-04-04 00:02:13 -0400] bluepojo: was a good thought tho, that was what I was trying
[2014-04-04 00:02:19 -0400] coderanger: :-)
[2014-04-04 00:02:32 -0400] bluepojo: I believe it
[2014-04-04 00:02:44 -0400] kbarry: do I need to do something special to make a template file upload?
[2014-04-04 00:03:00 -0400] gchristensen: bluepojo: `for i in \`pgrep chef\`; do kill -9 $i`
[2014-04-04 00:03:05 -0400] coderanger: kbarry: No, they are uploaded as part of the knife cooobook upload process
[2014-04-04 00:03:26 -0400] kbarry: i'm having trouble.
[2014-04-04 00:03:39 -0400] kbarry: have a directory
[2014-04-04 00:03:44 -0400] coderanger: gchristensen: Hopefully your service layer raises hell if chef actually dies :)
[2014-04-04 00:03:49 -0400] gchristensen: haha, yeah ...
[2014-04-04 00:04:23 -0400] coderanger: gchristensen: devoops
[2014-04-04 00:04:33 -0400] gchristensen: devohfuckitallps
[2014-04-04 00:04:35 -0400] bluepojo: out of amusement I tried that...
[2014-04-04 00:04:45 -0400] bluepojo: "Chef never successfully completed!"
[2014-04-04 00:05:03 -0400] bluepojo: according to Vagrant
[2014-04-04 00:05:04 -0400] bluepojo: :P
[2014-04-04 00:05:06 -0400] coderanger: gchristensen: Also protip, pgrep comes with a companion tool called pkill
[2014-04-04 00:05:11 -0400] bluepojo: log output just stops
[2014-04-04 00:05:11 -0400] gchristensen: oooh nice
[2014-04-04 00:05:16 -0400] notromda: I don't trust my shef scripts to leave the client running all the time
[2014-04-04 00:05:29 -0400] notromda: er, chef
[2014-04-04 00:05:30 -0400] coderanger: bluepojo: That would be your service layer raising hell in this case :D
[2014-04-04 00:07:27 -0400] bluepojo: coderanger: lol yes
[2014-04-04 00:48:26 -0400] bluepojo: coderanger: This seems to have done the trick: https://gist.github.com/bluepojo/9965881
[2014-04-04 00:52:10 -0400] coderanger: bluepojo: \m/ thats what I had thought would do it :)
[2014-04-04 00:52:29 -0400] bluepojo: ty for the input
[2014-04-04 00:52:34 -0400] coderanger: bluepojo: If you want to make it fancier you could check the run list or something
[2014-04-04 00:52:44 -0400] coderanger: bluepojo: super if node.run_list.include?....
[2014-04-04 00:53:17 -0400] bluepojo: is there any chance this library will get loaded if the cookbook that contains it is not on the run list?
[2014-04-04 00:53:28 -0400] bluepojo: unless someone does something nefarious like depend on it
[2014-04-04 00:56:42 -0400] coderanger: Yeah, deps would be my worry
[2014-04-04 02:52:24 -0400] Majost: does this not work in an attributes file: "include Opscode::OpenSSL::Password"
[2014-04-04 03:08:00 -0400] raj19: Hi..how can I use the execute resource inside a ruby_block
[2014-04-04 03:12:30 -0400] Majost: raj19: you *might* be able to call it by doing something like ::Chef::Resource::RubyBlock
[2014-04-04 03:12:38 -0400] Majost: er sorry
[2014-04-04 03:12:51 -0400] Majost: ::Chef::Resource::Execute
[2014-04-04 03:13:11 -0400] Majost: but I can't promise that will work
[2014-04-04 05:08:09 -0400] Schlag: anyone how to specify the mysql version 5.1 with the mysql or database recipe?
[2014-04-04 05:08:32 -0400] Schlag: there some trick i'm missing?
[2014-04-04 05:59:06 -0400] Majost: Is there a bug in chef-client 11.10.4 with resolving cookbooks
[2014-04-04 05:59:20 -0400] Majost: I think there is a dependency problem, and it is just hanging eternally
[2014-04-04 06:05:31 -0400] coderanger: Majost: It isn't in chef-client, the bug is in chef-server
[2014-04-04 06:05:33 -0400] coderanger: but yes
[2014-04-04 06:05:52 -0400] coderanger: the server CPU goes ballistic in most cases when the constraint set can't be solved
[2014-04-04 06:06:17 -0400] Majost: ahh
[2014-04-04 06:06:38 -0400] Majost: yeah, thats what I am seeing
[2014-04-04 06:07:09 -0400] Majost: coderanger: is it fixed in the latest version of server?
[2014-04-04 06:07:15 -0400] coderanger: Majost: No
[2014-04-04 06:07:17 -0400] Majost: damn
[2014-04-04 06:07:20 -0400] coderanger: It will be at some point in the future
[2014-04-04 06:07:27 -0400] coderanger: but Opscode has not provided a timeline
[2014-04-04 06:07:40 -0400] coderanger: They do often release things at conferences though, and chefconf is in two weeks
[2014-04-04 06:07:42 -0400] coderanger: so maybe?
[2014-04-04 06:07:45 -0400] Majost: heh
[2014-04-04 06:07:51 -0400] Majost: see you there btw
[2014-04-04 06:07:56 -0400] coderanger: :-)
[2014-04-04 06:08:04 -0400] coderanger: Assuming I'm still lucid then
[2014-04-04 06:08:06 -0400] Majost: I owe you a beer
[2014-04-04 06:08:34 -0400] Majost: have you any recommendations when in this resolution pickle?
[2014-04-04 06:08:50 -0400] Majost: I uploaded all the dependencies via berkshelf, so I would think it would be okay
[2014-04-04 06:08:59 -0400] Majost: but maybe a cookbook is corrupt or something
[2014-04-04 06:09:19 -0400] coderanger: So grab https://gist.github.com/coderanger/9198932
[2014-04-04 06:09:32 -0400] coderanger: That command lets you try running depsolver with any cookbooks you want
[2014-04-04 06:09:46 -0400] coderanger: try out different sets until you find the minimal set that repros the failure
[2014-04-04 06:09:55 -0400] coderanger: usually by that point it will be somewhat obvious what the failure is
[2014-04-04 06:13:01 -0400] coderanger: It is currently an unfortunately manual process
[2014-04-04 06:13:21 -0400] coderanger: and I've not wanted to fully automate since this tool should be not useful once the bug is fixed in 11.1
[2014-04-04 06:13:42 -0400] _Ariel_: hi
[2014-04-04 06:13:52 -0400] _Ariel_: im using vagrant along with chef
[2014-04-04 06:14:02 -0400] _Ariel_: and vagrant-digitalocean plugin to deploy in their servers
[2014-04-04 06:14:10 -0400] _Ariel_: but when i run vagrant up it gets stuck on Assigned IP address: 
[2014-04-04 06:14:16 -0400] _Ariel_: any ideas why that could be?
[2014-04-04 06:14:29 -0400] Majost: coderanger: am I doing this wrong? https://gist.github.com/rhass-r7/9969094
[2014-04-04 06:14:37 -0400] coderanger: _Ariel_: Probably something the DO plugin, which is likely not super well used
[2014-04-04 06:14:56 -0400] coderanger: Majost: Needs quotes around it
[2014-04-04 06:15:10 -0400] _Ariel_: Majost i see, what do you mean not super well used"
[2014-04-04 06:15:25 -0400] _Ariel_: ?
[2014-04-04 06:16:05 -0400] coderanger: _Ariel_: Most people use vagrant with virtualbox, a few with EC2
[2014-04-04 06:16:12 -0400] Majost: coderanger: what is "it" in this context (no pun intended with quotes there)
[2014-04-04 06:16:14 -0400] coderanger: Anything beyond that and you are in the long tail
[2014-04-04 06:16:32 -0400] coderanger: Majost: "run_list" => ["sonarqube"])
[2014-04-04 06:16:48 -0400] Majost: ah
[2014-04-04 06:17:04 -0400] _Ariel_: sorry Majost i mentioned the wrong person :)
[2014-04-04 06:17:07 -0400] _Ariel_: too late here
[2014-04-04 06:17:12 -0400] _Ariel_: coderanger gotcha
[2014-04-04 06:21:24 -0400] double_p: i need a docs pointer, how to use non default/ dirs below files/ and templates/ - confuses the hell out of my by plain trying :}
[2014-04-04 06:24:23 -0400] m4rcu5: i have an report_handler, which i would like to run through the chef-client.rb. I created a recipe to copy the handler.rb to /var/chef/handlers, but how to update the client.rb file with the chef-client cookbook to actually require and run it? If i use load_gems it also trys to install it by rubygems
[2014-04-04 06:33:17 -0400] coderanger: double_p: Just don't
[2014-04-04 06:39:45 -0400] double_p: why not?
[2014-04-04 06:41:13 -0400] coderanger: double_p: Its a misfeature of Chef and should be removed
[2014-04-04 06:41:28 -0400] coderanger: double_p: I've got a patch to do so that just needs to be updated
[2014-04-04 06:48:11 -0400] Majost: coderanger: thanks, I think your script helped. =)
[2014-04-04 06:49:20 -0400] Schlag: i must be smoking crack, but i can't get amazon ec2 to install mysql 5.1 with the mysql and database recipe
[2014-04-04 06:49:30 -0400] Schlag: (with a chef recipe)
[2014-04-04 06:49:39 -0400] coderanger: Schlag: Thats rather old, not too surprising
[2014-04-04 06:49:48 -0400] coderanger: Schlag: Just write your own
[2014-04-04 06:51:00 -0400] double_p: coderanger: i see.. just it's a bit painful to have a lot of if/else in the .erb files. mhmm.
[2014-04-04 06:51:29 -0400] coderanger: double_p: Just have separate files then
[2014-04-04 06:51:47 -0400] coderanger: double_p: source "whatever_#{node['something']}.erb"
[2014-04-04 06:52:23 -0400] double_p: oh, right. cheers
[2014-04-04 06:52:40 -0400] coderanger: double_p: Thats why the feature isn't generally super needed
[2014-04-04 06:52:52 -0400] coderanger: double_p: Unless you want some kind of complex fallback system, its fine
[2014-04-04 08:26:29 -0400] ocholetras: hi guys
[2014-04-04 08:27:21 -0400] ocholetras: im getting the annoying error on chef server web interface: ERROR: incompatible character encodings: UTF-8 and ASCII-8BIT
[2014-04-04 08:27:25 -0400] ocholetras: When browsing a cookbook
[2014-04-04 08:28:06 -0400] ocholetras: Im spanish people most of the team and using comments on spanish, so we do use non-ascii characters like   or   etc..
[2014-04-04 08:28:23 -0400] ocholetras: i have tried to put #coding: utf-8 heading on the file
[2014-04-04 08:28:59 -0400] ocholetras: The file is attributes/default.rb, as it is a ruby file, that header should do their work, right?
[2014-04-04 08:29:10 -0400] ocholetras: its not working  :s
[2014-04-04 08:34:10 -0400] double_p: will there be livestreaming/recordings of the chefconf?
[2014-04-04 08:52:10 -0400] m4rcu5: +1 double_p
[2014-04-04 08:52:50 -0400] ocholetras: +1 double_p
[2014-04-04 09:28:59 -0400] enbergj: my recipe is doing a change that requires a reboot to activate .. how could I trigger a reboot at the end of the chef run, when that resource is created/changes?
[2014-04-04 09:59:02 -0400] JensOfSweden: either you find or write a provider for it, or make a bash script with action :nothing and in your block where the thing changes it does a notifies :bash delayed
[2014-04-04 13:27:48 -0400] phutchins: anyone know how to have chef-client execute something every x seconds during its run?
[2014-04-04 13:28:10 -0400] phutchins: goal is to have a notification pop up in osx every minute or so while chef is running
[2014-04-04 13:31:50 -0400] aeiou: are there any community recipes for httpd24 and php54 or php55?
[2014-04-04 13:33:50 -0400] CPS: phutchins: maybe try a ruby block?
[2014-04-04 13:34:14 -0400] srenatus: aeiou: most cookbooks let you specify/override the version
[2014-04-04 13:36:50 -0400] aeiou: srenatus: ah right, will check the httpd package then
[2014-04-04 13:59:08 -0400] aeiou: exit
[2014-04-04 14:01:09 -0400] aeiou: Is anyone using httpd2.4 in conjunction with Chef? (Ideally with AWS OpsWorks)
[2014-04-04 14:01:26 -0400] aeiou: I cannot find any information or anyone talking about it online - which seems insane!
[2014-04-04 14:35:55 -0400] a13x212: anyone downside to using chef tags?
[2014-04-04 14:40:02 -0400] gondoi: anyone here have experience with the chef-mondodb cookbook from edelight?
[2014-04-04 15:00:02 -0400] gondoi: i'm seeing this error message: The string `service[]' is not valid for resource collection lookup. Correct syntax is `resource_type[resource_name]'
[2014-04-04 15:00:10 -0400] gondoi: from this line: https://github.com/edelight/chef-mongodb/blob/master/definitions/mongodb.rb#L135
[2014-04-04 15:00:22 -0400] gondoi: looks okay to me, so I don't know why chef isn't liking it
[2014-04-04 15:16:55 -0400] juliancdunn: gondoi: what is the name of your resource?
[2014-04-04 15:24:25 -0400] gondoi: juliancdunn: mongodb
[2014-04-04 15:24:35 -0400] gondoi: i'm just running a test kitchen so it's taking the defaults
[2014-04-04 15:29:11 -0400] dappleman: hi there
[2014-04-04 15:29:26 -0400] dappleman: anyone around that can help me figure out a bug I'm getting with the database cookbook?
[2014-04-04 15:29:49 -0400] dappleman: something about a missing required mysql_api file?
[2014-04-04 15:32:55 -0400] dappleman: anyone?
[2014-04-04 15:33:03 -0400] dappleman: here's the pastebin of the error from the chef run
[2014-04-04 15:33:04 -0400] dappleman: http://pastebin.com/H2An0NqW
[2014-04-04 15:37:04 -0400] gondoi: juliancdunn, agrajag : looks like it's a bug somewhere in my merge conflict resolution.. i stashed my changes and test run fine... i'll start debugging that
[2014-04-04 15:37:08 -0400] gondoi: thanks for the help
[2014-04-04 15:39:18 -0400] cocotton: I'm using chef on nodes that are located in two datacenters A, B. Our chef server is in datacenter A. From time to time, I receive report tellement me chef failed a run with the error "EOFError: end of file reached". My first bet would be a network problem or lag, from time to time. As anyone ever experienced such a thing?
[2014-04-04 15:39:40 -0400] cocotton: The nodes that fail the run are all located in datacenter B.
[2014-04-04 15:40:21 -0400] double_p: cocotton: might be an expire of the access key, too
[2014-04-04 15:40:37 -0400] double_p: i've that on very long (>30min afair) converges
[2014-04-04 15:40:41 -0400] cocotton: double_p: Thanks for the hint, I'll go read about that right now
[2014-04-04 15:41:05 -0400] cocotton: double_p: Oh very interesting. Have you managed to reproduce the error?
[2014-04-04 15:41:06 -0400] double_p: cocotton: you would see a 403 in the http-server in 'A'
[2014-04-04 15:41:09 -0400] double_p: yes
[2014-04-04 15:41:51 -0400] cocotton: double_p: May I ask how? :)
[2014-04-04 15:42:25 -0400] double_p: just long running converges, e.g. a heavy populated run_list while bootstrapping
[2014-04-04 15:42:55 -0400] cocotton: alright I'll try to have a machine with lots of stuff on it
[2014-04-04 15:43:12 -0400] double_p: but the EOF could come from network (firewall), too
[2014-04-04 15:43:43 -0400] cocotton: double_p: it would just block the connection/timeout it?
[2014-04-04 15:44:14 -0400] double_p: cocotton: yeah, e.g. state table full. new/additional http response: boom
[2014-04-04 15:44:59 -0400] cocotton: double_p: I'll investigate all of that right away :)
[2014-04-04 15:51:11 -0400] chris613: Is using file:// in a remote_file a Chef 11 thing or should it work in Chef 10?
[2014-04-04 15:53:30 -0400] cocotton: double_p: I'm trying to find it, but I'm not sure what log files contain the client access (the file in which I could find those 403)
[2014-04-04 15:54:54 -0400] alexbst: hello rayrod2030 :-)
[2014-04-04 15:57:54 -0400] GreatSUN: re
[2014-04-04 15:59:18 -0400] rayrod2030:  sup alex!
[2014-04-04 16:19:18 -0400] storme_away: question about not_if guards... can you specify multiple guards on a single resource (like, not_if { X }; not_if { Y }; )?
[2014-04-04 16:28:11 -0400] shawn_sher: storme_away; I'm pretty sure that it's just a block, so you can put what you want in there
[2014-04-04 16:30:31 -0400] allaire: Hey guys, in my Gemfile, why does when I have only `gem 'chef'` with no version specified, it installs 0.8.2 by default?? 0.8.2 is pretty damn old
[2014-04-04 16:30:33 -0400] allaire: 0.8.10* sorry
[2014-04-04 16:37:45 -0400] a13x212: can anyone help with cookbook  users, looks like i broke it
[2014-04-04 16:41:29 -0400] Nukepuppy: allaire you might have a gem lock somewhere
[2014-04-04 16:41:41 -0400] stormerider: shawn_sher: thinking about it, i decided what i really needed to do was to break apart the recipes a bit more, cleaner process wise... but thanks.
[2014-04-04 16:42:23 -0400] shawn_sher: stormerider: Make a library and just call into it in your not_if block
[2014-04-04 16:42:48 -0400] shawn_sher: not_if {helper_function(foo)}
[2014-04-04 16:43:39 -0400] stormerider: shawn_sher: well the reason why i was asking is that i had a recipe configuring jira, confluence, bamboo, fisheye, and crucible... now i'm spinning up a dev instance, but it's not going to use fisheye/crucible, so... moving that to a separate recipe just makes more sense
[2014-04-04 16:44:06 -0400] shawn_sher: Yeah, I think you're right about that
[2014-04-04 16:46:01 -0400] shawn_sher: When things get complicated, I like pulling things out into a library where I can write pure ruby and just call into it from recipes
[2014-04-04 16:47:14 -0400] stormerider: *nod*
[2014-04-04 16:47:48 -0400] stormerider: i'm not exceptionally ruby savvy so i havent done that yet, but it's in my back pocket for whenever it makes the most sense
[2014-04-04 16:48:58 -0400] stormerider: ive done a lot more with perl/php/python than ruby, so still getting a bit up to speed with some of the quirks. but chef is heavily DSL'd so it's not really an issue (but not as heavily as Puppet where using ruby is a PITA)
[2014-04-04 16:49:36 -0400] Nukepuppy: i think puppets just about in same boat if you want more advanced things you need to write pure ruby classes etc
[2014-04-04 16:49:49 -0400] Nukepuppy: custom facts blah blah all a pita
[2014-04-04 16:50:16 -0400] stormerider: yeah. chef is much... easier? cleaner? to integrate with ruby
[2014-04-04 16:50:23 -0400] shawn_sher: Libraries are pretty convenient in Chef I think. I have not done Puppet
[2014-04-04 16:51:54 -0400] shawn_sher: There's no real reason for them to try to make their own language. Letting you write in a real language easily when you need to, it a good way to go I think
[2014-04-04 16:53:23 -0400] Nukepuppy: i think there's a place for the abstraction though.. and it obviously is why chef/puppet is getting adopted more ;)
[2014-04-04 16:53:39 -0400] Nukepuppy: things like chef_sugar etc are just more abstraction. which in end is helpful
[2014-04-04 16:53:51 -0400] Nukepuppy: i mean theres great reason we dont write everything in C / asm etc
[2014-04-04 16:54:20 -0400] shawn_sher: Yeah, you have the training wheels for basic stuff. Then as you learn that you're just looking at ruby, you can do what you want.
[2014-04-04 16:54:45 -0400] shawn_sher: At least for Chef. I think Puppet really does have their own weird language
[2014-04-04 16:55:10 -0400] dAnjou: hi, how difficult is it to self-host a "community cookbook site"?
[2014-04-04 16:56:40 -0400] Nukepuppy: dAnjou  for what reason?
[2014-04-04 16:57:03 -0400] Nukepuppy: the reason will drive how difficult it is :)
[2014-04-04 16:57:10 -0400] kerouac: [C/win 33
[2014-04-04 17:00:19 -0400] dAnjou: Nukepuppy: to put forked 3rd party cookbooks there
[2014-04-04 17:00:28 -0400] phutchins: and then if say, chef fails, to
[2014-04-04 17:00:38 -0400] phutchins: notify the user that that happened...
[2014-04-04 17:00:40 -0400] dAnjou: to what?
[2014-04-04 17:00:51 -0400] Nukepuppy: danjou just write wrapper cookbooks
[2014-04-04 17:00:57 -0400] Nukepuppy: dont fork the community cookbooks
[2014-04-04 17:01:06 -0400] phutchins: extremely separated qustion. here's the first part. :)
[2014-04-04 17:01:08 -0400] Nukepuppy: or you will soon be in a nightmare
[2014-04-04 17:01:08 -0400] phutchins: anyone know how to have chef-client execute something every x seconds during its run?
[2014-04-04 17:01:11 -0400] phutchins: goal is to have a notification pop up in osx every minute or so while chef is running
[2014-04-04 17:01:37 -0400] dAnjou: Nukepuppy: wrapper cookbooks? this is a "we can not trust 3rd party code" issue
[2014-04-04 17:01:49 -0400] Nukepuppy: but if you fork them you already are trusting it
[2014-04-04 17:01:55 -0400] Nukepuppy: but if you fork you're not getting any fixes
[2014-04-04 17:02:02 -0400] dAnjou: o.O
[2014-04-04 17:02:27 -0400] dAnjou: we read the code of course before we use them and we merge in changes from upstream after reviewing them
[2014-04-04 17:02:30 -0400] Nukepuppy: just write your wrapper cookbook to use nginx community cookbook..  if you MUST lock it down to a specific version that you know works (use berkshelf or chef-librarian etc)
[2014-04-04 17:02:42 -0400] Nukepuppy: Dajnjou that is a HUGE mistake..
[2014-04-04 17:02:46 -0400] Nukepuppy: you will be in a world of trouble fast
[2014-04-04 17:02:58 -0400] Nukepuppy: because for example one cookbook may depend on 10 others
[2014-04-04 17:03:14 -0400] dAnjou: i'm very well aware of that
[2014-04-04 17:03:15 -0400] Nukepuppy: i doubt you have the staff to be able to maintain all that considering all those cookbooks may have hundreds of maintainers
[2014-04-04 17:03:22 -0400] shawn_sher: You don't always have a choice. In my case, the postgresql cookbook sets the uid explicitly to 26, and I can't do that in my environment
[2014-04-04 17:03:45 -0400] stormerider: chef-rewind?
[2014-04-04 17:03:48 -0400] Nukepuppy: shawn_sher that's an easy fix though
[2014-04-04 17:03:50 -0400] shawn_sher: Since it's hardcoded, I had to parameterize it
[2014-04-04 17:04:07 -0400] Nukepuppy: well yeah thats easy fix -.-
[2014-04-04 17:04:15 -0400] shawn_sher: Yeah, I would have rather avoided it
[2014-04-04 17:04:15 -0400] stormerider: shawn_sher: sounds like a fix with submitting back up :)
[2014-04-04 17:04:24 -0400] stormerider: s/with/worth/
[2014-04-04 17:04:26 -0400] shawn_sher: We're not allowed to submit things back
[2014-04-04 17:04:28 -0400] stormerider: damn fingers
[2014-04-04 17:04:29 -0400] stormerider: ah
[2014-04-04 17:04:32 -0400] Nukepuppy: thats what i would say.. fix it.. make it something you can configure
[2014-04-04 17:04:34 -0400] shawn_sher: unfortunately
[2014-04-04 17:04:36 -0400] Nukepuppy: and get it merged
[2014-04-04 17:04:36 -0400] dAnjou: Nukepuppy: i know you're trying to give me a good solution. i do that too with my support cases. but right now, i'd rather have an answer to my original question ;)
[2014-04-04 17:04:44 -0400] Nukepuppy: no
[2014-04-04 17:04:46 -0400] Nukepuppy: is the answer ;p
[2014-04-04 17:05:18 -0400] dAnjou: Nukepuppy: what is the config parameter "site" for then?
[2014-04-04 17:05:28 -0400] stormerider: shawn_sher: what i do for some things like that is do the work on a weekend, on my own time, which work doesnt care about because it's not related to the core business of the company
[2014-04-04 17:06:17 -0400] stormerider: but i understand that others arent necessarily so flexible
[2014-04-04 17:06:23 -0400] Nukepuppy: stormerider i mean its just public code
[2014-04-04 17:06:42 -0400] Nukepuppy: the license allows any feasible change that makes sense to get merged in
[2014-04-04 17:06:49 -0400] Nukepuppy: all your asking for is an attribute to configure the UID
[2014-04-04 17:06:51 -0400] Nukepuppy: sounds good enough
[2014-04-04 17:06:55 -0400] shawn_sher: I'm just contracting, so I really don't want to step on any toes
[2014-04-04 17:07:09 -0400] stormerider: Nukepuppy: some companies own all your work while you're employed, period
[2014-04-04 17:07:24 -0400] Nukepuppy: depends on your contract ;p
[2014-04-04 17:07:39 -0400] stormerider: right. that was my comment about some aren't so flexible
[2014-04-04 17:07:51 -0400] dAnjou: Nukepuppy: sorry for this question but what qualifies you to say "no"?
[2014-04-04 17:07:59 -0400] dAnjou: or "not possible"
[2014-04-04 17:08:17 -0400] shawn_sher: Nothing, it's open source
[2014-04-04 17:08:38 -0400] Nukepuppy: dAnjou it sounds like you want someone to say its ok to do the wrong thing :P  but i wont be that guy so.. maybe someone else can chime in for you
[2014-04-04 17:08:41 -0400] shawn_sher: Just a better idea to wrap or do whatever you can to avoid forking and maintaining it yourself
[2014-04-04 17:08:55 -0400] stormerider: dAnjou: i might be wrong, but istr that there was some talk about the new community site being open sourced
[2014-04-04 17:09:36 -0400] stormerider: Nukepuppy: not all companies are created equally and you're coming across as One True Way-ish
[2014-04-04 17:09:37 -0400] dAnjou: Nukepuppy: it's not about right and wrong. it's about being in control.
[2014-04-04 17:10:23 -0400] Nukepuppy: stormerider i dont think so.. there is a clear wrong way ;p
[2014-04-04 17:10:42 -0400] shawn_sher: Use your judgement. Anyone who uses npm for anything knows how awry things can go if you trust upstream too much
[2014-04-04 17:10:42 -0400] Nukepuppy: theres a lot of right ways but i think there is always a clear wrong way
[2014-04-04 17:11:46 -0400] dAnjou: see, i trust the official debian repos, i trust basically all official linux distro repos. but i don't trust node's or python's or ruby's repos.
[2014-04-04 17:12:11 -0400] dAnjou: and i certainly don't trust opscode's community site then either
[2014-04-04 17:12:13 -0400] stormerider: dAnjou: in any case, if you're using Berkshelf, you can use a chef server to store artifacts equivalently to the concept of the community site
[2014-04-04 17:12:48 -0400] dAnjou: we're using berkshelf
[2014-04-04 17:13:49 -0400] stormerider: dAnjou: berkshelf.com, take a look at the "Chef API Location" section
[2014-04-04 17:15:12 -0400] dAnjou: i've to admin, i'm kinda new to all this. i'm learning it to increase the bus factor in our company.
[2014-04-04 17:15:40 -0400] dAnjou: i looked at this page, maybe stuff went over my head
[2014-04-04 17:15:50 -0400] dAnjou: s/admin/admit/
[2014-04-04 17:18:17 -0400] stormerider: i havent done it myself, but i know there's been talk on the mailing list... people will use like jenkins to validate/test/etc the code, then push it up to a chef server that serves essentially just for artifacts, and then you use that in berkshelf for your real chef server. this is handy if you have multiple orgs or chef servers or such
[2014-04-04 17:18:18 -0400] dAnjou: so, can i define this chef api location so that berkshelf looks for cookbooks and dependencies ONLY there?
[2014-04-04 17:19:06 -0400] stormerider: if you dont have the "site :opscode" line, i believe it will only use what you define anyways
[2014-04-04 17:19:38 -0400] dAnjou: ah, that sounds good. thanks. we will try that.
[2014-04-04 17:20:02 -0400] stormerider: so if you only have OSC/one org/server, that might just be easier than standing up a server just for artifacts
[2014-04-04 17:21:02 -0400] stormerider: im on enterprise chef at this point, so i'm keeping track of those discussions to keep the ideas in my back pocket
[2014-04-04 17:21:42 -0400] Nukepuppy: cookbook "my_cookbook_forsomething", git: 'git@gitlab.something.com:cookbook_repos/my_cookbook_forsomething.git'
[2014-04-04 17:21:59 -0400] double_p: enterprise..
[2014-04-04 17:22:00 -0400] Nukepuppy: for when you add a dependency in your metadata  can tell it where to get it privately
[2014-04-04 17:23:35 -0400] workmad3: Nukepuppy: gets very annoying when you have a lot of private wrapper cookbooks and have to specify them in every Berksfile that they're used in
[2014-04-04 17:24:16 -0400] stormerider: workmad3: yeah, i wish they had regexes in Berksfile, heh
[2014-04-04 17:24:21 -0400] Nukepuppy: workmad yeah.. just that you can do it and not many ways around it ;P
[2014-04-04 17:24:35 -0400] Nukepuppy: but if its not often its not bad
[2014-04-04 17:24:40 -0400] stormerider: cookbook "RS-*", git: ... would be awesome, heh
[2014-04-04 17:24:51 -0400] workmad3: stormerider: I'm using the berkshelf 3 beta and berkshelf-api, so I can run that locally and have my own index of both community chef and my own chef server :)
[2014-04-04 17:25:05 -0400] stormerider: i havent played with 3 yet
[2014-04-04 17:25:32 -0400] stormerider: too many projects, too little time.
[2014-04-04 17:26:16 -0400] stormerider: i still need to actually get cookbook testing set up with vagabond some month...
[2014-04-04 17:26:18 -0400] workmad3: at some point, I'll set up a VM with my API running on it permanently
[2014-04-04 17:26:54 -0400] workmad3: not come across vagabond... I've done chefspec, and started to play with test-kitchen and leibniz
[2014-04-04 17:27:12 -0400] stormerider: vagabond is vagrant for LXC
[2014-04-04 17:27:17 -0400] stormerider: essentially
[2014-04-04 17:27:20 -0400] workmad3: ah
[2014-04-04 17:27:31 -0400] workmad3: isn't there a vagrant-lxc plugin for that?
[2014-04-04 17:28:27 -0400] stormerider: not sure. but vagabond is tied in to test-kitchen and works for doing things like spinning up multi-server dependencies and stuff like serverspec for failover testing and whatnot
[2014-04-04 17:29:03 -0400] stormerider: i heard about it at the chef summit and have been meaning to dig into it ever since, just... writing cookbooks has taking higher priority, heh
[2014-04-04 17:30:41 -0400] therealtimsmith: is there some magical trick to updating the public_key of the chef-validator so you can use your own key
[2014-04-04 17:30:46 -0400] therealtimsmith: doesn't seem that you can edit that client
[2014-04-04 17:30:59 -0400] Nukepuppy: are you re-bootstrapping a node? or something?
[2014-04-04 17:32:05 -0400] therealtimsmith: trying to use my previously validation.pem file with a new server
[2014-04-04 17:32:18 -0400] therealtimsmith: I replaced the private key on the server
[2014-04-04 17:32:33 -0400] therealtimsmith: but the public key on the validator client is still the previous key
[2014-04-04 17:35:13 -0400] phutchins: Anyone know why when compiling chef-server i'm getting MD5 doesn't match expected for the jre?
[2014-04-04 18:03:50 -0400] nefilim: hi, i'm wondering why the chef server REST API returns a hash of sorts and not a json array when requesting all resources, eg. GET /nodes or GET /clients ?
[2014-04-04 18:06:02 -0400] [ROOT]XxNeoLiTHi: hi all, im working on trying to establish a working process for cookbook management. I was thrown for a loop with the idea of not putting cookbooks in the chef-repo git dir (although I was already treating each cookbook as its own git repo), but I get the reasoning. What I dont get is what kind of automation exists for taking the cookbook requirements configured for each environment and ensuring that the chef server has a cop
[2014-04-04 18:06:08 -0400] coderanger: nefilim: Returning arrays from a JSON API as the top level object is unsafe and so generally avoided
[2014-04-04 18:06:39 -0400] coderanger: nefilim: The specific exploit doesn't apply to Chef itself, but it is still good practice to avoid
[2014-04-04 18:09:03 -0400] nefilim: coderanger: such as { "nodes": [ {"name": "uri" },  ] } ?
[2014-04-04 18:09:15 -0400] coderanger: No thats fine
[2014-04-04 18:09:25 -0400] coderanger: But doing [{}, {}, ] is unsafe
[2014-04-04 18:10:05 -0400] coderanger: So we use a hash/dict/object for the top-level
[2014-04-04 18:10:45 -0400] nefilim: coderanger: ah, bit challenging to parse usefully in jvm languages at first glance, not sure how this is done in ruby
[2014-04-04 18:11:07 -0400] coderanger: nefilim: Not sure what you mean, its JSON, I presume Java has a JSON parser
[2014-04-04 18:13:55 -0400] nefilim: coderanger:  into an AST of course, into an object representation not so much. for instance something like { "nodes": [ {"name": "uri" },  ] }  could easily be parsed into List[IdAndURI] or List[(String, String)] even
[2014-04-04 18:14:27 -0400] coderanger: nefilim: You know https://github.com/jclouds/jclouds-chef exists, right? :)
[2014-04-04 18:14:34 -0400] coderanger: If you want a high-level API client
[2014-04-04 18:14:48 -0400] nefilim: nope, havent seen it
[2014-04-04 18:14:51 -0400] nefilim: will take a look thanks
[2014-04-04 18:15:18 -0400] coderanger: https://jclouds.apache.org/guides/chef/ is the docs
[2014-04-04 18:15:29 -0400] nefilim: great, thank you
[2014-04-04 18:26:38 -0400] nfx_: hello, does anyone have any experience with using knife winrm to execute commands on Windows hosts? I'm looking to use knife winrm except I'd like to use passwordless authentication.
[2014-04-04 18:26:57 -0400] nfx_: the knife windows documentation only shows examples with password authentication
[2014-04-04 18:27:46 -0400] nfx_: server side on the windows host I created a WinRM listener for HTTP and HTTPS and created/associated a x.509 certificate for the HTTPS listener
[2014-04-04 18:31:27 -0400] allaire: Is there a way to overwrite an attribute in a wrapper cookbook without redefining all other attributes that use it? Like this one: https://github.com/opscode-cookbooks/nginx/blob/master/attributes/source.rb#L24
[2014-04-04 18:32:39 -0400] bricker`LA: If I want to upload a cookbook to hosted chef server, I need to first "knife cookbook site download <cookbook>", and then "knife cookbook upload <cookbook>"? Or is there a way to do it where I don't need to download it first?
[2014-04-04 18:32:54 -0400] allaire: bricker`LA: Check Berkshelf :)
[2014-04-04 18:33:12 -0400] allaire: It's the bomb
[2014-04-04 18:33:45 -0400] bricker`LA: allaire: How would I use it to install a cookbook directly to the server?
[2014-04-04 18:34:07 -0400] allaire: berks upload
[2014-04-04 18:34:09 -0400] allaire: http://berkshelf.com/
[2014-04-04 18:34:16 -0400] allaire: It's like Bundler for Ruby
[2014-04-04 18:34:47 -0400] bricker`LA: allaire: I know what it is, my question is if it can install a package to the server directly from the community cookbooks
[2014-04-04 18:35:35 -0400] bricker`LA: Instad of having to download it first
[2014-04-04 18:35:46 -0400] allaire: Why would you want to do that? Chef workstation are vital part of the Chef workflow
[2014-04-04 18:36:06 -0400] allaire: AFAIK I don't think it's possible, maybe @coderanger know more about it :)
[2014-04-04 18:37:43 -0400] mondo: If I have two roles that call the same recipe with different override_attributes, and I apply both roles to the same node, will one of the roles override the other?
[2014-04-04 18:38:14 -0400] mondo: I have done this and one of the roles seems to be ignored
[2014-04-04 18:40:29 -0400] bricker`LA: allaire: for example, the mysql cookbook - I just want to put it on the server so I can add it to any node's runlist.
[2014-04-04 18:41:45 -0400] gleam: but you don't have the spare megabyte to put it on your workstation in order to upload it to the server?
[2014-04-04 18:41:51 -0400] jidar: I wish I could get berkshelf 3 working
[2014-04-04 18:41:54 -0400] gleam: i don't understand the limitation..
[2014-04-04 18:45:50 -0400] bricker`LA: gleam: there is no limitation, it's just an extra step that seems unnecessary
[2014-04-04 18:51:18 -0400] bricker`LA: eg `knife cookbook site download mysql; tar -xzf mysql-5.0.2.tar.gz; knife cookbook upload mysql`, seems like the server could just pull from community.opscode.com directly
[2014-04-04 18:52:15 -0400] juliancdunn: bricker`LA: that's reasonable feedback, others have told me the same thing
[2014-04-04 18:53:13 -0400] Shubby: I'm trying to get Chef Client to run automatically at semi-regular intervals using the chef-client community cookbook but it doesn't seem to be working, unless I misunderstand how the cookbook is supposed to work :|
[2014-04-04 18:53:47 -0400] Shubby: I'm not using the cron recipe, just the default one which is supposed to set it up as a service, as far as I can tell that went through fine, and I set the interval attribute to 180 seconds instead of the default 1800
[2014-04-04 18:56:06 -0400] Shubby: I'm also not touching the splay attribute which adds a random number of seconds to my interval, up to 300 (by default)... so based on my understanding of how the cookbook works, I should see my node check in automatically at least every 8 minutes, but it's not checking in at all
[2014-04-04 18:56:35 -0400] Shubby: so I'm stuck :(
[2014-04-04 18:56:45 -0400] coderanger: bricker`LA: You need to download it somewhere first
[2014-04-04 18:56:57 -0400] coderanger: bricker`LA: The chef server never pulls cookbooks for security reasons
[2014-04-04 18:58:54 -0400] bricker`LA: coderanger: that is fair and something I hadn't considered, thanks for the explanation
[2014-04-04 18:59:25 -0400] bricker`LA: I assume the cookbooks on community.opscode.com are signed?
[2014-04-04 18:59:30 -0400] coderanger: bricker`LA: lolno
[2014-04-04 18:59:34 -0400] bricker`LA: d'oh
[2014-04-04 18:59:44 -0400] coderanger: Don't get me started on package signing
[2014-04-04 18:59:47 -0400] bricker`LA: :)
[2014-04-04 18:59:49 -0400] coderanger: its a terrible idea and does nothing
[2014-04-04 19:00:24 -0400] bricker`LA: coderanger: can you explain? both rubygems and npm had problems related to *not* signing their packages in recent history
[2014-04-04 19:00:25 -0400] coderanger: Berks does do TLS verification (if enabled) which is functionally the same
[2014-04-04 19:01:43 -0400] coderanger: bricker`LA: Heh, its a long rant, but the shortest I can make it is that package signing without a trust model gives no extra security
[2014-04-04 19:01:55 -0400] coderanger: If packages are signed by authors, how do you know who to trust
[2014-04-04 19:02:13 -0400] coderanger: and if they are signed on-line by the repo, then you are just trusting the repo anyway
[2014-04-04 19:02:42 -0400] coderanger: in the end the only assertion you can make is "these are the bits that The Server said they should be"
[2014-04-04 19:02:47 -0400] coderanger: and TLS gets you that already
[2014-04-04 19:03:36 -0400] bricker`LA: coderanger: that's true, you'll never be 100% safe, but I wouldn't say it's pointless
[2014-04-04 19:03:44 -0400] coderanger: No, you're just wrong, sorry :)
[2014-04-04 19:03:52 -0400] bricker`LA: okedoke
[2014-04-04 19:03:52 -0400] coderanger: People get all excited about "crypto" in things
[2014-04-04 19:03:57 -0400] coderanger: and here, its just misused
[2014-04-04 19:04:08 -0400] coderanger: at _best_ you can resist partial compromise of the package server
[2014-04-04 19:04:16 -0400] coderanger: which is a thing that doesn't generally happen
[2014-04-04 19:04:28 -0400] coderanger: if someone can overwrite package data, they can probably access the signing system
[2014-04-04 19:04:33 -0400] coderanger: qed no extra security
[2014-04-04 19:05:33 -0400] coderanger: and if you are doing author signing, if they can overwrite package data, they can probably overwrite author key records
[2014-04-04 19:06:40 -0400] coderanger: What you need is a trust model, and as long as that trust model is "I implicitly trust the thing called pypi.python.org (or community.opscde.com, or whatever)", WoT signatures aren't helping
[2014-04-04 19:08:46 -0400] coderanger: A full WoT/karma trust model is possible, just it is so cumbersome no one would ever use it, imagine if you couldn't use Chef (or at least couldn't publish cookbooks) until you go to a key signing party :)
[2014-04-04 19:10:24 -0400] coderanger: </rant>
[2014-04-04 19:11:03 -0400] notromda: I'm missing somthing.  postgres_database_user is not updating a password correctly.
[2014-04-04 19:11:36 -0400] gchristensen: coderanger: I'd sign your key if we met in person and we exchanged multiple forms of identity
[2014-04-04 19:12:18 -0400] coderanger: gchristensen: I'm enough of a nerd to have my key fingerprint on my business cards, super useful for key distribution :)
[2014-04-04 19:12:45 -0400] gchristensen: *nice*
[2014-04-04 19:12:50 -0400] gchristensen: if I had business cards, I would do,that.
[2014-04-04 19:17:20 -0400] notromda: ARg, looks like it only sets a password on create
[2014-04-04 19:18:20 -0400] Nukepuppy: the whole database cookbook is a bit hosed right now :(
[2014-04-04 19:18:34 -0400] Nukepuppy: its not doing what it did a week ago or so .. too many moving dependencies broke recently
[2014-04-04 19:19:07 -0400] notromda: Well, https://github.com/opscode-cookbooks/database/blob/38c6174c1a5291ec257157f74930758e491920a3/libraries/provider_database_postgresql_user.rb#L38
[2014-04-04 19:19:17 -0400] notromda: looks like the password is only set on create
[2014-04-04 19:19:37 -0400] notromda: Nothing in that file allows for a password to be updated
[2014-04-04 19:21:10 -0400] notromda: Where do I look for bug reports?
[2014-04-04 19:24:32 -0400] [ROOT]XxNeoLiTHi: is berkshelf vagrant plugin still active, i read an article somewhere that it was discontinued
[2014-04-04 19:25:53 -0400] neolithic: but its from a few months ago
[2014-04-04 19:28:37 -0400] nfx_: anyone have experience with knife winrm?
[2014-04-04 19:30:31 -0400] CPS: nfx_: i've looked at it a lot but not used it directly
[2014-04-04 19:32:36 -0400] nfx__: CPS: have you ever been able to execute a command on a remote windows host using knife winrm but in a passwordless fashion?
[2014-04-04 19:32:50 -0400] nfx__: using certificates or keypairs
[2014-04-04 19:33:10 -0400] CPS: no, we're using domain authentication
[2014-04-04 19:33:21 -0400] CPS: the certificate thing was judged to be too big a pita
[2014-04-04 19:33:54 -0400] nfx__: too big a pita? you mean too much of a pain in the ass?
[2014-04-04 19:34:00 -0400] CPS: yes
[2014-04-04 19:34:04 -0400] nfx__: cause if so i totally understand :P
[2014-04-04 19:34:07 -0400] nfx__: hah
[2014-04-04 19:34:08 -0400] nfx__: man
[2014-04-04 19:34:20 -0400] nfx__: winrm is pretty insanely complex for nothing
[2014-04-04 19:34:43 -0400] CPS: heaing it second hand but apparently you have to get a cert for every node and there's no way to pull them automatically
[2014-04-04 19:34:47 -0400] nfx__: so i'm starting to lean towards password auth like you did
[2014-04-04 19:35:26 -0400] nfx__: right, yeah, that would be insane to crazy to manage
[2014-04-04 19:35:34 -0400] nfx__: crazy to manage*
[2014-04-04 19:37:11 -0400] coderanger: neolithic: Yes, it was talked about discontinuing it, but those plans were put on hold
[2014-04-04 19:37:21 -0400] coderanger: neolithic: A beta for vagrant 1.5 was actually released yesterday
[2014-04-04 19:38:16 -0400] neolithic: ok ill have to take a look at that
[2014-04-04 19:39:05 -0400] neolithic: interesting to hear about the winrm, Ive put that off till last hoping to avoid the pain lol. Does vagrant and all the rest work ok with putting openssh/cygwin on Windows instead?
[2014-04-04 19:39:30 -0400] CPS: i wouldn't know
[2014-04-04 19:39:42 -0400] CPS: we're apparently doing some gpo magic to get winrm to work
[2014-04-04 19:42:05 -0400] notromda: Submitted bug report https://tickets.opscode.com/browse/COOK-4516 for postgresql update password
[2014-04-04 19:42:31 -0400] notromda: guess I'll have to add a bash script to make sure it stays synced
[2014-04-04 19:54:59 -0400] jidar: coderanger: is that 1.5.2?
[2014-04-04 20:26:20 -0400] Gue______: Committers: A coworker submitted https://github.com/opscode-cookbooks/rabbitmq/pull/111, wasn't sure if it fits under the obvious fix policy or if we need him to sign the CLA
[2014-04-04 20:26:49 -0400] Gue______: oh joy, my client isn't config'd. this is josephholsten
[2014-04-04 20:27:42 -0400] coderanger: Gue______: Code changes generally need a CLA
[2014-04-04 20:29:51 -0400] josephholsten: hurray
[2014-04-04 20:30:49 -0400] josephholsten: seriously, we need to google bomb "getchef cla"
[2014-04-04 20:35:57 -0400] allaire: coderanger: are you around?
[2014-04-04 20:36:01 -0400] coderanger: yo
[2014-04-04 20:36:21 -0400] allaire: How it's going
[2014-04-04 20:36:49 -0400] coderanger: In day ~6 of doing nothing but writing conference talks
[2014-04-04 20:37:07 -0400] allaire: @coderanger: I'm hitting could not find recipe nginx::http_gzip_static_module for cookbook nginx
[2014-04-04 20:37:14 -0400] allaire: @coderanger lol
[2014-04-04 20:37:15 -0400] allaire: ouch
[2014-04-04 20:37:49 -0400] allaire: So, I get this bug with the nginx cookbook when i try to add a modules
[2014-04-04 20:38:07 -0400] allaire: in a role, I try to do: "modules": ["nginx::http_gzip_static_module", "nginx::http_ssl_module", "nginx::passenger"]
[2014-04-04 20:38:17 -0400] allaire: for some reason, I need to remove the nginx:: prefix to make this work
[2014-04-04 20:38:21 -0400] allaire: and I'm wondering why
[2014-04-04 20:38:36 -0400] allaire: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L90-L92
[2014-04-04 20:39:08 -0400] allaire: coderanger: in the attributes file, the nginx:: prefile is on each module: https://github.com/opscode-cookbooks/nginx/blob/master/attributes/source.rb#L38-L41
[2014-04-04 20:39:12 -0400] coderanger: Hmm, that doesn't sound right
[2014-04-04 20:39:42 -0400] allaire: coderanger: https://gist.github.com/allaire/bf965012be8f48915a83
[2014-04-04 20:39:46 -0400] allaire: that's the error
[2014-04-04 20:40:15 -0400] coderanger: allaire: Can you pastebin the full stack trace?
[2014-04-04 20:40:57 -0400] allaire: coderanger: https://gist.github.com/allaire/bf965012be8f48915a83
[2014-04-04 20:40:58 -0400] allaire: edited
[2014-04-04 20:41:42 -0400] coderanger: It sounds like somehow the string is ending up as nginx::nginx::http_gzip_static_module
[2014-04-04 20:41:57 -0400] coderanger: Maybe knife role show?
[2014-04-04 20:42:07 -0400] coderanger: Make sure you didn't miss a comma somewhere
[2014-04-04 20:42:46 -0400] allaire: coderanger: https://gist.github.com/allaire/70e277cb0ec59ee85f33
[2014-04-04 20:43:46 -0400] coderanger: allaire: Hmm, try this. Remove nginx from the run list in that role so it will converge successfully, then knife node show <name> -Fj --long
[2014-04-04 20:43:53 -0400] coderanger: and check what the computed attribute is
[2014-04-04 20:45:47 -0400] allaire: coderanger: https://gist.github.com/allaire/9d3563ed6761be3edfd2
[2014-04-04 20:46:05 -0400] allaire: that was from my last successful run
[2014-04-04 20:47:04 -0400] coderanger: allaire: https://github.com/opscode-cookbooks/nginx/blob/1.0.0/recipes/source.rb#L74
[2014-04-04 20:47:11 -0400] coderanger: allaire: Check what version you are using
[2014-04-04 20:49:11 -0400] allaire: coderanger: good catch, checking.
[2014-04-04 20:50:04 -0400] coderanger: allaire: Looks like that changed between 1.8.0 and 2.0.0
[2014-04-04 20:50:58 -0400] allaire: nginx (2.5.0)
[2014-04-04 20:51:02 -0400] allaire: @coderanger I dont get it
[2014-04-04 20:51:21 -0400] coderanger: allaire: Where are you seeing that?
[2014-04-04 20:51:33 -0400] allaire: in my Berks lockfile, anyway I can check it on the node?
[2014-04-04 20:52:47 -0400] a13x212: anyone running knife spork on ruby 2.0?
[2014-04-04 20:52:53 -0400] coderanger: allaire: cat /var/chef/cache/cookbooks/nginx/metadata.rb
[2014-04-04 20:55:53 -0400] chefjunior: Can anyone help this ERROR: package[ntp] (ntp::default line 22) had an error: NoMethodError: undefined method `version' for nil:NilClass
[2014-04-04 20:56:05 -0400] chefjunior: I just try to install a package
[2014-04-04 20:56:08 -0400] allaire: coderanger meh ok, 1.8.0
[2014-04-04 20:56:13 -0400] chefjunior:  chef-client Starting Chef Client, version 11.10.4 resolving cookbooks for run list: ["ntp"] Synchronizing Cookbooks:   - ntp Compiling Cookbooks... Converging 3 resources Recipe: ntp::default   * package[ntp] action install ================================================================================ Error executing action `install` on resource 'package[ntp]' ======================================================================
[2014-04-04 20:56:54 -0400] allaire: coderanger: How come it was not updated?
[2014-04-04 20:57:05 -0400] allaire: its on my staging server and I didnt pinned any version
[2014-04-04 20:57:10 -0400] coderanger: allaire: Some kind of dependency constraint
[2014-04-04 20:57:26 -0400] coderanger: allaire: https://gist.github.com/coderanger/9198932
[2014-04-04 21:00:20 -0400] allaire: @coderanger knife exec -E 'puts api.post("/environments/staging/cookbook_versions", "run_list" => ['nginx']).map{|key, val| "#{key} #{val.version}"}'
[2014-04-04 21:00:24 -0400] allaire: what am I doing wrong here?
[2014-04-04 21:00:47 -0400] coderanger: allaire: You need to use the full cookbook list, something might be applying a constraint that limits things
[2014-04-04 21:02:58 -0400] allaire: cant get it to work
[2014-04-04 21:03:58 -0400] coderanger: allaire: hmm?
[2014-04-04 21:04:16 -0400] coderanger: allaire: At the top of your chef-client run it should print the expanded run list
[2014-04-04 21:04:36 -0400] coderanger: put that in knife exec snippet and it should show you the version solution
[2014-04-04 21:05:10 -0400] allaire: Synchronizing Cookbooks ?
[2014-04-04 21:05:48 -0400] coderanger: allaire: Yeah, around there you should see the full expansion
[2014-04-04 21:06:06 -0400] esmet_: has any had success using ridley / ridley-connectors to manage chef nodes?
[2014-04-04 21:06:55 -0400] coderanger: esmet_: In terms of what?
[2014-04-04 21:07:25 -0400] coderanger: Ridley isn't used much outside of berkshelf itself since its often more complex than needed given that sync-mode API clients exist
[2014-04-04 21:08:29 -0400] esmet_: i'm trying to use ridley-connectors to bootstrap a fresh amazon instance
[2014-04-04 21:08:41 -0400] allaire: coderanger: https://gist.github.com/allaire/6cdaa6c7762e88bd395d
[2014-04-04 21:08:45 -0400] allaire: am I using it wrong?
[2014-04-04 21:08:58 -0400] allaire: Exception: NameError: undefined local variable or method `myapp' for #<Object:0x007ffe55457990>
[2014-04-04 21:09:06 -0400] esmet_: i can't get the ssh connection to go through. inspecting code, i can't see where it is picking up my ssh key and using it for auth. so i'm a bit lost.
[2014-04-04 21:09:41 -0400] coderanger: allaire: You have nested single quotes throwing stuff off
[2014-04-04 21:10:00 -0400] allaire: duh
[2014-04-04 21:10:03 -0400] allaire: friday...
[2014-04-04 21:10:45 -0400] coderanger: allaire: Fixed version in a comment
[2014-04-04 21:11:10 -0400] allaire: coderanger: confirmed, nginx 1.8.0
[2014-04-04 21:11:28 -0400] coderanger: allaire: So now slowly remove things in that list until you see whats causing the constraint
[2014-04-04 21:11:30 -0400] coderanger: :)
[2014-04-04 21:11:49 -0400] coderanger: allaire: dependencies on yum and build-essentials are common causes
[2014-04-04 21:14:55 -0400] allaire: coderanger: this is hell
[2014-04-04 21:16:21 -0400] coderanger: allaire: :-(
[2014-04-04 21:16:28 -0400] coderanger: allaire: dependency solvers rule everything around me
[2014-04-04 21:16:48 -0400] allaire: coderanger: When I try to run with the same stack on vagrant, it installs the latest version
[2014-04-04 21:16:49 -0400] coderanger: allaire: Are you using berks 2 or 3 btw?
[2014-04-04 21:16:53 -0400] allaire: 3
[2014-04-04 21:17:04 -0400] coderanger: hmm, is there a constraint on something in your chef env?
[2014-04-04 21:18:02 -0400] allaire: coderanger: no, that's the strange thing
[2014-04-04 21:18:25 -0400] coderanger: allaire: Are you using chef-client in vagrant or chef-solo + vagrant-berks?
[2014-04-04 21:18:38 -0400] allaire: chef-solo + vagrant-berks
[2014-04-04 21:18:42 -0400] coderanger: Ahh, so yeah
[2014-04-04 21:18:53 -0400] allaire: :/
[2014-04-04 21:19:02 -0400] coderanger: You might have just found a case where depsolver and solve find different (but both valid) solutions
[2014-04-04 21:19:22 -0400] coderanger: kallistec and sethvargo have been working to unify them both on the old gecode solver
[2014-04-04 21:19:50 -0400] allaire: @coderanger: can I try to force latest version in my env?
[2014-04-04 21:19:52 -0400] allaire: and see?
[2014-04-04 21:19:55 -0400] allaire: of nginx
[2014-04-04 21:19:58 -0400] coderanger: Yep, was just about to suggest that
[2014-04-04 21:20:02 -0400] coderanger: either in the env or in a wrapper cookbook
[2014-04-04 21:20:04 -0400] allaire: giving this a go
[2014-04-04 21:23:05 -0400] allaire: @coderanger: YAY!
[2014-04-04 21:23:07 -0400] allaire: we did it :)
[2014-04-04 21:23:29 -0400] allaire: whoa, that was an deep unexpected behaviour
[2014-04-04 21:23:30 -0400] papasierra: someara: ping? i'm using the mysql cookbook to provision precise64 with mysql server. i've set node['mysql']['bind_address'] to '33.33.33.11' and i can see that setting reflected correctly in my.conf. now the interesting part: if i ssh into that machine i can do "mysql -u root" but i can't do "mysql -h 33.33.33.11 -u root". (ERROR 2003 (HY000): Can't connect to MySQL server on '33.33.33.11' (111)). now the config looks fine, so i decided
[2014-04-04 21:23:30 -0400] papasierra: to "sudo service restart mysql" and voila, it now works
[2014-04-04 21:23:53 -0400] coderanger: allaire: Mental models of NP complete problems: a thing :-(
[2014-04-04 21:24:21 -0400] papasierra: so every time i reboot the machine, i have to then restart mysql.
[2014-04-04 21:24:23 -0400] allaire: coderanger: Meanwhile you here, I have on last question
[2014-04-04 21:24:24 -0400] coderanger: allaire: The way most people reason about dep solvers is unfortunately not a good way to write one that works correclty
[2014-04-04 21:25:03 -0400] allaire: coderanger: is updating the nginx version IN a role the only way to update it without having to overwrite every other attributes where version is used?
[2014-04-04 21:25:13 -0400] allaire: cause I had to do just that when I did it in my wrapper cookbook
[2014-04-04 21:25:54 -0400] coderanger: allaire: You can do it in a cookbook, but you have to ensure it executes _before_ the nginx one
[2014-04-04 21:26:22 -0400] coderanger: which means you can't easily use a normal wrapper cookbook
[2014-04-04 21:26:33 -0400] allaire: coderanger: http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-04-04 21:26:38 -0400] allaire: same issue as he describes
[2014-04-04 21:26:50 -0400] allaire: so there's no easy way in a wrapper cookbook of doing this?
[2014-04-04 21:26:54 -0400] coderanger: allaire: This will be mentioned in my talk
[2014-04-04 21:27:08 -0400] coderanger: And is a good example of how most "reusable cookbooks" need to be totally rewritten
[2014-04-04 21:27:11 -0400] coderanger: :)
[2014-04-04 21:27:21 -0400] allaire: :)
[2014-04-04 21:27:43 -0400] coderanger: allaire: The right way to handle this kind of stuff is lazy computation so the expansion is put off until runtime
[2014-04-04 21:29:39 -0400] someara: papasierra you're using mysql::server_deprecated?
[2014-04-04 21:30:08 -0400] papasierra: someara: no, include_recipe 'mysql::server'
[2014-04-04 21:30:18 -0400] someara: version 5?
[2014-04-04 21:30:55 -0400] papasierra: shoot, maybe not. let me look at my Berksfile
[2014-04-04 21:31:31 -0400] papasierra: damn, i guess i made an assumption with "depends 'mysql'"
[2014-04-04 21:31:57 -0400] someara: the new version leaves it up to the user to write a configuration out
[2014-04-04 21:34:29 -0400] papasierra: someara: meaning? i have to provide a template for my.conf in my wrapper cookbook?
[2014-04-04 21:35:11 -0400] someara: yep. it should be listening on 0.0.0.0 though by default I think
[2014-04-04 21:36:19 -0400] someara: it configures the bare minimum to get the service running, and loads customizations from conf.d
[2014-04-04 21:37:41 -0400] grampajoe: I'm getting an exception when a directory resource is being created: "NoMethodError: undefined method `split' for nil:NilClass" Here's the error log: https://gist.github.com/grampajoe/5b0cd69d8b770e537066
[2014-04-04 21:38:05 -0400] papasierra: someara: wow i can see that. my.conf is tiny now. well thanks, this should get me going again...
[2014-04-04 21:38:40 -0400] someara: np
[2014-04-04 21:38:51 -0400] grampajoe: Could the exception be from something other than creating the directory? I can't see anywhere that would fail.
[2014-04-04 22:13:18 -0400] papasierra: someara: a bit of feedback. [ERROR] /usr/sbin/mysqld: Can't create/write to file '/var/run/mysql/mysql.pid' (Errcode: 2)
[2014-04-04 22:13:44 -0400] papasierra: so mysqld won't start because the my.conf specifies a pid path where the dir doesn't exist
[2014-04-04 22:14:19 -0400] papasierra: with no modifications whatsoever your my.conf comes out this way: http://www.hastebin.com/raw/bajebulofu
[2014-04-04 22:14:49 -0400] papasierra: source template being this one: https://github.com/opscode-cookbooks/mysql/blob/v5.0.2/templates/default/5.6/my.cnf.erb
[2014-04-04 22:21:07 -0400] papasierra: general chef question: where do variables such as these (@port) get defined? https://github.com/opscode-cookbooks/mysql/blob/v5.0.2/templates/default/5.6/my.cnf.erb
[2014-04-04 22:23:23 -0400] sn0wb1rd: papasierra: https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L159
[2014-04-04 22:23:44 -0400] sn0wb1rd: papasierra: It also depends on the platform you are on
[2014-04-04 22:23:50 -0400] GreatSUN: re
[2014-04-04 22:23:54 -0400] papasierra: sn0wb1rd: right, i think i just found the same thing. i'm on ubuntu, so https://github.com/opscode-cookbooks/mysql/blob/b5072e6ae3bd81b0f6ebec8749f2c2d781271ed9/libraries/provider_mysql_service_ubuntu.rb#L18
[2014-04-04 22:24:06 -0400] papasierra: (right, same thing)
[2014-04-04 22:24:49 -0400] GreatSUN: hey guys
[2014-04-04 22:24:52 -0400] papasierra: sn0wb1rd: so now practically, i need to override those settings. i know the node['foo']['bar'] (in attributes.rb) syntax. but how to i get at *those* variables?
[2014-04-04 22:25:17 -0400] GreatSUN: does someone of you have an idea why librarian-chef install runs into an error while --clean doesn't?
[2014-04-04 22:25:33 -0400] GreatSUN: error is 'pwd' No such file or directory - getcwd
[2014-04-04 22:26:03 -0400] sn0wb1rd: papasierra: For example, port can be overridden with node['mysql']['port'] attribute https://github.com/opscode-cookbooks/mysql/blob/master/recipes/server.rb#L21
[2014-04-04 22:26:59 -0400] papasierra: sn0wb1rd: ok great. what i really need to override is run_dir. see here: https://github.com/opscode-cookbooks/mysql/blob/b5072e6ae3bd81b0f6ebec8749f2c2d781271ed9/libraries/provider_mysql_service_ubuntu.rb#L18
[2014-04-04 22:27:15 -0400] sn0wb1rd: papasierra: Or you can use the `mysql_service` resource yourself in your recipe and set any attribute to anything you want: https://github.com/opscode-cookbooks/mysql/blob/master/libraries/resource_mysql_service.rb
[2014-04-04 22:27:48 -0400] papasierra: then won't mysql_service be called twice? once by me and once by the actual cookbook?
[2014-04-04 22:28:58 -0400] papasierra: i think the issue is this: https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L17 puts a dir inside of /var/run which doesn't survive system reboots. therefore mysqld can only run on a freshlly provisioned machine. as soon as it reboots mysqld can no longer start
[2014-04-04 22:29:34 -0400] papasierra: this is what allows it to run first time around: https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L129
[2014-04-04 22:31:48 -0400] GreatSUN: ok
[2014-04-04 22:32:06 -0400] GreatSUN: it is not working at all besides if I give --path option
[2014-04-04 22:32:10 -0400] papasierra: sn0wb1rd: and i see this is how it's normally done http://askubuntu.com/a/306479
[2014-04-04 22:32:13 -0400] GreatSUN: any idea on that?
[2014-04-04 22:33:55 -0400] sn0wb1rd: papasierra: I believe you should reconverge after a reboot to make sure that the system is in a consistent state
[2014-04-04 22:35:46 -0400] papasierra: sn0wb1rd: i'm not sure what that means. using vagrant, on first run i do "vagrant up --provision", then after that "vagrant reload" without re-provisioning. so i'm not sure where to hook converging into that. then, in production, likewise, how does converging come into play there?
[2014-04-04 22:36:28 -0400] sn0wb1rd: papasierra: you can do `vagrant provision` to reconverge
[2014-04-04 22:36:50 -0400] therealtimsmith: anyone have insight into how chef decides what version of a package to install with the action of upgrade?  Does it example dpkg -l during compile phase?
[2014-04-04 22:37:00 -0400] therealtimsmith: sorta seems like it
[2014-04-04 22:37:09 -0400] sn0wb1rd: papasierra: you can use the chef_client cookbook for handling that in production.
[2014-04-04 22:37:16 -0400] therealtimsmith: if you pin a version in apt but tell the package to upgrade it just ignores the pin
[2014-04-04 22:38:29 -0400] papasierra: whoa, that sounds wonky. hypothetically remove chef from the equation. what we have is an almost working system which is just missing a line of code from the init script. i don't see that converging comes into this at all
[2014-04-04 22:46:55 -0400] coderanger: kallistec sethvargo: <3 #33, owe you both many beers :)
[2014-04-04 23:02:31 -0400] papasierra: coderanger: i don't seem to be able to work out what the proper way to override these variables is, wonder if you could point me in the right direction. https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L18
[2014-04-04 23:02:53 -0400] coderanger: papasierra: You can't
[2014-04-04 23:03:45 -0400] coderanger: papasierra: Most Opscode cookbooks are only kinda-sorta overridable
[2014-04-04 23:03:54 -0400] papasierra: darn. erm... what's next. so i think my only option is to make a custom template. it seems like there's a bug there
[2014-04-04 23:04:12 -0400] coderanger: papasierra: Which one are you trying to override?
[2014-04-04 23:04:31 -0400] papasierra: coderanger: these two lines https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L18-L19
[2014-04-04 23:05:11 -0400] coderanger: Okay, so yeah, you can do it in a template I think
[2014-04-04 23:05:23 -0400] coderanger: just set template_resource 'foo.erb'
[2014-04-04 23:05:26 -0400] coderanger: on the main resource
[2014-04-04 23:05:29 -0400] papasierra: the cookbook assumes there will be dirs inside of /var/run called mysql and mysqld. when i say "assumes" what i mean is it creates it here https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L129
[2014-04-04 23:05:44 -0400] coderanger: copy-pasta the current template from the cookbook and edit it
[2014-04-04 23:05:48 -0400] papasierra: however, dirs inside of /var/run don't survive restarts
[2014-04-04 23:06:24 -0400] papasierra: so in my opinion that lwrp has a bug
[2014-04-04 23:06:36 -0400] coderanger: papasierra: Traditionally the solution to that is to have your init script create the dirs
[2014-04-04 23:07:23 -0400] papasierra: yeah right, but the precise64 init script does not have a mkdir in it. so that's an issue right htere
[2014-04-04 23:07:27 -0400] papasierra: there*
[2014-04-04 23:07:42 -0400] coderanger: Yeah, needs to be fixed in one place or the other :)
[2014-04-04 23:08:57 -0400] papasierra: correct. however, since the init script is not included in the cookbook and instead installed from package, i see it that the cookbook needs to adapt to what the os/package provides. but anyway, i'm not the expert. i'll use a custom template for now
[2014-04-04 23:09:39 -0400] papasierra: i'm just happy that it's not me going mad
[2014-04-04 23:10:22 -0400] coderanger: papasierra: Seems sane to me
[2014-04-04 23:13:21 -0400] jtimberman: totally despise when init scripts do configuration management for you.
[2014-04-04 23:16:32 -0400] papasierra: coderanger jtimberman, either way, i believe this is dodgy https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L129 it's a gotcha because if you provision the it works in so long as you never reboot! so i guess there are cases where folks pack up for the day and go have a beer.
[2014-04-04 23:16:56 -0400] coderanger: jtimberman: recreating ramdisk-backed stuff isn't reall config management
[2014-04-04 23:17:07 -0400] coderanger: jtimberman: Its just part of launching the app
[2014-04-04 23:18:20 -0400] papasierra: plus, it's just creating a base dir. nothing more. and chef can't do that unless you make chef run on start up... wait is that meant to happen?
[2014-04-04 23:18:41 -0400] jtimberman: if the run_dir isn't there, chef should create that when it runs.
[2014-04-04 23:18:53 -0400] coderanger: jtimberman: That means Chef is doing service management
[2014-04-04 23:19:18 -0400] coderanger: jtimberman: Chef should never be in the critical path for service launch once something is configured :)
[2014-04-04 23:19:35 -0400] coderanger: jtimberman: and ramdisks mean that some stuff has to happen pre-launch to be safe
[2014-04-04 23:25:39 -0400] papasierra: coderanger: http://www.hastebin.com/bayuketiqo.rb there's still an issue. my guess is that line 3 is notifying mysql to restart (probably immediately?) at which point it contains the invalid config.
[2014-04-04 23:26:04 -0400] papasierra: does my hypothesis sounds correct? if not i'm doing something dumb elsewhere.
[2014-04-04 23:26:33 -0400] papasierra: if it does sound correct, then what can i do to delay the attempt to start mysql too early?
[2014-04-04 23:31:30 -0400] reset: dandelo: not having much luck building dep-selector 1.0.0.alpha1 on OSX 10.8, gecode installed with homebrew
[2014-04-04 23:31:38 -0400] reset: err 10.9
[2014-04-04 23:32:46 -0400] coderanger: papasierra: In a meeting, but no, thats not what you want
[2014-04-04 23:32:50 -0400] coderanger: papasierra: Can help more in a bit
[2014-04-04 23:33:08 -0400] papasierra: sure, ty
[2014-04-04 23:42:17 -0400] papasierra: coderanger jtimberman, so here it is: it *is* a bug in the opscode cookbook. there's a typo. this should read /var/run/mysqld/mysql.pid (it's missing the d) https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L18
[2014-04-04 23:42:37 -0400] papasierra: the init script is just find as evidenced here:
[2014-04-04 23:42:39 -0400] papasierra: $ grep run /etc/init/mysql.conf
[2014-04-04 23:42:40 -0400] papasierra: start on runlevel [2345]
[2014-04-04 23:42:40 -0400] papasierra:     [ -d /var/run/mysqld ] || install -m 755 -o mysql -g root -d /var/run/mysqld
[2014-04-04 23:54:43 -0400] papasierra: someara: https://tickets.opscode.com/browse/COOK-4519
[2014-04-04 23:56:22 -0400] maplebed: Is it possible to use the package resource to request anything at or greater than a specific version for a package?  eg package my-app version >= 2.0.0
[2014-04-04 23:57:08 -0400] maplebed: I know there's action :upgrade to get the latest, but I want to use a feature of a package that's only present after version X and want to make sure my recipe has access to that version.
