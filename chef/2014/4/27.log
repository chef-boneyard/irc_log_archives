[2014-04-27 01:08:17 -0400] vidluther: I'm testing out Ubuntu 14.04 and some of my cookbooks, and ran into an issue where Ubuntu changed the name of the service, rpcbind-boot, to rpcbind . I have a check for platform_family, but I don't know how to make it be version specific
[2014-04-27 01:15:50 -0400] jameson__: vidluther: I believe you are looking for node.platform_version
[2014-04-27 01:16:48 -0400] jameson__: like node.platform_version = '14.04'
[2014-04-27 01:17:17 -0400] vidluther: ahh yes, thanks, silly me was thinking it'd be platform_family_version
[2014-04-27 01:17:27 -0400] vidluther: helps to google the right thing
[2014-04-27 02:02:23 -0400] rburton-: anyone have luck with configuring iptables with chef?
[2014-04-27 02:08:05 -0400] vidluther: good question rburton-, I'm guessing these guys are doing well.. https://github.com/opscode-cookbooks/iptables
[2014-04-27 02:08:17 -0400] rburton-: I was looking at that and iptables-ng
[2014-04-27 02:08:33 -0400] rburton-: Trying to see how to configure it in a role vs. doing a custom recipe etc.
[2014-04-27 02:08:39 -0400] vidluther: err https://github.com/opscode-cookbooks/firewall
[2014-04-27 02:09:31 -0400] rburton-: I don't see any attributes for this.
[2014-04-27 02:09:39 -0400] rburton-: e.g., do it as a role.json
[2014-04-27 02:12:47 -0400] vidluther: both repos seem volatile at the moment, but probably means active development/discussion somewhere.
[2014-04-27 02:13:20 -0400] rburton-: I guess I'm trying with trying to use iptables-ng and configuring it for redis
[2014-04-27 02:13:22 -0400] vidluther: it's an interesting question, I'm curious what the convention would be too, I would assume some basic rules would we set per role.. but some people in the community hate roles
[2014-04-27 02:13:49 -0400] rburton-: e.g., https://gist.github.com/rburton/4fd4aac01a257a90eb5f
[2014-04-27 02:15:46 -0400] vidluther: I know what you're getting at, it's just that I don't know myself, I've kinda cheated and used cisco's etc at the edge, so everything internally I implicitly trust.. probably not the smartest thing but.
[2014-04-27 02:16:30 -0400] vidluther: doing it in the role would make sense, role of web server, should allow port 80 and 443 but perhaps only from nodes with role of load balancer.. or something?
[2014-04-27 02:17:25 -0400] vidluther: I guess the role would call a cookbook, and that's where the firewall repo would come in handy, it provides you with the lwrp's to define things in english.. your current JSON would drive me nuts
[2014-04-27 02:17:56 -0400] rburton-: to each is own
[2014-04-27 02:18:05 -0400] vidluther: si
[2014-04-27 02:18:07 -0400] rburton-: I rather just override what's needed vs. having to write my own thing
[2014-04-27 02:18:13 -0400] rburton-: JSON is very easy to read
[2014-04-27 02:18:57 -0400] vidluther: it's also easy to fat finger, but that's just been my experience.. forgetting a , or a {, and stuff like that
[2014-04-27 02:19:12 -0400] rburton-: it's easy to fat finger ruby as well ;)
[2014-04-27 02:19:18 -0400] rburton-: Or any language for that matter
[2014-04-27 02:21:03 -0400] vidluther: agreed
[2014-04-27 02:22:19 -0400] vidluther: like you said, to each his own, I like the idea of doing something like firewall rules in a cookbook, but can see the need to do things in a role as an override.
[2014-04-27 02:23:17 -0400] vidluther: For example, I have two roles, webserver and loadbalancer, both call the same recipe (install_nginx).. but who's allowed to access what port is dependent per role
[2014-04-27 04:26:42 -0400] luddite: Hello everyone
[2014-04-27 04:39:29 -0400] luddite: Ive searched high and low and am having trouble searching for nested attributes in a databag. I have a databag called "sites" which has multiple databags for sites ...so "site1", "site2" etc. I can easily do this query to reveal all the attributes in a site databag "databags('sites').list". I can also find a site with a specific top-level attribute like "id:site1.com" with "databags('sites').search "id:site1.com". That is all fine. However if i have JSON li
[2014-04-27 04:41:34 -0400] luddite: A example would be : chef > databags('sites').search "dev:deploy:true"
[2014-04-27 04:41:34 -0400] luddite: Net::HTTPServerException: 400 "Bad Request"
[2014-04-27 04:42:40 -0400] cyrusdavid: is bash's creates attribute relative to the cwd attribute?
[2014-04-27 04:44:32 -0400] luddite: hi cyrusdavid : I am not sure - I am inside of chef-shell rather than standard bash shell
[2014-04-27 04:59:17 -0400] luddite: ok- i found i can do this in knife
[2014-04-27 05:02:28 -0400] luddite: Actually - i was using colons ":" instead of underscores "_" to separate attributes. When I use underscores I can target deeply nested attributes
[2014-04-27 05:02:39 -0400] luddite: databags('sites').search "staging_deploy:true"
[2014-04-27 07:25:31 -0400] brucelee_: finally got this shit working!
[2014-04-27 07:25:36 -0400] brucelee_: onwards and forward :p
[2014-04-27 07:26:17 -0400] brucelee_: coderanger: whats your workflow to setup aws instances with chef? do you use knife-ec2?
[2014-04-27 07:26:21 -0400] brucelee_: i know you mentioned you use cloudformation
[2014-04-27 07:26:24 -0400] brucelee_: but do you kick that off using knife-ec2?
[2014-04-27 08:05:11 -0400] brucelee_: its pretty unanimous that knife-ec2 is the best way to provision ec2?
[2014-04-27 08:22:54 -0400] jidar: eh.. there's a number of tools that handle that
[2014-04-27 09:30:14 -0400] mhenrixon: coderanger there?
[2014-04-27 09:31:32 -0400] mhenrixon: anyone else knows how fetch something like a value from a bash script and use it later on in a recipe? I want something like a lazy execution
[2014-04-27 09:52:08 -0400] GreatSUN: hi all
[2014-04-27 09:52:22 -0400] GreatSUN: can someone tell me why I can not use nokogiri in a ruby block?
[2014-04-27 09:54:00 -0400] GreatSUN: trying to use it results in NameError: uninitialized constant Chef::Recipe::Nokogiri
[2014-04-27 12:10:46 -0400] mhenrixon: I figured it out, of course I have to use notifies :)
[2014-04-27 12:44:49 -0400] masterkorp: guys shameless plug here, does anyone want a decent DevOps for hire ? :)
[2014-04-27 13:23:55 -0400] zrankfappa: hey all
[2014-04-27 13:24:35 -0400] zrankfappa: anyone familiar with the mysql cookbook, i'm new and having a few probe on initial install and grant of privs
[2014-04-27 13:28:02 -0400] zrankfappa: looks like it's trying setup privileges before the db is up
[2014-04-27 13:28:14 -0400] zrankfappa: https://gist.github.com/buddhafinger/11345552
[2014-04-27 13:51:51 -0400] zrankfappa: anyone got a sec for a noob?
[2014-04-27 13:52:24 -0400] zrankfappa: what I hope is a simple question about mysql cookbook
[2014-04-27 15:14:28 -0400] zrankfappa: anyone home?
[2014-04-27 15:27:03 -0400] nd__: I just wanted to try out chef-metal + docker in vagrant, but I cannot specify to run the vagrant box with the vmware_fusion provider, can it?
[2014-04-27 15:32:50 -0400] randingo: zrankfappa:  I took a look at it, but being a noob myself I don't have much to offer.  Looking at the process of creating a mySql on ubuntu in general  (https://help.ubuntu.com/community/ApacheMySQLPHP#After_installing_MySQL); maybe the "root" user and "password", need to be initialized before you issue the grant.sql command.
[2014-04-27 19:33:12 -0400] whiteadam: Anyone know of a good cucumber+test kitchen tutorial/overview?
[2014-04-27 19:33:30 -0400] coderanger: whiteadam: Test-Driven Development With Chef
[2014-04-27 19:33:52 -0400] whiteadam: coderanger: Yeah, read it, but it seems he only covers his own plugin, which hasn't been updated in some time
[2014-04-27 19:34:17 -0400] coderanger: Yes, thats the only cuke+chef integration I know of
[2014-04-27 19:34:35 -0400] coderanger: serverspec and bats are much more popular
[2014-04-27 19:35:11 -0400] whiteadam: coderanger: Yeah, I'm dealing with Fortune 100 types who are impossible to explain anything to, so I figured I'd give Cucumber Acceptance tests a shot to see if it helped
[2014-04-27 19:36:15 -0400] coderanger: whiteadam: Eh, the cuke file and spec file are going to end up looking veeeeery similar in this case
[2014-04-27 19:36:31 -0400] whiteadam: coderanger: ugh!
[2014-04-27 19:36:44 -0400] coderanger: since they are describing the same underlying stuff
[2014-04-27 19:36:47 -0400] whiteadam: yeah
[2014-04-27 19:37:08 -0400] coderanger: but neither are very good for super high-level acceptance tests
[2014-04-27 19:37:21 -0400] coderanger: because pointy-hair types don't usually care about how its built
[2014-04-27 19:37:30 -0400] coderanger: they just want acceptance tests for the product itself
[2014-04-27 19:38:09 -0400] whiteadam: Yeah, right now I am dealing with some types who are caring entirely too much about the how. I want to show them that it's better that they concern themselves about the what and leave the rest to me.
[2014-04-27 19:38:32 -0400] coderanger: Jedi mind trick? :)
[2014-04-27 19:38:47 -0400] rayrod2030: just installed latest open source chef server and getting login loop when using default admin user for first login.  anyone see that before?
[2014-04-27 19:39:08 -0400] coderanger: rayrod2030: Do not use the open source webui
[2014-04-27 19:39:12 -0400] whiteadam: hah, I actually have a lot of power at the moment. I was pushing for several customers to let us use chef, then heartbleed happened, then an NRPE exploit, so now I'm on a rolll
[2014-04-27 19:39:18 -0400] coderanger: It is deprecated, and you should disable it
[2014-04-27 19:39:29 -0400] rayrod2030: coderanger: what's the alternative?
[2014-04-27 19:39:43 -0400] coderanger: rayrod2030: Use knife or similar command line tools
[2014-04-27 19:40:28 -0400] whiteadam: rayrod2030: I use the interface to browse when my brain is broken, but do everything through knife if possible
[2014-04-27 19:42:10 -0400] rayrod2030: whiteadam: yeah I do as well but I can't even get the admin user to login for some reason.  guess I'll check the logs.
[2014-04-27 19:42:30 -0400] whiteadam: I wish there was a time limit on repos where if the maintainer didn't do anything for 6 months, it would be up for another person to take.
[2014-04-27 19:43:16 -0400] coderanger: rayrod2030: To register your initial client, grab /etc/chef/admin.pem from the server and use that
[2014-04-27 19:44:29 -0400] whiteadam: coderanger: my interest in Cucumber is also because we have multiple offshore teams who will bug the shit out of me if they don't understand something.
[2014-04-27 19:44:43 -0400] whiteadam: and we don't want that
[2014-04-27 19:45:20 -0400] coderanger: whiteadam: Okay, whats wrong with cucumber-chef?
[2014-04-27 19:45:27 -0400] whiteadam: coderanger: Haven't tried it!
[2014-04-27 19:45:46 -0400] whiteadam: coderanger: I'm all over it now though :)
[2014-04-27 19:46:12 -0400] whiteadam: coderanger: Do you know if you can create a master .kitchen.yml somewhere so that the new cookbooks inherit it's settings?
[2014-04-27 19:46:52 -0400] whiteadam: coderanger: damnit, same maintainer for cucumber-chef. Hasn't done anything in 6+ months
[2014-04-27 19:47:30 -0400] coderanger: whiteadam: ~/.kitchen/config.yml by default
[2014-04-27 19:47:42 -0400] whiteadam: coderanger: nice, thanks
[2014-04-27 19:47:44 -0400] coderanger: whiteadam: Why is that a problem? Chef internals haven't changed ...
[2014-04-27 19:48:44 -0400] coderanger: There are two open PRs, one of which is a feature addition and the other is labelel "experimenal"
[2014-04-27 19:49:41 -0400] whiteadam: coderanger: just makes me feel warm and fuzzy to see updates
[2014-04-27 19:49:59 -0400] coderanger: The joy of narrowly defined tools, you don't need to keep working on them :P
[2014-04-27 19:50:09 -0400] whiteadam: coderanger: hah, I hope that's it
[2014-04-27 19:50:35 -0400] coderanger: whiteadam: Cope is around on here if you hit any blocking issues :)
[2014-04-27 19:51:11 -0400] whiteadam: coderanger: hah, if so, I will seek and annoy
[2014-04-27 19:52:38 -0400] whiteadam: I need a beer
[2014-04-27 19:58:42 -0400] whiteadam: Scenario: I make a wrapper cookbook and I don't know what I'm doing, then I assign that recipe to a server. If I update the wrapper at a later date, will it apply itself to the server without causing a major shit show? (eg: updating the email server in the config)
[2014-04-27 19:59:37 -0400] whiteadam: cuz.. there's a lot of attributed here: https://gitlab.com/gitlab-org/cookbook-gitlab/blob/master/attributes/default.rb
[2014-04-27 20:00:34 -0400] coderanger: Can't tell if that was sarcasm or a question
[2014-04-27 20:00:42 -0400] whiteadam: neither, both
[2014-04-27 20:00:52 -0400] whiteadam: brain is... not working
[2014-04-27 20:02:52 -0400] rayrod2030: I don't suppose there are any docs out there for chefdk yet?  I'm trying it out instead of my usual setup.
[2014-04-27 20:03:15 -0400] whiteadam: I'm not sure, I haven't tried it yet either. I JUST got comfortable with my setup
[2014-04-27 20:03:38 -0400] rayrod2030: yeah I was told by a buddy I used to work with that just joined opscode to give it a shot
[2014-04-27 20:25:13 -0400] coderanger: rayrod2030: Just fix up your path, the bundled tools work exactly the same as always
[2014-04-27 20:29:41 -0400] rayrod2030: coderanger: yup I'm good now.  trying out berkflow.
[2014-04-27 20:39:15 -0400] rayrod2030: maybe I'll try chefdk in a few months.  I'm going back to managing my own gemfile and tools.
[2014-04-27 21:00:00 -0400] holms: coderanger: https://github.com/opscode-cookbooks/gunicorn <-- how to launch gunicorn ;D?
[2014-04-27 21:00:42 -0400] coderanger: holms: Hmm?
[2014-04-27 21:01:05 -0400] holms: seems to be you've been involved withing development of this ookbook
[2014-04-27 21:01:15 -0400] holms: so just wondering how actually to launch gunicorn with that generated config
[2014-04-27 21:03:23 -0400] holms: coderanger: any thoughts? that's all what's left for me =)
[2014-04-27 21:03:33 -0400] coderanger: holms: I use supervisord
[2014-04-27 21:03:53 -0400] coderanger: But I don't use that cookbook generally, and I don't work for Opscode
[2014-04-27 21:04:22 -0400] holms: not familiard with supervisord =/
[2014-04-27 21:04:46 -0400] holms: https://github.com/poise/supervisor this one?
[2014-04-27 21:05:12 -0400] holms: not sure that gunicorn has own script
[2014-04-27 21:05:27 -0400] holms: launching script*
[2014-04-27 21:06:04 -0400] coderanger: holms: What are you using for service management? Just use that
[2014-04-27 21:06:22 -0400] coderanger: supervisor, runit, monit, bluepill, systemd, upstart, etc
[2014-04-27 21:07:08 -0400] holms: whatever debian jessie using im fine with this
[2014-04-27 21:07:35 -0400] holms: just curios how to manage gunicorn launching with cookbook, or I need to write my own launching script (init.d or what is defaultin debian)
[2014-04-27 21:07:43 -0400] holms: a bit out of scope from chef but still
[2014-04-27 21:08:06 -0400] coderanger: holms: Old-style init scripts are not acceptable for anything but toy applications, and you shouldn't be using them
[2014-04-27 21:08:18 -0400] coderanger: You need something monitoring your processes, restarting them, etc
[2014-04-27 21:08:30 -0400] holms: *nod*
[2014-04-27 21:08:32 -0400] gchristensen: coderanger: amazing how things change :)
[2014-04-27 21:10:58 -0400] holms: coderanger: thnx got it
[2014-04-27 21:43:46 -0400] ericmuyser: hey fellas
[2014-04-27 21:44:05 -0400] ericmuyser: is opsworks not compatible with a vpc set to us west?
[2014-04-27 21:44:11 -0400] coderanger: ericmuyser: Note: Not everyone here is a fella
[2014-04-27 21:44:28 -0400] ericmuyser: hey guys and gals
[2014-04-27 21:44:32 -0400] coderanger: ericmuyser: opswords is entirely managed by Amazon, you would have to check their docs
[2014-04-27 21:44:33 -0400] ericmuyser: i cant get anything past 'booting' and I cant get any logs
[2014-04-27 21:44:43 -0400] coderanger: Which us-west?
[2014-04-27 21:44:50 -0400] ericmuyser: us-west-2a
[2014-04-27 21:44:54 -0400] coderanger: if you are using us-west-1, tons of services don't work there
[2014-04-27 21:45:06 -0400] coderanger: Not sure then, I would expect most services to work in west2
[2014-04-27 21:45:16 -0400] coderanger: but I don't have much experience with Opsworks
[2014-04-27 21:45:47 -0400] ericmuyser: no wories thx anyway, i just came across some info for opsworks in the chat logs here in #chef in 2013
[2014-04-27 21:45:50 -0400] ericmuyser: figured id ask here
[2014-04-27 21:46:54 -0400] rayrod2030: can serf do k/v like etcd?
[2014-04-27 21:47:01 -0400] coderanger: rayrod2030: No, it isn't a DB
[2014-04-27 21:47:27 -0400] coderanger: ericmuyser: Getting support on AWS stuff is hard :-( You can try asking on the Chef ML, but its a shot in the dark at best
[2014-04-27 21:47:37 -0400] rayrod2030: bleh.  was thinking of what it would be like to run consul on all nodes and store chef attribute data in consul/serf instead of chef server.
[2014-04-27 21:47:47 -0400] coderanger: ericmuyser: Have you tried the AWS Forums? They are slow, but sometimes helpful
[2014-04-27 21:48:02 -0400] rayrod2030: sort of like optica but without the zk dep.
[2014-04-27 21:48:08 -0400] coderanger: rayrod2030: Thats what AirBnB does, except with ZK
[2014-04-27 21:48:15 -0400] rayrod2030: :)
[2014-04-27 21:48:25 -0400] coderanger: In related news, if you are considering using Consul in production you need your head examined
[2014-04-27 21:48:40 -0400] coderanger: Hell, I think people running etcd in production need their head examined
[2014-04-27 21:48:50 -0400] rayrod2030: I don't run anything in production that isn't coderanger certified.
[2014-04-27 21:49:13 -0400] rayrod2030: you should get charge for your certification process. :)
[2014-04-27 21:49:14 -0400] coderanger: Heh, consistent DBs are Really Really Really Hard
[2014-04-27 21:49:24 -0400] jidar: hmm, etcd too?
[2014-04-27 21:50:04 -0400] rayrod2030: so what don't you like about consul?  their propogation algo or their design or what?
[2014-04-27 21:50:27 -0400] coderanger: rayrod2030: Just needs to be battle tested
[2014-04-27 21:50:46 -0400] rayrod2030: do it live!
[2014-04-27 21:51:18 -0400] rayrod2030: oreilly reference...
[2014-04-27 21:51:29 -0400] rayrod2030: anyway yeah all of these solutions are pretty new so I hear you.
[2014-04-27 21:52:02 -0400] jidar: also, are you claiming init.d is a bad solution?
[2014-04-27 21:52:19 -0400] jidar: I don't even know you anymore coderanger
[2014-04-27 21:55:04 -0400] coderanger: rayrod2030: ZK has 7 years of testing and fixes, with decades of people looking at Paxos for impl pitfalls
[2014-04-27 21:56:39 -0400] rayrod2030: coderanger: yes I understand that but I also know that most of the language implementations are not as complete as the java/scala clients.
[2014-04-27 21:56:41 -0400] coderanger: By comparison, the Raft paper is still considered a draft I think
[2014-04-27 21:56:50 -0400] rayrod2030: ranjib has talked about tihs.
[2014-04-27 21:56:50 -0400] coderanger: let alone impls of it
[2014-04-27 21:56:57 -0400] rayrod2030: agreed.
[2014-04-27 21:57:03 -0400] coderanger: Kazoo is fine, what more do you need :D
[2014-04-27 21:57:19 -0400] rayrod2030: even airbnb has mentioned that the ruby zk client they use needs work.
[2014-04-27 21:57:44 -0400] rayrod2030: but yeah your are right zk is the most solid solution in that space when you build tooling around it.
[2014-04-27 21:58:45 -0400] rayrod2030: kazoo looks nice
[2014-04-27 21:59:20 -0400] rayrod2030: I wonder if the async stuff depends on some gevent stuff
[2014-04-27 22:00:28 -0400] coderanger: You can use either threads or gthreads
[2014-04-27 22:00:59 -0400] rayrod2030: cool
[2014-04-27 22:01:28 -0400] rayrod2030: I'm already running zk in my infrastructure regardless so makes sense to keep building on top of it.
[2014-04-27 22:09:03 -0400] rburton-: re
[2014-04-27 22:13:26 -0400] zrankfappa: hi all
[2014-04-27 22:13:32 -0400] rayrod2030: anyone using berkflow for workflow?
[2014-04-27 22:13:32 -0400] zrankfappa: anyone got a minute for a nab?
[2014-04-27 22:14:47 -0400] zrankfappa: i've got a quick (i hope) question about the mysql cookbook, it seems to be trying to connect to the db and grant privs before the db is up, using docker, chef-solo and ubuntu 12.04
[2014-04-27 22:17:26 -0400] zrankfappa: are there any other good channels to post newbie chef questions?
[2014-04-27 22:17:38 -0400] zrankfappa: i don't seem to be having much luck in this one
[2014-04-27 22:20:22 -0400] rayrod2030: you can try the chef mailing list
[2014-04-27 22:34:45 -0400] rburton-: I really hate these recipes for installing Ruby 2.x
[2014-04-27 22:39:23 -0400] darkside_: zrankfappa: this channel is more active during work hours
[2014-04-27 22:39:56 -0400] darkside_: also, #learnchef
[2014-04-27 22:55:26 -0400] iroller: Hey Chefs. Should arrays from the same precedence level be merged or overriden during Chef run? role1: :a => :b => :c => [1,2,3] + role2 : :a => :b => :c => [4] = gives me [4] when deep merged instead of [1,2,3,4]
[2014-04-27 22:56:04 -0400] iroller: is it expected? Are they merged only on the top level like :a => [1,2,3] & :a => [4] ?
[2014-04-27 22:56:12 -0400] iroller: (latest chef version)
[2014-04-27 23:01:34 -0400] coderanger: iroller: trololol
[2014-04-27 23:01:47 -0400] coderanger: iroller: See https://coderanger.net/2013/06/arrays-and-chef/ :-)
[2014-04-27 23:04:16 -0400] iroller: coderanger: I don't care about the order, they aren't being merged for some reason :/ Am I missing something?
[2014-04-27 23:05:45 -0400] coderanger: iroller: It depends on exactly how the expansion is run
[2014-04-27 23:07:20 -0400] holms: can it be that remote_file doesn't override file, when it's changed on vm?
[2014-04-27 23:07:36 -0400] holms: cause i have in files/ one file .. and modified file on vm, and after reprovision, nothing is updated
[2014-04-27 23:07:41 -0400] holms: i expect to overrite it
[2014-04-27 23:08:11 -0400] iroller: coderanger: I have 3 roles including each other and they all set default attribute - array somewhere deep (:a => :b => :c => []). The only last one gets to the node attribute after chef run. Can I do something about that?
[2014-04-27 23:08:40 -0400] coderanger: iroller: Yes, stop using arrays
[2014-04-27 23:09:46 -0400] iroller: coderanger: too many roles to rewrite :/ no chance to get arrays merged correctly ?
[2014-04-27 23:09:58 -0400] coderanger: iroller: There is no "correctly" here
[2014-04-27 23:10:09 -0400] coderanger: iroller: The semantics are poorly defined at best
[2014-04-27 23:10:27 -0400] coderanger: You are trying to take advantage of an old impl detail
[2014-04-27 23:10:27 -0400] iroller: coderanger: ok, I mean I want it to be just merged, not replaced with another array
[2014-04-27 23:11:14 -0400] coderanger: iroller: Like I said, the correct solution is to fix your roles, failing that you can manually load each role in your recipe code and process it independently
[2014-04-27 23:11:45 -0400] holms: so how to rewrite updated files with remote_file ?
[2014-04-27 23:12:31 -0400] iroller: coderanger: short term solution is to convert all the arrays to hashes like default['chruby']['rubies'] = {'jruby' => true, '1.9.3' => true, '2.0.0' => true}, right?
[2014-04-27 23:14:03 -0400] coderanger: Yep
[2014-04-27 23:14:30 -0400] coderanger: holms: not sure what you mean, remote_file is idempotent, if the file changes it updates
[2014-04-27 23:14:43 -0400] holms: in my case it doesn't
[2014-04-27 23:14:45 -0400] holms: and i dunno why
[2014-04-27 23:15:06 -0400] coderanger: holms: Do you have a checksum specified manually and/or does the server not correctly implment if-modified-since?
[2014-04-27 23:15:50 -0400] iroller: coderanger: thank you sir
[2014-04-27 23:15:56 -0400] holms: i don't
[2014-04-27 23:15:59 -0400] holms: i need checksum?
[2014-04-27 23:16:03 -0400] coderanger: iroller: Processing them manually might be easier, just fyi
[2014-04-27 23:16:37 -0400] iroller: coderanger: not sure I get it. What do you mean?
[2014-04-27 23:16:47 -0400] coderanger: iroller: node['roles'].map do |r| role = Role.load(r); r.default_attributes['a']['b']}.flatten
[2014-04-27 23:17:02 -0400] coderanger: iroller: Slow, but would work :-)
[2014-04-27 23:17:25 -0400] iroller: coderanger: thanks, will try it too
[2014-04-27 23:19:16 -0400] coderanger: iroller: Of note that snippet is full of syntax errors because I'm not that awake, but you get the idea :)
[2014-04-27 23:19:24 -0400] iroller: yep
[2014-04-27 23:19:25 -0400] holms: coderanger: have you tried to launch gunicorn from virtualenv, with supervisord? does it need to activate virtualenv first? i've got "importerror module main" from gunicorn
[2014-04-27 23:19:28 -0400] coderanger: holms: No, just if you had one it would prevent updates
[2014-04-27 23:20:07 -0400] coderanger: holms: You have to launch it inside the venv, path/to/env/bin/gunicorn
[2014-04-27 23:20:18 -0400] holms: that's what i've did
[2014-04-27 23:20:21 -0400] coderanger: the activate script isn't used much on servers, its just an interactive convenience
[2014-04-27 23:20:36 -0400] holms: i'll collect output then, cause it's strange
[2014-04-27 23:20:44 -0400] coderanger: Is "main" supposed to be your app module?
[2014-04-27 23:21:07 -0400] coderanger: If so, make sure you've installed your package or set the cwd correctly so your code is importable
[2014-04-27 23:21:28 -0400] holms: not sure actually it's my module
[2014-04-27 23:22:11 -0400] holms: coderanger: http://pastebin.com/upvY3HmN
[2014-04-27 23:22:36 -0400] coderanger: holms: Where on disk is main.py?
[2014-04-27 23:23:28 -0400] holms: oops :d
[2014-04-27 23:23:58 -0400] holms: *bow*
[2014-04-27 23:35:44 -0400] holms: coderanger: i'm a bit lucky today http://pastebin.com/a43v9Vv3
[2014-04-27 23:35:58 -0400] holms: it does work under activated virtual env :) python app.py i mean
[2014-04-27 23:36:08 -0400] holms: but supervisor fails
[2014-04-27 23:40:23 -0400] coderanger: holms: There should be no difference
[2014-04-27 23:40:39 -0400] holms: in here they say env var is needed http://stackoverflow.com/questions/6532486/supervising-virutalenv-django-app-via-supervisor
[2014-04-27 23:40:41 -0400] coderanger: holms: Check that if you run bin/python -c 'import flask' it works
[2014-04-27 23:40:46 -0400] holms: ok
[2014-04-27 23:41:15 -0400] holms: it works
[2014-04-27 23:41:17 -0400] holms: your command
[2014-04-27 23:41:21 -0400] coderanger: And yes, setting the path is probably a good idea as well
[2014-04-27 23:41:33 -0400] holms: k
[2014-04-27 23:41:44 -0400] coderanger: Though that isn't what you want to set it to
[2014-04-27 23:41:53 -0400] coderanger: that would override the whole path, you just want to prepend
[2014-04-27 23:43:00 -0400] holms: and how to prepend it
[2014-04-27 23:43:40 -0400] holms: PATH="/dir:$PATH" ?
[2014-04-27 23:44:51 -0400] coderanger: holms: You would have to do it in your Ruby code
[2014-04-27 23:45:15 -0400] coderanger: environment 'PATH' => "/path/to/app:#{ENV['PATH']}"
[2014-04-27 23:45:33 -0400] holms: thanks :)
[2014-04-27 23:50:20 -0400] iroller: coderanger: fyi replacing arrays with hashes didn't do the trick in my case. Getting the last hash as the result instead of merged hashes anyway
[2014-04-27 23:51:33 -0400] coderanger: iroller: That sounds like your roles aren't picking each other up correctly?
[2014-04-27 23:51:42 -0400] coderanger: iroller: Do you see all of them in node['roles']?
[2014-04-27 23:55:44 -0400] holms: coderanger: http://i.imgur.com/WoZiasp.png
