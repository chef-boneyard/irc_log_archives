[2014-04-23 00:01:39 -0400] gkra: so... berks from chefdk is apparently broken?
[2014-04-23 00:01:44 -0400] gkra: (on my box)
[2014-04-23 00:02:17 -0400] gkra: I get: /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/buff-config-0.4.0/lib/buff/config/ruby.rb:30:in `rescue in initialize': uninitialized constant Buff::Config::Ruby::Evaluator::Chef (Buff::Errors::InvalidConfig)
[2014-04-23 00:04:15 -0400] Majost: huh
[2014-04-23 00:20:18 -0400] coderanger: jtimberman: compiling gecode http://i.coderanger.net/WmW7P.png :)
[2014-04-23 00:25:43 -0400] sarkis_: jtimberman: is the logrotate cookbook no longer supported?
[2014-04-23 00:32:18 -0400] lyrua: hello
[2014-04-23 00:33:27 -0400] lyrua: if I have an issue with chef (windows, and powershell) where should I post my question to ?
[2014-04-23 00:33:52 -0400] coderanger: lyrua: Here is fine
[2014-04-23 00:34:02 -0400] coderanger: lyrua: Though the ML might have more Windows-knowledgable folks
[2014-04-23 00:34:36 -0400] lyrua: ML ?
[2014-04-23 00:35:06 -0400] coderanger: mailing list
[2014-04-23 00:35:34 -0400] lyrua: where can I get the mailing list ?
[2014-04-23 00:36:19 -0400] coderanger: http://lists.opscode.com
[2014-04-23 00:36:31 -0400] lyrua: my question is: has anyone tried to call powershell.exe from chef run? it worked on my vagrant, my not in production, it returned -65536 code
[2014-04-23 00:37:58 -0400] lyrua: chef-client called powershell,exe just fine locally, but in production chef-client just failed to invoked it
[2014-04-23 00:38:24 -0400] lyrua: thanks coderanger. I'll give it a shot
[2014-04-23 00:38:37 -0400] coderanger: lyrua: Are you not using the powershell resource?
[2014-04-23 00:39:07 -0400] lyrua: I tried that too, powershell_script and tried with architecture, but failed with same code error
[2014-04-23 00:39:23 -0400] coderanger: lyrua: Whats the actual output, if any?
[2014-04-23 00:39:25 -0400] jidar: I had a lot of problems with the PS provider
[2014-04-23 00:39:43 -0400] lyrua: STDERR: Internal Windows PowerShell error.  Invoking managed Windows PowerShell failed with error 8007000e
[2014-04-23 00:39:57 -0400] lyrua: Expected process to exit with [0], but received '-65536'
[2014-04-23 00:39:59 -0400] jidar: it would fail with out of memory errors for no reason, so I ended up just writing the files to disk and calling powershell.exe manually, which worked a bit better
[2014-04-23 00:40:59 -0400] jidar: lyrua: the process is returning a non 0 return code, so chef thinks its failing to execute properly. Have you tried running the command manually on the same machine, with the same user?
[2014-04-23 00:41:08 -0400] FireBeyond: Confused as to why the user attribute is being ignored in this execute block
[2014-04-23 00:41:10 -0400] FireBeyond: http://pastebin.com/mWpgQWPB
[2014-04-23 00:41:42 -0400] lyrua: yes I tried running manually with same user, called 32bit and 64bit powershell
[2014-04-23 00:41:48 -0400] lyrua: and both worked
[2014-04-23 00:42:02 -0400] coderanger: FireBeyond: how is that script checking if it is root?
[2014-04-23 00:42:39 -0400] jidar: what's the exact command you're using?
[2014-04-23 00:43:08 -0400] FireBeyond: The binary for zabbix_agentd tests for it. I can't run as root at the command line, and don't want to
[2014-04-23 00:43:12 -0400] lyrua: there is a powershell script ps1 and I just want to run it
[2014-04-23 00:43:24 -0400] FireBeyond: but when I specify user 'myuseraccount', it seems to be ignored
[2014-04-23 00:43:37 -0400] FireBeyond: in the execute block
[2014-04-23 00:43:43 -0400] lyrua: powershell.exe -executionpolicy Bypass something.ps1
[2014-04-23 00:44:09 -0400] lyrua: ps1 is very simple, it will just create a text file with date in it
[2014-04-23 00:44:42 -0400] coderanger: FireBeyond: If I'm reading this correctly, it is trying to change user to zabbix which doesn't exist?
[2014-04-23 00:46:26 -0400] jidar: powershell.exe -NoProfile -ExecutionPolicy unrestricted -WindowStyle Hidden -File
[2014-04-23 00:46:34 -0400] jidar: that's how I kicked stuff off
[2014-04-23 00:46:53 -0400] lyrua: there is only one email from Opscode: opscode-announce@lists.opscode.com? Is it ok to emailing a question to it ?
[2014-04-23 00:47:12 -0400] coderanger: lyrua: You want the chef list
[2014-04-23 00:47:31 -0400] coderanger: lyrua: http://lists.opscode.com/sympa/info/chef
[2014-04-23 00:48:03 -0400] lyrua: oh i was in Home tab, thanks coderanger
[2014-04-23 00:48:35 -0400] coderanger: FireBeyond: Yeah, this is just a terribad error message
[2014-04-23 00:48:38 -0400] FireBeyond: coderanger: the binary certainly does check for that. but still doesn't explain why the chef recipe isn't even trying to execute it as 'myuser'
[2014-04-23 00:48:42 -0400] coderanger: FireBeyond: Had to go grep the code
[2014-04-23 00:48:50 -0400] coderanger: FireBeyond: Chef isn't involved
[2014-04-23 00:48:55 -0400] lyrua: jidar: I'll try that
[2014-04-23 00:49:18 -0400] coderanger: FireBeyond: You told zabbix to run as "zabbix", which doesn't exist, so it falls back to root, and then errors
[2014-04-23 00:49:49 -0400] coderanger: FireBeyond: http://git.zabbixzone.com/trunk/.git/blob/HEAD:/src/libs/zbxnix/daemon.c#l156
[2014-04-23 00:51:26 -0400] FireBeyond: Hrm, that much makes sense, and forgive me if it's dense of me, but if i create a code block in my recipe that says execute "start zabbix" do, user "username", command "/usr/local/sbin/zabbix_agentd", end
[2014-04-23 00:51:37 -0400] FireBeyond: that -won't- execute the command as user x?
[2014-04-23 00:52:14 -0400] FireBeyond: (the simple solution, and the one i'm implementing right now is to create the zabbix account, but just trying to further my understanding)
[2014-04-23 00:52:30 -0400] someara: FireBeyond that should execute as username
[2014-04-23 00:53:35 -0400] FireBeyond: right, so, looking at the code block in the error, chef sees that too, and yet is (evidently) not executing as that username, or the agent wouldn't complain that it can't run as root
[2014-04-23 01:00:22 -0400] coderanger: FireBeyond: Your zabbix config file has an invalid user specified in it
[2014-04-23 01:00:30 -0400] coderanger: FireBeyond: Either create the zabbix user or fix your config
[2014-04-23 01:00:58 -0400] someara: that it doesn't complain that it can't run as brokenuser and executes as root feels like a bug to me
[2014-04-23 01:01:37 -0400] FireBeyond: To be sure, changing to the zabbix user fixes the issue
[2014-04-23 01:02:23 -0400] Majost_: coderanger, Correct me if I am wrong; but to use poise I should be using chef_gem in my default recipe, yes?
[2014-04-23 01:02:31 -0400] coderanger: Majost_: For what?
[2014-04-23 01:03:06 -0400] Majost_: I didn't think it was part of chef proper
[2014-04-23 01:03:12 -0400] coderanger: Its a cookbook
[2014-04-23 01:03:17 -0400] Majost_: ah right
[2014-04-23 01:03:59 -0400] coderanger: Just add "depends 'poise'" to your metadata.rb
[2014-04-23 01:07:34 -0400] jidar: lyrua: full example of how I called it from chef: http://pastebin.com/uJ7cBAA5
[2014-04-23 01:11:08 -0400] tempname: Has anyone ever run into this issue while using the apt cookbook? Could not get lock /var/lib/apt/lists/lock - open (11: Resource temporarily unavailable)
[2014-04-23 01:23:42 -0400] gkra: okay... if i run berks (from chefdk) inside my chef repo, it bombs. if I run it outside, it doesn't, but it has no configs.
[2014-04-23 01:24:10 -0400] gkra:  /opt/chefdk/embedded/lib/ruby/gems/2.1.0/gems/buff-config-0.4.0/lib/buff/config/ruby.rb:30:in `rescue in initialize': uninitialized constant Buff::Config::Ruby::Evaluator::Chef (Buff::Errors::InvalidConfig)
[2014-04-23 01:24:22 -0400] gkra: any idea how to track down *what* config it's barfing on?
[2014-04-23 01:27:38 -0400] gkra: oh !@%3 me
[2014-04-23 01:28:11 -0400] gkra: # Allow overriding values in this knife.rb
[2014-04-23 01:28:11 -0400] gkra: home_dir    = ENV['HOME'] || ENV['HOMEDRIVE']
[2014-04-23 01:28:12 -0400] gkra: knife_override = "#{home_dir}/.chef/knife_override.rb"
[2014-04-23 01:28:12 -0400] gkra: Chef::Config.from_file(knife_override) if File.exist?(knife_override)
[2014-04-23 01:28:24 -0400] gkra: if I comment out that last line, berks works fine.
[2014-04-23 01:34:18 -0400] jidar: wacky
[2014-04-23 01:34:39 -0400] gkra: nice
[2014-04-23 01:34:58 -0400] gkra: now berks is failing to git clone the requested cookbooks from github
[2014-04-23 01:35:05 -0400] gkra: is there some special ssh magic for that?
[2014-04-23 01:36:51 -0400] gkra: wait
[2014-04-23 01:37:01 -0400] gkra: I think github might be having problems...
[2014-04-23 01:38:07 -0400] sarkis: check the status page
[2014-04-23 01:38:18 -0400] sarkis: https://status.github.com/
[2014-04-23 01:39:09 -0400] sarkis: hmm this is strange, anyone using chef solo + sethvargo users cookbook?
[2014-04-23 01:39:23 -0400] sarkis: it doesn't seem to be picking up new .json files in the data_bag/users/ folder
[2014-04-23 01:48:22 -0400] gkra: so...
[2014-04-23 01:49:12 -0400] gkra: with the old berks, I could have a Berksfile in my chef repo dir, and just work with that...
[2014-04-23 01:49:16 -0400] gkra: is that no longer the case?
[2014-04-23 01:50:05 -0400] traviscline: anyone know of an example of someone programatically generating runit_service services (I don't want to rely on having particular template files on disk)
[2014-04-23 01:52:06 -0400] sarkis: gkra: as far as i can tell, you would just need to change site :opscode line to the source line
[2014-04-23 01:52:11 -0400] coderanger: traviscline: Now sure what you mean
[2014-04-23 01:52:18 -0400] coderanger: er, not
[2014-04-23 01:52:43 -0400] sarkis: gkra: berkshelf kinda pushes you to do the whole application cookbooks deal too which actually is nicer.. are you using roles?
[2014-04-23 01:53:09 -0400] gkra: hmm.
[2014-04-23 01:53:58 -0400] gkra: I'd been cheating, and having a "master" Berksfile in my chef repo that I've kept up to date with the latest versions for all the cookbooks we're using...
[2014-04-23 01:54:18 -0400] gkra: yeah, we're using the role+cookbook model
[2014-04-23 01:54:39 -0400] sarkis: are u having trouble with it?
[2014-04-23 01:55:24 -0400] gkra: trying to adapt to a workflow :)
[2014-04-23 01:55:40 -0400] gkra: berks 3 looks like it'll help us solve a lot of our environment-promotion issues
[2014-04-23 01:56:00 -0400] gkra: but that also means I need to go through all our cookbooks and properly berks them :)
[2014-04-23 01:57:23 -0400] sarkis: i had to ditch roles
[2014-04-23 01:57:37 -0400] sarkis: it just didn't make sense to me tbh, but then again i come from puppet so maybe that played into it as well
[2014-04-23 01:57:48 -0400] sarkis: i can see how that is a problem for a bigger codebase though
[2014-04-23 01:58:26 -0400] sarkis: but you are right, need to come up with some standard and stick to it, i did find that to be true about chef thus far.. so many ways to skin a cat, just gotta find what works best for your team and outline it well so everyone follows it.
[2014-04-23 01:58:33 -0400] gkra: we've pretty much gone with role-per-service for our platform
[2014-04-23 01:58:40 -0400] jbz: gkra: us as well
[2014-04-23 01:58:53 -0400] jbz: stack the roles on multiservice nodes
[2014-04-23 01:58:58 -0400] gkra: yup.
[2014-04-23 01:59:00 -0400] gkra: and then cookbook-per-role to handle versioning
[2014-04-23 01:59:23 -0400] jbz: I just still haven't been sold on cookbooks-as-roles
[2014-04-23 01:59:45 -0400] jbz: I haven't run across a problem where I couldn't handle the lack of versioning on the server by using git repos and chef environments.
[2014-04-23 01:59:57 -0400] jbz: And I purely, purely hate checking in cookbook code to change values.  It gives me hives.
[2014-04-23 02:00:18 -0400] jameson__: jbz: I think cookbook-as-roles is patching the issue where roles can't be safely versioned ans shared.
[2014-04-23 02:00:40 -0400] jbz: jameson__ Oh, I grok that, but I haven't run into a problem which would have been solved by that yet
[2014-04-23 02:00:57 -0400] gkra: hmm.
[2014-04-23 02:00:58 -0400] gkra: crap
[2014-04-23 02:01:03 -0400] jbz: whereas I *have* been bitten numerous times by people (me, lots of times) checking in cookbooks after work was done and breaking convergence.
[2014-04-23 02:01:19 -0400] jbz: And sure, "DO MORE TESTING"
[2014-04-23 02:01:31 -0400] jameson__: you took the words out of my keyb9oard
[2014-04-23 02:01:32 -0400] jbz: in a perfect world of puppies and kittens, yep.
[2014-04-23 02:01:44 -0400] gkra: how does berks 3 look for it's config file?
[2014-04-23 02:02:03 -0400] jbz: Testing only catches cases there are tests for. :-P
[2014-04-23 02:02:13 -0400] jameson__: jbz: i am treating roles like definitions in recipes, a necessary use, but we could do better.
[2014-04-23 02:02:23 -0400] jameson__: an 'alias'
[2014-04-23 02:02:28 -0400] jbz: Please don't get me wrong, I'm not advocating my approach
[2014-04-23 02:02:37 -0400] jbz: it WFM so far though.
[2014-04-23 02:03:39 -0400] jameson__: I think the role issue is prevalent when it goes from WFM to WorksForUs/We
[2014-04-23 02:04:03 -0400] gkra: uhm...
[2014-04-23 02:04:30 -0400] jameson__: gkra: I thought berks looks for the berksfile locally
[2014-04-23 02:04:32 -0400] gkra: for berks in chefdk, should I install bundler via "chef gem install bundler" or just use my local ruby?
[2014-04-23 02:06:06 -0400] jameson__: the chef gem install bundler
[2014-04-23 02:06:46 -0400] gkra: then how do I call that bundler?
[2014-04-23 02:06:53 -0400] jameson__: bundler
[2014-04-23 02:07:09 -0400] jameson__: olh wait I am in rbenv
[2014-04-23 02:08:20 -0400] gkra: is there any *harm* in using my rbenv bundler?
[2014-04-23 02:08:35 -0400] jameson__: no, I am ging that
[2014-04-23 02:08:47 -0400] jameson__: it's just you know, 15min compiling ridley
[2014-04-23 02:08:51 -0400] jameson__: for berks
[2014-04-23 02:09:00 -0400] gkra: heh
[2014-04-23 02:09:09 -0400] gkra: so berks is from chefdk, bundler is from rbenv
[2014-04-23 02:10:11 -0400] jameson__: actually for me, don't have that at all :\ I need to fix that
[2014-04-23 02:10:22 -0400] gkra: heh
[2014-04-23 02:10:32 -0400] jameson__: fyi, the gems are installed to /opt/chefdk/embedded/lib/ruby
[2014-04-23 02:10:52 -0400] gkra: I'm a bit cheesed that berks breaks on Chef::Config.from_file(knife_override) if File.exist?(knife_override)
[2014-04-23 02:11:11 -0400] gkra: but i guess it was kind of a hack for knife.rb
[2014-04-23 02:19:31 -0400] gkra: gah
[2014-04-23 02:19:52 -0400] gkra: adding 'protocol: :https' and berks 3 still tries to fetch via ssh
[2014-04-23 02:20:05 -0400] jameson__: :3
[2014-04-23 02:20:50 -0400] gkra: which of course is not working because Github apparently hates me right now
[2014-04-23 02:22:07 -0400] gkra: fatal: remote error:
[2014-04-23 02:22:07 -0400] gkra:   Repository not found.
[2014-04-23 02:22:12 -0400] gkra: oh, sir, it's there.
[2014-04-23 02:23:07 -0400] jameson__: yeah, I'm not sold on chef-dk
[2014-04-23 02:23:30 -0400] gkra: ugh... how do I install berkshelf 2? :)
[2014-04-23 02:23:49 -0400] jameson__: if you want uncertain dependency resolution you can put it in your Gemfile ;)
[2014-04-23 02:23:55 -0400] jameson__: < 3.0
[2014-04-23 02:24:17 -0400] gkra: where do I put my Gemfile?
[2014-04-23 02:24:36 -0400] gkra: that's my other issue, is I'm learning the ruby side of this on the fly...
[2014-04-23 02:26:29 -0400] jameson__: oh you should do that first
[2014-04-23 02:26:47 -0400] jameson__: Gemfile and Berksfile lives in the same directory as your cookbook
[2014-04-23 02:27:04 -0400] gkra: joy
[2014-04-23 02:27:14 -0400] gkra: I'm managing about 30 cookbooks right now :)
[2014-04-23 02:27:28 -0400] gkra: okay, wtf, berks.
[2014-04-23 02:27:35 -0400] gkra: if I tell you a protocol, freaking use it.
[2014-04-23 02:28:54 -0400] gkra: it'd be nice if there were some more detailed docs :(
[2014-04-23 02:30:37 -0400] gkra: okay, there's my problem... Berkshelf is using "git" protocol instead of :ssh or :https as i've configured in Berksfile
[2014-04-23 02:30:44 -0400] gkra: *headdesk*
[2014-04-23 02:36:31 -0400] jameson__: :3
[2014-04-23 02:40:09 -0400] sarkis: man this is strange
[2014-04-23 02:40:11 -0400] sarkis: Recipe: users::sysadmins
[2014-04-23 02:40:13 -0400] sarkis:   * users_manage[sysadmin] action remove[2014-04-23T02:38:47+00:00] WARN: This recipe uses search. Ch
[2014-04-23 02:40:15 -0400] sarkis: ef Solo does not support search unless you install the chef-solo-search cookbook.
[2014-04-23 02:40:34 -0400] sarkis: trying to remove[datetime???]
[2014-04-23 02:42:05 -0400] coderanger: sarkis: ?
[2014-04-23 02:46:14 -0400] traviscline: coderanger: re: programatic runit services -- i want a lwrp that I only need to provide a few bits of info but want a runit service to result
[2014-04-23 02:46:30 -0400] traviscline: so I dont' want to sprinkle .erb files around as it appears I need to do
[2014-04-23 02:47:01 -0400] coderanger: traviscline: Just put the template in the LWRP's cookbook itself
[2014-04-23 02:47:34 -0400] coderanger: traviscline: ex. https://github.com/poise/berkshelf-api/blob/master/libraries/berkshelf_api.rb#L228-L233
[2014-04-23 02:47:38 -0400] supercom32: Newbie question here, but I have a bunch of require fields in my ruby code. Does anyone know which ones come standard with Ruby/Chef and which ones I need to make sure a chef_gem statement exists for? http://pastebin.com/Gj7sjWZW
[2014-04-23 02:47:51 -0400] cheeseplus: coderanger: would accumulator work? https://github.com/kisoku/chef-accumulator
[2014-04-23 02:47:54 -0400] traviscline: hm yeah
[2014-04-23 02:47:59 -0400] cheeseplus: for the same purpose
[2014-04-23 02:48:21 -0400] coderanger: cheeseplus: For which purpose?
[2014-04-23 02:48:34 -0400] coderanger: supercom32: Those are all standard I think
[2014-04-23 02:48:39 -0400] cheeseplus: for traviscline
[2014-04-23 02:48:51 -0400] coderanger: cheeseplus: I don't think so
[2014-04-23 02:49:45 -0400] supercom32: coderanger: Ah, I see.
[2014-04-23 02:50:51 -0400] coderanger: supercom32: Simple way to tell, write some test-kitchen tests and see if it works ;-)
[2014-04-23 02:51:14 -0400] cheeseplus: sorry, crappy train wifi makes it hard to read le github
[2014-04-23 02:51:59 -0400] supercom32: coderanger: test-kitchen? What is that? I'm kind of green. I assume it's a way to simulate a clean env?
[2014-04-23 02:52:24 -0400] coderanger: supercom32: Its an integration testing framework for Chef, so yes
[2014-04-23 02:55:44 -0400] traviscline: coderanger: so the template file has to match the name given to runit_service, right?
[2014-04-23 02:55:59 -0400] coderanger: traviscline: You can customize that too
[2014-04-23 02:56:12 -0400] coderanger: traviscline: https://github.com/hw-cookbooks/runit#parameter-attributes
[2014-04-23 02:56:23 -0400] coderanger: run_template_name and similar
[2014-04-23 02:57:43 -0400] coderanger: traviscline: Like this https://github.com/balanced-cookbooks/rundeck/blob/master/libraries/rundeck.rb#L281-L286
[2014-04-23 03:06:49 -0400] traviscline: if I'm wrapping a resource can I easliy expose it's actions?
[2014-04-23 03:09:04 -0400] coderanger: traviscline: Not sure what that means
[2014-04-23 03:09:44 -0400] traviscline: i want to expose a two-parameter resource that just hands back a runit_service
[2014-04-23 03:09:55 -0400] traviscline: (so support :restart :create, etc) without many LOC
[2014-04-23 03:10:13 -0400] coderanger: Why not subclass the runit resource/provider?
[2014-04-23 03:15:38 -0400] gestrella: Im trying to install rvm on my system. Im currently using chef-rvm and including the following recipe:   include_recipe "rvm::system_install"  rvm is installed but after that the chef-client is not working
[2014-04-23 03:16:07 -0400] gestrella: I do undertand that chef-client uses an embedded chef. but it seems that the rvm is creating a conflict
[2014-04-23 03:16:41 -0400] gestrella: What's the best practice to install rvm using chef
[2014-04-23 03:17:23 -0400] coderanger: gestrella: Unhelpful answer: don't :-)
[2014-04-23 03:17:28 -0400] coderanger: gestrella: What OS are you using?
[2014-04-23 03:17:40 -0400] gestrella: Centos 6.4
[2014-04-23 03:18:05 -0400] coderanger: gestrella: Super easy solution, use software collections
[2014-04-23 03:18:19 -0400] gestrella: Software collections?
[2014-04-23 03:18:41 -0400] coderanger: gestrella: http://wiki.centos.org/AdditionalResources/Repositories/SCL
[2014-04-23 03:18:52 -0400] coderanger: gestrella: centos already has all versions of Ruby packaged for you and ready to go
[2014-04-23 03:18:54 -0400] gestrella: Thanks CodeRanger
[2014-04-23 03:19:09 -0400] gestrella: That means that I dont need to use rvm at all
[2014-04-23 03:19:39 -0400] coderanger: Indeed :)
[2014-04-23 03:19:49 -0400] coderanger: rvm is (at best) for workstations, not for servers
[2014-04-23 03:20:02 -0400] coderanger: though rvm is mostly obsolete in favor of rbenv and chruby
[2014-04-23 03:20:27 -0400] gestrella: ok
[2014-04-23 03:23:28 -0400] coderanger: but still both of those are better on workstations than servers
[2014-04-23 03:27:29 -0400] sarkis: why wouldn't chef look in /etc/init.d/ and only in /etc/init?
[2014-04-23 03:30:37 -0400] coderanger: sarkis: For services you mean?
[2014-04-23 03:31:38 -0400] sarkis: yea
[2014-04-23 03:31:51 -0400] sarkis: im telling chef use the Upstart provider
[2014-04-23 03:32:28 -0400] coderanger: sarkis: Upstart doesn't use init.d
[2014-04-23 03:32:35 -0400] sarkis: ah
[2014-04-23 03:32:44 -0400] coderanger: That folder contains old-style sysv init scripts
[2014-04-23 03:35:32 -0400] sarkis: ah i see what i did
[2014-04-23 03:36:00 -0400] sarkis: race condition, /etc/init/monit.conf isn't written before the upstart restart
[2014-04-23 03:48:31 -0400] chrismoos: :b 2
[2014-04-23 03:48:59 -0400] coderanger: chrismoos: :wq!
[2014-04-23 03:49:30 -0400] chrismoos: @coderanger ;) i guess i was in insert mode
[2014-04-23 04:09:36 -0400] sarkis: ok last question
[2014-04-23 04:09:38 -0400] sarkis: * rbenv_ruby[2.1.1] (system) action install[2014-04-23T04:08:27+00:00] WARN: ruby_build cookbook is missing. Please add to the run_list (Action will be skipped).
[2014-04-23 04:10:05 -0400] sarkis: i have include_recipe "ruby_build" that's not the same as the run_list right?\
[2014-04-23 04:23:37 -0400] jidar: is there no way to get test-kitchen to not have to download the chef client/etc everytime it runs?
[2014-04-23 04:34:04 -0400] meth: Is there anything that can alert you if a host de-converges?
[2014-04-23 04:38:10 -0400] juliancdunn: jidar: build a box with Chef Client already baked in and use that
[2014-04-23 04:43:57 -0400] jidar: juliancdunn: so I don't use the platform stuff in the .yml? - name: centos-6.5 ?
[2014-04-23 04:46:37 -0400] juliancdunn: jidar: name it something like centos-6.5-chef11.12.2 or whatever and provide a box_url for it
[2014-04-23 04:46:57 -0400] jidar: oh ok
[2014-04-23 04:46:58 -0400] juliancdunn: the name matches whatever name your driver recognizes - so if vagrant, the name of the box registered with vagrant
[2014-04-23 04:49:05 -0400] jidar: it seems to want to prepend opscode
[2014-04-23 04:49:12 -0400] jidar: even though I'm putting in chef/centos6.5
[2014-04-23 04:49:18 -0400] juliancdunn: not if you specify a box_url
[2014-04-23 04:49:28 -0400] jidar: oh ok, right, sorry
[2014-04-23 04:50:34 -0400] juliancdunn: meth: what do you mean "de-converges"
[2014-04-23 04:50:48 -0400] juliancdunn: you can set alerts based on # of resources converged... should be close to 0
[2014-04-23 04:51:04 -0400] meth: if -W shows that changes are required for the host
[2014-04-23 04:51:46 -0400] juliancdunn: you could run that as a nagios check or something if you like :)
[2014-04-23 04:51:56 -0400] meth: sure but I'm wondering if something already exists
[2014-04-23 04:52:02 -0400] juliancdunn: not that I know of
[2014-04-23 04:52:25 -0400] juliancdunn: in practice I see very few people using why-run
[2014-04-23 04:52:54 -0400] meth: well isn't that terrible?
[2014-04-23 04:53:09 -0400] juliancdunn: how so?
[2014-04-23 04:53:59 -0400] meth: I always use -W to make sure what I'm applying is the only thing that's going to apply and to make sure nothing unforseen is going to roll out.. sometimes changes drift perhaps on purpose (like during an emergency) and weren't added back to the cookbooks yet etc..
[2014-04-23 04:54:25 -0400] juliancdunn: it depends if you see Chef as a policy compliance daemon, or a change application system
[2014-04-23 04:54:43 -0400] juliancdunn: I think most people see it as the former and run Chef as a daemon/service as a result
[2014-04-23 04:55:10 -0400] juliancdunn: "weren't added back to the cookbooks yet" doesn't happen if you only make changes through Chef
[2014-04-23 04:56:05 -0400] meth: well for production critical hosts we like to roll out by hand because it's all change controlled and audited
[2014-04-23 04:56:41 -0400] meth: and to me I use -W as a sanity and to make sure something hasn't drifted that should be updated in the cookbook .. etc.
[2014-04-23 04:56:55 -0400] jidar: juliancdunn: is the box_url defined in Vagrant, because I can't find any docs that refer to it in test-kitchen?
[2014-04-23 04:57:44 -0400] viglesias: jidar: http://hastebin.com/avuxalucad.sm
[2014-04-23 04:58:05 -0400] jidar: ah, fantastic, thanks
[2014-04-23 04:58:10 -0400] viglesias: np
[2014-04-23 04:58:23 -0400] meth: changes happen though.. someone might fix something intraday outside of chef to get around a production problem.. also what if the cookbook version I'm about to roll out is wrong? maybe the host is a few release behind for a reason?   maybe the branch I'm working off included more changes than I realized? etc..
[2014-04-23 05:00:05 -0400] meth: so when i go to push a new cookbook version if i see hundreds of lines of changes in -W that aren't the changes I'm trying to push then I need to figure out what's going on..
[2014-04-23 05:00:44 -0400] juliancdunn: all good discussion points... come back during the day Eastern time and I'll discuss it with you :)
[2014-04-23 05:00:53 -0400] juliancdunn: <- goes to bed
[2014-04-23 05:01:09 -0400] meth: ah it's ok i bet it doesn't exist and like you said it's a 2 second check to add my self
[2014-04-23 05:01:54 -0400] meth: thanks for help
[2014-04-23 05:13:45 -0400] jameson__: chef-zero :( y u do dis
[2014-04-23 06:48:24 -0400] brucelee_: whats a good iptables cookbook
[2014-04-23 06:48:36 -0400] brucelee_: the one that comes with opscode is only 2 stars :p
[2014-04-23 06:57:42 -0400] coderanger: brucelee_: 1) the stars system is useless 2) http://community.opscode.com/cookbooks/ufw is probably the simplest
[2014-04-23 07:02:59 -0400] double_p: "port"=> "99427" -- heh
[2014-04-23 07:09:21 -0400] brucelee_: coderanger: awesome thanks
[2014-04-23 07:09:41 -0400] brucelee_: coderanger: still there?
[2014-04-23 07:10:36 -0400] coderanger: Vaguely
[2014-04-23 08:37:50 -0400] whysthatso: hey all. i have a workflow question, and i was wondering if anybody could point to a howto or tutorial, or some best practice corner points for that.   atm i am working on a collection of application cookbooks which should follow test/stage/prod cycles. i use git for scm. now, since i started out on a legacy infrastructure project, i recreated current prod in stage, and all the cookbooks are working now. but i now would like to start rewo
[2014-04-23 08:37:50 -0400] whysthatso: rking the infrastructure on the testing stage, adding some functionality and refactoring out some unused stuff. however, i would like to keep the current stage cookbook in its current form for future reference. is it so that i should work with three different real directories according to my environments? or is there a way to do this via git? does any of that make sense so far?
[2014-04-23 08:47:30 -0400] JensOfSweden: whysthatso: just make 3 different branches in your repo(s) like test/stage/prod and then do pullrequests from test -> stage -> prod and have a cronjob/ci server upload the cookbooks to a chef server and have it update the environment if you have cookbook versions in your environments for test/stage/prod perhaps
[2014-04-23 08:51:18 -0400] whysthatso: JensOfSweden: so on my workstation i 'physically' only work on the testing branch, commit it and then pull it over to the next env? i might have still not gotten my head around how this practically goes down
[2014-04-23 08:53:14 -0400] JensOfSweden: whysthatso: if i get you correctly you should only work on your testing branch on your workstation and try it out with vagrant/chefsolo/testkitchen or such. Then when you feel confident you want to stage it. Push it to the stage repo and have a chef server run all the cookbooks on your stage servers, and then same for prod.
[2014-04-23 08:55:31 -0400] whysthatso: okay. that kind of makes sense... how could i push from git to hosted chef?
[2014-04-23 08:56:18 -0400] whysthatso: i haven't worked with a ci server yet, so for the beginning i think i would rely on something more manually
[2014-04-23 08:56:45 -0400] whysthatso: would it be along to lines of pulling into some tmp location and then pushing from there?
[2014-04-23 08:57:45 -0400] JensOfSweden: Havnt worked with a hosted chef, but shoulnt be that hard.
[2014-04-23 08:57:54 -0400] JensOfSweden: Do you use your workstation for everything?
[2014-04-23 08:59:38 -0400] JensOfSweden: I guess its just use knife cookbook upload -a if you have your hosted chef info in the knife.rb file
[2014-04-23 09:00:18 -0400] whysthatso: ja, actually working with berkshelf
[2014-04-23 09:01:22 -0400] JensOfSweden: when you want to push it then just git checkout stage and use knife cookbook upload -a
[2014-04-23 09:01:30 -0400] whysthatso: but yeah, that*s the thing i don't understand about git integration: if locally i only have my testing cookbook, with the version number of testing, then how can i push stage or prod?
[2014-04-23 09:01:38 -0400] whysthatso: ah....
[2014-04-23 09:01:47 -0400] whysthatso: of course
[2014-04-23 09:02:04 -0400] JensOfSweden: you have all the branches on your workstatiion, but when developing you should only be in your testing branch
[2014-04-23 09:02:09 -0400] whysthatso: at that point the real code locally is already as advanced as the environment
[2014-04-23 09:02:45 -0400] whysthatso: puh.... branching - when it comes down to the details - really makes my head burn
[2014-04-23 09:03:03 -0400] JensOfSweden: Youll get it eventualy, its not that hard =)
[2014-04-23 09:03:37 -0400] JensOfSweden: If you realy want to separate the repos with git you should read up on git
[2014-04-23 09:43:22 -0400] srenatus: hmm.  not getting any response to POST https://<os-chef>/environments/<mine>/cookbook_versions but having a spinning erchef beam process...anyone experienced that before?
[2014-04-23 09:49:24 -0400] ghghz: Hey, how to bypass this limit? JSON must be no more than 1000000 bytes
[2014-04-23 09:49:41 -0400] srenatus: ghghz: which json?
[2014-04-23 09:49:45 -0400] srenatus: ghghz: any?
[2014-04-23 09:50:08 -0400] ghghz: am, what do you mean which?
[2014-04-23 09:51:17 -0400] srenatus: ghghz: so a JSON file is supposed to be smaller than 1M bytes?
[2014-04-23 09:51:59 -0400] srenatus: ghghz: I'm missing the context.. I don't suppose this is true universally (is it?)
[2014-04-23 09:52:14 -0400] ghghz: srenatus: wait, I'll post you more details
[2014-04-23 09:52:44 -0400] ghghz: http://pastebin.com/JvvADZNe
[2014-04-23 09:53:43 -0400] srenatus: ghghz: oh. we're talking erchef...
[2014-04-23 09:54:04 -0400] srenatus: ghghz: end of chef-run?  trying to save the node object?
[2014-04-23 09:55:30 -0400] ghghz: you mean why-run mode?
[2014-04-23 09:56:14 -0400] ghghz: chef-client -W wents OK, without any errors/warnings
[2014-04-23 09:56:51 -0400] srenatus: ghghz: I actually asked for some more context on the chef-client side
[2014-04-23 09:57:06 -0400] srenatus: why-run won't node.save, so it could be node.save
[2014-04-23 09:57:17 -0400] srenatus: and it probably is, because where else should there be "much data" to save
[2014-04-23 09:57:44 -0400] ghghz: how to figure out which data to save?
[2014-04-23 09:58:49 -0400] srenatus: ghghz: by default, it will be the entire node object.  there's whitelisting of attributes, but I've never really tried that
[2014-04-23 09:59:02 -0400] srenatus: ghghz: https://github.com/opscode-cookbooks/whitelist-node-attrs
[2014-04-23 09:59:33 -0400] ghghz: srenatus: thank you, going to test
[2014-04-23 10:00:43 -0400] srenatus: ghghz: :)
[2014-04-23 10:11:51 -0400] gokr: I am getting failures on "knife upload mycookbook" and yes, it has large files. Some broken pipe or something.
[2014-04-23 10:14:16 -0400] subraminion: Hi, I have a requirement where I need to recompile kernel and reboot the server
[2014-04-23 10:14:37 -0400] subraminion: how can the chef cookbook continue to work through a reboot?
[2014-04-23 10:20:26 -0400] workmad3: subraminion: it can't... there are a couple of options you can do - 1. delay triggering the restart until the end of the chef run, 2. save the node state with 'node.save' at the point you need to restart and set up chef-client to run again after the restart to redo the converge (and this time not restart)
[2014-04-23 10:21:00 -0400] subraminion: delay might be the key that works for me.. Why didn't I think of it in the first place??
[2014-04-23 10:21:02 -0400] subraminion: Please kick me
[2014-04-23 10:22:15 -0400] gokr: Arghh.... anyone has a trick for large files? I have a 400Mb file that I have in a cookbook and now I can't upload it to our chef server, sigh.
[2014-04-23 10:23:40 -0400] subraminion: Why not make a dropbox link and call it in attributes?
[2014-04-23 10:24:14 -0400] gokr: The file needs to be secure - I can't just put it on a public URL
[2014-04-23 10:30:31 -0400] mc_fail: hi guys, if i'm using a notifies directive in cookbook_file section, it will do something only if file on host is different than file in chef?
[2014-04-23 10:30:48 -0400] mc_fail: i'm right?
[2014-04-23 11:01:22 -0400] ghghz: srenatus: whitelist attr solved my problem
[2014-04-23 11:01:28 -0400] ghghz: thank you
[2014-04-23 12:52:50 -0400] brianwebb01: anyone know of a good job board to post chef jobs?  We're looking for a senior devops engineer.
[2014-04-23 12:57:26 -0400] zeroXten: hi. just having a play around with Chef Development Kit... should I expect test-kitchen to work out of the box in a chef generate'd cookbook? doesn't seem to find the vagrant driver
[2014-04-23 12:57:44 -0400] zeroXten: and generate doesn't seem to create a gemfile to bundle isntall
[2014-04-23 12:58:36 -0400] whiteadam: zerxten: meh, nah
[2014-04-23 12:59:15 -0400] whiteadam: zeroXten: I think I would recommend following something like this: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-04-23 12:59:46 -0400] whiteadam: It's probably the most helpful thing you'll find for writing cookbooks properly... and it goes through test-kitchen and vagrant
[2014-04-23 13:01:35 -0400] aujt74: Hi everyone, what would be the Chef way to change permissions on a unix socket? The File resource fails with "File ... exists, but is a socket, set force_unlink to true to remove". Is my only option falling back to FileUtils::chown in a ruby block with a not_if guard? Thanks!
[2014-04-23 13:01:46 -0400] zeroXten: whiteadam: thanks, but that is currently how i'm doing it :)
[2014-04-23 13:02:08 -0400] zeroXten: we've got a new starter here and I was hoping CDK would make getting him set up a bit simpler
[2014-04-23 13:02:28 -0400] sarkis: hey all, should include_recipe work exactly as adding recipe[] to the run_list?
[2014-04-23 13:02:37 -0400] whiteadam: zeroXten: Ah, not sure. That link definitely helped me the most.
[2014-04-23 13:16:54 -0400] subraminion: I am trying to give a custom delay to one of my code block like this:
[2014-04-23 13:16:55 -0400] subraminion: notifies :run, "execute[install_openswan]", :delayed => 600
[2014-04-23 13:17:33 -0400] subraminion: It gives me invalid timing error
[2014-04-23 13:17:48 -0400] subraminion: can any body tell me how I can give a delay of 10 minutes or so?
[2014-04-23 13:18:06 -0400] aujt74: (Nevermind about the socket, approached the problem from a different angle :)
[2014-04-23 13:22:15 -0400] whiteadam: subraminion: I know ruby has a sleep method
[2014-04-23 13:22:46 -0400] bixu: subraminion: Are you configuring a host as an openswan vpn endpoint?
[2014-04-23 13:23:15 -0400] bixu: If 'yes', have you seen https://github.com/wanelo-chef/openswan ?
[2014-04-23 13:24:18 -0400] sarkis: jtimberman: is logrotate cookbook supposed to be supported
[2014-04-23 13:24:29 -0400] whiteadam: subraminion: there's also retry_delay:
[2014-04-23 13:25:24 -0400] subraminion: @whiteadam and I suppose the syntax would be the same for that too right? Like retry_delay => VALUE
[2014-04-23 13:28:01 -0400] whiteadam: subraminion: yeah
[2014-04-23 13:28:19 -0400] whiteadam: subraminion: http://docs.opscode.com/chef/resources.html under Attributes
[2014-04-23 13:55:17 -0400] sarkis: so, what do you guys do to setup a vagrant box for testing chef with? i'm doing some hacky stuff right now like: knife solo cook vagrant@`vagrant ssh-config | sed -n 's/.*HostName \(.*\)/\1/p'` -p `vagrant ssh-config | sed -n 's/.*Port \(.*\)/\1/p'` -i `vagrant ssh-config | sed -n 's/.*IdentityFile \(.*\)/\1/p'`
[2014-04-23 13:57:47 -0400] zeroXten: sarkis: I use test-kitchen...
[2014-04-23 14:03:42 -0400] whiteadam: Anyone have good article recommendations for writing tests for cookbooks?
[2014-04-23 14:06:06 -0400] zanshin: http://kitchen.ci and click on the "Get Started" button?
[2014-04-23 14:06:08 -0400] gnagno: hello all
[2014-04-23 14:06:34 -0400] gnagno: can someone please tell me how can I debug my recipe with pry? I am using vagrant
[2014-04-23 14:07:11 -0400] whiteadam: zanshin: hah, yeah, that's what I'm reading now :)
[2014-04-23 14:09:59 -0400] zanshin: whiteadam: There's this: https://engineering.aweber.com/test-driven-chef-cookbooks-with-test-kitchen/
[2014-04-23 14:10:33 -0400] whiteadam: zanshin: oooh thanks
[2014-04-23 14:11:11 -0400] zanshin: whiteadam: And I highly recommend this book: http://shop.oreilly.com/product/0636920030973.do
[2014-04-23 14:11:52 -0400] whiteadam: zanshin: I actually read through that one. I think the principles and philosophy were very helpful.
[2014-04-23 14:13:35 -0400] gnagno: can someone please tell me how I can make pry work for debugging a chef recipe?
[2014-04-23 14:14:53 -0400] sarkis: zeroXten: hmm interesting is that the community recommended way now?
[2014-04-23 14:15:07 -0400] sarkis: i think berkshelf kind of pushes us in this direction as of 3.x as well right?
[2014-04-23 14:15:20 -0400] zanshin: whiteadam: I've only gotten part way through it. Need to polish it off and put it to good use.
[2014-04-23 14:15:52 -0400] whiteadam: zanshin: Yeah, after half-way it gets a little dicey. Some of the commands have changed and repos haven't been updated.
[2014-04-23 14:43:52 -0400] sarkis: im trying to override the attributes here: https://github.com/RiotGames/rbenv-cookbook#rbenv
[2014-04-23 14:44:06 -0400] sarkis: i do this in my attributes/default.rb :   default['rbenv
[2014-04-23 14:44:44 -0400] sarkis: oops... default['rbenv']['install_path'] = '/usr/local', but it's not getting picked up and still installs in /opt
[2014-04-23 14:44:51 -0400] sarkis: what am i doing wrong?
[2014-04-23 14:45:49 -0400] juliancdunn: sarkis: which attributes/default.rb are you changing that in? your own cookbook?
[2014-04-23 14:47:08 -0400] sarkis: yes the application cookbook
[2014-04-23 14:47:34 -0400] sarkis: where the recipe exists that calls the include_recipe rbenv::default
[2014-04-23 14:48:17 -0400] sarkis: oh wait a minute
[2014-04-23 14:48:40 -0400] sarkis: ok yea i said install_path in here but i really have the proper 'install_prefix'
[2014-04-23 14:49:38 -0400] sarkis: ah i see the problem i think
[2014-04-23 14:49:53 -0400] sarkis: default[:rbenv][:install_prefix] = "/opt"
[2014-04-23 14:50:10 -0400] sarkis: im doing default['rbenv']['install_prefix']
[2014-04-23 14:50:19 -0400] sarkis: symbols vs string
[2014-04-23 14:52:18 -0400] juliancdunn: that shouldn't matter as Chef coerces everything to a string internally
[2014-04-23 14:54:17 -0400] sarkis: trying it now to see
[2014-04-23 14:55:31 -0400] zts: sarkis: you will need to override node[:rbenv][:root_path] as well as node[:rbenv][:install_prefix]
[2014-04-23 14:56:28 -0400] zts: oh wait, you said you were doing it in your attributes file.  I may be wrong.
[2014-04-23 15:00:13 -0400] sarkis: i think you are right
[2014-04-23 15:00:15 -0400] sarkis: default[:rbenv][:root_path]      = "#{node[:rbenv][:install_prefix]}/rbenv"
[2014-04-23 15:00:50 -0400] sarkis: i think that gets set and then it never uses my override
[2014-04-23 15:00:52 -0400] sarkis: strange
[2014-04-23 15:01:01 -0400] zts: The issue is that you need to have your override to :install_prefix in place before that's evaluated
[2014-04-23 15:01:07 -0400] sarkis: yea
[2014-04-23 15:01:15 -0400] sarkis: makes sense, thanks for catching that :)
[2014-04-23 15:01:19 -0400] sarkis: saved me a lot of time
[2014-04-23 15:02:10 -0400] zts: No problem, it's a common issue when working with wrapper cookbooks.  If you override that attribute in a role or environment, it should Just Work - I'm not sure what the "best practice" pattern is for doing the same with wrapper cookbooks
[2014-04-23 15:16:05 -0400] zeroXten: sarkis: i guess so, i wasn't at chefconf so not sure what was said :)
[2014-04-23 15:17:32 -0400] supa_: So I'm stuck in berks hell on a pre-existing project.  Basically, I keep getting dependency issues starting with yum::epel (yum3 vs yum2).  What should have been done to avoid this?  Locking the yum version < 3 isn't the answer, as other cookbooks fail all over the place.
[2014-04-23 15:24:04 -0400] zts: supa_: the official answer seemed to be to lock yum version < 3 until updates are available to every cookbook, then upgrade
[2014-04-23 15:24:51 -0400] supa_: zts: Ya... I'm still having a lot of trouble with an older project. :\
[2014-04-23 15:24:53 -0400] supa_: hm
[2014-04-23 15:25:13 -0400] zts: supa_: if you can't update the cookbooks with the yum 2 dependency, I'd suggest keeping a local fork of the yum 3 cookbook which adds the ::epel recipe back in (you could just do include_recipe "yum-epel")
[2014-04-23 15:26:25 -0400] supa_: Oh, that might be worth a try.  Thanks, I'll check it out.
[2014-04-23 15:36:56 -0400] holms: anybody installed python2.7 in virtualenv on centos 6.5 with any chef cookbook?
[2014-04-23 15:42:06 -0400] Neozonz: anyone have any best practises for applying os security updates via chef?
[2014-04-23 15:47:32 -0400] zeroXten: Neozonz: best practices? like what? other than.. DO IT :)
[2014-04-23 15:47:42 -0400] Neozonz: lol
[2014-04-23 15:50:27 -0400] juliancdunn: I don't recommend that you do it in Chef, unless you just want to run 'yum -y update'
[2014-04-23 15:51:16 -0400] supa_: Neozonz: EL/rpm ?
[2014-04-23 15:51:24 -0400] Neozonz: apt
[2014-04-23 15:53:10 -0400] supa_: Neozonz: Too bad.  You'd have the options of Katello, Spacewalk and (eek!) RHN/Satellite in EL land.
[2014-04-23 15:53:25 -0400] Neozonz: hmm
[2014-04-23 15:53:31 -0400] Neozonz: think i found my answer
[2014-04-23 15:53:38 -0400] Neozonz: https://help.ubuntu.com/12.04/serverguide/automatic-updates.html
[2014-04-23 15:53:39 -0400] juliancdunn: there's Canonical Landscape if you want to pay the money, or Spacewalk also allegedly supports Debian
[2014-04-23 15:53:57 -0400] juliancdunn: also vFense is working on an OSS patch management solution - vfense.org
[2014-04-23 15:54:04 -0400] supa_: semi-supports debian... :\
[2014-04-23 15:54:18 -0400] juliancdunn: I said "allegedly" :-)
[2014-04-23 15:54:52 -0400] supa_: Neozonz: The other option is that since chef is so great at continuous delivery, you can just rebuild your server every 15 days with all the newest OS updates. :)
[2014-04-23 15:55:03 -0400] Neozonz: aha
[2014-04-23 15:55:05 -0400] Neozonz: yeah
[2014-04-23 15:55:06 -0400] Neozonz: true enough
[2014-04-23 16:10:02 -0400] coredump: So, what can cause errors like this using test-kitchen: Could not satisfy version constraints for: build-essential
[2014-04-23 16:10:16 -0400] coredump: berks install works fine, I don't know why it fails on the VM
[2014-04-23 16:10:54 -0400] stormerider: coredump: sounds like cookbook environment pinning issues or the like
[2014-04-23 16:12:00 -0400] sarkis: guys, any good screencasts or tutorials on berkshelf + test kitchen
[2014-04-23 16:12:11 -0400] coredump: chef-zero must be doing something wrong
[2014-04-23 16:12:26 -0400] sarkis: i need something to do during my flight :P
[2014-04-23 16:12:36 -0400] sarkis: i couldn't find any up to date books..
[2014-04-23 16:12:50 -0400] sarkis: i guess the oreilly test driven chef
[2014-04-23 16:12:55 -0400] Neozonz: how do I reference a recipie within a cookbook/recipe folder?
[2014-04-23 16:13:06 -0400] sarkis: include_recipe
[2014-04-23 16:13:08 -0400] Neozonz: include_recipe "recipename"
[2014-04-23 16:13:09 -0400] Neozonz: right
[2014-04-23 16:13:35 -0400] Neozonz: do I have to define the cookbook name before?
[2014-04-23 16:13:42 -0400] Neozonz: ie cookbook::recipename
[2014-04-23 16:14:03 -0400] sarkis: yes
[2014-04-23 16:14:05 -0400] jeffcara: sarkis: Fletcher had a decent presentation from chef-conf on Test-kitchen this year. Lot of small tips and tricks to it. Have to have basic understanding of both though to use it
[2014-04-23 16:14:10 -0400] sarkis: include_recipe "cookbook::recipe"
[2014-04-23 16:14:19 -0400] Neozonz: ah
[2014-04-23 16:14:26 -0400] Neozonz: ok no such thing as relative pathing i guess
[2014-04-23 16:14:27 -0400] Neozonz: cook thanks
[2014-04-23 16:14:29 -0400] sarkis: Neozonz: if you don't  say ::this it assumes ::default i believe
[2014-04-23 16:15:02 -0400] Neozonz: default being?
[2014-04-23 16:15:05 -0400] Neozonz: the current cookbook?
[2014-04-23 16:15:13 -0400] Neozonz: or the default cookbook?
[2014-04-23 16:17:03 -0400] stormerider: Neozonz: no, you can leave off the recipe and it will use the default recipe, but you have to specify the cookbook name always.
[2014-04-23 16:17:44 -0400] Neozonz: how about if you wanted to include custom_recipe within default.rb
[2014-04-23 16:18:06 -0400] Neozonz: include_recipe "cookbookname::custom_recipe"  << inside default.rb
[2014-04-23 16:18:56 -0400] zts: you could do - include_recipe "#{cookbook_name}::custom_recipe" - but you might as well just be explicit, and write the name of your cookbook there
[2014-04-23 16:26:12 -0400] bricker`LA: I am getting 404 Not Found when chef tries to install curl, but when I login and run `sudo apt-get install curl` it works fine. What do I need to do to fix this? The code that installs it is just `package 'curl'`
[2014-04-23 16:26:28 -0400] coredump: should not data bags be available if I create the test/integration/default/data_bags dir?
[2014-04-23 16:28:39 -0400] bxraabe: coredump: does your test kitchen suite has the data_bags_path defined?
[2014-04-23 16:28:51 -0400] coredump: uhhh
[2014-04-23 16:29:19 -0400] bxraabe: coredump: or are you using test kitchen? lol
[2014-04-23 16:29:27 -0400] coredump: I am
[2014-04-23 16:29:55 -0400] coredump: nvm it's probably yhat.
[2014-04-23 16:30:23 -0400] bxraabe: coredump: you should have a .kitchen.yml file with a list of suites, in the default suite make sure you define 'data_bags_path'
[2014-04-23 16:30:24 -0400] Neozonz: cool thanks boys
[2014-04-23 16:31:12 -0400] coredump: bxraabe thanks, I think that will fix it
[2014-04-23 16:33:01 -0400] montjoy: has anyone gotten custom client.rb settings to work when using test-kitchen/chef-zero/vagrant?
[2014-04-23 16:33:24 -0400] montjoy: Trying to disable an ohai plugin
[2014-04-23 16:35:10 -0400] kiarie: hi can i get some helpp on something?
[2014-04-23 16:37:13 -0400] kiarie: anyone?
[2014-04-23 16:37:53 -0400] bxraabe: kiarie: what do you need help with?
[2014-04-23 16:38:43 -0400] kiarie: i know chef is mainly for setting up servers but can it be used to setup personal pc's of an organization that are all installed the same software?
[2014-04-23 16:39:01 -0400] bricker`LA: kiarie: Vagrant is a better tool for that
[2014-04-23 16:39:42 -0400] kiarie: Thanks bricker let me sign up for Vagrant
[2014-04-23 16:39:55 -0400] bxraabe: kiarie: it seems like it could be done
[2014-04-23 16:40:22 -0400] kiarie: bxraabe do you mean it can be done using chef or Vagrant?
[2014-04-23 16:40:32 -0400] bxraabe: kiarie: with chef
[2014-04-23 16:40:58 -0400] kiarie: any links or tutorials or anything you could point me to?
[2014-04-23 16:41:10 -0400] bxraabe: vagrant is a tool to provision virual machines
[2014-04-23 16:41:21 -0400] thom: kiarie: http://jtimberman.housepub.org/blog/2012/07/29/os-x-workstation-management-with-chef/
[2014-04-23 16:41:47 -0400] thom: kiarie: that blog post is a good starting point, and at the bottom there're a bunch of links to other similar approaches
[2014-04-23 16:43:04 -0400] kiarie: thom , much appreciated. got any for windows?
[2014-04-23 16:45:20 -0400] thom: kiarie: not that i know of, sorry - seems like the pivotal stuff might be a good starting point tho
[2014-04-23 16:45:31 -0400] montjoy: has anyone been able to disable ohai plugins in .kitchen.yml ?
[2014-04-23 16:46:14 -0400] kiarie: yeah thom , i think once i get the basic i will know how to manage with windows. windows can't be that hard :)
[2014-04-23 16:46:56 -0400] montjoy: or any other way when using test-kitchen?
[2014-04-23 16:48:12 -0400] kiarie: hey, can i have a chef server on linux working with windows based nodes?
[2014-04-23 16:49:22 -0400] bxraabe: montjoy: it looks like the zero provisioner has a `client_rb` attribute
[2014-04-23 16:51:02 -0400] montjoy: bxraabe: yeah, I'm trying to use it.  It writes to /tmp/kitchen/client.rb but my plugin still runs
[2014-04-23 16:51:36 -0400] montjoy: bxraabe: if I do a manual run of 'ohai -d /tmp/kitchen' it works
[2014-04-23 16:51:44 -0400] montjoy: pulling my hair out
[2014-04-23 16:52:50 -0400] montjoy: I guess I'll submit a bug request
[2014-04-23 16:53:48 -0400] sarkis: how do u guys handle newrelic in your development vagrant instances
[2014-04-23 16:54:29 -0400] sarkis: its sending data to prod newrelic.. :(
[2014-04-23 16:54:51 -0400] bxraabe: montjoy: are you using the `require_chef_omnibus` directive?
[2014-04-23 16:55:32 -0400] Neozonz: for cookbook_file   it uses the default folder under files right?
[2014-04-23 16:55:32 -0400] bxraabe: sarkis: we have different configs per environment, so we use the config that corresponds the the node.chef_environment
[2014-04-23 16:55:42 -0400] montjoy: bxraabe: not sure.  where is that set?
[2014-04-23 16:55:46 -0400] Neozonz: how does one allow other folders and how does one specify them within chef?
[2014-04-23 16:56:02 -0400] Neozonz: ie files/customfldr/file.txt
[2014-04-23 16:56:15 -0400] sarkis: bxraabe: i see, is there a way to make sure that newrelic actually works and not send any data?
[2014-04-23 16:56:33 -0400] sarkis: i assume in the dev configs you just set enabled to false or something?
[2014-04-23 16:56:56 -0400] bxraabe: Neozonz: in your `source` definition, just append a folder path before the name of the file
[2014-04-23 16:57:01 -0400] whiteadam: So if I'm mostly making wrapper-cookbooks, what's the best way to test? Should I just make my own tests using guidance from the tests in the original cookbook or...
[2014-04-23 16:58:05 -0400] programmerq: whiteadam: depends on what types of tests you're interested in.
[2014-04-23 16:58:13 -0400] whiteadam: programmerq: the sexy kind
[2014-04-23 16:58:23 -0400] bxraabe: montjoy: it would be in your kitchen.yml, if you're not using it then that squashes my theory
[2014-04-23 16:58:28 -0400] programmerq: if you want to do unit testing, I'd say test that your tests should just test that your cookbooks call the upstream cookbooks properly
[2014-04-23 16:58:36 -0400] programmerq: include_recipe, propery attribute setting, etc
[2014-04-23 16:58:48 -0400] Neozonz: bxraabe, cool, any difference between templates and cookbook_file
[2014-04-23 16:58:57 -0400] programmerq: if you're doing integration tests (like with test kitchen), tast that the package is installed, or whatever
[2014-04-23 16:59:03 -0400] montjoy: bxraabe: not in my .kitchen.yml.  Looks like I'm loading the vagrant-omnibus plugin with vagrant tho
[2014-04-23 16:59:23 -0400] bxraabe: sarkis: that is definitely an option
[2014-04-23 16:59:36 -0400] bxraabe: Neozonz: I don't believe so, same idea
[2014-04-23 16:59:42 -0400] whiteadam: programmerq: yeah, just got started with kitchen and the thought was on my mind. Right now I'll probably just check that they're installed and using the proper attributes.
[2014-04-23 17:00:59 -0400] bxraabe: montjoy: kitchen should generate a Vagrant file, if that's your provisioner. Are you using a custom vagrant file?
[2014-04-23 17:01:14 -0400] Neozonz: bxraabe, cook thanks
[2014-04-23 17:01:25 -0400] bencaron: stupid berkshelf 3 question: if i want to use my local chef server for my local cookbook, I really need to setup a berks api server?
[2014-04-23 17:02:30 -0400] mannyt: bencaron for the time being it seems like it
[2014-04-23 17:02:46 -0400] montjoy: :bxraabe i've only generated one with vagrant init.  Might have deleted the kitchen one a long time ago
[2014-04-23 17:02:53 -0400] bencaron: it does make upgrading kinda involve :/
[2014-04-23 17:03:22 -0400] bencaron: mannyt: thx for your confirmation
[2014-04-23 17:03:30 -0400] bxraabe: montjoy: it does it on-the-fly for you
[2014-04-23 17:03:43 -0400] mannyt: Setting up a berks-api server is actually really trivial, there are cookbooks that do it out there already
[2014-04-23 17:03:52 -0400] montjoy: :bxraabe nope it's not doing that
[2014-04-23 17:04:13 -0400] bencaron: whats the pattern: run one locally for each dev(ops) or a central version?
[2014-04-23 17:04:22 -0400] mannyt: You can also run berks-api server locally and have berkshelf look at that but that approach stinks if you are on a team with other people
[2014-04-23 17:05:17 -0400] bencaron: ok, it's best to have this as a central artefact server
[2014-04-23 17:05:27 -0400] bencaron: but why do this instead of using the chef server?
[2014-04-23 17:06:01 -0400] montjoy: bxraabe: I have my VAGRANT_HOME env. variable set.  would that interfere?
[2014-04-23 17:06:03 -0400] mannyt: bencaron We set up a server that just sits in front of our chef server
[2014-04-23 17:07:04 -0400] mannyt: I think this model is to prepare for the future supermarket and the berkshelf-api server may not be necessary in future versions of chef server.  Berkshelf3+ will be able to pull directly from the chef server as a source
[2014-04-23 17:07:24 -0400] bencaron: like berks2 can already do...
[2014-04-23 17:07:29 -0400] jidar: heh
[2014-04-23 17:07:44 -0400] bxraabe: montjoy: that's a good thought, you could try unsetting it
[2014-04-23 17:07:49 -0400] mannyt: In Berkshelf3 you can just list multiple sources in the Berksfile but they an be any source
[2014-04-23 17:07:54 -0400] bencaron: mannyt: the goal being to share some code I guess?
[2014-04-23 17:08:33 -0400] mannyt: goal being to have a better system to pass around cookbooks, berks2 does it but it does a lot of magic to figure out dpendencies
[2014-04-23 17:08:53 -0400] bencaron: mannyt: when moving from berks2 to 3, did you have to make a hard "cut" between the two?
[2014-04-23 17:09:04 -0400] bencaron: I mean, Berksfile have to be modified
[2014-04-23 17:09:25 -0400] mannyt: the berks-api server handles building out the graph to make the work of the berks client easier
[2014-04-23 17:09:25 -0400] bencaron: just trying to figure the effort that involve
[2014-04-23 17:10:23 -0400] mannyt: bencaron it wasn't too bad but we actually have a method that wraps the cookbook method in our Berksfile and we have a require at the top of the Berksfile that loads it
[2014-04-23 17:10:24 -0400] montjoy: :bxraabe no dice
[2014-04-23 17:10:33 -0400] mannyt: So most of the changes happened in one place
[2014-04-23 17:10:49 -0400] bxraabe: can you paste a link to your kitchen.yml?
[2014-04-23 17:11:08 -0400] mannyt: we still had to go through each cookbook and make a couple of changes but once we had the berks-api server up it wasn't difficult
[2014-04-23 17:11:28 -0400] montjoy: sure
[2014-04-23 17:12:00 -0400] bencaron: mannyt: so you wrapped every call in the berksfile. nice idea
[2014-04-23 17:12:01 -0400] mannyt: so bencaron yes we essentially did a hard cut
[2014-04-23 17:12:20 -0400] mannyt: yea seth vargo mentioned it in his blog and we ran with it
[2014-04-23 17:12:27 -0400] bencaron: ok, so that just mean I can't start this in my corner for a proof-of-concept
[2014-04-23 17:12:35 -0400] montjoy: http://pastebin.com/e0rC6i2b
[2014-04-23 17:12:44 -0400] mannyt: bencaron https://sethvargo.com/berksfile-magic/
[2014-04-23 17:13:12 -0400] mannyt: bencaron I and a coworker created branches in 2 cookbooks and in our chef repo and started there
[2014-04-23 17:13:19 -0400] montjoy: bxraabe: also note i'm using the vmware_workstation vagrant plugin
[2014-04-23 17:13:20 -0400] bencaron: just found it :)
[2014-04-23 17:13:33 -0400] mannyt: we tested and tweaked and once we had a process we trained the team and made the change
[2014-04-23 17:14:19 -0400] bencaron: really like the suggestions I see to make the thing more future/change proof
[2014-04-23 17:14:23 -0400] bxraabe: montjoy: try this http://pastebin.com/S3DyykCV
[2014-04-23 17:14:51 -0400] bencaron: what,s cool about Chef is that moves fast. What sucks about chef is that it moves fast...
[2014-04-23 17:14:59 -0400] mannyt: Yea man I am really excited about where cookbooks and berkshelf is going
[2014-04-23 17:15:20 -0400] mannyt: Ha I know exactly how you feel, Chef keeps it interesting
[2014-04-23 17:15:34 -0400] bencaron: yeah. :)
[2014-04-23 17:15:43 -0400] bencaron: love where test-kitchen and metal is going
[2014-04-23 17:15:53 -0400] mannyt: Its so sick
[2014-04-23 17:16:03 -0400] bencaron: but for berkshelf, I'm stuck at the "confused" stage
[2014-04-23 17:16:13 -0400] mannyt: I don't know if you saw but someone made kitchen-metal already
[2014-04-23 17:16:20 -0400] dustbones: Hi, I am struggling understanding Berkshelf:   why would I need this?  Is it install under every server where I have chef-client?
[2014-04-23 17:16:30 -0400] bencaron: yes, awesome
[2014-04-23 17:16:35 -0400] dustbones: I read that it manages the dependencies
[2014-04-23 17:16:53 -0400] bencaron: most of our stuf runs on vmware/vsphere tho
[2014-04-23 17:17:07 -0400] dustbones: bencaron: Do you know why the use of Berkshelf?
[2014-04-23 17:17:18 -0400] bencaron: I guess I'll have to give a try at porting it
[2014-04-23 17:17:33 -0400] bencaron: dustbones: you mean the api server, or the whole berkshelf?
[2014-04-23 17:17:34 -0400] mannyt: bencaron get a berks-api sever running even if its on your laptop and just start with berks3 in a branch, its the only way its going to make sense.  I spent way too long reading before I started it and it was a mistake
[2014-04-23 17:18:09 -0400] montjoy: bxraabe: doesn't like it
[2014-04-23 17:18:15 -0400] montjoy: bxraabe: FATAL: Configuration error SyntaxError: /tmp/kitchen/client.rb:16: syntax error, unexpected tIDENTIFIER, expecting $end
[2014-04-23 17:18:15 -0400] montjoy:        ohai "{:disabled_plugins=>["passwd"]}"
[2014-04-23 17:18:54 -0400] dustbones: bencaron: the whole Berkshelf:  I don't quite see why Berkshelf when I can do things with the standard Metafile from chef.  What is that Berkshelf buys me?  And is this needed on every node, or only on the chef-workstation?
[2014-04-23 17:19:19 -0400] dustbones: I am reading bits and pieces, but nothing seems conclusive
[2014-04-23 17:19:19 -0400] bencaron: mannyt: and 1st thing I'll do is vendor everything, cause rvm and chef-dk dont always play nice
[2014-04-23 17:19:26 -0400] mannyt: dustbones berkshelf is mainly for development and testing dependencies, in production your environment + chef-server dictate versions
[2014-04-23 17:19:30 -0400] dustbones: Not like chef - this really worked.
[2014-04-23 17:19:43 -0400] jidar: can somebody explain to me why I can't write out a proper .kitchen.yml file? I keep getting parsing errors, is it tabs or spaces after the 'driver' section?
[2014-04-23 17:19:49 -0400] mannyt: bencaron abso ... lutely
[2014-04-23 17:19:51 -0400] bencaron: dustbones: it became a _must_ when we started being more than 2 dev
[2014-04-23 17:20:00 -0400] montjoy: bxraabe: last line in client.rb with that is 'ohai "{:disabled_plugins=>["passwd"]}"' with no newline
[2014-04-23 17:20:30 -0400] montjoy: old way has correct format according to http://stevendanna.github.io/blog/2013/04/13/passwd-min-ohai-plugin/
[2014-04-23 17:20:42 -0400] bxraabe: montjoy: that's interesting. ok, give me a min
[2014-04-23 17:20:46 -0400] mannyt: I made everyone start moving to vendored gems for everything chef related
[2014-04-23 17:21:07 -0400] jeffcara: @jidar: if you find a solution let me know. I have to copy/paste from working files
[2014-04-23 17:21:31 -0400] jidar: jeffcara: I'm dying here because of this crap
[2014-04-23 17:21:33 -0400] mannyt: Even tho we do have one cookbook per repo we do still drop them all into the chef/cookbooks dir and maintain a repo with the top level chef stuff.  This is where we store the Gemfile
[2014-04-23 17:21:43 -0400] montjoy: bxraabe: both ways do not put a newline at the end of client.rb if that matters
[2014-04-23 17:22:06 -0400] bencaron: you git clone them directly in .../chef/cookbooks?
[2014-04-23 17:22:09 -0400] dustbones: mannyt: & bencaron: I am the only guy doing chef - so I guess that Berkshelf will have little usage for me?
[2014-04-23 17:22:23 -0400] dustbones: I also use git, so all my cookbooks, templates, and recipes are there
[2014-04-23 17:22:40 -0400] bencaron: dustbones: it does even alone because it allow you to track your dependancies
[2014-04-23 17:23:04 -0400] bencaron: but it does follow the pattern of one-cookbook-one-repo
[2014-04-23 17:23:40 -0400] jeffcara: @jidar: Agreed. yaml has not been my friend. Even when I type the exact same thing from copy/paste it doesn't always work. I can get shared directories to work though!
[2014-04-23 17:23:52 -0400] dustbones: OK - I guess I have to dig further see if this clicks at some point - thanks.
[2014-04-23 17:27:55 -0400] bxraabe: montjoy: since you're using the chef-client cookbook, it looks like you can hook into the attributes to disable plugins -- http://docs.opscode.com/config_yml_kitchen.html#client-rb-specific-settings
[2014-04-23 17:28:22 -0400] montjoy: bxraabe: yeah I tried that too.  refused to work
[2014-04-23 17:28:44 -0400] montjoy: bxraabe: it would never write to /tmp/kitchen/config.rb
[2014-04-23 17:31:17 -0400] montjoy: bxraabe: http://pastebin.com/FeyR7pqW
[2014-04-23 17:40:54 -0400] gonzolively: When issuing "vagrant up" I am getting "uninitialized constant Chef::Provider::Package::Apt" My environment was working perfectly last week, not sure what has happened since.  I have the stacktrace, gems, vagrant version, etc on pastebin http://pastebin.com/t0cttGuP
[2014-04-23 17:41:24 -0400] gonzolively: I realize this may be a Vagrant issue, however no one in the vagrant community seems to have the answer,
[2014-04-23 17:42:16 -0400] Neozonz: does source by default point to /files/?
[2014-04-23 17:43:05 -0400] montjoy: I submitted a request.  yay.  https://github.com/test-kitchen/test-kitchen/issues/415
[2014-04-23 17:44:01 -0400] bxraabe: montjoy: I'm afraid I'm out of suggestions. I don't think kitchen has a built-in way to interact with ohai through the client.rb file
[2014-04-23 17:44:32 -0400] jeffcara: does anybody have an ark cookbook that can install from local binaries handy? I'm no ruby guy so have to ask
[2014-04-23 17:44:56 -0400] montjoy: bxraabe: Yeah I'm out of ideas at this point.  I submitted an issue, we'll see how it goes
[2014-04-23 17:45:30 -0400] montjoy: bxraabe: Thanks so much for trying to help!
[2014-04-23 17:46:28 -0400] montjoy: guess I could try submitting an issue to the chef-client folks too
[2014-04-23 17:46:38 -0400] bxraabe: montjoy: if what you were originally doing was not working, the only other way I could think of trying would be like this: http://pastebin.com/JSxxH8QX
[2014-04-23 17:47:34 -0400] bxraabe: which is ugly
[2014-04-23 17:48:43 -0400] montjoy: bxraabe:  nope/doesn't work either. :(  'eval "Ohai::Config[:disabled_plugins] = ["passwd"]"'
[2014-04-23 17:48:57 -0400] montjoy: literally in client.rb
[2014-04-23 17:53:36 -0400] bxraabe: bummer, sorry I couldn't help you
[2014-04-23 17:54:38 -0400] bricker: Why would the 'package' resource be trying to download a version of curl that doesn't exist?
[2014-04-23 17:58:37 -0400] mondo: I have two Chef servers, basically one on our internal network and one in the DMZ.  I want to keep the cookbooks, roles, data bags, etc. all in sync.  Any suggestions?  Should I just cluster the servers instead?  Network security forces me to have the two servers, so I can't just have the DMZ nodes talk to the internal server.
[2014-04-23 17:59:47 -0400] atomic-penguin: mondo, can you have a CI server deploy to both servers?
[2014-04-23 18:00:39 -0400] mondo: atomic-penguin: I might need to go that route
[2014-04-23 18:02:06 -0400] loki_97123: sorry
[2014-04-23 18:08:32 -0400] drogoh: mondo: what about grocery delivery? https://github.com/facebook/chef-utils
[2014-04-23 18:13:23 -0400] zanshin: Berkshelf question: if cookbook Foo depends upon cookbook Bar, and Bar in turn depends upon Snafu, do I need to list Snafu in the Berksfile for cookbook Foo?
[2014-04-23 18:13:25 -0400] mondo: thanks drogoh, that's a pretty good starting point.  I'll have to add support for data bags, but otherwise this looks pretty nice.
[2014-04-23 18:13:45 -0400] drogoh: good stuff :)
[2014-04-23 18:14:58 -0400] alexbst: zanshin - Berkself works out the dependency tree - you should only list the bar in foo and the snafu in bar.
[2014-04-23 18:15:09 -0400] alexbst: via metadata or the Berksfile
[2014-04-23 18:16:19 -0400] tscanausa: is there a way to target a cookbook version to a specific node?
[2014-04-23 18:17:20 -0400] zanshin: alexbst, that's what I thought, but I keep getting cookbook "snafu" not found in any of the sources" message. Something's borked here
[2014-04-23 18:18:34 -0400] alexbst: zanshin - you may want to check berks works in the bar cookbook.
[2014-04-23 18:19:22 -0400] alexbst: Berksfile entries are needed for custom/local cookbook refs like git or local paths
[2014-04-23 18:19:38 -0400] alexbst: the community deps should be listed in the metadata.rb
[2014-04-23 18:20:56 -0400] zanshin: alexbst: I've got `cookbook 'snafu', github: 'org-name/snafu', protocol: :ssh` in Bar's Berksfile. And `vagrant up` successfully brings up a VM for Bar.
[2014-04-23 18:21:47 -0400] alexbst: does foo have a similar entry for bar ?
[2014-04-23 18:22:40 -0400] zanshin: Similar, but not identical. Using ` path: '/Users/.` to grab the local still under development copy of Bar
[2014-04-23 18:24:00 -0400] alexbst: zanshin - if you run berks or berks update in foo, you should see the tree and refs in its Berksfile.lock
[2014-04-23 18:24:39 -0400] xorl: This is irritating
[2014-04-23 18:27:03 -0400] zanshin: So `berks` lists some of the dependencies and then says "Cookbook snafu not found in any of the default locations"
[2014-04-23 18:27:13 -0400] zanshin: When run from Foo
[2014-04-23 18:28:59 -0400] montjoy: bxraabe: test-kitchen guy got back to me
[2014-04-23 18:29:20 -0400] bxraabe: montjoy: any luck?
[2014-04-23 18:29:25 -0400] montjoy: bxraabe:  I was a syntax issue between ohai 6 and ohai 7
[2014-04-23 18:29:25 -0400] gondoi: with test-kitchen, is it possible to apply attributes at the provisioner level so that they apply to all test suites?
[2014-04-23 18:29:40 -0400] montjoy: bxraabe: should have been 'Ohai::Config[:disabled_plugins] = [:Passwd]'
[2014-04-23 18:29:47 -0400] montjoy: bxraabe: I just want to scream
[2014-04-23 18:29:56 -0400] montjoy: but it works now
[2014-04-23 18:29:57 -0400] bxraabe: montjoy: oh wow
[2014-04-23 18:30:07 -0400] bxraabe: montjoy: yeah, at least you got it working!
[2014-04-23 18:30:55 -0400] xorl: damnit berkshelf keeps failing cause of my ELB not doing persistant load balancing between two chef servers
[2014-04-23 18:30:56 -0400] xorl: ugh
[2014-04-23 18:31:07 -0400] bxraabe: montjoy: so your original config would have worked with ohai v6?
[2014-04-23 18:31:15 -0400] montjoy: supposedly
[2014-04-23 18:31:25 -0400] jmreicha: Is there a way to override the default timeout when installing packages with package resource?
[2014-04-23 18:31:44 -0400] montjoy: bxraabe: it works just fine on the command line with v7.  I don't get it
[2014-04-23 18:32:24 -0400] bricker: I'm confused... apt-cache shows candidate `7.22.0-3ubuntu4.7`, but that version doesn't exist in the curl archive. How do I fix this?
[2014-04-23 18:33:08 -0400] anoldhacker: What happens when a resource is twice specified with the same name?
[2014-04-23 18:43:09 -0400] anoldhacker: Anyone out there?  What happens when a resource is twice specified with the same name?
[2014-04-23 18:44:10 -0400] zanshin: anoldhacker: What do you mean by resource? A Chef resource like `file` or something else?
[2014-04-23 18:44:24 -0400] anoldhacker: For example.
[2014-04-23 18:44:52 -0400] anoldhacker: I'm actually working on a docker container resource, and it is really important that there not be two of the same name.
[2014-04-23 18:44:53 -0400] zanshin: My guess would be it only gets run once with the last set of values. Try it and see
[2014-04-23 18:58:24 -0400] tejaycar: I'm having a heck of a time getting the ec2 ohai plugin working.
[2014-04-23 18:58:34 -0400] tejaycar: Is there a trick to enable it, or does it always run?
[2014-04-23 19:03:14 -0400] storme_away: tejaycar: it doesnt run on VPC nodes without the hint
[2014-04-23 19:03:36 -0400] tejaycar: Yea, that's what I've been tackling.  I just figured it out though.
[2014-04-23 19:03:58 -0400] tejaycar: We've got a pretty long running run list (topic for another day), so I was using an override run list to test the hint quickly
[2014-04-23 19:04:14 -0400] tejaycar: just noticed that it doesn't save my node data when I use an override runlist
[2014-04-23 19:04:25 -0400] tejaycar: go figure.  Anyhow, it's working for me now.  Thanks,
[2014-04-23 19:27:56 -0400] mindlace: coderanger, reset: thanks for your help yesterday. Now that berkshelf api is working, the berkshelf 3 development pattern is straightforward.
[2014-04-23 19:33:18 -0400] sarkis: what does the api give you?
[2014-04-23 19:33:35 -0400] sarkis: ability to use your own cookbook over the public one?
[2014-04-23 19:40:04 -0400] jtimberman: sarkis: the berkshelf api service aggregates all of the cookbooks, their versions, and their dependencies from the community site, because we didn't make the community site expose that data from the API. you literally have to download cookbooks, parse their metadata file.
[2014-04-23 19:40:24 -0400] jtimberman: which is what berkshelf 2 does, and why it's SUPER slow the first time you run it w/ a lot of community cokbooks, because it's doing that for each dependency.
[2014-04-23 19:42:17 -0400] aristarchus_: Ohai, Chefs. The Chef docs state that: "A chef-client that is running as a daemon can be woken up and started by sending the process a SIGUSR1".
[2014-04-23 19:42:25 -0400] aristarchus_: When I try this, I *do* get a message in the Chef server log that says "SIGUSR1 received, waking up", but the process still sits there for several minutes before convergence begins.
[2014-04-23 19:42:45 -0400] aristarchus_: [2014-04-23T19:29:18+00:00] INFO: SIGUSR1 received, waking up
[2014-04-23 19:42:47 -0400] aristarchus_: [2014-04-23T19:32:57+00:00] INFO: Forking chef instance to converge...
[2014-04-23 19:43:03 -0400] aristarchus_: See the delay? Almost 4 minutes, even though my /etc/chef/client.rb says "splay 0"
[2014-04-23 19:43:14 -0400] aristarchus_: Any idea what's going on here?
[2014-04-23 19:43:40 -0400] jtimberman: aristarchus_: it's waiting for the splay and/or interval, perhaps?
[2014-04-23 19:43:45 -0400] jtimberman: check the interval
[2014-04-23 19:45:03 -0400] aristarchus_: It's not set explicitly. I thought the point of SIGUSR1 was to request immediate convergence! If I wanted to wait for splay and interval, I'd just restart with SIGTERM or whatever.
[2014-04-23 19:45:32 -0400] aristarchus_: Is there a way to force immediate convergence?
[2014-04-23 19:46:07 -0400] ron__: Can someone explain how to use 'log' in a recipe?  If I add 'message' it states undefined message?
[2014-04-23 19:46:18 -0400] ron__: And good afternoon :)
[2014-04-23 19:46:24 -0400] Stuart__: interval is however often the client attempts to wake up. splay is a random offset so all your chef-clients dont try to wake up at the same time. you could try setting interval to 0
[2014-04-23 19:46:43 -0400] mondo: ron__: you can just do: log "hi this is a log message"
[2014-04-23 19:48:21 -0400] aristarchus_: Stuart__: thanks. What is the normal effect of setting interval to 0 for the chef service? I still want to converge periodically -- I'm just looking for a way to ask the Chef client service to converge immediately on top of that.
[2014-04-23 19:49:12 -0400] techminer: I can't figure out how to get around FoodCritic warning FC044 in this example.  https://gist.github.com/MattMencel/11229811
[2014-04-23 19:49:19 -0400] ron__: @mondo, I have tried that as well, but my log message is starting to get more complex and just was thinking of hiding it under the log directive and using 'name' for something more generic like 'debug-logging' or something like that.
[2014-04-23 19:49:36 -0400] techminer: can anyone shed some light on that for me?
[2014-04-23 19:49:53 -0400] aristarchus_: ron__: log "This is a message" creates a new Chef Resource of type Log. It's added to the resource collection inline like the others. Chef::Log.[info,etc.] will print a message exactly when it's evaluated as ruby.
[2014-04-23 19:50:10 -0400] aristarchus_: So that aspect can be confusing
[2014-04-23 19:52:10 -0400] aristarchus_: jtimberman: if I set the interval to zero, will my nodes stil converge periodically? If not, is there a way to configure for regular convergence, but still force an immediate run by the client service process?
[2014-04-23 19:55:10 -0400] jtimberman: aristarchus_: do you have a chef-client running already?
[2014-04-23 19:55:17 -0400] aristarchus_: Yes
[2014-04-23 19:55:27 -0400] jtimberman: it will wait (and depending on what version of chef you have) and not tell you it's waiting for the other chef-client to finish
[2014-04-23 19:56:00 -0400] aristarchus_: I would like to avoid running 2 clients simultaneously by using SIGUSR1
[2014-04-23 19:56:35 -0400] jtimberman: right, but if there's an active chef-client run it will wait.
[2014-04-23 19:56:50 -0400] aristarchus_: Running chef-client does cause the server to wait and vice-versa -- but I am finding that if the chef-client process runs the Opscode chef_client cookbook, a deadlock occurs when it tries to restart the service
[2014-04-23 19:57:16 -0400] ron__: @aristarchus_,  Do you know if chef-client -l debug -L cc.debug.out will output to a file called cc.debug.out?  I see my log lines in STDOUT but not in the file?
[2014-04-23 19:57:38 -0400] aristarchus_: ron__: I have a similar issue
[2014-04-23 19:58:25 -0400] supa_: I've been fighing this error: Unable to satisfy goal constraints users, runit, newrelic, postfix, openssh, htop, sudo, ntp, selinux, timezone, chef-client, base due to constraints on yum, runit
[2014-04-23 19:58:49 -0400] supa_: That seems super-straightforward - there's a constraint in yum and/or runit that is breaking everything else....
[2014-04-23 19:58:54 -0400] supa_: right?
[2014-04-23 19:58:55 -0400] Shred00: can one install an older version of a package with the package resource on a yum based distro (EL6)?
[2014-04-23 19:59:24 -0400] ron__: @aristarchus_ bummer :)  I always think I mess up the logging because it is missing so I end up rewriting hows its done.  Is that a known issue or is it user error?
[2014-04-23 19:59:40 -0400] Shred00: i specified an older version but chef only sees the most recent version as a candidate.  this is an older version of chef though, so i just want to know if that's been fixed in a more recent release.
[2014-04-23 20:01:45 -0400] aristarchus_: jtimberman: to avoid potential flaws in our full runlist, our organization first cojtimberman: to avoid potential flaws in our full runlist, our organization first converges (using chef-client -o) on a limited runlist "chef-client::config, chef-client::service". It then attempts to manually converge on the full runlist.nverges (using chef-client -o) on a limited runlist "chef-client::config,...
[2014-04-23 20:01:47 -0400] aristarchus_: ...chef-client::service". It then attempts to manually converge on the full runlist. Perhaps I
[2014-04-23 20:02:00 -0400] aristarchus_: Perhaps we need to abondon this technique. We used it to avoid the "emtpy runlist on broken first run" problem,
[2014-04-23 20:02:10 -0400] aristarchus_: but since the -o flag causes the client to not register at the end of convergence -- it's not that useful anyway, because the runlist doesn't get saved.
[2014-04-23 20:04:26 -0400] aristarchus_: ron__: I don't know why Chef::Log.[info,etc.] prints to the Chef Log file and not to STDOUT even when chef-client is run manually -- even with STDOUT explicity specified on the command line, in my experience
[2014-04-23 20:05:22 -0400] ron__: aristarchus_, i am seeing the reverse of that, if I specify -L, it doesn't actually write anything to the file, in fact it doesn't even create an empty file
[2014-04-23 20:05:25 -0400] helfire: you can use multiple secrets in your recipies or set of recipies, but it doesnt look like knife bootstrap allows you to send over multiple secret files
[2014-04-23 20:07:23 -0400] romanovsky: hello! I'm having troubles with running knife on a windows box. A simple "knife node run_list add BOXNAME role[a-role]" behaves strange: insted of adding 'a-role' to the box runlist it adds 'recipe[roles]'. Sometimes it works but mostly fails. The same command on a linux box works just fine. Any ideas how to troubleshoot  the problem?
[2014-04-23 20:10:08 -0400] ron__: @romanovsky, I don't have a windows machine but maybe it needs to be quoted?  try 'role[a-role]'
[2014-04-23 20:17:51 -0400] ron__: @aristarchus_ oddly enough chef-client -l debug > cc.debug.out 2>&1 doesn't store output either
[2014-04-23 20:20:02 -0400] coderanger: ron__: it checks if it is running against a TTY to determine default log levels
[2014-04-23 20:20:19 -0400] coderanger: ron__: If you want to register the node manually before converging, just do that
[2014-04-23 20:20:20 -0400] CPS: you can bootstrap a linux node from a windows workstation, yes?
[2014-04-23 20:21:16 -0400] techminer: Anyone know how to get around the foodcritic error I'm seeing here? https://gist.github.com/MattMencel/11229811
[2014-04-23 20:23:23 -0400] coderanger: CPS: Yes
[2014-04-23 20:23:52 -0400] spheromak: techminer: you can ignore style errors, that may be a false positive on the FC044
[2014-04-23 20:24:19 -0400] thematthewgreen: anyone using this HAProxy cookbook?  https://github.com/hw-cookbooks/haproxy
[2014-04-23 20:24:20 -0400] juliancdunn: romanovsky: quote it, i.e. 'role[a-role]'
[2014-04-23 20:24:50 -0400] maraca: thematthewgreen i did in the past
[2014-04-23 20:24:52 -0400] techminer: spheromak: ok thanks.I'll maybe have to disable that one in my CI then
[2014-04-23 20:25:42 -0400] thematthewgreen: maraca seems like the the lwrp is having some problems  :/
[2014-04-23 20:26:00 -0400] maraca: ha - I wouldn't know about it sorry it's been a while
[2014-04-23 20:28:01 -0400] spheromak: techminer: also i commented on how you could move that assignment into the loop
[2014-04-23 20:28:08 -0400] spheromak: on your gist
[2014-04-23 20:28:13 -0400] techminer: spheromak:  thanks!
[2014-04-23 20:28:51 -0400] spheromak: updated for sytax issues :)  ymmv
[2014-04-23 20:29:00 -0400] maraca: I have an upstart service with action [:enable, :start], the service gets started but I can't find any link in rc3.d/ showing that the service has been enabled on start, any idea?
[2014-04-23 20:31:43 -0400] romanovsky: @ron__ thanks! it looks good now with quoting
[2014-04-23 20:31:50 -0400] coredump: what can be enforcing a constraint on this? (utils = 1.1.41) -> (runit = 1.5.10) -> (build-essential = 1.4.0), but runit 1.5.10 metadata only depends on 'build-essential', with no version
[2014-04-23 20:34:12 -0400] ron__: @romanovsky, sweet!  that was my first answer on this irc!!!
[2014-04-23 20:35:41 -0400] ron__: Any recommendations on how to short circuit a cookbook? Say if a certain file exists, skip the rest?  I suppose you can do ' if (check) ' but that feels odd
[2014-04-23 20:36:01 -0400] coderanger: coredump: The message isn't super clear, but thats just a partially solved set, not a constraint
[2014-04-23 20:36:10 -0400] coderanger: ron__: return if foo
[2014-04-23 20:36:43 -0400] coredump: coderanger it was related to a constraint on build... but I just unpinned all versions I had pinned on the environment. Lesson learned, don't pin versions.
[2014-04-23 20:36:55 -0400] ron__: Thanks @coderanger, is the considered the 'chef' way?  just curious if there is a standard.
[2014-04-23 20:37:06 -0400] spheromak: ron__: thats the way
[2014-04-23 20:37:13 -0400] ron__: danke!
[2014-04-23 20:37:18 -0400] coderanger: coredump: When possibly, pin on semver constraints
[2014-04-23 20:37:31 -0400] coredump: semver?
[2014-04-23 20:37:57 -0400] double_p: coredump: http://semver.org/
[2014-04-23 20:38:08 -0400] coderanger: coredump: ~>x.0
[2014-04-23 20:38:36 -0400] coredump: oh right. That would not help a lot, I had 1.4.2 pinned and needed 2.0.0
[2014-04-23 20:38:42 -0400] coredump: I will just stick to berkshelf
[2014-04-23 20:38:48 -0400] meth: even though i have log_location setup in client.rb chef-client still outputs some information? but if i try to pipe that to grep then it stops outputting ?
[2014-04-23 20:39:10 -0400] montjoy: bxraabe: I was wrong, it's still broken.
[2014-04-23 20:39:58 -0400] montjoy: stupid caching
[2014-04-23 20:41:16 -0400] romanovsky: why windows knife so freaking slow comparing to linux knife? We're trying to migrate to chef. We have many windows sysadmins. They don't like those meditative pace of knife and I understand them.  I don't think they'll like the idea of sshing to a linux box to run knife. Any suggestions?
[2014-04-23 20:42:06 -0400] coderanger: romanovsky: WinRM is not a high-throughput protocol unfortunately
[2014-04-23 20:44:27 -0400] romanovsky: @coderanger why it's related to winrm? knife connects to the chef server using rest api, doesn't it?
[2014-04-23 20:45:06 -0400] coderanger: romanovsky: I may have misread, do you mean the bootstrap process or just knife in general?
[2014-04-23 20:45:58 -0400] lindenle: I keep getting errors from berkshelf, what channel should I ask a question on
[2014-04-23 20:45:59 -0400] stormerider: istr that there were some performance problems with certain windows ruby versions?
[2014-04-23 20:46:01 -0400] romanovsky: @coderanger i mean knife in general. I do that 'knife node run_list add' and it's like 5 times slower than the same command on linux
[2014-04-23 20:46:04 -0400] coderanger: lindenle: Here is fine
[2014-04-23 20:46:18 -0400] alexras: does anyone know why libraries get loaded when a cookbook is included in chef-solo's runlist, but don't get loaded when a recipe from the cookbook is loaded from another cookbook with include_recipe?
[2014-04-23 20:46:28 -0400] coderanger: romanovsky: Ahh, usually a filesystem issue, how did you install knife?
[2014-04-23 20:47:14 -0400] someara: alexras they all get loaded... what's making you think they arent?
[2014-04-23 20:47:19 -0400] lindenle: coderanger: ok, so i did 'berkshelf cookbook mycookbook', made some small edits to the metadata.rb and Berksfile in the cookbook and now i am trying to install by doing berks vendor sit-cookbooks and I get an erro that it cannot satisfy my constraints.
[2014-04-23 20:47:30 -0400] coderanger: alexras: Libs get loaded for the active cookbook collection, which is anything in the run list and then anything those depend on recursively, this only involves metadata though, not include_recipe
[2014-04-23 20:47:31 -0400] romanovsky: @coderanger using this instructions http://docs.opscode.com/install_workstation.html
[2014-04-23 20:47:51 -0400] coderanger: romanovsky: Have you installed any additional gems locally
[2014-04-23 20:48:04 -0400] romanovsky: @coderanger no
[2014-04-23 20:48:33 -0400] coderanger: lindenle: Okay, whatever you changed made it unable to solve the dependencies
[2014-04-23 20:49:09 -0400] coderanger: romanovsky: Hmm, 5x seems pretty far on the extreme side of things then, gem loading is slower on Windows but it shouldn't be by that much
[2014-04-23 20:49:27 -0400] lindenle: coderanger: what source do I use if I want to pull in cookbooks from opscode?
[2014-04-23 20:49:31 -0400] coderanger: romanovsky: It does a metric ass load of stats while rubygems loads up, which are much slower on windows than linux
[2014-04-23 20:49:54 -0400] coderanger: lindenle: None, the default source is the community site
[2014-04-23 20:51:09 -0400] alexras: @coderanger ah, ok. makes sense. looks like I was missing the dependency from metadata.rb. thanks!
[2014-04-23 20:51:26 -0400] alexras: \leave
[2014-04-23 20:51:28 -0400] alexras: d'oh
[2014-04-23 20:51:31 -0400] lindenle: coderanger: do i need to put the dependencies in the metadata.rb or in the Berksfile. btw just did a test of creating a cookbook and adding deps to Berksfile and it seems to have worked. Not sure what the difference between my localhost and the vagrant node im using is yet.
[2014-04-23 20:51:51 -0400] coderanger: lindenle: deps belong in the metadata.rb in most cases
[2014-04-23 20:52:06 -0400] lindenle: coderanger: also can I do a top level Berksfile to include all my cookbooks?
[2014-04-23 20:52:28 -0400] lindenle: coderanger: i.e. Berksfile -> cookbook/a,b,d and deps
[2014-04-23 20:54:18 -0400] coderanger: lindenle: Just make that top level thing also a cookbook
[2014-04-23 20:54:27 -0400] coderanger: this is generally called an environment cookbook
[2014-04-23 20:55:02 -0400] lindenle: coderanger: ok. so where inside the top level cookbook do I put the remaining cookbooks?
[2014-04-23 20:55:18 -0400] coderanger: Not sure what you mean, it just pulls them in as dependencies
[2014-04-23 20:55:22 -0400] lindenle: coderanger: in a directory called cookbooks?
[2014-04-23 20:55:29 -0400] lindenle: oh i see they each go in there own repo?
[2014-04-23 20:55:29 -0400] coderanger: No, they aren't nested
[2014-04-23 20:55:33 -0400] coderanger: They are siblings
[2014-04-23 20:55:33 -0400] lindenle: clear
[2014-04-23 20:55:34 -0400] coderanger: yep
[2014-04-23 20:55:42 -0400] rayrod2030: what's the best way to push out new data bag encryption keys?
[2014-04-23 20:55:48 -0400] rayrod2030: via knife ssh?
[2014-04-23 20:55:49 -0400] Keich: Hi guys
[2014-04-23 20:57:17 -0400] Keich: I'm having a weird issue with my omnibus project (with omnibus 3.0.0), it seems that it's trying to build one of my project dependency without building the underlying dependency of that dependency
[2014-04-23 20:57:24 -0400] Keich: the dependency is that one
[2014-04-23 20:57:24 -0400] Keich: https://github.com/opscode/omnibus-software/blob/master/config/software/setuptools.rb
[2014-04-23 20:57:36 -0400] Keich: it's failing because it can't find python
[2014-04-23 20:57:36 -0400] coderanger: rayrod2030: lollllll
[2014-04-23 20:57:48 -0400] Keich: which indeed didn't get built
[2014-04-23 20:57:53 -0400] Keich: i don't have that issue with omnibus 2.0.1
[2014-04-23 20:57:55 -0400] Keich: any idea ?
[2014-04-23 20:57:56 -0400] romanovsky: @coderanger here's I measured the runtime: $ time knife search node 'name:BBX032-VA-1' ... real0m1.916s  And here's windows:  Measure-Command {knife search node 'name:BBX032-VA-1'} ... TotalSeconds      : 8.1286333. I.e. it's x4.25 slower
[2014-04-23 20:58:57 -0400] Neozonz: what's a good way to copy files from /files/ to a machine? (a complete directory)
[2014-04-23 20:59:09 -0400] coderanger: Neozonz: remote_directory, but use it sparingly
[2014-04-23 20:59:24 -0400] Neozonz: cheers
[2014-04-23 21:02:36 -0400] coderanger: romanovsky: Might want to see if they have any nightlies of chefdk for windows posted, kallistec made a bunch of stuff to improve gem load time
[2014-04-23 21:08:47 -0400] kallistec: romanovsky: /cc coderanger haven't jumped in to windows ChefDK builds yet, but that's the next step after we fix some of the bugs people found in the first week
[2014-04-23 21:10:07 -0400] kallistec: romanovsky: ChefDK will be much faster because of ruby windows performance improvements plus some stuff we've done to tame rubygems runtime behavior
[2014-04-23 21:28:01 -0400] Keich: any omnibus expert here ?
[2014-04-23 21:31:34 -0400] coderanger: Keich: Just ask :P
[2014-04-23 21:34:19 -0400] Keich: coderanger: already did :( basically i'm building a project that needs setuptools (https://github.com/opscode/omnibus-software/blob/master/config/software/setuptools.rb) but with omnibus 3.0.0 it's trying to build setuptools without building python beforehand
[2014-04-23 21:34:35 -0400] Keich: it's working fine with omnibus 2.0.1
[2014-04-23 21:35:55 -0400] viglesias: can somebody point me to an example of using a function from a library other than the one found in: http://docs.opscode.com/essentials_cookbook_libraries.html
[2014-04-23 21:35:56 -0400] Keich: wondering if i should open a github issue for that
[2014-04-23 21:36:23 -0400] coderanger: Keich: If you just explicitly depend on python at the top level does it work?
[2014-04-23 21:36:26 -0400] Keich: or if i'm doing something wrong
[2014-04-23 21:36:35 -0400] Keich: coderanger: it's already the case
[2014-04-23 21:36:42 -0400] coderanger: viglesias: There is no special syntax, libs know nothing about cookbooks
[2014-04-23 21:36:50 -0400] Keich: coderanger: should i try without ?
[2014-04-23 21:37:00 -0400] coderanger: viglesias: Lib files are just run directly as Ruby code, thats all
[2014-04-23 21:37:10 -0400] coderanger: Keich: If you remove the setuptools, does python get installed later?
[2014-04-23 21:37:37 -0400] viglesias: coderanger: ack and there is no need to "require" or "include" anything? I can just use the module in a ruby_block resource?
[2014-04-23 21:37:45 -0400] coderanger: viglesias: indeed
[2014-04-23 21:38:18 -0400] Keich: coderanger: haven't tried because i have a lot of dependencies requiring setuptools but i'll check
[2014-04-23 21:38:19 -0400] viglesias: coderanger: great,
[2014-04-23 21:38:45 -0400] coderanger: Keich: Yell at your upstreams to release wheels so you don't need setuptools anymore ;-)
[2014-04-23 21:39:06 -0400] viglesias: coderanger: im doing this: http://hastebin.com/opukileqow.rb then in the cookbook: http://hastebin.com/boqagoriki.rb
[2014-04-23 21:39:50 -0400] Keich: :) i wish i could, we just have so many dependencies :)
[2014-04-23 21:40:57 -0400] coderanger: viglesias: Looks okay to me
[2014-04-23 21:41:27 -0400] viglesias: coderanger: smashing, its converging as we speak thanks again for the info
[2014-04-23 21:47:37 -0400] jidar: using test kitchen, how can I define a box_url that is a local file?
[2014-04-23 21:48:36 -0400] coderanger: The same way you do it with normal Vagrant?
[2014-04-23 21:49:20 -0400] jidar: coderanger: I have no concept of how test kitchen uses vagrant things
[2014-04-23 21:49:30 -0400] jidar: coderanger: but I think I found an example, it's just a regular ol' file path
[2014-04-23 21:49:47 -0400] coderanger: jidar: It just writes out a Vagrantfile to .kitchen/kitchen/vagrant/<name>/
[2014-04-23 21:49:51 -0400] coderanger: Its super simple
[2014-04-23 21:50:53 -0400] Keich: coderanger: interesting, if i take out python from the top level it's working
[2014-04-23 21:51:07 -0400] Keich: and it's being properly built
[2014-04-23 21:51:17 -0400] coderanger: Keich: I know there is some weird stuff now about doing things in reverse order
[2014-04-23 21:51:31 -0400] coderanger: try setuptools before python in the project?
[2014-04-23 21:52:44 -0400] geggam: coderanger,  will this work you think ? http://pastebin.mozilla.org/4922540
[2014-04-23 21:52:47 -0400] Keich: setuptools is not an explicit dependency of my project
[2014-04-23 21:52:56 -0400] Keich: but anyway if it's working like that it's fine by me
[2014-04-23 21:53:20 -0400] coderanger: geggam: No, or at least that doesn't do what you think it does
[2014-04-23 21:53:43 -0400] coderanger: geggam: environments would be a list of all nodes
[2014-04-23 21:53:54 -0400] geggam: its good you can see what im  trying to do ... yeah.. but wouldnt sort collapse that ?
[2014-04-23 21:54:02 -0400] geggam: or i need uniq ?
[2014-04-23 21:54:03 -0400] coderanger: geggam: no ...
[2014-04-23 21:54:11 -0400] Keich: coderanger: thanks for the help by the way :)
[2014-04-23 21:54:15 -0400] coderanger: geggam: The return value from search() is a list of node objects :-)
[2014-04-23 21:54:23 -0400] geggam: right
[2014-04-23 21:54:40 -0400] geggam: environment being the one i want
[2014-04-23 21:55:07 -0400] geggam: ill go back to thinking this :)
[2014-04-23 21:55:10 -0400] geggam: thanks
[2014-04-23 21:55:13 -0400] coderanger: geggam: You just want a list of the env
[2014-04-23 21:55:24 -0400] coderanger: geggam: chef_server_rest.get_rest('environments').keys
[2014-04-23 21:55:50 -0400] coderanger: geggam: But that will still be more API calls than you need, one sec
[2014-04-23 21:58:18 -0400] coderanger: geggam: http://hastebin.com/nacacukewa.rb
[2014-04-23 21:58:35 -0400] coderanger: geggam: Off the back of my hand, but something like that, fill in the keys for partial_search as needed
[2014-04-23 21:59:25 -0400] geggam: ah
[2014-04-23 21:59:28 -0400] geggam: :)
[2014-04-23 21:59:30 -0400] geggam: thanks
[2014-04-23 22:02:14 -0400] geggam: never heard of memo in ruby before
[2014-04-23 22:02:45 -0400] coderanger: geggam: inject == reduce
[2014-04-23 22:02:51 -0400] coderanger: geggam: Thats a simple M/R job ;-)
[2014-04-23 22:02:52 -0400] geggam: im reading
[2014-04-23 22:03:06 -0400] coderanger: memo is nothing special, just a common name for the reduction bucket
[2014-04-23 22:03:36 -0400] geggam: right ... but ruby and map reduce in the same sentence ?
[2014-04-23 22:03:38 -0400] geggam: :)
[2014-04-23 22:03:54 -0400] geggam: only here
[2014-04-23 22:04:11 -0400] coderanger: I learn programming from Scheme and Lisp, its the way my brain works
[2014-04-23 22:04:24 -0400] geggam: must be nice
[2014-04-23 22:04:59 -0400] coderanger: I live in a happy little bubble
[2014-04-23 22:06:06 -0400] Lumbendil: hi
[2014-04-23 22:06:56 -0400] Lumbendil: anyone here uses the php cookbook, more specifically, the php_pear resource?
[2014-04-23 22:07:12 -0400] Lumbendil: I'm trying to install the "redis" extension to install it with no luck
[2014-04-23 22:13:28 -0400] geggam: thanks again coderanger  :) ... l8r
[2014-04-23 22:19:12 -0400] lindenle: for include_recipe does it take a list?
[2014-04-23 22:20:27 -0400] lindenle: basically i want to include two recipes in my cookbook...
[2014-04-23 22:20:32 -0400] coderanger: lindenle: It takes a *args, though passing more than one is rare
[2014-04-23 22:20:39 -0400] coderanger: lindenle: Just use two lines :P
[2014-04-23 22:20:51 -0400] lindenle: coderanger: i did but it appears to have skipped the second one...
[2014-04-23 22:21:37 -0400] lindenle: coderanger: ah...the package only supports ubuntu..
[2014-04-23 22:31:55 -0400] nicferrier: hi all. I'm trying to use chef solo to provision a vagrant box... I want to install the epel rpm on the box...
[2014-04-23 22:32:14 -0400] nicferrier: so I downloaded the epel rpm and wrote a recipe to install it with rpm_package
[2014-04-23 22:32:28 -0400] nicferrier: but I'm not sure where to put the rpm file so that chef can find it
[2014-04-23 22:32:49 -0400] nicferrier: I keep running vagrant provision with different tweaks and it can't find the rpm file.
[2014-04-23 22:32:53 -0400] nicferrier: any clues?
[2014-04-23 22:34:39 -0400] lindenle: coderanger : i just forked a repo in git to modify the metadata.rb to make it work for centos. But even after putting git: in the cookbook line in Berksfile I am still seeing the old metadata,rb for the cookbook. Am i doing something wrong?
[2014-04-23 22:34:56 -0400] coderanger: nicferrier: Just use the yum-epel cookbook
[2014-04-23 22:35:24 -0400] coderanger: lindenle: 1) what version of berks 2) how are you running chef
[2014-04-23 22:35:37 -0400] lindenle: coderanger: i just used debug and it is giving me a lock warning ;)
[2014-04-23 22:40:01 -0400] rb1980: Hi chefs, if anyone can help with this question: How to I negate a search with knife search? For example, I want to find nodes that DO NOT have a certain role in their run_list.
[2014-04-23 22:40:16 -0400] rb1980: I've googled my brains out and can't find an example that works.
[2014-04-23 22:41:04 -0400] coderanger: rb1980: That is not possible in Solr AFAIK
[2014-04-23 22:42:30 -0400] coderanger: rb1980: You would have to do it manually
[2014-04-23 22:43:05 -0400] rb1980: i've seen some Solr examples like: -field:val and (*:* NOT field:val) but those don't work
[2014-04-23 22:43:06 -0400] gleam: it's possible if you're negating everything
[2014-04-23 22:43:22 -0400] gleam: i just tried '-role:foo' and it worked fine for me
[2014-04-23 22:43:25 -0400] coderanger: rb1980: We transform the query in such a way that wouldn't work
[2014-04-23 22:44:13 -0400] coderanger: gleam: 0 items found
[2014-04-23 22:44:18 -0400] coderanger: at least for me
[2014-04-23 22:44:24 -0400] rb1980: so can you clue me in how I would do that "manually"?
[2014-04-23 22:44:28 -0400] gleam: are you doing it via knife?
[2014-04-23 22:44:34 -0400] rb1980: yes, with knife
[2014-04-23 22:44:44 -0400] EricL: If I have a node that I had to stop and start through the ec2 console that changed IP addresses, how can I tell chef that?
[2014-04-23 22:44:46 -0400] coderanger: rb1980: Get the list of all nodes via partial_search and remove any that match the role
[2014-04-23 22:44:57 -0400] gleam: for me, literally: knife search -- "-role:rolename"
[2014-04-23 22:45:01 -0400] gleam: returned all nodes w/o that role
[2014-04-23 22:45:09 -0400] gleam: 11.12.2
[2014-04-23 22:45:20 -0400] rb1980: hmm, maybe i should try updating
[2014-04-23 22:45:25 -0400] coderanger: gleam: Ahh interesting, with the -- it works
[2014-04-23 22:45:33 -0400] coderanger: must have been parsing it as a CLI arg?
[2014-04-23 22:45:34 -0400] gleam: yeah, otherwise it tries to treat it as an argument to knife i suspect
[2014-04-23 22:45:37 -0400] rb1980: what the heck is the --?
[2014-04-23 22:45:54 -0400] coderanger: rb1980: in unix speak it means "everything after this is not an option flag"
[2014-04-23 22:46:03 -0400] rb1980: ah, yeah ok i get it
[2014-04-23 22:46:49 -0400] rb1980: i'll give it a try, thanks!
[2014-04-23 22:47:53 -0400] coderanger: rb1980: This is likely to be a lot more intensive than doing it manually though
[2014-04-23 22:48:08 -0400] coderanger: since it has to go via solr for a ton of data
[2014-04-23 22:48:34 -0400] rb1980: can you show me a partial example? i have the knife psearch plugin
[2014-04-23 22:49:23 -0400] coderanger: rb1980: Of what?
[2014-04-23 22:50:18 -0400] rb1980: on how to do the same as partial search...with knife psearch
[2014-04-23 22:51:04 -0400] rb1980: or were you just saying pull down the runlist for everythngi and use like grep or something to filter it?
[2014-04-23 22:51:06 -0400] coderanger: rb1980: knife psearch INDEX SEARCH NAME=DESIRED_KEY_PATH,[NAME=DESIRED_KEY_PATH]
[2014-04-23 22:51:27 -0400] coderanger: rb1980: No, don't use Bash, you need a real programming language if you are going to do this efficiently
[2014-04-23 22:51:35 -0400] cyrusdavid: which one's correct? ::File.exists? or File::exists?
[2014-04-23 22:51:39 -0400] rb1980: hah, gotcha
[2014-04-23 22:51:41 -0400] coderanger: cyrusdavid: In a recipe?
[2014-04-23 22:51:52 -0400] cyrusdavid: coderanger, in a provider
[2014-04-23 22:51:57 -0400] coderanger: cyrusdavid: The former
[2014-04-23 22:52:12 -0400] cyrusdavid: coderanger, thanks I'll try!
[2014-04-23 22:52:20 -0400] coderanger: cyrusdavid: In most places you don't need the leading :: but inside the Chef::Resource and Chef::Provider namespaces you do
[2014-04-23 22:52:31 -0400] coderanger: because of Chef::Resource::File and Chef::Provider::File
[2014-04-23 22:54:41 -0400] cyrusdavid: coderanger, undefined method `exists?' for Chef::Provider::File:Class
[2014-04-23 22:54:59 -0400] coderanger: cyrusdavid: former == "::File.exists?"
[2014-04-23 22:55:06 -0400] cyrusdavid: oh...
[2014-04-23 22:55:15 -0400] coderanger: former means first, latter means second :)
[2014-04-23 22:55:21 -0400] cyrusdavid: i forgot what latter vs former...
[2014-04-23 22:56:11 -0400] coderanger: cyrusdavid: The leading :: is like a leading / on a path, it makes it absolute
[2014-04-23 22:56:39 -0400] coderanger: Normally Ruby scans backwards in the tree to find the name
[2014-04-23 22:56:49 -0400] romanovsky: hello again! Funny but quoting doesn't help. Windows knife breaks on SOME of role names. The command <<knife node run_list add 'NODENAME' 'role[_123456789-qwerqvasfrqetftwgrsygahbafd]'>> results of adding a recipe[roles] for the NODENAME. Thoughts?
[2014-04-23 22:57:04 -0400] coderanger: So if you are in module A::B::C, it would check A::B::C::File, then A::B::File, then A::File, then File
[2014-04-23 22:57:08 -0400] cyrusdavid: coderanger, undefined method `file' for Chef::Resource::Bash tihihi
[2014-04-23 22:58:18 -0400] nicferrier: coderanger: thanks. struggling to make that work.
[2014-04-23 22:59:01 -0400] coderanger: romanovsky: Just depends on how your shell lexes things, quoting forces the issue
[2014-04-23 23:03:13 -0400] nicferrier: I did this: knife cookbook site download yum-epel ; and then I included the yum-epel coobook from my main cookbook with include_recipe "yum_epel" in the default.rb and depends "yum_epel" in the metadata.rb.
[2014-04-23 23:03:21 -0400] nicferrier: doesn't work though. doesn't seem to find it.
[2014-04-23 23:03:51 -0400] cyrusdavid: coderanger, any other ideas? Here's the code that I use btw, http://sprunge.us/cNdV?ruby
[2014-04-23 23:04:45 -0400] coderanger: cyrusdavid: Which line is the traceback on?
[2014-04-23 23:05:00 -0400] coderanger: nicferrier: What error are you seeing?
[2014-04-23 23:05:20 -0400] nicferrier: coderanger:vagrant is hiding it. hang on.
[2014-04-23 23:05:34 -0400] cyrusdavid: coderanger, at the not_if line
[2014-04-23 23:05:53 -0400] nicferrier: cookbook yum not found. I guess I have a dependency chain I've not downloaded.
[2014-04-23 23:06:03 -0400] nicferrier: apologies. stupid error.
[2014-04-23 23:06:05 -0400] coderanger: cyrusdavid: Where is snar_level_0 defined, I don't see it here
[2014-04-23 23:06:16 -0400] cyrusdavid: inside action :create
[2014-04-23 23:06:22 -0400] coderanger: nicferrier: I highly recommend you use berkshelf to manage dependencies
[2014-04-23 23:06:33 -0400] coderanger: cyrusdavid: Please pastebin the full code
[2014-04-23 23:06:47 -0400] nicferrier: coderanger: thanks. is that another extra thing?
[2014-04-23 23:07:02 -0400] coderanger: nicferrier: Yes, its a cookbook manager, like bundler is for gems
[2014-04-23 23:07:14 -0400] nicferrier: yeah. I get it. am just in a hurry.
[2014-04-23 23:07:23 -0400] nicferrier: and I'm not a rubyist particularly.
[2014-04-23 23:07:27 -0400] nicferrier: sigh.
[2014-04-23 23:07:30 -0400] romanovsky: @coderanger Do you know where from that 'recipe[roles]' thing comes? Do you have a windows knife handbook or something? I'm not a windows guy, I just tried single and double quotes. My windows sysadmins did the same. Is it possible that the problem is somewhere in the chain of bat files involved? thanks.
[2014-04-23 23:07:31 -0400] coderanger: nicferrier: If you installed the chefdk, you already have it installed
[2014-04-23 23:07:44 -0400] nicferrier: chefdk?
[2014-04-23 23:07:50 -0400] coderanger: romanovsky: Old fallback behavior that any bare word foo is transformed into recipe[foo]
[2014-04-23 23:07:51 -0400] nicferrier: I have chef from apt.
[2014-04-23 23:08:10 -0400] coderanger: romanovsky: So if your shell lexes the command as  role [ foo ]
[2014-04-23 23:08:25 -0400] coderanger: it passes each of those as a separate item in argv
[2014-04-23 23:08:32 -0400] coderanger: which is not what you want
[2014-04-23 23:09:23 -0400] cyrusdavid: coderanger, http://sprunge.us/UfNO?ruby
[2014-04-23 23:09:38 -0400] coderanger: nicferrier: chefdk is the new all-in-one workstation package, its very new though so unsurprising you aren't using it :-)
[2014-04-23 23:09:55 -0400] coderanger: nicferrier: You can do the downloads by hand for now, but check out chefdk and berks Soon :)
[2014-04-23 23:10:17 -0400] nicferrier: coderanger: thanks. still doesn't work btw but now tells me it can't find yum-epel
[2014-04-23 23:10:25 -0400] nicferrier: which is odd because it's bloody well there.
[2014-04-23 23:11:26 -0400] coderanger: cyrusdavid: Definitely looks correct to me, double check you don't have files out of sync?
[2014-04-23 23:14:23 -0400] nicferrier: ah. there we go.
[2014-04-23 23:20:17 -0400] ron__: Has anyone else experienced this:
[2014-04-23 23:20:28 -0400] ron__: chef-client -l debug &> cc.debug.out  (works  aka puts output in file)
[2014-04-23 23:20:47 -0400] ron__: chef-client -l debug > cc.debug.out 2>&1 (doens't work, no file is created)
[2014-04-23 23:20:53 -0400] ron__: I suspect ruby io buffering, but could be off my rocker
[2014-04-23 23:21:27 -0400] coderanger: ron__: More likely its that the output isn't going to a TTY anymore
[2014-04-23 23:21:39 -0400] nicferrier: coderanger: thanks for your help.
[2014-04-23 23:22:56 -0400] ron__: @coderanger, hum... chef-client is the only program that technique hasn't worked for me, my boss has had issues with ruby buffering in the past.  Happy it printed something now, need to figure it out :)
[2014-04-23 23:23:19 -0400] coderanger: ron__: mixlib-logging supports writing to files on its own, use that :P
[2014-04-23 23:23:40 -0400] coderanger: ron__: Or use the output logging from your service layer (supervisor, systemd, runit)
[2014-04-23 23:25:26 -0400] ron__: @coderanger, that is all new to me :)  I have more to learn apparently, thank you!
[2014-04-23 23:26:11 -0400] coderanger: ron__: Of those two, the second is better, log management should be a function of your service layer
[2014-04-23 23:26:37 -0400] coderanger: or at least that should be the entry point, well behaved apps should log to stdout
[2014-04-23 23:26:57 -0400] coderanger: but thats a bigger change, just setting a log_location is much faster :)
[2014-04-23 23:32:29 -0400] ron__: danke @coderanger
[2014-04-23 23:38:30 -0400] coredump: So, I have a cookbook that depends on mysql ~> 4.1, should not berks lock the version on 4.x instead of 5.x like it's doing now?
[2014-04-23 23:44:46 -0400] coderanger: coredump: What version of berkshelf?
[2014-04-23 23:45:09 -0400] coredump: Berkshelf (2.0.14)
[2014-04-23 23:45:21 -0400] coderanger: coredump: :-( use berks 3
[2014-04-23 23:45:27 -0400] coderanger: berks 2 more or less cheated on solving
[2014-04-23 23:45:32 -0400] coredump: lol
[2014-04-23 23:57:26 -0400] romanovsky: @coderanger I can't believe I'm the first guy who need to quote an argument for the windows knife. Could you recommend what symbols should I change in the command below to make it work? I tried 3 different shells (cmd, ps, sh) with the same result <<knife node run_list add 'BBX032-VA-1' "role[_123456789-qwerqvasfrqetftwgrsygahbafd]">> thanks
[2014-04-23 23:59:30 -0400] ron__: @romanovsky, why single and double quotes?
