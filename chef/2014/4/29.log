[2014-04-29 00:00:05 -0400] coderanger: otakup0pe: Make sure you add the cookbook dependency
[2014-04-29 00:00:12 -0400] otakup0pe: in metadata.rb ? got that.
[2014-04-29 00:00:15 -0400] coderanger: the thing using it needs to depend on the thing containing it
[2014-04-29 00:00:40 -0400] otakup0pe: it's there even when i look at the cookbook with knife cli
[2014-04-29 00:01:21 -0400] coderanger: Do you have any version restrictions in your environment?
[2014-04-29 00:01:25 -0400] otakup0pe: nope.
[2014-04-29 00:01:33 -0400] otakup0pe: nor in the cookbooks themselves.
[2014-04-29 00:01:36 -0400] coderanger: Do you see the LWRP in the cache on the machine?
[2014-04-29 00:01:43 -0400] otakup0pe: oh good question
[2014-04-29 00:02:07 -0400] otakup0pe: yeah both the resources and providers bit
[2014-04-29 00:02:43 -0400] otakup0pe: mmm
[2014-04-29 00:02:50 -0400] otakup0pe: i wonder if it's because the old definitions version is still in the cache
[2014-04-29 00:07:41 -0400] otakup0pe: yeah wasn't that. blow away cache dir and same diff.
[2014-04-29 00:07:57 -0400] coderanger: otakup0pe: What error are you seeing?
[2014-04-29 00:08:18 -0400] otakup0pe: Cannot find a resource for [redacted] on ubuntu version 12.04
[2014-04-29 00:08:29 -0400] otakup0pe: in the recipe when i try to invoke the lwrp
[2014-04-29 00:08:30 -0400] coderanger: I kind of need to see the redacted :P
[2014-04-29 00:08:43 -0400] otakup0pe: it's just the name of the lwrp
[2014-04-29 00:08:46 -0400] otakup0pe: foo_bar
[2014-04-29 00:08:56 -0400] coderanger: How sure are you you have the name correct? :)
[2014-04-29 00:09:06 -0400] coderanger: the name would be the name of the cookbook plus the name of hte resource file
[2014-04-29 00:09:14 -0400] otakup0pe: no shit
[2014-04-29 00:09:18 -0400] otakup0pe: :|
[2014-04-29 00:09:39 -0400] otakup0pe: separated by an underscore ?
[2014-04-29 00:09:41 -0400] coderanger: so to be foo_bar, the path to the resource file would have to be cookbooks/foo/resources/bar.rb
[2014-04-29 00:09:52 -0400] coderanger: yeah, and all hyphens replaced by underscores
[2014-04-29 00:10:05 -0400] coderanger: and as a special case, cookbooks/foo/resources/default.rb -> foo
[2014-04-29 00:10:07 -0400] otakup0pe: renaming to baz_foo_bar ...
[2014-04-29 00:12:20 -0400] otakup0pe: mm i think it's working now thx yo
[2014-04-29 00:12:27 -0400] otakup0pe: dunno how i missed that in the docs
[2014-04-29 00:47:35 -0400] juliancdunn: Majost: you were asking about stubbing guards, right?
[2014-04-29 01:15:36 -0400] rburton-: Is there a way in application_ruby to set environment variables?
[2014-04-29 01:19:57 -0400] rburton-: I think I figured it out
[2014-04-29 01:22:02 -0400] coderanger: rburton-: For which part?
[2014-04-29 01:22:11 -0400] rburton-: for when the rails application is running.
[2014-04-29 01:22:26 -0400] rburton-: I want to set environment variables for things like Redis
[2014-04-29 01:22:31 -0400] rburton-: client
[2014-04-29 01:23:22 -0400] coderanger: Yeah, swap out the runit template and set them in there
[2014-04-29 01:23:40 -0400] rburton-: So there's no easy way of doing it e.g., environment hash
[2014-04-29 01:24:06 -0400] coderanger: Don't think so, no
[2014-04-29 01:24:16 -0400] coderanger: Runit has no direct configuration for stuff like that
[2014-04-29 01:24:27 -0400] coderanger: you could also (ab)use the unicorn after_fork hook
[2014-04-29 01:24:30 -0400] coderanger: and do it there
[2014-04-29 04:51:26 -0400] rburton-: so annoying tring to install fucking pg gem with chef
[2014-04-29 04:51:53 -0400] rburton-: I must say, most authors of chef cookbooks are terrible coders.
[2014-04-29 04:53:21 -0400] rburton-: If your recipe requires make, then make sure it's installed. Sounds logical right?
[2014-04-29 05:00:32 -0400] Durzo: rburton-, my fav is when a recipe has an optional recipe that does XX feature, but then they make a dependancy of that optional recipe a requirement.
[2014-04-29 05:01:00 -0400] Durzo: makes you go o_O
[2014-04-29 05:01:11 -0400] rburton-: There needs to be a lesson to teach authors of recipes how to do it right
[2014-04-29 05:01:23 -0400] rburton-: Trying to install ruby gem 'pg' is turning into a shit fest.
[2014-04-29 05:01:53 -0400] rburton-: postgres::ruby depends on make and my apt_package "make" isn't working and it's annoying the shit out of me
[2014-04-29 05:02:02 -0400] rburton-: my custom recipe isn't being picked up
[2014-04-29 05:02:45 -0400] rburton-: well, the postgres::ruby is running first
[2014-04-29 05:02:52 -0400] rburton-: which is the problem
[2014-04-29 05:03:04 -0400] Durzo: apt-get build-essential
[2014-04-29 05:03:09 -0400] Durzo: problem solvered
[2014-04-29 05:03:23 -0400] rburton-: I have "recipe[build-essential]"
[2014-04-29 05:03:36 -0400] rburton-: but that puppy isn't installing make
[2014-04-29 05:03:41 -0400] Durzo: theres a trick to making build-essential running first
[2014-04-29 05:03:45 -0400] Durzo: google knows it
[2014-04-29 05:05:06 -0400] rburton-: ah compiletime
[2014-04-29 05:13:17 -0400] rburton-: Can't find the PostgreSQL client library (libpq) ugh
[2014-04-29 05:17:38 -0400] rburton-: Okay so why "execute[install pg gem lib] action nothing (skipped due to action :nothing)"
[2014-04-29 05:29:42 -0400] otakup0pe: hmm why would knife ssh not work when normal ssh works fine
[2014-04-29 05:29:48 -0400] otakup0pe: some kind of id_rsa shenanigans going on
[2014-04-29 05:30:09 -0400] otakup0pe: ~/.ssh/config does not have any host/network specific keys
[2014-04-29 05:35:46 -0400] rburton-: what error?
[2014-04-29 05:37:23 -0400] otakup0pe: no error. just asks for password for the gateway host
[2014-04-29 05:37:28 -0400] otakup0pe: i can ssh to the gateway host normally with just ssh
[2014-04-29 05:37:51 -0400] otakup0pe: i'm comparing it with another host where the knife ssh works and i'm not seeing any obvious differences
[2014-04-29 05:38:04 -0400] otakup0pe: except the old one has several versions of net-ssh
[2014-04-29 05:38:16 -0400] otakup0pe: but they both have 2.8.0
[2014-04-29 05:39:46 -0400] otakup0pe: no password on the key, and no ssh-agent in play
[2014-04-29 05:44:02 -0400] otakup0pe: verbose doesn't seem to kick in until the gateway connection is established
[2014-04-29 05:46:57 -0400] otakup0pe: same version of chef on both
[2014-04-29 06:00:11 -0400] rburton-: I can't find one stable recipe to install a Ruby application with postgres
[2014-04-29 06:00:14 -0400] rburton-: pg gem
[2014-04-29 06:00:32 -0400] otakup0pe: you mean an example of installing that gem ?
[2014-04-29 06:02:03 -0400] rburton-: pg to be exact
[2014-04-29 06:02:21 -0400] rburton-: It requires postgres client which when that all gets intsall is fine, then pg gem fails to build missing headers
[2014-04-29 06:02:43 -0400] rburton-: I think it's a problem with which version of ruby it tries to build it with. e.g., embedded ruby for chef
[2014-04-29 06:03:02 -0400] otakup0pe: you are specifying gem not chef_gem ?
[2014-04-29 06:03:23 -0400] otakup0pe: i do all my ruby stuff with rbenv and that's not what is giving me grief tonight so
[2014-04-29 06:03:24 -0400] rburton-: Well, in my build I have gem 'pg' and then when the bundle install runs it fails
[2014-04-29 06:03:34 -0400] otakup0pe: do you have postgres headers
[2014-04-29 06:03:45 -0400] otakup0pe: that is usually a seperate package. postgres-devel or something idk
[2014-04-29 06:03:49 -0400] rburton-: I have recipe[postgresql::client] which installs the headers
[2014-04-29 07:43:47 -0400] JensOfSw_: Heyas, is there a way when i register a chef client (with a firstboot script on the server) to add an item permanently to the runlist of that machine?
[2014-04-29 08:57:19 -0400] michael_mbp: hi all
[2014-04-29 08:58:02 -0400] michael_mbp: I've got override attributes in a role, how can i override them in the node ?
[2014-04-29 08:58:07 -0400] michael_mbp: force_override in the node?
[2014-04-29 09:00:24 -0400] double_p: michael_mbp: check http://docs.opscode.com/chef_overview_attributes.html#attribute-precedence - doesnt look good
[2014-04-29 09:01:41 -0400] laurent\: but the table says Node/recipe for case #14
[2014-04-29 09:02:01 -0400] laurent\: better try :)
[2014-04-29 09:02:52 -0400] michael_mbp: there's nothing about setting in node :/
[2014-04-29 09:03:18 -0400] michael_mbp: cool thanks.
[2014-04-29 09:03:23 -0400] double_p: but that would be valid for all nodes running that recipe?
[2014-04-29 09:05:11 -0400] michael_mbp: I want it to override for that node only
[2014-04-29 09:05:24 -0400] michael_mbp: i.e. ignore the role's override decl.
[2014-04-29 09:05:32 -0400] michael_mbp: the role has ufw firewall rules
[2014-04-29 09:05:37 -0400] michael_mbp: which I want to replace for the node.
[2014-04-29 09:05:46 -0400] michael_mbp: the ufw config is in a role[base]
[2014-04-29 09:05:55 -0400] michael_mbp: that's set on all our nodes.
[2014-04-29 09:08:24 -0400] double_p: i use simple_iptables, which writes the complete/resulting set into the node json; and i can add rules there directly. maybe ufw doing so, too?
[2014-04-29 09:12:10 -0400] michael_mbp: hmmm, will try this later today thanks.
[2014-04-29 09:46:05 -0400] Er00: I'm struggling to access environment attributes from a recipe, can anyone help?
[2014-04-29 09:46:35 -0400] Er00: I get "No resource, method, or local variable named `environment' for `Chef::Recipe "default"'
[2014-04-29 09:46:38 -0400] Er00: "
[2014-04-29 09:46:55 -0400] Er00: if I try and use environment to access them
[2014-04-29 09:47:09 -0400] Er00: but it doesn't look like they copy to the node on run
[2014-04-29 09:48:21 -0400] Er00: oh, maybe it does and I just can't type :$
[2014-04-29 09:51:47 -0400] Er00: Although I'm still struggling getting it to iterate over the values
[2014-04-29 09:52:23 -0400] Er00: My environment file has lines like:
[2014-04-29 09:52:25 -0400] Er00: "override_attributes": {
[2014-04-29 09:52:25 -0400] Er00:     "common": {
[2014-04-29 09:52:26 -0400] Er00:       "authentication": "10.10.223.9",
[2014-04-29 09:52:26 -0400] Er00:       "bi_collector": "10.10.223.12",
[2014-04-29 09:52:27 -0400] Er00:       "persistent_record": "10.10.223.11",
[2014-04-29 09:52:30 -0400] Er00:       "binary_storage": "10.10.223.15",
[2014-04-29 09:52:41 -0400] Er00: I'd like to loop over those, I'm currently using:
[2014-04-29 09:52:42 -0400] Er00: node[:common].each do |key, value| hostsfile_entry value do hostname  key action    :append end
[2014-04-29 09:52:45 -0400] Er00: end
[2014-04-29 09:52:53 -0400] Er00: wow, formatting fail :/ but hopefully you get the idea
[2014-04-29 09:53:14 -0400] Er00: but that isn't getting the correct key/value pairs out of the attribute
[2014-04-29 09:53:29 -0400] Er00: Error executing action `append` on resource 'hostsfile_entry[{"authentication"=>""}]'
[2014-04-29 10:25:39 -0400] Er00: It's all fine, apparently someone had committed *part* of an attribute as the recipe and that was what was tripping it up
[2014-04-29 12:28:05 -0400] torax: chef client seems to connect to chef workstation, from port 22 to ports 30,000 - 60,000. Can I change the destination port somehow. I dont like keeping that port range open.
[2014-04-29 12:35:47 -0400] michael_mbp: guys
[2014-04-29 12:36:11 -0400] michael_mbp: I just tried adding force_override to the node's JSON manifest
[2014-04-29 12:36:18 -0400] michael_mbp: but it didn't have any effect on the node
[2014-04-29 12:36:46 -0400] michael_mbp: the ufw firewall changes in a role were applied instead of the force_override detailed in the node JSON.
[2014-04-29 12:36:52 -0400] michael_mbp: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2014-04-29 12:37:11 -0400] michael_mbp: 14 should take precedence over 11
[2014-04-29 13:09:15 -0400] michael_mbp: wow.
[2014-04-29 13:09:17 -0400] michael_mbp: figured it out.
[2014-04-29 13:11:45 -0400] [[iilliinn]]: how do it search from a recipe all nodes that have attribute X?
[2014-04-29 13:14:15 -0400] ptrf: hey
[2014-04-29 13:14:31 -0400] ptrf: so I'm switching to chef-solo, and I'm trying to bootstrap a node
[2014-04-29 13:14:48 -0400] ptrf: but I need to hint ohai that it has to look for ec2 data
[2014-04-29 13:15:30 -0400] ptrf: so does anyone have some input as to what I can do
[2014-04-29 13:15:59 -0400] ptrf: I can make ohai return ec2 data if I make /etc/chef/ohai/hints/ec2.json and just put in {}
[2014-04-29 13:16:00 -0400] JensOfSweden: Is there a way with chef-client when i register (with a firstboot script) to add a permanent runlist item to the node? with -j run.json it only run it during the registration and doesnt add it to the runlist
[2014-04-29 13:58:49 -0400] cwj: JensOfSweden: in my experience, a run list provided via -j run.json will persist, but only if the chef-client run succeeds so that the client is able to save its state to the chef server
[2014-04-29 14:00:19 -0400] JensOfSweden: cwj: that was not the case when i tried :/
[2014-04-29 14:02:39 -0400] chris6131: Is there any way to set an attribute to nil in a json file? Like, I have an attribute that gets a default "foo", but I'd like the environment to override this to be nil. Making it "" in the json file is apparently not nil
[2014-04-29 14:03:58 -0400] cwj: chris6131: i believe "foo": null is the json equivalent of "foo" => nil in ruby
[2014-04-29 14:04:08 -0400] chris6131: oooh! Thanks I'll try that!
[2014-04-29 14:09:12 -0400] savant: Is there a way to disable templates being logged to stdout?
[2014-04-29 14:09:29 -0400] savant: I have log_level => info and verbose_logging => false
[2014-04-29 14:09:37 -0400] savant: doesnt seem to disable it.
[2014-04-29 14:20:52 -0400] chris6131: cwj: FWIW that doesn't actually seem to work. If I put null in my environment.json file it fails to override the cookbook's default. Changing null to "bar" does override, so I know I'm testing correctly.
[2014-04-29 14:27:28 -0400] cwj: chris6131: ah, well, i think you'll find it's syntactically valid json, but the details of chef's attribute merging dont allow nil to override in this case
[2014-04-29 14:27:31 -0400] cwj: https://tickets.opscode.com/browse/CHEF-4438
[2014-04-29 14:27:48 -0400] chris6131: yup
[2014-04-29 14:57:57 -0400] ptrf: hey guys
[2014-04-29 14:58:42 -0400] ptrf: can I update node data from within a ruby_block
[2014-04-29 14:58:53 -0400] ptrf: it seems like the answer is no, but I might be going the wrong way about it
[2014-04-29 15:02:36 -0400] programmerq: ptrf: I remember about a year ago calling node.save in the recipe, and then again in a ruby block
[2014-04-29 15:02:45 -0400] programmerq: we had some weirdness and weren't sure which way was right
[2014-04-29 15:02:49 -0400] programmerq: I never looked it up. :(
[2014-04-29 15:04:30 -0400] ptrf: programmerq: good one
[2014-04-29 15:04:31 -0400] ptrf: thanks
[2014-04-29 15:27:44 -0400] dotplus: Is their audio/video from chefconf posted online? I couldn't see any a link at http://chefconf.opscode.com/chefconf/
[2014-04-29 15:27:55 -0400] dotplus: s/their/there/g ugh
[2014-04-29 15:28:03 -0400] programmerq: dotplus: yeah, they posted chefconf 2014 videos on their youtube account
[2014-04-29 15:28:16 -0400] dotplus: ohok, I'll look there. thanks
[2014-04-29 15:28:20 -0400] programmerq: https://www.youtube.com/channel/UCvwl5-yXsQR5zluYPl8NEeQ
[2014-04-29 15:28:35 -0400] programmerq: I still need to watch a few talks
[2014-04-29 15:34:48 -0400] helfire: i have a remote file, it got a 404 not found (this is true) but it went on to write a 0 byte file
[2014-04-29 15:35:58 -0400] helfire: shouldnt i expect no file to be written if it got a 404?
[2014-04-29 15:37:35 -0400] programmerq: helfire: it's a reasonable expectation, but I am not surprised that it's writing an empty file.
[2014-04-29 15:39:22 -0400] helfire: the next converge it sees a file there and thinks it's good (no checksum, sure i could add one) but thats unexpected
[2014-04-29 15:57:00 -0400] brendan`: anyone able to recommend a good chef ebook/kindle/paperback for learning chef?
[2014-04-29 15:59:50 -0400] jtimberman: FYI, if you're running into service resource management issues with Ubuntu 14.04, it's likely that the service's /etc/init.d interface isn't a link to upstart-job, and is a shell script that exits 1 if you do /etc/init.d/SVC restart (e.g.). I reported a bug in rsyslog against Ubuntu, and just found this with ssh. https://bugs.launchpad.net/ubuntu/+source/openssh/+bug/1311810
[2014-04-29 16:04:59 -0400] martinisoft: jtimberman: Good to know
[2014-04-29 16:10:01 -0400] sam_: hello.     upgrading opensource chef , seems to be very very similar to a new install of chef.   does that sounds correct?     is there any difference.
[2014-04-29 16:12:23 -0400] bubu: Installing chef-client on a windows box that is already up and provisioned i.e. not boostrapped (yet), once the MSI package is installed what else needs to be done? Create a C:\etc\chef dir with validation key and a first-boot.json etc?
[2014-04-29 16:18:38 -0400] c_t: mattray: chef is looking for Go people now?
[2014-04-29 16:23:24 -0400] savant: Does anyone know how to tell chef-solo to not output template changes to stdout on a chef run?
[2014-04-29 16:26:17 -0400] mattray: c_t: not that I'm aware of, but engineering definitely prefers polyglots
[2014-04-29 16:27:16 -0400] c_t: mattray: saw it in the Partner Engineering thing and was a little surprised is all
[2014-04-29 16:27:29 -0400] gleam: savant: if you're concerned about a specific template, you can set the sensitive attribute
[2014-04-29 16:28:06 -0400] mattray: c_t: really just looking for modern programming aptitude
[2014-04-29 16:28:37 -0400] mattray: c_t: doing integrations with anything and everything. Clouds, networking, storage, whatever
[2014-04-29 16:30:54 -0400] savant: gleam: no thats not what I meant
[2014-04-29 16:31:07 -0400] savant: so I'm using packer to create ami's with chef-solo
[2014-04-29 16:31:33 -0400] savant: packer has a bug where if it hits a certain amount of logging output, it appears to buffer overflow and assume the command (chef-solo in this case) failed
[2014-04-29 16:31:43 -0400] savant: so it cant finish a chef run
[2014-04-29 16:31:51 -0400] savant: if I run with less output, then everything works
[2014-04-29 16:32:13 -0400] savant: so it would be quite nice if I could run without outputting the templates during a chef run.
[2014-04-29 16:40:10 -0400] savant: gleam: thoughts?
[2014-04-29 16:40:36 -0400] gleam: nope
[2014-04-29 16:44:03 -0400] JoeNuspl: savant: chef-solo --force-logger ?
[2014-04-29 16:47:29 -0400] savant: do you know if I can set that via a solo.rb config?
[2014-04-29 16:49:20 -0400] savant: hmmm
[2014-04-29 16:49:24 -0400] savant: force_logger true
[2014-04-29 16:49:26 -0400] savant: that might work
[2014-04-29 16:49:35 -0400] Gu_______: Hi, are attribute files within the same cookbook just processed in alphabetical order?
[2014-04-29 16:50:17 -0400] kkenny: from: http://docs.opscode.com/config_rb_solo.html ... log_level may be the option you want
[2014-04-29 16:50:56 -0400] helfire: how do i set the version in metatdata.rb from some ruby, eg: https://gist.github.com/erichelgeson/9d7816c0df2d5456f91d
[2014-04-29 16:51:41 -0400] helfire: i dont know what version is expecting, and i cant seem to give it a ruby var i set
[2014-04-29 16:56:59 -0400] savant: well that didnt work
[2014-04-29 16:57:24 -0400] savant: kkenny: I have it set at :info, should it be something else?
[2014-04-29 16:58:06 -0400] kkenny: savant: Haven't tried it, but I suspected that may do it, as default is set to auto
[2014-04-29 16:58:18 -0400] savant: :|
[2014-04-29 16:58:37 -0400] savant: verbose_logging = false
[2014-04-29 16:58:41 -0400] savant: log_level => :info
[2014-04-29 16:58:53 -0400] savant: force_logger => true
[2014-04-29 16:59:01 -0400] savant: still getting template output
[2014-04-29 16:59:07 -0400] JoeNuspl: Try adding "diff_filesize_threshold 0" to solo.rb
[2014-04-29 16:59:42 -0400] savant: hmmm ok
[2014-04-29 16:59:50 -0400] savant: i'll try that later today
[2014-04-29 16:59:54 -0400] savant: thanks for all the suggestions!
[2014-04-29 17:02:30 -0400] gyoza: quick question, i am super new to chef, does each node i want to connect need its own client?
[2014-04-29 17:04:07 -0400] aslaen: gyoza yes each node is considered a client and runs it's own chef-client daemon
[2014-04-29 17:04:20 -0400] gyoza: ok.
[2014-04-29 17:04:33 -0400] gyoza: i mean under chef-server there is a clients tab
[2014-04-29 17:04:42 -0400] gyoza: Each "node" needs its own entry there also?
[2014-04-29 17:04:59 -0400] aslaen: gyoza when you bootstrap a node it also adds it as a client.
[2014-04-29 17:05:05 -0400] jidar: hot damn mosh is awesome
[2014-04-29 17:05:08 -0400] gyoza: ok, i am adding stuff to my chef-server
[2014-04-29 17:05:13 -0400] gyoza: not booting new clients
[2014-04-29 17:05:21 -0400] gyoza:  havn't gotten that far yet:)
[2014-04-29 17:05:31 -0400] gyoza: i need to be able to make changes on all my servers at once
[2014-04-29 17:05:50 -0400] gyoza: got ec2knife working though, pretty stoked
[2014-04-29 17:06:17 -0400] aslaen: gyoza I use the command line, not the web interface so it may be different, but when I boot an instance on ec2 or any where else I run a "knife bootstrap" command
[2014-04-29 17:06:39 -0400] bean: aslaen: or `knife ec2 server create...`
[2014-04-29 17:07:07 -0400] gyoza: right, but i am just adding physical hardware nodes manually
[2014-04-29 17:07:12 -0400] bean: why?
[2014-04-29 17:07:19 -0400] bean: it will do that for you in the bootstrap process.
[2014-04-29 17:07:19 -0400] gyoza: is there a better way?
[2014-04-29 17:07:25 -0400] gyoza: hmm ok
[2014-04-29 17:08:09 -0400] bean: and by phyiscal hardware nodes are you talking like vmware or a true physical server?
[2014-04-29 17:08:53 -0400] gyoza: no like
[2014-04-29 17:08:58 -0400] gyoza: i got a pentium 4
[2014-04-29 17:09:01 -0400] gyoza: running centos
[2014-04-29 17:09:04 -0400] gyoza: been up for years
[2014-04-29 17:09:06 -0400] aslaen: bean yes that's true.  combining the server create from knife is great
[2014-04-29 17:09:23 -0400] gyoza: (example) lol
[2014-04-29 17:09:25 -0400] bean: gyoza: oof, so you're going to add config management on top of that?
[2014-04-29 17:09:28 -0400] gyoza: yes
[2014-04-29 17:09:33 -0400] gyoza: am i gonna die?
[2014-04-29 17:09:35 -0400] gyoza: lol
[2014-04-29 17:09:39 -0400] gyoza: yes..
[2014-04-29 17:09:47 -0400] gyoza: i know:(
[2014-04-29 17:09:58 -0400] gyoza: I inherited a huge mess
[2014-04-29 17:10:00 -0400] aslaen: gyoza is that pentium 4 your chef-server?
[2014-04-29 17:10:03 -0400] gyoza: no
[2014-04-29 17:10:07 -0400] gyoza: thats running on a celeron 266
[2014-04-29 17:10:12 -0400] gyoza: hahahaha jk
[2014-04-29 17:10:24 -0400] aslaen: gyoza ok so it's a running server and you are going to start managing it with chef
[2014-04-29 17:10:27 -0400] gyoza: yes
[2014-04-29 17:10:37 -0400] aslaen: gotcha.. ya I've always started from scratch as well.
[2014-04-29 17:10:38 -0400] gyoza: I have chef server running, wanna connect my older non managed nodes to it
[2014-04-29 17:11:09 -0400] gyoza: so the answer is, yes i need to create a client for each client and the node autocreates?
[2014-04-29 17:11:20 -0400] gyoza: i was just not sure.
[2014-04-29 17:11:31 -0400] bean: i'd bootstrap over SSH,
[2014-04-29 17:11:34 -0400] bean: it'll create both
[2014-04-29 17:24:31 -0400] VonUber: Whats the best way to set a variable unique to a node, that I can set it one recipe and then access it in another?
[2014-04-29 18:09:30 -0400] coderanger: VonUber: Does it need to presist?
[2014-04-29 18:09:34 -0400] coderanger: er, persist
[2014-04-29 18:15:25 -0400] redondos: what method do you recommend for firewall configuration using chef? i've been trying out iptables-ng this morning but it seems to be kind of unreliable, i am hesitant to add cookbooks that fail so easily to production runlists
[2014-04-29 18:15:29 -0400] redondos: any tips appreciated
[2014-04-29 18:19:39 -0400] troyready: redondos, we use that one and ufw and have been pretty happy with both
[2014-04-29 18:20:41 -0400] redondos: thanks, troyready. do you always use ufw for your ubuntu boxes, and iptables-ng for the rest?
[2014-04-29 18:20:51 -0400] redondos: (the latter removes the former AFAIK)
[2014-04-29 18:21:47 -0400] troyready: Yeah, how we chose to structure our chef usage makes keeping them separate normal for us
[2014-04-29 18:22:06 -0400] troyready: If that wasn't the case, we'd obviously just switch over to iptables-ng
[2014-04-29 18:22:19 -0400] troyready: Or a wrapper for it actually
[2014-04-29 18:22:50 -0400] redondos: that's what i'm attempting
[2014-04-29 18:26:36 -0400] redondos: troyready: one problem I'm running into is that when I remove a rule from a recipe, iptables-ng doesn't remove it from, say, /etc/iptables.d/filter/INPUT/ssh.rule_v4
[2014-04-29 18:26:40 -0400] redondos: have you ever encountered this issue?
[2014-04-29 19:00:05 -0400] mbailey: Hello everyone
[2014-04-29 19:00:34 -0400] mbailey: is there anyway to trigger an event on a node delete in chef?
[2014-04-29 19:02:13 -0400] mbailey: is there anyway to trigger an event on a node delete in chef?
[2014-04-29 19:07:08 -0400] coderanger: mbailey: Not that I'm aware of
[2014-04-29 19:07:18 -0400] coderanger: mbailey: the chef server doesn't expose those kinds of hooks
[2014-04-29 19:08:03 -0400] mbailey: coderanger:  I was afraid you were going to say that, i guess i'll have to use some sort of discovery system to clean up my dynamic dns entries
[2014-04-29 19:08:16 -0400] coderanger: mbailey: Are you using AWS?
[2014-04-29 19:08:25 -0400] mbailey: coderanger: no, pure openstack
[2014-04-29 19:08:38 -0400] coderanger: mbailey: What is doing the deleting? Heat?
[2014-04-29 19:09:07 -0400] mbailey: knife openstac
[2014-04-29 19:09:08 -0400] mbailey: k
[2014-04-29 19:09:20 -0400] mbailey: but it seems there is a compute.instance.delete event
[2014-04-29 19:09:23 -0400] mbailey: maybe I can hook into it
[2014-04-29 19:10:23 -0400] coderanger: Yeah
[2014-04-29 19:13:34 -0400] eucalyptus: is there a way with chef-solo/vagrant to obtain the current IP for use in an erb template?
[2014-04-29 19:15:16 -0400] coderanger: eucalyptus: node['ipaddress']
[2014-04-29 19:18:18 -0400] eucalyptus: coderanger: perfect.  thank you
[2014-04-29 19:48:12 -0400] Ron__: Anyone know what to due if chef-client hangs?  I tried "-l debug", but its not obvious why it is simply not moving past  "[Tue, 29 Apr 2014 19:39:41 +0000] DEBUG: Found recipe default in cookbook centos65-baseimage".  I see some GET calls ahead of it, but some appear to work others not clear if they have returned.
[2014-04-29 19:50:11 -0400] coderanger: Ron__: Pastebin the debug trace please
[2014-04-29 19:51:55 -0400] Ron__: @coderanger, here you go
[2014-04-29 19:51:57 -0400] Ron__: http://pastebin.com/4ZfXV5qf
[2014-04-29 19:52:13 -0400] Ron__: its the last n lines, not the whole thing.
[2014-04-29 19:58:02 -0400] coderanger: Ron__: Can you include the whole thing? It makes it hard to see the context
[2014-04-29 19:58:32 -0400] Ron__: ok, one sec
[2014-04-29 19:59:24 -0400] coderanger: i.e. this looks like it might be from the middle of a run, but its hard to tell
[2014-04-29 19:59:47 -0400] coderanger: I see a call to search, and a call to get a data bag
[2014-04-29 19:59:50 -0400] coderanger: nothing unusual
[2014-04-29 20:01:30 -0400] coderanger: Ron__: What is in the recipe it is processing there?
[2014-04-29 20:01:38 -0400] coderanger: Any chance it is hitting an infinite loop or similar?
[2014-04-29 20:02:28 -0400] Ron__: I don't think so, it simply just hangs
[2014-04-29 20:02:52 -0400] Ron__: it has been a while since I ran chef-client on this server, but nothing sticks out to me
[2014-04-29 20:04:12 -0400] troyready: redondos, hmmm, that's a good question. I'm not sure if I have
[2014-04-29 20:04:13 -0400] Ron__: cpu usage appears to be normal, just sitting there though
[2014-04-29 20:04:50 -0400] troyready: I think we may be at the point where we've really just expanded 'out' w/ our iptables-ng rules, and haven't closed any holes that we've opened. Or maybe we have sucessfully and I'm just not remembering, sorry
[2014-04-29 20:05:29 -0400] coderanger: Ron__: All I can recommend is to strace it and see what is happening
[2014-04-29 20:05:36 -0400] coderanger: Ron__: Make sure you use --no-fork when stracing
[2014-04-29 20:05:41 -0400] Ron__: agreed
[2014-04-29 20:06:01 -0400] Ron__: sorry taking so long, network is slow today :/
[2014-04-29 20:06:53 -0400] coderanger: Ron__: Might be related? :)
[2014-04-29 20:10:00 -0400] NukePuppy: anyone using chef-vault much?
[2014-04-29 20:12:21 -0400] Otterley: what's that?
[2014-04-29 20:15:04 -0400] troyready: I don't use it yet, but have been meaning to for some time. Love the architecture and happy to see it in chefdk
[2014-04-29 20:15:34 -0400] Otterley: We've got our own Vault that's etcd-based
[2014-04-29 20:15:46 -0400] Otterley: it's going into production once the rest of our replica hardware drops
[2014-04-29 20:16:47 -0400] Otterley: the Nordstrom vault doesn't seem to have an architecture document :/
[2014-04-29 20:28:03 -0400] nicgrayson: If a cookbook is uploaded and pinned in an environment is there any reason a node in that environment would run an old version of the cookbook?
[2014-04-29 20:28:49 -0400] nicgrayson: it's 0.2.9 but the node is running 0.2.8
[2014-04-29 20:29:03 -0400] gchristensen: nicgrayson: if the cookbook version solver szomehow restricts the versions, ie: cookbook A depends on your cookbook to be less than 1.5, and you wan tto be using 1.6
[2014-04-29 20:29:30 -0400] nicgrayson: it only has one cookbook on the runlist
[2014-04-29 20:30:14 -0400] nicgrayson: gchristensen: so there is no depends on it
[2014-04-29 20:31:17 -0400] nicgrayson: i confirmed that the metadata is correct on manage.opscode.com
[2014-04-29 20:33:16 -0400] Otterley: Make sure 'knife environment show' and 'knife node show' have the correct info.  I've seen issues where my repo looked correct, but it wasn't consistent with the state of Chef itself.
[2014-04-29 20:33:52 -0400] doomviking: NukePuppy: I tried using it, but ran into the chicken/egg problem and thought I'd wait a while before implementing
[2014-04-29 20:36:14 -0400] kedarm: Any guidance on how to implement http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html via chef? (disclaimer: I am a chef n00b :-) )
[2014-04-29 20:36:54 -0400] nicgrayson: kedarm: vpc works fine as long as you can ssh to the node
[2014-04-29 20:37:15 -0400] nicgrayson: kedarm: so just make sure your vpn is connected
[2014-04-29 20:37:19 -0400] kedarm: nicgrayson:  I have taken care of that by associating the ip with an interface in public subnet
[2014-04-29 20:38:56 -0400] nicgrayson: that is a way to do it. i just ssh to the private ip
[2014-04-29 20:40:00 -0400] arajakul: is there an environment variable for timestamp in chef?
[2014-04-29 20:40:08 -0400] kedarm: ok, but to implement that scenario via chef, what should I do with knife ec2 gem?
[2014-04-29 20:40:13 -0400] arajakul: i want to add a timestamp when chef runs to files,ect
[2014-04-29 20:41:08 -0400] bean: I'm confused as to what you're trying to accomplish, kedarm.
[2014-04-29 20:41:27 -0400] bean: just bootstrapping in VPC?
[2014-04-29 20:43:14 -0400] bean: arajakul: uhh, are you just wanting to know the last time chef ran?
[2014-04-29 20:43:16 -0400] kedarm: bean:  I want to do the setup and configuration as documented at http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_Scenario2.html through knife cmd line. Is that possible?
[2014-04-29 20:43:30 -0400] rburton-: Okay, so my problem is that doing execute command "gem install pg -- --with-pg-config='/usr/bin/pg_config'" is failing since the 'gem' that's being used is chef's installed version. How could I make sure the exeute command uses the 'newly installed' ruby version
[2014-04-29 20:43:33 -0400] kedarm: Or do I have to set it up using AWS console?
[2014-04-29 20:43:35 -0400] arajakul: bean nah just want a random marker, on a file creation
[2014-04-29 20:43:41 -0400] arajakul: if possible timestamp would be nice
[2014-04-29 20:43:48 -0400] arajakul: bean ^
[2014-04-29 20:44:06 -0400] rburton-: The path is set for when I login to include "/usr/local/rvm/rubies/ruby-2.0.0-p353/bin/gem" but during the chef run, it doesn't know that path
[2014-04-29 20:44:11 -0400] bean: kedarm: i think we set it up in  the console... I'm not sure that you can like, call VPC stuff from chef.
[2014-04-29 20:44:39 -0400] bean: arajakul: oh, so you just want a timestamp available in your recipe?
[2014-04-29 20:44:50 -0400] Otterley: (1) don't use rvm  (2) if you do use rvm or rbenv, you'll have to use a different provider than gem or execute
[2014-04-29 20:45:19 -0400] Otterley: or you'll have to provide an environment to  the execute resource so that the gem installation runs in the right context
[2014-04-29 20:45:40 -0400] rburton-: which provider would I need to use then to execute gem install?
[2014-04-29 20:46:18 -0400] arajakul: bean: yeah, i guess- if there arent any environment variables of that sort
[2014-04-29 20:46:21 -0400] rburton-: Seems like a major problem in the chef communicty is the load of cookbooks that are often broken depending on what you're doing
[2014-04-29 20:46:29 -0400] Otterley: if you're using rbenv, there's an rbenv_gem resource in the rbenv cookbook.  I assume there's something similar for rvm
[2014-04-29 20:46:41 -0400] bean: arajakul: I'd wager there isn't... What are you attempting to accomplish with this?
[2014-04-29 20:46:42 -0400] rburton-: ah let me try that
[2014-04-29 20:46:51 -0400] rburton-: well I'm using ruby_build
[2014-04-29 20:47:02 -0400] arajakul: bean: just add a timestamp or a marker on a file,
[2014-04-29 20:47:14 -0400] kedarm: bean:  ok, thanks. What is not clear is what part of the configuration should be already done via AWS and what part can be put in knife.rb.
[2014-04-29 20:47:15 -0400] bean: arajakul: /how/? like in the file name?
[2014-04-29 20:47:20 -0400] arajakul: yeah
[2014-04-29 20:47:21 -0400] bean: arajakul: or /why/
[2014-04-29 20:47:24 -0400] rburton-: ruby build used rvm to install the version of ruby
[2014-04-29 20:47:36 -0400] arajakul: to verify that the file wasnt created from a previous recipe
[2014-04-29 20:48:17 -0400] bean: arajakul: recipes are built to be idempotent, so if you're updating it, it should only be updated if something in the recipe makes it change.
[2014-04-29 20:48:28 -0400] bean: adding a timestamp breaks that paradigm
[2014-04-29 20:48:57 -0400] arajakul: i just want to add a verification, that the recipe ran
[2014-04-29 20:49:06 -0400] arajakul: using aws, so the script only runs on demand
[2014-04-29 20:49:36 -0400] rburton-: Using chef can be like playing with a perl.
[2014-04-29 20:49:41 -0400] rburton-: So many broken ways to do something
[2014-04-29 20:49:45 -0400] bean: arajakul:  why does using AWS make it only run on demand. Your verification that it ran would likely be in the chef log (/var/log/chef/client.log)
[2014-04-29 20:50:08 -0400] arajakul: bean: yea i understand but it looks like it doesnt log anything regarding my file creation
[2014-04-29 20:50:20 -0400] arajakul: (it doesnt replace the file it should)
[2014-04-29 20:50:32 -0400] bean: So that sounds like a bug in your recipe, mind sharing it?
[2014-04-29 20:52:23 -0400] arajakul: sure give me a sec to modify it a bit
[2014-04-29 20:53:50 -0400] arajakul: bean: https://gist.github.com/anonymous/42be406d4899f20501e2
[2014-04-29 20:53:59 -0400] arajakul: error.conf already exists from a deploy
[2014-04-29 20:54:02 -0400] rburton-: WIth each passing day, I sort of get very angry while using Chef because of how sloppy I feel all the cookbooks are. Is this a common feeling?
[2014-04-29 20:54:05 -0400] arajakul: looking to replace it with that recipe
[2014-04-29 20:54:35 -0400] arajakul: but running into a strange issue where it doesnt replace, but it will happily create a 2nd config file if i rename error.conf to error2.conf in the recipe
[2014-04-29 20:55:04 -0400] rburton-: Seems like there's no acceptable cookbook to install Ruby 2.0.x and all the books that install it, do so via RVM
[2014-04-29 20:55:36 -0400] gchristensen: rburton-: you could make an omnibus packaghe, that's what I did.
[2014-04-29 20:56:05 -0400] gleam: i've installed ruby 2.1.x with chef with both the ruby_build cookbook and the rbenv cookbook (which calls ruby_build)
[2014-04-29 20:56:08 -0400] gleam: basically, use ruby_build
[2014-04-29 20:56:10 -0400] arajakul: bean any idea?
[2014-04-29 20:56:19 -0400] bean: thinking, sec :)
[2014-04-29 20:56:26 -0400] arajakul: np, thanks :)
[2014-04-29 20:56:30 -0400] rburton-: fnichol/chef-ruby_build?
[2014-04-29 20:56:35 -0400] gleam: yep
[2014-04-29 20:56:40 -0400] bean: so, arajakul, how are you running this, just standard "chef-client"?
[2014-04-29 20:56:49 -0400] bean: and are you using chef server?
[2014-04-29 20:56:57 -0400] arajakul: yup via opsworks, after the initial deploy
[2014-04-29 20:56:59 -0400] arajakul: i am running a custom recipe
[2014-04-29 20:57:02 -0400] rburton-: When I tried that, it wasn't installing 2.0x but 1.9.x
[2014-04-29 20:57:02 -0400] bean: mk
[2014-04-29 20:57:11 -0400] gleam: you can specify which version to install
[2014-04-29 20:57:14 -0400] arajakul: initial deploy creates initial error.conf  ect
[2014-04-29 20:57:21 -0400] rburton-: do you have a sample I can look at?
[2014-04-29 20:57:43 -0400] gleam: if you look @ github in the "examples" section it has a few
[2014-04-29 20:58:03 -0400] gleam: ruby_build_ruby "1.9.3-p0" do
[2014-04-29 20:58:07 -0400] gleam: just change the version
[2014-04-29 20:58:08 -0400] rburton-: Let me try again. I'm rather burnt out by all of the books I went through thus far
[2014-04-29 20:58:12 -0400] bean: arajakul: have you tried using "template" rather than "cookbook_file"
[2014-04-29 20:58:32 -0400] arajakul: no but i heard there was no difference between the 2
[2014-04-29 20:58:47 -0400] bean: I'm not sure that that is true.
[2014-04-29 20:59:10 -0400] rburton-: gleam will that also install gem?
[2014-04-29 20:59:54 -0400] gleam: like the gem binary? pretty sure
[2014-04-29 20:59:54 -0400] bean: arajakul: so do you have access to a chef client.log after running it w/ opsworks?
[2014-04-29 20:59:57 -0400] gleam: or specific gems?
[2014-04-29 21:00:08 -0400] rburton-: Well, I need to use gem to install pg
[2014-04-29 21:00:23 -0400] rburton-: which has been troublesome and using application_ruby to install the application as well
[2014-04-29 21:00:25 -0400] rburton-: and configure the server
[2014-04-29 21:00:40 -0400] rburton-: I'll have to see how to get application_ruby to use the right ruby version as well
[2014-04-29 21:00:52 -0400] gleam: i'm fairly sure it installs rubygems, and then you can use the gem_package resource with the path to the 2.0.x gem binary specified
[2014-04-29 21:01:40 -0400] rburton-: e.g., gem_binary(".../gem")
[2014-04-29 21:01:58 -0400] gleam: right
[2014-04-29 21:02:21 -0400] gleam: you may want to look into using something like chruby or rbenv if rvm is too heavy
[2014-04-29 21:02:36 -0400] arajakul: bean yeah
[2014-04-29 21:02:45 -0400] bean: you could gist that log :)
[2014-04-29 21:02:47 -0400] arajakul: but it doesnt look like any information is there regarding that file creation
[2014-04-29 21:02:49 -0400] bean: of a full run
[2014-04-29 21:03:00 -0400] xmltok: is there anything like chef rewind for LWRPs?
[2014-04-29 21:03:20 -0400] bean: well, you could run using debug, if you have any way of changing what log level it runs at?
[2014-04-29 21:03:22 -0400] rburton-: The problem I had with ruby_build is it never finds the right version
[2014-04-29 21:03:26 -0400] rburton-: e.g., 2.0.0p247 not found
[2014-04-29 21:03:58 -0400] rburton-: different version number
[2014-04-29 21:03:59 -0400] rburton-: fuck me
[2014-04-29 21:04:01 -0400] rburton-: k brb
[2014-04-29 21:04:03 -0400] gleam: did you do 2.0.0p247 or 2.0.0-p247?
[2014-04-29 21:04:10 -0400] rburton-: former ;)
[2014-04-29 21:04:13 -0400] rburton-: ruby -v
[2014-04-29 21:04:14 -0400] rburton-: took that
[2014-04-29 21:04:17 -0400] gleam: https://github.com/sstephenson/ruby-build/tree/master/share/ruby-build
[2014-04-29 21:04:20 -0400] gleam: use those
[2014-04-29 21:04:30 -0400] rburton-: I did /usr/local/bin/ruby-build --definitions
[2014-04-29 21:04:35 -0400] gleam: or that.
[2014-04-29 21:04:53 -0400] rburton-: Lets see
[2014-04-29 21:05:03 -0400] xmltok: i was looking to patch the ruby_build LWRP because it doesnt work
[2014-04-29 21:05:05 -0400] xmltok: funny
[2014-04-29 21:05:31 -0400] gleam: ah the 2.1.x problem?
[2014-04-29 21:05:41 -0400] rburton-: Once I get this worked out, I'll have to see what I need to do in order to have application_ruby#rails use the right version
[2014-04-29 21:06:02 -0400] xmltok: its a readline problem with ruby, since they are taking forever to release a fixed version there is a patch that can be applied. the LWRP needs to be modified to supply a patch
[2014-04-29 21:06:10 -0400] xmltok: you can see that here https://github.com/fnichol/chef-ruby_build/pull/26
[2014-04-29 21:11:06 -0400] storme_away: in the ocean, noone can hear your bits scream...
[2014-04-29 21:11:50 -0400] rburton-: except for sharks
[2014-04-29 21:11:59 -0400] arajakul: bean: no that i know of, gonna try deleting the file first
[2014-04-29 21:12:55 -0400] helfire: with chefdk, it says it bundles chefspec, but how do i run rspec? seems like it's not in the path by default like kitchen is
[2014-04-29 21:18:01 -0400] helfire: n/m found the answer : https://github.com/opscode/chef-dk/issues/18
[2014-04-29 21:23:19 -0400] bean: arajakul: worth a shot, how are you running chef? is there a magic "opsworks does things now" button?
[2014-04-29 21:24:18 -0400] bean: (i have honestly no idea how opsworks works)
[2014-04-29 21:24:39 -0400] xorl: opsworks has a lot of magical buttons
[2014-04-29 21:24:44 -0400] xorl: it's just chef-solo though
[2014-04-29 21:24:57 -0400] bean: oh okay, so you just run chef-solo and it runs?
[2014-04-29 21:25:02 -0400] xorl: no
[2014-04-29 21:25:05 -0400] xorl: you click "deploy"
[2014-04-29 21:25:08 -0400] xorl: and it does it's thing
[2014-04-29 21:25:09 -0400] bean: ah okay.
[2014-04-29 21:25:22 -0400] bean: can you run chef without hitting deploy?
[2014-04-29 21:25:31 -0400] xorl: There are a ton of steps ahead of that to get it to deploy things
[2014-04-29 21:25:48 -0400] xorl: not really, opsworks is its own beast, I think you can run generic chef-solo stuff
[2014-04-29 21:26:01 -0400] xorl: it pulls down a whole repository then runs against that and has some other features that it ties within it
[2014-04-29 21:27:27 -0400] bean: I see, looks like 0 fun to debug
[2014-04-29 21:31:04 -0400] nicferrier: someone point me to an example of installing an rpm with a source file? I thought it would just be rpm_package "blah" do ; source "..." ; end
[2014-04-29 21:31:09 -0400] nicferrier: but that doesn't seem to work
[2014-04-29 21:33:49 -0400] bean: nicferrier: "Install a package using a specific provider" on http://docs.opscode.com/resource_package.html. You'll probably want to plop the RPM somewhere using cookbook_file or something
[2014-04-29 21:34:50 -0400] nicferrier: bean: I'm using vagrant and trying to do it at provision time but it can't seem to be found at /vagrant/filename.rpm
[2014-04-29 21:34:55 -0400] nicferrier: any idea why?
[2014-04-29 21:37:02 -0400] coderanger: nicferrier: Pastebin your recipe code
[2014-04-29 21:39:32 -0400] nicferrier: coderanger: it's alright. I think I found it. :-) thx anyway!
[2014-04-29 21:47:37 -0400] rburton-: gleam that worked well thanks bro
[2014-04-29 21:48:45 -0400] nicferrier: really? jesus.
[2014-04-29 21:50:54 -0400] xorl: nicferrier i've seen it :\
[2014-04-29 21:52:09 -0400] nicferrier: xorl: I didn't mean that the way you clearly thought I meant it.
[2014-04-29 21:52:16 -0400] xorl: ah
[2014-04-29 21:52:23 -0400] xorl: touche
[2014-04-29 21:53:17 -0400] renchap: any idea why i dont get email notifications for comments on one of my issues ?
[2014-04-29 21:54:14 -0400] garrett__: Are there 11.4 omnibus images for ubuntu12.04 floating around anywhere? it looks like EC2 just removed the Ubuntu12.04 AMI
[2014-04-29 21:54:25 -0400] garrett__: erp, sorry. 11.4 omnibus images for ubuntu14.04
[2014-04-29 22:01:21 -0400] Ron__: @coderanger, I have strace results, still trying to understand them.  But seeing "27671 futex(0x7feb6da844e4, FUTEX_WAIT_BITSET_PRIVATE|FUTEX_CLOCK_REALTIME, 8331, {1398807905, 493039000}, ffffffff) = -1 ETIMEDOUT (Connection timed out)" over and over and over and over....
[2014-04-29 22:12:48 -0400] coderanger: Whats before that
[2014-04-29 22:12:58 -0400] coderanger: is it waiting on an io read or something?
[2014-04-29 22:13:03 -0400] Ron__: A whole lot, about 150k lines
[2014-04-29 22:13:11 -0400] Ron__: still trying to parse through it
[2014-04-29 22:13:21 -0400] coderanger: Sure, I mean in the preceding dozen or so syscalls
[2014-04-29 22:13:36 -0400] Ron__: ok one sec
[2014-04-29 22:17:39 -0400] coderanger: That just means some other thread is probably doing something, so the question is what :)
[2014-04-29 22:18:33 -0400] Ron__: http://pastebin.com/hQrDrCu9
[2014-04-29 22:18:52 -0400] Ron__: the last line starts repeating.
[2014-04-29 22:20:43 -0400] jmickle: hey guys
[2014-04-29 22:20:47 -0400] jmickle: whats the opscode sales email?
[2014-04-29 22:20:50 -0400] jmickle: sales@opscode.com?
[2014-04-29 22:21:24 -0400] coderanger: jmickle: presumably @getchef.com now
[2014-04-29 22:21:26 -0400] rburton-: should be on their site
[2014-04-29 22:21:49 -0400] jmickle: ty coderanger
[2014-04-29 22:21:55 -0400] coderanger: Ron__: Look in /proc/<pid>
[2014-04-29 22:21:55 -0400] jmickle: why the change in the domain?
[2014-04-29 22:22:02 -0400] coderanger: Ron__: What do fd 6 and 7 point at
[2014-04-29 22:22:17 -0400] rburton-: marketing :)
[2014-04-29 22:22:23 -0400] rburton-: getfirefox type of method
[2014-04-29 22:22:44 -0400] coderanger: jmickle: In big enterprise shops people had never heard of "opscode", just "chef"
[2014-04-29 22:22:44 -0400] rburton-: like a lot of companies going "Source" e.g. SpringSource, MuleSource (Later MuleSoft)
[2014-04-29 22:22:49 -0400] coderanger: So the company renamed itself, kinda
[2014-04-29 22:22:54 -0400] jmickle: got it
[2014-04-29 22:22:56 -0400] coderanger: Most people still call it Opscode, myself included
[2014-04-29 22:23:00 -0400] jmickle: yeah me too
[2014-04-29 22:23:01 -0400] jmickle: :-P
[2014-04-29 22:23:09 -0400] rburton-: I call it chef to piss you guys off ;)
[2014-04-29 22:23:11 -0400] jmickle: we will still always be opscoders hehe
[2014-04-29 22:23:40 -0400] rburton-: One day I'll have to rewrite a few cookbooks e.g., Rails for instance
[2014-04-29 22:24:02 -0400] Ron__: @coderanger, checking
[2014-04-29 22:24:06 -0400] rburton-: To install, Rails, Ruby, Nginx, Passenger, etc correclty
[2014-04-29 22:24:24 -0400] jmickle: coderanger: this channel never ceases to be short of trolls lately huh?
[2014-04-29 22:24:58 -0400] rburton-: It's IRC, a place where people share their complaints, opinions, bathroom habits and sexual preferences
[2014-04-29 22:25:02 -0400] rburton-: since the 90s
[2014-04-29 22:25:03 -0400] coderanger: Ron__: Guessing 6 might be a network socket, in which case you'll need to use lsof to find what it is connected to
[2014-04-29 22:25:17 -0400] Ron__: @coderanger, cool ok
[2014-04-29 22:25:26 -0400] Ron__: no better time to learn :)
[2014-04-29 22:25:37 -0400] coderanger: Ron__: 2803  select(7, [6], NULL, NULL, {300, 0} <unfinished ...>
[2014-04-29 22:25:45 -0400] coderanger: Ron__: thats likely where things are blocked
[2014-04-29 22:25:51 -0400] Ron__: ok
[2014-04-29 22:26:11 -0400] coderanger: Ron__: And you can see the [6] as the readfd it is waiting on
[2014-04-29 22:26:21 -0400] coderanger: Someting is waiting for data
[2014-04-29 22:26:22 -0400] coderanger: :)
[2014-04-29 22:27:31 -0400] jmickle: ;-)
[2014-04-29 22:27:32 -0400] coderanger: Ron__: Should be lsof -p <pid> -d 6
[2014-04-29 22:27:33 -0400] coderanger: I think
[2014-04-29 22:27:38 -0400] coderanger: but its been a while
[2014-04-29 22:31:17 -0400] jmickle: how are things going these days coderanger?
[2014-04-29 22:31:48 -0400] coderanger: jmickle: They thunder on, sick and hiding at home while I try to get my monitorama talk ready
[2014-04-29 22:31:56 -0400] jmickle: ahhh
[2014-04-29 22:32:02 -0400] jmickle: yeah ive been quiet lately
[2014-04-29 22:32:09 -0400] jmickle: slipped under the radar for a little bit
[2014-04-29 22:32:24 -0400] jmickle: seems like some other did as well?
[2014-04-29 22:32:57 -0400] coderanger: jmickle: This will be my 5th con talk in 4 weeks, so been a bit backed up :)
[2014-04-29 22:33:19 -0400] jmickle: hehehe awesome :-)
[2014-04-29 22:33:24 -0400] jmickle: congrats man
[2014-04-29 22:35:27 -0400] icarus: hello all
[2014-04-29 22:36:01 -0400] jmickle: greeting icarus
[2014-04-29 22:36:07 -0400] icarus: can anyone think of a constructive way to set CustomLog to combined rather than common via apache2 cookbook
[2014-04-29 22:36:24 -0400] icarus: theres no node attribute for it
[2014-04-29 22:36:45 -0400] icarus: other than a recipe that uses sed...im sure theres a cleaner method
[2014-04-29 22:37:24 -0400] coderanger: icarus: rewind the template and use your own
[2014-04-29 22:37:37 -0400] coderanger: icarus: Or just do it in your vhost
[2014-04-29 22:38:29 -0400] aalmenar: Hi everyone
[2014-04-29 22:38:49 -0400] Ron__: @coderanger http://pastebin.com/KUvGFrYg
[2014-04-29 22:38:56 -0400] aalmenar: somebody nows a way to tel the chef-client the binary to use on all calls to gem_package
[2014-04-29 22:38:59 -0400] aalmenar: ??
[2014-04-29 22:39:11 -0400] aalmenar: i know about gem_binary on gem_package
[2014-04-29 22:39:28 -0400] aalmenar: but what about gem_package of cookbooks downloaded with berkshelf
[2014-04-29 22:39:46 -0400] jmickle: what do you mean aalmenar
[2014-04-29 22:40:08 -0400] coderanger: Ron__: o_O Are you using anything that pokes dbus?
[2014-04-29 22:40:13 -0400] aalmenar: i have omnibus chef installed
[2014-04-29 22:40:23 -0400] aalmenar: and i have ruby installed with rbenv
[2014-04-29 22:40:31 -0400] coderanger: aalmenar: No, you have to set it each time or fix your path
[2014-04-29 22:40:58 -0400] Ron__: @coderanger, you mean like installing a package from a local yum server?
[2014-04-29 22:41:12 -0400] coderanger: Ron__: No, dbus is the system IPC framework in Linux
[2014-04-29 22:41:22 -0400] Ron__: oh ha, thought you meant our company name
[2014-04-29 22:41:27 -0400] Ron__: no, not that i am aware of
[2014-04-29 22:41:42 -0400] aalmenar: coderanger: path is fixed on login shell with rbenv.sh
[2014-04-29 22:41:47 -0400] coderanger: Ron__: Can you pastebin the recipe that it is pausing on?
[2014-04-29 22:42:00 -0400] aalmenar: but chef-client doesnt run with thos variable loaded
[2014-04-29 22:42:00 -0400] coderanger: aalmenar: Most services don't run in a login shell :-)
[2014-04-29 22:42:38 -0400] aalmenar: so, with rbenv, i set on my cookbooks the path to the gem binary, thats not a problem
[2014-04-29 22:43:07 -0400] aalmenar: but other cookbooks downloaded with berkshelf this doesn't work that way
[2014-04-29 22:43:22 -0400] aalmenar: unless in my /wrapper|whater) cookbook type
[2014-04-29 22:43:32 -0400] Ron__: @codranger, I am trying :)
[2014-04-29 22:43:36 -0400] coderanger: aalmenar: ENV['PATH'] = '' in your base recipe
[2014-04-29 22:44:51 -0400] coderanger: aalmenar: Or just be explicit about it
[2014-04-29 22:45:14 -0400] aalmenar: ok, will check about it
[2014-04-29 22:45:19 -0400] aalmenar: thanks coderanger
[2014-04-29 22:45:51 -0400] Ron__: @coderanger, you the man
[2014-04-29 22:45:55 -0400] Ron__: disk issue
[2014-04-29 22:46:47 -0400] Ron__: can't ls directory
[2014-04-29 22:46:49 -0400] Remi-Datadog: Hi
[2014-04-29 22:46:57 -0400] Ron__: corrupt somehow
[2014-04-29 22:47:36 -0400] coderanger: Ron__: Grab smartctl and check for disk failure?
[2014-04-29 22:47:46 -0400] Ron__: cool thanks
[2014-04-29 22:47:49 -0400] Remi-Datadog: I'm getting unsafe dependencies issues with Omnibus 3.0.0 that I was not having with omnibus 2.0.1:
[2014-04-29 22:47:49 -0400] Remi-Datadog: [health_check]     --> /opt/datadog-agent/embedded/lib/libcurl.so.4.2.0
[2014-04-29 22:47:50 -0400] Remi-Datadog: [health_check]     --> /opt/datadog-agent/embedded/lib/python2.7/site-packages/pycurl.so
[2014-04-29 22:47:50 -0400] Remi-Datadog: [health_check]     --> /opt/datadog-agent/embedded/lib/python2.7/lib-dynload/_hashlib.so
[2014-04-29 22:47:51 -0400] Remi-Datadog: [health_check]     --> /opt/datadog-agent/embedded/lib/python2.7/lib-dynload/_ssl.so
[2014-04-29 22:49:20 -0400] Remi-Datadog: I can't find anything in the github issue tracker related to that
[2014-04-29 22:49:27 -0400] Remi-Datadog: does it sound familiar to anyone ?
[2014-04-29 22:49:52 -0400] coderanger: Remi-Datadog: Is it incorrect?
[2014-04-29 22:50:03 -0400] coderanger: read: if you use ldd, do you see any external links
[2014-04-29 22:52:10 -0400] Remi-Datadog: I do, but why would it change between between omnibus 2.0.1 and omnibus 3.0.0 given that i'm using the same software definitions ?
[2014-04-29 22:52:16 -0400] Remi-Datadog: has the whitelist changed ?
[2014-04-29 22:52:22 -0400] coderanger: Remi-Datadog: Myabe it was a bug fix? :)
[2014-04-29 22:55:20 -0400] Remi-Datadog: http://www.diffchecker.com/vpkead24
[2014-04-29 22:55:25 -0400] Remi-Datadog: this is the diff
[2014-04-29 22:55:38 -0400] icarus: coderanger: i figured it out
[2014-04-29 22:55:44 -0400] icarus: there was a template for the vhosts
[2014-04-29 22:55:46 -0400] icarus: easy fix
[2014-04-29 22:55:52 -0400] Remi-Datadog: the only difference is that there are more whitelisted libs in 3.0.0
[2014-04-29 22:55:56 -0400] icarus: thanks for pointing me in the right direction
[2014-04-29 22:56:01 -0400] icarus: btw, quick question
[2014-04-29 22:56:02 -0400] Remi-Datadog: http://www.diffchecker.com/vpkead24
[2014-04-29 22:56:13 -0400] icarus: what is everyones reason for using Chef over say, Puppet or Salt or Ansible?
[2014-04-29 22:56:42 -0400] icarus: (just because thats what your company was already using, and now its too much of a pain in the ass to port over to salt?)
[2014-04-29 22:56:48 -0400] coderanger: Remi-Datadog: I'm not sure what you are really asking, it sounds like there was a bug in an older version that didn't catch certain bad links, and this is now fixed
[2014-04-29 22:56:58 -0400] savant: I like ruby
[2014-04-29 22:57:01 -0400] coderanger: icarus: Thats a bit of a long answer
[2014-04-29 22:57:09 -0400] savant: and dont like the puppet way of doing things
[2014-04-29 22:57:15 -0400] Remi-Datadog: coderanger: Do you have any link to that bug fix ?
[2014-04-29 22:57:17 -0400] coderanger: icarus: But short version, Yaml (and other made up langs) aren't very good for pogramming
[2014-04-29 22:57:19 -0400] coderanger: Remi-Datadog: Nope
[2014-04-29 22:57:32 -0400] savant: salt and ansible are newer. i'll let other people figure out the best way to do those before jumping on the bandwagon
[2014-04-29 22:57:37 -0400] coderanger: Remi-Datadog: But your question is still "why is this software more correct now?" :)
[2014-04-29 22:57:49 -0400] Remi-Datadog: exactly
[2014-04-29 22:57:52 -0400] Remi-Datadog: also
[2014-04-29 22:58:04 -0400] Remi-Datadog: i'm going to check with the latests software definitions in omnibus-software
[2014-04-29 22:58:11 -0400] Remi-Datadog: but i don't think that's the issue
[2014-04-29 22:58:25 -0400] Remi-Datadog: (the dependencies failing are related to python and curl..)
[2014-04-29 22:58:38 -0400] icarus: coderanger: i havent messed with yaml extensibly
[2014-04-29 22:58:41 -0400] coderanger: icarus: Ansible's model is fine for ~5 servers, much beyond that an agentless and/or push-driven models break down
[2014-04-29 22:58:54 -0400] icarus: coderanger: i see your point
[2014-04-29 22:59:04 -0400] icarus: coderanger: i know a company that uses it for thousands
[2014-04-29 22:59:29 -0400] icarus: i take that back, *hundreds
[2014-04-29 22:59:39 -0400] coderanger: icarus: Salt is relatively fine, but doesn't offer much in the way of composable abstractions which disqualifies it in my book
[2014-04-29 22:59:43 -0400] icarus: WPEngine uses ansible for all of their deploys
[2014-04-29 23:00:04 -0400] coderanger: and puppet's server architecture is batshit insane
[2014-04-29 23:00:07 -0400] savant: icarus: im quickly discovering that the folks at wpengine aren't the best model to use for justifying anything...
[2014-04-29 23:00:15 -0400] coderanger: (though I've heard they are fixing at least some of it)
[2014-04-29 23:00:33 -0400] coderanger: icarus: Not saying you can't do it, just that its not a good tool anymore
[2014-04-29 23:00:47 -0400] icarus: coderanger: what does the term composable abstrations mean?
[2014-04-29 23:00:49 -0400] coderanger: icarus: Push-based deploys, yes, but not for idempotent state management
[2014-04-29 23:00:59 -0400] coderanger: icarus: Building bigger abstractions on top of smaller ones
[2014-04-29 23:01:06 -0400] icarus: savant: they're growing crazy fast
[2014-04-29 23:01:12 -0400] icarus: and wouldn't hire me :/
[2014-04-29 23:01:20 -0400] savant: haha
[2014-04-29 23:01:50 -0400] savant: im just saying that my company debugging their operational issues doesn't exactly reflect well upon them
[2014-04-29 23:02:01 -0400] coderanger: People are really bad at thinking in deltas, much better to just state the total desired state of the system and let the tools work
[2014-04-29 23:02:04 -0400] savant: (not that I mind figuring out why their caching setup is batshit insane)
[2014-04-29 23:02:22 -0400] coderanger: (see also, chef-metal, cloudformation/heat, etc)
[2014-04-29 23:02:28 -0400] savant: at some point two weeks ago, they realized that they hadn't run some CM tool against a subset of their servers
[2014-04-29 23:02:33 -0400] savant: "oops" indeed.
[2014-04-29 23:02:45 -0400] savant: basically turned off any sort of caching, apc, etc.
[2014-04-29 23:03:05 -0400] savant: idk if thats tooling (not used ansible in prod, so I cant say) or procedure
[2014-04-29 23:03:07 -0400] savant: but yeah
[2014-04-29 23:03:10 -0400] icarus: coderanger: i had a use-case for chef-solo not long ago, but couldn't quite get it going without several recipe re-writes. masterless puppet seemed easier last time i tried it
[2014-04-29 23:03:31 -0400] icarus: ^ this is my only real problem with chef so far
[2014-04-29 23:03:33 -0400] coderanger: icarus: chef-solo is rarely a useful solution on its own
[2014-04-29 23:03:34 -0400] savant: im using chef-solo in production for ~50-60 nodes
[2014-04-29 23:03:38 -0400] coderanger: you need a control plane for it
[2014-04-29 23:03:51 -0400] coderanger: knife-solo + berkshelf is the bare minimum of a control system for it
[2014-04-29 23:03:57 -0400] savant: its kinda weird, but it works well enough
[2014-04-29 23:04:02 -0400] coderanger: but even that has all the same issues as ansible
[2014-04-29 23:04:21 -0400] coderanger: so most people end up cobbling together their own control plane
[2014-04-29 23:04:29 -0400] icarus: i like the idea of just maintaining a chef-repo and having chef-solo pull updates on boot, and then issuing an update for a chef-solo run via jenkins whenever there is a deploy
[2014-04-29 23:04:44 -0400] icarus: coderanger: that seems like a good summary
[2014-04-29 23:04:47 -0400] coderanger: icarus: That would be an example of an adhoc control plane :)
[2014-04-29 23:04:50 -0400] savant: coderanger: whats a control-plane
[2014-04-29 23:04:56 -0400] savant: oh
[2014-04-29 23:05:05 -0400] coderanger: savant: The thing sitting behind chef-solo, controlling it, moving data around ,etc
[2014-04-29 23:05:09 -0400] savant: mmm
[2014-04-29 23:05:15 -0400] coderanger: savant: terminology is from hardware, a la blade servers
[2014-04-29 23:05:25 -0400] savant: yeah just didnt know what your context was here :)
[2014-04-29 23:05:29 -0400] icarus: savant: thats about the server size im managing right now too
[2014-04-29 23:05:31 -0400] coderanger: data plane vs control plane
[2014-04-29 23:05:42 -0400] icarus: coderanger: the ad-hoc appeals to me
[2014-04-29 23:05:47 -0400] savant: icarus: yeah chef-solo works well enough for us
[2014-04-29 23:06:01 -0400] icarus: faster boot times for variable server(s) an a scaling group
[2014-04-29 23:06:05 -0400] savant: I use this for managing the chef-solo runs: https://github.com/josegonzalez/chef-solo-cup
[2014-04-29 23:06:06 -0400] coderanger: icarus: ::shrug::, it works, but consider your design carefully
[2014-04-29 23:06:26 -0400] savant: that plus ASGs on aws works well enough.
[2014-04-29 23:06:27 -0400] coderanger: icarus: Notably most solo-based systems lack adequate mechanisms for managing cookbook releases
[2014-04-29 23:07:17 -0400] icarus: hmmm, i can think of a few ways
[2014-04-29 23:07:34 -0400] icarus: i dont mind leaving the beaten path though
[2014-04-29 23:07:52 -0400] coderanger: icarus: When it breaks, you get to keep all the pieces ;-)
[2014-04-29 23:08:25 -0400] icarus: in this use case, theres not too man cookbook release changes
[2014-04-29 23:08:41 -0400] icarus: it seems like a berksfile.lock could handle it
[2014-04-29 23:08:49 -0400] icarus: mere speculation though, im heading back to work
[2014-04-29 23:08:59 -0400] icarus: thanks for the input though!
[2014-04-29 23:21:26 -0400] randingo: i have a chicken-egg situation with pem files and encrypted dbags.  We're trying to use a cookbook_file resource to copy the pem to its location prior to setting a pswd variable.  When the recipe runs, during compilation phase an error occurs that the file does not exist.  Any guidance would be appreciated.
[2014-04-29 23:21:44 -0400] coderanger: randingo: Why would you do that?
[2014-04-29 23:21:50 -0400] randingo: =]
[2014-04-29 23:21:59 -0400] coderanger: storing the encryption keys within chef removes most of the benefit
[2014-04-29 23:22:43 -0400] coderanger: You need to manage the keys outside of chef
[2014-04-29 23:22:47 -0400] randingo: so the keys should be stored somewhere else?
[2014-04-29 23:22:51 -0400] randingo: ok
[2014-04-29 23:22:55 -0400] coderanger: which is why encrypted bags are much less useful than they might initial appear
[2014-04-29 23:23:56 -0400] randingo: yeah, i watched the segment of your talk regarding secrets management, with reference to lack of effectiveness
[2014-04-29 23:24:18 -0400] coderanger: :-)
[2014-04-29 23:24:27 -0400] coderanger: I mean its super effective at what it was intended for
[2014-04-29 23:24:44 -0400] coderanger: which is very specific "if there is an offline data breach of the chef server, secrets can't be read"
[2014-04-29 23:24:54 -0400] coderanger: encrypted bags do that quite well
[2014-04-29 23:26:09 -0400] randingo: that makes sense.  yeah, i have general questions regarding this feature that it's just a formality.  a warm fuzzy for someone else.
[2014-04-29 23:28:28 -0400] randingo: the appliance we're delivering won't have a guarantee to access to S3 etc.
[2014-04-29 23:28:59 -0400] randingo: second options for managed outside of chef?
[2014-04-29 23:34:09 -0400] coderanger: randingo: Not sure what you mean
[2014-04-29 23:38:41 -0400] randingo: i'm looking for another option/example of where to store the pem's if they're not within Chef.  As well as regards to recipe testability, when they include encrypted databags and pem dependencies.
[2014-04-29 23:44:52 -0400] coderanger: randingo: Just bake the secrets in to the appliance
[2014-04-29 23:45:03 -0400] coderanger: randingo: Or use something like chef-vault
[2014-04-29 23:45:50 -0400] randingo: ok, thanks.
