[2014-04-11 00:52:03 -0400] mmms: Hi, I'm trying to use chef-solo to install a few packages. I created a cookbooks/recipies/default.rb and solo.rb with the default path, but i get Compiling Cookbook Converging 0 resources ... Does anybody know what I am forgeting?
[2014-04-11 00:55:09 -0400] mmms: Hi, I'm trying to use chef-solo to install a few packages. I created a cookbooks/recipies/default.rb and solo.rb with the default path, but i get Compiling Cookbook Converging 0 resources ... Does anybody know what I am forgeting?
[2014-04-11 01:06:06 -0400] mmms: maybe it's cause i forgot the run-list...
[2014-04-11 01:35:58 -0400] mmms: made a run_list in a json in file in a data_bags directory and added it to the solo.rb file, but still can't get it to working...
[2014-04-11 02:22:38 -0400] someara: coderanger what's the name of the python's version of cpan/rubygems/npm/whatever
[2014-04-11 02:23:26 -0400] someara: PyPi?
[2014-04-11 02:23:29 -0400] savant: yes
[2014-04-11 02:23:35 -0400] savant: https://pypi.python.org/pypi
[2014-04-11 02:23:37 -0400] savant: ^pypi
[2014-04-11 02:31:25 -0400] aslaen: mmms: a great example of this is gettingstartedwithchef.com
[2014-04-11 02:36:49 -0400] coderanger: someara: Thats the server half, the client/installer half is pip
[2014-04-11 02:37:23 -0400] someara: just making slides.. wanted to be sure I called it the right thing
[2014-04-11 02:45:36 -0400] coderanger: someara: Notably it is PyPI, not PyPi
[2014-04-11 02:45:44 -0400] coderanger: pronounced Pie Pee Eye
[2014-04-11 02:45:57 -0400] coderanger: Not Pie Pie, which is a different thing :)
[2014-04-11 02:46:01 -0400] someara: noted
[2014-04-11 07:47:59 -0400] Matt_P1: Hi! I have an issue with a run_list which does not execute in the right order, do you have any clue of why ?
[2014-04-11 07:50:38 -0400] srenatus: Matt_P1: try running chef-{client,solo} with -ldebug and have a look at that happens, ie. what includes what
[2014-04-11 07:52:27 -0400] Matt_P1: My run_list is like this:
[2014-04-11 07:52:28 -0400] Matt_P1:     "recipe[generic-users]",
[2014-04-11 07:52:29 -0400] Matt_P1:     "recipe[sudo]",
[2014-04-11 07:52:29 -0400] Matt_P1:     "recipe[base]",
[2014-04-11 07:52:29 -0400] Matt_P1:     "recipe[omz]"
[2014-04-11 07:52:51 -0400] Matt_P1: for some reason, omz is ran first
[2014-04-11 07:53:19 -0400] srenatus: sure about this? maybe generic-users somewhere does include_recipe 'omz'
[2014-04-11 07:53:28 -0400] srenatus: there's no way to answer this genericly
[2014-04-11 07:53:49 -0400] srenatus: if that's your runlist and nothing does include_recipe, yes, then it should run generic-users::default first
[2014-04-11 07:56:20 -0400] Matt_P1: the only "weird" thing I did is that I base my omz recipe on generic_users, ie the code looks the same : I loop across users to see if they are using zsh, and install oh-my-zsh if they do
[2014-04-11 07:56:29 -0400] Matt_P1: to get the users, I do : active_users = GenericUsers::User::search("( #{groups_q} ) AND -shell:false")
[2014-04-11 07:57:03 -0400] Matt_P1: but none of those recipes includes anything
[2014-04-11 07:58:30 -0400] Matt_P1: Should I add a "depends generic-users" in metadata.rb of omz or it's unrelated ?
[2014-04-11 09:32:37 -0400] chef_newbie: knife configure --initial WARNING: No knife configuration file found Where should I put the config file? [/root/.chef/knife.rb] /root/chef-repo/.chef/knife.rb ERROR: Ohai::Exceptions::DependencyNotFound: Can not find a plugin for dependency os
[2014-04-11 09:32:53 -0400] chef_newbie: please help!
[2014-04-11 10:53:07 -0400] phutchins: morning
[2014-04-11 11:03:04 -0400] phutchins: anyone have experience compiling chef-server from omnibus?
[2014-04-11 11:06:20 -0400] vegardx: phutchins: I've not touched it with a ten foot pole. If it doens't mess up your system, it's going to do so. I've yet to see anyone not breaking other packages on the system when they do things like that.
[2014-04-11 11:08:05 -0400] phutchins: vegardx: :) good to know. I'm using a system that I can nuke if needed tho, or coudl do it on a VM...
[2014-04-11 11:08:25 -0400] phutchins: are you talking about compiling or even r unning the compiled server?
[2014-04-11 11:08:46 -0400] vegardx: I'm talking about using the packages provided by opscode. Or the omnibus installer.
[2014-04-11 11:09:35 -0400] phutchins: oh, i'm talking about the omnibus repo that allows you to compile chef-server from source
[2014-04-11 11:09:59 -0400] phutchins: I've somehow managed to get the omnibus install working just fine however :)
[2014-04-11 11:10:13 -0400] vegardx: Unless you have any specific needs to stay bleeding edge, I'd recommend going down the stable or testing route of your distrobution of choice.
[2014-04-11 11:10:19 -0400] phutchins: i do
[2014-04-11 11:10:28 -0400] phutchins: i'm needing to get around the bug thats not fixed in the package yet...
[2014-04-11 11:10:36 -0400] phutchins: it keeps biting me and i'd save a lot fo time to get around it
[2014-04-11 11:10:46 -0400] vegardx: I'm sure it's no problem getting it working, but suddenly your distrobution changes how things are done, and things break. Massivly.
[2014-04-11 11:10:51 -0400] phutchins: http://phutchins.com/blog/2014/03/04/tracking-down-the-chef-server-missing-dependency-bug/
[2014-04-11 11:11:10 -0400] phutchins: ^ the bug...
[2014-04-11 11:11:38 -0400] phutchins: Well i'm running all of our stuff on the same Ubuntu image
[2014-04-11 11:11:47 -0400] vegardx: Then stop including recipes that are not actually there. Problem fixed. :)
[2014-04-11 11:11:58 -0400] phutchins: hah its not MY cookbooks :)
[2014-04-11 11:12:14 -0400] phutchins: and it seems to not be as simple as I thought also
[2014-04-11 11:12:23 -0400] phutchins: i've found that when running two cookbooks separately, everything works just fine
[2014-04-11 11:12:26 -0400] phutchins: but when run together, they b reak.
[2014-04-11 11:12:44 -0400] vegardx: I can't say I've ever stumbled upon that problem.
[2014-04-11 11:12:54 -0400] vegardx: Running multiple recipes, roles and enviroments all together.
[2014-04-11 11:13:14 -0400] phutchins: My thought is that they b oth require a certain cookbook of different versions and one cookbook overrides the other... but i have little to base that on
[2014-04-11 11:13:26 -0400] phutchins: its only two certain recipes. not any multiple recipes
[2014-04-11 11:14:16 -0400] phutchins: as i noted in the blog post you can use the knife chef ami to expose the bug. so i check each on its own, and results come back fine
[2014-04-11 11:14:26 -0400] phutchins: but when together it kills the server and requires a restart
[2014-04-11 11:14:59 -0400] phutchins: my next step (aside from compiling chef server) is to compare the outputs of each api call for the two cookbooks by themselves
[2014-04-11 11:15:11 -0400] vegardx: Have fun! :-3
[2014-04-11 11:15:14 -0400] phutchins: and see the common cookbooks with different versions...
[2014-04-11 11:15:17 -0400] phutchins: thx. :P
[2014-04-11 11:16:29 -0400] phutchins: still would like to give a shot at compiling chef-server...
[2014-04-11 11:16:45 -0400] phutchins: it could help the community as I'd be helping to test before the next release
[2014-04-11 11:16:52 -0400] phutchins: and I'd love to give back if I'm able
[2014-04-11 11:36:02 -0400] andreeb: any one with aws opscode chef script configuration ideas?
[2014-04-11 11:36:21 -0400] andreeb: WARN: Cookbook 'yum-epel' is empty or entirely chefignored at /opt/aws/opsworks/current/merged-cookbooks/yum-epel
[2014-04-11 11:37:31 -0400] andreeb: not sure if this is a symlink issue er what
[2014-04-11 11:39:21 -0400] andreeb: s/opscode/opsworks/g
[2014-04-11 11:39:26 -0400] andreeb: aws
[2014-04-11 11:53:25 -0400] nobody18188181: when using knife upload; are there other ports that knife needs to communicate on besides 443?
[2014-04-11 11:53:41 -0400] bmhatfield: Just 443.
[2014-04-11 11:54:07 -0400] nobody18188181: have you ever seen this issue? /opt/chef/embedded/lib/ruby/1.9.1/uri/generic.rb:213:in `initialize': the scheme https does not accept registry part: :443 (or bad hostname?)
[2014-04-11 11:54:22 -0400] nobody18188181: i thought maybe firewall was the problem
[2014-04-11 12:26:27 -0400] bmhatfield: nobody18188181: A bunch of people were complaining about the same thing yesterday I think, but I did not see a resolution.
[2014-04-11 12:26:41 -0400] bmhatfield: This channel is logged, you could go back through yesterday's chatlogs online and see.
[2014-04-11 12:26:49 -0400] bmhatfield: I think they are hosted on opscode's site somewhere.
[2014-04-11 12:52:11 -0400] nobody18188181: bmhatfield: issue was SELinux
[2014-04-11 12:54:09 -0400] hairyhenderson: morning folks - I'm trying to upgrade my chef-server from 11.0.8 to 11.0.12 on a RHEL box and yum seems to be confused about versioning - it seems to be telling me that 11.0.8 is newer than 11.0.12
[2014-04-11 12:54:25 -0400] hairyhenderson: anyone know how to force it? I'm by no means an RHEL expert...
[2014-04-11 13:15:58 -0400] srenatus: this is not a chef question, but someone probably is around that knows more about this than I do:  what is in the vmcore file that is created after a panic (linux) and what is the expected size of it?  (I'm shocked to find a 40G vmcore file)
[2014-04-11 13:24:31 -0400] double_p: srenatus: the size is to be expected to be RAM+swap (at least that in use)
[2014-04-11 13:25:57 -0400] juliancdunn: hairyhenderson: you can try using rpm directly -- rpm -Uvh --oldpackage foo.rpm
[2014-04-11 13:29:41 -0400] srenatus: double_p: yep, makes sense. thanks.
[2014-04-11 13:31:15 -0400] double_p: and now dare to load it into gdb :)
[2014-04-11 13:31:23 -0400] srenatus: double_p: just figured we'd just throw crash(8) at /proc/vmcore in the crash kernel reboot... noone is really able to make more sense of the real dump anyways
[2014-04-11 13:31:59 -0400] double_p: yeah
[2014-04-11 13:39:11 -0400] shlant: hey chefs. Is there any way to have a attribute that always contains a value, but can also have any amount of values added to it?
[2014-04-11 13:39:30 -0400] shlant: like I always want sudo group, but sometimes others as well
[2014-04-11 13:39:56 -0400] shlant: I actually hate that I can't merge attributes
[2014-04-11 13:40:06 -0400] shlant: whether it's bad practice or not
[2014-04-11 13:41:00 -0400] CPS: make it an array?
[2014-04-11 13:42:22 -0400] shlant: CPS: yes, but would I have an array such as ["sudo"] and then append values to it?
[2014-04-11 13:42:53 -0400] shlant: I wish I could have one cookbook have ["sudo"] and one have ["foo", "bar"] and they merge
[2014-04-11 13:44:22 -0400] CPS: can't you just do append?
[2014-04-11 13:44:37 -0400] CPS: or loop over it to ensure you don't append duplicates?
[2014-04-11 13:45:49 -0400] Matt_P1: Hey again. I found what my problem was but don't really understand it, and it would be great if anyone could explain for my knowledge. So, I had a recipe which was installing installing oh my zsh for every users. In the recipe, I have this line "Dir.chdir File.expand_path("~%s" % u['username'])" which was crapping due to the fact that the folder was not created yet. It happens because this code is evaluated during the "compile" phase of chef-client. What I don
[2014-04-11 13:46:04 -0400] shlant: CPS: so in each cookbook do node['foo']['bar'] << ['blah', 'something']?
[2014-04-11 13:46:15 -0400] shlant: or does it need to be default.node
[2014-04-11 13:46:59 -0400] CPS: i haven't done node attribute modification from within a recipe, so i don't know the exact syntax, but i'm sure it's possible
[2014-04-11 13:47:09 -0400] shlant: CPS: I'll try i tout
[2014-04-11 13:47:56 -0400] CPS: if duplicates are a concern you may want to treat it as a set
[2014-04-11 14:03:36 -0400] notromda: and watch out for nils. :)
[2014-04-11 14:20:21 -0400] shlant: anyone familiar with the user_manage LWRP?
[2014-04-11 14:20:30 -0400] shlant: why can't I do this?
[2014-04-11 14:20:34 -0400] shlant: %w{node['auth']['groups']}.each do |groups|
[2014-04-11 14:20:34 -0400] shlant:   users_manage groups do
[2014-04-11 14:20:35 -0400] shlant:     action :create
[2014-04-11 14:20:35 -0400] shlant:   end
[2014-04-11 14:20:36 -0400] shlant: end
[2014-04-11 14:20:43 -0400] shlant: Query groups:node['auth']['groups'] AND NOT action:remove is not supported: Parse error at offset: 11
[2014-04-11 14:20:44 -0400] shlant: Reason: Expected one of [a-zA-Z0-9@._*], \, [a-zA-Z0-9@*?_.-], [\s], AND, &&, OR, ||, (, NOT, ?, !, +, -, " at line 1, column 12 (byte 12) after
[2014-04-11 14:24:36 -0400] remil: shlant: why the %{} thing ?
[2014-04-11 14:25:27 -0400] shlant: remil: if I do node['auth']['groups'].each is gives me undefined method `[]' for nil:NilClass
[2014-04-11 14:25:48 -0400] shlant: attribute file: default['auth']['groups'] = ["sudo", "plants"]
[2014-04-11 14:25:51 -0400] remil: shlant: so probably node['auth'] isn't defined
[2014-04-11 14:26:44 -0400] shlant: am I not defining correctly?
[2014-04-11 14:28:32 -0400] remil: shlant: looks like it's ok, node['auth'] isn't redefined somewhere else ?
[2014-04-11 14:28:47 -0400] shlant: remil: nope, it's my own custom attribute
[2014-04-11 14:32:28 -0400] shlant: seems like 8la in the comments is having the same issue
[2014-04-11 14:32:29 -0400] shlant: http://community.opscode.com/cookbooks/users/comments
[2014-04-11 14:33:28 -0400] shlant: seems like a pretty common use case
[2014-04-11 14:35:21 -0400] remil: shlant: and using shef or chef-shell with --client arg, do you see your attribute ?
[2014-04-11 14:40:25 -0400] shlant: remil: yea it seems like it doesn't exist
[2014-04-11 14:40:29 -0400] shlant: I don't understand
[2014-04-11 14:52:58 -0400] shlant: remil: it only works if I use node.default['foo']['bar'] in attributes instead of default['foo']['bar']
[2014-04-11 14:53:11 -0400] shlant: is it just friday, or has Chef gone all gobbly boop?
[2014-04-11 14:53:41 -0400] CPS:  gone? chef comes wobbly
[2014-04-11 14:57:19 -0400] shlant: CPS: yea, but I like to think I am aware of the wobble most of the time
[2014-04-11 15:03:10 -0400] shlant: CPS remil: works with node.default and force_default but not default. So confused. Oh well
[2014-04-11 15:03:31 -0400] CPS: something about attribute precedence i'm sure
[2014-04-11 15:05:19 -0400] shlant: CPS: even when I make sure the attribute is unique like ['fliminy']['flam'] it still doesn't work properly which is why i'm confused
[2014-04-11 15:05:45 -0400] CPS: you may need to call node.save?
[2014-04-11 15:06:23 -0400] shlant: ew
[2014-04-11 15:06:25 -0400] shlant: hope not
[2014-04-11 15:06:54 -0400] CPS: just guessing
[2014-04-11 15:08:13 -0400] fifthecho: Anyone seen this one with the community MySQL cookbook? "ERROR: could not find recipe ruby for cookbook mysql"
[2014-04-11 15:10:57 -0400] srenatus: fifthecho: opscode-cookbooks/mysql doesn't have that anymore. using that one?
[2014-04-11 15:11:47 -0400] fifthecho: srenatus: AFAIK I am. Just have "mysql" in my Berksfile.
[2014-04-11 15:12:00 -0400] srenatus: fifthecho: well, there're lots of changes in 5.x.y I think
[2014-04-11 15:12:21 -0400] srenatus: fifthecho: see here: http://community.opscode.com/cookbooks/mysql
[2014-04-11 15:13:14 -0400] fifthecho: srenatus: That's the one I'm using, through the Wordpress cookbook
[2014-04-11 15:14:19 -0400] srenatus: fifthecho: I suspect the closest thing to mysql::ruby is http://community.opscode.com/cookbooks/mysql-chef_gem now
[2014-04-11 15:15:11 -0400] fifthecho: Okay, I'll see if adding that to the runlist will help this mutha bootstrap correctly.
[2014-04-11 15:19:38 -0400] srenatus: fifthecho: well, the experience is best when you use the cookbooks that are supposed to be used... so if it needs a less recent version of things... mysql::ruby used to be in older database::mysql recipies, IIRC
[2014-04-11 15:21:18 -0400] fifthecho: srenatus: Yeah, and it didn't resolve the issue either. Bootstrapping a new node with a runlist of "recipe[wordpress]" or "recipe[mysql-chef_gem],recipe[wordpress]" both still throw the error.
[2014-04-11 15:22:12 -0400] srenatus: fifthecho: https://github.com/brint/wordpress-cookbook/commit/6e8930a0d20b4c5751e6f36f4b08ac222227a1d7
[2014-04-11 15:22:51 -0400] fifthecho: Okay. I'll update the Wordpress cookbook to use the git version. Woo.
[2014-04-11 15:22:55 -0400] srenatus: fifthecho: version 2.1.2 fixes your problem: https://github.com/brint/wordpress-cookbook/commit/c0595cfc48609c992e764dd569f276ac4eb9fed9
[2014-04-11 15:23:47 -0400] fifthecho: srenatus: Thanks a bunch. Getting that into my Chef server now to validate.
[2014-04-11 15:24:25 -0400] shlant: CPS remil: turns out the attribute filename had an invisible backslash at the end. Good to know I haven't totally lost it
[2014-04-11 15:24:44 -0400] CPS: that must have been fun to track down
[2014-04-11 15:26:10 -0400] zeroXten: what is the best way of dealing with the following? I'm using a cookbook that creates a user, installs something and starts a service. I need to create a required file owned by that user. If I do it before the cookbook the user doesn't exist. If I do it after the service won't start. Do I just have to let it run twice or is there a better way?
[2014-04-11 15:27:27 -0400] shlant: zeroXten: take a look at the lazy attribute http://docs.opscode.com/chef/resources.html#lazy-attribute-evaluation
[2014-04-11 15:27:39 -0400] zeroXten: ah yeah, that was it :)
[2014-04-11 15:30:38 -0400] mbailey: Does anyone know how to abort a recipe run from a ruby_block?
[2014-04-11 15:35:46 -0400] juliancdunn: mbailey: raise an exception?
[2014-04-11 15:36:13 -0400] srenatus: mbailey: I'm afraid that might not be possible... since the execution of the ruby_block happens in converge phase, the other resources of that recipe are already in the resource collection (put there during compile phase)
[2014-04-11 15:36:56 -0400] srenatus: mbailey: you could just "return unless ..." in the recipe, so the "put stuff into the resource collection" process would stop as far as that recipe is concerned
[2014-04-11 15:37:16 -0400] surge_: So the chef server version Im running is using the vulnerable version because its an embedded library with the omnibus....
[2014-04-11 15:37:42 -0400] surge_: vulnerable version of openSSL
[2014-04-11 15:37:43 -0400] surge_: *
[2014-04-11 15:38:10 -0400] gleam: there's an updated chef server
[2014-04-11 15:39:04 -0400] mbailey: juliancdunn and srenatus:  I'm trying to mimick a 'return' statement.  The issue is I'm trying check whether or not a file exists in a git resource checkout, so I need to check for the file at run(?converge time) to know whether or not I should include some recipes
[2014-04-11 15:39:56 -0400] mbailey: is this even possible?
[2014-04-11 15:40:49 -0400] srenatus: mbailey: not sure
[2014-04-11 15:40:52 -0400] fifthecho: srenatus: The new cookbook worked great. Thanks a ton again.
[2014-04-11 15:41:09 -0400] juliancdunn: mbailey: I can think of a few ways to do that, but it'd be ugly
[2014-04-11 15:41:10 -0400] srenatus: fifthecho: :)
[2014-04-11 15:41:21 -0400] mbailey: srenatus:  Guards happen at compile time right?
[2014-04-11 15:41:24 -0400] juliancdunn: you're probably better guarding the resources individually against the state
[2014-04-11 15:41:29 -0400] juliancdunn: no, guards happen at execute time
[2014-04-11 15:41:32 -0400] mbailey: oh
[2014-04-11 15:41:45 -0400] mbailey: k
[2014-04-11 15:41:52 -0400] mbailey: I can go with a guard for most of this then
[2014-04-11 15:41:58 -0400] juliancdunn: cool
[2014-04-11 15:42:03 -0400] mbailey: but I can't do anything about the include_recipe's right?
[2014-04-11 15:42:10 -0400] mbailey: err.include_recipes
[2014-04-11 15:42:26 -0400] srenatus: mbailey: https://github.com/poise/poise/blob/master/libraries/include_recipe.rb  I have no idea what that is, but maybe coderanger has solved your problem here ;)
[2014-04-11 15:42:39 -0400] mbailey: lol
[2014-04-11 15:42:40 -0400] mbailey: =)
[2014-04-11 15:42:45 -0400] coderanger: You raaaaaang?
[2014-04-11 15:43:14 -0400] mbailey: srenatus: holy shit
[2014-04-11 15:43:16 -0400] doki_pen_: hi, does anyone know of a good way to patch chef-server's nginx for heartbleed in the ubuntu deb?
[2014-04-11 15:43:17 -0400] mbailey: this helps a lot
[2014-04-11 15:43:22 -0400] mbailey: thanks ma
[2014-04-11 15:43:23 -0400] mbailey: n
[2014-04-11 15:44:12 -0400] srenatus: mbailey: it does? cool.
[2014-04-11 15:44:16 -0400] doki_pen_: oh sweet
[2014-04-11 15:44:21 -0400] doki_pen_: it's already in the latest deb
[2014-04-11 15:44:28 -0400] doki_pen_: thanks chef team!
[2014-04-11 15:44:38 -0400] srenatus: mbailey: I'm still coming there every now and then and hope I understand more about it... ;)
[2014-04-11 15:44:56 -0400] mbailey: srenatus: well yes, it shows me the actual code I would have to write..so If I need to make the include recipe conditional I can do that..but I think the guards will do most of what I want for now
[2014-04-11 15:50:17 -0400] whiteadam: Any tips on where to get started with Cucumber on my cookbooks?
[2014-04-11 16:12:35 -0400] notromda: what's the relative risk of passwords in a data bag?  (chef server)   I assume the data is encrypted in transit, so the data exposure would be limited to any clients that can search the data, and data breach of the opscode servers
[2014-04-11 16:13:09 -0400] notromda: I'll get to chef vault eventually, but for now, are those the risk vectors, or am I missing something?
[2014-04-11 16:13:36 -0400] gleam: you can use simple encrypted data bags until you get chef vault going
[2014-04-11 16:14:00 -0400] coderanger: notromda: It would mean anyone with access to Chef can see your passwords
[2014-04-11 16:14:11 -0400] coderanger: notromda: This is generally not good
[2014-04-11 16:16:07 -0400] notromda: currently I'm the only chef dev
[2014-04-11 16:17:02 -0400] notromda: and this is a database password.  Don't want it in git, obviously, but anyone who has access to chef would be trusted with this
[2014-04-11 16:17:31 -0400] coderanger: notromda: Probably okay then, just caveat emptor
[2014-04-11 16:18:26 -0400] notromda: yeah, that's what I'm thinking.   I'll eventually use chef-vault, I'm just having trouble mapping it to my current use of databags
[2014-04-11 16:23:28 -0400] davidordave: does anyone know offhand why berkshelf would stop resolving dependencies in non-standard locations? i.e. on first run I can pull a cookbook from github and then subsequent runs fail to find it. Any info appreciated :)
[2014-04-11 16:26:57 -0400] bricker`LA: what is new_resource.path and new_resource.name ? I see them used but not defined in the resources file.
[2014-04-11 16:33:47 -0400] akahn: would a patch be accepted to make this take a node name in addition to instance ID? https://github.com/opscode/knife-openstack/blob/master/lib/chef/knife/openstack_server_delete.rb#L67
[2014-04-11 16:34:39 -0400] mikemm: anyone know of any guard evaluation bugs in chef client 11.12.2?  I'm seeing different/unexpected behavior between 11.10.4 and 11.12.2
[2014-04-11 16:35:34 -0400] mikemm: in particular, this exe block: execute 'create filesystem on repo device' do   command "mkfs -t #{dev_format} #{repo_dev}"   action :run   only_if "ls #{repo_dev} && [ `sudo wipefs -n -p #{repo_dev} | wc -l` -eq 0 ]" end
[2014-04-11 16:36:39 -0400] mikemm: The only_if guard will only allow the block to execute if it detects that the device is unformatted.  Works fine in 11.10.4, but it always tries to execute in 11.12.2
[2014-04-11 17:04:17 -0400] surge_: Upgraded to the latest chef-server, but now its failling tests right at the start. Gets a 301 and exits...
[2014-04-11 17:04:31 -0400] surge_: Oh, nevermind...
[2014-04-11 17:05:15 -0400] surge_: I was using the FQDN for the nginx url instead of https://FQDN
[2014-04-11 17:05:20 -0400] surge_: dumb mistake
[2014-04-11 17:18:10 -0400] adamedx: mikemm: we did make changes to guard evaluation code paths in Chef 11.12
[2014-04-11 17:18:56 -0400] adamedx: I'm not able to reproduce the issue you're seeing, so I might need a little help to narrow this down
[2014-04-11 17:29:33 -0400] jidar: I'm curious, I keep reading about how people are forced to use so many of the override/forced_override/role based attributes in order to set the right elevation 'design', what's the overall problem here?
[2014-04-11 17:30:03 -0400] jidar: or rather, whats the real solution
[2014-04-11 17:34:33 -0400] juliancdunn: jidar: use default 99.99% of the time
[2014-04-11 17:35:02 -0400] troyready: +1
[2014-04-11 17:35:25 -0400] juliancdunn: some people bring sledgehammers to hammer a nail, and that's where they get in trouble
[2014-04-11 17:35:48 -0400] juliancdunn: e.g. "node.set" when it's unnecessary, or "override" in roles/environments when default would do
[2014-04-11 17:36:31 -0400] jidar: I mean, I use default everywhere, but when in the hell is there 15 levels of elevation if default is fine?
[2014-04-11 17:36:43 -0400] jidar: s/when/why
[2014-04-11 17:37:01 -0400] juliancdunn: jidar: some of those are merge order
[2014-04-11 17:37:11 -0400] juliancdunn: and the others are there as "break glass in case of emergency"
[2014-04-11 17:37:14 -0400] jidar: I understand why there are 4 merge orders
[2014-04-11 17:37:34 -0400] jidar: perhaps even 5, but 15?
[2014-04-11 17:37:42 -0400] jidar: 15 just makes it a big mess of confusing
[2014-04-11 17:37:54 -0400] shlant: anyone know if you can reference node attributes in minitests?
[2014-04-11 17:38:13 -0400] titanfall: Speaking of "override's",  I have some attributes that need to be set and I have an environments json but can't figure out where to put it in my kitchen.yml.  Any help appreicated.  Sorry to cut in.
[2014-04-11 17:38:20 -0400] juliancdunn: jidar: well, I'm personally not in favor of 4 of those - the force_* ones
[2014-04-11 17:38:32 -0400] juliancdunn: those were added as a reaction, because someone shot themselves in the foot not using default
[2014-04-11 17:38:58 -0400] juliancdunn: in practice, in this table: http://docs.opscode.com/_images/overview_chef_attributes_table.png
[2014-04-11 17:39:03 -0400] shlant: juliancdunn: there's no doubt that the attribute precedence is a bit overkill even for the most complex of needs.
[2014-04-11 17:39:15 -0400] juliancdunn: you really only ever use 1, 2, 3, 4 and *maybe* the override role
[2014-04-11 17:39:22 -0400] juliancdunn: s/role/row/
[2014-04-11 17:39:23 -0400] davidski_web: It's the deep merge functionality that drives me crazy as a newbie.
[2014-04-11 17:39:25 -0400] shlant: but it's easy enough to just ignore what isn't relevent to you until you need it
[2014-04-11 17:39:58 -0400] juliancdunn: shlant: actually I've occasion to use most of those levels even with a moderately sized infrastructure
[2014-04-11 17:40:13 -0400] davidski_web: I've had a default hash I've been trying to override (delete the default keys and add my own) for weeks, but the best I can get is a merge. So annoying.
[2014-04-11 17:40:18 -0400] juliancdunn: when the business makes crazy business rules like "only on these servers with this role in the prod environment, send mail to THIS smtp server"
[2014-04-11 17:40:25 -0400] juliancdunn: and then a crapton of other business logic for other server roles in other environments
[2014-04-11 17:41:06 -0400] jidar: env based wrapper cookbooks I think is the solution there, no?
[2014-04-11 17:41:14 -0400] shlant: juliancdunn: sorry I guess I meant to send that to jidar
[2014-04-11 17:41:43 -0400] shlant: juliancdunn: there are definitely use cases for all the levels, but for the novice, it seems like a clusterfuck
[2014-04-11 17:42:03 -0400] juliancdunn: shlant: well, the problem with the docs is that they're more of a reference manual at the moment
[2014-04-11 17:42:08 -0400] juliancdunn: I wouldn't show that png to newbies
[2014-04-11 17:42:17 -0400] juliancdunn: I'd show them two rows, default and override
[2014-04-11 17:42:27 -0400] shlant: juliancdunn: agreed
[2014-04-11 17:42:31 -0400] juliancdunn: (plus 'automatic', but that's irrelevant since you can't set that)
[2014-04-11 17:42:33 -0400] shlant: only know what you need to
[2014-04-11 17:42:49 -0400] juliancdunn: yeah, our community manager says it's ok to lie to people at first if it's for their benefit :)
[2014-04-11 17:43:31 -0400] jidar: lol
[2014-04-11 17:43:52 -0400] jidar: juliancdunn: >when the business makes crazy business rules like "only on these servers with this role in the prod environment,...
[2014-04-11 17:43:58 -0400] jidar: juliancdunn: env based wrapper cookbooks I think is the solution there, no?
[2014-04-11 17:44:02 -0400] juliancdunn: we're also considering either scrapping or refactoring set/normal - see this for details: https://github.com/opscode/chef-rfc/pull/9
[2014-04-11 17:44:40 -0400] juliancdunn: jidar: I dunno, it was simpler for me to implement just as attributes in environments
[2014-04-11 17:44:54 -0400] troyready: I think that could be pretty clear to layout at a #learnchef level - 'You'll want to use default in your roles/environments, and sprinkle in override...'
[2014-04-11 17:44:59 -0400] juliancdunn: depends how paranoid you are about versioning everything
[2014-04-11 17:45:23 -0400] troyready: Which doesn't misrepresent anything, but only exposes the needed knowledge
[2014-04-11 17:45:26 -0400] montjoy: what's the best way to pass a variable into a library/function from a recipe?
[2014-04-11 17:45:33 -0400] juliancdunn: troyready: totally.
[2014-04-11 17:49:34 -0400] comjf: Chef newb here, is it possible in default.rb (attributes) to have one attribute reference another?
[2014-04-11 17:50:00 -0400] comjf: aka something like default['ngapp']['application_user'] = node['ngapp']['admin_user']
[2014-04-11 17:50:08 -0400] Nukepuppy: theres pretty good reason to version everything or be able to though
[2014-04-11 17:50:12 -0400] Nukepuppy: cause ruby breaks daily :P
[2014-04-11 17:50:51 -0400] jmreicha: I'm trying to set up private repo authentication with git using the ssh_known_hosts cookbook but I don't understand how to use it.  Is there a good example?  The readme is confusing me
[2014-04-11 17:51:45 -0400] Nukepuppy: i dunno jmreicha that cookbook looks pretty simple?
[2014-04-11 17:51:48 -0400] Nukepuppy: what part is confusing
[2014-04-11 17:52:20 -0400] hairyhenderson: hey folks, I've been screwing around with rvm, and now the "knife winrm" command wont' work anymore... I did a "gem install knife-windows" but that doesn't help...
[2014-04-11 17:52:24 -0400] hairyhenderson: any ideas?
[2014-04-11 17:52:45 -0400] Nukepuppy: yes rvm isnt your knife and or a combination of that
[2014-04-11 17:52:47 -0400] hairyhenderson: (and /opt/chef/embedded/bin is first in my $PATH)
[2014-04-11 17:53:08 -0400] Nukepuppy: probably a mix of gems too
[2014-04-11 17:53:10 -0400] hairyhenderson: I did a "rvm use system" and gem points to the one shipped in /opt/chef/embedded/bin, same with ruby/etc
[2014-04-11 17:53:20 -0400] Nukepuppy: do you still need rvm?
[2014-04-11 17:53:31 -0400] hairyhenderson: well I had knife-windows 0.5.14 and 0.5.15 installed, so I uninstalled the .14, no difference
[2014-04-11 17:53:44 -0400] hairyhenderson: I do - need to use ruby 2.1 for some other stuff
[2014-04-11 17:54:16 -0400] juliancdunn: comjf: yes.
[2014-04-11 17:54:27 -0400] Nukepuppy: the way i got around it might not be viable for you but on my workstation i run a small VM permanently that mounts all my windows files automagically and i just do the edits there etc with different rvm envs..... etc
[2014-04-11 17:54:34 -0400] Nukepuppy: but i dont mix knife + Rvm myself
[2014-04-11 17:54:49 -0400] Nukepuppy: well knife embedded ruby with rvm i dunno
[2014-04-11 17:55:01 -0400] hairyhenderson: hrm...
[2014-04-11 17:55:01 -0400] hairyhenderson: ok
[2014-04-11 17:55:02 -0400] juliancdunn: rvm does awful things to Ruby
[2014-04-11 17:55:16 -0400] juliancdunn: we are working on making the omnibus Ruby "RVM-resistant"
[2014-04-11 17:55:34 -0400] juliancdunn: but unfortunately rvm sets a pile of 'internal' Ruby env vars that totally blow up the omnibus Ruby
[2014-04-11 17:55:47 -0400] hairyhenderson: I get the impression that if rvm isn't managing a ruby, good luck getting it to work
[2014-04-11 17:56:02 -0400] jmreicha: Nukepuppy:  I keep getting compile errors when I try to run it
[2014-04-11 17:56:06 -0400] Nukepuppy: unless you dont need omnibus chef and do a gem install chef
[2014-04-11 17:56:11 -0400] Nukepuppy: got a gist of that jmreicha?
[2014-04-11 17:56:49 -0400] juliancdunn: hairyhenderson: I use rbenv, which accomplishes the same thing but without all the ceremony
[2014-04-11 17:56:54 -0400] juliancdunn: there is also chruby, even more lightweight
[2014-04-11 17:57:24 -0400] hairyhenderson: hrm, ok
[2014-04-11 17:57:34 -0400] jmreicha: Nukepuppy:  Seems to be complaining about a data bag not being found
[2014-04-11 17:57:38 -0400] hairyhenderson: Nukepuppy: OH. you're on to something there.
[2014-04-11 17:57:43 -0400] jmreicha: [2014-04-11T17:54:26+00:00] INFO: HTTP Request Returned 404 Object Not Found: error
[2014-04-11 17:57:46 -0400] jmreicha: [2014-04-11T17:54:26+00:00] ERROR: Failed to list data bag items in data bag: "ssh_known_hosts"
[2014-04-11 17:57:48 -0400] jmreicha: [2014-04-11T17:54:26+00:00] INFO: Could not load data bag 'ssh_known_hosts'
[2014-04-11 17:57:52 -0400] hairyhenderson: I just did a "which knife" and it came from /usr/local/bin, which is fishy
[2014-04-11 17:58:27 -0400] Nukepuppy: jmreicha it is od dbecause it should recover from that data bag not found
[2014-04-11 17:58:36 -0400] Nukepuppy: unless you do have a data bag with wrong data wich is doubtful
[2014-04-11 17:58:41 -0400] hairyhenderson: yep, totally. somewhere in my rvm delerium I installed the chef gem in one of my different rubies
[2014-04-11 17:59:02 -0400] hairyhenderson: thanks :)
[2014-04-11 18:00:53 -0400] hairyhenderson: Nukepuppy: ok, so here's another question... _do_ I need omnibus chef? any reason why I shouldn't just use the chef gem?
[2014-04-11 18:01:03 -0400] jmreicha: Nukepuppy: Hm, yeah I don't really know about data bags yet either.  Looks like it's time to learn :)
[2014-04-11 18:01:24 -0400] werdnativ: What's the current thinking about storing passwords in plaintext? e.g. https://github.com/opscode-cookbooks/mysql#attributes Even if I were to load this from an encypted data bag, it becomes a plain text attribute...
[2014-04-11 18:03:04 -0400] bricker: What's the correct cookbook to use for redis? There are like 10 of them
[2014-04-11 18:03:10 -0400] werdnativ: then you can expose it from any other node via search(:node, "recipe[mysql::server]").mysql.root_password right??
[2014-04-11 18:04:48 -0400] hairyhenderson: werdnativ: at least with OSS chef-server, if you have permission to do queries and interact with the server, you pretty much have root on every node _anyway_
[2014-04-11 18:04:55 -0400] Nukepuppy: hairyhenderson i dont use omnibus on my workstation
[2014-04-11 18:05:19 -0400] Nukepuppy: its just where i work from.. if you want it to be managed by chef etc etc you could benefit from it? otherwise not a big deal
[2014-04-11 18:05:39 -0400] Nukepuppy: i figure since my workstation goes thru a lot of weird scenarios that a managed node wouldnt live thru.. i leave it unmanaged and i use gem on it
[2014-04-11 18:05:52 -0400] hairyhenderson: Nukepuppy: ah. my workstation isn't managed by chef - maybe I should just do that
[2014-04-11 18:06:00 -0400] Nukepuppy: why not ;p hehe
[2014-04-11 18:06:09 -0400] hairyhenderson: will save a lot of heartache :P
[2014-04-11 18:06:12 -0400] Nukepuppy: if you're on windows.. do consider like a 64mb permanent linux VM
[2014-04-11 18:06:15 -0400] Nukepuppy: it will help you tremendously
[2014-04-11 18:06:20 -0400] hairyhenderson: nah, I run Linux
[2014-04-11 18:06:27 -0400] Nukepuppy: ah in that case you're all set
[2014-04-11 18:06:32 -0400] hairyhenderson: I relegate Windows to some VM far far away that I hardly ever access ;)
[2014-04-11 18:06:53 -0400] Nukepuppy: thought i saw some windows stuff up smoewhere but i get it now
[2014-04-11 18:06:56 -0400] werdnativ: so any measures like encrypted data bags, chef-vault, etc. are basically pointless, I gather.
[2014-04-11 18:07:15 -0400] hairyhenderson: well I'm accessing windows nodes
[2014-04-11 18:07:39 -0400] Nukepuppy: @werdnative i just use encrypted data bags.. it can be a pain as a pre-requisite for 'simple cookbooks'
[2014-04-11 18:07:40 -0400] hairyhenderson: will chef run with Ruby 2.1.1? or does it still require 1.9.x?
[2014-04-11 18:07:57 -0400] Nukepuppy: but do consider   blah = databag something || use this fall back for testing which isnt a biggy
[2014-04-11 18:08:01 -0400] werdnativ: I'm just thinking of least-privilege and minimizing the damage of any exposure, as a general principle...
[2014-04-11 18:08:37 -0400] werdnativ: Nukepuppy: I don't mind them, but a lot of cookbooks will have you set passwords on the node attributes. Then they're saved unencrypted.
[2014-04-11 18:09:27 -0400] Nukepuppy: yeah but i wrap those into my cookbook and then make the databag item be where it comes from
[2014-04-11 18:10:31 -0400] werdnativ: Nukepuppy: I use a wrapper recipe too. do you set the secret attribute on the node at the top of the recipe, and then remove it at the bottom?
[2014-04-11 18:11:01 -0400] werdnativ: otherwise it gets saved back to the chef server...
[2014-04-11 18:11:11 -0400] werdnativ: and you can go read it from any other node.
[2014-04-11 18:12:47 -0400] Nukepuppy: i know i  have some examples somewhere ill look it up.. im sadly still in middle of a crap storm
[2014-04-11 18:13:13 -0400] werdnativ: no worries
[2014-04-11 18:18:48 -0400] Nukepuppy: actually the essential databags has a working example of what you want i believE?
[2014-04-11 18:19:03 -0400] Nukepuppy: i 'store keys on nodes'
[2014-04-11 18:19:11 -0400] Nukepuppy: which is what we're doing here but maybe thats not ok for you
[2014-04-11 18:19:25 -0400] Nukepuppy: it beats storing passwords in scm
[2014-04-11 18:23:13 -0400] CPS: what does a directory resource return when deleting if the folder doesn't exist in the first place?
[2014-04-11 18:23:40 -0400] Nukepuppy: probably same behavior as making a file that exists
[2014-04-11 18:23:48 -0400] Nukepuppy: unless you use execute -.- or similar
[2014-04-11 18:26:11 -0400] werdnativ: Nukepuppy: http://docs.opscode.com/chef/essentials_data_bags.html#store-keys-on-nodes just refers to the secret key file for decrypting data bags.
[2014-04-11 18:26:11 -0400] werdnativ: What I mean is after you use that to decrypt it, you might need to do node["mysql"]["root_password"] = EncryptedDataBagItem.load("passwords", "production", "/var/secrets/production.key")
[2014-04-11 18:26:12 -0400] werdnativ: Then after the chef-run completes, the chef-server will save the node attributes, in plain-text.
[2014-04-11 18:27:20 -0400] werdnativ: So that's why I was asking, "do you set the attribute at the top of the recipe and then remove it at the bottom"...
[2014-04-11 18:47:52 -0400] tehnef: quick question: `knife ssh` used to work great for me and accessed ssh-agent just fine. sometime in the past few weeks it stopped doing that and prompts me for the ssh pass every time. could someone possibly point me in the right direction?
[2014-04-11 18:48:34 -0400] doomviking: tehnef: I find that sometimes the ssh-agent gets clogged up and clearing out keys from it fixes things
[2014-04-11 18:48:46 -0400] tehnef: even across a reboot doomviking ?
[2014-04-11 18:49:07 -0400] doomviking: no heh.
[2014-04-11 18:49:09 -0400] tehnef: also, actually ssh-ing into them works fine with no challenge
[2014-04-11 18:49:13 -0400] doomviking: weird
[2014-04-11 18:49:16 -0400] tehnef: yeah
[2014-04-11 18:49:35 -0400] tehnef: is there a way to get knife to show me what environment variables it's picking up?
[2014-04-11 18:49:40 -0400] doomviking: maybe turn on debug on each end
[2014-04-11 18:51:46 -0400] davidski_web: When a single dimension hash attribute is merged, is there a way to get chef to _not_ merge but to do an overwrite instead? The various override options all seem to merge.
[2014-04-11 18:52:27 -0400] doomviking: tehnef: you're certain the keys are correct and you're passing the right username
[2014-04-11 18:53:18 -0400] tehnef: doomviking: yeah. i mean it challenges for the correct key you know? it works if i enter the ssh pass
[2014-04-11 18:53:29 -0400] doomviking: thats pretty weird
[2014-04-11 19:01:56 -0400] jmreicha: Nukepuppy: I got my data bag situation sorted out but I am confused on how the LWRP works.  I am using the ssh_known_host readme to add the command listed but am still getting an error
[2014-04-11 19:04:17 -0400] jmreicha: Nukepuppy:  Nevermind, I had a syntax error in my recipe.  Ugh sorry about that
[2014-04-11 19:07:41 -0400] kshep: Anybody have any suggestions RE figuring out why 'knife ec2 server create' is hanging for me? It gets past "Waiting for instance...", displayes the subnet ID and private IP
[2014-04-11 19:07:50 -0400] kshep: then sits there forever
[2014-04-11 19:09:24 -0400] kshep: I can ssh to the box :-/
[2014-04-11 19:09:29 -0400] kshep: used to work...
[2014-04-11 19:11:18 -0400] CPS: trying to bootstrap a windows node using winrm, getting no such host, but i can ping it. any ideas?
[2014-04-11 19:12:58 -0400] troyready: I've have plenty of weird knife winrm issues, but not during bootstrap I think. Any other time, I'd recommend looking at the attribute used to connect (i.e. -a flag)
[2014-04-11 19:13:05 -0400] troyready: So unfortunately no :(
[2014-04-11 19:15:36 -0400] CPS: it also prints out ''' is not recognized as an internal or external command, operable program or batch file
[2014-04-11 19:15:48 -0400] CPS: 3 single quots
[2014-04-11 19:16:26 -0400] prometheanfire: anyone have a simple knife ssh for reseting the client.pem with the client-rekey cookbook?
[2014-04-11 19:26:13 -0400] tehnef: CPS: could you paste the command you're using?
[2014-04-11 19:26:45 -0400] CPS: i think it has something to do with winrm not being configured correctly
[2014-04-11 19:26:54 -0400] tehnef: kshep: do a -VV to get more info on what's going on
[2014-04-11 19:26:58 -0400] tehnef: CPS: yeah most likely
[2014-04-11 19:27:15 -0400] tehnef: tehnef: you mean on the knife config side, right?
[2014-04-11 19:27:26 -0400] CPS: winrm get winrm/config prints an error on my workstation
[2014-04-11 19:27:32 -0400] CPS: target node gives me output
[2014-04-11 19:27:33 -0400] kshep: tehnef: yeah, I'm doing that... it comes back with private IP, then just hangs before it tells me it's waiting for sshd
[2014-04-11 19:28:02 -0400] tehnef: kshep: do you have a path to the private IP?
[2014-04-11 19:28:16 -0400] kshep: yep. I can actually ssh to the new box in another windo
[2014-04-11 19:30:18 -0400] kshep: technef: got it. I was forgetting "bundle exec ..."
[2014-04-11 19:31:18 -0400] tehnef: kshep: try `-a cloud.public_ipv4`
[2014-04-11 19:31:37 -0400] tehnef: kshep: aha. yeah that'll do it.
[2014-04-11 19:33:24 -0400] tehnef: CPS: how are you pre-configuring your windows VM for WinRM?
[2014-04-11 19:33:47 -0400] CPS: supposed to be done via gpo
[2014-04-11 19:33:56 -0400] CPS: but i think my workstation box may have been excluded
[2014-04-11 19:34:13 -0400] kshep: technef: now at least it tells me it's "waiting for sshd" before it hangs forever :-)
[2014-04-11 19:36:13 -0400] bricker: Can one use cookbook_file() for a file that's in a dependency cookbook?
[2014-04-11 19:37:15 -0400] tehnef: CPS: well as far as i know you can't configure how knife uses winrm via GPO. knife winrm connects via HTTPS over port 5986 (`winrm quickconfig -transport:https`), expects the certificate to be valid , and the Maxtimeoutms needs to be bumped (`winrm set winrm/config @{MaxTimeoutms="1800000"}`)
[2014-04-11 19:37:17 -0400] bricker: or template for that matter
[2014-04-11 19:37:53 -0400] CPS: tehnef: they did it
[2014-04-11 19:38:00 -0400] CPS: they're bootstrapping prod servers right now
[2014-04-11 19:38:23 -0400] CPS: my boxes are one-off oddities though and probably got missed
[2014-04-11 19:38:26 -0400] tehnef: maybe they're running a script via gpo
[2014-04-11 19:38:31 -0400] bricker: ah, "cookbook" attribute... need to read documentation before I ask dumb questions :)
[2014-04-11 19:38:37 -0400] CPS: i don't know the details of how they did it
[2014-04-11 19:38:49 -0400] tehnef: CPS: that's always a difficult situation
[2014-04-11 19:41:00 -0400] CPS: unrelated question: is it possible to declare variables in one recipe and use them in another within the same cookbook?
[2014-04-11 19:44:23 -0400] tehnef: CPS: if you're going to use them in multiple recipes, why not make it an attribute?
[2014-04-11 19:44:32 -0400] jchauncey: CPS: its ruby so anything you can do in ruby you can do there, but in this case not really
[2014-04-11 19:45:21 -0400] CPS: attributes might work
[2014-04-11 19:45:36 -0400] CPS: anything special i need to do to save/store them as they change?
[2014-04-11 19:46:44 -0400] tehnef: not sure what you mean CPS
[2014-04-11 19:47:20 -0400] CPS: my use case here is i have a 4 cookbooks that all involve installing an MSI, with some application-specific stuff around it. i'd like to refactor the common behavior into one recipe, rather than having 4 recipes which are mostly identical
[2014-04-11 19:47:48 -0400] CPS: i envision having a specific-behavior recipe, which calls the generic msi recipe and passes it the file name
[2014-04-11 19:47:55 -0400] tehnef: sounds like a good case for an attribute to me, but i'm still new to all this
[2014-04-11 19:49:24 -0400] tehnef: having 4 recipes isn't necessarily a bad idea. there are many many ways to skin your cat
[2014-04-11 19:50:52 -0400] CPS: it's just kind of annoying that these 4 recipes are /almost/ identical
[2014-04-11 19:51:19 -0400] CPS: as a programmer this is anathema, but chef is its own beast
[2014-04-11 19:52:36 -0400] kshep: CPS: if you want to store a variable from one recipe for use in another, check out node.run_state
[2014-04-11 19:54:03 -0400] kshep: but yeah... attibutes might be a better way to go... probably depends on the situation
[2014-04-11 19:54:17 -0400] jmreicha: I'm getting a "host key verification failed" error when attempting to clone a private git repo.  Any idea what might be going on here?
[2014-04-11 19:54:49 -0400] kshep: I read variables from an encrypted data bag and load them up via a config recipe into node.run_state, specifically because they shouldn't persist between chef runs
[2014-04-11 20:01:10 -0400] Azrael: hi folks.  i've upgraded from open-source chef-server 11.0.8 to 11.0.12.  i can no longer upload cookbooks into chef.  client side shows:  Ridley::Errors::HTTPInternalServerError: {"error":["internal service error"]}
[2014-04-11 20:01:20 -0400] Azrael: any tips/suggestions?
[2014-04-11 20:06:55 -0400] jchauncey: CPS: look at the library cookbook pattern for those kind of things
[2014-04-11 20:07:15 -0400] jchauncey: CPS: if you notice that you are doing really similar things in a bunch of cookbooks either right a LWRP or library to do it for you
[2014-04-11 20:08:27 -0400] CPS: got any convenient links where i can read about library pattern?\
[2014-04-11 20:08:47 -0400] CPS: i've looked at LWRPs but they seem rather involved to author
[2014-04-11 20:34:50 -0400] Azrael: it looks like erchef / erlang is no longer trusting our ssl certificate
[2014-04-11 20:36:28 -0400] someara: CPS no like off the top of my head, but lots of examples
[2014-04-11 20:36:51 -0400] someara: https://github.com/opscode-cookbooks/yum
[2014-04-11 20:37:01 -0400] someara: https://github.com/opscode-cookbooks/apt
[2014-04-11 20:37:15 -0400] someara: https://github.com/opscode-cookbooks/mysql <-- slightly advanced
[2014-04-11 20:37:51 -0400] someara: here's a template for writing cross platform resources: https://github.com/someara/crossplat
[2014-04-11 20:38:28 -0400] someara: the library pattern is basically "extend chef"
[2014-04-11 20:39:36 -0400] CPS: thanks someara, i'll give those a read
[2014-04-11 20:39:47 -0400] PaulB010102: have a question regarding chef-solo and environments
[2014-04-11 20:40:01 -0400] PaulB010102: am receiving an error undefined method `default_attributes'
[2014-04-11 20:40:14 -0400] PaulB010102: when running as follows: https://gist.github.com/anonymous/c57eabf45ae027adeed0
[2014-04-11 20:40:53 -0400] PaulB010102: have tried adding default_attributes to my environment json file
[2014-04-11 20:41:05 -0400] PaulB010102: with or without i am still unable to run chef-solo with the -E flag
[2014-04-11 20:42:55 -0400] someara: what are you trying to accomplish with environments?
[2014-04-11 20:43:12 -0400] someara: environments let you lock cookbooks to exact versions and set some node attributes
[2014-04-11 20:43:54 -0400] PaulB010102: basically.. this is a automated test environment that is bootstrapping a larger app, and selenium grid to run tests
[2014-04-11 20:43:57 -0400] someara: you can have multiple simultaneous versions of cookbooks installed on the chef-server, for dev/staging/whatever
[2014-04-11 20:44:48 -0400] PaulB010102: hmm
[2014-04-11 20:45:56 -0400] PaulB010102: is it considered bad practice to use node.chef_environment to deliver things like this?
[2014-04-11 20:46:23 -0400] PaulB010102: instead of using an attribute that is overridden at the environment
[2014-04-11 20:47:15 -0400] someara: "it depends"
[2014-04-11 20:47:25 -0400] someara: I dont know much about what you're doing
[2014-04-11 20:47:49 -0400] PaulB010102: ok, for example
[2014-04-11 20:47:53 -0400] someara: but if you're just trying to lock down cookbook versions with chef-solo, Berkshelf may be easier
[2014-04-11 20:48:07 -0400] PaulB010102: ok.  no, not to do with versions of cookbooks
[2014-04-11 20:48:24 -0400] PaulB010102: for recipe related items that change env to env, like ssl certs
[2014-04-11 20:50:43 -0400] someara: aha. yea I've never personally used chef-solo with environments.. but in general, I try really hard to avoid environment aware code
[2014-04-11 20:51:07 -0400] someara: because if the behavior changes from env to env, it kind of invalidates tests
[2014-04-11 20:51:35 -0400] someara: that being said, your mileage looks like its varying
[2014-04-11 20:52:35 -0400] someara: sec lemme see if I can figure it out
[2014-04-11 20:53:28 -0400] someara: how are you running chef, vagrant? test-kitchen?
[2014-04-11 20:55:12 -0400] prometheanfire: does anyone else have problems with useding opscode managed chef and data expiring from the search data when you trigger a client run across multiple nodes?
[2014-04-11 20:55:39 -0400] PaulB010102: ok thanks someara
[2014-04-11 20:55:56 -0400] PaulB010102: im going to rewrite accordingly
[2014-04-11 20:56:05 -0400] someara: looks like you have to include environment "whatever" in your solo.rb
[2014-04-11 20:58:06 -0400] someara: prometheanfire we had a blip in our indexer while patching heartbeat the other day.... write support@getchef.com and they'll sort you out
[2014-04-11 20:58:38 -0400] someara: but usually, no.
[2014-04-11 21:01:58 -0400] prometheanfire: someara: this is recent (an hour ago), could give you a ticket number we have open about this if you'd like :P
[2014-04-11 21:03:31 -0400] someara: nah. I'm not in support or ops, so I cant really do much anyway
[2014-04-11 21:04:07 -0400] prometheanfire: thought I'd ask anyway :D
[2014-04-11 21:04:36 -0400] werdnativ: How can I list the compiled resources at some point in a recipe?
[2014-04-11 21:05:28 -0400] werdnativ: I'm trying to use rewind on this: https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_ubuntu.rb#L73
[2014-04-11 21:06:11 -0400] werdnativ: I called the library resource first (mysql_provider) and then rewind, but it says the resource doesn't exist.
[2014-04-11 21:06:47 -0400] werdnativ: sorry, ^ mysql_service
[2014-04-11 21:07:56 -0400] someara: werdnativ You're not going to be able to use rewind on that. The implementation is in a private run_context
[2014-04-11 21:08:10 -0400] werdnativ: https://gist.github.com/avit/a991a6e92e942e98db9f
[2014-04-11 21:08:13 -0400] werdnativ: hmm.
[2014-04-11 21:08:13 -0400] someara: what do you need the grants file to do?
[2014-04-11 21:09:25 -0400] werdnativ: someara: set my own template, use template variables instead of plaintext node attributes for passwords.
[2014-04-11 21:14:49 -0400] werdnativ: someara: If I define my own template to overwrite the one in the private run_context, in what order do things happen?
[2014-04-11 21:15:14 -0400] werdnativ: (define my own at the same location instead of rewinding it)
[2014-04-11 21:16:01 -0400] someara: the mysql_service is implemented as a primitive... like user, cron, directory, package whatever.
[2014-04-11 21:16:19 -0400] someara: you can't see inside
[2014-04-11 21:16:37 -0400] someara: its always going to use its own
[2014-04-11 21:17:04 -0400] someara: so you just don't want the password stored as an attribute right
[2014-04-11 21:17:17 -0400] someara: what if there was a parameter on the actual resource
[2014-04-11 21:17:33 -0400] werdnativ: yes, that would be better.
[2014-04-11 21:18:13 -0400] werdnativ: I'm actually trying to install percona, updating and cleaning up from https://github.com/phlipper/chef-percona as I go.
[2014-04-11 21:21:51 -0400] someara: ah. yea percona is out of scope for that cookbook anyway, but the parameter thing is good
[2014-04-11 21:21:59 -0400] someara: I've created a ticket to track it https://tickets.opscode.com/browse/COOK-4551
[2014-04-11 21:22:17 -0400] werdnativ: someara, thanks.
[2014-04-11 21:23:00 -0400] someara: probably won't get around to it until after next week, with chefconf and everything
[2014-04-11 21:23:34 -0400] someara: what would normally be a 5 minute patch becomes more work when you have ~500 specs
[2014-04-11 21:25:26 -0400] werdnativ: I probably won't be able to lean on this cookbook anyway, I also wanted to rewind package "mysql-server" because I'm installing "percona-server-server-5.6" but keeping everything else that the mysql cookbook does instead of repeating it.
[2014-04-11 21:26:11 -0400] werdnativ: I guess that would mean an attributes for ['mysql']['server_packages'] to configure that...
[2014-04-11 21:27:58 -0400] someara: yea. mysql_service is implemented as a primitive, like user, package, cron, whatever
[2014-04-11 21:28:30 -0400] someara: it just so happens to be implemented with chef resources, but that could have been Real Ruby or a wall of assembly for all chef cares
[2014-04-11 21:28:58 -0400] werdnativ: gotcha.
[2014-04-11 21:29:09 -0400] someara: rewinding isn't supported in it. I should probably add that to the readme or something
[2014-04-11 21:30:24 -0400] werdnativ: It sucks because the chef-percona cookbook relies on an old version of mysql cookbook, and other outdated dependencies that clash with everything, so I wanted to update it.
[2014-04-11 21:31:22 -0400] werdnativ: the passwords is one thing, but then the package name. I guess it'll have to be an independent cookbook.
[2014-04-11 21:33:23 -0400] someara: yea. right now it looks like heavywater owns the "percona" namespace on the community site... I'll see them next week. Shouldn't be very hard to implement a percona_service by plugging values into the pattern
[2014-04-11 21:34:48 -0400] someara: github.com/someara/crossplat for a skeleton of mysql if you wanna take a stab at it
[2014-04-11 21:35:32 -0400] someara: you'll want to delete the specs and test-ktichen bits out of the skeleton and scope it down to only what percona supports
[2014-04-11 21:36:50 -0400] someara: afk for the day. later!
[2014-04-11 21:40:12 -0400] Azrael: anybody having trouble with ssl certificates since upgrading to chef server 11.0.12?
[2014-04-11 21:41:23 -0400] dbitman: @Jtimberman Hey I see that chefconf is sold out.   Do you know if they will be selling the passes at the door?
[2014-04-11 21:46:19 -0400] Azrael: erchef is complaining "certificate unknown"
[2014-04-11 21:55:52 -0400] spokrandt: quick question.  if i have an  attribute array in environment and the same attribute array in a node is there a way to combine them  looks like chef uses the nodes version only
[2014-04-11 23:04:34 -0400] garrett__: Are the ubuntu chef-server packages still vulnerable to heartbleed?
[2014-04-11 23:04:41 -0400] qsalt: Can you set the data_bags_path with vagrant and berkshelf?
[2014-04-11 23:04:42 -0400] qsalt:         config.berkshelf.enabled = true
[2014-04-11 23:04:42 -0400] qsalt:     config.vm.provision "chef_solo" do |chef|
[2014-04-11 23:04:42 -0400] qsalt:       chef.data_bags_path = "/root/databags"
[2014-04-11 23:04:43 -0400] qsalt:       chef.add_recipe "apt::default"
[2014-04-11 23:04:43 -0400] qsalt:       chef.add_recipe "foo::default"
[2014-04-11 23:04:44 -0400] qsalt:     end
[2014-04-11 23:05:32 -0400] garrett__: Just updated an older 12.04 box that I'd sort of forgotten about, and it looks like embedded ngninx is still linking against a vulnerable version of libssl
[2014-04-11 23:10:05 -0400] garrett__: Or should we just link in a different nginx binary
