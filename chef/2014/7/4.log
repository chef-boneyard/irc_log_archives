[2014-07-04 00:08:30 -0400] shlant: is there an easy way to check if the active ruby version is > 2.0.0 in a not_if?
[2014-07-04 00:08:44 -0400] shlant: would it be different for system ruby vs rbenv?
[2014-07-04 00:09:28 -0400] shlant: in a provider
[2014-07-04 00:18:19 -0400] coderanger: shlant: shell_out('/path/to/ruby -v') and parse the results
[2014-07-04 01:01:44 -0400] shadylog: Hi I have a question.. Lets say chef converges a few nodes to the new state.
[2014-07-04 01:01:54 -0400] shadylog: Then after that it converges to the yet newer state
[2014-07-04 01:02:21 -0400] shadylog: will if in the first state it ran webservers it still be running webservers in the second state if they were just omitted from state
[2014-07-04 01:02:23 -0400] shadylog: ?
[2014-07-04 01:03:39 -0400] mmzyk: I not sure I follow shadylog, but Chef only runs what you tell it, so it will only update what it should from the recipes.
[2014-07-04 01:04:07 -0400] shadylog: ok so if I delete a recipe for example, it will not undo the changes ?
[2014-07-04 01:04:11 -0400] mmzyk: If youre askig if you run it once on all the webservers, and then the second time dont run it on some subset of servers, then sure, those servers wont be updated.
[2014-07-04 01:04:23 -0400] mmzyk: No, Chef doesnt automatically undo anything.
[2014-07-04 01:04:31 -0400] shadylog: ah ok
[2014-07-04 01:04:33 -0400] mmzyk: You have to explicitily write the recipe to do that.
[2014-07-04 01:04:55 -0400] shadylog: you have to say i.e. "I am not a webserver, i do not have apache2 instaleld"
[2014-07-04 01:05:45 -0400] mmzyk: Something like that. It would be more like: rmeove apache2 if found on the system, but yeah.
[2014-07-04 03:34:28 -0400] p3rror: how can stop chef runnit
[2014-07-04 07:06:49 -0400] black`: I was wondering, if some node attributes are changed during a client run in recipe A, will recipe B, running after A, see the attributes changed? If not, is there a way to achieve this behavior ?
[2014-07-04 07:33:12 -0400] Zhann__: black`: it will see the changes
[2014-07-04 07:41:59 -0400] black`: thank you Zhann__
[2014-07-04 07:42:58 -0400] Zhann__: you're welcome
[2014-07-04 07:57:12 -0400] soupdiver: I'm using chef on Amazon OpsWorks and added my custom cookbooks. I try to replace a file which is already created from a template in an earlier recipe from a template in MY cookbook. Chef always fails then because it looks for MY template in the other cookbook. How do I force chef to look for the file in my cookbook?
[2014-07-04 08:03:51 -0400] black`: soupdiver: did you use cookbook attribute in template resource?
[2014-07-04 10:53:42 -0400] black`: i need  accessing current RunContext from a library file. Actually i'm passing run_context to the invoked method from the recipe. I'd like to know.. is there a better way to achieve this and is this practice discouraged?
[2014-07-04 11:51:43 -0400] Zhann_: is there any way I can tell berkshelf to use cookbooks from my chef server instead of community cookbooks?
[2014-07-04 11:53:25 -0400] Zhann_: by default I mean
[2014-07-04 12:08:01 -0400] ghghz: hey, it is possible to check status somehow if service was restarted?
[2014-07-04 12:08:03 -0400] ghghz: for example
[2014-07-04 12:08:10 -0400] ghghz: service "httpd" do action :restart end
[2014-07-04 12:14:56 -0400] jhsubscribe: zhann_: if there is a cookbook with an identical name and version, I thought it would depend on what order you put the chef server and community api entries in the berksfile?
[2014-07-04 12:17:14 -0400] jhsubscribe: ghghz: sorry I don't understand.  can you explain more?
[2014-07-04 12:29:28 -0400] someara: Zhann_ change the "source" line in your Berksfile from "https://api.berkshelf.com" to "my.chef-server"
[2014-07-04 12:30:26 -0400] someara: ghghz you can either notify from your service resource, or subscribe to it
[2014-07-04 12:40:01 -0400] Zhann_: jhsubscribe: how would you add a chef server to the berksfile then? I can't find it in the docs
[2014-07-04 12:43:15 -0400] jhsubscribe: Zhann: for v2.. http://berkshelf.com/v2.0/ see "Chef API Location"
[2014-07-04 12:45:49 -0400] jhsubscribe: for v3 I think you need to run a berkshelf-api and have it index your chef server.  then in your config you specify both... eg.. http://berkshelf.com/ search for "berks-api.vialstudios.com" to see an example
[2014-07-04 12:46:56 -0400] jhsubscribe: more info and links here https://github.com/berkshelf/berkshelf/wiki/2.x-to-3.0-Upgrade-Guide
[2014-07-04 12:54:57 -0400] thejaba: Hi, is anyone about that could possibly help with a problem Ive run into?
[2014-07-04 12:55:34 -0400] thejaba: Im using chef solo, berkshelf and vagrant and no matter what I change with my cookbook it always seems to fail on installing postgres from a missing library
[2014-07-04 12:55:53 -0400] thejaba: but Ive added in package library do action :install
[2014-07-04 12:55:59 -0400] thejaba: and nothing in the run changes
[2014-07-04 12:56:19 -0400] thejaba: any ideas? it seems like its caching the run somehow
[2014-07-04 14:09:55 -0400] chiefsucker: We use VMware vCenter, have one node that has a DHCP server, and where we make static assignments for each new node we provision. We use a base template for provisioning. This procedure is a little bit cumbersome. Whats the easiest / most automatic way to provision & deploy a new Linux VM with Chef & vCenter?
[2014-07-04 14:09:58 -0400] jhsubscribe: thejaba - maybe pastebin etc with details of recipe,berksfile,metadata and error?
[2014-07-04 14:18:12 -0400] nd__: Hey, how can I link all files in a directory to another directory? I wanted to go for a Dir.foreach('/tmp/asdf') do |file| { link  }, but this complains at the compile step that the directory /tmp/asdf doesn't exist (Which is true, it gets created by another step before my loop). How is the correct way?
[2014-07-04 14:35:04 -0400] jhsubscribe: chiefsucker: I'm hoping in future we'll be able to use chef-metal + chef-metal-vsphere for internally hosted server provisioning.  For now we've got a bespoke powershell script that uses reads server definitions from text files and uses powercli
[2014-07-04 14:35:05 -0400] bawt: PONG
[2014-07-04 14:37:42 -0400] chiefsucker: jhsubscribe: Thanks for the info. Would it be kind of OK-ish to use knife-vsphere, change our DHCP recipe after the VM got a new MAC, and then to reboot the VM?
[2014-07-04 14:38:42 -0400] chiefsucker: jhsubscribe: I also thought about using the DHCP server only for the initial connection to chef-server and to manually configure hostname & IP.
[2014-07-04 14:39:06 -0400] chiefsucker: jhsubscribe: both solutions arent really automatic though
[2014-07-04 14:41:43 -0400] jhsubscribe: chiefsucker: I've not used knife-vsphere sorry.  Our current system is a bit of a hack but it works.
[2014-07-04 14:42:28 -0400] jhsubscribe: I'm looking forward to chef-metal so we can use the same definitions for local dev/vagrant builds and vsphere ones
[2014-07-04 14:52:09 -0400] juliancdunn: nd__: you could write the logic in a ruby_block - the code in the block is evaluated at execute time
[2014-07-04 15:02:35 -0400] nd__: juliancdunn: ah, great thanks.
[2014-07-04 15:09:05 -0400] StFS: Baahh... I'm having a really hard time understanding how I can control the order of execution in my recipe. I'm installing docker (using a recipe from an external cookbook) but before I execute that I want to do some custom modifications to the network on the node (add a docker0 bridge interface). How can I, in a single recipe, do the network modification
[2014-07-04 15:09:06 -0400] StFS: first and then call the docker installation recipe?
[2014-07-04 15:17:22 -0400] jhsubscribe: StFS: I assume you've tried a recipe with the network bits and then an include_recipe for docker?  ;)  Theoretically Chef's meant to simpler on order (vs puppet)
[2014-07-04 15:19:03 -0400] StFS: jhsubscribe: I'm not sure I understand you correctly... but I have a recipe that adds a file to /etc/sysconfig/network-scripts/ and then restarts the network service. After it does that it should include_recipe "docker"
[2014-07-04 15:24:23 -0400] jhsubscribe: ah.. when you do the chef run does the network restart happen at the end
[2014-07-04 15:24:29 -0400] jhsubscribe: by default restarts are delayed
[2014-07-04 15:25:42 -0400] jhsubscribe: checkout ":immediately" e.g. notifies :start, 'service[jenkins]', :immediately
[2014-07-04 15:32:15 -0400] StFS: jhsubscribe: yeah I have the :immediately there... but I think I may be figuring this out...
[2014-07-04 17:09:56 -0400] erratic: hey guys...
[2014-07-04 17:10:40 -0400] erratic: https://gist.github.com/paigeadele/3034961ddced49943ccf
[2014-07-04 17:10:53 -0400] erratic: fix that man!
[2014-07-04 17:10:54 -0400] erratic: lol
[2014-07-04 17:11:40 -0400] erratic: https://lh6.googleusercontent.com/-1bpAprVHvgQ/U7bc8QLq15I/AAAAAAAAAIc/vXcGtemYYWU/w378-h672-no/2014-07-04
[2014-07-04 17:13:05 -0400] double_p: erratic: checking ipv6 for maybe-broken-ipv4 is.. erm.
[2014-07-04 17:13:22 -0400] erratic: double_p: nah I just dont have ipv4 configured for this vm
[2014-07-04 17:13:32 -0400] erratic: I'm trying to preserve addresses in my /28
[2014-07-04 17:14:27 -0400] double_p: fail to see how this actually relates to an ipv4 download
[2014-07-04 17:14:41 -0400] erratic: obviously
[2014-07-04 17:15:30 -0400] double_p: a metric ton out there is ipv4 only :}
[2014-07-04 17:15:49 -0400] erratic: including microsoft (windows update)
[2014-07-04 17:16:16 -0400] double_p: really? lol
[2014-07-04 17:16:46 -0400] erratic: yes I was like dude that sucks lol
[2014-07-04 17:17:14 -0400] double_p: not that they "push" ipv6 since w2k3 or so.. plus having hands deep into a lot ipv6 rfcs
[2014-07-04 17:17:32 -0400] erratic: Im kinda new to ipv6
[2014-07-04 17:17:49 -0400] erratic: I wonder if theres a way I can do 6to4 without having to assign an ipv4 address to my vm
[2014-07-04 17:18:10 -0400] erratic: actually I think 6to4 means something else
[2014-07-04 17:18:12 -0400] erratic: I forget
[2014-07-04 17:18:38 -0400] erratic: double_p: yeah its weird, they have good ipv6 support and they dont use any of it
[2014-07-04 17:19:36 -0400] double_p: erratic: 'NAT64' is the generic term.. rest depends on the nat gw you have
[2014-07-04 17:21:25 -0400] double_p: after 15y or so even ipv6 hits the land of "standards are sweet, so many to choose from" :)
[2014-07-04 17:22:23 -0400] erratic: no doubt I can set it up
[2014-07-04 17:22:27 -0400] erratic: I have a routed /48
[2014-07-04 17:22:41 -0400] double_p: "who not"? :)
[2014-07-04 17:22:46 -0400] gchristensen: double_p: hopefully we'll get more adoption now that we're down to, what, < 1 /8 block?
[2014-07-04 17:23:07 -0400] double_p: yah, it was 0.89 /8 or so this week i've checked last
[2014-07-04 17:23:25 -0400] double_p: in "last phase" since end of april
[2014-07-04 17:23:39 -0400] gchristensen: yeah. and MS is running out quick, too. had to borrow latin-america IPs for its US datacenters
[2014-07-04 17:24:11 -0400] double_p: where the tcp/ip6 isnt the actual problem. it's all that 'match xxx.xxx.xxx.xxx' by regexp and whatnot crap lurking all over the places
[2014-07-04 17:24:29 -0400] double_p: in upper levels
[2014-07-04 17:24:41 -0400] erratic: mmm
[2014-07-04 17:24:52 -0400] erratic: yeah that is a lot of work
[2014-07-04 17:25:27 -0400] double_p: even forum-software coder completly ignore it.. "will fix when it 'happens'". well, d'uh :)
[2014-07-04 17:27:34 -0400] double_p: http land already suffering from being "incompatible" to tcp. it'll be more fun to see the upper level completly collapse - or just pass-through|block-all
[2014-07-04 17:28:28 -0400] double_p: ipv6 is one nightmare for the regexp filter 'community' :)
[2014-07-04 17:30:00 -0400] erratic: I wonder if I can hide joins and parts with znc.... this is ridiculous
[2014-07-04 17:30:16 -0400] double_p: erratic: it's easy in irssi :}
[2014-07-04 17:30:40 -0400] erratic: well I have both and znc doesnt seem to have it so irssi it is
[2014-07-04 17:30:56 -0400] erratic: although... can I do it for a single channel.
[2014-07-04 17:31:13 -0400] erratic: yes
[2014-07-04 17:31:19 -0400] double_p: erratic: yah, /ignore #chef joins quits nicks
[2014-07-04 17:31:35 -0400] erratic: done
[2014-07-04 17:31:36 -0400] erratic: thank you :)
[2014-07-04 17:31:40 -0400] double_p: oh, and PARTS
[2014-07-04 17:31:58 -0400] erratic: cool
[2014-07-04 17:32:06 -0400] erratic: yeah that should help alot
[2014-07-04 17:32:14 -0400] erratic: I've never bothered to do that before
[2014-07-04 17:32:20 -0400] double_p: yah i've that on almost every freenode channel :)
[2014-07-04 17:32:46 -0400] erratic: yeah some of these channels are ridiculously big
[2014-07-04 17:34:06 -0400] double_p: but well... back to ipv6. the other day i've to check that a bit with chef-server. the current nginx setup is already a bit flimsy and i'm happy to have a firewall of my kind in front of it
[2014-07-04 17:35:30 -0400] erratic: yeah I'll most likely restrict it with iptables
[2014-07-04 17:35:38 -0400] erratic: ip6tables
[2014-07-04 17:35:38 -0400] erratic: lol
[2014-07-04 17:35:50 -0400] double_p: yeah, that doesnt count for 'kind' for me :)
[2014-07-04 17:35:53 -0400] double_p: <- openbsd/pf
[2014-07-04 17:36:00 -0400] erratic: I love pf
[2014-07-04 17:36:14 -0400] erratic: I used to know pf and not iptables and refused to learn iptables
[2014-07-04 17:36:23 -0400] double_p: glad you like it.. the one or other line in it is from me :)
[2014-07-04 17:36:23 -0400] erratic: then I had to and now I'm just like screw it ... iptables it is
[2014-07-04 17:36:47 -0400] erratic: netfilter is comprehensive enough that you could probably just make a pf frontend instead of iptables
[2014-07-04 17:37:41 -0400] double_p: hm, that would be actually cool. since we put a shitload of effort in the pf.conf syntax. i really hate that iptables way
[2014-07-04 17:37:51 -0400] erratic: I gotta admit, I asked a guy in linux.de a long time ago which he'd prefer; iptables or pf and he said iptables simply because it has chains
[2014-07-04 17:37:59 -0400] erratic: -- chains are nice
[2014-07-04 17:38:12 -0400] double_p: ah, that's you
[2014-07-04 17:38:42 -0400] double_p: well, with TAGs a bit of chaining is possible, too. and in other news, chains are there because the complete "way" is so frigged up
[2014-07-04 17:41:09 -0400] erratic: thats true
[2014-07-04 17:41:27 -0400] erratic: I do like the altq/cbq stuff
[2014-07-04 17:41:48 -0400] erratic: I have never bothered too much with qos in iptables
[2014-07-04 17:42:01 -0400] erratic: once upon a time, it made since to setup altq / cbq for myself
[2014-07-04 17:42:03 -0400] double_p: tc is a better option there
[2014-07-04 17:43:08 -0400] erratic: I recently got my dual 8 core opteron back, do you like xen or kvm better and why may I ask
[2014-07-04 17:43:21 -0400] double_p: erratic: check your query window :)
[2014-07-04 17:43:23 -0400] erratic: my bf really wants me to use xen and I haven't used it in a long time
[2014-07-04 17:43:26 -0400] erratic: oh sorry one sec
[2014-07-04 17:43:56 -0400] double_p: we use xenserver a lot, and i had not many drawbacks. otoh not really some kvm usage.. so cant judge on equal usage
[2014-07-04 17:44:14 -0400] erratic: lol nice
[2014-07-04 17:44:18 -0400] erratic: one sec gotta show you something
[2014-07-04 18:03:53 -0400] papercode: hey, anyway to get the current list of roles for a node in a recipe?
[2014-07-04 18:04:09 -0400] papercode: i'm trying to autogenerate metric prefixes
[2014-07-04 18:45:41 -0400] erratic: papercode: sounds like a knife search question but I'm not sure
[2014-07-04 18:45:45 -0400] erratic: gotta run
[2014-07-04 18:45:56 -0400] papercode: erratic: i think i found it: node.run_list.roles
[2014-07-04 18:46:01 -0400] papercode: isn't well documented
[2014-07-04 18:46:08 -0400] erratic: oh in a recipe
[2014-07-04 18:46:14 -0400] erratic: yes that sounds right
[2014-07-04 18:46:16 -0400] papercode: yeah
[2014-07-04 18:46:20 -0400] erratic: you might also try shef
[2014-07-04 18:46:32 -0400] erratic: it ... was kinda useful for finding stuff like that
[2014-07-04 18:46:50 -0400] double_p: shef is outdated
[2014-07-04 18:46:54 -0400] papercode: i originally was trying a regex match, since the source for role? looks like it's comparing a string, but it turns out the run list is a bunch of objects, easier than i thought
[2014-07-04 18:47:21 -0400] papercode: i will look at shef as well
[2014-07-04 18:47:49 -0400] erratic: it sounds like it might not be very useful anymore though
[2014-07-04 18:47:55 -0400] erratic: but yeah try
[2014-07-04 18:48:18 -0400] papercode: thanks
[2014-07-04 18:48:49 -0400] erratic: http://docs.opscode.com/chef_shell.html
[2014-07-04 18:49:26 -0400] double_p: ops http://www.youtube.com/watch?v=Gw-AxiVqihM :)
[2014-07-04 18:57:30 -0400] double_p: http://www.youtube.com/watch?v=Oynwg2TB8G0
[2014-07-04 19:47:59 -0400] keftes: is there a better way to add to a run list - instead of knife node edit ?
[2014-07-04 19:48:14 -0400] keftes: i have 90 hosts to add to their runlist..
[2014-07-04 19:48:37 -0400] keftes: (and knife bootstrap wont work - i cant get winrm there - and yes it's windows)
[2014-07-04 19:57:17 -0400] keftes: just realized what day this is :) - i was wondering why it's so quiet in here :)
[2014-07-04 20:08:21 -0400] Slashterix: Hello, where can I get info about chef-client supporting RHEL 7 ?
[2014-07-04 21:27:27 -0400] JoelMcCracken: I have written two resources that I would like to publish. One is for creating symlinks between directories while intelligenting moving files if a directory contains anything. The other is for creating firefox profiles and installing extensions
[2014-07-04 21:28:07 -0400] JoelMcCracken: I'm wondering if I should create a separate cookbook for each of these, or what. I still get confused as to how things should be organized
[2014-07-04 21:28:41 -0400] gchristensen: yes make two separate cookbooks
[2014-07-04 21:28:56 -0400] gchristensen: one called firefox and another called ... smart-symlink-technology or whatever ;)
[2014-07-04 21:29:09 -0400] JoelMcCracken: i called it "shadow directory"
[2014-07-04 21:29:20 -0400] JoelMcCracken: which i'm not very excited with
[2014-07-04 21:29:34 -0400] JoelMcCracken: but the whole point was to make ~/Downloads go to ~/Inbox on os x
[2014-07-04 21:30:09 -0400] JoelMcCracken: so, one called firefox.. you dont think it should be called firefox_profile?
[2014-07-04 21:30:34 -0400] JoelMcCracken: thanks for answering my questions btw
[2014-07-04 21:31:06 -0400] JoelMcCracken: I'm in a good mood from finishing this firefox profile cookbook -- it was a real, real trip
[2014-07-04 21:31:41 -0400] gchristensen: I dunno, call it the best name you can come up with
[2014-07-04 21:31:45 -0400] JoelMcCracken: k
[2014-07-04 21:32:42 -0400] JoelMcCracken: oh, testing. I havent tested these -- some unit tests would be nice. what is the popular tech now for that?
