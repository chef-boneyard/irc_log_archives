[2014-07-11 00:04:18 -0400] cheeseplus: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-07-11 00:04:21 -0400] cheeseplus: tBunnyMan: ^
[2014-07-11 00:04:35 -0400] digitalchild: that's what im following
[2014-07-11 00:04:46 -0400] digitalchild: and so far the structure has helped with the 'where do i go now i can make cookbooks'
[2014-07-11 00:05:11 -0400] cheeseplus: there are a few others but that one is very thorough and opinionated
[2014-07-11 00:05:45 -0400] tBunnyMan: thanks.
[2014-07-11 00:07:58 -0400] tBunnyMan: I'm also in the whole, "So I created this training environment and had fun but now it's time to actually try to implement this at $WORK"
[2014-07-11 00:08:41 -0400] cheeseplus: tBunnyMan: the nice thing about that tutorial is it builds you all the way up to testing
[2014-07-11 00:08:45 -0400] coderanger: tBunnyMan: There isn't much, though I offer training and consulting services on advanced Chef usage
[2014-07-11 00:21:43 -0400] tBunnyMan: I'll keep that in mind. Right now I'm just trying to figure out the base implementation and procedure and get something documented so I can move all of us over chef for config management and new deployments going forward
[2014-07-11 00:24:06 -0400] sam__: @all can anyone help with service resource? how does it determine if the service is running or not? i have an init script that supports start,restart,stop,status but when I run service "myservice" do action :start end --> it doesnt start even though service is down.
[2014-07-11 00:35:49 -0400] tequilarista: the name of the service allegedly is all that's necessary for chef to pattern match
[2014-07-11 00:36:15 -0400] tequilarista: I think you can add some additional specifiers to have chef actually query for status, if the service supports it
[2014-07-11 00:36:53 -0400] sam__: how does it verify the status? does it expect a return value?
[2014-07-11 00:40:48 -0400] cheeseplus: sam__ it depends on what the underlying OS provider is
[2014-07-11 00:42:23 -0400] sam__: for RHEL?
[2014-07-11 00:43:10 -0400] Damm: sam__, depends on the init.d ini some cases
[2014-07-11 00:43:13 -0400] Damm: in*
[2014-07-11 00:43:30 -0400] Damm: sam__, status should work by some init scripts are far from perfect and will always exit 0
[2014-07-11 00:43:39 -0400] cheeseplus: for RHEL it's just using init mostly with some RHEL stuff around checkconfig
[2014-07-11 00:43:40 -0400] Damm: exit code is the path fwiw
[2014-07-11 00:43:54 -0400] cheeseplus: so if the exit codes lie then sadness
[2014-07-11 00:45:23 -0400] cheeseplus: sam__: https://github.com/opscode/chef/blob/master/lib/chef/provider/service/init.rb
[2014-07-11 00:45:33 -0400] cheeseplus: the relevant code
[2014-07-11 01:02:08 -0400] lamont_oc: RHEL uses: https://github.com/opscode/chef/blob/master/lib/chef/provider/service/redhat.rb
[2014-07-11 01:04:17 -0400] cheeseplus: looking at it I thought the redhat only took care of enabling/disableing services
[2014-07-11 01:05:33 -0400] cheeseplus: and init did the actual service start/stop/restart
[2014-07-11 01:05:37 -0400] lamont_oc: yeah it inherits the rest from Init
[2014-07-11 01:06:10 -0400] cheeseplus: ok, just making sure I read it right ;)
[2014-07-11 01:06:20 -0400] lamont_oc: lcr is still going to run (and then call the superclass), which can affect what happens in the actions
[2014-07-11 01:17:28 -0400] sam__: thank you. let me go through that tongiht
[2014-07-11 01:21:14 -0400] Majost_: Does anyone know where I can find some examples of using Ohai for miscellaneous ruby projects -- specifically, I want to be able to use it for parsing network interface information
[2014-07-11 02:05:31 -0400] drgeb: I am unable to get sudo cookbook to properly modify my /etc/sudoers its completely empty after provissioning I am using the open source chef-server and ubuntu vmware client
[2014-07-11 02:18:26 -0400] bytheway: anybody ever see an instance where chef-client doesn't download every file in the cookbook?
[2014-07-11 02:19:06 -0400] bytheway: I can knife download the cookbook and the template is there, but when on a node, the copy in /var/chef/cache doesn't include the template
[2014-07-11 02:35:05 -0400] stensonb: anybody have an "advanced routing" cookbook?  something that support multiple routing tables and multiple interfaces?
[2014-07-11 02:35:54 -0400] _evo_soumya_: All - I just noticed a small bug with the Continuuity Hadoop Recipes - basically Amazon AMIs have changed to report the platform as ubuntu instead of debian
[2014-07-11 02:36:12 -0400] _evo_soumya_: But I'm still perplexed why the apt_repository isn't working
[2014-07-11 02:36:48 -0400] _evo_soumya_: Here's the block of code: cdh_release = 5 codename = 'precise'      apt_repository "cloudera-cdh#{cdh_release}" do       uri 'http://archive.cloudera.com/cdh5/ubuntu/precise/amd64/cdh/'       key 'http://archive.cloudera.com/cdh5/ubuntu/precise/amd64/cdh/archive.key'       distribution 'precise-cdh5.0.2'       components ['contrib']       arch 'amd64'       action :add     end
[2014-07-11 02:36:56 -0400] Damm: stensonb, do you configure all your interfaces with chef?
[2014-07-11 02:37:09 -0400] stensonb: i want to...but i don't now.
[2014-07-11 02:37:22 -0400] Damm: without the first; the second would seem bad
[2014-07-11 02:37:49 -0400] Damm: stensonb, as really if you configure the interfaces you can configure the routing
[2014-07-11 02:38:01 -0400] stensonb: agreed...i'm not managing ANY of the interfaces with chef.
[2014-07-11 02:38:06 -0400] stensonb: yeah, understood.
[2014-07-11 02:38:40 -0400] Damm: https://github.com/opscode/chef/tree/master/lib/chef/provider/ifconfig
[2014-07-11 02:38:43 -0400] Damm: ifconfig does exist
[2014-07-11 02:38:49 -0400] Damm: just depending on the distro
[2014-07-11 02:38:51 -0400] Damm: it maybe eh
[2014-07-11 02:38:54 -0400] stensonb: i was hoping somebody had written a cookbook to manage the items i'm managing...basically, "ip route" and "ip rule" things from iproute2
[2014-07-11 02:47:36 -0400] Damm: hmm nothing standing out
[2014-07-11 02:47:40 -0400] Damm: on the community site
[2014-07-11 02:47:58 -0400] Damm: http://docs.opscode.com/resource_route.html
[2014-07-11 02:48:04 -0400] Damm: dont' forget that baby
[2014-07-11 03:07:23 -0400] stensonb: thanks @Damm...looks like that provider operates on the default routing table.  maybe a PR is in my near future. :)
[2014-07-11 03:10:49 -0400] Guest44733: hi, any suggestions for auto-incrementing cookbook versions?
[2014-07-11 04:15:48 -0400] mattberther: anyone have any thoughts on the best way to copy a directory that is already on a node to a different directory on the same node?
[2014-07-11 04:20:52 -0400] lamont_oc: ruby_block with a FileUtils.cp I think
[2014-07-11 04:21:51 -0400] lamont_oc: remote_file takes file:// urls which lets you do local copy of single files
[2014-07-11 04:22:15 -0400] lamont_oc: remote_directory doesnt have anything like that
[2014-07-11 04:23:56 -0400] lamont_oc: the chef way of doing that would also be fairly messy  if i write a local recursive file copy, id wind up spawning a directory or file resource for every directory or file in the source heirarchy that im copying.  then you get idempotency and you get granular reporting of what changed.  but if you have thousands of files you get thousands of resources and it gets expensive
[2014-07-11 04:25:24 -0400] mattberther: fair. let me try the FileUtils.cp path to start with... thanks!
[2014-07-11 04:25:47 -0400] lamont_oc: youll want to use some kind of not_if to check for a sentinil file or directory having already been copied
[2014-07-11 04:25:56 -0400] mattberther: I *think* i can make it idempotent with notifications
[2014-07-11 04:26:06 -0400] lamont_oc: yeah or that works
[2014-07-11 04:26:47 -0400] lamont_oc: if you wanted to prevent tampering and reset the contents if they ever changed (given any possible change) then youd probably want an execute block to rsync and always run it
[2014-07-11 04:27:47 -0400] mattberther: interesting approach. i might look at using that
[2014-07-11 04:29:07 -0400] lamont_oc: i grew up with about 2 dozen junior SAs under me who tended to make with the typey-typey on servers and undo whatever CFEngine did, so i can be real paranoid and assertive about state   thats probably excessive though
[2014-07-11 04:33:12 -0400] mattberther: im in a similar position -- we recently migrated to chef and changing old behaviors can be challenging
[2014-07-11 04:42:44 -0400] drgeb: anyone know how to configure ngnix of the open chef server so I can host files from this same server ?
[2014-07-11 04:47:45 -0400] double_p: drgeb: the config is from /var/opt/chef-server/nginx/etc/nginx.conf
[2014-07-11 04:52:15 -0400] drgeb: double_p I was looking in the directory inside /opt/chef-server/embedded/html
[2014-07-11 04:53:30 -0400] drgeb: double_p I tried creating a folder files and created a hello.html file their but unable to load this in my browser when going to http://myserver/files/hello.html
[2014-07-11 04:55:55 -0400] double_p: check the config, the included part upstreams location / (everything) besides /docs
[2014-07-11 04:58:56 -0400] coderanger: lamont_oc: Is http://www.getchef.com/chef/full_client_list considered a formal part of the omnitruck API or is it an impl detail of www?
[2014-07-11 04:59:19 -0400] coderanger: lamont_oc: (read: is there a somewhat stable way to get the list of current builds)
[2014-07-11 05:29:28 -0400] burtlo: Anyone ever set up SSL on TeamCity?
[2014-07-11 05:40:41 -0400] chandra: i have to Write a recipe to deploy a cron entry on each node which executes at every minute and ensures reachability of a particular host and only when that host goes down it mails to the concerned person and reports the event.
[2014-07-11 05:40:54 -0400] chandra: can anyone tel me how can i write this ?
[2014-07-11 05:42:19 -0400] double_p: chandra: there's a cron resource http://docs.opscode.com/resource_cron.html
[2014-07-11 05:44:12 -0400] chandra: yes. i went through it . Bt in my case how the logic can be applied
[2014-07-11 05:44:33 -0400] chandra: what would be the exact recipe for that task
[2014-07-11 05:45:33 -0400] coderanger: chandra: The details are up to you
[2014-07-11 05:45:50 -0400] coderanger: chandra: cron just runs the script, what is in that script can be just about anything
[2014-07-11 05:46:56 -0400] double_p: every minute is just "*" for every time (minute, hour, ..) the actual "reachability" is up to you. a simple ping check with two tries: ping -c 2 127.0.0.2 >/dev/null 2>&1 || echo foo
[2014-07-11 05:48:07 -0400] coderanger: Thats one way to do it
[2014-07-11 05:48:12 -0400] coderanger: the emails will suck though
[2014-07-11 05:48:27 -0400] lamont_oc: coderanger: yeah its documented and stable: https://github.com/opscode/opscode-omnitruck#full_client_list-endpoint
[2014-07-11 05:48:40 -0400] coderanger: lamont_oc: \m/ thanky
[2014-07-11 05:48:53 -0400] lamont_oc: doc matches what i recall which is that its what the install page hits to populate the dropdowns
[2014-07-11 05:48:57 -0400] coderanger: lamont_oc: (most of those aren't on http://docs.opscode.com/api_omnitruck.html)
[2014-07-11 05:50:42 -0400] chandra: Thanks coderanger&double_p
[2014-07-11 05:50:44 -0400] lamont_oc: yeah, i dont think that matters for what wed support though
[2014-07-11 05:50:52 -0400] coderanger: lamont_oc: Good enough for me :)
[2014-07-11 05:51:35 -0400] lamont_oc: i think the docs page just documents the parts of the api that 80% of people need to download a client (roll their own install.sh / debug it)
[2014-07-11 05:51:45 -0400] coderanger: Probably
[2014-07-11 05:52:25 -0400] lamont_oc: so we could add it there, but id rather just keep the full API docs in the README, same sla though
[2014-07-11 05:53:30 -0400] lamont_oc: would you care, or even notice if i fixed it so that -n and -p would also download released builds if they were more recent?
[2014-07-11 05:54:02 -0400] lamont_oc: aka &nightlies=true and &prereleases=true
[2014-07-11 05:54:04 -0400] coderanger: Probably not, I don't touch the /metadata API anyway
[2014-07-11 05:55:05 -0400] lamont_oc: 'k
[2014-07-11 07:14:18 -0400] vchauhan: hello
[2014-07-11 07:14:26 -0400] vchauhan: Do you have document for chf
[2014-07-11 07:21:51 -0400] coderanger: vchauhan: What kind of document?
[2014-07-11 07:23:26 -0400] balbirs: what is sever node and client in chef terminology?
[2014-07-11 07:24:41 -0400] coderanger: balbirs: In most cases you can ignore the difference, a client is an actual API client, meaning the credentials and ACLs tied to a single API consumer
[2014-07-11 07:25:39 -0400] coderanger: balbirs: A node is an object in the Chef-Server database that stores information about a single server (usually) in your infrastructure
[2014-07-11 07:26:05 -0400] coderanger: balbirs: a node is also sometimes the server itself when chef-client is actually running on it, more colloquially
[2014-07-11 07:36:14 -0400] vchauhan: To read aboy the chef
[2014-07-11 07:36:28 -0400] vchauhan: to read about chef
[2014-07-11 07:38:34 -0400] coderanger: vchauhan: docs.opscode.com is the main reference documentation, and learn.getchef.com is the tutorial
[2014-07-11 07:39:50 -0400] balbirs: coderanger: Thanks :)
[2014-07-11 07:40:14 -0400] vchauhan: coderanger: Thanks
[2014-07-11 07:42:50 -0400] balbirs: How to manage difference AWS account with knife ec2 plugins?
[2014-07-11 07:48:50 -0400] wpf: all , do you know that how to disable the log for "execute 'command blabla'" ?  it seems that the command will totally be echoed in the log file
[2014-07-11 08:36:55 -0400] daxroc_: wpf log-level
[2014-07-11 08:42:20 -0400] __julien: Hello, I would like to know the syntax to notify another action from within a provider. For example I use the template resource within an action, and I want to notify the restart action from the same provider.
[2014-07-11 08:46:11 -0400] greatdex: my apache2 wont stop
[2014-07-11 08:46:25 -0400] greatdex: it just saying waiting.. and back to prompt
[2014-07-11 08:46:32 -0400] daxroc_: _julien, it's well documented and there are many examples in community cookbooks
[2014-07-11 08:48:21 -0400] daxroc_: ignore me sorry
[2014-07-11 08:58:10 -0400] __julien: daxroc_, from within a LWRP ?
[2014-07-11 08:58:26 -0400] __julien: i saifd provider i meant lightweight provider
[2014-07-11 08:58:44 -0400] daxroc_: Same as how you would any other
[2014-07-11 09:17:21 -0400] balbirs: in the bootstrape process why chef also gets installed along with chef-client?
[2014-07-11 09:34:56 -0400] balbirs: if I use 'knife ssh "role:webserver" "sudo chef-client"' then ssh will be logged in via which user ?
[2014-07-11 10:15:09 -0400] daxroc_: Isn't having both a metadata.rb , metadata.json a conflict. Why do community downloaded cookbooks contain both ?
[2014-07-11 10:19:10 -0400] daxroc_: *I'm assuming that supermarket uses chef-server / bookshelf to store cookbooks and then a download to package them back for re-distribution
[2014-07-11 10:42:56 -0400] __julien: Hello, in an LWRP provider, I would like to know the syntax to notify another action of the  provider.  the equivalent of new_resource.run_action(:restart) for example but using notifies syntax
[2014-07-11 10:44:42 -0400] drrk: hi, any idea how to fix this error with vagrant-berkshelf (or a better irc channel to ask in) https://gist.github.com/DjordjePetrovic/a475b91637fa1f1a4e05
[2014-07-11 10:45:29 -0400] drrk: I found a gist from matt ray with the same error, who I think I have seen in the channel before, might be wrong
[2014-07-11 10:47:37 -0400] drrk: staff tech can you see if my line is showing as up or down, it shows as up on clueless but I can't access my router (kj1@a)
[2014-07-11 10:47:52 -0400] soblom_: drrk: what does 'vagrant plugin list' give you?
[2014-07-11 10:48:58 -0400] drrk: asking the developer...
[2014-07-11 10:49:18 -0400] soblom_: drrk: probably a version problem. vagrant-berkshelf needs to be >= 2.0.1
[2014-07-11 10:49:56 -0400] drrk: since when?
[2014-07-11 10:50:03 -0400] drrk: 1.3.7 worked yesterday
[2014-07-11 10:50:46 -0400] drrk: (we have a rather fragile setup and the latest vagrant doesn't work)
[2014-07-11 10:51:00 -0400] soblom_: drrk: sorry, assumed you where on a current version
[2014-07-11 10:51:33 -0400] drrk: I wish :(
[2014-07-11 10:52:12 -0400] drrk: https://gist.github.com/DjordjePetrovic/fcee9f5c01387c5312b0
[2014-07-11 10:52:28 -0400] soblom_: which vagrant version are we talking?
[2014-07-11 10:53:41 -0400] drrk: 1.3.4
[2014-07-11 10:54:23 -0400] drrk: the same setup works for some not others
[2014-07-11 10:54:32 -0400] drrk: I think i'l get them to clean the plugins and start again
[2014-07-11 10:54:43 -0400] soblom_: other thing I noticed: you have both vagrant-berkshelf and berkshelf
[2014-07-11 10:55:04 -0400] soblom_: I dont have the berkshelf one, but maybe that is also different in the older versions...
[2014-07-11 10:55:06 -0400] drrk: yes - the get the fixed berkshelf that can handle the ssl redirect
[2014-07-11 10:55:24 -0400] drrk: since chef took over the api last week
[2014-07-11 10:56:44 -0400] soblom_: gotta go, good luck
[2014-07-11 10:57:35 -0400] drrk: Cheers
[2014-07-11 11:25:51 -0400] ssd7: Ohai Chefs
[2014-07-11 11:26:19 -0400] shin_: ey up
[2014-07-11 11:30:20 -0400] shin_: i'm having a problem debugging a search query on aws opsworks. I was thinking to help debugging maybe I could dump the whole node search index to a file so I can download it and query it locally. Can someone tell me how to dupm the node index or if there's an easier way to debug?
[2014-07-11 11:31:06 -0400] ssd7: shin_: There is probably an easier way.  What kind of problem are you hitting?
[2014-07-11 11:31:18 -0400] __julien: shin_, you mean opsworksagent-cli get_json ?
[2014-07-11 11:31:59 -0400] shin_: __julien: I don't think that returns the node index, does it? just the opswork stack data afaik but i'll check
[2014-07-11 11:32:27 -0400] __julien: im not sure what the node index is
[2014-07-11 11:32:55 -0400] shin_: ssd7: I have a query that's returning nothing: http://pastebin.com/ctEb1L9u
[2014-07-11 11:33:20 -0400] shin_: __julien: my understanding it's when you do search(:node, "blah") you're searching the node search index
[2014-07-11 11:33:35 -0400] shin_: ssd7: it's part of the mongodb community cookbook
[2014-07-11 11:33:38 -0400] __julien: shin_,  got it, so I'm wrong
[2014-07-11 11:34:36 -0400] shin_: ssd7: if i add my own recipe to the run list with the same query in it, it passes though in my recipe I'm substituting the values in
[2014-07-11 11:35:29 -0400] shin_: ssd7: so maybe the values are mismatched but I'm logging them to console and they look the same but i'm sure i'm missing something obvious which is why i thought i'd get there quicker by debugging locally
[2014-07-11 11:36:23 -0400] ssd7: Does opsworks allow you to run knife commands against it?
[2014-07-11 11:37:09 -0400] shin_: i'm a bit new to Chef tbh but I don't think so because chef-zero is only run for the duration of the run
[2014-07-11 11:37:52 -0400] ssd7: np, give me a sec to look at opsworks
[2014-07-11 11:38:36 -0400] shin_: i've tried ssh'ing to the box and using chef-shell etc but then realised chef-zero wasn't there. Generally you use their commands "sudo opsworks-agent-cli run_command configure" to kick off a run_list where it starts up chef-zero, prepends some opsworks cookbooks and then runs your stuff.
[2014-07-11 11:43:41 -0400] ssd7: shin_: Unfortunately, I don't know as much as I should about how opsworks under the hood.  So you can run the same query in a different recipe and it works?  If so, could you get a debug log of a chef client run with both the failing search and the working search in it?
[2014-07-11 11:46:04 -0400] shin_: ssd7: that's what I'm kinda doing with debug statements, i've forked the mongodb cookbook and started to add debug in there to get an idea of what's happening but it takes a couple minutes each time to spin up, run config etc
[2014-07-11 11:47:28 -0400] shin_: ssd7: but thanks anyway, I'll get there eventually. Maybe it's something like boolean types in the search of something.
[2014-07-11 11:47:38 -0400] shin_: ssd7: but thanks anyway, I'll get there eventually. Maybe it's something like boolean types in the search or something.
[2014-07-11 11:48:50 -0400] shin_: i'm in two minds about opsworks, on one hand it's convenient in terms of defining the stack in terms of ec2, disks etc
[2014-07-11 11:49:12 -0400] shin_: on the other hand it's hard to debug because chef server is hidden
[2014-07-11 11:49:16 -0400] __julien: Hello, in an LWRP provider, I would like to know the syntax to notify another action of the  provider.   IN orther words the equivalent of new_resource.run_action(:ressource_action) but  from a  "notifies"
[2014-07-11 11:53:08 -0400] ssd7: __julien: You should be able to call the action_ACTIONNAME function directly
[2014-07-11 11:53:15 -0400] ssd7: __julien: I'll find an example, one sec
[2014-07-11 11:53:57 -0400] __julien: ssd7, thx I've been looking to other LWRPs code, but can't find the proper way to do it
[2014-07-11 11:57:43 -0400] ssd7: __julien: I am still looking for an example, but I believe if you have an action named :install, you should just be able to call action_install as a function
[2014-07-11 11:58:24 -0400] ssd7: __julien: Although, often, when I find I want to do that, I just factor out the common behavior to a method anyway:
[2014-07-11 11:58:27 -0400] ssd7: __julien: https://github.com/stevendanna/cookbook-r/blob/master/providers/package.rb#L27-L41
[2014-07-11 11:59:43 -0400] __julien: ssd7,  I think I don't get it
[2014-07-11 12:00:26 -0400] ssd7: __julien: Or I don't :).  My understanding is that you have one action that effectively needs to call another action.  Is that not correct?
[2014-07-11 12:00:49 -0400] __julien: ssd7, exactly, but from a notify , I'll create a pastebin
[2014-07-11 12:02:47 -0400] __julien: http://pastebin.com/A7R34HYf
[2014-07-11 12:02:58 -0400] __julien: line 16
[2014-07-11 12:03:39 -0400] __julien: I wanna call another action from  the notify of a ressource within another actionn
[2014-07-11 12:04:06 -0400] ssd7__: OK, well, my wifi network hates me at the moment
[2014-07-11 12:04:16 -0400] ssd7__: but you explicitly want the notify so that you can get the delayed timing?
[2014-07-11 12:04:39 -0400] __julien: http://pastebin.com/A7R34HYf
[2014-07-11 12:04:49 -0400] __julien: classical stuff if it were not in a provider
[2014-07-11 12:05:06 -0400] __julien: I just wanna reload a service if the template modifies the configuration file
[2014-07-11 12:05:18 -0400] __julien: but because the provideer alresdy inplements the restart action
[2014-07-11 12:05:24 -0400] __julien: i"d like to call that action
[2014-07-11 12:05:35 -0400] __julien: rather that recreating a service ressource within the action
[2014-07-11 12:05:58 -0400] __julien: I think the apstebin example is a better explanation than my words :)
[2014-07-11 12:06:08 -0400] ssd7__: Right, OK.  Do you care about the restart being delayed or is immediate OK?
[2014-07-11 12:06:36 -0400] __julien: ssd7__, I'd like to know both, but immediate could be okay as well
[2014-07-11 12:06:59 -0400] __julien: I just might restart mutiple times so won't be that good
[2014-07-11 12:08:23 -0400] ssd7__: __julien: Hrm, I'm not sure I've actually done something like this (with it delayed).  If you are OK with an immediate restart, you can save the template resource to a variable, see if it was updated, and then call action_restart if it was updated.
[2014-07-11 12:09:06 -0400] ssd7__: For a delayed notification, I think the only way would be to make a resource with action :nothing and then notify that rather than just calling the method
[2014-07-11 12:09:43 -0400] ssd7__: Man, I'm striking out today in terms of the question answering in IRC.  Maybe I need more coffee :)
[2014-07-11 12:09:49 -0400] __julien: :)
[2014-07-11 12:10:28 -0400] __julien: thx , I'll try the latest
[2014-07-11 12:47:33 -0400] hirose31: http://supermarket.getchef.com/api/v1 force to redirect https://...?
[2014-07-11 12:51:53 -0400] nulleric: @hirose31 http://www.getchef.com/blog/2014/07/10/berkshelf-v2-outage-postmortem/ has some detail on the redirect
[2014-07-11 12:52:38 -0400] hirose31: nulleric: thanks!
[2014-07-11 12:53:07 -0400] hirose31: https://api.berkshelf.com/universe returns "location_path": "http://supermarket.getchef.com/api/v1",
[2014-07-11 12:53:40 -0400] hirose31: but berkshelf does not support HTTP redirect https://github.com/berkshelf/berkshelf/blob/master/lib/berkshelf/community_rest.rb#L123, so error occurred
[2014-07-11 12:53:54 -0400] nulleric: ya the url for universe i think is here: https://supermarket.getchef.com/universe.json
[2014-07-11 12:59:10 -0400] hirose31: hmm.. https://supermarket.getchef.com/universe.json also returns "http://" location_path.
[2014-07-11 12:59:58 -0400] obazoud: got some problems to download cookbook too
[2014-07-11 13:00:02 -0400] hirose31: berkshelf/community_rest.rb should support HTTP redirect (301)?
[2014-07-11 13:00:52 -0400] nulleric: in that blog post a new version of berks was released that should have corrected that issue (i think)
[2014-07-11 13:00:53 -0400] nulleric: http://rubygems.org/gems/berkshelf/versions/2.0.18
[2014-07-11 13:01:25 -0400] obazoud: I use berkshelf 3.1.3
[2014-07-11 13:03:19 -0400] jujugrrr: obazoud, Is it the kind of issue you have ? http://pastebin.com/nyCRpnXs
[2014-07-11 13:03:38 -0400] obazoud: jujugrrr, yes
[2014-07-11 13:04:07 -0400] jujugrrr: I'm not alone then :-)
[2014-07-11 13:04:11 -0400] obazoud: jujugrrr, you find a workaround ?
[2014-07-11 13:04:19 -0400] jujugrrr: nope
[2014-07-11 13:04:19 -0400] hirose31: :D
[2014-07-11 13:07:51 -0400] phelms: Hey does chef node attributes have a Uniue ID?
[2014-07-11 13:08:01 -0400] obazoud: my log: https://gist.github.com/obazoud/44f6d4c556db5299f86b
[2014-07-11 13:09:15 -0400] hirose31: jujugrrr: obazoud: workaround is here: https://gist.github.com/hirose31/7f934f5e21917200f056
[2014-07-11 13:09:32 -0400] jujugrrr: cheers
[2014-07-11 13:11:20 -0400] jujugrrr: hirose31, it worked well indeed
[2014-07-11 13:11:42 -0400] hirose31: yay!
[2014-07-11 13:12:22 -0400] jujugrrr: hirose31, are you submitting a PR to Berkshelf?
[2014-07-11 13:12:55 -0400] obazoud: hirose31: works fine, thanks!
[2014-07-11 13:12:59 -0400] hirose31: jujugrrr: not yet
[2014-07-11 13:14:00 -0400] hirose31: could you submit a PR? becuase English is too hard for me :X
[2014-07-11 13:15:34 -0400] jujugrrr: hirose31, oky
[2014-07-11 13:16:03 -0400] hirose31: thanks :D
[2014-07-11 14:16:03 -0400] george_mcfly: Are there any chef certifications available ?
[2014-07-11 14:16:04 -0400] drrk: ahh mattray
[2014-07-11 14:16:22 -0400] drrk: you have hit a problem we are seeing (as there is a gist on your github username)
[2014-07-11 14:16:39 -0400] jonlives: george_mcfly: not currently I don't think
[2014-07-11 14:16:47 -0400] drrk: https://gist.github.com/DjordjePetrovic/d452db58df787e3bb69d
[2014-07-11 14:16:53 -0400] drrk:  any idea how it was fixed
[2014-07-11 14:16:55 -0400] jonlives: george_mcfly: tho you can do http://www.getchef.com/training/
[2014-07-11 14:17:37 -0400] mattray: drrk: by not using vagrant-berkshelf?
[2014-07-11 14:17:48 -0400] drrk: that would be nice
[2014-07-11 14:18:37 -0400] mattray: drrk: j^2 was dealing with it yesterday, the work-around for him (he was using vagrant-chef-zero) was to do the berks commands to a directory and the chef-zero config in the Vagrantfile pointed to that
[2014-07-11 14:18:54 -0400] mattray: drrk: in the context of Vagrant and testing the openstack cookbooks
[2014-07-11 14:19:01 -0400] drrk: I thought that might be it
[2014-07-11 14:19:19 -0400] drrk: it's weird that it's suddenly started happening for one of out developers today
[2014-07-11 14:19:28 -0400] drrk: and is fine for the others
[2014-07-11 14:20:04 -0400] mattray: drrk: when j^2 gets online you could ask him about it, he went way down the vagrant-berkshelf yakhole yesterday
[2014-07-11 14:20:44 -0400] drrk: yeah, looks like we have already got a PR for removing vagrant-berkself
[2014-07-11 14:20:50 -0400] drrk: so we are doing that
[2014-07-11 14:20:51 -0400] legal90: Hallo! Users of ChefDK, please, give me an advice: how can I update a Berkshelf version, bundled with ChefDK?
[2014-07-11 14:21:17 -0400] drrk: Thanks mattray
[2014-07-11 14:21:46 -0400] mattray: wish I had a more helpful answer
[2014-07-11 14:23:03 -0400] gleam: /opt/chefdk/embedded/bin/gem update ..
[2014-07-11 14:24:14 -0400] drrk: mattray: we are trying to remove vagrant from the setup anyway, as it's too flaky
[2014-07-11 14:24:21 -0400] drrk: so you have helped in a way
[2014-07-11 14:24:41 -0400] mattray: drrk: cool.
[2014-07-11 14:24:41 -0400] davidgiesberg: hi mattray - I submitted a PR to knife-rackspace a couple of weeks ago and I haven't heard anything back - anything I can do to help move it along? https://github.com/opscode/knife-rackspace/pull/87
[2014-07-11 14:25:38 -0400] mattray: davidgiesberg: the Rackspace maintainer recently left and I assume the new maintainers missed that
[2014-07-11 14:26:35 -0400] mattray: davidgiesberg: I'll go verify the intended behavior (which I assume is CLI > knife.rb)
[2014-07-11 14:27:11 -0400] davidgiesberg: mattray: that makes sense, and yes I want CLI > knife.rb
[2014-07-11 14:27:36 -0400] davidgiesberg: I've seen inconsistencies in that behavior elsewhere in knife, but this one is a particular PITA
[2014-07-11 14:27:59 -0400] mattray: davidgiesberg: we're fixing it here: https://github.com/opscode/knife-cloud/blob/master/lib/chef/knife/cloud/helpers.rb#L32
[2014-07-11 14:28:12 -0400] mattray: davidgiesberg: knife-rackspace will get retrofitted eventually
[2014-07-11 14:28:33 -0400] mattray: there should be a knife-openstack and knife-ec2 based on knife-cloud in the next week or so
[2014-07-11 14:28:47 -0400] mattray: other knife plugins will eventually follow
[2014-07-11 14:28:50 -0400] davidgiesberg: oh nifty, I hadn't seen this project
[2014-07-11 14:29:00 -0400] mattray: (knife-vchs and knife-cloudstack are already using knife-cloud)
[2014-07-11 14:30:31 -0400] mattray: davidgiesberg: merged
[2014-07-11 14:30:35 -0400] davidgiesberg: cool, thanks!
[2014-07-11 14:31:02 -0400] davidgiesberg: (BTW, I think we have a mutual acquaintance - jcsalterego)
[2014-07-11 14:33:34 -0400] patbyrne: hi, I'm having a problem using berks today. I'm trying to source from https://supermarket.getchef.com but when it builds the universe all the urls in the json point to "http://" instead of "https://", so when it tries to request the json for the specific cookbook it gets a 301 response as it tries to redirect the request to https
[2014-07-11 14:34:08 -0400] patbyrne: has anyone else seen any similar issues?
[2014-07-11 14:35:17 -0400] jujugrrr: patbyrne, https://github.com/berkshelf/berkshelf/pull/1258
[2014-07-11 14:35:37 -0400] jujugrrr: Oops maybe not
[2014-07-11 14:35:56 -0400] byggztryng: does any one have a recommendation for a cookbook providing a compression resource, like 'tar + gzip'?
[2014-07-11 14:36:28 -0400] davidgiesberg: byggztryng: what are you trying to accomplish
[2014-07-11 14:36:44 -0400] hannesvdvreken: patbyrne http://www.getchef.com/blog/2014/07/10/berkshelf-v2-outage-postmortem/
[2014-07-11 14:37:11 -0400] hannesvdvreken: Try upgrading to berks 2.0.18
[2014-07-11 14:37:18 -0400] hannesvdvreken: if you're using v2
[2014-07-11 14:37:42 -0400] wlovett: hannesvdvreken: we're using 3.1.1
[2014-07-11 14:37:52 -0400] wlovett: (patbyrne is sat next to me)
[2014-07-11 14:38:44 -0400] wlovett: jujugrrr: side-issue, there's a minor bug in errors.rb:
[2014-07-11 14:38:58 -0400] wlovett: diff --git a/lib/berkshelf/errors.rb b/lib/berkshelf/errors.rb
[2014-07-11 14:38:59 -0400] wlovett: index 8f53d89..f2c54c7 100644
[2014-07-11 14:38:59 -0400] wlovett: --- a/lib/berkshelf/errors.rb
[2014-07-11 14:39:00 -0400] wlovett: +++ b/lib/berkshelf/errors.rb
[2014-07-11 14:39:02 -0400] wlovett: @@ -209,7 +209,7 @@ module Berkshelf
[2014-07-11 14:39:04 -0400] wlovett:      def to_s
[2014-07-11 14:39:07 -0400] wlovett:        "An unexpected error occurred retrieving #{@message} from the cookbook " \
[2014-07-11 14:39:07 -0400] byggztryng: davidgiesberg: backing up Bamboo's home directory prior to an upgrade
[2014-07-11 14:39:08 -0400] wlovett: -      "site at '#{@api_uri}'."
[2014-07-11 14:39:10 -0400] wlovett: +      "site at '#{@uri}'."
[2014-07-11 14:39:12 -0400] wlovett:      end
[2014-07-11 14:39:14 -0400] wlovett:    end
[2014-07-11 14:40:29 -0400] byggztryng: davidgiesberg: but it's really just a general query, is there a native resource for creating archives
[2014-07-11 14:40:36 -0400] hannesvdvreken: wlovett use gist or something similar to post blocks of code
[2014-07-11 14:41:54 -0400] davidgiesberg: byggztryng: got it. I'd just do `execute 'tar -czf archive.tar.gz /sourcedir'`
[2014-07-11 14:42:36 -0400] davidgiesberg: but that's a bit on the quick and dirty side
[2014-07-11 14:43:25 -0400] wlovett: hannesvdvreken: apologies.  jujugrrr - gist is https://gist.github.com/willlovett/62d998fc035c8be3ac6c
[2014-07-11 14:43:33 -0400] wlovett: btw, that patch works for us - thanks
[2014-07-11 14:44:42 -0400] byggztryng: davidgiesberg: yeah, that's what I was hoping to avoid. assuming a native resource would be better designed than me trying to craft some guard clauses
[2014-07-11 14:44:57 -0400] davidgiesberg: makes sense
[2014-07-11 14:45:39 -0400] byggztryng: davidgeisberg: i'm kind of surprised that there is no solution in the supermarket yet; i assumed this would be a fairly common pattern
[2014-07-11 14:48:09 -0400] davidgiesberg: byggztryng: I imagine it'd be tricky to generalize in a way that'd be useful for > 1 use case
[2014-07-11 14:48:13 -0400] davidgiesberg: or person
[2014-07-11 14:51:00 -0400] wlovett: did someone just fix the universe? :)
[2014-07-11 14:51:22 -0400] wlovett: https://supermarket.getchef.com/universe was returning 'http' 10 minutes ago, and is now 'https'
[2014-07-11 15:18:51 -0400] chef629: is there a way to set a resource attribute to default to cookbook_name?  i've tried default: cookbook_name and default: self.cookbook_name and get method not found.
[2014-07-11 15:21:53 -0400] byggztryng: chef269: which resource are you working with?
[2014-07-11 15:21:56 -0400] jreslock: chef629: You should be able to say node.default[someattr] = #{cookbook_name}
[2014-07-11 15:23:07 -0400] chef629: no, i want to default a resource attribute to cookbook_name
[2014-07-11 15:23:21 -0400] chef629: i guess alternatively i could set it to nil and use cookbook name if it isn't set.
[2014-07-11 15:41:46 -0400] nd__: How do I upload a cookbook to the new supermarket? `knife cookbook site share <name> <category>` drives me nuts as supermarkt doesn't seem to have any categories any more, but in any case fails because of key issues there doesn't seem to be any manual upload any more can someone give me a hint?
[2014-07-11 15:44:43 -0400] hhoover: nd__ check out https://github.com/cwebberOps/knife-supermarket
[2014-07-11 15:45:45 -0400] hhoover: nd__ stove also works well https://github.com/sethvargo/stove
[2014-07-11 15:52:50 -0400] Shred00: any hints on how not to have to duplicate .../templates/redhat-6.5 into .../templates/centos-6.5?
[2014-07-11 15:53:53 -0400] sam___: does anyone know how to join chef community call today @9am PT?
[2014-07-11 15:55:31 -0400] Shred00: sadly, symlinking doesn't work
[2014-07-11 15:55:47 -0400] paulmooring_phon: Sam___ join #chef-hacking
[2014-07-11 15:56:20 -0400] sam___: is it chat or audio/video?
[2014-07-11 15:56:36 -0400] davidordave: @Shred00, could partial templates help?
[2014-07-11 15:56:39 -0400] shlant: Shred00: you could try to utilize partial templates
[2014-07-11 15:56:42 -0400] shlant: ahha
[2014-07-11 15:56:46 -0400] shlant: beat me to it
[2014-07-11 15:56:48 -0400] paulmooring_phon: Its rid so text
[2014-07-11 15:56:58 -0400] paulmooring_phon: *irc
[2014-07-11 15:57:19 -0400] davidordave: only barely :)
[2014-07-11 15:57:24 -0400] davidordave: @Shred00 http://docs.opscode.com/resource_template.html#partial-templates
[2014-07-11 16:11:55 -0400] shlant: jkeiser: so i finally got metal provisioning last night. super excited. I quickly ran into "Net::HTTPServerException: 403 "Forbidden"
[2014-07-11 16:12:11 -0400] shlant: do I have to explicitly specify the chef server pem file?
[2014-07-11 16:12:12 -0400] nd__: hhoover: Thanks, will check em both
[2014-07-11 16:12:12 -0400] doug2: What's the best way to store AWS creds in chef?
[2014-07-11 16:12:33 -0400] shlant: doug2: probably to not store them at all ;)
[2014-07-11 16:12:38 -0400] shlant: are you using ec2?
[2014-07-11 16:12:41 -0400] doug2: shlant: That'd be nice. Yes
[2014-07-11 16:12:47 -0400] paulmooring: doug2 carefully ;)
[2014-07-11 16:13:03 -0400] paulmooring: doug2 but seriously we use chef-vault and it's pretty ok
[2014-07-11 16:13:18 -0400] doug2: paulmooring: Chef vault is giving me al sorts of errors
[2014-07-11 16:13:41 -0400] doug2: "ERROR: TypeError: no implicit conversion of Array into String". I don't know why ruby folks can't catch their exceptions.
[2014-07-11 16:14:01 -0400] shlant: doug2: if you're using ec2, check out citadel. If you aren't vault/encrypted data bags might be your only option
[2014-07-11 16:14:33 -0400] doug2: shlant: For citadel to work, you need to assign a role to instances. INstances can only be assigned one role, and they already got one
[2014-07-11 16:14:51 -0400] shlant: doug2: I hear ya. Not sure why AWS did that :(
[2014-07-11 16:15:18 -0400] doug2: ugh
[2014-07-11 16:15:29 -0400] paulmooring: doug2 so I think a lot of folks are tied up in a chef developer meeting right now
[2014-07-11 16:15:31 -0400] jessemdavis: you can assign multiple policies to a role
[2014-07-11 16:15:37 -0400] jessemdavis: IAM role that is
[2014-07-11 16:15:40 -0400] nd__: hhoover: Same key error so I guess the tool is not the problem, but my key or something
[2014-07-11 16:15:42 -0400] doug2: jessemdavis: Hm
[2014-07-11 16:15:47 -0400] doug2: lemme see
[2014-07-11 16:15:52 -0400] jtimberman: doug2: that's probably because you didn't pass in the admins with -A. it's a bug in chef-vault.
[2014-07-11 16:16:01 -0400] paulmooring: thanks jtimberman
[2014-07-11 16:16:02 -0400] jtimberman: or you didn't use --mode client
[2014-07-11 16:16:44 -0400] doug2: jtimberman: I intentionally left out mode-client, because I need this to work with vagrant
[2014-07-11 16:16:57 -0400] nd__: To publish a cookbook on supermarkt, do I have to sign either the ICLA or the CCLA? Or connect with github? I can't get my update through
[2014-07-11 16:16:59 -0400] dougireton: @doug2 The TypeError Array -> String error may be this issue: https://github.com/Nordstrom/chef-vault/issues/94
[2014-07-11 16:17:33 -0400] phelms: Is an enterprise server needed for the API?
[2014-07-11 16:17:47 -0400] spenserp: Does anyone have any experience or good links/guides/tutorials for using chef within the context of auto scaling groups on AWS?
[2014-07-11 16:18:39 -0400] paulmooring: phelms the server essentially is an API, but there's some endpoints in Enterprise Chef that don't exist in the open source server
[2014-07-11 16:18:57 -0400] doug2: Looks like you can assign multiple policies to an IAM role, but those policies aren't referencable, ie you have to recreate them each time
[2014-07-11 16:20:42 -0400] shlant: nd__: nathenharvey jsut answered that in #chef-hacking
[2014-07-11 16:20:56 -0400] nd__: To the timemachine!
[2014-07-11 16:21:10 -0400] phelms: paulmooring: I'm doing a GET call to /node and it returns blank.. auth error?
[2014-07-11 16:21:13 -0400] nd__: shlant: Can you summarize for me? :/
[2014-07-11 16:21:41 -0400] paulmooring: phelms yeah you still have to auth (that's what you client key does in knife/chef-client)
[2014-07-11 16:22:03 -0400] phelms: I created a new account and copied the key into it and am specifically using that
[2014-07-11 16:22:18 -0400] paulmooring: oh I see what you mean
[2014-07-11 16:22:33 -0400] phelms: I'll try with the default admin key and see if that works
[2014-07-11 16:22:39 -0400] pbpolar: spenserp: Can you say more about what you auto-scale group & Chef question is?
[2014-07-11 16:23:25 -0400] doug2: Added data_bag_path to knife.rb and still getting "ERROR: TypeError: no implicit conversion of Array into String". *sigh*
[2014-07-11 16:23:33 -0400] pbpolar: A node instantiated in an autoscale group should  use EC2 userdata and cloud-init to auth chef-server and converge.
[2014-07-11 16:24:13 -0400] shlant: nd__: I think you just need a CLA attached to your github
[2014-07-11 16:24:30 -0400] shlant: CCLA's provide extra maanagement capabilities
[2014-07-11 16:24:44 -0400] spenserp: pbpolar: I think that is the missing piece i was having trouble figuring out actually
[2014-07-11 16:24:54 -0400] nd__: shlant: But this is for my own cookbook, yes? I'm not trying to commit to an getchef-maintained cookbook
[2014-07-11 16:25:10 -0400] jtimberman: to be clear: You do not need to sign a CLA/CCLA w/ CHEF (the company) if you want to publish your own cookbook to the site.
[2014-07-11 16:25:35 -0400] doug2: How am I supposed to debug an error like 'ERROR: TypeError: no implicit conversion of Array into String' without a backtrace, a catching of the exception or a line #?
[2014-07-11 16:25:36 -0400] jtimberman: You do need a CLA/CCLA to contribute to CHEF managed cookbooks, or any other CHEF managed project (like chef itself, omnibus, etc).
[2014-07-11 16:25:44 -0400] phelms: paulmooring: It would be the contents of the .pem file right? the private RSA key?
[2014-07-11 16:25:51 -0400] pbpolar: jessemdavis: You need to exercise care using IAM roles that the node does not persist with too much access to validators, etc. after boot.
[2014-07-11 16:25:58 -0400] nd__: jtimberman: thanks, that helps. Do you have a clue why the supermarket could say Authentication failed due to an invalid public/private key pair and how I can solve this?
[2014-07-11 16:25:58 -0400] paulmooring: phelms that's right
[2014-07-11 16:26:35 -0400] paulmooring: phelms if you want to provide the method you're using in a gist maybe myself or someone could give you a better idea what's going on
[2014-07-11 16:26:41 -0400] phelms: https://github.com/ozanturksever/ChefServerApi/blob/master/ChefServerApi.class.php
[2014-07-11 16:26:42 -0400] spenserp: pbpolar: So the role/run-list/etc for a particular node would be specified via cloud-init/user data, then the node would get it's required info from the server?
[2014-07-11 16:26:53 -0400] pbpolar: spenserp: can you say more on where you are stuck?
[2014-07-11 16:26:59 -0400] jtimberman: nd__: is that when you're trying to upload a cookbook?
[2014-07-11 16:27:04 -0400] zanshin: I'm in the process of moving some nodes from one chef-server to another. Am I better off completely removing Chef from the node prior to issuing the `knife bootstrap ` command from the new chef server?
[2014-07-11 16:27:12 -0400] jtimberman: like with 'knife supermarket share' or another sharing CLI?
[2014-07-11 16:27:13 -0400] nd__: jtimberman: cookbook site share, yes
[2014-07-11 16:27:22 -0400] pbpolar: spenserp: essentially, yes, that's right.
[2014-07-11 16:27:34 -0400] jtimberman: you need to download the private key for your user
[2014-07-11 16:27:43 -0400] spenserp: pbpolar: I don't that I'm stuck really, I'm just getting started on this project and there just seemed to be some pieces that were missing. Thanks!
[2014-07-11 16:28:08 -0400] nd__: jtimberman: Ah, which is not on the supermarket but on the normal chef account page
[2014-07-11 16:28:24 -0400] jtimberman: right
[2014-07-11 16:28:44 -0400] nd__: jtimberman: Thank you, will try
[2014-07-11 16:29:04 -0400] pbpolar: spenserp: remember not to put any authenticators in the EC2 userdata metadata, as any user/process on the node can access that at the metadata URL
[2014-07-11 16:29:26 -0400] hamush: anyone know if chef-solo-search is worth looking into for debugging hosted chef recipes?  it seems like it would be useful, but i'm having a hard time telling what it supports.. i can't seem to get it to work with chef-shell, which seems like it would be a showstopper for being useful for recipe debugging
[2014-07-11 16:29:48 -0400] doug2: Maybe "ERROR: TypeError: no implicit conversion of Array into String" means I put too much sugar in my tea.
[2014-07-11 16:30:03 -0400] jkeiser: shlant: if you are using Hosted or Enterprise Chef, provisioned nodes are going to have issues right now.  The way to fix is to knife edit /groups/admins.json and add "groups": [ "clients" ].  It sucks, and is next on my list, literally, to fix
[2014-07-11 16:30:21 -0400] dougireton: Is your data_bags_path a String, and not an Array?
[2014-07-11 16:30:33 -0400] jkeiser: shlant: if, after getting it to work, you want to submit a PR to the readme, it would not go amiss :)
[2014-07-11 16:30:46 -0400] doug2: dougireton: It's a string
[2014-07-11 16:30:53 -0400] shlant: jkeiser: will do, thanks
[2014-07-11 16:30:54 -0400] paulmooring: phelms I'm mostly following the dev meeting in #chef-hacking right now and can't give this the attention it needs for good advice, but I can follow up in an hour or so
[2014-07-11 16:31:08 -0400] doug2: dougireton: Initially it was empty. Got error. Added it. Got same error.
[2014-07-11 16:31:19 -0400] doug2: or rather, it wasn't set at all
[2014-07-11 16:31:40 -0400] phelms: paulmooring: I figured it out - SSL error
[2014-07-11 16:31:47 -0400] phelms: had to change to https and ignore SSL errors
[2014-07-11 16:31:57 -0400] phelms: thanks for your help
[2014-07-11 16:32:02 -0400] paulmooring: awesome, I starred your project too :D
[2014-07-11 16:32:53 -0400] doug2: Nothing via google for "ERROR: TypeError: no implicit conversion of Array into String", so apparently I can't follow the first step in the directions.
[2014-07-11 16:33:37 -0400] doug2: wait wait. it was an array
[2014-07-11 16:36:22 -0400] doug2: hang on a minute... chef vault... when you add a secret, it does a search to see what nodes have access... what if there are no nodes of that type yet!?!?
[2014-07-11 16:37:20 -0400] paulmooring: doug2 actually it does a search when you encrypt it and adds clients individually
[2014-07-11 16:37:49 -0400] doug2: paulmooring: oki
[2014-07-11 16:37:53 -0400] paulmooring: so if you use 'role:mycoolrole' as the query string and drop nodes from that role, they are not implicitly removed from the vault item
[2014-07-11 16:38:08 -0400] paulmooring: also it's additive, so you can add nodes one at a time safely
[2014-07-11 16:38:20 -0400] doug2: paulmooring: How are they added?
[2014-07-11 16:39:04 -0400] paulmooring: knife vault update vault thing_to_update --search 'name:somenodes-*' --mode client
[2014-07-11 16:39:34 -0400] doug2: kk
[2014-07-11 16:40:02 -0400] chef164: hi
[2014-07-11 16:40:27 -0400] chef164: I tried to run this command knife bootstrap uvo1o61gjyl1dok6uf7.vm.cld.sr -x sysadmin -P Ol7Q66Gy47 -N module2
[2014-07-11 16:40:46 -0400] s1991: Hello If I'm excuting command in chef how do I start virtualenv ?
[2014-07-11 16:40:54 -0400] chef164: and got error: uvo1o61gjyl1dok6uf7.vm.cld.sr /dev/fd/63: line 249: /tmp/stderr: Permission denied
[2014-07-11 16:41:31 -0400] doug2: Is chef vault gonna work with vagrant/kitchen?
[2014-07-11 16:42:36 -0400] paulmooring: doug2 there's ways to handle that, I believe that's the reason `--mode client` exists
[2014-07-11 16:43:41 -0400] paulmooring: if you're new to vault I'd look over this http://jtimberman.housepub.org/blog/2013/09/10/managing-secrets-with-chef-vault/
[2014-07-11 16:43:51 -0400] paulmooring: and then every other entry in jtimberman's blog
[2014-07-11 16:44:08 -0400] doug2: paulmooring: k. kinda thought that. but not sure how the search would work
[2014-07-11 16:44:31 -0400] doug2: paulmooring: no mention of vagrant there
[2014-07-11 16:46:05 -0400] paulmooring: doug2 there's better info examples of test-kitchen here: https://github.com/opscode-cookbooks/chef-vault
[2014-07-11 16:46:10 -0400] doug2: paulmooring: don't need vagrant to work right now as this is for ec2 keys, but it will probably bite me later if vault doesn't work with vagrant
[2014-07-11 16:46:27 -0400] paulmooring: I assume that's what you really need when you mention vagrant
[2014-07-11 16:47:30 -0400] doug2: paulmooring: err, that kitchen.yml refers to a cookbook that doesn't seem to exist. Lol.
[2014-07-11 16:47:59 -0400] doug2: 'recipe[test::chef_vault_secret]' ... that means the test cookbook which I can't access
[2014-07-11 16:48:40 -0400] doug2: if it means the test directory (there is one), then there's no chef_vault_secret recipe in there
[2014-07-11 16:48:44 -0400] paulmooring: doug2 that's a test kitchen thing
[2014-07-11 16:49:05 -0400] doug2: paulmooring: i'd bet $2.56 undocumented
[2014-07-11 16:49:39 -0400] paulmooring: https://github.com/opscode-cookbooks/chef-vault/tree/master/test/fixtures/cookbooks
[2014-07-11 16:49:44 -0400] paulmooring: doug2 perhaps
[2014-07-11 16:50:15 -0400] jtimberman: doug2: 'test' is a convention i use in cookbooks where i have a "test cookbook" that is responsible for taking care of things that aren't the responsibility of the cookbook being tested.
[2014-07-11 16:50:44 -0400] jtimberman: https://github.com/opscode-cookbooks/chef-splunk/blob/master/test/fixtures/cookbooks/test/recipes/default.rb
[2014-07-11 16:51:03 -0400] jtimberman: to me it's clear that "test" is a cookbook for testing and shouldn't be used in The Real World(tm)
[2014-07-11 16:51:45 -0400] jtimberman: the dev_mode attribute is documented in the chef-vault cookbook tho https://github.com/opscode-cookbooks/chef-vault#attributes
[2014-07-11 16:51:52 -0400] doug2: jtimberman: Sure, but how does one know that test refers to https://github.com/opscode-cookbooks/chef-splunk/blob/master/test/fixtures/cookbooks/test/recipes/default.rb ?
[2014-07-11 16:54:08 -0400] jtimberman: doug2: its a thing you have to "know" about working with the "modern" cookbook development workflow we're doing with test kitchen. the cookbook at the top level has a Berksfile that points at the test cookbook in the fixtures directory
[2014-07-11 16:57:01 -0400] doug2: jtimberman: how would one acquire that knowledge?
[2014-07-11 16:58:03 -0400] gkra: anyone using the environment cookbook pattern for their applications? (http://blog.vialstudios.com/the-environment-cookbook-pattern/)
[2014-07-11 17:03:48 -0400] hypnosb: i have many web servers in a cluster that I'm trying to streamline development and deployment,  can use chef for this or do I need something like capistrano?
[2014-07-11 17:04:00 -0400] hypnosb: where is the divide?
[2014-07-11 17:04:08 -0400] hamush: does anyone know how to change the run_list with chef_shell... i'm just trying to test my recipes in a vagrant box, i'm having trouble finding documentation on how to do this
[2014-07-11 17:05:48 -0400] sp206: gkra: I'm somewhat new to chef, but I really like the ideas in that article. thanks for sharing
[2014-07-11 17:06:03 -0400] jeffbyrnes: hypnosb: for app deployment, you'd probably want to use Cap. It's truly meant to be used in that fashion. You _could_ do it with Chef, but it can be a bit awkward
[2014-07-11 17:06:18 -0400] jeffbyrnes: more meant for config mgmt. of your server, than shipping a release of your app(s)
[2014-07-11 17:07:35 -0400] hypnosb: k
[2014-07-11 17:07:36 -0400] lamont_oc: hamush:  you probably dont want to use chef-shell?   try chef-client -z?  https://gist.github.com/lamont-granquist/b559886607a72515f262
[2014-07-11 17:08:00 -0400] hypnosb: jeffbyrnes, I'm thinking of a scaling scenario so maybe a cookbook that bootstraps and invokes capistrano for deployment?
[2014-07-11 17:08:43 -0400] jeffbyrnes: hypnosb that's a great way to separate the concerns
[2014-07-11 17:09:00 -0400] hypnosb: cool :D
[2014-07-11 17:09:03 -0400] hamush: lamont_oc: well, my end goal is to figure out why chef-solo-search doesn't work for me... i'm hoping that by poking around in chef-shell the answer will become apparent, but i'm having trouble getting recipes to run because they all complain they aren't in the run_list
[2014-07-11 17:09:15 -0400] hamush: not sure how to change that
[2014-07-11 17:09:18 -0400] jeffbyrnes: you retain the flexibility each solution offers, playing to their strengths
[2014-07-11 17:11:05 -0400] doug2: i lost it on the scroll.... chef-vault work with vagrant?
[2014-07-11 17:13:24 -0400] shin_: is this a good way to find all nodes? chefNodes = search(:node, "*:*")
[2014-07-11 17:13:49 -0400] shin_: i feel like maybe I should be doing this instead: chefNodes = search(:node, "name:*")
[2014-07-11 17:18:48 -0400] doug2: Grrrr "cme/awscreds is not encrypted with your public key.  Contact an administrator of the vault item to encrypt for you!"
[2014-07-11 17:19:58 -0400] JoshZ_: jkeiser: any info on the auto_batch_machines = false?
[2014-07-11 17:20:41 -0400] jkeiser: JoshZ_: sorry, haven't seen the question yet?
[2014-07-11 17:20:44 -0400] jkeiser: Is it not working?
[2014-07-11 17:20:52 -0400] JoshZ_: not in my recipes.
[2014-07-11 17:21:04 -0400] JoshZ_: I sent you an email on tuesday evening about it.
[2014-07-11 17:21:14 -0400] JoshZ_: I wondered if you changed it?
[2014-07-11 17:21:22 -0400] hypnosb: how can i install a specific version of a cookbook from site install? one cookbook seems to depend on a specific version
[2014-07-11 17:21:51 -0400] jkeiser: JoshZ_: I've been a littl neglectful of email a few days.  I think you need to say auto_batch_machines false (no =)
[2014-07-11 17:21:55 -0400] jkeiser: from reading the code
[2014-07-11 17:22:36 -0400] JoshZ_: also something else that I think is weird is if you have a machine_batch with a few machines in it and then you end that batch, then you have a machine, then some more batches it runs the middle machine with the first batch...
[2014-07-11 17:22:38 -0400] doug2: ok i must be missing something with chef-vault "is not encrypted with your public key"
[2014-07-11 17:22:40 -0400] JoshZ_: oh... let me try that.
[2014-07-11 17:25:08 -0400] lamont_oc: hamush: chef-client -z is a much better solution than chef-solo-search
[2014-07-11 17:25:51 -0400] lamont_oc: search just works in chef-zero because you use exactly the same search code and converge against a chef-zero server
[2014-07-11 17:26:21 -0400] kshep: Anybody have any tshooting tips for "Waiting for sshd" hanging during knife ec2 server create? It been a few weeks since I've had to create an instance...
[2014-07-11 17:26:26 -0400] JoshZ_: I am starting to love -z more than test kitchen even. it seems like it is easier for testing when you use searches etc in your recipe...
[2014-07-11 17:27:03 -0400] tequilarista: kshep: yes, that was killing me recently
[2014-07-11 17:27:06 -0400] tequilarista: us-west-1 region
[2014-07-11 17:27:44 -0400] kshep: I'm us-west-2
[2014-07-11 17:27:59 -0400] kshep: I can ssh to the machine... but knife is just sitting there
[2014-07-11 17:28:06 -0400] kshep: oh... I think I know....
[2014-07-11 17:29:31 -0400] x0nic: Is anyone else having problems with Bershelf 2 downloading cookbooks?
[2014-07-11 17:30:59 -0400] kshep: tequilarista: how'd you fix it? :-D
[2014-07-11 17:31:21 -0400] doug2: Why is chef-vault giving me "cme/awscreds is not encrypted with your public key.  Contact an administrator of the vault item to encrypt for you!" ?
[2014-07-11 17:31:22 -0400] tequilarista: like you discovered that the instance was actually running, so terminated the knife command
[2014-07-11 17:31:27 -0400] tequilarista: then ran the bootstrap separately
[2014-07-11 17:31:37 -0400] tequilarista: that worked for what I needed, didn't have time to go back and dig further on WTF happened
[2014-07-11 17:32:10 -0400] kshep: don't spoze you have a link to which FM I should R do you? re bootstrapping?
[2014-07-11 17:32:19 -0400] tequilarista: knife bootstrap
[2014-07-11 17:32:22 -0400] tequilarista: one sec
[2014-07-11 17:32:35 -0400] kshep: oh...
[2014-07-11 17:32:37 -0400] tequilarista: http://docs.opscode.com/knife_bootstrap.html
[2014-07-11 17:32:44 -0400] kshep: cool. duh. thanks :-)
[2014-07-11 17:32:45 -0400] tequilarista: you just tell it the IP of the instance
[2014-07-11 17:32:48 -0400] tequilarista: sure
[2014-07-11 17:32:50 -0400] tequilarista: "good luck"
[2014-07-11 17:32:58 -0400] tequilarista: if you get more info, I'd love to hear about it
[2014-07-11 17:36:04 -0400] anthonyacquanita: kshep: knife bootstrap -G non_priv_user@1.1.1.1:33333 -N node.name -E QA node.ip -x root -A -r cb-base
[2014-07-11 17:36:24 -0400] anthonyacquanita: In case you need to bootstrap something behind a ssh jump box on a non starndard port with a non root user
[2014-07-11 17:36:34 -0400] anthonyacquanita: took me too long to figure that out not to share.
[2014-07-11 17:38:50 -0400] kshep: anthonyacquanita: thanks :-)
[2014-07-11 17:39:27 -0400] kshep: I think I got it with "bundle exec knife bootstrap 1.1.1.1 -i ~/.ssh/blah -N dev4 --sudo
[2014-07-11 17:39:42 -0400] kshep: although I'm sure something's broken, amiright?
[2014-07-11 17:40:47 -0400] doug2: Not my day... "undefined method `chef_gem'"
[2014-07-11 17:43:13 -0400] kshep: yup... forgot the -E
[2014-07-11 17:44:48 -0400] doug2: Not my day... "undefined method `chef_gem'"
[2014-07-11 17:53:36 -0400] bmurt: anyone using vagrant + chef and chef_json that references an external json file?
[2014-07-11 17:54:10 -0400] bmurt: looks like the snippet with some ruby in there isn't be populated and is getting written as a literal... not sure how to address that if possible
[2014-07-11 17:54:29 -0400] bmurt: "nodename": "rabbit@#{hostname(COMPONENTS[:app_mq1])}" becomes NODENAME=rabbit@#{hostname(COMPONENTS[:app_mq1])} in the config file written via chef
[2014-07-11 17:54:34 -0400] stormerider: where does the windows chef-client log to by default... the windows event log? c:/chef/log/ is empty.
[2014-07-11 17:58:30 -0400] doug2: Why does the vault examples say to reference data in the wrong way?
[2014-07-11 17:58:52 -0400] jespada: what should I use to check api berkshelf status end point, I used to check https://api.berkshelf.com/status
[2014-07-11 18:21:08 -0400] doug2: Need some vault help...
[2014-07-11 18:25:36 -0400] doug2: If I pull data form chef vault with vault = ChefVault::Item.load("cme", "awscreds") ... then, value = Skipping yum (3.2.2) (frozen)
[2014-07-11 18:25:37 -0400] doug2: data_bag_item["cme", "awscreds", {"id"=>"awscreds", "aws_access_key"=>"foo", "aws_secret_key"=>"bar"}]
[2014-07-11 18:25:46 -0400] hypnosb: ESPRESSO o_O
[2014-07-11 18:26:00 -0400] doug2: how the heck do I get the data out? vault[:aws_access_key] == nothing
[2014-07-11 18:30:10 -0400] hypnosb: that sucks, apache2 cookbook failed to install apache on ubuntu :|
[2014-07-11 18:30:20 -0400] sp206: Has anyone seen a cookbook for Resin? (http://caucho.com/products/resin/)
[2014-07-11 18:31:17 -0400] mivok: doug2, does it work with vault["aws_access_key"] instead? You might need to access it with a string rather than a symbol
[2014-07-11 18:31:22 -0400] rsavage_: sp206: write you own cookbook, it's not hard to do
[2014-07-11 18:31:56 -0400] sp206: rsavage_: that was the next plan, just thought I'd ask since I didn't see one in the supermarket
[2014-07-11 18:32:12 -0400] mivok: failing that, I'd try adding a 'log "Value is: #{vault}"' resource to see what exactly vault contains.
[2014-07-11 18:32:28 -0400] doug2: mivok: egads, aren't they the same thing?
[2014-07-11 18:33:03 -0400] hypnosb: what can I do? http://dpaste.com/1XM4SHE
[2014-07-11 18:33:19 -0400] doug2: mivok: logging vault.inspect gets me data_bag_item["cme", "awscreds", {"id"=>"awscreds", "aws_access_key"=>"xxx", "aws_secret_key"=>"xxx"}]
[2014-07-11 18:33:20 -0400] mivok: in many places in chef, yes, but that's because of some magic chef does to make it work. I don't think chef vault is using the same magic.
[2014-07-11 18:33:50 -0400] doug2: mivok: is there some magic to get stuff from a data_bag_item cuz vault[:aws_access_key] is unset.
[2014-07-11 18:33:56 -0400] doug2: i'll try a string
[2014-07-11 18:35:04 -0400] doug2: omg, i have to use 'aws_access_key' not :aws_access_key. Argh
[2014-07-11 18:38:32 -0400] hypnosb: :'(
[2014-07-11 18:39:17 -0400] hypnosb: this is probably some bs because of ubuntu 14.04
[2014-07-11 18:39:45 -0400] hypnosb: i should just use fedora... but I have to be careful, trying to to change too much at once :|
[2014-07-11 18:40:49 -0400] shlant: jkeiser: https://github.com/opscode/chef-metal/pull/103
[2014-07-11 18:41:20 -0400] shlant: tested working
[2014-07-11 18:41:22 -0400] jkeiser: shlant: thank you much :)  This is a frequently asked question
[2014-07-11 18:41:30 -0400] shlant: jkeiser: happy to help!
[2014-07-11 18:42:12 -0400] shlant: jkeiser: let me know if you want me to format those AWS options and throw them in the README
[2014-07-11 18:43:11 -0400] jkeiser: shlant: actually in those cases I think we should make a providers directory under https://github.com/opscode/chef-metal/tree/master/docs and create an aws.md there
[2014-07-11 18:43:23 -0400] jkeiser: No need to over-format, anything at all will be much better than what we have
[2014-07-11 18:43:37 -0400] jkeiser: Then we link to that from the README and from configuring.md
[2014-07-11 18:44:27 -0400] shlant: jkeiser: on it
[2014-07-11 18:44:41 -0400] jkeiser: shlant: <3
[2014-07-11 18:45:02 -0400] mivok: doug2: from what I can tell, accessing via :foo should work - I'm not entirely sure where it's breaking down. At least you have a workaround for now.
[2014-07-11 18:45:12 -0400] s1991: Hello can anyone suggest what's wrong in this code?
[2014-07-11 18:45:33 -0400] s1991: its a code to activate virtualenv
[2014-07-11 18:46:29 -0400] doug2: mivok: 'foo' fine with me, just adds to my dislike of ruby. :)
[2014-07-11 18:46:42 -0400] s1991: lamont_oc: ^^
[2014-07-11 18:46:49 -0400] shlant: jkeiser: what happens if a machine chef run fails? Do I have to delete and recreate? or can I just run the same metal code?
[2014-07-11 18:47:17 -0400] jkeiser: shlant: you can just re-run.  If it's the first boot, it will re-converge
[2014-07-11 18:47:25 -0400] shlant: jkeiser: beauty
[2014-07-11 18:47:27 -0400] jkeiser: shlant: because it knows that a chef-client run has never succeeded
[2014-07-11 18:47:48 -0400] mivok: ruby normally only allows one or the other form, but chef creates a type called a mash which lets you use either and treats them as the same. Unfortunately it doesn't seem to be being used when you load things via chef-vault.
[2014-07-11 18:48:09 -0400] jkeiser: shlant: it can't *always* detect that a previous run failed though--for example, if you add a new cookbook to the runlist and that fails, it has no way to know that that cookbook has never run successfully so it won't automagically reconverge
[2014-07-11 18:48:24 -0400] jkeiser: shlant: i.e. if it already succeeded once and then starts failing with a new cookbook
[2014-07-11 18:48:37 -0400] jkeiser: shlant: but, you can always add converge true to the machine resource to force a converge
[2014-07-11 18:48:38 -0400] s1991: cheeseplus: can you help me!
[2014-07-11 18:48:51 -0400] jkeiser: shlant: this is idempotence!
[2014-07-11 18:49:47 -0400] shlant: jkeiser: praise!
[2014-07-11 18:51:01 -0400] cheeseplus: s1991: I may or may not be able to help but posting a gist/pastebin would be a good start
[2014-07-11 18:51:27 -0400] s1991: I already have above ^
[2014-07-11 18:51:56 -0400] s1991: cheeseplus: sorry http://pastebin.com/DjqrW01A
[2014-07-11 18:56:20 -0400] cheeseplus: s1991: do you also have the error you get trying to run that?
[2014-07-11 18:57:17 -0400] mivok: s1991: it looks like you're trying to execute python code with the bash interpreter
[2014-07-11 18:57:25 -0400] cheeseplus: a quick look seems like you're yea what mivok said
[2014-07-11 18:58:02 -0400] s1991: mean if I try putting python there it should work
[2014-07-11 18:58:50 -0400] cheeseplus: well if you're calling the bash interpreter you'll need to feed it bash
[2014-07-11 18:59:16 -0400] stormerider: hm. is there a reason that uninstalling the windows chef package does not remove the chef-client windows service?
[2014-07-11 19:00:21 -0400] cheeseplus: s1991: http://docs.opscode.com/resource_python.html
[2014-07-11 19:01:25 -0400] s1991: ok
[2014-07-11 19:30:23 -0400] doug2: chef-vault ... what happens if I add the data bag when they are no nodes?!
[2014-07-11 19:40:51 -0400] mivok: doug2: as long as you add admins and/or a search, you can update it to add nodes later. The most recent version of chef-vault has a knife vault refresh command that lets you re-run the search query.
[2014-07-11 19:43:20 -0400] hypnosb: hey the official apache2 book is failing on me... what can I do? http://dpaste.com/1XM4SHE
[2014-07-11 19:44:24 -0400] n1ko: the cookbook isn't failing you, its your package manager that has its pants in bunch
[2014-07-11 19:44:48 -0400] n1ko: do as the error message suggest and try again, or just wipe the box since something already went wrong
[2014-07-11 19:48:57 -0400] cheeseplus: hypnosb: your apt-cache is likely not up to date
[2014-07-11 19:49:49 -0400] cheeseplus: hypnosb: can use this cookbook to help with that https://github.com/opscode-cookbooks/apt
[2014-07-11 19:57:21 -0400] someara: hypnosb that cookbook does not yet support ubuntu-14.04 / apache2.4
[2014-07-11 20:02:10 -0400] hypnosb: Blarg :(
[2014-07-11 20:04:09 -0400] Damm: that's gotta suck someara
[2014-07-11 20:04:16 -0400] Damm: the 2.2 to 2.4 switch really messed with me
[2014-07-11 20:04:31 -0400] someara: yea... I'm working on an httpd cookbook from the ground up
[2014-07-11 20:04:34 -0400] someara: but its not done yet
[2014-07-11 20:04:46 -0400] someara: the new apache2 maintainers have a fork somewhere
[2014-07-11 20:16:15 -0400] icarus: is there a method to set an environment for nodes using knife rather than knife edit and not upon bootstrap?
[2014-07-11 20:16:19 -0400] icarus: (via cli)
[2014-07-11 20:16:45 -0400] coderanger: icarus: Not sure what you mean
[2014-07-11 20:17:52 -0400] icarus: such as knife node run_list NODENAME 'role:blah'
[2014-07-11 20:17:58 -0400] icarus: can the same be done for environment?
[2014-07-11 20:18:08 -0400] coderanger: icarus: Not yet, it is being added in 11.14
[2014-07-11 20:18:15 -0400] coderanger: https://github.com/opscode/chef/blob/11.14.0.rc.2/RELEASE_NOTES.md#new-knife-command-knife-node-environment-set
[2014-07-11 20:18:21 -0400] coderanger: icarus: You can do it via knife exec though
[2014-07-11 20:18:25 -0400] coderanger: it just isn't as pretty
[2014-07-11 20:18:40 -0400] icarus: coderanger: cool, good to know
[2014-07-11 20:18:45 -0400] icarus: ill check out the exec method
[2014-07-11 20:19:26 -0400] coderanger: knife exec -E 'n = api.get("/nodes/NAME"); n.chef_environment = "blah"; api.post("/nodes/NAME", n)'
[2014-07-11 20:19:27 -0400] coderanger: or similar
[2014-07-11 20:21:22 -0400] coderanger: make that api.put
[2014-07-11 20:22:15 -0400] gondoi: is there any concern of freely swapping out symbols for strings sprinkled throughout recipes?
[2014-07-11 20:22:32 -0400] gondoi: for example... `notifies 'restart'` vs `notifies :restart` ?
[2014-07-11 20:22:50 -0400] gondoi: or `action %w(enable start)`
[2014-07-11 20:23:05 -0400] icarus: coderanger: beautiful
[2014-07-11 20:23:14 -0400] x0nic: Is anyone else having problems with Bershelf 2 downloading cookbooks?
[2014-07-11 20:23:26 -0400] coderanger: gondoi: In most cases, it should be fine
[2014-07-11 20:24:03 -0400] gondoi: in most cases... that's what I'm worried about :D
[2014-07-11 20:24:32 -0400] gondoi: is it chef taking care of the conversion automagically, or is ruby overall friendly to the interchange?
[2014-07-11 20:25:03 -0400] icarus: coderanger: for i in $(<prod.txt); do knife exec -E 'n = api.get("/nodes/$i"); n.chef_environment = "production"; api.put("/nodes/$i",n)' ; done
[2014-07-11 20:25:06 -0400] icarus: :)
[2014-07-11 20:25:14 -0400] icarus: that takes care of that
[2014-07-11 20:25:26 -0400] icarus: i had to do that for dozens of servers
[2014-07-11 20:25:34 -0400] coderanger: gondoi: with actions, it is because it gets used in a string like "action_#{x}", and :foo.to_s == "foo"
[2014-07-11 20:25:52 -0400] coderanger: icarus: Heh, that works
[2014-07-11 20:26:28 -0400] coderanger: gondoi: And with anything related to attributes it is because Mash explicitly casts everything
[2014-07-11 20:27:33 -0400] Shin-Chain: While installing cookbook on server through 'knife' I am facing issue "Converging 0 resources", any ideas what is missed.
[2014-07-11 20:28:34 -0400] coderanger: Shin-Chain: What command are you running?
[2014-07-11 20:29:26 -0400] Shin-Chain: knife bootstrap HOSTIP --ssh-user root --ssh-password "Password" --ssh-port 22 --run-list "recipe[name]"
[2014-07-11 20:33:14 -0400] coderanger: Shin-Chain: Do you see it running that recipe at the top of the chef-client output?
[2014-07-11 20:37:58 -0400] Shin-Chain: here is the exect output that I gat :
[2014-07-11 20:37:59 -0400] Shin-Chain: --------------
[2014-07-11 20:37:59 -0400] Shin-Chain: Starting Chef Client, version 11.12.8  resolving cookbooks for run list: ["name"]
[2014-07-11 20:38:00 -0400] Shin-Chain: Synchronizing Cookbooks:- name
[2014-07-11 20:38:00 -0400] Shin-Chain: Compiling Cookbooks...
[2014-07-11 20:38:00 -0400] Shin-Chain: Converging 0 resources
[2014-07-11 20:38:01 -0400] Shin-Chain: Running handlers:
[2014-07-11 20:38:04 -0400] Shin-Chain: Running handlers complete
[2014-07-11 20:38:06 -0400] Shin-Chain: Chef Client finished, 0/0 resources updated in 6.239790443 seconds
[2014-07-11 20:38:08 -0400] Shin-Chain: ------------------------
[2014-07-11 20:43:24 -0400] Shin-Chain: hi. can I get a cloak plz.
[2014-07-11 20:44:14 -0400] coderanger: Shin-Chain: 1) please use a pastebin for pasting output 2) cloaks are managed by freenode staff
[2014-07-11 20:44:46 -0400] coderanger: and that looks like your run list isn't being set correctly
[2014-07-11 20:45:39 -0400] Shin-Chain: Thanks for your help, will check runlist.
[2014-07-11 20:45:44 -0400] icarus: coderanger: that actually didn't work because of how bash shell interprets the variable/syntax
[2014-07-11 20:46:19 -0400] coderanger: icarus: What programming language are you most familiar with?
[2014-07-11 20:46:21 -0400] icarus: but: irb >>> for i in prod_list do `knife exec -E 'n = api.get("/nodes/#{i}"); n.chef_environment = "production"; api.put("/nodes/#{i}",n)'` end
[2014-07-11 20:47:12 -0400] icarus: f = File.open("prod.txt")
[2014-07-11 20:47:15 -0400] icarus: prod_list = f.read.split("\n")
[2014-07-11 20:47:30 -0400] icarus: pretty neat stuff to use irb for
[2014-07-11 20:48:47 -0400] coderanger: yahr, and rather than shelling out to knife you could just use chef-api directly
[2014-07-11 21:01:48 -0400] mallu: hi, if I a wrapper cookcook and I want to override some of the attributes, how do I do that? The attributes on wrapper cookbook is not setting
[2014-07-11 21:03:54 -0400] mallu: anyone?
[2014-07-11 21:04:41 -0400] shanlar: override['some']['attribute'] = 'new'
[2014-07-11 21:05:11 -0400] davidordave: the wrapper should take precedence even at default. (Unless it is array, in which case it will get merged if they have the same precedence.)
[2014-07-11 21:06:48 -0400] icarus: coderanger: ill have to look into the api a little more
[2014-07-11 21:06:57 -0400] icarus: i can see now that knife is merely a front end for the chef api
[2014-07-11 21:07:16 -0400] coderanger: icarus: Yep, most commands are very simple wrappers
[2014-07-11 21:07:38 -0400] mallu: I thought the wrapper would have precidence but it is not in my case
[2014-07-11 21:07:43 -0400] icarus: coderanger: https://www.youtube.com/watch?v=55W3CXfqLIY
[2014-07-11 21:09:58 -0400] coderanger: mallu: Make sure things are running in the order you expect
[2014-07-11 21:10:08 -0400] coderanger: mallu: Attribute files are run in a topographic sort order
[2014-07-11 21:11:51 -0400] mallu: coderanger: is there anyway I can see which attribtes are getting set?
[2014-07-11 21:12:08 -0400] coderanger: mallu: Whatever attributes you tell it to?
[2014-07-11 21:12:15 -0400] coderanger: mallu: Can you pastebin the code?
[2014-07-11 21:12:17 -0400] anthonyacquanita: checkout_branch  doesn't that change the name of the checked out branch?
[2014-07-11 21:12:27 -0400] anthonyacquanita: getting undefined method
[2014-07-11 21:12:29 -0400] coderanger: anthonyacquanita: ?
[2014-07-11 21:12:36 -0400] coderanger: in the git resource you mean?
[2014-07-11 21:12:50 -0400] anthonyacquanita: yes
[2014-07-11 21:12:54 -0400] coderanger: anthonyacquanita: What version of Chef? That was added recently
[2014-07-11 21:13:19 -0400] anthonyacquanita: shit.. 11.8.2
[2014-07-11 21:13:20 -0400] hypnosb: i run gem install knife-ec2 (installs fine) .... run knife ec2 server list.. says gem is not installed ? wth...
[2014-07-11 21:13:31 -0400] anthonyacquanita: ;-)
[2014-07-11 21:13:36 -0400] coderanger: anthonyacquanita: sadtrombone
[2014-07-11 21:13:46 -0400] anthonyacquanita: ha ha! doh!
[2014-07-11 21:13:55 -0400] coderanger: hypnosb: Are you using omnibus chef and/or chefdk?
[2014-07-11 21:14:23 -0400] hypnosb: coderanger,  I believe chefdk ...
[2014-07-11 21:14:33 -0400] coderanger: hypnosb: run `chef gem install knife-ec2`
[2014-07-11 21:14:34 -0400] hypnosb: i downloaded it for osx
[2014-07-11 21:14:57 -0400] coderanger: hypnosb: It has its own internal Ruby and gem, whereas `gem install` is likely using the system ruby
[2014-07-11 21:16:10 -0400] hypnosb: i am using rvm ... but i know what ur saying the ... ruby in /opt
[2014-07-11 21:16:13 -0400] shlant: jkeiser: my previous PR is in this branch for some reason but I don't want to fight with git anymore: https://github.com/opscode/chef-metal/pull/104
[2014-07-11 21:21:03 -0400] anthonyacquanita: anyway to change the remote name after a checkout from git@github to a https on?
[2014-07-11 21:21:25 -0400] anthonyacquanita: git remote add  "https://"  not a valid remote name
[2014-07-11 21:23:21 -0400] shlant: anthonyacquanita: checkout_branch means the branch you want to checkout after cloning (git checkout blah)
[2014-07-11 21:23:52 -0400] anthonyacquanita: got all that but I use a ssh key and SSH clone path
[2014-07-11 21:24:09 -0400] anthonyacquanita: I now want to change that to a https one so other DEV's without keys and push stuf
[2014-07-11 21:25:07 -0400] Alayde: I feel like I might be missing something. Besides using an execute block, is there anyway to chown a bunch of already existing files in a directory?
[2014-07-11 21:25:36 -0400] shanlar: is it possible to access the name attribute of a resource?
[2014-07-11 21:25:59 -0400] shanlar: i want to pass the name of the resource block to the notifies
[2014-07-11 21:26:25 -0400] shanlar: Alayde: not unless you are managing those files already through Chef
[2014-07-11 21:28:00 -0400] coderanger: anthonyacquanita: remote name?
[2014-07-11 21:28:06 -0400] coderanger: anthonyacquanita: You mean make it something not origin?
[2014-07-11 21:28:19 -0400] Alayde: shanlar: that's kind of what I thought. Thanks a bunch
[2014-07-11 21:28:32 -0400] coderanger: shanlar: yes, notifies :restart, "service[#{name}]"
[2014-07-11 21:28:40 -0400] shanlar: ty
[2014-07-11 21:28:56 -0400] coderanger: Alayde: You can use a file resource and some code
[2014-07-11 21:28:58 -0400] anthonyacquanita: I checked it out with export, then the DEV's said "We need to edit on the box" so I changed it to sync
[2014-07-11 21:29:13 -0400] coderanger: Alayde: Dir['/path/*'].each do |path| file path; mode whatever; end end
[2014-07-11 21:29:32 -0400] anthonyacquanita: change the deploy checked out name, great.  Had to add a bash execute and trigger to change the git config from SSH to HTTPS
[2014-07-11 21:30:02 -0400] coderanger: anthonyacquanita: I take it "fuck you and the horse you rode in on" isn't a viable response?
[2014-07-11 21:30:13 -0400] Alayde: coderanger: Ah, I like it. cool, thanks
[2014-07-11 21:31:41 -0400] anthonyacquanita: picking my battles!
[2014-07-11 21:31:57 -0400] anthonyacquanita: and losing a lot of them
[2014-07-11 21:33:22 -0400] Eulipion: thats when u hijack their ssh session and start messing with them
[2014-07-11 22:02:38 -0400] shanlar: is it possible in the resource file for a lwrp, to populate an attribs default value by using the name attrib? something like this https://gist.github.com/chasebolt/4416447ae0d3815f1dea
[2014-07-11 22:08:56 -0400] coderanger: shanlar: Not directly, you can either do it the old fashioned way or use Poise
[2014-07-11 22:09:14 -0400] coderanger: shanlar: With poise, :default => lazy { "/home/" + :username }
[2014-07-11 22:09:57 -0400] shanlar: what is the old fashioned way?
[2014-07-11 22:10:27 -0400] shanlar: ill look into poise
[2014-07-11 22:10:30 -0400] jordane: shanlar: a regular heavyweight resource
[2014-07-11 22:10:36 -0400] shanlar: ahh
[2014-07-11 22:10:38 -0400] coderanger: shanlar: def home(val=nil); set_or_return(:home, val, :kind_of => String, :default => "/home/" + username)
[2014-07-11 22:10:45 -0400] coderanger: jordane: You can mix-n-match a bit
[2014-07-11 22:10:54 -0400] jordane: coderanger: yeah, I should have been more specific.
[2014-07-11 22:11:07 -0400] coderanger: jordane: You can just define that one getter the long way :)
[2014-07-11 22:11:31 -0400] jordane: coderanger: hmm, good to know
[2014-07-11 22:11:33 -0400] jordane: thanks :)
[2014-07-11 22:24:23 -0400] diegows: knife boostrap install chef fine... but... is it supposed to staart and setup init scripts too?
[2014-07-11 22:24:34 -0400] diegows: because if the answer is no.... it's useless
[2014-07-11 22:26:14 -0400] jordane: diegows: you want a bootstrap template, see http://docs.opscode.com/knife_bootstrap.html#custom-templates
[2014-07-11 22:28:33 -0400] coderanger: diegows: No
[2014-07-11 22:28:43 -0400] coderanger: diegows: You can use the chef-client cookbook to configure it as a service
[2014-07-11 22:29:21 -0400] diegows: coderanger, yse... I was thinking about that workaround... but it's ridiculous
[2014-07-11 22:29:32 -0400] shlant: anyone familiar with the AWS EC2 API?
[2014-07-11 22:29:34 -0400] coderanger: diegows: Thats not a "work around", thats the correct way do it
[2014-07-11 22:29:40 -0400] coderanger: shlant: What part of it
[2014-07-11 22:29:40 -0400] shlant: I don't know what value iam_instance_profile wants
[2014-07-11 22:29:52 -0400] coderanger: shlant: it should be a profile ID
[2014-07-11 22:30:01 -0400] coderanger: shlant: profiles are generally 1-to-1 with roles
[2014-07-11 22:30:16 -0400] diegows: coderanger, in my opinion, installer or knife should do it for you
[2014-07-11 22:30:40 -0400] coderanger: diegows: Sorry, but that would be incorrect, 1) service configs are highly varied 2) not everyone uses it as a service at all
[2014-07-11 22:30:41 -0400] shlant: coderanger: I tried InstanceProfileId, "Name=role", just "role"
[2014-07-11 22:30:57 -0400] shlant: coderanger: maybe RoleId?
[2014-07-11 22:30:58 -0400] coderanger: diegows: And when you have a complex thing to configure, it turns out chef is pretty good at that :)
[2014-07-11 22:31:07 -0400] diegows: an options at least
[2014-07-11 22:31:16 -0400] Eulipion: it is, RTFM
[2014-07-11 22:31:24 -0400] diegows: ?
[2014-07-11 22:31:37 -0400] Eulipion: read the chef-client readme, read-the-fucking-manual
[2014-07-11 22:31:42 -0400] Eulipion: rtfm
[2014-07-11 22:31:51 -0400] diegows: I'm reading the manuals, don't worry
[2014-07-11 22:31:55 -0400] Eulipion: heh
[2014-07-11 22:32:08 -0400] coderanger: shlant: Not sure what you mean, it needs to be an ARN for an instance profile object which you need to create yourself
[2014-07-11 22:32:23 -0400] shlant: ah
[2014-07-11 22:32:26 -0400] shlant: I'll try the ARN
[2014-07-11 22:32:33 -0400] coderanger: Eulipion: Please keep things friendly
[2014-07-11 22:32:39 -0400] Eulipion: heh, k
[2014-07-11 22:32:47 -0400] coderanger: shlant: Make sure it isn't the ARN for the Role :)
[2014-07-11 22:33:01 -0400] coderanger: shlant: profiles are basically a join table
[2014-07-11 22:33:28 -0400] shlant: coderanger: looks like this? arn:aws:iam::<account#>:instance-profile/aws-chef-role
[2014-07-11 22:34:10 -0400] coderanger: shlant: If thats what you named it, sure, the profile and role don't have to have the same name I think
[2014-07-11 22:35:54 -0400] sp206: related question: any thoughts on why my curl http://bucketname.s3.amazonaws.com/client.rb is getting a TemporaryRedirect? This may be more of an AWS question
[2014-07-11 22:36:02 -0400] sp206: this is my IAM role: http://pastebin.com/6SZDv3G5
[2014-07-11 22:36:33 -0400] coderanger: sp206: Whats the redirect to?
[2014-07-11 22:36:58 -0400] sp206: coderanger: "Please re-send this request to the specified temporary endpoint. Continue to use the original request endpoint for future requests."
[2014-07-11 22:37:25 -0400] coderanger: sp206: Is it the same URI in a different region?
[2014-07-11 22:37:36 -0400] coderanger: That can happen if the bucket wasn't created in east1
[2014-07-11 22:38:05 -0400] sp206: coderanger: both my instance and bucket are in the us-west-2 region
[2014-07-11 22:38:36 -0400] coderanger: Then you need to use a west2 URI
[2014-07-11 22:38:45 -0400] coderanger: s3.amazonaws.com == east1
[2014-07-11 22:38:59 -0400] sp206: coderanger: blast!
[2014-07-11 22:39:04 -0400] coderanger: You want s3-us-west-2.amazonaws.com
[2014-07-11 22:39:14 -0400] sp206: i suppose had I looked at the properties of that file it would've become more apparent
[2014-07-11 22:39:17 -0400] sp206: thank you
[2014-07-11 22:39:24 -0400] coderanger: The docs aren't super clear on this because non-east1 buckets are so rare
[2014-07-11 22:40:02 -0400] sp206: yeah, our development environment is in us-west-2, as it's closer to us. production is going to be elsewhere
[2014-07-11 22:40:04 -0400] sp206: thanks again
[2014-07-11 22:44:02 -0400] coderanger: sp206: You can always use the full name btw, s3. == s3-us-east-1.
[2014-07-11 22:49:57 -0400] shlant: coderanger: just tried :iam_instance_profile => "Arn=arn:aws:iam::<account>:instance-profile/aws-chef-role" with no luck.
[2014-07-11 22:50:05 -0400] shlant: here is the output from instance profile list:
[2014-07-11 22:50:15 -0400] shlant: http://pastebin.com/hCGKD2XB
[2014-07-11 22:50:26 -0400] shlant: what do I need to be using?
[2014-07-11 22:50:58 -0400] Eulipion: is there anything that needs to be added to the application lwrp to setup unicorn for rails besides just specifying rails and unicorn?  it seems to be skipping the unicorn part
[2014-07-11 22:52:04 -0400] shlant: Eulipion: what does you resource block look like?
[2014-07-11 22:52:36 -0400] Eulipion: http://pastebin.com/4qFHTaaF
[2014-07-11 22:54:25 -0400] shlant: Eulipion: can you try without bundler true?
[2014-07-11 22:55:09 -0400] coderanger: shlant: Is this with fog or something?
[2014-07-11 22:55:21 -0400] coderanger: shlant: because thats not a normal style that I know in the API
[2014-07-11 22:55:28 -0400] shlant: coderanger: yessir
[2014-07-11 22:55:32 -0400] shlant: chef-mteal
[2014-07-11 22:55:35 -0400] shlant: metal
[2014-07-11 22:55:57 -0400] coderanger: shlant: Hmm, have to go look at how fog passes through those arguments
[2014-07-11 22:56:09 -0400] coderanger: can I just take a moment to complain about how terrible fog's docs are?
[2014-07-11 22:56:21 -0400] shlant: coderanger: here here
[2014-07-11 22:56:32 -0400] jkeiser: we're all on board there :)
[2014-07-11 22:56:33 -0400] shlant: that's why I am contributing to the metal docs
[2014-07-11 22:56:41 -0400] shlant: for knowledge is power
[2014-07-11 22:57:48 -0400] Eulipion: shlant: i guess its installing the unicorn gem, where i was expecting the package.  either way its not starting it up
[2014-07-11 22:58:18 -0400] shlant: Eulipion: yea I'm still fiddling with it to get runit going properly
[2014-07-11 22:58:26 -0400] coderanger: shlant: Here we go
[2014-07-11 22:58:28 -0400] coderanger: shlant: https://github.com/fog/fog/blob/245fdaa3e712be1efb5cae5cde44fa04f87337a3/lib/fog/aws/models/compute/server.rb#L57
[2014-07-11 22:58:37 -0400] coderanger: shlant: so set iam_instance_profile_arn instead
[2014-07-11 22:58:41 -0400] shlant: ah
[2014-07-11 22:58:44 -0400] shlant: nice catch!
[2014-07-11 22:58:46 -0400] Eulipion: shlant: im not a rails guy, i was hoping it worked in a similar way to django
[2014-07-11 22:58:49 -0400] shlant: I will add to the docs
[2014-07-11 22:59:05 -0400] coderanger: shlant: Looks like iam_instance_profile is just for reading on an existing instance
[2014-07-11 22:59:21 -0400] coderanger: shlant: also looks like runinstances supports the name too, so you can skip the full arn
[2014-07-11 23:00:04 -0400] shlant: coderanger: that makes my life easier. Thanks
[2014-07-11 23:00:34 -0400] coderanger: (just use _name instead of _arn)
[2014-07-11 23:04:07 -0400] coderanger: jkeiser: Whats the plan for feeding data from one piece of Metal infra to another?
[2014-07-11 23:04:20 -0400] coderanger: jkeiser: (a la CFN's Ref and GetData mechanism)
[2014-07-11 23:05:25 -0400] jkeiser: coderanger: I'm not sure.  Got a link?
[2014-07-11 23:05:51 -0400] Eulipion: shlant: looks like its supposed to be dropping configs in /etc/unicorn, but isnt
[2014-07-11 23:07:11 -0400] coderanger: jkeiser: I mean take for example creating one object that needs data from another object, like the subnet needing the VPC ID, or the instance needing the subnet ID
[2014-07-11 23:07:48 -0400] coderanger: jkeiser: CloudFormation and Heat allow back-references for this
[2014-07-11 23:07:58 -0400] shlant: Eulipion: weird. but it shows the unicorn gem being installed
[2014-07-11 23:07:59 -0400] shlant: ?
[2014-07-11 23:08:06 -0400] Eulipion: yup
[2014-07-11 23:08:13 -0400] jkeiser: coderanger: ah.  Right now the tentative plan is, if you are building them all in metal, you'll refer to them by the name you created them with
[2014-07-11 23:08:31 -0400] jkeiser: coderanger: (and if you are not, you will just pass the external VPC / subnet ID)
[2014-07-11 23:08:44 -0400] coderanger: jkeiser: A lot of the names are not under user control, in fact almost none in AWS are
[2014-07-11 23:09:25 -0400] coderanger: jkeiser: Example from cloudformation https://github.com/coderanger/brix/blob/master/templates/balanced_region.py#L117-L123
[2014-07-11 23:09:28 -0400] jkeiser: coderanger: yeah, super tentative plan there is to control the idempotence via nodes or data bags (frankly it's not fleshed out yet)--i.e. managed backreferences
[2014-07-11 23:10:03 -0400] coderanger: jkeiser: :-) Something to ponder when you get beyond just making VMs :)
[2014-07-11 23:10:36 -0400] jkeiser: coderanger: indeed!  idempotence is an issue we already ran into spitballing it.  There is essentially no way to store the idempotence data for these things in AWS, so we need to be able to manage them externally to know what they are
[2014-07-11 23:10:47 -0400] jkeiser: coderanger: thanks :)
[2014-07-11 23:11:04 -0400] coderanger: jkeiser: Yep, thats literally what CloudFormation is, it is the DB that provides idempotence
[2014-07-11 23:11:11 -0400] shlant: Eulipion: I was literally working on the same thing before getting addicted to chef-metal so i will let you know when I get back to troubleshooting unicorn
[2014-07-11 23:11:21 -0400] coderanger: jkeiser: (and as you would expect, if state changes that it doesn't know about, it breaks horribly) :-(
[2014-07-11 23:11:25 -0400] shlant: coderanger: worked! An it's off to the races:D
[2014-07-11 23:11:34 -0400] Eulipion: shlant: wiped out the dirs and re-ran chefclient, now it made the runit files, which have no variabled rendered in them, but at least thats a start
[2014-07-11 23:11:53 -0400] jkeiser: coderanger: I actually didn't realize, it is backed by a database?
[2014-07-11 23:12:06 -0400] shlant: Eulipion: yea, the unicorn stuff only happens when you have a deploy I think
[2014-07-11 23:12:10 -0400] Eulipion: shlant: yea, metal is high on my list once i get a bunch of stuff off my plate
[2014-07-11 23:12:19 -0400] Eulipion: and switching to berks
[2014-07-11 23:12:33 -0400] shlant: Eulipion: using librarian?
[2014-07-11 23:12:34 -0400] coderanger: jkeiser: Yes, cloudformation has its own state database, its one of its biggest problems because the DB is effectively beyond your reach of things break you can manually resync state
[2014-07-11 23:12:44 -0400] coderanger: er, can't
[2014-07-11 23:12:46 -0400] Eulipion: not yet
[2014-07-11 23:13:26 -0400] coderanger: jkeiser: Next weekend you and I should chat, I can give you the 15m version of cloudformation
[2014-07-11 23:13:34 -0400] jkeiser: coderanger: I would love that!
[2014-07-11 23:14:06 -0400] coderanger: rightscale does the same too, they keep idempotence via their own DB
[2014-07-11 23:14:28 -0400] coderanger: so you are at least not alone in thinking this is a Big Problem because cloud provider APIs all suck
[2014-07-11 23:14:37 -0400] jkeiser: so a problem comes when you try to share the data between systems of course
[2014-07-11 23:14:54 -0400] a13x212: hey count me in :) we are moving to aws in the near future
[2014-07-11 23:14:55 -0400] jkeiser: but since you can't infer what is what just by looking at AWS ... :/
[2014-07-11 23:15:12 -0400] jkeiser: I wonder if there are clever uses of tags that could bypass that
[2014-07-11 23:15:24 -0400] jkeiser: hehehe we could make a tiny EBS volume with a known name and store shit there
[2014-07-11 23:15:28 -0400] coderanger: jkeiser: You can't change tags on most objects types after creation
[2014-07-11 23:15:40 -0400] coderanger: jkeiser: (I tried doing the same thing in brix)
[2014-07-11 23:15:51 -0400] jkeiser: coderanger: oh, only instances?
[2014-07-11 23:16:01 -0400] coderanger: jkeiser: Yeah, tags on instances are a super special case
[2014-07-11 23:16:06 -0400] jkeiser: darn
[2014-07-11 23:16:33 -0400] coderanger: Also I don't think any other providers have anything similar to tags
[2014-07-11 23:16:39 -0400] coderanger: So lolllllll
[2014-07-11 23:17:58 -0400] coderanger: jkeiser: the instances API is simultaneously the most important for obvious reasons, and also the worst example since it is a special case for almost everything
[2014-07-11 23:20:06 -0400] Eulipion: shlant: any idea what smells_like_rack is?
[2014-07-11 23:21:05 -0400] shlant: Eulipion: I think it just checks if you are running rack or rails
[2014-07-11 23:21:17 -0400] squaresurf: How do I trim whitespace in my templates? For example: "   <%=var%>"
[2014-07-11 23:21:28 -0400] squaresurf: I don't want the leading whitespace.
[2014-07-11 23:21:28 -0400] Eulipion: my unicorn is undercooked
[2014-07-11 23:23:26 -0400] coderanger: squaresurf: So for <% %> directives you can use <%- -%> instead
[2014-07-11 23:23:35 -0400] squaresurf: Nice
[2014-07-11 23:23:36 -0400] coderanger: squaresurf: But for <%= you need to manage it yourself
[2014-07-11 23:23:40 -0400] squaresurf: I new it was something like that.
[2014-07-11 23:23:46 -0400] squaresurf: Ok
[2014-07-11 23:23:47 -0400] coderanger: squaresurf: Like <%= var.strip %>
[2014-07-11 23:23:56 -0400] squaresurf: Do I need <%= for the render method?
[2014-07-11 23:24:21 -0400] coderanger: squaresurf: <%= is for things that should be output <% is for things that are just structural
[2014-07-11 23:25:53 -0400] squaresurf: I want the render method output, so I need <%= right?
[2014-07-11 23:26:01 -0400] squaresurf: Just making sure I understand.
[2014-07-11 23:26:39 -0400] coderanger: Yes
[2014-07-11 23:26:48 -0400] squaresurf: Cool. Thanks.
[2014-07-11 23:26:59 -0400] coderanger: squaresurf: But you probably want to use <%- -%> in the sub-template
[2014-07-11 23:27:10 -0400] shlant: jkeiser: does the attribute attribute for machine pass any attribute? like blah['foo']['bar'] from a .each? or just node attributes?
[2014-07-11 23:27:14 -0400] coderanger: stuff like <%- @whatever.each do |foo| -%>
[2014-07-11 23:27:18 -0400] coderanger: and <%- end -%>
[2014-07-11 23:27:26 -0400] squaresurf: Ah ok.
[2014-07-11 23:27:29 -0400] squaresurf: That makes sense.
[2014-07-11 23:27:44 -0400] squaresurf: is <%- p render... -%> bad form?
[2014-07-11 23:28:12 -0400] coderanger: squaresurf: I'm not sure what that would mean
[2014-07-11 23:28:32 -0400] coderanger: squaresurf: it would render the sub-template and throw away the content
[2014-07-11 23:28:37 -0400] squaresurf: Ah
[2014-07-11 23:28:51 -0400] squaresurf: Wasn't sure if I could use puts or print in that.
[2014-07-11 23:28:57 -0400] squaresurf: I think I got it now.
[2014-07-11 23:28:58 -0400] coderanger: squaresurf: things like .each and if/else are very different since they have no output per se
[2014-07-11 23:31:03 -0400] jkeiser: shlant: I'm not entirely sure what you mean--I can say for sure that when you say attribute ['path', 'to', 'attribute'], 'value', that it is setting an attribute on the node
[2014-07-11 23:31:13 -0400] coderanger: squaresurf: If you tried to print inside a template I suspect it would just be like any other print and it would show up on the console :)
[2014-07-11 23:31:26 -0400] coderanger: squaresurf: It is possible Erubis monkey-patches things though
[2014-07-11 23:31:54 -0400] squaresurf: coderanger: I think I'll stick with <%= when I need to output something. Thank you for your help.
[2014-07-11 23:33:24 -0400] shlant: jkeiser: so if i had something like app_info['db']['name'], what would that look like?
[2014-07-11 23:33:44 -0400] jkeiser: shlant: what is app_info?  Like, where did you get that variable from?
[2014-07-11 23:34:12 -0400] shlant: It's the result of a .each from initial bootstrap json
[2014-07-11 23:34:27 -0400] shlant: .each |app, app_info|
[2014-07-11 23:34:49 -0400] shlant: or
[2014-07-11 23:34:55 -0400] shlant: maybe I should create a new attr
[2014-07-11 23:35:00 -0400] shlant: and pass that in as the value
[2014-07-11 23:39:53 -0400] kbarry: I'm trying to see the run-list from the node itself.
[2014-07-11 23:40:11 -0400] kbarry: Where would I find that information? The reason I ask is that my runlist appears to be running in the wrong order.
[2014-07-11 23:40:38 -0400] coderanger: kbarry: node.run_list is available, thats RunList object
[2014-07-11 23:40:53 -0400] coderanger: kbarry: node['roles'] and node['recipes'] show the expanded forms though
[2014-07-11 23:41:08 -0400] coderanger: kbarry: You can also see the run list and expanded run list at the top of the chef-client output
[2014-07-11 23:41:22 -0400] kbarry: So, this is a windows box.
[2014-07-11 23:41:27 -0400] kbarry: (incase this matters)_
[2014-07-11 23:41:49 -0400] doug2: What's my best way to get the aws cli onto an instance with chef?
[2014-07-11 23:42:04 -0400] coderanger: kbarry: Nope, all the same
[2014-07-11 23:42:13 -0400] stormerider: very odd, i've got a box that generates some long barfs in both chef-shell and chef-client like "ber_dump: buf=0x12df2a10 ptr=0x12df2a10 end=0x12df2a5c len=76" and then an OD and ASCII dump of what looks to be the LDAP config (can't paste that because it includes things like our LDAP client password)
[2014-07-11 23:42:49 -0400] coderanger: doug2: https://www.google.com/search?q=aws-cli+cookbook shows several exist
[2014-07-11 23:44:01 -0400] coderanger: doug2: I can't comment on any particular cookbook though
[2014-07-11 23:44:16 -0400] coderanger: stormerider: That sounds like its from openssl
[2014-07-11 23:44:41 -0400] coderanger: stormerider: or the ldap gem itself, those are the only two places I know that use ber
[2014-07-11 23:44:47 -0400] doug2: coderanger: it's a shame I don't get the same result from https://supermarket.getchef.com/cookbooks
[2014-07-11 23:45:07 -0400] stormerider: coderanger: any idea what would trigger that? it's a centos box
[2014-07-11 23:45:10 -0400] coderanger: doug2: Not touching that one with a ten foot pole
[2014-07-11 23:45:14 -0400] doug2: i never know how to tell if a cookbook that's on github is available via the API
[2014-07-11 23:45:20 -0400] stormerider: im thinking something ohai is probing, maybe?
[2014-07-11 23:45:28 -0400] coderanger: stormerider: Some kind of debug logging flag I'm guessing?
[2014-07-11 23:45:59 -0400] coderanger: stormerider: Does chef exist after that or does it continue?
[2014-07-11 23:46:03 -0400] coderanger: er, exit, not exist
[2014-07-11 23:46:07 -0400] stormerider: i dont have a log_level set in client.rb or anything like that.
[2014-07-11 23:46:09 -0400] stormerider: it continues
[2014-07-11 23:46:19 -0400] stormerider: just after a few pages of crap :)
[2014-07-11 23:46:24 -0400] coderanger: stormerider: Look in /etc/ldap* I would guess
[2014-07-11 23:46:38 -0400] coderanger: stormerider: Probably some system level flag from 1985 :)
[2014-07-11 23:46:56 -0400] coderanger: stormerider: What are you using LDAP for?
[2014-07-11 23:48:03 -0400] stormerider: so the only thing on that box in /etc related to ldap that i see is /etc/ldap.conf which is actually put there by chef as part of a cookbook_file resource, like every other centos node we have... we're using it to do UNIX auth onto the VMs via our AD credentials
[2014-07-11 23:48:07 -0400] shlant: jkeiser: just to confirm: if I did attribute ['db', 'name'], 'user1'
[2014-07-11 23:48:24 -0400] shlant: I could reference it on the machine with node['db']['username']?
[2014-07-11 23:48:38 -0400] shlant: ['db']['name']*
[2014-07-11 23:48:42 -0400] coderanger: stormerider: Does this persist through a reboot?
[2014-07-11 23:49:09 -0400] stormerider: coderanger: not sure, im not sure who uses this box so i dont want to blindly reboot it.
[2014-07-11 23:49:23 -0400] jkeiser: shlant: yep!
[2014-07-11 23:49:32 -0400] shlant: jkeiser: horray!
[2014-07-11 23:50:15 -0400] coderanger: stormerider: http://www.openldap.org/lists/openldap-software/200005/msg00156.html shows that ber_dump is defintely LDAP related
[2014-07-11 23:50:34 -0400] coderanger: stormerider: No idea how its ending up in the chef output though
[2014-07-11 23:50:45 -0400] coderanger: stormerider: Guessing its something PAM-ish
[2014-07-11 23:50:46 -0400] stormerider: coderanger: cool, thanks. i'll have to see if there's anything wonky with the ldap libs or such on the box.
[2014-07-11 23:50:46 -0400] shlant: jkeiser: and do I have to specify multiple attribute attributes?
[2014-07-11 23:50:47 -0400] shlant: like
[2014-07-11 23:50:51 -0400] coderanger: stormerider: Look in the PAM config too
[2014-07-11 23:50:56 -0400] stormerider: ooh, that's a good call.
[2014-07-11 23:50:57 -0400] shlant: attribute ['db', 'name'], app_info['db']['name']
[2014-07-11 23:50:57 -0400] shlant: attribute ['db', 'username'], app_info['db']['username']
[2014-07-11 23:51:17 -0400] jkeiser: shlant: you can say attribute 'db', app_info['db']
[2014-07-11 23:51:31 -0400] coderanger: stormerider: Looks like pam ldap does have a debug flag, no idea if that could do this though
[2014-07-11 23:51:50 -0400] coderanger: stormerider: Also check /etc/ns*
[2014-07-11 23:52:02 -0400] shlant: jkeiser: but I have to have different ones on different lines each with attribute in front?
[2014-07-11 23:52:11 -0400] coderanger: depends on if you are using PAM or nsswitch I guess
[2014-07-11 23:52:15 -0400] coderanger: (or both)
[2014-07-11 23:52:28 -0400] stormerider: it was the debug line in pam_ldap.conf
[2014-07-11 23:52:32 -0400] stormerider: thanks!
[2014-07-11 23:52:59 -0400] coderanger: stormerider: Woo, glad all that info is stuck in my brain forever :)
[2014-07-11 23:53:00 -0400] shlant: oh I see
[2014-07-11 23:53:01 -0400] jkeiser: shlant: are you asking whether you can set all top-level attributes with a single hash?
[2014-07-11 23:53:13 -0400] jkeiser: shlant: if you want to do that, you can do attributes { ... }
[2014-07-11 23:53:35 -0400] stormerider: hehe :) i think someone turned on debugging when they were trying to write our centos chef config recipe
[2014-07-11 23:54:26 -0400] shlant: jkeiser: so attribute 'db', app_info['db'] would pass all attributes under 'db'
[2014-07-11 23:54:34 -0400] shlant: such as name, username
