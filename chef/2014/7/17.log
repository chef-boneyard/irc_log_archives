[2014-07-17 00:04:01 -0400] Damm: well that's kind of the problem with rubygems
[2014-07-17 00:04:03 -0400] Damm: it goes down
[2014-07-17 00:04:13 -0400] Damm: I hope they've taken steps to make it better to mirror
[2014-07-17 00:04:15 -0400] Damm: or even possible
[2014-07-17 00:04:20 -0400] Damm: it's kinda a joke that way
[2014-07-17 00:05:48 -0400] shlant: I'm so confused
[2014-07-17 00:05:52 -0400] shlant: chef-11.12.8 depends on [chef-zero (< 2.1, >= 2.0.2)]
[2014-07-17 00:05:58 -0400] shlant: so if I manually install 2.2
[2014-07-17 00:06:04 -0400] shlant: "Unable to activate cheffish-0.7, because chef-zero-2.0.2 conflicts with chef-zero (~> 2.2)"
[2014-07-17 00:07:00 -0400] shlant: maybe I should give up for today lol
[2014-07-17 00:08:17 -0400] jkeiser: shlant: so cheffish 0.7 is incompatible with 11.12.8?  Well THAT sucks
[2014-07-17 00:09:22 -0400] shlant: so rubygems doesn't hate me?
[2014-07-17 00:13:31 -0400] 23LAA0QIE: anyone here using cloud plugin with ohai7 ?
[2014-07-17 00:16:46 -0400] strictlyb: is anyone around here that uses cloud providor plugin for ohai 7
[2014-07-17 00:24:44 -0400] digitalchild: anyone know how to test if chefsolo is being used in serverspec so I can skip a test?
[2014-07-17 00:29:08 -0400] someara: serverspec is completely out of band of chef
[2014-07-17 00:29:10 -0400] someara: so, no
[2014-07-17 00:32:15 -0400] digitalchild: no harm in trying seeing as people that use chef do use serverspec
[2014-07-17 00:36:22 -0400] cheeseplus: digitalchild: well the point is that it's totally out of band - serverspec isn't supposed to know about anything except whether final machine state
[2014-07-17 00:36:46 -0400] cheeseplus: so yes folks use it but it's obliviousness is intentional ;)
[2014-07-17 00:39:06 -0400] strictlyb: anyone here using cloud plugin with ohai7 ?
[2014-07-17 00:46:46 -0400] digitalchild: cheeseplus: *nods*
[2014-07-17 00:47:12 -0400] digitalchild: cheeseplus: does chef solo leave anything on the machine that I could check? like 'some chef solo file exists'
[2014-07-17 00:50:11 -0400] cheeseplus: I can't think of anything specific to just it
[2014-07-17 00:51:38 -0400] cheeseplus: is there not a way to break the task into two test suites instead of having to case one test?
[2014-07-17 00:56:37 -0400] korishev: jkeiser: does chef-metal save a partial node into the chef server before the run is complete the first time?
[2014-07-17 01:22:50 -0400] shlant: jkeiser: do you want me to submit an issue for the incompatibility?
[2014-07-17 01:53:17 -0400] jkeiser: shlant: please do!  I'll get to it ASAP.  Meantime I suspect you'll be in better shape if you grab 11.14, much as it sucks to ask that of you
[2014-07-17 01:55:46 -0400] korishev: jkeiser: is there any way from the node data chef-metal is putting in the chef-server to tell if the initial chef run is complete?  Im having trouble in a recipe doing a search where the node is getting itself back from the search before it is setup because chef-metal is writing partial nodes to the server
[2014-07-17 01:56:34 -0400] jkeiser: korishev: two things to say there: first, until the chef run is complete, the node will not contain any ohai attributes (so if you look at node['automatic'] you can tell).  That's just how chef-client works
[2014-07-17 01:57:03 -0400] jkeiser: korishev: second, a nice way to resolve this sort of dependency is to start your recipe with a machine_batch containing all your machines and just their base recipes.  Let that converge, and everybody will be populated
[2014-07-17 01:57:35 -0400] jkeiser: korishev: then, put more machine definitions (to the same machines!) and add your specific recipes, like mysql or apache or whatever
[2014-07-17 01:57:59 -0400] jkeiser: korishev: an example: https://gist.github.com/jkeiser/7c1d690b5c612e9e3b01
[2014-07-17 01:58:47 -0400] korishev: jkeiser: cool, Ill try the second part, that looks like ti will work, thanks!
[2014-07-17 02:31:13 -0400] NewbieIT: hello hello!!
[2014-07-17 02:31:36 -0400] NewbieIT: is there a way to put some "Comments" on a cookbook present in SuperMarket ??
[2014-07-17 02:31:47 -0400] korishev: jkeiser: Im trying to machine_batch my run, but now I get an undefined method `location' for nil:NilClass
[2014-07-17 02:41:07 -0400] tomoyuki28jp: I use chef recipe with or without vagrant. What's a good way to share common settings between chef and vagrant?
[2014-07-17 02:41:25 -0400] tomoyuki28jp: I use the common setting both in Vagrantfile and chef recipe.
[2014-07-17 03:12:55 -0400] rbowlby: does the tomcat cookbook work with 7?
[2014-07-17 03:34:57 -0400] rbowlby: doesn't appear to have a tomcat7 erb
[2014-07-17 03:35:26 -0400] rbowlby: just took a look at tomcat_latest cookbook and about vomited all over the dog on my lap
[2014-07-17 03:36:19 -0400] rbowlby: direct download?      installs to /tmp?          horrendous if block of file exists checks at top?
[2014-07-17 03:36:22 -0400] rbowlby: I don't even..
[2014-07-17 03:47:10 -0400] chefgirl: what are databags
[2014-07-17 03:47:27 -0400] chefgirl: in simple language
[2014-07-17 03:47:32 -0400] chefgirl: can anybody explian
[2014-07-17 03:49:01 -0400] jsvana: So, I've been trying to get Apache to install properly using the opscode apache cookbook, but chef_solo is failing because authz_default doesn't exist and LockFile was changed to Mutex. Is there any way I can make the cookbook work?
[2014-07-17 03:49:36 -0400] jsvana: I've tried removing authz_default from the mods and adding override['apache']['version'] = '2.4' to the attributes, but neither worked.
[2014-07-17 03:52:02 -0400] chefgirl: what are databags and how can we use that
[2014-07-17 03:53:38 -0400] zanshin1: http://docs.opscode.com/essentials_data_bags.html.
[2014-07-17 03:54:47 -0400] zanshin1: We have used them for JBoss server properties, user lists, and data sources
[2014-07-17 05:13:44 -0400] chefgirl: is anybody suing appdynamics server monitoring agen?
[2014-07-17 05:17:19 -0400] chefgirl_: hi
[2014-07-17 05:26:01 -0400] chefgirl_: have anybody using appdynamics server monitoring agent
[2014-07-17 05:26:12 -0400] Damm: there is an irc room for that?
[2014-07-17 05:26:30 -0400] Damm: unless you have a chef backtrace?
[2014-07-17 05:30:04 -0400] chefgirl_: Damm : are you replying to me
[2014-07-17 05:32:53 -0400] scalp42: chefgirl I have
[2014-07-17 05:32:54 -0400] scalp42: whats up
[2014-07-17 05:33:23 -0400] chefgirl: scalp42 : can we chat privately if u dont really mind
[2014-07-17 05:33:32 -0400] scalp42: but more on the cookbook side :D
[2014-07-17 05:33:33 -0400] scalp42: sure
[2014-07-17 05:38:47 -0400] Damm: sure was chefgirl.  If it's related to Chef it's pretty fair game but outside depending on the context can be better served elsewhere (in the channels or forums for said thing) as the specialties don't always match
[2014-07-17 05:39:06 -0400] Damm: you get a pretty large cornacopia but you get a pretty darn large set of issues too in here
[2014-07-17 05:39:22 -0400] Damm: so what you get back can also change over the period of the day
[2014-07-17 05:40:11 -0400] Damm: just the fun of irc
[2014-07-17 05:45:16 -0400] scalp42: yeah I think it requires to know how appdynamics works first or write a cookbook first
[2014-07-17 05:45:19 -0400] scalp42: or vice versa
[2014-07-17 05:45:31 -0400] scalp42: trying to do both at same time won't necessarily help
[2014-07-17 05:49:54 -0400] Damm: https://github.com/edmunds/cookbook-appdynamics
[2014-07-17 05:49:59 -0400] Damm: yeah that's an interesting cookbook
[2014-07-17 05:51:52 -0400] scalp42: yeah rewrote it completely
[2014-07-17 05:51:53 -0400] Damm: hmm you know i've hosted my timeseries data too much
[2014-07-17 05:52:05 -0400] scalp42: but its a solid base
[2014-07-17 05:52:08 -0400] Damm: looking at appdynamics I think i just sold Sensu and Influxdb to a customer
[2014-07-17 05:52:12 -0400] Damm: heh
[2014-07-17 05:52:21 -0400] Damm: that does the same thing but not in the same way
[2014-07-17 05:52:37 -0400] scalp42: migrated all our metrics to librato today!
[2014-07-17 05:52:38 -0400] Damm: but we are not java nor .net nor php
[2014-07-17 05:52:49 -0400] Damm: scalp42, http://influxdb.com/
[2014-07-17 05:52:49 -0400] scalp42: appdynamics is like super bloated
[2014-07-17 05:53:00 -0400] Damm: 0.8.0 has more storage engines (it's a rc right now)
[2014-07-17 05:53:04 -0400] Damm: so leveldb, rocksdb, etc
[2014-07-17 05:53:11 -0400] chefgirl: Is appdynamics a server monitroing or app monitoring agent
[2014-07-17 05:53:13 -0400] chefgirl: ?
[2014-07-17 05:53:17 -0400] scalp42: never used it but I think I just wanted some peace of mind
[2014-07-17 05:53:31 -0400] scalp42: both chefgirl
[2014-07-17 05:53:33 -0400] Damm: dunno if you are into that kind of thing scalp42 but you can use it alot
[2014-07-17 05:53:35 -0400] Damm: in a lot of ways
[2014-07-17 05:53:38 -0400] Damm: events; timeseries
[2014-07-17 05:53:47 -0400] scalp42: oh I believe you
[2014-07-17 05:53:51 -0400] Damm: presentation is a problem always
[2014-07-17 05:53:59 -0400] scalp42: but at that point its more a time/energy/money situation
[2014-07-17 05:54:06 -0400] Damm: I started with Zabbix back in 2007 and I remember spending 4hours making Dashboards a day
[2014-07-17 05:54:11 -0400] Damm: and that was time well spent
[2014-07-17 05:54:12 -0400] Damm: heh
[2014-07-17 05:54:18 -0400] Damm: shoving it all into mysql
[2014-07-17 05:54:19 -0400] scalp42: and scaling graphite is awful
[2014-07-17 05:54:21 -0400] chefgirl: Damm scalp42 : can you guys point to a good tutorial ?
[2014-07-17 05:54:23 -0400] Damm: agreed
[2014-07-17 05:54:33 -0400] Damm: I scaled graphite to 2million metrics on 1 box
[2014-07-17 05:54:36 -0400] Damm: wrote a lwrp to support it
[2014-07-17 05:54:40 -0400] scalp42: there's still that megacarbon stuff
[2014-07-17 05:54:44 -0400] Damm: 2million points every 10s
[2014-07-17 05:54:46 -0400] Damm: yeah right
[2014-07-17 05:54:47 -0400] scalp42: im not even sure if it still exists
[2014-07-17 05:54:53 -0400] Damm: i'm not sure if it's even moving
[2014-07-17 05:55:09 -0400] Damm: I've been pleased with influxdb a single package; takes about 400megs resident
[2014-07-17 05:55:13 -0400] Damm: single process
[2014-07-17 05:55:21 -0400] Damm: I still get graphite reception and can take stuff via http
[2014-07-17 05:55:53 -0400] scalp42: I actually think that the issue is more on the frontend side
[2014-07-17 05:55:55 -0400] scalp42: tbh
[2014-07-17 05:55:55 -0400] Damm: scalp42, it's still new so i'd not tell you to drop librato as there's likely bugs you'd hit
[2014-07-17 05:56:10 -0400] Damm: scalp42, well it's 0.8.0 I expect bugs; frontend is Grafana so don't know how you feel about that
[2014-07-17 05:56:17 -0400] scalp42: and took me literally 2 days so I was like "oh shit"
[2014-07-17 05:56:20 -0400] scalp42: was kinda like magic
[2014-07-17 05:56:29 -0400] Damm: heh
[2014-07-17 05:57:00 -0400] scalp42: sometimes I wish in a perfect world
[2014-07-17 05:57:01 -0400] Damm: http://influxdb.com/docs/v0.8/api/query_language.html
[2014-07-17 05:57:05 -0400] Damm: you can see part of the problem easily
[2014-07-17 05:57:10 -0400] scalp42: there were some kind of screenhero multi user thing
[2014-07-17 05:57:18 -0400] Damm: yep
[2014-07-17 05:57:20 -0400] scalp42: where folks would be "let me show you my stack"
[2014-07-17 05:57:34 -0400] scalp42: or like "how it was before, how its now"
[2014-07-17 05:57:42 -0400] scalp42: would be very interesting but IPs
[2014-07-17 05:58:00 -0400] scalp42: I should start a group haha
[2014-07-17 05:58:08 -0400] Damm: yeah you should
[2014-07-17 05:58:23 -0400] scalp42: but like random stuff
[2014-07-17 05:58:29 -0400] scalp42: in a "menu du jour" thing
[2014-07-17 05:58:39 -0400] scalp42: maybe its rewriting a cookbook
[2014-07-17 05:59:05 -0400] scalp42: like random stuff
[2014-07-17 06:04:19 -0400] scalp42: alright im out have a good one Damm !
[2014-07-17 06:04:26 -0400] scalp42: until tomorrow ha
[2014-07-17 06:10:11 -0400] chefgirl: Damm : can u give me the appdyamics tutorial link ?
[2014-07-17 07:03:51 -0400] chefgirl: do anybody knows how to install appdynamics on linux
[2014-07-17 07:21:52 -0400] bixu: can i subscribe to a resource in another recipe?
[2014-07-17 07:29:38 -0400] ambientsound: chefgirl: HOWTO on that here: http://bit.ly/1jAopck
[2014-07-17 07:30:11 -0400] chefgirl: I am very new not getting how to set up environent
[2014-07-17 07:30:13 -0400] chefgirl: stuck
[2014-07-17 07:43:26 -0400] chefgirl: Please can anybody help me setting the appdynamics environment
[2014-07-17 09:32:18 -0400] hpf: hi @ all
[2014-07-17 09:33:51 -0400] hpf: can someone recommend some private training providers in germany
[2014-07-17 09:46:40 -0400] soblom: hpf: on what scale? just for you? one team or a whole company?
[2014-07-17 10:32:03 -0400] aberrios_: Hi guys, I'm sure I've seen a tool somewhere for describing an environment and using it to get knife to provision loads of nodes simultaneously. I.e. in a file i describe I need 2 web roles, a db role, a sensu role etc... and with one knife command off it goes... I forget the name of it.. can someone help me?
[2014-07-17 10:33:54 -0400] zts: aberrios_: you might be thinking of spiceweasel
[2014-07-17 10:40:58 -0400] hpf: soblom: in general for a company, but since I am the only one who intends to use chef, for me and adapted for my special requirements
[2014-07-17 10:41:50 -0400] thorduri: hpf: in german? (and where in germany)
[2014-07-17 10:42:38 -0400] hpf: english is fine, my companies location is in Karlsruhe
[2014-07-17 10:46:57 -0400] hpf: the thing is, to be more specific, since I am new in chef and I am looking for a simple way to provision servers (windows 2008 and 2012) on our ESX infra and I dont have the time to learn everything by myself, a private training would be really nice
[2014-07-17 10:47:40 -0400] hpf: finding on the web consultants isnt that easy, I figured
[2014-07-17 11:11:26 -0400] chefgirl: RegistrationChannel - Fatal transport error what does this error means in appdynamics ?
[2014-07-17 11:22:25 -0400] chefgirl: please help me installing machine agent on windows
[2014-07-17 11:22:30 -0400] chefgirl: using appdynamics
[2014-07-17 11:25:41 -0400] user0815: hi
[2014-07-17 11:25:59 -0400] user0815: i have some problems regarding encryptet data bags
[2014-07-17 11:27:24 -0400] user0815: i can only decrypt, when it is exactly the same key file - copies (eg on nodes) do not work
[2014-07-17 11:27:39 -0400] user0815: but it did work a few days ago
[2014-07-17 11:29:47 -0400] user0815: fo example: openssl rand -base64 1024 > rand1; cp rand1 rand2; knife data bag create test enc -s rand1;(put some values in):knife data bag show test enc -s rand2
[2014-07-17 11:29:57 -0400] user0815: results to ERROR: Chef::EncryptedDataBagItem::DecryptionFailure: Error decrypting data bag value: 'bad decrypt'. Most likely the provided key is incorrect
[2014-07-17 11:30:25 -0400] user0815: knife data bag show test enc -s rand1 -> works fine
[2014-07-17 12:18:55 -0400] chefgirl: i have installed appdynamics on windows machine but cant see the machine on portal
[2014-07-17 12:19:06 -0400] chefgirl: i have installed appdynamics machinb agent
[2014-07-17 12:24:15 -0400] iiro-: chefgirl, and this relates to Chef how...? :O
[2014-07-17 12:24:56 -0400] chefgirl: iiro : i know its not related to chef but help me if u can
[2014-07-17 12:24:57 -0400] chefgirl: :(
[2014-07-17 12:25:27 -0400] iiro-: chefgirl, sry, AppDynamics is not familiar to me :/ Surely I would if...
[2014-07-17 12:25:43 -0400] user0815: anybody who knows the solution for my decrypted data bag problem?
[2014-07-17 12:25:46 -0400] chefgirl: iiro- :( :(
[2014-07-17 12:26:05 -0400] user0815: i postet in an hour ago
[2014-07-17 12:35:04 -0400] teukka: user0815: `-s` is for specifying the secret key itself, not a file. you want `--secret-file`
[2014-07-17 12:39:34 -0400] quantumfoam: kierrr: sup
[2014-07-17 12:40:41 -0400] chefgirl: can i integrate chef with jenkins?
[2014-07-17 12:41:40 -0400] n1ko: you can integrate chef with what ever you want
[2014-07-17 12:44:51 -0400] user0815: @teukka: d'oh! Thank you. Do you know how i can change the key of a data bag?
[2014-07-17 12:47:08 -0400] chefgirl: n1ko : how can i do that '
[2014-07-17 12:48:25 -0400] hirose31: FYI: I've just written Chef::Provider::Service::Daemontools https://gist.github.com/hirose31/54adfebe919a50985904
[2014-07-17 12:52:41 -0400] teukka: user0815: decrypt and encrypt it again with the correct key (file)
[2014-07-17 13:02:20 -0400] user0815: okay thank you teukka! bye
[2014-07-17 13:12:49 -0400] pablo_: Hey everyone, I was wondering if someone might be able to help me out. I'm getting an ssl certificate verify failed error when running berks install.
[2014-07-17 13:13:18 -0400] pablo_: It appears not restricted to a specific cookbook I depend on
[2014-07-17 13:16:29 -0400] pablo_: debug logging gives me this:
[2014-07-17 13:16:39 -0400] pablo_: D, [2014-07-17T13:34:20.633818 #17024] DEBUG -- :     => #<Berkshelf::APIClient: :RemoteCookbook:0x762c0c0 @name="windows", @version="1.32.3", @attributes=#<Hash ie::Mash dependencies=#<Hashie::Mash chef_handler=">= 0.0.0"> download_url="http s://supermarket.getchef.com/api/v1/cookbooks/windows/versions/1.32.3/download" l ocation_path="https://supermarket.getchef.com/api/v1" location_type="opscode">> Installing windows (1.32.3) from ht
[2014-07-17 13:18:04 -0400] pablo_: damn, that looks like it truncated
[2014-07-17 13:18:13 -0400] pablo_: last bit is:
[2014-07-17 13:18:17 -0400] pablo_: ([opscode] https://su permarket.getchef.com/api/v1) E, [2014-07-17T13:34:20.950850 #17024] ERROR -- : Actor crashed! Faraday::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server certif icate B: certificate verify failed
[2014-07-17 13:19:23 -0400] pablo_: though the whitespace from the line wraps shouldn't be there
[2014-07-17 13:24:55 -0400] hpf: @soblom @thorduri: du you have informations about private training courses in germany?
[2014-07-17 13:36:33 -0400] thorduri: hpf: sorry, got dragged into a meeting. former colleague of mine is in germany but it seems he stopped doing consulting, so nope...
[2014-07-17 13:37:17 -0400] jonlives: hpf: have you tried contacting them on http://www.getchef.com/training/ ?
[2014-07-17 13:37:30 -0400] jonlives: chef do private onsite training and I know they have folks in europe
[2014-07-17 13:40:39 -0400] rbowlby: anyone know a good tomcat cookbook for tomcat 7/8 on ubuntu 14?
[2014-07-17 13:40:53 -0400] rbowlby: I don't have time to reinvent the wheel if I can help it.
[2014-07-17 13:42:18 -0400] aberrios_: spiceweasel, that's the badger! thanks zts
[2014-07-17 13:43:45 -0400] rbowlby: anyone? good tomcat 7 cookbook that uses .deb packages?
[2014-07-17 14:01:23 -0400] chiefsucker: Did anybody successfully install the official chef-ganglia cookbook?
[2014-07-17 14:01:30 -0400] castro1688: hey everyone! is anyone else experiencing intermittent errors with packages in ubuntu 12.04 this morning? We are seeing returned 100, expected 0. Trying to figure out if its us or something system wide
[2014-07-17 14:01:50 -0400] gchristensen: castro1688: its you
[2014-07-17 14:01:51 -0400] rh1n0: Its been a year or longer since I've used chef. wow its changes a great deal.
[2014-07-17 14:01:58 -0400] gchristensen: castro1688: you need to run apt-get update
[2014-07-17 14:02:00 -0400] rh1n0: changed rather
[2014-07-17 14:02:13 -0400] chiefsucker: I have issues with the ganglia::gmetad recipe. It complains on every run, that the xml_port variable couldnt be found. I can see it in Chefs web interface, though.
[2014-07-17 14:02:22 -0400] gchristensen: castro1688: and if you're pinning package versions, the one you wanted might have disappeared
[2014-07-17 14:02:54 -0400] chiefsucker: I already tried to explicitely set it in my wrapper cookbook default.rb (either as default or override), and I also tried to add override_attributes to the ganglia role I use  both without success.
[2014-07-17 14:03:35 -0400] rh1n0: think I've finally eliminated all my old chef gem dependencies and have only chef-dk active
[2014-07-17 14:04:50 -0400] quantumfoam: ok, I'm adding another workstation to my chef infrastructure, but I'm doing it under an account that already exists (my account)
[2014-07-17 14:05:10 -0400] quantumfoam: so during knife configure --initial I'm prompted to enter a new user, but do I need to do that?
[2014-07-17 14:05:17 -0400] quantumfoam: obviously it won't let me use the existing one
[2014-07-17 14:05:38 -0400] quantumfoam: or uh I mean is there a way to make it use the existing user instead of a new one?
[2014-07-17 14:09:42 -0400] castro1688: gchristensen, thanks! odd it just started now
[2014-07-17 14:12:06 -0400] gchristensen: castro1688: not really, your upstream apt repositories updated and the particular version your node knows about is no longer available
[2014-07-17 14:13:20 -0400] chiefsucker: When I do a search I get the following output:
[2014-07-17 14:13:25 -0400] chiefsucker: knife search node "role:ganglia" -a "ganglia.gmetad.xml_port"
[2014-07-17 14:13:25 -0400] chiefsucker: 2 items found
[2014-07-17 14:13:27 -0400] chiefsucker: lnxv-test-local-1:
[2014-07-17 14:13:28 -0400] chiefsucker:   ganglia.gmetad.xml_port: 8651
[2014-07-17 14:13:29 -0400] chiefsucker: lnxv-mgt-001:
[2014-07-17 14:13:30 -0400] chiefsucker:   ganglia.gmetad.xml_port: 8651
[2014-07-17 14:13:35 -0400] chiefsucker: This looks like it would be alright.
[2014-07-17 14:13:51 -0400] chiefsucker: But when I try to run chef-client it complains that xml_port couldnt be found.
[2014-07-17 14:14:11 -0400] chiefsucker: ---- Begin output of /etc/init.d/gmetad start ----
[2014-07-17 14:14:12 -0400] chiefsucker: STDOUT: Starting Ganglia Monitor Meta-Daemon:
[2014-07-17 14:14:12 -0400] chiefsucker: STDERR: gmetad config file error: Missing argument to option 'xml_port'
[2014-07-17 14:14:23 -0400] chiefsucker: And when I take a look at the config file then the xml_port is indeed empty.
[2014-07-17 14:14:31 -0400] chiefsucker: Any ideas why this is the case?
[2014-07-17 14:15:13 -0400] chiefsucker: The official recipe gets the port like this: :xml_port => node['ganglia']['gmetad']['xml_port']
[2014-07-17 14:24:33 -0400] rh1n0: are people still using berkshelf without the chef server to create application cookbooks or has another trend taken its place?
[2014-07-17 14:25:42 -0400] gchristensen: 'without the chef server'?
[2014-07-17 14:26:48 -0400] rh1n0: yeah - when i was last involved with chef berkshelf was new on the scene and promoted using chef-solo since they didn't like using roles. There was no need for chef server in some cases. it was a year or more ago so I'm a bit sketchy on details.
[2014-07-17 14:27:54 -0400] rh1n0: https://www.youtube.com/watch?v=hYt0E84kYUI
[2014-07-17 14:31:37 -0400] EricL: Is there any conventional wisdom on dist-upgrading Ubuntu with Chef?
[2014-07-17 14:34:26 -0400] ambientsound: EricL: do you mean do-release-upgrade or apt-get dist-upgrade?
[2014-07-17 14:36:05 -0400] smithmb: Does regenerating a validator key invalidate all client API keys?
[2014-07-17 14:36:37 -0400] EricL: dist-upgrade
[2014-07-17 14:40:37 -0400] strictlyb: anyone here using aws/chef/ohai cloud plugin with ohai 7?
[2014-07-17 14:43:19 -0400] EricL: ambientsound: Is there a good way to handle those things?
[2014-07-17 14:43:49 -0400] ambientsound: EricL: I haven't tried, sorry. Maybe with knife ssh?
[2014-07-17 14:44:01 -0400] ambientsound: or a cookbook...
[2014-07-17 14:44:29 -0400] EricL: I know ways I can do it.  I was more curious if there were best practices since I want to attempt it on one machine but ultimately has tob e done to a few hundred.
[2014-07-17 14:45:27 -0400] strictlyb: ericl you can use knife ssh
[2014-07-17 14:45:28 -0400] strictlyb: like
[2014-07-17 14:45:42 -0400] strictlyb: knife ssh name:somehostfirst 'sudo dist-upgrade'
[2014-07-17 14:45:52 -0400] strictlyb: and then when you want to do a role or recipe
[2014-07-17 14:46:05 -0400] strictlyb: knife ssh recipe:somerecipe 'sudo dist-upgrade'
[2014-07-17 14:46:12 -0400] strictlyb: knife ssh role:somerole 'sudo dist-upgrade'
[2014-07-17 14:46:27 -0400] strictlyb: knife ssh name:* 'sudo dist-upgrade'
[2014-07-17 14:46:29 -0400] strictlyb: you get the idea.
[2014-07-17 14:47:40 -0400] EricL: Yep.  Let me give that a try.
[2014-07-17 14:47:46 -0400] EricL: Thanks.
[2014-07-17 14:54:41 -0400] jtimberman: be sure to run chef after you upgrade, to reset all those default config files you manage with the ones from chef :)
[2014-07-17 15:06:56 -0400] smithmb: Does regenerating a client API key sometimes take a bit to propagate before you can use it?
[2014-07-17 15:12:40 -0400] smithmb: hhoover: let me know when you want to touch base
[2014-07-17 15:12:48 -0400] smithmb: hhoover: oops, wrong window :)
[2014-07-17 15:23:48 -0400] __julien: Hello, I'd like to know if there are reason to prefer node attributes to global $variables , if the $globvar can do the job in chef recipes
[2014-07-17 15:27:32 -0400] __julien: when the global variables are use as intermetidate computational state in beetween files of the same recipe
[2014-07-17 15:29:38 -0400] zts: __julien: node.run_state is a better thing to use for temporary data in a run (not saved to the server)
[2014-07-17 15:30:57 -0400] __julien: zts, thx exactly what I wanted
[2014-07-17 16:35:13 -0400] khazhyk_: does cdk work on windows
[2014-07-17 16:35:40 -0400] shlant: is there a way to parallelize .each? or does ruby have to do them one at a time
[2014-07-17 16:36:33 -0400] Eulipion: http://stackoverflow.com/questions/22797596/ruby-parallel-each-loop
[2014-07-17 16:38:43 -0400] rbowlby: anyone have a clue why my git resource can't see the ssh key
[2014-07-17 16:39:09 -0400] shlant: Eulipion: awesome, thanks!
[2014-07-17 16:39:15 -0400] rbowlby: "STDERR: error: cannot run ssh -i /root/.ssh/id_rsa_automation: No such file or directory"
[2014-07-17 16:39:35 -0400] rbowlby: the perms are 700 on .ssh and 600 on id_rsa_automation
[2014-07-17 16:39:57 -0400] Eulipion: make the key 400
[2014-07-17 16:39:58 -0400] rbowlby: if I run the git ls-remote command manually it works
[2014-07-17 16:40:21 -0400] rbowlby: trying
[2014-07-17 16:40:44 -0400] rbowlby: didn't work
[2014-07-17 16:40:45 -0400] cheeseplus: khazhyk_: yes, 0.2.0 added windows support
[2014-07-17 16:40:54 -0400] rbowlby: same error
[2014-07-17 16:40:55 -0400] Eulipion: im betting u have a key in ur agent that git is using, so when u specify that key, it bails
[2014-07-17 16:41:35 -0400] rbowlby: can you elaborate?
[2014-07-17 16:41:37 -0400] Eulipion: u also might want to make an "automation" user that isnt root
[2014-07-17 16:41:49 -0400] rbowlby: sure, that's where I'm headed
[2014-07-17 16:41:56 -0400] rbowlby: just trying to get one thing working at a time
[2014-07-17 16:42:16 -0400] rbowlby: can you elaborate on "have a key in ur agent"
[2014-07-17 16:42:20 -0400] Eulipion: ssh-add -l
[2014-07-17 16:44:01 -0400] shlant: can I just chef_gem install any ruby gem and use it in my recipes? or does it not work like that
[2014-07-17 16:46:34 -0400] rbowlby: let me approach this another way, does anyone have an example of the git resource that uses an ssh key?
[2014-07-17 16:48:18 -0400] Eulipion: rbowlby: there's probably a better way to do this: http://pastebin.com/YD0GESSn
[2014-07-17 16:49:14 -0400] rbowlby: thanks Eulipion, do you also have the git resource?
[2014-07-17 16:49:23 -0400] rbowlby: that is just setting up the ssh key
[2014-07-17 16:50:05 -0400] Eulipion: that'll drop the key and set the ssh config so that root (chef-client) uses it to connect to *.github.com.  so the git resource and application_* stuff will jfw
[2014-07-17 16:50:49 -0400] gleam: not at all relevant to chef, but does anyone here know how to get postfix to alias domaina.com to domainb.com but properly reject emails to user@domaina.com when user@domainb.com doesn't exist?
[2014-07-17 16:50:52 -0400] Eulipion: i have a "deployer" cookbook that can set up keys, users, ssl.  anything secure that another cookbook might need.
[2014-07-17 16:51:07 -0400] svend: I have VMs that register in chef and run chef-client when they are created. What is a good way to check for the success/failure of the chef run externally?
[2014-07-17 16:52:02 -0400] shlant: jkeiser: I might be going over the deep end, but is have a metal 'super master' server that runs a 'meta' metal recipe that uses the machine resource to run multiple metal 'masters' simultaneously for each chef environment/app a really crazy idea? :D
[2014-07-17 16:52:16 -0400] shlant: haha
[2014-07-17 16:52:28 -0400] shlant: parralelize ALL THE THINGS
[2014-07-17 16:52:34 -0400] thorduri: svend: i've been using https://github.com/jgoulah/knife-lastrun for checking them node by node
[2014-07-17 16:52:58 -0400] svend: thorduri: Thanks, that looks useful.
[2014-07-17 16:53:25 -0400] thorduri: svend: other options are something like theforman, http://projects.theforeman.org/projects/foreman/wiki/Chef-reporting
[2014-07-17 16:53:54 -0400] Eulipion: svend: you could also monitor with nsca
[2014-07-17 16:54:16 -0400] thorduri: svend: fwiw, i'm tinkering with using Jenkins to run the chef-client periodically, gives pretty good integration with our other tools
[2014-07-17 16:55:04 -0400] thorduri: allows for going overboard if you have a jenkins ,,pipeline'' for your chef setup, to converge nodes only when something meaningful has happed to their configurations
[2014-07-17 16:55:52 -0400] jkeiser: shlant: should be fine :)
[2014-07-17 16:56:17 -0400] shlant: jkeiser: shoot. I was kind of hoping you'd talk me out of it
[2014-07-17 16:56:18 -0400] shlant: well
[2014-07-17 16:56:23 -0400] shlant: down the rabiit hole I go
[2014-07-17 16:56:33 -0400] rbowlby: so do people prefer not to use the git resource? The deploy resource is better for some reason?
[2014-07-17 16:56:36 -0400] rbowlby: can someone explain?
[2014-07-17 16:56:49 -0400] gchristensen: well the deploy resource tries to be atomic
[2014-07-17 16:56:54 -0400] shlant: rbowlby: depends what you want to do
[2014-07-17 16:57:04 -0400] rbowlby: just clone a git repo
[2014-07-17 16:57:05 -0400] shlant: deploy resource is a crazyness of options
[2014-07-17 16:57:08 -0400] rbowlby: lol, successfully
[2014-07-17 16:57:14 -0400] TheDude05: I'm running into an issue with Chefspec and custom matchers and was wondering if anyone has had this problem before. We have a wrapper cookbook around the community 'runit' cookbook. Lets call it "foo-runit". In a separate cookbook, foo-application, we depend on the "foo-runit" cookbook. However, when I try to use the Chefspec matchers that are in the 'runit' cookbook I get method undefined errors. Is this a known issue?
[2014-07-17 16:57:20 -0400] gchristensen: the deploy resource is also mighty magic
[2014-07-17 16:57:33 -0400] gchristensen: they tried to take the entire capistrano project and bundle it into 'deploy'
[2014-07-17 16:57:38 -0400] shlant: rbowlby: I would try and get it working with the git resource
[2014-07-17 16:57:45 -0400] shlant: deploy is way more than you need
[2014-07-17 16:57:52 -0400] rbowlby: shlant, thanks
[2014-07-17 16:58:10 -0400] rbowlby: surprised the git resource doesn't have a ssh-key attribute
[2014-07-17 16:58:21 -0400] rbowlby: instead there's some horrible ssh wrapper nonsense that has to happen
[2014-07-17 16:58:23 -0400] shlant: rbowlby: yea you have to use the ssh_wrapper
[2014-07-17 16:58:25 -0400] shlant: yep
[2014-07-17 16:58:27 -0400] shlant: I hate it too
[2014-07-17 16:58:31 -0400] rbowlby: coming from puppet that's def worse
[2014-07-17 16:58:35 -0400] shlant: or just use ssh config
[2014-07-17 16:58:36 -0400] rbowlby: prob the only thing worse though
[2014-07-17 16:59:09 -0400] rbowlby: shlant, thanks, do you have an example wrapper thingy?
[2014-07-17 17:00:19 -0400] shlant: rbowlby: exec ssh -o UserKnownHostsFile=/dev/null -o StrictHostKeyChecking=no -i "/tmp/.ssh/id_deploy" "$@"
[2014-07-17 17:00:31 -0400] shlant: where id_deploy is your key
[2014-07-17 17:00:46 -0400] shlant: don't forget #!/bin/sh
[2014-07-17 17:12:47 -0400] trobrock: Ok, first time trying to use chef vault, when I run `knife vault create secrets github_oauth_token '{"github_oauth_token": "..."}' --search 'recipe:greenbits-squash' --admins trobrock --mode client` I am getting an error saying: ERROR: TypeError: no implicit conversion of nil into String. What could this be, am I missing something in the command?
[2014-07-17 17:15:25 -0400] dwradcliffe: trobrock: we're having the same problem
[2014-07-17 17:18:30 -0400] trobrock: dwradcliffe: have you managed to get a stacktrace at least?
[2014-07-17 17:19:12 -0400] dwradcliffe: trobrock: yep, and here's an issue for it https://github.com/Nordstrom/chef-vault/issues/113
[2014-07-17 17:19:22 -0400] trobrock: dwradcliffe: awesome
[2014-07-17 17:19:33 -0400] dwradcliffe: trobrock: but I'm not sure it's a code problem since it just started randomly
[2014-07-17 17:20:37 -0400] trobrock: are you using hosted chef?
[2014-07-17 17:20:44 -0400] dwradcliffe: yes
[2014-07-17 17:20:57 -0400] trobrock: possibly and issue there then? I am using that also
[2014-07-17 17:22:10 -0400] dwradcliffe: jtimberman: any chance there's an hosted api problem returning client public keys?
[2014-07-17 17:29:05 -0400] khazhyk_: cheeseplus: i ran the installer and none of the utils seem accessable
[2014-07-17 17:33:59 -0400] doug2: So, I have a recipe that's getting a file using exec and wget, and then after that some ruby code to read it. I'm getting a compile error in the recipe because the file doesn't exist. Does that make any sense?
[2014-07-17 17:34:24 -0400] bougyman: i'd have to see the recipe
[2014-07-17 17:35:48 -0400] khazhyk_: doug2: is your ifle read in a ruby block, or in the base
[2014-07-17 17:36:01 -0400] doug2: bougyman: http://pastebin.com/dWwJEkE0
[2014-07-17 17:36:11 -0400] doug2: khazhyk_: base I suppsoe
[2014-07-17 17:36:28 -0400] doug2: it's not even executing a log statement right before the wget, so it's not even executing the recipe
[2014-07-17 17:36:49 -0400] doug2: it's like it checks the file isn't there even before it runs
[2014-07-17 17:37:39 -0400] Eulipion: doug2: use remote_file, and Chef::Log.debug("derp") or puts
[2014-07-17 17:38:11 -0400] doug2: Eulipion: remote_file where?
[2014-07-17 17:38:17 -0400] Eulipion: instead of wget
[2014-07-17 17:38:18 -0400] bougyman: remote_file is a resource
[2014-07-17 17:38:36 -0400] Eulipion: http://docs.opscode.com/resource_remote_file.html
[2014-07-17 17:38:41 -0400] bougyman: line 14 screws up that recipe
[2014-07-17 17:38:44 -0400] doug2: Eulipion: ok. will that make chef not check the /tmp/maven* exists before it even runs?
[2014-07-17 17:38:47 -0400] bougyman: it's executed in compile phase.
[2014-07-17 17:39:03 -0400] doug2: *sigh* Ok
[2014-07-17 17:39:22 -0400] doug2: chef, the only dsl where code isn't executed sequentially and you can't debug problems with print statements
[2014-07-17 17:39:34 -0400] Eulipion: doug2: you can have it download every time, or download if the checksum doesnt match, or download only if its missing
[2014-07-17 17:39:40 -0400] bougyman: doug2: yes, you can
[2014-07-17 17:39:44 -0400] bougyman: you can also use pry
[2014-07-17 17:39:47 -0400] bougyman: I always debug with pry
[2014-07-17 17:40:07 -0400] bougyman: if you put binding.pry right before line 14 you could see what's up.
[2014-07-17 17:40:32 -0400] doug2: cEulipion: the point is that it's not even downloading. it looks, see's /tmp/maven isn't there yet and barfs not giving any credence to the fact that the recipe may put it there
[2014-07-17 17:40:44 -0400] bougyman: yes, because in the compile phase it hits line 14
[2014-07-17 17:40:51 -0400] Eulipion: pry looks cool, i'll have to try it out
[2014-07-17 17:40:56 -0400] doug2: bougyman: right... means you can't use print to debug problems
[2014-07-17 17:40:58 -0400] bougyman: that's before the second pass where it would actually execute the download.
[2014-07-17 17:41:00 -0400] cheeseplus: can't blame the dsl if you aren't using it
[2014-07-17 17:41:06 -0400] bougyman: yes, you can, doug2
[2014-07-17 17:41:11 -0400] bougyman: you're doing things outside the dsl there.
[2014-07-17 17:41:14 -0400] doug2: cbougyman: with pry?
[2014-07-17 17:41:18 -0400] cheeseplus: yep
[2014-07-17 17:41:25 -0400] doug2: ok. first I've heard of that
[2014-07-17 17:42:08 -0400] doug2: then again, i only found out about p yesterday when ruby was printing an array without [] around it.
[2014-07-17 17:42:16 -0400] cheeseplus: you're dying in the compile phase before it even gets to converging
[2014-07-17 17:43:03 -0400] doug2: cheeseplus: blows me away that it cares
[2014-07-17 17:43:14 -0400] bougyman: you told it to care
[2014-07-17 17:43:18 -0400] doug2: remote_file can't handle basic http auth ?
[2014-07-17 17:43:29 -0400] bougyman: why not?
[2014-07-17 17:43:32 -0400] bougyman: I do so all the time
[2014-07-17 17:43:43 -0400] doug2: bougyman: from a coding perspective, it's failing because something further in time doesn't exist yet
[2014-07-17 17:43:44 -0400] bougyman: https://user:pass@site.com/path/to/thing
[2014-07-17 17:43:58 -0400] doug2: bougyman: K
[2014-07-17 17:47:38 -0400] doug2: ok, with remote_file it's still failing complaining that /tmp/maven doesn't exist
[2014-07-17 17:48:05 -0400] cheeseplus: doug2: I'd suggest checking out http://erik.hollensbe.org/2013/03/16/the-chef-resource-run-queue/ for more on the compile & converge phases
[2014-07-17 17:48:54 -0400] doug2: cheeseplus: I've read that before. Doesn't make much sense.
[2014-07-17 17:49:17 -0400] doug2: For now, all I know is that chef is complaining that a file that I create in the cookbook doesn't exist yet, before it even runs the cookbook
[2014-07-17 17:49:28 -0400] doug2: ... even with remote_file
[2014-07-17 17:49:57 -0400] cheeseplus: what did you change the recipe to?
[2014-07-17 17:50:55 -0400] doug2: cheeseplus: http://pastebin.com/ZqJiub7j ... replaced exec & wget with remote_file
[2014-07-17 17:51:26 -0400] cheeseplus: you just moved your problem to line 20 it looks like
[2014-07-17 17:51:39 -0400] doug2: cheeseplus: so using remote_file is of no help
[2014-07-17 17:51:47 -0400] cheeseplus: well yes and no
[2014-07-17 17:52:01 -0400] doug2: argh
[2014-07-17 17:52:06 -0400] cheeseplus: it is a useful primitive that you should use over wget but it doesn't fix your specific error
[2014-07-17 17:52:29 -0400] doug2: ... which is that the ruby bit runs before the chef bit.
[2014-07-17 17:52:30 -0400] jordane: doug2: so when chef first reads the ruby, it dumps resources into a collection to run later. However, it still evaluates ruby like normal
[2014-07-17 17:52:43 -0400] jordane: doug2: so it dumps the remote_file into a collection to run later, then tries to read the file
[2014-07-17 17:52:45 -0400] doug2: could I put an exec in there that created a dummy file?
[2014-07-17 17:52:46 -0400] cheeseplus: probably want a ruby_block
[2014-07-17 17:52:51 -0400] cheeseplus: http://docs.opscode.com/resource_ruby_block.html
[2014-07-17 17:53:00 -0400] jordane: doug2: the trick is to wrap the ruby in a ruby_block like cheeseplus said
[2014-07-17 17:53:50 -0400] cheeseplus: if you write raw ruby it gets executed during compile, wrapping in a ruby_block executes during converge
[2014-07-17 17:53:51 -0400] doug2: cheeseplus/jordane: k, will try that
[2014-07-17 17:53:59 -0400] doug2: cheeseplus: ok, that makes sense
[2014-07-17 17:55:10 -0400] cheeseplus: if you do everything in the DSL you don't have to fight it, when you go outside it though you risk runing into situations where the compile vs converge matters
[2014-07-17 17:58:57 -0400] doug2: ok. next question... it seems that a variable defined inside a ruby_block isn't accessible outside in a recipe?
[2014-07-17 17:59:22 -0400] bougyman: correct.
[2014-07-17 17:59:29 -0400] Eulipion: use attributes
[2014-07-17 17:59:36 -0400] doug2: bougyman: k...
[2014-07-17 17:59:40 -0400] doug2: Eulipion: k...
[2014-07-17 17:59:45 -0400] doug2: Eulipion: node attriutes?
[2014-07-17 17:59:51 -0400] cheeseplus: yep
[2014-07-17 18:00:06 -0400] doug2: kk
[2014-07-17 18:00:34 -0400] keftes: can you knife bootstrap and put chefdk instead of the generic chef client ?
[2014-07-17 18:03:55 -0400] keftes: talking to myself: knife bootstrap --bootstrap-version="0.2.0 -P chefdk" nodename -x usr
[2014-07-17 18:04:25 -0400] diegows: if there a way to define global attributes, reading the doc I'd say no... only creating a new recipe extending the previous one
[2014-07-17 18:04:30 -0400] diegows: but may be it's a better option
[2014-07-17 18:04:41 -0400] keftes: global in what scope?
[2014-07-17 18:04:44 -0400] keftes: cross-environment ?
[2014-07-17 18:05:15 -0400] keftes: if it's in your cookbook it's available to all recipes inside it
[2014-07-17 18:05:23 -0400] keftes: not global enough?
[2014-07-17 18:08:41 -0400] diegows: for example, I 'm using the mongodb cookbook
[2014-07-17 18:08:45 -0400] diegows: the community one
[2014-07-17 18:08:54 -0400] diegows: and I need to setup a couple of things to get it working on CentoS7
[2014-07-17 18:09:17 -0400] diegows: cookbook doc mention about create new recipe to extend the original one
[2014-07-17 18:09:24 -0400] diegows: but I only need to set a couple of attrs
[2014-07-17 18:09:36 -0400] diegows: a recipe only for that, I don't like very much
[2014-07-17 18:09:43 -0400] keftes: there's different approaches to this i guess
[2014-07-17 18:09:51 -0400] diegows: that's why I'm talking about global attributes
[2014-07-17 18:10:13 -0400] keftes: you could simply override the attribute in your environment - or in a role - or wrap it in a separate cookbook
[2014-07-17 18:10:20 -0400] cheeseplus: diegows: some cookbooks are meant to wrapped
[2014-07-17 18:10:24 -0400] keftes: ^
[2014-07-17 18:10:26 -0400] diegows: ok
[2014-07-17 18:10:38 -0400] diegows: wrapped sounds the more clean solutions I think
[2014-07-17 18:10:43 -0400] cheeseplus: basically they just provide a resource
[2014-07-17 18:10:44 -0400] keftes: google for cookbook patterns - it's a debatable topic :) - but there's info out there
[2014-07-17 18:10:57 -0400] cheeseplus: but your wrapper then can set attributes
[2014-07-17 18:11:09 -0400] cheeseplus: or do anything custom that the community cookbook does not provide
[2014-07-17 18:11:15 -0400] diegows: ok, I'm convinced now... I'll do in that way :)
[2014-07-17 18:11:29 -0400] diegows: just wanted to hear other opinions, thanks!
[2014-07-17 18:12:16 -0400] cheeseplus: diegows: the alternatives are overriding attributes at the role level
[2014-07-17 18:19:30 -0400] tequilarista: yuck
[2014-07-17 18:19:31 -0400] tequilarista: don't do that
[2014-07-17 18:19:32 -0400] tequilarista: :)
[2014-07-17 18:20:18 -0400] cheeseplus: and therein you see how people feel about one pattern ;)
[2014-07-17 18:20:54 -0400] tequilarista: the main reason not to use roles is there's no versioning
[2014-07-17 18:21:11 -0400] tequilarista: unless you use a version string in your role naming convention, in which case you end up with a ton of them and it's messy
[2014-07-17 18:21:38 -0400] keftes: you dont always NEED versioning on your roles
[2014-07-17 18:21:39 -0400] tequilarista: wrappers can utilize the cookbook's native versioning scheme and you get automatic protection
[2014-07-17 18:21:45 -0400] tequilarista: true
[2014-07-17 18:21:49 -0400] keftes: e.g you're modifying a run_list that pretty much will never change
[2014-07-17 18:22:05 -0400] tequilarista: sure, context is everything
[2014-07-17 18:22:30 -0400] tequilarista: for many of us using chef in enterprise level ways where stuff's changing all the time, versioning is pretty key
[2014-07-17 18:22:43 -0400] tequilarista: "your mileage may vary"
[2014-07-17 18:23:27 -0400] Mniot: Within a `deploy_revision`, I'd like to get access to the Git ref that's getting deployed so that I can post a notice to our chatroom. I haven't been able to find how to access that info within the `after_restart` block. Anyone have a pointer?
[2014-07-17 18:25:27 -0400] diegows: cheeseplus, ah, that could be a better options... I can create a simple role for mongodb, then I can use that role in another roles, instead of the recipes
[2014-07-17 18:25:29 -0400] diegows: I like it :)
[2014-07-17 18:25:33 -0400] shlant: jkeiser: shoot, I guess I can do my metal inception until I can either specify what chef version to run the machine on or not have to use rc.2
[2014-07-17 18:25:39 -0400] shlant: can't do*
[2014-07-17 18:25:59 -0400] jkeiser: shlant: that sucks!  Patches accepted though ... I can give you pointers on what to modify
[2014-07-17 18:26:38 -0400] jkeiser: shlant: which driver are you using again?
[2014-07-17 18:27:07 -0400] jkeiser: shlant: chef is installed in a post-instance-setup step called the "convergence strategy."  This code is common to many drivers, but each has a subtle difference from each other
[2014-07-17 18:27:13 -0400] cheeseplus: diegows: personally, I prefer the wrapper style but the role option will work (as you can see folks are opinionated about the approach)
[2014-07-17 18:27:14 -0400] jkeiser: shlant: https://github.com/opscode/chef-metal/blob/master/lib/chef_metal/convergence_strategy
[2014-07-17 18:27:30 -0400] jkeiser: shlant: vagrant uses install_sh.rb, and fog uses install_cached.rb
[2014-07-17 18:28:14 -0400] jkeiser: shlant: you control the options of these with :convergence_options, a hash of options hanging off machine_options
[2014-07-17 18:29:16 -0400] jkeiser: shlant: like "with_machine_options :bootstrap_options => {...}, :convergence_options => {...}"
[2014-07-17 18:31:28 -0400] shlant: jkeiser: so it says :chef_version, and :prerelease are available. Is there a reason those don't work?
[2014-07-17 18:31:46 -0400] shlant: https://github.com/opscode/chef-metal/blob/master/lib/chef_metal/convergence_strategy/install_cached.rb#L105-L106
[2014-07-17 18:35:22 -0400] jkeiser: shlant: holy crap did I actually implement it?
[2014-07-17 18:35:32 -0400] shlant: ahah that would be awesom1
[2014-07-17 18:35:45 -0400] shlant: "feature amnesia"
[2014-07-17 18:35:47 -0400] jkeiser: lol I don't even know what past me did
[2014-07-17 18:35:49 -0400] jkeiser: I love past me
[2014-07-17 18:36:07 -0400] jkeiser: He's always sending me surprises
[2014-07-17 18:36:09 -0400] shlant: jkeiser: I will try it
[2014-07-17 18:36:13 -0400] shlant: what a guy
[2014-07-17 18:36:44 -0400] jkeiser: shlant: lol it looks like it will probably work.  Please let me know!
[2014-07-17 18:37:33 -0400] jkeiser: shlant: install_cached is vagrant, install_sh is AWS, looks like it's not implemented on the AWS one
[2014-07-17 18:37:54 -0400] jkeiser: shlant: I want to merge the two anyway, but that's a ways away
[2014-07-17 18:38:10 -0400] shlant: ah
[2014-07-17 18:38:17 -0400] shlant: shoot
[2014-07-17 18:38:45 -0400] jkeiser: shlant: ooh!
[2014-07-17 18:38:53 -0400] jkeiser: shlant: set :cached_installer => true on machine_options
[2014-07-17 18:39:03 -0400] jkeiser: shlant: and the fog driver will pick that for you
[2014-07-17 18:39:39 -0400] jkeiser: shlant: just be aware the tradeoff: the cached installer downloads the package onto the local machine running chef-metal, and then pushes the packages up to the AWS machine(s) over the SSH connection(s)
[2014-07-17 18:39:57 -0400] jkeiser: shlant: so if you are provisioning 1000 machines in parallel, be prepared for a less than thrilled network connection on that box
[2014-07-17 18:40:13 -0400] shlant: yea I don't think I'll go that far
[2014-07-17 18:40:16 -0400] shlant: yet
[2014-07-17 18:40:17 -0400] shlant: :p
[2014-07-17 18:40:17 -0400] doug2: back to my ruby_block woes. I'm setting node.default[:slice_cme][:latest] = 'foo' inside a ruby block and then immediately after it's unset. y?
[2014-07-17 18:40:36 -0400] bougyman: node.set
[2014-07-17 18:40:41 -0400] doug2: argh!
[2014-07-17 18:40:44 -0400] shlant: doug2: are you trying to access outside the block?
[2014-07-17 18:40:50 -0400] jkeiser: shlant: with_machine_options :bootstrap_options => { ... }, :cached_installer => true, :convergence_options => { :chef_version => ..., :prerelease => ... }
[2014-07-17 18:40:50 -0400] shlant: you need to set it, yea
[2014-07-17 18:41:01 -0400] shlant: jkeiser: alright!
[2014-07-17 18:41:05 -0400] shlant: of I go
[2014-07-17 18:41:06 -0400] shlant: off
[2014-07-17 18:41:07 -0400] doug2: ay carumba
[2014-07-17 18:41:10 -0400] jkeiser: man, this is stuff that needs documenting too.  Grgh
[2014-07-17 18:41:28 -0400] shlant: jkeiser: I will do some this weekend, promise
[2014-07-17 18:41:35 -0400] doug2: which is of course different to how I normally set attributes. ruby. *deep breaths* fluffy kittens...
[2014-07-17 18:41:36 -0400] shlant: go through my IRC logs
[2014-07-17 18:41:42 -0400] shlant: grab all the tidbits
[2014-07-17 18:41:44 -0400] jkeiser: shlant: I really appreciate all you've done so far, it helps people a lot!
[2014-07-17 18:41:59 -0400] doug2: mmm tidbits
[2014-07-17 18:42:04 -0400] shlant: jkeiser: well it's the least I can do for being provided with such an awesome tool
[2014-07-17 18:42:16 -0400] shlant: doug2: you canadian?
[2014-07-17 18:42:33 -0400] doug2: shlant: Aussie
[2014-07-17 18:43:03 -0400] doug2: I'm afraid node.set isn't working either
[2014-07-17 18:43:55 -0400] doug2: http://pastebin.com/bCW1Nugy ... line 19 it's set, line 24 it's disappeared
[2014-07-17 18:46:00 -0400] doug2: How do I set a node attribute inside a ruby_block and access it later outside the ruby block?
[2014-07-17 18:47:19 -0400] Eulipion: doug2: http://www.getchef.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2014-07-17 18:48:20 -0400] doug2: Eulipion: no mention of ruby blocks on that doc
[2014-07-17 18:49:10 -0400] doug2: It looks like, based on this, https://gist.github.com/arangamani/4659646 that I have to set teh value before the block. This is horrible
[2014-07-17 18:49:45 -0400] Eulipion: doug2: i think ur just missing node.save to force a callback
[2014-07-17 18:49:46 -0400] coderanger: doug2: Normally speaking, you don't
[2014-07-17 18:50:03 -0400] coderanger: No, _never_ call node.save during a run (until you know why and can break the rules)
[2014-07-17 18:50:31 -0400] doug2: node.save? never heard of that
[2014-07-17 18:50:49 -0400] doug2: well, node.set inside the ruby block isn't working
[2014-07-17 18:51:06 -0400] doug2: neither is setting it to a temp value before ruby_block
[2014-07-17 18:52:28 -0400] loki97123: hi
[2014-07-17 18:52:56 -0400] loki97123: chef-dk, is there an irc for that specifically?
[2014-07-17 18:53:22 -0400] shlant: loki97123: there are for the individual pirces
[2014-07-17 18:53:24 -0400] shlant: pieces
[2014-07-17 18:53:34 -0400] shlant: but if you need chef-dk help specifically
[2014-07-17 18:53:37 -0400] shlant: you're in the right place
[2014-07-17 18:54:32 -0400] loki97123: finding issues crop up using knife from the chef-dk that do no manifest in the 'plain' version
[2014-07-17 18:54:37 -0400] doug2: b = ruby_block {} b.run_action(:create) ... doesn't work
[2014-07-17 18:55:54 -0400] doug2: not being able to set an attribute and then use it later is as bad as, well... ugh
[2014-07-17 18:55:55 -0400] loki97123: is there a jira for that?
[2014-07-17 18:56:11 -0400] bougyman: doug2: I do that in plenty of recipes.
[2014-07-17 18:56:22 -0400] doug2: bougyman: how?
[2014-07-17 18:56:28 -0400] bougyman: you may be missing an :immediately somewhere, i dunno.
[2014-07-17 18:56:51 -0400] bougyman: it just seems like you're trying to work around the dsl instead of within it.
[2014-07-17 18:57:10 -0400] doug2: i stoped using puppet because of too many dirty hacks. This is a dirty hack.
[2014-07-17 18:57:25 -0400] loki97123: doug2 (i've missed a lot of the conversation and new to this irc thing)  is there a gist of what you are doing?
[2014-07-17 18:57:29 -0400] doug2: actually, tehre's no hack yet, since I have no idea what the solution is
[2014-07-17 18:58:38 -0400] doug2: loki92123: http://pastebin.com/9mmhqyM8 ... line 19 it's set, line 24 it's gone *poof*
[2014-07-17 18:59:01 -0400] hagzag: hi all how can one use knife-ec2 to launch an instance on vpc ?
[2014-07-17 18:59:29 -0400] hagzag: I get and error -> ERROR: Fog::Compute::AWS::Error: InvalidParameterCombination => VPC security groups may not be used for a non-VPC launch
[2014-07-17 19:01:18 -0400] doug2: loki97123: poof... disappeared... deleted... absent...
[2014-07-17 19:02:13 -0400] loki97123: doug2 have you run this in chef-shell -z on your node?
[2014-07-17 19:02:41 -0400] loki97123: there are 2 things, that could be getting you
[2014-07-17 19:02:45 -0400] doug2: loki97123: on the node, vagrant with kitchen
[2014-07-17 19:04:21 -0400] btm: Going to do some Knife plugin Code Review now, want to join? bit.ly/UdqeQj watch: bit.ly/Udqcbp
[2014-07-17 19:05:00 -0400] loki97123: doug2 are you getting a nil during chef-client or are you getting an empty string?
[2014-07-17 19:05:45 -0400] doug2: loki97123: I'm not sure. I was just printing it with p
[2014-07-17 19:06:13 -0400] doug2: actually I was using log. lemme try with p
[2014-07-17 19:06:24 -0400] doug2: no wait, i can't use p in a recipe. inspect I suppose with log
[2014-07-17 19:07:06 -0400] hagzag: anyone knife-ec2 and vpc ?
[2014-07-17 19:07:21 -0400] doug2: loki97123: dunno. inspect just gives me an empty string
[2014-07-17 19:07:39 -0400] loki97123: ok
[2014-07-17 19:07:43 -0400] loki97123: thats cool
[2014-07-17 19:07:57 -0400] loki97123: p in the chef-shell gives you what you are looking for though?
[2014-07-17 19:08:13 -0400] doug2: loki97123: I've never been able to get chef shell to work
[2014-07-17 19:08:56 -0400] doug2: I suppose I could write the attribute to a file in the ruby_block and read it later. *vomit*
[2014-07-17 19:10:22 -0400] loki97123: ok so possibly 2 things
[2014-07-17 19:10:24 -0400] loki97123: well 3 now
[2014-07-17 19:10:25 -0400] doug2: I am finding very few online posts about setting node attributes in ruby blocks. dunno why
[2014-07-17 19:10:27 -0400] doug2: yikes
[2014-07-17 19:10:28 -0400] loki97123: a) dont vomit
[2014-07-17 19:10:36 -0400] loki97123: b) ruby blocks
[2014-07-17 19:10:37 -0400] doug2: i reserve the right to vomit
[2014-07-17 19:10:47 -0400] doug2: loki97123: i need to use teh ruby block
[2014-07-17 19:10:48 -0400] loki97123: so 2 phases to chef thing
[2014-07-17 19:11:13 -0400] loki97123: rubys compiled during compile and then resource is converged and used
[2014-07-17 19:11:14 -0400] doug2: if I don't use the ruby_block, the compile complains the /tmp/maven file doesn't exist
[2014-07-17 19:11:28 -0400] loki97123: yes exactly the file isn't there when that happens
[2014-07-17 19:11:34 -0400] doug2: ^ sigh
[2014-07-17 19:12:01 -0400] loki97123: you want the version from the maven file to set your install path or something right?
[2014-07-17 19:12:10 -0400] doug2: loki97123: Yah
[2014-07-17 19:14:07 -0400] loki97123: i'm looking some of our stuff right now doug2
[2014-07-17 19:14:14 -0400] loki97123: i need about 5 minutes please
[2014-07-17 19:14:34 -0400] doug2: loki97123: of course, thanks for your help
[2014-07-17 19:19:24 -0400] doug2: loki97123: http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation ?
[2014-07-17 19:20:12 -0400] coalbe: is there a supported or documented way to install chef-server on ubuntu 14.04?
[2014-07-17 19:20:30 -0400] coalbe: getchef.com only goes to 12.04
[2014-07-17 19:20:33 -0400] AdnanCloud: anyone used cloudshare for the getting started on chef website?
[2014-07-17 19:20:53 -0400] coalbe: *12.10
[2014-07-17 19:20:57 -0400] AdnanCloud: i cant find where chef is installed or if i do knife --version its not recognised.. anyone used it got any ideas?
[2014-07-17 19:21:41 -0400] loki97123: doug2 i think you are getting hit with your ruby getting compiled up front and so the p/log will write out the value, but setting it as a node normal attribute looks like it could work.  another way would just to be to  set the value to a variable then use that variable in the node assignment
[2014-07-17 19:23:32 -0400] doug2: loki97123: well, varibales defined in the ruby_block disappear from scope. That's what I initially had
[2014-07-17 19:23:50 -0400] loki97123: http://pastebin.com/yTNDMNdM
[2014-07-17 19:23:57 -0400] doug2: loki97123: as for a normal attribute... how? not node.set ?
[2014-07-17 19:24:08 -0400] coalbe: wondering if theres an rpm package i can install, wonder rather not deal with gems
[2014-07-17 19:24:14 -0400] loki97123: yeah node.set is node.normal
[2014-07-17 19:24:21 -0400] loki97123: or versa vice
[2014-07-17 19:24:31 -0400] doug2: loki97123: that pastebin...won't work... that's what I had the first time.
[2014-07-17 19:24:37 -0400] doug2: loki97123: lemme try again
[2014-07-17 19:24:47 -0400] doug2: loki97123: ok, well node.set doesn't work. That's what I have now
[2014-07-17 19:25:27 -0400] loki97123: so
[2014-07-17 19:25:29 -0400] loki97123: another way
[2014-07-17 19:25:34 -0400] doug2: loki97123: nope... tried. vars defied in the ruby_block disappear from scope
[2014-07-17 19:25:45 -0400] reese_: what would cause chef-server not to provide the new version of a cookbook i uploaded? there is no error on `knife cookbook upload`, but in downloading, the new version isn't even listed as an option
[2014-07-17 19:26:11 -0400] loki97123: reese_ do you have a specific version tied in your metadata?
[2014-07-17 19:26:33 -0400] loki97123: oh you are seeing that in chef server
[2014-07-17 19:27:25 -0400] doug2: this is crazy. all i want to do is execute a piece of ruby code and get some data from it. It should not be this hard
[2014-07-17 19:27:50 -0400] bougyman: doug2: you understand chef runs make two passes?
[2014-07-17 19:27:55 -0400] bougyman: first they compile, then they execute?
[2014-07-17 19:28:26 -0400] doug2: cbougyman: that's fine.. At the end of the day, I just want to execute ruby code and use it.
[2014-07-17 19:28:29 -0400] Damm: doug2, can you provide a copy of the code?
[2014-07-17 19:28:31 -0400] Damm: in gist?
[2014-07-17 19:28:45 -0400] Damm: doug2, you can do ruby_block "soemthing" do block do and execute ruby code
[2014-07-17 19:29:05 -0400] doug2: Damm: http://pastebin.com/9mmhqyM8
[2014-07-17 19:29:07 -0400] reese_: loki97123: i'm not sure, i have a '~> 0.2.0', but that shouldn't affect `knife cookbook download`, should it? i updated the metadata.rb to 0.2.1, but even back when i updated the version the client has cached, 0.2.0, the change was not reflected
[2014-07-17 19:29:08 -0400] Damm: doug2, but somethings don't work like regular 'chef' cookbooks so you have to use @ or $ variables
[2014-07-17 19:29:38 -0400] Damm: doug2, yep like line 18
[2014-07-17 19:29:41 -0400] doug2: Damm: @ and $ variables? is that a chef thing or a ruby thing?
[2014-07-17 19:29:50 -0400] loki97123: ruby
[2014-07-17 19:29:56 -0400] doug2: Damm: line 19 the attribute exists. At line 24 it's disappeared
[2014-07-17 19:30:09 -0400] Damm: http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation
[2014-07-17 19:30:22 -0400] doug2: Damn: i saw that but I don't see how I could use that here
[2014-07-17 19:30:29 -0400] Damm: https://gist.github.com/arangamani/4659646
[2014-07-17 19:30:30 -0400] loki97123: Damn doug2 that looks familiar :)
[2014-07-17 19:30:56 -0400] Damm: that's really the best suggestions I can find doug2
[2014-07-17 19:31:02 -0400] doug2: Damm: tried https://gist.github.com/arangamani/4659646 earlier. Didn't seem to work
[2014-07-17 19:31:04 -0400] loki97123: that looks good
[2014-07-17 19:31:23 -0400] doug2: Damm: the lazy stuff is associated with a resource attribute, but this is different
[2014-07-17 19:31:31 -0400] Damm: http://cpenniman.blogspot.com/2013/05/passing-values-from-one-chef-resource.html
[2014-07-17 19:31:56 -0400] scalp42: not even sure how node[:test][:content] = "old content"
[2014-07-17 19:31:58 -0400] scalp42: even works
[2014-07-17 19:32:05 -0400] Damm: why would it?
[2014-07-17 19:32:12 -0400] Damm: it should fail
[2014-07-17 19:32:15 -0400] scalp42: right
[2014-07-17 19:32:18 -0400] Damm: but he's not getting that failure
[2014-07-17 19:32:19 -0400] scalp42: from that gist https://gist.github.com/arangamani/4659646
[2014-07-17 19:32:21 -0400] Damm: he's getting another problem
[2014-07-17 19:32:48 -0400] Damm: and he should get a big fat warning
[2014-07-17 19:32:54 -0400] doug2: Damm: my original problem was that the ruby code that reads /tmp/maven would fail because the remote_file hadn't downloaded it yet. *Sigh* I don't know if there's some way to use the lazy thing with that
[2014-07-17 19:33:16 -0400] Damm: doug2, force the execution order
[2014-07-17 19:33:18 -0400] Damm: it's kind of ugly
[2014-07-17 19:33:21 -0400] scalp42: well
[2014-07-17 19:33:30 -0400] scalp42: make the ruby_block not do anything by default
[2014-07-17 19:33:31 -0400] doug2: Damn: but the remote_file IS before the ruby
[2014-07-17 19:33:32 -0400] Damm: doug2, https://github.com/damm/postgresql/blob/master/recipes/ruby.rb#L30
[2014-07-17 19:33:36 -0400] scalp42: and notifies from remote_file
[2014-07-17 19:33:46 -0400] Damm: well the remote_file should be before the ruby
[2014-07-17 19:33:56 -0400] Damm: but if your having issues with it working right; setup the resource and execute it like above
[2014-07-17 19:34:02 -0400] scalp42: that ruby_code block is running before the rest
[2014-07-17 19:34:12 -0400] Damm: a = remote_file "something" do action :nothing end and then a.run_action(:)
[2014-07-17 19:34:19 -0400] doug2: Damm: sorry no idea what to do with https://github.com/damm/postgresql/blob/master/recipes/ruby.rb#L30
[2014-07-17 19:34:22 -0400] Damm: well a ruby block should be evaluated in order
[2014-07-17 19:34:33 -0400] scalp42: gives me a sec
[2014-07-17 19:34:39 -0400] Damm: doug2, you would setup a dummy resource with an action of nothing and then call it in the next line
[2014-07-17 19:34:45 -0400] doug2: oic
[2014-07-17 19:34:53 -0400] doug2: i think i follow the concept
[2014-07-17 19:34:54 -0400] Damm: doug2, like setup your remote_file as a=
[2014-07-17 19:35:02 -0400] Damm: then if it's action :create
[2014-07-17 19:35:03 -0400] doug2: i'm sure the ruby syntax will confuse me
[2014-07-17 19:35:07 -0400] Damm: a.run_action(:create)
[2014-07-17 19:35:19 -0400] doug2: Damm: where does teh run_action go?
[2014-07-17 19:35:38 -0400] Damm: and that should still work under test-kitchen if you want to converge it
[2014-07-17 19:35:46 -0400] Damm: just not a cookbook I suggest to use as it's old patterns
[2014-07-17 19:35:57 -0400] Damm: a wrapper cookbook should work but .. i don't care to touch that cookbook
[2014-07-17 19:36:00 -0400] doug2: i'm so confused. :(
[2014-07-17 19:36:09 -0400] Damm: doug2, we're calling this at execute time
[2014-07-17 19:36:16 -0400] Damm: doug2, so this runs before the regular run roughly
[2014-07-17 19:36:18 -0400] scalp42: what about this: https://gist.github.com/scalp42/cca620d76363409e8e78
[2014-07-17 19:36:36 -0400] Damm: doug2, basically we're setting a= something which gets evaluated at compile time
[2014-07-17 19:36:51 -0400] Damm: doug2, then we tell that same ruby code to run_action and :create which actually will run that resource
[2014-07-17 19:37:16 -0400] doug2: Damm: ok but no idea how to implement
[2014-07-17 19:37:28 -0400] scalp42: I just gave you a gist doug2
[2014-07-17 19:37:30 -0400] scalp42: if you want to try
[2014-07-17 19:37:43 -0400] doug2: scalp42: That's different to what Damm is suggesting
[2014-07-17 19:37:59 -0400] scalp42: not really
[2014-07-17 19:38:15 -0400] doug2: scalp42: It doesn't have the run_ thing and it doesn't have the a = assignment
[2014-07-17 19:38:21 -0400] scalp42: im out of the discussion carry on :)
[2014-07-17 19:38:23 -0400] loki97123: scalp42 that isn't the issue
[2014-07-17 19:38:30 -0400] loki97123: doug2 has that order
[2014-07-17 19:38:41 -0400] doug2: i swear to god I'm going to ansible when the time is right
[2014-07-17 19:38:43 -0400] Damm: doug2, https://gist.github.com/damm/a37c16a408038c7e3f11
[2014-07-17 19:39:01 -0400] Damm: that's what my clients employee tells me all the time
[2014-07-17 19:39:08 -0400] loki97123: doug2 wants the version from the meta passed out of ruby_block resource, to the following node.attribute resolution
[2014-07-17 19:39:08 -0400] Damm: so we use Docker in those spots to make it less painful for him
[2014-07-17 19:39:37 -0400] doug2: Damm: Thanks. now, when I look at this in 3 months time I'm going to be 'wtf is all this voodoo shit?"
[2014-07-17 19:40:07 -0400] doug2: Damm: they tell you to use ansible?
[2014-07-17 19:40:25 -0400] Damm: nah the employee wants to use ansible
[2014-07-17 19:40:29 -0400] Damm: we just use Dockerfiles or Chef
[2014-07-17 19:40:40 -0400] doug2: i just want something without hacks built on top of hacks. *sigh*
[2014-07-17 19:40:49 -0400] Damm: yeah I was hoping Docker would help with that
[2014-07-17 19:40:51 -0400] Damm: but it won't
[2014-07-17 19:41:11 -0400] Damm: it's way too blistering painful
[2014-07-17 19:41:31 -0400] doug2: sigh
[2014-07-17 19:41:43 -0400] Damm: and as we have people working less together and not working on a common ground
[2014-07-17 19:41:53 -0400] Damm: you get a lot of whimsical opinions with very little point
[2014-07-17 19:42:28 -0400] loki97123: Damn, the thing you show
[2014-07-17 19:42:45 -0400] loki97123: i don't see why you set up the a and the b
[2014-07-17 19:43:01 -0400] loki97123: both already have default actions of create and or run
[2014-07-17 19:43:02 -0400] doug2: I don't think that worked...
[2014-07-17 19:43:05 -0400] Damm: we want them run before hand
[2014-07-17 19:43:11 -0400] Damm: before the ruby_block
[2014-07-17 19:43:19 -0400] Damm: doug2, btw i changed b.run_action(:run) instead of :create
[2014-07-17 19:43:20 -0400] loki97123: it's not going to
[2014-07-17 19:43:24 -0400] Damm: so b might not be working
[2014-07-17 19:43:31 -0400] loki97123: run_action is a dsl
[2014-07-17 19:43:37 -0400] loki97123: which is converge time
[2014-07-17 19:43:40 -0400] loki97123: not run time
[2014-07-17 19:43:43 -0400] doug2: should I laugh or cry?
[2014-07-17 19:43:45 -0400] Damm: try it
[2014-07-17 19:43:51 -0400] Damm: and we're working for converge time
[2014-07-17 19:43:59 -0400] Damm: thanks for making doug2 a bit more confused loki97123
[2014-07-17 19:44:00 -0400] loki97123: remote_file and ruby_block are converget time
[2014-07-17 19:44:04 -0400] doug2: man, my boss doesn't understand the most basic devops principles. what till I try and explain this situation to him....
[2014-07-17 19:44:08 -0400] Damm: i'm going to go get lunch
[2014-07-17 19:44:13 -0400] Damm: this is now officially a waste of time
[2014-07-17 19:44:19 -0400] doug2: Damm: i did. did not work
[2014-07-17 19:44:20 -0400] Damm: sorry I couldn't help more doug2
[2014-07-17 19:44:35 -0400] shlant: YES
[2014-07-17 19:44:38 -0400] shlant: FRIG YES
[2014-07-17 19:45:23 -0400] Damm: doug2, i don't know if this helps but if you need to pull from artifacts maybe https://github.com/riotgames/artifact-cookbook this would be helpful
[2014-07-17 19:45:32 -0400] Damm: likely way off base and i found more unhelpful answers
[2014-07-17 19:45:33 -0400] Damm: :(
[2014-07-17 19:45:53 -0400] doug2: Damm: pulling form artifacts isn't hard. it's just a straight URL
[2014-07-17 19:45:58 -0400] doug2: that's the easy bit
[2014-07-17 19:46:05 -0400] Damm: yep
[2014-07-17 19:46:14 -0400] doug2: yep, did a new converge. same error as before
[2014-07-17 19:46:21 -0400] doug2: well, rathre, the attribute is not set
[2014-07-17 19:47:40 -0400] doug2: so, it would seem that using ruby to obtain info from the OS is completely impossible
[2014-07-17 19:48:09 -0400] bougyman: no, it isn't.
[2014-07-17 19:48:14 -0400] troyready: Please move to ansible
[2014-07-17 19:48:19 -0400] troyready: Or back to puppet
[2014-07-17 19:48:37 -0400] loki97123: @doug2 have you tried moving this in to an lwrp that uses your ruby block in to a library
[2014-07-17 19:48:38 -0400] troyready: I bet they'd be much easier to use
[2014-07-17 19:48:43 -0400] doug2: bougyman: if you can provide any references, I'd be overjoyed
[2014-07-17 19:48:59 -0400] doug2: loki97123: no, but I did read a blog post where someone tried that and it did not work
[2014-07-17 19:49:04 -0400] bougyman: doug2: the link Damm gave you explained how.
[2014-07-17 19:49:14 -0400] doug2: bougyman: which link?
[2014-07-17 19:49:17 -0400] bougyman: and why it doesn't work the way you are trying to do it.
[2014-07-17 19:49:28 -0400] doug2: bougyman: his pastebin did not work
[2014-07-17 19:50:12 -0400] bougyman: http://cpenniman.blogspot.com/2013/05/passing-values-from-one-chef-resource.html
[2014-07-17 19:54:23 -0400] doug2: what the heck is line #17 doing?
[2014-07-17 19:54:58 -0400] doug2: update_target doesn't exist until it's looked up at line 17
[2014-07-17 19:55:06 -0400] doug2: how can that work?
[2014-07-17 19:55:11 -0400] doug2: bougyman: ^
[2014-07-17 19:55:35 -0400] bougyman: I gotta run.
[2014-07-17 19:55:39 -0400] bougyman: just try it.
[2014-07-17 19:56:16 -0400] doug2: bougyman: well without a frame of reference, I don't know what to change it to to make it work in my context
[2014-07-17 19:56:32 -0400] zts: because the code in the block (16 - 19) doesn't get evaluated until the converge phase, which comes after line 23 is compiled (adding the log resource to the run list)
[2014-07-17 19:57:12 -0400] doug2: zts: I'm talking about http://cpenniman.blogspot.com/2013/05/passing-values-from-one-chef-resource.html
[2014-07-17 19:57:53 -0400] doug2: "chef is just ruby"*.   (* but you can't use the variables set by ruby)
[2014-07-17 19:58:23 -0400] zts: doug2: indeed, that is what I was referring to
[2014-07-17 19:58:26 -0400] loki97123:  putting the ruby inside a ruby_block causes that code to be executed at converge time (i believe0
[2014-07-17 19:58:46 -0400] doug2: I was asking what update_target at line 17 is?
[2014-07-17 19:59:08 -0400] loki97123: right
[2014-07-17 19:59:15 -0400] zts: loki97123: that is correct
[2014-07-17 19:59:16 -0400] doug2: update_target isnt' defined anywhere prior to that
[2014-07-17 19:59:27 -0400] loki97123: yes doug2
[2014-07-17 19:59:41 -0400] doug2: and later, update_target is referenced but not log[update_target] so I really don't know what's going on
[2014-07-17 20:00:01 -0400] loki97123: chef runs through, then where it would normally just compile the ruby, then compile the log bit all in to a run list
[2014-07-17 20:00:18 -0400] doug2: loki97123: yes, I got that
[2014-07-17 20:00:42 -0400] loki97123: but because we stuck the ruby in to a ruby_block, chef inserts that resouce in to the run list with a compiled in reference to the log resource at compile time
[2014-07-17 20:00:47 -0400] loki97123: a forward reference
[2014-07-17 20:01:09 -0400] doug2: why the log reference?
[2014-07-17 20:01:21 -0400] doug2: why not the barbie or fred flintstone reference? what's the rationale behind that?
[2014-07-17 20:01:39 -0400] loki97123: so that when the ruby bit runs at converge time it already knows ...
[2014-07-17 20:02:09 -0400] loki97123: we could name it anything
[2014-07-17 20:02:11 -0400] zts: http://serverfault.com/a/604977/140520 # my attempt to break down what is happening in an example much like the one you linked
[2014-07-17 20:02:58 -0400] doug2: zts: not light reading
[2014-07-17 20:03:34 -0400] zts: it's not a light subject, but you may find it easier to understand when the process is broken down into smaller parts
[2014-07-17 20:03:51 -0400] doug2: if the ruby_block means that it's executed at the same time as the recipe... then why do ruby block variables go out of scope?
[2014-07-17 20:03:53 -0400] zts: or you might not - as I said, it's just an attempt to explain a tricky problem
[2014-07-17 20:04:17 -0400] doug2: zts: getting variables from ruby code, when chef is 'just ruby'... that tricky problem?
[2014-07-17 20:04:51 -0400] zts: if scoping and execution order weren't tricky problems, this question wouldn't come up so often
[2014-07-17 20:05:35 -0400] doug2: zts: wouldn't be tricky if it exexcuted things in the order they where transcribed. That's why I dumped puppet
[2014-07-17 20:06:15 -0400] zts: not the only reason, I hope - else you'll have to dump Chef too!
[2014-07-17 20:06:32 -0400] doug2: anyway, at this point I don't think i even want a hack, because a few months from now it will make no sense. I need to find another way to get data from this maven file before downloading that version of teh package from artifactory
[2014-07-17 20:07:17 -0400] bougyman: what you're trying to do is hard.
[2014-07-17 20:07:19 -0400] bougyman: you're making it hard.
[2014-07-17 20:07:27 -0400] bougyman: er what you're trying to do _isn't_ hard
[2014-07-17 20:07:48 -0400] doug2: bougyman: your right, running some ruby code to get a piece of data from a file should not be hard
[2014-07-17 20:07:52 -0400] bougyman: your resources have access to the file itself on disk.
[2014-07-17 20:07:58 -0400] bougyman: remote_file "get the file"
[2014-07-17 20:08:07 -0400] bougyman: some_other_resource "use the data from that file"
[2014-07-17 20:08:15 -0400] doug2: bougyman: it's in xml format...
[2014-07-17 20:08:23 -0400] bougyman: I understand that.
[2014-07-17 20:08:27 -0400] loki97123: zts how  about something like this?
[2014-07-17 20:08:36 -0400] doug2: bougyman: some_other_resource is?
[2014-07-17 20:08:55 -0400] loki97123: http://pastebin.com/ZMPvQYL5
[2014-07-17 20:09:01 -0400] bougyman: something that reads and uses the data from that file
[2014-07-17 20:09:17 -0400] doug2: cbougyman: but then it will have to use a ruby_block. Won't it have the same issue?
[2014-07-17 20:09:32 -0400] bougyman: not if you read from the file directly.
[2014-07-17 20:09:52 -0400] doug2: bougyman: resources can read from the node?
[2014-07-17 20:10:10 -0400] loki97123: there are not too many examples of using a ruby_block to set a node attribute
[2014-07-17 20:10:53 -0400] zts: loki97123: yeah, I'd expect that approach to work
[2014-07-17 20:10:56 -0400] doug2: loki97123: ok... if you had to get something from a local file and feed that back into a resource, without ruby, how would you do it?
[2014-07-17 20:11:33 -0400] loki97123: i just posted another gist
[2014-07-17 20:11:45 -0400] doug2: loki97123: saw that. saw lwrp. never could get those to work
[2014-07-17 20:12:18 -0400] loki97123: that is really the only way
[2014-07-17 20:12:26 -0400] doug2: loki97123: :(
[2014-07-17 20:12:29 -0400] loki97123: there are quite a few example of that type of noise
[2014-07-17 20:12:36 -0400] loki97123: yeah lwrps are "scary"
[2014-07-17 20:13:07 -0400] doug2: sorry, that gist makes no real sense to me
[2014-07-17 20:13:15 -0400] doug2: lack of docs on lwrp's
[2014-07-17 20:13:16 -0400] loki97123: i'll see if i can't hack a full recipe up that does "in essence" of what you want
[2014-07-17 20:13:27 -0400] doug2: tanx
[2014-07-17 20:13:28 -0400] loki97123: and provide the entire thing
[2014-07-17 20:14:03 -0400] doug2: a pointer to some good (not written by the chef folks) docs might be useful
[2014-07-17 20:14:14 -0400] rbowlby: what's the right resource when sourcing a file over http
[2014-07-17 20:14:30 -0400] loki97123: rbowlby
[2014-07-17 20:14:37 -0400] loki97123: remote_file
[2014-07-17 20:14:57 -0400] loki97123: but it also depends on what you are source
[2014-07-17 20:14:58 -0400] rbowlby: much abliged
[2014-07-17 20:14:59 -0400] loki97123: sourcing
[2014-07-17 20:15:05 -0400] rbowlby: .zip over http
[2014-07-17 20:16:02 -0400] loki97123: oooh
[2014-07-17 20:16:14 -0400] loki97123: try the ark cookbook/recipe/resource
[2014-07-17 20:16:27 -0400] loki97123: but if you want to deal with the resource yourself
[2014-07-17 20:16:30 -0400] loki97123: yes remote_file
[2014-07-17 20:17:30 -0400] doug2: Argh it would help if http://dougireton.com/blog/2013/01/07/creating-an-lwrp-part-2/ would tell me where to put the files. Fail.
[2014-07-17 20:18:22 -0400] loki97123: so lwrps
[2014-07-17 20:18:57 -0400] loki97123: resource is your interface, goes under cookbookname/resources/my_resource.rb
[2014-07-17 20:19:06 -0400] doug2: k
[2014-07-17 20:19:24 -0400] loki97123: provider is your implementation, goes under cookbookname/providers/my_resource.rb
[2014-07-17 20:19:43 -0400] loki97123: name of the file is the name of your lwrp
[2014-07-17 20:19:49 -0400] loki97123: be catchy yet pithy
[2014-07-17 20:20:44 -0400] doug2: :-\
[2014-07-17 20:22:09 -0400] doug2: What are the @ references at http://dougireton.com/blog/2013/01/07/creating-an-lwrp-part-2/ ?
[2014-07-17 20:22:27 -0400] acomar: hi all, trying to figure out if something is possible or if anyone has worked out a way to do already. We're trying to verify that node attributes that are overriden in an environments file (in override_attributes) actually line up with an attribute from an attributes file (i.e. catch typos).
[2014-07-17 20:22:30 -0400] acomar: Any ideas?
[2014-07-17 20:22:37 -0400] a13x212: how can i force chef_gems to load later in the chef run?
[2014-07-17 20:23:25 -0400] loki97123: acomar what are you overriding in the environment  just an example
[2014-07-17 20:23:39 -0400] loki97123: a13x212 how much later?
[2014-07-17 20:23:59 -0400] loki97123: doug2 the @ is a ruby thing
[2014-07-17 20:24:28 -0400] acomar: loki97123: say I set default[:tomcat][:port] = "8080" in attributes/default.rb in a cookbook
[2014-07-17 20:24:30 -0400] doug2: loki97123: meaning?
[2014-07-17 20:24:47 -0400] doug2: loki97123: i dropped files into providers and resources. tried to access in recipe... it can't find it
[2014-07-17 20:24:49 -0400] loki97123: looking doug cause i'm oging to say it wrong
[2014-07-17 20:25:12 -0400] acomar: loki97123: and then attempt to set override_attributes({tomact: port: 80})
[2014-07-17 20:25:28 -0400] loki97123: acomar, a default in the environment or roles will update that as needed
[2014-07-17 20:25:31 -0400] loki97123: but
[2014-07-17 20:25:46 -0400] loki97123: if you know prod is always 80
[2014-07-17 20:25:51 -0400] a13x212: i would like it to run when the recipe is called, right now it runs at the beginning of the run
[2014-07-17 20:25:55 -0400] acomar: loki97123: We'd like to catch that typo at test time, or at least at recipe run time
[2014-07-17 20:25:58 -0400] loki97123: then in the recipe update the attribute
[2014-07-17 20:26:11 -0400] acomar: it's more complicated than that, I'm just providing a simple example
[2014-07-17 20:26:17 -0400] doug2: sigh... this lwrp doc is making no sense to me
[2014-07-17 20:26:18 -0400] loki97123: acomar thats the issue with repeating yourself
[2014-07-17 20:26:29 -0400] loki97123: working on it doug2
[2014-07-17 20:26:31 -0400] doug2: So for our bare minimum load_current_resource method, we need to set @current_resource to an instance of Chef::Resource::WindowsPrinterPort ... english?
[2014-07-17 20:27:02 -0400] acomar: loki9723: we're trying to reduce duplication as much as possible because it's already caused prod issues and is causing maintainence problems
[2014-07-17 20:27:26 -0400] doug2: Why are there no docs on writing lwrps?!??
[2014-07-17 20:27:44 -0400] loki97123: doug2 its either an instance variable or class variable
[2014-07-17 20:28:24 -0400] loki97123: doug2
[2014-07-17 20:28:26 -0400] loki97123: http://docs.opscode.com/chef/lwrps_custom.html
[2014-07-17 20:28:48 -0400] loki97123: oh thats how you got to ireton
[2014-07-17 20:29:02 -0400] x0nic: does anyone know a good way to bootstrap with knife solo and passing envronment variables along without having to edit the node file? I tried: knife solo bootstrap vagrant@vagrantup.local -j '{"aws_secret_access_key": "$AWS_SECRET_ACCESS_KEY" }'
[2014-07-17 20:29:49 -0400] doug2: loki97123: thanks but it doesn't tell me how to write a lwrp
[2014-07-17 20:30:52 -0400] doug2: do I have to implement whyrun_supported? is it mandatory?
[2014-07-17 20:31:13 -0400] loki97123: no you do not
[2014-07-17 20:31:18 -0400] doug2: What about load_current_resource? Is that mandatory? Can I leave it out?
[2014-07-17 20:31:37 -0400] loki97123: so i was discussing with Sascha and Adam about this
[2014-07-17 20:32:04 -0400] loki97123: load_current_resource is a method by which you pull in what the resource currently looks like on the system
[2014-07-17 20:32:13 -0400] loki97123: (getting its values)
[2014-07-17 20:32:26 -0400] loki97123: then your new_resource can do things "intelligently"
[2014-07-17 20:32:50 -0400] doug2: ok, well chef tells me it can't find my lwrp
[2014-07-17 20:32:56 -0400] loki97123: the lwrp you are creating is really just to install the "correct" rpm based on a maven metadata file
[2014-07-17 20:33:11 -0400] loki97123: so no load current resource is needed
[2014-07-17 20:33:19 -0400] loki97123: can you gist me what you have done?
[2014-07-17 20:33:39 -0400] vickleford: anybody have recommendations for bootstrapping chef-client on EC2 nodes through a cloudformation template in a DRY manner across a bunch of unrelated templates?
[2014-07-17 20:34:36 -0400] loki97123: vickleford, if you find this ping me
[2014-07-17 20:34:46 -0400] doug2: loki92123: http://pastebin.com/2GADcpj9
[2014-07-17 20:38:33 -0400] sauraus: Does the 'bash/script' resource actually run scripts using the 'user' specified?
[2014-07-17 20:38:34 -0400] loki97123: doug2 are the sections in there in seperate files in the cookbook?
[2014-07-17 20:38:47 -0400] doug2: loki97123: sections?
[2014-07-17 20:38:53 -0400] loki97123: sorry man
[2014-07-17 20:38:56 -0400] doug2: loki97123: just where I called cat
[2014-07-17 20:39:06 -0400] loki97123: i was reading it wrong
[2014-07-17 20:39:09 -0400] doug2: np
[2014-07-17 20:40:02 -0400] doug2: grabbing tea... and maybe a xanax too
[2014-07-17 20:40:12 -0400] loki97123: aight and good
[2014-07-17 20:40:38 -0400] doug2: nooo. i'm back
[2014-07-17 20:43:41 -0400] doug2: do I need to prefix call to lwrp with cookbook name?
[2014-07-17 20:44:51 -0400] doug2: i just cant understand why there are no resources on lwrps?
[2014-07-17 20:46:15 -0400] shlant: jkeiser: what would the cpu usage be like on metal masters? would t1.micro instances be sufficient? Not sure what kind of resources chef uses
[2014-07-17 20:46:49 -0400] jkeiser: shlant: network usage is much more of a thing here, I imagine.
[2014-07-17 20:47:20 -0400] jkeiser: shlant: I wish I had a good answer for you on whether chef in general is great on t1.micro; I haven't done complex things with it on those
[2014-07-17 20:48:34 -0400] loki97123: doug2 still working on the thing
[2014-07-17 20:59:35 -0400] JoshZ_: jkeiser: chef metal is failing to pull attributes from the attributes folder in the same cookbook... is this intentional?
[2014-07-17 21:00:16 -0400] jkeiser: JoshZ_: you mean, the metal cookbooks with the machine resource are expecting to read some attributes from the metal cookbooks' attributes directory, and aren't?
[2014-07-17 21:00:21 -0400] jkeiser: JoshZ_: how are you running it?
[2014-07-17 21:01:11 -0400] JoshZ_: jkeiser: locally.. with chef-client -z
[2014-07-17 21:01:29 -0400] doug2: loki97123: ditto. :)
[2014-07-17 21:02:05 -0400] jkeiser: JoshZ_: if you run chef-client -z cookbooks/x/recipes/myrecipe.rb, it won't read in attributes
[2014-07-17 21:02:06 -0400] JoshZ_: and I am trying to pull attributes that I have set in my atr file and the recipe is not finding those atrs?
[2014-07-17 21:02:13 -0400] jkeiser: JoshZ_: what is the whole command line?
[2014-07-17 21:02:30 -0400] JoshZ_: chef-client -z recipes/sensu_metal.rb
[2014-07-17 21:02:59 -0400] jkeiser: yep.  You need to run it like chef-client -z cookbookname::sensu_metal to pick up all the surrounding cookbook goo
[2014-07-17 21:03:21 -0400] jkeiser: you might be able to run chef-client -z attributes/* recipes/sensu_metal.rb for a cheap way around it, but I'm not 100% sure
[2014-07-17 21:03:50 -0400] JoshZ_: *testing..
[2014-07-17 21:07:10 -0400] Eulipion: anyone know how to fix this vagrant/berks error? http://pastebin.com/hQJ67AW8
[2014-07-17 21:07:42 -0400] doug2: Any docs for LWRP creation?
[2014-07-17 21:10:40 -0400] doug2: Any docs for LWRP creation?
[2014-07-17 21:12:52 -0400] loki97123: doug2
[2014-07-17 21:13:02 -0400] doug2: loki97123
[2014-07-17 21:13:05 -0400] loki97123: i'm getting the vagrant together so it will work
[2014-07-17 21:13:06 -0400] loki97123: :)
[2014-07-17 21:13:51 -0400] doug2: loki97123: I'm trying to find docs and failing miserably...
[2014-07-17 21:18:48 -0400] Eulipion: anyone know how to get vagrant-aws working?  I'm getting vagrant/env_helpers.rb:51:in `berkshelf_enabled?': undefined method `berkshelf' for nil:NilClass (NoMethodError)
[2014-07-17 21:19:11 -0400] doug2: loki97123: it looks like, based on the code I am reading, that to access a LWRP it's $cookbookname_$name ?
[2014-07-17 21:22:06 -0400] doug2:  yes, I believe that's true. Whoever wrote the docs, you failed
[2014-07-17 21:25:04 -0400] gchristensen: doug2: its a community effort
[2014-07-17 21:25:47 -0400] doug2: This is insane. I wanted to call some ruby code to get some data. Due to compile/converge issues I've been told to use a LWRP. Well, now I find out that I since I've prefixed my cookbooks with foo-, and you call a LWRP with the cookbook name at the front, followed by an underscore, that this won't work. Chef doesn't like the '-'
[2014-07-17 21:27:28 -0400] doug2: So, how do I fix this? How do I use lwrp's when my cookbooks have dashes in the name?
[2014-07-17 21:27:40 -0400] zts: replace the dashes with underscores
[2014-07-17 21:27:52 -0400] zts: in your recipe, I'm not suggesting you rename the cookbook
[2014-07-17 21:28:28 -0400] doug2: zts: works, ugly, but thanks. Works.
[2014-07-17 21:29:36 -0400] doug2: so, now, if I put my ruby in the lwrp provider, all my problems will magically disappear?
[2014-07-17 21:31:06 -0400] doug2: now I'm getting undefined method `read' for Chef::Provider::File:Class
[2014-07-17 21:32:47 -0400] doug2: xml = ::File.read('/tmp/maven-metadata.xml') works...  while xml = File.read('/tmp/maven-metadata.xml') does not. whatever
[2014-07-17 21:32:51 -0400] grayhemp: hi all. how can I do this "override['postgresql']['pg_hba'] = [...]" in a role file?
[2014-07-17 21:32:58 -0400] doug2: it's ruby. don't question the voodoo
[2014-07-17 21:33:31 -0400] troyready: Oh hey, random baseless ruby whining
[2014-07-17 21:33:43 -0400] troyready: I can only imagine what channel I'm in and who is talking
[2014-07-17 21:34:40 -0400] doug2: troyready: could you kindly explain why putting :: in front of File works?
[2014-07-17 21:34:53 -0400] shlant: grayhemp: it's not usually  best practice to have attributes in roles
[2014-07-17 21:35:04 -0400] shlant: the better pattern would be wrapper cookbooks
[2014-07-17 21:35:10 -0400] shlant: and have the attribute in there
[2014-07-17 21:35:32 -0400] doug2: troyready: i've been trying to get a piece of data from ruby and pass it back to the recipe for 6 hours. That's hardly baseless.
[2014-07-17 21:36:09 -0400] zts: troyready:)
[2014-07-17 21:36:13 -0400] shlant: troyready: but if you want to: "override_attributes": { "foo": "bar", "blah": "apple" }
[2014-07-17 21:37:13 -0400] doug2: I put the ruby code into an lwrp... i know it's executing. it's setting node.set[:slice_cme][:latest]. It's not in the recipe. What am I doing wrong?
[2014-07-17 21:37:44 -0400] shlant: grayhemp: but if you want to: "override_attributes": { "foo": "bar", "blah": "apple" }
[2014-07-17 21:38:39 -0400] troyready: troyready, re: the File class, I'm not totally sure what the nature of the namespace issue is that requires ::File.read
[2014-07-17 21:38:48 -0400] troyready: I suspect it's not voodoo, but I could be wrong
[2014-07-17 21:39:02 -0400] Eulipion: doug2: http://www.getchef.com/blog/2013/09/04/demystifying-common-idioms-in-chef-recipes/
[2014-07-17 21:39:43 -0400] doug2: Eulipion: nifty
[2014-07-17 21:39:52 -0400] doug2: now... if I could just set an attribute inside an LWRP...
[2014-07-17 21:41:01 -0400] Damm: damn docker got praise today
[2014-07-17 21:41:02 -0400] Damm: :(
[2014-07-17 21:41:07 -0400] Damm: that's going to ruin my week
[2014-07-17 21:41:22 -0400] shlant: Damm: how so
[2014-07-17 21:41:55 -0400] Damm: I deployed hubot with docker; hubot was broken with no response earlier and based on documentation the owner restarted hubot and fixed it
[2014-07-17 21:42:21 -0400] Damm: hubot is easy in docker
[2014-07-17 21:42:32 -0400] doug2: maybe to get around the fact chef can't retrieve data from the OS with ruby and pass it back to the recipe I can put the data I need into an S3 bucket and upload it and then pull it down in the cookbook
[2014-07-17 21:43:01 -0400] shlant: Damm: a bunch of things are
[2014-07-17 21:43:21 -0400] Damm: yep yep but the move away from lxc has kind of bitten me a few times
[2014-07-17 21:43:24 -0400] Damm: upgrades are not seamless
[2014-07-17 21:43:31 -0400] Damm: so I end up just deploying coreos for those bits
[2014-07-17 21:43:40 -0400] JoshZ_: jkeiser: chef-client -z -o cookbook::recipe works
[2014-07-17 21:43:42 -0400] Damm: less pain
[2014-07-17 21:44:07 -0400] doug2: Are there any docs on writing lwrp's?
[2014-07-17 21:44:13 -0400] grayhemp: shlant: in my case I need to override everything that in under the 'pg_hba' key that is under the 'postgresql' ony. wouldn't  overrde_attributes('postgresql' => {'pg_hba' => []}) override everything that is under 'postgresq'?
[2014-07-17 21:44:36 -0400] jkeiser: JoshZ_: awesome!  At some point I want to upgrade -z so it will autodetect load attributes and stuff ... but I want to write a ruby compiler in Go, too, and I'm not doing that today either :)
[2014-07-17 21:45:00 -0400] Damm: doug2, http://docs.opscode.com/lwrp.html
[2014-07-17 21:45:10 -0400] Damm: doug2, reading from examples is very helpful too
[2014-07-17 21:45:30 -0400] Damm: in fact it's my primary cookbook method now
[2014-07-17 21:46:05 -0400] doug2: Damm: I've read a few exmaples, and now I've seen so far actually seem to set any data to be used later in the recipe. Those chef docs are terrible btw
[2014-07-17 21:46:16 -0400] JoshZ_: jkeiser: haha well thank you for your help all the time!!! I am hoping when things slow down here (if chef-metal is still lacking docs) we can assist in that.
[2014-07-17 21:46:24 -0400] Damm: doug2, I don't really write lwrp's to set node attributes
[2014-07-17 21:46:35 -0400] shlant: grayhemp: no it would just overwrite the specific attribute
[2014-07-17 21:46:42 -0400] loki97123: doug2 do you dropbox?
[2014-07-17 21:46:59 -0400] grayhemp: shlant: great, thank you
[2014-07-17 21:47:06 -0400] doug2: loki97123: no... y?
[2014-07-17 21:47:07 -0400] Damm: doug2, I gaveup with complex attributes awhile back and just started passing json data in
[2014-07-17 21:47:14 -0400] shlant: grayhemp: how do you have it set up though? are you include_recipeing postgresql in a custom cookbook?
[2014-07-17 21:47:23 -0400] doug2: Damm: not sure that applies here
[2014-07-17 21:47:23 -0400] Damm: sometimes you spend more time in the window dressing of attributes
[2014-07-17 21:47:39 -0400] Damm: like the scribe lwrp i wrote awhile back
[2014-07-17 21:47:51 -0400] loki97123: doug2 Damn is right
[2014-07-17 21:47:54 -0400] Damm: trying to describe every single attribute that could be in scribe.conf and declare it
[2014-07-17 21:47:57 -0400] Damm: it's hard
[2014-07-17 21:48:03 -0400] loki97123: we get too hung up on attributes
[2014-07-17 21:48:08 -0400] Damm: yep yep
[2014-07-17 21:48:19 -0400] loki97123: we don't need all attributes
[2014-07-17 21:48:26 -0400] Damm: the less attributes used
[2014-07-17 21:48:27 -0400] Damm: the better
[2014-07-17 21:48:32 -0400] doug2: Damm: I just need to read some xml from a file grabbed from a url, and then request that file from a different URL
[2014-07-17 21:48:38 -0400] geggam: put attributes in databags
[2014-07-17 21:48:49 -0400] shlant: ew databags
[2014-07-17 21:48:57 -0400] Damm: let's not go there
[2014-07-17 21:49:00 -0400] loki97123: please
[2014-07-17 21:49:01 -0400] doug2: this has to be retrieved when chef is run.
[2014-07-17 21:49:02 -0400] shlant: ahah
[2014-07-17 21:49:12 -0400] doug2: from an artifactory server
[2014-07-17 21:49:19 -0400] Damm: so you need a remote_file block
[2014-07-17 21:49:26 -0400] Damm: to read your xml
[2014-07-17 21:49:35 -0400] Damm: but what do you really expect to do with this doug2 ?
[2014-07-17 21:49:36 -0400] doug2: Damm: yep, got that
[2014-07-17 21:50:11 -0400] doug2: Damm: we've come full circle. The ruby code fails to read the xml file because the remote_file runs in the converge phase, after the ruby code
[2014-07-17 21:50:14 -0400] Damm: doug2, the better suggestion is to specify the latest
[2014-07-17 21:50:20 -0400] Damm: instead of grabbing it from a repo blindly
[2014-07-17 21:50:28 -0400] Damm: so chef can know what directory to look at
[2014-07-17 21:50:33 -0400] doug2: Damm: That's what I am trying to do
[2014-07-17 21:50:40 -0400] Damm: so instead of reading it from an xml
[2014-07-17 21:50:42 -0400] Damm: you just specify it
[2014-07-17 21:51:00 -0400] doug2: Damm: I don't believe artifactory will support that
[2014-07-17 21:51:03 -0400] Damm: simple node attribute
[2014-07-17 21:51:09 -0400] Damm: you can change it with chef-client -j
[2014-07-17 21:51:14 -0400] Damm: and pass in the new value with json
[2014-07-17 21:51:26 -0400] grayhemp: shlant: yes I created a wrapper cookbook of the community postgresql cookbook, and I have several servers where I have postgres and several roles for each type (postgres-dev, postgres- prod, postgres-reporting). there might be several servers using the same role. So I customize attributes in roles.
[2014-07-17 21:51:38 -0400] Damm: { "foo_cme": { "latest": "sha" }, }
[2014-07-17 21:51:39 -0400] Damm: or whatever
[2014-07-17 21:51:43 -0400] Damm: very complex
[2014-07-17 21:51:46 -0400] Eulipion: doug2: seems like either this file is specific to an app, in which case you should statically define it in ur attributes file and every change will be versioned.  or u just need to get a url and wget it, in which case write a script, drop it on disk, and run it.
[2014-07-17 21:52:02 -0400] shlant: jkeiser: I just created and deployed 3 separate ruby apps, each with 2 web servers, 1 redis server and 1 db all under their own LB's with one knife ec2 command. You are my hero
[2014-07-17 21:52:11 -0400] jkeiser: holy awesome!!!
[2014-07-17 21:52:13 -0400] Eulipion: but if ur app depends on it, dont blindly get it
[2014-07-17 21:52:24 -0400] doug2: Damm: so your saying I'd have to wrap the chef-client call in a script that gets the version, and then uses knife ... and then calls chef. Err, Yuck?
[2014-07-17 21:52:54 -0400] Damm: doug2, how you set the attribute can be in a ruby script; passed in via chef-client
[2014-07-17 21:52:57 -0400] shlant: jkeiser: I think you got me excited enough that I should do a talk on the awesomeness that is metal
[2014-07-17 21:52:57 -0400] Damm: or other ways
[2014-07-17 21:53:22 -0400] Damm: doug2, chef-client -j can pull from a remote location so you can have it pull a json file with this data even
[2014-07-17 21:53:23 -0400] jkeiser: shlant: please do!  I'm so glad it's helping!
[2014-07-17 21:53:24 -0400] shlant: jkeiser: will there be presentation registration open for the developer conf?
[2014-07-17 21:53:35 -0400] doug2: Damm: it's xml, but...
[2014-07-17 21:53:36 -0400] Damm: https://github.com/buglabs/node-xml2json
[2014-07-17 21:53:43 -0400] Damm: that's ridiculus
[2014-07-17 21:53:45 -0400] Damm: lol
[2014-07-17 21:53:54 -0400] doug2: sigh. lemme try this. back in... 5
[2014-07-17 21:54:06 -0400] shlant: community conf *
[2014-07-17 21:54:09 -0400] jkeiser: shlant: the Chef Summit?  Or ChefConf?  Summit is open spaces so it's not so much with the talky (unless it changes format this year, dunno).  ChefConf speaker stuff will open later this year
[2014-07-17 21:54:49 -0400] shlant: maybe I'll start with an open space and see if I'm up for a full presentation :p
[2014-07-17 21:54:51 -0400] j^2: shlant: the open spaces last year at summit where the bomb
[2014-07-17 21:54:58 -0400] j^2: i learned so much it was unreal
[2014-07-17 21:54:58 -0400] jkeiser: cool :)  I love the open spaces
[2014-07-17 21:55:01 -0400] jkeiser: same here
[2014-07-17 21:55:35 -0400] shlant: when do you figure summit registration will open?
[2014-07-17 21:55:40 -0400] shlant: or is there even registration?
[2014-07-17 21:55:46 -0400] j^2: summit.getchef.com
[2014-07-17 21:56:10 -0400] shlant: "more information to come"
[2014-07-17 21:56:16 -0400] shlant: *looks at jkeiser*
[2014-07-17 21:56:28 -0400] j^2: <-- works for CHEF too :)
[2014-07-17 21:56:38 -0400] jkeiser: I don't honestly know :)  I just get to write code for a living
[2014-07-17 21:56:47 -0400] jkeiser: But pretty sure it's all open spaces, looks like anyway
[2014-07-17 21:56:57 -0400] shlant: *crazy eye to j^2*
[2014-07-17 21:57:09 -0400] shlant: but will there be a cost other than hotel?
[2014-07-17 21:57:58 -0400] j^2: shlant: http://glui.me/?i=z5gs3axduq4vd1c/2014-07-17_at_4.57_PM.png/ thats me before i got hired at CHEF
[2014-07-17 21:58:15 -0400] shlant: haha awesome
[2014-07-17 21:59:57 -0400] geggam: is working for chef street cred
[2014-07-17 22:00:55 -0400] loki97123: @Damn and @doug2 here is how i would do the thing doug2 is trying to do
[2014-07-17 22:00:57 -0400] loki97123: http://pastebin.com/mAeKxPUX
[2014-07-17 22:01:59 -0400] doug2: loki97123: Does that work for you?
[2014-07-17 22:02:29 -0400] loki97123: i ran it through my vagrant and the logging bit says it will
[2014-07-17 22:03:03 -0400] doug2: what's library_method?
[2014-07-17 22:03:10 -0400] loki97123: i was hoping @Damn would weigh in
[2014-07-17 22:03:23 -0400] loki97123: there is a library defined as well
[2014-07-17 22:03:32 -0400] loki97123: it is what is doing your ruby block
[2014-07-17 22:04:39 -0400] doug2: loki97123: I think I'm gonna have to go to chef-client -j. I just don't like all the implied voodoo in the lwrp approach
[2014-07-17 22:05:43 -0400] mikedodge04: in ohai 6 you use to be able to run one plugin with -f, is there a way to do that in ohai 7?
[2014-07-17 22:07:18 -0400] Damm: doug2, basically you should be setting the version
[2014-07-17 22:08:06 -0400] Damm: people deploy from master commonly; it's not great.  as your dealing with an xml file the best way to pass it in without voodoo is let Chef read it as json
[2014-07-17 22:08:49 -0400] Damm: might require you to write an servlet but depending on your programming experience writing up an spot to drop the customized json blob shouldn't be that bad.  If you can specify the version that's the best way to go
[2014-07-17 22:09:08 -0400] Damm: you can automate this using the chef gem in a ruby script to set the node attribute and save the node then converge
[2014-07-17 22:09:17 -0400] Damm: or if you prefer python I think pychef should still work
[2014-07-17 22:09:18 -0400] loki97123: @Damm will you critique the gist i posted?
[2014-07-17 22:09:18 -0400] doug2: Damm: I'm just gonna have my jenkins job get it and pass it in
[2014-07-17 22:09:36 -0400] doug2: which makes my testing harder, but meh. *sigh*
[2014-07-17 22:10:14 -0400] doug2: pass it to chef-client is pretty ghetto i think
[2014-07-17 22:10:33 -0400] loki97123: so do i and i don't agree with hard wiring the version you want
[2014-07-17 22:10:47 -0400] loki97123: but it will get you past your issue
[2014-07-17 22:10:50 -0400] doug2: but when you've spent 6 hours trying to assign a variable, ghetto doesn't look so bad
[2014-07-17 22:11:02 -0400] Damm: doug2, also https://sethvargo.com/using-gems-with-chef/
[2014-07-17 22:11:28 -0400] Damm: if you use nokogiri to parse the xml that blog has half your bits potentially
[2014-07-17 22:11:31 -0400] doug2: Damm: context?
[2014-07-17 22:11:38 -0400] doug2: Damm: the less ruby I write the better.
[2014-07-17 22:11:50 -0400] Damm: what do you write then?
[2014-07-17 22:12:07 -0400] doug2: Damm: When I had to do ruby and xml yesterday, it was like having Hitler and Stalin in the same room at the same time.
[2014-07-17 22:12:15 -0400] doug2: Damm: python
[2014-07-17 22:12:49 -0400] shanlar: is it possible to check a node's role in a recipe?
[2014-07-17 22:13:41 -0400] loki97123: node.role should give you that
[2014-07-17 22:14:10 -0400] Damm: doug2, do yu use fabric?
[2014-07-17 22:14:14 -0400] Damm: you*
[2014-07-17 22:14:15 -0400] shlant: shanlar: unless node[:roles].include?('syslog_server')
[2014-07-17 22:14:18 -0400] shanlar: NameError
[2014-07-17 22:14:18 -0400] shanlar: ---------
[2014-07-17 22:14:19 -0400] shanlar: No resource, method, or local variable named `role' for `Chef::Recipe "default"'
[2014-07-17 22:14:19 -0400] loki97123: @doug2 yes that recipe works and manages the rpm as a resource
[2014-07-17 22:14:20 -0400] doug2: Damm: not here, yet
[2014-07-17 22:14:27 -0400] Damm: doug2, well pychef exists
[2014-07-17 22:14:31 -0400] Damm: you can talk to chef via python
[2014-07-17 22:14:37 -0400] shanlar: i did node.role
[2014-07-17 22:14:44 -0400] Damm: so if you prefer to write a python script to read the xml and set it
[2014-07-17 22:15:03 -0400] loki97123: use the example from shlant
[2014-07-17 22:15:04 -0400] Damm: https://pychef.readthedocs.org/en/latest/
[2014-07-17 22:15:20 -0400] doug2: Damm: pychef is used just to perform knife style operations... i don't think I could use it to set an attribute for a node that hasn't had a chef run yet?
[2014-07-17 22:15:52 -0400] shanlar: shlant: thanks, that worked
[2014-07-17 22:16:12 -0400] loki97123: sorry shanlar, it's node.roles
[2014-07-17 22:16:21 -0400] shanlar: is there a way to see all of this data?
[2014-07-17 22:16:29 -0400] loki97123: but shlants is better for recipe
[2014-07-17 22:16:38 -0400] loki97123: knife node NAME -l
[2014-07-17 22:17:22 -0400] loki97123: sorry knife node show NAME -l -Fj
[2014-07-17 22:17:47 -0400] shanlar: that just outputs the chef_environment
[2014-07-17 22:17:59 -0400] doug2: ?
[2014-07-17 22:18:11 -0400] loki97123: nope that is everything in the chef server after the chef run
[2014-07-17 22:18:21 -0400] loki97123: it's all your node attributes and the merged ohai data
[2014-07-17 22:18:55 -0400] shanlar: odd, that doesnt work for me
[2014-07-17 22:19:03 -0400] Damm: doug2, and be aware you can do python scripts in recipes
[2014-07-17 22:19:20 -0400] shanlar: https://gist.github.com/chasebolt/e8cc8a8acd1dc576a3dc
[2014-07-17 22:19:21 -0400] Damm: so if your trying to set a node attribute yeah you'd need to do it in pychef in the recipe
[2014-07-17 22:20:02 -0400] Damm: doug2, http://docs.opscode.com/resource_script.html
[2014-07-17 22:20:08 -0400] Damm: and you can specify the python interperter
[2014-07-17 22:20:27 -0400] loki97123: oh has chef-client run on that machine already?
[2014-07-17 22:20:28 -0400] Damm: so find your comfort zone
[2014-07-17 22:20:31 -0400] doug2: Damm: can I get output from that back into the recipe?
[2014-07-17 22:20:36 -0400] mikedodge04: Hello All, in ohai 6 you use to be able to run one plugin with -f, is there a way to do that in ohai 7?
[2014-07-17 22:20:39 -0400] shanlar: yup
[2014-07-17 22:20:43 -0400] shanlar: so many times
[2014-07-17 22:20:53 -0400] shanlar: successes all day long
[2014-07-17 22:21:12 -0400] loki97123: can you try knife node NAME -al -Fj
[2014-07-17 22:21:41 -0400] doug2: Damm: because, if I can't run python and somehow get a result back into the recipe, i can't use it
[2014-07-17 22:21:47 -0400] shanlar: reload that gist
[2014-07-17 22:21:58 -0400] shanlar: just adds l: null
[2014-07-17 22:22:01 -0400] loki97123: holy carp
[2014-07-17 22:22:08 -0400] loki97123: you using chef-dk
[2014-07-17 22:22:11 -0400] loki97123: ?
[2014-07-17 22:22:18 -0400] bougyman: doug2: have you solved your thing yet?
[2014-07-17 22:22:21 -0400] shanlar: no
[2014-07-17 22:22:27 -0400] bougyman: wow
[2014-07-17 22:22:28 -0400] loki97123: and or what version of knife/chef arfe you using
[2014-07-17 22:22:29 -0400] bougyman: just wow
[2014-07-17 22:23:01 -0400] loki97123: @bougyman would you mind taking a look at my "solution" let me know what you think
[2014-07-17 22:23:11 -0400] loki97123: http://pastebin.com/mAeKxPUX
[2014-07-17 22:23:13 -0400] doug2: bougyman: not really. i've fallen back to having my jenkins job look up the value and pass it back in to chef-client with -j
[2014-07-17 22:23:20 -0400] shanlar:  knife -v
[2014-07-17 22:23:21 -0400] shanlar: Chef: 11.8.2
[2014-07-17 22:23:29 -0400] shanlar: ill update it :D
[2014-07-17 22:23:37 -0400] loki97123: i'm on 11.12 and 11.14
[2014-07-17 22:23:46 -0400] bougyman: loki97123: looks way too complicated.
[2014-07-17 22:23:46 -0400] shanlar: ok that didnt help
[2014-07-17 22:23:49 -0400] loki97123: (11.14 is from chefdk
[2014-07-17 22:23:51 -0400] shanlar: 11.12.8 now
[2014-07-17 22:24:07 -0400] loki97123: too complicated for what though
[2014-07-17 22:24:23 -0400] loki97123: you can't pass node attributes out of a ruby_block
[2014-07-17 22:24:44 -0400] doug2: puppet has something, i forget the name of, where you can execute scripts and retrieve the output in the puppet module. Dunno why chef can't have that
[2014-07-17 22:24:55 -0400] loki97123: and if you dynamically pull a file and read xml to create the rpm value
[2014-07-17 22:25:00 -0400] loki97123: well you can doug2
[2014-07-17 22:25:18 -0400] doug2: loki97123: if so, your solution is too complicated then. :)
[2014-07-17 22:25:35 -0400] loki97123: ah true
[2014-07-17 22:25:43 -0400] doug2: ;)
[2014-07-17 22:25:52 -0400] bougyman: my method would be: => remote_file "/tmp/datafile" do ... end; ruby_block "do_somthing_with_the_data" do; block do; data = File.read("/tmp/datafile"); <do stuff with data>; end; only_if { File.exists?("/tmp/datafile") }; end .. and later delete/archive /tmp/datafile
[2014-07-17 22:26:10 -0400] bougyman: I wouldn't really use the main /tmp/ namespace, but that's the general idea ^
[2014-07-17 22:26:27 -0400] loki97123: you could wrap your entire chunk in one ruby block
[2014-07-17 22:26:36 -0400] loki97123: cause you don't need to pass the attribute around
[2014-07-17 22:26:57 -0400] doug2: bougyman: well, if it was possible for do_somthing_with_the_data to download and install an rpm from a url, that could work...
[2014-07-17 22:27:14 -0400] bougyman: doug2: why wouldn't it be?
[2014-07-17 22:27:15 -0400] loki97123: shanlar i have no idea why you cant see the node information
[2014-07-17 22:27:20 -0400] shanlar: yea that sucks
[2014-07-17 22:27:22 -0400] shanlar: oh well
[2014-07-17 22:27:40 -0400] doug2: bougyman: no idea how to install an rpm from a url in ruby, unless you mean to exec out to do it
[2014-07-17 22:27:57 -0400] bougyman: tis one way.
[2014-07-17 22:28:29 -0400] bougyman: or if you chose to write that url to something like /etc/my_install_thingy/the_url the later resource can read from that.
[2014-07-17 22:28:58 -0400] doug2: bougyman: i was joking to someone about that approach.... cuz it's so ghetto. I had the feeling that would STILL bite me with the converge/compile issie
[2014-07-17 22:29:10 -0400] bougyman: doug2: I guess the point i'm trying to get across is that you can use the filesystem for state instead of trying to wrangle attributes.
[2014-07-17 22:29:25 -0400] shlant: shanlar: are you doing knife node show foo -l?
[2014-07-17 22:29:32 -0400] doug2: bougyman: true. you do realise that is a pretty poor reflection on chef, right?
[2014-07-17 22:29:39 -0400] shanlar: yes
[2014-07-17 22:29:44 -0400] bougyman: doug2: just be idempotent about it.
[2014-07-17 22:29:48 -0400] shlant: shanlar: weird
[2014-07-17 22:29:50 -0400] bougyman: doug2: i've used them all.
[2014-07-17 22:29:53 -0400] bougyman: all of them suck
[2014-07-17 22:29:58 -0400] bougyman: most of the time, chef sucks less.
[2014-07-17 22:30:06 -0400] shlant: shanlar: and you're sure the node exists? :P
[2014-07-17 22:30:14 -0400] shanlar: knife raw /nodes/foo  shows me all kinds of attribs
[2014-07-17 22:30:22 -0400] shanlar: haha yes because raw works fine
[2014-07-17 22:30:53 -0400] bougyman: bbl
[2014-07-17 22:30:58 -0400] shlant: shanlar: what about knife node edit foo -e vim
[2014-07-17 22:31:18 -0400] shanlar: yup
[2014-07-17 22:31:20 -0400] shanlar: that works np
[2014-07-17 22:31:49 -0400] shlant: shanlar: so does that show you what you want?
[2014-07-17 22:32:02 -0400] shanlar: https://gist.github.com/chasebolt/5cc36c8d66eb761244c1
[2014-07-17 22:32:18 -0400] shanlar: it sees there is a node, because it lists me the environment which is correct
[2014-07-17 22:32:26 -0400] shanlar: but for some reason that is all it lists
[2014-07-17 22:33:16 -0400] shanlar: i am trying to access all the possible attributes, so i know how to use stuff like node['recipes']
[2014-07-17 22:34:04 -0400] doug2: bougyman: gonna try the ruby block
[2014-07-17 22:41:14 -0400] shlant: shanlar: I think you were asked this before, but has that node completed a chef run?
[2014-07-17 22:41:41 -0400] shanlar: yup many times
[2014-07-17 22:41:52 -0400] shanlar: knife raw shows me everything about the node
[2014-07-17 22:47:10 -0400] ryanuber: Does opscode provide a YUM repository anywhere for chef? Or is installation on RedHat typically done with the rpm command directly?
[2014-07-17 22:47:38 -0400] loki97123: ryanuber, i think it is the omnibus installer really
[2014-07-17 22:47:45 -0400] loki97123: for the client
[2014-07-17 22:47:54 -0400] loki97123: and recently they are pushing chef-dk for the local
[2014-07-17 22:48:01 -0400] loki97123: but i think i misunderstan
[2014-07-17 22:48:57 -0400] ryanuber: loki97123, thanks for the tip, I'll check those out to see what they are about. would be nice to have a YUM repo to just install it from kickstart, but I guess I could always just download the RPM and create a repo.
[2014-07-17 22:49:36 -0400] loki97123: we have a local repo and control which version we install on targets
[2014-07-17 22:54:08 -0400] doug2: oh shit
[2014-07-17 22:54:47 -0400] loki97123: orly doug2
[2014-07-17 22:55:16 -0400] doug2: so... I started trying to put this all into a ruby_block but that's too hard...
[2014-07-17 22:55:35 -0400] doug2: then I figured I'd write the latest version into a file, but how the heck do I get the contents of that file?
[2014-07-17 22:56:26 -0400] doug2: so... I started trying to put this all into a ruby_block but that's too hard...
[2014-07-17 22:56:29 -0400] doug2: then I figured I'd write the latest version into a file, but how the heck do I get the contents of that file?
[2014-07-17 22:57:37 -0400] doug2: so... I started trying to put this all into a ruby_block but that's too hard...
[2014-07-17 22:57:39 -0400] doug2: then I figured I'd write the latest version into a file, but how the heck do I get the contents of that file?
[2014-07-17 23:01:50 -0400] doug2: sigh
[2014-07-17 23:01:59 -0400] doug2: "checking for popt.h... *** extconf.rb failed ***"
[2014-07-17 23:03:39 -0400] doug2: wow, what a shitstorm of failures
[2014-07-17 23:03:47 -0400] Eulipion: can someone help me get vagrant-berkshelf installed.  now that ive gone DK i can't go back. http://pastebin.com/g5bs4r8d
[2014-07-17 23:06:32 -0400] cnk: Eulipion: I see some errors in installing docs but not an error installing the requested gem
[2014-07-17 23:06:41 -0400] cnk: what does gem list deb_selector say?
[2014-07-17 23:06:52 -0400] cnk: is it installed or not?
[2014-07-17 23:07:16 -0400] Eulipion: /Applications/Vagrant/embedded/bin/gem list | grep dep_selector
[2014-07-17 23:07:17 -0400] Eulipion: dep_selector (1.0.3)
[2014-07-17 23:07:44 -0400] cnk: and did you rerun the command that failed?
[2014-07-17 23:07:58 -0400] Eulipion: it continues to fail
[2014-07-17 23:08:35 -0400] cnk: with what error? still just complaining about ASCII characters?
[2014-07-17 23:08:41 -0400] cnk: or something more informative
[2014-07-17 23:10:10 -0400] Eulipion: cnk: http://pastebin.com/Vez8RXVj
[2014-07-17 23:12:11 -0400] cnk: what is the ownership and permissions for /Applications/Vagrant/embedded/lib/ruby/gems/2.0.0
[2014-07-17 23:12:22 -0400] cnk: I think sudo may have made things worse, not better
[2014-07-17 23:12:48 -0400] cnk: how is the embedded ruby installed? is this rbenv? rvm? other?
[2014-07-17 23:13:07 -0400] Eulipion: its installed from the vagrant installer
[2014-07-17 23:13:27 -0400] Eulipion: i just added a symlink to my chruby dir so that i could make sure it was "really" switched
[2014-07-17 23:13:43 -0400] Eulipion: i've also tried uninstalled every ruby except the embedded
[2014-07-17 23:14:03 -0400] Eulipion: tried a fresh user...
[2014-07-17 23:14:17 -0400] Eulipion: ruby is a tragedy
[2014-07-17 23:15:46 -0400] cnk: I like ruby but will admit that the measures taken to be able to run multiple rubies make things harder when you only need one
[2014-07-17 23:16:13 -0400] doug2: This sucks. I've resorted to writing my recipe in sh called from a ruby block
[2014-07-17 23:16:32 -0400] Eulipion: cnk: http://pastebin.com/WzX1LtBd
[2014-07-17 23:16:51 -0400] Eulipion: no idea what dtruss is trying to tell me, wish strace worked on osx
[2014-07-17 23:17:46 -0400] Eulipion: how am i the only one who can't get vagrant working.  ok.  gonna smash this computer and start fresh tomorrow
[2014-07-17 23:18:13 -0400] cnk: hope things look better in the morning
[2014-07-17 23:18:44 -0400] Eulipion: they wont, it'll keep doing the same thing, amd i'll go crazy expecting it to do something different
[2014-07-17 23:27:50 -0400] doug2: any way to get contents of local file in chef?
[2014-07-17 23:28:37 -0400] mallu: ohai, is it possible to call a databag item from a template without setting as variable in recipe?
[2014-07-17 23:35:49 -0400] mallu: anyone?
[2014-07-17 23:36:48 -0400] Damm: doug2, in a ruby_block sure
[2014-07-17 23:36:58 -0400] Damm: you could just be lazy and do it and it'll happen at compile time
[2014-07-17 23:37:26 -0400] Damm: http://stackoverflow.com/questions/5545068/what-are-all-the-common-ways-to-read-a-file-in-ruby
[2014-07-17 23:38:41 -0400] doug2: Damm: i'm trying ixlib::ShellOut.new right now...
[2014-07-17 23:38:46 -0400] doug2: oops Mixlib::ShellOut.new
[2014-07-17 23:38:52 -0400] doug2: but....
[2014-07-17 23:38:57 -0400] Damm: to read a file?
[2014-07-17 23:38:58 -0400] Damm: why?
[2014-07-17 23:39:05 -0400] Damm: bludgeon yourself with ruby?
[2014-07-17 23:39:55 -0400] doug2: Damm: http://pastebin.com/FT3fu6FR
[2014-07-17 23:39:58 -0400] scalp42: no clues sorry mallu
[2014-07-17 23:40:05 -0400] scalp42: usually pass vars around
[2014-07-17 23:40:21 -0400] doug2: Damm: it's executing the Mixlib shellout BEFORE the ruby_block I think. *cry*
[2014-07-17 23:40:34 -0400] Damm: lol
[2014-07-17 23:40:36 -0400] Damm: that's horrible
[2014-07-17 23:40:40 -0400] mallu: scalp42: I was told that I can call databag items directly from templates
[2014-07-17 23:40:47 -0400] Damm: I think i'm going to the bathroom to console myself
[2014-07-17 23:40:52 -0400] doug2: Damm: better than what's in those comments...
[2014-07-17 23:41:06 -0400] Damm: yeah i debated that too
[2014-07-17 23:41:10 -0400] doug2: *sigh*
[2014-07-17 23:41:16 -0400] doug2: why why why?
[2014-07-17 23:41:23 -0400] Damm: ask yourself that?
[2014-07-17 23:41:29 -0400] doug2: why is it calling MixLib shellout BEFORE the ruby_block ?
[2014-07-17 23:42:18 -0400] scalp42: well yeah if you pass them to the template
[2014-07-17 23:46:13 -0400] gkra: Is there a way to get berkshelf to populate an empty chef-repo cookbooks directory based on a berksfile?
[2014-07-17 23:48:40 -0400] doug2: Why is MixLib shellout being called before my ruby block?
[2014-07-17 23:49:39 -0400] ryanuber: gkra: have you tried to use the "vendor" command? "berks vendor ./cookbooks"
[2014-07-17 23:50:06 -0400] gkra: oh, hey. berkshelf.com was updated and I didnt' notice. :)
[2014-07-17 23:52:03 -0400] doug2: Why is MixLib shellout being called before my ruby block?
[2014-07-17 23:52:18 -0400] Damm: it's ruby
[2014-07-17 23:52:19 -0400] Damm: that's why
[2014-07-17 23:52:40 -0400] Damm: latest = MixLib::ShellOut.new('') is evaluated at compile time
[2014-07-17 23:52:42 -0400] Damm: and executed
[2014-07-17 23:52:54 -0400] doug2: Damm: that's not documented. ffs.
[2014-07-17 23:53:00 -0400] Damm: yes it is
[2014-07-17 23:53:25 -0400] doug2: Damm: where https://github.com/opscode/mixlib-shellout ?
[2014-07-17 23:53:27 -0400] Damm: using dynamic resources are evaluated at the right phase
[2014-07-17 23:53:44 -0400] Damm: like latest = execute "cat /tmp/outfile" do action :nothing end
[2014-07-17 23:53:50 -0400] Damm: that will execute correctly
[2014-07-17 23:53:53 -0400] doug2: there is no mention of 'compile' or 'dynamic' at https://github.com/opscode/mixlib-shellout
[2014-07-17 23:53:59 -0400] Damm: but MixLib::ShellOut.new does not map to a resource nor a provider
[2014-07-17 23:54:09 -0400] Damm: directly map at least
[2014-07-17 23:54:45 -0400] Damm: a=package "sysstat" do action :nothing end maps to the package resource
[2014-07-17 23:54:46 -0400] doug2: so, 8 hours later, I'm nowhere
[2014-07-17 23:54:51 -0400] doug2: on a very very simple task
[2014-07-17 23:55:08 -0400] Damm: and you were given many solutions, whatever happened to using -j?
[2014-07-17 23:55:16 -0400] Damm: and just passing in the version number during chef-client?
[2014-07-17 23:55:36 -0400] doug2: Damm: I don't like that option. it puts reliance on something outside the cookbook
[2014-07-17 23:55:39 -0400] Damm: that's the correct behavior; the behavior your trying to work with is not the best way
[2014-07-17 23:55:55 -0400] doug2: Damm: says?
[2014-07-17 23:56:03 -0400] Damm: common sense
[2014-07-17 23:56:05 -0400] Damm: to me
[2014-07-17 23:56:15 -0400] doug2: Damm: not to me
[2014-07-17 23:56:34 -0400] doug2: this says to me that there are undocumented external dependancies now introduxed
[2014-07-17 23:56:38 -0400] Damm: well I hope that last answer helps you to the next point
