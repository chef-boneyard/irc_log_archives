[2014-07-21 00:04:37 -0400] Damm: so what you want remote_directory "/etc/nginx" do source "nginx/" end?
[2014-07-21 01:19:16 -0400] rhys: Damm: mostly i want the ability to have a resource that deletes absolutely everything in /etc/nginx/sites-enabled/ unless a later resource declares a resource for a file in that directory
[2014-07-21 01:20:04 -0400] rhys: i feel like the only way i'm going to do this is use something like poise and only let one cookbook manage a given directory
[2014-07-21 01:44:40 -0400] Damm: seems like the wrong way of doing it
[2014-07-21 01:45:08 -0400] Damm: if things get in there without chef's control it is oblivious to them; and it can control it in the sense of always nuking and re-creating it
[2014-07-21 01:45:17 -0400] Damm: just smells wrong
[2014-07-21 01:51:40 -0400] juliancdunn: rhys: sounds like you might be interested in the zap pattern https://github.com/nvwls/zap
[2014-07-21 01:59:09 -0400] Damm: i mean a zap and re-create
[2014-07-21 02:02:39 -0400] juliancdunn: don't understand, doesn't zap only zap things that aren't mentioned in the resource collection?
[2014-07-21 03:29:24 -0400] JoshuaPaling: I'm deploying a simple rails app to a single server, and want to use chef solo. Is it a bad idea to put my chef files in the same git repo as my rails app?
[2014-07-21 04:00:12 -0400] coderanger: JoshuaPaling: Nah, probably fine
[2014-07-21 04:03:27 -0400] chefgirl: HI
[2014-07-21 04:04:05 -0400] coderanger: JoshuaPaling: Some even consider a best practice to do it like that, I'm less sold on that designation though :)
[2014-07-21 04:05:04 -0400] JoshuaPaling: @coderanger thanks - I like the idea of keeping it all in one place while I'm getting started, so I'll do it like that for now.
[2014-07-21 04:05:23 -0400] coderanger: JoshuaPaling: Make sure you check out berkshelf, its very helpful for that pattern
[2014-07-21 04:05:33 -0400] bryabuck: does anyone know when aix and chef will be supported?
[2014-07-21 04:06:01 -0400] JoshuaPaling: @coderanger will do - I'm following this book, which uses berkshelf: https://leanpub.com/deploying_rails_applications
[2014-07-21 04:06:33 -0400] coderanger: bryabuck: which AIX?
[2014-07-21 04:06:41 -0400] bryabuck: AIX 7.1
[2014-07-21 04:07:23 -0400] coderanger: bryabuck: It should already be, https://github.com/opscode/chef-rfc/pull/21 is the in-progress specification for platform support
[2014-07-21 04:07:44 -0400] coderanger: bryabuck: And that has 7.1 listed as a tier 1 platform
[2014-07-21 04:09:38 -0400] coderanger: bryabuck: As for how you get access to the build, I have no clue :-(
[2014-07-21 04:11:27 -0400] chefgirl: can we integrate jenkins with chef
[2014-07-21 04:11:33 -0400] chefgirl: ?
[2014-07-21 04:13:38 -0400] bryabuck: thanks coderanger
[2014-07-21 04:37:44 -0400] rhys: chefgirl, i have to some extent
[2014-07-21 04:39:16 -0400] rhys: i have a github organization "cookbooks" i'm using with berkshelf, and a jenkins job that every so often scans the org for new cookbooks, spins up a template of a jenkins job to run test-kitchen + a githook for new commits.
[2014-07-21 04:39:48 -0400] rhys: currently it just runs lintian, but the idea is that cookbook gets created, it automatically gets a testing job and only after testing does the jenkins job tag the cookbook repo (for berkshelf)
[2014-07-21 04:52:48 -0400] coderanger: rhys: Pretty easy to setup
[2014-07-21 04:53:01 -0400] coderanger: oh, that wasn't a question :)
[2014-07-21 04:53:14 -0400] coderanger: rhys: See https://github.com/balanced-cookbooks/balanced-ci/blob/master/recipes/cookbooks.rb for an example of that
[2014-07-21 04:54:33 -0400] chefgirl: rhys : for that i need o install jenkins on the workstation
[2014-07-21 04:54:34 -0400] chefgirl: ?
[2014-07-21 04:55:22 -0400] rhys: chefgirl: ahh.. i have a server setup at work to do this kind of testing + enterprise github.
[2014-07-21 04:55:58 -0400] rhys: jenkins server. i think you were asking the opposite of what i thought you were, how to make chef do jenkins, not jenkins test chef..
[2014-07-21 04:57:06 -0400] rhys: coderanger: yeah i just threw together a ruby job to do it. balanced looks nice.
[2014-07-21 04:57:42 -0400] chefgirl: rhys : I want to jenkins to call the chef server so that i dont have to go to the chef server
[2014-07-21 04:57:52 -0400] chefgirl: to perform all the task
[2014-07-21 05:00:17 -0400] rhys: chefgirl: theres a file plugin for jenkins, you can use that to load knife.rb to a job's environment, then setup jobs to only update the chef server when a git repo is tagged with a release, be it cookbook repos or roles/env/databags etc.
[2014-07-21 05:44:31 -0400] chefgirl: is anybody working on AWS ?
[2014-07-21 05:45:47 -0400] Damm: nope
[2014-07-21 05:50:05 -0400] chefgirl: Damm : I want to create a script that shutdowns the large instances on weekends
[2014-07-21 06:02:23 -0400] Damm: I doubt that would be a chef script.  Just a ruby script using fog to see all your instances and shut them down based on size
[2014-07-21 06:02:35 -0400] Damm: and run it on a saturday and the reverse run on a monday to start them back up
[2014-07-21 06:37:56 -0400] chefgirl: is it a a best practice to install Chef-client recipe on each instances ??
[2014-07-21 06:38:13 -0400] chefgirl: means on the larget node?
[2014-07-21 06:40:07 -0400] jblack: damn: perhaps chef-metal might handle that?
[2014-07-21 06:41:16 -0400] jblack: Anyway, I'm still confsued as to whether or not chef-metal-lxc can work with a remote server.
[2014-07-21 06:41:57 -0400] jblack: I suppose I can make the lxc server itself a provisioner node as well....
[2014-07-21 07:34:55 -0400] balbirs: in knife ec2 server create, should we provide --ssh-user? can not it ubuntu if it's Debian AMI and ec2-user if it's RedHat AMI?
[2014-07-21 07:39:00 -0400] coderanger: balbirs: That cannot be detected automatically, no
[2014-07-21 07:39:15 -0400] coderanger: balbirs: By default it uses your current username, just like any other SSH client
[2014-07-21 07:43:07 -0400] balbirs: coderanger: thanks
[2014-07-21 07:54:27 -0400] balbirs: what is the role of 'node' and 'client' in chef server ?
[2014-07-21 07:56:10 -0400] coderanger: balbirs: client refers to an API client, it stores the public key used to verify API requests, the node stores per-node data like run lists and environment, as well as a cached copy of the computed attributes from the last run used for search
[2014-07-21 08:02:56 -0400] balbirs: coderanger: thanks
[2014-07-21 08:19:24 -0400] torax: does chef_server or opscode-pgsql user need login shell. Im running centos 6.5
[2014-07-21 08:22:44 -0400] coderanger: torax: Only if you want to try and log in as them
[2014-07-21 08:40:19 -0400] chefgirl: I have a query ..
[2014-07-21 08:40:46 -0400] chefgirl: can we use jenkins to run each recipes on target node without ogging into the workstation
[2014-07-21 08:40:48 -0400] chefgirl: ?
[2014-07-21 08:43:26 -0400] coderanger: chefgirl: As I've said before, please find a local trainer or mentor, or arrange for more personal training resources.
[2014-07-21 08:43:54 -0400] chefgirl: @coderanger : why cant people help me here
[2014-07-21 08:44:11 -0400] chefgirl: i have gon ethrough the webinars also as per your suggestions
[2014-07-21 08:44:55 -0400] coderanger: 1) you generally ask questions at hours people aren't online (due to a 13 hour time difference no doubt) 2) language barrier issues 3) volume of questions and the detailed nature of those questions
[2014-07-21 08:46:42 -0400] chefgirl: @coderanger : 1. I cant help with the time issue . 2. What are the lanuage issues? 3. If i get stuck this is the only place I can find my solutions
[2014-07-21 08:57:52 -0400] jmara: chefgirl: don't use jenkins as a distributed crontab for your environment its not meant to be an orchestration tool its about continues integration and testing
[2014-07-21 08:58:45 -0400] chefgirl: like can i launch ec2 instances with the jobs in jenkins using chef also ?? jmara
[2014-07-21 09:00:49 -0400] coderanger: chefgirl: I am suggesting, quite strongly, you pay someone to act as a personal trainer, and that #chef is not an appropriate venue for your questions given the issues I mentioned
[2014-07-21 09:04:34 -0400] chefgirl: @coderanger : you are discouraging me a lot
[2014-07-21 09:07:59 -0400] zts: chefgirl: the thing to remember is that people in here aren't paid to help - when you ask a lot of questions, and questions that are very high level, you discourage people from helping you
[2014-07-21 09:08:40 -0400] chefgirl: zts : if i have query then only i ask questions
[2014-07-21 09:09:56 -0400] zts: chefgirl: they are questions, but they are not very specific, and they don't sound like you've tried to work them out yourself.  eg, instead of "can I launch ec2 instances with the jobs in jenkins using chef", a good question would be "I am trying to launch an ec2 instance with chef using <some method>, and it fails" - in other words, you have already tried, and have some error message and can't work it out
[2014-07-21 09:10:18 -0400] zts: chefgirl: if you are looking for high level guidance - "I want to put Chef, Jenkins, and AWS together to solve some big problem", it's not really a good place to ask
[2014-07-21 09:10:43 -0400] __julien: Hello , using chef-solo 11.12.8 via vagrant , I have Chef::Exceptions::FileNotFound, cookbook acme_nginx has no directory files/default/sslcerts/ where this directory is present. The cookbook is a provider and I use the remote_directory ressource within the provider with the parameter cookbook 'acme_nginx'.
[2014-07-21 09:11:31 -0400] __julien: I could not find that kinda bug briefly looking to chef issue navigator, anyone  has an idea of what my problem could be ?
[2014-07-21 09:12:19 -0400] coderanger: __julien: can you pastebin your recipe code?
[2014-07-21 09:12:58 -0400] jmara: __julien: do you use berkshelf or have you set the cookbook directory?
[2014-07-21 09:13:29 -0400] __julien: I do use berkshelf just to generate the vendor cookbooks
[2014-07-21 09:13:59 -0400] __julien: http://pastebin.com/HHyxehqU
[2014-07-21 09:14:54 -0400] chefgirl: zts : i just asked whether i can integrate the chef server with jnekins oly
[2014-07-21 09:15:26 -0400] coderanger: __julien: Hmm, that doesn't seem to match your error message
[2014-07-21 09:15:44 -0400] coderanger: __julien: specifically "source 'ssl/' + new_resource.domain_short" doesn't match the "sslcerts" in the error
[2014-07-21 09:15:54 -0400] coderanger: Perhaps it is coming from different code?
[2014-07-21 09:15:59 -0400] __julien: yeah cos I change the stuff from ssl to sslcerts
[2014-07-21 09:16:03 -0400] coderanger: Or there is a version sync issue?
[2014-07-21 09:16:12 -0400] __julien: to see if changing the name was ok
[2014-07-21 09:17:15 -0400] zts: chefgirl: yes, that is a very vague question.  I'll prove it to you:  "Question: can I integrate the chef server with jenkins?"  "Answer: yes."
[2014-07-21 09:18:00 -0400] coderanger: __julien: Okay, what does the error look like now?
[2014-07-21 09:18:04 -0400] __julien: same
[2014-07-21 09:18:08 -0400] __julien: it looks like a bug to me
[2014-07-21 09:18:16 -0400] zts: chefgirl: anyway, I wish you the best of luck and I will leave you to your work
[2014-07-21 09:18:33 -0400] __julien: remote_directory[/etc/nginx/ssl/] (/tmp/vagrant-chef-3/chef-solo-2/cookbooks/acme_nginx/providers/default.rb line 46) had an error: Chef::Exceptions::FileNotFound: cookbook acme_nginx has no directory files/default/ssl/
[2014-07-21 09:19:48 -0400] __julien: cookbooks_dir $ ls acme_nginx/files/default/  returns  "ssl"
[2014-07-21 09:19:55 -0400] coderanger: __julien: okay, so that means  new_resource.domain_short is empty, is that correct?
[2014-07-21 09:20:14 -0400] __julien: coderanger, should not ...
[2014-07-21 09:20:40 -0400] __julien: maybe that's where my problem is from the start, but the ssl directory exists anyway
[2014-07-21 09:20:49 -0400] __julien: so I though It would copy the subdir
[2014-07-21 09:21:13 -0400] __julien: the directory structure is acme_nginx/files/default/ssl/domainname.ext
[2014-07-21 09:21:18 -0400] __julien: for the different domainnames
[2014-07-21 09:21:35 -0400] __julien: I'll debug the domainname, thx
[2014-07-21 09:24:03 -0400] __julien: coderanger, sry you're right that was a silly mistake of mine
[2014-07-21 09:31:27 -0400] Archie: Is there a way to get chef-solo to spit out attribute values during a chef run?
[2014-07-21 09:33:30 -0400] coderanger: Archie: Not sure what you mean, you can use the log resource though if you just want console output
[2014-07-21 09:34:46 -0400] matti: Ohai
[2014-07-21 09:36:05 -0400] Archie: coderanger: I can but I'm trying to avoid that if there's a way.
[2014-07-21 09:36:21 -0400] coderanger: Archie: What in particular are you trying to do?
[2014-07-21 09:41:00 -0400] Archie: coderanger: I'm just trying to get the value of an attribute during a chef run (to troubleshoot an issue). I can use a log resource to print out the value to console. It's not an issue to use log resource, certainly, just wandering if there's a better way of doing that
[2014-07-21 09:41:39 -0400] Archie: matti: Could you elaborate please?
[2014-07-21 09:41:50 -0400] coderanger: Archie: Either a log resource or directly use Chef::Log.debug depending on if you want it at compile or converge time
[2014-07-21 09:41:56 -0400] coderanger: Archie: He was just saying hello
[2014-07-21 09:43:09 -0400] Archie: coderanger: Thanks, will do.
[2014-07-21 09:43:18 -0400] Archie: matti: Hi =)
[2014-07-21 09:46:09 -0400] matti: Hi.
[2014-07-21 09:46:45 -0400] matti: Archie: To add to what coderanger said, check out chef-shell/shef too :)
[2014-07-21 09:47:11 -0400] matti: Archie: Handy for all kings of troubleshooting, etc.
[2014-07-21 09:49:54 -0400] aaaazaaaa: chef 11 , i see lots of
[2014-07-21 09:49:55 -0400] aaaazaaaa: {channel0_error,starting,                 {amqp_error,access_refused,                             "AMQPLAIN login refused: user 'chef' - invalid credentials",                             'connection.start_ok'}}
[2014-07-21 09:49:59 -0400] aaaazaaaa: any hints?
[2014-07-21 09:50:18 -0400] aaaazaaaa: as I've already tried to reset the rabbitmq username / password but still not working
[2014-07-21 09:51:04 -0400] matti: aaaazaaaa: What did you do to cause this? :)
[2014-07-21 09:51:16 -0400] matti: aaaazaaaa: Try sudo chef-server-ctl test and swap test to reconfigure if needed.
[2014-07-21 09:51:27 -0400] matti: Might help to set things back.
[2014-07-21 09:53:07 -0400] matti: aaaazaaaa: Some hints: http://www.getchef.com/blog/2013/03/11/chef-11-server-up-and-running/; about the tools, etc.
[2014-07-21 09:54:16 -0400] coderanger: aaaazaaaa: Did you change the hostname/fqdn of the server?
[2014-07-21 09:54:32 -0400] coderanger: rabbit is very sensitive to that
[2014-07-21 09:59:12 -0400] aaaazaaaa: yes
[2014-07-21 09:59:18 -0400] aaaazaaaa: I've changed the hostname of the server
[2014-07-21 10:00:01 -0400] aaaazaaaa: from some clients is accepting connections
[2014-07-21 10:00:17 -0400] aaaazaaaa: here's an example of rabbitmq log:
[2014-07-21 10:00:18 -0400] aaaazaaaa: =INFO REPORT==== 21-Jul-2014::09:59:47 === starting TCP connection <0.3255.0> from 127.0.0.1:42854  =ERROR REPORT==== 21-Jul-2014::09:59:47 === exception on TCP connection <0.3247.0> from 127.0.0.1:42853 {channel0_error,starting,                 {amqp_error,access_refused,                             "AMQPLAIN login refused: user 'chef' - invalid credentials",                             'connection.start_ok'}}  =INFO REPORT==== 21-
[2014-07-21 10:00:24 -0400] Archie: matti: Thanks, I'll check it out
[2014-07-21 10:00:36 -0400] Archie: ll
[2014-07-21 10:02:44 -0400] jmara: aaaazaaaa: This rabbitmq mailinglist entry might help http://goo.gl/4ucuG3
[2014-07-21 10:03:49 -0400] jmara: but your problem seems a little bit different
[2014-07-21 10:07:37 -0400] coderanger: aaaazaaaa: You'll need to rebuild your rabbit channels and users manually, or just back up the chef server and reinstall it
[2014-07-21 10:09:23 -0400] chefgirl: Can anybody tell me the location of client.rb file
[2014-07-21 10:10:41 -0400] coderanger: chefgirl: http://docs.opscode.com/config_rb_client.html please check google before asking
[2014-07-21 10:23:48 -0400] balbirs: can I directly run a data bag (creating users) instead of putting it to a cookbook?
[2014-07-21 10:24:11 -0400] balbirs: like add a data bag (creating users) to a node's run list
[2014-07-21 10:33:23 -0400] coderanger: balbirs: Data bags aren't code, so no, that wouldn't be a thing
[2014-07-21 10:34:36 -0400] coderanger: balbirs: But by the nature of the question I'm guessing there is some confusion about what bags are
[2014-07-21 11:01:59 -0400] chefologist: hi I am trying to setup a node on my new hosted chef with my knife.rb, however when I attempt to connect it states it can't find my .pem client file
[2014-07-21 11:02:03 -0400] chefologist: please assist
[2014-07-21 11:28:01 -0400] soblom: is there a way to have a 'cookbook_file' resource create enclosing directories as necessary? or do I always need a separate 'directory' resource for that?
[2014-07-21 11:31:53 -0400] double_p: soblom: from docs, there's no autocreate directories. but resource directory has a recursive option
[2014-07-21 11:34:41 -0400] soblom: double_p: yes, directories can do that (and I am using it for) but it's still two statements. I just hoped that the case "put a file somewhere and if necessary create some folders along the way" would have some sort of convenience implementation...
[2014-07-21 11:37:59 -0400] coderanger: soblom: You need to make the dir yourself because you need to tell it what owner/mode to use
[2014-07-21 11:40:00 -0400] soblom: coderanger: true, but in this particular case it could have used the same owner and mode as the file. But hey, it doesn't kill me to use two statements. maybe my case is just too edgy
[2014-07-21 11:40:18 -0400] coderanger: soblom: file modes and dir modes are very rarely the same
[2014-07-21 11:41:05 -0400] coderanger: Unless you are writing out executable scripts with Chef, which sounds like a bad idea :)
[2014-07-21 11:41:41 -0400] soblom: coderanger: ??
[2014-07-21 11:42:12 -0400] coderanger: soblom: the x bit in modes has different meaning on files vs. dirs
[2014-07-21 11:42:33 -0400] soblom: ok, I see what you mean
[2014-07-21 11:42:35 -0400] coderanger: soblom: So "use the same mode" is generally not what you want
[2014-07-21 12:25:31 -0400] wojtczak: who do I search with knife ssh by an attribute of a node?
[2014-07-21 12:26:13 -0400] coderanger: wojtczak: who?
[2014-07-21 12:26:32 -0400] wojtczak: how
[2014-07-21 12:27:24 -0400] wojtczak: knife search node name:production works, knife ssh name:production doesn't
[2014-07-21 12:27:57 -0400] rishi_: what is a recipe ?
[2014-07-21 12:28:52 -0400] wojtczak: http://docs.opscode.com/essentials_cookbook_recipes.html
[2014-07-21 12:29:07 -0400] coderanger: wojtczak: any search query that works with knife search will work with knife ssh, what error do you get for the latter?
[2014-07-21 12:29:22 -0400] coderanger: rishi_: Recipes are the code files that define what Chef should do on a server
[2014-07-21 12:29:27 -0400] wojtczak: WARNING: Failed to connect to  -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2014-07-21 12:30:02 -0400] coderanger: wojtczak: The FQDN of the target isn't a valid DNS name
[2014-07-21 12:30:22 -0400] coderanger: wojtczak: You can either tell it to use a different attribute for the connection info, or fix the hostname of your servers
[2014-07-21 12:30:32 -0400] wojtczak: ok, get it now. thx for your help
[2014-07-21 12:33:25 -0400] rishi_: Thanks !
[2014-07-21 13:05:29 -0400] soblom: any advice on the following: My understanding is that attributes defined in attributes files imply a contract with the user of the cookbook: "These attributes can be changed by user". If so, where do attributes go that I reuse when developing a cookbook and I want to define only once (being DRY, and all)?
[2014-07-21 13:05:56 -0400] soblom: ... but that should not simply be changed by the user
[2014-07-21 13:36:51 -0400] pfo__: anyone in here using chef for image management?
[2014-07-21 13:56:40 -0400] ResidentR: I would be curious to know that too.
[2014-07-21 13:58:35 -0400] jreslock: pfo__: I am using a combination of packer and chef for image management
[2014-07-21 13:59:14 -0400] pfo__: @jreslock how do you manage the image apart from chef? chroot? or is it just a binary and you use a packer libguestfs based approach?
[2014-07-21 13:59:30 -0400] pfo__: @jreslock so what are your images is the actual question :)
[2014-07-21 14:00:06 -0400] jreslock: I use packer to build a virtualbox vagrant box, an AWS AMI and a VMWare machine and use the same chef-client provisioner in each.
[2014-07-21 14:00:24 -0400] pfo__: I see
[2014-07-21 14:00:33 -0400] pfo__: my image is just a tar gz'ed file system
[2014-07-21 14:00:46 -0400] pfo__: that get's ironed ontop of tmpfs that resides on a shared nfsroot.
[2014-07-21 14:01:15 -0400] jreslock: Ive got some special sauce (fabric) that spins up the actual VMs when we need them
[2014-07-21 14:01:27 -0400] pfo__: so chroot and a wrapper ontop of yum to go to the proper image.
[2014-07-21 14:01:38 -0400] jreslock: ..and this is all for developer/test machines.  Not for production.
[2014-07-21 14:01:43 -0400] pfo__: the problem I have is that the image itself is stateless
[2014-07-21 14:01:54 -0400] pfo__: so spinning it up is not an option for config mgmnt
[2014-07-21 14:02:21 -0400] jreslock: Maybe use chef-metal?
[2014-07-21 14:02:51 -0400] jreslock: Im not familiar with chroot so metal may not be applicable.
[2014-07-21 14:03:19 -0400] pfo__: the boot process grabs a tar ball and extracts it on a tmpfs
[2014-07-21 14:03:23 -0400] pfo__: it's pretty simple actually
[2014-07-21 14:03:53 -0400] pfo__: the deployment machine holds the fs hierarchy that needs to get delivered to the machine
[2014-07-21 14:28:42 -0400] aaronrl: is it possible to find what action is being called during the load_current_resource method?
[2014-07-21 14:29:10 -0400] aaronrl: my googlefu doesn't seem to turn up anything
[2014-07-21 14:30:59 -0400] jbellone: Hey all, anyone work with the Jenkins cookbook, groovy and LDAP? I
[2014-07-21 14:31:05 -0400] jbellone: I am scratching my head a bit trying to solve ethis :)
[2014-07-21 14:37:25 -0400] jtimberman: aaronrl: load_current_resource doesn't execute any actions. it's used by providers to determine the state of the resource being managed.
[2014-07-21 14:38:29 -0400] jtimberman: for example, the "package" resource has different providers like apt or yum, and load_current_resource finds out if the package is installed or not.
[2014-07-21 14:39:30 -0400] aaronrl: so does the client run load_current_resource before it evaluates which action is requested by the resource defined in the recipe?
[2014-07-21 14:40:14 -0400] aaronrl: i'm trying to make my shell_out a little more intelligent and i can do that if i know what action the resource is trying to do
[2014-07-21 14:40:47 -0400] aaronrl: otherwise i think i'll have to whip out a messy regex
[2014-07-21 14:44:04 -0400] zeroXten: hi... is node.run_state only available during the compile phase of the run?
[2014-07-21 14:50:28 -0400] amaltson: hello everyone, I've created a custom LWRP that's setting a node attribute, but I'm finding that later on in the chef run the node attribute hasn't been set. I've tried wrapping the subsequent code in a log or bash block, but they don't seem to be executing in order. I have a Chef::Log in the subsequent block and I see it happen right at the beginning of the
[2014-07-21 14:50:28 -0400] amaltson: Chef run instead of after my LWRP executes. I'm doing something wrong for sure... but not sure what the order of operations is.
[2014-07-21 14:50:42 -0400] quantumfoam: has anyone used this: https://github.com/philcryer/centrify-cookbook ?
[2014-07-21 14:50:55 -0400] quantumfoam: I'm just wondering if it supports putting a config file for the install script in a data bag
[2014-07-21 14:51:36 -0400] amaltson: I was using a definition before and it worked well, but Foodcritic was unhappy with my use of definition ;)
[2014-07-21 14:52:22 -0400] n1ko: foodcritic isnt an authority
[2014-07-21 14:52:52 -0400] amaltson: n1ko: hehe, no it's not, I can definitely ignore that rule
[2014-07-21 14:53:01 -0400] n1ko: and by that i mean that you should understand what it says and make decisions based on that
[2014-07-21 14:53:18 -0400] n1ko: not think that "this is wrong because foodcritic tells me its wrong"
[2014-07-21 14:53:34 -0400] n1ko: hopefully you dont, but ive seen this happend with code analysis tools and devs :)
[2014-07-21 14:54:46 -0400] amaltson: n1ko: it's a fair point, I did read what the rule was saying. I've continued to see Chef being paired down to the basics, so I'm happy to use LWRPs in place of definitions if at some point Chef decides to deprecate definitions
[2014-07-21 14:55:20 -0400] n1ko: :)
[2014-07-21 14:57:22 -0400] amaltson: the LWRP looks as follows:
[2014-07-21 14:57:23 -0400] amaltson: https://www.irccloud.com/pastebin/crnG966l
[2014-07-21 14:57:43 -0400] amaltson: my usage of the LWRP looks as follows:
[2014-07-21 14:57:44 -0400] amaltson: https://www.irccloud.com/pastebin/CxWzs9Hi
[2014-07-21 14:58:56 -0400] amaltson: something about the order of operations is confusing me here :(
[2014-07-21 15:00:15 -0400] someara: amaltson the Chef::Log.info is being evaluated in the compilation phase
[2014-07-21 15:00:28 -0400] someara: you want log 'hi' { message 'blah' }
[2014-07-21 15:00:40 -0400] someara: http://docs.opscode.com/resource_log.html
[2014-07-21 15:02:10 -0400] zeroXten: someara: does the run_state only exist in the compliation phase?
[2014-07-21 15:02:56 -0400] someara: probably
[2014-07-21 15:03:01 -0400] zeroXten: hmm
[2014-07-21 15:03:06 -0400] someara: maybe not though
[2014-07-21 15:03:10 -0400] someara: I've never had the occasion to use it
[2014-07-21 15:03:16 -0400] amaltson: someara: hmm... I'm using node.default['primary']['address'] inside that log block and it still is set to the default from the attributes file
[2014-07-21 15:03:27 -0400] amaltson: so it's not getting overridden by the redis_find_primary LWRP
[2014-07-21 15:03:29 -0400] zeroXten: rtfc it is for me i geuss
[2014-07-21 15:03:53 -0400] amaltson: even though in my output the Chef search finds it fine and gets the ip address
[2014-07-21 15:04:24 -0400] someara: code snippet?
[2014-07-21 15:04:46 -0400] amaltson: someara: see above
[2014-07-21 15:04:49 -0400] someara: oh right
[2014-07-21 15:05:04 -0400] someara: just access node['primary']['address']
[2014-07-21 15:05:15 -0400] someara: node.default would be trying to set it
[2014-07-21 15:05:24 -0400] jtimberman: aaronrl: the load_current_resource code in a provider is evaluated (and shell_out executed therein) when chef manages the resource.
[2014-07-21 15:06:17 -0400] amaltson: someara: the full usage is here:
[2014-07-21 15:06:22 -0400] amaltson: https://www.irccloud.com/pastebin/eCGBsWnF
[2014-07-21 15:09:14 -0400] someara: sec
[2014-07-21 15:10:41 -0400] someara: you're abusing the hell out of attributes
[2014-07-21 15:10:45 -0400] someara: just use variables
[2014-07-21 15:11:05 -0400] someara: attributes aren't really meant to be dynamic
[2014-07-21 15:11:16 -0400] someara: they're meant to be knobs
[2014-07-21 15:12:06 -0400] someara: are you doing a search somewhre?
[2014-07-21 15:13:53 -0400] jbellone: Any Jenkins/Groovy gurus here? Trying to get LDAP authentication/authorization strategies working.
[2014-07-21 15:16:27 -0400] grampajoe: In a spec, is there any way for me to make assertions about what happens inside a block given to a deploy resource's before_symlink?
[2014-07-21 15:16:56 -0400] amaltson: someara: yeah, I guess that's true
[2014-07-21 15:17:19 -0400] amaltson: the IP address is not going to be a knob to pull, it's actually the master search criteria that's being overriden
[2014-07-21 15:17:31 -0400] amaltson: guess I have to use a library to expose it as a variable then?
[2014-07-21 15:17:42 -0400] someara: can you elaborate a little?
[2014-07-21 15:17:47 -0400] someara: so the recipe is seaching
[2014-07-21 15:17:52 -0400] aaronrl: jtimberman, so maybe i'm attacking this wrong, i'm using the load_current_resource to basically test for the existence of a configuration setting in IIS, is there any benefit to doing this in the load_current_resource vs doing the check in each of the action blocks?  is it just a matter of style?
[2014-07-21 15:17:55 -0400] someara: and getting an ipaddress from another node's attributes on the server
[2014-07-21 15:18:02 -0400] amaltson: the LWRP is searching, and the subsequent recipes use the result
[2014-07-21 15:18:11 -0400] someara: k
[2014-07-21 15:18:15 -0400] amaltson: it's just that I was trying to DRY up the code between the replica and sentinel
[2014-07-21 15:18:32 -0400] amaltson: that's why I originally went to definitions
[2014-07-21 15:19:53 -0400] someara: any search in an LWRP is going to "fire" in the converge phase, and the result would be local to the implementation of that resource
[2014-07-21 15:20:03 -0400] someara: a definition would search() in the compilation phase
[2014-07-21 15:20:56 -0400] someara: an_variable = search(:nodes,'stuff')
[2014-07-21 15:21:04 -0400] amaltson: someara: right
[2014-07-21 15:21:17 -0400] amaltson: which is why I was setting it as a node attribute ;)
[2014-07-21 15:21:23 -0400] someara: an_resource { parameter "#{an_variable}" }
[2014-07-21 15:21:37 -0400] someara: yea don't try and store temporary variable data in node attributes
[2014-07-21 15:21:44 -0400] someara: down that path lies madness
[2014-07-21 15:22:16 -0400] amaltson: someara: hehe, fair enough
[2014-07-21 15:22:23 -0400] amaltson: what would you suggest instead?
[2014-07-21 15:22:33 -0400] amaltson: I wonder if trying to DRY up this code is not worth it
[2014-07-21 15:22:42 -0400] someara: I'd have to see more of the code
[2014-07-21 15:23:03 -0400] someara: and understand what's going on more
[2014-07-21 15:25:07 -0400] amaltson: someara: not to take up too much of your time.. essentially I have 3 recipes in this cookbook. Installing the redis master, the redis slave and the redis sentinel. I want the slave and sentinel to dynamically find the master.
[2014-07-21 15:25:24 -0400] someara: k
[2014-07-21 15:25:25 -0400] someara: so
[2014-07-21 15:25:29 -0400] someara: in the master recipe
[2014-07-21 15:25:36 -0400] amaltson: someara: I had the chef search line in both the slave and sentinel recipes and just used local variables
[2014-07-21 15:25:46 -0400] amaltson: but decided to DRY up the code between the slave and sentinel
[2014-07-21 15:26:49 -0400] someara: in the mater recipe, set a node attribute that the slaves will search for.. something like:  node.default['redis']['beacon']['master']
[2014-07-21 15:26:55 -0400] someara: then in the slaves, seach for it
[2014-07-21 15:27:35 -0400] someara: master recipe runs, completes, saves node object back to chef-server
[2014-07-21 15:28:02 -0400] someara: then the slave recipes run, find that node, and pull network topology info
[2014-07-21 15:28:12 -0400] someara: feeding that information into resources
[2014-07-21 15:31:59 -0400] amaltson: someara: hmm, I am externalizing the search criteria and it seems to work fine
[2014-07-21 15:32:13 -0400] amaltson: someara: my main challenge was DRYing up the search code
[2014-07-21 15:32:18 -0400] amaltson: but it seems like it's not worth it?
[2014-07-21 15:32:24 -0400] someara: *shrug*
[2014-07-21 15:32:57 -0400] amaltson: honestly it's only like 4 lines, and most of it is guarding against people running the recipe in Chef Solo
[2014-07-21 15:33:35 -0400] grampajoe: Can I call a resource's callback in a spec and retain its context? E.g. a deploy resource's before_symlink that uses the release_path variable. It could be that I just don't understand Ruby well enough.
[2014-07-21 15:33:44 -0400] someara: id probably just leave it then
[2014-07-21 15:38:15 -0400] amaltson: someara: OK thanks
[2014-07-21 15:42:59 -0400] crumb: hi, i just installed the chef rpm, but when i do chef-server-ctl reconfigure, i get command not found
[2014-07-21 15:52:20 -0400] amaltson: crumb: I assume the install was successful?
[2014-07-21 15:53:13 -0400] crumb: amaltson: yes
[2014-07-21 15:53:24 -0400] amaltson: crumb: what shell are you using?
[2014-07-21 15:53:28 -0400] crumb: bash
[2014-07-21 15:53:31 -0400] amaltson: hmm
[2014-07-21 15:53:33 -0400] amaltson: should pick it up
[2014-07-21 15:53:47 -0400] jtimberman: aaronrl: fwiw, your questions lead me to get a working example to quickly gist, and I just turned it into a blog post :) http://jtimberman.housepub.org/blog/2014/07/21/load-current-resource-and-chef-shell/
[2014-07-21 15:53:47 -0400] amaltson: nothing in /usr/bin/chef-server-ctl
[2014-07-21 15:53:48 -0400] crumb: i exited and logged back in
[2014-07-21 15:54:14 -0400] thom: crumb: you installed chef or chef-server rpm?
[2014-07-21 15:54:23 -0400] crumb: private-chef-11.1.8-1.el6.x86_64.rpm
[2014-07-21 15:54:25 -0400] aaronrl: ha, thanks jtimberman!
[2014-07-21 15:56:04 -0400] crumb: oh, it's supposed to be private-chef-ctl
[2014-07-21 15:58:33 -0400] crumb: how long is it supposed to hang after... - create symlink at /opt/opscode/service/couchdb to /opt/opscode/sv/couchdb
[2014-07-21 16:00:01 -0400] gchristensen: crumb: its the thing happening after that which is hanging, probably
[2014-07-21 16:01:39 -0400] infognom: Hi, i'm more or less a newbie in chef trying to migrate from puppet. However i'm struggling with the status-page on the webserver-ui.
[2014-07-21 16:02:46 -0400] infognom: I'm using  10.18.2 and if i click e.g. on e.g. "19 minutes ago", nothing happens.
[2014-07-21 16:03:42 -0400] infognom: Is there something supposed to happen ? I'm used to the puppet-dashboard which shows me exactly what happened on each run. However i'm struggling to find information about such stuff.
[2014-07-21 16:04:19 -0400] infognom: That is essential visibility to me. But e.g. the REST-API doesn't seem to provide much information here either!
[2014-07-21 16:04:38 -0400] crumb: gchristensen: how do i debug it
[2014-07-21 16:05:01 -0400] gchristensen: -L debug
[2014-07-21 16:05:16 -0400] crumb: where
[2014-07-21 16:06:27 -0400] jtimberman: infognom: unfortunately the open source webui is rather primitive and doesn't have that kind of functionality built in. Also, you're using a really old version of Chef - 10.18.2 was released over 18 months ago.
[2014-07-21 16:07:12 -0400] infognom: Ok, so does that get better with newer version or should i have a look at some tools which i can obtain somewhere?
[2014-07-21 16:22:41 -0400] doug2: anyone got a functional ldap cookbook? The opscode one https://tickets.opscode.com/browse/COOK-4085 has bugs and doesn't work on CentOS
[2014-07-21 16:29:24 -0400] doug2: or... how do I override a package in an upstream cookbook?
[2014-07-21 16:31:16 -0400] bougyman: make a wrapper cookbook
[2014-07-21 16:32:56 -0400] crumb: http://pastebin.com/raw.php?i=2W3X2WjB
[2014-07-21 16:43:20 -0400] doug2: bougyman: sure, and then wrap the upstream ldap? but i need to override the package name, which is wrong
[2014-07-21 16:43:59 -0400] workmad3: doug2: you could change that using chef-rewind in a wrapper cookbook
[2014-07-21 16:44:01 -0400] doug2: the rewind docs don't really make sense in the context of a package
[2014-07-21 16:44:24 -0400] doug2: workmad3: k, dont follow how I would apply that to a package though. examples are all template related
[2014-07-21 16:44:59 -0400] workmad3: doug2: rewind("package[whatever]") do; package_name "correct name"; end
[2014-07-21 16:45:11 -0400] doug2: workmad3: tanx
[2014-07-21 16:45:12 -0400] workmad3: doug2: rewind is just a way of adjusting the attributes of resources
[2014-07-21 16:45:25 -0400] doug2: workmad3: i know. it's the syntaxt that's waxky
[2014-07-21 16:45:27 -0400] doug2: wacky
[2014-07-21 16:46:08 -0400] workmad3: doug2: hmm... seems pretty normal to me... <resource_type>[<resource_name>] for referencing a resource, and then a block of resource attributes
[2014-07-21 16:46:46 -0400] doug2: workmad3: where did you get "package_name" from?
[2014-07-21 16:46:56 -0400] workmad3: doug2: the docs for the package resource on the chef site
[2014-07-21 16:47:12 -0400] doug2: if I look at http://stackoverflow.com/questions/15933157/replacing-a-template-in-a-wrapper-cookbook, it's not clear where 'source' or 'cookbook_name' came from and what they mean
[2014-07-21 16:47:29 -0400] doug2: i think it's a ruby thing. thanks anyway
[2014-07-21 16:47:42 -0400] workmad3: doug2: they're just the attributes you'd set normally
[2014-07-21 16:47:57 -0400] workmad3: doug2: and are documented in the template resource docs in the case of a template ;)
[2014-07-21 16:48:18 -0400] workmad3: doug2: so it's a chef thing more than a ruby thing ;)
[2014-07-21 16:48:29 -0400] doug2: workmad3: even worse
[2014-07-21 16:48:56 -0400] workmad3: doug2: heh :) you're using chef, you may as well get familiar with how things work :P
[2014-07-21 16:49:20 -0400] doug2: workmad3: it's been a year. ruby and I don't get along
[2014-07-21 16:50:16 -0400] doug2: i picked up the basics of python in a couple of days... ruby... it's been a couple of years
[2014-07-21 16:50:55 -0400] workmad3: hmm... I never found ruby that difficult tbh... same with python, but I never particularly liked python
[2014-07-21 16:51:41 -0400] n1ko: both are just as easy/hard to imho, if you are neutral to the languages themselves :)
[2014-07-21 16:52:01 -0400] doug2: ruby, hardest language I've seen in 16 years
[2014-07-21 16:52:04 -0400] n1ko: with an attitude problem, the other language will be IMPOSSIMBRRUU and the other one will just work after 5min
[2014-07-21 16:52:21 -0400] workmad3: doug2: you've never looked at APL? :)
[2014-07-21 16:52:47 -0400] doug2: n1ko: if it's hard to read, i got a bad attitude :)
[2014-07-21 16:53:04 -0400] medya: is CentOs prefered for chef-server or ubuntu ?
[2014-07-21 16:54:03 -0400] n1ko: neither is preferred, both work
[2014-07-21 16:54:17 -0400] n1ko: use the one that you are more familiar with
[2014-07-21 16:55:03 -0400] n1ko: doug2: your previous example wanst hard to read at all, and just the same could be written in python
[2014-07-21 16:55:44 -0400] n1ko: but anyways, personally i have a problem with any language that uses indentation for blocks
[2014-07-21 16:56:09 -0400] n1ko: because im lazy and a fan of autoformat :)
[2014-07-21 16:56:43 -0400] doug2: n1ko: and I'm not a fan of any language where there's 10 ways to do a loop, half of which use pipes
[2014-07-21 16:57:05 -0400] workmad3: n1ko: heh :) before I wrote some python, I thought I'd hate whitespace blocks... when I wrote it, I just didn't care
[2014-07-21 16:57:26 -0400] workmad3: I just find python too verbose and annoying to do certain things (grr, regexp, grr)
[2014-07-21 16:57:38 -0400] n1ko: so what kind of loops are available in ruby that arent in python?
[2014-07-21 16:58:00 -0400] doug2: workmad3: and I don't like translating squiggle. ruby, foo < "a", python foo.append("a")... which is more readable?
[2014-07-21 16:58:21 -0400] medya: is chef-server gonna work on ubuntu 14.04 too ? it is not listed in the supported OS
[2014-07-21 16:58:25 -0400] workmad3: doug2: 'foo.push("a") ' :P
[2014-07-21 16:58:54 -0400] workmad3: doug2: which is also valid ruby
[2014-07-21 16:59:06 -0400] workmad3: doug2: as is .append
[2014-07-21 16:59:12 -0400] doug2: workmad3: no one uses the more reaable... which in itself is an issue
[2014-07-21 16:59:28 -0400] workmad3: doug2: tbh, I'd say ary << "a" is perfectly readable
[2014-07-21 16:59:39 -0400] doug2: workmad3: not me. :)
[2014-07-21 16:59:47 -0400] n1ko: i would too, just like foo += "a" is
[2014-07-21 17:00:01 -0400] workmad3: doug2: I don't tend to optimise for language beginners though... that's the job of tutorials, not real code ;)
[2014-07-21 17:00:02 -0400] jstarcher: Is there an elegant way to set a node attribute from the output of a command I execute? I have a script that generates a password in one recipe and I need to set that password via template in another recipe
[2014-07-21 17:01:26 -0400] workmad3: jstarcher: not particularly... but why have a script generate a password? why not use SecureRandom?
[2014-07-21 17:01:49 -0400] workmad3: jstarcher: e.g. SecureRandom.base64(40) <-- generates a nice long, base64-suitable random string :)
[2014-07-21 17:02:14 -0400] workmad3: jstarcher: or SecureRandom.hex(40) for a 40-char string of hex characters
[2014-07-21 17:02:58 -0400] workmad3: err... 80 even...
[2014-07-21 17:17:53 -0400] doug2: Ugh. why do I have to use CentOS. :(
[2014-07-21 17:22:49 -0400] dkinzer: is there a method to get the platform version?  I want to not do something in a recipe if I'm on Ubuntu 14.04.
[2014-07-21 17:23:47 -0400] thom: dkinzer: http://sysadvent.blogspot.co.uk/2012/12/day-24-twelve-things-you-didnt-know.html#item_4
[2014-07-21 17:24:14 -0400] dkinzer: thom++
[2014-07-21 17:24:31 -0400] Wynn: Quick question for you chef experts. Is there a way to log things like who uploaded a recipe in chef, who deleted a node, or even who ran chef-client on a node?
[2014-07-21 17:24:49 -0400] Wynn: I'm running chef 11
[2014-07-21 17:25:11 -0400] tequilarista: I believe more auditing-type features are pending, but I don't know if they've been released yet
[2014-07-21 17:25:12 -0400] sethvargo: @Wynn see: http://www.getchef.com/blog/2014/07/15/meet-the-chef-analytics-platform/
[2014-07-21 17:25:18 -0400] sethvargo: @tequilarista ^
[2014-07-21 17:25:32 -0400] tequilarista: nice
[2014-07-21 17:25:42 -0400] tequilarista: I'm still struggling with berkshelf 3, so I'm behind on other updates
[2014-07-21 17:25:42 -0400] tequilarista: :)
[2014-07-21 17:26:07 -0400] Wynn: wonderful! Thank you @sethvargo and@tequilarista! =)
[2014-07-21 17:31:34 -0400] dkinzer: Wow, chef has a REPL (that's going to come in super handy).
[2014-07-21 17:31:38 -0400] jstarcher: Is there an elegant way to set a node attribute from the output of a command I execute? I have a script that generates a password in one recipe and I need to set that password via template in another recipe
[2014-07-21 17:33:14 -0400] someara: var = shell_out!('whatevs')
[2014-07-21 17:33:26 -0400] someara: node.default['woot'] = var
[2014-07-21 17:34:32 -0400] crumb: so what's causing this exception.. http://pastebin.com/raw.php?i=2GaHtHEF
[2014-07-21 17:35:18 -0400] crumb: i just ran chef-server-ctl reconfigure
[2014-07-21 17:37:03 -0400] j^2: crumb: do you have /etc/init ?
[2014-07-21 17:38:02 -0400] crumb: no, /etc/init.d
[2014-07-21 17:38:20 -0400] j^2: it's looking for that directory according to that error
[2014-07-21 17:38:46 -0400] crumb: is it because i'm using an rpm intended for rhel6?
[2014-07-21 17:38:52 -0400] jstarcher: @someara: guess that's as elegant as I'll be able to get eh :(
[2014-07-21 17:39:26 -0400] j^2: crumb: what os are you installing it on?
[2014-07-21 17:39:43 -0400] someara: jstarcher prettymuch
[2014-07-21 17:39:50 -0400] crumb: j^2: rhel7
[2014-07-21 17:40:17 -0400] j^2: ah yeah didn't they convert to system init or something in rhel7?
[2014-07-21 17:40:46 -0400] j^2: humor me, create a sysmlink from /etc/init to /etc/init.d and run reconfigure see if taht works
[2014-07-21 17:40:55 -0400] j^2: if it does, then that's probably a bug :)
[2014-07-21 17:41:09 -0400] crumb: kk
[2014-07-21 17:41:24 -0400] j^2: it's not the "right" answer, but it might get you fixed
[2014-07-21 17:42:02 -0400] shlant: anyone familiar with the unicorn cookbook? how do I set it to listen on a socket? I have listen {"/shared/socket/app.sock"} but it's still writing listen "8080", {:tcp_nodelay=>true, :backlog=>100} in the .rb
[2014-07-21 17:42:22 -0400] shlant: jtimberman? ^
[2014-07-21 17:42:48 -0400] crumb: j^2: ERROR: execute[initctl status chef-server-runsvdir] (runit::upstart line 37) had an error: Errno::ENOENT: No such file or directory - initctl status chef-server-runsvdir
[2014-07-21 17:43:15 -0400] j^2: crumb: ah yeah that's not the fix then
[2014-07-21 17:43:34 -0400] crumb: i'll check if they have an rhel6 image then :/
[2014-07-21 17:44:16 -0400] crumb: hmm.. 6.5
[2014-07-21 17:44:31 -0400] crumb: should that work?
[2014-07-21 17:50:55 -0400] someara: el7 ships with systemd
[2014-07-21 17:53:42 -0400] geggam: systemd ..
[2014-07-21 17:54:05 -0400] geggam: its going to be interesting when that hits corp america
[2014-07-21 18:00:52 -0400] Richy_T: Looking for a little direction here. Have some chef recipes etc ready to go, they work fine. Now trying to work out bootstrapping into vmware. OS is Centos. The clone went OK but it complained about a missing distro option so...
[2014-07-21 18:01:51 -0400] Richy_T: I tried --distro centos5-gems but then it complained about a conflict in rdocs and is apparently sitting waiting there for a y/n prompt that I am unable to provide.
[2014-07-21 18:02:39 -0400] Richy_T: So then I tried --distro chef-full but then it starts looking for the validator.pem in /etc/chef instead of using the one specified in ~/.chef/knife.rb
[2014-07-21 18:04:57 -0400] Richy_T: Which seems strange since it is apparently using it for the ssh parameters.
[2014-07-21 18:09:17 -0400] jstarcher: ERROR: Cannot find a resource for shell_out! on centos version 6.5
[2014-07-21 18:09:20 -0400] jstarcher: what are my options?
[2014-07-21 18:14:42 -0400] Richy_T: Nevermind. The pem somehow got truncated.
[2014-07-21 18:25:40 -0400] sarkis: are there better frontend skins for chef-server open source?
[2014-07-21 18:28:31 -0400] troyready: sarkis, My understanding is that basically no community support has developed around that
[2014-07-21 18:28:38 -0400] doug2: Anyone installed ldap with a cookbook for centos?
[2014-07-21 18:29:26 -0400] Mniot: I'm using hosted chef, and on one of my servers I keep getting "ERROR: Failed to post reporting data to server (HTTP 400), saving to /var/chef/cache/failed-reporting-data.json" after a run. Anyone know how I can debug this? I'm not sure where to look to understand why it's failing (and it succeeds on other machines)
[2014-07-21 18:33:15 -0400] coderanger: jstarcher: That isn't a resource, its a helper method. Are you trying to write an LWRP?
[2014-07-21 18:33:43 -0400] coderanger: Mniot: Thats an enterprise-only feature so you are probably best of filing a support ticket with support@getchef.com
[2014-07-21 18:34:02 -0400] coderanger: sarkis: The best skin is to disable it, the web UI in FOSS chef is deprecated and likely a security risk
[2014-07-21 18:34:18 -0400] Mniot: OK. Thank you @coderanger !
[2014-07-21 18:34:30 -0400] bougyman: the web UI in FOSS chef is deprecated?
[2014-07-21 18:34:41 -0400] bougyman: is there a replacement/alternative?
[2014-07-21 18:34:47 -0400] coderanger: Yes, it will be removed in a future version, likely chef-server 12
[2014-07-21 18:34:59 -0400] coderanger: There is not currently any replacement unless you purchase Enterprise Chef
[2014-07-21 18:35:03 -0400] dwradcliffe: oh interesting
[2014-07-21 18:35:03 -0400] bougyman: will there be a replacement/alternative?
[2014-07-21 18:35:09 -0400] dwradcliffe: that's a bummer
[2014-07-21 18:35:18 -0400] bougyman: wth?
[2014-07-21 18:35:26 -0400] fdrolet: 0_o
[2014-07-21 18:36:48 -0400] jblack: git rebase scares me.
[2014-07-21 18:36:53 -0400] coderanger: bougyman: Not unless someone makes one
[2014-07-21 18:37:05 -0400] coderanger: jblack: As it should, rebase is (usually) evil
[2014-07-21 18:37:27 -0400] jblack: anything that necessitates a --force usually is. =)
[2014-07-21 18:37:33 -0400] bougyman: rebases are perfect for topic branches.
[2014-07-21 18:38:23 -0400] coderanger: rebase is good for pull --rebase and nothing else!</huge generalization>
[2014-07-21 18:38:27 -0400] jblack: And chainsaws are perfect for cutting off branches. Still scares the fuck out of me
[2014-07-21 18:38:37 -0400] coderanger: rewriting history that has left your box is Always Wrong!!!! :D
[2014-07-21 18:39:16 -0400] bougyman: so what do you do on a topic branch that's fallen behind the main dev branch?
[2014-07-21 18:41:26 -0400] jblack: Does anyone know if jkeiser is likely to pop onto irc today? I wanted to pounce on him about chef-metal-lxc
[2014-07-21 18:42:24 -0400] coderanger: bougyman: merge
[2014-07-21 18:42:47 -0400] coderanger: jblack: He was traveling most of the weekend, so I wouldn't be surprised if he was watching up on stuffs today
[2014-07-21 18:43:27 -0400] jblack: I'll delay my hassling then. =)
[2014-07-21 18:43:58 -0400] jblack: I've been doing chef conf videos all weeekend.  There is no way I'm going to miss chef conf '15
[2014-07-21 18:47:34 -0400] tequilarista: hey chef peeps  instructions for getting chef server be broken: http://www.getchef.com/blog/2013/03/11/chef-11-server-up-and-running/
[2014-07-21 18:47:40 -0400] tequilarista: access denied errors
[2014-07-21 18:47:42 -0400] tequilarista: (at least for me)
[2014-07-21 18:48:06 -0400] tequilarista: ((using rpm))
[2014-07-21 18:48:06 -0400] doug2: I can't work out where the openldap cookbook is populating dn with vagrantup form.
[2014-07-21 18:49:37 -0400] Derongan: Does anyone have any advice for getting the windows_package to work for removing a package? No matter what I do it yells at me about the installer_type. If I pass in :msi it yells at me for it not being a string, but if I pass in "msi" it yells at me for it not being a valid installer type.
[2014-07-21 18:50:59 -0400] doug2: Why wouldn't override work???
[2014-07-21 18:51:52 -0400] phelms2: Hey does anyone use Foreman with Chef (any good tutorials for it) ?
[2014-07-21 18:52:24 -0400] someara: doug2 try this one out... I took a crack a rewriting openldap last year but never released it
[2014-07-21 18:52:24 -0400] someara: https://github.com/someara/openldap
[2014-07-21 18:53:16 -0400] doug2: someara: That looks a lot like the opscode one... :)
[2014-07-21 18:53:32 -0400] someara: on derp
[2014-07-21 18:53:35 -0400] someara: sec
[2014-07-21 18:53:55 -0400] doug2: oh. thought that was intentional. :)
[2014-07-21 18:54:20 -0400] balbirs: how  can I install knife on a system on which I do not have root access? Can I install it in home directory?
[2014-07-21 18:54:30 -0400] balbirs: basically I need to use knife-ec2 plugins
[2014-07-21 18:54:45 -0400] coderanger: tequilarista: Yes, you find hte latest URLs at http://www.getchef.com/chef/install/
[2014-07-21 18:55:12 -0400] cheeseplus: balbirs: you can just install the gems
[2014-07-21 18:55:13 -0400] doug2: I am curious about this... https://github.com/opscode-cookbooks/openldap/blob/master/attributes/default.rb#L29 ... Will override[] in my wrapper attributes override that?
[2014-07-21 18:55:17 -0400] coderanger: balbirs: gem install --user-install
[2014-07-21 18:55:29 -0400] someara: actually its not...
[2014-07-21 18:55:42 -0400] coderanger: doug2: In a wrapper, no, since it would be set afterwards
[2014-07-21 18:55:43 -0400] someara: its different and the README is probably entirely wrong
[2014-07-21 18:55:51 -0400] someara: which is probably why I didn't release it
[2014-07-21 18:55:54 -0400] cheeseplus: ugh, oscon wifi is awful
[2014-07-21 18:55:56 -0400] coderanger: doug2: attribute files are executed in topological order
[2014-07-21 18:56:09 -0400] doug2: coderanger: confused. happens a lot
[2014-07-21 18:56:30 -0400] doug2: someara: oh. i'll stick with the opscode one for now... which wasn't obviously tested on redhat distros. :(
[2014-07-21 18:56:50 -0400] someara: right... which is what promoted me to fix the one in my repo
[2014-07-21 18:56:52 -0400] coderanger: doug2: if(x==1) { y = 2; }; x = 2;
[2014-07-21 18:56:58 -0400] coderanger: what is value of y when this runs
[2014-07-21 18:57:00 -0400] someara: should work on rhel5
[2014-07-21 18:57:11 -0400] doug2: someara: yours?
[2014-07-21 18:57:15 -0400] someara: yea
[2014-07-21 18:57:29 -0400] doug2: coderanger: sorry, still lost
[2014-07-21 18:57:36 -0400] doug2: coderanger: just want to override
[2014-07-21 18:57:47 -0400] doug2: coderanger: worked the other day under what I thought was the same circumstances
[2014-07-21 18:58:05 -0400] coderanger: doug2: Then make sure your override is set _before_ that file executes
[2014-07-21 18:58:17 -0400] doug2: coderanger: how would one do that?
[2014-07-21 18:59:25 -0400] balbirs: coderanger: gem install --user-install knife-ec2 ?
[2014-07-21 18:59:34 -0400] doug2: coderanger: all I have is a recipe with an include of the wrapper, and an override in my recipe. I have no control over order
[2014-07-21 18:59:44 -0400] coderanger: balbirs: You would need to install chef too, but yes, that should install the gem in to your home dir
[2014-07-21 18:59:49 -0400] doug2: override in attribute file rather
[2014-07-21 19:00:20 -0400] coderanger: doug2: Order is set by a topological sort based on dependency order and run list order
[2014-07-21 19:00:35 -0400] doug2: coderanger: order of what?
[2014-07-21 19:00:46 -0400] coderanger: order of attribute file execution
[2014-07-21 19:00:47 -0400] btm: Developer Office Hours: Join: bit.ly/1nOib3Q Watch: bit.ly/1nOi9Jh
[2014-07-21 19:01:02 -0400] coderanger: read: all your dependencies are executed before yourself
[2014-07-21 19:01:15 -0400] doug2: coderanger: between cookbooks or attribute files within a single cookbook?
[2014-07-21 19:01:52 -0400] coderanger: Between cookbooks, within a single cookbook order is asciibetical give or take use of include_attribute
[2014-07-21 19:02:24 -0400] doug2: coderanger: but if a cookbook includes another, the order is clearly established.
[2014-07-21 19:03:28 -0400] coderanger: Do you mean include_recipe?
[2014-07-21 19:03:42 -0400] doug2: coderanger: Yes
[2014-07-21 19:03:44 -0400] coderanger: If so, that has no effect on load order, it is a procedural statement
[2014-07-21 19:04:04 -0400] coderanger: the only things that affect load order are cookbook dependencies and run list order
[2014-07-21 19:04:36 -0400] doug2: coderanger: well my run list has one item... my wrapper cookbook
[2014-07-21 19:05:57 -0400] tinyjason: Hey all, im trying to login to the chef management portal, but it keeps saying my password is wrong. I reset it and still same issue. Try to sign up again says my email already used. Anyone had the same issue?
[2014-07-21 19:06:03 -0400] sarkis: coderanger: what do you mean? just disable the admin pane;?
[2014-07-21 19:06:07 -0400] sarkis: web admin panel*
[2014-07-21 19:06:52 -0400] sarkis: so kinda being forced to go with hosted chef then? :)
[2014-07-21 19:07:14 -0400] coderanger: sarkis: Or just use knife and other CLI tools
[2014-07-21 19:07:35 -0400] coderanger: sarkis: If you want a web interface, them yes, that is a feature of the paid version now (enterprise chef, either hosted or local)
[2014-07-21 19:07:39 -0400] sarkis: i see
[2014-07-21 19:07:50 -0400] coderanger: tinyjason: On getchef.com or your own server?
[2014-07-21 19:07:56 -0400] doug2: if someone could point me to some clear documentation on how one might override attributes in a simple example that would be helpful. I've been working with chef daily for a year and I still can't fathom it
[2014-07-21 19:08:19 -0400] coderanger: doug2: as I said, a wrapper can't override dependent attributes
[2014-07-21 19:08:42 -0400] tinyjason: @coderanger, i can login to getchef.com, then when i click management console on the top, it takes me to manage.opscode.com where i cant login
[2014-07-21 19:08:43 -0400] doug2: coderanger: I was able to do it with the java cookbook
[2014-07-21 19:09:10 -0400] doug2: coderanger: by dependant attributes, do you mean attributes that are calculated?
[2014-07-21 19:09:29 -0400] coderanger: doug2: Yes, attributes that depend on other attributes at execution time
[2014-07-21 19:09:48 -0400] coderanger: tinyjason: Hmm, can you login on supermarket.getchef.com?
[2014-07-21 19:10:23 -0400] doug2: coderanger: ok, i suspected that although I've never seen it documented. So if someone writes a cookbook like that, you can't override those values. This, err... person's attributes chef if the box has a domain name configured and if so hard code the ldap settings on that. Why would someone do something like that?!??!
[2014-07-21 19:10:47 -0400] doug2: rather, why would opscode do that
[2014-07-21 19:11:49 -0400] tinyjason: @coderanger, no i cannot, i was having issues seeing the subscription tab on getchef.com as well that seems to be intermitant sometimes it loads sometimes not, really long page load.
[2014-07-21 19:12:13 -0400] coderanger: tinyjason: Okay, please email support@getchef.com, they will check it out for you
[2014-07-21 19:12:46 -0400] doug2: oh well, time to git clone the openldap cookbook
[2014-07-21 19:13:02 -0400] tinyjason: thanks
[2014-07-21 19:13:03 -0400] coderanger: doug2: node['domain'] is set by ohai, you can't override that
[2014-07-21 19:13:34 -0400] doug2: coderanger: yes but the cookbook sets the dn to be the same as the domain if the box has a domain configured.
[2014-07-21 19:14:11 -0400] coderanger: yes, that seems reasonable to me
[2014-07-21 19:14:44 -0400] coderanger: you can override node['openldap']['basedn'] yourself if you want to, its just a sane default
[2014-07-21 19:14:58 -0400] doug2: coderanger: that's what I tried to do, and it didn't stick
[2014-07-21 19:15:12 -0400] coderanger: That isn't the line you asked about
[2014-07-21 19:15:16 -0400] doug2: coderanger: however, since the value is derived, it doesn't work
[2014-07-21 19:15:18 -0400] jblack: wow, $120/mo for 20 nodes?
[2014-07-21 19:15:20 -0400] coderanger: Please ask more accurate questions in the future
[2014-07-21 19:15:31 -0400] sarkis: coderanger: is there info on disabling the webui? or do i have to just remove nginx component
[2014-07-21 19:15:31 -0400] JoshZ_: jtimberman: do you have write access on the windows cookbook?
[2014-07-21 19:16:02 -0400] sarkis: found it sorry
[2014-07-21 19:16:06 -0400] coderanger: sarkis: In your /etc/chef-server/chef-server.rb (you may have to create it): chef_server_webui['enable'] = true
[2014-07-21 19:16:12 -0400] coderanger: sarkis: And then chef-server-ctl reconfigure
[2014-07-21 19:16:15 -0400] doug2: coderanger: well now I don't know what I asked. Forget it
[2014-07-21 19:16:46 -0400] coderanger: sarkis: er, make that false :)
[2014-07-21 19:17:00 -0400] sarkis: right, also in the chef-server github readme :).. ty sir
[2014-07-21 19:17:05 -0400] JoshZ_: can someone with write access on the windows cookbook merge or fix https://github.com/opscode-cookbooks/windows/pull/92 it is failing the whole cookbook.
[2014-07-21 19:17:10 -0400] doug2: back to square one. not sure how to override attibutes. maybe I'll get lucky
[2014-07-21 19:18:30 -0400] tinyjason: @coderanger, fyi i submitted a ticket a little while later i got an email back from a ticket system, then i recieved an email with this "We're sorry, an error occured while processing your request. Please try again."
[2014-07-21 19:18:54 -0400] tinyjason: weird my brain hurts
[2014-07-21 19:21:23 -0400] jblack: You're lucky it's an unusual occurrence. =) That's a frequent even for many.
[2014-07-21 19:21:46 -0400] shlant: coderanger: how would I add something like rake assets:precompile into the application_ruby LWRP?
[2014-07-21 19:22:15 -0400] shlant: callbacks?
[2014-07-21 19:22:53 -0400] coderanger: shlant: as always, I really recommend not using app_* right now, pending a large scale reworking (if I ever find funding for it), but yeah, callback hook + execute resource
[2014-07-21 19:23:30 -0400] shlant: coderanger: I'm too deep in to not use it now :) thanks I'l try that
[2014-07-21 19:23:57 -0400] doug2: if I have a wrapper cookbook, and I want to override some values in a wrapped cookbook, where do I set those? Do I put them in the attributes file of the wrapper cookbook or the recipe of the wrapper cookbook?
[2014-07-21 19:24:01 -0400] coderanger: shlant: I figured, but gotta say it anyway :)
[2014-07-21 19:24:32 -0400] coderanger: doug2: If you would like more personalized support, as always I recommend you find someone that will provide you training and mentorship services
[2014-07-21 19:25:04 -0400] jtimberman: JoshZ_: I "do" but I'm not actively involved in managing that cookbook.
[2014-07-21 19:25:16 -0400] doug2: coderanger: i would think that this is a pretty basic question.
[2014-07-21 19:25:24 -0400] n1ko: doug2: where ever you want. attributes, recipe,role
[2014-07-21 19:25:31 -0400] coderanger: doug2: Nor would I, and yet you ask it.
[2014-07-21 19:25:41 -0400] JoshZ_: ok I think someone just took care of it... testing now...
[2014-07-21 19:25:47 -0400] doug2: coderanger: I ask it because it's not well documented
[2014-07-21 19:25:51 -0400] n1ko: personally i wouldnt put anything in roles, and use recipe if the value is somehow dynamically generated in the recipe
[2014-07-21 19:25:56 -0400] n1ko: and use attributes as a default
[2014-07-21 19:26:04 -0400] jtimberman: JoshZ_: i pinged folks
[2014-07-21 19:26:12 -0400] jtimberman: JoshZ_: that PR can't be automatically merged
[2014-07-21 19:26:13 -0400] doug2: n1ko: soo... I tried the attributes of the wrapper cookbook but that dind't work. coderanger tried to explain why but it made no sense to me
[2014-07-21 19:26:46 -0400] JoshZ_: jtimberman: Thanks tons!! the reverted it instead so I will close the PR. Thanks!
[2014-07-21 19:26:47 -0400] n1ko: it works just fine
[2014-07-21 19:26:54 -0400] doug2: n1ko: Hmm.
[2014-07-21 19:27:05 -0400] doug2: n1ko: what level? override? default? force? something else?
[2014-07-21 19:27:10 -0400] n1ko: any level
[2014-07-21 19:27:19 -0400] doug2: n1ko: well i'm just plain unlucky then
[2014-07-21 19:27:28 -0400] jtimberman: JoshZ_: k :)
[2014-07-21 19:27:29 -0400] n1ko: the only problem i have had with it is that if the cookbook you are using is doing stuff like foo = bar
[2014-07-21 19:27:31 -0400] doug2: n1ko: except ... if the values are derived, it won't work...
[2014-07-21 19:27:36 -0400] n1ko: and you are doing bar = "tits"
[2014-07-21 19:27:41 -0400] n1ko: in attributes, in wrapper
[2014-07-21 19:27:47 -0400] n1ko: then foo wont be tits
[2014-07-21 19:27:50 -0400] doug2: n1ko: and this looks pretty derived to me... https://github.com/opscode-cookbooks/openldap/blob/master/attributes/default.rb#L29
[2014-07-21 19:27:58 -0400] n1ko: because its evaluated before your override
[2014-07-21 19:28:28 -0400] doug2: n1ko: your setting two different attributes there...
[2014-07-21 19:28:50 -0400] doug2: n1ko: and coderanger went on about how the cookbook order makes a bid difference... so it seems there are some caveats
[2014-07-21 19:28:59 -0400] n1ko: yes, its a chain
[2014-07-21 19:29:08 -0400] n1ko: that is evaluated in another order than you would usually want
[2014-07-21 19:29:17 -0400] doug2: n1ko: *blank stare*
[2014-07-21 19:29:29 -0400] n1ko: well think of normal code
[2014-07-21 19:29:31 -0400] doug2: this really shouldn't be complicated.
[2014-07-21 19:29:44 -0400] shlant: doug2: usually you don't want to use override unless absolutely necesary or else you run into things like cookbook order
[2014-07-21 19:29:49 -0400] doug2: normal code is easy... it's all laid out in front of you
[2014-07-21 19:30:03 -0400] doug2: shlant: the opscode openldap cookbook has bugs
[2014-07-21 19:30:33 -0400] doug2: shlant: and ... I want to override the DN
[2014-07-21 19:30:35 -0400] n1ko: the opscode cookbooks doesnt seem to be any higher quality then third party cookbooks
[2014-07-21 19:30:41 -0400] coderanger: doug2: There are two different issues, 1) you can't override node['domain'] at all, 2) you can't override derived attributes without overriding all of them
[2014-07-21 19:30:43 -0400] n1ko: its a shame, but true
[2014-07-21 19:30:58 -0400] doug2: n1ko: sure, except they wrote it for unbuntu and it tries to install packages that don't exist on redhat
[2014-07-21 19:31:16 -0400] coderanger: doug2: Also watch you attitude, you know you are on a short leash
[2014-07-21 19:31:35 -0400] doug2: coderanger: i don't want to override node['domain']. I want to override node['openldap']['basedn']
[2014-07-21 19:31:49 -0400] n1ko: doug2: then fix it, make a pr or if you dont know how to fix it make a pr removing the rhel-family support :)
[2014-07-21 19:31:49 -0400] doug2: coderanger: I am asking questions.
[2014-07-21 19:32:15 -0400] doug2: n1ko: i can use rewind to fix the package issues. i just want to override ode['openldap']['basedn']
[2014-07-21 19:32:29 -0400] n1ko: ugh rewind
[2014-07-21 19:32:37 -0400] n1ko: that is a thing that should not have been invented
[2014-07-21 19:32:55 -0400] n1ko: but considering the monkey patching culture in ruby i guess it was kinda expected
[2014-07-21 19:33:06 -0400] doug2: hehe
[2014-07-21 19:33:12 -0400] shlant: n1ko: haha when I first discovered rewind I thought it was magical
[2014-07-21 19:33:26 -0400] doug2: anyway, how would one override node['openldap']['basedn'] ?
[2014-07-21 19:33:45 -0400] coderanger: doug2: Then you shouldn't have posted a link with a different line highlighted
[2014-07-21 19:33:52 -0400] doug2: putting override['openldap']['basedn'] in my wrapper did not seem to work
[2014-07-21 19:34:20 -0400] coderanger: As for the basedn attribute, that is correct, just ensure your wrapper cookbook has the dependency on the openldap one
[2014-07-21 19:34:22 -0400] doug2: coderanger: that's the line that sets node['openldap']['basedn'] if node['domain'] is set
[2014-07-21 19:34:49 -0400] doug2: coderanger: and... I need to override node['openldap']['basedn']
[2014-07-21 19:34:55 -0400] jtimberman: node.set['openldap']['basedn'] = 'dc=example.com'
[2014-07-21 19:34:58 -0400] jtimberman: or whatever
[2014-07-21 19:35:08 -0400] jtimberman: node.default should work too
[2014-07-21 19:35:11 -0400] jtimberman: in a recipe
[2014-07-21 19:35:13 -0400] doug2: jtimberman: in the recipe? n1ko said I could do it in the attributes files
[2014-07-21 19:35:19 -0400] jtimberman: You "can"
[2014-07-21 19:35:30 -0400] doug2: i would prefer to...
[2014-07-21 19:35:33 -0400] shlant: doug2:  if you do it in an attribute file, you need higher precedence
[2014-07-21 19:35:35 -0400] coderanger: jtimberman: No, that would be incorrect
[2014-07-21 19:35:42 -0400] jtimberman: coderanger: what
[2014-07-21 19:35:45 -0400] shlant: node.force_default
[2014-07-21 19:35:45 -0400] doug2: shlant: meaning? override? (didn't work for me)
[2014-07-21 19:35:49 -0400] jtimberman: specify "that"
[2014-07-21 19:36:02 -0400] doug2: and why isn't override good enough?
[2014-07-21 19:36:26 -0400] shlant: doug2: override is like using a flamethrower to kill a behive
[2014-07-21 19:36:30 -0400] shlant: it's overkill :p
[2014-07-21 19:36:37 -0400] doug2: i thought override was a higher precedence than default.
[2014-07-21 19:36:39 -0400] shlant: us the next precedence level up
[2014-07-21 19:36:43 -0400] shlant: it is
[2014-07-21 19:36:45 -0400] doug2: shlant: yes, but override doesn't actually work
[2014-07-21 19:36:54 -0400] doug2: shlant: how can it be overkill if it doesn't work?
[2014-07-21 19:36:56 -0400] shlant: doug2: please post your code
[2014-07-21 19:37:03 -0400] doug2: k
[2014-07-21 19:37:24 -0400] n1ko: it should work with or without override
[2014-07-21 19:37:35 -0400] n1ko: the attribute file in wrapper is processed after the ldap cookbook
[2014-07-21 19:37:41 -0400] n1ko: so even default should handle it
[2014-07-21 19:38:06 -0400] n1ko: _should_, but easily tested if you have the env
[2014-07-21 19:38:10 -0400] shlant: ror
[2014-07-21 19:38:12 -0400] shlant: oops
[2014-07-21 19:38:15 -0400] jtimberman: attributes files are evaluated in "run list order"
[2014-07-21 19:38:21 -0400] n1ko: doug2: you did remember to update your cookbooks after making the change?
[2014-07-21 19:38:27 -0400] jtimberman: followed by "all the other cookbooks attributes files" if they're not in the run list
[2014-07-21 19:38:30 -0400] n1ko: you need to override your cookbook if you didnt bump the version
[2014-07-21 19:38:47 -0400] doug2: n1ko: all vagrant at this point
[2014-07-21 19:38:49 -0400] doug2: http://pastebin.com/hsrY7Z8P
[2014-07-21 19:39:15 -0400] n1ko: by vagrant you mean what exactly? chef-zero or chef-solo? berkshelf/librarion?
[2014-07-21 19:39:18 -0400] doug2: in this case the basedn is coming out the other end with vagrantup
[2014-07-21 19:39:28 -0400] doug2: n1ko: just vagrant vagrant... kitchen
[2014-07-21 19:39:48 -0400] shlant: doug2:  if that is all in a recipe it would be node.override['openldap']['basedn'] = "dc=footest,dc=com"
[2014-07-21 19:39:59 -0400] shlant: but I would just use node.default
[2014-07-21 19:40:04 -0400] doug2: shlant: I'd prefer not to put it in the recipe.
[2014-07-21 19:40:32 -0400] shlant: doug2: you could put it in a attribute file as force_default['openldap']['basedn'] = "dc=footest,dc=com"
[2014-07-21 19:40:44 -0400] doug2: shlant: i'll give that a try
[2014-07-21 19:40:45 -0400] sarkis: coderanger: so looks like i still need to leave nginx enabled, even if i disable the webui?
[2014-07-21 19:40:48 -0400] shlant: or a role as default
[2014-07-21 19:40:56 -0400] shlant: or environment as default
[2014-07-21 19:41:07 -0400] coderanger: sarkis: Yes, nginx acts as a proxy for several internal servers
[2014-07-21 19:41:10 -0400] sarkis: coderanger: i assume to allow the differnt tools like knife and berkshelf-api
[2014-07-21 19:41:13 -0400] sarkis: right
[2014-07-21 19:41:17 -0400] coderanger: sarkis: (erchef, bookshelf, etc)
[2014-07-21 19:41:42 -0400] sarkis: coderanger: i just get a 502 when trying to hit the subdomain i have chef on
[2014-07-21 19:41:54 -0400] coderanger: sarkis: hit it via what?
[2014-07-21 19:42:04 -0400] sarkis: with a web browser
[2014-07-21 19:42:10 -0400] coderanger: sarkis: Yes, that would be correct
[2014-07-21 19:42:16 -0400] sarkis: just wondering if theres a nicer page i should be seeing..
[2014-07-21 19:42:18 -0400] sarkis: cool ty :)
[2014-07-21 19:42:37 -0400] coderanger: sarkis: Nope, disabling the web UI doesn't actually remove its proxy config, so nginx just can't reach it
[2014-07-21 19:44:59 -0400] doug2: well, I don't believe force_override has worked
[2014-07-21 19:45:21 -0400] coderanger: doug2: You don't need force_override or anything else fancy, this is a very simple task
[2014-07-21 19:45:41 -0400] doug2: the wrapped cookbook is still setting node['openldap']['basedn'] to be node['domain']
[2014-07-21 19:45:49 -0400] coderanger: doug2: you need the following in your attributes/default.rb in the wrapper cookbook: default['openldap']['basedn
[2014-07-21 19:45:55 -0400] coderanger: '] = 'whatever'
[2014-07-21 19:46:07 -0400] doug2: ccoderanger: tried that before. will try again
[2014-07-21 19:46:10 -0400] coderanger: thats it, if that isn't working, likely you have your wrapper cookbook set up incorrectly
[2014-07-21 19:46:21 -0400] maccam94: out of curiosity, is it possible to browse to the chef download page from www.getchef.com? I spent amount 5 minutes looking for a way to navigate there before just googling it
[2014-07-21 19:46:34 -0400] coderanger: and I will say again, if you would like line-by-line assistance, you need to hire someone to provide you dedicated support
[2014-07-21 19:46:43 -0400] jtimberman: maccam94: big orange Get Chef button at the top
[2014-07-21 19:46:47 -0400] n1ko: maccam94: yeah, ridiculously hard these days :D
[2014-07-21 19:47:02 -0400] jtimberman: Then in the field of OMG ORANGE, there's a "Start here" Link
[2014-07-21 19:47:03 -0400] coderanger: maccam94: Yes, big Get Chef button and then the horrible orange-on-organge link
[2014-07-21 19:47:11 -0400] maccam94: oooh, i see it in the dark orange on light orange background now
[2014-07-21 19:47:26 -0400] doug2: coderanger: I suppose asking for docs again would represent a bad attitude
[2014-07-21 19:47:27 -0400] jtimberman: i brought up the unreadability of that
[2014-07-21 19:47:38 -0400] maccam94: above the eye catching HOSTED CHEF and ON PREMISES CHEF buttons now
[2014-07-21 19:47:40 -0400] maccam94: cool
[2014-07-21 19:47:44 -0400] jtimberman: so hopefully we get a fix soon
[2014-07-21 19:47:53 -0400] jtimberman: i love {Chef,Opscode} orange.
[2014-07-21 19:47:59 -0400] jtimberman: but too much orange is ... too much :)
[2014-07-21 19:48:02 -0400] n1ko: chefdk+oss server is also nicely hidden in the choose-your-version page
[2014-07-21 19:48:13 -0400] n1ko: its like the whole sit isnt for people that actually is going to use chef :)
[2014-07-21 19:48:24 -0400] maccam94: heh. also, if that text included the word "download" that would be great :)
[2014-07-21 19:48:24 -0400] n1ko: but for enterprise project manager director of devops kinda guys
[2014-07-21 19:52:10 -0400] shlant: coderanger: can I alternatively use deploy/before_restart.rb instead of the before_restart callback?
[2014-07-21 19:52:14 -0400] doug2: Using http://pastebin.com/N0YM4Adx does not work. default doesn't seem to work
[2014-07-21 19:52:57 -0400] doug2: The log statement at the end is loggin log[######### dc=vagrantup,dc=com]
[2014-07-21 19:53:17 -0400] shlant: doug2: please read what I said. If you want to put them in attributes, it needs to be force_default['openldap']['basedn'] = "dc=footest,dc=com"
[2014-07-21 19:53:35 -0400] doug2: shlant: coderanger said to use default not force_default
[2014-07-21 19:53:50 -0400] doug2: "doug2: you need the following in your attributes/default.rb in the wrapper cookbook: default['openldap']['basedn"
[2014-07-21 19:54:17 -0400] coderanger: shlant: I'm not sure I've ever tested those, they are part of the deploy resource itself instead of the app* code
[2014-07-21 19:54:48 -0400] coderanger: doug2: cat attribudes/default.rb
[2014-07-21 19:54:57 -0400] coderanger: doug2: You will note that is not spelled correctly
[2014-07-21 19:55:12 -0400] shlant: that'll do it
[2014-07-21 19:56:18 -0400] doug2: omg. *sigh*
[2014-07-21 19:56:48 -0400] doug2: well, thanks
[2014-07-21 19:59:50 -0400] shlant: doug2: note that default is correct as your wrapper is run AFTER the openldap cookbook. I had said force_default because then you do not need to know that run order
[2014-07-21 19:59:53 -0400] shlant: either works
[2014-07-21 20:01:30 -0400] doug2: k
[2014-07-21 20:03:37 -0400] prometheanfire: where is the open source chef server source located?
[2014-07-21 20:03:52 -0400] crumb: so i'm guessing chef enterprise failed on rhel7 because of their new init system
[2014-07-21 20:04:57 -0400] jtimberman: prometheanfire: its in several repositories on github, built together with omnibus. start here: https://github.com/opscode/erchef
[2014-07-21 20:05:06 -0400] prometheanfire: that's right, erlang
[2014-07-21 20:05:54 -0400] keftes: hey - is there a way to knife bootsrap and copy a databag encryption key as part of the knife statement? or do I simply have to scp it over before i run knife/chef? --secret-file seems to only be there so you can specify where on the NODE you want to chef to look for the key
[2014-07-21 20:06:25 -0400] doug2: well i guess I'll have to fork the openldap cookbook anyway. it's got options for TLS but the templates have hard coded values that won't work with that
[2014-07-21 20:09:17 -0400] bougyman: keftes: if you have knife[:secret_file] = defined in your knife.rb it will put that key on the nodes you bootstrap
[2014-07-21 20:09:58 -0400] ickymettle: afternoon chefs ... does anyone happen to know the magic incantation to have chef-metal with the fog driver use an ssh-gateway for provisioning? (a'la knife bootstrap ec2 --ssh-gateway option ?)
[2014-07-21 20:10:01 -0400] keftes: hmm - the thing is though that your workstation usually manages multiple chef environments - and you have multiple secret files
[2014-07-21 20:10:20 -0400] keftes: so depending on what you bootstrap you're likely to need a different secret copied
[2014-07-21 20:10:25 -0400] keftes: e.g qa/ staging / dev / prod etc
[2014-07-21 20:10:29 -0400] prometheanfire: jtimberman: trying to figure out how we can package chef-server for gentoo...
[2014-07-21 20:10:31 -0400] jtimberman: ickymettle: perhaps use ~/.ssh/config?
[2014-07-21 20:10:53 -0400] prometheanfire: same problem we have with vagrant
[2014-07-21 20:11:02 -0400] prometheanfire: very anti-packaging :(
[2014-07-21 20:12:41 -0400] jtimberman: prometheanfire: probably place to start is getting gentoo ebuild as an output from omnibus-ruby or fpm.
[2014-07-21 20:12:50 -0400] jtimberman: ebuild/whatever gentoo's binary package format is
[2014-07-21 20:13:20 -0400] ickymettle: jtimberman: thx will see if I can get that approach working
[2014-07-21 20:13:23 -0400] prometheanfire: binary?
[2014-07-21 20:13:25 -0400] prometheanfire: what's that? :P
[2014-07-21 20:13:44 -0400] jtimberman: doesn't gentoo have package artifacts of some kind?
[2014-07-21 20:13:58 -0400] prometheanfire: we do, but it's just a tarball
[2014-07-21 20:14:00 -0400] juliancdunn: --funroll-loops
[2014-07-21 20:14:23 -0400] prometheanfire: let me have graff join, he's our ruby guy
[2014-07-21 20:14:24 -0400] jtimberman: omnibus-ruby can make a self-extracting tarball, we had such a thing for the OS X packages.
[2014-07-21 20:15:05 -0400] prometheanfire: well, we install to an image directory then copy to the live filesystem
[2014-07-21 20:15:28 -0400] jtimberman: the thing to do i think is get omnibus to output the thing you want.
[2014-07-21 20:15:44 -0400] jtimberman: it will build in a directory
[2014-07-21 20:15:55 -0400] jtimberman: that we normally point at for fpm
[2014-07-21 20:16:01 -0400] jtimberman: to make the rpms/debs.
[2014-07-21 20:16:20 -0400] jtimberman: and it's built in a test kitchen environment.
[2014-07-21 20:17:10 -0400] prometheanfire: we can actually install from debs/rpms
[2014-07-21 20:17:58 -0400] tom13: I installed the new chef-dk, where do I put my knife.rb and private keys on the workstation to connect to my chef-server?
[2014-07-21 20:18:10 -0400] jtimberman: tom13: same place as before.
[2014-07-21 20:18:11 -0400] keftes: same place as before ?
[2014-07-21 20:18:16 -0400] jtimberman: ./.chef, or ~/.chef
[2014-07-21 20:18:26 -0400] jtimberman: where the former is in a per-repository location
[2014-07-21 20:18:39 -0400] prometheanfire: for now I'll package the client
[2014-07-21 20:18:42 -0400] tom13: it is a new workstation there is no .chef folder here
[2014-07-21 20:18:44 -0400] prometheanfire: we can do that easilly enough
[2014-07-21 20:18:49 -0400] prometheanfire: graaff: hi :D
[2014-07-21 20:19:08 -0400] bougyman: keftes: yes, I handle that with condidionals in my knife.rb
[2014-07-21 20:19:32 -0400] keftes: ooh
[2014-07-21 20:19:35 -0400] keftes: interesting
[2014-07-21 20:19:36 -0400] tom13: @keftes there is no .chef on my wokrstiation
[2014-07-21 20:19:45 -0400] keftes: (mkdir it)
[2014-07-21 20:19:55 -0400] tom13: @ do I need to do apt-get install chef  after installing chef-dk ?
[2014-07-21 20:20:11 -0400] bougyman: keftes: mine relies on an environment variable being set (CHEF_ENV)
[2014-07-21 20:20:19 -0400] bougyman: but that's handled automatically for me with rvm hooks.
[2014-07-21 20:20:29 -0400] tom13: @keftes, do you know mkdir ~/.chef and just put my private key and knife.rb there , thats it ??
[2014-07-21 20:20:49 -0400] prometheanfire: graaff: we might want to talk here, not sure
[2014-07-21 20:20:54 -0400] Derongan: Does anyone have any idea how I could get the windows_package to work with :remove. No matter what I do I get yelled at for my installer_type argument. :msi -> not a string "msi" not recongized
[2014-07-21 20:21:21 -0400] tom13: @keftes in the past I dont remember creating .chef directory manually ...
[2014-07-21 20:21:34 -0400] keftes: you only do that if you want to work with knife
[2014-07-21 20:21:45 -0400] keftes: knife configure -i and put it wherever you want tbh
[2014-07-21 20:31:39 -0400] graaff: jtimberman: I'm looking at the ruby side of Gentoo for prometheanfire. Why do you have a dependency on <=json-1.8.1 ?
[2014-07-21 20:31:52 -0400] tom13: if I create my chef-repo using the new "chef generate app name" where do I put my private key for the chef-server ?
[2014-07-21 20:32:21 -0400] jtimberman: graaff: because the json gem has a history of being released with backwards incompatible/breaking changes in patch releases
[2014-07-21 20:33:04 -0400] jtimberman: some background https://github.com/flori/json/issues/160
[2014-07-21 20:33:07 -0400] prometheanfire: graaff: we are just looking at the client side for now, correct?
[2014-07-21 20:33:08 -0400] graaff: jtimberman: as far as I know those are acknowledged by upstream to be bugs, right, and fixed in later releases?
[2014-07-21 20:36:26 -0400] jtimberman: graaff: we're using that constraint to be defensive.
[2014-07-21 20:36:26 -0400] graaff: jtimberman: I think what I'm reading in that ticket is that the answer to my question is yes.
[2014-07-21 20:37:14 -0400] jtimberman: graaff: because we have had several occassions where a patch release of json has required us to release entire new versions of chef.
[2014-07-21 20:37:43 -0400] jtimberman: past history is not an indicator of future performance, but better safe than sorry :)
[2014-07-21 20:37:50 -0400] graaff: jtimberman: I understand that. But things will get complicated when json 1.8.1 is no longer the latest version.
[2014-07-21 20:37:59 -0400] sarkis:  /join ##aws
[2014-07-21 20:38:01 -0400] sarkis: oops
[2014-07-21 20:38:58 -0400] graaff: And I realize that I'm looking at this from an full-OS point of view, not the customary ruby point of view. Having loosely coupled dependencies helps a lot for ut.
[2014-07-21 20:39:00 -0400] graaff: us
[2014-07-21 20:41:54 -0400] graaff: I guess we could relax that dependency at the risk of introducing issues with json. Then again new json versions aren't available automatically either.
[2014-07-21 20:42:17 -0400] prometheanfire: graaff: true, we could field bugs about it ourselves and limit if needed
[2014-07-21 20:43:24 -0400] graaff: While I'm here, could I ask that current tags for mixlib-log are pushed to git? 1.4.1 is the latest tagged release but the actual release is 1.6.0.
[2014-07-21 20:55:57 -0400] Neozonz|Disc: anyone know how to deploy php app onto a custom opsworks layer?
[2014-07-21 20:56:06 -0400] Neozonz|Disc: I've included the default deploy::php on the custom layer but no luck
[2014-07-21 20:58:00 -0400] jtimberman: graaff: so, the whole point of omnibus is that we have tight control over the dependencies, and we purposefully don't use "distro" provided packages of anything, and compile it all, because we can't be sure that the world won't change around us and make things uninstallable. it's not an issue to a specific distro, but rather to all of them since everyone has disagreement on which version of any arbitrary software should be installed and
[2014-07-21 20:58:00 -0400] jtimberman:  usable by default.
[2014-07-21 21:01:46 -0400] Medya: how to bootstrap a node with SSH Key as opposed to SSH Password ?
[2014-07-21 21:04:35 -0400] bougyman: Medya: -i and -x together
[2014-07-21 21:04:41 -0400] bougyman: knife bootstrap --help
[2014-07-21 21:19:42 -0400] shlant: jtimberman: does the runit_service LWRP create an app user, or do I have to do that?
[2014-07-21 21:20:12 -0400] jtimberman: you have to do that
[2014-07-21 21:20:19 -0400] shlant: alright thanks
[2014-07-21 21:26:15 -0400] rkgarcia: I don't know how to start with chef :(
[2014-07-21 21:28:30 -0400] sam__: Question: How can I use ruby variables in directory resource ... instance="`uname -n | cut -d. -f1`-1" ; %w[ /myfolder/#{instance} ].each do |path| directory path
[2014-07-21 21:28:39 -0400] cheeseplus: rkgarcia: http://learn.getchef.com/
[2014-07-21 21:29:04 -0400] rkgarcia: thanks cheeseplus
[2014-07-21 21:29:05 -0400] sam__: this doesnt seem to pick the value for "instance"
[2014-07-21 21:32:11 -0400] coderanger: sam__: Several issues, the %w syntax doesn't support interpolation, you probably don't want to be shelling out to uname like that when the data is already available in ohai, and you probably mean something like node['instance']
[2014-07-21 21:32:16 -0400] coderanger: sam__: What are you trying to accomplish?
[2014-07-21 21:32:56 -0400] coderanger: sam__: There is a %W that supports interpolation I think, but if its really a list of one element I would stick to ["/foo/#{bar}"]
[2014-07-21 21:35:29 -0400] Medya: @bougyman when I try to use both -i and -x to bootstrap a node without password but with SSH, it still asks for my password and says Failed to authenticate ubuntu - trying password auth
[2014-07-21 21:35:44 -0400] coderanger: Medya: Are you sure you have the right key?
[2014-07-21 21:35:53 -0400] bougyman: so then your key isn't making into ubuntu's ~/.ssh/authorized_keys
[2014-07-21 21:35:56 -0400] coderanger: Medya: read: does ssh -i work with the same key/username?
[2014-07-21 21:35:57 -0400] bougyman: or perms on that file is wrong.
[2014-07-21 21:36:16 -0400] bougyman: or yah, you're using the wrong key
[2014-07-21 21:36:22 -0400] Medya: good question ! :)
[2014-07-21 21:36:26 -0400] coderanger: Medya: Assuming AWS, make sure you are in the region you think you are, EC2 SSH keys are region-specific
[2014-07-21 21:36:46 -0400] Medya: @coderanger !!! that is exactly the problem thank you
[2014-07-21 21:37:16 -0400] coderanger: Medya: You can upload the same public key to multiple regions, that often helps cut down on brainfarts :)
[2014-07-21 21:37:41 -0400] coderanger: I have literally no idea why thats a manual process, but so sayeth the AWS lords
[2014-07-21 21:38:00 -0400] sam__: @coderanger there are multiple directories that wil be part of %w. above was just an example
[2014-07-21 21:38:33 -0400] coderanger: sam__: Then perhaps the %W is what you want, but still negatory on the `uname` :)
[2014-07-21 21:38:55 -0400] sam__: aah. whta do you recommend?
[2014-07-21 21:39:06 -0400] sam__: instead of uname :)
[2014-07-21 21:39:17 -0400] sam__: you got it right. it is %W looks like
[2014-07-21 21:40:12 -0400] coderanger: sam__: Are you really looking for the nodename? Unless you are configuring YP/NIS I don't think thats used any more
[2014-07-21 21:40:35 -0400] sam__: Need the first part of the hostname taht can serve as the instance for me
[2014-07-21 21:40:45 -0400] coderanger: sam__: If what you want is the local hosntame, either node['hostname'] or node['machinname']
[2014-07-21 21:40:55 -0400] coderanger: node['hostname'] is what you want
[2014-07-21 21:41:16 -0400] sam__: oh right
[2014-07-21 21:41:20 -0400] sam__: totally forgot about that
[2014-07-21 21:41:27 -0400] sam__: glad I asked :)
[2014-07-21 21:41:28 -0400] sam__: thank you
[2014-07-21 21:41:32 -0400] sam__: thats neat
[2014-07-21 21:44:25 -0400] shlant: anyone know why fog is taking an json array and adding slashes?
[2014-07-21 21:44:27 -0400] shlant: "[\"sg-0908ed4d\", \"sg-ae04baea\"]"
[2014-07-21 21:44:35 -0400] shlant: The security group '[\"sg-0908ed4d\", \"sg-ae04baea\"]' does not exist
[2014-07-21 21:46:06 -0400] coderanger: shlant: it is probably calling to_s on it
[2014-07-21 21:46:16 -0400] coderanger: ["a", "b"].to_s == "[\"a\", \"b\"]"
[2014-07-21 21:46:57 -0400] shlant: coderanger: how should I have it in my json then?
[2014-07-21 21:47:10 -0400] shlant: it says it can be an array or string
[2014-07-21 21:47:15 -0400] coderanger: shlant: What context is this is?
[2014-07-21 21:47:26 -0400] coderanger: shlant: fog might not grok that hosts can have multiple SGs
[2014-07-21 21:48:10 -0400] coderanger: shlant: Also are you setting security_group: [...]?
[2014-07-21 21:48:23 -0400] coderanger: if so, it should probably be security_groups, plural
[2014-07-21 21:48:30 -0400] coderanger: (via https://github.com/fog/fog/blob/master/lib/fog/aws/compute.rb#L32-L33)
[2014-07-21 21:48:32 -0400] shlant: coderanger: I have "security_group_ids":["sg-0908ed4d","sg-ae04baea"]
[2014-07-21 21:49:01 -0400] coderanger: lets check the code \o/
[2014-07-21 21:49:02 -0400] shlant: I will try security_groups
[2014-07-21 21:49:18 -0400] gleam: no, it' ssecurity_group_ids
[2014-07-21 21:49:27 -0400] shlant: gleam: alright good
[2014-07-21 21:50:29 -0400] gleam:               if options['SecurityGroupId'].kind_of?(Array)
[2014-07-21 21:50:43 -0400] gleam: no idea why it wouldn't be working
[2014-07-21 21:51:21 -0400] coderanger: Yeah, this seems correct to me
[2014-07-21 21:51:35 -0400] coderanger: shlant: Might be getting mangled before it hits fog
[2014-07-21 21:51:40 -0400] coderanger: is this in the metal driver?
[2014-07-21 21:52:28 -0400] shlant: coderanger: yea.
[2014-07-21 21:52:38 -0400] shlant: sorry I keep forgetting to specify that :p
[2014-07-21 21:53:07 -0400] medya: I downloaded my knife.rb from the chef-server and put it in .chef folder but when I do which knife, it says /opt/chefdk/bin/knife ... is there a way to make it use my knife.rb ?
[2014-07-21 21:53:50 -0400] coderanger: medya: knife.rb is a config file, not a script
[2014-07-21 21:54:04 -0400] coderanger: medya: the bin/knife script will look for .chef/knife.rb as its config file
[2014-07-21 21:54:29 -0400] coderanger: shlant: I would just walk through the driver code and see what it looks like before the hand off to fog
[2014-07-21 21:54:40 -0400] medya: @coderanger but when I do a bootstrap it is looking for validation key not in the same place with knife.rb ...
[2014-07-21 21:55:03 -0400] medya: when I bootstrap a node i get this error : validation_key          "/etc/chef/validation.pem" If these settings are correct, your validation_key may be invalid.
[2014-07-21 21:55:22 -0400] medya: my validation key is NOT in /etc/chef/validation.pem
[2014-07-21 21:55:24 -0400] gleam: shlant, you have this stuff in bootstrap_options in chef metal?
[2014-07-21 21:55:54 -0400] coderanger: medya: Where exactly did you put the knife.rb?
[2014-07-21 21:56:02 -0400] medya: ~/.chef/
[2014-07-21 21:56:14 -0400] coderanger: medya: and it is called exactly "~/.chef/knife.rb"?
[2014-07-21 21:56:23 -0400] medya: yeah ~/.chef/knife.rb
[2014-07-21 21:56:31 -0400] coderanger: medya: And there is a line in that which is setting the validation key path?
[2014-07-21 21:56:31 -0400] shlant: gleam: yea
[2014-07-21 21:56:45 -0400] shlant: gleam: :security_group_ids        => "#{node['web']['security_group_ids']}"}
[2014-07-21 21:56:52 -0400] medya: yeah I downloaded it from the chef-server itself
[2014-07-21 21:57:00 -0400] coderanger: shlant: Oh, you wrapped it in the "#{}"
[2014-07-21 21:57:09 -0400] coderanger: shlant: That is equivalent to to_s :)
[2014-07-21 21:57:11 -0400] medya: validation_key           "#{current_dir}/cccis-validator.pem"
[2014-07-21 21:57:15 -0400] shlant: coderanger: oh ahah
[2014-07-21 21:57:24 -0400] shlant: thanks!
[2014-07-21 21:57:27 -0400] medya: @coderanger thats the line in knife.rb that says the location
[2014-07-21 21:57:27 -0400] gleam: haha
[2014-07-21 21:57:35 -0400] gleam: boy that explains a lot
[2014-07-21 21:57:36 -0400] medya: and I put the validation file in the same location with the knife.rb
[2014-07-21 21:59:17 -0400] coderanger: medya: That sounds correct, does `knife client list` work?
[2014-07-21 21:59:27 -0400] shlant: there we go
[2014-07-21 21:59:28 -0400] shlant: :)
[2014-07-21 21:59:45 -0400] medya:  knife client list ERROR: Failed to authenticate to https://54.85.13.201/organizations/cccis as medyagh with key /home/ubuntu/.chef/medyagh.pem Response:  Invalid signature for user or client 'medyagh'
[2014-07-21 22:00:40 -0400] coderanger: medya: Okay, so it is reading a config file somewhere
[2014-07-21 22:00:55 -0400] coderanger: medya: Look in your current folder, is there a .chef/knife.rb in that?
[2014-07-21 22:01:27 -0400] medya: there is a knife.rb in .chef as I expect it
[2014-07-21 22:01:32 -0400] medya: but not anywhere else
[2014-07-21 22:01:53 -0400] coderanger: medya: What directory are you in currently?
[2014-07-21 22:02:11 -0400] medya: ~/.chef
[2014-07-21 22:02:20 -0400] coderanger: okay
[2014-07-21 22:02:35 -0400] coderanger: can you pastebin the knife.rb you have?
[2014-07-21 22:02:54 -0400] medya: ubuntu@chef-workstation-aws:~/.chef$ cat knife.rb current_dir = File.dirname(__FILE__) log_level                :info log_location             STDOUT node_name                "medyagh" client_key               "#{current_dir}/medyagh.pem" validation_client_name   "cccis-validator" validation_key           "#{current_dir}/cccis-validator.pem" chef_server_url          "https://54.85.13.201/organizations/cccis" cache_type               'Bas
[2014-07-21 22:03:05 -0400] coderanger: medya: Please use a pastebin site like gist.github.com
[2014-07-21 22:03:25 -0400] medya: http://pastebin.com/gynNnE5T
[2014-07-21 22:04:10 -0400] coderanger: medya: Are you using Enterprise Chef?
[2014-07-21 22:04:25 -0400] medya: yes
[2014-07-21 22:05:31 -0400] medya: @coderanger, would that make a difference ?
[2014-07-21 22:05:59 -0400] coderanger: medya: You can get more direct support from your sales rep, I would check that your user key is correct to start with
[2014-07-21 22:06:13 -0400] medya: okay thanks
[2014-07-21 22:06:51 -0400] coderanger: medya: first step is to get client list to work, then worry about bootstrap after that :)
[2014-07-21 22:19:17 -0400] shlant: anyone know why my runit_service isn't picking up the options?
[2014-07-21 22:19:18 -0400] shlant: http://hastebin.com/opifibojes.mel
[2014-07-21 22:19:21 -0400] shlant: they are blank
[2014-07-21 22:19:34 -0400] shlant: are options =/= variables?
[2014-07-21 22:19:48 -0400] shlant: jtimberman: ^
[2014-07-21 22:21:06 -0400] jtimberman: shlant: those are used in the run script
[2014-07-21 22:21:12 -0400] jtimberman: https://github.com/hw-cookbooks/runit/blob/master/libraries/provider_runit_service.rb#L318
[2014-07-21 22:21:28 -0400] jtimberman: and check, finish, log/run scripts
[2014-07-21 22:21:55 -0400] shlant: jtimberman: so I can't supply my own run script?
[2014-07-21 22:22:01 -0400] jtimberman: shlant: you can
[2014-07-21 22:22:11 -0400] jtimberman: shlant: you want options[:thing] in your run script template
[2014-07-21 22:22:16 -0400] shlant: ah
[2014-07-21 22:22:16 -0400] jtimberman: options[:rails_env]
[2014-07-21 22:22:19 -0400] shlant: ok thanls
[2014-07-21 22:29:36 -0400] coderanger: @options, to be clear
[2014-07-21 22:31:10 -0400] shlant: coderanger: yea I got that. doesn't seem to be working though
[2014-07-21 22:31:12 -0400] shlant: #!/bin/sh
[2014-07-21 22:31:13 -0400] shlant: exec svlogd -tt <%= @options['app_path'] %>/shared/log/sidekiq
[2014-07-21 22:31:28 -0400] coderanger: shlant: Should be :app_path I think
[2014-07-21 22:31:34 -0400] shlant: ah
[2014-07-21 22:31:35 -0400] shlant: will try
[2014-07-21 22:31:38 -0400] coderanger: its not a mash like node attrs
[2014-07-21 22:31:48 -0400] coderanger: I forget which way it converts
[2014-07-21 22:32:27 -0400] diegows: is there a way to authorize a client from the server? something like puppet does?
[2014-07-21 22:32:28 -0400] coderanger: Yeah, you have :app_path in the hash, so need to use that in the template :)
[2014-07-21 22:32:37 -0400] coderanger: diegows: authorize it for what?
[2014-07-21 22:33:39 -0400] diegows: to access to the server to ger cookbooks, etc, etc
[2014-07-21 22:34:10 -0400] diegows: I'm launching instances with the chef-client install, poiting to my server
[2014-07-21 22:34:24 -0400] diegows: I want to authorize them in the server, I cannot access to the instances to do the bootstrap
[2014-07-21 22:36:34 -0400] coderanger: diegows: You can authorize them by creating a client key, sure
[2014-07-21 22:36:43 -0400] Nothsa: Does anyone know if there is a way to check if a template file exists from within a cookbook recipe? I've searched through the docs and all over the net, and I can't find a solution =/
[2014-07-21 22:37:07 -0400] diegows: coderanger, yes, but I have to give them the private key in a safe way
[2014-07-21 22:37:14 -0400] coderanger: Nothsa: Technically yes but its a really bad idea, what are you trying to accomplish?
[2014-07-21 22:37:26 -0400] coderanger: diegows: Yes, it has to end up on the target machine somehow, SSH is most common
[2014-07-21 22:37:55 -0400] diegows: in that case, I can use bootstrap
[2014-07-21 22:38:30 -0400] diegows: saltstack, puppet allow clients/agents/whatever to connect to the server, and the authencation remains pending until you authorize it
[2014-07-21 22:38:38 -0400] diegows: I want to do something like that
[2014-07-21 22:38:58 -0400] diegows: I have some client behind NAT, ssh could be a headache
[2014-07-21 22:39:10 -0400] Nothsa: I'm wanted to check if a file exists, and if it does, use that template file instead of the default template file. The file name is based on an environment variable, e.g. "www.#{domain_name}.erb"
[2014-07-21 22:39:15 -0400] stormerider: diegows: knife bootstrap can connect through an ssh gateway
[2014-07-21 22:39:21 -0400] coderanger: diegows: No, there is nothing directly like that, you could recreate it with enterprise chef ACLs, but it would be complex. What you can do is bake the validator key in to the disk image and have them just register themselves
[2014-07-21 22:39:50 -0400] coderanger: Nothsa: That is generally something best made explicit
[2014-07-21 22:40:26 -0400] coderanger: diegows: Also you could use any other pull-driven system you want to get the private key to the target
[2014-07-21 22:41:18 -0400] Nothsa: coderanger: I didn't want to clutter up my recipe with a bunch of if statements as there will be a lot of files. I thought it would be more eligant to just check if the file exists, and use it if it does.
[2014-07-21 22:41:24 -0400] coderanger: Thats definitely an option, I know people doing similar things using ansible to run chef-client
[2014-07-21 22:41:37 -0400] coderanger: diegows: Be sure to check out pychef for helpful stuffs :)
[2014-07-21 22:41:48 -0400] shlant: haah configuration management management
[2014-07-21 22:41:59 -0400] diegows: yes, but that brings the idea about why not using saltstack for everyting :)
[2014-07-21 22:42:15 -0400] coderanger: shlant: Remember salt and ansible are both cfg mgmt plus orchestration
[2014-07-21 22:42:43 -0400] coderanger: diegows: Salt isn't a bad choice if you have simple needs :)
[2014-07-21 22:42:47 -0400] diegows: it's like having a another management software to manage the other management software :)
[2014-07-21 22:43:02 -0400] diegows: coderanger, what do mean? :)
[2014-07-21 22:43:04 -0400] coderanger: Nothsa: There is nothing simple for that at this time, the way do it is unfortunately complex
[2014-07-21 22:43:43 -0400] coderanger: diegows: Salt works nicely if you have relatively simple, declarative requirements. The further you get from pure declarative use, the less it fits
[2014-07-21 22:43:57 -0400] Nothsa: coderanger: Do you know of an article of post somewhere that explains it? I don't mind reading up about it, but I just can't find anything.
[2014-07-21 22:44:33 -0400] diegows: coderanger, salt isn't only declarative, support templates and you get all the flexibliity there :)
[2014-07-21 22:44:43 -0400] diegows: I've done really big and complex things with salt
[2014-07-21 22:45:00 -0400] diegows: chef syntax is more clear, but... just that :)
[2014-07-21 22:46:12 -0400] coderanger: Nothsa: There is very much nothing of the sort, you just have to dive in, look at run_context.cookbook_collection['cookbookname'], that holds all the metadata about the cookbook, in there you can iterate over all files in the templates folder (called segment in this context) and look for a match
[2014-07-21 22:46:47 -0400] coderanger: diegows: I'm aware, but jinja+yaml isn't a language and shouldn't be used as such
[2014-07-21 22:47:06 -0400] diegows: coderanger, I agree
[2014-07-21 22:47:21 -0400] diegows: I should try pydsl someday
[2014-07-21 22:49:59 -0400] Nothsa: coderanger: much appreciated
[2014-07-21 22:50:32 -0400] coderanger: Nothsa: here be dragons :)
[2014-07-21 22:50:47 -0400] coderanger: Nothsa: I would make sure to bundle that up inside a library function where it can't hurt people
[2014-07-21 22:51:40 -0400] Nothsa: I'll break out the bubble wrap ;)
[2014-07-21 22:58:45 -0400] shlant: if I have a deploy user and my app dir is /home/deploy, what is the best way to grant a sidekiq user rw access to /home/deploy/shared/pids?
[2014-07-21 22:58:50 -0400] shlant: add it to the deploy group?
[2014-07-21 22:59:07 -0400] coderanger: Yep
[2014-07-21 22:59:14 -0400] shlant: cool
[2014-07-21 22:59:29 -0400] coderanger: and then make sure g+w is set, since it usually isn't
[2014-07-21 23:01:13 -0400] shlant: coderanger: that's done in the directory resource?
[2014-07-21 23:01:19 -0400] coderanger: yeah
[2014-07-21 23:01:25 -0400] Damm: sidekiq doesn't run as the same user?
[2014-07-21 23:01:34 -0400] Damm: seems strange to run a job runner different as your code
[2014-07-21 23:01:43 -0400] coderanger: It could, but having separate service users is nice for security
[2014-07-21 23:01:50 -0400] shlant: Damm: what he said :)
[2014-07-21 23:01:57 -0400] Damm: but we're talking rails here
[2014-07-21 23:02:04 -0400] Damm: if yout ake uploads they usually land in /tmp somehow
[2014-07-21 23:02:08 -0400] Damm: take*
[2014-07-21 23:02:09 -0400] coderanger: Damm: Exactly, it needs all the help it can get
[2014-07-21 23:02:29 -0400] Damm: nah this is what I learned years ago; what I expect to be secure is not what a developer codes for
[2014-07-21 23:02:38 -0400] Damm: and oversecuring your system and expecting the developer to keep up
[2014-07-21 23:02:41 -0400] Damm: does not work
[2014-07-21 23:02:48 -0400] Damm: ever have a developer team strike on you?
[2014-07-21 23:03:25 -0400] Damm: and basically if you take uploads you land them somewhere on a filesystem or into redis
[2014-07-21 23:03:44 -0400] Damm: so it makes it hard to have resque or dj or sidekiq as a different user as you have to makes sure either the umask of rails is right
[2014-07-21 23:03:57 -0400] Damm: or the bit that writes the file sets the right mode or umask
[2014-07-21 23:04:08 -0400] Damm: expectations are good to fall short of
[2014-07-21 23:04:12 -0400] Damm: specially if you set them too high
[2014-07-21 23:04:37 -0400] Damm: it's really the only way; it's own vlan... it's own dc
[2014-07-21 23:04:40 -0400] Damm: so if it explodes oh well
[2014-07-21 23:04:56 -0400] coderanger: Damm: Suspend some RPIs from a weather balloon and deploy to that
[2014-07-21 23:05:19 -0400] Damm: you know i've been thinking that we need some Zeppelins in Seattle
[2014-07-21 23:05:27 -0400] Damm: microwave internet
[2014-07-21 23:05:31 -0400] jblack: deploy it on a dialup so that nbobody can use it. =)
[2014-07-21 23:05:35 -0400] Damm: sure it's a little latent but call it a cloud
[2014-07-21 23:05:46 -0400] Damm: and the rain showers are just part of the turbulence of being on the cloud
[2014-07-21 23:05:47 -0400] Damm: ;)
[2014-07-21 23:05:48 -0400] coderanger: If you can get things compiled for ARM you could deploy to an android phone and put it in a cubesat
[2014-07-21 23:06:25 -0400] Damm: nah I was being realistic
[2014-07-21 23:06:51 -0400] Damm: these planes are just too much polution
[2014-07-21 23:07:04 -0400] coderanger: Damm: So was I, cubesats are pretty cheap these days
[2014-07-21 23:10:08 -0400] Alayde: So, quick question lads. Trying to just start tomcat during a chef-client run, "service 'tomcat' do" with "action :start" isn't doing much for me, but using an execute block to just do 'service tomcat start' works. I'm slightly perplexed.
[2014-07-21 23:10:36 -0400] juliancdunn: Alayde: wdym "isn't doing much for me"
[2014-07-21 23:10:48 -0400] Alayde: lol
[2014-07-21 23:11:03 -0400] Alayde: By doing much, I mean it's not actually starting tomcat as a service
[2014-07-21 23:11:08 -0400] Alayde: er, not doing much*
[2014-07-21 23:24:39 -0400] Damm: Alayde, upstart?
[2014-07-21 23:24:42 -0400] Damm: or Ubuntu
[2014-07-21 23:24:59 -0400] Alayde: So I'm testing this in a CentOS vm, our servers themselves are running RHEL
[2014-07-21 23:25:11 -0400] Alayde: so just regular init.d scripts afaik
[2014-07-21 23:25:33 -0400] Damm: Alayde, https://gist.github.com/damm/2b7ba19141ebaa9f1ee8
[2014-07-21 23:25:53 -0400] Damm: hmm, so /etc/init.d/tomcat start works?
[2014-07-21 23:25:56 -0400] Damm: if you ssh in?
[2014-07-21 23:26:07 -0400] Damm: Alayde, what's the actual output in chef?
[2014-07-21 23:26:18 -0400] Alayde: Yeah, as well as 'service tomcat start', both mwork
[2014-07-21 23:26:23 -0400] Alayde: Uh, uno momento. let me get it
[2014-07-21 23:30:04 -0400] Alayde: Damm: So this is what I'm seeing in the output: service[tomcat] action start[<timestamp here>] INFO: Processing service[tomcat] action start (up to date)
[2014-07-21 23:31:14 -0400] Alayde: I'm starting to think that chef is starting it and it's just dying immediately afterwards or something silly :/
[2014-07-21 23:31:57 -0400] Damm: Alayde, try gist.github.com with chef-client -l debug
[2014-07-21 23:32:01 -0400] Damm: make sure you stop it before you run chef-client
[2014-07-21 23:32:22 -0400] Damm: it'll produce a bit more data and much more than a few lines is better off in gist or pastebin
[2014-07-21 23:32:33 -0400] Alayde: right
[2014-07-21 23:35:27 -0400] shlant: coderanger: can I get after_restart to notify a service? or should I just run the service command with execute
[2014-07-21 23:35:52 -0400] coderanger: shlant: Because of ::reasons:: you can't use notifications from inside those callbacks
[2014-07-21 23:35:58 -0400] shlant: ok
[2014-07-21 23:36:26 -0400] Damm: do subscribes work int he callbacks?
[2014-07-21 23:36:39 -0400] coderanger: Damm: No, isolated run context
[2014-07-21 23:37:51 -0400] Damm: thank god i took the red pill
[2014-07-21 23:39:22 -0400] coderanger: Damm: There are reasons I tell people to not use the deploy resource
[2014-07-21 23:40:13 -0400] Alayde: Damm: I'm getting "undefined method or attribute 'release' on 'node'" on that gist. Correct me if I'm wrong, but this seems to be applicable towards Ubuntu or a system using upstart, not Centos 6.4, yeah?
[2014-07-21 23:40:33 -0400] Damm: Alayde, aye my gist was for upstart
[2014-07-21 23:40:49 -0400] Alayde: Damm: Right, we're not using upstart.
[2014-07-21 23:41:02 -0400] Damm: as you said service tomcat start worked
[2014-07-21 23:41:06 -0400] Damm: I suspected that originally
[2014-07-21 23:41:14 -0400] Damm: you can of course specify the rhel provider
[2014-07-21 23:41:27 -0400] Alayde: There is one.
[2014-07-21 23:41:36 -0400] Alayde: I didn't meet with any success using that earlier
[2014-07-21 23:41:38 -0400] Alayde: but hey, fuck it
[2014-07-21 23:41:42 -0400] Alayde: execute works lol
[2014-07-21 23:41:50 -0400] Damm: Chef::Provider::Service::Init::Redhat
[2014-07-21 23:41:50 -0400] Alayde: I'll poke around with it a bit more
[2014-07-21 23:41:51 -0400] Damm: yep
[2014-07-21 23:41:55 -0400] Damm: so use that
[2014-07-21 23:41:58 -0400] Damm: as your provider
[2014-07-21 23:42:09 -0400] Damm: http://docs.opscode.com/resource_service.html
[2014-07-21 23:42:26 -0400] Damm: Alayde, chef should figure this stuff out but sometimes it just gets it wrong
[2014-07-21 23:42:57 -0400] Alayde: Damm: Roger that
[2014-07-21 23:42:59 -0400] Alayde: appreciate the help
