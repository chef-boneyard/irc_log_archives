[2014-07-22 00:48:30 -0400] tinyjason: in the chef cookbooks on github is centos treated the same as rhel for example the mysql service?
[2014-07-22 00:53:21 -0400] coderanger: Yes
[2014-07-22 00:54:33 -0400] tinyjason: thanks going to try to add centos7 support
[2014-07-22 00:56:50 -0400] geggam: i wonder how many recipes are going to die due to systemd
[2014-07-22 01:04:52 -0400] Damm: systemd isn't that bad
[2014-07-22 01:04:57 -0400] Damm: it's actually quite suprisingly easy
[2014-07-22 01:05:38 -0400] Damm: and only 10-25% of the people out there run bleeding edge to get there
[2014-07-22 01:05:42 -0400] Damm: so shouldn't affect much
[2014-07-22 01:05:57 -0400] Damm: rhel/centos users will be the last to feel it
[2014-07-22 01:06:01 -0400] Damm: unless they go first
[2014-07-22 01:06:04 -0400] tinyjason: we just happen to be building new boxes
[2014-07-22 01:06:10 -0400] tinyjason: so gonna use the latest
[2014-07-22 01:06:42 -0400] Damm: tinyjason, should be
[2014-07-22 01:06:54 -0400] Damm: also remember that systemd can tread / grok
[2014-07-22 01:06:55 -0400] Damm: init.d's
[2014-07-22 01:07:03 -0400] Damm: so that will reduce a lot of pain
[2014-07-22 01:29:56 -0400] tinyjason: So im trying to update the mysql cookbook, however i dont even see mysql 5.7 configured for centos 6, would i have to install it oustide of the official cookbook using rpms?
[2014-07-22 01:30:23 -0400] coderanger: tinyjason: I have no idea if it supports rhel at all
[2014-07-22 01:30:33 -0400] coderanger: support in the cookbooks is spotty at best
[2014-07-22 01:32:38 -0400] tinyjason: @coderanger, ok ill just try to write my own cookbook to do it, if i find a way to port it in to the community ones i will
[2014-07-22 01:41:47 -0400] Damm: hmm 5.7 is out?
[2014-07-22 01:41:52 -0400] Damm: of course it does coderanger
[2014-07-22 01:42:04 -0400] Damm: that's the sadistic part about mysql because of their enterprise program
[2014-07-22 01:42:13 -0400] Damm: they support the el's most absolutely
[2014-07-22 01:42:55 -0400] coderanger: Damm: I'm not talking about mysql, I mean the opscode cookbook. I see nothing in the readme that indicates platform support
[2014-07-22 01:43:05 -0400] Damm: http://www.mysql.com/trials/
[2014-07-22 01:43:08 -0400] Damm: it's a set of packages
[2014-07-22 01:43:23 -0400] Damm: i'm thankful my client has me on the percona path
[2014-07-22 01:43:25 -0400] coderanger: I'm not sure what that has to do with cookbook support
[2014-07-22 01:43:45 -0400] coderanger: Ahh, it isn't in the readme because for some reason its in its own file https://github.com/opscode-cookbooks/mysql/blob/master/PLATFORMS.md
[2014-07-22 01:43:45 -0400] someara: when did mysql 5.7 come out?
[2014-07-22 01:43:57 -0400] Damm: awhile back
[2014-07-22 01:43:58 -0400] Damm: ?
[2014-07-22 01:44:11 -0400] someara: huh
[2014-07-22 01:44:29 -0400] Damm: then again we should specify
[2014-07-22 01:44:30 -0400] Damm: which 5.7?
[2014-07-22 01:44:37 -0400] Damm: mysql did roll its versions back
[2014-07-22 01:44:49 -0400] Damm: it's quite confusing
[2014-07-22 01:45:39 -0400] someara: 5.7 support should be easy to drop in after I update yum-mysql-community
[2014-07-22 01:45:46 -0400] Damm: http://www.oracle.com/us/corporate/press/2020378
[2014-07-22 01:45:58 -0400] someara: I see they actually have a package repo for it now http://repo.mysql.com/yum/mysql-5.7-community/el/6/x86_64/
[2014-07-22 01:46:01 -0400] Damm: that was 5.7.2
[2014-07-22 01:46:15 -0400] Damm: http/
[2014-07-22 03:30:16 -0400] rbowlby: What is the preferred method of installing chef onto a new ec2 instance when using cloudformation? Is it through the use of user-data or cloudformation's own metadata cfn-init stuff?
[2014-07-22 03:32:53 -0400] rbowlby: Anyone have any experience installing and configuring chef as part of cloudformations?
[2014-07-22 03:33:47 -0400] rbowlby: Also, how do I assign default recipes and roles to hosts that have yet to exist in the chef-server?
[2014-07-22 03:34:29 -0400] rbowlby: In puppet you have node regex. What is the method for assigning recipes and roles to yet-to-exist hosts in Chef?
[2014-07-22 03:38:27 -0400] L3mce: rbowlby: https://s3.amazonaws.com/cloudformation-examples/IntegratingAWSCloudFormationWithOpscodeChef.pdf page 3 suggests cfn-init... but I am just sort of bumbling around.
[2014-07-22 03:40:27 -0400] rbowlby: cool. It looks like I'm suppose to define the default recipes/roles in the template. Is there anyway to assign those recipes/roles in Chef instead? Ahead of the hosts registering with the server that is.
[2014-07-22 03:41:03 -0400] rbowlby: seems messy to keep chef runlist data outside of chef (in templates in this case)
[2014-07-22 03:46:36 -0400] juliancdunn: rbowlby: well no, you have a chicken-and-egg problem -- you can't assign the roles/recipes to the box before it's created, so you have to do it in CloudFormation
[2014-07-22 03:47:14 -0400] juliancdunn: you don't need to keep the runlist data in the template; the template can be parameterized so that when you create a formation, it asks you for the run_list
[2014-07-22 03:47:51 -0400] rbowlby: Thanks Julian. Coming from puppet where you do keep the "runlist" within puppet..this seems odd.
[2014-07-22 03:49:00 -0400] rbowlby: runlist defaults within chef based on conditionals from ohai or nodename would be great.
[2014-07-22 03:51:05 -0400] juliancdunn: how would you assign the 'runlist' to the box within Puppet? wouldn't you still need to know the FQDN of the box to do that?
[2014-07-22 03:51:11 -0400] rbowlby: So it sounds like cfn-init + parameterized templates. Now if only I could find an up-to-date cfn-init example that's not chef-solo.
[2014-07-22 03:51:28 -0400] coderanger: rbowlby: You'll need to build a new image
[2014-07-22 03:51:42 -0400] rbowlby: who are all these apes using chef-solo when chef-server gives you so many goodies?
[2014-07-22 03:51:53 -0400] coderanger: rbowlby: See https://github.com/coderanger/brix/blob/master/packer/balanced-client.json for an example
[2014-07-22 03:52:05 -0400] rbowlby: coderanger: gross, no custom AMIs if I can help it.
[2014-07-22 03:52:45 -0400] coderanger: rbowlby: And then https://github.com/coderanger/brix/blob/master/templates/base.py#L245-L249 for the cfn side
[2014-07-22 03:53:04 -0400] coderanger: rbowlby: If you want to use AWS-specific tech, you have to build AMI, it is how they do things
[2014-07-22 03:53:13 -0400] coderanger: rbowlby: Its fortunately a single base image at least
[2014-07-22 03:53:38 -0400] juliancdunn: rbowlby: there was a presentation from re:Invent 2012 that showed chef-client usage in this way - http://www.slideshare.net/AmazonWebServices/arc204-aws-infrastructure-automation-aws-reinvent-2012
[2014-07-22 03:53:52 -0400] juliancdunn: don't just cargo-cult the code as-is though, it's 2 years old and some things have changed
[2014-07-22 03:54:45 -0400] coderanger: rbowlby: If you are interested, I do offer training/consulting on chef+cfn in particular
[2014-07-22 03:55:00 -0400] coderanger: its a special brand of crazy, but when all is setup, it can be quite nice
[2014-07-22 03:55:20 -0400] rbowlby: thanks Julian, reading it now
[2014-07-22 03:56:30 -0400] rbowlby: thanks coderanger, I'll prob tough it out...the knowledge comes with the pain. ;)
[2014-07-22 03:57:33 -0400] coderanger: rbowlby: Read through the rest of that brix repo, it is a few months old but thats a fully functional datacenter-in-a-box using chef+cfn
[2014-07-22 04:01:00 -0400] rbowlby: I think I'm going to attempt to do the entire post-provision chef install using cfn-init.
[2014-07-22 04:01:31 -0400] chefgirl:  chef-handler-jenkins  should be installed on the workstatsion or the chef server ?
[2014-07-22 04:01:34 -0400] rbowlby: coderanger: thanks, the bootstrap.sh more or less tells me how to configure the chef client for an initial chef run against the chef server
[2014-07-22 04:08:09 -0400] L3mce: coderanger: pm?
[2014-07-22 04:08:26 -0400] coderanger: L3mce: ?
[2014-07-22 04:08:35 -0400] L3mce: Mind a pm?
[2014-07-22 04:08:38 -0400] coderanger: Go for it
[2014-07-22 04:08:48 -0400] coderanger: Also, thanks for asking, always nice to see :)
[2014-07-22 04:09:11 -0400] chefgirl: @coderanger : chef-handler-jenkins  should be installed on the workstatsion or the chef server ? please tell me
[2014-07-22 04:09:34 -0400] coderanger: chefgirl: Neither, handlers are a feature of chef-client
[2014-07-22 04:10:05 -0400] chefgirl: then what is this : https://github.com/jenkinsci/chef-handler-jenkins
[2014-07-22 04:10:15 -0400] chefgirl: gem instal jenkins-handler !!!
[2014-07-22 04:10:34 -0400] coderanger: chefgirl: Please read the readme, it has clear installation instructions
[2014-07-22 04:11:19 -0400] chefgirl: @coderabger : it means that it is a report genration tool
[2014-07-22 04:11:21 -0400] chefgirl: okay
[2014-07-22 04:12:01 -0400] coderanger: chefgirl: https://www.google.com/search?q=chef+handlers has a link to the documentation
[2014-07-22 04:13:25 -0400] chefgirl: @coderanger : If i want to install jenkins to provide a gui to do tasks, then where sgould I install jenkins ? On the workstation or the chef server ?
[2014-07-22 04:15:18 -0400] coderanger: chefgirl: Installing and managing Jenkins is outside of the scope of this channel
[2014-07-22 04:15:32 -0400] coderanger: chefgirl: My earlier statements about your mentorship still apply
[2014-07-22 04:15:55 -0400] chefgirl: @coderanger: but I am talking in context of chef
[2014-07-22 04:17:38 -0400] chefgirl: jenkins should be installed on the chef server or the workstation . this is my only question
[2014-07-22 04:17:48 -0400] chefgirl: @coderanger : please answer this
[2014-07-22 04:29:54 -0400] L3mce: chefgirl: From the documentation it would appear to be installed on the individual nodes, be they solo or client.
[2014-07-22 04:32:15 -0400] chefgirl: i think so it should be installed on chef server
[2014-07-22 04:41:46 -0400] jtimberman: chefgirl: I'd install jenkins on its own system.
[2014-07-22 04:42:06 -0400] jtimberman: whether that is a VM or a container or a physical system depends on your infrastructure - though generally i've seen jenkins on physical systems.
[2014-07-22 06:01:24 -0400] chefgirl: Hi I have installed jenkins on my chef worstation .now how can i integrtae it with Chef server to execute the job ?
[2014-07-22 06:52:22 -0400] chefgirl: i have writtena role system,rb http://pastebin.com/U87sU0xh
[2014-07-22 06:52:41 -0400] chefgirl: but when i login to chef server to check that it shows me no runlist
[2014-07-22 06:52:47 -0400] chefgirl: please help
[2014-07-22 07:11:49 -0400] balbirs: I have created user.json within the data_bags, now following http://fnichol.github.io/chef-user/ for cookbook/recipe
[2014-07-22 07:14:04 -0400] balbirs: though I am not getting I change I have to do in data_bag receipe
[2014-07-22 07:15:04 -0400] stas_kraev: Hi, is there are anyone who understand chef webui internals ?   i'm starting chef-server in docker, it works if I do it locally  but it's not accepting default password if I do it in AWS
[2014-07-22 07:15:38 -0400] stas_kraev: because docker version and docker image are same - it's more likely the bug of AWS but i'm havin hard time to trace it
[2014-07-22 07:18:27 -0400] digitalchild: stas_kraev: commercial chef or oss chef web interface?
[2014-07-22 07:18:43 -0400] stas_kraev: digitalchild: it's oss
[2014-07-22 07:18:52 -0400] digitalchild: then don't use the webui
[2014-07-22 07:18:54 -0400] digitalchild: its being removed
[2014-07-22 07:18:55 -0400] stas_kraev: i'm using base/chef-server iamge
[2014-07-22 07:20:55 -0400] stas_kraev: well, i'm not the fan of web-ui but it's look like chef is failing to remember a session and redirect to login page even after successful auth, this could blow one time
[2014-07-22 07:21:32 -0400] digitalchild: well id say don't bother with it save yourself some headache
[2014-07-22 07:21:36 -0400] digitalchild: its recommended to not use it at all
[2014-07-22 07:22:27 -0400] stas_kraev: agree, i just afraid it could be a sign of bigger problem - something is not working right
[2014-07-22 07:22:31 -0400] coderanger: More specifically it is deprecated and will be removed in a future release
[2014-07-22 08:38:56 -0400] amitmaheshwari: Hello all, this is Amit from  India
[2014-07-22 08:43:11 -0400] amitmaheshwari: Hi, I want to create AWS instance through linux command line, can anyone help me !! , Thanks in Advance
[2014-07-22 08:43:46 -0400] amitmaheshwari: Then deploy cookbooks for further installation of application
[2014-07-22 08:43:57 -0400] cheeseplus: amitmaheshwari: https://github.com/opscode/knife-ec2
[2014-07-22 08:44:29 -0400] cheeseplus: that will let you create ec2 instances via knife and bootstrap for chef usage
[2014-07-22 08:48:43 -0400] amitmaheshwari: Great :)
[2014-07-22 08:50:27 -0400] amitmaheshwari: I will try to create AWS instance with mention link, thanks @cheeseplus
[2014-07-22 08:51:10 -0400] digitalchild: another happy customer
[2014-07-22 09:09:36 -0400] SmudgerDan: Morning all
[2014-07-22 10:04:50 -0400] iroller: Ohai Chefs. Can someone recommend the best redis cookbook to use? I found a bunch of them: https://github.com/brianbianco/redisio, https://supermarket.getchef.com/cookbooks/redis (where's it's source btw?), https://github.com/miah/chef-redis
[2014-07-22 10:05:44 -0400] iroller: I'd like one with sentinel support, but the only one supports sentinel is https://github.com/miah/chef-redis, it has a lot of issues and has not been updated for a long time
[2014-07-22 10:16:39 -0400] MartinCleaver: How should I archive my servers chef run build logs? It seems to me that those are crucial documentation of how a system was constructed. But, what are my options about where should they be kept?
[2014-07-22 11:10:32 -0400] cloudbud: Can anybody answer this question : http://stackoverflow.com/questions/24885764/how-to-execute-a-shell-script-on-a-chef-server-using-jenkins
[2014-07-22 11:13:45 -0400] jmara: cloudbud: is jenkins running as root?
[2014-07-22 11:14:12 -0400] sonne: is there some sort of "defined?" equivalent on chef?
[2014-07-22 11:14:19 -0400] cloudbud: jmara : How to verify that ?
[2014-07-22 11:14:40 -0400] sonne: some way to check if a resource is declared...
[2014-07-22 11:14:55 -0400] sonne: e.g. i want to restart nginx, but only if it's there
[2014-07-22 11:15:50 -0400] AikiLinux: Hello
[2014-07-22 11:15:57 -0400] jmara: cloudbud: I suspect you are not the administrator of the jenkins server? I think you should talk to them, this issue is more a jenkins problem then a chef one
[2014-07-22 11:16:14 -0400] AikiLinux: is there a way to tell chef "execute" command to redirect the output of that command to a specific log file ?
[2014-07-22 11:16:29 -0400] cloudbud: jmara : I have installed jenkins on my chef-workstation
[2014-07-22 11:17:02 -0400] AikiLinux: I am running a script that it's output needs checking but does not appear in the debug run
[2014-07-22 11:21:08 -0400] jmara: cloudbud: try to check your process list which user owns the jenkins instance or take a look at the /systeminfo endpoint
[2014-07-22 11:21:24 -0400] cloudbud: yeah its jenkins user
[2014-07-22 11:21:29 -0400] cloudbud: should i change it to root ?
[2014-07-22 11:21:37 -0400] cloudbud: jmara please advice
[2014-07-22 11:21:59 -0400] jmara: no, put your script outside of the /root directory, jenkins does not have access to that folder
[2014-07-22 11:32:04 -0400] sonne: isn't really there a way to check whether a resource exists or not?
[2014-07-22 11:51:20 -0400] sonne: the equivalent of puppet's if defined(Service["foo"]) { }...
[2014-07-22 12:01:04 -0400] PierreRambaud: sonne, You can retrieve resource with resources function  "resources(execute: 'apt-get-update')"
[2014-07-22 12:01:19 -0400] PierreRambaud: sonne, After, instead of Puppet, you can do what you want with Ruby code ;)
[2014-07-22 12:02:35 -0400] sonne: PierreRambaud, so the instruction you typed, "resources(execute: 'apt-get-update')", would return true if the resource was declared earlier in any recipe and false otherwise?
[2014-07-22 12:02:48 -0400] sonne: and i don't really understand the other sentence :D
[2014-07-22 12:05:10 -0400] PierreRambaud: sonne, Source code : https://github.com/opscode/chef/blob/0563324d8e2031a2eae66100dedd805b7845881e/lib/chef/shell/ext.rb#L548
[2014-07-22 12:05:39 -0400] PierreRambaud: sonne, By using this function, if it returns something, that say "Resource exists", otherwise no
[2014-07-22 12:06:10 -0400] sonne: PierreRambaud, i see, thanks for the pointer
[2014-07-22 12:06:57 -0400] sonne: what is exactly the return value i should check for? ! nil?
[2014-07-22 12:07:04 -0400] PierreRambaud: sonne, It can be useful if you want to execute some command on demande :
[2014-07-22 12:07:04 -0400] PierreRambaud: include_recipe 'apt'
[2014-07-22 12:07:05 -0400] PierreRambaud: resources(execute: 'apt-get-update').run_action(:run)
[2014-07-22 12:08:40 -0400] PierreRambaud: sonne, it returns a Chef::Exceptions::ResourceNotFound
[2014-07-22 12:09:25 -0400] sonne: PierreRambaud, so i would go something like "unless (resources(service: 'nginx').class? == Chef::Exceptions::ResourceNotFound) do service 'nginx' do action :restart end end "
[2014-07-22 12:09:38 -0400] sonne: i'll try that :)
[2014-07-22 12:09:39 -0400] sonne: brb
[2014-07-22 12:10:56 -0400] PierreRambaud: sonne, something like that: begin
[2014-07-22 12:10:56 -0400] PierreRambaud:   resources(service: 'nginx').run_action(:restart)
[2014-07-22 12:10:57 -0400] PierreRambaud: rescue
[2014-07-22 12:10:57 -0400] PierreRambaud: end
[2014-07-22 12:12:06 -0400] zts: except that you probably want to be using nofications, and you probably don't want to be using run_action
[2014-07-22 12:12:07 -0400] PierreRambaud: sonne, it tries to select the resource and directly restart the service, and rescue exception if it appears
[2014-07-22 12:12:37 -0400] PierreRambaud: zts, sure, my bad :)
[2014-07-22 12:13:19 -0400] PierreRambaud: sonne, zts,
[2014-07-22 12:13:20 -0400] PierreRambaud: begin
[2014-07-22 12:13:20 -0400] PierreRambaud:   resources(service: 'nginx')
[2014-07-22 12:13:21 -0400] PierreRambaud: rescue
[2014-07-22 12:13:21 -0400] PierreRambaud:   service 'nginx' do
[2014-07-22 12:13:21 -0400] PierreRambaud:     action :restart
[2014-07-22 12:13:22 -0400] PierreRambaud:   end
[2014-07-22 12:13:24 -0400] PierreRambaud: end
[2014-07-22 12:40:22 -0400] sonne: PierreRambaud, isn't "rescue" supposed to be used in case an exception arises?
[2014-07-22 12:40:36 -0400] sonne: your code would mean "restart nginx, only if it doesn't exist" :P
[2014-07-22 12:46:00 -0400] chandra: i am running 1st recipe for the 1st time . But getting exception " knife command not found " . i have chef server and workstation in same machine and i hav one node .
[2014-07-22 12:47:36 -0400] quantumfoam: if I wanted to use a cookbook to deploy software that isn't available as a distro package (I have a tar.gz file which contains the files and an install script), where would the best place be to store that?
[2014-07-22 12:47:38 -0400] chandra: when i tried to upload the cookbooks "  knife cookbook upload <cookbookname>
[2014-07-22 12:48:32 -0400] chandra: it throws exception " knife command not found
[2014-07-22 12:48:50 -0400] sonne: chandra, how did you install chef?
[2014-07-22 12:50:09 -0400] chandra: @soone: it was installed by someone .. not sure whts missing over there .. i cant figure out
[2014-07-22 12:50:35 -0400] chandra: if i hav chef-repo and i checked knife.rb file .. looks fine
[2014-07-22 12:53:53 -0400] sonne: chandra, so you're trying chef installed by someone else?
[2014-07-22 12:53:59 -0400] sonne: you should ask that someone then..
[2014-07-22 13:00:21 -0400] chandra: @sonne: not exactly. i mean it was installed by one of my colleague . as he is on leave so i wanted to work on that . But i am not able to figure out the issue . what exactly missing
[2014-07-22 13:00:31 -0400] chandra: we both are working on same
[2014-07-22 13:01:25 -0400] sonne: chandra, i see.. is there any chance that you're working on different system accounts? maybe your colleague had it installed in his home
[2014-07-22 13:03:15 -0400] chandra: nope. same accounts
[2014-07-22 13:03:24 -0400] chandra: same VM
[2014-07-22 13:07:04 -0400] chandra: [2014-07-22T18:22:44+05:30] ERROR: Running exception handlers [2014-07-22T18:22:44+05:30] ERROR: Exception handlers complete Chef Client failed. 3 resources updated [2014-07-22T18:22:44+05:30] FATAL: Stacktrace dumped to /opt/chef-server/embedded/cookbooks/cache/chef-stacktrace.out [2014-07-22T18:22:44+05:30] FATAL: Mixlib::ShellOut::ShellCommandFailed: execute[/opt/chef-server/embedded/bin/createdb -T template0 -E UTF-8 opscode_chef] (
[2014-07-22 13:07:20 -0400] chandra: getting this error while running chef-server reconfigure
[2014-07-22 13:07:47 -0400] chandra:  chef-server-ctl reconfigure
[2014-07-22 13:10:34 -0400] sonne: chandra, that looks like a database related error
[2014-07-22 13:10:40 -0400] sonne: something to do with an embedded postgres i think
[2014-07-22 13:10:49 -0400] sonne: you should check the stack trace..
[2014-07-22 13:10:53 -0400] chandra: how to resolve ths ?
[2014-07-22 13:11:03 -0400] sonne: i don't know, i can't even see the error
[2014-07-22 13:11:11 -0400] sonne: it just says that it couldn't create a database on postgresql, that's it
[2014-07-22 13:11:16 -0400] sonne: you should inspect the stacktrace
[2014-07-22 13:11:20 -0400] sonne:  /opt/chef-server/embedded/cookbooks/cache/chef-stacktrace.out
[2014-07-22 13:12:39 -0400] chandra: [root@chefserver ~]# cat /opt/chef-server/embedded/cookbooks/cache/chef-stacktrace.out Generated at 2014-07-22 18:22:44 +0530 Mixlib::ShellOut::ShellCommandFailed: execute[/opt/chef-server/embedded/bin/createdb -T template0 -E UTF-8 opscode_chef] (chef-server::postgresql line 141) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '1' ---- Begin output of /opt/chef-server/embedded/bin/cre
[2014-07-22 13:13:13 -0400] thom: chandra: don't paste the full log into irc, use a paste bin such as gist.github.com
[2014-07-22 13:14:11 -0400] hypnosb: Say if I run a knife ec2 server create.. does it ssh through public or private ?
[2014-07-22 13:14:17 -0400] hypnosb: oh
[2014-07-22 13:14:20 -0400] hypnosb: and from the chef server..
[2014-07-22 13:15:36 -0400] chandra: https://gist.github.com/anonymous/2abbe1781b4ac576e563
[2014-07-22 13:15:52 -0400] chandra: @sonne
[2014-07-22 13:16:43 -0400] sonne: chandra, it looks like your postgresql is not running
[2014-07-22 13:17:35 -0400] chandra: how to run that ?
[2014-07-22 13:19:29 -0400] chandra: if i hav to set port for PostgreSQL then where i hav to update ?
[2014-07-22 13:19:48 -0400] chandra: i think it might hav issue with port number
[2014-07-22 13:22:45 -0400] sonne: chandra, service postgres status
[2014-07-22 13:22:47 -0400] sonne: i think
[2014-07-22 13:22:49 -0400] sonne: or postgresql...
[2014-07-22 13:23:17 -0400] sonne: but that path in your trace makes me think that somehow postgresql was embedded in chef, so you won't get out of it that easily
[2014-07-22 13:23:54 -0400] sonne: unfortunately i never used that kind of chef setup, so let's hope someone else reads you :)
[2014-07-22 13:37:35 -0400] phelms2: Does anyone have a recipe to join a machine to Active Directory (Linux also)
[2014-07-22 13:42:18 -0400] tech356: Can registry_key set the default value of a key? Is the value name just '(Default)'?
[2014-07-22 13:43:54 -0400] tech356: phelms2: I just used the powershell_script resource and the Add-Computer cmdlet
[2014-07-22 13:44:37 -0400] sigusr1: Hi  does anyone know if chef-metal supports lazy evaluation of machine_options?
[2014-07-22 13:49:33 -0400] phelms2: tech356: Yeah - that was what I was thinking - but I need to figure out linux as well
[2014-07-22 13:50:57 -0400] tech356: phelms2: Sorry can't help you there. I don't have any linux boxes I am managing.
[2014-07-22 14:10:42 -0400] hypnosb: hey so I'm trying to knife ec2 create a fedora instance.. but it says chef-client not found... and 404's getting it .. with? http://dpaste.com/1GHE5FQ
[2014-07-22 14:10:50 -0400] hypnosb: kinda not good
[2014-07-22 14:13:35 -0400] nulleric: @hypnosb i think thats an old alpha
[2014-07-22 14:14:10 -0400] nulleric: you using chefdk? 0.2.0 is out and has ~Chef: 11.14.0.rc.2
[2014-07-22 14:14:36 -0400] hypnosb: on where? the server? yeah chefdk..
[2014-07-22 14:14:45 -0400] hypnosb: i think..
[2014-07-22 14:14:54 -0400] hypnosb: how do i know
[2014-07-22 14:15:21 -0400] hypnosb: oh
[2014-07-22 14:15:23 -0400] nulleric: the version it tries to bootstrap is the same as the version of knife your using
[2014-07-22 14:15:26 -0400] hypnosb: it is 0.1.0
[2014-07-22 14:15:37 -0400] hypnosb: chef -v says dk 0.1.0
[2014-07-22 14:15:37 -0400] nulleric: ya, the alpha must have been pulled
[2014-07-22 14:15:55 -0400] nulleric: of chef-client, update to 0.2.0 and you should get passed that
[2014-07-22 14:16:03 -0400] nulleric: update to chefdk 0.2.0*
[2014-07-22 14:16:24 -0400] hypnosb: k
[2014-07-22 14:19:24 -0400] iDVB: Chef-newb - Trying to use knife ec2 server create for a windows AMI. I have this user_data file https://gist.github.com/anonymous/04b16c4ed213ae8f9bc8 The instance does get created and from the AWS console I can see that the user_data is in fact getting passed ok. However, it does not seem to run. WinRM port is not open, user is not created etc.
[2014-07-22 14:19:34 -0400] iDVB: anyone have any ideas?
[2014-07-22 14:20:59 -0400] jbro: Hi folks, hope it's okay if I ask a question rq: do Chef resources notify subscribers if they fail to meet their "only_if" requirements?
[2014-07-22 14:22:03 -0400] jonlives: jbro: no - if a resource fails the only_if criteria, it isn't considered to have been updated, and won't notify anything.
[2014-07-22 14:23:02 -0400] jbro: thanks jonlives!
[2014-07-22 14:23:28 -0400] jonlives: np!
[2014-07-22 14:26:51 -0400] hypnosb: Hey I get Error connecting to https://chef-server-01/bookshelf/organization-00000000000000000000000000000000/checksum-b656785ef6779ab6abee70c21b0a1287?AWSAccessKeyId=d1d81cbc86cffe1c0ef6fef8adc108601019f47c&Expires=1406039848&Signature=qDMTSBWslipxRZHdtniwAOonzIc%3D - getaddrinfo: Name or service not known  ... What is calling this? I have a dns problem I think...
[2014-07-22 14:33:23 -0400] juliancdunn: hypnosb: sounds like you have a DNS problem
[2014-07-22 14:33:29 -0400] hypnosb: rawr
[2014-07-22 14:33:54 -0400] hypnosb: where would knife be reading chef-server-01 as the server?
[2014-07-22 14:33:59 -0400] hypnosb: to configure the client as
[2014-07-22 14:34:08 -0400] hypnosb: my workstation or the server?
[2014-07-22 14:34:36 -0400] helllen: helllo
[2014-07-22 14:34:41 -0400] zaargy: knife.rb on your workstation
[2014-07-22 14:35:14 -0400] juliancdunn: hypnosb: the server will send bookshelf host headers based on what it thinks its own FQDN is
[2014-07-22 14:35:34 -0400] helllen: I am seeing this error on postgresql:  ERROR:  duplicate key value violates unique constraint "unique_schema_migrations"
[2014-07-22 14:35:41 -0400] helllen: and many postgresql error
[2014-07-22 14:35:42 -0400] helllen: why ?
[2014-07-22 14:35:50 -0400] helllen: it looks working but it is very strange
[2014-07-22 14:35:58 -0400] hypnosb: on the serve /etc/chef-server/chef-server-running.json  has the bookshelf  vip as chef-server-01 rather than FQDN
[2014-07-22 14:36:10 -0400] hypnosb: what is the knife.rb variable for chef server?
[2014-07-22 14:36:48 -0400] hypnosb: yeah I really would rather have it use the amazon 'public' dns
[2014-07-22 14:36:55 -0400] hypnosb: idk how that happened
[2014-07-22 14:37:14 -0400] medya: where should I put my berksfile in the new chef-dk directory structure ?
[2014-07-22 14:37:20 -0400] zaargy: ah nevermind - missed the previous conversation ;)
[2014-07-22 14:37:29 -0400] juliancdunn: hypnosb: you can set whatever you want bookshelf to present using the bookshelf['vip'] setting
[2014-07-22 14:37:37 -0400] juliancdunn: hypnosb: http://docs.opscode.com/config_rb_chef_server_optional_settings.html
[2014-07-22 14:39:33 -0400] hypnosb: would replacing the json with the real fqdn be a better solution?
[2014-07-22 14:45:43 -0400] sarkis: hey guys, so with kitchenci is there a way to run all the included cookbooks tests or do i just have to have an application cookbook and have 1 place with all the tests for the app?
[2014-07-22 14:46:44 -0400] george_mcfly: hello, I'm using a cookbook that utilizes a gem provider called 'sensu_gem' but I can't figure out where to find the definition for it. the name of the cookbook is 'sensu' and I only see a gem.rb in both the providers and resources folder, but I don't see anything being attached with the handle 'sensu_gem' as it is being used in one of the recipes ... where can I look for this?
[2014-07-22 14:47:36 -0400] sarkis: george_mcfly:  have you tried grep -r or ack? :)
[2014-07-22 14:49:59 -0400] george_mcfly: sarkis: I just tried ... absolutely 0 results in the sensu cookbook dir
[2014-07-22 14:50:16 -0400] george_mcfly: but I have a dozen matches in my wrapper cookbook ... could it possibly be set in the wrapper ?
[2014-07-22 14:50:50 -0400] zts: george_mcfly: the code for sensu_gem will indeed be resources/gem.rb and providers/gem.rb inside a cookbook called sensu
[2014-07-22 14:51:24 -0400] george_mcfly: is that the convention for providers then; <cookbookname>_<resourcename>.rb
[2014-07-22 14:51:28 -0400] zts: george_mcfly: when chef runs, it puts the name of the cookbook and the name of that file together to make the name of the resource
[2014-07-22 14:51:39 -0400] george_mcfly: i see
[2014-07-22 14:52:02 -0400] Neozonz: how can i debug a recipe?
[2014-07-22 14:52:18 -0400] Neozonz: or log  debug from that specific recipe to a file
[2014-07-22 14:52:19 -0400] zts: george_mcfly: this page goes into some more ddetail - http://docs.opscode.com/chef/lwrps_custom.html#file-locations
[2014-07-22 14:52:20 -0400] Eulipion: pry is pretty cool for debugging
[2014-07-22 14:52:32 -0400] sarkis: am i thinking about test kitchen the wrong way? i was hoping each cookbook would have their own tests and i bring them all together in an application cookbook, can i call each of those tests individually somehow?
[2014-07-22 14:52:40 -0400] sarkis: or do i have to just write tests for the app cookbook as a whole
[2014-07-22 14:52:57 -0400] Neozonz: Eulipion, does that work for aws as well?
[2014-07-22 14:53:20 -0400] Eulipion: it breaks your code where you put it and drops you into irb
[2014-07-22 14:53:27 -0400] Eulipion: so u can look at variables
[2014-07-22 14:53:42 -0400] Neozonz: hmm guess it won't work to well with opsworks then
[2014-07-22 14:53:48 -0400] Eulipion: whynot?
[2014-07-22 14:53:52 -0400] Eulipion: its just ruby
[2014-07-22 14:54:09 -0400] Neozonz: whats irb?
[2014-07-22 14:54:13 -0400] Neozonz: is that a shell of some sort?
[2014-07-22 14:54:16 -0400] Eulipion: ruby shell
[2014-07-22 14:54:29 -0400] Neozonz: i won't have interactive access to the server
[2014-07-22 14:54:40 -0400] workmad3: Eulipion: binding.pry can break pretty badly if there's no interactive tty ;)
[2014-07-22 14:54:47 -0400] Neozonz: ^
[2014-07-22 14:55:11 -0400] workmad3: Eulipion: and I doubt many sysadmins will want to use pry-remote-em to open up remote ports into a chef process running as root...
[2014-07-22 14:55:37 -0400] workmad3: but it can be useful for debugging in something like chefspec :)
[2014-07-22 14:59:27 -0400] medya: when I use "chef generate app name" ...what does it exactly generate ? does it generate a cookbook for me?  if I want another cookbook do I need to do another "chef generate app name2"
[2014-07-22 15:02:28 -0400] mikeface: quick question!  i'm trying to use the lusis logstash cookbook in chef, and i'd like to use the lwrps it defines without modifying any recipes in that cookbook.  how do i go about including its definitions for use in another recipe?
[2014-07-22 15:06:04 -0400] george_mcfly: ty zts
[2014-07-22 15:07:35 -0400] vickleford: mikeface, i think you should be g2g if you include the cookbook in your default recipe
[2014-07-22 15:08:00 -0400] vickleford: (default or the top level recipe you're doing stuff from)
[2014-07-22 15:08:26 -0400] mikeface: should just be: include_recipe 'logstash'  ?
[2014-07-22 15:08:49 -0400] vickleford: that looks right
[2014-07-22 15:08:59 -0400] vickleford: (haven't looked to see what cookbook name is)
[2014-07-22 15:09:32 -0400] mikeface: hm, didn't seem to work, commands to the lwrps don't do anything, my custom recipe didn't even seem to run
[2014-07-22 15:09:56 -0400] vickleford: finding this cookbook, sec
[2014-07-22 15:11:14 -0400] bougyman: hrm.
[2014-07-22 15:11:33 -0400] vickleford: yeah i think i'm misquoting you, mikeface. looking at one of my previous examples, i have just included the cookbook name as a dependency in metadata.rb
[2014-07-22 15:11:57 -0400] vickleford: (that was with a wrapper around the jenkins cookbook, not logstash)
[2014-07-22 15:12:31 -0400] george_mcfly: can anyone explain what the 'super' in this resource is supposed to be doing? https://github.com/sensu/sensu-chef/blob/master/resources/gem.rb
[2014-07-22 15:13:05 -0400] george_mcfly: i know it is supposed to call the same method of its parent class but what is the intended behavior in this resource/provider space ?
[2014-07-22 15:13:13 -0400] thom: george_mcfly: that's an old hack to acheive what default_action does now
[2014-07-22 15:13:38 -0400] mikeface: vickleford, depends 'logstash',          '~> 0.9' is in the metadata.rb for my cookbook
[2014-07-22 15:13:39 -0400] george_mcfly: ok, so basically setting the default action of the provider as 'install'
[2014-07-22 15:13:42 -0400] thom: yep
[2014-07-22 15:13:42 -0400] zts: george_mcfly: mentioned on this page, all of those are worth knowing about: http://www.getchef.com/blog/2013/09/04/demystifying-common-idioms-in-chef-recipes/
[2014-07-22 15:14:00 -0400] george_mcfly: thx thom & zts
[2014-07-22 15:14:02 -0400] vickleford: mikeface,  how are you defining resources from logstash in your recipes?
[2014-07-22 15:14:21 -0400] mikeface: however, looks like the cookbook version of logstash is 0.9.2, would that make it not work?
[2014-07-22 15:15:38 -0400] mikeface: logstash_instance name do  action: create  end
[2014-07-22 15:15:42 -0400] vickleford: man i always have to validate that lol
[2014-07-22 15:16:13 -0400] vickleford: without tinkering with Gem::Dependency i would feel good about specifying ~> 0.9.2 in your metadata
[2014-07-22 15:17:58 -0400] jtimberman: thom: ahoy!
[2014-07-22 15:18:16 -0400] mikeface: ok, that would make sense, 0.9 doesn't exist.
[2014-07-22 15:18:18 -0400] thom: jtimberman: word up :)
[2014-07-22 15:18:45 -0400] jtimberman: thom: how's tricks?
[2014-07-22 15:18:53 -0400] mikeface: vickleford, other than that, nothing special to be done in the recipe to use the lwrps?
[2014-07-22 15:19:36 -0400] vickleford: mikeface, i don't think there's anything special to be done other than just use the lwrps (or hwrps, if it provides them) -- also, looks like ~> 0.9 will never match 0.9.2
[2014-07-22 15:20:00 -0400] mikeface: got it.  i'll make that change and give it a whirl.  tyvm
[2014-07-22 15:20:34 -0400] vickleford: oh no, i forgot to put the operator lol.  Gem::Dependency.new('', '~> 0.9').match?('', '0.9.2') in irb comes to true
[2014-07-22 15:20:44 -0400] vickleford: i obviously need coffee...
[2014-07-22 15:21:15 -0400] mikeface: hmmm
[2014-07-22 15:21:21 -0400] mikeface: so that's not it then? haha
[2014-07-22 15:29:22 -0400] vickleford: i don't think so. do you have chef log output or any errors? have any examples of how you're using it?
[2014-07-22 15:29:49 -0400] thom: jtimberman: tricky :) things are really good, lots going on! how're you?
[2014-07-22 15:30:53 -0400] jtimberman: thom: excellent! good here, gonna write some cookbook code today :)
[2014-07-22 15:32:17 -0400] c_t: I feel some hugs coming on
[2014-07-22 15:32:40 -0400] jtimberman: c_t: hugged my wife and son this morning, only humans i've seen in person so far today.
[2014-07-22 15:33:08 -0400] c_t: don't you also have a daughter/
[2014-07-22 15:33:09 -0400] c_t: ?
[2014-07-22 15:33:16 -0400] jtimberman: she's at her dad's :-\
[2014-07-22 15:33:22 -0400] c_t: ahhhh, I see
[2014-07-22 15:34:00 -0400] c_t: I cruelly didn't let my son watch Minecraft videos this morning, or my daughter watch TV
[2014-07-22 15:34:08 -0400] c_t: they both went back to sleep out of frustration
[2014-07-22 15:34:26 -0400] jtimberman: My son is now on a screen time limit, so he's *playing* minecraft instead of watching minecraft videos.
[2014-07-22 15:35:19 -0400] c_t: I don't understand the appeal of watching other people play video games, but he loves it
[2014-07-22 15:35:29 -0400] jtimberman: yeah i'm with you there.
[2014-07-22 15:36:37 -0400] c_t: one day when we didn't let him do Minecraft stuff to his heart's content, he actually assembled some Endermen from these wooden block things he has
[2014-07-22 15:38:16 -0400] someara: Has anyone got Guard working with ChefDK? I can't seem to get around pry version mismatches
[2014-07-22 15:38:24 -0400] jtimberman: someara: i did
[2014-07-22 15:38:29 -0400] jtimberman: sec
[2014-07-22 15:38:34 -0400] someara: awes
[2014-07-22 15:39:07 -0400] jtimberman: have these versions installed guard (2.6.1) guard-foodcritic (1.0.2) guard-rspec (4.2.10) guard-rubocop (1.1.0)
[2014-07-22 15:39:26 -0400] jtimberman: using chefdk ruby as my default version
[2014-07-22 15:40:01 -0400] jtimberman: and pry pry (0.10.0) pry-debugger (0.2.3)
[2014-07-22 15:40:31 -0400] someara: thanks!
[2014-07-22 15:40:42 -0400] jtimberman: then 'guard' just worked.
[2014-07-22 15:41:04 -0400] someara: if only there was some mechanism where we could lock down all the version that a gem needs to run and have it load them dynamically upon invocation of the relevant binary
[2014-07-22 15:43:20 -0400] someara: er.... this one https://github.com/opscode-cookbooks/mysql/blob/master/libraries/provider_mysql_service_omnios.rb
[2014-07-22 15:50:26 -0400] RayS: I'm looking for a way to get the contents of a remote file which will be a string which I then need to use inside my recipe
[2014-07-22 15:50:53 -0400] Eulipion: is it an xml file from maven, heh
[2014-07-22 15:51:08 -0400] RayS: nope, its a single string, more like an md5 hash
[2014-07-22 15:51:25 -0400] Eulipion: use native ruby os functions
[2014-07-22 15:54:41 -0400] shadfc: Anyone willing to help a complete n00b? I'm trying to figure out why a node won't update it's npm version even though I think I've changed the version it should expect to use
[2014-07-22 15:57:30 -0400] shadfc: this is the npm/recipes/default.rb: http://dpaste.com/3ZYXK06, npm/attributes/default.rb sets default['npm']['version'] = '1.4.7'
[2014-07-22 16:00:20 -0400] iDVB: Chef-newb - Trying to use knife ec2 server create for a windows AMI. I have this user_data file https://gist.github.com/anonymous/04b16c4ed213ae8f9bc8 The instance does get created and from the AWS console I can see that the user_data is in fact getting passed ok. However, it does not seem to run. WinRM port is not open, user is not created etc.
[2014-07-22 16:00:26 -0400] iDVB: anyone have any ideas?
[2014-07-22 16:01:01 -0400] Eulipion: shadfc: get rid of the only_if, and when u run see if it says "skipped due to X"
[2014-07-22 16:01:09 -0400] medya: how to add a recipie to a node without bootstrapping it ?
[2014-07-22 16:01:32 -0400] Eulipion: knife node run_list add <node> "recipe[derp]"
[2014-07-22 16:04:30 -0400] shadfc: Eulipion: oh, now it seems to be building it. That only_if was blocking because the source dir for the new version wouldn't exist and that test would fail?
[2014-07-22 16:05:15 -0400] Eulipion: you should be able to test using one conditional stmt.  havent tried two, never had a need.
[2014-07-22 16:05:25 -0400] Eulipion: had a hunch it was blocking
[2014-07-22 16:05:59 -0400] shadfc: Not sure why that was there. Inherited the code. Commit message is "Corrected this cookbook so that npm will only install once and won't upgrade itself without pre-approval."
[2014-07-22 16:06:00 -0400] shadfc: oh well
[2014-07-22 16:06:12 -0400] Eulipion: but i dont do things like this, i run my own repo and lock my versions down, everything matches my repo
[2014-07-22 16:06:41 -0400] Eulipion: shadfc: you can use tags to lock stuff down when you want a manual step to roll forwards
[2014-07-22 16:07:33 -0400] shadfc: well, we do have the cookbook versions pinned by environment with managed chef. Not sure if that's the right terminology
[2014-07-22 16:08:00 -0400] shadfc: so it doesn't seem like npm would have gone and upgraded itself without someone changing the version of the cookbook to use
[2014-07-22 16:38:06 -0400] doomviking: http://boingboing.net/2014/07/22/chrome-extension-turns-every-i.html
[2014-07-22 16:38:10 -0400] doomviking: dying
[2014-07-22 16:46:37 -0400] cschneid: we have a bunch of customers, each with their own environment file.  But they share many of the same bits & pieces. Can environments inherit from another?  "our-app-v1.rb" => "specific-client-running-v1.rb"
[2014-07-22 16:52:32 -0400] double_p: .rb is not environment
[2014-07-22 16:53:49 -0400] double_p: quite at the same point right now.. given the current status, doing only a minimum in environment/role and pack everything in "wrapper-cookbooks/berkshelf" seems to way to go. but then there's historical cruft :)
[2014-07-22 16:53:49 -0400] Eulipion: double_p: you can do something like this. http://pastebin.com/4cBF0s2f
[2014-07-22 16:54:47 -0400] Eulipion: cschneid: ^
[2014-07-22 16:55:48 -0400] cschneid: double_p: well, we have chef-repo/environments/whatever.rb files, which get pushed up.
[2014-07-22 16:55:52 -0400] cschneid: we want to combine generic "version of software" kind of env settings with specific "this customer" settings.
[2014-07-22 16:55:54 -0400] cschneid: there is likely a smarter way to do that
[2014-07-22 16:55:58 -0400] cschneid: Eulipion: where would that go?
[2014-07-22 16:56:13 -0400] Eulipion: thats my base.rb
[2014-07-22 16:56:16 -0400] Eulipion: role
[2014-07-22 16:57:48 -0400] rodolfojcj: hello everybody
[2014-07-22 16:57:49 -0400] cschneid: ohh, interesting. hmm. so that's a role that runs differently based on the environment its in
[2014-07-22 16:58:17 -0400] rodolfojcj: I am getting an error when running chef-client
[2014-07-22 16:58:27 -0400] Eulipion: if u apply that role and look at the node json, you'll see it expands to a run_list per env, but its a lot easier in rb than json
[2014-07-22 16:58:58 -0400] rodolfojcj: with something that, in theory, seems fairly easy: create a directory and then do a git clone using it
[2014-07-22 16:58:59 -0400] Eulipion: cschneid: basically everything gets all_env, then i add stuff on at the end per env
[2014-07-22 16:59:03 -0400] rodolfojcj: my resource:
[2014-07-22 16:59:05 -0400] double_p: Eulipion: i dont get the magic in there
[2014-07-22 16:59:26 -0400] rodolfojcj: directory node['mtamda']['vimbadmin_install_dir'] do
[2014-07-22 16:59:26 -0400] Eulipion: its not magic, just a solution to cschneids question
[2014-07-22 16:59:28 -0400] rodolfojcj:   owner "www-data"
[2014-07-22 16:59:29 -0400] rodolfojcj:   group "www-data"
[2014-07-22 16:59:30 -0400] rodolfojcj:   mode 00775
[2014-07-22 16:59:32 -0400] rodolfojcj:   recursive true
[2014-07-22 16:59:33 -0400] coderanger: rodolfojcj: Stop
[2014-07-22 16:59:34 -0400] rodolfojcj: end
[2014-07-22 16:59:38 -0400] coderanger: rodolfojcj: Please use a pastebin
[2014-07-22 16:59:39 -0400] Eulipion: rodolfojcj: pastebin pls
[2014-07-22 16:59:45 -0400] rodolfojcj: ok
[2014-07-22 16:59:52 -0400] cschneid: Eulipion: right.  We have the need to do cookbook versioning too, which gets more awkward too.  "for app v1, use rails cookbook 1" "for app v2 use rails cookbook version 4.2.3"
[2014-07-22 17:00:00 -0400] double_p: Eulipion: point (for me) is overriding defaults in multiple nesting. and that's only grained with cookbooks/recipes.
[2014-07-22 17:00:08 -0400] rodolfojcj: the attribute value is "/var/www/vimbadmin"
[2014-07-22 17:00:11 -0400] cschneid: Eulipion: I'll play with this more. I bet there's a way to figure this one out right.
[2014-07-22 17:00:37 -0400] rodolfojcj: chef-client says: directory[/var/www/vimbadmin] action create
[2014-07-22 17:00:46 -0400] rodolfojcj: and it shows green lines
[2014-07-22 17:01:03 -0400] rodolfojcj: so I suppose the directory was created
[2014-07-22 17:01:43 -0400] rodolfojcj: next is a bash resource that has this line: git clone http://github.com/opensolutions/ViMbAdmin.git #{node['mtamda']['vimbadmin_install_dir']}
[2014-07-22 17:01:51 -0400] rodolfojcj: and it fails
[2014-07-22 17:02:01 -0400] Eulipion: use the git resource
[2014-07-22 17:02:34 -0400] coderanger: rodolfojcj: Whats the error?
[2014-07-22 17:03:09 -0400] rodolfojcj: well, before the git clone there is a cd in bash, so the error says: "cd: /var/www/vimbadmin: No such file or directory"
[2014-07-22 17:03:19 -0400] double_p: right now i'm loosing my head over a path = "#{node['corp']['project_home']/bin/restore.sh" works for cookbook_file in one recipe, but not the other - in the very same chef-client run. heck, even within the same cookbook (which shouldnt matter anyway)
[2014-07-22 17:03:51 -0400] coderanger: rodolfojcj: Can you please pastebin the recipe?
[2014-07-22 17:06:24 -0400] rodolfojcj: ok, I'll do that...
[2014-07-22 17:10:45 -0400] rodolfojcj: http://sebsauvage.net/paste/?61a4dfa134cf4c73#rgvngiXwvoYwXOqweG72CBl+9bW/GnDAFXw2Oa0iujU=
[2014-07-22 17:10:51 -0400] rodolfojcj: that's the paste
[2014-07-22 17:11:00 -0400] rodolfojcj: showing the output of chef-client
[2014-07-22 17:11:09 -0400] rodolfojcj: with the error
[2014-07-22 17:12:22 -0400] coderanger: rodolfojcj: Please pastebin the recipe code
[2014-07-22 17:12:54 -0400] rodolfojcj: I'm behind a firewall and pastebin is blocked
[2014-07-22 17:13:32 -0400] coderanger: rodolfojcj: use another, hastebin.com, gist.github.com, etc
[2014-07-22 17:13:33 -0400] rodolfojcj: so I'm using an alternative to pastebin. I found ZeroBin (that's my previous link)
[2014-07-22 17:13:47 -0400] rodolfojcj: (sebsauvage == ZeroBin)
[2014-07-22 17:13:53 -0400] coderanger: Sure, you only posted the output though, not the recipe code
[2014-07-22 17:15:23 -0400] hypnosb: how u guys feel about naming conventions? Like zone-function-instance or just function-instance? so say east-web-01, vs web-01 ... is it problematic to say have *-web-01's  ... rather than just iterating what you need?
[2014-07-22 17:16:43 -0400] hypnosb: zone-function-role-instance ... get crazy
[2014-07-22 17:16:48 -0400] hypnosb: so east-web-p-01
[2014-07-22 17:16:54 -0400] hypnosb: ?
[2014-07-22 17:17:11 -0400] coderanger: hypnosb: names are overrated, give them a serial number and move on
[2014-07-22 17:17:25 -0400] hypnosb: yeah I've heard that before
[2014-07-22 17:18:04 -0400] hypnosb: idk i can't grasp how that works, maybe physical hardware
[2014-07-22 17:18:08 -0400] hypnosb: but this is all ec2
[2014-07-22 17:18:52 -0400] rodolfojcj: this has the associated resources to the chef-client error I'm facing http://sebsauvage.net/paste/?113736a5ef2534d1#MPUdLuKV6UpQKxN8dlwYlYsLeMdeujCD9e1wyJslMas=
[2014-07-22 17:18:53 -0400] coderanger: hypnosb: Thats even easier, they already come with a good hostname :)
[2014-07-22 17:19:18 -0400] coderanger: rodolfojcj: Any reason you aren't using a git resource?
[2014-07-22 17:19:22 -0400] hypnosb: not really... how do i differentiate ec2-51-x-x-x-x is the production, test or development server?
[2014-07-22 17:19:49 -0400] rodolfojcj: no particular reason at all
[2014-07-22 17:19:51 -0400] double_p: hypnosb: no point in shorting it.
[2014-07-22 17:20:22 -0400] hypnosb: but if you are sitting at a console... and everything is ec2-51-x or ec2-107- ..
[2014-07-22 17:20:36 -0400] coderanger: hypnosb: Don't sit at the console
[2014-07-22 17:20:41 -0400] hypnosb: what? some crappy spreadsheet?
[2014-07-22 17:20:55 -0400] coderanger: hypnosb: Nah, I usually bake that stuff in to the motd
[2014-07-22 17:21:06 -0400] coderanger: hypnosb: Or maybe shell prompt if you really want it there too
[2014-07-22 17:21:13 -0400] cheeseplus: treat your servers like cattle, not like pets
[2014-07-22 17:21:31 -0400] coderanger: but just because you want it in the prompt, doesn't mean you need to futz with the hostname :)
[2014-07-22 17:22:01 -0400] coderanger: If you are doing a lot of interactive work, it is usually a sign of a breakdown of tooling though
[2014-07-22 17:22:08 -0400] cheeseplus: ^^
[2014-07-22 17:22:27 -0400] hypnosb: how so?
[2014-07-22 17:22:37 -0400] coderanger: hypnosb: Why would you be logging in to a server?
[2014-07-22 17:22:38 -0400] hypnosb: am i trying to micro manage too much?
[2014-07-22 17:22:53 -0400] keftes: hey - i'm trying to bootstrap a node that's on a different domain - is there any way to specify the FQDN of the Chef server as a bootstrap argument? the node keeps setting the server name with the same domain as the node
[2014-07-22 17:23:01 -0400] cheeseplus: hypnosb: it sounds like it
[2014-07-22 17:23:32 -0400] cheeseplus: hypnosb: ideally you never log into a server unless something is wrong, your orchestration and config mgmt should be doing the work
[2014-07-22 17:23:38 -0400] coderanger: keftes: --server-url
[2014-07-22 17:23:59 -0400] hypnosb: I guess it should be somewhat self documenting through having roles?
[2014-07-22 17:24:00 -0400] coderanger: hypnosb: The usual response to that question is "checking log files" or "restarting services"
[2014-07-22 17:24:01 -0400] cheeseplus: and even then, kill the server instead of logging into it - I'm a firm believer in disposable infrastructure
[2014-07-22 17:24:22 -0400] coderanger: hypnosb: Sure, having it in motd is usually a good compromise
[2014-07-22 17:24:32 -0400] keftes: coderanger: argh
[2014-07-22 17:24:42 -0400] keftes: should be on the doc - thank you
[2014-07-22 17:24:43 -0400] coderanger: hypnosb: Its simple to add (just a single file) and doesn't actually matter if it gets out of sync or whatever except to humans
[2014-07-22 17:24:46 -0400] hypnosb: seems like a different mindset when it comes to automation and its 'letting go' factor
[2014-07-22 17:24:55 -0400] Eulipion: keftes: knife bootstrap --help
[2014-07-22 17:25:19 -0400] hypnosb: i need to trust the recipe
[2014-07-22 17:25:30 -0400] hypnosb: and forget about individual servers so much
[2014-07-22 17:25:36 -0400] keftes: guilty - thx
[2014-07-22 17:25:42 -0400] hypnosb: i still think i should make a golden image
[2014-07-22 17:25:49 -0400] cheeseplus: hypnosb: lots of tests
[2014-07-22 17:25:58 -0400] cheeseplus: hypnosb: also if you still fancy naming them http://mnx.io/blog/a-proper-server-naming-scheme/
[2014-07-22 17:26:22 -0400] cheeseplus: hypnosb: test the recipes like they are code so you have confidence in them
[2014-07-22 17:26:52 -0400] cheeseplus: that is a somewhat requisite step on the path to being able to not worry about individual servers
[2014-07-22 17:27:08 -0400] coderanger: rodolfojcj: I'm guessing the "fatal: The remote end hung up unexpectedly" is the real error
[2014-07-22 17:27:19 -0400] coderanger: rodolfojcj: Sounds like the git clone is failing
[2014-07-22 17:27:51 -0400] rodolfojcj: ok
[2014-07-22 17:28:17 -0400] rodolfojcj: I'll see how to debug it
[2014-07-22 17:28:41 -0400] rodolfojcj: is it possible that the directory resource creation is rolled back if the chef-client fails??
[2014-07-22 17:29:05 -0400] rodolfojcj: if not, what could be a reason for the /var/www/vimbadmin directory not being created?
[2014-07-22 17:29:20 -0400] coderanger: rodolfojcj: No, chef doesn't do rollbacks
[2014-07-22 17:29:26 -0400] coderanger: cheeseplus: Woo, Areal is dead!
[2014-07-22 17:29:28 -0400] Eulipion: coderanger: would after generating a secure_password be an okay time to node.save ?  node.set_unless...secure_pass seems to be the only way i can avoid nil errors
[2014-07-22 17:29:49 -0400] coderanger: Eulipion: Don't evarrrrr store passwords in node attributes, woefully insecure
[2014-07-22 17:30:00 -0400] coderanger: Eulipion: Remember all node attributes are visible to all nodes
[2014-07-22 17:30:32 -0400] coderanger: Eulipion: Also no, calling node.save in the middle of a run is just generally badnewsbears
[2014-07-22 17:30:39 -0400] rodolfojcj: considering the directory resource is before the bash resource
[2014-07-22 17:32:20 -0400] rodolfojcj: hey <coderanger>, you are right!
[2014-07-22 17:32:23 -0400] gkra: in knife.rb, all paths are relative to the path for the knife.rb itself, correct?
[2014-07-22 17:32:31 -0400] rodolfojcj: it is the git clone failing
[2014-07-22 17:32:48 -0400] rodolfojcj: I did the equivalent commands one by one, by hand
[2014-07-22 17:32:54 -0400] rodolfojcj: and I saw this:
[2014-07-22 17:33:15 -0400] rodolfojcj: directory resource works as expected, /var/www/vimbadmin gets created
[2014-07-22 17:33:54 -0400] coderanger: gkra: No, paths are just literal, if relative they will be computed against the cwd of whatever is running
[2014-07-22 17:33:57 -0400] coderanger: gkra: (usually)
[2014-07-22 17:34:23 -0400] gkra: oh, brainfart
[2014-07-22 17:34:29 -0400] rodolfojcj: next, within bash resource, git clone http://path_to_repo /var/www/vimbadmin  is failing and as a consequence the /var/www/vimbadmin is destroyed
[2014-07-22 17:34:31 -0400] gkra: current_dir = File.dirname(__FILE__)
[2014-07-22 17:34:45 -0400] gkra: okay, I can brain now
[2014-07-22 17:35:05 -0400] jtimberman: naming scheme: % ruby -e 'p IO.read("/usr/share/dict/words").split[rand(0..IO.read("/usr/share/dict/words").split.count - 1)].downcase'
[2014-07-22 17:35:09 -0400] jtimberman: :)
[2014-07-22 17:35:15 -0400] gkra: berks, unfortunately, does not like: Chef::Config.from_file()
[2014-07-22 17:35:17 -0400] hypnosb: I changed the chef-server variables in  /etc/chef-server/chef-server-running.json  to point to the aws public DNS ip .. but but knife still want to use something completely different
[2014-07-22 17:35:36 -0400] coderanger: jtimberman: You joke, and yet thats basically what docker does
[2014-07-22 17:36:00 -0400] coderanger: hypnosb: that is controlled by your knife.rb
[2014-07-22 17:36:13 -0400] coderanger: hypnosb: chef-client/knife and chef-server have totally unrelated config bits
[2014-07-22 17:36:22 -0400] hypnosb: i see
[2014-07-22 17:36:25 -0400] rodolfojcj: and I see git clone is failing because I was using http instead of https to point to the github repository
[2014-07-22 17:36:56 -0400] jtimberman: coderanger: i'm not really joking, though this would have a lower chance of collisions: ruby -rsecurerandom -e 'p SecureRandom.uuid.downcase'
[2014-07-22 17:38:03 -0400] rodolfojcj: thanks for your help!
[2014-07-22 17:38:18 -0400] someara: it'd be neat to take a docker snapshot between every resource converge
[2014-07-22 17:40:44 -0400] hypnosb: ugh where is this setting :/
[2014-07-22 17:41:40 -0400] coderanger: hypnosb: Which setting?
[2014-07-22 17:42:09 -0400] hypnosb: coderanger, whatever is causing the knife bootstrap to fail trying to resolve a hostname that does not really exist properly
[2014-07-22 17:42:17 -0400] gkra: is there any way to get berks to not barf on Chef::Config.from_file(), or do I need to rip it out of my knife.rb?
[2014-07-22 17:42:34 -0400] hypnosb: api_fqdn in knife.rb?
[2014-07-22 17:42:35 -0400] coderanger: hypnosb: From your workstation, does `knife client list` work?
[2014-07-22 17:42:50 -0400] hypnosb: no :/
[2014-07-22 17:42:51 -0400] coderanger: hypnosb: chef_server_url is the setting for the server usually
[2014-07-22 17:43:07 -0400] coderanger: hypnosb: Okay, work on that first, then bootstrap comes after :)
[2014-07-22 17:43:20 -0400] coderanger: gkra: I've not had problems with it
[2014-07-22 17:44:44 -0400] gkra: coderanger: berks is giving me this: https://gist.github.com/gkra/f9c7967300bd9299f9a4
[2014-07-22 17:46:11 -0400] gkra: This is the knife file in question: https://gist.github.com/gkra/4a1545c3dcbae75e86b1
[2014-07-22 17:48:22 -0400] gkra: and my knife_override.rb: https://gist.github.com/gkra/bceeaa648ac498eaddb1
[2014-07-22 17:52:25 -0400] gkra: bah.. deleted knife gist trying to clear out something else. re-posted: https://gist.github.com/gkra/de2f4f975ced5adb4329
[2014-07-22 17:53:49 -0400] hypnosb: coderanger, this is so weird... so I managed to get an instance bootstrapped,  I add the node to a role, and try to run chef-client... and it fails again trying to get to that same old chef-server-01 hostname
[2014-07-22 17:54:45 -0400] hypnosb: so this is a new node.. id like for the server to set the ec2 fqdn in instances rather than say.. knife config
[2014-07-22 17:55:49 -0400] hypnosb: wtf... on the NEW instance in /etc/chef/client.rb I have chef_server_url  "https://ec2-23-20-63-162 .."
[2014-07-22 17:56:17 -0400] hypnosb: yet it still does Error connecting to https://chef-server-01/bookshelf/organization-00
[2014-07-22 17:57:12 -0400] coderanger: hypnosb: Okay, so bbookshelf
[2014-07-22 17:57:29 -0400] coderanger: hypnosb: You need a different setting for that, sec
[2014-07-22 17:58:04 -0400] coderanger: hypnosb: bookshelf['vip']
[2014-07-22 17:58:14 -0400] hypnosb: where?
[2014-07-22 17:58:15 -0400] coderanger: hypnosb: Set that to the same thing as api_fqdn
[2014-07-22 17:58:19 -0400] coderanger: in your chef-server.rb
[2014-07-22 17:58:22 -0400] hypnosb: ok
[2014-07-22 17:59:08 -0400] hypnosb: coderanger, don't have one, make one in /etc/chef-server/ ?
[2014-07-22 17:59:19 -0400] coderanger: hypnosb: Yes
[2014-07-22 17:59:24 -0400] mallu: hi, can I use opscode chef-client cookbook to run chef-client as daemon? I already have chef clients installed and configured just want to convert it to daemon
[2014-07-22 17:59:26 -0400] coderanger: hypnosb: I thought you said you were setting api_fqdn before
[2014-07-22 17:59:43 -0400] hypnosb: coderanger, i must have tried in knife.rb >:D
[2014-07-22 17:59:59 -0400] coderanger: hypnosb: The full process is make that file, set both api_fqdn and bookshelf['vip'], and then chef-server-ctl reconfigure
[2014-07-22 18:00:07 -0400] coderanger: mallu: Thats what it does, yes
[2014-07-22 18:01:34 -0400] mallu: coderanger: it is also removing validation certs and all that.. I don't want that just change it to service
[2014-07-22 18:02:43 -0400] coderanger: mallu: That should only happen if you add chef-client::delete-validation to your run list
[2014-07-22 18:03:00 -0400] coderanger: mallu: You just want recipe[chef-client]
[2014-07-22 18:03:04 -0400] hypnosb: coderanger,  reconfigure failed saying: Parent directory /var/opt/chef-server/nginx/ca/https: does not exist
[2014-07-22 18:03:12 -0400] coderanger: (unless there is an include_recipe I'm missing)
[2014-07-22 18:03:21 -0400] coderanger: hypnosb: Does it exist?
[2014-07-22 18:03:28 -0400] hypnosb: nope
[2014-07-22 18:03:34 -0400] hypnosb: make it ...
[2014-07-22 18:05:30 -0400] hypnosb: oh, i had http:// in api_fqdn/bookshelf vip
[2014-07-22 18:05:37 -0400] hypnosb: pebkac
[2014-07-22 18:21:27 -0400] balbirs: I created a file balbirs.json inside data_bags folder in my chef workstation. Now I want to have a recipe who can create a users as per info supplied in balbirs.json
[2014-07-22 18:21:47 -0400] balbirs: can someone give me a cookbook or recipe for creating user?
[2014-07-22 18:23:55 -0400] coderanger: balbirs: There are several, ckbk.it/user and ckbk.it/users are the most common
[2014-07-22 18:32:46 -0400] hypnosb: what does this mean?  mysql_client[default] (mysql::client line 20) had an error: Chef::Exceptions::Package: package[community-mysql] (/var/chef/cache/cookbooks/mysql/libraries/provider_mysql_client_fedora.rb line 17) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for community-mysql
[2014-07-22 18:32:56 -0400] hypnosb: no version specified?
[2014-07-22 18:33:04 -0400] coderanger: hypnosb: It means that package isn't found
[2014-07-22 18:33:17 -0400] coderanger: apt things there are not versions of it available to install
[2014-07-22 18:33:26 -0400] hypnosb: I thought recpies were distro agnostic?
[2014-07-22 18:33:33 -0400] hypnosb: its a fedora instance
[2014-07-22 18:33:35 -0400] coderanger: or sorry, yum in this case
[2014-07-22 18:33:48 -0400] hypnosb: hrm
[2014-07-22 18:34:28 -0400] coderanger: hypnosb: Check what yum repos you have active
[2014-07-22 18:34:57 -0400] someara: hypnosb the mysql cookbook doesn't work on centos7 yet if that's what you're trying to do
[2014-07-22 18:36:28 -0400] someara: or fedora-20
[2014-07-22 18:37:27 -0400] phelms2: does chef have a method to check if windows has a pending restart ?
[2014-07-22 18:38:58 -0400] zuhaib: Hey I see in github that chef 11.14 as "latest release", is the correct or is still 11.12.8 the latest
[2014-07-22 18:39:04 -0400] zuhaib: https://github.com/opscode/chef/blob/master/CHANGELOG.md
[2014-07-22 18:39:31 -0400] zuhaib: ah nvm I see its still tagged as RC
[2014-07-22 18:39:40 -0400] coderanger: zuhaib: Soon :)
[2014-07-22 18:40:12 -0400] zuhaib: Any target date for 11.14?  We are still rocking 11.6 in prod and I wanted to bump it up but if 11.14 is soon I might hold off
[2014-07-22 18:41:48 -0400] coderanger: zuhaib: I've not heard one
[2014-07-22 18:42:00 -0400] zuhaib: cool
[2014-07-22 18:42:04 -0400] coderanger: Can't imagine more than a week or two
[2014-07-22 18:42:19 -0400] zuhaib: i will give 11.12.8 some dry runs in dev and see if I need to fix our stuff
[2014-07-22 18:42:20 -0400] zuhaib: thanks
[2014-07-22 18:43:40 -0400] MotherMGA: Whats the correct way to load an environment-specific databag and merge it into default attributes?
[2014-07-22 18:44:56 -0400] coderanger: MotherMGA: Don't
[2014-07-22 18:45:05 -0400] spheromak: MotherMGA: encode the env-data in a a bag item, or set the bagname by env.  then there are a couple tools out there to merge it in. yuou can use Chefs deep merge as well if you want the attrib merging behaviour. All of this tho is pretty bad imo  cause it makes it quite difficult to reason about wtf is happening.
[2014-07-22 18:45:07 -0400] coderanger: MotherMGA: If you want env-level attributes, put them in the environment
[2014-07-22 18:45:12 -0400] spheromak: better off loading the bag or using attribs
[2014-07-22 18:45:21 -0400] spheromak: or doing env attr ^ like coderanger says
[2014-07-22 18:46:15 -0400] spheromak: just make one thing the authority. so you understand how a node is gettin the data it's getting. otherwise tracking down issues will be a nightmare.
[2014-07-22 18:46:27 -0400] lamont_oc: zuhaib: im working on it
[2014-07-22 18:46:57 -0400] zuhaib: sweet
[2014-07-22 18:47:07 -0400] lamont_oc: if youre going to test, you should probably use the 11.14.0.rc
[2014-07-22 18:47:31 -0400] lamont_oc:  curl -L https://www.opscode.com/chef/install.sh | bash -s -- -p
[2014-07-22 18:48:38 -0400] lamont_oc: i need to get ohai 6.2.0 released, and im currently fighting with windows/jenkins issues there, then comes building the 11.14.0 omnibus release packages and then doing some internal testing and then pressing the release button
[2014-07-22 18:49:09 -0400] MotherMGA: I have the majority of my configuration data in my node.json files, but I have various sensitive data per-environment, which I'm using encrypted databags. so if I get this right, everyone says just load the environment-specific databag expose it to my templates using a variable directive?
[2014-07-22 18:49:15 -0400] double_p: lamont_oc: AND no humppa!
[2014-07-22 18:49:18 -0400] lamont_oc: kind of feels like friday-ish, and since friday is a bad day for a release, probably will slip to monday
[2014-07-22 18:49:56 -0400] lamont_oc: humppa???
[2014-07-22 18:50:14 -0400] double_p: lamont_oc: first http://www.sysarmy.com.ar/images/rofriday.jpg
[2014-07-22 18:50:28 -0400] lamont_oc: heh lol
[2014-07-22 18:50:35 -0400] miketheman: double_p: <3
[2014-07-22 18:50:41 -0400] hypnosb: Its fedora release  8 werewolf according to /etc/redhat-release
[2014-07-22 18:50:44 -0400] spheromak: MotherMGA: IMO thats def more understandable to read 12 months from now. vs loading + merging magic
[2014-07-22 18:50:45 -0400] hypnosb: old?
[2014-07-22 18:50:59 -0400] spheromak: MotherMGA: also pretty typical usage for encrypted bags
[2014-07-22 18:51:13 -0400] MotherMGA: Ok. thank you.
[2014-07-22 18:51:20 -0400] double_p: lamont_oc: and humppa.. well http://www.youtube.com/watch?v=HR27p0vB4yg
[2014-07-22 18:52:00 -0400] lamont_oc: owwwww, my brain.
[2014-07-22 18:52:21 -0400] double_p: lamont_oc: and "better one" http://www.youtube.com/watch?v=gOk0q5B5ZK4 - but you asked :)
[2014-07-22 18:54:38 -0400] lamont_oc: ouch
[2014-07-22 18:54:52 -0400] vhost-: hey all. I'm have two environments, production and dev, production uses the Deploy resource and dev uses vagrant. I'm trying to share some code that executes in before_migrate with both environments, but I can't include_recipe() in the callback block for Deploy. how should I handle this?
[2014-07-22 18:55:07 -0400] vhost-: s/I'm/I/
[2014-07-22 18:55:32 -0400] lamont_oc: vhost: just use a ruby library?
[2014-07-22 18:56:13 -0400] vhost-: lamont_oc: how do I include the library in the callback?
[2014-07-22 18:56:21 -0400] double_p: or "default" in env and override in role
[2014-07-22 18:57:49 -0400] lamont_oc: just put a pure-ruby file into the library directory of a cookbook and itll get loaded as long as the cookbook is in your run list or a dep of something in your run list
[2014-07-22 18:58:37 -0400] vhost-: then I can call include_recipe() in a method in the library and call the method in the deploy callback?
[2014-07-22 18:58:48 -0400] lamont_oc: no, you dont need include_recipe
[2014-07-22 18:59:02 -0400] vhost-: just add the recipe code straight up?
[2014-07-22 18:59:20 -0400] lamont_oc: just call ClassName.new().thing, or Module.foo(bar, baz) or whatever
[2014-07-22 18:59:21 -0400] lamont_oc: hmmm
[2014-07-22 18:59:47 -0400] lamont_oc: ah you want chef resources in the callback?
[2014-07-22 18:59:56 -0400] vhost-: lamont_oc: yeah
[2014-07-22 18:59:59 -0400] vhost-: that's the issue
[2014-07-22 19:00:04 -0400] mallu: what is the best way to update a community cookbook in my environment? just download it and knife cookbook upload?
[2014-07-22 19:00:07 -0400] vhost-: it needs to make directories and render templates
[2014-07-22 19:01:38 -0400] vhost-: that's why I was hoping there was a way to include a recipe in the deploy callback so I can just add the recipe to the dev run_list and the code will be shared
[2014-07-22 19:02:39 -0400] iboehman: Hi, our chef server is currently broken, bookshelf doesn't want to start
[2014-07-22 19:02:55 -0400] iboehman: when tailing the logs, all that shows up under /var/log/chef-server/bookshelf/current is
[2014-07-22 19:02:57 -0400] coderanger: vhost-: Reeally really don't use the deploy resource
[2014-07-22 19:03:02 -0400] iboehman: 2014-07-22_19:00:56.48707 Usage: bookshelf {start|stop|restart|reboot|ping|console|console_clean|attach}
[2014-07-22 19:03:14 -0400] coderanger: vhost-: It is all kinds of painful and almost entirely unnecessary
[2014-07-22 19:03:31 -0400] vhost-: coderanger: it's easy during my timecrunch, though
[2014-07-22 19:04:06 -0400] coderanger: vhost-: I promise you a git resource and some executes will be faster
[2014-07-22 19:04:55 -0400] lamont_oc: yeah, also either way you probably want to wrap it with an LWRP
[2014-07-22 19:05:16 -0400] coderanger: Yeah, git resource + lwrp is waaaay easier
[2014-07-22 19:05:41 -0400] lamont_oc: thatll allow you to write the deploy resource with the crazy callback once  and then you can refactor out the deploy resource like coderanger suggests and/or just do that first
[2014-07-22 19:06:11 -0400] coderanger: I should really write up an RFC to get deploy yanked out of core
[2014-07-22 19:06:29 -0400] gchristensen: yes please
[2014-07-22 19:06:32 -0400] lamont_oc: but you should start by writing a my_deploy LWRP
[2014-07-22 19:06:37 -0400] vhost-: lamont_oc: coderanger: you guys are convincing
[2014-07-22 19:06:40 -0400] gchristensen: coderanger: its so brutal.
[2014-07-22 19:07:06 -0400] vhost-: I'll just make a custom cookbook, I've done it for everything else thus far :)
[2014-07-22 19:07:15 -0400] double_p: VOTE http://www.youtube.com/watch?v=OQIYEPe6DWY
[2014-07-22 19:07:18 -0400] double_p: ewps
[2014-07-22 19:07:42 -0400] lamont_oc: yeah, its very patterned after duplicating capestrano, written like 5 years ago, and what happens underneath it is kind of an abomination
[2014-07-22 19:08:34 -0400] gkra: coderanger: thanks to #berkshelf, I was reminded that I needed "require 'chef/config'" in my ~/.chef/knife.rb :)
[2014-07-22 19:08:43 -0400] coderanger: gkra: Ahh, indeed :)
[2014-07-22 19:08:45 -0400] lamont_oc: the way its provider uses the SCM providers directly instead of constructing sub-resources is just bad
[2014-07-22 19:08:57 -0400] gkra: coderanger: now, back to taking over the world. :)
[2014-07-22 19:09:45 -0400] jjj555: please help.... chef-client on windows seems to be ignoring my client.rb, even when using the -c option
[2014-07-22 19:10:20 -0400] coderanger: jjj555: What issues are you seeing?
[2014-07-22 19:10:50 -0400] jbellone: Hullo
[2014-07-22 19:11:56 -0400] jjj555: @coderanger i am using hosted chef, my client.rb has my validation name, key and url... when i run chef-client, it only tries to load validation.pem instead of the ORG-validator.pem that I have configured.
[2014-07-22 19:12:23 -0400] coderanger: jjj555: Please pastebin your client.rb
[2014-07-22 19:13:16 -0400] double_p: (( back then.. http://www.youtube.com/watch?v=69xUOO9Dyus ))
[2014-07-22 19:13:50 -0400] jjj555: @coderanger: http://pastebin.com/HmtLmYuh
[2014-07-22 19:14:45 -0400] coalbe: are chef RFCs only internal?
[2014-07-22 19:15:04 -0400] coderanger: coalbe: Nope, all public
[2014-07-22 19:15:18 -0400] coderanger: jjj555: You probably want to escape those backslashes
[2014-07-22 19:15:36 -0400] coalbe: interested in this deploy resource development.
[2014-07-22 19:15:43 -0400] someara: RFC is a strong term imho
[2014-07-22 19:16:13 -0400] coderanger: someara: Yeah, I think Chef Enhancement Proposal is a better name, but I didn't pick it :)
[2014-07-22 19:16:14 -0400] jjj555: @coderanger: those were forward slashes... i changed them trying to fix this
[2014-07-22 19:16:51 -0400] coderanger: jjj555: Do you see the other settings take effect, like the server url?
[2014-07-22 19:18:05 -0400] jjj555: coderanger: i do not see my node_name. as far as the URL, i don't get far enough
[2014-07-22 19:18:23 -0400] coderanger: jjj555: Can you pastebin the output from chef-client -l debug?
[2014-07-22 19:19:14 -0400] jjj555: coderanger: also here is my command line: chef-client -c c:\chef\config.rb
[2014-07-22 19:23:58 -0400] Neozonz|Disc: Any professions here would like to connect via Skype?
[2014-07-22 19:24:10 -0400] coderanger: Neozonz|Disc: Hmm?
[2014-07-22 19:24:15 -0400] iboehman: Has anyone had an issue w/ bookshelf not starting?
[2014-07-22 19:24:34 -0400] Neozonz|Disc: coderanger, love to have you on my skype, your a wealth of knowledge :D
[2014-07-22 19:24:35 -0400] iboehman: 2014-07-22_19:24:23.73111 Usage: bookshelf {start|stop|restart|reboot|ping|console|console_clean|attach}
[2014-07-22 19:24:44 -0400] coderanger: Neozonz|Disc: Can't tell if spam :P
[2014-07-22 19:24:57 -0400] Neozonz|Disc: ?
[2014-07-22 19:25:05 -0400] Neozonz|Disc: I'm a real person! lol
[2014-07-22 19:25:08 -0400] coderanger: jjj555: Hmm, looks okay, I would throw a raise "foo" at the top of the client.rb to check that it is really loading the file
[2014-07-22 19:26:32 -0400] sam__: Question/Issue: when I update the node using a json file, I no longer see 'fqdn' attribute set to the correct value. it becomes null. anyone knows of any known issue?
[2014-07-22 19:28:00 -0400] coderanger: sam__: define "using a json file"?
[2014-07-22 19:28:08 -0400] coderanger: sam__: Do you mean knife node from file?
[2014-07-22 19:28:19 -0400] sam__: @coderanger correct
[2014-07-22 19:28:45 -0400] sam__: I bootstarpped using knife bootstrap and I see 'fqdn'.. but when I update the same node using json (knife node from file), it disappears
[2014-07-22 19:28:50 -0400] coderanger: sam__: Then yes, that fully overwrites the node data with whatever you specified
[2014-07-22 19:28:58 -0400] sam__: hmmmm
[2014-07-22 19:29:05 -0400] coderanger: sam__: Then next time chef-client runs, it will come back since that comes from ohai
[2014-07-22 19:29:38 -0400] sam__: @coderanger how can we make it just change what I specify and not overrite completely?
[2014-07-22 19:30:13 -0400] coderanger: sam__: No, Chef is a full REST API, all writes must be total, if you want to do delta updates thats up to you to manage
[2014-07-22 19:30:21 -0400] coderanger: sam__: You can do a get, modify, and put
[2014-07-22 19:32:46 -0400] MotherMGA: Is there a way to use knife-solo to deploy to multiple nodes at a time?
[2014-07-22 19:33:55 -0400] jjj555: @coderanger are you still there?
[2014-07-22 19:34:44 -0400] jjj555: can someone please help me? chef-client is not following my client.rb settings
[2014-07-22 19:35:50 -0400] jjj555: chef-client complains if i point it to a file that doesn't exist... but when i point it to my actual config.rb, it still looks for the validation key in the wrong place
[2014-07-22 19:38:30 -0400] jjj555: anyone available?
[2014-07-22 19:39:33 -0400] shlant1: jjj555: did you check if it's loading the file as per coderangers instructions?
[2014-07-22 19:43:05 -0400] geekbri: I've got a fairly popular chef cookbook I maintain.  I no longer have time to be the single maintainer of it.  I'm looking for collaborators to take control of it and help push it forward.  Any ideas of who may be interested in doing so? Would anybody here enjoy being a part of such a thing.  The cookbook is "redisio"
[2014-07-22 19:43:08 -0400] geekbri: https://supermarket.getchef.com/cookbooks/redisio
[2014-07-22 19:43:49 -0400] coderanger: geekbri: miah, brian, and myself should probably talk
[2014-07-22 19:44:02 -0400] j^2: grayhemp: my last company leveraged it. Thank you for all your work
[2014-07-22 19:44:08 -0400] coderanger: geekbri: Unfortunately I think we've all mostly stopped maintaining our respective forks at this point :(
[2014-07-22 19:44:09 -0400] geekbri: Seems reasonable.  My cookbook has needed honestly a complete overhaul but I just don't have the time to do it.
[2014-07-22 19:44:26 -0400] geekbri: So I tried my best to make improvements to it as is but, we don't use redis internally anymore
[2014-07-22 19:44:33 -0400] geekbri: and my free time is dwindling
[2014-07-22 19:44:50 -0400] j^2: geekbri: opps, my last company leveraged it. Thank you for all your work
[2014-07-22 19:45:03 -0400] geekbri: No problem.  I have a version thats almost ready for release
[2014-07-22 19:45:11 -0400] someara: geekbri I'd write the mailing list looking for somebody to take over maintainership
[2014-07-22 19:45:11 -0400] Neozonz|Disc: i <3 boto
[2014-07-22 19:45:13 -0400] geekbri: I may try to battle through, get that out and then try to get some additional help.
[2014-07-22 19:45:18 -0400] geekbri: someara: good idea
[2014-07-22 19:45:28 -0400] someara: pick a winner, not just the first responder =)
[2014-07-22 19:45:35 -0400] geekbri: Right so thats the hard part :)
[2014-07-22 19:46:14 -0400] coderanger: geekbri: Want to shoot me an email (noah@coderanger.net) and I'll rope in other folks?
[2014-07-22 19:46:22 -0400] geekbri: coderanger: sure I'll do that now.
[2014-07-22 19:46:56 -0400] coderanger: geekbri: Oh, you == brian, I missed that :)
[2014-07-22 19:47:15 -0400] geekbri: I am indeed Brian, if that means anything :)
[2014-07-22 19:47:16 -0400] jjj555: coderanger: any more ideas?
[2014-07-22 19:47:28 -0400] coderanger: jjj555: No, I'm out getting lunch right now
[2014-07-22 19:47:36 -0400] geekbri: Oh you mean I'm the brian from the 3 people
[2014-07-22 19:47:37 -0400] geekbri: yeha.
[2014-07-22 19:47:40 -0400] geekbri: I am indeed Brian.
[2014-07-22 19:48:40 -0400] Damm: geekbri, If you need collabs i'd be willing
[2014-07-22 19:48:50 -0400] coderanger: geekbri: Welp, I'll see what miah says, I too would love to revamp the codebase of my old one (of which miah's is a fork) but loltime
[2014-07-22 19:48:59 -0400] geekbri: Yeah, loltime is the real issue here.
[2014-07-22 19:48:59 -0400] Damm: geekbri, I wrote github.com/damm/redis originally as I was tired of the yakspew of redis cookbooks
[2014-07-22 19:49:02 -0400] Damm: and I dislike miahs
[2014-07-22 19:49:18 -0400] Damm: I basically came to the colusion to write a lwrp and then write a wrapper cookbook to drive it
[2014-07-22 19:49:23 -0400] geekbri: I mean ideally mine would get a complete rewrite.  In my head I know what it would look like but like coderanger said, LOLTIME
[2014-07-22 19:49:28 -0400] Damm: because I don't always want redis from apt
[2014-07-22 19:49:36 -0400] Damm: and you don't always want redis from source
[2014-07-22 19:49:44 -0400] geekbri: Plus I didn't want to abandon my existing users and leave them in the cold
[2014-07-22 19:49:46 -0400] Damm: devilish problem
[2014-07-22 19:49:53 -0400] Damm: yeah I use redisio
[2014-07-22 19:49:56 -0400] Damm: that's why I offered
[2014-07-22 19:50:17 -0400] Damm: I was going to adapt the monitor cookbook to use mine but I figured in leau of time just use a working good cookbook
[2014-07-22 19:51:11 -0400] geekbri: Yeah, my original plan was to make the 2.0 series push forward which would bring existing users to be able to use the latest versions
[2014-07-22 19:51:19 -0400] geekbri: then create a 3.x series branch that would be a rewrite.
[2014-07-22 19:51:29 -0400] shlant1: geekbri: I'm using your cookbook :) works for what I need
[2014-07-22 19:51:30 -0400] geekbri: Months later I haven't even been able to finish the 2.x series!
[2014-07-22 19:51:31 -0400] Damm: I was going to rewrite my lwrp to make the config file a hash
[2014-07-22 19:51:37 -0400] Damm: and just a bunch of keys to pass
[2014-07-22 19:51:39 -0400] coderanger: geekbri: Will follow up after lunch
[2014-07-22 19:51:44 -0400] Damm: but basically deploying redis is wrong
[2014-07-22 19:51:48 -0400] geekbri: coderanger: take your time.  I'm headed out of work in like 30 mins or so.
[2014-07-22 19:51:50 -0400] Damm: I don't maintain my cookbook beyond pulls
[2014-07-22 19:51:54 -0400] Damm: and that's just fine geekbri
[2014-07-22 19:52:04 -0400] Damm: github.com/damm/diamond is mostly random pull requests
[2014-07-22 19:52:10 -0400] Damm: I don't actively maintain it
[2014-07-22 19:52:24 -0400] Damm: doesn't mean it's bad; just means I don't actively keep it working
[2014-07-22 19:52:30 -0400] jjj555: coderanger and shlant1: is has something to do with how i copy-pasted it from my mac to windows... i guess line endings, but they seemed fine... i'll figure it out from here
[2014-07-22 19:52:43 -0400] geekbri: If I could clone myself, or disavow work and life responsibilities to work on such things I would.
[2014-07-22 19:52:51 -0400] geekbri: haha you exist.
[2014-07-22 19:52:52 -0400] Damm: ohwell i'm going to disappear as I don't exist
[2014-07-22 19:53:03 -0400] shlant1: jjj555: yea check for whitespace and newlines. Always gets me :0
[2014-07-22 19:53:23 -0400] gchristensen: Damm: this might behelpful: http://www.reddit.com/r/fifthworldproblems/comments/2bapdw/apparently_i_am_me_what_do_i_do_now/
[2014-07-22 19:56:10 -0400] maraca: Hi, I was upgrading to chef chef-server_11.1.3-1_amd64.deb and i got an error while running the upgrade
[2014-07-22 19:56:17 -0400] maraca: Error executing action `run` on resource 'execute[sqitchfy_database]'
[2014-07-22 19:56:46 -0400] maraca: any idea what im doing wrong?
[2014-07-22 19:57:06 -0400] holoway: maraca: from what version are you upgrading?
[2014-07-22 19:57:26 -0400] geekbri: Ok well I'm out for now folks.  will report back tomorrow
[2014-07-22 19:57:36 -0400] maraca: holoway, if i wasn't so stupid I would have looked before upgrading
[2014-07-22 20:01:39 -0400] maraca: looks like it's related to this https://github.com/opscode/chef/issues/1595
[2014-07-22 20:01:45 -0400] maraca: but it doesn't look good
[2014-07-22 20:10:38 -0400] Neozonz|Disc: coderanger, is it possible to run a command in a chef script thats adds onto the custom json chef holds?
[2014-07-22 20:13:58 -0400] maraca: anybody else having issues migrating from 11.1 to 11.1.3?  Squitch won't migrate my database
[2014-07-22 20:18:12 -0400] mmzyk: maraca There is a bug there, I believe. One second.
[2014-07-22 20:19:04 -0400] mmzyk: maraca https://github.com/opscode/chef/issues/1595 and it contains the patch needed. If you try it out and it works, let me know.
[2014-07-22 20:19:29 -0400] maraca: mmzyk, yep i was just looking this up - the patch doesn't work for me
[2014-07-22 20:19:59 -0400] maraca: gsreynolds mentioned having to restore from backups a few times - unfortunately I do not have that luxury :)
[2014-07-22 20:20:04 -0400] mmzyk: Ah, I see some backscroll. All right, what are you seeing then?
[2014-07-22 20:20:38 -0400] mmzyk: If you can gist/pastebin any error youve got, Ill see if I can diagnose it.
[2014-07-22 20:21:31 -0400] maraca: mmzyk, https://gist.github.com/maraca/f215a08cff099d31b35f
[2014-07-22 20:21:38 -0400] maraca: thanks a lot for your help - much appreciated
[2014-07-22 20:22:33 -0400] mmzyk: huh. all right, how comfortable are you digging up some info from your db?
[2014-07-22 20:23:02 -0400] mmzyk: And Ill see if I have a vm handy to play along.
[2014-07-22 20:23:31 -0400] maraca: i can do that
[2014-07-22 20:23:44 -0400] mmzyk: In a nutshell, its trying to deploy to the 1.0 tag in sqitch, but sqitch is saying that tag is already deployed.
[2014-07-22 20:24:16 -0400] maraca: i looked at sqitch 's docs and was going to try rolling back the tag - then you pinged me which is probably for the best hehe
[2014-07-22 20:24:47 -0400] mmzyk: Yeah, lets hope you dont need to mess with sqitch in this case.
[2014-07-22 20:25:00 -0400] mmzyk: Let me look a few things up and Ill be back in a minute with more direction.
[2014-07-22 20:25:08 -0400] maraca: sounds great. thanks mmzyk
[2014-07-22 20:27:48 -0400] Neozonz|Disc: is it possible to run a command in a chef script thats adds onto the custom json chef holds?
[2014-07-22 20:28:56 -0400] coderanger: Neozonz|Disc: What are you trying to do?
[2014-07-22 20:29:03 -0400] hypnosb: this is not working well at all
[2014-07-22 20:29:06 -0400] hypnosb: ugh
[2014-07-22 20:29:23 -0400] Neozonz|Disc: use boto to list_instances add them to my json list to use in other recipes
[2014-07-22 20:30:15 -0400] coderanger: Neozonz|Disc: Currently you can do that via node.set
[2014-07-22 20:30:27 -0400] Neozonz|Disc: node.set?
[2014-07-22 20:30:31 -0400] coderanger: Neozonz|Disc: However be aware there are plans forming to remove that in a future version
[2014-07-22 20:30:55 -0400] hypnosb: So chef recipes conflict with what is in fedora repo and I can't install mysql correctly, and now I can't bootstrap correctly because ubuntu wants to login as ubunuu rather than root
[2014-07-22 20:31:58 -0400] hypnosb: -x ?
[2014-07-22 20:32:01 -0400] hypnosb: ugh
[2014-07-22 20:32:02 -0400] someara: hypnosb the mysql cookbook needs to be updated to support fedora
[2014-07-22 20:32:31 -0400] someara: iirc they switched to mariadb by default and rely in the oracle mysql-community repo for "real mysql" packages
[2014-07-22 20:33:29 -0400] someara: also the systemd thing is going to break the provider, which was written against fedora-19
[2014-07-22 20:33:35 -0400] Neozonz|Disc: coderanger, don't understand how i'd read list_instances into node set though?
[2014-07-22 20:33:35 -0400] someara: and still used sysvinit
[2014-07-22 20:33:43 -0400] hypnosb: ugh
[2014-07-22 20:33:48 -0400] hypnosb: change this to chef debugging http://honestnetworker.wordpress.com/2014/02/16/network-debugging-in-a-nutshell/
[2014-07-22 20:33:53 -0400] coderanger: Neozonz|Disc: either the aws gem or fog
[2014-07-22 20:34:17 -0400] someara: computers gonna compute
[2014-07-22 20:34:17 -0400] Neozonz|Disc: u leading me into a rabbit hole lol
[2014-07-22 20:34:27 -0400] Neozonz|Disc: no idea what both those are, looks like i need to do some more reading
[2014-07-22 20:35:08 -0400] someara: I'll update mysql for centos7/fedora-20/mysql-5.7 after I'm doing getting apache24 working ;)
[2014-07-22 20:35:25 -0400] hypnosb: someara, what do I do about ubuntu requiring ubuntu user? I tried to bootstrap with -x but it does not sudo..
[2014-07-22 20:35:37 -0400] hypnosb: oh --sudo
[2014-07-22 20:35:38 -0400] hypnosb: derp
[2014-07-22 20:36:04 -0400] someara: I think nodes should be bootstrapped as root because sudo is the devil
[2014-07-22 20:36:05 -0400] shlant1: if I run a knife ec2 server create and disconnect, it still keeps running yes?
[2014-07-22 20:36:13 -0400] shlant1: disconnect = no internet
[2014-07-22 20:36:24 -0400] someara: and canonical making you log in and sudo for no good reason is an anti-pattern
[2014-07-22 20:36:34 -0400] someara: but I've been known to have opinions before
[2014-07-22 20:37:27 -0400] mmzyk: maraca I think we have a mistake in our upgrade process. Well, clearly we do.
[2014-07-22 20:38:14 -0400] maraca: mmzyk, at least it's identified :)
[2014-07-22 20:39:06 -0400] cheeseplus: someara: +1 to that opinion
[2014-07-22 20:39:25 -0400] mmzyk: maraca Im reasoning through what to tell you to do.
[2014-07-22 20:39:49 -0400] maraca: take your time. Do you think it's fixable?
[2014-07-22 20:41:02 -0400] mmzyk: maraca All right, so this is the file that kicks off an upgrade: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/recipes/pre_11.1_upgrade_setup.rb
[2014-07-22 20:41:11 -0400] maraca: yep
[2014-07-22 20:41:23 -0400] mmzyk: If you look at it, its a series of actions that notify each other.
[2014-07-22 20:41:42 -0400] maraca: yep
[2014-07-22 20:42:15 -0400] mmzyk: That first one, check_for_sqitch, kicks everything off. Thing is, it shouldnt run do to that only_if block in your case, so none of the other blocks should fire, but they clearly are.
[2014-07-22 20:42:31 -0400] maraca: oh i see
[2014-07-22 20:43:02 -0400] mmzyk: The short term fix is just dont run this file, but Im curious why its not working for you as expected.
[2014-07-22 20:43:20 -0400] maraca: somehow "pg_helper.is_running? && !pg_helper.managed_by_sqitch?" is returning true
[2014-07-22 20:43:29 -0400] mmzyk: You already have all the updates this file applies (all though we also have a bug else related to the issue you linked earlier.
[2014-07-22 20:43:41 -0400] whiteadam: Any of you cool cats use ServerSpec? trying to figure out some random failures
[2014-07-22 20:43:42 -0400] mmzyk: Yeah, thats the thing to dig into.
[2014-07-22 20:44:43 -0400] mmzyk: maraca pg_helper is here, fyi: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/libraries/helper.rb
[2014-07-22 20:44:52 -0400] maraca: was just looking for it
[2014-07-22 20:44:57 -0400] maraca: if i start chef-shell -s
[2014-07-22 20:45:15 -0400] maraca: would it be helpful to look at the values returned by the condition?
[2014-07-22 20:45:31 -0400] maraca: chef-shell -a rather
[2014-07-22 20:46:01 -0400] mmzyk: Yeah, we need to see what this returns: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/libraries/helper.rb#L44-L49
[2014-07-22 20:47:08 -0400] maraca: gimme a sec
[2014-07-22 20:48:52 -0400] maraca: mmzyk, https://gist.github.com/maraca/0693af9d7a550dbbc533
[2014-07-22 20:49:20 -0400] maraca: the command returns 2
[2014-07-22 20:49:21 -0400] maraca: i couldn
[2014-07-22 20:49:32 -0400] maraca: oops - i couldn't get it to run using chef-shell
[2014-07-22 20:50:21 -0400] mmzyk: yeah, no worries, what you did seems fine, although worrying.
[2014-07-22 20:50:52 -0400] mmzyk: I understand why things arent working for you at a high level - the sqitch verify failed, but we dont have a proper case there to hande that.
[2014-07-22 20:51:23 -0400] mmzyk: sqitch is on your system, but something with the schema appears to be out of whack.
[2014-07-22 20:53:07 -0400] mmzyk: maraca before attemping the upgrade things have gone well with the server?
[2014-07-22 20:53:17 -0400] maraca: its CPU was at 100%
[2014-07-22 20:53:22 -0400] maraca: its been like that for 1.5 days
[2014-07-22 20:53:52 -0400] maraca: looked similar to this http://lists.opscode.com/sympa/arc/chef/2013-08/msg00399.html
[2014-07-22 20:54:24 -0400] maraca: it has 2 cores and both of them where through the roof
[2014-07-22 20:54:44 -0400] mmzyk: huh. I think that issue was related to a depsolver bug that was fixed with 11.1.
[2014-07-22 20:54:57 -0400] maraca: also certain nodes when converging for the first time would throw this type of errors
[2014-07-22 20:55:00 -0400] maraca: "Response body length 36 does not match HTTP Content-Length header 206."
[2014-07-22 20:55:21 -0400] maraca: so yeah - both bugs i think were fixed with the latest chef, which is why i decided to upgrade
[2014-07-22 20:55:37 -0400] mmzyk: latest chef being the latest server?
[2014-07-22 20:55:52 -0400] maraca: chef-server 11.1.3
[2014-07-22 20:55:54 -0400] maraca: yep
[2014-07-22 20:56:20 -0400] maraca: client is running 11.12
[2014-07-22 20:56:46 -0400] mmzyk: And before trying this upgrade you were on 11.1 ?
[2014-07-22 20:56:52 -0400] maraca: i think 11.0
[2014-07-22 20:57:00 -0400] maraca: i * think*
[2014-07-22 20:57:05 -0400] maraca: i wish I had looked it up before
[2014-07-22 20:57:08 -0400] mmzyk: Okay. Thats useful to know.
[2014-07-22 20:57:13 -0400] mmzyk: No worries, well sort it.
[2014-07-22 20:57:19 -0400] mmzyk: So you run upgrade and what happens?
[2014-07-22 20:57:27 -0400] mmzyk: The first time, specifically, if you remember.
[2014-07-22 20:57:56 -0400] maraca: the first upgrade to the chef-server?
[2014-07-22 20:58:13 -0400] mmzyk: First time you tried to go from 11.0 to 11.1.3
[2014-07-22 20:59:09 -0400] maraca: I do have the stacktrace
[2014-07-22 20:59:13 -0400] maraca: i'll PM it to you
[2014-07-22 20:59:22 -0400] mmzyk: that works.
[2014-07-22 21:02:45 -0400] SmudgerDan: Hi guys, I know this is the wrong channel, but not getting much joy out of #vagrant... Anyone using vagrant with chef-client?
[2014-07-22 21:04:29 -0400] psadikov: @mmzyk @maraca we are having issues with chef-server as well. It was timing out resolving cookbook dependencies, so we restarted the server and got this
[2014-07-22 21:04:31 -0400] psadikov: 2014-07-22_19:07:48.41025 Usage: bookshelf {start|stop|restart|reboot|ping|console|console_clean|attach}
[2014-07-22 21:05:08 -0400] maraca: psadikov my bookshelf restarted properly after I restarted the chef server
[2014-07-22 21:05:13 -0400] mmzyk: psadikov seems different from the upgrade issues Im looking at for maraca.
[2014-07-22 21:05:51 -0400] mmzyk: psadikov I havent seen what youre talking about. You got the bookshelf usage where when you restarted the server?
[2014-07-22 21:06:08 -0400] psadikov: yeah, it's attempting to call 'runit' which is not a valid target
[2014-07-22 21:06:20 -0400] psadikov: well, we attempted an upgrade afterward and that failed first because of a postgres connection issue
[2014-07-22 21:06:38 -0400] psadikov: and then because of sqitch
[2014-07-22 21:07:13 -0400] mmzyk: well, we made a mess of 11.1.3 havent we.
[2014-07-22 21:08:00 -0400] mmzyk: Ill take some time to see if I can fix this push out a 11.1.4, because we clearly need it, but lets get you all sorted out.
[2014-07-22 21:08:23 -0400] mmzyk: psadikov you have any kind of stack trace that can be looked at?
[2014-07-22 21:09:21 -0400] psadikov: @mmzyk
[2014-07-22 21:09:23 -0400] psadikov: 2014-07-22 18:25:30.845 [error] <0.127.0> CRASH REPORT Process <0.127.0> with 0 neighbours exited with reason: {{error,{badarg,[{erlang,atom_to_list,["sqerl"],[]},{pooler_sup,pool_sup_name,1,[{file,"src/pooler_sup.erl"},{line,59}]},{pooler_sup,pool_sup_spec,1,[{file,"src/pooler_sup.erl"},{line,54}]},{pooler_sup,'-init/1-lc$^1/1-1-',1,[{file,"src/pooler_sup.erl"},{line,25}]},{pooler_sup,init,1,[{file,"src/pooler_sup.erl"},{line,25}]},{
[2014-07-22 21:10:02 -0400] mmzyk: can you put that in a gist or pastebin for easier reading? And perhaps give a bit more context on where that is coming from? I know its an erlang stack trace.
[2014-07-22 21:10:14 -0400] mmzyk: but knowing the log you pulled from would be helpful.
[2014-07-22 21:10:22 -0400] psadikov: sure, one sec
[2014-07-22 21:11:52 -0400] psadikov: https://gist.github.com/naphthalene/42d095aa6d68b285a7bc erchef console.log
[2014-07-22 21:15:06 -0400] psadikov: managed to get bookshelf to start, the only remaining error is the erchef trac
[2014-07-22 21:15:51 -0400] mmzyk: Yeah, so sqerl, that that error is complaing about, is our erlang db layer. Its the bit that talks to postgres.
[2014-07-22 21:16:10 -0400] mmzyk: Well, it uses the postgres driver to talk to postgres. Its our db abstraction layer.
[2014-07-22 21:17:19 -0400] mmzyk: psadikov Can you check the erchef logs and see if any useful info is there?
[2014-07-22 21:19:35 -0400] psadikov: @mmzyk https://gist.github.com/naphthalene/42d095aa6d68b285a7bc updated the gist, however this is all i'm seeing in the console log, it repeats every second or so
[2014-07-22 21:19:43 -0400] psadikov: digging through the other logs now
[2014-07-22 21:21:56 -0400] psadikov: @mmzyk this is pretty much the same info, there is nothing else that I can see right now
[2014-07-22 21:21:57 -0400] psadikov: https://gist.github.com/naphthalene/be69a01232e4da8c958a
[2014-07-22 21:23:00 -0400] mmzyk: okay, Im going to need to look up what is going on with pooler, our db connection pooling code. Can I come back to you in a bit psadikov? I need to focus on maraca to get him out of the pickle hes in.
[2014-07-22 21:24:17 -0400] psadikov: sure, thank you for your time
[2014-07-22 21:36:16 -0400] jjj555: hi, i am using an unattended msi install on my nodes. how can i provide an initial run-list to the node?
[2014-07-22 21:36:58 -0400] jjj555: coderanger: thanks for your help earlier... it turned out to be that my files were not ASCII
[2014-07-22 21:37:02 -0400] savant: Hi all
[2014-07-22 21:37:20 -0400] savant: I have a pretty simple report handler that sends a message to hipchat whenever a run completes
[2014-07-22 21:38:15 -0400] savant: https://gist.github.com/josegonzalez/2c29594cb417c7da1b85
[2014-07-22 21:38:25 -0400] savant: It seems that the numbers that run_status reports are incorrect
[2014-07-22 21:38:36 -0400] savant: For instance, chef-solo has the following output at the end of a run
[2014-07-22 21:38:39 -0400] savant: [54.237.142.43] out: Chef Client finished, 55/831 resources updated in 98.607357004 seconds
[2014-07-22 21:38:50 -0400] savant: Hipchat, however, was sent the following message:
[2014-07-22 21:38:51 -0400] savant: chef-solo ran successfully on bee-12-04-i-23be1d71, 49/861 resources updated in 94.97065154 seconds
[2014-07-22 21:39:13 -0400] savant: there is both a time disparity as well as a disparity in the numbers reported
[2014-07-22 21:39:52 -0400] savant: does anyone have any ideas as to what might be occurring or how I can get the correct numbers??
[2014-07-22 21:46:46 -0400] mmzyk: all right psadikov, Im going to see what I can figure out about your error.
[2014-07-22 21:46:59 -0400] psadikov: thanks
[2014-07-22 21:49:27 -0400] Eulipion: are there any tools for working with different deployments that can flip between knife.rbs?
[2014-07-22 21:50:40 -0400] psadikov: knife-block @Eulipion
[2014-07-22 21:50:50 -0400] Eulipion: psadikov: thx
[2014-07-22 21:50:55 -0400] iboehman: psadikov beat me to it
[2014-07-22 21:51:03 -0400] gyoza: HELLO IRC
[2014-07-22 21:51:07 -0400] gyoza: god i've been so busy
[2014-07-22 21:51:10 -0400] gyoza: cant even come chat:(
[2014-07-22 21:56:18 -0400] SmudgerDan: gyoza: oh no, why can't you chat?
[2014-07-22 21:56:27 -0400] mmzyk: psadikove what version of the chef server are you running?
[2014-07-22 21:57:31 -0400] mmzyk: er, psadikov I mean. What version of the chef server are you running?
[2014-07-22 21:58:13 -0400] iboehman: [iboehman@cs102.ops]:~ $ dpkg -l | grep chef ii  chef                             11.6.0-1.ubuntu.12.04             The full stack of chef ii  chef-server                      11.1.3-1                          The full stack of chef-server
[2014-07-22 21:58:27 -0400] psadikov: 11.1.3 now. I'm working with @iboehman at this time who ran the upgrade, which made changes to the pg_hba.conf and rabbitmq.conf
[2014-07-22 21:58:31 -0400] mmzyk: It appears that you have a bad conifg and a chef-server-ctl reconfigure would likely fix things, psadikov.
[2014-07-22 21:59:13 -0400] psadikov: @mmzyk any potential data loss by doing this?
[2014-07-22 21:59:28 -0400] iboehman: (that dpkg was before running chef-server-ctl upgrade)
[2014-07-22 22:00:03 -0400] mmzyk: Well, backups are always recommended, but a reconfigure is just a chef-solo run to ensure the chef server has all the proper templates and config values in place, it doesnt do any kind of migration or upgrade process.
[2014-07-22 22:01:05 -0400] psadikov: just ran, it broke rabbitmq and bookshelf is not starting
[2014-07-22 22:01:27 -0400] mmzyk: Oh fun. Okay, out of couriosity what version did you upgrade from?
[2014-07-22 22:01:40 -0400] iboehman: According to dpkg, it was 11.1.3-1
[2014-07-22 22:02:30 -0400] psadikov: https://gist.github.com/5141a46d8c8a35357f09
[2014-07-22 22:02:32 -0400] mmzyk: iboehman 11.1.3 is the latest version, but Im curious what version you were previously running.
[2014-07-22 22:02:51 -0400] psadikov: https://gist.github.com/faf7fb8d653439a86330
[2014-07-22 22:03:01 -0400] mmzyk: psadikov Yeah, not a surprise there. The listen interfaces were updated and the rabbit port changed.
[2014-07-22 22:03:15 -0400] iboehman: @mmzyk, that's the version that dpkg reported before I ran the upgrade
[2014-07-22 22:03:37 -0400] mmzyk: okay.
[2014-07-22 22:04:57 -0400] mmzyk: all right, this was just a dpkg upgrade of the chef server?
[2014-07-22 22:05:18 -0400] iboehman: I ran `chef-server-ctl upgrade`
[2014-07-22 22:05:41 -0400] mmzyk: okay. And that completed without error?
[2014-07-22 22:05:58 -0400] iboehman: No, the first run failed due to not being able to connect to postgres
[2014-07-22 22:06:06 -0400] iboehman: second runs failed on the sqiltch part
[2014-07-22 22:06:10 -0400] iboehman: sqitch*
[2014-07-22 22:06:46 -0400] mmzyk: Okay. Those are bugs on our part that Im aware of. So what did you do, if anything, to get around that?
[2014-07-22 22:08:15 -0400] iboehman: After the sqitch failures I stopped running the command, then we were trying manually to get bookshelf to work
[2014-07-22 22:08:53 -0400] iboehman: so i guess we didn't get around it
[2014-07-22 22:09:11 -0400] mmzyk: Okay. Did you apply the patch discussed in this issue? https://github.com/opscode/chef/issues/1595
[2014-07-22 22:09:21 -0400] iboehman: No
[2014-07-22 22:09:47 -0400] mmzyk: All right, so what I believe you need to do is apply that patch and then Im going to give you one more to apply.
[2014-07-22 22:10:00 -0400] mmzyk: And Ill have you re-run the upgrade process.
[2014-07-22 22:10:25 -0400] iboehman: okay great, thanks!
[2014-07-22 22:10:58 -0400] iboehman: which comment on that issue contains the patch?
[2014-07-22 22:11:02 -0400] iboehman: nvm
[2014-07-22 22:12:26 -0400] hasues: When I'm running knife solo cook against a host, it asks for a Password several times.  What password is being requested?
[2014-07-22 22:13:45 -0400] mmzyk: iboehman that should get you past the inital postgres errors, but we still need to clear the sqitch errors. It appears for some reason sqitch is applying the updates fine, but in our db tuning in 11.1.3 we some how seem to have prevented it from verifying the db correctly, so we need to just bypass that block.
[2014-07-22 22:14:49 -0400] hasues: Nevermind.
[2014-07-22 22:14:54 -0400] mmzyk: iboehman specifically, this line is going to report true when in this case it should report false: https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/recipes/pre_11.1_upgrade_setup.rb#L24
[2014-07-22 22:15:23 -0400] mmzyk: It reports true because the helper it uses here https://github.com/opscode/omnibus-chef-server/blob/master/files/chef-server-cookbooks/chef-server/libraries/helper.rb#L48 is going to get an exit code of 2.
[2014-07-22 22:16:14 -0400] mmzyk: So, youre choice, you can either modify the helper to expect 2 or modify the only if line to evaluate to false.
[2014-07-22 22:16:27 -0400] iboehman: got it. Okay, so once we've made the changes to the recipes, how should they be applied? chef-server-ctl upgrade or something else?
[2014-07-22 22:16:33 -0400] mmzyk: This is the same issue I worked through with maraca, fyi.
[2014-07-22 22:16:51 -0400] mmzyk: Yeah, these changes are to make chef-server-ctl upgrade work.
[2014-07-22 22:17:12 -0400] mmzyk: A bit of a hack, but its the best I can offer until we push out a fix. I didnt realize it was this badly broken.
[2014-07-22 22:17:19 -0400] psadikov: thanks @mmzyk - the rabbitmq port is still wrong, what caused that change?
[2014-07-22 22:17:42 -0400] mmzyk: psadikov Its an expected change that was put in place with the 11.1 release.
[2014-07-22 22:18:14 -0400] mmzyk: It was changed from the default to not collide with a port in use on one of the systems chef server can run on. I dont remember which one off the top of my head.
[2014-07-22 22:18:31 -0400] psadikov: cool, good to know
[2014-07-22 22:19:05 -0400] mmzyk: I suspect that with a fixed upgrade process and once you run that it should apply all the proper configs and all will work as expected.
[2014-07-22 22:19:17 -0400] psadikov: yep :D
[2014-07-22 22:19:18 -0400] iboehman: @mmzyk it's alive!
[2014-07-22 22:19:25 -0400] iboehman: thank you /so/ much
[2014-07-22 22:19:37 -0400] mmzyk: So you think youre good to go then?
[2014-07-22 22:19:41 -0400] psadikov: appears so
[2014-07-22 22:19:55 -0400] mmzyk: If something goes south, my irc handle @ getchef.com will reach me via email.
[2014-07-22 22:20:20 -0400] mmzyk: Ill look at getting a 11.1.4 out so we can fix this issues. Sorry for the headaches theyve caused.
[2014-07-22 22:20:54 -0400] iboehman: No problem, thanks for helping us getting it sorted out!
[2014-07-22 22:21:47 -0400] iboehman: @mmzyk can i buy you a beer or something? seriously saved my ass
[2014-07-22 22:22:05 -0400] mmzyk: If were ever in the same place, sure. :)
[2014-07-22 22:22:16 -0400] iboehman: sounds good :)
[2014-07-22 22:22:21 -0400] mmzyk: Although saving your ass was fixing our bugs, so perhaps I should buy. :)
[2014-07-22 22:22:54 -0400] mmzyk: All right, I need to log off, but if issues still linger, email and Ill look into them.
[2014-07-22 22:23:13 -0400] iboehman: sure thing!
[2014-07-22 22:57:40 -0400] rkgarcia: hi i have a open source chef server
[2014-07-22 22:57:53 -0400] rkgarcia: when i bootstrap a new client i have an error of ssl
[2014-07-22 22:58:04 -0400] rkgarcia: but my chef server have a valid crt
[2014-07-22 23:01:24 -0400] jameson_: /exit
[2014-07-22 23:02:36 -0400] maniacal: anyone know why 'ssh user' isn't part of knife.rb.   should be something I can set by default and then override with the command line.  would be especially useful when switching back and forth between internal stuff and aws
[2014-07-22 23:02:43 -0400] maniacal: :)
[2014-07-22 23:02:53 -0400] maniacal: oops, wrong window for that smile
[2014-07-22 23:03:14 -0400] maniacal: though I'm certainly happy to be here on #chef
[2014-07-22 23:04:35 -0400] maniacal: anyway.   guess I'm just ranting.  I've thought about submitting a pull request for the knife-ec2 project but I figured someone would have done that by now.  and since they haven't, there must be a reason.   just wondering if any of the old-timers here know why
[2014-07-22 23:05:06 -0400] sethvargo: @maniacal knife[:ssh_user]
[2014-07-22 23:05:57 -0400] maniacal: sethvargo: oh.  ok.  well, doesn't seem to be supported by knife-ec2 unless I'm just not reading the code right.
[2014-07-22 23:06:06 -0400] maniacal: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb
[2014-07-22 23:06:18 -0400] maniacal: line 107ish
[2014-07-22 23:07:06 -0400] sethvargo: https://github.com/opscode/knife-ec2/issues/42
[2014-07-22 23:07:52 -0400] maniacal: geez.  that took you 2 seconds.  thanks for the lesson on using search in git.  thanks
[2014-07-22 23:08:27 -0400] tequilarista: heh
[2014-07-22 23:08:55 -0400] maniacal: though looks closed so I guess i'll keep providing it via the command line
[2014-07-22 23:22:14 -0400] maniacal: jkeiser: do you guys plan to have a "bootstrap" resource for metal?  Wondering if it would be useful for to manage existing nodes (specifically, rebootstrap existing chef nodes).  I like to run chef via the bootstrap so I can use it to manage chef-client (the whole managing chef-client with a cookbook seems very wrong to me so I don't do it) so that's why having a bootstrap resource would be useful for me.
[2014-07-22 23:22:58 -0400] maniacal: but the whole metal concept is a little confusing to me anyway.  so maybe since I don't really get it I'm not understanding why having a bootstrap resource would be dumb :)
[2014-07-22 23:23:54 -0400] jkeiser: maniacal: there is a chef-metal-ssh driver that sounds like what you are talking about
[2014-07-22 23:23:59 -0400] maniacal: to me metal resource would be best setup to accept variables and then reused with different data passed to them each time to build different farms.   but in the examples it shows them used in static(y) cookbooks
[2014-07-22 23:24:24 -0400] maniacal: ok.  I'll take a look.  thx for the response
[2014-07-22 23:25:30 -0400] jkeiser: maniacal: most people will use it that way, I imagine, a cluster-defining recipe that can be tweaked with input.  It's code, so variables are an easy thing :)
[2014-07-22 23:26:21 -0400] maniacal: ok. cool.  good to hear.  I always feel lost when I read docs because I can't figure out what the use case for examples would be
[2014-07-22 23:41:49 -0400] mallu: Has anyone seen this? running minitest rabbitmq::default#test_0006_accepts AMQP connections: AMQ::Protocol::EmptyResponseError: Empty response received from the server.
[2014-07-22 23:42:17 -0400] mallu: however I can manually connect irb(main):015:0> c = Bunny.new("amqp://guest:guest@localhost:5671", irb(main):016:1* :verify_peer => false)
[2014-07-22 23:44:16 -0400] Damm: how are you running the minitest mallu?
[2014-07-22 23:44:51 -0400] mallu: during my chef-client run
[2014-07-22 23:45:44 -0400] Damm: well it's possible you disable the guest user
[2014-07-22 23:45:50 -0400] Damm: like any good security concious user
[2014-07-22 23:46:09 -0400] Damm: is that the case mallu ?
[2014-07-22 23:46:20 -0400] mallu: Please see this http://pastebin.com/P0xX5e46
[2014-07-22 23:46:34 -0400] mallu: no.. gues user is enabled
[2014-07-22 23:46:41 -0400] mallu: I can connect via irb
[2014-07-22 23:46:59 -0400] Damm: oh your writing a minitest?
[2014-07-22 23:47:36 -0400] Damm: https://github.com/kennonkwok/rabbitmq/blob/master/test/cookbooks/rabbitmq_test/files/default/tests/minitest/default_test.rb#L49
[2014-07-22 23:47:37 -0400] mallu: yes..
[2014-07-22 23:47:52 -0400] mallu: please see this with IRB output http://pastebin.com/EaPr1vZh
[2014-07-22 23:47:55 -0400] Damm: i'm assuming that's where you got it from
[2014-07-22 23:48:15 -0400] mallu: yes
[2014-07-22 23:48:22 -0400] Damm: hmm does that test work in test-kitchen?
[2014-07-22 23:48:25 -0400] Damm: i imagine it should
[2014-07-22 23:49:03 -0400] mallu: I don't have test-kitchen yet.. in my backlog
[2014-07-22 23:49:10 -0400] Damm: grab the chef dk
[2014-07-22 23:49:13 -0400] Damm: and it's all there
[2014-07-22 23:49:51 -0400] mallu: yes.. will do that... hoping to resolve this today though
[2014-07-22 23:50:11 -0400] Damm: well if your copying the test running it in the right context matters
[2014-07-22 23:50:41 -0400] Damm: running minitest on your runlist in chef-client isn't a bad thing but not all tests work within 'security'
[2014-07-22 23:50:46 -0400] Damm: they're more expecting blind defaults
[2014-07-22 23:51:03 -0400] Damm: so it works and sometimes it needs a nudge
[2014-07-22 23:51:44 -0400] mallu: ok
