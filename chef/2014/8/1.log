[2014-08-01 00:02:11 -0400] troyready: The Enterprise Chef documentation seems to indicate that a default organization is created upon install, but I'm not seeing it -- is that still accurate?
[2014-08-01 00:02:37 -0400] troyready: I know non-oss Chef questions are a little OT here, but hoping someone in the know happens to be around
[2014-08-01 00:05:37 -0400] fujin: troyready: I don't have a way to test but it should be pretty easy to tell: after install, do 'knife environment show _default'
[2014-08-01 00:05:47 -0400] fujin: troyready: in f/oss chef, the _default environment can't be deleted!
[2014-08-01 00:06:57 -0400] troyready: fujin, appreciate it, but I mean the "Organization" grouping that encapsulates everything in the Chef instance, not just the environment objects
[2014-08-01 00:07:15 -0400] fujin: oh sorry lol
[2014-08-01 00:07:18 -0400] fujin: organization :[]
[2014-08-01 00:07:27 -0400] fujin: hmm..
[2014-08-01 00:07:38 -0400] fujin: yeah pass sorry :-) f/oss chef doesn't even have an analogue to that!
[2014-08-01 00:07:44 -0400] fujin: perhaps contact your enterprise chef support representative
[2014-08-01 00:08:09 -0400] raul782: Hi guys, If I want to achieve ln -nfs
[2014-08-01 00:08:11 -0400] troyready: Yeah, I guess I'm going to have to. Just a little annoying because I enjoying giving and getting info here
[2014-08-01 00:08:13 -0400] troyready: :)
[2014-08-01 00:08:13 -0400] raul782: with link resource
[2014-08-01 00:08:22 -0400] raul782: what is the attributes I have to set
[2014-08-01 00:09:45 -0400] troyready: I don't see anything in the resource documentation that would indicate it supporting the 'no-dereference' option
[2014-08-01 00:09:46 -0400] troyready: sorry
[2014-08-01 00:10:14 -0400] fujin: you can use an execute with creates to idempotently call ln specifically if you chose
[2014-08-01 00:11:13 -0400] raul782: Ic, thanks fujin
[2014-08-01 00:17:41 -0400] jbarnett: fujin: you mind checking out my response? https://gist.github.com/jasonwbarnett/155484ef1c821631512c
[2014-08-01 00:20:04 -0400] Pursuit: Greetings! Is it possible to get 'knife data bag edit' to give a nicely formatted json file for modification? I only see everything on one line after the initial creation of the databag.
[2014-08-01 00:20:48 -0400] jbarnett: I just recently started seeing `knife edits` return as a single line of json... not sure how to fix it at this point.
[2014-08-01 00:24:00 -0400] fujin: what does knife data bag show foo bar -Fj  output? pretty format?
[2014-08-01 00:24:07 -0400] fujin: strange that the server side presentation would have changed.
[2014-08-01 00:24:57 -0400] jbarnett: fujin: Single line as well...
[2014-08-01 00:25:13 -0400] fujin: suboptimal
[2014-08-01 00:25:18 -0400] jbarnett: fujin: yaml looks just fine though
[2014-08-01 00:25:32 -0400] Pursuit: the json looks fine when editing a node
[2014-08-01 00:25:38 -0400] fujin: that kind of sounds like a regression
[2014-08-01 00:27:11 -0400] Pursuit: I get pretty output with data bag show -Fj
[2014-08-01 00:27:24 -0400] fujin: hmm
[2014-08-01 00:27:31 -0400] Pursuit: $ knife -v
[2014-08-01 00:27:33 -0400] Pursuit: Chef: 11.14.0.rc.2
[2014-08-01 00:27:38 -0400] jbarnett: I was running chef (11.14.0.rc.2). I removed that version and installed v11.12.8 and it's working again.
[2014-08-01 00:27:52 -0400] fujin: good RC testing guys! File a bug someone plz
[2014-08-01 00:27:53 -0400] jbarnett: gem uninstall chef; gem install chef -v11.12.8
[2014-08-01 00:28:03 -0400] fujin: or at least email to chef/chef-dev
[2014-08-01 00:28:04 -0400] fujin: ;-)
[2014-08-01 00:29:25 -0400] jbarnett: It won't let me submit an issue into JIRA
[2014-08-01 00:29:26 -0400] jbarnett: https://tickets.opscode.com/browse
[2014-08-01 00:29:37 -0400] fujin: iirc, issues are now tracked on GitHub?
[2014-08-01 00:29:54 -0400] jbarnett: gotcha
[2014-08-01 00:30:05 -0400] fujin: https://github.com/opscode/chef/issues
[2014-08-01 00:30:12 -0400] jbarnett: already, filed... https://github.com/opscode/chef/issues/1635
[2014-08-01 00:30:55 -0400] fujin: https://github.com/opscode/chef/issues/1635 ?
[2014-08-01 00:30:56 -0400] fujin: yeah
[2014-08-01 00:41:09 -0400] jbarnett: fujin: https://gist.github.com/jasonwbarnett/155484ef1c821631512c
[2014-08-01 00:43:42 -0400] fujin: jbarnett: worrrddd
[2014-08-01 00:43:51 -0400] fujin: I shoulda chucked a link when I mentioned it
[2014-08-01 00:43:55 -0400] jbarnett: fujin: Thanks again. I learned a lot.
[2014-08-01 00:44:40 -0400] jbarnett: fujin: Is there an alternative to using _set_or_return_root?
[2014-08-01 00:44:46 -0400] jbarnett: _set_or_return_ in generall..
[2014-08-01 00:45:13 -0400] fujin: jbarnett: nothing great that I could think to recommend. I would maybe just use the public API since we know that aint gonna change
[2014-08-01 00:45:18 -0400] jbarnett: I guess the alternative is doing something like this... http://tech.yipit.com/2013/05/09/advanced-chef-writing-heavy-weight-resource-providers-hwrp/
[2014-08-01 00:45:23 -0400] fujin: (new_resource.foo())
[2014-08-01 00:45:27 -0400] fujin: yer.. or get into HWRP town
[2014-08-01 00:45:36 -0400] jbarnett: oh, I didn't realize that is how you can set it. cool beans
[2014-08-01 00:46:00 -0400] jbarnett: so... > new_resource.$attribute($value)
[2014-08-01 00:46:04 -0400] fujin: yah~ new_resource.foo(baz) or new_resource.foo are set/get
[2014-08-01 00:46:07 -0400] fujin: word
[2014-08-01 00:46:10 -0400] jbarnett: cool.
[2014-08-01 00:46:42 -0400] jbarnett: like so... https://gist.github.com/jasonwbarnett/155484ef1c821631512c
[2014-08-01 00:47:03 -0400] fujin: yup!
[2014-08-01 00:47:15 -0400] jbarnett: sweet as.
[2014-08-01 01:01:04 -0400] Ravi: hi
[2014-08-01 01:01:39 -0400] Ravi: how to call this  /etc/chef/ohai/hints/ec2.json in recipe
[2014-08-01 01:01:57 -0400] Ravi: i want use this ohai plungin inside recipe
[2014-08-01 01:02:55 -0400] Ravi: #ohai is see all the node stuff
[2014-08-01 01:03:19 -0400] Ravi: dont know how load this?
[2014-08-01 01:05:20 -0400] fujin: node['ec2'] is how you access the ec2 plugin information from a recipe
[2014-08-01 01:05:31 -0400] fujin: or like, node['cloud'] should be populated as well.
[2014-08-01 01:05:42 -0400] Ravi: i am using chef-solo
[2014-08-01 01:06:57 -0400] Ravi: case node[:placement_availability_zone]
[2014-08-01 01:06:58 -0400] Ravi:   when 'eu-west-1b'
[2014-08-01 01:06:58 -0400] Ravi:   execute "touch /home/nanjegow/eu-west-1b.txt" do
[2014-08-01 01:06:59 -0400] Ravi:   command "touch /home/nanjegow/eu-west-1b.txt"
[2014-08-01 01:06:59 -0400] Ravi:   group "root"
[2014-08-01 01:06:59 -0400] Ravi:   action :run
[2014-08-01 01:07:00 -0400] Ravi:   end
[2014-08-01 01:07:00 -0400] Ravi: end
[2014-08-01 01:07:08 -0400] Ravi: for example i am calling like this
[2014-08-01 01:07:22 -0400] Ravi: some how it not working
[2014-08-01 01:09:14 -0400] Ravi: ?
[2014-08-01 01:15:15 -0400] cwj: Ravi: you need to use node[:ec2][:placement_availability_zone]
[2014-08-01 01:15:51 -0400] Ravi: cool let me try..highly appreciated
[2014-08-01 01:17:25 -0400] Damm: but what if he's not on ec2?
[2014-08-01 01:17:28 -0400] Damm: lol
[2014-08-01 01:18:30 -0400] Ravi: i am on ec2
[2014-08-01 01:18:52 -0400] Ravi: i am trying to use /etc/chef/ohai/hints/ec2.json
[2014-08-01 01:19:54 -0400] raul782: Hi guys, how can I store a chef variable from a command
[2014-08-01 01:21:33 -0400] iverson0881: hi, is there any simple way to use a target node's attributes vs a local node's attributes
[2014-08-01 01:22:27 -0400] iverson0881: for example...filling out an /etc/hosts file...i have different internal interfaces and use a chef chef attribute called ['network']['interface_private']
[2014-08-01 01:23:20 -0400] iverson0881: but if i use this on a node for say all chef environments. where in some chef environments that variable has a different value. it only uses the local node's chef variable where chef-client has run
[2014-08-01 01:54:01 -0400] jbarnett: Is there anyway to raise an exception cleanly in an LWRP?
[2014-08-01 01:58:03 -0400] jbarnett: peace
[2014-08-01 02:42:02 -0400] juliancdunn: like "raise"?
[2014-08-01 02:55:36 -0400] Damm: i like to throw
[2014-08-01 04:19:14 -0400] raul782: Hi guys if I declare a variable inside a block of a ruby_block, how can I access in the same recipe later but outside the ruby_block?
[2014-08-01 04:23:58 -0400] coderanger: raul782: You cannot
[2014-08-01 04:24:04 -0400] coderanger: raul782: Nor would that have any meaning
[2014-08-01 04:25:28 -0400] raul782: I'm trying to to do something like  node['my_variable'] = File.readlink("/my_symlink")
[2014-08-01 04:25:43 -0400] raul782: inside a block of a ruby_block
[2014-08-01 04:26:12 -0400] raul782: Is there a chef way to do that?
[2014-08-01 04:26:20 -0400] coderanger: raul782: node.set['myvar'] = 'whatever'
[2014-08-01 04:27:50 -0400] raul782: so would that work inside
[2014-08-01 04:27:51 -0400] raul782: ruby_block 'set variable' do
[2014-08-01 04:27:51 -0400] raul782:   block do
[2014-08-01 04:27:52 -0400] raul782:   node.set['myvar'] = File.readlink("/my_symlink")
[2014-08-01 04:27:52 -0400] raul782:  end
[2014-08-01 04:27:53 -0400] raul782:  action:run
[2014-08-01 04:27:53 -0400] raul782: end
[2014-08-01 04:29:33 -0400] coderanger: but remember That will work, but you can't (easily) use that outside the block
[2014-08-01 04:29:38 -0400] coderanger: remember chef is a two pass system
[2014-08-01 04:29:52 -0400] coderanger: first all resources are compiled to the collection, and then the collection is converged
[2014-08-01 04:30:11 -0400] coderanger: So code inside the ruby block vs. outside happen at different points
[2014-08-01 04:31:07 -0400] raul782: Ic, I remember that was what I was reading, so if I'm going to execute something should that be inside the ruby_block too?
[2014-08-01 04:31:42 -0400] raul782: I mean If I'm going to use an execute command
[2014-08-01 04:31:46 -0400] coderanger: What are you trying to accomplish?
[2014-08-01 04:32:57 -0400] raul782: well after the application has been deployed, I want to know the target path of the symlink current
[2014-08-01 04:34:00 -0400] coderanger: raul782: You can get that more directly, let me check the code
[2014-08-01 04:34:36 -0400] raul782: ok one sec to create the gist
[2014-08-01 04:36:46 -0400] raul782: https://gist.github.com/raul782/aea4d26f23f4d1923ecc
[2014-08-01 04:37:52 -0400] coderanger: raul782: Why do you need the link target?
[2014-08-01 04:38:19 -0400] raul782: to perform all the execution from the release_path
[2014-08-01 04:38:21 -0400] coderanger: Oh, this isn't using the normal deploy resource
[2014-08-01 04:38:27 -0400] coderanger: no idea how this works
[2014-08-01 04:38:42 -0400] raul782: I let opsworks do the deployment
[2014-08-01 04:38:49 -0400] raul782: but after that I need to fix some bits
[2014-08-01 04:39:21 -0400] coderanger: Yeah, this won't work as written
[2014-08-01 04:39:36 -0400] coderanger: you would have to mark everything using that attribute with lazy {}
[2014-08-01 04:40:11 -0400] shlant: coderanger: can you think of a reason why runit timesout when trying to restart my unicorn log? All that's in the runit log is:
[2014-08-01 04:40:13 -0400] shlant: 2014-08-01_04:03:53.34398 Unicorn master already running. PID: 8620
[2014-08-01 04:40:13 -0400] coderanger: raul782: and this is super fragile
[2014-08-01 04:40:14 -0400] shlant: 2014-08-01_04:03:53.34399 Waiting for current master to die. PID: (8620)
[2014-08-01 04:40:18 -0400] coderanger: raul782: Just use a git resource instead
[2014-08-01 04:40:43 -0400] raul782: what do you mean by using git resource?
[2014-08-01 04:40:46 -0400] coderanger: shlant: Does unicorn wait for workers to finish before closing?
[2014-08-01 04:41:01 -0400] coderanger: raul782: Use a simpler git resource instead of the fancy deploy structure
[2014-08-01 04:41:32 -0400] shlant: coderanger: not sure. Would that be in the unicorn.rb? this is on a very first run
[2014-08-01 04:41:50 -0400] shlant: the master is running with all workers
[2014-08-01 04:41:57 -0400] shlant: but the restart of log still fails
[2014-08-01 04:43:30 -0400] coderanger: shlant: Not sure then, I just ported most of that code
[2014-08-01 04:45:21 -0400] shlant: coderanger: not sure if this helps: https://gist.github.com/MrMMorris/92e170f8fe67f8ca5725
[2014-08-01 04:48:03 -0400] shlant: it's weird cause I'm almost positive it was working earlier
[2014-08-01 04:48:58 -0400] raul782: coderanger: thanks I will study the git resource and try again what you suggest, I was taking advantage of opsworks since it downloads automatically my repo
[2014-08-01 04:50:46 -0400] shlant: raul782: yea it seems most of the things that Opsworks tries to make easier actually causes more headache
[2014-08-01 04:53:48 -0400] raul782: shlant: got it, yeah at the beginning I thought it would be really simple to customize my layer, but it has had its challenges
[2014-08-01 04:56:11 -0400] shlant: raul782: someone here said it best: "You can't use Opsworks if you don't know Chef, and if you know Chef you shouldn't use Opsworks" :p
[2014-08-01 04:56:29 -0400] shlant: it just seems like a solution nobody needs
[2014-08-01 04:57:08 -0400] raul782: anyway I feel more comfortable with chef now than 2 days ago when I started learning, got it that's something I'm learning really fast
[2014-08-01 06:36:30 -0400] merqlove: Hello guys. please help. Which scenario would be best. use fat recipes vs use providers/libs with thin recipes? Chef 11.x.
[2014-08-01 06:37:13 -0400] merqlove: number of recipes 10+
[2014-08-01 06:40:14 -0400] erthad__: hiall, api.berkshelf.com is down again?
[2014-08-01 06:40:35 -0400] erthad__: Error retrieving universe from source: https://api.berkshelf.com
[2014-08-01 06:40:37 -0400] erthad__:   * [Berkshelf::APIClient::TimeoutError] Unable to connect to: https://api.berkshelf.com
[2014-08-01 06:45:30 -0400] erthad: if I change https://api.berkshelf.com to https://supermarket.getchef.com in the Berksfile the issue is the same
[2014-08-01 06:45:41 -0400] erthad: Fetching cookbook index from https://supermarket.getchef.com...
[2014-08-01 06:45:43 -0400] erthad: Error retrieving universe from source: https://supermarket.getchef.com
[2014-08-01 06:45:45 -0400] erthad:   * [Berkshelf::APIClient::TimeoutError] Unable to connect to: https://supermarket.getchef.com
[2014-08-01 06:49:33 -0400] merqlove: Try to use http
[2014-08-01 06:49:46 -0400] merqlove: instead of https
[2014-08-01 06:50:06 -0400] erthad: the same
[2014-08-01 06:50:30 -0400] merqlove: Hmm, bad(
[2014-08-01 06:52:05 -0400] merqlove: seems supermarket down
[2014-08-01 06:53:34 -0400] merqlove: https://gitter.im/opscode/supermarket
[2014-08-01 06:59:01 -0400] cloudbud: hi
[2014-08-01 07:11:17 -0400] JamesBelchamber: Are there any license restrictions on new cookbooks added to the supermarket?
[2014-08-01 07:14:22 -0400] erthad: it looks like berks fails to update from supermarket but still able to upload 3rd-party cookbooks to my chef server
[2014-08-01 07:39:39 -0400] kramos: how do I identify which platform version is installed? Like for ubuntu, if it's 12.04 or 14.04
[2014-08-01 07:48:39 -0400] SmudgerDan: kramos: you can use Ohai
[2014-08-01 07:49:03 -0400] SmudgerDan: kramos: node['platform_version']
[2014-08-01 07:50:09 -0400] kramos: yep. ok thanks for pointing that. I'm just guessing there's more near from platform_family without getting with ohai
[2014-08-01 08:00:20 -0400] cloudbud: .http://stackoverflow.com/questions/25075506/how-can-we-generate-individual-billings-for-customers-according-to-there-usage-i
[2014-08-01 09:04:22 -0400] matti: Ohai Chefs
[2014-08-01 09:05:03 -0400] aleszoulek: hello, quick question for chef-solo. I'm using json_attrib (or -j param) /my/settings.json to pass JSON data to chef-solo. Is there a way how to support something like json_attrib /my/settings.d/*.json ?
[2014-08-01 09:06:29 -0400] matti: aleszoulek: It's a single file at the moment.
[2014-08-01 09:09:30 -0400] aleszoulek: matti: Thanks!
[2014-08-01 09:09:34 -0400] aleszoulek: I'll work around
[2014-08-01 09:11:29 -0400] SmudgerDan: Ohai matti!
[2014-08-01 09:11:37 -0400] matti: Ohai SmudgerDan
[2014-08-01 09:12:25 -0400] matti: SmudgerDan: How's tricks?
[2014-08-01 09:13:48 -0400] SmudgerDan: matti: painful, we are using vagrant to create our VMs and then chef to provision them (note that we are not using the vagrant provision functionality in production)
[2014-08-01 09:14:31 -0400] SmudgerDan: matti: so I asked, what do we have to do to recreate the boxes we have for vagrant.... tumbleweed
[2014-08-01 09:15:11 -0400] SmudgerDan: matti: so I started writting some cookbooks which would take our Win Server 2008R2 from the iso, straight to being vagrant ready
[2014-08-01 09:15:53 -0400] SmudgerDan: matti: got it all working, created a new box and deployed it into production.
[2014-08-01 09:16:09 -0400] SmudgerDan: matti: and now the bloody things wont bootstrap to the chef server
[2014-08-01 09:16:54 -0400] SmudgerDan: matti: sorry for the vent =D
[2014-08-01 09:32:42 -0400] matti: SmudgerDan: No problem.
[2014-08-01 09:32:48 -0400] matti: SmudgerDan: It's Windows, I feel your pain ;]
[2014-08-01 09:33:04 -0400] ptz: Hey, got a dumb question, i've always been launching "chef-client" command on the bootstrapped node by logging in to the server, how can i do that from workstation or chef server? In bulk?
[2014-08-01 09:37:34 -0400] emfl: ptz: knife ssh chef-client ?
[2014-08-01 09:37:44 -0400] SmudgerDan: damn it, failed again...
[2014-08-01 09:41:33 -0400] ptz: right, thanks.
[2014-08-01 09:41:43 -0400] ptz: hah
[2014-08-01 09:53:57 -0400] Damacus: ptz yeah chef-client should ideally be running deamonized.
[2014-08-01 09:57:35 -0400] workmad3: ptz: also, the chef bootstrap script fires off a chef-client run
[2014-08-01 10:05:23 -0400] SmudgerDan: arrrrrrrrrr the same command on the old version of the box bootstraps fine, the next version fails on authorization.  Is there something magical which needs to be turned on a Windows box for bootstrapping to work correctly?
[2014-08-01 10:20:01 -0400] ptz: Thanks Damacus and workmad3, now i know heh
[2014-08-01 10:21:16 -0400] Damacus: ptz have you looked at https://github.com/opscode-cookbooks/chef-client
[2014-08-01 10:21:56 -0400] Damacus: you can set it up and mange chef-client through that.
[2014-08-01 10:22:31 -0400] Damacus: we set a bunch of defaults like chef-server in that cookbook, which makes sure our chef-client's talk to the right server, are running daemonized
[2014-08-01 10:22:44 -0400] ptz: oooh, nice
[2014-08-01 10:23:01 -0400] Damacus: the second one is useful as a base recipe, so when you bootstrap it, the chef-client cookbook sorts itself out
[2014-08-01 10:24:36 -0400] ptz: i see now, that's exactly what i was missing
[2014-08-01 10:25:04 -0400] ptz: cheers for this Damacus
[2014-08-01 10:25:47 -0400] Damacus: no problem, it's why I spend me time here. Someone might as well learn from the past year or two of using chef
[2014-08-01 10:26:41 -0400] ptz: heh true, i just started out using it really recently
[2014-08-01 10:26:58 -0400] ptz: so still wrapping my head around it all
[2014-08-01 10:27:18 -0400] Damacus: feel free to ask as many questions as possible, I know the feeling of brain melt
[2014-08-01 10:28:08 -0400] ptz: thanks, i will heh
[2014-08-01 10:31:47 -0400] ptz: do you have any experience with aws ec2-s and chef? my end goal is to get automatic ecommerce deployments on aws, just wondering if i should create everything separately or use aws opsworks and just use my chef recipes, which still requires bit of manual work
[2014-08-01 10:32:51 -0400] Damacus: I have sadly no experience with opsworks.
[2014-08-01 10:33:05 -0400] Damacus: from my current position I would use my current chef-server (external to aws.
[2014-08-01 10:33:37 -0400] Damacus: but... starting from afresh
[2014-08-01 10:33:56 -0400] Damacus: post on the mailing list if you don't hear back within an hour.
[2014-08-01 10:36:48 -0400] ptz: ah ok, good call
[2014-08-01 10:47:45 -0400] srenatus: hi there.  has anyone used the mysql cookbook with knife-container?
[2014-08-01 11:18:37 -0400] SmudgerDan: Bootstrapping two (differently configured) windows 2008R2 VM boxes, from the same working directory on the host machine I call the same knife command (changing the fqdn of course) both install chef on the guest, one registered the client and node the other gives me a 401 not authorized error
[2014-08-01 11:18:40 -0400] SmudgerDan: any ideas?
[2014-08-01 12:05:46 -0400] zeroXten: can someone please add the list of cookbook categories to a wiki somewhere? impossible to find these days
[2014-08-01 12:20:20 -0400] ptz: zeroXten yeah, categorized wiki would be awesome
[2014-08-01 12:21:50 -0400] ptz: only who? i wouldn't mind to contribute but don't have the time to set it all up myself
[2014-08-01 12:36:25 -0400] srenatus: where's container_service defined btw?
[2014-08-01 12:44:39 -0400] aaronrl: am i correct in assuming the intention of the service resource is to manage pre-existing services, not creating new ones?  at least in the context of windows services
[2014-08-01 12:45:32 -0400] srenatus: ah, chef-init.
[2014-08-01 13:11:28 -0400] SmudgerDan: aaronrl: yes the Windows service needs to already be created for the chef service to manage it
[2014-08-01 13:12:02 -0400] aaronrl: SmudgerDan, thanks! wasn't sure if i was just looking at things wrong
[2014-08-01 13:12:50 -0400] SmudgerDan: aaronrl: that's what we do at least, run the chef execute function with the command "sc create"
[2014-08-01 13:13:22 -0400] SmudgerDan: aaronrl: but only_if the service doesnt already exist
[2014-08-01 13:13:46 -0400] SmudgerDan: can use "::Win32::Service.exists?" passing in the service name
[2014-08-01 13:14:21 -0400] aaronrl: yeah that was my backup plan, was just trying to google a more chef-y way of doing it and wasn't turning up anything
[2014-08-01 13:14:49 -0400] SmudgerDan: aaronrl: if you find anything let me know as that is how we are doing it
[2014-08-01 13:15:59 -0400] SmudgerDan: Bootstrapping two (differently configured) windows 2008R2 VM boxes, from the same working directory on the host machine I call the same knife command (changing the fqdn of course) both install chef on the guest, one registered the client and node the other gives me a 401 not authorized error
[2014-08-01 13:16:06 -0400] SmudgerDan: any ideas?
[2014-08-01 13:23:02 -0400] fretb: Hi everyone
[2014-08-01 13:23:16 -0400] fretb: Having a weird issue in my base cookbook when defining an apt resource
[2014-08-01 13:23:34 -0400] fretb: The distribution has to be 'squeeze-lts'
[2014-08-01 13:23:54 -0400] fretb: So i put 'distribution node[:lsb][:codename] + '-lts'
[2014-08-01 13:24:12 -0400] fretb: and I get an undefined method `+' for nil:NilClass error at compile time
[2014-08-01 13:24:18 -0400] fretb: Yet kitchen testing succeeded
[2014-08-01 13:24:27 -0400] fretb: Full error here: http://pastie.org/private/sc6iayoorka9hht1p5low
[2014-08-01 13:25:02 -0400] jharley: fretb: can you put it in a lazy block and see if that helps?
[2014-08-01 13:25:23 -0400] fretb: lazy block = { } ?
[2014-08-01 13:25:26 -0400] jharley: e.g. distribution lazy { node[:lsb][:codename] + '-lts }
[2014-08-01 13:25:30 -0400] fretb: ok
[2014-08-01 13:25:43 -0400] jharley: pretend the syntax is correct there :\
[2014-08-01 13:26:38 -0400] jharley: If that works Ill (try to) explain why
[2014-08-01 13:27:20 -0400] fretb: yes, that worked, thanks!
[2014-08-01 13:28:54 -0400] jharley: okay, so, what was happening was that you were accessing an attribute in a resource before it was set
[2014-08-01 13:29:18 -0400] jharley: chefs attributes are converged into the node object in the first stage of the run, but you were accessing it before it was set in that run
[2014-08-01 13:29:26 -0400] jharley: lazy blocks say wait till later to calculate this'
[2014-08-01 13:29:55 -0400] fretb: All clear, thanks for the clarification jharley! :-)
[2014-08-01 13:29:58 -0400] jharley: as for kitchen passing.. Im going to assume that it has to do with the synthentic nature of kitchen tests?  Im not using kitchen yet, so its a bit of a blond spot for me
[2014-08-01 13:30:04 -0400] jharley: happy to help
[2014-08-01 13:30:30 -0400] fretb: Yea i presume kitchen can already access attributes at compile time?
[2014-08-01 13:30:42 -0400] jharley: sounds about right?
[2014-08-01 13:58:21 -0400] SmudgerDan: "Failed to authenticate as 'UIAWEBX1.LAB.RDT.CO.UK'. Ensure that your node_name and client key are  correct." If I see this again I think I am going to scream
[2014-08-01 13:59:00 -0400] george_mcfly: good morning, anyone have experience accessing attributes set in .kitchen.yml from their serverspec tests ?
[2014-08-01 13:59:09 -0400] dpetzel2: aynone know what happend to Chef DK 0.2.0? It seems the download page is only offering 0.1.0 now
[2014-08-01 14:00:21 -0400] jonlives: dpetzel2: I see both
[2014-08-01 14:00:44 -0400] dpetzel2: jonlives: hmm wierd, thanks
[2014-08-01 14:00:46 -0400] jonlives: dpetzel2: there's a drop down just below the OS chooser on http://downloads.getchef.com/chef-dk
[2014-08-01 14:01:28 -0400] dpetzel2: yeah, Im not getting the drop down, and the page doesn't even look properly rendered
[2014-08-01 14:01:54 -0400] SmudgerDan: dpetzel2: http://downloads.getchef.com/chef-dk/ seem to list 0.2.0 as a download
[2014-08-01 14:01:59 -0400] jonlives: different browser maybe?
[2014-08-01 14:02:13 -0400] ismell: hrmm
[2014-08-01 14:02:15 -0400] dpetzel2: yeap, working fine in FF, but Chrome wasn't rendering the page properly
[2014-08-01 14:02:21 -0400] ismell: the sign in button on cookbooks.opscode.com is broken
[2014-08-01 14:10:40 -0400] ismell: the supermarket is confusing me, how do I update an existing cookbook?
[2014-08-01 14:11:15 -0400] dpetzel2: ismell: as in upload a new version? I used stove to do it
[2014-08-01 14:11:23 -0400] someara: use supermarket.getchef.com and the URLs will work
[2014-08-01 14:11:31 -0400] ismell: that's new to me... google time :)
[2014-08-01 14:11:40 -0400] someara: you can use knife cookbook site share
[2014-08-01 14:11:41 -0400] someara: or stove
[2014-08-01 14:11:43 -0400] ismell: I don't even have knife configured anymore
[2014-08-01 14:11:54 -0400] someara: me neither... so, stove =)
[2014-08-01 14:11:55 -0400] ismell: gotts figure out how to get my config setup ;)
[2014-08-01 14:14:25 -0400] someara: https://gist.github.com/someara/bf692e6fab6f1cf2d0c7
[2014-08-01 14:19:58 -0400] ismell: k, think i got stove setup
[2014-08-01 14:23:11 -0400] ismell: lol, I guess the .pem I use for stove isn't the same one as manage.opscode.com?
[2014-08-01 14:26:30 -0400] ismell: ah, cool that was easy :)
[2014-08-01 14:28:48 -0400] drewlander: we are running chef-server 10.14.2 and seeing cpu spiking to 100% fairly often. The obvious things look fine (16 core machine, 128 GB ram) disks are not being hit that bad
[2014-08-01 14:28:55 -0400] ismell: thanks
[2014-08-01 14:29:00 -0400] drewlander: the logs do not show any errors
[2014-08-01 14:29:25 -0400] drewlander: we are at a loss as to what to look at next, our chef-clients are getting random connection refused when trying to contact the chef server
[2014-08-01 14:29:54 -0400] mattray: drewlander: lots of known performance issues with chef-server 10, if upgrading to 11 isn't possible maybe investigate a newer 10 build?
[2014-08-01 14:29:59 -0400] drewlander: can anyone provide any suggestions as to what we should look at to see why, or where/what we should be looking for
[2014-08-01 14:30:10 -0400] drewlander: chef 11 isnt possible yet (large prod environment)
[2014-08-01 14:30:40 -0400] drewlander: we are scared of upgrading to a newer version of chef-server
[2014-08-01 14:30:51 -0400] drewlander: what happened was
[2014-08-01 14:30:55 -0400] mattray: drewlander: if you wait long enough 12 will be out ;)
[2014-08-01 14:31:03 -0400] drewlander: haha
[2014-08-01 14:31:05 -0400] jonlives: drewlander: we've been through the same upgrade - it's pretty painless :)
[2014-08-01 14:31:24 -0400] itwasntandy: drewlander: if you wanted to work around the problem, you can setup some slaves of the chef-server and distribute the load around
[2014-08-01 14:31:34 -0400] mattray: 11's performance is orders of magnitude better across the board
[2014-08-01 14:31:39 -0400] itwasntandy: and then what you /could/ do is upgrade one of the slaves to chef 11
[2014-08-01 14:31:39 -0400] jonlives: ^ this
[2014-08-01 14:31:47 -0400] drewlander: what happened was we had 2 boxes, with chef data shared via drbd. our main server was running fine, but it had bad ram so we failed over to the b and now we have this problem
[2014-08-01 14:31:47 -0400] jonlives: (to mattray)
[2014-08-01 14:31:54 -0400] drewlander: we do want to do 11, but our cookbooks break
[2014-08-01 14:31:58 -0400] itwasntandy: and if that gors well keep upgrading all the slaves, and then the master
[2014-08-01 14:32:05 -0400] someara: chef-server and chef-client are two different things
[2014-08-01 14:32:16 -0400] someara: you can run chef10 clients against a chef11 server iirc
[2014-08-01 14:32:18 -0400] drewlander: jonlives: you upgraded to 10.34 of whatever that version is? what version did you upgrade from
[2014-08-01 14:32:43 -0400] jonlives: drewlander: we the server first to Chef 11, leaving all the clients at 10.x
[2014-08-01 14:32:46 -0400] someara: its the cookbooks themselves that will need to be modified to work with chef11 clients
[2014-08-01 14:32:52 -0400] jonlives: then tackled the client upgrade
[2014-08-01 14:33:01 -0400] drewlander: gotcha
[2014-08-01 14:33:10 -0400] drewlander: we have a lot of cookbooks
[2014-08-01 14:33:18 -0400] drewlander: and we know using chef 11 they break
[2014-08-01 14:33:26 -0400] jonlives: the API between chef server 10 and 11 is exactly the same, it's the actual server components that changed
[2014-08-01 14:33:33 -0400] jonlives: so you can still use 10.0 clients
[2014-08-01 14:34:34 -0400] jonlives: drewlander: my bad, we did it the other way round, clients first then server: http://codeascraft.com/2013/10/16/migrating-to-chef-11/
[2014-08-01 14:34:43 -0400] drewlander: ah that makes sense
[2014-08-01 14:34:50 -0400] jonlives: but to be fair, that was only cos we had time to fix the breaking changes in 11 client
[2014-08-01 14:34:59 -0400] drewlander: right now most of our cookbooks will break going to chef 11
[2014-08-01 14:35:01 -0400] jonlives: we *could* have done server first
[2014-08-01 14:35:06 -0400] drewlander: and we do not set our roadmap
[2014-08-01 14:35:14 -0400] jonlives: drewlander: we found most of the fixes fairly trivial, mainly the attribute stuff
[2014-08-01 14:35:21 -0400] someara: how many cookbooks are "a lot"
[2014-08-01 14:35:37 -0400] drewlander: 170
[2014-08-01 14:35:43 -0400] drewlander: and not all of them are ours
[2014-08-01 14:35:44 -0400] someara: thats not too bad
[2014-08-01 14:35:51 -0400] drewlander: other divions use this server too
[2014-08-01 14:35:55 -0400] drewlander: *divisions
[2014-08-01 14:36:05 -0400] someara: ah
[2014-08-01 14:36:06 -0400] drewlander: and their stuff breaks with 11 as well
[2014-08-01 14:36:18 -0400] jonlives: drewlander: I'd suggest setting up a 11.0 server and seeing how 10.0 clients behave with it
[2014-08-01 14:36:34 -0400] jonlives: because really it sounds like what you need here is the perf improvements from 11.0 server
[2014-08-01 14:36:45 -0400] drewlander: we do need that however
[2014-08-01 14:36:48 -0400] drewlander: before we failed over
[2014-08-01 14:36:51 -0400] drewlander: it was chugging along okay
[2014-08-01 14:36:55 -0400] drewlander: on the other identical box
[2014-08-01 14:37:09 -0400] drewlander: now they we failed over to the other server while we wait for a ram replacement
[2014-08-01 14:37:18 -0400] drewlander: (servers are identical, Dell R900)
[2014-08-01 14:37:25 -0400] drewlander: we are getting those client timeouts
[2014-08-01 14:37:31 -0400] jonlives: drewlander: how are your clients configured in terms of run interval and splay?
[2014-08-01 14:37:31 -0400] drewlander: and seeing the cpu randomly spoke to 100%
[2014-08-01 14:37:37 -0400] drewlander: they run every 30 minutes
[2014-08-01 14:37:49 -0400] jonlives: drewlander: any splay, or uniformly every 30 mins?
[2014-08-01 14:38:22 -0400] drewlander: no splay
[2014-08-01 14:38:35 -0400] drewlander: its 30 minutes from the time the client was installed, if that makes sense
[2014-08-01 14:38:45 -0400] jonlives: hmm
[2014-08-01 14:38:46 -0400] robbkidd: drewlander: Confirmed no hardware trouble on the failed-over-to server?
[2014-08-01 14:38:53 -0400] drewlander: they all are not hitting the box at the time time, some could be
[2014-08-01 14:39:09 -0400] drewlander: robbkidd: I have looked and from what we can tell the hardware is fine
[2014-08-01 14:39:15 -0400] jonlives: drewlander: it's possible that your clients are hitting the thundering herd problem with this server more than the other, tho that would be a little odd if it was fine on the old one.
[2014-08-01 14:39:15 -0400] robbkidd: M'kay
[2014-08-01 14:39:32 -0400] jonlives: drewlander: might be worth adding say a 5 min splay to clients to see if it makes any differnece?
[2014-08-01 14:39:37 -0400] jonlives: *difference
[2014-08-01 14:39:43 -0400] drewlander: jonlives: exactly. thats what we cannot figure out. if things were fine on the old, what is different on the new
[2014-08-01 14:40:09 -0400] jonlives: drewlander: what process is using the CPU when it spikes?
[2014-08-01 14:40:56 -0400] drewlander: merb chef-server
[2014-08-01 14:41:33 -0400] drewlander: i looked at maybe adding more merb processes and load balancing requests to them, but until I have exhausted finding out what is different on the B server, we do not want to go that route
[2014-08-01 14:41:43 -0400] drewlander: production environment, people hate change
[2014-08-01 14:42:01 -0400] jonlives: drewlander: it's a while back, but that's def something we ran into with chef server 10: http://blog.jonliv.es/2012/03/13/scaling-chef-with-more-api-workers/
[2014-08-01 14:42:30 -0400] drewlander: nice thats exatly what we were looking at doing if we cannot figure this out
[2014-08-01 14:42:54 -0400] jonlives: drewlander: it really depends how much time you want to spend on debugging this - it's a pretty easy fix ;)
[2014-08-01 14:43:01 -0400] drewlander: haha
[2014-08-01 14:43:32 -0400] drewlander: the things we need to make sure we do not do are: break the environment further
[2014-08-01 14:44:42 -0400] jonlives: drewlander: adding more merb workers is very unlikely to break anything - you can do it with a chef-server restart and then gradually point nodes at the new workers
[2014-08-01 14:45:02 -0400] jonlives: or do what we did and stick apache in front of it
[2014-08-01 14:47:06 -0400] drewlander: cool, thats the plan that I had if we get stuck
[2014-08-01 14:47:10 -0400] drewlander: im hoping that would help too
[2014-08-01 14:47:17 -0400] drewlander: this box can definitely handle more
[2014-08-01 14:47:27 -0400] drewlander: but what it comes down to is
[2014-08-01 14:47:38 -0400] jonlives: you may well find others had the same problem as me, which is that we haven't used chef server 10 in long enough that we can't remember most of the issues we ran into :p
[2014-08-01 14:48:50 -0400] drewlander: a worked fine, b doesnt, same config. Same data (drbd) b is preforming worse. box/network look fine. if i can go back and say "look everything is fine we cannot figure out why its differnt" then i can do the multiple workers
[2014-08-01 14:49:07 -0400] drewlander: haha true, but on the plus side its an easy rollback and it cannot make things too much worse :)
[2014-08-01 14:52:06 -0400] drewlander: jonlives: do you know if you can specify a starting port for the api workers?? we have too many servers to make a change of the client.rb viable (they are not currently managed by chef)
[2014-08-01 14:52:37 -0400] drewlander: nm looks like -p should do it
[2014-08-01 14:53:49 -0400] jonlives: drewlander: sorry, missed that
[2014-08-01 14:53:52 -0400] drewlander: thanks for the help, looks like there isnt much else we can do with chef. Thanks guys
[2014-08-01 14:53:53 -0400] jonlives: but you found the answer :p
[2014-08-01 14:53:57 -0400] jonlives: no worries!
[2014-08-01 14:53:57 -0400] drewlander: hahaha np
[2014-08-01 14:54:06 -0400] jonlives: drewlander: but def look at upgrading to chef server 11 ASAP ;)
[2014-08-01 14:54:12 -0400] drewlander: its definitely on our list
[2014-08-01 14:54:13 -0400] drewlander: at the very least
[2014-08-01 14:54:25 -0400] drewlander: we want chef 11 so we can stop having to pin to specific versions of the community cookbooks :)
[2014-08-01 14:54:44 -0400] jonlives: well even the server will give you massive perf improvements
[2014-08-01 14:56:00 -0400] drewlander: definitely
[2014-08-01 14:56:17 -0400] drewlander: thanks again for the help I am going to POC the multiple workers
[2014-08-01 14:57:32 -0400] jonlives: np!
[2014-08-01 15:05:36 -0400] cheeseplus: well this is odd - chef client exited 1 but did everything it was supposed to and there are no errors in the log itself until after the resources all updated
[2014-08-01 15:07:15 -0400] double_p: final node.set failed?
[2014-08-01 15:08:06 -0400] cheeseplus: investigating from the node itself now
[2014-08-01 15:08:59 -0400] cheeseplus: there is a 403
[2014-08-01 15:09:20 -0400] pcn: ohia chefs
[2014-08-01 15:09:24 -0400] pcn: ohai
[2014-08-01 15:09:39 -0400] pcn: Where does on get debian_before_squeeze for the mysql cookbook?
[2014-08-01 15:16:51 -0400] jonlives: pcn: I think that comes from https://github.com/sethvargo/chef-sugar
[2014-08-01 15:20:01 -0400] stormerider: will node[:chef_packages][:chef_version] inside a recipe tell me what version of chef-client is executing the recipe?
[2014-08-01 15:20:58 -0400] jonlives: stormerider: kind of - it'll tell you which one was loaded by ohai: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/chef.rb
[2014-08-01 15:21:14 -0400] jonlives: which is likely the same as the one running the recipes
[2014-08-01 15:21:55 -0400] stormerider: jonlives: is there a more specific attribute / method to be able to tell that i should use instead?
[2014-08-01 15:22:34 -0400] double_p: cheeseplus: is the converge running over 15min?
[2014-08-01 15:22:57 -0400] cheeseplus: double_p: nope, under 7 for the whole bootstrap
[2014-08-01 15:23:06 -0400] double_p: cheeseplus: had that previously. the auth-token expired in the meantime
[2014-08-01 15:23:07 -0400] cheeseplus: does it even when nothing is in the runlist
[2014-08-01 15:23:16 -0400] double_p: oh, that's weird
[2014-08-01 15:23:29 -0400] cheeseplus: for context this is a DO node that I've been nuking and re-bootstrapping
[2014-08-01 15:23:37 -0400] cheeseplus: so I assume that has something to do with it
[2014-08-01 15:24:05 -0400] double_p: well yeah, hunting down that 403 it is
[2014-08-01 15:24:39 -0400] jonlives: stormerider: that's the best I can think of - the only way to be more precise would be to set that attrib in the recipe. I mean, it'd be very unlikely for the chef process that ran ohai to not be the one running the recipes so I'd say you're OK.
[2014-08-01 15:24:45 -0400] cheeseplus: it just doesn't give me anything useful in debug :(
[2014-08-01 15:24:56 -0400] cheeseplus: it's a 200 OK followed by a 403 END
[2014-08-01 15:24:58 -0400] stormerider: jonlives: thanks.
[2014-08-01 15:25:13 -0400] jonlives: np!
[2014-08-01 15:25:24 -0400] jonlives: cheeseplus: tried -ldebug?
[2014-08-01 15:25:46 -0400] cheeseplus: jonlives: oh yea that is where I get the 200/403 next to each other
[2014-08-01 15:26:11 -0400] cheeseplus: I'm guessing it's a client/node that I forgot to delete
[2014-08-01 15:26:25 -0400] jonlives: cheeseplus: could be - can you gist the output?
[2014-08-01 15:27:04 -0400] cheeseplus: https://www.irccloud.com/pastebin/uULHIeUS
[2014-08-01 15:27:48 -0400] double_p: HUH?
[2014-08-01 15:27:49 -0400] bawt: HUH not found
[2014-08-01 15:28:27 -0400] double_p: can you check if there's an 403 further up the logfile? this output doesnt make sense (to me)
[2014-08-01 15:29:01 -0400] jonlives: cheeseplus: that's the entirety of the run?
[2014-08-01 15:29:44 -0400] cheeseplus: nah, just where I thought the error was but it was higher up as double_p notes
[2014-08-01 15:29:49 -0400] cheeseplus: https://www.irccloud.com/pastebin/sFWOXDpX
[2014-08-01 15:30:04 -0400] cheeseplus: that is the relevant chunk ^
[2014-08-01 15:30:41 -0400] double_p: ah, the joy of somewhat async logging between the levels
[2014-08-01 15:30:53 -0400] SmudgerDan: is there a way to force the bootstrapper to register the client (therefore creating a new client.pem file)
[2014-08-01 15:30:54 -0400] cheeseplus: (I don't have the node anymore as it's been nuked from orbit)
[2014-08-01 15:30:54 -0400] jonlives: cheeseplus: I'd guess client key / server key mismatch for that node
[2014-08-01 15:30:56 -0400] thom: i've seen that where the node's been deleted but the client hasn't
[2014-08-01 15:31:08 -0400] double_p: cheeseplus: try deleting node AND client
[2014-08-01 15:31:11 -0400] thom: and so the client has read access but not write access to the node
[2014-08-01 15:31:28 -0400] SmudgerDan: as, if there is a client.pem file already on the box the bootstrapper is running on it just uses that
[2014-08-01 15:31:34 -0400] cheeseplus: I had a client conflict earlier but that tends to complain very loudly
[2014-08-01 15:31:51 -0400] cheeseplus: or I should say very explicitly
[2014-08-01 15:42:56 -0400] heathsnow: SmudgerDan: maybe just knife node/client delete first then just rebootstrap
[2014-08-01 16:08:42 -0400] jcarapet: Is there an attribute in the nginx cookbook that anybody can think of that might cause a 403 forbidden error? Oddly specific I know, but trying to see if there  is a tuneable that might be messing up my wordpress implementation
[2014-08-01 16:12:41 -0400] jahkobi: How should I seperate service and buisness logic when it comes to templates?
[2014-08-01 16:13:21 -0400] jahkobi: My templates always seem to get messy with environement conditionals.
[2014-08-01 16:13:38 -0400] jahkobi: Especially things like my nginx.conf
[2014-08-01 16:20:30 -0400] androidbruce: anyone using IAM roles with their cloudformation stacks?
[2014-08-01 16:24:58 -0400] nefilim: androidbruce: yep
[2014-08-01 16:25:44 -0400] androidbruce: i am finding some lack of granularity with the roles
[2014-08-01 16:25:58 -0400] androidbruce: i.e. have a user able to create but not delete an instance based on tags
[2014-08-01 16:26:57 -0400] nefilim: havent used it for that specific case, only for ec2 instances accessing other services
[2014-08-01 16:27:06 -0400] androidbruce: i seew
[2014-08-01 16:27:23 -0400] androidbruce: we're trying to leverage it for granular control
[2014-08-01 16:27:37 -0400] nefilim: have you written your own policy?
[2014-08-01 16:27:48 -0400] nefilim: ie, spelling out the actions & resources
[2014-08-01 16:28:05 -0400] androidbruce: yes
[2014-08-01 16:32:25 -0400] nefilim: wondering if anyone here is doing bluegreen deployments (in aws with cloudformation fwiw) ?
[2014-08-01 16:41:19 -0400] jahkobi: If another cookbook, say VIPS, needs to add some settings to a users bashrc, should the VIPS cookbook insert the text?
[2014-08-01 16:47:35 -0400] ev0ldave: jahkobi: that is how i manage files that multiple cookbooks touch
[2014-08-01 16:47:43 -0400] ev0ldave: like nsswitch.conf
[2014-08-01 17:02:36 -0400] maniacal: anyone ever use 'knife ec2 server create' to just spin up a node without bootstrapping it.  I'm trying to use it to turn up nodes in a vpc but I'm not giving the nodes an external IP address.  knife is getting hung waiting for sshd but 1) it can't connect via ssh because it's in VPC and I haven't provided a SSH gateway, and 2) I didn't tell it to bootstrap so it really doesn't need to ssh to the node
[2014-08-01 17:05:56 -0400] maniacal: looks like it created the node ok.  just have to ctrl-c at the end of the knife command.  boo.  anyway, someone knows if this it's possible to leverage knife ec2 to create a node without bootstrapping it let me know
[2014-08-01 17:34:34 -0400] cheeseplus: jonlives double_p  so it looks like it was a node hanging around as expected
[2014-08-01 18:02:37 -0400] greenhat: Does chef-solo from the 11.12.8 gem work with ruby 2.1?
[2014-08-01 18:03:24 -0400] greenhat: I'm getting errors on 2.1, but not on 1.9. First time I've tried 2.1
[2014-08-01 18:06:45 -0400] zarry: Anyone around who has some experience with the rabbitmq cookbook?  specfically around clustering
[2014-08-01 18:19:25 -0400] heathsnow: I have a little zarry (w/my last company)
[2014-08-01 18:19:46 -0400] zarry: I can't see how the clustering ever works...
[2014-08-01 18:19:58 -0400] zarry: I am on the latest released version 3.2.2
[2014-08-01 18:20:06 -0400] hypnosb: CHEF IS FULL OF CHEFZ
[2014-08-01 18:20:21 -0400] heathsnow: I believe there's an ErlangCookie the cookbook needs to cluster
[2014-08-01 18:20:45 -0400] zarry: and it is notifying a service start for rabbitmq-server and at the same time an execute for rabbitmqctl
[2014-08-01 18:20:48 -0400] heathsnow: and it basically just does a bunch of rabbitmqctl commands
[2014-08-01 18:20:54 -0400] zarry: but the service is never up, before the rabbitmqctl commands
[2014-08-01 18:21:13 -0400] zarry: if I ssh to the box after vagrant run, I can run the rabbitmqctl commands just fine
[2014-08-01 18:21:16 -0400] greenhat: Running chef solo under ruby 1.9.3 works. Assuming ruby 2.1 just isn't supported.
[2014-08-01 18:21:26 -0400] someara: it should work
[2014-08-01 18:21:32 -0400] zarry: but during run it says unable to connect to node
[2014-08-01 18:21:52 -0400] zarry: it seems like a stupid timing thing that I am shocked no one has ran into yet
[2014-08-01 18:22:05 -0400] someara: we strongly encourage you to use the whole-bowl (omnibus) installers
[2014-08-01 18:22:28 -0400] someara: which ship ruby and all the requisite batteries
[2014-08-01 18:22:35 -0400] someara: they've been explicitly tested
[2014-08-01 18:24:13 -0400] cheeseplus: zarry: never be surprised as to the working state of cookbooks ;)
[2014-08-01 18:24:34 -0400] cheeseplus: unless there are tons of tests
[2014-08-01 18:24:41 -0400] zarry: I just would have assumed I would see more issues on the github regarding this
[2014-08-01 18:24:49 -0400] heathsnow_: sry, got disconn
[2014-08-01 18:25:03 -0400] zarry: noticing there "might" be a fix in the non released version
[2014-08-01 18:25:08 -0400] heathsnow_: so a second chef run and rabbitmq is working then?
[2014-08-01 18:25:13 -0400] cheeseplus: zarry: the number of times I've said the same thing...
[2014-08-01 18:25:23 -0400] zarry: exactly heathsnow_
[2014-08-01 18:25:45 -0400] zarry: yea, little frustrating just shouldn't take this many cycles @cheeseplus :x
[2014-08-01 18:25:49 -0400] greenhat: What does the omnibus installer do to the installed rubies on ubuntu?
[2014-08-01 18:26:11 -0400] cheeseplus: zarry: PRs are a lovely way to prevent other humans from encountering the same madness
[2014-08-01 18:26:11 -0400] heathsnow_: that does sound familiar
[2014-08-01 18:26:30 -0400] greenhat: I'm using the brightbox ppa to install ruby 2.1. Does the omnibus installer stomp on it?
[2014-08-01 18:26:39 -0400] zarry: cheeseplus: if there is a code change needed I will absolutely pr
[2014-08-01 18:26:41 -0400] cheeseplus: I mean I totally agree but the reason a lot are like that is cause folks look at it, fork and never push back upstream :sadpanda:
[2014-08-01 18:27:02 -0400] cheeseplus: also :guiltypanda:
[2014-08-01 18:27:23 -0400] zarry: just jumping out of the normal release cycle to grab unreleased cookbook so hoping I don't cause myself more trouble than good at this point
[2014-08-01 18:28:03 -0400] cheeseplus: it's hit an miss, a few of my berksfiles are pointed at feature branches currently with the hope things get merged
[2014-08-01 18:28:11 -0400] cheeseplus: mostly ubuntu 14.04 stuff
[2014-08-01 18:28:37 -0400] zarry: I just really can't see how this ever worked
[2014-08-01 18:28:38 -0400] zarry:  notifies :start, "service[#{node['rabbitmq']['service_name']}]", :immediately
[2014-08-01 18:28:38 -0400] zarry:     notifies :run, 'execute[reset-node]', :immediately
[2014-08-01 18:28:45 -0400] zarry: how would the service be up, before we reset-node?
[2014-08-01 18:29:12 -0400] zarry: giving the tip of the repo a try now... will update shortly
[2014-08-01 18:30:16 -0400] jahkobi: Can I reject a cookbook if the version already exists when uploading to my chef-server?
[2014-08-01 18:30:35 -0400] zarry: freeze your versions on the server upon upload
[2014-08-01 18:30:37 -0400] zarry: with --freeze
[2014-08-01 18:30:42 -0400] cheeseplus: ^
[2014-08-01 18:30:46 -0400] jahkobi: aww. right
[2014-08-01 18:30:54 -0400] jahkobi: thank you
[2014-08-01 18:31:12 -0400] zarry: yw
[2014-08-01 18:37:49 -0400] Noodles_: Can someone tell me if this is doable?  I have two cookbooks A and B.  Cookbook A manage a file ( ie /tmp/abc.txt ) and Cookbook B manage a service ( xyz ).  The two cookbooks has no relationship.  Without touch the two cookbooks, can I create a third cookbook to restart service xyz when abc.txt has changed?
[2014-08-01 18:43:37 -0400] someara: Noodles cookbook C could have a resource that subscribes to file['/tmp/abc.txt'] and then notifies service['xyz']
[2014-08-01 18:44:06 -0400] someara: but I'd probably re-evaluate why you're wanting to do this and re-structure your code
[2014-08-01 18:44:15 -0400] troyready: I see on twitter that vagrant-berkshelf v3 was recently released. Dumb question, but do I understand correctly that its functionality overlaps w/ Test Kitchen?
[2014-08-01 18:44:47 -0400] n1ko: troyready: nope, you dont
[2014-08-01 18:45:03 -0400] troyready: <tears>
[2014-08-01 18:45:05 -0400] someara: troyready vagrant-berkshelf was written as a necessicary evil before test-kitchen was released
[2014-08-01 18:45:45 -0400] someara: before test-kitchen 1.0, the best (only?) way to achieve the "cd cookbook ; <push button to test>" workflow was to use vagrant directly
[2014-08-01 18:46:01 -0400] someara: which require a vagrant plugin
[2014-08-01 18:46:23 -0400] someara: now that test-kitchen is out, it can drive vagrant directly
[2014-08-01 18:46:33 -0400] someara: and uploads cookbooks over ssh
[2014-08-01 18:46:36 -0400] merqlove: yeah
[2014-08-01 18:46:41 -0400] someara: so you vagrant plugin needed
[2014-08-01 18:46:48 -0400] merqlove: vb redundant
[2014-08-01 18:46:52 -0400] someara: er, "so no vagrant plugin needed"
[2014-08-01 18:47:18 -0400] someara: the authors of the vagrant-berkshelf plugin have all moved to using test-kitchen directly
[2014-08-01 18:47:27 -0400] merqlove: lol
[2014-08-01 18:47:29 -0400] troyready: Ok, awesome -- I realize you've had to write about this a bunch and appreciate you explaining it again for me :)
[2014-08-01 18:47:44 -0400] merqlove: so why they support vb?)
[2014-08-01 18:47:45 -0400] someara: np
[2014-08-01 18:47:46 -0400] troyready: This just confused me: https://twitter.com/resetexistence/status/494296927047917568
[2014-08-01 18:48:04 -0400] someara: its being reluctantly maintained because people complained about it being deprecated
[2014-08-01 18:48:19 -0400] merqlove: aah, right
[2014-08-01 18:48:47 -0400] someara: the problem is every time vagrant releases a patch release the plugin explodes because its using undocumented/unstabled APIs
[2014-08-01 18:48:58 -0400] someara: aka ugly fucking hacks to vagrant
[2014-08-01 18:49:02 -0400] troyready: Reluctantly maintained is such a funny phrase
[2014-08-01 18:49:19 -0400] someara: why can't I type today
[2014-08-01 18:49:33 -0400] Noodles_: someara, I tried to create a resource ( tried file and directory resource ) but it didn't work , for example if abc.txt has changed and if the file or directory resource on C exist, it will not notified service xyz
[2014-08-01 18:49:38 -0400] troyready: I'm picturing swearing and head shaking happening endless during development
[2014-08-01 18:50:14 -0400] someara: Noodles the resources from all recipes are compiled into a giant resource collection
[2014-08-01 18:50:25 -0400] someara: so the resources coming from cookbook A or cookbook B doesn't matter
[2014-08-01 18:50:43 -0400] someara: its all in the same bowl during the chef-client run
[2014-08-01 18:56:54 -0400] cocotton: Does anyone know how to manage an interactive package installation from a recipe? I tried looking for a ressource that would allow me to do that, yet I've been unsuccesful
[2014-08-01 19:02:53 -0400] troyready: cocotton, the general answer to that is to generate the seeded answers file for the package install
[2014-08-01 19:03:05 -0400] heathsnow_: cocotton: the package resource allows you to pass options I think
[2014-08-01 19:03:30 -0400] cocotton: @troyready @heathsnow_ I'll take a look at this
[2014-08-01 19:04:53 -0400] zarry: heathsnow and cheeseplus: thanks for the help, seems it was resolved in the tip of master. that version is working properly.
[2014-08-01 19:05:14 -0400] zarry: I updated a ticket asking them for an official release to correct issue
[2014-08-01 19:05:16 -0400] cocotton: You guys were indeed right, yet "Use of a response_file is only supported on Debian and Ubuntu at this time." I'll see what happens on a CentOS
[2014-08-01 19:09:27 -0400] dkinzer: I'm getting this error after omnibus automatically updated "cannot load such file -- chef/provider/package/freebsd" no changes to my recipes.
[2014-08-01 19:23:27 -0400] jmreicha: Can somebody fill me in on the best way to fix/test a public cookbook locally?
[2014-08-01 19:24:04 -0400] jmreicha: Just pull it down from github and point berkshelf to it or something?
[2014-08-01 19:24:23 -0400] someara: pretty much
[2014-08-01 19:24:36 -0400] someara: git clone whatever ; cd whatever ; kitchen test
[2014-08-01 19:24:47 -0400] someara: assuming that the cookbook has a test harness setup
[2014-08-01 19:25:03 -0400] someara: which it probably doesn't =)
[2014-08-01 19:25:23 -0400] cheeseplus: jmreicha: if it doesn't have test-kitchen support, add it
[2014-08-01 19:25:39 -0400] jmreicha: Looks like it has test kichen support
[2014-08-01 19:26:28 -0400] jmreicha: Thanks, I'll see if I can get it working
[2014-08-01 19:26:35 -0400] someara: good luck
[2014-08-01 19:26:41 -0400] cheeseplus: jmreicha: there is a #kitchenci channel as well for tk specific stuff
[2014-08-01 19:27:00 -0400] jmreicha: @cheeseplus: Thanks
[2014-08-01 19:32:56 -0400] jmreicha: How will I know kitchen is using the local cookbook?
[2014-08-01 19:33:57 -0400] jordane: jmreicha: the line 'metadata' in the Berksfile means use the local metadata.rb file for and the cb it is associated with.
[2014-08-01 19:35:53 -0400] jmreicha: jordane: Ah nice.  I tested by changing up the cookbook I was calling and it looks like it worked!
[2014-08-01 19:36:06 -0400] jmreicha: Not as bad as I was thinking it would be to do this
[2014-08-01 19:38:11 -0400] dkinzer: Now its working again (weird).
[2014-08-01 19:38:37 -0400] testtest: when i try to create a cookbook using knife cookbook create cbkname, i get TypeError can't convert nil into string
[2014-08-01 19:38:47 -0400] testtest: anybody seen this?
[2014-08-01 19:39:32 -0400] jordane: testtest: pastebin the error? it's probably a bad setting in knife.rb
[2014-08-01 19:39:40 -0400] jordane: you probably should pastebin your knife.rb too
[2014-08-01 19:41:45 -0400] apollonovich: I'm doing a python3/flask deployment on ec2+ubuntu.  During the run of chef-client, where it attempts to pip install my requirements.txt file, httppretty dumps out with a unicode error that appears to be related to terminal encoding -- if I then re-run the command from an interactive shell, it works fine.
[2014-08-01 19:41:58 -0400] apollonovich: Is there something I can set to force chef-client to present a utf-8 terminal to the processes it spawns?
[2014-08-01 19:42:26 -0400] testtest: log_level                :info
[2014-08-01 19:42:27 -0400] testtest: log_location             STDOUT
[2014-08-01 19:42:27 -0400] testtest: node_name                'myname'
[2014-08-01 19:42:28 -0400] testtest: client_key               '~/.chef/myname.pem'
[2014-08-01 19:42:28 -0400] testtest: validation_client_name   'dev-chef-validator'
[2014-08-01 19:42:29 -0400] testtest: validation_key           '~/.chef/dev-chef-validator.pem'
[2014-08-01 19:42:29 -0400] testtest: chef_server_url          'https://<fqdn>:443'
[2014-08-01 19:42:29 -0400] testtest: syntax_check_cache_path  '~/.chef/syntax_check_cache'
[2014-08-01 19:42:30 -0400] testtest: knife[:vault_mode] = 'client'
[2014-08-01 19:54:48 -0400] jmreicha: woah, new version of chef-client?
[2014-08-01 19:55:27 -0400] spox: looks like this: https://github.com/opscode/chef/commit/c944f89ee78436fdca3c3f2d051f93a9334783e9 is causing breakage of things like apache cookbook due to freebsd cookbook usage
[2014-08-01 19:58:11 -0400] dkinzer: Figured it out! I was depending on a branch for apache2 cookbook that just got pulled in.
[2014-08-01 20:02:26 -0400] hhoover: spox: seeing the same. :-(
[2014-08-01 20:14:56 -0400] dkinzer: Sadly I didn't fork that repo and the maintainer deleted the branch. I've asked him if he would undeleted and give me a chance to for it.
