[2014-06-20 00:12:13 -0400] Shred00: chef is really neat in that it only replaces a config file if there is a change to it.
[2014-06-20 00:12:14 -0400] Shred00: but some config changes can't be expressed in a config-file but rather are a result of running a command.
[2014-06-20 00:12:14 -0400] Shred00: for such changes, do i really want to run the command to make that config object reflect the objects state in my chef configuration for every object on every chef-run?
[2014-06-20 00:12:15 -0400] Shred00: that seems like the equivalent of not being neat about replacing config files only if they are changed and just replacing all of them one every run, even if there was no difference.
[2014-06-20 00:12:22 -0400] Shred00: thoughts or comments?
[2014-06-20 00:13:21 -0400] coderanger: Shred00: The optimal case is that command has a dry-run mode that you use to tell if it would change anything
[2014-06-20 00:13:43 -0400] coderanger: a second option is to store the state both in Chef and in the external system and use that for (fast) idempotence checks
[2014-06-20 00:13:49 -0400] coderanger: but if they get out of sync, badness
[2014-06-20 00:15:05 -0400] Shred00: coderanger: not sure what you mean about storing the state of the external system.
[2014-06-20 00:15:34 -0400] coderanger: Shred00: So you have this abstract idea of "state" right? that represents the current status of something
[2014-06-20 00:16:01 -0400] coderanger: Shred00: For a template resource thats super easy, the state is just teh current contents of the file, if they don't match the desired contents then you update the state
[2014-06-20 00:16:26 -0400] coderanger: but as you pointed out, sometimes the way you access and/or update the state is through some narrower tool, like a CLI
[2014-06-20 00:16:31 -0400] coderanger: (or worse, a web UI)
[2014-06-20 00:17:11 -0400] Shred00: imagine for example, records (let use users since they are easy to understand) in a mysql database.  i could simply re-add (or add initially and modify subsequently) every user to the database on every run but that seems to go against the established MO of only making changes when there are differences.
[2014-06-20 00:18:05 -0400] coderanger: Indeed, that would be "not idempotent"
[2014-06-20 00:18:36 -0400] coderanger: So for idempotence you need two things
[2014-06-20 00:18:43 -0400] coderanger: the current state and the target state
[2014-06-20 00:18:49 -0400] Shred00: indeed!
[2014-06-20 00:18:58 -0400] coderanger: well three I guess, you need to know how to update the state when they don't match
[2014-06-20 00:19:02 -0400] coderanger: Chef does that via resources
[2014-06-20 00:19:15 -0400] coderanger: providers handle the update logic, resources model the current and target state
[2014-06-20 00:19:48 -0400] coderanger: So you can make a resource that each time reads the current state from the MySQL DB, compares that to the target state, and then updates MySQL if needed
[2014-06-20 00:21:20 -0400] Shred00: coderanger: yeah.  funny enough, in my users-in-mysql example, it was not lost on me that there is a "user" resource in chef.  so for these type of objects that require commands to update them, i end up writing resource handlers for them?  to do it all properly that is.
[2014-06-20 00:23:52 -0400] troyready: Shred00, Because my code-writing skills are poor, I've dealt with similar things like this: https://github.com/biola/chef-cookbooks/blob/master/rhn/recipes/optionalchannel.rb#L21
[2014-06-20 00:24:45 -0400] coderanger: Shred00: Yahr, that would be the Right Way
[2014-06-20 00:25:14 -0400] Shred00: i had imagined a generic "command-to-bring-into-state" type of resource where the current state is represented by the command and arguments that were most recently used to bring an object into the current state and then the task of deciding if the object needed updating was to compare the command used to bring it into the current state with the command that was most recently used to bring it into it's previous current state.
[2014-06-20 00:25:18 -0400] coderanger: Shred00: You can do it a bit more simply via the not_if/only_if guards on resources which don't grok state per se, but let you skip a resource based on a condition
[2014-06-20 00:26:56 -0400] Shred00: troyready: that's actually a good example.  what happens if you modify node['rhn']['password'] in your configuration?
[2014-06-20 00:28:11 -0400] troyready: Well, for that purpose it would be transparent -- the next time the chef-client run ocurred, the 'guard' execution would fire with the new password, find that the state is already what it should be, and skip the rest of it
[2014-06-20 00:29:03 -0400] troyready: In many other situations, it can't be handled so simply, so you have to plan how you're going to track the data, etc
[2014-06-20 00:31:22 -0400] Shred00: troyready: from my reading of your recipe, it will not update the channel configuration with the new password because rhn-channel -l will list is already there, albeit with an old password.  am i wrong?
[2014-06-20 00:32:21 -0400] troyready: Ha, sorry, I didn't read it through again before my last comments and slightly misspoke
[2014-06-20 00:34:11 -0400] Shred00: troyready: so yeah.  changing the password and not having the object updated is an example of _exactly_ the problem i'm trying to resolve, in the non-brute-force manner of just updating everything every time.
[2014-06-20 00:34:48 -0400] troyready: Every chef-client run, the command "rhn-channel -l" is executed (no password involved). If that command's output doesn't indicate that the computer is subscribed to the optional repo, it will execute the channel update command using the node's current password
[2014-06-20 00:35:37 -0400] Shred00: troyready: right.  and if you run it once with a given password attribute, it adds it but if you change the password attribute and run it again, it does not update it with the new password, right?
[2014-06-20 00:37:06 -0400] troyready: Well, it's not totally applicable in this case because it's not updating the password. The point of the command is to update the remote account
[2014-06-20 00:37:49 -0400] troyready: i.e., our examples aren't totally identical. In mine, it doesn't matter what the password was, as long as it's current when the channel is to be added
[2014-06-20 00:37:52 -0400] Shred00: but it is applicable if for some reason the account password gets changed
[2014-06-20 00:38:18 -0400] troyready: No, because the computer will never (practically speaking) have the "channel" removed from it
[2014-06-20 00:39:23 -0400] troyready: Even if it did, I would update my role or environment with the new password, and if the server lost the channel (say some drunk admin logged into the web gui and removed it), then the command on line 24 would execute with the new password from the node/role
[2014-06-20 00:39:29 -0400] Shred00: troyready: ahhh.  i see what you are saying.  i was working on the assumption that the password was something that is stored with the channel and used each time you access the channel.  it is only used to add the channel then?
[2014-06-20 00:39:37 -0400] troyready: Right, exactly
[2014-06-20 00:39:47 -0400] troyready: Makes this example a little too simple
[2014-06-20 00:39:53 -0400] troyready: And doesn't totally get at what you need
[2014-06-20 00:40:13 -0400] Shred00: sure.  so imagine however that the password is something that is stored with the channel.  that solution does not handle password changes.  that's the problem space.
[2014-06-20 00:40:49 -0400] Shred00: but your solution is not unlike what i am currently doing.  i just want to do better and handle attribute changes, but just not brute-forcefully.
[2014-06-20 00:42:38 -0400] troyready: Off the top of my head, I would have my guards (in ruby) check to see if it needs to be updated (calling the api, executing the command, etc)
[2014-06-20 00:43:09 -0400] Shred00: troyready: right.  you could end up writing a lot of guard code though.
[2014-06-20 00:43:14 -0400] troyready: Yeah
[2014-06-20 00:43:40 -0400] troyready: Even more lame though when you then need to track state information between runs using something like attributes (see opscode's ufw cookbook for an example of that)
[2014-06-20 00:44:20 -0400] troyready: Note: i call it lame in a general sense, but have copied that very model elsewhere. No disrespect intended :)
[2014-06-20 00:46:49 -0400] Shred00: troyready: no offense taken.  i agree with the lameness label.
[2014-06-20 04:51:11 -0400] fclausen: hello all - is there a way I can use ruby variables from an included recipe?
[2014-06-20 04:53:31 -0400] coderanger: fclausen: No, you would have to set them somewhere global like node attrs or the run_state
[2014-06-20 04:55:53 -0400] fclausen: ah right, thanks coderanger. I think I can shuffle some code around to avoid the problem anyway.
[2014-06-20 06:56:09 -0400] braeuer: hi everyone. anyone in here creating chef resource dynamically during the run? I want to create chef resource during the run (yum_package). The yum_package resources work, however the notifiies attribute seems to be ignored. Anyone?
[2014-06-20 08:13:16 -0400] chandrasekhar: anyone can give me en example of databag, role ,env in one recipe ?
[2014-06-20 08:14:28 -0400] chandrasekhar: i want to use all these in one recipe. please answer me with an example
[2014-06-20 08:43:01 -0400] foobarbazbazbaz: hello, how do I access an attribute set in an attribute file?  in attributes/default.rb I have "default['foo']['bar']" and in recipes/default.rb I have "Chef::Log.info node['foo']['bar]" but I get "undefined method `[]' for nil:NilClass" on that line.  I'm able to use "default['foo']['bar']['baz'] = node['foo']['bar']" in my attributes/default.rb... so what gives?
[2014-06-20 08:49:45 -0400] foobarbazbazbaz: ok, this is dumb, in the apache cookbook it uses "package node['apache']['perl_pkg']"
[2014-06-20 08:49:57 -0400] foobarbazbazbaz: so I should be able to use "node['foo']['bar']"
[2014-06-20 08:50:00 -0400] foobarbazbazbaz: why can't I?
[2014-06-20 08:56:28 -0400] helllen: helllo
[2014-06-20 09:05:26 -0400] helllen: I have many commands delayed on my recipie.
[2014-06-20 09:05:37 -0400] helllen: when a file is changed I notify with an specific command
[2014-06-20 09:07:24 -0400] helllen: I would like to execute this command in case an specific command is not already delayed
[2014-06-20 09:07:36 -0400] helllen: how could I control delayed command exist?
[2014-06-20 09:21:55 -0400] foobarbazbazbaz: ok, what does the error "undefined method `[]' for nil:NilClass" mean?
[2014-06-20 09:24:48 -0400] jhsubscribe: foobarbazbazbaz... in my experience, it generally means I'm trying to do something with an attribute that's not defined.
[2014-06-20 09:26:14 -0400] foobarbazbazbaz: jhsubscribe: ok, thanks.  That's what I was thinking, but I'm at a loss to explain it... I set my attribute in my attributes/default.rb as "default['foo']['bar']" but I get this error when I try to access the attribute in my recipes/default.rb with "node['foo']['bar']",
[2014-06-20 09:26:47 -0400] jhsubscribe: I found pp node.debug_value helpful when trying to work out what attributes were being set to.. http://www.getchef.com/blog/2013/02/05/chef-11-in-depth-attributes-changes/
[2014-06-20 09:28:18 -0400] foobarbazbazbaz: but my attribute is being set to "undefined method `[]' for nil:NilClass".  How does one access an attribute?
[2014-06-20 09:28:48 -0400] foobarbazbazbaz: should I be calling "node[:foo][:bar]"
[2014-06-20 09:29:09 -0400] foobarbazbazbaz: what happens if my key has a space in the name? (I guess I don't really care about that right now)
[2014-06-20 09:32:23 -0400] foobarbazbazbaz: "node[:foo][:bar]" doesn't help.
[2014-06-20 09:34:53 -0400] jhsubscribe: foobarbazbazbaz: might be handy if you share the content of the attribute and recipe files somewhere?
[2014-06-20 09:35:26 -0400] jhsubscribe: strings vs symbols (ie :foo vs 'foo') is worth reading up and understanding if you're going to be with chef for a while
[2014-06-20 09:37:09 -0400] jhsubscribe: caveat - I'm a newbie to chef / ruby etc .
[2014-06-20 09:41:13 -0400] chandrasekhar: anyone has any idea about chef dk ?
[2014-06-20 09:43:57 -0400] foobarbazbazbaz: jhsubscribe: http://paste.scsys.co.uk/398107
[2014-06-20 09:46:22 -0400] foobarbazbazbaz: whops, copy paste fail, here's the one with the output
[2014-06-20 09:47:59 -0400] foobarbazbazbaz: http://paste.scsys.co.uk/398112
[2014-06-20 09:58:29 -0400] jhsubscribe: I use brackets on my chef::logs...   Chef::Log.warn("test log #{node['foo']['bar']} ") ?   Maybe try that with just text first then add attribute?
[2014-06-20 09:59:13 -0400] foobarbazbazbaz: I mean my Chef::Log.info "does this work"
[2014-06-20 09:59:26 -0400] foobarbazbazbaz: prints "Chef log [info]: Does this work"
[2014-06-20 09:59:27 -0400] chandrasekhar: anyone has idea baout chef spec ?
[2014-06-20 10:01:09 -0400] soupdiver: Example in the docs say: "knife search node 'roles:*'" for finding nodes by assigned role(s). But this does not work for me. I have to use: 'knife search node 'role:*'' - role and not roleS. Is this an error in the docs?
[2014-06-20 10:03:50 -0400] workmad3: foobarbazbazbaz: start by printing out 'node[:foo]' in your logs, see if that reveals anything
[2014-06-20 10:40:34 -0400] foobarbazbazbaz: workmad3: I tried a "Chef::Log.info "#{node['foo']}"" and it doesn't print anything.  I tried a  "pp node.debug_value(:foo)" and I got: http://paste.scsys.co.uk/398133
[2014-06-20 10:43:03 -0400] workmad3: foobarbazbazbaz: ok, so for some reason your node[:foo] value isn't being set...
[2014-06-20 11:13:16 -0400] teorias: hey all! Guys i have the issue with berkshelf " SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed (Faraday::SSLError)"
[2014-06-20 11:13:32 -0400] teorias: I google it and try every possible solution, but didn't work
[2014-06-20 11:13:45 -0400] teorias: do you know if this is a chef problem related, or its something else?
[2014-06-20 11:23:15 -0400] workmad3: teorias: is that with a new self-hosted chef server?
[2014-06-20 11:26:10 -0400] teorias: yes
[2014-06-20 11:26:15 -0400] teorias: chef10 self hosted
[2014-06-20 11:27:31 -0400] workmad3: teorias: right... then you're getting that error because the SSL certificate for the server is self-signed and you've got berkshelf set up to verify SSL certificates (which it manage on a self-signed cert)... there's a berkshelf option to turn off verification, or you could see about getting a better cert for your server
[2014-06-20 11:28:00 -0400] Cope: teorias: would you like a copy of windows xp to go with your chef 10 server?
[2014-06-20 11:28:08 -0400] workmad3: teorias: or you could install your chef server SSL cert into your local certificate repo
[2014-06-20 11:28:23 -0400] Cope: teorias: sorry, only kidding :)
[2014-06-20 11:29:05 -0400] teorias: hahah thanks Cope, you are right :) we are starting to migrate to chef 11 ;)
[2014-06-20 11:29:17 -0400] teorias: but i guess the problem is not the version of chef :)
[2014-06-20 11:29:26 -0400] Cope: very unlikely :)
[2014-06-20 11:29:46 -0400] teorias: (if i tell you that in some projects we still use chef 9 ... you will kick me from this channel)
[2014-06-20 11:29:58 -0400] teorias: well ... big corporations :)
[2014-06-20 11:30:01 -0400] Cope: nothing would surprise me :)
[2014-06-20 11:30:02 -0400] Cope: indeed
[2014-06-20 11:30:22 -0400] teorias: workmad3 I did that
[2014-06-20 11:30:28 -0400] Cope: i turned off some rhel3 mahines not long ago
[2014-06-20 11:30:36 -0400] teorias: I edited berkshelf/config.jon
[2014-06-20 11:30:49 -0400] teorias: {   "ssl": {     "verify": false   } }
[2014-06-20 11:30:55 -0400] teorias: but didn't work
[2014-06-20 11:34:36 -0400] workmad3: teorias: hmm... then it didn't take... maybe ask in #berkshelf in case there's a different way of doing it?
[2014-06-20 11:35:12 -0400] workmad3: teorias: although it would be better if you did a solution that didn't open your berkshelf uploads to MITM attacks ;)
[2014-06-20 11:37:11 -0400] teorias: :) thanks
[2014-06-20 11:39:30 -0400] bmalee: there seem to be a number of 404s on learnchef.opscode.com, e.g. https://learnchef.opscode.com/quickstart/workstation-setup (linked from manage.opscode.com) and https://learnchef.opscode.com/set-up-your-chef-environment (linked from the learnchef front page).
[2014-06-20 11:41:35 -0400] whiteadam: bmalee: You think this is Obamacare related?
[2014-06-20 11:44:23 -0400] whiteadam: bmalee: I tweeted em about it. Let's see if social media really works.
[2014-06-20 12:36:14 -0400] bttf: morning
[2014-06-20 12:37:20 -0400] bttf: will kitchen converge run my tests ?
[2014-06-20 12:37:52 -0400] whiteadam: bttf: I think so
[2014-06-20 12:39:42 -0400] bttf: i'm trying right now whiteadam
[2014-06-20 12:39:56 -0400] whiteadam: bttf: heh, I was doing the same to make sure
[2014-06-20 12:40:25 -0400] bttf: it didn't run mine
[2014-06-20 12:42:02 -0400] whiteadam: bttf: I think it's kitchen test that runs everything... I want to say that running kitchen converge is the same as running vagrant provision
[2014-06-20 12:43:20 -0400] bttf: well i know kitchen converge runs the convergence step
[2014-06-20 12:45:16 -0400] someara: moin
[2014-06-20 12:48:17 -0400] whiteadam: sup
[2014-06-20 12:49:19 -0400] whiteadam: someara: I sent a tweet earlier, but I figure you could contact the proper person. Some of the links on learnchef.com are broken.
[2014-06-20 12:49:26 -0400] whiteadam: Like the main links when the page loads.
[2014-06-20 12:50:15 -0400] _pingu: I wrote a custom chef-handler and executed it as report handler. the handler does some serverspec tests.  I have the tests return value. in case of != 0 I want to set the return value of the chef-solo run. so that echo $? return the set value. but how can I do that?
[2014-06-20 12:50:25 -0400] someara: hrm... not seeing anything... any particular URLs?
[2014-06-20 12:50:32 -0400] someara: maybe ops already resolved it
[2014-06-20 12:50:50 -0400] someara: I know they have monitors on it
[2014-06-20 12:55:21 -0400] _pingu: hmm, maybe I can change failed? in the run_status object
[2014-06-20 12:59:47 -0400] whiteadam: someara: try https://learnchef.opscode.com/ and click "set up your Chef environment"
[2014-06-20 13:00:03 -0400] whiteadam: someara: or the link below it
[2014-06-20 13:03:11 -0400] someara: I'll let the appropriate people know
[2014-06-20 13:03:19 -0400] whiteadam: someara: you're the man now dog
[2014-06-20 13:03:37 -0400] someara: they're aware of it
[2014-06-20 13:06:07 -0400] _pingu: How can I change the return value of a chef-solo run? Wrote a custom chef-handler, where I need that, in case of failing tests.
[2014-06-20 13:27:02 -0400] _pingu: no one?
[2014-06-20 13:27:17 -0400] whiteadam: not me
[2014-06-20 13:31:41 -0400] _pingu: ok, found out, how I can set and exception of the run_status, what changes its failed? and success like expected. but the return value of the whole chef-solo run still is 0
[2014-06-20 13:35:48 -0400] _pingu: guess all chef senior developers are in vacation. :-)
[2014-06-20 13:39:37 -0400] jperry: _pingu: can you rephase your question?
[2014-06-20 13:39:48 -0400] jperry: are you trying to cause your chef run to fail and return an exit code of 1
[2014-06-20 13:49:36 -0400] laurent\: https://tickets.opscode.com/browse/CHEF-4018 any idea ?
[2014-06-20 14:15:44 -0400] anthonyacquanita: so what do you do when berkshelf doesn't have a version you need?  simple_iptables is at 0.6.4 and berks.api only has 0.6.0
[2014-06-20 14:16:33 -0400] anthonyacquanita: that came off really lazy and whiny but hey, the thing does everything for you right?
[2014-06-20 14:16:56 -0400] gleam: you could manually set the path in your berksfile
[2014-06-20 14:17:36 -0400] anthonyacquanita: you mean download it and type?!  gasp!
[2014-06-20 14:17:48 -0400] anthonyacquanita: I guess  ;-)
[2014-06-20 14:17:49 -0400] tier: manually point to it and go haggle the maintainer to update community.
[2014-06-20 14:18:13 -0400] anthonyacquanita: oh yeah, point to it via git
[2014-06-20 14:18:14 -0400] gleam: cookbook 'simple_iptables', github: 'rtkwlf/cookbook-simple-iptables', tag: '0.6.4'
[2014-06-20 14:18:18 -0400] gleam: in your berksfile
[2014-06-20 14:18:21 -0400] gleam: done
[2014-06-20 14:18:33 -0400] anthonyacquanita: forgot about that, thanks
[2014-06-20 14:22:26 -0400] workmad3: anthonyacquanita: run your own berkshelf-api which indexes the stuff you need? :)
[2014-06-20 14:22:51 -0400] Sujji: Hi Guys, I am looking for some help on enabling oracle module for PHP via Chef. Never used IRC channels before. Can I ask my question here?
[2014-06-20 14:22:58 -0400] workmad3: Sujji: sure
[2014-06-20 14:23:35 -0400] anthonyacquanita: workmad3: it's on the list.... at the bottom, but on the list.
[2014-06-20 14:25:48 -0400] Sujji: workmad3: thank you! my question is, I have apache2 cookbook and I am enabling PHP5 module in that. My php pages are working fine, but I am unable to find on how to enable oracle extension in php.ini
[2014-06-20 14:25:58 -0400] workmad3: anthonyacquanita: I just run it locally when I need to :)
[2014-06-20 14:26:05 -0400] workmad3: anthonyacquanita: one of these days, I'll set it up on my chef server
[2014-06-20 14:29:06 -0400] Sujji: I can see mysql recipes in php cookbook, but there is none for oracle
[2014-06-20 14:29:56 -0400] workmad3: Sujji: hmm... I don't use PHP or oracle... it might be you'll need to modify a cookbook though
[2014-06-20 14:30:54 -0400] fish__: yo
[2014-06-20 14:34:32 -0400] Sujji: workmad3. np.
[2014-06-20 14:55:33 -0400] _pingu: jperry: are you still there? Yes, that is what I'am searchin for.
[2014-06-20 14:56:17 -0400] jperry: _pingu: sorry one sec
[2014-06-20 14:56:21 -0400] jperry: had something to take care of
[2014-06-20 14:56:55 -0400] _pingu: jperry: I'am looking forward to see the solution
[2014-06-20 15:51:34 -0400] _pingu: jperry: I'am away for 1-2 hours. I let my pc run. Maybe you'l write in betweeen.
[2014-06-20 16:02:39 -0400] anthonyacquanita: any interesting dns solutions with chef... I was using powerdns and using sql to add records... don't want to do that anymore
[2014-06-20 16:03:23 -0400] double_p: anthonyacquanita: why not? works as a charme here (but feeding it from databags
[2014-06-20 16:04:44 -0400] anthonyacquanita: I was hoping for something simpler... chef search to /etc/hosts and serve with dnsMasq or something like that
[2014-06-20 16:05:06 -0400] anthonyacquanita: I guess you can chef search, export to data_bag then import
[2014-06-20 16:05:10 -0400] double_p: ohum.. we populate /etc/hosts with chef, too :]
[2014-06-20 16:05:47 -0400] double_p: only thing is that all the databag->pdns-sql takes quite a while to converge. but otherwise i'm happy with it
[2014-06-20 16:05:48 -0400] anthonyacquanita: that's where I started going especially with more ec2 vpn work
[2014-06-20 16:06:26 -0400] anthonyacquanita: yup, any tickets open on zookeeper like watchers on chef server???
[2014-06-20 16:07:13 -0400] anthonyacquanita: maybe powerdns reading from /etc/hosts, with /etc/hosts populated from chef search
[2014-06-20 16:08:02 -0400] double_p: uhm
[2014-06-20 16:08:30 -0400] gleam: if you don't want to do sql you can still do pdns, just write a cdb-format file and compile it and use powerdns's tinydns backend
[2014-06-20 16:08:50 -0400] gleam: you can use search/data bags/whatever to populate the cdb file
[2014-06-20 16:09:35 -0400] double_p: works with the SQL just aswell via some not long/complex erb templates
[2014-06-20 16:09:54 -0400] anthonyacquanita: lol, reading my mind?  avoiding mysql and replication is a major reason why I'm looking for something else
[2014-06-20 16:10:02 -0400] gleam: are you talking with sqlite? i think maybe he doesn't want a remote sql server
[2014-06-20 16:10:09 -0400] gleam: sqlite would work just as well
[2014-06-20 16:10:16 -0400] double_p: yeah, sqlite here
[2014-06-20 16:10:30 -0400] gleam: you could also setup some supermasters and have every node be a slave to it
[2014-06-20 16:10:41 -0400] gleam: then you just have to maintain records on the supermaster
[2014-06-20 16:10:48 -0400] double_p: anthonyacquanita: i can pastie you the whole shebang unless you ask for support of it :)
[2014-06-20 16:11:27 -0400] anthonyacquanita: ha ha... what's this, what's that?  how do you ?  I think I can handle it
[2014-06-20 16:11:41 -0400] double_p: ok, hang on
[2014-06-20 16:12:04 -0400] gleam: the opscode pdns cookbook also has lwrps for interacting with pdns via sqlite
[2014-06-20 16:12:06 -0400] anthonyacquanita: much appreciated
[2014-06-20 16:16:05 -0400] double_p: anthonyacquanita: http://pastie.org/private/zagecaswr9fduocbko5rw
[2014-06-20 16:16:49 -0400] double_p: wow, that json paste went one-lined. but well... :]
[2014-06-20 16:17:55 -0400] anthonyacquanita: looking now.... thanks again
[2014-06-20 16:19:38 -0400] double_p: i mean, it's not THAT complicated. the most aweful thing is to keep the json structure "correct" :}
[2014-06-20 16:21:50 -0400] medya: what are the main differences of chef and puppet ?
[2014-06-20 16:22:22 -0400] icarus: medya: they are pretty equivalent
[2014-06-20 16:22:32 -0400] icarus: chef has more cookbooks i would say, and its server structure is better
[2014-06-20 16:22:35 -0400] anthonyacquanita: double_p:  how do you maintain the data_bag ?
[2014-06-20 16:22:51 -0400] medya: @icarus how is the server structure is better?
[2014-06-20 16:22:53 -0400] anthonyacquanita: hand edit or you wrote something else?
[2014-06-20 16:23:53 -0400] double_p: anthonyacquanita: knife data bag edit dns_records example_de ... :}
[2014-06-20 16:24:03 -0400] double_p: we dont change the DNS *that* often
[2014-06-20 16:24:29 -0400] double_p: otoh if a new host get's added, that's handled via recipe to add A/PTR records
[2014-06-20 16:26:25 -0400] double_p: so i only need to put hands on if we have to change an external address
[2014-06-20 16:37:51 -0400] leo___: I got very odd problem while setting up chef client
[2014-06-20 16:38:12 -0400] maniacal: can I do lazy evaluation for ruby variables within a ruby_block?
[2014-06-20 16:38:42 -0400] leo___: 'knife node list' works for me but 'knife client list' complains " You authenticated successfully to https://chef-dev.imdemocloud.com:443 as resourcepool-dev.imdemocloud.com but you are not authorized for this action" error
[2014-06-20 16:38:54 -0400] leo___: my chef Server is Open Source one
[2014-06-20 16:39:04 -0400] maniacal: I have a variable that grabbing a list of files that aren't put into the OS until a resource runs.  I think the ruby_block is being complied before the files are layed down
[2014-06-20 16:40:11 -0400] leo___: anybody can help with me ?
[2014-06-20 16:41:43 -0400] nkts: Is there a library which can parse metadata.rb file of the cookbook?
[2014-06-20 16:45:28 -0400] maniacal: if anyone cares I found a solution using 'lambda' here: http://stackoverflow.com/questions/20620724/how-to-lazily-evaluate-an-arbitrary-variable-with-chef
[2014-06-20 16:47:05 -0400] maniacal: nope.  didn't work.  false alarm
[2014-06-20 16:47:14 -0400] maniacal: still looking for a solution if any one has one
[2014-06-20 16:54:07 -0400] jwele: When I use chef 11.x with vagrant chef starts complaining about dependencies but when I provision with chef 10 everything installs without complaining about dependencies. Is this normal? I am trying to make a basic apache php ubuntu box and it chef is complaining about iis as a dependency"
[2014-06-20 17:01:06 -0400] joco: looking for a little help with powershell_script.  Is there a way to get the output from the execution?  Chef logs completion of the resource but script doesnt appear executed, and may be due to execution policy
[2014-06-20 17:01:34 -0400] someara: jwele https://github.com/opscode-cookbooks/php/blob/master/metadata.rb#L13
[2014-06-20 17:01:56 -0400] joco: I've tried code and command attributes, and even with simple scripts which do perform action I cant see any of standard output
[2014-06-20 17:02:31 -0400] jwele: someara: Is there a way to auto-install dependencies like chef 10.x or is chef 10.x ignoring the dependencies?
[2014-06-20 17:02:50 -0400] double_p: anthonyacquanita: if anything is around, pose it now. passing out is next :)
[2014-06-20 17:02:52 -0400] someara: chef 10 isn't auto-installing them... its not erroring on a missing dep
[2014-06-20 17:03:06 -0400] someara: use vagrant-berkshelf to automatically install them
[2014-06-20 17:03:16 -0400] someara: or use test-kitchen to drive vagrant instead
[2014-06-20 17:03:49 -0400] someara: vagrant-berkshelf often breaks when vagrant's internal ruby deps move.... test-kitchen does it out of band
[2014-06-20 17:03:51 -0400] anthonyacquanita: all good... I'm well on my way, thanks
[2014-06-20 17:03:58 -0400] jwele: is there a way to combine the individual berksfiles into a central berksfile or is there a way to get berkshelf to read the individual cookbooks dependencies?
[2014-06-20 17:04:22 -0400] double_p: anthonyacquanita: wish you all the best.. :)
[2014-06-20 17:13:09 -0400] renier: hey, coderanger. Using Poise. I like. Found something in options collector. https://github.com/poise/poise/pull/6
[2014-06-20 17:20:47 -0400] bttf: https://github.com/opscode-cookbooks/omnibus - is that guy flipping a table or setting it down?
[2014-06-20 17:23:43 -0400] cheeseplus: bttf: that is the setting it down ascii
[2014-06-20 17:25:02 -0400] mallu: hello, I have a recipe that stop a service and cleanup some files then start the service. How can I enhance this recipe so that it only start if the service was running before it stopped
[2014-06-20 17:28:01 -0400] whiteadam: bttf: he looks worries
[2014-06-20 17:28:06 -0400] whiteadam: d
[2014-06-20 17:28:41 -0400] whiteadam: mallu: Chef generally enforces a desired state. Is the desired state that the service be ON or OFF?
[2014-06-20 17:30:10 -0400] mallu: whiteadam: ok.. so how do I capture the state of the service before chef stop the service then compare it to see if it need to start it
[2014-06-20 17:31:51 -0400] whiteadam: I'm not sure, what is the service? It sounds like you might be trying to resolve an issue that's root cause is elsewhere.
[2014-06-20 17:33:28 -0400] mallu: well we found that the service is not running on all the machines for some reason or another.. what we are trying to do is if the service status is not "running" then chef don't try to start it...
[2014-06-20 17:34:06 -0400] jascbu: Hi all, I ran chef-client on one of my servers an hour ago and didn't notice at the time but quite a few things have stopped working! Could someone tell me where to find the logs for the run please?
[2014-06-20 17:34:26 -0400] mallu: the issue is, chef first tried to stop the service then do cleanup then start the service... so I can't check the current status of the service as it is aleady stopped
[2014-06-20 17:34:46 -0400] mallu: so I need to see if it was running before chef tried to stop the service
[2014-06-20 17:38:14 -0400] whiteadam: mallu: I think you would need to write some custom scripts to do this.
[2014-06-20 17:39:41 -0400] whiteadam: jascbu: The default location is STDOUT I believe
[2014-06-20 17:41:02 -0400] whiteadam: jascbu: http://docs.opscode.com/debug.html look under "chef-client"
[2014-06-20 17:44:58 -0400] _pingu: how can I cause a chef run to fail and return an exit code of 1?
[2014-06-20 17:45:00 -0400] jascbu: whiteadam: ouch.... This could be difficult then. Thanks anyway.
[2014-06-20 17:45:52 -0400] nico__: hi all, looking for some info on rvm and chef
[2014-06-20 17:46:49 -0400] whiteadam: nico__: What about it?
[2014-06-20 17:46:54 -0400] nico__: I've inherited this chef deploy. It seems that the prior admin had configured a bash script to bootstrap our instances
[2014-06-20 17:47:03 -0400] whiteadam: jascbu: Just run chef-client again and take a look :)
[2014-06-20 17:47:13 -0400] nico__: so it seems that my chef created instances have rvm installed and configured by a bash script
[2014-06-20 17:47:19 -0400] whiteadam: nico__: ok
[2014-06-20 17:47:20 -0400] nico__: and not by a recipe like chef-rvm
[2014-06-20 17:47:29 -0400] _pingu: ok. bye all
[2014-06-20 17:47:47 -0400] nico__: that's causing issues, mostly that I can't change the installed system rubies
[2014-06-20 17:48:05 -0400] nico__: so I want to use chef-rvm
[2014-06-20 17:48:20 -0400] whiteadam: go ahead :)
[2014-06-20 17:48:21 -0400] nico__: but I'm worried it's going to wreak havoc
[2014-06-20 17:48:44 -0400] whiteadam: It could.. I would test it on one or a clone.
[2014-06-20 17:48:54 -0400] nico__: yeah, that's my plan
[2014-06-20 17:49:11 -0400] nico__: just wondering if anyone has seen a simmilar config and if they knew of any gotchas
[2014-06-20 17:49:44 -0400] whiteadam: any idea what's running on top of the rvm installs?
[2014-06-20 17:50:52 -0400] nico__: well, as I understand it, he basically used the script to get ruby on the boxes during the bootstrap in order to have a base ruby install
[2014-06-20 17:51:34 -0400] whiteadam: What's the output of : which ruby
[2014-06-20 17:52:00 -0400] nico__:  /usr/local/rvm/rubies/ruby-1.9.3-p194/bin/ruby
[2014-06-20 17:52:08 -0400] nico__: which honestly is weird
[2014-06-20 17:52:26 -0400] whiteadam: yeah, odd location.
[2014-06-20 17:52:35 -0400] nico__: because the script he has in palce should be installing 1.9.3-p385
[2014-06-20 17:53:06 -0400] nico__: I'm just trying to figure out why he installs rvm during the bootstrap
[2014-06-20 17:53:12 -0400] nico__: I know chef recipes are ruby
[2014-06-20 17:53:21 -0400] whiteadam: Yeah, chef has a built in ruby though
[2014-06-20 17:53:30 -0400] nico__: that's what I thoguht
[2014-06-20 17:53:39 -0400] whiteadam: what bout: gem list
[2014-06-20 17:53:44 -0400] whiteadam: anything in that list you use?>
[2014-06-20 17:54:29 -0400] nico__: yeah
[2014-06-20 17:54:41 -0400] nico__: but my issue at the moment is that I can't get certain gems that I need installed
[2014-06-20 17:54:44 -0400] nico__: like mysql2
[2014-06-20 17:54:55 -0400] nico__: so I want to tear out his ruby
[2014-06-20 17:54:58 -0400] whiteadam: Do you run some ruby or rails software?
[2014-06-20 17:55:02 -0400] nico__: and install it via chef-rvm
[2014-06-20 17:55:12 -0400] whiteadam: I say clone it and give it a go.
[2014-06-20 17:55:18 -0400] nico__: not on this server, but we do have servers dedicated to serving rails apps
[2014-06-20 17:55:45 -0400] nico__: but those machines are already bootstrapped
[2014-06-20 17:56:04 -0400] nico__: so I'm thinking that if I get the deployment right using chef-rvm on a test box
[2014-06-20 17:56:23 -0400] nico__: I can just tear rvm out of those rails systems and re-deploy rvm and ruby with chef-rvm
[2014-06-20 17:56:30 -0400] nico__: does that seem reasonable?
[2014-06-20 17:56:40 -0400] whiteadam: As long as it works on the test bos
[2014-06-20 17:56:42 -0400] whiteadam: box*
[2014-06-20 17:56:53 -0400] nico__: cool.  well that gives me a bit more confidence.
[2014-06-20 17:56:54 -0400] nico__: thanks
[2014-06-20 17:56:54 -0400] whiteadam: cuz it's gonna rip out the gems and such too
[2014-06-20 17:57:21 -0400] nico__: yeah, I'll need to schedule the change after it's tested
[2014-06-20 17:57:38 -0400] nico__: and there are a couple of prod ruby servers that I may just not be able to change it on
[2014-06-20 17:59:17 -0400] whiteadam: just blow em up
[2014-06-20 17:59:18 -0400] whiteadam: :)
[2014-06-20 18:05:58 -0400] nico__: any idea why this this exists in site-cookbooks/our-company/file/default/config/chef-wrapper.rb
[2014-06-20 18:06:01 -0400] nico__: #!/bin/bash
[2014-06-20 18:06:02 -0400] nico__: . /usr/local/rvm/scripts/rvm
[2014-06-20 18:06:02 -0400] nico__: chef-client "$@"
[2014-06-20 18:07:18 -0400] nico__: its referenced by this recipe
[2014-06-20 18:07:42 -0400] nico__: site-ccokbooks/our-company/recipes/config.rb
[2014-06-20 18:07:44 -0400] nico__: cookbook_file "/etc/chef/chef-wrapper" do
[2014-06-20 18:07:45 -0400] nico__: owner "root"
[2014-06-20 18:07:45 -0400] nico__: group "root"
[2014-06-20 18:07:46 -0400] nico__: mode "750"
[2014-06-20 18:07:48 -0400] nico__: source "config/chef-wrapper"
[2014-06-20 18:07:50 -0400] nico__: end.run_action(:create)
[2014-06-20 18:08:46 -0400] nico__: and is part of a role at chef-repo/roles/our_company_base.rb
[2014-06-20 18:08:51 -0400] matti: Hm.
[2014-06-20 18:09:03 -0400] whiteadam: From the name, it sounds like he's just installing chef-client
[2014-06-20 18:09:13 -0400] whiteadam: not sure why he felt the need for rvm
[2014-06-20 18:09:19 -0400] nico__: override_attributes(
[2014-06-20 18:09:20 -0400] nico__:   "chef_client" => {
[2014-06-20 18:09:21 -0400] nico__:     "init_style" => "upstart",
[2014-06-20 18:09:21 -0400] nico__:     "server_url" => Chef::Config[:chef_server_url],
[2014-06-20 18:09:23 -0400] nico__:     "bin" => "/etc/chef/chef-wrapper",
[2014-06-20 18:09:25 -0400] nico__:     "log_file" => "client.log",
[2014-06-20 18:09:27 -0400] nico__:     "daemon_options" => ["-f"]
[2014-06-20 18:09:29 -0400] nico__:   },
[2014-06-20 18:09:39 -0400] whiteadam: yeah, just a chef-client wrapper
[2014-06-20 18:09:51 -0400] nico__: so he's installing rvm and runby 1.9.3 via the bootstrap script
[2014-06-20 18:10:06 -0400] nico__: and then using a basic role that applies to all servers
[2014-06-20 18:10:11 -0400] nico__: to use it for a chef-wrapped
[2014-06-20 18:10:14 -0400] nico__: *wrapper
[2014-06-20 18:10:25 -0400] nico__: I guess I don't understand why though, what does a chef-wrapper do for us?
[2014-06-20 18:10:28 -0400] whiteadam: Not sure what's doing on there.
[2014-06-20 18:10:40 -0400] whiteadam: a "wrapper" uses someone else
[2014-06-20 18:10:55 -0400] whiteadam: else's code and just places your values over it.. like calling a library almost
[2014-06-20 18:11:12 -0400] whiteadam: I use a wrapper for chef-client, but I use the defaults.
[2014-06-20 18:11:35 -0400] nico__: hmmm
[2014-06-20 18:11:38 -0400] jwele: Does anyone know a good book tutorial to learn chef with vagrant?
[2014-06-20 18:12:09 -0400] nico__: so what does a chef-wrapper running chef-client do for an organization, genreally speaking?
[2014-06-20 18:12:19 -0400] robbkidd: jwele: http://shop.oreilly.com/product/0636920020042.do
[2014-06-20 18:12:20 -0400] whiteadam: jwele: http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/
[2014-06-20 18:12:33 -0400] whiteadam: chef-wrapper installs chef-client
[2014-06-20 18:12:34 -0400] whiteadam: It
[2014-06-20 18:12:46 -0400] whiteadam: It's the cookbook that installs chef-client
[2014-06-20 18:13:20 -0400] whiteadam: but instead of having the repo on your computer and keeping it up to date/changing it, you make a "wrapper" that just calls the public cookbook and overwrites it with your settings.
[2014-06-20 18:13:33 -0400] nico__: ok, so that's likely why he did it that way then. He puts rvm and ruby in the bootstrap, so that when a new instance is spun up he can use the rvm installed ruby to rin a chef wrapper that guarantees chef-client ends up ont he machine
[2014-06-20 18:13:38 -0400] whiteadam: nico__: http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-06-20 18:14:07 -0400] whiteadam: I'm not sure. Chef-Client isn't written in ruby, it's haskell, a binary.
[2014-06-20 18:14:55 -0400] whiteadam: When you bootstrap a node, it downloads chef-client in an RPM or DEB
[2014-06-20 18:15:54 -0400] nico__: well I know that the guy who set this up was more or less learning it as he went, and then he left the company
[2014-06-20 18:16:20 -0400] jwele: Thanks for the suggestions.
[2014-06-20 18:16:21 -0400] nico__: so I suppose it's possible that he didn't have all this straight and thought he needed a trickyw ay to get the chef-client installed
[2014-06-20 18:16:22 -0400] whiteadam: and you're the next lucky guy!
[2014-06-20 18:16:44 -0400] nico__: lol yeah, SOOPER lucky
[2014-06-20 18:16:59 -0400] nico__: I know I'm personally learning it all as I go
[2014-06-20 18:17:14 -0400] squaresurf: the chef client is haskell?
[2014-06-20 18:17:14 -0400] whiteadam: Better that way, but much slower.
[2014-06-20 18:17:33 -0400] squaresurf: I've been wanting to learn haskell for quite some time.
[2014-06-20 18:17:45 -0400] nico__: I agree though I'm jumping in to an existing deploy that may have not been rolled out according to best practices
[2014-06-20 18:17:47 -0400] whiteadam: squaresurf: I might be wrong, but I was thinking it was ruby wrapped in haskel
[2014-06-20 18:17:56 -0400] squaresurf: ah
[2014-06-20 18:18:11 -0400] nico__: so I don't neessarily know if I can trust everything that was done before me to be "right"
[2014-06-20 18:18:41 -0400] whiteadam: nico__: Well, if you think of chef as enforcing a "desired state" and you know what that state is, then it won't be too bad... maybe.
[2014-06-20 18:18:56 -0400] squaresurf: whiteadam: do you know where the repo for the chef client lives? This is just a cookbook: https://github.com/opscode-cookbooks/chef-client
[2014-06-20 18:19:04 -0400] whiteadam: with my job, most of the "experts" I run the platform for really have no idea how any of it works, so enforcing the state is hard.
[2014-06-20 18:19:30 -0400] nico__: so I guess that leaves me wondering if I can change my bootsrap scripts to not bother with rvm installs when the machines are spun up?
[2014-06-20 18:19:49 -0400] nico__: and then after the box is spun up and bootstrapped, I can use chef-rvm cookbook
[2014-06-20 18:20:30 -0400] whiteadam: I mean, from the looks of it, it's just installing RVM for no real reason. Maybe he got confused with the point of the client/server. Installing RVM on the client workstation makes more sense.
[2014-06-20 18:20:40 -0400] whiteadam: squaresurf: http://www.getchef.com/chef/install/
[2014-06-20 18:21:09 -0400] whiteadam: squaresurf: ohh, the repo
[2014-06-20 18:21:14 -0400] squaresurf: whiteadam: I think this is what I was looking for: https://github.com/opscode/chef
[2014-06-20 18:21:47 -0400] squaresurf: Looks like it is mostly ruby.
[2014-06-20 18:22:33 -0400] c_t: er
[2014-06-20 18:22:41 -0400] c_t: chef-client is absolutely in ruby
[2014-06-20 18:22:45 -0400] nico__: I think I'm going to start by trying to remove the rvm stuff from the bootstrap scripts and then spin up a fresh vm in my cloudstack. then just attach a backup of an existing volume to that new instance and see how it goes using chef-rvm
[2014-06-20 18:22:48 -0400] c_t: chef 11 is written in erlang
[2014-06-20 18:22:55 -0400] whiteadam: erlang, that's it
[2014-06-20 18:22:57 -0400] c_t: I'm not sure haskell figures into it anywhere
[2014-06-20 18:23:00 -0400] whiteadam: haskell, what was i thinking
[2014-06-20 18:23:19 -0400] whiteadam: nico__: that's a good plan
[2014-06-20 18:23:54 -0400] nico__: ok, well I guess I'm going to get to it.  thanks for the help!
[2014-06-20 18:24:08 -0400] squaresurf: Nice. When is chef 11 planned on being released?
[2014-06-20 18:24:17 -0400] squaresurf: Or are they in the middle of rewriting it in erlang?
[2014-06-20 18:24:35 -0400] whiteadam: It's already at 11.12.8
[2014-06-20 18:24:36 -0400] nico__: hasn't chef server been erlang since v10.somthing?
[2014-06-20 18:24:45 -0400] whiteadam: and server is at 11.1
[2014-06-20 18:25:00 -0400] c_t: chef server 10.x and before is ruby
[2014-06-20 18:25:12 -0400] squaresurf: Thats what I thought. I obviously am very confused. Sorry for the noise.
[2014-06-20 18:25:16 -0400] nico__: ah so, it was at v 11 that they cahnged to erlang
[2014-06-20 18:25:20 -0400] c_t: ja
[2014-06-20 18:25:35 -0400] squaresurf: Is that on github?
[2014-06-20 18:25:39 -0400] nico__: but that's just the server, right?  the client is still ruby?
[2014-06-20 18:25:49 -0400] c_t: https://github.com/opscode/erchef
[2014-06-20 18:25:50 -0400] c_t: yes
[2014-06-20 18:26:40 -0400] squaresurf: This all makes sense now.
[2014-06-20 18:28:06 -0400] double_p: meep meep
[2014-06-20 18:28:09 -0400] double_p: http://www.youtube.com/watch?v=68C-r9kSLNE
[2014-06-20 18:30:20 -0400] whiteadam: cars are crazy
[2014-06-20 18:32:43 -0400] someara: erlang chef-server: https://github.com/opscode/erchef
[2014-06-20 18:34:36 -0400] c_t: huh
[2014-06-20 18:34:52 -0400] c_t: not finding anything out there on running mysql or postgres on plan9
[2014-06-20 18:35:24 -0400] whiteadam: what about SCO unix?
[2014-06-20 18:35:37 -0400] rsavage: Howdy... in a Chef "role", how can I use a node's hostname as a variable?
[2014-06-20 18:35:39 -0400] c_t: I'm sure they'd run there fine
[2014-06-20 18:36:18 -0400] mikesplain: Anyone have a good syslog-ng cookbook they recommend?
[2014-06-20 18:45:18 -0400] rsavage: Howdy... in a Chef "role", how can I use a node's hostname as a variable?
[2014-06-20 18:56:13 -0400] hhoover: is it possible to set attributes for recipes in a machine resource (chef-metal)? If so, any examples?
[2014-06-20 18:58:17 -0400] mikesplain: hhoover sure, this is how I've been doing it... i'm sure it can be cleaned up: https://gist.github.com/mikesplain/c65d926af88e94a4a3ab
[2014-06-20 18:58:43 -0400] hhoover: mikesplain gracias
[2014-06-20 18:58:49 -0400] mikesplain: np
[2014-06-20 19:01:18 -0400] froolie: rsavage: node['hostname'] is an automatic attribute that is available to Ohai
[2014-06-20 19:01:33 -0400] froolie: so you should be able to use that I think
[2014-06-20 19:03:49 -0400] rsavage: ok thanks froolie
[2014-06-20 19:03:54 -0400] rsavage: I appreciate it alot
[2014-06-20 19:05:05 -0400] rsavage: frollie, what's the syntax for that in a an actual "role" as roles are JSON?
[2014-06-20 19:17:09 -0400] froolie: rsavage: I didn't know this off the top of my head, but I looked around and found this link: http://stackoverflow.com/questions/13720941/how-to-query-attributes-inside-a-role-in-chef
[2014-06-20 19:17:14 -0400] froolie: is that what you're trying to do?
[2014-06-20 19:17:49 -0400] rsavage: let me see
[2014-06-20 19:18:09 -0400] nico__: so I used knife with the cs plugin to spin up a new instance. Did that after I made changes to the chef-repo/.chef/bootstrap/ununtu-12.04-lts.erb file. It appears that those changes aren't respected
[2014-06-20 19:18:39 -0400] nico__: do I need to do something similar to a cookbook update to get the change to that bootstrap script up to the chef server?
[2014-06-20 19:19:34 -0400] froolie: I have a syntax question. I'm getting this error: ERROR: The string `remote_file[/tmp/foo.tar.gz' is not valid for resource collection lookup. Correct syntax is `resource_type[resource_name]'
[2014-06-20 19:20:04 -0400] froolie: The relevant lines of my recipe are here: http://pastebin.com/PcBz6SS3
[2014-06-20 19:20:09 -0400] rsavage: froolie, sorta... I need to define node['hostname'] as "collectd": {  "name": <HOSTNAME_VARIABLE> }, where HOSTNAME_VARIABLE is like node['hostname'] but in chef's json fiendly way
[2014-06-20 19:20:56 -0400] froolie: I took this example straight from the remote_file page for chef, syntax and all, and it's failing. Can anyone see what's wrong with it?
[2014-06-20 19:22:07 -0400] nico__: I did make the changes to the bootstrap template locally, and did check them in to my version control (git) but I stongly suspect that the versions up on the server haven't changed.  Do I need to go to the server itself and pull the new verison of the template somehow?
[2014-06-20 19:22:50 -0400] hhoover: mikesplain have you found a way to automatically give admin rights to your provisioning node?
[2014-06-20 19:23:12 -0400] mikesplain: Are you on open source or enterprise?
[2014-06-20 19:23:40 -0400] hhoover: hosted chef
[2014-06-20 19:24:28 -0400] mikesplain: hhoover: ahh okay for that I had to use ACLs, 'knife group add actor admins <client name>'
[2014-06-20 19:24:44 -0400] mikesplain: or whichever group you want to add the client to
[2014-06-20 19:25:00 -0400] hhoover: ok. Thanks again!
[2014-06-20 19:25:04 -0400] mikesplain: np!
[2014-06-20 19:30:39 -0400] nico__: bump for my question re: bootstrap templates - do they need to be uplaoded to the chef server somehow after being modified lcoally?
[2014-06-20 19:32:11 -0400] squaresurf: froolie: When I see your error it is missing an ending `]'. `remote_file[/tmp/foo.tar.gz'
[2014-06-20 19:32:37 -0400] squaresurf: Are you subscribing to that definition somewhere else?
[2014-06-20 19:35:28 -0400] froolie: squaresurf: I have another line under anhttp_request resource: notifies :create, "remote_file[#{node[:mycookbook][:download_dir]}/#{node[:mycookbook][:package]}", :immediately
[2014-06-20 19:36:24 -0400] froolie: I originally had the remote_file resource defined using attributes, and then I got this error message so I changed it to the actual file name
[2014-06-20 19:36:40 -0400] froolie: I only changed it in the remote_file resource though; I'll try changing it in both places to see if that resolves it
[2014-06-20 19:36:58 -0400] froolie: although I don't know why using the default attributes I defined won't work instead of a hard-coded value
[2014-06-20 19:38:05 -0400] squaresurf: "remote_file[#{node[:mycookbook][:download_dir]}/#{node[:mycookbook][:package]}" is missing a bracket.
[2014-06-20 19:38:26 -0400] squaresurf: Should be: "remote_file[#{node[:mycookbook][:download_dir]}/#{node[:mycookbook][:package]}]"
[2014-06-20 19:38:35 -0400] squaresurf: Note the ending bracket.
[2014-06-20 19:40:24 -0400] cudgel: is it ok for the first line in my recipes to be a vim modeline?  I'm a bit of a nazi about tabs vs. spaces, and not everyone on my team has their editor configured properly
[2014-06-20 19:43:50 -0400] rsavage: looking froolie
[2014-06-20 19:44:02 -0400] nico__: to answer my own question - it seems that the knife command to create the instance is where you specify the bootstrap file to be used, or it can be set using the distro option in the knife.rb config file
[2014-06-20 20:05:33 -0400] upsell5: hi, by default, where does berkshelf look for recipes?
[2014-06-20 20:06:15 -0400] squaresurf: It depends on your Berksfile.
[2014-06-20 20:06:26 -0400] upsell5: default asi.berkshelf.com
[2014-06-20 20:06:36 -0400] upsell5: im guessing it is the opscode repo?
[2014-06-20 20:06:52 -0400] squaresurf: Yeah
[2014-06-20 20:07:10 -0400] squaresurf: That is the berks api server for the opscode community site.
[2014-06-20 20:07:23 -0400] upsell5: got it, thanks.
[2014-06-20 20:07:30 -0400] squaresurf: although you do have a typo. it should be: api.berkshelf.com
[2014-06-20 20:09:34 -0400] upsell5: yes type in irc
[2014-06-20 20:09:39 -0400] upsell5: typo rather!
[2014-06-20 20:09:52 -0400] squaresurf: Thats what I thought, but just wanted to make sure it was clear. :)
[2014-06-20 20:11:15 -0400] jalberts: was wondering if anyone can help me understand how the mixlib-cli help output is sorted.  It looks like the magic happens here: https://github.com/opscode/mixlib-cli/blob/master/lib/mixlib/cli.rb#L219-L244.
[2014-06-20 20:11:30 -0400] jalberts: I just don't understand what the code is actually sorting by
[2014-06-20 20:11:45 -0400] jalberts: doesn't seem to be alphabetical based on short or long option
[2014-06-20 20:12:10 -0400] jalberts: just trying to get my help output to look decent and make sense. :)
[2014-06-20 20:12:47 -0400] db123: Opscode has announced support for Chef on Azure with stuff like knifeazure....have they released a step by step guide for setting up chef server on Azure? I'm going nuts with fqdn issues
[2014-06-20 20:19:15 -0400] whiteadam: db123: The Chef server itself is installed the same no matter where it is.
[2014-06-20 20:19:57 -0400] db123: right, so I spin up a new Ubuntu vm and install chef server, but start having issues around FQDN
[2014-06-20 20:20:14 -0400] db123: such as, I can only log into WebUI via IP, can't use the box name
[2014-06-20 20:20:35 -0400] Shred00: does https://username:password@server/... not work for the recipe_url in a solo.rb file?
[2014-06-20 20:21:22 -0400] whiteadam: db123: Does the fqdn of the server match the fqdn that you're pointing at it?
[2014-06-20 20:22:33 -0400] db123: attempting to log into WebUI uisng the fqdn, results in some weird loop back
[2014-06-20 20:22:43 -0400] db123: to a login screen, it never logs you in
[2014-06-20 20:23:13 -0400] whiteadam: What is the server's hostname?
[2014-06-20 20:23:18 -0400] db123: The issue I suspect is that the FQDN of the azure box is always something strange, and I'm not updating it in all the correct spots
[2014-06-20 20:23:32 -0400] lmickh: does anyone have an example of recipe code that walks through sub attributes like a .each loop?  Every way I write it, I get errors converting symbols to intgers trying to pass the values.
[2014-06-20 20:24:17 -0400] db123: hostname -f returns:    hostname.hostname.d5.internal.cloudapp.net
[2014-06-20 20:24:50 -0400] whiteadam: and does that match the FQDN?
[2014-06-20 20:25:54 -0400] db123: I would say no
[2014-06-20 20:26:07 -0400] db123: but that's what hostname -f displays when you start up a new vm on azure
[2014-06-20 20:27:18 -0400] whiteadam: so change the hostname
[2014-06-20 20:27:23 -0400] whiteadam: to match the fqdn
[2014-06-20 20:27:35 -0400] db123: I've updated /etc/hosts, do I need to update it anywhere else?
[2014-06-20 20:27:50 -0400] whiteadam: no clue with ubuntu
[2014-06-20 20:28:08 -0400] db123: and it seems there are several ways to do it on the 'net
[2014-06-20 20:28:32 -0400] db123: and many chef-server walkthrus talk about adding .rb files to override hostnames/fqdn's etc
[2014-06-20 20:30:03 -0400] whiteadam: To me, there's one way to do it.
[2014-06-20 20:31:45 -0400] db123: so adding it into /etc/hosts is correct? What distro are you using for chef-server?
[2014-06-20 20:32:24 -0400] whiteadam: RHEL 6
[2014-06-20 20:32:48 -0400] whiteadam: I would Google setting the hostname on ubuntu
[2014-06-20 20:34:37 -0400] db123: reading the FQDN section of the server install notes, says that "hostname" by itself should return the FQDN, is that right?
[2014-06-20 20:34:39 -0400] Ash:  /etc/hostname too, usually
[2014-06-20 20:37:04 -0400] upsell5: Hi, setting up a new repo using chef + berkself and chef-solo.
[2014-06-20 20:37:31 -0400] upsell5: I did: berk cookbook mycookbook.  ran berk install after adding my recipes.
[2014-06-20 20:37:52 -0400] upsell5: What do I do to make it chef-solo now?  Just add a config/solo.rb and chef.json?
[2014-06-20 20:38:35 -0400] upsell5: oh and also e.g. roles/web.rb
[2014-06-20 20:40:53 -0400] Shred00: maybe put another way, is basic authentication available for fetching the the recipe_url item from https?  it seems to work for the json_attribs but not the recipe_url.
[2014-06-20 20:40:59 -0400] squaresurf: db123: Ash is correct that you need to edit the /etc/hostname file as well.
[2014-06-20 20:44:09 -0400] coderanger: renier: I commented on the ticket, but I don't think that should fix anything
[2014-06-20 20:44:35 -0400] db123: so /etc/hostname should have the hostname or the FQDN?
[2014-06-20 20:45:28 -0400] renier: coderanger, maybe a test first is in order?
[2014-06-20 20:45:46 -0400] coderanger: renier: Guessing you had some mutable structures in there and were changing them in place, which can't be fixed basically no matter what
[2014-06-20 20:46:07 -0400] squaresurf: db123: I put the FQDN there and run `hostname -F /etc/hostname`
[2014-06-20 20:46:08 -0400] coderanger: renier: The fix provided covers that in the case of no defaults, but not if defaults are given
[2014-06-20 20:46:33 -0400] squaresurf: I do that before installing the chef server on Ubuntu 12.04.
[2014-06-20 20:46:43 -0400] db123: ah cool
[2014-06-20 20:46:48 -0400] coderanger: renier: http://hastebin.com/rifoyeyojo.rb shows the difference
[2014-06-20 20:46:51 -0400] db123: so possibly reconfigure is not fixing everything?
[2014-06-20 20:47:17 -0400] squaresurf: I'm not sure. I don't have experience with that.
[2014-06-20 20:47:23 -0400] squaresurf: I could test it out in a moment though.
[2014-06-20 20:47:42 -0400] db123: I"m on VM number 4 or 5 at this point ugh
[2014-06-20 20:48:12 -0400] squaresurf: Have you considered working with test kitchen?
[2014-06-20 20:48:33 -0400] coderanger: renier: To allow for mutating things, I would need a deep_dup, which ruby lacks
[2014-06-20 20:48:34 -0400] squaresurf: It allows you to write integration tests then run them via vagrant.
[2014-06-20 20:48:50 -0400] db123: yes but at this point I'm just trying to get chef-server running in a vm, on Azure
[2014-06-20 20:48:57 -0400] renier: coderanger, no, I don't need to mutate things, and don't think I am from my provider
[2014-06-20 20:49:01 -0400] squaresurf: I understand.
[2014-06-20 20:49:05 -0400] renier: coderanger, let me look at things a bit closer
[2014-06-20 20:49:10 -0400] squaresurf: I'll test the reconfigure bit now.
[2014-06-20 20:49:43 -0400] db123: I come from an M$ background so the learning curve having to deal with the linux side is steep.
[2014-06-20 20:49:54 -0400] squaresurf: ah
[2014-06-20 20:51:53 -0400] db123: any idea as to why the webui login only works on IP, and not hostname or FQDB?
[2014-06-20 20:59:05 -0400] Shubby: db123: I apologize as I have to run out and catch my train so I won't see your answer to my question, but check your DNS settings... if you know the correct IP, try to resolve the FQDN via nslookup or simply ping and see if what nslookup/ping return matches the IP you know is good
[2014-06-20 20:59:09 -0400] Shubby: if not... that's your issue
[2014-06-20 20:59:13 -0400] Shubby: and now I must leave, sorry again
[2014-06-20 20:59:14 -0400] squaresurf: db123: try typing : https://FQDN
[2014-06-20 20:59:34 -0400] squaresurf: http://FQDN will redirect.
[2014-06-20 21:01:00 -0400] squaresurf: I set up a vagrant box and set a bogus domain name to point at the ip in my /etc/hosts on my local machine. I was able to hit the chef webui even though the fqdn differed from what was configured with the chef server set up.
[2014-06-20 21:01:15 -0400] squaresurf: I think that Shubby is onto something there with your DNS.
[2014-06-20 21:01:30 -0400] squaresurf: db123 are you on a windows or *nix machine?
[2014-06-20 21:01:43 -0400] squaresurf: Do you have an equivalent to nslookup?
[2014-06-20 21:03:03 -0400] db123: I'm on my windows desktop now, should I nslookup from there or from my ssh session on the chef server?
[2014-06-20 21:04:43 -0400] db123: both from win machine and chef server I get a "non-authoritative answer" of the public IP
[2014-06-20 21:05:09 -0400] db123: when i hit the webui with https, it just redirects to http, and same affect, login doesn't work
[2014-06-20 21:05:42 -0400] db123: maybe your initial suggest is right, that I need to fix FQDN before installing chef server?
[2014-06-20 21:05:49 -0400] db123: http://docs.opscode.com/install_server.html
[2014-06-20 21:06:06 -0400] db123: it states that "hostname" should return the FQDN
[2014-06-20 21:06:19 -0400] db123: does that sound right? I thought I needed to use -f to return the FQDN
[2014-06-20 21:07:13 -0400] db123: 127.0.0.1 hostname.cloudapp.net hostname
[2014-06-20 21:07:49 -0400] db123: ^ / etc / hosts
[2014-06-20 21:07:50 -0400] squaresurf: That all looks correct.
[2014-06-20 21:08:05 -0400] db123: ^ / etc / hostnam
[2014-06-20 21:08:14 -0400] db123: hostname.cloudapp.net
[2014-06-20 21:08:28 -0400] db123: should the hostname file have just hostname or the FQDN?
[2014-06-20 21:08:32 -0400] squaresurf: What happens if you hit https://hostname.cloudapp.net
[2014-06-20 21:08:37 -0400] squaresurf: note the https
[2014-06-20 21:09:00 -0400] squaresurf:  /etc/hostname should have fqdn
[2014-06-20 21:09:28 -0400] squaresurf:  /etc/hosts should be as you stated with the fqdn pointing to the ip.
[2014-06-20 21:09:29 -0400] db123: it displays the login page, but the https is crossed out (using Chrome)
[2014-06-20 21:09:48 -0400] squaresurf: Thats expected unless you've purchased an ssl cert for it.
[2014-06-20 21:10:02 -0400] squaresurf: It is a self signed cert.
[2014-06-20 21:10:18 -0400] db123: I know it's not attempting to login as it doesnt' give me bad password errors
[2014-06-20 21:10:24 -0400] db123: just returns the same page
[2014-06-20 21:11:05 -0400] db123: I recall seeing one or two blog posts where folks change the webui config somehow, but that seems like a hack...feels like I have some FQDN set wrong due to running on Azure
[2014-06-20 21:11:36 -0400] db123: in "/etc/hosts" I have some ipv6 stuff, does that matter?
[2014-06-20 21:15:11 -0400] db123: did you see my comment on the Opscode server page regarding the FQDN?
[2014-06-20 21:15:21 -0400] db123: they state that "hostname" should return the FQDN
[2014-06-20 21:15:25 -0400] db123: and not just the hostname
[2014-06-20 21:16:02 -0400] squaresurf: What is the output of hostname currently?
[2014-06-20 21:16:29 -0400] db123: just hostname, not the FQDN
[2014-06-20 21:16:36 -0400] db123: I have to "hostname -f" to get the FQDN
[2014-06-20 21:16:43 -0400] db123: if I "sudo hostname FQDN"
[2014-06-20 21:16:49 -0400] db123: then "hostname" returns FQDN
[2014-06-20 21:19:49 -0400] db123: so are Opscodes instructions incorrect?
[2014-06-20 21:20:06 -0400] db123: should "hostname" really return the FQDN?
[2014-06-20 21:21:47 -0400] squaresurf: here is what I do before installing the chef server: http://pastebin.com/h3LNPUJK
[2014-06-20 21:21:58 -0400] squaresurf: That seems to set the hostname correctly for me.
[2014-06-20 21:23:06 -0400] db123: it sounds like my hostname and hosts files are set, do you think that it matters doing it before cehfe server installation?
[2014-06-20 21:23:45 -0400] squaresurf: Not sure, I do it before so that chef can use the hostname output.
[2014-06-20 21:27:15 -0400] db123: thanks for all the help! I'm going to wipe and start over (6th time I think?). I'll set the hostname and FQDN first and see if I get a different result
[2014-06-20 21:27:55 -0400] squaresurf: Sounds good. Let me know if it works.
[2014-06-20 21:28:31 -0400] anoldhacker: I'm trying to use test kitchen with vagrant, chef_zero, and a custom ohai plugin.
[2014-06-20 21:28:55 -0400] anoldhacker: We're downversion on chef, so I'm still using v6 format for the plugin.
[2014-06-20 21:29:22 -0400] anoldhacker: But I cannot get it to run.  It really appears that it isnt being loaded.
[2014-06-20 21:32:12 -0400] anoldhacker: jtimberman: you around?
[2014-06-20 21:32:46 -0400] squaresurf: anoldhacker: do you have any error output?
[2014-06-20 21:33:14 -0400] anoldhacker: Further down.  In the recipe from the run list.
[2014-06-20 21:36:06 -0400] anoldhacker: The resource isn't getting set up. The file I write in the first line does not appear.
[2014-06-20 21:44:29 -0400] squaresurf: I have an issue with one of my nodes public hostname being incorrect.
[2014-06-20 21:44:42 -0400] squaresurf: Is there a way to update that value on the chef server?
[2014-06-20 21:45:25 -0400] anoldhacker: That's way more on the ops side of the question than I know.
[2014-06-20 21:45:57 -0400] anoldhacker: I don't like the idea of just going in with knife & changing the attributethe next chef converge will likely change it back.
[2014-06-20 21:49:20 -0400] squaresurf: Seems like I may be running into this: https://community.rackspace.com/general/f/34/t/623
[2014-06-20 21:49:39 -0400] anoldhacker: gtg. sorry.
[2014-06-20 21:49:41 -0400] squaresurf: And this: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/rackspace.rb#L132
[2014-06-20 22:57:56 -0400] Kumazatheef: Trying to run knife bootstrap for setting up an osx server running osx 10.7.5 ... keep getting error "\xC3" on US-ASCII ... reduced it down to no roles, chef-client is latest, and stacktrace.out isn't helpful ... anyone seen this before?
[2014-06-20 23:09:10 -0400] upsell5: is berks not in the embedded version any longer?
[2014-06-20 23:09:12 -0400] upsell5: i.e. /opt/chef/embedded/bin/berks
[2014-06-20 23:12:59 -0400] squaresurf: upsell5: are you referring to the chefdk?
[2014-06-20 23:25:24 -0400] chef671: when using a password shadow hash to create a user, whats the password that I would type to login as that user?
[2014-06-20 23:26:18 -0400] chef671: the hash or the plain text password?
[2014-06-20 23:27:48 -0400] gchristensen: the plain text password
[2014-06-20 23:33:13 -0400] chef671: ok thanks!
[2014-06-20 23:42:15 -0400] Prothon: I have a question for the audience. But first some background I run a opensource chef server on an HA VM in a cluster. I used the bootstrap method to install (embeded binaries).
[2014-06-20 23:42:34 -0400] Prothon: last night we had an outage and the VM rolled over to another node suddenly but chef server wont start now
[2014-06-20 23:42:48 -0400] Prothon: it looks like erchef cant connect to the database. I'm stumped.
