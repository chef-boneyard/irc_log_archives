[2014-06-04 00:00:05 -0400] jbz: All nodes that have a particular recipe in their runlist?
[2014-06-04 00:00:48 -0400] thatothermitch: if it works like roles, you should be able to knife search node "recipe:recipename"
[2014-06-04 00:02:26 -0400] jbz: It's plural, though, right?  "knife search node 'recipes:<name>'"
[2014-06-04 00:02:35 -0400] jbz: derp sorry, quotes backwards
[2014-06-04 00:02:43 -0400] jbz: 'knife search node "recipes:<name>"'
[2014-06-04 00:03:50 -0400] shanlar: knife search "recipes:cookbook\:\:recipe" -i
[2014-06-04 00:03:51 -0400] shanlar: thanks
[2014-06-04 00:04:06 -0400] thatothermitch: : )
[2014-06-04 00:19:36 -0400] sarkis: coderanger: know of a good way to test berkshelf api is up?
[2014-06-04 00:19:47 -0400] coderanger: sarkis: There is a /status page
[2014-06-04 00:19:52 -0400] sarkis: ah thanks
[2014-06-04 00:20:24 -0400] sarkis: woot, it works... no way to see endpoints eh?
[2014-06-04 00:25:00 -0400] coderanger: sarkis: endpoints?
[2014-06-04 00:25:17 -0400] coderanger: sarkis: I mean /universe is the main API endpoint, but that will just vomit a big pile of JSOn at you
[2014-06-04 00:28:18 -0400] sarkis: i just tried it..
[2014-06-04 00:28:46 -0400] sarkis: cannot convert Berkshelf::API::DependencyCache to xml.. its trying  to output xml weird
[2014-06-04 00:30:40 -0400] sarkis: hmm... and via curl -H 'Accept: application/json' http://berks-api.domain.com, i get a blank json object {}
[2014-06-04 00:33:05 -0400] coderanger: sarkis: How did you install it?
[2014-06-04 00:33:09 -0400] sarkis: cookbook
[2014-06-04 00:33:15 -0400] coderanger: sarkis: You need to run from master if you want the fix for that
[2014-06-04 00:33:20 -0400] coderanger: sarkis: Or add format=json
[2014-06-04 00:33:21 -0400] sarkis: oh i see
[2014-06-04 00:33:29 -0400] coderanger: It only affects browsers
[2014-06-04 00:33:40 -0400] sarkis: oh i don't care about the xml deal
[2014-06-04 00:33:51 -0400] sarkis: im getting a blank json object with curl
[2014-06-04 00:34:05 -0400] sarkis: i do have my chef_server endpoint set
[2014-06-04 00:34:45 -0400] coderanger: sarkis: On the status page, what does it say
[2014-06-04 00:35:23 -0400] sarkis: <cache-status>ok</cache-status>
[2014-06-04 00:35:32 -0400] sarkis: and status ok
[2014-06-04 00:39:08 -0400] sarkis: let me try running it in the foreground
[2014-06-04 00:40:58 -0400] sarkis: aha
[2014-06-04 00:41:00 -0400] sarkis: Ridley::Errors::ClientError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed
[2014-06-04 00:43:23 -0400] sarkis: https://github.com/berkshelf/berkshelf/wiki/Troubleshooting
[2014-06-04 00:46:38 -0400] sarkis: confused how to fix this.. :(
[2014-06-04 00:46:54 -0400] sarkis: without disabling ssl
[2014-06-04 00:54:16 -0400] coderanger: sarkis: set $SSL_CERT_FILE to point at a CA bundle that will work for you
[2014-06-04 01:09:52 -0400] sarkis: ya!!!!!!
[2014-06-04 01:10:11 -0400] sarkis: i had uploaded the wrong cert... forgot to cat the intermediate cert
[2014-06-04 01:10:25 -0400] sarkis: coderanger: i owe you another beer lol, are you on gittip?
[2014-06-04 01:10:42 -0400] coderanger: sarkis: I am, though I don't really push it much
[2014-06-04 01:10:55 -0400] sarkis: cool i found you.. :)
[2014-06-04 01:11:25 -0400] ajturner: good evening - does anyone have an example of a Chef recipe for install Postgres + Ruby (pg) into Vagrant?
[2014-06-04 01:11:53 -0400] ajturner:  Ive spent over a week trying to get past Can't find the PostgreSQL client library despite many hacks, manual compiling, trying difft distros
[2014-06-04 01:12:19 -0400] sarkis: hmm sounds like your missing libpq? or something?
[2014-06-04 01:12:30 -0400] ajturner: sarkis: thats the complaint
[2014-06-04 01:12:42 -0400] ajturner: ive added libpq-dev to default['postgresql']['server']['packages']
[2014-06-04 01:12:59 -0400] sarkis: post your configs, and tell us how you are converging the vm
[2014-06-04 01:13:00 -0400] ajturner: Ive also added build-essentials: true to my json
[2014-06-04 01:13:39 -0400] coderanger: ajturner: postgresql::ruby?
[2014-06-04 01:13:41 -0400] sarkis: sounds like your using attributes?
[2014-06-04 01:13:51 -0400] sarkis: can i see your default.rb?
[2014-06-04 01:14:15 -0400] ajturner: sarkis: https://github.com/ajturner/rails-server-template/tree/opendata
[2014-06-04 01:14:52 -0400] sarkis: is that knife-solo?
[2014-06-04 01:15:25 -0400] ajturner: sarkis: and the relevant error in the output https://gist.github.com/ajturner/423195736c5f48d53d84
[2014-06-04 01:15:39 -0400] ajturner: chef-solo
[2014-06-04 01:16:00 -0400] ajturner: via Vagrant up
[2014-06-04 01:16:04 -0400] sarkis: oh man .. roles :(
[2014-06-04 01:17:18 -0400] ajturner: sarkis: Im new to chef and have seen commentary both ways
[2014-06-04 01:17:31 -0400] sarkis: ajturner: you using  debian/ubuntu?
[2014-06-04 01:17:38 -0400] ajturner: sarkis: ubuntu
[2014-06-04 01:17:41 -0400] kbarry_: I want to download a node as a json
[2014-06-04 01:19:46 -0400] sarkis: ajturner: i think you need libpq-dev
[2014-06-04 01:20:15 -0400] ajturner: sarkis: Ill add that to the server packages. what about postgresql::ruby?
[2014-06-04 01:20:48 -0400] sarkis: https://github.com/hw-cookbooks/postgresql/blob/master/recipes/ruby.rb#L57-L61
[2014-06-04 01:21:16 -0400] ajturner: ah - so automatic?
[2014-06-04 01:21:30 -0400] digitalchild: time to move 35 cookbooks into berks
[2014-06-04 01:21:34 -0400] ajturner: seems like libpq-dev should be too
[2014-06-04 01:21:55 -0400] sarkis: ajturner: ya just need to add postgresql::ruby to your run_list
[2014-06-04 01:22:18 -0400] ajturner: sarkis: ah - its already there
[2014-06-04 01:22:32 -0400] sarkis: before client
[2014-06-04 01:22:37 -0400] ajturner: https://github.com/ajturner/rails-server-template/blob/opendata/roles/postgres-server.json#L25
[2014-06-04 01:22:39 -0400] sarkis: order matters
[2014-06-04 01:22:42 -0400] ajturner: ah
[2014-06-04 01:23:12 -0400] ajturner: so trying that - curious: why not roles?
[2014-06-04 01:24:04 -0400] sarkis: like you said there's arguments for both sides, i just tried both and it was a no brainer to get rid of roles for my situation
[2014-06-04 01:24:10 -0400] sarkis: could be different for you
[2014-06-04 01:25:08 -0400] sarkis: i've been following the berkshelf way and wrapper cookbooks since.. using attribute and include_recipe instead
[2014-06-04 01:25:41 -0400] sarkis: in the end, whatever works, sometimes it's hard to remember all of the different overrides
[2014-06-04 01:26:04 -0400] sarkis: like roles default_attributes is overriden by node etc etc, that crazy graph in the chef docs of attribute inheritence
[2014-06-04 01:26:28 -0400] ajturner: sarkis: yes - the patterns to follow are very far and wide. which has made the learning experience meandering :)
[2014-06-04 01:26:47 -0400] sarkis: yea, i started with chef about a month ago now
[2014-06-04 01:26:59 -0400] ajturner: sarkis: thats why I picked up this, which my repo is based on  https://leanpub.com/deploying_rails_applications
[2014-06-04 01:27:01 -0400] sarkis: but i did come from puppet, so i kinda cheated, it was easy to equate things in my head
[2014-06-04 01:27:04 -0400] ajturner: what are you using?
[2014-06-04 01:27:11 -0400] ajturner: what are you using to learn Chef?
[2014-06-04 01:27:34 -0400] sarkis: ajturner: i watched the jamie windsor video and then just started converting our repos from using roles to berkshelf way
[2014-06-04 01:27:47 -0400] sarkis: now i have a chef server up and berkshelf api.. just doing is how im learning..
[2014-06-04 01:28:00 -0400] digitalchild: what is the berkshelf way instead of roles?
[2014-06-04 01:28:10 -0400] sarkis: http://www.getchef.com/blog/chefconf-talks/the-berkshelf-way-jamie-winsor/
[2014-06-04 01:28:16 -0400] digitalchild: cause im halfway through mvoing from all cookbooks in one basket to berkshelf cookbooks
[2014-06-04 01:28:17 -0400] ajturner: sarkis: same error :/
[2014-06-04 01:29:00 -0400] ajturner: sarkis: I even see above the error: [2014-06-04T01:27:24+00:00] WARN: Current  package[libpq-dev]: /tmp/vagrant-chef-1/chef-solo-1/cookbooks/postgresql/recipes/server_debian.rb:26:in `block in from_file'
[2014-06-04 01:29:36 -0400] ajturner: would there be an issue where its installing the debian package when I need the ubuntu one?
[2014-06-04 01:29:51 -0400] sarkis: no
[2014-06-04 01:31:00 -0400] sarkis: on your vm
[2014-06-04 01:31:06 -0400] sarkis: dpkg -l | grep libpq-dev
[2014-06-04 01:31:25 -0400] sarkis: what do you see
[2014-06-04 01:32:23 -0400] ajturner: sarkis: nothing
[2014-06-04 01:32:29 -0400] ajturner: hrm
[2014-06-04 01:32:36 -0400] sarkis: now look at your roles/postgres-server.json
[2014-06-04 01:32:47 -0400] sarkis: client > packages
[2014-06-04 01:33:07 -0400] sarkis: that overrides this entire line https://github.com/hw-cookbooks/postgresql/blob/master/attributes/default.rb#L43
[2014-06-04 01:33:16 -0400] ajturner: but its in the list
[2014-06-04 01:33:23 -0400] sarkis: notice libpq-dev :)
[2014-06-04 01:34:28 -0400] sarkis: you remove it from client packages, in your roles/postgres-server.json
[2014-06-04 01:34:52 -0400] ajturner: sarkis: ah - libpq-dev is a client package?
[2014-06-04 01:34:57 -0400] sarkis: yes
[2014-06-04 01:35:13 -0400] ajturner: so if have attributes in a sites-cookbook, do those get set before the package installation?
[2014-06-04 01:35:21 -0400] sarkis: the error you are getting is when the ruby gem is being installed for rails to communicate with pg
[2014-06-04 01:35:24 -0400] sarkis: the pg driver
[2014-06-04 01:35:56 -0400] ajturner: btw - reran the dpkg|grep (had a c/p) error and got:
[2014-06-04 01:35:57 -0400] ajturner: ii  libpq-dev                          9.3.4-1.pgdg14.04+1                 i386         header files for libpq5 (PostgreSQL library)
[2014-06-04 01:36:15 -0400] sarkis: yea thats it there..
[2014-06-04 01:36:22 -0400] sarkis: and how about
[2014-06-04 01:36:29 -0400] sarkis: dpkg -l | grep libpq
[2014-06-04 01:36:52 -0400] ajturner: ii  libpq5                                         9.3.4-1.pgdg14.04+1          i386                         PostgreSQL C client library
[2014-06-04 01:38:08 -0400] sarkis: hmm apparently the issue is with openssl https://groups.google.com/forum/#!topic/ruby-pg/oCo8hDHR16A
[2014-06-04 01:39:51 -0400] ajturner: sarkis: yeah, ran into that and is why I went up to 14.04
[2014-06-04 01:40:02 -0400] ajturner: though perhaps/clearly that wasnt the sol'n
[2014-06-04 01:40:33 -0400] ajturner: sarkis: the conflict is b/c Omnibus
[2014-06-04 01:40:53 -0400] ajturner: but then comments like This is released in v1.0.0 of the cookbook. dating from 2012
[2014-06-04 01:41:09 -0400] ajturner: its https://tickets.opscode.com/browse/COOK-1406 that is the issue that seems to keep cropping up
[2014-06-04 01:41:26 -0400] ajturner: and amazingly I cant find a single example of a *working* set of recipes
[2014-06-04 01:50:06 -0400] ajturner: any thoughts sarkis ?
[2014-06-04 01:52:01 -0400] ajturner: whats weird is I then see INFO: execute[install pg spec] ran successfully"
[2014-06-04 01:54:27 -0400] sarkis: ajturner: yea i don't know it has to be that openssl bug the others experienced, no good ideas on how to fix it now though sorry :(
[2014-06-04 01:54:45 -0400] ajturner: thanks - back to another week of bashing on it :p
[2014-06-04 01:55:55 -0400] sarkis: try looking in that direction
[2014-06-04 01:55:58 -0400] sarkis: are u using rvm?
[2014-06-04 01:56:34 -0400] ajturner: rbenv
[2014-06-04 01:57:03 -0400] ajturner: mostly the threads say fixed in 2012 but then that it comes up again in 2013 and nothing
[2014-06-04 02:08:03 -0400] ajturner: sarkis: also curious why pg gem is built before rbenv installs ruby 2.1
[2014-06-04 02:18:12 -0400] a13x212: anyone use the php fpm cookbook?
[2014-06-04 03:17:15 -0400] tabolario: @coderanger: Welp, here I go :) https://github.com/dystio/dystio
[2014-06-04 04:15:51 -0400] yo: anyone here know CHEF ?
[2014-06-04 04:16:15 -0400] Guest25943: what
[2014-06-04 05:48:27 -0400] digitalchild: how singluar should my cookbooks be?
[2014-06-04 05:48:41 -0400] digitalchild: at the moment I have them for every single service/app i need
[2014-06-04 05:49:03 -0400] digitalchild: so i have one for every 3rd party yum repo i use, one to install base packages on all machines, one for monitoring
[2014-06-04 05:49:11 -0400] digitalchild: should i continue this same kind of thing in berks?
[2014-06-04 05:49:25 -0400] digitalchild: to to create an app berks include the other berks cookbooks?
[2014-06-04 05:51:40 -0400] sarkis: digitalchild: i have been splitting up my repos into each application
[2014-06-04 05:51:47 -0400] sarkis: been working out good so far..
[2014-06-04 05:52:29 -0400] digitalchild: how do you mean?
[2014-06-04 05:52:40 -0400] digitalchild: atm i have yum-vmware, yum-mariadb yadda
[2014-06-04 05:52:56 -0400] digitalchild: im coming from all my cookbooks being in chef-repo to the berks way..
[2014-06-04 05:53:02 -0400] digitalchild: and i was using roles before also..
[2014-06-04 05:56:14 -0400] sarkis: well yesx
[2014-06-04 05:56:47 -0400] sarkis: so i seperate the cookbooks that i will use across the different applications i have
[2014-06-04 05:56:54 -0400] sarkis: but i also have application cookbooks
[2014-06-04 05:57:07 -0400] digitalchild: and then you just depends?
[2014-06-04 05:57:12 -0400] sarkis: which bring those other singular cookbooks like mariadb, etc together
[2014-06-04 05:57:18 -0400] digitalchild: say you have a berks cookbook yum-myyum
[2014-06-04 05:57:26 -0400] sarkis: yes the application cookbook will have a bunch of depends
[2014-06-04 05:57:31 -0400] sarkis: include_recipe
[2014-06-04 05:57:32 -0400] sarkis: etc
[2014-06-04 05:57:35 -0400] digitalchild: yup
[2014-06-04 05:57:39 -0400] digitalchild: how do you include local ones?
[2014-06-04 05:57:52 -0400] sarkis: you mean site-cookbooks?
[2014-06-04 05:58:09 -0400] digitalchild: im still pretty new to this so maybe?
[2014-06-04 05:58:10 -0400] digitalchild: heh
[2014-06-04 05:58:16 -0400] sarkis: or like local cookbooks like to develop?
[2014-06-04 05:58:20 -0400] digitalchild: cookbooks i have uploaded to my internal chef server
[2014-06-04 05:58:28 -0400] digitalchild: that i wrote
[2014-06-04 05:58:35 -0400] sarkis: im using berkshelf-api
[2014-06-04 05:58:55 -0400] sarkis: i am running our own berkshelf api which has our chef server as an endpoint
[2014-06-04 05:59:07 -0400] digitalchild: ok
[2014-06-04 05:59:12 -0400] sarkis: so all i have to do is say source "berks-api.mydomain.com"
[2014-06-04 05:59:17 -0400] sarkis: at the top of the berksfile
[2014-06-04 05:59:35 -0400] sarkis: it knows to look first in our chef-server then move on to the other sources if it doesnt find it ther
[2014-06-04 06:00:11 -0400] digitalchild: arh
[2014-06-04 06:00:15 -0400] digitalchild: will have to read up on that
[2014-06-04 06:01:23 -0400] sarkis: https://github.com/berkshelf/berkshelf-api/tree/master/cookbook
[2014-06-04 06:03:29 -0400] digitalchild: ok, yeah I think i just need to better understand how i should structure this stuff
[2014-06-04 06:03:37 -0400] digitalchild: so im not making a giant mess in yet another system heh
[2014-06-04 07:45:04 -0400] CJNE: is it possible to create an encrypted data bag with knife without uploading it to the chef server?
[2014-06-04 08:35:13 -0400] bursy_: Hi, I hope this is the right forum for these types of questions... I'm learning Chef but have only managed a few basic wrapper cookbooks using chef-solo, vagrant and berkshelf. I'm now trying to write a cookbook that has dependencies on application and application_java to deploy a WAR file. At the moment my wrapper cookbook does nothing but include these two dependencies. But each time I run it, I get "uninitialized constant Chef::Res
[2014-06-04 08:35:18 -0400] bursy_: Now looking at what Berkshelf is doing when it resolves it's dependancies, it's using an old version of application_java - "Using application_java (1.1.0)". The latest is 3.0.0, and I can indeed see references to ApplicationBase in the old version but not the new. Can anyone tell me why Berfshelf is making this decision? I've tried forcing the version to 3.0.0 in metadata.rb but then I get a different error. Thanks for any help!
[2014-06-04 08:51:58 -0400] BryanWB: dear chefs, is there an lwrp to add remove privileges from a windows user?
[2014-06-04 08:53:28 -0400] gauravarora: hello, is node['logstash']['instance'][name] same as node['logstash']['instance']['name']?
[2014-06-04 09:02:07 -0400] CJNE: bursy: try berks update
[2014-06-04 09:04:03 -0400] CJNE: gauravarora, no, bare name would use a variable (name), :name and 'name' should be equal though
[2014-06-04 09:04:13 -0400] gauravarora: ok thx
[2014-06-04 10:21:30 -0400] nyeedi: can someone here help me with this
[2014-06-04 10:21:31 -0400] nyeedi: how to apply one run_list to all nodes in organization
[2014-06-04 10:26:11 -0400] srenatus: nyeedi: you could use some knife trick or just create a role that each node has...
[2014-06-04 10:26:50 -0400] srenatus: nyeedi: http://dougireton.com/blog/2013/02/03/knife-tricks/
[2014-06-04 10:26:58 -0400] nyeedi: its like I have many roles defined
[2014-06-04 10:27:27 -0400] nyeedi: now how to apply a recipe to all roles
[2014-06-04 10:27:49 -0400] nyeedi: srenatus, let me check the link once
[2014-06-04 10:30:00 -0400] nyeedi: My requirement is if a chef-client runs on a node first my common recipe should run
[2014-06-04 10:30:23 -0400] nyeedi: and I can't add that recipe/runlist to all roles I have
[2014-06-04 10:30:39 -0400] nyeedi: I want to make it as a default recipe
[2014-06-04 10:51:16 -0400] bursy_: Thanks gauravarora, berks update fixed it. Most appreciated. Although strangely it's now using an older version of the application cookbook (version 3.0.0) but at least its got me over my immediate problem. Thanks again.
[2014-06-04 11:04:28 -0400] Mike: hello
[2014-06-04 11:05:27 -0400] patelm5: question
[2014-06-04 11:07:26 -0400] matti: Just ask ;]
[2014-06-04 11:13:20 -0400] patelm5: is there a best practise for maintaining gems used for chef client ( using bundler ?? )
[2014-06-04 11:13:55 -0400] patelm5: rather is it best practise ?
[2014-06-04 11:51:54 -0400] lewiz: I notice that "knife search 'recipe:some-cookbook'" only returns nodes where some-cookbook is in their run-list rather than nodes who have some-cookbook included by other cookbooks.  Is there a way to find all matching nodes?
[2014-06-04 11:52:43 -0400] lewiz: There seems to be no difference between recipe:some-cookbook and recipes:some-cookbook, either
[2014-06-04 12:23:11 -0400] bixu: I'm on the latest berkshelf release, but when I run 'berks upload' I keep getting this error: The lockfile is out of sync! Run `berks install` to sync the lockfile.
[2014-06-04 12:49:49 -0400] Balistic: Hi, im noticing that one of my recipes is modifying /etc/sudoers to the point where vagrant and test kitchen cannot function since the vagrant user requires a password to sudo. Is there a known workaround? Should I just add a conditional for this case in the recipe?
[2014-06-04 12:53:59 -0400] daxroc: Does the sudo cookbook destroy an existing sudoers file on first converge ?
[2014-06-04 13:00:40 -0400] Balistic: yea
[2014-06-04 13:05:33 -0400] breezeight: help
[2014-06-04 13:06:22 -0400] breezeight: I looking for some tutorial about chef-shell
[2014-06-04 13:06:56 -0400] breezeight: I would like to use it in  solo mode
[2014-06-04 13:19:32 -0400] HontoNoRoger: hello
[2014-06-04 13:20:53 -0400] HontoNoRoger: I got a somewhat philosophical question: why is the knife tool inside the chef-client package? isn't it a workstation tool? normal nodes don't really need knife, right?
[2014-06-04 13:21:17 -0400] HontoNoRoger: wouldn't it make more sense to separate knife from the normal client package?
[2014-06-04 13:58:32 -0400] docwhat: Re: data_bag() and data_bag_item() -- do they work with encrypted data_bags as well?
[2014-06-04 13:59:55 -0400] docwhat: Also, can data_bags_items (the .json file) be partially encrypted? e.g. id=foo, private_key={encrypted hash}, public_key="ssh-rsa ...."
[2014-06-04 14:15:18 -0400] take_it_t: how can i check whether a file changed between chef runs in a recipe?
[2014-06-04 14:16:36 -0400] jbz: take_it_t: If you want to know for a reason other than triggering a resource to manage it, you could always md5sum it and stick the value in an attribute.
[2014-06-04 14:17:34 -0400] jbz: If you want to know whether to update the file, the resources do that automatically - so for example, if you run a template resource to manage it, if the file on the node no longer matches the template output - whether because the file changed or because the template result changed - it'll rewrite it automatically.
[2014-06-04 14:18:47 -0400] take_it_t: jbz: md5sum seems like the best option. cause i want to trigger a service restart in one recipe, if another recipe changed a particular file
[2014-06-04 14:18:58 -0400] jbz: take_it_t: well
[2014-06-04 14:19:04 -0400] jbz: take_it_t: you can do notify across recipes
[2014-06-04 14:19:13 -0400] jbz: notifies work across the whole compiled run
[2014-06-04 14:19:29 -0400] jbz: so if you don't want to mod the recipe that's modifying the file, you could use a 'subscribes' on the service restart
[2014-06-04 14:19:49 -0400] jbz: so if the resource managing that file changes it, the restart will happen.
[2014-06-04 14:20:13 -0400] jbz: actually, to be more precise: if the resource in question has an action other than :nothing, the restart will happen.
[2014-06-04 14:20:34 -0400] jbz: **sigh** no ignore me, I'm being a confusing idiot
[2014-06-04 14:20:51 -0400] jbz: basically, if the resource triggers and modifies the file, the subscribe will trigger the service restart.
[2014-06-04 14:21:05 -0400] take_it_t: ill give that a shot
[2014-06-04 14:26:11 -0400] chris613: Does anyone know how to "rewind" a not_if/only_if attribute on an underlying attribute? I can rewind everything else with chef_rewind, but I think there is some pure-ruby way I need to use for those two
[2014-06-04 14:31:52 -0400] gleam: i think you have to unwind for not_if/only_if/notifies/subscribes
[2014-06-04 14:31:55 -0400] gleam: and then redefine it
[2014-06-04 14:43:40 -0400] keftes: so has anyone had to go through the frustration of dealing with windows shares? It looks like remote_file isn;t doing the trick.
[2014-06-04 14:45:58 -0400] CPS: keftes: remote_file needs a protocol like ftp or scp
[2014-06-04 14:46:18 -0400] CPS: it's hacky but I've resorted to using execute blocks to run copy
[2014-06-04 14:46:29 -0400] keftes: CPS: yeah I'm guessing remote_file doesn't support windows shares
[2014-06-04 14:46:45 -0400] keftes: the alternative is to mount the drive locally and use the file resource
[2014-06-04 14:46:59 -0400] keftes: i mean this is just for a simple file copy..
[2014-06-04 14:53:45 -0400] CPS: is there a framework for debugging and stepping through chef to see what it's doing?
[2014-06-04 14:54:13 -0400] srenatus: CPS: there's chef-shell
[2014-06-04 14:55:28 -0400] CPS: how do i import cookbooks into that?
[2014-06-04 14:55:52 -0400] srenatus: CPS: unfortunately, I have no idea, just a vague idea that it might fit your needs
[2014-06-04 15:01:44 -0400] CPS: anyone know how to load up a cookbook in chef shell? I want to test some methods defined in one of them
[2014-06-04 15:06:49 -0400] CPS: weird, Windows::Helper::AUTO_RUN_KEY prints the thing from the windows cookbook, but Windows::Helper::win_friendly_path("asdfsadf") gives a no method error
[2014-06-04 15:06:58 -0400] CPS: they're declared in the same file in the windows cookbook
[2014-06-04 15:09:47 -0400] CPS: ah, need include Windows::Helper
[2014-06-04 15:32:56 -0400] gleam: i am getting the weirdest issue with the deploy resource. chef is running git ls-remote githuburl, which returns Problem with the SSL CA cert (path? access rights?)
[2014-06-04 15:33:21 -0400] gleam: works fine when i run it manually, though. like chef is not reading the system ca certs
[2014-06-04 15:33:31 -0400] gleam: when it shells out
[2014-06-04 15:44:02 -0400] gleam: well wtf. it works if i run it in chef-shell too.
[2014-06-04 15:50:03 -0400] gleam: nevermind!
[2014-06-04 15:55:23 -0400] gleam: apparently poise-proxy defaults to /etc/ssl for the cert directory, and sets mode 0700 on the cert directory. which breaks stuff.
[2014-06-04 15:59:19 -0400] Lumio: hello everyone.. question: when I launch chef-solo I get following output: https://gist.github.com/lumio/5671dc14a9f77dd9a442
[2014-06-04 15:59:37 -0400] Lumio: 1. should I create a config file if yes, where to find an example file
[2014-06-04 16:00:05 -0400] Lumio: 2. is there a chef user to set up for /var/chef?
[2014-06-04 16:08:17 -0400] axsuul: How can I remove a package only if it exists?
[2014-06-04 16:09:10 -0400] srenatus: axsuul: no
[2014-06-04 16:09:48 -0400] srenatus: axsuul: package "blah" do action :remove end will be happy when the package is not there -- the way things should be according to this resource's action
[2014-06-04 16:10:04 -0400] phantasm66: hey chefs: if i have a depends for another cookbook... how does one go about accessing a custom library (module) from that other cookbook?
[2014-06-04 16:10:06 -0400] robbkidd: Is the package resource "action :remove" not idempotent? http://docs.opscode.com/resource_package.html#actions
[2014-06-04 16:11:42 -0400] pabst^: will version 7 ohai plugins maintain compatibility with version 6 ohai?
[2014-06-04 16:12:02 -0400] pabst^: If I replace my version 6 plugins before upgrading Ohai will those plugins still work?
[2014-06-04 16:12:44 -0400] heathsnow: Has anyone seen this error when using chefdk to execute a simple 'knife node list' command?  /opt/chefdk/embedded/apps/chef/lib/chef/json_compat.rb:62:in `from_json': Top level JSON object must be a Hash or Array. (actual: NilClass) (JSON::ParserError)
[2014-06-04 16:13:58 -0400] heathsnow: Looks like it happened to someone a year ago (http://community.opscode.com/chat/chef/2013-04-23), benadderson, but there's no resolution  :S
[2014-06-04 16:18:03 -0400] axsuul: srenatus: thanks
[2014-06-04 16:31:40 -0400] savant: Hi all
[2014-06-04 16:31:56 -0400] savant: can a single resource have multiple only_if guard statements?
[2014-06-04 16:32:38 -0400] coderanger: savant: Yes
[2014-06-04 16:33:10 -0400] savant: cool thanks
[2014-06-04 16:51:53 -0400] CPS: can someone explain what's going on in this string with the %1$ stuff? "start \"\" /wait \"%1$s\"%2$s%3$s"
[2014-06-04 17:05:12 -0400] AlainODea_: I am getting node['fqdn'] as localhost even when I specify --node-name.  How do I fix this?
[2014-06-04 17:08:22 -0400] x0nic: AlainODea_: I think chef will return the value from /etc/hostname
[2014-06-04 17:08:47 -0400] AlainODea_: x0nic: thanks.  I'll check that
[2014-06-04 17:09:11 -0400] x0nic: AlainODea_: I used the hostname cookbook to fix that for myself
[2014-06-04 17:09:22 -0400] workmad3: x0nic: I've never understood how ohai gets the hostname... on recent ubuntu installs, I've noticed ohai seems to prefer the first name for 127.0.0.1 in /etc/hosts instead of /etc/hostname, for example :(
[2014-06-04 17:10:07 -0400] x0nic: workmad3: Yeah I am always fighting with that too
[2014-06-04 17:10:14 -0400] workmad3: x0nic: which is particularly frustrating... as the image I'm using for 14.04 on DO doesn't put the hostname in there...
[2014-06-04 17:10:31 -0400] x0nic: workmad3: It doesnt for 12.04 either
[2014-06-04 17:10:34 -0400] workmad3: x0nic: I now write that out with my bootstrap script :)
[2014-06-04 17:11:30 -0400] x0nic: workmad3: I used the hostname cookbook for that. Only issue with that, is that I had to bootstrap with hostname as the only cookbook first. Then add the normal runlist and run again
[2014-06-04 17:12:36 -0400] workmad3: x0nic: do you do that manually? or do you run chef-client twice in your bootstrap script?
[2014-06-04 17:14:44 -0400] x0nic: I use knife-digitalocean to bootstrap with just recipe[hostname]. Then i set the runlist on the node (After waiting at least 60 sec for chef to find it) I then use knife to manually run chef-client.
[2014-06-04 17:14:45 -0400] AlainODea_: Yeah, this is maddening. I'm on SmartOS and hostname is right, /etc/nodename is right (no /etc/hostname).  It has worked on every other node I have created.  It seems like a new bug
[2014-06-04 17:15:20 -0400] x0nic: AlainODea_: My guess is that hostname does not support smartos yet.
[2014-06-04 17:16:17 -0400] AlainODea_: In almost two years of using it on SmartOS it has gotten the correct fqdn.  This is a new issue for me.
[2014-06-04 17:22:27 -0400] phantasm66: a notifies to a resource means that resource being notified must already be defined *before* the resource notifying it... correct?
[2014-06-04 17:23:25 -0400] keftes: that gets tricky when you deal with ruby blocks
[2014-06-04 17:27:54 -0400] AlainODea_: fqdn issue was chef 11.12.2. Not sure how that got there originally. Nuked the entire gems directory, reinstalled ruby, deleted node and client. Rebootstrapped and fqdn is correct now. Thank you for your help folks :)
[2014-06-04 17:29:49 -0400] AlainODea_: chef 11.8.2 gem works fine
[2014-06-04 17:33:19 -0400] murali: Hi All,  I am doing knife ssh  xlogo . and it is coming out with unable to display. How to set the dispay in knife
[2014-06-04 17:35:52 -0400] stormerider: murali: i dont think knife ssh is meant for X tunnelling... i dont know if the ruby lib it uses (net-ssh-multi) even supports that.
[2014-06-04 17:46:44 -0400] tabolario: stormerider/murali: you can use the --gateway option to have it tunnel
[2014-06-04 17:47:08 -0400] tabolario: As well as -A for agent forwarding
[2014-06-04 17:48:59 -0400] sanguisdex: am I mad or does the syntax of the domentation for foodcritic conflict with the the docs.opscodesite inter terms of template variable syntax?
[2014-06-04 17:56:51 -0400] r3dk1ng: how do you do a multi line comment in a chef recipe?
[2014-06-04 17:57:24 -0400] keftes: =begin / =end like ruby?
[2014-06-04 17:57:47 -0400] r3dk1ng: k
[2014-06-04 17:57:55 -0400] n1ko: its ruby yeah, but ruby isnt that great with multiline comments :)
[2014-06-04 17:58:02 -0400] n1ko: the =begin, =end is just plain ugly
[2014-06-04 17:58:34 -0400] sanguisdex: more like fugly
[2014-06-04 17:58:57 -0400] sanguisdex: (is "fugly" a regional word?)
[2014-06-04 17:59:14 -0400] r3dk1ng: fugly is the best work
[2014-06-04 17:59:16 -0400] r3dk1ng: word
[2014-06-04 18:01:14 -0400] medya: I want my cookbook to do sudo apt-get update before running, I added include_recipe 'apt' to my cookbook but still it didnt do the sudo apt-get update, whats the correct way to do apt-get update in cookbook
[2014-06-04 18:01:43 -0400] medya: the error that I got in chef-client was default: E: Unable to fetch some archives, maybe run apt-get update or try with --fix-missing?
[2014-06-04 18:04:03 -0400] Otterley: what are folks using these days for CI around integration testing?  Travis isn't a good option for us as it can't run Vagrant/VirtualBox
[2014-06-04 18:04:30 -0400] Otterley: and ChefSpec seems utterly useless
[2014-06-04 18:04:59 -0400] keftes: how can it be useless
[2014-06-04 18:05:05 -0400] keftes: when it's not meant for integration testing?
[2014-06-04 18:05:16 -0400] Otterley: you don't improve your code by rewriting your code in a different way.
[2014-06-04 18:05:49 -0400] mallu0987: hi, I'm trying to override an attribute for our server in AWS. In the cookbook I have if node.cloud.provider?("ec2") .. bla bla end but I'm getting Undefined node attribute or method `provider?' on `node'
[2014-06-04 18:06:00 -0400] Otterley: "how can we make our code better?"  "write it twice?"  "of course!  you're a genius!"
[2014-06-04 18:06:07 -0400] mallu0987: but when I do chef-chell node.cloud.provider is working fine
[2014-06-04 18:06:18 -0400] keftes: i'd look into the concept of unit testing if i was you
[2014-06-04 18:06:19 -0400] mallu0987: ** chef-shell
[2014-06-04 18:06:25 -0400] keftes: you're missing the point
[2014-06-04 18:06:26 -0400] x0nic: Otterley: Chefspec is just for unit testing. No substitute for Integration testing, no.
[2014-06-04 18:06:27 -0400] Otterley: I'm well aware of unit testing.
[2014-06-04 18:06:40 -0400] Otterley: It's completely pointless in Chef IMO
[2014-06-04 18:06:54 -0400] x0nic: Otterley: I am using test-kitchen plus serverspec for integration testingm
[2014-06-04 18:07:10 -0400] Otterley: serverspec is fantastic - but we want CI for it.
[2014-06-04 18:07:16 -0400] icarus: hello all
[2014-06-04 18:07:23 -0400] icarus: does anyone know any good cli front ends for aws?
[2014-06-04 18:07:30 -0400] keftes: catching resource changes before runtime = pretty useful
[2014-06-04 18:07:31 -0400] x0nic: Otterley: Not useless, just for different things. https://sethvargo.com/unit-testing-chef-cookbooks/
[2014-06-04 18:07:34 -0400] icarus: I've been playing with aws cli
[2014-06-04 18:07:42 -0400] Otterley: keftes, no it's not.
[2014-06-04 18:07:58 -0400] x0nic: Otterley: I use test-kitchen to spin up nodes on DigitalOcean or AWS
[2014-06-04 18:08:10 -0400] Otterley: at the end of the day I care about the end state of the host it's running on; I could not give two shits about how the resource is declared.
[2014-06-04 18:08:49 -0400] Otterley: and integration testing will catch both problems without unnecessary duplication of code/intent
[2014-06-04 18:08:54 -0400] keftes: i'd rather catch changes before I have to go through the (lengthy) process of a whole chef converge
[2014-06-04 18:09:25 -0400] keftes: in a few sec - on my local dev workstation - per commit
[2014-06-04 18:09:36 -0400] x0nic: Yeah, unit tests do less, but run MUCH faster. Good for checking complex logic without having to wait for a whole converge
[2014-06-04 18:10:07 -0400] keftes: it's like saying static analysis in general sucks - because i'll catch the syntax errors at runtime :)
[2014-06-04 18:10:28 -0400] Otterley: I'll admit it has a speed advantage over convergence but I don't think it's worth the extra effort
[2014-06-04 18:10:51 -0400] Otterley: x0nic, that's not really CI
[2014-06-04 18:11:00 -0400] mallu0987: can someone please help me out?
[2014-06-04 18:11:07 -0400] mallu0987: hi, I'm trying to override an attribute for our server in AWS. In the cookbook I have if node.cloud.provider?("ec2") .. bla bla end but I'm getting Undefined node attribute or method `provider?' on `node'
[2014-06-04 18:11:17 -0400] x0nic: Otterley: What is not really CI?
[2014-06-04 18:11:17 -0400] Otterley: at least, what I'm looking for is: push commit, CI system pulls cookbook and tests it
[2014-06-04 18:11:24 -0400] x0nic: ah ok
[2014-06-04 18:11:37 -0400] Otterley: I can already run test-kitchen manually :)
[2014-06-04 18:11:54 -0400] stormerider: mallu0987: node.cloud might be nil
[2014-06-04 18:11:58 -0400] keftes: then you need to setup a build pipeline
[2014-06-04 18:12:01 -0400] x0nic: so what I have basically is this: Push to github, jenkins pulls from github, runs test-kitchen
[2014-06-04 18:12:01 -0400] keftes: jenkins etc
[2014-06-04 18:12:14 -0400] Otterley: I'm concerned that the solution here is spin up Jenkins, connect Jenkins to GitHub, Jenkins then has to run test-kitchen
[2014-06-04 18:12:31 -0400] x0nic: No, jenkins is always running
[2014-06-04 18:12:36 -0400] shlant: mallu0987: does this work? if node.cloud.provider == "ec2"
[2014-06-04 18:12:39 -0400] keftes: test kitchen converge is one of the build steps in your pipeline
[2014-06-04 18:12:47 -0400] Otterley: yeah
[2014-06-04 18:12:51 -0400] x0nic: but you do have to spin up nodes for test kitchen yeah
[2014-06-04 18:13:00 -0400] x0nic: and it takes a long time
[2014-06-04 18:13:00 -0400] Otterley: we bought Travis so we could get out of managing Jenkins :/
[2014-06-04 18:13:02 -0400] mallu0987: stormerider node.cloud is not nil
[2014-06-04 18:13:11 -0400] x0nic: oh, you could do the same with travis
[2014-06-04 18:13:15 -0400] Otterley: how?
[2014-06-04 18:13:22 -0400] mallu0987: shlant: let me try that
[2014-06-04 18:13:59 -0400] Otterley: at least, how do you pass AWS credentials securely to Travis?
[2014-06-04 18:14:05 -0400] Otterley: via GitHub?
[2014-06-04 18:14:30 -0400] shlant: Otterley: travis.yml?
[2014-06-04 18:14:35 -0400] Otterley: I said, securely.
[2014-06-04 18:14:49 -0400] shlant: encrypted data bags?
[2014-06-04 18:14:51 -0400] Otterley: if you think I'm putting AWS creds in source control, you're insane.
[2014-06-04 18:14:52 -0400] shlant: citadel?
[2014-06-04 18:15:04 -0400] x0nic: Otterley: Yeah that is an issue. I think on travis you would use ENV for the AWS creds
[2014-06-04 18:15:11 -0400] shlant: Otterley: securely is implied....
[2014-06-04 18:15:28 -0400] anthonyacquanita: x0nic: docker on test-kitchen is very nice and fast
[2014-06-04 18:15:33 -0400] mallu0987: shlant: getting " Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
[2014-06-04 18:15:40 -0400] x0nic: citadel would work, but still has the issue of needing the aws creds
[2014-06-04 18:15:46 -0400] Otterley: x0nic, still a chicken-egg problem
[2014-06-04 18:16:01 -0400] Otterley: if I run Jenkins I can manually configure the creds on my VM, no leakage
[2014-06-04 18:16:09 -0400] Otterley: but Travis, I am not sure
[2014-06-04 18:16:12 -0400] x0nic: how so? You configure travis from the webui with your creds
[2014-06-04 18:16:30 -0400] Otterley: can you?  didn't see that one
[2014-06-04 18:18:11 -0400] shlant: mallu0987: are you using chef server?
[2014-06-04 18:18:17 -0400] mallu0987: yes
[2014-06-04 18:18:30 -0400] shlant: chack that node.cloud.provider is set
[2014-06-04 18:18:33 -0400] shlant: check
[2014-06-04 18:18:42 -0400] x0nic: http://docs.travis-ci.com/user/build-configuration/#Secure-environment-variables
[2014-06-04 18:19:13 -0400] Otterley: mallu0987, are you using node.cloud instead of node["cloud"] in your cookbook?
[2014-06-04 18:19:33 -0400] Otterley: x0nic, bingo!  thanks so much.
[2014-06-04 18:19:35 -0400] mallu0987: Otterley: node.cloud
[2014-06-04 18:19:57 -0400] Otterley: mallu0987: best practice is not to use implied methods on nodes
[2014-06-04 18:21:04 -0400] mallu0987: knife node show <test> -l -a cloud.provider <test>:   cloud.provider: ec2
[2014-06-04 18:21:25 -0400] Otterley: mallu0987, that's a different thing
[2014-06-04 18:21:31 -0400] tabolario: Otterly: I have some examples of test-kitchen CI on travis
[2014-06-04 18:21:41 -0400] Otterley: tabolario, willing to share?
[2014-06-04 18:21:54 -0400] tabolario: Here's a super simple one: https://github.com/americanhonors-cookbooks/libxml/tree/master/test/integration
[2014-06-04 18:22:05 -0400] Otterley: mallu0987, use node["cloud"][
[2014-06-04 18:22:16 -0400] Otterley: mallu0987, try node["cloud"]["provider"] in your cookbook and see if that works
[2014-06-04 18:22:17 -0400] mallu0987: but node.cloud.provider attribute is set and I should be able to use that in my recipe correct?
[2014-06-04 18:22:25 -0400] mallu0987: ok
[2014-06-04 18:22:32 -0400] tabolario: Otterly: Basically for travis you just encrypt your EC2 access key, secret key, ssh cert, etc. in .travis.yml
[2014-06-04 18:22:37 -0400] tabolario: (As env vars)
[2014-06-04 18:23:10 -0400] tabolario: .kitchen.yml is processed with ERB so you can drop in the env vars there
[2014-06-04 18:23:28 -0400] tabolario: I mostly based my EC2 test-kitchen travis setup on the opscode nginx cookbook
[2014-06-04 18:23:41 -0400] tabolario: The opscode cookbook just has extra stuff for some additional cloud providers like rackspace and DO
[2014-06-04 18:23:54 -0400] Otterley: tabolario, any issues with Travis not cleaning up the ephemeral VMs?
[2014-06-04 18:24:04 -0400] tabolario: Nope, test-kitchen takes care of that
[2014-06-04 18:24:51 -0400] mallu0987: otterley: still getting "Node attributes are read-only when you do not specify which precedence level to set. To set an attribute use code like `node.default["key"] = "value"'
[2014-06-04 18:25:10 -0400] Otterley: mallu0987, are you setting them or comparing them?
[2014-06-04 18:25:23 -0400] Otterley: if you're setting an attribute you must use node.default or node.set or node.override
[2014-06-04 18:25:50 -0400] Otterley: if you're evaluating them then you can use node[key][subkey] syntax
[2014-06-04 18:26:04 -0400] Otterley: tabolario, has it been reliable in your experience?
[2014-06-04 18:26:50 -0400] tabolario: Otterly, as reliable as I could hope for. Every once in awhile there's a hiccup spinning up the EC2 instances but no more than you'd have with any other method
[2014-06-04 18:26:59 -0400] Otterley: tabolario, excellent - thanks
[2014-06-04 18:27:05 -0400] tabolario: And we use private travis for our internal cookbooks too
[2014-06-04 18:27:37 -0400] mallu0987: otterley: http://pastebin.com/ppqfjsHa
[2014-06-04 18:27:52 -0400] tabolario: What I'd like to get to possibly too is have the travis build tag the cookbook version too and upload it to the chef server
[2014-06-04 18:28:04 -0400] Otterley: mallu0987, line 1: '=' is setting, '==' is evaluation
[2014-06-04 18:28:29 -0400] mallu0987: oops
[2014-06-04 18:29:18 -0400] mallu0987: great... thanks a lot
[2014-06-04 18:29:24 -0400] Otterley: I think ruby -c will emit a warning about that
[2014-06-04 18:29:30 -0400] tabolario: Otterley: Making a gist for you right now with some of the little things that go along with running test-kitchen on travis
[2014-06-04 18:30:03 -0400] tabolario: We use a dedicated VPC with a single subnet for the test-kitchen instances
[2014-06-04 18:30:39 -0400] Otterley: any particular reason for that?
[2014-06-04 18:30:45 -0400] mallu0987: ok
[2014-06-04 18:30:49 -0400] Otterley: or is this for host-to-host testing?
[2014-06-04 18:30:56 -0400] tabolario: Just to keep em separate from our prod environment
[2014-06-04 18:31:05 -0400] tabolario: Or rather from our actual deploy environments
[2014-06-04 18:31:21 -0400] tabolario: I don't have a solution for cluster testing yet
[2014-06-04 18:31:24 -0400] Otterley: I figured we'd just spin up anonymous VMs in the public cloud
[2014-06-04 18:31:30 -0400] Otterley: unless there's some reason why that's a Bad Idea
[2014-06-04 18:33:25 -0400] Otterley: mallu0987: sure enough: test.rb:1: warning: found = in conditional, should be ==
[2014-06-04 18:33:40 -0400] mallu0987: ok.. thanks a lot
[2014-06-04 18:33:52 -0400] tabolario: Otterley, if anything just because EC2 classic is kind of deprecated now isn't it?
[2014-06-04 18:34:02 -0400] Otterley: is it?
[2014-06-04 18:34:19 -0400] Otterley: I didn't get the memo =)
[2014-06-04 18:34:26 -0400] tabolario: I believe new AWS accounts now default to giving you a VPC, and/or strongly encouraging not to use classic anymore
[2014-06-04 18:34:50 -0400] Otterley: does that mean you have to arrange VPC circuitry for Travis?
[2014-06-04 18:35:02 -0400] medya: can you make vagrant destory to also remove the node form the chef-server ?
[2014-06-04 18:35:15 -0400] tabolario: Nah that's test-kitchen EC2 driver config
[2014-06-04 18:35:18 -0400] tabolario: Here you go: https://gist.github.com/tabolario/b839184acdfda87dfe47
[2014-06-04 18:38:06 -0400] tabolario: Nice thing too is that you can parallelize your integration suites on travis via the build matrix
[2014-06-04 18:38:27 -0400] tabolario: Also like I said, I lifted most of that config from the opscode nginx cookbook :)
[2014-06-04 18:39:47 -0400] tabolario: I'm pretty much following that pattern for all of our cookbooks now though
[2014-06-04 18:40:08 -0400] tabolario: I would like to find a good way to have an integration suite that runs across a cluster of machines though
[2014-06-04 18:40:26 -0400] tabolario: Right now for things like that I still just cram all the recipes into one run_list in test-kitchen
[2014-06-04 18:45:19 -0400] Otterley: yeah, that's what I think of as integration testing, but I admit I'm not an expert in the nomenclature
[2014-06-04 18:45:31 -0400] Otterley: orchestration testing? :)
[2014-06-04 18:45:52 -0400] keftes: aka CI
[2014-06-04 18:46:00 -0400] keftes: somewhat :)
[2014-06-04 18:50:39 -0400] tabolario: In most cases it's probably fine to just cram everything on a single box
[2014-06-04 18:51:00 -0400] tabolario: Unless you're testing service discovery stuff
[2014-06-04 18:51:36 -0400] tabolario: For that I'd probably write a cloudformation template and a separate test suite somewhere that doesn't use test-kitchen, just straight SSH and serverspec
[2014-06-04 18:51:36 -0400] medya: I get this error ,my berkshelf is not working anymore
[2014-06-04 18:51:37 -0400] medya: Berkshelf::UnknownCompressionType: The file at '/tmp/community-rest-stream20140604-32282-1vyqvv9' is not a known compression type
[2014-06-04 18:53:03 -0400] gondoi: what is the workflow for COOK issues?
[2014-06-04 18:53:15 -0400] gondoi: do I need to switch a ticket to 'fix provided' before they get reviewed and merged?
[2014-06-04 18:55:09 -0400] gondoi: someara: you around today?
[2014-06-04 18:56:14 -0400] someara: yes, you need to switch the ticket to fix provided to get it into code review
[2014-06-04 18:56:16 -0400] someara: for now
[2014-06-04 18:56:31 -0400] someara: we're working on getting supermarket out the door so we can switch to github issues
[2014-06-04 18:56:37 -0400] someara: and just "click the green button"
[2014-06-04 18:57:19 -0400] gondoi: awesome sauce.. got mine switched over to that.. gonna switch another. just wanted to verify before I did
[2014-06-04 18:57:30 -0400] gondoi: when do the reviews happen? you guys still do hangouts for reviews?
[2014-06-04 18:58:16 -0400] gondoi: thanks someara
[2014-06-04 19:00:17 -0400] phil_s_stein: This just kills me: "curl -L https://www.opscode.com/chef/install.sh | sudo bash"
[2014-06-04 19:00:53 -0400] phil_s_stein: Does anyone run chef-server on FreeBSD?
[2014-06-04 19:03:20 -0400] Otterley: why would anyone do that?
[2014-06-04 19:03:31 -0400] someara: phil_s_stein no it does not
[2014-06-04 19:03:38 -0400] phil_s_stein: My available server is BSD.
[2014-06-04 19:03:41 -0400] phil_s_stein: ok, thanks.
[2014-06-04 19:04:06 -0400] n1ko: Otterley: why not, freebsd is awesome
[2014-06-04 19:04:08 -0400] Otterley: pretty sure you can run Linux on any server you can run BSD on.
[2014-06-04 19:04:16 -0400] n1ko: way ahead of linux with containers and zfs
[2014-06-04 19:04:19 -0400] Otterley: n1ko, because it doesn't work?
[2014-06-04 19:04:20 -0400] phil_s_stein: the server does many other things though.
[2014-06-04 19:04:21 -0400] n1ko: and security in general
[2014-06-04 19:04:33 -0400] keftes: smaller community
[2014-06-04 19:04:36 -0400] n1ko: well yeah, but i would run it if it would :)
[2014-06-04 19:04:40 -0400] keftes: if that matters for any reason
[2014-06-04 19:04:45 -0400] Otterley: you pick the OS based on the job you want to do.  square peg round hole etc
[2014-06-04 19:05:06 -0400] phil_s_stein: My environment is constrained.
[2014-06-04 19:05:32 -0400] jonlives: phil_s_stein: the server only runs on redhat or debian based linuxes. the client works just fine on BSD tho
[2014-06-04 19:05:48 -0400] jonlives: phil_s_stein: you might want to look at hosted chef instead if BSD is a hard requirement
[2014-06-04 19:06:17 -0400] phil_s_stein: The box is also not easily connectable to the net, so hosted won't work so well.
[2014-06-04 19:06:25 -0400] phil_s_stein: Thanks for the info though.
[2014-06-04 19:06:30 -0400] jonlives: you can also get hosted private chef as an appliance
[2014-06-04 19:06:40 -0400] phil_s_stein: interesting.
[2014-06-04 19:08:10 -0400] floatradamus: HEY Frank___ wht up bro
[2014-06-04 19:08:16 -0400] floatradamus: YOLO etc
[2014-06-04 19:08:19 -0400] jonlives: phil_s_stein: hmm that only runs on linuxes too :(
[2014-06-04 19:08:26 -0400] phil_s_stein: Just out of curiosity, what is the limitation that forces debian/redhat?
[2014-06-04 19:08:36 -0400] jonlives: supporting it, I'd guess.
[2014-06-04 19:08:37 -0400] Otterley: engineering resources, mainly
[2014-06-04 19:08:43 -0400] phil_s_stein: Ah - I thought the appliance would be a physical machine. :)
[2014-06-04 19:08:46 -0400] jonlives: nah
[2014-06-04 19:09:16 -0400] Otterley: most developers aim for the low hanging fruit first, which is Linux, mainly EL-based (RHEL/Centos)
[2014-06-04 19:09:28 -0400] Otterley: Ubuntu is getting more support these days
[2014-06-04 19:10:35 -0400] Frank___: Does anyone know of a way to validate databags within a ruby script? ie check that the databag is syntactically correct
[2014-06-04 19:10:36 -0400] phil_s_stein: The server source is available, right? Has anyone tried to build it on BSD?
[2014-06-04 19:11:11 -0400] Otterley: phil_s_stein, not really the point
[2014-06-04 19:11:20 -0400] Otterley: if you want to try to make it work, by all means do so
[2014-06-04 19:11:21 -0400] phil_s_stein: ok...
[2014-06-04 19:11:27 -0400] phil_s_stein: I'm just talking here.
[2014-06-04 19:11:42 -0400] jonlives: phil_s_stein: you could def try that with OS chef server
[2014-06-04 19:11:55 -0400] jonlives: there's no technical reason it shouldn't be possible I don't think
[2014-06-04 19:12:37 -0400] tabolario: Frank__ You can just run it through JSON.parse
[2014-06-04 19:12:40 -0400] phil_s_stein: that's what I've been assuming. I was just wondering if people knew of anyone who has tried and what problems they might have run into.
[2014-06-04 19:12:47 -0400] tabolario: If it fails then your syntax is wrong :)
[2014-06-04 19:13:17 -0400] Frank___: thanks tabolario
[2014-06-04 19:13:54 -0400] AskSteve: anybody here building kernels for machines - in a recipe or at bootstrap?
[2014-06-04 19:15:45 -0400] Otterley: AskSteve, what problem are you trying to solve?
[2014-06-04 19:16:05 -0400] AskSteve: I want to build a custom kernel for my mysql servers that are bootstrapped with chef
[2014-06-04 19:16:10 -0400] Otterley: when someone wants to rebuild a kernel I get nervous
[2014-06-04 19:16:14 -0400] Otterley: what changes are required?
[2014-06-04 19:16:52 -0400] n1ko: bootstrapping times with building kernel should be quite ridiculous compared to just getting it outside in a recipe :)
[2014-06-04 19:17:07 -0400] Otterley: n1ko, fair point, too
[2014-06-04 19:17:26 -0400] tabolario: Frank__ Simple one liner would be something like `cat /path/to/databag/item.json | ruby -r json -e "begin; JSON.parse(STDIN.read); rescue JSON::ParserError; puts 'JSON syntax error'; end"`
[2014-06-04 19:17:27 -0400] Otterley: (heck we don't even build Rubies)
[2014-06-04 19:17:46 -0400] keftes: faster to build it once and just have chef grab it and install it
[2014-06-04 19:17:56 -0400] tabolario: Otterley: Using the brightbox packages or something?
[2014-06-04 19:17:58 -0400] Otterley: still, curious about the kernel deltas
[2014-06-04 19:18:30 -0400] tabolario: I don't rebuild kernels since I'm on EC2 :)
[2014-06-04 19:18:35 -0400] Otterley: tabolario, nah, we use rbenv, so we script doing 'rbenv install $ruby' and then tar up the /opt/rbenv/rubies/$ruby dir
[2014-06-04 19:18:47 -0400] tabolario: New kernel = New packer image from the official Ubuntu AMIs
[2014-06-04 19:18:58 -0400] tabolario: Otterley: Oh gotcha
[2014-06-04 19:19:01 -0400] Otterley: we've forked the rbenv cookbook to look for a tar ball on our mirror before attempting to compile it
[2014-06-04 19:19:17 -0400] Otterley: saves about 10 minutes per converge
[2014-06-04 19:19:22 -0400] tabolario: I was going to start using fpm to make my rubies
[2014-06-04 19:19:36 -0400] tabolario: And just install them from a private deb repo via package resources
[2014-06-04 19:19:37 -0400] Otterley: I wouldn't go that far, rbenv is nice and easy to use
[2014-06-04 19:21:26 -0400] medya: my berks is broken for no reason , it gives me an error
[2014-06-04 19:21:44 -0400] tabolario: We currently don't use rbenv, just ruby-build but it runs on converge so super slow for new machines
[2014-06-04 19:23:01 -0400] tabolario: I started cheating a little bit on that and building ruby into our AMIs though
[2014-06-04 19:24:26 -0400] AskSteve: its the reboot that is the main issue
[2014-06-04 19:24:37 -0400] AskSteve: we build rubies all the time
[2014-06-04 19:25:11 -0400] Otterley: AskSteve, why do you need a new kernel though?
[2014-06-04 19:25:54 -0400] Otterley: tabolario, that's a reasonable workaround.  rbenv is a small amount of dispatch on top of that, we've found it useful
[2014-06-04 19:26:23 -0400] AskSteve: I can give you a very long list of tweaks, but mostly security and mysql performance
[2014-06-04 19:26:41 -0400] Otterley: AskSteve, curious about the tweaks for mysql performance as we use it heavily
[2014-06-04 19:27:00 -0400] n1ko: i'm interested in that too
[2014-06-04 19:27:09 -0400] sarkis: if two different cookbooks during the same chef run call include_recipe some_recipe
[2014-06-04 19:27:25 -0400] sarkis: say they both include_recipe the same recipe, how does chef handle that?
[2014-06-04 19:27:28 -0400] AskSteve: ok, one sec
[2014-06-04 19:28:35 -0400] sarkis: will it run the recipe twice?
[2014-06-04 19:28:59 -0400] AskSteve: ok, so the doc was a little open ended on what the tweaks were that sucks.
[2014-06-04 19:29:07 -0400] x0nic: I stopped using rbenv and switched to brightbox-ruby. I had issues with geting multiple rubies on the box
[2014-06-04 19:29:12 -0400] AskSteve: I made the ticket to do the kernel build 2 weeks ago
[2014-06-04 19:29:15 -0400] AskSteve: just getting to it now
[2014-06-04 19:32:56 -0400] MikeTLive: Is the berkshelf way the only way?
[2014-06-04 19:33:13 -0400] tcotav: if it were, it would be called "the only way"
[2014-06-04 19:33:35 -0400] AskSteve: miketlive: its not the only way, I have't used it yet, but we are moving in that direction
[2014-06-04 19:34:45 -0400] MikeTLive: it seems like it is becoming the only way much as git/github is becoming the only SCM
[2014-06-04 19:34:49 -0400] x0nic: MikeTLive: Used to use librarian, but switch to berkshelf recently.
[2014-06-04 19:34:59 -0400] Otterley: don't confuse "popular" with "only"
[2014-06-04 19:35:04 -0400] jhunter: q: i'm getting a 400: Bad Request on this search in a recipe, oddly enough.. anyone know why that might be?
[2014-06-04 19:35:06 -0400] Otterley: big enterprises don't use Git that much
[2014-06-04 19:35:08 -0400] jhunter: allHosts = search(:hosts, "*.*")
[2014-06-04 19:35:18 -0400] n1ko: berkshef 3 isn't half bad, berkshelf 2 dependency control was just afwul
[2014-06-04 19:35:23 -0400] n1ko: or even awful
[2014-06-04 19:35:48 -0400] tabolario: x0nic How up to date does brightbox-ruby stay with security patches?
[2014-06-04 19:36:15 -0400] tabolario: I feel like last time I was looking at it there was like a 2 week lag from a patch release for a CVE
[2014-06-04 19:37:28 -0400] x0nic: tabolario: Pretty good. The most recent package is 2.1.1 not 2.1.2
[2014-06-04 19:38:16 -0400] AskSteve: Ok, so the consultant said the issue was actually with the output of top showing 0% CPU so not really a mysql issue
[2014-06-04 19:38:48 -0400] AskSteve: but I would still like to "understand" a reboot during a chef bootstrap since all machines have a kernel upgrade with in a month of release from the provider
[2014-06-04 19:41:11 -0400] Otterley: AskSteve, if I were in your shoes I might have a custom recipe that installs the kernel and reboots the box, and put it in your bootstrap run list
[2014-06-04 19:41:59 -0400] AskSteve: sure so if you reboot in the script, the script never got a chance to end so you're node isn't registered with chef server
[2014-06-04 19:42:24 -0400] Otterley: node.save.
[2014-06-04 19:43:40 -0400] Otterley: (it's one of the few times where it's probably safe to call node.save)
[2014-06-04 19:49:21 -0400] AskSteve: I'll try it
[2014-06-04 19:50:25 -0400] medya: whats the correct way to make apt-get update happen before a recipe ? I did include apt recipe in my cookbook but it did NOT do apt-get update
[2014-06-04 19:51:38 -0400] nico__: Question re: the chef-server-webui in current versions of chrome/ffox/opera/safari
[2014-06-04 19:51:43 -0400] Otterley: medya, you can invoke execute[apt-get update] if you need to
[2014-06-04 19:52:10 -0400] nico__: Recently, I've started seeing scripts running long in the client when opening the webui
[2014-06-04 19:52:25 -0400] Otterley: medya by default apt-get update is only run once a day
[2014-06-04 19:52:26 -0400] medya: do I need to put that in the recpie?
[2014-06-04 19:52:31 -0400] nico__: but if I use an older version of chrome on an older machine, it works fine
[2014-06-04 19:52:49 -0400] medya: where do I put execute[apt-get update]
[2014-06-04 19:52:55 -0400] Otterley: medya or you can set  node['apt']['compile_time_update'] to true
[2014-06-04 19:53:03 -0400] nico__: though I do see errors in the js console on that box where the web ui works - everything DOES work normally there
[2014-06-04 19:53:24 -0400] Otterley: medya, er, scratch that one about compile_time_ypdate
[2014-06-04 19:53:36 -0400] nico__: wondering if this is a known issue for my version of chef with current browsers?
[2014-06-04 19:53:49 -0400] Otterley: medya, you can declare a ruby_block resource that notifies the execute resource immediately
[2014-06-04 19:54:20 -0400] medya: what is a ruby_block resource and where do I notify it
[2014-06-04 19:54:38 -0400] Otterley: medya, sounds like you're new to Chef, start with the documentation
[2014-06-04 19:54:55 -0400] Otterley: familiarize yourself with resources and notifications
[2014-06-04 19:55:03 -0400] Otterley: they're key to Chef
[2014-06-04 19:55:20 -0400] medya: ok
[2014-06-04 19:55:30 -0400] medya: would the resource belong to a cookbook or to a node?
[2014-06-04 19:55:40 -0400] Otterley: resources are declared in recipes
[2014-06-04 20:00:39 -0400] nico__: What's the best way to check the version of my chef-server?  I inherited a self hosted install that seems to be enterprise chef?
[2014-06-04 20:00:42 -0400] keftes: what's the process of submitting a cookbook to chef's community cookbook list?
[2014-06-04 20:01:19 -0400] keftes: nico__ : i'd try knife -v on your chef server
[2014-06-04 20:02:36 -0400] nico__: keftes thanks, it seems im on 11.4.0 from the output of that command
[2014-06-04 20:05:01 -0400] nico__: is that definitive, or is it possible that knife is a different version than the chef server itself?
[2014-06-04 20:06:30 -0400] icarus: is it possible to run multiple chef servers?
[2014-06-04 20:06:44 -0400] icarus: in the event of an outage, and there was need for fail over?
[2014-06-04 20:07:02 -0400] keftes: knife-backup or something like that
[2014-06-04 20:07:13 -0400] keftes: @nico__ not sure :s
[2014-06-04 20:12:38 -0400] juliancdunn: nico__: it should be either a deb or an RPM
[2014-06-04 20:12:45 -0400] juliancdunn: so dpkg or "rpm -qa" will tell you
[2014-06-04 20:12:53 -0400] juliancdunn: 'knife -v' isn't definitive
[2014-06-04 20:14:16 -0400] nico__: good call on dpkg, hadn't even thought of that.  Let's just hope they didn't build from soucre...
[2014-06-04 20:14:17 -0400] nico__: thanks!
[2014-06-04 20:16:03 -0400] jhunter: allHosts = search(:hosts, "*.*") - any reason this should throw a 400/Bad Request in a recipe?
[2014-06-04 20:16:10 -0400] jhunter: super strange
[2014-06-04 20:16:30 -0400] juliancdunn: jhunter: you want '*:*'
[2014-06-04 20:16:42 -0400] juliancdunn: it's Solr syntax, not MS-DOS ;-P
[2014-06-04 20:17:01 -0400] jhunter: oh? :)
[2014-06-04 20:17:04 -0400] jhunter: lemme retry
[2014-06-04 20:17:05 -0400] nico__: root@chef:/opt/chef-server/bin# dpkg -s chef-server
[2014-06-04 20:17:06 -0400] nico__: Package: chef-server
[2014-06-04 20:17:06 -0400] nico__: Status: install ok installed
[2014-06-04 20:17:07 -0400] nico__: Priority: extra
[2014-06-04 20:17:09 -0400] nico__: Section: default
[2014-06-04 20:17:11 -0400] nico__: Installed-Size: 499481
[2014-06-04 20:17:13 -0400] nico__: Maintainer: Opscode, Inc.
[2014-06-04 20:17:15 -0400] nico__: Architecture: amd64
[2014-06-04 20:17:17 -0400] nico__: Version: 11.0.10-1.ubuntu.12.04
[2014-06-04 20:17:19 -0400] nico__: Replaces: chef-server
[2014-06-04 20:17:21 -0400] nico__: Description: The full stack of chef-server
[2014-06-04 20:17:23 -0400] nico__: License: unknown
[2014-06-04 20:17:25 -0400] nico__: Vendor: @andra-slave-16916
[2014-06-04 20:17:27 -0400] juliancdunn: augh!
[2014-06-04 20:17:27 -0400] nico__: Homepage: http://www.opscode.com
[2014-06-04 20:17:45 -0400] nico__: obviously, that's it for an ubuntu install
[2014-06-04 20:19:01 -0400] nico__: What's the best method for determining my upgrade path? Any gotchas in terms of updating the server, or knife and plugins in my chef-repo on local machine?
[2014-06-04 20:20:56 -0400] juliancdunn: you're on 11, so that should be pretty easy to upgrade
[2014-06-04 20:21:00 -0400] juliancdunn: start reading here: http://www.getchef.com/blog/2014/05/14/open-source-chef-server-11-1-0/
[2014-06-04 20:22:23 -0400] eyeball_: hey another noob question. I'm experiementing with chefspec. how do I test that a file is downloaded?
[2014-06-04 20:23:21 -0400] keftes: you mean
[2014-06-04 20:23:27 -0400] eyeball_: in other words i want to run wget. Or should I not bother testing for that in chefspec
[2014-06-04 20:23:28 -0400] nico__: Perfect, this is exactly what I need - thank you!
[2014-06-04 20:23:30 -0400] keftes: test if your code actually tells chef to download it
[2014-06-04 20:23:41 -0400] keftes: not if the file physically gets downloaded (chefspec wont do that)
[2014-06-04 20:24:20 -0400] eyeball_: so then test for the presence of the file ?
[2014-06-04 20:24:40 -0400] eyeball_: i get very confused about what I should and shouldn't test
[2014-06-04 20:25:44 -0400] tcotav: chefspec is about intent
[2014-06-04 20:25:49 -0400] keftes: ^
[2014-06-04 20:25:52 -0400] tcotav: does your code say "go get a file"
[2014-06-04 20:26:02 -0400] tcotav: you'll get to the "is there actually a file" later :D
[2014-06-04 20:26:13 -0400] tcotav: and not with chefspec
[2014-06-04 20:26:18 -0400] r3dk1ng: Afternoon all, has anyone made a portable ruby gem before?
[2014-06-04 20:27:26 -0400] tabolario: r3dk1ng What do you mean by portable?
[2014-06-04 20:28:38 -0400] r3dk1ng: I am using the gem called aws-sdk, and it needs a bunch of system libraries and dev tools to be installed to make the GEM on first install.   One of it's deps is nokogiri, and it does a binary compile....
[2014-06-04 20:29:09 -0400] tabolario: You just need build-essential or the equivalent for aws-sdk
[2014-06-04 20:29:14 -0400] r3dk1ng: I have the gem working on my build box, but I don't want all of those deps to be on my prod boxes
[2014-06-04 20:29:26 -0400] tabolario: Nokogiri comes with its own embedded sources for libxml and libxslt
[2014-06-04 20:29:46 -0400] r3dk1ng: what do you mean by build-essential?
[2014-06-04 20:29:48 -0400] tabolario: Sorry, build-essential plus the Ruby headers
[2014-06-04 20:29:56 -0400] r3dk1ng: OS packages right?
[2014-06-04 20:30:19 -0400] r3dk1ng: running Chef of CentOS
[2014-06-04 20:30:20 -0400] tabolario: build-essential is a native package on debian-ish systems that pulls in the basic packages you need for source-compiling things
[2014-06-04 20:30:23 -0400] tabolario: Ah
[2014-06-04 20:30:58 -0400] tabolario: I think build-essential's equivalent on CentOS is whatever is in the Development Tools group
[2014-06-04 20:31:03 -0400] r3dk1ng: %w(patch openssl-devel ncurses-devel libselinux-devel krb5-devel readline-devel ruby-devel libstdc++-devel autoconf automake gcc libxml2 glibc-devel libxml2-devel libyaml-devel zlib-devel libsepol-devel keyutils-libs-devel libcom_err-devel).each do |pkg|
[2014-06-04 20:31:04 -0400] r3dk1ng:   yum_package pkg do
[2014-06-04 20:31:05 -0400] r3dk1ng:     action :nothing
[2014-06-04 20:31:05 -0400] r3dk1ng:   end.run_action :install
[2014-06-04 20:31:06 -0400] r3dk1ng: end
[2014-06-04 20:31:06 -0400] r3dk1ng: chef_gem 'aws-sdk'
[2014-06-04 20:31:22 -0400] r3dk1ng: I added that, which works fine
[2014-06-04 20:31:33 -0400] r3dk1ng: builds the gem beautifully
[2014-06-04 20:31:35 -0400] r3dk1ng: but
[2014-06-04 20:31:42 -0400] r3dk1ng: I end up with a ton of crap on my box
[2014-06-04 20:32:11 -0400] r3dk1ng: after it's built, can I remove them?  that's why I wanted to know if I could take my recently built gem and make it portable
[2014-06-04 20:32:19 -0400] andrew_plunk: hello all. I am attempting to install chef via the omnibus installer using cents on the rackspace public cloud. The s3 bucket where the chef rpm is being installed via omnibus seems to be blacklisting any cloud server that I attempt to install the chef-client on.
[2014-06-04 20:32:26 -0400] tabolario: Yes, you can remove all the dev packages afterwards if you wanted to
[2014-06-04 20:33:19 -0400] eyeball_: @tcotav my code says remote_file "file.tar.gz" source " http://server.com/file.tar.gz"
[2014-06-04 20:33:22 -0400] r3dk1ng: tabolario: excellent.  Now is there a way to remove them only if this gem exists and is working?
[2014-06-04 20:33:31 -0400] r3dk1ng: in Chef
[2014-06-04 20:34:28 -0400] r3dk1ng: Bascially I need to code in place to rebuild the box if necessary, but also remove the unwated packages once the build is complete
[2014-06-04 20:34:58 -0400] tabolario: I guess you could do something like %w(...).each { |package| resources(package: package).run_actions(:remove) } after your chef_gem resource. (Someone else please chime in if that's a bad idea)
[2014-06-04 20:36:41 -0400] r3dk1ng: tabolario, that sounds like an okay idea, but what's going to stop the packages from installing again since they are missing?  If I add that statement to my recipe, won't it first install all the packages, and then remove them every time a chef-cleint runs?
[2014-06-04 20:38:58 -0400] r3dk1ng: Basically I guess what I need is something like this.  If the aws-sdk is not installed on the box, 1-Install of the OS packages, then 2-nstall the ruby gems.  3-If the aws-sdk is already install, then remove all of the unwated OS packages if they exist.
[2014-06-04 20:39:23 -0400] r3dk1ng: leaving the aws-sdk in place
[2014-06-04 20:39:43 -0400] gleam: i'd suggest you use fpm or something to generate an aws-sdk gem package and then install that package
[2014-06-04 20:39:46 -0400] gleam: rather than building it
[2014-06-04 20:39:59 -0400] r3dk1ng: gleam what is fpm?
[2014-06-04 20:40:15 -0400] gleam: https://github.com/jordansissel/fpm
[2014-06-04 20:41:50 -0400] tabolario: Yeah I was about to suggest fpm as well. However with that you'll probably have to tweak some things if you're going to make aws-sdk available inside of Chef's embedded gem environment
[2014-06-04 20:42:27 -0400] r3dk1ng: like what?
[2014-06-04 20:45:06 -0400] tabolario: Couldn't tell you off the top of my head, but whatever /opt/chef/embedded/bin/gem install aws-sdk would do essentially
[2014-06-04 20:45:32 -0400] r3dk1ng: tab: that's a ton, and we're back to sqaure one...
[2014-06-04 20:46:44 -0400] tabolario: r3dk1ng: Another option would be to bake it into your base image and not install aws-sdk via a chef_gem resource at all, just assume it's there
[2014-06-04 20:47:24 -0400] tabolario: In your base image: install Chef, install build packages, install aws-sdk gem via /opt/chef/embedded/bin/gem install aws-sdk, uninstall build packages, bake your image
[2014-06-04 20:48:05 -0400] r3dk1ng: how do you bake the image?
[2014-06-04 20:48:24 -0400] tabolario: Eh are you making base machine images in any way right now?
[2014-06-04 20:48:31 -0400] r3dk1ng: I have all of that done but "baking my image"
[2014-06-04 20:48:35 -0400] tabolario: Or are you bootstrapping Chef onto a bare CentOS box
[2014-06-04 20:49:01 -0400] tabolario: If so, you might want to check out Packer (http://packer.io)
[2014-06-04 20:49:07 -0400] r3dk1ng: I have a Chef server, and this ia a chef node
[2014-06-04 20:49:16 -0400] r3dk1ng: thats my build box
[2014-06-04 20:50:05 -0400] icarus: keftes: but not the option for 2 simultaneous chef-servers?
[2014-06-04 20:50:11 -0400] tabolario: So if you were to rebuild that build box, what image would you build it from, just a stock CentOS ISO?
[2014-06-04 20:50:22 -0400] r3dk1ng: tab...
[2014-06-04 20:50:46 -0400] r3dk1ng: yes and no... I didn't make this enviornment
[2014-06-04 20:50:59 -0400] r3dk1ng: I joined a group who already had things in play
[2014-06-04 20:50:59 -0400] tabolario: Gotcha
[2014-06-04 20:51:11 -0400] nico__: I have a question about looking up information on my currently deployed chef server
[2014-06-04 20:51:19 -0400] nico__: I have root access to the chef server
[2014-06-04 20:51:28 -0400] nico__: and I know tht it's version 11.0.10
[2014-06-04 20:51:49 -0400] nico__: but how can i figure out if it's an enterprise standalone, or an open source install?
[2014-06-04 20:52:25 -0400] r3dk1ng: I guess my question is.  I have a fully built aws-sdk gem on my build box.  How can I make it a portable gem, I can put on like an FTP server or HTTP server so that my other nodes can get it.
[2014-06-04 20:52:30 -0400] nico__: The admin that did this left the company and isn't available for any kind of follow up so I'm learning it all from scratch.  looking to upgrade and it made me realize I need to take stock of how it's deployed currently
[2014-06-04 20:52:46 -0400] r3dk1ng: ?
[2014-06-04 20:52:49 -0400] gleam: i'd imagine hte package name would be 'private-chef-*' if it was enterprise standalone
[2014-06-04 20:53:32 -0400] nico__: dpkg -s chef-server
[2014-06-04 20:53:33 -0400] nico__: Package: chef-server
[2014-06-04 20:53:44 -0400] nico__: ersion: 11.0.10-1.ubuntu.12.04
[2014-06-04 20:53:46 -0400] stormerider: thats the open source server
[2014-06-04 20:53:51 -0400] gleam: yep
[2014-06-04 20:53:59 -0400] nico__: cool, perfect
[2014-06-04 20:54:05 -0400] nico__: looks like my upgrade path will be pretty easy
[2014-06-04 20:54:50 -0400] nico__: I know that I have a couchdb server in a different place, I'm almost certain that chef is using that server.  how can I verify that  a cohef config file somewhere, or a query command of some kind?
[2014-06-04 20:55:10 -0400] nico__: *how can I verify that?  a chef config file....
[2014-06-04 20:55:30 -0400] gleam: chef 11 doesn't use couchdb, and everything is bundled together in /opt/chef-server
[2014-06-04 20:55:43 -0400] gleam: and /var/chef-server and /var/log/chef-server for the persistent data
[2014-06-04 20:56:09 -0400] nico__: ah, good to know.
[2014-06-04 20:56:36 -0400] nico__: possibly it would be a good idea to back those locations up in case something goes wrong?
[2014-06-04 20:56:47 -0400] gleam: yes, or use something like knife-backup
[2014-06-04 20:57:00 -0400] nico__: cool, I'll google that now. thanks!
[2014-06-04 20:58:55 -0400] rpetty: Good afternoon.  Is it possible to move a node from one organization to another?  I dont see a way in the hosted chef portal.  Is it simply swap out validation.pem, remove client.pem, chef-client?  Impossible?  Or something in between?
[2014-06-04 20:59:51 -0400] icarus: nico__: https://learnchef.opscode.com/screencasts/fundi-webinar-week-1/
[2014-06-04 20:59:59 -0400] r3dk1ng: I could just do something like "Gem.available?('aws-sdk')" if it's not, add package, and if it is, then remove the unwated package if they exist.
[2014-06-04 21:00:03 -0400] icarus: nico__: if you're learning chef from scratch, these videos might help you out
[2014-06-04 21:00:35 -0400] shadylog: Hi, anyone here familiar with the nginx cookbook with chef ?
[2014-06-04 21:00:59 -0400] sarkis: ya
[2014-06-04 21:01:03 -0400] shadylog: I was wondering if nginx is 'reloaded' after each chef run or is 'restarted'
[2014-06-04 21:01:19 -0400] sarkis: none of the  abovr
[2014-06-04 21:01:23 -0400] n1ko: why should do either after each chef run?
[2014-06-04 21:01:30 -0400] shadylog: none of the above?
[2014-06-04 21:01:41 -0400] shadylog: to actuate the new configuration?
[2014-06-04 21:01:43 -0400] sarkis: why would nginx reload or restart after every run?
[2014-06-04 21:01:49 -0400] sarkis: oh so a run that changes the configs
[2014-06-04 21:01:54 -0400] shadylog: ah es
[2014-06-04 21:01:55 -0400] shadylog: yes
[2014-06-04 21:01:56 -0400] sarkis: well its not so hard to find that out..
[2014-06-04 21:01:56 -0400] shadylog: sorry
[2014-06-04 21:02:03 -0400] tabolario: So r3dk1ng , one way you could do this with fpm
[2014-06-04 21:02:06 -0400] shadylog: yes it would add an IP to loadbalance
[2014-06-04 21:02:12 -0400] n1ko: yeah, just read through the recipe
[2014-06-04 21:02:43 -0400] shadylog: you did?
[2014-06-04 21:02:45 -0400] tabolario: First install the gem into it's own place with something like this: gem install --install-dir /opt/aws-sdk --no-document aws-sdk
[2014-06-04 21:02:46 -0400] r3dk1ng: tab: how?
[2014-06-04 21:02:48 -0400] shadylog: I have it here in front of me on github
[2014-06-04 21:02:54 -0400] tabolario: Package that with fpm
[2014-06-04 21:03:18 -0400] tabolario: Then have a cookbook called aws-sdk that installs that package
[2014-06-04 21:03:25 -0400] tabolario: Inside that cookbook
[2014-06-04 21:03:32 -0400] sarkis: https://github.com/opscode-cookbooks/nginx/blob/dd72e38ff8b0f8ec06cc09672df112a2361d919a/recipes/commons_conf.rb#L36
[2014-06-04 21:03:40 -0400] tabolario: In the default recipe or libraries/default.rb or wherever
[2014-06-04 21:03:45 -0400] r3dk1ng: ok
[2014-06-04 21:03:50 -0400] sarkis: shadylog: ^^
[2014-06-04 21:03:52 -0400] tabolario: Unshift the load path to the gem in /opt
[2014-06-04 21:03:57 -0400] shadylog: sarkis: thanks!! I was looking at
[2014-06-04 21:03:58 -0400] shadylog: https://github.com/opscode-cookbooks/nginx/blob/9fb068d6607f398de3aca1cc492f2799980397a5/recipes/package.rb
[2014-06-04 21:04:15 -0400] sarkis: on github at the top.. search for service[nginx]
[2014-06-04 21:04:16 -0400] shadylog: can you tell me why that's not it ? I see reload not_if which nginx
[2014-06-04 21:04:31 -0400] tabolario: So like $LOAD_PATH.unshift(*Dir.glob('/opt/aws-sdk/gems/**/lib'))
[2014-06-04 21:04:42 -0400] r3dk1ng: sweet
[2014-06-04 21:04:44 -0400] tabolario: And then require 'aws-sdk' under that
[2014-06-04 21:05:03 -0400] tabolario: So yeah, all of that might work :)
[2014-06-04 21:05:10 -0400] r3dk1ng: let me trunload
[2014-06-04 21:05:16 -0400] r3dk1ng: let me try
[2014-06-04 21:05:25 -0400] shadylog: sarkis: I see, thank you!
[2014-06-04 21:05:30 -0400] tabolario: Make sure the version of Ruby that you build the gem with is the same version as the embedded Ruby that Chef uses
[2014-06-04 21:05:32 -0400] shadylog: chef is great
[2014-06-04 21:05:41 -0400] sarkis: shadylog: package.rb is the recipe for the package
[2014-06-04 21:05:51 -0400] tabolario: Since nokogiri is an extension gem
[2014-06-04 21:05:57 -0400] tabolario: Just to be safe
[2014-06-04 21:06:04 -0400] sarkis: shadylog: that only happens when nginx needs to be installed or upgraded
[2014-06-04 21:06:32 -0400] r3dk1ng: yeah
[2014-06-04 21:06:34 -0400] shadylog: sarkis: ahh ok, thanks I see it now.
[2014-06-04 21:06:51 -0400] shadylog: not yet wholly familiar with chef yet
[2014-06-04 21:10:27 -0400] r3dk1ng: So tab: once I package up my new /opt/aws-sdk... how do I get all my chef nodes to install it?
[2014-06-04 21:11:54 -0400] tabolario: That's what I was referring to when I talked about making a cookbook for it
[2014-06-04 21:12:39 -0400] r3dk1ng: So tab, I can put the package anywhere? right?
[2014-06-04 21:13:54 -0400] tabolario: Yeah, pub it to an RPM repo if you have one
[2014-06-04 21:14:11 -0400] tabolario: Or just include the package as a cookbook_file in your cookbook :)
[2014-06-04 21:17:16 -0400] r3dk1ng: tab: Thanks!  One last question, how do I use fpm to make the package?
[2014-06-04 21:18:06 -0400] robbkidd: r3dk1ng: Do you have any questions from the fpm README?
[2014-06-04 21:20:01 -0400] r3dk1ng: Ah I found examples
[2014-06-04 21:35:39 -0400] medya: @juliancdunn I read your doing wrapper cookbook blog post, if I wanna override a file in the File directory of a cookbook how do I do that correctly?
[2014-06-04 21:38:01 -0400] medya: @coderanger do you know how I can override a file in "file" directory of a cookbook in a wrapper cookbook ? if I just a create a file with same name in the wrapper-cookbook would it work ?
[2014-06-04 21:38:55 -0400] coderanger: medya: You would need to use chef-rewind to open up the original resource and alter its source and/or cookbook properties
[2014-06-04 21:39:38 -0400] medya: @coderanger is chef-rewind a cookbook itself? or a plugin for chef
[2014-06-04 21:40:00 -0400] coderanger: A gem that helps modify things
[2014-06-04 21:43:56 -0400] medya: how can I make a template out of a xml file that exists and the cookbook would want to change a value of it ?
[2014-06-04 21:44:21 -0400] coderanger: Not sure I understand the question
[2014-06-04 21:44:23 -0400] coderanger: where does it exist?
[2014-06-04 21:46:18 -0400] medya: @coderanger I have a cookbook that installs jboss but it is not perfect, I need it to change value of a something in standalone.xml file on the node after installation
[2014-06-04 21:46:48 -0400] medya: @coderanger so I was thinking I probablly need to make a wrapper cookbook and make a template for standalone.xml and tell it to change that value to what I want.
[2014-06-04 21:47:00 -0400] coderanger: Then as I said, use chef-rewind
[2014-06-04 21:47:08 -0400] coderanger: Yes, thats the correct solution
[2014-06-04 21:47:52 -0400] medya: @coderanger but the original cookbook doesn not have standalone.xml
[2014-06-04 21:47:59 -0400] medya: it is installed as a part of jboss
[2014-06-04 21:48:09 -0400] coderanger: Then make a template for it in the wrapper
[2014-06-04 21:48:25 -0400] medya: @coderanger how can I make a template for a xml file I never done it
[2014-06-04 21:48:44 -0400] coderanger: medya: Copy the current contents of the file into a template
[2014-06-04 21:48:49 -0400] coderanger: and then use a template resource
[2014-06-04 21:48:57 -0400] coderanger: the docs have details on the resource
[2014-06-04 21:49:05 -0400] medya: okay
[2014-06-04 22:33:47 -0400] shwerpa: i need to deploy configurations and applications to my machines in a specific order (e.g. DB servers must be upgraded before application servers).  Is this supported in chef directly, or do I need to look into complementary systems?
[2014-06-04 22:34:07 -0400] shwerpa: Should I be looking at push-based deployments, or orchestrations, or something like that?
[2014-06-04 22:34:08 -0400] coderanger: shwerpa: Are you using open source chef or enterprise?
[2014-06-04 22:34:23 -0400] shwerpa: coderanger:  I am planning currently, and I've budgeted for enterprise.
[2014-06-04 22:34:46 -0400] coderanger: shwerpa: Enterprise Chef includes Chef Push Jobs which supports things like that
[2014-06-04 22:35:06 -0400] shwerpa: coderanger:  wonderful, thanks.  I'll explore that!
[2014-06-04 22:35:34 -0400] coderanger: shwerpa: On the open source side of things, you can check out Rundeck
[2014-06-04 22:35:50 -0400] coderanger: (and obligatory plug for github.com/poise/rundeck
[2014-06-04 22:37:20 -0400] shwerpa: coderanger: any thoughts on whether rundeck or push jobs might be a better fit for my 90%-Windows environment?
[2014-06-04 22:37:37 -0400] coderanger: push jobs, definitely
[2014-06-04 22:37:46 -0400] shwerpa: coderanger:  thanks again!
[2014-06-04 22:37:47 -0400] coderanger: rundeck wouldn't even help much since it is SSH-based by default
[2014-06-04 22:43:40 -0400] CJNE: with an environment cookbook, should all cookbook dependencies be in the Berksfile including sub dependencies of all cookbooks i directly depend on?
[2014-06-04 22:45:25 -0400] CJNE: or is this what i'm supposed to have the api server for?
[2014-06-04 23:01:19 -0400] rpetty: Hello, does anyone know why my node-name is the internal fqdn hostname instead of what I specified knife bootstrap via node-name my_other_name ?
[2014-06-04 23:03:08 -0400] rpetty: http://pastebin.com/SwZwyA4W
[2014-06-04 23:03:24 -0400] rpetty: is my command to bootstrap
[2014-06-04 23:15:41 -0400] digitalchild: rpetty: why is the node name dashes funny?
[2014-06-04 23:16:24 -0400] digitalchild: rpetty: also does -N my_cool_name work ?
[2014-06-04 23:18:28 -0400] rpetty: digitalchild:that was just an example, the real name is normal looking, I did not try -N though, I will on my next one thanks.
[2014-06-04 23:18:55 -0400] rpetty: fyi if I rename (client.rb and remove client.pem and node from portal) it works
[2014-06-04 23:33:03 -0400] digitalchild: how come some guides i find tell you to add your deps in the Berksfile yet others add to metadata
[2014-06-04 23:33:23 -0400] digitalchild: the mischa taylor guide doesn't touch the berksfile
[2014-06-04 23:36:14 -0400] tmichael: it possible to have search find node with ONLY a specific role?  e.g. nodes running ONLY base?
[2014-06-04 23:36:18 -0400] tmichael: knife search node 'run_list:role\[base\]'
[2014-06-04 23:36:38 -0400] tmichael: ^^ that will give me every node that has base
[2014-06-04 23:36:48 -0400] tmichael: regardless of other items in run_list
[2014-06-04 23:36:54 -0400] tmichael: tried role and roles, but same result
[2014-06-04 23:37:27 -0400] tmichael: and knife search node 'run_list:role\[base\]$' that obviously doesn't get it done either ;)
