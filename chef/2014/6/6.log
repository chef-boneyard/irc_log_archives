[2014-06-06 00:04:31 -0400] foom_: coderanger: aaand it does exactly what you said, thank you so much!
[2014-06-06 00:04:54 -0400] Otterley: anyone running a Berkshelf API server?  what's the security story?  how can you lock it down to authorized clients?
[2014-06-06 00:05:09 -0400] coderanger: Otterley: You don't, it doesn't support that
[2014-06-06 00:05:18 -0400] Otterley: this is unfortunate
[2014-06-06 00:05:31 -0400] coderanger: Otterley: But it also only shows cookbook names and versions, which are generally not security-sensitive
[2014-06-06 00:05:53 -0400] coderanger: Otterley: You can run it behind a VPN if you choose, and HTTP basic auth might work, I've not tried it
[2014-06-06 00:06:00 -0400] Otterley: ok, that's not awful
[2014-06-06 00:06:19 -0400] Otterley: trying to figure out how to securely access cookbooks via Berkshelf from Travis
[2014-06-06 00:06:47 -0400] Otterley: Berkshelf will still need to make Chef API calls to actually fetch prerequisite cookbooks, then
[2014-06-06 00:09:02 -0400] Otterley: @coderanger, if chef_api :config is no longer supported by Berks 3, how does Berks know how to fetch the cookbooks from Chef server?
[2014-06-06 00:09:26 -0400] Otterley: assuming the Berks API server isn't proxying cookbook requests through to the server on the client's behalf
[2014-06-06 00:09:30 -0400] coderanger: Otterley: You setup your berks-api server with a chef-server endpoint
[2014-06-06 00:09:49 -0400] coderanger: and you still need to do the actual key mangement in the berks client like in berks 2
[2014-06-06 00:09:56 -0400] Otterley: right.... so then it's not just showing cookbook names and versions, unless I misunderstand you
[2014-06-06 00:10:27 -0400] coderanger: No, you still get the cookbooks directly from the desired endpoint
[2014-06-06 00:10:36 -0400] coderanger: the berks-api server _just_ hands out a list of what cookbooks exist
[2014-06-06 00:10:42 -0400] coderanger: used for dependency solution
[2014-06-06 00:10:43 -0400] Otterley: ok, I see
[2014-06-06 00:11:02 -0400] coderanger: I can show you how to setup a chef API key for use with travis if you want
[2014-06-06 00:11:12 -0400] coderanger: Its kind of a pain, but doable
[2014-06-06 00:11:32 -0400] Otterley: see PM - would be much appreciated
[2014-06-06 00:11:36 -0400] Otterley: cheers!
[2014-06-06 00:21:35 -0400] digitalchild: coderanger: around?
[2014-06-06 00:21:47 -0400] coderanger: Yep, whats up
[2014-06-06 00:22:36 -0400] digitalchild: just need some claification with berkshelf stuff if you can ?
[2014-06-06 00:22:49 -0400] digitalchild: i was using roles and chef-repo and single cookbooks
[2014-06-06 00:23:02 -0400] digitalchild: and i have roles like base-machine base-monitoring
[2014-06-06 00:23:11 -0400] digitalchild: which these different cookbooks are added to the run lists
[2014-06-06 00:23:39 -0400] digitalchild: would i just berkshelf each of those cookbooks and then make a wrapper cookbook that includes each of those ?
[2014-06-06 00:23:55 -0400] digitalchild: so i would then have a base-machine cookbook that includes the 8 sub cookbooks?
[2014-06-06 00:25:58 -0400] digitalchild: im still trying to wrap my head around the app cookbook idea when I have base cookbooks that all my machines require that aren't community cookbooks
[2014-06-06 00:25:58 -0400] coderanger: That depends on them, yes
[2014-06-06 00:26:20 -0400] digitalchild: is this where berkshelf-api comes in?
[2014-06-06 00:26:48 -0400] coderanger: No, berkshelf-api just helps provide a simple data set for solving dependencies and version constraints, it really doesn't do much
[2014-06-06 00:26:57 -0400] coderanger: berks itself is just a packaging tool
[2014-06-06 00:27:12 -0400] coderanger: it makes it easy to have cookbooks depend on other cookbooks and still test them in isolated ways
[2014-06-06 00:28:28 -0400] digitalchild: ok so just take the idea of individual cookbooks from chef-repo and spin up berks cookbook eachcookbook
[2014-06-06 00:28:34 -0400] digitalchild: so I can test them all
[2014-06-06 00:28:39 -0400] digitalchild: and then make a wrapper that talks to them all ?
[2014-06-06 00:28:47 -0400] coderanger: "berks cookbook" isn't really a thing
[2014-06-06 00:29:05 -0400] digitalchild: i know that just creates a berks cookbook template right?
[2014-06-06 00:29:06 -0400] coderanger: there is no specific thing that makes it a "berks cookbook", its an overall style and workflow about how you use cookbooks :)
[2014-06-06 00:29:27 -0400] digitalchild: beacuse on the berkshelf page they say to put your deps in the Berksfile
[2014-06-06 00:29:50 -0400] coderanger: Sure, there is a skeleton generator for convenience, that will get moved over to chefdk eventually
[2014-06-06 00:29:51 -0400] digitalchild: but the few places I've found complete how to examples don't touch the berksfile at all and put it all in the metadata
[2014-06-06 00:30:00 -0400] coderanger: No, you rarely put deps in the actual berksfile
[2014-06-06 00:30:16 -0400] digitalchild: and how do i do depends 'myinternal cookbook' ?
[2014-06-06 00:30:28 -0400] coderanger: in the metadata.rb, depends 'myinternal'
[2014-06-06 00:30:31 -0400] digitalchild: cause when i try that and try and provision my vagrant it says it can't find it
[2014-06-06 00:30:48 -0400] coderanger: How do you store your cookbooks?
[2014-06-06 00:30:57 -0400] coderanger: Is there a chef-server with a copy of myinternal on it?
[2014-06-06 00:31:14 -0400] digitalchild: they are all currently in chef-repo that are also sitting on our internal gitlab server
[2014-06-06 00:32:11 -0400] coderanger: How do you use them in production
[2014-06-06 00:32:21 -0400] coderanger: chef-client, solo, etc?
[2014-06-06 00:32:28 -0400] digitalchild: chef-client
[2014-06-06 00:32:35 -0400] digitalchild: bootstrap the host, give it some roles
[2014-06-06 00:32:41 -0400] coderanger: Okay, so you have a chef-server with the released versions of each cookbook
[2014-06-06 00:32:42 -0400] digitalchild: the chef-client it
[2014-06-06 00:32:49 -0400] digitalchild: internal chef server yes
[2014-06-06 00:32:55 -0400] coderanger: you would setup your berks-api server to point at your chef server
[2014-06-06 00:33:07 -0400] digitalchild: can it run on the chef-server host?
[2014-06-06 00:33:12 -0400] coderanger: so when berkshelf goes to solve the dependencies, it can see all your internal stuff
[2014-06-06 00:33:23 -0400] digitalchild: ok
[2014-06-06 00:33:32 -0400] digitalchild: will rtfm berkshelf api config/setup
[2014-06-06 00:33:33 -0400] coderanger: yep, though I generally recommend care with that since it does have a slow memory leak and could adversely affect perf of erchef
[2014-06-06 00:33:45 -0400] digitalchild: can i just cron a restart? :)
[2014-06-06 00:34:02 -0400] coderanger: Yeah, or supervisor, monit, etc
[2014-06-06 00:34:03 -0400] digitalchild: i have a tomcat application like that...
[2014-06-06 00:34:10 -0400] coderanger: Just needs to be bounced maybe once a month
[2014-06-06 00:34:15 -0400] coderanger: so not a big deal
[2014-06-06 00:34:17 -0400] digitalchild: i reported the bug to the developer and he's like, ill fix this!
[2014-06-06 00:34:28 -0400] digitalchild: i login to see what hes done, slacker restarts tomcat once a day!
[2014-06-06 00:34:32 -0400] digitalchild: 'err this isn't a fix'
[2014-06-06 00:34:54 -0400] digitalchild: ok, thanks!
[2014-06-06 00:35:07 -0400] digitalchild: i might actually write up this giant learning curve i've been working on
[2014-06-06 00:35:12 -0400] anthonyacquanita: thanks!  I was just going to research this exact thing!
[2014-06-06 00:35:25 -0400] digitalchild: chef-server, chef workstation, berkshelf, vargrant, gitlab, berkself-api...
[2014-06-06 00:35:32 -0400] digitalchild: so many new things!
[2014-06-06 00:35:54 -0400] coderanger: Reminder: If you are looking for help with this advanced chef usage stuff, I offer training classes :)
[2014-06-06 00:36:12 -0400] digitalchild: you do?
[2014-06-06 00:36:27 -0400] digitalchild: i do believe im on the other side of the planet...
[2014-06-06 00:36:30 -0400] digitalchild: online?
[2014-06-06 00:36:55 -0400] coderanger: digitalchild: Depends on the situation, but possibly.
[2014-06-06 00:37:19 -0400] digitalchild: i could always help you setup an online course...
[2014-06-06 00:37:28 -0400] digitalchild: that you can charge on a per student basis...
[2014-06-06 00:37:55 -0400] coderanger: digitalchild: Heh, I haven't quite gotten that far, mostly I do in-house company training sessions
[2014-06-06 00:38:08 -0400] digitalchild: well i'm an it guy of .. one heh
[2014-06-06 00:38:32 -0400] digitalchild: but wanting to learn all this to remove a lot of the complexity currently in this setup, automate and focus on other internal projects
[2014-06-06 00:38:58 -0400] digitalchild: that and I want to get into DevOps in a bigger company in the not too distant future
[2014-06-06 00:43:33 -0400] anthonyacquanita: digitalchild:  r u using test-kitchen with berks right now?
[2014-06-06 00:43:44 -0400] coderanger: digitalchild: I would like to do one-off public session in the future, so stay tuned
[2014-06-06 00:44:27 -0400] anthonyacquanita: digitalchild:  I think all you need to do if berks upload  after you are happy with everything to get the community CB's uploaded to your private repo
[2014-06-06 00:45:18 -0400] digitalchild: anthonyacquanita: my issue is my internal cookbooks aren't being detected before berks up load
[2014-06-06 00:47:04 -0400] anthonyacquanita: what about using path in the Berksfile ? cookbook 'm-repos', path: '~/chef_stuff/cookbooks/m-repos'
[2014-06-06 00:47:41 -0400] digitalchild: because everywhere i look says don't use the Berksfile...
[2014-06-06 00:49:09 -0400] coderanger: digitalchild: You _can_ manually specify the location of each dependent cookbook in the berksfile
[2014-06-06 00:49:16 -0400] coderanger: digitalchild: It is just brittle and hard to manage
[2014-06-06 00:49:23 -0400] digitalchild: yeah id prefer not :)
[2014-06-06 00:49:36 -0400] coderanger: digitalchild: cookbook 'myinternal', git: 'https://gitlab/something'
[2014-06-06 00:50:01 -0400] digitalchild: yeah i was considering that but i think the berks-api is probably a cleaner more maintainable route yes?
[2014-06-06 00:50:47 -0400] digitalchild: and i'd say 60% of my internal cookbooks are just because I wanted to learn to write my own cookbooks and the community ones will suite just fine
[2014-06-06 00:52:51 -0400] coderanger: Yep, its super easy to get started with the berks server
[2014-06-06 00:53:34 -0400] anthonyacquanita: gotcha.  I just moved from chef-server 0.10 to 11 so.. one major change at a time :-)
[2014-06-06 00:53:37 -0400] digitalchild: ok, i think i just need to rethink a lot of what I was doing, im overcomplicating things agao
[2014-06-06 00:53:43 -0400] digitalchild: again..
[2014-06-06 00:53:59 -0400] digitalchild: use community as much as I can and then only when i need something different I should lift a finger...
[2014-06-06 00:54:44 -0400] coderanger: digitalchild: Eh, writing your own cookbooks is totally fine
[2014-06-06 00:54:54 -0400] coderanger: In fact I recommend it in a lot of cases
[2014-06-06 00:55:03 -0400] digitalchild: coderanger: yeah i want to learn but i need to get this base stuff done
[2014-06-06 00:55:06 -0400] coderanger: a simple cookbook that does just what you want will be far easier in the long term
[2014-06-06 00:55:15 -0400] digitalchild: ive decided base will be one cookbook with sub recipes for each of the old cookbooks i had
[2014-06-06 00:55:37 -0400] digitalchild: cause its stuff like, base tools, firewall rules, monitoring stuff
[2014-06-06 00:55:54 -0400] digitalchild: that every single machine will have so having 22 recipes separate seems a bit silly for this use case
[2014-06-06 00:58:21 -0400] coderanger: Either way works :)
[2014-06-06 00:58:38 -0400] coderanger: I tend to make a lot of little cookbooks because they are easier to test in small chunks
[2014-06-06 00:59:14 -0400] digitalchild: yeah, well this is all from a 200+ line shell script that hasn't really changed in 2 years.. lol
[2014-06-06 01:01:08 -0400] coderanger: baby steps :)
[2014-06-06 01:01:35 -0400] digitalchild: yup
[2014-06-06 01:03:19 -0400] digitalchild: if i dont use roles, how can i do node.run_list.roles.include('somerole') ?
[2014-06-06 01:03:31 -0400] digitalchild: run_list.recipe.include ?
[2014-06-06 01:07:58 -0400] coderanger: digitalchild: node['recipes'].include?('something')
[2014-06-06 01:08:06 -0400] digitalchild: ok thanks
[2014-06-06 01:10:55 -0400] digitalchild: what are the thoughts on prefacing everything with cookbook- ?
[2014-06-06 01:11:22 -0400] nubCakes: I'm looking to use chef to deploy a rails app, could someone point me in the right direction?
[2014-06-06 01:12:58 -0400] coderanger: digitalchild: For the name or in the git repo URL?
[2014-06-06 01:13:48 -0400] robawt: coderanger: paypal sent ;)
[2014-06-06 01:13:53 -0400] coderanger: robawt: Thanky :)
[2014-06-06 01:14:12 -0400] robawt: it's only a couple cups of coffee but who doesn't deserve that, right?
[2014-06-06 01:14:36 -0400] digitalchild: in the gitrepo
[2014-06-06 01:15:37 -0400] nubCakes: is the deploy resource the best way to deploy a rails app with chef?
[2014-06-06 01:16:47 -0400] coderanger: digitalchild: Depends on your setup, in github I usually make a separate foo-cookbooks org
[2014-06-06 01:16:52 -0400] coderanger: nubCakes: No, use a git resource
[2014-06-06 01:17:28 -0400] digitalchild: coderanger: ok
[2014-06-06 01:19:25 -0400] nubCakes: coderanger: after I use the git resource, how do I run my tasks like rake, migrations, etc...
[2014-06-06 01:20:00 -0400] coderanger: nubCakes: execute resources :)
[2014-06-06 01:20:23 -0400] coderanger: nubCakes: Also I highly recommend not running migrations from Chef, its not something that can be easily done in a convergent manner
[2014-06-06 01:20:52 -0400] nubCakes: coderanger: so why does the deploy resource exist, when it clearly states it's meant to mimic capistrano
[2014-06-06 01:21:11 -0400] coderanger: nubCakes: Thats a very long story, but basically it seemed like a good idea at the time
[2014-06-06 01:21:31 -0400] coderanger: ("the time" being ~5 years ago)
[2014-06-06 01:21:50 -0400] nubCakes: coderanger: this doesn't logically make sense to me, i thought we were trying to automate things, yet your telling me not to automate migrations?
[2014-06-06 01:21:59 -0400] coderanger: nubCakes: If you would like help with app deployment in Chef, I offer consulting and training services
[2014-06-06 01:22:17 -0400] coderanger: nubCakes: No, you should automate it, but just don't run it from Chef, run it from your orchestration tool (rundeck, fabric, etc)
[2014-06-06 01:22:50 -0400] coderanger: nubCakes: Chef excels at things which are convergent, but migrations are very procedural and have a lot of side effects
[2014-06-06 01:23:03 -0400] coderanger: So they just don't fit super well in an idempotent system
[2014-06-06 01:23:12 -0400] nubCakes: coderanger: if chef is suppose to whip up awesome, i would assume migrations would be considered awesome as well
[2014-06-06 01:23:43 -0400] coderanger: nubCakes: Chef is not a solution for 100% of problems, it also doesn't handle server provisioning
[2014-06-06 01:23:50 -0400] coderanger: nubCakes: Use tools for what they are best at :)
[2014-06-06 01:24:10 -0400] coderanger: nubCakes: You can certainly run your migrations from a chef execute block, I just don't think its an optimal solution
[2014-06-06 01:25:32 -0400] nubCakes: coderanger: it might not be optimal, but we're not really talking about a critically important app, I'm simply trying to automate the steps it takes to provision and deploy a rails app so the non rails gurus can run it
[2014-06-06 01:26:13 -0400] coderanger: nubCakes: Exactly how non-optimal depends entirely on your specific situation, it might not be a big deal for you :)
[2014-06-06 01:26:36 -0400] coderanger: If its a high-traffic production app, very bad. if its a development VM, very much fine.
[2014-06-06 01:26:40 -0400] nubCakes: coderanger: so tell me why I shouldn't use deploy resource
[2014-06-06 01:27:00 -0400] coderanger: nubCakes: If you would like help with this stuff, as I said, I offer training and consulting services
[2014-06-06 01:27:30 -0400] nubCakes: coderanger: this is an open source app where I'm trying to give back to the community, not going to pay for giving back
[2014-06-06 01:27:31 -0400] coderanger: but the short version is 1) its overly complex 2) the callback hooks don't work like normal recipe code and 3) rollbacks don't usually work correctly so errors during deploy can leave you screwed
[2014-06-06 01:29:18 -0400] coderanger: #3 has improved in recent releases, but it is still a concern
[2014-06-06 01:29:44 -0400] nubCakes: coderanger: those 3 items you mentioned are not a concern to me in my use case
[2014-06-06 01:30:09 -0400] nubCakes: coderanger: well overly complex is a concern :D
[2014-06-06 01:31:54 -0400] coderanger: nubCakes: You can disregard my advice as you wish, but the recommendation stands
[2014-06-06 01:32:48 -0400] nubCakes: coderanger: i appreciate and respect the advice, but i sometimes feel that the advice is overkill when functionality is more important than elegance
[2014-06-06 01:54:59 -0400] jkline: hi. I would like to include the name and the version of the current recipe inside a template, is that possible?
[2014-06-06 01:56:35 -0400] jkline: Its really hard to search online for that, because render cookbook version is very generic words
[2014-06-06 02:33:21 -0400] storme_away: is there a way to get the chef-client service to prefer the chef-client from chef rather that chefdk?
[2014-06-06 02:33:32 -0400] stormerider: rather than*
[2014-06-06 02:38:11 -0400] stormerider: ah, changing the symlink for /usr/bin/chef-client to point to /opt/chef/bin/chef-client seems to be the easiest solution for the moment.
[2014-06-06 02:39:57 -0400] drag00n: anyone familiar with this
[2014-06-06 02:40:02 -0400] drag00n: https://www.irccloud.com/pastebin/2wTdAR9w
[2014-06-06 02:40:53 -0400] drag00n: I blew away the machine and now I get this
[2014-06-06 02:48:27 -0400] chernjie: is there some quick example on how to use environments?
[2014-06-06 02:58:34 -0400] coderanger: jklare: Doable, but complex
[2014-06-06 02:59:02 -0400] coderanger: stormerider: Or just lock the path used to the real chef-client binary
[2014-06-06 02:59:22 -0400] coderanger: drag00n: Are you using bundler?
[2014-06-06 02:59:29 -0400] coderanger: chernjie: in what way?
[2014-06-06 02:59:46 -0400] stormerider: coderanger: short of rewinding the template used by the chef-client cookbook to change it away from /usr/bin/chef-client, how would i do that?
[2014-06-06 03:00:16 -0400] coderanger: stormerider: https://github.com/opscode-cookbooks/chef-client/blob/master/attributes/default.rb#L43
[2014-06-06 03:00:38 -0400] stormerider: ah, didnt see that in the readme docs
[2014-06-06 03:01:40 -0400] drag00n: coderanger: yes
[2014-06-06 03:01:54 -0400] coderanger: drag00n: Do you have kitchen-vagrant in your gemfile?
[2014-06-06 03:02:14 -0400] stormerider: thanks coderanger
[2014-06-06 03:54:15 -0400] CloCkWeRX: howdy: knife solo + current berkshelf, seeing terrible performance uploading my kitchen (sent 2,724 bytes  received 982 bytes  60.26 bytes/sec !). Any recommendations on determining where the problem is (regression in knife solo, something weird with my environment, other?)
[2014-06-06 04:00:58 -0400] chernjie: coderanger: I want the same chef server to manage multiple similar environments, prod/staging/dev, each one identical but different recipe
[2014-06-06 04:01:18 -0400] chernjie: I have read through this: http://docs.opscode.com/essentials_environments.html but I am now more confused than ever
[2014-06-06 04:14:35 -0400] coderanger: chernjie: What do you mean by "different recipe"
[2014-06-06 04:26:25 -0400] chernjie: s/recipe/configurations/
[2014-06-06 04:26:41 -0400] chernjie: sorry multi-tasking mess up my vocab
[2014-06-06 04:27:10 -0400] chernjie: s/mess/messed/
[2014-06-06 05:21:48 -0400] stanchan: can anyone confirm if a notifies will get executed if there is guard in force for a specific resource block?
[2014-06-06 05:49:22 -0400] ashmckenzie: hi, are multiple actions supported? e.g
[2014-06-06 05:49:31 -0400] ashmckenzie: user 'test' do
[2014-06-06 05:49:31 -0400] ashmckenzie:   action [ :create, :lock ]
[2014-06-06 05:49:32 -0400] ashmckenzie: end
[2014-06-06 05:53:31 -0400] coderanger: yep
[2014-06-06 05:53:39 -0400] coderanger: ashmckenzie: They will be run in order
[2014-06-06 05:54:10 -0400] ashmckenzie: thanks @coderanger :)
[2014-06-06 05:58:48 -0400] stanchan: can anyone confirm if a notifies will get executed if there is guard in force for a specific resource block?
[2014-06-06 06:03:47 -0400] coderanger: stanchan: No, notifications will only fire if the resource "changes"
[2014-06-06 06:03:54 -0400] coderanger: where change is defined differently for each resource
[2014-06-06 06:04:56 -0400] stanchan: so it blocks completey on a not_if/only_if
[2014-06-06 07:29:32 -0400] juanluisrp: hello, I'm trying to upload some cookbooks and I'm getting this error http://pastebin.com/XkMYgnyd
[2014-06-06 07:30:08 -0400] juanluisrp: E, [2014-06-05T08:45:51.235553 #1588] ERROR -- : Cookbook file providers/entry.rb has a ruby syntax error:
[2014-06-06 07:31:01 -0400] juanluisrp: I think this file is in hostfile cookbook
[2014-06-06 07:39:49 -0400] coderanger: juanluisrp: Whats that file look like?
[2014-06-06 07:51:50 -0400] juanluisrp: coderanger, it is exactly this file https://github.com/customink-webops/hostsfile/blob/master/providers/entry.rb
[2014-06-06 07:53:52 -0400] BryanWB: hey folks, occasionally I get 403 errors from the chef server when downloading a template file during converge
[2014-06-06 07:53:59 -0400] BryanWB: anyone else seen that?
[2014-06-06 07:54:36 -0400] coderanger: BryanWB: Same question as last time, is it at the end of a very long converge
[2014-06-06 07:54:56 -0400] BryanWB: coderanger: hmm, possibly
[2014-06-06 07:55:10 -0400] BryanWB: coderanger: sorry for missing your earlier reply
[2014-06-06 07:55:33 -0400] coderanger: BryanWB: chef-server generates all the signed URLs when the cookbook metadata is grabbed at the start, but the URLs have an expiry time
[2014-06-06 07:55:48 -0400] BryanWB: coderanger: interesting
[2014-06-06 07:55:50 -0400] coderanger: juanluisrp: Hmm, what version of Ruby are you using?
[2014-06-06 07:57:14 -0400] juanluisrp: coderanger, that error comes from server or from berkshelf?
[2014-06-06 07:57:50 -0400] coderanger: juanluisrp: Locally, the server never evaluates files
[2014-06-06 07:58:58 -0400] juanluisrp: coderanger, I'm using Chefdk
[2014-06-06 07:59:13 -0400] juanluisrp: vagrant@precise64:~$  /opt/chefdk/embedded/bin/ruby --version
[2014-06-06 07:59:16 -0400] juanluisrp: ruby 2.1.1p76 (2014-02-24 revision 45161) [x86_64-linux]
[2014-06-06 07:59:52 -0400] juanluisrp: but also vagrant@precise64:~$ ruby --version is ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]
[2014-06-06 08:00:34 -0400] juanluisrp: coderanger I don't know which one is berkshelf using
[2014-06-06 08:00:43 -0400] coderanger: juanluisrp: $ ruby -c entry.rb
[2014-06-06 08:00:44 -0400] coderanger: Syntax OK
[2014-06-06 08:01:45 -0400] juanluisrp: it fails with ruby 1.8
[2014-06-06 08:02:05 -0400] coderanger: juanluisrp: What happens when you run `which berks`
[2014-06-06 08:02:06 -0400] juanluisrp: maybe should I uninstall system ruby?
[2014-06-06 08:02:50 -0400] coderanger: juanluisrp: The error sounds like its Ruby 1.8 and so not parsing the new hash syntax
[2014-06-06 08:02:58 -0400] coderanger: but the traceback says ruby 2.1
[2014-06-06 08:29:27 -0400] jlrodriguez: coderanger, I'm installing chefdk in a clean environtment whithout any previous ruby installation, let's see if it works there. Thank you
[2014-06-06 11:26:55 -0400] SKC: need to ask a question, is it OK to update chef-client on all the clients should i update chef / knife-solo on the server before ? i am struggeling with getting chef-11.6.0-1.el5 working with chef-client 11.12.4 it's giving SSL errors and saying starting chef, waiting for 300 seconds and then it does timeout.
[2014-06-06 11:28:04 -0400] SKC: bb in 5 minutes.
[2014-06-06 11:36:21 -0400] SKC: b
[2014-06-06 11:36:47 -0400] HontoNoRoger: hello
[2014-06-06 11:37:35 -0400] HontoNoRoger: I just saw that there's no chef-server package available for Ubuntu 14.04 LTS ... how do I install the chef server on this platform?
[2014-06-06 11:54:13 -0400] srenatus: when having an execute resource with an environment, does that env have any effect on the `only_if "my-shell-test"` of the resource?
[2014-06-06 12:24:50 -0400] anthonyacquanita: SKC: I've used chef-client 0.10 with chef 11 server what is the issue?
[2014-06-06 12:36:23 -0400] anthonyacquanita: anyone install berkshelf api server on a private chef-server?  any conflicts or concerns?
[2014-06-06 12:56:57 -0400] SKC: anthonyacquanita: i have updated chef-client from 11.10.4 to 11.12.04 and now it's saying SSL validation of HTTPS requests is disabled. HTTPS connections are still
[2014-06-06 12:57:00 -0400] SKC: encrypted, but chef is not able to detect forged replies or man in the middle
[2014-06-06 12:57:10 -0400] SKC: attacks.
[2014-06-06 12:58:31 -0400] SKC: anthonyacquanita: also it's saying "Starting Chef Client, version 11.12.4" and hanging for 300 seconds.
[2014-06-06 12:59:26 -0400] anthonyacquanita: what is in your /etc/chef/client.rb ... sounds like it can't connect to your chef server
[2014-06-06 13:00:54 -0400] SKC: anthonyacquanita: i have tried to debug on this using strace but no useful information other than wait() it has been installed using knife-solo prepare from chef server, and then i have updated the client using 'curl -L https://www.opscode.com/chef/install.sh | sudo bash'
[2014-06-06 13:01:56 -0400] anthonyacquanita: can that host connect to chef_server_url ?
[2014-06-06 13:03:22 -0400] SKC: anthonyacquanita: yes it can connect when i am using the old chef-client 11.10.4 but not on 11.12.4 i think something has changed now that it's giving ssl errors.
[2014-06-06 13:04:03 -0400] anthonyacquanita: knife ssl check -c /etc/chef/client.rb
[2014-06-06 13:04:10 -0400] anthonyacquanita: what does that say?   same issue?
[2014-06-06 13:07:44 -0400] SKC: anthonyacquanita: ERROR: The SSL cert is signed by a trusted authority but is not valid for the given hostname
[2014-06-06 13:08:01 -0400] SKC: anthonyacquanita: that might have helped me.
[2014-06-06 13:09:12 -0400] SKC: anthonyacquanita: Thanks for the help... i am off for vacation in 10 minutes i will check out the certs on the servers.
[2014-06-06 13:28:33 -0400] gauravarora: hi, is there a chef cookbook that will allow me to add environment variables to bash_profile for users?
[2014-06-06 13:28:42 -0400] gauravarora: specifically new users I add
[2014-06-06 13:33:08 -0400] workmad3: gauravarora: you could always drop a file with your env var declarations into /etc/profile.d
[2014-06-06 13:33:21 -0400] workmad3: gauravarora: assuming you're using a distro that loads that for login shells anyway ;)
[2014-06-06 13:33:33 -0400] gauravarora: using ubuntu :)
[2014-06-06 13:33:48 -0400] workmad3: gauravarora: then yes... just drop a file into /etc/profile.d ;)
[2014-06-06 13:33:59 -0400] gauravarora: ok, let me try that
[2014-06-06 13:34:00 -0400] workmad3: gauravarora: /etc/profile.d/important_environment.sh ;)
[2014-06-06 13:34:07 -0400] gauravarora: hehe
[2014-06-06 13:37:45 -0400] workmad3: gauravarora: I quite copying that setup as a template for my own .bashrc and .zshrc files btw... create .profile.d, .bashrc.d and .zshrc.d directories with files for all of my bash stuff, and then I can drop in a blanket .bashrc and .zshrc file that simply sources .profile.d and then the appropriate rc.d directory
[2014-06-06 13:38:25 -0400] workmad3: gauravarora: makes it easier to drop stuff in place with chef too... as rather than having to selectively modify a file, you can just drop a new file into a directory (potentially with action :create_if_missing if you want to preserve user mods)
[2014-06-06 13:39:39 -0400] gauravarora: workmad3: thanks, doing that now
[2014-06-06 13:41:00 -0400] workmad3: gauravarora: one of these days I'll turn that into a /etc/skel setup rather than running it across all users :) but that would then only touch new users rather than updating existing users so maybe not
[2014-06-06 13:41:38 -0400] smithmb: Is there a nice way to a duplicate/copy a subtree of node, like node['foo']['bar'], to a separate variable?
[2014-06-06 13:42:01 -0400] workmad3: smithmb: does it have to be a duplicate? or just a reference?
[2014-06-06 13:42:18 -0400] smithmb: well, there's gonna be changes to it, and then passed to a template, so I think it has to be a copy
[2014-06-06 13:42:36 -0400] smithmb: I don't want it saved back, and it's gonna be used to do code generation.
[2014-06-06 13:48:11 -0400] workmad3: smithmb: hmm... then I think you're looking at something like: https://gist.github.com/workmad3/9881cb309b49944948be
[2014-06-06 13:48:32 -0400] workmad3: smithmb: not tested that code, I think it's about right but you should definitely test it out a bit first ;)
[2014-06-06 13:48:49 -0400] smithmb: workmad3: thx...I was hoping I could do some sort of clone/dup
[2014-06-06 13:49:11 -0400] workmad3: smithmb: well, you could always add that code as a .dup method on Chef::Mash
[2014-06-06 13:49:32 -0400] smithmb: I might! hehe
[2014-06-06 13:50:32 -0400] workmad3: smithmb: reload the gist, I updated it to monkey-patch dup onto Chef::Mash ;)
[2014-06-06 13:50:48 -0400] smithmb: ah, you're going above & beyond... thanks!
[2014-06-06 13:51:02 -0400] workmad3: smithmb: also, quick warning... that code doesn't handle arrays...
[2014-06-06 13:51:05 -0400] smithmb: kinda seems like I could call to_hash with an empty hash
[2014-06-06 13:51:17 -0400] smithmb: or merge()
[2014-06-06 13:51:20 -0400] smithmb: rather.
[2014-06-06 13:51:42 -0400] workmad3: smithmb: that's pretty much what to_hash for a mash does... but it's not recursive
[2014-06-06 13:51:52 -0400] smithmb: right.
[2014-06-06 13:52:18 -0400] workmad3: smithmb: it might make sense to just .dup everything as you go, rather than just nested Chef::Mash objects
[2014-06-06 13:52:35 -0400] workmad3: smithmb: I'll leave you to play about with it though ;)
[2014-06-06 13:52:38 -0400] smithmb: thanks :D
[2014-06-06 14:14:28 -0400] jayeola: hi chaps. my embedded ruby seems to be getting in the way of installing berkshelf. what can i do?  /opt/chef/embedded/bin/ruby << 1.9.x
[2014-06-06 14:15:27 -0400] dadleyy: If I have a cookbook called "XX" and a resource called "yy", what is the full name I can use to create an instance of that resource? Chef::Resource::XX::yy.new?
[2014-06-06 14:15:59 -0400] dadleyy: I tried Chef::Resource::yy and it didnt seem to like that
[2014-06-06 14:16:15 -0400] dadleyy: the resource is defined with the dsl
[2014-06-06 14:34:43 -0400] kbarry: Anyone here handling CI with git hooks + Teamcity (And other systems)? I'm wanting to chat with someone about their CI structure.
[2014-06-06 15:16:59 -0400] juliancdunn: dadleyy: I believe it is Chef::Resource::XxYy
[2014-06-06 15:17:09 -0400] juliancdunn: where Xx and Yy are the camelcase versions of your cookbook and resource
[2014-06-06 15:17:32 -0400] dadleyy: thank you!
[2014-06-06 15:17:41 -0400] dadleyy: thats right
[2014-06-06 15:17:47 -0400] dadleyy: or at least its how the IIS cookbook dos it
[2014-06-06 15:17:56 -0400] juliancdunn: yep
[2014-06-06 15:18:04 -0400] dadleyy: thanks man
[2014-06-06 15:18:08 -0400] juliancdunn: sure
[2014-06-06 15:30:55 -0400] mondo: coderanger: yesterday you mentioned that 11.10.0+ had fixed the issue where included recipes are searchable.  I updated my client to 11.12.4 and my server to 11.0.12 and it still doesn't work as expected.  Any suggestions?
[2014-06-06 15:34:04 -0400] mondo: coderanger: sorry, nevermind it is working now.  Thanks!
[2014-06-06 15:34:58 -0400] dadleyy: @juliancdunn when making a custom provider/resource and using a "notifies" action against a created instance, the action specified doesnt look like its being run
[2014-06-06 15:35:29 -0400] dadleyy: are there any common things you think I might be missing
[2014-06-06 15:36:23 -0400] dadleyy: I have defined a load_current_resource function
[2014-06-06 15:37:52 -0400] juliancdunn: dadleyy: how are you creating said instance? I was a little confused when you started asking about the generated class name
[2014-06-06 15:38:09 -0400] dadleyy: I'm just using the full name in the load_current_resource function
[2014-06-06 15:38:14 -0400] dadleyy: I'm using DSL in my recipes
[2014-06-06 15:38:24 -0400] dadleyy: winevtlog "something" do
[2014-06-06 15:38:33 -0400] dadleyy: sources node['sources']
[2014-06-06 15:38:36 -0400] dadleyy: etc, etc
[2014-06-06 15:38:59 -0400] dadleyy: the problem I'm solving is that we want to enable one of the windows event logs
[2014-06-06 15:39:14 -0400] dadleyy: but only after the splunk forwarder is installed
[2014-06-06 15:39:32 -0400] dadleyy: because we don't want the logs from provisioning showing up in splunk
[2014-06-06 15:39:42 -0400] Glenjamin: Hi everyone - is there a "standard" way in chef to clean-up after files in something.d/ directories
[2014-06-06 15:39:58 -0400] dadleyy: so I'm planning on using a
[2014-06-06 15:40:06 -0400] Glenjamin: eg. my provider adds a file to .d, but if i rename the file then how do i know to cleanup the old one?
[2014-06-06 15:40:06 -0400] dadleyy: "action :nothing" on the resource definition
[2014-06-06 15:40:12 -0400] dadleyy: and then "notifies :enable"
[2014-06-06 15:40:43 -0400] juliancdunn: dadleyy: gist your code? the recipe and the custom provider
[2014-06-06 15:40:51 -0400] dadleyy: good call
[2014-06-06 15:40:53 -0400] juliancdunn: Glenjamin: try the zap cookbook https://github.com/nvwls/zap
[2014-06-06 15:40:54 -0400] dadleyy: hang on
[2014-06-06 15:41:31 -0400] anthonyacquanita: anyone use the graphite community CB? Can't get it see storage-schema attributes
[2014-06-06 15:42:04 -0400] Glenjamin: juliancdunn: looks exactly like what i wanted - thanks
[2014-06-06 15:47:58 -0400] Hexi: is there already a community cookbook for adding vlan interfaces (handles the 8021q kernel module, installs vlan package, uses vconfig to configure the interface, etc.)?  I did some searching but the terms are generic enough where the results were iffy.
[2014-06-06 15:59:19 -0400] sarkis: so i we have 2 different platforms (a datacenter with dedicated hw and AWS) what's the best way to have different env vars for each of these? i.e. log dir on AWS is on /var/log/ however, if it's on the dedicated hardware it's a different location
[2014-06-06 15:59:32 -0400] sarkis: i was thinking environments is the way to go?
[2014-06-06 15:59:39 -0400] sarkis: not sure where to start..
[2014-06-06 16:00:51 -0400] trilitheus: anthonyacquanita, I'm using it successfully
[2014-06-06 16:00:55 -0400] trilitheus: graphite DB that is
[2014-06-06 16:01:19 -0400] sarkis: would i need to just do the conditional where i'm setting up the logs?
[2014-06-06 16:01:50 -0400] sarkis: and then add nodes to the different envs when i bootstrap with knife
[2014-06-06 16:03:06 -0400] trilitheus: anthonyacquanita, https://gist.github.com/trilitheus/6ffe80d21bee2fc76423 that's how I override the storage schema attributes in my graphite wrapper cookbook
[2014-06-06 16:05:13 -0400] sarkis: hmm this may be the way to go.. http://docs.opscode.com/ohai_custom.html#ohai-custom-plugins
[2014-06-06 16:06:43 -0400] anthonyacquanita: trilitheus: OMG! thanks.  trying now.  pulling hair.
[2014-06-06 16:08:08 -0400] sarkis: anyone got some advice? should i write a ohai plugin that will set the "provider" similar to this: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/cloud.rb
[2014-06-06 16:08:16 -0400] anthonyacquanita: trilitheus: that goes in the attributes.rb and then in the recipe you include graphite and graphite::carbon_aggregator?
[2014-06-06 16:08:35 -0400] sarkis: or go with environments, which i'd need to manually add nodes i believe?
[2014-06-06 16:08:37 -0400] anthonyacquanita: sarkis:  I have this same setup.. stumbled upon using environments
[2014-06-06 16:09:06 -0400] anthonyacquanita: works well.  You can knife ssh to 'chef_environment:my_AWS_site AND role:some_role'
[2014-06-06 16:09:30 -0400] anthonyacquanita: and in CB's if env 'A' do this, if env 'B' do that
[2014-06-06 16:09:32 -0400] surge_: When I run knife ssl check -c .chef/knife.rb from my workstation against my chef server, with ssl_verify_mode :verify_peer in my knife.rb file, for whatever reason it is unable to verify my SSL certificate. Not sure why that is. Im not using a self-signed cert.
[2014-06-06 16:09:35 -0400] sarkis: oh that is interesting..
[2014-06-06 16:10:01 -0400] anthonyacquanita: the ohai ec2 attributes really help too
[2014-06-06 16:10:06 -0400] sarkis: anthonyacquanita: the benefit i see for ohai though
[2014-06-06 16:10:14 -0400] sarkis: anthonyacquanita: i can just set the right vars..
[2014-06-06 16:10:33 -0400] sarkis: i.e. ohai will have a log_dir hint which is set right for whichever env it is..
[2014-06-06 16:10:50 -0400] anthonyacquanita: some nodes don't pick up ec2 so you have to drop a hint
[2014-06-06 16:10:52 -0400] sarkis: no need to fumble with conditionals, and then later remember to remove them/change/modify everywhre
[2014-06-06 16:10:54 -0400] anthonyacquanita: ... beat me to it.
[2014-06-06 16:11:11 -0400] sarkis: k going the ohai plugin route for now
[2014-06-06 16:11:24 -0400] sarkis: i believe you can search on ohai hints with knife ssh?
[2014-06-06 16:11:25 -0400] anthonyacquanita: that was my next step, if env AWS set ec2.json ohai hint
[2014-06-06 16:12:18 -0400] anthonyacquanita: not sure...
[2014-06-06 16:14:18 -0400] trilitheus: anthonyacquanita, yes pretty much - although I'm only calling the graphite default recipe
[2014-06-06 16:15:18 -0400] anthonyacquanita: grrrrr  Readme.md is messing with me then
[2014-06-06 16:16:50 -0400] sarkis: what's a custom usage for this? https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/cloud.rb
[2014-06-06 16:17:04 -0400] sarkis: i'm confused if i tell ohai which provider i am on?
[2014-06-06 16:19:09 -0400] sarkis: think i found one of the "orivder" plugins: https://github.com/opscode/ohai/blob/8890c7f6ac94bc50875726971a6ecc420811e8f7/lib/ohai/plugins/gce.rb
[2014-06-06 16:19:38 -0400] sarkis: provider*
[2014-06-06 16:25:23 -0400] trilitheus: anthonyacquanita, the only other thing I've overriden (apart from timezone) is override['graphite']['carbon']['enable_udp_listener'] = "True"
[2014-06-06 16:25:33 -0400] anthonyacquanita: trilitheus: no such luck keep picking up default from graphite attributes.rb
[2014-06-06 16:25:54 -0400] trilitheus: weird - what your run_list look like?
[2014-06-06 16:26:37 -0400] trilitheus: Are you using chef server?
[2014-06-06 16:26:45 -0400] anthonyacquanita: yes, chef server
[2014-06-06 16:27:27 -0400] anthonyacquanita:  ["m-repos::epel", "m-syslogNG", "m-syslogNG::graphite-stats"]
[2014-06-06 16:27:47 -0400] anthonyacquanita: it put your gist in m-syslogNG/attributes.rb
[2014-06-06 16:28:00 -0400] MikeTLive: Am I completely off my nut when i say that using Git means many small cookbook repos means needing berkshelf to manage it all and ignoring chef ability to manage dependencies
[2014-06-06 16:28:04 -0400] anthonyacquanita: include_recipe "graphite" in m-syslogNG::graphite-stats
[2014-06-06 16:29:07 -0400] anthonyacquanita: Cloning resource attributes for log[[{"name"=>"catchall", "pattern"=>"^.*", "retentions"=>"60:100800,900:63000"}]] from prior resource (CHEF-3694)
[2014-06-06 16:29:11 -0400] trilitheus: Are you bumping versions in between cookbook uploads or using --force?
[2014-06-06 16:29:16 -0400] anthonyacquanita: --force
[2014-06-06 16:29:43 -0400] anthonyacquanita: that cloning line is from a log statement inside my cookbook wrapper
[2014-06-06 16:29:44 -0400] trilitheus: OK I'd check the cookbook cache oin the node and make sure it is actually pulling down your new changes
[2014-06-06 16:30:07 -0400] trilitheus: /var/chef/cache/cookbooks/m-syslogNG
[2014-06-06 16:30:32 -0400] anthonyacquanita: is it node.override or just override ?
[2014-06-06 16:30:42 -0400] trilitheus: if in the attributes file just override
[2014-06-06 16:30:57 -0400] trilitheus: think node.override if done in a recipe
[2014-06-06 16:31:28 -0400] anthonyacquanita: tried it both ways... doesn't show up in knife node -a   now
[2014-06-06 16:31:51 -0400] trilitheus: knife node show (yournode) -a graphite
[2014-06-06 16:32:51 -0400] trilitheus: check the local cache - it should update as checksum for cookbook changed but I've had at least one occasion where I;ve had to remove the cached cookbook if I've uploaded a new one with same version
[2014-06-06 16:32:53 -0400] anthonyacquanita: it shows the default !!! ??
[2014-06-06 16:33:12 -0400] anthonyacquanita: will do...
[2014-06-06 16:33:21 -0400] x0nic: Can anyone tell me how to debug cookbook resolving issues? I get a timeout connecting to chef on "resolving cookbooks for runlist" If I look on my chef server, beam.smp is pinned at 200%
[2014-06-06 16:33:36 -0400] trilitheus: z0nic chef server version?
[2014-06-06 16:33:59 -0400] trilitheus: I had exactly same and just upgraded to 11.1.1 open source version and all issues went away
[2014-06-06 16:34:33 -0400] x0nic: 11.0.11-1.ubuntu.12.04
[2014-06-06 16:34:42 -0400] trilitheus: chef reverted to using the gecode dep solver at 11.1.0
[2014-06-06 16:34:54 -0400] trilitheus: if you can - I'd suggest upgrading
[2014-06-06 16:35:11 -0400] x0nic: ah ok, nice. ill try an upgrade. Thx!
[2014-06-06 16:35:16 -0400] trilitheus: anthonyacquanita, got to go - hope you sort it
[2014-06-06 16:35:30 -0400] trilitheus: it works on my machine ;)
[2014-06-06 16:35:47 -0400] anthonyacquanita: thanks!
[2014-06-06 16:40:38 -0400] sarkis: http://docs.opscode.com/ohai_custom.html : where does one install custom ohai plugins and make it available to all nodes?
[2014-06-06 16:43:45 -0400] sarkis: i do have a "common" cookbook i guess it could go in there
[2014-06-06 16:58:55 -0400] surge_: When running chef-client from a Mac, where does it expect the client.rb file to exist?
[2014-06-06 16:59:13 -0400] mjuszczak: Anyone know in test kitchen how I can override default['node']['firewall']['public_ports'] = []?  I'm trying this and it isn't working: http://pastebin.com/dZ7M0bDM -- Do I need to specify it as an array somehow/
[2014-06-06 17:15:46 -0400] jidar: mjuszczak: = ['']?
[2014-06-06 17:16:03 -0400] jidar: just a guess though
[2014-06-06 17:17:41 -0400] anthonyacquanita: OMG I'm a dumbass.  for history, if you're reading this, I had my attributes.rb in the wrong place! -- graphite cookbook now working
[2014-06-06 17:24:00 -0400] phantasm66: hey chefs.. how does one use a custom module in a library file, in another library file within the same cookbook
[2014-06-06 17:24:59 -0400] phantasm66: i have 2 under the same module namespace, but when i call the other module.method directly in the other library, i get the typical ruby "uninitialized constant <module name>"
[2014-06-06 17:25:10 -0400] phantasm66: i even tried to include, then call
[2014-06-06 17:25:36 -0400] Otterley: usually it's because you're not including the mixing into the Chef resource class
[2014-06-06 17:25:51 -0400] Otterley: e.g. class Chef::Resource::Template; include MyMixin; end
[2014-06-06 17:26:31 -0400] Otterley: though this sounds somewhat different, can you show us the code?
[2014-06-06 17:29:31 -0400] phantasm66: @Otterley: the main module i am calling (it's a library):
[2014-06-06 17:29:32 -0400] phantasm66: https://gist.github.com/phantasm66/38358b8ead93924d030f
[2014-06-06 17:29:51 -0400] phantasm66: and then an example of me calling it (or trying to) from another library in the same cookbook:
[2014-06-06 17:30:47 -0400] phantasm66: https://gist.github.com/phantasm66/e6dfa94071bbad54e728
[2014-06-06 17:31:52 -0400] phantasm66: so i am trying to call Profiles::Gem.initialize_gem('docker-api') while in the same Profiles module namespace
[2014-06-06 17:32:14 -0400] phantasm66: or at least i think i am in the same Profiles namespace ;)
[2014-06-06 17:32:47 -0400] phantasm66: i have a doctor's appt i have to split for... i'll check back in a bit :)
[2014-06-06 17:32:54 -0400] phantasm66: thanks in advance for yer help
[2014-06-06 17:36:24 -0400] Otterley: phantasm66, you're definitely missing an include.  modules aren't automatically included into other Classes or Modules even if the files containing them are included.
[2014-06-06 17:41:39 -0400] bmhatfield: Does anyone know where I can find a changelog for chef 11.1.1?
[2014-06-06 17:41:43 -0400] bmhatfield: (server)
[2014-06-06 17:41:57 -0400] bmhatfield: There's a jump to 11.1 there that I hadn't planned on taking, I don't know what's different.
[2014-06-06 17:44:54 -0400] bmhatfield: Found it.
[2014-06-06 17:44:55 -0400] bmhatfield: http://docs.opscode.com/release/osc_11-1/release_notes.html
[2014-06-06 17:55:44 -0400] sarkis: any of the experts up yet? coderanger? jtimberman? :)
[2014-06-06 18:22:13 -0400] Alayde: Hey folks, I have a question about the yum-epel cookbook. We're currently including it in one of our recipes, and while the run completes without issue in test kitchen (on centos 6.4), the actual chef-solo run is failing on the node with this error "undefined method `baseurl' for Chef::Resource::YumRepository".
[2014-06-06 18:24:28 -0400] r3dk1ng: Is it possible to print a variable in a Chef Recipe to the screen during a chef-client run?
[2014-06-06 18:24:31 -0400] gfunky: When upgrading from chef 10 to 11 clients, would anyone be concerned about using "/opt/chef/embedded/bin/gem install chef -v 11.8.2" embedded to update vs grabbing a new omnibus package?
[2014-06-06 18:24:34 -0400] moleWork: hello, i'm trying to use this https://github.com/opscode-cookbooks/aws/blob/master/providers/ebs_raid.rb on aws opsworks but keep getting "ERROR: aws_ebs_volume[sdi1] (/var/lib/aws/opsworks/cache/cookbooks/aws/providers/ebs_raid.rb line 339) had an error: RuntimeError: Volume  no longer exists" can anyone verify if this recipe works with chef-solo on opsworks
[2014-06-06 18:24:39 -0400] moleWork: i can't figure out why it doesn't work
[2014-06-06 18:24:40 -0400] gfunky: Lol. Bam. 3 questions
[2014-06-06 18:26:18 -0400] Alayde: r3dk1ng: I'm fairly certain that, inside your recipe, you can do: log "#{variable}"
[2014-06-06 18:26:34 -0400] r3dk1ng: sweet thanks!
[2014-06-06 18:27:42 -0400] gfunky: r3dk1ng: we use Chef::Log.info "blah blah blah"
[2014-06-06 18:28:06 -0400] r3dk1ng: gotcha
[2014-06-06 18:28:11 -0400] r3dk1ng: thanks!  it worked!
[2014-06-06 18:29:11 -0400] chef362: is it possible to access a chef attribute from a stand-alone ruby script which is run by chef ?
[2014-06-06 18:29:39 -0400] Alayde: chef362: You could always pass the attribute to the script when calling it
[2014-06-06 18:30:01 -0400] chef362: that would put the data on the command line. it is password/account.
[2014-06-06 18:30:38 -0400] brendan__: Hi guys, what's the recommended way to do orchestration like things in chef? Suppose I'm setting up a load balancer config, and I want to dynamically list the hosts it should be using as backends. Is it best to do a search on role or do a search based on node attributes, or some other method?
[2014-06-06 18:32:26 -0400] Alayde: brendan__: On our project, we search against the chef sever based on roles. It works wonderfully
[2014-06-06 18:32:46 -0400] jidar: I was thinking of doing something like etcd/confd
[2014-06-06 18:33:35 -0400] brendan__: Alayde: Cool. That's the way I was thinking about doing it, but wasn't sure if there was a better way.
[2014-06-06 18:34:14 -0400] Alayde: chef362: So what exactly are you wanting to do with the ruby script?
[2014-06-06 18:35:41 -0400] jidar: https://speakerdeck.com/lusis/cross-node-orchestration-with-chef-and-noah
[2014-06-06 18:35:58 -0400] jidar: this is basically suggesting the same thing but replace noah with confd/etcd
[2014-06-06 18:36:32 -0400] jidar: I'm wondering how people deal with dead nodes and dynamic removal of nodes, wait for chef runs? etc.
[2014-06-06 18:40:45 -0400] chef362: looks like one way is to generate the cfg from an erb with the cfg having embedded attributes. then the script reads the cfg. that's all i can think of. i don't think there's a direct way, other than the insecure direct/cli, to get at the attributes from a standalone script.
[2014-06-06 18:42:14 -0400] r3dk1ng: Another question, how do you print a node attribue using log?
[2014-06-06 18:42:31 -0400] CPS: r3dk1ng: treat it as a string?
[2014-06-06 18:43:04 -0400] Alayde: r3dk1ng: Depends on the attribute I suppose, but again you can use log. So like: log "#{node.ip_address}" or log "node[:nginx][:upstream]"
[2014-06-06 18:43:40 -0400] r3dk1ng: ok
[2014-06-06 18:43:43 -0400] r3dk1ng: thanks again
[2014-06-06 18:45:40 -0400] gyoza: aww yea its the yellowking
[2014-06-06 18:45:49 -0400] gyoza: gonna try to kill woody harrelson?
[2014-06-06 18:45:55 -0400] gyoza: :)
[2014-06-06 18:46:44 -0400] gyoza: my weekend starts in 14 minuts....
[2014-06-06 19:00:06 -0400] drag00n: https://www.irccloud.com/pastebin/gSe3cJ66
[2014-06-06 19:03:16 -0400] lebrinkma: any news on https://tickets.opscode.com/browse/CHEF-5305?
[2014-06-06 19:07:24 -0400] mmzyk: lebrinkma What kind of news are you looking for?
[2014-06-06 19:08:39 -0400] mmzyk: Debian isnt officially supported, although we do have a patch to fix what we broke. It hasnt yet been merged down or been released, although it would be possible to do a build yourself and apply it.
[2014-06-06 19:09:17 -0400] mmzyk: I would like to do a release to address that, but right now there is a lot on the plate.
[2014-06-06 19:14:43 -0400] lebrinkma: mmtyk: I know that Debian isn't officially supported. I would like to know when that patch gets shipped.
[2014-06-06 19:16:20 -0400] mmzyk: lebrinkma Okay. Theres no ETA on it currently. Its really an issue of if I can make the time to get it done along with other work Im currently doing that has a deadline attached. Ill see what I can do about getting it out.
[2014-06-06 19:17:27 -0400] lebrinkma: mmzyk: thanks for the info.
[2014-06-06 19:18:57 -0400] bricker: Is it possible to specify a dependency in a recipe? I'm dynamically loading recipes from other cookbooks (via an array), and don't want to have to add a dependency every time I add something to that array
[2014-06-06 19:19:20 -0400] bricker: Or otherwise load dependencies dynamically
[2014-06-06 19:32:49 -0400] someara: bricker you have to specify each cookbook you depend on in metadata.rb
[2014-06-06 19:42:54 -0400] veron: Anyone have experience with the kitchen-ec2 driver? This cookbook I downloaded comes with a .kitchen.ec2.yml file and I"m not sure how to have kitchen use it.
[2014-06-06 19:43:51 -0400] anthonyacquanita: veron:  doesn't mean you have to use it.. is it something aws specific ?
[2014-06-06 19:44:07 -0400] veron: yes, I want to use it is the thing
[2014-06-06 19:44:48 -0400] anthonyacquanita: do you have test-kitchen setup and working?
[2014-06-06 19:44:58 -0400] veron: yes, everything is set
[2014-06-06 19:45:04 -0400] r3dk1ng: If I am on a chef client node, how can I find out what my current node attribues are?
[2014-06-06 19:45:14 -0400] veron: should I just rename the .kitchen.ec2.yml to .kitchen.yml and $ kitchen converge ?
[2014-06-06 19:47:19 -0400] r3dk1ng: If I am on a chef client node, how can I find out what my current node attribues are?
[2014-06-06 19:47:43 -0400] Alayde: r3dk1ng: Well there's a general list of 'em here http://docs.opscode.com/ohai.html, but if you wanted to have everything listed...man, I'm not sure. Possibly launching a chef shell (shef) and poking around? I've not had much practice doing that
[2014-06-06 19:48:08 -0400] CPS: you can also just run ohai
[2014-06-06 19:48:15 -0400] CPS: redirect the output to a file, it's pretty big
[2014-06-06 19:48:29 -0400] Alayde: ^^ That sounds like a far better idea
[2014-06-06 19:48:59 -0400] CPS: pretty sure that doesn't include everything that chef would set to the node during a converge though
[2014-06-06 19:49:19 -0400] veron: r3dk1ng: you can do $chef-shell  client     to put chef-shell in client mode. You can spit out all the node attributes with puts node.to_json
[2014-06-06 19:49:29 -0400] veron: which includes recipe node attributes
[2014-06-06 19:49:35 -0400] veron: or node.to_yaml
[2014-06-06 19:49:39 -0400] veron: if you prefer yaml
[2014-06-06 19:51:06 -0400] r3dk1ng: CPS thanks, you are right, it doesn't cover everything as I just found out
[2014-06-06 19:51:06 -0400] anthonyacquanita: veron:  to get it up and running yes, I'm not sure how the .kitchen.yml.local and other yml files merge together
[2014-06-06 19:51:25 -0400] veron: r3dk1ng: see my response
[2014-06-06 19:51:26 -0400] CPS: chef-shell is probably what you want then
[2014-06-06 19:52:30 -0400] anthonyacquanita: Both .kitchen.yml and .kitchen.local.yml files are pre-processed through ERB which can help to factor out secrets and credentials. For example:
[2014-06-06 19:52:30 -0400] anthonyacquanita: that's from https://github.com/test-kitchen/kitchen-ec2
[2014-06-06 19:52:33 -0400] r3dk1ng: i did thanks
[2014-06-06 19:53:24 -0400] veron: r3dk1ng - if you're using enterprise chef, you can just do $ knife node show my.node.name -f json | less
[2014-06-06 19:54:17 -0400] veron: anthonyacquanita: thank you  for now I just renamed the .kitchen.ec2.yml to .kitchen.yml . ghetto, but it works. I thought I could just do something like $ kitchen converge driver=ec2 or something
[2014-06-06 20:01:20 -0400] r3dk1ng: So here's why I am asking... I am using the aws-sdk, I am working on my own cookbook.  I have created a recipe in my cookbook called elb.   Basically what I want it to do it, to create a new EBS volume, and then attach it.  The problem I am running into, is that it does create the volume, but it won't attach it because it think the volume is no there.   Even though it is...
[2014-06-06 20:01:21 -0400] r3dk1ng: I am using open source cheg
[2014-06-06 20:01:21 -0400] r3dk1ng: chef
[2014-06-06 20:01:23 -0400] anthonyacquanita: veron: All I see are kitchen.yml and kitchen.local.yml   Have to dive into the code or someone else needs to speak up about config parsing
[2014-06-06 20:02:45 -0400] veron: Thanks again anthonyacquanita. The documentation is sparse on test-kitchen, and if you're googling for it, half the stuff you find is real life kitchen supplies
[2014-06-06 20:05:24 -0400] anthonyacquanita: yup.  grep yml on  test-kitchen-1.2.1/lib/kitchen/loader/yaml.rb and you'll see it's just .kitchen.yml and the local one
[2014-06-06 20:13:06 -0400] phantasm66: Hey chefs: as a way to ensure a gem is present for a cookbook's custom libraries - i have seen this example in the chef docs:
[2014-06-06 20:13:07 -0400] phantasm66: https://gist.github.com/phantasm66/3be8de617a7c789329db
[2014-06-06 20:13:11 -0400] phantasm66: what is run_context ?
[2014-06-06 20:16:21 -0400] coderanger: phantasm66: No, you can't do it from inside a library easily
[2014-06-06 20:16:38 -0400] phantasm66: hrmm
[2014-06-06 20:16:50 -0400] coderanger: phantasm66: You should use a chef_gem in your recipe code, and delay any require's to happen only when the code is called
[2014-06-06 20:17:28 -0400] phantasm66: i have providers from LWRPs that rely on a gem being on a system
[2014-06-06 20:20:01 -0400] phantasm66: so, i need the gem *there* during compile time
[2014-06-06 20:20:09 -0400] phantasm66: not sure how to best do that
[2014-06-06 20:20:17 -0400] coderanger: You can't
[2014-06-06 20:20:27 -0400] coderanger: Short of doing it outside of Chef during the bootstrap process
[2014-06-06 20:21:02 -0400] phantasm66: can i install a gem during compile phase from within a provider?
[2014-06-06 20:21:07 -0400] phantasm66: with run_action ?
[2014-06-06 20:21:35 -0400] phantasm66: @@coderanger ^
[2014-06-06 20:22:42 -0400] davidordave: Is berks 2 no longer supported whatsoever?
[2014-06-06 20:23:17 -0400] coderanger: davidordave: Correct
[2014-06-06 20:23:20 -0400] coderanger: phantasm66: Yes, you can do it inside the provider
[2014-06-06 20:23:27 -0400] coderanger: phantasm66: chef_gem always happens at compile time
[2014-06-06 20:24:14 -0400] phantasm66: ah, ok... @coderanger
[2014-06-06 20:24:14 -0400] phantasm66: http://docs.opscode.com/resource_chef_gem.html
[2014-06-06 20:24:17 -0400] phantasm66: genius!
[2014-06-06 20:24:17 -0400] phantasm66: thanks :)
[2014-06-06 20:26:38 -0400] coderanger: phantasm66: Sorry, I should be clear, there are two ways to use the term "compile time" there
[2014-06-06 20:26:40 -0400] coderanger: phantasm66: There is the actual compile time of the file, when ruby read the file and builds the class object
[2014-06-06 20:26:42 -0400] coderanger: phantasm66: and there is the chef compile time that happens as part of the two pass converge process
[2014-06-06 20:26:43 -0400] coderanger: phantasm66: chef_gem lets you install a gem during the latter, not the former
[2014-06-06 20:26:46 -0400] phantasm66: which is what i was hoping for
[2014-06-06 20:26:47 -0400] phantasm66: great
[2014-06-06 20:26:48 -0400] phantasm66: i am familiar with a chef run's compile and execute phases :)
[2014-06-06 20:27:00 -0400] phantasm66: thank you sir!
[2014-06-06 20:27:37 -0400] phantasm66: i do have 1 more question for you
[2014-06-06 20:29:06 -0400] Adobeman: umm
[2014-06-06 20:29:06 -0400] phantasm66: is there an order to which gets compiled first (libraries, providers, resources, etc..)?
[2014-06-06 20:29:37 -0400] phantasm66: i have objects in my libraries that are only available if the gem i was referring to is installed
[2014-06-06 20:29:38 -0400] Adobeman: can I manage end user's cron job with chef?  I only appears to be able to do root's..?  am I doing something wrong?
[2014-06-06 20:29:39 -0400] coderanger: Yes, libs first, then attrs I think, then resources/providers/macos
[2014-06-06 20:29:39 -0400] coderanger: phantasm66: Let me double check though
[2014-06-06 20:29:43 -0400] phantasm66: so if libraries get loaded first... doing a chef_gem in my provider for the gem in question will be a day late and a dollar short :(
[2014-06-06 20:29:49 -0400] phantasm66: ie: my objects in my libraries are going to bomb out
[2014-06-06 20:29:54 -0400] Adobeman: I'm using chef-solo
[2014-06-06 20:30:03 -0400] phantasm66: @coderanger: any suggestion?
[2014-06-06 20:30:25 -0400] coderanger: phantasm66: https://github.com/opscode/chef/blob/master/lib/chef/run_context/cookbook_compiler.rb#L71-L75
[2014-06-06 20:32:18 -0400] phantasm66: k, that order definitely makes sense
[2014-06-06 20:32:19 -0400] coderanger: Adobeman: The cron resource as a user attribute, set that
[2014-06-06 20:32:43 -0400] phantasm66: but i am stumped on how i can ensure a gem is present before i use modules/classes only present with said gem
[2014-06-06 20:32:52 -0400] phantasm66: in a library ^
[2014-06-06 20:32:55 -0400] Adobeman: ah, I need to run it as root
[2014-06-06 20:32:56 -0400] coderanger: phantasm66: Like I said, in lib files you need to delay the require until the function is called
[2014-06-06 20:33:01 -0400] Adobeman: not as actual user
[2014-06-06 20:33:07 -0400] Adobeman: ok, that's what I'm doing wrong.
[2014-06-06 20:33:09 -0400] Adobeman: thanks :)
[2014-06-06 20:33:10 -0400] coderanger: Adobeman: Yes, chef is generally run as root
[2014-06-06 20:33:18 -0400] coderanger: phantasm66: Can you pastebin the lib file in question and I can take a look?
[2014-06-06 20:33:19 -0400] coderanger: phantasm66: (btw, I provide consulting and training services for this kind of thing if you are interested)
[2014-06-06 20:33:21 -0400] phantasm66: sure - i'll post a gist
[2014-06-06 20:34:55 -0400] phantasm66: @coderanger: this is what i was trying to do initially
[2014-06-06 20:34:57 -0400] Adobeman: coderanger: thank you
[2014-06-06 20:35:06 -0400] phantasm66: this is the gem loader module i wrote:
[2014-06-06 20:35:07 -0400] phantasm66: https://gist.github.com/phantasm66/38358b8ead93924d030f
[2014-06-06 20:35:24 -0400] phantasm66: then i *use* it in a docker client library i wrote:
[2014-06-06 20:35:38 -0400] phantasm66: https://gist.github.com/phantasm66/e6dfa94071bbad54e728
[2014-06-06 20:36:22 -0400] phantasm66: with that, i thought i could just do Profiles::Gem.initialize_gem('docker-api') from within the Profiles::Docker module namespace
[2014-06-06 20:36:45 -0400] coderanger: phantasm66: Right, so just move the require inside the functions
[2014-06-06 20:36:54 -0400] phantasm66: but i kept getting: uninitialized constant Profiles::Gem
[2014-06-06 20:37:14 -0400] coderanger: and in your recipe code, do chef_gem 'docker-api'
[2014-06-06 20:37:15 -0400] coderanger: (do that before you call the functions in question)
[2014-06-06 20:37:17 -0400] sarkis: coderanger: i'm at a crossroads, not sure whether to write an ohai plugin to figure out what platform i am on based on our hostname naming, or do i just put the nodes in environments
[2014-06-06 20:37:31 -0400] sarkis: wwnd
[2014-06-06 20:37:33 -0400] coderanger: phantasm66: You might also have a load order issue between the two files
[2014-06-06 20:37:36 -0400] sarkis: what would noah do
[2014-06-06 20:37:48 -0400] phantasm66: that's more what i was thinking
[2014-06-06 20:37:49 -0400] phantasm66: @coderanger
[2014-06-06 20:38:20 -0400] coderanger: sarkis: What use of the term "platform" do you mean?
[2014-06-06 20:38:25 -0400] phantasm66: any way to ensure one library file in a cookbook gets loaded *before* another library file in the same cookbook?
[2014-06-06 20:38:25 -0400] coderanger: sarkis: I assume this is different from the existing node['platform'] populated by ohai
[2014-06-06 20:38:33 -0400] coderanger: phantasm66: Use require_relative
[2014-06-06 20:38:41 -0400] coderanger: phantasm66: They are run in asciibetical order
[2014-06-06 20:38:46 -0400] sarkis: coderanger: hmm maybe, we currently have a mix of bare metal and aws
[2014-06-06 20:38:58 -0400] sarkis: i know ohai has the cloud hint which will tell me if im on ec2
[2014-06-06 20:39:15 -0400] sarkis: but couldn't figure out how to tell if i am on the baremetal, so i came up with the 2 solutions above :)
[2014-06-06 20:39:37 -0400] coderanger: sarkis: I mean if you aren't on EC2, then wouldn't the only other option be "no cloud"?
[2014-06-06 20:39:56 -0400] sarkis: does it tell you that?
[2014-06-06 20:40:52 -0400] sarkis: i was looking at this: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/cloud.rb
[2014-06-06 20:41:30 -0400] coderanger: So you can just check (node['ec2'] ? :ec2 : :metal)
[2014-06-06 20:41:39 -0400] sarkis: ya i see what u mean..
[2014-06-06 20:41:43 -0400] sarkis: makes sense, thanks :)
[2014-06-06 20:41:56 -0400] sarkis: i think im overengineering assuming we add more providers or dc's
[2014-06-06 20:42:00 -0400] sarkis: bleh
[2014-06-06 20:42:37 -0400] coderanger: sarkis: If you want to mildly future proof it
[2014-06-06 20:42:45 -0400] sarkis: i could make that into a custom hint
[2014-06-06 20:42:52 -0400] sarkis: mycompany_env
[2014-06-06 20:43:04 -0400] coderanger: if node['ec2'] :ec2 elsif !node['cloud'] :metal else raise "dunno" end
[2014-06-06 20:43:05 -0400] sarkis: or Mmycompany>_provider
[2014-06-06 20:43:37 -0400] sarkis: is that the best option to go with a custom hint?
[2014-06-06 20:43:56 -0400] coderanger: I think you are using the word "hint" differently than ohai does
[2014-06-06 20:44:01 -0400] sarkis: with the above.. then i could just say if node['mycompany_env'] == :metal
[2014-06-06 20:44:10 -0400] sarkis: custom plugin***
[2014-06-06 20:44:12 -0400] coderanger: the hints system in ohai is used to force running conditional plugins
[2014-06-06 20:44:27 -0400] sarkis: ya sorry i am coming from puppet
[2014-06-06 20:44:32 -0400] sarkis: facter - facts
[2014-06-06 20:44:38 -0400] sarkis: i thought ohai - hints
[2014-06-06 20:44:46 -0400] sarkis: its more ohai - plugins
[2014-06-06 20:44:57 -0400] coderanger: Ahh, yeah or just attributes
[2014-06-06 20:45:22 -0400] coderanger: ohai runs before other node attributes are availble
[2014-06-06 20:45:32 -0400] coderanger: so you can't have an ohai plugin based on env stuff
[2014-06-06 20:45:33 -0400] sarkis: perfect
[2014-06-06 20:45:53 -0400] sarkis: hm oh ya not perfect node['ec2']
[2014-06-06 20:45:54 -0400] sarkis: :)
[2014-06-06 20:45:55 -0400] coderanger: But you could parse it from other ohai data like the hostname and cloud plugins
[2014-06-06 20:46:13 -0400] MikeTLive: is there a "-kidding" arg for knife cookbook upload ? i want to see what it wants to do and not have it do it.
[2014-06-06 20:46:53 -0400] coderanger: MikeTLive: Not sure what you mean, the only thing it does it update the cookbook and possibly an env if you give -E
[2014-06-06 20:47:26 -0400] MikeTLive: knife cookbook upload   bookname  --include-dependencies
[2014-06-06 20:47:41 -0400] MikeTLive: i want to know what it wants to upload before it actually uploads anything
[2014-06-06 20:49:12 -0400] MikeTLive: let knife walk the dependency tree and report back all of the things its trying to move around.
[2014-06-06 20:49:48 -0400] coderanger: MikeTLive: Ahh 1) thats not really used much anymore in favor of berks upload and 2) neither support what you want
[2014-06-06 20:49:58 -0400] coderanger: MikeTLive: (but you aren't alone, I've been wanting that as well)
[2014-06-06 20:50:57 -0400] MikeTLive: brings me back to another thing thats really bugging me - is berkshelf way becoming the only way?
[2014-06-06 20:51:17 -0400] coderanger: MikeTLive: It's highly recommended for anything beyond very simple single-repo setups
[2014-06-06 20:53:49 -0400] MikeTLive: say 10 or more small ops teams, each managing a dozen or so applications, promoted through 7 levels of functional environments made up of vm spread across multiple datacenters and availaility zones,  ...
[2014-06-06 20:53:59 -0400] coderanger: MikeTLive: Yeah, you should be using berks
[2014-06-06 20:54:06 -0400] MikeTLive: trying to get them to all share and not fork
[2014-06-06 20:54:28 -0400] coderanger: MikeTLive: I mean its like saying you could deploy a large django/rails app using nothing but a lot of pip/gem install, but "no one" does that anymore
[2014-06-06 20:54:36 -0400] MikeTLive: so that we have and use the same core cookbooks for anything that is common dependency for an app and not directly managing that app
[2014-06-06 20:54:53 -0400] coderanger: MikeTLive: That is precisely the workflow berks is built for :)
[2014-06-06 20:57:08 -0400] MikeTLive: at the same time, im trying to make sure that we find the best suited community cookbook for whatever technology dependency, wrap it, then if it needs some change for our purposes we do that through the wrapper, itf these changes would be better suited inside that cookbook we would make a fork for that purpose and work with the community cookbook maintainer to make it mutually better, then updating our community cookbook copy (knife 
[2014-06-06 20:57:43 -0400] tabolario: Hrm, is there a way to tell test-kitchen to run some arbitrary shell commands before it initiates the chef-solo run?
[2014-06-06 21:04:33 -0400] sauraus: Can anyone explain to me in plain text the 'match' option of the openssh cookbook? The example certainly doesn't explain it
[2014-06-06 21:04:45 -0400] MikeTLive: it seems that lax naming/versioning plus use of git led to need for berks, and now berks has become the required path.
[2014-06-06 21:06:04 -0400] sauraus: @MikeTLive how about using Chef to deploy your infrastructure alone and then use http://www.consul.io for the app configuration?
[2014-06-06 21:06:13 -0400] MikeTLive: how do i, with berks, ensure an enduring commitment to and enabling and encouraging reuse and reinvestment
[2014-06-06 21:06:38 -0400] MikeTLive: @saurus - looking at your link
[2014-06-06 21:08:52 -0400] MikeTLive: @saurus - i will read that in more detail. any reference pointers? I was just chatting with someone about translating the intents/reciever relation on a worldwide basis. im already looking at etcd to maintain state records from my nodes about service health and cluster memberships
[2014-06-06 21:16:33 -0400] bawigga: are commands in before_migrate.rb files run sync or async?
[2014-06-06 21:23:36 -0400] Otterley: does test kitchen provide any hints to the chef run that it's running under test kitchen control?  e.g. environment variable etc
[2014-06-06 21:24:22 -0400] Otterley: looking for a way to provide some hints to providers to behave somewhat differently in test mode, other than setting a common "testing: true" attribute
[2014-06-06 21:38:25 -0400] MikeTLive: @sauraus consul is pretty much what i was imagining.  thanks!
[2014-06-06 21:38:47 -0400] MikeTLive: convergent ideation
[2014-06-06 21:45:52 -0400] sarkis: hey all, within recipes/default.rb, can i add to an array just as in ruby?
[2014-06-06 21:46:11 -0400] Otterley: of course
[2014-06-06 21:46:20 -0400] Otterley: the recipes themselves are ruby scripts
[2014-06-06 21:46:28 -0400] sarkis: <<
[2014-06-06 21:46:42 -0400] sarkis: oh ok, i thought there's some chef dsl magic
[2014-06-06 21:46:59 -0400] sarkis: and if you wanted pure ruby you had to wrap in a ruby_block or something like that
[2014-06-06 21:47:43 -0400] Otterley: a ruby_block is a resource, like a file or a template. execution of code in ruby_block blocks is deferred until the convergence phase.
[2014-06-06 21:57:19 -0400] tabolario: Otterley: I guess you could make a really tiny cookbook that you include in your Berksfile that sets some attributes
[2014-06-06 21:57:53 -0400] tabolario: Oh wait no don't do that
[2014-06-06 21:57:56 -0400] Otterley: tabolario, filed https://github.com/test-kitchen/test-kitchen/issues/458 for comment
[2014-06-06 21:58:17 -0400] tabolario: Just use the attributes configuration for the test suite
[2014-06-06 21:58:23 -0400] tabolario: Ah cool
[2014-06-06 21:58:39 -0400] Otterley: I agree you can do that, but it's a lot of repetition for the poor cookbook developer.
[2014-06-06 21:59:44 -0400] tabolario: Yeah, saw that in your issue just now
[2014-06-06 21:59:50 -0400] Otterley: Thanks for the +1
[2014-06-06 21:59:52 -0400] tabolario: I think it'd certainly be useful
[2014-06-06 22:00:41 -0400] Otterley: a similar way of doing that would be to have a chef-client commandline option that allows you to pass pragmas into Chef::Config[:xyz] or similar
[2014-06-06 22:01:02 -0400] Otterley: e.g. chef-client -Dtesting=1
[2014-06-06 22:01:30 -0400] Otterley: but those would require changes to two things instead of just one
[2014-06-06 22:03:18 -0400] tabolario: Actually
[2014-06-06 22:03:32 -0400] tabolario: I wonder if the solo_rb config in the provisioner already supports arbitrary things
[2014-06-06 22:03:52 -0400] tabolario: https://github.com/americanhonors-cookbooks/aws-sdk/blob/master/.kitchen.cloud.yml#L13
[2014-06-06 22:04:02 -0400] tabolario: Perhaps you can just throw stuff in there
[2014-06-06 22:05:04 -0400] Otterley: we're using chef-zero, so that wouldn't apply to us.
[2014-06-06 22:05:50 -0400] Otterley: I can see a use case for provisioner-specific hints to chef-client, but I'm concerned with the general case at the moment.
[2014-06-06 22:06:17 -0400] tabolario: Ah
[2014-06-06 22:07:28 -0400] phantasm66: i have a library and want to load a yaml file in the same cookbook...
[2014-06-06 22:07:49 -0400] phantasm66: has anyone else done this successfully?
[2014-06-06 22:08:06 -0400] tabolario: Otterley: Gotten a chance to play around with that travis stuff yet?
[2014-06-06 22:08:19 -0400] Otterley: tabolario, not yet.  got sidetracked with some other things.
[2014-06-06 22:08:46 -0400] tabolario: That aws-sdk cookbook I just linked to something in is probably the best example I have right now of the full harness working
[2014-06-06 22:08:55 -0400] phantasm66: it seems that if i do YAML.load_file relative to my library.. i still get the "No such file or directory"
[2014-06-06 22:08:58 -0400] Otterley: namely, trying to figure how how to abstract that Chef::Node#secret method so it's usable in a test-kitchen run
[2014-06-06 22:15:46 -0400] phantasm66: how does one get the "current working directory" from inside a library file in a chef cookbook?
[2014-06-06 22:16:23 -0400] phantasm66: Strangely, Dir.pwd does not seem to be working correctly
[2014-06-06 22:16:58 -0400] phantasm66: i want to IO.read another file in the same directory
[2014-06-06 22:19:54 -0400] tabolario: phantasm66: File.expand_path('..', __FILE__)
[2014-06-06 22:24:01 -0400] Otterley: phantasm66, in a more general sense, I'm curious as to the use case of shipping a YAML file with a cookbook
[2014-06-06 22:25:05 -0400] phantasm66: it is ENORMOUS
[2014-06-06 22:25:42 -0400] Otterley: What I mean is, what you're doing with it. :)
[2014-06-06 22:25:42 -0400] phantasm66: various things about the hundreds of docker containers i am trying to manage w/ chef
[2014-06-06 22:26:05 -0400] Otterley: Can't use data bags?
[2014-06-06 22:27:08 -0400] phantasm66: i probably should ;)
[2014-06-06 22:27:17 -0400] Otterley: It's usually preferred to keep your implementation separate from your input.
[2014-06-06 22:38:33 -0400] tabolario: Oooh
[2014-06-06 22:38:48 -0400] tabolario: The community cookbook site does not like the badge images in my readme :/
[2014-06-06 22:40:09 -0400] tabolario: Oh it doesn't like several GitHub markdown constructs
[2014-06-06 22:50:42 -0400] juliancdunn: tabolario: the new community site will have much better parsing :)
[2014-06-06 23:18:17 -0400] martinisoft: Any handy ways to debug an erchef server that is 500ing when trying to update roles?
[2014-06-06 23:21:09 -0400] martinisoft: Think I tracked it down.
[2014-06-06 23:23:09 -0400] Majost: Does anyone know if it the vbox/vargrant/test kitchen driver can mount a synced folder in multiple kitchen instances at the same time?
[2014-06-06 23:29:37 -0400] martinisoft: Used the chef-server-ctl to check the status and found the service.
[2014-06-06 23:30:15 -0400] aslan_: hey guys, can any one tell me between apt-get install chef and gem install chef which one is better and why? By the way i am using ubuntu 14.04
[2014-06-06 23:30:54 -0400] Otterley: you should use the Omnibus package in production aslan_
[2014-06-06 23:31:24 -0400] aslan_: why? what are the benefits compared to apt or gem install ?
[2014-06-06 23:31:34 -0400] martinisoft: aslan_: You want the apt package for what Otterley said, the onibus installer is much better. Self-contained chef environment that doesnt need a gem environment.
[2014-06-06 23:31:51 -0400] martinisoft: Correction, doesnt need an *existing* gem environment
[2014-06-06 23:32:09 -0400] martinisoft: Entirely separate from your system install so you dont have to worry about it.
[2014-06-06 23:32:22 -0400] aslan_: martinisoft: is that to handle ruby version incompatibilities?
[2014-06-06 23:32:42 -0400] martinisoft: aslan_: Not just ruby, dependent libraries, etc.
[2014-06-06 23:32:49 -0400] aslan_: by the way this is just client side
[2014-06-06 23:33:00 -0400] martinisoft: Yup, works the same for both.
[2014-06-06 23:34:26 -0400] aslan_: martinisoft: i always like the old init setup that basically daemonizes the chef-client process can i get that if i use the ominibus method?
[2014-06-06 23:34:49 -0400] martinisoft: aslan_: Yup you can. The chef-client cookbook provides several options.
[2014-06-06 23:35:06 -0400] martinisoft: I prefer to cron it, others make it a service. To each their own.
[2014-06-06 23:35:25 -0400] aslan_: martinisoft: till today i always use the bootstrap and solo cookbook to configure both my client and server
[2014-06-06 23:35:50 -0400] martinisoft: You can do chef-zero these days :)
[2014-06-06 23:36:04 -0400] martinisoft: Get the benefits of a server, without setting up an entire chef-server
[2014-06-06 23:36:20 -0400] aslan_: martinisoft: my servers usually have a lot of crons running. I rather keep it in init. what is chef-zero?
[2014-06-06 23:36:31 -0400] martinisoft: In-memory chef server.
[2014-06-06 23:37:02 -0400] martinisoft: Super tiny instance that provides things like search. There was also chef metal introduced at Chef Conf for describing full servers.
[2014-06-06 23:37:13 -0400] martinisoft: Check out the videos from Chef Conf
[2014-06-06 23:37:22 -0400] martinisoft: Im headed out though, good luck aslan_
[2014-06-06 23:37:38 -0400] aslan_: martinisoft: do you have a link to the vid?
[2014-06-06 23:37:42 -0400] aslan_: thanks man
[2014-06-06 23:38:05 -0400] martinisoft: aslan_: Google ChefConf, right on the front page. They have a youtube playlist
[2014-06-06 23:38:24 -0400] aslan_: cool thanks. :)
