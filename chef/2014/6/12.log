[2014-06-12 00:00:34 -0400] jespada: juliancdunn, so each dir under test/fixtures/data_bags will be a data_bag then every item(.json) will be an object on that data bag?
[2014-06-12 00:01:44 -0400] juliancdunn: jespada: yeah, I think it's a directory structure by bag name and then item
[2014-06-12 00:02:05 -0400] jespada: juliancdunn, cool , thanks, will look into the code anyway :)
[2014-06-12 00:03:42 -0400] jpoole: alright i'm at a loss, trying to import a sql file with recipe database (2.2.0) but I keep getting MySQL server has gone away
[2014-06-12 00:04:31 -0400] jpoole: nothing in the /var/log/mysql.err or /var/log/mysql.log
[2014-06-12 00:05:21 -0400] jpoole: if I run the import on the mysql console it works fine.
[2014-06-12 00:05:37 -0400] jpoole: so it's not a problem with the sql file itself.
[2014-06-12 01:33:36 -0400] while1eq1: im writing a wrapper cookbook and need to include an LWRP from the parent cookbook. How do I do that?
[2014-06-12 01:38:46 -0400] coderanger: while1eq1: All LWRPs are global, just depend on the cookbook
[2014-06-12 01:38:57 -0400] while1eq1: thanks
[2014-06-12 03:31:19 -0400] Majost_: coderanger, Does kitchen-sync support concurrency?
[2014-06-12 03:31:45 -0400] coderanger: Majost_: It should
[2014-06-12 03:31:52 -0400] Majost_: It may be the digitalocean driver then
[2014-06-12 03:31:55 -0400] coderanger: Majost_: Not sure if I ever tested it though
[2014-06-12 03:32:00 -0400] coderanger: Majost_: Whats the error?
[2014-06-12 03:32:27 -0400] Majost_: its not an error, but the behavior seems to be serial even though I did -c 2
[2014-06-12 03:32:51 -0400] coderanger: getting kicked out of our space
[2014-06-12 03:32:56 -0400] coderanger: back in a bit
[2014-06-12 03:33:03 -0400] Majost_: oh, bummer
[2014-06-12 03:33:06 -0400] Majost_: np
[2014-06-12 03:35:47 -0400] Majost_: s/np/take your time/
[2014-06-12 03:35:49 -0400] Majost_: heh
[2014-06-12 03:38:38 -0400] octopi: hello
[2014-06-12 05:25:02 -0400] exeleven: I'm having an issue with clients downloading some recipes from my Chef server.  Is this the best place to ask for help?
[2014-06-12 05:28:46 -0400] coderanger: exeleven: Sure, whats the issue?
[2014-06-12 05:29:19 -0400] exeleven: Some of my recipes started failing to run with a 404 error.  I found I can reproduce the issue by running this command:
[2014-06-12 05:29:20 -0400] exeleven: knife cookbook download rdl-config-reverse-proxy -d /tmp/ --latest
[2014-06-12 05:29:34 -0400] exeleven: ERROR: The object you are looking for could not be found Response: #<Net::ReadAdapter:0x7f755dfaf198>+
[2014-06-12 05:29:50 -0400] exeleven: this is the response for a few recipes
[2014-06-12 05:30:05 -0400] exeleven: I actually ittereated through every recipe and found that about 20% of them failed like this
[2014-06-12 05:30:59 -0400] exeleven: I eventually went through and did a purge / upload for the defective recipes
[2014-06-12 05:31:06 -0400] coderanger: exeleven: Hosted chef or open source?
[2014-06-12 05:31:14 -0400] exeleven: opensource
[2014-06-12 05:31:19 -0400] exeleven: knife cookbook delete $@ --purge
[2014-06-12 05:31:28 -0400] exeleven: knife cookbook upload $@ -o $cbdir
[2014-06-12 05:31:36 -0400] exeleven: this seemed to fix it for a while
[2014-06-12 05:31:39 -0400] exeleven: but the issue is recurring
[2014-06-12 05:31:42 -0400] coderanger: exeleven: Which URL actually 404s?
[2014-06-12 05:31:51 -0400] exeleven: and now, I have 5 recipes which I can't fix like this
[2014-06-12 05:31:58 -0400] exeleven: they remain corrupted or whatever it is
[2014-06-12 05:33:01 -0400] coderanger: exeleven: Is it the initial cookbook metadat one, or one of the data URLs?
[2014-06-12 05:33:13 -0400] coderanger: exeleven: (you should be able to see which it is via knife -vv
[2014-06-12 05:33:41 -0400] exeleven: checking...
[2014-06-12 05:35:26 -0400] exeleven: https://chef.exeleven.com/bookshelf/organization-00000000000000000000000000000000/checksum-4c1e72ff08e883da89e3ea32ff3f78dc?AWSAccessKeyId=934d1298e74e1140ea23d1ed1c159e1a4e88c7e5&Expires=1402552166&Signature=bUn0dhOoWyUqdhKbHcUfxVAji50%3D
[2014-06-12 05:35:31 -0400] exeleven: that one
[2014-06-12 05:35:42 -0400] coderanger: Okay, so its a da ta URL
[2014-06-12 05:35:58 -0400] coderanger: Next thing to check is the bookshelf logs
[2014-06-12 05:37:06 -0400] exeleven: Right, /var/log/chef-server/bookshelf/current ?
[2014-06-12 05:37:29 -0400] coderanger: Yahr
[2014-06-12 05:37:39 -0400] coderanger: Specifically see if you are getting checksum errors
[2014-06-12 05:38:00 -0400] coderanger: bookshelf stores all files with a checksum for safety, not sure if that would be a 404 though
[2014-06-12 05:38:07 -0400] coderanger: Any chance the disk is out of space?
[2014-06-12 05:38:48 -0400] exeleven: doesn't look like it.  There are error reports in there, but the last one is from 23 hours ago
[2014-06-12 05:39:14 -0400] exeleven: nope, over 10GB free on all disks
[2014-06-12 05:39:25 -0400] coderanger: Okay, next thing to check is if that file does exist on disk
[2014-06-12 05:39:40 -0400] coderanger: Look for checksum-4c1e72ff08e883da89e3ea32ff3f78dc
[2014-06-12 05:39:53 -0400] a13x212: anyone use the openstack cookbooks?
[2014-06-12 05:40:05 -0400] exeleven: Additonally, if I try to view the defective recipes in the web interface, I get an error when clicking on them: ERROR: undefined method `close!' for nil:NilClass
[2014-06-12 05:40:22 -0400] exeleven: okay, where on the disk would I be looking?
[2014-06-12 05:40:48 -0400] coderanger: exeleven: I don't have a server handy, but something like /var/chef/bookshelf I think
[2014-06-12 05:43:33 -0400] exeleven: find / |grep checksum-4c1e72ff08e883da89e3ea32ff3f78d # found nothing
[2014-06-12 05:45:57 -0400] coderanger: exeleven: Okay, thats what I would expect at least
[2014-06-12 05:46:07 -0400] coderanger: exeleven: But that file record does exist in the DB
[2014-06-12 05:46:15 -0400] coderanger: exeleven: So the question is how they got out of sync :-/
[2014-06-12 05:48:25 -0400] exeleven: In this dir: /var/opt/chef-server/bookshelf/data/bookshelf
[2014-06-12 05:48:37 -0400] exeleven: I have found files like: organization-00000000000000000000000000000000%2Fchecksum-ffebc6dd17055973ddab808a6d12c92c
[2014-06-12 05:48:50 -0400] exeleven: is that where the file is supposed to be?
[2014-06-12 05:54:08 -0400] coderanger: exeleven: Yeah, that :)
[2014-06-12 05:59:20 -0400] exeleven: Excellent, I believe I know the problem then
[2014-06-12 05:59:37 -0400] exeleven: Well, I know the cause.  The postgresql must be out of sync with this dir
[2014-06-12 05:59:42 -0400] exeleven: now how do I fix it?  :)
[2014-06-12 05:59:57 -0400] exeleven: There will be hundreds or thousands of files out of sync
[2014-06-12 06:00:13 -0400] exeleven: the data will be in the db, but the files are gone forever.
[2014-06-12 06:01:01 -0400] exeleven: I have the files in source control, but not in this organization-00000000000000000000000000000000%2Fchecksum-ff4c8ff01d544500ea4bfea43e6108c1 format
[2014-06-12 06:01:25 -0400] exeleven: is there a way for me to purge all the files form the db and start uploading the recipes again?
[2014-06-12 06:02:04 -0400] exeleven: or rather, purge all the references to the files from the db?  I'd rather keep the databags, etc though
[2014-06-12 06:02:07 -0400] coderanger: exeleven: You can just delete everything from the cookbook tables in postgres and wipe that folder
[2014-06-12 06:38:18 -0400] exeleven: Cool thanks!  Which table(s) would I clear?
[2014-06-12 06:39:32 -0400] exeleven: coderanger, I have the following tables: http://pastebin.com/HLq1y3KF
[2014-06-12 06:40:44 -0400] coderanger: exeleven: The there cookbooks ones and the checksums table
[2014-06-12 06:40:52 -0400] coderanger: s/there/three/
[2014-06-12 06:48:38 -0400] CJNE: if i have two environment cookbooks: tsr-devel and tsr-prod that both have wrapper recipes for each component in my app and i then use those wrapper recipes in run lists (example devel node runlist: recipe[tsr-base], recipe[tsr-devel::basket-worker], in order to promote that node to production i would need to both change the environment to tsr-prod and change it's run list to use tsr-prod::basket-worker. Would it be better to use an application cookbook directly in 
[2014-06-12 06:51:59 -0400] coderanger: CJNE: If you are using cookbooks to model envs, you can just skip the chef environment system
[2014-06-12 06:52:08 -0400] CJNE: Maybe i'm just overthinking things, i might never really have a need to move a node to a different environment, just thought it would be nice to be able to do so easily
[2014-06-12 06:55:22 -0400] coderanger: CJNE: I mean if you do need to edit two things, its at least two things stored in the same place and updated atomically, so not really a huge deal
[2014-06-12 06:55:58 -0400] CJNE: coderanger: i use berks apply to lock versions in both tsr-prod and tsr-devel, if i don't use a chef environment wouldn't the node always get the newest version of dependency cookbooks? (tsr-devel::basket-worker just includes tsr-baket-worker::default)
[2014-06-12 06:56:19 -0400] coderanger: CJNE: Don't use berks apply, use metadata dependencies
[2014-06-12 06:56:25 -0400] coderanger: CJNE: otherwise yes
[2014-06-12 06:56:36 -0400] coderanger: either works fine, modulo the issue you noted :)
[2014-06-12 06:58:10 -0400] CJNE: aha, i'll digest using metadata dependencies instead of berks apply for a while, thanks :)
[2014-06-12 06:59:08 -0400] coderanger: CJNE: Same basic idea, just that the restrictions go in metadata.rb
[2014-06-12 06:59:56 -0400] CJNE: berksflow is using chef environments right?
[2014-06-12 07:04:11 -0400] bcave: morning all :)
[2014-06-12 07:04:22 -0400] CJNE: morning :)
[2014-06-12 07:04:32 -0400] bcave: how are you doing CJNE ?
[2014-06-12 07:06:14 -0400] CJNE: i'm doing fine thanks, it's a nicy sunny morning here in Sweden. You?
[2014-06-12 07:06:49 -0400] bcave: quite nippy in south africa. nippy being relative. Cold here is like your summer. we hit -1 C last night! :o
[2014-06-12 07:08:07 -0400] CJNE: oh, we have around 20 C :) Summer is not too bad here :)
[2014-06-12 07:09:10 -0400] bcave: nice
[2014-06-12 07:09:35 -0400] bcave: our winters are mild. summers can get to 40
[2014-06-12 07:09:45 -0400] coderanger: Lol at seasons
[2014-06-12 07:09:46 -0400] bcave: I wouldn'
[2014-06-12 07:09:51 -0400] coderanger: San Francisco doesn't have those :)
[2014-06-12 07:10:05 -0400] bcave: it's always overcast there :D
[2014-06-12 07:10:49 -0400] coderanger: Nah, just in the mornings, the fog burns off by 10-ish
[2014-06-12 07:11:41 -0400] bcave: only been there slightly later in the year
[2014-06-12 07:11:43 -0400] CJNE: i wish our seasons were a littel more balanced, the summer is too short here, so much to do in so little time before the long dark winter :P
[2014-06-12 07:13:31 -0400] bcave: though i'm usually closer to san jose which always seems more milder than SF itself
[2014-06-12 07:22:19 -0400] bcave: wondering if anyone might have any ideas about a failing chef-client -z run in AWS....
[2014-06-12 07:22:31 -0400] bcave: http://stackoverflow.com/questions/24163585/chef-zero-via-aws-userdata-fails/24171012#24171012
[2014-06-12 07:23:03 -0400] bcave: i've switched from chef-client -z to chef-solo and it's working now
[2014-06-12 07:23:53 -0400] coderanger: bcave: Whats the actual recipe code thats failing?
[2014-06-12 07:25:53 -0400] srenatus: bcave: knife-ec2 might put an ohai hint in place which makes ohai gather metadata itself, available through node[cloud][...
[2014-06-12 07:26:13 -0400] srenatus: bcave: when you provision without knife-ec2, this probably doesn't happen
[2014-06-12 07:27:08 -0400] coderanger: Indeed, if you are launching in a VPC (and you probably are) then no EC2 metadata is loaded by default
[2014-06-12 07:28:01 -0400] bcave: I am launching in a vpc, are you talking about metadata from the 169.254.169.254 interface?
[2014-06-12 07:28:47 -0400] srenatus: coderanger: AFAICT metadata should be available "inside" VPC just as well, isn't that the case?
[2014-06-12 07:28:56 -0400] bcave: srenatus: are you saying that when the AMI was originally provisioned with knife-ec2, the hint was put in? There is an ohai directory in /etc/chef/
[2014-06-12 07:29:03 -0400] srenatus: bcave: the difference could be ohai fetching that data or not
[2014-06-12 07:29:17 -0400] srenatus: bcave: yes, something like /etc/chef/ohai/hints/ec2.json
[2014-06-12 07:29:21 -0400] coderanger: srenatus: It is, but on a VPC instance we haven't found a good way to know just from looking at the machine that you are on EC2
[2014-06-12 07:29:28 -0400] bcave: the part that's confusing me, is that userdata executes `chef-client -z ....` and fails
[2014-06-12 07:29:31 -0400] coderanger: srenatus: On non-VPC you can tell from the MAC address
[2014-06-12 07:29:33 -0400] srenatus: coderanger: ah, ok. I see.
[2014-06-12 07:29:43 -0400] bcave: then I ssh onto the box and execute exactly the same command and it passes
[2014-06-12 07:29:59 -0400] coderanger: bcave: Whats the code the fails
[2014-06-12 07:30:22 -0400] bcave: the run list is a role for an application
[2014-06-12 07:30:33 -0400] srenatus: bcave: coderanger is right, the failing line would be interesting. you could add debugging things into your userdata, such as "env", for checking the differences between cloudinit and ssh
[2014-06-12 07:30:37 -0400] bcave: run_list is 'recipe[myapp::default]'
[2014-06-12 07:30:53 -0400] srenatus: bcave:  [~glennprat@pool-71-123-193-109.dllstx.fios.verizon.net] has quit [Read error: Connection reset by peer]
[2014-06-12 07:30:58 -0400] srenatus: whoops sorr
[2014-06-12 07:31:12 -0400] srenatus: ERROR: undefined method `[]' for nil:NilClass << the line that caused that is the interesting one
[2014-06-12 07:31:55 -0400] bcave: ah. wait... i'm wondering if this line in the recipe might be related...
[2014-06-12 07:32:12 -0400] srenatus: bcave: yes! :)
[2014-06-12 07:32:31 -0400] bcave: if !node[:myapp][:some_setting] .... end
[2014-06-12 07:32:51 -0400] bcave: wait.. but then if that was an issue, surely it would fail too when I run the command
[2014-06-12 07:33:15 -0400] bcave: i updated chef-client to run with -l debug too, and not getting a reference to what it's trying to do when it fails
[2014-06-12 07:33:41 -0400] srenatus: bcave: possibly, but not necessarily.  there're many things that could be different.  i.e. how do you "sudo" ? 'sudo -i' will set HOME=/root, 'sudo -s' wont, etc etc
[2014-06-12 07:34:01 -0400] bcave: i do sudo -i
[2014-06-12 07:34:23 -0400] bcave: so maybe a difference in the cloud-init env?
[2014-06-12 07:34:24 -0400] srenatus: bcave: try adding a plain line with "env" before the chef-client call in your userdata... could help (may be a dead end...)
[2014-06-12 07:34:33 -0400] bcave: yeah, giving that a go now...
[2014-06-12 07:34:35 -0400] srenatus: bcave: no clue :D
[2014-06-12 07:35:13 -0400] srenatus: btw there're also projects for building the userdata script you have there, such as https://github.com/TelekomLabs/cloudinit-cli
[2014-06-12 07:35:35 -0400] srenatus: not sure if it's any good with ec2 but they'd probably love collaborators.
[2014-06-12 07:36:35 -0400] srenatus: bbiab.
[2014-06-12 07:36:41 -0400] bcave: erk... nodejs...
[2014-06-12 07:36:56 -0400] bcave: :p
[2014-06-12 07:41:47 -0400] bcave: that takes me back a while. wrote a nodejs app to deploy elb's and autoscaling groups. and then cloudformation + knife-cfn made life so much easier
[2014-06-12 07:48:08 -0400] srenatus: bcave: yes, plus it seems chef-client/server-centric... so not (yet) any good for your usecase, I guess
[2014-06-12 07:48:27 -0400] bcave: yeah. fortunately the switch to solo was pretty painless
[2014-06-12 07:50:11 -0400] CJNE: when using solo/zero, how do you update cookbooks on the node?
[2014-06-12 07:51:00 -0400] coderanger: CJNE: knife-solo is popular
[2014-06-12 07:53:46 -0400] CJNE: i need to read up on that, i'm pretty happy with client/server but i might not know what i'm missing :P
[2014-06-12 08:10:56 -0400] benner: is there way to get notification before resource execution? i.e. before tempalte resource changes?
[2014-06-12 08:14:09 -0400] coderanger: benner: No, Chef can't tell until it does stuff
[2014-06-12 08:19:09 -0400] nacer: hi there
[2014-06-12 08:19:24 -0400] coderanger: alo
[2014-06-12 08:19:36 -0400] nacer: huys, how do you manager ssh user <-> host ACL and sudo ?
[2014-06-12 08:20:42 -0400] coderanger: nacer: the user cookbook is a decent option
[2014-06-12 08:20:54 -0400] nacer: coderanger: the opscode one ?
[2014-06-12 08:21:01 -0400] nacer: i can
[2014-06-12 08:21:03 -0400] coderanger: nacer: I go for a slightly different style though, see balanced-user on github
[2014-06-12 08:21:10 -0400] coderanger: nacer: Yeah
[2014-06-12 08:21:11 -0400] nacer: coderanger: tks
[2014-06-12 08:21:35 -0400] coderanger: nacer: My style doesn't work for everyone, but I like it :)
[2014-06-12 08:21:36 -0400] bcave: CJNE: I wrote a simple packager
[2014-06-12 08:21:58 -0400] nacer: coderanger: i'm looking at balanced-user
[2014-06-12 08:22:12 -0400] bcave: that creates a tgz of the relevant files from my repo, and then i grab it in the userdata script and extract it
[2014-06-12 08:22:25 -0400] nacer: coderanger: no good
[2014-06-12 08:24:53 -0400] coderanger: nacer: hmm?
[2014-06-12 08:26:44 -0400] nacer: coderanger: no acl
[2014-06-12 08:27:01 -0400] nacer: i'm going to stick with users cookbook
[2014-06-12 08:27:28 -0400] coderanger: nacer: Not sure what ACLs you mean, but go for it :)
[2014-06-12 08:27:48 -0400] nacer: i want to declare witch user have access to my hosts
[2014-06-12 08:28:04 -0400] nacer: the way it is now when a create a user it become admin on all my node
[2014-06-12 08:30:49 -0400] CJNE: also looking at balanced-user and citadel, seems pretty neat :)
[2014-06-12 08:32:12 -0400] CJNE: not having to deal with data bags would be nice
[2014-06-12 08:36:30 -0400] coderanger: CJNE: https://coderanger.net/2014/02/data-bags ;-)
[2014-06-12 08:38:45 -0400] CJNE: coderanger, that's spot on, great post :)
[2014-06-12 08:53:48 -0400] coderanger: Cope: :P
[2014-06-12 09:00:18 -0400] coderanger: Yo
[2014-06-12 09:07:14 -0400] coderanger: Wheee, new site design is starting to look like a thing!
[2014-06-12 09:24:21 -0400] whiteadam: I'm up, everyone can cool out
[2014-06-12 10:16:13 -0400] nightw: Is there a way in a recipe to detect that it's currently running on chef-zero (like Chef::Config[:solo] for chef-solo)?
[2014-06-12 10:21:09 -0400] srenatus: bcave: any news for your cloudinit chef-zero? :)
[2014-06-12 10:21:28 -0400] bcave: srenatus: i chucked out zero and went with solo
[2014-06-12 10:22:00 -0400] bcave: have ohai hints was empty
[2014-06-12 10:22:41 -0400] bcave: and i have a new template with `env` in it ready for deploying, but just finishing something off before i launch it
[2014-06-12 10:35:31 -0400] bcave: https://gist.github.com/brettcave/88dd721ed1389173753e
[2014-06-12 10:36:23 -0400] bcave: srenatus: possibly due to HOME or PWD variable...
[2014-06-12 10:37:09 -0400] bcave: wait, PWD should be ok, maybe because of USER variable not being set
[2014-06-12 10:41:58 -0400] bcave: there's plenty of references to ENV["HOME'] in shell.rb
[2014-06-12 10:43:09 -0400] bcave: yup.
[2014-06-12 10:43:13 -0400] bcave: unset HOME
[2014-06-12 10:43:29 -0400] bcave: chef-client -z ... : ERROR: undefined method `[]' for nil:NilClass
[2014-06-12 10:43:39 -0400] bcave: export HOME=/root
[2014-06-12 10:43:44 -0400] bcave: chef-client -z: success
[2014-06-12 10:50:30 -0400] bcave: should that be considered a bug? Or is there something in the documentation that I missed about HOME being required?
[2014-06-12 11:40:35 -0400] Joe_____: hi guys
[2014-06-12 11:40:42 -0400] Joe_____: i am a chef begineer
[2014-06-12 11:40:52 -0400] Joe_____: i am trying out few cookbooks
[2014-06-12 11:41:38 -0400] Joe_____: i am trying to reboot the server using the cookbook cookbook-reboot-handler and its dependency chef_handler
[2014-06-12 11:42:08 -0400] Joe_____: it says i need to set the following as attribut during the chef run
[2014-06-12 11:42:08 -0400] Joe_____: node.run_state[:reboot] = true
[2014-06-12 11:42:17 -0400] Joe_____: but i dont know where to set that
[2014-06-12 11:42:21 -0400] srenatus: bcave: hmm it's cloudinit executing a bash script, right?
[2014-06-12 11:42:21 -0400] Joe_____: please help
[2014-06-12 11:42:51 -0400] srenatus: bcave: i.e. your user-data starts with #!/some/interpreter (/bin/bash) and thus cloudinit will execute it like that
[2014-06-12 11:43:44 -0400] srenatus: bcave: this is the handler: http://bazaar.launchpad.net/~cloud-init-dev/cloud-init/trunk/view/head:/cloudinit/handlers/shell_script.py
[2014-06-12 11:44:46 -0400] srenatus: hmm that one just puts the script in place...
[2014-06-12 11:45:39 -0400] srenatus: IIRC it will run-parts the directory containing the scripts at some point
[2014-06-12 11:46:49 -0400] srenatus: yep, here: http://bazaar.launchpad.net/~cloud-init-dev/cloud-init/trunk/view/head:/cloudinit/util.py#L598
[2014-06-12 11:47:40 -0400] srenatus: but be aware that this repo is upstream, your version of cloudinit might differ
[2014-06-12 11:48:31 -0400] srenatus: bcave: I guess the easiest way out is making your recipe more robust wrt. $HOME ;)
[2014-06-12 11:57:08 -0400] zeroXten: hi, i'm trying to use Chef::Mixin::DeepMerge.deep_merge! on two hashes, but getting a Chef::Exceptions::ImmutableAttributeModification exception. No idea why. The source is a pure Hash and the dest is node attributes with a .to_hash. Any hints?
[2014-06-12 12:01:18 -0400] zeroXten: wb glennpratt
[2014-06-12 12:23:26 -0400] bcave: srenatus: it's not about the recipe. It's an issue in the way the chef local executes
[2014-06-12 12:23:41 -0400] bcave: it loads up the repo into memory, and then executes the client against the in-memory server....
[2014-06-12 12:24:31 -0400] bcave: it will even crash with an empty run list. tested with `chef-client -z` just like that. I'm guessing that after the local server is started, chef-client is executed via shell.rb
[2014-06-12 12:25:11 -0400] bcave: workaround: `export HOME=/root` in userdata script
[2014-06-12 12:26:02 -0400] bcave: but then A) chef-client -z should check to see if HOME is set an moan about it if its required, or B) it should be able to handle a run without a HOME directory set
[2014-06-12 12:26:08 -0400] bcave: that was B )
[2014-06-12 12:28:43 -0400] bcave: I opened a bug, CHEF-5365
[2014-06-12 12:39:38 -0400] r3dk1ng: Good Morning
[2014-06-12 12:39:43 -0400] r3dk1ng: anyone awake yet?
[2014-06-12 12:39:44 -0400] r3dk1ng: lol
[2014-06-12 12:40:28 -0400] ocholetras: r3dk1ng: yep
[2014-06-12 12:40:36 -0400] r3dk1ng: haha
[2014-06-12 12:40:42 -0400] ocholetras: here at Canary islands 13:40
[2014-06-12 12:40:44 -0400] ocholetras: ^^
[2014-06-12 12:42:17 -0400] srenatus: bcave: the simplest way to reproduce it is to unset HOME and running chef-client -z, right? ;)
[2014-06-12 12:42:25 -0400] r3dk1ng: I have a quick question...  In a chef recipe... I build out a nest node attribute later on.  However, at the beginning of the recipe I want to check for the existance of the nested node attributes... if they don't exist, then carry on... if they do exist, then do something.  But I am getting an error on my chef client run about "undefined method [] for nil:NilClass..."  How can I do my test
[2014-06-12 12:42:31 -0400] r3dk1ng: without getting this error?
[2014-06-12 12:44:43 -0400] daos: where is chef-server.rb on chef server 11 (installed via omnibus)? i'd like to change the default SSL port
[2014-06-12 12:45:03 -0400] daos: or do I need to create it myself the first time?
[2014-06-12 12:48:01 -0400] zeroXten: rah
[2014-06-12 12:48:02 -0400] daos: nm looks like I need to add it and do: nginx['ssl_port'] = blah
[2014-06-12 12:48:11 -0400] daos: sorry about the noise guys
[2014-06-12 12:48:14 -0400] daos: :D
[2014-06-12 12:51:00 -0400] CJNE: r3dk1ng, so you're doing something like if node[:foo][:bar] ?
[2014-06-12 12:51:30 -0400] srenatus: r3dk1ng: return unless (node[:foo][:bar] rescue false)
[2014-06-12 12:51:43 -0400] r3dk1ng: CJNE: more like node['awssdk']['volume']['vol-id']
[2014-06-12 12:51:59 -0400] zeroXten: hi, i'm trying to use Chef::Mixin::DeepMerge.deep_merge! on two hashes, but getting a Chef::Exceptions::ImmutableAttributeModification exception. No idea why. The source is a pure Hash and the dest is node attributes with a .to_hash. Any hints?
[2014-06-12 12:52:45 -0400] CJNE: srenatus suggestion looks good :) the reason yet get the error is because you're trying to access properties on on nil most likely
[2014-06-12 12:55:34 -0400] zeroXten: hmm, moving the to_hash up a level seems to have worked... for now
[2014-06-12 13:03:27 -0400] srenatus: well, debatable.  a good thing to do might be something like "safe dereference" of node attributes https://github.com/rcbops-cookbooks/osops-utils/blob/master/libraries/ip_location.rb#L55
[2014-06-12 13:04:37 -0400] r3dk1ng: CJNE: return unless (node['awssdk']['volume']["#{volname}"] rescue false) does not work
[2014-06-12 13:05:01 -0400] r3dk1ng: still getting undefined method [] for nil:NilClass
[2014-06-12 13:06:12 -0400] jpoole: anyone use the database recipe from opscode, on trusty?
[2014-06-12 13:06:30 -0400] workmad3: r3dk1ng: 'unless (node['awssdk'] && node['awssdk']['volume'] && node['awssdk']['volume'][volname])'
[2014-06-12 13:06:55 -0400] r3dk1ng: cool, let me try workmad3
[2014-06-12 13:10:04 -0400] CJNE: you could always monkey path NilClass :P
[2014-06-12 13:10:09 -0400] CJNE: (but don't)
[2014-06-12 13:31:47 -0400] ickymettle: hey guys ... quick one to verify my understanding, I have a chef_gem resource with action :upgrade. My assumption here is that each run it will check rubygems.org and if there is a more current version it will upgrade?
[2014-06-12 13:32:44 -0400] ickymettle: looking in debug log it only appears to verify it is installed rather than doing any version checking
[2014-06-12 13:41:12 -0400] workmad3: ickymettle: heh :) https://github.com/opscode/chef/blob/master/lib/chef/provider/package/rubygems.rb#L545
[2014-06-12 13:41:40 -0400] ickymettle: yeah i'm digging through the code now
[2014-06-12 13:41:41 -0400] ickymettle: :(
[2014-06-12 13:44:19 -0400] zaargy: anyone used chef metal?
[2014-06-12 13:45:02 -0400] tier: zaargy: i'd like to but can't get it installed if that counts haha
[2014-06-12 13:45:32 -0400] zaargy: just a gem install right?
[2014-06-12 13:45:53 -0400] tier: yeah one of the gems that gets pulled down in the process keeps failing for me
[2014-06-12 13:46:31 -0400] zaargy: ah pretty standard ruby problem then ;)
[2014-06-12 13:46:36 -0400] zaargy: let me try
[2014-06-12 13:46:52 -0400] zaargy: installed fine here
[2014-06-12 13:47:04 -0400] ickymettle: i'm still waiting on lxc support for metal 0.11 ... it's quite awesome
[2014-06-12 13:47:50 -0400] jkeiser: ickymettle: if you want to test, I can release an
[2014-06-12 13:47:57 -0400] jkeiser: "alpha" of lxc metal
[2014-06-12 13:48:13 -0400] jkeiser: By which I mean "I modified all the code to where I think it will work, but I haven't had the time to test it at all"
[2014-06-12 13:48:19 -0400] ickymettle: jkeiser: I was trying to get your 'driver' branch working last night
[2014-06-12 13:48:29 -0400] jkeiser: ickymettle: sweet!  that's the one :)
[2014-06-12 13:48:53 -0400] zaargy: anyway, i was trying to work out if it has a concept of tiers? e.g. my database must be up before i can start my web servers
[2014-06-12 13:48:58 -0400] ickymettle: yeah i'm just trying to get my head around the driver model (thanks for the great documentation btw)
[2014-06-12 13:49:41 -0400] zaargy: specifically i'm interested in how this would work out for something like mongo which has three subroles that depend on each other (at least with teh cookbook we use)
[2014-06-12 13:49:59 -0400] ickymettle: jkeiser: one issue I did pickup last night was this: https://github.com/opscode/chef-metal-lxc/blob/driver/lib/chef_metal/driver_init/lxc.rb
[2014-06-12 13:50:41 -0400] zaargy: i am also brain storming how i could do autoscaling with this - maybe generate the dsl using data populated into etcd from my monitoring system
[2014-06-12 13:50:46 -0400] ickymettle: I got a little further managed to get a little further once the driver registered but ended up failing on missing canonicalize_url method -- was quite late at that time so didn't get futher into it
[2014-06-12 13:50:56 -0400] tier: zaargy: orchestration should be possible if you define the machines in the order you want them built
[2014-06-12 13:51:23 -0400] zaargy: right. i really need to just try it out.
[2014-06-12 13:51:28 -0400] ickymettle: jkeiser: metal has come along at perfect timing for us cos we're building out a bunch of new infra and being able to model it all in LXC ahead of time has been something i've been dreaming of for a while
[2014-06-12 13:52:20 -0400] jkeiser: ickymettle: what's the issue with the linked code?  Not seeing it at a glance
[2014-06-12 13:52:35 -0400] jkeiser: I'll go add a canonicalize_url, that was a late addition
[2014-06-12 13:53:17 -0400] ickymettle: the driver init maps to vagrant rather than LXC unless i'm misunderstanding what it does
[2014-06-12 13:54:09 -0400] ickymettle: ie. it doesn't register the "lxc" driver against ChefMetalLXC::LXCDriver
[2014-06-12 13:54:56 -0400] ickymettle: so in my test cookbook "with_driver 'lxc:/var/lib/lxc'" would fail because the lxc driver wasn't registered
[2014-06-12 13:55:27 -0400] jkeiser: ickymettle: both fixed, thanks!
[2014-06-12 13:55:32 -0400] jkeiser: I just pushed up the branch
[2014-06-12 13:55:33 -0400] ickymettle: rocken
[2014-06-12 13:55:37 -0400] ickymettle: thx
[2014-06-12 13:56:26 -0400] jkeiser: I appreciate the look-over. This has been on the top of my list but things keep intervening
[2014-06-12 13:59:15 -0400] ickymettle: yeah am totally happy to help wherever I can
[2014-06-12 14:04:29 -0400] ickymettle: jkeiser: we're getting closer https://gist.github.com/ickymettle/2c948a1f27b815349d28
[2014-06-12 14:11:39 -0400] jkeiser: ickymettle: ouch.  fixed that and a bunch of related things, I hope
[2014-06-12 14:11:43 -0400] bcave: srenatus: that was exactly how i reproduce it.
[2014-06-12 14:12:46 -0400] bcave: srenatus: unset HOME && chef-client -z > client-nohome.log 2>&1; export HOME=/root && chef-client -z > client-withhome.log 2>&1
[2014-06-12 14:13:59 -0400] bcave: you should be able to do it yourself now and replicate. I'm not sure which versions it affects, but i was getting it with 11.12.8. When was `-z` introduced?
[2014-06-12 14:20:17 -0400] Firespirit: what is the best way to execute exe in recipe for windows server
[2014-06-12 14:22:45 -0400] bcave: http://docs.opscode.com/resource_execute.html ?
[2014-06-12 14:41:33 -0400] Damacus: has anyone worked with chef-client in a docker container yet? I've seen some work on github. Mostly forks of one repo. But they're all using chef-zero. I'm not using puppet for a reason :/
[2014-06-12 14:42:07 -0400] jkeiser: Things that use chef-zero can also use chef server
[2014-06-12 14:42:24 -0400] jkeiser: chef-zero is generally there for quick startup
[2014-06-12 14:42:43 -0400] jkeiser: it's just a drop in local replacement for a chef server
[2014-06-12 14:43:31 -0400] Damacus: Yeah I'm not worried about quick startup. I'd like to run sensu in a container or two. But I'm getting chef-client already registered erros. For obvious reasons.
[2014-06-12 14:44:05 -0400] jkeiser: The point is anything using chef-zero should be able to switch to chef server by changing the URL to point to a chef server (if that's what you are looking for)
[2014-06-12 14:44:15 -0400] jkeiser: I'm not sure what the obvious reasons are actually
[2014-06-12 14:44:44 -0400] Damacus: I'm defintly making it harder for myself as I'm using Deis, which builds the dockerfiles for you. In that build process it seems to register the client
[2014-06-12 14:44:45 -0400] jkeiser: Are the two containers trying to use the same client name?
[2014-06-12 14:45:06 -0400] jkeiser: If you do that, you will have the same problem on a real chef server too
[2014-06-12 14:45:50 -0400] jkeiser: Damacus: you will need to have the image change the node_name on startup so that it creates a new client, I think
[2014-06-12 14:46:03 -0400] jkeiser: Damacus: that, or get rid of node_name from client.rb
[2014-06-12 14:46:06 -0400] Damacus: ok.
[2014-06-12 14:46:28 -0400] jkeiser: Damacus: assuming the hostname is different on the two containers, the node names will be different
[2014-06-12 14:46:49 -0400] Damacus: right, looks like I'm using the FQDN as my client name. The intermediate container must be being reused every time.
[2014-06-12 14:47:33 -0400] Damacus: which is nice, and a PITA.
[2014-06-12 15:22:02 -0400] jascbu: Hi all, I have been searching the web without much success for best practice (or just how) to add a directory path to the Linux PATH variable - can anyone help?
[2014-06-12 15:22:35 -0400] r3dk1ng: export PATH=${PATH}:/new/path
[2014-06-12 15:23:12 -0400] jascbu: Hi r3dk1ng. Can I put that in a recipe?
[2014-06-12 15:23:45 -0400] r3dk1ng: that will do it live... if you need it to stay persistant, then you'll need to add that to .bash_profile or /etc/profile depending on what you are doing
[2014-06-12 15:24:39 -0400] r3dk1ng: As a recipe.... it really depends if you need this as a system-wide setting on on a user-by-user case
[2014-06-12 15:24:55 -0400] jascbu: This one is system wide
[2014-06-12 15:25:45 -0400] orweinberger: I have created a server via 'knife ec2 server create' and installed a bunch of recipes on. Now I want to add a recipe to be installed on the already existing ec2 server. How do I do that?
[2014-06-12 15:25:51 -0400] r3dk1ng: for system wide... upi
[2014-06-12 15:25:57 -0400] r3dk1ng: you'll want a template
[2014-06-12 15:26:24 -0400] mattsurabian: jascbu: http://stackoverflow.com/questions/6284517/how-can-you-use-a-chef-recipe-to-set-an-environment-variable#comment34440900_14917841
[2014-06-12 15:27:10 -0400] mattsurabian: using magic_shell https://github.com/customink-webops/magic_shell
[2014-06-12 15:29:36 -0400] znsatchel: Has anyone used the windows cookbook? I'm running into issues with it.
[2014-06-12 15:29:55 -0400] jascbu: mattsurabian: ok do for $PATH I could use:  "magic_shell_environment 'PATH' do value '$PATH:whatever' end" ?
[2014-06-12 15:33:24 -0400] znsatchel: I keep getting an error trying to install an executable, the error reads "Option installer_type must be a kind of [String]!", however, the documentation states an entry of :installshield, :wise, :inno
[2014-06-12 15:34:45 -0400] mattsurabian: yep
[2014-06-12 15:34:49 -0400] mattsurabian: should be able to jascbu
[2014-06-12 15:35:05 -0400] jascbu: r3dk1ng: mattsurabian: thank you, I'll give those a go
[2014-06-12 15:36:53 -0400] cwj: znsatchel: strings/symbols for that changed recently. what version of the windows cookbook are your nodes getting?
[2014-06-12 15:37:26 -0400] cwj: hrm maybe not that recently, but i feel like i ran into this
[2014-06-12 15:38:21 -0400] MikeTLive: when a cookbookA depends on cookbookX, would you call a change to cookbookX a downstream or upstream change?
[2014-06-12 15:38:24 -0400] znsatchel: windows cookbook ver 1.31.0
[2014-06-12 15:39:48 -0400] qhartman: I'm working on updating some automation for bootstrapping nodes in EC2 from chef-10 to chef-11. It's generally working well, but the "knife[:secret_file]" option in my knife.rb doesn't seem to be working. Do I need to set some other config option to make it effective? The docs make it seem that it should work on it's own.
[2014-06-12 15:39:56 -0400] cwj: znsatchel: looks like that version should definitely expect a symbol https://github.com/opscode-cookbooks/windows/blob/v1.31.0/resources/package.rb#L29
[2014-06-12 15:40:50 -0400] cwj: so i wonder if your node is getting a different version of that cookbook than you think it is?
[2014-06-12 15:41:36 -0400] stard0g101: hey all
[2014-06-12 15:42:10 -0400] stard0g101: quick question.. am getting this error on a chef-client run: Chef::Exceptions::RecipeNotFound: could not find recipe file /home/ubuntu/run
[2014-06-12 15:42:29 -0400] stard0g101: there is no ubuntu recipe? (i just upgraded to latest chef) seem to be missing a clue
[2014-06-12 15:45:21 -0400] Firespirit: I look for a way to copy file locally on a server at the execution time and not compile time
[2014-06-12 15:45:27 -0400] Firespirit: windows server
[2014-06-12 15:45:33 -0400] Firespirit: how i can do this
[2014-06-12 15:45:39 -0400] Firespirit: execute block?
[2014-06-12 16:45:05 -0400] qhartman: I'm working on updating some automation for bootstrapping nodes in EC2 from chef-10 to chef-11. It's generally working well, but the "knife[:secret_file]" option in my knife.rb doesn't seem to be working. Do I need to set some other config option to make it effective? The docs make it seem that it should work on it's own.
[2014-06-12 17:01:25 -0400] masterkorp: hello
[2014-06-12 17:01:34 -0400] masterkorp: can i give test kitchen vagrant options ?
[2014-06-12 17:01:43 -0400] masterkorp: like give me an IP on my network
[2014-06-12 17:02:02 -0400] masterkorp: so i can go there and connect to some services ?
[2014-06-12 17:03:26 -0400] cheeseplus: masterkorp: yep, the config options available are here https://github.com/test-kitchen/kitchen-vagrant
[2014-06-12 17:06:08 -0400] masterkorp: thank you sir
[2014-06-12 17:51:35 -0400] mati_user_ctes: Team, I have install chef_server on Ubuntu 10.04 with an already ngnix install.  Any good documentation to add chef to my already running ngnix. Thanks.
[2014-06-12 18:25:03 -0400] sdegutis: Hi.
[2014-06-12 18:26:29 -0400] evaryont: hello #chef! Is there a way to call include_recipe from a LWRP?
[2014-06-12 18:27:33 -0400] zanshin: evaryont: http://www.fewbytes.com/using-include_recipe-in-chef-lwrp/
[2014-06-12 18:27:53 -0400] evaryont: ah, missed that link. Thanks!
[2014-06-12 18:40:06 -0400] mallu: hi, I was wondering if anyone using wait condition with cloudformation at AWS
[2014-06-12 18:40:33 -0400] mallu: we want to make sure chef-client run completes before brining up additional instances
[2014-06-12 18:40:52 -0400] mallu: any help would be greatly appreciated
[2014-06-12 18:44:32 -0400] mallu: anyone?
[2014-06-12 18:44:47 -0400] mikesplain: Haven't used Cloudformation sorry
[2014-06-12 18:52:38 -0400] riceandbeans: has anyone here used puppet before?
[2014-06-12 18:54:46 -0400] bandicot: mallu - I've not waited on a Chef run before, but I've used some wait conditions with CFN. Because the URL for your WaitConditionHandle is dynamically generated, you need to pass it into your system with User Data. For a basic proof-of-concept, you could try to catch the exit code of the chef-client run and trigger cfn-signal based on the response.
[2014-06-12 18:56:01 -0400] mallu: bandicot: thank you.. I'm new to AWS... do you have any examples I can take a look?
[2014-06-12 18:57:35 -0400] bandicot: mallu - This URL has a very basic example, showing how to integrate calls to cfn-signal into the UserData section of an instance creation: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-signal.html
[2014-06-12 18:58:02 -0400] gsbiju: hello there.. trying to run the following code in a recipe .....servers.each do |server|   server['queries'] = node['jmxtrans']['default_queries']['jvm']
[2014-06-12 18:58:31 -0400] shlant: coderanger: do you know if it's possible to use citadel with the aws-rds cookbook? the LWRP requires AWS access keys
[2014-06-12 18:58:35 -0400] gsbiju: on 11.12 chef.. looks like the variable server is now considered as a node attribute
[2014-06-12 19:00:53 -0400] gsbiju: Hello there.. any suggestions to move the following ruby code to 11.12. servers.each do |server|   server['queries'] = node['jmxtrans']['default_queries']['jvm']
[2014-06-12 19:01:09 -0400] bandicot: mallu - If you don't have direct access to the chef-client return code, you could just loop for a certain period of time within the user-data script and inspect the system for signs that the Chef run completed.
[2014-06-12 19:01:15 -0400] mallu: bandicot: so cfn-signal is a bash script? I need to
[2014-06-12 19:01:30 -0400] bandicot: mallu - . . . though that's a pretty nasty hack.
[2014-06-12 19:01:58 -0400] mallu: I have access to the exit code for chef-client run
[2014-06-12 19:03:06 -0400] bandicot: mallu - cfn-signal is available for linux and windows
[2014-06-12 19:07:32 -0400] shlant: anyone use the rbenv cookbook? Is it possible to install at ~/.rbenv?
[2014-06-12 19:08:08 -0400] jameson__: anyone else using the rabbitmq cookbook and know the work around for user's disappearing on restart?
[2014-06-12 19:08:25 -0400] jameson__: I know the work-around is to re-run the recipe but :\
[2014-06-12 19:10:24 -0400] giocalitri: Hi all, I opened a question on stackoverflow: http://stackoverflow.com/questions/24188355/install-repositories-from-multiple-files-and-recreate-yum-cache-only-once
[2014-06-12 19:17:36 -0400] ambientsound: Is it possible in some way to modify an attribute in a loop?
[2014-06-12 19:18:23 -0400] ambientsound: e.g. node['foo']['bar'].each do |n| n['baz'] = 1 end
[2014-06-12 19:19:39 -0400] jharley: ambientsound: n.set[baz] = 1 might work.  I didnt check your code ahead of that, tho :)
[2014-06-12 19:20:15 -0400] ambientsound: I've tried that.
[2014-06-12 19:20:26 -0400] ambientsound: there's no method "set" on [].
[2014-06-12 19:20:36 -0400] ambientsound: I'd have to do node.set
[2014-06-12 19:22:27 -0400] ambientsound: The actuall error is "NoMethodError" Undefined method or attribute `set' on `node'
[2014-06-12 19:24:13 -0400] riceandbeans: anyone here used puppet before?
[2014-06-12 19:29:21 -0400] evaryont: riceandbeans: I have.
[2014-06-12 19:31:56 -0400] evaryont: is there a way to specify an LWRP's default value for an attribute to another attribute? I have an LWRP with long_name & short_name, and long_name defaults to short_name (or the developer can override it with a longer name, useful in descriptions)
[2014-06-12 19:32:11 -0400] riceandbeans: evaryont: have you used foreman?
[2014-06-12 19:32:25 -0400] evaryont: riceandbeans: a bit, on my own personal servers
[2014-06-12 19:32:36 -0400] riceandbeans: evaryont: is there a chef equivalent?
[2014-06-12 19:33:15 -0400] evaryont: well, chef-server does a lot of similar things. though it more closely intersects with PE's dashboard.
[2014-06-12 19:33:24 -0400] evaryont: what are you looking for?
[2014-06-12 20:00:12 -0400] riceandbeans: evaryont: an ENC type deal
[2014-06-12 20:00:21 -0400] riceandbeans: or maybe provisioning with chef too like foreman does
[2014-06-12 20:00:41 -0400] coderanger: shlant: Yes, you can get the configured citadel keys via "citadel.access_key_id" et al
[2014-06-12 20:15:06 -0400] Brad_K: Here's a strange one  has anyone else seen the error message "cannot load such file -- chef/http/remote_request_id"?
[2014-06-12 20:15:33 -0400] Brad_K: For some context, a slightly sanitized copy of log output can be found at https://gist.github.com/bknowles/8309ea26e2ae0cc5f602
[2014-06-12 20:15:58 -0400] Brad_K: That also includes a bit of code at the bottom showing the program that called the routine which bombed.
[2014-06-12 20:18:12 -0400] coderanger: Brad_K: cheffish requires newer chef than you are running (most likely)
[2014-06-12 20:18:33 -0400] Brad_K: Really?  Like, newer than 11.8.2?
[2014-06-12 20:18:51 -0400] Brad_K: Is this a new version of cheffish that has been published within the last few hours, or the last day?
[2014-06-12 20:19:24 -0400] coderanger: Brad_K: https://github.com/opscode/chef/commit/a4cdce667a1bc1828eea875bdf3f49af6d96da70
[2014-06-12 20:19:32 -0400] coderanger: Brad_K: File shows as first added in 11.12
[2014-06-12 20:20:31 -0400] Brad_K: Yeah, but we've been doing deploys and builds including cheffish on a daily basis, up to and including last night.  We've never seen this error before.
[2014-06-12 20:20:55 -0400] Brad_K: We are using Hosted Chef  could this be a problem due to the Enterprise Hosted Chef outage/upgrade/whatever from yesterday?
[2014-06-12 20:21:35 -0400] coderanger: Brad_K: Cheffish 0.5 was released on June 4th
[2014-06-12 20:21:46 -0400] coderanger: and no, this has nothing to do with the server, your client is out of date
[2014-06-12 20:22:17 -0400] coderanger: Or you should specify that you want cheffish 0.4
[2014-06-12 20:22:19 -0400] coderanger: either way
[2014-06-12 20:23:38 -0400] Brad_K: I can't understand how we could have done a deployment yesterday that included cheffish and that worked fine, and now we have this bomb today.  But I'll try locking us down to version 0.4 of that gem, at least for the meanwhile.
[2014-06-12 20:23:40 -0400] Brad_K: Thanks!
[2014-06-12 20:24:58 -0400] coderanger: Brad_K: What action do you have on the chef_gem?
[2014-06-12 20:25:09 -0400] coderanger: install vs. upgrade would change things
[2014-06-12 20:25:53 -0400] coderanger: Brad_K: The default is install, which is _not_ convergent across all machines
[2014-06-12 20:26:10 -0400] coderanger: Brad_K: Since your existing machines had 0.4 already, they would be left alone, but any new machines would install 0.5
[2014-06-12 20:26:23 -0400] coderanger: so protip never use action :install without an explicit version :)
[2014-06-12 20:28:39 -0400] Brad_K: We have a Gemfile and a Gemfile.lock that specifies cheffish, but it looks like it doesn't lock down the specific version we require.
[2014-06-12 20:29:08 -0400] Brad_K: Do you have a recommended method of generating a fully locked down Gemfile.lock that would specify the exact version of each and every gem, much like is done with Berksfile.lock?
[2014-06-12 20:29:40 -0400] Brad_K: I'm fine with tracking this stuff in our repo according to the appropriate method, but I'm unclear on the best way to find out the full list of exact current dependencies.
[2014-06-12 20:30:46 -0400] coderanger: Brad_K: I don't think you are doing that
[2014-06-12 20:31:00 -0400] coderanger: Brad_K: The error message you pasted shows "chef_gem 'cheffish'"
[2014-06-12 20:31:13 -0400] coderanger: Brad_K: Also I would have no idea how you would use bundle like that within chef
[2014-06-12 20:33:26 -0400] Brad_K: Thanks!
[2014-06-12 20:33:35 -0400] Brad_K: @coderanger ^^
[2014-06-12 20:50:27 -0400] Brad_K: Bizarre.
[2014-06-12 20:50:57 -0400] Brad_K: So, I updated that code to specifically require version 0.4 of cheffish, and I got a warning I hadn't seen before, and then the same error.  Here
[2014-06-12 20:51:02 -0400] Brad_K: Here's the warning:
[2014-06-12 20:51:05 -0400] Brad_K: WARNING:  Error fetching data: too many connection resets (http://production.s3.rubygems.org/specs.4.8.gz)
[2014-06-12 20:51:05 -0400] Brad_K: Fetching: cheffish-0.4.gem (100%)0.4.gem
[2014-06-12 20:51:34 -0400] Brad_K: Then I get that same recipe compile error.  ;-(
[2014-06-12 20:51:53 -0400] medya: what would be the command to find the node that has word "jboss" in the title ?
[2014-06-12 20:52:49 -0400] Brad_K: medya: Try "knife node list | grep jboss'.  Or, you could do a knife node search instead, but I don't remember the syntax off the top of my head.
[2014-06-12 20:53:45 -0400] medya: @Brad_k I found out the command knife search node 'name:jboss*'
[2014-06-12 20:53:50 -0400] medya: how can I get that node's ip
[2014-06-12 20:53:58 -0400] Brad_K: that sounds like it would work.
[2014-06-12 20:54:14 -0400] Brad_K: Do a "knife node show nodename".
[2014-06-12 20:55:31 -0400] Brad_K: If you do a "knife node show nodename -l" (that's a lowercase "L" character at the end there), then you'll get a "long listing" that includes all currently known information about that node.
[2014-06-12 20:55:50 -0400] korishev: Hello all, I have a question about local-mode.  My system uses roles in .rb files, not .json, and chef-client -z role list does not appear to see them.  Am I just out of luck?
[2014-06-12 20:56:20 -0400] medya: Brad_K how can I put that in a recipe ? lets say I have a template file I wanna put the ip address of in the template of a node that has jboss in the name
[2014-06-12 20:58:15 -0400] Brad_K: medya: I don't remember the syntax off the top of my head, but I know there's a way to achieve what you want using search.  I'd go digging through the information available at docs.opscode.com, which includes a Javascript-powered site-specific search engine.
[2014-06-12 21:01:33 -0400] Brad_K: korishev: I've never used the particular syntax you're trying to use with chef-client.  I've always used knife for that sort of thing, and had it talk to a chef-server on the other end.  Whatever format you have in your local filesystem, you should be able to use knife to upload those to the chef-server on the other end, at which point the standard API techniques should work and it shouldn't matter what formation the files are in.
[2014-06-12 21:01:54 -0400] Brad_K: Anyway, I've got to run.  I'll be back in a while.
[2014-06-12 21:02:24 -0400] korishev: @Brad_K  You are right, it is a knife command Im trying to use.
[2014-06-12 21:03:35 -0400] korishev: and in local-mode, Im not uploading them anywhere, it points things at the local file system
[2014-06-12 21:08:31 -0400] coderanger: korishev: That is correct, chef_fs only supports JSON for roles and envs
[2014-06-12 21:09:40 -0400] korishev: coderanger: thanks for the info!
[2014-06-12 21:15:35 -0400] wdpro_kevin: anyone have passwd_min.rb ohai plugin code available? My ohai is overflowing with etc.
[2014-06-12 21:19:27 -0400] rbattula: I'm trying to use the chef-monit cookbook (https://github.com/phlipper/chef-monit) I get this error: "No resource or method named `monit_monitrc' for `Chef::Recipe" even though I declared the dependency in metadata.rb, the monitrc resource and provider exist in the chef-monit cookbook
[2014-06-12 21:19:30 -0400] rbattula: thoughts?
[2014-06-12 21:23:18 -0400] coderanger: wdpro_kevin: You can just disable the plugin if you don't use the data
[2014-06-12 21:23:37 -0400] surge_: For OS X, will chef look for client.rb under /etc/chef as it does for Linux distros?
[2014-06-12 21:24:26 -0400] coderanger: surge_: Yes
[2014-06-12 21:27:42 -0400] rbattula: btw, I'm using chef version 11.10.4
[2014-06-12 21:29:54 -0400] coderanger: rbattula: If you run with "-l debug", do you see the monit cookbook loading and is it the version you expect?
[2014-06-12 21:30:49 -0400] coderanger: rbattula: Of note, make you you aren't loading the monit cookbook from the community site, it is sometimes easy to end up with a bad version uploaded to your chef server
[2014-06-12 21:31:09 -0400] surge_: Okay, so i set ssl_verify_mode :verify_peer but when I run knife ssl check , it still fail.s
[2014-06-12 21:31:11 -0400] surge_: fails*
[2014-06-12 21:31:50 -0400] syshero: someone has seen an issue where erchef uses all available cpu if you have more than 1000 nodes fetching the serialized data from postgresql?
[2014-06-12 21:32:02 -0400] coderanger: surge_: knife doesn't use client.rb
[2014-06-12 21:32:14 -0400] coderanger: syshero: What version of chef-server
[2014-06-12 21:32:39 -0400] syshero: 11.1.1-1
[2014-06-12 21:34:13 -0400] coderanger: okay, so latest
[2014-06-12 21:34:14 -0400] surge_: coderanger: Err, so what do I do to remedy this ? ssl_ca_path is nil, so is ssl_ca_file, the trusted certs dir is under my .chef/trusted_certs directory but the cert is not self signed soo.. I guess I can add the path to the bundle.
[2014-06-12 21:34:28 -0400] coderanger: surge_: knife settings go in the knife.rb
[2014-06-12 21:34:49 -0400] rbattula: @coderanger: chef-monit version 1.5.3 loads which is what I expect. the strange thing is that even though the monit_monitrc is called from the default recipe of chef-monit and the resources are defined in that chef-monit cookbook itself...
[2014-06-12 21:34:55 -0400] surge_: Well I know that, but I was under the impression that ssl_verify_mode belonged in a file called client.rb only NOT knife.rb
[2014-06-12 21:35:17 -0400] coderanger: syshero: So it would just be a question of how your setup is tuned, Hosted Chef supports a lot more users than that so it is definitely possible :)
[2014-06-12 21:35:30 -0400] rbattula: coderanger: and I'm using the chef-monit cookbook that I got from a git repo, this is different from the one on the community site
[2014-06-12 21:35:40 -0400] syshero: https://gist.github.com/caquino/c7cfd24f879663b0bc10
[2014-06-12 21:35:45 -0400] coderanger: syshero: But open source chef-server fresh out of the box is probably not very well configured for that hige a load
[2014-06-12 21:36:15 -0400] syshero: @coderanger I have the impression that's the problem is related to too many searches retrieving the serialized data from a big number of nodes
[2014-06-12 21:36:21 -0400] workmad3: surge_: client.rb is config for running chef-client, knife.rb is config for running knife... there's a fair bit of overlap between the two
[2014-06-12 21:36:45 -0400] syshero: pgsql has no locking querys and 99.9 cache hit
[2014-06-12 21:36:51 -0400] coderanger: surge_: The two files are both chef config files, they are just used by different programs
[2014-06-12 21:36:56 -0400] syshero: solr answering in less than 1 second
[2014-06-12 21:37:14 -0400] coderanger: syshero: Indeed, fetching a blob based on an indexed column should be quite fast
[2014-06-12 21:37:33 -0400] coderanger: syshero: It is possible the JSON overhead is getting you, how much CPU power does the machine have?
[2014-06-12 21:37:48 -0400] coderanger: syshero: Or rather, machines, since thats probably more traffic than I would want on a single erchef node
[2014-06-12 21:37:53 -0400] syshero: it's a virtual machine with 12 cpus and 16gb ram
[2014-06-12 21:38:15 -0400] syshero: your previous statement maybe clarified some things
[2014-06-12 21:38:20 -0400] coderanger: rbattula: can you pastebin the recipe that is erroring?
[2014-06-12 21:38:35 -0400] syshero: as I don't have any idea about the recomended number of nodes for the setup I have
[2014-06-12 21:39:01 -0400] coderanger: syshero: Anything over ~500 and I would start working on an HA/load balanced setup
[2014-06-12 21:39:11 -0400] rbattula: coderanger: its actually on github :) https://github.com/phlipper/chef-monit/blob/master/recipes/default.rb#L73
[2014-06-12 21:39:41 -0400] syshero: coderanger thanks :) this answers my question
[2014-06-12 21:39:49 -0400] coderanger: rbattula: I thought you said this was in a wrapper?
[2014-06-12 21:40:19 -0400] coderanger: syshero: you can certainly dive in to erlang profiling tools, though I would guess JSON en/decoding is killing you
[2014-06-12 21:41:01 -0400] syshero: it's what I'm thinking too,  also that the JSON is gziped inside of the bytea field
[2014-06-12 21:41:33 -0400] coderanger: syshero: The converge interval also matters a lot, 1000 nodes each running once a day (on a smooth splay) is no big deal, but 1000 nodes times every 5m  :)
[2014-06-12 21:41:48 -0400] coderanger: syshero: JSON decoding is generally several orders of magnitude slower than gzip
[2014-06-12 21:42:10 -0400] surge_: coderanger: Okay, so basically Im gonna need some hand holding here what exactly do I need to do so that when I use KNIFE from my workstation to bootstrap a remote node in EC2 that will run chef CLIENT, to get it to verify_peer? Edit the bootstrap template?
[2014-06-12 21:42:25 -0400] syshero: agreed, bust it's just ah extra cpu utilization on the "micro optimization" side, but you're entirely right
[2014-06-12 21:42:56 -0400] coderanger: syshero: Also obligatory plug, if you want some help with the HA/LB setup, I offer training and consulting for advanced chef usage :)
[2014-06-12 21:43:03 -0400] syshero: maybe reducing the node json may help using an whitelist on the attributes, but I'm not sure if this is the way I would like to go
[2014-06-12 21:43:10 -0400] rbattula: @coderanger: http://pastebin.com/5KLU1zif pretty small but maybe this'll provide some context
[2014-06-12 21:44:05 -0400] syshero: coderanger nice, I will share put this idea on the table during the meeting.
[2014-06-12 21:44:36 -0400] coderanger: surge_: Thats not something I think is currently handled (https://github.com/opscode/chef/blob/master/lib/chef/knife/core/bootstrap_context.rb#L63-L89), you can definitely fix it by making a bootstrap template though
[2014-06-12 21:45:24 -0400] coderanger: rbattula: Hmm, that shouldn't be chef-monit, you renamed the cookbook
[2014-06-12 21:45:48 -0400] coderanger: rbattula: LWRP names are based on the cookbook name, so when you renamed the cookbook the LWRP became chef_monit_monitrc
[2014-06-12 21:47:15 -0400] surge_: coderanger: Im just looking to resolve the warning thats new in the latest version of chef because its still defaulting to verify_none.
[2014-06-12 21:47:23 -0400] coderanger: surge_: Indeed
[2014-06-12 21:47:39 -0400] surge_: But didnt know how to go about that since there is very little online on how to do it.
[2014-06-12 21:47:59 -0400] coderanger: surge_: Yep :-(
[2014-06-12 21:48:18 -0400] coderanger: surge_: If you want to fix by making a custom template I can walk you through it
[2014-06-12 21:50:39 -0400] surge_: Well, in that case it seems like its what I was attempting before. Probably do something like mkdir /etc/chef, echo ssl_verify_mode :verify_peer | /etc/chef/client.rb probably at the top of the template I would imagine.
[2014-06-12 21:51:30 -0400] surge_: err not pipe.. > but you get what i mean
[2014-06-12 21:53:35 -0400] coderanger: surge_: No, that will get overwritten
[2014-06-12 21:54:02 -0400] coderanger: surge_: Just after this line https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb#L66 add your SSL config
[2014-06-12 21:56:12 -0400] j^2: boom
[2014-06-12 21:56:16 -0400] j^2: opps
[2014-06-12 21:58:09 -0400] surge_: Man, definitely overthought that one. Thanks coderanger
[2014-06-12 22:02:47 -0400] Brad_K: coderanger: Did you have a good lunch?
[2014-06-12 22:03:31 -0400] coderanger: Brad_K: local curry place, its not bad, though nothing to write home about
[2014-06-12 22:04:28 -0400] double_p: yumyum http://www.youtube.com/watch?v=Ua0uY9WrYXE
[2014-06-12 22:04:38 -0400] Brad_K: Hmm.  Sometimes I wish I liked spicy food, so that I could enjoy a good curry.
[2014-06-12 22:05:16 -0400] Brad_K: Anyway, I had to log off so that I could pick up my cat at the vet and bring her back to the house.
[2014-06-12 22:05:44 -0400] Brad_K: coderanger: I don't suppose you saw my messages regarding cheffish 0.4?
[2014-06-12 22:06:18 -0400] double_p: brad: if you like scottisch - yah
[2014-06-12 22:06:43 -0400] coderanger: Brad_K: Yeah, it sounds like something failed to install
[2014-06-12 22:07:09 -0400] coderanger: Also 0.4.1 is probably the version you want
[2014-06-12 22:07:18 -0400] coderanger: Or at least thats the latest in the 0.4 series
[2014-06-12 22:07:21 -0400] coderanger: jkeiser ^^
[2014-06-12 22:07:24 -0400] Brad_K: It's a compile time error that happens right as we're trying to do a chef_gem install of cheffish.
[2014-06-12 22:07:30 -0400] Brad_K: Okay, I'll try that.
[2014-06-12 22:07:37 -0400] coderanger: Yes, chef_gem runs at compile time
[2014-06-12 22:08:14 -0400] double_p: coderanger: RIGHT where :webmon" or such does
[2014-06-12 22:08:28 -0400] coderanger: double_p: Hmm?
[2014-06-12 22:08:30 -0400] double_p: ewps
[2014-06-12 22:08:40 -0400] double_p: coderanger: sorry :)
[2014-06-12 22:09:19 -0400] double_p: i am so angry, i even forgot where to rant :P
[2014-06-12 22:11:05 -0400] Brad_K: uh, that's weird.
[2014-06-12 22:11:17 -0400] double_p: there: http://www.youtube.com/watch?v=AC3-A5Ky1mU
[2014-06-12 22:11:43 -0400] Brad_K: Why would I be getting an internal server error when uploading a cookbook?
[2014-06-12 22:12:04 -0400] Brad_K: knife cookbook upload factory
[2014-06-12 22:12:04 -0400] Brad_K: Uploading factory    [0.3.8]
[2014-06-12 22:12:05 -0400] Brad_K: Syntax OK
[2014-06-12 22:12:05 -0400] Brad_K: ERROR: internal server error
[2014-06-12 22:12:06 -0400] Brad_K: Response: internal service error
[2014-06-12 22:12:13 -0400] surge_: coderanger: Ok I was fighting with it for a bit, but I finally got it. Have to set verify_peer AND set ssl_ca_path to /etc/ssl/certs which is curious, because that should be the default.
[2014-06-12 22:12:23 -0400] surge_: :)
[2014-06-12 22:12:34 -0400] surge_: Thanks!!!!
[2014-06-12 22:12:36 -0400] coderanger: surge_: One does not simply TLS
[2014-06-12 22:12:40 -0400] coderanger: (.gif)
[2014-06-12 22:12:40 -0400] surge_: LOL
[2014-06-12 22:13:01 -0400] surge_: Feeling like an amateur all over again with Chef.
[2014-06-12 22:13:10 -0400] Brad_K: Ouch, that's gotta hurt.  I don't care what planet you're from!
[2014-06-12 22:21:31 -0400] rbattula: coderanger: it was the cookbook name! looks like chef (verison 11.10.4) uses the directory name for a cookbook even though a name field is specified in metadata.rb
[2014-06-12 22:22:05 -0400] coderanger: rbattula: Indeed, they should always match
[2014-06-12 22:23:31 -0400] double_p: OT and back then..http://www.youtube.com/watch?v=WLE7hcSgxlM :)
[2014-06-12 22:29:08 -0400] Scrivener: workmad3, Another noobish question -- if you're familiar at all with opsworks, do you know if you can run a chef recipe from a deploy hook there?
[2014-06-12 22:29:42 -0400] Scrivener: We think we've narrowed the issue down, and the method we're using to write the database.yml is occurring after the application searches for one.
[2014-06-12 22:29:45 -0400] workmad3: Scrivener: I've not done anything with opsworks i'm afraid
[2014-06-12 22:30:21 -0400] Scrivener: I've got recipes that do their own individual things, but none that call other recipes -- there's gotta be a quick one-liner for "run this recipe" in chef, right?
[2014-06-12 22:30:25 -0400] Scrivener: I could just try it.
[2014-06-12 22:31:27 -0400] Brad_K: coderanger: dang.  same error, even with cheffish-0.4.1.  ;-(
[2014-06-12 22:33:35 -0400] Brad_K: Scrivener: If you're talking about a way to run a recipe from another recipe, it's just:
[2014-06-12 22:33:35 -0400] Brad_K: include_recipe "cookbook::recipe"
[2014-06-12 22:33:58 -0400] Scrivener: Brad_K, I'm using chef deployment hooks as per http://docs.aws.amazon.com/opsworks/latest/userguide/workingcookbook-extend-hooks.html
[2014-06-12 22:34:06 -0400] Scrivener: And just thought I might as well try running a recipe from one
[2014-06-12 22:34:16 -0400] coderanger: Brad_K: Did you uninstall version 0.5? Rubygems doesn't do that automatically
[2014-06-12 22:34:19 -0400] Scrivener: If there's anyway to accomplish that.
[2014-06-12 22:34:21 -0400] Brad_K: Oh.  Opsworks.  Sorry, don't know anything about how they  modified that.
[2014-06-12 22:34:25 -0400] coderanger: Brad_K: (and it uses the latest version)
[2014-06-12 22:34:49 -0400] coderanger: Brad_K: Or just scrap the box and start over :)
[2014-06-12 22:35:36 -0400] Brad_K: coderanger: oh.  Didn't know that it automatically used the latest version that was installed, even if you explicitly specified an older version that you wanted  which was also installed.  Okay, no big deal.
[2014-06-12 22:35:54 -0400] workmad3: Brad_K: you can 'activate' the older version with rubygems
[2014-06-12 22:36:06 -0400] workmad3: Brad_K: but without activating it, you end up with the latest available... just how rubygems works
[2014-06-12 22:36:13 -0400] coderanger: You can, but if you just do "require foo" as that recipe does, yeah
[2014-06-12 22:36:21 -0400] workmad3: Brad_K: you'd activate it with 'gem "cheffish", "version"' followed by your require
[2014-06-12 22:36:49 -0400] Brad_K: How do you work the version number into the require?
[2014-06-12 22:37:15 -0400] workmad3: Brad_K: once you've activated it with a 'gem' line, you don't need to work the version into the require
[2014-06-12 22:37:31 -0400] Brad_K: workmad3: Sorry, as most everyone else here can tell you, I'm definitely not a Ruby expert nor a rubygems expert.
[2014-06-12 22:37:32 -0400] coderanger: I really wouldn't do this
[2014-06-12 22:37:40 -0400] coderanger: Just uninstall the bad version
[2014-06-12 22:37:46 -0400] workmad3: ^^ that would be most sensible
[2014-06-12 22:37:46 -0400] coderanger: or nuke the machine
[2014-06-12 22:38:21 -0400] double_p: damals http://www.youtube.com/watch?v=bkysjcs5vFU
[2014-06-12 22:38:37 -0400] Brad_K: We're trying to debug what is going wrong with our code in other areas, so it's actually important that we keep this machine around until we can figure out what the other problem is.
[2014-06-12 22:39:05 -0400] Brad_K: Nuking this machine doesn't help us solve the larger problem of what might be going wrong with our code in that other area.
[2014-06-12 22:44:18 -0400] coderanger: Brad_K: Then either use another chef_gem resource to do the delete, or do it by hand
[2014-06-12 22:45:36 -0400] Brad_K: WTF?!?
[2014-06-12 22:45:38 -0400] Brad_K: 10.13.3.51 [2014-06-12T22:43:21+00:00] ERROR: SSL Validation failure connecting to host: s3-external-1.amazonaws.com - SSL_connect SYSCALL returned=5 errno=0 state=SSLv3 read finished A
[2014-06-12 22:45:46 -0400] jbz: stupid question
[2014-06-12 22:45:56 -0400] jbz: if I use a :notifies on a git resource with the :sync action
[2014-06-12 22:46:05 -0400] Brad_K: coderanger: yeah, creating another chef_gem resource to do the :remove action worked.  Thanks!
[2014-06-12 22:46:06 -0400] jbz: does that notify if the repo changes?  Or every time the resource syncs?
[2014-06-12 22:46:18 -0400] Brad_K: Now I've got this whacky ssl error with amazon.  ;-(
[2014-06-12 22:48:34 -0400] coderanger: jbz: I don't actually see it trigger notifications ever in the code
[2014-06-12 22:48:58 -0400] jbz: @coderanger: really? lol was going by last example on http://docs.opscode.com/resource_git.html
[2014-06-12 22:49:28 -0400] coderanger: jbz: It might be buried in a mixin or something that I don't see, but https://github.com/opscode/chef/blob/master/lib/chef/provider/git.rb
[2014-06-12 22:58:17 -0400] Brad_K: coderanger: The only way we are using Amazon here is through Hosted Chef.  Any ideas why we would be getting SSL validation failures like this with HC?
[2014-06-12 22:58:35 -0400] coderanger: Brad_K: What does your TLS verification config look like in client.rb?
[2014-06-12 23:00:45 -0400] mallu: has anyone used wait condition with cloudformation in AWS?
[2014-06-12 23:00:59 -0400] coderanger: mallu: What about them?
[2014-06-12 23:01:38 -0400] mallu: we want to wait till chef client run finish before bringing other instances
[2014-06-12 23:01:50 -0400] mallu: wondering how I can do that via cloudformation
[2014-06-12 23:02:15 -0400] mallu: someone pointed me to this link http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/cfn-signal.html
[2014-06-12 23:02:36 -0400] mallu: my question is how do I get the waitconditionhandle.url
[2014-06-12 23:02:52 -0400] mallu: I have access to the exit code of chef-client
[2014-06-12 23:03:15 -0400] mallu: I can call /opt/aws/bin/cfn-signal -e $?
[2014-06-12 23:03:25 -0400] coderanger: mallu: It is available in your metadata when composing the init script
[2014-06-12 23:03:39 -0400] Brad_K: coderanger: i'm not seeing any specific TLS verification config in client.rb on that machine.
[2014-06-12 23:03:40 -0400] coderanger: mallu: So pass it in as an attribute, and then use http_request from within chef
[2014-06-12 23:04:00 -0400] coderanger: Brad_K: What OS, or more specifically, how recent are the CA certs on it?
[2014-06-12 23:04:10 -0400] mallu: coderanger: Sorry you completely lost me
[2014-06-12 23:04:42 -0400] Brad_K: coderanger: sorry, can you give me a clue where the CA certs would be?
[2014-06-12 23:05:01 -0400] coderanger: mallu: So in ec2::instance resource you compose a script and cram it in userdata, yes?
[2014-06-12 23:05:13 -0400] coderanger: mallu: That script is what is run to bootstrap the machine after bootup
[2014-06-12 23:05:19 -0400] Brad_K: This is an RH 6.4 image, but beyond that I'm not sure exactly how "recent" it is.
[2014-06-12 23:05:34 -0400] coderanger: Brad_K: /etc/ssl/certs normally, and that might not have recent enough CAs, you can override it though
[2014-06-12 23:06:16 -0400] Brad_K: The ca certs we have in that directory are from Dec 17 17:44.
[2014-06-12 23:06:46 -0400] mallu: coderanger: We have a bash script that download chef-client and install it in the instance then run chef-client
[2014-06-12 23:07:01 -0400] coderanger: mallu: Yes, and in that you create a first-run.json
[2014-06-12 23:07:09 -0400] coderanger: mallu: in that you can populate initial attributes
[2014-06-12 23:07:38 -0400] coderanger: mallu: Use the cfn getatt function to grab the URL from the wait resource, and include it in that file
[2014-06-12 23:08:01 -0400] mallu: ok.. so how do I get the dynamic url WaitConditionHandle creates?
[2014-06-12 23:08:15 -0400] coderanger: mallu: Also obligatory plug, I offer training and consulting services for this kind of advanced chef usage
[2014-06-12 23:09:05 -0400] mallu: coderanger: I wish I have th power to make that decision
[2014-06-12 23:09:23 -0400] coderanger: mallu: Oops, you want Ref, not GetAtt http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/intrinsic-function-reference-ref.html
[2014-06-12 23:09:27 -0400] mallu: would you mind giving me an example snippet?
[2014-06-12 23:09:37 -0400] coderanger: (getatt gets the signal data)
[2014-06-12 23:10:43 -0400] mallu: I have to admit, I'm new to AWS and chef.. so trying to learn
[2014-06-12 23:10:59 -0400] coderanger: mallu: As I said, I offer training in this :)
[2014-06-12 23:12:33 -0400] coderanger: mallu: The AWS docs should have some examples under Using Signals
[2014-06-12 23:12:39 -0400] Brad_K: mallu: believe me, coderanger really knows his stuff.  I'd pay him out of my own pocket, if there were specific areas where I needed help and he thought that would be the best way forward.
[2014-06-12 23:13:14 -0400] mallu: I hear you but I don't have those resources
[2014-06-12 23:13:22 -0400] coderanger: mallu: http://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/using-cfn-waitcondition.html
[2014-06-12 23:13:23 -0400] mallu: I wish I had it
[2014-06-12 23:13:53 -0400] coderanger: mallu: See where it is making a value for UserData, you want something like that except instead of a simple key/value pair you need to use that to make the bash script
[2014-06-12 23:14:30 -0400] Brad_K: openssl x509 -in ca-bundle.crt -noout -text | egrep '(Before|After ):'
[2014-06-12 23:14:31 -0400] Brad_K:             Not Before: Aug 17 22:00:00 2005 GMT
[2014-06-12 23:14:31 -0400] Brad_K:             Not After : Aug 17 22:00:00 2015 GMT
[2014-06-12 23:14:51 -0400] coderanger: Brad_K: Try this for kicks
[2014-06-12 23:15:18 -0400] coderanger: Brad_K: Download http://curl.haxx.se/ca/cacert.pem to somewhere on the target machine and in client.rb add this
[2014-06-12 23:15:27 -0400] coderanger: ssl_ca_file "/path/to/cacert.pem"
[2014-06-12 23:15:40 -0400] coderanger: Brad_K: That should give it the latest CA bundle
[2014-06-12 23:17:40 -0400] Brad_K: coderanger: Thanks!
[2014-06-12 23:18:14 -0400] coderanger: Brad_K: If that fixes things, it at least narrows it down :)
[2014-06-12 23:18:59 -0400] Brad_K: Yup.  Thanks again!
[2014-06-12 23:19:30 -0400] xmltok_: im using chef_gem to install some gems but i need to configure an internal gem repository first. i have done that during the compile stage, but that file isnt available for the gem install during the same chef run. is there any way around that? or some way of setting it for all chef_gem's during my converge?
[2014-06-12 23:20:58 -0400] xmltok_: or maybe there is some way to restart the chef compiling stage after my gemrc has been installed?
[2014-06-12 23:21:28 -0400] coderanger: xmltok_: Recommendation would be use the now cookbook and include_recipe_now to do the gemrc at compile time
[2014-06-12 23:21:35 -0400] coderanger: or if its just one file, do it at compile time yourself
[2014-06-12 23:22:08 -0400] xmltok_: yeah i am already doing it at compile time, but i believe chef_gem isn't forking to run the gem install, so when it installs it doesnt re-read the gemrc, if the now cookbook solves that I can give it a shot
[2014-06-12 23:22:43 -0400] coderanger: Ahh, good point
[2014-06-12 23:23:11 -0400] coderanger: xmltok_: I think if you set options '-whatever /path/to/gemrc' it forces it to fork
[2014-06-12 23:23:42 -0400] xmltok_: that will work fine for this particular chef_gem resource, but as soon as some other dev gets into another cb they are going to have the same issue
[2014-06-12 23:23:53 -0400] xmltok_: maybe i can force the paramter into all chef_gem resources somehow
[2014-06-12 23:28:56 -0400] xmltok_: im just going to add the source and let it break for anyone else that runs into this issue, its a bummer but i think its the best option
[2014-06-12 23:29:47 -0400] tanglisha: Is it possible to send a file on my local filesystem (not in chefs directory) over to the remote using chef?
[2014-06-12 23:30:21 -0400] coderanger: tanglisha: No, there is no "local" when running chef
[2014-06-12 23:30:30 -0400] coderanger: Well there is, local means on that node
[2014-06-12 23:30:34 -0400] coderanger: it doesn't know about your workstation
[2014-06-12 23:30:39 -0400] tanglisha: coderanger: No ability outside that node?
[2014-06-12 23:30:54 -0400] tanglisha: coderanger: Im not allowed to check in ssh certs, was looking for a different way to store them
[2014-06-12 23:31:18 -0400] jbz: tanglisha: You can pull files from a remote location *to* the node that is converging
[2014-06-12 23:31:33 -0400] coderanger: tanglisha: Not allowed?
[2014-06-12 23:31:42 -0400] coderanger: and yeah, you can use remote_file
[2014-06-12 23:31:43 -0400] tanglisha: coderanger: Security concerns
[2014-06-12 23:31:58 -0400] jbz: tanglisha: or maybe use chef-vault or something like it to encrypt the certs?
[2014-06-12 23:32:13 -0400] tanglisha: jbz: Excellent suggestion, but not allowed :)
[2014-06-12 23:32:34 -0400] coderanger: tanglisha: You mean the public keys?
[2014-06-12 23:32:45 -0400] tanglisha: coderanger: No, the actual server ca cert that nginx uses
[2014-06-12 23:32:52 -0400] coderanger: tanglisha: Oh, SSL, not SSH :)
[2014-06-12 23:33:02 -0400] jbz: The important part is the key
[2014-06-12 23:33:03 -0400] tanglisha: Derp
[2014-06-12 23:33:04 -0400] coderanger: tanglisha: Yeah, secrets management is Hard
[2014-06-12 23:33:05 -0400] jbz: and
[2014-06-12 23:33:11 -0400] jbz: yeah, what he said.
[2014-06-12 23:33:14 -0400] tanglisha: Haha
[2014-06-12 23:33:15 -0400] coderanger: tanglisha: Are you on EC2?
[2014-06-12 23:33:25 -0400] tanglisha: coderanger: Nope, everything is self run
[2014-06-12 23:33:30 -0400] tanglisha: Well, not me.  The company
[2014-06-12 23:33:36 -0400] coderanger: tanglisha: You are screwed, sorry.
[2014-06-12 23:33:50 -0400] tanglisha: coderanger: Telling me that saves me a ton of research.  I really appreciate your help
[2014-06-12 23:33:52 -0400] jbz: tanglisha: you could use encrypted data bags that are manually maintained, and not check any of them into SCM
[2014-06-12 23:34:00 -0400] coderanger: tanglisha: Barbican might be an option in a year or so
[2014-06-12 23:34:07 -0400] tanglisha: jbz: I think putting a directory in a gitignore is my only option
[2014-06-12 23:34:09 -0400] coderanger: tanglisha: and check out Red October, but its not a good fit for this
[2014-06-12 23:34:17 -0400] tanglisha: Oh, ok.  Thanks!
[2014-06-12 23:34:19 -0400] coderanger: tanglisha: chef-vault is your only remotely secure option right now
[2014-06-12 23:34:36 -0400] jbz: tanglisha: is the problem that they're on the chef server, or that they're in git?
[2014-06-12 23:34:43 -0400] tanglisha: jbz: That theyre in git
[2014-06-12 23:34:48 -0400] tanglisha: Chef isnt an issue at all
[2014-06-12 23:34:51 -0400] jbz: because they can be on the chef server without being in git.  It just makes process a bit more manual
[2014-06-12 23:34:56 -0400] coderanger: tanglisha: Also obligatory plug, I offer training and consulting services for this kind of advanced chef usage :-) (I wrote Citadel which solves this for EC2)
[2014-06-12 23:35:18 -0400] tanglisha: coderanger: Do you have a link I could send my boss?
[2014-06-12 23:35:19 -0400] jbz: Right, so, you could use chef-vault to encrypt them in a data bag and just never check the data bag in to git...
[2014-06-12 23:35:23 -0400] tanglisha: That I just typed out bossy for some reason
[2014-06-12 23:35:42 -0400] tanglisha: jbz: Sounds like the best option for right now :)
[2014-06-12 23:35:46 -0400] coderanger: tanglisha: Nothing in particular, I can shoot you an email though (redoing my website as we speak actually)
[2014-06-12 23:36:59 -0400] tanglisha: Im really having a heck of a time moving between ansible and chef
[2014-06-12 23:37:49 -0400] jbz: Is it the push v. pull thing?
[2014-06-12 23:38:31 -0400] tanglisha: jbz: Nah, its just like moving between Java and C++
[2014-06-12 23:38:39 -0400] tanglisha: Some of the commands are the same, but they dont work the same
[2014-06-12 23:38:42 -0400] jbz: ah indeed
[2014-06-12 23:38:43 -0400] tanglisha: Some are missing in one or the other
[2014-06-12 23:42:00 -0400] jtimberman: har
