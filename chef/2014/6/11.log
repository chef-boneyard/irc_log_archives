[2014-06-11 00:03:22 -0400] cheeseplus: someara: IT'S A TRAP
[2014-06-11 00:06:16 -0400] sethvargo: @cheeseplus @someara http://static4.businessinsider.com/image/4fad386beab8eac843000000/its-a-trap-what-happens-when-advertisers-dont-meet-twitters-spending-quotas.jpg
[2014-06-11 00:07:03 -0400] coderanger: sethvargo: I love that filename
[2014-06-11 00:07:44 -0400] cheeseplus: I mean I'd take the openLDAP one but I don't have to use openldap daily anylonger
[2014-06-11 00:12:45 -0400] jahkobi: haha. thanks @coderanger
[2014-06-11 00:13:04 -0400] jahkobi: Thinking something more along the DIY route
[2014-06-11 00:13:42 -0400] coderanger: jahkobi: Then no, not really much in the way of docs or guides on much of anything for advanced Chef usage.
[2014-06-11 00:15:37 -0400] jahkobi: Well if I figure it out. Ill write up a blog post.
[2014-06-11 00:17:20 -0400] jahkobi: jeweler hold-onto-butt
[2014-06-11 00:23:23 -0400] segv: coderanger, thanks figured out how to move all of it to S3
[2014-06-11 00:42:38 -0400] aslan_: hey guys. is there a way to install chef on ubuntu 14.04?
[2014-06-11 00:54:21 -0400] coderanger: aslan_: Sure, same omnibus packages as always
[2014-06-11 00:54:41 -0400] aslan_: coderanger: is it available on 14.04?
[2014-06-11 00:54:49 -0400] coderanger: aslan_: Yep
[2014-06-11 00:55:06 -0400] aslan_: awesome. So this is the first time i am using omnibus.
[2014-06-11 00:55:47 -0400] aslan_: can you tell me what are the basic steps if I want to configure my chef-client to be handled by runsv?
[2014-06-11 00:56:58 -0400] aslan_: coderanger: do i need to install chef as a gem too or just apt-get install chef?
[2014-06-11 00:57:34 -0400] coderanger: aslan_: Neither, the official solution is to use the install.sh script which downloads the correct deb and installs it
[2014-06-11 00:57:50 -0400] coderanger: aslan_: You can also manually get the URL to the deb from the website and install it yourself
[2014-06-11 00:58:08 -0400] aslan_: coderanger: oh i thought omnibus means using apt. :/
[2014-06-11 00:58:17 -0400] coderanger: aslan_: You can use the chef-client cookbook to configure various service backends
[2014-06-11 00:58:27 -0400] coderanger: aslan_: No, they are distributed as deb packages, but not using apt
[2014-06-11 00:58:55 -0400] aslan_: coderanger: lol... just got a fail alert from apt-get install chef
[2014-06-11 00:58:59 -0400] aslan_: alright
[2014-06-11 00:59:45 -0400] aslan_: coderanger: so when i use the cookbook should i just run chef solo and add the chef-client recipes for runsv?
[2014-06-11 01:00:33 -0400] coderanger: aslan_: No, you normally bootstrap via knife bootstrap, which will run it once as part of the setup process
[2014-06-11 01:01:02 -0400] aslan_: coderanger: wow... things have changed a lot since last time i installed chef
[2014-06-11 01:01:21 -0400] coderanger: aslan_: What kind of server are you installing chef on?
[2014-06-11 01:01:28 -0400] aslan_: chef-solo used to be the way to bootstrap
[2014-06-11 01:01:38 -0400] aslan_: ec2 ubuntu 14.04
[2014-06-11 01:01:50 -0400] aslan_: this is just the client side.
[2014-06-11 01:01:56 -0400] coderanger: aslan_: You can actually just use knife-ec2, that will handle both creating the VM and bootstrapping it
[2014-06-11 01:02:04 -0400] segv: ugh, having this set to s3 is failing hard
[2014-06-11 01:02:07 -0400] aslan_: and then i have to upgrade my chef 10 server
[2014-06-11 01:02:10 -0400] segv: keep getting a 502 error :(
[2014-06-11 01:02:43 -0400] coderanger: aslan_: Technically they are cross-compatible because 10->11 was just an API reimplementation on the server, but in general you should upgrade the server first
[2014-06-11 01:03:06 -0400] coderanger: aslan_: The server promises backwards compat, but chef-client doesn't ensure forwards compat, just happens to have been the case this time
[2014-06-11 01:03:19 -0400] aslan_: coderanger: didn't that version change involve going from couchdb to postgress?
[2014-06-11 01:03:32 -0400] coderanger: Among other things, yes
[2014-06-11 01:04:02 -0400] segv: coderanger https://gist.github.com/anonymous/0d1274e87d5191fc3a46
[2014-06-11 01:04:05 -0400] aslan_: coderanger: well right now i have chef 11 running on all of my clients but those are ubuntu 12.04
[2014-06-11 01:04:12 -0400] segv: why is it trying to upload it to chef while bookshelf is set to disabled and the URL is set to the s3 bucket?
[2014-06-11 01:04:31 -0400] coderanger: aslan_: But your server is still chef-server 10.x?
[2014-06-11 01:04:39 -0400] aslan_: coderanger: yes.
[2014-06-11 01:04:50 -0400] aslan_: coderanger: everything is running fine
[2014-06-11 01:04:54 -0400] segv: https://gist.github.com/anonymous/d56eea8e85184da45797
[2014-06-11 01:05:08 -0400] aslan_: of course i dont get the feature in chef11 server but i didn't really need those
[2014-06-11 01:05:12 -0400] coderanger: aslan_: Yes, but like I said, this is not promised to be the case, it was just the way it worked out
[2014-06-11 01:07:23 -0400] coderanger: segv: I've never tried using real S3 with erchef, sorry
[2014-06-11 01:07:32 -0400] segv: arg, thanks!
[2014-06-11 01:08:18 -0400] coderanger: segv: Obligatory: I am available for consulting on advanced chef issues ;-)
[2014-06-11 01:08:25 -0400] segv: haha
[2014-06-11 01:08:31 -0400] segv: i'm pretty deep down the rabbit hole myself
[2014-06-11 01:08:36 -0400] aslan_: coderanger: so i installed chef using: curl -L https://www.opscode.com/chef/install.sh | sudo bash
[2014-06-11 01:08:56 -0400] segv: having to modify the erchef.config.erb :p so I can use an external postgresql instance in RDS already
[2014-06-11 01:09:07 -0400] segv: just for some reason this stupid S3 feature will not work
[2014-06-11 01:09:10 -0400] aslan_: what is the next step to get runsv manage chef?
[2014-06-11 01:10:23 -0400] segv: i'll figure it out later.
[2014-06-11 01:10:29 -0400] Soliah: Does the apt cookbook affect how the package resource behaves?
[2014-06-11 01:10:55 -0400] segv: coderanger, my setup is abnormal to say the least, haproxy in front of two different region chef-servers with rds backend for postgres as well as solr. was trying to get cookbooks into the cloud as well to fix bookshelf issues.
[2014-06-11 01:11:16 -0400] segv: back down to a single instance till i figure this out.
[2014-06-11 01:11:22 -0400] Soliah: So weird. Just trying to install a package, and it I get the no candidate version available exception. But when I include the apt cookbook it works :<
[2014-06-11 01:12:38 -0400] coderanger: Soliah: The issue is that your apt cache is expiring
[2014-06-11 01:12:52 -0400] coderanger: Soliah: the apt cookbook runs an apt-get update for you, which refreshes things
[2014-06-11 01:13:10 -0400] coderanger: segv: Sounds reasonable to me :)
[2014-06-11 01:13:45 -0400] segv: coderanger, haha, yeah i'll figure it out, after a few beers.
[2014-06-11 01:14:52 -0400] coderanger: segv: Oddly enough someone is asking the same question on the ML right now :P
[2014-06-11 01:15:15 -0400] segv: weird, i am subscribed but didn't notice
[2014-06-11 01:18:57 -0400] aslan_: coderanger: what options do i need to pass to 'knife bootstrap' to get it to install runsv?
[2014-06-11 01:19:16 -0400] coderanger: aslan_: None, you need to use a cookbook
[2014-06-11 01:19:28 -0400] coderanger: aslan_: the -r option provides the initial run list for the chef-client
[2014-06-11 01:19:53 -0400] aslan_: coderanger: do i need to download the cookbook or it will grab it from the website?
[2014-06-11 01:20:15 -0400] coderanger: aslan_: It will get it from the chef-server just like always
[2014-06-11 01:21:17 -0400] aslan_: coderanger: sorry to ask these silly questions. but what if I dont have a chef server and just want to bootstrap my client?
[2014-06-11 01:21:23 -0400] Soliah: coderanger oh thanks.
[2014-06-11 01:22:08 -0400] coderanger: aslan_: knife-solo supports bootstrapping solo, but on its own knife does not
[2014-06-11 01:22:23 -0400] coderanger: Soliah: Or at least thats the most likely explanation :)
[2014-06-11 01:23:11 -0400] Soliah: coderanger I'll go with it because it works :)
[2014-06-11 01:28:42 -0400] mjuszczak: coderanger: What do you think, instead of using openldap with sssd, of just making authorized_keys_command in sshd_config wrap around a ruby script that polls github on the fly and, if unavailable, returns locally cached info?
[2014-06-11 01:29:09 -0400] coderanger: mjuszczak: Given githubs API uptime, still doesn't fill me with confienced
[2014-06-11 01:29:30 -0400] mjuszczak: local cache
[2014-06-11 01:30:19 -0400] coderanger: mjuszczak: If you have a thousand servers, it is still only cached locally, at any given time there is a very good chance that a given login will be your first for that machine
[2014-06-11 01:34:25 -0400] mjuszczak: true.  We have 500+ servers.  Hence why we were going the sssd + openldap route -- because sssd will cache the stuff from openldap locally.
[2014-06-11 01:34:44 -0400] mjuszczak: Thought about running a simple web service that we control that will cache github.
[2014-06-11 01:36:00 -0400] coderanger: mjuszczak: Yep, and down this route leads madness :)
[2014-06-11 01:36:22 -0400] coderanger: mjuszczak: Not saying it is a bad idea, just madness
[2014-06-11 01:38:29 -0400] mjuszczak: coderanger: the custom daemon route, versus sssd + openldap?
[2014-06-11 01:38:57 -0400] mjuszczak: we know we need central keys.  We don't want to have to run a chef deploy across upwards of 1000 instances just to lock someone out and/or add a new key.
[2014-06-11 01:38:58 -0400] coderanger: mjuszczak: At least with sssd and ldap you have a well known toolkit, but it just kind of sucks, pick your poison
[2014-06-11 01:39:07 -0400] coderanger: mjuszczak: Make something awesome so I can go use it ;-)
[2014-06-11 01:39:13 -0400] coderanger: mjuszczak: (or hire me to make :)
[2014-06-11 01:44:29 -0400] mjuszczak: haha :)
[2014-06-11 02:34:11 -0400] digitalchild: anyone using the yum-vmware-tools cookbook from atomic penguin?
[2014-06-11 06:00:39 -0400] drag00n: https://www.irccloud.com/pastebin/7TZHC5Vi
[2014-06-11 06:08:30 -0400] samkottler: drag00n: there's no name attribute in metadata.rb
[2014-06-11 06:58:40 -0400] bcave: good morning
[2014-06-11 07:01:04 -0400] coderanger: bcave: Alo
[2014-06-11 08:51:02 -0400] chandrasekhar: can any one tel me how can i get free cookbookd ans its recipe for any free web application ?
[2014-06-11 08:51:11 -0400] chandrasekhar: typo
[2014-06-11 08:54:23 -0400] djlee: Hi, does anyone know if theres a chef cookbook or something similar that shims the opsworks attributes. I want my cookbook to generate a php-fpm configuration dynamic for the server instance (i.e. get the number of cores for the instance by getting the instance size and running it through a switch), but there's no way of testing such things in vagrant.
[2014-06-11 08:55:50 -0400] jonlives: djlee: dunno if https://github.com/customink/fauxhai might be of use to you?
[2014-06-11 08:58:34 -0400] chandrasekhar: Can anyone tell me where can i get free cookbooks and its recipe for installing any free web application ? any help will be appreciated
[2014-06-11 09:00:19 -0400] djlee: thanks jonlives i'll have a look. My fallback plan is to mock the attributes in the default attributes. But i need to learn more chef so i know that my mocked attribs wont overwrite the opsworks ones (i think both write to the default node, but ive been learning chef for less than 48 hours, so im still getting my head around it)
[2014-06-11 09:00:54 -0400] jonlives: chandrasekhar: have you tried http://community.opscode.com/cookbooks
[2014-06-11 09:01:34 -0400] jonlives: djlee: what exactly are you trying to do that needs mock attributes?
[2014-06-11 09:04:22 -0400] chandrasekhar: yes.  i went through it and not sure which one i should pick . Actually apache is already installed on chef and i want to deploy a web application on that . once i deployed, i should be able to see the url for it so that i can navigate one page to another
[2014-06-11 09:04:51 -0400] jonlives: chandrasekhar: what sort of web application are you trying to deploy?
[2014-06-11 09:05:00 -0400] djlee: jonlives: my php-fpm config needs to know what instance size its running on, in order to set the worker_processes config directive. My idea was that opsworks gives me "node[:opsworks][:instance][:instancetype]" which is like "t1.micro". I can then switch() that to return the number of workers to set in the configuration. However in vagrant node[:opworks] wont exist, so i sort of want to shim those attributes in vagrant, b
[2014-06-11 09:05:00 -0400] djlee: ut when in opsworks, i want the opsworks attributes for node[:opworks] to take effect
[2014-06-11 09:05:57 -0400] jonlives: djlee: ah I get ya - so attributes have multiple (15!!!) levels of precedence documented here: http://docs.opscode.com/chef_overview_attributes.html#attribute-files. Automatic attributes, ie those populated by ohai, are always the highest precedence level.
[2014-06-11 09:06:20 -0400] jonlives: I'm assuming opsworks stuff is populated by an ohai plugin.
[2014-06-11 09:07:18 -0400] chandrasekhar: @Jonlives: any free open source web application would be fine .
[2014-06-11 09:07:45 -0400] djlee: jonlives: aha, definately bookmarking that page!. So if i mock my attribs in the cookbook attributes, they are the lowest level of priority, so opsworks will definately overwrite them anyway.
[2014-06-11 09:07:52 -0400] jonlives: chandrasekhar: do you mean a cookbook which deploys a specific application rather than a specific stack?
[2014-06-11 09:07:52 -0400] djlee: jonlives: thanks for the help, much appreciated :D
[2014-06-11 09:08:00 -0400] jonlives: djlee: yeah that should work. np!
[2014-06-11 09:08:35 -0400] jonlives: djlee: you might also want to look at http://shop.oreilly.com/product/0636920032397.do when it comes out.
[2014-06-11 09:08:36 -0400] chandrasekhar: @Jonlives: yes. exactly
[2014-06-11 09:08:48 -0400] jonlives: and I'm also gonna plug http://shop.oreilly.com/product/0636920032984.do cos I'm writing it :p
[2014-06-11 09:08:52 -0400] jonlives: chandrasekhar: aaaah I get ya.
[2014-06-11 09:09:17 -0400] jonlives: chandrasekhar: you could have a go at https://github.com/brint/wordpress-cookbook
[2014-06-11 09:09:23 -0400] chandrasekhar: :-)
[2014-06-11 09:10:17 -0400] djlee: jonlives: ha, i'll nudge the boss for the company credit card. He loves techie books on the shelf, reckons it impresses the clients lol. I could do with learning ruby too, so i'll get him to buy me a book and a tutorial site subscription at the same time :P
[2014-06-11 09:10:38 -0400] jonlives: djlee: both of those books teach enough ruby for chef purposes if it helps ;)
[2014-06-11 09:11:23 -0400] djlee: jonlives: you need to type quicker, nov 2014 release :O
[2014-06-11 09:11:28 -0400] djlee: i canne wait that long
[2014-06-11 09:11:47 -0400] jonlives: djlee: you can get the early release now though, which gives you unedited work in progress for most of it
[2014-06-11 09:12:08 -0400] jonlives: the end of this month there'll be another update which'll be all but the last chapter
[2014-06-11 09:12:24 -0400] jonlives: writing actually finishes in june or july, the rest of the time is editing, copy layout, printing etc etc etc
[2014-06-11 09:12:27 -0400] bcave: anyone here familiar enough with the chef code to know which module in chef-client is responsible for resolving cookbooks when the client is run with a role run list?
[2014-06-11 09:12:46 -0400] jonlives: bcave: you mean expanding roles into what they contain?
[2014-06-11 09:13:25 -0400] djlee: jonlives: ah just noticed it says you get all the updates for free :P. I'll be nice to the boss (for a change) when he drags his backside into the office :)
[2014-06-11 09:13:38 -0400] jonlives: djlee: awesome :p
[2014-06-11 09:14:06 -0400] bcave: yeah. chef-client -o 'role[webserver]'  gives resolving cookbooks for run_list: ["apache2","whatever"]
[2014-06-11 09:14:13 -0400] bcave: oh wait..
[2014-06-11 09:14:17 -0400] bcave: probably run_list.rb
[2014-06-11 09:18:25 -0400] jonlives: bcave: https://github.com/opscode/chef/blob/11-stable/lib/chef/policy_builder/expand_node_object.rb#L133
[2014-06-11 09:19:19 -0400] chandrasekhar: Jonlives: Thanks : let me check
[2014-06-11 09:25:10 -0400] bcave: ah, great. thanks jonlives
[2014-06-11 09:26:02 -0400] bcave: and chef-client -z still considers the expansion "server", not disk.
[2014-06-11 09:40:06 -0400] jonlives: bcave: chef-client -z just expands the runlist you pass on the command line
[2014-06-11 09:53:12 -0400] srenatus: how does package[foo], action upgrade, provider apt, just does install the latest version of foo, leaving dependencies untouched.  whereas 'apt-get upgrade foo' would upgrade all depedencies as well...
[2014-06-11 09:53:15 -0400] djlee: Is there a way of editing a config file after installing a package, but only editing specific lines, rather than storing a template of the entire config file ?
[2014-06-11 09:53:42 -0400] srenatus: djlee: https://github.com/someara/line-cookbook could be helpful, I suppose
[2014-06-11 09:53:58 -0400] djlee: thanks srenatus i'll have a look!
[2014-06-11 09:54:53 -0400] srenatus: :)
[2014-06-11 09:55:10 -0400] srenatus: there's also FileEdit...
[2014-06-11 09:55:20 -0400] srenatus: but line-cookbook gives you a resource ;)
[2014-06-11 10:00:02 -0400] djlee: srenatus: looking at the chef source code, the upgrade action runs the install action. So your actually running "apt-get install <package>", if the package exists already, maybe apt-get install doesn't upgrade dependencies on installed packages when you install rather than upgrade? Not really sure as i've never used apt-get install on an existing package (having said that, i dont use apt-get at all, i prefer aptitude)
[2014-06-11 10:00:47 -0400] srenatus: djlee: yes, right, install will leave the dependencies untouched, even when they could be upgraded.
[2014-06-11 10:01:09 -0400] srenatus: djlee: but thinking about it, if our packages wanted the latest versions of their dependencies, they probably should say so... :/
[2014-06-11 10:01:40 -0400] srenatus: (because if they did, apt-get install foo would be forced to upgrade the dependencies, too...)
[2014-06-11 10:03:08 -0400] srenatus: just checked aptitude, it does not upgrade dependencies on either install or upgrade...
[2014-06-11 10:04:19 -0400] djlee: srenatus: i've used chef for 48 hours at most, so you know more than me on the topic to be honest. I can't really comment on why a specific route was chosen. Having said that, it would be useful to be able to specify the -f flag to apt-get via some sort of resource config/setting/attribute (like how you can set symbolic or hard link in the link resource)
[2014-06-11 10:08:48 -0400] srenatus: djlee: you can do that... that's what options is for, see for example https://github.com/stackforge/cookbook-openstack-network/blob/master/recipes/common.rb#L54 and https://github.com/stackforge/cookbook-openstack-network/blob/master/attributes/default.rb#L1041
[2014-06-11 10:12:36 -0400] djlee: srenatus: So maybe you should try that, put the -f flag in via the override and see if deps get upgraded
[2014-06-11 10:13:06 -0400] srenatus: oh nevermind my previous command. 'apt-get upgrade foo' simply ignores 'foo' and does 'apt-get upgrade'
[2014-06-11 10:13:45 -0400] srenatus: djlee: nope, doesn't happen
[2014-06-11 10:14:11 -0400] srenatus: but thanks for the pointer, there might be some other otions.  now that I'm certail apt-get install is the right way after all
[2014-06-11 10:27:59 -0400] trilitheus: srenatus, hi - thankls for the tip yesterday for https://github.com/bflad/chef-rhn
[2014-06-11 10:30:26 -0400] whiteadam: it's ok, i'm awake
[2014-06-11 10:35:12 -0400] bcave: is anyone running chef solo / chef zero on AWS instances via user data?
[2014-06-11 10:35:35 -0400] bcave: by anyone, i mean anyone here and awake :)
[2014-06-11 10:37:01 -0400] whiteadam: when you say user data...
[2014-06-11 10:37:22 -0400] whiteadam: you mean like "this server is owned by batman" ?
[2014-06-11 10:40:49 -0400] bcave: are you referring to an MOTD or /etc/issue sort of thing? I'm referring to passing userdata to an instance for initialization: http://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html#d0e29941
[2014-06-11 10:41:23 -0400] whiteadam: bcave: Oh I see what you're saying.
[2014-06-11 10:41:37 -0400] whiteadam: I haven't done that yet
[2014-06-11 10:42:30 -0400] bcave: So i fire up an instance that has / gets a chef repo on it, and with the user data, I execute chef-client -z with a run list...
[2014-06-11 10:45:17 -0400] bcave: chef is executed by a runner, so i basically have this in my userdata: `/opt/chef-zero/runner.sh`
[2014-06-11 10:45:23 -0400] bcave: https://gist.github.com/brettcave/d5e2cff23add5a76464c
[2014-06-11 10:45:58 -0400] bcave: if I log onto the host and execute "runner.sh" manually, it works fine
[2014-06-11 10:46:17 -0400] bcave: but when it's done by cloud-init, it fails with "undefined method '[]' for nil:NilClass"
[2014-06-11 10:47:06 -0400] bcave: any idea's why the chef-client run fails? I was thinking that it might be something to do with the way the environment is provided when running it this way
[2014-06-11 10:47:20 -0400] bcave: maybe there isn't a console that chef-client is expecting
[2014-06-11 11:08:01 -0400] bcave: ah, found it....
[2014-06-11 11:09:51 -0400] bcave: the AMI i was using was  bootstrapped with an older version of chef with knife. The newer version of chef that was installed by the omnibus installer in userdata didn't put the new version of chef on the path, so "chef-client" was the old version
[2014-06-11 11:09:58 -0400] bcave: that doesn't support -z
[2014-06-11 11:14:27 -0400] djlee: Hi all, can someone point me in the right direction to work out how i override the default nginx cookbook config. I am using berkshelf to install nginx from the community repo, but i want to change the default site config
[2014-06-11 11:30:00 -0400] whiteadam: djlee: You mean like, override the default attributes and such?
[2014-06-11 11:31:25 -0400] ambientsound: djlee: you can set them in another cookbook, or in a role file
[2014-06-11 11:32:09 -0400] ambientsound: i.e. node.set['nginx']['default_site_enabled'] = false
[2014-06-11 11:32:27 -0400] ambientsound: and, sorry, s/cookbook/recipe/
[2014-06-11 11:36:47 -0400] djlee: whiteadam: yeah attributes and templates. Think i found a tutorial on wrapper cookbooks which i guess is what i want. Looks like i create a custom cookbook, make a template file in the same place as the original cookbook, then just include recipe in my recipe defailt
[2014-06-11 11:38:12 -0400] whiteadam: djlee: Yeah, that's what I thought you might mean. I use wrappers like crazy. Is this the article you found? http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-06-11 11:38:26 -0400] djlee: whiteadam: yep :)
[2014-06-11 11:38:31 -0400] r3dk1ng: Good Morning all
[2014-06-11 11:38:37 -0400] whiteadam: hey r3dk1ng
[2014-06-11 11:40:04 -0400] r3dk1ng: does anyone know how to do a dictionary search in Chef?  for example I have dict1 = { item1, item2, item3, item4} and let's say I want to search the dictionary and return based on item2 matches....
[2014-06-11 11:41:02 -0400] bcave: how does knife install chef on a node?
[2014-06-11 11:41:15 -0400] digitalchild: knife bootstrap yadda
[2014-06-11 11:41:25 -0400] bcave: and if I re-run knife bootstrap...
[2014-06-11 11:41:29 -0400] bcave: will it upgrade the client?
[2014-06-11 11:42:02 -0400] bcave: i see that the knife bootstrap installs it to /opt/chef (on an ubuntu system)
[2014-06-11 11:42:06 -0400] digitalchild: bcave: i think so
[2014-06-11 11:42:15 -0400] digitalchild: it installs it there on centos too
[2014-06-11 11:42:23 -0400] bcave: so i went and ran the omnibus installer over it, but all the chef commands on the path still use the old version
[2014-06-11 11:42:28 -0400] digitalchild: im pretty new to this so id take my answers with a grain of salt heh
[2014-06-11 11:42:38 -0400] bcave: ehe, ok thanks digitalchild
[2014-06-11 11:43:34 -0400] digitalchild: i did find this though
[2014-06-11 11:43:34 -0400] digitalchild: http://www.getchef.com/blog/2013/12/20/managing-chef-with-chef/
[2014-06-11 11:44:00 -0400] digitalchild: which looks to do what you want
[2014-06-11 11:44:43 -0400] bcave: yeah... i think that the way the omnibus installs is different to the knife bootstrap though, because if i manually run the omnibus, it gets installed to a different location.
[2014-06-11 11:47:48 -0400] r3dk1ng: does anyone know how to do a hash/dictionary search in Chef?  for example I have hash1 = { item1: fork, item2: spoon, item3: knife, item4: hammer} and let's say I want to search the dictionary and return based on item2 matches.... anyone know how to do this in the recipe?
[2014-06-11 11:55:42 -0400] digitalchild: bcave: what version of chef are you running on your workstation?
[2014-06-11 11:55:59 -0400] digitalchild: i do believe that bootstrap uses what version you have on your workstation
[2014-06-11 12:00:15 -0400] bixu: Anyone else seeing issues syncing cookbooks during their initial converge?
[2014-06-11 12:10:54 -0400] bcave: oh my goodness...
[2014-06-11 12:11:29 -0400] bcave: so the omnibus installer upgrades everything, the only difference is that the provisioned node had old versions of chef in /usr/bin
[2014-06-11 12:12:05 -0400] bcave: i had the "chef-client::service" recipe enabled on the node, not sure if that installed the binaries to that path
[2014-06-11 12:12:38 -0400] bcave: or whether it was when I created the machine with knife
[2014-06-11 12:13:59 -0400] bcave: i'm up to 11.12.2 on my workstation at the moment, but am using an old image i created months ago that still had 11.6.0. Time to update my image, but there's some issues with cookbooks that I haven't had time to get to yet
[2014-06-11 12:14:41 -0400] bcave: /usr/bin/chef-client -v: 11.6.0. /opt/chef/bin/chef-client -v: 11.12.8
[2014-06-11 12:25:08 -0400] hui8l: how can i show unused attributes?
[2014-06-11 12:32:44 -0400] djlee: is there a way in chef or berkshelf to override a dependancy. Composer has a dependency on "php", but i have a lcoal cookbook for "php55" (as the community one is too old). So when composer runs, it runs php::default but i dont want it to run anything, or i want it to run php55::default instead. If not, i'll just fork the package and edit the dependencies
[2014-06-11 12:35:30 -0400] bixu: djlee: I don't think you can override deps.  Maybe(?) you can make them conditional in metadata.rb - or your can submit a pull request to the maintainer that changes 'depends' to 'suggests'.
[2014-06-11 12:37:37 -0400] djlee: cool bixu, cheers. i'll fork it for now as i have 2 days to get this thing online and auto-scaling, but i might PR it later on. Just thought id check there wasn't a "provides" or "as" keyword somewhere i could use to make my cookbook pretend to be the original
[2014-06-11 12:38:26 -0400] bixu: Well, I think the matching is only based on cookbook name, so you could upload a dummy cookbook to your chef server ;)
[2014-06-11 12:39:09 -0400] bixu: IIRC, there are changes (improvements?) coming in Chef 12 wrt dependency handling.  But of course we are all using Chef 11 :)
[2014-06-11 12:40:10 -0400] djlee: bixu: that would work i suppose! In hindsight i should have called my cookbook php rather than php55, but you live and learn i guess. cant expect to know everything after 2 days of using it (unfortunately!)
[2014-06-11 12:43:38 -0400] bcave: damn no, it wasn't that
[2014-06-11 12:44:25 -0400] bixu: bcave: What's the issue you are seeing?
[2014-06-11 12:59:34 -0400] bcave: http://stackoverflow.com/questions/24163585/chef-zero-via-aws-userdata-fails
[2014-06-11 13:00:36 -0400] bcave: chef-client -z fails when executed by cloud-init (passed using AWS userdata)
[2014-06-11 13:13:00 -0400] jpoole: hello cooks.  Question for you. I have a recipe that I need to sanitize an environment variable. something like if some_var.include? "something" however I get unknown method errors.  Do i need to include something in order to do this in my recipe?
[2014-06-11 13:14:19 -0400] jpoole: this is inside a ruby_block snippet btw.
[2014-06-11 13:24:28 -0400] mattsmith: kitchenci and encrypted data_bags (chef-solo) anyone managed to get this working? I keep coming up against "Chef::EncryptedDataBagItem::DecryptionFailure" but it works fine with the knife command. I've read some posts about a newline character causing problems with the secret. Is this still the case?
[2014-06-11 13:50:04 -0400] whiteadam: identity management is the pits. I hate security crap
[2014-06-11 13:50:16 -0400] whiteadam: that is all
[2014-06-11 13:57:32 -0400] rayrod2030: annoying when berkshelf just hangs uploading a cookbook.
[2014-06-11 14:09:34 -0400] bixu: rayrod2030: Can you truss or strace the berkshelf command?  I wonder if you are running into the same sort of SSL timeouts I am.
[2014-06-11 14:10:35 -0400] trilitheus: Hi - could anyone give me a hint on why this recipe isn't setting the pkg_src variable?  runing test-kitchen with a centos-5.10 instance
[2014-06-11 14:10:42 -0400] trilitheus: https://gist.github.com/trilitheus/900c7f4b933500ded24d
[2014-06-11 14:13:10 -0400] trilitheus: never mind - converting to an integer and testing a string
[2014-06-11 14:13:29 -0400] bixu: trilitheus: Yeah, I was just about to ask about that.
[2014-06-11 14:14:07 -0400] trilitheus: wouldn;t believe how long I;ve stared at it lol
[2014-06-11 14:14:18 -0400] bixu: I think we have all been there :)
[2014-06-11 14:14:27 -0400] trilitheus: yes :)
[2014-06-11 14:19:57 -0400] bcave: strange... i switched from chef-client -z to chef-solo and it works
[2014-06-11 14:20:12 -0400] oponder: https://wiki.opscode.com/display/chef/How+to+Contribute is this still up to date? I happened to stumble on 'closed in favor of github' on a issue i was watching a few months ago.
[2014-06-11 14:21:08 -0400] oponder: ah nevermind, it's probably a cookbook that has a new maintainer
[2014-06-11 14:21:15 -0400] oponder: and no longer official chef
[2014-06-11 14:33:40 -0400] bcave: cheers all
[2014-06-11 14:51:48 -0400] zeroXten: am i correct in thinking that chef will retry to find a resource (in a notifies) during the compile phase even if the reference to the resource is hidden inside an if statement?
[2014-06-11 14:54:13 -0400] someara: can you gist an example?
[2014-06-11 14:54:46 -0400] zeroXten: someara: ok
[2014-06-11 14:55:52 -0400] bruceadams: I'm pretty new to Chef. I want to run some integration tests, ideally via kitchen, but not on the target machine. I want the test to run on the machine where I invoked "kitchen" and have it make network requests of services running on the target.
[2014-06-11 14:56:09 -0400] zeroXten: someara: https://gist.github.com/zeroXten/9491f4be15f3e7a703f5
[2014-06-11 14:56:37 -0400] zeroXten: the sensu_service[sensu-client] resource may or may not be available
[2014-06-11 14:56:53 -0400] bruceadams: The testing stuff I've found all runs tests on the target. Is there a usual way to run tests on the kitchen-running machine?
[2014-06-11 14:57:41 -0400] gleam: zeroxten: the sensu cookbook actually provides a way around this, assuming you are including teh sensu::default recipe. if not, nevermind
[2014-06-11 14:58:29 -0400] gleam: notify ruby_block[sensu_service_trigger] instead
[2014-06-11 14:58:39 -0400] gleam: all of the services created by teh sensu lwrps subscribe to that block (which is a noop)
[2014-06-11 14:58:44 -0400] zeroXten: ahh ok
[2014-06-11 15:01:41 -0400] mattupstate: anyone ever have ohai not be able to detect a nodes ip address in the context of a chef-client run but be successful standalone?
[2014-06-11 15:02:43 -0400] zeroXten: gleam: hang on, that just moves the problem because 'ruby_block[sensu_service_trigger]' doesn't exist either
[2014-06-11 15:02:55 -0400] gleam: ah, you're not necessarily including sensu::default?
[2014-06-11 15:02:59 -0400] mattupstate: this is very peculiar: http://paste.pound-python.org/show/wjEgTu35F983VDK6vTfG/
[2014-06-11 15:03:00 -0400] zeroXten: no
[2014-06-11 15:03:02 -0400] gleam: gotcha
[2014-06-11 15:03:38 -0400] zeroXten: the only think I can think of doing is definig a dummy resource, and creating a wrapper method that returns the real resource or the dummy inside a begin rescue
[2014-06-11 15:04:01 -0400] gleam: you may be able to define it in your recipe the same way sensu::default does, i'm not sure exactly how it works with two resources named the same
[2014-06-11 15:06:23 -0400] zeroXten: gleam: that could possibly use a conditional to prevent a conflict
[2014-06-11 15:06:44 -0400] gleam: sure, check if sensu::default is in node.recipes
[2014-06-11 15:08:58 -0400] gleam: actually even better would be to look at run_context.resource_collection
[2014-06-11 15:13:11 -0400] zeroXten: gleam: hmm,
[2014-06-11 15:14:54 -0400] gleam: you may also be able to put this stuff in a separate recipe and then do include_recipe 'mycookbook:_sensu' if node.recipes.include?('sensu::client_service')
[2014-06-11 15:14:57 -0400] gleam: not sure if that works.
[2014-06-11 15:22:54 -0400] zeroXten: defining that block seems to do the job
[2014-06-11 15:41:58 -0400] mattupstate: anybody wanna take a stab at this issue? http://paste.pound-python.org/show/wjEgTu35F983VDK6vTfG/
[2014-06-11 15:47:31 -0400] pl1ght: jkeiser: looking for a little guidance if you will.  Getting a Fog::AWS::IAM::Error: RequestExpired => Request has expired with any chef -z on any basic recipe requiring chef_metal_fog.  I have pulled the latest chef-metal and chef-metal-fog, and have my .aws/config set. Any ideas on that?
[2014-06-11 15:49:34 -0400] jkeiser: pl1ght: not off hand.  What is your driver set to, and do you have your credentials in ~/.aws/config?
[2014-06-11 15:51:02 -0400] pl1ght: yes, i do have my credentials in ~/.aws/config driver is using chef_metal_fog, i can launch knife-ec2 no probs with the config
[2014-06-11 15:53:51 -0400] pl1ght: fog:AWS even
[2014-06-11 15:59:29 -0400] tier: while we're at it, i'm having some trouble getting chef-metal installed.   failing on the openssl_pkcs8-0.1.2 gem, error here: http://pastebin.com/q31EhLwc
[2014-06-11 16:00:37 -0400] tier: looks like it's failing to find clang... xcodebuild -find clang points to Applications/Xcode.app/Contents/Developer/Toolchains/XcodeDefault.xctoolchain/usr/bin/clang which isn't where its looking
[2014-06-11 16:02:29 -0400] jeff_r: so knife uses $EDITOR, is there a way you can have it refer to a different environment variable? like how git uses $GIT_EDITOR
[2014-06-11 16:04:17 -0400] workmad3: jeff_r: don't think so... any particular reason to do so?
[2014-06-11 16:04:38 -0400] workmad3: jeff_r: that isn't subsumed by using dotenv or just EDITOR=whatever knife foobar ?
[2014-06-11 16:05:34 -0400] jeff_r: workmad3: for git I'm doing this:
[2014-06-11 16:05:41 -0400] jeff_r: export EDITOR='subl'
[2014-06-11 16:05:41 -0400] jeff_r: export GIT_EDITOR='subl -w'
[2014-06-11 16:05:49 -0400] jkeiser: pl1ght: not sure ... got a stack trace handy for that exception?
[2014-06-11 16:05:58 -0400] jkeiser: tier: maybe need xcode?
[2014-06-11 16:06:07 -0400] jeff_r: was hoping I hoping I could do something similar for knife
[2014-06-11 16:06:09 -0400] jkeiser: tier: I swear we've had more problems with that gem
[2014-06-11 16:06:39 -0400] r3dk1ng: knife node edit <node> -e nano
[2014-06-11 16:06:42 -0400] r3dk1ng: knife node edit <node> -e vim
[2014-06-11 16:06:48 -0400] r3dk1ng: knife node edit <node> -e your-editor-of-choice
[2014-06-11 16:09:52 -0400] slingcode: In ~/.chef/knife.rb add knife[:editor] = '$PATH_TO_SUBL'
[2014-06-11 16:10:18 -0400] jeff_r: slingcode: looks like what I needed, thanks
[2014-06-11 16:10:21 -0400] pl1ght: http://pastebin.com/cfZjDeHe
[2014-06-11 16:11:28 -0400] pl1ght: with the IAM error just seems its ignoring my creds for some reason
[2014-06-11 16:12:11 -0400] jerrod: anyone around maybe give me some help?
[2014-06-11 16:14:21 -0400] tier: jkeiser: i do have xcode it's just that gem doesn't seem to want to find it when trying to build
[2014-06-11 16:15:47 -0400] jkeiser: pl1ght: I don't think knife ec2 uses ~/.aws/config, maybe the config file isn't quite right?  Maybe try using the aws command line and see if it works?
[2014-06-11 16:17:13 -0400] pl1ght: jkeiser: they work fine, i can describe-instances right away
[2014-06-11 16:18:10 -0400] pl1ght: ill keep poking around, i may have just fubared my chef env on this guy too much messing around.  appreciate the assistance
[2014-06-11 16:18:54 -0400] jkeiser: pl1ght: the error you are getting sounds like an authentication error: I suspect what Amazon is saying is "the timestamp you provided me is so far in the past that I think the request is inauthentic."
[2014-06-11 16:19:07 -0400] jkeiser: pl1ght: I know Chef does that with authentication, to help mitigate man in the middle attacks
[2014-06-11 16:19:15 -0400] pl1ght: dammit
[2014-06-11 16:19:15 -0400] jkeiser: replay attacks
[2014-06-11 16:19:22 -0400] pl1ght: jkeiser: my time is off on that box
[2014-06-11 16:19:26 -0400] pl1ght: jkeiser: thanks lol.
[2014-06-11 16:19:33 -0400] pl1ght: gtg
[2014-06-11 16:19:49 -0400] jkeiser: ah!  awesome :)
[2014-06-11 16:20:13 -0400] pl1ght: yep boom, works like a champ, thanks again
[2014-06-11 16:20:21 -0400] pl1ght: sigh always something like that right
[2014-06-11 16:20:33 -0400] jkeiser: yeah :)
[2014-06-11 16:21:01 -0400] jkeiser: tier: the irony is that gem isn't even used on Ruby 2.1 because it crashes
[2014-06-11 16:21:12 -0400] jkeiser: tier: I'm not sure how to make a gem install on one Ruby but not on others, though
[2014-06-11 16:21:33 -0400] tier: reasons to love ruby! ;)
[2014-06-11 16:40:37 -0400] segv: damn still can't get this s3 bookshelf thing working
[2014-06-11 16:56:49 -0400] vt102: If my client got an /etc/client.pem, that means it authenticated with the server, correct?
[2014-06-11 16:57:51 -0400] vt102: It's a new server and it is no longer authenticating.  Just want confirmation it did at one time.
[2014-06-11 16:58:47 -0400] segv: this has to be broken in the latest version of chef-server, the s3 bucket feature just does not want to work
[2014-06-11 17:01:50 -0400] segv: https://gist.githubusercontent.com/anonymous/5de081e5480194d2938f/raw/58a7eb93023ed252655f55d559f91d7a23eaa9c1/gistfile1.txt
[2014-06-11 17:02:09 -0400] segv: ==> /var/log/chef-server/nginx/error.log <== that's where that is showing up
[2014-06-11 17:02:23 -0400] segv: when I try to use an external s3 bucket it seems to completely ignore the url :\
[2014-06-11 17:02:51 -0400] jbz: vt102: technically, that means that its validation.pem was accepted, I don't think it necessarily means that it has ever actually authed with that pem.  If there's a node record with attribute info for it, that would indicate that it completed a successful convergence, which *would* mean that it authed at least once, *I think*.
[2014-06-11 17:03:13 -0400] jbz: vt102: sorry, clarify - if there's a node record for it on the chef server, that is.
[2014-06-11 17:04:03 -0400] segv: ah hah!
[2014-06-11 17:04:06 -0400] segv: figured it out.
[2014-06-11 17:04:11 -0400] segv: you guys need to update the documentation
[2014-06-11 17:04:19 -0400] segv: external_url <--- var for bookshelf needs to be set to s3
[2014-06-11 17:05:11 -0400] vt102: jbz: Yes, I have a node record for it.
[2014-06-11 17:05:35 -0400] vt102: Seems just fine from the knife perspective, but I can't run chef-client on it.
[2014-06-11 17:06:07 -0400] jbz: vt102: when you run chef-client on the node as root, what happens?
[2014-06-11 17:06:08 -0400] jbz: it jsut says can't auth?
[2014-06-11 17:06:45 -0400] segv: coderanger, figured out the s3 bucket deal :)
[2014-06-11 17:09:28 -0400] vt102: jbz: NM, I believe I figured it out-- name resuse.  Old server with the same name, but wasn't cleaned up.
[2014-06-11 17:37:34 -0400] segv: hmmm found a chef-server-ctl bug, when using a "vip" in the config, it completely ignores it
[2014-06-11 17:37:42 -0400] segv: chef-server-ctl upgrade**
[2014-06-11 17:52:09 -0400] Majost: Do the weekly Chef code reviews still encompass Chef (opscode) owned cookbooks?
[2014-06-11 17:56:21 -0400] forehand: I'm having trouble overriding an attribute in a cookbook of mine with an environment attribute.  In my cookbook I have the following attribute set: default['PosIIS']['WebLocation'] = 'E:/WEB'.  In my environment I have override attributes set to: {  "overrides": {    "PosIIS": {      "WebLocation": "C:/WEB",      "WebLogsLocation": "C:/WEB_LOGS"    }  }   Yet when I run it on my node which is in that environment it keeps using the c
[2014-06-11 17:58:43 -0400] Majost: forehand: you need to set an attribute precedence higher than default
[2014-06-11 17:58:57 -0400] Majost: http://docs.opscode.com/chef_overview_attributes.html
[2014-06-11 17:59:46 -0400] Majost: You likely need to use normal or override.
[2014-06-11 18:00:16 -0400] forehand: thank you, reading now
[2014-06-11 18:00:21 -0400] Majost: np
[2014-06-11 18:03:14 -0400] forehand: Hm still confused.  When I look at the precedence section it would seem that my cookbook default attributes have lower precedence then my environments override attributes.
[2014-06-11 18:03:45 -0400] forehand: What am I missing?
[2014-06-11 18:04:17 -0400] gleam: environment override is higher than everything except force_override
[2014-06-11 18:05:02 -0400] gleam: your environment should be override_attributes not overrides
[2014-06-11 18:05:55 -0400] gleam: fwiw your environment default attributes will override the cookbook default attributes, so you shouldn't need to override
[2014-06-11 18:05:58 -0400] gleam: and can use default_attributes instead
[2014-06-11 18:15:29 -0400] phantasm66: i have an erb template in a cookbook that looks like this:
[2014-06-11 18:15:31 -0400] phantasm66: https://gist.github.com/phantasm66/53872e030ab8623f0dcc
[2014-06-11 18:16:24 -0400] phantasm66: the files that are found in that Dir.glob in the template have increased since the first chef client run
[2014-06-11 18:16:45 -0400] phantasm66: subsequent runs of the template resource show this:
[2014-06-11 18:17:21 -0400] phantasm66: https://gist.github.com/phantasm66/2616d42429fea999176b
[2014-06-11 18:17:53 -0400] phantasm66: so if the results of the template's Dir.glob are *different*.. why does the template resource not reflect that in the rendered file on my node?
[2014-06-11 18:18:36 -0400] forehand: hm tried setting the environments  default attribute in the web admin console to: {"default_attributes": {   "PosIIS": {     "WebLocation": "C:/WEB",     "WebLogsLocation": "C:/WEB_LOGS"   } }} but it still didn't use it in the cookbook.  I did env show with knife and saw it said "default_attributes: default_attributes: PosIIS...."  which seemed redundant so I tried setting the default attributes to just:
[2014-06-11 18:18:38 -0400] forehand: { "PosIIS": { "WebLocation": "C:/WEB", "WebLogsLocation": "C:/WEB_LOGS" } }}
[2014-06-11 18:18:50 -0400] forehand: still not seeing them used in the cookbook...
[2014-06-11 18:19:19 -0400] phantasm66: and the next question... how can i make it so chef *does* re-render the file from the template when the results of the Dir.glob are different?
[2014-06-11 18:19:45 -0400] Majost: phantasm66: I have to check the template resource code, but I suspect it is because chef compiles the cookbook before the template is rendered, and thus does not realize the file has changed.
[2014-06-11 18:20:20 -0400] jbz: phantasm66: I don't have a specific answer for you, but what I would try is having the Dir.glob expansion done in a code block and use that to send a variables array/hash to the template
[2014-06-11 18:20:34 -0400] jbz: rather than having the template erb do that work
[2014-06-11 18:20:37 -0400] Majost: or an lwrp
[2014-06-11 18:20:48 -0400] jbz: or a lwrp, I suppose, yes
[2014-06-11 18:21:19 -0400] phantasm66: k.. great suggestions.. i'll try the template variables from a code block
[2014-06-11 18:21:34 -0400] Majost: (actually, a definition would be ideal for this)
[2014-06-11 18:21:55 -0400] phantasm66: hmm, k.. i'll look into that :)
[2014-06-11 18:21:58 -0400] phantasm66: thanks!
[2014-06-11 18:22:01 -0400] Majost: np
[2014-06-11 18:22:06 -0400] jbz: yw
[2014-06-11 18:36:01 -0400] forehand: Hm having trouble finding a real basic tutorial on overriding attributes with environment attributes.  Anyone?
[2014-06-11 18:36:41 -0400] forehand: Or just example sources for environments...
[2014-06-11 18:36:44 -0400] jidar: um, I can't imagine you need a tutorial, unless I'm missing something. Just look up the doc that tells you what attributes sit at what teir
[2014-06-11 18:37:02 -0400] jidar: 1-15, etc. Env vars likely just need the override.whatever
[2014-06-11 18:37:14 -0400] mikesplain: forehand: http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2014-06-11 18:37:40 -0400] jidar: env variables do have a goofy config though, I'll paste you an example
[2014-06-11 18:37:47 -0400] mikesplain: The hierarchy is located there... I would suggest saving the diagram half way down the page
[2014-06-11 18:38:09 -0400] jidar: override_attributes({ "tz" => "America/Los_Angeles"})
[2014-06-11 18:38:15 -0400] forehand: I think I might be getting the json wrong for the environment attributes.  Example for there?
[2014-06-11 18:38:27 -0400] jidar: yea, that's what I'm saying is a bit of a pain
[2014-06-11 18:38:34 -0400] jidar: because its json inside of the rb
[2014-06-11 18:38:38 -0400] mikesplain: yeah hah
[2014-06-11 18:40:35 -0400] forehand: yeah if I could just see an example environment source that overrides another example cookbook I think I'd be good.
[2014-06-11 18:40:46 -0400] djlee: HI all, how do you use a resource/provider from another cookbook. I have a cookbook that installs composer, and in my app cookbook i want to run "composer install" via the composer resource. I have got "depends 'composer'" in my metadata.rb and i have tried using compouser_update
[2014-06-11 18:42:32 -0400] r3dk1ng: is it possible to put something like an "end" statement in a chef recipe?
[2014-06-11 18:42:42 -0400] mikesplain: forehand: How about something like this: https://gist.github.com/mikesplain/eab309116f31ac8a5725
[2014-06-11 18:42:56 -0400] r3dk1ng: so that based upon a condition in a block of code, you can end the recipe before it reads more code?
[2014-06-11 18:43:28 -0400] mikesplain: forehand: believe it or not, those default attributes will override defaults from a cookbook... or you could move that whole section into override_attributes
[2014-06-11 18:43:56 -0400] mattupstate: ohai doesn't want to work in the context of a chef-client run, but works fine on its own http://paste.pound-python.org/show/wjEgTu35F983VDK6vTfG/
[2014-06-11 18:43:58 -0400] mattupstate: any ideas?
[2014-06-11 18:46:47 -0400] pmcc: hi all.  I'm trying to boostrap a node from a bash script (so i can boostrap multiple nodes). basically i pass in a list of nodes to boostrap and the script calls bootstrap once for each node.  its getting hung up on "Waiting for remote response before bootstrap."  if i run the command that the bash script executes "knife boostrap windows winrm ..." it works fine.
[2014-06-11 18:46:54 -0400] forehand: k I am done messin with the gui and will create the env from file ;-)
[2014-06-11 18:47:40 -0400] forehand: That did it. thx thx thx
[2014-06-11 18:47:54 -0400] pmcc: here be my script; http://pastebin.com/Tmpc6BjH
[2014-06-11 18:48:12 -0400] mikesplain: forehand np
[2014-06-11 18:56:48 -0400] whiteadam: I've got this server... df says disk is 95% full, du shows 5% in use... what am I missing?
[2014-06-11 18:58:19 -0400] douglaswth: not really a chef question, but there could be files handles to deleted files that are still open
[2014-06-11 18:58:43 -0400] stormerider: whiteadam: check lsof
[2014-06-11 18:59:23 -0400] whiteadam: stormerider: great call
[2014-06-11 19:04:08 -0400] Majost: How does one define the attribute level when setting attibutes via .kitchen.yml?
[2014-06-11 19:05:50 -0400] btm: @chef code review: join: bit.ly/1hPdjzG watch: bit.ly/1hPdhIa
[2014-06-11 19:07:51 -0400] raymond: We're running into some issues when backfilling some tests on recipes, namely recipes that do a search against a chef server. Aside from chefspec, has anyone here had any success in testing searches in test-kitchen?
[2014-06-11 19:08:58 -0400] raymond: We have looked at chef-solo-search (apparently it does not support role searches) and serchef requires a gem to be installed on the test node.
[2014-06-11 19:09:46 -0400] Majost: btm: Are cookbook changes still reviewed for Chef owned cookbooks?
[2014-06-11 19:11:26 -0400] cheeseplus: raymond: chef_zero?
[2014-06-11 19:12:13 -0400] someara: majost they sure are... what's up
[2014-06-11 19:12:54 -0400] raymond: cheeseplus: we are using the vagrant driver for test-kitchen has anyone had luck with the chef-zero driver?
[2014-06-11 19:13:19 -0400] Majost: someara: there is a small fix I want to send a PR for COOK-4717 I opened, but I was not sure about the current process.
[2014-06-11 19:13:36 -0400] Majost: someara: Overall, I would love to help bring the PR backlog down on some of those
[2014-06-11 19:14:12 -0400] raymond: cheeseplus: We would like to avoid that route as it makes the ci more troublesome.
[2014-06-11 19:15:11 -0400] Majost: someara: Since I have your attention; what about hw-cookbooks?
[2014-06-11 19:15:31 -0400] someara: I'm actually in the middle of a merge sweep right now... we're in the process of moving from JIRA to using Github issues, so we've been a little slower than usual with merges
[2014-06-11 19:15:38 -0400] someara: hw-cookbooks are maintained by heavywater
[2014-06-11 19:15:55 -0400] Majost: yeah, but there are a few which were taken over from Chef
[2014-06-11 19:16:20 -0400] someara: indeed. haproxy and postgres iirc
[2014-06-11 19:16:23 -0400] Majost: Is  there any formal process for those specifically taken over?
[2014-06-11 19:16:58 -0400] someara: nope... the idea is that they're supposed to maintain them with their own processes.
[2014-06-11 19:17:03 -0400] someara: we still have commit bit though
[2014-06-11 19:17:18 -0400] raymond: If anyone has gotten chef-solo-search to work with roles and has an example they could share that would be awsome.
[2014-06-11 19:17:39 -0400] someara: they requested to maintain them, as they're subject matter experts
[2014-06-11 19:18:07 -0400] smithmb: Anyone have a pointer to a chef 11 compatible community monit cookbook? looks like the current one listed on opscode only works under chef 10
[2014-06-11 19:21:35 -0400] Majost: someara: Yeah, I have concerns about that as the PR and issue backlog grows for those. I realize the overhead of the review process for tons of cookbooks isn't scalable, but it increasingly difficult to prevent long-term forks without a shared community process for these.
[2014-06-11 19:24:11 -0400] someara: historically, the primary roadblock has been CLA checking... as in, we absolutely have to do it. The JIRA workflow was set up so that only tickets with "fix provided" clicked would make it into our review/merge queues, and you can only click that button if you had a CLA signed
[2014-06-11 19:24:27 -0400] someara: so we ignored github PRs in favor or the JIRA workflow
[2014-06-11 19:24:47 -0400] someara: recently we've came to our senses and decided that using github is the way to go
[2014-06-11 19:25:05 -0400] someara: but we had to build a new CLA checking system
[2014-06-11 19:25:18 -0400] Majost: CLA is no longer a requirement?
[2014-06-11 19:25:34 -0400] someara: when supermarket gets deployed (sooooon), it will check against a CLA database and put a label on a ticket
[2014-06-11 19:25:36 -0400] jtimberman: it's absolutely a requirement
[2014-06-11 19:25:51 -0400] Majost: ah
[2014-06-11 19:26:57 -0400] someara: anyway that's going to enable us to just "click the green button"
[2014-06-11 19:27:21 -0400] someara: which is going to go a long way
[2014-06-11 19:28:07 -0400] Majost: just getting antsy
[2014-06-11 19:28:09 -0400] Majost: heh
[2014-06-11 19:29:34 -0400] someara: tell you what, I'll do tomcat next just because
[2014-06-11 19:30:24 -0400] someara: this may take a while https://github.com/organizations/opscode-cookbooks/dashboard/pulls/for/opscode-cookbooks/tomcat
[2014-06-11 19:31:20 -0400] Majost: someara: I dont have an open PR right now -- but just wanted to find out what the current status
[2014-06-11 19:31:26 -0400] Majost: is
[2014-06-11 19:31:58 -0400] Majost: nevertheless, appreciated. =)
[2014-06-11 19:33:18 -0400] someara: np
[2014-06-11 19:33:53 -0400] Majost: my antsy remark, fwiw, was regarding supermarket.
[2014-06-11 19:37:07 -0400] someara: you can spy on us here: https://gitter.im/opscode/supermarket
[2014-06-11 19:39:31 -0400] newbiechef12345: DEBUG: Re-raising exception: Chef::Exceptions::Service - service[ntpd] (ntp::default line 27) had an error: Chef::Exceptions::Service: service[ntpd]: unable to locate the init.d script
[2014-06-11 19:39:41 -0400] newbiechef12345: any idea?
[2014-06-11 19:40:01 -0400] newbiechef12345: I only hit this during post install kickstart?
[2014-06-11 19:40:31 -0400] newbiechef12345: or is there a way to not starting service during kickstart's post?
[2014-06-11 19:50:42 -0400] anthonyacquanita: newbiechef12345:  You would have to override something/somehow during package installation or cripple chkconfig/service/rc.d somehow
[2014-06-11 20:39:10 -0400] supa_: Could someone hint me in th direction of the best way to require a cookbook in an individual recipe?
[2014-06-11 20:40:03 -0400] jbz: supa_: you have to place the dependency in the cookbook metadata.  You can't do it from a specific recipe.
[2014-06-11 20:40:29 -0400] jbz: You can include it - execute code - from a recipe, but for that to work you have to have the dependency in the cookbook metadata.
[2014-06-11 20:42:13 -0400] supa_: jbz: Ah, ok, I was really hoping I could use it as a dependency only to a specific recipe.
[2014-06-11 20:42:16 -0400] supa_: hm
[2014-06-11 20:42:31 -0400] jbz: supa:  Nope, because it does dependency resolution based on cookbooks, not which recipes are actually executed later
[2014-06-11 20:42:32 -0400] Firespirit: Hi all, i have a little question. I would like to know inside a recipe if it's possible to notifies a ruby block to run but not a notifies within a resources. just a if statement launch the ruby_block...? I hope i'm clear
[2014-06-11 20:42:36 -0400] supa_: The recipe will fail if the dependency is missing, anyway, so I suppose that's "close enough". :)
[2014-06-11 20:43:13 -0400] jbz: Firespirit: you can wrap a resource in an 'if' statement, and they will only get compiled if the if statement is satisfied
[2014-06-11 20:43:32 -0400] jbz: Firespirit: but the if statement is resolved at *compile time*, not execution, so be careful :-)
[2014-06-11 20:45:07 -0400] Firespirit: jbs: I'm not sure i understand... my ruby block as 25 line... i don't want to retype it 4 time in my recipe when i need to call his execution that's why i want it to act like a notifies in a template resource but i only have if condition
[2014-06-11 20:46:01 -0400] jbz: Firespirit: do you understand the difference between compile time and execute time?
[2014-06-11 20:46:10 -0400] Firespirit: yes
[2014-06-11 20:46:11 -0400] jbz: ok
[2014-06-11 20:46:31 -0400] jbz: I think I"m confused by your question then
[2014-06-11 20:46:35 -0400] Firespirit: ok
[2014-06-11 20:46:57 -0400] jbz: Do you just want a shortcut to doing the same thing several times?
[2014-06-11 20:47:08 -0400] Firespirit: you agree that we can have a template resource notifies a service resource in chef per example
[2014-06-11 20:47:15 -0400] jbz: sure
[2014-06-11 20:48:19 -0400] jbz: Do you maybe want a definition?  Put the block into a definition, then wrap the definition call in an if statement?
[2014-06-11 20:48:22 -0400] Firespirit: so i want the same logic but only using a logic like if toto == true notifies :create, "ruby_block[toto], :immediately else do other thing end
[2014-06-11 20:48:51 -0400] jbz: But you want that if statement to be evaluated during *execution*?
[2014-06-11 20:49:16 -0400] Firespirit: no it's fine if it's at compile time too
[2014-06-11 20:49:24 -0400] jbz: oh ok
[2014-06-11 20:49:54 -0400] Firespirit: it's juste that my ruby_block action is set to nothing... and i want to trigger it if my if statement it's true...
[2014-06-11 20:50:27 -0400] jbz: oh ,sure - then write the block out with default action :nothing, and have it be notified to :run
[2014-06-11 20:50:52 -0400] jbz: then it'll be defined, but won't do anything unless one or more notifications to run are received
[2014-06-11 20:51:01 -0400] jbz: do you want it to run multiple times?
[2014-06-11 20:51:49 -0400] Firespirit: so as you said if toto == true  notifies :create, "ruby_block[toto]", :immediately
[2014-06-11 20:51:53 -0400] Firespirit: will work?
[2014-06-11 20:51:57 -0400] jbz: no
[2014-06-11 20:52:00 -0400] Firespirit: or it's need to be :run ?
[2014-06-11 20:52:01 -0400] jbz: notifies :run
[2014-06-11 20:52:12 -0400] jbz: hm I think it's run
[2014-06-11 20:52:15 -0400] Firespirit: let me try because i tried with create without success...
[2014-06-11 20:52:15 -0400] jbz: now I'm not sure hahaha
[2014-06-11 20:52:25 -0400] jbz: create just creates the resource as available
[2014-06-11 20:52:29 -0400] jbz: I think
[2014-06-11 20:52:33 -0400] jbz: but I could be wrong.
[2014-06-11 20:53:00 -0400] Firespirit: will know in 30 sec :)
[2014-06-11 20:53:27 -0400] jbz: wait I think I'm wrong
[2014-06-11 20:53:30 -0400] jbz: sigh, sorry
[2014-06-11 20:54:10 -0400] jbz: yeah, ignore me, I just directly contradicted the docs.
[2014-06-11 20:54:11 -0400] Firespirit: still not working
[2014-06-11 20:54:13 -0400] Firespirit: i got
[2014-06-11 20:54:14 -0400] Firespirit: Cannot find a resource for notifies on windows version 6.1.7601[0m
[2014-06-11 20:54:23 -0400] jbz: yeah :run is totally wrong, my bad.
[2014-06-11 20:54:38 -0400] jbz: so what might be happening
[2014-06-11 20:54:44 -0400] Firespirit: i will try a different syntax let me try
[2014-06-11 20:54:50 -0400] jbz: is that if you if statement comes prior to the block definition in order
[2014-06-11 20:54:55 -0400] jbz: then it won't work
[2014-06-11 20:55:15 -0400] jbz: cause it will evaluate the if statement at compile but it might not have compiled that resource yet
[2014-06-11 20:55:17 -0400] Firespirit: notifies :create, resources(:ruby_block => "toto"), :immediately
[2014-06-11 20:57:01 -0400] Firespirit: anyone else have an idea?
[2014-06-11 20:59:52 -0400] supa_: Is there a way to require a recipe run before another recipe/cookbook independent of the run_list?
[2014-06-11 21:02:07 -0400] coderanger: supa_: include_recipe
[2014-06-11 21:02:48 -0400] supa_: hm
[2014-06-11 21:03:31 -0400] supa_: Let's say I have a logstash cookbook and I want to append node settings in recipeX before the logstash recipe runs.  I'm not sure how to do that with include_recipe (unless I put it in the logstash cookbook)
[2014-06-11 21:03:33 -0400] Firespirit: coderanger!!!
[2014-06-11 21:03:38 -0400] supa_: I could make a wrapper, I guess.
[2014-06-11 21:03:49 -0400] coderanger: supa_: Yep, thats what a wrapper is for :)
[2014-06-11 21:03:55 -0400] coderanger: Firespirit: Alo
[2014-06-11 21:04:03 -0400] Firespirit: coderanger did you see my question i asked earlier?
[2014-06-11 21:04:53 -0400] supa_: coderanger: Ok, I think I follow.  So if I wanted to add logstash agent settings, you're suggesting I use logstash_wrapper to include_recipe(service with logstash settings)?
[2014-06-11 21:05:14 -0400] coderanger: Firespirit: Nope, haven't looked at scrollback yet
[2014-06-11 21:05:35 -0400] Firespirit: i can ask it again coderanger if you prefer
[2014-06-11 21:05:47 -0400] coderanger: supa_: Yes, generally it would be named <your company>-logstash
[2014-06-11 21:06:03 -0400] coderanger: Firespirit: One second, just got out of bed so catching up on many things :)
[2014-06-11 21:06:47 -0400] Firespirit: coderanger: my ruby block in a recipe as 25 line... i don't want to retype it 4 time in my recipe when i need to call his execution that's why i want it to act like a notifies in a template resource but i only have if condition
[2014-06-11 21:06:53 -0400] coderanger: Firespirit: Put your logic in a ruby function, or make a resource
[2014-06-11 21:07:44 -0400] Firespirit: i try to do it in a method
[2014-06-11 21:07:58 -0400] Firespirit: bu my %x statement get executed at compile time
[2014-06-11 21:08:00 -0400] supa_: I'm trying to wrap my head around how this would work.  I would have a <company>-wrapper that includes <services>, but then I wouldn't be able to add individual services in roles without logstash.
[2014-06-11 21:08:14 -0400] coderanger: Firespirit: Please pastebin your code
[2014-06-11 21:08:58 -0400] coderanger: supa_: foo-logstash depends on logstash, it exposes the same recipes which mostly consist of "include_recipe 'logstash::whatever'", and possibly some extra code
[2014-06-11 21:09:52 -0400] Firespirit: coderanger: http://pastebin.com/L9tpEw9A
[2014-06-11 21:10:44 -0400] coderanger: Firespirit: And how are you trying to make this work?
[2014-06-11 21:11:07 -0400] supa_: There would be 3 cookbooks.  logstash, <company>-wrapper-logstash, ServiceCollection[Xservice, Yservice, etc].  Could I do a conditional include?  Like if node has role of <Xservice>, include Xservice - that way the services could still be distributed in roles.
[2014-06-11 21:11:34 -0400] coderanger: I have no idea what this ServiceCollection cookbook would be
[2014-06-11 21:11:53 -0400] coderanger: cookbooks should reflects nouns, and should be entirely encapsulated
[2014-06-11 21:12:05 -0400] supa_: That would be my collection of service recipes.  It's a "fluff" name.
[2014-06-11 21:12:15 -0400] coderanger: What is a service recipe
[2014-06-11 21:12:18 -0400] Firespirit: coderanger: i think the solution will be to put my %x command in a batch or execute resource
[2014-06-11 21:12:20 -0400] coderanger: and how is that different from a normal recipe
[2014-06-11 21:12:27 -0400] supa_: My custom service (normal recipe).
[2014-06-11 21:12:36 -0400] coderanger: Firespirit: That seems likely, %x shouldn't be used from inside chef
[2014-06-11 21:12:45 -0400] coderanger: Firespirit: At a minimum, use shellout
[2014-06-11 21:13:26 -0400] coderanger: supa_: your application cookbooks should just depend on whatever they need to depend on
[2014-06-11 21:14:00 -0400] Firespirit: coderanger: i don't understand what you said maybe too advance for me but shellout is a chef resource too?
[2014-06-11 21:15:04 -0400] supa_: coderanger: Right.  In this case, I have a cookbook of my own personal software and configuration.  Only some of that software depends on logstash.  The previous maintainer put all of the logstash config in environments, but I would like it to be in the recipes for the software that requires logstash.
[2014-06-11 21:15:32 -0400] coderanger: Firespirit: No, it is a gem, it is what powers the execute resource and everything based on it, but you can also call it directly if you want to
[2014-06-11 21:17:14 -0400] coderanger: supa_: Seems reasonable to me
[2014-06-11 21:17:31 -0400] coderanger: Obligatory plug: I offer training and consulting services on this kind of advanced Chef usage stuff :)
[2014-06-11 21:17:41 -0400] supa_: coderanger: Ok, now I'm just trying to figure out how to do that. :)
[2014-06-11 21:17:58 -0400] coderanger: supa_: x depends on y depends on z
[2014-06-11 21:18:06 -0400] coderanger: supa_: Just like you would with any other software
[2014-06-11 21:18:13 -0400] supa_: That's the part I'm stuck on...
[2014-06-11 21:18:17 -0400] z: everything depends on me, yes
[2014-06-11 21:18:19 -0400] coderanger: just remember cookbooks are equiv to gems or packages
[2014-06-11 21:18:36 -0400] supa_: The end goal is to have a shipper.conf with the correct values for XYZService which is a part of MyServicesCollection cookbook.
[2014-06-11 21:18:41 -0400] z: pay me all of the money?
[2014-06-11 21:21:40 -0400] coderanger: supa_: I think you need to stop calling them services, the word "service" has a particular meaning in opsys-land and you mean more than that
[2014-06-11 21:22:56 -0400] supa_: coderanger: Semantic
[2014-06-11 21:23:17 -0400] supa_: For the example, MyCollectionofPoo would be synonymous.
[2014-06-11 21:24:06 -0400] coderanger: supa_: It would, in fact, not be :P
[2014-06-11 21:24:14 -0400] supa_: coderanger: Explain the difference?
[2014-06-11 21:24:25 -0400] coderanger: Anyways, just use cookbook dependencies in metadata.rb and include_recipe
[2014-06-11 21:24:31 -0400] coderanger: those are the two tools in the aresenal
[2014-06-11 21:24:37 -0400] medya: is it possible for a databag item to get ip of a node (if a node's ip changes every day, the databag item should change accordingly) ?
[2014-06-11 21:25:04 -0400] supa_: The thing I'm trying to avoid is a role defining a recipe from MyCollectionofThings that *doesn't* require logstash now having a logstash dependency.
[2014-06-11 21:25:24 -0400] supa_: If I add logstash to the metadata of MyCollectionofThings then that is the result....
[2014-06-11 21:26:26 -0400] coderanger: medya: data_bag_item('whatever', node['ipaddress'])
[2014-06-11 21:26:38 -0400] coderanger: supa_: That isn't possible
[2014-06-11 21:26:50 -0400] coderanger: supa_: But depending on a cookbook is fine, it won't run the recipes
[2014-06-11 21:27:55 -0400] supa_: coderanger: There's a node.roles.include?.  I couldn't leverage that in my-logstash-wrapper to check for a role matching the software that depends on logstash and include that recipe?
[2014-06-11 21:28:57 -0400] coderanger: supa_: No, dependencies are not conditional
[2014-06-11 21:29:09 -0400] coderanger: supa_: They are static metadata because they are used during version solution
[2014-06-11 21:29:38 -0400] coderanger: supa_: Again, if you would like detailed help with this, I'm happy to talk about consulting and training offerings
[2014-06-11 21:30:14 -0400] supa_: coderanger: dependencies in metadata.rb are, but includes in recipes are not.
[2014-06-11 21:30:17 -0400] supa_: right?
[2014-06-11 21:30:20 -0400] coderanger: Correct
[2014-06-11 21:31:21 -0400] rayrod2030: coderanger: Can I set up a consulting engagement so that my team can admire your beard?
[2014-06-11 21:31:41 -0400] supa_: Then wouldn't this resolve the original question in some form?  If I used my-logstash-wrapper and added node.recipes.include(_logstash_requiring_service) { include(_logstash_requiring_service) } then I would have the logstash_requiring_service run before the logstash cookbook and create an appropriate shipper.conf dynamically.
[2014-06-11 21:32:02 -0400] medya: @coderanger can a databag item get attribute of another item? like in loadbalancer's node I wanna get the ip of tomcat node , is that possible?
[2014-06-11 21:32:21 -0400] medya: @coderanger how can I make it to be data_bag_item('whatever', other_node['ipaddress'])
[2014-06-11 21:33:42 -0400] Majost: I am going to refactor this logic in the tomcat cookbook: https://github.com/opscode-cookbooks/tomcat/blob/fe02350ccba772357fc0e34536c32d0a4ca623f6/recipes/default.rb#L127-L152
[2014-06-11 21:33:53 -0400] Majost: I am thinking it is better suited for a definition
[2014-06-11 21:34:16 -0400] coderanger: medya: Sure, its all just code
[2014-06-11 21:34:35 -0400] Majost: but I am not sure if that is a going to be an issue for a pull request
[2014-06-11 21:35:10 -0400] coderanger: Majost: Never used definitions, they have absolutely no place in Chef anymore
[2014-06-11 21:35:11 -0400] medya: how can I say other node ? do I have to know the other nodes name ?
[2014-06-11 21:35:18 -0400] someara: I'm about to try and merge 21 prs.... lets just see if the code looks anything like it does now when it comes out the other end
[2014-06-11 21:35:28 -0400] coderanger: medya: Yes, you have to access the data from the API somehow
[2014-06-11 21:35:41 -0400] medya: where is that api
[2014-06-11 21:35:43 -0400] coderanger: medya: search is an option
[2014-06-11 21:35:49 -0400] coderanger: medya: Chef server API
[2014-06-11 21:36:21 -0400] Majost: coderanger: I figured they are good for local LWRP, where they don't provide value to external cookbooks or wrappers - but clean up the overall cookbook.
[2014-06-11 21:36:28 -0400] segv: coderanger, i should probably answer that guy on the mailing list, you guys added an undocumented "external_url" to bookshelf and that's what fixed my issue with s3 buckets
[2014-06-11 21:36:29 -0400] medya: so it would be like data_bag_item('whatever', :search('search for tomcat server')['ipaddress')]
[2014-06-11 21:36:43 -0400] Majost: coderanger: should just do it as an lwrp instead then?
[2014-06-11 21:36:50 -0400] someara: there's a PR to make lwrps already in the queue
[2014-06-11 21:37:11 -0400] coderanger: Majost: Not sure why you would draw a distinction, both are global
[2014-06-11 21:37:27 -0400] coderanger: segv: \o/ (also there is no "you guys", I don't work for opscode)
[2014-06-11 21:37:32 -0400] segv: ohhh
[2014-06-11 21:37:37 -0400] Majost: coderanger: oh, I didn't realize that.. I thought it was scoped. hah
[2014-06-11 21:37:39 -0400] segv: thought you worked there haha
[2014-06-11 21:37:48 -0400] coderanger: segv: Used to, I don't anymore
[2014-06-11 21:37:52 -0400] segv: ah, roger that
[2014-06-11 21:38:16 -0400] coderanger: Majost: Nope, different mechanism but both are global :)
[2014-06-11 21:38:32 -0400] coderanger: Majost: You can make things that look like non-global resources, but its not simple
[2014-06-11 21:39:19 -0400] Majost: coderanger: Non-global would be a nice thing... not really necessary, but nice.
[2014-06-11 21:40:10 -0400] coderanger: Majost: I would go the simple route :)
[2014-06-11 21:40:12 -0400] Majost: someara: the PR is for multiple instances of tomca
[2014-06-11 21:40:13 -0400] Majost: t
[2014-06-11 21:40:22 -0400] Majost: it shouldn't collide (much)
[2014-06-11 21:40:53 -0400] coderanger: Majost: LWRPs are scoped to have the cookbook name in the resource name, it should be impossible for them to collide
[2014-06-11 21:40:55 -0400] Majost: coderanger: the simple route is to slap a case statement in there
[2014-06-11 21:40:55 -0400] Majost: heh
[2014-06-11 21:41:00 -0400] coderanger: (unless someone does something really silly)
[2014-06-11 21:41:18 -0400] Majost: ah, good point
[2014-06-11 21:49:40 -0400] eliklein: someara: you around?
[2014-06-11 21:49:49 -0400] someara: sup
[2014-06-11 21:49:59 -0400] eliklein: someara: running into some weirdness with the postfix cookbook on version 3.3.1 which just got released
[2014-06-11 21:50:19 -0400] someara: okay
[2014-06-11 21:50:33 -0400] eliklein: someara: dependency solving issues
[2014-06-11 21:50:36 -0400] eliklein: with berkshelf
[2014-06-11 21:51:01 -0400] eliklein: i have postfix '~> 3.0' in metadata for a cookbook
[2014-06-11 21:51:43 -0400] eliklein: and it's saying it can't solve the dependency now that it's using 3.3.1
[2014-06-11 21:53:34 -0400] eliklein: my apologies. oit
[2014-06-11 21:53:39 -0400] someara: hrm... some other cookbook is pinned down to '~> 3.0' ?
[2014-06-11 21:53:42 -0400] eliklein: oops, it's during a chef run that the depsolving is coming up
[2014-06-11 21:53:56 -0400] eliklein: well ~> 3.0 should pick up 3.3.1 just fine
[2014-06-11 21:54:05 -0400] eliklein: just not 4.x
[2014-06-11 21:58:25 -0400] someara: okay so your cookbook depends on '~> 3.0', berkshelf pulled in 3.3.1, you now have it installed on your chef-server, and when you run chef-client, it explodes on a missing dep?
[2014-06-11 21:59:36 -0400] eliklein: i have a cookbook called 'base' that depends on postfix ~> 3.0
[2014-06-11 22:00:21 -0400] wdpro_kevin: ohai chefs
[2014-06-11 22:00:47 -0400] wdpro_kevin: test-kitchen question: How do you run a single suite from your kitchen.yml?
[2014-06-11 22:00:58 -0400] josephholsten: sethvargo: are you releasing chefspec with #451 (chef-zero data not found error) soon?
[2014-06-11 22:01:02 -0400] josephholsten: <3
[2014-06-11 22:01:06 -0400] coderanger: wdpro_kevin: kitchen test suite-platform
[2014-06-11 22:01:36 -0400] wdpro_kevin: let me try that again didn't work as advertised the previous time
[2014-06-11 22:02:07 -0400] josephholsten: wdpro_kevin: what did you do, what did you expect, what happened instead?
[2014-06-11 22:02:34 -0400] wdpro_kevin: no must be my fat sausage like fingers
[2014-06-11 22:03:00 -0400] wdpro_kevin: I just needs Noah reassurance that everything will be all right
[2014-06-11 22:03:07 -0400] wdpro_kevin: alright
[2014-06-11 22:03:26 -0400] mfeingold: Hey guys how are you today? I am having a problem during kitchen test. I ran kitchen converge and verify for jenkins on centos64, kitchen destroy, and they were successfull, but when I run kitchen test, it gets stuck on "== default: Forcing shutdown of VM" right after "Destroying <default-centos-64>"
[2014-06-11 22:04:30 -0400] josephholsten: mfeingold: what version are you using? are you using the vagrant driver?
[2014-06-11 22:04:53 -0400] wdpro_kevin: *nods at josephholsten*
[2014-06-11 22:18:10 -0400] while1eq1: is there a way I can access a template from another cookbook when I source "template_name.erb"  ?
[2014-06-11 22:18:20 -0400] coderanger: while1eq1: cookbook attribute
[2014-06-11 22:18:37 -0400] coderanger: while1eq1: Works on both template and cookbook_file
[2014-06-11 22:19:14 -0400] while1eq1: I would use is like : source " ?? "
[2014-06-11 22:19:28 -0400] josephholsten: admins: the title should be updated to chef 11.12.8
[2014-06-11 22:19:41 -0400] josephholsten: unless a new security issue came out in the last hour
[2014-06-11 22:21:49 -0400] while1eq1: I got it, so in the resource just use: cookbook "whatever_book_has_the_template"  ?
[2014-06-11 22:22:01 -0400] josephholsten: yep!
[2014-06-11 22:22:13 -0400] while1eq1: well damn that didnt work as planned
[2014-06-11 22:24:55 -0400] while1eq1: https://gist.github.com/while1eq1/c392da4f24455429d54d
[2014-06-11 22:25:42 -0400] josephholsten: while1eq1: what version of chef are you running?
[2014-06-11 22:25:58 -0400] while1eq1: Chef 10.16.
[2014-06-11 22:26:06 -0400] josephholsten: I'm used to the output actually telling you the line in the template that's busted
[2014-06-11 22:26:10 -0400] josephholsten: ah
[2014-06-11 22:26:36 -0400] coderanger: while1eq1: You are vulnerable to at least two _serious_ TLS issues, upgrade immediately
[2014-06-11 22:26:54 -0400] while1eq1: @coderanger: will do
[2014-06-11 22:27:08 -0400] coderanger: while1eq1: Probably an error inside the template
[2014-06-11 22:27:09 -0400] josephholsten: well your template isn't defensive enough. you're iterating over a variable that hasn't been set
[2014-06-11 22:27:53 -0400] josephholsten: wait, you aren't passing any variables
[2014-06-11 22:28:00 -0400] josephholsten: are you accessing node attributes in there?
[2014-06-11 22:28:32 -0400] while1eq1: wtf
[2014-06-11 22:28:43 -0400] while1eq1: no idea why it did that as an "action"
[2014-06-11 22:29:48 -0400] josephholsten: yeah, you aren't passing any thing into @instances
[2014-06-11 22:30:02 -0400] Jerrod: What do I make of this: vagrant-omnibus: * '11.12.7' is not a valid version of Chef.
[2014-06-11 22:30:05 -0400] while1eq1: I wonder why that is, I have them defined in my defautl attributes
[2014-06-11 22:30:26 -0400] josephholsten:  Jerrod: context?
[2014-06-11 22:30:40 -0400] Jerrod: on vagrant up.
[2014-06-11 22:31:10 -0400] stormerider: Jerrod: there is no 11.12.7. they went from .4 to .8
[2014-06-11 22:31:46 -0400] josephholsten: Jerrod: 11.12.7 does not exist: https://rubygems.org/gems/chef/versions
[2014-06-11 22:31:52 -0400] Jerrod: config.omnibus.chef_version = :latest
[2014-06-11 22:32:01 -0400] Jerrod: Weird.
[2014-06-11 22:32:16 -0400] josephholsten: cool, your robot is drunk
[2014-06-11 22:32:33 -0400] stormerider: sounds like someone may have typoed somewhere in the json docs, then.
[2014-06-11 22:32:48 -0400] josephholsten: I suggest a nap followed by a number of asprin
[2014-06-11 22:32:59 -0400] stormerider: set it to 11.12.8 and that should bypass the issue for now.
[2014-06-11 22:33:06 -0400] Jerrod: okey.
[2014-06-11 22:33:33 -0400] stormerider: and i'd suggest filing a bug with info on your OS, OS version, and arch
[2014-06-11 22:34:02 -0400] stormerider: since those are the three keys that determine what it's going to try to point you at.
[2014-06-11 22:35:01 -0400] stormerider: anyone using omnibus_updater with kill_chef_on_upgrade set to false?
[2014-06-11 22:35:09 -0400] mfeingold: @josephholsten I'm using test kitchen 1.2.1 and have vagrant
[2014-06-11 22:36:12 -0400] Jerrod: Setting it fixed the problem, thanks all.
[2014-06-11 22:36:28 -0400] mfeingold: josephholsten: I'm using test kitchen 1.2.1 and have vagrant
[2014-06-11 22:52:47 -0400] supa_: _/exit
[2014-06-11 22:52:50 -0400] supa_: doh
[2014-06-11 22:52:54 -0400] segv: lol
[2014-06-11 22:53:31 -0400] Majost: is there an LWRP :kind_of value for octal?
[2014-06-11 22:53:49 -0400] coderanger: Majost: No, octal literals are just numbers
[2014-06-11 22:54:02 -0400] coderanger: Ruby doesn't know the difference, its a lexer thing
[2014-06-11 22:56:55 -0400] Majost: huh
[2014-06-11 22:57:41 -0400] Majost: so Integer wont strip the octal prefix for 0755?
[2014-06-11 22:58:06 -0400] douglaswth: strip the octal prefix?
[2014-06-11 22:58:27 -0400] Majost: I mean the zero
[2014-06-11 22:58:31 -0400] coderanger: Majost: Not sure what you mean, but as far as Ruby is concerned 1, 01, and 0x1 are all the exact same thing
[2014-06-11 22:59:06 -0400] coderanger: Majost: The lexer converts them all to integer literal AST nodes while its going
[2014-06-11 22:59:07 -0400] Majost: I am adding 'mode' to an lwrp and trying to define the type
[2014-06-11 22:59:21 -0400] coderanger: Majost: Yes, that type is [Integer, String]
[2014-06-11 22:59:51 -0400] Majost: huh
[2014-06-11 23:01:23 -0400] segv: you can pass both to the kind_of
[2014-06-11 23:01:38 -0400] coderanger: Majost: If you pass an array to kind_of is means "it can be any of these"
[2014-06-11 23:01:56 -0400] coderanger: As such, if you want to match Chef's own behavior, thats the value you want
[2014-06-11 23:02:15 -0400] coderanger: that said, I would say using octal literals for file modes is just wrong, but I know I'm in the minority there :)
[2014-06-11 23:02:23 -0400] Majost: heh
[2014-06-11 23:02:39 -0400] Majost: I use to use strings  or straight integers
[2014-06-11 23:02:56 -0400] Majost: it feels wrong to me that you can set an octal via an int
[2014-06-11 23:03:46 -0400] coderanger: Majost: decimal vs. octal (vs hex) has nothing to do with its integer-ness
[2014-06-11 23:03:48 -0400] Majost: Any other language I have used would be very unhappy.. but I have conformed.
[2014-06-11 23:04:10 -0400] coderanger: Majost: No language I know of has a special type for octal literals
[2014-06-11 23:04:13 -0400] Majost: except that it cant start with zero
[2014-06-11 23:05:16 -0400] Majost: I guess I see what you mean
[2014-06-11 23:05:44 -0400] Majost: >>> a = 0123
[2014-06-11 23:05:44 -0400] Majost: >>> print(a)
[2014-06-11 23:05:45 -0400] Majost: 83
[2014-06-11 23:07:15 -0400] Majost: the string version gets converted back
[2014-06-11 23:09:28 -0400] coderanger: Majost: That isn't a string
[2014-06-11 23:09:38 -0400] segv: that's be def an int no?
[2014-06-11 23:09:40 -0400] coderanger: a was always an integer
[2014-06-11 23:10:09 -0400] coderanger: Majost: try this in irb
[2014-06-11 23:10:18 -0400] coderanger: 1.object_id == 01.object_id
[2014-06-11 23:10:23 -0400] coderanger: Majost: Should return true :)
[2014-06-11 23:10:51 -0400] Majost: huh
[2014-06-11 23:11:11 -0400] Majost: indeed it is
[2014-06-11 23:11:32 -0400] coderanger: Majost: By the time the ruby interpreter gets to it, they are exactly the same
[2014-06-11 23:11:33 -0400] mfeingold: Hi guys I'm getting a hang at the end of kitchen test. I'm using Centos64, vagrant driver, kitchen 1.2.1 and I can converge, verify, and destroy fine. The problem occurs when I do kitchen test, and at the end it does a destroy and then writes "==> default: Forcing shutdown of VM" then it hangs with the instance on virtual box as aborted
[2014-06-11 23:28:19 -0400] storme_away: in foodcritic, how do you specify to ignore multiple rules in a .foodcritic file? "~FC003,~FC007,~FC023" doesn't work
[2014-06-11 23:30:19 -0400] storme_away: ah "~FC003 ~FC007 ~FC023" does the trick
[2014-06-11 23:48:48 -0400] jespada: any hints on how to use databags on kitchen.ci  with chef_zero?
[2014-06-11 23:49:45 -0400] jespada: this is not working, https://github.com/test-kitchen/test-kitchen/issues/129
[2014-06-11 23:50:05 -0400] jespada: gonna check src code
[2014-06-11 23:55:44 -0400] juliancdunn: jespada: the syntax changed with 1.2: https://github.com/test-kitchen/test-kitchen/issues/384#issuecomment-37666724
[2014-06-11 23:59:08 -0400] jespada: juliancdunn, tks!, but the data bug is created on the fly ? I mean on the setup part of TK run ?
[2014-06-11 23:59:30 -0400] juliancdunn: yeah, it's uploaded to Chef Zero during the setup phase
