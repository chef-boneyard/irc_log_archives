[2014-06-02 01:07:27 -0400] stormerider: Atttwww: i think it depends on how you're actually doing it, but you should be able to check if the file exists in /etc/apt/sources.list.d
[2014-06-02 03:27:13 -0400] star_unicorn089: Hello everyone, I need some help. I am Running spiceweasel on my infrastructure.yml I get this error. http://pastebin.com/z0L0UZ4J . I have set up my own CA and issued certificates for my chef-server. I Do not know why I am still having this problem.
[2014-06-02 03:27:54 -0400] coderanger: star_unicorn089: What does your knife.rb look like?
[2014-06-02 03:28:35 -0400] star_unicorn089: coderanger, one momney
[2014-06-02 03:28:37 -0400] star_unicorn089: moment
[2014-06-02 03:29:41 -0400] coderanger: star_unicorn089: please use a pastebin
[2014-06-02 03:35:17 -0400] coderanger: star_unicorn089: I don't see anything in there about your custom CA cert
[2014-06-02 03:35:22 -0400] coderanger: Where do you have that configured?
[2014-06-02 03:39:06 -0400] coderanger: star_unicorn089: Please keep chatter in here
[2014-06-02 03:39:20 -0400] star_unicorn089:  coderanger: I am running my CA on 192.168.1.10, my workstation is 192.168.1.11, my chef-server is 192.168.1.12. I copied my server-key-cert.pem to .ssh/ on 192.168.1.11. I installed my certificate on my chef-server
[2014-06-02 03:39:23 -0400] coderanger: I'm about to go to dinner and if post stuff only in PMs no one else can help you
[2014-06-02 03:39:35 -0400] star_unicorn089: ok i got it
[2014-06-02 03:39:50 -0400] coderanger: star_unicorn089: Not sure what you mean by "running your CA on ", a CA isn't a service, its just a set of TLS files
[2014-06-02 03:40:04 -0400] coderanger: and you need to distribute the CA certificate to the clients so they know what to trust
[2014-06-02 03:40:56 -0400] star_unicorn089: the files are on 192.168.1.10
[2014-06-02 03:41:10 -0400] star_unicorn089: you mention i am missing a configuration in my knife file?
[2014-06-02 03:41:44 -0400] star_unicorn089: should i add something in it that points to server-key-cert.pem?
[2014-06-02 03:48:09 -0400] stormerider: star_unicorn089: in newer chef client releases, "knife ssl check" will help you debug issues, but if you're doing a self-signed cert, you need to tell chef to trust it. and running your own CA is essentially self-signing, you just need to trust the CA instead. (if chef server is the only thing your CA is signing, then it's not really worth the hassle of running a CA, imo)
[2014-06-02 03:49:41 -0400] stormerider: star_unicorn089: http://www.getchef.com/blog/2013/10/31/ssl-certificate-validation-in-chef/ might help explain some of this.
[2014-06-02 03:49:51 -0400] star_unicorn089: thank you stormrider
[2014-06-02 03:50:31 -0400] stormerider: np
[2014-06-02 04:27:41 -0400] coderanger: stormerider: o7o7
[2014-06-02 04:39:56 -0400] mjuszczak: Can you use chef-rewind to completely ignore a resource?  As in, delete it?
[2014-06-02 05:24:51 -0400] coderanger: mjuszczak: No, but you can set it to action(:nothing)
[2014-06-02 05:58:55 -0400] stormerider: coderanger: O.o huh?
[2014-06-02 05:59:19 -0400] coderanger: stormerider: Its a little dude saluting
[2014-06-02 05:59:39 -0400] stormerider: ah, never seen that before :)
[2014-06-02 05:59:43 -0400] coderanger: It seems like no one outside of Eve uses this icon :)
[2014-06-02 06:00:02 -0400] stormerider: yeah, never played that
[2014-06-02 06:54:54 -0400] chernjie: Is there an alternative to knife bootstrap? My chef server can not access my chef client, but the reverse is possible
[2014-06-02 06:56:25 -0400] coderanger: chernjie: Not sure what you mean, knife bootstrap doesn't involve the server accessing the client
[2014-06-02 06:56:32 -0400] coderanger: chernjie: Only your workstation has to access the client
[2014-06-02 06:58:44 -0400] chernjie: coderanger: Ah right, I placed my workstation on chef server :p
[2014-06-02 06:59:00 -0400] chernjie: Thanks coderanger
[2014-06-02 06:59:04 -0400] coderanger: chernjie: Probably not a good idea, the idea is your workstation should be your actual workstation :)
[2014-06-02 07:00:41 -0400] chernjie: I was trying to solve the problem of having a common workstation among my team mates
[2014-06-02 07:00:56 -0400] chernjie: so that we don't have to share the private keys
[2014-06-02 07:01:07 -0400] coderanger: chernjie: Why would you have to share keys?
[2014-06-02 07:01:33 -0400] chernjie: under .chef/*pem
[2014-06-02 07:02:00 -0400] coderanger: chernjie: Just make a different API key for each person
[2014-06-02 07:02:10 -0400] coderanger: chernjie: You can have as many as you want
[2014-06-02 07:02:26 -0400] coderanger: (and should)
[2014-06-02 07:03:44 -0400] chernjie: hmmm
[2014-06-02 07:07:20 -0400] chernjie: sorry trying to wrap my head around this
[2014-06-02 07:07:46 -0400] coderanger: chernjie: Are you using open source chef or enterprise?
[2014-06-02 07:08:10 -0400] chernjie: for bootstrap, only the *-validator.pem is being used, right?
[2014-06-02 07:09:06 -0400] coderanger: Correct
[2014-06-02 07:09:09 -0400] chernjie: I am using open source chef
[2014-06-02 07:09:22 -0400] chernjie: I see two pem files in my client server: client.pem and validation.pem
[2014-06-02 07:10:25 -0400] coderanger: Indeed, the client.pem is your user key
[2014-06-02 07:10:33 -0400] coderanger: used for talking to the chef server
[2014-06-02 07:10:42 -0400] coderanger: (which knife bootstrap doesn't actually do ever)
[2014-06-02 07:11:01 -0400] coderanger: the validation key is used when a new node is starting up to allow it to register with the server and get its own node key
[2014-06-02 07:11:08 -0400] chernjie: if my team mate does not have the *-validator.pem, he/she will not be able to "bootstrap" a server, is that right?
[2014-06-02 07:12:08 -0400] chernjie: is node key =client.pem?
[2014-06-02 07:12:49 -0400] coderanger: Correct, the validation key has to be shared by all the admins
[2014-06-02 07:14:28 -0400] chernjie: which is fine not to share, if I want to be a dictator. But this will not block my team mates from uploading new cookbooks to chef-server, since they will have their own pem/pub key
[2014-06-02 07:17:17 -0400] winn: dependes on your CI env, no? How you upload cookbooks can vary dramaticly. Most go through some kind of validation.
[2014-06-02 07:17:36 -0400] winn: git/gerrit... blah
[2014-06-02 07:18:25 -0400] chernjie: okay got it. Thanks winn and coderanger
[2014-06-02 09:51:46 -0400] marius: hi, how to remove auto attributes from the node?
[2014-06-02 09:57:29 -0400] mjuszczak: I may be completely wrong here, but based on this file: https://github.com/opscode-cookbooks/openldap/blob/master/templates/default/default_slapd.erb -- it looks like the online configuration the cookbook generates is never actually used?  It generates a slapd.conf and converts it to OLC but never actually points to the OLC...
[2014-06-02 10:16:24 -0400] jonlives: marius: can you elaborate a little on what you want to remove?
[2014-06-02 10:18:40 -0400] marius: jonlives: in my case, I have nginx cookbook and I wanted to install nginx+passenger with it (and it works), but after removing this cookbook from node I can still see attributes set by this cookbook
[2014-06-02 10:32:02 -0400] marius: jonlives: and I mean "default" attributes not "auto", just checked with "knife node show xxx -l -F json"
[2014-06-02 10:32:44 -0400] jonlives: marius: ah - once set, those stay there - you'd have to manually remove them.
[2014-06-02 10:33:01 -0400] jonlives: attributes aren't automatically cleaned up when you remove the cookbook which set them
[2014-06-02 10:35:11 -0400] marius: jonlives: and how to remove, let's say, specific "branch" of attributes? Or is it safe to remove all default attributes very early?
[2014-06-02 10:36:33 -0400] jonlives: marius: a quick google reveals https://github.com/amian84/knife-del-attribute, which might work
[2014-06-02 10:37:19 -0400] marius: ah nice, I'll try this
[2014-06-02 10:37:22 -0400] marius: jonlives: thanks
[2014-06-02 10:46:45 -0400] ghghz: Hey, if I set tag using knife tag create srv1 free it's OK, but only if I don't run knife ssh ... srv 'something'
[2014-06-02 10:46:50 -0400] ghghz: After knife ssh tag disappears
[2014-06-02 10:47:49 -0400] matti: ghghz: That does look bit fishy.
[2014-06-02 10:48:25 -0400] ghghz: who clears that tag? :)
[2014-06-02 10:50:45 -0400] matti: ghghz: Not sure, but I would not see reason for ssh to do it ;s Unless there is something I am not aware of ;]
[2014-06-02 10:51:26 -0400] matti: ghghz: They should be available there - can you try something else that uses tags and its not ssh (unless you did it already).
[2014-06-02 11:02:01 -0400] gyre007: anyone here uses AWS cookbook ? in particular S3_file resrouce
[2014-06-02 11:02:05 -0400] gyre007: *resource
[2014-06-02 11:02:16 -0400] gyre007: im curious about how to actually use it
[2014-06-02 11:02:27 -0400] gyre007: looks like it requires bucket name and path in the bucket
[2014-06-02 11:02:40 -0400] gyre007: but there doesnt seem to be any option about region ?
[2014-06-02 11:02:58 -0400] gyre007: https://github.com/opscode-cookbooks/aws#aws_s3_file
[2014-06-02 11:12:39 -0400] ghghz: matti: tag resets after running chef-client
[2014-06-02 11:12:47 -0400] ghghz: using knife ssh '' from chef-server
[2014-06-02 11:12:57 -0400] ghghz: seems it overrides somewhere
[2014-06-02 11:15:04 -0400] marius: jonlives: http://p.nkts.lt/c50c216e-5e8b-490b-b3b6-3f8fcdbb44d4.txt
[2014-06-02 11:16:50 -0400] ghghz: matti: http://p.defau.lt/?QWgKQjye23tni2SCord6jQ
[2014-06-02 11:16:54 -0400] ghghz: for instance..
[2014-06-02 11:20:22 -0400] ghghz: matti: found it
[2014-06-02 11:20:29 -0400] ghghz: need to edit using node edit ..
[2014-06-02 11:20:41 -0400] marius: ghghz: do you have specific code to untag your server?
[2014-06-02 11:20:58 -0400] ghghz: marius: nop
[2014-06-02 12:13:48 -0400] whiteadam: Anyone wearing anything sexy?
[2014-06-02 12:17:01 -0400] whiteadam: I find that hard to believe.
[2014-06-02 12:58:38 -0400] whiteadam: Anyone know if knife ec2 has a command to turn instances on and off?
[2014-06-02 13:00:26 -0400] matti: whiteadam: As "power down"?
[2014-06-02 13:00:49 -0400] matti: whiteadam: Then, no.
[2014-06-02 13:00:52 -0400] whiteadam: matti: Is that a thing? I was looking through the help and didn't see anything
[2014-06-02 13:00:58 -0400] whiteadam: matti: damnit, console it is
[2014-06-02 13:01:48 -0400] matti: whiteadam: Or AMI tools, etc.
[2014-06-02 13:02:00 -0400] matti: whiteadam: It should trigger ACPI shutdown, hopefully.
[2014-06-02 13:02:01 -0400] matti: ;]
[2014-06-02 13:02:11 -0400] whiteadam: ooh, good plan
[2014-06-02 13:02:31 -0400] matti: Make sure you don't have destory on power off feature set ;]
[2014-06-02 13:02:40 -0400] matti: You'll get "doh" moment ;s
[2014-06-02 13:03:13 -0400] whiteadam: hah, no, I made sure to not do that first. I've definitely made that mistake before
[2014-06-02 13:03:22 -0400] matti: :)
[2014-06-02 13:03:22 -0400] matti: Haha
[2014-06-02 13:03:25 -0400] matti: You are not alone!
[2014-06-02 13:10:43 -0400] r3dk1ng: You are [not] alone ~evangelion 1.11  (lolz)
[2014-06-02 13:12:59 -0400] matti: r3dk1ng: ;D
[2014-06-02 13:13:18 -0400] matti: r3dk1ng: But I hope we will be able to advance ;p *wink* *wink*
[2014-06-02 13:13:18 -0400] matti: ;p
[2014-06-02 13:13:24 -0400] r3dk1ng: hahah
[2014-06-02 13:13:47 -0400] matti: :)
[2014-06-02 13:13:52 -0400] matti: <3 Anime
[2014-06-02 13:13:58 -0400] r3dk1ng: indeed
[2014-06-02 13:14:19 -0400] jbz: .radio.free.marzzzzzzzz
[2014-06-02 13:14:25 -0400] r3dk1ng: <-macross fan for life
[2014-06-02 13:14:57 -0400] matti: :)
[2014-06-02 13:16:20 -0400] matti: Oh boy.
[2014-06-02 13:16:35 -0400] matti: You reminded me how behind I am with some new series ;s
[2014-06-02 13:22:22 -0400] vissree: Hi, I need to do a selective loading of attribute file based on the hostname
[2014-06-02 13:22:52 -0400] vissree: what I'm doing now is to have a set of <hostname>.rb files under my cookbook/attributes folder
[2014-06-02 13:23:08 -0400] vissree: in cookbook/attributes/default.rb I have only one line
[2014-06-02 13:23:23 -0400] vissree: include_attribute #{hostname}.rb
[2014-06-02 13:23:43 -0400] matti: vissree: You could do that with simple if statement.
[2014-06-02 13:23:43 -0400] vissree: I'm fetching the hostname of the node and assigning it to the variable hostname
[2014-06-02 13:24:24 -0400] vissree: but the problem is that it loads all .rb under cookbook/attribute folder
[2014-06-02 13:24:36 -0400] matti: vissree: Indeed.
[2014-06-02 13:25:03 -0400] matti: vissree: KISS solution -> if statement on Ohai data and set/define attribute you need.
[2014-06-02 13:25:18 -0400] matti: vissree: Unless there is something complex you need.
[2014-06-02 13:25:39 -0400] vissree: yes, I've "too many" variables in the attribute file :)
[2014-06-02 13:25:49 -0400] CPS: vissree: try include_attribute "cookbook::#{hostname}"
[2014-06-02 13:26:03 -0400] CPS: the name of the cookbook
[2014-06-02 13:26:08 -0400] vissree: CPS: I'm doing that only
[2014-06-02 13:26:35 -0400] vissree: but, somehow it loads all the files inside the attribute folder
[2014-06-02 13:26:45 -0400] CPS: you are specifying the cookbook?
[2014-06-02 13:26:49 -0400] vissree: yes
[2014-06-02 13:27:09 -0400] vissree: cookbook1/attributes/default.rb has
[2014-06-02 13:27:26 -0400] vissree: include_attribute cookbook2::<hostname>
[2014-06-02 13:27:37 -0400] vissree: *#{hostname}
[2014-06-02 13:28:49 -0400] vissree: for the first host with only one file inside cookbook2/attributes/ work
[2014-06-02 13:29:26 -0400] vissree: when I add one more file inside cookbook2/attribute/ it's still loading the values from the old attribute file
[2014-06-02 13:29:49 -0400] vissree: I am not sure if it's loading all the files or is it caching the values somewhere
[2014-06-02 13:30:42 -0400] vissree: CPS: matti any guesses?
[2014-06-02 13:31:35 -0400] CPS: no, i don't have much experience with attribute files
[2014-06-02 13:31:55 -0400] CPS: what are you doing with them? any reason you have them explicit for every hostname instead of programmatic?
[2014-06-02 13:33:01 -0400] matti: vissree: IIRC, it will load all the .rb files :)
[2014-06-02 13:33:16 -0400] matti: vissree: That's why I recommended if-statement approach to make the scope local ;p
[2014-06-02 13:33:35 -0400] CPS: matti: per the docs, there should be a way to load a specific attr file
[2014-06-02 13:33:48 -0400] matti: CPS: Indeed, saw that too.
[2014-06-02 13:33:50 -0400] CPS: but he's doing that so i dunno
[2014-06-02 13:33:53 -0400] matti: CPS: I never used it that way.
[2014-06-02 13:33:58 -0400] matti: CPS: Not sure why it does not work ;s
[2014-06-02 13:34:19 -0400] matti: Unless this bug is a feature ;p
[2014-06-02 13:34:28 -0400] CPS: very possible
[2014-06-02 13:34:34 -0400] vissree: matti: so better do it the ruby way ;)
[2014-06-02 13:34:42 -0400] vissree: CPS: matti thanks guys!
[2014-06-02 13:35:02 -0400] matti: vissree: I will test this in a few moment - need to finish something before ;]
[2014-06-02 13:35:06 -0400] matti: vissree: I am curious now ;]
[2014-06-02 13:35:13 -0400] vissree: sure, thanks!
[2014-06-02 13:35:24 -0400] vissree: I'm using knife solo - FYI
[2014-06-02 13:35:31 -0400] matti: No worries.
[2014-06-02 13:35:42 -0400] vissree: and I'm not sure if it's doing some sort of caching.
[2014-06-02 13:35:55 -0400] vissree: Will keep and eye here, in case you find something.
[2014-06-02 13:36:19 -0400] CPS: chef does cache things
[2014-06-02 13:36:27 -0400] CPS: i think it's /etc/chef/cache in linux
[2014-06-02 13:36:49 -0400] wm3|away: CPS: /var/chef/cache
[2014-06-02 13:36:55 -0400] matti: /var/chef/cache
[2014-06-02 13:36:57 -0400] matti: Oh.
[2014-06-02 13:36:57 -0400] matti: ;]
[2014-06-02 13:37:07 -0400] workmad3: CPS: at least, all the nodes I use have it in /var (omnibus installed chef :) )
[2014-06-02 13:37:19 -0400] workmad3: CPS: I think you can set the path in /etc/chef/client.rb though
[2014-06-02 13:37:24 -0400] CPS: you can just delete that if you're worried the cache is messing something up
[2014-06-02 13:37:36 -0400] matti: Ohai workmad3
[2014-06-02 13:37:46 -0400] workmad3: matti: o/
[2014-06-02 13:38:27 -0400] vissree: or is it possible to tell chef not to cache the attributes?
[2014-06-02 13:38:29 -0400] vissree: :P
[2014-06-02 13:40:08 -0400] CPS: i've seen some weirdness with attribute files where removing a declaration from the file doesn't remove the attribute from the node
[2014-06-02 13:40:16 -0400] CPS: welp he's gone
[2014-06-02 13:41:44 -0400] CPS: vissree: i've seen some weirdness with attribute files where removing a declaration from the file doesn't remove the attribute from the node
[2014-06-02 13:41:59 -0400] CPS: if that's the behavior you're seeing it's expected
[2014-06-02 13:42:02 -0400] workmad3: CPS: I'm not sure that's 'weirdness'... if the attribute is already on the node, that's loaded again from the server next run
[2014-06-02 13:42:18 -0400] workmad3: CPS: regardless of if the attribute is re-declared in a file
[2014-06-02 13:42:20 -0400] vissree: but I only have one include_attribute line
[2014-06-02 13:42:40 -0400] vissree: and all my attribute files have the same set of variables
[2014-06-02 13:42:54 -0400] vissree: so what I'm trying to do is to set the value for the variable according to the hostname
[2014-06-02 13:43:10 -0400] CPS: can you re-write it so you don't have a dozen or a hundred files?
[2014-06-02 13:43:28 -0400] CPS: parse the hostname to set things or whatever
[2014-06-02 13:43:41 -0400] vissree: I have a weird use case :(
[2014-06-02 13:44:59 -0400] CPS: equally hacky: put all the content in one file with if hostname == "host1" etc
[2014-06-02 13:45:26 -0400] vissree: CPS, that's better :)
[2014-06-02 13:45:44 -0400] vissree: every time I have a new host, add a new condition in the same attribute file rather than creating a new file
[2014-06-02 13:47:03 -0400] vissree: CPS, thanks friend - that should help me for now. :)
[2014-06-02 13:47:08 -0400] CPS: np
[2014-06-02 13:50:16 -0400] rootcho: hi all, is it possible to include in a node variables, something like this #{node[:server][:service][:'${_variable1}']} ?
[2014-06-02 13:51:29 -0400] CPS: probablyu
[2014-06-02 13:51:47 -0400] CPS: you might need to do to_sym
[2014-06-02 13:52:57 -0400] CPS: i don't know if :'#{variable}' parses
[2014-06-02 13:53:46 -0400] rootcho: will try thanks
[2014-06-02 14:47:44 -0400] stormerider: can you email in attachments (ie, log files) to Chef support tickets?
[2014-06-02 14:49:26 -0400] stormerider: rootcho: i would expect it would either be :#{variable} or '#{variable}', not a mix of the two
[2014-06-02 14:57:19 -0400] rootcho: thanks stormerider, will try that too
[2014-06-02 15:14:50 -0400] jtimberman: node attributes can be expressed as either symbols, node[:hostname] or strings, node['hostname'] because the underlying data is a hash with indifferent access.
[2014-06-02 15:15:39 -0400] jtimberman: for the above, presuming that _variable1 is set somewhere in a recipe, #{node[:server][:service][_variable1]} will be fine.
[2014-06-02 15:16:15 -0400] jtimberman: under the covers on a chef server, the node attributes are stored as strings because it's converted to JSON.
[2014-06-02 15:16:22 -0400] rootcho: what if i set this variable in a script for example ?
[2014-06-02 15:16:46 -0400] rootcho: and i want to include it to bould the actual correct node path
[2014-06-02 15:18:03 -0400] rootcho: build*
[2014-06-02 15:19:49 -0400] mlb-: So I've just got a opensource chef server running and added my first recipe, a role which specifies this recipe, and knife bootstrap'd a vm to this role. After making an update to the recipe, bumping its version, and uploading it to the server, what else do I need to do so the VM uses the new version when I have it run "chef-client"?
[2014-06-02 15:20:43 -0400] mlb-: My google-fu fails me, and documentation is difficult to understand with so many references to varying setups/versions of chef :(
[2014-06-02 15:23:43 -0400] r3dk1ng: chef-client should have implimented your changes, did you also make your version changes to the metadata.rb of the cookbook?
[2014-06-02 15:24:14 -0400] mikesplain: Unless in your role or your environment you specify the version it should use the latest version each time you rerun chef-client
[2014-06-02 15:25:18 -0400] mlb-: r3dk1ng: Indeed I did. mikesplain: I've not touched environments yet and have not hard coded any versions.
[2014-06-02 15:26:39 -0400] r3dk1ng: mlb~ so are you concerned that the version isn't right?  I guess, what's your actual concern here?
[2014-06-02 15:26:56 -0400] mikesplain: @mlb-: Hmm yeah then you should be all set. I would do a knife cookbook show <cookbook name> to make sure the new version is available
[2014-06-02 15:34:44 -0400] mlb-: mikesplain: both CLI and web interface show a new version is present.
[2014-06-02 15:35:52 -0400] mlb-: r3dk1ng: Exactly. I'm concerned the VM running chef-client will not use the newest version of the recipe available on the server.
[2014-06-02 15:36:45 -0400] r3dk1ng: How are you verifying the version?
[2014-06-02 15:36:56 -0400] gauravarora: hello chef newbie here with some q's :)
[2014-06-02 15:37:15 -0400] gauravarora: i'm trying to install tomcat and I see that I also need java so I understand that I can specify this in the run list
[2014-06-02 15:38:05 -0400] gauravarora: i upload the tomcat cookbook to chef server but it also accepts a tomcat version attribute, where do i define this attribute?
[2014-06-02 15:38:16 -0400] mlb-: r3dk1ng: by the method mikesplain has mentioned, as well as visiting the cookbooks page on the cef-server.
[2014-06-02 15:38:33 -0400] mlb-: s/cef/chef/
[2014-06-02 15:39:02 -0400] cap10morgan: Has anyone put this into a Chef cookbook / role? http://docs.aws.amazon.com/AmazonVPC/latest/UserGuide/VPC_NAT_Instance.html
[2014-06-02 15:39:37 -0400] r3dk1ng: mlb~: odd, should have shown up then...
[2014-06-02 15:39:48 -0400] r3dk1ng: have you tried running chef-clinet in debug mode?
[2014-06-02 15:39:56 -0400] r3dk1ng: chef-client --log_level debug
[2014-06-02 15:40:24 -0400] mlb-: not yet. Will try and report back. Is there anything in particular I ought to pay attention for?
[2014-06-02 15:50:49 -0400] take_it_t: is there a good way of testing cookbooks using chef-client without having to upload them to the server?
[2014-06-02 15:51:19 -0400] mikesplain: take_it_t: Like Test Kitchen?
[2014-06-02 15:51:30 -0400] mikesplain: http://kitchen.ci/
[2014-06-02 15:51:59 -0400] jonlives: take_it_t: local mode too :) http://www.getchef.com/blog/2013/10/31/chef-client-z-from-zero-to-chef-in-8-5-seconds/
[2014-06-02 15:52:31 -0400] mikesplain: ^ agreed!
[2014-06-02 15:54:00 -0400] take_it_t: ill see if local mode works for me
[2014-06-02 15:56:11 -0400] Glenjamin: Hi guys, i've deleted a minitest from my cookbook, but it still seems to be running - does anyone know where i should look to find out how to delete it?
[2014-06-02 15:57:52 -0400] take_it_t: so far finding it easiest to test cookbooks with vagrant as i develop my application by just using vagrant provision
[2014-06-02 15:58:07 -0400] take_it_t: but having a bit of a hard time figuring out how to transition that workflow to using a chef server
[2014-06-02 16:02:07 -0400] mikesplain: Probably should just do a  berks upload then run the client on a node... but if you're developing, keep in mind, berks upload only uploads versions of cookbooks not on the chef-server. So either bump the version or berks upload --force
[2014-06-02 16:08:03 -0400] mattsmith: Afternoon All, I'm getting the following message when trying to pull down the ruby_build cookbook with berkshelf "Unable to satisfy constraints on package ruby_buld, which does not exist, due to solution constraint (my-cookbook= 0.1.0). Solution constraints that may result in a constraint on ruby_buld" any ideas why this is?
[2014-06-02 16:08:20 -0400] mattsmith: I've been able to use other cookbooks in this way
[2014-06-02 16:09:42 -0400] mlb-: r3dk1ng: I see a POST to https://chef-server//environments/_default/cookbook_versions, wherein the payload response, I see the version for my recipe set to the earlier, and "frozen?" set to true.
[2014-06-02 16:21:35 -0400] gauravarora: i have a role file which has override['tomcat']['base_version'] = 7 but chef client always installs tomcat 6
[2014-06-02 16:23:11 -0400] mikesplain: gauravarora: I ran into that too, have a look at the the platform config in the tomcat cookbook: https://github.com/opscode-cookbooks/tomcat/blob/master/attributes/default.rb#L63
[2014-06-02 16:23:31 -0400] mikesplain: I had to add those as override as well so it grabbed the version I overwrote
[2014-06-02 16:24:28 -0400] gauravarora: mikesplain: thanks, any chance you have an example i can look at? i just started with chef today :)
[2014-06-02 16:25:41 -0400] helllen: helllo
[2014-06-02 16:25:56 -0400] helllen: I would like to modify the chef-client interval on the cookbook
[2014-06-02 16:25:59 -0400] helllen: it is possible ?
[2014-06-02 16:26:02 -0400] mikesplain: gauravarora: take a look at https://gist.github.com/mikesplain/ccbf10e44c8976b988e5
[2014-06-02 16:26:24 -0400] mikesplain: I have that in a wrapper cookbook and it fixed the issue you're talking about
[2014-06-02 16:26:41 -0400] helllen: I t was in 11.4 version but on new chef-client version It doesnt wokr
[2014-06-02 16:26:42 -0400] mikesplain: (there might be a better way of fixing it but that's what worked for me)
[2014-06-02 16:26:58 -0400] gauravarora: mikesplain: thanks
[2014-06-02 16:27:14 -0400] mikesplain: gauravarora: np
[2014-06-02 16:27:17 -0400] gauravarora: mikesplain: just noticed the last line has an error, -Xms is not set
[2014-06-02 16:27:40 -0400] mikesplain: gauravarora: ahh yeah good eye, copy and paste error
[2014-06-02 16:28:08 -0400] gauravarora: you have this in your attributes/default.rb of the wrapper cookbook right?
[2014-06-02 16:28:52 -0400] mikesplain: Basically just have to force chef to recreate those attributes in order to redo the string interpolation
[2014-06-02 16:28:55 -0400] mikesplain: Correct
[2014-06-02 16:29:14 -0400] gauravarora: ok, i just got started with chef, still trying to understand wrapper cookbooks
[2014-06-02 16:29:26 -0400] gauravarora: i just did this via a role but i realise thats not the right ay now
[2014-06-02 16:29:52 -0400] mikesplain: They're quite valuable... yeah you can do it in a role but using a wrapper cookbook lets you test locally more easily with test kitchen and whatnot
[2014-06-02 16:30:16 -0400] mikesplain: helllen: isn't there an attribute you can override in the chef-client cookbook?
[2014-06-02 16:30:24 -0400] mikesplain: helllen: https://github.com/opscode-cookbooks/chef-client/blob/master/attributes/default.rb#L40
[2014-06-02 16:33:30 -0400] helllen: thanks mikesplain
[2014-06-02 16:33:36 -0400] mikesplain: helllen: np!
[2014-06-02 16:33:59 -0400] mikesplain: You can also just adjust that by hand when you run it as a daemon
[2014-06-02 16:34:33 -0400] helllen: does it work with new gem ?
[2014-06-02 16:34:44 -0400] helllen: because I think I use this method
[2014-06-02 16:34:52 -0400] gauravarora: mikesplain: i'm probably asking too much but is there a wrapper cookbook that you are aware of that i can learn from?
[2014-06-02 16:34:53 -0400] helllen: reload_client_config ruby block
[2014-06-02 16:35:39 -0400] tbenz9: Anyone know of a cookbook to run SQL commands on Windows?
[2014-06-02 16:37:26 -0400] mikesplain: gauravarora: Not public ones that I can think of but you can start here: http://www.getchef.com/blog/2013/12/03/doing-wrapper-cookbooks-right/
[2014-06-02 16:37:41 -0400] gauravarora: ok thx
[2014-06-02 16:37:45 -0400] mikesplain: np
[2014-06-02 16:38:35 -0400] Majost: Good idea, or bad idea: Creating a test-kitchen driver which depends on another test-kitchen driver to function.
[2014-06-02 16:39:38 -0400] wjimenez5271: Berkshelf question: 'source' in the berkshelf file, that is akin to my local chef server? Or is that something different?
[2014-06-02 16:39:54 -0400] Majost: At the ruby level, it makes a lot of sense to me -- just not sure if the dependent driver thing is frowned upon.
[2014-06-02 16:41:08 -0400] workmad3: wjimenez5271: if you're on berkshelf 3, then the source is a berkshelf-api URL to use for dependency resolution
[2014-06-02 16:41:50 -0400] wjimenez5271: workmad3: thanks, what if I want berkshelf to lookup cookbooks that are only on my local chef server, how does it find those?
[2014-06-02 16:42:25 -0400] workmad3: wjimenez5271: the way I achieve that is to run a local berkshelf-api instance that indexes opscode and my own chef server
[2014-06-02 16:42:42 -0400] workmad3: wjimenez5271: then I point my berkshelf source lines to that API instance
[2014-06-02 16:42:49 -0400] wjimenez5271: workmad3: ah I see. how would I do that?
[2014-06-02 16:43:21 -0400] workmad3: wjimenez5271: https://github.com/berkshelf/berkshelf-api
[2014-06-02 16:43:57 -0400] wjimenez5271: golden, thanks
[2014-06-02 16:45:07 -0400] wjimenez5271: followup question, is there a simpler method for dealing with local cookbook dependencies? Is it possible I am 'doing it wrong' by using berkshelf for this?
[2014-06-02 16:47:56 -0400] workmad3: wjimenez5271: no, it's the sort of thing berkshelf is intended for... and if you only have a single level of dependency (so you have custom cookbooks that only depend on community site cookbooks or nothing) then berkshelf is really easy
[2014-06-02 16:48:26 -0400] workmad3: wjimenez5271: it's just when you have dependencies on more custom cookbooks that berkshelf is still figuring out a good way to get there
[2014-06-02 16:48:54 -0400] wjimenez5271: Makes sense
[2014-06-02 17:32:21 -0400] kbarry: I want to both disable and then re-enable selinux in a recipe. I have the selinux cookbook. I assume the first step will be to put a "depends selinux" int he metadata file for my cookbook.
[2014-06-02 17:33:02 -0400] kbarry: I have the impression I might have seen what looked like this being done, where a resource of a recipe was being used in another recipe?
[2014-06-02 17:50:25 -0400] rjbs-: I just found that we have a node with platform==omnios, which is not handled in the group::usermod provider.  I'll provide a PR, if somebody can confirm that the person who set platform to "omnios" wasnt on drugs. :)
[2014-06-02 17:58:03 -0400] therealtimsmith: anyone at Chef know when we can expect 11.14 to ship
[2014-06-02 17:58:09 -0400] therealtimsmith: to resolve the windows remote file issues
[2014-06-02 18:01:14 -0400] jreslock: Where can I look to find maintenance or troubleshooting info for open source chef server?
[2014-06-02 18:23:59 -0400] gauravarora: hmm my chef-client reports that the tomcat cookbook is not found but i can see that it downloaded it
[2014-06-02 18:24:19 -0400] double_p: .oO( the tomcat cookbook is meh )
[2014-06-02 18:25:00 -0400] gauravarora: vagrant@precise32:/var/chef$ ls cache/cookbooks/
[2014-06-02 18:25:00 -0400] gauravarora: java  openssl  tomcat  tomcat-custom
[2014-06-02 18:25:05 -0400] gauravarora: i dont think its the cookbook
[2014-06-02 18:25:18 -0400] gauravarora: is there a cookbook index of some kind on the chef-client?
[2014-06-02 18:27:44 -0400] mikesplain: How are you trying to run it, from a wrapper cookbook or something?
[2014-06-02 18:29:27 -0400] krench: Hi all :), anyone know how to use node in ruby_block? (not sure if question is valid im new in chef..)
[2014-06-02 18:30:18 -0400] gauravarora: mikesplain: yes
[2014-06-02 18:30:36 -0400] mikesplain: Make sure you include a depends in the metadata.rb
[2014-06-02 18:30:43 -0400] gauravarora: so i have a tomcat-custom cookbook that has depends in the metadata.rb
[2014-06-02 18:30:51 -0400] gauravarora: you type much faster than me :P
[2014-06-02 18:30:56 -0400] mikesplain: haha :)
[2014-06-02 18:31:12 -0400] gauravarora: the same cookbook ran fine on a centos system before i realized theres no tomcat7 on centos
[2014-06-02 18:31:19 -0400] mikesplain: Hmm
[2014-06-02 18:31:20 -0400] gauravarora: so i switched to a vagrant ubuntu image
[2014-06-02 18:31:40 -0400] gauravarora: the only problem was that the image had chef 10.x.x so i upgraded it
[2014-06-02 18:31:48 -0400] gauravarora: maybe its because of that?
[2014-06-02 18:31:56 -0400] gauravarora: now i'm on the latets version
[2014-06-02 18:33:04 -0400] mikesplain: Yeah that's possible, avoid chef 10 unless you're coming from a chef 10 env
[2014-06-02 18:33:14 -0400] gauravarora: ok, i will make a new box
[2014-06-02 18:54:36 -0400] AskSteve: How can I tell what the server name is to notifes :reload on a system?
[2014-06-02 19:01:11 -0400] krench: Is it ok to use nodes in ruby_block?
[2014-06-02 19:18:45 -0400] CPS: krench: should be, yes
[2014-06-02 19:21:44 -0400] krench: cps: thanks
[2014-06-02 19:26:59 -0400] krench: im using ... users = node[:users].dup
[2014-06-02 19:27:00 -0400] krench: users <<  'root' , inside a ruby_block ... i get an error undefined method << , any ideas on this?
[2014-06-02 19:45:11 -0400] daxroc: Is it acceptable for a lwrp to set attribute data ? I'm thinking interfacing with an external library should only be done with an 'hwrp' not an lwrp,
[2014-06-02 19:58:39 -0400] someara: daxroc lwrp vs hwrp only refers to the style in which the resource is written... lwrp gives you some syntactic sugar (and gets in your way a bit)
[2014-06-02 20:00:08 -0400] daxroc: someara: What would the most appropriate way to pass information back to a recipe or resource used later ?
[2014-06-02 20:00:27 -0400] someara: example?
[2014-06-02 20:02:04 -0400] daxroc: Say in an lwrp I used a custom tool to get data from the system. I would have thought it's more appropiate to trigger ohai to reload and read this data after executing the custom tool ?
[2014-06-02 20:02:36 -0400] daxroc: But that seems a little convoluted
[2014-06-02 20:03:18 -0400] someara: can you be a little more specific?
[2014-06-02 20:04:05 -0400] davidordave: @daxroc, keep the compile versus converge phases in mind. If you set a variable inside a resource it won't be available when the other resources get compiled.
[2014-06-02 20:04:12 -0400] someara: in general, you want to pass parameters to resources, then they converge the system to the state you want... having them hold data to be referenced later isn't really the model
[2014-06-02 20:06:52 -0400] someara: so, in a recipe, you could shell_out!("your_tool"), get what you need, then pass that data as arguments to resources as parameters
[2014-06-02 20:06:57 -0400] someara: you could do that in a provider too
[2014-06-02 20:08:31 -0400] daxroc: And you shouldn't need to pass information around to other resources outside the resource or provider.
[2014-06-02 20:09:10 -0400] someara: resources can "see" each other (within a run_context), to observe each others behavior and take action (notifies, subscribes), but you don't really want them querying each other for data if you can help it
[2014-06-02 20:09:27 -0400] someara: don't think "object oriented programming" think "resource collection oriented programming"
[2014-06-02 20:09:36 -0400] daxroc: I'm thinking in the context of an lwrp generating/requesting an ssl certificate and providing the details to a later resource
[2014-06-02 20:10:29 -0400] someara: you can always stash data on the node object as a kind of global variable space
[2014-06-02 20:10:47 -0400] someara: but abuse that at your own peril ;)
[2014-06-02 20:10:53 -0400] daxroc: Would that not be considered a 'smell'
[2014-06-02 20:11:20 -0400] someara: thats what its there for
[2014-06-02 20:12:14 -0400] daxroc: So in my custom_resource pass a resource name to notify seems like a good use
[2014-06-02 20:12:17 -0400] someara: I've done some fairly abusive things in the past
[2014-06-02 20:12:18 -0400] someara: https://github.com/someara/pki-cookbook/blob/master/providers/servercert.rb#L44-L51
[2014-06-02 20:13:25 -0400] someara: there's also node.run_state
[2014-06-02 20:13:44 -0400] jmickle: someara: always nice to enter the room and hear about your chef abuse :-P
[2014-06-02 20:14:03 -0400] someara: I can quit any time I want
[2014-06-02 20:14:06 -0400] jmickle: hahahahaha
[2014-06-02 20:14:08 -0400] jmickle: only kidding
[2014-06-02 20:14:10 -0400] jmickle: how are you
[2014-06-02 20:15:20 -0400] someara: pretty good. trying to reconcile this weather with by being in front of a laptop
[2014-06-02 20:15:29 -0400] someara: s/by/my/
[2014-06-02 20:15:30 -0400] jmickle: weather?
[2014-06-02 20:15:43 -0400] someara: its goregous in nyc right now
[2014-06-02 20:15:55 -0400] jmickle: ah
[2014-06-02 20:47:10 -0400] sauraus: Anyone with experience using the 'users' cookbook here?
[2014-06-02 20:58:53 -0400] kbarry: using the "file" resource, i'd like to add 2 lines of content
[2014-06-02 20:59:08 -0400] kbarry: file "/tmp/dir/file" do
[2014-06-02 20:59:20 -0400] kbarry: content "lineone
[2014-06-02 20:59:23 -0400] kbarry: linetwo"
[2014-06-02 20:59:25 -0400] kbarry: end
[2014-06-02 21:04:46 -0400] josephholsten: ugh, I hate the raw encrypted databag workflow
[2014-06-02 21:05:37 -0400] mikesplain: josephholsten: try chef-vault?
[2014-06-02 21:05:39 -0400] josephholsten: have to have the key configured to push encrypted bags & bootstrap nodes, must not have it configured to push non-encrypted bags
[2014-06-02 21:05:47 -0400] jordan_: hi chefs. i'm stumped on a problem with aws opsworks that maybe someone here has also dealt with. i try to spin up a new instance using a a custom AMI and it hangs on booting... when i ssh in and look at the log, the last line shows an error: "There are problems and -y was used without --force-yes" referencing an apt-get install. the whole log output is here https://gist.github.com/dustMason/96169269826e86336e04
[2014-06-02 21:06:32 -0400] jordan_: im confused because this seems to happen during the opsworks init step
[2014-06-02 21:06:52 -0400] josephholsten: mikesplain: looks like vault requires a node to exist before it can be granted access to the secret. am I just misreading it?
[2014-06-02 21:08:31 -0400] mikesplain: josephholsten: kind of, you set a field for search, any node matching that search has access... but I think you have to run a command that rehashes your data for the new nodes key
[2014-06-02 21:08:43 -0400] mikesplain: Haven't dealt with that yet, but I like the workflow better at least
[2014-06-02 21:08:53 -0400] josephholsten: it does seem better
[2014-06-02 21:09:41 -0400] josephholsten: I do need to play with @coderanger's https://github.com/poise/citadel
[2014-06-02 21:10:03 -0400] mikesplain: oh nice
[2014-06-02 21:10:17 -0400] mdpatrick: howdy
[2014-06-02 21:10:19 -0400] josephholsten: jordan_: I'm sorry, I know nothing of opswork's cookbooks
[2014-06-02 21:10:33 -0400] mikesplain: jordan_: same here :(
[2014-06-02 21:10:42 -0400] mdpatrick: If I run chef-client, does it automatically fetch the latest cookbook in the runlist from the server?
[2014-06-02 21:10:50 -0400] jordan_: damn, thanks for reading my woes though
[2014-06-02 21:14:45 -0400] josephholsten: mdpatrick: yes, in theory
[2014-06-02 21:15:21 -0400] mdpatrick: thank you
[2014-06-02 21:15:21 -0400] josephholsten: in practice, sometimes things get weird if the version number of the cb is the same
[2014-06-02 21:17:16 -0400] josephholsten: I forget, does mainline chef support lazy evaluation of lwrp defaults (like poise?)
[2014-06-02 21:17:41 -0400] phil_s_stein: I'm using the remote_file resource with the :create_if_missing action. The file is not created on the node. If I do 'r = remote_file x do { }; r.run_action(:create)' It works. Any idea why? Or maybe a good way to debug this?
[2014-06-02 21:18:59 -0400] josephholsten:  chef is running
[2014-06-02 21:19:05 -0400] josephholsten: phil_s_stein: I'd start by running with debug logging, and check which version of
[2014-06-02 21:19:28 -0400] phil_s_stein: Everything else is working though.
[2014-06-02 21:19:35 -0400] josephholsten: um, invert the ordering of those messages. apparently my hands do not guarantee in-order delivery
[2014-06-02 21:19:42 -0400] phil_s_stein: heh
[2014-06-02 21:19:46 -0400] fveillette: question: Can i trigger a ruby_block to run without using a chef resource
[2014-06-02 21:19:46 -0400] phil_s_stein: I understood.
[2014-06-02 21:20:21 -0400] phil_s_stein: I can wget the file. Other recipes are executing without flaw.
[2014-06-02 21:20:44 -0400] josephholsten: fveillette: kinda. phil_s_stein's example of calling the resource.run_action(:create) could be what you mean
[2014-06-02 21:21:12 -0400] josephholsten: phil_s_stein: any chance you've got a non-unique name for the resource?
[2014-06-02 21:21:17 -0400] phil_s_stein: except I'm trying to run a resource.
[2014-06-02 21:21:37 -0400] phil_s_stein: No, I don't think so. It's a full path to what the file will be on the node.
[2014-06-02 21:21:44 -0400] fveillette: i will gite it a try
[2014-06-02 21:21:47 -0400] fveillette: give
[2014-06-02 21:22:27 -0400] phil_s_stein: Yeah it should be unique. I'm logging the to from paths that I'm using in the resource.
[2014-06-02 21:22:34 -0400] phil_s_stein: And they look sane.
[2014-06-02 21:22:37 -0400] josephholsten: fveillette: that should do it if you want evaluation during converge-time. if you want compile-time evaluation, you write the ruby code where you want it to run
[2014-06-02 21:23:09 -0400] fveillette: I just want my code to run at a specific condition
[2014-06-02 21:23:25 -0400] fveillette: so i do a if condition... and if it's true i want the ruby block to be executed
[2014-06-02 21:23:37 -0400] fveillette: but i can notifies it like i can with a chef_resource
[2014-06-02 21:26:31 -0400] fveillette: i try phil stein syntax and not working
[2014-06-02 21:27:37 -0400] george__: hi guys...I have a quick question: in Chef, how can I start a service not as a root, but as a "normal" user?
[2014-06-02 21:28:14 -0400] jbz: george__: you don't do that in Chef, your service's init script does that
[2014-06-02 21:28:44 -0400] jbz: Chef just starts it by executing a standard startup procedure.  What that procedure is depends on the service's install.
[2014-06-02 21:29:01 -0400] george__: thx jbz...I appreciate it
[2014-06-02 21:29:08 -0400] jbz: george__: np
[2014-06-02 21:29:39 -0400] jbz: george__: the places we need to do that, we have the init script drop root and execute the daemon as a user
[2014-06-02 21:29:47 -0400] jbz: chef executes the init script as root.
[2014-06-02 21:30:04 -0400] george__: IC...make sense now
[2014-06-02 21:32:16 -0400] phil_s_stein: Would the remote_file resource take awhile to execute?
[2014-06-02 21:32:32 -0400] phil_s_stein: Or can I depend on the file existing after the resource declaration?
[2014-06-02 21:35:07 -0400] josephholsten: phil_s_stein: in the resource after the declaration, yes
[2014-06-02 21:35:39 -0400] phil_s_stein: ok thanks. Still no idea why my resource is failing to run. debug log doesn't seem to help.
[2014-06-02 21:35:41 -0400] josephholsten: but if you need the file at compile time, you need to trigger it during compile time
[2014-06-02 21:35:55 -0400] phil_s_stein: Ah.
[2014-06-02 21:36:02 -0400] phil_s_stein: ok, that's interesting.
[2014-06-02 21:36:42 -0400] phil_s_stein: Wait, no I don't need it at compile time.
[2014-06-02 21:39:07 -0400] fveillette: i you trigger a resource at compile time?
[2014-06-02 21:39:13 -0400] fveillette: how you *
[2014-06-02 21:40:23 -0400] phil_s_stein: I don't know. I'm trying to just get it to go at excution time.
[2014-06-02 21:41:06 -0400] phil_s_stein: (But I think the r = resource X do ....; r.run_action(...) construct will do it.)
[2014-06-02 21:44:05 -0400] rayrod2030: If I wanted to have the ability to run knife commands from my jumpbox due to having machines in a private subnet that isn't accessible from the public internet what would be the best way to store chef credentials securely on that box.
[2014-06-02 21:50:35 -0400] rpad: I have a few cookbooks for stand alone pieces of an application. However, I'm developing a "dev" role cookbook that include_recipes all of the stand-alone pieces and am running into attribute collision. Should I be namespacing all of my attributes for each piece? or is there a better way of avoiding collisions?
[2014-06-02 21:51:06 -0400] rayrod2030: I just namespace
[2014-06-02 21:53:39 -0400] amjibaly:   I have a very simple Dockerfile I've built locally running in a boot2docker host, and wanted to see what the easiest way to get that running on AWS OpsWorks
[2014-06-02 21:53:46 -0400] josephholsten: aww shoot. is there a way to use DelayedEvaluator's lazy in a lwrp default?
[2014-06-02 21:53:48 -0400] amjibaly: I see there seems to be a a chef project that should help me get started: https://github.com/bflad/chef-docker
[2014-06-02 21:54:06 -0400] amjibaly: But being pretty new to chef (and docker) I'm not sure what my approach should be
[2014-06-02 21:55:16 -0400] josephholsten: @coderanger stupid poise is ruining my ability to write non-poise resources. ;-)
[2014-06-02 22:03:36 -0400] rodolow: if i need to set my php memory limit system-wide (not in the site's .htaccess) where is the best place to set this conf in the chef recipes?
[2014-06-02 22:46:42 -0400] x0nic: Is there a standard was of pulling down a protected file from S3?
[2014-06-02 22:49:14 -0400] shlant: x0nic: http://community.opscode.com/cookbooks/s3_file
[2014-06-02 22:49:26 -0400] shlant: if you're not on AWS
[2014-06-02 22:49:31 -0400] shlant: if so, check out citadel
[2014-06-02 22:50:20 -0400] x0nic: What if I do not know the name of the fille before I grab it? Ala: http://meskyanichi.github.io/backup/v4/
[2014-06-02 22:52:14 -0400] shlant: x0nic: there has to be some logic to the backup naming scheme
[2014-06-02 22:53:47 -0400] x0nic: shlant: There is for sure. It is the date/time of the backup. Problem is, you somehow need to grab the contents of the directory and parse it, to determine the final path.
[2014-06-02 22:56:50 -0400] shlant: x0nic: that's a doozy. Might want to ask coderanger
[2014-06-02 22:57:34 -0400] coderanger: x0nic: Hmm, what would the behavior be?
[2014-06-02 22:57:40 -0400] coderanger: Like "download the latest file"?
[2014-06-02 22:59:13 -0400] x0nic: A typical url would be something like: s3://<bucket>/backups/wordpressdb/2014.05.24.02.54.32/wordpressdb.tar
[2014-06-02 23:00:11 -0400] coderanger: x0nic: Sure, but what do you actually want to do?
[2014-06-02 23:00:13 -0400] x0nic: The one before that could be: s3://<bucket>/backups/wordpressdb/2014.05.23.03.00.02/wordpressdb.tar
[2014-06-02 23:00:35 -0400] x0nic: I just want the latest file, so I can restore my DB
[2014-06-02 23:00:46 -0400] x0nic: how are people typically doing this?
[2014-06-02 23:01:13 -0400] coderanger: x0nic: Okay, so what I would recommend is making an LWRP
[2014-06-02 23:01:36 -0400] coderanger: x0nic: How big are these files?
[2014-06-02 23:01:51 -0400] coderanger: Usually a DB backup is big enough you don't want to buffer it all in memory
[2014-06-02 23:02:06 -0400] x0nic: coderanger: That is kind of the direction I have been going
[2014-06-02 23:02:26 -0400] x0nic: coderanger: Anywhere from 10Meg to 500
[2014-06-02 23:02:49 -0400] coderanger: So yeah, you want to stream it to disk
[2014-06-02 23:04:13 -0400] x0nic: I will probably just use s3cmd, and wrap some ruby around it. I would assume thats what it would do.
[2014-06-02 23:04:53 -0400] x0nic: Awesome, thanks coderanger and shlant. I just wanted to make I was not missing something.
[2014-06-02 23:06:01 -0400] coderanger: x0nic: I would use the aws or fog gems directly
[2014-06-02 23:06:35 -0400] coderanger: x0nic: Are you using IAM roles for the auth?
[2014-06-02 23:06:54 -0400] x0nic: coderanger: Yeah using IAM roles
[2014-06-02 23:07:09 -0400] coderanger: x0nic: Fog might be easier then since it has built-in support for that
[2014-06-02 23:07:12 -0400] coderanger: Docs kind of suck though
[2014-06-02 23:08:04 -0400] x0nic: coderanger: Been trying to get away from fog. It just seems to need so many deps. I suppose I could take a look again.
[2014-06-02 23:08:22 -0400] coderanger: x0nic: ::shrug:: not much more than Chef itself, except excon I guess
[2014-06-02 23:09:08 -0400] x0nic: coderanger: I suppose so. I already have the logic to do it in fog. So that is probably the best way to go
[2014-06-02 23:09:31 -0400] coderanger: x0nic: Just drop that in an LWRP and you are good to go
[2014-06-02 23:09:53 -0400] coderanger: x0nic: Doing the file write in a truly safe way would be hard, so that bit depends on how much you care
[2014-06-02 23:10:57 -0400] coderanger: (ex. writing to a temp file, swapping it into place with the correct perms, all the stuff the file resource does for you)
[2014-06-02 23:11:06 -0400] x0nic: coderanger: What I have, already works good enough for what I need. I guess I am off to write an LWRP. Never made one, but have looked at the source of quite a few.
[2014-06-02 23:11:33 -0400] coderanger: x0nic: Yeah, I figured partial writes probably weren't a huge concern :)
[2014-06-02 23:12:47 -0400] x0nic: coderanger: Ill throw it on the community site and accept patches, incase anyone cares about partial writes.
[2014-06-02 23:13:50 -0400] coderanger: x0nic: Heh, something tells me this will be pretty specific to your use case
[2014-06-02 23:13:55 -0400] coderanger: specifically the file naming convention
[2014-06-02 23:14:25 -0400] x0nic: not really, anyone who is using the backup gem, may want this
[2014-06-02 23:15:28 -0400] coderanger: I've never heard of that :)
