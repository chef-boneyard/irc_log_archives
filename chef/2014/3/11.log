[2014-03-11 00:00:05 -0400] cheeseprocedure: the UI itself, you mean?
[2014-03-11 00:02:16 -0400] flaccid_: yeah the UI is fine i guess, its just if it can do these basic requirements under the hood
[2014-03-11 00:02:35 -0400] flaccid_: maybe if i run into limitations, contact SimplifyOps and see what they say
[2014-03-11 00:03:21 -0400] cheeseprocedure: both the parallelism thing and passing of output has been brought up by the community before, but yeah, i don't know where they sit on the product timeline
[2014-03-11 00:04:45 -0400] flaccid_: cheeseprocedure: i see. so weird because it they are the 2 base features i saw, the simple workflow is obviously something you expect as the core base
[2014-03-11 00:07:27 -0400] shadylog: hey guys. I have a chicken and egg problem. I'm trying to install and use chef-solo automatically on any distro
[2014-03-11 00:07:39 -0400] shadylog: this is going actually pretty well, but ran into a wall with the different cookbook dependencies
[2014-03-11 00:07:45 -0400] shadylog: so I install librarian-chef
[2014-03-11 00:07:46 -0400] shadylog: which works
[2014-03-11 00:08:03 -0400] shadylog: however on some systems it doesn't, because build-essential is not installed :P
[2014-03-11 00:08:10 -0400] shadylog: (ubuntu precise)
[2014-03-11 00:08:28 -0400] flaccid_: shadylog: package, build-essential
[2014-03-11 00:08:43 -0400] shadylog: yeah exactly
[2014-03-11 00:08:47 -0400] shadylog: so I was wondering if this is possible:
[2014-03-11 00:09:12 -0400] shadylog: sudo chef-solo -o build-essential -r http://community.opscode.com/cookbooks/build-essential/versions/1_4_4/downloads
[2014-03-11 00:09:19 -0400] shadylog: look good?
[2014-03-11 00:10:23 -0400] coderanger: shadylog: I'm confused, what are you trying to do?
[2014-03-11 00:10:25 -0400] flaccid_: shadylog: so you are saying that for some reason librarian-chef requires build-essential?
[2014-03-11 00:10:35 -0400] shadylog: flaccid_: yes
[2014-03-11 00:10:45 -0400] shadylog: namely because gem install librarian-chef doesn't work
[2014-03-11 00:10:52 -0400] cheeseprocedure: use chef_gem?
[2014-03-11 00:11:04 -0400] shadylog: this is on a completely vanilla distro
[2014-03-11 00:11:06 -0400] coderanger: shadylog: I think what you want is the ChefDK pacakge
[2014-03-11 00:11:32 -0400] flaccid_: shadylog: funny, the readme doesn't mention that. whats the error, can you pastebin it?
[2014-03-11 00:12:07 -0400] shadylog: flaccid_: sure
[2014-03-11 00:12:11 -0400] shadylog: https://gist.github.com/anonymous/cc8d35e527208fbfd273
[2014-03-11 00:12:30 -0400] shadylog: the gem wants to build some stuff apparently and make is missing
[2014-03-11 00:12:59 -0400] shadylog: coderanger: i googled.. and I got a catering service
[2014-03-11 00:13:33 -0400] coderanger: shadylog: https://github.com/opscode/chef-dk
[2014-03-11 00:13:43 -0400] coderanger: I think you can find alpha packages on omnitruck
[2014-03-11 00:14:42 -0400] coderanger: shadylog: tl;dr is its an omnibus package that includes chef and berkshelf :)
[2014-03-11 00:15:04 -0400] shadylog: coderanger: looking at it, and it seems too heavy weight for my purposes. I'm making a script which installs chef-solo on every distro and runs a few recipes :) not intended to develop for it
[2014-03-11 00:15:10 -0400] flaccid_: shadylog: your solution or coderangers would be fine. you could consider doing it with cloud-init too
[2014-03-11 00:15:22 -0400] coderanger: shadylog: You shouldn't need librarian/berkshelf on the target machines
[2014-03-11 00:15:34 -0400] coderanger: shadylog: Just assemble the cookbooks once on your workstation
[2014-03-11 00:15:55 -0400] shadylog: coderanger: I tried installing nginx.. I had to install not 1 but 7 cookbooks :(
[2014-03-11 00:16:09 -0400] coderanger: shadylog: Yes, thats normal
[2014-03-11 00:16:39 -0400] coderanger: shadylog: You use berkshelf (or librarian, but berks is more common by far) on your workstation to assemble a folder of cookbooks and transfer that to the target node
[2014-03-11 00:16:44 -0400] flaccid_: dep cookbooks are normal. either way librarian-chef or berkshelf to get cookbooks for chef solo
[2014-03-11 00:16:47 -0400] shadylog: coderanger: it felt a bit weird.. because all the cookbooks have excellent cookbook dependency management metadata..
[2014-03-11 00:16:53 -0400] coderanger: shadylog: knife-solo wraps that process for you
[2014-03-11 00:17:08 -0400] flaccid_: the depends metadata works fine, but there is no optional depends mechanism
[2014-03-11 00:17:21 -0400] coderanger: shadylog: Perhaps knife-solo is the piece of this you are missing? :)
[2014-03-11 00:17:30 -0400] shadylog: what's knife-solo lol?
[2014-03-11 00:17:47 -0400] coderanger: The part that integrates dep resolution and cookbook transfer to the target :)
[2014-03-11 00:18:46 -0400] shadylog: hmmmm yes
[2014-03-11 00:18:48 -0400] shadylog: very close
[2014-03-11 00:18:49 -0400] shadylog: :)
[2014-03-11 00:19:19 -0400] shadylog: but I'm making a homogeneous deployment system :) I use jclouds to provision the servers
[2014-03-11 00:19:59 -0400] flaccid_: jclouds loooks interesting
[2014-03-11 00:20:11 -0400] shadylog: but essential what knife-solo is doing is what I am making but for jclouds
[2014-03-11 00:20:14 -0400] shadylog: and in shell script
[2014-03-11 00:20:34 -0400] shadylog: so just really one script that executes chef-solo on whatever machine (most machines)
[2014-03-11 00:20:55 -0400] shadylog: but thanks for the nod!
[2014-03-11 00:21:16 -0400] flaccid_: https://github.com/jclouds/jclouds-examples/tree/master/chef-basics looks interesting
[2014-03-11 00:21:42 -0400] shadylog: yup
[2014-03-11 00:21:47 -0400] shadylog: but its too high level
[2014-03-11 00:21:48 -0400] flaccid_: there is many many ways to run a command on a remote host...
[2014-03-11 00:22:19 -0400] coderanger: shadylog: Right, basically my point is that you should never be running berks/librarian on the target, do all that locally
[2014-03-11 00:22:30 -0400] coderanger: Otherwise you end up with a multi-layer bootstrap
[2014-03-11 00:22:33 -0400] coderanger: and then you've lost the game
[2014-03-11 00:22:49 -0400] shadylog: coderanger: can you elaborate? this is very interesting to me
[2014-03-11 00:22:57 -0400] coderanger: On which part?
[2014-03-11 00:23:12 -0400] shadylog: why is a multi-layer bootstrap not good?
[2014-03-11 00:23:35 -0400] shadylog: why is it a multi-layer bootstrap when installing chef + librarian
[2014-03-11 00:23:44 -0400] shadylog: also btw
[2014-03-11 00:23:45 -0400] shadylog: sudo chef-solo -o build-essential -r http://community.opscode.com/cookbooks/build-essential/versions/1_4_4/downloads;
[2014-03-11 00:23:47 -0400] shadylog: does not work
[2014-03-11 00:23:53 -0400] shadylog: it downloads the cookbook
[2014-03-11 00:23:55 -0400] coderanger: shadylog: The more moving parts in a bootstrap, the chances of it failing goes up exponentially
[2014-03-11 00:24:08 -0400] coderanger: Keep it as simple as possible
[2014-03-11 00:24:13 -0400] shadylog: but it downloads it to /var/chef/build-essential instead of /var/chef/cookbooks/build-essential :(
[2014-03-11 00:24:18 -0400] flaccid_: chef-solo --help
[2014-03-11 00:24:48 -0400] shadylog: flaccid_: already looked there unfortunately
[2014-03-11 00:24:59 -0400] shadylog: coderanger: yes
[2014-03-11 00:25:14 -0400] shadylog: coderanger: I fully agree :) that's why I want to have as little statements as possible
[2014-03-11 00:25:29 -0400] coderanger: shadylog: So having bootstrap -> run chef solo -> install stuff -> run librarian -> run solo again
[2014-03-11 00:25:31 -0400] shadylog: coderanger: if I install chef i just want to install chef and let that handle everything
[2014-03-11 00:25:32 -0400] coderanger: Thats  not good
[2014-03-11 00:25:39 -0400] shadylog: not ?
[2014-03-11 00:25:43 -0400] shadylog: but .. but..
[2014-03-11 00:25:48 -0400] coderanger: No, thats reeeeeally not good
[2014-03-11 00:25:59 -0400] coderanger: Remember what I said about exponential growth? :)
[2014-03-11 00:26:12 -0400] coderanger: Really you just want bootstrap -> run chef solo
[2014-03-11 00:26:19 -0400] shadylog: install chef > run chef solo build-essential > install librarian > use chef solo as normal
[2014-03-11 00:26:38 -0400] flaccid_: chef server is pretty good :)
[2014-03-11 00:26:38 -0400] coderanger: shadylog: That would still mean running chef twice and librarian
[2014-03-11 00:27:06 -0400] shadylog: coderanger: the alternative though was to wget/curl and manually tar every cookbook and dependency.. then there was the version thing to think of..
[2014-03-11 00:27:20 -0400] shadylog: the moving parts I have to implement in a shell script then get too complex and easily broken
[2014-03-11 00:27:24 -0400] coderanger: shadylog: A better option is to just run librarian once on a workstation, and either push the cookbooks directly to the machine or upload them asa tarball somewhere
[2014-03-11 00:27:35 -0400] shadylog: I guess I CAN say.. you are the user, you should know how to supply the correct cookbooks..
[2014-03-11 00:27:50 -0400] shadylog: coderanger: that's.. not possible.
[2014-03-11 00:27:57 -0400] coderanger: shadylog: Dependency resolution is not something that should ever happen during a bootstrap, basically
[2014-03-11 00:28:12 -0400] coderanger: with chef-client you have no choice but to allow it to happen, and thats a huge bug in chef-client
[2014-03-11 00:28:18 -0400] shadylog: full disclosure: i'm developping a master-server based on zookeeper to displace the chef-server / puppet-server / salt-master
[2014-03-11 00:28:41 -0400] coderanger: shadylog: Okay, why can't you do dep resolution on a workstation?
[2014-03-11 00:28:50 -0400] shadylog: hmmmm that's true
[2014-03-11 00:28:59 -0400] shadylog: and whn that's done.. they should just supply that config to me
[2014-03-11 00:29:06 -0400] shadylog: coderanger: you have convinced me
[2014-03-11 00:29:29 -0400] spheromak: workflow 2 stuff
[2014-03-11 00:29:32 -0400] shadylog: dependency management should be the users responsibility
[2014-03-11 00:29:50 -0400] coderanger: Yes, the thing they should give you is most likely a URL to a tarball of resolved cookbooks, possibly with a convenience tool to generate that compiled set and upload to S3 (or similar) and then pass that info down to the server
[2014-03-11 00:30:05 -0400] dgarstang: Is there a guide somewhere that explains differences between definitions and lwrp's?
[2014-03-11 00:30:12 -0400] coderanger: If I sound like I have fury over this, its because I've spent a few weeks recently working on this problem in chef :)
[2014-03-11 00:30:25 -0400] spheromak: dgarstang: definitions aren't real resources.  Is the short of it.
[2014-03-11 00:30:26 -0400] coderanger: dgarstang: defs are macros, LWRPs are a DSL for making resources
[2014-03-11 00:30:51 -0400] shadylog: coderanger: tell me this though. why doesn't chef-solo do dependency resolution inhouse.. I mean it already implements downloading a single cookbook, why doesn't it go all the way?
[2014-03-11 00:31:02 -0400] dgarstang: spheromak: a def is essentially just a function, right?
[2014-03-11 00:31:06 -0400] coderanger: shadylog: Because dep resolution is Really Hard
[2014-03-11 00:31:20 -0400] coderanger: shadylog: And that is basically the single main difference between chef-solo and chef-client
[2014-03-11 00:31:39 -0400] coderanger: shadylog: If you wanted a client that could do dep solving, you should use chef-client
[2014-03-11 00:31:49 -0400] coderanger: (give or take that chef-server's solver has serious issues)
[2014-03-11 00:31:50 -0400] shadylog: I would, but then i'd have to use the server
[2014-03-11 00:32:03 -0400] coderanger: shadylog: You need to use _a_ server
[2014-03-11 00:32:06 -0400] shadylog: like I said, i'm doing my thesis on displacing those servers
[2014-03-11 00:32:13 -0400] coderanger: shadylog: That can be whatever you what though
[2014-03-11 00:32:31 -0400] coderanger: The chef-server API isn't the issue (mostly)
[2014-03-11 00:32:47 -0400] coderanger: Its the erchef impl :)
[2014-03-11 00:32:49 -0400] shadylog: well.. no.. my idea is that "a" server is not enough :) what if its down.. what if the network is down.. etc
[2014-03-11 00:33:00 -0400] coderanger: shadylog: Again, thats talking about the impl
[2014-03-11 00:33:04 -0400] flaccid_: there is a million way to bootstrap and run remote commands to install and run chef solo on remote nodes shadylog
[2014-03-11 00:33:31 -0400] shadylog: flaccid_: yes. And I btw like chef FAR more than puppet
[2014-03-11 00:33:33 -0400] coderanger: shadylog: As the only author of a chef-server impl that doesn't work for ChefInc I'm probably just a bit past the edge of the bell curve here
[2014-03-11 00:34:21 -0400] shadylog: coderanger: we need people there to prove that we need better stuff :)
[2014-03-11 00:34:23 -0400] flaccid_: shadylog: fabric, ansible etc.
[2014-03-11 00:34:29 -0400] coderanger: shadylog: but if what you want is a fully alternate control plane, what you should probably look at is an alternate server impl
[2014-03-11 00:34:41 -0400] shadylog: flaccid_: yes :) I'm displacing ansible as well.
[2014-03-11 00:35:07 -0400] shadylog: coderanger: yeah, but my thesis's main goal is to avoid lock-in
[2014-03-11 00:35:15 -0400] coderanger: shadylog: What lock in?
[2014-03-11 00:35:16 -0400] flaccid_: ansible could run chef-solo. if you want it far simple then fabric and even simpler a shell script calling ssh command, even simpler, 1 command
[2014-03-11 00:35:18 -0400] coderanger: Its a REST API
[2014-03-11 00:35:24 -0400] shadylog: coderanger: lock-in to chef :)
[2014-03-11 00:35:37 -0400] flaccid_: using chef-solo is a lock in of some sorts
[2014-03-11 00:35:43 -0400] shadylog: flaccid_: i'l look into it :)
[2014-03-11 00:35:46 -0400] coderanger: shadylog: Not sure what that means, you are just as locked in to Chef with solo
[2014-03-11 00:35:54 -0400] shadylog: nope :P
[2014-03-11 00:36:05 -0400] flaccid_: want no lock in, do everything by hand in front of the computer hehe
[2014-03-11 00:36:14 -0400] shadylog: also nope :P
[2014-03-11 00:36:18 -0400] coderanger: shadylog: You are talking about building a control plane API for Chef, that _is_ chef-server
[2014-03-11 00:36:36 -0400] shadylog: hmm that's true
[2014-03-11 00:36:50 -0400] shadylog: but like I said I am implementing a "master" for chef
[2014-03-11 00:36:55 -0400] shadylog: its just not a chef-server
[2014-03-11 00:37:05 -0400] coderanger: shadylog: Right, so what I'm saying is ditch solo
[2014-03-11 00:37:16 -0400] coderanger: Write an impl of the API and point client at that
[2014-03-11 00:37:17 -0400] flaccid_: you are making a workstation or management server
[2014-03-11 00:37:32 -0400] shadylog: flaccid_: yes.
[2014-03-11 00:37:35 -0400] coderanger: There are three impls you can start from (ruby, erlang, python)
[2014-03-11 00:38:00 -0400] shadylog: coderanger: that's a good idea though. I will keep it in mind
[2014-03-11 00:38:07 -0400] shadylog: coderanger: really good idea
[2014-03-11 00:38:11 -0400] flaccid_: if you are doing ssh, just do Fabric to call chef-solo and be done with it. you could do some knife in there too
[2014-03-11 00:38:26 -0400] coderanger: You can gut the internals of chef-server and replace with ZK or whatever
[2014-03-11 00:38:29 -0400] flaccid_: solved in a bout 2 mins by creating the Fabfile
[2014-03-11 00:38:34 -0400] coderanger: But that gives you the structure you are looking for
[2014-03-11 00:38:47 -0400] shadylog: flaccid_: I haven't looked into Fabric yet, will look at it now :)
[2014-03-11 00:39:05 -0400] shadylog: coderanger: that sounds good :)
[2014-03-11 00:39:39 -0400] coderanger: shadylog: The only downside is there isn't a Java server impl, though could make one
[2014-03-11 00:39:47 -0400] flaccid_: shadylog: google fabfile install chef run chef-solo. its solved many times.
[2014-03-11 00:39:55 -0400] shadylog: coderanger: im writing in scala actually :)
[2014-03-11 00:39:57 -0400] coderanger: shadylog: The actual API you need for chef-client to work is pretty minimal
[2014-03-11 00:41:07 -0400] shadylog: flaccid_: unfortunately I can't use ssh. because the nodes can be BYON defined. i.e. have no ssh
[2014-03-11 00:41:28 -0400] flaccid_: shadylog: you could do rightlink
[2014-03-11 00:41:31 -0400] shadylog: https://gist.github.com/va1en0k/2859812
[2014-03-11 00:41:35 -0400] shadylog: that what you mean flaccid_?
[2014-03-11 00:41:54 -0400] shadylog: that looks like what coderanger said, a lot of bootstrapping layers
[2014-03-11 00:42:35 -0400] flaccid_: you are bootstrapping. a lot of these examples are more than they need to be, alas if its fabric its ssh afaik
[2014-03-11 00:44:22 -0400] shadylog: flaccid_: thanks for the tip though, will come in handy :)
[2014-03-11 00:45:39 -0400] flaccid_: shadylog: if no ssh/ingress your problem is already solved by rightscale..
[2014-03-11 00:47:47 -0400] shadylog: nah that's not a problem fortunately.
[2014-03-11 00:48:36 -0400] shadylog: my thesis is scientific(ish). I like to prove the point that supporting multiple configuration management tools (chef/puppet/salt...) through shell scripts and delegation to those tools can make your implementation more powerful
[2014-03-11 00:49:14 -0400] shadylog: commoditized and immutable servers just make it not that interesting anymore to upgrade a server
[2014-03-11 00:49:29 -0400] shadylog: it is easier to spin up a new one and shutdown the old one.
[2014-03-11 00:49:31 -0400] shadylog: also safer
[2014-03-11 00:49:42 -0400] flaccid_: i don't think there is anything to solve or prove then
[2014-03-11 00:50:00 -0400] shadylog: prove/show
[2014-03-11 00:51:55 -0400] coderanger: flaccid_: I think you may misunderstand how academia works ;-)
[2014-03-11 00:52:39 -0400] shadylog: lots of proving what everyone already knows in practise..
[2014-03-11 00:52:45 -0400] coderanger: Yeah, that
[2014-03-11 00:52:49 -0400] flaccid_: nope, i did uni but i've never been a fan of doing a masters thesis for stating the obvious :)
[2014-03-11 00:53:35 -0400] flaccid_: you should also be starting with proving it in theory first instead of working out an implementation
[2014-03-11 00:54:12 -0400] coderanger: flaccid_: Thats not really how IS/IT "research" works
[2014-03-11 00:54:55 -0400] coderanger: Its a weird hybrid of wanting to stay closer to industry and CS does, but still retain some element of research
[2014-03-11 00:55:06 -0400] flaccid_: coderanger: yes it is. there is no point providing how to do something in practice without backing it up in theory
[2014-03-11 00:55:20 -0400] flaccid_: research is research
[2014-03-11 00:55:23 -0400] shadylog: flaccid_: backing all this up in theory is extremely hard...
[2014-03-11 00:55:39 -0400] flaccid_: shadylog: good, a thesis shouldn't be easy
[2014-03-11 00:55:46 -0400] coderanger: flaccid_: You might think that, but this is not how you get a PhD in such things :)
[2014-03-11 00:57:04 -0400] flaccid_: wow, first time i see coderanger put getting it done over the right way, nice one br0
[2014-03-11 00:59:49 -0400] coderanger: flaccid_: Academia wore down my will to fight very quickly
[2014-03-11 01:00:05 -0400] coderanger: flaccid_: Tenure is an unbeatable trump card
[2014-03-11 01:03:46 -0400] shadylog: bwegh.. vagrant + gem install + osx == wait a long time
[2014-03-11 01:16:51 -0400] mjuszczak: For any chosen naming scheme, is it better if a TLD is added at the end?  IE: instead of simply "bob", using bob.example.com.  Does chef care?  I know puppet does.
[2014-03-11 01:18:38 -0400] juliancdunn: mjuszczak: the name of the node object in Chef is the FQDN, if that's what you're asking
[2014-03-11 01:18:57 -0400] juliancdunn: so it's a good idea to have unique FQDNs across your infrastructure :)
[2014-03-11 01:25:19 -0400] coderanger: well, its the default node name
[2014-03-11 01:25:21 -0400] coderanger: doesn't have to be though
[2014-03-11 01:27:06 -0400] juliancdunn: that's true, though I usually tell people to leave it alone
[2014-03-11 01:28:49 -0400] coderanger: juliancdunn: I've had a lot of issues on AWS where the hostname changes during boostrap (usually foo -> foo.whatever.com) :-/
[2014-03-11 01:35:35 -0400] juliancdunn: wow, I've never had that happen
[2014-03-11 01:35:59 -0400] juliancdunn: unless you mean that you're doing it yourself because you set a custom hostname
[2014-03-11 01:36:12 -0400] juliancdunn: I generally leave all my AWS boxes as ec2-whatevs.ec2.internal
[2014-03-11 01:36:30 -0400] coderanger: juliancdunn: Yeah, its probably some weird interaction of our VPC DHCP options and how we create DNS entries
[2014-03-11 01:36:58 -0400] juliancdunn: ah, yeah. I name cats, not servers. :-P
[2014-03-11 01:37:17 -0400] coderanger: I got yelled at when I said that "semantically meaningful hostname" was silly idea
[2014-03-11 01:37:43 -0400] coderanger: so its stuff like api-prod-10-0-0-1.vandelay.io
[2014-03-11 01:37:56 -0400] juliancdunn: I'm with you buddy. I wrote a whole blog post ranting about that
[2014-03-11 01:38:18 -0400] coderanger: Its at least better than custom named servers in that its automated
[2014-03-11 01:38:26 -0400] coderanger: and I can understand the userfulness
[2014-03-11 01:38:29 -0400] coderanger: but mehhhh
[2014-03-11 01:39:54 -0400] spheromak: coderanger: i've been trying to see the light on metada doesn't belong in hostnames for a looooong time
[2014-03-11 01:40:04 -0400] spheromak: trying to get people to see the light i should say
[2014-03-11 01:40:35 -0400] coderanger: spheromak: It is kind of nice to see it in the prompt, but I would rather just generate a bash thingy to set the prompt instead of the hostname
[2014-03-11 01:40:45 -0400] spheromak: yeap
[2014-03-11 01:41:04 -0400] spheromak: add it userdata, and have that pushed out in the prompt.
[2014-03-11 01:41:11 -0400] spheromak: whole like 2 lines of shell
[2014-03-11 01:42:06 -0400] coderanger: The argument was that stuff like New Relic and our in-house (terrible) logstash-ish thing mostly work on hostnames
[2014-03-11 01:42:26 -0400] coderanger: So meh, it was easier to fix than argue
[2014-03-11 01:51:11 -0400] flaccid_: coderanger: true. i went back to work because i preferred money and uni was way behind the times
[2014-03-11 01:52:04 -0400] shadylog: ok precise up to saucy works with the chef script + wheezy + centos 5/6 :)
[2014-03-11 01:52:07 -0400] shadylog: thanks for the help guys!
[2014-03-11 01:52:45 -0400] shadylog: coderanger: I went for the extra chef solo run. I know, you are correct. So I will make another version that excludes librarian
[2014-03-11 01:53:03 -0400] shadylog: will call this bootstrap-chef-librarian and the other bootstrap-chef
[2014-03-11 01:53:12 -0400] coderanger: shadylog: If you are starting something new, I hiiiiiighly recommand berkshelf over librarian
[2014-03-11 01:53:20 -0400] mjuszczak: juliancdunn: I just meant, should we set the hostnames of our boxes to: mysql-app-1.dfw OR mysql-app-1.dfw.example.com.  Does chef care?
[2014-03-11 01:53:31 -0400] shadylog: coderanger: Is it better?
[2014-03-11 01:53:35 -0400] coderanger: shadylog: much
[2014-03-11 01:53:46 -0400] shadylog: how is it different?
[2014-03-11 01:54:29 -0400] coderanger: shadylog: Same general idea, different impl
[2014-03-11 01:54:29 -0400] shadylog: https://github.com/berkshelf/berkshelf-cookbook
[2014-03-11 01:54:32 -0400] shadylog: i'm loving it already
[2014-03-11 01:54:43 -0400] coderanger: shadylog: http://berkshelf.com/
[2014-03-11 01:55:00 -0400] shadylog: i sincerely dislike gem install :(
[2014-03-11 01:55:31 -0400] coderanger: ?
[2014-03-11 01:55:36 -0400] coderanger: How did you install librarian then
[2014-03-11 01:55:55 -0400] flaccid_: gem install librarian-chef --no-document heh
[2014-03-11 01:56:41 -0400] shadylog: well.. gem install :P
[2014-03-11 01:56:54 -0400] shadylog: but I like that they made a cookbook for installing berkshelf
[2014-03-11 01:57:05 -0400] coderanger: shadylog: I wouldn't use it, but sure
[2014-03-11 01:57:14 -0400] shadylog: hmmm
[2014-03-11 01:57:19 -0400] coderanger: shadylog: That exists mostly to install the berkshelf-api service
[2014-03-11 01:57:25 -0400] coderanger: which is separate from berks itself
[2014-03-11 01:57:26 -0400] shadylog: ah
[2014-03-11 01:57:32 -0400] shadylog: ok i see..
[2014-03-11 01:59:08 -0400] flaccid_: i still havn't found a need for berkshelf heh
[2014-03-11 01:59:37 -0400] coderanger: flaccid_: Possibly because most of your use of chef is with a custom backplane that does its own dep handling ;-)
[2014-03-11 01:59:49 -0400] flaccid_: coderanger: i have a custom backplane?
[2014-03-11 01:59:54 -0400] coderanger: rightscale ...
[2014-03-11 02:00:12 -0400] flaccid_: i don't dev on rightscale and i don't really use it now
[2014-03-11 02:00:31 -0400] flaccid_: i generally develop chef-blueprints
[2014-03-11 02:01:21 -0400] shadylog: ok
[2014-03-11 02:01:21 -0400] shadylog: i've had it
[2014-03-11 02:01:22 -0400] shadylog: im giving up on librarian/berkshelf
[2014-03-11 02:01:22 -0400] shadylog: people should just tar an cookbook
[2014-03-11 02:01:23 -0400] shadylog: pfft
[2014-03-11 02:01:23 -0400] shadylog: coderanger: you were right
[2014-03-11 02:01:34 -0400] flaccid_: lol, whats the problem now shadylog
[2014-03-11 02:01:51 -0400] coderanger: shadylog: Its the only sane way long-term
[2014-03-11 02:02:48 -0400] flaccid_: shadylog: https://github.com/chef-blueprints/linux_box#install-librarian-for-chef
[2014-03-11 02:03:15 -0400] shadylog: some gem install require crap..
[2014-03-11 02:03:28 -0400] shadylog: stuck at
[2014-03-11 02:03:28 -0400] shadylog: gem install librarian-chef --no-rdoc --no-ri
[2014-03-11 02:03:29 -0400] shadylog: :P
[2014-03-11 02:03:48 -0400] shadylog: https://gist.github.com/anonymous/99c7cdd4e6bc2e37f8b9
[2014-03-11 02:03:49 -0400] flaccid_: shadylog: pastebin the errors
[2014-03-11 02:04:00 -0400] shadylog: this didn't happen on precise
[2014-03-11 02:04:04 -0400] coderanger: shadylog: You should also reeeeeeally look in to omnibus
[2014-03-11 02:04:06 -0400] flaccid_: shadylog: i believe you need ruby-dev pkg
[2014-03-11 02:04:15 -0400] coderanger: shadylog: and/or packer
[2014-03-11 02:04:22 -0400] shadylog: yes :(
[2014-03-11 02:04:30 -0400] shadylog: but actually im giving up
[2014-03-11 02:04:33 -0400] shadylog: on librarian
[2014-03-11 02:04:35 -0400] shadylog: its not worth it
[2014-03-11 02:05:52 -0400] flaccid_: shadylog: apt-get install ruby1.9.3-dev
[2014-03-11 02:06:28 -0400] flaccid_: woops ruby1.9.1-dev
[2014-03-11 02:06:38 -0400] shadylog: yeah but that would mean adding an exception for saucy etc...
[2014-03-11 02:06:50 -0400] shadylog: and then it would probably break on precise..
[2014-03-11 02:06:59 -0400] coderanger: If you really wanted to do this, you should install it into Chef's Ruby
[2014-03-11 02:07:02 -0400] shadylog: i think i need a configuration management tool ;)
[2014-03-11 02:07:08 -0400] coderanger: since it needs chef as a gem anyway
[2014-03-11 02:07:35 -0400] flaccid_: shadylog: nope. http://packages.ubuntu.com/search?keywords=ruby1.9.1-dev&searchon=names&suite=all&section=all
[2014-03-11 02:07:37 -0400] shadylog: coderanger: but then i'm making a custom "build" or something which needs to be supported :)
[2014-03-11 02:07:43 -0400] coderanger: shadylog: Yep
[2014-03-11 02:07:51 -0400] coderanger: shadylog: Welcome to releasing software in 2014
[2014-03-11 02:08:14 -0400] coderanger: shadylog: State of the art is to statically compile whatever you can and cram it in a binary package
[2014-03-11 02:08:17 -0400] shadylog: flaccid_: yeah true, but on RHEL/wheezy that all doesn't work :)
[2014-03-11 02:08:32 -0400] flaccid_: shadylog: what i used to do when rightscale needed it was to cache the cookbooks in github, then you just download that tarball. e.g. https://github.com/rightscale-blueprints/linux_server/tree/master/cookbooks
[2014-03-11 02:08:52 -0400] shadylog: flaccid_: yes!!! I will do that :)
[2014-03-11 02:09:00 -0400] flaccid_: shadylog: its in weezy. any redhat based system won't have apt, so you do the cache thing above
[2014-03-11 02:09:10 -0400] shadylog: yup
[2014-03-11 02:09:15 -0400] shadylog: will do the cache thing its the best option
[2014-03-11 02:09:17 -0400] flaccid_: solved, again
[2014-03-11 02:09:23 -0400] shadylog: :)
[2014-03-11 02:10:32 -0400] shadylog: well will tackle it tomorrow, enough for the day :)
[2014-03-11 03:16:48 -0400] flaccid_: coderanger: i lost the link before, but was the cookbook you doing for rundeck the webtrends one?
[2014-03-11 04:33:46 -0400] jkburges: I'm having an issue try to provision a (remote) VM using the knife solo plugin (http://matschaffer.github.io/knife-solo/).  roles/data_bags/envs are not being synced up to the VM at all
[2014-03-11 04:34:22 -0400] jkburges: ssh auth is ok - chef is running but obviously baulking because it doesn't have all it needs up there
[2014-03-11 04:34:40 -0400] jkburges: anyone know about knife solo and might be able to help me?
[2014-03-11 04:39:47 -0400] aslaen: ok, prob a stupid question, but I can't get knife-rackspace working.  I've got the plugin installed (0.9.1)
[2014-03-11 04:39:49 -0400] aslaen: $ gem list --local | grep knife-rackspace
[2014-03-11 04:39:49 -0400] aslaen: knife-rackspace (0.9.1)
[2014-03-11 04:40:18 -0400] aslaen: However any knife rackspace commands give error "Cannot find sub command"
[2014-03-11 04:42:42 -0400] tjr9898__: aslaen: how was ruby installed?
[2014-03-11 04:43:13 -0400] aslaen: tjr9898__ Mavericks default install
[2014-03-11 04:43:26 -0400] aslaen: vagrant is working fine however.
[2014-03-11 04:43:31 -0400] tjr9898__: which version is now 1.9.3
[2014-03-11 04:43:44 -0400] aslaen: $ ruby -v
[2014-03-11 04:43:45 -0400] aslaen: ruby 2.0.0p247 (2013-06-27 revision 41674) [universal.x86_64-darwin13]
[2014-03-11 04:43:47 -0400] tjr9898__: Vagrant uses embedded ruby
[2014-03-11 04:43:52 -0400] aslaen: tjr9898__ oh ok
[2014-03-11 04:44:27 -0400] tjr9898__: you may need to try `bundle exec knife rackspace`
[2014-03-11 04:44:48 -0400] tjr9898__: but that's only if you have a gemfile
[2014-03-11 04:45:00 -0400] aslaen: should I use chef embedded gem?
[2014-03-11 04:45:15 -0400] tjr9898__: no not your mac
[2014-03-11 04:46:01 -0400] aslaen: bundle says RVM Ruby not used
[2014-03-11 04:46:35 -0400] aslaen: it's weird that knife command works fine, but rackspace plugin doesn't
[2014-03-11 04:47:31 -0400] tjr9898__: I just looked at mine and I get the error for the rackspace command not being there but then it goes ahead and list all the rackspace subcommands
[2014-03-11 04:47:44 -0400] aslaen: ya, it's not loading anything for me.
[2014-03-11 04:47:51 -0400] aslaen: gives that error and bails
[2014-03-11 04:49:32 -0400] tjr9898__: I'm assuming that you already have the rackspace api_key and username setup in the knife config
[2014-03-11 04:50:38 -0400] aslaen: yes I do
[2014-03-11 04:52:33 -0400] aslaen: tjr9898__ ok this is prob not the correct fix, but installing it using /opt/chef/embedded/bin/gem install knife-rackspace and it's working now
[2014-03-11 04:54:13 -0400] tjr9898__: so you do not know have chef installed as a gem
[2014-03-11 04:55:05 -0400] tjr9898__: gem list --local | grep chef
[2014-03-11 04:56:50 -0400] aslaen: gem list --local | grep chef
[2014-03-11 04:56:51 -0400] aslaen: chef (11.4.4)
[2014-03-11 04:56:51 -0400] aslaen: chef-zero (1.7.3)
[2014-03-11 04:57:24 -0400] tjr9898__: I haven't really used 11.4.4
[2014-03-11 04:57:46 -0400] tjr9898__: I've use 11.8 & 11.10 quite a bit more
[2014-03-11 04:58:23 -0400] aslaen: ok, maybe I need to upgrade and then try again
[2014-03-11 04:58:48 -0400] tjr9898__: it's a small possiblity
[2014-03-11 05:00:22 -0400] tjr9898__: what does `/opt/chef/bin/knife -v` return
[2014-03-11 05:02:07 -0400] aslaen: Chef: 11.10.0
[2014-03-11 05:06:20 -0400] aslaen: Ok.. I have to head to bed.. Thanks for the help tjr9898__
[2014-03-11 05:10:34 -0400] skansky: what's a clean chef/ruby equivalent to "mkdir -p"?
[2014-03-11 05:10:47 -0400] skansky: without kicking out to a system/exec call?
[2014-03-11 05:11:39 -0400] skansky: my googling on this is no good, i have not summoned the correct google words yet
[2014-03-11 05:12:17 -0400] kei_: hello
[2014-03-11 05:12:31 -0400] skansky: hi
[2014-03-11 05:12:58 -0400] tjr9898__: skansky: an option is to use FileUtils
[2014-03-11 05:14:37 -0400] tjr9898__: require 'fileutils'; FileUtils.mkdir_p 'your/directory'
[2014-03-11 05:14:59 -0400] kei_: does anyone know why I'm getting "undefined method `default_version' for #<Omnibus::Software:0x00000001ac4d50>" when trying to build an omnibus package?
[2014-03-11 05:15:03 -0400] Popsikle: skansky: its recursive : true
[2014-03-11 05:15:06 -0400] Popsikle: iirc
[2014-03-11 05:15:15 -0400] Popsikle: the directory provider has a recursive option
[2014-03-11 05:15:26 -0400] Popsikle: but the perms you spec are only for the bottom most dir
[2014-03-11 05:15:44 -0400] skansky: tjr9898__ - sweet! it works
[2014-03-11 05:15:57 -0400] tjr9898__: but that is ruby
[2014-03-11 05:16:13 -0400] tjr9898__: for chef you should use the directory resource with recursive true
[2014-03-11 05:16:36 -0400] skansky: tjr9898__: it's bad style/practise to just do a require?
[2014-03-11 05:16:42 -0400] Popsikle: directory "/some/buried/dir" do
[2014-03-11 05:16:42 -0400] Popsikle: action :create
[2014-03-11 05:16:43 -0400] Popsikle: owner "user"
[2014-03-11 05:16:43 -0400] Popsikle: group group"
[2014-03-11 05:16:44 -0400] Popsikle: mode "777"
[2014-03-11 05:16:44 -0400] Popsikle: recursive true
[2014-03-11 05:16:45 -0400] Popsikle: end
[2014-03-11 05:17:06 -0400] tjr9898__: it's more chef like to use the chef resources
[2014-03-11 05:17:07 -0400] skansky: oh i see - since directory already exists and can do that, I should use it. THat is the rationale right?
[2014-03-11 05:17:14 -0400] tjr9898__: right
[2014-03-11 05:17:33 -0400] tjr9898__: I've been in command line tool mode lately
[2014-03-11 05:17:46 -0400] skansky: Popsikle: tahnks man
[2014-03-11 05:17:56 -0400] tjr9898__: thanks Popsikle for the sanity
[2014-03-11 05:18:05 -0400] tjr9898__: maybe not the mode '777'
[2014-03-11 05:18:18 -0400] Popsikle: yea
[2014-03-11 05:18:37 -0400] Popsikle: i just chmod 777 / -R all day tho
[2014-03-11 05:18:38 -0400] Popsikle: so
[2014-03-11 05:18:39 -0400] Popsikle: ;)
[2014-03-11 05:18:57 -0400] skansky: i am so happy. this is my first edit of existing chef at work... finally!
[2014-03-11 05:19:25 -0400] tjr9898__: congrats
[2014-03-11 05:19:31 -0400] skansky: former puppet user here
[2014-03-11 05:20:03 -0400] tjr9898__: welcome
[2014-03-11 05:20:21 -0400] Popsikle: chef drvies me crazy
[2014-03-11 05:20:26 -0400] Popsikle: and will drive you crazy too
[2014-03-11 05:20:52 -0400] skansky: maybe i'm too late to it. the cool people use salt stack! but it's been decided we use chef at this new job so i'm glad to get into it
[2014-03-11 05:21:20 -0400] skansky: i don't want to be cool though i just want to get some stuff done/working
[2014-03-11 05:27:04 -0400] Popsikle: meh salt is cool and all, its not as complete as say chef or puppet imho, but at least you know what order things are going to go in, unlike chef, which is all over the place with ordering lol
[2014-03-11 05:34:11 -0400] skansky: what.. i thought ordering was the main complaint against puppet... now you tell me this about chef?
[2014-03-11 05:34:29 -0400] skansky: i like this run list thing
[2014-03-11 05:35:00 -0400] jkeiser: chef runs things in the order you declare them, it's pretty straightforward
[2014-03-11 05:36:39 -0400] skansky: oh i think Popsile was kidding now that i re-read it
[2014-03-11 05:37:00 -0400] jkeiser: aha :)
[2014-03-11 05:37:24 -0400] skansky: irc troubleshooting!
[2014-03-11 05:57:23 -0400] coderanger: Yeah, Chef executes things like normal code, meaning the order it is in the file(s) :)
[2014-03-11 06:03:34 -0400] Popsikle: coderanger: sureeeeeeeeeeeeee it does.
[2014-03-11 06:03:56 -0400] coderanger: Popsikle: Until you do weird stuff with resources, it just runs the files
[2014-03-11 06:04:01 -0400] Popsikle: things like the official postgres cookbook dont force packages to be installed way before you are ready
[2014-03-11 06:04:25 -0400] Popsikle: there are plenty of things that jump up the stack ;/
[2014-03-11 06:04:26 -0400] coderanger: Popsikle: The ChefInc cookbooks are not examples of simple cookbooks
[2014-03-11 06:04:45 -0400] coderanger: They are quite complex as they are designed to handle a large number of platforms and use cases
[2014-03-11 06:04:48 -0400] Popsikle: neither are mine which is what makes it even more frustrating lol.
[2014-03-11 06:05:36 -0400] Popsikle: Yea, I get it, but most of them jump the stack in one place or another which makes it pretty difficult to get the hang of
[2014-03-11 06:05:46 -0400] spheromak: Popsikle: the only thing that is 'confusing' is run vs compile time
[2014-03-11 06:06:05 -0400] spheromak: and osme stuff has to do pretty nasty shit to make sure what it needs is there.  i.e. compile time installation
[2014-03-11 06:06:08 -0400] Popsikle: no, thats easy to understand
[2014-03-11 06:06:13 -0400] coderanger: Popsikle: Once you get into multi-pass converges it gets far more complex, and then if you want to make it even worse you get nested converges :)
[2014-03-11 06:07:28 -0400] Popsikle: postgres for example, again, if you need to change the data path on a debian install good luck. you cant witht he official cookbook. you need to wrap it in something that forces the service to stop so you can make changes to the conf file, init the db, and then restart the service. but because service resources are clones you need to do it all via mixlib shell out, which makes it pretty difficult
[2014-03-11 06:08:19 -0400] spheromak: Popsikle: thats just inflexabile cook. or 'opinionated' nothing stopping you from making one better.  You don't have to wrap it either. again you can do it with your opinions if you like.
[2014-03-11 06:08:48 -0400] spheromak: prob with the opscode cooks. they aren't generally meant to be canonical. tho they are treated as such
[2014-03-11 06:09:39 -0400] coderanger: Yeah, a lot of people use them that shouldn't
[2014-03-11 06:09:44 -0400] Popsikle: meh, hacking the opscode books leads to issues when other people need to take things over. it looks like the official book but then they git fetch or something and whops, there goes the site. lol
[2014-03-11 06:09:44 -0400] spheromak: and in that particualr cook, it was designed before the dawn of the app/lib cookbook
[2014-03-11 06:09:47 -0400] coderanger: I mean they should be written to be extendable
[2014-03-11 06:09:50 -0400] coderanger: but they aren't
[2014-03-11 06:09:57 -0400] coderanger: (mostly)
[2014-03-11 06:10:18 -0400] spheromak: coderanger: that was mostly due to them needing to run opscode's infra correct ?
[2014-03-11 06:10:30 -0400] coderanger: No, Opscode didn't use them for years
[2014-03-11 06:10:34 -0400] spheromak: I always felt that way. in the early days i could use none of it. as i had no ubuntu
[2014-03-11 06:10:38 -0400] coderanger: Only recently has that started to happen
[2014-03-11 06:10:41 -0400] spheromak: ah
[2014-03-11 06:10:51 -0400] Popsikle: spheromak: I have all ubuntu, I feel that way still ;p
[2014-03-11 06:10:52 -0400] coderanger: They just existed in a vacuum for years
[2014-03-11 06:10:54 -0400] spheromak: anyhow I didn't use much of it.
[2014-03-11 06:11:12 -0400] coderanger: But its still just a lot of issues around flexibility vs. complexity
[2014-03-11 06:11:30 -0400] coderanger: they are written in such a way that you need a bunch of complexity for any added flexibility
[2014-03-11 06:11:41 -0400] coderanger: so due to that, not much flexibility is being added
[2014-03-11 06:11:48 -0400] coderanger: since they are already super complex
[2014-03-11 06:11:49 -0400] coderanger: :-(
[2014-03-11 06:11:55 -0400] spheromak: but that has it's own problems. Popsikle generally tho this is why building providers > cookbooks and the work coderanger has been doing on Poise goes a long ways to allowing us to build some really nice things, that don't run into these problems
[2014-03-11 06:12:21 -0400] coderanger: Reusable modular cookbooks miiiiiight kind of be my thing O:-)
[2014-03-11 06:12:26 -0400] coderanger: So I have a lot of opinions about this
[2014-03-11 06:12:27 -0400] spheromak: indeed
[2014-03-11 06:13:25 -0400] Popsikle: oh im way past worrying about the opscode books. the ones i need to wrap I did, and most of them just got replaced outright. but i know a lot of guys at other palces that wont use chef because they see officail cookbooks and use them. Then they cant get thier crap to work and now assoicate chef with broken cokobooks
[2014-03-11 06:14:12 -0400] Popsikle: one day I will learn to type way better after being awake for 20+ hours.
[2014-03-11 06:14:14 -0400] Popsikle: one day...
[2014-03-11 06:14:17 -0400] spheromak: Popsikle: i see
[2014-03-11 06:14:49 -0400] spheromak: like everything if you know it well enough you know it's warts. I thin there are def those of us who are attempting to make that situation better.
[2014-03-11 06:15:12 -0400] spheromak: Ideally moving more cooks out of 'official' opscode may help. dunno
[2014-03-11 06:16:34 -0400] coderanger: Yeah, though I'm probably not a shining example of that
[2014-03-11 06:16:42 -0400] coderanger: Need to get a bunch of releases up on the community site
[2014-03-11 06:17:53 -0400] spheromak: dumb DST
[2014-03-11 06:20:13 -0400] Popsikle: Really I have come to understand that the power of chef is really in ohai ;) I do a lot of my classification and such there, and then its just monkey work in chef. but yea, sleep sounds good ;)
[2014-03-11 06:41:05 -0400] tomoyuki28jp: How can I output debug log? I've already set log_level = :debug.
[2014-03-11 06:41:37 -0400] tomoyuki28jp: But `p "debug log"` does not come out.
[2014-03-11 06:42:25 -0400] coderanger: tomoyuki28jp: Use Chef::Log.debug
[2014-03-11 06:42:40 -0400] coderanger: Or a log resource
[2014-03-11 06:42:58 -0400] tomoyuki28jp: coderanger: thanks a lot!
[2014-03-11 08:53:39 -0400] pradeepc: hello all, can i have multiple source line within same remote_directory
[2014-03-11 08:54:31 -0400] pradeepc: actually i want to source all the files from multiple directories.
[2014-03-11 08:57:26 -0400] coderanger: pradeepc: No, but you can use multiple remote_directory resources if you set purge false
[2014-03-11 08:58:36 -0400] epcim: Is there a way to tell Knife bootstrap cmd. to setup chef-client to be run from cron or do I need to use a specific solution, like chef-client cookbook in run_list?
[2014-03-11 08:59:03 -0400] pradeepc: coderanger: basically what i want to do is i want some files to be served to all of the machines .. but some files to only particular machines
[2014-03-11 08:59:55 -0400] pradeepc: for that i was thinking to create a directory named "common" and keep all the files which should be present in all of the machines.
[2014-03-11 09:00:14 -0400] pradeepc: coderanger: is the way i am thinking is proper ?
[2014-03-11 09:02:00 -0400] pradeepc: coderanger: so can i have multiple resources like "remote_directory "/etc/monit.d" do .... " ?
[2014-03-11 09:03:02 -0400] coderanger: epcim: the chef-client cookbook has a recipe for that, yes
[2014-03-11 09:03:21 -0400] coderanger: pradeepc: Just make actual resources for this kind of thing
[2014-03-11 09:03:31 -0400] coderanger: that is not a good use remote_directory
[2014-03-11 09:04:07 -0400] coderanger: pradeepc: An LWRP would be a good place to start :)
[2014-03-11 09:05:28 -0400] pradeepc: coderanger: thank you .. i will read it first.
[2014-03-11 09:13:08 -0400] epcim: coderanger: what I don't understand at chef-client is how to configure platform specific service/daemon to periodically run it.
[2014-03-11 09:13:29 -0400] epcim: coderanger: well - init - init_style is static (no repeated execution if I do understand)
[2014-03-11 09:14:29 -0400] epcim: coderanger: by attributes I can set init_style (but than, it must be done through wrapper cookbook, to properly choose init_style that fit the OS platrofm).
[2014-03-11 09:15:21 -0400] epcim: coderanger: "cron" init style run at particular "hour"/"minute" (so probably once a day?)
[2014-03-11 09:15:34 -0400] epcim: can anybody give me the best practice experience ?
[2014-03-11 10:12:49 -0400] nkts: Hi, who could give me good ruby example, how to convert ruby hash to java properties like config where key are all hash keys merged by dot and value appended at the end?.. thnx
[2014-03-11 10:23:55 -0400] mhenrixon: what does java properties config look like_
[2014-03-11 10:23:56 -0400] mhenrixon: ?
[2014-03-11 10:23:59 -0400] mhenrixon: nkts
[2014-03-11 10:24:46 -0400] nkts: mhenrixon: for example "foo.bar.baz = true"
[2014-03-11 10:25:01 -0400] mhenrixon: sec
[2014-03-11 10:25:23 -0400] nkts: and I don't want to set key as "foo.bar.baz" in template / attributes
[2014-03-11 10:34:57 -0400] mhenrixon: nkts: https://gist.github.com/9483207
[2014-03-11 10:36:11 -0400] mhenrixon: nkts just realized that isn't very elegant
[2014-03-11 10:36:18 -0400] mhenrixon: let me clean that up a little
[2014-03-11 10:38:07 -0400] mhenrixon: nkts try this https://gist.github.com/mhenrixon/9483207
[2014-03-11 10:38:43 -0400] mhenrixon: Then you could take your nested hash and just write the keys and values to the file straight up
[2014-03-11 10:38:46 -0400] mhenrixon: Have fun
[2014-03-11 10:51:35 -0400] epcim: Hey guys is it possible to search in encrypted databags?
[2014-03-11 10:51:55 -0400] workmad3: epcim: no
[2014-03-11 10:52:05 -0400] epcim: I do ask since I use a users cookbook, but no user are being created. It works in my chef/zero env. where they are in json
[2014-03-11 10:52:43 -0400] workmad3: epcim: the point of encrypted databags is so the server and the search capabilities don't have access to the actual values
[2014-03-11 10:52:43 -0400] epcim: workmad3: thx, so how do you upload data_bags to chef server (do you have knife[:secret_file] not set at all and only use comand line --secret-file when you want to encrypt databag?
[2014-03-11 10:53:29 -0400] workmad3: epcim: I just don't have anything searching through databags... I grab the databag I want by name and just use it :)
[2014-03-11 10:54:10 -0400] samwierema: Somewhat related: what's the best policy to share encrypted_data_bag_secret to nodes that need it?
[2014-03-11 10:54:47 -0400] workmad3: samwierema: if you've only got one secret for your entire infrastructure, it's generally just copied on with bootstrapping
[2014-03-11 10:55:11 -0400] workmad3: samwierema: for more granular setups, you need to either roll your own distribution or potentially look at something like chef-vault
[2014-03-11 10:56:32 -0400] nkts: mhenrixon: thanks, works like a charm :) Thumbs up!
[2014-03-11 10:57:13 -0400] samwierema: workmad3: thanks, now I see. If I didn't upload it on the first bootstrap, can I bootstrap again with the --secret-file option?
[2014-03-11 10:57:45 -0400] workmad3: samwierema: yeah, the bootstrap script is safe to do that with now I believe (although be careful to use the correct run list)
[2014-03-11 10:58:09 -0400] nkts: What is the best way to change data type in templates, eg true => 'yes' ? I have added simple class to implement custom method for each data type, but maybe there's better way to do that fully transparent (not to call custom method)?
[2014-03-11 10:58:18 -0400] workmad3: samwierema: assuming of course you've not locked down root access via SSH or something like that... then you may need to manually scp the file up and sudo cp it into place in /etc/chef :)
[2014-03-11 10:59:06 -0400] workmad3: nkts: no, there's not a way to do it transparently
[2014-03-11 11:00:20 -0400] nkts: workmad3: k, thanks, I'll stick to my method then
[2014-03-11 11:02:01 -0400] samwierema: workmad3: thanks, re-bootstrapping worked
[2014-03-11 11:02:17 -0400] epcim: samwierema: mee to (10 times:)
[2014-03-11 11:02:57 -0400] epcim: samawierema do I understand that if you use --secret-file it will upload the encrypted_data_bag_secret?
[2014-03-11 11:03:29 -0400] epcim: I have thought it will happen by default
[2014-03-11 11:04:11 -0400] epcim: BTW: there were some attempts to use searches in encrypted databags.. etc. http://lusislog.blogspot.co.uk/2011/01/chef-and-encrypted-data-bags-revisted.html
[2014-03-11 11:04:43 -0400] samwierema: Yes, if you run knife bootstrap with --secret-file it uploads the file, it doesn't happen by default
[2014-03-11 11:23:56 -0400] ermajn: hello, I have execute resource, and my not_if is returning values, but resource is still getting executed
[2014-03-11 11:24:01 -0400] ermajn: what am I doing wrong?
[2014-03-11 11:30:16 -0400] nkts: And what is the fastest way to test cookbooks in development? Uploading it to Hosted Chef and kicking chef-client consumes fair amount of time..
[2014-03-11 11:36:57 -0400] mhenrixon: lol
[2014-03-11 11:37:03 -0400] mhenrixon: test-kitchen is your friend nkts
[2014-03-11 11:37:11 -0400] mhenrixon: or chefspec
[2014-03-11 11:37:16 -0400] mhenrixon: I do both
[2014-03-11 11:53:09 -0400] pradeepc: Hi... i am using remote_directory to serve directory through chef.. i want if the directory doesnt exist in chef-repo it should not throw error and continue the chef-run
[2014-03-11 11:54:23 -0400] pradeepc: can i call ruby block within  a resource to verify if the directory exists
[2014-03-11 11:59:54 -0400] stormerider: pradeepc: you probably want to look into the only_if / not_if guards
[2014-03-11 12:09:21 -0400] pradeepc: stormerider: thanks it works with only_if nicely
[2014-03-11 12:09:35 -0400] stormerider: np :)
[2014-03-11 12:09:42 -0400] pradeepc: :) :)
[2014-03-11 12:18:21 -0400] daxroc: Morning all
[2014-03-11 12:18:35 -0400] stormerider: morning
[2014-03-11 12:20:44 -0400] daxroc: Should the remote_file checksum attribute contain the etag checksum partial/complete or should it be true,false ?
[2014-03-11 12:30:16 -0400] daxroc: If I set the checksum to "blah" shouldn't my file not retry the download as the checksums don't match?
[2014-03-11 12:34:38 -0400] daxroc: A little confused on this one, partially because some files were uploaded to s3 using multipart so the etag is not an md5.
[2014-03-11 12:47:30 -0400] Gumpo: Hi there!
[2014-03-11 12:48:45 -0400] Gumpo: I got a problem, chef tries to install a package via apt which in this version is not in the repository. Is there any caching which could lead to this failure?
[2014-03-11 12:53:37 -0400] daxroc: Gumpo: you should run apt-get update before any attempt to install packages.
[2014-03-11 12:57:29 -0400] Gumpo: Ok, this was I've done. I'm half an hour at this prob. Now I found the solution. Percona names the Server Package percona-server-server-5.5 but I had only percona-server-5.5 in my recipe. Thanks anyway!
[2014-03-11 12:58:32 -0400] daxroc: On the remote_file, chef looks to be using shasum 256 for local comparisons, does it ignore the checksum value? finding it confusing when I set the checksum "example_fail_string" and it still fetches the file only once. Is the checksum attribute not expected to match at least partial on the downloaded file?
[2014-03-11 13:20:58 -0400] chris613: anyone know how to use chef_rewind to replace an only_if resource attribute?
[2014-03-11 13:21:33 -0400] masterkorp: Hello everyone
[2014-03-11 13:21:56 -0400] shlant: masterkorp: hello! I read your name as Magikarp :p
[2014-03-11 13:22:04 -0400] CPS: does ruby have a lazy keyword?
[2014-03-11 13:22:09 -0400] masterkorp: any documentation or link on keeping an chef workflow of on git repository per cookbook
[2014-03-11 13:22:23 -0400] masterkorp: shlant: wait until i get in gyarados !
[2014-03-11 13:22:28 -0400] nick__: newbie question.  I need to get a file generated on one client to another client or clients.  I was thinking I would gen the file on the client and upload it to a data bag but I can't write to data bags from the client.  Any suggestions?
[2014-03-11 13:24:44 -0400] shlant: masterkorp: are you looking for how to actually separate cookbooks into repos, or how to handle them being separate?
[2014-03-11 13:25:39 -0400] shlant: CPS: what do you mean by keyword? are you looking for this? http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation
[2014-03-11 13:26:21 -0400] CPS: shlant: yeah, i got some advice that used that shlant but it's not working
[2014-03-11 13:26:22 -0400] CPS: https://gist.github.com/anonymous/9485533
[2014-03-11 13:26:31 -0400] CPS: i think the loop is throwing it off
[2014-03-11 13:27:08 -0400] CPS: in that loop, config is {filename : data}
[2014-03-11 13:27:44 -0400] CPS: but with the lazy eval, it's mixed up, using one filename and another's data
[2014-03-11 13:28:12 -0400] shlant: nick__: take a look at this : http://www.gazzang.com/blog/item/298-zncrypt-chef-cookbook-part-iii
[2014-03-11 13:29:50 -0400] CPS: shlant / coderanger any way to force it to re-evaluate on each iteration?
[2014-03-11 13:31:04 -0400] nick__: shlant: Thanks, I tried something similar but I got a 403 when I tried to save the data bag item
[2014-03-11 13:34:42 -0400] shlant: CPS: I don't think I'd be of any use for that unfortunately :p
[2014-03-11 13:35:44 -0400] masterkorp: shlant: to handle them separatly
[2014-03-11 13:36:17 -0400] carldeantucker: Hey guys from within a recipe that requires a new deb package to be installed on an ubuntu box, what is the best or industry standard way of getting apt to be refreshed before installing the package
[2014-03-11 13:36:19 -0400] carldeantucker: ?
[2014-03-11 13:37:10 -0400] phutch1ns: Hey, anyone had problems when doing package "nginx" for example and it errors becuase it tried to configure and can't so there are unmet dependencies? i've tried --force-yes and that doesn't even seem to work
[2014-03-11 13:37:34 -0400] phutch1ns: carldeantucker: notifies :run, "execute[apt-get update]", :immediately
[2014-03-11 13:37:51 -0400] phutch1ns: carldeantucker: I use that inside my apt_repository or package resource
[2014-03-11 13:38:00 -0400] carldeantucker: phutchins that is grate thanks I will try that now
[2014-03-11 13:38:05 -0400] carldeantucker: great*
[2014-03-11 13:38:08 -0400] phutch1ns: carldeantucker: np
[2014-03-11 13:38:42 -0400] carldeantucker: phutchins have you ran the command the install on the box to figure out what the issue is
[2014-03-11 13:38:43 -0400] shlant: nick__: seems like you would need to supply the server pem/url. Can't find examples of how to do that...
[2014-03-11 13:38:44 -0400] carldeantucker: ?
[2014-03-11 13:39:33 -0400] CPS: shlant: i added lazy to the variables attribute declaration and it compiles now, but it still doesn't work correctly
[2014-03-11 13:39:34 -0400] phutch1ns: carldeantucker: yep, and it worked just fine. I answered the prompt to replace the config file with the DEFAULT of N tho. I think the important error might be "EOF on stdin at conffile prompt"
[2014-03-11 13:39:35 -0400] nick__: shlant:  ok I'll look into that, does that introduce any security issues?
[2014-03-11 13:39:47 -0400] shlant: masterkorp: you would use Berkshelf: http://berkshelf.com/
[2014-03-11 13:39:56 -0400] CPS: it's clear the lazy variables are evaluated only once, regardless of being in the loop and the variable they're based on has changed
[2014-03-11 13:40:24 -0400] carldeantucker: Hmmm these things are a bit of a pain, is it yum or deb?
[2014-03-11 13:40:30 -0400] carldeantucker: yum or apt sorry
[2014-03-11 13:40:37 -0400] carldeantucker: phutchins ^
[2014-03-11 13:41:10 -0400] shlant: nick__: not sure. Depends how you store the pem? It would require an encrypted data bag most likely. All this data bag convolution would make coderanger cringe haha
[2014-03-11 13:41:11 -0400] phutch1ns: carldeantucker: apt. i'm thinking i might have to do a --force-confold
[2014-03-11 13:41:40 -0400] shlant: convolution wah not the right word there haha
[2014-03-11 13:41:47 -0400] carldeantucker: phutchins yeah you can pass those options in fairly easily worth a try :)
[2014-03-11 13:41:54 -0400] phutch1ns: carldeantucker: yeah giving that a shot now
[2014-03-11 13:42:43 -0400] nick__: shlant: ok thanks, I'll look into it, would coderanger suggest a better/different way other than data bags?
[2014-03-11 13:43:38 -0400] shlant: phutch1ns: -o Dpkg::Options::="--force-confold"
[2014-03-11 13:44:36 -0400] shlant: nick__: he doesn't go too much into solutions: https://coderanger.net/2014/02/data-bags/
[2014-03-11 13:44:40 -0400] masterkorp: shlant: lol we use that
[2014-03-11 13:44:47 -0400] masterkorp: nothing like that
[2014-03-11 13:44:54 -0400] masterkorp: i am looking for the CI approach
[2014-03-11 13:45:03 -0400] masterkorp: making multiple repos not a burgen
[2014-03-11 13:45:23 -0400] phutch1ns: shlant: i'm doing it through the package resource so i'm doing options "--force-confold --force-confdef"
[2014-03-11 13:45:42 -0400] phutch1ns: shlant: that should be the equivalent yes?
[2014-03-11 13:46:56 -0400] shlant: phutch1ns: it would be options "-o Dpkg::Options::='force-confold'" i thin
[2014-03-11 13:47:16 -0400] shlant: options attribute just appends to the command i think
[2014-03-11 13:53:38 -0400] fazul: HI
[2014-03-11 13:53:58 -0400] fazul: Could anyone help in learning chef
[2014-03-11 13:54:15 -0400] carldeantucker: fazul: the docs are pretty good
[2014-03-11 13:54:44 -0400] carldeantucker: http://docs.opscode.com/
[2014-03-11 13:55:37 -0400] shlant: fazul: this as well: https://learnchef.opscode.com/
[2014-03-11 13:56:27 -0400] fazul: Sounds good
[2014-03-11 13:56:40 -0400] fazul: let me check it once
[2014-03-11 13:56:42 -0400] benmoss: i'm quite confused on where to store something like "the ip address of another service" in chef
[2014-03-11 13:58:16 -0400] benmoss: data bag that is namespaced by chef_environment? env_run_lists with wrapper cookbooks that just set attributes?
[2014-03-11 13:59:09 -0400] stormerider: benmoss: search based on an attribute for the server in question?
[2014-03-11 13:59:31 -0400] stormerider: TMTOWTDI
[2014-03-11 13:59:48 -0400] benmoss: yeah
[2014-03-11 14:00:09 -0400] benmoss: i'm using chef solo so i believe i am limited in the search game
[2014-03-11 14:00:48 -0400] stormerider: ah, yeah
[2014-03-11 14:00:54 -0400] carldeantucker: chef-solo-search cookbook
[2014-03-11 14:00:54 -0400] benmoss: maybe i will check out this chef-solo-search lib though
[2014-03-11 14:00:55 -0400] carldeantucker: ?
[2014-03-11 14:00:58 -0400] benmoss: yeah
[2014-03-11 14:01:13 -0400] carldeantucker: I use it for testing, seems quite cool
[2014-03-11 14:02:08 -0400] skansky: is it a black and white rule or best practice that devs develope off trunk and no branches?
[2014-03-11 14:02:35 -0400] stormerider: that seems like the opposite of best practice
[2014-03-11 14:02:56 -0400] skansky: i'm coming from an ops POV so i can't tell.. the way I see it, you might want to branch for a specific reason but try to keep one trunk going all the time with little updates continuously
[2014-03-11 14:03:04 -0400] skansky: so that you can continuously build?
[2014-03-11 14:03:45 -0400] skansky: stormerider: well from a devops practice point of view?
[2014-03-11 14:04:16 -0400] skansky: oh crap there's a #devops
[2014-03-11 14:04:43 -0400] stormerider: we create branches, submit PRs, and CI build once merged into the master branch
[2014-03-11 14:05:03 -0400] scottmuc: devops practice relies on large amounts of collaboration. Can't collaborate more than everyone working in trunk
[2014-03-11 14:05:55 -0400] skansky: scottmuc: that seems to sum up what I've heard so far. You can push tools but if people aren't collaborating, if the culture doesn't support it, then you possibly make things worse
[2014-03-11 14:06:31 -0400] skansky: scottmuc: good way to put it... i will steal it!
[2014-03-11 14:06:56 -0400] scottmuc: skansky: yeah, trunk based development is as much a cultural shift as it is a practice. Prepare for battles from those used to playing in isolation in a long lived branch.
[2014-03-11 14:07:13 -0400] scottmuc: skansky: :)
[2014-03-11 14:07:26 -0400] skansky: scottmuc: I feel I have no credibility though, with some devs.
[2014-03-11 14:08:00 -0400] skansky: skansky: I'm from an ops POV so they might not listen and feel i'm intruding on their craft ..which in a way I am, but for the good of the whole.
[2014-03-11 14:08:06 -0400] skansky: oh .. i mean to scottmuc
[2014-03-11 14:08:50 -0400] scottmuc: scottmuc: totally hear you. I've lucky that I work get to work with Jez Humble on occasion. To introduce trunk based development, you have to start small. Pick 1 team that is willing to try it out. Then get the devs to provide feedback on how it's going
[2014-03-11 14:08:53 -0400] scottmuc: lol
[2014-03-11 14:08:56 -0400] scottmuc: I did the same :P
[2014-03-11 14:09:21 -0400] scottmuc: skansky: the results for me are devs going "OMG where did our merging problems go?"
[2014-03-11 14:10:41 -0400] skansky: scottmuc: ok so in that situation, that's one form of a "high trust" setup -- you trust your devs to not pollute trunk for everyone else. if they break trunk, fix it asap
[2014-03-11 14:10:46 -0400] skansky: right?
[2014-03-11 14:11:08 -0400] scottmuc: skansky: yeah, to do TBD you need a good CI process
[2014-03-11 14:11:19 -0400] daxroc: Is the remote_file checksum attribute ignored using not_if , only_if if I set it to an incorrect value there is no attempt to redownload the file.
[2014-03-11 14:12:11 -0400] scottmuc: skansky: and you have to not be afraid of pollution. as much as I love trunk always being buildable, you can't 100% absolutely prevent human error. Things will break, it's how you recover from them that's more important. If you have a broken build that commit will never turn into a release candidate.
[2014-03-11 14:13:17 -0400] scottmuc: skansky: and to keep things on topic, we've done the same with our chef code. small environments mind you
[2014-03-11 14:13:34 -0400] skansky: scottmuc: ok you can say, that's sort of dev's form of prioritizing MTTR over MTBF
[2014-03-11 14:14:25 -0400] scottmuc: skansky: totally. I always get nervous when I see a build that never goes red
[2014-03-11 14:14:43 -0400] skansky: like on the ops side -- worry more about how fast to recover your box versus keeping the box up
[2014-03-11 14:15:01 -0400] daxroc: Here is my example https://gist.github.com/daxroc/9486528
[2014-03-11 14:15:49 -0400] daxroc: Should that cause an attempt to download to the retries count as the checksums will never match.
[2014-03-11 14:16:01 -0400] scottmuc: skansky: yup (fyi I've done ops, and dev). Now I'm just confused all of the time and scream at the sky "how does anything work?!"
[2014-03-11 14:18:09 -0400] scottmuc: skansky: This is a pretty comprehensive blog post on the subject http://paulhammant.com/2013/04/05/what-is-trunk-based-development/
[2014-03-11 14:21:44 -0400] shlant: anyone know if there's a way to get timestamps for each part of a chef run?
[2014-03-11 14:25:29 -0400] srenatus: shlant: there's a report handler showing you how long which resource took
[2014-03-11 14:25:35 -0400] srenatus: shlant: can't remember the details, sorry
[2014-03-11 14:28:16 -0400] shlant: srenatus: i'll poke around
[2014-03-11 14:37:36 -0400] craig: Hello
[2014-03-11 14:37:52 -0400] craig: Had some questions about chef user setup
[2014-03-11 14:38:35 -0400] craig: Does anyone know how to make a hosted account without making a new organization?
[2014-03-11 14:38:47 -0400] craig: I want to be part of an existing organization
[2014-03-11 14:40:06 -0400] craig: In the account creation process, creating a new organization is required, but I just want to be added to an existing one? Anyone know how I can do this?
[2014-03-11 14:58:19 -0400] glen: if i have two recipes setting "node.default['openssh']['server']['subsystem']" which one will matter?
[2014-03-11 14:58:42 -0400] glen: as i tried to swap recipes run order, and still the same one "wins", which makes no sense to me :(
[2014-03-11 14:58:49 -0400] chris613: glen: I beleive it depends on the order of execution, the last one winning. Corrections welcome
[2014-03-11 14:58:51 -0400] chris613: oh. Damn
[2014-03-11 14:59:34 -0400] glen: i even put logging to after line node.default is assigned. and I DO SEE them in different order there
[2014-03-11 14:59:39 -0400] glen: but outcome is still identical
[2014-03-11 15:02:01 -0400] shlant: glen: what are you trying to accomplish with the attributes?
[2014-03-11 15:03:43 -0400] glen: set different "subsystem" value from role or recipe
[2014-03-11 15:04:26 -0400] glen: i think it's called wrapper cookbooks, but i have sshd recipe, which sets some attributes and does require_recipe openssh cookbook
[2014-03-11 15:04:58 -0400] glen: then i have another cookbook, which sets different node.default for the attribute and does require_recipe my wrapper cookbook (which will require_recipe openssh cookbook)
[2014-03-11 15:05:30 -0400] glen: if taking line by line execution, then the assignments are done in right order. first from cookbook1, then from cookbook2
[2014-03-11 15:05:42 -0400] glen: but the value which is in template of openssh cookbook gets always the same value
[2014-03-11 15:06:40 -0400] glen: ah. now i see the problem
[2014-03-11 15:06:49 -0400] glen: added value printout from openssh recipe as well
[2014-03-11 15:07:12 -0400] glen: and the value is "copied" into template resource before the second cookbook has chance to override
[2014-03-11 15:07:45 -0400] glen: the openssh cookbook does in template resource:   variables(:settings => node['openssh']['server'])
[2014-03-11 15:08:07 -0400] glen: i guess its the reason why templates should access node['openssh']['server'] directly?
[2014-03-11 15:09:09 -0400] glen: as i'm not really sure when evaluation of variables occours, does "template ... do varaibles ()" ... get executed immediately?
[2014-03-11 15:09:15 -0400] glen: or in converge phase?
[2014-03-11 15:10:09 -0400] glen: ok. using node.foo directly from template did not improve situation, i.e using this directly:  node['openssh']['server']['subsystem']
[2014-03-11 15:11:17 -0400] shlant: glen: I think your issue is attribute precedence. if you know that a attribute in one recipe should override another, why not use force_default or something?
[2014-03-11 15:12:28 -0400] techminer: There should be an easy answer to this but I'm not seeing it.  I want to create groups on nodes based on role.  If roleA then add group A, if roleB then add groupB.  Is it possible to have a conditional in a recipe based on role?
[2014-03-11 15:12:38 -0400] glen: shlant: no. it's not precedence. i set two values both from recipe, their precedence is equal
[2014-03-11 15:13:11 -0400] glen: node.force_default instead of node.default ?
[2014-03-11 15:13:14 -0400] shlant: glen: and do you not want one to override the other?
[2014-03-11 15:13:18 -0400] shlant: yea
[2014-03-11 15:13:50 -0400] glen: yes, currently i know which one should override. but i think this design is flawed in long term
[2014-03-11 15:14:04 -0400] glen: force defailt did not help
[2014-03-11 15:14:29 -0400] glen: i think the problem is that first cookbook already does require_recipe openssh, and after that setting attributes just no longer matters
[2014-03-11 15:15:18 -0400] techminer: can I use 'only_if role' in a group resource?
[2014-03-11 15:15:37 -0400] glen: http://sprunge.us/jcTg <- perhaps better overview what i'm dealing with
[2014-03-11 15:16:49 -0400] glen: ah. i could use force defautl and change order. trying!
[2014-03-11 15:17:32 -0400] glen: that worked. thanks!
[2014-03-11 15:19:49 -0400] shlant: glen: happy ot help
[2014-03-11 15:20:29 -0400] glen: shlant: yeah, i've loosely trying to figure this out several days already. if i knew internals more would had understood better how to solve it
[2014-03-11 16:13:06 -0400] therealkoopa: Suddenly my knife ec2 server create never returns from "Waiting for instance....", but the ec2 box has been created, and I cna ssh into it using the same keys I told knife ec2 to use... Any idea where I can find logs or clues to debug this?
[2014-03-11 16:18:02 -0400] therealkoopa: It spits out the Public DNS Name and other information, but then it sits there.
[2014-03-11 16:18:31 -0400] cheeseprocedure: therealkoopa: stupid question, but you're able to SSH from the same station you're running knife from?
[2014-03-11 16:18:45 -0400] therealkoopa: cheeseprocedure: Yup
[2014-03-11 16:19:12 -0400] therealkoopa: cheeseprocedure: I thought maybe the new node couldn't talk tot he chef server or something, but other nodes can run 'chef-client' and communicate w/ the chef-server
[2014-03-11 16:19:26 -0400] therealkoopa: cheeseprocedure: this was working, i can't figure out what changed. I wish I could find some useful logs
[2014-03-11 16:38:59 -0400] therealkoopa: However, I used knife ec2 to create the server, the command never returns and it doesn't install the chef client. If I cancel it, then run knife bootstrap on the created ec2 box, it works.
[2014-03-11 16:39:04 -0400] drrk: a
[2014-03-11 16:39:05 -0400] therealkoopa: So I don't understand why knife ec2 is failing
[2014-03-11 16:52:26 -0400] lmickh: is there a way to knife ssh and provide a password (-P option) without it being displayed on the cli?
[2014-03-11 17:00:51 -0400] daos: sethvargo: is there a video of this presentation? https://speakerdeck.com/sethvargo/test-driven-infrastructure-with-chef
[2014-03-11 17:04:53 -0400] sethvargo: Yea, if you want to pay O'Reilly for it :)
[2014-03-11 17:40:18 -0400] fraterlaetus: anyone have any luck creating ohai plugins?
[2014-03-11 17:52:54 -0400] failshell: is it possible to access in a recipe the supports attribute from metadata.rb
[2014-03-11 18:00:48 -0400] phutch1ns: shlant: hey yeah I had to use the -o etc... to pass the options along to dpkg instead of just to apt-get. looks liek that worked. thanks
[2014-03-11 18:01:59 -0400] shlant: phutch1ns: glad to help!
[2014-03-11 18:02:25 -0400] phutch1ns: :)
[2014-03-11 18:14:17 -0400] threescoops: Greetings folks. I suspect I'm missing something fundamental. I've got a conditional and a couple of resources in a recipe included from the default recipe in a cookbook which appears to be triggering, despite the fact that the default recipe is not in the run list or list of recipes for the node. What gives?
[2014-03-11 18:15:37 -0400] threescoops: I'm explicitly another recipe in the same cookbook, but am seeing the code in the default recipe execute.
[2014-03-11 18:17:32 -0400] bmhatfield: You're not accidentally referencing your cookbook by the short name, eg, `include_recipe 'cookbookname'`, which actually invokes 'cookbookname::default'
[2014-03-11 18:17:38 -0400] threescoops: Nope.
[2014-03-11 18:17:45 -0400] bmhatfield: or accidentally referring to a role as a recipe instead?
[2014-03-11 18:17:59 -0400] bmhatfield: eg, a role and a cookbook with the same name?
[2014-03-11 18:18:07 -0400] threescoops: Nope
[2014-03-11 18:19:01 -0400] FireBeyond: I'm trying to figure out where a value is being instantiated from. My memcached cookbook (the vanilla 1.7.0. from opscode) populates memcached memory at 8000.
[2014-03-11 18:19:21 -0400] FireBeyond: I did a recursive search, can't even locate 8000 in the cookbook
[2014-03-11 18:20:09 -0400] FireBeyond: and every attribute either references 64 (MB), or :memory  => node['memcached']['memory'],
[2014-03-11 18:20:27 -0400] tara_h1: there's a great chef-client feature called "--why-run"
[2014-03-11 18:21:10 -0400] tara_h1: https://wiki.opscode.com/display/chef/Whyrun+Testing
[2014-03-11 18:21:20 -0400] tara_h1: might be helpful to you
[2014-03-11 18:21:23 -0400] FireBeyond: thanks, checking that now!
[2014-03-11 18:21:53 -0400] kbarry: is there a
[2014-03-11 18:23:07 -0400] kbarry: sorry. Wanting to see if there is a non-bash method for modifying networkmanagement (I need it turned off)
[2014-03-11 18:26:44 -0400] shlant: can anyone explain to me why a service isn't started with Service "foo" do action :start end or execute "/etc/init.d./foo start", but when I ssh to the node and run /etc/init.d./foo start is works??!!?
[2014-03-11 18:26:51 -0400] shlant: this si driving me crazy
[2014-03-11 18:37:13 -0400] threescoops: I took the route of changing default.rb for now. *eyeroll* *still puzzled*
[2014-03-11 18:38:37 -0400] shadylog: Hiya I have a problem with chef-solo.. I am running chef 11.10.4
[2014-03-11 18:38:50 -0400] shadylog: however I find that this bug still exists:
[2014-03-11 18:38:52 -0400] shadylog: https://tickets.opscode.com/browse/CHEF-2786
[2014-03-11 18:39:29 -0400] shadylog: chef-solo -r http://community.opscode.com/cookbooks/build-essential/versions/1_4_4/downloads
[2014-03-11 18:39:36 -0400] shadylog: always downloads to the parent of the cookbook
[2014-03-11 18:39:47 -0400] shadylog: then extracts in that directory whatever it downloaded
[2014-03-11 18:42:56 -0400] benmoss: chef supports dot notation for accessing node attributes, is this not preferred though?
[2014-03-11 18:47:45 -0400] shadylog_: sorry connection troubles
[2014-03-11 18:47:50 -0400] shadylog_: did anyone say anything?
[2014-03-11 18:48:43 -0400] benmoss: i asked about peoples preferences for/against dot notation
[2014-03-11 18:58:10 -0400] spheromak: benmoss: imo using symbols or strings is better. dot notation can be confusing to new peeps. also there are reall node methods and there are the tattribs.
[2014-03-11 18:58:23 -0400] spheromak: *attribs
[2014-03-11 18:58:29 -0400] benmoss: yeah
[2014-03-11 18:59:09 -0400] benmoss: the reason i like dot notation is mainly the because undefined keys don't throw exceptions with hashes
[2014-03-11 18:59:19 -0400] benmoss: i know about `fetch` but its more verbose
[2014-03-11 19:00:05 -0400] benmoss: would rather have an exception than accidentally write a nil to a template or something and have to figure that out later
[2014-03-11 19:02:01 -0400] Otterley: is anyone aware of a way to require in a package declaration "install /at least/ version X"?
[2014-03-11 19:02:31 -0400] Otterley: Ubuntu/Debian have an irritating practice of keeping only 2 versions of a package around: the one that shipped with the base OS, and the most recent update, if any.
[2014-03-11 19:02:59 -0400] Otterley: this makes it difficult to control package versions with Chef.
[2014-03-11 19:03:18 -0400] Otterley: if the version on the mirror disappears, you have to start all over again.
[2014-03-11 19:04:05 -0400] benmoss: i think not all the providers can do that
[2014-03-11 19:04:30 -0400] benmoss: `yum_package "netpbm >= 10"` works
[2014-03-11 19:04:31 -0400] Otterley: yeah, it may be an apt limitation.
[2014-03-11 19:05:10 -0400] Otterley: why anyone uses Debian/Ubuntu in production, I'll never know.
[2014-03-11 19:06:36 -0400] geggam: ++1 Otterley
[2014-03-11 19:21:00 -0400] sarkis: how can i look up documentation for something like foodcritic?
[2014-03-11 19:21:24 -0400] sarkis: using rdoc/ri?
[2014-03-11 19:23:44 -0400] shlant: sarkis: what do you mean?
[2014-03-11 19:23:46 -0400] shlant: http://acrmp.github.io/foodcritic/?
[2014-03-11 19:28:29 -0400] FireBeyond: So I edited my node using knife, saved the attribute memcached memory. It said it saved. The Chef Web UI shows it. Until chef-client runs on the server, and it seems like it is adjusting the value back?
[2014-03-11 19:28:55 -0400] FireBeyond: but again, nothing in /etc/chef
[2014-03-11 19:29:33 -0400] shlant: FireBeyond: most likely because that value is being changed during the run
[2014-03-11 19:31:01 -0400] shlant: FireBeyond: is it being changed back to 64?
[2014-03-11 19:31:28 -0400] FireBeyond: sure, but if I look at why-run, it tells me something entirely different: it says it WOULD change it back to 64. But when I kill -USR1 chef-client, it doesn't, it is set to 8000
[2014-03-11 19:31:52 -0400] FireBeyond: a value that i can't find anywhere in the cookbook, or indeed the entire chef repo on our server
[2014-03-11 19:32:44 -0400] FireBeyond: http://pastebin.com/CE4Yvag7
[2014-03-11 19:33:26 -0400] FireBeyond: (It also says it would trash the listening address, which doesn't happen, so something else elswhere is overriding - I can't find what though)
[2014-03-11 19:33:50 -0400] sarkis: shlant: can i see the rdoc docs from the command line?
[2014-03-11 19:35:11 -0400] shlant: sarkis: not sure
[2014-03-11 19:42:45 -0400] shlant: hey coderanger, you there?
[2014-03-11 19:43:07 -0400] shlant: can you explain to me why I can't get my service to start on first chef run? https://gist.github.com/MrMMorris/581dbca4b1ce73fdc71c
[2014-03-11 19:43:23 -0400] shlant: i'm just going in circles now
[2014-03-11 19:48:15 -0400] coderanger: shlant: Try action [:enable, :start]
[2014-03-11 19:48:48 -0400] bik: does anyone know the best way to handle a multi-vm vagrant setup with chef search returning the private (eth1) network?
[2014-03-11 19:49:23 -0400] shlant: coderanger: I think I've tried every combination, but I'll double check
[2014-03-11 19:49:45 -0400] tscanausa: bik: you are probably going to need to do some ruby fu
[2014-03-11 19:51:57 -0400] bik: tscanausa: thanks...  I was hoping this was a solved problem at this point
[2014-03-11 20:13:23 -0400] sarkis: so if i have role... which has "monit": { "web_interface": {
[2014-03-11 20:13:34 -0400] sarkis: how do i access that from node[ ]
[2014-03-11 20:13:46 -0400] sarkis: is it node[:monit][:web_interface]?
[2014-03-11 20:15:49 -0400] kbarry: MAbe a little linux help here.
[2014-03-11 20:16:04 -0400] kbarry: We want to configure the resolv.conf file, but are having some trouble.
[2014-03-11 20:16:35 -0400] shlant: coderanger: no luck. the service is enabled, but still not started (up to date)
[2014-03-11 20:17:08 -0400] shlant: and it's the absolute last thing that happens in the run, so nothing would effect it
[2014-03-11 20:17:16 -0400] kbarry: We are actually setting it in the kickstart file, but are having trouble with /etc/resolv.conf.save replacing it. We removed that file, but it keeps reappearing.
[2014-03-11 20:17:27 -0400] kbarry: that is /etc/resolv.conf.save keeps reappearing.
[2014-03-11 20:18:21 -0400] shlant: sarkis: correct
[2014-03-11 20:18:47 -0400] stormerider: kbarry: you may need to uninstall the resolvconf package if you're manually managing the file, depending on your distro
[2014-03-11 20:19:01 -0400] kbarry: Centos
[2014-03-11 20:19:44 -0400] stormerider: so i know i've had to do that on ubuntu, but i've avoided centos for some time now so i can't speak to that
[2014-03-11 20:20:15 -0400] FireBeyond: Bah. Problem solved, errant dev pushing changes to chef without putting them to the repo
[2014-03-11 20:21:24 -0400] stormerider: FireBeyond: bad dev, no cookie
[2014-03-11 20:22:03 -0400] FireBeyond: Next task for dev: commit hooks
[2014-03-11 20:22:07 -0400] kbarry: stormerider: trying to figure out how to uninstall the package,
[2014-03-11 20:22:11 -0400] kbarry: i'm new to linux to be honest,
[2014-03-11 20:22:30 -0400] kbarry: i was thinking yum list resolvconf woul show me if its present
[2014-03-11 20:23:35 -0400] coderanger: shlant: Are you sure the status subcommand returns correctly?
[2014-03-11 20:23:37 -0400] shlant: kbarry: package "foo" do action :purge end
[2014-03-11 20:23:56 -0400] kbarry: shlant: is that how i view the package?
[2014-03-11 20:24:24 -0400] shlant: kbarry: I thought you wanted to remove it
[2014-03-11 20:24:38 -0400] kbarry: i want to see it before i kill it :)
[2014-03-11 20:25:01 -0400] stormerider: rpm -qa | grep -i "blah" will show if blah is installed
[2014-03-11 20:25:21 -0400] stormerider: er grep -i
[2014-03-11 20:26:21 -0400] kbarry: rpm -qa | grep -i "resolvconf"
[2014-03-11 20:26:29 -0400] kbarry: (returns nothing)
[2014-03-11 20:26:40 -0400] kbarry: [b]system-config-network[/b]
[2014-03-11 20:26:50 -0400] kbarry: I see this on a page that may be about my issue
[2014-03-11 20:27:16 -0400] stormerider: http://totalcae.com/blog/2013/06/prevent-etcresolv-conf-from-being-blown-away-by-rhelcentos-after-customizing/ looks relevant, too
[2014-03-11 20:27:35 -0400] CPS: in a template declaration, how do you define more than one helper function?
[2014-03-11 20:27:48 -0400] kbarry: I don't think I have networkmanager installed
[2014-03-11 20:28:06 -0400] kbarry: and it doesnt look like i have resolvconf either
[2014-03-11 20:29:05 -0400] stormerider: then i'm not sure what's going on, but that's probably a better question for #linux or #centos (if one or both exist)
[2014-03-11 20:58:51 -0400] kbarry: Thanks
[2014-03-11 21:26:22 -0400] redondos: will node.set save the attribute to the chef server?
[2014-03-11 21:26:38 -0400] coderanger: redondos: Eventually
[2014-03-11 21:26:39 -0400] coderanger: redondos: That just sets it locally, only saved back to the server if node.save is called, which happens automatically after successful converges
[2014-03-11 21:26:40 -0400] redondos: excellent
[2014-03-11 21:26:40 -0400] redondos: thank you
[2014-03-11 21:27:11 -0400] phantasm66: Howdy Chefs...
[2014-03-11 21:27:15 -0400] phantasm66: I am trying to consolidate recipe code and am wondering if something like this can be done?
[2014-03-11 21:27:16 -0400] phantasm66: http://pastie.org/private/ebn1q8yyty5nxxmc1vigsq
[2014-03-11 21:27:20 -0400] phantasm66: Specifically, using a ruby block (and i don't mean the ruby_block chef resource) *inside* of a resource
[2014-03-11 21:27:33 -0400] phantasm66: i would think that would be okay, because ruby code is simply run during compile phase.. but i've never used ruby code *inside* a recipe's resource block
[2014-03-11 21:27:40 -0400] phantasm66: I'm basically asking for a recipe/code review
[2014-03-11 21:28:07 -0400] davidordave: Anyone ever experience: "error":["Bad checksums!"]  when using berkshelf?
[2014-03-11 21:28:07 -0400] davidordave: well, experience and solve :)
[2014-03-11 21:28:13 -0400] fraterlaetus: wtf? netsplit?
[2014-03-11 21:30:10 -0400] CADBOT: Hi all
[2014-03-11 21:30:45 -0400] CADBOT: Let's say in my cookbook, I am including a recipie from an nginx cookbook
[2014-03-11 21:30:53 -0400] CADBOT: In that nginx cookbok
[2014-03-11 21:30:59 -0400] CADBOT: In attributes
[2014-03-11 21:31:09 -0400] CADBOT: There are attributes that set up things such as the path to install nginx too
[2014-03-11 21:31:28 -0400] CADBOT: However, when I run the recipe from my cookbook
[2014-03-11 21:31:30 -0400] CADBOT: It loses track of these attributes
[2014-03-11 21:31:36 -0400] CADBOT: What's the proper way to resolve this?
[2014-03-11 21:32:04 -0400] CADBOT: I could just copy and paste the attributes from the nginx cookbook into the attributes section of my cookbook, but I feel like there is probably a better way
[2014-03-11 21:34:42 -0400] stormerider: CADBOT: typically you would only adjust the ones you want to change, with node.override[]
[2014-03-11 21:35:24 -0400] CADBOT: I don't want to change any of the attributes in the nginx cookbook, I just want to have them in scope
[2014-03-11 21:36:09 -0400] CADBOT: cat nginx.rb
[2014-03-11 21:36:10 -0400] CADBOT: case node[:platform]
[2014-03-11 21:36:10 -0400] CADBOT: when 'debian','ubuntu'
[2014-03-11 21:36:11 -0400] CADBOT:   default[:nginx][:dir]     = '/etc/nginx'
[2014-03-11 21:36:11 -0400] CADBOT:   default[:nginx][:log_dir] = '/var/log/nginx'
[2014-03-11 21:36:12 -0400] CADBOT:   default[:nginx][:user]    = 'www-data'
[2014-03-11 21:36:12 -0400] CADBOT:   default[:nginx][:binary]  = '/usr/sbin/nginx'
[2014-03-11 21:36:13 -0400] CADBOT: when 'centos','redhat','fedora','amazon'
[2014-03-11 21:36:13 -0400] CADBOT:   default[:nginx][:dir]     = '/etc/nginx'
[2014-03-11 21:36:13 -0400] CADBOT:   default[:nginx][:log_dir] = '/var/log/nginx'
[2014-03-11 21:36:14 -0400] CADBOT:   default[:nginx][:user]    = 'nginx'
[2014-03-11 21:36:14 -0400] CADBOT:   default[:nginx][:binary]  = '/usr/sbin/nginx'
[2014-03-11 21:36:34 -0400] CADBOT: and in my cookbooks directory I have the nginx cookbook and my-cookbook
[2014-03-11 21:36:47 -0400] CADBOT: in my cookbook's default recipe I include nginx
[2014-03-11 21:36:54 -0400] CADBOT: include_recipie 'nginx'
[2014-03-11 21:37:01 -0400] CADBOT: Which triggers the default.rb of nginx
[2014-03-11 21:37:06 -0400] CADBOT: however, there is where it breaks
[2014-03-11 21:37:20 -0400] CADBOT: It attempts to use the node[:nginx][:dir] attribute
[2014-03-11 21:37:25 -0400] CADBOT: But breaks because it can't find it
[2014-03-11 21:44:48 -0400] dyer: is there a way to find the version of chef from within the recipe ?
[2014-03-11 21:45:40 -0400] CADBOT: Oh, I think I just need to use include_attribute
[2014-03-11 21:46:59 -0400] coderanger: dyer: Chef::VERSION
[2014-03-11 21:47:18 -0400] dyer: word
[2014-03-11 21:47:18 -0400] dyer: thanks
[2014-03-11 21:53:24 -0400] cheeseplus: since I'm running into a wall: anything known weird with the package resource for FreeBSD?
[2014-03-11 21:53:55 -0400] cheeseplus: keep getting a "NoMethodError: undefined
[2014-03-11 21:53:56 -0400] cheeseplus:  method `split' for nil:NilClass" using the package resource
[2014-03-11 21:55:23 -0400] coderanger: cheeseplus: Want to post the full trace?
[2014-03-11 21:55:33 -0400] coderanger: I know nothing of FBSD+Chef, but I can look at the code at least :)
[2014-03-11 21:57:40 -0400] cheeseplus: coderanger: https://gist.github.com/9495993
[2014-03-11 21:57:48 -0400] cheeseplus: trying to add freebsd support to our cookbook
[2014-03-11 21:59:56 -0400] coderanger: cheeseplus: I think, if I'm reading this correctly, that means the file source you gave it wasn't found
[2014-03-11 22:00:56 -0400] coderanger: cheeseplus: The way that would happen is if Dir["#{@new_resource.source}/#{@current_resource.package_name}*"][-1].to_s == ''
[2014-03-11 22:02:01 -0400] bettyclamp: Anyone know how to get the jenkins cookbook to authenticate. I followed the instructions at https://github.com/opscode-cookbooks/jenkins#authentication but get this error from a Groovy script: "hudson.security.AccessDeniedException2: anonymous is missing the Overall/RunScripts permission"
[2014-03-11 22:02:02 -0400] coderanger: source should probably just be set to the folder that contains the package file
[2014-03-11 22:02:03 -0400] cheeseplus: coderanger: on a call right now but I'll gist up the recipe
[2014-03-11 22:02:11 -0400] coderanger: cheeseplus: I can see enough in the error :-)
[2014-03-11 22:02:19 -0400] coderanger: cheeseplus: You have source "/tmp/kitchen/cache/riak-1.4.8-FreeBSD-amd64.tbz"
[2014-03-11 22:02:27 -0400] coderanger: cheeseplus: Should probably be source "/tmp/kitchen/cache"
[2014-03-11 22:02:57 -0400] cheeseplus: coderanger: hrm, odd
[2014-03-11 22:03:38 -0400] coderanger: cheeseplus: Yeah, this is funky code
[2014-03-11 22:03:51 -0400] cheeseplus: coderanger: https://gist.github.com/anonymous/9496098#file--L55
[2014-03-11 22:04:17 -0400] cheeseplus: just added a when for FreeBSD but it fails out where say, the Fedora build works
[2014-03-11 22:04:19 -0400] coderanger: cheeseplus: Yeah, drop the package_file in the source
[2014-03-11 22:04:47 -0400] cheeseplus: then how do I tell it the package? also why is it working for other plats? ;)
[2014-03-11 22:05:03 -0400] cheeseplus: (on call so I'll be a bit before circling around)
[2014-03-11 22:05:07 -0400] coderanger: cheeseplus: It internally does sourcepath/name* to find the package
[2014-03-11 22:05:23 -0400] coderanger: Which seems like a bad idea IMO, but maybe thats a FBSD-ism?
[2014-03-11 22:06:50 -0400] coderanger: cheeseplus: Yeah, just saying it seems like the FBSD package provider might not be well used for non-ports stuff
[2014-03-11 22:07:08 -0400] cheeseplus: trolololol
[2014-03-11 22:07:25 -0400] cheeseplus: just want to "pkg_add -r URL"
[2014-03-11 22:07:44 -0400] coderanger: cheeseplus: You can do that more directly, just give the URL as the source
[2014-03-11 22:07:51 -0400] coderanger: no need for the remote_file
[2014-03-11 22:08:16 -0400] cheeseplus: I tried otherwise and hit a different error, let me see what it complains about
[2014-03-11 22:11:07 -0400] cheeseplus: coderanger: pkg_add: unable to fetch 'http://s3.amazonaws.com/downloads.basho.com/riak/1.4/1.4.8/freebsd/9/riak-1.4.8-FreeBSD-amd64.tbz/pub/FreeBSD/ports/amd64/packages-9.2-release/Latest/riak.tbz' by URL
[2014-03-11 22:11:17 -0400] cheeseplus: if I set source to the URL
[2014-03-11 22:11:47 -0400] coderanger: cheeseplus: Thats an error from pkg_add itself, so no idea there :)
[2014-03-11 22:12:25 -0400] cheeseplus: yea chef is doing something with that source URL and adding junk to it
[2014-03-11 22:12:55 -0400] coderanger: cheeseplus: Add, https://github.com/opscode/chef/blob/master/lib/chef/provider/package/freebsd.rb#L123 is what it runs
[2014-03-11 22:14:44 -0400] dgarstang: Has anyone ever gotten around the issue of using chef for deployments by having a git submodule in the app of a chef recipe, and then running chef solo against it locally when a package is installed? I'm prolly getting a lot of blank stares right now...
[2014-03-11 22:15:40 -0400] coderanger: dgarstang: submodules are notoriously icky, so they don't get used much
[2014-03-11 22:15:52 -0400] dgarstang: coderanger: I heard that.
[2014-03-11 22:17:28 -0400] j^2: hey, i'm trying to use the cron resource
[2014-03-11 22:17:31 -0400] j^2: can i use:  hour "04,13,21" ?
[2014-03-11 22:17:42 -0400] j^2: or do i need to add three entries?
[2014-03-11 22:18:43 -0400] stormerider: that should be fine, i believe
[2014-03-11 22:18:55 -0400] j^2: nice thanks
[2014-03-11 22:19:10 -0400] stormerider: i'm pretty sure it allows */2 so i'd imagine it allows that as well
[2014-03-11 22:20:34 -0400] j^2: stormerider: :D
[2014-03-11 22:25:26 -0400] law: hey all, I tried some judicious Googling for this, but haven't found anything - when is Chef10 expected to go EOL?
[2014-03-11 22:25:39 -0400] coderanger: law: I don't think there is a clear deadline
[2014-03-11 22:25:53 -0400] coderanger: law: The possibly cynical answer is "when major paying customers stop using it"
[2014-03-11 22:26:32 -0400] law: awesomesauce
[2014-03-11 22:27:28 -0400] law: fair enough
[2014-03-11 22:27:33 -0400] law: err, wrong window, sorry
[2014-03-11 22:39:04 -0400] dgarstang: does anyone have idea how I might write a chef cookbook such that it could be run as part of a chef run, or from chef-solo?
[2014-03-11 22:41:05 -0400] coderanger: dgarstang: You can use Chef::Config[:solo] to check if you are running in solo
[2014-03-11 22:42:02 -0400] dgarstang: coderanger: Actually, i guess this isn't a chef question per se. It's more about how I maintain one cookbook code base between the chef recipe and the app that might be deployed with chef-solo....
[2014-03-11 22:42:34 -0400] coderanger: dgarstang: Just use berkshelf to manage things in both cases
[2014-03-11 22:42:46 -0400] coderanger: You end up with a fairly unified workflow
[2014-03-11 22:42:51 -0400] dgarstang: coderanger: Well the app isn't a chef cookbook.
[2014-03-11 22:42:52 -0400] coderanger: just berks upload vs. berks vendor
[2014-03-11 22:43:12 -0400] coderanger: dgarstang: Don't store cookbook code and app code together
[2014-03-11 22:43:20 -0400] coderanger: they are separate projects
[2014-03-11 22:43:34 -0400] dgarstang: coderanger: Right. so.. running berkshelf inside the app wouldn't make sense
[2014-03-11 22:43:46 -0400] coderanger: Sure it would, include a Berksfile with the app
[2014-03-11 22:44:00 -0400] coderanger: Which pulls in whatever cookbooks you need
[2014-03-11 22:44:08 -0400] dgarstang: coderanger: oh, interesting.
[2014-03-11 22:44:10 -0400] coderanger: Just the same as Gemfile or requirements.txt
[2014-03-11 22:44:18 -0400] coderanger: It just won't have a metadata line in it
[2014-03-11 22:44:28 -0400] dgarstang: *head explodes*
[2014-03-11 22:44:33 -0400] jtimberman: :)
[2014-03-11 22:53:23 -0400] dgarstang: I'm a bit confused. So, berks install will install cookbooks to ~/.berkshelf....
[2014-03-11 22:53:51 -0400] dgarstang: How do I err, integrate that, with the app?
[2014-03-11 22:56:10 -0400] coderanger: dgarstang: You would use berks vendor to generate a folder of cookbooks and then run chef-solo against that folder
[2014-03-11 22:56:40 -0400] dgarstang: coderanger: Hm, ok, i just installed berkshelf and there's no 'vendor' in the help output
[2014-03-11 22:56:56 -0400] coderanger: dgarstang: Which version are you using
[2014-03-11 22:56:58 -0400] dgarstang: 'Could not find command "vendor".'
[2014-03-11 22:57:02 -0400] coderanger: berks 2 called it something different
[2014-03-11 22:57:17 -0400] dgarstang: coderanger: 'Berkshelf (2.0.14)'
[2014-03-11 22:57:25 -0400] dgarstang: installed from gem just now
[2014-03-11 22:57:26 -0400] Majost: So I wrote a heavyweight provider to extend/subclass the apt provider
[2014-03-11 22:57:39 -0400] Majost: but I am having issues calling it directly
[2014-03-11 22:57:51 -0400] coderanger: dgarstang: You might want to install the 3.x beta, but up to you
[2014-03-11 22:58:01 -0400] Majost: https://github.com/rapid7-cookbooks/schroot/blob/master/libraries/schroot_package.rb#L64
[2014-03-11 22:58:08 -0400] dgarstang: coderanger: kk, thanks
[2014-03-11 22:58:24 -0400] Majost: I can do: package 'blah' do ... and set the provider in that context
[2014-03-11 22:58:24 -0400] coderanger: dgarstang: I think in 2.x it was berks install --path or something
[2014-03-11 22:58:49 -0400] Majost: but "schroot_package 'build-essential' do" results in a NoMethodError
[2014-03-11 22:59:02 -0400] Majost: and I am not sure what I am missing here
[2014-03-11 23:00:21 -0400] dgarstang: Ok, obviousl I'm stupid. I'm at https://github.com/berkshelf/berkshelf and it says to install use 'gem install berkshelf' which gets me version 2, not what's on github.
[2014-03-11 23:03:01 -0400] stormerider: dgarstang: i think you need to do gem install berkshelf --pre or something like that to get beta releases
[2014-03-11 23:03:30 -0400] Majost: Do I need to add 'provides :schroot_package, :on_platforms => [:debian, :ubuntu]' to the resource?
[2014-03-11 23:03:38 -0400] Majost: it seems redundant to me
[2014-03-11 23:04:39 -0400] dgarstang: stormerider: yep. thanks. write that one down.
[2014-03-11 23:05:01 -0400] shlant: coderanger: sorry for the delay. When I run /etc/init.d/foo status it gives me Usage: /etc/init.d/foo {start|stop|restart|reload}
[2014-03-11 23:05:16 -0400] shlant: no actual status
[2014-03-11 23:06:09 -0400] dgarstang: 'Your Berksfile does not define any API sources! You must define at least one source in order to download cookbooks.'... I'm getting them from git? Wut.
[2014-03-11 23:07:17 -0400] dgarstang: going back to 2.
[2014-03-11 23:09:45 -0400] Majost: https://gist.github.com/rhass-r7/a554832d0a20a4b0be56
[2014-03-11 23:09:56 -0400] Majost: So that  is the full error
[2014-03-11 23:10:36 -0400] Majost: Which isn't a problem when I use 'package' and ' provider Chef::Provider::Package::Apt::Schroot'
[2014-03-11 23:10:59 -0400] Majost: which make sense for why the latter works
[2014-03-11 23:11:58 -0400] Majost: But I cant see what I am doing wrong when comparing from what I can see in the Apt resource
[2014-03-11 23:17:17 -0400] dgarstang: SO... coderanger or anyone... using berkshelf to grab chef dependancies for an app, that works, but this is on a build box.
[2014-03-11 23:17:33 -0400] dgarstang: so, if I run chef here, it's too early in the process to know if it's dev/stage/prod etc
[2014-03-11 23:19:43 -0400] Majost: dgarstang: I am not sure about how your stuff is setup... but the way I handle different dependencies in different environments is to have different versions of the cookbook
[2014-03-11 23:20:04 -0400] Majost: So for example, staging and prod will be using v1.0
[2014-03-11 23:20:20 -0400] Majost: and dev and local will be 1.1 or later
[2014-03-11 23:20:51 -0400] flaccid_: i just use different Cheffile with librarian-chef, i assume you could do the same with different Berksfile
[2014-03-11 23:20:53 -0400] dgarstang: Majost: it's more about config data in different environments. I could build one packagr per env, but it would be better to build one app and when package is deployed, have it do the subst based on an input
[2014-03-11 23:21:44 -0400] flaccid_: dgarstang: is this wich chef-client and chef server?
[2014-03-11 23:22:25 -0400] Majost: Even if it is with solo, you can still have data bags which contain values specific to each env
[2014-03-11 23:22:44 -0400] dgarstang: flaccid_: Sure. I was trying to come up with a process whereby an app could be deployed with a chef recipe run from chef-client, OR from chef-solo. I'm not explaining this right
[2014-03-11 23:22:53 -0400] Majost: coderanger will probably disagree on that one, as data bags in general have some issues... but its a working solution
[2014-03-11 23:23:11 -0400] flaccid_: i don't think the problem is clear. you can certainly change the node attributes
[2014-03-11 23:23:28 -0400] coderanger: Majost: trolololol
[2014-03-11 23:23:32 -0400] Majost: haha
[2014-03-11 23:23:38 -0400] dgarstang: here we go again.
[2014-03-11 23:24:00 -0400] dgarstang: coderanger: let it be known I was asking questions, and you started getting rude
[2014-03-11 23:24:40 -0400] coderanger: dgarstang: ? That was a comment to Majost as they were poking fun at my recent rantings re: databags
[2014-03-11 23:24:57 -0400] dgarstang: coderanger: sorry, assumed it was directed to me
[2014-03-11 23:26:44 -0400] dgarstang: Problem, y u so hard to encapsulate?
[2014-03-11 23:29:42 -0400] dgarstang: maybe... I could use chef-solo on the build box to generate config for all environments, and build separate packages for each...
[2014-03-11 23:34:25 -0400] coderanger: dgarstang: What about the app needs to be different per-env?
[2014-03-11 23:34:30 -0400] coderanger: Is it just the config files?
[2014-03-11 23:34:39 -0400] dgarstang: coderanger: Yah
[2014-03-11 23:35:03 -0400] coderanger: dgarstang: Okay, so if you want to do Really Really Baked stuff, where there is no chef at run time
[2014-03-11 23:35:14 -0400] coderanger: take a look at the Netflix Bakery project
[2014-03-11 23:35:25 -0400] coderanger: They basically do what you describe, separate builds for each env
[2014-03-11 23:35:36 -0400] coderanger: it can get very unwieldy though
[2014-03-11 23:35:41 -0400] dgarstang: coderanger: That's not what I want. :)
[2014-03-11 23:35:57 -0400] dgarstang: coderanger: but, if chef-solo runs on the build box, that's what you get
[2014-03-11 23:36:29 -0400] flaccid_: chef uses node attributes generally consumed by cookbook templates for config files
[2014-03-11 23:36:42 -0400] coderanger: dgarstang: You would need to split up your process then, build time vs run time
[2014-03-11 23:37:07 -0400] dgarstang: What I am trying to get to, is a package that is installed, and after the package is installed, a post install script templates the correct values based on environment.
[2014-03-11 23:37:24 -0400] dgarstang: that post-install script could run chef solo I suppose.
[2014-03-11 23:37:36 -0400] dgarstang: .... use it as a glorified templater
[2014-03-11 23:37:39 -0400] flaccid_: set the node attributes on the node as desired, solved.
[2014-03-11 23:38:06 -0400] dgarstang: flaccid_: and run chef-solo?
[2014-03-11 23:38:14 -0400] flaccid_: sure
[2014-03-11 23:38:48 -0400] dgarstang: so the cookbook would be built with the app, and deployed with it, and chef-solo run against that
[2014-03-11 23:39:12 -0400] flaccid_: the cookbook should deploy and configure the app
[2014-03-11 23:39:17 -0400] flaccid_: run by chef
[2014-03-11 23:39:21 -0400] dgarstang: flaccid_: Noooo.
[2014-03-11 23:39:39 -0400] dgarstang: flaccid_: Trying not to use chef as a deployment strategy for our custom apps.
[2014-03-11 23:39:45 -0400] coderanger: dgarstang: Our solution to this was to do the build in omnibus, not chef
[2014-03-11 23:39:49 -0400] flaccid_: then you're in the wrong place.
[2014-03-11 23:39:52 -0400] coderanger: chef just installs the package
[2014-03-11 23:40:16 -0400] dgarstang: flaccid_: I thought even here, that the consensus was that chef wasn't the best tool for deployment of proprietary in house code.
[2014-03-11 23:40:21 -0400] redondos: `knife search node ...' works from the command line but if tried from chef-shell or from a cookbook, it tries to connect to localhost instead of the server specified in client.rb (knife.rb?)
[2014-03-11 23:40:25 -0400] redondos: what is the right way of doing this?
[2014-03-11 23:40:47 -0400] redondos: i want my cookbook to use the results of a search(..) to populate a file
[2014-03-11 23:41:16 -0400] flaccid_: dgarstang: thats a huge blanket statement. people deploy many different things with chef including prop stuff
[2014-03-11 23:41:38 -0400] dgarstang: flaccid_: the problem with chef as a deployment methodology too (well one of the issues) is that the developers aren't using chef. Their environments are different. If there was a package that templated the values, all they have to do is fill those in and deploy the app.
[2014-03-11 23:41:47 -0400] coderanger: redondos: How are you running chef?
[2014-03-11 23:41:56 -0400] redondos: chef-client
[2014-03-11 23:42:12 -0400] coderanger: redondos: Hmm, it should be using the same API server as the rest of chef-client then
[2014-03-11 23:42:13 -0400] redondos: chef-shell should yield the same results, correct?
[2014-03-11 23:42:21 -0400] coderanger: redondos: chef-shell -z should
[2014-03-11 23:42:24 -0400] dgarstang: flaccid_: True. the consensus around here, from experience is that chef isn't the best tool for this
[2014-03-11 23:42:24 -0400] flaccid_: dgarstang: its not hard to use -j option with chef-solo and provide a node.json with the env
[2014-03-11 23:42:26 -0400] redondos: ah
[2014-03-11 23:42:39 -0400] dgarstang: flaccid_: for what purpose?
[2014-03-11 23:42:50 -0400] flaccid_: dgarstang: its silly to generalize like that. i have no idea what specific problem there is with your software and chef
[2014-03-11 23:42:50 -0400] redondos: yes, that works
[2014-03-11 23:42:55 -0400] redondos: thanks again coderanger
[2014-03-11 23:43:03 -0400] flaccid_: dgarstang: to set the node attributes you want for you dev and to solve your problem.
[2014-03-11 23:43:19 -0400] dgarstang: flaccid_: I'm not generalising because I'm talking about our specific use case. For us, chef isn't the best tool for this.
[2014-03-11 23:43:30 -0400] flaccid_: dgarstang: we don't know why, thus you are generalizing
[2014-03-11 23:44:34 -0400] dgarstang: it'd be a whole lot easier if the developers where chef savvy
[2014-03-11 23:44:48 -0400] flaccid_: your problem sounds more like the devops pardigm
[2014-03-11 23:44:53 -0400] flaccid_: *paradigm
[2014-03-11 23:44:54 -0400] dgarstang: but, unfortunately, we have to work with the lowest common denominator.
[2014-03-11 23:45:01 -0400] flaccid_: thats an organisational issue
[2014-03-11 23:45:28 -0400] dgarstang: flaccid_: Gotta work within the constraints
[2014-03-11 23:45:37 -0400] flaccid_: nah, gotta change the organisation
[2014-03-11 23:45:45 -0400] dgarstang: flaccid_: hah, right
[2014-03-11 23:45:48 -0400] flaccid_: or just tell them to deploy their own environments
[2014-03-11 23:46:03 -0400] dgarstang: flaccid_: 'git clone'
[2014-03-11 23:46:10 -0400] flaccid_: good luck
[2014-03-11 23:46:13 -0400] dgarstang: 'pip install'
[2014-03-11 23:46:21 -0400] dgarstang: anyway...
[2014-03-11 23:47:01 -0400] daxroc: flaccid_: it's that easy&&hard "change the organisation" :|
[2014-03-11 23:48:04 -0400] flaccid_: daxroc: i know how it is, but #chef isn't really here to solve business/org problems
[2014-03-11 23:48:47 -0400] dgarstang: flaccid_: I wasn't asking you to solve business problems. You asserted we had a business problem. I was asking for advice within the constraints of our business envronment.
[2014-03-11 23:48:58 -0400] daxroc: I totally agree.
[2014-03-11 23:49:20 -0400] flaccid_: dgarstang: sounds like the same thing to me :)
[2014-03-11 23:51:32 -0400] daxroc: coderanger: I'm playing a little with the 'global' scope libraries. Just curious, I'm wanting to pass the function for use in a lazy attribute, is that sane / doable ?
[2014-03-11 23:51:48 -0400] coderanger: daxroc: Sure
[2014-03-11 23:51:52 -0400] coderanger: should work fine
[2014-03-11 23:52:30 -0400] daxroc: Comes back with undefined method `getSHA256' for Chef::Resource::Execute
[2014-03-11 23:54:06 -0400] coderanger: daxroc: pastebin the code?
[2014-03-11 23:56:49 -0400] daxroc: coderanger: https://gist.github.com/daxroc/573558207f45d0c6375b
[2014-03-11 23:57:41 -0400] daxroc: its a little raw..
[2014-03-11 23:57:46 -0400] coderanger: daxroc: ahh yeah, you can't call that directly from a lazy
[2014-03-11 23:58:18 -0400] coderanger: daxroc: https://github.com/balanced-cookbooks/citadel/blob/master/libraries/default.rb#L61-L63
[2014-03-11 23:58:29 -0400] coderanger: :-)
