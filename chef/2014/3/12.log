[2014-03-12 00:01:39 -0400] daxroc: coderanger: appreciate it
[2014-03-12 00:02:21 -0400] flaccid_: coderanger: looks like this webtrends rundeck cookbook needs chef server. do you know of one that doesn't ?
[2014-03-12 00:02:31 -0400] cheeseplus: coderanger: so got back to it and if I set package_name explicitly I get closer: https://github.com/opscode/chef/blob/master/lib/chef/provider/package/freebsd.rb#L123
[2014-03-12 00:02:50 -0400] cheeseplus: it seems that it should be able to take a URL there but errors saying I need to provide a package name
[2014-03-12 00:02:53 -0400] coderanger: flaccid_: No idea, the one I'm starting from is preistjim's but it needs a lot of love
[2014-03-12 00:03:06 -0400] shlant: coderanger: any thoughts on my service not starting issue?
[2014-03-12 00:03:26 -0400] shlant: When I run /etc/init.d/foo status it gives me Usage: /etc/init.d/foo {start|stop|restart|reload}
[2014-03-12 00:03:28 -0400] coderanger: shlant: Nothing off hand, double check the return code of `service <thing> status` though
[2014-03-12 00:03:51 -0400] coderanger: shlant: Ahh, so the fallback is based on proc name
[2014-03-12 00:04:06 -0400] coderanger: shlant: Check if any process is running that has the given service name as a substring
[2014-03-12 00:04:18 -0400] flaccid_: coderanger: ok cool, i'll give that one a try cheers
[2014-03-12 00:04:24 -0400] stormerider: it's probably easier to fix the init script to support that parameter
[2014-03-12 00:04:40 -0400] coderanger: Also yes, the fallback of scraping proc names is almost always wrong >_<
[2014-03-12 00:04:44 -0400] shlant: coderanger: would that not show up from a ps -ef | grep foo?
[2014-03-12 00:05:00 -0400] coderanger: shlant: try `pgrep -lf foo`
[2014-03-12 00:05:26 -0400] coderanger: Sorry everyone, need to focus on writing slides
[2014-03-12 00:05:36 -0400] coderanger: hour until curtain time :)
[2014-03-12 00:05:39 -0400] shlant: coderanger: yea it returns nuthin
[2014-03-12 00:05:59 -0400] coderanger: shlant: Just dive in to the provider code you are using and see what it runs to check things
[2014-03-12 00:06:29 -0400] stormerider: shlant: if you fix it to support status, you'll probably fix the starting issue as a byproduct
[2014-03-12 00:08:03 -0400] shlant: stormerider: would that be an init script issue?
[2014-03-12 00:10:42 -0400] stormerider: shlant: right
[2014-03-12 00:21:32 -0400] flaccid_: coderanger: this one can do chef solo, but doesn't appear to create the rundeck user before it does the template for framework.properties
[2014-03-12 00:21:36 -0400] flaccid_: i'll try master version
[2014-03-12 00:21:52 -0400] coderanger: flaccid_: Heh, one of my coworkers just submitted a patch for that
[2014-03-12 00:22:20 -0400] flaccid_: coderanger: ah coolio, i'll see if i can find it
[2014-03-12 00:23:19 -0400] flaccid_: coderanger: i see the author, is now saying why? i'll comment on pr #2
[2014-03-12 00:28:27 -0400] flaccid_: coderanger: ok i updated that. logical error for sure
[2014-03-12 00:30:17 -0400] coderanger: flaccid_: Sorry, can't help with now, writing time
[2014-03-12 00:30:29 -0400] flaccid_: coderanger: nothing to help with br0
[2014-03-12 00:44:38 -0400] cheeseplus: coderanger: got it working with Pete Cheslock's help - https://gist.github.com/petecheslock/9498210#file-also-works
[2014-03-12 00:45:08 -0400] coderanger: cheeseplus: \m/
[2014-03-12 00:45:13 -0400] cheeseplus: apparently the providers work differently with respect to the source attribute...
[2014-03-12 00:45:19 -0400] cheeseplus: sigh, abstraction, sigh
[2014-03-12 00:46:16 -0400] coderanger: cheeseplus: There is fine line for leaky abstractions, and sometimes you jump over that line and just shit all over everything :)
[2014-03-12 00:46:33 -0400] cheeseplus: now I just have to make smartOS play nice with test-kitchen and I'll round out the esoteric OS's we support
[2014-03-12 00:46:41 -0400] coderanger: cheeseplus: One downside from my reading of that code, if you use an HTTP URL it will run pkg_add every time
[2014-03-12 00:46:42 -0400] cheeseplus: coderanger: such truth
[2014-03-12 00:47:22 -0400] cheeseplus: coderanger: yea, I was trying to do like the other providers where I download via remote-file and then call the package locally
[2014-03-12 00:47:53 -0400] cheeseplus: now that I know what format it likes I may play with it a bit to make it not execute everytime
[2014-03-12 00:48:23 -0400] cheeseplus: either way, my caremad colossus of the day has been slain
[2014-03-12 00:48:31 -0400] cheeseplus: now it is time for the drinking
[2014-03-12 00:49:22 -0400] coderanger: cheeseplus: Enjoy!
[2014-03-12 00:49:43 -0400] coderanger: I have to do one slide every 10 seconds
[2014-03-12 00:50:24 -0400] cheeseplus: coderanger: good luck good sir!
[2014-03-12 00:50:42 -0400] flaccid_: spritz it
[2014-03-12 00:52:20 -0400] stormerider: flaccid_: hah
[2014-03-12 01:21:24 -0400] moreandres: Hi, I need help with the following: I got application_nodejs depending on nodejs::default, and I would like to change that to nodejs::install_from_package
[2014-03-12 01:21:34 -0400] moreandres: is there a way to override include_dependency calls?
[2014-03-12 01:22:13 -0400] moreandres: I'm building a cookbook for my application and I would like to avoid customization on how application_nodejs includes nodejs
[2014-03-12 02:06:14 -0400] rb1980: OMG I am totally stumped trying to google this, if anyone can help:
[2014-03-12 02:06:22 -0400] rb1980: knife search has option: -o SORT, --sort SORT The order in which search results will be sorted.
[2014-03-12 02:06:30 -0400] rb1980: how the HECK do you use that?
[2014-03-12 02:07:06 -0400] rb1980: my results always come back in strange order (I want sorted by id)
[2014-03-12 02:09:26 -0400] rb1980: sorry, not id but name or fqdn actually
[2014-03-12 02:25:39 -0400] flaccid_: coderanger: seem what you mean now with this cookbook, i guess just work on each issue as it arises
[2014-03-12 02:40:32 -0400] aslaen: If a bootstrap fails, what's the correct way to 'retry' ?
[2014-03-12 02:41:06 -0400] aslaen: node is already registered with Chef, but role runlist fails.  Is running chef-client the best way to retry?
[2014-03-12 02:50:13 -0400] manfred: so, knife bootstrap should just set it up so that chef-client can run... if it is bootstrapped, and you tried adding a runlist as part of the bootstrap, then yeah it is just a matter of running chef-client again
[2014-03-12 02:50:22 -0400] manfred: (i use knife ssh to do that when using chef)
[2014-03-12 02:53:43 -0400] aslaen: manfred thanks
[2014-03-12 03:01:58 -0400] mjuszczak: I'm trying to understand the berkshelf method and how we would implement one of our applications.  I know we create a "roles" repo which has a recipe called "foo application server".  Inside that, it only includes a run list of recipes to run.  If part of that was custom code AND MySQL, would I include both the custom code recipe and MySQL recipe in there?  Or do I create an application level cookbook too that has a recipe called "foo::application_se
[2014-03-12 03:27:24 -0400] Majost_: mjuszczak, berkshelf kinda ignores roles for the most part in favor of 'wrapper cookbooks'
[2014-03-12 03:28:46 -0400] Majost_: For example... if your application server is a tomcat server with some war file deployed
[2014-03-12 03:29:25 -0400] Majost_: you would write a wrapper cookbook which depends on the tomcat cookbook, and deploys your war file(s)
[2014-03-12 03:30:33 -0400] flaccid_: people are tending to prefix the name of wrapper cookbooks with their org name. i think thats not right, i still believe that they should be named semantically for generic use, e.g. the app name or what the overall solution is that it provides
[2014-03-12 03:32:38 -0400] Majost_: flaccid_, I think both arguments are valid. I find that wrappers which are org specific tend to get cluttered with a bunch of stuff which should be separated out into different cookbooks
[2014-03-12 03:34:34 -0400] flaccid_: yeah and say you do myfooorg-postfix. that to me looks like you have created a cookbook for your fork or version of postfix!
[2014-03-12 03:37:06 -0400] Majost_: thats not necessarily bad though... especially if you have many postgres instances for different applications which use the same tuning/config -- it promotes reuse
[2014-03-12 03:37:58 -0400] Majost_: It is when it is an actual fork of postgres where things get ugly
[2014-03-12 03:39:48 -0400] flaccid_: the original cookbooks don't need wrapper in that case
[2014-03-12 03:40:58 -0400] Majost_: Why not? If you have different wrappers which use postgres and duplicate some of the same exact settings; does it not make sense to just make a very small postgresql wrapper cookbook and just depend on it?
[2014-03-12 03:41:54 -0400] scalp42: just make sure to lock the postgres metadata in your wrapper cookbook
[2014-03-12 03:42:10 -0400] flaccid_: it makes sense to use the original cookbook and set the node attributes on the node as desired
[2014-03-12 03:43:21 -0400] Majost_: If you have 20 postgres nodes... that doesn't scale well.
[2014-03-12 03:44:06 -0400] flaccid_: knife works fine with one command
[2014-03-12 03:44:25 -0400] flaccid_: i'd argue that creating 20 separate cookbooks doesn't scale at all
[2014-03-12 03:44:38 -0400] Majost_: I am in the camp of making changes which are versioned
[2014-03-12 03:45:27 -0400] Majost_: I also am not suggesting 20 different postgres cookbooks
[2014-03-12 03:46:02 -0400] flaccid_: i don't really understand what a wrapper cookbook would actually solve or change here
[2014-03-12 03:46:11 -0400] Majost_: but one wrapper which would set things, like pg_hba.conf values, for all of them.
[2014-03-12 03:47:07 -0400] flaccid_: node attributes
[2014-03-12 03:51:37 -0400] Majost_: now add a node dynamically
[2014-03-12 03:52:02 -0400] flaccid_: what do you mean by dynamically?
[2014-03-12 03:52:12 -0400] flaccid_: knife bootstrap -j node.json
[2014-03-12 03:52:19 -0400] Majost_: postgresql is not the best example for elasticity
[2014-03-12 03:52:25 -0400] flaccid_: or use databags, environments etc.
[2014-03-12 03:52:40 -0400] flaccid_: postgresql isn't elastic itself at all, not sure how thats relevent though
[2014-03-12 03:53:24 -0400] Majost_: but point being if its a wrapper and you spin up a node, its already configured, and the configuration is versioned in git
[2014-03-12 03:53:41 -0400] Majost_: whereas databags, and environments
[2014-03-12 03:53:42 -0400] Majost_: are not
[2014-03-12 03:54:08 -0400] flaccid_: you can version control the node.js. that means its 1 file and not a whole cookbook
[2014-03-12 03:54:28 -0400] flaccid_: part of the reason why i made https://github.com/chef-blueprints
[2014-03-12 03:55:29 -0400] Popsikle: envs are are good at setting versions for wrapper include statements
[2014-03-12 03:55:42 -0400] Popsikle: data bags are good for accounts nad netowkrin information that doesnt change (gateways and such)
[2014-03-12 03:55:48 -0400] Popsikle: and everything else should be in a wrapper ;)
[2014-03-12 03:56:33 -0400] flaccid_: i guess i'm just saying don't wrap when you don't need to
[2014-03-12 03:57:13 -0400] Popsikle: i have not run into the situation where a cookbook does what I ant out of the box
[2014-03-12 03:57:13 -0400] Popsikle: ;)
[2014-03-12 03:57:24 -0400] Popsikle: oh I lied.
[2014-03-12 03:57:26 -0400] Popsikle: Postfix does
[2014-03-12 03:57:27 -0400] flaccid_: fork, contribute.
[2014-03-12 03:57:58 -0400] Majost_: yeah, that is the key... push enhancements and bug fixes back upstream
[2014-03-12 03:58:31 -0400] flaccid_: most people are too lazy or believe its too hard to make a cookbook that can cater for different needs
[2014-03-12 04:00:10 -0400] Popsikle: ugh, what good would forking and getting things setup to my own spceific env and then doing a PR be?
[2014-03-12 04:00:16 -0400] Popsikle: it really wouldnt
[2014-03-12 04:01:49 -0400] flaccid_: the good would be being able to kill the fork. but it sounds like what you modify the cookbook with would be done wrong if you are hardcoding 'specifics for your env'
[2014-03-12 04:02:41 -0400] Popsikle: meh, depends. like I wrap the firewall cookbook because I replace all the providers with iptabels so its actually corss platform
[2014-03-12 04:02:55 -0400] Popsikle: cross*
[2014-03-12 04:03:09 -0400] Popsikle: but there is a PR for that already on that book and it just sits there
[2014-03-12 04:03:19 -0400] Popsikle: so really, no point in me pushing mine back up
[2014-03-12 04:03:34 -0400] flaccid_: right so the maintainer is the issue there. if you branched it you can just continue to merge your branches back into your master and use the fork
[2014-03-12 04:04:10 -0400] flaccid_: i've found when maintainers/authors don't do their shiz, keep PR and hassling until they do or they transfer ownership
[2014-03-12 04:04:16 -0400] Popsikle: Been down that road, turned into that maintainer who no longer has time to maintain it
[2014-03-12 04:04:23 -0400] Popsikle: ;p
[2014-03-12 04:04:41 -0400] flaccid_: yeah, so thats why you keep your master up to date but continue to branch and pr
[2014-03-12 04:04:58 -0400] flaccid_: at least then a fork is available so everyone can benefit from the enhancements
[2014-03-12 04:05:03 -0400] Popsikle: most times it just is not worth the effort.
[2014-03-12 04:05:10 -0400] Popsikle: and thats me being selfish, sure.
[2014-03-12 04:05:15 -0400] Popsikle: but it is what it is.
[2014-03-12 04:05:23 -0400] Popsikle: I can spend a day wrapping a book to work properly
[2014-03-12 04:05:24 -0400] flaccid_: i see it as the same amount of effort
[2014-03-12 04:05:27 -0400] Popsikle: and be done with it
[2014-03-12 04:05:42 -0400] Popsikle: or a day fixing it, and then 5 months deailing with trying to get it merged back in
[2014-03-12 04:05:48 -0400] flaccid_: this is where open source fails and fragments hardcore
[2014-03-12 04:07:16 -0400] Popsikle: and some of the books I use the maintainers make it pretty difficult to contribute at all, like rcbops books
[2014-03-12 04:07:33 -0400] flaccid_: its a global issue for sure
[2014-03-12 04:07:48 -0400] Popsikle: its like The lorax
[2014-03-12 04:08:19 -0400] Popsikle: http://25.media.tumblr.com/tumblr_m0dymg504I1qbvt1io1_500.jpg
[2014-03-12 04:08:20 -0400] Popsikle: ;p
[2014-03-12 04:08:21 -0400] flaccid_: this problem basically delays the maturity of available public cookbooks
[2014-03-12 04:08:43 -0400] Popsikle: that a function of what chef is tho
[2014-03-12 04:09:02 -0400] Popsikle: chef maintains the state of your boxes the way you need them for your application
[2014-03-12 04:09:07 -0400] flaccid_: yeah people like me will still keep doing PRs, its just standard practice for me. you find out if the owner cares
[2014-03-12 04:09:27 -0400] Popsikle: therefore the books you use are setup to your application
[2014-03-12 04:09:34 -0400] Popsikle: and that show all the books start
[2014-03-12 04:09:43 -0400] Popsikle: and then people start adapting them to be mroe general
[2014-03-12 04:09:56 -0400] flaccid_: i think thats too much of a generalisation
[2014-03-12 04:09:59 -0400] Popsikle: and then you are left with a book that does not really do what you want ever
[2014-03-12 04:09:59 -0400] Popsikle: ;)
[2014-03-12 04:10:21 -0400] Popsikle: this cookbook is a good cookbook imho
[2014-03-12 04:10:22 -0400] Popsikle: http://community.opscode.com/cookbooks/sensu
[2014-03-12 04:11:49 -0400] flaccid_: thats a pretty good approach, personally i call that more layering than wrapping
[2014-03-12 04:11:55 -0400] Popsikle: sure.
[2014-03-12 04:12:00 -0400] Popsikle: means the same thign to me
[2014-03-12 04:12:23 -0400] Popsikle: i mean the sensu cookbook has some issues like it trounces on any other redis install you may have on the node
[2014-03-12 04:12:41 -0400] flaccid_: that can be solved
[2014-03-12 04:12:52 -0400] Popsikle: but in general thats the way Id like to see most cookbooks
[2014-03-12 04:13:01 -0400] Popsikle: and i have quie a few we use in house that are like that
[2014-03-12 04:13:10 -0400] flaccid_: i think its a case by case basis in terms of what works
[2014-03-12 04:13:17 -0400] Popsikle: that maybe once I get done with this major  overhaul of our envs I can release
[2014-03-12 04:13:49 -0400] flaccid_: i just find it crazy when i see a wrapper cookbook that hardcodes node attribute overrides and thats all it does..
[2014-03-12 04:14:20 -0400] Popsikle: meh, if thats all you need, put it in a role recipe not a whole cookbook
[2014-03-12 04:14:38 -0400] flaccid_: believe it or not this is very common thing
[2014-03-12 04:14:46 -0400] Popsikle: oh yea I know
[2014-03-12 04:14:53 -0400] flaccid_: 1. wrap 2. deploy 3. see my complain hehe
[2014-03-12 04:15:21 -0400] Popsikle: I dont think it would be as common if there was more control over attribute parsing tbh
[2014-03-12 04:15:40 -0400] flaccid_: attribute parsing?
[2014-03-12 04:15:58 -0400] Popsikle: yea
[2014-03-12 04:16:11 -0400] Popsikle: like including only specific attrib files
[2014-03-12 04:16:28 -0400] flaccid_: hmm
[2014-03-12 04:16:31 -0400] Popsikle: so like you can write one book that has your attribs based on recipe name
[2014-03-12 04:16:40 -0400] Popsikle: but you cant do that
[2014-03-12 04:17:37 -0400] flaccid_: i'm not quite sure i follow, but ok..
[2014-03-12 04:17:39 -0400] Popsikle: so like If i need one task to use pg9.2 and another to use pg9.3 and i need the default attribs to show as such (because the pg cookbook makes assumptions based on defaults and not other attrib settings), then I need to wrappers
[2014-03-12 04:17:51 -0400] Popsikle: two*
[2014-03-12 04:18:08 -0400] Popsikle: but if I could just include a attrib file by name, I wouldnt need it
[2014-03-12 04:18:28 -0400] flaccid_: sounds like a design issue or the node attribute is not set
[2014-03-12 04:20:07 -0400] clodeindustrie: join #devcompanions
[2014-03-12 04:20:20 -0400] clodeindustrie: wat
[2014-03-12 04:20:31 -0400] flaccid_: or not
[2014-03-12 04:20:40 -0400] clodeindustrie: :)
[2014-03-12 04:21:01 -0400] flaccid_: in sydney eh thats where i am too, but i already have dev companions
[2014-03-12 04:21:29 -0400] clodeindustrie: I'm in boggabri, NSW have a look at that and laugh
[2014-03-12 04:23:07 -0400] flaccid_: clodeindustrie: its ok, i used to live in nyngan heh
[2014-03-12 04:23:46 -0400] clodeindustrie: oh my
[2014-03-12 04:24:12 -0400] flaccid_: was ok internets though hehe. i could work remotely for US company in cloud
[2014-03-12 04:24:51 -0400] clodeindustrie: and there is not much else to do
[2014-03-12 04:25:19 -0400] flaccid_: eat,code,drink,watch tv
[2014-03-12 05:57:28 -0400] flaccid_: coderanger: ah that thing i was looking for the other day, i think its foreman
[2014-03-12 06:51:16 -0400] _sp0k_: hello!
[2014-03-12 06:51:43 -0400] _sp0k_: has anyone encountered "Failed to create timer thread" error for Chef git resource, more error info - https://gist.github.com/vkhatri/9502043
[2014-03-12 06:57:48 -0400] __doug: Not sure who is awake here, but how do people distribute cookbooks to a box if they are using chef-solo?
[2014-03-12 06:59:57 -0400] n1ko: berkshelf
[2014-03-12 07:00:55 -0400] __doug: n1ko: our prod systems don't typically have access to our source code for security reasons
[2014-03-12 07:03:06 -0400] CADBOT_: What is the simple difference between environments and roles, and are both applicable to chef-solo, or are one/both of them really more of a chef server concept?
[2014-03-12 07:03:27 -0400] n1ko: __doug: yep
[2014-03-12 07:03:31 -0400] CADBOT_: It kind of seems like roles really only make sense in chef-server, but I don't want to come to this conclusion to early
[2014-03-12 07:03:35 -0400] CADBOT_: *too
[2014-03-12 07:03:58 -0400] __doug: n1ko: Hm, not good. Berkshelf can pull from a chef server rather than git. I think we'd do that
[2014-03-12 07:04:17 -0400] CADBOT_: For my use case: I'm making a personal computer provisioner. I want to have a different runlist for computers that have a gui (suck as a desktop) vs those without(such as a server)
[2014-03-12 07:04:31 -0400] CADBOT_: would environments, roles, or something else be most suitable?
[2014-03-12 07:04:54 -0400] n1ko: __doug: and the prod system doesnt need the access,only the machine that does bootstrapping
[2014-03-12 07:05:22 -0400] __doug: n1ko: then the bootstrap box has to get the chef cookbooks pushed out somehow
[2014-03-12 07:06:12 -0400] CADBOT_: Thanks in advance all!
[2014-03-12 07:07:31 -0400] n1ko: __doug: yep, theres a plugin for the berkshef integratiom
[2014-03-12 07:07:47 -0400] __doug: n1ko: know what it's called?
[2014-03-12 07:09:02 -0400] n1ko: knife solo if you use solo
[2014-03-12 07:10:08 -0400] n1ko: with server it works automaticly (check berkshelf page)
[2014-03-12 07:10:33 -0400] __doug: ok, thanks. don't think that will work
[2014-03-12 07:11:19 -0400] __doug: n1ko: it sshes in for one and we never got that to work with knife bootstrap as we have a complex setup with ssh proxies that it seemed to ignore
[2014-03-12 07:12:21 -0400] __doug: dunno why it keeps talking about kitchen
[2014-03-12 08:15:34 -0400] dmarr: i'd like to know why i install librarian-chef via bundler but i have no librarian-chef in my path
[2014-03-12 09:22:14 -0400] railsraider: I dont understand why upstart fails to start  a service that is already running and chef fails on that, doesnt chef suppose to check the state of that resource before issuing a cmd that fails?
[2014-03-12 09:24:24 -0400] srenatus: railsraider: too little information to help you in any way.
[2014-03-12 09:24:36 -0400] srenatus: railsraider: except: if the service is running, chef shouldn't try to start it, yes.
[2014-03-12 09:25:04 -0400] srenatus: railsraider: before issuing the command.  "before issuing a command that fails" doesn't make much sense
[2014-03-12 09:25:21 -0400] srenatus: railsraider: why not paste some code somewhere?
[2014-03-12 09:26:16 -0400] railsraider: i think this is the cause unicorn_bluepill start/killed, process 1047
[2014-03-12 09:26:41 -0400] railsraider: i have a script that clear these stuck upstart i'll try that
[2014-03-12 09:28:03 -0400] railsraider: here it is if anyone need it https://github.com/ion1/workaround-upstart-snafu/blob/master/workaround-upstart-snafu
[2014-03-12 09:56:06 -0400] dawuud: howdy
[2014-03-12 09:56:23 -0400] dawuud: i like to test my cookbooks on remote VPSs; is that frowned upon?
[2014-03-12 09:56:35 -0400] dawuud: i really do not want vagrant on my linux laptop
[2014-03-12 09:57:08 -0400] dawuud: and it seems easy enough to knfe cookbook upload... a uncommited git tree and then test
[2014-03-12 10:21:38 -0400] daxroc: Is it ok to use node.attribute[:mine] to access attributes ?
[2014-03-12 10:22:07 -0400] daxroc: Is it just preference ?
[2014-03-12 10:24:18 -0400] dawuud: miah: ping
[2014-03-12 11:10:53 -0400] workmad3: daxroc: I tend to just use node[:some_attribute] to access attributes
[2014-03-12 11:13:06 -0400] daxroc: workmad3: Yeah, get an issue with foodcritic on FC019, inconsistent use of accessors. From what I've read this is within the cookbook but I'm accessing all using node[:attr] but node.attribute[:attr] is fine
[2014-03-12 11:14:21 -0400] workmad3: daxroc: could it also be inconsistent switching between :attr and "attr"? :)
[2014-03-12 11:15:32 -0400] daxroc: yes, but the attribute it's erring on is only accessed once from my understanding.
[2014-03-12 11:16:49 -0400] workmad3: daxroc: right... but surely the error would crop up if you were accessing one attribute with :some_attr and another attribute with "another_attr"?
[2014-03-12 11:17:17 -0400] workmad3: daxroc: that would also be inconsistent use of accessors I suspect
[2014-03-12 11:18:20 -0400] daxroc: So it's possibly erring on the first attribute accessed ?
[2014-03-12 11:18:42 -0400] daxroc: * it may not be the inconsistent one
[2014-03-12 11:18:43 -0400] workmad3: daxroc: first attribute accessed differently, I suspect yes :)
[2014-03-12 11:19:24 -0400] workmad3: daxroc: it would be the 'inconsistent' one in that first attr accessed with :attr, the next attr is accessed with "attr2" so that's inconsistent with attribute accesses up to that point... I'm guessing here, but that wouldn't surprise me :)
[2014-03-12 11:21:07 -0400] daxroc: Makes sense. So accessing attributes like node[:attr][File.basename(__FILE__, '.*')] would fail so I should use node[:attr].attribute[File.basename(__FILE__, '.*')]
[2014-03-12 11:22:54 -0400] workmad3: daxroc: either that or you ignore/suppress that food-critic warning (IMO, your case there is perfectly fine... inconsistency would only be if you were doing node[:attr]["some_other_thing"] rather than node[:attr][:some_other_thing]... this is where static-analysis tools can fall down :) )
[2014-03-12 11:25:39 -0400] daxroc: workmad3: appreciate the feedback
[2014-03-12 11:51:09 -0400] dawuud: is vagrant really part of chef best practices? i like to test my cookbooks on remote VPSs; is that frowned upon?
[2014-03-12 11:51:36 -0400] n1ko: it is, and you are free to do what you like
[2014-03-12 11:51:46 -0400] n1ko: plenty of people test on remote vps
[2014-03-12 11:52:50 -0400] dawuud: i guess vagrant might be slightly more convenient because i won't have to knife cookbook upload an uncommitted cookbook repo...
[2014-03-12 11:56:18 -0400] workmad3: dawuud: you could always use vagrant with something like vagrant-aws or vagrant-digital-ocean to still test on remote VPSs, but controlled through vagrant :)
[2014-03-12 11:57:09 -0400] dawuud: workmad3: isn't it bad to run vagrant remotely because it has a default ssh password and wasn't really designed to use remotely?
[2014-03-12 12:06:48 -0400] workmad3: dawuud: that's with the vagrant vbox images
[2014-03-12 12:07:35 -0400] workmad3: dawuud: the plugins for remote VPS systems don't use those images, they use the images available from the provider and, at least in the case of aws, also get told things like the keypair to use so it hooks directly into the AWS mechanisms for securing new boxes ;)
[2014-03-12 12:11:30 -0400] daxroc: Most providers allow you to create your own 'boxes' base images.
[2014-03-12 12:14:49 -0400] workmad3: daxroc: yeah, but in the case of remote providers those boxes tend to be stubs and wrappers around some default values
[2014-03-12 12:15:06 -0400] workmad3: daxroc: rather than an actual image (which remote providers tend to not support)
[2014-03-12 12:48:28 -0400] JuriadoBalzac: Hi! I'm using chef for managing users on a few servers and I have a user I would like to disable, is there any way to do that? THe users have a data bag each.
[2014-03-12 12:48:45 -0400] JuriadoBalzac: Removing the data bag would of course be an option
[2014-03-12 12:53:49 -0400] JuriadoBalzac: Oh, I found you can set  "deleted":true,
[2014-03-12 12:58:15 -0400] daxroc: JuriadoBalzac: you can also disable the user, as deleting may remove data
[2014-03-12 13:05:02 -0400] JuriadoBalzac: daxroc: That's "disabled":true?
[2014-03-12 13:06:48 -0400] JuriadoBalzac: Hm, even with disabled a whyrun say that the homedir would be deleted
[2014-03-12 13:18:16 -0400] dawuud: workmad3: ahhh that sounds good
[2014-03-12 13:24:19 -0400] shlant: JuriadoBalzac: if your question hasn't been answered yet, you would set "action": "remove", in the users data bag
[2014-03-12 13:38:25 -0400] shlant: how do you set the environment when bootstrapping? -j JSON_ATTRIBS?
[2014-03-12 13:38:55 -0400] shlant: nm found it
[2014-03-12 13:46:32 -0400] JuriadoBalzac: shlant: You just set it instead of "deleted":true, ?
[2014-03-12 13:46:58 -0400] shlant: JuriadoBalzac: are you using the 'users' cookbook?
[2014-03-12 13:47:37 -0400] JuriadoBalzac: shlant: yup
[2014-03-12 13:48:43 -0400] shlant: JuriadoBalzac: then yes, you would use "action": "remove"
[2014-03-12 13:49:21 -0400] shlant: you can also lock the user with "action": "lock"
[2014-03-12 13:53:35 -0400] JuriadoBalzac: shlant: Hm, doesn't appear to work.
[2014-03-12 13:53:49 -0400] JuriadoBalzac: Just does nothing.
[2014-03-12 13:53:51 -0400] shlant: JuriadoBalzac: it doesn't remove the use on a chef run?
[2014-03-12 13:53:56 -0400] shlant: user *
[2014-03-12 13:54:02 -0400] bettyclamp: The jenkins cookbook checks the value of node.run_state[:jenkins_cli_present] but does not set it. At runtime its value is evidently false, even though the Jenkins CLI is indeed present. Why is this happening?
[2014-03-12 13:54:15 -0400] JuriadoBalzac: shlant: I tried doing a whyrun first and no, it doesn't show that it'll remove the user.
[2014-03-12 13:54:23 -0400] bettyclamp: It's causing failed chef runs.
[2014-03-12 13:56:10 -0400] shlant: JuriadoBalzac: let me test on my machine
[2014-03-12 14:02:53 -0400] JuriadoBalzac: shlant: cool, thank you!
[2014-03-12 14:11:55 -0400] mstyne: does anyone know where I can find some documentation on the resources directive
[2014-03-12 14:12:13 -0400] mstyne: i.e. resources("package[blah]").action(:upgrade)
[2014-03-12 14:14:09 -0400] shlant: mstyne: are you creating an LWRP or something?
[2014-03-12 14:15:19 -0400] shlant: JuriadoBalzac: so the 'users' cookbook is a little confusing. Users are only added/removed if they are part of the group and if you don't have them as part of the sysadmin group, they won't be added unless you create a group with the users_manage LWRP
[2014-03-12 14:15:21 -0400] dawuud: the other advantage that vagrant seems to have over a VPS for testing cookbooks is that you can destroy and rebuild the image quicker
[2014-03-12 14:15:28 -0400] mstyne: i'm trying to track down a mechanism for switching a string in a template during the chef run
[2014-03-12 14:15:44 -0400] mstyne: shlant: i.e. in the beginning of the the run it should be 1, and at the end, it should be 0
[2014-03-12 14:15:45 -0400] JuriadoBalzac: shlant: Hm, looks like I'll have to rething this.
[2014-03-12 14:15:51 -0400] dawuud: but that seems to not always be necessary
[2014-03-12 14:15:57 -0400] mstyne: and it's stored in a node variable
[2014-03-12 14:16:12 -0400] JuriadoBalzac: shlant: I'll go back to the docs, thanks for the help!
[2014-03-12 14:16:21 -0400] shlant: JuriadoBalzac: if you need further explanation, let me know.
[2014-03-12 14:16:22 -0400] mstyne: and I thought resources. might help me with that
[2014-03-12 14:16:23 -0400] shlant: yea, check http://community.opscode.com/cookbooks/users
[2014-03-12 14:16:51 -0400] shlant: mstyne: what should be  changing that value?
[2014-03-12 14:17:19 -0400] shlant: mstyne: what purpose are you trying to accomplish>
[2014-03-12 14:17:19 -0400] mstyne: well, i'm calling the template resource
[2014-03-12 14:17:59 -0400] mstyne: okay, here's the idea
[2014-03-12 14:18:47 -0400] mstyne: I have configuration file, with a variable that defines if the app is in maintenance mode or not
[2014-03-12 14:18:54 -0400] mstyne: this file is managed via a template
[2014-03-12 14:19:13 -0400] mstyne: at the beginning of my recipe, I'd like to enable maintenance mode, and at the end, disable it
[2014-03-12 14:19:47 -0400] mstyne: the value for the maintenance setting is stored in a node variable, i.e. node['blah']['maintenance']
[2014-03-12 14:20:13 -0400] mstyne: maybe storing it in a node varialbe is not the best idea, since after the compilation phase it's always going to be the last value I set it to
[2014-03-12 14:21:17 -0400] mstyne: so my guess is I want to use resources("template[configuration_file]").something()
[2014-03-12 14:21:31 -0400] mstyne: to diddle the resource directly during the execution phase(?)
[2014-03-12 14:32:56 -0400] marius: hi, I'm deploying with deploy resource and I want to overwrite some file with template
[2014-03-12 14:33:25 -0400] marius: how to avaid triggering new deploy next time, if git directory will become dirty
[2014-03-12 14:33:37 -0400] marius: also, I'm not controlling .gitignore file
[2014-03-12 14:38:28 -0400] mstyne: hm, this looks interesting http://docs.opscode.com/resource_common.html#lazy-attribute-evaluation
[2014-03-12 14:51:24 -0400] mstyne: tl;dr: don't use node variables, and pass variables( ) to your template resource definition
[2014-03-12 14:51:32 -0400] mstyne: problem solved
[2014-03-12 14:55:25 -0400] glen: hey. i'm tryng to make "knife  role from file " to use .rb file which requires another file
[2014-03-12 14:55:32 -0400] glen: but i end up with error: Exception: NoMethodError: undefined method `name' for main:Object
[2014-03-12 15:02:12 -0400] shlant: mstyne: sorry about leaving you hanging there! got pulled away. Glad you solved it :)
[2014-03-12 15:03:57 -0400] mstyne: shlant: no worries. didn't need lazy evalutation, but I was happy to learn about it
[2014-03-12 15:04:18 -0400] shlant: mstyne: yea, I learnt the usefulness of it recently too
[2014-03-12 15:04:22 -0400] mstyne: it was very satisfying doing a 'watch cat' on my config file and seeing the variable get flipped around like MAGIC
[2014-03-12 15:04:40 -0400] shlant: mstyne: the magic of automation is a beautiful thing
[2014-03-12 15:08:05 -0400] stormerider: hey, i know i can check for running in chef-solo using Chef::Config[:solo], but will that also affect chef-zero, or is there another setting like Chef::Config[:zero] or Chef::Config[:server] ?
[2014-03-12 15:09:16 -0400] phutch1ns: Hey, anyone know why when a unicorn restart is done, our new rails assets are not picked up, but when I do a unicorn stop && unicorn start (waiting for the workers to die in between of course)
[2014-03-12 15:09:19 -0400] jkeiser: stormerider: there isn't a specific setting, nope--what are you trying to do?
[2014-03-12 15:09:27 -0400] phutch1ns: they are picked up?
[2014-03-12 15:09:51 -0400] jkeiser: stormerider: there are ways to determine whether you are in --local-mode, if you wanted to know that
[2014-03-12 15:09:57 -0400] phutch1ns: ack wrong channel...
[2014-03-12 15:10:36 -0400] jkeiser: stormerider: but I am very curious of the use case
[2014-03-12 15:10:44 -0400] stormerider: i have a specific recipe that seems to work fine under chef server, but fails under chef-zero, so i'm looking to wrap the code in an if check to skip the code if i'm in zero or not in server mode, whichever is easiest
[2014-03-12 15:10:45 -0400] AikiLinux: guys, where is the best place to put an attribute that will effect only 1 node ?
[2014-03-12 15:10:56 -0400] stormerider: specifically, using the airbrake_handler
[2014-03-12 15:11:26 -0400] jkeiser: stormerider: there is a Chef::Config.local_mode you can use to detect --local-mode or -z.  What's failing?
[2014-03-12 15:11:52 -0400] jkeiser: stormerider: (I would like to fix zero in any places where it's broken)
[2014-03-12 15:12:09 -0400] stormerider: trying to find the ticket, it's eluding me
[2014-03-12 15:13:03 -0400] stormerider: remote_directory/root/.chef/local-mode-cache/handlers (chef_handler::default line 23) had an error: Chef::Exceptions::FileNotFound: cookbook chef_handler has no directory files/default/handlers
[2014-03-12 15:14:23 -0400] AikiLinux: is it good practice to put attributes in the data_bag ?
[2014-03-12 15:15:05 -0400] n1ko: depends what you mean by attributes
[2014-03-12 15:15:45 -0400] bettyclamp: To rephrase my question of 09:54:02: the jenkins opscode cookbook checks the value of node.run_state[:jenkins_cli_present] but it does not set this value anywhere. Who is responsible for setting this variable, or for setting any of them in node.run_state?
[2014-03-12 15:17:59 -0400] AikiLinux: n1ko, i have an attribute (node["blah"]["foo"] ) set in an attribute file and used by a cookbook, now a specific node needs a different value for that attribute
[2014-03-12 15:18:06 -0400] bettyclamp: sethvargo: this question is for you! :-)
[2014-03-12 15:18:20 -0400] bettyclamp: (I'll re-enter it...)
[2014-03-12 15:18:48 -0400] bettyclamp: To rephrase my question of 09:54:02: the jenkins opscode cookbook checks the value of node.run_state[:jenkins_cli_present] but it does not set this value anywhere. Who is responsible for setting this variable, or for setting any of them in node.run_state?
[2014-03-12 15:19:46 -0400] sethvargo: https://github.com/opscode-cookbooks/jenkins/blob/master/libraries/_helper.rb#L301
[2014-03-12 15:20:23 -0400] n1ko: AikiLinux: i mean, why would you want to be in a data bag. If its secret then yeah, an encrypted data bag is a good idea
[2014-03-12 15:20:24 -0400] bettyclamp: sethvargo: yes, but the cli won't download.
[2014-03-12 15:20:34 -0400] sethvargo: What do you mean?
[2014-03-12 15:20:51 -0400] n1ko: AikiLinux: if it depends on a role, then set it in a role. if it depends on a environment, set in a environment. If it's a default setting or same for all, set it in attributes
[2014-03-12 15:21:02 -0400] bettyclamp: A 500 error occurs when the client tries to download from that uri. A wget reproduces the 500 error.
[2014-03-12 15:21:11 -0400] AikiLinux: n1ko, i am only looking at a way to specify the value for a specific node
[2014-03-12 15:21:36 -0400] n1ko: so what you probably want is a role
[2014-03-12 15:21:49 -0400] AikiLinux: it is not something that all members of the role should get
[2014-03-12 15:22:25 -0400] docwhat: Is there a way to turn of the requirement for a client.pem when downloading cookbooks from a chef-server?
[2014-03-12 15:22:39 -0400] AikiLinux: it is unique to a specific node
[2014-03-12 15:22:47 -0400] n1ko: AikiLinux: sounds weird to me, I have identical stuff based on the role and environments
[2014-03-12 15:22:49 -0400] bettyclamp: I'm also a little confused by "Idempotently" on line 296 of the code: the jenkins-cli is already in our file cache, but the cookbook still wants to download it.
[2014-03-12 15:23:07 -0400] n1ko: a real life example for such need would be nice
[2014-03-12 15:24:14 -0400] AikiLinux: n1ko, I have those too , but a situation came where a specific node is used more then the others in his "role" and we need to adapt it's functionality to the situation
[2014-03-12 15:24:30 -0400] n1ko: i would just create a new role for it
[2014-03-12 15:24:42 -0400] AikiLinux: we can not transfer functionality off the server
[2014-03-12 15:25:08 -0400] AikiLinux: so I need a method to apply the attribute only on that server
[2014-03-12 15:25:22 -0400] n1ko: i have done similar things with almost identical roles. I try to avoid using attributes in roles, so it usually boils down to just overriding something specific in the role file
[2014-03-12 15:25:37 -0400] n1ko: clean and simple
[2014-03-12 15:25:41 -0400] AikiLinux: adding a new role will break it out of the functionality matching of the rest in the role
[2014-03-12 15:25:47 -0400] n1ko: why?
[2014-03-12 15:25:59 -0400] AikiLinux: why, what ?
[2014-03-12 15:26:22 -0400] n1ko: you are doing stuff based on that specific role and cannot refactor those things to check out two roles instead of one?
[2014-03-12 15:26:25 -0400] n1ko: or what ?
[2014-03-12 15:26:48 -0400] n1ko: for example, i have created a galera cookbook where one node is a "reference node" and n other nodes are used for normal querying
[2014-03-12 15:26:59 -0400] n1ko: sounds a bit similar
[2014-03-12 15:27:01 -0400] sethvargo: bettyclamp we are idempotently adding the item to the resource collection, not idemptotenly executing it
[2014-03-12 15:27:04 -0400] n1ko: almost identical, but little differences
[2014-03-12 15:27:09 -0400] sethvargo: It's idempotency in idempotency. It's meta
[2014-03-12 15:27:46 -0400] bettyclamp: sethvargo: ok, great, but do you have any hints about why we get the 500 error?
[2014-03-12 15:28:16 -0400] AikiLinux: a second role will break many other services in our environment,chef is not a "stand alone" appliance
[2014-03-12 15:28:41 -0400] AikiLinux: there are many interdependencies
[2014-03-12 15:30:29 -0400] n1ko: well you can do ugly hacks based on the node name and override stuff in the recipe
[2014-03-12 15:30:40 -0400] n1ko: but like said, ugly.
[2014-03-12 15:31:03 -0400] AikiLinux: which is what i am trying to avoid
[2014-03-12 15:31:14 -0400] sethvargo: bettyclamp what 500?
[2014-03-12 15:31:45 -0400] bettyclamp: sethvargo: the 500 server error. Here is the full line: remote_file[/var/chef/cache/jenkins-cli.jar] action create[2014-03-12T10:24:26-04:00] WARN: remote_file[/var/chef/cache/jenkins-cli.jar] cannot be downloaded from http://localhost:8080/jnlpJars/jenkins-cli.jar: 500 "Server Error"
[2014-03-12 15:31:50 -0400] n1ko: AikiLinux: imho you are kinda trying to do ugly things anyways. Chef is good for doing identical things and things that are identical are clearly marked different (eg. different role or wrapper cookbook)
[2014-03-12 15:31:59 -0400] n1ko: so ugliness comes with that
[2014-03-12 15:32:40 -0400] AikiLinux: which is why i am thinking the data_bag , as it is unique to each host
[2014-03-12 15:33:07 -0400] n1ko: umm...
[2014-03-12 15:33:22 -0400] n1ko: what do you mean by that?
[2014-03-12 15:33:51 -0400] sethvargo: It means what it says - is that the correct URL? is something running at localhost:8080
[2014-03-12 15:33:58 -0400] n1ko: i only use databags for encrypting stuff, but those are shared between all the nodes of course
[2014-03-12 15:34:06 -0400] n1ko: and loading is done identically since they all use the same recipe
[2014-03-12 15:34:40 -0400] bettyclamp: sethvargo: the url is generated by the cookbook. Jenkins itself is running at localhost:8080.
[2014-03-12 15:34:53 -0400] sethvargo: Can you verify that on the webui?
[2014-03-12 15:35:42 -0400] bettyclamp: Yes, the jenkins app is accessible on 8080 and fully functional.
[2014-03-12 15:35:47 -0400] AikiLinux: n1ko, we use data_bags to store servers individual data( mac addresses, ip's and so forth)
[2014-03-12 15:35:51 -0400] bettyclamp: (Is that what you meant to ask?)
[2014-03-12 15:36:16 -0400] JuriadoBalzac: shlant: Hm, setting locked as true works with removing they ssh keys, but it gives an error during whyrun with "whyrun not supported by provider Chef::Provider::Log::ChefLog". Any clue why or where to start looking?
[2014-03-12 15:36:21 -0400] sethvargo: And can you access that URL for the jnlpjar/jenkins-cli.jar in the webui?
[2014-03-12 15:36:26 -0400] JuriadoBalzac: It still completes the whyrun though
[2014-03-12 15:38:09 -0400] bettyclamp: sethvargo: actually that produces a 404 error (Reason: Not Found)
[2014-03-12 15:38:33 -0400] sethvargo: It's a capital J
[2014-03-12 15:39:06 -0400] shlant: JuriadoBalzac: I wouldn't spend to many cycles trying to debug why-run. It's still beta and will have issues.
[2014-03-12 15:39:36 -0400] JuriadoBalzac: shlant: Ah, fair enough ;)
[2014-03-12 15:39:55 -0400] nicgrayson: trying to use hostsfile to remove 127.0.1.1 from my hostsfile https://gist.github.com/nicgrayson/9509367
[2014-03-12 15:39:57 -0400] nicgrayson: any ideas?
[2014-03-12 15:42:12 -0400] bettyclamp: sethvargo: changed to jnlpJars/jenkins-cli.jar, but still "not found".
[2014-03-12 15:42:38 -0400] shlant: nicgrayson: looks like a bug in the LWRP. I would let the maintainers know
[2014-03-12 15:42:51 -0400] sethvargo: @shlant @nicgrayson not a bug
[2014-03-12 15:42:54 -0400] shlant: in the mean time, try with the ip and/or hostname set?
[2014-03-12 15:43:00 -0400] shlant: sethvargo: oh?
[2014-03-12 15:43:04 -0400] sethvargo: It's a requirement
[2014-03-12 15:43:06 -0400] nicgrayson: seth just helped on twitter
[2014-03-12 15:43:17 -0400] sethvargo: @bettyclamp you should open an issue. Our team can take a look at triage on Friday
[2014-03-12 15:43:35 -0400] shlant: sethvargo: then the docs are wrong?
[2014-03-12 15:43:36 -0400] shlant: remove
[2014-03-12 15:43:36 -0400] shlant: Removes an entry from the hosts file. Does nothing if the entry does not exist.
[2014-03-12 15:43:37 -0400] shlant: ruby hostsfile_entry '1.2.3.4' do action :remove end
[2014-03-12 15:43:37 -0400] shlant: This will remove the entry for 1.2.3.4.
[2014-03-12 15:43:53 -0400] sethvargo: Probably
[2014-03-12 15:44:21 -0400] nicgrayson: sethvargo: so is there not a way to remove the ip for all hostnames?
[2014-03-12 15:44:30 -0400] sethvargo: There probably should be
[2014-03-12 15:44:39 -0400] nicgrayson: that is how that used to work
[2014-03-12 15:45:38 -0400] sethvargo: @nicgrayson bisect and open an issue?
[2014-03-12 15:45:44 -0400] nicgrayson: sure thing
[2014-03-12 16:02:55 -0400] nicgrayson: sethvargo: i get it on this call too
[2014-03-12 16:02:55 -0400] nicgrayson:  37: hostsfile_entry "localhost" do
[2014-03-12 16:02:56 -0400] nicgrayson:  38:   ip_address "127.0.0.1"
[2014-03-12 16:02:56 -0400] nicgrayson:  39:   hostname "localhost"
[2014-03-12 16:02:56 -0400] nicgrayson:  40:   action :create_if_missing
[2014-03-12 16:02:57 -0400] nicgrayson:  41: end
[2014-03-12 16:03:16 -0400] nicgrayson: working on an issue now
[2014-03-12 16:15:57 -0400] ush: http://docs.opscode.com/api_cookbooks_site.html#cookbooks-name suggests that I should be able to obtain "updated_at", but testing as follows just shows versions
[2014-03-12 16:17:50 -0400] ush: https://gist.github.com/UshF/9510320  <--- attempt to use knife exec and API to find updated_at for a cookbook
[2014-03-12 16:18:15 -0400] ush: am I going about this completely the wrong way?
[2014-03-12 16:38:38 -0400] engel75: hi
[2014-03-12 16:39:27 -0400] engel75: somebody only who is able to explain me how to use chef-solo with the nginx cookbook and data_bags?
[2014-03-12 16:42:09 -0400] tara_h1: I didn't think you could use data_bags with chef-solo, so shows what *I* know
[2014-03-12 16:45:55 -0400] engel75: hmm
[2014-03-12 16:46:09 -0400] engel75: http://docs.opscode.com/essentials_data_bags.html#with-chef-solo
[2014-03-12 16:46:21 -0400] engel75: sounds like it is possible
[2014-03-12 16:46:47 -0400] engel75: but I do not understand how to tell the nginx cookbook to use a data_bag
[2014-03-12 16:49:42 -0400] stormerider: i think you have to use an extra library to make it work
[2014-03-12 16:50:14 -0400] stormerider: yeah, chef-solo-search cookbook library
[2014-03-12 16:50:25 -0400] stormerider: https://github.com/edelight/chef-solo-search
[2014-03-12 16:52:00 -0400] engel75: hmm ok
[2014-03-12 16:52:25 -0400] engel75: thank you
[2014-03-12 16:55:36 -0400] iiro: question about multiple wrapper cookbooks running on a same runlist... we have a need to run multiple tomcats on a same server... do we have to use LWRPs? Now were trying to use wrapper cookbooks which configure the settings for each tomcat but ofc were having problems with attribute precedence (last one on the runlist only "works")...
[2014-03-12 16:55:43 -0400] engel75: hmm I guess I do not understand how to create a vhost with the nginx cookbook anyway :(
[2014-03-12 16:57:37 -0400] iiro: engel75, havent used it yet, sry cannot help you :/
[2014-03-12 16:58:05 -0400] engel75: its my 1st chef "tryout" and my brain smokes like hell
[2014-03-12 16:59:02 -0400] iiro: I understand... I have started with easier things... like users / groups, JDK delivery, basic stuff... :)
[2014-03-12 17:00:42 -0400] jeffcara: has anybody used bats yet for integration testing?
[2014-03-12 17:01:24 -0400] cheeseprocedure: jeffcara: just a little, as i start wading into test-kitchen
[2014-03-12 17:02:02 -0400] engel75: iiro, maybe I should try some step-by-step guide 1st
[2014-03-12 17:02:28 -0400] iiro: engel75, I tried to quick-view the Nginx cookbook from Opscode / Chef but it does not open to me either..
[2014-03-12 17:02:33 -0400] engel75: but right now it looks like the default nginx cookbook is not aware of any vhost configuration thing
[2014-03-12 17:02:49 -0400] iiro: engel75, yep...
[2014-03-12 17:02:49 -0400] engel75: looks like this mus be done in some seperated cookbook
[2014-03-12 17:03:01 -0400] iiro: or some wrapper...
[2014-03-12 17:03:58 -0400] iiro: the attributes are smoking my head :)
[2014-03-12 17:04:01 -0400] engel75: a wrapper is a cookbook including another one?
[2014-03-12 17:04:07 -0400] iiro: yep
[2014-03-12 17:04:12 -0400] engel75: ah ok
[2014-03-12 17:04:18 -0400] engel75: I get it (somehow)
[2014-03-12 17:05:09 -0400] jeffcara: cheeseprocedure: same here. I'm trying to figure out how to get bats to give me a little more visibility than '1 failure' and on what line. For example, what the output was that it got instead of what I expected.
[2014-03-12 17:05:21 -0400] engel75: iiro, thank you for your tipps!
[2014-03-12 17:05:33 -0400] engel75: and good luck with your question
[2014-03-12 17:05:41 -0400] cheeseprocedure: engel75: this is a helpful read - http://dougireton.com/blog/2013/02/16/chef-cookbook-anti-patterns/
[2014-03-12 17:05:45 -0400] iiro: engel75, I didt do anything but great if you got some. :)
[2014-03-12 17:05:54 -0400] iiro: thats a good link...
[2014-03-12 17:06:02 -0400] engel75: thx!
[2014-03-12 17:06:04 -0400] engel75: reading...
[2014-03-12 17:07:48 -0400] cheeseprocedure: jeffcara: good question; i haven't had to do anything complex yet. short of actually including expected output in the test description, i'm not sure. can you give an example?
[2014-03-12 17:10:25 -0400] dgarstang: How does creating a package for a chef cookbook sound (ie a debian package), and then having a post install script that runs chef-solo agaainst it sound as a deployment methodology for apps?
[2014-03-12 17:12:34 -0400] fraterlaetus: Herroe
[2014-03-12 17:12:56 -0400] fraterlaetus: Does anyone have experience installing chef-workstation on OSX 10.9 (Mavericks)?
[2014-03-12 17:13:30 -0400] iiro: fraterlaetus, I did on mine, just used the install oneliner from Chefs site...
[2014-03-12 17:13:38 -0400] iiro: fraterlaetus, problems?
[2014-03-12 17:14:15 -0400] jeffcara: cheeseprocedure:  yeah. writing a test to verify ruby version installed. Just put 'run ruby -v' as the run command, and copied the output string from when I manually run the same command inside the VM. Test failed, but it didn't tell me why...
[2014-03-12 17:15:28 -0400] jeffcara: what I want is the equivalent of puts or echo or print.
[2014-03-12 17:26:28 -0400] cheeseprocedure: jeffcara: this is ugly/repetitive, but you can drop the use of "run" like so (the last statement will need to return 0 to be considered a success):
[2014-03-12 17:27:00 -0400] cheeseprocedure: https://gist.github.com/anonymous/9511875
[2014-03-12 17:27:10 -0400] shlant: is the link resource aware of changes in respect to notifies?
[2014-03-12 17:27:36 -0400] dgarstang: i'm wondering if anyone is running berkshelf on target systems to get chef cookbooks on there for use with chef-solo?
[2014-03-12 17:27:42 -0400] cheeseprocedure: looks like you're not alone - https://github.com/sstephenson/bats/issues/28
[2014-03-12 17:28:26 -0400] cheeseprocedure: jeffcara: might be worth checking with the folks in #kitchenci as well
[2014-03-12 17:31:52 -0400] jeffcara: cheeseprocedure: This is all really helpful, thank you very much. I was planning on making kitchenci my next stop on the today, but I will look over all the stuff you have sent first.
[2014-03-12 17:39:43 -0400] drywheat: here's an oddity
[2014-03-12 17:40:04 -0400] drywheat: in my chef run i install rbenv, a ruby version and set it to global
[2014-03-12 17:40:25 -0400] drywheat: on the next chef run, Chef uses that ruby version instead of the embedded ruby
[2014-03-12 17:40:43 -0400] drywheat: that doesn't really make any sense to me, has anyone had this issue?
[2014-03-12 17:42:09 -0400] drywheat: what type of shell does a chef run launch? interactve, login, etc...?
[2014-03-12 17:45:44 -0400] dgarstang: i'm wondering if anyone is running berkshelf on target systems to get chef cookbooks on there for use with chef-solo?
[2014-03-12 17:52:56 -0400] coderanger: drywheat: Depends entirely on how you start chef, it just obeys $PATH
[2014-03-12 17:53:15 -0400] drywheat: mmm
[2014-03-12 17:54:19 -0400] drywheat: i'm in the process of evaluating the path and seeing what can/should be done
[2014-03-12 17:54:24 -0400] tehnef: anyone available for a quick question? I cannot for the life of me figure out why the users cookbook isn't working for me
[2014-03-12 17:54:47 -0400] tehnef: i have sethvargo's users cookbook
[2014-03-12 17:55:16 -0400] sethvargo: @tehnef I literally _just_ took over that cookbook. It's going to get a major refactor soon
[2014-03-12 17:55:46 -0400] tehnef: and am wrapping it with a barebones cookbook that depends on users, the recipe has include_recipe "users", and I am using "users_manage" ... it creates the group but not the user
[2014-03-12 17:56:12 -0400] tehnef: sethvargo: gotcha. I'm sure I'm Doing It Wrong. I'm still new to all this stuff.
[2014-03-12 17:56:29 -0400] tehnef: I have a users data bag
[2014-03-12 17:56:36 -0400] coderanger: tehnef: You can check out https://github.com/balanced-cookbooks/balanced-user for an example of nice way to handle it
[2014-03-12 17:57:47 -0400] tehnef: hmm, i was hoping to use my data bag...should I abandon that desire?
[2014-03-12 17:58:00 -0400] coderanger: yes, data bags are (almost always) wrong
[2014-03-12 17:58:13 -0400] coderanger: (note: this is my opinion, most don't agree)
[2014-03-12 17:58:18 -0400] tehnef: :)
[2014-03-12 17:58:35 -0400] coderanger: but for users certainly, bags are not the right solution
[2014-03-12 17:58:50 -0400] tehnef: heh, googling you reveals the same :)
[2014-03-12 18:00:46 -0400] tehnef: wharblgarbl
[2014-03-12 18:01:10 -0400] tehnef: so really i just need to get my cloudinit stuff figured out
[2014-03-12 18:01:19 -0400] tehnef: and dispense with this game
[2014-03-12 18:02:28 -0400] coderanger: tehnef: https://github.com/balanced/balanced-infra/blob/master/templates/base.py#L245-L249
[2014-03-12 18:03:15 -0400] coderanger: and then just bake that script into your image
[2014-03-12 18:05:26 -0400] drywheat: coderanger: i figured out the issue with rbenv and chef
[2014-03-12 18:06:03 -0400] drywheat: turns out that when i built my vagrant box with veewee
[2014-03-12 18:06:22 -0400] drywheat: the default definition installs chef via "rubygems"
[2014-03-12 18:06:26 -0400] dgarstang: Well that's not good. "Could not find command "version:current"."
[2014-03-12 18:07:06 -0400] drywheat: whereas the normal method of installation [during bootstrap] is to use the omnibus installer and use a system package
[2014-03-12 18:08:02 -0400] drywheat: the latter keeps Chef from losing its mind when a ruby manager (e.g. rbenv, rvm, ...) configures a global version
[2014-03-12 18:08:15 -0400] drywheat: just thought that was noteworthy
[2014-03-12 18:08:43 -0400] drywheat: i rebuilt my vagrant box using an omnibus install and the issue resolved
[2014-03-12 18:24:49 -0400] cburroughs: Does the user resource support changing the uid? http://docs.opscode.com/resource_user.html
[2014-03-12 18:27:24 -0400] tehnef: coderanger: thanks
[2014-03-12 19:00:51 -0400] btm: Chef/Ohai Code Review: Join: bit.ly/1idW48m watch: bit.ly/1idW6gv
[2014-03-12 19:01:51 -0400] fraterlaetus: Is there a better set of instructions on placement for a custom Ohai plugin?
[2014-03-12 19:02:15 -0400] fraterlaetus: IE: Where to place it, how to activate/call it?
[2014-03-12 19:10:19 -0400] cityhawk: guys, I'm trying to write a chefspec for the recipe (not mine) which is using famous and cursed web_app definition from the apache2 cb. I realize I can't test definitions, but is there a fair way to avoid chefspec failing the run with the "resource unknown"
[2014-03-12 19:36:33 -0400] ddr_: hi all
[2014-03-12 19:36:59 -0400] ddr_: can i somehow get notify when new node registered on chef server?
[2014-03-12 19:39:58 -0400] cheeseprocedure: ddr_: i've been wondering the same thing recently
[2014-03-12 19:45:51 -0400] cheeseprocedure: running chef-server 11.0.8-1.ubuntu.12.04, it seems you can watch the contents of /var/log/chef-server/erchef/erchef.log.1 to detect relevant events
[2014-03-12 19:46:41 -0400] cheeseprocedure: e.g. 2014-03-05T22:47:38Z erchef@127.0.0.1 INFO req_id=xxxxxxxx; status=201; method=POST; path=/nodes; user=chef-node-xx; msg={created,<<"chef-node-xx">>}; req_time=18; rdbms_time=6; rdbms_count=2
[2014-03-12 20:43:40 -0400] werdnativ: Why does Berkshelf have anything to do with Vagrant?
[2014-03-12 20:44:21 -0400] werdnativ: Or is that going away with the deprecation of vagrant-bershelf?
[2014-03-12 20:44:30 -0400] werdnativ: Just looking at: https://github.com/berkshelf/berkshelf/wiki/Howto:-Use-the-bleeding-edge
[2014-03-12 20:45:02 -0400] werdnativ: And wondering what is going to be the way forward.
[2014-03-12 20:45:58 -0400] martinisoft: werdnativ: https://sethvargo.com/the-future-of-vagrant-berkshelf/ <- detailed there
[2014-03-12 20:46:29 -0400] werdnativ: martinisoft: yes, aware of that. I'm wondering why it's still being pushed as "bleeding edge"
[2014-03-12 20:47:23 -0400] martinisoft: werdnativ: more weight behind Berkshelf 3.0 than 2 for 'bleeding edge' and does not have anything to do with Vagrant if I recall
[2014-03-12 20:48:04 -0400] martinisoft: werdnativ: the vagrant-berkshelf plugin is separate from Berkshelf
[2014-03-12 20:48:29 -0400] werdnativ: yes, I know that. But that's why I'm wondering why berkshelf itself has vagrant bits.
[2014-03-12 20:48:46 -0400] werdnativ: So Berkshelf 3 drops the vagrant bits, and hands it off to another tool (test-kitchen or vagrant-berkshelf)?
[2014-03-12 20:48:59 -0400] martinisoft: vagrant-berkshelf mainly
[2014-03-12 20:49:10 -0400] werdnativ: or https://github.com/test-kitchen/kitchen-vagrant ?
[2014-03-12 20:49:21 -0400] werdnativ: too many things! :)
[2014-03-12 20:49:36 -0400] martinisoft: kitchen-vagrant is a test-kitchen plugin for vagrant support
[2014-03-12 20:49:47 -0400] martinisoft: vagrant-berkshelf is a Vagrant plugin for Berkshelf
[2014-03-12 20:49:51 -0400] martinisoft: separate
[2014-03-12 20:49:55 -0400] werdnativ: right of course...
[2014-03-12 20:50:08 -0400] werdnativ: forgot what all the plugins I had installed were for.
[2014-03-12 20:53:57 -0400] werdnativ: https://github.com/berkshelf/berkshelf/wiki/2.x-to-3.0-Upgrade-Guide shows that berkshelf will still deal with vagrant directly: no mention of how vagrant-berkshelf fits into it.
[2014-03-12 20:55:16 -0400] mconigliaro: hey guys, is there a simple way to get the chef version inside a recipe?
[2014-03-12 20:55:53 -0400] jtimberman: mconigliaro: node['chef_packages']['chef']['version']
[2014-03-12 20:56:08 -0400] mconigliaro: really? does that work on 11 too?
[2014-03-12 20:56:10 -0400] mconigliaro: err, 10?
[2014-03-12 20:56:42 -0400] jtimberman: yes
[2014-03-12 20:56:49 -0400] jtimberman: that's been an ohai attribute for a long time
[2014-03-12 20:56:59 -0400] mconigliaro: if not, looks like i can use Chef.VERSION
[2014-03-12 20:57:04 -0400] mconigliaro: https://github.com/opscode/chef/blob/master/lib/chef/version.rb
[2014-03-12 20:57:10 -0400] mconigliaro: ok, ill try the node attribute
[2014-03-12 20:57:11 -0400] mconigliaro: thanks!
[2014-03-12 20:57:32 -0400] jtimberman: sure, Chef::VERSION would work too. Less typing.
[2014-03-12 20:57:37 -0400] jtimberman: if you're doing it in a recipe :)
[2014-03-12 20:58:25 -0400] mconigliaro: hmm, i have an old chef server that doesn't have chef_packages/chef/version
[2014-03-12 20:58:29 -0400] mconigliaro: not sure why
[2014-03-12 20:58:38 -0400] mconigliaro: it has ohai's version
[2014-03-12 20:59:25 -0400] dgarstang: I'm wondering if anyone packages up their chef cookbooks with say, a debian package, and then runs chef-solo against that locally for a deploy of apps?
[2014-03-12 21:01:01 -0400] paulmooring: dgarstang that's pretty close to what omnibus does
[2014-03-12 21:01:40 -0400] dgarstang: paulmooring: Doesn't that just install chef?
[2014-03-12 21:01:46 -0400] dgarstang: (and other bits...)
[2014-03-12 21:02:09 -0400] paulmooring: dgarstang https://github.com/opscode/omnibus-chef-server
[2014-03-12 21:02:36 -0400] dgarstang: 'The omnibus installer is used to install Chef on a server, a workstation'... installs chef
[2014-03-12 21:03:03 -0400] paulmooring: in the files folder are cookbooks and such for chef-server-ctl
[2014-03-12 21:03:11 -0400] paulmooring: which is driven by chef-solo
[2014-03-12 21:03:35 -0400] dgarstang: paulmooring: I'm not talking about the config of chef itself. :)
[2014-03-12 21:03:48 -0400] dgarstang: oh but I think I see what your saying
[2014-03-12 21:04:08 -0400] dgarstang: whether that could be modified to suit our use, I dont know. a debian package is a lot easier
[2014-03-12 21:04:20 -0400] paulmooring: yeah it's not exactly the same, but it does bundle chef-solo for management
[2014-03-12 21:13:49 -0400] Trinitro1X: What's the best practices way of forcing an apt-get update before installing a package?
[2014-03-12 21:14:46 -0400] Trinitro1X: I'm getting consistent apt errors when using some of the stock opscode test-kitchen VMs, and I've tried using:  include_recipe 'apt'  in my cookbook before installing a pacakge, but it's still trying to install the package before running apt-get update
[2014-03-12 21:15:14 -0400] coderanger: Trinitro1X: Are you trying to install packages at compile time?
[2014-03-12 21:16:34 -0400] Trinitro1X: @coderanger: not that I know of... how can I tell if this is the case?
[2014-03-12 21:17:00 -0400] coderanger: Trinitro1X: What package is failing to install and where
[2014-03-12 21:17:27 -0400] Trinitro1X: package[postgresql-client-9.1]  and for some reason it's trying to install it directly after running ohai[custom_plugins]
[2014-03-12 21:18:29 -0400] coderanger: Trinitro1X: Yeah, thats at compile time
[2014-03-12 21:18:37 -0400] coderanger: Trinitro1X: Check out the now cookbook
[2014-03-12 21:18:45 -0400] coderanger: You'll want to change that to include_recipe_now 'apt'
[2014-03-12 21:19:21 -0400] Trinitro1X: I'm wondering why it's trying to do it at compile time though... is it something to do with that pg chef_gem that the postgresql cookbook installs?
[2014-03-12 21:19:47 -0400] shawn_sher: I didn't know that include_recipe_now was a thing
[2014-03-12 21:20:03 -0400] Trinitro1X: yeah, that's a new thing to me too
[2014-03-12 21:20:31 -0400] silk: +1
[2014-03-12 21:20:42 -0400] coderanger: Trinitro1X: The full chain is that it needs to install the pq client lib so it can install the pq gem because thats used by the database cookbook and similar for idempotence checks
[2014-03-12 21:20:48 -0400] coderanger: (usually anyway)
[2014-03-12 21:22:09 -0400] Trinitro1X: interesting... so that cookbook gets all of its resources run at compile phase?
[2014-03-12 21:27:15 -0400] coderanger: Which cookbook?
[2014-03-12 21:30:51 -0400] Trinitro1X: Well, it's a large chain of dependencies
[2014-03-12 21:31:16 -0400] Trinitro1X: I've got a cookbook for something called "laravel", which I'm modifying to use postgres with the database cookbook
[2014-03-12 21:31:20 -0400] coderanger: Are you using teh database cookbook
[2014-03-12 21:31:23 -0400] coderanger: yeah
[2014-03-12 21:31:31 -0400] Trinitro1X: yeah, it looks like that's requiring 'postgresql::ruby'
[2014-03-12 21:31:40 -0400] Trinitro1X: and there lies our culprit
[2014-03-12 21:31:43 -0400] coderanger: Indeed
[2014-03-12 21:31:48 -0400] coderanger: :-)
[2014-03-12 21:31:56 -0400] coderanger: That tries to install the pg gem
[2014-03-12 21:31:59 -0400] coderanger: which needs libpq
[2014-03-12 21:32:26 -0400] sarkis: we want upstart to manage a service, however, the package installs it using init.d... can we do create a chef service with provider Chef::Provider::Service::Init::Debian, and set that to :disable, :stop.. then create another service with  provider Chef::Provider::Service::Upstart and enable start?
[2014-03-12 21:32:42 -0400] Trinitro1X: @coderanger: Thanks for helping me find that out
[2014-03-12 21:33:14 -0400] coderanger: Trinitro1X: inclue_recipe_now is just a hack (and oh boy is it a hack) to force ordering a bit more
[2014-03-12 21:33:21 -0400] Trinitro1X: @coderanger: That was hidden through many cookbook include's and wasn't sure why it was happening at compiletime
[2014-03-12 21:33:41 -0400] Trinitro1X: yeah, I hope this gets better in chef 12 like the 'now' cookbook says
[2014-03-12 21:34:32 -0400] sarkis: i would have the init resource only fired off if the package is upgraded?
[2014-03-12 21:36:07 -0400] coderanger: Trinitro1X: If you want more fine-grained control over this kind of stuff, poise has your back
[2014-03-12 21:36:31 -0400] coderanger: sarkis: You can, but make sure they have different names
[2014-03-12 21:36:37 -0400] coderanger: lest they overwrite each other
[2014-03-12 21:36:42 -0400] sarkis: right
[2014-03-12 21:37:09 -0400] sarkis: cool so that will work then.. ty
[2014-03-12 21:37:12 -0400] sarkis: giving it a go
[2014-03-12 21:37:21 -0400] coderanger: sarkis: service 'foo-old' do service_name 'foo'; provider Init; action :disable end
[2014-03-12 21:37:25 -0400] coderanger: or somesuch
[2014-03-12 21:38:24 -0400] coalbe: to install nginx via source, all i need to do is to set the source version to which i want and include the recipe nginx::source right/include dep? its installing in nonstandard places. and oddly.
[2014-03-12 21:38:24 -0400] Trinitro1X: Thanks @coderanger!  You're awesome ^_^
[2014-03-12 21:39:34 -0400] coalbe: im setting source to 1.4.1, which it *does* install, but the paths are not default
[2014-03-12 21:39:50 -0400] coalbe: and its prefixing a totally different version to the opt directory
[2014-03-12 21:42:01 -0400] sarkis: is there a chef style guide? like where to use ' ' vs " " etc
[2014-03-12 21:42:23 -0400] doomviking: pants optional
[2014-03-12 21:42:28 -0400] sarkis: haha
[2014-03-12 21:43:12 -0400] coderanger: sarkis: Thats more a generic ruby things
[2014-03-12 21:43:22 -0400] coderanger: "" alows string interpolation and backslash escapes
[2014-03-12 21:43:23 -0400] coderanger: '' doesn't
[2014-03-12 21:44:47 -0400] fraterlaetus: I'm trying to write an Ohai plugin.
[2014-03-12 21:44:51 -0400] fraterlaetus: https://gist.github.com/dstynchula/9516979
[2014-03-12 21:45:07 -0400] fraterlaetus: the plugin copies over as designed, seems to execute,
[2014-03-12 21:45:14 -0400] fraterlaetus: but in the end, the attribute is not being set.
[2014-03-12 21:45:18 -0400] fraterlaetus: what am I doing wrong?
[2014-03-12 21:47:21 -0400] coderanger: fraterlaetus: Are you sure you are running ohai 7?
[2014-03-12 21:47:52 -0400] fraterlaetus: ahh.
[2014-03-12 21:47:55 -0400] fraterlaetus: Ohai: 6.20.0
[2014-03-12 21:48:05 -0400] coderanger: Yeah, that syntax is new for ohai 7
[2014-03-12 21:48:18 -0400] coderanger: I think anyway
[2014-03-12 21:49:41 -0400] fraterlaetus: if I do a knife cookbook site download ohai
[2014-03-12 21:49:46 -0400] fraterlaetus: will it grab v7?
[2014-03-12 21:49:56 -0400] fraterlaetus: I'm a little fuzzy on chef's version handling
[2014-03-12 21:50:02 -0400] coderanger: No, the version of ohai is tied to the version of chef
[2014-03-12 21:50:24 -0400] fraterlaetus: So, I have to upgrade chef to upgrade ohai?
[2014-03-12 21:51:12 -0400] coderanger: I don't think ohai 7 has even been released yet
[2014-03-12 21:51:34 -0400] coderanger: yeah, there is a rc0 out from January
[2014-03-12 21:51:40 -0400] coderanger: but the release version is still 6
[2014-03-12 21:51:51 -0400] fraterlaetus: is the syntax for 6 drastically different?
[2014-03-12 21:51:54 -0400] coderanger: Just rewrite your plugin using the old syntax
[2014-03-12 21:51:56 -0400] coderanger: yes, very
[2014-03-12 21:52:04 -0400] coderanger: But the core logic will carry over just fine
[2014-03-12 21:53:06 -0400] fraterlaetus: sweet
[2014-03-12 21:53:08 -0400] fraterlaetus: thanks!
[2014-03-12 21:53:27 -0400] coderanger: fraterlaetus: https://github.com/coderanger/ohai-example/blob/master/files/default/plugins/ohai_example.rb
[2014-03-12 21:53:32 -0400] coderanger: That might help a bit
[2014-03-12 21:53:42 -0400] fraterlaetus: man, thanks a bunch.
[2014-03-12 21:53:47 -0400] fraterlaetus: I was getting super frustrated/
[2014-03-12 21:53:49 -0400] fraterlaetus: :)
[2014-03-12 21:54:40 -0400] coderanger: Yeah, Opscode shouldn't have changed the docs to Ohai 7
[2014-03-12 21:54:52 -0400] coderanger: but I've more or less given up on those docs at this point
[2014-03-12 22:03:16 -0400] therealkoopa: I have some server "seaport", and I'd like a recipe to run on it that will find all nodes m anaged by chef, and update each /etc/hosts file so it knows about the seaport server. Is this the best way to handle it? Have the seaport cookbook update other nodes?
[2014-03-12 22:04:00 -0400] fraterlaetus: coderanger: any idea what version of ruby the bootstrapper uses?
[2014-03-12 22:04:25 -0400] coderanger: therealkoopa: Run a recipe on every node that does a search against the chef-server and generates a hostsfile, I'm pretty sure this exists already too
[2014-03-12 22:04:28 -0400] coderanger: fraterlaetus: 1.9.3 IIRC
[2014-03-12 22:06:18 -0400] shlant: coderanger: any easy way to have minitest only include recipe directly specified in the run list? or is this how I need to do it? https://groups.google.com/forum/#!msg/chef-testing/yDtELp2Jjj8/nfAdxSzUhQMJ
[2014-03-12 22:06:34 -0400] coalbe: the opscode hostsfile is nice support for appending another to the hosts file.
[2014-03-12 22:06:57 -0400] coderanger: shlant: Not sure I understand
[2014-03-12 22:07:42 -0400] pabst^: anyone ever seen this on a template error: undefined method `each' for nil:NilClass
[2014-03-12 22:07:56 -0400] shlant: minitest by default includes all recipes. Even include_recipe within recipes. I want to only run tests that pertain to my custom recipes.
[2014-03-12 22:08:16 -0400] shlant: with out specifying them in each role or something
[2014-03-12 22:08:58 -0400] coderanger: pabst^: Usually means you are trying to loop over a node attribute that doesn't have a default value set
[2014-03-12 22:09:41 -0400] coderanger: shlant: By default chef-minitest only runs tests for recipes that ran as part of the converge
[2014-03-12 22:09:45 -0400] pabst^: @coderanger: ty... im not sure why though, this recipe normally works fine. I guess I am trying to figure out if something changed in a newer version of chef with templates :/
[2014-03-12 22:09:53 -0400] coderanger: pabst^: Pastebin?
[2014-03-12 22:11:15 -0400] coderanger: fraterlaetus: https://github.com/opscode/chef-docs/commit/948f3db8946da38427a2196704ab6b553ce9e288 updated, should help in the future :-)
[2014-03-12 22:12:00 -0400] pabst^: coderanger: nope. just ingore me. was dumb. I see what I did. I did dumb. I need to be banished.
[2014-03-12 22:12:30 -0400] pabst^: :q
[2014-03-12 22:13:18 -0400] dgarstang: I cannot work out wht this means "could not find recipe sources for cookbook bc-apt". Does that means it's trying to find a recipe called 'sources' or is it talking in more generic terms?
[2014-03-12 22:13:50 -0400] coderanger: dgarstang: It is looking for bc-apt/recipes/sources.rb
[2014-03-12 22:13:55 -0400] coderanger: which doesn't seem to exist
[2014-03-12 22:14:08 -0400] dgarstang: coderanger: k, thanks
[2014-03-12 22:15:50 -0400] PeterO: I have a best practices question about deployments.. it kind of applies to Chef : What is the best way to deploy conf files? Include conf files as part of the deployment?
[2014-03-12 22:17:29 -0400] coderanger: PeterO: Not sure what you mean exactly, but generally it would just a template resource
[2014-03-12 22:18:17 -0400] PeterO: coderanger: I'm playing around with AWS DevOps and I'm just trying to figure out the best way to have config files like MySQL connection strings on the auto-scaled servers.
[2014-03-12 22:18:29 -0400] EricL_: Does anyone know how to specify a custom template for a contact in the Nagios cookbook?
[2014-03-12 22:18:50 -0400] coderanger: PeterO: That is unfortunately a very complex topic :-)
[2014-03-12 22:19:01 -0400] coderanger: PeterO: Do you mean AWS OpsWorks?
[2014-03-12 22:19:11 -0400] PeterO: coderanger: That's the one. Whoops
[2014-03-12 22:19:30 -0400] drywheat: is there a good community ckbk for creating persisted environment variables?
[2014-03-12 22:20:06 -0400] coderanger: PeterO: So OpsWorks doesn't offer chef-level state management, your recipes would have to query the relevant AWS APIs directly to get state data about things like "what is the IP of the MySQL server"
[2014-03-12 22:20:36 -0400] drywheat: i could just write a recipe for creating /etc/profile.d/ files, but i wanted to check first
[2014-03-12 22:20:48 -0400] coderanger: drywheat: In almost 100% of cases, that is a trap
[2014-03-12 22:21:09 -0400] coderanger: drywheat: There isn't a great way to define env vars globally in unix
[2014-03-12 22:21:43 -0400] coderanger: drywheat: So basically "don't do that" :-(
[2014-03-12 22:22:05 -0400] fraterlaetus: drywheat: Why not have a databag dump a .bashrc?
[2014-03-12 22:22:21 -0400] coderanger: fraterlaetus: Because non-interactive shell logins and non-shell logins don't run that
[2014-03-12 22:22:31 -0400] fraterlaetus: that doesn't matter
[2014-03-12 22:22:52 -0400] fraterlaetus: what I do is dump a .envvariables file with chef
[2014-03-12 22:22:56 -0400] coderanger: fraterlaetus: Saying "that doesn't matter" is highly situation specific, and usually comes back to bite you
[2014-03-12 22:23:07 -0400] fraterlaetus: and have a source .envvariables in the .bashrc
[2014-03-12 22:23:13 -0400] drywheat: coderanger: i really think it depends on the use case; absolutes concern me
[2014-03-12 22:23:15 -0400] fraterlaetus: if you need to run a non-interactive
[2014-03-12 22:23:22 -0400] coderanger: First time someone runs a cron job, or an SSH command, or a service, you'll find it matters quite a bit
[2014-03-12 22:23:39 -0400] fraterlaetus: than you can source .envvariables in the beginning of the script
[2014-03-12 22:23:54 -0400] coderanger: drywheat: Trying to set global env vars is a "dangerous feature", there are ways to do it, but it is usually fragile at the best of times and thus best avoided if at all possible
[2014-03-12 22:24:35 -0400] fraterlaetus: that works like a charm
[2014-03-12 22:24:36 -0400] coderanger: Just fixed a bug this morning because chef behaved differently on service vs. interactive thanks to $LANG and $LC_ALL :-)
[2014-03-12 22:24:54 -0400] fraterlaetus: I'm with ranger though, I wouldn't set it globally
[2014-03-12 22:25:27 -0400] drywheat: coderanger: you're right about having to know the details about what kind of shell a process is running
[2014-03-12 22:26:08 -0400] drywheat: so, in my case, i launch a rails app using unicorn
[2014-03-12 22:26:31 -0400] fraterlaetus: What I do is generate a .railsenv file
[2014-03-12 22:26:47 -0400] fraterlaetus: and have the script that calls rake/unicorn/etc...
[2014-03-12 22:26:54 -0400] fraterlaetus: #!/bin/bash
[2014-03-12 22:26:58 -0400] fraterlaetus: source .railsenv
[2014-03-12 22:27:03 -0400] fraterlaetus: cd /workingdir
[2014-03-12 22:27:18 -0400] coderanger: Yeah, thats a lot more predictable than a "global" :)
[2014-03-12 22:27:21 -0400] fraterlaetus: unicorn/rake/etc...
[2014-03-12 22:27:34 -0400] fraterlaetus: you can call the script any number of ways
[2014-03-12 22:27:43 -0400] drywheat: i'm able to run the process by setting vars solely for the process when it launches
[2014-03-12 22:27:51 -0400] drywheat: no global envvar
[2014-03-12 22:28:00 -0400] fraterlaetus: and if you want to change the environment vars, you edit the data bag.
[2014-03-12 22:28:08 -0400] drywheat: but now i need to have that available to for devs to launch a console if need be
[2014-03-12 22:28:17 -0400] fraterlaetus: so, like I said,
[2014-03-12 22:28:21 -0400] fraterlaetus: create a .railsenv
[2014-03-12 22:28:23 -0400] drywheat: fraterlaetus: i'm going to explore these options
[2014-03-12 22:28:27 -0400] fraterlaetus: and in the .bashrc
[2014-03-12 22:28:30 -0400] fraterlaetus: first line
[2014-03-12 22:28:33 -0400] fraterlaetus: source .railsenv
[2014-03-12 22:28:38 -0400] fraterlaetus: voila
[2014-03-12 22:28:46 -0400] fraterlaetus: they can rake console like a boss
[2014-03-12 22:32:03 -0400] shlant: anyone have troubleshooting step for Temporary failure in name resolution with vagrant-omnibus? I can ping getchef.com...
[2014-03-12 22:39:32 -0400] fraterlaetus: Ok, so I changed the syntax to match ohai6 plugin spec
[2014-03-12 22:40:00 -0400] fraterlaetus: the plugin loads, runs, and executes sans-exception
[2014-03-12 22:40:08 -0400] fraterlaetus: but the attribute is not getting set.
[2014-03-12 22:40:09 -0400] fraterlaetus: https://gist.github.com/dstynchula/9516979
[2014-03-12 22:40:23 -0400] fraterlaetus: Where did I bork this up?
[2014-03-12 22:40:44 -0400] coderanger: fraterlaetus: Remove the = on the second line
[2014-03-12 22:40:54 -0400] coderanger: fraterlaetus: Just "unpartitioned <value>"
[2014-03-12 22:40:57 -0400] drywheat: fraterlaetus: thx for the tip :thumbsup:
[2014-03-12 22:41:48 -0400] fraterlaetus: @drywheat no problem man! I ran into precisely the same issue with my team
[2014-03-12 22:42:00 -0400] fraterlaetus: just passing along the goodness
[2014-03-12 22:42:02 -0400] fraterlaetus: :)
[2014-03-12 22:45:35 -0400] benathuge: hello all
[2014-03-12 22:45:50 -0400] benathuge: does anyone here use knife solo?
[2014-03-12 22:45:59 -0400] coderanger: benathuge: I have before, whats up
[2014-03-12 22:46:04 -0400] fraterlaetus: @coderanger: What do I use for 'value'
[2014-03-12 22:46:06 -0400] fraterlaetus: ?
[2014-03-12 22:46:23 -0400] coderanger: fraterlaetus: You have Array.new
[2014-03-12 22:46:27 -0400] coderanger: or [] which is the same thing
[2014-03-12 22:46:28 -0400] fraterlaetus: Ahh
[2014-03-12 22:46:41 -0400] benathuge: @coderanger i'm attempting provision some ec2 boxes with it, everything is fine until
[2014-03-12 22:46:44 -0400] benathuge: @coderanger [2014-03-12T18:40:39-04:00] ERROR: Cookbook yum not found. If you're loading yum from another cookbook, make sure you configure the dependency in your metadata
[2014-03-12 22:46:46 -0400] fraterlaetus: so I can just "unpartitioned Array.new"
[2014-03-12 22:46:46 -0400] fraterlaetus: ?
[2014-03-12 22:46:52 -0400] coderanger: fraterlaetus: Yes
[2014-03-12 22:46:54 -0400] flaccid_: coderanger: got a sec to do an idiot check for me? this guy doesn't seem fixed https://github.com/priestjim/chef-rundeck/pull/2 and i think its coz of action :nothing on the user resource, https://github.com/priestjim/chef-rundeck/commit/4d06d557e12da571548571ec772825696d6ae200 - is that right?
[2014-03-12 22:47:23 -0400] benathuge: @coderanger but it's in the metadata.rb of one of my cookbooks
[2014-03-12 22:47:39 -0400] benathuge: @coderanger i'm following these directions: http://www.captnswing.net/2013/01/from-vagrant-to-ec2-with-knife-solo.html
[2014-03-12 22:48:29 -0400] benathuge: @coderanger any ideas?
[2014-03-12 22:51:08 -0400] fraterlaetus: So, I did that, and it's the same. Runs, seems to be fine in debug,
[2014-03-12 22:51:43 -0400] fraterlaetus: but "ohai unpartitioned" produces "/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.20.0/lib/ohai/system.rb:247:in `attributes_print': I cannot find an attribute named unpartitioned! (ArgumentError)"
[2014-03-12 22:58:07 -0400] benathuge: @coderanger :(
[2014-03-12 22:58:24 -0400] coderanger: benathuge: Doing some code review, one moment
[2014-03-12 22:58:40 -0400] benathuge: @coderanger no problem
[2014-03-12 23:08:40 -0400] dgarstang: i hope I'm looking at a old post. Does chef-solo support chef environments?
[2014-03-12 23:09:06 -0400] coderanger: dgarstang: Yes, in a limited way
[2014-03-12 23:09:52 -0400] dgarstang: coderanger: Oh?
[2014-03-12 23:10:30 -0400] coderanger: dgarstang: the cookbook version constraints can't apply as solo doesn't do version solution itself
[2014-03-12 23:11:01 -0400] dgarstang: coderanger: I think that's ok, cuz I'd be wrapping the cookbooks up in a package.
[2014-03-12 23:11:12 -0400] coderanger: benathuge: Hmm, do you see yum in your berksfile.lock?
[2014-03-12 23:11:30 -0400] benathuge: @coderanger this is my berksfile.lock
[2014-03-12 23:11:38 -0400] benathuge: {
[2014-03-12 23:11:38 -0400] benathuge:   "sources": {
[2014-03-12 23:11:39 -0400] benathuge:   }
[2014-03-12 23:11:39 -0400] benathuge: }
[2014-03-12 23:11:55 -0400] coderanger: benathuge: So nothing there would explain some badness
[2014-03-12 23:12:00 -0400] benathuge: @coderanger right
[2014-03-12 23:12:12 -0400] coderanger: benathuge: What does your berksfile look like?
[2014-03-12 23:12:17 -0400] benathuge: @coderanger the berksfile.lock in my vagrant folder has a lot more
[2014-03-12 23:12:29 -0400] fraterlaetus: So the same behavior is happening. the ohai plugin downloads and runs sans exception
[2014-03-12 23:12:36 -0400] coderanger: benathuge: folder?
[2014-03-12 23:12:41 -0400] benathuge: @coderanger only site :opscode
[2014-03-12 23:12:42 -0400] fraterlaetus: but the attribute never gets returned.
[2014-03-12 23:12:43 -0400] fraterlaetus: https://gist.github.com/dstynchula/9516979
[2014-03-12 23:12:47 -0400] coderanger: fraterlaetus: Are you running ohai -l debug?
[2014-03-12 23:12:50 -0400] benathuge: @coderanger i have vagrant in another folder
[2014-03-12 23:13:00 -0400] coderanger: fraterlaetus: By default it assumes plugin crashes are normal
[2014-03-12 23:13:06 -0400] benathuge: @coderanger i'm using those recipes and roles
[2014-03-12 23:13:16 -0400] fraterlaetus: I'm running chef-client -o "recipe[ohai]" -l debig
[2014-03-12 23:13:21 -0400] fraterlaetus: (bug)
[2014-03-12 23:13:26 -0400] fraterlaetus: is that the same?
[2014-03-12 23:13:41 -0400] coderanger: Yeah, that passes the log level on
[2014-03-12 23:13:48 -0400] coderanger: You should see the output from your plugin
[2014-03-12 23:14:20 -0400] coderanger: fraterlaetus: Try my little example plugin just to make sure its the plugin itself failing and not something else
[2014-03-12 23:14:34 -0400] coderanger: benathuge: Not sure why this guide tells you to use different folders
[2014-03-12 23:14:54 -0400] coderanger: benathuge: You need to be in the folder with the Berksfil when you run knife solo
[2014-03-12 23:14:55 -0400] benathuge: @coderanger should i do knife solo init inside my vagrant folder?
[2014-03-12 23:15:16 -0400] coderanger: benathuge: There should just be the cookbook folder, the fact that it has a vagrantfile is incidental
[2014-03-12 23:15:25 -0400] benathuge: @coderanger fair enough
[2014-03-12 23:16:26 -0400] fraterlaetus: willco
[2014-03-12 23:20:14 -0400] fraterlaetus: @coderanger: lost the link, can you retrans?
[2014-03-12 23:20:35 -0400] coderanger: fraterlaetus: github.com/coderanger/ohai-example/tree/master/files/default/plugins
[2014-03-12 23:20:43 -0400] coderanger: If that link works I'll be sad >_<
[2014-03-12 23:21:08 -0400] fraterlaetus: it worked.
[2014-03-12 23:21:09 -0400] fraterlaetus: :)
[2014-03-12 23:21:10 -0400] coderanger: Oy, totally worked, I didn't paste that, I just have github's URL generator stuck in my brain now
[2014-03-12 23:24:42 -0400] fraterlaetus: ok ranger: same thing, plugin loaded, but attribute unset.
[2014-03-12 23:24:47 -0400] fraterlaetus: what am I borking?
[2014-03-12 23:25:58 -0400] coderanger: fraterlaetus: How are you checking the attribute?
[2014-03-12 23:26:16 -0400] coderanger: My ohai-example cookbook has a kitchen test so I know for a fact it works :-)
[2014-03-12 23:26:34 -0400] dgarstang: I don't get it. "Chef::Exceptions::EnvironmentNotFound: Environment 'dev' could not be loaded from disk" but "ls -l ../../chef-sauce/environments" shows dev.json
[2014-03-12 23:26:45 -0400] coderanger: (cue programmer hubris theme music)
[2014-03-12 23:27:02 -0400] coderanger: dgarstang: Are you giving solo the path to the envs folder?
[2014-03-12 23:27:20 -0400] dgarstang: coderanger: I am. chef.environments_path = "../../chef-sauce/environments"
[2014-03-12 23:28:09 -0400] coderanger: dgarstang: Thats being set in vagrant?
[2014-03-12 23:28:16 -0400] dgarstang: coderanger: Correct
[2014-03-12 23:28:21 -0400] fraterlaetus: coderanger: I have no doubt it 'works'
[2014-03-12 23:28:26 -0400] fraterlaetus: I'm doing something wrong.
[2014-03-12 23:28:39 -0400] fraterlaetus: what I'm doing to test is twofold
[2014-03-12 23:28:45 -0400] fraterlaetus: one is ohai example
[2014-03-12 23:28:49 -0400] fraterlaetus: on the node itself
[2014-03-12 23:28:52 -0400] coderanger: dgarstang: as a random guess, its possible using a relative path is breaking something inside the VM vs. outside
[2014-03-12 23:28:56 -0400] fraterlaetus: the other is from the chef workstation
[2014-03-12 23:29:03 -0400] dgarstang: coderanger: Works for cookbooks_path. :)
[2014-03-12 23:29:18 -0400] fraterlaetus: knife node show TestSubject1 -a example
[2014-03-12 23:29:20 -0400] coderanger: dgarstang: Yeah, that one has special handling vs role|databag|envs
[2014-03-12 23:29:31 -0400] coderanger: fraterlaetus: Aha, so first issue is also twofold
[2014-03-12 23:29:48 -0400] dgarstang: coderanger: Ugh
[2014-03-12 23:30:03 -0400] coderanger: fraterlaetus: 1) chef-client -o doesn't save the node object 2) knife node show doesn't display automatic level attrs by default
[2014-03-12 23:30:15 -0400] dgarstang: coderanger: No, wait. partial user error. I added after vm was up.
[2014-03-12 23:30:26 -0400] coderanger: dgarstang: try a reload
[2014-03-12 23:30:35 -0400] dgarstang: coderanger: yah
[2014-03-12 23:30:41 -0400] Dairenn: On options in yum_package, do you include the --?
[2014-03-12 23:31:39 -0400] fraterlaetus: ahh
[2014-03-12 23:32:29 -0400] coderanger: fraterlaetus: To fix #2, use the --long option
[2014-03-12 23:33:24 -0400] fraterlaetus: ah HA!
[2014-03-12 23:33:36 -0400] fraterlaetus: mister, you've just made my day!
[2014-03-12 23:34:15 -0400] PeterO: What's the best way to emulate the rpm -Uvh command?
[2014-03-12 23:34:22 -0400] coderanger: PeterO: Emulate?
[2014-03-12 23:34:26 -0400] spheromak: emulate ?
[2014-03-12 23:34:29 -0400] spheromak: coderanger: jinx
[2014-03-12 23:34:35 -0400] PeterO: apparently the wrong word
[2014-03-12 23:34:43 -0400] coderanger: spheromak: Time for thunderdome
[2014-03-12 23:34:44 -0400] PeterO: to duplicate?
[2014-03-12 23:34:58 -0400] coderanger: PeterO: Don't, if thats the command you want to run, just run it
[2014-03-12 23:35:15 -0400] PeterO: coderanger: How though?
[2014-03-12 23:35:53 -0400] coderanger: PeterO: Are you trying to upgrade a yum package or a raw RPM?
[2014-03-12 23:36:12 -0400] PeterO: I'm trying to install a repo so then I can install a package.
[2014-03-12 23:37:33 -0400] coderanger: PeterO: there is a yum_repository resource
[2014-03-12 23:37:54 -0400] spheromak: um cook + yum_repo lwrp
[2014-03-12 23:37:57 -0400] spheromak: *yum
[2014-03-12 23:38:28 -0400] coderanger: yeah, that
[2014-03-12 23:42:42 -0400] PeterO: ah thanks
[2014-03-12 23:42:44 -0400] PeterO: got it
[2014-03-12 23:44:12 -0400] coderanger: PeterO: For individual packages, the package resource has an :upgrade action
