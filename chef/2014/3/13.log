[2014-03-13 00:43:34 -0400] gfunky: Anyone ever see a chef-solo run on centos spontaneously think it was a freebds box? this happens in ark cookbook:
[2014-03-13 00:43:35 -0400] gfunky: pkgs += %w(gtar) if platform?('freebsd')
[2014-03-13 00:56:13 -0400] forg0t: Hi, in the newest version of the mysql cookbook the suggestions for homebrew and windows have been changed to dependencies. But this forces me to depend on those too, even though I have a pure linux setup. Is there a workaround for this?
[2014-03-13 00:56:36 -0400] coderanger: forg0t: No, nor should it be a problem
[2014-03-13 01:11:02 -0400] silk: We are seeing intermittanf connectivity / availability with hosted opscode server, are there any known issues?
[2014-03-13 01:12:27 -0400] coderanger: silk: Probably better off emailing ChefInc support
[2014-03-13 01:12:40 -0400] silk: have done :)
[2014-03-13 01:13:29 -0400] coderanger: silk: I've not see anything from the automated status feeds, but that doesn't mean much
[2014-03-13 01:13:46 -0400] silk: yeah, I checked those
[2014-03-13 01:13:57 -0400] silk: this is flapping behaviour, for quite a while now
[2014-03-13 01:21:24 -0400] erasmose: Hello, anybody knows why whenever I do vagrant provision, it tries to install Omnibus again? It downloads 24Mb omnibus .dev but it is very annoying and it takes a while on slow networks
[2014-03-13 01:21:43 -0400] erasmose: Is there anyway to stop this behavior?
[2014-03-13 01:21:55 -0400] coderanger: erasmose: Thats just how the vagrant plugin works, it is idempotent
[2014-03-13 01:22:15 -0400] erasmose: So this really bugs me
[2014-03-13 01:22:58 -0400] erasmose: And I don't get why it can't only download it if there is a new Omnibus
[2014-03-13 01:23:15 -0400] erasmose: What does that have to do with being idempotent
[2014-03-13 01:23:16 -0400] erasmose: ?
[2014-03-13 01:24:41 -0400] PeterO: Yay!! I just (finally) managed to get a recipe to work on OpsWorks!!!
[2014-03-13 01:25:16 -0400] coderanger: erasmose: Because the vagrant plugin doesn't know what version you have installed
[2014-03-13 01:26:36 -0400] erasmose: coderanger: thanks for the info
[2014-03-13 01:29:16 -0400] erasmose: Personally I think it should have some way of checking when I run vagrant provision a couple of times an hour. I guess I have to dig into the vagrant plugin code
[2014-03-13 01:32:01 -0400] coderanger: erasmose: vagrant+cachier is probably your best option right now
[2014-03-13 01:32:40 -0400] erasmose: interesting
[2014-03-13 01:32:49 -0400] erasmose: I'm gonna try it right now
[2014-03-13 01:44:26 -0400] gfunky: Is there any way to specify in my metadata.rb "Hey, don't grab any deps that require chef 11" or "chef 11 required for this cookbook"?
[2014-03-13 01:46:55 -0400] benathuge: @coderanger still there?
[2014-03-13 01:47:01 -0400] coderanger: benathuge: Indeed
[2014-03-13 01:47:06 -0400] coderanger: gfunky: No
[2014-03-13 01:47:09 -0400] benathuge: @coderanger excellent :)
[2014-03-13 01:47:32 -0400] benathuge: @coderanger so i did a knife solo init . inside my vagrant directory, which is also a cookbook
[2014-03-13 01:47:36 -0400] gfunky: @coderanger: bummer. thank you.
[2014-03-13 01:47:58 -0400] benathuge: @coderanger but knife solo if failing to find the cookbook it's living inside of
[2014-03-13 01:47:58 -0400] coderanger: gfunky: Hopefully that kind of metadata will end up in Chef at some point
[2014-03-13 01:48:50 -0400] coderanger: benathuge: Whats the specific error message
[2014-03-13 01:48:55 -0400] gfunky: @coderander: Only spot i can really imagine for it would be in a berkshelf universe, or some sort of dependency resolver. Being that cookbook resolution seems only only happen upon version numbers now, and no other attributes.
[2014-03-13 01:49:04 -0400] benathuge: @coderanger ERROR: Cookbook vagrant-drupal not found. If you're loading vagrant-drupal from another cookbook, make sure you configure the dependency in your metadata
[2014-03-13 01:49:29 -0400] coderanger: benathuge: Pastebin your Berksfile and metadata.rbn
[2014-03-13 01:50:46 -0400] benathuge: @coderanger oh... looks like the name got changed inside the metadata.rb
[2014-03-13 01:50:58 -0400] benathuge: @coderanger oops :)
[2014-03-13 01:51:01 -0400] benathuge: @coderanger thanks!
[2014-03-13 02:16:49 -0400] benathuge: @coderanger have time for another question?
[2014-03-13 02:16:53 -0400] coderanger: Surely
[2014-03-13 02:17:09 -0400] benathuge: @coderanger you're the best! i've never done knife solo before
[2014-03-13 02:17:41 -0400] benathuge: @coderanger so i'm trying to override an attribute from attributes/default.rb in my node file
[2014-03-13 02:17:48 -0400] coderanger: btm: Did partial search ever get merged or is it still cookbook-only?
[2014-03-13 02:18:14 -0400] benathuge: @coderanger setting default_attributes or override_attributes doesn't seem to be having any effect
[2014-03-13 02:18:32 -0400] coderanger: benathuge: Indeed, only normal level attributes from the node are used
[2014-03-13 02:18:39 -0400] benathuge: huh
[2014-03-13 02:18:49 -0400] benathuge: so how would i override the default attributes?
[2014-03-13 02:19:08 -0400] coderanger: benathuge: Generally you wouldn't, setting attributes on nodes is done very rarely
[2014-03-13 02:19:13 -0400] coderanger: but normal > default
[2014-03-13 02:19:23 -0400] coderanger: default < normal < override < automatic
[2014-03-13 02:19:40 -0400] benathuge: i must be missing something
[2014-03-13 02:20:10 -0400] coderanger: benathuge: Overrides generally go in either roles or other cookbooks
[2014-03-13 02:20:29 -0400] benathuge: interesting
[2014-03-13 02:20:36 -0400] coderanger: storing stuff in the node itself makes for special snowflake servers, and those are to be avoided
[2014-03-13 02:20:48 -0400] coderanger: Anything you need to do with one server, you need to do with many
[2014-03-13 02:21:13 -0400] benathuge: well let me explain
[2014-03-13 02:21:26 -0400] benathuge: i had to set default['apache']['user'] = "vagrant" in order for vagrant to play nicely with apache
[2014-03-13 02:21:50 -0400] benathuge: that obviously won't work for an ec2 node
[2014-03-13 02:22:01 -0400] bluepojo: Why not set that in the Vagrantfile?
[2014-03-13 02:22:10 -0400] benathuge: i guess i can
[2014-03-13 02:22:19 -0400] bluepojo: chef.json = { apache: { user: 'vagrant' } }
[2014-03-13 02:22:30 -0400] bluepojo: then it will always be there for Vagrant and never for real nodes
[2014-03-13 02:22:31 -0400] benathuge: right, that does seem cleaner now
[2014-03-13 02:22:36 -0400] coderanger: Yep
[2014-03-13 02:22:48 -0400] coderanger: Vagrant is often a special case, as is test-kitchen
[2014-03-13 02:22:54 -0400] benathuge: fair enough
[2014-03-13 02:23:03 -0400] coderanger: but they both have their own mechanisms to set attributes
[2014-03-13 02:24:46 -0400] benathuge: so, for instance, where would i set the mysql connection parameters? i was planning on doing that in the node file
[2014-03-13 02:25:41 -0400] coderanger: benathuge: For the non-secret bits (everything but the password) that would normally go in the recipe/template for your app
[2014-03-13 02:25:54 -0400] coderanger: The secret bits  well thats a horse of a different color
[2014-03-13 02:26:03 -0400] coderanger: secrets management is Very Hard
[2014-03-13 02:26:18 -0400] coderanger: (no joke, this is the 4th time I've had this discussion in the past 24 hours)
[2014-03-13 02:26:23 -0400] benathuge: not a big deal for us at the moment because everything is on a vpc connected to our network
[2014-03-13 02:26:31 -0400] benathuge: so we can commit the secrets with impunity
[2014-03-13 02:26:49 -0400] coderanger: benathuge: As long as you trust the security of your SCM, then you are fine with that
[2014-03-13 02:26:58 -0400] benathuge: yeah scm is also internal
[2014-03-13 02:27:04 -0400] coderanger: Then go for it
[2014-03-13 02:27:05 -0400] coderanger: :)
[2014-03-13 02:27:57 -0400] benathuge: ok, but putting it in the recipe doesn't make a lot of sense... on vagrant it's local, and each environment is going to have a different db server
[2014-03-13 02:28:16 -0400] coderanger: benathuge: Yeah for that an environment file is probably the right place :)
[2014-03-13 02:28:28 -0400] benathuge: lovely! does knife-solo know about environments?
[2014-03-13 02:28:56 -0400] coderanger: benathuge: let me check
[2014-03-13 02:30:03 -0400] benathuge: @coderanger yeah i haven't seen anything to that effect
[2014-03-13 02:30:22 -0400] coderanger: benathuge: Doesn't look like it does, so you can either use per-env roles or a data bag
[2014-03-13 02:31:53 -0400] coderanger: benathuge: for solo there is no real difference between envs and roles anyway
[2014-03-13 02:32:03 -0400] benathuge: @coderanger interesting
[2014-03-13 02:33:20 -0400] benathuge: @coderanger just trying to figure out how i can make this work for all of the environment/server combinations
[2014-03-13 02:33:35 -0400] coderanger: benathuge: Right, so lets rewind
[2014-03-13 02:33:52 -0400] benathuge: @coderanger so i have 3 nodes per environment
[2014-03-13 02:33:53 -0400] coderanger: for production, you would have a role named prod (or whatever)
[2014-03-13 02:34:13 -0400] coderanger: in that you set a default attribute ['my-mysql-server'] = 'something'
[2014-03-13 02:34:20 -0400] coderanger: you can then use that in your recipes
[2014-03-13 02:34:35 -0400] coderanger: for vagrant, you would code that in the vagrantfile to localhost
[2014-03-13 02:35:03 -0400] benathuge: @coderanger so i just include a role that just sets attributes in the runlist of each node
[2014-03-13 02:35:17 -0400] coderanger: Yeah
[2014-03-13 02:35:23 -0400] benathuge: @coderanger easy enough :)
[2014-03-13 02:35:46 -0400] benathuge: thanks!
[2014-03-13 04:23:39 -0400] gfunky: GAH!! the dang "symbols vs strings" debate just bit me. The maven book uses attributes like default['maven']['3']['version'] = '3.1.1'
[2014-03-13 04:24:16 -0400] gfunky: Chef will barf if i try to use [:3]
[2014-03-13 04:24:37 -0400] gfunky: heh
[2014-03-13 04:30:38 -0400] spheromak: gfunky: :
[2014-03-13 04:30:41 -0400] spheromak: er
[2014-03-13 04:30:44 -0400] spheromak: :'3'
[2014-03-13 04:30:48 -0400] spheromak: :P
[2014-03-13 04:32:12 -0400] jbz: I'M UP ALL NIGHT TO GFUNKY
[2014-03-13 04:32:19 -0400] jbz: sorry. it's late.
[2014-03-13 04:33:01 -0400] gfunky: :-P
[2014-03-13 04:33:55 -0400] gfunky: best street busker tip i've given was to some dudes playing 'up all night to get lucky" :-)
[2014-03-13 04:34:13 -0400] c_t: jbz is getting down with is bad self
[2014-03-13 04:34:14 -0400] gfunky: They played the groove for 20+ minutes
[2014-03-13 04:34:58 -0400] jbz: I'm sitting here having horrible dreams of managing an Open Switching stack with Chef.
[2014-03-13 04:35:14 -0400] c_t: spheromak: authentication tests are passing
[2014-03-13 04:35:39 -0400] c_t: webui login even works properly
[2014-03-13 04:35:40 -0400] jbz: So long as I have a mgmt network, I could fold/spindle/mutilate my network topo and functionality via knife :-P
[2014-03-13 04:36:17 -0400] spheromak: c_t: nice man.
[2014-03-13 04:36:25 -0400] c_t: ja
[2014-03-13 04:36:26 -0400] spheromak: I need to get back on it, been distracted so far this week
[2014-03-13 04:36:47 -0400] c_t: no complaints from me
[2014-03-13 04:36:51 -0400] spheromak: I refactored all the downoad stuff in to worker with buffered chanels
[2014-03-13 04:36:57 -0400] spheromak: *download
[2014-03-13 04:37:08 -0400] spheromak: *workers
[2014-03-13 04:37:13 -0400] c_t: I'm just pleased as punch is all, and I think my wife is a little tired of hearing about it
[2014-03-13 04:37:19 -0400] spheromak: lol
[2014-03-13 04:37:44 -0400] c_t: got some areas that need perm checks filled in, but that should be it for this stage
[2014-03-13 04:37:51 -0400] coderanger: jbz: There was a demo build running on an Arista switch at one point
[2014-03-13 04:37:54 -0400] spheromak: need to writ vagrant goiardi
[2014-03-13 04:37:57 -0400] jbz: Really?
[2014-03-13 04:37:58 -0400] coderanger: jbz: full chef-client on the switch itself
[2014-03-13 04:37:59 -0400] jbz: Sahweet
[2014-03-13 04:38:03 -0400] spheromak: jbz: yar
[2014-03-13 04:38:07 -0400] jbz: if only those weren't super expensive and NDAed
[2014-03-13 04:38:12 -0400] coderanger: Not sure what ever happened to that project
[2014-03-13 04:38:27 -0400] coderanger: Both Juniper and Broadcom had said they were interested too
[2014-03-13 04:38:31 -0400] coderanger: This was like two years ago though
[2014-03-13 04:38:42 -0400] spheromak: there is also https://github.com/aristanetworks/chef-eos
[2014-03-13 04:38:56 -0400] spheromak: which is current and has some code for interacting and managing
[2014-03-13 04:39:24 -0400] c_t: I'm still trying to figure out what exactly the "certificate" field you see in a raw client json dump does though
[2014-03-13 04:39:29 -0400] jbz: hmmmmm
[2014-03-13 04:39:41 -0400] spheromak: c_t: which field
[2014-03-13 04:39:42 -0400] c_t: seems to be one area where chef-zero diverges a bit from normal chef-server behavior
[2014-03-13 04:40:19 -0400] spheromak: c_t: I've ran into some auth issues with chef-golang against chef11 server vs goiardi and chef-zer
[2014-03-13 04:40:21 -0400] spheromak: *zero
[2014-03-13 04:40:22 -0400] coderanger: c_t: for enterprise chef?
[2014-03-13 04:40:47 -0400] c_t: oh, is that what it is?
[2014-03-13 04:40:52 -0400] c_t: http://docs.opscode.com/api_chef_server.html#id1 <-- like there
[2014-03-13 04:40:53 -0400] spheromak: that might make sense
[2014-03-13 04:41:02 -0400] coderanger: c_t: Basically a very long time ago for hosted chef it was setup to use full certs instead of a plain RSA pair
[2014-03-13 04:41:08 -0400] spheromak: yea
[2014-03-13 04:41:16 -0400] coderanger: citing that the server could sign each cert or something and it would be nifty
[2014-03-13 04:41:24 -0400] coderanger: and then nothing ever used this functionality
[2014-03-13 04:41:30 -0400] coderanger: but its still buried down in the DB
[2014-03-13 04:41:33 -0400] spheromak: coderanger: sounds like some puppet inspired stuff there :)
[2014-03-13 04:41:52 -0400] c_t: as far as I could ever tell it only ever used the pub/priv RSA keys
[2014-03-13 04:41:56 -0400] coderanger: spheromak: Possibly, this was after the flirting with OpenID though
[2014-03-13 04:41:59 -0400] coderanger: c_t: Indeed
[2014-03-13 04:42:05 -0400] c_t: but I was afraid I was totally overlooking something
[2014-03-13 04:42:27 -0400] spheromak: coderanger: heh oh openid  I remember cursing that
[2014-03-13 04:42:35 -0400] c_t: even though I could find no evidence of it being used
[2014-03-13 04:42:38 -0400] coderanger: c_t: Having been the maintainer of that code for a while, I can at least say that as of a year or two ago, nothing used it in cert form specifically
[2014-03-13 04:43:15 -0400] c_t: coderanger: goiardi followed chef-zero's lead and ignored them entirely
[2014-03-13 04:43:56 -0400] c_t: knife & webui work fine that way, but since I had been working on authentication I was tryign to figure out what it did in case it was somehow Dreadfully Important
[2014-03-13 04:44:33 -0400] coderanger: c_t: Nah, all code in the server just pulls the public key when needed
[2014-03-13 04:44:51 -0400] coderanger: FOSS Server (at least pre-erchef, not sure now) didn't even bother with the cert stuff
[2014-03-13 04:45:03 -0400] coderanger: it just stored a PKCS#1 RSA pubkey
[2014-03-13 04:45:26 -0400] coderanger: Just see it as a really high overhead serialization format for a pubkey :)
[2014-03-13 04:45:37 -0400] c_t: heh
[2014-03-13 04:46:13 -0400] c_t: I suspected that might be the case, but I was picturing other horrible possibilities
[2014-03-13 04:48:00 -0400] c_t: probably should set up ssl at some point too though
[2014-03-13 04:48:57 -0400] coderanger: I should do that
[2014-03-13 04:49:01 -0400] spheromak: damn i have to do that
[2014-03-13 04:49:02 -0400] coderanger: lolprocrastination
[2014-03-13 04:49:12 -0400] c_t: I have a huge thing of stuff to sort through
[2014-03-13 04:49:17 -0400] spheromak: its a pita tho working for a company in another country
[2014-03-13 04:49:25 -0400] spheromak: I will just file for extension again
[2014-03-13 04:49:41 -0400] spheromak: since technically i work in korea :|
[2014-03-13 04:49:43 -0400] c_t: well, I kinda want to do mine so I can get my refund
[2014-03-13 04:49:49 -0400] spheromak: refund!
[2014-03-13 04:50:04 -0400] c_t: because those MRIs aren't free
[2014-03-13 04:50:14 -0400] spheromak: yea you need to goto AU :)
[2014-03-13 04:51:15 -0400] c_t: also also I need to find the Valium prescription
[2014-03-13 04:51:33 -0400] c_t: "It'll be fine," I said. "I'll just set this down over here," I said.
[2014-03-13 06:38:48 -0400] segv: any of you use berkshelf?
[2014-03-13 06:39:00 -0400] segv: whenever I get a cookbook downloaded from my private repo it says it cannot find it
[2014-03-13 06:39:09 -0400] segv: digging in the .berkshelf/cookbooks directory, it has it there
[2014-03-13 06:39:18 -0400] segv: but it's cookbookname-hashref from git at the end
[2014-03-13 06:48:00 -0400] coderanger: segv: Does the cookbook have a metadata.rb in it with the name field set correctly?
[2014-03-13 06:49:08 -0400] segv: yessir
[2014-03-13 06:50:48 -0400] segv: coderanger yeah, it's weird
[2014-03-13 06:51:57 -0400] segv: figured it out
[2014-03-13 06:52:16 -0400] segv: you were right about what to look at, I had a typo in there that looked the same, need to read before I speak haha
[2014-03-13 10:53:33 -0400] mveitas: Quick question about cookbooks and encrypted databags. I have a cookbook to do handle configuration of rsyslog with loggly.
[2014-03-13 11:30:49 -0400] btm: coderanger: partial_search is still cookbook based. https://tickets.opscode.com/browse/CHEF-3878
[2014-03-13 11:43:19 -0400] chef: Hi All
[2014-03-13 11:43:47 -0400] chef: I am facing issue while installing chef_client
[2014-03-13 11:44:47 -0400] chef: i am trying to install the sensu client on chef client through recipe
[2014-03-13 11:45:03 -0400] chef: but i am getting error sensu data bag not found
[2014-03-13 11:45:35 -0400] chef: any one have idea what is problem in the recipe
[2014-03-13 11:49:37 -0400] srenatus: hmm a why-run bombing out with 'git ls-remote ...' failing because 'git' is not installed.... is kind of bad
[2014-03-13 11:49:46 -0400] srenatus: any ideas what am I doing wrong?
[2014-03-13 12:01:59 -0400] srenatus: from the code, lib/chef/provider/git.rb, this shouldn't happen... at least I haven't found the culprit yet
[2014-03-13 12:05:09 -0400] srenatus: hmm https://github.com/opscode/chef/blob/master/lib/chef/provider/git.rb#L250  << if there was no previous checkout and `git` is not installed, this fails in a why-run.
[2014-03-13 12:56:08 -0400] mattsurabian: got kind of a basic question about encrypted databags
[2014-03-13 12:56:52 -0400] mattsurabian: seems like the secret needs to be SCP'd to the chef node? That seems strangely manual
[2014-03-13 12:57:10 -0400] mattsurabian: what's the preferred way to build that into the command used to spin up the node in the first place
[2014-03-13 13:04:38 -0400] mattsurabian: suppose a remote file resource or something in a recipe high enough in the runlist would work
[2014-03-13 13:04:51 -0400] mattsurabian: just wondering what ppl are doing
[2014-03-13 13:05:14 -0400] srenatus: mattsurabian: "knife bootstrap" does take care of the secret-copying
[2014-03-13 13:05:53 -0400] srenatus: mattsurabian: and there's https://github.com/Nordstrom/chef-vault, a different take on that problem (not sure about the details)
[2014-03-13 13:06:00 -0400] mattsurabian: do I need to specify any config in knife.rb so it knows where to find the secrets? or is that noted during the encryption phase
[2014-03-13 13:06:07 -0400] mattsurabian: yeah I was looking at chef-vault
[2014-03-13 13:06:21 -0400] srenatus: knife[:secret_file] = "path/to/data_bag_secret" in knife.rb yes
[2014-03-13 13:06:42 -0400] srenatus: (or pass "--secret-file ..." to knife)
[2014-03-13 13:07:01 -0400] mattsurabian: so by default it's a single shared key kind of deal
[2014-03-13 13:07:14 -0400] mattsurabian: that's fine for my usage
[2014-03-13 13:07:30 -0400] mattsurabian: but I know it's possible to encrypt multiple databags with different keys
[2014-03-13 13:07:49 -0400] srenatus: mattsurabian: you can have multiple shared keys, since each call to EncryptedDataBagSecret (or similar) can use its own shared key
[2014-03-13 13:08:18 -0400] mattsurabian: sure, I was referring to the whole, knife bootstrap copying them all
[2014-03-13 13:08:31 -0400] mattsurabian: can :secret_file be an array of paths?
[2014-03-13 13:08:31 -0400] srenatus: oh no I don't think that's possible
[2014-03-13 13:08:41 -0400] mattsurabian: yeah didn't think so, like I said not really an issue
[2014-03-13 13:08:42 -0400] srenatus: not that I know of and I doubt it
[2014-03-13 13:08:45 -0400] srenatus: :)
[2014-03-13 13:09:22 -0400] mattsurabian: so along those lines, my intended use case was to be able to use the encrypted databag data within my roles.json
[2014-03-13 13:09:28 -0400] mattsurabian: to override some attributes
[2014-03-13 13:10:01 -0400] mattsurabian: will I be able to making my EncryptedDataBagSecret calls from within there?
[2014-03-13 13:10:13 -0400] mattsurabian: or will I have to have a recipe to override the node.default?
[2014-03-13 13:10:54 -0400] mattsurabian: btw thanks for your help srenatus, I've been using Rightscale chef for so long, and the credential management workflow is totally different
[2014-03-13 13:14:12 -0400] defishguy: I am using chef-server-11.0.8-1.el6.x86_64 and I am unable to execute knife bootstrap.  -VVV shows that the failure is "could not connect to ssh-agent".  It doesn't appear to using the bootstrap "-x root" "-P <passwd" that I'm supplying.  The script that bootstraps has been used often... this is a recent fail.  Help?????
[2014-03-13 13:14:52 -0400] shadylog: hi. I have vendored my cookbooks with berkshelf
[2014-03-13 13:14:59 -0400] shadylog: what is the best practise to deliver this to chef?
[2014-03-13 13:15:05 -0400] shadylog: i.e. do you upload it to git ?
[2014-03-13 13:15:23 -0400] shadylog: github ?
[2014-03-13 13:15:36 -0400] mattsurabian: shadylog: like, to make it a community cookbook? Or to upload it to your personal chef account?
[2014-03-13 13:15:47 -0400] shadylog: to use with chef-solo
[2014-03-13 13:16:11 -0400] shadylog: (without a chef-server)
[2014-03-13 13:16:45 -0400] mattsurabian: are you using vagrant or chef-zero or something like that?
[2014-03-13 13:17:13 -0400] shadylog: well yes.
[2014-03-13 13:17:15 -0400] srenatus: mattsurabian: I don't think you can use data bags from attribute files, so, yes, recipes it is.
[2014-03-13 13:17:17 -0400] shadylog: something like that :)
[2014-03-13 13:17:29 -0400] mattsurabian: srenatus: yeah figured as much
[2014-03-13 13:17:34 -0400] mattsurabian: srenatus: thanks!
[2014-03-13 13:17:36 -0400] srenatus: :)
[2014-03-13 13:17:52 -0400] shadylog: I was just wondering what people use as a delivery platform for the numerous cookbooks when using chef-solo
[2014-03-13 13:17:58 -0400] shadylog: i.e. downloading the cookbooks
[2014-03-13 13:18:46 -0400] shadylog: I have discussed this in length with coderanger, who stipulated that it is better to do dependency management away from clients running chef-solo. And the developer should built its cookbook-collection that works/tests it on his own computer
[2014-03-13 13:19:26 -0400] shadylog: I agree, only I now have a tgz with a few cookbooks inside, and I would like to know what http service people generally use to serve the cookbooks
[2014-03-13 13:19:33 -0400] shadylog: again I am not working with chef-server
[2014-03-13 13:20:50 -0400] mattsurabian: wish I could help more shadylog I just got started with berkshelf and use chef server so it's as simple as berks upload
[2014-03-13 13:21:07 -0400] shadylog: okay :)
[2014-03-13 13:21:16 -0400] mattsurabian: I know with vagrant the berkshelf plugin should automatically take care of setting the cookbook path
[2014-03-13 13:21:23 -0400] mattsurabian: berkshelf plugin for vagrant
[2014-03-13 13:21:49 -0400] shadylog: I like vagrant, however if I am installing a vanilla image distro there is no berkshelf :)
[2014-03-13 13:22:02 -0400] shadylog: gem install berkshelf also doesn't always work
[2014-03-13 13:22:12 -0400] shadylog: (ubuntu saucy for example)
[2014-03-13 13:23:07 -0400] n1ko: theres no need for berkshelf on the image
[2014-03-13 13:23:17 -0400] n1ko: and what do you by "doesn't always work" ?
[2014-03-13 13:23:29 -0400] n1ko: vagrant 1.5 + vagrant-berkshelf on the other hand is totally borked
[2014-03-13 13:29:21 -0400] shadylog: n1ko: yes indeed berkshelf should not be on the image :) I agree :)
[2014-03-13 13:29:28 -0400] shadylog: n1ko: and yes it is borked
[2014-03-13 13:55:58 -0400] madhatter: Hello
[2014-03-13 13:56:36 -0400] madhatter: Is somebody familiar with chef (omnibus installer) on arch linux?
[2014-03-13 13:56:58 -0400] madhatter: It seems to work so far. Only that all binaries are in /opt/chef/embedded/bin. /opt/chef/bin is empty. Is this normal behavior?
[2014-03-13 14:08:53 -0400] guymatz: peeps!!  I have <%= node['fqdn'] %> in a template which works with chef 10 & 11.6 but fails with chef 11.8 . . .  has this notation been deprecated?  It works when I change it to <%= @node['fqdn'] %>
[2014-03-13 14:25:49 -0400] stormerider: i have an attribute on my nodes, node['RS']['Datacenter']. i'm trying to do a search on that, like "knife search node "rs_datacenter:DAL"", but not seeing any results... any suggestions?
[2014-03-13 14:30:32 -0400] gchristensen: stormerider: have you tried doing RS_Datacenter? (shrug)
[2014-03-13 14:31:08 -0400] stormerider: gchristensen: ... that did it, thanks. *still waking up*
[2014-03-13 14:31:21 -0400] stormerider: i thought lucene was case insensitive
[2014-03-13 14:31:52 -0400] gchristensen: I thought so too :)
[2014-03-13 14:39:12 -0400] therealkoopa: How can you have one recipe append to something like this: default["monitor"]["additional_client_attributes"] = {:subscriptions => ['dashserver', 'phantom'] }
[2014-03-13 14:39:29 -0400] therealkoopa: Rather than override, I'd like to just keep adding to whatever subscriptions have been set in another recipes
[2014-03-13 14:40:57 -0400] gchristensen: therealkoopa: https://coderanger.net/2013/06/arrays-and-chef/
[2014-03-13 14:41:08 -0400] gchristensen: we should have that article on some sort of auto-responder that detects the usage of arrays
[2014-03-13 14:41:24 -0400] therealkoopa: gchristensen: ha, okay thanks
[2014-03-13 14:42:41 -0400] pravinmishra_: Registered with Hosted Chef, configured knife and vagrant is up and running.
[2014-03-13 14:42:54 -0400] pravinmishra_: but when doing 'vagrant provision'
[2014-03-13 14:43:11 -0400] pravinmishra_: getting Error: The chef binary (either `chef-solo` or `chef-client`) was not found on
[2014-03-13 14:43:12 -0400] pravinmishra_: the VM and is required for chef provisioning. Please verify that chef
[2014-03-13 14:43:13 -0400] pravinmishra_: is installed and that the binary is available on the PATH.
[2014-03-13 14:43:33 -0400] pravinmishra_: Googled but no luck
[2014-03-13 14:43:39 -0400] gchristensen: sounds like your box doens't have chef installed. check out the vagrant-omnibus plugin
[2014-03-13 14:43:40 -0400] pravinmishra_: Any help?
[2014-03-13 14:43:58 -0400] gchristensen: also, please please use a pastebin for pasting errorrs.
[2014-03-13 14:44:21 -0400] pravinmishra_: gchristensen: Sure
[2014-03-13 14:44:29 -0400] pravinmishra_: I already tried
[2014-03-13 14:45:27 -0400] therealkoopa: Although I'm not convinced that helps me. If I set :subscriptions => ['foo'] in one recipe and another recipe sets :subscriptions => ['bar'], it won't be ['foo', 'bar'] will it?
[2014-03-13 14:45:38 -0400] gchristensen: therealkoopa: no. the take-away there is you should not use arrays
[2014-03-13 14:46:07 -0400] gchristensen: read "a better way" or "but what about order"
[2014-03-13 14:46:21 -0400] gchristensen: s/or/and/
[2014-03-13 14:46:42 -0400] pravinmishra_: In that case getting error: https://gist.github.com/diatmpravin/9529838
[2014-03-13 14:47:38 -0400] gchristensen: pravinmishra_: #chef ins't the proper support channel. try #vagrant
[2014-03-13 14:48:19 -0400] pravinmishra_: gchristensen: thanks
[2014-03-13 14:53:51 -0400] therealkoopa: gchristensen: Well what if you're using a cookbook that is using them? The alternative is rewriting the cookbook, which I don't want to do
[2014-03-13 14:56:41 -0400] gchristensen: therealkoopa: maybe submit an issue upstream? I don't have a good answer for you because it isn't a good idea and the behavior is quite undefined.
[2014-03-13 14:56:55 -0400] superbenk: window close
[2014-03-13 14:56:57 -0400] superbenk: oops
[2014-03-13 15:03:40 -0400] Junaid_: Is there a way to iterate though all the entries of an array seperate them by comma's?
[2014-03-13 15:15:16 -0400] someara: %w{ r1 r2 r3 r4 }.join(',')
[2014-03-13 15:22:57 -0400] jergerber: What's the best way to add shell escapes to a string in a recipe? I want to use Shellwords.shellescape, but I don't have access to it in the context of a recipe without using a ruby_block. Is there a better way?
[2014-03-13 15:28:25 -0400] douglaswth: jergerber: you are not constrained to using ruby only in ruby_block
[2014-03-13 15:59:44 -0400] schlazor: what's the best way to dynamically assign a default value to a lightweight resource's attribute?
[2014-03-13 16:23:34 -0400] therealkoopa: gchristensen: I changed some code so that I can use the hash approach over an array. It seems to be working with setting a default["monitor"]["subscriptions"] = {"dashserver" => true} and then in other recipes doing override["monitor"]["subscriptions"] = {"twitters" => true}.
[2014-03-13 16:24:00 -0400] therealkoopa: gchristensen: But seems like you can only do the override once? Meaning if recipe A sets one t hing and recipe B sets something else, it will only use the latest...
[2014-03-13 16:24:24 -0400] gchristensen: you should read up on attribute precedence
[2014-03-13 16:24:38 -0400] gchristensen: and also, don't do = {"service" ...
[2014-03-13 16:24:47 -0400] gchristensen: do subscriptions"]["dashserver"] = true
[2014-03-13 16:24:49 -0400] n0xie: http://i.imgur.com/1owrK9z.jpg
[2014-03-13 16:25:30 -0400] gchristensen: n0xie: LOL
[2014-03-13 16:29:14 -0400] shadylog: hi guys.. is it common practise to use git to store cookbooks?
[2014-03-13 16:29:35 -0400] jkeiser: shadylog: it is common practice to use version control to store cookbooks, yeah
[2014-03-13 16:29:35 -0400] fraterlaetus: that's how we do it.
[2014-03-13 16:29:39 -0400] fraterlaetus: :)
[2014-03-13 16:29:42 -0400] shadylog: for example the ntp/nginx cookbooks and its dependencies I just commited to github and use the archive/master.tar.gz
[2014-03-13 16:29:43 -0400] jkeiser: And a lot of people these days use git for that
[2014-03-13 16:29:46 -0400] shadylog: for chef-solo :)
[2014-03-13 16:29:49 -0400] shadylog: ok
[2014-03-13 16:29:54 -0400] shadylog: good!
[2014-03-13 16:30:01 -0400] fraterlaetus: shadylog: we use github for our whole chef-repo
[2014-03-13 16:30:11 -0400] fraterlaetus: just be aware of .gitignore and it's caveats
[2014-03-13 16:30:21 -0400] shadylog: btw I made this: https://github.com/ozone-io/librarian-chef-vagrant-template
[2014-03-13 16:30:28 -0400] shadylog: maybe you guys also have some use for it
[2014-03-13 16:31:39 -0400] shadylog: i primarily made it so I can easily develop and test cookbooks for use with chef-solo.. I was massively dissapointed with berkshelf, which with all its gem problems and plugin problems simply doesn't work
[2014-03-13 16:31:58 -0400] alexbst: I'd try berkshelf again
[2014-03-13 16:33:05 -0400] shadylog: couldn't get the vagrant plugin to work
[2014-03-13 16:33:22 -0400] anthroprose: its not supposed to anymore
[2014-03-13 16:33:30 -0400] shadylog: also I was scared off by the ominous "berkshelf 2 is deprecated" warnings
[2014-03-13 16:33:41 -0400] anthroprose: @shadylog: https://sethvargo.com/the-future-of-vagrant-berkshelf/
[2014-03-13 16:33:50 -0400] therealkoopa: gchristensen: Awesome. This is a far superior approach. Thanks for pointing it out
[2014-03-13 16:33:51 -0400] anthroprose: everyone is switching to test-kitchen for the driver
[2014-03-13 16:33:53 -0400] shadylog: ahh yes
[2014-03-13 16:34:05 -0400] shadylog: anthroprose: test-kitchen?
[2014-03-13 16:34:20 -0400] anthroprose: http://kitchen.ci/
[2014-03-13 16:34:30 -0400] anthroprose: yet-another-whatever-tool
[2014-03-13 16:35:00 -0400] gchristensen: yet another dependency
[2014-03-13 16:35:06 -0400] anthroprose: yup
[2014-03-13 16:35:21 -0400] anthroprose: shadylog: https://github.com/paulczar/meez
[2014-03-13 16:39:23 -0400] werdnativ: That seems like good conventions are emerging around how to work on individual cookbooks, but how do you organize your project around the collection of cookbooks? Do you have a separate repo where you just keep roles, data_bags, knife config, etc. and suck in the required cookbooks via Berkshelf?
[2014-03-13 16:41:09 -0400] anthroprose: werdnativ: most people at scale are using wrapper cookbooks instead of roles due to versioning issues
[2014-03-13 16:41:31 -0400] anthroprose: I only keep a repo for cookbooks I dev, and use berkshelf for managing the rest
[2014-03-13 16:42:05 -0400] werdnativ: single repo for all cookbooks/*, or 1 per cookbook?
[2014-03-13 16:42:21 -0400] anthroprose: the knife cookbook system is the only thing still enforcing the keep everything in your own repo with branches per upstream
[2014-03-13 16:42:26 -0400] anthroprose: I have 1 per cookbook
[2014-03-13 16:42:33 -0400] anthroprose: so that they can all be tested seperately
[2014-03-13 16:42:44 -0400] werdnativ: makes sense.
[2014-03-13 16:42:47 -0400] anthroprose: chef-blah, chef-blah2, etc..
[2014-03-13 16:44:19 -0400] anthroprose: anyone else having issues with the preview hosted chef UI? its pretty much unuseable to me, both firefox & chrome
[2014-03-13 16:58:56 -0400] PeterO: Can someone help me figure out why this cookbook does not run in Amazon OpsWorks? https://github.com/polds/yum-pydio
[2014-03-13 17:00:23 -0400] werdnativ: Is the Thorfile that Berkshelf creates by default good to keep around for anything?
[2014-03-13 17:00:35 -0400] stormerider: PeterO: opsworks isnt used by most people in the channel, you might have more luck on the ML
[2014-03-13 17:00:43 -0400] PeterO: ML?
[2014-03-13 17:00:47 -0400] stormerider: mailing list
[2014-03-13 17:00:49 -0400] PeterO: ah
[2014-03-13 17:01:44 -0400] PeterO: Well.. Do you see anything that blatantly wouldn't work regardless of destination platform
[2014-03-13 17:02:48 -0400] lamont_oc: you should use node['platform_family'] and look for 'rhel' and 'fedora'
[2014-03-13 17:03:30 -0400] lamont_oc: that'll catch 'redhat', 'centos', 'amazon', 'scientific', 'oracle', 'fedora' and anything else that gets added later
[2014-03-13 17:03:44 -0400] PeterO: I'll try that
[2014-03-13 17:03:46 -0400] lamont_oc: and line 28 you've got "yum_package" with no argument (in the recipe)
[2014-03-13 17:04:02 -0400] PeterO: oh whoops
[2014-03-13 17:04:21 -0400] lamont_oc: other than that you'd have to find the error that opsworks produces, my guess is that line tho
[2014-03-13 17:15:49 -0400] lewiz1: Is it possible to manipulate a cookbook's depends from a recipe?
[2014-03-13 17:16:52 -0400] railsraider: hi, what would cause this [2014-03-13T17:14:56+00:00] DEBUG:    35.079794  file[/mnt/icinga/log/mod_gearman_worker.log]
[2014-03-13 17:16:58 -0400] railsraider: its just file create
[2014-03-13 17:17:05 -0400] railsraider: no content at all
[2014-03-13 17:17:19 -0400] railsraider: and its taking 35 sec
[2014-03-13 17:17:33 -0400] AikiLinux: is /mnt nfs mount ?
[2014-03-13 17:17:41 -0400] AikiLinux: or a shared storage ?
[2014-03-13 17:18:24 -0400] AikiLinux: or is the file being held by another process ?
[2014-03-13 17:19:26 -0400] railsraider: yeah the file is used be gearman
[2014-03-13 17:19:38 -0400] railsraider: so maybe i'll add a only_if to that
[2014-03-13 17:20:01 -0400] AikiLinux: does it have action:create ?
[2014-03-13 17:20:11 -0400] AikiLinux: change it to action: create_if_missing
[2014-03-13 17:21:14 -0400] railsraider: thanks
[2014-03-13 17:22:37 -0400] AikiLinux: does it work better now ?
[2014-03-13 17:26:04 -0400] railsraider: running it now
[2014-03-13 17:30:05 -0400] railsraider: AikiLinux: that helped thanks
[2014-03-13 17:41:14 -0400] shadylog: awesome guys. I just did a vagrant up on 6 different vanilla (no chef) distro's. Provisioned chef, then automagically downloaded a cookbook and ran it with chef-solo and it's all green :)
[2014-03-13 17:41:22 -0400] shadylog: chef ftw
[2014-03-13 17:42:08 -0400] helfire: how does chef tell if a group exists? Our groups are in AD and not /etc/groups, so it somehow knows that the group exists and tries to mod it, but groupmod doesnt know about it
[2014-03-13 17:42:50 -0400] helfire: very similar to this: http://stackoverflow.com/questions/19013551/error-while-using-chef-group-resource
[2014-03-13 17:57:30 -0400] dgarstang3: Anyone using haproxy cookbook? The examples at https://github.com/hw-cookbooks/haproxy don't work
[2014-03-13 17:58:18 -0400] tatlar: Anyone out there with experience using the apache2 cookbook on RHEL?
[2014-03-13 17:58:27 -0400] aalmenar: Hi everyone, im having a very strange problem, using gem_package resource, if a have notifies on them, they never get called
[2014-03-13 17:58:33 -0400] dgarstang3: :wq!
[2014-03-13 17:58:36 -0400] dgarstang3: oops
[2014-03-13 17:58:57 -0400] aalmenar: has anyone had this problem ? running on chef 11.10.4
[2014-03-13 18:02:57 -0400] redondos: hi. i'm trying to use chef search to find nodes with the following attributes: node[:external_ip] = * (anything)  and node[:mosquitto][:server] = something.
[2014-03-13 18:03:02 -0400] redondos: what is the right syntax for this? do i need partial_search?
[2014-03-13 18:03:12 -0400] redondos: this works: search(:node, "external_ip:*)
[2014-03-13 18:03:39 -0400] redondos: this doesn't: search(:node, "mosquitto[server]:something"
[2014-03-13 18:09:46 -0400] shlant: anyone know why I can't append to an array attribute?
[2014-03-13 18:09:47 -0400] shlant: https://gist.github.com/MrMMorris/741b6449608199bb8669
[2014-03-13 18:28:51 -0400] werdnativ: I'm using this locale cookbook from github in my base cookbook, so I declare it in the Berksfile: https://github.com/hw-cookbooks/locale/
[2014-03-13 18:28:51 -0400] werdnativ: But when I make another cookbook that depends on the base cookbook, it can't find that locale dependency. Do I have to re-declare it in each Berksfile?
[2014-03-13 18:31:08 -0400] redondos: add "site :opscode" to your Berksfile
[2014-03-13 18:31:30 -0400] werdnativ: redondos: it's not available on the opscode site, that's an old version.
[2014-03-13 18:31:37 -0400] werdnativ: and I do have that.
[2014-03-13 18:32:53 -0400] redondos: then yes, you need to add it since your cookbook doesn't know anything about your base cookbook's berksfile
[2014-03-13 18:32:58 -0400] redondos: shlant: what's the error?
[2014-03-13 18:36:24 -0400] werdnativ: hm. that's annoying. Is this how everyone uses Berkshelf for non-community cookbooks? I thought it would resolve the Berksfile for all required cookbooks, like bundler does.
[2014-03-13 18:37:58 -0400] redondos: berkshelf says it's like bundler, but's really not
[2014-03-13 18:38:00 -0400] werdnativ: it's already downloaded the locale cookbook to ~/.berkshelf/cookbooks/locale-297c012... it seems like it should just find it there without having to declare it in every dependent cookbook.
[2014-03-13 18:38:26 -0400] shlant: redondos: I actually figured it out. It needed to be appended directly to the attribute like this: node.default["minitest"]["recipes"] << recipe
[2014-03-13 18:42:35 -0400] segv: bah
[2014-03-13 18:42:38 -0400] segv: drivinbg me up a wall
[2014-03-13 18:42:42 -0400] segv: driving me even
[2014-03-13 18:43:12 -0400] segv: try to bootstrap a server with knife ec2 server create and right after waiting for instance, I get subnet id, private ip, and then "Done", throws a ERROR: TypeError: can't convert String into Integer
[2014-03-13 18:44:14 -0400] werdnativ: Just to clarify my question, I'm not sure if I'm dealing with dependencies correctly here: https://gist.github.com/avit/9534230
[2014-03-13 18:44:37 -0400] jbellone: @segv I ran into this. Try setting your knife[:ssh_port] = 22
[2014-03-13 18:45:27 -0400] segv: yeah, its quite annoying, if I knife bootstrap it, it works fine
[2014-03-13 18:46:19 -0400] werdnativ: added myapp Berksfile to ^
[2014-03-13 18:48:07 -0400] alxndrmlr: Anyone out there built an application cookbook for riakCS? I'm new to chef and trying to get my wrapper working with kitchen for testing.
[2014-03-13 18:48:27 -0400] segv: jbellone nope, no go
[2014-03-13 18:50:10 -0400] werdnativ: I guess uploading cookbook dependencies to a chef server and using chef_api instead of git is the best solution to my question?
[2014-03-13 18:55:26 -0400] segv: Tis annoying how -VV isn't working on knife ec2 server create
[2014-03-13 19:06:21 -0400] CPS: are chef client names case sensitive?
[2014-03-13 19:08:27 -0400] Shooter23: Does anyone know of a reason a template within the sudo resource would not have "node" defined while the recipe that calls sudo does?
[2014-03-13 19:10:52 -0400] CPS: Shooter23: are you trying to use the node variable within the erb file?
[2014-03-13 19:13:43 -0400] dgarstang3: Ugh. I'm trying to use the citadel cookbook. I have some dependancies.... bc-downloader-lb -> bc-ssl-cert -> citadel. I have citadel in the bc-ssl-cert Berksfile. However, it's still required in the Berksfile of bc-downloader-lb AND I need to put the AWS creds in the bc-downloader-lb cookbook vagrantile too, NOT the bc-ssl-cert one.
[2014-03-13 19:14:12 -0400] dgarstang3: It would seem that Berksfile dependancies are not working. I have seen this behaviour before
[2014-03-13 19:16:51 -0400] CPS: in client.rb, is it possible to use something other than node_name as the client name?
[2014-03-13 19:19:02 -0400] sarkis: is there some way to pass a custom mount command to the mount resource?
[2014-03-13 19:19:13 -0400] sarkis: we have a helper script to mount encrypted fs
[2014-03-13 19:38:55 -0400] keets: Can someone please direct me to instructions on building and installing the latest stable Chef server on an unofficial platform (I am using openSUSE)?
[2014-03-13 19:39:35 -0400] keets: I should mention that I intend to use the opensource server version
[2014-03-13 19:40:47 -0400] dgarstang3: Ugh. I'm trying to use the citadel cookbook. I have some dependancies.... bc-downloader-lb -> bc-ssl-cert -> citadel. I have citadel in the bc-ssl-cert Berksfile. However, it's still required in the Berksfile of bc-downloader-lb AND I need to put the AWS creds in the bc-downloader-lb cookbook vagrantile too, NOT the bc-ssl-cert one.
[2014-03-13 19:41:53 -0400] spheromak: keets: you shoudl be able to use the enterprise 6 omni-server rpm
[2014-03-13 19:42:30 -0400] spheromak: keets: actually http://www.getchef.com/chef/install/ it lists opensuse
[2014-03-13 19:42:55 -0400] spheromak: ah for client, not server
[2014-03-13 19:43:07 -0400] keets: I was just about to say ... only the client
[2014-03-13 19:43:09 -0400] spheromak: I would try the enterprise 6 omni server rpm
[2014-03-13 19:43:21 -0400] spheromak: it should work. assuming libc is reasonably similar
[2014-03-13 19:43:23 -0400] keets: If that doesn't work, what is the GitHub repo name?
[2014-03-13 19:43:34 -0400] spheromak: chef-server-omnibus
[2014-03-13 19:43:37 -0400] spheromak: to build your own
[2014-03-13 19:43:49 -0400] keets: Super. Thanks for your help.
[2014-03-13 19:43:59 -0400] spheromak: *omnibus-chef-server :D
[2014-03-13 20:06:46 -0400] Shooter23: CPS: "node" does appear in sudo's templates albeit only in comments.
[2014-03-13 20:08:00 -0400] CPS: i'm not familiar with the sudo cookbook, but generally, templates only see the variables passed to them. recipes get some variables from chef, which includes the node object
[2014-03-13 20:10:58 -0400] chazzly: #learnchef
[2014-03-13 20:11:42 -0400] coderanger: CPS: node and @node added to the template context by Chef itself
[2014-03-13 20:12:03 -0400] CPS: wasn't aware of that
[2014-03-13 20:13:01 -0400] coderanger: It isn't usually a good idea to make heavy use of it :-)
[2014-03-13 20:13:12 -0400] coderanger: makes it harder to see how data flows through Chef
[2014-03-13 20:14:37 -0400] chazzly_: Is there a way to use cookbook version constraints to exclude a cookbook from an environment. ex. I'm added a new cookbook to a "Base" role, but only want it to got to the Sandbox env, not Dev.
[2014-03-13 20:15:06 -0400] coderanger: chazzly_: Use the env-specific run lists feature of roles
[2014-03-13 20:15:31 -0400] coderanger: chazzly_: Or do it manually via include_recipe '' if node.chef_environment == '' in a cookbook
[2014-03-13 20:16:19 -0400] coderanger: chazzly_: You can also push a 0.0.0 version of the cookbook which has the same recipes but all of them are blank
[2014-03-13 20:16:22 -0400] chazzly_: I was looking for something in the environments, not the roles, I'll try that - thatnks
[2014-03-13 20:16:23 -0400] coderanger: and then use versioning locks
[2014-03-13 20:19:04 -0400] CPS: coderanger: what's the difference between node and @node in erb?
[2014-03-13 20:19:09 -0400] coderanger: CPS: Nothing
[2014-03-13 20:19:20 -0400] CPS: you can access it with or without the 2?
[2014-03-13 20:19:25 -0400] CPS: @ that is
[2014-03-13 20:19:27 -0400] coderanger: CPS: One is an instance variable of the context (@node) the other is a method call (node)
[2014-03-13 20:19:35 -0400] CPS: ah
[2014-03-13 20:19:56 -0400] coderanger: But the method returns the same instance var
[2014-03-13 20:21:14 -0400] dgarstang3: Well that's weird. the haproxy has knobs for SSL but no provision for the cert files...
[2014-03-13 20:21:33 -0400] CPS: this is pretty cool, removes my need for a helper function
[2014-03-13 20:23:32 -0400] coderanger: dgarstang3: Look harder :-) http://cbonte.github.io/haproxy-dconv/configuration-1.5.html#5.1-crt
[2014-03-13 20:24:10 -0400] shlant: anyone have a solution for links not being able to use notifies?
[2014-03-13 20:24:28 -0400] shlant: I have a directory I need to link, but I need to restart a service if somehting changes
[2014-03-13 20:24:38 -0400] dgarstang3: coderanger: Was referring to the haproxy cookbook
[2014-03-13 20:26:32 -0400] coderanger: shlant: Doesn't look like the provider ever calls updated_by_last_action, so no
[2014-03-13 20:27:29 -0400] dgarstang3: How strange.
[2014-03-13 20:29:17 -0400] shlant: coderanger: thanks
[2014-03-13 20:29:58 -0400] dgarstang3: not sure these docs are even correct
[2014-03-13 20:32:18 -0400] dgarstang3: actually I'm pretty sure they're not correct because the examples don't work.
[2014-03-13 20:37:45 -0400] dgarstang3: Anyone using a haproxy cookbook from somewhere?
[2014-03-13 20:37:46 -0400] techminer: can a service be restarted in a recipe before continuing on?
[2014-03-13 20:38:17 -0400] coderanger: techminer: yes, service 'foo' { action :restart }
[2014-03-13 20:38:33 -0400] techminer: and that happens immediately, not at the end of the run
[2014-03-13 20:38:45 -0400] coderanger: It happens when the resource is converged
[2014-03-13 20:39:00 -0400] coderanger: "immediately" is a loaded word in this context :)
[2014-03-13 20:39:08 -0400] coderanger: since chef is a two-pass system to start with
[2014-03-13 20:39:19 -0400] techminer: because I'm install sssd for LDAP auth.and then adding LDAP account ids to a group.
[2014-03-13 20:39:45 -0400] techminer: but the group add fails the first time because it can't find the accounts.  If I rerun chef then it's fine.
[2014-03-13 20:40:29 -0400] coderanger: techminer: Can you paste the error from the first one so I can confirm my suspicion?
[2014-03-13 20:41:56 -0400] techminer: coderanger:  https://gist.github.com/MattMencel/85db1da8b6ff26ef7523
[2014-03-13 20:42:21 -0400] coderanger: techminer: I need the full stack trace
[2014-03-13 20:42:34 -0400] coderanger: techminer: it is written to a file mentioned at the bottom of the error
[2014-03-13 20:45:32 -0400] techminer: coderanger:  looks like the stacktrace was overwritten.let me try to generate it again on a fresh system
[2014-03-13 20:46:56 -0400] dgarstang3: If another recipe manages a file, say haproxy.cfg, and is broken... is there a way a wrapper script can idempotently append to that same file?
[2014-03-13 20:52:32 -0400] coderanger: dgarstang3: There are ways, such as the FileEdit helpers, but they are generally not a good idea to use
[2014-03-13 20:52:55 -0400] dgarstang3: coderanger: figured that
[2014-03-13 20:59:28 -0400] techminer: coderanger:  I can't get a good error for you, but here's my code.  https://gist.github.com/MattMencel/9536881
[2014-03-13 21:00:28 -0400] techminer: I think sssd maybe it starts the server on install, then I apply the template, then the server resource runs but it's already started so doesn't restart and load my sssd config.
[2014-03-13 21:00:45 -0400] techminer: "service" resource runs, not "server"
[2014-03-13 21:01:43 -0400] techminer: what if I notified the sssd service to restart in the template resource.so if it's added or changed it restarts?
[2014-03-13 21:02:56 -0400] coderanger: techminer: Yeah, welcome to the fun world that is "debian starts service at install time because fuck you thats way"
[2014-03-13 21:03:45 -0400] coderanger: techminer: Your best bet is to just code for the broken behavior
[2014-03-13 21:04:03 -0400] coderanger: techminer: tl;dr add notifies :restart, service[sssd], :immediately
[2014-03-13 21:04:05 -0400] coderanger: to the template
[2014-03-13 21:04:07 -0400] techminer: so notify a restart from the template
[2014-03-13 21:04:17 -0400] techminer: gotcha....
[2014-03-13 21:05:53 -0400] segv: https://gist.github.com/xorl/9536978
[2014-03-13 21:05:55 -0400] segv: this is making me rage
[2014-03-13 21:05:57 -0400] segv: something fierce
[2014-03-13 21:06:46 -0400] coderanger: segv: Generally that error comes from indexing an array when you think it is a hash
[2014-03-13 21:06:58 -0400] segv: from a cookbook or?
[2014-03-13 21:07:01 -0400] segv: from the knife config?
[2014-03-13 21:07:16 -0400] coderanger: Unlikely to be a cookbook since chef hasn't started there
[2014-03-13 21:07:18 -0400] segv: I have debug enabled, it could be anywhere, but with -VV enabled, I still don't see where the traceback is from
[2014-03-13 21:07:49 -0400] coderanger: segv: Yeah, the cloud plugins aren't very debug-able
[2014-03-13 21:07:57 -0400] coderanger: I generally recommend against using them anyway
[2014-03-13 21:08:06 -0400] segv: hmm
[2014-03-13 21:08:31 -0400] segv: let me try with hints disabled
[2014-03-13 21:10:36 -0400] segv: that was it
[2014-03-13 21:10:49 -0400] segv: how the hell do I get ec2 ohai plugin to load without it being in my knife config
[2014-03-13 21:10:50 -0400] segv: hmmm
[2014-03-13 21:13:37 -0400] segv: coderanger figured it out
[2014-03-13 21:13:48 -0400] segv: I had [:hints] = ['ec2']
[2014-03-13 21:13:58 -0400] segv: where it should be [:hints]['ec2'] = {}
[2014-03-13 21:14:08 -0400] coderanger: yarp, array vs hash :)
[2014-03-13 21:15:17 -0400] segv: the funny part is
[2014-03-13 21:15:21 -0400] segv: i had to define it in my knife rb
[2014-03-13 21:15:35 -0400] segv: even though when you knife ec2 server create, it's defauled to that plugin being enabled in there own code
[2014-03-13 21:16:12 -0400] segv: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb#L434-L435
[2014-03-13 21:39:23 -0400] redondos: coderanger: do you perhaps know anything about my question?
[2014-03-13 21:39:35 -0400] coderanger: redondos: What question?
[2014-03-13 21:39:36 -0400] redondos: i'm trying to use chef search to find nodes with the following attributes: node[:external_ip] = * (anything)  and node[:mosquitto][:server] = something.
[2014-03-13 21:39:44 -0400] redondos: what is the right syntax for this? do i need partial_search?
[2014-03-13 21:39:50 -0400] redondos: this works: search(:node, "external_ip:*)
[2014-03-13 21:39:58 -0400] redondos: this doesn't: search(:node, "mosquitto[server]:something")
[2014-03-13 21:41:31 -0400] coderanger: mosquito_server:something
[2014-03-13 21:41:46 -0400] coderanger: so "external_ip:* AND mosqito_server:something"
[2014-03-13 21:42:39 -0400] redondos: oh!
[2014-03-13 21:42:43 -0400] redondos: that's what the _ is for
[2014-03-13 21:43:12 -0400] coderanger: redondos: When serializing nodes for search it builds all the combos for you
[2014-03-13 21:43:39 -0400] coderanger: so node['a']['b'][c'] = '1' gets indexed as c:1 b_c:1 a_b_c:1
[2014-03-13 21:43:44 -0400] redondos: i see
[2014-03-13 21:43:49 -0400] redondos: thank you
[2014-03-13 22:26:10 -0400] coderanger: kallistec: Is http://docs.opscode.com/essentials_cookbook_templates.html#template-resource actually some kind of specific feature or is that just describing that you can use #render in a loop?
[2014-03-13 22:27:05 -0400] kallistec: coderanger: looks like the latter
[2014-03-13 22:27:32 -0400] coderanger: kallistec: Seems like it should be changed but not sure exactly how :-)
[2014-03-13 22:27:50 -0400] coderanger: kallistec: Guessing you used that as an example in the initial blog post and it just got pulled along as gospel
[2014-03-13 22:28:03 -0400] kallistec: yeah, probably
[2014-03-13 22:28:21 -0400] kallistec: James has to pull examples from where he can find them
[2014-03-13 22:29:12 -0400] coderanger: Yeah, should probably just be made clearer thats just an example of usage, not a specific feature
[2014-03-13 22:59:47 -0400] mallu: hi, I want to compare rpm versions ex; 4.0.1-2 and 4.2.1.-5 what is the best way to compare them?
[2014-03-13 23:00:36 -0400] mallu: i want the recipe to do something is the version is lets say above 4.2.1-5
[2014-03-13 23:01:12 -0400] coderanger: mallu: Thats not generally a good way to write recipes
[2014-03-13 23:01:23 -0400] coderanger: mallu: Instead assert one condition or the other by specifying which version to install
[2014-03-13 23:03:00 -0400] mallu: well.. then lets say I want the flexibility to specify versions in the attributes, but if I specify a certain version I want the recipe to do some extra stuff
[2014-03-13 23:04:19 -0400] mallu: for example, tomcat, I would like to have one cookbook for installing ver 6 and 7... but for 7 I want the recipe to do some extra stuff
[2014-03-13 23:06:16 -0400] dgarstang3: mallu: you mean the rpm isn't backwards compatible...
[2014-03-13 23:08:25 -0400] mallu: rpm is backward compatible but I want do some extra configuration if the RPM is a certain version
[2014-03-13 23:08:45 -0400] dgarstang3: mallu: tha sounds like not backwards compatible. :)
[2014-03-13 23:09:43 -0400] mallu: well.. no that;s not true.. lets say if the version is 7 I want the log to be a certain format than ver 6
[2014-03-13 23:11:15 -0400] mallu: basically I'm hoping I can somehow compare different versions... Hope I'm not asking something crazy
[2014-03-13 23:15:47 -0400] coderanger: mallu: chef_sugar has a nice helper for that
[2014-03-13 23:15:56 -0400] coderanger: mallu: Or you can use Gem::Version yourself
[2014-03-13 23:16:47 -0400] mallu: I tried gem::Version.. however I'm getting "ArgumentError: Malformed version number string 4.0.0-2"
[2014-03-13 23:18:03 -0400] coderanger: Indeed, Gem::Version doesn't grok the -2
[2014-03-13 23:18:30 -0400] coderanger: thats an iteration number, not really part of the version
[2014-03-13 23:20:27 -0400] mallu: true... but when we create rpms we append svn rev number to the end
[2014-03-13 23:20:36 -0400] dgarstang3: Hm is there a way for a cookbook to display it's version during a ran? I can use log(), but what would I log?
[2014-03-13 23:20:50 -0400] coderanger: mallu: You'll need to write your own parser then
[2014-03-13 23:21:12 -0400] coderanger: dgarstang3: run_context.cookbook_collection[cookbook_name].version
[2014-03-13 23:21:13 -0400] mallu: ok.. thats what I was not hoping for :(
[2014-03-13 23:21:25 -0400] dgarstang3: coderanger: Thanks
[2014-03-13 23:21:37 -0400] coderanger: mallu: Or maybe look for a gem out there that supports the semantics you need
[2014-03-13 23:22:12 -0400] mallu: ok.. thanks guys
