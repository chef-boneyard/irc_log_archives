[2014-03-17 00:10:43 -0400] mjuszczak: someara: thank you so much for your help and for throwing that gist otgether
[2014-03-17 00:10:52 -0400] someara: no prob
[2014-03-17 00:17:28 -0400] coredump: Anyone has any idea why knife status return 8 hours for all my clients? (even if chef-client runs each 30 minutes)
[2014-03-17 00:17:51 -0400] kisoku: someara: you around ?
[2014-03-17 00:17:58 -0400] someara: sup
[2014-03-17 00:18:00 -0400] kisoku: having a constraints issue
[2014-03-17 00:18:12 -0400] kisoku: you guys bumped build-essential to 2.0.0
[2014-03-17 00:18:22 -0400] kisoku: mysql pins ~> 1.4
[2014-03-17 00:18:36 -0400] kisoku: borkshelf 2.x can't handle it
[2014-03-17 00:18:43 -0400] someara: joy
[2014-03-17 00:19:13 -0400] kisoku: yes borkshelf is a joy
[2014-03-17 00:19:38 -0400] kisoku: ;-)
[2014-03-17 01:27:53 -0400] Kespan: Hi guys. Any idea why Chef would be complaining about missing homebrew while trying to install mysql? I'm working with an Ubuntu host and guest..
[2014-03-17 01:56:14 -0400] Hodge: r
[2014-03-17 02:11:58 -0400] manfred: kisoku: https://github.com/opscode-cookbooks/mysql/blob/master/metadata.rb#L31 because it has a depends on homebrew
[2014-03-17 02:12:59 -0400] manfred: bah
[2014-03-17 02:13:09 -0400] manfred: he left :/
[2014-03-17 05:50:25 -0400] floatmastaflex: evening folks. is there much in the way of automatic scaling happrning with chef at the moment?
[2014-03-17 06:06:46 -0400] savant: what do you mean by automatic scaling, floatmastaflex?
[2014-03-17 06:07:58 -0400] manfred: floatmastaflex: you can do it, I had to write an instance that checks my openstack api to see if new instances have been built, and then assigns the roles based on the metadata on that slice, using pychef
[2014-03-17 06:08:19 -0400] manfred: then I just inject the verification key using user-data and install and configure chef using a cloud-init script
[2014-03-17 06:08:58 -0400] manfred: http://cloudinit.readthedocs.org/en/latest/topics/examples.html
[2014-03-17 06:09:25 -0400] manfred: more specifically this http://cloudinit.readthedocs.org/en/latest/topics/examples.html#install-and-run-chef-recipes
[2014-03-17 06:10:31 -0400] floatmastaflex: nice
[2014-03-17 06:10:50 -0400] floatmastaflex: i figured it was possible. should be status quo soonish
[2014-03-17 06:12:29 -0400] manfred: i have been working on/moveing to salt just so I can use salts api in conjunction with the reactor to build the servers, and then it is usefull for any provider that salt-cloud can build with, just using salt-api to dump a message in the reactor queue for the reactor to run some command on
[2014-03-17 06:50:27 -0400] enbergj: how does one debug errors in templates when the error messages don't bother to say what line the error is from, or what code it was running, or anything? .. "only generation of JSON objects or arrays allowed" is not a very helpful message when you have 30 lines in the template and 10 variables
[2014-03-17 07:03:21 -0400] enbergj: ah, look slike it was just an old version of chef that couldn't say the line numbers, a newer version can .. how annoying
[2014-03-17 07:08:44 -0400] enbergj: annoyingly updating chef also fixed the "issue"
[2014-03-17 07:09:06 -0400] zrl: I've never used Chef before, but I want to install https://github.com/pehlert/chef-mailserver on a clean server. Where can I learn how to do this?
[2014-03-17 07:09:42 -0400] enbergj: https://learnchef.opscode.com/
[2014-03-17 07:10:49 -0400] zrl: Thanks!
[2014-03-17 07:13:22 -0400] zrl: enbergj: is there some sort of really quick getting started guide? i'm open to learning chef and have been wanting to do it for a while, but it's not at all obvious in the way ansible is. right now, i want to get that mailserver installed asap and learn as i go.
[2014-03-17 07:15:29 -0400] enbergj: zrl: not that I know of .. and if you are already using ansible, stick to it, or try salt instead ;)
[2014-03-17 07:15:55 -0400] enbergj: and just installing something from a chef community recipe is usually a bad idea, they generally set things up using very bad defaults etc.
[2014-03-17 07:17:30 -0400] zrl: enbergj: alright, thanks!
[2014-03-17 08:40:06 -0400] i42n: Has anyone experience with the cookbook "rails_application"? I get the error "uninitialized constant Chef::Resource::ApplicationBase"
[2014-03-17 08:40:18 -0400] i42n: talking of this cookbook http://community.opscode.com/cookbooks/rails_application
[2014-03-17 08:40:39 -0400] i42n: Do I have to do some kind of preconfiguration to use it?
[2014-03-17 08:43:46 -0400] i42n: Maybe the cookbook is too old and does not work with chef 11?
[2014-03-17 08:44:20 -0400] i42n: any suggestions on tutorials / cookbooks to setup nginx-unicorn-rails?
[2014-03-17 08:47:02 -0400] himanshu_: Hi Everyone!
[2014-03-17 08:47:24 -0400] himanshu_: I have a problem in uploading the cookbook.
[2014-03-17 08:47:44 -0400] himanshu_: Can anyone help me out in this regard?
[2014-03-17 10:33:32 -0400] chef165: hi
[2014-03-17 10:35:44 -0400] chef165: i am using the cron resource in the recipe in that i have written command ps -eaf | grep 'mysqld' in cron attribute but that is not executing this command
[2014-03-17 10:36:13 -0400] chef165: after particular interval
[2014-03-17 12:30:52 -0400] i42n: hey, I want to use this cookbook for nginx: http://community.opscode.com/cookbooks/nginx What do I have to add to my vagrant recipe list to install nginx with passenger?
[2014-03-17 12:49:41 -0400] shadylog: i42n: uhm
[2014-03-17 12:50:16 -0400] shadylog: i42n: look here https://github.com/opscode-cookbooks/nginx#passenger
[2014-03-17 12:50:49 -0400] shadylog: incluse the recipe nginx::passenger
[2014-03-17 12:50:55 -0400] shadylog: and set the options
[2014-03-17 12:50:56 -0400] shadylog: simple
[2014-03-17 13:04:46 -0400] i42n: shadylog: so I only need nginx::passenger or also nginx itslef?
[2014-03-17 13:05:18 -0400] shadylog: yeah just use the nginx:passenger recipe
[2014-03-17 13:05:30 -0400] shadylog: don't think you need to run the regular recipe.. It will call it if it neesd to
[2014-03-17 13:05:43 -0400] shadylog: test it out
[2014-03-17 13:06:18 -0400] i42n: shadylog: ok I have a try
[2014-03-17 13:08:45 -0400] i42n: shadylog: did not work: https://gist.github.com/i42n/077c7f2de369de8a367a
[2014-03-17 13:09:24 -0400] shadylog: okay. then include the regular nginx recipe first
[2014-03-17 13:09:24 -0400] shadylog: then the nginx::passenger
[2014-03-17 13:10:31 -0400] i42n: shadylog: ok I will try
[2014-03-17 13:10:42 -0400] shadylog: don't try.. test
[2014-03-17 13:10:43 -0400] shadylog: :)
[2014-03-17 13:13:06 -0400] i42n: shadylog: I am testing to setup nginx with passenger and chef for 4 hours now. I start trying. Maybe crying soon :P
[2014-03-17 13:13:33 -0400] shadylog: really?
[2014-03-17 13:14:12 -0400] i42n: shadylog: yeah. a lot of bugs to fall on, especially with wrong chef versions, rvm together with omnibus, ...
[2014-03-17 13:14:28 -0400] i42n: pretty hard to have the required experience if you are a chef beginner
[2014-03-17 13:18:53 -0400] i42n: shadylog: got further this time, but did not work: https://gist.github.com/i42n/0ac773520c801b38d2a4
[2014-03-17 13:18:59 -0400] i42n: shadylog: still errors
[2014-03-17 13:19:16 -0400] i42n: shadylog: looks like nginx does not even know from passenger
[2014-03-17 13:37:40 -0400] shadylog: sorry, then I don;t know whats going on
[2014-03-17 13:40:54 -0400] rtr: Ohai Chefs. I have a resource in my recipe that creates a file. I want to run something like `ls -lah $file`(and save the output into a variable) only after resource is executed. How can I do it?
[2014-03-17 13:42:14 -0400] rtr: I could wrap my command into execute() or bash() but they do not provide STDOUT and I can't save it into a variable
[2014-03-17 13:53:29 -0400] estebistec: any opinions on redisio vs. redis2 cookbooks?
[2014-03-17 14:23:36 -0400] benmoss_: does just declaring a service like `service "nginx"` actually do anything without a block?
[2014-03-17 14:25:52 -0400] benmoss_: oh nevermind
[2014-03-17 14:26:12 -0400] benmoss_: now i see you can use that with `notifies` from other things
[2014-03-17 14:35:27 -0400] kleewho: Chefs, what the best way to approach name clash in cookbooks and site-cookbooks directories? I've got runit in one provided by opsworks-cookbooks and  runit from hw-cookbooks in the other
[2014-03-17 14:41:06 -0400] ddr_: hiall
[2014-03-17 14:42:00 -0400] ddr_: in chef 11.0.4 i have nice json output format from knife. now on chef 11.10.4 and json 1.8.1 i get all output in one string
[2014-03-17 14:42:16 -0400] ddr_: how can i get info with nice format? =)
[2014-03-17 14:44:41 -0400] eliklein: ddr_: are you not able to use -Fjson (or -Fj) on the command-line to get json output?
[2014-03-17 14:45:23 -0400] eliklein: ddr_: I would hazard a guess that you could default that output format in your knife.rb as well.
[2014-03-17 14:46:53 -0400] ddr_: no-no, i can get json. but i get this tgis view "mysql":{"tunable":{"innodb_buffer_pool_size":"249M","innodb_additional_mem_pool_size":"37M","tmp_table_size":"62M","max_heap_table_size":"62M"}. i.e. one string, whitout enters"
[2014-03-17 14:47:40 -0400] ddr_: and when i use knife node edit, this params shown in one string
[2014-03-17 14:53:34 -0400] juliancdunn: you can thank json >= 1.7.7 for that
[2014-03-17 14:53:48 -0400] juliancdunn: https://gist.github.com/juliandunn/7914803
[2014-03-17 14:55:43 -0400] skansky: what's the chef equivalent to puppet's hiera and puppetdb?
[2014-03-17 14:57:16 -0400] ddr_: juliancdunn, thanks. and can i force use 1.7.7 for chef?
[2014-03-17 14:58:43 -0400] skansky: puppetdb tracks changes of every client run; and logs the info from facter (puppet's ohai) AFAIK
[2014-03-17 14:58:54 -0400] skansky: what's chef's answer to that?
[2014-03-17 15:02:03 -0400] juliancdunn: ddr_: not if you start installing random gems that depend on >= 1.7.7
[2014-03-17 15:03:31 -0400] juliancdunn: skansky: don't know enough about puppet to be able to answer
[2014-03-17 15:03:44 -0400] juliancdunn: but Chef runs keep track of how many resources changed, and you can do something with that
[2014-03-17 15:16:52 -0400] ddr_: which ruby version in best for chef-workstation? 2.1.0 install json 1.8.1 by default
[2014-03-17 15:17:04 -0400] ddr_: well, via rvm =)
[2014-03-17 15:18:09 -0400] renchap: :win 63
[2014-03-17 15:18:12 -0400] renchap: woops
[2014-03-17 15:24:03 -0400] swalberg: Having problems installing the ntp package on Solaris. From the backtrace it looks like the pkginfo command isn't being constructed with a package name: pkginfo -l -d  - #<Process::Status: pid 12654 exit 1>! Anyone done this before?
[2014-03-17 16:49:31 -0400] tehnef: anyone here using chocolatey-cookbook or something similar to manage windows packages?
[2014-03-17 16:50:23 -0400] v-yarotsky: hi guys. Any thoughts on how to run some commands *before* cookbook_file is created (or will definitely change)? My case is - I want to do 'chattr -i' on file before changing it, and 'chattr +i' afterwards, but was unable to come up with a reasonable solution
[2014-03-17 16:50:38 -0400] dgarstang4: I am having one HELL of a time managing attributes. :(
[2014-03-17 17:03:17 -0400] v-yarotsky: ok just in case someone needs this in the future - the easiest way, as of current, is: create "execute" resources with action: nothing which would run before and after, and a 'file' with action: nothing. In a 'ruby_block' run these resources manually with :run_action, and set a not_of/only_if condition checking against 'file'.content
[2014-03-17 17:07:07 -0400] segv: quick q. any of you commit actions when a host is shutting down?
[2014-03-17 17:07:30 -0400] segv: or being deleted more like it?
[2014-03-17 17:08:23 -0400] segv: I've done this with init scripts int he past, I just don't want to have to resort to that.
[2014-03-17 17:17:17 -0400] mjuszczak: I'm trying to figure out the difference between the berkshelf "roles" cookbook method and the application cookbook method.  I understand the roles cookbook has recipes for each role that simply includes other recipes, but in some berks examples there are application cookbooks (like myface::database) and it seems those get assigned directly to the node.  So which one is the proper berkshelf way?
[2014-03-17 17:29:17 -0400] dgarstang4: If you where writing an wrapper cookbook that uses the apt cookbook, how would you set the address of your internal repo server?
[2014-03-17 17:30:26 -0400] coderanger: dgarstang4: Open the readme and search for "repository"
[2014-03-17 17:30:40 -0400] dgarstang4: coderanger: not really what I meant, sorry
[2014-03-17 17:31:35 -0400] dgarstang4: I was referring to where to pull the local repo server address from to feed to the lwrp that the apt cookbook provides. Data bag? role? local attributes.rb? DNS magic? chef search?
[2014-03-17 17:32:01 -0400] dgarstang4: i suppose the answer to that question is 'Yes'.
[2014-03-17 17:32:03 -0400] mjuszczak: coderanger: if I'm using "berks cookbook <name>" to create a new application cookbook, does name become the exact name of the github repo? So if I'm doing "blah-cookbook.git", would I do "berks cookbook blah-cookbook", or just blah?
[2014-03-17 17:32:15 -0400] coderanger: dgarstang4: That belongs in recipe code
[2014-03-17 17:32:35 -0400] dgarstang4: coderanger: Not in the apt cookbook. it belongs in the wrapper
[2014-03-17 17:32:37 -0400] coderanger: mjuszczak: Not sure I've ever used that, I have a cookiecutter template for making cookbooks
[2014-03-17 17:32:40 -0400] coderanger: dgarstang4: Indeed
[2014-03-17 17:32:53 -0400] coderanger: dgarstang4: Just add an apt_repository resource with the needed config
[2014-03-17 17:32:58 -0400] dgarstang4: coderanger: We're on the same page, so my conundrum about the method remains.
[2014-03-17 17:33:12 -0400] dgarstang4: coderanger: I know. ... where to pull the URI from?
[2014-03-17 17:33:22 -0400] dgarstang4: coderanger: data bag, environment, role, DNS, search .... etc
[2014-03-17 17:33:27 -0400] coderanger: dgarstang4: A string in the file
[2014-03-17 17:33:40 -0400] dgarstang4: coderanger: now I'm pretty sure your being facetious.
[2014-03-17 17:33:58 -0400] coderanger: http://i.coderanger.net/nrdCm.png
[2014-03-17 17:34:00 -0400] coderanger: Nope
[2014-03-17 17:34:18 -0400] dgarstang4: coderanger: Ok, lets say you have 5 data centres, and the address is different for each.
[2014-03-17 17:34:41 -0400] dgarstang4: coderanger: now imagine almost every cookbook has some degree of the same issue
[2014-03-17 17:35:35 -0400] coderanger: dgarstang4: if node.chef_environment == 'prod-one'  elsif ...
[2014-03-17 17:36:05 -0400] dgarstang4: coderanger: I don't think anyone would condone such a solution.
[2014-03-17 17:36:27 -0400] coderanger: dgarstang4: Thats what we do for env-specific configuration
[2014-03-17 17:36:37 -0400] dgarstang4: coderanger: besides... it's not environmental. Each of these data centres could be in any environment
[2014-03-17 17:36:39 -0400] dgarstang4: Hm
[2014-03-17 17:36:54 -0400] mjuszczak: coderanger: OK.  How do you name your cookbooks in git?  Do you have a chef-roles cookbook or do you just use application cookbooks and assign recipes from that directly to nodes?
[2014-03-17 17:37:16 -0400] coderanger: dgarstang4: Sounds like you know exactly what you want to do and are just complaining that proposed solutions don't match your unstated but highly specific requirements
[2014-03-17 17:37:17 -0400] dgarstang4: DNS has been suggested, but that rule may not always apply. Chef search hsa been suggested but that assumes that your servers are also under chef control, which they aren't all, yet
[2014-03-17 17:37:38 -0400] coderanger: mjuszczak: the cookbook names is used as the repo name
[2014-03-17 17:37:41 -0400] dgarstang4: coderanger: I would like the solution to be somewhat elegant, and to know that it scales in the future.
[2014-03-17 17:37:59 -0400] coderanger: mjuszczak: but chef-foo is popular too if you don't have a dedicated org/team for cookbooks
[2014-03-17 17:42:58 -0400] mjuszczak: coderanger: OK, so the cookbook name in metadata.rb would be "blah" but the repo name can be chef-blah.
[2014-03-17 17:46:50 -0400] mjuszczak: There's just one thing I'm left confused about.  On this page .... http://misheska.com/blog/2013/06/16/getting-started-writing-chef-cookbooks-the-berkshelf-way/ ... they suggest application cookbooks (IE: myface/metadata.rb has things like depends 'apache2') ... which seems to mean you assign things like myface::database directly to the runlist.  However, some other examples have a "roles" cookbook (such as http://www.prashantrajan.com/posts/2013/06/
[2014-03-17 17:46:56 -0400] segv: coderanger, is there a way for pre-deletion execution or something like that?
[2014-03-17 17:50:09 -0400] dgarstang4: whoa nelly. Hang on a moment. I just took a bunch of roles and put them into cookbooks. I must be missing something. This would mean that the metadata would need to contains ALL these cookbooks as dependancies. That cant be right
[2014-03-17 18:10:04 -0400] tehnef: dgarstang4: I think you hit the nail on the head with all servers being under chef control. If they aren't, you hack in the strings however you feel is best and open yourself a bug on it that is pending getting your infrastructure under control.
[2014-03-17 18:11:42 -0400] dgarstang4: tehnef: yah that is a process though, so exceptions need to be added from the beginning.
[2014-03-17 18:12:25 -0400] coderanger: mjuszczak: Either works, just pick your style
[2014-03-17 18:12:42 -0400] dgarstang4: I am obviously missing something. I just moved each role that contained location attributes into separate cookbooks. Great, right? No. Now, every cookbook is going to need to put ALL location cookbooks in its metadata.rb file. That won't scale.
[2014-03-17 18:12:51 -0400] coderanger: segv: Deletion of what?
[2014-03-17 18:13:03 -0400] tehnef: dgarstang4: you'll have to decide what's best since you are the one familiar with your existing infrastructure. to me, coderanger's suggestion to put it in the recipe as a string doesn't seem outlandish. perhaps you want to set is as a wrapper cookbook attribute and call that...whatever makes sense to you, and all with the caveat that this is "for now"
[2014-03-17 18:13:50 -0400] dgarstang4: tehnef: I think 'for now' is back to location roles, with a minimal set of data to keep it manageable.
[2014-03-17 18:15:01 -0400] tehnef: so you have a location role that is setting what now?
[2014-03-17 18:15:06 -0400] tehnef: just an attribute?
[2014-03-17 18:15:25 -0400] tehnef: i didn't catch everything up above
[2014-03-17 18:15:28 -0400] dgarstang4: tehnef: Right. We have multiple locations, so multiple roles.
[2014-03-17 18:16:00 -0400] tehnef: many ways to skin this cat
[2014-03-17 18:16:23 -0400] dgarstang4: tehnef: Yes. Roles (not location cookbooks tho it seems), DNS, chef search, data bags...
[2014-03-17 18:16:26 -0400] segv: coderanger, say during node deletion/client deletion you have dns entries created on the first chef run, bootstrap
[2014-03-17 18:16:33 -0400] segv: just want them removed at the client/node deletion
[2014-03-17 18:16:34 -0400] dgarstang4: maybe even lwrp with some other external data source
[2014-03-17 18:17:02 -0400] tehnef: e,g, you could define all the location-based repos in your wrapper attributes, then do a case in your recipe to set the string using the appropriate string
[2014-03-17 18:17:39 -0400] dgarstang4: but I think location cookbooks don't work as the blogs suggest. so much for that pattern. Making one cookbook per role means every cookbook needs to depend on every location. If you use one cookbook with multiple recipies you have to qualify the data with the locaton when accessing it
[2014-03-17 18:18:24 -0400] mjuszczak: coderanger: You mean application level cookbooks or a role cookbook?
[2014-03-17 18:18:58 -0400] coderanger: mjuszczak: I need to run and catch a train, but they are just two views of the same thing, it depends on how rigorous you are about ontology
[2014-03-17 18:19:01 -0400] tehnef: dgarstang4: i'm not following why you can't have a single location role-cookbook that has multiple recipes for the actual locations
[2014-03-17 18:19:46 -0400] dgarstang4: tehnef: i tried that... if I put them all in a single cookbook, you'd need to qualify the data when setting and accessing. Ie node['us1']['some_key'] which is pretty messy
[2014-03-17 18:19:49 -0400] tehnef: which could easily be my own shortcoming, this stuff is still fairly new to me
[2014-03-17 18:20:00 -0400] mjuszczak: coderanger: The application cookbook probably makes more sense to us, since we're strictly SOA.  But then I'm not quite sure where I would put "base", for instance, since that would apply to every node.  Thanks for your help.
[2014-03-17 18:20:45 -0400] dgarstang4: tehnef: oh wait, I suppose setting the data in a recipe rather than attributes rb would remove the need for the qualification
[2014-03-17 18:20:51 -0400] tehnef: yeah
[2014-03-17 18:20:54 -0400] tehnef: that's what i'm getting at
[2014-03-17 18:20:56 -0400] dgarstang4: tehnef: but that seems to be a weird way to do it
[2014-03-17 18:21:04 -0400] tehnef: so us1 nodes get recipe[location::us1]
[2014-03-17 18:21:12 -0400] tehnef: in which you set appropriate attributes
[2014-03-17 18:21:21 -0400] dgarstang4: tehnef: right... ever heard of anyone setting attributes in a recipe like that tho?
[2014-03-17 18:21:22 -0400] tehnef: and call those later
[2014-03-17 18:21:48 -0400] tehnef: dgarstang4: i haven't heard of a lot of things. i'm not sure if that's a pattern or antipattern or just crazy
[2014-03-17 18:22:32 -0400] tehnef: i mean, isn't this what you're already doing with your location roles?
[2014-03-17 18:22:44 -0400] tehnef: and it sounds like you're wanting to get away from roles and replace them with cookbooks
[2014-03-17 18:22:55 -0400] tehnef: i imagine to keep them versioned
[2014-03-17 18:23:23 -0400] anthroprose: tehner: yeah, roles are not versionable, so wrapper cookbooks are being used
[2014-03-17 18:23:44 -0400] tehnef: if i'm understanding your setup, then i don't see how recipe[location::us2] is functionally different than role[location_us2]
[2014-03-17 18:24:57 -0400] tehnef: it may not be what you want to do in the end, but it duplicates your current functions while pulling them into version control, and you can refactor once you get the rest of your infrastructure (or at least the instances you're having to call URLs from now) into chef
[2014-03-17 18:25:01 -0400] anthroprose: on the chef server, you can have multiple cookbook versions and reference them all seperatly
[2014-03-17 18:25:08 -0400] anthroprose: you can only have 1 role of location_u2 ever
[2014-03-17 18:25:42 -0400] anthroprose: its mostly a scale issue
[2014-03-17 18:26:02 -0400] tehnef: indeed anthroprose. a human scale issue especially
[2014-03-17 18:26:30 -0400] anthroprose: 1 person running everything is easy, but not with an IT dept in the hundreds
[2014-03-17 18:26:35 -0400] tehnef: yep
[2014-03-17 18:27:21 -0400] tehnef: dgarstang4: am i grasping your problem correctly?
[2014-03-17 18:27:36 -0400] EJC_: anyone regularly have issues with the java cookbook where it can't properly download the jdk from oracle?
[2014-03-17 18:27:48 -0400] EJC_: better question - how are people installing oracle's jdk?
[2014-03-17 18:28:14 -0400] anthroprose: dgarstang4: with a wrapper cookbook's attributes, I do things like:  override['mysql']['tunable']['log_bin'] = 'mysql-bin'
[2014-03-17 18:28:47 -0400] anthroprose: EJC: did you set the oracle license agree attribute flag thingy?
[2014-03-17 18:29:10 -0400] dgarstang4: anthroprose: is this wrapper just setting location data?
[2014-03-17 18:29:23 -0400] EJC_: anthroprose heh - yessir - again, was working earlier today, then poof - sad - then in like an hour it'll work
[2014-03-17 18:29:29 -0400] dgarstang4: tehnef: yah, you are. I hadn't thought ot setting attributes in a recipe like that, thanks.
[2014-03-17 18:29:31 -0400] tehnef: dgarstang4: location-dependent data
[2014-03-17 18:30:01 -0400] dgarstang4: tehnef: should work. Weird, but should work...
[2014-03-17 18:30:15 -0400] anthroprose: location? I'm using it for what I used to use roles for.... 'mysql-master', 'mysql-slave'..... now im using mysqlwrapper::master, mysqlwrapper::slave
[2014-03-17 18:30:21 -0400] anthroprose: and can version all my pieces
[2014-03-17 18:31:06 -0400] dgarstang4: anthroprose: do you have to deal with a mysql slave in multiple data centres?
[2014-03-17 18:31:23 -0400] dgarstang4: anthroprose: ie does that mysql slave need to be configured differently in each if so?
[2014-03-17 18:31:27 -0400] mjuszczak: man I am so confused.
[2014-03-17 18:31:29 -0400] anthroprose: not currently, but I used to
[2014-03-17 18:31:41 -0400] dgarstang4: anthroprose: kk
[2014-03-17 18:31:44 -0400] anthroprose: I used a cluster {} namespace in the node attributes
[2014-03-17 18:31:57 -0400] anthroprose: to denote region, etc.... you can also leverage ohai plugins
[2014-03-17 18:32:17 -0400] dgarstang4: anthroprose: eg: apt repo server. the address is different in us-west-1 and eu-west-1...
[2014-03-17 18:32:45 -0400] anthroprose: not if you use the Amazon Linux AMI ;)
[2014-03-17 18:32:53 -0400] tehnef: dgarstang4: is it your own apt repo?
[2014-03-17 18:32:57 -0400] dgarstang4: anthroprose: I think the location wrapper cookybook should work tho. one recipe per location.
[2014-03-17 18:33:01 -0400] dgarstang4: tehnef: Yah
[2014-03-17 18:33:15 -0400] anthroprose: so why don't you just keep a list of repos in an arry by region, and just reference it depending on where you are?
[2014-03-17 18:33:25 -0400] dgarstang4: anthroprose: Sure. where to store tho?
[2014-03-17 18:33:32 -0400] tehnef: dgarstang4: is the location just AWS locations?
[2014-03-17 18:33:41 -0400] dgarstang4: tehnef: google compute too. :)
[2014-03-17 18:33:46 -0400] dgarstang4: tehnef: and maybe the office. :)
[2014-03-17 18:33:47 -0400] anthroprose: well, I would argue for CloudFormation templates at this point
[2014-03-17 18:33:57 -0400] anthroprose: but node attrs work too
[2014-03-17 18:34:01 -0400] tehnef: but things that are available in the "cloud" attribute tree?
[2014-03-17 18:34:18 -0400] dgarstang4: tehnef: no... our apt repo server address isn't available in ohai
[2014-03-17 18:34:29 -0400] tehnef: dgarstang4: but the cloud details are
[2014-03-17 18:34:34 -0400] dgarstang4: I'm gonna try the single wrapper cookbook, one recipe per location an see how far that goes
[2014-03-17 18:34:57 -0400] anthroprose: just have some logic that detects region and uses appropriate metadata
[2014-03-17 18:34:57 -0400] dgarstang4: tehnef: Sure. that tells me if i am on gce or aws. No problem there. Doesn't tell me if what the address of the apt repo server is tho
[2014-03-17 18:35:12 -0400] dgarstang4: anthroprose: 'appropriate metadata' is the issue. :
[2014-03-17 18:35:14 -0400] dgarstang4: :)
[2014-03-17 18:35:15 -0400] anthroprose: no need for multiple recipes
[2014-03-17 18:35:29 -0400] dgarstang4: anthroprose: one recipe... sourcing the data is the issue
[2014-03-17 18:35:32 -0400] anthroprose: but you already 'know' the repos, you just need to match them based on the location data from the instance
[2014-03-17 18:35:47 -0400] dgarstang4: anthroprose: i don't know the repos
[2014-03-17 18:36:06 -0400] anthroprose: so how would a recipe per loc help?
[2014-03-17 18:36:08 -0400] dgarstang4: anthroprose: well, I do. chef doesn't
[2014-03-17 18:36:10 -0400] tehnef: you can set the repo server address by a service provider attribute such as ec2.placement_availability.zone
[2014-03-17 18:36:12 -0400] anthroprose: heh, exactly
[2014-03-17 18:36:19 -0400] anthroprose: so tell chef, and then let it pick which one
[2014-03-17 18:36:33 -0400] anthroprose: what tehnef said
[2014-03-17 18:36:42 -0400] dgarstang4: anthroprose: location::us1.rb sets node['apt-repo-server'] as '1.2.3.4' and location::eu1.rb sets node['apt-repo-server'] as '2.3.4.5'
[2014-03-17 18:37:02 -0400] dgarstang4: and then the scrpt that provisions the instance adds the appropriate one to the node run list
[2014-03-17 18:37:16 -0400] erichs: greetings chefs! I'm new here. Is there a way to specify a required cookbook attribute that must be set, either via node or role config, etc, and that has no default value in the cookbook? Is it better practice to put a nonsense value as default?
[2014-03-17 18:37:18 -0400] anthroprose: repos : { 'us1' : '1.2.3.4', 'eu1' : ''2.3.4.5'' }
[2014-03-17 18:37:24 -0400] anthroprose: let it pick
[2014-03-17 18:37:26 -0400] dgarstang4: anthroprose: set where?
[2014-03-17 18:37:37 -0400] anthroprose: in a single recipe
[2014-03-17 18:37:42 -0400] anthroprose: or a helper lib
[2014-03-17 18:37:50 -0400] anthroprose: if you want it to be testable
[2014-03-17 18:37:58 -0400] tehnef: dgarstang4: i don't think you need a location cookbook at all, if you're just using public infrastructure that's relatively well supported with available chef attributes or providers thereof
[2014-03-17 18:38:09 -0400] dgarstang4: anthroprose: Ok, but we have 50 cookbooks. it needs to be broken down by location. we can't have one ginormous hash with every single attribute
[2014-03-17 18:38:34 -0400] anthroprose: so you would rather maintain (n) recipes, instead of JSON hashes?
[2014-03-17 18:38:41 -0400] dgarstang4: tehnef: We arent. our repo servers aren't public. neither is our reddis, or mysql, or anything else
[2014-03-17 18:38:54 -0400] dgarstang4: anthroprose: yes, in a single location wrapper cookbook.
[2014-03-17 18:39:02 -0400] dgarstang4: anthroprose: and include the appropriate one
[2014-03-17 18:39:07 -0400] tehnef: dgarstang4: but, you seem to be troubleshooting a problem that doesn't quite exist
[2014-03-17 18:39:15 -0400] dgarstang4: tehnef: i don't see how
[2014-03-17 18:39:19 -0400] anthroprose: which is where I would just put the json array, and pick the appropriate one
[2014-03-17 18:39:24 -0400] anthroprose: so later you can move it to a DB
[2014-03-17 18:39:31 -0400] anthroprose: by recipe isnt scalable
[2014-03-17 18:39:37 -0400] gzilla: can someone point me to documentation that explains how to add roles to a node via recipe?  ie: base role has a recipe in it that detects environment (based on hostname) then applies a certain role to it
[2014-03-17 18:39:43 -0400] dgarstang4: anthroprose: this hash would be HUGE and hard to maintain
[2014-03-17 18:39:48 -0400] tehnef: dgarstang4: you don't need to set anything to know where your nodes are, because they're on AWS/Google/whatever and you have the correct stuff installed for there to be attributes on each of those nodes that tell you about it
[2014-03-17 18:40:05 -0400] dgarstang4: it needs to be namespaced by cookbook. if it's a giant hash, it's not even clear who uses it
[2014-03-17 18:40:17 -0400] dgarstang4: tehnef: you lost me.
[2014-03-17 18:40:27 -0400] anthroprose: how many apt repos do you have?
[2014-03-17 18:40:28 -0400] tehnef: dgarstang4: you're the one who knows which repos map to which datacenters, so you say "google compute gets a", "ec2 us-west-2 gets b", and so on
[2014-03-17 18:40:49 -0400] mjuszczak: So if I'm reading correctly, if you use the application cookbook route, then everything to make that application run is in that single cookbook.  Including users on the servers, etc.  We have 5-6 apps in our organization, so wouldn't that mean users and such would be duplicated 5-6 times if we had a myapp::common recipe in each application cookbook?
[2014-03-17 18:40:51 -0400] dgarstang4: tehnef: of course, it's where to put a and b
[2014-03-17 18:40:57 -0400] tehnef: you already have the data you need to know where your node is, now you just tell chef which repo goes to which location
[2014-03-17 18:41:06 -0400] dgarstang4: tehnef: tell it how?
[2014-03-17 18:41:38 -0400] tehnef: an attribute would be fine, i think. case when google repo1 when ec2 repo2 when azure repo3 ... etc
[2014-03-17 18:41:44 -0400] dgarstang4: tehnef: i still like the single location wrapper with one recipe per location atm
[2014-03-17 18:41:55 -0400] dgarstang4: tehnef: case statements? eeek, yuck
[2014-03-17 18:42:11 -0400] tehnef: heh
[2014-03-17 18:42:23 -0400] anthroprose: dgarstang4: how many people are touching the chef infra?
[2014-03-17 18:42:32 -0400] tehnef: now you're wanting to solve a problem that wouldn't exist if your apt repos were chef-controlled
[2014-03-17 18:42:39 -0400] dgarstang4: anthroprose: just the ops guys
[2014-03-17 18:42:43 -0400] tehnef: i get that you want it to be clean
[2014-03-17 18:42:48 -0400] dgarstang4: tehnef: how so?
[2014-03-17 18:42:57 -0400] anthroprose: I would wrap logic around it, and then force the team to maintain the metadata
[2014-03-17 18:42:57 -0400] tehnef: but your infrastructure doesn't really allow that kind of solution
[2014-03-17 18:43:05 -0400] anthroprose: that way I never have to make commits for changes
[2014-03-17 18:43:08 -0400] dgarstang4: tehnef: are you referring to using chef search?
[2014-03-17 18:43:25 -0400] dgarstang4: anthroprose: metadata in a wrapper recipe. :)
[2014-03-17 18:43:29 -0400] tehnef: you mentioned you wanted to do that above, yeah
[2014-03-17 18:43:44 -0400] dgarstang4: tehnef: it seems fragile though. it's hard to test with vagrant for a start
[2014-03-17 18:44:02 -0400] anthroprose: dgarstang4: but in 1 place... which can be moved to a db, or etcd/zookeeper/whatever
[2014-03-17 18:44:25 -0400] dgarstang4: anthroprose: a db is a lot harder to manage than a file
[2014-03-17 18:44:53 -0400] anthroprose: not if it has tooling around it
[2014-03-17 18:44:56 -0400] dgarstang4: thanks tehnef/anthroprose. I'm gonna try the single cookbook with one recipe per loc
[2014-03-17 18:45:01 -0400] anthroprose: and there are shitloads of UIs that support JSON
[2014-03-17 18:45:02 -0400] dgarstang4: anthroprose: We aren't there yet
[2014-03-17 18:45:21 -0400] anthroprose: yeah well..... sometimes it happens sooner than you think ;)
[2014-03-17 18:45:23 -0400] anthroprose: and tech debt blows
[2014-03-17 18:45:40 -0400] phutchins: Anyone run into the chef-server bug where missing dependency makes chef-server's cpu 100% until restart?
[2014-03-17 18:45:53 -0400] phutchins: i've tracked down one of the missing dependencies before but having trouble doing it again...
[2014-03-17 18:45:58 -0400] anthroprose: phutchins: there is an open ticket on that
[2014-03-17 18:46:01 -0400] phutchins: yep i know
[2014-03-17 18:46:02 -0400] dgarstang4: anthroprose: it has to be something scalable, controllable, managable and trackable for now with enough granular control to handle the exceptions that are everywhere
[2014-03-17 18:46:03 -0400] tehnef: sounds like a reasonable approach dgarstang4 :)
[2014-03-17 18:46:11 -0400] phutchins: i'm active in the conversation there
[2014-03-17 18:46:56 -0400] anthroprose: dgarstang4: yeah its all just implementation detail.... I just *ALWAYS* punt maintenance whenever possible
[2014-03-17 18:47:01 -0400] phutchins: and i've used the api to try to find the one thats breaking the chef server but for whatever reason, i've run through the cookbooks on the runlist and they don't break it. but when i run it form the node it does
[2014-03-17 18:47:05 -0400] phutchins: which is weird
[2014-03-17 18:47:28 -0400] anthroprose: I'm an enabler, not a maintainer...
[2014-03-17 18:47:35 -0400] phutchins: I've even written this up on the issue... http://phutchins.com/blog/2014/03/04/tracking-down-the-chef-server-missing-dependency-bug/
[2014-03-17 18:47:50 -0400] anthroprose: phutchins: you know way more than I do then ;)
[2014-03-17 18:48:50 -0400] phutchins: anthroprose: :). thanks for pointing me in the right direction tho :)
[2014-03-17 18:49:07 -0400] phutchins: i'm going to try to ping the api for each dependency again
[2014-03-17 18:49:27 -0400] phutchins: and see what happens... i'm tryin gto determine if its only on the dependency when its X number of levels down in the chain
[2014-03-17 18:50:06 -0400] anthroprose: I've got an open issue with chefserver11... whatever I am doing will kill a brand new install repeatedly, every time
[2014-03-17 18:50:18 -0400] anthroprose: not much traction.... we dont pay $$
[2014-03-17 18:50:33 -0400] phutchins: yeh
[2014-03-17 18:50:43 -0400] phutchins: what are you doing that kills it?
[2014-03-17 18:50:51 -0400] anthroprose: wish I knew
[2014-03-17 18:50:59 -0400] anthroprose: UTF maybe, not sure.... hostedchef works fine
[2014-03-17 18:53:35 -0400] phutchins: might be the same issue i'm having?
[2014-03-17 18:53:44 -0400] phutchins: does server hit 100% cpu and have to be restarted?
[2014-03-17 18:54:01 -0400] anthroprose: 408 from NginX, chef never even sees the req
[2014-03-17 18:54:02 -0400] phutchins: chef-client run stop at POST to /environments/... ?
[2014-03-17 18:54:09 -0400] phutchins: :-\
[2014-03-17 18:54:09 -0400] anthroprose: I can get 1 node save, then everything dies
[2014-03-17 18:54:28 -0400] anthroprose: im digging for the ticket #, it had LOADS of loggin attached
[2014-03-17 18:54:30 -0400] phutchins: odd
[2014-03-17 18:57:06 -0400] anthroprose: phutchins: https://tickets.opscode.com/browse/CHEF-5059
[2014-03-17 18:57:37 -0400] phutchins: looking
[2014-03-17 18:58:30 -0400] phutchins: anthroprose: maybe nginx timeout or something similar?
[2014-03-17 18:58:45 -0400] phutchins: can you do anything to rule out nginx config issues?
[2014-03-17 18:58:57 -0400] anthroprose: I tried adjusting client body size, etc...
[2014-03-17 18:59:23 -0400] anthroprose: but I got it down to pretty much anything more than 1 attr on a second try failed
[2014-03-17 18:59:29 -0400] phutchins: hum
[2014-03-17 18:59:37 -0400] phutchins: i wonder how chef updates those
[2014-03-17 18:59:39 -0400] phutchins: if its one at a time
[2014-03-17 18:59:41 -0400] phutchins: or a block
[2014-03-17 19:00:01 -0400] anthroprose: well I even used knife to update, not just chef-client
[2014-03-17 19:00:16 -0400] phutchins: anthroprose: yeah i read that. was curious about it
[2014-03-17 19:00:32 -0400] phutchins: and i just found something intersting with my issue... i have two cookbooks on the node, base and another one
[2014-03-17 19:00:37 -0400] phutchins: either by themselves don't trigger the bug
[2014-03-17 19:00:40 -0400] phutchins: but both together do
[2014-03-17 19:00:41 -0400] phutchins: :-\
[2014-03-17 19:03:30 -0400] btm: Chef/Ohai Code Review: join: bit.ly/1p4w1AM watch: bit.ly/1p4w1AO
[2014-03-17 19:12:39 -0400] erichs: quit
[2014-03-17 19:12:46 -0400] erichs: quit
[2014-03-17 19:21:07 -0400] segv: hmmm
[2014-03-17 19:21:18 -0400] segv: no lazy attrib eval on only_if/not_if?
[2014-03-17 19:27:46 -0400] douglaswth: segv: aren't those already lazy?
[2014-03-17 19:39:25 -0400] dgarstang4: oh shit. if I put location attributes into a wrapper cookbook and recipe, I still have to know what recipe to include. include_recipe "bc-location::#{loc}" ? Euw
[2014-03-17 19:47:02 -0400] sanguisdex1: so I ccan install softwaree using chef, how to I "unapply a runlist"
[2014-03-17 19:50:50 -0400] coderanger: sanguisdex1: You would need to write another recipe to perform the reverse
[2014-03-17 19:51:02 -0400] coderanger: sanguisdex1: In general it is easier to scrap the server and start over though
[2014-03-17 19:51:56 -0400] troyready: dgarstang4, Based on the info that you've written, it sounds like you'd prefer them to magically determined? Or just all included and then have magic precedence determined?
[2014-03-17 19:53:23 -0400] dgarstang4: troyready: yah, and I think that's what roles do. :)
[2014-03-17 19:53:56 -0400] chef762: hi
[2014-03-17 20:14:46 -0400] ddr_: hiall
[2014-03-17 20:15:56 -0400] ddr_: what can i do with beam which load full CPU?
[2014-03-17 20:16:11 -0400] ddr_: opt/chef-server/embedded/service/erchef/erts-5.9.2/bin/beam.smp -K true -A 5 -- -root /opt/chef-server/embedded/service/erchef -progname erchef -- -home /var/opt/chef-server/erchef -- -noshell -boot /opt/chef-server/embedded/service/erchef/releases/1.2.6/erchef -embedded -config /opt/chef-server/embedded/service/erchef/etc/app.config -name erchef@127.0.0.1 -setcookie erchef -smp enable -- runit
[2014-03-17 20:19:32 -0400] ddr_: https://www.dropbox.com/s/vo91i5d023egf2s/Screenshot%20from%202014-03-18%2000%3A18%3A23.png
[2014-03-17 20:20:12 -0400] anthroprose: ddr: dependency issues, there is an open ticket on it
[2014-03-17 20:20:26 -0400] anthroprose: https://tickets.opscode.com/browse/CHEF-3921
[2014-03-17 20:23:56 -0400] coderanger: ddr_: Kill the process
[2014-03-17 20:24:10 -0400] coderanger: ddr_: it means you have an invalid dependency constraint somewhere
[2014-03-17 20:25:55 -0400] ddr_: hmm. can i somehow find that issue on server?
[2014-03-17 20:26:04 -0400] coderanger: ddr_: https://gist.github.com/coderanger/9198932
[2014-03-17 20:26:19 -0400] coderanger: ddr_: Unfortunately debugging it is currently an uber-manual proces
[2014-03-17 20:26:32 -0400] coderanger: ddr_: Try your different run lists with that command until you find one that fails to solve
[2014-03-17 20:29:39 -0400] ddr_: let's try! thanks =)
[2014-03-17 20:30:17 -0400] coderanger: ddr_: Once you find the specific run list that fails, you just need to recurse into its dependencies until you find the minimal set of those to cause the issue and so on
[2014-03-17 20:30:35 -0400] coderanger: ddr_: Eventually you'll find a hopefully small set of cookbooks with an invalid constraint set between them
[2014-03-17 20:30:52 -0400] coderanger: ddr_: (or at least unsolvable, might be valid but the solver just can't find a solution)
[2014-03-17 20:36:50 -0400] systest: how do data bags in chef compare to hiera in puppet, is it just a mechanism to store variables in a central location or does it also permit you to automatically select values based on some higher level structure without coding that into the recipe?  e.g. return the DNS value associated with a data center without writing a case statement in a recipe
[2014-03-17 20:37:21 -0400] coderanger: systest: hiera is more like node attributes and/or ohai
[2014-03-17 20:37:44 -0400] coderanger: systest: bags are just a mostly unconnected and simple object database hosted by the chef server
[2014-03-17 20:37:54 -0400] systest: thought ohai was more like 'facter'
[2014-03-17 20:38:06 -0400] coderanger: Yeah, its not quite a clear match
[2014-03-17 20:38:36 -0400] coderanger: facter and ohai both do system data retrieval
[2014-03-17 20:38:48 -0400] systest: so, if I want to have different data for, e.g. different locations I need to code that logic in the recipe?
[2014-03-17 20:38:56 -0400] coderanger: heira is kind of analgous to the node attribute system which ohai feeds in to
[2014-03-17 20:39:07 -0400] coderanger: systest: No, you would usually make a role or environment for each
[2014-03-17 20:39:27 -0400] coderanger: systest: Each source of node data gets merged together so in the end you see a single hash of attributes
[2014-03-17 20:40:01 -0400] systest: k, so more like a puppet parameterized class with a role wrapper that passes different values
[2014-03-17 20:40:23 -0400] mjuszczak: coderanger: I'm still confused, really trying.  If I go the application cookbook route, then everything to make that application run is in that single cookbook.  Including users on the servers, etc.  We have 5-6 apps in our organization, so wouldn't that mean users, base system packages, and such would be duplicated 5-6 times across all X-app::common recipes in each application cookbook?  Or would I create a chef-base cookbook too and include that in
[2014-03-17 20:40:28 -0400] coderanger: Yeah, thats getting closer
[2014-03-17 20:41:02 -0400] coderanger: mjuszczak: I would put that in a base cookbook, my run lists all have two items [recipe[balanced-base], recipe[balanced-whatever]]
[2014-03-17 20:44:37 -0400] fveillette: Hi
[2014-03-17 20:45:07 -0400] fveillette: I have created a provider in a custom cookbook and it's not recognized inside a ruby block like this: https://gist.github.com/anonymous/9607947
[2014-03-17 20:45:31 -0400] fveillette: i got this error message
[2014-03-17 20:45:33 -0400] fveillette: undefined method `ubi_syslogagent' for Chef::Resource::RubyBlock
[2014-03-17 20:45:44 -0400] coderanger: fveillette: Yes, you cannot use the recipe DSL inside a ruby_block
[2014-03-17 20:46:16 -0400] fveillette: so what's my option?
[2014-03-17 20:47:00 -0400] ddr_: knife exec -E 'puts api.post("/environments/production/cookbook_versions", "run_list" => mongodb).map{|key, val| "#{key} #{val.version}"}'
[2014-03-17 20:47:06 -0400] ddr_: didn't work
[2014-03-17 20:47:07 -0400] coderanger: fveillette: Not totally clear what you are trying to do
[2014-03-17 20:47:12 -0400] coderanger: ddr_: ['mongodb']
[2014-03-17 20:47:15 -0400] ddr_: oh
[2014-03-17 20:47:34 -0400] coderanger: fveillette: But you probably just want a normal resource with only_if { ::Win32::Service.exists?('Syslog Agent') }
[2014-03-17 20:48:08 -0400] ddr_: hm, no
[2014-03-17 20:48:09 -0400] ddr_: Exception: NameError: undefined local variable or method `mongodb' for #<Object:0x000000019d1d58>
[2014-03-17 20:49:07 -0400] coderanger: ddr_: You need quotes around it
[2014-03-17 20:49:18 -0400] coderanger: ddr_: That little snippet is ruby code
[2014-03-17 20:49:19 -0400] ddr_: yes, knife exec -E 'puts api.post("/environments/production/cookbook_versions", "run_list" => ["mongodb"]).map{|key, val| "#{key} #{val.version}"}' - works. hanks
[2014-03-17 20:49:31 -0400] ddr_: *thanks =)
[2014-03-17 20:50:00 -0400] mjuszczak: coderanger: And do you have a berksfile in each and every one of your cookbooks?  So sometimes there's just duplicate data?
[2014-03-17 20:50:32 -0400] coderanger: mjuszczak: Yes, that is some level of boilerplate
[2014-03-17 20:51:21 -0400] fveillette: coderanger: do you suggest this ? https://gist.github.com/anonymous/9608086
[2014-03-17 20:51:45 -0400] coderanger: fveillette: Yeah, that looks better
[2014-03-17 21:06:53 -0400] mjuszczak: coderanger: But the berksfile inside an application repo would only have the modules needed for that specific application
[2014-03-17 21:07:30 -0400] coderanger: mjuszczak: Dependencies don't (usually) go in the berksfile, they belong in the metadata
[2014-03-17 21:07:45 -0400] dstynchula: How do I assign a new, custom attribute to a node using a recipe?
[2014-03-17 21:08:04 -0400] coderanger: dstynchula: Do you mean from a cookbook or a recipe specifically?
[2014-03-17 21:08:05 -0400] mjuszczak: Curious, you mention two run lists: recipe[balanced-base] and recipe[balanced-whatever] - does balanced-base just include the base cookbook's default recipe or something?
[2014-03-17 21:08:08 -0400] Popsikle-Work: node.set ?
[2014-03-17 21:08:24 -0400] coderanger: mjuszczak: Yes, recipe[foo] == recipe[foo::default]
[2014-03-17 21:08:42 -0400] mjuszczak: coderanger: oh, so balanced-base is a cookbook, and so is balanced-whatever.
[2014-03-17 21:08:49 -0400] coderanger: indeed
[2014-03-17 21:09:04 -0400] dstynchula: coderanger: I'm agnositic on that question. I just want to be able to set an attribute after I run a recipe in a cookbook, so either should work.
[2014-03-17 21:09:16 -0400] coderanger: dstynchula: node.set['foo'] = 'bar'
[2014-03-17 21:09:17 -0400] dstynchula: and than use that attribute in another recipe later.
[2014-03-17 21:09:21 -0400] dstynchula: :)
[2014-03-17 21:09:29 -0400] mjuszczak: so you don't have a roles repo (cookbook) then.  You create application cookbooks and have a few recipes in there, and then you include base::default as well with everything which is just another cookbook.
[2014-03-17 21:09:42 -0400] coderanger: dstynchula: In general you shouldn't set that in a node attribute if it only matters locally
[2014-03-17 21:09:55 -0400] dstynchula: can I use node.set[
[2014-03-17 21:10:00 -0400] coderanger: dstynchula: Use run_context.run_state['foo'] = 'bar'
[2014-03-17 21:10:08 -0400] coderanger: Thats just a global hash shared by all recipes
[2014-03-17 21:10:14 -0400] dstynchula: node.set['foo']['name'] = bar?
[2014-03-17 21:10:20 -0400] dstynchula: hmm
[2014-03-17 21:10:33 -0400] dstynchula: Basically, I've created a recipe for mdadm
[2014-03-17 21:10:44 -0400] dstynchula: that checks for unpartitioned disks of matching sizes
[2014-03-17 21:10:52 -0400] dstynchula: and creates an mdadm array
[2014-03-17 21:11:08 -0400] dstynchula: Now, I want to be able to check nodes for matching arrays
[2014-03-17 21:11:20 -0400] dstynchula: I was thinking I'd use an atribute for this
[2014-03-17 21:11:27 -0400] dstynchula: node:[mdadm]
[2014-03-17 21:11:55 -0400] dstynchula: and have hash values for "Name" "RaidSize" "RaidLevel" and "Paired"
[2014-03-17 21:12:03 -0400] coderanger: dstynchula: If you want it to persist, then use node.set
[2014-03-17 21:12:14 -0400] coderanger: if you want it to be transient but accessible between recipes, use run_state
[2014-03-17 21:12:28 -0400] dstynchula: so it sounds like node.set is the way.
[2014-03-17 21:12:31 -0400] dstynchula: can I nest them?
[2014-03-17 21:12:48 -0400] dstynchula: Previously, I had trouble accessing nested attribute values in a recipe.
[2014-03-17 21:13:30 -0400] dstynchula: or is it just a better practice to have one attribute for mdadm.size, mdadm.name, mdadm.level, and mdadm.paired?
[2014-03-17 21:14:03 -0400] coderanger: dstynchula: Yes, you can nest them
[2014-03-17 21:14:19 -0400] coderanger: dstynchula: node.set['foo']['bar'] = 'baz'
[2014-03-17 21:16:06 -0400] dstynchula: then, how can I access them?
[2014-03-17 21:16:25 -0400] coderanger: dstynchula: node['foo']['bar']
[2014-03-17 21:16:30 -0400] dstynchula: wow.
[2014-03-17 21:16:39 -0400] dstynchula: thats easy enough!
[2014-03-17 21:16:42 -0400] dstynchula: ok
[2014-03-17 21:28:50 -0400] jidar: how can peek into the override variables I send down the chef run? I don't see it pop up in a debug output
[2014-03-17 21:29:18 -0400] coderanger: jidar: What do you mean?
[2014-03-17 21:29:25 -0400] dstynchula: coderanger: That works like a charm! Thank you so much for your help!
[2014-03-17 21:29:56 -0400] jidar: coderanger: I'm seting a override for a timezone set in my role, and I'm not seeing it get used properly so I want to make sure it looks right on the client
[2014-03-17 21:32:05 -0400] coderanger: jidar: knife node show <whatever> -Fj --long
[2014-03-17 21:32:38 -0400] jidar: coderanger: this is a solo run
[2014-03-17 21:32:45 -0400] jidar: will that still work?
[2014-03-17 21:33:09 -0400] coderanger: jidar: Pastebin the role and the code using it?
[2014-03-17 21:33:36 -0400] mjuszczak: coderanger: Thanks for all of your help.  So here's what I'm thinking: creating a chef-myapp repo which has recipes like database, webserver, etc.  Creating a chef-base repo which has recipes like users, sudo, monitoring, etc.  So then I can assign the application::database recipe and the base::default recipe to each server that is my application's database server and it will inherit all of the base stuff as well as the database config.  Does that ma
[2014-03-17 21:33:59 -0400] jidar: coderanger: http://pastebin.com/m3yZJyUA
[2014-03-17 21:34:48 -0400] jidar: coderanger: and the attributes file for that cookbook: http://pastebin.com/W9WnNF5s
[2014-03-17 21:36:57 -0400] coderanger: jidar: Please please please stop using that format for attributes
[2014-03-17 21:37:15 -0400] jidar: coderanger: the role or the default attributes? I wrote the role, not the other
[2014-03-17 21:37:17 -0400] coderanger: jidar: default['tz'] = 'America/Chicago'
[2014-03-17 21:37:24 -0400] coderanger: the other
[2014-03-17 21:37:31 -0400] jidar: ah, sorry not my cookbook
[2014-03-17 21:37:32 -0400] coderanger: okay, where are you using the attribute in your code?
[2014-03-17 21:37:54 -0400] coderanger: jidar: Though I see the likely problem
[2014-03-17 21:38:08 -0400] coderanger: jidar: Your role is setting node['timezone']['tz']
[2014-03-17 21:38:17 -0400] coderanger: jidar: should be just ['tz']
[2014-03-17 21:38:31 -0400] blueben: Do we have any opscode support staff online?
[2014-03-17 21:38:42 -0400] blueben: I need to make sure I've been added to a priority ticket
[2014-03-17 21:38:48 -0400] coderanger: blueben: Not generally
[2014-03-17 21:39:15 -0400] patcoll: So has anyone here used the community postgresql cookbook to install v9.3 on ubuntu?
[2014-03-17 21:39:17 -0400] coderanger: blueben: Don't see any on right now
[2014-03-17 21:39:28 -0400] blueben: ok
[2014-03-17 21:39:33 -0400] fveillette: anyone have a way to check a windows service but not using win32-service gem?
[2014-03-17 21:40:07 -0400] jidar: coderanger: excellent eye, that was it.
[2014-03-17 21:40:08 -0400] patcoll: Alternatively, does anyone know of a way to *remove* a Chef attribute instead of setting it to nil?
[2014-03-17 21:40:45 -0400] coderanger: patcoll: What are you trying to do with the attribute?
[2014-03-17 21:41:16 -0400] patcoll: I'm having issues with unix_socket_directories / unix_socket_directory with the postgresql cookbook -- it's setting both and I can't find a way to *remove* the "unix_socket_directory" attribute
[2014-03-17 21:41:24 -0400] patcoll: related to https://github.com/hw-cookbooks/postgresql/pull/77
[2014-03-17 21:41:42 -0400] patcoll: the issue is postgres changed what the config option is called in 9.3
[2014-03-17 21:42:48 -0400] patcoll: there are allowances for it here: https://github.com/hw-cookbooks/postgresql/blob/master/attributes/default.rb#L166
[2014-03-17 21:43:08 -0400] coderanger: patcoll: Just use rewind to patch the config template file?
[2014-03-17 21:44:01 -0400] patcoll: but my node['postgresql']['version'] = '9.3' attribute doesn't get set early enough, apparently, and I can't find another way to get rid of the "unix_socket_directory" attribute
[2014-03-17 21:44:26 -0400] patcoll: coderanger: cool, are there docs for that somewhere?
[2014-03-17 21:45:34 -0400] coderanger: patcoll: Search for chef-rewind
[2014-03-17 21:45:37 -0400] patcoll: ah, chef-rewind? I can try that.
[2014-03-17 22:05:07 -0400] dobbs: is it possible to use the users recipe without using databags?
[2014-03-17 22:06:49 -0400] dobbs: I'm hoping I can retire an old recipe I just inherited by re-using the opscode users recipe
[2014-03-17 22:07:37 -0400] btm: dobbs: where do you want to store the users?
[2014-03-17 22:08:18 -0400] dobbs: It's one user and I thought I'd just put it in the wrapper.
[2014-03-17 22:09:30 -0400] ddr_: in berksfile can i use 2-3 sites?
[2014-03-17 22:11:17 -0400] btm: dobbs: https://github.com/fnichol/chef-user/blob/master/README.md you could use the user_account LWRP (and not the data_bag recipe) from fnichol's user cookbook.
[2014-03-17 22:12:51 -0400] dobbs: Thanks.  That looks like it might do the job.
[2014-03-17 22:13:02 -0400] coderanger: dobbs: github.com/balanced-cookbooks/balanced-user
[2014-03-17 22:13:17 -0400] coderanger: dobbs: Check that out :)
[2014-03-17 22:14:33 -0400] dobbs: :-)  balanced_deploy_user might be *exactly* the thing I was looking for.
[2014-03-17 22:23:43 -0400] dobbs: coderanger: do I understand this correctly?  I would add balanced-user as a dependency in my metadata.rb and then add "balanced_deploy_user 'deploy'" to my own recipe?
[2014-03-17 22:24:39 -0400] coderanger: dobbs: You would need to be using the whole structure for it to work
[2014-03-17 22:25:00 -0400] dobbs: so I need to clone that repo basically?
[2014-03-17 22:27:43 -0400] patcoll: coderanger: chef-rewind did the trick. overrode the template cookbook_name and was able to shoehorn in a fix.
[2014-03-17 22:27:47 -0400] patcoll: thank you
[2014-03-17 22:28:12 -0400] coderanger: dobbs: Yeah, you could make you thing depend on it, and just fill in a replacement for the default.rb recipe with you own users
[2014-03-17 22:29:14 -0400] dobbs: coderanger:  Cool.  Thanks.
[2014-03-17 22:29:29 -0400] coderanger: dobbs: Or just copy-pasta and customize it
[2014-03-17 22:34:12 -0400] mjuszczak: I'm following this guide: http://docs.opscode.com/install_server.html -- however, chef-server-ctl doesn't exist on my box at all.
[2014-03-17 22:35:12 -0400] dgarstang4: I don't know if ubuntu changed something, but ystems I am trying to deploy in ec2 keep failing because chef isn't running apt-get because "STDERR: E: There are problems and -y was used without --force-yes"
[2014-03-17 22:36:48 -0400] dgarstang4: ah
[2014-03-17 22:38:03 -0400] mjuszczak: coderanger: So you don't use a roles repo at all?  You just apply specific recipes directly to nodes?
[2014-03-17 22:39:35 -0400] coderanger: mjuszczak: Indeed
[2014-03-17 22:45:29 -0400] rdobbsjrjr: Hi. I need to set my own template for a runit script inside of application_ruby, but it doesn't provide an attirbute to do this, and it's default run script doesn't actually work. Should I fork this cookbook, or is that something I can do with a wrapper cookbook? the name of the template is oddly statically defined inside of the unicorn provider in that cookbook.
[2014-03-17 22:47:49 -0400] mjuszczak: Urgh, installing chef server uses the value of hostname for the URL, but I don't want it to.  I'd rather it use a CNAME.  Google isn't returning anything.
[2014-03-17 22:52:17 -0400] patcoll: rdobbsjrjr: check out chef-rewind i just used it to solve a similar problem
[2014-03-17 22:54:53 -0400] rdobbsjrjr: patcoll: does chef-rewind work with hosted chef? I thought it didnt'?
[2014-03-17 22:55:05 -0400] zack_: Hi Everyone. I am quite new to chef and have a simple (i think?) problem. I am trying to activate virtualenv and install a python package. I tested it on Vagrant and keep getting permission errors. Any pointers appreciated. http://stackoverflow.com/questions/22466953/activating-virtualenv-via-chef-recipe-and-install-python-library
[2014-03-17 22:55:20 -0400] rdobbsjrjr: but if so, that would be great, to date I've been forking cookbooks to fix these shortsights
[2014-03-17 22:55:27 -0400] rdobbsjrjr: and now I've got about 25 forks :/
[2014-03-17 22:56:33 -0400] patcoll: rdobbsjrjr: it should. it operates on the cookbook level, not the server level.
[2014-03-17 22:56:44 -0400] rdobbsjrjr: ah OK I'll goof around with it.
[2014-03-17 22:57:02 -0400] patcoll: it was pretty easy to use for me.
[2014-03-17 22:57:04 -0400] rdobbsjrjr: seems strange to me but I'll figure it out hopefully.
[2014-03-17 22:57:59 -0400] patcoll: I used it like this: https://gist.github.com/patcoll/ca9fd58affa97414008e
[2014-03-17 22:58:08 -0400] rdobbsjrjr: is this able to modify something within a block? ie the bad runit run file template the application_ruby file uses causes unicorn not to startup, which causes the nginx restart to fail, which throws an exception.
[2014-03-17 22:58:16 -0400] patcoll: just set the cookbook_name to my cookbook and then overrode the template file
[2014-03-17 22:58:59 -0400] rdobbsjrjr: oh interesting. I'll try that right now, looks simple
[2014-03-17 23:02:38 -0400] rdobbsjrjr: oh man, if this works out, those 25 forks will scale down to 12
[2014-03-17 23:02:41 -0400] rdobbsjrjr: maybe 10
[2014-03-17 23:05:55 -0400] coderanger: mjuszczak: docs.opscode.com look for the chef-server.rb docs
[2014-03-17 23:06:13 -0400] mjuszczak: just saw that! :) It works.
[2014-03-17 23:06:15 -0400] mjuszczak: thanks
[2014-03-17 23:06:45 -0400] mjuszczak: coderanger: How come you don't just include recipe[base] inside each of your application recipes so each node would only need a single recipe?
[2014-03-17 23:07:18 -0400] coderanger: mjuszczak: two main reasons, 1) it complicates testing 2) it muddles ontological borders
[2014-03-17 23:07:35 -0400] coderanger: mjuszczak: Having my system user on disk is not part of the configuration to run, say, Jenkins
[2014-03-17 23:07:50 -0400] coderanger: So the jenkins cookbook shouldn't formalize that as a precondition
[2014-03-17 23:13:58 -0400] rdobbsjrjr: patcoll: does https://gist.github.com/anonymous/9610304 look reasonable to you?
[2014-03-17 23:14:16 -0400] rdobbsjrjr: Or should I have that rewind before rcp::_mwa_rails (which is where the broken application_ruby block is)
[2014-03-17 23:14:49 -0400] mjuszczak: coderanger: interesting.  I guess that's true... if I'm testing an application locally on a test-kitchen instance, I don't want the code for say... Rackspace Cloud's firewall management.
[2014-03-17 23:15:09 -0400] coderanger: mjuszczak: This is why I ramble about ontology
[2014-03-17 23:15:13 -0400] mjuszczak: coderanger: Would you say that's an acceptable reason?
[2014-03-17 23:15:25 -0400] coderanger: mjuszczak: You need a clear picture of what the noun that each cookbook/recipe/resource is modeling
[2014-03-17 23:15:47 -0400] coderanger: and focus on just that noun
[2014-03-17 23:16:16 -0400] mjuszczak: coderanger: How do you manage multiple developers and knowing what versoin of each cookbook to use in an environment though?
[2014-03-17 23:18:39 -0400] coderanger: mjuszczak: semver + accurate dependency settings
[2014-03-17 23:25:48 -0400] workmad3: coderanger: do the ontological boundaries hold up if I have a cookbook for a specific server config? :)
[2014-03-17 23:26:08 -0400] skansky: hey in ERB is this: <%= node['iam-svc']['max_pagesize'] %> the same as: <%= node[:iam-svc][:max_pagesize] %>
[2014-03-17 23:26:16 -0400] workmad3: skansky: no
[2014-03-17 23:26:47 -0400] workmad3: skansky: :iam-svc isn't a valid symbol name (more accuratly, it's the valid symbol :iam followed by - svc)
[2014-03-17 23:26:51 -0400] skansky: node['iam-svc']['max_pagesize']  seems to get it from node.json
[2014-03-17 23:27:06 -0400] skansky: how do i get it to refer to my default attribute?
[2014-03-17 23:27:41 -0400] skansky: like in attributes/default.rb I have default['iam-svc']['max_pagesize'] = 'asdfasdfasdfds'
[2014-03-17 23:28:32 -0400] rdobbsjrjr: http://lists.opscode.com/sympa/arc/chef/2013-09/msg00395.html
[2014-03-17 23:28:38 -0400] rdobbsjrjr: Looks like chef-rewind doesn't fix this problem.
[2014-03-17 23:28:55 -0400] rdobbsjrjr: Thanks for your help @patcoll!
[2014-03-17 23:29:24 -0400] skansky: workmad3 hmm i tried <%= default['iam-svc']['max_pagesize'] %> also but no luck
[2014-03-17 23:30:57 -0400] coderanger: workmad3: Not sure what you mean
[2014-03-17 23:35:19 -0400] josephholsten: is the right way to pass tags to `knife bootstrap` by placing them in the JSON attributes?
[2014-03-17 23:36:27 -0400] coderanger: josephholsten: Yeah, tags are just attributes
[2014-03-17 23:36:39 -0400] coderanger: josephholsten: Nothing special about them except a few helper methods
[2014-03-17 23:36:53 -0400] josephholsten: ngg, so is the run list
[2014-03-17 23:37:06 -0400] coderanger: No, that is not an attribute
[2014-03-17 23:37:15 -0400] coderanger: its data on the node but separate from the attrs system
[2014-03-17 23:37:26 -0400] coderanger: For example, you can set tags in a role if you want
[2014-03-17 23:38:01 -0400] josephholsten: oh right
[2014-03-17 23:38:36 -0400] josephholsten: ugh, I do wish there was some sane way to store provisioning templates in chef
[2014-03-17 23:39:05 -0400] flaccid: whats a provisioning tepmlate?
[2014-03-17 23:39:10 -0400] coderanger: josephholsten: packer ftw
[2014-03-17 23:39:14 -0400] josephholsten: role + flavor
[2014-03-17 23:39:34 -0400] josephholsten: maybe other things, I'm still roughing it out
[2014-03-17 23:40:00 -0400] dstynchula: coderanger: Do I need to do anything special to have those attributes upload to hosted-chef?
[2014-03-17 23:40:11 -0400] dstynchula: they show up in chef-shell
[2014-03-17 23:40:24 -0400] dstynchula: but when I do a knife node search,
[2014-03-17 23:40:28 -0400] dstynchula: they dont show up.
[2014-03-17 23:41:16 -0400] coderanger: dstynchula: Which attributes?
[2014-03-17 23:41:58 -0400] dstynchula: <sarcasm> What? you dont remember every single convo you have in a day with the hundreds of confused people asking for help? ;)
[2014-03-17 23:42:28 -0400] dstynchula: sorry, I'll post to gist so I can make actual sense.
[2014-03-17 23:42:32 -0400] dstynchula: heehee
[2014-03-17 23:42:34 -0400] coderanger: dstynchula: I've been trying to write the same line code for about 3 hours now, suffice to say I'm a tad scattered :)
[2014-03-17 23:43:21 -0400] dstynchula: https://gist.github.com/dstynchula/9610726
[2014-03-17 23:43:33 -0400] dstynchula: I'm using node.set to assign a custom attribute set
[2014-03-17 23:43:44 -0400] dstynchula: or at least I think I am
[2014-03-17 23:44:50 -0400] dstynchula: wait,
[2014-03-17 23:44:56 -0400] dstynchula: nevermind. dont bother yourself.
[2014-03-17 23:45:12 -0400] dstynchula: I forgot to clean up before I re-ran and they never got set.
[2014-03-17 23:45:17 -0400] dstynchula: *facepalm*
[2014-03-17 23:45:20 -0400] dstynchula: sorry.
[2014-03-17 23:47:05 -0400] coderanger: dstynchula: So one thing to note is that they will only get saved back to to the server if the run completes successfully, so you can have issues if your run fails later on
[2014-03-17 23:47:27 -0400] rdobbsjrjr: is there a way to redefine a resource within a provider resource?
[2014-03-17 23:47:42 -0400] coderanger: rdobbsjrjr: "redefine"?
[2014-03-17 23:47:55 -0400] dstynchula: I'll keep that in mind. Thanks!
[2014-03-17 23:48:04 -0400] rdobbsjrjr: in the "application" method from application_ruby IU need to redefine a template variable that gets created from the unicorn sub-lwrp
[2014-03-17 23:48:08 -0400] coderanger: dstynchula: There are ways around it if you get desperate :)
[2014-03-17 23:48:18 -0400] rdobbsjrjr: @coderanger http://lists.opscode.com/sympa/arc/chef/2013-09/msg00395.html describes the problem I have betrter than I could
[2014-03-17 23:48:20 -0400] coderanger: dstynchula: This seems fairly convergent though, so you should be safe
[2014-03-17 23:48:40 -0400] rdobbsjrjr: basically the template provided for the runit service is dumb, it causes unicorn not to start, which causes nginx not to start, which causes an exception
[2014-03-17 23:48:43 -0400] coderanger: rdobbsjrjr: Oy
[2014-03-17 23:49:01 -0400] coderanger: rdobbsjrjr: Short answer, no
[2014-03-17 23:49:12 -0400] rdobbsjrjr: So forking is the only option?
[2014-03-17 23:49:15 -0400] dstynchula: how do you convert the node['attribute']['subattribute'] syntax into "knife node show NODE -a ???"
[2014-03-17 23:49:22 -0400] coderanger: rdobbsjrjr: Because of how the app cookbooks use the deploy resource callbacks, they are very isolated
[2014-03-17 23:49:36 -0400] coderanger: rdobbsjrjr: Yeah, and then shoot me a PR
[2014-03-17 23:49:51 -0400] coderanger: dstynchula: -a attribute.subattribute
[2014-03-17 23:50:17 -0400] dstynchula: awesome.
[2014-03-17 23:50:19 -0400] rdobbsjrjr: @coderanger sadly, the $bigco I work for  would fire, and possibly sue  me for doing a pull request without going through a 3 month review process of it.
[2014-03-17 23:50:27 -0400] coderanger: rdobbsjrjr: :-(
[2014-03-17 23:50:41 -0400] rdobbsjrjr: it's something I don't understand about agreements with the DHS because we export hardware that has encryption on it
[2014-03-17 23:51:22 -0400] rdobbsjrjr: thanks though, at least I know not to keep spinning y wheels on rewind
[2014-03-17 23:51:32 -0400] rdobbsjrjr: which is good, I was likely to do that all night :)
[2014-03-17 23:51:59 -0400] coderanger: rdobbsjrjr: Its a big part of why those cookbooks need to be nuked from orbit
[2014-03-17 23:52:10 -0400] coderanger: the deploy resource is just hideously broken
[2014-03-17 23:52:23 -0400] rdobbsjrjr: Now *that* is something I could do. :/
[2014-03-17 23:52:33 -0400] rdobbsjrjr: though I'd definitely get fired for that
[2014-03-17 23:52:39 -0400] rdobbsjrjr: ;)
[2014-03-17 23:53:23 -0400] rdobbsjrjr: Are there any good projects replacing the deploy resourrce? This seems like one of those cookbook stacks that would be pretty vital for any company starting out with a new install, and nginx/unicorn/rails seems pretty common?
[2014-03-17 23:53:39 -0400] coderanger: rdobbsjrjr: Just use the git resource directly
[2014-03-17 23:53:49 -0400] coderanger: rdobbsjrjr: sans any of the faux-capistrano bits
[2014-03-17 23:54:03 -0400] josephholsten: +1
[2014-03-17 23:54:35 -0400] rdobbsjrjr: these would be good comments on community.opscode.com
[2014-03-17 23:54:48 -0400] josephholsten: see also fpm and system packages
[2014-03-17 23:54:58 -0400] coderanger: rdobbsjrjr: Heh, if I wrote down all my thoughts on the app cookbooks I would crash the database
[2014-03-17 23:55:06 -0400] rdobbsjrjr: like a section on "http://community.opscode.com/cookbooks/application" with a "danger, will robinson" alert
[2014-03-17 23:55:11 -0400] coderanger: rdobbsjrjr: Short version is "I've gotten a lot better at Chef since I wrote them"
[2014-03-17 23:55:12 -0400] rdobbsjrjr: Hahaha :)
[2014-03-17 23:55:45 -0400] rdobbsjrjr: thanks, no blame, just curious mostly
[2014-03-17 23:56:04 -0400] skansky: for chef-solo do i always have to use a solo.rb to tell it where cookbook_path is?
[2014-03-17 23:56:16 -0400] skansky: there must be a better way .. i know some of you know
[2014-03-17 23:56:23 -0400] coderanger: skansky: Or put it on the command line, but thats not exactly better
[2014-03-17 23:56:28 -0400] coderanger: skansky: What are you trying to do?
[2014-03-17 23:56:41 -0400] josephholsten: shall we begin the traditional discussion about how the deploy resource should be rewritten to support artifacts and packages also?
[2014-03-17 23:56:44 -0400] coderanger: skansky: (chef-apply might be what you are looking for)
[2014-03-17 23:56:47 -0400] skansky: i just want to stop using -c solo.rb and i think there's a way to not use it right?
[2014-03-17 23:57:00 -0400] coderanger: skansky: I mean you could put it at /etc/chef/solo.rb
[2014-03-17 23:57:04 -0400] coderanger: skansky: Thats the default location
[2014-03-17 23:57:12 -0400] skansky: how would chef-apply know where my cookbooks are?
[2014-03-17 23:57:18 -0400] skansky: oh .. it will assume a certain dir?
[2014-03-17 23:57:28 -0400] coderanger: josephholsten: No, nuke from orbit, there is not enough value in the fake cap bits
[2014-03-17 23:57:48 -0400] josephholsten: oh yeah
[2014-03-17 23:57:50 -0400] coderanger: skansky: chef-apply takes a full path to a recipe code file
[2014-03-17 23:58:11 -0400] coderanger: josephholsten: Next version of app cookbooks will separate binary transport from deploy logic
[2014-03-17 23:58:47 -0400] josephholsten: I just mean the pre-deploy, pre-migrate, post-migrate, reload hooks are valuable w/o regard to how the bits get dropped
[2014-03-17 23:59:11 -0400] coderanger: josephholsten: No, they are not viable for anything but toy single-server deploys
[2014-03-17 23:59:13 -0400] mjuszczak: coderanger: So if you had app1 and app2, and both relied on mariaDB installs, you'd create recipe[app1::database] and recipe[app2::database] and both would simply include the mariaDB cookbook, which would be in a separate repo enitrely managed by berks?  Just making sure I'm doing this right.
[2014-03-17 23:59:32 -0400] coderanger: josephholsten: Chef can't manage multi-server orchestration bits that are inherently non-convergent
[2014-03-17 23:59:57 -0400] coderanger: mjuszczak: Yep
[2014-03-17 23:59:57 -0400] josephholsten: non-convergent migrations are the devil
