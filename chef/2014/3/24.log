[2014-03-24 01:11:49 -0400] rpad: I'm trying to fill a knowledge gap and was wondering if anyone has any info/articles on using jenkins to update an attribute for a staging auto-deploy
[2014-03-24 01:12:15 -0400] rpad: Should I just write a quick and dirty script?
[2014-03-24 01:13:13 -0400] anthroprose: rpad: all depends on what you are doing
[2014-03-24 01:13:19 -0400] anthroprose: I run knife ssh from jenkins
[2014-03-24 01:14:29 -0400] rpad: Just want to tie in staging auto-deploy after a jenkins build. chef-client uses a version which ties to an external artifact. I just want to update that staging version after a successful build
[2014-03-24 01:14:56 -0400] anthroprose: all depends on your metadata structure
[2014-03-24 01:15:02 -0400] anthroprose: chef environment attribute
[2014-03-24 01:15:44 -0400] anthroprose: role attr, but roles are not large scalable and not used by big chef shops
[2014-03-24 01:16:15 -0400] anthroprose: you could write to a deploy.json with just the attribute and use chef-client and -j /file/loc/deploy.json
[2014-03-24 01:16:36 -0400] anthroprose: you could update a databag from jenkins and use knife ssh to run chef
[2014-03-24 01:16:47 -0400] anthroprose: i dunno, lots of ways
[2014-03-24 01:16:49 -0400] rpad: hrm, lots of options :)
[2014-03-24 01:17:05 -0400] anthroprose: I update cloudformation template paramters
[2014-03-24 01:17:19 -0400] anthroprose: which drive chef deploy.json files
[2014-03-24 01:17:34 -0400] rpad: interesting, I was trying to stay away from modifying cloudformation templates
[2014-03-24 01:17:48 -0400] anthroprose: lots do
[2014-03-24 01:18:22 -0400] anthroprose: all depends on your arch
[2014-03-24 01:18:34 -0400] anthroprose: adobe refreshes CF for every deploy
[2014-03-24 01:18:38 -0400] anthroprose: I'm somewhere in the middle
[2014-03-24 08:02:26 -0400] flaccid: http://i.imgur.com/Qqp6yQv.jpg
[2014-03-24 08:04:56 -0400] PapaSierra: i've been using chef together with vagrant. now it's time to take this to production. please point me in the right direction.
[2014-03-24 08:40:45 -0400] bixu_: flaccid: Haha.
[2014-03-24 08:42:22 -0400] flaccid: PapaSierra: hosted chef server
[2014-03-24 08:53:10 -0400] daxroc: How do you make node availble to a helper / library?
[2014-03-24 10:01:15 -0400] erthad: hiall
[2014-03-24 10:01:44 -0400] erthad: have anybody seen if there is a chef handler to send its output etc to logentries?
[2014-03-24 10:26:08 -0400] mboeru: I have just installed chef server for the first time, and am trying to change the ip for webui from 127.0.0.1 to 0.0.0.0 but it seems I am not capable of doing this
[2014-03-24 10:26:16 -0400] mboeru: can anyone point me in the right direction?
[2014-03-24 10:26:33 -0400] sonne: greetings!
[2014-03-24 10:27:23 -0400] sonne: is it possible to specify default attributes for resources, much like this? http://docs.puppetlabs.com/puppet/latest/reference/lang_defaults.html
[2014-03-24 10:27:24 -0400] mboeru: tried this, but it did not work http://pastebin.com/z023mNZj
[2014-03-24 10:28:54 -0400] sonne: for example, i'd like to have all the "file" resources in my recipe have mode 00644 unless otherwise specified
[2014-03-24 10:38:39 -0400] ocholetras: sonne sure you can
[2014-03-24 10:38:53 -0400] sonne: how?
[2014-03-24 10:38:58 -0400] ocholetras: on the attribute file
[2014-03-24 10:39:05 -0400] ocholetras: on your cookbook
[2014-03-24 10:39:09 -0400] ocholetras: set that value
[2014-03-24 10:39:41 -0400] ocholetras: default['filemode'] = '00644'
[2014-03-24 10:39:48 -0400] ocholetras: On the resource you can access node attributes
[2014-03-24 10:40:22 -0400] sonne: but those are node attributes, not resource attributes
[2014-03-24 10:41:27 -0400] sonne: what i'd like to do is to say "let all files have 00644 mode", and then all "file" resources will have it unless i type another 'mode' attribute in them
[2014-03-24 10:41:28 -0400] ocholetras: Attributes allways are node attributes, but the defaults on attribute files are available to your cookbook, whatever node you execute it
[2014-03-24 10:41:52 -0400] ocholetras: Are you writing your custom resource?
[2014-03-24 10:42:24 -0400] ocholetras: Yo can write a definition, to wrapp the file resource and do suff "in the middle"
[2014-03-24 10:43:08 -0400] ocholetras: Anyway, chef always use umask on the machine
[2014-03-24 10:43:26 -0400] ocholetras: if you have that requirement, sure you have defined the right umask on the machine, right?
[2014-03-24 10:43:39 -0400] sonne: well it's an example
[2014-03-24 10:44:01 -0400] sonne: you could also say i'd like all exec resources to have the same path
[2014-03-24 10:44:19 -0400] ocholetras: If you have some pattern on your resources
[2014-03-24 10:44:26 -0400] ocholetras: you better have a "base" cookbook
[2014-03-24 10:44:37 -0400] ocholetras: where you implement that behaviour
[2014-03-24 10:45:07 -0400] ocholetras: and use the definitiosn/ Light Weight providers defined there on the rest of your cookbooks
[2014-03-24 10:45:22 -0400] sonne: so it is not possible to do what i asked
[2014-03-24 10:45:44 -0400] sonne: ok, maybe i'm having the wrong approach...
[2014-03-24 10:46:08 -0400] sonne: in a recipe i'm writing, i need to include another recipe i have no control over
[2014-03-24 10:46:22 -0400] sonne: the recipe i'm including declares a resource without a necessary attribute
[2014-03-24 10:46:36 -0400] sonne: in puppet i'm used to using resource defaults to "monkeypatch" this kind of errors
[2014-03-24 10:46:58 -0400] sonne: what could i do with chef?
[2014-03-24 11:11:22 -0400] srenatus: sonne: try wonderberry's chef-rewind: https://github.com/bryanwb/chef-rewind
[2014-03-24 11:13:19 -0400] sonne: srenatus, now that's cool!
[2014-03-24 11:14:22 -0400] srenatus: sonne: totally.  plus, when you look at its source you'll learn about the hackability of chef :)
[2014-03-24 11:15:01 -0400] sonne: great, thanks :)
[2014-03-24 11:17:15 -0400] srenatus: :)
[2014-03-24 11:44:59 -0400] mhenrixon: @coderanger tell me again what is so terrible about the deploy resource[
[2014-03-24 11:54:46 -0400] alexbst: ohai chefs :-)
[2014-03-24 11:55:22 -0400] mhenrixon: alexbst you answering my question?
[2014-03-24 11:56:47 -0400] samstarling: Hi all - I'm having a bit of trouble with Vagrant and opscode-cookbooks/jenkins
[2014-03-24 11:57:03 -0400] Siiseli_: what kind of trouble
[2014-03-24 11:57:12 -0400] samstarling: Specifically, I get "Chef::Exceptions::CookbookNotFound: Cookbook apt not found"
[2014-03-24 11:57:29 -0400] samstarling: So I've got site-cookbooks and cookbooks
[2014-03-24 11:57:29 -0400] Siiseli_: look into berkshelf. Cookbooks can depend on other cookbooks
[2014-03-24 11:57:47 -0400] Siiseli_: berkshelf will automatically download cookbook dependencies
[2014-03-24 11:57:55 -0400] Siiseli_: otherwise you'll have to download the dependencies yerself
[2014-03-24 11:58:07 -0400] alexbst: samstarling - even if your machines are ones that don't run apt, you still need the apt cookbook if it is a dependency.
[2014-03-24 11:58:45 -0400] samstarling: Ah OK - I've been using librarian-chef with a Cheffile
[2014-03-24 11:59:16 -0400] samstarling: And cookbooks contains and apt directory, so I assumed it had been downloaded
[2014-03-24 11:59:28 -0400] samstarling: s/and/an
[2014-03-24 12:00:20 -0400] samstarling: And in my Vagrantfile I have chef.cookbooks_path = ["cookbooks", "site-cookbooks"]
[2014-03-24 12:25:40 -0400] quatrix: Hi, I have a LWR add_service "name", that creates a file in conf.d/ for each add_service call, so, add_service "a", add_service "b", creates two file, "a" and "b", If I comment out add_service "b", the "b" file of course still remains there. what's the best way to go about solving this?
[2014-03-24 13:23:11 -0400] shlant: anyone use the zookeeper_cluster cookbook?
[2014-03-24 13:23:17 -0400] shlant: it seems super broken
[2014-03-24 13:23:25 -0400] shlant: referencing the ookeeper cookbook for some reason
[2014-03-24 13:53:58 -0400] samstarling: Has anyone ever had any luck with librarian-chef and OpsWorks?
[2014-03-24 13:54:17 -0400] samstarling: Looks like OpsWorks only lets you have a single directory of cookbooks, and I've got both cookbooks and site-cookbooks
[2014-03-24 14:22:39 -0400] Breaking_Pitt: Hi guys...
[2014-03-24 14:22:45 -0400] Breaking_Pitt: I'm getting problems with this
[2014-03-24 14:22:46 -0400] Breaking_Pitt: http://pastebin.com/JAQF2tqh
[2014-03-24 14:25:00 -0400] Breaking_Pitt: I don't now what's wrong this is the output of a recipe that runs and work correclty til now
[2014-03-24 14:26:11 -0400] Nukepuppy: maybe a problem with the latest version of 'kurento'  which is where you're failing?
[2014-03-24 14:26:35 -0400] Nukepuppy: 'apt-get -q -y -y --allow-unauthenticated install kurento=4.1.0ubuntu1 returned 100'
[2014-03-24 14:27:28 -0400] Breaking_Pitt: Nukepuppy I don't know I've installed it manually and works correctly
[2014-03-24 14:28:44 -0400] Breaking_Pitt: Nukepuppy I'm running it again on a clean machine to see if this happend again
[2014-03-24 14:36:04 -0400] Breaking_Pitt: Nukepuppy [2014-03-24T15:09:25+01:00] ERROR: execute[apt-get-update] (kurento::4.0.0_install line 91) had an error: Expected process to exit with [0], but received '100'
[2014-03-24 14:42:21 -0400] Nukepuppy: @breaking_pitts is there a /usr/bin/dkpg?
[2014-03-24 14:43:52 -0400] amir_: Is it possible to execute a recipe on multiple nodes on command through the workstation or chef server?
[2014-03-24 14:44:17 -0400] amir_: if i have 100 nodes i want to apt-get update on, is it possible to do this with a bulk command?
[2014-03-24 14:44:37 -0400] iamchrisf: amir_ you could use collective to trigger a chef_run
[2014-03-24 14:44:42 -0400] iamchrisf: mcollective.
[2014-03-24 14:44:55 -0400] Breaking_Pitt: Nukepuppy yes
[2014-03-24 14:46:11 -0400] amir_: thanks
[2014-03-24 14:48:00 -0400] Nukepuppy: @Breaking_pitts i only ask cause other folks complained dpkg was missing or was not executable (755)
[2014-03-24 14:49:36 -0400] Breaking_Pitt: Nukepuppy Thanks for your help, I really appreciate it
[2014-03-24 14:49:51 -0400] Breaking_Pitt: Nukepuppy but dpkg is installed and executable
[2014-03-24 14:50:00 -0400] Breaking_Pitt: so I'm a little bit confused
[2014-03-24 14:55:18 -0400] shlant: anyone getting Chef::Exceptions::RedirectLimitExceeded on Apache2 mod_auth_openid?
[2014-03-24 14:57:09 -0400] iShMaeL^: yo
[2014-03-24 14:58:30 -0400] iShMaeL^: can anyone please help me with the opscode API?
[2014-03-24 14:59:08 -0400] EricL_: I am tryign to build a new host in a VPC with chef and I am associating an EIP address and it still won't connect.  Any thoughts on why it won't just connect?
[2014-03-24 15:00:52 -0400] mjuszczak: I'm trying to inject some code into this recipe (https://github.com/opscode-cookbooks/mysql/blob/master/recipes/ruby.rb) with chef-rewind.  I know how to replace/edit existing resources but are there ways with it to inject new resources, such that I could add in a second repository? I've tried to play with some examples but I can't seem to get it working, just wanted to make sure I'm not pushing towards a dead end (and therefore should just fork the 
[2014-03-24 15:01:34 -0400] nkts: hi, is there a way to bootstrap servers with knife and add tags at the same time?
[2014-03-24 15:09:19 -0400] MattStratton: any thoughts on managing secrets in chef? we have the need to store passwords (service accounts, etc). encrypted databags don't quite work as the customer has regulartory requirements to lock down who can see the secrets (the "anyone in the chef org can decrypt" won't pass their compliance)
[2014-03-24 15:09:43 -0400] Nukepuppy: securing the secret sounds like the best route ;p
[2014-03-24 15:09:51 -0400] MattStratton: we thought about chef-vault, but needing to re-encrypt on every time we add a node to a secret is not good, since they will be spinning up lots and lots of news machines daily
[2014-03-24 15:09:56 -0400] MattStratton: (immutable infrastructure)
[2014-03-24 15:11:50 -0400] EricL_: I am tryign to build a new host in a VPC with chef and I am associating an EIP address and it still won't connect.  Any thoughts on why it won't just connect?  I shoudln't need a bastion host if there is a public IP accessible from the machine that is running knife, no?
[2014-03-24 15:23:08 -0400] nkts: EricL_: check network acls/security groups
[2014-03-24 15:23:42 -0400] EricL_: nkts: I can ssh from my machine just fine while knife is waiting for SSH.
[2014-03-24 15:24:05 -0400] EricL_: It's not a security group problem I don't think.  I think it's trying to connect to the internal IP.
[2014-03-24 15:27:16 -0400] nkts: EricL_: have a look at this --server-connect-attribute
[2014-03-24 15:27:40 -0400] EricL_: I did.  It didn't work.
[2014-03-24 15:28:00 -0400] EricL_: I tried having it use the machine I am spinning up as the bastion host for SSHing through and that fails too.
[2014-03-24 15:28:21 -0400] EricL_: I also tried using knife bootstrap.
[2014-03-24 15:28:31 -0400] EricL_: Same thing.  SSH just times out every time.
[2014-03-24 15:29:20 -0400] nkts: EricL_: maybe try to use -l debug, just to pin down the problem
[2014-03-24 15:30:51 -0400] EricL_: nkts: This is what I've tried so far: http://pastie.org/8964451
[2014-03-24 15:50:55 -0400] nkts: EricL_: IMHO --server-connect-attribute parameter is not an IP address but one of the keys from nodes attributes
[2014-03-24 15:54:45 -0400] EricL_: What do you mean one of the keys?
[2014-03-24 15:56:13 -0400] coredump: Did anyone write stuff about jenkins and testing?
[2014-03-24 15:57:17 -0400] Nukepuppy: coredump what context do you mean that in? ;p
[2014-03-24 15:58:01 -0400] EricL_: Oh, you mean like ec2.public_ipv4 ?
[2014-03-24 15:58:46 -0400] adnichols: coderanger: you around? Curious if you have any cookbook examples where chefspec is used w/ a provider using Poise?
[2014-03-24 15:59:22 -0400] coredump: Nukepuppy: blog posts, howtos, guides, anything on workflows involving chef/jenkins
[2014-03-24 15:59:54 -0400] Nukepuppy: ahh i kinda just took someone elses test kitchen doc
[2014-03-24 16:00:01 -0400] Nukepuppy: its all about how you make the build script in jenkins
[2014-03-24 16:00:03 -0400] Nukepuppy: it works for moi though
[2014-03-24 16:00:31 -0400] tcotav: http://www.cryptocracy.com/blog/2014/01/03/cooking-with-jenkins-test-kitchen-and-docker/
[2014-03-24 16:01:03 -0400] tcotav: I got a lot out of that article (ymmv)
[2014-03-24 16:01:17 -0400] Nukepuppy: though in my case i just use physical hardware jenkins that actually uses headless vbox which isn't the prettiest but it works well for testing cookbooks
[2014-03-24 16:01:30 -0400] Nukepuppy: if hardware's an issue you'll need some sort of docker / lcx situation
[2014-03-24 16:02:41 -0400] nkts: EricL_: yes
[2014-03-24 16:03:08 -0400] EricL_: nkts: That's not working.  I get an error when I try either ec2.public_ipv4 or just ipv4.
[2014-03-24 16:04:56 -0400] EricL_: It keeps saying "undefined method"
[2014-03-24 16:08:04 -0400] nkts: ghm just wondering if ohai has the same strange behaviour on VPC as the facter
[2014-03-24 16:08:44 -0400] EricL_: I am completely stumped and there is no documentation to speak of that I can find on Google.
[2014-03-24 16:10:44 -0400] kbarry: Gotta ruby question: http://pastebin.com/WLRK15iN
[2014-03-24 16:12:14 -0400] kbarry: I'm very new to ruby, and this is stumping me.
[2014-03-24 16:12:36 -0400] workmad3: kbarry: .each_with_index do |item, idx|
[2014-03-24 16:12:49 -0400] kbarry: Awesome
[2014-03-24 16:12:56 -0400] workmad3: kbarry: the index will be 0-indexed, so you can then do 'server.<%= idx + 1 %> ...'
[2014-03-24 16:13:17 -0400] kbarry: Awesome
[2014-03-24 16:14:13 -0400] kbarry: one other thing. Sometime I see they syntax in a template in 2 ways
[2014-03-24 16:14:26 -0400] kbarry: <% yadda %>
[2014-03-24 16:14:33 -0400] kbarry: <% yadda -%>
[2014-03-24 16:17:10 -0400] workmad3: kbarry: I think the -%> is used for supressing a newline
[2014-03-24 16:17:28 -0400] kbarry: ohh
[2014-03-24 16:17:29 -0400] workmad3: kbarry: but I can never remember the exact details beyond that
[2014-03-24 16:17:50 -0400] nkts: yes, correct
[2014-03-24 16:18:45 -0400] kbarry: Thanks for the hint,
[2014-03-24 16:18:46 -0400] kbarry: http://stackoverflow.com/questions/4127274/rails-erb-best-practices-vs-vs
[2014-03-24 16:25:27 -0400] no_name: anyone have a good reference for setting up a Chef Workstation on Windows?
[2014-03-24 16:25:43 -0400] no_name: stuck on my knife configure --initial
[2014-03-24 16:26:55 -0400] no_name: anyone have a good reference for setting up a Chef Workstation on Windows?
[2014-03-24 16:27:05 -0400] no_name: stuck on my knife configure --initial
[2014-03-24 16:34:43 -0400] kbarry: seems like its irrelevant when usingwhat do you mean?
[2014-03-24 16:34:57 -0400] kbarry: no_name what do you mean --initial
[2014-03-24 16:35:39 -0400] no_name: I'm running knife configure --initial, which walks thru the knife.rb setup
[2014-03-24 16:35:45 -0400] Nukepuppy: knife -i  ?
[2014-03-24 16:35:50 -0400] Nukepuppy: you need your files from the chef server
[2014-03-24 16:35:57 -0400] Nukepuppy: put them in a folder.. point them to it during the questions
[2014-03-24 16:36:20 -0400] no_name: yep, I've copied over admin.pem and chef-validator.pem
[2014-03-24 16:36:32 -0400] no_name: it ends up telling me the admin.pem is invalid
[2014-03-24 16:36:39 -0400] Nukepuppy: then it may beee
[2014-03-24 16:36:42 -0400] Nukepuppy: regenerate it
[2014-03-24 16:36:44 -0400] Nukepuppy: if its a new install
[2014-03-24 16:37:44 -0400] no_name: it's not saying that I have the incorrect pem, it's saying that the pem is in an invalid format
[2014-03-24 16:38:08 -0400] no_name: so I initially thought it was a bad character CRLF or something, as I copied from Unix to Windows
[2014-03-24 16:38:20 -0400] no_name: but I deleted those out and that didn't fix it
[2014-03-24 16:38:42 -0400] no_name: wondering if I should just use a linux based workstation instead of windows
[2014-03-24 16:40:32 -0400] coredump: Nukepuppy: we have a real jenkins server so I guess it won't be a problem
[2014-03-24 16:48:26 -0400] shawn_sher: no_name: You might try looking at the cert with the openssl x509 tools to make sure it's what it's supposed to be
[2014-03-24 16:49:22 -0400] no_name: hi shawn, at this point I'm starting to think I should just use a linux workstation, all the tutorials I can find for Windows Chef Workstation setup seem to be lacking
[2014-03-24 16:52:00 -0400] mjuszczak: I'm trying to inject some code into this recipe (https://github.com/opscode-cookbooks/mysql/blob/master/recipes/ruby.rb) with chef-rewind.  I know how to replace/edit existing resources but are there ways with it to inject new resources, such that I could add in a second repository? I've tried to play with some examples but I can't seem to get it working, just wanted to make sure I'm not pushing towards a dead end (and therefore should just fork the 
[2014-03-24 16:52:09 -0400] Nukepuppy: no_name i have a very hybrid setup but it works well.. on windows
[2014-03-24 16:52:39 -0400] no_name: Nukepuppy you mean you're using a windows workstation?
[2014-03-24 16:52:41 -0400] Nukepuppy: @coredump if you just approach it like you would on your desktop start simple on jenkins..  and then perfect your build fail/pass criteria
[2014-03-24 16:52:44 -0400] Nukepuppy: indeed ;P
[2014-03-24 16:52:54 -0400] Nukepuppy: yes'ish
[2014-03-24 16:53:20 -0400] Nukepuppy: while my knife stuff works on windows.. i have a tiny VM that runs headless in vbox that i use now for knife.. in end i think the linux solution is easier
[2014-03-24 16:53:38 -0400] Nukepuppy: i do all my git/knife/berks work on the linux VM that mounts windows thru shares..
[2014-03-24 16:53:45 -0400] no_name: any backup instructions on how you installed it? I'm seeing all sorts of exceptions all over the web, backslash, forward slash problems, single quote, double quote, it's a mess
[2014-03-24 16:53:55 -0400] Nukepuppy: i do vagrant/testkitchen stuff on the 'windows' vm as linux vm cant start vagrant vms etc
[2014-03-24 16:54:23 -0400] Nukepuppy: i use git bash in windows it just automagically does/understands  /c/Users/whatever/Desktop etc
[2014-03-24 16:54:42 -0400] Nukepuppy: so you dont have to deal with the c:\crazy\"path with spaces"\is\annoying
[2014-03-24 16:56:17 -0400] Nukepuppy: no_name the knife stuff is just easier on linux i suggest running a small  64mb ram VM to do the work
[2014-03-24 16:56:32 -0400] no_name: yea I'm setting up a linux workstation now
[2014-03-24 16:56:42 -0400] no_name: using Putty to term into both workstation and server
[2014-03-24 16:56:45 -0400] Nukepuppy: and use windows as the hypervisor for doing vagrant runs that shares the same data if that is in your worklow
[2014-03-24 16:57:02 -0400] no_name: whats the quickest way to copy the server Pem's to the workstation?
[2014-03-24 16:57:39 -0400] Nukepuppy: scp root@chef.server.box:/etc/chef-server/admin.pem ~/.chef
[2014-03-24 16:57:54 -0400] no_name: sweet
[2014-03-24 16:57:59 -0400] Nukepuppy: if you have youruser/.chef folder that is
[2014-03-24 16:58:20 -0400] Nukepuppy: same for other file:
[2014-03-24 16:58:20 -0400] Nukepuppy: scp root@chef.server.box:/etc/chef-server/chef-validator.pem ~/.chef
[2014-03-24 17:02:29 -0400] no_name: thanks Nukepuppy, scp command worked great.
[2014-03-24 17:02:39 -0400] no_name: knike client list returns success
[2014-03-24 17:03:51 -0400] no_name: right now, my cloned repo is in "~/chef-repo/", my Pem's are in "~/chef-repo/.chef" and my knife.rb is in "/home/azureuser/.chef/" will I run into problems with that layout? Should the knife.rb be in my repo folder?
[2014-03-24 17:19:04 -0400] coderanger: adnichols: No, I've never gotten it to work, so I don't use ChefSpec
[2014-03-24 17:40:08 -0400] nkts: why oh why client.pem is required while running chef solo ?
[2014-03-24 17:40:21 -0400] coderanger: nkts: It isn't unless you call search()
[2014-03-24 17:42:20 -0400] nkts: coderanger: thanks
[2014-03-24 17:55:35 -0400] Nukepuppy: no_name i dont bother putting them in chef repo
[2014-03-24 17:55:52 -0400] no_name: gotcha
[2014-03-24 17:56:06 -0400] Nukepuppy: besides then you (somewhat) risk putting your pems in version control ;p
[2014-03-24 17:56:14 -0400] no_name: its just me using it for now
[2014-03-24 17:56:26 -0400] no_name: I need to get mercurial running with it now as the repo
[2014-03-24 17:56:31 -0400] no_name: we use Mercurial/Kiln
[2014-03-24 18:13:55 -0400] swalberg: Bootstrapping a couple of new nodes and ssh-keys isn't figuring out root's home directory so it drops the file in //.ssh/authorized_keys ... It works on other nodes... I'm a bit confused on where to start here
[2014-03-24 18:18:14 -0400] CPS: how would i go about installing an rpm from a custom source?  what attribute would that be for the rpm_package resource?
[2014-03-24 18:19:53 -0400] hugespoon: i think im using this incorrectly, https://gist.github.com/hugespoon/244d6379ac26e034aa88
[2014-03-24 18:20:22 -0400] hugespoon: id like to include that recipe only if its not being deployed to an openstack vm
[2014-03-24 18:20:31 -0400] hugespoon: but it seems to be including it no matter what
[2014-03-24 18:20:34 -0400] mjuszczak: sethvargo: Correct me if I'm wrong, but ... https://github.com/opscode-cookbooks/mysql/search?q=apt_repository[percona]&ref=cmdform .... it's checking to see if mysql::percona_repo is included, but mysql::percona_repo doesn't seem to actually exist anymore.
[2014-03-24 18:20:44 -0400] CPS: hugespoon: wrap the includes in an if block
[2014-03-24 18:21:27 -0400] hugespoon: CPS: can i do ternary operator as well?
[2014-03-24 18:21:40 -0400] swalberg: bah: https://tickets.opscode.com/browse/OHAI-165 also seems to choose ldap over files even though resolv.conf dictates otherwise
[2014-03-24 18:22:01 -0400] CPS: i don't know. I was under the impression ternary was used just for assignment but it might work
[2014-03-24 18:22:30 -0400] hugespoon: meh ill give it a shot, if not, ill go with the if block
[2014-03-24 18:22:55 -0400] CPS: you'd need like a noop thing for ternary
[2014-03-24 18:23:07 -0400] hugespoon: yeah
[2014-03-24 18:23:12 -0400] hugespoon: i just dropped in false
[2014-03-24 18:23:29 -0400] hugespoon: oh yeah
[2014-03-24 18:23:32 -0400] hugespoon: that flaked even more
[2014-03-24 18:23:38 -0400] hugespoon: ok, time for the if block
[2014-03-24 18:25:08 -0400] swalberg: Is there a way to get ohai to ignore ldap users?
[2014-03-24 18:25:25 -0400] swalberg: I see I can turn off the passwd module but then it doesn't know about any users at all
[2014-03-24 18:25:57 -0400] gleam: i dunno how it would know whether a user is ldap or not, it's probably just using getent or some equivalent
[2014-03-24 18:27:13 -0400] swalberg: probably, but why is it choosing the root ldap user over the local one?
[2014-03-24 18:35:35 -0400] shlant: anyone using ifconfig resource on ubuntu?
[2014-03-24 18:35:39 -0400] hugespoon: CPS: hrm still no good
[2014-03-24 18:35:43 -0400] jblack: Hi. Could someone runing chef 10.6 on centos do me a huge favor and do a  "gem list" ?
[2014-03-24 18:36:04 -0400] jblack: My chef server got hit by an unintended upgrade over the weekend and now merb doesn't seem to run due to missing gems.
[2014-03-24 18:37:19 -0400] hugespoon: CPS: gist updated, https://gist.github.com/hugespoon/244d6379ac26e034aa88 ive tried several variations using if, unless, etc
[2014-03-24 18:38:53 -0400] CPS: that's a weird if else
[2014-03-24 18:38:59 -0400] CPS: change it to "if not"
[2014-03-24 18:39:21 -0400] hugespoon: doh
[2014-03-24 18:39:24 -0400] CPS: although that should still work
[2014-03-24 18:39:26 -0400] CPS: what's it doing
[2014-03-24 18:39:27 -0400] coredump: so, anyone has hit a problem with the mysql cookbook trying to install percona-server-client packages even if I have no mention to them whatsoever?
[2014-03-24 18:39:28 -0400] CPS: ?
[2014-03-24 18:40:00 -0400] swalberg: coredump I saw that in the database cookbook. It does a check to see if percona is used elsewhere
[2014-03-24 18:41:16 -0400] swalberg: coredump: sorry, in a dependency: https://github.com/opscode-cookbooks/mysql/blob/master/recipes/ruby.rb#L33
[2014-03-24 18:41:35 -0400] hugespoon: CPS: yeah, switched it just to be sure, its still including the recipe
[2014-03-24 18:43:10 -0400] CPS: where is openstack getting set?
[2014-03-24 18:43:24 -0400] akiel: Hi - do I need to create a cookbook if I wan't to use LWRPs?
[2014-03-24 18:44:04 -0400] hugespoon: CPS: from my understanding, that attribute should be getting set by chef-client w/ ohai
[2014-03-24 18:44:09 -0400] hugespoon: but it does not seem to be :(
[2014-03-24 18:44:27 -0400] CPS: pretty sure ohai stores everything in the node object
[2014-03-24 18:44:36 -0400] CPS: if that's a thing, try node['openstack']
[2014-03-24 18:45:14 -0400] coredump: swalberg: I saw that, but: mysql::ruby isn't being included and mysql::percona_repo doesn't even exist on the most recent cookbook (4.1.2). I also specified the node['mysql']['client']['packages'] list and it doesnt make any difference. ffs.
[2014-03-24 18:45:46 -0400] hugespoon: CPS: afaik, it would be under node['cloud']['provider']
[2014-03-24 18:45:53 -0400] hugespoon: i wonder
[2014-03-24 18:45:56 -0400] CPS: go with that then
[2014-03-24 18:46:19 -0400] mjuszczak: coredump: I was literally just opening a ticket about that now
[2014-03-24 18:47:12 -0400] hugespoon: CPS: i think it might be the ordering of my run list
[2014-03-24 18:47:14 -0400] hugespoon: let me confirm
[2014-03-24 18:47:47 -0400] mjuszczak: coredump: I was adding mariaDB support into a fork and noticed that the percona repo code is still there in ruby.rb, but mysql::percona_repo doesn't exist.
[2014-03-24 18:48:01 -0400] mjuszczak: coredump: It was removed back in mid-February according to git log.
[2014-03-24 18:48:36 -0400] hugespoon: i think they want you to move to yum-percona?
[2014-03-24 18:48:59 -0400] coredump: This is driving me nuts
[2014-03-24 18:49:05 -0400] mjuszczak: coredump: Welcome to the club.
[2014-03-24 18:49:51 -0400] mjuszczak: coredump: Do a git diff:  git diff 97a8d8a9d36e12b8cac362c65f80019479619559 e40d2ee28ff51a96aadeffeec1e644ae7ea7d4b1  -- that's the removal.
[2014-03-24 18:50:17 -0400] coredump: mjuszczak: yeah I can see that.
[2014-03-24 18:53:33 -0400] hugespoon: CPS: eh nope, it just refuses to acknowledge it
[2014-03-24 18:53:54 -0400] CPS: how do you mean?
[2014-03-24 18:55:15 -0400] hugespoon: CPS: im trying to discover why 'cloud' is not getting populated
[2014-03-24 19:00:57 -0400] akiel: If I like to add some nagios checks, I need to create my own cookbook specifying some LWRPs? https://github.com/tas50/chef-nrpe
[2014-03-24 19:01:11 -0400] coredump: mjuszczak: have you created a ticket?
[2014-03-24 19:01:12 -0400] CPS: we've got a website that hosts compiled WAR files with timestamps in the name, in order by timestamp. how would i going about downloading the most recent file?
[2014-03-24 19:01:23 -0400] gchristensen: akiel: correctt
[2014-03-24 19:01:37 -0400] akiel: gchristensen: thx
[2014-03-24 19:03:53 -0400] btm: Chef/Ohai code review join: bit.ly/1mqMOkv, watch: bit.ly/1mqMPF9
[2014-03-24 19:14:58 -0400] carmstrong: thanks @btm
[2014-03-24 19:26:45 -0400] bricker`work: "ORGANIZATION-validator.pem. This private key can be downloaded from the Organizations page." Where?
[2014-03-24 19:28:17 -0400] dgarstang: How does test kitchen know what cookbooks to throw into solo?
[2014-03-24 19:32:46 -0400] holoway: dgarstang: whatever is in your berksfile gets uploaded, and then the run list applied against it
[2014-03-24 19:41:17 -0400] jblack: So, thin is listening on port 4000, but whatever it's supposed to be talking to seems to not be listening.
[2014-03-24 19:50:40 -0400] carmstrong: bricker`work: should be on the list of organizations you're a member of, "Regenerate validation key"
[2014-03-24 19:52:48 -0400] carmstrong: CPS: sounds like you'd have to solve that outside of Chef. have you considered maintaining a symlink so that /builds/current.tar.gz or whatever always points to the latest build? Chef could point to that file
[2014-03-24 19:55:12 -0400] mattray: anyone have an idea how to bump the Package Resource retries globally? Like in client.rb or in the Environment?
[2014-03-24 19:55:43 -0400] dgarstang: How does kitchen vagrant know where to get cookbooks from?
[2014-03-24 19:57:10 -0400] holoway: mattray: you can't do it globally without monkey patching the resource
[2014-03-24 19:57:46 -0400] CPS: carmstrong: considered that but i don't think we have access to the box to do that
[2014-03-24 19:58:02 -0400] dgarstang: *sigh* i just don
[2014-03-24 19:58:07 -0400] dgarstang: ...t get it.
[2014-03-24 19:58:30 -0400] mattray: holoway: I assumed as much, thanks
[2014-03-24 20:00:02 -0400] dgarstang: kitchen vagrant uses chef-solo, so it has to put the cookbooks on the vm, but there's no docs about how that happens. Apparently, it's magic.
[2014-03-24 20:00:36 -0400] carmstrong: dgarstang: pretty sure it uses berkshelf to do the actual pulling of cookbooks
[2014-03-24 20:01:26 -0400] hugespoon: hrm, anyone have any idea why ohai would stop populating the 'cloud' hash? it doesnt even seem to exist in an empty state on my testing
[2014-03-24 20:02:13 -0400] dgarstang: carmstrong: Well, that's not going to work. Does it read Berksfile? The cookbook that its failing on is not a dependancy of the one I am trying to test
[2014-03-24 20:02:37 -0400] dgarstang: carmstrong: However, it IS in the base role.
[2014-03-24 20:03:07 -0400] carmstrong: dgarstang: not sure off the top of my head. Have you tried the folks over in #kitchenci ?
[2014-03-24 20:03:19 -0400] dgarstang: carmstrong: Yes. No one was apparently around
[2014-03-24 20:03:47 -0400] dgarstang: carmstrong: if true, this means you can't use kitchen with roles. Be nice if one of the multitude of blogs out there mentioned this
[2014-03-24 20:04:38 -0400] mattray: hugespoon: are you bootstrapping with "knife ec2" or something?
[2014-03-24 20:04:55 -0400] carmstrong: dgarstang: yeah, not sure you can, but I don't profess to be a test-kitchen expert. I have used it for the java cookbook, but that just has one or two dependencies
[2014-03-24 20:04:59 -0400] hugespoon: mattray: recent testing has been test-kitchen with kitchen-openstack
[2014-03-24 20:05:43 -0400] mattray: you can run ohai and specify the plugins to run, that should help debug
[2014-03-24 20:05:44 -0400] hugespoon: mattray: i was about  to try knife-openstack directly
[2014-03-24 20:05:56 -0400] mattray: see if the /etc/chef/ohai/hint/openstack.json is there
[2014-03-24 20:06:08 -0400] hugespoon: mattray: yeah, the hint definitely doesnt exist
[2014-03-24 20:06:23 -0400] hugespoon: does knife openstack create it automagically?
[2014-03-24 20:06:30 -0400] hugespoon: knife-openstack*
[2014-03-24 20:10:19 -0400] mattray: hugespoon: yes
[2014-03-24 20:12:26 -0400] hugespoon: mattray: i thought that might be the case, so i added an ohai_hint 'openstack' to my run list, and it seems adding the hint manually and running ohai from the shell, still not populating the cloud hash
[2014-03-24 20:12:41 -0400] hugespoon: to a recipe in my run_list *
[2014-03-24 20:14:33 -0400] CPS: when i run ohai on my centos server it reports a 'virtualization' object, but on windows it doesn't. they're both VMs. is this a bug with ohai on windows?
[2014-03-24 20:15:36 -0400] hugespoon: CPS: interestingmine on centos gives me an empty virtualization hash
[2014-03-24 20:15:46 -0400] CPS: is it a vm?
[2014-03-24 20:15:53 -0400] hugespoon: yes
[2014-03-24 20:16:04 -0400] CPS: my windows box doesn't have it at all
[2014-03-24 20:16:16 -0400] hugespoon: is yours filled in on centos?
[2014-03-24 20:16:20 -0400] CPS: yes
[2014-03-24 20:16:36 -0400] hugespoon: hrm
[2014-03-24 20:17:03 -0400] coredump: mjuszczak: I found out that the node "normal" attributes had the percona package listed on it... I have no idea how it ended there and why the role setting didn't work...
[2014-03-24 20:24:59 -0400] hugespoon: mattray: hrm i cant test with knife-openstackseems you are working on testing w/ neutron per https://github.com/opscode/knife-openstack/pull/78
[2014-03-24 20:26:10 -0400] hugespoon: mattray: indeed, thank you sir
[2014-03-24 20:26:26 -0400] hugespoon: but now to figure out why chef doesnt realize im on openstack..
[2014-03-24 20:28:26 -0400] dgarstang: if you put roles into a role cookbook, that means this role cookbook would need to have a summation of every single dependancy (assuming each 'role' was a recipe), and surely, that sucks?
[2014-03-24 20:29:12 -0400] shlant: anyone know how I can reference "eth0" if I have a data bag like this?
[2014-03-24 20:29:13 -0400] shlant: "id": "network",
[2014-03-24 20:29:13 -0400] shlant:     "interfaces": {
[2014-03-24 20:29:14 -0400] shlant:       "eth0": {
[2014-03-24 20:29:14 -0400] shlant:         "address": "10.24.129.135",
[2014-03-24 20:29:15 -0400] shlant:         "netmask": "255.255.0.0",
[2014-03-24 20:29:15 -0400] shlant:         "gateway": "10.24.129.0"
[2014-03-24 20:29:15 -0400] shlant:       }
[2014-03-24 20:29:16 -0400] shlant:     }
[2014-03-24 20:30:00 -0400] shlant: like I want to reference the key name
[2014-03-24 20:30:02 -0400] shlant: not a value
[2014-03-24 20:30:47 -0400] CPS: are you looking to get "eth0"?
[2014-03-24 20:30:52 -0400] CPS: the key name?
[2014-03-24 20:35:09 -0400] dgarstang: if you put roles into a role cookbook, that means this role cookbook would need to have a summation of every single dependancy (assuming each 'role' was a recipe), and surely, that sucks?
[2014-03-24 20:35:48 -0400] CPS: shlant: data_bag_item("???","network")["interfaces"].keys will give you an array of keys, eth0 will be one of them
[2014-03-24 20:35:52 -0400] CPS: order not guaranteed
[2014-03-24 20:42:32 -0400] dgarstang: what are the disadvantages of putting roles into a cookbook?
[2014-03-24 20:47:18 -0400] mjuszczak: coredump: had to step away but owrking on it now
[2014-03-24 20:49:17 -0400] chris613: dgarstang: The only one I've encountered (we eliminated all roles about a year ago) is that sometimes you are making a top-level cookbook that is truly very very trivial - essentially setting one attribute and then calling another top-level cookbook. In this case it feels like a role is more appropriate, but we just live with the feeling
[2014-03-24 20:49:28 -0400] hugespoon: mattray: just to make sure im not crazy /etc/chef/ohai/hint/openstack.json should just contain "{}" right?
[2014-03-24 20:50:18 -0400] CPS: what's the motivation to eliminate roles?
[2014-03-24 20:51:21 -0400] mattray: hugespoon: I don't think it needs to contain anything
[2014-03-24 20:51:28 -0400] mattray: touch might be good enough
[2014-03-24 20:51:45 -0400] mattray: I think we look for the existence, don't know if we even bother to read it (yet)
[2014-03-24 20:51:48 -0400] hugespoon: mattray: hrm, well im creating it manually even, and it still seems to be ignoring it entirely
[2014-03-24 20:52:12 -0400] hugespoon: do i need to pass a hints dir?
[2014-03-24 20:52:18 -0400] hugespoon: (didnt see that option)
[2014-03-24 20:52:33 -0400] dgarstang: chris613: it didnt bother you having to put the dependancies for every single recipe (assuming you mapped each role into a recipe in the same cookbook) into the metadata?
[2014-03-24 20:54:10 -0400] mattray: hugespoon: 1 minute, debugging
[2014-03-24 20:55:19 -0400] chris613: dgarstang: We didn't do that. Each role got mapped onto a "top level" cookbook called tlc-<rolename>. We figured that a role defines a set of attributes and a run list, and that a top level cookbook could do the same things, so we just mapped them 1:1 to start
[2014-03-24 20:55:35 -0400] hugespoon: mattray: thank you for your help btw
[2014-03-24 20:55:39 -0400] chris613: It's only now, a year later, than our cookbooks have gotten organized enough that we're running into the issue I described above
[2014-03-24 20:55:49 -0400] mattray: hugespoon: ohai -l debug should give you a ridiculous stacktrace
[2014-03-24 20:55:53 -0400] mattray: err, output
[2014-03-24 20:56:04 -0400] dgarstang: chris613: so each role became a totally separate cookbook, not recipes in a single cookbook?
[2014-03-24 20:56:25 -0400] chris613: dgarstang: yes
[2014-03-24 20:56:38 -0400] dgarstang: chris613: Wow, that's a lot of cookbooks, no?
[2014-03-24 20:57:18 -0400] mattray: hugespoon: and you should see "ohai openstack"
[2014-03-24 20:57:20 -0400] chris613: dgarstang: In our case our entire environment for 500+ machines can be described with about 35 roles
[2014-03-24 20:57:41 -0400] dgarstang: chris613: I suppose we're about the same.
[2014-03-24 20:57:48 -0400] mjuszczak: coredump: https://tickets.opscode.com/browse/COOK-4473
[2014-03-24 20:57:50 -0400] mattray: hugespoon: or "NOT ohai openstack" in the debug
[2014-03-24 20:58:02 -0400] hugespoon: mattray: yes, i see 'NOT ohai openstack'
[2014-03-24 20:58:14 -0400] dgarstang: chris613: How about chef search? roles make it easy to say, get me a list of machines in the 'web server' role. Would using cookbooks give you something similar?
[2014-03-24 20:58:17 -0400] mattray: hugespoon: ok, that means the hint is wrong
[2014-03-24 20:58:33 -0400] chris613: dgarstang: We do searches like run_list:*tlc-webserver*
[2014-03-24 20:58:45 -0400] dgarstang: chris613: ok, what I figured. :)
[2014-03-24 20:58:47 -0400] hugespoon: mattray: one sec, forgot i reloaded :D
[2014-03-24 20:58:51 -0400] hugespoon: let me create the hint
[2014-03-24 20:59:45 -0400] hugespoon: ok, same result :-/
[2014-03-24 21:00:27 -0400] dgarstang: chris613: Thanks for the input
[2014-03-24 21:01:24 -0400] mattray: hugespoon: /etc/chef/ohai/hints/openstack.json?
[2014-03-24 21:01:54 -0400] chris613: dgarstang: As a final note, when we've discovered that we really want roles back so that we can "set one attribute and then use such-and-such tlc cookbook" we end up just making a new recipe in the top-level. It's not ideal if you need to do that a lot, but for exceptional cases it's working okay
[2014-03-24 21:01:55 -0400] hugespoon: mattray: yeah i had a typo, hint instead of hints
[2014-03-24 21:02:58 -0400] mattray: hugespoon: so ohai still doesn't run the openstack plugin?
[2014-03-24 21:03:19 -0400] hugespoon: mattray: no, it does now that ive corrected the hint path
[2014-03-24 21:03:31 -0400] hugespoon: but im curious as to why the ohai cookbook doesnt create the hint properly
[2014-03-24 21:03:46 -0400] mattray: hugespoon: I didn't know it created it
[2014-03-24 21:04:03 -0400] hugespoon: mattray: im specifying it via the ohai_hint lwrp
[2014-03-24 21:04:21 -0400] mattray: hugespoon: reading that now
[2014-03-24 21:04:30 -0400] hugespoon: which seems to be a recent addition
[2014-03-24 21:06:00 -0400] mattray: hugespoon: github says a month ago :)
[2014-03-24 21:06:29 -0400] hugespoon: yeah, thats pretty recent, but in the effort of figuring this out i updated my local version and added it
[2014-03-24 21:06:36 -0400] mattray: hugespoon: so what's breaking? the ohai cookbook?
[2014-03-24 21:07:56 -0400] hugespoon: mattray: the ohai_hint lwrp doesnt actually create the hint
[2014-03-24 21:08:50 -0400] mattray: hugespoon: ok, in that case I'd watch the run with "chef-client -l debug", perhaps throw a pry breakpoint in there once I found the issue
[2014-03-24 21:09:03 -0400] mattray: pry in the Provider probably
[2014-03-24 21:09:34 -0400] mattray: but at least the bug doesn't appear to be ohai
[2014-03-24 21:09:35 -0400] hugespoon: mattray: gotcha thx
[2014-03-24 21:17:16 -0400] dgarstang: *sigh* I just can't get kitchen to find dependancies. Why so hard?
[2014-03-24 21:18:00 -0400] Nukepuppy: what sort of deps?
[2014-03-24 21:18:06 -0400] Nukepuppy: like cookbook?
[2014-03-24 21:18:14 -0400] Nukepuppy: are they private cookbooks?
[2014-03-24 21:18:19 -0400] dgarstang: I just put my base role into a cookbook and verified it worked with vagrant. I then went to another cookbook where I wanted to test that base role with. The base role is NOT a dependancy of this cookbook, but it seems like kitchen reads berksfile and therefore needs it to be?
[2014-03-24 21:18:34 -0400] dgarstang: Nukepuppy: ^
[2014-03-24 21:18:58 -0400] dgarstang: if so, something fundamental is missing.
[2014-03-24 21:19:18 -0400] Nukepuppy: is your cookbook private?
[2014-03-24 21:19:21 -0400] Nukepuppy: for the role
[2014-03-24 21:19:25 -0400] dgarstang: Nukepuppy: no
[2014-03-24 21:19:47 -0400] Nukepuppy: guess im missing something somewhere ;p
[2014-03-24 21:20:21 -0400] dgarstang: Nukepuppy: Well, so am I. It doesn't even make sense for kitchen to read Berksfile (cuz then a converge would happen on every vagrant run and there'd be no need for kitchen).
[2014-03-24 21:20:51 -0400] dgarstang: so, therefore, kitchen has to be told where to get it's cookbooks from. I can't find that documented.
[2014-03-24 21:21:42 -0400] Nukepuppy: berksfile is needed by kitchen to handle dependencies just like vagrant does
[2014-03-24 21:21:55 -0400] Nukepuppy: like if you depend on an internal cookbook on your gitlab or something.. thats only way to resolve it in kitchen
[2014-03-24 21:22:10 -0400] Nukepuppy: or a specific upstream version etc.. kitchn has to read it
[2014-03-24 21:23:05 -0400] dgarstang: Nukepuppy: but the dependancies are most definitely not the same
[2014-03-24 21:23:38 -0400] Nukepuppy: your test kitchen and vagrant are differnet ? on purpose?
[2014-03-24 21:23:57 -0400] Nukepuppy: mind if we see the 3 things ? berksfile / kitchen.yml  / vagrantfile?
[2014-03-24 21:24:07 -0400] dgarstang: Nukepuppy: if I test this cookbook with vagrant, I only want to unit test that one cookbook. I don't want the base role, so it's not a dependancy. I want to use test kitchen to 'converge' and test both together, in which case (apparently) the base role IS required in Berksfile
[2014-03-24 21:25:29 -0400] Nukepuppy: id handle that via a custom run list but maybe im over simplyfing it
[2014-03-24 21:25:47 -0400] dgarstang: Nukepuppy: Does that make sense? not sure what a custom run list is
[2014-03-24 21:26:06 -0400] Nukepuppy: well your vagrantfile has a run_list where somewhere you told it what to run
[2014-03-24 21:26:17 -0400] dgarstang: Surely, I can't be the only one experiencing this disconnect with the whole point of kitchen
[2014-03-24 21:26:19 -0400] Nukepuppy: and so does kitchen.yml.. where you can include more stuff (as long as berks can resolve it )
[2014-03-24 21:26:30 -0400] dgarstang: Nukepuppy: ok, and?
[2014-03-24 21:26:31 -0400] Nukepuppy: i think it would still help to see your 3 core files ;p
[2014-03-24 21:26:47 -0400] Nukepuppy: soo somewhere you asked to include the role cookbook?
[2014-03-24 21:26:48 -0400] dgarstang: Nukepuppy: I can paste them, but this is conceptually quite simple
[2014-03-24 21:27:07 -0400] dgarstang: Nukepuppy: in the kitchen.yml, yes, it includes the role cookbook
[2014-03-24 21:28:28 -0400] xmltok: Cannot find a resource for user_account on ubuntu version 14.04 <-- is this a real problem with my install or is 14.04 not supported yet?
[2014-03-24 21:30:12 -0400] Nukepuppy: dgarstang i think it comes down to how you want to use things.. once you have the dependency in berkfiles / metadata etc your working repository assumes its needed.. i would just manually edit it when you're done with vagrant finish it up with the dependencies included for kitchen to do the testing
[2014-03-24 21:30:41 -0400] Nukepuppy: maybe our workflows differ heavily i just use vagrant to verify functionality then abandon it and use kitchen to finish off everything unit/integration/spec related
[2014-03-24 21:31:07 -0400] dgarstang: Nukepuppy: if I put the base role into my Vagrantfile, what's the point of test kitchen?!
[2014-03-24 21:31:33 -0400] Nukepuppy: well vagrant has some limited usage but if you plan to do integration tests
[2014-03-24 21:31:40 -0400] Nukepuppy: thats not gonna work well in vagrant or at all
[2014-03-24 21:32:00 -0400] Nukepuppy: like the concept of 'kitchen verify'  doesnt exist for vagrant
[2014-03-24 21:32:11 -0400] tehnef: we're not at a point yet where we want to have all our cookbooks in individual repos
[2014-03-24 21:32:41 -0400] tehnef: thus far i've been putting my entire chef repo into git, minus the sensitive stuff
[2014-03-24 21:32:54 -0400] tehnef: i just refactored and made it track only my cookbooks directory. bad move?
[2014-03-24 21:33:04 -0400] law: hey all, I'm having some serious issues getting test-kitchen to play nice with chef/chef-zero
[2014-03-24 21:33:17 -0400] Nukepuppy: yes ;P because changes to cookbook/A still effect cookbook/B
[2014-03-24 21:33:25 -0400] law: I can't seem to get test-kitchen/chef-zero to find my environments
[2014-03-24 21:33:39 -0400] Nukepuppy: affect*
[2014-03-24 21:33:47 -0400] dgarstang: Nukepuppy: Well there has to be a way then to unit test the cookbook, and then test the whole thing deploys without hand editing Vagrant file
[2014-03-24 21:34:00 -0400] law: further, I'm trying to grep all "chef*" processes on the kitchen node as chef-client runs, so I can see what flags the chef-zero server is running as
[2014-03-24 21:34:09 -0400] law: and I can't seem to find any processes called 'chef-zero'
[2014-03-24 21:34:23 -0400] law: zero seems to be running automatically when the command 'chef-client -z - --log_level info --json-attributes /tmp/kitchen/dna.json' runs, but I don't know how it's being called
[2014-03-24 21:34:27 -0400] Nukepuppy: dgarstang yeah thats what test kitchen does :P
[2014-03-24 21:34:37 -0400] Nukepuppy: vagrant doesn't do much other than prove it works for my workflow
[2014-03-24 21:34:41 -0400] dgarstang: Nukepuppy: i disagree... based on our conversation just now. :)
[2014-03-24 21:35:18 -0400] dgarstang: Nukepuppy: kitchen reads your Berksfile, therefore it tests the same things as Vagrant, which means it isn't testing any further functionality
[2014-03-24 21:36:04 -0400] Nukepuppy: dgarstang.. you're not testing anything by just doing vagrant up
[2014-03-24 21:36:15 -0400] dgarstang: Nukepuppy: I'm unit testing the cookbook
[2014-03-24 21:36:18 -0400] Nukepuppy: write integration tests in serverspec into test/integration
[2014-03-24 21:36:25 -0400] Nukepuppy: and do it with kitchen verify
[2014-03-24 21:36:28 -0400] Nukepuppy: how are you doing that though?
[2014-03-24 21:36:38 -0400] Nukepuppy: chefspec or something?
[2014-03-24 21:36:50 -0400] dgarstang: Nukepuppy: then, I would need to add the base role to the Berksfile, and I'm therefore no longer unit testting just that cookbook
[2014-03-24 21:37:20 -0400] dgarstang: Nukepuppy: I could not get chefspec to work. It seems to fail with wrapper cookbooks. Fail.
[2014-03-24 21:37:38 -0400] Nukepuppy: wrapper cookbooks need a private URL entry in berksfile its easy to fix
[2014-03-24 21:37:45 -0400] Nukepuppy: ie: cookbook "myprivatecookbook", git: 'git@myprivate.gitlab.server:path/myprivatecookbook.git'
[2014-03-24 21:37:57 -0400] dgarstang: Nukepuppy: I have that.
[2014-03-24 21:38:28 -0400] dgarstang: Nukepuppy: we wrap apt in bc-apt. The berskfile has the path to the git repo where bc-apt is. chefspec complains it can't find the apt cookbook. It seems hard coded.
[2014-03-24 21:38:50 -0400] dgarstang: but, the base role is more of an issue right now
[2014-03-24 21:38:54 -0400] Nukepuppy: id review this guy: http://misheska.com/blog/2013/08/06/getting-started-writing-chef-cookbooks-the-berkshelf-way-part3/
[2014-03-24 21:39:00 -0400] Nukepuppy: to see why  test-kitchen helps
[2014-03-24 21:39:09 -0400] Nukepuppy: again dont know how you're unit testing anything in vagrant
[2014-03-24 21:39:17 -0400] dgarstang: Nukepuppy: why not?
[2014-03-24 21:39:23 -0400] dgarstang: Nukepuppy: why would I unit test on... ec2?
[2014-03-24 21:39:42 -0400] Nukepuppy: -.-
[2014-03-24 21:39:59 -0400] Nukepuppy: not sure if trolling at this point
[2014-03-24 21:40:06 -0400] dgarstang: Nukepuppy: spinning up 50 instances a day to get chef syntax right dosn't make sense
[2014-03-24 21:40:06 -0400] Nukepuppy: but anyways afk
[2014-03-24 21:46:54 -0400] coredump: what can possibly make something that is on the run_list to not even be mentioned on a chef run?
[2014-03-24 21:47:14 -0400] coredump: it resolves the run_list with all the cookbooks but doesn't run them.
[2014-03-24 21:47:17 -0400] coredump: ffs
[2014-03-24 21:59:19 -0400] dgarstang: There's nothing trolling about not spinning up ec2 instances to check chef syntax
[2014-03-24 22:04:07 -0400] bricker: What's the difference between `chef node create` and `chef client create`? If I do either one, it shows up under both `chef client list` and `chef node list`
[2014-03-24 22:04:23 -0400] bricker: oops, knife*
[2014-03-24 22:04:24 -0400] bricker: not chef
[2014-03-24 22:09:36 -0400] coderanger: bricker: a client is basically just an API key
[2014-03-24 22:09:52 -0400] coderanger: bricker: the node is the thing that stores state data about a single server
[2014-03-24 22:10:22 -0400] coderanger: bricker: For example if you had a script that made updates to chef, it might have a client but no node
[2014-03-24 22:11:44 -0400] jkeiser: law: chef-zero is started as part of the chef-client process; it's just a thread
[2014-03-24 22:11:53 -0400] jkeiser: law: the ruby code for chef-zero is called directly
[2014-03-24 22:12:24 -0400] coderanger: jkeiser: You lost your 2, I'm confused now :-(
[2014-03-24 22:12:50 -0400] jkeiser: coderanger: yeah, someone had already grabbed my nick on twitter when I got it
[2014-03-24 22:13:05 -0400] coderanger: Yeah, I've just seen you use the same on here mostly
[2014-03-24 22:13:34 -0400] law: ahh ok, so there should be no 'chef-zero' process in my processlist?
[2014-03-24 22:13:41 -0400] jkeiser: coderanger: huh.  Didn't notice that :)  Probably because I was in the midst of switching IRC clients
[2014-03-24 22:14:03 -0400] coderanger: jkeiser: Do you want op in here? I think I have perms to grant it
[2014-03-24 22:14:10 -0400] jkeiser: coderanger: sure
[2014-03-24 22:14:31 -0400] jkeiser: coderanger: incidentally, the person that has my nick on Twitter was apparently in Anchorman 2 (according to her tweets anyway)
[2014-03-24 22:14:42 -0400] jkeiser: law: correctamundo
[2014-03-24 22:15:05 -0400] law: ok, cool
[2014-03-24 22:16:32 -0400] dgarstang: might as well try again. :)  Seems kitchen reads Berksfile. I am confused about that. The cookbook in question doesn't need the base-role cookbook to work, and therefore isn't in the Berksfile, but kitchen needs it in the Berksfile. If I do that, then a 'vagrant up' and a 'kitchen test' (at least with vagrant) become the same thing. What's the point of kitchen?
[2014-03-24 22:17:26 -0400] coderanger: jkeiser: There we go
[2014-03-24 22:17:41 -0400] jkeiser: coderanger: thanks!
[2014-03-24 22:19:17 -0400] coderanger: jkeiser: Do you know of anyone else that should have op that doesn't?
[2014-03-24 22:20:30 -0400] jkeiser: coderanger: offhand, no, but now I can grant if I notice :)
[2014-03-24 22:37:36 -0400] bricker: coderanger: ahh I see, thanks!
[2014-03-24 22:39:40 -0400] TrinitronX: anyone know about a problem with knife in Chef: 11.10.4 where `knife bootstrap` is appending a double '@FQDN' when it tries to ssh to the node?
[2014-03-24 22:40:18 -0400] TrinitronX: Looks like: ERROR: Net::SSH::AuthenticationFailed: Authentication failed for user root@example.com@example.com
[2014-03-24 22:46:13 -0400] coderanger: TrinitronX: Whats the full command you are running?
[2014-03-24 22:54:20 -0400] kbarry: so, on Linux you can hand-code the client.rb with the node name you want it to use whne it connects tot he chef server the first time
[2014-03-24 22:54:41 -0400] kbarry: when inspecting the client.rb file on windows, its constructed differently.
[2014-03-24 22:55:08 -0400] kbarry: Is there a way to fascilitate the same process?
[2014-03-24 22:58:10 -0400] coderanger: kbarry: Not sure what you mean, the same on both
[2014-03-24 22:58:23 -0400] coderanger: kbarry: If an explicit name is given, it is used, otherwise the hostname is used
[2014-03-24 22:59:26 -0400] supercom32: Does anyone know how to reference a node attribute from within a recipe? For example, On my node I have an attribute called ['product']['version'].
[2014-03-24 22:59:40 -0400] supercom32: So should I just do node.['product']['version'] ?
[2014-03-24 22:59:48 -0400] supercom32: Because that doesn't seem to work.
[2014-03-24 23:00:16 -0400] daxroc: supercom32: node['attr']
[2014-03-24 23:01:15 -0400] coderanger: supercom32: node['product']['version']
[2014-03-24 23:01:32 -0400] supercom32: When I do that, I get a nill error though
[2014-03-24 23:01:43 -0400] supercom32: as if it wasn't defined
[2014-03-24 23:02:11 -0400] daxroc: coderanger: on the library topic again. How do you make node available to your library?
[2014-03-24 23:02:29 -0400] coderanger: supercom32: Make sure you set a default value for it
[2014-03-24 23:02:44 -0400] coderanger: daxroc: You can't, either you need to be in a context that has it or pass it in
[2014-03-24 23:03:07 -0400] supercom32: coderanger: On my chef server, I can see the value that is currently set for it. Is that what you mean?
[2014-03-24 23:03:22 -0400] coderanger: supercom32: Pastebin the code and error
[2014-03-24 23:03:45 -0400] scalp42: daxroc you can just pass the node object itself I believe to your methods
[2014-03-24 23:04:10 -0400] xmltok: is there a cookbook to configure knife for a user?
[2014-03-24 23:04:19 -0400] supercom32: coderanger: It's just cannot convert nil into string. Because I try to print out the value of the attribute and it dies.
[2014-03-24 23:04:27 -0400] coderanger: xmltok: Thats somewhat of a chicken-and-egg problem
[2014-03-24 23:04:31 -0400] daxroc: scalp42: just thought there was a more elegant way?
[2014-03-24 23:04:34 -0400] coderanger: xmltok: But perhaps check out solowizard
[2014-03-24 23:04:45 -0400] coderanger: daxroc: What are you trying to do?
[2014-03-24 23:04:46 -0400] xmltok: coderanger: well, i have a jenkins build node that i want to configure to run knife commands to upload tested cookbooks
[2014-03-24 23:04:49 -0400] scalp42: supercom32 we'll need the code you're trying to use
[2014-03-24 23:05:08 -0400] coderanger: xmltok: Just point knife at /etc/chef/client.rb
[2014-03-24 23:05:50 -0400] supercom32: updater_version_to_install = node['product']['version']
[2014-03-24 23:06:07 -0400] supercom32: That's all it is. And updater_version_to_install is nill
[2014-03-24 23:06:09 -0400] xmltok: thne i need to make sure that all of my future jenkins build nodes have admin access to upload cookbooks
[2014-03-24 23:06:23 -0400] xmltok: ill probably just write a small cookbook to configure my jenkins nodes with the extra account
[2014-03-24 23:06:25 -0400] supercom32: because even though the attribute was set inside the node already, nothing is being returned. On my chef server I can see the attribute.
[2014-03-24 23:06:42 -0400] daxroc: coderanger: I've setup an attribute 'namespace' for our attributes, mainly to cortail rouge variables. My goal was to create a global library with access to all our attributes and some common functionality.
[2014-03-24 23:07:53 -0400] daxroc: so instead of node[:attr] we would use namespace[:attr] ?
[2014-03-24 23:10:26 -0400] coderanger: supercom32: How is the attribute being set
[2014-03-24 23:10:53 -0400] daxroc: coderanger: doens't make sense right.
[2014-03-24 23:10:56 -0400] coderanger: daxroc: So if you want to add DSL extensions you need to patch into a couple of Chef classes, and you can grab node locally, sec
[2014-03-24 23:11:13 -0400] coderanger: daxroc: https://github.com/balanced-cookbooks/citadel/blob/master/libraries/default.rb#L48-L68
[2014-03-24 23:11:34 -0400] coderanger: daxroc: Just change the method name, but thats probably the structure you want
[2014-03-24 23:12:17 -0400] supercom32: The attribute is being set by: "node.default['product']['version'] = 10.12.111" like that.
[2014-03-24 23:12:30 -0400] supercom32: With "" around the value of course
[2014-03-24 23:12:31 -0400] coderanger: supercom32: Where?
[2014-03-24 23:12:36 -0400] supercom32: default.rb
[2014-03-24 23:12:56 -0400] coderanger: supercom32: Okay, double check that attribute file is running correctly
[2014-03-24 23:13:18 -0400] supercom32: Well, this value is not being set in the attribute file. it's being set in the recipe. The server already has this attribute.
[2014-03-24 23:13:31 -0400] daxroc: coderanger: So you pass node in from the ChefDSL module, so I would also need to define the constructor too to set the node instance ?
[2014-03-24 23:14:17 -0400] coderanger: daxroc: So in the ChefDSL#citadel method it just calls node as a method
[2014-03-24 23:14:28 -0400] coderanger: daxroc: because it just so happens all three of the patches classes define a method called node
[2014-03-24 23:14:35 -0400] supercom32: coderanger: Essentially my intention is to have a variable on the node called "version" and when I modify that variable, the recipe can pick it up and use it. I can't hardcode that value into my recipe.
[2014-03-24 23:14:48 -0400] coderanger: daxroc: What you do with it at that point is up to you :-)
[2014-03-24 23:15:08 -0400] coderanger: supercom32: Please pastebin the recipe
[2014-03-24 23:15:45 -0400] shlant: coderanger: do I need to specify the Debian ifconfig provider, or will it know based on my OS?
[2014-03-24 23:16:20 -0400] shlant: the docs are dreadfully out of date
[2014-03-24 23:16:24 -0400] benner: how to make search in override atributes?
[2014-03-24 23:19:19 -0400] adnichols: coderanger: have you considered releasing Poise as a gem? I'd be easy to unit tests hw providers w/ just rspec but we can't pull in Poise w/out Chef which means chefspec
[2014-03-24 23:20:15 -0400] coderanger: adnichols: Poise classes need to be defined during lib compile time, and I can't install a gem easily at that point since chef doesn't exist yet
[2014-03-24 23:20:35 -0400] shlant: coderanger: cool. And do you know how I would specify something like "up      ip r a 172.22.0.0/16 via 10.1.0.1 dev eth0" in /etc/network/interfaces? can I use the ifconfig or route resource?
[2014-03-24 23:20:43 -0400] coderanger: adnichols: I don't think ChefSpec is a viable testing system long-term, TK is a better model if unfortunately more heavyweight
[2014-03-24 23:20:46 -0400] adnichols: coderanger: bummer, this was all going so well till I had to unit test
[2014-03-24 23:21:02 -0400] adnichols: coderanger: TK doesn't help me test things like raising exceptions
[2014-03-24 23:21:17 -0400] coderanger: adnichols: Sure it does, use TK + Minitest, thats how Poise itself is tested
[2014-03-24 23:22:07 -0400] adnichols: coderanger: ok, will look at that
[2014-03-24 23:22:08 -0400] coderanger: adnichols: Its definitely annoyingly verbose though
[2014-03-24 23:22:16 -0400] coderanger: adnichols: The poise tests might make you very sad
[2014-03-24 23:22:26 -0400] adnichols: coderanger: already done :(
[2014-03-24 23:22:35 -0400] coderanger: For example
[2014-03-24 23:22:36 -0400] coderanger: assert_equal run_context.resource_collection.object_id, node.run_state[:subcontext_block_test_collection].parent.object_id
[2014-03-24 23:23:02 -0400] redondos: hi. what's the recommended way of configuring ssl certificates on a chef 11 server?
[2014-03-24 23:23:08 -0400] coderanger: adnichols: If you really want to investigate true unit tests, look at how Chef does it internally
[2014-03-24 23:23:08 -0400] redondos: i can't find any official documentation
[2014-03-24 23:23:19 -0400] coderanger: adnichols: You have to do a lot of manual mocking/stubbing though
[2014-03-24 23:23:32 -0400] adnichols: coderanger: yeah, that's what we're trying to avoid
[2014-03-24 23:23:42 -0400] coderanger: adnichols: Yeah, no way around that AFAICT
[2014-03-24 23:24:06 -0400] coderanger: adnichols: You can't just do a blanket monkeypatch of most/all providers and have everything still work
[2014-03-24 23:24:30 -0400] adnichols: coderanger: fair enough
[2014-03-24 23:25:23 -0400] coderanger: redondos: Not sure what you mean, just put them in the folder and update chef-server.rb
[2014-03-24 23:25:54 -0400] redondos: and then run reconfigure?
[2014-03-24 23:25:58 -0400] coderanger: redondos: Yahr
[2014-03-24 23:26:03 -0400] redondos: gotcha, thanks
[2014-03-24 23:26:16 -0400] coderanger: adnichols: If you find something easier, I would love to use it :-(
[2014-03-24 23:26:35 -0400] redondos: something that's been bugging me since i upgraded from chef 10 is that one particular cookbook causes the server to hang at 100% cpu for a long while until the client reports: The Chef Server is temporarily unavailable
[2014-03-24 23:26:40 -0400] redondos: have you seen this behavior?
[2014-03-24 23:26:51 -0400] coderanger: redondos: That is generally a depsolver failure
[2014-03-24 23:26:52 -0400] redondos: could it be recursive dependencies causing this?
[2014-03-24 23:27:08 -0400] redondos: how can I debug this? it's a pretty large cookbook depending on many others
[2014-03-24 23:27:08 -0400] coderanger: Some constraint it can't find a valid solution for but it goes into a very long loop trying to find a solution
[2014-03-24 23:27:26 -0400] coderanger: redondos: https://gist.github.com/coderanger/9198932 can help
[2014-03-24 23:27:36 -0400] redondos: excellent, thank you coderanger
[2014-03-24 23:27:43 -0400] coderanger: redondos: Use that on different combos of cookbooks until you find the smallest set that triggers the runaway CPU usage
[2014-03-24 23:28:07 -0400] coderanger: redondos: Its unfortunately manual though :-(
[2014-03-24 23:28:14 -0400] redondos: is there a config parameter to tell the server to give up more easily?
[2014-03-24 23:28:19 -0400] coderanger: redondos: Not currently
[2014-03-24 23:28:21 -0400] redondos: yeah i knew this wasn't going to be easy
[2014-03-24 23:28:30 -0400] redondos: but that snippet helps, thanks again
[2014-03-24 23:28:42 -0400] coderanger: redondos: A future release of chef-server will go back to the old gecode solver, which had more tuning params
[2014-03-24 23:28:51 -0400] coderanger: redondos: I don't know if there is an eta for that though
[2014-03-24 23:29:12 -0400] redondos: is the gecode solver the one on chef 10? that one didn't hang, at least
[2014-03-24 23:29:16 -0400] coderanger: Yeah
[2014-03-24 23:29:31 -0400] redondos: cool, down the rabbit hole i go.
[2014-03-24 23:29:37 -0400] coderanger: Good luck!
[2014-03-24 23:29:41 -0400] redondos: ty :)
[2014-03-24 23:29:54 -0400] coderanger: jkeiser: ^^ Any formal ETA on porting that code to FOSS server?
[2014-03-24 23:30:22 -0400] supercom32: Hrm... I think I figured out my issue. I think I was incorrectly assuming that my node attributes would not be reset after each run. At least using the default clause.
[2014-03-24 23:30:51 -0400] supercom32: I need a node attribute that I can set if one doesn't exist, but can change only if explicitly set to.
[2014-03-24 23:31:02 -0400] coderanger: supercom32: Indeed, default/override attrs are reset
[2014-03-24 23:31:10 -0400] Otterley: is anyone aware of an issue with rogue service notification failures?
[2014-03-24 23:31:14 -0400] coderanger: supercom32: only normal level attrs persist, which is why they shouldn't be used much
[2014-03-24 23:31:36 -0400] Otterley: I've got an issue where I have multiple resources that notify another resource, but Chef crashes halfway through claiming the resource (that has already had notifications dispatched to it) doesn't exist!
[2014-03-24 23:31:57 -0400] supercom32: coderanger: do I need to delete the attribute from the server before defining it as a normal attribute? Or can I just change my definition in the attributes file to be normal instead?
[2014-03-24 23:32:42 -0400] coderanger: supercom32: Without seeing the code, I really can't say, but it still isn't clear to me what you are trying to do
[2014-03-24 23:32:57 -0400] coderanger: Otterley: Are you using use_inline_resource in an LWRPs?
[2014-03-24 23:33:15 -0400] Otterley: @coderanger, aye
[2014-03-24 23:33:49 -0400] coderanger: Otterley: So remember that inside the body of the provider methods you are in an isolated universe, you can't see out to the rest of the run and the rest of the run can't see in
[2014-03-24 23:34:57 -0400] Otterley: so here I've got two inline resources
[2014-03-24 23:35:18 -0400] Otterley: recipe -> inline resource A -> inline resource B -> service
[2014-03-24 23:35:18 -0400] supercom32: coderanger: I apologize in advance for being vague. I don't think I can share the whole recipe considering I don't know if I am authorized to.  But I do know what I am trying to accomplish. I need an attribute I can assign a default value to (If one does not exist), but never gets clobbered again unless I explicitly do an assignment in my code.
[2014-03-24 23:35:42 -0400] Otterley: inline resource B is notifying the service on modification
[2014-03-24 23:36:09 -0400] coderanger: supercom32: Okay, and why doesn't a standard default attribute set in an attrs file not work?
[2014-03-24 23:36:16 -0400] Otterley: correction: resource B is not an inline resource
[2014-03-24 23:36:48 -0400] supercom32: coderanger: Because (I assume) it always resets the same value in the file. Such that, if I ran another recipe that updates the version of the product, then running this recipe will just blindly clobber that attribute again.
[2014-03-24 23:36:49 -0400] Otterley: so: recipe -> inline resource A -> resource B -> service
[2014-03-24 23:37:29 -0400] coderanger: supercom32: Just make sure your cookbooks run in the right order via depends lines in the metadata
[2014-03-24 23:37:29 -0400] supercom32: coderanger: but if I don't define the attribute someplace, it won't exist to be queried. Unless I make a databag or something.
[2014-03-24 23:37:38 -0400] coderanger: supercom32: Chef does a topological sort before loading things
[2014-03-24 23:37:53 -0400] coderanger: Otterley: Okay
[2014-03-24 23:38:10 -0400] Otterley: I'm guessing that if I make inline A not inline, it should be fine?
[2014-03-24 23:38:27 -0400] supercom32: coderanger: If chef is running continuously, and I suddenly issue a knife command to change the version attribute, how will the order not clobber that change?
[2014-03-24 23:38:36 -0400] coderanger: Otterley: Hmm, can you pastebin the code thats erroring?
[2014-03-24 23:38:47 -0400] supercom32: coderanger: assuming the recipe is to install a new version if the version number has changed.
[2014-03-24 23:38:49 -0400] coderanger: supercom32: What knife command, you can't set default attrs with those
[2014-03-24 23:38:52 -0400] Otterley: coderanger, wish I could, it's proprietary
[2014-03-24 23:39:14 -0400] supercom32: coderanger: Ah, I was told  by someone that it was possible and was working under that assumption.
[2014-03-24 23:39:30 -0400] coderanger: Otterley: Hmm, if the -> means "invokes" then within the body of A the service resource should be visible, but not from the recipe
[2014-03-24 23:39:42 -0400] coderanger: supercom32: Nope, the only things you can set directly on a node are normal level attrs
[2014-03-24 23:39:55 -0400] coderanger: supercom32: since as mentioned before, everything else is wiped at the start of the cycle anyway
[2014-03-24 23:40:34 -0400] dgarstang: what does kitchen verify do/
[2014-03-24 23:40:42 -0400] supercom32: coderanger: Ok, so if I set a normal level attribute, normal['cognos_bi']['version'] = "1.10.20" in my attribute file, it will still clober each time right? So I need to use knife to define this attribute instead?
[2014-03-24 23:41:07 -0400] supercom32: It could be any product name to be honest.
[2014-03-24 23:41:25 -0400] coderanger: dgarstang: Runs any configured busser plugins
[2014-03-24 23:41:40 -0400] coderanger: supercom32: Yes, which is why no one does that :-)
[2014-03-24 23:42:00 -0400] coderanger: supercom32: Set the default value as a default, and then you can override it with a normal level attr if needed
[2014-03-24 23:43:13 -0400] dgarstang: coderanger: kk. gotta get there first. this Berksfile file disconnect thing...
[2014-03-24 23:47:54 -0400] supercom32: Perhaps this is a silly question, but do I set normal attributes by going... node.normal['product']['version'] = "10.2.5001.156" to an attribute that already exists on the node?
[2014-03-24 23:48:35 -0400] coderanger: supercom32: Usually node.set, but yes
[2014-03-24 23:50:35 -0400] supercom32: coderanger: Neat. Ok, so it seems everything works now and compiles. If you set a normal node attribute, will that attribute be updated on the server at the end of the recipes execution? Or at exactly when the statement to override is called?
[2014-03-24 23:51:03 -0400] coderanger: supercom32: It is only set on the server when node.save is called, which normally only happens at the end of a successful run
[2014-03-24 23:51:11 -0400] dgarstang: how do I change the hostname on a kitchen instance?
[2014-03-24 23:51:28 -0400] supercom32: coderanger: That explains it. Ok, thanks a lot for all your insight. You really did help out a lot. Cheers.
[2014-03-24 23:51:33 -0400] coderanger: supercom32: I would caution you that this is really not a good way to use chef, this kind of state management really belongs in a tool that matches your desired semantics
[2014-03-24 23:52:01 -0400] coderanger: supercom32: It will work, but Chef doesn't understand your data so it becomes a super-leaky abstraction most of the time
[2014-03-24 23:52:18 -0400] supercom32: coderanger: I will bring that up, but essentially I'm kind of stuck doing what I am told. :P
[2014-03-24 23:52:27 -0400] coderanger: supercom32: I figured, but just caveat emptor :)
[2014-03-24 23:53:16 -0400] supercom32: coderanger: Much appreciated. Hopefully I can talk some sense into the people who make this decision.
[2014-03-24 23:57:55 -0400] dgarstang: I'm failing to understand how vagrant and kitchen can live together. kitchen needs all cookbooks in the kitchen.yml file. However, in order to unit test the cookbook with vagrant, only that single cookbook should be in Berksfile
[2014-03-24 23:58:35 -0400] coderanger: dgarstang: See https://github.com/poise/berkshelf-api/ (or almost any other cookbook) for an example
