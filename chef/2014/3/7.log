[2014-03-07 00:48:14 -0500] werdnativ: Do you guys ever run "apt-get upgrade" on first-run only? Is there a good pattern for running things on first run only? I'm thinking a flag file like not_if { File.exist? '/var/chef_done' } or such.
[2014-03-07 00:49:40 -0500] werdnativ: Just wondering if there's a built-in flag for first-run in chef.
[2014-03-07 00:52:49 -0500] coderanger: werdnativ: No, that would be non-convergent
[2014-03-07 00:53:04 -0500] chip-: coderanger: I'm not VPN'ed in, so that's kinda strange, tbh.
[2014-03-07 00:53:05 -0500] coderanger: werdnativ: The default apt cookbook does have a setting to only sync every X seconds though
[2014-03-07 00:53:30 -0500] werdnativ: coderanger: I think that's just apt-get update, not installing.
[2014-03-07 00:53:53 -0500] coderanger: werdnativ: Oh, misread
[2014-03-07 00:54:42 -0500] werdnativ: I don't think I want to run unattended upgrades. Just talking about getting the latest patches installed on the initial run.
[2014-03-07 00:57:08 -0500] coderanger: chip-: lolrouters
[2014-03-07 01:11:31 -0500] spicy: what's the easiest / quickest way to download all the chef objects on the server as JSON? Trying the script on https://wiki.opscode.com/display/chef/Backing+Up+Chef+Server but get no output
[2014-03-07 01:11:55 -0500] coderanger: spicy: knife download /
[2014-03-07 01:15:32 -0500] spicy: coderanger: awesome, thanks!
[2014-03-07 01:16:00 -0500] coderanger: spicy: In general, don't use the Chef wiki
[2014-03-07 01:16:10 -0500] coderanger: It is long-abandoned
[2014-03-07 01:17:07 -0500] spicy: yeah i should have figured since it was still an opscode url :)
[2014-03-07 01:19:12 -0500] coderanger: spicy: Weeeeell thats not a good filter
[2014-03-07 01:19:20 -0500] coderanger: Almost nothing has been moved over to the new name
[2014-03-07 01:36:51 -0500] jtran: chef
[2014-03-07 01:37:40 -0500] nshbrown: chefalicious
[2014-03-07 01:37:52 -0500] nshbrown: ;D
[2014-03-07 01:38:00 -0500] jtran: nshbrown:  my bad.  :)
[2014-03-07 01:38:38 -0500] jtran: i have a weird problem.  if i do a gem_package "dynect4r"  and then after do a ruby_block "foo" do ;  block do ;  require "dynect4r" ; end ;end   when chef-client runs, it says it can't find dynect4r.   even tho gem list |grep dynect4r is def there on the local system
[2014-03-07 01:38:43 -0500] jtran: the exact err is  LoadError: cannot load such file -- dynect4r
[2014-03-07 01:39:38 -0500] nshbrown: yea, it's likely due to installing it via the chef-gems
[2014-03-07 01:39:53 -0500] nshbrown: chef gems has it's on chef library
[2014-03-07 01:40:53 -0500] chip-: jtran: instead of gem_package, use chef_gem. gem_package will use system ruby; gem_package will use Chef's own Ruby context, which is usually embedded with the client.
[2014-03-07 01:41:08 -0500] nshbrown: thx chip :D
[2014-03-07 01:43:06 -0500] jtran: ooh ok.  thx chip and nshbrown
[2014-03-07 01:43:16 -0500] nshbrown: np probs
[2014-03-07 01:44:38 -0500] chip-: nshbrown got there first. D'oh!
[2014-03-07 01:45:06 -0500] chip-: I typo'ed bad there too
[2014-03-07 03:36:46 -0500] makhan: hey
[2014-03-07 03:36:57 -0500] makhan: what's the correct way to override system path for a chef-run?
[2014-03-07 03:37:28 -0500] makhan: I'm using fnichol's RVM recipe and I have problems with paths to gems on my first chef run
[2014-03-07 03:38:28 -0500] coderanger: makhan: ENV['PATH'] = 'whatever
[2014-03-07 03:38:45 -0500] makhan: thanks, I'll try that
[2014-03-07 03:39:06 -0500] makhan: have tried execute "export PATH=whatever" but it didn't work
[2014-03-07 03:39:24 -0500] coderanger: Yeah, thats run in a subproc
[2014-03-07 03:39:32 -0500] coderanger: and a subproc can never affect its parent's env
[2014-03-07 03:40:28 -0500] makhan: can I use ENV['PATH']=/whatever:$PATH?
[2014-03-07 03:41:14 -0500] coderanger: No, this isn't Bash
[2014-03-07 03:41:29 -0500] coderanger: ENV['PATH'] = "/whatever:#{ENV['PATH']}"
[2014-03-07 03:41:32 -0500] makhan: ok
[2014-03-07 03:41:35 -0500] makhan: thx
[2014-03-07 03:41:57 -0500] makhan: been struggling with RVM + Nginx + Passenger for a while, quite frustrating
[2014-03-07 03:42:07 -0500] coderanger: Protip: stop using rvm on servers
[2014-03-07 03:42:28 -0500] makhan: what do you recommend instead?
[2014-03-07 03:42:32 -0500] makhan: just installing ruby from source?
[2014-03-07 03:42:43 -0500] coderanger: ruby-build if you must compile locally, otherwise omnibus your app or use poise-ruby
[2014-03-07 03:45:02 -0500] makhan: hmm
[2014-03-07 03:45:10 -0500] makhan: I need to look into omnibus, haven't heard about it
[2014-03-07 03:47:29 -0500] makhan: ruby-build uses rbenv, right?
[2014-03-07 03:47:36 -0500] makhan: isn't it just as cumbersome as rvm?
[2014-03-07 03:53:35 -0500] coderanger: No, other way around
[2014-03-07 03:53:48 -0500] coderanger: ruby-build can be used as an rbenv plugin, but you can also just use it solo
[2014-03-07 03:55:35 -0500] makhan: it looks good, I'll try to move my rvm based recipe to ruby-build in free time
[2014-03-07 03:56:32 -0500] makhan: I was actually looking into rvm alternatives before writing it but didn't find any good comparison of available options
[2014-03-07 03:56:54 -0500] makhan: next time I'll know to come here and ask
[2014-03-07 04:13:00 -0500] combusean: hey, is it possible to speed up chef zero deployments?  I've noticed that when using that with chef omnibus vagrant deploys to a local machine are very slow when it uploads cookbooks and has to wget chef.
[2014-03-07 04:15:43 -0500] coderanger: combusean: Which upload do you mean?
[2014-03-07 04:16:26 -0500] combusean: I'm using chef zero with vagrant and every time I run vagrant provision, it uploads all the cookbooks to the local chef server it creates.
[2014-03-07 04:16:33 -0500] combusean: Is this by chance a vagrant issue?
[2014-03-07 04:16:54 -0500] combusean: or, rather, an issue with the chef-zero plugin for vagrant?
[2014-03-07 04:17:05 -0500] coderanger: I don't know how that plugin works, but that seems very odd
[2014-03-07 04:17:18 -0500] coderanger: The whole point of chef-zero is to expose a simple folder as a chef server
[2014-03-07 04:17:46 -0500] combusean: I just checked your github, howdy fellow Bay Area resident :)
[2014-03-07 04:20:45 -0500] combusean: do you deploy chef locally on VMs?
[2014-03-07 04:21:40 -0500] combusean: the point of this exercise is to test chef installs locally before I start fucking up production using the same cookbooks and similar roles
[2014-03-07 05:20:22 -0500] zeknox: can anyone tell me what file I am suppose to define default_attributes() in? looking to bind redisio to localhost instead of the default *
[2014-03-07 05:23:42 -0500] slicknick: ehh uhh .. huh ?  i have a feeling this is a redis question, not a chef question ..
[2014-03-07 05:23:47 -0500] slicknick: you may be using chef to deploy / install configure a redis box ?
[2014-03-07 05:24:08 -0500] zeknox: just want to know where i define default_attributes, is that in the node or role?
[2014-03-07 05:24:34 -0500] slicknick: oh
[2014-03-07 05:24:49 -0500] slicknick: easy way to find out
[2014-03-07 05:24:58 -0500] slicknick: knife node edit <name of box>
[2014-03-07 05:25:03 -0500] slicknick: knife client edit <name of box>
[2014-03-07 05:25:58 -0500] slicknick: o_O its a role!
[2014-03-07 05:26:01 -0500] slicknick: http://docs.opscode.com/knife_role.html
[2014-03-07 05:26:37 -0500] slicknick: you were right. good on ya!
[2014-03-07 05:30:59 -0500] zeknox: slicknick: thanks man, didn't know i could simply create a role with knife
[2014-03-07 05:34:56 -0500] slicknick: no doubt
[2014-03-07 05:36:44 -0500] zeknox: slicknick: i still dont understand how the examples given here are not in json format, do they still go in the role?  https://github.com/brianbianco/redisio/
[2014-03-07 05:41:47 -0500] gleam: yes but reformat them as json, basically. or make a role named role.rb and upload it with knife (it'll convert it to json)
[2014-03-07 05:49:14 -0500] _sp0k_: hello! i have a git resource defined, for which i am keep switching different tags. If i am reverting to one of the previous used tags, does Chef checkout entire code or it will know i had it checked out earlier and will not do an entire new git pull?
[2014-03-07 05:56:11 -0500] slicknick: _sp0k_: its not chef that decides, its the git command triggered by chef
[2014-03-07 05:57:10 -0500] slicknick: need more detail about the flow process moving accessing schtuffs
[2014-03-07 06:00:52 -0500] _sp0k_: slicknick: thanks, i was wondering if it does remove local checkout before pulling the new one, will check it out separately
[2014-03-07 06:37:48 -0500] brucelee: coderanger: packer is sweet!
[2014-03-07 06:37:52 -0500] brucelee: thanks for that
[2014-03-07 10:59:19 -0500] lewiz: With service can I prevent Chef from bombing out when a service fails to start?  e.g. like 'returns' for the execute provider?
[2014-03-07 11:01:30 -0500] PotatLives: Does someone has a problem that when using the java recipe openjdk, it gives that the verwsion [java-1.6.0-openjdk] is not being found ? im running this on a fedora 17 version. if i do "yum install java-1.6.0-openjdk" it doesnt find the package, but the 1.7.0 it finds. does someone knows how to resolve this ?
[2014-03-07 11:07:11 -0500] maxkazar: Hey everyone
[2014-03-07 11:08:26 -0500] maxkazar: I need to setup ubuntu environment variables. How sould i to do this?
[2014-03-07 11:12:05 -0500] ziro`: Hi, I'm trying to use chef-solo on a vm, but for some reason after running the start handlers, i get a recipe compilation error relating to "Homebrew"
[2014-03-07 11:12:39 -0500] ziro`: the vm is ubuntu precise
[2014-03-07 11:12:49 -0500] ziro`: my host is os x, and i'm using homebrew
[2014-03-07 11:13:28 -0500] ziro`: but I have no idea why it'd be trying to compile some homebrew package on my guest
[2014-03-07 11:15:57 -0500] daxroc1: Is there a chef way to get the md5 of a localfile ?
[2014-03-07 12:18:30 -0500] juliancdunn: PotatLives: the default Java version that cookbook will try to install, on all platforms, is 6
[2014-03-07 12:18:49 -0500] juliancdunn: set the attribute ['java']['jdk_version'] to 7 if your platform only gives you 7
[2014-03-07 13:18:02 -0500] mhenrixon: wtf does ohai do? I just don't get that i mean I sort of know but I don't fully grasp what it is and how I can use it to my advantage?
[2014-03-07 13:22:50 -0500] _sp0k_: daxroc1: you can try Mixlib::ShellOut.new("/usr/bin/md5sum file_path").stdout.strip in your cookbook
[2014-03-07 14:19:03 -0500] daxroc1: _sp0k_that's platform dependent, I ended up using a ruby block works like a charm
[2014-03-07 14:19:59 -0500] daxroc1: Thinking it could be a useful lwrp
[2014-03-07 14:21:41 -0500] srenatus: daxroc1: you could "file '/root/md5of_blah' do content Digest::MD5.hexdigest(File.read('/root/blah')) end", or something similar
[2014-03-07 14:22:13 -0500] daxroc1: eek, eats ram
[2014-03-07 14:22:14 -0500] srenatus: if /root/blah doesn't exist in compile-time, just put a lazy { ... }  around it
[2014-03-07 14:23:04 -0500] daxroc1: srenatus: I did some thing simialr in a ruby block but read the file by chunks
[2014-03-07 14:23:16 -0500] daxroc1: https://gist.github.com/daxroc/9410375
[2014-03-07 14:23:56 -0500] srenatus: daxroc1: that's nice.
[2014-03-07 14:26:25 -0500] maniac1: hello guys  i have a question regarding lwrp  i've tried to write my own lwrp but i received an error that resourse don't declared anywhere  then i tried to write the simpliest one  and i've faced same problem  here is the code :
[2014-03-07 14:26:26 -0500] maniac1: recipe default.rb:
[2014-03-07 14:26:27 -0500] maniac1: test_lwrp "test"
[2014-03-07 14:26:28 -0500] maniac1: resource test_lwrp.rb:
[2014-03-07 14:26:28 -0500] maniac1: actions :create
[2014-03-07 14:26:28 -0500] maniac1: default_action :create
[2014-03-07 14:26:29 -0500] maniac1: attribute :filename, :kind_of => String, :name_attribute => true
[2014-03-07 14:26:29 -0500] maniac1: provider test_lwrp.rb:
[2014-03-07 14:26:30 -0500] maniac1: action :create do
[2014-03-07 14:26:31 -0500] maniac1: File.open("{@new_resource.name}", "w") { |file| file.write("someinfo") }
[2014-03-07 14:26:31 -0500] maniac1: end
[2014-03-07 14:26:32 -0500] maniac1: Output:
[2014-03-07 14:26:33 -0500] maniac1: [2014-03-07T15:07:05+01:00] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out
[2014-03-07 14:26:34 -0500] maniac1: Chef Client failed. 1 resources would have been updated
[2014-03-07 14:26:34 -0500] maniac1: [2014-03-07T15:07:05+01:00] ERROR: Cannot find a resource for test_lwrp on centos version 6.3
[2014-03-07 14:26:35 -0500] maniac1: [2014-03-07T15:07:05+01:00] FATAL: Chef::Exceptions::ChildConvergeError: Chef run process exited unsuccessfully (exit code 1)
[2014-03-07 14:33:47 -0500] srenatus: maniac1: please don't paste into the channel but use some pastebin service next time.... that said, is your cookbook called 'test' and your lwrp called 'lwrp'?
[2014-03-07 14:34:04 -0500] srenatus: maniac1: or the cookbook named 'test-lwrp' and the lwrp 'default'?
[2014-03-07 14:34:56 -0500] maniac1: srenatus, sorry for that  cookbook named base, and lwrp file named lwrp_test.rb
[2014-03-07 14:35:33 -0500] srenatus: then the resource is called base_lwrp_test
[2014-03-07 14:37:51 -0500] maniac1: thank you  i should have looked in the github repository for that =(
[2014-03-07 14:38:02 -0500] maniac1: it is clearly shown how it tries to load it
[2014-03-07 14:39:08 -0500] srenatus: :)
[2014-03-07 15:13:45 -0500] shlant: can anyone tell me why this mini test passes even though it shouldn't? https://gist.github.com/MrMMorris/651efd262b856e697805
[2014-03-07 15:13:54 -0500] shlant: fuck what's the point of tests if I can't trust them
[2014-03-07 15:14:18 -0500] shlant: this is hte output of ps: user     32199 32094  0 10:12 pts/0    00:00:00 grep --color=auto scribe
[2014-03-07 15:17:05 -0500] adnichols: your grep is showing up in the ps I'd guess
[2014-03-07 15:18:14 -0500] shlant: adnichols: the test is looking for the output to be '/usr/bin/scribed -c /etc/scribe/scribe.conf'
[2014-03-07 15:18:55 -0500] adnichols: shanlar: ok - no idea then, I don't use minitest
[2014-03-07 15:22:10 -0500] tscanausa: is there a way to notify a service in another recipe?
[2014-03-07 15:24:56 -0500] shlant: tscanausa: does notifies not work?
[2014-03-07 15:26:32 -0500] sanguisdex: I just migrated a node from one opscode acount to another and now when I try to run chef-client I am getting a 403 error when trying to compile the mysql::server cookbook its fails when trying to to run node.save
[2014-03-07 15:26:46 -0500] sanguisdex: where should I look ti fix this?
[2014-03-07 15:27:53 -0500] tscanausa: shlant: my mistake, pebkac error
[2014-03-07 15:33:26 -0500] tscanausa: sanguisdex: it seems like the client is not authorized.
[2014-03-07 15:34:45 -0500] sanguisdex: tscanausa: so to do with my client.pem?
[2014-03-07 15:35:29 -0500] tscanausa: probably the wrong one, or when I migrated chef servers I had the issues where the chef client refused to pick up the new pem file
[2014-03-07 15:46:28 -0500] lewiz: Is there any way to update a data bag from a recipe without being an admin client?
[2014-03-07 15:56:53 -0500] PotatLives: hi guys
[2014-03-07 15:56:59 -0500] sanguisdex: tscanausa:
[2014-03-07 15:57:10 -0500] PotatLives: do you encountered problems on running jenkins that will run something that needs directfb ?
[2014-03-07 15:57:22 -0500] sanguisdex: tscanausa: would a bad pem stop any communication (such as downlaoding the assigned runlists ecta
[2014-03-07 15:57:25 -0500] PotatLives: its giving me an error like ""X11: Error in XOpenDisplay for '(null)'
[2014-03-07 16:01:38 -0500] tscanausa: sanguisdex: yes
[2014-03-07 16:04:54 -0500] sanguisdex: tscanausa: that rules that out, it seems to be a permission related directally to node.save within the mysql cookbook
[2014-03-07 16:05:52 -0500] pcn: So does anyone here use chef-vsphere?
[2014-03-07 16:06:13 -0500] tscanausa: where does chef-server store its copy of cookbooks?
[2014-03-07 16:08:39 -0500] mattray: tscanausa: local filesystem behind an S3-api
[2014-03-07 16:08:40 -0500] mattray: tscanausa: Hosted on S3
[2014-03-07 16:08:45 -0500] benmoss: anyone used knife solo with test kitchen?
[2014-03-07 16:09:40 -0500] tscanausa: mattray: that assumes I use chef enterprise?
[2014-03-07 16:10:03 -0500] mattray: tscanausa: enterprise and open source use the same code for cookbook storage
[2014-03-07 16:10:10 -0500] ddr_: hi all. Can anyone say, in chef mysql cookbook can I use percona? or chef guys completely remove percona from cookbook?
[2014-03-07 16:10:39 -0500] mattray: tscanausa: https://github.com/opscode/bookshelf
[2014-03-07 16:11:23 -0500] tscanausa: mattray: that does not exactly answer the question
[2014-03-07 16:12:20 -0500] mattray: tscanausa: sorry, I must have misunderstood it then
[2014-03-07 16:12:48 -0500] mattray: the Chef server stores cookbooks on your local filesystem and serves them up behind an S3-like API
[2014-03-07 16:13:39 -0500] tscanausa: So which directory are the cookbook files located on the open source chef server?
[2014-03-07 16:17:30 -0500] mattray: tscanausa: /var/opt/chef-server/bookshelf
[2014-03-07 16:17:56 -0500] mattray: look at /etc/chef-server/chef-server-running.json to see all the current settings
[2014-03-07 16:19:38 -0500] mattray: they're not just sitting there exploded though
[2014-03-07 16:20:10 -0500] tscanausa: haha, i see that thanks mattray
[2014-03-07 16:20:53 -0500] mattray: more about the architecture here: http://docs.opscode.com/server_components.html
[2014-03-07 16:21:46 -0500] gswallow: Anyone here using the graphite cookbook?  Does it even *work*?
[2014-03-07 16:22:09 -0500] pcn: gswallow: I've used it in the past.  What are you seeing?
[2014-03-07 16:22:17 -0500] gswallow: nothing works.
[2014-03-07 16:22:35 -0500] gswallow: tries to install 0.9.12, which from what I know doesn't support mod_python and apache
[2014-03-07 16:22:41 -0500] gswallow: uwsgi doesn't work
[2014-03-07 16:22:45 -0500] gswallow: nginx doesn't work.
[2014-03-07 16:22:48 -0500] gswallow: init scripts don't work
[2014-03-07 16:23:08 -0500] gswallow: doesn't install the right version of django from what I can see
[2014-03-07 16:23:23 -0500] gswallow: maybe I should roll back to graphite 0.9.10?
[2014-03-07 16:23:53 -0500] pcn: As long as your graphite isn't exposed, that should mostly work
[2014-03-07 16:24:05 -0500] pcn: The bug fix in 0.9.11-0.9.12 is pretty important.
[2014-03-07 16:24:12 -0500] pcn: But it does sound like the cookbook needs updating
[2014-03-07 16:24:23 -0500] pcn: I last used it at 0.9.9 or 0.9.10
[2014-03-07 16:24:30 -0500] gswallow: bash through it I guess.  So did I :)
[2014-03-07 16:43:28 -0500] benmoss: anyone know why a library file isn't getting loaded?
[2014-03-07 16:44:07 -0500] benmoss: the apt cookbook is blowing up for me with No resource or method named `apt_installed?' for `Chef::Recipe "default"'
[2014-03-07 16:44:19 -0500] benmoss: which is defined in its' libraries/helpers.rb
[2014-03-07 16:44:24 -0500] benmoss: so bizarre
[2014-03-07 16:46:40 -0500] mstyne: hi folks
[2014-03-07 16:46:56 -0500] btm: benmoss: chef-solo?
[2014-03-07 16:47:09 -0500] benmoss: yeah, actually through test-kitchen
[2014-03-07 16:47:20 -0500] mstyne: does anyone happen to know if the 'supports' directive in metadata.rb actually /does/ anything
[2014-03-07 16:47:25 -0500] mstyne: or is it purely informational
[2014-03-07 16:47:50 -0500] peret: hello
[2014-03-07 16:47:51 -0500] mstyne: i.e., will it spit out an error if the cookbook's recipes are attempted to be run on an 'unsupported' platform
[2014-03-07 16:47:51 -0500] btm: benmoss: is there another recipe that uses the apt cookbook? does the cookbook that recipe is in depend on the apt cookbook?
[2014-03-07 16:48:11 -0500] benmoss: i have a site-cookbook that depends on a vendored cookbook that depends on apt
[2014-03-07 16:49:31 -0500] btm: benmoss: what version of chef?
[2014-03-07 16:49:49 -0500] benmoss: 11.10.4
[2014-03-07 16:51:00 -0500] benmoss: mstyne: if this is still correct "supports" is not enforced by chef itself http://b.ns.hjksolutions.com/sympa/arc/chef/2013-09/msg00388.html
[2014-03-07 16:52:35 -0500] mstyne: rats
[2014-03-07 16:52:42 -0500] mstyne: benmoss: ty
[2014-03-07 16:53:00 -0500] mstyne: I have a rats nest of if statements I'd like to dispose of
[2014-03-07 16:53:03 -0500] mstyne: :)
[2014-03-07 16:53:18 -0500] btm: benmoss: I'd triple-check that those first two cookbooks have "depends" in the metadata. If that doesn't work, I would need a gist of the 'chef-solo -l debug' output to help further.
[2014-03-07 16:53:29 -0500] benmoss: btm: ok, ill check, thanks
[2014-03-07 16:53:56 -0500] btm: mstyne: yeah supports is a noop https://tickets.opscode.com/browse/CHEF-3871
[2014-03-07 16:54:34 -0500] mstyne: however the link benmoss provided points to jtimberman's enforce_supported_platform-cookbook
[2014-03-07 16:54:43 -0500] mstyne: which might be a bit nicer than what I'm doing presently
[2014-03-07 16:54:46 -0500] mstyne: cleaner, anyway
[2014-03-07 16:55:15 -0500] benmoss: btm: my cookbook shouldn't need a "depends" on apt, right? just on the nodejs cookbook, which has it on apt?
[2014-03-07 17:01:11 -0500] benmoss: btm: https://gist.github.com/benmoss/9415305
[2014-03-07 17:01:48 -0500] benmoss: so on line 308 it says it is loading apt/libraries/helpers.rb
[2014-03-07 17:03:23 -0500] mstyne: ah but that only handles platforms, not platform versions
[2014-03-07 17:03:24 -0500] mstyne: oh well
[2014-03-07 17:03:33 -0500] mstyne: horns.aiff
[2014-03-07 17:03:58 -0500] benmoss: whoops that was actually the wrong stack trace, tried adding "depends 'apt'" to my own metadata to see if it would fix it
[2014-03-07 17:04:43 -0500] benmoss: https://gist.github.com/benmoss/9415363
[2014-03-07 17:05:04 -0500] benmoss: interesting, yeah now it no longer says loading helpers.rb
[2014-03-07 17:06:27 -0500] benmoss: i spotted my error :(
[2014-03-07 17:06:53 -0500] benmoss: forgot a depends.
[2014-03-07 17:06:59 -0500] benmoss: thanks anyway :)
[2014-03-07 17:33:49 -0500] chef299: hi
[2014-03-07 17:34:10 -0500] chef299: is their recipe to deploy the war file to jboss server
[2014-03-07 17:49:26 -0500] therealkoopa: Any idea why I would have 12 chef-clients running if I'm using knife ec and the chef client cookbook defaults?
[2014-03-07 17:56:11 -0500] Majost: What is the preferred way to do things when subclassing a Chef resource.... do it as a heavyweight cookbook library, or write it as a LWRP?
[2014-03-07 18:16:00 -0500] coderanger: Majost: You can't do it as an LWRP
[2014-03-07 18:16:20 -0500] coderanger: Majost: Because of how the DSL works, you can't control inheritance
[2014-03-07 18:17:33 -0500] Majost: ah
[2014-03-07 18:18:19 -0500] jbellone_: hullo
[2014-03-07 18:19:22 -0500] techminer:  ohai network/interfaces/eth0/routes returns an array of hashes..how do I find if that array includes an element who's destination is "default"?
[2014-03-07 18:22:10 -0500] coderanger: techminer: .find{|route| route['destination'] == 'default'}
[2014-03-07 19:19:27 -0500] werdnativ: I'm putting RAILS_ENV=development into /etc/profile.d/rails.sh and it shows up in the env when I log in, but test-kitchen/serverspec doesn't sees "" for stdout of command 'printenv RAILS_ENV'
[2014-03-07 19:19:46 -0500] werdnativ: * sees, not doesn't sees
[2014-03-07 19:22:18 -0500] coderanger: werdnativ: thats because those files only affect interactive logins
[2014-03-07 19:23:29 -0500] werdnativ: ah. That makes sense I guess.
[2014-03-07 19:24:41 -0500] werdnativ: I thought of putting it in /etc/environment but there are no separate environment.d files to keep things modular, I wonder if it's wise to add environment.d to mirror profile.d
[2014-03-07 19:25:15 -0500] werdnativ: (by mirror, I mean do the same pattern, not symlink)
[2014-03-07 19:29:24 -0500] werdnativ: probably unwise: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=704054
[2014-03-07 19:31:21 -0500] surge_: How would I rename an environment without breaking the node associations ?
[2014-03-07 19:34:29 -0500] tvanhens: anyone having trouble uploading to their chef hosted server?
[2014-03-07 19:36:17 -0500] sako: hey guys do the actions for services default to true or false if not specified?
[2014-03-07 19:36:21 -0500] sako: i.e. reload
[2014-03-07 19:37:30 -0500] werdnativ: sako: the default action is :nothing http://docs.opscode.com/resource_service.html
[2014-03-07 19:37:31 -0500] sako: oh nvm it was lower on the page
[2014-03-07 19:37:41 -0500] sako: sorry i was there.. i should learn to read ahead lol
[2014-03-07 19:38:17 -0500] sako: according to the docs: Default value: { :restart => false, :reload => false, :status => false }
[2014-03-07 19:55:04 -0500] werdnativ: I assume I don't need to define default[:parent] ||= {} somewhere before setting default[:parent][:child] = "value" on it?
[2014-03-07 19:57:26 -0500] chris613: Is there a more efficient way to get a resource object I'm interested in from the collection other than doing run_context.resource_collection.each do |r|  and a conditional to looking for what I need? for example is there something like run_context.resource_collection.find(:type => "template", :name => "foo") ?
[2014-03-07 20:01:13 -0500] werdnativ: chris613: is it ruby's Enumerable find or something else defined by resource_collection?
[2014-03-07 20:01:46 -0500] coderanger: chris613: resources('template[foo]')
[2014-03-07 20:01:56 -0500] chris613: werdnativ: It's defined by ResourceCollection and depends on find_resource_by_string or find_resource_by_hash whose source I am now reading
[2014-03-07 20:02:00 -0500] werdnativ: I was going to say .find { |item| item.type == 'template' && item.name == 'foo' } would work for anything in ruby.
[2014-03-07 20:02:04 -0500] chris613: coderanger: Even better! thanks!
[2014-03-07 20:02:17 -0500] werdnativ: but that's much better, yeah.
[2014-03-07 20:02:25 -0500] coderanger: chris613: Thats assuming you are in a recipe context anyway
[2014-03-07 20:03:47 -0500] thun_: This is sort of a newb question but if I am using a cookbook like Nagios and I want to change one of the templates, how do I this in another recipe without modifying the original nagios cookbook?
[2014-03-07 20:04:01 -0500] chris613: thun_: I use chef-rewind for that
[2014-03-07 20:04:34 -0500] chris613: https://github.com/bryanwb/chef-rewind  and override the "cookbook" resource attribute to mention your cookbook instead of the original. Then simply supply the necesarry .erb in your cookbook
[2014-03-07 20:06:00 -0500] thun_: Ty... thats the simplest way?
[2014-03-07 20:06:08 -0500] chris613: simplest way I know of
[2014-03-07 20:06:41 -0500] coderanger: Yeah
[2014-03-07 20:06:55 -0500] coderanger: The alternative is to submit a patch to the upstream cookbook to make things more configurable
[2014-03-07 20:07:11 -0500] coderanger: but that has rapidly diminishing returns
[2014-03-07 20:13:17 -0500] surge_: chef-rewind FTW
[2014-03-07 20:13:57 -0500] thun_: Ok thanks guys
[2014-03-07 20:39:15 -0500] schlazor: can I make public methods in a lightweight provider that another lightweight provider can use?
[2014-03-07 20:43:34 -0500] jeffcara_: accidentally deleted my client key for a node off the chef-server. Is there  a command to regenerate a keypair for the node without having to blow away and reinstall everything?
[2014-03-07 20:43:52 -0500] jeffcara_: or am I S.O.L on that
[2014-03-07 20:47:43 -0500] btm: jeffcara_: did you delete /etc/chef/client.pem on the node, or knife client delete NODE against the server?
[2014-03-07 20:48:24 -0500] jeffcara_: against the server.
[2014-03-07 20:48:42 -0500] jeffcara_: had two nodes named too similarly and deleted the wrong one accidentally;
[2014-03-07 20:54:25 -0500] coderanger: schlazor: Not sure what you mean
[2014-03-07 20:55:13 -0500] coderanger: jeffcara_: Either generate a new client key via knife yourself, or just delete client.pem on the node and let it reregister (the latter won't work on hosted chef)
[2014-03-07 20:56:00 -0500] schlazor: coderanger: i'm writing some lightweight providers each of which has some test methods in them and in one case i want to utilize one of those tests in another provider but despite placing the method definition prior to the private methods it doesn't seem to work.
[2014-03-07 20:56:07 -0500] jeffcara_: coderanger: okay, i'll give it a whirl. Thanks
[2014-03-07 20:56:22 -0500] coderanger: schlazor: Make a module in lib file and include it in both
[2014-03-07 20:56:39 -0500] coderanger: schlazor: Or make a real class and inherit (but you can't use LWRPs then, need to make real class-based resources)
[2014-03-07 20:56:55 -0500] schlazor: coderanger: okay thanks!
[2014-03-07 20:57:57 -0500] shlant: anyone know how to rename/move a file?
[2014-03-07 20:58:13 -0500] shlant: or I guess that's not idenpotent...
[2014-03-07 20:58:23 -0500] coderanger: shlant: execute resource
[2014-03-07 20:58:42 -0500] coderanger: But yeah, the better way is to just write the new content out with chef entirely
[2014-03-07 20:59:08 -0500] shlant: coderanger: actually, just realize the file is replaced anyays
[2014-03-07 20:59:11 -0500] thess: Has anyone run into an issue with powershell_script where it constantly returns 1, even though the generated .ps1 , when run separately, returns 0?
[2014-03-07 20:59:11 -0500] shlant: maybe i'll just delete
[2014-03-07 21:00:17 -0500] shlant: coderanger: what exactly doe the backup attribute on the file resource do?
[2014-03-07 21:00:55 -0500] coderanger: shlant: Controls how many copies are kept in a backup folder in /var/chef
[2014-03-07 21:01:13 -0500] coderanger: shlant: Its supposed to be in case you overwrite an important file, but really its a misfeature of chef and should be removed
[2014-03-07 21:01:49 -0500] shlant: ah
[2014-03-07 21:03:36 -0500] kitopastorino: I'm using chef-ruby_build to install ruby 2.1.1 in /usr/local, and the application_ruby cookbook to prepare an app for deploy. I can't get the application_ruby to use ruby 2.1.1, for some reason it keeps using 1.9, which I guess is what's chef is using
[2014-03-07 21:03:39 -0500] kitopastorino: any idea why?
[2014-03-07 21:04:12 -0500] kitopastorino: PATH includes /usr/local/bin
[2014-03-07 21:15:45 -0500] unicron_: kitopastorino, think the app cookbooks need a bit of TLC - I struggled with it seemingly switching between embedded and system ruby
[2014-03-07 21:16:07 -0500] unicron_: I ended up just using the deploy resource (which i think the application cookbooks wrap)
[2014-03-07 21:24:34 -0500] kitopastorino: unicron_: just fixed it, i've missed the "gems ['bundler']" directive
[2014-03-07 21:29:45 -0500] coderanger: unicron_: More than a "bit"
[2014-03-07 21:29:54 -0500] coderanger: unicron_: Don't use the deploy resource either
[2014-03-07 21:32:05 -0500] euph: is there a resource to copy an entire directory to a node similar to cookbook_file?
[2014-03-07 21:32:14 -0500] coderanger: euph: remote_directory
[2014-03-07 21:32:37 -0500] euph: i thought that will just create the directory
[2014-03-07 21:32:44 -0500] coderanger: No, thats directory
[2014-03-07 21:32:54 -0500] coderanger: remote_directory is a recursive version of cookbook_file
[2014-03-07 21:33:05 -0500] euph: ahh..then i read the docs wrong.  thanks
[2014-03-07 21:33:15 -0500] kitopastorino: coderanger: if not using application_ruby nor deploy, what should be used?
[2014-03-07 21:33:36 -0500] coderanger: kitopastorino: Just use a git resource directly, the cap-style folder layout is a trap
[2014-03-07 21:33:59 -0500] coderanger: Also don't run your migrations from Chef, thats not a task Chef can do safely in anything but a toy app
[2014-03-07 21:34:30 -0500] coderanger: (and if it is a toy app, an execute resource is fine for migrations)
[2014-03-07 21:34:33 -0500] kitopastorino: The thing is I'm using cap for deploying later. But no, I'm not running migrations from chef
[2014-03-07 21:34:44 -0500] dgarstang: Anyone using ssl certs? Are you using ssl-cookbook or chef-ssl-certificates?
[2014-03-07 21:34:45 -0500] coderanger: deploying later?
[2014-03-07 21:34:59 -0500] coderanger: dgarstang: You asked the same question yesterday, please go read what I mentioned
[2014-03-07 21:35:03 -0500] kitopastorino: I mean, after the initial deploy
[2014-03-07 21:35:09 -0500] coderanger: kitopastorino: Don't do that :)
[2014-03-07 21:35:09 -0500] kitopastorino: any new features, etc
[2014-03-07 21:35:17 -0500] kitopastorino: oops, why?
[2014-03-07 21:35:19 -0500] coderanger: kitopastorino: Whatever you use once, use always
[2014-03-07 21:35:30 -0500] coderanger: kitopastorino: The deploy resource is not directly compatible with cap anyway
[2014-03-07 21:35:33 -0500] coderanger: It just "close"
[2014-03-07 21:36:07 -0500] dgarstang: coderanger: and I believe I responded to that.
[2014-03-07 21:36:09 -0500] kitopastorino: really? and is chef OK for doing deployments?
[2014-03-07 21:36:14 -0500] coderanger: dgarstang: Yes with "I give up"
[2014-03-07 21:36:25 -0500] coderanger: kitopastorino: Thats how I do it, but I also don't deploy from git :)
[2014-03-07 21:36:34 -0500] dgarstang: coderanger: prior to that, i asked ... wasn't citadel a cert issuer?
[2014-03-07 21:36:52 -0500] coderanger: dgarstang: No, its a secrets management cookbook
[2014-03-07 21:36:56 -0500] kitopastorino: ha, thanks for the info
[2014-03-07 21:36:59 -0500] coderanger: dgarstang: The readme explains what it does
[2014-03-07 21:37:22 -0500] coderanger: kitopastorino: If you want to deploy with cap though, thats fine, just don't do it in chef once and then cap later
[2014-03-07 21:37:40 -0500] dgarstang: googling 'chef citadel ssl' doens't seem to get me very far
[2014-03-07 21:38:01 -0500] coderanger: dgarstang: It has nothing to do with SSL, so not surprising
[2014-03-07 21:38:10 -0500] coderanger: https://github.com/balanced-cookbooks/citadel
[2014-03-07 21:38:22 -0500] kitopastorino: OK, so just set up the users and the server, no directory structure, and then create directories and deploy via cap?
[2014-03-07 21:38:38 -0500] dgarstang: coderanger: ok thanks but that's slightly off context
[2014-03-07 21:38:58 -0500] coderanger: kitopastorino: Thats certainly one way to do it, not what I would recommend but it will totally work
[2014-03-07 21:39:21 -0500] kitopastorino: would love to hear your recommendations though!
[2014-03-07 21:39:53 -0500] coderanger: kitopastorino: omnibus builds for your app so it compiles to a single deb/rpm, and then depot to put it in an apt repo
[2014-03-07 21:40:03 -0500] coderanger: kitopastorino: So deploys are just a package install (managed via chef)
[2014-03-07 21:40:17 -0500] coderanger: kitopastorino: Its definitely a complex thing to setup though, might be overkill :)
[2014-03-07 21:40:29 -0500] coderanger: dgarstang: If you say so
[2014-03-07 21:40:48 -0500] dgarstang: coderanger: use of citadel would assume I had the ssl cookbook working first I would think
[2014-03-07 21:40:57 -0500] coderanger: dgarstang: No, it wouldn't
[2014-03-07 21:41:03 -0500] kitopastorino: Nice! but's probably overkill, we're still small... and how would that work with code updates? a new omnibus for each update?
[2014-03-07 21:41:13 -0500] coderanger: dgarstang: You might notice that I'm not usually wrong when I tell people what to do
[2014-03-07 21:41:23 -0500] coderanger: kitopastorino: Yeah, we have jenkins kick of a new package build for each new git tag
[2014-03-07 21:41:35 -0500] kitopastorino: aha, interesting
[2014-03-07 21:41:47 -0500] dgarstang: coderanger: well i'm not following.
[2014-03-07 21:42:17 -0500] coderanger: dgarstang: Put secret data in S3, use citadel + a file resource to write it to disk, thats it
[2014-03-07 21:43:06 -0500] dgarstang: coderanger: Sure. 'secret data' needs to be in a format when it comes out that the ssl cookbook can deal with
[2014-03-07 21:43:12 -0500] coderanger: kitopastorino: There are a lot of permutations but at heart its all about slug-based deploy, just have to pick what flavor of slug you build (debian package, AMI, docker image, etc)
[2014-03-07 21:43:47 -0500] coderanger: dgarstang: no, this is _instead of_ the ssl cookbook
[2014-03-07 21:44:14 -0500] coderanger: dgarstang: The ssl cookbook uses encrypted data bags for secrets management, which is a bad idea
[2014-03-07 21:44:19 -0500] dgarstang: coderanger: you said citadel had nothing to do with ssl, so one could be excused for being a little confused at this point I would think
[2014-03-07 21:44:41 -0500] coderanger: dgarstang: SSL isn't a special problem, you just want to write some secret info to disk in a specific place
[2014-03-07 21:44:53 -0500] unicron_: coderanger, I've been thinking of going down the package route with FPM - would like to know what you mean by 'trap' in the directory structure?
[2014-03-07 21:45:12 -0500] coderanger: unicron_: The symlinks break things more often than they help
[2014-03-07 21:45:15 -0500] dgarstang: coderanger: We may be talking about different things. I am talkng about ssl certs for apache, most commonly implemented with the chef-ssl-certificates cookbook
[2014-03-07 21:45:24 -0500] unicron_: I'm two days into a cookbook creation so if I'm gonna turn back - it's gotta be now )
[2014-03-07 21:45:45 -0500] coderanger: unicron_: When you have an effective binary transport already, you don't need to have any weird magic with current -> whatever
[2014-03-07 21:45:59 -0500] coderanger: dgarstang: Most commonly perhaps, but not correctly
[2014-03-07 21:46:06 -0500] coderanger: dgarstang: citadel is a different way to do it
[2014-03-07 21:46:14 -0500] coderanger: dgarstang: As you asked what people used, I told you
[2014-03-07 21:46:35 -0500] coderanger: unicron_: Also the callback structure in the deploy resource is Really Broken
[2014-03-07 21:46:46 -0500] coderanger: unicron_: It runs each callback in a weirdly isolated run context
[2014-03-07 21:47:59 -0500] unicron_: coderanger, yeah - i've found that with the before migrate and symlink before migrate - there is no way to tell those two "before _mirgate" options what order to run in AFAIK
[2014-03-07 21:48:25 -0500] coderanger: unicron_: I'll make something better eventually, just haven't had the cycles
[2014-03-07 21:48:51 -0500] coderanger: The application* cookbooks were my first attempt at a lot of cookbook reusability patterns that I've advanced a lot since then
[2014-03-07 21:49:33 -0500] unicron_: coderanger, figuring out how they worked helped me figure a lot of internal chef stuff out :)
[2014-03-07 21:49:47 -0500] coderanger: unicron_: Ditto :-)
[2014-03-07 21:50:19 -0500] coderanger: unicron_: If you want to see much better versions of the same patterns, look at the poise cookbook and related work I've done over the past ~6 months
[2014-03-07 21:50:51 -0500] unicron_: Codemonkey, cool - I'll check them out - thanks for the heads up
[2014-03-07 22:14:16 -0500] dgarstang: coderanger: I assume citadel needs a specific IAM user?
[2014-03-07 22:14:28 -0500] coderanger: dgarstang: No, it uses roles
[2014-03-07 22:14:46 -0500] dgarstang: k
[2014-03-07 22:15:52 -0500] dgarstang: coderanger:'AWS Service Roles', 'Role for Cross-Account Access' or 'Role for Identity Provider Access'?
[2014-03-07 22:16:10 -0500] coderanger: AWS Service Roles
[2014-03-07 22:16:43 -0500] dgarstang: and 'Amazon EC2' below that I assume
[2014-03-07 22:17:05 -0500] cheeseprocedure: wow. i was just about to write a cookbook to accomplish exactly what citadel does. nice.
[2014-03-07 22:17:13 -0500] coderanger: dgarstang: Yes, though thats not actually part of the API, just weird UI
[2014-03-07 22:17:26 -0500] coderanger: dgarstang: Just like the other things you mentioned aren't actually called Roles internally
[2014-03-07 22:17:54 -0500] coderanger: IAM is both very powerful, and probably AWS' most poorly documented/UX'd system
[2014-03-07 22:18:04 -0500] coderanger: Which is saying something
[2014-03-07 22:18:06 -0500] coderanger: cheeseprocedure: :-)
[2014-03-07 22:18:26 -0500] coderanger: Reminds me I need to add a note about SSL verification to the citadel readme
[2014-03-07 22:24:54 -0500] dgarstang: coderanger: the example has an Id: in the policy. When attempting to create a role with that, I get 'Policy documents cannot contain an ID field.'
[2014-03-07 22:25:17 -0500] coderanger: dgarstang: Just remove it, they exact specs on policies change depending on how you set them
[2014-03-07 22:25:28 -0500] dgarstang: k
[2014-03-07 22:25:47 -0500] coderanger: (if you set the policy on the bucket, the ID is required)
[2014-03-07 22:26:40 -0500] shlant: coderanger: is having reload as an action on the upstart service equatable to "initctl reload-configuration"?
[2014-03-07 22:46:27 -0500] coderanger: kallistec: You around?
[2014-03-07 22:46:44 -0500] coderanger: kallistec: I think I found a bug but it seems so obvious I'm confused why it is there
[2014-03-07 23:00:24 -0500] dgarstang: citadel... 'uninitialized constant Chef::HTTP'
[2014-03-07 23:02:47 -0500] coderanger: dgarstang: What version of Chef are you using
[2014-03-07 23:03:26 -0500] coderanger: dgarstang: requires 11.8.0+ I think
[2014-03-07 23:04:04 -0500] dgarstang: coderanger: Not quite sure how to tell on a Mac
[2014-03-07 23:04:18 -0500] coderanger: dgarstang: chef-client --version
[2014-03-07 23:04:33 -0500] coderanger: (just like every program ever)
[2014-03-07 23:04:51 -0500] dgarstang: Chef: 11.4.4
[2014-03-07 23:05:02 -0500] coderanger: Well there ya go
[2014-03-07 23:05:42 -0500] dgarstang: coderanger: I'm wondering if maybe the author of citadel might want to put that in the readme.
[2014-03-07 23:06:27 -0500] coderanger: dgarstang: Your passive aggressiveness is noted
[2014-03-07 23:06:47 -0500] coderanger: Remind me again why you are aren't banned from here yet?
[2014-03-07 23:06:55 -0500] dgarstang: coderanger: Let me rephrase. The author should put it in there. It would be very helpful.
[2014-03-07 23:07:34 -0500] dgarstang: coderanger: I'm passive aggressive because your so damn touchy. All I have to do is type one word wrong and you bite my damn head off.
[2014-03-07 23:07:44 -0500] dgarstang: JHC
[2014-03-07 23:08:49 -0500] coderanger: Updated readme and added a note about TLS
[2014-03-07 23:08:59 -0500] dgarstang: coderanger: Thank you.
[2014-03-07 23:18:16 -0500] doomviking: "plays well with others"
[2014-03-07 23:58:18 -0500] dgarstang: Citadel, same error after upgrading to 11.10.4. Not sure where Chef::HTTP comes from.
