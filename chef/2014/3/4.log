[2014-03-04 00:00:06 -0500] AntelopeSalad: after that you would start your service(s)
[2014-03-04 00:00:59 -0500] coderanger: I wouldn't handle migrations within Chef
[2014-03-04 00:01:17 -0500] coderanger: You could set it up, but thats not the same problem space as deployment
[2014-03-04 00:01:26 -0500] AntelopeSalad: i see it as deployment for sure
[2014-03-04 00:01:41 -0500] AntelopeSalad: take the app from your workstation and put it onto the production server
[2014-03-04 00:01:46 -0500] coderanger: No, for example you don't want to run migrations on two servers at the same time
[2014-03-04 00:01:58 -0500] coderanger: and they often have to be timed correctly since it locks the DB
[2014-03-04 00:02:31 -0500] AntelopeSalad: i'm not even thinking about 2 app servers yet
[2014-03-04 00:02:46 -0500] coderanger: And now you see why this is more complicated than this one small use case
[2014-03-04 00:02:49 -0500] AntelopeSalad: but yeah i see what you mean now, if you had 50 app servers and 1 db server, running 50 migrations would be an issue
[2014-03-04 00:03:23 -0500] AntelopeSalad: so what do you do in that case? do you manually ssh into 1 app server and run the migration?
[2014-03-04 00:04:21 -0500] coderanger: I would make a fab task or rundeck job, but basically yes
[2014-03-04 00:04:29 -0500] AntelopeSalad: that starts to sound like a complicated deployment, it's no longer automated
[2014-03-04 00:04:34 -0500] AntelopeSalad: you nee to do multiple manual steps
[2014-03-04 00:04:43 -0500] AntelopeSalad: *nee
[2014-03-04 00:04:46 -0500] coderanger: Indeed, welcome to the wonderful world of orchestration
[2014-03-04 00:04:51 -0500] AntelopeSalad: wow, d key is getting worn out hah
[2014-03-04 00:05:02 -0500] coderanger: Getting the actual bits on disk is one part of that
[2014-03-04 00:05:08 -0500] coderanger: and chef is good for that part
[2014-03-04 00:05:13 -0500] AntelopeSalad: well, if that's the case then why not just use cap to deploy your app
[2014-03-04 00:05:35 -0500] AntelopeSalad: since at least then you can run migrations on demand
[2014-03-04 00:06:27 -0500] coderanger: 1) that isn't compatible with self-healing or auto-scaling systems 2) cap is bad at writing config files and other system integration stuffs 3) no reason to not use chef for that part
[2014-03-04 00:06:38 -0500] coderanger: Use cap to run chef everywhere and then run the migrations on the right box
[2014-03-04 00:06:56 -0500] AntelopeSalad: i dunno, i imported 1 file and sidekiq/puma were both fully managed with upstart configs with 0 tinkering
[2014-03-04 00:07:03 -0500] AntelopeSalad: it all just worked
[2014-03-04 00:07:17 -0500] coderanger: See also #1
[2014-03-04 00:07:41 -0500] AntelopeSalad: seems like "i'll solve them when it's a real problem" type of issues
[2014-03-04 00:08:14 -0500] AntelopeSalad: (for your #1)
[2014-03-04 00:08:30 -0500] coderanger: You can't ask for "how to do this like Big Companies" on one side and then say "but I don't care about all that" on the other
[2014-03-04 00:08:32 -0500] AntelopeSalad: being able to have your app start on your server and also recover from unexpected crashes is a priority no matter what
[2014-03-04 00:08:42 -0500] AntelopeSalad: that needs to happen if you have 1 or 1000 app servers
[2014-03-04 00:08:42 -0500] coderanger: If you want something simple and not particularly scalable, just use cap
[2014-03-04 00:09:38 -0500] AntelopeSalad: i'm also not convinced my problem will be solved if i replace deploy with my own home grown solution
[2014-03-04 00:10:35 -0500] coderanger: You've taken up a lot of my time, I have nothing further to offer you
[2014-03-04 00:10:58 -0500] AntelopeSalad: yeah, i appreciate the help but you can see the dilemma now
[2014-03-04 00:11:07 -0500] coderanger: No, I really can't
[2014-03-04 00:11:08 -0500] AntelopeSalad: you've basically said "reimplement deploy yourself or leave"
[2014-03-04 00:11:20 -0500] coderanger: No, I told you "implement something far far far simpler than deploy"
[2014-03-04 00:11:35 -0500] coderanger: Do not reimplement the symlinks, or callbacks, or migration support
[2014-03-04 00:11:43 -0500] coderanger: As thats whats broken in the first place
[2014-03-04 00:12:38 -0500] AntelopeSalad: yeah but that's not even the area i'm having trouble with
[2014-03-04 00:12:58 -0500] coderanger: I really don't care, ask others around here, I'm usually right about this kind of thing :)
[2014-03-04 00:13:12 -0500] AntelopeSalad: if restart_command is the last thing ran, then the deploy resource has pretty much ran end to end
[2014-03-04 00:13:16 -0500] coderanger: I may be a bit of an ass, but I have a nasty habit of being correct
[2014-03-04 00:13:42 -0500] AntelopeSalad: i'll gladly accept migrations not being handled by chef
[2014-03-04 00:13:47 -0500] AntelopeSalad: because that does make sense
[2014-03-04 00:14:14 -0500] AntelopeSalad: i also fully get that symlinks/etc. won't be needed if you use the git resource since nothing is being copied around
[2014-03-04 00:14:36 -0500] AntelopeSalad: i just don't get why not a single person on this planet released a flow to deploy an app in this "more simple" solution
[2014-03-04 00:16:10 -0500] iroller: Hey. Question re contributing to a cookbook. I'm going to add unit tests to cover existing functional -> add feature1 -> add tests for feature1 -> add feature2 -> add tests for feature2. I need to have basic tests before testing both features.
[2014-03-04 00:16:17 -0500] coderanger: AntelopeSalad: Because there are maybe 100 people out there that are Really Good at Chef right now, and we've all been busy
[2014-03-04 00:16:25 -0500] iroller: So the question is how to create proper branches/pull requests?
[2014-03-04 00:16:49 -0500] AntelopeSalad: coderanger: but why would anyone need to be really good? isn't it as simple as: clone repo, bundle install, precompile assets, start app?
[2014-03-04 00:17:15 -0500] coderanger: AntelopeSalad: Because writing docs and other such things that other people can use generally requires a deep understanding of what you are doing
[2014-03-04 00:17:23 -0500] coderanger: AntelopeSalad: Case in point, why don't you go document this?
[2014-03-04 00:17:41 -0500] AntelopeSalad: document what? that i can't get runit to manage a puma process?
[2014-03-04 00:18:15 -0500] coderanger: iroller: Not sure what you mean, just make the branches and submit them, make sure you make a ticket in Jira too
[2014-03-04 00:18:31 -0500] coderanger: iroller: (assuming this is an Opscode cookbook)
[2014-03-04 00:19:31 -0500] AntelopeSalad: coderanger: docs take time but the real time sink is making an interface that's a good balance of not being complex and works for most people
[2014-03-04 00:20:01 -0500] AntelopeSalad: but those 3 steps would honestly be like 15 lines of code
[2014-03-04 00:20:41 -0500] AntelopeSalad: you should know too because app_ruby's rails provider does most of it at some point
[2014-03-04 00:20:47 -0500] iroller: @coderanger: this is opscode cookbook, right. I can't create three pull requests for basic tests, feature1, feature2 since feature branches should have basic tests as well. However one pull requests for two different features is not the best way too, right?
[2014-03-04 00:21:12 -0500] coderanger: iroller: Are the closely related features?
[2014-03-04 00:21:14 -0500] AntelopeSalad: couple lines of noise to setup bundler's flags, execute bundle install as a user, execute precompile assets as a user
[2014-03-04 00:22:33 -0500] iroller: @coderanger: they both extend the same lwrp but they're not related to each other
[2014-03-04 00:23:05 -0500] coderanger: iroller: I would make three PRs then, basic tests, feature1 and feature2
[2014-03-04 00:23:19 -0500] coderanger: and make it clear the basic one needs to be merged first since it will be included in the other two
[2014-03-04 00:24:16 -0500] iroller: @coderanger: it'll be a pain to add tests for features then
[2014-03-04 00:24:31 -0500] coderanger: iroller: Why?
[2014-03-04 00:25:05 -0500] AntelopeSalad: btw coderanger: before heading out, what would you recommend instead of runit?
[2014-03-04 00:25:31 -0500] coderanger: AntelopeSalad: I use supervisor, works well enough
[2014-03-04 00:25:40 -0500] AntelopeSalad: ok thanks, i'll look into it
[2014-03-04 00:25:50 -0500] coderanger: monit and god are both popular in the rails world though
[2014-03-04 00:26:01 -0500] coderanger: and upstart generally works
[2014-03-04 00:26:03 -0500] AntelopeSalad: all 3 of them would be reasonable choices?
[2014-03-04 00:26:16 -0500] AntelopeSalad: (monit,god,supervisor)
[2014-03-04 00:26:21 -0500] ev0ldave: nooooooo, not monit
[2014-03-04 00:26:37 -0500] coderanger: AntelopeSalad: I would stick to supervisor or upstart personally, I've not used monit or god
[2014-03-04 00:26:41 -0500] coderanger: I just know they are popular
[2014-03-04 00:26:47 -0500] AntelopeSalad: ok
[2014-03-04 00:27:09 -0500] iroller: @coderanger: it doesn't have any testing env configured right now so I'm not sure how to split testing code between three branches. I need Berksfile, spec/spec_helper.rb, vendor/, etc. files in every branch to make tests work
[2014-03-04 00:27:32 -0500] coderanger: iroller: the feature1 and feature2 branches would start from the basic branch :)
[2014-03-04 00:27:51 -0500] iroller: @coderanger: k, sounds good
[2014-03-04 00:42:32 -0500] kshep: coderanger: so... re my dependency resolution... I've narrowed it down to a recipe that when added to the runlist freezes things
[2014-03-04 00:42:37 -0500] kshep: but if I look at the deps....
[2014-03-04 00:42:39 -0500] kshep: there's no confnlict
[2014-03-04 00:43:25 -0500] coderanger: kshep: Check that cookbook's deps vs the environment constraints
[2014-03-04 00:44:12 -0500] kshep: there are no cookbook_versions contraints in the env
[2014-03-04 00:44:35 -0500] coderanger: kshep: Okay, so if you put that one cookbook in the list it fails, but if you just put its dependencies it works?
[2014-03-04 00:44:48 -0500] kshep: oh... hadn't tried putting in the deps
[2014-03-04 00:45:05 -0500] kshep: good next step
[2014-03-04 00:45:09 -0500] coderanger: Yeah, jsut got to recurse down into dependencies until you find the exact mix that fails :-(
[2014-03-04 00:45:14 -0500] kshep: yep
[2014-03-04 00:45:15 -0500] coderanger: Or at least gives you an error
[2014-03-04 00:45:24 -0500] kshep: error would be nice at this point
[2014-03-04 00:45:27 -0500] kshep: just hangs atm
[2014-03-04 00:45:41 -0500] coderanger: kshep: You say that, last time I got an error from devsolver it was 22MB of text ;-)
[2014-03-04 00:45:51 -0500] kshep: well
[2014-03-04 00:46:01 -0500] kshep: it's probably easier to find an error in 22MB than in 0MB
[2014-03-04 00:46:19 -0500] coderanger: I'll give you that on a technicality :)
[2014-03-04 00:46:57 -0500] kshep: woah
[2014-03-04 00:46:59 -0500] kshep: I see it
[2014-03-04 00:47:28 -0500] kshep: sooo... the one that breaks... let's call it database... deps on base. but base is explicitly in the runlist
[2014-03-04 00:47:55 -0500] kshep: current version of base is 1.0.9. Database says it depends on 1.0.0 of base
[2014-03-04 00:47:57 -0500] kshep: hm
[2014-03-04 00:48:36 -0500] kshep: let's just blow that away and re-upload... shall we?
[2014-03-04 00:51:13 -0500] Majost: when using template in a lwrp, is there a trick to telling 'source' to use the erb which is local to the cookbook from which the lwrp exists?
[2014-03-04 00:51:40 -0500] coderanger: Majost: cookbook new_resource.cookbook.to_s
[2014-03-04 00:51:42 -0500] Majost: When I call it from a wrapper, it seems to want to try and look for the source erb in the wrapper instead of the original cookbook
[2014-03-04 00:52:27 -0500] coderanger: Majost: Ahh, you want the reverse
[2014-03-04 00:52:32 -0500] coderanger: Majost: cookbook 'asdf'
[2014-03-04 00:52:34 -0500] coderanger: in the template
[2014-03-04 00:52:41 -0500] coderanger: Easiest way is to hardcode it
[2014-03-04 00:52:50 -0500] kshep: Response: {"message"=>"Unable to satisfy constraints on cookbook sofi-mysql, which does not exist.", "non_existent_cookbooks"=>["sofi-mysql"], "most_constrained_cookbooks"=>[]}
[2014-03-04 00:52:53 -0500] kshep: but... like... it does
[2014-03-04 00:53:06 -0500] coderanger: kshep: The name is a bit of a misnomer
[2014-03-04 00:53:14 -0500] coderanger: More like "no candidate versions"
[2014-03-04 00:53:36 -0500] coderanger: Majost: To do it without hard coding is  complex
[2014-03-04 00:53:44 -0500] kshep: but... that's from just doing your cookbook_versions api post with nothing but sofi-mysql in the runlist
[2014-03-04 00:53:55 -0500] kshep: oh... wait... no
[2014-03-04 00:53:59 -0500] coderanger: kshep: You 100% sure there are no cookbook_versions rules in the env?
[2014-03-04 00:54:28 -0500] someara: Majost: https://github.com/opscode-cookbooks/yum/blob/master/providers/repository.rb#L40
[2014-03-04 00:54:29 -0500] kshep: Environment: dev
[2014-03-04 00:54:43 -0500] kshep: cookbook_versions:
[2014-03-04 00:54:51 -0500] coderanger: someara: https://github.com/poise/poise/blob/master/libraries/template_content.rb#L147-L158
[2014-03-04 00:55:09 -0500] coderanger: someara: (warning: may require eye bleach)
[2014-03-04 00:55:24 -0500] someara: I was about to say.. your code gives me vertigo =)
[2014-03-04 00:55:37 -0500] coderanger: someara: bonus round https://github.com/poise/poise/blob/master/libraries/template_content.rb#L40
[2014-03-04 00:55:40 -0500] coderanger: someara: Totally works though
[2014-03-04 00:55:51 -0500] kshep: so.... sofi-database thinks it needs 1.0.0. It doesn't. It should be using 1.0.3, which is on the server
[2014-03-04 00:56:00 -0500] someara: # If you are reading this, I'm so sorry
[2014-03-04 00:56:02 -0500] someara: haha
[2014-03-04 00:56:15 -0500] coderanger: kshep: Something somewhere has a dependency on it at that version :-(
[2014-03-04 00:56:27 -0500] someara: brbfoods
[2014-03-04 00:56:34 -0500] Majost: someara: ah, cool this also has the newer use_inline_resources stuff I wanted to see
[2014-03-04 00:56:36 -0500] Majost: thanks
[2014-03-04 00:56:48 -0500] kshep: well.. production does :-)
[2014-03-04 00:57:03 -0500] coderanger: kshep: Did you change the URL in my snippet?
[2014-03-04 00:57:18 -0500] kshep: bwahahaha
[2014-03-04 00:57:55 -0500] coderanger: kshep: I should really add instructions to that gist :)
[2014-03-04 00:58:24 -0500] kshep: huh. So. This might work now.
[2014-03-04 01:11:03 -0500] kisoku: template_content is a pretty crazy piece of code, but awesome once you'
[2014-03-04 01:11:12 -0500] kisoku: ve wrapped your head around what it does
[2014-03-04 01:15:30 -0500] shlant: is there any way to get chef running periodically using knife? is it in the node json?
[2014-03-04 01:17:22 -0500] kisoku: just run chef-client as a daemon ?
[2014-03-04 01:17:32 -0500] kisoku: or are you running chef-solo ?
[2014-03-04 01:43:59 -0500] kshep: coderanger: blew away all the cookbooks, uploaded again (using berkshelf)... now I get "Unable to satisfy goal constraints ...  due to constraint on yum"
[2014-03-04 01:44:05 -0500] kshep: I'm on Ubuntu, of course
[2014-03-04 01:44:15 -0500] kshep: so the fact I have stuff with hard deps on yum makes my head hurt
[2014-03-04 01:44:28 -0500] kshep: (community cookbooks)
[2014-03-04 01:58:10 -0500] kisoku: kshep: what versionf of berkshelf
[2014-03-04 01:58:30 -0500] kisoku: if you are using berkshelf 2, try blowing away your shelf and running berks update
[2014-03-04 01:58:47 -0500] kisoku: the dependencies will probably come good
[2014-03-04 01:59:06 -0500] kisoku: please note the use of the word probably
[2014-03-04 02:03:41 -0500] kshep: kisoku: I think I got it.. yum 3.0 has breaking changes from 2.x
[2014-03-04 02:05:17 -0500] kisoku: most community cookbooks have been updated to use yum 3 now
[2014-03-04 02:05:23 -0500] kisoku: iirc
[2014-03-04 02:06:09 -0500] kshep: I think clamav is biting me
[2014-03-04 02:21:24 -0500] kshep: nope... docker
[2014-03-04 02:21:48 -0500] kshep: I really don't understand why community cookbooks would require yum on ubuntu
[2014-03-04 02:21:57 -0500] kshep: well... I mean... I do
[2014-03-04 02:22:05 -0500] kshep: it's because they aren't really general purpose, platform independent
[2014-03-04 02:27:38 -0500] someara: kshep usually they need to use the yum_repository provider to configure the system to be able to download the packages involved
[2014-03-04 02:27:50 -0500] kshep: Ubuntu uses apt.
[2014-03-04 02:27:52 -0500] someara: they'll usually rely on yum-epel or something
[2014-03-04 02:28:02 -0500] kshep: I manage my packages via apt
[2014-03-04 02:28:33 -0500] someara: if the cookbook supports rhel/centos, then it needs access to the resources/providers in yum
[2014-03-04 02:28:46 -0500] kshep: throwing a second package manager on somebody's server without calling it out explicitly is ... welll... painful
[2014-03-04 02:28:54 -0500] someara: likewise, if it supports windows, it will probably depend on the windows cookbook
[2014-03-04 02:29:23 -0500] kshep: ah... I get it
[2014-03-04 02:29:25 -0500] kshep: so
[2014-03-04 02:29:33 -0500] someara: it doesn't install yum on your system... it only makes the yum_repository resource available to the recipes in the cookbook
[2014-03-04 02:29:33 -0500] kshep: shouldn't those deps be platform dependent tho?
[2014-03-04 02:29:52 -0500] kshep: in this case I have chef-client failing because one cookbook dpeends on a newer version of yum than another
[2014-03-04 02:30:11 -0500] kshep: when in fact, neither should be using yum
[2014-03-04 02:30:14 -0500] kshep: because it's an Ubuntu box
[2014-03-04 02:30:59 -0500] someara: the dependency solver has no platform awareness, it just solves a graph
[2014-03-04 02:31:13 -0500] someara: much like cpan/rubygems/python/maven, etc
[2014-03-04 02:31:52 -0500] someara: this problem arises in any language where software artifacts have versioned dependencies
[2014-03-04 02:31:58 -0500] jameson__: is there a general consensus on how to deal with pinning python/ruby/apt packages in recipes :\?
[2014-03-04 02:32:45 -0500] someara: the apt cookbook has a resource for pinning apt packages
[2014-03-04 02:32:49 -0500] someara: not sure about python
[2014-03-04 02:33:05 -0500] someara: with ruby you'd manage a Gemfile per project as usual
[2014-03-04 02:34:14 -0500] jameson__: well inside a cookbook.
[2014-03-04 02:34:51 -0500] someara: kshep the dependency thing pulls in anything the cookbook might need. just like when you install a package on ubuntu, and it will pull down libkerberos or whatever even if you have no intention of using it
[2014-03-04 02:34:53 -0500] jameson__: how to imbed a gemfile inside a cookbook is a better way to put it.
[2014-03-04 02:35:00 -0500] jameson__: *embed
[2014-03-04 02:35:15 -0500] someara: jameson you can specify exact versions on package resources
[2014-03-04 02:35:21 -0500] someara: gem_package etc
[2014-03-04 02:39:08 -0500] jameson__: someara: I guess is how would you allow users to change the version of the gem via attributes (or should that not be allowed)
[2014-03-04 02:39:50 -0500] someara: you can use a node attribute as the value for the version parameter in a package resource
[2014-03-04 02:40:03 -0500] someara: then it becomes a tweakable knob
[2014-03-04 02:40:57 -0500] someara: but using gem_package is rarely what you want to do.... ruby projects are typically built with bundler from a Gemfile within their source repository
[2014-03-04 02:41:53 -0500] jameson__: yeah, that's my current approach, it's so far.. I have a hash with 'gem_name => gem version'
[2014-03-04 02:42:18 -0500] someara: sounds legit
[2014-03-04 02:42:57 -0500] jameson__: so ugly ;_;
[2014-03-04 02:44:39 -0500] someara: at least its not erlang
[2014-03-04 02:46:34 -0500] jameson__: I am sure it makes sense to someone
[2014-03-04 04:45:55 -0500] RicoShen_: hello
[2014-03-04 04:46:14 -0500] RicoShen_: guys, I meet an issue when using chef to run a java Hello World program, "Could not reserve enough space for object heap" error poped up. If I locally run the HelloWorld , it's ok.Has anyone here met this issue before? or anyone have idea on this?
[2014-03-04 04:46:29 -0500] RicoShen_: I'm trying to start a java service on the machine, I found this error. so I replace the java service with a Java HelloWorld program. the error still occur. so I believe there's nothing wrong with the Java service.
[2014-03-04 04:46:39 -0500] RicoShen_: my chef server is : win7 64-bit virtual machine. my chef client is : windows server 2012 64-bit ec2 instance.
[2014-03-04 04:59:55 -0500] juliancdunn: RicoShen_: are you running Chef Client as a service?
[2014-03-04 05:00:49 -0500] juliancdunn: you may need a WinRM quota hotfix for Windows before doing anything: http://support.microsoft.com/kb/2842230
[2014-03-04 05:01:46 -0500] RicoShen_: I took a look at this website yesterday, I found there's no patch for windows server 2012
[2014-03-04 05:03:41 -0500] juliancdunn: contact MSFT then, since the KB says it applies to Windows 2012
[2014-03-04 05:04:20 -0500] RicoShen_: thanks for your advice
[2014-03-04 05:05:34 -0500] juliancdunn: no problem
[2014-03-04 05:06:21 -0500] bobbyr: having a hell of a time with chef and ufw
[2014-03-04 05:06:50 -0500] bobbyr: was working, now I am getting a type error, cannot convert fixednum to string or something similar for the ssh rule
[2014-03-04 05:06:54 -0500] bobbyr: driving me crazy
[2014-03-04 05:07:27 -0500] juliancdunn: bobbyr: gist the output?
[2014-03-04 05:07:37 -0500] bobbyr: sure one sec
[2014-03-04 05:10:31 -0500] bobbyr: https://gist.github.com/fxtickr/9340611
[2014-03-04 05:10:55 -0500] bobbyr: these are the defaults
[2014-03-04 05:11:17 -0500] bobbyr: have tried manually changing port 22 to "22"
[2014-03-04 05:15:22 -0500] brucelee_: yo
[2014-03-04 05:15:27 -0500] brucelee_: coderanger: sup
[2014-03-04 05:15:53 -0500] brucelee_: coderanger: bad news: theres no official centos 64bit with cloudinit
[2014-03-04 05:15:54 -0500] brucelee_: :(
[2014-03-04 05:15:59 -0500] brucelee_: no ami
[2014-03-04 05:16:12 -0500] brucelee_: i had to install the minimum and run the multissh wrapper to install everything
[2014-03-04 05:17:25 -0500] coderanger: brucelee_: Fun
[2014-03-04 05:17:56 -0500] brucelee_: coderanger: once i get the time, ill have to check out packer.io that you told me about
[2014-03-04 05:19:26 -0500] juliancdunn: bobbyr: I can't see anything obviously wrong, sorry... and I gotta bail :-(
[2014-03-04 05:20:54 -0500] juliancdunn: bobbyr: this might help: https://github.com/opscode-cookbooks/firewall/commit/7243b42383e074af4f80bcc5644f9f3ea98762ce
[2014-03-04 05:21:06 -0500] juliancdunn: tl;dr: run version 0.11.6
[2014-03-04 05:22:14 -0500] bobbyr: thanks!
[2014-03-04 05:55:13 -0500] RicoShen_: hi , juliancdunn, I just contact with MSFT, he said that this hotfix was already included in Windows Server 2012. the infomation on the page about window server was wrong
[2014-03-04 06:21:47 -0500] brucelee_: anyone here ever heard of fpm?
[2014-03-04 06:22:28 -0500] brucelee_: a tool that builds packages for any environment, so you can then use it for your chef cookbooks
[2014-03-04 06:22:37 -0500] brucelee_: rather than having to install from source
[2014-03-04 07:19:10 -0500] chef770: hi
[2014-03-04 07:19:30 -0500] chef770: i was trying to create the database in mysql using database cookbook
[2014-03-04 07:20:06 -0500] chef770: but i am getting error Error executing action `create` on resource 'mysql_database[databasename]'
[2014-03-04 07:20:25 -0500] chef770: cannot load such file -- mysql
[2014-03-04 07:22:41 -0500] chef770: http://www.pastebin.ca/2651442 error more information
[2014-03-04 07:23:12 -0500] chef770: my chef-client os is centos
[2014-03-04 07:24:02 -0500] chef770: any idea why is giving error?
[2014-03-04 07:31:01 -0500] m4rcu5: Ohai Chefs, any clue whats going on here? COOK-3984 this seems a pretty mayor fail (seeing my mailbox be bombarded with cron mails) and minor fix.
[2014-03-04 07:33:22 -0500] coderanger: m4rcu5: Probably just not many people that run it and no fix has been provided
[2014-03-04 07:33:59 -0500] m4rcu5: coderanger: how does the rest of you do logrotate?
[2014-03-04 07:34:55 -0500] coderanger: m4rcu5: I generally don't
[2014-03-04 07:35:43 -0500] m4rcu5: coderanger: no problems with logs growing? i find chef to be pretty verbose, and running once every 30 minutes im running out of diskspace
[2014-03-04 07:35:47 -0500] coderanger: (at least not for chef-client)
[2014-03-04 07:36:14 -0500] coderanger: m4rcu5: I just cram it all in syslog and manage it there
[2014-03-04 07:37:38 -0500] m4rcu5: coderanger: but then you need to have filtering in syslog and all, thats a pita as well 0_0
[2014-03-04 07:37:56 -0500] coderanger: m4rcu5: logstash ftw
[2014-03-04 07:42:21 -0500] m4rcu5: coderanger: i feel this is solving a minor issue with a gatteling run ;P altough logstash looks cool, im stuckw ith that log file for now
[2014-03-04 07:42:37 -0500] coderanger: m4rcu5: Yeah, if this is your only issue it would be far overkill
[2014-03-04 07:42:45 -0500] coderanger: Just saying a lot of people solve this systemically :)
[2014-03-04 07:42:59 -0500] coderanger: or lots of people just never set the log to go to a file in the first place
[2014-03-04 07:43:19 -0500] m4rcu5: i would like to parse all syslogs with logstash and such, but our infra is not up to that point yet
[2014-03-04 07:43:41 -0500] m4rcu5: coderanger: is logging by default right?
[2014-03-04 07:43:58 -0500] coderanger: m4rcu5: I think the default is STDOUT
[2014-03-04 07:44:10 -0500] m4rcu5: even if you set is as a service?
[2014-03-04 07:47:21 -0500] coderanger: m4rcu5: Not sure, been a while since I checked the defaults
[2014-03-04 07:50:46 -0500] m4rcu5: coderanger: yeah it is iirc, we have all servers set up with init service, and our dev boxes (running chef every 5 minutes) are filling their disk
[2014-03-04 08:03:55 -0500] denniswisnia: Hey Guys, I want to set an attribute to set an node "active" or not. So that I can manage the loadbalancer with attribute,  but now: http://pastebin.com/qvAgsEsG
[2014-03-04 08:09:51 -0500] coderanger: denniswisnia: Make sure you set a default value for it
[2014-03-04 08:34:01 -0500] josqu4red: hello there
[2014-03-04 08:34:26 -0500] josqu4red: i'm trying to build an omnibus package containing ruby gems with extensions
[2014-03-04 08:35:34 -0500] josqu4red: however, the shared object built is installed in a wrong location
[2014-03-04 08:36:18 -0500] josqu4red: /opt/lita/embedded/lib/ruby/gems/2.0.0/gems/puma-2.7.1/lib/opt/lita/embedded/lib/ruby/site_ruby/2.0.0/x86_64-linux/puma/puma_http11.so
[2014-03-04 08:36:35 -0500] josqu4red: note the "duplicated" path
[2014-03-04 08:36:53 -0500] josqu4red: does anybody know how to work around this ?
[2014-03-04 08:56:37 -0500] denniswisnia: coderanger: yea, but why he makes trouble if he dont find any node. But how can I Solve it?
[2014-03-04 08:57:14 -0500] coderanger: denniswisnia: Because if you don't have a default set, node['application'] == nil, so nil['active'] is an error
[2014-03-04 08:57:33 -0500] denniswisnia: hmm
[2014-03-04 08:57:39 -0500] denniswisnia: that is not pretty.
[2014-03-04 08:58:10 -0500] denniswisnia: ahhh!
[2014-03-04 08:58:13 -0500] denniswisnia: I understand
[2014-03-04 09:09:17 -0500] denniswisnia: coderanger: pretty much amazin!
[2014-03-04 09:09:22 -0500] denniswisnia: coderanger: it works!
[2014-03-04 09:21:56 -0500] dalibro: exit
[2014-03-04 09:23:06 -0500] ermajn: hello, this: @charset "UTF-8"; as the first line of cookbook recipe, won't let me compile cookbook
[2014-03-04 09:23:19 -0500] ermajn: is that normal, because to other colleague it is working
[2014-03-04 09:23:20 -0500] ermajn: :S
[2014-03-04 09:24:48 -0500] coderanger: Is that some kind of special Ruby thing?
[2014-03-04 09:29:51 -0500] ermajn: sorry if I have miss answer about @charset, anybody can help?
[2014-03-04 09:31:27 -0500] coderanger: ermajn: I don't think thats valid Ruby
[2014-03-04 09:31:33 -0500] coderanger: @charset is generally a CSS declaration
[2014-03-04 09:32:32 -0500] coderanger: ermajn: Just put a comment like "# coding: UTF-8"
[2014-03-04 09:32:58 -0500] ermajn: coderanger, thnaks
[2014-03-04 09:33:35 -0500] denniswisnia: coderanger: I had an bug in, I want to set the attribute on the webnode, not on the loadbalancer. How can I get it in cookbook?
[2014-03-04 09:34:01 -0500] coderanger: denniswisnia: Not sure what you mean, just set it where you want to set it
[2014-03-04 09:36:33 -0500] Lukasz_: Is there a way to check if 'lazy' is defined? I'm using cookbook that uses 'lazy' and my chef don't have it so I have to include 'delayed_evaluator' cookbook which provides lazy
[2014-03-04 09:36:52 -0500] denniswisnia: okay, on the loadbalancer I have the following code: https://gist.github.com/anonymous/3f3edd5dd51436e35774 - I want to make the webnodes active or inactive with an attribute.
[2014-03-04 09:37:25 -0500] segv: denniswisnia use a search.
[2014-03-04 09:37:26 -0500] coderanger: Lukasz_: That isn't from a cookbook, it was a core feature added a little while ago
[2014-03-04 09:38:33 -0500] coderanger: denniswisnia: There isn't a good way to do that
[2014-03-04 09:38:41 -0500] denniswisnia: coderanger: why?
[2014-03-04 09:39:03 -0500] Lukasz_: @coderanger: yes I know, and I'd like to add some conditional that if lazy isn't defined as a core feature it would include_recipe delayed_evaluator...
[2014-03-04 09:39:04 -0500] coderanger: denniswisnia: Its a very long story involving "it seemed like a good idea at the time" when I wrote this code several years ago :-)
[2014-03-04 09:39:12 -0500] coderanger: Lukasz_: You can't 
[2014-03-04 09:39:21 -0500] coderanger: Lukasz_: It wasn't done in a cookbook like partial_search
[2014-03-04 09:39:35 -0500] coderanger: Lukasz_: You would have to build a polyfill, and I don't recommend that
[2014-03-04 09:39:44 -0500] denniswisnia: coderanger: yea, but whats the better way to manage the nodes? ;)
[2014-03-04 09:39:55 -0500] coderanger: denniswisnia: Short version is that you can't (easily) subclass the application_nginx resource/provider
[2014-03-04 09:40:15 -0500] coderanger: so you can either fork it and modify things in-line or do silly things to monkey patch
[2014-03-04 09:40:19 -0500] coderanger: I recommend the latter
[2014-03-04 09:40:39 -0500] denniswisnia: hmmm
[2014-03-04 09:41:19 -0500] coderanger: denniswisnia: The application cookbooks basically only cover a single, very simple use case
[2014-03-04 09:41:40 -0500] coderanger: denniswisnia: I had hoped they could be more flexible, but they will require a large-scale rewrite to get there
[2014-03-04 09:41:51 -0500] coderanger: (I've gotten much better at the patterns I first used in there many years ago)
[2014-03-04 09:42:13 -0500] coderanger: denniswisnia: https://github.com/poise/application/blob/master/libraries/default.rb#L95-L117 is the method used to find remote servers
[2014-03-04 09:42:13 -0500] Lukasz_: @coderanger: I'm already doing it like this https://gist.github.com/kleewho/eeec33cb7903cfe4b52d... I thought that there's a better way
[2014-03-04 09:42:58 -0500] Lukasz_: @coderanger: in fact I don't have any idea about what polyfill is, so yeah... building it wouldn't be the best idea
[2014-03-04 09:43:09 -0500] coderanger: Lukasz_: Yeah, the old delayed_evaluator isn't directly compatible with the version in chef 11
[2014-03-04 09:43:19 -0500] coderanger: Lukasz_: As mentioned in the readme, the name of the method changed
[2014-03-04 09:43:29 -0500] coderanger: Lukasz_: So that code won't run as-is on chef 10
[2014-03-04 09:43:34 -0500] denniswisnia: coderanger: yea, I can remove the role "application_server" from the node and rerun the chef-client - but, thats not the prettys way, I think that the way with attribute is lot smarter and in my eyes very simple ;)
[2014-03-04 09:43:40 -0500] coderanger: Lukasz_: Unless you have a reeeeeally good reason to support chef 10, I wouldn't
[2014-03-04 09:43:52 -0500] coderanger: Lukasz_: It would require a lot of annoying metaprogramming
[2014-03-04 09:44:16 -0500] Lukasz_: @coderanger: I don't want 10 but I'm using chef-solo 11.4.4 and it's complaining about lazy
[2014-03-04 09:44:29 -0500] coderanger: denniswisnia: Sure, your use case seems perfectly reasonable, just hard to get the application cookbooks to work like that :-(
[2014-03-04 09:45:13 -0500] coderanger: Lukasz_: Yep, added in 11.6
[2014-03-04 09:45:27 -0500] coderanger: Lukasz_: and in 10.28 apparently, I missed that it was backported, cool
[2014-03-04 10:16:11 -0500] denniswisnia: coderanger: damn :( do you have any idea to fix my problem?
[2014-03-04 11:01:19 -0500] maxkazar: Hey everyone
[2014-03-04 11:05:18 -0500] maxkazar: I'm new with chef. I try to cook rbenv. This recipe require ruby >=1.9 My host has only ruby 1.8.7. What should i do? Should i install ruby 1.9 by myself? Or should i create recipe that install ruby 1.9 like package 'ruby' do version: '1.9.3' end?
[2014-03-04 11:12:20 -0500] Siiseli: maxkazar, use the rvm cookbook
[2014-03-04 11:12:26 -0500] Siiseli: to install the correct ruby version
[2014-03-04 11:13:08 -0500] matti: Hi Chefs
[2014-03-04 11:13:28 -0500] maxkazar: ) rvm that good....but i need rbenv(
[2014-03-04 11:13:59 -0500] Siiseli: well there are rbenv cookbooks as well
[2014-03-04 11:14:37 -0500] Siiseli: https://github.com/fnichol/chef-rbenv https://github.com/RiotGames/rbenv-cookbook for example
[2014-03-04 11:20:20 -0500] legal90: Hi, chefs! Please, help me with open-source chef-server: Shoud the 'chef-validator' account have admin privilegies or not? Without 'admin: true' it is impossible to register new client using this validator account...
[2014-03-04 11:21:11 -0500] legal90: but I doubt that it is secure to keep validator as admin
[2014-03-04 11:25:40 -0500] bubu: Hey guys, I forked the Java community cookbook a while back for out chef repo. It's stock and I want to keep up to date with the upstream community cookbook, creating wrapper cookbooks if I need some functionality not currently in upstream. How do I do this so I can get rid of our Java cookbook in our chef repo?
[2014-03-04 11:40:27 -0500] workmad3: bubu: create a new cookbook with a dependency on the community one, e.g. bubu_java. Then in that one, have a default recipe that includes the java cookbook recipe(s) you want to use, along with any attribute adjustments, new behaviour... if you need to adjust something in the cookbook, consider using chef-rewind to alter a resource
[2014-03-04 11:42:09 -0500] bubu: workmad3: create a new cookbook with berkshelf or just normally?
[2014-03-04 11:42:31 -0500] workmad3: bubu: either way
[2014-03-04 11:42:56 -0500] workmad3: bubu: there's nothing special about a berkshelf-created cookbook to chef... it just has a template that's suitable for using berkshelf ;)
[2014-03-04 11:43:13 -0500] bubu: ah, new to the berks way
[2014-03-04 11:43:31 -0500] bubu: I want to get into it but I've only just up to par with vagrant :P
[2014-03-04 11:49:18 -0500] bubu: workmad3: silly question, how can I depends on the community one, if I don't actually have that community cookbook in my chef repo?
[2014-03-04 11:49:59 -0500] workmad3: bubu: that's where berkshelf can help
[2014-03-04 11:50:20 -0500] bubu: ok so that _is_ a berks things
[2014-03-04 11:50:40 -0500] workmad3: bubu: but, if you didn't want to do that... then just add the community one to your chef repo and upload it to your server
[2014-03-04 11:50:45 -0500] workmad3: and then keep it synced
[2014-03-04 11:53:22 -0500] Siiseli: bubu, what berks does is you have a berksfile that lists dependencies, and instead of having to download and add the cookbooks you depend on yourself, berkshelf will deal with dependencies for you
[2014-03-04 11:53:58 -0500] workmad3: ^^
[2014-03-04 11:54:52 -0500] Siiseli: it just makes your life easier, there isn't much to do in regards to looking into it
[2014-03-04 11:54:56 -0500] Siiseli: recommended, imo.
[2014-03-04 12:15:02 -0500] aberrios: using opscode's heartbeat cookbook. It was working last week but now the config recipe seems to be erroring where it cant find the "heartbeat" method on line 22 config.rb
[2014-03-04 12:15:28 -0500] aberrios: include_recipe "heartbeat" is still functioning fine
[2014-03-04 12:16:07 -0500] roolo: Hi, guys. Is it possible to tell knife to connect locally? Something like `ansible_connection=local` in ansible inventory
[2014-03-04 12:16:30 -0500] Cope: roolo: what are you actually trying to do?
[2014-03-04 12:22:38 -0500] roolo: Cope: Write books to setup my workstation
[2014-03-04 12:22:55 -0500] workmad3: roolo: sounds like you want to use chef-solo
[2014-03-04 12:23:17 -0500] roolo: workmad3: From what i discovered so far, yes i do
[2014-03-04 12:26:57 -0500] roolo: workmad3: Do you mean i shall run chef-solo instead of knife ?
[2014-03-04 12:27:27 -0500] workmad3: roolo: most likely... not sure what you plan on using knife for when you're running chef-solo locally
[2014-03-04 12:29:42 -0500] roolo: workmad3: I thought knife is tool which make the things in cookbooks happen. No matter what setup i follow
[2014-03-04 12:30:29 -0500] workmad3: roolo: knife is a tool for interacting with the chef server from a chef workstation... it has some bits that work completely locally (such as creating a cookbook) but mostly it's use is absent in a workflow that doesn't use a chef server
[2014-03-04 12:32:22 -0500] roolo: workmad3: Aah, ty
[2014-03-04 12:42:21 -0500] roolo: workmad3: It seems to me chef-solo also requires "remoting" to configure some machine. Am i right?
[2014-03-04 12:43:07 -0500] roolo: (By remoting i mean ssh or something like that)
[2014-03-04 12:43:18 -0500] workmad3: roolo: not if you're doing it on your local machine
[2014-03-04 12:43:37 -0500] workmad3: roolo: typically you're using it on a single remote server, and then yes you'd SSH into the machine and start chef-solo...
[2014-03-04 12:43:59 -0500] workmad3: roolo: but if you're physically on the machine you want to set up, you don't need to do that ;)
[2014-03-04 12:51:18 -0500] aberrios: i dont get why I'm getting NoMethodError: undefined method `<=>' for nil:NilClass when using the heartbeat::config recipe...
[2014-03-04 12:55:08 -0500] roolo: workmad3: I hope last question. By what setting in solo.rb i can change /var/chef to . ?
[2014-03-04 12:55:45 -0500] workmad3: roolo: not sure on that front... any particular reason?
[2014-03-04 12:57:03 -0500] roolo: workmad3: Well i have everything in current dir so i can't see reason why would chef still need to access /var/chef
[2014-03-04 12:57:27 -0500] roolo: I found i can change it dir by dir, but it seems to me kinda cumbersome
[2014-03-04 12:57:29 -0500] jesser: hello  does anyone know why I'm getting "undefined method `default_version' for #<Omnibus::Software:0x00000001ac4d50>" when trying to build an omnibus package? I have the latest omnibus-software from github and the omnibus 1.2.0 gem.
[2014-03-04 12:57:39 -0500] workmad3: roolo: chef uses it as a cache path
[2014-03-04 12:57:47 -0500] workmad3: roolo: e.g. for remote files
[2014-03-04 12:58:21 -0500] workmad3: roolo: you may be able to do cache_path "." in solo.rb to set it
[2014-03-04 12:59:12 -0500] jesser: also, is this the best forum for help with omnibus ?
[2014-03-04 12:59:40 -0500] roolo: workmad3: Not yet there, but it changed the message, so ty ;)
[2014-03-04 13:05:51 -0500] roolo: workmad3: `cache_path Dir.pwd` was the trick ;)
[2014-03-04 13:05:52 -0500] phutch1ns: anyone familiar with the chef-server missing dependency bug in the opensource chef-server? I'm writing up a quick post on how to track down whats causing it and avoid the but until its fixed and could use some more details...
[2014-03-04 13:07:16 -0500] workmad3: roolo: :)
[2014-03-04 13:08:23 -0500] juliancdunn: phutch1ns: there's a pretty extensive description of the bug here: https://tickets.opscode.com/browse/CHEF-3921
[2014-03-04 13:08:53 -0500] phutch1ns: juliancdunn: Yeah I'm a part of that thread :)
[2014-03-04 13:10:09 -0500] phutch1ns: juliancdunn: i'm just trying to clarify a few things like... Whether the dependency has to be one or more levels deep, which i believe it does otherwise you will get a notification and it will fail.
[2014-03-04 13:11:18 -0500] phutch1ns: juliancdunn: and also, will the bug get triggered when the dependency cookbook is uploaded to the server but the version constraint cannot be met? or only when the dependency is not there entirely
[2014-03-04 13:11:54 -0500] phutch1ns: those are my two main curiosities. I can still write up the how to track it down but I want to provide as much info as possible in one place...
[2014-03-04 13:12:30 -0500] juliancdunn: ah. heh. I'm not sure about all those details.
[2014-03-04 13:12:39 -0500] phutch1ns: Cool, no worries :)
[2014-03-04 13:12:58 -0500] phutch1ns: I'll note in my article that I'm still looking for those details and write up the rest...
[2014-03-04 13:13:00 -0500] juliancdunn: but I think the solver fails when the client runs, not on cookbook upload
[2014-03-04 13:13:07 -0500] phutch1ns: correct.
[2014-03-04 13:14:20 -0500] phutch1ns: i wasn't clear when i typed that. I meant... will the bug get triggered when chef-client is run and the dependency cookbook exists on the server but the version constraint cannot be met
[2014-03-04 13:15:22 -0500] phutch1ns: I considered putting together a script to track down the missing dependency automatically but need a few more details before I could do that.
[2014-03-04 13:15:32 -0500] juliancdunn: yeah... best bet is probably to email Ho-Sheng with your questions ;)
[2014-03-04 13:15:58 -0500] phutch1ns: probably :). Thanks for taking a look!
[2014-03-04 13:16:52 -0500] juliancdunn: np
[2014-03-04 13:28:34 -0500] oleg: i am totally confused about the cookbook_file resource. The documentation on docs.opscode.com says that the name is used for the source location. But when I run it, I can use the resource name as path attribute. So what is now right?
[2014-03-04 13:32:24 -0500] bmhatfield: oleg: It's both. The filename portion of a path (say /etc/passwd) will be searched according to the file location rules (platform, etc) in the files/ section of your cookbook.
[2014-03-04 13:32:58 -0500] bmhatfield: oleg: The result will be that if a file is found, say cookbooks/YOURCOOKBOOK/files/default/passwd, it will be placed into /etc/passwd.
[2014-03-04 13:34:39 -0500] bmhatfield: oleg: I just looked at the docs on this, and it appears that they are in fact unclear.
[2014-03-04 13:34:59 -0500] bmhatfield: ie; there's no example showing the filename-from-path inference bit
[2014-03-04 13:39:44 -0500] phutch1ns: bmhatfield: if you include source "/my/file.txt" in the resource, it uses that as the source instead of the filename inside fo the cookbook_file "/new/location/on/remote/server/file.txt.orig" do
[2014-03-04 13:40:07 -0500] phutch1ns: bmhatfield: does that make sense?
[2014-03-04 13:40:26 -0500] jsfrerot: Hi everyone, I'm kinda new to chef and ruby and I'm running into a problem. When I use the "directory" chef resource in a recepe everything works fine, but when I try to use it in a ruby_block I get this error: NoMethodError: undefined method `directory' for Chef::Resource::RubyBlock. Any idea on how to use the directory resource within a ruby_block ?
[2014-03-04 13:41:38 -0500] bmhatfield: jsfrerot: It might help to read this: http://docs.opscode.com/essentials_nodes_chef_run.html
[2014-03-04 13:42:00 -0500] oleg: bmhatfield: Thanks for your answer :)
[2014-03-04 13:42:34 -0500] bmhatfield: jsfrerot: It explains that there's multiple phases to a chef run - the DSL is not available within a ruby_block resource's block.
[2014-03-04 13:43:06 -0500] bmhatfield: phutch1ns: I'm not sure what you're asking, sorry.
[2014-03-04 13:46:21 -0500] jsfrerot: bmhatfield: thx for your answer. I guess maybe i'm not using the right solution for my original problem then. Can I try to explain what i'm doing and maybe you can suggest a *good* solution ?
[2014-03-04 13:47:42 -0500] mil0: I'm having some issues with getting my cookbook uploaded to our chef-server. IIRC I used to be able to just do knife upload path/to/cookbook --force, but that gives me a OperationNotAllowedError. And somehow knife upload cookbooks uploads from the cookbooks dir, not the specified cookbook_path
[2014-03-04 13:51:51 -0500] bmhatfield: jsfrerot: We can try :-)
[2014-03-04 13:52:19 -0500] jsfrerot: bmhatfield: here is a simplified code example of what i'm trying to do in a recipe: http://pastebin.com/D0AhWkLF
[2014-03-04 13:53:35 -0500] jsfrerot: bmhatfield: the copying section to the tmp directory gets executed after the template block. How should I proceed to make sure that everything gets executed one after the other
[2014-03-04 13:54:52 -0500] jsfrerot: I understand that there is the compilation part and the runtime part, but how do I make sure everything gets run in the same part to get the other right
[2014-03-04 13:55:05 -0500] jsfrerot: order*
[2014-03-04 13:57:14 -0500] bmhatfield: jsfrerot: a few things
[2014-03-04 13:57:23 -0500] mil0: figured it out: knife cookbook upload cookbook-name --force. the knife upload doc page is confusing
[2014-03-04 13:57:27 -0500] bmhatfield: First, check out the upstream sudo cookbook: https://github.com/opscode-cookbooks/sudo
[2014-03-04 13:57:56 -0500] bmhatfield: Second, chef generally backs up any file it changes into a backup path
[2014-03-04 13:58:51 -0500] bmhatfield: Third, if you want to ensure order-of-operations, you can chain resources with action :nothing and then use notifies :run (or whatever) to the next resource
[2014-03-04 13:59:26 -0500] jsfrerot: bmhatfield: the upstream sudo doesn't answer my needs and doesn't support all the sudoers feature. And for the backup, I rather check the syntax in a tmp area, then if everything is fine, I move the files to the real destination.
[2014-03-04 13:59:34 -0500] bmhatfield: kk
[2014-03-04 14:01:34 -0500] bmhatfield: It's pretty common for people to use the 'execute' resource to move files around as you're doing.
[2014-03-04 14:01:52 -0500] bmhatfield: I would use the execute resource, and notify from one to the other in the order you want things to happen
[2014-03-04 14:02:22 -0500] bmhatfield: things like %x{cp blablah} are happening BEFORE the chef run starts
[2014-03-04 14:02:25 -0500] bmhatfield: or rather
[2014-03-04 14:02:28 -0500] bmhatfield: before resources are converged
[2014-03-04 14:02:33 -0500] jsfrerot: bmhatfield: So maybe I should use execute instead of using ruby code directly, is that what you are suggestinG?
[2014-03-04 14:02:45 -0500] bmhatfield: For the actual moving of files on the system, yes
[2014-03-04 14:03:26 -0500] bmhatfield: also, directory has a "recursive" attribute you can use to create /tmp/sudo/sudoers.d/ in one call
[2014-03-04 14:03:51 -0500] bmhatfield: also the directory resource has a :delete action you can use to remove directories as needed
[2014-03-04 14:04:35 -0500] jsfrerot: bmhatfield: yeah I created a "def" to save some lines on the delete that I didn't include in pastebin
[2014-03-04 14:05:01 -0500] jsfrerot: but I have the same problem with def as when it is a ruby_block the def is not available :(
[2014-03-04 14:11:01 -0500] bmhatfield: As a thought exercise, try and see if you can reimplement this cookbook with only chef resouces
[2014-03-04 14:11:53 -0500] jsfrerot: bmhatfield: yeah will try to do that
[2014-03-04 14:13:41 -0500] jsfrerot: bmhatfield: is there a way with "execute" to do an action (delete a folder for example" if the execute fails ?
[2014-03-04 14:14:28 -0500] dalibro: 1
[2014-03-04 14:15:48 -0500] bmhatfield: Hrm, I think people have asked for "on failure" notifications but they don't exist as far as I am aware.
[2014-03-04 14:17:03 -0500] jsfrerot: bmhatfield: ok, so that's why i'm using ruby block so I can execute somthing and run specific stuff depending on the exit code
[2014-03-04 14:17:40 -0500] jsfrerot: but I guess I can do smaller ruby block and use chef resources when I can
[2014-03-04 14:21:47 -0500] bmhatfield: To be clear, my point in asking you to reimplement the cookbook as purely resources is because it seems as though you've tangled the execution phases (compilation vs convergence) in a fairly complicated way, a bit more complicated than is easy to unwind over IRC. Chef will be much more powerful for your overall if you let the tool do it's thing :-)
[2014-03-04 14:23:28 -0500] jsfrerot: bmhatfield: thx for your help
[2014-03-04 14:29:34 -0500] workmad3: bmhatfield: I guess the lack of an 'on_failure' notification is because the execute resource is really intended to fail the chef run if the command fails
[2014-03-04 14:30:05 -0500] workmad3: bmhatfield: if you wanted more control over things, the intention is to use ShellOut I believe :)
[2014-03-04 14:48:09 -0500] bmhatfield: workmad3: Totally. Just answering the question completely :-)
[2014-03-04 15:02:48 -0500] mstyne: is there a resource that will allow me to move/copy a directory on the node that isn't bash/execute/etc.
[2014-03-04 15:03:12 -0500] mstyne: very close to eliminating my last bash reference in this recipe
[2014-03-04 15:09:07 -0500] mattsurabian: mstyne: you mean move the directory and its contents?
[2014-03-04 15:09:24 -0500] mstyne: precisely
[2014-03-04 15:10:06 -0500] mattsurabian: I'm not aware of one :-(
[2014-03-04 15:10:29 -0500] potatoLives: Hi there !
[2014-03-04 15:10:31 -0500] mstyne: yeah, unfortunately I don't think such a thing exists
[2014-03-04 15:10:56 -0500] mstyne: I thought maybe I could mangle deploy into doing it, but that seems like overkill
[2014-03-04 15:11:17 -0500] potatoLives: i was already searching for some time over google and the community but im stuck in a part i really cant get my mind over it.... can someone help me ?
[2014-03-04 15:11:49 -0500] potatoLives: in simple im having this issue : "chef::exceptions::recipenotfound: could not find recipe epel for cookbook yum"
[2014-03-04 15:11:59 -0500] mattsurabian: yeah I mean if you wanted to avoid having random bash and execute calls, and you need to move a lot of directories you could setup a definition or something
[2014-03-04 15:12:15 -0500] mattsurabian: but still you'd need an execute or bash block within the definition
[2014-03-04 15:12:19 -0500] mstyne: potatoLives: epel got moved into its own cookbook
[2014-03-04 15:12:21 -0500] mstyne: yum-epel
[2014-03-04 15:12:36 -0500] mattsurabian: I imagine is has to move too, symlink won't work?
[2014-03-04 15:12:55 -0500] mattsurabian: I guess I'd explore why the directory is in the "wrong place" to begin with
[2014-03-04 15:13:07 -0500] mstyne: mattsurabian: I was actually trying something like that using ark
[2014-03-04 15:13:12 -0500] mstyne: maybe I'll revisit it
[2014-03-04 15:13:43 -0500] potatoLives: and i see when ched is in the stage of syncrhionizing books, it appears yum and yum-epel
[2014-03-04 15:14:04 -0500] potatoLives: but when it starts "compiling cookbooks..." it gives me that error
[2014-03-04 15:14:10 -0500] mstyne: ark + cherry_pick would work for me, if it wasn't broken for .tar.bz2 :)
[2014-03-04 15:14:25 -0500] mstyne: potatoLives: my guess is you're calling include_recipe 'yum::epel' somewhere
[2014-03-04 15:15:20 -0500] mstyne: maybe i'll just monkey patch my local ark cookbook and call it a day
[2014-03-04 15:16:01 -0500] mstyne: i'm sure it won't come back to bite me in the ass
[2014-03-04 15:16:06 -0500] mstyne: :/
[2014-03-04 15:17:31 -0500] mstyne: mattsurabian: anyway, thanks for responding; a rarity on #chef
[2014-03-04 15:17:43 -0500] mstyne: i'm just glad I wasn't missing something obvious
[2014-03-04 15:17:57 -0500] potatoLives: mstyne : hmm i check it and im not calling that...
[2014-03-04 15:18:21 -0500] mattsurabian: mstyne: no problem. It's tough there's so much to learn I know the feeling of "there has to be a way to do this" heh
[2014-03-04 15:18:24 -0500] mattsurabian: sometimes, there isn't :-(
[2014-03-04 15:18:25 -0500] potatoLives: i was trying to search for that on my cookbooks but it doesnt show that up
[2014-03-04 15:18:31 -0500] mstyne: potatoLives: maybe you have it in a role
[2014-03-04 15:18:39 -0500] orangeroo: Anyone know where I can find the chef client for Cisco Nexus switches?
[2014-03-04 15:18:39 -0500] mstyne: if you're using roles
[2014-03-04 15:19:00 -0500] potatoLives: yeah im using roles
[2014-03-04 15:19:03 -0500] potatoLives: i will check it out
[2014-03-04 15:20:10 -0500] potatoLives: hmm i checked it and its just calling my recipe i made
[2014-03-04 15:22:05 -0500] mstyne: maybe it's in the run_list for the ndoe?
[2014-03-04 15:22:06 -0500] mstyne: node
[2014-03-04 15:22:08 -0500] potatoLives: mstyne : do you know why he complains he doesnt have the recipe of epel on compiling cookbooks, when before he says "synchronizing cookbooks" and it appears there showing "yum-epel" and "yum"
[2014-03-04 15:22:52 -0500] mstyne: because for some reason yum::epel is being requested, and not yum-epel::default or just yum-epel
[2014-03-04 15:23:26 -0500] mstyne: and yum::epel doesn't exist
[2014-03-04 15:23:41 -0500] potatoLives: i go to the  default recipe of that node and i dont see any of those include_recipe
[2014-03-04 15:25:59 -0500] mstyne: potatoLives: got me, then
[2014-03-04 15:26:03 -0500] mstyne: sorry
[2014-03-04 15:29:33 -0500] gokr: Ehm... I am installing chef-server 11.10.4 on Ubuntu... but where is chef-server-ctl?
[2014-03-04 15:33:12 -0500] gleam: are you shipping something back?
[2014-03-04 15:33:14 -0500] gleam: whoops
[2014-03-04 16:03:08 -0500] hairyhenderson: hey folks, is there any way to add a run_list item to multiple nodes with the same command?
[2014-03-04 16:03:20 -0500] hairyhenderson: I see node run_list delete bulk, but no add bulk...
[2014-03-04 16:04:53 -0500] tcate: you could put them in a role and then add the role
[2014-03-04 16:05:09 -0500] tcate: that way updates in the future are just done to the role
[2014-03-04 16:08:10 -0500] roolo: would you recommend me to use librarian or berkshelf?
[2014-03-04 16:18:04 -0500] hairyhenderson: tcate: well sure, but that's the same problem... I still have to run_list add for each node where I want that role
[2014-03-04 16:23:26 -0500] tcate: yeah, I don't think there's an easy way to update them all, but if you move the run list to a role you will have an easy way to update that in the future
[2014-03-04 16:24:35 -0500] hairyhenderson: tcate: yep... :)
[2014-03-04 16:24:36 -0500] hairyhenderson: thanks anyways
[2014-03-04 16:25:42 -0500] bubu: workmad3: you about dude?
[2014-03-04 16:28:33 -0500] comjf: I'm writing my first cookbook, is it possible to have an metadata.rb depends based on an attribute
[2014-03-04 16:28:43 -0500] bubu: I've created a bla-java wrapper cookbook with Berkshelf. The recipe itself just does an include_recipe 'java', and depends on java in the metadata.rb. I set some attribute defaults (not overrides) in the cookbook to ensure that I get oracle java 7, not the default in the java cookbook which is openjdk 6. My vagrant box comes up with the correct version of Java. But when I berks upload the cookbook and run on a node, I get openjdk 6. Normal
[2014-03-04 16:28:44 -0500] bubu:  java defaults... any ideas?
[2014-03-04 16:29:10 -0500] comjf: so like if I set rails_env to development, then cookbook depends mysql::server
[2014-03-04 17:04:46 -0500] swalberg: Hi, I added the ssh-keys recipe to a role but when I run chef-client on my server I don't see it being run even with -l debug. The cookbook is on the server, it's in the role's run list on all the environments. Now sure where to debug from here, would appreciate some advice.
[2014-03-04 17:18:16 -0500] swalberg: When I run chef-client I do see it in the "resolving cookbooks for run list:" array
[2014-03-04 17:18:30 -0500] swalberg: config?
[2014-03-04 17:19:06 -0500] bean: swalberg: i'd double check your assumptions. Is that role in the correct run list, why are you using a role? Is that server assigned to the correct run list.
[2014-03-04 17:19:08 -0500] bean: err
[2014-03-04 17:19:10 -0500] bean: correct ENV
[2014-03-04 17:20:10 -0500] swalberg: bean: I have a base role that includes packages like ntp, sudo, etc. The cookbook shows up when I look at it in the _default and the appropriate environment
[2014-03-04 17:20:29 -0500] swalberg: Also seeing the cookbook name when I do the chef-client, just not in the list of actions
[2014-03-04 17:20:57 -0500] bean: so you see the cookbook in the run list when it loads, but it doesn't actually add your SSH key?
[2014-03-04 17:22:05 -0500] swalberg: yes. Maybe I'm not using the right language though, here's the output: https://gist.github.com/swalberg/02a350643d2a1d92143f
[2014-03-04 17:22:50 -0500] bean: swalberg: and you have node[:ssh_keys] defined?
[2014-03-04 17:23:26 -0500] swalberg: oh, hang on, it is ssh-keys not ssh_heys
[2014-03-04 17:23:33 -0500] AikiLinux: how can i check the java version in my recipe will node['java'['version'] do ?
[2014-03-04 17:24:19 -0500] bean: swalberg: and this is https://github.com/nickola/chef-ssh-keys right?
[2014-03-04 17:24:55 -0500] swalberg: Yea, I just have cookbook 'ssh-keys' in my Berksfile
[2014-03-04 17:25:04 -0500] bean: right,
[2014-03-04 17:25:15 -0500] bean: wait, you are using berkshelf but you're still using roles?
[2014-03-04 17:25:31 -0500] bean: use a role-cookbook, not an actual role :D
[2014-03-04 17:25:54 -0500] swalberg: Oh, ok, but is that the source of my problem?
[2014-03-04 17:26:09 -0500] bean: nope.
[2014-03-04 17:26:18 -0500] bean: I think you likely dont have the data defined for it to work on
[2014-03-04 17:26:34 -0500] bean: Attributes
[2014-03-04 17:26:34 -0500] bean: Expects node[:ssh_keys] to be an hash containing the user name as key and data bag user name as value.
[2014-03-04 17:26:44 -0500] swalberg: is there something that will tell me the output of the node hash for the node?
[2014-03-04 17:27:02 -0500] swalberg: Even if something were wrong with node[:ssh_keys] wouldn't it at least show that it was looking?
[2014-03-04 17:27:48 -0500] bean: maybe not, that recipe literally has "if node[:ssh_keys]" as its first line
[2014-03-04 17:27:58 -0500] bean: so if that's not defined it wont even log anything
[2014-03-04 17:28:48 -0500] swalberg: ah, ok
[2014-03-04 17:29:04 -0500] swalberg: Oh got it! I didn't save the s/ssh-keys/ssh_keys/ properly :(
[2014-03-04 17:29:27 -0500] swalberg: thank you!
[2014-03-04 17:33:46 -0500] bean: np
[2014-03-04 17:35:36 -0500] shlant: is there anyway to run minitest-handler without specifying it last in the run list? Or do I have to add it to the end of every role?
[2014-03-04 18:04:43 -0500] comjf: I feel like this is a common question that you guys get a lot, so can someone point me to the right article / documentation. How do I configure data bags to work with chef solo in use with vagrant. For instance, I want to install a github ssh key
[2014-03-04 18:10:46 -0500] jbz_: comjf: have a look here:  http://docs.opscode.com/chef_solo.html#data-bags
[2014-03-04 18:15:28 -0500] comjf: jbz_: I suppose I am looking for a more thorough tutorial as I have never used data bags before and don't know how to access them from one of my cookbooks
[2014-03-04 18:17:07 -0500] comjf: jbz_: I'll I'm trying to accomplish is to set the github ssh key so I can do a git clone. Any recommendations?
[2014-03-04 18:17:08 -0500] jbz_: comjf: Ah
[2014-03-04 18:17:52 -0500] jbz_: comjf: have you read this: http://docs.opscode.com/essentials_data_bags.html#use-data-bags
[2014-03-04 18:18:38 -0500] jbz_: At the bottom of that page is a note on how that page applies to chef-solo.
[2014-03-04 18:18:43 -0500] SFLimey_: Anyone know how to use the -ephemeral parameter for knife ec2 server create. I can't find any example syntax.
[2014-03-04 18:19:23 -0500] comjf: jbz_: I'll give it a whirl, thanks
[2014-03-04 18:23:48 -0500] shlant: can anyone see why my mintests aren't working?
[2014-03-04 18:23:49 -0500] shlant: https://gist.github.com/MrMMorris/cecf39f7ec159d5fdfbf
[2014-03-04 18:24:15 -0500] shlant: minitest works, just doesn't run any tests
[2014-03-04 18:35:14 -0500] programmerq: quick question-- I have a file in files/default that I'd like to refer to. do I have to write it out somewhere using cookbook_file, and then refer to it? or is it possible to calculate the path to the file in the chef cookbook cache directly?
[2014-03-04 18:35:28 -0500] programmerq: (I have a single custom .deb that I want to install)
[2014-03-04 18:36:23 -0500] programmerq: shlant: iirc, minitest looks for <recipename>_spec.rb
[2014-03-04 18:38:03 -0500] shlant: programmerq: the README says this (I am using 1.1.4):
[2014-03-04 18:38:04 -0500] shlant: Note: Version 0.1.0 added a change that breaks backward compatibility. The minitest-handler now only loads
[2014-03-04 18:38:05 -0500] shlant: test files named "_test.rb" rather than all test files in the path files/default/test/*_test.rb
[2014-03-04 18:38:51 -0500] shlant: does that mean all test files have to me names _test.rb?
[2014-03-04 18:38:57 -0500] shlant: typo?
[2014-03-04 18:39:04 -0500] shlant: be named*
[2014-03-04 18:42:55 -0500] benmoss: is there any special required to use pry with chef?
[2014-03-04 18:43:27 -0500] benmoss: i am putting a pry in my chef-solo run on a vagrant box, and it halts correctly and prints its context, but then I try to execute `1 + 1` and it never returns
[2014-03-04 19:06:01 -0500] rgeyer: I'm trying to create a wrapper recipe that runs build-essential at compile time.  I'm using node.override['build_essential']['compiletime'] = true; before including the recipe, however it does not seem to be executing at compile time.  Am I missing something?
[2014-03-04 19:09:08 -0500] cwj: rgeyer: weird, in my experience that works as expected.
[2014-03-04 19:09:51 -0500] cwj: is your wrapper specifying a version in its dependency on build-essential?
[2014-03-04 19:09:56 -0500] rgeyer: okay, It must be a simple oversight.. I've been battling with it for a while and can't seem to figure it out.. I did have a typo in that I was using build-essential rather than build_essential
[2014-03-04 19:10:14 -0500] rgeyer: No version specified, no..  I'm using Berks, and letting it grab the "latest"
[2014-03-04 19:11:00 -0500] cwj: if you want to gist your work i could take a look
[2014-03-04 19:11:15 -0500] rgeyer: I've got it in a fork, actually..
[2014-03-04 19:11:16 -0500] rgeyer: https://github.com/rgeyer-rs-cookbooks/route53/blob/needs_build_essential/recipes/default.rb#L20-L21
[2014-03-04 19:15:55 -0500] bubu: I've created a bla-java wrapper cookbook with Berkshelf. The recipe itself just does an include_recipe 'java', and depends on java in the metadata.rb. I set some attribute defaults (not overrides) in the cookbook to ensure that I get oracle java 7, not the default in the java cookbook which is openjdk 6. My vagrant box comes up with the correct version of Java. But when I berks upload the cookbook and run on a node in ec2, it uses the java
[2014-03-04 19:15:56 -0500] bubu:  cookbook on my hosted chef.
[2014-03-04 19:16:35 -0500] bubu: rgeyer: for your wrapper cookbooks, do you actually have the community cookbook forked on your chef server?
[2014-03-04 19:17:47 -0500] rgeyer: bubu: I'm actually using chef-solo with Vagrant and Berkshelf, so no chef server in the mix yet.  I'm *pretty* sure that I'm updating the local cookbook cache with Berkshelf, I'm actually doing a vagrant destroy/up at the moment to make certain
[2014-03-04 19:18:17 -0500] bubu: rgeyer: right, locally thats what your doing and it works
[2014-03-04 19:18:18 -0500] bubu: :D
[2014-03-04 19:19:15 -0500] bubu: but if I want to actually use this in production, with a chef server, am I going to have to fork the community cookbook onto my chef server, or does Berkshelf deal with the dep and loading the community cookbook on my production node too?
[2014-03-04 19:20:16 -0500] bubu: I'd think the latter but its loading the 'java' cookbook from hosted chef :(
[2014-03-04 19:20:30 -0500] comjf: jbz_: when I'm following that guide on how to use databags, I keep getting [2014-03-04T19:19:44+00:00] ERROR: can't convert Array into String
[2014-03-04 19:20:37 -0500] evaryont: Hello #chef. I want to set up vagrant to set up a developer node, not for infrastructure testing. How do I set up chef-zero? (We use search a lot)
[2014-03-04 19:22:17 -0500] rgeyer: bubu: The cookbook that gets used for java will depend upon what's uploaded to your chef server.  So, if you're using Berks to manage that locally you'd have to do a berks upload to get the right version of the java cookbook on your server
[2014-03-04 19:22:46 -0500] bubu: rgeyer: Right, and I have..
[2014-03-04 19:23:20 -0500] rgeyer: And yet somehow when your wrapper runs, it get's the community java cookbook?  Seems... Impossible.. hah
[2014-03-04 19:23:49 -0500] bubu: locally with vagrant is fine
[2014-03-04 19:23:58 -0500] evaryont: has anyone gotten chef-zero & vagrant to work?
[2014-03-04 19:24:06 -0500] AntelopeSalad: if i want to interact with a remote git repo (pull it, use ssh keys.) i should be using the git resource that's built into chef right?
[2014-03-04 19:24:24 -0500] jkeiser: There is a vagrant-chef-zero plugin
[2014-03-04 19:24:25 -0500] bubu: but on an actual node, the wrapper runs, but pulls in the java cookbook from my hosted chef, _not_ the community, which is what it does in vagrant and what I want
[2014-03-04 19:24:29 -0500] jkeiser: I haven't used it, but other have
[2014-03-04 19:25:02 -0500] evaryont: jkeiser: it doesn't work. There is some conflict in a monkey patch for Array#slice between il18n & activesupport
[2014-03-04 19:25:14 -0500] shlant: AntelopeSalad: that's the easiest way, yes
[2014-03-04 19:25:16 -0500] jkeiser: oh goodie
[2014-03-04 19:26:00 -0500] bubu: rgeyer: https://gist.github.com/joshmyers/587b274cf4c0013e70aa
[2014-03-04 19:26:03 -0500] AntelopeSalad: shlant: ok thanks, i just thought maybe there was a popular cookbook that kind of build around it
[2014-03-04 19:26:11 -0500] shlant: bubu: are you using the vagrant-berkshelf plugin with vagrant?
[2014-03-04 19:26:20 -0500] rgeyer: bubu: You have your vagrantfile and berksfile handy?
[2014-03-04 19:26:22 -0500] jkeiser: evaryont: well you could use chef-metal to converge a development node against a local chef_repo_path
[2014-03-04 19:26:32 -0500] bubu: shlant: yes
[2014-03-04 19:27:09 -0500] shlant: bubu: can you post a gist of your berkfile and wrapper cookbook?
[2014-03-04 19:27:17 -0500] jkeiser: evaryont: if you don't mind alpha stuff
[2014-03-04 19:27:30 -0500] jkeiser: evaryont: (i.e. it's working for me and a few others :)
[2014-03-04 19:27:41 -0500] shlant: AntelopeSalad: not that I know of. I actually wrap a custom LWRP around the git resource to set default values
[2014-03-04 19:27:57 -0500] evaryont: jkeiser: interesting.
[2014-03-04 19:28:27 -0500] bubu: rgeyer: sure, but like I say, locally with vagrant works fine, it uses my wrapper and pulls the commuity java cookbook into ~/.berkshelf. But on an actual node, after doing a berks upload bla-java, it's still pulling the java cookbook from my hosted chef.
[2014-03-04 19:28:58 -0500] evaryont: jkeiser: actually that looks pretty damn close to what I want
[2014-03-04 19:29:13 -0500] evaryont: jkeiser: do you have a gist or something that's a quickstart?
[2014-03-04 19:29:36 -0500] jkeiser: evaryont: the "myapp" cookbook there is pretty much a quick start, but I can build a quicker one in a sec
[2014-03-04 19:29:56 -0500] bubu: shlant: https://gist.github.com/joshmyers/587b274cf4c0013e70aa
[2014-03-04 19:30:01 -0500] AntelopeSalad: shlant: ok yeah, that was my plan of attack once i got it all working how i want
[2014-03-04 19:30:08 -0500] evaryont: jkeiser: I imagine that the machine do/end blocks are pretty similar in respect to Vagrant's vm.define?
[2014-03-04 19:30:54 -0500] rgeyer: bubu: is the version number for the java cookbook the same between yours and the community cookbook? I wonder if the upload "appears" to be working, but is not overwriting your cookbook.
[2014-03-04 19:31:13 -0500] jkeiser: evaryont: not entirely.  You specify Vagrant's options in a separate place--your logical and physical definitions are separate (though you can put them in the same file)
[2014-03-04 19:31:18 -0500] jkeiser: Check these two recipes out
[2014-03-04 19:31:37 -0500] jeffcara: new scenario involving putting together a chef run.
[2014-03-04 19:31:38 -0500] jeffcara: I am trying to write multiple lines to a file using different recipes. Whenever I run the recipes one by one they write to the file no problem. However, whenever I include more than one of these cookbooks in the run_list it will always overwrite the previous cookbooks lines that was inserted. Guess it has to do with chef using a cached copy, but I don't know the correct workaround to this.
[2014-03-04 19:31:44 -0500] jeffcara: any suggestions?
[2014-03-04 19:31:59 -0500] jkeiser: evaryont: this recipe tells chef-metal to use Vagrant, put the VMs in ~/machinetest, and pull cookbooks and other data from ~/machinetest/repo: https://github.com/opscode/chef-metal/blob/master/cookbooks/myapp/recipes/vagrant.rb
[2014-03-04 19:32:26 -0500] jkeiser: evaryont: *this* recipe specifically tells chef-metal to use Linux: https://github.com/opscode/chef-metal/blob/master/cookbooks/myapp/recipes/linux.rb
[2014-03-04 19:32:31 -0500] bubu: when you do a berks upload, what environment does it upload it to? we have several environments..
[2014-03-04 19:32:51 -0500] jkeiser: evaryont: (you can pass provisioner_options that let you do vm.config stuff too, a la https://github.com/opscode/chef-metal/blob/master/cookbooks/myapp/recipes/windows.rb)
[2014-03-04 19:33:11 -0500] jkeiser: evaryont: and this is the recipe that actually defines the machines: https://github.com/opscode/chef-metal/blob/master/cookbooks/myapp/recipes/small.rb
[2014-03-04 19:33:21 -0500] evaryont: jkeiser: so what, the idea is that you run chef-client in the host machine..and a result of the converge is that a vagrant vm is running?
[2014-03-04 19:33:27 -0500] jkeiser: Yep
[2014-03-04 19:33:35 -0500] evaryont: kinda trippy :P
[2014-03-04 19:33:44 -0500] jkeiser: chef-client -z -o myapp::vagrant,myapp::linux,myapp::small
[2014-03-04 19:33:49 -0500] jkeiser: And you can put it all in one recipe
[2014-03-04 19:33:58 -0500] jkeiser: Believe me, it gets trippier, and awesomer :)
[2014-03-04 19:34:31 -0500] rgeyer: bubu: It just upload the cookbook to the "global" cookbook repository.  You can do a berks apply to set the specific versions of cookbooks on a specified environment.
[2014-03-04 19:34:36 -0500] jkeiser: Because it's in a recipe, we get a *lot* of important stuff (such as order of operations, logging, and non-machine resources) for free or cheap
[2014-03-04 19:34:52 -0500] bubu: rgeyer: no the version of java on our chef server is much older than the community java cookbook version, just checked
[2014-03-04 19:35:01 -0500] jkeiser: Also because it's in a recipe, it can be run on your cluster repeatedly, so you can change your infrastructure by uploading a cookbook
[2014-03-04 19:35:21 -0500] rgeyer: bubu: Yeah, so I'd do a berks apply <name of your target environment>
[2014-03-04 19:35:27 -0500] jkeiser: Also because it can run in a cluster, you can do auto-scaling (1.upto(n) do machine ... end)
[2014-03-04 19:35:40 -0500] rgeyer: That should set the java cookbook version to that of the community cookbook (verify that after you've done it) and solve the problem.
[2014-03-04 19:35:44 -0500] evaryont: jkeiser: this is all meant to be ran on dev laptops not clusters :P
[2014-03-04 19:35:53 -0500] evaryont: jkeiser: but yeah, there are possibilities
[2014-03-04 19:35:54 -0500] jkeiser: I understand :)  That's an important scenario too
[2014-03-04 19:36:06 -0500] jkeiser: Just saying it has a really interesting road ahead
[2014-03-04 19:36:18 -0500] evaryont: jkeiser: you know about puppetlab's Razor?
[2014-03-04 19:36:35 -0500] evaryont: might be able to borrow their PXE work
[2014-03-04 19:37:15 -0500] jkeiser: Yep.  PXE is on the map. I'm not sure yet whether their design quite matches the scenarios, but we do plan to borrow liberally from everyplace that has good ideas :)
[2014-03-04 19:37:30 -0500] jkeiser: Anyway, for you, if you are using a recent chef-client version, it can be even easier (a little)
[2014-03-04 19:37:49 -0500] jkeiser: Make a single .rb file with all those directives in it (vagrant_cluster, vagrant_box, with_chef_local_server, and machine)
[2014-03-04 19:37:51 -0500] jkeiser: And do this:
[2014-03-04 19:38:03 -0500] jkeiser: chef-client -z givemeagoddamndevmachine.rb
[2014-03-04 19:38:10 -0500] bubu: rgeyer: right, thats changed the version for the env
[2014-03-04 19:38:11 -0500] evaryont: jkeiser: nice file name :P
[2014-03-04 19:38:13 -0500] bubu: let's rechef :D
[2014-03-04 19:38:38 -0500] evaryont: I assume 11.10.4 is 'recent enough'
[2014-03-04 19:38:47 -0500] mhenrixon: Anyone able to answer if I need to configure the app servers to serve SSL behind the proxy? Is it enough if the proxy answers on SSL and just does a proxy_pass to the upstream ? proxy_pass http://backend;/
[2014-03-04 19:38:48 -0500] jkeiser: It's early days but local dev and CI on vagrant are the first things we got working and the primary thing most of us work with
[2014-03-04 19:39:14 -0500] jkeiser: evaryont: yeah, I think that's probably the most recent.  Definitely requires the most recent minor revision
[2014-03-04 19:39:38 -0500] evaryont: jkeiser: you don't specify that version contraint in the gemspec ;)
[2014-03-04 19:39:57 -0500] jkeiser: evaryont: it's not required to run chef-metal the way it specifies in the README :)
[2014-03-04 19:40:08 -0500] jkeiser: evaryont: that's only if you want to run chef-client -z RECIPENAME.rb
[2014-03-04 19:40:18 -0500] Majost: Is there a trick to getting ohai node attributes accessible to an lwrp?
[2014-03-04 19:40:52 -0500] Majost: I have this in my resource: attribute :root_group,  :kind_of => String,       :default => node['root_group']
[2014-03-04 19:41:05 -0500] jkeiser: evaryont: The README specifies chef-client -z -o myapp::recipe name, and requires you to put your recipes in cookbooks/myapp/recipes
[2014-03-04 19:41:06 -0500] Majost: but the value doesn't seem to complete when the result is rendered
[2014-03-04 19:41:28 -0500] jkeiser: evaryont: latest Chef doesn't give a crap where you put the recipe, and lets you say chef-client -z recipe.rb
[2014-03-04 19:41:43 -0500] jkeiser: I just like the experience better :)
[2014-03-04 19:47:43 -0500] evaryont: jkeiser: how do you manipulate synced folders? And add other provisioners beyond chef? (Shell script I use to bootstrap the vagrant box)
[2014-03-04 19:49:10 -0500] jkeiser: evaryont: everything that you manipulate about vagrant, you manipulate using provisioner_options.  For example, see https://github.com/opscode/chef-metal/blob/master/cookbooks/myapp/recipes/windows.rb
[2014-03-04 19:49:49 -0500] evaryont: jkeiser: in what context are the keys executed? Basically 'eval vm.#{key} = #{value}'?
[2014-03-04 19:50:07 -0500] jkeiser: evaryont: they are dumped straight to a Vagrantfile
[2014-03-04 19:50:18 -0500] jkeiser: Which is then used for vagrant up
[2014-03-04 19:50:45 -0500] jkeiser: evaryont: vagrant_options look like config.vm.key = value, I think you are right there
[2014-03-04 19:50:56 -0500] jkeiser: evaryont: vagrant_config is a string which is literally dumped verbatim into the file
[2014-03-04 19:51:08 -0500] jkeiser: evaryont: so you can do things like config.vm.network that are not strictly key/value pairs
[2014-03-04 19:51:43 -0500] jkeiser: evaryont: you *should* be able to do absolutely any vagrant configuration you desire with that
[2014-03-04 19:54:07 -0500] evaryont: jkeiser: with chef-metal, is vagrant-omnibus uneccessary now?
[2014-03-04 20:03:41 -0500] jkeiser: evaryont: I'm not sure what vagrant-omnibus does, to be honest.  Doesn't that manage servers for building omnibus projects?
[2014-03-04 20:03:58 -0500] jkeiser: I don't think it's obsolete, but it's possible many things that used to have to be plugins will be defined as metal recipes
[2014-03-04 20:20:26 -0500] mattray: jkeiser: vagrant-omnibus uses chef omnibus packages
[2014-03-04 20:20:41 -0500] mattray: probably should be called vagrant-chef-client-omnibus
[2014-03-04 20:42:18 -0500] sebgar: hi
[2014-03-04 20:42:47 -0500] sebgar: no one here?
[2014-03-04 20:43:03 -0500] jbz_: ?
[2014-03-04 20:43:06 -0500] scalp42: plenty of people
[2014-03-04 20:43:30 -0500] sebgar: cool
[2014-03-04 20:44:05 -0500] sebgar: i just have a quick question, maybe someone can help me. are all chef client versions compatible with all chef server versions?
[2014-03-04 20:44:20 -0500] sebgar: I can't find a compatibility chart
[2014-03-04 20:45:57 -0500] jbz_: generally, you want to stick to major versions
[2014-03-04 20:46:59 -0500] sebgar: right. But I wonder if upgrading my chef server could eventually mean upgrading all my chef clients
[2014-03-04 20:55:55 -0500] sanguisdex: is here or #nagios a better place to discuss the nagios cookbook?
[2014-03-04 21:23:13 -0500] Otterley: can automatic attributes created with Ohai plugins share an attribute namespace with normal and default attributes?
[2014-03-04 21:23:44 -0500] Otterley: e.g. node["foo"]["bar"] is set by a role, while node["foo"]["quux"] is set by an Ohai plugin
[2014-03-04 21:26:00 -0500] AntelopeSalad: stupid question incoming: is it a bad idea to put your id_rsa in version control? (the non-pub one), i'm attempting to setup an sshwrapper for the git resource
[2014-03-04 21:26:16 -0500] Otterley: YES
[2014-03-04 21:26:26 -0500] Otterley: never ever put secrets in a VCS
[2014-03-04 21:26:38 -0500] AntelopeSalad: i'm already handling public uses with the user resource and i figured if possible i wouldn't mind placing both the rsa pub and rsa keys directly in an attribute
[2014-03-04 21:26:42 -0500] AntelopeSalad: instead of messing with templates
[2014-03-04 21:27:05 -0500] Otterley: don't store secrets in a chef server either.
[2014-03-04 21:27:22 -0500] Otterley: (unencrypted ones, anyway)
[2014-03-04 21:27:32 -0500] AntelopeSalad: i'm using encrypted data bags for passwords already, i guess i'll just encrypt the non-pub key?
[2014-03-04 21:27:48 -0500] Otterley: you don't need encrypted data bags for passwords if they're already hashed.
[2014-03-04 21:27:52 -0500] AntelopeSalad: and then write it to the file
[2014-03-04 21:28:01 -0500] evaryont: jkeiser: vagrant-omnibus just downloads & installs chef via the omnibus package
[2014-03-04 21:28:31 -0500] Otterley: I don't consider encrypted data bags secure enough, personally.  Pop one box and the key is open to the attacker for all secrets.
[2014-03-04 21:28:32 -0500] AntelopeSalad: Otterley: i was using it to store unhashed passwords for things like database passwords and secret tokens (session tokens in an app server)
[2014-03-04 21:28:41 -0500] therealkoopa: Are there any examples of using the opscode users cookbook? I'm just trying to get started with it, and when I run the chef-client on a node, it doesn't create the user. I just noticed the default recipes is blank, saying you need to use LWRPs.
[2014-03-04 21:28:43 -0500] jkeiser: evaryont: ah.  Yeah, metal does that too
[2014-03-04 21:30:02 -0500] mbaxa: therealkoopa: https://github.com/opscode-cookbooks/users/blob/master/README.md seems pretty clear
[2014-03-04 21:30:36 -0500] mbaxa: you need a users data bag then an item for each user
[2014-03-04 21:31:26 -0500] euphy: is it possible to add a run list to an environment?
[2014-03-04 21:31:42 -0500] Otterley: no.
[2014-03-04 21:31:48 -0500] Otterley: use roles for that.
[2014-03-04 21:31:57 -0500] euphy: ok, thanks for the confirmation
[2014-03-04 21:32:04 -0500] Otterley: what you think are environments aren't, really.  they're mainly useful for pinning cookbook versions to nodes.
[2014-03-04 21:32:10 -0500] therealkoopa: I have a role, so can I just put include_recipe "users" in that role?
[2014-03-04 21:32:24 -0500] therealkoopa: I've been putting in the run list, but that doesn't seem to work
[2014-03-04 21:36:31 -0500] shlant: therealkoopa: you use include_recipe inside recipes. in roles you use "run_list": [
[2014-03-04 21:36:32 -0500] shlant: "recipe[foo]",
[2014-03-04 21:36:32 -0500] shlant: "recipe[bar]"
[2014-03-04 21:36:33 -0500] shlant: ],
[2014-03-04 21:36:59 -0500] therealkoopa: shlant: Okay, so I need a wrapper cookbook around the opscode community users cookbook?
[2014-03-04 21:38:05 -0500] shlant: therealkoopa: you could do that, yes. something like "run_list": [
[2014-03-04 21:38:06 -0500] shlant: "recipe[my-users]"
[2014-03-04 21:38:06 -0500] shlant: ],
[2014-03-04 21:38:12 -0500] shlant: and then in the my-users recipe
[2014-03-04 21:38:20 -0500] shlant: you would have include_recipe "users"
[2014-03-04 21:38:28 -0500] therealkoopa: shlant: Perfect, thanks
[2014-03-04 21:39:03 -0500] euphy: thanks Otterley
[2014-03-04 21:40:24 -0500] mjuszczak: What's the roll-out rate for 14.04 going to be like for most orgs?  Will most Opscode chef recipies work with it when it's released or will there be a few months lag?
[2014-03-04 21:41:06 -0500] gchristensen: mjuszczak: I would expect several months
[2014-03-04 21:41:35 -0500] shlant: therealkoopa: let me know if you run into issues. I actually JUST implemented that and the sudo cookbook
[2014-03-04 21:41:44 -0500] shlant: some headaches involved
[2014-03-04 21:42:17 -0500] therealkoopa: shlant: I'm 3 hours into chef configs, so I'm still trying to figure out the best practices and conventions so the project doesn't get too messy
[2014-03-04 21:42:56 -0500] mjuszczak: gchristensen: So for new deployments, you recommend 12.04?
[2014-03-04 21:43:17 -0500] Otterley: mjuszczak: if it ain't broke, don't fix it
[2014-03-04 21:43:29 -0500] Otterley: most orbs take at least a year after a new release to get up to date, if not longer
[2014-03-04 21:43:31 -0500] Otterley: *orgs
[2014-03-04 21:43:32 -0500] shlant: 12.04 4 lyf
[2014-03-04 21:44:20 -0500] Otterley: we only upgrade to a new release if support is ending, the current release doesn't support our new hardware, or there's some security fix that's not available for the older release
[2014-03-04 21:45:02 -0500] gchristensen: mjuszczak: I'd recommend trying new releases but not putting too much effort in until you have to. and then, roll out new servers with it and decom old ones.
[2014-03-04 21:45:06 -0500] Otterley: upgrading introduces all sorts of unknowns that need testing
[2014-03-04 21:45:28 -0500] evaryont: mjuszczak: and 12.04 will still be supported for 3 more years.
[2014-03-04 21:45:42 -0500] shawn_sher: We'll all have different jobs by then
[2014-03-04 21:46:10 -0500] divbell_: haha
[2014-03-04 21:47:14 -0500] mjuszczak: Otterley, gchristensen, evaryont: we were hoping to pull SSH keys out of chef and use SSSD, but SSSD in Ubuntu 12.04 is missing a few pieces of support, and so is OpenSSH (which is fixed since 13.10).
[2014-03-04 21:48:24 -0500] shlant: anyone been experiencing git clone issues today?
[2014-03-04 21:48:57 -0500] gchristensen: git clone works great for me
[2014-03-04 21:49:11 -0500] gchristensen: but maybe you mean, from github?
[2014-03-04 21:49:18 -0500] evaryont: shlant: I assume you're referring clones from github?
[2014-03-04 21:50:56 -0500] geggam: http://www.datacenterrapbattle.com/ <--- this is a good channel for this
[2014-03-04 21:51:20 -0500] tara_h: hey, had anybody ever tried using the fpm cookbook?  It doesn't appear to work, and yet it exists in the opscode repo
[2014-03-04 21:51:37 -0500] tara_h: I think I must be missing something
[2014-03-04 21:53:48 -0500] mjuszczak: So after a bunch of research for a new chef deployment, I decided to run with the berkshelf method.  Skipping roles, using role cookbooks, chef server 11 on Ubuntu 12.04, local vagrant development (possibly with test kitchen, or maybe straight vagrant, haven't figured that out yet), cookbooks in their own git repos (vs. a site_cookbooks directory).  Anyone have any major disagreements with a workflow like that?  Team of about 5 folks editing/managing
[2014-03-04 21:54:05 -0500] shlant: evaryont: yea it seems to be intermitant and it's starting to become a PITA
[2014-03-04 21:55:10 -0500] evaryont: mjuszczak: I would caution against entirely skipping roles. See http://www.getchef.com/blog/2013/11/19/chef-roles-arent-evil/
[2014-03-04 21:55:29 -0500] evaryont: shlant: Odd. I don't have a major problem :S Where are you located? I'm in Phoenix, AZ
[2014-03-04 21:58:13 -0500] shlant: evaryont: montreal, QC
[2014-03-04 21:58:25 -0500] shlant: I might just be going crazy ;)
[2014-03-04 21:59:12 -0500] shlant: geggam: that was brilliant
[2014-03-04 22:00:04 -0500] geggam: i didnt make it shlant ...ran across it on linkedin
[2014-03-04 22:00:27 -0500] geggam: what is funny to me is you can do both ... physical and automation :)
[2014-03-04 22:00:33 -0500] jtimberman: tara_h: what "opscode repo"? The community site? Anyone can upload any kind of cookbook (working or not) to the community site. Chef (nee Opscode) does not review cookbooks for content.
[2014-03-04 22:02:56 -0500] therealkoopa: shlant: I included the receipe "users" and when I run it, it still doesn't create the user. I also have data_bags/users/app.json... What headaches did you run into?
[2014-03-04 22:03:14 -0500] tara_h: jtimberman: yeah, I had this fantasy that they were
[2014-03-04 22:03:15 -0500] tara_h: silly me
[2014-03-04 22:06:47 -0500] shlant: therealkoopa: what does your app.json data bag look like? is the user a part of the sysadmin group?
[2014-03-04 22:07:38 -0500] therealkoopa: shlant: https://gist.github.com/anonymous/b03be521859ad5434aa4
[2014-03-04 22:10:16 -0500] shlant: therealkoopa: yea so basically the users cookbook creates a sysadmin group by default and that's it. If you want to create and add users to another group ("admin" group in your case) you have to use the LWRP. So in your users wrapper cookbook, you'd have:
[2014-03-04 22:10:17 -0500] shlant: users_manage "admin" do
[2014-03-04 22:10:17 -0500] shlant:  group_id <some_id>
[2014-03-04 22:10:18 -0500] shlant:  action [ :remove, :create ]
[2014-03-04 22:10:19 -0500] shlant: end
[2014-03-04 22:10:48 -0500] therealkoopa: shlant: Ah! Thanks
[2014-03-04 22:10:51 -0500] shlant: that would create the admin group and add any users that are a part of it
[2014-03-04 22:14:15 -0500] therealkoopa: shlant: And it worked, much thanks
[2014-03-04 22:15:26 -0500] mjuszczak: evaryont: So you'd use roles, but just have that contain a runlist, right?  But then aren't you restricted from launching servers with a newer, for instance, mariadb cookbook in production while keeping old mariadb servers at bay?  Since they'd all have the same role?
[2014-03-04 22:16:09 -0500] mjuszczak: evaryont: I figured by skipping roles, I can say that server A has this version of the mariaDB role cookbook and server B has this version of the mariaDB role cookbook.
[2014-03-04 22:17:00 -0500] evaryont: mjuszczak: and a few select attributes
[2014-03-04 22:17:19 -0500] evaryont: mjuszczak: mostly in the case of, e.g. the postgresql opscode cookbook, that specifies the version of postgresql
[2014-03-04 22:17:29 -0500] shlant: mjuszczak: basically the idea for wrapper roles is that instead of having a bunch of recipes in a run_list on the role, you move them to one "wrapper cookbook" as include_recipes and then that roles has ONLY that wrapper cookbook in the run_list
[2014-03-04 22:17:38 -0500] evaryont: the attributes then build upon each other (e.g. /var/lib/pg/<VERSION>/data/, etc)
[2014-03-04 22:18:35 -0500] evaryont: mjuszczak: and for the mariadb versions, I'd usually specify that in environments.
[2014-03-04 22:19:01 -0500] evaryont: mjuszczak: where environments aren't just production/staging/dev, but actually app1-prod, app2-prod, app3-prod, app1-staging, etc
[2014-03-04 22:20:54 -0500] evaryont: I use environments less so as "these are important" and instead more like "these are directly related to each other"
[2014-03-04 22:22:41 -0500] shlant: can anyone help me understand why I am missing files on my node? I have tests in a cookbook and I can see them on the chef server, but when I run chef on the node, /var/chef/cache/cookbooks/<cookbook>/files/default is missing the tests folder
[2014-03-04 22:23:18 -0500] shlant: it seems random. the test folder is missing and a couple root files, but there are two other folders that ARE there
[2014-03-04 22:23:21 -0500] shlant: so confuseed
[2014-03-04 22:23:48 -0500] rdobbsjrjr: Has anyone ever run into a weird issue with the chef rvm cookbook (fnichols) where when doing a user_install during a chef-run it prompts you to use sudo to run apt-get update from the user you're installing rvm into?
[2014-03-04 22:33:36 -0500] mjuszczak: evaryont: interesting.  So you don't have prod/staging/dev, your environments are more separating out your apps into different groupings.
[2014-03-04 22:38:27 -0500] evaryont: mjuszczak: indeed!
[2014-03-04 22:38:54 -0500] evaryont: mjuszczak: we also have groups for each actual environments, e.g. there is a production environment for app1, and a development one, etc.
[2014-03-04 22:39:30 -0500] kitopastorino: rdobbsjrjr: I'm running into something similar when doing a bundle install instead of a apt-get update
[2014-03-04 22:40:11 -0500] law: hey all, I'm having a heck of a time getting the Opscode sudo cookbook to play nice for some reason
[2014-03-04 22:41:18 -0500] law: here's the full stack - http://pastebin.com/EicmeYsD
[2014-03-04 22:41:34 -0500] law: 'undefined method `each' for "wheel":String'
[2014-03-04 22:41:45 -0500] law: I have no idea what it's even trying to do, or why it's doing it
[2014-03-04 22:43:53 -0500] mjuszczak: evaryont: Do you put everything in a single chef repo, or do you split out custom cookbooks into individual repos?
[2014-03-04 22:43:55 -0500] scalp42: law looks like 'wheel' should be ['wheel']
[2014-03-04 22:44:46 -0500] scalp42: law if you look at the readme, groups should be an array
[2014-03-04 22:45:04 -0500] scalp42: hopefully it helps :)
[2014-03-04 22:45:31 -0500] law: I don't know where that gets set
[2014-03-04 22:45:34 -0500] evaryont: mjuszczak: bosses are a bit cheap on private github repos, and we started *years* ago and kinda ignored the community (chef 0.9!) so we're in the process of migrating to berkshelf + upstreams in site-cookbooks/
[2014-03-04 22:46:16 -0500] scalp42: law the default from the cookbook is: https://github.com/opscode-cookbooks/sudo/blob/master/attributes/default.rb#L20
[2014-03-04 22:46:34 -0500] evaryont: mjuszczak: so we have cookbooks/wrapper-nginx/ -> upstreams/nginx
[2014-03-04 22:46:41 -0500] scalp42: you must be setting wheel somewhere (check environments, recipes where you're using sudo cookbook)
[2014-03-04 22:48:59 -0500] law: yar, recursive-grepping now.  thanks for the tip!
[2014-03-04 22:49:00 -0500] mjuszczak: evaryont: Got it.  So you're putting your custom cookbooks in cookbooks (whether a wrapper or an actual cookbook you've written), and upstreams inside upstreams?  What are you using site-cookbooks for?  I'm confusd.
[2014-03-04 22:49:14 -0500] scalp42: np
[2014-03-04 22:49:29 -0500] Drewzar: On hosted chef, if you change your account email address dose that change or invalidate your user/client key?
[2014-03-04 22:50:01 -0500] scalp42: think that if it's trying to do .each on a string, then the cookbook is expecting an Array or a Hash
[2014-03-04 22:50:12 -0500] evaryont: mjuszczak: sorry, I mixed words. we have a cookbooks/ directory and a upstreams/ directory. upstreams/ is emtpy/gitignored, and filled in via berkshelf. cookbooks/ is all wrappers and "role"-books. All of it is packaged up into our chef server.
[2014-03-04 22:50:21 -0500] evaryont: mjuszczak: well, that's what we want to go to, but it's not there yet :)
[2014-03-04 22:50:24 -0500] FireBeyond: How can I see what nodes use a role?
[2014-03-04 22:50:34 -0500] scalp42: curious but evaryont, have you looked at bitbucket?
[2014-03-04 22:51:08 -0500] evaryont: scalp42: $WORK had before, but it was before bitbucket had git support so went with github. Add almost 5 years, hard to change now :)
[2014-03-04 22:51:18 -0500] scalp42: right I feel you
[2014-03-04 22:52:19 -0500] mjuszczak: evaryont: I like that setup a lot.  Where are you putting your custom cookbooks that aren't wrappers or role books?  Say you had to write a cookbook for SSSD and it didn't exist.
[2014-03-04 22:52:55 -0500] evaryont: mjuszczak: oh, in cookbooks/, too. Haven't had that happen yet, we aren't a very esoteric company, tech wise :)
[2014-03-04 22:53:06 -0500] evaryont: rails + java + rabbitmq. nothin' special.
[2014-03-04 22:53:44 -0500] evaryont: mjuszczak: though preferably you would create said SSSD cookbook and upload to opscode community :D
[2014-03-04 22:56:59 -0500] mjuszczak: evaryont: Got it.  Makes a lot of sense.  How do you tell berkshelf to put stuff into upstream when you do berks install?
[2014-03-04 22:57:06 -0500] brucelee_: trying to mount /var/log into another partition
[2014-03-04 22:57:09 -0500] brucelee_: anyone know how i can do that?
[2014-03-04 22:57:12 -0500] evaryont: mjuszczak: working on that, hah.
[2014-03-04 22:57:19 -0500] brucelee_: i basically mounted a partition over /var/log, and put it in the fstab, and restarted
[2014-03-04 22:57:29 -0500] brucelee_: now i see dmesg in the new partition located @ /var/log
[2014-03-04 22:57:32 -0500] brucelee_: but i dont see the othe rlogs like maillog
[2014-03-04 22:57:33 -0500] brucelee_: etc
[2014-03-04 22:57:34 -0500] brucelee_: :/
[2014-03-04 22:57:36 -0500] evaryont: mjuszczak: would you want a write up on this workflow?
[2014-03-04 22:57:54 -0500] brucelee_: think im in the wrong channel :
[2014-03-04 22:57:54 -0500] brucelee_: :p
[2014-03-04 22:57:55 -0500] brucelee_: sorry
[2014-03-04 22:58:04 -0500] evaryont: could probably whip up a markdown and throw it somewhere
[2014-03-04 22:58:41 -0500] schuckles: Wondering if someone can recommend a good sensu + graphite cookbook?
[2014-03-04 22:59:02 -0500] mjuszczak: evaryont: yeah!  That would be awesome.
[2014-03-04 23:04:33 -0500] tball: schuckles: We use the sample wrapper cookbook from https://github.com/portertech/chef-monitor as a guide and wrote our own cookbook to install Sensu how we needed it for our environment
[2014-03-04 23:05:04 -0500] schuckles: thx, looking at it now
[2014-03-04 23:06:04 -0500] tball: The base sensu cookbook from https://github.com/sensu/sensu-chef is a good resource too - thats what chef-monitor wraps
[2014-03-04 23:06:59 -0500] mjuszczak: So when y'all use role cookbooks, is that where you end up putting your .kitchen.yml files?  Also, is there a "base" role cookbook that ends up getting a test kitchen file too?  I understand how to test a single cookbook with test kitchen, but how do most folks apply multiple cookbooks to a vagrant instance?  IE: you want to test a PostgreSQL server, which involves a ton of recipies from a bunch of different setups.
[2014-03-04 23:25:55 -0500] ron__: Hello.  I am bootstrapping a new node, and it failed during one of the cookbooks.  I went to bootstrap a second time but now i get "ERROR: Excon::Errors::Conflict: Expected([200, 201, 202]) <=> Actual(409 Conflict)"  Any ideas?
[2014-03-04 23:26:10 -0500] ron__: I ran chef-client on the node but not all things have been uploaded yet via bootstrap
[2014-03-04 23:33:51 -0500] ron__: anyone know what conflict 409 means on bootstrap?
[2014-03-04 23:34:16 -0500] gleam: probably the client already exists
[2014-03-04 23:34:35 -0500] ron__: when you say client do you mean node?
[2014-03-04 23:35:08 -0500] gleam: sure
[2014-03-04 23:35:35 -0500] ron__: i see node an client in the portal, I removed node, I will try client :)
[2014-03-04 23:35:36 -0500] ron__: thanks
[2014-03-04 23:35:52 -0500] jkeiser: Yes, it's probably the client
[2014-03-04 23:36:56 -0500] ron__: bummer, removed both client and node and still get ""ERROR: Excon::Errors::Conflict: Expected([200, 201, 202]) <=> Actual(409 Conflict)"" on bootstrap.
[2014-03-04 23:39:32 -0500] scalp42: curious if related to frozen cookbook
[2014-03-04 23:39:34 -0500] scalp42: or something
[2014-03-04 23:41:45 -0500] ron__: on the node, i get 401 unauth, which is what I would expect since deleting the node and client in the portal.
