[2012-06-14 00:12:58 -0400] JohnE20: what is the best way to grab the public ipv4 address from a node?  the best I have so far node[:network][:interfaces][:eth1][:addresses].find {|addr, addr_info| addr_info[:family] == "inet"}.first
[2012-06-14 00:14:15 -0400] hoover_damm: JohnE20, node[:ipaddress]
[2012-06-14 00:14:16 -0400] hoover_damm: ?
[2012-06-14 00:14:49 -0400] JohnE20: that gives me the private address of the node  10.x.x.x
[2012-06-14 00:15:10 -0400] hoover_damm: and you want what' son eth1?
[2012-06-14 00:16:42 -0400] JohnE20: yes
[2012-06-14 00:19:08 -0400] JohnE20: nvm: sorry for the question but it will be more difficult as network interfaces change between ec2 and local vm
[2012-06-14 00:19:14 -0400] hoover_damm: yep
[2012-06-14 00:59:16 -0400] williamherry: Hi, I added some account to linux client with data bag, it words but when I change some info like passwd of one account in data bag, re run chef-client, it seem not affect
[2012-06-14 00:59:44 -0400] williamherry: what is the right way to manage account?
[2012-06-14 01:17:50 -0400] mrRobinsonXDA: I was following wiki for creating a first run only resource.  this command will return back a bunch of nodes: knife search node "some_command_complete:*"   Then it says to run this:  knife exec -E 'nodes.all { |n| n.delete("some_command_complete"); n.save() }'                however, i only want to specify a node there not use nodes.all.
[2012-06-14 01:17:59 -0400] mrRobinsonXDA: Does anyone know how to do that?
[2012-06-14 02:27:07 -0400] viet: greetings!
[2012-06-14 02:29:01 -0400] viet: I'm trying to install postgres using chef-solo...
[2012-06-14 02:29:01 -0400] viet: * viet has quit (Ping timeout: 608 seconds)
[2012-06-14 02:29:01 -0400] viet: <zjin> probable error: http://docs.redhat.com/docs/en-US/JBoss_Operations_Network/3.1/html/Dev_Writing_JON_Command-Line_Scripts/scripts-about.html
[2012-06-14 02:29:02 -0400] viet: <zjin> "$ login -u rhqadmin -p rhqadmin"
[2012-06-14 02:29:02 -0400] viet: <zjin> I think the script above cannot be executed
[2012-06-14 02:29:02 -0400] viet: * jkremser_ has quit (Quit: Leaving)
[2012-06-14 02:29:04 -0400] viet: <zjin> it should be either "rhq-cli -u rhqadmin -p rhqadmin" or "login rhqadmin rhqadmin", based on what "$" stands for.
[2012-06-14 02:29:07 -0400] viet: <zjin> 2. probable typo: http://docs.redhat.com/docs/en-US/JBoss_Operations_Network/3.1/html/Dev_Writing_JON_Command-Line_Scripts/syntax.html
[2012-06-14 02:29:10 -0400] viet: <zjin> the line below "logout" duplicates the sentence below "login"
[2012-06-14 02:29:12 -0400] viet: * zjin is now known as zjin_afk
[2012-06-14 02:29:14 -0400] viet: <mfoley|dinner> ok ... if you think you have a bug ... feel empowered to log a BZ ...
[2012-06-14 02:29:16 -0400] viet: * zjin_afk has quit (Ping timeout: 615 seconds)
[2012-06-14 02:29:18 -0400] viet: * ccrouch has quit (Ping timeout: 633 seconds)
[2012-06-14 02:29:20 -0400] viet: * mfoley|dinner has quit (Ping timeout: 608 seconds)
[2012-06-14 02:29:22 -0400] viet: * You are now known as viet_away
[2012-06-14 02:29:24 -0400] viet:  Python interface unloaded
[2012-06-14 02:29:30 -0400] viet: oops sorry
[2012-06-14 02:29:32 -0400] viet: I'm trying to install postgresql
[2012-06-14 02:29:57 -0400] viet: https://github.com/opscode-cookbooks/postgresql
[2012-06-14 02:30:18 -0400] viet: not sure I understand the part where I'm supposed to set postgres password
[2012-06-14 02:31:40 -0400] hoover_damm: viet, you need to set node['postgresql']['password']['postgres']
[2012-06-14 02:31:43 -0400] hoover_damm: viet, in chef.json
[2012-06-14 02:31:51 -0400] viet: right.. that's where I'm stuck
[2012-06-14 02:31:56 -0400] hoover_damm: viet, or your dna.json or whatever you call your regular json blob youc all chef-solo with
[2012-06-14 02:32:05 -0400] hoover_damm: darn space bar
[2012-06-14 02:32:33 -0400] hoover_damm: now I admit, I did write my own postgresql cookbook and changed that up a little bit because I got weirded out on it
[2012-06-14 02:32:50 -0400] hoover_damm: https://github.com/damm/postgresql
[2012-06-14 02:33:12 -0400] hoover_damm: originally tested on 11.10, removal of the backport ppa on 12.04 will get you 9.1 still
[2012-06-14 02:33:54 -0400] hoover_damm: just set node['postgresql']['password'] ... and if you use solo ahem I initdb so I drop the password
[2012-06-14 02:34:06 -0400] hoover_damm: so worst case you can find the password, trust is still set in a good way so you can get in
[2012-06-14 02:34:50 -0400] viet: I'm like a dummy here... how do you set it
[2012-06-14 02:34:51 -0400] hoover_damm: https://github.com/damm/postgresql/blob/master/recipes/server_debian.rb#L140
[2012-06-14 02:35:14 -0400] viet: I have "run_list": recipe ....
[2012-06-14 02:35:28 -0400] hoover_damm: so you have {"run_list": ... }
[2012-06-14 02:35:35 -0400] hoover_damm: you need to then change it up to be
[2012-06-14 02:41:51 -0400] mrRobinsonXDA: I was following wiki for creating a first run only resource. this command will return back a bunch of nodes: knife search node "some_command_complete:*" Then it says to run this: knife exec -E 'nodes.all { |n| n.delete("some_command_complete"); n.save() }' however, i only want to specify a node there not use nodes.all.  anyone know how ?
[2012-06-14 02:42:39 -0400] hoover_damm: viet, something like {"postgresql":{"password":{"postgres":"password"}},"run_list":["recipe[bob]","role[bill]"]} perhaps?
[2012-06-14 02:44:55 -0400] viet: trying...
[2012-06-14 02:48:20 -0400] viet: hoover_damm thanks it's working
[2012-06-14 02:49:10 -0400] hoover_damm: np
[2012-06-14 02:49:35 -0400] invsblduck: Hi there, I've been googling and I'm about to search the mailing list archives directly, but I'm wondering: Are variable assignments (outside of resources) assessed at compile-time (as opposed to converge/run-time)?
[2012-06-14 02:51:38 -0400] invsblduck: a resource is going to populate some node[] stuff for me, so if I try to do `short_name = node[:foo][:bar][:baz][:wibble]' outside of a ruby_block, i'm guessing the node attribute I'm looking for won't have been created yet (since it's created at run time).   Thanks and sorry if you get that question every day in here.
[2012-06-14 02:52:12 -0400] invsblduck: (but I don't see a clear answer on the wiki, nor from google.)
[2012-06-14 02:54:36 -0400] hoover_damm: invsblduck, shef -z b=Chef::Node.load("node")
[2012-06-14 02:54:54 -0400] hoover_damm: b.delete("some_command_complete")
[2012-06-14 02:54:56 -0400] hoover_damm: b.save
[2012-06-14 02:55:26 -0400] hoover_damm: invsblduck, perhaps i'm wrong by suggesting that... but I rather enjoy repl
[2012-06-14 02:55:42 -0400] invsblduck: hoover_damm: it's okay, i don't know what it means nor what to do with it :)
[2012-06-14 02:56:01 -0400] hoover_damm: invsblduck, run shef -z
[2012-06-14 02:56:25 -0400] hoover_damm: invsblduck, then load up the node as an object... b=Chef::Node.load("offendingnode")
[2012-06-14 02:56:50 -0400] hoover_damm: invsblduck, now b will be 'node' of your node you want to delete that attribute from
[2012-06-14 02:57:02 -0400] hoover_damm: err crap that was meant to mrRobinsonXDA
[2012-06-14 02:57:56 -0400] hoover_damm: invsblduck, short_name = node[:foo] should work
[2012-06-14 02:58:03 -0400] hoover_damm: without a ruby block
[2012-06-14 02:58:55 -0400] invsblduck: the question was compile time vs. converge time
[2012-06-14 02:59:17 -0400] invsblduck: shef backtraces with a message 'epic fail!' lol <-- that's awesome
[2012-06-14 02:59:55 -0400] hoover_damm: invsblduck, the resource is going to run at compile time no?
[2012-06-14 03:00:00 -0400] hoover_damm: err runtime
[2012-06-14 03:00:20 -0400] hoover_damm: invsblduck, compile time is when you compile the code load it up... your resource shouldn't run then
[2012-06-14 03:00:25 -0400] hoover_damm: it should run at runtime not compile time
[2012-06-14 03:00:33 -0400] invsblduck: correct hoover_damm
[2012-06-14 03:00:53 -0400] invsblduck: my resource at run time will populate node[] via lwrp
[2012-06-14 03:01:01 -0400] hoover_damm: right
[2012-06-14 03:01:24 -0400] invsblduck: so i was simply asking: i can't assign the node value to a variable *outside* of a resource (ruby_block) because it won't exist yet, right?
[2012-06-14 03:01:34 -0400] invsblduck: or do generic variable assignments in chef happen at run time?
[2012-06-14 03:01:53 -0400] hoover_damm: should be the latter
[2012-06-14 03:03:04 -0400] invsblduck: ok. it was my understanding that all "plain" ruby code (outside or "around" the resources) is run first, at compile time.
[2012-06-14 03:03:48 -0400] hoover_damm: Chef::Log.info and find out?
[2012-06-14 03:03:53 -0400] invsblduck: ...then the resources at executed at converge time.
[2012-06-14 03:04:00 -0400] invsblduck: ^ that is the best idea ;)
[2012-06-14 03:04:35 -0400] invsblduck: i was trying to save myself that shooting in the dark, but for what, i guess...
[2012-06-14 03:05:03 -0400] hoover_damm: It's more fun to learn for yourself and then realize 6months later you learned the lesson wrong
[2012-06-14 03:05:06 -0400] hoover_damm: :)
[2012-06-14 04:21:14 -0400] jtimberman: silk: dunno if anyone replied - reprepro, the APT repository management tool we use, only allows the 'latest' version of a package to be available.
[2012-06-14 04:22:16 -0400] jtimberman: silk: the packaging stuff should all be in https://github.com/opscode/opscode-packages so you can build your own packages.
[2012-06-14 04:22:37 -0400] jtimberman: silk: we use our 'sbuild' cookbook to set up the package build server and 'reprepro' to set up the repository.
[2012-06-14 04:30:13 -0400] silk: jtimberman, it was still available can we get 10.12 released soonish? 10.10 is  PITA
[2012-06-14 04:30:55 -0400] jtimberman: silk: it'll definitely be soonish, 10.12 is release candidate.
[2012-06-14 04:31:19 -0400] silk: oh, just incase anyone cares: http://apt.opscode.com/pool/main/c/chef/chef_0.10.8-2_all.deb
[2012-06-14 04:31:45 -0400] silk: jtimberman, sure, but until then i have half a dozen recipes that were fine, that are now broken
[2012-06-14 04:31:47 -0400] jtimberman: silk: yeah, the package will be there, but the repo points at the latest one.
[2012-06-14 04:31:48 -0400] hoover_damm: silk, this is where running your own apt cache is helpful
[2012-06-14 04:32:01 -0400] silk: hoover, I do for everything else
[2012-06-14 04:32:06 -0400] hoover_damm: I always advocate owning your production packages so upstream can't fool you
[2012-06-14 04:32:25 -0400] jtimberman: silk: is there a specific fix in 10.12 for a regression in 10.10?
[2012-06-14 04:32:25 -0400] silk: the only exernal dependancy was chef
[2012-06-14 04:32:28 -0400] hoover_damm: including omnibus/etc
[2012-06-14 04:32:34 -0400] hoover_damm: it's not to be mean to Opscode or anything like that
[2012-06-14 04:32:36 -0400] silk: jtimberman, broken symlinks
[2012-06-14 04:32:53 -0400] hoover_damm: It's just that sometimes you arn't ready for the upgrade, or this or that... and you want your state to be locked until your ready to move it
[2012-06-14 04:33:01 -0400] silk: the link resource in 10.12 is busted on owner and group
[2012-06-14 04:33:14 -0400] jtimberman: ah
[2012-06-14 04:33:23 -0400] silk: sorry 10.10
[2012-06-14 04:33:31 -0400] hoover_damm: it's why we avoided 0.10.10
[2012-06-14 04:33:35 -0400] hoover_damm: we're still on 0.10.8
[2012-06-14 04:34:18 -0400] hoover_damm: I was going to drop a new omnibus build for ourselves with 0.10.12rc
[2012-06-14 04:35:51 -0400] silk: im a little curious as to why you (opscode) have left it in place with such an obviuos bug, that has been biting a bunch of people, but thats your (opscode) choice i guess :)
[2012-06-14 04:41:32 -0400] jtimberman: you can do
[2012-06-14 04:41:39 -0400] jtimberman: Chef::VersionConstraint.new("= 0.10.10").include?(::Chef::VERSION)
[2012-06-14 04:42:10 -0400] jtimberman: and use the same version constraint operators as used in environments
[2012-06-14 04:42:52 -0400] jtimberman: I'm sorry about that bug and that we haven't released the fix in a new version release yet.
[2012-06-14 04:45:06 -0400] silk: its too late by the time ive done a bootstrap in AWS
[2012-06-14 04:45:26 -0400] jtimberman: customize the bootstrap template?
[2012-06-14 04:45:27 -0400] silk: using the default templates it just yoinks the current chef.deb from your repo
[2012-06-14 04:45:54 -0400] silk: If i was still mostly in aws world, id have done it
[2012-06-14 04:46:23 -0400] silk: i had to rebuild a failing node this morning and got  the grumps again :)
[2012-06-14 04:50:49 -0400] hoover_damm: silk, want a link to my omnibus 0.10.8 debs for natty?
[2012-06-14 04:51:11 -0400] silk: im fine
[2012-06-14 04:51:16 -0400] silk: i have the pacakge
[2012-06-14 04:51:24 -0400] hoover_damm: you just had the grumps
[2012-06-14 04:51:28 -0400] silk: I just removed the old one, and installed the next one
[2012-06-14 04:51:49 -0400] silk: when I asked, i was annoyed and didnt know if the old one was still available
[2012-06-14 04:51:55 -0400] silk: now i just think its a bit silly
[2012-06-14 04:57:34 -0400] hoover_damm: it is
[2012-06-14 04:58:02 -0400] hoover_damm: and actually the link user group param is a good thing
[2012-06-14 04:58:10 -0400] hoover_damm: we have needed it
[2012-06-14 04:59:14 -0400] silk: I dont think i have setlinks to other owners, but I have specified the owner
[2012-06-14 04:59:40 -0400] cooper: howdy all
[2012-06-14 05:00:26 -0400] cooper: anybody have experience with getting java::oracle cookbook to work on rhea/centos?
[2012-06-14 05:00:43 -0400] cooper: seems mine is failing at...
[2012-06-14 05:00:44 -0400] cooper: Command ' mv "/tmp/d20120613-645-18fdosx/jdk1.6.0_32" "/usr/java/jdk1.6.0_32" ' failed
[2012-06-14 05:01:17 -0400] cooper: but this is what exists: /tmp/d20120613-645-18fdosx/jdk-6u32-linux-x64-rpm.bin
[2012-06-14 05:01:41 -0400] cooper: why doesn't java_ark expect the bin file when that is what it downloaded? hrm.
[2012-06-14 05:07:20 -0400] hoover_damm: silk, you shouldn't have to.  But it should be an option :)
[2012-06-14 05:07:25 -0400] hoover_damm: and that is what you said
[2012-06-14 05:08:38 -0400] cooper: looks like my issue is possibly in the parse_app_dir_name class
[2012-06-14 05:08:39 -0400] cooper: https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb#L20-38
[2012-06-14 05:16:27 -0400] BryanWB: ohai chefs!
[2012-06-14 05:24:56 -0400] cooper: ohai BryanWB :) might you be able to help on the java_ark question ^^^ ?
[2012-06-14 05:25:09 -0400] BryanWB: cooper: probably
[2012-06-14 05:25:27 -0400] BryanWB: cooper: but i just joined, didn't c it
[2012-06-14 05:25:59 -0400] cooper: ahit's failing for me using bin file / oracle install
[2012-06-14 05:26:01 -0400] cooper: Command ' mv "/tmp/d20120613-645-18fdosx/jdk1.6.0_32" "/usr/java/jdk1.6.0_32" ' failed
[2012-06-14 05:26:14 -0400] cooper: but this is what exists: /tmp/d20120613-645-18fdosx/jdk-6u32-linux-x64-rpm.bin
[2012-06-14 05:26:40 -0400] cooper: BryanWB, looks like my issue is possibly in the parse_app_dir_name class
[2012-06-14 05:26:59 -0400] BryanWB: cooper: /tmp/d20120613-645-18fdosx/jdk1.6.0_32  is the expanded  jdk*.bin
[2012-06-14 05:27:14 -0400] tony_: hello, and sorry if I'm interrupting, but does anyone know how to execute apt-add with chef?
[2012-06-14 05:27:15 -0400] BryanWB: the jdk*rpm.bin just expands in place
[2012-06-14 05:27:33 -0400] BryanWB: cooper: does /usr/java/ exist?
[2012-06-14 05:28:09 -0400] cooper: BryanWB: it does after that recipe runs
[2012-06-14 05:29:34 -0400] BryanWB: cooper: lemme look
[2012-06-14 05:29:47 -0400] BryanWB: is jdk1.6u32 new?
[2012-06-14 05:29:54 -0400] cooper: but since it expects to be moving "jdk1.6.0_32" and not "jdk-6u32-linux-x64-rpm.bin" then it fails. not sure how the ark is downloading the jdk-6u32-linux-x64-rpm.bin file, but it downloads it fine and then thinks it's named something else based on parse_app_dir_name class
[2012-06-14 05:30:53 -0400] cooper: jdk-6u32-linux-x64-rpm.bin is one version below what's currently available on oracle's site. i think they're at 6u33 for version 6 now
[2012-06-14 05:31:00 -0400] cooper: thanks, BryanWB
[2012-06-14 05:31:22 -0400] BryanWB: cooper: u misunderstand me
[2012-06-14 05:31:51 -0400] BryanWB: cooper: the java cookbook expands  jdk-6u32-linux-x64-rpm.bin to a folder in the same path
[2012-06-14 05:31:55 -0400] BryanWB: the same tmpdir
[2012-06-14 05:32:26 -0400] BryanWB: oracle fucks w/ the extracted folder name from time to time
[2012-06-14 05:33:10 -0400] BryanWB: cooper: i can't find release 32 on the oracle site, only 33 or 32
[2012-06-14 05:33:16 -0400] BryanWB: cooper: can u help me out?
[2012-06-14 05:33:35 -0400] BryanWB: cooper: what folders do u c in /tmp/d20120613-645-18fdosx/  ?
[2012-06-14 05:34:05 -0400] cooper: ahi think i understandinside that tmpdir is the bin filebut the java cookbook is supposed to expand that bin file in the tmpdir and then mv it to /usr/java, correct?
[2012-06-14 05:34:15 -0400] BryanWB: cooper: exactly
[2012-06-14 05:34:17 -0400] cooper: ls /tmp/d20120614-1662-1fwkyw2/
[2012-06-14 05:34:18 -0400] cooper: jdk-6u32-linux-x64-rpm.bin
[2012-06-14 05:34:47 -0400] BryanWB: hmm, look like it didn't expand, got a download link for 1.6u32?
[2012-06-14 05:35:19 -0400] cooper: hrm. is this the line that should be expanding that?
[2012-06-14 05:35:20 -0400] cooper: https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb#L78
[2012-06-14 05:35:51 -0400] BryanWB: cooper: yup
[2012-06-14 05:35:54 -0400] cooper: BryanWB: checking for 6u32 on oracle's site nowit's a pain to track down older versionsas i'm sure you know :)
[2012-06-14 05:36:02 -0400] cooper: hrm.
[2012-06-14 05:36:11 -0400] BryanWB: cooper: y, i can't find it
[2012-06-14 05:36:35 -0400] cooper: i've got 6u31 alsodo you think the java cookbook would treat that differently?
[2012-06-14 05:37:34 -0400] BryanWB: cooper: it depends on whether that bash ./jdk*rpm.bin -noregister command still works
[2012-06-14 05:37:54 -0400] BryanWB: i test w/ 1.6u33
[2012-06-14 05:38:15 -0400] cooper: umBryanWB i think my problem is with /tmp :(
[2012-06-14 05:38:17 -0400] cooper: tmpfs on /dev/shm type tmpfs (rw,noexec,nosuid,nodev)
[2012-06-14 05:38:31 -0400] BryanWB: cooper: ah, that would be it
[2012-06-14 05:38:37 -0400] cooper: :( sorry
[2012-06-14 05:38:47 -0400] BryanWB: cooper: do many people do that?
[2012-06-14 05:38:54 -0400] cooper: but i'm glad you helped me track it down, BryanWB! :)
[2012-06-14 05:39:03 -0400] cooper: dunnowe do on all our default kicks
[2012-06-14 05:39:05 -0400] BryanWB: cooper: i could try to do it w/ in /var/chef/tmp
[2012-06-14 05:39:38 -0400] cooper: yah, that makes a lot more sense (says the sys admin inside me) ;)
[2012-06-14 05:39:48 -0400] BryanWB: jtimberman: any idea if many ppl have noexec on their tmpdirs?
[2012-06-14 05:41:17 -0400] BryanWB: cooper: for tmp fix, change https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb#L76  to cd "#{Chef::Config[:file_cache_path]}"
[2012-06-14 05:41:47 -0400] BryanWB: cooper: no that's shit
[2012-06-14 05:41:57 -0400] cooper: BryanWB: lol why?
[2012-06-14 05:42:04 -0400] williamherry: do chef support push to client?, when I make some change, do I must restart chef-client on client node to apply changes?
[2012-06-14 05:43:19 -0400] BryanWB: cooper: try line https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb#L72  w/ Dir.mktmpdir(Chef::Config[:file_cache_path])
[2012-06-14 05:44:47 -0400] cooper: BryanWB: kjust a sec
[2012-06-14 05:46:07 -0400] jtimberman: williamherry: you can kill -USR1 the pid if its running as a daemon
[2012-06-14 05:46:21 -0400] jtimberman: williamherry: there isn't a push thing yet
[2012-06-14 05:46:26 -0400] BryanWB: cooper: and then i ask on ML is many others set noexec for their tmpdir and possibility of using /var/chef/tmp/  for /var/tmp for this purpose
[2012-06-14 05:46:29 -0400] jtimberman: BryanWB: dunno
[2012-06-14 05:46:46 -0400] BryanWB: s/for/or/
[2012-06-14 05:47:09 -0400] cooper: BryanWB:  Dir.mktmpdir(Chef::Config[:file_cache_path])  FTW!
[2012-06-14 05:47:10 -0400] cooper: s
[2012-06-14 05:47:13 -0400] cooper: success
[2012-06-14 05:47:16 -0400] williamherry: jtimberman, thanks
[2012-06-14 05:47:36 -0400] BryanWB: cooper: kewl, java ckbk needs serious refactoring, i wrote it when was still learning ruby
[2012-06-14 05:48:23 -0400] cooper: BryanWB: wow. it's a pretty massive undertaking to start with :)
[2012-06-14 05:49:08 -0400] BryanWB: cooper: not really, my entire infra is java so need a stable cookbook at the bottom
[2012-06-14 05:49:38 -0400] BryanWB: u can't do SOA w/ out CM, and that's the truth, ruth
[2012-06-14 05:49:46 -0400] cooper: lol
[2012-06-14 05:49:56 -0400] cooper: gotcha. :)
[2012-06-14 05:50:22 -0400] jtimberman: BryanWB: refactoring.. again? ;)
[2012-06-14 05:50:27 -0400] jtimberman: you already rewrote the thing
[2012-06-14 05:50:28 -0400] jtimberman: :)
[2012-06-14 05:50:55 -0400] BryanWB: jtimberman: no, I rewrote ark 3 times, only wrote java once ;)
[2012-06-14 05:51:14 -0400] cooper: BryanWB:  sohow would i handle revving the jdk in my environment when the time comes? just update my download url and viola, new version of jdk?
[2012-06-14 05:51:25 -0400] jtimberman: BryanWB: hehehehe
[2012-06-14 05:51:34 -0400] tony_: any pointers on how to run "apt-add-repository ..." through some chef resource or anything if possible?
[2012-06-14 05:51:38 -0400] BryanWB: jtimberman: need to refactor to use ark,and add minitests, did acrump add tests to java cookbook?
[2012-06-14 05:51:54 -0400] jtimberman: alright... 7 more pull requests merged.
[2012-06-14 05:52:13 -0400] jtimberman: BryanWB: i don't know if he did java, he added stuff in a pull req to apache
[2012-06-14 05:52:13 -0400] BryanWB: cooper: y
[2012-06-14 05:52:28 -0400] BryanWB: i <3 da crumpster
[2012-06-14 05:52:41 -0400] jtimberman: tony_: our apt cookbook has a apt_repository LWRP for adding new ones, http://ckbk.it/apt
[2012-06-14 05:52:55 -0400] jtimberman: cucumber tests are so much code tho
[2012-06-14 05:53:02 -0400] cooper: BryanWB: awesome. thanks again for the help.
[2012-06-14 05:53:11 -0400] BryanWB: jtimberman: ministest is enough for me
[2012-06-14 05:53:14 -0400] BryanWB: cooper: np
[2012-06-14 05:53:18 -0400] jtimberman: BryanWB: we're still figuring out the best way to go about accomplishing solid testing.
[2012-06-14 05:53:30 -0400] jtimberman: BryanWB: with the minitest handler?
[2012-06-14 05:53:36 -0400] BryanWB: jtimberman: y
[2012-06-14 05:53:53 -0400] BryanWB: jtimberman: it is perfect for a ckbk w/ many edgecases, like the java ckbk
[2012-06-14 05:54:00 -0400] jtimberman: for custom libraries and providers, i am totally on board with unit/spec testing the code.
[2012-06-14 05:54:31 -0400] jtimberman: unit testing recipes is kind o silly "I assert that the recipe will add a package 'foo' resource to the collection" - uh... it did. right there. :)
[2012-06-14 05:54:45 -0400] jtimberman: imo
[2012-06-14 05:55:03 -0400] BryanWB: jtimberman: minitest is appropriate when u need to test externalities, like the availabiliy of rpms, behavior of the jdk*rpm.bin from oracle, for example
[2012-06-14 05:55:22 -0400] BryanWB: stuff like that can't be done w/ unit testing
[2012-06-14 05:56:28 -0400] jtimberman: totally
[2012-06-14 05:56:30 -0400] jtimberman: integration testing
[2012-06-14 05:56:34 -0400] jtimberman: thats valuable.
[2012-06-14 05:56:54 -0400] jtimberman: tests for helping prevent regressions are good.
[2012-06-14 05:57:22 -0400] jtimberman: like "holy shit, someone refactored this 64 line recipe with 48 lines of diff... does it still work on its 8 platforms?"
[2012-06-14 05:57:35 -0400] BryanWB: yup
[2012-06-14 05:58:45 -0400] jtimberman: anyway, i'm gonna sleep :D
[2012-06-14 05:58:47 -0400] jtimberman: cheers!
[2012-06-14 05:58:53 -0400] BryanWB: gnight!
[2012-06-14 05:59:00 -0400] tony_: I looked at that, but couldn't really figure it out
[2012-06-14 05:59:19 -0400] tony_: what i'm trying to execute is this: "sudo apt-add-repository ppa:chris-lea/node.js"
[2012-06-14 05:59:38 -0400] tony_: wasn't sure how to modify those examples though
[2012-06-14 05:59:53 -0400] tony_: any help please?
[2012-06-14 06:03:02 -0400] danryan: tony_: it'd look something like this: https://gist.github.com/2928225
[2012-06-14 06:03:42 -0400] tony_: oh wow
[2012-06-14 06:03:44 -0400] tony_: thanks
[2012-06-14 06:04:05 -0400] danryan: uri and key would be the ones listed on the ppa's main site here: https://launchpad.net/~chris-lea/+archive/node.js
[2012-06-14 06:04:22 -0400] danryan: key is the second half of "signing key" after the /
[2012-06-14 06:04:24 -0400] tony_: ah, I was about to ask about those
[2012-06-14 06:05:07 -0400] danryan: if you want to install a launchpad PPA, then the keyserver is always "keyserver.ubuntu.com
[2012-06-14 06:05:43 -0400] danryan: otherwise, it's the keyserver for the particular repo, or omit the keyserver if key is a URL
[2012-06-14 06:05:56 -0400] danryan: (example: https://gist.github.com/2928240)_
[2012-06-14 06:09:38 -0400] tony_: sorry, where did you find the key again?
[2012-06-14 06:10:19 -0400] danryan: tony_: I went to the launchpad.net site for the ppa in question
[2012-06-14 06:10:24 -0400] danryan: it's under "signing key"
[2012-06-14 06:10:32 -0400] danryan: https://launchpad.net/~chris-lea/+archive/node.js
[2012-06-14 06:12:57 -0400] danryan: tony_: this is a great reference for the apt cookbook http://wiki.opscode.com/display/chef/Opscode+LWRP+Resources#OpscodeLWRPResources-apt
[2012-06-14 06:17:01 -0400] tony_: ah, under technical details
[2012-06-14 06:17:02 -0400] tony_: got it
[2012-06-14 06:17:03 -0400] tony_: thanks a lot
[2012-06-14 07:14:51 -0400] mohits: Question: When a cookbook is added on community site by say a non-opscode contributor, does it goes through say something like "procedure of acceptance"?
[2012-06-14 07:17:19 -0400] BryanWB: mohits: no
[2012-06-14 07:21:13 -0400] jondot: hello
[2012-06-14 07:21:23 -0400] countdig1: hello
[2012-06-14 07:21:36 -0400] jondot: im wondering - does it make sense that ohai outputs ulimit / filesystem limits? does it do it already?
[2012-06-14 07:23:35 -0400] countdig1: i haven't seen it in _stock_ ohai but im fairly new - just ran ohai on my linux box and dont see it
[2012-06-14 07:24:16 -0400] countdig1: when u mean filesystem u don't mean total,used,avail do you?
[2012-06-14 07:25:31 -0400] jondot: yes, its not there
[2012-06-14 07:25:37 -0400] jondot: i mean ulimit -a for example
[2012-06-14 07:25:42 -0400] countdig1: righto
[2012-06-14 07:26:09 -0400] countdig1: i just hacked out lwrp but haven't messed w/ writing ohai plugin yet but it couldnt be that hard
[2012-06-14 07:29:02 -0400] jondot: yea, im doing it right now, just wanted to make sure.
[2012-06-14 07:29:04 -0400] jondot: 10x
[2012-06-14 07:29:34 -0400] countdig1: can u put an ohai plugin in a cookbook dir?
[2012-06-14 07:29:44 -0400] countdig1: easily i should say - its ruby so u can do _anything_ ;-)
[2012-06-14 08:03:27 -0400] specialsauce: gah, this morning my chef server is dead and when i try and start it it only outputs " ~ In 24757" and dies :-/
[2012-06-14 08:09:52 -0400] specialsauce: Couch had died. "[Thu, 14 Jun 2012 01:41:32 GMT] [error] [emulator] Error in process <0.17355.170> with exit value: {{badmatch,{ok,<<221151232 bytes>>,true}},[{couch_file,read_raw_iolist,3},{couch_file,pread_iolist,2},{couch_file,pread_binary,2},{couch_file,pread_term,2},{couch_db,make_doc,5},{couch_db,open_doc_int,3},{couch_db,open_doc,3},{couch_changes... "
[2012-06-14 08:12:32 -0400] iroller: Hey Chefs. Does anybody know how to build chef-solr gem? I'm getting ""solr/solr-home.tar.gz", "solr/solr-jetty.tar.gz"] are not files"
[2012-06-14 09:08:17 -0400] mohits: BryanWB,  Okay.
[2012-06-14 09:08:38 -0400] BryanWB: mohits: this issue is being worked on tho
[2012-06-14 09:08:51 -0400] BryanWB: mohits: but there won't be an acceptance process per se
[2012-06-14 09:14:28 -0400] mohits: BryanWB, is this issue being tracked somewhere? where i can follow
[2012-06-14 09:18:11 -0400] BryanWB: mohits: sorry, dunno
[2012-06-14 09:18:46 -0400] mohits: BryanWB, Okay
[2012-06-14 10:09:38 -0400] guillermooo: yy
[2012-06-14 11:30:07 -0400] drrk: I want to have node specific data like the ip addresses it should have, is this soemthign I could put in a data bag that any recipe can access based on the nodes name?
[2012-06-14 11:33:13 -0400] ashb: drrk: example?
[2012-06-14 11:33:28 -0400] ashb: (I don't htink you'd need to use a data bag for that, but i'm not quite sure what exactly you want)
[2012-06-14 11:33:36 -0400] drrk: well that's the point, i'm not sure
[2012-06-14 11:33:46 -0400] drrk: how can I give a node data in another way?
[2012-06-14 11:34:02 -0400] ashb: do you want to set the IP address, or use the IP address from one node in another?
[2012-06-14 11:34:15 -0400] BryanWB_: drrk: u using something like autoscaling grps in amazon?
[2012-06-14 11:34:17 -0400] ashb: drrk: if it is soley node specific I would use node attributes rather than a data bag
[2012-06-14 11:34:40 -0400] BryanWB_: i don't like node attrs, hard to keep track of, i would go w/ a data_bag
[2012-06-14 11:35:02 -0400] BryanWB_: i always forget about node attrs and lose track unless in git
[2012-06-14 11:35:06 -0400] drrk: I want to set the ip, most of my servers have a management ip and service addresses
[2012-06-14 11:35:23 -0400] drrk: how are node attributes set?
[2012-06-14 11:35:30 -0400] BryanWB_: drrk: i vote for db, but ashb is a smart guy too
[2012-06-14 11:35:37 -0400] BryanWB_: sorry db => data_bag
[2012-06-14 11:35:47 -0400] BryanWB_: knife node edit node-name
[2012-06-14 11:36:34 -0400] ashb: both are valid, I just feels 'wrong' to me to have data for just one node in a db
[2012-06-14 11:36:38 -0400] ashb: but that's just my personal preference
[2012-06-14 11:37:21 -0400] drrk: node attributes can't be saved in git then can they
[2012-06-14 11:37:32 -0400] ashb: no
[2012-06-14 11:37:37 -0400] ashb: thats the main argument against them
[2012-06-14 11:37:50 -0400] drrk: but I guess i'll have other node attributes any way, like mysql passwords
[2012-06-14 11:38:00 -0400] drrk: stuff thats auto generated
[2012-06-14 11:38:00 -0400] BryanWB_: for me, if it's not in git, i don't know that it exists
[2012-06-14 11:38:09 -0400] BryanWB_: cuz i forget 10 mins later
[2012-06-14 11:38:56 -0400] drrk: yeah i'm of the same opinion BryanWB_
[2012-06-14 11:43:41 -0400] drrk: I think given autogenerated passwords in node attributes don't matter too much if they get changed, as the server is probably being rebuilt, but things I set I do care about, i'm going to use a node_data data bag, so it's in git
[2012-06-14 11:57:05 -0400] ashb: sigh. I want the same place in the shared directory to be symlinks to two places into the deploy_revision current dir.
[2012-06-14 11:57:09 -0400] ashb: sigh
[2012-06-14 11:58:15 -0400] ashb: drrk: depends on how yo uare using things, but I don't care what the IP of a node is - i find it by searching for a node with role X and get the IP that day
[2012-06-14 11:58:18 -0400] ashb: s/day/way/
[2012-06-14 11:58:23 -0400] ashb: depends what you are doing of course
[2012-06-14 12:26:23 -0400] jondot: how fast does a pull request go usually?
[2012-06-14 12:26:31 -0400] jondot: (for a plugin)
[2012-06-14 12:26:49 -0400] jondot: argh. i mean a plugin for ohai. sorry my brain is still in codeland
[2012-06-14 12:27:13 -0400] yfeldblum: jondot, opscode works based on tickets.opscode.com
[2012-06-14 12:28:01 -0400] jondot: i see. well i have a tool based on ohai, and a plugin i've added to it. since I can't specify a git repo in a gemspec, i'd need to make my own gem 'jondot-ohai' till the pull req will be accepted and ohai gem rebuilt
[2012-06-14 12:28:22 -0400] jondot: i can wait a couple of days, should i just go ahead and make my own version till it gets accepted?
[2012-06-14 12:29:24 -0400] jeekl: How would I check if I have connectivity to the internet or need to fallback on an internal resource?
[2012-06-14 12:34:19 -0400] drrk: ashb: the IP is important - as it's used in DNS I dont' control, the firewall I don't control, etc etc
[2012-06-14 12:34:42 -0400] ashb: yeah fair enoughthen
[2012-06-14 12:34:47 -0400] drrk: the managemnt ip is not important, but the others are
[2012-06-14 12:36:33 -0400] yfeldblum: jondot, you don't need to make your own gem, because you can install a gem from your fork in source control
[2012-06-14 12:36:48 -0400] jondot: i can't with gemspec
[2012-06-14 12:36:56 -0400] jondot: my tool would eventually be a gem itself
[2012-06-14 12:37:38 -0400] yfeldblum: jondot, gemspec doesn't specify a source and doesn't care about a source; just install your copy of ohai first, and then anything that depends on ohai will be satisfied
[2012-06-14 12:38:11 -0400] yfeldblum: jondot, and in that scenario, you can `git clone` your fork and probably `rake install` it
[2012-06-14 12:38:28 -0400] jondot: yfeldblum, yep , i know. what i'm trying to do is to push a gem of my own. this gem depends on ohai + my plugin
[2012-06-14 12:38:46 -0400] jondot: since adding a plugin means changing ohai code, it also means forking ohai to my own jondot/ohai
[2012-06-14 12:38:54 -0400] jondot: and now, i can't express this repo as a gemspec dependency
[2012-06-14 12:39:06 -0400] atomic-penguin: jondot, depends on the project
[2012-06-14 12:39:17 -0400] yfeldblum: adding a plugin doesn't mean changing ohai code ... you can add a plugin entirely separately of the original ohai
[2012-06-14 12:39:23 -0400] jondot: so i can't build a gem that will depend on it. I'd have to, as you said, instruct the users to 'gem install ohai', or 'git clone' the tool, etc
[2012-06-14 12:39:38 -0400] jondot: yfeldblum, how could that be done?
[2012-06-14 12:40:15 -0400] ashb: get your change accecpted to the upstream
[2012-06-14 12:40:18 -0400] rgsteele: What's the proper syntax for searching data bags?  The wiki says 'knife search bagname "key:val"', but for me that returns "ERROR: knife search failed: I don't know how to search for <bagname> data objects."  If I change it slightly so it reads 'knife search databag bagname "key:val"', I always get 0 items found, even if I use "*:*"
[2012-06-14 12:40:49 -0400] yfeldblum: jondot, http://wiki.opscode.com/display/chef/Writing+Ohai+Plugins
[2012-06-14 12:40:58 -0400] jondot: ashb, i'll do that. if you notice upwards, I'm interested in how long does it take for upstream to accept and build my changes into a new version.
[2012-06-14 12:41:25 -0400] jondot: yfeldblum, looking at that. i see that providing custom plugins can be done when i'm using chef/ohai as standalone tools. but i'm not. i'm using ohai programmatically
[2012-06-14 12:41:32 -0400] ashb: rgsteele: what are you trying to seach for (Exactly please)?
[2012-06-14 12:41:35 -0400] atomic-penguin: jondot, might want to check out the ability to distribute custom plugins via recipe code. http://wiki.opscode.com/display/chef/Loading+Custom+Ohai+Plugins
[2012-06-14 12:41:43 -0400] jondot: i.e. using Ohai::System.new
[2012-06-14 12:42:04 -0400] jondot: atomic-penguin, for that matter, i have no chef, and no ohai installed as a standalone tool
[2012-06-14 12:42:05 -0400] yfeldblum: jondot, ya, there's an example of that
[2012-06-14 12:42:34 -0400] jondot: ah. missed this one Ohai::Config[:plugin_path] << '/etc/ohai/plugins'
[2012-06-14 12:42:41 -0400] jondot: i'll try it
[2012-06-14 12:43:23 -0400] yfeldblum: rgsteele, 'knife search bagname "key:val"' is right
[2012-06-14 12:43:30 -0400] railsraider: I am setting up a postfix recipe (opscode) with Amazon SES but i get 530 Must issue a STARTTLS command first
[2012-06-14 12:43:40 -0400] yfeldblum: rgsteele, does the chef-server-api know about this data bag, and about the data bag items in that data bag?
[2012-06-14 12:44:01 -0400] rgsteele: ashb: A data bag with id "asterisk", and any attribute underneath - just look for basic search functionality
[2012-06-14 12:44:24 -0400] ashb: rgsteele: what data bag collection is it in? (apps?)
[2012-06-14 12:44:26 -0400] rgsteele: yfeldblum: If I go to the chef server's webui, it knows about the databag, yes.
[2012-06-14 12:44:34 -0400] rgsteele: ashb: services
[2012-06-14 12:44:44 -0400] ashb: $ knife search services 'id:asterisk'
[2012-06-14 12:44:46 -0400] ashb: try that
[2012-06-14 12:45:09 -0400] yfeldblum: ashb, nomenclature: the data bag *is* the collection (like a mysql table); data bag items are the elements of the collection (like individual records in a mysql table)
[2012-06-14 12:45:54 -0400] rgsteele: ashb: That does return the entire data bag, yeah.
[2012-06-14 12:45:56 -0400] ashb: yfeldblum: confusing names to me' data bag  is a singular to my mind (and thus the item) :/
[2012-06-14 12:47:04 -0400] yfeldblum: ashb, sorry that they're confusing ... still, data bag = mysql table, data bag item = mysql record
[2012-06-14 12:47:15 -0400] ashb: yfeldblum: yeah, thanks
[2012-06-14 12:47:40 -0400] rgsteele: So, does search always return the entire data bag?
[2012-06-14 12:47:42 -0400] yfeldblum: ashb, and they are rather silly names :P
[2012-06-14 12:47:46 -0400] yfeldblum: rgsteele, yes
[2012-06-14 12:48:01 -0400] rgsteele: Gotcha.  ashb: yfeldblum: thanks.
[2012-06-14 12:48:15 -0400] yfeldblum: rgsteele, currently, till someone implements projections in the chef-server-api
[2012-06-14 12:48:53 -0400] rgsteele: In practice, I'm actually going to be searching the databag to verify whether a hostname is present in an attribute whose value is an array of hostnames.
[2012-06-14 12:49:38 -0400] BryanWB_: z0mg, jboss7 changes its own config file in place
[2012-06-14 12:49:59 -0400] BryanWB_: thus triggering reload on every chef run
[2012-06-14 12:50:17 -0400] ashb: that'll learn you for using Java >_>]
[2012-06-14 12:50:21 -0400] ashb: </helping>
[2012-06-14 12:50:31 -0400] BryanWB_: gosh that was so helpful ;)
[2012-06-14 12:50:36 -0400] ashb: i noe rite
[2012-06-14 12:51:26 -0400] rgsteele: Is there a way to only search a specific service underneath the bag name?  I worry that using something like: search(:services 'key:val') do |foo| .... could end up returning data from the wrong id if the key:val are generic enough.  E.g., 'state:primary'
[2012-06-14 12:55:22 -0400] ashb: rgsteele: 'id:x AND state:primary'
[2012-06-14 12:56:12 -0400] rgsteele: ashb: Yeah, I just rtfm'ed :)
[2012-06-14 12:57:41 -0400] rgsteele: Wonder if that works in searches in recipes.
[2012-06-14 12:58:07 -0400] rgsteele: search(:services, 'foo:bar' && 'baz:quux') do |val| ....
[2012-06-14 12:58:29 -0400] rgsteele: Ah well, things to play with.  Thanks again.
[2012-06-14 12:58:32 -0400] ashb: rgsteele: not like that - same as as you do on the command line
[2012-06-14 12:58:41 -0400] ashb: search(:service, 'foo:bar AND baz:quux')
[2012-06-14 13:13:45 -0400] rgsteele: In journalism, shock tactics draw a crowd.  Maybe JBoss/Java are taking a page outta that book?
[2012-06-14 13:17:30 -0400] yfeldblum: rewriting configs does sound equally as shocking as rewriting history
[2012-06-14 13:20:12 -0400] maky: Hello
[2012-06-14 13:20:19 -0400] maky: Can anyone help me get started?
[2012-06-14 13:32:33 -0400] atomic-penguin: maky, if you have a specific question, I'm sure someone will do their best to assist you
[2012-06-14 13:33:14 -0400] maky: Thanks atomic-penguin, I've just found the answer - I'd downloaded my public key not my private key.
[2012-06-14 13:36:07 -0400] leifmadsen: when running chef-client via knife ssh, I want to place some debugging output in my recipes to see some currently set values for the platform. What can I use for that?
[2012-06-14 13:37:48 -0400] yfeldblum: leifmadsen, Chef::Log.info("some cool info")
[2012-06-14 13:38:07 -0400] yfeldblum: leifmadsen, Chef::Log.info("\n#{JSON.pretty_generate(node.to_hash)}")
[2012-06-14 13:39:05 -0400] leifmadsen: in particular I want to get the value for the platform_version
[2012-06-14 13:39:51 -0400] leifmadsen: I think I'm placing my Chef::Log in the wrong spot :)
[2012-06-14 13:40:12 -0400] leifmadsen: yfeldblum: or is your second example showing how to output the value of a hash?
[2012-06-14 13:40:17 -0400] leifmadsen: which is likely what I want in this case
[2012-06-14 13:41:36 -0400] yfeldblum: leifmadsen, the second is an example which demonstrates one way to log the merged node attributes in a readable fashion
[2012-06-14 13:42:38 -0400] leifmadsen: yfeldblum: awesome thanks again
[2012-06-14 13:43:26 -0400] Royals27: I'm using the service provider and overriding the restart command and after chef executes the service I'm restarting is never running.  Chef debug shows the command ran successfully.   If I run the same command outside of chef it works fine.  Here is an example of what I'm seeing: http://pastebin.com/urJKkwDi  Anyone have any ideas?
[2012-06-14 13:47:30 -0400] Zenigor: Hello, I am having a difficult time attempting to follow the wiki for cron tasks. I'm rather new to chef and just inherited a chef repo for our production environment. Do you have any good places to start?
[2012-06-14 13:48:22 -0400] specialsauce: heh who would have thought chef would be a "legacy" system for someone so soon :-)
[2012-06-14 13:48:43 -0400] vdvluc: Zenigor: the resources page in the wiki has an example for the cron resource
[2012-06-14 13:48:54 -0400] timops: @zenigor what is confusing to you?
[2012-06-14 13:49:42 -0400] Zenigor: timops: is a resource a cookbook? I realize its a really dumb question
[2012-06-14 13:50:06 -0400] timops: it's a resource
[2012-06-14 13:50:22 -0400] timops: let me show you a link
[2012-06-14 13:51:08 -0400] timops: http://wiki.opscode.com/display/chef/Resources#Resources-Cron
[2012-06-14 13:52:23 -0400] timops: @zenigor does that help?
[2012-06-14 13:53:00 -0400] Zenigor: timops: normally I would add that into a current recipe if I understand correctly. Only problem is, I am adding a cron ask for something that currently isn't in the chef repo at all
[2012-06-14 13:53:03 -0400] cassarani: so I'm trying to get the munin cookbook to work using nginx, rather than the default apache. I've set node[:munin][:web_server] to "nginx" in my monitoring role (using default_attributes), but during my chef run, the apache2 package is installed and enabled
[2012-06-14 13:53:05 -0400] cassarani: what am I doing wrong?
[2012-06-14 13:53:13 -0400] cassarani: this being the munin cookbook in question https://github.com/opscode-cookbooks/munin
[2012-06-14 13:57:45 -0400] cwj: cassarani: i would try setting that attribute at the override level in your role, or try editing the node in question manually (it probably still has "apache2" set at node default level)
[2012-06-14 13:58:21 -0400] cassarani: cwj: but I thought cookbook attributes were lower in precedence than role attributes?
[2012-06-14 13:58:50 -0400] cassarani: anyway, I'm trying
[2012-06-14 13:58:54 -0400] cwj: they are, but if the node has already saved that value, node default wins over role default
[2012-06-14 13:58:58 -0400] cwj: see precedence here see precedence here: http://wiki.opscode.com/display/chef/Attributes
[2012-06-14 13:59:25 -0400] cwj: derp. just call me johnny two times
[2012-06-14 13:59:34 -0400] cassarani: yeah, that's interesting, it seems to have done.. something, but there are traces of the previous apache2 steps still
[2012-06-14 13:59:52 -0400] cassarani: I'm just going to destroy the vm and try reprovisioning it again from scratch
[2012-06-14 13:59:54 -0400] cwj: you will probably have to remove the vestages of apache manually
[2012-06-14 14:00:00 -0400] cwj: yeah thats a good option too
[2012-06-14 14:00:10 -0400] cassarani: it's just Vagrant thankfully
[2012-06-14 14:00:18 -0400] cwj: yay vagrant :D
[2012-06-14 14:00:51 -0400] cassarani: thanks for your help :)
[2012-06-14 14:01:02 -0400] cwj: you bet
[2012-06-14 14:01:04 -0400] cassarani: I'm just wondering how the node could have saved the wrong value
[2012-06-14 14:01:12 -0400] cassarani: but I guess some things we'll never nkow
[2012-06-14 14:01:14 -0400] cassarani: *know
[2012-06-14 14:01:26 -0400] cwj: did you run the recipe once before changing that attribute's value to 'nginx' ?
[2012-06-14 14:01:30 -0400] cassarani: shouldn't have
[2012-06-14 14:01:44 -0400] cassarani: but who knows, I might have forgotten to update the role with knife
[2012-06-14 14:02:01 -0400] cwj: that would be my guess, but hard to know
[2012-06-14 14:02:41 -0400] leifmadsen: github.com/opscode-cookbooks/ is where I should fork from right?
[2012-06-14 14:02:59 -0400] cassarani: [Thu, 14 Jun 2012 14:02:54 +0000] INFO: Processing package[apache2] action install (apache2::default line 20)
[2012-06-14 14:03:03 -0400] cassarani: it's still doing it :(
[2012-06-14 14:03:19 -0400] cassarani: and then the Chef run fails when apache can't start because nginx is already bound to port 80
[2012-06-14 14:03:21 -0400] cassarani: naturally
[2012-06-14 14:03:23 -0400] timops: sorry, i had to drop for just a minute
[2012-06-14 14:03:35 -0400] cwj: cassarani: gist your role?
[2012-06-14 14:03:58 -0400] timops: @zenigor, still need help with cron task?
[2012-06-14 14:04:51 -0400] leifmadsen: ah found my own answer
[2012-06-14 14:05:18 -0400] cassarani: cwj: https://gist.github.com/5519bf910abfb1b21efc
[2012-06-14 14:05:20 -0400] cassarani: nothing fancy really
[2012-06-14 14:05:41 -0400] Zenigor: @timops i would normally add the resource within another recipe correct? if that is the case, would i need to create a new cookbook and add the cron resource under default.rb for that cookbook? what i am adding is not related to anything within the chef repo currently
[2012-06-14 14:06:25 -0400] timops: @zenigor if you think this is a separate unit of work then creating a separate recipe might be a good idea
[2012-06-14 14:06:55 -0400] cwj: cassarani: hrm yeah thats pretty straight forward
[2012-06-14 14:07:25 -0400] cwj: so you are still getting apache2 on a newly provisioned vagrant vm?
[2012-06-14 14:07:43 -0400] cassarani: yup
[2012-06-14 14:07:50 -0400] Zenigor: @timops I have done that portion then, ran knife upload cookbook db_backup and from my server i ran chef-client to test it out. however the new cron task is not listed in /etc/crontab
[2012-06-14 14:08:13 -0400] timops: @zenigor can you post the cookbook code somewhere?
[2012-06-14 14:08:46 -0400] justsee: First run resources: I've got a few app recipes that use an execute FRR, and only the first app runs its execute block?
[2012-06-14 14:08:47 -0400] Zenigor: @timops https://gist.github.com/2930543
[2012-06-14 14:09:03 -0400] justsee: wondering if there are any gotchas I'm missing on this
[2012-06-14 14:09:08 -0400] cwj: Zenigor: does it show up in output of crontab -l as root?
[2012-06-14 14:09:20 -0400] Zenigor: @timops that is the only code ive changed / added since running rake new_cookbook COOKBOOK=db_backup
[2012-06-14 14:09:49 -0400] Zenigor: @timops no, only chef-client shows in crontab -l as root
[2012-06-14 14:09:51 -0400] timops: @zenigor did you update run_list for node, and also upload the newest cookbook to chef server?
[2012-06-14 14:11:28 -0400] cassarani: cwj: I mean, obviously I've had to upload the apache2 cookbook onto the server, because it's a dependency, but I wasn't expecting it to be used, since I don't use any of its recipes
[2012-06-14 14:11:34 -0400] patcon: hey fujin, you got a minute?
[2012-06-14 14:11:52 -0400] cwj: cassarani: yeah
[2012-06-14 14:12:28 -0400] Zenigor: @timops excuse the ignorance, i'm very green to chef. how would i update my run_list? i have uploaded the cookbook
[2012-06-14 14:12:32 -0400] cwj: if you use knife to edit the node, does it show munin.web_server is set to nginx?
[2012-06-14 14:13:15 -0400] cassarani: under "override_attributes', yes
[2012-06-14 14:13:35 -0400] patcon: fujin: yeah yeah, it's 2am, but i know that's how you roll :P
[2012-06-14 14:14:08 -0400] patcon: fujin: i'll just drop it here. trying to grok all the changes in the jenkins cookbook since you took over, as well as this: https://github.com/heavywater/chef-jenkins/pull/4
[2012-06-14 14:14:21 -0400] timops: @zenigor "knife node run_list add [NODE] [cookbook::recipe]"
[2012-06-14 14:15:28 -0400] cassarani: cwj: could it be something to do with the fact that I'm running it under the _default environment? seems unlikely, but I am quite new to Chef
[2012-06-14 14:16:00 -0400] cwj: cassarani: no i dont think thats germane to this problem
[2012-06-14 14:16:54 -0400] patcon: fujin: I'd alluded to it in this issue awhile ago, but your jenkins cookbook in pennyworth didn't work as well on Vagrant: https://github.com/heavywater/pennyworth/issues/11
[2012-06-14 14:17:03 -0400] cwj: you're sure that the role on the server matches the role you gisted?
[2012-06-14 14:17:09 -0400] justsee: With the new app recipes, I've got a 'First Run Only' block, but with more than one app applied to the node, only the first app's FRO execute block runs? Logging shows the not_if conditional returns false for the other apps (as the attribute that is set is based on the app name). They just don't seem to execute the command. Odd.
[2012-06-14 14:17:10 -0400] cassarani: any way to find out?
[2012-06-14 14:17:30 -0400] cwj: knife role show monitoring
[2012-06-14 14:17:32 -0400] patcon: fujin: and now, whatever the changes were (as fnichol's worked), they've been dropped into the official jenkins cookbook, and now any jenkins restart kills it on vagrant
[2012-06-14 14:18:10 -0400] cassarani: cwj: this ios what I get https://gist.github.com/71e9849df23164d8f4c5
[2012-06-14 14:18:11 -0400] cassarani: *is
[2012-06-14 14:18:21 -0400] cwj: cassarani: guessing the role is correct on the server, since it does show nginx in your override attrs
[2012-06-14 14:18:33 -0400] cwj: yeah that looks ok
[2012-06-14 14:18:44 -0400] patcon: fujin: so I'm just wondering whether usage of the WAR might resolve this.
[2012-06-14 14:19:08 -0400] cwj: cassarani: is this monitoring role the only entry in the node's run_list?
[2012-06-14 14:19:15 -0400] cassarani: no, there are two other roles
[2012-06-14 14:19:20 -0400] cassarani: a base role and an "app" role
[2012-06-14 14:19:33 -0400] Zenigor: @timops i added it to the run_list, and after uploading the cookbook as well i get the following error on running chef-client https://gist.github.com/2930631
[2012-06-14 14:19:34 -0400] cassarani: the app role includes recipes nginx::source and monit::nginx
[2012-06-14 14:19:37 -0400] patcon: fujin: and if not, would you consider leaving some of that previous functionality in (perhaps with using an "install_method" attr like the php cookbook does -- "war" vs "package", or something)
[2012-06-14 14:19:51 -0400] cassarani: the base role doesn't include much at all, default vim config and that
[2012-06-14 14:19:57 -0400] cwj: ok
[2012-06-14 14:20:29 -0400] timops: @zenigor do you not have a default.rb in the /db_backup/recipes list?
[2012-06-14 14:21:20 -0400] timops: sorry, list = dir
[2012-06-14 14:21:27 -0400] cassarani: cwj: let me gist the Chef run
[2012-06-14 14:21:56 -0400] cassarani: cwj: https://gist.github.com/809080a4c9f0b134157a
[2012-06-14 14:22:08 -0400] Zenigor: @timops https://gist.github.com/2930650
[2012-06-14 14:22:12 -0400] cwj: i dont understand why the munin::server recipe converts node[:munin][:web_server] to a symbol for it's case switch, but i dont see why that would cause a problem either
[2012-06-14 14:22:35 -0400] cassarani: no, indeed
[2012-06-14 14:22:41 -0400] timops: @zengor, can you show me "knife node show [hostname]"
[2012-06-14 14:23:13 -0400] cwj: cassarani: if you run chef-client -l debug we can see a lot more of what is going on in the run
[2012-06-14 14:23:27 -0400] cassarani: can't, Vagrant's doing it when I run "vagrant provision"
[2012-06-14 14:23:30 -0400] cassarani: or can I?
[2012-06-14 14:23:40 -0400] timops: @zenigor - remove the file extension ".rb" from the recipe[cookbook::recipe]
[2012-06-14 14:23:54 -0400] cwj: you can manually set the run list with knife, then vagrant ssh  and sudo chef-client -l debug
[2012-06-14 14:24:00 -0400] cwj: should work
[2012-06-14 14:24:09 -0400] cassarani: yeah I already use knife
[2012-06-14 14:24:13 -0400] cassarani: ok let me have a look
[2012-06-14 14:25:03 -0400] cassarani: doesn't seem to be working
[2012-06-14 14:25:20 -0400] cassarani: it looks like it can't connect back to itself.. it's bizarre
[2012-06-14 14:25:30 -0400] Zenigor: @timops thank you very much for your help, i have added the cron task
[2012-06-14 14:25:31 -0400] cassarani: [Thu, 14 Jun 2012 14:24:05 +0000] WARN: Can not find config file: /etc/chef/client.rb, using defaults.
[2012-06-14 14:25:33 -0400] cassarani: that might be the problem
[2012-06-14 14:25:42 -0400] timops: @zenigor - awesome! let me know if you need any more help
[2012-06-14 14:26:50 -0400] cwj: is this a fresh vagrant vm? you probably want vagrant to have tried provisioning it once so that your client.rb and certificates are already in place
[2012-06-14 14:27:02 -0400] cassarani: yeah, it did, although it was never successful because of the apache issue
[2012-06-14 14:27:10 -0400] cassarani: I could remove the monitoring role and let it run
[2012-06-14 14:27:15 -0400] cassarani: to see if it changes anything
[2012-06-14 14:27:18 -0400] patcon: fujin: anyhow, feel free to skype me if i'm offline and you get a sec. thanks man
[2012-06-14 14:27:32 -0400] cwj: it would be interesting to see if it still tries to install apache without the monitoring role
[2012-06-14 14:27:35 -0400] cassarani: yeah
[2012-06-14 14:27:42 -0400] cassarani: it doesn't
[2012-06-14 14:27:52 -0400] cassarani: and I still can't find a client.rb file
[2012-06-14 14:27:56 -0400] cassarani: I just don't think Vagrant does it that way
[2012-06-14 14:28:31 -0400] cwj: probably depends on your vagrantfile setup but mine do create a client.rb
[2012-06-14 14:28:59 -0400] cassarani: apparently I can set chef.log_level = :debug in my Vagrantfile
[2012-06-14 14:29:02 -0400] cassarani: so let's try that out
[2012-06-14 14:29:08 -0400] cwj: cool
[2012-06-14 14:29:22 -0400] cassarani: ok, now I'm going to add the monitoring role back
[2012-06-14 14:36:46 -0400] cassarani: cwj: https://gist.github.com/c69a4d862c5d80cff6b5 :(
[2012-06-14 14:37:16 -0400] cwj: craaaazy pills
[2012-06-14 14:37:34 -0400] cassarani: oooh my god I know what the problem is
[2012-06-14 14:37:42 -0400] cassarani: I'm running an older version of the munin cookbook :|
[2012-06-14 14:37:45 -0400] cassarani: before they added nginx support
[2012-06-14 14:37:51 -0400] cassarani: siiiiigh
[2012-06-14 14:37:52 -0400] cwj: ah ha
[2012-06-14 14:37:58 -0400] cassarani: sorry about the waste of time
[2012-06-14 14:38:02 -0400] cwj: no worries
[2012-06-14 14:43:44 -0400] rndm: if i want to require 'shellwords' for use with a definition, where's the best place to put that?
[2012-06-14 14:46:54 -0400] BryanWB_: JBOSS should be considered harmful
[2012-06-14 14:49:21 -0400] cwj: so let it be written
[2012-06-14 15:06:26 -0400] cassarani: so all these cookbooks I'm using end up making some assumptions.. for example munin expects my server to already have a /var/www directory
[2012-06-14 15:06:41 -0400] cassarani: so where's a good place to actually create it? my 'base' recipe/role?
[2012-06-14 15:08:19 -0400] drrk: the munin recipe could make it safely, if it doesn't sepcifiy permissions etc they will be left alon I think
[2012-06-14 15:30:19 -0400] patcon: fujin: ok, I think i figured out the issue with jenkins on vagrant. node['fqdn'] is the default for node['jenkins']['server']['host']
[2012-06-14 15:31:01 -0400] patcon: which is used for  the --httpListenAddress in /etc/default/jenkins (a new template since taken over from fnichol)
[2012-06-14 15:32:05 -0400] patcon: this needs to be set to "127.0.0.1" in the chef.json of the Vagrantfile so that Pennyworth will work in cloud and vagrant
[2012-06-14 15:32:59 -0400] patcon: perhaps a sensible default would be 0.0.0.0 in the jenkins recipe itself? (which is the jenkins default anyhow when --httpListenAddress isn't set in JENKINS_ARGS)
[2012-06-14 15:33:05 -0400] patcon: fujin:  ^^
[2012-06-14 15:33:19 -0400] hoover_damm: patcon, he's been idle for 14hours
[2012-06-14 15:33:30 -0400] hoover_damm: and it's 4am in NZ
[2012-06-14 15:33:31 -0400] hoover_damm: just fyi
[2012-06-14 15:33:45 -0400] patcon: haha yeah i know, but he seems like the sorta guy who reads the backscroll :)
[2012-06-14 15:33:46 -0400] patcon: t
[2012-06-14 15:33:46 -0400] patcon: ha
[2012-06-14 15:33:52 -0400] patcon: thanks though damm
[2012-06-14 15:34:11 -0400] hoover_damm: patcon, yes 0.0.0.0 is a sensible default
[2012-06-14 15:34:39 -0400] hoover_damm: patcon, I forked the chef-jenkins repo and produced a 'war' patch to use only the war instead of the debian package if you'd like.  You can find it on github.com/damm/chef-jenkins (fujin has a pull req on it)
[2012-06-14 15:35:18 -0400] hoover_damm: default[:jenkins][:server][:host] = "0.0.0.0"
[2012-06-14 15:35:23 -0400] hoover_damm: is what I did in my attributes file personally
[2012-06-14 15:36:13 -0400] hoover_damm: kinda, i'm still not totally perked up on dbus / init action
[2012-06-14 15:36:17 -0400] hoover_damm: that still kinda makes me wanna vomit
[2012-06-14 15:36:23 -0400] hoover_damm: but i'll get over it soon I hope
[2012-06-14 15:36:27 -0400] patcon: yeah, i was looking at that. i understand accommodating different means of installing, but don't think i understood the overall reason why there couldn't be both
[2012-06-14 15:36:52 -0400] patcon: i just kinda felt for the guy who was being told he had to do things different, and would have to fork
[2012-06-14 15:36:59 -0400] hoover_damm: my client who uses that wanted the war because that's what is the default
[2012-06-14 15:37:17 -0400] patcon: don't get me wrong, i know you guys know your shit and your pull request is probably the better way of rolling :)
[2012-06-14 15:37:23 -0400] hoover_damm: so to us, it felt natural to use the war, and it gave us the feeling that if we grabbed jenkins raw
[2012-06-14 15:37:26 -0400] hoover_damm: it'd be cool
[2012-06-14 15:37:55 -0400] hoover_damm: automating theconfiguration of jenkins
[2012-06-14 15:37:59 -0400] hoover_damm: seems more of a better pull request now
[2012-06-14 15:38:15 -0400] hoover_damm: I can't speak for anyone else, but I wanna boot jenkins and have it come up with all my settings
[2012-06-14 15:38:24 -0400] hoover_damm: that's something I need to work on :/
[2012-06-14 15:38:36 -0400] patcon: touche. just felt a little heavy handed in how it was explained to the guy. didn't see why it could use an install_method attr like php does
[2012-06-14 15:38:45 -0400] patcon: haha yeah just working on that now
[2012-06-14 15:39:04 -0400] hoover_damm: oh that conversation.  Honestly people have strong opinions and sometimes they forget that this is a community world
[2012-06-14 15:39:14 -0400] hoover_damm: you shouldn't force your opinions on anyone like they are vatican law
[2012-06-14 15:39:33 -0400] hoover_damm: If his opinion was valid or not is irrelevent
[2012-06-14 15:39:53 -0400] hoover_damm: how he stressed his point was the issue
[2012-06-14 15:40:48 -0400] patcon: ah gotcha. was long. might've skimmed those parts and not picked up on where he was being pushy :)
[2012-06-14 15:41:17 -0400] patcon: anyhow, thanks for explaining. i'll give the fork code a shot
[2012-06-14 15:41:45 -0400] patcon: hoover_damm: re " I wanna boot jenkins and have it come up with all my settings" ...
[2012-06-14 15:42:35 -0400] justsee: anyone come across problem with variables in not_if statements? I'm using it in an execute resource, and it includes node.attribute?("#{app_name}_something"). If three apps call this execute method, only the first runs.
[2012-06-14 15:42:53 -0400] patcon: doing this now, and even with the current setup, it seems `notified :restart, "service[jenkins]"` added to templates allows me to get it booting with my settings. am i misunderstanding? how is the war better?
[2012-06-14 15:43:19 -0400] justsee: If I Chef::Log to print app_name within the block, it prints 'app1' on each call
[2012-06-14 15:44:07 -0400] hoover_damm: <-- what I said also applies to me.
[2012-06-14 15:44:36 -0400] patcon: justsee: an execute is just a resource, and each named resources can only exist once in the run
[2012-06-14 15:44:38 -0400] hoover_damm: patcon, trolls are getting better at trolling
[2012-06-14 15:44:49 -0400] hoover_damm: I loved how someone coined "gentle ribbing" in here
[2012-06-14 15:45:45 -0400] patcon: justsee: one sec, i can explain better. let me find link
[2012-06-14 15:52:16 -0400] patcon: hoover_damm: oops, ran out of batteries and lost the scrollback... missed that
[2012-06-14 15:52:48 -0400] patcon: justsee: re: multiple execute resources
[2012-06-14 15:52:55 -0400] justsee: patcon: ah, thanks. Basic misunderstanding as I was creating custom application provider. It's called by various apps, so I suppose I should create the execute resource with a dynamic name.
[2012-06-14 15:53:37 -0400] patcon: justsee: Note that the command is also the default name. the default name is the identifier for that resource in the... i forget the name "compiled resource library" or something http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-06-14 15:54:05 -0400] patcon: so as far as chef knows, when it does resource compilation, you just have one execute resource that runs that command
[2012-06-14 15:54:34 -0400] leifmadsen: can I use if/else statements in templates? I tried using <% if foo == bar %> .... <% else %> ... <% end %> but it seems to error out when running chef-client
[2012-06-14 15:56:02 -0400] patcon: justsee: exactly :) just use an arbitrary name and state the "command" resource attr explicitly
[2012-06-14 15:56:46 -0400] patcon: sounds like maybe you could have a single on and use `notifies :run, "resource[mycommand]", :immediately`, but maybe not
[2012-06-14 15:57:27 -0400] patcon: leifmadsen: it's all on one line as ruby seems it. use curly brackets?
[2012-06-14 15:58:16 -0400] patcon: leifmadsen: was just sorting this out by looking at this cookbook's template yesterday: ckbk.it/ssh_known_hosts
[2012-06-14 15:58:56 -0400] patcon: leifmadsen: ah wait. maybe i'm wrong there. one sec
[2012-06-14 15:59:25 -0400] patcon: oh hey, maybe this: `<% if foo == bar -%> .... <% else -%> ... <% end -%>`
[2012-06-14 15:59:39 -0400] leifmadsen: patcon: sorry was just showing on a single line for irc reasons :)
[2012-06-14 15:59:56 -0400] leifmadsen: ya thought <%  %> and <% -%> were equiv but perhaps not?
[2012-06-14 16:01:41 -0400] leifmadsen: nope... no go, don't think that is the problem...
[2012-06-14 16:02:56 -0400] patcon: leifmadsen: seems maybe relevant: http://stackoverflow.com/questions/7996695/rails-erb-syntax
[2012-06-14 16:03:32 -0400] leifmadsen: patcon: ok cool thanks -- I think the issue might actually be the way I'm checking an automatic attribute
[2012-06-14 16:04:04 -0400] patcon: leifmadsen: ah coolio. well hey, i learned something. thanks :)
[2012-06-14 16:04:11 -0400] leifmadsen: np :D
[2012-06-14 16:04:53 -0400] leifmadsen: trying to do a check against the kernel machine attribute
[2012-06-14 16:07:12 -0400] justsee: patcon: thx! Yes slipped into thinking execute was not a resource, and just a chunk of procedural code within a provider. Won't do that again!
[2012-06-14 16:08:37 -0400] patcon: justsee: sahweeet. yeah, I spent a few days being confused over that when I had two recipes that were trying to act on the same php_pear resource :)
[2012-06-14 16:08:58 -0400] specialsauce: should I be able to use require in chef recipes and use methods from those requires? I tried to use "require 'csv'" and then use the "to_csv" method in a recipe on an array and I get:
[2012-06-14 16:09:09 -0400] leifmadsen: patcon: aha it wasn't my syntax that was wrong at all -- it was the way I was accessing an automatic attribute (I was using default instead of node)
[2012-06-14 16:09:17 -0400] specialsauce: FATAL: NoMethodError: undefined method `to_csv' for ["test.test.com"]:Array
[2012-06-14 16:09:22 -0400] leifmadsen: patcon: thanks for the pointer on the %> vs -%> though!
[2012-06-14 16:09:35 -0400] patcon: specialsauce: chef_gem resource is the new hot shit that deals with that, i think
[2012-06-14 16:09:37 -0400] hoover_damm: specialsauce, require 'csv'?
[2012-06-14 16:09:51 -0400] hoover_damm: specialsauce, might need that in a ruby_block and a gem_install on that
[2012-06-14 16:10:23 -0400] patcon: http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-06-14 16:10:35 -0400] specialsauce: hoover_damm, if I run this on my localhost it Just Works(TM) and i haven't gem installed csv that i know of
[2012-06-14 16:10:59 -0400] patcon: specialsauce: http://www.opscode.com/blog/2012/05/11/chef-0-10-10-released/
[2012-06-14 16:11:57 -0400] specialsauce: patcon: thanks, my confusion comes though that I don't seem to have csv installed as a gem locally but i can use that require fine
[2012-06-14 16:12:00 -0400] patcon: leifmadsen: no problemo good sir :)
[2012-06-14 16:12:59 -0400] leifmadsen: patcon: I've been called good sir twice today in separate channels!
[2012-06-14 16:13:45 -0400] patcon: specialsauce: ah ok, sorry, guess i skimmed too quickly
[2012-06-14 16:14:16 -0400] patcon: leifmadsen: *no problemo, scoundrel
[2012-06-14 16:14:21 -0400] leifmadsen: :D
[2012-06-14 16:15:22 -0400] patcon: in your favour, whenever i call someone a "good sir" on the internet, i imagine them wearing a tophat
[2012-06-14 16:15:44 -0400] leifmadsen: although I've never tried a tophat
[2012-06-14 16:15:56 -0400] specialsauce: hoover_damm, i think you may be right i just need to use a ruby block round the require?
[2012-06-14 16:16:14 -0400] hoover_damm: specialsauce, yep
[2012-06-14 16:16:25 -0400] specialsauce: hoover_damm, cheers
[2012-06-14 16:16:33 -0400] hoover_damm: specialsauce, 1.9.x may have csv in stdlib now
[2012-06-14 16:16:36 -0400] hoover_damm: specialsauce, 1.8.x doesn't
[2012-06-14 16:16:48 -0400] specialsauce: gah, ok, that explains it I think
[2012-06-14 16:16:56 -0400] hoover_damm: specialsauce, so you may need to just ensure that the csv gem is installed and required
[2012-06-14 16:16:59 -0400] patcon: leifmadsen: bwahaha the pirate hat is my go-to hangoutcessory
[2012-06-14 16:17:05 -0400] hoover_damm: there's several csv gems to make this fun
[2012-06-14 16:17:10 -0400] hoover_damm: but fastercsv should work
[2012-06-14 16:36:22 -0400] workmad3: hoover_damm: CSV was in the stdlib in 1.8 and 1.9
[2012-06-14 16:36:34 -0400] workmad3: hoover_damm: but 1.9's CSV is actually what used to be the fastercsv gem
[2012-06-14 16:39:43 -0400] specialsauce: workmad3: so in my ruby 1.8 why do i get this nomethod error?
[2012-06-14 16:40:06 -0400] specialsauce: if i try it on my 1.8 ruby from the cmdline (not thru chef) i get the same error
[2012-06-14 16:40:26 -0400] specialsauce: ie it doesn't seem to know about to_csv (it doesn't error on the require, just the to_csv method)
[2012-06-14 16:40:41 -0400] workmad3: specialsauce: I don't know what the interface for CSV is in 1.8
[2012-06-14 16:40:49 -0400] workmad3: specialsauce: at a guess, it doesn't give you a to_csv method
[2012-06-14 16:40:54 -0400] specialsauce: ah ok, so i just need to find an old doc page? maybe different method name?
[2012-06-14 16:41:48 -0400] workmad3: specialsauce: that would be my guess, yes
[2012-06-14 16:42:05 -0400] specialsauce: ok cheers, will check that out
[2012-06-14 16:42:08 -0400] workmad3: specialsauce: but the fact that 'require "csv" ' worked shows that it was there, NoMethodError means you're not using it right ;)
[2012-06-14 16:42:58 -0400] yfeldblum: both 1.8.7 and 1.9.3 stdlib csv have Array#to_csv
[2012-06-14 16:43:10 -0400] yfeldblum: http://rubydoc.info/stdlib/csv/frames/1.8.7 and http://rubydoc.info/stdlib/csv/frames/1.9.3
[2012-06-14 16:44:35 -0400] specialsauce: huh, well it works for me on 1.9.2 on my localhost but not on 1.8.7 on my server
[2012-06-14 16:49:48 -0400] hoover_damm: workmad3, hrm... then I forget what's different here
[2012-06-14 16:50:54 -0400] specialsauce: require 'csv'
[2012-06-14 16:50:54 -0400] specialsauce: a = Array.new(5)
[2012-06-14 16:50:54 -0400] specialsauce: a = [ "a", "c", 7, 4, 2 ]
[2012-06-14 16:50:54 -0400] specialsauce: b = a.to_csv
[2012-06-14 16:50:54 -0400] specialsauce: puts b
[2012-06-14 16:51:12 -0400] specialsauce: That seems pretty simple and works on 1.9.2 but gives the noMethod error on 1.8.7 (for me)
[2012-06-14 16:52:02 -0400] matti: specialsauce: to_cvs you mean?
[2012-06-14 16:52:21 -0400] c_t: I think he means to_csv
[2012-06-14 16:52:22 -0400] matti: s/cvs/csv/
[2012-06-14 16:52:26 -0400] matti: Typo.
[2012-06-14 16:53:08 -0400] specialsauce: matti: sorry, not following. typo where?
[2012-06-14 16:53:39 -0400] c_t: I do remember there being some big change with csv stuff between 1.8 and 1.9 though
[2012-06-14 16:53:52 -0400] c_t: I think the default csv module changed somewhere along the line
[2012-06-14 16:54:09 -0400] specialsauce: all i need is a working way of changing an array to csv in 1.8.7 :-(
[2012-06-14 16:54:33 -0400] yfeldblum: huh apparently that 1.8.7 link is actually for 1.9.3
[2012-06-14 16:54:37 -0400] yfeldblum: that's a fail
[2012-06-14 16:54:55 -0400] yfeldblum: 1.8.7 = https://github.com/ruby/ruby/blob/v1_8_7_358/lib/csv.rb ... 1.9.3 = https://github.com/ruby/ruby/blob/v1_9_3_194/lib/csv.rb
[2012-06-14 16:55:30 -0400] yfeldblum: in the 1.8.7-tagged file, the text "to_csv" is nowhere to be found
[2012-06-14 16:56:07 -0400] matti: specialsauce: https://gist.github.com/2931471
[2012-06-14 16:56:20 -0400] matti: specialsauce: You can monkey-patch Array to add missing bit.
[2012-06-14 16:56:23 -0400] specialsauce: thanks yfeldbum, that explains it. just got to try and find the undocument equivalent in 2k lines of ruby then :-P
[2012-06-14 16:57:02 -0400] hoover_damm: yfeldblum, woot makes sense now
[2012-06-14 16:57:19 -0400] hoover_damm: I knew csv was fail on 1.8.x but couldn't remember why
[2012-06-14 16:57:22 -0400] matti: specialsauce: Or, you can add monkey patch on the top / separate file :)
[2012-06-14 16:59:15 -0400] matti: specialsauce: You can detect interpreter version and then decide to add mokey-patch or not. Or simply check if symbol :to_csv exists in Array class and if not, then add.
[2012-06-14 16:59:27 -0400] specialsauce: so this might be closer to the truth then: http://ruby-doc.org/stdlib-1.8.6/libdoc/csv/rdoc/CSV.html
[2012-06-14 16:59:48 -0400] matti: ?
[2012-06-14 16:59:52 -0400] specialsauce: matti: that's probably a bit beyond me, not a ruby dev (outside of limited chef scope) or in fact a dev at all :-)
[2012-06-14 17:00:04 -0400] matti: specialsauce: This is not a rocket science.
[2012-06-14 17:00:17 -0400] matti: specialsauce: Google for relevant things and add accordingly.
[2012-06-14 17:00:54 -0400] matti: specialsauce: :)
[2012-06-14 17:01:30 -0400] specialsauce: matti: by far the simpler option is me writing 5 lines of ruby to convert an array to a csv myself in a for loop
[2012-06-14 17:01:46 -0400] hoover_damm: specialsauce, isn't the easiest option to just install fastercsv and use that?
[2012-06-14 17:01:47 -0400] specialsauce: i just hoped there would be a nice way of doing it
[2012-06-14 17:02:14 -0400] hoover_damm: https://github.com/JEG2/faster_csv/tree/master/examples
[2012-06-14 17:02:26 -0400] matti: specialsauce: No need for a loop.
[2012-06-14 17:02:34 -0400] matti: specialsauce: CSV#generate_line
[2012-06-14 17:02:35 -0400] hoover_damm: specialsauce, he's got examples and yeah there's no need to loop
[2012-06-14 17:02:36 -0400] matti: specialsauce: CSV#generate
[2012-06-14 17:03:35 -0400] specialsauce: hoover_damm, i'm really new to rubygems. i tried installing fastercsv and re-running and it still errors
[2012-06-14 17:03:46 -0400] specialsauce: matti: isn't that using writer and expecting output to a file?
[2012-06-14 17:04:05 -0400] matti: specialsauce: No.
[2012-06-14 17:04:19 -0400] matti: specialsauce: http://ruby-doc.org/stdlib-1.8.7/libdoc/csv/rdoc/CSV.html
[2012-06-14 17:04:26 -0400] matti: specialsauce: :)
[2012-06-14 17:06:01 -0400] hoover_damm: honestly using matti's monkeypatch maybe best
[2012-06-14 17:06:13 -0400] hoover_damm: this is a weak spot, fastercsv doesn't work the same way on 1.9.x as it does on 1.8.x
[2012-06-14 17:06:39 -0400] hoover_damm: so unless if you wanna update your clients to 1.9.x which actually might be the easiest answer
[2012-06-14 17:06:44 -0400] hoover_damm: go to 1.9.x and use stdlib csv
[2012-06-14 17:07:33 -0400] matti: Em.
[2012-06-14 17:07:36 -0400] matti: specialsauce: FAIL
[2012-06-14 17:07:37 -0400] matti: ;)
[2012-06-14 17:07:50 -0400] specialsauce: option a: write a for loop
[2012-06-14 17:07:55 -0400] specialsauce: option b: use broken syntax
[2012-06-14 17:08:02 -0400] specialsauce: option c: change a package on hundreds of hosts
[2012-06-14 17:08:16 -0400] specialsauce: what's wrong with option a? its by far the quickest and least dangerous
[2012-06-14 17:08:19 -0400] matti: d: learn more about technologies in use
[2012-06-14 17:09:09 -0400] specialsauce: matti: can you explain? i really don't see what you are suggesting. i've tried using csv and can't get it to work on 1.8.7
[2012-06-14 17:09:17 -0400] nicholasr-bf: array.inspect[1..-1]?
[2012-06-14 17:09:21 -0400] specialsauce: i can't upgrade all my hosts just for this and possibly break other stuff
[2012-06-14 17:09:32 -0400] specialsauce: i need a simple solution
[2012-06-14 17:11:08 -0400] specialsauce: i'd be happy to use the 1.8.7 csv method if i could figure it out from the impenetrable doc page
[2012-06-14 17:11:11 -0400] hoover_damm: we gave you 2 simple solutions
[2012-06-14 17:11:18 -0400] hoover_damm: you need to figure out which one you want to use
[2012-06-14 17:11:24 -0400] nicholasr-bf: sorry arr.inspect[1..-2]
[2012-06-14 17:11:35 -0400] specialsauce: i'm not patching ruby on hundreds of hosts. what was the other option?
[2012-06-14 17:11:38 -0400] hoover_damm: personally i'm going to make breakfast and not bother
[2012-06-14 17:11:49 -0400] hoover_damm: scrollback ftw specialsauce
[2012-06-14 17:11:59 -0400] specialsauce: nicholasr-bf, thank you! lovely and simple
[2012-06-14 17:14:34 -0400] ashb: Sooo chef-client by what ever means I had doesn't ever rotate it logs
[2012-06-14 17:14:44 -0400] ashb: (default bootstrapping for ec2 create)
[2012-06-14 17:15:18 -0400] juliancdunn: ashb: make a logrotate script for it
[2012-06-14 17:15:40 -0400] ashb: juliancdunn: thats the easy part. I was thinking more the bootstrap needs to do that
[2012-06-14 17:16:09 -0400] juliancdunn: well many people like to have logrotate on their boxes anyway
[2012-06-14 17:16:18 -0400] juliancdunn: I just put my chef-client logrotate script in the logrotate cookbook
[2012-06-14 17:16:38 -0400] ashb: juliancdunn: i.e. i'm lazy and it should autoamtically do it all for me
[2012-06-14 17:17:02 -0400] juliancdunn: haha well feel free to customize the bootstrap script
[2012-06-14 17:17:20 -0400] ashb: ;)
[2012-06-14 17:26:47 -0400] rgsteele: If you use "set[:foo][:bar]", does it set the attribute at a different level than normal or default?  I just looked at one of the opscode cookbooks, and they're using set instead of default in attributes/default.rb.
[2012-06-14 17:29:11 -0400] specialsauce: the array inspect method works like a charm in my cookbook, thanks to all who spent time helping me with that issue, really appreciate it and apologies if i didn't appear receptive to some of the ideas
[2012-06-14 17:39:01 -0400] simonjj: anyone know I can notify a loop ?
[2012-06-14 17:42:24 -0400] yfeldblum: simonjj, i can't make out what you mean; can you clarify?
[2012-06-14 17:42:38 -0400] simonjj: or alternatively, how can I use regular resources inside a ruby block
[2012-06-14 17:42:58 -0400] yfeldblum: rgsteele, if you use `set`, it's set at normal level ... so don't use it in an attributes file
[2012-06-14 17:43:08 -0400] yfeldblum: simonjj, why do you need to do that?
[2012-06-14 17:44:47 -0400] yfeldblum: simonjj, the chef model is that you start off by running ruby code that asks questions from the server and asks questions from the network and asks questions from the chef-server-api and comes up with a complete and total list of resources and their attributes and the actions to be taken on those resources; after all that, after all the recipe code is run and the resources are declared and the searches are completed and the node attribut
[2012-06-14 17:44:47 -0400] yfeldblum: es are inspected, once all that is done, then chef-client goes and runs the actions for those resources in order to change the system to match the declared resources
[2012-06-14 17:45:25 -0400] yfeldblum: simonjj, the question you're asking seems to try to evade the chef model, which means things will be tricky at the least, so why do you think you need to do it that way?
[2012-06-14 17:45:42 -0400] simonjj: because I have a bunch of things I need to import into a DB.... so I either can do something like this: https://gist.github.com/2931700
[2012-06-14 17:45:57 -0400] simonjj: OR somehow manage to use regular resources inside a ruby_block
[2012-06-14 17:46:35 -0400] simonjj: the things that need importing are set as attributes
[2012-06-14 17:46:47 -0400] robotwitharose: hi all, I need some syntax help. I'm trying to set the value for a host dynamically in attributes/default.rb for a cookbook
[2012-06-14 17:46:56 -0400] rgsteele: yfeldblum: Yeah, I finally found docs for it - "set" in an attributes file has precedence 5/10
[2012-06-14 17:46:57 -0400] robotwitharose: here is the attributes file: https://gist.github.com/d245bd65015354b8c376
[2012-06-14 17:47:12 -0400] robotwitharose: default_host is always evaluating to "node"
[2012-06-14 17:47:27 -0400] robotwitharose: but if I do default_host.fqdn or default_host[:fqdn], the run fails
[2012-06-14 17:48:02 -0400] robotwitharose: [Thu, 14 Jun 2012 12:26:19 -0400] FATAL: NoMethodError: undefined method `fqdn' for :node:Symbol
[2012-06-14 17:48:32 -0400] yfeldblum: simonjj, you understand that `4.times { script "myscript" }` will only create one script resource, not 4, right?
[2012-06-14 17:49:20 -0400] yfeldblum: simonjj, unless the gist is too simplified and actually each of those 4 script resources has a different name like `4.times { |i| script "myscript=#{i}" }`
[2012-06-14 17:50:32 -0400] simonjj: yfeldblum: yes, this is very simplified... I am fully aware that this is one script resource
[2012-06-14 17:50:33 -0400] rayrod2030: anybody have to deal with connection refused errors coming from chef server/?
[2012-06-14 17:51:04 -0400] rayrod2030: I recently moved the couchdb file updating the couchdb config.
[2012-06-14 17:51:32 -0400] simonjj: yfeldblum: it's one of the two (import of resource inside ruby_block or notification of loop).... OR a disgusting big monolithic bash script
[2012-06-14 17:51:48 -0400] simonjj: yfeldblum: the last option is the least preferred
[2012-06-14 17:52:51 -0400] yfeldblum: simonjj, check the comment
[2012-06-14 17:53:33 -0400] yfeldblum: simonjj, if you don't like that, are you familiar with using subscriptions instead of notifications?
[2012-06-14 17:54:18 -0400] yfeldblum: simonjj, because you can declare the execute resource and the script/code resources after it, and then each of the script/code resources can subscribe to the execute resource rather than the execute resource notifying each of the script/code blocks
[2012-06-14 17:54:20 -0400] simonjj: yfeldblum: yup, seen them, would that make for more compact code ?
[2012-06-14 17:54:26 -0400] randomautomator: hey guys is there anyway for to make recusive directory creation also recursive chown?
[2012-06-14 17:54:50 -0400] randomautomator: i'm seeing the parent directories owned as root but the last in path owned by the user i define
[2012-06-14 17:54:57 -0400] simonjj: yfeldblum: I'll take a look at subscriptions
[2012-06-14 17:55:02 -0400] simonjj: yfeldblum: thanks
[2012-06-14 17:55:39 -0400] yfeldblum: simonjj, second comment
[2012-06-14 17:56:09 -0400] yfeldblum: simonjj, make sure to always set the action for things that should only be run when notified (or subscribed) to have an action of :nothing
[2012-06-14 17:56:33 -0400] aslan: hi experts... i have a question about chef server... is there any way to built some redundancy into the chef server? something like putting two of them behind a load balancer and in case one failed have the other one working? this solution obviously helps with the load but that is not my primary goal. I want to make sure if one of the chef servers is not responding there is at least one healthy server ?
[2012-06-14 17:56:39 -0400] simonjj: yfeldblum: obviously, yes, thanks
[2012-06-14 17:57:58 -0400] yfeldblum: simonjj, heh please don't be offended if i explain things of which you are already well aware
[2012-06-14 17:59:12 -0400] rayrod2030: anybody ever have to deal with a connection refused from chef server at 4000
[2012-06-14 17:59:38 -0400] randomautomator: rayroy2030: ya but mine's usually a time sync problem
[2012-06-14 18:01:51 -0400] hoover_damm: aslan, take a look at private chef
[2012-06-14 18:02:04 -0400] hoover_damm: aslan, http://www.opscode.com/private-chef/
[2012-06-14 18:03:10 -0400] hoover_damm: aslan, might be worth the talk with sales over
[2012-06-14 18:04:10 -0400] aslan: hoover_damm: i dont think that would be our first choice.
[2012-06-14 18:04:36 -0400] hoover_damm: aslan, for you? it would be mine
[2012-06-14 18:05:18 -0400] hoover_damm: aslan, I've watched you ask for help over the past year or so and helped you when I could.  I just wish sometimes I had a way to help directly
[2012-06-14 18:05:53 -0400] aslan: hoover_damm: we have been using chef for the past 3 years maybe ... with all of the ups and downs i think we like to have our own servers
[2012-06-14 18:05:55 -0400] hoover_damm: aslan, I don't work for Opscode so this isn't me trying to sell you something.  Your pretty smart and savvy and the problems you have sometimes I think Opscode could take your hand and help you better with.
[2012-06-14 18:06:16 -0400] hoover_damm: bout the same time as me then
[2012-06-14 18:06:17 -0400] hoover_damm: hehe
[2012-06-14 18:06:44 -0400] randomautomator: so does anyone know a workaround for recursive directory creation as a user instead of me running a chown command after?
[2012-06-14 18:06:54 -0400] hoover_damm: So my suggestion is after reviewing the docs to private Chef.  They look awesome
[2012-06-14 18:07:01 -0400] hoover_damm: and the end result looks A+
[2012-06-14 18:07:24 -0400] hoover_damm: aslan, you can't get the rpm/deb to complete it.  But you can find the docs here http://private-chef-docs.opscode.com/
[2012-06-14 18:07:29 -0400] aslan: hoover_damm: i understand. I think my boss would not approve that. with all the investment put into learning chef and managing it.
[2012-06-14 18:07:38 -0400] hoover_damm: aslan, and you can contact sales if you want to look into it more
[2012-06-14 18:07:56 -0400] hoover_damm: aslan, I would hope he would approve as it's making use of your time better
[2012-06-14 18:08:12 -0400] aslan: hoover_damm: i will bring it up with my supervisor
[2012-06-14 18:08:20 -0400] hoover_damm: aslan, personally my workflow improved highly once I stopped managing Chef Server
[2012-06-14 18:08:46 -0400] yfeldblum: randomautomator, Process#gid=, Process#egid=, Process#uid=, Process#euid=, Kernel#fork, Kernel#exec, and FileUtils.mkpath
[2012-06-14 18:08:51 -0400] hoover_damm: it's an extra chore that if you can write off your list, win.
[2012-06-14 18:09:02 -0400] rndm: can definitions from one cookbook reference another?
[2012-06-14 18:09:13 -0400] yfeldblum: rndm, yes
[2012-06-14 18:09:16 -0400] hoover_damm: yup
[2012-06-14 18:09:18 -0400] rndm: i'm getting "cannot find resource"
[2012-06-14 18:09:20 -0400] aslan: hoover_damm: it might be a little too pricey for us... at peak we go up to 200 servers
[2012-06-14 18:09:23 -0400] rndm: for a definition in one of my cookbooks
[2012-06-14 18:09:29 -0400] aslan: that is going to cost a lot
[2012-06-14 18:09:32 -0400] yfeldblum: rndm, just make sure, though, that the other cookbook is listed in the first cookbook's metadata.rb as a dependency
[2012-06-14 18:09:32 -0400] rndm: i do reference the other in the metadata
[2012-06-14 18:09:33 -0400] hoover_damm: aslan, Hosted isn't an option for you?
[2012-06-14 18:10:05 -0400] rndm: better :wall here and make sure it's not me =)
[2012-06-14 18:11:02 -0400] simonjj: yfeldblum: no worries about offending me, muchas gracias for you help
[2012-06-14 18:11:06 -0400] aslan: hoover_damm: hum hosted chef and private chef are two different things right?
[2012-06-14 18:11:25 -0400] mattray: aslan: correct
[2012-06-14 18:11:41 -0400] yfeldblum: mattray, might i suggest offering just a few more details?
[2012-06-14 18:12:02 -0400] aslan: hoover_damm: I was thinking of hosted chef then ... so what is private chef?
[2012-06-14 18:12:03 -0400] mattray: aslan: hosted is a SaaS, private is installed on site
[2012-06-14 18:12:12 -0400] rndm: yep, i'm dumb. i added the definitions in question to the wrong cookbook
[2012-06-14 18:12:17 -0400] aslan: ah
[2012-06-14 18:12:18 -0400] mattray: aslan: opscode comes and installs it on your hardware
[2012-06-14 18:12:28 -0400] mattray: gives you the keys
[2012-06-14 18:12:42 -0400] mattray: and supports it
[2012-06-14 18:12:43 -0400] aslan: my hardware is all up in the amazon cloud
[2012-06-14 18:12:58 -0400] hoover_damm: http://private-chef-docs.opscode.com/engagement.html
[2012-06-14 18:13:05 -0400] hoover_damm: so they would install it on amazon cloud and give you the keys?
[2012-06-14 18:13:08 -0400] hoover_damm: LOL
[2012-06-14 18:13:20 -0400] mattray: well, if Hosted Chef is not an option, there is currently a customer or 2 running Private Chef on AWS
[2012-06-14 18:13:21 -0400] aslan: :
[2012-06-14 18:13:23 -0400] aslan: :D
[2012-06-14 18:13:38 -0400] mattray: hoover_damm: yes indeed
[2012-06-14 18:13:48 -0400] aslan: I have to look into private chef... it sounds more interesting than hosted chef
[2012-06-14 18:14:03 -0400] hoover_damm: aslan, fwiw check out the prices on http://www.opscode.com/hosted-chef/
[2012-06-14 18:14:21 -0400] mattray: yeah, Private Chef is more expensive up front
[2012-06-14 18:14:26 -0400] aslan: but all that said ... back to my original question... have you guys had any experience about building redundancy into the chef server?
[2012-06-14 18:15:01 -0400] hoover_damm: aslan, they have.  Private chef
[2012-06-14 18:15:04 -0400] mattray: aslan: I think there's been some action on the wiki about it http://wiki.opscode.com/display/chef/Scalability+and+High+Availability
[2012-06-14 18:15:06 -0400] aslan: It sounds complicated because of all the architecture built into chef server, the queue the indexing the couchdb etc
[2012-06-14 18:15:21 -0400] hoover_damm: I mean i've checked out the page that mattray linked there and to me if I have to do it tomorrow
[2012-06-14 18:15:24 -0400] hoover_damm: i'd just do private
[2012-06-14 18:15:26 -0400] hoover_damm: screw the price
[2012-06-14 18:15:37 -0400] mattray: aslan: Private Chef docs for it are here: http://private-chef-docs.opscode.com/installation/ha.html
[2012-06-14 18:15:50 -0400] mattray: you can see how we do it, doc it for the wiki if you want
[2012-06-14 18:16:22 -0400] aslan: mattray: thanks... thats a good starting point. I will also look into private chef pricing model and how much it could cost us
[2012-06-14 18:16:59 -0400] mattray: good luck
[2012-06-14 18:17:13 -0400] yfeldblum: mattray, linking to the obvious relevant wiki/doc/source page is *my* thing in this channel!
[2012-06-14 18:17:40 -0400] mattray: yfeldblum: :)
[2012-06-14 18:17:54 -0400] mattray: hoover_damm: much appreciated
[2012-06-14 18:18:06 -0400] aslan: hoover_damm: thank you too... you have always been a great help :)
[2012-06-14 18:18:58 -0400] hoover_damm: mattray, Thank you and Opscode for makign such a great product :)
[2012-06-14 18:19:29 -0400] mattray: free hugs all around!
[2012-06-14 18:20:15 -0400] rayrod2030: if my chef-server is failing to start where can I look for logging other than server.log?
[2012-06-14 18:20:15 -0400] mattray: http://www.dtmf.org/~siezer/freehugs.jpg
[2012-06-14 18:21:11 -0400] aslan: lol
[2012-06-14 18:32:34 -0400] rayrod2030: ok so I lost my couchdb file.  Any way to recover without rebuilding every node?
[2012-06-14 18:32:41 -0400] rayrod2030: or reregistering.
[2012-06-14 18:35:16 -0400] hoover_damm: how did you loose it? rm?
[2012-06-14 18:35:47 -0400] hoover_damm: provided you have a backup of a copy of chef.couch that works you can recover your data.  Otherwise you'd have to restart chef-server-api and generate new keys and then re-bootstrap all your nodes
[2012-06-14 18:36:03 -0400] hoover_damm: or at least that's the way I know off off the top of my head
[2012-06-14 18:40:26 -0400] rayrod2030: never mind.  everything is fine now.  thanks!
[2012-06-14 18:41:00 -0400] rayrod2030: moved couchdb to another mount and when I was troubleshooting an issue and restarted the server I had forgotten to remount
[2012-06-14 18:41:08 -0400] rayrod2030: restarted all the services and it's working fine now.
[2012-06-14 18:41:38 -0400] rayrod2030: learned some fun stuff about debugging mere startup though. :)
[2012-06-14 18:41:43 -0400] rayrod2030: merb
[2012-06-14 18:44:42 -0400] hoover_damm: lucky you
[2012-06-14 19:20:54 -0400] rayrod2030: anybody ever have a situation where a node bootstraps with no errors and the node and client show up in chef server but the node never shows up in the status page?
[2012-06-14 19:21:10 -0400] yfeldblum: anyone know how to run a git ssh server as the current, non-root user?
[2012-06-14 19:21:19 -0400] blitzrage: anyone happen to know how to generate a password for use with the 'user' resource on a non-ubuntu system? (fedora)
[2012-06-14 19:21:45 -0400] hoover_damm: blitzrage, passwd user
[2012-06-14 19:21:49 -0400] hoover_damm: blitzrage, cat /etc/shadow
[2012-06-14 19:21:55 -0400] hoover_damm: blitzrage, copy and paste the crypted field
[2012-06-14 19:22:05 -0400] blitzrage: hoover_damm: thanks
[2012-06-14 19:36:27 -0400] pwf: does anyone have a good workaround for this http://tickets.opscode.com/browse/CHEF-2928
[2012-06-14 19:36:30 -0400] pwf: it's driving me crazy
[2012-06-14 20:11:18 -0400] blitzrage: hey all, I'm having an issue where I'm trying to use the password attribute in the user resource, but it is telling me I need ruby-shadow. However, I've installed ruby-shadow on the node, my knife workstation, and the chef server... the Resources wiki page doesn't seem to be clear where it needs to be installed.
[2012-06-14 20:12:11 -0400] ampledata: the Node that will Resource will be run on
[2012-06-14 20:12:21 -0400] ampledata: that is, the node that you're adding the user to
[2012-06-14 20:12:31 -0400] blitzrage: ya that was my first guess ;)  I wonder if I need to install via gem instead of yum
[2012-06-14 20:12:33 -0400] blitzrage: probably
[2012-06-14 20:13:17 -0400] ampledata: what version of chef are you using?
[2012-06-14 20:13:24 -0400] blitzrage: 0.10.10
[2012-06-14 20:13:27 -0400] ampledata: ok
[2012-06-14 20:13:32 -0400] ampledata: u can use the chef_gem resource
[2012-06-14 20:14:08 -0400] ampledata: chef_gem('ruby-shadow'){ action :install }
[2012-06-14 20:14:13 -0400] ampledata: before you call the user Resource
[2012-06-14 20:15:00 -0400] blitzrage: ya, seems I don't have rubygems installed on that node. A yum install of ruby-shadow seems to have not done it unfortunately :(
[2012-06-14 20:15:15 -0400] ampledata: ah
[2012-06-14 20:15:21 -0400] cwj: i should really submit a pull request for that
[2012-06-14 20:15:46 -0400] blitzrage: wherever the yum installs ruby-shadow must not be getting searched in the library path or something
[2012-06-14 20:15:55 -0400] cwj: https://github.com/needle-cookbooks/chef-opscode-users/commits/COOK-937
[2012-06-14 20:17:06 -0400] cwj: better link perhaps https://github.com/needle-cookbooks/chef-opscode-users/compare/master...COOK-937
[2012-06-14 20:17:27 -0400] blitzrage: :S
[2012-06-14 20:19:00 -0400] ampledata: hey cwj
[2012-06-14 20:19:14 -0400] ampledata: fwiw you can avoid the variable assignment on 44 and just add .run_action to 'end'
[2012-06-14 20:19:38 -0400] cwj: oh, ok
[2012-06-14 20:19:51 -0400] ampledata: ~ gem_package('ruby-shadow'){ action :nothing }.run_action(:install)
[2012-06-14 20:20:05 -0400] cwj: thats cleaner, thanks
[2012-06-14 20:21:04 -0400] blitzrage: if I don't specify a password using the user resource, is a random password generated?
[2012-06-14 20:21:15 -0400] Edgan: Anyone know of a repo for Chef and Fedora 17?
[2012-06-14 20:22:18 -0400] cwj: blitzrage: i think they get a splatted password
[2012-06-14 20:22:31 -0400] blitzrage: cwj: splatted? (that's a new term for me :))
[2012-06-14 20:22:35 -0400] ampledata: yeah wtf?
[2012-06-14 20:22:36 -0400] bawt_: yeah wtf is up with that skeptomai
[2012-06-14 20:23:05 -0400] cwj: some people call the asterisk a splat
[2012-06-14 20:23:16 -0400] ampledata: what planet are those people from?
[2012-06-14 20:23:21 -0400] blitzrage: heh
[2012-06-14 20:23:26 -0400] cwj: shrug
[2012-06-14 20:23:36 -0400] cwj: splatted is more fun to say than 'disabled by an asterisk'
[2012-06-14 20:23:47 -0400] cassarani: so all my nodes under Chef are munin nodes now, and then some of those nodes run nginx. During a chef run for those nodes with nginx, I need to enable the munin nginx plugin, which is easily done using a definition from within munin cookbook.
[2012-06-14 20:23:50 -0400] ampledata: octothorpe!
[2012-06-14 20:23:53 -0400] ampledata: hash!
[2012-06-14 20:24:13 -0400] cassarani: My question is, where should that go? Should I put that into the nginx cookbook that I'm using, or should I create a cookbook to abstract away the notion of "a server with nginx that's also a munin-node"?
[2012-06-14 20:24:13 -0400] blitzrage: shift eight
[2012-06-14 20:24:16 -0400] miah: i like octothorpe the most
[2012-06-14 20:24:26 -0400] miah: primarily because it confuses people
[2012-06-14 20:25:10 -0400] ampledata: cassarani: i'd create another recipe inside the munin cookbook
[2012-06-14 20:25:14 -0400] cwj: cassarani: if it were me i would fork the nginx cookbook and add a recipe nginx::munin
[2012-06-14 20:25:25 -0400] cassarani: the plot thickens :P
[2012-06-14 20:25:27 -0400] ampledata: or that :)
[2012-06-14 20:25:34 -0400] cassarani: well, yes, I can see that either of them would work
[2012-06-14 20:25:38 -0400] cwj: really depends on how you want to think about your systems
[2012-06-14 20:25:46 -0400] ampledata: i'd say stick it in the munin cookbook to avoid injecting a dependency on nginx
[2012-06-14 20:25:54 -0400] cassarani: well munin already depends on nginx
[2012-06-14 20:26:05 -0400] cassarani: whereas nginx doesn't depend on munin
[2012-06-14 20:26:11 -0400] cassarani: so yes
[2012-06-14 20:26:18 -0400] cwj: yeah that does save you some work
[2012-06-14 20:26:47 -0400] cassarani: so then for those servers that are running nginx, I should add the nginx::munin recipe to their role, or whatever?
[2012-06-14 20:27:01 -0400] ampledata: also wtf graphite, seriously?
[2012-06-14 20:27:01 -0400] cassarani: or munin::nginx :P
[2012-06-14 20:27:52 -0400] cassarani: ampledata: I'm assuming that's unrelated to my discussion
[2012-06-14 20:28:15 -0400] ampledata: sorry kvetching
[2012-06-14 20:30:22 -0400] miah: i would do as cwj suggested, nginx::munin
[2012-06-14 20:31:01 -0400] miah: cassarani: you could add a recipe that detects if munin/nrpe/etc is used and include_recipe where appropriate. or yes. just included nginx::munin in their role
[2012-06-14 20:31:42 -0400] cassarani: miah: well, what I do like about using munin::nginx instead of the other way around, is that it sort of matches the way my monit recipes are set out
[2012-06-14 20:31:49 -0400] cassarani: where I have for instance monit::postfix to.. monit postfix
[2012-06-14 20:31:57 -0400] hoover_damm: anyone notice how on ubuntu/debian distros you can't ssh root@server and then stuff 4-5 commands deep?
[2012-06-14 20:32:02 -0400] cassarani: and so it makes sense to me to have munin::nginx for a very similar task
[2012-06-14 20:32:26 -0400] hoover_damm: horrible habbit of mine firefighting is to just ssh into the box and stuff in 4-5 commands and it's annoying when you can't
[2012-06-14 20:32:33 -0400] cassarani: but at the same time, the steps involved in setting up munin::nginx (or nginx::munin) are basically adding a new sites-available file to the nginx conf and enabling it
[2012-06-14 20:32:37 -0400] miah: cassarani: if that is how you manage things, then you should probably continue that pattern. i personally like to stick monitoring related things for a specific cookbook in that cookbook
[2012-06-14 20:32:38 -0400] cassarani: so it's a very nginx-centric process
[2012-06-14 20:32:39 -0400] hoover_damm: like apt-get install -y iotop and suddenly what's beyond that is lost after it installs.
[2012-06-14 20:33:23 -0400] cassarani: miah: that's a good point, from a design point of view it seems like each component should carry the burden of setting up its own monitoring
[2012-06-14 20:33:32 -0400] hoover_damm: i wonder if it's the command not found stuff that clogs that up
[2012-06-14 20:36:00 -0400] miah: cassarani: yup. the other thing people forget to set up is log management.
[2012-06-14 20:36:06 -0400] barefoot: so, when you have something like { "my_values": { "one": 1 }}, does that cause issues with search, i.e. "my_values_one:1" ? i seem to be getting inconsistent results
[2012-06-14 20:36:25 -0400] barefoot: s/that/the underscore/
[2012-06-14 20:38:28 -0400] cassarani: miah: indeed, for instance my Rails apps set up their own logrotate config
[2012-06-14 20:38:43 -0400] cassarani: miah: so I think to keep that consistency I'll go with nginx::munin
[2012-06-14 20:38:46 -0400] cassarani: miah: thanks :)
[2012-06-14 20:51:18 -0400] miah: indeed. good luck =)
[2012-06-14 20:51:36 -0400] pcn: ohai chefs
[2012-06-14 20:52:20 -0400] pcn: Does anyone know how to get chef-solo to give me a better message than "NoMethodError: undefined method `-'  for nil:NilClass
[2012-06-14 20:52:39 -0400] miah: look at the stacktrace.out for further debugging
[2012-06-14 20:53:33 -0400] pcn: Nah, it's not telling me anything:
[2012-06-14 20:55:19 -0400] pcn_: Darn, other window is frozen
[2012-06-14 20:55:26 -0400] pcn_: Anyway, no help:
[2012-06-14 20:55:55 -0400] pcn_:  /usr/lib/ruby/gems/1.9.1/gems/chef-0.10.8/lib/chef/mixin/template.rb:74:in `source_listing'
[2012-06-14 20:57:17 -0400] pcn: So clearly I'm using ruby 1.9, and chef 0.10.8
[2012-06-14 20:57:21 -0400] pcn: Anyone else experience this?
[2012-06-14 20:57:55 -0400] pcn: And anyone else know how to get the backtrace to give me something useful?  This is a dead simple template, and all I'm passing in is a single list to create /etc/modules
[2012-06-14 20:58:03 -0400] hoover_damm: Sorry I need a better stack trace.  Try again with chef-client -l debug and gist the output
[2012-06-14 21:03:14 -0400] yfeldblum: miah, i'm partial to http://www.12factor.net/
[2012-06-14 21:03:42 -0400] pcn: here https://gist.github.com/2932938
[2012-06-14 21:05:14 -0400] hoover_damm: yfeldblum, I just stick with github as it's a standard schpeil
[2012-06-14 21:05:27 -0400] hoover_damm: yfeldblum, there's a bazillion pastebins out there and some people run their own
[2012-06-14 21:05:45 -0400] pcn: hoover_damm I put the stacktrace, template, and recipe in there.  No attributes are being set by the node's json run file
[2012-06-14 21:06:55 -0400] hoover_damm: pcn, nice
[2012-06-14 21:07:04 -0400] cassarani: amazingly, Google isn't helping much with this query - I need to set a run state parameter for a node, how would I go about doing that
[2012-06-14 21:07:06 -0400] hoover_damm: pcn, you get a super gold star on that excellent gist
[2012-06-14 21:07:11 -0400] pcn: hah, thanks
[2012-06-14 21:07:12 -0400] hoover_damm: just so you know
[2012-06-14 21:07:51 -0400] cassarani: do I have to change the cookbook, upload it to knife, then re-provision?
[2012-06-14 21:08:21 -0400] JohnE20: probably been asked a thousand times, but does chef client run with ubuntu and sudo when using knife to launch a new server?
[2012-06-14 21:08:25 -0400] miah: yfeldblum: interesting. i'll have to give this a read through this eve
[2012-06-14 21:08:44 -0400] pcn: JohnE20 IIRC that's an option in your knife.rb
[2012-06-14 21:10:00 -0400] hoover_damm: pcn, i'm assuming the p modprobe_list was for debugging purposes?
[2012-06-14 21:10:04 -0400] pcn: Ye
[2012-06-14 21:10:30 -0400] hoover_damm: but still that should be fine
[2012-06-14 21:10:42 -0400] pcn: Yes.  BTW, I'm less interested in the actual solution to my error, as I am in the question of why I'm getting so little good data in the stacktrace and error message
[2012-06-14 21:11:15 -0400] hoover_damm: pcn, that's more of a ruby question
[2012-06-14 21:11:39 -0400] pcn: Where do I ask the question, though?
[2012-06-14 21:12:00 -0400] hoover_damm: pcn, http://whynotwiki.com/Ruby_/_Exception_handling
[2012-06-14 21:12:13 -0400] hoover_damm: pcn, mailing list will give you a good answer
[2012-06-14 21:12:31 -0400] yfeldblum: miah, in terms of logging, one of the 12 factors is: applications always log to stdout; the controlling script that runs the application (controlling scripts are defined by the infrastructure, not application) captures stdout and does wtf it likes: chooses an output file, logrotates that file, etc
[2012-06-14 21:12:33 -0400] pcn: Any archived messages to this effect?
[2012-06-14 21:12:46 -0400] hoover_damm: no idea, your free to search
[2012-06-14 21:12:47 -0400] yfeldblum: miah, it's nice because it's a very simple interface between application and host infrastructure w.r.t. logs
[2012-06-14 21:12:51 -0400] hoover_damm: archive is public
[2012-06-14 21:13:29 -0400] hoover_damm: stack traces / exception handling is kind of a thing ot be improved always in ruby I think
[2012-06-14 21:13:38 -0400] hoover_damm: 100% opinion on that.
[2012-06-14 21:18:47 -0400] yfeldblum: hoover_damm, "yfeldblum, I just stick with github as it's a standard schpeil" - not sure to what you were referring
[2012-06-14 21:20:22 -0400] hoover_damm: yfeldblum, pastie site?
[2012-06-14 21:23:53 -0400] yfeldblum: hoover_damm, not ringing a bell
[2012-06-14 21:42:13 -0400] cgag: Is it possible to share a provider among multiple cookbooks?
[2012-06-14 21:43:39 -0400] ampledata: why not
[2012-06-14 21:43:55 -0400] ampledata: i mean if the cookbook is in your run list all other cookbooks can utilize it's resources
[2012-06-14 21:43:59 -0400] cgag: I tried just putting a provider in cookbook a, then using it from b and c
[2012-06-14 21:44:07 -0400] cgag: but it doesn't seem to be able to find it
[2012-06-14 21:44:25 -0400] ampledata: by provider you mean lwrp?
[2012-06-14 21:44:34 -0400] cgag: yeah
[2012-06-14 21:44:46 -0400] ampledata: and you've got an include_recipe statement in b and c?
[2012-06-14 21:47:37 -0400] bakins: silly question: is there a video of this talk? http://velocityconf.com/velocity2010/public/schedule/detail/14432
[2012-06-14 21:47:57 -0400] bakins: wanted it for a coworker and he asked "why chef?" and that talk is what made up our minds
[2012-06-14 21:48:17 -0400] ampledata: i'd bet there's a couple other versions of that talk on the webs
[2012-06-14 21:48:58 -0400] hoover_damm: bakins, http://www.youtube.com/watch?v=Fx8OBeNmaWw
[2012-06-14 21:49:19 -0400] hoover_damm: bakins, that's one video of it... lemme see if i can find others
[2012-06-14 21:49:29 -0400] ampledata: i don't think that's the same talk
[2012-06-14 21:49:34 -0400] bakins: nope. I want "Automation with Chef" I foudn the slides
[2012-06-14 21:49:43 -0400] cgag: ampledata: I didn't, but i'm not sure what i'd be including as cookbook A really only contains the provider.  I tried just creating a blank default recipe and including that, but that doesn't seem to work.
[2012-06-14 21:50:03 -0400] ampledata: cgag: inclide_recipe 'a' should suffice
[2012-06-14 21:50:12 -0400] ampledata: as long as 'a' is in your run list
[2012-06-14 21:50:21 -0400] ampledata: want to pastbin your code somwhere? gist?
[2012-06-14 21:51:04 -0400] yfeldblum: cgag, you don't need include_recipe; you need to have, in the first cookbook's metadata.rb, `depends "second-cookbook"`, where the second cookbook is the one with the provider
[2012-06-14 21:51:36 -0400] hoover_damm: bakins, http://wiki.opscode.com/display/chef/Chef+Presentations
[2012-06-14 21:52:17 -0400] bakins: not the same with out Adam talking ;) I can randomly insert "fuck"
[2012-06-14 21:54:30 -0400] cgag: ampledata: looks like i just didn't have a on my run list
[2012-06-14 21:57:10 -0400] hoover_damm: bakins, indeed
[2012-06-14 22:00:59 -0400] hoover_damm: bakins, http://www.youtube.com/view_play_list?p=271D5BF52104418D
[2012-06-14 22:01:07 -0400] hoover_damm: bakins, that's a pretty good list of the Velocity 2010
[2012-06-14 22:01:21 -0400] bakins: all but the one I want;)
[2012-06-14 22:01:34 -0400] hoover_damm: ever get the feeling that Dyn is watching Adam?
[2012-06-14 22:01:41 -0400] bakins: :P
[2012-06-14 22:01:52 -0400] hoover_damm: that's their list
[2012-06-14 22:02:19 -0400] hoover_damm: bakins, yeah i really can't find it sorry
[2012-06-14 22:02:41 -0400] bakins: no worries. I obviously couldn't either
[2012-06-14 22:42:02 -0400] JasonBox: hrm, any ssh cookbooks?
[2012-06-14 23:29:07 -0400] terryjfundak: Hey Chefs..... This is an off-topic question but I want to know what the chefs of the world think..... Given a MacBookPro and working primarily as a programming/operations engineer do people have a strong preference between screen types
[2012-06-14 23:29:19 -0400] terryjfundak: Standard = 1440x900 glossy display or Hi Res of the Glosssy or Hi Res of the Antiglare screen..... I'm asking between neither Apple Store nor Best Buy has an Anti glare screen MacBook Pro and or while I think that is what I want, I don't have a way to look at an actual antiglare screen...
[2012-06-14 23:32:35 -0400] terryjfundak: Thanx Twirrim... can I ask why?
[2012-06-14 23:32:54 -0400] fujin: last 15" beast machine I had an antiglare on, kind of retarded that they don't offer it with one
[2012-06-14 23:33:10 -0400] fujin: get gloss screen = sit indoors in cave programming
[2012-06-14 23:33:20 -0400] Twirrim: drives me crazy having everything around me or behind me reflected at me.
[2012-06-14 23:33:32 -0400] fujin: right
[2012-06-14 23:33:39 -0400] hoover_damm: terryjfundak, I rock a 27" Apple Thunderbolt Display
[2012-06-14 23:33:40 -0400] fujin: pick up an anti-glare desktop monitor to work on? 24"+
[2012-06-14 23:33:51 -0400] hoover_damm: terryjfundak, hooked up to my 15" Macbook Pro
[2012-06-14 23:33:58 -0400] fujin: or 3 of them.. http://www.obutto.com/r3volution_computer_desk.html
[2012-06-14 23:34:09 -0400] pthread: terryjfundak: if you can't compare them in person, I'd say go without the glossy
[2012-06-14 23:34:29 -0400] pthread: some people seem to hate them with a passion.  nobody hates the non-glossy
[2012-06-14 23:34:44 -0400] hoover_damm: I pretty much do antiglare as sometimes I code outside
[2012-06-14 23:34:52 -0400] hoover_damm: and I don't want the sun to be my enemy
[2012-06-14 23:35:15 -0400] terryjfundak: It is kinda crazy that the local Apple Store did not have a single sample of any size to show me.... ditto BestBuy.
[2012-06-14 23:35:23 -0400] pthread: what kind of programmer doesn't have the sun as their enemy?  :P
[2012-06-14 23:35:38 -0400] fujin: even a sunny office will fuck you up with a glossy panel
[2012-06-14 23:35:43 -0400] hoover_damm: terryjfundak, not crazy
[2012-06-14 23:35:45 -0400] fujin: have to cower in the corner, shielding screen from reflections
[2012-06-14 23:35:50 -0400] hoover_damm: terryjfundak, do remember that apple just released a new lineup 2 days ago
[2012-06-14 23:35:54 -0400] cwj: its a BTO option
[2012-06-14 23:35:58 -0400] cwj: afaik
[2012-06-14 23:36:03 -0400] cwj: you'll never find it in stores
[2012-06-14 23:36:31 -0400] fujin: right -- my one was 3week+ from singapore
[2012-06-14 23:36:35 -0400] fujin: DHL international courier
[2012-06-14 23:36:55 -0400] terryjfundak: I mean not even a display model.... non ..... they did have the gloss a pretty....
[2012-06-14 23:36:58 -0400] fujin: find a hacker who has one and take a look yourself. I am sure there are pictures on the tubes to illustrate the effect of glossy reflection
[2012-06-14 23:37:24 -0400] terryjfundak: THanx all..... Anybody this glossy is "good" or at least "good enough"
[2012-06-14 23:38:01 -0400] terryjfundak: or are we at 85% plus like the anti-glare expect cave dwellers....
[2012-06-14 23:38:37 -0400] terryjfundak: Sorry..... Anybody think glossy is "good" or at least "good enough"?
[2012-06-14 23:38:59 -0400] pthread: eh, colors look nicer on the glossy i think.  I had one a few years ago with it.  it wasn't bad
[2012-06-14 23:39:05 -0400] pthread: on the other hand, i haven't bought one again
[2012-06-14 23:40:29 -0400] terryjfundak: pthread: Do you love your console view of the chef server in multicolor at million of color? Is your terminal world that colorful?
[2012-06-14 23:41:01 -0400] pthread: ha.  no.  I'm not a big fan of colored terminal output.  :)
[2012-06-14 23:41:48 -0400] pthread: On the flip side, if you aren't running anything in color on your laptop, I'm going to question what you are spending $2000+ for a new laptop for.  :)
[2012-06-14 23:44:18 -0400] terryjfundak: kidding..... or course.... thanx all... hoover_damn: yeep to the multimonitor for the desk .... MacBook on the road mostly but if I got spend $$$ I'd like a good decision on the screen type..... my old 17" MacBookPro is now a slow dog and killing me after 4+ years
[2012-06-14 23:44:42 -0400] papertigers: Is it possible to get a list of boxes in a role to populate a template
[2012-06-14 23:48:33 -0400] coderanger: papertigers: search(:node, 'roles:foo')
[2012-06-14 23:52:01 -0400] papertigers: coderanger: cool thanks, let me try that
[2012-06-14 23:52:13 -0400] coderanger: search?
[2012-06-14 23:52:13 -0400] bawt_: search is http://wiki.opscode.com/display/chef/Search
[2012-06-14 23:52:16 -0400] coderanger: :)
[2012-06-14 23:58:36 -0400] papertigers: coderanger: hmm idk if that will help.  I have the recipe added to the run_list and not a role
[2012-06-14 23:58:48 -0400] coderanger: then use recipes:whatever
