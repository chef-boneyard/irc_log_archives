[2012-06-13 00:08:29 -0400] yfeldblum: holoway, like i said, what i recommended is for larger-sized software rather than smaller-sized software; introductory material is an example of the latter, where multiple layers of interface often gets in the way of teaching basic skills
[2012-06-13 00:13:59 -0400] Twirrim: I've been doing a bit of googling, but seems most references are old, and I don't see anything in the docs (may be missing the obvious though).  Is there anything specific by way of "uninstall" process to undo the actions of a chef recipe, or is it still a question of writing an uninstall recipe for the cookbook?
[2012-06-13 00:23:27 -0400] yfeldblum: Twirrim, it's a question of writing an uninstall recipe
[2012-06-13 00:25:59 -0400] Twirrim: okay, thanks, that's what we thought :)
[2012-06-13 00:26:16 -0400] Twirrim: guessing it'd be a bit tricky to safely reverse all actions.
[2012-06-13 00:28:45 -0400] miah: yes, re-install your server. if you can't re-install your server from scratch your chef implementation needs some attention
[2012-06-13 00:43:02 -0400] cassarani: am I right in thinking running 'knife cookbook install site' will download the cookbooks into the root of the chef-repo? What's the point of that? Surely they should be under /cookbooks?
[2012-06-13 00:43:32 -0400] miah: no, it will install them into your cookbooks_path
[2012-06-13 00:43:48 -0400] cassarani: oh, I thought that had to be configured to be your chef-repo root
[2012-06-13 00:43:55 -0400] miah: no
[2012-06-13 00:44:05 -0400] cassarani: makes sense
[2012-06-13 00:44:12 -0400] cassarani: weird because it was still working fine
[2012-06-13 00:48:37 -0400] Twirrim: miah: it depends on what you're doing with it. re-installing the server is inappropriate in this case.  Rather like taking a sledgehammer to crack an egg.
[2012-06-13 00:50:56 -0400] jschneiderhan: does anyone have advise on how to use the chef-rvm cookbook with the opscode application/application_ruby cookbook?
[2012-06-13 00:51:00 -0400] Twirrim: e.g. we have 80+ different tomact web apps, all of which have associated bits and pieces with them like NFS mount points, cron jobs etc.  We'd like to be able to juggle them between different servers but need to make sure they clean up after themselves :)  Of course in an ideal world the apps wouldn't have been written in such ugly ways, but that's an argument I've been having here for years :D
[2012-06-13 00:51:26 -0400] jschneiderhan: I'm trying to leave the system ruby as default (1.8) but use an .rvmrc file to run the application
[2012-06-13 00:52:16 -0400] jschneiderhan: but I can't seem to figure out a way to get the bundler commands + application server (unicorn in my case) to use the rvm ruby
[2012-06-13 00:55:38 -0400] miah: Twirrim: indeed. make your devs do the right thing.
[2012-06-13 00:55:52 -0400] miah: if the devs insist on making shit. i go work somewhere else =)
[2012-06-13 00:59:20 -0400] yfeldblum: Twirrim, not with chef
[2012-06-13 00:59:56 -0400] yfeldblum: Twirrim, chef does declaring and converging; you want juggling? get a juggler
[2012-06-13 01:00:10 -0400] yfeldblum: Twirrim, why do you need to juggle?
[2012-06-13 01:00:12 -0400] hoover_damm: Twirrim, you need something like Noah or Zookeeper to know where the applications should be
[2012-06-13 01:00:32 -0400] hoover_damm: and it turns into an equasion of chef reading the data, and acting based upon another service
[2012-06-13 01:00:47 -0400] hoover_damm: the cleaning up after yourself is always a dubious thing to me
[2012-06-13 01:00:53 -0400] Twirrim: hoover_damm: interesting, thanks.
[2012-06-13 01:01:39 -0400] hoover_damm: Twirrim, well in order for chef to drive this (if it could) it would have to be fed the answers
[2012-06-13 01:02:06 -0400] hoover_damm: Twirrim, realistically having an application registry such as Noah would make this chore easier because first you need to know what your applications are, and where they reside
[2012-06-13 01:02:21 -0400] miah: i wonder if you could just determine what file / service / package resources are managed by the cookbook running on your system and just change the default actions
[2012-06-13 01:02:40 -0400] miah: rather than having to write a recipe that actually does each uninstallation step
[2012-06-13 01:02:53 -0400] Twirrim: hoover_damm: wasn't really thinking anything complicated.  Building the recipe for each of the apps is simple.  The apps get deployed to all the servers, the cookbook just controls whether or not the mounts are there and the associated cron scripts.
[2012-06-13 01:03:22 -0400] Twirrim: we have an existing method of controlling whether or not the apps are running and stuff.  Could probably do with an overhaul at some stage, but it does actually work :)
[2012-06-13 01:03:52 -0400] hoover_damm: right, and if you take the automate everything attitude you should scrap your setup and start over automated
[2012-06-13 01:03:55 -0400] hoover_damm: so it all works
[2012-06-13 01:04:02 -0400] miah: =)
[2012-06-13 01:04:08 -0400] Twirrim: hoover_damm: then I'll never get the infrastructure automated :)
[2012-06-13 01:04:18 -0400] hoover_damm: Twirrim, your developers that bad?
[2012-06-13 01:05:02 -0400] Twirrim: not bad, per se.  It's a bit complicated to explain.  I'd argue half the problem has come from my predecessors who were either devs pretending to be sysadmins, or very strange sysadmins.
[2012-06-13 01:05:16 -0400] hoover_damm: right
[2012-06-13 01:05:25 -0400] miah: i think its a common pattern to deal with sysadmins who are barely sysadmins.
[2012-06-13 01:05:27 -0400] Twirrim: I'm the first sysadmin to put their foot down and start insisting on things being done properly, and it's happening :)
[2012-06-13 01:05:36 -0400] hoover_damm: speaking from experience walking into a company that has been managed by other admins
[2012-06-13 01:05:47 -0400] hoover_damm: you have a good amount of room to say they were stupid, replace this
[2012-06-13 01:06:14 -0400] hoover_damm: if they don't work for the company any longer and they are not a part of your team.  You should not be held to their ideas
[2012-06-13 01:07:13 -0400] miah: yup
[2012-06-13 01:07:23 -0400] hoover_damm: that doesn't mean you get to walk in and chop it up.  But that means if you see a glaring bad pattern you should be able to say hey, we should look at this.
[2012-06-13 01:07:28 -0400] Twirrim: sure, but I should explain our business model, it'll help you understand why it's a slow process:  We do egovernment stuff on a no-fee basis.  We make money through transaction fees.  Essentially we gamble.  It takes a number of years for most apps we create to become profitable and then any further changes have to be weighed up against the cost.
[2012-06-13 01:07:29 -0400] hoover_damm: if you are not listened to? walk on
[2012-06-13 01:08:03 -0400] Twirrim: we're only now reaching a stage where it's sufficiently profitable enough that we can look to hire developers to be dedicated to maintaining legacy apps and looking to overhaul them :)
[2012-06-13 01:08:13 -0400] hoover_damm: Twirrim, makes sense.
[2012-06-13 01:08:50 -0400] Twirrim: so I've got a lot of apps in our environment that "just work" because the previous sysadmins did anything in their power to make them work, rather than choosing the most scalable option.  The entire infrastructure reeks of organic growth!
[2012-06-13 01:09:06 -0400] miah: im at that point in my career where i completely avoid anything big business and definitely will never work in financial or .gov
[2012-06-13 01:09:21 -0400] hoover_damm: there's nothing wrong with gov or financial really miah
[2012-06-13 01:09:21 -0400] miah: because i'm done with 27b-6 forms
[2012-06-13 01:09:31 -0400] hoover_damm: miah, it's just the stupidity can be pretty high there.  You can find good jobs
[2012-06-13 01:09:32 -0400] miah: there is nothing wrong if you like dealing with kafkaisms
[2012-06-13 01:09:55 -0400] miah: i refuse to take orders from somebody who has 0 clue
[2012-06-13 01:09:58 -0400] Twirrim: this is actually the best company I've ever worked for, and that's a common opinion amongst the all staff.  That goes a long way to offset the aggro :)
[2012-06-13 01:10:06 -0400] miah: awesome
[2012-06-13 01:10:11 -0400] miah: glad to hear that then =)
[2012-06-13 01:11:10 -0400] Twirrim: I'll admit I do tend to reach the 1 foot out the door stage regularly, but mostly I just relish the challenge of getting this infrastructure sorted out properly.  Chef is a large part of that.  I've been here just over 2 years and I've finally got the opportunity to start implementing it.
[2012-06-13 01:11:24 -0400] miah: awesome
[2012-06-13 01:11:35 -0400] Twirrim: I've wanted to do this from day one but it's not been feasible (too many other things to deal with, fires to fight and slowly extinguish)
[2012-06-13 01:12:01 -0400] Twirrim: I'll look at Noah and Zookeeper though, it could be they'll make this easier.
[2012-06-13 01:12:16 -0400] miah: yes, but you have to weight the costs of fighting fires, especially if those fires are caused by lack of proper configuration / system management
[2012-06-13 01:12:23 -0400] hoover_damm: Twirrim, take a look at the Noah wiki
[2012-06-13 01:12:24 -0400] miah: ok. food is here.
[2012-06-13 01:12:29 -0400] hoover_damm: Twirrim, it's written in ruby so you'll find it exciting
[2012-06-13 01:12:37 -0400] Twirrim: miah: absolutely.  It's been a tough decision at every stage.
[2012-06-13 01:12:52 -0400] hoover_damm: Twirrim, https://github.com/lusis/Noah https://github.com/lusis/Noah/wiki
[2012-06-13 01:13:01 -0400] hoover_damm: Twirrim, https://github.com/lusis/Noah/wiki/Application-API
[2012-06-13 01:14:08 -0400] Twirrim: what I find disheartening is we're one of 27 state portals run by parent corp, and even though some of those are less than 5 years old we're the only one trying to do config management.  Uttery stupid.  Our Sysadmin Jr will be going to the technical conference in August and presenting on Chef, hopefully that'll get the ball rolling properly.
[2012-06-13 01:14:26 -0400] miah: aweosme that sounds grat
[2012-06-13 01:14:29 -0400] miah: great too
[2012-06-13 01:14:52 -0400] miah: also. catered lunch + dinner = why startups can be awesome
[2012-06-13 01:15:09 -0400] hoover_damm: or work from home
[2012-06-13 01:15:12 -0400] hoover_damm: <-- like me
[2012-06-13 01:22:52 -0400] hoover_damm: Twirrim, change is good... But I found the opportunity to re-do everything never to be as appealing as it could/should be
[2012-06-13 01:23:28 -0400] hoover_damm: heck that's how / why I got to Chef.  My company I worked for got sued, was using Puppet and it just wasn't working out.  So we had to fold and come back up under a new name and rebuild all our infra
[2012-06-13 01:23:32 -0400] miah: i <3 redoing things
[2012-06-13 01:23:46 -0400] miah: because you can learn from past mistakes
[2012-06-13 01:23:52 -0400] hoover_damm: got a few weeks and it was glorious
[2012-06-13 01:24:05 -0400] hoover_damm: but then I realized unless you have it already planned before you start
[2012-06-13 01:24:13 -0400] hoover_damm: it won't be as glorious as you hoped
[2012-06-13 01:28:31 -0400] hoover_damm: gosh i love using fabric with pychef
[2012-06-13 01:28:56 -0400] hoover_damm: i don't know why i never did that with ruby
[2012-06-13 01:29:58 -0400] miah: ya? i havent looked at fabric much.
[2012-06-13 01:30:37 -0400] hoover_damm: miah, how often do you have to run one off commands against a role/cluster?
[2012-06-13 01:31:07 -0400] hoover_damm: miah, run chef? deploy? look at some random x/y/z thing? done it through for loops?
[2012-06-13 01:31:56 -0400] hoover_damm: fabric is rather unique as you just make a fabfile with your commands in it and you just run it
[2012-06-13 01:32:01 -0400] hoover_damm: def hello():
[2012-06-13 01:32:10 -0400] hoover_damm:     print("hello world")
[2012-06-13 01:32:16 -0400] hoover_damm: then run fab hello and ..
[2012-06-13 01:32:31 -0400] hoover_damm: for me, i do @parallel(pool_size=5)
[2012-06-13 01:32:39 -0400] hoover_damm: def fix_logs():
[2012-06-13 01:32:54 -0400] hoover_damm:     try:
[2012-06-13 01:33:18 -0400] hoover_damm:       sudo('do something') ... except: print 'this failed to work'
[2012-06-13 01:33:28 -0400] hoover_damm: so perhaps having a good thing for python helps
[2012-06-13 01:33:34 -0400] miah: interesting
[2012-06-13 01:34:10 -0400] hoover_damm: so we use pychef to deploy... we're now adding a sha that we deploy to the nodes we deploy to in chef
[2012-06-13 01:34:22 -0400] hoover_damm: so that way we can do knife search deployed.sha:fdjksdfjklsfdjlkfjsdljklsdf
[2012-06-13 01:34:33 -0400] hoover_damm: deploy with fabric, get it in chef :)
[2012-06-13 01:34:53 -0400] hoover_damm: http://pychef.readthedocs.org/en/latest/index.html
[2012-06-13 01:34:56 -0400] hoover_damm: fantastic documentation
[2012-06-13 01:35:36 -0400] hoover_damm: miah, https://gist.github.com/e2b131147e4ffe6c486f
[2012-06-13 01:35:54 -0400] hoover_damm: miah, so with that you would do fab --set role=bob deploy
[2012-06-13 01:40:40 -0400] miah: neat
[2012-06-13 01:41:39 -0400] hoover_damm: now take any one off commands you run commonly and add that
[2012-06-13 01:41:50 -0400] hoover_damm: if you repeat the same one off, should go in fabric so you don't have to suffer
[2012-06-13 01:42:08 -0400] hoover_damm: if you want this, just pip install pychef with that example should give you a basic working point... it's not perfect but it's awesome
[2012-06-13 01:42:26 -0400] hoover_damm: if you wanna google my logs you can find coderanger's example too
[2012-06-13 01:42:36 -0400] hoover_damm: and there's several fabric users here at least :)
[2012-06-13 01:44:49 -0400] coderanger: hoover_damm: We have real logs with searching now ;-)
[2012-06-13 01:45:09 -0400] coderanger: but https://gist.github.com/2907936
[2012-06-13 01:47:25 -0400] hoover_damm: coderanger, i always forget
[2012-06-13 01:47:43 -0400] hoover_damm: coderanger, I've been debating redoing mine in elasticsearch anyway
[2012-06-13 01:48:56 -0400] hoover_damm: I admit I always was confused by fabric in my career previously only because of the simplistic documentation
[2012-06-13 01:49:01 -0400] hoover_damm: I didn't get how it fit into my life
[2012-06-13 01:49:11 -0400] hoover_damm: I have sinned
[2012-06-13 01:49:13 -0400] hoover_damm: and now I get it
[2012-06-13 01:49:50 -0400] hoover_damm: just an extension to chef to help complete the cycle
[2012-06-13 02:20:39 -0400] dylst: In the beginning of my recipe, I'm pushing ENV variables into /etc/environment, exporting them, as well as declaring them via ruby (ENV['xxx']).  However, in subsequent "execute" blocks, I have commands complaining that those ENV variables aren't set.  Is there something I'm missing?
[2012-06-13 02:23:04 -0400] hoover_damm: dylst, /etc/environment is read upon the next login... which is doh one
[2012-06-13 02:23:46 -0400] magoo: yfeldblum: i pushed that cookbook to staging and git updates were reported accurately. I'm not sure what was up on my dev box.
[2012-06-13 02:23:59 -0400] hoover_damm: dylst, so the next chef-run would have them completely.  As far as declaring them you would have to declare them in each resource I believe
[2012-06-13 02:27:22 -0400] dylst: hoover_damm:  gotcha.  thanks!
[2012-06-13 03:09:58 -0400] miah: hi
[2012-06-13 03:11:50 -0400] JasonBox: hrm
[2012-06-13 03:11:58 -0400] JasonBox: Chef::Exceptions:Class on Fedora 17?
[2012-06-13 03:12:13 -0400] JasonBox: Latest gem installed chef immediately exists
[2012-06-13 03:20:04 -0400] JasonBox: Same with omnibus
[2012-06-13 03:29:52 -0400] JasonBox: ah, hard fail on missing log_location
[2012-06-13 03:30:20 -0400] erikh: check your client.rb
[2012-06-13 04:03:26 -0400] amagee: i'm writing chef recipes to setup a django project and its dependencies
[2012-06-13 04:04:01 -0400] amagee: and so i need to generate a local_settings.py file, which has different content depending on which recipes have been executed (some are executed on production environments but not dev, etc)
[2012-06-13 04:04:30 -0400] amagee: how do people usually do this?  would i have recipes set attributes, and then have a local_settings recipe that reads these attributes in generating the local_settngs.py file?
[2012-06-13 04:05:30 -0400] amagee: eg. i could have a `xero` recipe that sets node["something"]["xero"] = true, and then the local_settings recipe consults node["something"]["xero"] and writes or doesn't write that section accordingly?
[2012-06-13 04:15:05 -0400] sabooky: Hi, I have a small question
[2012-06-13 04:15:14 -0400] sabooky: I'm confused on what :manage does on the user resource
[2012-06-13 04:16:17 -0400] erikh: as I understand it, manage "diffs" the user account and enforces any change from the cookbook's definition.
[2012-06-13 04:16:33 -0400] JasonBox: erikh: Yeah, just surprised it fails so explosively when that's not set to a path that exists
[2012-06-13 04:16:46 -0400] erikh: JasonBox: it evaluates the file very early.
[2012-06-13 04:17:01 -0400] erikh: but yeah, it should have a better error message.
[2012-06-13 04:17:07 -0400] erikh: file a ticket :)
[2012-06-13 04:17:43 -0400] sabooky: ok, one more issue I'm having then regarding the user resource
[2012-06-13 04:18:06 -0400] sabooky: I have an lvm cookbook.. and if I use that to create a mountpoint for the users directory (say: /opt/jenkins_home)
[2012-06-13 04:18:25 -0400] sabooky: When I create that user in a later step using the user resource the skel files aren't being copied in
[2012-06-13 04:18:35 -0400] sabooky: .bash_profiles and stuff like that (files in /etc/skel)
[2012-06-13 04:18:49 -0400] sabooky: I tried adding supports :manage_home => true
[2012-06-13 04:18:56 -0400] sabooky: but that didn't seem to make any difference afaict
[2012-06-13 04:19:40 -0400] erikh: hrm. I don't think chef populates skel files at all
[2012-06-13 04:19:47 -0400] erikh: you should probably do that in your cookbook anyhow.
[2012-06-13 04:21:19 -0400] yfeldblum: amagee, a cookbook per application, a role per application, a data bag item per application - many different approaches
[2012-06-13 04:21:42 -0400] yfeldblum: amagee, i don't think a local_settings recipe is the right approach though
[2012-06-13 04:22:18 -0400] amagee: yfeldblum: ok, suppose i go a cookbook per application
[2012-06-13 04:22:38 -0400] amagee: i then need to make sure local_settings.py is updated when a new application is installed
[2012-06-13 04:22:44 -0400] sabooky: erikh: k, thanks
[2012-06-13 04:24:06 -0400] amagee: so how would the cookbooks cause that to happen?
[2012-06-13 04:25:41 -0400] yfeldblum: amagee, some approaches include: overwriting settings.py with a cookbook-defined settings.py; or requiring settings.py to look at environment variables and for the cookbook to setup a start script that defines the environment variables
[2012-06-13 04:27:21 -0400] yfeldblum: amagee, and if your apps know about local_settings.py, then that
[2012-06-13 04:27:34 -0400] yfeldblum: amagee, how to do it depends on how you deploy the app, so, how do you deploy the app?
[2012-06-13 04:28:18 -0400] amagee: what do you mean "setup a start script that defines the environment variables"?
[2012-06-13 04:29:09 -0400] amagee: my apps know about local_settings.py
[2012-06-13 04:29:38 -0400] amagee: i'm not sure what you mean by how i deploy the app
[2012-06-13 04:31:56 -0400] hoover_damm: amagee, https://github.com/coderanger/djangocon2011/blob/master/cookbooks/application/recipes/django.rb#L125
[2012-06-13 04:32:28 -0400] hoover_damm: https://github.com/coderanger/djangocon2011 is what coderanger presented at djangocon in 2011
[2012-06-13 04:32:57 -0400] coderanger: Thats all been rolled into the official application and application_python cookbooks
[2012-06-13 04:35:53 -0400] yfeldblum: amagee, you have a recipe which deploys the django application; what does that recipe code look like?
[2012-06-13 04:41:15 -0400] BryanWB_: ohai chefs!
[2012-06-13 04:42:13 -0400] amagee: *looking*
[2012-06-13 04:42:47 -0400] flaccid: iaho
[2012-06-13 04:42:54 -0400] erikh: heh
[2012-06-13 04:43:00 -0400] erikh: ohio!
[2012-06-13 04:43:08 -0400] amagee: ok, maybe i'm being a bit confusing
[2012-06-13 04:44:07 -0400] amagee: at the moment i'm just generating a local_settings.py file from a template which is pretty simple
[2012-06-13 04:44:13 -0400] savant: Hi all
[2012-06-13 04:44:33 -0400] savant: I have this awesome resource definition that sometimes throws an exception
[2012-06-13 04:44:53 -0400] savant: I'd like to wrap this exception in a begin/rescue, but I don't want a stacktrace when it gets caught
[2012-06-13 04:45:32 -0400] amagee: but the issue is i want to have multiple configurations where there are sections that might or might not appear in the local_settings.py file, depending on which cookbooks are run
[2012-06-13 04:45:38 -0400] savant: the resource ensures that a mysql user/password is in place - the debian maintenance user - and the begin/rescue is around setting it up without a password, as root user/password wont be setup properly on the first chef run
[2012-06-13 04:45:58 -0400] savant: does anyone have ideas as to how to suppress the exceptions in a run?
[2012-06-13 04:50:38 -0400] yfeldblum: amagee, i don't understand why you have multiple cookbooks that would get to configure the same file
[2012-06-13 04:52:02 -0400] erikh: if you rescue there should be no stacktrace
[2012-06-13 04:52:05 -0400] erikh: savant: ^
[2012-06-13 04:52:30 -0400] erikh: or are you talking about something like a bad search?
[2012-06-13 04:52:41 -0400] erikh: I've had trouble supressing those.
[2012-06-13 04:52:48 -0400] savant: nope
[2012-06-13 04:52:56 -0400] savant: its a bash command
[2012-06-13 04:53:02 -0400] savant: i even set ignore_failure
[2012-06-13 04:53:13 -0400] erikh: can you show the code?
[2012-06-13 04:53:22 -0400] savant: yeah sec
[2012-06-13 04:53:47 -0400] hoover_damm: coderanger, didn't think of it... *smack*
[2012-06-13 04:54:21 -0400] savant: https://gist.github.com/1d35d85af6b35e64a888
[2012-06-13 04:54:34 -0400] amagee: yfeldblum: because how it is setup at the moment, local_settings.py is a file that applies to the whole project.  different sub-applications just have sections in that file.  if that's a weird thing to do i can change it.
[2012-06-13 04:54:53 -0400] amagee: perhaps it would make more sense for local_settings.py to import files for the sub-applications?
[2012-06-13 04:55:02 -0400] yfeldblum: amagee, what do you mean by sub-applications?
[2012-06-13 04:55:05 -0400] erikh: savant: ok, this is a compile vs. converge issue
[2012-06-13 04:55:15 -0400] savant: cool, idk what that means
[2012-06-13 04:55:17 -0400] erikh: do you understand how that works?
[2012-06-13 04:55:19 -0400] erikh: ok.
[2012-06-13 04:55:26 -0400] savant: lol oops?
[2012-06-13 04:55:26 -0400] erikh: so chef actually makes two runs, more or less
[2012-06-13 04:55:48 -0400] erikh: there's a "compilation" step which determines what resources will run and what properties they hold.
[2012-06-13 04:56:05 -0400] erikh: then there's a "convergence" run which actually executes those resources (technically outside the recipes)
[2012-06-13 04:56:29 -0400] erikh: what you are doing is beginr/rescuing the compilation phase, and the actual resources run in convergence.
[2012-06-13 04:56:47 -0400] erikh: so, there's a trick here but it's a little advanced
[2012-06-13 04:56:51 -0400] erikh: let me type up an example.
[2012-06-13 04:56:56 -0400] amagee: yfeldblum: for example, the production system has access to a billing module but the dev systems don't
[2012-06-13 04:57:01 -0400] savant: oks cool
[2012-06-13 04:57:11 -0400] hoover_damm: savant, eww
[2012-06-13 04:57:20 -0400] savant: wut
[2012-06-13 04:57:23 -0400] yfeldblum: savant, more specifically, when your recipes run, what they do is: they declare resources that chef notes down and saves for later; what they don't do is: change the system
[2012-06-13 04:57:59 -0400] yfeldblum: savant, once all your recipes are done running, chef loops over the list of all the resources you declared in all the recipes in the run-list and, for each one, runs provider code that changes the system to bring the system into line with that resource
[2012-06-13 04:58:10 -0400] erikh: savant: https://gist.github.com/cc05c8cd155133383240
[2012-06-13 04:58:35 -0400] erikh: that'll force the resources to run at compile time though, so be cautious
[2012-06-13 04:58:43 -0400] yfeldblum: savant, every `execute` resource in your code is a declaration that, after all recipes have finished running, chef will recall that `execute` resource and run the provider for it
[2012-06-13 04:58:43 -0400] erikh: understand the compile/convergence system.
[2012-06-13 04:58:51 -0400] erikh: let me find the wiki page.
[2012-06-13 04:59:00 -0400] amagee: yfeldblum: so on the production system i need the billing system's key / password to be in local_settings.py, but not for dev systems
[2012-06-13 04:59:18 -0400] erikh: savant: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-06-13 04:59:39 -0400] erikh: that's the technique I'm showing you. there should be plenty of information there on what it means and why you should and shouldn't do it.
[2012-06-13 05:00:01 -0400] erikh: in short, if there's a better way to do it, I suggest you find it. :)
[2012-06-13 05:00:12 -0400] erikh: I've got more than a few providers which are just chains of those things.
[2012-06-13 05:00:25 -0400] savant: sadness panda
[2012-06-13 05:00:34 -0400] savant: not sure how to rewrite that definition atm
[2012-06-13 05:00:35 -0400] yfeldblum: i'd suggest not using execute resources if you're just going to run them immediately - just shell out the normal way
[2012-06-13 05:00:37 -0400] savant: too sleepy
[2012-06-13 05:00:38 -0400] erikh: heh! sorry, there's no easy answer.
[2012-06-13 05:00:58 -0400] erikh: yfeldblum: execute resources uses a common code base, can run as alternative users, and lots of other goodies.
[2012-06-13 05:01:06 -0400] erikh: in other words, they're consistent.
[2012-06-13 05:01:06 -0400] yfeldblum: `mysql ...` instead of `execute("mysql ...") { attributes... }.run_action(:run)`
[2012-06-13 05:01:15 -0400] hoover_damm: savant, imo the mysql cookbook should never set a password for production
[2012-06-13 05:01:24 -0400] hoover_damm: should just restore production database which sets the password
[2012-06-13 05:01:37 -0400] savant: hoover_damm: its for the stupid debian-maint user
[2012-06-13 05:01:39 -0400] hoover_damm: but that's me, and that's just silly
[2012-06-13 05:01:42 -0400] savant: sometimes it just disappears
[2012-06-13 05:01:46 -0400] savant: and im like "wtf mysql"
[2012-06-13 05:01:47 -0400] hoover_damm: that's easy
[2012-06-13 05:02:31 -0400] hoover_damm: node.set_unless['mysql']['server_debian_password'] = data_bag_item("database",node.chef_environment)["root_password"]
[2012-06-13 05:02:34 -0400] hoover_damm: i do that on all those tbh
[2012-06-13 05:02:41 -0400] yfeldblum: amagee, you can do <% if @billing_system_uername %>...<% end %> in ERB
[2012-06-13 05:02:43 -0400] hoover_damm: for debian pw, root pw and repl
[2012-06-13 05:02:47 -0400] hoover_damm: in the mysql cookbook
[2012-06-13 05:02:57 -0400] savant: yeah ummmmmm
[2012-06-13 05:03:02 -0400] savant: i dont use data bags
[2012-06-13 05:03:05 -0400] hoover_damm: that way I know what the root pw is always regardless of that awesome openssl password routine
[2012-06-13 05:03:05 -0400] savant: whats that
[2012-06-13 05:03:18 -0400] erikh: savant:  http://wiki.opscode.com/display/chef/Data+Bags
[2012-06-13 05:03:25 -0400] danryan: https://gist.github.com/2921954 Jaavaaaa ;_;
[2012-06-13 05:03:38 -0400] hoover_damm: it's an ugly pattern
[2012-06-13 05:03:41 -0400] hoover_damm: that i disapprove of
[2012-06-13 05:04:01 -0400] savant: heh
[2012-06-13 05:04:02 -0400] savant: idk
[2012-06-13 05:04:02 -0400] hoover_damm: but replacing that with the other pattern of autogenerating it should solve most confusion
[2012-06-13 05:04:15 -0400] hoover_damm: then  you know repl, root, and debian
[2012-06-13 05:04:21 -0400] savant: can i use a databag with chef-solo
[2012-06-13 05:04:28 -0400] hoover_damm: and seriously debian... leave a gaping security hole in a plaintext file again
[2012-06-13 05:04:33 -0400] hoover_damm: ...
[2012-06-13 05:04:34 -0400] erikh: savant: you can in chef 10.10
[2012-06-13 05:04:39 -0400] savant: oh thats too bad
[2012-06-13 05:04:40 -0400] hoover_damm: I have no words for how insecure debian is sometimes
[2012-06-13 05:04:43 -0400] erikh: danryan: did you not require chef or something?
[2012-06-13 05:04:44 -0400] savant: im using 0.9.8
[2012-06-13 05:04:44 -0400] flaccid: debian has a bug tracker :p
[2012-06-13 05:04:50 -0400] amagee: yfeldblum: ok, but then where would @billing_system_username come from?
[2012-06-13 05:04:51 -0400] flaccid: redhat is worse y0
[2012-06-13 05:05:03 -0400] danryan: erikh: I did not, but I omitted it intentionally :)
[2012-06-13 05:05:19 -0400] hoover_damm: flaccid, redhat engineers are smarter then debian donated folks
[2012-06-13 05:05:21 -0400] hoover_damm: :-P
[2012-06-13 05:05:26 -0400] hoover_damm: they get paid for brains
[2012-06-13 05:05:26 -0400] danryan: I just want to parse API response JSON without jruby pooping itself :)
[2012-06-13 05:05:30 -0400] hoover_damm: instead of donating time
[2012-06-13 05:05:33 -0400] hoover_damm: but that's pish posh
[2012-06-13 05:05:39 -0400] hoover_damm: too much heresay
[2012-06-13 05:05:50 -0400] yfeldblum: amagee, the template resource: template "/path/to/app/local_settings.py" do ; variables :billing_system_username => node["my_app"]["billing_system_username"] ; end
[2012-06-13 05:05:51 -0400] danryan: tries to turn every string that looks like a constant into a constant
[2012-06-13 05:05:51 -0400] erikh: oh. I think that's spice's json parser probably
[2012-06-13 05:06:00 -0400] erikh: let me root around underneath its skirt
[2012-06-13 05:06:25 -0400] danryan: erikh: works beautifully on non-jruby rubies
[2012-06-13 05:06:41 -0400] flaccid: a lot of morons get paid money in this world
[2012-06-13 05:06:53 -0400] amagee: yfeldblum: ok, so that's pretty much the my_app cookbook setting an attribute, which is then read by the recipe that creates local_settings.py?
[2012-06-13 05:07:01 -0400] danryan: erikh: or specifically, the json_pure gem I spose
[2012-06-13 05:07:24 -0400] erikh: huh. I wonder if json_class is being honored by yajl
[2012-06-13 05:07:28 -0400] erikh: and not a chef thing
[2012-06-13 05:07:34 -0400] erikh: (I always thought it was a chef thing)
[2012-06-13 05:07:37 -0400] erikh: sec, testing
[2012-06-13 05:08:16 -0400] yfeldblum: amagee, in that particular example of a snippet of recipe code, the recipe is reading the node attributes and using that information to set up the template resource
[2012-06-13 05:08:47 -0400] amagee: yes
[2012-06-13 05:08:58 -0400] yfeldblum: amagee, you can have one role that sets that node attribute and use that role for production, and another role that refrains from setting that node attribute and use that role for development
[2012-06-13 05:09:14 -0400] yfeldblum: amagee, that's one way you can do it; there are many other ways too
[2012-06-13 05:10:29 -0400] erikh: danryan: yeah, it's a "feature" of the json library.
[2012-06-13 05:10:32 -0400] erikh: (vs. yajl)
[2012-06-13 05:10:39 -0400] amagee: hmm ok, i haven't used roles yet.. i'll have a read
[2012-06-13 05:10:52 -0400] danryan: dang. maybe I just say "to hell with jruby" and call it a night :/
[2012-06-13 05:10:59 -0400] danryan: erikh: thanks for the sanity check
[2012-06-13 05:11:03 -0400] erikh: yeah np
[2012-06-13 05:11:16 -0400] erikh: spice uses yajl in a few spots, that might just be the solution
[2012-06-13 05:11:27 -0400] erikh: it'll be dog slow on jruby but that shouldn't matter in the grand scheme of things.
[2012-06-13 05:11:31 -0400] erikh: anyhow, enjoy your rest.
[2012-06-13 05:12:48 -0400] savant: thanks all!
[2012-06-13 05:12:50 -0400] savant: night
[2012-06-13 05:14:16 -0400] yfeldblum: erikh, dog slower than querying an external api over the network?
[2012-06-13 05:17:10 -0400] danryan: yfeldblum: quite. json parsing isn't the bottleneck here
[2012-06-13 05:30:26 -0400] danryan: also, yfeldblum: thanks again for your suggestions on spice yesterday. I ended up with a much superior version as a result of implementing multiple connections
[2012-06-13 07:07:14 -0400] specialsauce: in the chef-client config file "client.rb", there is a config value "chef_server_url". I'm not too familiar with Ruby - is there a way I can set the value of this to the contents of a second file?
[2012-06-13 07:15:31 -0400] specialsauce: i've tried doing a File.read on a file containing the hostname and assigning this to a var, then using this var int he config file as "chef_server_url  var.to_s" but chef returns an error
[2012-06-13 07:28:07 -0400] amagee: specialsauce: what's the error?
[2012-06-13 07:31:22 -0400] specialsauce: amagee: my config file is:
[2012-06-13 07:31:29 -0400] specialsauce: brooHaHa = File.read("/etc/chef/hostname.inc.rb")
[2012-06-13 07:31:30 -0400] specialsauce: chef_server_url         brooHaHa
[2012-06-13 07:31:36 -0400] specialsauce: and the output is:
[2012-06-13 07:31:48 -0400] specialsauce: NoMethodError: undefined method `reset_defaults_and_overrides' for #<Hash:0x2b14f530c7a0>
[2012-06-13 07:32:58 -0400] amagee: hmm, i'm relatively beginner but i would have expected that to work
[2012-06-13 07:33:04 -0400] amagee: do you have a stack trace?
[2012-06-13 07:33:33 -0400] specialsauce: yep, but its not really very helpful
[2012-06-13 07:34:02 -0400] amagee: if you paste it on a pastebin and link it here someone might be able to help you
[2012-06-13 07:35:26 -0400] specialsauce: ok, well the pastebin is http://pastebin.com/4qS49DQu but I'm not sure it provides much more
[2012-06-13 07:38:09 -0400] amagee: mm not sure, sorry
[2012-06-13 07:38:32 -0400] specialsauce: amagee, ok thanks
[2012-06-13 08:18:42 -0400] iroller: Ohai Chefs. Is there any way to install gem with "gem_package" from password-protected gem repo? I'm getting warning 401 Unauthorized "when trying to download specs" and then undefined method full_name for Nil in gem_package() https://gist.github.com/a8152db375dfab2713ae
[2012-06-13 08:19:10 -0400] iroller: looks like gem_package is not able to handle auth-required repos, right?
[2012-06-13 08:36:10 -0400] drrk: not sure about that, but it doesn't seem to handle proxies, so it wouldn't surprise me
[2012-06-13 09:11:01 -0400] agosse: i have a noob question, but I can't seem to find the answer on opscode's wiki
[2012-06-13 09:12:39 -0400] agosse: a template that I'm using via a role works fine, but when I use the template by adding the calling recipe to a node's runlist, it breaks
[2012-06-13 09:38:04 -0400] agosse: ah, i've figured out why it's breaking
[2012-06-13 09:38:54 -0400] agosse: chef is saying that the error is occurring in one recipe, line 26
[2012-06-13 09:39:07 -0400] agosse: but it's actually happening in a different recipe, line 26
[2012-06-13 09:39:27 -0400] agosse: WAT?
[2012-06-13 10:02:21 -0400] zts: agosse: could you pastebin the error please?
[2012-06-13 10:02:57 -0400] agosse: pardon my ignorance, what is pastbinning?
[2012-06-13 10:03:48 -0400] zts: agosse: something like pastebin.com or gist.github.com - you can paste large errors and the like into the website, which gives you a URL to share in the channel
[2012-06-13 10:04:08 -0400] agosse: gotcha
[2012-06-13 10:04:29 -0400] agosse: the error itself isn't very big
[2012-06-13 10:04:37 -0400] agosse: [pid  5384] write(1, "[Wed, 13 Jun 2012 02:27:02 -0700"..., 181[Wed, 13 Jun 2012 02:27:02 -0700] FATAL: Errno::ENOENT: template[/tmp/replay] (stingray::install line 26) had an error: Errno::ENOENT: No such file or directory - node1.localdomain
[2012-06-13 10:05:42 -0400] agosse: the exception is happening in a different recipe in the runlist, because the not_if clause in my template is trying to run an attribute as a shell command
[2012-06-13 10:06:17 -0400] agosse: the exception is giving me the right line number, but the wrong recipe
[2012-06-13 10:06:54 -0400] zts: hrm okay, can you share both the recipe that the error's reported against, the recipe where the error is happening?
[2012-06-13 10:08:02 -0400] agosse: it's not running at the moment, so as long as you're happy to look at broken code
[2012-06-13 10:08:22 -0400] zts: yeah that's fine
[2012-06-13 10:10:54 -0400] agosse: https://gist.github.com/2923228
[2012-06-13 10:13:27 -0400] agosse: might need to refresh, i had to stick the problem back in
[2012-06-13 10:14:10 -0400] zts: cool, I wondered whether "stingray" referred to the traffic manager :)
[2012-06-13 10:14:12 -0400] agosse: the exception is happening in this case on initialize.rb +33, but being reported as install.rb +33
[2012-06-13 10:14:41 -0400] agosse: it does indeed - i'm the product specialist
[2012-06-13 10:14:51 -0400] agosse: (fwiw)
[2012-06-13 10:15:37 -0400] zts: awesome :)
[2012-06-13 10:15:40 -0400] zts: just looking at the gist now
[2012-06-13 10:16:32 -0400] agosse: sweet - brb
[2012-06-13 10:17:17 -0400] zts: okay, I think I can explain your issues
[2012-06-13 10:17:33 -0400] zts: the reason taht the not_if clause is being run as a shell command is that that's how string values for not_if are handled
[2012-06-13 10:17:51 -0400] zts: you'll need to make those ruby blocks - just wrapping your statements in braces will work
[2012-06-13 10:18:03 -0400] zts: eg, only_if { node.stingray.join_cluster_auto == "yes" }
[2012-06-13 10:18:30 -0400] zts: the reason things are being reported against the "wrong" recipe is that you're actually defining the same resource in each recipe
[2012-06-13 10:19:04 -0400] zts: resources are unique on the resource type (eg, template) + resource name (eg, "/tmp/replay")
[2012-06-13 10:19:50 -0400] zts: so if both of those recipes end up on your run_list, what's happening is that you end up with a single resource that overrides or combines the attributes you've used in both places
[2012-06-13 10:22:11 -0400] agosse: ah, so because both install and initialize are both templating /tmp/replay, it reports the exception against the first instance?
[2012-06-13 10:22:54 -0400] zts: yeah, I'm not sure of the exact mechanics so it'll be the first or the last - if you're seeing the first, I'll take your word for it :)
[2012-06-13 10:23:11 -0400] agosse: cool
[2012-06-13 10:23:46 -0400] agosse: doesn't make for the easiest troubleshooting, but ok
[2012-06-13 10:23:47 -0400] agosse: ;-)
[2012-06-13 10:24:00 -0400] agosse: thanks for your help, much appreciated!
[2012-06-13 10:24:03 -0400] zts: yeah, most of the time you won't want that behaviour
[2012-06-13 10:24:16 -0400] zts: on a related note, we have several cookbooks in-house to install and configure STM
[2012-06-13 10:24:27 -0400] zts: we haven't quite released them yet, but were planning to do so shortly
[2012-06-13 10:24:29 -0400] agosse: are you with rightscale then?
[2012-06-13 10:24:33 -0400] zts: nah, Venda
[2012-06-13 10:24:36 -0400] zts: we're using in house
[2012-06-13 10:24:47 -0400] zts: I have to run to a meeting, but perhaps I can drop you an email to tell you about what we've done so far?
[2012-06-13 10:24:57 -0400] agosse: i'm familiar with your deployment somewhat
[2012-06-13 10:25:08 -0400] agosse: ie - lots and lots of services on one cluster
[2012-06-13 10:25:11 -0400] agosse: :-)
[2012-06-13 10:25:16 -0400] zts: yeah, it's a bit nuts :)
[2012-06-13 10:25:29 -0400] agosse: we have partners that want to do 20k
[2012-06-13 10:25:36 -0400] zts: but we've got some LWRP's to configure vservers and pools and the like
[2012-06-13 10:25:40 -0400] zts: which is working nicely
[2012-06-13 10:25:43 -0400] agosse: cool
[2012-06-13 10:25:53 -0400] agosse: you hosting those on github?
[2012-06-13 10:26:29 -0400] zts: we will be
[2012-06-13 10:27:11 -0400] zts: drop me a line on zstevens@venda.com if you'd like, I'll see if I can share them with you in advance of the public release
[2012-06-13 10:27:29 -0400] agosse: sweet - will do
[2012-06-13 10:31:17 -0400] jedi4ever: can't recall a chef cookbook for kinda downloading tgz balls and installing them . There was some specific lightweight handler for installing those? What was the name?
[2012-06-13 10:49:38 -0400] BryanWB_: jedi4ever: ark my friend
[2012-06-13 10:49:58 -0400] BryanWB_: jedi4ever: http://community.opscode.com/cookbooks/ark
[2012-06-13 10:50:39 -0400] BryanWB_: jedi4ever: tutorial here http://devopsanywhere.blogspot.it/2012/03/managing-archives-with-ark-resource.html
[2012-06-13 11:06:20 -0400] jedi4ever: BryanWB_: yep that was the one. thx
[2012-06-13 11:11:52 -0400] alclonky: is there a way to use the package resource for more than one rpm at once?
[2012-06-13 11:11:52 -0400] alclonky: i have rpms which depend on some other, and if you have an old version installed it would fail
[2012-06-13 11:11:52 -0400] alclonky: i have the problem with things like libreoffice and postgres
[2012-06-13 11:16:09 -0400] BryanWB_: alclonky: if using yum provider, it should pull in dependencies
[2012-06-13 11:17:58 -0400] alclonky: but these things aren't in yum repos
[2012-06-13 11:18:08 -0400] alclonky: i know i don't have the problem with yum
[2012-06-13 11:18:37 -0400] BryanWB_: alclonky: i would use an execute block then
[2012-06-13 11:19:11 -0400] alclonky: execute blocks are always a ugly :-( hoped for a clean way
[2012-06-13 11:19:50 -0400] BryanWB_: list_of_pkgs = [ "pkg1", "pkg2", "pkg3"] ; execute "install pkgs" do   command "rpm -Uvh #{list_of_pkgs.join(' ')}" ; not_if  { some_clause} ; end
[2012-06-13 11:20:04 -0400] BryanWB_: alclonky: y, think u out of luck
[2012-06-13 11:21:41 -0400] alclonky: maybe i create a repo with these rpms whould be the clean way
[2012-06-13 11:21:43 -0400] alclonky: but thx
[2012-06-13 12:18:35 -0400] rgsteele: Are there "general guidelines" (for lack of a better term) for deciding whether a cookbook_file or template are more situationally appropriate?
[2012-06-13 12:20:25 -0400] rgsteele: E.g., if you have a daemon config file, is it acceptable to simply dump its contents into a file (providing there's no sensitive info in it) and use cookbook_file?  Or is it always recommended to set key/value config options as attributes and use templates?
[2012-06-13 12:24:50 -0400] BryanWB_: rgsteele: i typically use cookbook file for /etc/init.d/some_daemon
[2012-06-13 12:25:12 -0400] BryanWB_: and source config vars from /etc/default/some_daemon, which i use template for
[2012-06-13 12:26:16 -0400] workmad3: rgsteele: cookbook_file for files that don't change (and don't make sense for them to change, e.g. utility scripts, init scripts), templates for files that do change between nodes (e.g. config files)
[2012-06-13 12:26:31 -0400] rgsteele: BryanWB_: Yeah, that's generally my approach too.  Just wasn't sure if there was an official stance on it.  On another note - is there any way to recursively manage all files in a directory, without managing each file individually?
[2012-06-13 12:27:16 -0400] rgsteele: workmad3: Cool, that's pretty much what I've been doing.
[2012-06-13 12:28:07 -0400] rgsteele: Wrt the last question, I'd like to just copy dirs like /etc/pam.d wholesale instead of having to manage each file underneath it individually.
[2012-06-13 12:28:37 -0400] BryanWB_: rgsteele: i believe someone wrote a cookbook that does exaclty that, but can't remember his name
[2012-06-13 12:28:59 -0400] rgsteele: Oh, I just rtfm'ed
[2012-06-13 12:29:08 -0400] BryanWB_: maybe samwellesley or something like that
[2012-06-13 12:29:10 -0400] rgsteele: http://wiki.opscode.com/display/chef/Resources#Resources-RemoteDirectory
[2012-06-13 12:53:14 -0400] agosse: on the topic of cookbook_files, is there any reason why you shouldn't store a large (say, 500M) software package there?
[2012-06-13 13:16:52 -0400] juliancdunn: crazy bandwidth spikes?
[2012-06-13 13:17:59 -0400] agosse: suppose a dedicated apt/yum repo would be ideal.
[2012-06-13 13:18:15 -0400] agosse: (or whatever redhat,etc use)
[2012-06-13 13:22:23 -0400] cassarani: how would I go about installing, say, nginx, by compiling it from source? I'm particularly confused by how I can make it an idempotent operation during a Chef run
[2012-06-13 13:25:08 -0400] lewjg: I think the nginx cookbook from the community site has a recipe for doing that.
[2012-06-13 13:25:20 -0400] lewjg: You could probably use or modify that one to your needs.
[2012-06-13 13:25:35 -0400] geekbri: cassarani: there are many different ways in which you can make something idempotent.  You could maybe set a normal attribute on the node itself after installation in complete, and the cookbook can noop on install if it is set.  You could check for the existence of certain files on disk... or even drop a file in a location and check to see if that file is there.
[2012-06-13 13:25:58 -0400] geekbri: There is already an nginx cookbook as well.  There is also a cookbook called "ark" which I believe assists in installing things from source.
[2012-06-13 13:30:58 -0400] yfeldblum: cassarani, the nginx::source recipe from the nginx cookbook offered by opscode (https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb) may do what you're looking for
[2012-06-13 13:31:07 -0400] gp5st: hola! chef-solr keeps crashing and i don't see anything clear in the logs why
[2012-06-13 13:31:20 -0400] gp5st: the jetty and solr logs i mean
[2012-06-13 13:33:23 -0400] yfeldblum: cassarani, not sure if the ark resource is idempotent
[2012-06-13 13:33:32 -0400] yfeldblum: cassarani, provider, rather
[2012-06-13 13:40:02 -0400] drrk: is there a standard way or throwing a error or warnign in a recipe?
[2012-06-13 13:41:18 -0400] rndm: planning question: if i add libraries to a cookbook, can i access them from another (provided the other is requried in the metadata)?
[2012-06-13 13:44:28 -0400] geekbri: You would have to use ark in conjunction with your own system for making sure things are idempotent
[2012-06-13 13:45:42 -0400] cassarani: geekbri, yfeldblum: thanks a lot :)
[2012-06-13 13:45:48 -0400] geekbri: :)
[2012-06-13 13:54:04 -0400] drrk: raising exceptions in recipes anyone?  I can find docs on hendlign them but not raising them :(
[2012-06-13 13:59:36 -0400] Oct: drrk: Chef::Log.error("hop")
[2012-06-13 13:59:42 -0400] Oct: or Chef::Log.info("Argl")
[2012-06-13 13:59:44 -0400] drrk: Thanks Oct
[2012-06-13 13:59:53 -0400] Oct: there is also warn and fatal
[2012-06-13 13:59:57 -0400] Oct: I think...
[2012-06-13 14:02:08 -0400] BryanWB_:  i am seeing a really strange bug, where the  rendered template always has different checksum  than the file it templates, but I don't use any hashes in my template
[2012-06-13 14:02:27 -0400] BryanWB_: further the sha256sum of the backed up file matches the file that replaced it
[2012-06-13 14:03:16 -0400] BryanWB_: even strnager, i only see it on some of the nodes that use this recipe
[2012-06-13 14:04:01 -0400] drrk: can I get an account on the wiki to add the information about raising errors?
[2012-06-13 14:06:07 -0400] geekbri: Anybody using the monit cookbook from the community site? Is it not terrible?
[2012-06-13 14:08:36 -0400] BryanWB_: drrk: i got an acct, but can't remember how, i think u have to sign cla and then u get an acct
[2012-06-13 14:08:49 -0400] atomic-penguin: geekbri, are you asking if anyone else thinks it is terrible?
[2012-06-13 14:09:03 -0400] geekbri: atomic-penguin: or if anybody thinks it is great.  either or
[2012-06-13 14:09:23 -0400] geekbri: it was my cryptic way of saying "What do you guys think about it"
[2012-06-13 14:09:44 -0400] drrk: aparantly I have an account already....
[2012-06-13 14:09:47 -0400] rndm: i didn't find it cryptic
[2012-06-13 14:17:36 -0400] drrk: wiki documentation win :)
[2012-06-13 14:18:12 -0400] drrk: if I've got anything wrong please tellme/edit http://wiki.opscode.com/display/chef/Recipes#Recipes-ExceptionsandLogging
[2012-06-13 14:32:53 -0400] steelnwool: i used chef-solo to install  on centos. i'd like to uninstall now. can it do that?
[2012-06-13 14:33:52 -0400] wamcvey: Anyone else run into: "FATAL: NotImplementedError: super from singleton method that is defined to multiple classes is not supported; this will be fixed in 1.9.3 or later" while running the 'python::default' recipe (I'm running via chef-solo)?
[2012-06-13 14:37:17 -0400] wamcvey: That error was from an omnibus install on ubuntu 10.04.4. I initially encountered the error with chef 0.10.8, but recognizing that I wasn't running latest, I upgraded to 0.10.10.
[2012-06-13 14:37:37 -0400] wamcvey: still seeing the fatal error.
[2012-06-13 14:55:43 -0400] BryanWB_: looks like  my problem was caused by ruby 1.8.7 on rhel 6.2
[2012-06-13 14:55:52 -0400] BryanWB_: omnibus-chef saved the day
[2012-06-13 15:15:19 -0400] dwhsix: quick Q: if I'm passing flags to the script resource, should it be exactly as the flags would be on the command line?  e.g. "-v"?
[2012-06-13 15:57:37 -0400] jelder: i'm trying to install and use a gem in my recipe, but that gem (route53) needs gcc installed first. build-essential is first in my run list but somehow that's not enough. any suggestions?
[2012-06-13 16:00:15 -0400] excalq: @jelder: That depends on the gem, does route53 have more info about its dependencies?
[2012-06-13 16:00:38 -0400] excalq: You might also be running into issues with RVM, etc.
[2012-06-13 16:00:44 -0400] jelder: not using rvm
[2012-06-13 16:00:59 -0400] excalq: good, don't (for servers) :p
[2012-06-13 16:01:15 -0400] jelder: in my cookbook i have,  chef_gem "route_53"; require "route_53"
[2012-06-13 16:03:31 -0400] excalq: you might also use package "package_name" to install other dependencies
[2012-06-13 16:04:26 -0400] jelder: is there any way to get the build-essential cookbook to get evaluated first?
[2012-06-13 16:05:38 -0400] rndm: jelder: include it first in your run_list
[2012-06-13 16:05:58 -0400] rndm: i see you did that
[2012-06-13 16:06:12 -0400] rndm: you maybe need apt or something before build-essential
[2012-06-13 16:06:38 -0400] jelder: http://pastebin.com/8GXHrJxf
[2012-06-13 16:07:54 -0400] jelder: and this is the recipe
[2012-06-13 16:07:55 -0400] jelder: http://pastebin.com/errgQUBV
[2012-06-13 16:09:04 -0400] rndm: oh i see, chef_gem probably takes precidence because it's going to be used in chef
[2012-06-13 16:09:18 -0400] rndm: precedence*
[2012-06-13 16:10:10 -0400] rndm: well... good question =)
[2012-06-13 16:16:03 -0400] jelder: hmm
[2012-06-13 16:16:14 -0400] jelder: can i get around that using a ruby_block or something?
[2012-06-13 16:17:30 -0400] zts: jelder: the problem is that build-essential installs those packages in the execute/converge phase, but chef_gem needs to run in the compile phase
[2012-06-13 16:17:52 -0400] zts: jelder: so you'll need to change build-essential to install the necessary packages earlier
[2012-06-13 16:17:59 -0400] zts: I'll find a link that describes the change...
[2012-06-13 16:18:15 -0400] zts: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-06-13 16:18:51 -0400] jelder: thanks!
[2012-06-13 16:20:20 -0400] zts: no problem :)
[2012-06-13 16:22:45 -0400] zts: jelder: I was just going to create a ticket about that problem, but I was beaten to it!  http://tickets.opscode.com/browse/COOK-1296
[2012-06-13 16:23:04 -0400] jelder: oh cool
[2012-06-13 16:24:11 -0400] jelder: how often do prerelease chef gems get published? master has at least one bug fix i need, which is not in 0.10.10 yet
[2012-06-13 16:27:21 -0400] zts: jelder: I believe they're only produced as candidates for a release, rather than automatically doing it every so often.  They tend to be announced on the mailing list
[2012-06-13 16:28:29 -0400] zts: jelder: most recent was a prerelease gem for 0.10.12, on the 31st of may
[2012-06-13 16:28:39 -0400] hoover_damm: jelder, if there's a bug in master fixed, you should ask btm to bump a prerelease likely
[2012-06-13 16:28:53 -0400] jelder: who do i ask? :)
[2012-06-13 16:29:07 -0400] hoover_damm: jelder, btm
[2012-06-13 16:45:19 -0400] atomic-penguin: I need a catchy talk title for Chef to present at Ohio LinuxFest
[2012-06-13 16:47:36 -0400] rndm: atomic-penguin: are you near to ohio?
[2012-06-13 16:47:59 -0400] atomic-penguin: rndm, yes, I live on the Ohio river
[2012-06-13 16:48:14 -0400] dwhsix: I *am* allowed to have multiple resources in a subcribes, right?  like this:
[2012-06-13 16:48:15 -0400] rndm: atomic-penguin: ah, i live in columbus... well hilliard actually
[2012-06-13 16:48:17 -0400] atomic-penguin: rndm, in WV
[2012-06-13 16:48:23 -0400] dwhsix: subscribes :load, resources(:git => "deploy obanyc-devops", :template => "/etc/bluepill/monitoring.pill"), :delayed
[2012-06-13 16:48:25 -0400] dwhsix: ?
[2012-06-13 16:48:31 -0400] atomic-penguin: rndm, Huntington, so Columbus is 3 hrs away
[2012-06-13 16:49:57 -0400] rndm: ah. i've never been to huntington
[2012-06-13 16:50:16 -0400] rndm: we cut through down 77 from time to time though
[2012-06-13 16:52:40 -0400] atomic-penguin: rndm, there is no good reason to visit Huntington, to be fair
[2012-06-13 16:52:58 -0400] rndm: wikipedia says that you're known for coronary disease
[2012-06-13 16:54:08 -0400] rndm: it looks like a nice place though, glancing from google maps
[2012-06-13 16:54:44 -0400] atomic-penguin: Its like Detroit, WV
[2012-06-13 16:55:02 -0400] atomic-penguin: The University campus is pretty nice though
[2012-06-13 16:55:27 -0400] rndm: ah, somehow i missed that in my skimming
[2012-06-13 16:56:27 -0400] rndm: oh yeah campus looks nice
[2012-06-13 16:59:49 -0400] atomic-penguin: rndm, the fattest city thing applies to the whole census area, including Ashland, KY and Ironton, OH.  The CDC never actually reported that area was "Huntington", instead it was attributed by a journalist
[2012-06-13 17:00:16 -0400] atomic-penguin: rndm, not like obesity related health issues are limited to any one area specifically
[2012-06-13 17:00:52 -0400] ampledata: anyone wanna work here?
[2012-06-13 17:00:57 -0400] rndm: indeed.
[2012-06-13 17:02:05 -0400] ampledata: www.splunk.com/goto/careers
[2012-06-13 17:08:00 -0400] lusis: I think that might be a conflict of interests ;)
[2012-06-13 17:08:22 -0400] ampledata: hey i asked jordan if he wanted a job
[2012-06-13 17:08:32 -0400] ampledata: and now you're stuck with his baby
[2012-06-13 17:08:33 -0400] lusis: hahah
[2012-06-13 17:08:56 -0400] lusis: I don't think that's the first time splunk had asked
[2012-06-13 17:08:57 -0400] ampledata: also nothing saying you can't keep working on logstash, i mean, we'd PAY you to work here
[2012-06-13 17:09:11 -0400] lusis: heh. I think botchagalupe would hunt you down and kill you
[2012-06-13 17:09:16 -0400] lusis: ;)
[2012-06-13 17:09:22 -0400] ampledata: you can both work here
[2012-06-13 17:09:25 -0400] lusis: hahahahaha
[2012-06-13 17:10:19 -0400] xeon22: hi guys
[2012-06-13 17:10:21 -0400] ampledata: i'll split a referral bonus!
[2012-06-13 17:14:36 -0400] xeon22: i was looking for some guidance ...
[2012-06-13 17:14:53 -0400] xeon22: on how to query in a recipe for a tag
[2012-06-13 17:15:41 -0400] xeon22: eg.  have cookbook for webapp and in webapp cookbook need to query for role:db and tag:dev
[2012-06-13 17:16:10 -0400] xeon22: i get the role part ... but somehow cannot seem to query tag
[2012-06-13 17:19:17 -0400] ampledata: can u paste the search Resource you're using?
[2012-06-13 17:23:00 -0400] xeon22: mongonodes = search(:node, "role:mongodb_node")
[2012-06-13 17:23:19 -0400] xeon22: so that will return list of nodes with mongodb role
[2012-06-13 17:23:37 -0400] xeon22: but I then need to query each of those nodes for the tag:dev
[2012-06-13 17:23:43 -0400] ampledata: ah
[2012-06-13 17:24:01 -0400] ampledata: is there a reason you can't include that query in the search?
[2012-06-13 17:24:26 -0400] xeon22: pass array to search method?
[2012-06-13 17:24:32 -0400] ampledata: no i mean
[2012-06-13 17:24:39 -0400] xeon22: with AND
[2012-06-13 17:24:41 -0400] ampledata: search(:node, "role:mongodb_node AND tag:dev"
[2012-06-13 17:24:42 -0400] ampledata: yeah
[2012-06-13 17:24:45 -0400] xeon22: hmmm
[2012-06-13 17:25:09 -0400] xeon22: when i try searching from knife though it returns nothing
[2012-06-13 17:26:24 -0400] ampledata: i've never used tags, i'm researching now
[2012-06-13 17:27:18 -0400] ampledata: ah ok
[2012-06-13 17:27:21 -0400] ampledata: http://wiki.opscode.com/display/chef/Recipes#Recipes-Tags
[2012-06-13 17:27:32 -0400] xeon22: the docs online only describe some methods for identifying if the node is tagged as such
[2012-06-13 17:27:38 -0400] ampledata: k
[2012-06-13 17:28:28 -0400] ampledata: dev_nodes = search(:node, "role:mongodb_node").collect{|n| n.tagged?('dev')}
[2012-06-13 17:28:30 -0400] ampledata: ?
[2012-06-13 17:28:56 -0400] xeon22: i could try that
[2012-06-13 17:28:59 -0400] ampledata: oh sorry
[2012-06-13 17:29:00 -0400] ampledata: u want select
[2012-06-13 17:29:02 -0400] ampledata: not collect
[2012-06-13 17:29:23 -0400] ampledata: dev_nodes = search(:node, "role:mongodb_node").select{|n| n.tagged?('dev')}
[2012-06-13 17:29:37 -0400] ampledata: yeah give that a shot
[2012-06-13 17:29:39 -0400] xeon22: ok ... let me run with that ... thanks!
[2012-06-13 17:29:43 -0400] ampledata: i dont use tags so i cant test here
[2012-06-13 17:32:13 -0400] thehar: Is there a perk to tags that a role wouldn't provide?
[2012-06-13 17:33:49 -0400] jelder: i'm deploying chef in ec2 and i just got this error for the 10th time this week:
[2012-06-13 17:33:49 -0400] jelder: ec2-50-16-50-106.compute-1.amazonaws.com [Wed, 13 Jun 2012 17:32:28 +0000] FATAL: Errno::ETIMEDOUT: Error connecting to https://s3.amazonaws.com/opscode-platform-production-data/organization-ac472093bd1d4c10b9e57e0fef71cd61/checksum-1cf6fbb4eedd59af234228615044dd72?AWSAccessKeyId=AKIAJOZTD2N26S7W6APA&Expires=1339612283&Signature=HArmkNn46WxDXP1FLEiXJiOJwe0%3D - Connection timed out - connect(2)
[2012-06-13 17:34:05 -0400] jelder: is there any way to increase this timeout, or get chef to retry?
[2012-06-13 17:34:05 -0400] qurve: Well, I switched over my entire infrastructure from an old-ass, crappy colocation to a cloudformation/chef-powered amazon setup. Thanks to all you guys in here to helped me with chef stuff.
[2012-06-13 17:37:01 -0400] xeon22: @thehar: the reason we decided to use tags is because we wanted to identify a node in a stage
[2012-06-13 17:37:25 -0400] thehar: Interesting.
[2012-06-13 17:37:36 -0400] xeon22: the problem is, we have scenarios where a node can have the same app configured for different stages on the same node
[2012-06-13 17:37:38 -0400] thehar: We use environments and role searching for that.
[2012-06-13 17:38:15 -0400] xeon22: so the role identifies the app, and the tag identifies the stage
[2012-06-13 17:39:54 -0400] thehar: interesting
[2012-06-13 17:40:00 -0400] thehar: unique idea.
[2012-06-13 17:48:37 -0400] hoover_damm: jelder, your on ec2 right?
[2012-06-13 17:48:42 -0400] jelder: correct
[2012-06-13 17:48:45 -0400] hoover_damm: then that's just :(
[2012-06-13 17:48:49 -0400] jelder: yeah
[2012-06-13 17:48:53 -0400] ampledata: one day we'll get hoover to use 're
[2012-06-13 17:48:55 -0400] hoover_damm: ec2 can't pull from s3 in a timely manner
[2012-06-13 17:48:56 -0400] jelder: http://tickets.opscode.com/browse/KNIFE_EC2-60
[2012-06-13 17:49:04 -0400] hoover_damm: 're ampledata
[2012-06-13 17:49:05 -0400] hoover_damm: :)
[2012-06-13 17:49:11 -0400] ampledata: no 're!
[2012-06-13 17:49:52 -0400] hoover_damm: Dia Dhuit
[2012-06-13 17:50:01 -0400] jelder: between that happening really often, and opscode's bi-hourly api outages, i'm getting pretty frustrated
[2012-06-13 17:50:18 -0400] hoover_damm: jelder, how many nodes do you host?
[2012-06-13 17:50:35 -0400] hoover_damm: jelder, any thoughts of private chef? or hosting your own chef server?
[2012-06-13 17:50:45 -0400] rndm: jelder: i've been getting that too
[2012-06-13 17:50:46 -0400] hoover_damm: jelder, hosted chef uses S3 to store it's files
[2012-06-13 17:50:49 -0400] rndm: the s3 timeout
[2012-06-13 17:50:55 -0400] hoover_damm: and private chef / regular chef doesn't use S3
[2012-06-13 17:50:58 -0400] rndm: it usually succeeds if you try again
[2012-06-13 17:51:08 -0400] rndm: hosted chef
[2012-06-13 17:51:27 -0400] hoover_damm: yeah this is more of an issue with S3
[2012-06-13 17:51:30 -0400] hoover_damm: and needing to use retries
[2012-06-13 17:51:32 -0400] hoover_damm: and short timeouts
[2012-06-13 17:51:35 -0400] jelder: hoover_damm: just 4 while i'm configuring chef to replace our infrastructure at rightscale
[2012-06-13 17:52:03 -0400] rndm: yeah i think if it had a little longer timeout/retry we'd be okay
[2012-06-13 17:52:04 -0400] hoover_damm: i tracked a similar nasty when I worked for Engine Yard about S3 timeouts
[2012-06-13 17:52:04 -0400] jelder: then it will jump to around a dozen
[2012-06-13 17:52:11 -0400] hoover_damm: and our only solution that worked was better timeouts
[2012-06-13 17:52:26 -0400] jelder: i mean, timeouts happen. expecting them should be expected :)
[2012-06-13 17:52:27 -0400] jessicab: jelder: were updating opscode status btw, seems theres some sort of intermittent issue connecting out from ec2
[2012-06-13 17:52:46 -0400] hoover_damm: jelder, timeouts do happen but the problem is S3's timeouts arn't really timeouts
[2012-06-13 17:52:59 -0400] hoover_damm: jelder, it opens the connection, your GET is sent... you wait for your data, you never get it
[2012-06-13 17:53:09 -0400] jelder: how isn't that a timeout?
[2012-06-13 17:53:12 -0400] hoover_damm: jelder, you can wait until the cows come home
[2012-06-13 17:53:19 -0400] hoover_damm: jelder, because the connection is established
[2012-06-13 17:53:44 -0400] hoover_damm: jelder, so you have to wait for curl or net/http's built in timeout to sweep / retry
[2012-06-13 17:53:47 -0400] rndm: hoover_damm: if the GET is sent the connection is established
[2012-06-13 17:53:59 -0400] hoover_damm: right
[2012-06-13 17:53:59 -0400] jelder: hoover_damm: i'm just saying the exception should be caught
[2012-06-13 17:54:15 -0400] jelder: end result is my new instance is eating money and not doing any work
[2012-06-13 17:54:20 -0400] rndm: thought you said isn't*
[2012-06-13 17:54:22 -0400] rndm: sry
[2012-06-13 17:54:41 -0400] jelder: it isn't caught. chef just dies instead of entering a truncated exponential back off loop or something
[2012-06-13 17:54:41 -0400] hoover_damm: rndm, the problem is that you get connected to S3 but S3 doesn't return any data
[2012-06-13 17:54:52 -0400] rndm: hoover_damm: right
[2012-06-13 17:54:58 -0400] rndm: we're asking for a sleep/retry loop
[2012-06-13 17:55:00 -0400] hoover_damm: rndm, AWS has said this could be bucket issues
[2012-06-13 17:55:10 -0400] hoover_damm: well it's not really a straight forward sleep/retry but yeah
[2012-06-13 17:55:12 -0400] rndm: not an abort because it took too long timeout
[2012-06-13 17:55:14 -0400] jelder: the underlying cause really isn't the issue
[2012-06-13 17:55:15 -0400] hoover_damm: that's what i'm trying to point out
[2012-06-13 17:55:24 -0400] hoover_damm: it's not a clean timeout / retry
[2012-06-13 17:55:43 -0400] rndm: yeah but it could be with a catch and a sleep
[2012-06-13 17:56:10 -0400] josephholsten: grr, search isn't returning my windows nodes
[2012-06-13 17:56:31 -0400] hoover_damm: curl --timeout=30 --retry helped 9/10 of the time
[2012-06-13 17:56:32 -0400] rndm: i just run chef-client again
[2012-06-13 17:56:46 -0400] rndm: seems to be sufficiently intermittent
[2012-06-13 17:57:09 -0400] hoover_damm: yep likely one of the S3 servers in EC2 acting up
[2012-06-13 17:57:14 -0400] hoover_damm: but it always acts up
[2012-06-13 17:57:15 -0400] hoover_damm: lol
[2012-06-13 17:57:33 -0400] hoover_damm: at least for me
[2012-06-13 17:57:50 -0400] rndm: this morning was the first i've noticed it
[2012-06-13 17:57:54 -0400] ampledata: http://status.opscode.com/post/25031879597/intermittent-issues-from-amazon-ec2-hosts
[2012-06-13 18:04:02 -0400] evol262: Anyone have experience with chef_solo on Gentoo to bootstrap Chef?  I realize that Gentoo's not officially supported, but the package provider doesn't seem to work as expected.
[2012-06-13 18:10:34 -0400] mattray: evol262: patches welcome though
[2012-06-13 18:15:11 -0400] evol262: I may end up submitting one.  The entire Chef situation on Gentoo is a much (as much of a mess as Gentoo normally is, I guess).
[2012-06-13 18:21:21 -0400] hoover_damm: evol262, package "x11-apps/something"
[2012-06-13 18:21:22 -0400] hoover_damm: isn't working?
[2012-06-13 18:21:36 -0400] hoover_damm: evol262, there was some patches to the provider to make it search instead of having to shove in the atom
[2012-06-13 18:21:48 -0400] hoover_damm: evol262, and most cookbooks require a little love to work on Gentoo but should work.
[2012-06-13 18:22:47 -0400] c_t: Really, though, isn't that part of the whole Gentoo experience?
[2012-06-13 18:22:51 -0400] rndm: evol262: you're brave working on gentoo. i had a gentoo system about 7 years ago and it would break nearly every time i updated
[2012-06-13 18:23:14 -0400] rndm: what c_t said
[2012-06-13 18:23:35 -0400] c_t: rndm: I got tired of Gentoo deciding to recompile X because 'cat' updated or somesuch minor thing
[2012-06-13 18:23:42 -0400] hoover_damm: there is no need to heckle someone because they run Gentoo
[2012-06-13 18:23:54 -0400] hoover_damm: or share your stories of pain
[2012-06-13 18:23:58 -0400] rndm: i'd take X over firefox any day
[2012-06-13 18:24:06 -0400] rndm: but same story =)
[2012-06-13 18:24:36 -0400] hoover_damm: It's a personal sore spot for me I admit as I see people getting the troll just because they run Gentoo
[2012-06-13 18:24:52 -0400] hoover_damm: and it's just as wrong as when people were trolled because they ran Ubuntu
[2012-06-13 18:25:02 -0400] atomic-penguin: does anyone use Gentoo on a large base of servers, really?
[2012-06-13 18:25:16 -0400] c_t: I wouldn't call it getting the troll
[2012-06-13 18:25:21 -0400] c_t: "gentle ribbing" at most
[2012-06-13 18:25:34 -0400] hoover_damm: c_t, your cutting the line too thin
[2012-06-13 18:25:39 -0400] hoover_damm: c_t, call yourself a troll and get over it
[2012-06-13 18:25:52 -0400] c_t: I have to maintain a veneer of respectability, sir
[2012-06-13 18:25:53 -0400] hoover_damm: c_t, I admit I troll and it's horrible when I do
[2012-06-13 18:25:57 -0400] atomic-penguin: http://funroll-loops.info/
[2012-06-13 18:26:19 -0400] hoover_damm: you can redefine it all you want, but it's still the same
[2012-06-13 18:26:25 -0400] hoover_damm: or you can call it bullying if you prefer
[2012-06-13 18:26:31 -0400] hoover_damm: because that is what trolling is usually a form of
[2012-06-13 18:26:38 -0400] rndm: whoa who's trolling?
[2012-06-13 18:26:49 -0400] evol262: We've got Gentoo on ~2000 servers.  Though, to be honest, I walked in here two weeks ago, and Gentoo wouldn't exactly be my first pick.
[2012-06-13 18:27:01 -0400] mattray: on Food Fight when we interviewed Greg K-H, he said a number of financial services shops run Gentoo
[2012-06-13 18:27:11 -0400] mattray: and he runs it too :)
[2012-06-13 18:27:33 -0400] c_t: hu
[2012-06-13 18:27:33 -0400] c_t: h
[2012-06-13 18:27:38 -0400] c_t: learn something new every day
[2012-06-13 18:27:56 -0400] mattray: you get very fine-grained control of your environment
[2012-06-13 18:28:02 -0400] rndm: are these financial shops doing any kind of trading?
[2012-06-13 18:28:08 -0400] mattray: yes
[2012-06-13 18:28:31 -0400] rndm: yeah, then i understand why
[2012-06-13 18:28:38 -0400] mattray: I can't remember if he named names, but I've heard that before
[2012-06-13 18:28:44 -0400] rndm: i also think automated trading is a horrible idea
[2012-06-13 18:28:45 -0400] Mithrandir: for some specialized environments, I think gentoo makes sense.  I'm happy I don't run those kinds of specialised environments, though. :-)
[2012-06-13 18:28:57 -0400] evol262: That's basically the situation we're in.
[2012-06-13 18:29:10 -0400] mattray: yeah, I know an automated trading shop on Gentoo as well
[2012-06-13 18:29:21 -0400] mattray: so evol262, patches welcome ;)
[2012-06-13 18:41:32 -0400] hoover_damm: mattray, doesn't suprise me
[2012-06-13 18:41:43 -0400] hoover_damm: most people overestimate Gentoo's numbers
[2012-06-13 18:41:51 -0400] mattray: over or under?
[2012-06-13 18:41:58 -0400] josephholsten: anyone had issues with 10.10's gem_package on windows?
[2012-06-13 18:42:10 -0400] hoover_damm: mattray, gregkh running Gentoo that is
[2012-06-13 18:42:32 -0400] mattray: yeah, he runs that and OpenSuSE Tumbleweed
[2012-06-13 18:42:34 -0400] hoover_damm: the reason I run Gentoo is I want fine-grained control over my packages and their dependencies
[2012-06-13 18:42:45 -0400] hoover_damm: it's not something a lot of sytem engineers would care about
[2012-06-13 18:42:55 -0400] hoover_damm: they would just throw on postfix or exim or whatever and just be done
[2012-06-13 18:43:22 -0400] mattray: indeed. There is a place for tweaking
[2012-06-13 18:43:28 -0400] hoover_damm: Personally as a full stack engineer mindset I find Gentoo easier as I can provide a more stable / full stack with all the controls / knobs I need
[2012-06-13 18:43:37 -0400] hoover_damm: where I have to go around it less
[2012-06-13 18:43:37 -0400] jelder: i can't imagine wanting to be responsible for more than a few gentoo machines
[2012-06-13 18:43:57 -0400] mattray: jelder: meh, once you've got it automated with Chef, it's all the same ;)
[2012-06-13 18:43:57 -0400] hoover_damm: also my last job we ran over 10k Gentoo instances
[2012-06-13 18:44:03 -0400] jelder: wow
[2012-06-13 18:44:16 -0400] jelder: can you say who that might be?
[2012-06-13 18:44:17 -0400] hoover_damm: technical debt was a bit high on our gentoo fork
[2012-06-13 18:44:18 -0400] josephholsten: I'd rather improve the deps and control in more mainline package managers. That way others can benefit. No more slack ware for me
[2012-06-13 18:44:23 -0400] hoover_damm: Engine Yard
[2012-06-13 18:44:25 -0400] hoover_damm: hehe
[2012-06-13 18:44:42 -0400] jelder: ah should have guessed
[2012-06-13 18:44:44 -0400] josephholsten: (this is why I still use macports)
[2012-06-13 18:44:56 -0400] mattray: josephholsten: homebrew ftw
[2012-06-13 18:45:06 -0400] jelder: love homebrew
[2012-06-13 18:45:09 -0400] hoover_damm: jelder, there's other places that use Gentoo
[2012-06-13 18:45:18 -0400] hoover_damm: jelder, it's a love hate relationship just like Apple
[2012-06-13 18:45:27 -0400] c_t: homebrew's pretty sweet
[2012-06-13 18:45:32 -0400] hoover_damm: not a love love relationship like Opscode
[2012-06-13 18:45:38 -0400] josephholsten: it's lovely, but has half the features I want from a package manager
[2012-06-13 18:45:53 -0400] jelder: i've been quite happy on ubuntu, except when they decide to do retarded things like deprecate xen in favor of kvm
[2012-06-13 18:45:59 -0400] c_t: eventually when I update my desktop to Lion finally, I can extract myself from the weird situation of having fink AND macports AND homebrew
[2012-06-13 18:46:04 -0400] evol262: Gentoo is more hate than love, I think.
[2012-06-13 18:46:18 -0400] evol262: What's wrong with deprecating Xen in favor of KVM?
[2012-06-13 18:46:27 -0400] c_t: jelder: I liked Ubuntu for a long time, when it was a less overtly hostile version of Debian
[2012-06-13 18:46:35 -0400] chip-: Gentoo linux always makes me think of that old Simpsons bit, "Nuts and gum! Together at last."
[2012-06-13 18:46:37 -0400] c_t: but as time went by it started frustrating me more and more
[2012-06-13 18:46:39 -0400] evol262: KVM was mainline first, supported nested virt first, doesn't require LISP-ish configuration junk.
[2012-06-13 18:46:45 -0400] chip-: It's all the most painful bits of FreeBSD mixed in with the most painful bits of Linux.
[2012-06-13 18:46:58 -0400] hoover_damm: evol262, Gentoo's main hatred of from ignorance
[2012-06-13 18:47:07 -0400] rndm: xen requires a xen-aware kernel if i recall correctly
[2012-06-13 18:47:10 -0400] rndm: kvm doesn't
[2012-06-13 18:47:10 -0400] jelder: evol262: but they basically removed it. i wasn't about to replace my 100s of xen nodes with kvm
[2012-06-13 18:47:14 -0400] rndm: unless i'm just old
[2012-06-13 18:47:22 -0400] hoover_damm: evol262, when a devops learns Ubuntu at Devry he larns Ubuntu
[2012-06-13 18:47:22 -0400] ampledata: chip: http://www.airbnb.com/meetups/5asy8pxxs-tech-talk-zach-holman-git-and-github-secrets
[2012-06-13 18:47:26 -0400] evol262: Isn't Ubuntu still downstream from Debian mainline?
[2012-06-13 18:47:29 -0400] hoover_damm: evol262, stick him in front of Gentoo
[2012-06-13 18:47:35 -0400] hoover_damm: evol262, and watch him ask super dumb questions
[2012-06-13 18:47:36 -0400] evol262: Isn't kernel-xen still there somewhere?
[2012-06-13 18:47:47 -0400] hoover_damm: evol262, 'how do I add users?' 'How do I add a group'?
[2012-06-13 18:47:50 -0400] jelder: it was broken for a long time
[2012-06-13 18:47:57 -0400] rndm: ec2 is xen, i think, so i imagine there's a xen kernel
[2012-06-13 18:47:58 -0400] barefoot: hoover_damm: lol
[2012-06-13 18:48:08 -0400] hoover_damm: when you have that kind of braindead ignorance
[2012-06-13 18:48:08 -0400] evol262: To be fair, there are a lot of super dumb question I can also ask about Gentoo.
[2012-06-13 18:48:09 -0400] c_t: xen requires a xen-aware dom0
[2012-06-13 18:48:16 -0400] chip-: ampledata: oh AWESOME. Thank you!
[2012-06-13 18:48:19 -0400] evol262: EC2 is HVM, isn't it?
[2012-06-13 18:48:20 -0400] hoover_damm: it's pretty hard to be anything but negative
[2012-06-13 18:48:43 -0400] hoover_damm: it's the first level of apprehention
[2012-06-13 18:48:50 -0400] ampledata: chip also: http://www.meetup.com/Boundary-Tech-Talks/events/69004752/
[2012-06-13 18:48:58 -0400] hoover_damm: err apprehension
[2012-06-13 18:49:02 -0400] jelder: i was just put off by ubuntu's "we know better than you attitude about something which is obviously used by a lot of people"
[2012-06-13 18:49:06 -0400] evol262: Gentoo's great for some things,  But maintaining a large environment with custom Stage 4s and your own portage tree is a lot harder than Satellite or something.
[2012-06-13 18:49:09 -0400] hoover_damm: evol262, hvm is only the 'hvm' instances
[2012-06-13 18:49:20 -0400] c_t: I did find myself having to build xen by hand on Debian for a long time though
[2012-06-13 18:49:22 -0400] hoover_damm: evol262, only if you customize it
[2012-06-13 18:49:29 -0400] chip-: ampledata: hmm, this one is outside of my areas of interest but I'll pass it on to the Scala guys here.
[2012-06-13 18:49:50 -0400] c_t: still, in my experience Xen's the x86 virtualization thing that comes closest to the awesomeness of VM/370
[2012-06-13 18:49:52 -0400] hoover_damm: evol262, if you have a dated / frozen portage snapshot that you don't jank with it's pretty sane stage 3's to stage4's and then  you just need tinderbox to hanle the packages
[2012-06-13 18:50:08 -0400] rndm: hoover_damm: i don't understand why you blame the distro and not the education
[2012-06-13 18:50:35 -0400] hoover_damm: rndm, education is likely the root cause of most personal issues
[2012-06-13 18:50:37 -0400] rndm: hoover_damm: it sounds like you're saying ubuntu is stupid by association
[2012-06-13 18:50:43 -0400] hoover_damm: and lack of self reflection
[2012-06-13 18:50:56 -0400] ampledata: i don't see how it's scala related bu ok
[2012-06-13 18:51:11 -0400] hoover_damm: I just said that I find myself having to tapdance around Ubuntu more then anything else
[2012-06-13 18:51:12 -0400] evol262: I haven't played with Tinderbox at all.  I suppose this is one of those things that a relatively new Gentoo admin gets to discover.
[2012-06-13 18:51:17 -0400] hoover_damm: my tapdancing maybe my own stupidity
[2012-06-13 18:51:19 -0400] hoover_damm: or Ubuntu's
[2012-06-13 18:51:23 -0400] barefoot: so if using true/false for attributes, will false always cause a problem?
[2012-06-13 18:51:25 -0400] hoover_damm: I am not concerned as to why
[2012-06-13 18:51:30 -0400] chip-: ampledata: Because it's coming from Typesafe, I figure they're likely to be the most interested.
[2012-06-13 18:52:01 -0400] rndm: i see. you're saying the average gentoo "hater" hates from a place of ignorance because he/she learned ubuntu at devry?
[2012-06-13 18:52:12 -0400] hoover_damm: evol262, yup its a learning thing
[2012-06-13 18:52:18 -0400] Mithrandir: the stock debian 3.x kernels have xen (also as dom0) enabled by default.
[2012-06-13 18:52:22 -0400] ampledata: ah ok
[2012-06-13 18:52:25 -0400] rndm: they're all fine. it's  a matter of taste and requirements
[2012-06-13 18:52:36 -0400] evol262: I don't think it's a learning thing at all.  I've been a linux admin for close to a decade, in large environments.
[2012-06-13 18:52:37 -0400] ampledata: chip: boundary are chef users as well, fwiw
[2012-06-13 18:52:48 -0400] evol262: I think it's that the Gentoo community fragmented a few years ago, and nobody's pushing anything.
[2012-06-13 18:53:09 -0400] hoover_damm: evol262, I've been doing Linux Admin for about 20years now
[2012-06-13 18:53:14 -0400] evol262: It's hard to even find docs on Catalyst and making your own ebuilds.
[2012-06-13 18:53:15 -0400] jelder: is there a good source for global linux distro adoption numbers?
[2012-06-13 18:53:15 -0400] rndm: evol262: and fragility is a real thing
[2012-06-13 18:53:25 -0400] hoover_damm: evol262, My belief is the problems about distributions are silly as they are all tapdancing around the same kernel
[2012-06-13 18:53:47 -0400] Mithrandir: hoover_damm: except those that aren't
[2012-06-13 18:54:07 -0400] evol262: There's nothing comparable to rpm.org and Redhat's docs.  And that's fine.  But I don't want to create something that already exists, and that's a difficult process of dicovery on Gentoo.
[2012-06-13 18:54:10 -0400] hoover_damm: the problems we had 10 years ago with ld.so
[2012-06-13 18:54:11 -0400] hoover_damm: still exist
[2012-06-13 18:54:14 -0400] hoover_damm: regardless of distro
[2012-06-13 18:54:31 -0400] hoover_damm: gentoo's --as-needed really didn't help the linking layer right
[2012-06-13 18:54:33 -0400] rndm: what ld.so problems?
[2012-06-13 18:54:37 -0400] hoover_damm: it was neat
[2012-06-13 18:54:53 -0400] Mithrandir: except --as-needed is an ugly hack that breaks binaries in some cases.
[2012-06-13 18:55:01 -0400] evol262: Last time I'd used it (2005), Gentoo had the -best- wiki and community.  Now that's maybe Arch or something, but Gentoo's taken a bit of a dive.  Which is ironic considering that building X took 3 days then and 3 hours now.
[2012-06-13 18:55:03 -0400] hoover_damm: http://www.gentoo.org/proj/en/qa/asneeded.xml
[2012-06-13 18:55:13 -0400] hoover_damm: evol262, arch's wiki is better now.
[2012-06-13 18:55:23 -0400] Mithrandir: evol262: 3 hours to build X?  How slow a machine do you have?
[2012-06-13 18:55:50 -0400] Mithrandir: last time I did a serious rebuild, which is a year-ish ago, building all of debian took about 14 hours.
[2012-06-13 18:55:58 -0400] Mithrandir: all 15k (or so) source packages.
[2012-06-13 18:56:03 -0400] rndm: i am not sure --as-needed fixes a general problem
[2012-06-13 18:56:06 -0400] Mithrandir: on a single system image
[2012-06-13 18:56:16 -0400] hoover_damm: Mithrandir, that's pretty fast
[2012-06-13 18:56:24 -0400] hoover_damm: Mithrandir, last time I built all the packages on Gentoo it took about 2 days
[2012-06-13 18:56:37 -0400] evol262: It's building on a single core of an Opteron 9950 under KVM.
[2012-06-13 18:56:43 -0400] hoover_damm: lol
[2012-06-13 18:56:49 -0400] hoover_damm: and how much ram?
[2012-06-13 18:56:59 -0400] Mithrandir: hoover_damm: dual X5650 with 96G RAM.
[2012-06-13 18:57:15 -0400] Mithrandir: 10kRPM spinning rust.
[2012-06-13 18:57:17 -0400] hoover_damm: Mithrandir, nice healthy big baby!
[2012-06-13 18:57:27 -0400] Mithrandir: yeah, nice and sharp machine.
[2012-06-13 18:57:57 -0400] hoover_damm: rndm, --as-needed does fix a general problem.  It's just most users are unaware of the issue
[2012-06-13 18:57:57 -0400] Mithrandir: not that special any longer.  I bought myself a new IRC box a month or so ago.. six cores, 64G RAM.
[2012-06-13 18:58:03 -0400] hoover_damm: unless you run sid or whatever
[2012-06-13 18:58:15 -0400] hoover_damm: where you have libraries change more often
[2012-06-13 18:58:47 -0400] hoover_damm: dragonflybsd had this whole VFS layer they wanted to do
[2012-06-13 18:58:51 -0400] hoover_damm: Gentoo did --as-needed
[2012-06-13 18:59:32 -0400] hoover_damm: Basically if you open your eyes to the world of Unix.  There is a lot more out there then just Gentoo and Ubuntu
[2012-06-13 18:59:53 -0400] hoover_damm: and the more you learn and the more you become familiar with, the easier it is to work with other distros / strange os's
[2012-06-13 19:00:44 -0400] hoover_damm: Exherbo is pretty neat, so is Funtoo.  Arch is neat, so is OmniOS
[2012-06-13 19:01:00 -0400] hoover_damm: the world is not flat
[2012-06-13 19:01:32 -0400] Mithrandir: if you want to learn something, install some linux distro.  Change to another distro.  Without rebooting.
[2012-06-13 19:01:47 -0400] josephholsten: also lfs
[2012-06-13 19:01:53 -0400] Mithrandir: if you've never done it before, it'sa good learning experience.
[2012-06-13 19:02:04 -0400] rndm: sorry, open my what =
[2012-06-13 19:02:19 -0400] hoover_damm: Mithrandir, :) it's fun
[2012-06-13 19:02:21 -0400] hoover_damm: and hard
[2012-06-13 19:02:56 -0400] Mithrandir: yeah, you have to be careful
[2012-06-13 19:04:20 -0400] josephholsten: http://youtu.be/5WLwRg3erm4
[2012-06-13 19:04:31 -0400] josephholsten: the same thing, but with tires
[2012-06-13 19:06:01 -0400] hoover_damm: so is connecting to a remote server and unrooting the server without rebooting or installation media
[2012-06-13 19:06:07 -0400] hoover_damm: and it's solaris 8
[2012-06-13 19:06:14 -0400] Maniacal: I'm having issues with a service resource.  Can someone take a look at this gist and tell me what they think?  https://gist.github.com/2925821
[2012-06-13 19:08:28 -0400] Maniacal: hmm.  looks like this: http://tickets.opscode.com/browse/CHEF-2345 has something to do with part of my issue
[2012-06-13 19:08:47 -0400] kisoku: Maniacal: Chef::Provider::Service::Redhat supports status by default
[2012-06-13 19:09:06 -0400] kisoku: line 34 of chef/chef/lib/chef/provider/service/redhat.rb
[2012-06-13 19:09:16 -0400] kisoku:  34            @new_resource.supports[:status] = true
[2012-06-13 19:11:26 -0400] evol262: At least omnibus works on Gentoo
[2012-06-13 19:11:47 -0400] Maniacal: kisoku: I see that in the chef ticket I pasted.  still doesn't explain the process table part though maybe the wiki is just out of date.
[2012-06-13 19:12:05 -0400] Maniacal: looks like I might be able to get aorund it using the status_command parameter.  looking into that now
[2012-06-13 19:12:39 -0400] Maniacal: oh, maybe not doing the process table check because of redhat defaulting to supporting status
[2012-06-13 19:12:52 -0400] hoover_damm: evol262, it does
[2012-06-13 19:13:09 -0400] hoover_damm: evol262, you'll just basically want to build a package server if you get to maintain gentoo
[2012-06-13 19:13:28 -0400] hoover_damm: evol262, as compiling on production nodes is really dirty.
[2012-06-13 19:13:47 -0400] hoover_damm: even as a Gentoo user I follow this policy and well it saves me time and :) tears
[2012-06-13 19:13:59 -0400] evol262: That's part of the plan.  Different job, and they haven't had any consistency across their environment.
[2012-06-13 19:14:12 -0400] hoover_damm: sort of the same job really
[2012-06-13 19:14:29 -0400] hoover_damm: you have to take a portage snapshot basically and make that your stage4, and then build the package server with that stage4
[2012-06-13 19:14:33 -0400] hoover_damm: to then roll that out
[2012-06-13 19:14:44 -0400] hoover_damm: kind of a paradox
[2012-06-13 19:14:48 -0400] josephholsten: damn mixlib-shellout is blowing up on windows
[2012-06-13 19:15:19 -0400] kisoku: Maniacal: yeah that sounds about right
[2012-06-13 19:15:20 -0400] xeon22: anyone good with searching tags in a recipe?
[2012-06-13 19:15:29 -0400] Skers55: Does anyone know how the service provider restarts a process?  I'm running into a strange issue where I'm overriding the restart to be graceful (Example: restart_command "service httpd graceful") and the process is only starting up every now and again. The chef logs say the process was started every time.
[2012-06-13 19:15:43 -0400] Maniacal: kisoku: thanks for your time
[2012-06-13 19:16:02 -0400] kisoku: np
[2012-06-13 19:16:55 -0400] josephholsten: Skers55: depends on which provider you're using
[2012-06-13 19:17:21 -0400] Skers55: It should be the default for Redhat
[2012-06-13 19:20:29 -0400] xeon22: Tags anyone?
[2012-06-13 19:21:01 -0400] xeon22: searching for nodes with specific tag?
[2012-06-13 19:23:31 -0400] hoover_damm: xeon22, search(:node, "tags:tag") not working?
[2012-06-13 19:24:04 -0400] xeon22: no
[2012-06-13 19:24:20 -0400] hoover_damm: what is the error or the problem you have? it's returning empty?
[2012-06-13 19:24:31 -0400] xeon22: doesnt return anything when i can clearly see the node is tagged as such
[2012-06-13 19:24:45 -0400] xeon22: returns empty
[2012-06-13 19:24:55 -0400] hoover_damm: you've applied the tag, did you run chef-client on that node yet?
[2012-06-13 19:25:03 -0400] hoover_damm: or equivilent node.save?
[2012-06-13 19:25:15 -0400] hoover_damm: because that works for me
[2012-06-13 19:25:37 -0400] hoover_damm: edited the host added the tag, searched, 0 results... ran shef -z and node.save and re-searched, 1 result
[2012-06-13 19:26:20 -0400] xeon22: when the chef-client is reporting normally, does it not do a node.save?
[2012-06-13 19:26:29 -0400] xeon22: my node checked in 14 mins ago
[2012-06-13 19:26:37 -0400] hoover_damm: should yep
[2012-06-13 19:26:58 -0400] hoover_damm: and if you shef -z on that node and you run node.tags
[2012-06-13 19:27:00 -0400] hoover_damm: you see your tags?
[2012-06-13 19:28:30 -0400] hoover_damm: and if you run your own chef-server now's a good time to check on it and make sure the expander is running
[2012-06-13 19:31:15 -0400] xeon22: knife node show --long shows ... "tags: ["dit"]"
[2012-06-13 19:31:20 -0400] xeon22: which is correct
[2012-06-13 19:31:23 -0400] geekbri: I find the chef webUI for the hosted service to be a bit slow
[2012-06-13 19:31:50 -0400] xeon22: but when i knife search node "tags:dit" ... nothing
[2012-06-13 19:32:02 -0400] hoover_damm: search(:node, "tags:bob") => [node[host1]]
[2012-06-13 19:32:24 -0400] xeon22: also in shef ... search(:node, "tags:dit") => []
[2012-06-13 19:32:52 -0400] hoover_damm: hosted?
[2012-06-13 19:32:52 -0400] bawt_: hosted is slowly migrating to what will be the next major iteration of the chef server (erlang+sql)
[2012-06-13 19:32:59 -0400] xeon22: local
[2012-06-13 19:33:03 -0400] xeon22: own
[2012-06-13 19:33:08 -0400] xeon22: 0.10.8-4
[2012-06-13 19:33:32 -0400] hoover_damm: xeon22, expander running?
[2012-06-13 19:33:36 -0400] xeon22: yes
[2012-06-13 19:34:04 -0400] hoover_damm: xeon22, http://tickets.opscode.com/browse/CHEF-2346
[2012-06-13 19:34:05 -0400] hoover_damm: ?
[2012-06-13 19:34:09 -0400] xeon22: chef-server-ctl status
[2012-06-13 19:34:09 -0400] xeon22: run: chef-server-webui: (pid 22523) 92340s; run: log: (pid 21278) 92692s
[2012-06-13 19:34:09 -0400] xeon22: run: chef-solr: (pid 22538) 92338s; run: log: (pid 21118) 92727s
[2012-06-13 19:34:10 -0400] xeon22: run: couchdb: (pid 22543) 92338s; run: log: (pid 20949) 92739s
[2012-06-13 19:34:10 -0400] xeon22: run: nginx: (pid 22570) 92338s; run: log: (pid 21291) 92691s
[2012-06-13 19:34:10 -0400] xeon22: run: rabbitmq: (pid 22581) 92337s; run: log: (pid 20975) 92738s
[2012-06-13 19:34:11 -0400] xeon22: run: chef-expander: (pid 22638) 92335s; run: log: (pid 21148) 92725s
[2012-06-13 19:34:13 -0400] xeon22: run: chef-server-api: (pid 22686) 92335s; run: log: (pid 21159) 92723s
[2012-06-13 19:35:24 -0400] hoover_damm: check the logs, because if everything looks good... then 2346 might be your problem
[2012-06-13 19:35:34 -0400] hoover_damm: apply that, rebuild and then search for your tag
[2012-06-13 19:39:14 -0400] geekbri: Can anybody who speaks for opscode confirm that maybe they will be releasing a .deb of the new stack?
[2012-06-13 19:40:02 -0400] Mithrandir: do you mean the omnibus or do you mean chef itself?
[2012-06-13 19:40:17 -0400] geekbri: There is an omnibus for the server?
[2012-06-13 19:40:49 -0400] mattray: geekbri: yes and yes. Schedule is off a bit, btm is out this week
[2012-06-13 19:40:56 -0400] geekbri: thats pretty sweeeeet
[2012-06-13 19:41:08 -0400] mattray: geekbri: I don't have timelines
[2012-06-13 19:41:24 -0400] geekbri: Thats ok, im not overly interested in the timelines, I was just curious in general.
[2012-06-13 19:45:10 -0400] Mithrandir: as for the server, I'm working on getting that into Debian as we speak
[2012-06-13 19:45:24 -0400] Mithrandir: so it should hopefully be in and (relativetly) updated for wheezy.
[2012-06-13 19:45:36 -0400] hasrb: Is Chef::EncryptedDataBagItem.load the only way to load an encrypted data bag item? Can you pass a flag to data_bag_item?
[2012-06-13 19:45:50 -0400] hasrb: data_bag_item('bag', 'item', :encrypted => true)
[2012-06-13 19:54:07 -0400] samkottler: jamesturnbull: heyya, quick pm?
[2012-06-13 20:00:55 -0400] jelder: is anyone else seeing timeouts from api.opscode.com every 30 minutes?
[2012-06-13 20:01:21 -0400] loladiro: I'm trying to install a chef server using chef-solo and the ruby gems recipe, but it seems like `apt-get update` is never run and thus I'm getting an old geocode version. Ideas?
[2012-06-13 20:01:53 -0400] loladiro: *gecode
[2012-06-13 20:04:55 -0400] paulmooring: jelder: We're having known issues with AWS (EC2 and S3) right now, is that what you're seeing?
[2012-06-13 20:05:36 -0400] jelder: actually no, i opened a support ticket about this last week, and was trying to figure out if it was limited to your not-yet-paying customers
[2012-06-13 20:09:19 -0400] jessicab: jelder: we dont treat the free accounts any differently, the apis included in the issue we posted though btw - http://status.opscode.com/post/25031879597/intermittent-issues-from-amazon-ec2-hosts
[2012-06-13 20:09:47 -0400] jessicab: jelder: we got complaints about both at around the same time, but thats about all we know right now.. nothings been posted to aws status
[2012-06-13 20:13:13 -0400] hoover_damm: jessicab, s3 connection timeouts are a long-term issue of AWS.  Perhaps Amazon's having a bad day with S3 but I can speak for myself battling them for 2 years...
[2012-06-13 20:13:45 -0400] hoover_damm: jessicab, if you get more you can always have Amazon look into your bucket and make sure it's peachy..
[2012-06-13 20:13:56 -0400] hoover_damm: jessicab, but it's likely just aws
[2012-06-13 20:16:12 -0400] jessicab: hoover_damn - yea, i contacted aws too.. hoping they might have some ideas, so far no complaints outside of ec2 though so it definitely seems to be something with them
[2012-06-13 20:17:00 -0400] hoover_damm: jessicab, *nod* the only thing that can be done is making connection timeouts a little more rigid
[2012-06-13 20:17:29 -0400] hoover_damm: they will come and go as amazon has good and bad days...
[2012-06-13 20:19:10 -0400] timsmith: btm: Any idea on the timeline for the 10.12.0 release?
[2012-06-13 20:21:31 -0400] hoover_damm: jessicab, curl -L --connect-timeout 10 --max-time 120 --retry 3 --retry-max-time 20 {uri}
[2012-06-13 20:21:42 -0400] hoover_damm: jessicab, that's was our happy spot fwiw
[2012-06-13 20:22:07 -0400] hoover_damm: sounds ugly to apply such a thing to net/http but :(
[2012-06-13 20:22:24 -0400] jelder: the one true retry strategy: http://en.wikipedia.org/wiki/Exponential_backoff#Binary_exponential_backoff_.2F_truncated_exponential_backoff
[2012-06-13 20:26:58 -0400] hoover_damm: Let's also keep in mind that EC2 users are only affected
[2012-06-13 20:27:38 -0400] jelder: what % of the opscode user base is on ec2?
[2012-06-13 20:27:40 -0400] jelder: 50%?
[2012-06-13 20:32:31 -0400] loladiro: does anybody have any idea why `apt-get update` is not run even though chef claims that it is?
[2012-06-13 20:32:59 -0400] jelder: loladiro: are you using http://community.opscode.com/cookbooks/apt
[2012-06-13 20:33:20 -0400] loladiro: yes
[2012-06-13 20:33:49 -0400] loladiro: jelder: I use it together with vagrant
[2012-06-13 20:35:12 -0400] loladiro: jelder: Here's the relevant output: http://pastebin.com/bGCRwA5k . As you can see it installs the wrong version of gecode
[2012-06-13 20:35:44 -0400] loladiro: jelder: If I go in via ssh and manually run `apt-get update` and then upgrade the package everything's fine
[2012-06-13 20:36:09 -0400] hoover_damm: jelder, I'd guess closer to 1/3 but only opscode knows that answer.
[2012-06-13 20:36:51 -0400] jelder: loladiro: i ended up using the following non-solution to this problem:
[2012-06-13 20:36:52 -0400] jelder: notifies :run, "execute[apt-get update]", :immediately
[2012-06-13 20:37:28 -0400] loladiro: jelder: yeah. I was about to do that too, but I think it should readily be fixed properly in the recipe
[2012-06-13 20:37:34 -0400] jelder: i agree
[2012-06-13 20:38:23 -0400] loladiro: jelder: Do you think I should open an issue of the apt cookbook?
[2012-06-13 20:39:03 -0400] jelder: loladiro: seems to me like it's either a bug or just lacking documentation, so be my guest :)
[2012-06-13 20:44:11 -0400] LawrenceSeattle: hey is there a good way to call knife from a ruby script other than shelling out?
[2012-06-13 20:56:56 -0400] jessicab: lawrenceseattle - well, you can make api requests directly from a ruby script - http://wiki.opscode.com/display/chef/Making+Authenticated+API+Requests
[2012-06-13 20:57:33 -0400] brianhicks: anyone around who can answer a (maybe) simple question about a problem I have?
[2012-06-13 20:57:49 -0400] LawrenceSeattle: jessicab: thanks.  I just want to do what I do on the command line.  Eg.  knife ec2 server create...
[2012-06-13 20:58:58 -0400] jessicab: lawrenceseattle - i dont know a whole lot about ruby honestly, but this might help.. id figure you could just require the ec2 library and do something like this - http://wiki.opscode.com/display/chef/Knife+Plugins#KnifePlugins-UsingPluginswithinOtherPlugins
[2012-06-13 20:59:41 -0400] LawrenceSeattle: hmm.  I don't wanna put everything in a plugin ideally but that might work
[2012-06-13 20:59:43 -0400] LawrenceSeattle: thanks
[2012-06-13 21:00:22 -0400] jessicab: lawrenceseattle - yea, i believe you can require those libraries outside of a plugin too and it all works the same.. since all a plugin really is is ruby code
[2012-06-13 21:00:45 -0400] LawrenceSeattle: yup, I had a feeling that might work
[2012-06-13 21:01:35 -0400] jessicab: brianhicks - id just post your question, if anyone has any ideas theyll respond
[2012-06-13 21:05:35 -0400] brianhicks: so here's the problem then: I'm trying to write a settings file given some settings in the environment (using the ruby dsl's default_attributes) and the node (using the same) but the attributes never seem to make it to the recipe, or I'm trying to access them wrong (defined as default_attributes(:recipe => {:key => "value"}), accessed as node[:recipe][:key])
[2012-06-13 21:18:33 -0400] brianhicks: so can anyone educate me on how to get these attributes into my recipe?
[2012-06-13 21:21:33 -0400] littleidea: brianhicks: where are you defining the attributes? as in what file. Are you using client or solo?
[2012-06-13 21:22:18 -0400] littleidea: I have a question... why would the cookbook loader not see cookbooks that are in its cookbook path?
[2012-06-13 21:22:32 -0400] littleidea: WARNING: No cookbooks to test in /Users/andrew/.chef/../rcb/chef-cookbooks/cookbooks - is your cookbook path misconfigured?
[2012-06-13 21:22:33 -0400] brianhicks: littleidea: Defining in recipes/<name>/attributes/default.rb, and using client
[2012-06-13 21:23:18 -0400] littleidea: it was working fine until I rejiggered some git submodules stuff and now I can't load cookbooks
[2012-06-13 21:25:11 -0400] littleidea: brianhicks: try it like: default[:recipe][:key] = value
[2012-06-13 21:25:49 -0400] littleidea: or just default[:recipe] = an_arbitrary_hash
[2012-06-13 21:25:53 -0400] brianhicks: littleidea: I'm doing that in the attributes file, I should have been more clear. The problem is setting them from the role/environment
[2012-06-13 21:26:05 -0400] littleidea: ah
[2012-06-13 21:26:22 -0400] littleidea: have you pushed the roles/environments up to the server?
[2012-06-13 21:26:32 -0400] brianhicks: yes
[2012-06-13 21:27:35 -0400] littleidea: if you do 'knife role list' do you see it?
[2012-06-13 21:27:59 -0400] littleidea: if yes, what does 'knife role show name' have?
[2012-06-13 21:28:14 -0400] brianhicks: argh. Do you know what? Since you asked, I double checked, and the environment had failed to upload.
[2012-06-13 21:28:26 -0400] brianhicks: so thanks anyway. Kudos for helping a newbie. ;)
[2012-06-13 21:28:27 -0400] littleidea: BAMN
[2012-06-13 21:28:46 -0400] littleidea: NOW WHY CAN'T KNIFE SEE MY COOKBOOKS :(
[2012-06-13 21:28:52 -0400] littleidea: we're all new at something
[2012-06-13 21:29:47 -0400] ron__: hello
[2012-06-13 21:29:53 -0400] ron__: a very newbie question
[2012-06-13 21:30:12 -0400] ron__: are there any examples out there for using the git cookbook
[2012-06-13 21:30:35 -0400] ron__: and any tips on how to make chef clone a private repo on bitbucket
[2012-06-13 21:30:48 -0400] ron__: I'm having a really hard time getting that to work
[2012-06-13 21:35:03 -0400] sivy: I'm confused: chef-client is complaining that attribute :fqdn is undefined; in the manager app, I can see the fqdn right there.
[2012-06-13 21:37:51 -0400] sivy: this is the error: https://gist.github.com/39aaf9791a436e7c92bb
[2012-06-13 21:37:58 -0400] sivy: i know that has worked in the past
[2012-06-13 21:39:27 -0400] sivy: when i log into manager.opscode.com, I can see the fqdn in the node data.
[2012-06-13 21:52:02 -0400] timsmith: can someone tell me how to get ohai to show all the data it has indexed. Via search I can find a ton of dmi data, but just running ohai there's nothing
[2012-06-13 21:52:43 -0400] sascha_d: timsmith on the node or in Chef?
[2012-06-13 21:53:04 -0400] hoover_damm: timsmith, ohai dmi
[2012-06-13 21:53:08 -0400] sascha_d: ohai on the command line should show you everything
[2012-06-13 21:53:41 -0400] hoover_damm: timsmith, you can select the first 'branch' of the tree built by ohai by just saying ohai dmi
[2012-06-13 21:53:44 -0400] hoover_damm: or ohai kernel or ohai ec2
[2012-06-13 22:08:05 -0400] tony_: when running: knife ssh 'name:NODE_NAME' 'sudo chef-client'
[2012-06-13 22:08:09 -0400] tony_: i get the following error
[2012-06-13 22:08:30 -0400] tony_: WARNING: Failed to connect to node[NODE_NAME] -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2012-06-13 22:09:02 -0400] tony_: any ideas on what's going on? or how to run 'chef-client' without having to ssh into the server
[2012-06-13 22:11:28 -0400] defghanistan: Hi all, when using the git cookbook on a windows server, how would one do a git pull in regards to the directory it's run from? for example: git 'pull' do
[2012-06-13 22:11:28 -0400] defghanistan:   action :pull git@github.com:repo-name
[2012-06-13 22:11:29 -0400] defghanistan: end
[2012-06-13 22:30:15 -0400] sivy: hai chefs
[2012-06-13 22:30:44 -0400] sivy: i'm looking at the debug log for a run, and I'm getting an error while loading a cookbook's attribute file:
[2012-06-13 22:30:45 -0400] sivy: Node admin01 loading cookbook postfix's attribute file /var/cache/chef/cookbooks/postfix/attributes/default.rb
[2012-06-13 22:31:03 -0400] sivy: right after this it starts error handling
[2012-06-13 22:31:16 -0400] sivy: the error is: "Attribute fqdn is not defined"
[2012-06-13 22:32:30 -0400] sivy: i checked the postfix/attributes/default.rb and found this line:
[2012-06-13 22:32:31 -0400] sivy: default[:postfix][:myhostname] = fqdn
[2012-06-13 22:32:36 -0400] hoover_damm: sivy, what does ohai fqdn show
[2012-06-13 22:32:37 -0400] hoover_damm: ?
[2012-06-13 22:32:43 -0400] sivy: but this has been working for a long time
[2012-06-13 22:33:07 -0400] sivy: hoover_damm: not found, oddly.
[2012-06-13 22:33:21 -0400] sivy: but if i load the node in opscode platform, it's there
[2012-06-13 22:33:22 -0400] hoover_damm: sivy, wthat's your issue
[2012-06-13 22:33:23 -0400] sivy: in the node data
[2012-06-13 22:33:37 -0400] hoover_damm: hostname -f isn't returning what you want it to
[2012-06-13 22:33:38 -0400] hoover_damm: fix it
[2012-06-13 22:33:38 -0400] sivy: how would it get out of sync
[2012-06-13 22:34:22 -0400] sivy: wtf... % hostname -f # hostname: Name or service not known
[2012-06-13 22:34:47 -0400] hoover_damm: now run hostname
[2012-06-13 22:34:54 -0400] hoover_damm: and check out /etc/hosts
[2012-06-13 22:34:58 -0400] josephholsten: anyone know how to get ahold of the maintainer for http://community.opscode.com/cookbooks/solr ?
[2012-06-13 22:34:58 -0400] hoover_damm: and make the changes required to make it work
[2012-06-13 22:35:21 -0400] josephholsten: or where its repo is?
[2012-06-13 22:35:39 -0400] silk1: Does opscode still retain 0.10.8 in its debian package repository?
[2012-06-13 22:39:38 -0400] sivy: hoover_damm: fixed it: I had set the hostname with % hostname 'asubdomain' and I screwed it up
[2012-06-13 22:39:41 -0400] sivy: dur
[2012-06-13 22:55:08 -0400] countdigi: question is @new_resource.updated_by_last_action(true) needed in lwrp as well?
[2012-06-13 22:59:38 -0400] yfeldblum: countdigi, use the method rather than the ivar
[2012-06-13 23:00:06 -0400] yfeldblum: countdigi, you *should* correctly implement providers according to the standard behavior expected of a provider
[2012-06-13 23:00:58 -0400] yfeldblum: countdigi, in correct providers, all changes to the system are taken within the action methods; if such changes are taken in a given action method, then the provider must mark the resource as updated by the last action
[2012-06-13 23:02:01 -0400] yfeldblum: countdigi, if you don't do it that way, your code may still work, depending on what you're actually doing and how you're doing notifications/subscriptions/handlers/etc
[2012-06-13 23:06:39 -0400] tony_: HI all
[2012-06-13 23:06:47 -0400] tony_: is there a way to make chef do simple things
[2012-06-13 23:06:52 -0400] tony_: like create directories
[2012-06-13 23:06:57 -0400] tony_: or copy files around
[2012-06-13 23:06:59 -0400] hoover_damm: directory "/bob" do
[2012-06-13 23:07:04 -0400] hoover_damm: action :create
[2012-06-13 23:07:05 -0400] hoover_damm: end
[2012-06-13 23:07:11 -0400] hoover_damm: ^^ tony_
[2012-06-13 23:07:19 -0400] tony_: where would be the best place to put these?
[2012-06-13 23:07:20 -0400] yfeldblum: tony_, FileUtils.mkpath and FileUtils.mv
[2012-06-13 23:07:21 -0400] hoover_damm: tony_, have you read over the chef-fundamentals?
[2012-06-13 23:07:43 -0400] hoover_damm: tony_, after that then you just need basic ruby fu to drop in the remaining pieces
[2012-06-13 23:07:45 -0400] doomviking: if I had a dime for all the questions I didn;t ask here, because I googled and read documentation...:)
[2012-06-13 23:07:52 -0400] hoover_damm: that don't work with a regular resource
[2012-06-13 23:08:04 -0400] hoover_damm: doomviking, you'd be a rich man?
[2012-06-13 23:08:13 -0400] doomviking: I'd have a few bucks probably
[2012-06-13 23:08:27 -0400] doomviking: enought for a beer
[2012-06-13 23:08:40 -0400] tony_: just found chef-fundamentals
[2012-06-13 23:08:45 -0400] tony_: thanks, and sorry about that
[2012-06-13 23:08:59 -0400] doomviking: nothing against you tony_
[2012-06-13 23:11:20 -0400] doomviking: I supremely detest the idea that people shouldn't ask questions, even before doing their own research.
[2012-06-13 23:12:26 -0400] doomviking: makes for a stuffy irc channel
[2012-06-13 23:27:57 -0400] LawrenceSeattle: eek buffer overflow in ruby :(
