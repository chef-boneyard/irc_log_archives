[2012-06-01 00:00:03 -0400] yfeldblum: qurve, that's still an open question
[2012-06-01 00:00:09 -0400] qurve: At least not in this instance.
[2012-06-01 00:00:15 -0400] silk: its ok, i was sure I was insane about a week ago when i ran into it
[2012-06-01 00:01:55 -0400] syphon: can only Users write to Private Chef with Knife? I installed Knife on a server in our lab and want it to automatically 'knife cookbook upload -a' from Source Control, but it doesn't have permission to do so (it DOES have read permissions)
[2012-06-01 00:02:26 -0400] yfeldblum: syphon, clients/users with the admin bit set
[2012-06-01 00:02:51 -0400] yfeldblum: hmm, any reason for the spike in people downloading librarian-chef today?
[2012-06-01 00:03:31 -0400] syphon: Got it. How do I set the admin bit for this client?
[2012-06-01 00:04:39 -0400] jeremyolliver: Heya, I think there's an issue with the checksums on one of the packages on the opscode apt repositories
[2012-06-01 00:05:27 -0400] jeremyolliver: I'm getting an error bootstrapping via the ubuntu10.04-apt template
[2012-06-01 00:05:32 -0400] jeremyolliver: Failed to fetch http://apt.opscode.com/pool/main/libt/libtreetop-ruby/libtreetop-ruby_1.4.9-0opscode1_all.deb  Hash Sum mismatch
[2012-06-01 00:05:36 -0400] yfeldblum: syphon, EDITOR=vim knife client edit $CLIENT ?
[2012-06-01 00:06:35 -0400] jeremyolliver: checksums on http://apt.opscode.com/dists/lucid-0.10/main/binary-amd64/Packages for this package definitely don't seem to match that file
[2012-06-01 00:09:03 -0400] jeremyolliver: anyone got any ideas on that, or should I just go with installing chef-client a different way like switching to the gems bootstrap template?
[2012-06-01 00:13:42 -0400] jeremyolliver: I can workaround I guess, but can someone point me to the best place to file a bug for that?
[2012-06-01 00:16:54 -0400] syphon: yfeldblum: Any idea why 'knife client edit' isn't saving edits? When I edit the client in notepad (yes I'm on Windows) it claims it saved the client, but reopening it shows that it hasn't updated
[2012-06-01 00:22:35 -0400] miah: syphon: are you an admin?
[2012-06-01 00:23:16 -0400] syphon: yep
[2012-06-01 00:40:43 -0400] pwf: is there a way to show my knife cookbook path
[2012-06-01 00:40:50 -0400] pwf: my config file does not seem to be working...
[2012-06-01 00:41:36 -0400] other_guy: Hi, I'm trying to figure out why my Chef Server also needs to have Chef Client installed?
[2012-06-01 00:42:21 -0400] other_guy: The documentation talks about installing things like this...
[2012-06-01 00:42:22 -0400] other_guy: apt-get install chef chef-server
[2012-06-01 00:42:47 -0400] other_guy: but what is the point of the base chef package (that includes the client stuff) on a machine that's only a chef-server?
[2012-06-01 00:44:06 -0400] kgawt: afaik chef includes knife
[2012-06-01 00:44:22 -0400] kgawt: and chef-server is difficult to manage without a knife ;-)
[2012-06-01 00:45:13 -0400] kgawt: you don't have to make your server a client
[2012-06-01 00:46:07 -0400] jeremyolliver: it's really just a common package that includes the client, there's no need to actually setup the 'server' as a client
[2012-06-01 00:51:09 -0400] other_guy: Thanks guys
[2012-06-01 01:08:32 -0400] yfeldblum: other_guy, you can use chef-solo to set up an instance of chef-server (if you like), but you don't need chef-client installed on a server in order to install chef-server on it
[2012-06-01 01:09:24 -0400] other_guy: thanks, yeah I'm trying to get chef-server setup with knife to let me bootstrap instances on Rackspace Cloud Servers
[2012-06-01 01:10:23 -0400] yfeldblum: you don't need knife installed to set up chef-server on a server
[2012-06-01 01:11:03 -0400] other_guy: but I do need knife to run the command that bootstraps the Rackspace server.
[2012-06-01 01:11:13 -0400] other_guy: Though I suppose I could run that from my workstation?
[2012-06-01 01:11:40 -0400] yfeldblum: you *always* run knife commands from your workstation
[2012-06-01 01:12:01 -0400] yfeldblum: and most knife commands *require* a functioning chef-server that it can talk to
[2012-06-01 01:12:04 -0400] other_guy: ah, I was just planning on running them from the same machine where server was running.
[2012-06-01 01:12:20 -0400] other_guy: But it would be nice to not have to do that
[2012-06-01 01:12:28 -0400] yfeldblum: not sure why you would want to do that
[2012-06-01 01:12:41 -0400] other_guy: I didn't want to, it's just how the documentation presents it
[2012-06-01 01:12:57 -0400] yfeldblum: ok
[2012-06-01 01:13:44 -0400] other_guy: So then in reality I could just run chef-server on my server, chef-client on each node bootstrapped by running knife commands from my workstation?
[2012-06-01 01:14:20 -0400] yfeldblum: right
[2012-06-01 01:14:29 -0400] other_guy: That makes about a thousand times more sense
[2012-06-01 01:14:32 -0400] other_guy: thank you.
[2012-06-01 01:14:45 -0400] yfeldblum: no probs
[2012-06-01 01:15:16 -0400] other_guy: Since my workstation is OS X, do you happen to know what I need installed to run knife?
[2012-06-01 01:15:22 -0400] other_guy: Are the knife gems enough?
[2012-06-01 01:15:49 -0400] hoover_damm: you'd need the chef gem
[2012-06-01 01:16:08 -0400] other_guy: got it.
[2012-06-01 01:16:23 -0400] other_guy: Thanks again!
[2012-06-01 01:21:28 -0400] silk: Yo will probably need xcode installed also
[2012-06-01 01:35:17 -0400] other_guy: silk, already have that :-)
[2012-06-01 01:36:31 -0400] yfeldblum: you will probably need an operating system
[2012-06-01 01:36:38 -0400] yfeldblum: and ruby
[2012-06-01 01:36:51 -0400] yfeldblum: and physical hardware
[2012-06-01 01:37:17 -0400] miah: i run chef on my abacus
[2012-06-01 01:41:51 -0400] kgawt: i run chef on my ti-85
[2012-06-01 01:42:11 -0400] miah: hot
[2012-06-01 01:46:34 -0400] hoover_damm: my cats run chef-client in their sleep
[2012-06-01 01:46:49 -0400] hoover_damm: looping like them catching a mouse
[2012-06-01 01:52:18 -0400] amagee: hey i'm trying to install chef server by following this: http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages
[2012-06-01 01:52:48 -0400] amagee: i got as far as installing the chef-server (etc) apt packages, which tried to start the server and i ran into this problem here: http://tickets.opscode.com/browse/CHEF-2138
[2012-06-01 01:53:21 -0400] amagee: i've got a little bit further by following the instructions there, but now when i try to start the chef server i just get "* Starting chef-server / ~ In 25124 / [fail]"
[2012-06-01 01:54:21 -0400] amagee: i don't get any error message and i can't find anything seemingly relevant in /var/log/chef (the only files are 2012_06_01.jetty.log, client.log, merb.main.log, and solr.log
[2012-06-01 01:54:27 -0400] amagee: so i'm a bit stuck.. does anyone have any ideas?
[2012-06-01 01:56:37 -0400] kgawt: what os and version of chef are you using?
[2012-06-01 01:57:42 -0400] amagee: ubuntu 11.04, chef 0.10
[2012-06-01 01:58:25 -0400] hoover_damm: merb.main.log should be useful
[2012-06-01 01:59:13 -0400] amagee: merb.main.log only has one line: Fri, 01 Jun 2012 01:29:45 GMT  ~  info  ~  Logfile created
[2012-06-01 01:59:25 -0400] kgawt: i haven't tried 11.04, 10.04 and 12.04 have both worked fine for me
[2012-06-01 02:00:56 -0400] kgawt: what version of ruby/rubygems are you running?
[2012-06-01 02:01:06 -0400] amagee: how do i find that out?
[2012-06-01 02:01:13 -0400] kgawt: ruby -v
[2012-06-01 02:01:14 -0400] kgawt: gem -v
[2012-06-01 02:01:35 -0400] amagee: ruby 1.8.7, rubygems 1.8.24
[2012-06-01 02:02:08 -0400] kgawt: ive got rubygems 1.8.15
[2012-06-01 02:02:26 -0400] kgawt: i think thats the one that gets installed from the opscode repo
[2012-06-01 02:02:43 -0400] amagee: so what do you suggest?
[2012-06-01 02:03:03 -0400] kgawt: i also recall reading somewhere to install rubygems from source
[2012-06-01 02:03:32 -0400] amagee: i actually tried that -- it was the first thing i tried (Oliver Dungey's comment here: http://tickets.opscode.com/browse/CHEF-2138 )
[2012-06-01 02:03:39 -0400] amagee: that didn't help
[2012-06-01 02:05:03 -0400] amagee: maybe i should just upgrade to 12.04 and try again?
[2012-06-01 02:05:34 -0400] kgawt: this worked perfect for me and was simple
[2012-06-01 02:05:35 -0400] kgawt: http://generalthings.com/2012/05/08/simple-steps-install-chef-ubuntu-12-04-10-04/
[2012-06-01 02:06:05 -0400] kgawt: you could try 'apt-get purge chef chef-server'
[2012-06-01 02:06:14 -0400] kgawt: and then reinstall
[2012-06-01 02:06:43 -0400] kgawt: but ive had various issues with different ruby and rubygem versions
[2012-06-01 02:06:45 -0400] amagee: ok trying that
[2012-06-01 02:07:18 -0400] kgawt: did you have ruby or rubygems install prior to chef/chef-server?
[2012-06-01 02:07:30 -0400] amagee: no, i installed on a clean system
[2012-06-01 02:07:39 -0400] amagee: then after it didn't work i started mucking around with rubygems
[2012-06-01 02:08:02 -0400] kgawt: ah i see
[2012-06-01 02:08:45 -0400] kgawt: makes me feel good to know im not the only one :-)
[2012-06-01 02:08:55 -0400] amagee: haha
[2012-06-01 02:11:40 -0400] kgawt: i got everything up and running and then found out i needed ruby1.9 to run knife-windows
[2012-06-01 02:15:53 -0400] hoover_damm: using ruby 1.9 should be standard I hope
[2012-06-01 02:22:37 -0400] kgawt: hoover_damm: yes... but the chef packages install ruby 1.8
[2012-06-01 02:22:54 -0400] kgawt: and then you have to use something like rvm to use ruby 1.9
[2012-06-01 02:23:25 -0400] kgawt: or you have to start with ruby 1.9 and then install chef from rubygems
[2012-06-01 02:25:58 -0400] kgawt: all im saying is it would have been nice to mention that if you plan to use knife-windows on your workstation be sure to start with ruby 1.9
[2012-06-01 03:13:11 -0400] amagee: hey i just tried exactly this http://generalthings.com/2012/05/08/simple-steps-install-chef-ubuntu-12-04-10-04/ on a brand new 12.04 ec2 instance and i still got [fail] on starting chef-server
[2012-06-01 03:14:16 -0400] amagee: hmm although the server does actually appear to be running this time...
[2012-06-01 03:23:10 -0400] cwj: skip the debs, use omnibus installer http://www.opscode.com/chef/install/
[2012-06-01 03:23:48 -0400] cwj: slick stuff :D
[2012-06-01 03:23:49 -0400] qurve: Anyone using that to install production systems yet?
[2012-06-01 03:24:18 -0400] cwj: i use platform for production myself
[2012-06-01 03:24:55 -0400] JasonBox: hrm, maybe silly, but is there something like default_attributes_silly('cookbook:myns') do key('cute') 'value' done
[2012-06-01 03:24:58 -0400] JasonBox: Or something similiar
[2012-06-01 03:25:30 -0400] JasonBox: My 3 or 4 level deep {{{{}}}} is making me crazy
[2012-06-01 03:26:25 -0400] bemu: qurve: We do as well.
[2012-06-01 03:26:39 -0400] bemu: 600 machines or so.
[2012-06-01 03:35:15 -0400] coderanger: JasonBox: what are you trying to do?
[2012-06-01 03:35:28 -0400] coderanger: Just nested keys in a role file?
[2012-06-01 03:36:26 -0400] coderanger: JasonBox: I was talking to jtimberman (I think) and came up with doing default_attributes[:foo][:bar] = :baz, should be doable without breaking any existing code :)
[2012-06-01 03:36:34 -0400] coderanger: (just need someone to write the patch)
[2012-06-01 03:41:10 -0400] amagee: hey i've just got to the webui for the first time (http://myserver:4040) and it's saying i should be able to login with admin and the default password, but when i try that it just says "Could not complete logging in."
[2012-06-01 03:46:48 -0400] amagee: ok, never mind, forgot that i was asked for a password during install!
[2012-06-01 05:15:27 -0400] qurve: Know what's rad? When you go to use the tool someone suggested for the first time and it gives you an error, then segfaults :(
[2012-06-01 05:15:35 -0400] qurve: This was not how I envisioned this going...
[2012-06-01 05:16:53 -0400] amagee: ok so i have a chef server, and a chef client, and i can upload and download cookbooks on the client.. how can i execute one cookbook on the client?
[2012-06-01 05:18:26 -0400] silk: set the clients run_list to be that one cookbook.
[2012-06-01 05:18:46 -0400] amagee: how do i do that?
[2012-06-01 05:20:12 -0400] silk: have you registered the client?
[2012-06-01 05:20:33 -0400] amagee: umm i'm not sure, probably not
[2012-06-01 05:21:26 -0400] amagee: how do i do that?
[2012-06-01 05:21:55 -0400] silk: http://wiki.opscode.com/display/chef/Installation
[2012-06-01 05:22:50 -0400] amagee: well i have chef installed
[2012-06-01 05:23:08 -0400] amagee: if the chef client can communicate with the chef server, does that mean it's registered?
[2012-06-01 05:23:14 -0400] amagee: or is that something different?
[2012-06-01 05:23:32 -0400] zts: amagee: probably - try running "knife node list" and see if it shows up
[2012-06-01 05:24:25 -0400] zts: registration will happen when the chef-client first connects to the chef-server, so long as the client has access to validation.pem
[2012-06-01 05:25:15 -0400] amagee: zts: it doesn't show up
[2012-06-01 05:25:41 -0400] amagee: the server shows up, as does a node i created while fiddling around on the server
[2012-06-01 05:26:13 -0400] zts: amagee: how did you install the client?  packages, gems, or "knife bootstrap"?  (or something else)
[2012-06-01 05:29:44 -0400] amagee: hmm i can't remember, i installed it ages ago
[2012-06-01 05:29:49 -0400] zts: okay, no problem
[2012-06-01 05:29:52 -0400] zts: well, two things
[2012-06-01 05:29:54 -0400] amagee: probably packages
[2012-06-01 05:30:10 -0400] zts: 1) check /etc/chef/client.rb on the new client to make sure it has the configuration you're expecting (especially chef_server_url)
[2012-06-01 05:30:35 -0400] amagee: um there's no file called /etc/chef/client.rb
[2012-06-01 05:30:39 -0400] zts: aha
[2012-06-01 05:30:49 -0400] zts: okay, your client definitely isn't setup yet
[2012-06-01 05:30:55 -0400] amagee: i have ~/.chef/knife.rb.. i thought that was it
[2012-06-01 05:31:24 -0400] zts: knife.rb has some similar settings, but it's only used by the knife tool
[2012-06-01 05:31:30 -0400] amagee: oh, ok
[2012-06-01 05:31:50 -0400] pcn: Earlier yfeldblum recommended using the shell_out command, but I am getting nomethoderror when trying to use that in a recipe
[2012-06-01 05:32:01 -0400] pcn: Can anyone tell me what I'm doing wrong?
[2012-06-01 05:32:21 -0400] zts: amagee: do you have an empty /etc/chef, or is the directory missing entirely?
[2012-06-01 05:32:39 -0400] amagee: it exists and has a directory called "cache" inside it
[2012-06-01 05:33:30 -0400] amagee: do i need to run knife configure client?
[2012-06-01 05:34:23 -0400] zts: yeah
[2012-06-01 05:34:41 -0400] zts: that's the easiest way
[2012-06-01 05:35:07 -0400] amagee: the instructions say "If you have a properly configured workstation, you should be able to run the following command from your workstation's chef repository"
[2012-06-01 05:35:17 -0400] zts: pcn: what version of chef are you using?
[2012-06-01 05:35:19 -0400] amagee: supposing i don't have a chef repository to start with, can i just run it from anywhere?
[2012-06-01 05:35:41 -0400] pcn: zts: 0.10.8
[2012-06-01 05:36:21 -0400] zts: amagee: yeah, I believe it should just require a sensible knife configuration + validation.pem, nothing else
[2012-06-01 05:37:02 -0400] zts: pcn: can you pastebin the example recipe, and the stack trace you get when you try to run it?
[2012-06-01 05:37:22 -0400] amagee: zts: do i get validation.pem from the server?  or somewhere else?
[2012-06-01 05:37:40 -0400] zts: amagee: yeah, if you don't already have it on your workstation, you can find it as /etc/chef/validation.pem on your chef server
[2012-06-01 05:37:47 -0400] amagee: ok
[2012-06-01 05:39:05 -0400] zts: amagee: at this point, I'd note that validation.pem is somewhat sensitive, as someone with access to that file can register themselves on your chef server and see a bunch of data.  That might not be a concern in your environment, but it's best to be aware of it
[2012-06-01 05:40:26 -0400] amagee: yup, got it
[2012-06-01 05:42:51 -0400] zts: pcn: actually, unless yfeldblum was referring to something else, this thread might answer your question: http://comments.gmane.org/gmane.comp.sysutils.chef.user/2753
[2012-06-01 05:43:20 -0400] amagee: anyway thanks for your help everyone! i'm off now
[2012-06-01 05:45:47 -0400] pcn: zts if it's of interest, you can see http://comments.gmane.org/gmane.comp.sysutils.chef.user/2753
[2012-06-01 05:46:11 -0400] pcn: The conversation was that shell_out was in the dsl on top of Chef::ShellOut, but it seems that's not the case from that thread
[2012-06-01 05:56:12 -0400] zts: pcn: I haven't used it before, so I'm just hunting around for clues
[2012-06-01 05:56:45 -0400] zts: pcn: I can certainly find shell_out being used in the Chef sources, so it does exist
[2012-06-01 05:56:53 -0400] pcn: zts I just tried with Chef::ShellOut, but it's running during the compile phase, I need this to run during execution - or I need to force file xfer into compile phase.
[2012-06-01 05:57:00 -0400] pcn: since the files I need to run are in the cookbook
[2012-06-01 06:00:59 -0400] zts: pcn: i'd imagine you'd need to use it in a ruby_block if you want it to run during the converge phase
[2012-06-01 06:01:25 -0400] zts: pcn: anything in your recipe outside a resource will run during the compile phase
[2012-06-01 06:06:32 -0400] pcn: zts: worked around it by forcing the cookbook_files into the compile phase.  I'm starting to worry I'll have to do similar hacks to e.g. install packages.  *sigh*
[2012-06-01 06:08:31 -0400] cwj: can you gist what you're trying to do? maybe you just need to set up some notifications/subscriptions between resources?
[2012-06-01 06:09:51 -0400] pcn: cwj: I'm doing some simple discovery via zookeeper, and using external scripts to implement my use case
[2012-06-01 06:11:03 -0400] pcn: gist is https://gist.github.com/2849211
[2012-06-01 06:27:26 -0400] miah: hi
[2012-06-01 07:14:00 -0400] zts: pcn: I agree that forcing stuff to run during the compile phase is usually a smell.  You might want to consider planning on this to converge fully over two runs
[2012-06-01 07:14:25 -0400] zts: pcn: so the first gets the necessary prerequisites in place, the second gets the seed and configures cassandra
[2012-06-01 07:14:58 -0400] zts: pcn: as I said earlier, I'd have thought you could get this to work in one phase by putting shell_out inside a ruby_block, but I haven't tried it so I could be wrong.
[2012-06-01 07:15:11 -0400] zts: pcn: certainly, you might have trouble getting the result into a variable that you can pass into the template resource
[2012-06-01 07:15:34 -0400] zts: pcn: one possibility would be to put the result into node.run_state, but I'm speculating
[2012-06-01 07:22:44 -0400] pcn: I'm OK with this being the way it is.  The way I'm doing the coordination make this ugly but not dangerous
[2012-06-01 07:22:57 -0400] zts: as long as you're happy with it, that's fine
[2012-06-01 07:24:04 -0400] BryanWB_: ohai chefs!
[2012-06-01 07:24:12 -0400] zts: hola BryanWB_
[2012-06-01 07:28:25 -0400] pcn: Hiya bryanwb.  Oh, no.  It's already that late.
[2012-06-01 07:28:42 -0400] BryanWB_: zts: pcn ciao ;)
[2012-06-01 08:57:32 -0400] codeshepherd: i am setting up a server, our company has only one machine as server.. can i use chef for people to replicate the server configuration in their local machines? Is that what chef was built for?
[2012-06-01 08:58:14 -0400] BryanWB_: codeshepherd: u could use it for that
[2012-06-01 08:58:49 -0400] codeshepherd: BryanWB_: thanks.. I am looking at http://blog.afistfulofservers.net/post/2011/03/16/a-brief-chef-tutorial-from-concentrate/ for understanding chef.. is there a simpler tutorial?
[2012-06-01 08:59:07 -0400] BryanWB_: like chef for dummies/
[2012-06-01 08:59:08 -0400] BryanWB_: ?
[2012-06-01 08:59:37 -0400] codeshepherd: ok.. let me ask my question better.. why is a client server architecture required here? BryanWB_
[2012-06-01 09:00:46 -0400] BryanWB_: codeshepherd:  here is a nice overview http://learnchef.getharvest.com/
[2012-06-01 09:00:55 -0400] codeshepherd: thanks BryanWB_
[2012-06-01 09:00:59 -0400] BryanWB_: codeshepherd: not required if u use chef-solo
[2012-06-01 09:01:39 -0400] BryanWB_: the chef-server let u use the search which is freaking awesome
[2012-06-01 09:01:54 -0400] codeshepherd: okie.. member:BryanWB_ ya.. i guessed that i should use chef-solo .. thanks for confirming
[2012-06-01 09:03:58 -0400] BryanWB_: codeshepherd: it's a good place to start
[2012-06-01 09:04:17 -0400] codeshepherd: ya.. am going through the slides BryanWB_
[2012-06-01 10:49:02 -0400] aj__: Hi, does anyone know how / where some documentation for setting up knife to connect to a remote server...
[2012-06-01 10:56:16 -0400] zts: aj__: http://wiki.opscode.com/display/chef/Workstation+Setup is the starting point for those docs (there's specific walkthroughs for each platform)
[2012-06-01 10:56:49 -0400] zts: aj__: that covers creating a chef repository too, but you can skip that part (if you don't need it) and just look at the knife setup parts
[2012-06-01 11:08:23 -0400] elzid: hi guys - any ideas why my hosted chef account wont connect to rackspace API despite the username and API key being correct? Just keeps throwing Bad username or Password...
[2012-06-01 11:09:27 -0400] aj__: Heya, thanks for the advice... i will try the guide/docs now :d
[2012-06-01 11:16:29 -0400] aj__: Thanks for the link.. got it working missed the step with the webui.pem file...
[2012-06-01 11:17:55 -0400] drrk: elzid: are you in the EU?
[2012-06-01 11:18:08 -0400] drrk: if so you need to alter the api endpoint for rackspace
[2012-06-01 11:18:57 -0400] yfeldblum: pcn, if there's a specific need to ask zookeeper the question *after* some other resource action is taken (during the chef-client "execution" or convergence phase), then do that in a resource which is located after the other resource in the resources collection
[2012-06-01 11:19:18 -0400] yfeldblum: pcn, rather than moving things into the compile phase
[2012-06-01 11:20:50 -0400] BryanWB_: putting stuff in compile phase can lead to very unexpected results
[2012-06-01 11:20:57 -0400] BryanWB_: yfeldblum: good morning
[2012-06-01 11:25:37 -0400] elzid: @drrk - yes I am - how can I alter it via the opscode control panel?
[2012-06-01 11:28:00 -0400] drrk: it's in your knife config
[2012-06-01 11:28:13 -0400] drrk: I can't recall the setting off hand
[2012-06-01 11:29:19 -0400] elzid: @drrk - but Im using the hosted chef solution to test Chef - so I cant change it? If I installed my own local chef server, then I'd be able to change it I spose
[2012-06-01 11:29:42 -0400] drrk: you have a knife.rb locally in either case, that's what needs editing
[2012-06-01 11:30:42 -0400] drrk: https://github.com/opscode/knife-rackspace/blob/master/README.rdoc
[2012-06-01 11:30:51 -0400] drrk: "This plugin also has support for authenticating against an alternate API Auth URL. This is useful if you are a Rackspace Cloud UK user or OpenStack early adopter. Here is an example of configuring knife for Rackspace Cloud UK:
[2012-06-01 11:30:52 -0400] drrk: knife[:rackspace_api_auth_url] = "lon.auth.api.rackspacecloud.com""
[2012-06-01 11:32:14 -0400] elzid: @drrk - forgive me as I've never looked at Chef before today - I thought Knife was used at the workstation to collaborate with the chef server? Are you saying that I can use knife to update my Hosted Chef server configs?
[2012-06-01 11:32:17 -0400] yfeldblum: good morning, BryanWB_
[2012-06-01 11:41:58 -0400] drrk: the hosted chef will never talk to the rackspace api, only knife will do that
[2012-06-01 11:43:32 -0400] drrk: knife runs on your workstation and talks to the rackspace api to provision a server, ssh's to said server to bootstrap it with chef-client, and talsk to the hosted chef to create the keys
[2012-06-01 11:44:06 -0400] drrk: then the chef client on server running on rackspace will perodicly tlk to the hosted chef to get it's configuration
[2012-06-01 11:44:44 -0400] drrk: but in order to do that first stage with knife rackspae create you need to configure your local knife.rb to use the correct rackspave api endpoint
[2012-06-01 11:46:16 -0400] elzid: @drrk - very clearly explained - much obliged
[2012-06-01 11:47:48 -0400] drrk: Ths is worth reading aswell: http://wiki.opscode.com/display/chef/Launch+Cloud+Instances+with+Knife#LaunchCloudInstanceswithKnife-Creatingtheserverwiththeknifeplugin
[2012-06-01 11:48:26 -0400] drrk: there are also a number of guides, but they are using Amazon AWS rather than rackspace.  The concepts are similar though
[2012-06-01 11:48:37 -0400] drrk: http://wiki.opscode.com/display/chef/Guides
[2012-06-01 12:29:26 -0400] yfeldblum: i think we should stop calling them the "compile" and "execution" phases ... i think we should call them the "execution" and "convergence" phases ...
[2012-06-01 12:32:27 -0400] yfeldblum: or at least "compilation" and "convergence"
[2012-06-01 12:32:32 -0400] yfeldblum: latez
[2012-06-01 12:35:50 -0400] atomic-penguin: I thought it was compilation and convergence
[2012-06-01 12:47:00 -0400] zts: atomic-penguin: yeah, me too...
[2012-06-01 12:53:21 -0400] ossar: how do I list all attributes for a node with knife?
[2012-06-01 12:56:02 -0400] Caez_: knife node show hostname -l
[2012-06-01 12:59:21 -0400] ossar: thanks :)
[2012-06-01 13:02:30 -0400] Caez_: ;)
[2012-06-01 13:09:04 -0400] dyer: Hey guys, quick question,  Can I reference an attribute to do a conditional statement inside the attributes file ?  Example:  http://bit.ly/KlzL1G  ( yea, that was probably poorly worded )
[2012-06-01 13:11:54 -0400] JasonBox: dyer: Yeah
[2012-06-01 13:12:12 -0400] dyer: Yea, I asked because it wasn't working for me, but I think I know why
[2012-06-01 13:12:17 -0400] dyer: stupid error on my part
[2012-06-01 13:12:21 -0400] JasonBox: Happens
[2012-06-01 13:12:56 -0400] dyer: :)
[2012-06-01 13:13:03 -0400] dyer: Thanks for the quick response
[2012-06-01 13:15:43 -0400] fish_: are there some known issues with the ohai cookbook (for using custom ohai plugins) on chef 0.6.x? looks like it's not using the custom location when loading plugins..
[2012-06-01 13:16:39 -0400] ossar: is there a way to show nested attributes for a node without having to pipe it to grep?
[2012-06-01 13:17:39 -0400] fish_: ossar: knife node show -a foo.bar.baz?
[2012-06-01 13:18:38 -0400] ossar: wow, that was obvious. Have been searching the interwebs for a while, was dead certain you had to use ":" notations. Thanks!
[2012-06-01 13:18:55 -0400] fish_: np
[2012-06-01 13:19:24 -0400] ossar: wierd though, the result is output with : notation but I have to search with .
[2012-06-01 13:26:44 -0400] ossar: is there a way to get a delta from the database since a specified point in time?
[2012-06-01 14:05:17 -0400] chef_newb: okay, please forgive the dumb question, but if I add put include_recipe 'xyz' in my own recipe, shouldn't it just work?   Am I supposed to do something else?  I get lots of errors.
[2012-06-01 14:05:38 -0400] chef_newb: (for instance: FATAL: Chef::Exceptions::Package: package[update-notifier-common] (apt::default line 36) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for update-notifier-common)
[2012-06-01 14:05:49 -0400] chef_newb: (that's a pretty common example.)
[2012-06-01 14:20:45 -0400] laurent\: chef_newb: yep, you need to change the depends field in the metadata : http://wiki.opscode.com/display/chef/Metadata
[2012-06-01 14:27:45 -0400] chef_newb: laurent: even if I'm using chef solo?  that page says it's for Chef Server
[2012-06-01 14:28:29 -0400] chef_newb: I mean laurent\
[2012-06-01 14:30:15 -0400] laurent\: oh ojk
[2012-06-01 14:30:16 -0400] laurent\: ok
[2012-06-01 14:30:22 -0400] chef_newb: laurent\ if I understand correctly, you mean I need my own recipe to say that it depends on the other recipe
[2012-06-01 14:31:09 -0400] laurent\: no no it should be ok with chef-solo, as long as the cookbook is in the cookbook_path
[2012-06-01 14:31:46 -0400] laurent\: but the fatal error you cited just means the package resource is not able to install update-notifier-common
[2012-06-01 14:31:54 -0400] laurent\: doesn't like a chef issue
[2012-06-01 14:32:05 -0400] laurent\: doesn't look like a chef issue
[2012-06-01 14:32:49 -0400] chef_newb: laurent\ what sort of issue could it be then?  I've seen that error for lots of cookbooks the latest was 'zend', which I tried because I hoped it would package together a lot of the things I was unable to get working otherwise
[2012-06-01 14:34:47 -0400] laurent\: chef_newb: what's the result of "apt-cache policy update-notifier-common" on that node ?
[2012-06-01 14:39:44 -0400] chef_newb: I'll check...
[2012-06-01 14:40:33 -0400] chef_newb: apt-cache: command not found
[2012-06-01 14:40:44 -0400] chef_newb: do you mean apt-get cache policy update-notifier-common?
[2012-06-01 14:40:47 -0400] chef_newb: or something like that?
[2012-06-01 14:41:03 -0400] chef_newb: WHOOPS!
[2012-06-01 14:41:19 -0400] chef_newb: it's CentOS of course apt-* won't be installed
[2012-06-01 14:41:35 -0400] chef_newb: sorry laurent\  do you know the yum equivalent?
[2012-06-01 14:42:22 -0400] chef_newb: laurent\ : or is it likely that the recipe only works with Debian-based distress?
[2012-06-01 14:53:46 -0400] dwhsix: qurve: you around? followup Q to yesterday's discussion...
[2012-06-01 14:59:03 -0400] CharlieSu: Hi.  I'm using the Omnibus installer, but it looks like my newly bootstrapped instanced are using chef 0.10.10.  I'd like to use 0.10.8 instead because of some of the reported problems I've heard about w/ 0.10.10.  Is there anyway to do this?
[2012-06-01 14:59:58 -0400] zts: chef_newb: the apt::default recipe only makes sense on apt-based system
[2012-06-01 15:02:00 -0400] chef_newb: zts so basically whoever wrote zend only wrote it for Debian/Ubuntu?
[2012-06-01 15:02:07 -0400] zeroXten: are all files in cookbook/attributes/* processed or only when that particular recipe.rb is used?
[2012-06-01 15:02:10 -0400] chef_newb: that is, wrote the zend cookbook
[2012-06-01 15:04:42 -0400] zts: chef_newb: presumably.  if it's this one - http://community.opscode.com/cookbooks/zend - then it does only claim to support ubuntu
[2012-06-01 15:05:11 -0400] sabooky: If I have two remote_file calls that download into a temp dir.. and I have a directory that creats said tmp dir
[2012-06-01 15:05:18 -0400] sabooky: how do I ensure that they all get run in proper order?
[2012-06-01 15:05:27 -0400] sabooky: basically the dir exists first, then download files to it
[2012-06-01 15:06:13 -0400] zts: chef_newb: while a good number of cookbooks on the community site will work across ubuntu and centos, many only have support for one or the other (more commonly ubuntu)
[2012-06-01 15:06:57 -0400] zts: chef_newb: unfortunately, you'll need to treat them as a starting point for your own work, rather than things that work out of the box
[2012-06-01 15:06:59 -0400] chef_newb: zts yeah, I prefer Ubuntu and would chose it in a heartbeat but CentOS is our "corporate standard" :p
[2012-06-01 15:07:49 -0400] zts: chef_newb: :) I hear ya
[2012-06-01 15:08:39 -0400] chef_newb: I'm baffled as to why/how companies choose Red Hat I'm doubtful that it has any advantages
[2012-06-01 15:08:53 -0400] chef_newb: zts  technical advantages at least
[2012-06-01 15:09:17 -0400] sabooky: chef_newb: main advantage of redhat is having someone to "sue"
[2012-06-01 15:09:22 -0400] chef_newb: maybe having the possibility of service from Red Hat the company gives them warm fuzzies
[2012-06-01 15:09:26 -0400] chef_newb: YES!
[2012-06-01 15:09:29 -0400] zts: chef_newb: there are things I dislike about CentOS, and things I dislike about Ubuntu.
[2012-06-01 15:09:34 -0400] chef_newb: Like they're really going to successfully sue them
[2012-06-01 15:10:01 -0400] sabooky: to be fair... their support isn't bad
[2012-06-01 15:10:05 -0400] chef_newb: the new UI is the only thing I dislike about Ubuntu, but since I mostly use it as a server and use OS X for my desktop, that doesn't bug me much
[2012-06-01 15:10:19 -0400] sabooky: we had them backport a kernel fix for virtualization timing from fedora to redhat kernel
[2012-06-01 15:10:39 -0400] sabooky: they even gave us a temporary kernel that was fixed before it went public
[2012-06-01 15:10:47 -0400] sabooky: so they do support their clients
[2012-06-01 15:10:49 -0400] chef_newb: sabooky: but you wouldn't have needed them to do that in the first place if you had just used fedora
[2012-06-01 15:11:01 -0400] sabooky: true
[2012-06-01 15:11:11 -0400] chef_newb: sabooky but I guess that's good to know anyway
[2012-06-01 15:11:17 -0400] chef_newb: did they charge you for this?
[2012-06-01 15:11:41 -0400] sabooky: chef_newb: btw I don't have a strong opinion for redhat.. I just wondered the same thing in the past at work..
[2012-06-01 15:11:57 -0400] sabooky: chef_newb: nah.. the company I was working at at the time was giving them a ton of money anually anyways..
[2012-06-01 15:12:31 -0400] sabooky: it was all part of "support" or whatever
[2012-06-01 15:14:47 -0400] zts: Anyway, to bring this back on topic, Chef is a nice layer for abstracting out the differences - but cookbooks come from the community, and people (quite rightly) solve the problems they have
[2012-06-01 15:15:20 -0400] sabooky: anyone read my question yet? (regarding execution order)
[2012-06-01 15:15:22 -0400] zts: If you do need to add support for a different platform to some cookbook, it's good to submit your changes back to the original author to help improve things for the next person
[2012-06-01 15:15:24 -0400] chef_newb: zts yes, although I think opscode could really accelerate adoption if they would improve the community-contributed cookbooks
[2012-06-01 15:15:51 -0400] chef_newb: it would presumably be cakewalk for them, since they have people who know Chef inside and out
[2012-06-01 15:15:56 -0400] paulmooring:  sabooky I wasn't in here when you asked, mind asking again?
[2012-06-01 15:16:03 -0400] chef_newb: and make for MUCH happier users
[2012-06-01 15:16:04 -0400] zts: sabooky: sorry, I missed that - the run in the order they are found in the recipe
[2012-06-01 15:16:04 -0400] bencaron: chef_newb ; zts I've pimped a bit the zend cookbook for our use, if you are interested
[2012-06-01 15:16:11 -0400] zts: sabooky: so put the directory resource first, followed by the remote_files
[2012-06-01 15:16:11 -0400] sabooky: If I have two remote_file calls that download into a temp dir.. and I have a directory that creats said tmp dir
[2012-06-01 15:16:16 -0400] sabooky: how do I ensure that they all get run in proper order?
[2012-06-01 15:16:19 -0400] spox: sabooky: you can use #subscribes and/or #notifies
[2012-06-01 15:16:20 -0400] bencaron: in fact, i've re-wrote it, just inspired by the community one
[2012-06-01 15:16:20 -0400] sabooky: basically the dir exists first, then download files to it
[2012-06-01 15:16:25 -0400] zts: chef_newb: they may be experts, but I'm sure they also have plenty of other things to do :)
[2012-06-01 15:16:40 -0400] bencaron: I've add registration of the "licensed" version
[2012-06-01 15:16:46 -0400] zts: chef_newb: but I agree with you, on the value of a large collection of good, cross-platform cookbooks
[2012-06-01 15:16:50 -0400] bencaron: and it works in either ubuntu or rhel
[2012-06-01 15:16:56 -0400] sabooky: zts: does code order == execution order?
[2012-06-01 15:17:02 -0400] paulmooring: sabooky: order is important in Chef, just put the directory resource first in the recipe
[2012-06-01 15:17:18 -0400] chef_newb: bancaron YES I'm interested
[2012-06-01 15:17:31 -0400] mattray: sabooky: yes
[2012-06-01 15:17:33 -0400] sabooky: spox: would multiple notifies be a bad thing?
[2012-06-01 15:17:52 -0400] mattray: sabooky: code order == execution order
[2012-06-01 15:17:56 -0400] sabooky: hmm.. maybe I did something wrong with the include_recipe's
[2012-06-01 15:18:12 -0400] spox: sabooky: likely just use subscribe from the other resources. but yeah, the ordering will be enough.
[2012-06-01 15:18:28 -0400] sabooky: since it definitly was running things in the wrong order, but they are spread across 2-3 recipe's so it might be the recipe themselves that are being run in the wrong order
[2012-06-01 15:18:37 -0400] paulmooring: sabooky: notifies is generally used for things like restart a service after updating a config, putting the dir first in the recipe is simpler
[2012-06-01 15:18:55 -0400] sabooky: so, when does one want to use notifies
[2012-06-01 15:19:11 -0400] zts: sabooky: ah yeah, if you notify :immediately then it will jump to that before moving onto the next resource
[2012-06-01 15:19:11 -0400] paulmooring: sabooky: services are the most common use case
[2012-06-01 15:19:13 -0400] sabooky: paulmooring: hmm.. is it because you might restart a service multiple times? (I mean why not just add it after)
[2012-06-01 15:19:43 -0400] paulmooring: sabooky: it's because resources are idempotent so if you need to restart a service that already exists notifies will still do it
[2012-06-01 15:19:50 -0400] chef_newb: bencaron do you have it posted somewhere?
[2012-06-01 15:20:12 -0400] paulmooring: whereas putting action :restart in the service resource would *always* restart the service even if the template didn't change
[2012-06-01 15:20:15 -0400] bencaron: ATM, it's "internal use"
[2012-06-01 15:20:35 -0400] sabooky: paulmooring: ah, thanks! been wondernig that one for a while now. perfect explanation
[2012-06-01 15:20:38 -0400] bencaron: but I'm sure I can get the OK to open it
[2012-06-01 15:20:44 -0400] bencaron: need it ASAP?
[2012-06-01 15:20:53 -0400] bencaron: I'm just starting to introduce chef here
[2012-06-01 15:20:59 -0400] chef_newb: bencaron: can you e-mail it to me?
[2012-06-01 15:21:13 -0400] bencaron: so the concept of opensourcing part of infra stuff is new
[2012-06-01 15:21:14 -0400] chef_newb: bencaron yes please
[2012-06-01 15:21:34 -0400] bencaron: email, yep, I guess I can do that
[2012-06-01 15:21:49 -0400] bencaron: you really want to post your email here tho?
[2012-06-01 15:22:30 -0400] chef_newb: bencaron I just sent you a private message (if I understand how this works)
[2012-06-01 15:22:49 -0400] bencaron: hehe. I just noticed it chef_newb
[2012-06-01 15:25:55 -0400] rgsteele: So, I've been trying to track down why my disposition is always "NOT ANSWERED" for inbound calls, even when I'm answering them myself.  This morning, I set 'unanswered = no' into cdr.conf, and it started filling in some of the missing CDR variables.  It seems to me that it's trying to detect whether it's answered too soon.  Is there any way to delay that check?  Is ForkCDR relevant here?
[2012-06-01 15:27:46 -0400] rgsteele: (Again, somehow the disposition logged to Master.csv and postgres via cdr_pgsql reports "ANSWERED" as the disposition, it's only 'core show channel <chan>' that reports "NO ANSWER" via the Asterisk CLI)
[2012-06-01 15:28:43 -0400] dyer: rgsteele, I think u have the wrong channel
[2012-06-01 15:28:54 -0400] rgsteele: dyer: D'oh!
[2012-06-01 15:29:01 -0400] rgsteele: Sorry :-/
[2012-06-01 15:29:08 -0400] mjreed: getting this any time I try to run our base users recipe in  10.10 on ubuntu 10.04: NameError: Cannot find a resource for set_owner on ubuntu version 10.04
[2012-06-01 15:29:13 -0400] dyer: but if you are using Asterisk you should be using Adhearsion ;)
[2012-06-01 15:29:19 -0400] mjreed: the indicated line number is just a plain "user" resource
[2012-06-01 15:29:46 -0400] dyer: Is there an easy way to set the cookbook version constraints for an environment to the latest of each cookbook ?  For example if I create a prod environment I want the current version of each cookbook to be locked to what I have deployed at that time
[2012-06-01 15:29:53 -0400] laurent\: 25292 root      20   0 2593m 1.7g  100 D  4.3 83.5   0:50.86 chef-client
[2012-06-01 15:30:16 -0400] mjreed: dyer - that's the default if the cookbook is not mentioned in cookbook_versions
[2012-06-01 15:30:22 -0400] mjreed: you always get the highest version number
[2012-06-01 15:30:51 -0400] rgsteele: dyer: It's all Ruby though - mostly a Python shop here (aside from Chef-related things)
[2012-06-01 15:30:53 -0400] dyer: yes, but I plan to continue development and I don't want to have to worry about this env getting those newer cookbooks
[2012-06-01 15:31:13 -0400] mjreed: so pin them to the current version..
[2012-06-01 15:31:32 -0400] dyer: yes, thats manual, I have almost a 100 cookbooks
[2012-06-01 15:31:42 -0400] dyer: I was wondering if there was a way to do that automagically
[2012-06-01 15:32:32 -0400] mjreed: well, I wrote a knife plugin that does it.
[2012-06-01 15:32:35 -0400] mjreed: but out of the box, I don't think so.
[2012-06-01 15:32:42 -0400] dyer: May I see the plugin ?
[2012-06-01 15:32:45 -0400] dyer: Sounds interesting
[2012-06-01 15:33:16 -0400] jtimberman: chef_newb: Improving which community contributed cookbooks? the ones on the Chef Community site, or the ones that we maintain ourselves?
[2012-06-01 15:35:09 -0400] zts: dyer: it only works on a cookbook at a time, but "knife spork remote" might be useful to you too - https://github.com/jonlives/knife-spork
[2012-06-01 15:35:15 -0400] zts: uh, "knife spork promote"
[2012-06-01 15:35:35 -0400] mjreed: I would love to share the code, however I'm waiting on my corporate overlords to sign the CCLA.  it's very frustrating.
[2012-06-01 15:36:11 -0400] mjreed: but if you loop over the cookbooks and grab version '_latest' using rest.get_rest, that's the latest version,  and thea ctual version number is in the "version" attr of the cookbook object you get back.
[2012-06-01 15:36:37 -0400] mjreed: so you can then add that to the cookbook_versions attr of the environment object, and then save the environment.
[2012-06-01 15:36:47 -0400] jtimberman: mjreed: The CCLA / CLA is only required if you want to contribute to Opscode's projects. If you want to share your cookbooks on the community site, or GitHub, you don't need it.
[2012-06-01 15:37:30 -0400] jtimberman: or, s/cookbooks/plugins, code, etc./
[2012-06-01 15:39:50 -0400] mjreed: jtimberman: ah.  that's useful. thanks!
[2012-06-01 15:39:57 -0400] mjreed: Also, any thoughts on the above ubuntu resource issue?
[2012-06-01 15:40:16 -0400] mjreed: I seem to recall seeing something about LWRPs and names and underscores vs hyphens around the 10.8/10.10 releases...
[2012-06-01 15:40:24 -0400] mjreed: not sure if that's related.
[2012-06-01 15:40:30 -0400] mjreed: but odd that it suddenly can't find a resoruce
[2012-06-01 15:41:57 -0400] eamelink: I'm using the most recent version of the apache2 cookbook from the community site, and when I follow the examples for the 'web_app' resource, it doesn't work. It appears that parameters are passed as symbols to the template, but in the template, they are accessed as strings. For example, the web_app.conf.erb has the line 'ServerName <%= @params['server_name'] %>' which doesnt work, but it does work if I change it to 'ServerName <%= @params[:server_name]
[2012-06-01 15:41:57 -0400] eamelink:  %>'
[2012-06-01 15:42:27 -0400] eamelink: I'm not that into Ruby yet, any clues what could be the case here? Am I doing something wrong, is this changed behaviour in Chef or in the cookbook?
[2012-06-01 15:43:22 -0400] jtimberman: eamelink: thats a nuance of how the definition passes "params"
[2012-06-01 15:43:34 -0400] bencaron: eamelink: there is a bug report already of this
[2012-06-01 15:43:45 -0400] jtimberman: eamelink: in ruby, hashes can have keys that are symbols or strings, and they're not the same thing.
[2012-06-01 15:44:06 -0400] jtimberman: myhash["this"] and myhash[:this] are different keys
[2012-06-01 15:44:25 -0400] jtimberman: mjreed: nothing offhand, i wasn't following that conversation above :)
[2012-06-01 15:44:47 -0400] jtimberman: mjreed: i don't think anything changed with regard to naming for lwrps, you shouldn't have names that have dashes.
[2012-06-01 15:45:02 -0400] jtimberman: since they're translated to methods and you can't have a dash in a ruby method name.
[2012-06-01 15:51:35 -0400] mjreed: jtimberman: but there seem to be cookbooks with hyphens in their name that provide LWRPs
[2012-06-01 15:51:42 -0400] mjreed: and the first componeont of an LWRP name is the cookbook name
[2012-06-01 15:51:43 -0400] mjreed: so...
[2012-06-01 15:54:17 -0400] Dave_S__: hello - anyone around?  i've got a weird problem with stale data (possibly?) and i'm not sure how to fix it
[2012-06-01 15:54:39 -0400] pwf: sivy: that worked, fyi
[2012-06-01 15:54:43 -0400] pwf: (12 hours later)
[2012-06-01 15:55:09 -0400] sivy: pwf: Ha! awesome. Yeah, I added the step to my fabfile and I've been rolling as well
[2012-06-01 15:55:31 -0400] Dave_S__: basically if i do knife node show foo it shows the FQDN as empty, but in ohai on the node it picks it up fine.  the missing fqdn attribute is throwing off some of my templates which expect that
[2012-06-01 15:55:55 -0400] chef_newb: jtimberman: I could be mistaken, but I think the ones I've had problems with are all part of the opscode git repo
[2012-06-01 15:56:29 -0400] chef_newb: (jtimberman sorry to take so long to answer your question: I was working on a different Desktop and didn't see your message)
[2012-06-01 16:05:05 -0400] paulmooring: Dave_S__:  what do you get if you run `hostname -f` on the node?
[2012-06-01 16:05:30 -0400] Dave_S__: it spits out the hostname
[2012-06-01 16:05:53 -0400] Dave_S__: this is an EC2 node, so it's the internal junk - i haven't changed it or anything
[2012-06-01 16:06:03 -0400] Dave_S__: ip-a-b-c-d.ec2.internal
[2012-06-01 16:06:24 -0400] paulmooring: and you said ohai does return something?
[2012-06-01 16:06:48 -0400] paulmooring: like `ohai |grep "fqdn"`
[2012-06-01 16:06:51 -0400] Dave_S__: yeah, ohai | grep -i fqdn gives me back the same thing as hostname -f
[2012-06-01 16:07:48 -0400] Dave_S__: in my template i'm calling it as "node.fqdn" not "node[:fqdn]", if that matters
[2012-06-01 16:08:04 -0400] juliancdunn: hey all, I'm trying to migrate some systems to Opscode's chef-client cookbook
[2012-06-01 16:08:13 -0400] juliancdunn: but the generated client.rb has this line: "log_location     #<IO:0x2b5430dd1ad0>"
[2012-06-01 16:08:17 -0400] juliancdunn: why is that?
[2012-06-01 16:09:04 -0400] paulmooring: Dave_S__:  I think the `node["fqdn"]` is the preferred way let me try the method and see if it works for me
[2012-06-01 16:09:09 -0400] Dave_S__: paulmooring: the *really* weird thing is that shef --client, in recipe mode, prints node.fqdn.  but if i just straight up run chef-client, it explodes
[2012-06-01 16:09:13 -0400] eamelink: jtimberman: Thanks for the symbols vs strings & apache cookbook bug clarification :)
[2012-06-01 16:09:56 -0400] paulmooring: Dave_S__:  I think both should work
[2012-06-01 16:11:03 -0400] Dave_S__: paulmooring: yeah it works on my other nodes - the only thing i can see as different is that knife node show <nodename> on this one doesn't have fqdn - i'm doing a chef-server setup, is it possible the server has stale data for the node somehow?
[2012-06-01 16:11:49 -0400] paulmooring: It's possible that for whatever reason the client can't update the server
[2012-06-01 16:12:11 -0400] paulmooring: if you run `chef-client -l debug -L /tmp/cheflog.txt` on the problem node you can get a debug log
[2012-06-01 16:12:25 -0400] paulmooring: that will let us know if it can't update the server
[2012-06-01 16:12:37 -0400] Dave_S__: ah yes that is a lot of output :)
[2012-06-01 16:14:23 -0400] paulmooring: indeed it is, if you don't mind putting it in a gist I'll take a look
[2012-06-01 16:14:49 -0400] Dave_S__: sure, give me just a sec
[2012-06-01 16:19:54 -0400] cooper: hello all. anybody ever get this "TypeError: can't convert nil into String" when running chef-client in debug on RHEL6?
[2012-06-01 16:19:55 -0400] cooper: DEBUG: Plugin ruby threw exception #<TypeError: can't convert nil into String> /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/ohai-0.6.12/lib/ohai/plugins/ruby.rb:70:in `join'
[2012-06-01 16:20:09 -0400] cooper: doesn't seem to hurt anything but wondering why it's happening
[2012-06-01 16:23:55 -0400] jtimberman: chef_newb: its okay, i run irc in tmux and disconnect often :)
[2012-06-01 16:24:45 -0400] jtimberman: chef_newb: the github.com/opscode/cookbooks repo is deprecated in favor of github.com/opscode-cookbooks (github organization) where each cookbook is a separate repository.
[2012-06-01 16:24:49 -0400] jtimberman: as an fyi.
[2012-06-01 16:25:06 -0400] chef_newb: jtimberman : ahhh  I love tmux, but I'm now working at a mostly Windows shop :p  I smuggle my own MacBook Air in to get work done
[2012-06-01 16:25:10 -0400] pwf: knife bootstrap doesn't seem to be applying the default attributes for the role i gave it
[2012-06-01 16:25:13 -0400] pwf: is it supposed it?
[2012-06-01 16:25:18 -0400] pwf: or does it just use the run_list
[2012-06-01 16:25:24 -0400] jtimberman: and we do work to improve platform support across our cookbooks, but there's a level of work required to ensure that adding a new platform doesn't break existing platforms.
[2012-06-01 16:26:04 -0400] jtimberman: and some platforms added we simply don't test and trust that people of tthose platforms will help fix issues (such as freebsd or gentoo)
[2012-06-01 16:26:22 -0400] jtimberman: we have more information about our cookbook support here: http://wiki.opscode.com/display/chef/Cookbook+Support
[2012-06-01 16:26:25 -0400] jtimberman: :)
[2012-06-01 16:26:33 -0400] chef_newb: jtimberman:  wow that's good to know did that happen recently, or am I somehow living in the dark ages (due to reading old documentation or blog posts?)
[2012-06-01 16:26:51 -0400] c_t: relatively recently
[2012-06-01 16:26:57 -0400] c_t: couple months or so maybe?
[2012-06-01 16:27:10 -0400] chef_newb: okay, that would explain a lot of my problems :/
[2012-06-01 16:28:11 -0400] chef_newb: thanks jtimberman if you're still there!
[2012-06-01 16:28:17 -0400] chef_newb: (and thanks c_t too!)
[2012-06-01 16:34:06 -0400] Dave_S__: paulmooring: thanks again for your help via PM
[2012-06-01 16:34:25 -0400] pwf: when would i use a normal/set attribute over an override? should i prefer one over the other?
[2012-06-01 16:34:44 -0400] pwf: the attributes article on the wiki doesn't have much detail on the former
[2012-06-01 16:35:00 -0400] paulmooring: pwf: usually stick with normal unless you're sure this is the final value
[2012-06-01 16:35:22 -0400] pwf: ah, ok
[2012-06-01 16:35:31 -0400] paulmooring: for example if a role required it's always set to "/var/www" but it might be set in the node, set over ride in the role
[2012-06-01 16:35:35 -0400] pwf: the article made it look like normal had some side-effects, so i was going to go with override
[2012-06-01 16:35:40 -0400] paulmooring: to get around precedence issues
[2012-06-01 16:39:34 -0400] jtimberman: chef_newb: we do recommend that people get our cookbooks from the Community Site rather than consuming the GitHub repositories directly.
[2012-06-01 16:39:58 -0400] jtimberman: just like you get your rubygems from rubygems.org, not from a gem's github repo :)
[2012-06-01 16:40:06 -0400] chef_newb: just download them manually?
[2012-06-01 16:40:13 -0400] jtimberman: knife cookbook site download
[2012-06-01 16:40:20 -0400] chef_newb: actually I'm using Librarian-Chef
[2012-06-01 16:40:36 -0400] chef_newb: so I'm not actually sure where it's getting them
[2012-06-01 16:40:38 -0400] chef_newb: from
[2012-06-01 16:41:03 -0400] jtimberman: ah, stick the line in your Cheffile, cookbook "thing"
[2012-06-01 16:41:05 -0400] chef_newb: and I may have installed it before the change to the new repo, if that changes anything
[2012-06-01 16:41:15 -0400] jtimberman: that will get it from the community site.
[2012-06-01 16:41:20 -0400] chef_newb: yeah, I have (e.g.) cookbook 'zend'
[2012-06-01 16:41:26 -0400] chef_newb: ok
[2012-06-01 16:41:44 -0400] chef_newb: good
[2012-06-01 16:44:33 -0400] yfeldblum: if the top line of your Cheffile is `site "http://community.opscode.com/api/v1"`, then by default you're getting cookbooks from the opscode community site
[2012-06-01 16:45:11 -0400] yfeldblum: the generated Cheffile has that line, as do the sample Cheffiles in the readme on github
[2012-06-01 16:53:03 -0400] jperry2: hey guys, I have this weird thing going on with attributes
[2012-06-01 16:53:08 -0400] jperry2: I have this in our attributes file:
[2012-06-01 16:53:10 -0400] jperry2: "default[:postfix][:mydomain]   = node.has_key?(:datacenter) ? node[:datacenter][:domain] : node.domain"
[2012-06-01 16:53:21 -0400] jperry2: this returns false on a client
[2012-06-01 16:53:40 -0400] jperry2: but if I go on  to the client and run with "shef" with the same client.rb it returns true
[2012-06-01 16:53:46 -0400] jperry2: any ideas?
[2012-06-01 16:54:01 -0400] jperry2: yfeldblum?
[2012-06-01 16:54:02 -0400] bawt: yfeldblum is the author of librarian-chef, a "bundler" for cookbooks
[2012-06-01 16:54:45 -0400] mjreed: so in ruby 1.9,  for some reason, some_method(other_method arg do code; end)  doesn't work.  has to be some_method(other_method(arg) do code; end)..
[2012-06-01 16:56:22 -0400] mjreed: also, since the omnibus-installed chef uses its own private ruby interpreter, if we actually want a script to run with access to all the chef goodness, is there a config parameter somewhere containing that ruby path?
[2012-06-01 16:56:40 -0400] yfeldblum: jperry2, where are the keys "datacenter" and "domain" set?
[2012-06-01 16:57:50 -0400] jperry2: in the environment
[2012-06-01 16:58:58 -0400] jperry2: I tried on the role too and I get the same result
[2012-06-01 16:59:19 -0400] yfeldblum: jperry2, gotcha ... so as a reminder, attributes files should typically never assume attributes exist or are set, except the default ones provided by ohai
[2012-06-01 16:59:41 -0400] yfeldblum: jperry2, if you do need to set a default based on attributes that may be set by an environment or role, you should do so in the recipe, rather than in an attributes file
[2012-06-01 17:00:18 -0400] yfeldblum: jperry2, so for example you can set different defaults in an attributes file based on platform and platform-version, but you should not do so based on environment or role attributes
[2012-06-01 17:00:26 -0400] yfeldblum: jperry2, because exactly these kinds of problems can arise
[2012-06-01 17:00:39 -0400] jperry2: I see, but why isn't it resolving?
[2012-06-01 17:00:43 -0400] yfeldblum: jperry2, much better to set defaults, based on environment or role attributes, in the recipe
[2012-06-01 17:01:22 -0400] jtimberman: jeremyb: do that in a recipe.
[2012-06-01 17:01:30 -0400] jtimberman: er
[2012-06-01 17:01:32 -0400] jtimberman: jperry2: ^ :)
[2012-06-01 17:01:36 -0400] yfeldblum: jperry2, because the order in which attributes from cookbook attributes files are loaded vs attributes from environments/roles isn't guaranteed
[2012-06-01 17:01:57 -0400] jperry2: ah
[2012-06-01 17:02:06 -0400] jperry2: got it
[2012-06-01 17:02:08 -0400] yfeldblum: jperry2, as you can see, in chef-client, the cookbook attributes file is loaded before the environment attributes, but in shef, the reverse seems to be happening (or at least a similar effect)
[2012-06-01 17:02:21 -0400] jperry2: got it
[2012-06-01 17:02:22 -0400] jperry2: thanks
[2012-06-01 17:02:30 -0400] jperry2: good to know
[2012-06-01 17:04:01 -0400] yfeldblum: everything in the cookbook attributes files should be static defaults, not computed defaults (except for computations based on e.g. platform & platform version)
[2012-06-01 17:04:16 -0400] yfeldblum: that way variations in load order don't bite you
[2012-06-01 17:11:57 -0400] jperry2: yfeldblum: thank you
[2012-06-01 17:12:12 -0400] yfeldblum: sure
[2012-06-01 17:12:39 -0400] jperry2: yfeldblum if you are using node.name
[2012-06-01 17:12:44 -0400] jperry2: where would that fall under
[2012-06-01 17:12:57 -0400] jperry2: can that go in the attributes file or used in the recipe?
[2012-06-01 17:13:21 -0400] yfeldblum: `node.name` is one of those that should be safe to use in an attributes file
[2012-06-01 17:13:23 -0400] jperry2: or that is set from the beginning
[2012-06-01 17:13:28 -0400] jperry2: okay
[2012-06-01 17:13:38 -0400] yfeldblum: since it comes from the chef-server-api
[2012-06-01 17:13:54 -0400] yfeldblum: likewise, anything ohai sets
[2012-06-01 17:14:25 -0400] yfeldblum: for example, you can compute default attributes based on looping through the network interfaces that ohai tells you about
[2012-06-01 17:14:55 -0400] yfeldblum: ohai sets platform & platform version, for the curious
[2012-06-01 17:15:24 -0400] jtimberman: Chef itself doesn't really work if platform and platform_version aren't detected properly, so those are totally sane to using in attributes files.
[2012-06-01 17:16:42 -0400] jperry2: what about in a default recipe can you set "default" attributes or you can only use node.set['some_attribute'] = value
[2012-06-01 17:17:20 -0400] jtimberman: jperry2: 'default' is a method on the node object.
[2012-06-01 17:17:43 -0400] jperry2: so I can use override as well right?
[2012-06-01 17:17:45 -0400] yfeldblum: ypically, you should only set default-level attributes in the attributes files, because that's the place for setting default-level attributes
[2012-06-01 17:17:47 -0400] jtimberman: jperry2: in a cookbook's attributes file, it is in the context of the Chef::Node object,
[2012-06-01 17:17:56 -0400] mjreed: avoid override attributes..
[2012-06-01 17:18:01 -0400] jtimberman: so you can use node.default, node.set, node.override in both attributes and recipes
[2012-06-01 17:18:05 -0400] jtimberman: attributes files.
[2012-06-01 17:18:14 -0400] jperry2: I see what is recommended in a recipe
[2012-06-01 17:18:21 -0400] jtimberman: *generally*
[2012-06-01 17:18:22 -0400] yfeldblum: jperry2, environments and roles are good places for override-level attributes
[2012-06-01 17:18:26 -0400] mjreed: is shef going to start noticing role attributes any time soon?
[2012-06-01 17:18:43 -0400] jtimberman: use "default" in attributes files. use "set" (or "normal") in recipes. use "override" in roles.
[2012-06-01 17:18:44 -0400] jperry2: so in my recipe I should do set['some_attribute'] = value?
[2012-06-01 17:18:58 -0400] jperry2: I don't need to specify node.set as set works as well right?
[2012-06-01 17:19:47 -0400] jtimberman: node.set['thing']
[2012-06-01 17:19:54 -0400] jtimberman: in the recipe you have to call the method on the node object.
[2012-06-01 17:19:56 -0400] jperry2: okay so I do need to use "node"
[2012-06-01 17:19:58 -0400] jperry2: got it
[2012-06-01 17:19:59 -0400] jperry2: thanks
[2012-06-01 17:20:18 -0400] yfeldblum: jperry2, you should typically not need to use normal-level attributes, because they don't work the same way as default-level, override-level, and automatic/ohai-level attributes
[2012-06-01 17:20:20 -0400] mjreed: node.set in recipes
[2012-06-01 17:20:20 -0400] mjreed: set in attributes files
[2012-06-01 17:20:38 -0400] mjreed: but why are you setting attributes on the node in a recipe?
[2012-06-01 17:21:21 -0400] yfeldblum: jperry2, normal-level attributes are great for sysadmins to use directly via `EDITOR=vim knife node edit $NODE`, but are not great for use from recipes or attributes files
[2012-06-01 17:23:01 -0400] yfeldblum: mjreed, shef isn't really chef-client+debugger
[2012-06-01 17:23:28 -0400] yfeldblum: mjreed, it's more for experimenting with resources
[2012-06-01 17:23:50 -0400] yfeldblum: mjreed, where you declare a resource and declare its attributes, and then shef converges the system around the resource you declared
[2012-06-01 17:27:51 -0400] jtimberman: mjreed: "default" in attributes files.
[2012-06-01 17:28:16 -0400] jtimberman: yfeldblum: shef *should* be a chef-client debugger too though :)
[2012-06-01 17:30:28 -0400] karwash: For those in the Boston area, I'm organizing a meetup... date and location to follow shortly: http://www.meetup.com/Chef-BOSTON/
[2012-06-01 17:33:20 -0400] jtimberman: karwash: Cool!
[2012-06-01 17:35:45 -0400] mjreed: up until 10.2, shef -z worked very well as a chef-client debugger. :\
[2012-06-01 17:36:00 -0400] mjreed: seems like there ought to be a way to just open up chef-client and stick a call to pry in there somewhere, though.
[2012-06-01 17:43:38 -0400] danryan: Hey chefs! Having trouble with the mount resource: https://gist.github.com/1265bcfbe226cce1e3ce
[2012-06-01 17:43:56 -0400] danryan: Looks like for multiple actions, chef just runs through the resource twice, once for each action. Since the first action (mount) mounted the directory, the second action (enable) was skipped because of the only_if seeing it was mounted.
[2012-06-01 17:44:28 -0400] danryan: Do I need the only_if?
[2012-06-01 17:45:51 -0400] jperry2: is there a way to get "shef" to use "pry"?
[2012-06-01 17:46:01 -0400] paulmooring: danryan: you should be fine dropping the only if
[2012-06-01 17:46:17 -0400] paulmooring: unless you specify remount, it won't remount it if it's already mounted
[2012-06-01 17:47:36 -0400] nathenharvey: jperry2:  https://gist.github.com/2225015
[2012-06-01 17:48:18 -0400] pcn: hey chefs, anyone know why 0.10.8 solo doesn't seem to print out where a template failed when I use the runit_service lwrp?
[2012-06-01 17:49:59 -0400] jperry2: nathenharvey: thx
[2012-06-01 17:50:21 -0400] danryan: paulmooring: Cheers. Worked like a charm.
[2012-06-01 18:21:09 -0400] mjreed: so gem_package installs the gem in the embedded ruby install from the omnibus installer.  that seems suboptimal.
[2012-06-01 18:23:05 -0400] matschaffer: mjreed: there's a paragraph in http://wiki.opscode.com/display/chef/Resources that says it picks the first 'gem' on the path
[2012-06-01 18:23:16 -0400] matschaffer: under "Gem Package Options"
[2012-06-01 18:23:52 -0400] matschaffer: looks like you can also specify a gem_binary attribute to have it use a specific gem bin to use
[2012-06-01 18:24:52 -0400] mjreed: sure, I was just surprised that it default to the omnibus.   but that seems to be because there is no other rubygems install on the system.
[2012-06-01 18:25:54 -0400] mjreed: I guess I have to add explicit stuff to our base recipes to install/update ruby and rubygems and all that stuff that pre-omnibus installer was handled just by bootstrapping chef on the system.
[2012-06-01 18:40:19 -0400] mjreed: no method join for Chef::Provider::File.  I thought we'd put that behind us.
[2012-06-01 18:43:17 -0400] mjreed: is there any way to get chef *not* to delete the temporary file constituting the script from a script/exec/bash etc resource?
[2012-06-01 18:51:34 -0400] yfeldblum: mjreed, prefer to use Pathname#join or Pathname#+ instead of ::File.join
[2012-06-01 18:52:33 -0400] yfeldblum: mjreed, why would you want chef to keep it? and why not just add a `file` resource to somewhere in /tmp with the same content as the script/bash resource?
[2012-06-01 18:53:05 -0400] resno: meh, chef you are giving me unmet dependencies!
[2012-06-01 18:56:03 -0400] yfeldblum: resno, ?
[2012-06-01 19:08:58 -0400] KunAguero: is it possible to have knife execute a single recipe against a node? A recipe that is not part of that node's role?
[2012-06-01 19:14:25 -0400] monvillalon: Is there a way to delay a resource after everything has been done? I want to drop some ssh keys but I would like that they don't stay in the server
[2012-06-01 19:15:07 -0400] monvillalon: also, is there a way to get the user chef is running as?
[2012-06-01 19:15:28 -0400] yfeldblum: monvillalon, you can stick some ruby_block blocks before & after some other resource, and the blocks can drop & delete the ssh keys
[2012-06-01 19:16:15 -0400] yfeldblum: KunAguero, not sure what you mean by knife executing recipes; knife does not execute recipes
[2012-06-01 19:16:19 -0400] monvillalon: yfeldblum: I have several repos, and I set up the key in the default.rb of my recipe and have serveral recipes per app , app1.rb, app2.rb
[2012-06-01 19:16:57 -0400] monvillalon: I could delete the ssh keys in the last recipe appN.rb but then it bothers my programmers OCD.. :)
[2012-06-01 19:18:03 -0400] yfeldblum: monvillalon, but why do you need ssh keys?
[2012-06-01 19:18:11 -0400] monvillalon: yfeldblum: for git deployment
[2012-06-01 19:18:22 -0400] yfeldblum: monvillalon, why do you need to delete them?
[2012-06-01 19:18:54 -0400] monvillalon: yfeldblum: not really, just thought it was safer
[2012-06-01 19:19:16 -0400] yfeldblum: monvillalon, in what way?
[2012-06-01 19:19:32 -0400] KunAguero: yfeldblum: not sure if Knife is the correct method here... I just have this one recipe that is not part of the role and want to execute it separately
[2012-06-01 19:19:57 -0400] monvillalon: yfeldblum: well for some reason i had to 777 my key in order to work..
[2012-06-01 19:19:58 -0400] geekbri: paulmooring: is there an open source jira ticket review happening today by any chance?
[2012-06-01 19:20:39 -0400] monvillalon: KunAguero: ypu can use knife bootstrap -r"recipe[RECIPENAME]"
[2012-06-01 19:20:56 -0400] yfeldblum: monvillalon, maybe you need to set the right perms on the key when you drop it?
[2012-06-01 19:21:05 -0400] paulmooring: geekbri: not today but likely on Monday
[2012-06-01 19:21:29 -0400] geekbri: paulmooring: oh ok excellent.  I had a request to fix my patch, and I did but haven't heard back since.  Thats probably why :)
[2012-06-01 19:22:01 -0400] geekbri: on a side note, chef was mentioned by good ole devops borat
[2012-06-01 19:22:04 -0400] geekbri: https://twitter.com/devops_borat/status/208599587362062338
[2012-06-01 19:22:30 -0400] monvillalon: yfeldblum: Yes you are right?, that is why I asked the second question, How do I get the user chef is running as? the things is that locally is vagrant and in ec2 is ec2-user, never root, if I have that I can set 600 to the owner
[2012-06-01 19:22:59 -0400] monvillalon: yfeldblum: *Yes, you are right!* :)
[2012-06-01 19:23:21 -0400] KunAguero: monvillalon: can I execute this against a whole set of servers that belong to a role?
[2012-06-01 19:23:55 -0400] KunAguero: better if I explain... I have a general Apache/PHP recipe that's used to configure the server and setup the virtual host
[2012-06-01 19:24:00 -0400] yfeldblum: monvillalon, you should typically run chef-client as root, possibly using sudo
[2012-06-01 19:24:30 -0400] KunAguero: but now I need a recipe that will execute occasionally for the sole purpose of deploying code to that DocRoot
[2012-06-01 19:24:55 -0400] yfeldblum: monvillalon, because when you use chef-client, the idea is that it owns your system now and sysadmins are quite unwelcome anymore :P
[2012-06-01 19:24:56 -0400] monvillalon: KunAguero: no expert, I think knife doesn't do that, its one a server at time, however you can use knife to query that and then do bootstrap on each of them, if its 2 servers, do it manually, if its 80 write a bash :)
[2012-06-01 19:25:03 -0400] KunAguero: I have the recipe, but I don't want it to be part of the role and be executed inconjunction with the other recipes
[2012-06-01 19:25:40 -0400] yfeldblum: KunAguero, you should write your recipes such that it is OK if they are run repeatedly, even hundreds of times in a row
[2012-06-01 19:25:49 -0400] monvillalon: yfeldblum: its the stupid AMI, Im forced to use, and I don't want to waste my time learning how to create one
[2012-06-01 19:26:25 -0400] KunAguero: yfeldblum: doesn't make sense to deploy code willy nilly
[2012-06-01 19:26:55 -0400] monvillalon: KunAguero: yes that is very un-cheffy!
[2012-06-01 19:27:19 -0400] yfeldblum: KunAguero, you missed the point; your recipe can absolutely check whether the current code is the latest code, and skip the deployment if it's the latest code; the point is, your recipes should take all the steps necessary to ensure that repeatedly running the recipes is safe
[2012-06-01 19:27:25 -0400] KunAguero: i can run the recipes a 1000 times and that's OK for the setup and config... but deploying code sometimes require app restarts, etc... I wouldn't want that done every single time I have to run chef-client
[2012-06-01 19:27:35 -0400] monvillalon: KunAguero: what I'm doing is that I have a branch for deployment, if there is nothing to deploy, the cost is low
[2012-06-01 19:28:06 -0400] monvillalon: KunAguero: you can write a pre test, maybe check git log, before doing the deploy
[2012-06-01 19:28:29 -0400] monvillalon: KunAguero: svn, hg , git ???
[2012-06-01 19:30:09 -0400] KunAguero: I see...
[2012-06-01 19:30:32 -0400] KunAguero: that makes sense... I will look to do that.
[2012-06-01 19:30:40 -0400] monvillalon: KunAguero: what are you using? i can nudge you
[2012-06-01 19:31:11 -0400] monvillalon: KunAguero: are you using source control?
[2012-06-01 19:35:03 -0400] KunAguero: we are using builds stored in S3
[2012-06-01 19:35:38 -0400] KunAguero: there is a 'release' folder... the tarball there is our production release
[2012-06-01 19:36:13 -0400] KunAguero: currently it gets downloaded every time the recipe is run
[2012-06-01 19:36:44 -0400] KunAguero: the assumption being, a) it has the same filename always b) it's meant for production
[2012-06-01 19:36:48 -0400] sanchezt: Wuuuuaaauu, Kun Aguero uses Chef!!!
[2012-06-01 19:36:50 -0400] sanchezt: Jojo
[2012-06-01 19:37:06 -0400] KunAguero: he's a winner on all counts :)
[2012-06-01 19:40:57 -0400] yfeldblum: KunAguero, don't download it every time - instead, get the ETag and compare it to the ETag you've got for the currently deployed release
[2012-06-01 19:43:14 -0400] yfeldblum: KunAguero, if the ETags don't match, then you can perform a deploy and save the new ETag
[2012-06-01 19:56:32 -0400] KunAguero: yfeldblum: so I need to store the ETAG somewhere and keep track of it
[2012-06-01 19:56:45 -0400] yfeldblum: KunAguero, that's right
[2012-06-01 19:56:52 -0400] KunAguero: yfeldblum: I pull the etag with something like "curl -I"
[2012-06-01 19:57:28 -0400] yfeldblum: KunAguero, sure, but, you can also look at doing it from pure ruby with Net::HTTP
[2012-06-01 19:57:51 -0400] KunAguero: and that doesn't download the file? just pulls the header
[2012-06-01 19:57:52 -0400] KunAguero: ?
[2012-06-01 19:59:06 -0400] yfeldblum: KunAguero, yes, you will have to look at the documentation for Net::HTTP to figure out the specific steps, but it should be possible
[2012-06-01 20:00:06 -0400] KunAguero: ok, thanks a lot
[2012-06-01 20:00:10 -0400] dwhsix: hey, what's the structure of a json file for passing in attributes to chef-client -j?  I've seen:
[2012-06-01 20:00:34 -0400] dwhsix: {"default_attributes": {
[2012-06-01 20:00:34 -0400] dwhsix: },
[2012-06-01 20:00:34 -0400] dwhsix: "override_attributes": {
[2012-06-01 20:00:40 -0400] dwhsix: etc
[2012-06-01 20:01:08 -0400] dwhsix: but doc implies attributes should just be at top level, no default_attributes: {}, override_attributes: {}..
[2012-06-01 20:07:21 -0400] matschaffer: dwhsix: I usually just put attributes at the top level
[2012-06-01 20:07:23 -0400] matschaffer: next to run_list
[2012-06-01 20:09:59 -0400] till__: in a custom provider, does anyone have an example how i could write a couple functions so i don't end up with too much duplicate code?
[2012-06-01 20:10:41 -0400] yfeldblum: till__, def my_custom_function(arg1, arg2) ... end
[2012-06-01 20:11:26 -0400] yfeldblum: till__, your lightweight providers are actually just module_exec
[2012-06-01 20:11:35 -0400] till__: so just on top of action :foo ?
[2012-06-01 20:11:42 -0400] till__: i am not sure what a module_exec is :P
[2012-06-01 20:11:52 -0400] yfeldblum: till__, your lightweight providers are actually just module_exec'd on a class created for you that inherits Chef::Providre
[2012-06-01 20:12:01 -0400] till__: ah
[2012-06-01 20:12:10 -0400] yfeldblum: till__, yes, you can define methods at the top level of your lightweight provider
[2012-06-01 20:12:34 -0400] yfeldblum: till__, indeed, doing `action :create do ... end` is just syntax sugar for `def action_create ; ... end`
[2012-06-01 20:13:21 -0400] till__: oh, i see
[2012-06-01 20:13:48 -0400] till__: i am a huge ruby n00b
[2012-06-01 20:16:06 -0400] dwhsix: matschaffer: thanks (and apologies for delay; chocolate cake in office)
[2012-06-01 20:16:35 -0400] dwhsix: so I guess we picked up this format somewhere and it's JUST WRONG
[2012-06-01 20:17:01 -0400] till__: can i call multiple actions on a resource?
[2012-06-01 20:17:09 -0400] matschaffer: dwhsix: I'm wfh today, so not sure that cake is my doing. but I'll accept credit for chocolate cake any time :)
[2012-06-01 20:17:11 -0400] till__: foo do actions :bar, :foobar end ?
[2012-06-01 20:17:21 -0400] yfeldblum: till__, no, there's no such thing as "calling actions on a resource"
[2012-06-01 20:17:25 -0400] matschaffer: oh oh, nm, I read that wrong
[2012-06-01 20:17:40 -0400] dwhsix: matschaffer: np, I knew what yuo meant
[2012-06-01 20:17:55 -0400] till__: yfeldblum: but e.g. package "foo" do action :install end
[2012-06-01 20:17:58 -0400] matschaffer: now I want chocolate cake...
[2012-06-01 20:18:04 -0400] till__: isn't package a 'resource'?
[2012-06-01 20:18:13 -0400] yfeldblum: till__, you can declare multiple actions (read: goals) on a resource, and the provider for that resource will, for each action listed on the resource, call the action method on the provider corresponding to that action on the resource
[2012-06-01 20:18:25 -0400] till__: ok
[2012-06-01 20:21:08 -0400] yfeldblum: till__, e.g. a service resource will often have two actions declared for it, :enable and :start (or goals of :enabled and :started), and the particular provider chosen for that service resource will have two methods called: action_enable and action_start
[2012-06-01 20:36:13 -0400] leifmadsen: hey all, weird thing happening. I seem to be having an issue with connecting to my chef server that I just installed whenever running something like "knife node list" where it returns with an error saying it can't find "http://<url to server>:4000/nodes" -- however everythign else works. Same thing with the chef webui. All tabs work except nodes. Any ideas to start searching?
[2012-06-01 20:41:52 -0400] monvillalon: I need help deploying a git repo, I added a .ssh/id_deploy and added it to .ssh/config with my id, however the console works but not the git resouce
[2012-06-01 20:52:10 -0400] yfeldblum: monvillalon, you need to give the `git` resource (or the `deploy` resource) a value for the `ssh_wrapper` attribute
[2012-06-01 20:52:32 -0400] yfeldblum: monvillalon, see: https://github.com/opscode-cookbooks/application/blob/master/recipes/rails.rb#L80-103 and https://github.com/opscode-cookbooks/application/blob/master/recipes/rails.rb#L165
[2012-06-01 20:52:44 -0400] monvillalon: yfeldblum: thanks
[2012-06-01 21:03:16 -0400] macros: I have a node right now I can reproducibly get to blow up memory use when the exception handler fires
[2012-06-01 21:03:46 -0400] macros: The machine starts to melt down after the chef-client process hits about 4GB of mem
[2012-06-01 21:04:05 -0400] macros: Memory use for a normal run is fine, this is just the exception handler
[2012-06-01 21:04:16 -0400] macros: No user defined report or exception handlers
[2012-06-01 21:04:40 -0400] macros: Machine actually hits oom before I can get an exception message
[2012-06-01 21:04:57 -0400] yfeldblum: macros, which exception handlers?
[2012-06-01 21:05:18 -0400] macros: chef-client, fires during compile phase
[2012-06-01 21:05:39 -0400] macros: No output seen to indicate why from -l debug
[2012-06-01 21:06:19 -0400] till__: yfeldblum: makes sense and thanks again!
[2012-06-01 21:07:12 -0400] yfeldblum: macros, perhaps enable & disable exception handlers to find out which one it is?
[2012-06-01 21:07:44 -0400] macros: This happens on any exception
[2012-06-01 21:08:03 -0400] macros: Inside of a chef-client run, so bust cookbook melt machine
[2012-06-01 21:09:14 -0400] macros: No handlers defined except for defaults
[2012-06-01 21:10:52 -0400] macros: Eventually I do get a stack trace
[2012-06-01 21:11:06 -0400] macros: But it allocates well over 4GB of mem to generate one
[2012-06-01 21:11:06 -0400] yfeldblum: that would be useful
[2012-06-01 21:11:24 -0400] macros: I know why the cookbook is failing, the ipaddr api changed
[2012-06-01 21:11:37 -0400] macros: I want to know why the exception handler is breaking so badly
[2012-06-01 21:12:55 -0400] macros: I've seen this bug quite a bit, no one has given any info on how to pin it down in the slightest
[2012-06-01 21:13:24 -0400] macros: The stack trace is as expected
[2012-06-01 21:14:16 -0400] macros: failed-run-data.json is about 400KB
[2012-06-01 21:14:35 -0400] simonjj: if I wanted to use a provider that's defined in a cookbook other than the current tone, would I use include or require ?
[2012-06-01 21:14:39 -0400] simonjj: or something completely different
[2012-06-01 21:16:06 -0400] macros: Happy to provide details and dig in, but not a clue where to start on this
[2012-06-01 21:17:04 -0400] yfeldblum: simonjj, you should use neither
[2012-06-01 21:17:20 -0400] yfeldblum: simonjj, you should put `depends "other-cookbook-name"` into your cookbook's metadata.rb
[2012-06-01 21:19:39 -0400] yfeldblum: macros, http://www.shopify.com/technology/4321572-most-memory-leaks-are-good
[2012-06-01 21:19:46 -0400] simonjj: ok, that's all that'll be needed
[2012-06-01 21:19:47 -0400] simonjj: cool
[2012-06-01 21:28:02 -0400] hoover_damm: macros, if it's blowing up that fast I doubt you'd ever get the completed stack trace
[2012-06-01 21:29:09 -0400] macros: I have seen the nesting limit on to_json before from the exception handler
[2012-06-01 21:29:21 -0400] macros: Not getting it in this case
[2012-06-01 21:30:05 -0400] hoover_damm: macros, ruby -v
[2012-06-01 21:30:52 -0400] macros: ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]
[2012-06-01 21:31:26 -0400] simonjj: marcos: wow, that old
[2012-06-01 21:31:27 -0400] hoover_damm: macros, can you drop in a omnibus chef deb and run it?
[2012-06-01 21:31:30 -0400] macros: Trying to get a run with ruby-prof, expecting it to blow up even worse
[2012-06-01 21:31:34 -0400] hoover_damm: macros, that's a smelly ruby
[2012-06-01 21:31:39 -0400] hoover_damm: yeah you should stop
[2012-06-01 21:31:39 -0400] JasonBox: lol
[2012-06-01 21:31:41 -0400] macros: hoover_damm: Not without cookbook surgery
[2012-06-01 21:31:50 -0400] macros: The ruby gem mess
[2012-06-01 21:32:01 -0400] hoover_damm: prolly json gem + 249 bug
[2012-06-01 21:32:13 -0400] hoover_damm: 150k allocations add's up /fast/
[2012-06-01 21:32:17 -0400] hoover_damm: ;)
[2012-06-01 21:32:45 -0400] hoover_damm: yajl made json in ruby not bleed horribly
[2012-06-01 21:33:52 -0400] macros: I wonder if rackspace will suspend the vm on me
[2012-06-01 21:34:56 -0400] macros: http://community.opscode.com/questions/63
[2012-06-01 21:36:10 -0400] yfeldblum: that will probably happen if you add the node to the node
[2012-06-01 21:37:06 -0400] yfeldblum: "i heard you like nodes so i put a node in your node so you can splode while you splode"
[2012-06-01 21:37:37 -0400] macros: And chef ate my ruby-prof output
[2012-06-01 21:38:10 -0400] hoover_damm: macros, cpu profiling?
[2012-06-01 21:38:12 -0400] hoover_damm: what do you use?
[2012-06-01 21:38:16 -0400] hoover_damm: or do you?
[2012-06-01 21:39:10 -0400] macros: I think artur uses oprofile for varnish stuff
[2012-06-01 21:39:14 -0400] macros: I mostly just use perf top
[2012-06-01 21:39:30 -0400] mhalligan: in shef if I create an array from search like a = nodes.search "*:*"
[2012-06-01 21:39:31 -0400] mhalligan: then
[2012-06-01 21:39:35 -0400] mhalligan: \\\
[2012-06-01 21:39:38 -0400] hoover_damm: k
[2012-06-01 21:39:40 -0400] mhalligan: wtf. sorry.
[2012-06-01 21:39:53 -0400] macros: yfeldblum: There shouldn't be any cases of adding the node to the node
[2012-06-01 21:40:18 -0400] mhalligan: when I try to iterate over that array  with a.each {|n| puts n} I get the error: ArgumentError: Attribute to_ary is not defined!
[2012-06-01 21:40:18 -0400] mhalligan: any sug
[2012-06-01 21:40:28 -0400] mhalligan: gestions (stupid keyboard)
[2012-06-01 21:41:10 -0400] macros: hoover_damm: More details on the json p249 problem?
[2012-06-01 21:41:27 -0400] yfeldblum: mhalligan, you're probably looking for: `a = search(:nodes, "*:*") ; a.each{|n| puts n}`
[2012-06-01 21:41:52 -0400] yfeldblum: mhalligan, `nodes.search "*:*"` is almost entirely certain not to be what you want
[2012-06-01 21:42:32 -0400] yfeldblum: mhalligan, oh shef ... hmm that may work in shef, who knows
[2012-06-01 21:42:48 -0400] mhalligan: yeah search(:nodes, "*:*") doesn't seem to work in shef
[2012-06-01 21:42:48 -0400] hoover_damm: macros, oh basically the json gem allocates 150k object blocks per json object
[2012-06-01 21:43:06 -0400] hoover_damm: macros, and with certain versions of ruby it made the GC pressure insanely bad
[2012-06-01 21:43:26 -0400] macros: So install yajil and be happy?
[2012-06-01 21:43:29 -0400] hoover_damm: macros, you'll see more often people are disabline GC to fix 1.8.7 bugs because basically :( 1.8.7 makes sad kitties
[2012-06-01 21:43:50 -0400] hoover_damm: going to omnibus is usually my easiest suggestion as you can goto 1.9.2 or 1.9.3 easily
[2012-06-01 21:45:24 -0400] macros: The patch to optionally use yajil never got merged
[2012-06-01 21:47:23 -0400] macros: Doesn't seem like the move the Chef::JSON ever happened either
[2012-06-01 21:48:35 -0400] macros: Hmm, I'm wrong, looks like yajl is there
[2012-06-01 21:51:23 -0400] macros: Oh, it gets used in one place for reading json off disk
[2012-06-01 21:53:38 -0400] mhalligan: can anyone point me at some example scripts for coding against the chef gem to query the api?
[2012-06-01 21:53:49 -0400] mhalligan: my google-fu appears to be weak today
[2012-06-01 21:54:54 -0400] yfeldblum: mhalligan, https://github.com/opscode/chef/tree/master/chef/lib/chef/knife
[2012-06-01 21:55:11 -0400] mhalligan: hrm I guess that makes sense, thanks :)
[2012-06-01 21:55:38 -0400] tjadmin: hoover_damm: Technically speaking, Do you often see this "basically  1.8.7 makes sad kitties"? and instead omnibus ;-)
[2012-06-01 21:57:58 -0400] FreeFries: hi, I have a problem with a chef recipe where I'm getting "Connection refused connecting to .../cookbooks/.../1.0.1/files/<some hash>"
[2012-06-01 21:58:26 -0400] FreeFries: when it hits a template render in a chef recipe
[2012-06-01 21:58:32 -0400] FreeFries: (that error is from the chef-client)
[2012-06-01 21:58:49 -0400] FreeFries: if I curl that path I get a mixlib header missing error
[2012-06-01 21:58:56 -0400] macros: Making the error handler use yajl made the problem go away
[2012-06-01 21:59:23 -0400] miah: hi
[2012-06-01 21:59:23 -0400] FreeFries: if I change the template file I'm trying to render the error sticks around and the hash stays the same
[2012-06-01 21:59:37 -0400] FreeFries: unless I change it to a different template file that already exists
[2012-06-01 21:59:41 -0400] miah: wow its hot downtown. my part of sf is decent. down here it is steamy
[2012-06-01 21:59:57 -0400] FreeFries: (so if I copy the template file/touch a new file it fails, but if I point it at one that's already there it's fine)
[2012-06-01 22:00:23 -0400] FreeFries: any guesses how I'd go about debugging this?
[2012-06-01 22:00:42 -0400] mattray: mhalligan: have you looked at Spice?
[2012-06-01 22:01:09 -0400] mattray: https://github.com/danryan/spice
[2012-06-01 22:01:28 -0400] tjadmin: mattray: Which spice would you suggest to make this thing taste better?
[2012-06-01 22:01:32 -0400] FreeFries: (the specific error is "Mixlib::Authentication::MissingAuthenticationHeader: missing required authentication header(s)"
[2012-06-01 22:03:40 -0400] hoover_damm: tjadmin, There really isn't a valid argument to use 1.8.7 any longer.  It will be end of life next year
[2012-06-01 22:03:47 -0400] yfeldblum: FreeFries, you can't just curl the chef-server-api without signing requests
[2012-06-01 22:04:00 -0400] hoover_damm: tjadmin, I know there's a lot of people trying to keep 1.8.x alive.  I'm just not one of them.
[2012-06-01 22:04:09 -0400] yfeldblum: hoover_damm, tell that to the bajillion people still on winxp?
[2012-06-01 22:04:17 -0400] FreeFries: ah
[2012-06-01 22:04:41 -0400] FreeFries: so that doesn't give me the reason the client is getting a connection refused...thought it might be related
[2012-06-01 22:04:44 -0400] hoover_damm: yfeldblum, eventually a ruby user will rage enough to install rvm
[2012-06-01 22:04:48 -0400] tjadmin: hoover_damm: I was sort of kidding.... and wondering about your sad kitties
[2012-06-01 22:04:59 -0400] hoover_damm: tjadmin, oh my kitties are fluffy...
[2012-06-01 22:05:21 -0400] hoover_damm: they are extra fluffy and showing off today
[2012-06-01 22:05:39 -0400] yfeldblum: hoover_damm, these are the new ruby-1.9.3-p194 kitties?
[2012-06-01 22:05:53 -0400] hoover_damm: no my real cats
[2012-06-01 22:05:53 -0400] tjadmin: I've gotta do that with my guinea pigs.... it's time...
[2012-06-01 22:06:08 -0400] FreeFries: it seems like my chef-server is refusing connections to anything new in files/*
[2012-06-01 22:06:35 -0400] FreeFries: I tried restarting the server, which didn't help
[2012-06-01 22:06:48 -0400] hoover_damm: my cats get a bath every month
[2012-06-01 22:06:51 -0400] hoover_damm: they demand it
[2012-06-01 22:07:02 -0400] hoover_damm: I also walk my cats once or twice a day on a cat walking jacket
[2012-06-01 22:07:17 -0400] mhalligan: mattray: I haven't but am now, thanks!
[2012-06-01 22:07:52 -0400] tjadmin: hoover_damn: Well I'd beter let do you focus on FreeFries....he/she seems to want to get something working.... one track mind.... too hot here to think....
[2012-06-01 22:08:02 -0400] hoover_damm: http://www.catwalkingjacket.com/
[2012-06-01 22:08:23 -0400] hoover_damm: oh i'm waiting on apt... so I can benchmark...
[2012-06-01 22:08:32 -0400] mhalligan: oh so it's another cli?
[2012-06-01 22:08:35 -0400] tjadmin: :-)
[2012-06-01 22:08:43 -0400] hoover_damm: like bundling
[2012-06-01 22:08:49 -0400] hoover_damm: but an older passtime
[2012-06-01 22:08:57 -0400] FreeFries: heh
[2012-06-01 22:09:17 -0400] mhalligan: every time I have to do a system call to a cli out of ruby I feel like I've failed.
[2012-06-01 22:09:58 -0400] yfeldblum: mhalligan, spice is a ruby client library for the chef-server-api
[2012-06-01 22:10:00 -0400] tjadmin: mhalligan: Don't take it personnally..... I'm sure the Chef is just being subversive
[2012-06-01 22:10:13 -0400] FreeFries: I see the request in my server logs...I don't see it failing
[2012-06-01 22:10:33 -0400] yfeldblum: mhalligan, it's probably simpler to use than the chef gem, except in the context of writing a knife plugin when knife has already set up everything for you to use the chef gem against the chef-server-api
[2012-06-01 22:10:54 -0400] tjadmin: knife debug +++
[2012-06-01 22:11:04 -0400] mhalligan: yfeldblum: ? From the sparse documentation I gleam that it is a tool for generating knife commands?
[2012-06-01 22:12:40 -0400] FreeFries: the chef-client stacktrace dump just says connection refused
[2012-06-01 22:13:08 -0400] vegardx: check that you have a valid client on the chef-server.
[2012-06-01 22:13:21 -0400] vegardx: And that your knife.rb has proper configuration
[2012-06-01 22:13:35 -0400] FreeFries: it runs other recipes, and the same recipe with a different template file
[2012-06-01 22:13:37 -0400] vegardx: err, client.rb
[2012-06-01 22:13:56 -0400] vegardx: yeah, but chef stores recipes locally when it have been connected once.
[2012-06-01 22:14:21 -0400] yfeldblum: mhalligan, that's spiceweasel
[2012-06-01 22:14:40 -0400] yfeldblum: mhalligan, spice is a ruby client library for the chef-server-api https://github.com/danryan/spice
[2012-06-01 22:15:53 -0400] FreeFries: vegardx: I can run knife node list from that machine
[2012-06-01 22:15:58 -0400] mhalligan: mattray: err is there any documentaiton on spice? I'm a shell coder slowly learning ruby
[2012-06-01 22:16:22 -0400] yfeldblum: mhalligan, heh ... ruby is your new shell, now :P
[2012-06-01 22:16:32 -0400] FreeFries: so I assume it's a valid client on the server...unless there's some other way for it to go wrong?
[2012-06-01 22:16:52 -0400] mhalligan: yfeldblum: as ridiculously often as I find the need to call knife via IO.popen, yeah, I feel like I might as well just  write this crap in Bash, I'd have been done a month ago :/
[2012-06-01 22:16:57 -0400] vegardx: FreeFries: hm, strange.
[2012-06-01 22:17:33 -0400] vegardx: I have a feeling that there is some differences in your client.rb and knife.rb that could give you a hint.
[2012-06-01 22:18:25 -0400] FreeFries: I did knife node list -c /path/to/client.rb
[2012-06-01 22:20:08 -0400] FreeFries: if I give it a file that already exists (even one that changed) it's fine
[2012-06-01 22:20:24 -0400] FreeFries: for example, I have 2 files, a and b...I created b an hour ago, and a last week
[2012-06-01 22:20:34 -0400] FreeFries: if I tell it to render b it fails with connection refused
[2012-06-01 22:20:41 -0400] FreeFries: if I tell it to render a it works, even if I change a
[2012-06-01 22:20:44 -0400] yfeldblum: mhalligan, nah, just get comfortable in ruby using ruby api's and you should be back to productivity :P
[2012-06-01 22:21:02 -0400] miah: ^- so much to learn =)
[2012-06-01 22:21:45 -0400] FreeFries: oh, wait, it works, but the changes don't show up
[2012-06-01 22:22:03 -0400] FreeFries: I'm guessing it's the file cache on the chef-server side
[2012-06-01 22:22:20 -0400] FreeFries: so...that'd be couchdb?
[2012-06-01 22:22:53 -0400] FreeFries: (or solr?)
[2012-06-01 22:23:55 -0400] miah: sorl really
[2012-06-01 22:24:10 -0400] miah: make sure your rabbitmq isn't backed up
[2012-06-01 22:24:16 -0400] miah: make sure your chef-expander is expanding =)
[2012-06-01 22:29:09 -0400] pcn: Does anyone have experience with templates used with runit_service failing when run in a headless/tty-less first run while working interactively?
[2012-06-01 22:31:07 -0400] FreeFries: it's gotta be one of those services
[2012-06-01 22:31:21 -0400] FreeFries: if I give it some time it seems to work
[2012-06-01 22:31:30 -0400] FreeFries: some time being 20 minutes or so
[2012-06-01 22:34:06 -0400] miah: sounds like your expander is _slow_
[2012-06-01 22:34:26 -0400] miah: investigate it and see what is going on
[2012-06-01 22:47:48 -0400] pcn: Ping?  Anyone know how to have a chef run think it's running with a pty?  Or am I barking up the wrong tree in terms of likely headless differences?
[2012-06-01 23:06:14 -0400] sako: hi chefs, is there a dry run mode yet?
[2012-06-01 23:07:41 -0400] pcn: sako rumor was 0.10.10...
[2012-06-01 23:15:19 -0400] yfeldblum: keeping in mind, of course, that since you can run any code you like in a recipe, there's no way to guarantee a run is dry
