[2012-06-26 00:03:06 -0400] swolf__: hmmm, how do i specify a unc path for remote_fire?  or am i confused in that i think i should be able to do that.  here: http://wiki.opscode.com/display/chef/Resources#Resources-RemoteFile it says remote file used to fetch from the files/ in a cookbook, but that it should now no longer do that.  however whatever i put in source seems to be getting concated with file/windows or file/default
[2012-06-26 00:03:12 -0400] swolf__: remote_file*
[2012-06-26 00:03:41 -0400] swolf__: files*/windows
[2012-06-26 01:08:26 -0400] hoover_damm: does putting 'depends "bob" then a new line depends "foo" work
[2012-06-26 01:08:27 -0400] hoover_damm: ?
[2012-06-26 01:08:39 -0400] hoover_damm: i've always done %w{foo bar}.each do |p| depends p end
[2012-06-26 01:14:36 -0400] cakehero: I am using the link resource to symlink a directory - however i get an error that the directory is there already, does link not work with directories? I looked at the sources and it appears that link should be removing the existing link first
[2012-06-26 01:46:27 -0400] rocket: can anyone point me toward a recipe that might install an application more than once?  eg I am looking for best practices on how I might go about doing that etc ...
[2012-06-26 03:14:22 -0400] hakunin: hoover_damm: you aren't much a rubyist?
[2012-06-26 03:15:09 -0400] hakunin: hoover_damm: %w(foo bar).each {...} is exactly like putting them one after another in a row
[2012-06-26 03:24:09 -0400] magoo: so my production chef server stopped responding to clients and it appears that rabbit-mq is the culprit
[2012-06-26 03:24:26 -0400] magoo: i tried restarting it and it won't come back up
[2012-06-26 03:25:23 -0400] magoo: http://pastebin.com/9478kM6H
[2012-06-26 03:46:41 -0400] danryan: magoo: I've had that happen a few times. To fix it, I stop chef-server, remove (or just move) the mnesia directory (/var/lib/rabbitmq/mnesia on debian/ubuntu), start rabbitmq and then chef-server again
[2012-06-26 03:47:26 -0400] danryan: you'll lose what's in the queue, but chef only uses rabbitmq for search indexing, which you can rebuild with `knife index rebuild`
[2012-06-26 03:47:36 -0400] hoover_damm: hakunin, I learned ruby to help automate things and deliver a better universe for myself
[2012-06-26 03:47:56 -0400] hoover_damm: hakunin, %w(foo bar).each is pretty much that way to go
[2012-06-26 03:48:13 -0400] hoover_damm: ohwell
[2012-06-26 03:48:24 -0400] hoover_damm: i've been debugging some crappy latency issue on ec2 all day
[2012-06-26 03:48:26 -0400] hakunin: hoover_damm: it doesn't matter how you write it
[2012-06-26 03:48:29 -0400] hoover_damm: so really all good
[2012-06-26 03:48:33 -0400] hakunin: you can write %w[foo bar]
[2012-06-26 03:48:43 -0400] hoover_damm: %w foo bar?
[2012-06-26 03:48:44 -0400] hakunin: %w^foo bar^
[2012-06-26 03:48:46 -0400] hakunin: yes
[2012-06-26 03:48:52 -0400] hoover_damm: yeah i thought so
[2012-06-26 03:48:54 -0400] hakunin: you can also write ['foo', 'bar']
[2012-06-26 03:48:56 -0400] hoover_damm: knowing what %w is
[2012-06-26 03:49:18 -0400] hakunin: or just write depends 'foo'; depends 'bar' (; or newlines)
[2012-06-26 03:49:23 -0400] hakunin: all the same
[2012-06-26 03:50:15 -0400] danryan: magoo: actually, you shouldn't have to bother with `knife index rebuild` since it's not your solr that's borked.
[2012-06-26 03:50:46 -0400] hakunin: hoover_damm: i actually prefer depends 'foo' and next line depends 'bar' to the %w(foo bar).each thing
[2012-06-26 03:50:54 -0400] hakunin: hoover_damm: for 2 things loop makes no sense
[2012-06-26 03:50:58 -0400] hakunin: only dirtier
[2012-06-26 03:51:01 -0400] danryan: magoo: perchance did the hostname of your chef server recently change?
[2012-06-26 03:58:00 -0400] magoo: danryan: couchdb had eat up all of my hard drive space. I ran the post that sets compacting on and it freed up a ton of space
[2012-06-26 03:59:44 -0400] danryan: magoo: ah, very good. I take it rabbitmq could start up again?
[2012-06-26 04:00:11 -0400] magoo: yup, everything was borked b/c i was at 100%
[2012-06-26 04:00:19 -0400] magoo: once i cleared the space, everything was peachy
[2012-06-26 05:20:30 -0400] BryanWB_: ohai chefs!
[2012-06-26 05:21:38 -0400] cheeseplus: hai
[2012-06-26 05:41:49 -0400] ddosia: any way to trigger event from chef node to notificate other nodes?
[2012-06-26 05:50:57 -0400] miah: hihi
[2012-06-26 05:51:54 -0400] erikh: OHAI
[2012-06-26 05:52:02 -0400] BryanWB_: miah: yo yo!
[2012-06-26 05:58:00 -0400] eugenmayer: Good morning. suddenly my chef-server seems to blow up after every night. i can get the server / webui woking after restarting the server, but beside that, it just stucks
[2012-06-26 05:58:45 -0400] eugenmayer: Trying to run chef-client on the server, the server.log shows up a "authentication failed" error (needs nearly 1 minutes though )
[2012-06-26 05:59:02 -0400] eugenmayer: solr.log / server-webui do no show anything specific
[2012-06-26 05:59:49 -0400] erikh: are you running out of disk space?
[2012-06-26 06:00:57 -0400] miah: BryanWB_: so. mostly i am derpy. ark works as expected =)
[2012-06-26 06:01:19 -0400] eugenmayer: erikh: /dev/sda1              15G   13G  953M  94% /
[2012-06-26 06:01:20 -0400] miah: though i kind of wish install didn't do 'link' as well
[2012-06-26 06:01:31 -0400] erikh: eugenmayer: that's bad
[2012-06-26 06:01:41 -0400] eugenmayer: erikh: not too much space left, you right. But yet thats 1GB - thats critical?
[2012-06-26 06:01:44 -0400] BryanWB_: miah: hmm, u can do put
[2012-06-26 06:01:46 -0400] BryanWB_: :put
[2012-06-26 06:01:55 -0400] erikh: you're probably hitting space limits with couchdb
[2012-06-26 06:01:59 -0400] miah: ya, but i need to do :install_with_make
[2012-06-26 06:02:03 -0400] erikh: do you run the chef compaction recipes on that server?
[2012-06-26 06:02:12 -0400] BryanWB_: miah: ah so u need put_with_make
[2012-06-26 06:02:13 -0400] miah: and just dont want the source dir linked in the binary dir
[2012-06-26 06:02:20 -0400] eugenmayer: erikh: no idea what that is :(
[2012-06-26 06:02:43 -0400] miah: couchdb maintenance
[2012-06-26 06:02:43 -0400] erikh: ok, in the chef-server cookbook there are a few gems that compact your couchdb
[2012-06-26 06:02:44 -0400] eugenmayer: (iam pretty suprised that so much space is used by chef)
[2012-06-26 06:02:58 -0400] miah: eugenmayer: http://wiki.apache.org/couchdb/Compaction
[2012-06-26 06:03:02 -0400] erikh: you'll want to look at it, I can't remember what recipes exactly
[2012-06-26 06:03:12 -0400] erikh: but you should be running them regularly
[2012-06-26 06:03:29 -0400] miah: the cookbooks for managing chef need some attention =)
[2012-06-26 06:03:31 -0400] erikh: basically think of couchdb having to garbage-collect itself.
[2012-06-26 06:03:35 -0400] erikh: miah: oh, agreed.
[2012-06-26 06:03:50 -0400] miah: i'll probably get to them eventually
[2012-06-26 06:03:56 -0400] eugenmayer: well yeah, /var/lib/couchdb takes up 9.4 space
[2012-06-26 06:04:10 -0400] eugenmayer: 9.4GB space
[2012-06-26 06:04:18 -0400] eugenmayer: basically 70%
[2012-06-26 06:04:25 -0400] erikh: yeah, if you ran compaction I think you'd find it using a lot less.
[2012-06-26 06:04:27 -0400] miah: eugenmayer: compact then =)
[2012-06-26 06:04:34 -0400] miah: you'll probably free up 70% of your disk space
[2012-06-26 06:04:39 -0400] eugenmayer: you guys are awesome.
[2012-06-26 06:04:41 -0400] erikh: again, root around in the chef-server cookbook
[2012-06-26 06:04:46 -0400] erikh: you'll find what you need.
[2012-06-26 06:04:50 -0400] eugenmayer: i would never ever look into that direction..
[2012-06-26 06:04:56 -0400] miah: ya. def. the chef-server default.rb does exactly this
[2012-06-26 06:05:02 -0400] erikh: is it default?
[2012-06-26 06:05:06 -0400] miah: sadly, the chef-server cookbook doesn't manage chef-server well..
[2012-06-26 06:05:08 -0400] erikh: I couldnt' remember.
[2012-06-26 06:05:10 -0400] miah: yup. its in default.rb
[2012-06-26 06:05:11 -0400] eugenmayer: hmm, not sure, when does it get run?
[2012-06-26 06:05:13 -0400] erikh: awesome.
[2012-06-26 06:05:15 -0400] eugenmayer: ahi read you.
[2012-06-26 06:05:23 -0400] erikh: eugenmayer: it'd be run every interval in that case.
[2012-06-26 06:05:33 -0400] erikh: every chef-client run.
[2012-06-26 06:05:37 -0400] eugenmayer: exactly, so all i need is adding this to my chef-server node
[2012-06-26 06:05:44 -0400] erikh: yep!
[2012-06-26 06:05:50 -0400] miah: you could add it to a cronjob as well, or enable automatic compaction
[2012-06-26 06:05:50 -0400] eugenmayer: erikh++
[2012-06-26 06:05:52 -0400] eugenmayer: miah++
[2012-06-26 06:05:54 -0400] erikh: miah++ too
[2012-06-26 06:06:28 -0400] miah: i am about to sleep
[2012-06-26 06:06:47 -0400] eugenmayer: have a good sleep then
[2012-06-26 06:07:48 -0400] miah: yar. g'nite
[2012-06-26 06:09:17 -0400] eugenmayer: looking for that cookbook..
[2012-06-26 06:10:59 -0400] eugenmayer: too easy :)
[2012-06-26 06:14:45 -0400] erikh: yeah I should hit the hay too
[2012-06-26 06:14:49 -0400] erikh: keep procrastinating.
[2012-06-26 06:14:58 -0400] erikh: err, I do.
[2012-06-26 06:15:00 -0400] erikh: not the rest of you.
[2012-06-26 06:15:05 -0400] eugenmayer: well, wait a second
[2012-06-26 06:15:22 -0400] eugenmayer: when using the chef-server default.rbit will reinstall the chef server, wiping my current server, right?
[2012-06-26 06:15:32 -0400] erikh: how did you install the chef server before
[2012-06-26 06:15:39 -0400] erikh: with the chef-solo stuff?
[2012-06-26 06:15:42 -0400] eugenmayer: apt
[2012-06-26 06:15:50 -0400] erikh: hrm. I'd test on a VM.
[2012-06-26 06:16:07 -0400] erikh: alternatively you could do the compaction manually.
[2012-06-26 06:16:08 -0400] eugenmayer: damn. For now, how to compact manually?
[2012-06-26 06:16:13 -0400] erikh: good question
[2012-06-26 06:16:16 -0400] erikh: I always use the recipe :)
[2012-06-26 06:16:38 -0400] eugenmayer: http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2012-06-26 06:16:43 -0400] eugenmayer: ok its all here i guess
[2012-06-26 06:17:39 -0400] erikh: cool.
[2012-06-26 06:19:26 -0400] eugenmayer:  /dev/sda1              15G  4,0G  9,5G  30% /
[2012-06-26 06:19:30 -0400] eugenmayer: looks better
[2012-06-26 06:20:03 -0400] erikh: niiice.
[2012-06-26 06:25:39 -0400] eugenmayer: cool, new chef version, 10.12.0-1
[2012-06-26 06:25:46 -0400] eugenmayer: how do i find the release notes
[2012-06-26 06:26:05 -0400] eugenmayer: !releases
[2012-06-26 06:51:52 -0400] cwj: eugenmayer: the first link in the topic is to the release notes
[2012-06-26 08:42:58 -0400] dkannan: can someone review, https://github.com/opscode/chef/pull/317
[2012-06-26 08:44:58 -0400] masterkorp: http://p.rapimg.com/ipix_new/pkw/23/936/p6693623_3x.jpg
[2012-06-26 08:45:00 -0400] masterkorp: oops
[2012-06-26 09:13:32 -0400] vin_: Hi , I need to setup a high availabilty chef server in my private datacenter, I would like to have a discussion with some one who has experience in doing so, since i am little stuck at implementing it
[2012-06-26 09:38:32 -0400] alclonky: i have a strange problem
[2012-06-26 09:38:32 -0400] alclonky: knife search node "name:*" | grep Node |wc -l
[2012-06-26 09:38:32 -0400] alclonky: 49
[2012-06-26 09:38:32 -0400] alclonky: knife node list | wc -l
[2012-06-26 09:38:33 -0400] alclonky: i am not finding 10 nodes, but it worked yesterday,
[2012-06-26 09:38:33 -0400] alclonky: i can run chef on these node without any problem, but search wont find them anymore
[2012-06-26 09:38:33 -0400] alclonky: 59
[2012-06-26 09:38:34 -0400] alclonky: is there a way to clear and rebuild the index?
[2012-06-26 09:39:40 -0400] makuk66: http://wiki.opscode.com/display/chef/Chef+Indexer green box on the right
[2012-06-26 09:44:48 -0400] alclonky: ok thanks but the rebuild did not fix my problem as i hoped
[2012-06-26 09:47:54 -0400] makuk66: alclonky: then check the various logs (for things like amq auth errors); restart chef-expander/chef-solr
[2012-06-26 09:50:29 -0400] sawyer_: i'm having trouble differing between a continuous integration chef setup (which checks for packages, updates if anything is missing/changed) and a one-off deployment which actually restarts services
[2012-06-26 09:50:49 -0400] sawyer_: someone suggested i setup all services to have a reload function, but some services require actually restarts.. how do you suggest i handle this?
[2012-06-26 10:20:22 -0400] alclonky: i don't get it
[2012-06-26 10:20:23 -0400] alclonky: knife search node "*:*" | wc -l
[2012-06-26 10:20:23 -0400] alclonky: 533
[2012-06-26 10:20:23 -0400] alclonky: knife search node "name:*" | wc -l
[2012-06-26 10:20:23 -0400] alclonky: 443
[2012-06-26 10:20:35 -0400] alclonky: but the missing node have a name
[2012-06-26 10:20:40 -0400] alclonky: and role etc
[2012-06-26 10:20:53 -0400] alclonky: knife search node "role:*" | wc -l
[2012-06-26 10:20:53 -0400] alclonky: 443
[2012-06-26 10:21:25 -0400] alclonky:  knife search node "fqdn:*" | wc -l
[2012-06-26 10:21:25 -0400] alclonky: 470
[2012-06-26 10:21:26 -0400] alclonky:  knife search node "ipaddress:*" | wc -l
[2012-06-26 10:21:26 -0400] alclonky: 470
[2012-06-26 10:36:49 -0400] drrk: hi all
[2012-06-26 10:37:16 -0400] drrk: I have a slight issue with chef, in that the chef-gem recipe doesn't seem to pickup on proxy settings
[2012-06-26 10:37:24 -0400] drrk: anyidea how to fix this?
[2012-06-26 10:53:17 -0400] RJ2: how can i get the chef node name to use in a role definition? i'm trying to assign it to an override_attribute using @config[:chef_node_name]
[2012-06-26 10:55:00 -0400] RJ2: alclonky: i had a similar problem when one of my nodes had lots of IP addresses - if the ohai output has too many fields, chef-solr doesnt index them all
[2012-06-26 10:55:17 -0400] RJ2: in some cases the node might appear in knife list, but not when searching, if the name field wasn't indexed
[2012-06-26 10:55:55 -0400] RJ2: alclonky: i installed https://github.com/opscode/whitelist-node-attrs to avoid reporting all my IPs, so the rest got indexed. the limit on fields is 10k iirc
[2012-06-26 10:55:58 -0400] RJ2: i had 30k ips
[2012-06-26 11:19:56 -0400] matschaffer: garrensm_: ga
[2012-06-26 11:20:13 -0400] garrensmith: matschaffer: hey
[2012-06-26 11:50:16 -0400] alclonky: RJ2: my node have 1-3 Ips and there are 50 nodes
[2012-06-26 11:50:17 -0400] alclonky: so i dont think thats the problem?
[2012-06-26 11:50:17 -0400] alclonky: only thing i remember i did since it worked the last time is creating 500 users on these node
[2012-06-26 11:50:18 -0400] alclonky: they are all in the knife node show <node> -l
[2012-06-26 11:50:40 -0400] RJ2: alclonky: ok, that might be related, iti's not just IPs, it's now many fields have to be indexed
[2012-06-26 11:50:51 -0400] RJ2: try installing that whitelist cookbook on that node
[2012-06-26 11:51:03 -0400] alclonky: ok
[2012-06-26 11:51:05 -0400] alclonky: i will
[2012-06-26 11:51:05 -0400] RJ2: if ti works, then add fields you need to the whitelist, so all those users aren't indexed by chef
[2012-06-26 11:52:43 -0400] RJ2: alclonky: see also: http://tickets.opscode.com/browse/CHEF-2346
[2012-06-26 12:01:59 -0400] alclonky: RJ2: nice it worked, thx a lot
[2012-06-26 12:02:20 -0400] RJ2: alclonky: cool, i had the same problem last week, someone in this chan helped me ;)
[2012-06-26 12:49:38 -0400] railsraider: i can't get bundle to work under rvm system anyone had luck with that? i keep getting bundle command not found
[2012-06-26 12:50:13 -0400] railsraider: maybe someone knows how to echo out stuff to chef run using log?
[2012-06-26 12:58:00 -0400] railsraider: how do you debug a runtime environment i am guessing only when i need to know for sure if rvm is loaded or not
[2012-06-26 13:21:02 -0400] railsraider: I'm in a problem here. i have to switch the context of install to admin user from a chef run of root user how do i get to do that
[2012-06-26 13:21:26 -0400] railsraider: this simple bash as root  su admin & cd /home/admin && whoami  returns root
[2012-06-26 13:25:58 -0400] rgsteele: For some reason, setting a default attribute using a data_bag value seems to result in "TypeError: can't convert String into Integer".  I've seen a few references to this behavior around on the web, but would love to be able to confirm.  Here's the relevant bit from the attributes file and the backtrace: https://gist.github.com/2995766
[2012-06-26 13:26:56 -0400] rgsteele: Apparently, just setting it to a variable (e.g., foo = ldap_bag['my_key']['foo']), and then setting a default attribute using that variable, works, because I do it in other cookbooks.  But, I was hoping to skip that extra step.
[2012-06-26 13:30:01 -0400] leifmadsen: rgsteele: I've seen that when I use something wrapped in double quotes in my json file instead of just leaving it as a integer since my recipe would be attempting to perform an integer based test
[2012-06-26 13:30:12 -0400] rgsteele: Well, it's a string
[2012-06-26 13:30:42 -0400] rgsteele: In the databag, the value is a SSHA string
[2012-06-26 13:31:53 -0400] leifmadsen: huh...
[2012-06-26 13:35:42 -0400] sawyer: how could i separate continuous integration runs with runs that have to restart services (and might disconnect users)?
[2012-06-26 13:36:18 -0400] leifmadsen: rgsteele: sorry, I have no further ideas at the moment
[2012-06-26 13:50:24 -0400] RJ2: how can i list all installed cookbooks and their versions, for a node? i want to set cookbook_versions in my environment file, want a quick way to get the versions i'm currently using
[2012-06-26 13:52:20 -0400] railsraider: I don't understand the script resource, i explicitly told it to run as admin yet it still tries to run as root
[2012-06-26 13:53:01 -0400] jameson: railsraider: you can tell it to su in the script (that's what I currently do)
[2012-06-26 13:53:15 -0400] jameson: RJ2: have you tried knife node show NODE -long ?
[2012-06-26 13:53:33 -0400] jameson: *--long
[2012-06-26 13:54:38 -0400] railsraider: jameson:  i need to do bundle install and i tried su admin && cd /home/admin && whoami ,            everything after the su admin does  not get executed as admin
[2012-06-26 13:54:44 -0400] railsraider: try that in bash
[2012-06-26 13:54:55 -0400] railsraider: su admin& whoami
[2012-06-26 13:55:05 -0400] RJ2: jameson: that doesnt list version number of installed cookbooks, by the looks of it. ie apache2 is listed, but not what version it's using
[2012-06-26 13:55:05 -0400] railsraider: it will return root when you exit
[2012-06-26 13:55:12 -0400] ashb_: cd path && sudo bundle install
[2012-06-26 13:55:25 -0400] railsraider: can't do sudo bundle install
[2012-06-26 13:55:26 -0400] RJ2: but the metadata.rb file in apache2 show 1.1.6
[2012-06-26 13:55:32 -0400] railsraider: bundle install must install in admin
[2012-06-26 13:55:36 -0400] railsraider: as admin
[2012-06-26 13:55:47 -0400] ashb_: sudo -u admin
[2012-06-26 13:56:03 -0400] jameson: railsraider: you are using && wrong
[2012-06-26 13:56:05 -0400] railsraider: same thing, it suppress all commands after the &&
[2012-06-26 13:56:12 -0400] jameson: railsraider: you should just su, without the &&
[2012-06-26 13:56:17 -0400] ashb_: cd /path && sudo -u admin bundle install
[2012-06-26 13:56:23 -0400] ashb_: job done. it works cos it's what i'm using
[2012-06-26 13:56:35 -0400] railsraider: k i'll give it a try
[2012-06-26 13:56:45 -0400] jameson: railsraider: you should be able to do, su admin \n cd /home/admin \n whoami
[2012-06-26 13:56:47 -0400] ashb_: alterntaively do it in the more chef manner
[2012-06-26 13:56:56 -0400] jameson: becayse you are using &&, the other commands wont run
[2012-06-26 13:57:01 -0400] ashb_: exeute "bundle install" do; user "admin"; cwd "/path"; end
[2012-06-26 13:57:08 -0400] jameson: a su command doesn't return
[2012-06-26 13:57:36 -0400] railsraider: k i'll give it a try
[2012-06-26 13:57:38 -0400] railsraider: thanks
[2012-06-26 13:57:41 -0400] jameson: RJ2: mm :| it might be in the chef-logs ?
[2012-06-26 13:57:44 -0400] RJ2: is there any way to do: 'knife node show NODE -a recipes' with versions shown?
[2012-06-26 13:59:19 -0400] jameson: RJ2: unless you specify I think the best bet is either 1. go through the install logs, or 2. use knife cookbook list, and match that to the env
[2012-06-26 13:59:33 -0400] RJ2: ah, i can use -a recipes, then call cookbook show
[2012-06-26 14:01:44 -0400] RJ2: got it:  knife node show NODE -a recipes | awk '/^ /{print $1}' | sed 's/:.*//' | while read cb ; do knife cookbook show $cb ; done
[2012-06-26 14:03:36 -0400] jameson: yeh
[2012-06-26 14:03:47 -0400] jameson: `knife cookbook show` is really slow :X
[2012-06-26 14:04:02 -0400] RJ2: i only need to do this once, thankfully
[2012-06-26 14:04:11 -0400] rgsteele: Hm, is there a knife.rb option for specifying the path to data bags?  Something equivalent to cookbook_path maybe?  It looks like my vagrant is only mounting the cookbooks and roles shared folders.
[2012-06-26 14:04:18 -0400] zts: would be faster to "knife cookbook list -a" and filter the list to the ones you care about
[2012-06-26 14:05:10 -0400] jameson: rgsteele: I think there is an option for vagrant
[2012-06-26 14:05:32 -0400] jameson: chef.data_bags_path = "../chatid-chef/data_bags"
[2012-06-26 14:05:39 -0400] jameson: derp :|
[2012-06-26 14:06:09 -0400] rgsteele: jameson: Gotcha, thanks.
[2012-06-26 14:11:32 -0400] railsraider: jameson:  ashb_  can you please look http://www.pastie.org/private/koekfbmcyjiz2thf3ja78w it's trying to locate bundle as the root user not as the admin user
[2012-06-26 14:16:42 -0400] jameson: railsraider: the EOH honors line breaks, so you can do
[2012-06-26 14:16:47 -0400] jameson: sudo su admin
[2012-06-26 14:16:50 -0400] jameson: bundle install
[2012-06-26 14:17:02 -0400] jameson: and it will wait for the line before to finish before running the next command
[2012-06-26 14:17:47 -0400] railsraider: jameson:  whats the user "admin" do?
[2012-06-26 14:17:59 -0400] railsraider: doesn't it supposed to do the sudo su admin ?
[2012-06-26 14:17:59 -0400] jameson: sudo su admin (switch to admin)
[2012-06-26 14:18:52 -0400] jameson: right
[2012-06-26 14:18:56 -0400] jameson: but you are using rvm I think
[2012-06-26 14:19:12 -0400] jameson: and you have to start a session to source bundle
[2012-06-26 14:21:13 -0400] railsraider: i do use rvm, and i even added  source /etc/profile.d/rvm.sh so that rvm will be available but it looks like it hangs
[2012-06-26 14:21:24 -0400] jameson: railsraider: you can do rvmsudo instead then
[2012-06-26 14:21:33 -0400] jameson: try replacing sudo with rvmsudo
[2012-06-26 14:22:36 -0400] jameson: the source wont work, unless you login
[2012-06-26 14:22:42 -0400] railsraider: jameson:  rvm manual says add users to the rvm group is followed, the use of either sudo or rvmsudo is no longer required
[2012-06-26 14:22:51 -0400] railsraider: If you need to use 'sudo' or 'rvmsudo' after the install is complete, some part of the install directions were not properly followed
[2012-06-26 14:22:52 -0400] jameson: try it?
[2012-06-26 14:22:56 -0400] railsraider: i guess
[2012-06-26 14:23:01 -0400] jameson: otherwise
[2012-06-26 14:23:02 -0400] jameson: just do
[2012-06-26 14:23:05 -0400] jameson: sudo su admin
[2012-06-26 14:23:07 -0400] jameson: then on the next line
[2012-06-26 14:23:09 -0400] jameson: do the command
[2012-06-26 14:23:45 -0400] jameson: code <<-EOH sudo -u admin  bundle install --quiet --deployment --path #{bundler_depot} --without #{excluded_groups.join(' ')} EOH
[2012-06-26 14:23:52 -0400] jameson: bah new lines
[2012-06-26 14:24:08 -0400] railsraider: rvmsudo will install bundle gems into root user
[2012-06-26 14:24:13 -0400] railsraider: not to the admin user
[2012-06-26 14:24:28 -0400] jameson: yep, because you are still root
[2012-06-26 14:24:36 -0400] railsraider: can't do that
[2012-06-26 14:24:40 -0400] jameson: so..
[2012-06-26 14:24:42 -0400] jameson: do sudo su admin
[2012-06-26 14:24:44 -0400] jameson: cd ~
[2012-06-26 14:24:47 -0400] jameson: then bundle install
[2012-06-26 14:24:51 -0400] railsraider: i have to install them to the admin user
[2012-06-26 14:25:24 -0400] railsraider: yeah except that its not working - it just hangs
[2012-06-26 14:25:44 -0400] jameson: http://pastebin.com/AgEZj3ih
[2012-06-26 14:25:48 -0400] jameson: you tried that?
[2012-06-26 14:26:04 -0400] railsraider: yes
[2012-06-26 14:26:07 -0400] railsraider: hangs
[2012-06-26 14:26:29 -0400] railsraider: if bundle install works i should see gems being fetched right away
[2012-06-26 14:26:56 -0400] jameson: or it might be rolling around being ruby
[2012-06-26 14:27:03 -0400] railsraider: do you know how to use that useless shed debugger
[2012-06-26 14:27:25 -0400] railsraider: or maybe log variables such as which bundle
[2012-06-26 14:27:40 -0400] jameson: Chef::Log.info // warn // error
[2012-06-26 14:27:46 -0400] railsraider: i wish i knew how to use shef
[2012-06-26 14:27:57 -0400] jameson: Chef::Log.info()
[2012-06-26 14:28:11 -0400] jameson: railsraider: http://pastebin.com/u3ekbi6t run that, and paste me the output?
[2012-06-26 14:28:26 -0400] railsraider: i tried that in a ruby block Chef::Log.info(`which bundle`) didn't do anything
[2012-06-26 14:28:46 -0400] jameson: because which bundle is not local
[2012-06-26 14:29:04 -0400] jameson: or, you are not running which bundle
[2012-06-26 14:29:13 -0400] jameson: try my paste, show me the output
[2012-06-26 14:30:45 -0400] railsraider: hmmm, i see admin admin /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle which is the correct settings why the hell does it hangs
[2012-06-26 14:31:06 -0400] railsraider: maybe i need a bundle update before bundle install
[2012-06-26 14:31:20 -0400] jameson: does it hang, and you quit or does it return an error?
[2012-06-26 14:31:49 -0400] railsraider: i quit
[2012-06-26 14:32:25 -0400] railsraider: oh! now it works!
[2012-06-26 14:32:30 -0400] railsraider: bundle update was missing
[2012-06-26 14:32:39 -0400] railsraider: thanks a lot for your help jameson
[2012-06-26 14:32:57 -0400] jameson: I  think it was just being slow..
[2012-06-26 14:33:09 -0400] jameson: :3 on EC2 micro? or vagrant?
[2012-06-26 14:44:17 -0400] railsraider: jameson:  rackspace
[2012-06-26 14:44:44 -0400] railsraider: jameson:   i think it was a permissions issue from my previous attempts to install as root
[2012-06-26 14:45:29 -0400] jameson: railsraider: one reason my first response to weird error is the start a new instance :P
[2012-06-26 14:45:53 -0400] railsraider: takes 10 minutes for that app server role
[2012-06-26 14:45:53 -0400] jameson: the "let me try that again"
[2012-06-26 14:46:16 -0400] railsraider: it appears that rvm has a bug in which Ree is installed with docs!
[2012-06-26 14:46:23 -0400] railsraider: makes the installation so slowwwwww
[2012-06-26 14:46:34 -0400] jameson: rvm defaults with ri, rdoc
[2012-06-26 14:46:39 -0400] jameson: --no-ri --no-rdoc
[2012-06-26 14:46:50 -0400] railsraider: not for the ruby interpeter
[2012-06-26 14:46:56 -0400] railsraider: just of r the gems
[2012-06-26 14:47:07 -0400] jameson: oh.. yeah
[2012-06-26 14:47:19 -0400] railsraider: if you tail -f the log of the rvm install  you'll see that
[2012-06-26 14:47:20 -0400] jameson: :| hence I don't use rvm on deploy
[2012-06-26 14:47:31 -0400] railsraider: i wish we could do without it
[2012-06-26 14:47:36 -0400] jameson: or Ree
[2012-06-26 14:47:43 -0400] jameson: python everywhere
[2012-06-26 14:47:54 -0400] railsraider: i even wrote my own template to bootstrap ree instead of regular ruby
[2012-06-26 14:48:07 -0400] railsraider: app is ruby on rails
[2012-06-26 14:50:35 -0400] jameson: if my python server is giving me headaches.. RoR ~_~
[2012-06-26 14:50:50 -0400] jameson: but then I do bunch of git pull and git clones
[2012-06-26 15:15:45 -0400] railsraider: how can i trigger a node to run a runlist at the end of the recipe of another node
[2012-06-26 15:16:36 -0400] railsraider: i need to updated my hosts on a load balancer when I'm done with app server role creation on a new node
[2012-06-26 15:17:19 -0400] jameson: i believe chef-client is suppose to do that for you
[2012-06-26 15:17:34 -0400] jameson: when it periodically updates itself
[2012-06-26 15:17:43 -0400] jameson: (every... 1800 seconds)
[2012-06-26 15:18:15 -0400] railsraider: is there a way to override it from another node? i guess that node has to be admin
[2012-06-26 15:19:02 -0400] jameson: I think :notify has some stuff in that direction
[2012-06-26 15:19:06 -0400] jameson: I haven't explored that yet :|
[2012-06-26 15:19:14 -0400] railsraider: i will thanks jameson
[2012-06-26 15:19:30 -0400] jameson: I boot a admin node at the end that checks all the configurations, forces iptable rules to everyone
[2012-06-26 15:22:54 -0400] rgsteele: Hm, can data bags be used inside an attributes file?
[2012-06-26 15:24:51 -0400] bradgignac: rgsteele: i don't believe so
[2012-06-26 15:26:20 -0400] bradgignac: rgsteele: i take that back. i've never really though about it before, but i don't see why they couldn't be
[2012-06-26 15:26:27 -0400] bradgignac: rgsteele: they are just ruby files
[2012-06-26 15:29:14 -0400] jerem`: I get an error with sed command into my recipe
[2012-06-26 15:29:31 -0400] jerem`: STDERR: sed: -e expression #1, char 49: unterminated `s' command
[2012-06-26 15:30:02 -0400] jerem`: here my recipe : http://ziirish.info/y/sswqB
[2012-06-26 15:31:47 -0400] rgsteele: bradgignac: I dunno, I'm having issues trying to do that.
[2012-06-26 15:33:06 -0400] rgsteele: Every data bag call I make causes this error: FATAL: TypeError: can't convert String into Integer.  It doesn't seem to matter whether I assign the value to a variable, or directly to an attribute.
[2012-06-26 15:33:34 -0400] bradgignac: do you have a stack trace?
[2012-06-26 15:33:35 -0400] rgsteele: I can load the databag itself, but assigning any of the keys/vals to an attr/variable fails.
[2012-06-26 15:35:17 -0400] bradgignac: have you used the databag elsewhere so you can verify that it is valid?
[2012-06-26 15:46:03 -0400] mosez: how can i generate response_files for specific packages?
[2012-06-26 15:50:12 -0400] mosez: ok, i think i've got to install the package by hand and get the seed with  debconf-get-selections
[2012-06-26 16:10:52 -0400] magoo: apparently this is always true: if defined?(node[:pictures_consumer][:branch])
[2012-06-26 16:11:06 -0400] magoo: even if i haven't defined that variable
[2012-06-26 16:12:05 -0400] magoo: what is the correct way of saying what I mean here?
[2012-06-26 16:16:07 -0400] cwj: maybe if node[:pictures_consumer].has_key?(:branch)
[2012-06-26 16:17:58 -0400] thehar: morning
[2012-06-26 16:20:52 -0400] cwj: tehhar :D
[2012-06-26 16:23:38 -0400] thehar: cwj: :D
[2012-06-26 16:59:18 -0400] oddover: Ohai, chefs!
[2012-06-26 16:59:47 -0400] oddover: Does anyone have experience setting up chef-solo to save output to syslog?
[2012-06-26 17:01:24 -0400] oddover: echo <hears distant echos>
[2012-06-26 17:01:31 -0400] oddover: lol
[2012-06-26 17:02:36 -0400] spox: oddover: this should have the info you're looking for:
[2012-06-26 17:02:39 -0400] spox: http://tickets.opscode.com/browse/CHEF-273
[2012-06-26 17:14:11 -0400] hoover_damm: oddover, hookup sysloglogger?
[2012-06-26 17:14:37 -0400] hoover_damm: oddover, basically you hookup sysloglogger as the log filename in client.rb/server.rb
[2012-06-26 17:15:14 -0400] hoover_damm: https://github.com/seattlerb/sysloglogger
[2012-06-26 17:15:16 -0400] hoover_damm: ^^ oddover
[2012-06-26 17:30:48 -0400] jelder: is it expected behavior for the "user" resource to create a home directory not owned by the user?
[2012-06-26 17:30:52 -0400] jelder: http://pastebin.com/syp4y1r3
[2012-06-26 17:31:09 -0400] jelder: that results in something owned by root
[2012-06-26 17:31:22 -0400] jelder: but the .ssh/ dir is owned by "someuser"
[2012-06-26 17:31:40 -0400] jelder: and it doesn't copy anything from /etc/skel either
[2012-06-26 17:59:42 -0400] hoover_damm: useradd -m should automate that
[2012-06-26 17:59:45 -0400] hoover_damm: what user cookbook do you use?
[2012-06-26 18:00:23 -0400] cwj: anyone have a preference with regard to the various elasticsearch cookbooks floating around?
[2012-06-26 18:00:52 -0400] jelder: @hoover_damm users 1.1.2
[2012-06-26 18:03:24 -0400] Loof: I want to do a 'staged' deployment using AWS... basically 1) after all code is vetted start a set of 'unattached' prod instances 2) Set ELB/site to maint mode 3) stop to allow us to apply DB changes, final test, etc 4) stop all current prod instances and add all of the new prod instances to the ELB
[2012-06-26 18:04:42 -0400] Loof: I'm not clear on how I'd take a set of instances through a lifecycle like that... if I'd have to change the role on those instances or what
[2012-06-26 18:04:55 -0400] Loof: Is there a best practice for doing this sort of staged change... or a pattern/tutorial to follow... or if I should be using a different tool.
[2012-06-26 18:05:34 -0400] jelder: Loof: this just came out yesterday: http://techblog.netflix.com/2012/06/asgard-web-based-cloud-management-and.html
[2012-06-26 18:05:59 -0400] Loof: The other one that might come up is if a server's IP changes (which happens on stop/start, etc) ensuring that certain configurations get updated, etc.
[2012-06-26 18:06:27 -0400] jelder: Loof: it's not uncommon to use EIP for that
[2012-06-26 18:06:37 -0400] jelder: you only pay for allocated, unassigned IPs
[2012-06-26 18:06:58 -0400] hoover_damm: jelder, opscode's?
[2012-06-26 18:07:08 -0400] jelder: hoover_damm: yes
[2012-06-26 18:07:17 -0400] jelder: it's not immediately obvious (to me, at least) but EIP replaces the public ip, rather than adding one
[2012-06-26 18:07:41 -0400] hoover_damm: jelder, using the manage provider?
[2012-06-26 18:08:09 -0400] hoover_damm: jelder, if manage_home is true, the .skel should be copied via useradd
[2012-06-26 18:08:10 -0400] jelder: hoover_damm: i think so? this is the code: http://pastebin.com/syp4y1r3
[2012-06-26 18:08:17 -0400] hoover_damm: which should preserve the right ownership
[2012-06-26 18:08:21 -0400] hoover_damm: at least on useradd -m bob
[2012-06-26 18:08:56 -0400] hoover_damm: jelder, err no
[2012-06-26 18:09:18 -0400] hoover_damm: jelder, review the readme in https://github.com/opscode-cookbooks/users
[2012-06-26 18:10:06 -0400] jelder: hoover_damm: ok, sorry, i don't know what i'm talking about. i am using that cookbook, but not to create this particular user
[2012-06-26 18:10:13 -0400] hoover_damm: nope
[2012-06-26 18:10:19 -0400] hoover_damm: and because your not using users_manage the cookbook doesn't matter
[2012-06-26 18:10:39 -0400] hoover_damm: jelder, so for your example recipe yes .ssh and the dotfiles provided by .skel should be the right user
[2012-06-26 18:10:43 -0400] jelder: hoover_damm: i'm just trying to create a user to run our app as non-root
[2012-06-26 18:10:53 -0400] hoover_damm: jelder, you may want to delete the user, then try chef-client -l debug and see the commands
[2012-06-26 18:10:58 -0400] jelder: just following this, i thought: http://wiki.opscode.com/display/chef/Resources#Resources-User
[2012-06-26 18:11:01 -0400] hoover_damm: to see if you can find out why the skel files are misowned
[2012-06-26 18:11:12 -0400] jelder: not misowned, not present
[2012-06-26 18:11:17 -0400] jelder: and /home/someuser is owned by root
[2012-06-26 18:11:31 -0400] hoover_damm: strange
[2012-06-26 18:12:36 -0400] hoover_damm: jelder, i wrote this awhile ago .. https://gist.github.com/49bf4f3f8563ae34f46a
[2012-06-26 18:12:44 -0400] hoover_damm: which works right
[2012-06-26 18:15:10 -0400] hakunin: so i'm bootstrapping a new ubuntu 12.04 machine from scratch, and nginx recipe errors out on this line: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L90
[2012-06-26 18:15:34 -0400] hakunin: i think because it doesn't have automatic attrs
[2012-06-26 18:15:50 -0400] hakunin: i'm running those recipes as solo
[2012-06-26 18:15:55 -0400] hakunin: not sure if has anythign to do with it
[2012-06-26 18:18:03 -0400] hoover_damm: hakunin, would need to see a traceback of the failure to know
[2012-06-26 18:18:33 -0400] hoover_damm: basically if you have a problem with chef and your trying to debug a recipe, or something... traceback of the error that occured is exceptionally helpful
[2012-06-26 18:19:25 -0400] hakunin: hoover_damm: https://gist.github.com/5b2f0daa6149b0cf2658
[2012-06-26 18:20:14 -0400] hoover_damm: hakunin, looks like it
[2012-06-26 18:20:18 -0400] hakunin: hoover_damm: this is the error ruby gives when you're trying to do this: nil['foo']   (in this case automatic_attrs['nginx']['version'])
[2012-06-26 18:20:34 -0400] hoover_damm: hakunin, I didn't realize that automatic_attr was a server thing
[2012-06-26 18:21:16 -0400] hakunin: hoover_damm: it could also be the node['nginx']['version'] side of the comparison causing this but
[2012-06-26 18:21:16 -0400] hoover_damm: hakunin, change the not_if to be a ::File.exists?("nginxbin") is a work around
[2012-06-26 18:21:22 -0400] hoover_damm: or something like that
[2012-06-26 18:21:32 -0400] hoover_damm: don't forget to file a ticket on tickets.opscode.com on this
[2012-06-26 18:21:36 -0400] hakunin: i do have version specified for sure
[2012-06-26 18:22:02 -0400] hoover_damm: I generally upgrade nginx intentionally.  I shut it down, uninstall it, then run chef.
[2012-06-26 18:22:08 -0400] hakunin: hoover_damm: funny that i think this part worked before, but was recompiling every time, and now it errors out when i tried bootstrapping from scratch
[2012-06-26 18:22:12 -0400] hoover_damm: that's my personal preference
[2012-06-26 18:22:36 -0400] hoover_damm: hakunin, strange, new version of chef?
[2012-06-26 18:22:41 -0400] hoover_damm: hakunin, 0.10.10 vs 0.10.12?
[2012-06-26 18:22:42 -0400] hakunin: no
[2012-06-26 18:22:46 -0400] hakunin: running the same
[2012-06-26 18:23:25 -0400] hakunin: i'm working on an ec2 instance as much as i can, and when finally get it all setup, i try bootstrap a new ec2 instance again, juts to see everyting work seamlessly
[2012-06-26 18:23:48 -0400] hoover_damm: same json blob?
[2012-06-26 18:23:52 -0400] hakunin: yes
[2012-06-26 18:24:10 -0400] hakunin: wonder if i just run it again, will the error go away...
[2012-06-26 18:24:13 -0400] hoover_damm: then i'd go back to the first server and see if you can figure out where you went wrong
[2012-06-26 18:24:42 -0400] hoover_damm: if your working scenario suddenly becomes unworking, going back to a working state and working forward
[2012-06-26 18:24:45 -0400] hoover_damm: might help you debug it
[2012-06-26 18:25:25 -0400] hoover_damm: don't be afraid to create a new branch, revert a few commits to try something new...
[2012-06-26 18:28:12 -0400] hakunin: INFO: bash[compile_nginx_source] ran successfully <-- :( inconsistent, next run it worked
[2012-06-26 18:28:20 -0400] hakunin: (just reran on the same machine)
[2012-06-26 18:28:29 -0400] hoover_damm: huh
[2012-06-26 18:28:55 -0400] hoover_damm: what secret if random().true? { fail.randomly() } did you find?
[2012-06-26 18:29:16 -0400] hakunin: it might be a bug with the way automatic_attrs are discovered
[2012-06-26 18:29:28 -0400] hakunin: but i have sooooo much on my plate right now to actually investigate...
[2012-06-26 18:29:59 -0400] hoover_damm: basically i'd toss a log statement in there to dump the variable that's getting nil
[2012-06-26 18:30:12 -0400] hakunin: yeah good idea
[2012-06-26 18:30:13 -0400] hoover_damm: log "nginx version #{node[:nginx][:version]"
[2012-06-26 18:30:23 -0400] hakunin: i will be rerunning from scrtch on a new instance agian, will be useful for that
[2012-06-26 18:30:26 -0400] hoover_damm: and -l debug and keep looking
[2012-06-26 18:30:27 -0400] hoover_damm: yep
[2012-06-26 18:30:35 -0400] hoover_damm: good luck finding your rabbit hole
[2012-06-26 18:30:39 -0400] hakunin: thanks
[2012-06-26 18:35:11 -0400] hoover_damm: miah, what was the issue with haproxy 1.5dev7 again?
[2012-06-26 18:36:50 -0400] miah: dev7 is fine, iirc. but 9 and 11 were problematic
[2012-06-26 18:37:09 -0400] miah: or you can read: http://haproxy.1wt.eu/news.html
[2012-06-26 18:39:29 -0400] hoover_damm: miah, cool... we're just tracking a AWS latency issue and wanted to doublecheck
[2012-06-26 18:39:34 -0400] hoover_damm: the git log didn't show me anything like it
[2012-06-26 18:39:41 -0400] hoover_damm: but wanted to triple check
[2012-06-26 18:39:49 -0400] hoover_damm: thanks miah :)
[2012-06-26 18:41:32 -0400] miah: yup
[2012-06-26 18:42:40 -0400] hoover_damm: looks like level3 pissed someone off
[2012-06-26 18:45:04 -0400] jhayden: I am using knife ec2 to create servers. If I don't put in a region or zone it defaults to US East. Does anyone know where this config is stored?
[2012-06-26 18:45:33 -0400] hoover_damm: .chef/config
[2012-06-26 18:45:39 -0400] hoover_damm: err .chef/knife.rb has this setting
[2012-06-26 18:46:20 -0400] jhayden: not on my workstation ;-)
[2012-06-26 18:47:38 -0400] jhayden: the reason I am asking is that I tried to create a server in a diff region
[2012-06-26 18:47:38 -0400] hakunin: hoover_damm: yep, i was right about auto-attributes, here's my log msg: "Comparing nginx versions  == 1.2.1", although this time at least it has a nil version, rather than not even having nginx key. But that's why it actually recompiles every time.
[2012-06-26 18:48:17 -0400] hakunin: hoover_damm: why that one time it errored on even getting the key is a diff story
[2012-06-26 18:48:20 -0400] jhayden: made sure to have a good ami, -Z zone --region region and I get ERROR: Excon::Errors::SocketError: getaddrinfo: nodename nor servname provided, or not known
[2012-06-26 18:48:52 -0400] jelder: jhayden: can you paste the exact command line?
[2012-06-26 18:48:58 -0400] jhayden: sure
[2012-06-26 18:49:11 -0400] jhayden: knife ec2 server create -I ami-535c5827 -Z eu-west-1a --region eu-west --ebs-size 10  -f m1.medium -i ~/pems/contentModEU.pem -S contentModEU -G cmodeuwsg  -x contentModEU -N tmpContMod01.example.net -r "role[tomcatServer]"
[2012-06-26 18:49:31 -0400] hoover_damm: hakunin, now go file the bug with said data and go make your patch
[2012-06-26 18:49:32 -0400] hoover_damm: and win
[2012-06-26 18:50:05 -0400] hakunin: hoover_damm: i'll have to defer that :(
[2012-06-26 18:50:16 -0400] jhayden: if you change the ami to a US East one and remove the zone and region this works in US EAST
[2012-06-26 18:51:43 -0400] hakunin: also i think miah said (s)he is about to work some more on nginx
[2012-06-26 18:51:52 -0400] miah: <- she
[2012-06-26 18:52:01 -0400] miah: yes. nginx is in my queue for this week
[2012-06-26 18:52:16 -0400] miah: github.com/miah/nginx
[2012-06-26 18:52:30 -0400] miah: i don't have any commits atm. but i will be working on things shortly.
[2012-06-26 18:54:06 -0400] hakunin: miah: cool! so 2 problems, just don't have time for tickets: 1. auto_attributes['nginx']['version'] is coming up nil, 2. when using bluepill, it's trying to start before log dir is created. log dir is created in the commons recipe, which is included in the end, and bluepill is trying to start before that.
[2012-06-26 18:55:13 -0400] miah: ya. the commons recipe = stupid. i'm going to fix all that =)
[2012-06-26 18:55:17 -0400] Maniacal: We have an lwrp and I just tried to use "notifies" with it and it didn't work.  does anyone have any experience incorporating this feature with lwrp's and can give advice, code example, or link to where I can find info?
[2012-06-26 18:55:33 -0400] miah: anyways. zero cater arrived and i need to eats.
[2012-06-26 18:56:26 -0400] hakunin: miah: looking forward! bon appetit.
[2012-06-26 18:56:38 -0400] jhayden: ok, this is interesting, first time I explicitly set the zone and region for US-east-1a and I get the same error
[2012-06-26 18:57:00 -0400] jhayden: so somewhere my setup is wrong but defaults ok to us-east
[2012-06-26 19:05:41 -0400] jhayden: Ok, found a partial answer
[2012-06-26 19:06:07 -0400] hasrb: jhayden: you can set the default by specifying it in knife.rb as knife[:region]
[2012-06-26 19:06:10 -0400] jhayden: the region is not US-East but ap-northeast-1
[2012-06-26 19:08:05 -0400] jhayden: BINGO, its working now
[2012-06-26 19:08:28 -0400] jhayden: got the info from this ticket
[2012-06-26 19:08:29 -0400] jhayden:     Knife EC2 Plugin
[2012-06-26 19:08:30 -0400] jhayden:     KNIFE_EC2-38
[2012-06-26 19:19:13 -0400] oddover: Hi again
[2012-06-26 19:19:37 -0400] oddover: so I put this into my solo.rb file: log_location SyslogLogger.new('chef-client')
[2012-06-26 19:19:42 -0400] oddover: And I'm getting this error:
[2012-06-26 19:19:53 -0400] oddover: [2012-06-26T13:18:31-06:00] FATAL: Unknown error processing config file  with error uninitialized constant Class::SyslogLogger
[2012-06-26 19:20:11 -0400] leifmadsen: it's not Syslog::Logger.new is it?
[2012-06-26 19:20:42 -0400] oddover: lemme try
[2012-06-26 19:20:46 -0400] oddover: nope
[2012-06-26 19:20:55 -0400] spox: did you require the gem?
[2012-06-26 19:21:16 -0400] oddover: No. Do I need to?
[2012-06-26 19:21:21 -0400] oddover: and how do I do that?
[2012-06-26 19:23:34 -0400] spox: i'm guessing you're configuring in your client.rb file
[2012-06-26 19:23:40 -0400] spox: require 'syslog_logger'
[2012-06-26 19:23:43 -0400] spox: up at the top
[2012-06-26 19:26:13 -0400] oddover: Bingo. :) thanks
[2012-06-26 19:26:54 -0400] oddover: Then where does it put the log?
[2012-06-26 19:27:44 -0400] spox: to the syslog i'd imagine
[2012-06-26 19:29:22 -0400] oddover: hmmm
[2012-06-26 19:33:10 -0400] leifmadsen: huh, I guess I can close my issue about 10.12.0 being a typo on jira since it appears that is a real version :)
[2012-06-26 19:33:56 -0400] oddover: lol, I noticed that too. Did opscode change it's versioning system?
[2012-06-26 19:34:06 -0400] paulmooring: leifmadsen: As of 10.12 we moved to a new version system like semantic versioning
[2012-06-26 19:34:18 -0400] leifmadsen: works for me :)
[2012-06-26 19:34:26 -0400] leifmadsen: just caught me off guard
[2012-06-26 19:34:35 -0400] leifmadsen: btw, the wiki doesn't show the release notes for 10.12.0
[2012-06-26 19:34:36 -0400] paulmooring: we want to be able to do bug fix releases more often in a way that users know it won't break anything
[2012-06-26 19:35:10 -0400] leifmadsen: fair enough!
[2012-06-26 19:35:20 -0400] leifmadsen: I know what it's like to want to be able to do bug fixes more often
[2012-06-26 19:35:33 -0400] leifmadsen: smaller incremental changes seem to make more people happy, and easier to track down regressions
[2012-06-26 19:35:36 -0400] leifmadsen: so +1 from me
[2012-06-26 19:43:33 -0400] Aaton: trying to use the mysql 1.2.4 cookbook on ubuntu 12.04 but it's failing with "exception": "LoadError: no such file to load -- mysql". Anyone seen that before?
[2012-06-26 19:46:55 -0400] leifmadsen: package "mysql" do...
[2012-06-26 19:48:08 -0400] Aaton: I might be missing the mysql gem ...
[2012-06-26 19:48:22 -0400] leifmadsen: you could either chef_gem the mysql, or just install the mysql package
[2012-06-26 19:48:35 -0400] leifmadsen: basically there is no mysql client
[2012-06-26 19:54:59 -0400] Aaton: had to change the gem_package to a chef_gem  in the mysql::client recipe
[2012-06-26 19:55:43 -0400] Loof: jelder: Sorry, had another issue to deal with... this is not for EIP but for starting a snapshot... or stopping and starting worker instances
[2012-06-26 19:56:01 -0400] Loof: So they're not going to get EIPs... they just need to wake up and adapt to their new IP
[2012-06-26 19:56:08 -0400] jelder: hmm
[2012-06-26 19:56:28 -0400] jelder: to be honest i haven't really explored ebs-backed instances
[2012-06-26 19:57:20 -0400] Loof: They're pretty darned handy
[2012-06-26 19:57:49 -0400] Loof: Now you even get an automatic AMI when you create a snapshot... so it makes life really easy
[2012-06-26 19:57:59 -0400] jelder: oh that's cool
[2012-06-26 19:59:14 -0400] Loof: I used puppet before...and we ended up doing most things in capistrano
[2012-06-26 19:59:37 -0400] Loof: in the end... we even ran puppet via cap because puppet just consumed too many resources when it woke up and tried to check the config
[2012-06-26 19:59:47 -0400] Loof: it actually make an impact on SLA
[2012-06-26 20:00:00 -0400] Loof: With chef... I'm only JUST starting to mess with it
[2012-06-26 20:00:12 -0400] Loof: I'm not sure if I can get something that's like cap but smarter
[2012-06-26 20:01:22 -0400] Loof: i.e knife...  start a bunch of prod_unready nodes... deploy to those nodes... push a config again... make prod nodes prod_obsolete nodes...etc.
[2012-06-26 20:01:51 -0400] jelder: sounds like a great pattern
[2012-06-26 20:01:52 -0400] Loof: I've seen a lot of example of 'chef can install this stuff for you' and a few of 'chef in daemon mode can be almost like puppet'
[2012-06-26 20:02:18 -0400] jperry2: anyone using chef-hatch?
[2012-06-26 20:02:24 -0400] jelder: you get nothing by running chef in daemon mode
[2012-06-26 20:02:30 -0400] jperry2: I'm having issues at the end of the convergence
[2012-06-26 20:02:30 -0400] Loof: But I'm not clear about how to set things up so it just does what I tell it to do
[2012-06-26 20:02:31 -0400] jelder: except bloat and fragility
[2012-06-26 20:02:36 -0400] jelder: cron is better
[2012-06-26 20:05:59 -0400] swolf_: so, since cookbook_file is used for grabbing files from cookbooks, should i be able to use remote_file to grab files from a windows UNC location?
[2012-06-26 20:06:18 -0400] swolf_: because its not seeming to work.  remote_file is only looking in my cookbook/files directory
[2012-06-26 20:20:06 -0400] thedeeno: I'm getting 'FATAL: OpenSSL::Cipher::CipherError: bad decrypt' when attempting to decrypt my databag in my recipe. Any thoughts? I've ensured that the same key located in '/etc/chef/encrypted_data_bag_secret' is the one used to create the encrypted data bag
[2012-06-26 20:27:02 -0400] ssinn: can anybody recommend a good book on chef?
[2012-06-26 20:27:57 -0400] atomic-penguin: swolf_, I doubt it would work. you may have some luck writing a provider, which wraps around the sambal gem though
[2012-06-26 20:29:34 -0400] swolf_: atomic penguin:  thanks!  how about if i just wanted to grab a file from a mounted drive?  i can't even seem to do that.  the remote_file source attribute seems to only look further under the cookbook's files directory.
[2012-06-26 20:31:42 -0400] atomic-penguin: swolf_, that would be another option, probably better, use a mount resource
[2012-06-26 20:31:48 -0400] atomic-penguin: http://wiki.opscode.com/display/chef/Resources#Resources-Mount
[2012-06-26 20:36:30 -0400] doug: how's chef tell if a particular something isn't installed and needs to be reinstalled?
[2012-06-26 20:36:52 -0400] swolf_: atmoic-penguin:  nice!  thanks.  yeah, thats what i would like to do.  but i'm still confused as to how to get remote_file to look for files in the mounted directory.  for instance, if i set the 'source' parameter of the remote_file resource to "X:\myfiles\testfile.txt", i get a message saying that chef cannot find the file at location '/cookbook/files\X\myfiles\testfile.txt'
[2012-06-26 20:37:10 -0400] atomic-penguin: swolf_, I don't think that is the intent of the remote_file provider
[2012-06-26 20:37:33 -0400] atomic-penguin: swolf_, Its for pulling in files like wget would off an http/ftp URL
[2012-06-26 20:37:46 -0400] swolf_: atomic-penguin: yeah i hear ya.  but file does not have a source parameter, does it?
[2012-06-26 20:37:55 -0400] atomic-penguin: swolf_, probably FileUtils.cp would do the trick
[2012-06-26 20:38:39 -0400] atomic-penguin: swolf_, or the Link resource for that matter
[2012-06-26 20:38:53 -0400] swolf_: atomic-penguin: thanks!  i can do that, i guess i'm just a little confused by the paradigm of needing all of my files in a cookbook
[2012-06-26 20:39:00 -0400] atomic-penguin: http://wiki.opscode.com/display/chef/Resources#Resources-Link
[2012-06-26 20:39:30 -0400] atomic-penguin: A hard link should be synonymous with a copy operation
[2012-06-26 20:39:51 -0400] swolf_: atomic-penguin: will it perform the hash check to only copy if the file is different though?
[2012-06-26 20:41:36 -0400] atomic-penguin: swolf_, it should not copy the file if they are the same, the resource *should* be idempotent
[2012-06-26 20:42:21 -0400] atomic-penguin: swolf_, While using something like FileUtils would need a guard for idempotence
[2012-06-26 20:42:22 -0400] swolf_: atomic-penguin:  right on.  am i  missing something though?  i can grab packages from a source, but not files.  if i prefer to not use packages, then i have to put files in the cookbook.  this seems like a wierd restriciton to me
[2012-06-26 20:43:56 -0400] swolf_: atomic-penguin:  gotcha.  yeah i've definitely been operating under the assumption that any resource provided by chef has idempotence built in (apart from scripts, of course) and that any i choose to do myself I will have to implement that way
[2012-06-26 20:44:35 -0400] atomic-penguin: swolf_, I just don't think that is what the remote_file resource was designed for, say grabbing files off NFS/CIFS/SMB shares.  There would be a lot of underlying library code needed to provide that functionality.  A simple HTTP/FTP get isn't so difficult to wrap up in a resource, and call it "remote_file" though.
[2012-06-26 20:46:57 -0400] atomic-penguin: swolf_, so you should be able to grab a remote_file off an HTTP, or FTP source.
[2012-06-26 20:49:30 -0400] swolf_: atomic-penguin:  yeah i getcha.  i was definitely trying to use it for a purpose that it wasnt designed for.  what concerns me more is, why isn't that resource in chef somewhere.  to me, serving files from my build share should be no different then serving msi's from my build share, as msi's are just the same files put into an msi, which puts a bunch of junk in the registry that i don't need to manage if i'm keeping track of everything in my recipes
[2012-06-26 20:49:56 -0400] swolf_: i probably will go the ftp route, but if i'm on a secure network i should just be able to grab the files
[2012-06-26 20:51:39 -0400] swolf_: and i can implement it myself with FileUtils, but i feel like i'm missing the point of the restriction of cookbook_files.  i just think my recipes should have a version that corresponds to files it should grab, as opposed to every version of the files themselves which is already independtly managed on the build share
[2012-06-26 20:51:53 -0400] ivey: swolf_: https://github.com/RiotGames/artifact-cookbook might be useful
[2012-06-26 20:52:10 -0400] atomic-penguin: swolf_, thats not to say it couldn't be grafted in there.  I think that is more along the line of why the mount resource exists.  Since Chef was natively designed around Unix conventions, we tend to treat network filesystems as mountpoints.
[2012-06-26 20:52:19 -0400] ivey: but it's still not going to have SMB built in
[2012-06-26 20:53:22 -0400] ivey: but it's more than just "grab a file" it has some smarts in it
[2012-06-26 20:56:29 -0400] swolf_: hey why did you link me to riot games.  trying to re-fire up my league of legends addiction or something...
[2012-06-26 20:56:44 -0400] ivey: hah no we just made the cookbook
[2012-06-26 20:56:47 -0400] ivey: but yes, play more lol
[2012-06-26 20:57:57 -0400] ivey: we use artifact_deploy to deploy artifacts off an artifact server, and it makes rollbacks easy. you could use samba or the mount resource to mount the share, and then deploy the artifacts with artifact_deploy
[2012-06-26 20:58:20 -0400] miah: 'rollbacks easy'
[2012-06-26 20:58:54 -0400] miah: ivey: http://cfengine.com/markburgess/papers/totalfield.pdf
[2012-06-26 20:59:27 -0400] ivey: i should have said downgrades :-)
[2012-06-26 20:59:31 -0400] hoover_damm: artifact_deploy... neat :)
[2012-06-26 21:00:12 -0400] hoover_damm: ivey, cool stuff
[2012-06-26 21:00:26 -0400] hoover_damm: ivey, it's a different concept for some people
[2012-06-26 21:00:32 -0400] hoover_damm: will take them time to see how right you are
[2012-06-26 21:00:43 -0400] chip-: Stupid Ruby syntax question: I want to do "If string $a == "foo" then unset($a)", what's the best way to do that?
[2012-06-26 21:01:35 -0400] miah: unless a == "foo"
[2012-06-26 21:01:45 -0400] miah: er, unless a = "foo"
[2012-06-26 21:02:41 -0400] chip-: I still want the operation to happen, I just want a to be reset to nil if it's set to a particular value
[2012-06-26 21:02:46 -0400] chip-: Maybe I don't understand what unless does
[2012-06-26 21:03:09 -0400] ivey: unless is the same as if !
[2012-06-26 21:03:49 -0400] ivey: a = nil if a == "foo"
[2012-06-26 21:05:38 -0400] chip-: Thanks ivey!
[2012-06-26 21:13:29 -0400] chip-: Essentially what I want to do is if someone sets the string plugin_version to 'master', which is a perfectly sensible thing to do, then reset the string to '' before it's processed, because a blank string will be processed by the command as 'master' but the actual phrase 'master' will cause an exception.
[2012-06-26 21:13:34 -0400] chip-: Because this command is stupid like that.
[2012-06-26 21:13:35 -0400] chip-: gist: https://gist.github.com/2999077
[2012-06-26 21:19:05 -0400] qhartman: I'm setting a variable to feed into a template using the format ":var => array_of_nodes[0].ipaddress ||= node.ipaddress" but the ||= is failing when array_of_nodes is unset or empty because I'm trying to use the ipaddress method on a nil class. Is there a way to make something idiomatically similar work?
[2012-06-26 21:25:31 -0400] hakunin: miah: one more thing wrong in nginx recipe: it never creates an nginx binary in a consistent location (like /usr/bin/nginx or /usr/sbin/nginx). The only binary it creates is in /opt/nginx-#{version}/sbin/nginx, which is not in PATH and is version-bound.
[2012-06-26 21:27:54 -0400] oddover: I'm having trouble getting syslog to work with chef. I have this in my /etc/chef/solo.rb file: http://pastebin.com/nPbmQ1nQ
[2012-06-26 21:28:41 -0400] oddover: So, shouldn't the log messages be going to /var/log/chef?
[2012-06-26 21:29:11 -0400] miah: hakunin: ya. i tend to make stuff like that configurable. eg; https://github.com/miah/varnish/blob/rhel/attributes/default.rb#L4
[2012-06-26 21:29:35 -0400] miah: hardcoding paths = unhappy people
[2012-06-26 21:30:25 -0400] jordane: qhartman: :var => array_of_nodes.respond_to?(:[]) ? array_of_nodes[0].ipaddress : node.ipaddress
[2012-06-26 21:31:30 -0400] qhartman: jordane, oooooohhhhh... cool, thanks :D
[2012-06-26 21:31:40 -0400] jperry2: anyone use hosted chef for all their chef testing then push to a local installed chef server you use internally?
[2012-06-26 21:31:52 -0400] jperry2: are there barriers for this?
[2012-06-26 21:31:59 -0400] miah: no, that should work fine.
[2012-06-26 21:32:03 -0400] miah: i use vagrant and test mostly locally.
[2012-06-26 21:32:04 -0400] jordane: qhartman: np. It will still error if array_of_nodes[0] doesn't have an ipaddress method, but it'll handle the case you mentioned fine.
[2012-06-26 21:32:18 -0400] jperry2: @miah so you run a local chef server?
[2012-06-26 21:32:22 -0400] miah: but i also use environments with cookbook version pinning
[2012-06-26 21:32:22 -0400] jperry2: on your workstation?
[2012-06-26 21:32:28 -0400] miah: jperry2: no. chef-solo.
[2012-06-26 21:32:29 -0400] jperry2: @miah - that is fine
[2012-06-26 21:32:32 -0400] jperry2: ah ok
[2012-06-26 21:32:43 -0400] miah: i mock results of searches
[2012-06-26 21:32:55 -0400] jperry2: yeah at first i was doing that but then I had to put all these hooks in for if I was using chef server
[2012-06-26 21:32:59 -0400] miah: so in a chef-solo environment i still get a functional/testable deployment
[2012-06-26 21:33:00 -0400] jperry2: was cluttering my code
[2012-06-26 21:33:19 -0400] jperry2: meaning "if running chef solo" don't do this
[2012-06-26 21:33:23 -0400] miah: ya
[2012-06-26 21:33:26 -0400] jperry2: I didn't like that
[2012-06-26 21:33:30 -0400] miah: so, lwrp and write_around pattern
[2012-06-26 21:33:38 -0400] jperry2: yeah
[2012-06-26 21:33:40 -0400] miah: er, execute around / execute before
[2012-06-26 21:33:58 -0400] jperry2: I like having a local chef on my machine or sharing the chef server with environments
[2012-06-26 21:34:02 -0400] miah: http://c2.com/cgi/wiki?ExecuteAroundMethod + search / solo check
[2012-06-26 21:34:08 -0400] miah: then you can just call your lwrp method and be happy
[2012-06-26 21:34:11 -0400] jperry2: or you can use hosted chef which you get 5 free nodes
[2012-06-26 21:34:14 -0400] miah: ya
[2012-06-26 21:34:18 -0400] miah: you can do that too =)
[2012-06-26 21:34:33 -0400] jperry2: yeah
[2012-06-26 21:34:38 -0400] miah: there isn't a single way to do this, its going to vary from deployment to deployment. nobody follows the same workflow so.
[2012-06-26 21:34:39 -0400] jperry2: I see chef-hatch
[2012-06-26 21:34:56 -0400] jperry2: but I keep getting failures at the end of a convergence
[2012-06-26 21:35:00 -0400] jperry2: I created an issue on github
[2012-06-26 21:35:04 -0400] jperry2: so we'll see if they fix it
[2012-06-26 21:35:05 -0400] miah: i keep all of my data in git, so switchin between environments/vagrant/hosted/local-server isn't a big deal
[2012-06-26 21:35:08 -0400] jperry2: or can tell me what is wrong
[2012-06-26 21:35:14 -0400] jperry2: yeah same here
[2012-06-26 21:35:35 -0400] miah: its a problem when you start using webui and don't have copies of the changes you just made to nodes/environments/roles/data_bags
[2012-06-26 21:42:40 -0400] swolf_: ugh.  i'm some wierd state.  i could no longer upload my cookbook, got the message "the cookbook has one or more broken files".  tried deleting the cookbook and re-creating, still fails with same error.  tried creating a brand new cookbook and uploading with no changes, and that cookbook gets the same error as well
[2012-06-26 21:45:54 -0400] oddover: I'm having trouble getting syslog to work with chef. I have this in my /etc/chef/solo.rb file: http://pastebin.com/nPbmQ1nQ
[2012-06-26 21:45:56 -0400] oddover: So, shouldn't the log messages be going to /var/log/chef?
[2012-06-26 22:06:56 -0400] miah: no, they go to your syslogger in that case, and they get logged wherever syslog is set up to log them
[2012-06-26 22:07:21 -0400] miah: you could just set log_location to /var/log/chef and get logs written there though
[2012-06-26 22:07:34 -0400] oddover: Yea, that's what I've decided to do :P
[2012-06-26 22:19:16 -0400] qhartman: is there a flag that can be added to a "knife node bulk delete foo" command to have it also delete the clients that match the pattern? Something like "knife node bulk delete foo --clients-too"
[2012-06-26 22:23:41 -0400] pehlert: qhartman: I'd also be interested in that, let me know if you find something
[2012-06-26 22:35:36 -0400] qhartman: pehlert, I've been looking through the docs and I don't think such a thing exists, for now I've just thrown together a script I'm calling "nuke_nodes" that calls one command and then the next in sequence.
[2012-06-26 22:36:31 -0400] qhartman: I just cleaned over 200 orphaned clients out of my chef installation from nodes that have been removed, but whoever was working on them neglected to get the clients as well.
[2012-06-26 22:39:08 -0400] hakunin_: this is the biggest damn not_if block i had to write, to try and fix nginx over-eagerness to recompile on every chef run: https://gist.github.com/2638bffa41e5f7d86e5a /cc miah
[2012-06-26 22:46:08 -0400] miah: wow
[2012-06-26 22:47:46 -0400] miah: there are multiple reasons the nginx cookbook isn't currently idempotent. i haven't really looked at the source.rb, but i'll likely replace it with something similar to: https://github.com/miah/varnish/blob/rhel/recipes/_install_from_source.rb
[2012-06-26 22:48:16 -0400] miah: because that code is easier to follow =)
[2012-06-26 22:48:49 -0400] miah: wow source.rb is fugly in a way that only a blind mother could love
[2012-06-26 22:58:11 -0400] hakunin_: hah'
[2012-06-26 23:24:58 -0400] thehar: is there a reason why in many recipes i see things like: nodes = search(:node, "keys_ssh:* NOT name:#{node.name}") nodes << node ?
[2012-06-26 23:25:14 -0400] thehar: it seems kinda eh to me.. why not just node = search(foo)
[2012-06-26 23:26:02 -0400] qhartman: My ruby foo may not be good enough to interpret that correctly, but it looks like it's concatenating the current node onto the end of the list that the search returns
[2012-06-26 23:26:54 -0400] qhartman: nope, that's not right
[2012-06-26 23:26:57 -0400] qhartman: I got nothin
[2012-06-26 23:27:38 -0400] thehar: that is right but why?
[2012-06-26 23:27:52 -0400] thehar: that search explicitly removes that node name and then adds it to the end
[2012-06-26 23:28:22 -0400] qhartman: not sure, position in the list might matter for what they are doing
[2012-06-26 23:28:41 -0400] qhartman: some more context would help, what cookbook is that from?
[2012-06-26 23:29:17 -0400] thehar: ssh_known_hosts
[2012-06-26 23:31:55 -0400] cwj: my guess is that you want to avoid retrieving stale node object information, since the current state of the local node will be best represented by the node object which has been locally constructed during the run
[2012-06-26 23:31:56 -0400] qhartman: Yeah, it looks like they just wanted to guarantee that the local node would get included in the list, but not have to deal with duplicates.
[2012-06-26 23:32:08 -0400] qhartman: cwj, ah, that's a better reason
[2012-06-26 23:32:19 -0400] cwj: in this context, if your ssh key has changed in this run, you dont want to see the old one
[2012-06-26 23:32:21 -0400] qhartman: good call
[2012-06-26 23:32:21 -0400] thehar: cwj: ah yes
[2012-06-26 23:39:03 -0400] rburton-: re how is everyone
[2012-06-26 23:50:46 -0400] josephholsten: anyone care to review my patch for http://tickets.opscode.com/browse/COOK-1392?
