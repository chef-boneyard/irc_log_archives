[2012-06-24 00:02:40 -0400] hoover_damm: heh pivotal is an interesting company
[2012-06-24 00:02:54 -0400] miah: noon
[2012-06-24 00:03:16 -0400] miah: ah, 12:30
[2012-06-24 00:03:16 -0400] miah: http://www.meetup.com/San-Francisco-DevOps/events/67934962/
[2012-06-24 00:03:43 -0400] hoover_damm: Design Kitchens, Pivotal
[2012-06-24 00:03:44 -0400] hoover_damm: etc
[2012-06-24 00:03:49 -0400] hoover_damm: Hashrocket
[2012-06-24 00:04:16 -0400] hoover_damm: it's a weird problem and a weird solution.
[2012-06-24 00:04:36 -0400] miah: i will be there on time
[2012-06-24 00:04:56 -0400] hoover_damm: miah, you hosting it?
[2012-06-24 00:04:59 -0400] miah: i hope i can somehow sneak through pride. its going to be crazytown.
[2012-06-24 00:05:17 -0400] miah: i am helping host yes.
[2012-06-24 00:05:25 -0400] hoover_damm: ahh looks like James's devops
[2012-06-24 00:05:30 -0400] hoover_damm: with you being cohost
[2012-06-24 00:06:55 -0400] hoover_damm: I should start going to some again
[2012-06-24 00:21:28 -0400] miah: leaving the house is good sometimes.. though its not something i claim to do often =)
[2012-06-24 00:50:31 -0400] yfeldblum: miah, that's what we write robots for
[2012-06-24 00:52:04 -0400] hoover_damm: There's nothing wrong with going out of the house.  That's where you meet people, have a conversation
[2012-06-24 00:52:13 -0400] hoover_damm: make a connection for a moment or two
[2012-06-24 00:52:14 -0400] hoover_damm: and then move on
[2012-06-24 08:18:12 -0400] pehlert: I'd like to generate a few tables in a freshly created postgresql database. Is there a more sophisticated way than using action :query? When I use action :query, I have to ensure that the recipe is run only once because it will obviously fail or delete my data otherwise
[2012-06-24 08:20:24 -0400] tomoj: ideally you'd have action :none in that resource and subscribe it to (or notify it from) the resource that creates the tables
[2012-06-24 08:21:23 -0400] tomoj: (which would require that the resource that creates the tables calls updated_by_last_action properly)
[2012-06-24 08:21:53 -0400] tomoj: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-06-24 08:22:35 -0400] pehlert: tomoj: The resource that creates the database you mean? That sounds incredibly clean, thanks!
[2012-06-24 08:23:07 -0400] tomoj: well, what creates the tables, the query?
[2012-06-24 08:23:43 -0400] pehlert: tomoj: Yes, the query shall create the tables once after the database has been created
[2012-06-24 08:24:10 -0400] tomoj: then, yeah, hopefully whatever resource you have creating the database will work with notifications
[2012-06-24 08:24:27 -0400] tomoj: (I'm almost certain it does)
[2012-06-24 08:24:50 -0400] pehlert: I'm using opscode's official postgresql_database, so it will hopefully work ;-)
[2012-06-24 08:25:12 -0400] tomoj: yeah, my uncertainty was mostly whether you were using that
[2012-06-24 08:25:58 -0400] tomoj: oh s/action :none/action :nothing/
[2012-06-24 08:27:46 -0400] tomoj: then I guess e.g. `subscribes :query, resources("postgresql_database[foo]"), :immediately`
[2012-06-24 08:28:23 -0400] pehlert: I was going to use notifies, but that's probably even a bit nicer
[2012-06-24 08:31:50 -0400] pehlert: I hope you don't mind another question. I have that huge pile of SQL statements in my cookbook now but I think it would be cleaner to have it in a separate file. However when I put it in files/default/setup.sql, the file didn't get cached by Chef because it wasn't used by cookbook_chef (at least that's what I suppose). Is there a way to force caching or a better place to put these asset files?
[2012-06-24 11:47:20 -0400] phunehehe: Hi, I wonder if there is a way to pass a ruby block to a Chef recipe/definition/recipe?
[2012-06-24 11:48:06 -0400] phunehehe: I want to execute some code, then execute that block, then execute some more code
[2012-06-24 11:48:20 -0400] phunehehe: I have been searching and found Ruby blocks
[2012-06-24 11:49:39 -0400] phunehehe: But when I use the "yield" keyword inside a definition, Chef complains "LocalJumpError: no block given"
[2012-06-24 11:52:38 -0400] scrr: hello, can i ask a question about an issue i have with knife here?
[2012-06-24 11:58:55 -0400] railsraider: Hi, I have default['rvm']['group_users']   = ["admin", "root"] in the rvm cookbook and I'm doing a system install only admin get added to the rvm group any idea why?
[2012-06-24 12:03:40 -0400] railsraider: I'm using chef-rvm https://github.com/fnichol/chef-rvm
[2012-06-24 12:15:16 -0400] scrr: somehow my cookbooks are not being found. i can upload a specific one, but the dependencies are not found, even though they are there..
[2012-06-24 12:15:26 -0400] scrr: any idea? i have cookbook_path set in knife.rb
[2012-06-24 12:22:10 -0400] cwj: scrr: you can use knife cookbook upload -a
[2012-06-24 12:22:14 -0400] cwj: to upload all your cookbooks
[2012-06-24 12:22:27 -0400] cwj: otherwise you must upload them individually with knife
[2012-06-24 12:23:10 -0400] scrr: cwj: that worked. however, i am still wondering. i did upload on mysql and it did not find the openssl dependency that is also in the cookbooks folder. i specified -d
[2012-06-24 12:23:18 -0400] scrr: so i wonder if my cookbook_path is correctly set
[2012-06-24 12:23:30 -0400] cwj: gist your knife.rb?
[2012-06-24 12:23:38 -0400] scrr: here's my console output: http://pastebin.com/LxzQRVeK
[2012-06-24 12:23:41 -0400] scrr: knife.rb coming up
[2012-06-24 12:24:30 -0400] scrr: knife.rb: http://pastebin.com/D4ejw6Ki
[2012-06-24 12:25:57 -0400] scrr: according to all examples ive seen this should be right.. hm
[2012-06-24 12:31:56 -0400] cwj: i dont see any obvious problems there
[2012-06-24 12:32:23 -0400] scrr: yeah. oh well, perhaps i can figure it out later. i can use upload -a for now, thanks for the tip.
[2012-06-24 12:32:37 -0400] cwj: i think what you are encountering is one of the annoyances with knife, in that it doesnt try to resolve dependencies itself
[2012-06-24 12:33:02 -0400] cwj: even when you use something like librarian to manage cookbook dependencies, knife can still be a bottleneck
[2012-06-24 12:34:20 -0400] scrr: i see
[2012-06-24 12:35:07 -0400] scrr: can i ask you one more small thing. i have cloned the chef-repo from opscode, but can i just change it to my own repo from now on? so that i can commit/push my cookbook versions to my own repo server.
[2012-06-24 12:36:20 -0400] scrr: i mean: will getting cookbooks from opscode still work then?
[2012-06-24 12:42:51 -0400] cwj: yeah thats fine
[2012-06-24 12:42:58 -0400] cwj: let me give you a tip though
[2012-06-24 12:43:15 -0400] cwj: committing all your cookbooks to a single repo becomes a nightmare pretty fast
[2012-06-24 12:43:44 -0400] scrr: so how do you do it?
[2012-06-24 12:43:51 -0400] scrr: group them by roles or sth?
[2012-06-24 12:44:00 -0400] cwj: i would consider setting up your repo with a tool like librarian (similar in concept to ruby bundler) which lets you develop cookbooks in individual repos
[2012-06-24 12:44:28 -0400] scrr: ah i see. thanks, ill take a look once i have grasped some more of the basics.
[2012-06-24 12:45:56 -0400] cwj: hope that helps :)
[2012-06-24 12:47:47 -0400] scrr: it does, thx :)
[2012-06-24 13:22:05 -0400] railsraider: how do i pass ruby variable into bash block?
[2012-06-24 13:25:01 -0400] railsraider: i wanna do cwd "#{variable}"
[2012-06-24 13:27:05 -0400] railsraider: sorry its working
[2012-06-24 13:50:39 -0400] saschagehlich: hey, I have two roles, "app" and "web", both have the nginx recipe in their run list. I would like to have different nginx recipe attributes for both roles, how can i do that?
[2012-06-24 13:51:27 -0400] scrr: quick question: i have a mysql recipe deployed, how do i add extra mysql users? config the mysql recipe somehow or make another recipe that adds my users?
[2012-06-24 13:51:28 -0400] saschagehlich: well, i could copy the nginx recipe to nginx_web and change the attributes, but is there an easier and cleaner way?
[2012-06-24 14:20:46 -0400] ashb: scrr: i added another receipe thatdid it
[2012-06-24 14:21:28 -0400] ashb: saschagehlich: for me the nginx receipe just installed the base server then I have another receipe which puts the vhost config template for each app
[2012-06-24 14:21:49 -0400] saschagehlich: ashb: okay, that's what i did now. thank you :)
[2012-06-24 14:32:13 -0400] yfeldblum: railsraider, you could of course just write `cwd variable` - no need to interpolate in this particular case
[2012-06-24 14:32:26 -0400] railsraider: thanks
[2012-06-24 14:33:43 -0400] scrr: ashb: thx :)
[2012-06-24 14:34:15 -0400] railsraider: i also have rvm system install, but rvm requires rvm group to be added to each user before that user can use it, is there any way i can either login as another sure from the chef-run or refresh groups without logging out and login back in ?
[2012-06-24 14:37:39 -0400] railsraider: is there a way to explicitly tell a cookbook to run as a different user?
[2012-06-24 14:38:22 -0400] railsraider: maybe i should wrap the whole recipe in execute block?
[2012-06-24 14:42:22 -0400] yfeldblum: railsraider, just use the `group` resource?
[2012-06-24 14:43:17 -0400] railsraider: yfeldblum:  the rvm cookbook adds the rvm group using that resource but i don;t think its applied until you log out and log back in
[2012-06-24 14:43:46 -0400] yfeldblum: railsraider, all resources are converged during the converge phase
[2012-06-24 14:43:56 -0400] railsraider: meaning?
[2012-06-24 14:55:58 -0400] yfeldblum: railsraider, hmmm are you talking about on a workstation, where a user who needs RVM has to log out and log in again after the user account was added to the RVM group in order to start using RVM?
[2012-06-24 14:57:25 -0400] railsraider: yfeldblum: rum system - installs rvm into /usr/local/rvm after that any user on the server can be added to use rvm just by adding that user to the group rvm, adding a user to a group usually does not take affect until logout and log back in
[2012-06-24 16:05:43 -0400] rayrod2030: anybody have any luck with getting chef to restart tomcat properly with an init script?
[2012-06-24 16:13:38 -0400] leifmadsen: btm: ping
[2012-06-24 16:14:20 -0400] leifmadsen: btm: sorry, disregard
[2012-06-24 16:37:10 -0400] _alpha_: hi all, is there any way to stop the apt recipe from downloading the public key for a repo every time it runs? this is what I am doing at the moment: https://gist.github.com/2983928
[2012-06-24 16:37:27 -0400] _alpha_: but this frequently results in errors like this: https://gist.github.com/2983930
[2012-06-24 16:50:07 -0400] cwj: _alpha_: if you look at the the apt_repository provider source code you will see that it checks the output of 'apt-key list' for the key you have specified, so it should only try to add the key if it isnt already there
[2012-06-24 16:50:11 -0400] cwj: source here https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb
[2012-06-24 16:50:42 -0400] cwj: so combined with the error output you've provided, it seems that the key ID you have provided isn't valid
[2012-06-24 16:51:05 -0400] cwj: which would cause it to try (and fail) to retrieve the key every time chef runs
[2012-06-24 16:52:08 -0400] _alpha_: weird thing is the error is infrequent
[2012-06-24 16:52:18 -0400] _alpha_: I just ran chef-client manually and that key part worked fine
[2012-06-24 16:52:46 -0400] _alpha_: I'll dig through the apt recipe some more
[2012-06-24 16:54:17 -0400] _alpha_: here was the output from the successful run: https://gist.github.com/2983966
[2012-06-24 16:58:59 -0400] cwj: if you run apt-key list | grep 1C4CBDCDCD2EFD2A on the system where it has successfully completed, do you see any matches?
[2012-06-24 16:59:42 -0400] cwj: its possible that it installing the key is failing but still exiting with return code 0
[2012-06-24 17:00:01 -0400] cwj: which will cause chef to infer that the command was successful
[2012-06-24 17:00:47 -0400] _alpha_: no nothing with that key, but if I just run apt-key list, the percona key is there
[2012-06-24 17:00:54 -0400] _alpha_: and the output looks like this: pub   1024D/CD2EFD2A 2009-12-15
[2012-06-24 17:01:03 -0400] _alpha_: so just part of the key
[2012-06-24 17:01:52 -0400] cwj: ok, i would use just that part of the key instead of the full string
[2012-06-24 17:02:15 -0400] ashb: there's a percona-server recipe ine the mysql cookbook btw
[2012-06-24 17:02:16 -0400] cwj: the CD2EFD2A
[2012-06-24 17:02:40 -0400] ashb: okay no there isn't
[2012-06-24 17:02:43 -0400] ashb: i guess I wrote it myself
[2012-06-24 17:02:52 -0400] _alpha_: heh
[2012-06-24 17:03:18 -0400] cwj: :D
[2012-06-24 17:03:22 -0400] ashb: https://gist.github.com/2984005
[2012-06-24 17:03:24 -0400] _alpha_: will try with the shorterned key
[2012-06-24 17:03:32 -0400] ashb: use the apt_repository provider
[2012-06-24 17:03:46 -0400] ashb: it handles getting the key and putting hte sources.d/FOO in place too
[2012-06-24 17:03:53 -0400] ashb: (line 6-12)
[2012-06-24 17:04:13 -0400] cwj: ashb: _alpha_ is already using that provider
[2012-06-24 17:04:50 -0400] ashb: ah. wonder what's not working right
[2012-06-24 17:05:02 -0400] cwj: the key ID they are using is "too good"
[2012-06-24 17:05:17 -0400] ashb: Error 602 works on my machine
[2012-06-24 17:05:58 -0400] ashb: oh it just always executes apt-keyt adv --ks --recv
[2012-06-24 17:06:11 -0400] cwj: 'apt-key list' shows truncated key IDs
[2012-06-24 17:06:36 -0400] ashb: yeah - the version of the apt_repo provider doesn't do any conditional - it always just runs the apt-key fetch command
[2012-06-24 17:07:29 -0400] cwj: well thats not true of the version on github
[2012-06-24 17:07:42 -0400] cwj: https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb#L22
[2012-06-24 17:07:43 -0400] ashb: yeah mine's probably a few months old
[2012-06-24 17:09:55 -0400] ashb: sudo apt-key adv -k 1C4CBDCDCD2EFD2A > /dev/null; echo $?
[2012-06-24 17:09:55 -0400] ashb: 90
[2012-06-24 17:09:57 -0400] ashb: 0 even
[2012-06-24 17:10:04 -0400] ashb: sudo apt-key adv -k 1C4CBDCDCD2EFD2B > /dev/null; echo $?
[2012-06-24 17:10:05 -0400] ashb: 2
[2012-06-24 17:10:22 -0400] ashb: _alpha_: ^^
[2012-06-24 17:12:38 -0400] _alpha_: gpg: error reading key: public key not found
[2012-06-24 17:12:51 -0400] ashb: _alpha_: for which id?
[2012-06-24 17:14:54 -0400] _alpha_: actually, typo in what I entered there
[2012-06-24 17:15:00 -0400] _alpha_: that actually gives 0 for both
[2012-06-24 17:15:04 -0400] ashb: _alpha_: other option is sudo apt-key adv -k --keyid-format=long | grep #{key}
[2012-06-24 17:15:07 -0400] _alpha_: what should it do?
[2012-06-24 17:15:20 -0400] ashb: for me it gives exitcode 2 for a key that isn't in the chain
[2012-06-24 17:16:05 -0400] _alpha_: with keyid-format=long I get: pub   1024D/1C4CBDCDCD2EFD2A 2009-12-15
[2012-06-24 17:16:17 -0400] ashb: which should match for the grep
[2012-06-24 17:16:43 -0400] _alpha_: so are you suggesting I alter the apt recipe so it uses that instead?
[2012-06-24 17:16:52 -0400] _alpha_: when checking whether the key exists
[2012-06-24 17:17:23 -0400] ashb: _alpha_: its that or set the key using the shortform of the key id
[2012-06-24 17:17:33 -0400] ashb: key "1024D/CD2EFD2A"
[2012-06-24 17:17:38 -0400] ashb: no idea if that actually works though
[2012-06-24 17:18:55 -0400] cwj: key "CD2EFD2A"
[2012-06-24 17:20:27 -0400] _alpha_: yeah that's what I just tried, seems ok but I guess I'd need to remove the repo from the server to test it properly
[2012-06-24 17:22:14 -0400] cwj: i dont know what the right term is for the shorter key ID, but i have used those successfully with the apt_repository resource in a number of recipes
[2012-06-24 17:23:02 -0400] _alpha_: only thing that concerns me is that the percona docs - http://www.percona.com/doc/percona-server/5.5/installation/apt_repo.html - seem to do something with both forms
[2012-06-24 17:25:08 -0400] cwj: how obnoxious :)
[2012-06-24 17:25:23 -0400] ashb: passingthe shorter form to fetch does get the right key
[2012-06-24 17:25:42 -0400] ashb: i guess its just theoreitcally possible to clash or some such (but then I don't know what the outout of list would say anyway
[2012-06-24 17:25:50 -0400] hoover_damm: 1C4CBDCDCD2EFD2A is the key you'd want
[2012-06-24 17:25:56 -0400] hoover_damm: if your having issues with fetching the right key
[2012-06-24 17:26:01 -0400] hoover_damm: your aws cookbook is old likely
[2012-06-24 17:26:18 -0400] ashb: you can pass the longform key to --export
[2012-06-24 17:26:24 -0400] ashb: so I don't know why they don't do that there
[2012-06-24 17:27:08 -0400] hoover_damm: https://github.com/miah/percona-install
[2012-06-24 17:27:11 -0400] hoover_damm: also should do that
[2012-06-24 17:27:14 -0400] hoover_damm: all for you
[2012-06-24 17:27:42 -0400] ashb: hoover_damm: the problem was https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb#L22
[2012-06-24 17:27:44 -0400] hoover_damm: looks like it needs the apt love is all
[2012-06-24 17:27:49 -0400] ashb: doesn't DTRT when you specify the long form key
[2012-06-24 17:27:59 -0400] hoover_damm: ahh
[2012-06-24 17:28:24 -0400] _alpha_: yeah I'm trying to prevent it fetching the key on every chef run, as it sometimes errors
[2012-06-24 17:29:00 -0400] _alpha_: and we have a system in place that emails the team if a chef run fails, and we have 8 MySQL servers...
[2012-06-24 17:32:02 -0400] _alpha_: I've changed the apt recipe to check the long format instead so hopefully that will solve the problem
[2012-06-24 18:02:18 -0400] _alpha_: all seems to work btw, thanks all
[2012-06-24 18:52:46 -0400] sawyer_: i want to install a .deb package but both dpkg_package and package fail for me
[2012-06-24 18:53:24 -0400] sawyer_: so i tried to install via "command" using "dpkg -i" but chef puts me in "/" directory
[2012-06-24 18:53:42 -0400] sawyer_: i'm trying to find an attribute that tells me where my files are, so i won't have to hardcore the path to the .deb files
[2012-06-24 18:53:44 -0400] sawyer_: anyone at all?
[2012-06-24 18:56:31 -0400] vegardx: sawyer_: http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-06-24 18:58:24 -0400] sawyer_: vegardx, thank you. are you suggesting i use that to copy the file from it's "cookbook/files/" location to somewhere else to install from?
[2012-06-24 18:58:49 -0400] vegardx: sawyer_: yeah, it might not be the best way, but that's how I do it
[2012-06-24 18:59:01 -0400] vegardx: There probably is better ways to do it :)
[2012-06-24 19:00:18 -0400] sawyer_: vegardx, hmm.. i'm basically just looking for a way to tell my execute command where the "cookbook/files/" directory is, and to get the file from there
[2012-06-24 19:00:39 -0400] sawyer_: apparently the "package" and "dpkg_package" commands do not appreciate me having my own kernel that is of a different version than in the repo :(
[2012-06-24 19:21:47 -0400] railsraider: I'm trying to do bundle install with a script block with user admin, i can see i have bundle, but chef-client complains bundle: command not found
[2012-06-24 19:37:54 -0400] leifmadsen: does anyone here have experience using minitest spec? I have been unable to use the .with stuff on either CentOS or Ubuntu without it failing due to a TypeError
[2012-06-24 20:05:07 -0400] railsraider: i have this command /usr/local/rvm/gems/ree-1.8.7-2012.02@global/bin/bundle install --deployment  and its working fine on the server but fail with chef-run
[2012-06-24 20:05:46 -0400] railsraider: i get the error: /usr/bin/env: ruby_noexec_wrapper: No such file or directory
[2012-06-24 20:17:57 -0400] cakehero: Deos chef re-run all recipes each time you run chef? (I'm using Chef-solo if that makes a difference)
[2012-06-24 20:22:39 -0400] JasonBoxLaptop: cakehero: Yeah
[2012-06-24 20:22:56 -0400] coderanger: Okay lazyweb, what info do You want to see in the MotD of a server using Chef?
[2012-06-24 20:22:58 -0400] cakehero: JasonBoxLaptop thanks
[2012-06-24 20:23:35 -0400] cakehero: JasonBoxLaptop is there a way to balance running a zillion scripts and automating server provisioning with Chef? right now Chef installs many system packages that it has to check for each time I make even a minor update
[2012-06-24 20:23:51 -0400] cakehero: so lets say I fix a typo on a static page and I want to push that change
[2012-06-24 20:24:08 -0400] cakehero: I don't necessarily want Chef to check that all the system packages were installed (or do i?)
[2012-06-24 20:26:40 -0400] JasonBoxLaptop: Well, the basic philosophy I think is that you do
[2012-06-24 20:27:19 -0400] JasonBoxLaptop: But if you just want to run a single recipe one time and then go back to the default run_list you're using, I think the latest chef includes a way to override the run_list for a single run
[2012-06-24 20:30:29 -0400] cakehero: JasonBoxLaptop interesting, maybe a first-time and then each-time runlist?
[2012-06-24 20:30:33 -0400] cakehero: something to that effect?
[2012-06-24 20:32:57 -0400] cakehero: Do you / should you use Capistrano in conjunction with Chef or does Chef completely replace it?
[2012-06-24 20:35:35 -0400] setient: chef is something different
[2012-06-24 20:35:39 -0400] setient: capistrano is for deploying code
[2012-06-24 20:35:48 -0400] setient: and aplications written in ruby though you can use it for other things too
[2012-06-24 20:36:12 -0400] coderanger: Capistrano is a scripted SSH client
[2012-06-24 20:39:33 -0400] cakehero: So I shouldn't consider my web application part of the infrastructure and should leave that in Capistrano?
[2012-06-24 20:40:12 -0400] coderanger: Thats up to you
[2012-06-24 20:40:23 -0400] cakehero: Any best practices I could refer to?
[2012-06-24 20:40:27 -0400] cakehero: or information on how to decide?
[2012-06-24 20:40:32 -0400] coderanger: Seems odd to not manage app deployment via the same system you use for everything else
[2012-06-24 20:40:42 -0400] coderanger: cakehero: Not really, its a matter of what works for you
[2012-06-24 20:41:30 -0400] cakehero: So I would write a recipe for my application if I wanted it to be considered part of the infrastructure for Chef
[2012-06-24 20:42:10 -0400] coderanger: Yes, if you are talking about cap you are probably using Rails?
[2012-06-24 20:42:20 -0400] cakehero: I think it's Sintra
[2012-06-24 20:42:23 -0400] cakehero: *Sinatra
[2012-06-24 20:42:45 -0400] coderanger: Same difference, check out the application_ruby cookbook
[2012-06-24 20:42:47 -0400] cakehero: If you are asking there must be some rails recipes or templates ?
[2012-06-24 20:42:51 -0400] cakehero: okay, awesome
[2012-06-24 20:43:19 -0400] cakehero: thank you coderanger
[2012-06-24 20:43:34 -0400] cakehero: grabbing some food, brb
[2012-06-24 20:43:48 -0400] cakehero: If I can get by the gay pride parade directly outside my door
[2012-06-24 20:44:25 -0400] erikh: George Takei was at that!
[2012-06-24 20:45:30 -0400] leifmadsen: cakehero: Toronto?
[2012-06-24 20:45:50 -0400] erikh: there's one in NYC going on today as welll
[2012-06-24 20:47:36 -0400] leifmadsen: ah gotcha
[2012-06-24 20:47:40 -0400] leifmadsen: I just assumed Toronto :)
[2012-06-24 20:47:54 -0400] leifmadsen: not sure if Toronto's is this weekend or not to be honest
[2012-06-24 20:51:06 -0400] danderson: I have a problem with remote_directory on chef 10.12.0 - It seems to be ignoring file specificity, despite the docs saying it should obey
[2012-06-24 20:51:08 -0400] erikh: oh is it going on here too?
[2012-06-24 20:51:14 -0400] danderson: specifically: https://bitbucket.org/danderson/palace/src/f74e633c974b/cookbooks/network
[2012-06-24 20:51:32 -0400] danderson: this recipe has a default/rules.d remote_directory, and professorx.natulte.net/rules.d/ to override.
[2012-06-24 20:51:43 -0400] danderson: however, the node professorx.natulte.net still only picks up the contents of default.
[2012-06-24 20:52:02 -0400] danderson: what am I doing wrong?
[2012-06-24 21:02:53 -0400] miah: a. that url requires a login.
[2012-06-24 21:03:32 -0400] leifmadsen: jperry2: ping
[2012-06-24 21:03:53 -0400] hoover_damm: danderson, 403
[2012-06-24 21:03:58 -0400] hoover_damm: miah, it's actually private
[2012-06-24 21:04:12 -0400] hoover_damm: miah, it's just bitbucket allowing you to login ... and obviously your not a bitbucket user
[2012-06-24 21:04:16 -0400] danderson: ah, sorry, one second.
[2012-06-24 21:04:22 -0400] miah: ya. i dont use bitbucket.
[2012-06-24 21:04:24 -0400] hoover_damm: reminds me to clean up my bitbucket account
[2012-06-24 21:04:26 -0400] hoover_damm: thanks danderson :)
[2012-06-24 21:04:36 -0400] danderson: miah: should be public now
[2012-06-24 21:04:38 -0400] danderson: hoover_damm: ^
[2012-06-24 21:05:00 -0400] hoover_damm: danderson, k
[2012-06-24 21:05:24 -0400] hoover_damm: oh remote_directory
[2012-06-24 21:08:08 -0400] hoover_damm: danderson, http://lists.opscode.com/sympa/arc/chef/2010-10/msg00121.html
[2012-06-24 21:08:13 -0400] hoover_damm: that thread looks slightly relevent
[2012-06-24 21:09:50 -0400] danderson: hmm, that looks different
[2012-06-24 21:10:05 -0400] danderson: someone wanting to list all directories relevant to a given host
[2012-06-24 21:10:16 -0400] danderson: I just want file specificity to work as documented :P
[2012-06-24 21:10:39 -0400] danderson: unless I've misread how that works.
[2012-06-24 21:11:20 -0400] danderson: gaaah, I fail at reading.
[2012-06-24 21:11:27 -0400] danderson: "The host- is literal. If your host was foo.example.com, then your folder needs to be named host-foo.example.com."
[2012-06-24 21:12:27 -0400] hoover_damm: ahh
[2012-06-24 21:12:29 -0400] hoover_damm: yep :)
[2012-06-24 21:13:23 -0400] hoover_damm: miah, I pretend to not care about what I use for storing my files and just use whatever works at the time
[2012-06-24 21:13:27 -0400] danderson: yeah, this just in: following instructions makes stuff work more better.
[2012-06-24 21:13:36 -0400] danderson: thanks for looking though :)
[2012-06-24 21:13:39 -0400] hoover_damm: I've used mercurial a bit
[2012-06-24 21:13:45 -0400] hoover_damm: danderson, that they do.
[2012-06-24 21:16:58 -0400] hoover_damm: miah, besides I don't host everything on github.  Github is just a fashion statement.
[2012-06-24 21:17:06 -0400] hoover_damm: don't be the last person in line once it falls out of fashion
[2012-06-24 21:18:10 -0400] leifmadsen: if anyone is familiar with minitest, (and I think this issue is a ruby implementation bug), I'd appreciate any eyes on https://github.com/calavera/minitest-chef-handler/issues/23
[2012-06-24 21:20:11 -0400] cakehero: leifmadsen yeah, NYC
[2012-06-24 21:20:25 -0400] cakehero: leifmadsen and I was able to make it more than 30 ft from my door, but, not to the convenience store, heh
[2012-06-24 21:21:13 -0400] cakehero: Can I run multiple chef-solo installations on one machine?
[2012-06-24 21:21:16 -0400] leifmadsen: since I'm new to ruby, any suggestions on debugging (adding debug information so it outputs on a knife ssh run) to the /usr/lib64/ruby/gems/1.8/gems/minitest-chef-handler-0.5.1/lib/minitest-chef-handler/resources.rb file
[2012-06-24 21:21:30 -0400] leifmadsen: cakehero: sorry to hear that... I want a chocolate bar now
[2012-06-24 21:21:53 -0400] cakehero: leifmadsen you can have steamed rice in 50 minutes because that's all I've got
[2012-06-24 21:21:59 -0400] cakehero: perhaps with some eggs, egg fried rice
[2012-06-24 21:22:02 -0400] leifmadsen: :(
[2012-06-24 21:22:08 -0400] hoover_damm: ugh looking at minitest-chef-handler
[2012-06-24 21:22:10 -0400] cakehero: THEY CANT DELIVER IT!
[2012-06-24 21:22:10 -0400] hoover_damm: gives me migranes
[2012-06-24 21:22:14 -0400] hoover_damm: reminds me of my old job
[2012-06-24 21:22:15 -0400] leifmadsen: hoover_damm: ya :(
[2012-06-24 21:22:23 -0400] hoover_damm: prolly cuz calavera has my old job
[2012-06-24 21:22:24 -0400] hoover_damm: lol
[2012-06-24 21:22:36 -0400] leifmadsen: hoover_damm: it has such promise, and I have a friend that uses it all the time, but I don't understand how
[2012-06-24 21:22:38 -0400] hoover_damm: so I can totally grok how to use minitest-chef-handler
[2012-06-24 21:22:46 -0400] leifmadsen: anything in the with define seems to fail
[2012-06-24 21:22:50 -0400] hoover_damm: yep
[2012-06-24 21:23:14 -0400] leifmadsen: although I have no idea why... and it's not ruby version dependent
[2012-06-24 21:23:35 -0400] hoover_damm: make sure you use 1.9.x
[2012-06-24 21:23:44 -0400] hoover_damm: if your on 1.8.x you'll find certain failures in life
[2012-06-24 21:23:45 -0400] leifmadsen: well I tried 1.9.1 as well, and no different
[2012-06-24 21:23:50 -0400] leifmadsen: and 1.9.3
[2012-06-24 21:24:04 -0400] leifmadsen: same issue, so that seems to point to it not being a ruby bug itself
[2012-06-24 21:24:05 -0400] hoover_damm: honestly looking at this, I don't see anything about 'with'
[2012-06-24 21:24:07 -0400] hoover_damm: specific
[2012-06-24 21:24:28 -0400] leifmadsen: hoover_damm: if I use the same test, but drop anythign with .with on the end, it passes
[2012-06-24 21:24:29 -0400] leifmadsen: so....
[2012-06-24 21:24:38 -0400] leifmadsen: file ("/etc/password").must_exist
[2012-06-24 21:24:40 -0400] leifmadsen: passed
[2012-06-24 21:24:57 -0400] leifmadsen: file ("/etc/password").must_exist.with(:owner, "root")
[2012-06-24 21:25:01 -0400] leifmadsen: fails with TypeError
[2012-06-24 21:25:54 -0400] hoover_damm: .must_have(:owner
[2012-06-24 21:26:02 -0400] hoover_damm: file("/usr/local/foo_dump/foo1.txt").must_have(:owner, "foobarbaz").and(:group, "foobarbaz")
[2012-06-24 21:26:03 -0400] leifmadsen: that's just an alias....
[2012-06-24 21:26:11 -0400] hoover_damm: does must_have work?
[2012-06-24 21:26:14 -0400] hoover_damm: out of curiosity
[2012-06-24 21:26:17 -0400] leifmadsen:         alias :must_have :with
[2012-06-24 21:27:26 -0400] hoover_damm: leifmadsen, he'll get to your bug or someone else will
[2012-06-24 21:27:42 -0400] leifmadsen: yep I just got a response 1 minute ago
[2012-06-24 21:27:44 -0400] leifmadsen: testing now
[2012-06-24 21:28:14 -0400] hoover_damm: oh yeah that owner thing
[2012-06-24 21:28:16 -0400] hoover_damm: lol
[2012-06-24 21:28:39 -0400] hoover_damm: wasn't 0.10.12 released a few days ago?
[2012-06-24 21:28:41 -0400] hoover_damm: ;)
[2012-06-24 21:28:46 -0400] leifmadsen: yes ;)
[2012-06-24 21:28:56 -0400] leifmadsen: I tested on 0.10.10 too though
[2012-06-24 21:29:04 -0400] hoover_damm: glad I don't have that job anymore
[2012-06-24 21:29:09 -0400] leifmadsen: heh
[2012-06-24 21:29:50 -0400] hoover_damm: It's a different mindset trying to create Chef cookbooks for a Platform and for the masses
[2012-06-24 21:30:25 -0400] hoover_damm: reaching out to users like in irc is pretty easy.  It's the people who want to use Chef and are fobic of irc and don't know how to use lists
[2012-06-24 21:30:41 -0400] leifmadsen: I <3 me some irc
[2012-06-24 21:30:53 -0400] hoover_damm: yeah I even bug my sales guy at voxel on irc
[2012-06-24 21:30:54 -0400] atomic-penguin: fobic?
[2012-06-24 21:30:57 -0400] leifmadsen: usually by the time I use a mailing list and follow it I've either figured it out or moved on :)
[2012-06-24 21:30:59 -0400] miah: herp
[2012-06-24 21:31:01 -0400] atomic-penguin: Ah phobic
[2012-06-24 21:31:05 -0400] leifmadsen: heh
[2012-06-24 21:31:27 -0400] hoover_damm: if only I was that lucky
[2012-06-24 21:31:34 -0400] hoover_damm: voxel is internap
[2012-06-24 21:31:41 -0400] hoover_damm: just a big managed / colo
[2012-06-24 21:31:45 -0400] cakehero: JasonBoxLaptop found the override-runlist option - thanks
[2012-06-24 21:31:53 -0400] hoover_damm: they host softlayer and others
[2012-06-24 21:31:58 -0400] leifmadsen: hoover_damm: perhaps I know someone who has worked there then
[2012-06-24 21:32:08 -0400] hoover_damm: I drop about 1M metrics to graphite on Voxel
[2012-06-24 21:32:14 -0400] hoover_damm: well I burst up to 1M
[2012-06-24 21:32:24 -0400] hoover_damm: I wish that was my constant ... I'd feel better then
[2012-06-24 21:32:39 -0400] hoover_damm: leifmadsen, that is possible
[2012-06-24 21:33:42 -0400] hoover_damm: miah, btw you can host git repos on bitbucket
[2012-06-24 21:34:24 -0400] hakunin: kind of dumb, but... how do I override nginx cookbook's attributes in my own recipe?
[2012-06-24 21:34:57 -0400] hakunin: i've been using solo for a bit but never had to override recipes, and after reading everything out there i still can't get damn attributes to override
[2012-06-24 21:35:21 -0400] hakunin: override attributes i mean
[2012-06-24 21:36:07 -0400] hoover_damm: https://bitbucket.org/damm/postgresql
[2012-06-24 21:36:10 -0400] hoover_damm: damn that's easy
[2012-06-24 21:36:49 -0400] hakunin: hoover_damm: are you this guy? https://github.com/damm
[2012-06-24 21:38:27 -0400] miah: hoover_damm: ya. i still dont care about bitbucket =)
[2012-06-24 21:39:03 -0400] miah: https://github.com/miah/varnish/blob/rhel/recipes/_install_from_source.rb
[2012-06-24 21:39:08 -0400] miah: my code fails for some reason :/
[2012-06-24 21:39:32 -0400] miah: https://gist.github.com/ec9816598f8d6c383f25
[2012-06-24 21:39:47 -0400] miah: i think ark is reformatting my download url or i did something really derpy
[2012-06-24 21:41:03 -0400] z: wtf bitbucket still exists despite GitHub
[2012-06-24 21:41:06 -0400] hoover_damm: miah, you have a issue with doing creates on execute?
[2012-06-24 21:41:19 -0400] miah: the url is being formatted incorrectly
[2012-06-24 21:41:33 -0400] miah: line 4 :/
[2012-06-24 21:41:37 -0400] hoover_damm: miah, basically the reason I avoid ark and things like that is they end up breaking on me or cause me more time
[2012-06-24 21:41:45 -0400] hoover_damm: then it takes to write up a shitty recipe
[2012-06-24 21:42:09 -0400] miah: you can say that about any library though =)
[2012-06-24 21:42:13 -0400] hoover_damm: I do
[2012-06-24 21:42:21 -0400] hoover_damm: I'm very 3rd party library fobic
[2012-06-24 21:42:29 -0400] miah: yup
[2012-06-24 21:42:34 -0400] hoover_damm: having worked for Engine Yard there's a reason to be weary of libraries
[2012-06-24 21:42:39 -0400] miah: lol
[2012-06-24 21:43:01 -0400] hoover_damm: you can do some batshit code DRY'ing with libraries
[2012-06-24 21:43:07 -0400] hoover_damm: it'll look super duper perty on the outside
[2012-06-24 21:43:12 -0400] hoover_damm: and be nothing but derp on the in
[2012-06-24 21:43:21 -0400] miah: ya. the ark code is pretty clean though
[2012-06-24 21:43:27 -0400] hakunin: is there a way i can include_recipe "nginx" and then override some of the attributes in it, then have it run?
[2012-06-24 21:43:59 -0400] hoover_damm: all the best intentions in the world by someone else can never cure my best intentions
[2012-06-24 21:44:13 -0400] leifmadsen: hoover_damm: heh looks like the issues might end up being in chef and the values (or lack thereof) being returns on these methods
[2012-06-24 21:44:20 -0400] hoover_damm: that's why I ended up going back to packages
[2012-06-24 21:44:47 -0400] hoover_damm: for redis it's a slore worth doing
[2012-06-24 21:45:08 -0400] hoover_damm: redis churns out so many releases it makes any package maintainer shake his fists of rage
[2012-06-24 21:45:33 -0400] hoover_damm: hakunin, yeah I am
[2012-06-24 21:45:58 -0400] miah: hakunin: you can override the attributes in a cookbook/recipe by using roles / environments
[2012-06-24 21:46:23 -0400] hoover_damm: as I used 'damm' to work with engine yard customers on irc for 2 years.  I opted to change my nickname when I left
[2012-06-24 21:46:25 -0400] hakunin: hoover_damm: reason I asked was because i'm using your unicorn recipe, thanks for throwing it out there
[2012-06-24 21:46:26 -0400] miah: attributes?
[2012-06-24 21:46:26 -0400] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-06-24 21:46:47 -0400] hoover_damm: hakunin, :) It's something I worked hard on at Engine YArd
[2012-06-24 21:46:56 -0400] hoover_damm: so I was very proud to bring it out
[2012-06-24 21:47:28 -0400] hakunin: miah: so just roles/envs? no way to do it in a recipe?
[2012-06-24 21:47:29 -0400] hoover_damm: Unicorn is only scary when you don't have the time to read the code
[2012-06-24 21:47:29 -0400] miah: whenever i read 'damm' i think about that old punk song.. 'drunk drivers against mad mothers'
[2012-06-24 21:47:44 -0400] hoover_damm: miah, I think they wrote that song about me
[2012-06-24 21:47:47 -0400] miah: lol
[2012-06-24 21:48:04 -0400] miah: http://www.youtube.com/watch?v=VOuK1EZKsoQ
[2012-06-24 21:48:15 -0400] hoover_damm: I was an impressionable youth
[2012-06-24 21:48:17 -0400] hoover_damm: lol
[2012-06-24 21:48:46 -0400] hakunin: hoover_damm: quick q about that: why do I always see unix sockets used by default instead of tcp when it comes to unicorn? I thought it makes sense that tcp should be setup for easier app scaling.
[2012-06-24 21:49:06 -0400] hoover_damm: hakunin, unix sockets make sense if your datasent is under 4kb
[2012-06-24 21:49:10 -0400] hoover_damm: otherwise you should be using tcp sokets
[2012-06-24 21:49:27 -0400] hakunin: i mean, app would be spread among >1 machine
[2012-06-24 21:49:29 -0400] hoover_damm: hakunin, it's actually one of the most misunderstood things about scaling
[2012-06-24 21:49:45 -0400] hoover_damm: hakunin, unix sockets have a buffer size of 4-8kb generally
[2012-06-24 21:49:57 -0400] hoover_damm: hakunin, so if your sending 256k of html... you are buffering a lot to get that out of that unix socket
[2012-06-24 21:50:05 -0400] hoover_damm: hakunin, where as a tcp socket, the tcp window autoscales
[2012-06-24 21:50:33 -0400] hoover_damm: hakunin, I absolutely suggest using TCP sockets whenenver possible unless you are doing an pure API app that your datasent/recieved is under 4kb
[2012-06-24 21:50:56 -0400] hoover_damm: and do remember, you can listen to 2 different sources
[2012-06-24 21:51:02 -0400] hoover_damm: both unix socket and tcp port
[2012-06-24 21:51:03 -0400] hakunin: hoover_damm: that's intersting, and only supports my surprise at seeing unix socket used in _every single example, tutorial, and recipe_ that i come by
[2012-06-24 21:51:06 -0400] hoover_damm: both work on 0downtime deploy
[2012-06-24 21:51:20 -0400] hakunin: yeah i found that out
[2012-06-24 21:51:22 -0400] hoover_damm: did I leave unix soket up as the default?
[2012-06-24 21:51:43 -0400] hoover_damm: oh i didn't
[2012-06-24 21:51:44 -0400] hoover_damm: :)
[2012-06-24 21:51:59 -0400] c_t: I tested tcp vs. unix socket with memcached some time ago
[2012-06-24 21:52:01 -0400] hoover_damm: but it would work both as that
[2012-06-24 21:52:08 -0400] c_t: and found there wasn't a significant difference
[2012-06-24 21:52:18 -0400] hoover_damm: c_t, did you read what i said about 4-8kb?
[2012-06-24 21:52:19 -0400] hakunin: hoover_damm: you're listening on tcp yeah
[2012-06-24 21:52:31 -0400] c_t: (this would be stuff bigger than 4-8kb)
[2012-06-24 21:52:37 -0400] c_t: hoover_damm: yeah, I saw that
[2012-06-24 21:52:40 -0400] hoover_damm: then memcached is doing it wrong
[2012-06-24 21:52:50 -0400] hoover_damm: hakunin, you can tune it to do both
[2012-06-24 21:53:01 -0400] hakunin: hoover_damm: yeah but there's no need
[2012-06-24 21:53:14 -0400] hoover_damm: nope.  TCP Ports are more useful
[2012-06-24 21:53:27 -0400] hoover_damm: disable syncookies btw
[2012-06-24 21:53:27 -0400] c_t: hoover_damm: I should qualify that further to say that this was testing with full HTML pages stored in memcached, so they'd generally be over that size
[2012-06-24 21:54:02 -0400] hakunin: hoover_damm: i imagine that for staging machine that plays all the roles i don't care about slight loopback overhead, and for anything else i'd rather be ready to scale-out the apps
[2012-06-24 21:54:22 -0400] c_t: it's been a while so I don't remember the details, but I do know I went for tcp socket in this case
[2012-06-24 21:56:20 -0400] hakunin: miah: so no way to do it from a recipe?
[2012-06-24 21:56:32 -0400] hoover_damm: hakunin, https://gist.github.com/2eebde1b3a4c46dd3abd
[2012-06-24 21:56:41 -0400] hoover_damm: hakunin, something like that for a nginx config file
[2012-06-24 21:56:42 -0400] miah: why do you want to do it in a recipe? you can.. but that doesn't mean you should =)
[2012-06-24 21:57:58 -0400] hoover_damm: hakunin, well the loopback overhead isn't that big of a deal... you just should disable syncookies as the kernel built in synflood protection will eventually make you fail at scaling
[2012-06-24 21:58:06 -0400] hoover_damm: happens no matter what
[2012-06-24 21:58:22 -0400] hoover_damm: TCP: Possible SYN flooding on port 25. Dropping request.  Check SNMP counters.
[2012-06-24 21:58:28 -0400] hoover_damm: for example
[2012-06-24 21:58:54 -0400] hoover_damm: horrible to go down because the kernel thinks your being flooded
[2012-06-24 21:59:05 -0400] hakunin: miah: i run chef-solo via roundsman that simply provides all the capistrano-set variables as attributes. i am not sure if it does anything like loading environment,roles, because i do roles management in capistrano.
[2012-06-24 21:59:41 -0400] hakunin: hoover_damm: i see
[2012-06-24 22:00:29 -0400] hakunin: miah: so i only run recipes via chef solo, in lists, which are combined elsewhere
[2012-06-24 22:01:11 -0400] leifmadsen: anyone who is using chef 0.10.10 or 0.10.12 who has a spare couple mins and can run the following for me and can verify if they get somethign other than nil returned, it would be greatly appreciated
[2012-06-24 22:01:12 -0400] leifmadsen:       p ("File owner: ")
[2012-06-24 22:01:12 -0400] leifmadsen:       p file('/etc/fstab').owner
[2012-06-24 22:03:01 -0400] hakunin: miah: this is all way too confusing, so i'm stepping into chef very gradually. First i wrote a few of my own recipes and made lists run via roundsman + capistrano, then I started depending on some other recipes, but never had to override attrs (there were defined resources), now i'm trying to depend on nginx, and suddenly i need to be overriding attrs. but I only have config/site-cookbooks in my rails app, so not sure where to e
[2012-06-24 22:03:01 -0400] hakunin: ven put those roles/environments and why have them in chef if they're in capistrano already.
[2012-06-24 22:03:20 -0400] hakunin: miah: tldr: i suck at chef and i have 2 tools that somewhat overlap
[2012-06-24 22:05:50 -0400] hakunin: so...
[2012-06-24 22:06:54 -0400] hakunin: I guess I get it, in my setup in order to override attributes I have to set them in capistrano.
[2012-06-24 22:07:00 -0400] hakunin: yep, that was it
[2012-06-24 22:07:20 -0400] hakunin: now i remember, i did this in case with postgres
[2012-06-24 22:07:34 -0400] hakunin: sigh
[2012-06-24 22:16:28 -0400] leifmadsen: interesting...
[2012-06-24 22:16:38 -0400] leifmadsen: so the issues I'm having with minitest seem to be issues with chef itself
[2012-06-24 22:29:24 -0400] leifmadsen: interesting....
[2012-06-24 22:30:08 -0400] leifmadsen: 0.10.8, 'p file("/etc/fstab").owner' or 'p file("/etc/fstab").mode' works fine... 0.10.10 or newer, fail miserable with a nil returned
[2012-06-24 23:23:31 -0400] hoover_damm: yeah related to the new mixlib-shellout gem
[2012-06-24 23:24:34 -0400] hoover_damm: although it didn't really feel new, but just a weird 'regression' I thought
[2012-06-24 23:55:02 -0400] rayrod2030: anybody around to help with a service not starting properly with the service resource?
