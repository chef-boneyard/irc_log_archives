[2012-06-05 00:00:03 -0400] hoover_damm: coderanger, i'm told you did some python cookbooks... but It could be just frog rubbish
[2012-06-05 00:00:14 -0400] hoover_damm: so don't ask
[2012-06-05 00:00:23 -0400] coderanger: Just not seeing anything python related in immediate scrollback :)
[2012-06-05 00:00:33 -0400] hoover_damm: nope I just picked you out of a lineup
[2012-06-05 00:00:43 -0400] hoover_damm: there wasn't anything to see so you can move along if your busy
[2012-06-05 00:00:44 -0400] coderanger: Ahh
[2012-06-05 00:00:59 -0400] coderanger: Heh, just arguing with Rails, does that count as busy?
[2012-06-05 00:01:12 -0400] hoover_damm: poor thing
[2012-06-05 00:01:24 -0400] hoover_damm: No that counts as raging after a period of time
[2012-06-05 00:01:39 -0400] knuckolls: a mad that only programming can cause
[2012-06-05 00:01:47 -0400] knuckolls: there's logic in there somewhere
[2012-06-05 00:03:59 -0400] werdnativ: as for "contributing back to opscode", will it ever be a more open process to get "official" patches accepted?
[2012-06-05 00:04:20 -0400] coderanger: werdnativ: Whats not open about it?
[2012-06-05 00:04:30 -0400] coderanger: We would love to improve it any way we can :D
[2012-06-05 00:04:39 -0400] werdnativ: well, it's not as easy as a pull request. ;)
[2012-06-05 00:04:44 -0400] werdnativ: licensing, etc...
[2012-06-05 00:04:56 -0400] coderanger: Thats not a question of openness, it is one of ease
[2012-06-05 00:05:14 -0400] hoover_damm: werdnativ, is there a reason you can't open a ticket and sign a cla?
[2012-06-05 00:05:21 -0400] coderanger: We try to keep the process to a minimum, but the CLA is a legal requirement and pull reqs aren't an option over Jira because of how many repos we have
[2012-06-05 00:05:38 -0400] werdnativ: laziness! yeah, I know I should.
[2012-06-05 00:05:42 -0400] coderanger: (something like ~150 public repos between both orgs)
[2012-06-05 00:06:14 -0400] coderanger: But all discussion on Jira is public, and we post the results of the triage meetings to the ML twice a week now
[2012-06-05 00:06:16 -0400] hoover_damm: then really you can take this time to sign the CLA and ensure you have a user on Jira
[2012-06-05 00:06:20 -0400] werdnativ: also it used to be all one big cookbooks project...
[2012-06-05 00:06:44 -0400] hoover_damm: if you find filing tickets annoying, I'd suggest the org-jira mode on emacs so you can easily create a ticket and move on
[2012-06-05 00:06:44 -0400] werdnativ: but I guess that's better now with github/opscode-cookbooks
[2012-06-05 00:06:49 -0400] coderanger: werdnativ: Yes, the old repo has been split to allow for easier patching, using librarian, etc
[2012-06-05 00:07:20 -0400] werdnativ: librarian vs. knife-github: pros/cons?
[2012-06-05 00:07:33 -0400] knuckolls: librarian feels a hundred times cleaner to me
[2012-06-05 00:07:36 -0400] coderanger: librarian does more, but use which ever you prefer
[2012-06-05 00:07:42 -0400] coderanger: <3 librarian personally
[2012-06-05 00:07:47 -0400] knuckolls: it's bundler syntax so it's familiar
[2012-06-05 00:07:56 -0400] werdnativ: I've only used knife-gh so just asking I'll check out librarian.
[2012-06-05 00:07:58 -0400] knuckolls: shows the external cookbooks you desire pretty explicitly
[2012-06-05 00:08:00 -0400] coderanger: knife-github always seemed 99% a hack to get around our old monolithic cookbooks repo
[2012-06-05 00:08:08 -0400] werdnativ: ah.
[2012-06-05 00:08:42 -0400] pwf: wonderful, chef-client runs with sudo, but not when you log in as root
[2012-06-05 00:08:50 -0400] pwf: i have no idea how to run it in the background now
[2012-06-05 00:09:18 -0400] coderanger: pwf: How did you install it? Thats usually an env var problem (like you installed into an odd folder and root has a different $GEM_HOME)
[2012-06-05 00:09:19 -0400] knuckolls: this won't work? /etc/init.d/chef-client start
[2012-06-05 00:09:22 -0400] JasonBox: coderanger: Yeah, librarian is hot
[2012-06-05 00:09:38 -0400] knuckolls: i guess i'm thinking from a bootstrapped node with the chef-client cookbook standpoint
[2012-06-05 00:09:43 -0400] pwf: no init.d, it's an os x box
[2012-06-05 00:09:52 -0400] pwf: and coderanger one of the issues i solved is that HOME was wrong
[2012-06-05 00:10:00 -0400] pwf: so i manually set it in my launchd plist
[2012-06-05 00:10:02 -0400] coderanger: pwf: How did you install chef?
[2012-06-05 00:10:23 -0400] pwf: but now it's loading some things into launchctl as root that it should be loading as the user
[2012-06-05 00:10:42 -0400] pwf: i guess i misphrased it, it's running, but it's not doing the right things
[2012-06-05 00:13:18 -0400] pwf: ah here's what i'm missing
[2012-06-05 00:13:22 -0400] pwf: default.launch[:user] = ENV['SUDO_USER'] || ENV['USER']
[2012-06-05 00:13:33 -0400] pwf: so i need to define that as well as $HOME
[2012-06-05 00:14:50 -0400] coderanger: If you provide some more information about what you are trying to do, we might be able to help more
[2012-06-05 00:16:13 -0400] JasonBox: hrm, could there ever be environment support in solo?
[2012-06-05 00:16:39 -0400] coderanger: JasonBox: It wouldn't do much
[2012-06-05 00:16:50 -0400] coderanger: The Big Feature of envs is the cookbook version controls
[2012-06-05 00:17:04 -0400] coderanger: but solo assumes you've already figured out exactly what cookbooks to transfer
[2012-06-05 00:17:27 -0400] amagee: hey i had my chef server and client working yesterday, but i've since stopped and restarted the ec2 instance and it now has a different public dns.  i've updated the chef_server_url in knife.rb and it's trying to contact the new url, but i'm getting an error like this: http://dpaste.com/755345/
[2012-06-05 00:17:39 -0400] coderanger: The attributes can be done with roles, I guess the env run list stuff might be nice to have, but definitely not that impressive on its own
[2012-06-05 00:17:42 -0400] amagee: *stopped and restarted the ec2 instance running the server
[2012-06-05 00:18:19 -0400] JasonBox: coderanger: True enough
[2012-06-05 00:18:35 -0400] knuckolls: amagee: to avoid shifting dns names in the future you could use route53 and give it a proper dns name. it's dead simple.
[2012-06-05 00:18:42 -0400] amagee: i know
[2012-06-05 00:18:45 -0400] JasonBox: Was just getting to defining different role-env style names for solo and remembered with envs that because unnecessary
[2012-06-05 00:18:54 -0400] JasonBox: s/because/became/
[2012-06-05 00:18:54 -0400] knuckolls: amagee: are the security groups correct? can you telnet to that port from the client machine to see that it's listening?
[2012-06-05 00:19:11 -0400] amagee: i can contact publicdns:4000 and :4040 from chrome
[2012-06-05 00:21:48 -0400] amagee: oh hang on, "knife client list" is working, so it's probably not a problem contacting the server
[2012-06-05 00:22:09 -0400] knuckolls: works from your personal machine but not the bootstrapped node?
[2012-06-05 00:22:55 -0400] knuckolls: sorry, i misread the paste
[2012-06-05 00:23:08 -0400] knuckolls: i think you can turn up the debugging information with -VV on knife
[2012-06-05 00:23:45 -0400] amagee: ah cool, trying that
[2012-06-05 00:25:02 -0400] amagee: the only interesting lines are these: http://dpaste.com/755348/
[2012-06-05 00:25:28 -0400] amagee: i don't think my username should be chef..
[2012-06-05 00:25:54 -0400] knuckolls: paste your knife.rb?
[2012-06-05 00:26:36 -0400] amagee: http://dpaste.com/755349/ -- it's the same as yesterday except i changed chef_server_url
[2012-06-05 00:27:50 -0400] knuckolls: hm. at this point you'd probably have to look at the chef-server-api logs
[2012-06-05 00:28:14 -0400] knuckolls: see what it's getting mad about specifically. knife.rb looks good. i'd check the keys with what the server expects but those should be fine
[2012-06-05 00:28:23 -0400] knuckolls: i've gotta run though. best of luck!
[2012-06-05 00:28:28 -0400] amagee: ok thanks! :)
[2012-06-05 00:51:57 -0400] amagee: i managed to fix the problem using this: http://jonathanpolansky.com/2010/10/chef-server-connection-failed-to-rabbitmq-using-bunny-protocol-as-user-chef/
[2012-06-05 01:10:41 -0400] ypz: howdy!  I am trying to get knife talking to AWS, I am wondering what *value* do I assign to env variable AWS_SECRET_ACCESS_KEY ?
[2012-06-05 01:10:55 -0400] wang: is there a best practice for dealing with debian-backports? e.g. if i write a recipe for 'foopackage' to be used on any linux distro, and a debian user wants to use it, but they want to make sure the package manager is executed with "-t squeeze-backports", am i, as a cookbook publisher, supposed to provide an attribute for package options that people can override?
[2012-06-05 01:11:05 -0400] flaccid_: ypz: that would be your aws secrete access key
[2012-06-05 01:11:53 -0400] ypz: hi, flaccid_, you mean the private key for the keypair I created on AWS console ?
[2012-06-05 01:12:07 -0400] flaccid_: no, your aws secret access key.
[2012-06-05 01:12:41 -0400] flaccid_: http://docs.amazonwebservices.com/AWSSecurityCredentials/1.0/AboutAWSCredentials.html
[2012-06-05 01:12:57 -0400] ypz: flaccid_, that's what get me confused, where do get this "secrete access key" from ?
[2012-06-05 01:13:17 -0400] flaccid_: aws, its covered in the docs
[2012-06-05 01:13:48 -0400] flaccid_: i think you can get it from aws management console
[2012-06-05 01:13:51 -0400] ypz: i have access_key_id, but not this secrete_access_key
[2012-06-05 01:15:18 -0400] amagee: ypz: on the AWS console, open the menu whose title is your name (top right corner) and hit Security Credentials
[2012-06-05 01:15:28 -0400] ypz: the access_key_id is an upper case string of 21 char long
[2012-06-05 01:15:56 -0400] amagee: then there should be a table where the access key id is visible, and there's a Show button to show the secret key
[2012-06-05 01:16:22 -0400] ypz: argh, that might be my problem, this is a company acct, so I *don't* have access to these credential pages
[2012-06-05 01:16:34 -0400] amagee: oh
[2012-06-05 01:16:41 -0400] flaccid_: sweet, security is working :)
[2012-06-05 01:17:12 -0400] ypz: thanks, guys, I'll have to kick the buck upstairs !
[2012-06-05 01:23:56 -0400] freecandy: foursquare as in the retarded I'M THE MAYOR OF THIS OUTDOOR URINAL service??? Tell me more!
[2012-06-05 01:24:41 -0400] ypz: amagee and flaccid_,  thanks a lot , bye !
[2012-06-05 01:47:38 -0400] eherot: Anyone ever seen this weirdness before?
[2012-06-05 01:47:43 -0400] eherot: I have this construct:
[2012-06-05 01:47:45 -0400] eherot: {
[2012-06-05 01:47:45 -0400] eherot:     "/etc/logrotate.conf" => "logrotate.conf",
[2012-06-05 01:47:45 -0400] eherot:     "/etc/logrotate.d/syslog-ng" => "logrotate.d-syslog-ng-client"
[2012-06-05 01:47:45 -0400] eherot: }.each do |cur_dest,cur_source|
[2012-06-05 01:47:45 -0400] eherot:     cookbook_file cur_dest do
[2012-06-05 01:47:46 -0400] eherot:         source cur_source
[2012-06-05 01:47:46 -0400] eherot:         owner "root"
[2012-06-05 01:47:47 -0400] eherot:         group "root"
[2012-06-05 01:47:47 -0400] eherot:         mode "0644"
[2012-06-05 01:47:47 -0400] eherot:         backup false
[2012-06-05 01:47:48 -0400] eherot:     end
[2012-06-05 01:47:48 -0400] eherot: end
[2012-06-05 01:48:15 -0400] miah: can you please gist/pastebin rather than flooding the channel?
[2012-06-05 01:48:18 -0400] eherot: and it produces this error:
[2012-06-05 01:48:22 -0400] eherot: line 36) had an error: RuntimeError: can't modify frozen string
[2012-06-05 01:48:30 -0400] eherot: line 36 being "cookbook_file cur_dest do"
[2012-06-05 01:49:58 -0400] eherot: sure https://gist.github.com/f4a165eb7ec440361e90
[2012-06-05 01:50:06 -0400] eherot: line 5 there.
[2012-06-05 01:51:18 -0400] beandip: /j/j git
[2012-06-05 01:51:21 -0400] beandip: erp
[2012-06-05 01:51:41 -0400] eherot: hehe
[2012-06-05 01:52:53 -0400] eherot: what's even more fun is that if I practice string interpolation and do cookbook_file "#{cur_dest}" do instead, that works fine.
[2012-06-05 01:53:52 -0400] flaccid_: not sure whats up with that ruby. works fine in my irb without interpolation
[2012-06-05 01:55:58 -0400] eherot: yeah mine too
[2012-06-05 01:56:34 -0400] eherot: actually, haven't tried it in shef on that node yet but I'll give that a go
[2012-06-05 01:56:42 -0400] flaccid_: cool
[2012-06-05 02:04:01 -0400] eherot: yep, fails there too
[2012-06-05 02:05:34 -0400] eherot: that's the omnibus install with gems 1.9.1
[2012-06-05 02:05:47 -0400] eherot: actually, i guess that's implied
[2012-06-05 02:09:35 -0400] eherot: If I past my little mini hash in there and just try to run gsub!(/\\/, "/") on cur_dest, it does indeed fail with that error
[2012-06-05 02:09:50 -0400] eherot: and only on that version of chef (not my local one)
[2012-06-05 02:29:19 -0400] rocket: Is there a best practice for downloading an rpm and installing it?  eg a provider someone has already built I should be referencing?
[2012-06-05 02:53:14 -0400] hongbin: Hi. I have question about knife ec2 plugin. Is that anyway I can create multiple instances concurrently.
[2012-06-05 03:01:23 -0400] sivy: is there a way to "ask" knife what config file it's using?
[2012-06-05 03:08:46 -0400] jtimberman: sivy: i wrote a rubygem, knife-config, that will tell you what the chef config value knife has for something.
[2012-06-05 03:08:56 -0400] jtimberman: not the exact same thing, but i imagine that is closer to what you want
[2012-06-05 03:09:00 -0400] jtimberman: hongbin: i dont think so
[2012-06-05 03:10:09 -0400] hongbin: jtimberman: OK. Thx.
[2012-06-05 03:17:16 -0400] JasonBox: hrm, do I have to do anything special to require 'ipaddr' in a recipe?
[2012-06-05 03:17:26 -0400] fujin: no
[2012-06-05 03:17:28 -0400] fujin: require 'ipaddr'
[2012-06-05 03:17:33 -0400] fujin: foo = IPAddr.new
[2012-06-05 03:18:29 -0400] fujin: JasonBox: https://gist.github.com/4e6af62c6d6a38653bba
[2012-06-05 03:20:19 -0400] JasonBox: Very cool
[2012-06-05 03:20:30 -0400] sivy: hm, jtimberman: if the only knife.rb's on two boxes are in gems/chef-0.10.4/lib, what config is knife likely using, if one box works and the other complains about not having a config?
[2012-06-05 03:30:19 -0400] davidosomething: can anyone help me with this recipe i made?
[2012-06-05 03:30:36 -0400] davidosomething: https://gist.github.com/2872445
[2012-06-05 03:30:58 -0400] davidosomething: it works up until the point where i try to create a db and user and seed it
[2012-06-05 03:31:16 -0400] davidosomething: maybe i need to execute the "create-database" task only if mysql is running?
[2012-06-05 03:32:29 -0400] other_guy: How terrible of an idea is it to add an SSH key to my newly created Rackspace Cloud servers from my local machine so that I can automatically login to them?  Because as it stands there's no good way to capture the auto generated root password.
[2012-06-05 03:33:15 -0400] other_guy: I'd do this as a file copy or something as part of a recipe to run after the machine was setup and bootstrapped
[2012-06-05 03:34:43 -0400] other_guy: I'd be content to just be able to forcibly set the root password or something instead, but despite the options for knife-rackspace that seem like they're for exactly that purpose, nothing I seem to do gets my password to stick.
[2012-06-05 03:35:13 -0400] flaccid_: its a great idea, public keys rule
[2012-06-05 03:39:30 -0400] other_guy: okay, sweet
[2012-06-05 03:39:31 -0400] other_guy:  :-)
[2012-06-05 03:42:25 -0400] amagee: do "knife configure" /  "knife configure client" do anything except generate config files on the local machine?
[2012-06-05 04:19:44 -0400] nmistry: is there an easy way to force an apt-get update && apt-get upgrade ; reboot  before running other roles/recipes?
[2012-06-05 04:23:28 -0400] bluecatze: So chef doesn't install it just handles config right? I'm getting an error trying to provision my vagrant server with nginx that it cant find the right candidate verison.
[2012-06-05 04:23:49 -0400] bluecatze: At one point I thoguht chef installed the applicaiton for you but now Im thinking I need to install nginx and it will not prompt me with that error
[2012-06-05 04:24:13 -0400] flaccid_: there is an nginx cookbook, not sure what you mean here..
[2012-06-05 04:24:21 -0400] bluecatze: i used the nginx cookbook
[2012-06-05 04:24:23 -0400] bluecatze: and I got an error
[2012-06-05 04:24:26 -0400] bluecatze: does the nginx cookbook install it?
[2012-06-05 04:24:59 -0400] flaccid_: nginx cookbook installs nginx
[2012-06-05 04:25:15 -0400] flaccid_: sounds like you have a repos issue
[2012-06-05 04:25:32 -0400] bluecatze: I tried manually installing the EPEL repo beforehand
[2012-06-05 04:25:40 -0400] bluecatze: I had the issue with a few other cookbooks
[2012-06-05 04:25:46 -0400] bluecatze: but some work fine
[2012-06-05 04:25:59 -0400] bluecatze: Are there cookbooks to install repos?
[2012-06-05 04:27:37 -0400] flaccid_: yum cookbook i believe
[2012-06-05 04:27:43 -0400] flaccid_: and others
[2012-06-05 04:27:56 -0400] jtimberman: amagee: nope, they're there to create configuration
[2012-06-05 04:28:02 -0400] flaccid_: if you get wrong candidate etc. you probably have broken repos config
[2012-06-05 04:28:49 -0400] jtimberman: opscode's "yum" cookbook has a recipe that installs the EPEL repo rpm
[2012-06-05 04:29:07 -0400] bluecatze: So if I include the yum cookbook before nginx it should install? because i tried that
[2012-06-05 04:29:11 -0400] jtimberman: it also includes a "yum_repository" resource you can use to manage other repositories.
[2012-06-05 04:29:19 -0400] bluecatze: ah
[2012-06-05 04:29:22 -0400] bluecatze: I should read more about that
[2012-06-05 04:29:37 -0400] jtimberman: use the "recipe[yum::epel]" in your node's run list
[2012-06-05 04:29:44 -0400] jtimberman: and it will enable EPEL automatically
[2012-06-05 04:29:48 -0400] bluecatze: ah
[2012-06-05 04:29:51 -0400] bluecatze: I dont think I was soding that
[2012-06-05 04:29:55 -0400] bluecatze: specifying epel
[2012-06-05 04:29:59 -0400] bluecatze: doing*
[2012-06-05 04:30:03 -0400] bluecatze: thank you
[2012-06-05 04:30:15 -0400] jtimberman: you're welcome
[2012-06-05 04:30:25 -0400] flaccid_: hopefully you just added the repo wrongly
[2012-06-05 04:30:28 -0400] flaccid_: yum repo list..
[2012-06-05 04:30:34 -0400] bluecatze: yeah i hope so too
[2012-06-05 04:30:46 -0400] bluecatze: diagnosis seems spot on though because fail2ban wouldnt install either
[2012-06-05 04:30:49 -0400] bluecatze: and its in the same epel repo
[2012-06-05 04:30:57 -0400] bluecatze: but apache2 would
[2012-06-05 04:45:53 -0400] nmistry: Wondering if its possible to manage a reboot in a chef recpie or role.  So that the node picks up where it left off.
[2012-06-05 04:46:05 -0400] nmistry: is this even possible?
[2012-06-05 04:48:24 -0400] hoover_damm: basic idempotency should handle this
[2012-06-05 04:48:39 -0400] hoover_damm: so when the same runlist re-runs upon reboot, it would determine these actions have taken place and skip those
[2012-06-05 04:48:48 -0400] hoover_damm: and continue to where it needs to continue on at
[2012-06-05 04:49:13 -0400] Mithrandir: except for notifies
[2012-06-05 04:49:17 -0400] Mithrandir: delayed notifies
[2012-06-05 04:49:29 -0400] hoover_damm: well that's your own fault for using delayed notifies and rebooting
[2012-06-05 04:49:45 -0400] Mithrandir: sure, can be worked around, but you need to pay attention to it
[2012-06-05 04:50:02 -0400] hoover_damm: also your rebooting... so provided you have a 'service' block to bring it up
[2012-06-05 04:50:07 -0400] hoover_damm: it shouldn't matter that much should it?
[2012-06-05 04:50:40 -0400] hoover_damm: do people really default to delayed?
[2012-06-05 04:51:28 -0400] hoover_damm: It's not the delayed / crash thing.  It's just me taking a different approach to it
[2012-06-05 04:51:41 -0400] hoover_damm: which seems to work for me (for the moment)
[2012-06-05 04:53:22 -0400] bluecatze: Anyone have any idea why I'm getting this "[Tue, 05 Jun 2012 04:46:33 +0000] FATAL: Net::HTTPServerException: remote_file[/tmp/vagrant-chef-1/epel-release-6-5.noarch.rpm] (yum::epel line 26) had an error: Net::HTTPServerException: 404 "Not Found"
[2012-06-05 04:53:22 -0400] bluecatze: "
[2012-06-05 04:54:19 -0400] c_t: is the remote file not there?
[2012-06-05 04:54:37 -0400] bluecatze: I'm working with vagrant
[2012-06-05 04:54:40 -0400] bluecatze: so this is extra confusing
[2012-06-05 04:54:51 -0400] flaccid_: correct, they probably released a new rpm version
[2012-06-05 04:55:05 -0400] BryanWB_: ohai chefs!
[2012-06-05 04:55:13 -0400] c_t: ohai
[2012-06-05 04:55:23 -0400] flaccid_: have a look on the mirror and see if epel-release-6-5.noarch.rpm is there, its probably not 6-5 anymore..
[2012-06-05 04:55:35 -0400] bluecatze: ah
[2012-06-05 04:56:23 -0400] BryanWB_: it is 6-7 now
[2012-06-05 04:56:50 -0400] bluecatze: weird it would be 2 versions behind
[2012-06-05 04:57:18 -0400] c_t: maybe there were two versions bam-bam
[2012-06-05 04:57:28 -0400] c_t: and it just hadn't been updated yet
[2012-06-05 04:58:30 -0400] erikh: delayed is nice when you have several notifications that are similar and might fire multiple times in a run
[2012-06-05 04:58:42 -0400] erikh: e.g., "restart unicorn on x, y, and z conditions"
[2012-06-05 04:58:59 -0400] flaccid_: not a fan of breaking URIs
[2012-06-05 04:59:14 -0400] flaccid_: they could provide or link a epel-release-latest.rpm
[2012-06-05 04:59:35 -0400] nmistry: hoover_damm, really all i want to do is just run a apt-get update && apt-get upgrade then reboot, and THEN run all the merry little scripts.
[2012-06-05 04:59:53 -0400] nmistry: i now apt::default will take care of the update part
[2012-06-05 05:00:04 -0400] BryanWB_: c_t: it changed 2 versions in ~1 week iirc
[2012-06-05 05:00:41 -0400] nmistry: will give it a try w/ a simple recipe 
[2012-06-05 05:00:46 -0400] hoover_damm: nmistry, running scripts != resources
[2012-06-05 05:00:55 -0400] nmistry: sorry, i meant recipes
[2012-06-05 05:00:56 -0400] hoover_damm: nmistry, create a set of defined resources that replace your scripts
[2012-06-05 05:01:24 -0400] hoover_damm: you can define the runlist order that they wouldn't occur until after the reboot happens
[2012-06-05 05:01:43 -0400] hoover_damm: but proper design can work around order in this case
[2012-06-05 05:02:00 -0400] nmistry: so if i had athe apt::default run, then my update and reboot recipe, then whatever else
[2012-06-05 05:02:25 -0400] hoover_damm: right, however whatever's changing that triggers the reboot
[2012-06-05 05:02:29 -0400] hoover_damm: could be a 'subscribes'
[2012-06-05 05:02:33 -0400] hoover_damm: and a :nothing resource
[2012-06-05 05:02:44 -0400] hoover_damm: and then it's just whenever your kernel updates, it triggers a reboot
[2012-06-05 05:03:03 -0400] hoover_damm: likely the /boot/grub/menu.lst would work the same
[2012-06-05 05:03:11 -0400] nmistry: k
[2012-06-05 05:03:20 -0400] nmistry: thanks hoover_damm
[2012-06-05 05:03:36 -0400] hoover_damm: nmistry, it's easier to setup a subscribe like that and just plan your resources to enforce what you want
[2012-06-05 05:03:43 -0400] hoover_damm: nmistry, then what you want, should be what you get... always
[2012-06-05 05:03:50 -0400] hoover_damm: and with a proper runlist :) that just ensures it
[2012-06-05 05:04:01 -0400] nmistry: makes sense
[2012-06-05 05:47:49 -0400] ridr: anyone know of a good waiting to see if supervisor started child processes succesfully?
[2012-06-05 05:47:57 -0400] ridr: *good way
[2012-06-05 06:41:58 -0400] nmistry: when installing chef server on debian squeeze,  there seems to be a problem with rabbit instaling .
[2012-06-05 06:42:37 -0400] nmistry: i have tried adding the rabbit repos, but its not working just right.
[2012-06-05 06:42:49 -0400] nmistry: is the bootstrap method the most reliable way to install chef server on debian?
[2012-06-05 06:45:32 -0400] nmistry: this is chef 10.x
[2012-06-05 08:08:26 -0400] Sephi: Hi
[2012-06-05 08:08:33 -0400] Sephi: here's a question
[2012-06-05 08:09:09 -0400] Sephi: I'm looking for info 'bout distrib
[2012-06-05 08:09:31 -0400] Sephi: i read chef works on windows and Ubuntu
[2012-06-05 08:10:08 -0400] Sephi: but there is nothing on the windows version, nor the Ubuntu one
[2012-06-05 08:10:44 -0400] amagee: Sephi: i'm pretty new but i've been using chef with ubuntu quite a lot lately.. what do you want to know?
[2012-06-05 08:10:59 -0400] Sephi: may I asume chef works on all of them (win 2008/7 and Ubuntu 10.4/11.4/12.4)
[2012-06-05 08:11:12 -0400] Sephi: Hi amagee
[2012-06-05 08:11:20 -0400] amagee: i've been using it on 12.4.. i haven't tried windows but i've seen instructions for it
[2012-06-05 08:11:25 -0400] Sephi: just doing research
[2012-06-05 08:11:35 -0400] amagee: i've been running client on 11.04 and 11.10 also
[2012-06-05 08:11:41 -0400] Sephi: ok
[2012-06-05 08:12:22 -0400] Sephi: is there any website u used to get help besides the chef community one or the chef wiki ?
[2012-06-05 08:12:47 -0400] amagee: umm i've used mainly the chef community site and the wiki and here
[2012-06-05 08:12:58 -0400] BryanWB_: Sephi: http://help.opscode.com/
[2012-06-05 08:13:11 -0400] amagee: for installing the server this was really good: http://generalthings.com/2012/05/08/simple-steps-install-chef-ubuntu-12-04-10-04/
[2012-06-05 08:13:23 -0400] Sephi: thanks a lot BryanWB_  amagee
[2012-06-05 08:13:34 -0400] Sephi: gonna get a look on both
[2012-06-05 08:36:06 -0400] Tensibai: Hello
[2012-06-05 08:37:05 -0400] Tensibai: I'm trying to install grill as chef dashboard but fail at grill cycle_server start with error Unknown id: UNKNOWN, does anyone have an idea ? (I didn't find anything about that :/)
[2012-06-05 08:53:15 -0400] Tensibai: ok found, fils has to be own by someone (just untarring cause problem if you don't have a user with id 501)
[2012-06-05 08:53:38 -0400] Tensibai: files*
[2012-06-05 08:55:49 -0400] railsraider: i need to install a gem from a recipe, gem_package doesn't seems to do anythign
[2012-06-05 09:00:55 -0400] railsraider: its ok found a way to insert it to the run_action
[2012-06-05 10:13:40 -0400] railsraider: Hi, Im using the ssh cookbook from opscode, for some reason it does not restart the service after writing the template
[2012-06-05 10:13:57 -0400] railsraider: i have this line "ubuntu" => {
[2012-06-05 10:13:57 -0400] railsraider:       "8.04" => [ :restart, :reload ],
[2012-06-05 10:13:58 -0400] railsraider:       "default" => [ :restart, :reload, :status ]
[2012-06-05 10:13:59 -0400] railsraider:     },
[2012-06-05 10:14:23 -0400] railsraider: I'm using ubuntu 10.04, could it be the default doesn't load?
[2012-06-05 11:00:17 -0400] laurent\: https://gist.github.com/2874182 can anybody test this and tell me if it prints stdout from chef-client ?
[2012-06-05 11:01:56 -0400] laurent\: it works as expected if I run "ohai -l debug"
[2012-06-05 11:04:34 -0400] laurent\: oh nevermind, i think i found a lead :)
[2012-06-05 11:08:41 -0400] laurent\: ch.request_pty :)
[2012-06-05 12:08:07 -0400] geekbri: Hrm, I just got an email from opscode about the ancestry.com webinar, but when trying to register it claimed the URL was bad.  Seems like maybe somebody accidentally included the test link they were using.
[2012-06-05 12:10:26 -0400] dkannan: what is the difference btw node and client
[2012-06-05 12:11:51 -0400] BryanWB_: dkannan: client can access chef-server api
[2012-06-05 12:12:17 -0400] BryanWB_: dkannan: node is an individual machine or VM and a client
[2012-06-05 12:13:22 -0400] dkannan: BryanWB_: so a node can be brought up by chef-solo in which case, it is not a client ?
[2012-06-05 12:13:45 -0400] dkannan: is there any other way a node is not a client
[2012-06-05 12:14:07 -0400] PeterDonald: geekbri: I got the same email and the link worked for me  try https://attendee.gotowebinar.com/3432g/register/3076108421817991168
[2012-06-05 12:14:50 -0400] geekbri: PeterDonald: hrm, your link worked fine for me, but the one in the email I got bombs out
[2012-06-05 12:15:03 -0400] BryanWB_: dkannan: i bleieve so
[2012-06-05 12:15:13 -0400] BryanWB_: PeterDonald: gday mate!
[2012-06-05 12:15:34 -0400] PeterDonald: gday - hows things
[2012-06-05 12:15:49 -0400] BryanWB_: PeterDonald: ok
[2012-06-05 12:16:00 -0400] dkannan: "knife client list" has a bunch of entries like chef-validator, chef-webui, a workstation and a node i wanted to bring up
[2012-06-05 12:16:34 -0400] dkannan: but "knife search node "id:*" only has one entry. the node i wanted to bring up
[2012-06-05 12:17:19 -0400] PeterDonald: dkannan: clients ~= users able to access the chef server while odes are actually the things you way to configure
[2012-06-05 12:17:42 -0400] PeterDonald: i.e. chef-webui is the user that the web ui uses to connect to the server component
[2012-06-05 12:18:46 -0400] dkannan: can i login to an instance and check, if the machine is a workstation, node or a client (or any combination of ) ?
[2012-06-05 12:18:56 -0400] dkannan: maybe a special file etc
[2012-06-05 12:19:26 -0400] dkannan: this is because, i would have configured and forgotten about it
[2012-06-05 12:20:04 -0400] dkannan: or to put it another way. in my local cookbook. where is the node/client structure stored
[2012-06-05 12:20:07 -0400] dkannan: so i can commit it
[2012-06-05 12:20:34 -0400] PeterDonald: dkannan: not really - however by convention most clients that are also nodes are not "admin" clients whereas the other ones tend to be  also the name of the client should (must?) match the node name
[2012-06-05 12:44:00 -0400] yfeldblum: the "client" is the abstraction around an API client, i.e., "that which has a private key and can access the Chef Server API"
[2012-06-05 12:44:54 -0400] yfeldblum: to communicate with the chef-server-api, you do so as an api client, i.e., with the private key of an api client that is pre-registered with the chef-server-api
[2012-06-05 12:56:01 -0400] dkannan: thanks all
[2012-06-05 12:56:42 -0400] dkannan: knife ssh fails with a "Net::SSH::AuthenticationFailed: root@<ip-address?"
[2012-06-05 12:57:11 -0400] dkannan: but i am able to ssh (from the console) to root@<ip-address>
[2012-06-05 13:00:10 -0400] dkannan: ok. got it. knife ssh does not ask for the password. works if i add the ssh key. is this a bug ?
[2012-06-05 13:02:45 -0400] TwoQuestions: hello?
[2012-06-05 13:03:42 -0400] royh: dkannan: you can use -x and -P for user and pass respectively
[2012-06-05 13:03:52 -0400] royh: dkannan: knife ssh --help for more info :)
[2012-06-05 13:05:18 -0400] dkannan: royh: thanks :-) thought it would be the default
[2012-06-05 13:06:24 -0400] dkannan: how can i edit the FQDN of a node ?
[2012-06-05 13:06:49 -0400] TwoQuestions: does somebody here know if it is possible to load a template into a variable instead of a target file?
[2012-06-05 13:07:24 -0400] TwoQuestions: i.e. "template variable do ..."
[2012-06-05 13:10:07 -0400] royh: dkannan: knife node edit <fqdn>, but then you also need to edit or readd the client; knife client edit <fqdn>
[2012-06-05 13:10:57 -0400] CharlieSu: Anyone running 0.10.10 notice that some notifies/subscribes statements are not working?
[2012-06-05 13:20:18 -0400] leifmadsen: morning all!  I'm moving from provisioning servers with chef-solo to using chef-server (self-hosted), and the one thing I'm a little confused about is how to convert from using json files for attributes, to how best to handle/apply those to nodes when using chef-server.
[2012-06-05 13:20:51 -0400] leifmadsen: Is that typically done using the override attribute on the node with knife node edit, or should I be using data bags... ?
[2012-06-05 13:21:06 -0400] railsraider: if i have a    response_file '/var/cache/local/preseeding/arno-iptables-firewall.seed' in my recipe and it's in files > default> arno-iptables-firewall.seed why doesn't it get copied to that location
[2012-06-05 13:21:31 -0400] railsraider: it complains does not contain a file at any of these locations:   files/ubuntu-10.04//var/cache/local/preseeding/arno-iptables-firewall.seed
[2012-06-05 13:21:47 -0400] railsraider: doh
[2012-06-05 13:21:50 -0400] railsraider:  a //
[2012-06-05 13:23:04 -0400] railsraider: didn't help
[2012-06-05 13:23:13 -0400] railsraider: still can't locate the file
[2012-06-05 13:26:16 -0400] railsraider: any ideas what am i doing wrong? http://www.pastie.org/private/ew3tkshm7o8uigx5byhddg
[2012-06-05 13:27:43 -0400] railsraider: does the file name needs to be the same as the version? the error is /var/chef/cache/preseed/arno-iptables-firewall/arno-iptables-firewall-1.9.2.h-1.seed
[2012-06-05 13:28:32 -0400] railsraider: the file does exists in the path
[2012-06-05 13:28:43 -0400] railsraider: i don't understand
[2012-06-05 13:32:19 -0400] railsraider: do i need to use a cookbook file resource before i attempt using a response_file resource ?
[2012-06-05 13:38:41 -0400] codeshepherd: i am using chef-solo.... when I run knife data bag create users  .. i get the error saying "Error connecting to http://Newton:4000/data - getaddrinfo: nodename nor servname provided, or not known "
[2012-06-05 13:41:23 -0400] zined: ohai! :)
[2012-06-05 13:41:30 -0400] railsraider: codeshepherd: you need to create the data bags on your folders as files  otherwise knife will try to create the data bags on chef server
[2012-06-05 13:41:52 -0400] codeshepherd: thanks railsraider
[2012-06-05 13:42:54 -0400] codeshepherd: railsraider:  I am trying to figure out where I have to create these files... in the data_bag folder or inside the cookbook folder.. how do I name them.. is there a document that explains this?
[2012-06-05 13:43:32 -0400] railsraider: codeshepherd: make a folder outside the cookbooks folder called data_bags and make the files in it like a folder for each data bag and a file for each item (json formatted)
[2012-06-05 13:44:04 -0400] codeshepherd: thanks railsraider
[2012-06-05 13:44:09 -0400] railsraider: np
[2012-06-05 13:48:53 -0400] railsraider: anyone can explain how to use the response_file resource?
[2012-06-05 13:52:22 -0400] sevenseacat: i'm a ruby dev and im looking for a simple way to bootstrap new servers with minimal fuss - im not super familiar with sysadmin stuff but somewhat comfortable - looking for the simplest way to get started with chef without needing to install dependencies out the wazoo - for instance i'd like to use chef to manage my rvm and ruby installations
[2012-06-05 13:53:34 -0400] geekbri: Hosted chef is a nice easy way to get a chef server with minimal fuss :-P
[2012-06-05 13:53:58 -0400] geekbri: you could also use chef-solo, there is an RVM cookbook by fnichols that is pretty good for handling rvm stuff
[2012-06-05 13:55:03 -0400] railsraider: why  chef is trying to download a file i didn't ask for!  fetching preseed file to /var/chef/cache/preseed/arno-iptables-firewall/arno-iptables-firewall-1.9.2.h-1.seed i specifically asked it    response_file '/var/cache/local/preseeding/arno-iptables-firewall.seed'
[2012-06-05 13:55:04 -0400] railsraider:  and i have it under files->default->arno-iptables-firewall.seed
[2012-06-05 13:55:19 -0400] sivy: good morning chefs
[2012-06-05 13:55:44 -0400] sevenseacat: geekbri: i'd rather not use hosted anything but i'll look into chef-solo
[2012-06-05 13:55:46 -0400] sevenseacat: thanks
[2012-06-05 13:56:03 -0400] dkannan: royh: thanks. i ended by editing the hostname on the server
[2012-06-05 13:56:18 -0400] sivy: if i run "knife node <command>" on a node, and I get "WARNING: No knife configuration file found" - but it continues to ask if i want to perform the command... what does that mean? what will it do if i say yes?
[2012-06-05 13:56:56 -0400] royh: dkannan: youre welcome :)
[2012-06-05 13:57:33 -0400] geekbri: sevenseacat: Unfortunately if you want the functionality of that central brain you'll either have to run your own chef server or use the hosted one.  Chef solo does make it so you can use chef to configure things and handle that management on the node... sounds like what you are looking for.
[2012-06-05 14:01:13 -0400] Tensibai: Someone using grill here ?
[2012-06-05 14:01:45 -0400] railsraider: anyone using response_file here?
[2012-06-05 14:04:36 -0400] geekbri: railsraider: I've not had to use response_file yet, but could it be that it expects the version of the package to be appended to the end of the seed file
[2012-06-05 14:11:07 -0400] codeshepherd: I am using users cookbook.. I get the error ": Failed to load data bag item: "users" "ram" ... I have a json file data_bags/users/ram  .. however it doesn't pick up the information from there
[2012-06-05 14:12:53 -0400] Tensibai: codeshepherd: the json file has an entry "id":"ram" ?
[2012-06-05 14:13:03 -0400] codeshepherd: Tensibai:  yes it has
[2012-06-05 14:14:08 -0400] Tensibai: codeshepherd: anything more about it in debug mode ?
[2012-06-05 14:15:27 -0400] codeshepherd: Tensibai: i found this error in stack trace.. Chef::Exceptions::ValidationFailed: Data Bag Items must contain a Hash or Mash!
[2012-06-05 14:15:37 -0400] codeshepherd: will paste the full debug trace Tensibai  - one sec
[2012-06-05 14:15:51 -0400] Tensibai: paste the json on pastie maybe
[2012-06-05 14:16:09 -0400] codeshepherd: ya doing it Tensibai
[2012-06-05 14:16:36 -0400] Tensibai: sounds like the json is not well formatted (but that's said I'm quite new to chef too... so maybe I won't help)
[2012-06-05 14:16:50 -0400] codeshepherd: Tensibai: http://pastebin.ca/2158424
[2012-06-05 14:16:57 -0400] juliancdunn: easy question here: is there any way to store default knife flags in .chef/knife.rb and override them on the commandline?
[2012-06-05 14:18:45 -0400] Tensibai: codeshepherd: the databag item looks ok
[2012-06-05 14:19:17 -0400] codeshepherd: ok Tensibai should it not have a square bracket ? like [ .. anyway i am changing { to [
[2012-06-05 14:19:25 -0400] codeshepherd: checking if that helps Tensibai
[2012-06-05 14:19:44 -0400] Tensibai: hum does your chef-solo specify the correct path for data_bags ?
[2012-06-05 14:19:49 -0400] Tensibai: (just to ensure)
[2012-06-05 14:20:12 -0400] codeshepherd: hmm.. i am just running knife cook user@10.1.1.112
[2012-06-05 14:21:20 -0400] Tensibai: codeshepherd: ... dunno exactly how it works but there's a reference to chef-solo in your trace
[2012-06-05 14:21:54 -0400] Tensibai: so you should have to set your conf file accordingly to search for the data_bags
[2012-06-05 14:22:04 -0400] codeshepherd: ok Tensibai
[2012-06-05 14:22:38 -0400] codeshepherd: let me see if there is any command line option Tensibai
[2012-06-05 14:23:31 -0400] Tensibai: data_bag_path  "d:/opscode/chef/data_bags" (in my client.rb for chef-solo on windows)
[2012-06-05 14:25:03 -0400] codeshepherd: thanks Tensibai
[2012-06-05 14:25:07 -0400] BryanWB_: wow,  binding.pry even works inside erb templates
[2012-06-05 14:26:12 -0400] Tensibai: codeshepherd: you're welcome (if it solved your problem...)
[2012-06-05 14:26:27 -0400] Tensibai: for my part I'm still fighting with grill, someone for a small help ?
[2012-06-05 14:31:26 -0400] sivy: is there a difference between calling knife boostrap <some node> and that node being able to *run* knife locally?
[2012-06-05 14:31:30 -0400] sivy: (hosted)
[2012-06-05 14:31:54 -0400] awgross{flashman: sivy: yes
[2012-06-05 14:32:34 -0400] awgross{flashman: knife is a command line tool for manipulating your chef cookbooks and installing chef-client on machines
[2012-06-05 14:32:53 -0400] awgross{flashman: once you have bootstrapped a machine, you usually will not be using knife from that new machine
[2012-06-05 14:55:32 -0400] someautomator: hey does anyone here have a problem using "only_if" statements with shell scripts?
[2012-06-05 14:56:27 -0400] awgross{flashman: someautomator: how so?
[2012-06-05 14:57:09 -0400] someautomator: for instance only_if "/bin/somecommand |grep output"
[2012-06-05 14:57:21 -0400] awgross{flashman: ok
[2012-06-05 14:57:24 -0400] awgross{flashman: I have not had issues with that
[2012-06-05 14:57:29 -0400] someautomator: well it'll evaluate true
[2012-06-05 14:57:29 -0400] awgross{flashman: what problems are you seeing?
[2012-06-05 14:57:40 -0400] someautomator: and a script will run anyway
[2012-06-05 14:57:43 -0400] someautomator: sorry i didn't mean only_if
[2012-06-05 14:57:46 -0400] someautomator: i mean not_if
[2012-06-05 14:58:11 -0400] awgross{flashman: strange, what version of chef?
[2012-06-05 14:58:18 -0400] awgross{flashman: and what OS
[2012-06-05 14:58:30 -0400] someautomator: ubuntu 12.04 ruby 1.9
[2012-06-05 14:58:35 -0400] someautomator: chef version 0.10
[2012-06-05 14:58:56 -0400] someautomator: here's a better snippet
[2012-06-05 14:59:06 -0400] someautomator: script "upload operating system image" do
[2012-06-05 14:59:06 -0400] someautomator:         not_if "/usr/local/bin/nova image-list"
[2012-06-05 14:59:06 -0400] someautomator: interpreter "bash"
[2012-06-05 15:00:18 -0400] awgross{flashman: can you reproduce it with something simpler? perhaps /bin/true
[2012-06-05 15:00:25 -0400] someautomator: yeah sure lemme give that a try
[2012-06-05 15:00:34 -0400] awgross{flashman: if you can, file a bug
[2012-06-05 15:00:40 -0400] awgross{flashman: maybe something got screwed up
[2012-06-05 15:00:49 -0400] someautomator: alrighty
[2012-06-05 15:15:09 -0400] someautomator: ok so the not_if works on something simpler
[2012-06-05 15:15:13 -0400] someautomator: but i have a question
[2012-06-05 15:15:52 -0400] someautomator: script "upload operating system image" do
[2012-06-05 15:15:52 -0400] someautomator:         not_if "/usr/local/bin/nova image-list"
[2012-06-05 15:15:52 -0400] someautomator:         interpreter "bash"
[2012-06-05 15:15:54 -0400] someautomator:         user "stack"
[2012-06-05 15:16:01 -0400] someautomator: does the not_if run as the user stack or as root?
[2012-06-05 15:16:16 -0400] awgross{flashman: my guess is it will run as root
[2012-06-05 15:16:21 -0400] awgross{flashman: check the code
[2012-06-05 15:16:37 -0400] awgross{flashman: but pretty sure the parent ruby process spawns a popen
[2012-06-05 15:16:39 -0400] awgross{flashman: runs the command
[2012-06-05 15:16:42 -0400] awgross{flashman: checks the exit code
[2012-06-05 15:17:03 -0400] someautomator: ok that's what i thought
[2012-06-05 15:18:02 -0400] CharlieSu: Anyone running 0.10.10 notice that some notifies/subscribes statements are not working?
[2012-06-05 15:18:32 -0400] someautomator: thx flashman
[2012-06-05 15:19:03 -0400] hoover_damm: CharlieSu, can you show some code on how it's not working?
[2012-06-05 15:20:41 -0400] CharlieSu: hoover_damm: looks like this was reported here  http://lists.opscode.com/sympa/arc/chef/2012-05/msg00233.html
[2012-06-05 15:21:16 -0400] CharlieSu: hoover_damm: Basically my basic scripts that I've been running for well over a hear are no longer notifying correctly..    Something as simple as this..  https://gist.github.com/4650e0e7fc5a761757a0
[2012-06-05 15:22:09 -0400] hoover_damm: CharlieSu, does an immediate work better? yeah that doesn't look right as that's simple simple
[2012-06-05 15:22:42 -0400] awgross{flashman: I had a similar issue, using :immediately seemed to fix it for me
[2012-06-05 15:22:52 -0400] CharlieSu: hoover_damm: not sure but I'll look into that later today I guess.
[2012-06-05 15:22:56 -0400] awgross{flashman: this was for notifies, not subscribes
[2012-06-05 15:23:06 -0400] CharlieSu: I shouldn't have to do that though..
[2012-06-05 15:23:08 -0400] hoover_damm: delayed doesn't fire if chef crashes
[2012-06-05 15:23:16 -0400] hoover_damm: and people often used delayed as it's the default
[2012-06-05 15:23:21 -0400] hoover_damm: immediate should be fine
[2012-06-05 15:23:43 -0400] CharlieSu: well in this case i'd rather it be delayed...
[2012-06-05 15:30:26 -0400] rabidpraxis: Does anyone know how to tell when a deploy resource has been updated or not? It looks as though all the callbacks are called regardless of the codebase being updated.
[2012-06-05 15:33:41 -0400] hoover_damm: anyone have an example cookbook that uses search and kind of depends on itself? Perhaps i'm using a bad pattern here to determine if i'm the first 'worker'
[2012-06-05 15:34:13 -0400] hoover_damm: first_worker_fqdn=search(:node, "roles:#{node.roles.first} AND chef_environment:#{node.chef_environment}").first
[2012-06-05 15:34:16 -0400] hoover_damm: if node[:fqdn] == first_worker_fqdn.fqdn
[2012-06-05 15:34:34 -0400] hoover_damm: if I add node.save it'll only fail the first run, work the second
[2012-06-05 15:35:04 -0400] hoover_damm: clearly I need a better way to figure out if i'm the first node, but I don't know the best answer here
[2012-06-05 15:35:42 -0400] yfeldblum: hoover_damm, why do you need to figure out if you're the first node?
[2012-06-05 15:36:08 -0400] hoover_damm: yfeldblum, first node has 2 more services
[2012-06-05 15:36:48 -0400] yfeldblum: hoover_damm, why not add a special role for the other 2 services?
[2012-06-05 15:37:33 -0400] hoover_damm: yfeldblum, see in #chef-hacking
[2012-06-05 16:23:02 -0400] neurodamage: does knife have any api pluggability to amazon's vpc that's pretty good?
[2012-06-05 16:48:30 -0400] neurodamage: and what are some good recommendations for plugins for ohai and/or knife that are useful when building infrastructure with ec2?
[2012-06-05 16:49:06 -0400] ssd7: neurodamage: Is there something you are looking for outside of the default ec2 ohai pluin and knife-ec2?
[2012-06-05 16:52:45 -0400] geekbri: knife-ec2 can handle creating VPC instances
[2012-06-05 16:53:42 -0400] ssd7: However, there are some problems with VPC detection in the ec2 ohai plugin.  We've introduced a new hinting system to overcome this bug, but knife-ec2 doesn't take advantage of it yet (it will soon).
[2012-06-05 16:55:51 -0400] rayrod2030: if I'm having a problem starting chef-server-webui on ubuntu what log should I check for errors?
[2012-06-05 16:56:17 -0400] hoover_damm: ssd7, doesn't the latest knife-ec2 gem fix that?
[2012-06-05 16:56:20 -0400] hoover_damm: ssd7, in master
[2012-06-05 16:56:28 -0400] hoover_damm: ssd7, s/gem/master :/
[2012-06-05 16:56:54 -0400] hoover_damm: I think the problem with VPC for a lot of people is how to use it sanely/easily
[2012-06-05 16:57:08 -0400] hoover_damm: they look at Hybridfox, fog, the console, and then look at the regular api tools
[2012-06-05 16:57:21 -0400] hoover_damm: and it's a cornacopia.  Stick to the regular api tools and console for VPC if you want to stay sane.
[2012-06-05 16:57:54 -0400] hoover_damm: and the knife-ec2 git repo has the *hints* file support which should fix the whole node['cloud'] pile of goo
[2012-06-05 17:03:28 -0400] pwf: how can i do something only if a service is running
[2012-06-05 17:03:59 -0400] pwf: i can't find documentation on getting a service status
[2012-06-05 17:18:33 -0400] rayrod2030: where does chef-server-webui log to?
[2012-06-05 17:24:12 -0400] eherot: rayrod2030: at least in our setup: /var/log/chef/server-webui.log
[2012-06-05 17:25:50 -0400] rayrod2030: yeah messages aren't making it to the log.
[2012-06-05 17:26:07 -0400] rayrod2030: I'm trying to run the merb/thin command manually and nothing
[2012-06-05 17:26:10 -0400] rayrod2030: just dies
[2012-06-05 17:27:57 -0400] rayrod2030: ah got it.
[2012-06-05 17:28:06 -0400] rayrod2030: minimum password rule for server
[2012-06-05 17:28:07 -0400] rayrod2030: doh
[2012-06-05 17:35:49 -0400] j-v-e: Good day, Gentlemen
[2012-06-05 17:36:19 -0400] j-v-e: I have an interpolation question
[2012-06-05 17:36:27 -0400] j-v-e: I want to use this in my role : :destination => 'shard_name:#{node[:mongodb][:shard_name]}',
[2012-06-05 17:36:40 -0400] j-v-e: and eval it in my recipe afterward
[2012-06-05 17:36:41 -0400] j-v-e: search_string << eval('"' + criteria.gsub(/"/, '\"') + '"')
[2012-06-05 17:36:50 -0400] yfeldblum: j-v-e, can't do that in a role
[2012-06-05 17:36:54 -0400] j-v-e: is there a secure way to do this ? the call to eval is kinda dangerous
[2012-06-05 17:37:09 -0400] yfeldblum: j-v-e, also, don't use eval unless there's a very specific reason to
[2012-06-05 17:37:09 -0400] j-v-e: yfeldblum: it works with eval
[2012-06-05 17:37:21 -0400] j-v-e: yfeldblum: there is here, I really need this feature
[2012-06-05 17:37:32 -0400] j-v-e: I'm trying to make it as secure as possible
[2012-06-05 17:37:55 -0400] j-v-e: Or use a better way, if there's one
[2012-06-05 17:38:28 -0400] yfeldblum: j-v-e, do you know for a fact that you will always be searching by shard_name?
[2012-06-05 17:39:02 -0400] j-v-e: shard_name is an example, others will be needed as well
[2012-06-05 17:39:25 -0400] j-v-e: I will always be searching for something of the form #{node[:foo][:bar]}
[2012-06-05 17:40:06 -0400] yfeldblum: "destination" => {"key" => "shard_name", "value" => ["mongodb", "shard_name"]}
[2012-06-05 17:40:46 -0400] yfeldblum: v = node["destination"]["value"].inject(node){|n, a| n[a]}
[2012-06-05 17:41:39 -0400] j-v-e: That's interesting !
[2012-06-05 17:41:56 -0400] yfeldblum: search(:node, "#{node['destination']['key']}:#{v}")
[2012-06-05 17:42:11 -0400] yfeldblum: something like that
[2012-06-05 17:42:31 -0400] yfeldblum: of course i'd recommend that you try to avoid things like that by giving your cookbooks proper APIs
[2012-06-05 17:42:38 -0400] yfeldblum: in terms of node attributes they look for
[2012-06-05 17:42:49 -0400] yfeldblum: that match the abstraction that your cookbook is trying to present
[2012-06-05 17:43:08 -0400] yfeldblum: however, that example above is an escape hatch if you just need to get something done
[2012-06-05 17:44:00 -0400] j-v-e: yeah I might have to twist it a bit to fit my recipe, but that's definitely a cool idea ! thanks yfeldblum
[2012-06-05 17:44:32 -0400] yfeldblum: no probs
[2012-06-05 17:45:32 -0400] rocket: I asked the other day and didnt get a response .. Is there an existing cookbook that is setup with a providor to download an rpm and then install it?
[2012-06-05 17:46:01 -0400] rocket: eg a utility cookbook I should be referencing for best practices and less duplication of providers etc?
[2012-06-05 17:52:55 -0400] JasonBox: hrm, what's a good namespace for a cookbook library?
[2012-06-05 17:54:13 -0400] yfeldblum: rocket, http://wiki.opscode.com/display/chef/Yum+Package+Resource
[2012-06-05 18:13:50 -0400] pwf: is there any reason roles aren't versioned for use with environments like cookbooks are?
[2012-06-05 18:15:41 -0400] pwf: seems like it would be a very helpful addition
[2012-06-05 18:15:53 -0400] pwf: though i may just be managing them incorrectly
[2012-06-05 18:18:57 -0400] yfeldblum: why would roles be versioned?
[2012-06-05 18:19:45 -0400] yfeldblum: cookbooks are the units of distribution and sharing in chef; therefore, cookbooks can be versioned, released, packaged, shared, etc
[2012-06-05 18:20:13 -0400] yfeldblum: but roles aren't for sharing, so versions would make no sense for roles
[2012-06-05 18:20:14 -0400] hoover_damm: pwf, what is the problem your hoping to solve?
[2012-06-05 18:20:28 -0400] hoover_damm: pwf, perhaps by understanding your problem we can help define it and help you solve it
[2012-06-05 18:20:43 -0400] hoover_damm: it's possible a complete workflow issue
[2012-06-05 18:20:46 -0400] pwf: silly devs modifying roles they shouldn't be and breaking things in production :|
[2012-06-05 18:20:48 -0400] hoover_damm: that is a soft issue
[2012-06-05 18:20:51 -0400] Mithrandir: I'd like roles to be versioned and live on a file system so I could look at how things was set up earlier.
[2012-06-05 18:20:56 -0400] hoover_damm: that's a soft issue
[2012-06-05 18:21:09 -0400] kallen: what's a "soft issue"?
[2012-06-05 18:21:16 -0400] hoover_damm: soft issue is between the user and the software
[2012-06-05 18:21:22 -0400] pwf: PEBKAC
[2012-06-05 18:21:25 -0400] hoover_damm: a hard issue is where you actually need to make a code change to address it
[2012-06-05 18:21:27 -0400] kallen: i.e. workflow issue?
[2012-06-05 18:21:30 -0400] hoover_damm: totally
[2012-06-05 18:21:53 -0400] yfeldblum: pwf, why do devs upload things to the production infrastructure's chef-server-api?
[2012-06-05 18:21:55 -0400] hoover_damm: basically someone remove's something from a role too early because they refactored it out
[2012-06-05 18:22:02 -0400] hoover_damm: boot up a new instance and they're still testing and you go splat
[2012-06-05 18:22:12 -0400] pwf: yfeldblum: we're using environments in hosted chef to keep that stuff separate
[2012-06-05 18:22:17 -0400] yfeldblum: kallen, it's a solved problem: use N chef-server setups for N independent infras :P
[2012-06-05 18:22:20 -0400] pwf: which, until now, seemed like the entire point of environments
[2012-06-05 18:22:43 -0400] pwf: but yeah, i'm definitely leaning towards different chef-servers for our dev/qa/prod areas
[2012-06-05 18:22:48 -0400] yfeldblum: pwf, environments will not suffice to keep that stuff separate, because if you look at environments (as they currently exist) they are not tenants and they do not provide strong isolation
[2012-06-05 18:22:55 -0400] kallen: managing N+ chef-servers sounds harder to me at the moment. but it might be "just" a learning curve issue
[2012-06-05 18:23:08 -0400] hoover_damm: i've taken extra steps around this pwf with my clients.  It takes extra steps as we leave the 'roles' alone and we fork the roles
[2012-06-05 18:23:33 -0400] hoover_damm: so if i'm refactoring the cron role, create a cron_refactor role to embody those changes.  Don't touch cron until it's live.
[2012-06-05 18:23:43 -0400] hoover_damm: But you can also just take this as easily as a versioning smeantic
[2012-06-05 18:24:00 -0400] hoover_damm: once you add something you cannot remove it or change it beyond it's current point
[2012-06-05 18:24:02 -0400] yfeldblum: kallen, not terribly
[2012-06-05 18:24:17 -0400] hoover_damm: that is how I lived previously.  It wasn't that bad
[2012-06-05 18:24:25 -0400] hoover_damm: always looking forward and not back
[2012-06-05 18:24:33 -0400] pwf: that seems like a pain though hoover_damm
[2012-06-05 18:24:45 -0400] pwf: having a dev chef-server-api would be a big win for us
[2012-06-05 18:24:57 -0400] hoover_damm: pwf, have the dev sign up for their own platform account?
[2012-06-05 18:25:14 -0400] hoover_damm: pwf and have them do the testing on their account, export ORGNAME="myrealorg" knife cookbook upload
[2012-06-05 18:25:17 -0400] hoover_damm: as the release act
[2012-06-05 18:25:19 -0400] kallen: i should mention i'm not hosted chef, but run my own chef server. if that makes a difference
[2012-06-05 18:25:33 -0400] hoover_damm: pwf, when I do hardcore testing... I use my own platform account
[2012-06-05 18:25:42 -0400] pwf: also a good idea
[2012-06-05 18:25:45 -0400] hoover_damm: pwf, no need to inspire doom unneccesarily
[2012-06-05 18:25:56 -0400] pwf: we also ran into the problem of devs trampling each other's changes today
[2012-06-05 18:26:00 -0400] pwf: even in the dev environment
[2012-06-05 18:26:08 -0400] hoover_damm: thats a communication issue sadly
[2012-06-05 18:26:11 -0400] pwf: yeah
[2012-06-05 18:26:31 -0400] hoover_damm: but if you store everything in git, even if you trample each other
[2012-06-05 18:26:39 -0400] hoover_damm: it should just be a blight that can be fixed with a re-upload
[2012-06-05 18:26:48 -0400] hoover_damm: but if they're bad on the versioning of cookbooks
[2012-06-05 18:27:42 -0400] geekbri: I have a VM where i setup chef-server which i use to test as many of my cookbooks as I can
[2012-06-05 18:28:09 -0400] hoover_damm: also if you have a modern instance... don't forget lxc
[2012-06-05 18:28:16 -0400] geekbri: lxc is nice as well.
[2012-06-05 18:28:20 -0400] hoover_damm: it is a great way to fire up a chroot and do another chef-server
[2012-06-05 18:28:23 -0400] hoover_damm: on your staging db
[2012-06-05 18:28:56 -0400] hoover_damm: just don't run migrations while you deploy with chef... j/k
[2012-06-05 18:29:47 -0400] pwf: are chef servers difficult to set up?
[2012-06-05 18:29:59 -0400] pwf: i'm thinking about making a Vagrantfile for one, distributing it with source
[2012-06-05 18:30:13 -0400] pwf: so devs just have to checkout, cd to ./chef-server, and vagrant up
[2012-06-05 18:30:29 -0400] pwf: and the repo will also come with a ./.chef/knife.rb that points to localhost
[2012-06-05 18:30:38 -0400] jeffg: anybody know which framework was used to create the latest set of open training slides?
[2012-06-05 18:30:56 -0400] cheeseplus: pwf: you can do it pretty easily
[2012-06-05 18:31:19 -0400] cheeseplus: pwf: just set one up a few days ago, took under an hour easy if you install from a package
[2012-06-05 18:33:42 -0400] geekbri: pwf: they could also use chef-solo potentially
[2012-06-05 18:34:00 -0400] geekbri: it really depends on the cookbook you are writing but there is a chef-solo extension that will even allow for search
[2012-06-05 18:34:12 -0400] mjreed: OK, chef-client seems to figure out the node name if it's not in /etc/chef/client.rb
[2012-06-05 18:34:20 -0400] mjreed: but Chef::Config.load_file doesn't
[2012-06-05 18:34:20 -0400] hoover_damm: pwf, as your on hosted.  Educating your staff to open their own hosted account and use their own organization for testing
[2012-06-05 18:34:31 -0400] hoover_damm: pwf, and then have someone upload the cookbooks once they are ready
[2012-06-05 18:34:32 -0400] mjreed: so what's the appropriate way to say "hey, load my chef client config, please" from ruby code?
[2012-06-05 18:34:33 -0400] hoover_damm: pwf, will help
[2012-06-05 18:34:41 -0400] hoover_damm: pwf, a/k/a a release manager
[2012-06-05 18:36:12 -0400] pwf: mjreed: something like this?
[2012-06-05 18:36:12 -0400] pwf: home_config = File.expand_path("~/.chef/knife.rb")
[2012-06-05 18:36:12 -0400] pwf: from_file(home_config) if File.exist?(home_config)
[2012-06-05 18:37:24 -0400] pwf: oh chef config not knife
[2012-06-05 18:39:09 -0400] pwf: hoover_damm: i think i might be able to make it easier on the devs if i can use vagrant to get a virtualized chef-server running with one command
[2012-06-05 18:39:26 -0400] JasonBox: hrm, can I use the @blah ||= pattern in a library?
[2012-06-05 18:39:34 -0400] hoover_damm: rofl
[2012-06-05 18:39:35 -0400] pwf: then they don't have to create an account, organize their keys, etc
[2012-06-05 18:39:40 -0400] pwf: no? :)
[2012-06-05 18:39:42 -0400] hoover_damm: you use opscode platform right?
[2012-06-05 18:39:44 -0400] hoover_damm: or hosted?
[2012-06-05 18:39:51 -0400] pwf: opscode, yes
[2012-06-05 18:39:52 -0400] hoover_damm: do they all share the same account?
[2012-06-05 18:40:06 -0400] hoover_damm: if they do, you should maek them all sign up for accounts
[2012-06-05 18:40:11 -0400] hoover_damm: and then invite them to your organization
[2012-06-05 18:40:16 -0400] hoover_damm: s/maek/make
[2012-06-05 18:40:30 -0400] hoover_damm: they will be on your organization and will get a free organization of their own
[2012-06-05 18:40:36 -0400] hoover_damm: to use/abuse
[2012-06-05 18:40:47 -0400] hoover_damm: look for the easier pattern here :)
[2012-06-05 18:40:51 -0400] pwf: ah i didn't know it came with a free org
[2012-06-05 18:41:07 -0400] hoover_damm: chef_server_url          "https://api.opscode.com/organizations/#{ENV['ORGNAME']}"
[2012-06-05 18:41:11 -0400] hoover_damm: is what I do
[2012-06-05 18:41:18 -0400] yfeldblum: kallen, doesn't make a big difference, really, except for cost
[2012-06-05 18:41:19 -0400] hoover_damm: then I can just export ORGNAME to fix it
[2012-06-05 18:41:28 -0400] hoover_damm: also OPSCODE_USER variables and whatnot
[2012-06-05 18:41:29 -0400] hoover_damm: but yeah
[2012-06-05 18:43:10 -0400] hoover_damm: pwf, yep.  If you are using server now, you should stick to server for development
[2012-06-05 18:43:32 -0400] hoover_damm: moving to vagrant/vagrant hosted chef-server will give you odd errors as they build cookbooks with quirks for their local development environment
[2012-06-05 18:43:35 -0400] hoover_damm: that will break in production
[2012-06-05 18:43:47 -0400] hoover_damm: as it won't be the same exact environment
[2012-06-05 18:46:32 -0400] pwf: good point
[2012-06-05 18:46:40 -0400] hoover_damm: pwf, you can likely help somewhat by adding notifications when uploading cookbooks
[2012-06-05 18:46:42 -0400] pwf: didn't realize creating an organization was so easy :)
[2012-06-05 18:46:46 -0400] hoover_damm: and whatnot
[2012-06-05 18:47:00 -0400] pwf: i'm really pushing for separate orgs now
[2012-06-05 18:47:03 -0400] hoover_damm: but to me if you have a bunch of chef developers they should all be in the same room talking
[2012-06-05 18:47:09 -0400] hoover_damm: irc, campfire, whatever
[2012-06-05 18:47:28 -0400] hoover_damm: so that way when they upload x they can just say 'hey i just uploaded cookbook x at version 0.6.3"
[2012-06-05 18:47:35 -0400] hoover_damm: and have it be gotten clearly
[2012-06-05 18:47:56 -0400] hoover_damm: pwf, there's no easy fix, but I hope at least the ideas we've given you can help solve it
[2012-06-05 18:48:20 -0400] pwf: certainly
[2012-06-05 18:48:22 -0400] pwf: thank you
[2012-06-05 18:48:28 -0400] hoover_damm: that and shove knife.rb in chef-repo/.chef
[2012-06-05 18:48:36 -0400] hoover_damm: and parameterize it enough that it's a per user basis
[2012-06-05 18:49:14 -0400] hoover_damm: pwf, https://gist.github.com/1315560b320dc30699a8
[2012-06-05 18:49:36 -0400] hoover_damm: pwf that way they can switch orgs / etc easily on the fly on a shell command
[2012-06-05 18:49:42 -0400] pwf: exactly what i'm doing at the moment :)
[2012-06-05 18:51:11 -0400] hoover_damm: :)
[2012-06-05 18:53:08 -0400] resno: i tried settingup chef server on ubuntu and it kinda failed. does centos install workbetter/
[2012-06-05 18:53:36 -0400] cheeseplus: resno: 12.04?
[2012-06-05 18:53:46 -0400] resno: cheeseplus: no, 10.04 LTS
[2012-06-05 18:54:26 -0400] cheeseplus: ahh well that may be more difficult, I didn't have any issues on 12.04
[2012-06-05 18:54:33 -0400] yfeldblum: if you have multiple infra devs, they should not be uploading cookbooks
[2012-06-05 18:54:46 -0400] yfeldblum: to any central server
[2012-06-05 18:54:48 -0400] resno: cheeseplus: ok, ill get 12.04 setup then
[2012-06-05 18:55:20 -0400] cheeseplus: the only thing that was slightly wonky for me was chef-webserver-ui
[2012-06-05 18:55:47 -0400] cheeseplus: doesn't startup properly on boot but once you manually start it, it's fine
[2012-06-05 18:55:59 -0400] yfeldblum: rather, each dev gets his own small isolated infra for testing to which he can upload cookbooks, and an automated tool syncs cookbooks from git to the central server separately
[2012-06-05 19:04:12 -0400] mjreed: Chef::Config.from_file works
[2012-06-05 19:04:22 -0400] mjreed: but the /etc/chef/client.rb doesn't have node_name if the node_name is equal to the fqdn
[2012-06-05 19:04:28 -0400] mjreed: at least, not with the default chef-client cookbook
[2012-06-05 19:04:35 -0400] mjreed: so you end up with no node name in the config
[2012-06-05 19:04:39 -0400] mjreed: and can't do anything until you set one
[2012-06-05 19:05:00 -0400] mjreed: so is the logic chef-client uses to set that exposed anywhere or do I have to do it manually?
[2012-06-05 19:07:01 -0400] twelvetones: anybody else find the cookbook updates from hosted chef to be painfully slow?
[2012-06-05 19:07:26 -0400] geekbri: mjreed: all of the chef-client code is on any system where the gem is installed :)
[2012-06-05 19:08:17 -0400] mjreed: Thanks, geekbri. :)
[2012-06-05 19:09:40 -0400] geekbri: mjreed: gem env should tell you your gem path, it should be in there
[2012-06-05 19:11:37 -0400] twelvetones: 10 minutes to pull down 12 cookbooks into the cache? seems wrong
[2012-06-05 19:12:10 -0400] yfeldblum: twelvetones, heh! any large files in the cookbooks?
[2012-06-05 19:12:36 -0400] twelvetones: nope, and they're mainly community standards like yum, monit, users, rvm
[2012-06-05 19:13:13 -0400] twelvetones: maybe they're capping my download speed because i'm on a free trial
[2012-06-05 19:13:41 -0400] yfeldblum: they're opscode-supported cookbooks, not community standard cookbooks :P
[2012-06-05 19:13:50 -0400] twelvetones: haha fair enough
[2012-06-05 19:14:03 -0400] yfeldblum: cookbook files are downloaded from S3 i believe for hosted
[2012-06-05 19:15:59 -0400] cheeseplus: I blame Amazon for everything first
[2012-06-05 19:16:08 -0400] twelvetones: hm, this is my first client run against hosted chef so maybe there's some syncing to S3 happening behind the scenes
[2012-06-05 19:17:14 -0400] yfeldblum: doubtful; syncing would likely happen when you upload the cookbook
[2012-06-05 19:19:25 -0400] twelvetones: yeah, agreed. can't understand why pulling cookbooks/rvm/Rakefile would ever take 7 seconds though..
[2012-06-05 19:21:24 -0400] yfeldblum: ask the S3 crew/
[2012-06-05 19:22:09 -0400] twelvetones: yeah, starting to think it may have to do with vagrant network setup, not hosted chef. time to go down that rabbit hole !
[2012-06-05 19:22:50 -0400] yfeldblum: not sure why you're using hosted-chef with a vagrant box, but that may be something to look into
[2012-06-05 19:23:59 -0400] JasonBox: hrm, too cute by half, it seems my library methods aren't usuable within a template's variables() option
[2012-06-05 19:24:42 -0400] twelvetones: yfeldblum: would you recommend stick with chef-solo for vagrant, or just using an in-house chef server for dev?
[2012-06-05 19:25:12 -0400] yfeldblum: twelvetones, depends; what are you doing with the vagrant boxes?
[2012-06-05 19:25:24 -0400] twelvetones: cookbook development
[2012-06-05 19:26:19 -0400] JasonBox: I have been spinning my own with cobbler
[2012-06-05 19:26:24 -0400] yfeldblum: twelvetones, when developing cookbooks, i would suggest isolating the development to its own independent infrastructure; that can be as small as chef-solo on a vagrant box, or it can even be a chef-server-api on a vagrant box and chef-client on the same vagrant box
[2012-06-05 19:27:12 -0400] freecandy: What the dick is this? Are we not talking about food preperation?
[2012-06-05 19:27:33 -0400] cheeseplus: we can
[2012-06-05 19:27:46 -0400] twelvetones: <3 food
[2012-06-05 19:28:23 -0400] yfeldblum: JasonBox, a little more context?
[2012-06-05 19:28:33 -0400] thehar: hehe
[2012-06-05 19:28:34 -0400] freecandy: What's your best recipe for a breadless cheesesteak?
[2012-06-05 19:28:38 -0400] yfeldblum: freecandy, depends on what you mean by "food," really
[2012-06-05 19:29:36 -0400] KarlHungus: LOL
[2012-06-05 19:29:48 -0400] JasonBox: yfeldblum: Oh, I finally did up my first 'library'
[2012-06-05 19:30:23 -0400] JasonBox: But when calling a template and passing my method name to variables, i.e. :ips => my_ip_function it can't find it
[2012-06-05 19:30:45 -0400] yfeldblum: JasonBox, what's your library file look like?
[2012-06-05 19:30:50 -0400] JasonBox: Clearly some boundary issues :)
[2012-06-05 19:31:08 -0400] JasonBox: So I'm assigning the result to a local variable in the recipe, then passing that to the template
[2012-06-05 19:31:09 -0400] ev-: Hi there, have there been any reported issues with ohai 0.6.12 not being able to detect the "virtualization" type being vmware("if node.virtualization.system == "vmware"") ?
[2012-06-05 19:31:11 -0400] twelvetones: yfeldblum: thanks for the insights. I'll consider that carefully.
[2012-06-05 19:32:01 -0400] JasonBox: yfeldblum: http://pastie.org/4033529
[2012-06-05 19:32:07 -0400] JasonBox: Probably silliness, but that's what I came up with
[2012-06-05 19:32:18 -0400] JasonBox: I was feeling frisky today
[2012-06-05 19:32:54 -0400] yfeldblum: JasonBox, is the module defined in your library file included anywhere?
[2012-06-05 19:33:00 -0400] JasonBox: Yeah
[2012-06-05 19:33:11 -0400] JasonBox: The same way the OpenSSL library is included in the mysql cookbook
[2012-06-05 19:33:13 -0400] yfeldblum: JasonBox, how?
[2012-06-05 19:33:23 -0400] JasonBox: ::Chef::Recipe.send(:include, Xtra::Dnsmasq)
[2012-06-05 19:33:40 -0400] yfeldblum: JasonBox, there's your problem, then ...
[2012-06-05 19:33:54 -0400] JasonBox: Indeed
[2012-06-05 19:34:34 -0400] ev-: Here is what im seeing: https://gist.github.com/2877234
[2012-06-05 19:34:40 -0400] JasonBox: But if I include it into Template, will my @instance get lost?
[2012-06-05 19:35:34 -0400] yfeldblum: JasonBox, don't include it into Chef::Resource::Template ...
[2012-06-05 19:35:39 -0400] JasonBox: Oh
[2012-06-05 19:35:46 -0400] yfeldblum: JasonBox, try including it into Chef::RunContext?
[2012-06-05 19:36:00 -0400] yfeldblum: JasonBox, what do you mean by "my @instance"?
[2012-06-05 19:36:19 -0400] JasonBox: Oh, I cache my processed output from network interfaces
[2012-06-05 19:36:28 -0400] JasonBox: @blah ||= begin ...
[2012-06-05 19:38:18 -0400] yfeldblum: JasonBox, this is really stretching things, but Chef::Resource defines #method_missing to forward messages sent to resources for which the resource doesn't define a method, to the calling run-context
[2012-06-05 19:39:20 -0400] yfeldblum: so if you call `my_ip_function` inside a resource's declaration block, the resource isn't going to know what to do with it, so it's just going to forward that message on to the containing run-context
[2012-06-05 19:39:36 -0400] JasonBox: Oh, it's not super important; there was a 0.9.x ticket about instance variables, recipes, and templates
[2012-06-05 19:39:57 -0400] JasonBox: Not feeling that frisky ;)
[2012-06-05 19:40:14 -0400] yfeldblum: hehe my answer is: never use instance variables in recipes because you're defining a class or module, and instance variables are strictly for when you're defining a class or module
[2012-06-05 19:40:27 -0400] yfeldblum: because recipes are *not* defining a class or module
[2012-06-05 19:40:31 -0400] JasonBox: True enough
[2012-06-05 19:41:03 -0400] JasonBox: It may not even be necessary to cache the output, just over optimizing
[2012-06-05 19:41:56 -0400] yfeldblum: JasonBox, you may prefer to write `extend self` at the top of your module, and then you will be able to call the functions like this: `variables :addrs => Xtra::Dnsmasq.addresses_by_iface("eth0")` without problem
[2012-06-05 19:42:36 -0400] JasonBox: That would be cool
[2012-06-05 19:43:10 -0400] syphon: Newbie Question: Does Chef (chef-solo specifically) try to scan/load all cookbooks in a repository before executing the runlist?
[2012-06-05 19:43:10 -0400] yfeldblum: JasonBox, and then you wouldn't need to include your module into Chef::RunContext
[2012-06-05 19:43:19 -0400] yfeldblum: syphon, yes, chef-solo does that
[2012-06-05 19:43:40 -0400] syphon: bleh, how can I suppress that? My linux client is barfing when it tries to scan a Windows cookbook (even though it's not in its runlist)
[2012-06-05 19:43:54 -0400] JasonBox: Oh, on which version of Chef? I still have 0.10.6
[2012-06-05 19:44:02 -0400] JasonBox: Using RBEL
[2012-06-05 19:45:27 -0400] yfeldblum: syphon, by removing the windows cookbook
[2012-06-05 19:45:32 -0400] yfeldblum: syphon, or by fixing the problems with it
[2012-06-05 19:46:23 -0400] syphon: but its not broken... it's just that it (obviously) won't run on linux. I want all nodes to pull from the same repository (via NFS)
[2012-06-05 19:47:11 -0400] yfeldblum: syphon, if it's barfing on linux, it's broken
[2012-06-05 19:47:42 -0400] yfeldblum: syphon, if it's barfing just being loaded without even any recipes being run or definitions/libraries/providers/resources being used
[2012-06-05 19:48:57 -0400] syphon: This is just the Windows cookbook from the community site (it's not one we created). Obviously I don't want to run it on my linux clients, but it is going to be in the repository
[2012-06-05 19:49:07 -0400] JasonBox: Oh: undefined local variable or method `node' for Xtra::Dnsmasq:Module
[2012-06-05 19:49:51 -0400] JasonBox: Xtra::Dnsmasq.addresses_by_iface(node['dnsmasq']['interface'])
[2012-06-05 19:50:21 -0400] yfeldblum: JasonBox, that's right; if you do it like that, then the module doesn't intrinsically have access to any of the methods already in Chef::RunContext, methods such as `node`
[2012-06-05 19:50:40 -0400] yfeldblum: JasonBox, so if you do it like that, you would have to pass in the node (and any other inputs required) as an argument
[2012-06-05 19:50:55 -0400] JasonBox: ah
[2012-06-05 19:51:35 -0400] yfeldblum: JasonBox, whereas if you included the module in Chef::RunContext, then the methods from your module are now instance methods on instances of Chef::RunContext too, and can call other methods on the same instance Chef::RunContext, such as `node`
[2012-06-05 19:52:16 -0400] rabidpraxis: Does anyone know if the deploy resource will pull the latest revision from git on each client run? I can't seem to get it to update.
[2012-06-05 19:52:18 -0400] JasonBox: Is there a preference for one or the other?
[2012-06-05 19:53:32 -0400] yfeldblum: JasonBox, if you include your module into Chef::RunContext and the methods are specific to your cookbook, you will really want to prefix your the methods in your module with the name of your cookbook just to be sure there's not going to be any name collisions
[2012-06-05 19:53:57 -0400] JasonBox: Yeah, I was thinking about that myself
[2012-06-05 20:01:35 -0400] JasonBox: yfeldblum: Thanks!
[2012-06-05 20:01:42 -0400] yfeldblum: no probs
[2012-06-05 20:06:21 -0400] mattray: is there an easy way to get ohai to only run a single plugin?
[2012-06-05 20:06:39 -0400] sascha_d: can't you -f?
[2012-06-05 20:08:18 -0400] mattray: ahh, yes
[2012-06-05 20:08:21 -0400] mattray: I was using -d
[2012-06-05 20:08:26 -0400] mattray: but what I really wanted was f
[2012-06-05 20:11:21 -0400] JasonBox: hrm, what cookbooks are people using for /etc/hosts?
[2012-06-05 20:12:18 -0400] hippiehacker: mattray: just realized that cowboyd is abroad for a while, we'll have to get together without him 8)
[2012-06-05 20:12:51 -0400] cowboyd: mattray: hippiehacker: sup. (from Finland)
[2012-06-05 20:22:49 -0400] mattray: sascha_d: turns out -f isn't what I need
[2012-06-05 20:23:16 -0400] sascha_d: oh
[2012-06-05 20:23:27 -0400] sascha_d: you could dump your plugin in a separate dir and then do -d?
[2012-06-05 20:23:57 -0400] sascha_d: every time I need to do what you're doing, I have to figure it out again, because I can't ever remember
[2012-06-05 20:24:18 -0400] mattray: yeah, I'm using -d
[2012-06-05 20:24:43 -0400] mattray: but I really don't want to see all the other output
[2012-06-05 20:24:53 -0400] mattray: I want a "-a" or somesuch
[2012-06-05 20:25:03 -0400] hoover_damm: you can display the key
[2012-06-05 20:25:04 -0400] hoover_damm: ohai ec2
[2012-06-05 20:25:10 -0400] hoover_damm: and it'll only print out the ec2 key
[2012-06-05 20:25:19 -0400] sascha_d: yes that too
[2012-06-05 20:25:20 -0400] mattray: hoover_damm: cool, thanks
[2012-06-05 20:25:31 -0400] mattray: now I just need to figure out why it's empty :)
[2012-06-05 20:25:44 -0400] sascha_d: I figured you were working on a custom plugin and already knew that you could give it a key arg
[2012-06-05 20:25:56 -0400] sascha_d: don't Opscode peeps know everything about chef?
[2012-06-05 20:26:03 -0400] hoover_damm: no
[2012-06-05 20:26:04 -0400] mattray: only the smart ones
[2012-06-05 20:26:07 -0400] sascha_d: damn
[2012-06-05 20:26:09 -0400] sascha_d: k
[2012-06-05 20:26:16 -0400] hoover_damm: the smart ones come in to irc and learn from the people who actually use it.
[2012-06-05 20:26:22 -0400] hoover_damm: j/k
[2012-06-05 20:26:25 -0400] sascha_d: :D
[2012-06-05 20:26:31 -0400] thehar: lulz
[2012-06-05 20:27:18 -0400] hoover_damm: seriously
[2012-06-05 20:27:34 -0400] yfeldblum: hoover_damm, it's true :P
[2012-06-05 20:27:49 -0400] yfeldblum: and it's true with every project: you must learn from your users
[2012-06-05 20:28:00 -0400] hoover_damm: well it's a design flaw
[2012-06-05 20:28:19 -0400] yfeldblum: you, the author, merely wrote the darn thing; you have no idea how it actually operates when people try to solve problems with it
[2012-06-05 20:28:21 -0400] hoover_damm: if you design for yourself you get locked into a perception of your world and care of project
[2012-06-05 20:28:30 -0400] hoover_damm: your users may not have the same perception or use of your project
[2012-06-05 20:28:50 -0400] hoover_damm: so having feedback is how you evolve beyond what works for 'me'
[2012-06-05 20:29:17 -0400] mattray: I'm not an author in any sense
[2012-06-05 20:30:16 -0400] mattray: I'm more at the userspace of Chef. knife plugins, cookbooks and now an ohai plugin
[2012-06-05 20:30:42 -0400] hoover_damm: mattray, high level author... grass roots author
[2012-06-05 20:30:44 -0400] hoover_damm: no difference
[2012-06-05 20:30:52 -0400] davetoo: mattray: howdy
[2012-06-05 20:30:56 -0400] hoover_damm: still takes hard work
[2012-06-05 20:31:09 -0400] hoover_damm: mattray, I'm just saying don't downplay yourself
[2012-06-05 20:31:19 -0400] mattray: dcarmean: good to see you
[2012-06-05 20:31:26 -0400] dcarmean: :)
[2012-06-05 20:31:31 -0400] dcarmean: I've moved on
[2012-06-05 20:31:42 -0400] mattray: hoover_damm: lots of folks in here have been using Chef much longer than I
[2012-06-05 20:31:46 -0400] dcarmean: my year at Z is over :)
[2012-06-05 20:32:22 -0400] hoover_damm: mattray, still
[2012-06-05 20:32:48 -0400] mattray: I do have the advantage of getting to work on the same project most of the time
[2012-06-05 20:38:09 -0400] resno: i want to like chef but its just more and more confusing :(
[2012-06-05 20:38:22 -0400] itwasntandy: how so?
[2012-06-05 20:39:25 -0400] resno: cant get chef serverisntalled.. i went thehosted way, and seems i cant punch my way out of a wet paper bag
[2012-06-05 20:40:20 -0400] cwj: anyone have an idea about using chef to set up @reboot crons?
[2012-06-05 20:40:34 -0400] cheeseplus: resno: where are you getting stuck?
[2012-06-05 20:41:21 -0400] resno: cheeseplus: so for the time being lets go 'hosted'. im suppose to pass json to pre-made cookbooks right?
[2012-06-05 20:41:39 -0400] resno:  so for the time being lets go 'hosted'. im suppose to pass json to pre-made cookbooks right?
[2012-06-05 20:43:35 -0400] cheeseplus: how are you trying to pass this json?
[2012-06-05 20:43:54 -0400] resno: i looked at the wiki and im not entirely sure how to do it
[2012-06-05 20:44:15 -0400] cheeseplus: so what commands are you doing this through and what wiki page?
[2012-06-05 20:44:41 -0400] cheeseplus: trying to follow along ;)
[2012-06-05 20:44:53 -0400] yfeldblum: resno, you don't have to use premade cookbooks; indeed, you are *expected* to write cookbooks to suite your infrastructure needs for any sufficiently complex infrastructure, but are welcome to use premade cookbooks if and when and to the extent that they exist and meet your needs effectively
[2012-06-05 20:44:55 -0400] resno: one sec, im picking this up after a break.
[2012-06-05 20:45:30 -0400] resno: yfeldblum: for now, im justtrying to install redmine, preetyy easy useage
[2012-06-05 20:46:36 -0400] resno: cheeseplus: dont worry about it now, im tired and my day isnearly ended
[2012-06-05 20:46:49 -0400] resno: ill try again tommorrow
[2012-06-05 20:47:03 -0400] cheeseplus: resno: no worries, just happy to help
[2012-06-05 20:48:08 -0400] yfeldblum: resno, you'll still want to think in terms of writing a recipe to perform some element of configuration, rather than in terms of nodes and attributes and json and all
[2012-06-05 20:59:04 -0400] yfeldblum: resno, think about the manual steps you would take in order to deploy a redmine server, and think about what are the goals of these manual steps, and then translate that into a recipe with a sequence of resources such as file resources, service resources, package resources, etc
[2012-06-05 20:59:52 -0400] resno: yfeldblum: do you think it would be easier to make my own versus using a prebuilt one?
[2012-06-05 21:00:24 -0400] resno: yfeldblum: i can see space for similar steps
[2012-06-05 21:02:28 -0400] yfeldblum: resno, i think you will constantly be frustrated by the fact that other people's cookbooks sometimes don't match exactly what you're trying to do, and it depends on the particular details of each case whether that's true in that case or not
[2012-06-05 21:02:52 -0400] yfeldblum: resno, i think you should certainly look at how https://github.com/vdemeester/chef-redmine is written, and use that to help you write a recipe yourself
[2012-06-05 21:03:06 -0400] yfeldblum: resno, because chef is about writing down your infrastructure as *code*, not as json files
[2012-06-05 21:03:51 -0400] yfeldblum: resno, and so the key thing is to become comfortable writing that code first, and then figuring out how to interoperate with other people's code second
[2012-06-05 21:04:44 -0400] yfeldblum: resno, and again, that differs from person to person, depending on the individual's prior knowledge and style of learning and general tastes and preferences, so i'm not going to make a sweeping statement about what everyone should do
[2012-06-05 21:05:17 -0400] yfeldblum: resno, i'm just offering a suggestion about a different way to go about learning the system, one that i think may help (but it may not)
[2012-06-05 21:06:56 -0400] yfeldblum: resno, so, maybe, it might be easier to make your own, and maybe not - but at least it's a different approach to what you've tried so far, and new knowledge comes from new experience
[2012-06-05 21:07:12 -0400] yfeldblum: resno, so, couldn't hurt to try it out
[2012-06-05 21:46:19 -0400] Twirrim: "Chef Run complete in 806.988569 seconds".  Got to love running relatively simple recipes on a VM running on this rather slow workstation :D
[2012-06-05 21:46:38 -0400] Twirrim: same recipe on proper hardware completes in <60s
[2012-06-05 22:01:46 -0400] JasonBox: Twirrim: Yeah
[2012-06-05 22:01:54 -0400] JasonBox: Twirrim: I get that a lot, too, and it's always a blast ;)
[2012-06-05 22:02:05 -0400] JasonBox: Not as painful as running through a full kickstart install, though ;)
[2012-06-05 22:09:29 -0400] kallen: i'm starting to try out cookbook versioning in my environments file. my env file is in json format. when i try to upload it, i get an error:
[2012-06-05 22:09:34 -0400] kallen: ERROR: Chef::Exceptions::ValidationFailed: Option cookbook_versions's value {"cb-version-test"=>"=> 0.0.3", "cb-version-doot"=>"=> 0.0.6"} should be a valid set of cookbook version requirements!
[2012-06-05 22:09:50 -0400] kallen: how do i figure out what syntax it wants? (i've found no examples yet)
[2012-06-05 22:10:06 -0400] kallen: content is:
[2012-06-05 22:10:06 -0400] kallen:   "cookbook_versions": {
[2012-06-05 22:10:14 -0400] kallen:    "cb-version-test": "=> 0.0.3",
[2012-06-05 22:10:21 -0400] kallen:    "cb-version-doot": "=> 0.0.6",
[2012-06-05 22:10:36 -0400] kallen:    "cb-version-hrm": "=> 0.0.9"
[2012-06-05 22:10:39 -0400] kallen: },
[2012-06-05 22:10:55 -0400] kallen: sorry the content example doesn't match error output .. but yeah
[2012-06-05 22:12:03 -0400] kallen: p.s. Venus is transiting. go look. (safely)
[2012-06-05 22:12:24 -0400] yfeldblum: kallen, what is "=> 0.0.3" supposed to mean?
[2012-06-05 22:12:52 -0400] yfeldblum: kallen, that's not a valid version requirement
[2012-06-05 22:13:36 -0400] kallen: afaik, "this environment requires version of cb-version-test cookbook greater than or equal to 0.0.3"
[2012-06-05 22:14:21 -0400] yfeldblum: kallen, you may be looking for ">=" rather than "=>"
[2012-06-05 22:14:24 -0400] kallen: ahhhh
[2012-06-05 22:14:44 -0400] kallen: \o/  fixed. thanks :>
[2012-06-05 22:55:25 -0400] excalq: Is there a way to completely clear a node's run_list? (I want to script a deployment, but need to blitz the initial build runlist)
[2012-06-05 23:01:35 -0400] paulmooring: excalq: if it's just a single node `knife node edit <node name>` would be easiest
[2012-06-05 23:02:43 -0400] excalq: I need to do it non-interactively
[2012-06-05 23:02:48 -0400] excalq: via a shell script
[2012-06-05 23:03:29 -0400] excalq: I was able to do it by doing `knife node run_list remove <node-name> "<all possible init + deploy runlists>"`
[2012-06-05 23:03:35 -0400] excalq: which isn't elegant, but works
[2012-06-05 23:03:54 -0400] paulmooring: that was my next recommendation
[2012-06-05 23:05:30 -0400] KarlHungus: https://gist.github.com/5664ea966e61ac803f4c
[2012-06-05 23:05:44 -0400] KarlHungus: does that make any sense? why am i getting a nil where I expect a string
[2012-06-05 23:05:54 -0400] KarlHungus: this works great on my other nodes...
[2012-06-05 23:09:02 -0400] paulmooring: what does node['collected']['etc_dir'] return?
[2012-06-05 23:09:37 -0400] KarlHungus: node['collectd']['etc_dir'] => "/usr/local/etc/collectd"
[2012-06-05 23:09:57 -0400] KarlHungus: did i typo to 'collected' somewhere and am just overlooking it??
[2012-06-05 23:12:37 -0400] paulmooring: It looks ok to me, I'm trying it now
[2012-06-05 23:12:53 -0400] KarlHungus: well, it works great on a bunch of other nodes, in chef-client and shef
[2012-06-05 23:12:58 -0400] KarlHungus: so, i'm quite stumped
[2012-06-05 23:14:07 -0400] hoover_damm: KarlHungus, knife node show whatever -l and it shows the value right?
[2012-06-05 23:14:14 -0400] hoover_damm: -m should work too
[2012-06-05 23:15:13 -0400] KarlHungus: hoover_damm: its a cookbook attribute
[2012-06-05 23:15:56 -0400] KarlHungus: but, no, its not showing...
[2012-06-05 23:16:32 -0400] erikh: knife node show <node> -F j | less
[2012-06-05 23:16:47 -0400] erikh: should work
[2012-06-05 23:17:32 -0400] erikh: OH
[2012-06-05 23:17:42 -0400] erikh: KarlHungus: setting owner and group in the link resource on chef 0.10.10
[2012-06-05 23:17:44 -0400] erikh: right?
[2012-06-05 23:17:56 -0400] KarlHungus: erikh: yes. however i tested with 0.10.8 as well
[2012-06-05 23:17:58 -0400] erikh: you've done hit a chef bug -- I hit it a few weeks back
[2012-06-05 23:18:08 -0400] KarlHungus: i seem to be good at that...
[2012-06-05 23:18:23 -0400] erikh:  yeah, either omit the owner/group or run a bash resource that chmod -h, etc
[2012-06-05 23:18:37 -0400] erikh: err, chown/chgrp
[2012-06-05 23:19:01 -0400] erikh: it's not broken for us on 0.10.8, but maybe I missed it some other way
[2012-06-05 23:19:32 -0400] KarlHungus: yep. that did the trick
[2012-06-05 23:19:35 -0400] erikh: awesomesauce
[2012-06-05 23:19:53 -0400] erikh: I fixed the cable this time
[2012-06-05 23:19:56 -0400] KarlHungus: i have no clue how you found that =) i was about to break out ktrace and start doing some digging
[2012-06-05 23:20:00 -0400] KarlHungus: ;)
[2012-06-05 23:20:04 -0400] erikh: oh, I've just seen it before is all
[2012-06-05 23:20:46 -0400] erikh: fwiw, lines 13 and 14 in your gist
[2012-06-05 23:20:57 -0400] erikh: if you look in the file, it'll reveal it's a chef bug
[2012-06-05 23:21:10 -0400] KarlHungus: interesting
[2012-06-05 23:21:38 -0400] erikh: I sorted the rest out with a little trial & error
[2012-06-05 23:23:16 -0400] KarlHungus: fun times. well, that has things working for today
[2012-06-05 23:23:27 -0400] KarlHungus: time to get a beer and some food
[2012-06-05 23:23:30 -0400] erikh: yeah, my day is almost done too
[2012-06-05 23:23:32 -0400] KarlHungus: thanks, erikh
[2012-06-05 23:23:33 -0400] erikh: enjoy!~
[2012-06-05 23:24:27 -0400] paulmooring: erikh: on 0.10.10 only?
[2012-06-05 23:24:35 -0400] erikh: paulmooring: afaik
[2012-06-05 23:24:37 -0400] KarlHungus: on 0.10.8 for me as well
[2012-06-05 23:24:58 -0400] KarlHungus: hmm
[2012-06-05 23:25:08 -0400] paulmooring: KarlHungus: what distro?
[2012-06-05 23:25:17 -0400] KarlHungus: actually, scraqtch that. this is a new host, and i've updated the stable package set to 0.10.10, so it would have been updated
[2012-06-05 23:25:28 -0400] KarlHungus: i just haven't run the package update cookbook acorss this env yet
[2012-06-05 23:25:35 -0400] KarlHungus: so most are at 0.10.8 which i was expecting
[2012-06-05 23:27:10 -0400] paulmooring: thanks KarlHungus fwiw it's fixed for 0.10.12
[2012-06-05 23:27:11 -0400] hoover_damm: KarlHungus, this is a 0.10.10 bug
[2012-06-05 23:27:24 -0400] hoover_damm: as paul said it'll be fixed :)
[2012-06-05 23:29:11 -0400] erikh: enjoy, folks, it's time to go home
