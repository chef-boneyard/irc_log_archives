[2012-06-19 00:03:12 -0400] qhartman: after upgrading a client to 0.10.12 I'm getting the following error using the python 1.0.6 cookbook: http://pastebin.com/3ysMgGUV Any ideas? This one is beyond me.
[2012-06-19 00:05:32 -0400] qhartman: manually install virtualenv (pip install virtualenv) seems to get around it
[2012-06-19 00:11:49 -0400] rbarrero: Hi there
[2012-06-19 00:11:58 -0400] rbarrero: question about role attributes
[2012-06-19 00:12:20 -0400] rbarrero: If I update a role's defaut attributes, do the nodes pick up these attributes immediately?
[2012-06-19 00:12:27 -0400] rbarrero: or do I have to create a new node from the updated role?
[2012-06-19 00:14:11 -0400] ssd7: rbarrero: Any node with that role in it's run list will process the new attributes on the next chef-client run.
[2012-06-19 00:16:55 -0400] ssd7: Until chef-client run's on that node again, the node will remain unchanged.
[2012-06-19 00:24:17 -0400] matt__: Hello
[2012-06-19 00:24:26 -0400] matt__: I've seen this error many times before
[2012-06-19 00:24:36 -0400] matt__: when running postgreql::client
[2012-06-19 00:24:50 -0400] matt__: it fails when it gets to installing "pg" gem
[2012-06-19 00:25:21 -0400] matt__: i've seen a few fixes for it
[2012-06-19 00:25:45 -0400] matt__: like including the apt recipe right before the postgresql::client
[2012-06-19 00:25:57 -0400] matt__: that worked before, but for some reason, now it isn't
[2012-06-19 00:27:01 -0400] matt__: and now i'm again getting the following error: "FATAL: Gem::Installer::ExtensionBuildError: gem_package[pg] (postgresql::client line 32) had an error: Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension."
[2012-06-19 00:27:34 -0400] matt__: line 32: gem_package "pg"
[2012-06-19 00:29:00 -0400] matt__: any thoughts on how to provide a good fix for this?
[2012-06-19 00:29:01 -0400] qhartman: if you try to run that command manually, what does gem output? It sounds like you might be missing build-essential or something similar requirted to build the pg gem.
[2012-06-19 00:29:03 -0400] btm: matt__: have you tried running 'sudo gem install pg' manually to see if it gives a clue as to what it is lacking? Usually it is a build environment (like the build-essentials package on ubuntu usually resolves this)
[2012-06-19 00:29:09 -0400] btm: qhartman: +1
[2012-06-19 00:29:13 -0400] qhartman: lol
[2012-06-19 00:29:43 -0400] qhartman: heh
[2012-06-19 00:30:10 -0400] qhartman: btm: Just upgraded 10.12 today and it looks good so far....
[2012-06-19 00:30:22 -0400] matt__: I just installed it manually
[2012-06-19 00:30:34 -0400] qhartman: installed the pg gem manually?
[2012-06-19 00:30:35 -0400] matt__: and when i do gem search, i see it listed: pg (0.13.2)
[2012-06-19 00:30:40 -0400] matt__: yes
[2012-06-19 00:31:19 -0400] qhartman: hm, ok. So it seems like it will start working on this host. Could you paste the stack trace from /var/chef/cache into a pastebin? It would be good to get this actuallyfixed.
[2012-06-19 00:32:22 -0400] qhartman: I use the pg recipe a lot too and though I haven't run into this problem myself, it would be nice to help refine it.
[2012-06-19 00:33:19 -0400] matt__: one sec
[2012-06-19 00:33:58 -0400] matt__: http://pastebin.com/tk1Eg5ZQ
[2012-06-19 00:36:04 -0400] erikh: btm: congrats
[2012-06-19 00:36:13 -0400] qhartman: btm: *applause*
[2012-06-19 00:36:34 -0400] btm: omg!
[2012-06-19 00:36:37 -0400] Twirrim: grats
[2012-06-19 00:37:15 -0400] btm: win!
[2012-06-19 00:37:25 -0400] qhartman: third try and all that...
[2012-06-19 00:38:16 -0400] qhartman: matt__, huh, that's an error that's probably beyond my Ruby-fu. Dig into the mkmf.log file that it refers to and see if that yields any clues
[2012-06-19 00:38:59 -0400] qhartman: matt__, since running gem install by hand worked, it seems like chef might be setting some configure parameters that gem isn't liking in this case.
[2012-06-19 01:02:52 -0400] nmistry: is there a suggested way to maintain a network interface within chef.  I want to add a new dummy br0 interface.
[2012-06-19 01:05:50 -0400] hoover_damm: nmistry, template up the file?
[2012-06-19 01:06:05 -0400] hoover_damm: nmistry, there maybe cookbooks on community.opscode.com
[2012-06-19 01:09:11 -0400] nmistry: well, inside a recipe.
[2012-06-19 01:09:22 -0400] nmistry: i think there is network_interfaces cookbook
[2012-06-19 02:21:25 -0400] nmistry: im having trouble w/ new clients authenticating all of a sudden.
[2012-06-19 02:21:46 -0400] nmistry: getting a FATAL: Net::HTTPServerException: 401 "Unauthorized"
[2012-06-19 02:21:56 -0400] nmistry: i have checked the time (sync'd w/ ntp), timezones, etc.
[2012-06-19 02:22:04 -0400] nmistry: valdiation.pem is correct
[2012-06-19 02:22:12 -0400] Randm: did you change your dns information?
[2012-06-19 02:22:20 -0400] Randm: hostname, client hostname, search path?
[2012-06-19 02:22:49 -0400] nmistry: hostname, dns etc dont get set until its bootstrapped, im using knife-rackspace.. i can send a paste
[2012-06-19 02:22:58 -0400] Randm: hmm, dunno then
[2012-06-19 02:23:22 -0400] nmistry: http://pastebin.com/pGZzL6Gv
[2012-06-19 02:23:45 -0400] nmistry: on server and on client it shows 401's
[2012-06-19 02:25:44 -0400] nmistry: is there a way to test the validation.pem from the remote side?
[2012-06-19 02:28:20 -0400] jessicab: nmistry - you could test it with knife? is that what you mean? like knife node list -k .chef/validation.pem
[2012-06-19 02:28:43 -0400] jessicab: that would just use validation.pem to auth instead of your user key
[2012-06-19 02:28:49 -0400] nmistry: k
[2012-06-19 02:30:26 -0400] nmistry: should knife node list -k validation.pem work from my client?
[2012-06-19 02:30:31 -0400] nmistry: b/c its not working
[2012-06-19 02:30:41 -0400] nmistry: and why would it change?
[2012-06-19 02:32:12 -0400] jessicab: nmistry - its probably in the .chef folder, .chef/validation.pem
[2012-06-19 02:32:31 -0400] nmistry: yea its in ~/.chef
[2012-06-19 02:32:37 -0400] nmistry: but it should work right?
[2012-06-19 02:32:43 -0400] nmistry: b/c it does not
[2012-06-19 02:32:53 -0400] jessicab: yea, but youll want to use -k .chef/validation.pem
[2012-06-19 02:33:16 -0400] jessicab: does it just say not found, or does it also 401?
[2012-06-19 02:33:17 -0400] nmistry: right -k ~/.chef/validation.pem
[2012-06-19 02:33:23 -0400] nmistry: 401
[2012-06-19 02:33:35 -0400] nmistry: it finds the key
[2012-06-19 02:34:49 -0400] jessicab: oh sorry, you need to use -u too.. totally forgot about that
[2012-06-19 02:35:07 -0400] jessicab: like knife node list -k .chef/validation.pem -u "chef-validator"
[2012-06-19 02:35:45 -0400] jessicab: but yea, that should work to check if the validation.pem is good locally
[2012-06-19 02:35:47 -0400] nmistry: ok, so it seems that my validator.pem got redone.
[2012-06-19 02:35:55 -0400] nmistry: what would cause that to happen?
[2012-06-19 02:36:01 -0400] nmistry: (other than a user re-generating it)
[2012-06-19 02:37:23 -0400] jessicab: hm.. i cant really think of anything, but i mostly just use hosted chef
[2012-06-19 02:38:05 -0400] nmistry: what if someone deleted the validation.pem file in /etc/chef?
[2012-06-19 02:38:11 -0400] nmistry: and then restarted the service?
[2012-06-19 02:43:21 -0400] matt__: is it possible to use FileUtils.mv() to copy a file from cookbook
[2012-06-19 02:43:51 -0400] matt__: if so, I'm not sure what the path for the file would be
[2012-06-19 02:49:00 -0400] nmistry: thanks for the help jessicab, Randm,
[2012-06-19 05:11:25 -0400] nmistry: can someone help me decode what this actually does:
[2012-06-19 05:11:35 -0400] nmistry: notifies :run resources(:execute => "ifup")
[2012-06-19 05:11:52 -0400] nmistry: this is in the context of a povider defining a template
[2012-06-19 05:12:28 -0400] nmistry: does it just do ifup, or ifup resource name
[2012-06-19 05:17:27 -0400] nmistry: any help appreciated
[2012-06-19 05:22:18 -0400] danryan: hey nmistry, `notifies` will execute the :action (:run in this case) for the resource named "execute[ifup]"
[2012-06-19 05:22:51 -0400] nmistry: what arguments get sent to execute[ifup]?
[2012-06-19 05:22:56 -0400] nmistry: or parameters
[2012-06-19 05:23:32 -0400] danryan: nmistry: only the action specified as the first argument to notifies
[2012-06-19 05:23:42 -0400] danryan: nmistry: no other arguments are passed
[2012-06-19 05:24:49 -0400] danryan: nmistry: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-06-19 05:25:36 -0400] nmistry: why the resources( ) ?
[2012-06-19 05:25:40 -0400] nmistry: danryan^
[2012-06-19 05:26:27 -0400] nmistry: is that DSL for a resource object?
[2012-06-19 05:47:29 -0400] williamherry: what step should follow if I want change  node's name?
[2012-06-19 06:37:11 -0400] BryanWB_: ohai chefs!
[2012-06-19 06:39:08 -0400] specialsauce: o/
[2012-06-19 06:40:09 -0400] BryanWB_: \o
[2012-06-19 06:55:20 -0400] ssd7: Heya
[2012-06-19 08:02:32 -0400] jacobat: I changed the hostname of my chefserver and now rabbitmq is throwing auth errors: "FATAL: Connection to rabbitmq refused."
[2012-06-19 08:02:48 -0400] jacobat: Where should I go read up on that?
[2012-06-19 08:15:54 -0400] Tensibai: jacobat: I would say there: http://wiki.opscode.com/display/chef/Chef+Indexer and there: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2012-06-19 08:16:11 -0400] jacobat: Thanks
[2012-06-19 08:16:37 -0400] Tensibai: there's an auth mechanism on rabbitMQ allowing connection from hostname, I do not 'master' it but heard about it enough
[2012-06-19 08:17:06 -0400] Tensibai: You may also do a search on chef-user list, this kind of problem has been discussed and solved on the list too
[2012-06-19 08:17:13 -0400] Tensibai: Worth a wiki page I think
[2012-06-19 08:44:52 -0400] makuk66: jacobat: http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually, see the "configure rabbitmq" bit.
[2012-06-19 08:45:13 -0400] jacobat: makuk66: Excellent thanks
[2012-06-19 08:45:18 -0400] jacobat: I think I got it now :)
[2012-06-19 08:47:03 -0400] pehlert: How can I access node attributes (from ohai) within my recipes?
[2012-06-19 08:54:26 -0400] Tensibai: pehlert: node['attribute']
[2012-06-19 08:55:55 -0400] pehlert: Thanks
[2012-06-19 09:05:03 -0400] pehlert: When you use a third party cookbook and would like to modify it, what is the best practice to do this? Add it to your repo and modify the code as if it was yours?
[2012-06-19 09:15:14 -0400] BryanWB_: pehlert: fork into your github acct, then clone
[2012-06-19 09:15:21 -0400] BryanWB_: then modify as yours
[2012-06-19 10:36:58 -0400] hippiehacker: https://gist.github.com/2953401 # should a data_bag id that has a '+' in it generate a FATAL: Chef::Exceptions::ValidationFailed: Data Bag Items must contain a Hash or Mash!   OR   FATAL: Chef::Exceptions::InvalidDataBagItemID: Data Bag items must have an id matching /^[\-[:alnum:]_]+$/, you gave: "rails+emacs"
[2012-06-19 10:38:07 -0400] ashb: hippiehacker: yes, seems like the error could be better
[2012-06-19 10:44:29 -0400] drrk: if you understang regular expressions it's a great error, but I can understand that's not idea in general :)
[2012-06-19 10:45:37 -0400] ashb: drrk: the final error is Chef::Exceptions::ValidationFailed: Data Bag Items must contain a Hash or Mash!
[2012-06-19 10:47:59 -0400] fish_: re
[2012-06-19 10:53:19 -0400] drrk: how do I use a LWRP from one cookbook in another?
[2012-06-19 10:55:42 -0400] BryanWB_: drrk: include_recipe "foo"
[2012-06-19 10:56:04 -0400] drrk: will that run the default cookbook aswell?
[2012-06-19 10:56:24 -0400] BryanWB_: drrk: u may have to do some funky stuff iirc
[2012-06-19 10:57:11 -0400] drrk: no, that seemed to do it, thanks
[2012-06-19 10:57:46 -0400] BryanWB_: drrk:  something like Chef::Recipe.send(:include, Opscode::OpenSSL::Password)
[2012-06-19 10:57:50 -0400] BryanWB_: hippiehacker: hey guddy!
[2012-06-19 10:57:55 -0400] BryanWB_: s/guddy/buddy/
[2012-06-19 10:58:07 -0400] drrk: the include_recipe seemed to do it
[2012-06-19 11:16:25 -0400] drrk: if a template has <%= node[:bind9][:allow_recursion] %> is that looking up from attributes?
[2012-06-19 11:17:09 -0400] drrk: sorry If I am asking lots of nebiwe questions, but i've only been using chef-solo for a while
[2012-06-19 11:23:03 -0400] BryanWB_: drrk: y
[2012-06-19 11:23:45 -0400] drrk: so I can set them with knife, or in another recipe
[2012-06-19 11:29:59 -0400] williamherry: does chef provide run command on client, with out ssh?
[2012-06-19 11:30:27 -0400] williamherry: I know knife ssh work fine, but my boss say it is not safe
[2012-06-19 11:38:56 -0400] zts: williamherry: Chef doesn't currently have anything built-in.  I'm using mcollective to kick off chef runs (or sometimes ssh), but it's easy to integrate if you're already using another tool
[2012-06-19 11:41:22 -0400] jacobat: The webui is running very slow for me - like 15+ sec to just get the list of nodes... any way to speed it up?
[2012-06-19 11:41:37 -0400] williamherry: zts, if I use ssh, I have to add key to all client, which is a secure issue. I am think if it is possible to execute command use chef's own auth
[2012-06-19 11:43:11 -0400] zts: williamherry: we allow sysadmins to ssh to machines, and they can "sudo chef-client" and "sudo pkill -USR1 chef-client" (the second one tells a daemonised chef-client to wake up and run)
[2012-06-19 11:43:19 -0400] BryanWB_: williamherry: i do w/ sudo
[2012-06-19 11:43:34 -0400] specialsauce: williamhenry: its percectly safe if you secure the private key file. Any authentication is only as safe as the storage of the private element, be it a password or a key or whatever
[2012-06-19 11:43:41 -0400] zts: williamherry: so it's not a security issue for us, as it doesn't require any more access than our sysadmins already have
[2012-06-19 11:44:59 -0400] zts: williamherry: note that chef-client contacts chef-server, not the other way around - there is no way for the server to contact clients to say "run now"
[2012-06-19 11:45:05 -0400] zts: (though maybe something will be added in the future)
[2012-06-19 11:45:21 -0400] williamherry: if chef server be hacked, all client will in danger, is that right?
[2012-06-19 11:45:52 -0400] zts: if the chef server is hacked, the hacker could put bad information into it, which the clients would then retrieve
[2012-06-19 11:46:21 -0400] specialsauce: (but that could happen with just pull running and regardless of how the server authenticates against the clients)
[2012-06-19 11:46:28 -0400] zts: exactly
[2012-06-19 12:16:45 -0400] fish_: we're bootstrapping new systems (now) without knife bootstrap, so we're just putting the validator.pem + client.rb on the noder and letting the system register itself with chef
[2012-06-19 12:17:35 -0400] fish_: this works fine, but for whatever reason the server_url in the node is wrong. it was correctly set in the client.rb but after running the chef cookbook it overwrites the client.rb with node[:chef][:server_url]
[2012-06-19 12:19:12 -0400] fish_: oh.. I think I just figured it out..
[2012-06-19 12:19:15 -0400] fish_: never mind :)
[2012-06-19 12:20:40 -0400] dkannan: how do i override an attribute defined in cookbook1 in cookbook2 ?
[2012-06-19 12:22:20 -0400] dkannan: cookbooks/nginx has a nginx.version. need to overwrite in site-cookbooks/default. i tried node.overwrite - but does not work
[2012-06-19 12:22:50 -0400] dkannan: works if i set in the json_attributes files, node.json. but like it to be in code
[2012-06-19 12:38:03 -0400] dkannan: got it
[2012-06-19 12:39:04 -0400] jacobat: Anyone seens this before: Named route node could not be generated with {:id=>nil} - (Merb::Router::GenerationError)
[2012-06-19 12:39:49 -0400] jacobat: Full backtrace http://pastie.org/4114187
[2012-06-19 12:47:57 -0400] yfeldblum: dkannan, are you looing for `node.override`?
[2012-06-19 12:55:55 -0400] jacobat: It would appear there's something broken in my database of nodes... "knife node list" fails, but "knife client list" succeeds
[2012-06-19 13:14:51 -0400] intinig: hello all
[2012-06-19 13:15:14 -0400] intinig: is it expected that knife ec2 server start <insert stuff to run ubuntu instance here> fails on bootstrap?
[2012-06-19 13:15:52 -0400] intinig: http://tickets.opscode.com/browse/CHEF-3212
[2012-06-19 13:22:19 -0400] btm: intinig: we're aware that yesterdays 10.12 release doesn't have a valid omnibus package (due to naming). I'll be fixing that today.
[2012-06-19 13:22:54 -0400] m0s: hello guys, i'm trying to install chef-server using this article http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo
[2012-06-19 13:22:58 -0400] m0s: and getting
[2012-06-19 13:22:59 -0400] m0s: [2012-06-19T13:15:43+00:00] ERROR: ruby_block[update-java-alternatives] (java::openjdk line 43) has had an error[2012-06-19T13:15:43+00:00] ERROR: Running exception handlers[2012-06-19T13:15:43+00:00] ERROR: Exception handlers complete[2012-06-19T13:15:43+00:00] FATAL: Stacktrace dumped to /tmp/chef-solo/chef-stacktrace.out[2012-06-19T13:15:43+00:00] FATAL: NoMethodError: ruby_block[update-java-alternatives] (java::openjdk line 43) had an error: NoM
[2012-06-19 13:23:32 -0400] m0s: stack trace is here https://gist.github.com/e47b00e350896e51057e
[2012-06-19 13:23:58 -0400] m0s: what i can do with that?
[2012-06-19 13:24:39 -0400] intinig: btm: thx
[2012-06-19 13:25:57 -0400] m0s: ubuntu 12.04
[2012-06-19 13:26:16 -0400] m0s: on ec2 box
[2012-06-19 13:32:37 -0400] dcrosta: a comment in https://github.com/opscode/knife-ec2/pull/2 suggests that you can configure EC2 ephemeral storage through --user-data (with knife ec2 server create), but no one says exactly how. does anyone here know?
[2012-06-19 13:47:29 -0400] ddosia: hello guys, i write recipe, and this recipe should install package, but if platform is debian (on ubuntu this package is in default repos), i should add special repo. How should i do this? some smart conditions inside recipe or maybe exist propper way?
[2012-06-19 13:48:03 -0400] dcrosta: ddosia: check out the apt cookbook (http://community.opscode.com/cookbooks/apt) which lets you configure additional repositories
[2012-06-19 13:48:39 -0400] ddosia: dcrosta: i know how konfigure additional repositories with apt, i ask about platform detecting
[2012-06-19 13:49:34 -0400] dcrosta: ddosia: sorry, my bad. check out the platform? and platform_version? helpers at http://wiki.opscode.com/display/chef/Recipes#Recipes-platform%3F
[2012-06-19 13:49:48 -0400] ddosia: should i do inside recipe something like that: only_if platform == ubuntu do
[2012-06-19 13:50:10 -0400] dcrosta: ddosia: i'd do "only_if { platform?("debian") }"
[2012-06-19 13:51:02 -0400] ddosia: but this is normal practice? I doubt, because there is a lot abstractions like resources and providers...
[2012-06-19 13:52:21 -0400] zts: yes, it's common
[2012-06-19 13:52:45 -0400] zts: similarly, to choose the right package name for the platform
[2012-06-19 13:54:40 -0400] zts: although another approach is to have a recipe which installs all the repositories you might require for your platform, so that you can assume they will be present when your other cookbooks are used
[2012-06-19 13:55:10 -0400] ddosia: how about "value_for_platform(...)" thing?
[2012-06-19 13:56:41 -0400] zts: that's good for choosing package name based on platform(+version)
[2012-06-19 14:06:37 -0400] yfeldblum: dcrosta, don't do guards if the checks can be evaluated at "compile time" - instead, do normal ruby `if` and `unless` statements
[2012-06-19 14:07:26 -0400] yfeldblum: ddosia, `if platform?("debian") || platform?("ubuntu") ; additional_apt_repo_resource_that_you_fill_in ; end`
[2012-06-19 14:09:04 -0400] dcrosta: yfeldblum: I try to follow http://acrmp.github.com/foodcritic/#FC023 in this regard
[2012-06-19 14:14:58 -0400] yfeldblum: dcrosta, it's wrong
[2012-06-19 14:16:38 -0400] yfeldblum: dcrosta, guards are for checking conditions just-in-time for the purpose of delivering idempotency for resources that are not intrinsically idempotent
[2012-06-19 14:18:38 -0400] zts: yeah, using a guard that will (for a given system) _always_ evaluate false seems a bit weird
[2012-06-19 14:48:49 -0400] RJ2: i have a missing node in my "knife search" results.  i set up a new chef server on an ubuntu 12.04 box, chef 10.12.0 - added ad additional ubuntu node using "knife bootstrap". the new node shows in "knife node list", but not if i do "knife search node 'name:*'"
[2012-06-19 14:49:36 -0400] RJ2: new node that's missing from search results is called finchley, if i do this, it looks fine (has a name key etc) knife node show finchley -Fj | less
[2012-06-19 14:49:50 -0400] RJ2: i checked the rabbitmq queues, all have length 0
[2012-06-19 14:50:34 -0400] mattray: RJ2: search issues on Ubuntu always seem to come back to Solr
[2012-06-19 14:50:58 -0400] RJ2: any way to force a full index rebuild? i only have 2 nodes
[2012-06-19 14:51:06 -0400] RJ2: restarting solr didn't help
[2012-06-19 14:51:24 -0400] mattray: solr ships with a small index size, lemme find the ticket
[2012-06-19 14:51:52 -0400] RJ2: my two nodes are minimal, the runlist is ~5 entries. this is a tiny chef install so shouldn't be hitting any limits
[2012-06-19 14:53:54 -0400] Tensibai: RJ2: which os for nodes ?
[2012-06-19 14:53:58 -0400] RJ2: tried knife index rebuild, still the same problem afterwards
[2012-06-19 14:54:03 -0400] RJ2: Tensibai: ubuntu 12.04
[2012-06-19 14:54:13 -0400] Tensibai: ok, bad guess :)
[2012-06-19 14:54:31 -0400] mattray: RJ2: http://tickets.opscode.com/browse/CHEF-2346 maybe?
[2012-06-19 14:54:34 -0400] Tensibai: (windows can give a really big attribute field ... so ...)
[2012-06-19 14:55:00 -0400] RJ2: ohhhh
[2012-06-19 14:55:08 -0400] RJ2: i do have 32k IPv6 addresses on this machine
[2012-06-19 14:55:12 -0400] RJ2: so perhaps that's it :)
[2012-06-19 14:55:22 -0400] RJ2: mattray: thanks
[2012-06-19 14:55:50 -0400] RJ2: presumably that's a solr attribute per ip
[2012-06-19 14:56:01 -0400] mattray: yikes
[2012-06-19 14:56:13 -0400] mattray: you might want to scale down some of that ohai data
[2012-06-19 14:56:27 -0400] RJ2: can i make it not index and of the ip related stuff on that machine somehow?
[2012-06-19 14:56:30 -0400] mattray: RJ2: https://github.com/opscode/whitelist-node-attrs
[2012-06-19 14:56:36 -0400] cwj: ohai more like ohsnap
[2012-06-19 14:57:31 -0400] sascha_d: mattray that is beautiful
[2012-06-19 14:58:06 -0400] mattray: sascha_d: be sure to thank holoway
[2012-06-19 14:59:01 -0400] sascha_d: I figured him for still asleep or I would have said him too :)
[2012-06-19 14:59:25 -0400] sascha_d: github needs a like or upvote option :)
[2012-06-19 15:00:03 -0400] RJ2: yay, that fixed it. just added whitelist-node-attrs to the end of the runlist for my lots-of-ips node
[2012-06-19 15:00:06 -0400] RJ2: thanks :)
[2012-06-19 15:13:09 -0400] jelder: hello, getting a 404 when i try to use knife ec2: http://s3.amazonaws.com/opscode-full-stack/ubuntu-11.04-x86_64/chef-full_10.12.0_amd64.deb
[2012-06-19 15:15:14 -0400] paulmooring: jelder we had an update last night that seems to be the problem, what bootstrap script are you using?
[2012-06-19 15:17:10 -0400] jelder: paulmooring: not sure what information you need. I'm using 10.12.0 and "knife ec2 server create -x ubuntu" and my ami is ubuntu 12.04 instance stoage
[2012-06-19 15:18:25 -0400] paulmooring: got give me a moment to check up on this
[2012-06-19 15:19:53 -0400] jelder: paulmooring: if this helps: http://pastebin.com/RvBCSBLA
[2012-06-19 15:21:29 -0400] laserguy2020: Hello, I was wondering if someone could tell me if there is a way to check to see if a user or group exists without making a direct system call.
[2012-06-19 15:21:54 -0400] paulmooring: laserguy2020: Ruby has an Etc module in the std library
[2012-06-19 15:22:19 -0400] paulmooring: son
[2012-06-19 15:22:19 -0400] paulmooring: '
[2012-06-19 15:22:32 -0400] paulmooring: don't know the syntax off hand but here's the docs http://www.ruby-doc.org/stdlib-1.9.3/libdoc/etc/rdoc/Etc.html
[2012-06-19 15:22:36 -0400] laserguy2020: paulmooring: so there is notice chef specific to do this?
[2012-06-19 15:22:56 -0400] paulmooring: I don't believe there is one built in
[2012-06-19 15:23:11 -0400] paulmooring: you're asking about local system users, like in /etc/passwd right?
[2012-06-19 15:23:15 -0400] laserguy2020: yes
[2012-06-19 15:23:31 -0400] paulmooring: Then no there is not
[2012-06-19 15:24:01 -0400] laserguy2020: Okay thanks for your help.
[2012-06-19 15:24:38 -0400] yfeldblum: laserguy2020, https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/user.rb#L51
[2012-06-19 15:24:47 -0400] yfeldblum: laserguy2020, that's an example of usage
[2012-06-19 15:27:32 -0400] erratic: ohai parrots
[2012-06-19 15:27:44 -0400] erratic: was wondering if anybody had played with the munin cookbook recently
[2012-06-19 15:33:22 -0400] zts: paulmooring: by default, ohai will populate node['etc']['passwd']
[2012-06-19 15:33:31 -0400] zts: laserguy2020: ^^
[2012-06-19 15:33:55 -0400] paulmooring: jelder: Is this a 32 or 64 bit instance?
[2012-06-19 15:34:06 -0400] jelder: 64
[2012-06-19 15:38:55 -0400] paulmooring: jelder: The short answer is we're in the process of rolling out the installers for 0.10.12, using bootstrap from knife 0.10.10 works right now and from 0.10.12 should be fixed in an hour or so
[2012-06-19 15:39:21 -0400] paulmooring: The workaround right now is to specify a template file for the bootstrap and use this link: http://s3.amazonaws.com/opscode-full-stack/ubuntu-12.04-x86_64/chef_10.12.0-1.ubuntu.12.04_amd64.deb
[2012-06-19 15:39:54 -0400] paulmooring: if you locate/find the default template (chef-full.erb) you can use that as a starting place
[2012-06-19 15:40:07 -0400] paulmooring: and just change the download link
[2012-06-19 15:41:20 -0400] paulmooring: or alternatively use the ubuntu12.04-gems template
[2012-06-19 15:54:09 -0400] erratic: hi ssd7
[2012-06-19 16:02:44 -0400] ssd7: hi
[2012-06-19 16:03:20 -0400] erratic: do u liek munin??
[2012-06-19 16:04:08 -0400] erratic: mmmmmm donutty deliciousness
[2012-06-19 16:04:17 -0400] erratic: donut flavored donuts
[2012-06-19 16:04:50 -0400] specialsauce: ohai chefs. I'm getting a really odd error on a client run that I can't figure out if anyone can spare time to take a look please: http://pastebin.com/bTyvBxKG
[2012-06-19 16:05:18 -0400] erratic: specialsauce Ive been having to start my chef-server and chef-solr in the foreground to get them to work
[2012-06-19 16:05:20 -0400] erratic: its really weird
[2012-06-19 16:05:25 -0400] ssd7: erratic: Sure, we use it for a few things here.  I'm not a huge fan of the graphs it generates
[2012-06-19 16:05:45 -0400] erratic: any luck with the cookbook
[2012-06-19 16:05:57 -0400] erratic: I cant figure out how to get the plugins to start on clients
[2012-06-19 16:06:08 -0400] erratic: I cant tell if Im supposed to put them in the recipe or somewhere else
[2012-06-19 16:06:17 -0400] ssd7: erratic: Sorry, I don't have a ton of experiencing that community cookbook
[2012-06-19 16:06:58 -0400] erratic: no worries
[2012-06-19 16:07:02 -0400] erratic: thanks though
[2012-06-19 16:07:08 -0400] erratic: nothing else
[2012-06-19 16:07:13 -0400] specialsauce: erratic: this is specific to the cookbook I'm using so I assume I'm doing something insane in my ruby but I'm not sure what
[2012-06-19 16:07:16 -0400] erratic: I should just try what I think is right
[2012-06-19 16:07:20 -0400] erratic: and see what it does
[2012-06-19 16:07:42 -0400] erratic: just figured I'd try to get some insight first
[2012-06-19 16:07:54 -0400] erratic: specialsauce oh yeah
[2012-06-19 16:08:18 -0400] erratic: my issue is with chef server as far as the problem I've been having with my clients not being able to to connect or connecting very slowly or something
[2012-06-19 16:08:33 -0400] erratic: chef server is hard to run
[2012-06-19 16:08:37 -0400] paulmooring: specialsauce: which line is 199?
[2012-06-19 16:08:56 -0400] paulmooring: nm I see it
[2012-06-19 16:09:00 -0400] specialsauce: paulmooring, cheers
[2012-06-19 16:11:01 -0400] paulmooring: specialsauce: do you have `default["memcached"]["options"]` set to a value elsewhere?
[2012-06-19 16:11:23 -0400] specialsauce: no
[2012-06-19 16:13:39 -0400] specialsauce: paulmorring: I was trying to reference through the attributes "tree", ie its set as ":memcached => { :options => { :fatalcodes = "whatever" }}} in the env hash
[2012-06-19 16:15:29 -0400] paulmooring: so that error comes from trying to use an existing string as a hash
[2012-06-19 16:15:46 -0400] paulmooring: if I set default["test01"] = "foo"
[2012-06-19 16:16:11 -0400] paulmooring: then try to set something in default["test01"]["test02"]
[2012-06-19 16:16:17 -0400] paulmooring: I'll get that index error
[2012-06-19 16:16:48 -0400] paulmooring: There's not enough context there to know where default["memcached"]["options"] was set
[2012-06-19 16:17:10 -0400] paulmooring: but find it and move it 1 level deeper and you'll be fine
[2012-06-19 16:19:13 -0400] paulmooring: specialsauce: also don't forget it could be set in the node, role, ect.
[2012-06-19 16:20:14 -0400] specialsauce: paulmooring, ok, thanks I'll take a look. so i'm fine to use the same syntax, but just not if that level of the hash is already referenced somewhere else as a string?
[2012-06-19 16:20:58 -0400] paulmooring: exactly, all the values should be on the last value
[2012-06-19 16:21:13 -0400] specialsauce: yeah that's how I thought I had set it, let me check
[2012-06-19 16:21:22 -0400] paulmooring: you can set the value to another hash, but imo that's over complicating things
[2012-06-19 16:25:59 -0400] specialsauce: paulmooring, spot on, I had used the same attr in the hash hierarchy elsewhere (unset) and the two recipes were called from the same role. thanks for the help!
[2012-06-19 16:27:24 -0400] paulmooring: np
[2012-06-19 16:30:08 -0400] Zenigor: Is there any sort of workaround for http://tickets.opscode.com/browse/COOK-629?page=com.googlecode.jira-suite-utilities%3Atransitions-summary-tabpanel
[2012-06-19 16:32:02 -0400] hoover_damm: Zenigor, what version of the perl cookbook are you running?
[2012-06-19 16:32:10 -0400] hoover_damm: 0.10.2 should have it
[2012-06-19 16:32:35 -0400] Zenigor: @hoover_damm perl 0.10.0 from the community site
[2012-06-19 16:32:44 -0400] hoover_damm: Zenigor, then you need 0.10.2
[2012-06-19 16:32:50 -0400] hoover_damm: Zenigor, https://github.com/opscode-cookbooks/perl
[2012-06-19 16:33:01 -0400] hoover_damm: Zenigor, community site is out of date
[2012-06-19 16:33:05 -0400] hoover_damm: at least on this cookbook
[2012-06-19 16:33:44 -0400] erratic: http://seadevops0612-es2.eventbrite.com/?srnk=1
[2012-06-19 16:33:47 -0400] erratic: anybody know about this
[2012-06-19 16:33:51 -0400] Zenigor: @hoover_damm thank you
[2012-06-19 16:34:47 -0400] hoover_damm: oh coprocessors
[2012-06-19 16:34:52 -0400] hoover_damm: why oh why
[2012-06-19 16:34:56 -0400] hoover_damm: or why do I care
[2012-06-19 16:35:16 -0400] hoover_damm: erratic, what about the devops?
[2012-06-19 16:35:23 -0400] erratic: the meetup is tonight right
[2012-06-19 16:35:31 -0400] jelder: having a bit of trouble bootstrapping chef 12.10: http://pastebin.com/Q3F2Y7G4
[2012-06-19 16:35:32 -0400] hoover_damm: erratic, yep
[2012-06-19 16:35:38 -0400] erratic: okay kewl
[2012-06-19 16:35:44 -0400] hoover_damm: erratic, not sure why it says ended there
[2012-06-19 16:35:45 -0400] jelder: pretty sure i'm not using --template-file correctly
[2012-06-19 16:35:47 -0400] erratic: yeah cant figure out how to rsvp
[2012-06-19 16:35:53 -0400] hoover_damm: you don't need to
[2012-06-19 16:35:54 -0400] erratic: I usually do it on meetup.com
[2012-06-19 16:35:58 -0400] erratic: ok
[2012-06-19 16:36:17 -0400] erratic: hoover_damm are you gonna be there? I've been wanting to meet you for awhile
[2012-06-19 16:36:39 -0400] hoover_damm: erratic, I never go
[2012-06-19 16:36:52 -0400] erratic: you're not in seattle anyway are you
[2012-06-19 16:36:56 -0400] hoover_damm: erratic, lately i've been working until 8pm which is my excuse
[2012-06-19 16:36:57 -0400] erratic: I thought you were in SF or something
[2012-06-19 16:37:03 -0400] erratic: oh cool
[2012-06-19 16:37:03 -0400] hoover_damm: I don't goto SF
[2012-06-19 16:37:05 -0400] hoover_damm: only Seattle
[2012-06-19 16:37:14 -0400] hoover_damm: I love our weather
[2012-06-19 16:37:29 -0400] erratic: yeah I'll get on irc we should get together for beer or something sometime or after the meetup if you're down
[2012-06-19 16:37:53 -0400] hoover_damm: that's actually the reason I stopped going to the Devops meetups is I felt the alcohol thing
[2012-06-19 16:37:56 -0400] hoover_damm: was too big
[2012-06-19 16:38:12 -0400] hoover_damm: Time is always an easy excuse
[2012-06-19 16:39:07 -0400] hoover_damm: I actually avoid conferences for the same reason.  It's just avoiding having to tell people 'No thank you, I don't want to drink.  I wanted to learn, nothing more'.
[2012-06-19 16:39:28 -0400] hoover_damm: if it's during, or after... I suck at saying no lately, so I just don't go
[2012-06-19 16:41:11 -0400] hoover_damm: erratic, I'm looking forward to the next Chef Conference or Summit honestly.  But i'll likely skip out early just to avoid the drinking still
[2012-06-19 16:41:11 -0400] lflux: is there any sort of chef meetup at velocity?
[2012-06-19 16:41:34 -0400] lflux: besides that there are chef talks and tutorials
[2012-06-19 16:42:26 -0400] chip-: When spooling attributes from an array into a template, how do you handle languages that are sensitive to the last element in the array having a trailing comma, like json?
[2012-06-19 16:42:48 -0400] mattray: lflux: we'll have a booth and some training, not sure what else we're doing. Lots of us will be there
[2012-06-19 16:42:51 -0400] chip-: Can't just drop a comma in the for loop that writes it out.
[2012-06-19 16:43:17 -0400] lflux: mattray: i'm there, but i'm attending other tutorials than the chef ones.
[2012-06-19 16:43:44 -0400] erratic: hoover_damm oh
[2012-06-19 16:43:45 -0400] mattray: 3 Opscoders giving talks
[2012-06-19 16:44:33 -0400] jtimberman: lflux: there's a Chef 101 Workshop for sysadmins on Thursday after Velocity.
[2012-06-19 16:44:54 -0400] lflux: jtimberman: cool, but i'm going to webperfdays then
[2012-06-19 16:44:59 -0400] lflux: devopsdays was full :(
[2012-06-19 16:45:11 -0400] lflux: i'm kinda past the 101 stage.
[2012-06-19 16:45:15 -0400] jtimberman: lflux: well, if you've used Chef, this would be quite basic.
[2012-06-19 16:45:25 -0400] jtimberman: This is a "never really used Chef" kind of class.
[2012-06-19 16:45:30 -0400] jtimberman: :)
[2012-06-19 16:45:31 -0400] erratic: I hope to get assistance with coding
[2012-06-19 16:45:33 -0400] erratic: and
[2012-06-19 16:45:40 -0400] erratic: munin
[2012-06-19 16:45:41 -0400] erratic: :D
[2012-06-19 16:45:57 -0400] lflux: ooh, thanks for reminding, gotta get cracking on my graphite install
[2012-06-19 16:46:18 -0400] erratic: oh yeah
[2012-06-19 16:46:24 -0400] erratic: I have a problem with my chef-server / solr
[2012-06-19 16:46:31 -0400] lflux: jtimberman: Something like that would be great for some of my colleagues, but we're in Stockholm.
[2012-06-19 16:46:36 -0400] erratic: would like to get that figured out too
[2012-06-19 16:46:41 -0400] eherot: is there a way in chef (or ruby) to get the currently installed version of a particular package?
[2012-06-19 16:47:03 -0400] jelder: hmm the chef-client recipe appears to break with 12.10: http://pastebin.com/E03AGrut
[2012-06-19 16:47:11 -0400] chip-: So no takers on my "how to generate an array in a template from an array of attributes when the template is sensitive to having a trailing comma after the last element" question?
[2012-06-19 16:47:36 -0400] thom: chip-: array.join(",")
[2012-06-19 16:48:15 -0400] chip-: thom: how's that work in conjunction with the examples on http://wiki.opscode.com/display/chef/Templates?
[2012-06-19 16:48:59 -0400] jelder: chip-: thom's example results in a string. you can just include that like <%= array.join(',') %>
[2012-06-19 16:49:10 -0400] thom: chip-: show the template you're building and we can help you more
[2012-06-19 16:49:34 -0400] thom: but jelder is correct, you just treat the result as a string
[2012-06-19 16:53:21 -0400] chip-: gist: https://gist.github.com/2955238
[2012-06-19 16:53:42 -0400] chip-: Had to sanitize the crap out of it, took a second.
[2012-06-19 16:55:45 -0400] thom: chip-: https://gist.github.com/2955245
[2012-06-19 16:56:20 -0400] chip-: Ah, okay. So .join(",") is just one of those classes you can slap on an array.
[2012-06-19 16:56:39 -0400] jelder: methods, but yes
[2012-06-19 16:56:45 -0400] chip-: Pre-coffee.
[2012-06-19 16:56:53 -0400] chip-: I'll blame that
[2012-06-19 16:56:55 -0400] chip-: yes.
[2012-06-19 16:56:58 -0400] jelder: http://www.ruby-doc.org/core-1.8.7/Array.html
[2012-06-19 16:58:28 -0400] jelder: so, chefs: was Chef::Client::SANE_PATHS removed from 12.10? the chef-client cookbook is now busted
[2012-06-19 16:58:41 -0400] jelder: http://pastebin.com/E03AGrut
[2012-06-19 16:59:19 -0400] chip-: Thanks a lot for the help!
[2012-06-19 16:59:27 -0400] jelder: np
[2012-06-19 17:00:17 -0400] erratic: sigh
[2012-06-19 17:04:41 -0400] chrisa2: jelder: got the latest version of that cookbook? looks like it checks for that constant first, in the current version.
[2012-06-19 17:16:57 -0400] cientifico: Hello
[2012-06-19 17:17:55 -0400] cientifico: I have questions about the deploy. How is supposed the deploy to start? chef-client runs every 30 minutes. Should i wait until all the instances call chef-client and do a redeploy?
[2012-06-19 17:18:22 -0400] cientifico: or should I ssh each machine and run chef-solo with the cookbook to deploy?
[2012-06-19 17:20:43 -0400] cwj: cientifico: its a bike shedding issue. in our systems we don't run chef-client on a schedule, just use knife to kick off chef-client runs as needed
[2012-06-19 17:23:49 -0400] cientifico: with knife exec?
[2012-06-19 17:24:43 -0400] cientifico: So you have a machine that have a deploy script, that is going to ask to chef-server for the app machines, and thenn ssh to the machine and run knife to run the deploy recipe
[2012-06-19 17:27:08 -0400] yfeldblum: cwj, more a question of fundamental architecture than bikeshed color, really
[2012-06-19 17:27:25 -0400] mattray: cientifico: knife ssh does that
[2012-06-19 17:27:54 -0400] mattray: cientifico: knife ssh "role:base" "chef-client" -x root -a ipaddress
[2012-06-19 17:29:23 -0400] cwj: in our case i have chef put a deploy script on each node which deletes lock files and starts a chef-client run
[2012-06-19 17:29:37 -0400] cwj: then i use knife ssh to call the deploy script on the nodes i want to deploy to
[2012-06-19 17:30:47 -0400] cientifico: ok
[2012-06-19 17:30:50 -0400] cientifico: I see
[2012-06-19 17:32:33 -0400] cientifico: Ok. The next point is. I want to continue having chef-client to run continuesly (by init/cron, ... ) to let etc/hosts to update automatically
[2012-06-19 17:32:48 -0400] cientifico: that means that i can not put the default deploy recipe in the run list
[2012-06-19 17:33:14 -0400] cientifico: so don't have the problem of race conditions in the case of manually deploy and automatic deploy
[2012-06-19 17:34:09 -0400] cwj: we use not_if guards to prevent redeploys from happening when a specified lock file exists
[2012-06-19 17:34:19 -0400] cientifico: ok
[2012-06-19 17:34:30 -0400] cientifico: and you run manually chef-client
[2012-06-19 17:34:36 -0400] cwj: not_if { ::File.exists?('/opt/foo/bar/deploy.lock') }
[2012-06-19 17:34:41 -0400] chip-: cientifico: I tend to use Cap to deploy code and Chef to manage config files and server build (including the Cap configs)
[2012-06-19 17:34:56 -0400] cwj: so you can run chef-client without having to deploy
[2012-06-19 17:35:08 -0400] cwj: but you probably still want to implement locking for chef runs themselves
[2012-06-19 17:35:22 -0400] chip-: cientifico: so you can have Cap include a Chef search to generate the list of target hosts, and then have a Cap function that calls chef-client as part of your deploy to pick up the new configs.
[2012-06-19 17:36:14 -0400] cientifico: chip- Yeah, that was the initial idea. As we are deploying from tarbals in erlang, the idea was to unpack and call restart
[2012-06-19 17:36:24 -0400] cientifico: the idea of capistrano sounds like too much for this case
[2012-06-19 17:37:07 -0400] cientifico: plus I will write a cookbook to deploy the app. In case we start new machine, the app should start automatically without manually doing another deploy
[2012-06-19 17:38:23 -0400] miah: herp the derp
[2012-06-19 17:39:46 -0400] setient: thats me!
[2012-06-19 17:40:15 -0400] cientifico: the problem i see if that if I execute 'knife ssh roles:app 'exit -2'' I don't find the way to capture that exit code
[2012-06-19 17:41:44 -0400] cientifico: And seems like is ignoring my parameters
[2012-06-19 17:41:46 -0400] cientifico: knife ssh roles:app "hostname" -E ci
[2012-06-19 17:41:49 -0400] hoover_damm: https://github.com/howaboutwe/capistrano-chef is neat for Capistrano
[2012-06-19 17:42:25 -0400] hoover_damm: but i'll stick to fabric as pychef makes it too darn easy
[2012-06-19 18:16:03 -0400] jelder: chrisa2: i'm using version 1.1.4 of the chef-client cookbook, still getting FATAL: NameError: uninitialized constant Chef::Client::SANE_PATHS
[2012-06-19 18:17:29 -0400] jelder: chrisa2: probably because the fix is a month old, and the last release was 3 months ago
[2012-06-19 18:18:02 -0400] jelder: is there some magic trick to using the latest unreleased versions, other that (ugh) git submodules?
[2012-06-19 18:25:30 -0400] joshuag: interesting problem, i'm changing erg templates for a cookbook but when i upload a cookbook the template changes are not propagating. ideas?
[2012-06-19 18:26:14 -0400] jelder: joshuag: do you have any version restrictions in place?
[2012-06-19 18:26:55 -0400] joshuag: i don't believe so. the new version metadata.rb is in the cahce
[2012-06-19 18:26:59 -0400] joshuag: cache*
[2012-06-19 18:27:25 -0400] jelder: joshuag: but does your environment say to use a specific version?
[2012-06-19 18:28:05 -0400] joshuag: jelder: where would that be set?
[2012-06-19 18:29:19 -0400] jelder: "knife environment show _default" or whatever environment you are using
[2012-06-19 18:31:40 -0400] joshuag: jelder: there are no version restrictions for the cookbook i am changing
[2012-06-19 18:54:16 -0400] joshuag: jelder: any other ideas?
[2012-06-19 19:01:39 -0400] jelder: joshuag: got me. does the contents of /var/cache/chef match your repo?
[2012-06-19 19:02:05 -0400] joshuag: jelder: so metadata.rb matches.  the template.cfg.erb does not
[2012-06-19 19:02:20 -0400] joshuag: jelder: metadata updated, the template didn't
[2012-06-19 19:02:30 -0400] jelder: and you've tried knife cookbook upload again?
[2012-06-19 19:07:38 -0400] joshuag: jelder: yeah a couple times
[2012-06-19 19:07:58 -0400] jelder: is this your own server or are you using opscode hosted chef?
[2012-06-19 19:08:15 -0400] joshuag: jelder: hosted with opscode
[2012-06-19 19:08:53 -0400] jelder: dunno man. i don't work for opscode but lots of others here do. they might have a better idea
[2012-06-19 19:09:07 -0400] joshuag: hmm
[2012-06-19 19:12:26 -0400] ssd7: joshuag: How have you verified that the new template changes are not propagating?  What is usually the case when people report this is that the chef-client run isn't actually making it to the template resource.
[2012-06-19 19:12:51 -0400] ssd7: Template's are downloaded only when needed, so if your run doesn't make it to the template resource, you will never see it on disk
[2012-06-19 19:13:00 -0400] joshuag: ssd7: how would i verify? i deleted /var/chef and reran the client the template shows up, the old veresion
[2012-06-19 19:14:48 -0400] ssd7: joshuag: I would first use knife to verify what the server things it has. -----BEGIN RSA PRIVATE KEY-----
[2012-06-19 19:14:51 -0400] ssd7: MIIEowIBAAKCAQEA7i6g52JD6eJthZiXQTkCyTtcmRJ7I9P3UHBT3QuWkhwTcwlQ
[2012-06-19 19:14:53 -0400] ssd7: uI/IKrJY1QsjsGUniUDjgpll0xdPv3DFhsAiciSgUW+c7ohL0/cwMs7q6GKpRMcA
[2012-06-19 19:14:56 -0400] ssd7: rjZGZhivk1cdUTTL+AcJPnuDLktPG45bNBBlVmNU07wQsyDpCIh47Xt0OEaJTjcf
[2012-06-19 19:14:58 -0400] ssd7: ybtZ4jbBTxowlm8nrJCLaUvCezxxpFtb2Vmx3UPmeAMVxSudam+5d5Sy1+AkWU3m
[2012-06-19 19:15:01 -0400] ssd7: XlrpFhCXweislkPUKr+qjR6Rxr9vWVKEXADBM+5Ziud8imVJv/Yh/iwdajOe7rW/
[2012-06-19 19:15:03 -0400] ssd7: lAR90kWB3WcBL80krVt6huacgF5EFKqsg2erUwIDAQABAoIBAGuCpKKM2nbh++nH
[2012-06-19 19:15:06 -0400] ssd7: vM51+2n135BApVDAxuuKKHCoYGjHP4g3djY4wHN1WV+gzZU7s6LipU84CpxD831I
[2012-06-19 19:15:08 -0400] ssd7: XAC9DU9UdQENTlrlLsUY2Kq2d5Y5ooonAYmhehlvnyD0u4kCOedU1blcaxQkbirU
[2012-06-19 19:15:11 -0400] ssd7: ERrpI7Tg1VNVmnwgqM9vOpaHmSgk36sjcQn7VgvRXTEF08zkXOQxV28Azw7mXJBb
[2012-06-19 19:15:13 -0400] ssd7: uVpR7j0SEZHuP1X1yE89fflHG6872UL07TTlNWhwiU54QnGzeuziyyezS19fAWd5
[2012-06-19 19:15:16 -0400] ssd7: K1oMTJoTrA4q44oMHTH9T/sVwz84sCWovesJf1O6SIZkKqMg4oEVgUKTwUvfMPJa
[2012-06-19 19:15:18 -0400] ssd7: hBSOkNECgYEA/UXMczaS/LZk2+qEfn0PDfZYkqRvDsqy6ZsZ7FNnyveaJ68Ev2oH
[2012-06-19 19:15:21 -0400] ssd7: Qq4OJGznbeiHymV47h4QeQIysH/ZAgFaMGQD//0KY88SRx/oVapKcojW3R0vj5kt
[2012-06-19 19:15:23 -0400] ssd7: FQhJnFgI4St7g46gQrMUpWiBUhxaCtYoRrwWV/9NeBUBNdwIQzzEsLcCgYEA8L86
[2012-06-19 19:15:26 -0400] ssd7: yCa0H9buHcu2lzstGJ3Y4sSMaQ+P7DC3BwkXrhn7YXYboOYmFTgDPnqHJi0NMk+C
[2012-06-19 19:15:28 -0400] ssd7: g4vIra3fTrcrb/67u+Z18zMQDQ8/EppIHQwHAg+G030CqcwQCoC3mW2qGFKfrHsp
[2012-06-19 19:15:31 -0400] ssd7: uWxfr3PGDbiZMt1KnB7/S3qx8gofuhMUwqB+RkUCgYEAnMcwH8GQi058cIVjLslL
[2012-06-19 19:15:33 -0400] ssd7: IGF1wpB3Drj6txCDo36dqU5L5nS4g6SmiegkaPfg6nAeXnMhwIRrvfxWVFtPgaZE
[2012-06-19 19:15:36 -0400] ssd7: pd/Dehqw68eqkMx3jU+0deGu34DJiCJRfct7hYQZOwknk/Ad1Cv2g82E/8b9Fegr
[2012-06-19 19:15:38 -0400] ssd7: Vl3nluE6mzKlZSmnE7fyKVECgYBK2pqTSv1sfO5ykzmFkh+2bLXX5Fbn/6+3N3ph
[2012-06-19 19:15:41 -0400] ssd7: FKGpP2ja59c1Uvn6VP0lOwG0jANzZidlcVwHLG2nUuqNmv2SMdjwsirGdLwes5vC
[2012-06-19 19:15:43 -0400] ssd7: dE/lgyBft5nRY6KFMXpkmSVvBJmjDnRts9WYfv3QnFn957JgEn88X7zeTemJeI9W
[2012-06-19 19:15:46 -0400] ssd7: 6IH6pQKBgBqzg4FkkV7FZPNVds6SaNswz0/CBx2MRad8WTWLj7MXmmq1zcw4wPQG
[2012-06-19 19:15:48 -0400] ssd7: HobZ2DX9bTJR9NQrGOrWIbrfiA1my0SZktwPqNsvgfnJrwcGI65H0KePZ5F6kPR4
[2012-06-19 19:15:51 -0400] ssd7: RTS+RCPPVzh2EaMEvw7k2UgfrrZYGick4t0CpcP3Bk7CXJVDKuoR
[2012-06-19 19:15:53 -0400] ssd7: wow
[2012-06-19 19:15:56 -0400] ssd7: I'm not even sure how that remotely happened
[2012-06-19 19:15:58 -0400] jelder: omfg
[2012-06-19 19:15:58 -0400] ssd7: that's f'ing awesome
[2012-06-19 19:16:01 -0400] ssd7: ok, I'll be back in a few minutes
[2012-06-19 19:16:03 -0400] ssd7: sorry all
[2012-06-19 19:17:57 -0400] ssd7: Awesomely, that is also forever logged on the community site.
[2012-06-19 19:18:28 -0400] ssd7: blarghghg.  OK.  Joshuag you can use knife to verify what the server has.  knife cookbook show COOKBOOK_NAME COOKBOOK_VERSION templates
[2012-06-19 19:18:35 -0400] ssd7: will show you a list of the checksums
[2012-06-19 19:18:44 -0400] joshuag: ssd7: lol ok thanks
[2012-06-19 19:18:56 -0400] ssd7: knife cookbook show COOKBOOK_NAME COOKBOOK_VERSION templates TEMPLATE_NAME will shwo you the actual file
[2012-06-19 19:19:42 -0400] joshuag: and how is the checks created so i can compare local file? md5?
[2012-06-19 19:20:03 -0400] ssd7: sha256 I believe
[2012-06-19 19:21:45 -0400] ssd7: joshuag: I lied
[2012-06-19 19:21:47 -0400] ssd7: md5
[2012-06-19 19:22:01 -0400] joshuag: ssd7: was going to just say nope
[2012-06-19 19:22:02 -0400] joshuag: lol
[2012-06-19 19:22:42 -0400] juliancdunn: just got burned by an error in jtimberman's blog post about encrypted data bags :-(
[2012-06-19 19:24:00 -0400] chip-: Heh I was just about to start following that, what's the error?
[2012-06-19 19:24:16 -0400] juliancdunn: there are two actually
[2012-06-19 19:25:04 -0400] juliancdunn: number one: he says to set postfix_creds = Chef::EncryptedDataBagItem.load(...) but then in the next step, calls the hash "smtp_sasl"
[2012-06-19 19:25:09 -0400] joshuag: ssd7: ok they didn't match
[2012-06-19 19:25:13 -0400] juliancdunn: (rather than postfix_creds)
[2012-06-19 19:25:23 -0400] joshuag: ssd7: i re-edited the file, changed the version, and reputed, that did it
[2012-06-19 19:25:47 -0400] juliancdunn: number two: the third argument to Chef::EncryptedDataBagItem() is supposed to be the text of the secret, not the filename
[2012-06-19 19:26:07 -0400] afallows: http://tickets.opscode.com/browse/KNIFE_EC2-45 This issue was recently marked as Fixed. What do I need to do to get the changes? Is it as simple as re-installing knife-ec2?
[2012-06-19 19:26:16 -0400] ssd7: joshuag: I see.  Well, glad you got it sorted.  If you see it again, let us know and we can try to sort this mystery out if there is some deeper cause
[2012-06-19 19:26:25 -0400] joshuag: ssd7: thanks
[2012-06-19 19:26:31 -0400] joshuag: then md5 check is helpful
[2012-06-19 19:28:08 -0400] ssd7: afallows: Our JIRA process can be a bit opaque.  That ticket will be merged for the next release but isn't out anywhere yet.
[2012-06-19 19:28:21 -0400] ssd7: When it is, it would be marked as closed (rather than just resolved) and have a fixed version.
[2012-06-19 19:28:37 -0400] ssd7: I hope to have a knife-ec2 release out soon
[2012-06-19 19:29:55 -0400] jtimberman: juliancdunn: i'm sorry
[2012-06-19 19:29:58 -0400] afallows: ssd7: Awesome, thanks. Is there a way I can sign up to be notified when that changes? Would JIRA give me the option to watch the ticket? (I have not used JIRA)
[2012-06-19 19:31:00 -0400] ssd7: afallows: If you have a JIRA account, you can log in, and then go to the ticket. There should be a "watch" link on the right that will email you about updates.
[2012-06-19 19:31:42 -0400] afallows: Most excellent
[2012-06-19 19:32:14 -0400] juliancdunn: jtimberman: no worries, maybe you can fix the post when you get a chance
[2012-06-19 19:32:39 -0400] jtimberman: juliancdunn: can you drop a comment on the post?
[2012-06-19 19:32:50 -0400] geekbri: We need a public IRC -> JIRA name mapping ;).  Its fun when you finally put together which jira name goes with which irc user
[2012-06-19 19:32:57 -0400] juliancdunn: jtimberman: sure thing
[2012-06-19 19:33:01 -0400] jtimberman: thanks!
[2012-06-19 19:34:41 -0400] juliancdunn: jtimberman: I don't see a place to comment, am I missing something? http://jtimberman.housepub.org/blog/2011/08/06/encrypted-data-bag-for-postfix-sasl-authentication/
[2012-06-19 19:35:29 -0400] jtimberman: juliancdunn: huh! i had disqus on there.
[2012-06-19 19:35:41 -0400] jtimberman: juliancdunn: joshua@opscode.com
[2012-06-19 19:35:42 -0400] jtimberman: :)
[2012-06-19 19:35:47 -0400] mattray: commenting turn off after a set time?
[2012-06-19 19:35:50 -0400] btm: jtimberman: IT GOT DISQUSTED AND LEFT! HAH! :)
[2012-06-19 19:36:00 -0400] jtimberman: btm: too many bugs.
[2012-06-19 19:36:08 -0400] jtimberman: mattray: maybe?
[2012-06-19 19:36:29 -0400] btm: jtimberman: setec astronomy?
[2012-06-19 20:11:17 -0400] javawidget: hi. can anyone help me with a small problem? (it's really dumb, apologies in advance)
[2012-06-19 20:11:46 -0400] juliancdunn: fire away
[2012-06-19 20:12:06 -0400] javawidget: when using File.open in my provider code...
[2012-06-19 20:12:55 -0400] javawidget: the Chef File class provider is used instead of ruby File
[2012-06-19 20:13:49 -0400] javawidget: how might I use ruby File instead of Chef::Provider::File:Class
[2012-06-19 20:13:54 -0400] ssd7: javawidget: You can do ::File
[2012-06-19 20:14:11 -0400] javawidget: ok.. let me try that now..
[2012-06-19 20:14:27 -0400] javawidget: (sorry, I'm about two weeks old with chef)
[2012-06-19 20:14:39 -0400] javawidget: I'll report back in a few minutes.
[2012-06-19 20:17:24 -0400] javawidget: starting another chef run... crossing fingers...
[2012-06-19 20:20:01 -0400] BryanWB: if anyone could put me in contact w/ ben rockwood for foodfightshow, I would really appreciate it
[2012-06-19 20:23:17 -0400] miah: hiya BryanWB
[2012-06-19 20:23:51 -0400] miah: BryanWB: @benr ? =)
[2012-06-19 20:25:00 -0400] BryanWB: miah hey! tried that ;)
[2012-06-19 20:25:45 -0400] geekbri: BryanWB: why not try info@foodfightshow.org
[2012-06-19 20:26:31 -0400] BryanWB: geekbri: then i would be messaging myself ;)
[2012-06-19 20:26:53 -0400] geekbri: I'm silly i thought you said get in contact with OF not FOR
[2012-06-19 20:27:02 -0400] geekbri: its been a long day :)
[2012-06-19 20:27:15 -0400] geekbri: #signsyoushouldgohome
[2012-06-19 20:29:04 -0400] geekbri: BryanWB: benr@cuddletech.com ?
[2012-06-19 20:29:34 -0400] BryanWB: geekbri tried that weeks ago,  a couple times
[2012-06-19 20:29:50 -0400] geekbri: Maybe he doesn't want to be contacted!
[2012-06-19 20:30:33 -0400] BryanWB: geekbri: judging by how much he loves to talk about illumos in person, i am sure he wants to talk about it on a podcast!
[2012-06-19 20:30:49 -0400] geekbri: hehe
[2012-06-19 20:41:20 -0400] papertigers: anyone know if there is smf support in chef? Would rather handle it through chef than through a bash script
[2012-06-19 20:42:51 -0400] javawidget: Thanks, @ssd7
[2012-06-19 20:42:59 -0400] javawidget: worked great.
[2012-06-19 20:43:08 -0400] miah: papertigers: afaik, nobody has written a smf provider. but please do =)
[2012-06-19 20:46:07 -0400] yfeldblum: the fundamental problem with smf providers is that whenever anybody gets around to starting one, he finds quite rabidly that he gets far too distracted by the phrase "smurf provider" to continue
[2012-06-19 20:46:35 -0400] yfeldblum: rapidly*
[2012-06-19 20:47:39 -0400] bdha: Cute.
[2012-06-19 20:47:53 -0400] bdha: In 8 years I've never heard anyone refer to SMF as Smurf.
[2012-06-19 20:47:56 -0400] bdha: I feel really left out now.
[2012-06-19 20:47:57 -0400] miah: the smf provider should clearly be named gargamel.rb
[2012-06-19 20:48:09 -0400] jelder: i don't quite understand the permission model in the opscode management console. is there any thing i can do to make sure nobody accidentally deletes my validator?
[2012-06-19 20:48:53 -0400] juliancdunn: so... I can't have an arbitrary structure in an encrypted databag?
[2012-06-19 20:48:55 -0400] bdha: By SMF provider, I assume it means for importing/deleting?
[2012-06-19 20:49:19 -0400] bdha: (because "service" works fine on Solaris for management)
[2012-06-19 20:49:37 -0400] bdha: I wrote the first rev (hopefully replaced?) for the Puppet SMF import bits.
[2012-06-19 20:49:43 -0400] bdha: It's pretty trivial.
[2012-06-19 20:49:54 -0400] miah: juliancdunn: ?
[2012-06-19 20:50:02 -0400] javawidget: I'm writing a recipe to install custom code that's gzipped in S3: <bucket>:<application_name>:<application_name>-<jenkins_build_number>.tar.gz To test the basic functionality, I've written a provider that has bucket, app name, and version number, and my recipe currently has the version number hard coded... I'm still very new with chef and I don't know the best way to author the recipe to easily allow overrides for the application n
[2012-06-19 20:50:34 -0400] juliancdunn: miah: I tried to create an encrypted databag with a structure... not just key-value mappings
[2012-06-19 20:50:46 -0400] miah: it has to be json
[2012-06-19 20:50:47 -0400] juliancdunn: but it takes my value, which is actually a hash, and encrypts the whole thing
[2012-06-19 20:50:51 -0400] juliancdunn: it is JSON
[2012-06-19 20:51:28 -0400] miah: im confused. so you want a encrypted databag. but you dont want it to encrypt certain values?
[2012-06-19 20:52:11 -0400] juliancdunn: let me put up a Gist
[2012-06-19 20:52:36 -0400] miah: every item inside a encrypted databag is encrypted
[2012-06-19 20:52:47 -0400] miah: you need the key to decrypt the databag before you can use any of the items/values it presents.
[2012-06-19 20:53:02 -0400] miah: apart from that, you can store arrays, hashes, etc so long as its valid json.
[2012-06-19 20:53:32 -0400] juliancdunn: hmm okay
[2012-06-19 20:54:00 -0400] juliancdunn: maybe I just got misled because the entire value of my hash was encrypted
[2012-06-19 20:54:26 -0400] juliancdunn: yup, it's just me
[2012-06-19 20:55:52 -0400] yfeldblum: juliancdunn, the top-level keys in your JSON encrypted-data-bag-item are clear; the top-level values are encrypted; to be encrypted, they are serialized from a JSON data structure to yaml, encrypted, and then the ciphertext is base64'd
[2012-06-19 20:55:55 -0400] miah: knife data bag show <bag> <item> --secret-file <myawesomeencryptkey>
[2012-06-19 20:56:16 -0400] miah: yfeldblum: awesome explaination
[2012-06-19 20:56:33 -0400] juliancdunn: thanks... I realized that. thought it was going to only encrypt the lowest-level values so I got thrown off. thanks
[2012-06-19 21:05:28 -0400] javawidget: I'm writing a recipe to install custom code that's gzipped in S3: <bucket>:<application_name>/<application_name>-<jenkins_build_number>.tar.gz To test the basic functionality, I've written a provider that has bucket, app name, and version number - my recipe currently has the app and version number hard coded... I'm still very new with chef and I don't know the best way to author the recipe to easily allow for overriding the applica
[2012-06-19 21:06:31 -0400] jelder: javawidget: your question is too long for irc and gets truncated, but you probably want to have the build number in the environment or node
[2012-06-19 21:07:45 -0400] javawidget: Sorry.
[2012-06-19 21:07:48 -0400] javawidget: :)
[2012-06-19 21:07:58 -0400] javawidget: let me try something a little shorter..
[2012-06-19 21:08:12 -0400] javawidget: I'm still very new with chef and I don't know the best way to author the recipe to easily allow for overriding the application name and version number
[2012-06-19 21:08:29 -0400] jelder: sounds like a job for attributes
[2012-06-19 21:08:33 -0400] javawidget: I can create the attributes..
[2012-06-19 21:08:51 -0400] javawidget: But I don't know how to override them for each chef role.
[2012-06-19 21:09:11 -0400] javawidget: overriding attributes is lke black magic to me atm
[2012-06-19 21:09:27 -0400] jelder: then don't worry about overriding
[2012-06-19 21:10:03 -0400] javawidget: so.. I want to write one recipe that I can pass the application name and build number to for downloading..
[2012-06-19 21:10:11 -0400] jelder: just add them to the default_attributes in your environment
[2012-06-19 21:10:15 -0400] javawidget: and use this recipe for many different code deployments
[2012-06-19 21:10:36 -0400] jelder: use the role then
[2012-06-19 21:10:57 -0400] javawidget: I have different applications that I want to deploy in the same environment.
[2012-06-19 21:11:01 -0400] javawidget: OK.
[2012-06-19 21:11:04 -0400] jelder: if you only ever define something once it's easy to ignore the whole precedence thing
[2012-06-19 21:11:28 -0400] javawidget: So..
[2012-06-19 21:11:49 -0400] javawidget: You're saying that I should define the attributes in the role..
[2012-06-19 21:12:13 -0400] jelder: probably, based on what you've said so far
[2012-06-19 21:12:54 -0400] javawidget: and in the recipe, how do I reference the role attributes? the same as attributes in the recipe? node[:app][:build_version] ?
[2012-06-19 21:13:07 -0400] jelder: exactly
[2012-06-19 21:13:45 -0400] javawidget: awesome.
[2012-06-19 21:14:21 -0400] javawidget: You're a huge help. Can I ask one more , seriously newb question?
[2012-06-19 21:14:25 -0400] jelder: sure
[2012-06-19 21:15:34 -0400] javawidget: I'm using my own chef server - what is the best way to set these attributes on the role?
[2012-06-19 21:15:53 -0400] javawidget: (I know.. I feel dumb for asking it)
[2012-06-19 21:15:55 -0400] jelder: same as if you were using hosted chef (since the management interface kinda sucks)
[2012-06-19 21:16:01 -0400] jelder: knife role edit myrole
[2012-06-19 21:16:15 -0400] javawidget: I noticed that the interface sucks ;)
[2012-06-19 21:16:37 -0400] jelder: it gets crazy slow every 30 minutes, too
[2012-06-19 21:16:52 -0400] hoover_damm: javawidget, do you use chef-repo?
[2012-06-19 21:17:04 -0400] jelder: but i'm using it, about to become a paying customer, simply because i don't' want to figure out high availability etc for myself
[2012-06-19 21:17:05 -0400] javawidget: chef-repo?
[2012-06-19 21:17:05 -0400] bawt: chef-repo is http://wiki.opscode.com/display/chef/Chef+Repository
[2012-06-19 21:17:08 -0400] hoover_damm: javawidget, I manage my roles with a regular text editor (emacs to be specific)
[2012-06-19 21:17:21 -0400] hoover_damm: javawidget, and then I load them with knife.  knife role from file foobar.rb
[2012-06-19 21:17:28 -0400] javawidget: Me too, jelder.
[2012-06-19 21:17:44 -0400] hoover_damm: javawidget, you should fork chef-repo if you don't and start using it
[2012-06-19 21:17:45 -0400] jelder: hoover_damm: export EDITOR=emacs ?
[2012-06-19 21:17:49 -0400] hoover_damm: as that pattern even with hosted is antastic
[2012-06-19 21:17:55 -0400] javawidget: Oh.. yes..
[2012-06-19 21:18:00 -0400] javawidget: I forked chef-repo
[2012-06-19 21:18:10 -0400] hoover_damm: fantastic*
[2012-06-19 21:18:15 -0400] hoover_damm: so do your roles in that
[2012-06-19 21:18:17 -0400] hoover_damm: not on the webui
[2012-06-19 21:18:25 -0400] javawidget: But I'm pretty sure I haven't been using it properly ;)
[2012-06-19 21:18:30 -0400] hoover_damm: time to start
[2012-06-19 21:18:51 -0400] javawidget: I drop all of my cookbooks in the cookbooks directory...
[2012-06-19 21:18:55 -0400] hoover_damm: It absolutely makes your life better... and if you need to fill up your chef-repo with all your crap
[2012-06-19 21:18:59 -0400] hoover_damm: grab the knife-essentials gem
[2012-06-19 21:19:01 -0400] javawidget: and keep my fork up to date..
[2012-06-19 21:19:06 -0400] javawidget: knife essentials..
[2012-06-19 21:19:09 -0400] javawidget: getting it.
[2012-06-19 21:19:29 -0400] hoover_damm: then you can do knife download roles/*
[2012-06-19 21:19:34 -0400] hoover_damm: and fill up your roles/ dir
[2012-06-19 21:19:48 -0400] javawidget: oh wow...
[2012-06-19 21:19:50 -0400] javawidget: really??
[2012-06-19 21:20:36 -0400] javawidget: hmmm.
[2012-06-19 21:20:56 -0400] javawidget: Should it download the roles from my configured chef server?
[2012-06-19 21:21:07 -0400] javawidget: should I expect json files?
[2012-06-19 21:22:00 -0400] javawidget: doesn't look like knife download roles/* does anything for me.
[2012-06-19 21:22:38 -0400] jelder: because roles/* expands to nothing maybe?
[2012-06-19 21:23:14 -0400] javawidget: oh wow..
[2012-06-19 21:23:28 -0400] javawidget: I just types knife download while in the roles directory..
[2012-06-19 21:23:48 -0400] javawidget: and it downloaded json files for all of my roles..
[2012-06-19 21:24:10 -0400] hoover_damm: javawidget, knife list
[2012-06-19 21:24:14 -0400] javawidget: that is awesome.
[2012-06-19 21:24:14 -0400] hoover_damm: javawidget, knife list roles/
[2012-06-19 21:24:16 -0400] jelder: i just use knife role edit et al and this script to back them up to git: https://gist.github.com/2956628
[2012-06-19 21:24:30 -0400] hoover_damm: javawidget, you may need to list / then fetch
[2012-06-19 21:24:33 -0400] hoover_damm: a little recursive is all
[2012-06-19 21:24:41 -0400] javawidget: I have them all.
[2012-06-19 21:24:47 -0400] javawidget: role.json
[2012-06-19 21:24:48 -0400] hoover_damm: javawidget, the knife-essentials gem is fantastic
[2012-06-19 21:24:49 -0400] hoover_damm: beyond belief
[2012-06-19 21:24:53 -0400] javawidget: This is great.
[2012-06-19 21:25:08 -0400] javawidget: I've been banging my head against this for two weeks.. doing it all the hard way.
[2012-06-19 21:25:52 -0400] javawidget: so..
[2012-06-19 21:25:59 -0400] javawidget: once I update a json file..
[2012-06-19 21:26:06 -0400] javawidget: I can just knife upload it?
[2012-06-19 21:26:19 -0400] jtimberman: javawidget: yes
[2012-06-19 21:26:53 -0400] jtimberman: javawidget: by default we generally steer people to using the Role Ruby DSL (roles/*.rb) because they're more simple.
[2012-06-19 21:27:08 -0400] jtimberman: but you're welcome to use JSON if you're comfortable with it.
[2012-06-19 21:27:31 -0400] javawidget: by default, it downloaded json files..
[2012-06-19 21:27:37 -0400] jtimberman: Yes
[2012-06-19 21:27:40 -0400] jtimberman: What I mean is
[2012-06-19 21:27:46 -0400] yfeldblum: and keep in mind that if you have a role file as Ruby, then it will be compiled to JSON first and then uploaded as json
[2012-06-19 21:27:49 -0400] jtimberman: When we teach people how to use / manage roles from their chef Repository
[2012-06-19 21:27:55 -0400] javawidget: I'm ok with json - are .rb files easier to work with?
[2012-06-19 21:27:58 -0400] yfeldblum: the chef-server will never see the ruby - it will only ever see the json
[2012-06-19 21:28:00 -0400] jtimberman: there's less syntax.
[2012-06-19 21:28:14 -0400] yfeldblum: but you can have ruby files if you like, which knife will translate for you
[2012-06-19 21:28:47 -0400] yfeldblum: javawidget, many people think ruby roles are easier to work with; many others think json roles area easier to work with; the question is really, which one suits you better?
[2012-06-19 21:29:25 -0400] javawidget: How would I download the ruby roles instead?
[2012-06-19 21:29:31 -0400] yfeldblum: javawidget, on the whole, the ruby roles have less syntax stuff in them, so they will look simpler at first glance
[2012-06-19 21:29:31 -0400] jtimberman: you can't
[2012-06-19 21:29:38 -0400] jtimberman: So the thing is
[2012-06-19 21:29:41 -0400] jtimberman: you pick your workflow.
[2012-06-19 21:29:56 -0400] jtimberman: If you're *only* going to manage roles from files in your chef-repository
[2012-06-19 21:30:02 -0400] jtimberman: the Ruby DSL is fine
[2012-06-19 21:30:24 -0400] jtimberman: but if you manage roles from the web ui too or programmatically somehow, then perhaps the json
[2012-06-19 21:30:34 -0400] jtimberman: if you want to store them in version control
[2012-06-19 21:30:35 -0400] javawidget: Hmmm..
[2012-06-19 21:30:39 -0400] javawidget: If it were up to me..
[2012-06-19 21:30:41 -0400] yfeldblum: javawidget, it is possible to have one role in your chef-repository that is a ruby role file and one that is a json role file; they can live side-by-side
[2012-06-19 21:30:47 -0400] jtimberman: *I* use roles/*.rb
[2012-06-19 21:30:50 -0400] javawidget: I'd go chef-repo only..
[2012-06-19 21:31:14 -0400] jtimberman: When we teach Chef Fundamentals, we only talk about the Ruby DSL for roles.
[2012-06-19 21:31:23 -0400] yfeldblum: javawidget, if you download a json role file, you can add it to your chef-repository, edit it, and upload it again as json ... if that's simpler for you
[2012-06-19 21:31:38 -0400] jtimberman: We mention that they are translated to JSON to be stored on the server.
[2012-06-19 21:31:42 -0400] javawidget: but, the web interface may be a requirement for some folks..
[2012-06-19 21:31:44 -0400] jtimberman: It's up to you though :)
[2012-06-19 21:32:22 -0400] javawidget: Super helpful.
[2012-06-19 21:32:38 -0400] javawidget: I think I learned more in the last 10 minutes that in the last two days.
[2012-06-19 21:32:53 -0400] yfeldblum: javawidget, you have to pick your workflow: if a role is going to be in source control (ie in git) then you really don't want to be editing it via the webui; OTOH if you want to be editing a role via the webui, then you really don't want to have it in source control too
[2012-06-19 21:34:25 -0400] javawidget: using git in conjunction with managed chef... does it matter?
[2012-06-19 21:34:50 -0400] javawidget: (sorry.. HOSTED chef)
[2012-06-19 21:34:51 -0400] jelder: javawidget: you want to keep your cookbooks in git for sure
[2012-06-19 21:35:06 -0400] javawidget: jelder, done :) I've got my cookbooks there.
[2012-06-19 21:35:17 -0400] javawidget: Do you keep your roles in git?
[2012-06-19 21:35:29 -0400] jelder: i keep literally everything in git as a habit, so yes
[2012-06-19 21:35:49 -0400] jelder: roles via this script: https://gist.github.com/2956628
[2012-06-19 21:35:57 -0400] javawidget: That's my natural inclination...
[2012-06-19 21:37:06 -0400] javawidget: that gist is very helpful, thank you.
[2012-06-19 21:37:20 -0400] jelder: cool
[2012-06-19 21:39:15 -0400] javawidget: I'm going to stick with keeping everything in git.
[2012-06-19 21:39:25 -0400] javawidget: thanks so much for the help
[2012-06-19 21:39:32 -0400] jelder: no problem
[2012-06-19 21:39:36 -0400] jelder: pay it forward someday
[2012-06-19 21:39:50 -0400] javawidget: Chef is fun once understood.
[2012-06-19 21:39:54 -0400] javawidget: You betcha.
[2012-06-19 21:42:29 -0400] javawidget: when were you planning to make the change to hosted chef, jelder?
[2012-06-19 21:44:55 -0400] jelder: oh i'm using hosted now, just still small enough to be on the free tier
[2012-06-19 21:46:45 -0400] Rorgo: so, I'm trying to change the server hostname that my chef node is pointing to. I changed the /etc/chef/client.rb chef_server_url setting, but it's still trying to hit the old server. Any ideas?
[2012-06-19 21:47:08 -0400] Rorgo: seems like it is cached somewhere, but I'm not sure where
[2012-06-19 21:48:10 -0400] hoover_damm: Rorgo, did you stop it and restart it?
[2012-06-19 21:49:20 -0400] Rorgo: I'm not running it in daemon mode, but I tried that too just for fun
[2012-06-19 21:51:05 -0400] Rorgo: interesting. I was pointing it at a CNAME. I removed that and pointed it directly at the host, and it worked.
[2012-06-19 21:51:08 -0400] Rorgo: goofy
[2012-06-19 21:51:26 -0400] hoover_damm: dns cache?
[2012-06-19 21:51:50 -0400] cheeseplus: ^^
[2012-06-19 21:52:44 -0400] hoover_damm: nscd or other things, or even upstream caching
[2012-06-19 21:52:46 -0400] hoover_damm: kind of a pita
[2012-06-19 21:52:53 -0400] Rorgo: yeah, nscd is running. Let me try killing that.
[2012-06-19 21:53:00 -0400] Rorgo: although digging that CNAME works correctly
[2012-06-19 21:53:13 -0400] hoover_damm: did you turn on nscd?
[2012-06-19 21:53:16 -0400] hoover_damm: or someone else?
[2012-06-19 21:53:38 -0400] Rorgo: arg. Yeah, nscd's fault.
[2012-06-19 21:54:11 -0400] Rorgo: I did as part of trying to alleviate some load. Now I remember why I hate it.
[2012-06-19 21:54:19 -0400] hoover_damm: LOL
[2012-06-19 21:54:25 -0400] hoover_damm: nscd doesn't fix squat
[2012-06-19 21:54:39 -0400] hoover_damm: trying to alleviate dns load?
[2012-06-19 21:54:45 -0400] hoover_damm: or using ldap?
[2012-06-19 21:54:48 -0400] Rorgo: ldap
[2012-06-19 21:55:21 -0400] hoover_damm: it's been awhile since I had to scale ldap... most people use the default bdb setup
[2012-06-19 21:55:24 -0400] hoover_damm: and fail
[2012-06-19 21:55:41 -0400] Rorgo: but I left it with a pretty vanilla config, which is probably the issue
[2012-06-19 21:55:45 -0400] hoover_damm: another one of those lost dark arts that devops don't know too well
[2012-06-19 21:55:52 -0400] hoover_damm: 'how do I optimize / tune bdb files?'
[2012-06-19 21:56:11 -0400] jtimberman: more like, "lost dark arts that i am glad i never had to learn" :)
[2012-06-19 21:56:21 -0400] hoover_damm: right you need to allocate the bdb file in a particular way
[2012-06-19 21:56:28 -0400] hoover_damm: jtimberman, in this case I tend to agree
[2012-06-19 21:56:34 -0400] hoover_damm: jtimberman, at least as far as LDAP.
[2012-06-19 21:57:14 -0400] cheeseplus: wait, ldap scale?
[2012-06-19 21:57:34 -0400] cheeseplus: use OpenLDAP with shared memory segments
[2012-06-19 21:57:46 -0400] cheeseplus: or switch to HDB (bdb++)
[2012-06-19 21:58:08 -0400] hoover_damm: cheeseplus, there's likely other things beyond that
[2012-06-19 21:58:18 -0400] Rorgo: I think we're using HDB. I've tried to purge LDAP from my memory because I hate that almost as much as nscd.
[2012-06-19 21:58:20 -0400] hoover_damm: cheeseplus, but those are valid points too
[2012-06-19 21:58:31 -0400] cheeseplus: oh there are indeed, I admin'd a huge installation at a university
[2012-06-19 21:59:00 -0400] cheeseplus: but for the most part you really shouldn't need to tweak those too much, if you are then you're cutting pretty close to the hardware's limit
[2012-06-19 21:59:33 -0400] hoover_damm: remember, you did hardware.  These folks are on a cloud
[2012-06-19 21:59:37 -0400] hoover_damm: the limit is a lot smaller now
[2012-06-19 21:59:47 -0400] cheeseplus: oh, well then ;)
[2012-06-19 21:59:48 -0400] hoover_damm: when your talking 1.7gigs of ram and 2 cpu's
[2012-06-19 21:59:51 -0400] cheeseplus: very good point
[2012-06-19 21:59:54 -0400] hoover_damm: it doesn't take much
[2012-06-19 22:00:09 -0400] hoover_damm: only 50 gets a second
[2012-06-19 22:00:12 -0400] cheeseplus: lots of RAM is usually what you need to make OpenLDAP happy
[2012-06-19 22:00:13 -0400] hoover_damm: would create a pretty high load
[2012-06-19 22:00:18 -0400] hoover_damm: yep
[2012-06-19 22:00:24 -0400] cheeseplus: but yea, lots of other things come into play with cloud stuff
[2012-06-19 22:00:26 -0400] cheeseplus: bbiab
[2012-06-19 22:00:29 -0400] hoover_damm: so I've learned the school of sleepycat
[2012-06-19 22:00:31 -0400] hoover_damm: the hard way
[2012-06-19 22:02:26 -0400] jhayden: anyone have time for a quick question or two?
[2012-06-19 22:03:23 -0400] hoover_damm: jhayden, Feel free to ask your question should be able to answer you.  Feel free to read over http://www.catb.org/~esr/faqs/smart-questions.html
[2012-06-19 22:03:40 -0400] jhayden: thx
[2012-06-19 22:04:11 -0400] jhayden: just learning chef and bootstrapping an was instance with a minimal role
[2012-06-19 22:04:20 -0400] jhayden: install and configure ntp
[2012-06-19 22:04:43 -0400] jhayden: getting a TypeError: can't convert Symbol into Integer
[2012-06-19 22:05:18 -0400] jhayden: from the action line here
[2012-06-19 22:05:20 -0400] jhayden: service "ntpd" do
[2012-06-19 22:05:20 -0400] jhayden:   action[:enable,:start]
[2012-06-19 22:05:21 -0400] jhayden: end
[2012-06-19 22:05:56 -0400] hoover_damm: action [:enable, :start]
[2012-06-19 22:06:00 -0400] Rorgo: yeah, what he said
[2012-06-19 22:06:14 -0400] jhayden: one of my questions is, after chef is bootstrapped how does the system get "root" authority
[2012-06-19 22:06:15 -0400] hoover_damm: subtle nuances
[2012-06-19 22:06:31 -0400] hoover_damm: chef gets root because it's ran as root
[2012-06-19 22:06:33 -0400] hoover_damm: ;)
[2012-06-19 22:06:43 -0400] jhayden: doh!
[2012-06-19 22:06:59 -0400] jhayden: oh crap a missing space!?
[2012-06-19 22:07:33 -0400] hoover_damm: that's what he said
[2012-06-19 22:07:36 -0400] jhayden: sucks when your eyes get older quicker than the rest of you
[2012-06-19 22:07:48 -0400] jhayden: thx, let me try that
[2012-06-19 22:12:59 -0400] ypz: quick question: I am using the community tomcat6 recipe on a centos6 node, and trying to use default_attributes defined in a role to override default tomcat6.java_home attribute, but it didn't work, how do I trouble shoot ?
[2012-06-19 22:14:13 -0400] jelder: ypz: wouldn't you use normal or override there?
[2012-06-19 22:15:28 -0400] ypz: hm, i thought attributes defined in roles have hight precedence over those defined in attribute/default.rb
[2012-06-19 22:15:50 -0400] ypz: s/hight/higher/
[2012-06-19 22:16:10 -0400] stucky101: chef newbie here - looking at the ntp cookbook and have some questions
[2012-06-19 22:16:52 -0400] stucky101: why is teh author defining the same group of OS's multiple times ?
[2012-06-19 22:16:56 -0400] stucky101: when "redhat","centos","fedora","scientific"
[2012-06-19 22:17:03 -0400] stucky101: he does that 3 times
[2012-06-19 22:17:38 -0400] stucky101: twice in the attributes and once again in the recipe
[2012-06-19 22:17:59 -0400] stucky101: or actually the other way around
[2012-06-19 22:18:02 -0400] cheeseplus_: stucky101: the idea is that it can deploy to any of those
[2012-06-19 22:18:03 -0400] jelder: the two hardest problems in CS are cache invalidation and coming up with names for stuff. maybe he couldn't think of a good name
[2012-06-19 22:18:21 -0400] stucky101: wouldnt you want to define this once and pull the info when needed ?
[2012-06-19 22:18:47 -0400] cheeseplus_: stucky101: you can define once but depending on decisions for each you may need to case several actions
[2012-06-19 22:18:49 -0400] cheeseplus_: for example
[2012-06-19 22:19:06 -0400] cheeseplus_: on ubuntu/debian you may need special things that you don't on centos (like libssl0.9.8 in my experience)
[2012-06-19 22:19:12 -0400] chip-: Followup on my question about printing arrays in templates this morning: If I have this in my template, is there an easy way to have it put quotes around the output?   node-names-to-ignore = [ <%= @ignored_nodes.join(", ") -%> ]
[2012-06-19 22:19:41 -0400] jelder: chip-: do you mean to quote each thing in the list?
[2012-06-19 22:19:44 -0400] chip-: yes
[2012-06-19 22:19:47 -0400] stucky101: cheeseplus - let me clarify
[2012-06-19 22:19:47 -0400] chip-: That renders [ foo, bar, baz ] but I need [ "foo", "bar", "baz" ]
[2012-06-19 22:20:00 -0400] stucky101: i do understand that u wanna account for different OS
[2012-06-19 22:20:00 -0400] cheeseplus_: not familiar with the ntp cookbook specifically but I've seen similar things, sometimes it makes sense and sometimes it certainly could be a bit more organized
[2012-06-19 22:20:13 -0400] stucky101: but i do'nt wanna define the same list multiple times
[2012-06-19 22:20:36 -0400] stucky101: why not define a list called "rh-style" and then add the relevant OS to it ?
[2012-06-19 22:20:41 -0400] stucky101: like in a data bag ?
[2012-06-19 22:20:47 -0400] stucky101: that's all I'm saying
[2012-06-19 22:20:55 -0400] stucky101: let say I need to add a new OS to the list
[2012-06-19 22:20:56 -0400] cheeseplus_: stucky101: do you have a gist of the code?
[2012-06-19 22:21:06 -0400] stucky101: i have to dig through the cookbook and find all the places
[2012-06-19 22:22:14 -0400] jelder: @ignored_nodes.map{|x| "\"#{x}\""}.join(", ")
[2012-06-19 22:22:18 -0400] cheeseplus_: that does sound odd, I usually see things like that when you are casing for specific versions of specific distros
[2012-06-19 22:22:50 -0400] chip-: jelder: And now I read up on the map method.
[2012-06-19 22:22:51 -0400] chip-: Thanks.
[2012-06-19 22:22:54 -0400] stucky101: its the out-of the-box ntp cookbook
[2012-06-19 22:23:01 -0400] jelder: chip-:  no problem
[2012-06-19 22:23:21 -0400] stucky101: cheeseplus :https://github.com/opscode-cookbooks/ntp
[2012-06-19 22:23:37 -0400] cheeseplus_: stucky101: I just cloned it but I now have an engagment
[2012-06-19 22:23:39 -0400] cheeseplus_: I may be back later
[2012-06-19 22:23:52 -0400] stucky101: damn i just had your attention :)
[2012-06-19 22:24:11 -0400] cheeseplus_: s'ok, I'm a noob too, I'm sure someone else can answer it better than I am
[2012-06-19 22:24:36 -0400] stucky101: u cannot possible be a noob as I am - started last week :)
[2012-06-19 22:24:43 -0400] cheeseplus_: jtimberman or hoover_damn
[2012-06-19 22:24:58 -0400] cheeseplus_: three weeks
[2012-06-19 22:25:04 -0400] cheeseplus_: ;
[2012-06-19 22:25:12 -0400] hoover_damm: stucky101, redhat, centos, fedora and scitenticic are 4 different distinct distros
[2012-06-19 22:25:17 -0400] stucky101: haha actually jtimberman is the author !
[2012-06-19 22:25:31 -0400] hoover_damm: redhat/centos are usually interchangeable
[2012-06-19 22:25:57 -0400] stucky101: hoover yes I get that
[2012-06-19 22:25:57 -0400] hoover_damm: you shouldn't have to care about scentific too much
[2012-06-19 22:26:03 -0400] stucky101: its not that i dont wanna distinguish
[2012-06-19 22:26:06 -0400] hoover_damm: stucky101, okay sorry what's your question?
[2012-06-19 22:26:08 -0400] stucky101: i jsut wanna define the list ONCE
[2012-06-19 22:26:12 -0400] stucky101: he defines it every time
[2012-06-19 22:26:20 -0400] stucky101: 3 times in one cook book why ?
[2012-06-19 22:26:20 -0400] miah: supsup
[2012-06-19 22:27:01 -0400] hoover_damm: stucky101, not using platform_for_value enough
[2012-06-19 22:27:04 -0400] hoover_damm: that's why
[2012-06-19 22:27:10 -0400] stucky101: twice here https://github.com/opscode-cookbooks/ntp/blob/master/recipes/default.rb
[2012-06-19 22:27:35 -0400] hoover_damm: stucky101, err value_for_platform
[2012-06-19 22:27:46 -0400] jtimberman: jhayden: 'knife bootstrap' assumes root is the default user to login, but you can specify an alternate user, and '--sudo' to run the command with sudo.
[2012-06-19 22:27:53 -0400] hoover_damm: stucky101, basically having multiple platforms means you end up dealing with crappy case / if blocks
[2012-06-19 22:28:02 -0400] hoover_damm: stucky101, the easy way around this is to use value_for_platform
[2012-06-19 22:28:08 -0400] jtimberman: stucky101: the ntp cookbook is in dire need of refactoring.
[2012-06-19 22:28:10 -0400] hoover_damm: stucky101, the python cookbook has a good example of this
[2012-06-19 22:28:29 -0400] jtimberman: stucky101: which i believe there's a pull request to do, from some fine folks that worked on it aroudn chefconf
[2012-06-19 22:28:42 -0400] jtimberman: we just haven't gotten that far in the backlog of pull requests and tickets
[2012-06-19 22:30:14 -0400] ypz: hi, jtimberman, quick question: I am using the community tomcat6 recipe on a centos6 node, and trying to use default_attributes defined in a role to override default tomcat6.java_home attribute, but it didn't work, how do I trouble shoot ?
[2012-06-19 22:30:46 -0400] stucky101: jtimberman you are the author right ?
[2012-06-19 22:31:18 -0400] stucky101: We had a meeting with Adam last week and he said the ntp cookbook was a good reference
[2012-06-19 22:31:38 -0400] stucky101: i am looking for the BEST reference cookbook out there right now to learn
[2012-06-19 22:31:45 -0400] stucky101: not too complicated either
[2012-06-19 22:31:52 -0400] stucky101: which one should I lok at then ?
[2012-06-19 22:32:12 -0400] jtimberman: stucky101: what are you trying to learn?
[2012-06-19 22:32:27 -0400] mattray: stucky101: and what are you already familiar with?
[2012-06-19 22:32:28 -0400] jtimberman: haproxy is a pretty simple "package/service/template" pattern cookbook.
[2012-06-19 22:32:43 -0400] jtimberman: the default recipe is fairly straightforward.
[2012-06-19 22:32:50 -0400] jtimberman: the app_lb recipe adds in "search"
[2012-06-19 22:36:55 -0400] scairbus: is there a way to delete a node via knife that doesn't appear to have a node name?
[2012-06-19 22:38:42 -0400] scairbus: (and not via the web UI)
[2012-06-19 22:39:19 -0400] jelder: if it doesn't have a name, how do you know it exists?
[2012-06-19 22:41:07 -0400] scairbus: knife node list is broken (probably around the time this blank node got added)
[2012-06-19 22:41:16 -0400] jelder: yikes
[2012-06-19 22:41:23 -0400] scairbus: but I can see it doing a knife search node name:*
[2012-06-19 22:41:34 -0400] jelder: you're in couched territory now
[2012-06-19 22:41:39 -0400] jelder: couchdb
[2012-06-19 22:41:50 -0400] scairbus: oh fun
[2012-06-19 22:42:01 -0400] stucky101: jtimberman i'm a total noob to chef so teh most basic but "proper" cookbook to start with
[2012-06-19 22:42:11 -0400] stucky101: to get teh basic ideas around structuring
[2012-06-19 22:42:20 -0400] stucky101: where to set attributes etc..
[2012-06-19 22:42:23 -0400] scairbus: jelder
[2012-06-19 22:42:29 -0400] scairbus: thanks, I'll start poking around with that
[2012-06-19 22:42:32 -0400] jelder: scairbus: does "knife node bulk delete REGEX" get you anywhere
[2012-06-19 22:42:55 -0400] stucky101: i thought ntp would be stright forward and simple
[2012-06-19 22:42:58 -0400] stucky101: so a good example
[2012-06-19 22:42:59 -0400] jelder: maybe /^$/ but god that could backfire
[2012-06-19 22:43:08 -0400] scairbus: I haven't tried, yeah, that's what I'm afraid of
[2012-06-19 22:43:17 -0400] stucky101: but Adam admitted that many cookbooks are not good reference anymore right now -especially older ones
[2012-06-19 22:43:23 -0400] stucky101: so im looking for a new one
[2012-06-19 22:43:38 -0400] jelder: scairbus: i'm think it will prompt, but never tried
[2012-06-19 22:44:01 -0400] miah: stucky101: https://github.com/miah/chef-redis
[2012-06-19 22:44:06 -0400] miah: should be pretty simple
[2012-06-19 22:46:19 -0400] miah: and let me know if you have questions i'll gladly discuss
[2012-06-19 22:46:32 -0400] miah: ntp is boring :P
[2012-06-19 22:47:10 -0400] miah: or, look at what i'm doing with percona-install right now.. https://github.com/miah/percona-install/commits/master
[2012-06-19 22:51:45 -0400] hoover_damm: miah, https://github.com/damm/haproxy-debian
[2012-06-19 22:51:50 -0400] hoover_damm: you may like
[2012-06-19 22:52:08 -0400] hoover_damm: miah, fwiw wt's git repo is working over ipv6
[2012-06-19 22:52:13 -0400] hoover_damm: so i can still git pull master
[2012-06-19 22:52:27 -0400] hoover_damm: can't clone it on ec2 lol
[2012-06-19 22:52:52 -0400] hoover_damm: so i kinda mirrored it locally on my box
[2012-06-19 22:53:44 -0400] miah: there are some interesting bugs in -11
[2012-06-19 22:54:01 -0400] hoover_damm: likely fixed in git
[2012-06-19 22:54:51 -0400] hoover_damm: we're rocking 1.5dev7 which is occasionally not restarting on us
[2012-06-19 22:54:52 -0400] hoover_damm: which sucks
[2012-06-19 22:54:54 -0400] hoover_damm: soo
[2012-06-19 22:54:58 -0400] hoover_damm: :-) here's to hoping
[2012-06-19 22:55:34 -0400] hoover_damm: if your not into packages you can ignore me and i'll stop giving stuff
[2012-06-19 22:56:24 -0400] miah: i was using 1.5dev7 a bunch at cx
[2012-06-19 22:56:29 -0400] miah: they are probably still running that
[2012-06-19 22:56:41 -0400] hoover_damm: you don't work for them so that shouldn't be a thought anymore
[2012-06-19 22:57:26 -0400] miah: its not =)
[2012-06-19 22:57:45 -0400] miah: i havent gotten to our chef haproxy implementation yet. working on other bits right now =)
[2012-06-19 22:57:56 -0400] miah: getting db's in chef first
[2012-06-19 22:58:04 -0400] miah: which is why i'm spending time on percona-install
[2012-06-19 22:58:13 -0400] miah: will have a pull-request for nharvey later today
[2012-06-19 22:58:55 -0400] hoover_damm: it's always a work in progress
[2012-06-19 22:59:03 -0400] hoover_damm: but don't forget the first part of working with chef miah
[2012-06-19 22:59:05 -0400] hoover_damm: sharing
[2012-06-19 22:59:16 -0400] hoover_damm: sharing your cookbooks between clients
[2012-06-19 22:59:20 -0400] hoover_damm: to make life win
[2012-06-19 22:59:56 -0400] hoover_damm: so if you move to a new job you shouldn't have to reinvent too much :) and it sounds like your on new ground
[2012-06-19 22:59:59 -0400] hoover_damm: so that's fine
[2012-06-19 23:00:05 -0400] hoover_damm: just reinforcing what you should know :) I hope
[2012-06-19 23:00:37 -0400] scairbus: oh, that wasn't so bad. bye bye null named node
[2012-06-19 23:01:39 -0400] miah: hoover_damm: oh i know =)
[2012-06-19 23:01:51 -0400] miah: that is why i host my cookbooks in github.com/miah and not github.com/company
[2012-06-19 23:02:33 -0400] miah: i write my cookbooks in a general enough way so they can be open source. if they have too much company specific config then they have to stay inhouse
[2012-06-19 23:02:36 -0400] hoover_damm: sometimes I feel bad not having them in company/ anymore
[2012-06-19 23:02:43 -0400] miah: ya
[2012-06-19 23:02:51 -0400] hoover_damm: who's sending duplicate emails to the list?
[2012-06-19 23:03:16 -0400] hoover_damm: good thing my mailer automatically dedupes
[2012-06-19 23:03:49 -0400] miah: i am so bad at mailing lists
[2012-06-19 23:22:35 -0400] hoover_damm: I basially keep a local imap server that I store all my lists on
[2012-06-19 23:23:00 -0400] hoover_damm: I used to keep old freebsd stuff, but now it's just collectd/btrfs/riak/collectd/PowerDNS/Cyrus IMAP
[2012-06-19 23:23:07 -0400] hoover_damm: oh how my attention span has gotten shorter
[2012-06-19 23:23:12 -0400] hoover_damm: oh and chef
[2012-06-19 23:30:44 -0400] papertigers: when i do a variable => search(:node, 'roles:test')  to populate a template, how can i get it out of the format of [node[somenode.domain.com]] and just the somenode.domain.com
[2012-06-19 23:31:56 -0400] hoover_damm: papertigers, .name
[2012-06-19 23:32:08 -0400] hoover_damm: papertigers, and you shouldn't just do a search like that... you need to select it
[2012-06-19 23:32:26 -0400] hoover_damm: papertigers, search(:node, 'roles:test').first.name should work
[2012-06-19 23:32:39 -0400] hoover_damm: papertigers, but you should really throw that into a block and iterate through it
[2012-06-19 23:33:48 -0400] hoover_damm: papertigers, https://github.com/opscode-cookbooks/ssh_known_hosts/blob/master/recipes/default.rb#L23-L24
[2012-06-19 23:33:54 -0400] hoover_damm: lazy way
[2012-06-19 23:34:32 -0400] timsmith: question on the chef server upgrade path.   With 0.10.8 -> 10.12 would you upgrade the server first or the clients first?
[2012-06-19 23:35:13 -0400] sparc_: lol, we just got tasked with writing integration tests for our home-grown deployment system
[2012-06-19 23:35:32 -0400] sparc_: and i'm writing some perl stuff with Test::More...  i think maybe i barked up the wrong tree
[2012-06-19 23:35:46 -0400] sparc_: this might be more for unit testing, and not really for testing systems
[2012-06-19 23:35:51 -0400] sparc_: but hey... why not
[2012-06-19 23:36:24 -0400] sparc_: i think i'm supposed to be doing recipes + rspec tests
[2012-06-19 23:36:43 -0400] sparc_: </offtopic>
[2012-06-19 23:37:31 -0400] papertigers: hoover_damm: basically I am trying to have chef generate a config that lists all the hosts that are apart of a role
[2012-06-19 23:38:41 -0400] miah: papertigers: the search results are a hash
[2012-06-19 23:39:01 -0400] papertigers: miah: is that not the proper way to do it
[2012-06-19 23:39:31 -0400] papertigers: whenver i add a new node to that role I need all the other boxes to update their config with all the hosts
[2012-06-19 23:40:01 -0400] miah: yes. this is a common problem
[2012-06-19 23:40:58 -0400] timsmith: Does anyone else get a rubygems error like OHAI-328 after they upgrade Ohai with the deb package
[2012-06-19 23:40:59 -0400] timsmith: ?
[2012-06-19 23:41:24 -0400] miah: the result is a hash, you can take the result and iterate over the keys and dump the value of the hostname or whatever into whatever you want. its standard ruby codes. don't feel restricted in what you can or can't do.
[2012-06-19 23:43:29 -0400] miah: papertigers: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/server.rb#L68
[2012-06-19 23:43:41 -0400] yfeldblum: miah, my preferred pattern is that roles and top-level cookbooks be the the integration point place where proprietary config is done, and that they predominantly set options and then call into or delegate to some much more generic underlying cookbooks, so that you end up with a thin top layer of necessarily proprietary but everything underneath of either opened or openable
[2012-06-19 23:43:52 -0400] miah: also https://github.com/opscode-cookbooks/nagios/blob/master/recipes/server.rb#L96
[2012-06-19 23:44:10 -0400] yfeldblum: miah, lofty goal, but not easy
[2012-06-19 23:44:30 -0400] miah: yfeldblum: yup exactly.
[2012-06-19 23:48:28 -0400] hoover_damm: there's a lot of different ways to do search and dump the data too
[2012-06-19 23:48:39 -0400] hoover_damm: so if you stick around long enough you'll find someone telling you how to use match or select
[2012-06-19 23:48:57 -0400] yfeldblum: miah, also the definitions of "thin" and "top layer" here needs to be somewhat malleable :P
[2012-06-19 23:50:07 -0400] yfeldblum: miah, the only rule being that the arrows all point the same way: a generic cookbook does not delegate to a proprietary one
[2012-06-19 23:51:51 -0400] hoover_damm: yfeldblum, you don't like doing that?
[2012-06-19 23:51:56 -0400] hoover_damm: yfeldblum, i've always been torn on that
[2012-06-19 23:52:46 -0400] yfeldblum: papertigers, one additional consideration that complicates your task is that, in order to get a deterministic config file so that the config file only changes if there's a reason for it to change, you'll want to make sure that when you loop over the hostnames, you make sure to sort them first
[2012-06-19 23:53:16 -0400] yfeldblum: hoover_damm, what's the pro?
[2012-06-19 23:53:25 -0400] papertigers: yfeldblum: thanks, now I just have to figure out how hashs work in ruby
[2012-06-19 23:54:05 -0400] hoover_damm: papertigers, hash['item']
[2012-06-19 23:54:20 -0400] hoover_damm: papertigers, arrays are hash[0] or hash[1]
[2012-06-19 23:54:47 -0400] hoover_damm: papertigers, and enumeration is likely all it takes... a little .each :)
[2012-06-19 23:55:07 -0400] yfeldblum: papertigers, my_hash.keys.sort.each{|key| do_something_with(key, my_hash[key])}
[2012-06-19 23:57:25 -0400] papertigers: yfeldblum: let me give that a go
[2012-06-19 23:57:38 -0400] papertigers: yfeldblum: problem is now, since there is no smf control I cant restart the service
[2012-06-19 23:58:50 -0400] miah: guh. some cookbooks are slow. eg. logrotate / openssh each add ~2 seconds to the run time
[2012-06-19 23:59:31 -0400] miah: Chef Run complete in 0.422854 seconds is the hotness though
[2012-06-19 23:59:54 -0400] yfeldblum: miah, https://github.com/opscode-cookbooks/logrotate/blob/master/recipes/default.rb#L20-22
