[2012-08-09 01:07:18 -0400] _josh: i'm using the deploy_revision resource with chef-solo, but i'm getting a "The authenticity of host 'github.com' cannot be verified, are you sure you want to continue", and it's expecting a response, which it's not letting me provide. does anyone know what i can do to override the check?
[2012-08-09 01:31:40 -0400] mksm: What should I use to communicate with Chef server from inside ruby? I've tested Chef::REST, Chef::Node, Chef::Knife so far ...
[2012-08-09 01:32:17 -0400] mksm: I want to locate a node based on an attribute, since some EC2 instances are not setting the FQDN
[2012-08-09 01:35:28 -0400] mksm: also tested Chef::Search::Query
[2012-08-09 01:42:05 -0400] PRK_nz: mksm: are they Windows nodes (the ones not setting FQDN)?
[2012-08-09 01:43:58 -0400] mksm: PRK_nz: no
[2012-08-09 01:44:28 -0400] PRK_nz: mksm: ok, never mind ;) My guess would have been Search but I'm no expert
[2012-08-09 01:44:31 -0400] mksm: PRK_nz: debian ... same AMI, the only diff is the hostname, the ones that do not set start with domU
[2012-08-09 01:49:40 -0400] PRK_nz: Anyone watching: I'm still stuck with solr issues on our Chef server, 10.12.0. Status with environment set to None has a pink banner "Could not list status"; Another environment finds no nodes when they are there, another no nodes again but with pink banner like "None", one other environment shows Status's fine...
[2012-08-09 01:50:12 -0400] kisoku_: _josh: use chef to distribue a known_hosts file that has the ssh key of github in it ?
[2012-08-09 01:50:31 -0400] PRK_nz: knife index rebuild all returns ok. Rebuilt and then restarted chef-solr, no luck
[2012-08-09 02:02:42 -0400] _josh: kisoku_: ok, i'll try that, thanks
[2012-08-09 02:11:26 -0400] ctracey_: hey folks - rather new to chef, but have a question about the service provider resource.
[2012-08-09 02:12:33 -0400] ctracey_: looking at the provider itself, it looks like service name is automatically coupled to the init script that is expected for start, stop, restart
[2012-08-09 02:13:19 -0400] ctracey_: without having to redefine all of the start,stop,restart commands, is there a clean way to decouple the name from the init script?
[2012-08-09 02:13:36 -0400] ctracey_: this may be a chef design pattern I am not familiar with
[2012-08-09 02:24:08 -0400] paigeat: is there a way to configure vagrant so that every vm's eth0 is on the same nat, and a way to specify a different ip address than 10.0.2.15 for each of them ....
[2012-08-09 02:25:10 -0400] paigeat: ohai I think gets the machines ip address? keeps getting that address and its the same on all of them so I fail to understand how vagrants support for chef-client is useful :D
[2012-08-09 02:25:25 -0400] paigeat: I mean I guess it kinda is but I really want to fix this right.
[2012-08-09 02:31:50 -0400] mksm: paigeat: can you run vagrant in bridge mode?
[2012-08-09 02:38:23 -0400] paigeat: just figured out I have to use multivm
[2012-08-09 03:23:21 -0400] maek: kallistec: do you know how I can ask stupid questions about private chef other then the support@ email address?
[2012-08-09 03:25:42 -0400] paigeat: why not here
[2012-08-09 03:25:51 -0400] maek: oh :)
[2012-08-09 03:26:06 -0400] maek: :cluster_ipaddress =>   says keep alive and drdb and I have an interface for both
[2012-08-09 03:26:21 -0400] maek: also does keep alive == heartbeat ?
[2012-08-09 03:26:43 -0400] paigeat: ????
[2012-08-09 03:26:45 -0400] paigeat: lol
[2012-08-09 03:27:04 -0400] paigeat: thats not a stupid question thats like stuff I'd have to figure out
[2012-08-09 03:27:37 -0400] paigeat: oh cool
[2012-08-09 03:27:52 -0400] maek: i guess how do you list more then 1 :cluster_ipaddresss
[2012-08-09 03:28:02 -0400] maek: does it take an []
[2012-08-09 03:28:09 -0400] maek: it is .rb
[2012-08-09 03:37:02 -0400] stormerider: so when i do "knife ec2 server create", where does it get the chef_server_url for the node it bootstraps? from knife.rb?
[2012-08-09 03:39:34 -0400] stormerider: ah, there's a --server-url parameter, nevermind :)
[2012-08-09 04:04:20 -0400] jtimberman: stormerider: it gets that from knife.rb
[2012-08-09 04:07:14 -0400] edmundsalvacion: Hi, I am having a bit of difficulty an unable to do an index rebuild the server logs return this: merb : chef-server (api) : worker (port 4000) ~ Connection initiation failed - (Bunny::ProtocolError)
[2012-08-09 04:08:56 -0400] maek: edmundsalvacion: rabbit mq
[2012-08-09 04:09:00 -0400] maek: might not be running
[2012-08-09 04:09:06 -0400] maek: service rabbitmq-server status
[2012-08-09 04:09:20 -0400] edmundsalvacion: Status of all running nodes...
[2012-08-09 04:09:21 -0400] edmundsalvacion: Node ''rabbit@chef-server'' with Pid 30805: running
[2012-08-09 04:09:22 -0400] edmundsalvacion: done.
[2012-08-09 04:09:26 -0400] maek: rabbitmqctl list_queues -p /chef
[2012-08-09 04:09:46 -0400] maek: has your chef server ever worked?
[2012-08-09 04:09:56 -0400] maek: id the /etc/chef/apmq_passwd file change?
[2012-08-09 04:10:11 -0400] edmundsalvacion: yes it did work, i did an upgrade to 10.12.0
[2012-08-09 04:10:12 -0400] maek: whats rabbitmq logs say?
[2012-08-09 04:10:15 -0400] edmundsalvacion: and thats when it started breaking
[2012-08-09 04:10:18 -0400] maek: ah
[2012-08-09 04:10:28 -0400] maek: you might want to just remake the chef users for rabbitmq
[2012-08-09 04:10:51 -0400] maek: and make sure the passwd in /etc/chef/apmq_passwd (or what ever it is) matches
[2012-08-09 04:11:00 -0400] maek: sudo rabbitmqctl add_vhost /chef
[2012-08-09 04:11:00 -0400] maek: sudo rabbitmqctl add_user chef testing
[2012-08-09 04:11:00 -0400] maek: sudo rabbitmqctl set_permissions -p /chef chef ".*" ".*" ".*"
[2012-08-09 04:11:07 -0400] maek: in this case 'testing' in the 2nd line is the passwd
[2012-08-09 04:11:33 -0400] maek: then restart chef-server and rabbit
[2012-08-09 04:11:52 -0400] maek: these are wild ass guesses as im not on 10.12 but thats happened to be before on upgrades from 9 to 10 and from 10 to 10.4
[2012-08-09 04:12:06 -0400] edmundsalvacion: there is no /etc/chef/apmq_passwdi see
[2012-08-09 04:12:09 -0400] edmundsalvacion: grr
[2012-08-09 04:12:11 -0400] edmundsalvacion: i mean.. i see
[2012-08-09 04:12:30 -0400] maek: amqp_passwd
[2012-08-09 04:12:43 -0400] maek: I wonder if it looks elsewhere now
[2012-08-09 04:12:50 -0400] maek: I know it defaults to testing
[2012-08-09 04:13:00 -0400] maek: try doing the rabbitmqclt setup
[2012-08-09 04:13:09 -0400] edmundsalvacion: there is amqp_pass in /etc/chef/solr.rb
[2012-08-09 04:13:34 -0400] maek: amqp_pass       File.read('/etc/chef/amqp_passwd').chomp ?
[2012-08-09 04:13:40 -0400] maek: or just typed out?
[2012-08-09 04:14:02 -0400] edmundsalvacion: ah it was just typed out as 'testing'
[2012-08-09 04:14:08 -0400] maek: rabbitmqctl change_password <username> <newpassword>
[2012-08-09 04:14:28 -0400] maek: try setting the rabbitmqctl chef user password to testing
[2012-08-09 04:14:46 -0400] maek: and restarting both
[2012-08-09 04:16:27 -0400] edmundsalvacion: trying that now
[2012-08-09 04:18:07 -0400] edmundsalvacion: odd still no luck.
[2012-08-09 04:18:41 -0400] maek: no not odd
[2012-08-09 04:18:43 -0400] maek: that was random
[2012-08-09 04:18:46 -0400] maek: what does rabbit mq say
[2012-08-09 04:18:50 -0400] maek: what does server.log say?
[2012-08-09 04:19:03 -0400] maek: if you do chef-server from the command line does it give you any extra info?
[2012-08-09 04:19:08 -0400] maek: stop it and then try and start it from cli
[2012-08-09 04:19:18 -0400] maek: thats usually helpful with couch and rabbit problems
[2012-08-09 04:20:11 -0400] stormerider: jtimberman: yes, but i can override it with --server-url, which is what i really want :) thanks
[2012-08-09 04:20:47 -0400] edmundsalvacion: seeing this: merb : chef-server (api) : worker (port 4000) ~ undefined method `closed?' for nil:NilClass - (NoMethodError)
[2012-08-09 04:21:50 -0400] edmundsalvacion: whoops had sold off
[2012-08-09 04:21:51 -0400] edmundsalvacion: one sec
[2012-08-09 04:21:53 -0400] edmundsalvacion: solr*
[2012-08-09 04:23:25 -0400] kyank: Im trying to set up a cron task that invokes a PHP command-line script:
[2012-08-09 04:23:29 -0400] kyank: cron "process_pending_imports" do
[2012-08-09 04:23:29 -0400] kyank: minute "00,15,30,45"
[2012-08-09 04:23:29 -0400] kyank: command "/usr/bin/php /srv/sicmyp/current/admin/import.cron.php"
[2012-08-09 04:23:30 -0400] kyank: end
[2012-08-09 04:23:53 -0400] kyank: PHP is installed with the standard php recipe. Is there a correct way to invoke the command-line version of PHP after its installed?
[2012-08-09 04:23:58 -0400] edmundsalvacion: and getting this from rabbit: =ERROR REPORT==== 9-Aug-2012::04:23:39 ===
[2012-08-09 04:23:59 -0400] edmundsalvacion: exception on TCP connection <0.2771.0> from 127.0.0.1:54215
[2012-08-09 04:23:59 -0400] edmundsalvacion: {bad_header,<<65,77,81,80,0,0,9,1>>}
[2012-08-09 04:26:18 -0400] edmundsalvacion: seeing these in the server logs:
[2012-08-09 04:26:19 -0400] edmundsalvacion: [2012-08-09T04:25:53+00:00] INFO: Sending node(0699549e-8df2-4a39-bd7e-aebfac935f42) to the index queue for addition.
[2012-08-09 04:26:19 -0400] edmundsalvacion: [2012-08-09T04:25:53+00:00] ERROR: Disconnected from the AMQP Broker (RabbitMQ)
[2012-08-09 04:26:20 -0400] edmundsalvacion: [2012-08-09T04:25:53+00:00] INFO: Attempting to reconnect to the AMQP broker
[2012-08-09 04:26:21 -0400] edmundsalvacion: [2012-08-09T04:25:53+00:00] FATAL: Connection to rabbitmq refused. Check your rabbitmq configuration and chef's amqp* settings
[2012-08-09 04:30:16 -0400] maek: edmundsalvacion: try making that apmq_passwd file
[2012-08-09 04:30:29 -0400] maek: I recall chef-server not using the solr.rb setting to find it
[2012-08-09 04:30:33 -0400] maek: again could be wrong
[2012-08-09 04:31:10 -0400] maek: gtg, good luck.
[2012-08-09 04:31:19 -0400] edmundsalvacion: thanks
[2012-08-09 04:49:26 -0400] paigeat: anyone here use vagrant on windows?
[2012-08-09 04:51:04 -0400] paigeat: guess I'll just go get my laundry and try not to think about how much I really want to finish this even though its to the point where I'm starting to read vagrant gem code
[2012-08-09 04:51:09 -0400] paigeat: :< lame
[2012-08-09 04:53:27 -0400] paigeat: screw it, is there a way to get ohai to default to a different IP address besides the one on eth0 ?
[2012-08-09 05:04:13 -0400] ssd7: Ohai Chefs!
[2012-08-09 05:04:21 -0400] stormerider: heyla ssd7
[2012-08-09 05:09:08 -0400] tigris: hi chefs
[2012-08-09 05:09:43 -0400] tigris: had an issue with the postfix recipe and noticed it has `default['postfix']['mydomain'] = domain`
[2012-08-09 05:10:06 -0400] tigris: i wonder what "domain" is? i am setting node_name in my solo.rb using chef-solo, but it's not using that
[2012-08-09 05:16:16 -0400] ssd7: tigris: It is probably referencing the "domain" attribute which is set by Ohai.
[2012-08-09 05:16:53 -0400] ssd7: Ohai sets it to everything after the first . in the fully-qualified domain name.
[2012-08-09 05:17:52 -0400] tigris: ssd7: thanks, i assume it gets that from /etc/hostname? in which case i am gonna need a recipe to set that and reload chef if bootstrapping the entire server from a nothing install?
[2012-08-09 05:20:52 -0400] ssd7: tigris: Yes and no.  It calls the `hostname` utility which may or may not use /etc/hostname
[2012-08-09 05:22:08 -0400] BryanWB_: ohai chefs!
[2012-08-09 05:23:17 -0400] paigeat: wet head shower kitty is cleanz0r
[2012-08-09 05:25:03 -0400] ssd7: Heya BryanWB_
[2012-08-09 05:25:30 -0400] BryanWB_: ssd7: hey dude!
[2012-08-09 05:25:47 -0400] erikh: hi guys
[2012-08-09 05:27:10 -0400] BryanWB_: erikh: yo! gr8 work on berkshelf btw, enjoying it
[2012-08-09 05:27:23 -0400] BryanWB_: erikh: did u get acqui-hired last week?
[2012-08-09 05:27:42 -0400] erikh: oh, no, I don't work for wildfire anymore
[2012-08-09 05:27:58 -0400] BryanWB_: ah
[2012-08-09 05:28:15 -0400] erikh: most of the berkshelf code I wrote at this point has been replaced
[2012-08-09 05:28:36 -0400] c_t: Berkshelf-Hathaway?
[2012-08-09 05:28:36 -0400] erikh: working on this now: http://github.com/erikh/sm
[2012-08-09 05:30:32 -0400] BryanWB_: looks very interesting
[2012-08-09 05:30:40 -0400] erikh: yeah, it's finally getting somewhere
[2012-08-09 05:31:01 -0400] erikh: I hope to implement salt-style rolling restarts after I get past the first set of hurdles
[2012-08-09 05:31:06 -0400] erikh: with zeromq and a remote client
[2012-08-09 05:31:47 -0400] paigeat: that sounds dope
[2012-08-09 05:31:48 -0400] erikh: oh! thanks for your cookbooks btw (lusis too) for logstash
[2012-08-09 05:31:51 -0400] erikh: we went into production today
[2012-08-09 05:32:06 -0400] erikh: I really like the code in those cookbooks.
[2012-08-09 05:32:33 -0400] BryanWB_: erikh: my pleasure
[2012-08-09 05:32:40 -0400] BryanWB_: tks
[2012-08-09 05:33:13 -0400] paigeat: meow meow, meow meow meow meow
[2012-08-09 05:34:36 -0400] c_t: I'm just glad that I've finished this one big project and have been able to start turning my attention back to chef-related stuff
[2012-08-09 05:36:04 -0400] paigeat: I think I'm gonna sit up for a few hours and read through the code for vagrant
[2012-08-09 05:36:19 -0400] c_t: got a bunch of changes to the mysql cookbook that I need to get back up to speed, and finish up that encrypted cookbook and remote file stuff
[2012-08-09 05:36:22 -0400] paigeat: try to figure out how the hell this interface that I dont want is getting added
[2012-08-09 05:36:35 -0400] c_t: (encrypted cookbook file works great, it's the remote file that needs finishing)
[2012-08-09 05:38:15 -0400] BryanWB_: c_t http://berkshelf.com, Warren should be proud ;)
[2012-08-09 05:39:05 -0400] c_t: hmm, eenteresting
[2012-08-09 05:40:25 -0400] c_t: I should probably finish folding this massive pile of laundry
[2012-08-09 05:44:04 -0400] paigeat: sigh
[2012-08-09 05:44:58 -0400] paigeat: I should go to bed
[2012-08-09 05:45:07 -0400] paigeat: busy tomorrow
[2012-08-09 05:45:41 -0400] paigeat: gnight chefs
[2012-08-09 05:52:51 -0400] tigris: thansk for the help ssd7, using https://github.com/fnichol/chef-hostname fixed my postfix/hostname problems
[2012-08-09 06:33:46 -0400] ctracey_: hey folks - does chef support anything like augeas?  i want to be able to tweak a config file without rewriting it every time
[2012-08-09 06:48:37 -0400] specialsauce: a question for everyone out there - do you build your chef servers... using chef? :-)
[2012-08-09 06:52:13 -0400] erikh: yes, you can build your chef server with chef-solo and the chef-server cookbook
[2012-08-09 06:52:41 -0400] erikh: ctracey: I was working towards a provider for augeas a while back but since I've changed jobs I've abandoned it
[2012-08-09 06:52:55 -0400] erikh: I did not find anything before I attempted
[2012-08-09 06:53:49 -0400] BryanWB_: ctracey: there is a file_edit resource iirc
[2012-08-09 06:54:00 -0400] BryanWB_: it does not use augeas tho
[2012-08-09 08:33:08 -0400] ranjibd: ma tara .. chefs!
[2012-08-09 09:33:40 -0400] eugenmayer: hello. How would i use the search to find all nodes having set the attribute node[;foo][;bar]?
[2012-08-09 09:47:38 -0400] ranjibd: eugenmayer, where? inside a recipe or via knife ?
[2012-08-09 09:48:09 -0400] ranjibd: tre : search(:node,"foo_bar:*") # insdie a recipe
[2012-08-09 09:48:25 -0400] eugenmayer: well e..g in the chef-server-webgui
[2012-08-09 09:48:29 -0400] eugenmayer: under search
[2012-08-09 09:48:34 -0400] ranjibd: try : knife search node "foo_bar:*"  # using knife command line
[2012-08-09 09:48:46 -0400] eugenmayer: (not in a reciepe, though)
[2012-08-09 09:49:25 -0400] ranjibd: nesting in solr  is represented as _ . so attribute x.y become x_y , and to search it use x_y:*
[2012-08-09 09:49:30 -0400] eugenmayer: do you guys write migration reciepes? Just asking myslf, as i changed the datastructure, how to handle it. i have over 40 nodes, manual adjustments would be pain
[2012-08-09 09:50:08 -0400] ranjibd: eugenmayer, oh yes.. knife exec and knife ssh can be of enormous use..
[2012-08-09 09:50:50 -0400] eugenmayer: well i rather wrote a reciepe for the mirgation, did not use knife exec. But well, could do the same and it rather makes sense using a cli for that, yes
[2012-08-09 09:52:41 -0400] eugenmayer: ranjibd: thank you!
[2012-08-09 09:53:18 -0400] bram__: any idea why chef would eat up all my ram when i execute the directadmin installer script, this downloads and compiles some packages.
[2012-08-09 09:53:52 -0400] bram__: each time a package is downloaded i see the memory usage going up but not going down
[2012-08-09 09:54:37 -0400] ranjibd: eugenmayer, if you want to save the nodes' information in chef server as part of the migration, traditional chef runs are better, as they call the node.save after each run.. and you can reuse that info from other nodes run list
[2012-08-09 09:55:14 -0400] eugenmayer: yeah, iam removing values and migrating them to something else and so forth
[2012-08-09 09:55:29 -0400] eugenmayer: if anybody is interested, i have not found a cookbook for git smart http yet
[2012-08-09 09:55:30 -0400] eugenmayer: https://github.com/EugenMayer/git_smart_http
[2012-08-09 11:08:16 -0400] bugant: hi there
[2012-08-09 11:08:49 -0400] bugant: I want to install nginx using the apt package on ubuntu but would like to manage it via upstart
[2012-08-09 11:09:10 -0400] bugant: is there any way I could set it?
[2012-08-09 11:10:08 -0400] bugant: node['nginx']['init_style'] is not used when installing from the package manager "because the package manager's init script style for the platform is assumed." (from https://github.com/opscode-cookbooks/nginx)
[2012-08-09 11:10:15 -0400] sampikesley: doesn't it use upstart by default now?
[2012-08-09 11:11:35 -0400] bugant: sampikesley: not sure about it, didn't check actually
[2012-08-09 11:11:45 -0400] bugant: BryanWB_: oh, why?
[2012-08-09 11:11:48 -0400] BryanWB_: bugant: u would have to modify the ckbk to delete the init script installed by the package and all its links
[2012-08-09 11:12:11 -0400] BryanWB_: bugant: prolly ok for upstart, but it isn't very flexible, its 60% of a good solution
[2012-08-09 11:12:30 -0400] BryanWB_: like u can't have a script in /etc/init/   w/out enabling it
[2012-08-09 11:13:31 -0400] bugant: BryanWB_: what do you meanch by enabling it?
[2012-08-09 11:14:05 -0400] BryanWB_: setting it to start automatically on machine boot
[2012-08-09 11:14:12 -0400] BryanWB_: and stop on shutdown
[2012-08-09 11:14:30 -0400] BryanWB_: often u want another init scritp to call another
[2012-08-09 11:15:48 -0400] bugant: BryanWB_: with upstart you can set up a service to autostart and stop on shutdown, so maybe I'm missing something
[2012-08-09 11:16:35 -0400] BryanWB_: but i might not want ti to
[2012-08-09 11:16:50 -0400] BryanWB_: as w/ pacemaker or heartbeat
[2012-08-09 11:17:02 -0400] BryanWB_: i want those services to control the start/stop
[2012-08-09 11:17:05 -0400] bugant: oh ok got it
[2012-08-09 12:09:40 -0400] ringods: Afternoon guys. I would like to know how you guys arrange firewall configuration related to a chef setup.
[2012-08-09 12:12:11 -0400] ringods: If you have a setup with a few services (apache, tomcat, mysql, ) where do you put the firewall rules related to allowing the different connections?
[2012-08-09 12:12:31 -0400] ringods: in a separate cookbook, or intermixed with the cookbooks of the different services?
[2012-08-09 12:33:07 -0400] cnf: how do i get to attributes from other cookbooks?
[2012-08-09 12:33:12 -0400] cnf: just require them?
[2012-08-09 12:39:49 -0400] ringods: cnf: "include_attribute"
[2012-08-09 12:39:50 -0400] cnf: aha
[2012-08-09 12:39:53 -0400] ringods: cnf: See "Cookbook Attribute File Ordering" in http://wiki.opscode.com/display/chef/Attributes
[2012-08-09 12:40:35 -0400] cnf: ringods: thanks
[2012-08-09 13:06:32 -0400] stephenking: hi!
[2012-08-09 13:06:53 -0400] stephenking: can sb. please give me an example, how to deploy a Java .war using application_java?
[2012-08-09 13:07:22 -0400] stephenking: it's driving me nuts..
[2012-08-09 13:08:14 -0400] stephenking: i always end up with the same problem as this poor guy: https://gist.github.com/2959823
[2012-08-09 13:10:05 -0400] ctrabold: stephenking: me too. Couldn't get much out of http://lists.opscode.com/sympa/arc/chef/2012-05/msg00271.html either
[2012-08-09 14:34:06 -0400] eetfunk: Hi all, I'm a total n00b Chef user. I keep having this problem when i try to deploy and I have no idea why: FATAL: NameError: wrong constant name Rbenv.Ruby.  At first the Bluepill cookbook was giving me something similar and now that I've removed it, Rbenv is doing the same.
[2012-08-09 14:35:05 -0400] eetfunk: Rbenv is not even in my run list.
[2012-08-09 14:38:12 -0400] bahman2000: bad ruby install?
[2012-08-09 14:39:18 -0400] eetfunk: bahman2000: Ruby was installed with apt-get just to run Chef. And it seems to run just fine...
[2012-08-09 14:39:19 -0400] jsnapp: hello, what do chefs do to get private keys (e.g. ssl, opendkim) onto their nodes?
[2012-08-09 14:39:39 -0400] mattray: jsnapp: private keys or public keys?
[2012-08-09 14:40:27 -0400] jsnapp: mattray: private ... like ssl private key for website or opendkim private key for postfix email
[2012-08-09 14:41:12 -0400] jsnapp: i'm creating an opendkim cookbook and opendkim requires a private key for signing email
[2012-08-09 14:41:43 -0400] bahman2000: jsnapp cookbook_file resource?
[2012-08-09 14:42:42 -0400] mattray: jsnapp: managing private keys is a bit of a crapshoot, depends on how you want to manage it
[2012-08-09 14:42:56 -0400] mattray: jsnapp: cookbook_file has your private key in a cookbook, not super secure
[2012-08-09 14:43:12 -0400] geekbri: You could use an encrypted databag, but don't be fooled into thinking that is super secure
[2012-08-09 14:43:16 -0400] mattray: jsnapp: remote_file could be slightly better, keep the key on a private web server
[2012-08-09 14:43:37 -0400] mattray: yeah, encrypted data bag still has a problem of where you store the encryption key
[2012-08-09 14:43:43 -0400] geekbri: Yeah
[2012-08-09 14:43:46 -0400] jsnapp: mattray: i agree that wouldn't be secure .. and remote_file does seem only slightly better ...
[2012-08-09 14:44:02 -0400] mattray: jsnapp: there is a new commercial product: http://gazzang.com/products/ztrustee
[2012-08-09 14:44:33 -0400] mattray: jsnapp: they've been very aggressive about their Chef support
[2012-08-09 14:44:36 -0400] jsnapp: encrpyted data bag seemed the way to go but how do you get the content into the file in a managed way?
[2012-08-09 14:44:38 -0400] mattray: but, it's a SaaS
[2012-08-09 14:44:54 -0400] mattray: jsnapp: from your workstation
[2012-08-09 14:45:28 -0400] jsnapp: right, i've followed dustin kirkland's blog about the gazzang products but figured there would be a simpler (free) way
[2012-08-09 14:45:54 -0400] mattray: jsnapp: yeah, I told them they should do 5 free objects :)
[2012-08-09 14:46:49 -0400] jsnapp: mattray: so i love what chef does but i'm surprised there's not a more standard answer given how many companies must be using chef to manage even just website deployments
[2012-08-09 14:47:03 -0400] jsnapp: assuming that many of those websites require https anyway
[2012-08-09 14:47:07 -0400] mattray: jsnapp: yeah, we've kinda punted on solving that problem :/
[2012-08-09 14:47:13 -0400] jsnapp: haha
[2012-08-09 14:47:19 -0400] ctracey: mattray: off topic for a second, but I'm looking at your dhcp repo.  presume that is pretty much the latest?
[2012-08-09 14:47:31 -0400] ctracey: jsnapp: we have a similar issue with puppet
[2012-08-09 14:47:44 -0400] mattray: ctracey: yeah, I hadn't worked on it much for awhile, but interest has picked up in it again
[2012-08-09 14:47:52 -0400] mattray: ctracey: got a pull request to merge
[2012-08-09 14:48:00 -0400] mattray: ctracey: people are actually trying it out
[2012-08-09 14:48:05 -0400] jsnapp: ctracey: glad to hear that .. not that i have any particular beef with puppet but i'm glad i chose chef
[2012-08-09 14:48:43 -0400] ctracey: mattray: please dont tell me i missed the pull req ;)
[2012-08-09 14:49:01 -0400] mattray: ctracey: just 1 in there :)
[2012-08-09 14:49:34 -0400] geekbri: Dealing with secret keys is always a challenge :)
[2012-08-09 14:49:37 -0400] mattray: ctracey: I'll merge it right now
[2012-08-09 14:49:40 -0400] geekbri: its that whole pesky secret part.
[2012-08-09 14:49:43 -0400] ctracey: mattray: checking it out now.  after i made some serious mods last night of course :)
[2012-08-09 14:50:00 -0400] mattray: ctracey: the patches are for 12.04, what are you using?
[2012-08-09 14:50:05 -0400] ctracey: 12.04
[2012-08-09 14:50:21 -0400] mattray: ok, ping me if they don't work and we'll come up with a better solution
[2012-08-09 14:50:53 -0400] jsnapp: mattray: when you said "encrypted data bag still has a problem of where you store the encryption key" were you referring to where you store the encrypted databag key or the opendkim private key?
[2012-08-09 14:50:58 -0400] ctracey: mattray: checking it out now, but at first glance we might want something a lil more robust
[2012-08-09 14:51:03 -0400] mattray: jsnapp: yeah
[2012-08-09 14:51:27 -0400] mattray: ctracey: yeah, I haven't used it much in anger, but longterm I want to manage it with omapi
[2012-08-09 14:51:37 -0400] mattray: ctracey: with a knife plugin
[2012-08-09 14:51:50 -0400] jsnapp: mattray:  haha, which one?  i gave two options and you responded with "yeah" :)
[2012-08-09 14:52:07 -0400] mattray: jsnapp: yeah, where you store the encrypted data bag key
[2012-08-09 14:52:15 -0400] mattray: jsnapp: you're trading multiple problems for 1
[2012-08-09 14:54:07 -0400] jsnapp: mattray: ok but that seems satisfactory for me .. i already plan to use encrypted databag key .. seems like the best solution for other things like passwords etc ... it gets auto installed on the nodes using knife bootstrap and i'd also store it on my workstation .. for my environment that would be sufficient
[2012-08-09 14:54:27 -0400] mattray: jsnapp: cool
[2012-08-09 14:54:49 -0400] mattray: jsnapp: I agree though, it would be better if we had a go-to answer for key management
[2012-08-09 14:55:04 -0400] mattray: jsnapp: we're doing a webinar with Gazzang in the meantime
[2012-08-09 14:55:34 -0400] mattray: jsnapp: still, as soon as I saw zTrustee I figured someone would write an open source version
[2012-08-09 14:56:21 -0400] jsnapp: mattray: so i'll use encrypted databag to store the private key(s) ... i know how in a recipe to pull in and decrypt the content of the key but how do i store it to a file on the node? use a template and pass the decrypted content as a variable?
[2012-08-09 14:57:16 -0400] mattray: jsnapp: or a cookbook_file
[2012-08-09 14:58:36 -0400] jsnapp: mattray: but how would i pass the content stored in a variable into a cookbook_file recipe?  doesn't a cookbook_file refer to a file already in your cookbook?
[2012-08-09 14:59:02 -0400] jsnapp: oops, i meant cookbook_file resource instead of recipe
[2012-08-09 14:59:33 -0400] mattray: jsnapp: I just meant a key file as opposed to passing the content into a template, whatever matches your workflow
[2012-08-09 15:00:14 -0400] jsnapp: mattray: oh ok, so just to be clear you were referring back to the less secure way of storing the private key directly in the cookbook?
[2012-08-09 15:00:23 -0400] mattray: jsnapp: yes
[2012-08-09 15:00:59 -0400] jsnapp: mattray: and not only is that less secure but it also means the cookbook can't easily be shared with the community
[2012-08-09 15:01:15 -0400] jsnapp: mattray: thanks so much ... you saved me a bunch of time
[2012-08-09 15:01:53 -0400] mattray: jsnapp: you could share the cookbook, just keep the sensitive data in an attribute in a role?
[2012-08-09 15:02:12 -0400] mattray: jsnapp: sorry, nevermind
[2012-08-09 15:02:34 -0400] mattray: jsnapp: yes, the cookbook_file style sucks for sharing
[2012-08-09 15:04:18 -0400] bahman2000: can i use it like this: cookbook_file "*" do
[2012-08-09 15:05:58 -0400] bahman2000: ?
[2012-08-09 15:06:19 -0400] paigeat: sunshine morning kitty of joyness
[2012-08-09 15:07:00 -0400] bahman2000: for instance if i'm managing contents of a website and i want updated files to be pushed out?
[2012-08-09 15:07:20 -0400] ctracey: mattray: ill work to get you that pull req today.
[2012-08-09 15:07:44 -0400] mattray: ctracey: I just commented on japage's pull request, he left some stuff out
[2012-08-09 15:08:35 -0400] paigeat: anyone ever noticed that gist.github doesn't support hash tag line numbers?
[2012-08-09 15:08:37 -0400] paigeat: sux
[2012-08-09 15:08:38 -0400] mattray: ctracey: the previous stuff was here: https://github.com/mattray/mattray-cookbooks/tree/b264d9be50b80dac5487bb0f5685455a036e16d2/dhcp
[2012-08-09 15:08:39 -0400] paigeat: :(
[2012-08-09 15:08:47 -0400] ctracey: mattray: i saw the comment.  not sure i will have time to test on < 12.04, but the configs should be pretty much the same.  all the logic is in the package rename.
[2012-08-09 15:09:00 -0400] mattray: ctracey: moved that to the new repo, but left off the last commit from there when I moved it
[2012-08-09 15:09:16 -0400] mattray: ctracey: ok, sounds like you're on the same page
[2012-08-09 15:09:19 -0400] ctracey: mattray: ah. lemme take a look then.
[2012-08-09 15:09:48 -0400] japage: I am currently getting it fully working with pxe dust, I should have something by eob est
[2012-08-09 15:10:22 -0400] japage: ctracey: there are still bugs with dhcp, I should have them worked out by end of today
[2012-08-09 15:11:23 -0400] ctracey: japage: anything in particular?
[2012-08-09 15:12:09 -0400] ctracey: japage: i have it *mostly* working.  weirdness when it comes to the templating, but that shouldnt be hard even for this chef newb.
[2012-08-09 15:12:20 -0400] japage: ctracey: yea, the LWRP's dont update the includes in the conf files in the individual resource files, there is a method referenced from another cookbook that doesnt exist (im almost done fixing those two)
[2012-08-09 15:12:34 -0400] ctracey: japage: you read my mind :)
[2012-08-09 15:12:49 -0400] ctracey: japage: utils_line
[2012-08-09 15:12:56 -0400] japage: ctracey: yea, give me about an hour and ill have that fixed
[2012-08-09 15:13:12 -0400] japage: ctracey: it needs another lwrp to fix that
[2012-08-09 15:13:40 -0400] ctracey: japage: we can compare out changes afterwards. this is blocking my openstack deployment
[2012-08-09 15:14:07 -0400] mattray: ctracey: are you familiar with #openstack-chef?
[2012-08-09 15:14:59 -0400] ctracey: mattray: yes, using it in conjunction with the rcb guys.  i want to network provision physical nodes via pxe.
[2012-08-09 15:15:17 -0400] mattray: ctracey: excellent, that's my use case as well
[2012-08-09 15:15:28 -0400] japage: ctracey: here, this is what ive done so far
[2012-08-09 15:15:30 -0400] japage: https://github.com/jaustinpage/dhcp/
[2012-08-09 15:15:43 -0400] ctracey: japage: awesome.  ill take a look.
[2012-08-09 15:16:00 -0400] japage: ctracey: i just pushed, it is broken right this second, but i should have it fixed soon.
[2012-08-09 15:16:42 -0400] japage: ctracey: if you want, I can give you push access to my fork, and we can finish it up real quick together
[2012-08-09 15:17:16 -0400] ctracey: japage: i solved it a little differently.  here it looks like you have a straight move to isc-dhcp-server
[2012-08-09 15:17:29 -0400] ctracey: japage: i intended it make it backwards compatible
[2012-08-09 15:18:23 -0400] japage: ctracey: your right, i did break backwards compatibility
[2012-08-09 15:18:45 -0400] ctracey: japage: we can solve this pretty easily
[2012-08-09 15:24:47 -0400] paigeat: anybody know anything about what this guy is talking about https://groups.google.com/forum/?fromgroups#!searchin/vagrant-up/eth0/vagrant-up/K9GoEKFjQUg/4PuouQf8qsQJ
[2012-08-09 15:44:16 -0400] ranjibd: paigeat, he can use the other interface from ohai too
[2012-08-09 15:49:28 -0400] ranjibd: paigeat,  node.network.interfaces.eth1
[2012-08-09 16:03:11 -0400] paigeat: ranjibd I'd much rather figure out how to get ohai to default to a different interface rather than these /etc/udev/rules.d/70-persistent-net.rules hax of renaming the eth0 adapter (whose mac address is set statically in teh vbox base configuration.)
[2012-08-09 16:13:26 -0400] honza: could someone help me with an apt-get update issues? thanks http://stackoverflow.com/questions/11875417/chef-ignores-apt-get-update
[2012-08-09 16:14:52 -0400] geekbri: honza: Strange, could you show the output of the chef run.  Also have you considered using the apt cookbook ?
[2012-08-09 16:15:10 -0400] geekbri: honza: also you have do and the bottom there isntead of "end"
[2012-08-09 16:15:33 -0400] honza: geekbri: there is really no output, i can only tell that it did nothing because the following call fails to find the package in the repository
[2012-08-09 16:16:00 -0400] honza: geekbri: that's just a SO fail, it's correct in the code, sorry
[2012-08-09 16:16:18 -0400] honza: geekbri: fixed
[2012-08-09 16:16:25 -0400] geekbri: honza: you could actually just do execute "command", you don't actually have to wrap it the way you have
[2012-08-09 16:16:41 -0400] honza: geekbri: cool
[2012-08-09 16:16:44 -0400] geekbri: honza: the chef-run itself must have some output.
[2012-08-09 16:17:01 -0400] honza: geekbri: let me check
[2012-08-09 16:19:16 -0400] honza: geekbri: output http://gist.honza.ca/5023e2f5fe680d0007000000
[2012-08-09 16:20:27 -0400] geekbri: honza: Are you sure that whatever is running that execute resource occurs before whatever is trying to isntall postgres in the run_list ?
[2012-08-09 16:21:13 -0400] honza: geekbri: yup, it's two lines above it in the recipe
[2012-08-09 16:21:53 -0400] honza: geekbri: full recipe http://gist.honza.ca/5023e38ffe680d0007000001?ruby
[2012-08-09 16:26:45 -0400] honza: geekbri: it looks like the apt cookbook only handles adding/removing repos to the list https://github.com/opscode-cookbooks/apt
[2012-08-09 16:27:30 -0400] geekbri: honza: https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb#L28-33
[2012-08-09 16:28:05 -0400] honza: geekbri: ah, cool
[2012-08-09 16:28:07 -0400] geekbri: honza: have you verified you can run apt-get update on the server by hand?
[2012-08-09 16:28:24 -0400] honza: geekbri: yes, when i run it by hand, i can install postgresql no problem
[2012-08-09 16:31:20 -0400] honza: geekbri: using the apt cookbook produces the same result :(
[2012-08-09 16:39:28 -0400] AmishGeek: my chef server has filled up al the free space on its drive, is it just generating logs or what?  is there a way to prune/drump/trim some of the data?
[2012-08-09 16:46:31 -0400] miah: AmishGeek: are you compacting your couchdb?
[2012-08-09 16:46:50 -0400] miah: compacting?
[2012-08-09 16:47:11 -0400] miah: compacting is http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2012-08-09 16:47:17 -0400] miah: bawt remember that!~
[2012-08-09 17:06:01 -0400] dougireton: I'm trying to run foodcritic as a Git pre-commit hook but when the pre-commit hook runs, it throws this error: .rvm/gems/ruby-1.9.3-p194@chef/gems/foodcritic-1.4.0/bin/foodcritic:2: undefined method `require_relative' for main:Object (NoMethodError)
[2012-08-09 17:06:34 -0400] dougireton: Here's the line from my pre-commit hook: exec foodcritic -f any cookbooks/
[2012-08-09 17:06:48 -0400] dougireton: foodcritic runs fine from the command line
[2012-08-09 17:16:18 -0400] chrisr244: Working on getting a setup with Jenkins and Chef working well together. In practice, should a continuous integration server (ie. Jenkins) be given access to Chef knife as a workstation? In a large organization, should I just give it my username.pem security file, or is there some way to allow it to use knife without being given a specific users credentials?
[2012-08-09 17:21:01 -0400] dougireton: @chrisr244 I assume you would want to create a specific user for Jenkins on your Chef Server
[2012-08-09 17:21:23 -0400] dougireton: then use the jenkins.pem file on the Jenkins box
[2012-08-09 17:26:02 -0400] chrisr244: dougireton, with hosted chef, I assume it would just need an opscode account?
[2012-08-09 17:27:36 -0400] dougireton: Well, we are using Private Chef, but since that's basically the same thing as Hosted, then yes I assume you would just need a separate user acct in Hosted Chef
[2012-08-09 17:28:48 -0400] chrisr244: I assume only workstations can change databags? ;)
[2012-08-09 17:31:06 -0400] bahman2000: schisamo around?
[2012-08-09 17:33:13 -0400] ramsey: I'm trying to load this recipe (https://github.com/opscode-cookbooks/application_php) in my Vagrantfile, but I keep getting errors, so I'm not sure I'm loading it properly. Here's what I see when I run `vagrant up`: http://pastie.org/4439711 and here's my Vagrantfile: http://pastie.org/4439840
[2012-08-09 17:33:22 -0400] ramsey: The folks in #vagrant said I should ask here. :-)
[2012-08-09 17:40:06 -0400] paulmooring: ramsey: What are you trying to do with the application_php cookbook
[2012-08-09 17:40:35 -0400] paulmooring: you need to make a recipe or another cookbook that depends on this so you can define an application resource
[2012-08-09 17:40:40 -0400] ramsey: start up an environment that's running apache with PHP support
[2012-08-09 17:40:44 -0400] ramsey: ah
[2012-08-09 17:40:51 -0400] paulmooring: the cookbook should have a README with it
[2012-08-09 17:41:17 -0400] paulmooring: but it's for deploying an existing appliaction, I think you probably want the apache2 cookbook
[2012-08-09 17:41:17 -0400] yfeldblum: chrisr244, you can give it its own api-client creds (name, privkey, admin bit)
[2012-08-09 17:41:34 -0400] ramsey: paulmooring: thanks
[2012-08-09 17:42:21 -0400] ramsey: I just tried using only chef.add_recipe("php"), and I see this error occur in the output:
[2012-08-09 17:42:28 -0400] ramsey:  /opt/vagrant_ruby/lib/ruby/gems/1.8/gems/chef-0.10.10/bin/../lib/chef/resource.rb:598: warning: already initialized constant Application
[2012-08-09 17:43:01 -0400] paulmooring: ramsey: that's just a warning, shouldn't be a problem
[2012-08-09 17:43:40 -0400] ramsey: hmm... but `which php` doesn't give me a path to PHP when I log in to the VM, so unless I'm misunderstanding what that recipe does, I don't think it's working properly
[2012-08-09 17:44:24 -0400] ramsey: this is the fatal error I see:
[2012-08-09 17:44:25 -0400] ramsey: FATAL: Chef::Exceptions::Exec: package[php5-cgi] (php::package line 33) had an error: Chef::Exceptions::Exec: apt-get -q -y install php5-cgi=5.3.2-1ubuntu4.15 returned 100, expected 0
[2012-08-09 17:44:41 -0400] ashb: sounds like apt-get has wedged somewhere
[2012-08-09 17:44:44 -0400] paulmooring: That's a generic apt-get error
[2012-08-09 17:44:45 -0400] ramsey: ah
[2012-08-09 17:45:09 -0400] _rc: just run that command outside of chef and apt will tell you why it's sad
[2012-08-09 17:45:10 -0400] paulmooring: the php default recipe just installs php and updates pear/pecl
[2012-08-09 17:45:41 -0400] paulmooring: My guess is a repo was added but apt-get update wasn't run
[2012-08-09 17:52:31 -0400] chefster: Hey folks, new to chef and wanted to get a quick thumbs up/down on my approach. Here's the goal: I have ~30 remote servers that need to pull a single file via rsync from a central server whenever that file has been updated to a new version. The files are ~300MB each and are different for each of the servers, so putting them in a git repo isn't currently an option.
[2012-08-09 17:52:32 -0400] chefster: My current plan is to have a Data Bag item that contains the "current version" (basically a timestamp). I want my recipe to:
[2012-08-09 17:53:34 -0400] mattray: chefster: sounds reasonable
[2012-08-09 17:54:21 -0400] chefster: mattray: does using a Data Bag for this sound better than updating attribute for each of the nodes when I want to update them?
[2012-08-09 17:54:51 -0400] mattray: chefster: data bag makes sense, or an attribute on the Environment or shared Role
[2012-08-09 17:55:39 -0400] mattray: chefster: kinda wish we had a better rysnc cookbook: https://github.com/opscode-cookbooks/rsync is pretty useless
[2012-08-09 17:58:14 -0400] chefster: mattray: I was hoping to find an rsync Resource like HTTP Request, but I guess I'm on my own to just call rsync via "command", right?
[2012-08-09 17:58:56 -0400] mattray: chefster: yeah, unless you want to make a Lightweight Resource Provider (LWRP) for the rsync cookbook that wraps the command in a Resource
[2012-08-09 17:59:13 -0400] mattray: chefster: since it currently doesn't have that, it's kinda dumb
[2012-08-09 17:59:32 -0400] chefster: mattray: yeah, I think that's too much to bite off at the moment. I'm still climbing up the Chef learning curve.
[2012-08-09 17:59:54 -0400] mattray: lwrp-ing the rsync cookbook is way down my list of things to do, but it's on there :)
[2012-08-09 18:00:41 -0400] chefster: mattray: hopefully last question any chance you've seen a recipe around that is similar to what I described? I haven't had much luck googling around for various combinations of "chef" and "rsync"
[2012-08-09 18:00:57 -0400] ramsey: ah ha... paulmooring, I just needed to also add the apt recipe first, which runs apt-update
[2012-08-09 18:01:25 -0400] mattray: chefster: not specifically
[2012-08-09 18:02:06 -0400] mattray: chefster: it seems to me you want to check the version, then use search to find the host for the file, then rsync it
[2012-08-09 18:03:20 -0400] yfeldblum: chefster, i might stick the expected checksum/digest in the data-bag item, rather than a timestamp (or in addition to a timestamp)
[2012-08-09 18:04:05 -0400] chefster: yfeldblum: I was just about to bring that up. What does chef use for the checksum? md5? sha?
[2012-08-09 18:04:21 -0400] yfeldblum: chefster, for example, compute the SHA-256 of the file, stick that in the data-bag item, and have your recipe compare the SHA-256 it recorded after downloading the last version of the file to the SHA-256 it just found out from the data-bag item
[2012-08-09 18:05:20 -0400] yfeldblum: chefster, or MD5
[2012-08-09 18:05:33 -0400] yfeldblum: chefster, this isn't a security context (i think) so performance matters: http://www.cryptopp.com/benchmarks.html
[2012-08-09 18:05:49 -0400] chefster: I see - I can pick whatever checksum I want. I thought maybe Chef was providing that and had a preference.
[2012-08-09 18:06:17 -0400] chefster: only problem is that there is a distinct file generated for each of the 30 hosts, so each would have it's own checksum, but all have the same "version"
[2012-08-09 18:06:40 -0400] yfeldblum: chefster, why?
[2012-08-09 18:08:21 -0400] chefster: they're bootable linux images that are customized for each remote server so they are all different. The "compile" step creates the 30 files, dumps them on a single machine, and I need each of the 30 remote servers to pick up "their" copy
[2012-08-09 18:08:23 -0400] ranjibd: chefster, the node where all the files are located (origin) is under chef?
[2012-08-09 18:08:53 -0400] chefster: ranjibd: Not presently but I can make it a chef-client, if that's what you mean.
[2012-08-09 18:09:47 -0400] chefster: so the only thing shared by the 30 images is the "version", which is what I was planning to stick into the Data Bag
[2012-08-09 18:10:09 -0400] yfeldblum: chefster, well then either precompute 30 checksums or just use timestamp or counter versions
[2012-08-09 18:11:17 -0400] chefster: yfeldblume: If I precompute 30 checksums then how would I store them in chef-server? Maybe a Data Bag that's a 30-element hash with :node => :checksum? I hadn't thought of that approach.
[2012-08-09 18:11:18 -0400] ranjibd: you can keep the mtime of those original files stored as meta node attribute . and compare this with individual client node's files mtime (again stored as an attribute) and trigger an rsync when they are different
[2012-08-09 18:12:56 -0400] chefster: ranjibd: in your suggested scenario, I'd need to update an attribute on each of the 30 nodes, right? I don't think this is a problem  just checking that I'm understanding.
[2012-08-09 18:13:48 -0400] chefster:  I kinda like this approach actually b/c I can more easily update a single node w/o bumping up the version for *all* of them at once which was my original approach with a single "version" in a Data Bag that each node would query
[2012-08-09 18:15:02 -0400] patcon: anyone know what the deal with this is: https://github.com/opscode-cookbooks/postfix/blob/master/attributes/default.rb#L19
[2012-08-09 18:15:22 -0400] patcon: are `fqdn` and `domain` available as striaght-up variables in attr files?
[2012-08-09 18:15:34 -0400] patcon: jtimberman ^^ with the last edit on the file
[2012-08-09 18:15:53 -0400] jtimberman: patcon: they're not "variables" :)
[2012-08-09 18:16:05 -0400] yfeldblum: chefster, you should probably stick the files behind an HTTP server that can give back MD5 checksums
[2012-08-09 18:16:07 -0400] jtimberman: patcon: cookbooks' attributes files are evaluated in the context of the node object.
[2012-08-09 18:16:13 -0400] jtimberman: so 'node' is implied.
[2012-08-09 18:16:25 -0400] jtimberman: it is clearer, and better stylistically to use node['domain'] or node['fqdn']
[2012-08-09 18:16:46 -0400] jtimberman: just like it would be clearer to say node.default['thing'] vs default['thing']
[2012-08-09 18:16:53 -0400] yfeldblum: the rare occurrence when i agree with jtimberman ...
[2012-08-09 18:16:58 -0400] jtimberman: yfeldblum: :P!
[2012-08-09 18:17:09 -0400] jtimberman: yfeldblum: you like symbols for attribute keys don't you? :(
[2012-08-09 18:17:35 -0400] yfeldblum: chefster, only when i'm in the mood for a good nerdrage
[2012-08-09 18:17:40 -0400] jtimberman: (i do too, but two years of teaching Chef to people, has shown that symbols are more surprising than strings)
[2012-08-09 18:19:14 -0400] ranjibd: chefster, yes in the meta-node , and every individual node will update it once rsync has run without error
[2012-08-09 18:19:29 -0400] yfeldblum: jtimberman, indeed they are - one fellow was sticking keys prefixed with colons into a role json or something (something like "default_attributes": {":nginx": "asdf"})
[2012-08-09 18:20:45 -0400] ranjibd: jtimberman, this magic is coming from mash ?
[2012-08-09 18:21:00 -0400] jtimberman: ranjibd: the node in an attributes file?
[2012-08-09 18:21:19 -0400] ranjibd: yeah.. accessing the node attributes as methods..
[2012-08-09 18:22:03 -0400] ranjibd: i had used objectstruct earlier.. i wonder how mash is different from objectstruct
[2012-08-09 18:22:34 -0400] yfeldblum: ranjibd, no, this magic is Chef::Node and Chef::Node::Attribute, which are not Mash
[2012-08-09 18:25:06 -0400] ranjibd: yfeldblum, ok.
[2012-08-09 18:25:58 -0400] paigeat: is there a way I can change what IP address / interface ohai defaults to
[2012-08-09 18:26:27 -0400] schisamo: bahman2000: I am now.  what's up?
[2012-08-09 18:26:47 -0400] bahman2000: schisamo having issues with windows_zipfile resource
[2012-08-09 18:27:13 -0400] bahman2000: schisamo  had an error: NoMethodError: undefined method `CloseHandle' for Chef::ReservedNames::Win32::Handle:Class
[2012-08-09 18:27:59 -0400] geekbri: I prefer symbols over strings as well, but if somebody is not familiar with ruby, I can see why that would be confusing :)
[2012-08-09 18:28:49 -0400] bahman2000: schisamo but it's ok, i'm working around it
[2012-08-09 18:29:15 -0400] schisamo: bahman2000: are you on the latest?  I believe jtimberman did a bunch of fixing over the past few months.
[2012-08-09 18:29:32 -0400] bahman2000: schisamo i think so, pulled it a couple of days ago
[2012-08-09 18:31:05 -0400] schisamo: bahman2000: if you get a chance open a COOK ticket with detailswe <3 detailed stack traces :)
[2012-08-09 18:31:23 -0400] bahman2000: schisamo my bad, i will, thanks!
[2012-08-09 18:31:32 -0400] paigeat: is there an ohai plugin that will make ohai report the address of eth1 instead of eth0
[2012-08-09 18:31:42 -0400] paigeat: or can that even be done with a plugin
[2012-08-09 18:41:08 -0400] jtimberman: schisamo: i haven't any hacking, just merging
[2012-08-09 18:41:26 -0400] jtimberman: i try to leave windows programming to people more knowledgable about it like schisamo :P
[2012-08-09 18:42:46 -0400] paigeat: I like writing my own operating systems
[2012-08-09 18:43:16 -0400] patcon: jtimberman: ah ok, thanks! i'm not sure if it's just that 0.10.8 doesn't support that, but the `node` seems to be required or else I'm getting on of these:
[2012-08-09 18:43:16 -0400] patcon: FATAL: ArgumentError: Attribute fqdn is not defined!
[2012-08-09 18:44:28 -0400] patcon: during the compilation phase just after the chefgem resource is loaded: chef_gem cookbook, that is
[2012-08-09 18:45:57 -0400] paigeat: isnt there like a chef hacking channel
[2012-08-09 18:46:10 -0400] jtimberman: paigeat: i wrote this as an ohai plugin awhile back: https://gist.github.com/1040853
[2012-08-09 18:46:13 -0400] jtimberman: it might be helpful
[2012-08-09 18:46:24 -0400] paigeat: was just looking at that actually
[2012-08-09 18:46:28 -0400] jtimberman: patcon: that is because your fqdn is not defined :)
[2012-08-09 18:46:35 -0400] jtimberman: patcon: hostname -f should return the fqdn
[2012-08-09 18:47:02 -0400] jtimberman: patcon: 'fqdn' comes from hostname -f, 'hostname' and 'domain' from splitting the fqdn.
[2012-08-09 18:47:03 -0400] paigeat: and yeah I would think you could just do like node[:ipaddress] = whatevs
[2012-08-09 18:47:38 -0400] paigeat: Im not sure what variable it would be its like a top level element
[2012-08-09 18:47:56 -0400] paigeat: oh I see
[2012-08-09 18:48:06 -0400] paigeat: o.all_plugins & o['ipaddress']
[2012-08-09 18:48:13 -0400] patcon: bwaa... you are so right. oops. didn't realize. guess that's a new thing with rackspace 2nd-gen servers :) thanks jtimberman!
[2012-08-09 18:48:21 -0400] evilantnie: any reason why my knife bootstrap, with an explicit role list, built the box up correctly but submitted the node to the chef server with no roles and now it thinks it doesn't have a run-list
[2012-08-09 18:48:52 -0400] paigeat: jtimberman thanx! but I was asking about the chef hacking channel because I forgot what channel it is and I want to go there
[2012-08-09 18:49:39 -0400] evilantnie: first-boot.json has the right roles in it, but subsequent chef-client runs on that node now warn that there is  an empty run list
[2012-08-09 18:50:09 -0400] jtimberman: plugin: https://gist.github.com/1040543
[2012-08-09 18:50:26 -0400] jtimberman: patcon: oh, yeah. the rackspace thing gave me a sad.
[2012-08-09 18:50:47 -0400] jtimberman: evilantnie: did the first chef run complete successfully?
[2012-08-09 18:51:00 -0400] jtimberman: evilantnie: if it did not, the node was not saved to the chef server so it wouldn't have the run list
[2012-08-09 18:51:03 -0400] yfeldblum: jtimberman, why is that?
[2012-08-09 18:51:14 -0400] jtimberman: yfeldblum: that the node is not saved?
[2012-08-09 18:51:29 -0400] evilantnie: the bootstrap run ran fine, and the node shows up on the chef server but with no roles applied
[2012-08-09 18:52:45 -0400] yfeldblum: jtimberman, what's the rackspace thing?
[2012-08-09 18:53:38 -0400] jtimberman: yfeldblum: oh - i don't recall exactly. :)
[2012-08-09 18:55:05 -0400] evilantnie: I know I can probably fix this by applying the roles manually to the node from chef server, but I mostly want to know why the bootstrap didn't completely work
[2012-08-09 18:55:11 -0400] evilantnie: especially since there wasn't any errors
[2012-08-09 18:55:24 -0400] erratic: just to make sure I understand this right (from what I figured out this morning) you couldn't do knife rackspace server create bladabla --template-file bootstrap.template because --template-file is an option that gets passed to the knife bootstrap module?
[2012-08-09 18:57:14 -0400] erratic: or would that arguement --template-file get picked up because knife rackspace does this: https://github.com/opscode/knife-rackspace/blob/master/lib/chef/knife/rackspace_server_create.rb#L199
[2012-08-09 18:57:44 -0400] erratic: haven't tried yet Im just curious if you guys know by any cahnce
[2012-08-09 18:57:50 -0400] erratic: or have any opinions about it
[2012-08-09 19:28:05 -0400] syphon: This may be a stupid question, but is there a knife command to simply run the runlist on a node? Knife exec seems appropriate, but none of the examples show how to just kick off the runlist
[2012-08-09 19:30:28 -0400] jessicab: syphon: you could just use knife ssh to run chef-client on the node.. but its really all dependent on chef-client running again, something like 'knife ssh "name:NODENAME" "sudo chef-client" should work though  http://wiki.opscode.com/display/chef/Knife+Built+In+Subcommands#KnifeBuiltInSubcommands-SSH
[2012-08-09 19:31:02 -0400] syphon: ok thanks, that makes sense
[2012-08-09 19:47:22 -0400] ranjibd: erratic, it should pick up the template. ec2 plugin works similar
[2012-08-09 19:49:55 -0400] geekbri: ls
[2012-08-09 19:49:58 -0400] geekbri: gah
[2012-08-09 20:04:06 -0400] ssutch: using latest chef-solo - trying to install the opscode postgresql package - any idea why it can't install the client - it fails with undefined method `[]` for nil:NilClass
[2012-08-09 20:04:20 -0400] ssutch: it's trying to do node['postgresql']['client_packages'].each do ...
[2012-08-09 20:04:39 -0400] ssutch: and i'm guessing client_packages is nil - though it should be set in attributes/default.rb unless i'm mistaken
[2012-08-09 20:20:42 -0400] bram__: how can i run a bash script without chef-client eating up my memory?
[2012-08-09 20:21:18 -0400] mccleanm: I have run into some challenges in writing a cookbook for Nexus, the Sonatype Maven artifact repository
[2012-08-09 20:21:41 -0400] mccleanm: it is giving me the following error message "FATAL: ArgumentError: You must supply a name when declaring a default resource"
[2012-08-09 20:21:51 -0400] mccleanm: any ideas what could be the problem?
[2012-08-09 20:22:24 -0400] ranjibd: bradgignac, thers a bash resource
[2012-08-09 20:22:26 -0400] ranjibd: bash?
[2012-08-09 20:22:26 -0400] bawt_: bash is a script sub-resource that defaults to the bash interpreter.
[2012-08-09 20:22:36 -0400] barefoot: mccleanm: what does your block look like?
[2012-08-09 20:22:37 -0400] ranjibd: script?
[2012-08-09 20:22:37 -0400] bawt_: script is elegant for those "hacky strings of commands" =P
[2012-08-09 20:22:50 -0400] ranjibd: execute?
[2012-08-09 20:22:50 -0400] bawt_: execute is http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-08-09 20:23:23 -0400] geekbri: Avocado?
[2012-08-09 20:23:35 -0400] mccleanm: The recipe is the following https://gist.github.com/3307772
[2012-08-09 20:26:17 -0400] bram__: ranjibd: was that execute thing meant for me?
[2012-08-09 20:26:32 -0400] ranjibd: yeah..
[2012-08-09 20:26:44 -0400] ranjibd: sorry for the type..
[2012-08-09 20:26:50 -0400] bram__: well the problem is that chef-client uses up all my memory
[2012-08-09 20:26:55 -0400] ranjibd: bram__, u can use the bash resource directly
[2012-08-09 20:27:02 -0400] bram__: hmm
[2012-08-09 20:27:30 -0400] bram__: any example?
[2012-08-09 20:28:01 -0400] bram__: i need to run the directadmin installer from chef
[2012-08-09 20:28:19 -0400] ranjibd: script?
[2012-08-09 20:28:19 -0400] bawt_: script is elegant for those "hacky strings of commands" =P
[2012-08-09 20:28:29 -0400] ranjibd: script is http://wiki.opscode.com/display/chef/Resources#Resources-Script
[2012-08-09 20:28:31 -0400] ranjibd: script?
[2012-08-09 20:28:32 -0400] bawt_: script is elegant for those "hacky strings of commands" =P
[2012-08-09 20:28:41 -0400] ranjibd: script is also http://wiki.opscode.com/display/chef/Resources#Resources-Script
[2012-08-09 20:28:45 -0400] ranjibd: script?
[2012-08-09 20:28:45 -0400] bawt_: script is elegant for those "hacky strings of commands" =P or http://wiki.opscode.com/display/chef/Resources#Resources-Script
[2012-08-09 20:28:53 -0400] ranjibd: nice !
[2012-08-09 20:29:04 -0400] bram__: aha
[2012-08-09 20:29:06 -0400] bram__: lets try that
[2012-08-09 20:29:11 -0400] ranjibd: bram__, the script resource reference has some bash related examples
[2012-08-09 20:29:39 -0400] bram__: i noticed, thx alot :)
[2012-08-09 20:30:05 -0400] jforest: so... is there still no way to do a dry run?
[2012-08-09 20:30:17 -0400] ranjibd: whyrun?
[2012-08-09 20:30:27 -0400] jforest: why dry run?
[2012-08-09 20:30:55 -0400] jforest: because it's my newly moved to machine, that yes, wasn't built up with chef, but I would like to configure with chef going forward
[2012-08-09 20:31:00 -0400] _rc: the whyrun feature will be out with 10.14, that's probably what you want
[2012-08-09 20:31:08 -0400] jforest: ah
[2012-08-09 20:31:17 -0400] jforest: when is 10.14 gonna be out? ;)
[2012-08-09 20:31:32 -0400] ranjibd: whyrun is http://lists.opscode.com/sympa/arc/chef/2012-07/msg00025.html
[2012-08-09 20:31:35 -0400] ranjibd: whyrun?
[2012-08-09 20:31:35 -0400] bawt_: whyrun is http://lists.opscode.com/sympa/arc/chef/2012-07/msg00025.html
[2012-08-09 20:31:36 -0400] barefoot: mccleanm: seems okay, does "-l debug" help any?
[2012-08-09 20:32:34 -0400] jforest: it seems that whyrun is indeed what I will want
[2012-08-09 20:32:48 -0400] ranjibd: jforest, pre release is out
[2012-08-09 20:32:59 -0400] jforest: I see that
[2012-08-09 20:33:02 -0400] jforest: I can install it now!
[2012-08-09 20:33:07 -0400] ranjibd: yeah!
[2012-08-09 20:33:26 -0400] mccleanm: barefoot: am running Vagrant so will give it a try with debug
[2012-08-09 20:36:32 -0400] mccleanm: barefoot: ok have run it again with debug and added the log output to same gist https://gist.github.com/3307772
[2012-08-09 20:37:12 -0400] chefster: I'm clearly missing a basic Chef feature here I want to update a single attribute for a single node programmatically from a non-chef script. With knife I can update *all* the attributes using EDITOR, but can I use knife to update just *one* attribute at a time? I can't find any examples of this.
[2012-08-09 20:37:40 -0400] barefoot: mccleanm: so your previous post is the default file?
[2012-08-09 20:38:16 -0400] mccleanm: barefoot: yes there are two files
[2012-08-09 20:38:41 -0400] mccleanm: barefoot: one is the nexus chef recipe and the other is the debug log output from the last chef-solo run
[2012-08-09 20:39:15 -0400] barefoot: mccleanm: right, but is the recipe you posted nexus/recipes/default.rb?
[2012-08-09 20:39:38 -0400] mccleanm: barefoot: yes
[2012-08-09 20:42:50 -0400] bram__: ranjibd: looks like that methode is using less memory
[2012-08-09 20:42:52 -0400] bram__: thx!
[2012-08-09 20:45:22 -0400] barefoot: mccleanm: /shrugs, seems good, if the debug output is the order things are happening in then I would start with commenting out the include_recipe java and try to run it again, otherwise if you have written a provider or something that you are using you might double check it
[2012-08-09 20:47:08 -0400] mccleanm: barefoot: ok will try it without the java recipe
[2012-08-09 20:49:49 -0400] bahman2000: why doesn't my execute resource timeout http://pastie.org/4445790
[2012-08-09 20:50:28 -0400] jforest: indeed, whyrun was what I needed
[2012-08-09 20:53:09 -0400] mccleanm: unfortunately I get the same error message
[2012-08-09 20:53:25 -0400] jforest: thank you!
[2012-08-09 20:53:46 -0400] mccleanm: seems to have a problem on line 26 as the error message is "/tmp/vagrant-chef-1/chef-solo-1/cookbooks/nexus/recipes/default.rb:26:in `from_f ile'"
[2012-08-09 20:55:50 -0400] betahost: Hey BTM
[2012-08-09 20:55:57 -0400] betahost: Quick Question
[2012-08-09 20:57:13 -0400] betahost: @btm I've bootstrapped a node with Ubuntu 11.04 a few months ago and bootstraped a new node running Ubuntu 11.04 but the location of chef is different and the version of RubyGems is different
[2012-08-09 20:57:40 -0400] betahost: I've bootstrapped them the same way using knife ec2
[2012-08-09 20:57:59 -0400] mattray: betahost: the default changed from 0.10.8 to 10.12
[2012-08-09 20:58:19 -0400] chrisr244: is there a way to update databag values without the use of a text editor (ie. for automagic processes?)
[2012-08-09 20:58:27 -0400] mattray: betahost: 0.10.8 was gems, 10.12 was chef-full installed to /opt/chef
[2012-08-09 20:58:33 -0400] betahost: Ok, now my chef_handler cookbook breaks cause Gem.load_all_paths does not exist anymore
[2012-08-09 20:58:37 -0400] chrisr244: automatic, not automagic. same thing I guess ;)
[2012-08-09 20:59:22 -0400] betahost: ATAL: NoMethodError: undefined method `add' for "/opt/chef/embedded/lib/ruby/gems/1.9.1":String
[2012-08-09 21:00:08 -0400] mattray: betahost: not sure what the solution is, btm? jtimberman?
[2012-08-09 21:06:58 -0400] betahost: This is now broken with the last chef-full bootstrap method:
[2012-08-09 21:06:59 -0400] betahost: chef_handler "SimpleReport::UpdatedResources" do
[2012-08-09 21:06:59 -0400] betahost:   source "#{File.join(Gem.all_load_paths.grep(/chef-handler-updated-resources/).first,'chef', 'handler', 'updated_resources.rb')}"
[2012-08-09 21:07:00 -0400] betahost:   action :enable
[2012-08-09 21:07:00 -0400] betahost: end
[2012-08-09 21:07:45 -0400] betahost: The method Gem.all_load_paths no longer exists in RubyGems 0.8.23 which gets installed via knife bootstrap
[2012-08-09 21:08:11 -0400] betahost: Anyone found a work-around?
[2012-08-09 21:08:35 -0400] Urocyon: I want to find the location of the chef-server-api on a given chef-server install (I'm writing a little code to wrap it under apache)  but I'm not finding a good attribute for it.  About the closes I can find is chef_packages.chef.chef_root.   Am I missing anything?
[2012-08-09 21:14:18 -0400] bahman2000: please help, i can't get this to timeout http://pastie.org/4445902
[2012-08-09 21:39:08 -0400] ctracey: mattray: first cut at supporting isc-dhcp-server: https://github.com/craigtracey/dhcp
[2012-08-09 21:44:39 -0400] mattray: cool, you did that with japage?
[2012-08-09 21:46:16 -0400] ctracey: mattray: we spoke about it, but mine was much different than his
[2012-08-09 21:47:55 -0400] ctracey: mattray: this does have a number of limitations though. perhaps good for a first-cut.
[2012-08-09 21:48:10 -0400] mattray: are you two planning on syncing up at some point, or will there be conflicting pull requests?
[2012-08-09 21:48:39 -0400] ctracey: i may pick at his, but his is not backwards compat
[2012-08-09 21:50:19 -0400] mattray: ok, I guess I'll see how things work on my setup, then try to make everyone happy later :)
[2012-08-09 21:55:23 -0400] ctracey: mattray: unless you have taken another pull from him today, I have based it on what I found after we spoke
[2012-08-09 21:56:04 -0400] mattray: his latest comment was "I want to get ctracey's changes added in here as well, and make sure its working a little better before getting you to pull this."
[2012-08-09 21:56:51 -0400] mattray: like I told him earlier, back-compat isn't a big deal since I haven't pushed this cookbook anywhere other than github
[2012-08-09 21:57:16 -0400] mattray: so as long as you two are happy :)
[2012-08-09 22:15:16 -0400] erratic: anyone experienced this? https://gist.github.com/188b9e7de3de95fc81ac
[2012-08-09 22:15:27 -0400] erratic: it seems to happen randomly for me
[2012-08-09 22:18:59 -0400] bradgignac: erratic: haven't seen it in a while, but i think i used to see when i provisioned a server for the first time
[2012-08-09 22:19:05 -0400] bradgignac: with the percona recipe
[2012-08-09 22:19:08 -0400] erratic: yep
[2012-08-09 22:19:13 -0400] erratic: yes
[2012-08-09 22:19:15 -0400] erratic: exactly
[2012-08-09 22:19:17 -0400] bradgignac: there was a pull request on the cookbook
[2012-08-09 22:19:19 -0400] erratic: wth! lol
[2012-08-09 22:19:26 -0400] erratic: cool I'll check too
[2012-08-09 22:20:05 -0400] bradgignac: https://github.com/customink-webops/percona-install/pull/3
[2012-08-09 22:20:46 -0400] erratic: very nice
[2012-08-09 22:21:07 -0400] erratic: although
[2012-08-09 22:21:26 -0400] bradgignac: i don't think thats the cookbook you're using, but the same issue would apply
[2012-08-09 22:21:40 -0400] erratic: yeah I use percona not percona instll
[2012-08-09 22:21:41 -0400] erratic: but
[2012-08-09 22:21:45 -0400] erratic: I'll bet its the same problem
[2012-08-09 22:21:57 -0400] erratic: can be fixed easily if it is
[2012-08-09 22:24:35 -0400] erratic: hmmmm
[2012-08-09 22:25:06 -0400] erratic: mines done using the apt lwrp
[2012-08-09 22:25:13 -0400] erratic: apt_repository
[2012-08-09 22:36:50 -0400] rayrod2030: hey are you guys keeping your .chef files in source control?  Stuff like the chef checksums?
[2012-08-09 22:54:05 -0400] erratic: like I can do this:  knife search node "name:*" -a idletime
[2012-08-09 22:54:16 -0400] erratic: which is like a node in the top level of attributes?
[2012-08-09 22:54:25 -0400] erratic: but I cant figure out how to get nested attributes with that
[2012-08-09 22:54:28 -0400] erratic: any help?
[2012-08-09 22:54:28 -0400] bawt_: any help is more than welcome :)
[2012-08-09 22:54:35 -0400] erratic: thanks bawtlet
[2012-08-09 22:57:33 -0400] erratic: but then I would also only want the addresses that are inet family addresses
[2012-08-09 22:57:38 -0400] erratic: this seems hopeless
[2012-08-09 22:58:11 -0400] erratic: but I mean come on seriously ... ohai defaults to eth0 and you have no choice unless you write a plugin?
[2012-08-09 22:58:21 -0400] erratic: dafuq
[2012-08-09 23:01:50 -0400] erratic: it really wouldn't be that big of a deal if I could do a knife search that would enumerate the address that I need to knife ssh to :)
[2012-08-09 23:05:27 -0400] erratic: anyhow I think someone should fix that shit, or at least know that out of the 3 or so other workarounds I came up with none of them are acceptable
[2012-08-09 23:10:15 -0400] stormerider: erratic: you probably should file a ticket rather than asking them to fix it on irc and not forget.
[2012-08-09 23:10:34 -0400] erratic: stormerider I'll do that
[2012-08-09 23:10:51 -0400] erratic: I wanted to get a second opinion of whether or not it was worth while first
[2012-08-09 23:11:54 -0400] stormerider: im just using this in AWS so i dont have the config to check what you're running into, but it sounds like a somewhat nonstandard config. but with a ticket they can either schedule it to be fixed or point you to a solution. :)
[2012-08-09 23:14:53 -0400] erratic: I mean its something I could easily get around if... 1. I setup all of my vm's to force the nic that vagrant uses to be on eth15 by its statically defined mac address... in /etc/udev/rules.d/70-persistent-net.rules or 2. write an ohai plugin (no way am I doing that) to do basically the same search with map/select in ruby to get the IP and set it in the attributes
[2012-08-09 23:15:12 -0400] erratic: neither of those two options really seem reasonable to me
[2012-08-09 23:16:08 -0400] erratic: and I feel like knife search -a <attribute> ought to support multi-dimensional attributes and not just the topmost kv pairs
[2012-08-09 23:16:50 -0400] erratic: I can understand it not having some kind of filter/select for -a
[2012-08-09 23:17:11 -0400] erratic: since thats already being done... kinda  node "name:*"
[2012-08-09 23:22:25 -0400] erratic: god damn it
[2012-08-09 23:22:30 -0400] erratic: I missed an appointment
[2012-08-09 23:22:31 -0400] erratic: ugh
[2012-08-09 23:23:21 -0400] erratic: I forgot...
[2012-08-09 23:24:06 -0400] erratic: it was kind of a last minute appointment that I setup this morning, totally forgot :(
[2012-08-09 23:57:49 -0400] littleidea: has anyone looked at integrating chef with razor?
