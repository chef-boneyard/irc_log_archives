[2012-08-18 00:00:21 -0400] cheeseplus: pedahzur: yea, I think it could be worded better - IF already not mounted, then enable needs to happen"
[2012-08-18 00:01:15 -0400] cheeseplus: pedahzur: actually my statement made no sense, please ignore
[2012-08-18 00:01:19 -0400] pedahzur: heh
[2012-08-18 00:01:52 -0400] cheeseplus: as a general use case it makes sense to recommend running mount before enable
[2012-08-18 00:08:56 -0400] hoover_damm: mount "enable" add's it to fstab
[2012-08-18 00:09:05 -0400] hoover_damm: i'm sure someone can bikeshed on that hard
[2012-08-18 00:13:40 -0400] pedahzur: hoover_damm: Probably, I just wondered why the docs said you had to mount: before enable:  As my experience proved, sometimes you need to add to the /etc/fstab, even when you can't mount it at that point.
[2012-08-18 00:21:31 -0400] hoover_damm: pedahzur, in 0.6 you had to chain a mount, and then an enable
[2012-08-18 00:21:37 -0400] hoover_damm: pedahzur, likely this is an artifact of chef 0.6
[2012-08-18 00:23:03 -0400] cloudpokerdb: maybe someone can point me in the right direction, i'm trying to automate the process of building servers for my website.  I want to start a server in my rackspace cloud when the previous one is full.  Would I be better off just working with the rackspace API directly on my site to do that, or would chef be better suited?
[2012-08-18 00:37:07 -0400] justin-: Is it possible to "queue" a system command to be run with a recipe?
[2012-08-18 00:37:58 -0400] justin-: e.g. r = `su - someuser -c "whoami"`
[2012-08-18 00:39:23 -0400] justin-: I want that to be executed after chef creates 'someuser'. However, when using Kernel#` in my recipe, it gets run before the user is created. How would I "enqueue" the command to be run with the recipe?
[2012-08-18 00:44:06 -0400] stuartrexking: Does opscode produce a cookbook for managing rvms?
[2012-08-18 00:45:46 -0400] pedahzur: cloudpokerdb: I would use the Rackspace API to start up the server, then invoke your chef script on the server to configure it the way you want.
[2012-08-18 00:47:23 -0400] stuartrexking: What is the recommended way of managing rvms within a chef managed environment?
[2012-08-18 00:47:53 -0400] hoover_damm: stuartrexking, there are many rvm cookbooks and several good ones on the community site
[2012-08-18 00:48:04 -0400] hoover_damm: opscode does not produce a cookbook themselves I believe
[2012-08-18 00:48:51 -0400] stuartrexking: hoover_damm: Thanks.
[2012-08-18 00:49:03 -0400] stuartrexking: fnichol has a pretty complete one.
[2012-08-18 00:49:11 -0400] hoover_damm: it's the most complete
[2012-08-18 00:49:20 -0400] hoover_damm: but avoiding RVM is always the best practice :)
[2012-08-18 00:49:34 -0400] stuartrexking: Really? What is the alternative?
[2012-08-18 00:49:35 -0400] hoover_damm: hard to do sometimes
[2012-08-18 00:49:58 -0400] stuartrexking: How do you isolate a ruby environment for a particular service?
[2012-08-18 00:50:07 -0400] hoover_damm: some people avoid rbenv and just do ruby-build
[2012-08-18 00:50:19 -0400] hoover_damm: just build ruby and prefix it for that service
[2012-08-18 00:50:36 -0400] stuartrexking: Ok, prefix to the PATH?
[2012-08-18 00:50:40 -0400] hoover_damm: stuartrexking, I imagine you have the need for multiple rubies?
[2012-08-18 00:50:44 -0400] hoover_damm: concurrently?
[2012-08-18 00:50:59 -0400] hoover_damm: difficult pattern to solve really without rbenv or rvm
[2012-08-18 00:51:12 -0400] stuartrexking: Possibly. I want to be able to isolate a ruby env like I can a python one (with virtualenv)
[2012-08-18 00:51:23 -0400] stuartrexking: rvm seems like the logical choice.
[2012-08-18 00:51:25 -0400] kyleb: could check out omnibus, thats how opscode packs up ruby and other deps for chef now
[2012-08-18 00:51:33 -0400] hoover_damm: virtualenv is beautiful
[2012-08-18 00:51:34 -0400] hoover_damm: clean
[2012-08-18 00:51:35 -0400] hoover_damm: fluid
[2012-08-18 00:51:37 -0400] hoover_damm: works everywhere
[2012-08-18 00:51:39 -0400] stuartrexking: Yes.
[2012-08-18 00:51:49 -0400] hoover_damm: requires very little sadomasochist tendancies
[2012-08-18 00:51:53 -0400] stuartrexking: RVM seems like the closest thing for ruby.
[2012-08-18 00:51:58 -0400] hoover_damm: can't say the same for RVM
[2012-08-18 00:52:04 -0400] stuartrexking: But I am open to any other suggestions.
[2012-08-18 00:52:12 -0400] stuartrexking: If anyone has any.
[2012-08-18 00:52:20 -0400] hoover_damm: there is no real other suggestion out of ruby-build/rvm/rbenv... building it yourself
[2012-08-18 00:52:22 -0400] stuartrexking: I like the idea of building ruby and deps.
[2012-08-18 00:52:31 -0400] stuartrexking: Ok. Will have a look at that.
[2012-08-18 00:52:32 -0400] stuartrexking: Thanks.
[2012-08-18 00:52:35 -0400] hoover_damm: a lot of people have adopted the omnibus style
[2012-08-18 00:52:45 -0400] hoover_damm: Sensu does this
[2012-08-18 00:52:56 -0400] hoover_damm: so you can have ruby just tied up beautifully just for sensu, install a deb
[2012-08-18 00:52:59 -0400] hoover_damm: it includes everything
[2012-08-18 00:53:00 -0400] hoover_damm: win
[2012-08-18 00:53:16 -0400] hoover_damm: stuartrexking, https://github.com/opscode/omnibus-software
[2012-08-18 00:53:53 -0400] hoover_damm: stuartrexking, sensu actually uses https://github.com/joemiller/bunchr to do it
[2012-08-18 00:54:32 -0400] stuartrexking: Great. Thanks again.
[2012-08-18 00:54:51 -0400] hoover_damm: actually bunchr looks like the easiest way out of this
[2012-08-18 00:55:10 -0400] pedahzur: We use bundler to achieve a certain level of isolation...but that might not be enough for you. Sounds like you want your own ruby binary, etc.
[2012-08-18 00:58:46 -0400] hoover_damm: Bundler is a bit more basic.
[2012-08-18 01:00:24 -0400] pedahzur: hoover_damm: Yeah, figured as much.
[2012-08-18 01:00:40 -0400] hoover_damm: pedahzur, take a look at bunchr and :)
[2012-08-18 01:00:48 -0400] hoover_damm: it solves a common problem
[2012-08-18 01:01:08 -0400] pedahzur: hoover_damm: Well, I don't use it directly, our devs do. So the pain level doesn't affect me. :)
[2012-08-18 01:04:24 -0400] cloudpokerdb: pedahzur: thanks, that's what I figured.
[2012-08-18 01:05:25 -0400] erikh: I've been trying to poke the rubygems team into implementing a jar-style container
[2012-08-18 01:05:29 -0400] erikh: it'd solve a lot of these problems.
[2012-08-18 01:07:35 -0400] jtgiri_: hey guys , I am having issues with deploy resource : I am using latest chef-client http://pastebin.com/vSgQfPcn , I am deploying the code to deploy_revision "/var/www/#{node['vhosts']['name']}" do and it's actually creating two directories under /var/www ["sitter.strsocial.com"]  and sitter.strsocial.com
[2012-08-18 01:07:39 -0400] jtgiri_: Is this a bug ?
[2012-08-18 01:08:43 -0400] d2kagw: Hi Chefs. I have a license file for an app we need installed on our servers. Originally I was just going to put the license string into a secure data bag, but it turns out the license is actually a binary file not a key in a file. What's the best practice in dealing with this in Chef?
[2012-08-18 01:10:51 -0400] erikh: ha, that's a good one. I'd probably include it in the files section of the cookbook and decrypt it manually as a part of the recipe
[2012-08-18 01:11:08 -0400] erikh: you're going to run into issues stuffing it into a databag if it's binary because JSON is utf8 only
[2012-08-18 01:12:50 -0400] d2kagw: yeah - can't data bag it. Shame about having to put it in the files section. I'm hoping to share this cookbook with the community so expecting license files in the cookbook isn't the strongest idea
[2012-08-18 01:14:58 -0400] erikh: yeah. I don't really know what to tell you there, other than making a private cookbook that's referenced
[2012-08-18 01:15:26 -0400] erk: python cookbook by default uses package, what does it mean? not  pip ?
[2012-08-18 01:15:43 -0400] erikh: erk: package is a standard chef resource
[2012-08-18 01:15:49 -0400] d2kagw: thanks anyway erikh
[2012-08-18 01:16:02 -0400] erikh: http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-08-18 01:16:20 -0400] erikh: d2kagw: np. tell me what you ended up doing, if you don't mind. I'm curious.
[2012-08-18 01:16:25 -0400] cwj: cant you serialize the binary object (e.g. with Marshall) and store it in a data bag?
[2012-08-18 01:16:56 -0400] erikh: I don't think Marshal dumps utf-8 compliant results
[2012-08-18 01:17:00 -0400] erk: erikh: i see it has apt and easy_install, so by default it will first look at apt-get install and then easy_install and then pip?
[2012-08-18 01:17:17 -0400] erk: erikh: unless i specify the action to use python_pip ?
[2012-08-18 01:17:27 -0400] erikh: I don't really know the python cookbook, sorry
[2012-08-18 01:17:36 -0400] erk: erikh: oh okay its cool
[2012-08-18 01:17:44 -0400] erk: erikh: thanks!
[2012-08-18 01:17:48 -0400] erikh: yep. hth
[2012-08-18 01:18:09 -0400] d2kagw: cwj & erikh: googling `converting binary to string and back` :P
[2012-08-18 01:18:33 -0400] erikh: oh! derp
[2012-08-18 01:18:35 -0400] erikh: base64 it.
[2012-08-18 01:20:12 -0400] d2kagw: erikh: giving it a go
[2012-08-18 01:20:13 -0400] erikh: require 'base64'; require 'chef'; Chef::Config.from_file('mychef_config.rb'); c = Chef::DataBagItem.load('keys', 'license'); c['data'] = Base64.encode64(File.binread('path/to/license.key')); c.save
[2012-08-18 01:20:39 -0400] erikh: adjust for your various environment settings.
[2012-08-18 01:21:00 -0400] erikh: that'll save it, then you can just do decode64 in your cookbook from data_bag_item
[2012-08-18 01:22:33 -0400] d2kagw: erikh: what's the mychef_config in relation to?
[2012-08-18 01:22:45 -0400] erikh: your knife configuration
[2012-08-18 01:22:50 -0400] d2kagw: aah, k.
[2012-08-18 01:23:04 -0400] erikh: it'd make a good knife plugin if you want to go that far.
[2012-08-18 01:24:11 -0400] d2kagw: indeed it would - as far as you know is there an existing knife utils plugin that this would fit nicely into?
[2012-08-18 01:24:21 -0400] d2kagw: or would you suggest this be a standalone?
[2012-08-18 01:24:24 -0400] erikh: now, hm. to do an encrypted databag upload you might have to adjust that some
[2012-08-18 01:24:48 -0400] erikh: yeah, there are a lot of them out there
[2012-08-18 01:24:57 -0400] erikh: I prefer lots of little tools instead of suites
[2012-08-18 01:25:02 -0400] erikh: so go with what feels right
[2012-08-18 01:25:24 -0400] erikh: I'm not 100% on what the encrypted version of that is
[2012-08-18 01:25:35 -0400] erikh: but I'm sure that'll do what you want aside from that.
[2012-08-18 01:25:50 -0400] d2kagw: I'lll be sure to let you know how I get on
[2012-08-18 01:26:11 -0400] erikh: yeah, timing's kind of bad for me but if you put it out there I could probably chip at it
[2012-08-18 01:26:15 -0400] erikh: in a week or so
[2012-08-18 01:38:34 -0400] jtimberman: stuartrexking: i've heard good things about fnichol's rvm cookbook.
[2012-08-18 01:39:04 -0400] stuartrexking: jtimberman: Thanks
[2012-08-18 01:39:33 -0400] stuartrexking: jtimberman: It looks like it has pretty much everything I need.
[2012-08-18 01:40:29 -0400] stuartrexking: jtimberman: Can I ask where you sit on managing independent ruby environments?
[2012-08-18 01:41:02 -0400] jtimberman: stuartrexking: I prefer to build a package for the Ruby version I need for my application.
[2012-08-18 01:41:11 -0400] jtimberman: stuartrexking: because I'm impatient and i don't want to wait for ruby to compile :)
[2012-08-18 01:41:20 -0400] stuartrexking: I have not had any problems with RVM, but it seems to get plenty of complaints.
[2012-08-18 01:41:41 -0400] jtimberman: if i need to do multiple ruby versions, rvm is fine, and i build it into the image/vm that i'm going to deploy
[2012-08-18 01:42:07 -0400] jtimberman: most of the complaints i'm sure are from people who either a) don't really like ruby to begin with, or b) don't really understand what rvm is doing or how to use it.
[2012-08-18 01:42:10 -0400] jtimberman: :)
[2012-08-18 01:42:31 -0400] stuartrexking: jtimberman: Ok, thanks.
[2012-08-18 01:51:23 -0400] hoover_damm: jtimberman, I must be the odd duck.  I know how to use RVM, in great detail.  Would prefer other options
[2012-08-18 01:51:44 -0400] hoover_damm: happens to me too often
[2012-08-18 01:57:31 -0400] hoover_damm: jtimberman, I guess when I started asking Wayne how to do it in monit and .. god and I got cute looks :) I realized there was more to the story then understood
[2012-08-18 01:57:45 -0400] hoover_damm: virtualenv is still heaps easier to support
[2012-08-18 01:57:57 -0400] hoover_damm: wish ruby was that easy
[2012-08-18 02:13:51 -0400] hoover_damm: intention wise
[2012-08-18 02:13:56 -0400] hoover_damm: wayne needs to rewrite it
[2012-08-18 03:03:44 -0400] jtimberman: Made a 0.5.2 test-kitchen release, updates foodcritic to current version, and removes the private git repo removal thing :)
[2012-08-18 03:43:25 -0400] lusis: riddle me this
[2012-08-18 03:43:39 -0400] lusis: I thought if there was already a node registered with a name at bootstrap
[2012-08-18 03:43:44 -0400] lusis: the bootstrap would fail immediately
[2012-08-18 03:44:14 -0400] hoover_damm: nah
[2012-08-18 03:44:52 -0400] lusis: so the node records and client records will just step on each other
[2012-08-18 03:45:24 -0400] hoover_damm: jtimberman, interesting
[2012-08-18 03:45:30 -0400] hoover_damm: lusis, not client
[2012-08-18 03:45:31 -0400] hoover_damm: node
[2012-08-18 03:53:01 -0400] lusis: hrmmm
[2012-08-18 03:54:19 -0400] hoover_damm: the validator key isn't an admin, it shouldn't be able to overwrite existing clients
[2012-08-18 03:54:23 -0400] hoover_damm: the nodes ... is annoying
[2012-08-18 03:55:29 -0400] lusis: er
[2012-08-18 04:13:13 -0400] lusis: huh
[2012-08-18 04:13:18 -0400] lusis: okay so there's that
[2012-08-18 04:24:16 -0400] lusis: luckily validator has the perms I need
[2012-08-18 04:24:17 -0400] lusis: so
[2012-08-18 04:43:46 -0400] lusis: maybe not
[2012-08-18 04:45:36 -0400] hoover_damm: nah it's a dumb client
[2012-08-18 04:45:41 -0400] hoover_damm: shouldn't be able to modify anything
[2012-08-18 04:45:48 -0400] hoover_damm: it can register the client, and the node auto creates
[2012-08-18 04:46:24 -0400] lusis: right but it can list cookbooks/roles/environments
[2012-08-18 04:46:38 -0400] lusis: except in OHC it seems
[2012-08-18 04:46:41 -0400] lusis: maybe not
[2012-08-18 05:04:31 -0400] miah: hi
[2012-08-18 07:00:22 -0400] tarnfeld: Hey, when I set an attribute to nil (or empty string) in default_attributes() it seems to not get picked up, the attributes of the recipe takes precedence. Any ideas?
[2012-08-18 07:11:01 -0400] d2kagw: Hi all. I'm using an Encrypted Data Bag and am getting this error on the node when running the cookbook that employs it: "OpenSSL::Cipher::CipherError: wrong final block length". It seems i'm not the only person who's come across the problem but nobody seems to have posted the fix. Any ideas?
[2012-08-18 08:52:56 -0400] forestbird: how would I check for the return value of a command and then based on that do multiple things with case statements etc?
[2012-08-18 08:53:31 -0400] forestbird: i.e. instead of repeating "not_if" 10.times I would do it once and use the variable from then on
[2012-08-18 08:59:17 -0400] forestbird: but i'm not sure how to pass it on to another "non-resource" like "case" that depends on node variables
[2012-08-18 10:04:06 -0400] cjblomqvist: How do you install a knife plugin into a chef-repo? I understand where knife plugin files should be put, but will that ensure all the proper dependencies and such gets installed? (I'd guess it doesn't?)
[2012-08-18 14:00:47 -0400] masterkorp: CHEF ROCKS
[2012-08-18 14:00:59 -0400] masterkorp: (just needs more documentation)
[2012-08-18 14:11:50 -0400] Urocyon: masterkorp: where would you like to start with more documentation?
[2012-08-18 14:15:34 -0400] masterkorp: I am not at that point of knowlege about chef yet
[2012-08-18 14:15:42 -0400] masterkorp: But i would like to get a book
[2012-08-18 14:16:08 -0400] masterkorp: where it teaches the concepts, and introduces chef in the right way
[2012-08-18 14:16:44 -0400] masterkorp: I would have made my learning curve way easier
[2012-08-18 14:16:59 -0400] Urocyon: I've been wishing I had a book with some best practices.  I'm not sure what those are just yet, I think there isn't a consensus on what they are yet, but I've managed to learn about a few gotchas.
[2012-08-18 14:17:28 -0400] masterkorp: Yes, that also the problem
[2012-08-18 14:17:36 -0400] masterkorp: we're breaking new ground here
[2012-08-18 14:18:30 -0400] Urocyon: masterkorp: yeah, seems the introductions kind of dump you at the point you have a functional workstation and a cookbook that does nothing, and while you can run stuff, it isn't exactly clear where to proceed from there.
[2012-08-18 14:18:57 -0400] masterkorp: Yeah i was so lost there
[2012-08-18 14:19:04 -0400] masterkorp: "And now what?"
[2012-08-18 14:19:14 -0400] Urocyon: It's like they teach you how to get on the ski lift and get to the top of the mountain, but then you are left with a choice of slopes going from scary to terrifying and not knowing what to do from there.
[2012-08-18 14:19:21 -0400] masterkorp: "where do i go to learn how to X"
[2012-08-18 14:19:37 -0400] Urocyon: what would an X be though?
[2012-08-18 14:19:37 -0400] masterkorp: but well i managed
[2012-08-18 14:20:04 -0400] Urocyon: masterkorp: well the good thing is, from the top of the mountain it's all down hill.  You'll get to the bottom one way or another.
[2012-08-18 14:20:09 -0400] masterkorp: There is that book test driven developemnt with chef
[2012-08-18 14:20:14 -0400] countdigi: im by far still learning but the one thing that helped was to download the whole wiki as a pdf to go through it
[2012-08-18 14:20:17 -0400] masterkorp: i read it
[2012-08-18 14:20:42 -0400] masterkorp: countdigi: i want to convert it to my kindle
[2012-08-18 14:20:48 -0400] masterkorp: so i can read on the beach
[2012-08-18 14:21:02 -0400] Urocyon: it wasn't bad, but since I wasn't using hosted chef, it wasn't as useful to me.  I don't think the author ever updated his code to work with chef-server.
[2012-08-18 14:21:06 -0400] countdigi: the book will be coming out in Feb http://shop.oreilly.com/product/0636920025146.do
[2012-08-18 14:22:07 -0400] masterkorp: nice
[2012-08-18 14:22:16 -0400] masterkorp: o'relly books never disapoint
[2012-08-18 14:22:25 -0400] Urocyon: now I'm digging into Berkshelf, which is really changing my thinking about how to do things in chef.
[2012-08-18 14:22:45 -0400] countdigi: Urocyon: lol - im chkin it out after talkin to u yesterday too
[2012-08-18 14:23:43 -0400] Urocyon: I think I could have used a short primer on software development for Operations guys.  Maybe those with a good bash knowledge, a smattering of perl, and may or may not have done much with repositories other than check ins and check outs.
[2012-08-18 14:25:00 -0400] countdigi: yep - typically sas don't have to deal w/ that much - for some reason i always dug vcs so i read books on CVS, Subversion and played w/ it  years ago - made picking up git pretty easy
[2012-08-18 14:25:00 -0400] Urocyon: I wouldn't want it to deep there, but something to at least get me oriented with the notion that Infrastructure as Code means you are going to be coding, and you might as well do it right.
[2012-08-18 14:26:00 -0400] countdigi: its funny cause i know some sas that are a little script-phobic - i could only imagine them wrapping there head around iac :-)
[2012-08-18 14:27:02 -0400] Urocyon: So, I'm actually an O'Reilly author and this could be a cool project for me.  Probably wouldn't make me any money, but would be cool to research and write.
[2012-08-18 14:27:22 -0400] Urocyon: I wonder if anyone is already working on it though.
[2012-08-18 14:31:06 -0400] Urocyon: Just wrote my editor to ask.
[2012-08-18 14:31:25 -0400] countdigi: do u write books or articles for oreilly?
[2012-08-18 14:31:40 -0400] lflux: A chef book would be pretty cool, I know the sysadmins at work would like
[2012-08-18 14:32:02 -0400] lflux: I gave them a first runthrough of what chef is and what it can do. Took them a while to stop laughing at the tool names
[2012-08-18 14:32:09 -0400] Urocyon: I've done both.  I used to write a regular column on Python.  Sort of a beefy blog thing on what interesting things people were doing with Python.
[2012-08-18 14:32:22 -0400] Urocyon: I'm also a coauthor of Linux in a Nutshell.
[2012-08-18 14:35:36 -0400] countdigi: cool - that has come a long way since the old referee unix sysv in a nutshell
[2012-08-18 14:36:14 -0400] Urocyon: It has and it's about due for a update.
[2012-08-18 14:36:26 -0400] countdigi: does it cover git currently?
[2012-08-18 14:37:21 -0400] Urocyon: hmmm another possibility might be an Operations in a Nutshell book with section covering some basic IAC principles, and some quick references for puppet and chef.....
[2012-08-18 14:37:37 -0400] countdigi: yep - i could see that as a hit
[2012-08-18 14:38:03 -0400] Urocyon: Could also rip the package management out of LiaN for use in it.  Add a section of FPM and setting up repositories...
[2012-08-18 14:39:08 -0400] Urocyon: And something on logs maybe add in logstash.
[2012-08-18 14:39:20 -0400] Urocyon: Oh and monitoring, can't forget monitoring.
[2012-08-18 14:39:27 -0400] Urocyon: DevOps in a nutshell?
[2012-08-18 14:40:23 -0400] Urocyon: Though devops isn't really about tools, it's about culture, but there are definitely tools that mindset calls for using.
[2012-08-18 14:43:36 -0400] tjadmin_: What's IAC? LMGTFY failed me.
[2012-08-18 14:43:50 -0400] countdigi: Infrastructure-as-Code
[2012-08-18 14:43:57 -0400] tjadmin_: OOOOOOOwwww
[2012-08-18 14:44:03 -0400] tjadmin_: silly me.
[2012-08-18 14:47:20 -0400] freerobby: I just launched a new node via knife, had some failures during the run, re-added the roles to the run list and re-ran chef-client, but the node has all blank attributes. any thoughts?
[2012-08-18 15:09:21 -0400] Urocyon: So my editor at O'Reilly says there is a Chef the Definitive guide in the works.  I just asked him about a Nutshell, but haven't heard back yet.
[2012-08-18 15:26:12 -0400] jtimberman: Urocyon: Yes! Stephen Nelson-Smith is working on the Definitive Guide. He's brilliant.
[2012-08-18 15:38:35 -0400] Urocyon: yeah, don't think I could compete with LordCope
[2012-08-18 15:38:58 -0400] Urocyon: I might get to tech review it though.  Which would be cool.
[2012-08-18 15:53:05 -0400] jtimberman: :D
[2012-08-18 15:56:37 -0400] ssd7: Ohai Chefs.
[2012-08-18 16:06:32 -0400] jtimberman: ssd7: ohai!
[2012-08-18 16:29:33 -0400] lflux: jtimberman: I suppose you have no info on when it might be out?
[2012-08-18 16:34:30 -0400] countdigi: oreilly site says estimate feb 2013
[2012-08-18 16:43:11 -0400] lflux: sweet
[2012-08-18 16:43:31 -0400] countdigi: here is the link: http://shop.oreilly.com/product/0636920025146.do
[2012-08-18 16:57:54 -0400] ssd7: bundler is such a troll
[2012-08-18 16:58:27 -0400] ssd7: "The executables installed into bin are scoped to the bundle and will always work" lol
[2012-08-18 16:58:47 -0400] yfeldblum: ssd7, is that not so?
[2012-08-18 16:59:06 -0400] ssd7: not at the moment
[2012-08-18 17:00:25 -0400] yfeldblum: ssd7, how so?
[2012-08-18 17:00:58 -0400] ssd7: Well, I'm trying to install the bundle to an alternate path and get binstubs
[2012-08-18 17:01:20 -0400] ssd7: but then when I do that, required gems can't be found
[2012-08-18 17:08:51 -0400] countdigi: ssd7 u might want to checkout rvm
[2012-08-18 17:09:27 -0400] countdigi: u don't need binstubs if u use a current rvm/bundler
[2012-08-18 17:10:08 -0400] yfeldblum: countdigi, how would that help? you could still need binstubs (and i have just such a use-case where that would be a good alternative among the various alternatives)
[2012-08-18 17:10:31 -0400] countdigi: see: http://blog.davidchelimsky.net/2011/07/18/stop-typing-bundle-exec/
[2012-08-18 17:10:57 -0400] ssd7: countdigi: Heh, so I started the morning with the thought, "it would be nice to not have to install rvm for this"
[2012-08-18 17:12:04 -0400] ssd7: Oh well
[2012-08-18 17:12:35 -0400] yfeldblum: countdigi, that's nonsense; you can also do `export RUBYOPT='-rbundler/setup'`, or you can bundle a subshell with `bundle exec bash`
[2012-08-18 17:13:14 -0400] yfeldblum: countdigi, i believe heroku uses binstubs but prefixes the full path to the binstubs directory (not the relative path)
[2012-08-18 17:14:41 -0400] yfeldblum: countdigi, heroku replaces the need for RVM with deploying apps into LXCs
[2012-08-18 17:15:20 -0400] countdigi: gotcha - i like the subshell example
[2012-08-18 17:16:16 -0400] countdigi: but if my path picks up the wrong program will RUBYOPT="-rbundler/setup' fix that? i can see it getting everything else right - just curious
[2012-08-18 17:26:26 -0400] jtimberman: ssd7: are you playing with test-kitchen stuff we talked about yesterday?
[2012-08-18 17:32:33 -0400] ssd7: jtimberman: yes :(
[2012-08-18 17:34:31 -0400] yfeldblum: countdigi, not sure i followed the question
[2012-08-18 17:34:49 -0400] jtimberman: ssd7: :(
[2012-08-18 17:35:02 -0400] yfeldblum: countdigi, `bundle exec` just sets that env var and exec's the command you pass in
[2012-08-18 17:35:07 -0400] jtimberman: ssd7: well, I'm doing some merges of tickets we have marked for merging.
[2012-08-18 17:35:13 -0400] yfeldblum: countdigi, at least on ruby-1.9
[2012-08-18 17:37:55 -0400] countdigi: yfeldblum: i thought it manipped the path - i think i misunderstood it
[2012-08-18 17:38:08 -0400] ssd7: jtimberman: Well, we can talk on Monday but the status is that the centos-5.8 basebox was still giving me problems with not coming up properly.  So I thought, "I'll use a custom Kitchenfile to test other baseboxes just to verify my setup." Since then it has been a journey from one error to another. Not a huge deal, just something I'm doing in the background.  Probably my own fault at the moment.
[2012-08-18 17:44:21 -0400] jtimberman: ssd7: oh, welcome to my week :D
[2012-08-18 17:44:38 -0400] jtimberman: i have a dent in my forehead from hitting myself :/
[2012-08-18 17:48:55 -0400] ssd7: well, rm -rf'ing all the things moved me forward :)
[2012-08-18 17:49:10 -0400] jtimberman: "Resolved COOK ready for merge: No issues found" - yay
[2012-08-18 17:49:52 -0400] jtimberman: The "COOK tickets merged and ready for release" filter shows me 120 issues :O
[2012-08-18 17:50:41 -0400] ssd7: NICE
[2012-08-18 17:52:18 -0400] lflux: ^^
[2012-08-18 18:01:40 -0400] yfeldblum: countdigi, https://github.com/carlhuda/bundler/blob/master/lib/bundler/cli.rb#L425 and https://github.com/carlhuda/bundler/blob/master/lib/bundler/runtime.rb#L188-210
[2012-08-18 19:38:42 -0400] countdigi: chkin it out
[2012-08-18 19:42:27 -0400] countdigi: man i gotta get some fresh air but its raining and having too much fun on the keyboard :-)
[2012-08-18 19:43:22 -0400] countdigi: yfeldblum: thanks - i see where it prepends the path and sets u RUBYOPT thanks for pointing that out
[2012-08-18 19:43:46 -0400] yfeldblum: countdigi, sure
[2012-08-18 19:48:26 -0400] rburton-: Any good articles that speak about how to setup a custom init.d script and start the service via chef? Would that be just as simple as using template + service?
[2012-08-18 20:00:18 -0400] lflux: pretty much
[2012-08-18 20:00:29 -0400] lflux: at least when i've done it
[2012-08-18 20:02:28 -0400] bytheway_: anyone done setup of weblogic or glassfish with chef?
[2012-08-18 20:03:14 -0400] bytheway_: both have command line / scripting interfaces, been trying to figure out if it would be best to generate the config.xml directly, or interface with the wlst/asadmin
[2012-08-18 20:14:07 -0400] reset: bytheway: either way is acceptable if you wrap it in a LWRP
[2012-08-18 20:14:24 -0400] reset: manipulating the config.xml directly may be more painstaking
[2012-08-18 20:15:17 -0400] yfeldblum: reset, compiling an in-memory data-structure, built up via complex ruby code that inspects e.g. node attributes, to a config.xml is an option
[2012-08-18 20:16:32 -0400] bytheway: the xml might be hard, but is it harder to have a recipe know how, for example, to check, update, delete, add things like datasources, or just build the xml, restart
[2012-08-18 20:17:04 -0400] bytheway: its not the initial lay-down I'm really concerned about, its what happens when things change
[2012-08-18 20:17:13 -0400] reset: yfeldblum: regardless of how the provder of the LWRP is written - yes, node attributes are how you'd configure it
[2012-08-18 20:18:28 -0400] reset: bytheway: have you written an LWRP before? The check logic for wether to update, delete, or add is all contained in there
[2012-08-18 20:18:45 -0400] reset: if you abstract that all into an LWRP your recipe will be very clean
[2012-08-18 20:18:49 -0400] bytheway: we desperately need chef where I work, but I have been having a lot of difficulty figuring out how best to match what we need to chef, etc
[2012-08-18 20:19:12 -0400] bytheway: 480+ separate java war files over 200+ servers
[2012-08-18 20:19:23 -0400] bytheway: (dev, test, prod)
[2012-08-18 20:19:36 -0400] reset: bytheway: here is an example of a cookbook which manipulates an XML file directly wrappedin an LWRP https://github.com/RiotGames/nexus-cookbook/blob/master/recipes/default.rb#L144-150
[2012-08-18 20:21:15 -0400] reset: bytheway: you have a lot of work to do if you have 480 different applications, but it is not insurmountable
[2012-08-18 20:22:19 -0400] bytheway: there's a lot of shared state, generally we have many apps running in a single weblogic domain, but still
[2012-08-18 20:22:38 -0400] bytheway: huge hill to climb,  its definitely not as easy as places that have, say, one main app they support
[2012-08-18 20:41:26 -0400] hakunin_: hoover_damm: hey i'm using your unicorn recipe, and i have these 500 errors abundant after restart, which go away after a lot of refreshing. however, nothing is written in unicorn_stderr, unicorn_stdout, or unicorn logs. The only thing: rails logs one line "Started GET "/" for ***.***.***.*** at 2012-08-19 00:35:12" and once in a while (not on every refresh) i see this in nginx error log: "upstream prematurely closed connection
[2012-08-18 20:41:27 -0400] hakunin_:  while reading response header from upstream"
[2012-08-18 20:42:14 -0400] hakunin_: but that nginx thing feels unrelated to 500s because it happens rarely if i refresh too fast while unicorns are restarting
[2012-08-18 20:42:45 -0400] hakunin: hoover_damm: any clue what it could be? i checked that my gem_home paths are correct and everything
[2012-08-18 20:42:46 -0400] hoover_damm: hakunin_, if they go away after refreshing one of your connections didn't establish in the hot reload
[2012-08-18 20:43:03 -0400] hoover_damm: and your code is gracefully reconecting after each worker
[2012-08-18 20:43:04 -0400] hoover_damm: reconnects
[2012-08-18 20:43:09 -0400] hoover_damm: so if you have 8 workers, you have 8 500's
[2012-08-18 20:43:28 -0400] hoover_damm: could be redis, mongo, ar
[2012-08-18 20:43:28 -0400] hoover_damm: etc
[2012-08-18 20:44:11 -0400] hoover_damm: hakunin, https://github.com/damm/chef-unicorn/blob/master/templates/default/unicorn.rb.erb#L106-L107
[2012-08-18 20:44:29 -0400] hoover_damm: hakunin, you see there we do that... now it's possible that if after_fork is empty this is getting missing
[2012-08-18 20:44:55 -0400] hakunin: hoover_damm: i have that config pretty much exactly
[2012-08-18 20:45:15 -0400] hoover_damm: hakunin, can you gist the actual unicorn.rb that's rendered?
[2012-08-18 20:45:18 -0400] hoover_damm: just fir sanity sake
[2012-08-18 20:45:20 -0400] hoover_damm: for*
[2012-08-18 20:45:26 -0400] hakunin: hoover_damm: yeah was just about to
[2012-08-18 20:46:01 -0400] hakunin: hoover_damm: surprising that nothing is in unicorn_stderr either
[2012-08-18 20:46:26 -0400] hoover_damm: nah not that shocking
[2012-08-18 20:46:30 -0400] hoover_damm: rails users do silent rescues a lot
[2012-08-18 20:46:40 -0400] hoover_damm: so you can go hunting
[2012-08-18 20:46:44 -0400] hakunin: hoover_damm: i don't : )
[2012-08-18 20:47:49 -0400] hakunin: hoover_damm: https://gist.github.com/a750006c499c35fad7a3
[2012-08-18 20:48:31 -0400] hoover_damm: hakunin, using redis? or any other stuff?
[2012-08-18 20:48:54 -0400] hakunin: hoover_damm: redis, yes, not on the same host.
[2012-08-18 20:49:15 -0400] hoover_damm: hakunin, you mway want to add to your unicorn.rb to have it reconnect to redis in after_fork
[2012-08-18 20:49:22 -0400] hakunin: hoover_damm: really just: redis+resque, postgres, memcached
[2012-08-18 20:49:32 -0400] hoover_damm: o you lack after_fork
[2012-08-18 20:49:33 -0400] hoover_damm: lol
[2012-08-18 20:49:35 -0400] hoover_damm: that is your bug
[2012-08-18 20:49:45 -0400] hoover_damm: https://github.com/damm/chef-unicorn/issues/2
[2012-08-18 20:49:52 -0400] hakunin: hoover_damm: memcached is irrelevant because i saw 500s before i hooked it up
[2012-08-18 20:49:57 -0400] hoover_damm: so your not reconnecting to postgresql
[2012-08-18 20:49:59 -0400] hoover_damm: makes sense
[2012-08-18 20:52:06 -0400] hakunin: hoover_damm: wait wtf
[2012-08-18 20:52:10 -0400] hakunin: you're right
[2012-08-18 20:52:16 -0400] hakunin: hoover_damm: trying
[2012-08-18 20:52:36 -0400] hoover_damm: hakunin, https://github.com/damm/chef-unicorn/commit/26981b25ecf6b67419832823eb9581e0f1f604b2
[2012-08-18 20:52:43 -0400] hoover_damm: hakunin, that should fix it for you
[2012-08-18 20:53:09 -0400] hoover_damm: sorry about not backporting that... I remember hitting that with a client 3months ago
[2012-08-18 20:53:13 -0400] hoover_damm: and forgot to backport that fix :(
[2012-08-18 20:57:39 -0400] hakunin: hoover_damm: no it's ok, glad i found you here :)  haven't tried that yet, about to
[2012-08-18 20:58:25 -0400] hoover_damm: hakunin, should work :) just annoying and yes the database drivers are silent rescues
[2012-08-18 20:58:30 -0400] hoover_damm: although you should see notices in your rails log
[2012-08-18 20:58:32 -0400] hoover_damm: indicating it
[2012-08-18 20:59:52 -0400] hakunin: hoover_damm: good thing you committed, i can just update via librarian-chef :)
[2012-08-18 21:00:25 -0400] hakunin: oh i'm using my fork, well, still good
[2012-08-18 21:13:19 -0400] invertd: does anyone know if artur bergman from fastly has released his artur cookbook re linux performance settings. he mentioned something about it at ChefConf.
[2012-08-18 21:21:31 -0400] hakunin: hoover_damm: yay, fixed!
[2012-08-18 22:18:01 -0400] erk: if i have a nginx confg from an existing node, and i want to use this for all provision purpose, where should i put this file?
[2012-08-18 22:18:33 -0400] erk: so that when i run nginx cookbook it will use it and preserve nginx cookbook from modification?
[2012-08-18 22:31:44 -0400] miah: moin
[2012-08-18 22:46:25 -0400] mndoci: Silly question.  I am tried to bootstrap a new ec2 instance, but if I don't specify an AZ it gives me an error.  No such issues when AZ is specified
[2012-08-18 22:46:28 -0400] justin-: Is there a way to queue Ruby code to be run with a recipe?
[2012-08-18 22:51:51 -0400] jtimberman: justin-: ruby_block resource?
[2012-08-18 22:52:04 -0400] jtimberman: that'll run a block of ruby code as a resource
[2012-08-18 22:53:53 -0400] just1n: jtimberman: That's exactly what I need. Thank you.
