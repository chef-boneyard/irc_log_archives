[2012-08-01 00:08:18 -0400] aslan: hey guys... which method of chef install do you recommend. there are so many ways now that i am confused.
[2012-08-01 00:08:51 -0400] aslan: on chef 0.9 there was a way to have chef managed by runit. i kinda like that method but i am not sure how to get there
[2012-08-01 00:15:09 -0400] ssd7: aslan: Depending on your requirements, I would install chef with the omnibus installer.  Easiest way to get a consistent set of chef's dependencies across your machines.
[2012-08-01 00:16:44 -0400] aslan: ssd7: i dont mind installing dependencies manually ... there was a method were you could install chef server using chef solo by downloading a bundle of cookbooks from opscodes s3
[2012-08-01 00:17:05 -0400] ssd7: aslan: Ahh, didn't realize you were refering to the server.
[2012-08-01 00:20:00 -0400] aslan: ssd7: yeah i think installing chef on the clients with the gems should be sufficient . its the server that i am not sure
[2012-08-01 00:20:02 -0400] adishan: Hi, new to opscode chef, so had a naive question. If one applies this  directory "/tmp/something" do
[2012-08-01 00:20:04 -0400] adishan:   owner "root"
[2012-08-01 00:20:06 -0400] adishan:   group "root"
[2012-08-01 00:20:07 -0400] adishan:   mode "0755"
[2012-08-01 00:20:09 -0400] adishan:   action :create
[2012-08-01 00:20:10 -0400] adishan: end
[2012-08-01 00:20:24 -0400] adishan: and if the directory exists but has a different permissions
[2012-08-01 00:20:39 -0400] adishan: does the permission change or what is the default behavior
[2012-08-01 00:20:48 -0400] aslan: adishan: use https://gist.github.com/ for copying code
[2012-08-01 00:21:06 -0400] adishan: sorry aslan.. will bear in mind in future.
[2012-08-01 00:21:15 -0400] ssd7: adishan: Chef should change the permissions to those specified and nothing more.  Any other behavior would probably be considered a bug.
[2012-08-01 00:21:30 -0400] adishan: thanks ssd7
[2012-08-01 01:07:21 -0400] adishan: ok yet one more question,  in the formation of a config file via template, I did like to paste the GPG public key.. how does one make it to paste the content of the gpg pub key stored in text file into the config file.
[2012-08-01 01:07:43 -0400] jameson: it's be easier to save it the GPG as a file no?
[2012-08-01 01:07:45 -0400] adishan: as far as I have read the content overwrite whatever is existing in the file
[2012-08-01 01:07:56 -0400] adishan: yes I did like to
[2012-08-01 01:08:16 -0400] adishan: but this software config needs it to be pasted in the config file
[2012-08-01 01:08:24 -0400] adishan: for some weird reason
[2012-08-01 01:08:28 -0400] jameson: heh you can make it an attribute
[2012-08-01 01:09:08 -0400] adishan: is the format retained in that case?
[2012-08-01 01:10:12 -0400] jameson: mm
[2012-08-01 01:10:18 -0400] jameson: i need to force update the IP address of my node
[2012-08-01 01:10:24 -0400] jameson: can I do that from inside of my recipe?
[2012-08-01 01:37:30 -0400] jameson: adishan: the GPG in string format is retained
[2012-08-01 01:37:35 -0400] jameson: if you need it any other format, no
[2012-08-01 01:37:47 -0400] adishan: yep checking on it
[2012-08-01 01:37:51 -0400] adishan: by dry runs
[2012-08-01 01:38:08 -0400] jameson: (I do something similar for custom apt-repos)
[2012-08-01 01:48:44 -0400] dyer: Hey guys, I have a question.. Whats the best way to get a gem installed and available for use within a library?
[2012-08-01 01:53:51 -0400] ssd7: dyer: The new chef_gem reosurce if you are on a recent version
[2012-08-01 01:54:08 -0400] dyer: still on 0.10.8
[2012-08-01 01:54:15 -0400] dyer: When did that go into effect ?
[2012-08-01 01:54:46 -0400] ssd7: I think 10.12.0, I can check.
[2012-08-01 01:55:43 -0400] hoover_damm: yep
[2012-08-01 01:55:49 -0400] hoover_damm: it was either .10 or .12
[2012-08-01 01:55:55 -0400] ssd7: 10.10
[2012-08-01 01:55:56 -0400] dyer: yea, I have been meaning to test 10.12
[2012-08-01 01:56:03 -0400] dyer: well 10.10 was a total bust for me
[2012-08-01 01:56:05 -0400] hoover_damm: why haven't you?
[2012-08-01 01:56:10 -0400] hoover_damm: yeah everyone felt that
[2012-08-01 01:56:13 -0400] dyer: the remote resource bug notification killed me
[2012-08-01 01:56:25 -0400] dyer: i had set aside a few days to test but that ship has sailed
[2012-08-01 01:56:29 -0400] dyer: I'll get around to it
[2012-08-01 01:56:33 -0400] dyer: this might be the driver
[2012-08-01 01:57:13 -0400] dyer: gosh, can't believe I actually have to upgrade to get new features :)
[2012-08-01 01:57:36 -0400] jameson: crazzyy
[2012-08-01 01:57:51 -0400] dyer: Whats the status w/ 10.14?
[2012-08-01 01:58:02 -0400] dyer: I have been traveling the last two weeks, so behind on the mailing lists
[2012-08-01 02:02:28 -0400] jameson: so
[2012-08-01 02:02:36 -0400] jameson: anyone know how I can update the IP: field from inside the node?
[2012-08-01 02:04:00 -0400] hoover_damm: ipaddress is automatically generated by ohai
[2012-08-01 02:04:44 -0400] jameson: right.
[2012-08-01 02:04:54 -0400] jameson: so can I force ohai to update the ipaddress of the node?
[2012-08-01 02:04:59 -0400] jameson: without running chef-client preferrably :|
[2012-08-01 02:06:08 -0400] jameson: http://community.opscode.com/questions/104
[2012-08-01 02:06:12 -0400] jameson: something similar to  that effect :X
[2012-08-01 02:07:09 -0400] sascha_d: ohey! Opscode, I love the question section on the site. is that new? I think not. I have to get out more, obviously
[2012-08-01 02:17:32 -0400] jameson: oo
[2012-08-01 02:17:33 -0400] jameson: at
[2012-08-01 02:17:42 -0400] z: sascha_d: its apparently been around a year
[2012-08-01 02:17:44 -0400] z: sascha_d: http://community.opscode.com/questions/3
[2012-08-01 02:17:51 -0400] z: sascha_d: but I've only just seen it too
[2012-08-01 02:17:58 -0400] sascha_d: I need to get out more
[2012-08-01 02:18:09 -0400] sascha_d: or trawl the documentation site more
[2012-08-01 02:18:25 -0400] ssd7: heh, yeah, I try to visit the questions site occasionally
[2012-08-01 02:18:37 -0400] sascha_d: It was such a hodgepodge when I first started with Chef that I kind of trained myself to not visit that much after a while
[2012-08-01 02:18:51 -0400] sascha_d: now that it's COMPLETELY AWESOME, I miss so much
[2012-08-01 02:18:51 -0400] z: ssd7: Any news on when the Community 2.0 site might arrive?
[2012-08-01 02:19:11 -0400] z: ssd7: It would be *awesome* to not have this stupid flat namespace any more, and to be able to "HOT OR NOT!" various Cookbooks as some really do suck ass
[2012-08-01 02:19:17 -0400] dyer: Hey SSD, Is there any way prior to 0.10.10 to load and use a gem within a recipe ?
[2012-08-01 02:20:09 -0400] ssd7: dyer: Yes, you need to install the gem at compile time, and likely need to do some wrapping around require.  I might have an example
[2012-08-01 02:20:17 -0400] dyer: that would be great
[2012-08-01 02:20:19 -0400] dyer: thanks
[2012-08-01 02:20:23 -0400] jameson: ;_; some cb really need to get out of their namespaces...
[2012-08-01 02:20:26 -0400] ssd7: z: Unforutnately, I do not know how far out that is.
[2012-08-01 02:20:38 -0400] z: Keeping me on tenterhooks, I like it ;)
[2012-08-01 02:20:53 -0400] z: It was obviously mentioned at the Summit last year, so we're only 8 months on from there!
[2012-08-01 02:21:13 -0400] z: I will be over the moon when it arrives
[2012-08-01 02:21:23 -0400] ssd7: dyer: in the library: https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb#L3
[2012-08-01 02:21:40 -0400] ssd7: dyer: then in a recipe: https://github.com/opscode-cookbooks/aws/blob/master/recipes/default.rb
[2012-08-01 02:25:08 -0400] mattray: this can't be right build-essential leaves out make on 12.04?
[2012-08-01 02:25:29 -0400] ssd7: mattray: O.o
[2012-08-01 02:25:47 -0400] mattray: trying to use the new build-essential cookbook with the mysql::client stuff
[2012-08-01 02:26:05 -0400] mattray: and using the omnibus-aware bits
[2012-08-01 02:26:28 -0400] z: mattray: INCORRECT
[2012-08-01 02:26:33 -0400] z: mattray: http://packages.ubuntu.com/precise/build-essential
[2012-08-01 02:26:48 -0400] mattray: right
[2012-08-01 02:26:51 -0400] z: mattray: Damnit why doesn't IRC have quiz show sounds? I demand you fix this immediately! :P
[2012-08-01 02:39:04 -0400] hoover_damm: mattray, build-essential has make
[2012-08-01 02:39:17 -0400] hoover_damm: mattray, some reason it gets left out occasionally
[2012-08-01 02:39:25 -0400] hoover_damm: mattray, i'm assuming out of date cache
[2012-08-01 02:39:26 -0400] mattray: yeah, that's what I observed
[2012-08-01 02:39:33 -0400] mattray: trying to debug now
[2012-08-01 02:39:51 -0400] hoover_damm: apt-get update && apt-get -f install
[2012-08-01 02:39:52 -0400] hoover_damm: fix it?
[2012-08-01 02:46:06 -0400] erratic_: sorry had to leave guys
[2012-08-01 02:46:17 -0400] erratic_: just met up with a friend i havent seen in a few years
[2012-08-01 02:46:48 -0400] jameson: mattray: so I found a solution (running chef-client internally makes the recipe go into a eternal loop)
[2012-08-01 02:47:01 -0400] jameson: was to use unix 'at' to queue a job to touch a file and run chef-client once
[2012-08-01 02:47:06 -0400] jameson: by using a recipe
[2012-08-01 02:48:12 -0400] mattray: hoover_damm: trying to get a minimal run list to recreate
[2012-08-01 02:48:17 -0400] mattray: jameson: clever
[2012-08-01 02:49:28 -0400] erratic_: lol
[2012-08-01 02:49:37 -0400] jameson: i'll find out if it was any cleaver
[2012-08-01 02:50:03 -0400] jameson: success!
[2012-08-01 02:50:23 -0400] hoover_damm: mattray, there is 2 different build-essential versions 11.5_1 and 11.5_2
[2012-08-01 02:50:28 -0400] hoover_damm: on my mirror
[2012-08-01 02:52:15 -0400] hoover_damm: mattray, and make looks to have a new version
[2012-08-01 02:52:45 -0400] hoover_damm: both are dated in may of 2011 so it shouldn't be anything recent
[2012-08-01 02:53:11 -0400] hoover_damm: mattray, the most useful bits likely is the apt-get install build-essential stdout/stderr
[2012-08-01 02:53:29 -0400] hoover_damm: because whatever is happening it's not obvious
[2012-08-01 02:55:10 -0400] mattray: right, but I'm testing the latest build-essential cookbook with the chef-full and the chef_gem for mysql
[2012-08-01 02:55:16 -0400] erratic_: riding the bus is so akward
[2012-08-01 02:55:18 -0400] mattray: and want to make that blow up
[2012-08-01 02:55:26 -0400] erratic_: ackward
[2012-08-01 02:55:37 -0400] hoover_damm: erratic_, stop taking the 72 home?
[2012-08-01 02:55:42 -0400] hoover_damm: or whatever bus you take
[2012-08-01 02:56:02 -0400] erratic_: im on the 15 going to myrtle edwards
[2012-08-01 02:56:23 -0400] hoover_damm: and I find Seattle buses to be easy
[2012-08-01 02:56:31 -0400] erratic_: watch a sunset then head home
[2012-08-01 02:56:43 -0400] mattray: well crap, didn't reproduce this time
[2012-08-01 02:57:41 -0400] erratic_: i ate pizza watched a presentation on graphite and bounced and stil need to ask my multicast question :/
[2012-08-01 02:57:51 -0400] hoover_damm: lol graphite presentation
[2012-08-01 02:57:54 -0400] hoover_damm: glad I wasn't there then
[2012-08-01 02:58:23 -0400] hoover_damm: and learning at the same time
[2012-08-01 02:59:25 -0400] erratic_: graphite and chef and vagrant
[2012-08-01 02:59:26 -0400] mattray: hoover_damm: found the problem.
[2012-08-01 03:00:12 -0400] mattray: accidentally reverted my patch for http://tickets.opscode.com/browse/COOK-1384
[2012-08-01 03:00:33 -0400] mattray: so my mysql gem build was failing again
[2012-08-01 03:00:57 -0400] mattray: looks like it's time to start using librarian to be explicit about git branches
[2012-08-01 03:01:01 -0400] hoover_damm: for the record, I don't understand vagrant... if you can't fire up kvm or a regular loopback image
[2012-08-01 03:01:04 -0400] hoover_damm: go away
[2012-08-01 03:01:09 -0400] ampledata: +1 librarian
[2012-08-01 03:01:10 -0400] hoover_damm: or use lxc
[2012-08-01 03:01:27 -0400] hoover_damm: vagrant is like the ruby redheaded stepchild of virtualization that makes you skin yourself
[2012-08-01 03:01:37 -0400] ampledata: hoover you're full of opinions
[2012-08-01 03:01:58 -0400] hoover_damm: ampledata, that opinion is based on years of watching people complain and whine about this and that and ...
[2012-08-01 03:02:21 -0400] hoover_damm: ampledata, and here I am... i use lxc, kvm, paralells and I just can't grasp the issues they have
[2012-08-01 03:02:51 -0400] hoover_damm: ampledata, i've actually had to deal with cookbooks that were monkeypatched for race conditions that only happened in vagrant... not in real life
[2012-08-01 03:03:21 -0400] hoover_damm: ampledata, my benchmark is real life... or real servers, working product... not some vm that produces different results
[2012-08-01 03:03:22 -0400] mattray: I don't use vagrant either, but I'm just crotchety
[2012-08-01 03:03:40 -0400] mattray: and I have free cloud accounts
[2012-08-01 03:03:55 -0400] hoover_damm: mattray, free as in you don't pay for them right? ;)
[2012-08-01 03:04:11 -0400] mattray: hoover_damm: like I said, it's who you know :)
[2012-08-01 03:04:18 -0400] hoover_damm: mattray, lol true
[2012-08-01 03:04:55 -0400] hoover_damm: ampledata, if you suck down my irc logs and you quanitify the time lost by vagrant that users have had in #chef ... you could solve the national debt
[2012-08-01 03:05:11 -0400] hoover_damm: ;)
[2012-08-01 03:07:03 -0400] jameson: mattray: do you think adding the chef-client recipe would've done the samething?
[2012-08-01 03:07:25 -0400] jameson: (I needed node-list to reflect that change before chef-client does it at interval)
[2012-08-01 03:16:08 -0400] jameson: mm yup
[2012-08-01 03:16:17 -0400] jameson: looks like chef-client will wait the delay then start :|
[2012-08-01 03:35:11 -0400] biffhero: I am having errors installing from this page: http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo The error is as shown here:  http://pastebin.com/gEpWkM2L I found the line in the file which is causing the error:  recipes/rubygems-install.rb -> 203:    init_content = IO.read("#{gems_dir}/gems/chef-#{chef_version}/distro/#{dist_dir}/etc/init.d/#{svc}")  - I think the problem is that gems_dir isn't being set properly.
[2012-08-01 03:36:31 -0400] biffhero: I am reading the logs from the previous guy at http://likens.us/logs/2012/%23chef.07-10.12.log
[2012-08-01 03:41:36 -0400] biffhero: And there's nothing there for him.  I wonder if ruby can do printf.
[2012-08-01 03:46:37 -0400] flaccid: is there a way to exit/return in a provider's action?
[2012-08-01 03:48:58 -0400] biffhero: It is interesting that the gems_dir variable is only set for installing with the "init" type startup scripts.
[2012-08-01 03:59:38 -0400] biffhero: ok, I got past that hurdle, but I can't write it up just yet, as this took an hour I didn't have to give.  :-)  unixguy, if you are reading this, I will explain how to get past that one here in IRC, as well as filing a bug with opscode.
[2012-08-01 04:04:24 -0400] ryan____: Any one ever used Blueprint with Chef?
[2012-08-01 04:04:58 -0400] ryan____: I used to use Puppet for deployment, but it looks horrible because to setup the machine I have to run my own fabric python files. I want to centralize things into cookbooks.
[2012-08-01 04:05:30 -0400] ryan____: Blueprint only scans configuration, at most /etc/ directory. anyone else has suggestion what to do instead?
[2012-08-01 04:05:42 -0400] ryan____: more chef-way? the best practice? thanks
[2012-08-01 04:21:21 -0400] flaccid: ryan____: do chef normally
[2012-08-01 04:21:45 -0400] ryan____: flaccid: you are saying reuse cookbooks and override default values when needed?
[2012-08-01 04:22:14 -0400] flaccid: use existing community cookbooks plus any that you need to make and do chef as instructed on the wiki
[2012-08-01 04:24:21 -0400] ryan____: flaccid: thanks. one thing that bugs is the deterministic nature of chef
[2012-08-01 04:24:57 -0400] ryan____: flaccid: what if a particular package depends on X app, but i don't know whether it should comes before dpeendncy Y or Z, how do I resolve that?
[2012-08-01 04:25:32 -0400] flaccid: system package manager resolves dependencies and installs them as normal
[2012-08-01 04:26:06 -0400] ryan____: flaccid: thanks.
[2012-08-01 04:30:04 -0400] flaccid: hmm how do i use File.readlink in a provider ruby_block, i get undefined method?
[2012-08-01 04:30:53 -0400] flaccid: use ::Chef and ::File i guess
[2012-08-01 05:59:50 -0400] biffhero: I worked around the problem about the install by doing the following:  1.  grab the tar.gz file  "wget http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz"   2.  open it up, edit cookbooks/chef-server/recipes/rubygems-install.rb and change the line that sets the gems_dir environment variable.  I set it to     gems_dir = "/opt/chef/embedded/lib/ruby/gems/1.9.1"   3.  recreate the tar.gz file.  tar -czf test.tar.gz cookbooks  4.  Use th
[2012-08-01 06:23:43 -0400] BryanWB_: ohai chefs!
[2012-08-01 07:57:33 -0400] cnf: ohai
[2012-08-01 10:04:42 -0400] jacobat: Hi. I'm trying to setup a chef-server, but I'm getting "FATAL: Connection to rabbitmq refused. Check your rabbitmq configuration and chef's amqp* settings" when trying to start it
[2012-08-01 10:04:49 -0400] jacobat: rabbitmq is running
[2012-08-01 10:05:07 -0400] jacobat: and i've checked that the vhost and user exists
[2012-08-01 10:05:10 -0400] jacobat: any ideas where to dig?
[2012-08-01 10:44:13 -0400] jacobat: So it seems the new version of bunny does now play well with the rabbitmq version on ubuntu 10.04
[2012-08-01 10:47:29 -0400] sampikesley: get the newer version
[2012-08-01 10:47:30 -0400] sampikesley: https://github.com/pikesley/catering-college/blob/master/install-chef-server#L33
[2012-08-01 10:48:30 -0400] jacobat: I've just downgraded bunny
[2012-08-01 10:50:14 -0400] sampikesley: :/
[2012-08-01 10:50:19 -0400] sampikesley: mauybe that works too
[2012-08-01 10:52:30 -0400] jacobat: It does...
[2012-08-01 10:52:54 -0400] jacobat: I wish chef would be better at locking down versions, it seems I often encounter issues related to versions of things
[2012-08-01 10:53:17 -0400] sampikesley: there's a lot of moving parts in a Chef server
[2012-08-01 10:53:28 -0400] sampikesley: hence my catering-college thing
[2012-08-01 10:53:58 -0400] jacobat: Indeed there is - I wish a chef server was simpler too :)
[2012-08-01 10:54:29 -0400] sampikesley: Couch. Solr. Rabbit. Who understands this stuff? ;)
[2012-08-01 10:54:41 -0400] jacobat: Right
[2012-08-01 10:54:51 -0400] jacobat: I guess it's there for a reason, I'm just too dumb to see it :)
[2012-08-01 10:55:08 -0400] jacobat: I wonder if you couldn't build chef with just a single database
[2012-08-01 10:55:20 -0400] jacobat: But I guess opscode had their reasons for doing it like they have
[2012-08-01 12:06:08 -0400] bluerose: anyone alive ?
[2012-08-01 12:07:00 -0400] matti: bluerose: Don't worry.
[2012-08-01 12:07:06 -0400] matti: bluerose: Ask the questiin away :)
[2012-08-01 12:07:10 -0400] bluerose: haha
[2012-08-01 12:07:12 -0400] matti: bluerose: Somebody might wake up and help.
[2012-08-01 12:07:42 -0400] matti: bluerose: Folks are probably still asleep (US etc), or at work (UK etc) :)
[2012-08-01 12:07:49 -0400] bluerose: i'm trying to build a chef lamp stack.. it seems that mediawiki has either deleted or moved thier git repo and i can't find any reference to a working one so my lamp install clearly breaks
[2012-08-01 12:24:42 -0400] sampikesley: This is possibly not a Chef problem ;)
[2012-08-01 12:27:03 -0400] bluerose: well the recipie is on the opscode site...
[2012-08-01 12:27:05 -0400] bluerose: :)
[2012-08-01 12:27:14 -0400] bluerose: i figured i couldn't be the only one with this issue
[2012-08-01 12:33:48 -0400] sampikesley: Hah
[2012-08-01 12:34:08 -0400] sampikesley: Presumably it specifices the github repo somehwre inside there
[2012-08-01 12:36:12 -0400] ashb: bluerose: which cookbook?
[2012-08-01 12:36:44 -0400] ashb: because http://community.opscode.com/search?query=mediawiki&scope=home turns up nothing
[2012-08-01 12:42:09 -0400] bluerose: http://wiki.opscode.com/display/chef/Build+a+LAMP+Stack
[2012-08-01 12:42:38 -0400] bluerose: ashb: http://wiki.opscode.com/display/chef/Build+a+LAMP+Stack
[2012-08-01 12:42:45 -0400] bluerose: oh i said that already
[2012-08-01 12:42:46 -0400] bluerose: heh
[2012-08-01 12:43:15 -0400] leifmadsen: morning all. Curious if anyone has much experience with minitest-chef-handler? I've build several tests for a cookbook with multiple recipes, and I'm trying to figure out how to name the files or create the layout so that tests only run for those recipes that were executed, instead of all the files in the minitest directory.
[2012-08-01 12:43:29 -0400] ashb: bluerose: yes, and where is the mediawiki cookbook coming from?
[2012-08-01 12:44:49 -0400] ashb: bluerose: you just need to change the repo in the data_bags/apps/mediawiki.json
[2012-08-01 12:45:03 -0400] bluerose: repository": "git://github.com/mediawiki/mediawiki-trunk-phase3.git",   "revision": {
[2012-08-01 12:45:24 -0400] bluerose: right but what im saying is github says there is no repo for mediawiki
[2012-08-01 12:45:30 -0400] ashb: so google for a new one
[2012-08-01 12:45:39 -0400] ashb: its obviously been moved
[2012-08-01 12:47:10 -0400] leifmadsen: hmm, the issue may actually be with the implementation in the minitest-handler-cookbook ...
[2012-08-01 12:47:29 -0400] Mithrandir: omnibus?
[2012-08-01 12:47:30 -0400] bawt: omnibus is a project for building full-stack packages for a variety of platforms, and is used to build the 'chef-full' packages downloaded from http://opscode.com/chef/install or with http://opscode.com/chef/install.sh
[2012-08-01 12:56:55 -0400] leifmadsen: darn.... because I'm using minitest-handler cookbook, the path is tests/minitest/, and since minitest-chef-handler just looks in tests/<cookbook>/*_tests.rb it looks like it'll just execute all the tests, not individual as I'd prefer....
[2012-08-01 13:01:36 -0400] leifmadsen: btm: ping
[2012-08-01 13:06:50 -0400] teukka: does anyone have a pointer how to easily encrypt/decrypt data bags locally on the workstation? I need to create one to be used in vagrant
[2012-08-01 13:12:57 -0400] teukka: maybe easiest just to use knife and tmp data bags on a server...
[2012-08-01 13:25:16 -0400] Gu1234: Hi, I am new with chef and have been struggling for two days to install a RoR stack with chef (been here yesterday too)
[2012-08-01 13:25:33 -0400] Gu1234: I want to start from scratch and using chef-solo and vagrant
[2012-08-01 13:26:20 -0400] Gu1234: I found opscode application_ruby cookbook but I don't know how to make vagrant use it to install a RoR stack
[2012-08-01 13:29:22 -0400] karmi: Gu1234: Have you seen http://vagrantup.com/v1/docs/provisioners/chef_solo.html ?
[2012-08-01 13:30:38 -0400] Gu1234: I saw it but it doesn't really show me what I need to do to get the application_ruby cookbook to work
[2012-08-01 13:33:17 -0400] karmi: Gu1234: http://community.opscode.com/cookbooks/application_ruby ? Refer to the doc in the cookbook, specifically the `application "" do  end` stuff.
[2012-08-01 13:34:51 -0400] Gu1234: I tried, but those really doesn't look like they are aimed for beginners in chef
[2012-08-01 13:35:22 -0400] Gu1234: I find it weird that nobody wrote a good step by step tutorial on how to install RoR stack using chef
[2012-08-01 13:35:39 -0400] Gu1234: If I manage to get it working I guess I should write one :)
[2012-08-01 13:36:34 -0400] karmi: Gu1234: Something like this one? http://wiki.opscode.com/display/chef/Build+A+Rails+Stack
[2012-08-01 13:37:22 -0400] Gu1234: this one is for hosted chef but I guess I should give it another chance
[2012-08-01 13:45:59 -0400] rafa_: Hi , I have a windows 2008 R2 server. Its not being recognised when I run chef-client . Error  - http://pastebin.com/9Cjc3MvJ
[2012-08-01 13:46:13 -0400] rafa_: Can I get some tips to solve this issue?
[2012-08-01 13:46:55 -0400] ssd7: rafa_: I believe that bug is resolved in the newest version of Chef
[2012-08-01 13:47:55 -0400] rafa_: @ssd7: We're running 0.10.6.  I am apprehensive about upgrading the server as our implementation of windows groups will conflict with the official version
[2012-08-01 13:48:52 -0400] rafa_: @ssd7: This version doesn't have windows groups implementation of chef. Is there any other thing I can do ?
[2012-08-01 13:50:17 -0400] ssd7: rafa_: I don't remember the specifics of that bug off hand, one option would be to find the fix for it and then see how easy it would be to create a custom 0.10.6 version.  Depending on the fix you might be able to include a monkeypatch in a cookbook
[2012-08-01 13:50:55 -0400] rafa_: @ssd7 : Thanks. I'll try this out.
[2012-08-01 13:51:53 -0400] dwhsix: ugh devops fail, played a little too fast and loose with versioning :-( that'll larn me
[2012-08-01 13:51:57 -0400] Gu1234: By following what karmi suggested but on vagrant instead of ec2 I get his error:
[2012-08-01 13:51:58 -0400] Gu1234: [Wed, 01 Aug 2012 15:49:04 +0200] WARN: Failed to read the private key /etc/chef/client.pem: #<Errno::ENOENT: No such file or directory - /etc/chef/client.pem> [Wed, 01 Aug 2012 15:49:04 +0200] ERROR: Running exception handlers [Wed, 01 Aug 2012 15:49:04 +0200] ERROR: Exception handlers complete [Wed, 01 Aug 2012 15:49:04 +0200] FATAL: Stacktrace dumped to /tmp/vagrant-chef-1/chef-stacktrace.out [Wed, 01 Aug 2012 15:49:04 +0200] FATAL: C
[2012-08-01 13:52:25 -0400] Gu1234: I assume those are ec2 keys which I don't need in my case, right? how do I disable those?
[2012-08-01 13:52:48 -0400] karmi: Gu1234: No, this is the certificate for the Chef server.
[2012-08-01 13:53:16 -0400] Gu1234: how do I configure it to use chef-solo?
[2012-08-01 13:57:27 -0400] Gu1234: here is my Vagrantfile: http://pastebin.com/xRfFgAyX
[2012-08-01 14:01:22 -0400] Gu1234: how come nobody is selling cookbooks? i bet that there is a viable business here
[2012-08-01 14:04:24 -0400] yfeldblum: Gu1234, some companies are selling automation services which are implemented via chef and their own private cookbooks
[2012-08-01 14:06:23 -0400] btm: leifmadsen: what's up?
[2012-08-01 14:13:19 -0400] jtimberman: ohai chefs!
[2012-08-01 14:13:38 -0400] jforest: ohai!
[2012-08-01 14:15:59 -0400] linTest: I'm using windows_package resource to remove Google Chrome as a test. The Chef output appears to be happy, no errors -- but Chrome is not uninstalled.
[2012-08-01 14:16:23 -0400] linTest: Using 'action :remove'
[2012-08-01 14:18:31 -0400] mattray: jtimberman: back from vacation?
[2012-08-01 14:30:09 -0400] Jay_Levitt: Anyone have either a working guard setup or a working git hook to upload changed files to the server? guard-chef uploads cookbooks once per changed *file* in them.
[2012-08-01 14:42:29 -0400] jtimberman: mattray: For now.
[2012-08-01 14:48:04 -0400] bluerose: so this may be a dumb question but i'm using a lamp recipe and it complains about a missing mysql gem
[2012-08-01 14:48:04 -0400] ssd7: linTest: Have you ensured that the name of your resource is the same as the DisplayName of the resource in Chrome's uninstaller entry in the registry (see the windows cookbook readme for an explination of where to look)
[2012-08-01 14:48:10 -0400] bluerose: how do i get it to add said gem
[2012-08-01 14:48:54 -0400] btm: bluerose: chef_gem "mysql" before the require 'mysql' in the recipe.
[2012-08-01 14:53:22 -0400] bluerose: i don't see that line in any recipe
[2012-08-01 14:53:31 -0400] bluerose: http://wiki.opscode.com/display/chef/Build+a+LAMP+Stack is what i am working off of
[2012-08-01 14:58:09 -0400] Jay_Levitt: since Real Sysadmins Don't Use Unattended Upgrades, how do folks typically automate package upgrades with chef? I presume not "knife ssh".
[2012-08-01 15:00:13 -0400] erratic_: i do knife ssh with like term=nothing aptget-y
[2012-08-01 15:00:24 -0400] erratic_: something like thay
[2012-08-01 15:00:32 -0400] erratic_: that i have the command at work
[2012-08-01 15:01:06 -0400] bradgignac: i upgrade packages with chef all the time. we just run our own apt repo with approved packages
[2012-08-01 15:01:52 -0400] Urocyon: I'm still thinking about how to do that here.  I just started a new job and am working on getting configurations in chef.   But for running adhoc tasks I'm thinking of installing run deck.
[2012-08-01 15:02:43 -0400] Jay_Levitt: I saw a "run once" type chef cookbook, that might be interesting too
[2012-08-01 15:02:45 -0400] Jay_Levitt: can't find it now
[2012-08-01 15:02:47 -0400] Urocyon: Having our own repo is another option I'm looking at.  Or maybe both.
[2012-08-01 15:03:40 -0400] Jay_Levitt: Ahh, it's mattray's "one-shot".
[2012-08-01 15:04:37 -0400] mattray: Jay_Levitt: pretty simple, no complaints sent my way on it
[2012-08-01 15:07:23 -0400] leifmadsen: btm: hey sorry for the delay, meetings :)   I guess I noticed this morning in the minichef-handler cookbook something that could be tweaked. I realize usually features require a code contribution, but before I start looking at that if you maybe knew of any gotchas I might run into. From the minitest-chef-handler, it looks like it does a search for files based on recipe name within the cookbook, but if using minitest-hand
[2012-08-01 15:07:24 -0400] leifmadsen: ler cookbook, that is kind of nullified since the directory it searches is just minitest, meaning a match of *_test.rb instead of maybe a recipe_test.rb.
[2012-08-01 15:08:29 -0400] leifmadsen: btm: apologies, I guess I'm not sure where I'm going with this, other than, does it make sense to somehow add functionality so that when using minitest-handler cookbook, that you can allow only tests to be run per the recipes that are run within the cookbook, rather than blindly running all the tests, even if not all the recipes in that cookbook have been utilized in the run_list.
[2012-08-01 15:10:51 -0400] Jay_Levitt: So the postgresql cookbook generates a unique, secure password for postgres. On the one hand, I don't see how this improves security, since you still have to put that password in everybody's .pgpass files, in the app, etc. OTOH, I presume it was added for a real need, and I'm no security expert.  Anyone thought about this?
[2012-08-01 15:14:13 -0400] jtimberman: Jay_Levitt: you can set the password via the node['postgresql']['password']['postgres'] attribute.
[2012-08-01 15:14:27 -0400] Jay_Levitt: jtimberman: yeah, I'm wondering if that's a bad idea for reasons I don't see yet..
[2012-08-01 15:14:33 -0400] btm: leifmadsen: https://github.com/btm/minitest-handler-cookbook/pull/17 like this?
[2012-08-01 15:15:15 -0400] yfeldblum: Jay_Levitt, you have to put the password there anyway, regardless
[2012-08-01 15:15:25 -0400] btm: leifmadsen: I haven't looked at that cookbook in too long. Thankfully BryanWB_ resolved some issues a bit ago.
[2012-08-01 15:15:57 -0400] yfeldblum: Jay_Levitt, better, at least, that the password be a sufficiently long cryptorandom string
[2012-08-01 15:16:10 -0400] yfeldblum: Jay_Levitt, because that's no longer a password: that's a key
[2012-08-01 15:16:34 -0400] Jay_Levitt: yfeldblum: ah, true, so it's gone from "protecting against dictionary attacks" to "protecting a shared secret"
[2012-08-01 15:16:52 -0400] yfeldblum: Jay_Levitt, yes
[2012-08-01 15:17:32 -0400] Jay_Levitt: I wish there was a way to use public-key auth with postgres.
[2012-08-01 15:19:43 -0400] sunil__: Hello folks..new to chef and running into a weird bummer issue with apache2 cookbook..
[2012-08-01 15:21:24 -0400] yfeldblum: Jay_Levitt, why?
[2012-08-01 15:21:54 -0400] Jay_Levitt: yfeldblum: for things like staging servers, where the psql password is shared among many developers - I prefer "delete developer's public key" to "change the shared password"
[2012-08-01 15:22:32 -0400] Jay_Levitt: same reason we like keys everywhere else!
[2012-08-01 15:23:05 -0400] yfeldblum: Jay_Levitt, or, change the master key in the data-bag item, reconverge the postgres server, and redeploy the app?
[2012-08-01 15:23:37 -0400] btm: bluerose: did you install chef using the omnibus installer, debian packages, or some other way?
[2012-08-01 15:23:38 -0400] sunil__: I have two cookbooks in my run list, nginx and apache2 -  nginx runs first and sets up nginx on port 80..then apache also tries to bind itself to port 80..Not sure why its trying to use port when I have defined the listen_ports variable in override attributes to be port 8001,
[2012-08-01 15:23:39 -0400] Jay_Levitt: that works if the passwords are only accessed by chef-deployed or chef-aware things.. I'm thinking of developer laptops here
[2012-08-01 15:23:48 -0400] sunil__: not sure if I am missing something obvious..
[2012-08-01 15:24:07 -0400] Jay_Levitt: sunil__: I seem to recall seeing an open pull request for "do the right thing with listen_ports" in apache2
[2012-08-01 15:24:14 -0400] yfeldblum: Jay_Levitt, write a knife plugin that fetches the key and opens a psql session?
[2012-08-01 15:24:27 -0400] Jay_Levitt: yfeldblum: not a bad idea
[2012-08-01 15:24:46 -0400] sunil__: jay_levitt ooh that would make sense..
[2012-08-01 15:24:49 -0400] ashmere: Is there a opscode-full-stack (omnibus) version of chef-server installer available yet?
[2012-08-01 15:25:04 -0400] Jay_Levitt: yfeldblum: tho then I have to get everying using knife, and add all developers to our chef organization, etc
[2012-08-01 15:25:19 -0400] btm: ashmere: there are a couple alpha artifacts up on the s3 bucket, but it isnl't released.
[2012-08-01 15:25:34 -0400] yfeldblum: Jay_Levitt, or if it's a rails app, rails provides a rails console as well as a db console; provide a way for devs to get a console session or db console session in the app?
[2012-08-01 15:25:37 -0400] Jay_Levitt: yfeldblum: I mean, yes, it's all doable.. just seems like I'm doing in postgres exactly what I've been freed from doing with user auth
[2012-08-01 15:26:23 -0400] Jay_Levitt: yfeldblum: rails console expects database.yml to be correct, tho.. I suppose I could patch database.yml based on knife.
[2012-08-01 15:26:33 -0400] leifmadsen: btm: aha, I misunderstood how that was implemented at first, but yes, that does appear to be what I was speaking of. Looks like some refactoring needs to be done there according to the discussion. Thanks for the pointer.
[2012-08-01 15:26:55 -0400] Jay_Levitt: yfeldblum: Actually, I guess I could do that in one place.. update database.yml whenever the postgres password changes, and tell everyone to git pull.  No need for knife, etc. on dev laptops
[2012-08-01 15:26:55 -0400] yfeldblum: Jay_Levitt, i mean, a way for the dev to get a console session on the staging server
[2012-08-01 15:27:14 -0400] yfeldblum: Jay_Levitt, passwords and keys shouldn't be in the app repo
[2012-08-01 15:27:16 -0400] btm: leifmadsen: yeah, poke me if you get a solution there and I'll merge it.
[2012-08-01 15:27:17 -0400] Jay_Levitt: yfeldblum: Yeah, unfortunately there are a few who really like graphical DB tools like pgadmin (don't ask me why)
[2012-08-01 15:27:33 -0400] leifmadsen: btm: sounds good thanks
[2012-08-01 15:27:48 -0400] yfeldblum: Jay_Levitt, eq
[2012-08-01 15:27:50 -0400] yfeldblum: Jay_Levitt, ew
[2012-08-01 15:27:56 -0400] Jay_Levitt: yfeldblum: inorite?
[2012-08-01 15:28:16 -0400] Jay_Levitt: yfeldblum: But one of them says the same thing when I use Sublime Text instead of his vim, so go figure :)
[2012-08-01 15:28:16 -0400] ashmere: btm: any idea of roughly how far it is from a general release ?
[2012-08-01 15:28:36 -0400] bluerose: btm: i installed it on centos via yim
[2012-08-01 15:28:51 -0400] yfeldblum: Jay_Levitt, why do they need pgadmin on a staging db, rather than on their own local db?
[2012-08-01 15:29:03 -0400] btm: ashmere: Chef 11 will be packaged in it, I'm not sure if there'll be a full release of Chef 10. (priorities) maybe a month or two.
[2012-08-01 15:29:47 -0400] Jay_Levitt: yfeldblum: collaboration, mostly.. two developers working on the same branch.  I should clarify: our "staging" server is really a dev-integration server at the moment.  I should stop calling it staging!
[2012-08-01 15:30:06 -0400] yfeldblum: Jay_Levitt, that seems like a possibly bad idea, given the rails assumption that the app owns the db ... that means the app owns the db, not the devs!
[2012-08-01 15:30:29 -0400] btm: bluerose: the mysql cookbook installs the mysql ruby library via package here: https://github.com/opscode-cookbooks/mysql/blob/master/recipes/client.rb#L66
[2012-08-01 15:30:34 -0400] Jay_Levitt: yfeldblum: oh, it's just for query building experimentation, not db changes
[2012-08-01 15:31:05 -0400] Jay_Levitt: yfeldblum: we break Rails's assumptions in a LOT of ways, anyway.. postgres functions, array types, anyway.  One of the oldest continuously-running rails apps around; we had to preinvent a lot of stuff.
[2012-08-01 15:31:15 -0400] Jay_Levitt: (started on Rails 0.5)
[2012-08-01 15:31:28 -0400] yfeldblum: Jay_Levitt, fair enough
[2012-08-01 15:31:33 -0400] btm: bluerose: Looking at that recipe, it installs it during convergence (when the recipes are normally run) so it may not be available when the LWRP in that cookbook is used.
[2012-08-01 15:31:45 -0400] yfeldblum: Jay_Levitt, may want to start trending back towards the rails assumptions tho :P
[2012-08-01 15:32:02 -0400] bluerose: @btm so what do i to fix it
[2012-08-01 15:32:06 -0400] btm: bluerose: you could try 'yum install ruby-mysql' by hand first and see if it solves your problem. if it does, it confirms that the package isn't being installed soon enough.
[2012-08-01 15:32:21 -0400] ashmere: btm: thanks
[2012-08-01 15:32:36 -0400] yfeldblum: Jay_Levitt, provide a simple tool of some kind to fetch the staging db's postgres:// URI?
[2012-08-01 15:32:52 -0400] Jay_Levitt: yfeldblum: yeah, we're working on moving from 2.3 to 3.2 and I think that'll let us use Active Record natively for far more than we do today
[2012-08-01 15:32:58 -0400] Jay_Levitt: yfeldblum: That's right, I forgot about pg uri's
[2012-08-01 15:33:01 -0400] btm: bluerose: I believe this bug is the issue if you want to track it: http://tickets.opscode.com/browse/COOK-932
[2012-08-01 15:33:55 -0400] yfeldblum: Jay_Levitt, my-levitt-tool remote-pg fetch-uri 'nickname-of-staging-db'
[2012-08-01 15:34:47 -0400] mattray: ugh, node['build_essential']['compiletime'] not node['build-essential']['compiletime']
[2012-08-01 15:35:06 -0400] mattray: hoover_damm: that was my bug from last night
[2012-08-01 15:35:29 -0400] Jay_Levitt: yfeldblum: yeah, I like it.. seems like a bunch of ways I can go here
[2012-08-01 15:36:16 -0400] yfeldblum: Jay_Levitt, the idea being a way to fetch the uri/creds on-demand for the any individual pg service given each dev's own key/pw for a "master" service
[2012-08-01 15:36:46 -0400] yfeldblum: Jay_Levitt, then you can always change the uri/creds at any time, redeploy the app, and devs won't see a difference
[2012-08-01 15:37:33 -0400] Jay_Levitt: yfeldblum: oh, right.. do explicitly what public-key auth does implicitly (asymmetrically encrypt the shared key for symmetric crypto).  I hate to build my own kmi, but it might come in handy for many things
[2012-08-01 15:37:43 -0400] bluerose: @btm i installed chef via yum and i built the gem for mysql on my workstation
[2012-08-01 15:38:12 -0400] yfeldblum: Jay_Levitt, anyway, just some suggestions about what you can do, short of becoming a postgres contributor yourself
[2012-08-01 15:38:38 -0400] Jay_Levitt: yfeldblum: pretty sure I shouldn't be contributing asymmetric crypto to postgres :)  I am at the "HN SAYS USE BCRYPT" level.
[2012-08-01 15:38:50 -0400] Jay_Levitt: yfeldblum: thanks for helping me think it through. I like many of these ideas, I see a bunch of ways I could do them
[2012-08-01 15:38:59 -0400] yfeldblum: Jay_Levitt, no probs
[2012-08-01 15:39:46 -0400] brentdunham: I'm looking for a bit of advice on permission denied/ connection refused when trying any search. knife client list works fine
[2012-08-01 15:45:19 -0400] btm: brentdunham: check if chef-solr is running and its logs.
[2012-08-01 15:49:33 -0400] brentdunham: Looks like it's misconfigured
[2012-08-01 15:50:33 -0400] brentdunham: strange I get this when I try chef-solr as well
[2012-08-01 15:50:35 -0400] brentdunham: Unknown error processing config file  with error Permission denied - /etc/chef/solr.rb
[2012-08-01 15:51:22 -0400] brentdunham: but I chown chef /etc/chef
[2012-08-01 15:53:29 -0400] Jay_Levitt: yfeldblum: well, what do you know: http://www.postgresql.org/docs/9.1/interactive/ssl-tcp.html includes client cert support
[2012-08-01 15:55:28 -0400] yfeldblum: Jay_Levitt, cool, didn't know that
[2012-08-01 15:55:47 -0400] Jay_Levitt: yay for not reinventing the kmi wheel
[2012-08-01 15:55:57 -0400] yfeldblum: Jay_Levitt, but then you're back to the problem of going to every service that you've got and adding/removing client certs
[2012-08-01 15:56:12 -0400] yfeldblum: Jay_Levitt, which you can possibly do with chef and a data-bag item
[2012-08-01 15:56:13 -0400] Jay_Levitt: that's much easier tho, since the *services* are all chef configured, and I need those certs anyway to create user accounts
[2012-08-01 15:56:30 -0400] Jay_Levitt: yfeldblum: yep, already using fnichols/chef-users
[2012-08-01 17:01:03 -0400] organicveggie: Anyone know of a legitimate source for a Ruby 1.9.3 RPM for CentOS 6?
[2012-08-01 17:01:57 -0400] organicveggie: I'm seeing coredumps with Chef 0.9.14 and Ruby 1.8.7 on certain EC2 instances and I resolved the problem by installing Ruby from source. But I'd rather use an RPM... :)
[2012-08-01 17:03:14 -0400] ashb: organicveggie: if by 'legitimate' you mean one from CentOS them selves then i doubt one exists
[2012-08-01 17:03:57 -0400] organicveggie: ashb: Yeah, I know there isn't one from CentOS itself. Just looking for something that doesn't look like total garbage. :)
[2012-08-01 17:06:54 -0400] organicveggie: With that in mind, let me rephrase my request. :)
[2012-08-01 17:07:12 -0400] organicveggie: Has anyone here found and *used* RPMS for Ruby 1.9.3 on CentOS 6?
[2012-08-01 17:09:26 -0400] BryanWB_: organicveggie: tried and failed
[2012-08-01 17:09:56 -0400] BryanWB_: use rbenv
[2012-08-01 17:10:05 -0400] BryanWB_: and ruby-build
[2012-08-01 17:10:11 -0400] atomic-penguin: BryanWB_, the last devopsdelicacy is super noisy
[2012-08-01 17:10:45 -0400] BryanWB_: atomic-penguin: y, nathen's blue yeti picked up a lot of bg noise
[2012-08-01 17:14:24 -0400] miah: moin
[2012-08-01 17:54:30 -0400] ryan___: i don't want to store password in cookbook, where do i store them?
[2012-08-01 17:56:04 -0400] upayavira: ryan___: in role files?
[2012-08-01 17:58:49 -0400] ryan___: upayavira: thanks. i am not sure if role / data bag is what i should be using.
[2012-08-01 18:00:38 -0400] upayavira: well, depends how sensitive the password is
[2012-08-01 18:00:57 -0400] upayavira: but usually they'd go in role or data bag, to keep them out of your cookbooks, so your cookbooks can be generic
[2012-08-01 18:06:55 -0400] ryan___: right
[2012-08-01 18:07:19 -0400] ryan___: but a role is commited to the repo
[2012-08-01 18:07:33 -0400] ryan___: i have never used data bag. is it also contain in the repo?
[2012-08-01 18:08:28 -0400] bluerose: hey i have a question, i was having trouble w/ the mysql part of the lamp stack i fixed the client recipie to   gem_package "mysql" do  instead of building it from source .. right above that it should install the mysql-dev package via apt-get but it doesn't do so and the gem doesn't get built
[2012-08-01 18:08:41 -0400] bluerose: i was under the impression it follows recipes sequentualy
[2012-08-01 18:33:39 -0400] btm: bluerose: correct, recipes are processed in top down order. the exception is that ruby in the recipe is evaluated in the compilation phase which is before the convergence phase where the resources are processed.
[2012-08-01 18:34:20 -0400] bluerose: btm so is there anyway i can make it install the devel mysql package before trying to build the gem
[2012-08-01 18:34:27 -0400] bluerose: because it seems to not to that
[2012-08-01 18:38:18 -0400] Jay_Levitt: If I want to override the node['postgresql']['password']['postgres'] attribute, do I need to do that in my role/node's default_attributes() section? Or can I do it from my own cookbook somehow, and if so, how?
[2012-08-01 18:39:02 -0400] btm: bluerose: if you put a package 'mysql-dev' resource before a gem_package 'mysql' resource in a recipe, the first once will be executed first.
[2012-08-01 18:55:35 -0400] Jay_Levitt: I just pulled out 'recipe[python]' from my run_list, and added 'include_recipe "python"' to a recipe.  Shouldn't those be equivalent?  I get "CookbookNotFound: Cookbook python not found."
[2012-08-01 18:56:09 -0400] jbz: Jay_Levitt: If you use includes, you need to put the name of the cookbook you're including into the metata of the cookbook that calls it.
[2012-08-01 18:56:15 -0400] jbz: In the 'depends' section.  I think.
[2012-08-01 18:56:21 -0400] Jay_Levitt: jbz: ah hah
[2012-08-01 18:56:49 -0400] jbz: yeah, the server parses runlists and depends from metadata when deciding which cookbooks a node should download.
[2012-08-01 18:57:34 -0400] Jay_Levitt: I don't suppose there's a nice DRY tool that would create metadata dependencies when I include_recipe?
[2012-08-01 18:58:08 -0400] jbz: I don't know of any.  There certainly might be one.  But you'd have to remember to run it, or have it in a github hook, or in a knife upload hook, or...etc.
[2012-08-01 18:58:20 -0400] Jay_Levitt: yeah.. that part of the story has gaps, I'm discovering :)
[2012-08-01 18:59:45 -0400] Jay_Levitt: I tried using guard-chef but it wants to upload cookbooks once for each *file* changed
[2012-08-01 19:00:27 -0400] jbz: Yeah.  The whole repository-vs-server disconnect causes us great pain.
[2012-08-01 19:01:00 -0400] jbz: We had a hack to keep our workflow in sync (knife flow, implemented git flow-like behavior) but it eventually failed; we ended up criticially desynced
[2012-08-01 19:01:13 -0400] Jay_Levitt: Does it stem out of chef-solo vs server vs hosted vs minichef vs ... distinctions that can't be avoided? Or is it just growing pains?
[2012-08-01 19:01:23 -0400] Jay_Levitt: Ouch - so you don't recommend knife flow, then?
[2012-08-01 19:01:30 -0400] jbz: ha were you using it?
[2012-08-01 19:01:40 -0400] Jay_Levitt: thinking about it
[2012-08-01 19:01:43 -0400] jbz: we wrote it
[2012-08-01 19:01:47 -0400] jbz: it actually does work
[2012-08-01 19:02:09 -0400] Jay_Levitt: except when I... ?
[2012-08-01 19:02:12 -0400] jbz: but it was written to solve our particular problem, which was that we needed our workflow to migrate cookbook corpuses (word?) between our 'dev' and 'production' chef accounts
[2012-08-01 19:02:14 -0400] jbz: well
[2012-08-01 19:02:15 -0400] jbz: it does work
[2012-08-01 19:02:23 -0400] jbz: but *we* did something that screwed it up
[2012-08-01 19:02:33 -0400] jbz: (i.e. someone did something outside the knife flow tool, and knife flow threw up its hands)
[2012-08-01 19:02:39 -0400] Jay_Levitt: ah
[2012-08-01 19:03:04 -0400] jbz: I keep toying with the idea of writing a small script that just syncs a repository to a chef server
[2012-08-01 19:03:14 -0400] Jay_Levitt: I'm on week 1 of chef, still trying to decide how I want my workflow to... work, so been considering guard, github hooks, git hooks, etc
[2012-08-01 19:03:27 -0400] jbz: well, I"m not sure what this advice is worth, but
[2012-08-01 19:03:36 -0400] jbz: I would *strongly* recommend that before you find tools
[2012-08-01 19:03:45 -0400] jbz: you design a manual workflow which works for you
[2012-08-01 19:03:59 -0400] jbz: prove you can use it (in case the tools fail, later, and to prove it works properly)
[2012-08-01 19:04:03 -0400] jbz: *then* try to automate.
[2012-08-01 19:04:43 -0400] Jay_Levitt: Yeah, good advice.  I'm already seeing why I might not want git hooks (how do I test changes?), but I might not want guard hooks (what if two files are changing and they depend on each other?), etc..
[2012-08-01 19:05:11 -0400] jbz: It's a PITA.
[2012-08-01 19:05:24 -0400] jbz: Chef works great if you have a small, trusted team working on cookbooks
[2012-08-01 19:05:43 -0400] Jay_Levitt: I suspect what I really want is just something that tells me what files I haven't synced yet.. equivalent of git's "modified" flag, but for "deployed".
[2012-08-01 19:05:49 -0400] Jay_Levitt: That would be me!
[2012-08-01 19:05:52 -0400] jbz: The main reason knife flow is helpful is that it auto versions things, and it 'protects' environments
[2012-08-01 19:06:12 -0400] jbz: oh, there is a knife plugin somewhere that diffs local vs. server
[2012-08-01 19:06:14 -0400] jbz: I just saw it
[2012-08-01 19:06:18 -0400] Jay_Levitt: oo!
[2012-08-01 19:06:31 -0400] btm: jbz: knife diff is in the knife-essentials gem.
[2012-08-01 19:06:43 -0400] jbz: btm:  Ahh, thank you.
[2012-08-01 19:06:44 -0400] macros: knife environment diff is very useful
[2012-08-01 19:07:14 -0400] Jay_Levitt: That is BEAUTIFUL
[2012-08-01 19:07:23 -0400] Jay_Levitt: Also fixes my gripe with inconsistency between "from file" and "upload"
[2012-08-01 19:07:24 -0400] ssd7_: knife-essentials is pretty great, really changed my workflow with Chef.
[2012-08-01 19:07:36 -0400] siezer: ~.
[2012-08-01 19:07:38 -0400] siezer: ~.
[2012-08-01 19:07:38 -0400] siezer: ~>
[2012-08-01 19:08:08 -0400] siezer: apprently knife-spork is supposed to help with workflow stuff for larger teams. havent tries it
[2012-08-01 19:09:02 -0400] dwhsix: omg knife env diff where have you been all my life
[2012-08-01 19:09:06 -0400] dwhsix: seriously
[2012-08-01 19:09:21 -0400] Jay_Levitt: oh, just realized knife-spork has nothing to do with spork the fast test runner.
[2012-08-01 19:09:30 -0400] macros: siezer: Last I looked it made some assumtions about the nature of environments that didn't fit with what we do
[2012-08-01 19:09:51 -0400] macros: We constrain searches by environment
[2012-08-01 19:10:42 -0400] Jay_Levitt: knife-essentials needs to be on like page 1 of the quickstart guides.  This solves SO many OOBE pain points.
[2012-08-01 19:10:50 -0400] dpetzel: silly question, but I can't seem to figure it out if I want to setup an env_run list such that its "the default run list + recipe XYZ" what would the syntax be? I've tried a few iterations, they all produce errors
[2012-08-01 19:12:38 -0400] jbz: dpetzel: Stupid q, but what 'default run list'?
[2012-08-01 19:12:49 -0400] dpetzel: http://wiki.opscode.com/display/chef/Roles#Roles-envrunlists
[2012-08-01 19:12:59 -0400] dpetzel: the value of "run_list" in the role file
[2012-08-01 19:14:09 -0400] jbz: Ah. Got me there, sorry.
[2012-08-01 19:14:31 -0400] dpetzel: jbz, no worries,its got me too! :)
[2012-08-01 19:14:53 -0400] leifmadsen: from approximately what version is the cloud attribute available? (sorry, my googling skills appear to have lacked)
[2012-08-01 19:15:06 -0400] dwhsix: ok, maybe knife-essentials knife diff not as awesome as I thought?  tells me server has files like environments/obanyc_prod.json that I don't have locally...
[2012-08-01 19:15:24 -0400] dwhsix: but of course I don't I only have environments/obanyc_prod.rb
[2012-08-01 19:16:12 -0400] dwhsix: is this some holdover? seem to recall that .json files aren't generated anymore for various rb files (e.g. metadata.rb, etc)?
[2012-08-01 19:17:16 -0400] Jay_Levitt: I'm new to Chef and not seeing any metadata.json files generated from my metadata.rb, fwiw
[2012-08-01 19:19:46 -0400] yfeldblum: dwhsix, they were generated and saved to disk in chef 0.9, but they are no longer saved to disk in chef 0.10
[2012-08-01 19:20:07 -0400] yfeldblum: dwhsix, of course, cookbook metadatas are always delivered to the chef-server as JSON, never as ruby
[2012-08-01 19:20:39 -0400] yfeldblum: dwhsix, it's got 0 to do with the version of the chef-server, and 100% to do with the version of knife
[2012-08-01 19:20:50 -0400] dwhsix: yfeldblum: ah, thanks - misunderstood
[2012-08-01 19:21:00 -0400] erick: the files in a cookbook. how can i use my cache server to tell chef get these files? for example, installing  matlab on the machine, i have the binary sitting in the cache already
[2012-08-01 19:22:00 -0400] mattray: erick: they get downloaded as referenced in recipes in your run_list
[2012-08-01 19:22:06 -0400] dwhsix: guess I'm trying to understand why knife-essentials diff name-status is giving me 87 deleted/modified files seems high.  but may ben indication of sloppy practices on our part
[2012-08-01 19:22:17 -0400] mattray: erick: and then hashes get compared for future downloads
[2012-08-01 19:23:38 -0400] erick: mattray: Hi there. thanks. how do i specify that ? normally i put the file inside cookbook_name/files/default/*
[2012-08-01 19:24:08 -0400] mattray: erick: http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-08-01 19:26:26 -0400] erick: mattray: I guess reuse the source attribute?  /mnt/opt/cache_1/matlab_binary
[2012-08-01 19:26:29 -0400] leifmadsen: this probably seems like a standard question, but I'm curious about being able to create an LWRP that isn't tied to a specific cookbook. Is that possible?
[2012-08-01 19:26:35 -0400] erick: mattray: given the full path right?
[2012-08-01 19:27:03 -0400] leifmadsen: or even the ability to use it in another cookbook if I include the cookbook that contains the LWRP in the run_list
[2012-08-01 19:27:42 -0400] mattray: erick: just source "matlab_binary"
[2012-08-01 19:27:58 -0400] yfeldblum: leifmadsen, if cookbook A has a lightweight resource & provider, and you want to use them from cookbook B, then cookbook B must simple put `depends "cookbook A"` into cookbook B's metadata.rb
[2012-08-01 19:28:04 -0400] dwhsix: is there a tool already that does an audit of my chef server against my environment?  still thinking it thru, but mainly check chef nodes+clients against what servers actually exist...
[2012-08-01 19:28:06 -0400] dwhsix: that kind of thing
[2012-08-01 19:28:17 -0400] yfeldblum: leifmadsen, you do not need to have cookbook A in the run-list (but you do need to upload it to the chef-server)
[2012-08-01 19:28:19 -0400] mattray: erick: no path needed
[2012-08-01 19:28:41 -0400] erick: mattray: but then how does it know where to get that resource? i am not sure if i understand that. like where to upload to a new machine i am rolling out?
[2012-08-01 19:28:47 -0400] leifmadsen: yfeldblum: oh awesome, so just a depends in the metadata.rb will get me access to the lwrp in cookbook B which has been defined in cookbook A?
[2012-08-01 19:28:56 -0400] erick: mattray: by just syaing source "matlab_binary"
[2012-08-01 19:28:58 -0400] yfeldblum: leifmadsen, right
[2012-08-01 19:29:10 -0400] leifmadsen: yfeldblum: most excellent -- you've been a great help again. Much obliged!
[2012-08-01 19:29:16 -0400] mattray: erick: cookbook_file is for something you've bundled in the cookbook, so when you do a knife cookbook upload, it's pushed to the server
[2012-08-01 19:29:17 -0400] yfeldblum: leifmadsen, no probs
[2012-08-01 19:29:54 -0400] yfeldblum: leifmadsen, http://wiki.opscode.com/display/chef/Metadata#Metadata-depends
[2012-08-01 19:30:35 -0400] leifmadsen: yfeldblum: thanks again!
[2012-08-01 19:30:47 -0400] erick: mattray: but you don't want to store binary in a cookbook. you mean make a symbolic link called "matlab_binary" inside files directory which is the full path of the binary? and just specify source "matlab_binary"?
[2012-08-01 19:31:27 -0400] mattray: erick: if you want to store a binary in your cookbook and use it for distribution, you can. You put it inside files/default and access it with cookbook_file
[2012-08-01 19:31:43 -0400] erick: mattray: but i dont want that. doesn'
[2012-08-01 19:31:56 -0400] erick: mattray: doesn't cookboo file also get commited to repo?
[2012-08-01 19:32:02 -0400] mattray: erick: yes
[2012-08-01 19:32:04 -0400] mattray: erick: oh, then I misunderstood you
[2012-08-01 19:32:19 -0400] mattray: if you want to pull a file from a remote web server, there's remote_file
[2012-08-01 19:32:23 -0400] mattray: that works well
[2012-08-01 19:34:07 -0400] erick: mattray: Haha,. yeah thats wha ti missed. i think i can also created a symlink if the binary sits on the same server as chef-server and that should work too?
[2012-08-01 19:34:55 -0400] mattray: erick: you're trying to get the chef-server to serve up your file?
[2012-08-01 19:36:49 -0400] erick: mattray: oh no. i have webservices to setup. like mongodb. their binary are huge so i put them in the cache server. so when i provision a new server, i can use my cookbook to install and configure services, which i need the binary.
[2012-08-01 19:36:50 -0400] Jay_Levitt: I want to set the node['postgresql']['password']['postgres'] attribute... doing that in my role's default_attributes() doesn't seem to do it. Where's the right place?
[2012-08-01 19:37:08 -0400] erick: mattray: remote_file will work. just took a look. wondering if a symlink will work too.
[2012-08-01 19:37:51 -0400] mattray: erick: dunno, I don't run a chef-server. I typically just throw up apache on a box somewhere and use that to host files
[2012-08-01 19:37:54 -0400] jbz: Jay_Levitt: You didn't use "node" when you did so, rigth?
[2012-08-01 19:37:57 -0400] Jay_Levitt: right
[2012-08-01 19:38:03 -0400] jbz: OK just checking. :-)
[2012-08-01 19:38:25 -0400] erick: mattray: thats fine.  :))) thanks
[2012-08-01 19:38:41 -0400] erick: mattray: oh btw, can we ssh the file?
[2012-08-01 19:38:52 -0400] mattray: erick: scp?
[2012-08-01 19:38:57 -0400] erick: mattray: oh yes
[2012-08-01 19:39:04 -0400] mattray: good question...
[2012-08-01 19:39:45 -0400] Jay_Levitt: jbz: I did this: https://gist.github.com/5594d2f0b3121c7301c1
[2012-08-01 19:39:52 -0400] mattray: I don't think there's a resource for that (yet), would make a good extension to the openssh cookbook IMO
[2012-08-01 19:40:00 -0400] mattray: s/extension/LWRP/
[2012-08-01 19:40:47 -0400] mattray: patcon: how goes the bittorrent testing?
[2012-08-01 19:41:17 -0400] erick: mattray: Thanks. I will try doing symlink becaus ethe cache is on the same ubuntu as the chef service is running.
[2012-08-01 19:41:39 -0400] patcon: mattray: ah well it worked once (after kickstarting a bunch of chef runs), but i realized it wasn't worth the trouble rather than just pre-installing xcode before the first run :)
[2012-08-01 19:41:40 -0400] yfeldblum: Jay_Levitt, https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/server.rb#L27
[2012-08-01 19:41:47 -0400] mattray: cool. I'll add scp to my wishlist of things to write someday
[2012-08-01 19:42:04 -0400] yfeldblum: Jay_Levitt, you need to set it at normal level or higher
[2012-08-01 19:42:23 -0400] patcon: haha no worries. and thanks again for the help yesterday :)
[2012-08-01 19:42:43 -0400] yfeldblum: Jay_Levitt, normal-level attributes are set by the sysadmin directly on the node using the webui or `knife node edit NODE`, or in a recipe ... and that's probably the intended way to do it
[2012-08-01 19:43:00 -0400] mattray: patcon: I do have something I'm working on for automatically throwing up a mirror for remote files
[2012-08-01 19:43:01 -0400] yfeldblum: Jay_Levitt, you can also set it at the override level in a role, but setting it at the default level in a role won't work
[2012-08-01 19:43:04 -0400] Jay_Levitt: yfeldblum: ah, good - I'd rather do it in a recipe anyway but wasn't sure if that was OK
[2012-08-01 19:43:26 -0400] Jay_Levitt: I'm liking the idea of doing most of this stuff in recipes so I can keep attributes right next to their include_recipe
[2012-08-01 19:43:39 -0400] leifmadsen: hmm perhaps what I'm trying to do with LWRP's don't make sense. The problem I'm trying to solve is essentially, we have a mix of systems in EC2 and non-EC2, running various chef versions from 0.10.8 through 10.12.0. What I want to do is create a simple command I can use in the cookbooks, which will return the correct external IP. The command would try to get an attribute from :cloud first, followed by :ec2 if nil, and th
[2012-08-01 19:43:39 -0400] leifmadsen: en :ipaddress if former is nil
[2012-08-01 19:44:10 -0400] yfeldblum: Jay_Levitt, some people will `knife node edit NODE` and assign the password right there; other people will do something more complex like make a data-bag item with the password, and then make a recipe that fetches that data-bag item, reads the password, and then sets the attribute at the normal level (all from within the recipe)
[2012-08-01 19:44:51 -0400] yfeldblum: Jay_Levitt, indeed, setting a bunch of node attributes (at default or normal levels) and then calling include_recipe is a generally useful technique
[2012-08-01 19:45:26 -0400] yfeldblum: Jay_Levitt, e.g. i might have a recipe in a custom cookbook whose sole job is to set attributes on the node and then delegate to some other recipe using include_recipe
[2012-08-01 19:45:32 -0400] cwj: leifmadsen: perhaps http://cookbooks.opscode.com/cookbooks/discovery is relevant to your interests
[2012-08-01 19:45:58 -0400] bluerose: anyone have any clue
[2012-08-01 19:45:59 -0400] bluerose: https://gist.github.com/3229959
[2012-08-01 19:46:02 -0400] bluerose: what that is
[2012-08-01 19:46:07 -0400] bluerose: its in the mysql cookbook
[2012-08-01 19:46:30 -0400] leifmadsen: cwj: thanks I will check that out -- perhaps at the least it will show me the way to what I want to build :)
[2012-08-01 19:46:36 -0400] Jay_Levitt: yfeldblum: I like that.  At first I thought it would be confusing to have both run_list and role-specific recipes loading recipes, but I'm changing my mind
[2012-08-01 19:46:59 -0400] cwj: leifmadsen: the Discovery.ipaddress method sounds like exactly what you want
[2012-08-01 19:47:05 -0400] cwj: but you be the judge :)
[2012-08-01 19:47:07 -0400] leifmadsen: cwj: for this solution yes it does :)
[2012-08-01 19:47:14 -0400] leifmadsen: thanks much
[2012-08-01 19:47:17 -0400] cwj: np
[2012-08-01 19:47:34 -0400] leifmadsen: moar learning teh betterz :)
[2012-08-01 20:18:19 -0400] obazoud: BryanWB_, have you had time to re-test of my pull request and have a trace of the problem?
[2012-08-01 20:50:36 -0400] leifmadsen: hmmm, attempting to use the Discovery library  and getting " NameError: Cannot find a resource for host on ubuntu version 12.04"
[2012-08-01 20:54:52 -0400] Jay_Levitt: knife diff users: I think there's something I'm missing.. I changed roles/base.rb but didn't "role from file" it yet, and "knife diff roles/*" returns empty, while "knife diff roles/base.rb" returns "/../../../../roles/base.rb: No such file or directory on remote or local"..?
[2012-08-01 20:56:27 -0400] yfeldblum: Jay_Levitt, talking about https://github.com/boundary/knife-plugins ?
[2012-08-01 20:56:41 -0400] Jay_Levitt: yfeldblum: knife-essentials, which I think has a newer version of that
[2012-08-01 21:03:43 -0400] yfeldblum: Jay_Levitt, try `knife diff roles/base` or `knife diff roles/base.json`?
[2012-08-01 21:04:31 -0400] Jay_Levitt: nope, roles/base gives same as roles/base.rb, while roles/base.json claims no difference
[2012-08-01 21:05:43 -0400] cwj: leifmadsen: what version of ruby are you using? that sounds like what ive seen on systems with 1.8.7
[2012-08-01 21:06:20 -0400] cbloss: does anyone know where the github repo is for http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz ? i can't find it and I'd like to fork it to get it to work with CentOS 6 and rvm
[2012-08-01 21:06:29 -0400] leifmadsen: cwj: hmmm, ubuntu 12.04, which I thought was 1.9.1, but I may be wrong. It appears with Discovery.ipaddress() that if I switch from :remote_node => host to :remote_node => node it seems to work
[2012-08-01 21:07:46 -0400] cwj: what kind of object is host? i think it needs to be a node object
[2012-08-01 21:07:54 -0400] cwj: so you search out the node you want and then use it
[2012-08-01 21:08:07 -0400] leifmadsen: cwj: great question... it's possible the example with the word 'host' was not literal
[2012-08-01 21:08:44 -0400] leifmadsen: I haven't been able to find any real-life examples in my search :)
[2012-08-01 21:09:02 -0400] rshade98: is there a way in chef to make all the packages install in one run?
[2012-08-01 21:09:12 -0400] leifmadsen: o.O
[2012-08-01 21:09:26 -0400] leifmadsen: rshade98: what do you mean...
[2012-08-01 21:09:57 -0400] rshade98: if I have a lot of packages it takes a while to install of them
[2012-08-01 21:10:13 -0400] rshade98: right now my way around that is a bash block with all of them
[2012-08-01 21:10:16 -0400] leifmadsen: that's an operation of the OS I'm pretty sure
[2012-08-01 21:10:22 -0400] rshade98: in one yum install
[2012-08-01 21:10:57 -0400] leifmadsen: execute I suppose would work
[2012-08-01 21:11:48 -0400] rshade98: so this is my current code
[2012-08-01 21:11:49 -0400] rshade98: %w{elfutils-libelf-devel glibc-devel gcc gcc-c++ libaio glibc-devel libaio-devel libstdc++ libstdc++ libstdc++-devel libgcc libstdc++-devel unixODBC unixODBC-devel java}.each do |pkg|
[2012-08-01 21:11:49 -0400] rshade98:   package pkg do
[2012-08-01 21:11:49 -0400] rshade98:     action :install
[2012-08-01 21:11:50 -0400] rshade98:   end
[2012-08-01 21:11:50 -0400] rshade98: end
[2012-08-01 21:12:03 -0400] leifmadsen: that's how I do it (ps you should use a pastebin)
[2012-08-01 21:12:13 -0400] rshade98: however that is extensive as it does yum install pkg each time
[2012-08-01 21:12:25 -0400] rshade98: instead of grouping them together in one install
[2012-08-01 21:12:28 -0400] rshade98: yeah sorry
[2012-08-01 21:12:36 -0400] leifmadsen: execute resource with a single command I guess
[2012-08-01 21:12:47 -0400] rshade98: about not pastebining
[2012-08-01 21:13:14 -0400] rshade98: ahh cool, I get what you are saying, but no way to force this by default?
[2012-08-01 21:13:39 -0400] leifmadsen: I just think that's how the package resource works
[2012-08-01 21:14:15 -0400] btm: cbloss: https://gist.github.com/3230801
[2012-08-01 21:15:50 -0400] cbloss: thanks btm
[2012-08-01 21:18:07 -0400] DrBB: I got a question about hosted chef -- how long between running "knife cookbook upload" before a node will see the new cookbook?
[2012-08-01 21:18:21 -0400] mattray: DrBB: seconds?
[2012-08-01 21:18:31 -0400] DrBB: Why the question mark?
[2012-08-01 21:19:10 -0400] DrBB: I ask because I've seen newly created nodes picking up old versions of cookbooks.  It's confusing and frustrating.
[2012-08-01 21:19:22 -0400] DrBB: Is couchDB running in eventually consistent mode or something?
[2012-08-01 21:19:57 -0400] mattray: DrBB: I usually kick off a chef-client run right after the cookbook upload and I don't recall not getting the latest bits
[2012-08-01 21:21:54 -0400] barefoot: do you 'version' your cookbooks? that always bites me
[2012-08-01 21:22:06 -0400] barefoot: when I dont
[2012-08-01 21:22:15 -0400] DrBB: I haven't been versioning them because i'm in a tight debugging loop.
[2012-08-01 21:23:41 -0400] DrBB: If it's designed to be basically instant, then I'm guessing the hosted chef couchdb is doing that thing that nosql stores do where reads don't immediately reflect recent writes.
[2012-08-01 21:25:24 -0400] mattray: the cookbooks aren't stored in couch, they're on S3
[2012-08-01 21:25:33 -0400] yfeldblum: DrBB, they have moved away, or are moving away, from couchdb and toward mysql for storing stuff
[2012-08-01 21:25:57 -0400] DrBB: Well I can definitely appreciate why they'd be motivated to do that.
[2012-08-01 21:25:59 -0400] yfeldblum: mattray, checksums are stored in the db though, not s3, which is how cookbook files would be looked up
[2012-08-01 21:26:06 -0400] mattray: true
[2012-08-01 21:26:13 -0400] yfeldblum: DrBB, why is that?
[2012-08-01 21:27:30 -0400] DrBB: CAP theorm.  You can't have high availability and strong consistency in a data store.  CouchDB opts for eventual consistency -- when you store something in the database it won't necessarily show up in reads the same way immediately, but it will eventually show up that way in all reads.  http://guide.couchdb.org/draft/consistency.html
[2012-08-01 21:28:08 -0400] DrBB: Exactly what I've been seeing -- you upload a cookbook, and create an instance which gets an old version of the cookbook because the datastore hasn't achieved consistency yet.
[2012-08-01 21:29:01 -0400] yfeldblum: DrBB, that's just couch's implementation
[2012-08-01 21:29:24 -0400] DrBB: Yep.  and it's problematic.
[2012-08-01 21:29:31 -0400] yfeldblum: DrBB, dynamo and its derivatives permit per-operation consistency tuning
[2012-08-01 21:30:24 -0400] DrBB: well there's no getting around CAP.  If you want consistency, your datastore will go down sometimes.  It's a tradeoff.
[2012-08-01 21:30:25 -0400] yfeldblum: DrBB, so e.g. with cassandra you can absolutely get this type of strong consistency (block the write till a quorum acknowledges; block the succeeding read till a quorum returns a value)
[2012-08-01 21:30:43 -0400] DrBB: Right.  and those blocks could take a very long time if some of the machines are down.
[2012-08-01 21:31:17 -0400] yfeldblum: DrBB, that's true; but the point is just that what you're seeing might be how couch does it, but now how it could be done with another non-sql data store such as cassandra
[2012-08-01 21:39:31 -0400] Jay_Levitt: DrBB: Curious, have you read the original CAP paper?  I was digging into CAP at a previous job a few months ago and was surprised at what it *doesn't* claim
[2012-08-01 21:40:55 -0400] DrBB: Jay_Levitt: I can't recall if i have or not -- who wrote the original paper?  what surprised you?
[2012-08-01 21:42:20 -0400] Jay_Levitt: Original paper here: http://lpd.epfl.ch/sgilbert/pubs/BrewersConjecture-SigAct.pdf
[2012-08-01 21:44:04 -0400] Jay_Levitt: (re-reading to see what surprises me)
[2012-08-01 21:45:59 -0400] DrBB: Practically speaking, network partitions are going to happen anytime you're running a service on a cluster, and you ignore them at your peril.  So your choice is really between availability and strong consistency.  I've never heard of anybody deliberately building a service that isn't partition tolerant.
[2012-08-01 21:48:46 -0400] Jay_Levitt: that's how I first heard it explained too, but IIRC Brewer didn't define partition tolerance the way we're thinking about it
[2012-08-01 21:49:42 -0400] Jay_Levitt: I don't have enough formal knowledge to work through the proofs, and it's possible something is explained there and not in the text
[2012-08-01 21:51:10 -0400] Jay_Levitt: I *think* the conclusion I came away with is that the way availability and partition tolerance are defined in the paper doesn't really match the way we tend to think of them - e.g. "availability" just means you will receive *a* response (error or no), not a correct one
[2012-08-01 21:51:55 -0400] Jay_Levitt: and since an invalid response over a network partition could be equivalent to a client-side timeout...
[2012-08-01 21:52:24 -0400] Jay_Levitt: it's all Way More Complicated than the "pick two" argument implies.
[2012-08-01 21:53:34 -0400] Jay_Levitt: Link dump of stuff I was reading at the time: https://gist.github.com/b17da46bcda01ddc348c
[2012-08-01 21:53:56 -0400] DrBB: If you aren't partition tolerant then you end up with two different "correct" versions of the data.  At least the store has no way of knowing which is more correct.
[2012-08-01 21:54:44 -0400] DrBB: And you've pushed the problem of resolving the conflict up the stack a layer -- to the app.  This is a lot like a form of eventual consistency, but with help from the app.  Dynamo does this.
[2012-08-01 21:55:09 -0400] yfeldblum: DrBB, BloomL claims to have an answer for that too :P
[2012-08-01 21:55:15 -0400] Jay_Levitt: as does Riak, I think
[2012-08-01 21:56:16 -0400] DrBB: what is "an answer"?
[2012-08-01 21:56:39 -0400] DrBB: Jay_Levitt: thanks for the links
[2012-08-01 21:56:45 -0400] Jay_Levitt: (Riak does what Dynamo does, not Riak claims to have an answer)
[2012-08-01 21:56:50 -0400] yfeldblum: Jay_Levitt, doesn't Riak do MVCC?
[2012-08-01 21:57:45 -0400] Jay_Levitt: yfeldblum: I haven't used it, but a buddy of mine went to work at Basho, and says conflict resolution (and thus consistency) is almost completely thrown up to the app to handle
[2012-08-01 21:57:56 -0400] yfeldblum: DrBB, http://www.eecs.berkeley.edu/Pubs/TechRpts/2012/EECS-2012-167.html
[2012-08-01 21:58:11 -0400] yfeldblum: Jay_Levitt, that is indeed the exact mechanism of MVCC
[2012-08-01 21:58:45 -0400] danryan: ohai chefs! What's the ruby replacement for omnibus?
[2012-08-01 21:59:36 -0400] danryan: if there is one haha. I swear I remember omnibus being replaced by a ruby equiv.
[2012-08-01 22:00:52 -0400] miah: danryan: https://github.com/joemiller/bunchr
[2012-08-01 22:01:10 -0400] danryan: miah: that's the one. Thanks!!
[2012-08-01 22:01:14 -0400] miah: np
[2012-08-01 22:02:20 -0400] DrBB: yfeldblum,  commutative operators provide provably consistent behavior, which is nice.  Google Wave protocol was based on them.  Problem is that the result isn't necessarily what users want.  It's the equivalent of doing automatic merge conflict resolution in source control.  I'm pretty sure I don't want an algorithm doing that for me, even if it's guaranteed to do the same thing every time.
[2012-08-01 22:03:11 -0400] yfeldblum: DrBB, i guess the trick is to construct your data, understanding the merge operators, such that the merging works the right way for your data
[2012-08-01 22:03:15 -0400] gmcinnes: Hi chefs. What's the current best practice for managing third party cookbooks (opscode cookbooks, for example)
[2012-08-01 22:03:15 -0400] DrBB: In some cases you can define commutative operators that make sense for your problem space.  But for something like collaborative document editing, you can't.
[2012-08-01 22:03:16 -0400] Jay_Levitt: yfeldblum: I think of MVCC as relying on the clock to provide consistency, no?
[2012-08-01 22:03:23 -0400] DrBB: yfeldblum -- exactly.
[2012-08-01 22:03:34 -0400] Jay_Levitt: gmcinnes: yfeldblum's librarian-chef.
[2012-08-01 22:03:55 -0400] yfeldblum: Jay_Levitt, no, it's a dependency graph
[2012-08-01 22:04:09 -0400] yfeldblum: Jay_Levitt, cassandra relies on the clock to provide consistency: last-write-wins
[2012-08-01 22:05:59 -0400] Jay_Levitt: yfeldblum: I didn't realize there was a graph; serves me right for refreshing my memory with wikipedia's explanation
[2012-08-01 22:06:47 -0400] Jay_Levitt: which implies that the conflicts are eventually closed out when the write completes
[2012-08-01 22:07:19 -0400] Jay_Levitt: whereas in Riak, the conflicts are closed out by (mumble-hand-wave) the application layer based on any criteria it likes
[2012-08-01 22:08:07 -0400] Jay_Levitt: ie it's not necessarily a dependency graph; it could be highest value, or alphabetically first, or random, or whatever you like
[2012-08-01 22:10:51 -0400] yfeldblum: Jay_Levitt, git does MVCC: it retains a graph of versions, and you (acting as the application layer) merge them
[2012-08-01 22:11:20 -0400] Jay_Levitt: yfeldblum: ah, good metaphor.  I was thinking postgres-centrically
[2012-08-01 22:25:55 -0400] Jay_Levitt: speaking of postgres.. how can I override the default pg_hba.conf.erb template?  I don't see an obvious way (besides forking, ick)
[2012-08-01 22:25:56 -0400] gmcinnes: ok. totally +1 librarian-chef :)
[2012-08-01 22:25:59 -0400] gmcinnes: thanks guys!
[2012-08-01 22:29:41 -0400] Jay_Levitt: Hmm, looks like this is COOK-332.
[2012-08-01 22:31:31 -0400] beandip: oh cool
[2012-08-01 22:31:43 -0400] beandip: so librarian will unhinge my cookbooks from git
[2012-08-01 22:31:48 -0400] beandip: niiiice
[2012-08-01 22:32:13 -0400] beandip: rather, from my chef-repo in git
[2012-08-01 22:32:24 -0400] yfeldblum: beandip, yep
[2012-08-01 22:32:47 -0400] beandip: yfeldblum, this your doing?
[2012-08-01 22:32:54 -0400] yfeldblum: beandip, yep
[2012-08-01 22:33:04 -0400] beandip: You beautiful bastard
[2012-08-01 22:33:16 -0400] beandip: I could give y ou a hairy man-kiss for this
[2012-08-01 22:33:18 -0400] Jay_Levitt: "Jay Tiberius Feldblum, are you responsible for this?"
[2012-08-01 22:34:24 -0400] yfeldblum: heh thanks
[2012-08-01 22:34:59 -0400] beandip: I will lick your tonsils with delight
[2012-08-01 22:35:34 -0400] yfeldblum: gotta give credit to those who came before: the bundler crew (carl lerche, yehuda katz, andre arko, et al) and @hedgehog
[2012-08-01 22:35:41 -0400] Jay_Levitt: HR!
[2012-08-01 22:35:48 -0400] beandip: huzzah!
[2012-08-01 22:38:47 -0400] yfeldblum: you can also take a look at berkshelf by @riotgames, which serves a very similar purpose to (aka: is a competitor of) librarian-chef
[2012-08-01 22:39:15 -0400] yfeldblum: mattray, everything must be tweeted ... everything!
[2012-08-01 22:39:29 -0400] mattray: I found that one quite funny
[2012-08-01 22:40:42 -0400] beandip: yfeldblum: can you summarize the differences between the two?
[2012-08-01 22:41:54 -0400] Jay_Levitt: (adds @mattray)
[2012-08-01 22:42:06 -0400] yfeldblum: Jay_Levitt, be sure to add @skittles
[2012-08-01 22:42:59 -0400] Jay_Levitt: why??
[2012-08-01 22:44:22 -0400] yfeldblum: Jay_Levitt, skittles are delicious and @skittles is ridiculous
[2012-08-01 22:44:31 -0400] Jay_Levitt: you make good aguments
[2012-08-01 22:45:03 -0400] Jay_Levitt: I think if I wanted ridiculous tweets I'd follow @dhh again
[2012-08-01 22:46:30 -0400] yfeldblum: beandip, i couldn't do it justice to everyone's liking
[2012-08-01 22:48:08 -0400] yfeldblum: beandip, but feel free to try using both with some testing chef-repo's
[2012-08-01 22:48:10 -0400] mattray: beandip: there was this: http://christian-trabold.de/librarian-chef-vs-berkshelf
[2012-08-01 22:50:28 -0400] yfeldblum: beandip, it's like going from a set of perl CGI scripts to your choice of rails or merb (back before merb and rails merged to become rails 3, of course)
[2012-08-01 22:51:21 -0400] yfeldblum: beandip, or going from a horse to your choice of Ford or Chrysler
[2012-08-01 23:10:08 -0400] Jay_Levitt: WHY ISN'T LIBRARIAN LIKE NODEJS
[2012-08-01 23:10:29 -0400] yfeldblum: hm?
[2012-08-01 23:13:26 -0400] Jay_Levitt: I was "complaining" that librarian is like rails or merb when it should be like nodejs.
[2012-08-01 23:14:58 -0400] Jay_Levitt: (I have no idea what that would actually mean, of course.)
[2012-08-01 23:15:22 -0400] flaccid: librarian rules
[2012-08-01 23:16:07 -0400] flaccid: coderanger: are you cool if i fork and contrib/pull enhancements to your collectd cookbook? i was suprised to see how old the last commit was but still working nice!
[2012-08-01 23:16:20 -0400] coderanger: Please do :)
[2012-08-01 23:16:28 -0400] coderanger: make sure its the one under coderanger
[2012-08-01 23:16:31 -0400] coderanger: not AtariTech
[2012-08-01 23:16:41 -0400] flaccid: coderanger: the cookbooks site is out of date then..
[2012-08-01 23:16:51 -0400] flaccid: can you update?
[2012-08-01 23:16:52 -0400] coderanger: Quite possible :)
[2012-08-01 23:16:58 -0400] bluckau1: Can Chef be used to administer a chroot environment or a Linux Container (LXC), etc. instead of a running host?  Or any type of image that can later be applied to host(s) ?
[2012-08-01 23:17:16 -0400] flaccid: coderanger: cheers, i'll update my side to get off of the atari
[2012-08-01 23:18:21 -0400] coderanger: updated
[2012-08-01 23:18:44 -0400] coderanger: then newer ones should be easier to work with too, back to the normal one-cookbook-per-repo model
[2012-08-01 23:37:53 -0400] bakins: bluckau1: should be fine. It just manipulates files and calls commands. I haven't tried it, but should work
[2012-08-01 23:42:36 -0400] yfeldblum: Jay_Levitt, https://github.com/applicationsonline/librarian/blob/v0.0.24/lib/librarian/resolver/implementation.rb#L35-101 ... i don't want to even try that in nodejs's callbacks hell
[2012-08-01 23:43:09 -0400] Jay_Levitt: ha! I've done plenty of callback-based programming but never even attempted recursion
[2012-08-01 23:43:14 -0400] Jay_Levitt: iteration was painful enough
[2012-08-01 23:48:38 -0400] Jay_Levitt: side note: if folks haven't discovered defunkt/hub, it's wonderful for grabbing all your favorite pull requests into your fork of a cookbook: https://gist.github.com/d7fd713d991daad1e223
[2012-08-01 23:54:07 -0400] flaccid: coderanger: thanks y0 i will check it out now
