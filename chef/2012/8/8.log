[2012-08-08 00:14:00 -0400] flaccid_: what is the de facto method to deploy a remote tarball e.g. for an application?
[2012-08-08 00:32:04 -0400] beandip: I'm stumped here
[2012-08-08 00:32:22 -0400] beandip: I have an ubuntu 10.04 node spun up with the rackspace knife plugin
[2012-08-08 00:32:45 -0400] beandip: I'm using a cookbook that needs bunlder
[2012-08-08 00:32:48 -0400] beandip: bundler
[2012-08-08 00:33:00 -0400] beandip: I get STDERR: ERROR:  Error installing bundler:
[2012-08-08 00:33:02 -0400] beandip: bundler requires RubyGems version >= 1.3.6
[2012-08-08 00:33:32 -0400] beandip: earlier I spun up an identical node and tried solving the gem version issue using the rvm cookbook but no dice
[2012-08-08 00:33:52 -0400] beandip: hoover_damm: you seemed to know what was going on until I mentioned rvm
[2012-08-08 00:34:05 -0400] beandip: now I'm spinning up the node without the rvm cookbook
[2012-08-08 00:34:11 -0400] beandip: any ideas on how to solve this?
[2012-08-08 00:39:41 -0400] cheeseplus: anybody running a centos or redhat node and could check something in ohai for me?
[2012-08-08 00:40:10 -0400] cheeseplus: curious what the node[:lsb][:codename] resolves to
[2012-08-08 00:42:49 -0400] flaccid_: cheeseplus: um i'll find one, sec
[2012-08-08 00:43:15 -0400] cheeseplus: thanks, logging into my home smartOS box but it's taking a second from where I am at
[2012-08-08 00:44:16 -0400] cheeseplus: I am very guilty of coding a cookbook block just for ubuntu/debian at the time and am now paying for it
[2012-08-08 00:44:16 -0400] flaccid_: cheeseplus: well a quick run of ohai shows "codename": "Final"
[2012-08-08 00:44:21 -0400] cheeseplus: I has done a bad thing
[2012-08-08 00:44:21 -0400] flaccid_: which is correct per lsb_release
[2012-08-08 00:44:22 -0400] flaccid_: the use redhat lameness. this is centos 5.8
[2012-08-08 00:45:01 -0400] cheeseplus: flaccid_: thanks, looks like I'll just use some when statements and code around it
[2012-08-08 00:45:40 -0400] gmcinnes1: cheeseplus: hmm. It doesn't seem to be set on mine.
[2012-08-08 00:46:02 -0400] cheeseplus: gmcinnes1: centos or red hat?
[2012-08-08 00:46:35 -0400] gmcinnes1: centos
[2012-08-08 00:46:36 -0400] flaccid_: i recommend node['platform'], value_for_platform etc. per the wiki docs
[2012-08-08 00:47:04 -0400] cheeseplus: flaccid_: will definitely do that where appropriate
[2012-08-08 00:47:15 -0400] gmcinnes1: os_version is 2.6.32-131.21.1.el6.x86_64
[2012-08-08 00:47:24 -0400] flaccid_: and there is the 'release' key instead of codename
[2012-08-08 00:47:24 -0400] gmcinnes1: platform_version 6.1
[2012-08-08 00:47:34 -0400] cheeseplus: the issue is that for ubuntu specificially, our releng has decided to name the folders based on codename instead of version number
[2012-08-08 00:47:40 -0400] cheeseplus: so precise vs 12.04
[2012-08-08 00:47:56 -0400] cheeseplus: he didn't want to deal with the regex
[2012-08-08 00:50:32 -0400] flaccid_: if you need to store like that which you probably don't, but you want 'release' not 'codename'
[2012-08-08 00:53:17 -0400] cheeseplus: flaccid_: I'll check that out then, I grepped through ohai data and codename came up first
[2012-08-08 00:53:44 -0400] hoover_damm: beandip, gem --version reports 1.3.5?
[2012-08-08 00:53:50 -0400] hoover_damm: beandip, you've glanced over that for how long?
[2012-08-08 00:57:14 -0400] flaccid_: cheeseplus: you may want to save output of ohai data to a text file for perusal as grep is going to cut out some of the keys due to the json being over multiple lines..
[2012-08-08 00:57:43 -0400] cheeseplus: flaccid_: looks like I may make use of platform_family for centos/rhel
[2012-08-08 00:57:57 -0400] cheeseplus: since we lump centos as rhel for our binaries
[2012-08-08 00:58:34 -0400] cheeseplus: or I can just threaten my releng with a large stick
[2012-08-08 01:00:03 -0400] flaccid_: whats wrong with flaccid_: i recommend node['platform'], value_for_platform etc. per the wiki docs
[2012-08-08 01:00:04 -0400] flaccid_: but yes platform_family if applicable
[2012-08-08 01:00:08 -0400] flaccid_: beat it with da stick!
[2012-08-08 01:00:08 -0400] flaccid_: there are better drugs than redhat
[2012-08-08 01:01:02 -0400] cheeseplus: flaccid_: yea, it's for clients who use our cookbook
[2012-08-08 01:01:09 -0400] cheeseplus: we don't mess with that nonsense ;)
[2012-08-08 01:01:32 -0400] cheeseplus: well, except for maintaining it for said clients obviously
[2012-08-08 01:02:20 -0400] cheeseplus: we typically run ubuntu or smartOS internally hence why I didn't catch this particular issue earlier
[2012-08-08 01:05:30 -0400] cheeseplus: thanks for the assist flaccid_, battery is getting ready to give up the ghost
[2012-08-08 01:06:27 -0400] flaccid_: np
[2012-08-08 01:16:51 -0400] beandip: Anyone?
[2012-08-08 01:33:11 -0400] flaccid_: beandip: i'll have a big mac with a large coke
[2012-08-08 01:41:09 -0400] beandip: flaccid_: gladly if you can help me solve my problem up above
[2012-08-08 01:44:31 -0400] stormerider: beandip: did you see what hoover_damm mentioned a little bit ago?
[2012-08-08 01:44:32 -0400] flaccid_: beandip: obviously you need to fix the ruby/gems
[2012-08-08 01:45:32 -0400] flaccid_: ensure RubyGems version >= 1.3.6 is installed.
[2012-08-08 01:56:47 -0400] flaccid_: hoover_damm: beandip, gem --version reports 1.3.5?
[2012-08-08 01:57:17 -0400] beandip: hold on a sec.  Spinning up a fresh node
[2012-08-08 01:57:24 -0400] beandip: with my base role
[2012-08-08 01:57:24 -0400] flaccid_: [10:53am] hoover_damm: beandip, you've glanced over that for how long?
[2012-08-08 01:57:28 -0400] beandip: then I'll let you know
[2012-08-08 01:59:19 -0400] beandip: ok, my base role doesn't install ruby or gem
[2012-08-08 01:59:35 -0400] beandip: so now I'll add the role for my app
[2012-08-08 02:05:19 -0400] beandip: yes, gem -v shows 1.3.5
[2012-08-08 02:06:52 -0400] flaccid_: update the gem
[2012-08-08 02:07:14 -0400] beandip:     gem update --system is disabled on Debian. RubyGems can be updated using the official Debian repositories by aptitude or apt-get.
[2012-08-08 02:08:20 -0400] hoover_damm: that is pure irony there
[2012-08-08 02:08:20 -0400] flaccid_: there is also doc on how to use gems on the rubygems site and a #rubygems channel for help
[2012-08-08 02:08:21 -0400] flaccid_: correct
[2012-08-08 02:08:33 -0400] beandip: lol
[2012-08-08 02:08:35 -0400] beandip: yarp
[2012-08-08 02:08:48 -0400] flaccid_: how is it ironic?
[2012-08-08 02:09:12 -0400] flaccid_: but yeah if you search or whatever, iirc there is a env var or similar you can set so you can bypass that
[2012-08-08 02:09:37 -0400] beandip: ?
[2012-08-08 02:09:45 -0400] flaccid_: ?
[2012-08-08 02:09:46 -0400] beandip: I've been googlin' all day
[2012-08-08 02:09:55 -0400] beandip: help a brother out
[2012-08-08 02:10:20 -0400] hoover_damm: beandip, this is ree from source? deb?
[2012-08-08 02:11:21 -0400] flaccid_: did you first check the deb packages? thats the right thing to do
[2012-08-08 02:11:28 -0400] beandip: rubygems package from ubuntu 10.04
[2012-08-08 02:11:29 -0400] flaccid_: i don't even know what release you are running to do that for you
[2012-08-08 02:11:46 -0400] stormerider: flaccid_: isnt it ironic because debian lags behind in packaging things like ruby?
[2012-08-08 02:11:49 -0400] hoover_damm: basically he uttered rvm and I stopped paying attention to irc...
[2012-08-08 02:12:06 -0400] beandip: hoover_damm: Ispun this node up without the rvm cookbook
[2012-08-08 02:12:14 -0400] hoover_damm: beandip, so we have REE from deb?
[2012-08-08 02:12:28 -0400] hoover_damm: beandip, well heck even source would install rubygems 1.3.5 it just shouldn't have that debian lock
[2012-08-08 02:12:54 -0400] hoover_damm: btw the fix is gem install rubygems-update update_rubygems
[2012-08-08 02:12:55 -0400] flaccid_: stormerider: i don't see that as ironic but i take your point
[2012-08-08 02:13:23 -0400] hoover_damm: stormerider, distributions are generally a slow wheel
[2012-08-08 02:13:24 -0400] flaccid_: eh i helped a colleague with this the other day on ubuntu
[2012-08-08 02:13:27 -0400] flaccid_: i'll get you da override
[2012-08-08 02:13:47 -0400] beandip: flaccid_: you're awesome!
[2012-08-08 02:14:10 -0400] stormerider: hoover_damm: as someone recently moving away from centos 5, i cant argue in the slightest, heh
[2012-08-08 02:14:25 -0400] hoover_damm: stormerider, as they work by releases... to update ruby for 12.10 you have to get the package in before 12.10 freezes ... otherwise you wait for the next release in 6months
[2012-08-08 02:14:25 -0400] flaccid_: eh its not in chat cache, back to google i go
[2012-08-08 02:15:08 -0400] stormerider: that's assuming all distros have a 6mo cycle, which would be optimistic, heh
[2012-08-08 02:15:12 -0400] hoover_damm: stormerider, so I would actually put the blame equally on the ruby community and the ubuntu community for not hugging each other and forgiving each other and working together.
[2012-08-08 02:16:19 -0400] stormerider: hoover_damm: beandip is also using 10.04 if i read their message right so it being out of date at that point is to be expected anyways
[2012-08-08 02:16:56 -0400] hoover_damm: he's running 10.04 when 12.04 is the current LTS
[2012-08-08 02:17:01 -0400] hoover_damm: he should expect to get his knee skinned
[2012-08-08 02:17:44 -0400] flaccid_: beandip: well i must be a pro with google coz this came up on first search, first result http://stackoverflow.com/questions/3643870/gem-update-system-is-disabled-on-debian-error
[2012-08-08 02:17:48 -0400] flaccid_: aka just remove rubygems package and install it from source
[2012-08-08 02:18:14 -0400] hoover_damm: flaccid_, gem install rubygems-update && update_rubygems
[2012-08-08 02:18:14 -0400] flaccid_: yep, over 2 years old there
[2012-08-08 02:18:19 -0400] hoover_damm: flaccid_, technically that's easier
[2012-08-08 02:18:21 -0400] hoover_damm: but whatever
[2012-08-08 02:18:29 -0400] hoover_damm: flaccid_, it's a whole bag of pain
[2012-08-08 02:20:49 -0400] flaccid_: i don't see removing 1 package as a pain.
[2012-08-08 02:21:05 -0400] hoover_damm: flaccid_, two commands vs remove, wget, untar, install
[2012-08-08 02:21:11 -0400] hoover_damm: at this point we're splitting hairs
[2012-08-08 02:23:06 -0400] flaccid_: sure, but then the package gets updated or reinstalled and your gems install is broken.
[2012-08-08 02:24:12 -0400] stuartrexking: I am seeing this error on 10.12 https://gist.github.com/229600980dd7d6ccb598 I think it's related to http://tickets.opscode.com/browse/CHEF-3218 which has a workaround. How exactly would I implement that workaround?
[2012-08-08 02:24:54 -0400] hoover_damm: flaccid_, you forget people don't update... they just walk away
[2012-08-08 02:24:56 -0400] stuartrexking: If I change the default false value of disable_gzip to default as true in rest.rb I don't get the error. Any idea how I would do this from my recipe so not to touch the chef source?
[2012-08-08 02:26:53 -0400] flaccid_: hoover_damm: can't say i agree with that in my experience
[2012-08-08 02:27:50 -0400] flaccid_: i don't discount any possibility :)
[2012-08-08 02:29:03 -0400] hoover_damm: flaccid_, I just find that people view the world as much more disposable
[2012-08-08 02:29:32 -0400] hoover_damm: flaccid_, you see a lot of noops and devops in here more then regular sysadmin/engineers and they're just trying to solve a problem.
[2012-08-08 02:29:42 -0400] hoover_damm: flaccid_, they'll often forget about their pain with chef 6months from now
[2012-08-08 02:29:43 -0400] flaccid_: i find that people love to hack and take shortcuts instead of doing the right thing
[2012-08-08 02:29:59 -0400] hoover_damm: that's always the case
[2012-08-08 02:29:59 -0400] flaccid_: sorry, i just prefer education over shortcuts
[2012-08-08 02:30:37 -0400] hoover_damm: there is no formal education really to do ops
[2012-08-08 02:30:38 -0400] flaccid_: pretty sure we are in agreeance here at the end of the day
[2012-08-08 02:30:50 -0400] yfeldblum: hoover_damm, i find in here many people who are a mixture between trying to build (stand up) systems and trying to maintain systems
[2012-08-08 02:30:52 -0400] hoover_damm: however I would say that people who handle procedures well (repeative) might do well
[2012-08-08 02:30:52 -0400] beandip: heyHey, sorry
[2012-08-08 02:30:57 -0400] beandip: got caught in a conversation
[2012-08-08 02:31:08 -0400] beandip: You set me on a path that might pan out here
[2012-08-08 02:31:12 -0400] beandip: update you in a bit
[2012-08-08 02:31:18 -0400] hoover_damm: yfeldblum, and there's a little bit to the left beyond that too no?
[2012-08-08 02:31:31 -0400] yfeldblum: hoover_damm, hm?
[2012-08-08 02:34:01 -0400] yfeldblum: hoover_damm, on the extreme side you have build-only (kind of like netflix), which bears a striking resemblance to pure functional programming: values already in existence are immutable, and to change something means to make a new version of it that is changed
[2012-08-08 02:34:02 -0400] flaccid_: versioning is a no brainer. if you use a non rolling release distro, you are bound to the release versions. nothing new here..
[2012-08-08 02:34:33 -0400] hoover_damm: yfeldblum, yep
[2012-08-08 02:35:32 -0400] yfeldblum: hoover_damm, (that's the side i favor, incidentally)
[2012-08-08 02:35:33 -0400] flaccid_: i believe in flexibility and just doing things as correct as possible
[2012-08-08 02:36:29 -0400] yfeldblum: hoover_damm, in that type of infrastructure, if you want to change something about a server, you build a new machine image, launch a cluster of machines from that image, rebalance public endpoints to the new machines, and garbage-collect the old machines when your wallet's running low
[2012-08-08 02:37:18 -0400] hoover_damm: yep yep
[2012-08-08 02:37:33 -0400] yfeldblum: hoover_damm, but it's hard :P
[2012-08-08 02:39:10 -0400] hoover_damm: yfeldblum, no one said nothing worth having was easy
[2012-08-08 02:46:41 -0400] flaccid_: water is
[2012-08-08 02:47:07 -0400] flaccid_: :)
[2012-08-08 02:48:50 -0400] beandip: ok
[2012-08-08 02:48:56 -0400] beandip: so here's where I am now.
[2012-08-08 02:49:41 -0400] beandip:  I found that I was doing the version attribute on the ruby cookbook incorrectly.  Fixed that and specified ruby 1.9
[2012-08-08 02:49:55 -0400] beandip: bootstrapped a new node and gave it my base role
[2012-08-08 02:50:07 -0400] beandip: ran chef, no ruby installed
[2012-08-08 02:50:20 -0400] beandip: added my graylog2 recipe to the runlist
[2012-08-08 02:50:26 -0400] beandip: ran chef
[2012-08-08 02:51:11 -0400] beandip: sorry, added the graylog2 recipe and the ruby recipe with ruby running first
[2012-08-08 02:51:14 -0400] beandip: ran chef
[2012-08-08 02:51:30 -0400] beandip: the logs say that ruby 1.9 installed successfully
[2012-08-08 02:51:43 -0400] beandip: graylog2 installs and starts up
[2012-08-08 02:51:57 -0400] beandip: I run gem -v and it gives me 1.3.5
[2012-08-08 02:52:20 -0400] beandip: I then run chef again and it fails with the error on gem 1.3.5 with bundle
[2012-08-08 02:52:23 -0400] beandip: bundler
[2012-08-08 02:52:55 -0400] beandip: I'm looking through the graylog cookbook and the logs from the successful run and I can't fuckin see where gem 1.3.5 is coming from
[2012-08-08 02:53:15 -0400] stormerider: id break it apart... you put two steps together without testing in the middle, imo
[2012-08-08 02:53:17 -0400] jtimberman: beandip: probably the default rubygems package on your distribution?
[2012-08-08 02:53:33 -0400] jtimberman: what distribution?
[2012-08-08 02:53:42 -0400] stormerider: jtimberman: ubuntu 10.04 iirc
[2012-08-08 02:53:43 -0400] beandip: ubuntu 10.04
[2012-08-08 02:53:56 -0400] beandip: and yes, it's the default rubygems package
[2012-08-08 02:54:02 -0400] jtimberman: yeah
[2012-08-08 02:54:03 -0400] beandip: not sure where it's being installed though
[2012-08-08 02:54:09 -0400] beandip: so I can prevent it
[2012-08-08 02:54:17 -0400] jtimberman: beandip: which gem ?
[2012-08-08 02:54:27 -0400] jtimberman: like, run which gem at the command line :)
[2012-08-08 02:54:42 -0400] beandip: /usr/bin/gem
[2012-08-08 02:55:07 -0400] beandip: which points at /etc/alternatives/gem
[2012-08-08 02:55:34 -0400] beandip: which in turn points at /usr/bin/gem1.8
[2012-08-08 02:55:49 -0400] jtimberman: yup
[2012-08-08 02:55:56 -0400] jtimberman: well, thats good they're using the alternatives system :)
[2012-08-08 02:56:02 -0400] beandip: gem -v returns 1.3.5
[2012-08-08 02:56:05 -0400] jtimberman: are you trying to get ruby 1.9?
[2012-08-08 02:56:14 -0400] jtimberman: you want ruby1.9.1 as the package name.
[2012-08-08 02:56:28 -0400] jtimberman: and rubygems (1.3.7) is in the stdlib
[2012-08-08 02:56:43 -0400] beandip: jtiberman, yes
[2012-08-08 02:56:44 -0400] stormerider: beandip: if 10.04 is like 12.04, changing ruby via update-alternatives also changes gem
[2012-08-08 02:57:26 -0400] stormerider: and 1.8 and 1.9 get installed together side by side
[2012-08-08 02:57:54 -0400] stormerider: obv i dont know what the cookbook is doing, just observations from working on my desktop
[2012-08-08 02:59:12 -0400] beandip: jtiberman, shouldn't the ruby cookbook be doing that for me when I specify the ruby 1.9 version in the overide attributes?
[2012-08-08 02:59:13 -0400] flaccid_: beandip: can you link me to the ruby cookbook you are using?
[2012-08-08 02:59:44 -0400] beandip: flaccid_: jtiberman's cook book at http://community.opscode.com/cookbooks/ruby
[2012-08-08 03:01:44 -0400] flaccid_: and i thought i just recently advised the fix to remove the rubygems package and install new gem..
[2012-08-08 03:02:04 -0400] flaccid_: *rubygems
[2012-08-08 03:02:16 -0400] stormerider: flaccid_: they're looking to fix the chef config, not fix a specific instance, as i understand it
[2012-08-08 03:02:25 -0400] beandip: exactly
[2012-08-08 03:02:25 -0400] flaccid_: i don't think you have done anything that we suggested earlier beandip otherwise you would not be on 1.3.5.
[2012-08-08 03:02:52 -0400] beandip: flaccid_: I can obviously write a specific recipe to fix this manually
[2012-08-08 03:03:32 -0400] beandip: I'm trying to figur out where the hell gem 1.3.5 is being installed from when I'm specifying 1.9 in the override attributes for the ruby cookbook and seeing the output say that 1.9 is installed
[2012-08-08 03:03:32 -0400] flaccid_: jtimberman: i have a ruby cookbook too, for some reason i didn't see this one, so i will see if there is anything to contrib back and switch
[2012-08-08 03:04:33 -0400] flaccid_: how does the 'chef config' depict using rubygems 1.3.5 ?
[2012-08-08 03:04:39 -0400] stormerider: beandip: if you look in /etc/alternatives, is ruby pointing to 1.8 or 1.9?
[2012-08-08 03:05:14 -0400] beandip: stormerider 1.8
[2012-08-08 03:05:23 -0400] beandip: flaccid, I didn't see your ruby cookbook
[2012-08-08 03:05:23 -0400] flaccid_: beandip: where is the chef and ruby install and config coming from though? rackspace, an image some other provisioner?
[2012-08-08 03:05:52 -0400] beandip: flaccid, I'm using the knife rackspace plugin
[2012-08-08 03:05:53 -0400] flaccid_: well cloud providers like rackspace provide images which have things installed in them
[2012-08-08 03:06:22 -0400] beandip: and I confirmed prior to running the ruby recipes that ruby was not installed on the base system
[2012-08-08 03:09:31 -0400] stormerider: beandip: i could be wrong but im not seeing in that cookbook where it updates the alternatives away from ruby1.8 tools (which, as i said, get installed alongside 1.9)... it just installs the packages.
[2012-08-08 03:09:59 -0400] stormerider: first i would check if doing "update-alternatives --config ruby" and selecting 1.9/1.9.1 will show the correct gem version
[2012-08-08 03:10:25 -0400] stormerider: and if so, expand the recipe to exec an automated version of that
[2012-08-08 03:10:48 -0400] beandip: ~# update-alternatives --config ruby
[2012-08-08 03:10:50 -0400] beandip: update-alternatives: error: no alternatives for ruby.
[2012-08-08 03:11:04 -0400] stormerider: not having 10.04 handy (nor wanting to) i cant tell if gem1.8 and gem1.9 are the same or different versions
[2012-08-08 03:11:49 -0400] stormerider: er, but you said 1.9 was installed?
[2012-08-08 03:12:25 -0400] beandip: [Wed, 08 Aug 2012 03:09:40 +0000] INFO: Processing package[ruby1.9.1] action install (ruby::1.9.1 line 73)
[2012-08-08 03:12:27 -0400] jtimberman: beandip: so uh, that cookbook hasn't been maintained in awhile, and i have a backlog item to "reinstate" it now that we have a more pressing need to install a ruby aside from chef's (chef-full package)
[2012-08-08 03:12:28 -0400] beandip: [Wed, 08 Aug 2012 03:09:44 +0000] INFO: package[ruby1.9.1] installed version 1.9.1.378-1
[2012-08-08 03:12:44 -0400] beandip: jtiberman
[2012-08-08 03:12:49 -0400] jtimberman: gem1.8 and gem1.9.1 are different :)
[2012-08-08 03:12:58 -0400] beandip: I'll look at flaccid's cookbook
[2012-08-08 03:12:59 -0400] beandip: :)
[2012-08-08 03:13:04 -0400] PRK_nz: I'm looking at updating our Chef server from 0.10.8 to 10.12.0, the directions here: http://wiki.opscode.com/display/chef/Upgrading+Chef+0.10.x+to+the+newest+version+of+Chef have a heading for updating if install via Gem, apt-get or yum, but the instructions don't seem to include anything but gem updating instructions. Is it just as simple as updating regular packages via apt-get?
[2012-08-08 03:13:23 -0400] jtimberman: beandip: :D
[2012-08-08 03:30:25 -0400] beandip: flaccid, I'm going to give your ruby recipe a shot
[2012-08-08 03:30:34 -0400] beandip: and your rubygems
[2012-08-08 03:30:35 -0400] flaccid_: beandip, jtimberman well i didn't do the update-alternatives command in my cookbook becuase the packages should do this, if they don't i can add back in, but my goal will be to pull request anything in my ruby cookbook that the official one is missing, will get around to this in the near future
[2012-08-08 03:32:46 -0400] stormerider: flaccid_: ubuntu keeps 1.8 by default even in 12.04
[2012-08-08 03:36:26 -0400] flaccid_: well i havnt actually identified your issue yet beandip because you havnt provided details on the provisioning
[2012-08-08 03:38:44 -0400] flaccid_: stormerider: the default recipe installs ruby package, what version it is is what version it is
[2012-08-08 03:39:01 -0400] flaccid_: you can change this with an attribute
[2012-08-08 03:41:04 -0400] flaccid_: this is also separate to rubygems to which i made a cookbook for that as well
[2012-08-08 03:41:20 -0400] flaccid_: albeit both are limited until other needs are identified
[2012-08-08 04:39:26 -0400] japearson: hey I was just wondering how I can hook in scripts to run during a knife ec2 command? Specifically I need to stop yum-updatesd while the create command runs
[2012-08-08 04:47:29 -0400] stormerider: japearson: so im not sure what AMI you're using, but i would assume you need to ensure that the knife bootstrap process happens before yum-updatesd is started in the runlevel, or if that's not the problem precisely, then you just need to write an execute block that can stop/start it as needed and put it in your runlist to stop at the beginning and start it at the end
[2012-08-08 04:48:10 -0400] stormerider: specifically, if it runs before sshd, that's likely to be a problem (i believe, i havent looked at exactly how knife-ec2 works [yet])
[2012-08-08 04:58:13 -0400] stormerider: "This process does not set up the Chef Client service, you'll need to add a recipe in the run list that does this." -- that's handy for me to know. and yes, it does operate over ssh to bootstrap the node.
[2012-08-08 05:08:28 -0400] japearson: stormerider: Thanks, we're using the amazon linux ami, yeah I've seen it operate over ssh, because it waits for the machine to have ssh first. I think I might need to create a custom template
[2012-08-08 05:08:34 -0400] BryanWB_: ohai chefs!
[2012-08-08 05:38:19 -0400] stuartrexking: Usin the application_python recipe, how would I install dependencies from requirements.txt for a non-django python application using gunicorn?
[2012-08-08 05:38:53 -0400] stuartrexking: A flask app, to be precise.
[2012-08-08 06:02:43 -0400] miah: hi
[2012-08-08 06:17:11 -0400] ssd7: Ohai Chefs!
[2012-08-08 06:26:51 -0400] stormerider: heyla ssd7
[2012-08-08 06:43:04 -0400] stormerider: arg. ok, so this is slightly-offtopic but germane to a common chef usage scenario, i think.
[2012-08-08 06:43:50 -0400] stormerider: im looking to have chef nodes in multiple AWS regions. how do i lock down the chef host to just my traffic without assigning elasticips to every node in the foreign regions?
[2012-08-08 06:44:16 -0400] stormerider: since security groups are (*grumble*) not linked between regions.
[2012-08-08 06:46:48 -0400] stormerider: or does chef have the concept of slave servers that i can use for this purpose?
[2012-08-08 06:47:44 -0400] miah: do you use VPC?
[2012-08-08 06:47:47 -0400] stormerider: frak, this will apply to splunk as well.
[2012-08-08 06:47:50 -0400] stormerider: no.
[2012-08-08 06:47:56 -0400] miah: ah..
[2012-08-08 06:48:09 -0400] miah: if you were using vpc you could vpn them together
[2012-08-08 06:48:28 -0400] miah: its a bit trickier when you're dealing with the completely random ec2 ip's
[2012-08-08 06:48:56 -0400] stormerider: we have an ASA in production and to use VPC you need to route it with BGP, with our ASAs dont support (which I boggled out when I found that out...)
[2012-08-08 06:50:42 -0400] stormerider: unless they've dropped the BGP requirement on VPC, which would be nice
[2012-08-08 06:51:52 -0400] stormerider: or can you use VPC without linking it up to your own network?
[2012-08-08 07:08:19 -0400] ranjibd__: stormerider, u can use token security groups
[2012-08-08 07:09:14 -0400] ranjibd__: i use a token security group named chef-client which has no ingress rule,, but my chef-server security groups has ingress rule which only white lists the chef-client security group holders
[2012-08-08 07:11:40 -0400] stormerider: that doesn't help for multiple regions, though, not that you're still around.
[2012-08-08 07:12:19 -0400] jonaswouters: anyone got a cookbook to install php 5.2 on a debian environment?
[2012-08-08 07:12:24 -0400] stormerider: looks like i need to bone up some on VPC and see if that's the direction we want to go or not. im kicking myself for not realizing that the security groups didnt span regions, sigh.
[2012-08-08 07:14:04 -0400] storm|zzz: night folks.
[2012-08-08 07:22:53 -0400] kernelPanik: Hi guys!
[2012-08-08 07:23:28 -0400] kernelPanik: a good guide for Rake?  with all api and commands?
[2012-08-08 07:36:09 -0400] Scient: good morning
[2012-08-08 07:37:15 -0400] Scient: quick question: i have nginx running as user "deploy" and when im running my chef stuff on the server, the deploy users "usermod" command fails because nginx is running under it. is there a sensible way to handle this, or have i done something wrong?
[2012-08-08 07:51:41 -0400] railsraider: Scient: use a bash or script resource with user "root"
[2012-08-08 10:05:04 -0400] cnf: damned openldap cookbook!
[2012-08-08 10:12:29 -0400] cnf: so what's the preferred way, to use node['keyword'] or node.keyword?
[2012-08-08 10:17:31 -0400] ranjibd: cnf both
[2012-08-08 10:17:46 -0400] ranjibd: foodcritic prefers  node['keyword']
[2012-08-08 10:18:00 -0400] cnf: ok
[2012-08-08 10:18:08 -0400] cnf: i have found platform?() though ^^;
[2012-08-08 10:21:25 -0400] cnf: also, i have found an ohai bug, i think
[2012-08-08 10:22:28 -0400] cnf: or maybe it's expected behaviour, and it's the cookbook that is at fault
[2012-08-08 10:24:15 -0400] beandip: should the chef If I want to set an attribute to the value of a node's ip by searching the role of the node, how could i do that
[2012-08-08 10:25:08 -0400] beandip: so, for instance, I have an attribute that should be the ip of the node running the apache2 role, how do I enter the attribute in ruby to do that?
[2012-08-08 11:50:34 -0400] specialsauce: ohai chefs. is there a known issue with chef performance on chef 10.12.0 and couch 1.0.3?
[2012-08-08 11:57:48 -0400] ashb: specialsauce: there's a known one with ruby 1.9.2 discussed on the list in the last few days
[2012-08-08 12:02:37 -0400] specialsauce: what I'm seeing is the chef server start up, first few requests are OK, and then it just stops responding to requests
[2012-08-08 12:10:26 -0400] nobdrais1ntone: Is there a way to ingore some files when `knife cookbook upload ${cookbook_name}' ?
[2012-08-08 12:15:12 -0400] michael_ws: hello, is there a known incompatibility between latest version of chef and latest version of rabbitmq ?
[2012-08-08 12:15:50 -0400] michael_ws: chef works fine with debian package of rabbitmq (1.8 !) but it doesn't with latest version 2.8.5 or 2.8.4
[2012-08-08 12:16:08 -0400] michael_ws: is this a known issue or .. is it me ?
[2012-08-08 12:16:19 -0400] cnf: damnit, chef - yum is SLOW! :/
[2012-08-08 12:26:28 -0400] cnf: anyone have any suggestions on speeding it up? o,O
[2012-08-08 12:44:12 -0400] BryanWB_: yum is fucking slow
[2012-08-08 12:44:24 -0400] BryanWB_: there is yum-presto plugin i think
[2012-08-08 12:47:00 -0400] cnf: hmm, lemme google that
[2012-08-08 12:47:06 -0400] cnf: (and yes, yes it is!)
[2012-08-08 12:47:11 -0400] cnf: also memory hungry!
[2012-08-08 12:51:47 -0400] ashb: nobdrais1ntone: http://tickets.opscode.com/browse/CHEF-1612
[2012-08-08 12:52:39 -0400] ashb: and http://www.opscode.com/blog/2011/04/29/chef-0-10-preview-chefignore/ is infact better place to look at that
[2012-08-08 12:53:03 -0400] nobdrais1ntone: Found it here https://github.com/opscode/chef/blob/master/chef/lib/chef/cookbook/chefignore.rb
[2012-08-08 12:53:06 -0400] nobdrais1ntone: Thanks, anyway
[2012-08-08 13:25:11 -0400] nobdrais1ntone: Chef web interface failed when .un~ files uploaded in cookbooks
[2012-08-08 13:25:46 -0400] nobdrais1ntone: Messages
[2012-08-08 13:25:46 -0400] nobdrais1ntone: undefined method `empty?' for nil:NilClass
[2012-08-08 13:30:57 -0400] cpasmoi: oh, already seen this, nobdrais1ntone
[2012-08-08 13:32:34 -0400] cpasmoi: nobdrais1ntone, one of your ressource / attribut is not set
[2012-08-08 13:33:59 -0400] nobdrais1ntone: No, it's not about it
[2012-08-08 13:34:09 -0400] cpasmoi: oh
[2012-08-08 13:34:21 -0400] nobdrais1ntone: I add ignoring vim .un~ files and all works fine
[2012-08-08 13:35:21 -0400] nobdrais1ntone: I've got this error when try to open cookbook in web interface like http://.../cookbooks/cookbookname/version
[2012-08-08 13:35:38 -0400] nobdrais1ntone: Reupload without .un~ files  all works
[2012-08-08 13:41:59 -0400] zm: hi guys, i accidentally removed .shef/<client_name>.pem. is there any way to generate it again ?   it can't be added because it already exists, can't be deleted because .pem not found
[2012-08-08 13:42:41 -0400] zm: *the client can't be added or deleted
[2012-08-08 13:49:01 -0400] cnf: zm:  there is in the webui
[2012-08-08 13:49:42 -0400] cnf: zm:  knife client reregister?
[2012-08-08 13:51:42 -0400] zm: cnf: sorry, i don't understand. http://localhost:4040 ?
[2012-08-08 13:52:01 -0400] cnf: don't understand what?
[2012-08-08 13:55:27 -0400] zm: cnf: reregister needs the .pem file
[2012-08-08 13:55:56 -0400] zm: cnf: don't understand "there is in the webui"
[2012-08-08 13:56:03 -0400] cnf: no it doesn't
[2012-08-08 13:56:28 -0400] cnf: knife client reregister clientname gives you a NEW private key
[2012-08-08 13:56:47 -0400] cnf: and you can ask for a new private key in the web interface, in the client section
[2012-08-08 14:00:27 -0400] zm: cnf: webui is not working on my machine.   maybe re-register ask for the old key before gives me a NEW private key ?
[2012-08-08 14:24:43 -0400] mattray: miah: got a few patches for the dhcp cookbook yesterday, moved it out to its own repo
[2012-08-08 14:25:48 -0400] mattray: miah: https://github.com/mattray/dhcp
[2012-08-08 14:48:54 -0400] blasterpal: EYHelp can you please look at #47094 this is prod issue and 2nd time it's happened. Thanks.
[2012-08-08 14:52:41 -0400] sampikesley: wow
[2012-08-08 14:52:43 -0400] sampikesley: wowowowowow
[2012-08-08 14:52:49 -0400] sampikesley: cucumber-chef is mond-blowing
[2012-08-08 14:52:52 -0400] sampikesley: mind
[2012-08-08 15:03:42 -0400] paigeat: whats cucucmber for again
[2012-08-08 15:03:54 -0400] paigeat: oh
[2012-08-08 15:04:00 -0400] Bittarman: depends which sites you read...
[2012-08-08 15:04:10 -0400] Bittarman: cooking... writing tests... or.... nsfw stuff :)
[2012-08-08 15:05:26 -0400] sampikesley: https://github.com/Atalanta/cucumber-chef
[2012-08-08 15:05:31 -0400] sampikesley: TDD/BDD for Chef
[2012-08-08 15:05:43 -0400] sampikesley: Making my cookbooks much less brittle...
[2012-08-08 15:05:56 -0400] paigeat: hmm
[2012-08-08 15:06:06 -0400] geekbri: I get 401 "Unauthorized" when I try to register new clients with hosted chef.  Anybody know what might be causing this?  I regenerated my validator pem since I read that could be the issue, but its still occuring
[2012-08-08 15:07:03 -0400] paigeat: Ive had that problem,
[2012-08-08 15:07:22 -0400] paigeat: are you by any chance running chef-server -l debug in the foreground ?
[2012-08-08 15:07:40 -0400] paigeat: if not try that and see if it does the same thing when you try to check in
[2012-08-08 15:18:09 -0400] blasterpal: he he i put me request for EY in wrong IRC, sorry.
[2012-08-08 15:27:43 -0400] demonccc: Hi All
[2012-08-08 15:27:55 -0400] ranjibd: sampikesley, cucumber chef supports only aws/lxc? can i use it against vgrant ?
[2012-08-08 15:28:04 -0400] ranjibd: s/vgrant/vagrant
[2012-08-08 15:28:09 -0400] demonccc: Did Anyone have  this error: ERROR: Chef::Exceptions::ValidationFailed: Option default must be a kind of StringArrayHash!  You passed false.
[2012-08-08 15:28:09 -0400] ranjibd: hi demonccc
[2012-08-08 15:28:24 -0400] demonccc: Ubuntu, ruby 1.8.7
[2012-08-08 15:28:28 -0400] sampikesley: ranjibd: not yet
[2012-08-08 15:28:34 -0400] demonccc: I can't upload any cookbook
[2012-08-08 15:28:39 -0400] sampikesley: it runs on a m1.small, though
[2012-08-08 15:28:44 -0400] sampikesley: ?1.23 per day
[2012-08-08 15:28:50 -0400] sampikesley: this is totally worth it
[2012-08-08 15:28:55 -0400] sampikesley: vagrant soon
[2012-08-08 15:29:18 -0400] demonccc: I performed an apt-get upgrade, so I guess that something was updated
[2012-08-08 15:29:20 -0400] ranjibd: demonccc, can u run it with debug log level ?
[2012-08-08 15:30:19 -0400] ranjibd: demonccc, so unless one has aws stuff, minitest for integration tests and chefspec for unit tests is good enough
[2012-08-08 15:30:50 -0400] jcran: anyone else having trouble accessing the wiki?
[2012-08-08 15:30:52 -0400] jcran: http://wiki.opscode.com/display/chef/Providers
[2012-08-08 15:31:17 -0400] jcran: Error 354 (net::ERR_CONTENT_LENGTH_MISMATCH): The server unexpectedly closed the connection.
[2012-08-08 15:31:38 -0400] demonccc: ramjibd, what are the options for knife to run it with debug log level?
[2012-08-08 15:32:03 -0400] demonccc: I used -VVV but it didn't show any useful info
[2012-08-08 15:34:19 -0400] demonccc: I used -VVV but it didn't show any useful inf
[2012-08-08 15:35:41 -0400] sampikesley: ranjibd: chefspec is chef-colo only
[2012-08-08 15:35:45 -0400] sampikesley: I need environments
[2012-08-08 15:35:51 -0400] sampikesley: s/colo/solo/
[2012-08-08 15:40:55 -0400] thehar: morrrning
[2012-08-08 15:59:19 -0400] awgross{flashman: are node["my_attribute"]["my_value"], node[:my_attribute][:my_value], and node.my_attribute.my_value all equivalent?
[2012-08-08 16:04:54 -0400] nicholasr-bf: yes, all equivalent,   though they'll generate different errors if node["my_attribute"] doesn't exist...
[2012-08-08 16:16:40 -0400] yfeldblum: awgross{flashman, yes, equivalent, but the first one is the canonical way to do it (and IMO the preferred way) and the second and third ones are actually translated by chef into the first one
[2012-08-08 16:18:36 -0400] awgross{flashman: thanks yfeldblum  the 3rd one seems most useful inside strings, but I will otherwise stick with the first
[2012-08-08 16:21:18 -0400] yfeldblum: awgross{flashman, it's typically useful to use local variables: dir = node["my_cookbook"]["my_recipe"]["something"]["dir"] ; directory "#{dir}/abcd" do ... end
[2012-08-08 16:21:25 -0400] tolland: does the client support a "kick" command to cause it to do a run?
[2012-08-08 16:21:47 -0400] tolland: id like to see the output logs in /var/log/chef/client.log etc
[2012-08-08 16:48:55 -0400] miah: moin
[2012-08-08 16:54:01 -0400] isawk: running chef client for the first time after knife bootstrap I get 500 error
[2012-08-08 16:54:09 -0400] isawk: any idea why?
[2012-08-08 16:54:33 -0400] isawk: checked commons errors and nothing of that nature is reported, error message connection reset by peer
[2012-08-08 16:57:03 -0400] geekbri: sounds like a potential networking issue to me
[2012-08-08 16:57:12 -0400] geekbri: connection reset by peer is usually another servers way of giving you the middle finger
[2012-08-08 17:01:23 -0400] bugant: Hi there, I'm completely new to chef. I would like to know what's the strategy to keep servers updated using chef.
[2012-08-08 17:01:49 -0400] bugant: Suppose I install nginx, and then some days later a new package for it is available
[2012-08-08 17:01:49 -0400] Zeelot: if I normally run a command like this "FOO=bar ./something ..." how can I define the FOO value in an execute block?
[2012-08-08 17:04:05 -0400] bugant: I mean, do I have to provide a receipe to update current installed software?
[2012-08-08 17:04:34 -0400] Zeelot: bugant: no, the recipes are usually written so they can be ran multiple times without breaking anything
[2012-08-08 17:04:53 -0400] barefoot: bugant: http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-08-08 17:06:46 -0400] bugant: barefoot: ok, good. so if I use the nginx cookbok, I use it just to install and configure the server, then I need to provide another recipe to keep it updated
[2012-08-08 17:06:50 -0400] bugant: right?
[2012-08-08 17:07:55 -0400] barefoot: using :upgrade vs :install should do what you need
[2012-08-08 17:13:08 -0400] Zeelot: barefoot: know how I can output a line when running recipes?
[2012-08-08 17:13:29 -0400] Zeelot: =/
[2012-08-08 17:13:35 -0400] isawk: but how come everything else seems to have been executed e.g. nodename exists when I execute knife client list
[2012-08-08 17:13:37 -0400] isawk: http://pastebin.com/BEgNh2mm
[2012-08-08 17:13:57 -0400] magoo: when I get this on a chef run: FATAL: NoMethodError: undefined method `[]' for nil:NilClass
[2012-08-08 17:14:10 -0400] magoo: how do i debug it without any context as to why or where it happened?
[2012-08-08 17:14:12 -0400] bugant: barefoot: package 'nginx'
[2012-08-08 17:14:19 -0400] bugant: will perform install
[2012-08-08 17:14:27 -0400] barefoot: bugant: correct
[2012-08-08 17:14:30 -0400] bugant: ok
[2012-08-08 17:14:41 -0400] barefoot: Zeelot: "a line"?
[2012-08-08 17:14:59 -0400] Zeelot: found it: Chef::Log.info("I has no tagz")
[2012-08-08 17:15:16 -0400] barefoot: ah, logging
[2012-08-08 17:15:38 -0400] barefoot: magoo: check the stacktrace?
[2012-08-08 17:17:09 -0400] bugant: barefoot: so this cookbook here https://github.com/opscode-cookbooks/nginx/blob/master/recipes/default.rb
[2012-08-08 17:17:25 -0400] bugant: do not perform upgrade of the installed nginx, right?
[2012-08-08 17:17:59 -0400] magoo: barefoot: i apologize for being an idiot... i thought the stacktrace was just a copy of the stdout i was seeing
[2012-08-08 17:18:02 -0400] magoo: lol
[2012-08-08 17:18:03 -0400] barefoot: bugant: right
[2012-08-08 17:19:09 -0400] barefoot: magoo: :) no, there should be /var/cache/chef/chef-stacktrace.out or the like
[2012-08-08 17:19:48 -0400] bugant: barefoot: so, what's the recomended strategy? what do you suggest?
[2012-08-08 17:20:24 -0400] magoo: no, that's what i'm saying - i should have looked there first :)
[2012-08-08 17:20:42 -0400] barefoot: bugant: for what? to upgrade? package "name" do action :upgrade end
[2012-08-08 17:23:24 -0400] isawk: any one has had this errors before http://pastebin.com/BEgNh2mm, confusing me to numbness... chief-client fails execution with 500 error, 403 but knife client list executed on server shows node that is failing
[2012-08-08 17:33:00 -0400] awgross{flashman: Can anyone point me to an example of a way to register some action from a recipe so that it can be retrieved later for templating a file? For example:
[2012-08-08 17:33:30 -0400] awgross{flashman: I have a recipe with a provider that allows you to add Nagios style checks.  The calling recipe passes in a script and some parameters
[2012-08-08 17:33:49 -0400] awgross{flashman: the provider then echoes a line to a config file (if it doesnt already exist in the file)
[2012-08-08 17:33:56 -0400] awgross{flashman: its a pretty brittle way of doing things
[2012-08-08 17:34:12 -0400] awgross{flashman: what I would prefer to do is to just register the new script + parameter combo
[2012-08-08 17:34:30 -0400] awgross{flashman: then at the end of the chef run, just generate a new config file with all of the registered scripts
[2012-08-08 17:43:25 -0400] awgross{flashman: unfortunately the way the Nagios cookbook does it, by creating a separate .cfg file for each check, wont work in this case
[2012-08-08 17:56:39 -0400] xuru: Can you do a search in the attributes file of a cookbook?  I want to search for the zenoss server, and set an attribute based on that.  Or is there a better way to do what I'm thinking?
[2012-08-08 17:56:44 -0400] miah: managing a single large file with multiple entries is a huge pita compared to a single file per object
[2012-08-08 17:57:26 -0400] miah: you could certainly do it, and you would probably just want to use the file resource with a 'content' parameter rather than a template
[2012-08-08 17:58:12 -0400] miah: xuru: node.has_key?(:attribute)
[2012-08-08 17:59:11 -0400] xuru: miah: I was thinking something like:  server = search(:node, 'recipes:zenoss\:\:server') || []
[2012-08-08 17:59:19 -0400] xuru: then getting the hostname from it
[2012-08-08 18:00:13 -0400] miah: oh you want to search your nodes to find the zenos server
[2012-08-08 18:00:18 -0400] xuru: yeah
[2012-08-08 18:00:28 -0400] miah: why not just search for a server that matches the role for your zenos server..
[2012-08-08 18:01:12 -0400] miah: xuru: https://github.com/miah/nagios/blob/refactor/recipes/client.rb#L19
[2012-08-08 18:01:43 -0400] awgross{flashman: also, opscode guys
[2012-08-08 18:01:43 -0400] awgross{flashman: http://lists.opscode.com/sympa/arc/chef/2012-05/msg00049.html
[2012-08-08 18:01:51 -0400] awgross{flashman: the link for MhonArc you provide
[2012-08-08 18:02:06 -0400] xuru: miah: that would work too, and I use this in another place and it works, but I'm getting the error:  "ERROR: TypeError: can't convert Symbol into Integer" when I try and look at anyting in the node
[2012-08-08 18:02:07 -0400] awgross{flashman: tells you to upgrade your software due to XSS vulns
[2012-08-08 18:03:11 -0400] miah: xuru: you'll need to post most code sample. you're trying to reference a symbol as an integer in your code.
[2012-08-08 18:03:28 -0400] xuru: ok, one sec
[2012-08-08 18:03:37 -0400] miah: please use gist / nopaste
[2012-08-08 18:03:57 -0400] xuru: yepper
[2012-08-08 18:05:17 -0400] xuru: miah: https://gist.github.com/3297117
[2012-08-08 18:05:59 -0400] xuru: miah: it's complaining about line 40
[2012-08-08 18:06:09 -0400] yfeldblum: i prefer this type of technique: zenoss_servers = search(:node, "roles:#{node["zenoss_server_role"]}")
[2012-08-08 18:06:56 -0400] geekbri: ^ +1, that is what I do
[2012-08-08 18:07:33 -0400] geekbri: keep in mind when you search roles, role searches only the run list, and roles will search the expanded run list
[2012-08-08 18:07:52 -0400] xuru: node[zenoss_server_role] gets you the node that has that role?
[2012-08-08 18:08:20 -0400] xuru: geekbri: good to know
[2012-08-08 18:08:22 -0400] geekbri: node[zenoss_server_role] is presumably some attribute that would be set, to say what role a zenoss_server would have.
[2012-08-08 18:08:40 -0400] geekbri: this way if you wanted your zenoss servers to be identified by the role "wacky_apples"
[2012-08-08 18:08:44 -0400] geekbri: you would just change that attribute
[2012-08-08 18:08:50 -0400] xuru: so I would have to set that attribute on all zenoss clients
[2012-08-08 18:08:55 -0400] storm|zzz: ohai chefs
[2012-08-08 18:09:03 -0400] yfeldblum: xuru, no, the point is that you have a base role that has, in its default_attributes, something like: `default_attributes "zenoss_server_role" => "zenoss-server"`
[2012-08-08 18:09:20 -0400] yfeldblum: xuru, the idea is that every node gets that base role in its run list
[2012-08-08 18:09:48 -0400] xuru: ah, ok
[2012-08-08 18:09:59 -0400] yfeldblum: xuru, then in any recipe, you can write `node["zenoss_server_role"]` to find out the name of the role which you indent that the zenoss servers have in their run-lists
[2012-08-08 18:10:31 -0400] xuru: I already have a base role, for that kind of thing, but I thought that doing the search was more "elegant"
[2012-08-08 18:10:46 -0400] stormerider: with the "knife ec2 create" command, is there a way to specify a proxy server or specific chef server URL to use instead of the default that knife is configured for?
[2012-08-08 18:10:51 -0400] miah: doing the search is elegant
[2012-08-08 18:10:53 -0400] geekbri: the node attribute is so you can easily change what role you might be using to identify those servers.
[2012-08-08 18:11:04 -0400] xuru: ah, got ya
[2012-08-08 18:11:06 -0400] miah: though you should standardize on the way you access attributes
[2012-08-08 18:11:11 -0400] miah: sometimes as strings, sometimes as symbols..
[2012-08-08 18:11:13 -0400] xuru: that makes sense
[2012-08-08 18:11:14 -0400] geekbri: this way you don't have to go in and edit the search if the role you are using for your zenoss servers changes, you can just change the attribute
[2012-08-08 18:11:58 -0400] miah: i use method chaining.. its cleaner. 'node.nagios.server.conf_dir' rather than node['nagios']['server']['conf_dir'] or node[:nagios][:server][:conf_dir]
[2012-08-08 18:12:32 -0400] miah: but then you have to make sure your cookbook names / attributes are valid method names
[2012-08-08 18:12:39 -0400] xuru: Yeah, I read that, and will probably switch to that
[2012-08-08 18:12:57 -0400] miah: you will run into less type errors
[2012-08-08 18:12:59 -0400] geekbri: Which isn't a huge deal anyway, because for the most part people generally use valid method names for their attribute names without even realizing it.
[2012-08-08 18:13:20 -0400] xuru: especially if you come from a unix background
[2012-08-08 18:13:59 -0400] miah: but things like 'node.nagios.server.port.to_s' look much cleaner too
[2012-08-08 18:14:19 -0400] miah: teaching people to hate brackets.. ftw.
[2012-08-08 18:14:54 -0400] miah: learn to <3 tailor & foodcritic
[2012-08-08 18:15:17 -0400] geekbri: I'm fairly indifferent to which method is used.. I will admit that if you have some deeply nested attribute using the 'hash' way of accessing it can get real oppressive to look at real fast.
[2012-08-08 18:15:40 -0400] xuru: yeah, and painful to type
[2012-08-08 18:15:55 -0400] yfeldblum: xuru, geekbri, more than that: cookbooks should *not* dictate to you what your roles are or ought to be named; instead, cookbooks should have a way for you to tell them any relevant information that they need to know
[2012-08-08 18:16:05 -0400] cheeseplus: miah: I though foodcritic recommend using the node['attr']
[2012-08-08 18:16:12 -0400] cheeseplus: thought*
[2012-08-08 18:16:17 -0400] miah: cheeseplus: ya. its wrong =)
[2012-08-08 18:16:21 -0400] cheeseplus: haha
[2012-08-08 18:16:28 -0400] cheeseplus: good to know
[2012-08-08 18:16:29 -0400] miah: strings are 'safer'
[2012-08-08 18:16:38 -0400] miah: for people who are new to chef / ruby
[2012-08-08 18:17:01 -0400] geekbri: I think just less confusing for people who don't get the magic underneath the hood.
[2012-08-08 18:17:07 -0400] miah: right
[2012-08-08 18:17:15 -0400] cheeseplus: someone recently changed our cookbook from node[:attr] to node['attr'] everywhere, so should I change it to node.attr then?
[2012-08-08 18:17:25 -0400] miah: probably =)
[2012-08-08 18:17:32 -0400] yfeldblum: cheeseplus, nope, i'm not a fan of that
[2012-08-08 18:17:41 -0400] cheeseplus: yay, dissent
[2012-08-08 18:18:05 -0400] yfeldblum: cheeseplus, i think dealing with a Hash-like data structure should be done in terms of the fact that it's a Hash-like data structure
[2012-08-08 18:18:22 -0400] geekbri: cheeseplus: I'd suggest picking what you prefer, and then being consistent with it.
[2012-08-08 18:18:44 -0400] yfeldblum: cheeseplus, the Chef::Node object stores data, not behavior; use methods when you want behavior; use data-access (indexing with brackets) when you want to access data in a data structure
[2012-08-08 18:19:37 -0400] yfeldblum: cheeseplus, node["attr"] tells everyone in the world that you're indexing into the `node` data structure to find the element at index `"attr"`
[2012-08-08 18:20:19 -0400] cheeseplus: geekbri: agreed on that, just trying to decide what works best from a testing perspective as the initial change was done to accomodate foodcritic
[2012-08-08 18:20:32 -0400] yfeldblum: cheeseplus, node.attr tells everyone in the world that you're calling some method named `:attr`, and probably nobody knows what that is
[2012-08-08 18:21:06 -0400] geekbri: certainly using the attr method makes it less obvious when you are touching a node attribute vs an actual method of the node class
[2012-08-08 18:21:26 -0400] miah: true
[2012-08-08 18:21:35 -0400] xuru: I have a question that has been driving me nuts  when I try to set an attribute in a cookbook that is also defined in another cookbook, it doesn't seem to override it.  Do I have to use override_attribute in a role to override them?  is that the preferred method?
[2012-08-08 18:21:54 -0400] yfeldblum: geekbri, exactly; and i'm a fan of magic, so long as its clear (like in the Chef recipe DSL for declaring resources!) but in this case it's not clear
[2012-08-08 18:22:00 -0400] miah: i think its fairly obvious how things work in my books.. i'm going to keep doing it that way =)
[2012-08-08 18:22:44 -0400] geekbri: miah: Ultimately if the code is easy to read and understand, I'm not sure it matters.  This is one of those "personal preference" situations where many people will have many different positions on the matter
[2012-08-08 18:22:52 -0400] miah: true
[2012-08-08 18:22:56 -0400] geekbri: its like discussing how you should align { } 's :)
[2012-08-08 18:23:16 -0400] miah: ah yes, but the style guide already talks about that. =)
[2012-08-08 18:25:08 -0400] yfeldblum: good think, then, you all don't live in a worldwide dictatorship rules by me :P
[2012-08-08 18:25:14 -0400] geekbri: hehe
[2012-08-08 18:25:20 -0400] geekbri: Not yet at least.
[2012-08-08 18:26:28 -0400] stormerider: hm. can anyone comment on why https://github.com/opscode/knife-ec2/pull/21 was closed without being pulled?
[2012-08-08 18:26:46 -0400] geekbri: stormerider: Can you link to the jira ticket for it?
[2012-08-08 18:26:49 -0400] geekbri: That might be more revealing
[2012-08-08 18:27:05 -0400] stormerider: geekbri: let me see if i can dig it up
[2012-08-08 18:28:18 -0400] yfeldblum: stormerider, the action around opscode-maintained projects happens in opscode's JIRA
[2012-08-08 18:28:38 -0400] stormerider: dont actually see one, actually.
[2012-08-08 18:28:40 -0400] cheeseplus: xuru: why would you have two cookbooks with the same attribute (he curiously asked)?
[2012-08-08 18:28:59 -0400] geekbri: stormerider: that is probably why :).  http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-08-08 18:29:12 -0400] stormerider: at least, not if i search for bootstrap_proxy in the Knife-EC2 project
[2012-08-08 18:29:38 -0400] cheeseplus: override_attributes on the node or role would do the trick if you are attempting to override the default in a cookbook
[2012-08-08 18:30:52 -0400] xuru: yes, to override the attributes in another cookbook
[2012-08-08 18:30:52 -0400] stormerider: i dont follow their VPC changes but if adding support for a proxy server is as simple as a few lines im not sure why it hasnt been done before. i guess ill set up a test config, see if i can get it to work, and then open a ticket about it.
[2012-08-08 18:31:47 -0400] geekbri: stormerider: make sure to run the unit tests after you add it, and add a unit test for what you add in
[2012-08-08 18:32:34 -0400] stormerider: geekbri: that might be a problem, ive never written unit tests before (sysadmin, not a regular dev)
[2012-08-08 18:32:40 -0400] xuru: so setting something like:  default['snmp']['community'] = 'mycommunity' in mycookbook cookbook after the snmp cookbook was included, isn't going to "override" the value
[2012-08-08 18:32:49 -0400] geekbri: stormerider: well, at the very least run the existing unit tests :)
[2012-08-08 18:33:07 -0400] stormerider: geekbri: is there a page describing how to do so?
[2012-08-08 18:33:34 -0400] geekbri: stormerider: rake spec  :)
[2012-08-08 18:33:54 -0400] geekbri: stormerider: once you have the git repo checked out, you can just go into the knife-ec2 repo and type "rake spec".  You should be able to see the unit tests go off :)
[2012-08-08 18:33:56 -0400] cheeseplus: xuru: right
[2012-08-08 18:34:14 -0400] xuru: ok, that's what I thought.
[2012-08-08 18:34:23 -0400] cheeseplus: xuru: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-08-08 18:35:13 -0400] cheeseplus: I've never encountered that particular issue but I've taken advantage of the merging of attributes at the role level
[2012-08-08 18:35:19 -0400] cheeseplus: really convenient
[2012-08-08 18:35:29 -0400] xuru: yeah, I read that, but it's a little vague when using one cookbook to override another cookbooks attributes
[2012-08-08 18:35:53 -0400] xuru: yeah, I agree
[2012-08-08 18:35:56 -0400] cheeseplus: xuru: yea, for that I've only done it at the node or role level but it's good to know how that works
[2012-08-08 18:35:56 -0400] stormerider: geekbri: perfect, thanks
[2012-08-08 18:36:40 -0400] awgross{flashman: stormerider: is that request for an SSH proxy or a proxy for connecting to host chef
[2012-08-08 18:36:44 -0400] cheeseplus: in our case I've used the merging with the sudoers cookbooks so you can layer access to machines easily
[2012-08-08 18:37:06 -0400] stormerider: awgross{flashman: the latter
[2012-08-08 18:37:10 -0400] xuru: cheeseplus: ah, good example
[2012-08-08 18:37:15 -0400] cheeseplus: but the base role always keeps certain users in there
[2012-08-08 18:37:30 -0400] stormerider: knife bootstrap supports bootstrap_proxy but the knife ec2 server create does not, apparently
[2012-08-08 18:37:45 -0400] cheeseplus: xuru: I was super nervous when I threw it in for the first time, was worried it wasn't going to merge and I'd lock myself out of everything :)
[2012-08-08 18:38:14 -0400] awgross{flashman: stormerider: oic, ive been having fun with VPC issues myself but I have not had issues getting out to opscode (using NAT instances)
[2012-08-08 18:38:51 -0400] jankes: Hi, I'm seeking help with my chef env, which does not come up. Background: I'm an admin new to Chef, involved in a DevOps project using Chef. The setup I (used to) use is Vagrant with single node.
[2012-08-08 18:40:10 -0400] stormerider: awgross{flashman: im not using VPC, so proxying is how i need to go.
[2012-08-08 18:40:45 -0400] jankes: This all used to work, but now when I try to set up the VM env from scratch again, bootstrapping chef-server seems to fail
[2012-08-08 18:40:58 -0400] awgross{flashman: stormerider: gotcha, just a private environment then?
[2012-08-08 18:41:42 -0400] jankes: -there is no error, but the webui is not up
[2012-08-08 18:42:29 -0400] jankes: REST api page is up, though...
[2012-08-08 18:42:54 -0400] xuru: jankes: the wiki is very useful: http://wiki.opscode.com/display/chef/Installing+Chef+Server  did you check there?
[2012-08-08 18:44:08 -0400] jankes: thanks, xuru - but I just don't know where to start looking.
[2012-08-08 18:44:41 -0400] xuru: jankes: I'd ssh into the machine, and check  what's running, and the logs for clues
[2012-08-08 18:49:15 -0400] grantr: does anyone know of a tool that lets you rename chef nodes?
[2012-08-08 18:49:28 -0400] grantr: knife node rename would be awesome
[2012-08-08 18:50:02 -0400] jankes: xuru: I can see some chef stuff in ps, but no chef-server
[2012-08-08 18:51:31 -0400] xuru: jankes: what OS?
[2012-08-08 18:51:45 -0400] jankes: ubuntu precise
[2012-08-08 18:52:08 -0400] jankes: - Vagrant precise32 box
[2012-08-08 18:52:18 -0400] xuru: ok, that's what I use
[2012-08-08 18:52:39 -0400] xuru: tail your logs in /var/log/chef and restart chef-server and see if you get an error
[2012-08-08 18:52:51 -0400] jankes: ok
[2012-08-08 18:53:10 -0400] xuru: actually, if you can get to the API port, it's probably chef-server-webui that's not running right
[2012-08-08 18:53:38 -0400] dajia: Hello, all.
[2012-08-08 18:54:34 -0400] dajia: Is it possible to access the version of a running cookbook within a recipe of that cookbook?  I would like to capture the cookbook version used and include that in a file that is being rendered from a template.
[2012-08-08 18:55:31 -0400] stormerider: how do i install a local copy of a knife gem ive modified? rake install?
[2012-08-08 18:55:42 -0400] jankes: xuru: when I start chef-server (as root), it end with "FATAL: Another process is already listening on port 4000. Is chef-server already running?"
[2012-08-08 18:56:00 -0400] geekbri: stormerider: you could build the gem and then install that, or you could use bundler to do it
[2012-08-08 18:56:30 -0400] stormerider: geekbri: so i did rake rspec and it passed. im really at a loss as to what to do now, sorry.
[2012-08-08 18:56:39 -0400] xuru: jankes: try 'tail -f /var/log/chef/chef-server&; service chef-server restart'
[2012-08-08 18:57:35 -0400] stormerider: er, rake spec, rather.
[2012-08-08 18:58:34 -0400] geekbri: stormerider: you could, from within the repository that you have knife-ec2 checked out into, run the command "gem build knife-ec2.gemspec"
[2012-08-08 18:58:55 -0400] geekbri: stormerider: that will build the knife-ecd2 gem, which it will drop right in the directory you ran that from.  then you could do gem install <that gemfile>.gem
[2012-08-08 18:59:04 -0400] geekbri: stormerider: you may want to uninstall the existing knife-ec2 you have
[2012-08-08 18:59:56 -0400] stormerider: interesting. so gems are actually a lot like eggs. ok.
[2012-08-08 19:00:28 -0400] stormerider: perfect. thanks so much.
[2012-08-08 19:00:46 -0400] jankes: xuru: nothing really significant there, I think - amybe apart from ' Could not find a PID file at /var/run/chef/server.main.pid'... Then Thin starts at port 4000
[2012-08-08 19:00:54 -0400] geekbri: stormerider: I find gems a lot easier to deal with than pip.
[2012-08-08 19:01:38 -0400] stormerider: geekbri: im more used to easy_install, but i still havent done a whole lot with python. a lot of it has been "python setup.py install" to be honest.
[2012-08-08 19:01:50 -0400] jankes: xuru: but I see "merb : chef-server (api) : worker (port 4000)" in ps now.
[2012-08-08 19:01:53 -0400] geekbri: stormerider: welcome to the ruby world! :)
[2012-08-08 19:02:22 -0400] stormerider: geekbri: one last question. is there any reason "rake install" wouldn't map to that kind of "gem build", "gem install" process or is that just ecosystem differences?
[2012-08-08 19:02:28 -0400] xuru: jankes: the webui runs on 4040, so do the same command but with "chef-server-webui"
[2012-08-08 19:03:15 -0400] geekbri: stormerider: rake is like make.  It can perform tasks that you define.  You could cetainly add a rake task that builds and installs gems :)
[2012-08-08 19:03:47 -0400] xuru: how do I check for an attribute on a node?  I have "if node.attribute?('zenoss_server_role')" but it doesn't seem to fall in there...
[2012-08-08 19:04:14 -0400] xuru: and I can see on the webui that the attribute exists on that node
[2012-08-08 19:04:23 -0400] stormerider: *nod* im more wondering if the common practice is not to include it in the ruby ecosystem and just separate rake tasks from gem tasks, or if it's specific to this gem's designer
[2012-08-08 19:04:59 -0400] stormerider: so that i know best, or at least, common, practices as i venture forth :)
[2012-08-08 19:06:01 -0400] jankes: xuru: OK, the webui is up now - Thanks! I'll try to bootstrap a node.
[2012-08-08 19:06:03 -0400] geekbri: stormerider: bundler is smart enough to be able to install gems from git repositories that have gemspecs, so that you don't need to gem build and gem install.  You could also write some rake tasks for it... either is acceptable :)
[2012-08-08 19:06:16 -0400] xuru: jankes: np
[2012-08-08 19:06:24 -0400] geekbri: stormerider: some seasoned ruby veteran may have even more opinions than me on the matter :)
[2012-08-08 19:10:07 -0400] stormerider: geekbri: and the bundler way would be sudo bundle install?
[2012-08-08 19:10:26 -0400] stormerider: so many tools to learn between ruby and chef, heh
[2012-08-08 19:10:46 -0400] geekbri: stormerider: assuming that your Gemfile points to the HEAD of whatever git branch you are working on and the changes have been committed there, or that bundler points to the TAG or REF that the changes are present on :)
[2012-08-08 19:11:14 -0400] stormerider: ah, so it wouldnt work with local changes.
[2012-08-08 19:11:45 -0400] geekbri: stormerider: I think you can point bundler to local
[2012-08-08 19:11:52 -0400] geekbri: stormerider: I just haven't toyed with that in a while :)
[2012-08-08 19:12:08 -0400] stormerider: *nods* ok, enough questions for a bit :) thanks for the help.
[2012-08-08 19:12:42 -0400] geekbri: stormerider: If i remember correctly bundler can indeed look at the local file system and even handle the packing and installing so you dont' have to do anything but change the source, then run bundle install again
[2012-08-08 19:13:18 -0400] geekbri: stormerider: again, its been a while, but you should be able to do soething like  gem "knife-ec2", :path => "/crazy/path/goes/here"
[2012-08-08 19:13:50 -0400] beandip: So i figured out my ruby issues yesterday
[2012-08-08 19:14:01 -0400] beandip: looks like someone else has run into something similar
[2012-08-08 19:14:28 -0400] beandip: https://github.com/RiotGames/not_system_ruby_cookbook
[2012-08-08 19:15:09 -0400] chip-: someone in this channel, no less!
[2012-08-08 19:15:37 -0400] geekbri: Riot has some very useful chef related stuff
[2012-08-08 19:15:42 -0400] geekbri: Also, LoL can be fun.
[2012-08-08 19:19:35 -0400] stormerider: beandip: as i see it, that installs the packages, but it still doesn't update ubuntu to set the default ruby to be 1.9. or did you get a high enough gem version doing it that way anyways?
[2012-08-08 19:22:17 -0400] jankes: xuru: bootstrapping a node ends with "HTTP Request Returned 500 Internal Server Error: Connection refused"
[2012-08-08 19:22:27 -0400] jaylevitt: I have a recipe that sets some node attributes (node[:postgresql][:password][:postgres] = 'postgres') and then calls include_recipe 'postgresql::server'.  That doesn't work when bootstrapping a node, since node[:postgresql] is nil, not a second-level hash.  What's the right way to set an attribute that's required by a recipe, but that won't even exist till the recipe is run?
[2012-08-08 19:24:01 -0400] jankes: xuru: in the logs, something like this appeared:
[2012-08-08 19:24:04 -0400] jankes: merb : chef-server (api) : worker (port 4000) ~ Connection refused - connect(2) - (Bunny::ServerDownError)
[2012-08-08 19:25:21 -0400] xuru: jankes: sounds like rabbitmq isn't running
[2012-08-08 19:27:47 -0400] beandip: stormerider: I did
[2012-08-08 19:36:19 -0400] jankes: xuru: Thanks, after starting rabbitmq, bootstrapping node went fine. Now for the cooking...
[2012-08-08 19:40:08 -0400] xuru: jankes: np, good luck
[2012-08-08 19:40:44 -0400] jankes: xuru: Well, it seems a bad luck is upon me actually :/
[2012-08-08 19:41:02 -0400] jankes: I'm back at "Net::SSH::AuthenticationFailed" error now
[2012-08-08 19:41:10 -0400] jankes: when I try to deploy
[2012-08-08 19:41:41 -0400] jankes: I checked the keys several times...
[2012-08-08 19:42:26 -0400] jankes: xuru: If I run the knife deploy command with -VV,
[2012-08-08 19:42:27 -0400] xuru: jankes: not sure about that one
[2012-08-08 19:43:29 -0400] jankes: I get (among all the debug, describing various auth attempts) this: "ERROR: could not connect to ssh-agent"
[2012-08-08 19:44:59 -0400] xuru: jankes: you will probably need to specify it on the command line like:  knife boostrap bob.example.com -i ~/.ssh/mykey.pem ...
[2012-08-08 19:45:29 -0400] jankes: Hmm, will try!
[2012-08-08 19:49:01 -0400] jankes: xuru: Wait a minute... "mykey.pem"?
[2012-08-08 19:49:41 -0400] jankes: Wasn't that supposed to be "id_rsa.pub"?
[2012-08-08 19:50:03 -0400] xuru: whatever you named it  the key for your vm if you're using keys to ssh in
[2012-08-08 19:50:06 -0400] xuru: probably
[2012-08-08 19:50:59 -0400] jankes: I'm using password to ssh in, but that's for a different user I guess.
[2012-08-08 19:58:12 -0400] stormerider: jankes: you dont use the .pub file to connect over ssh. you need to use the actual private key to connect.
[2012-08-08 19:58:57 -0400] jankes: stormerider: yes, I figured that now - thanks :)
[2012-08-08 19:59:11 -0400] jankes: (still, it does not fox anthing)
[2012-08-08 19:59:17 -0400] jankes: *fix
[2012-08-08 20:11:16 -0400] miah: guh
[2012-08-08 20:18:24 -0400] jaylevitt: How can I set attributes that don't exist yet because I haven't called the recipe that creates them?
[2012-08-08 20:19:04 -0400] jaylevitt: e.g. https://gist.github.com/56e30fb17e7345678031
[2012-08-08 20:28:05 -0400] jaylevitt: I tried include_attribute('postgresql') but got: NameError: Cannot find a resource for include_attribute on ubuntu version 12.04
[2012-08-08 20:32:44 -0400] jaylevitt: yfeldblum: ayt? I seem to remember you often load recipes and set attributes from other recipes
[2012-08-08 20:33:43 -0400] pulsejc: how does the sort option(-o/sort) for knife search work?  for instance, how would I do a search and return nodes ordered by name?
[2012-08-08 20:34:07 -0400] qhartman: I am trying to use various resources (specifically remote_file, cookbook_file, and execute) within a ruby_block, but they aren't working. As soon as I remove the ruby_block wrapper everything works, though it (as expected) doesn't get evaluated at the time in the chef run I want it to anymore. Is this failure of resources inside roby_block statements expected?
[2012-08-08 20:35:28 -0400] yfeldblum: jaylevitt, include_attributes with an s
[2012-08-08 20:36:15 -0400] yfeldblum: jaylevitt, you can also set an attribute that doesn't exist whenever you like; if some other recipe didn't create them, then your recipe can
[2012-08-08 20:36:50 -0400] jaylevitt: yfeldblum: ah, the wiki is wrong.. it says "include_attribute", no s
[2012-08-08 20:37:15 -0400] barefoot: http://wiki.opscode.com/display/chef/Attributes also uses the non plural form
[2012-08-08 20:37:21 -0400] jaylevitt: the trouble with setting an attribute is if it's nested, e.g. I can't do node['postgresql']['password']['postgres'] because the sub-hashes haven't been created yet
[2012-08-08 20:38:52 -0400] jaylevitt: Hrm.. NameError: Cannot find a resource for include_attributes on ubuntu version 12.04
[2012-08-08 20:46:58 -0400] PRK_nz: I'm after some help. I updated our Chef server yesterday from 0.10.8 to 10.12.0. It's Ubuntu 10.04 with Chef installed via Opscode apt source. The problem I'm experiencing is with solr. First, for some reason it couldn't start as /var/run/chef was owned by root:root, instead of chef:chef. I changed that, but the status page on the webui still says "Could not list status", and "You appear to have no nodes - try connecting one, or creating or ed
[2012-08-08 20:47:00 -0400] PRK_nz: iting a client". As per CHEF-1143 I tried 'knife index rebuild', but had no luck there. Can anyone help me please?
[2012-08-08 20:47:40 -0400] PRK_nz: oh, btw, the indexes all rebuilt ok, but that didn't fix anything.
[2012-08-08 20:47:53 -0400] qhartman: If I set a variable inside a ruby_block, is it available outside that context? If not, if I set a variable outside the ruby block, can I change its' value inside the block?
[2012-08-08 20:48:15 -0400] PRK_nz: With solr running and indexes rebuilt, it now just doesn't take too long to load the Status page, but still without nodes.
[2012-08-08 20:49:04 -0400] PRK_nz: Sorry, also, changing the environment on the status page does change it. One environment works, but others don't.
[2012-08-08 20:51:18 -0400] miketheman: I'm looking for the proper/idiomatic way for expressing a condition to a resource that: a) does the attribute key exist; b) is the attribute's value not Nil; c0 if it either doesn't exist, or is nol, log a message to the user
[2012-08-08 20:51:51 -0400] miketheman: are there any examples that I might be able to infer this from?
[2012-08-08 20:57:02 -0400] qhartman: PRK_nz, I ran into some problems with solr when I upgraded as well. I had to restart it again after re-indexing and it got better.
[2012-08-08 20:57:29 -0400] qhartman: PRK_nz, when I initially did it, solr wasn't starting correctly, but I don't recall why.
[2012-08-08 21:03:17 -0400] PRK_nz: qhartman: I think I did that but I'll try again. I'll let you know how I get on.
[2012-08-08 21:07:19 -0400] jaylevitt: wait, should include_attribute[s] work inside a recipe? or only in an attributes file?
[2012-08-08 21:08:07 -0400] PRK_nz: qhartman: hmmm, no deal :(
[2012-08-08 21:14:08 -0400] yfeldblum: jaylevitt, inside an attributes file
[2012-08-08 21:15:23 -0400] jaylevitt: yfeldblum: ah.. so I can't programmatically set the attributes based on values my recipe knows
[2012-08-08 21:16:50 -0400] yfeldblum: jaylevitt, you can
[2012-08-08 21:19:10 -0400] jaylevitt: yfeldblum: how? I mean, I could have the recipe set some global/node/whatever variable, and have the attributes file use logic that depends on it..
[2012-08-08 21:20:54 -0400] yfeldblum: jaylevitt, the attributes file can use `node.default_unless["a"]["b"] = 3`
[2012-08-08 21:21:42 -0400] yfeldblum: jaylevitt, but if cookbook A depends on cookbook B, then cookbook B's attributes files should be loaded before anything from cookbook A (entirely as judged by whether cookbook A has `depends "cookbook B"` in its metadata.rb
[2012-08-08 21:22:05 -0400] jaylevitt: from what I'm reading, 'depends' doesn't affect the ordering of attributes files at all
[2012-08-08 21:22:17 -0400] jaylevitt: (and in fact my cookbook already depends on 'postgresql' to no effect)
[2012-08-08 21:22:39 -0400] jaylevitt: moving the attribute settings from cookbooks/recipe.rb into attributes/recipe.rb is working, but feels kinda weird
[2012-08-08 21:23:29 -0400] yfeldblum: jaylevitt, hmm ... if that's the case, then i think that has to be a bug
[2012-08-08 21:24:12 -0400] jaylevitt: There are a bunch of bugs about attribute loading, but nobody implied they should be loaded in dependency order - they used to be loaded in alpha order but Ruby hash randomization screwed that up
[2012-08-08 21:24:19 -0400] jaylevitt: eg http://tickets.opscode.com/browse/CHEF-2903
[2012-08-08 21:24:23 -0400] iamchrisf: in the bootstrap template is there a way to retrieve the ip address are node attributes available?
[2012-08-08 21:33:48 -0400] stuartrexking: I am using the application_python cookbook to start a python app using gunicorn. My recipe looks like this. https://gist.github.com/d285f44204686e05c138 How do I specify the recipe to load dependencies into a virtualenv using pip?
[2012-08-08 21:33:48 -0400] jaylevitt: Hmm... not postgresql/recipes/server.rb:58 has a bash command that is asking for a password (when it's run from within bootstrap). I'm root! Why would that be?
[2012-08-08 21:37:15 -0400] jaylevitt: can I see the temporary file that the bash{} block creates?
[2012-08-08 21:45:01 -0400] enricosada: hi, i am trying to create a new cookbook but i cant force apt-get update before package install
[2012-08-08 21:45:14 -0400] enricosada: my recipe
[2012-08-08 21:45:22 -0400] enricosada: http://pastebin.com/SnXQvsYb
[2012-08-08 21:45:37 -0400] jaylevitt: enricosada: Did you add the "apt" cookbook to your run_list?  Put that as the first recipe.
[2012-08-08 21:46:05 -0400] enricosada: also if i use generic package definition?
[2012-08-08 21:46:24 -0400] jaylevitt: ah, not sure there.. chef newbie, sorry
[2012-08-08 21:46:34 -0400] enricosada: np, i try :D
[2012-08-08 21:46:36 -0400] enricosada: thx
[2012-08-08 21:50:12 -0400] stormerider: what service should i look at to troubleshoot this error? merb : chef-server (api) : worker (port 4000) ~ Connection failed - user: chef - (Bunny::ProtocolError)
[2012-08-08 21:51:19 -0400] yfeldblum: stormerider, see if rabbitmq is alive
[2012-08-08 21:52:02 -0400] lflux: more of a ruby question, but is there a way to manipulate octets in an IPv4 address without having to resort to bit-twiddling?
[2012-08-08 21:53:56 -0400] stormerider: yfeldblum: thanks. i moved my chef host from us-east to us-west and it looks like rabbit got mucked up in the process. it's running but there doesnt seem to be a config file there.
[2012-08-08 21:54:06 -0400] stormerider: but now i know where to look :)
[2012-08-08 21:54:50 -0400] yfeldblum: stormerider, "bunny" is a ruby gem that provides a client api/library to talk to rabbitmq
[2012-08-08 21:56:16 -0400] stormerider: ... that makes sense, heh.
[2012-08-08 21:57:10 -0400] stormerider: so im not seeing a rabbitmq config file on the old host, either. where is that typically configured, or is it just one of the services that you just start and dont worry about?
[2012-08-08 21:57:39 -0400] yfeldblum: stormerider, don't know
[2012-08-08 21:57:45 -0400] qhartman: lflux, Google says the following when asked about "ruby ip address manipulation": https://github.com/deploy2/ruby-ip/
[2012-08-08 21:57:46 -0400] yfeldblum: stormerider, what version of rabbitmq was on the old and what version is on the new?
[2012-08-08 21:59:08 -0400] stormerider: its the same host, i just migrated it. looking at the logs im wondering if it's related to the hostname being different? from what im seeing rabbit may store its dbs based on the hostname, is that accurate?
[2012-08-08 21:59:34 -0400] stormerider: (literally the same, i copied the AMI between regions after taking a snapshot)
[2012-08-08 22:03:49 -0400] lflux: qhartman: thanks!
[2012-08-08 22:08:38 -0400] stormerider: bingo. was hostname related.
[2012-08-08 22:08:48 -0400] stormerider: and my nginx proxy node now works, too.
[2012-08-08 22:08:50 -0400] stormerider: thanks!
[2012-08-08 22:52:06 -0400] syphon: Anyone know if chef-solo on Windows has problems with the -r parameter (remote cookbooks over http)?
[2012-08-08 22:52:37 -0400] syphon: I've got this setup working on a centos box, but for some reason, chef-solo in windows is crashing and I'm trying to figure out if it's a known bug
[2012-08-08 22:55:32 -0400] saschagehlich: hey, the deployment of one of my cookbooks failed, so my current state is broken. how do i force chef-client to reinstall everything I added to the role?
[2012-08-08 23:02:21 -0400] qhartman: saschagehlich, simply running chef-client again should do what you want
[2012-08-08 23:04:08 -0400] saschagehlich: qhartman: nvm, it was my fault...
[2012-08-08 23:04:11 -0400] saschagehlich: thanks anyway :)
[2012-08-08 23:18:00 -0400] cap10morgan: I'm trying to dump all my nodes w/ knife with something like `knife node list | awk '{print $1}' | xargs -I{} knife node show -Fj {} > nodes/{}.json` but that's just creating {}.json in the nodes dir over and over. Anyone see what I've got wrong there? Or know a better way?
[2012-08-08 23:36:41 -0400] hoover_damm: cap10morgan, for i in `knife node list | awk '{print $1}'`;do knife node show -Fj $i > nodes/$i.json;fi
[2012-08-08 23:37:01 -0400] hoover_damm: I admit i don't use xargs as much as I should
[2012-08-08 23:37:11 -0400] hoover_damm: and sometimes it fails me in crappy ways
[2012-08-08 23:37:43 -0400] cap10morgan: hoover_damm: excellent suggestion, thank you. I should use xargs less and the shell more. xargs always fails when the going gets weird. :)
[2012-08-08 23:38:02 -0400] hoover_damm: cap10morgan, totally
[2012-08-08 23:38:55 -0400] qhartman: If I set a variable inside a ruby_block, is it available outside that context? If not, if I set a variable outside the ruby block, can I change its' value inside the block?
[2012-08-08 23:41:11 -0400] cap10morgan: hoover_damm: that totally works w/ a small s/fi/done/ at the end. :)
[2012-08-08 23:41:26 -0400] hoover_damm: cap10morgan, eh I always forget fi/done
[2012-08-08 23:41:26 -0400] hoover_damm: :)
[2012-08-08 23:46:52 -0400] cap10morgan: i feel like there should be a knife plugin for this
[2012-08-08 23:46:56 -0400] cap10morgan: maybe I'll write it
[2012-08-08 23:47:16 -0400] cap10morgan: "dump all [whatevers] and put them into the expected file in the expected dir"
[2012-08-08 23:47:52 -0400] hoover_damm: there is actually
[2012-08-08 23:47:58 -0400] cap10morgan: oh yeah?
[2012-08-08 23:49:24 -0400] hoover_damm: yeah i've seen a few chef backup / knife backups... off hand can't find em
[2012-08-08 23:49:55 -0400] cap10morgan: jtimberman has a chef server backup knife script, but it dumps everything into a subdir of ~/.chef/
[2012-08-08 23:50:00 -0400] cap10morgan: which isn't really what I want
[2012-08-08 23:50:31 -0400] cap10morgan: but it's probably close enough that any knife plugin should be based on that code
[2012-08-08 23:50:35 -0400] hoover_damm: you use hosted right?
[2012-08-08 23:50:40 -0400] cap10morgan: yeah
[2012-08-08 23:51:43 -0400] hoover_damm: that's a little more difficult
[2012-08-08 23:52:08 -0400] cap10morgan: ok gotta run. thanks again, hoover_damm.
[2012-08-08 23:52:09 -0400] hoover_damm: basically the knife node show is the easiest method
[2012-08-08 23:52:29 -0400] hoover_damm: might be better to iterate it in shef -z
[2012-08-08 23:52:35 -0400] hoover_damm: and just regular ruby
