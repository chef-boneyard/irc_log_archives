[2012-08-10 00:04:22 -0400] jtimberman: littleidea: isn't razor specific to puppet? or is it integrated separately?
[2012-08-10 00:05:15 -0400] littleidea: jtimberman: it's a stand alone service with integrations to puppet
[2012-08-10 00:05:25 -0400] littleidea: I haven't really dug into the specifics
[2012-08-10 00:05:42 -0400] littleidea: but it looks like it is fairly decoupled
[2012-08-10 00:07:14 -0400] jtimberman: ah interesting.
[2012-08-10 01:34:38 -0400] ssutch: any idea why, when running in chef, a service will refuse to start, but when running via ssh, the service starts fine
[2012-08-10 01:39:23 -0400] hoover_damm: not off hand, check the error logs?
[2012-08-10 01:42:02 -0400] nicholasf: hi, how many peeps here are using centos?
[2012-08-10 01:42:46 -0400] ssutch: hoover_damm: the service's error logs?
[2012-08-10 01:42:53 -0400] ssutch: there are no errors showing in chef
[2012-08-10 01:42:57 -0400] ssutch: it just kinda ignores it
[2012-08-10 01:43:33 -0400] ssutch: and the service's logs (cassandra, a java process) just show that it's shut down
[2012-08-10 01:43:35 -0400] hoover_damm: service error logs
[2012-08-10 01:43:47 -0400] hoover_damm: because without more detail that's shooting in the dark
[2012-08-10 01:43:59 -0400] ssutch: yeah, cassandra just says it's shut down
[2012-08-10 01:44:14 -0400] syphon: Anyone here use Chef-Solo on Windows? The -r parameter (cookbook over http) doesn't work properly, Chef-Solo still crashes unless you point it to a config file with cookbook_path defined (even though it doesn't use it!)
[2012-08-10 01:45:56 -0400] syphon: Should I open a bug to opscode or something on this?
[2012-08-10 01:47:18 -0400] beandip: I'm having some syntax issues setting an attribute as an array in my attributes/default.rb
[2012-08-10 01:47:57 -0400] beandip: default['redisio']['servers'] = [{'port' => '6379'}, {'port' => '6380', 'slaveof' => { 'address' => '127.0.0.1', 'port' => '6379' }]
[2012-08-10 01:48:24 -0400] beandip: that gives me a syntax error:attributes/default.rb:2: syntax error, unexpected ']', expecting '}'
[2012-08-10 01:48:30 -0400] jtimberman: ssutch: possibly requires a tty?
[2012-08-10 01:48:46 -0400] ssutch: @jtimberman maybe
[2012-08-10 01:49:13 -0400] beandip: lol
[2012-08-10 01:49:15 -0400] beandip: nevermind
[2012-08-10 01:49:19 -0400] beandip: missing a }
[2012-08-10 01:49:35 -0400] beandip:  /facepalm
[2012-08-10 01:49:56 -0400] ssutch: jtimberman if it does, what should i do?
[2012-08-10 01:50:07 -0400] ssutch: i have also tried using the `bash` resource
[2012-08-10 01:51:20 -0400] ssutch: this is the relevant part of the cookbook: https://gist.github.com/3310244
[2012-08-10 01:51:28 -0400] ssutch: it shuts down the process but never boots it back up
[2012-08-10 02:20:35 -0400] stuartrexking: I am trying to understand the relationship between gunicorn, virtualenv and supervisord in the application_python cookbook for non django apps. The gunicorn docs suggest installing gunicorn directly into it's own application specific virtualenv. I can't see a way to do this in non-django apps with the application_python cookbook. Is there something I am missing here?
[2012-08-10 02:21:29 -0400] stuartrexking: I am look for best practice / accepted convention.
[2012-08-10 02:22:00 -0400] ssutch: you can just run pip install gunicorn inside the virtualenv
[2012-08-10 02:22:54 -0400] stuartrexking: ssutch: Thanks, but how does supervisord know to use that virtualenv for the subprocess?
[2012-08-10 02:23:19 -0400] ssutch: you will launch that process specifically from your virtualenv
[2012-08-10 02:24:06 -0400] ssutch:  /path/to/virtualenv/bin/gunicorn_django <gunicorn-args>
[2012-08-10 02:24:22 -0400] ssutch: it will figure out the path
[2012-08-10 02:27:37 -0400] stuartrexking: ssutch: I am still missing something here. What is the role of supervisord then?
[2012-08-10 02:27:57 -0400] ssutch: supervisor starts up your processes and manages their lifecycle
[2012-08-10 02:28:11 -0400] ssutch: so you don't have to write /init.d scripts and shit
[2012-08-10 02:32:41 -0400] ssutch: google supervisord...
[2012-08-10 04:05:10 -0400] erratic: meow meow meow meow
[2012-08-10 04:11:14 -0400] beandip: Woof
[2012-08-10 04:11:49 -0400] beandip: If I want one cookbooke to override attributes in a cookbook I'm calling via recipe, how would I accomplish that?
[2012-08-10 04:14:00 -0400] yfeldblum: node.default["asdf"]["wxyz"] = 34
[2012-08-10 04:40:38 -0400] jswanson: A noob question: opscode wiki examples typically uses strings instead of symbols when defining and accessing attributes
[2012-08-10 04:40:45 -0400] jswanson: is there a specific reason for this?
[2012-08-10 04:44:41 -0400] yfeldblum: jswanson, because in all programming languages, we use strings when we want to talk about string-like things
[2012-08-10 04:45:06 -0400] erikh: symbols leak.
[2012-08-10 04:46:25 -0400] yfeldblum: jswanson, when you're dealing with a data structure composed of atoms, arrays, and string-keyed maps, you want to deal with it as data; strings are data, but symbols are typically not data (and aren't designed to be data)
[2012-08-10 05:08:32 -0400] beandip: yfeldblum: can I set them from the attributes/default.rb in the cookbook I'm wrapping from
[2012-08-10 05:08:57 -0400] beandip: ie. cookbook foo has include_recipe "bar"
[2012-08-10 05:09:29 -0400] beandip: and I want foo/attributes/default.rb to set attributes for recipe bar
[2012-08-10 05:10:21 -0400] beandip: so I can use community cookbooks, wrapped in private cookbooks and set attributes in the cookbook and not at the role level
[2012-08-10 05:10:50 -0400] beandip: I'm basically trying to avoid having default attributes that are global
[2012-08-10 05:11:09 -0400] beandip: if that makes sense
[2012-08-10 05:13:48 -0400] yfeldblum: beandip, you can set them in the calling recipe immediately before calling `include_recipe`
[2012-08-10 05:14:26 -0400] beandip:     yfeldblum, I can't set the in the calling recipe's attributes/default.rb?
[2012-08-10 05:14:46 -0400] beandip: I have to do it from the recipe?
[2012-08-10 05:16:11 -0400] yfeldblum: beandip, you can, but it would undoubtedly be weird and it may not work as expected
[2012-08-10 05:16:30 -0400] yfeldblum: beandip, think of the attributes files in your cookbook as the cookbook's public interface
[2012-08-10 05:16:46 -0400] yfeldblum: beandip, you don't put another cookbook's public interface into your cookbook's public interface
[2012-08-10 05:18:47 -0400] beandip: I think it would be cleaner
[2012-08-10 05:19:24 -0400] beandip: I'm looking to ditch the use of roles for anything that isn't global across my whole org
[2012-08-10 05:19:36 -0400] yfeldblum: beandip, why?
[2012-08-10 05:19:47 -0400] beandip: because it makes sense
[2012-08-10 05:20:23 -0400] beandip: http://tinyurl.com/8fq9jp3
[2012-08-10 05:20:34 -0400] beandip: that's one point of inspiration
[2012-08-10 05:21:55 -0400] yfeldblum: beandip, with which i'm not inclined to agree :P
[2012-08-10 05:22:07 -0400] beandip: :P
[2012-08-10 05:22:16 -0400] beandip: I am
[2012-08-10 05:22:23 -0400] beandip: but either way, it's a matter of preference
[2012-08-10 05:22:53 -0400] yfeldblum: beandip, i can go both ways, depending on the details of the situation
[2012-08-10 05:23:23 -0400] beandip: so many jokes in that comment.... :P
[2012-08-10 05:23:36 -0400] beandip: seriously though, in my org, it makes sense.
[2012-08-10 05:26:47 -0400] hakunin: hoover_damm: hey you there?
[2012-08-10 05:27:42 -0400] hakunin: hoover_damm: was curious if the node search commits to your redis cookbook didn't break anything for chef solo https://github.com/damm/redis/commits/master
[2012-08-10 05:27:53 -0400] hakunin: (before i find out the hard way)
[2012-08-10 05:50:12 -0400] hoover_damm: hakunin, there's no search in it
[2012-08-10 05:50:48 -0400] hoover_damm: oh wait there is lol
[2012-08-10 05:50:48 -0400] hakunin: hoover_damm: there's the code that searches nodes for master or something
[2012-08-10 05:50:48 -0400] hoover_damm: https://github.com/damm/redis/blob/master/recipes/server.rb#L68
[2012-08-10 05:50:55 -0400] hoover_damm: eh just remove it
[2012-08-10 05:51:11 -0400] hoover_damm: and remove the master_server referrences
[2012-08-10 05:51:21 -0400] hakunin: hoover_damm: i'm not sure if it breaks, haven't tried
[2012-08-10 05:51:31 -0400] hoover_damm: hakunin, it really shouldn't
[2012-08-10 05:51:38 -0400] hakunin: hoover_damm: then it probably won't : )
[2012-08-10 05:51:40 -0400] hoover_damm: hakunin, that's a knob you have to turn on :)
[2012-08-10 05:51:47 -0400] hoover_damm: hakunin, not a default for the search to be run
[2012-08-10 05:51:53 -0400] hakunin: cool
[2012-08-10 05:52:15 -0400] hoover_damm: I just got burned awhile ago so I aimed for a dependency free cookbook (including ark)
[2012-08-10 05:52:49 -0400] hoover_damm: the silverware cookbook (then metachef) started blowing up on constants overnight
[2012-08-10 05:52:56 -0400] hoover_damm: for multiple clients
[2012-08-10 05:52:59 -0400] hoover_damm: they hadn't done anything
[2012-08-10 05:53:25 -0400] hoover_damm: so to address it in a way to not have to deal with something haunting us... I fixed it
[2012-08-10 05:53:51 -0400] hoover_damm: really made me sad to see a customer on rackspace with their own chef-server and another client on hosted get the same failure
[2012-08-10 05:54:02 -0400] hoover_damm: different rubies, different omnibus's
[2012-08-10 05:54:24 -0400] hakunin: i see
[2012-08-10 05:54:31 -0400] hoover_damm: ohwell past is the paste :) now you know why I made that cookbook
[2012-08-10 05:54:38 -0400] hoover_damm: s/paste/past
[2012-08-10 05:54:40 -0400] hoover_damm: paste the paste in
[2012-08-10 05:54:41 -0400] hoover_damm: lol
[2012-08-10 05:54:58 -0400] hakunin: hoover_damm: you gonna be seeing more of me again around here
[2012-08-10 05:55:03 -0400] hakunin: after getting all my chef+capistrano setup to fully-automate launching numerous staging servers, we actually got the new redesigned/upgraded app ready for release, so now at the point where I need to build a new production setup
[2012-08-10 05:55:11 -0400] hakunin: (funny i actually had the paste to paste)
[2012-08-10 05:55:13 -0400] hoover_damm: nice
[2012-08-10 05:55:20 -0400] hoover_damm: glad to hear it
[2012-08-10 05:55:38 -0400] hoover_damm: pardon my itch of capistrano... i'd love to see everyone not use it.
[2012-08-10 05:55:50 -0400] hakunin: hoover_damm: i'm a rubyist
[2012-08-10 05:56:06 -0400] hakunin: capistrano is nothing but an ssh wrapper for me really for the most part
[2012-08-10 05:56:15 -0400] jswanson: yfeldblum: thank you
[2012-08-10 05:56:21 -0400] hoover_damm: hakunin, https://github.com/damm/chef-unicorn/blob/master/templates/default/unicorn.rb.erb#L23-L34
[2012-08-10 05:56:44 -0400] hoover_damm: hakunin, basically capistrano with the pty option set to false does some obsecure stuff that makes unicorn hot reload break in a 'neat' way
[2012-08-10 05:56:49 -0400] hoover_damm: hakunin, it required that little hack there
[2012-08-10 05:57:09 -0400] hoover_damm: granted Bundler acts differently on BUNDLE_GEMFILE based on your framework
[2012-08-10 05:57:19 -0400] hoover_damm: Rails it'll actually end up in current, sinatra/rack users get the real path
[2012-08-10 05:57:32 -0400] hakunin: hoover_damm: that's weird
[2012-08-10 05:57:33 -0400] hoover_damm: issue is in hot reload you want it to reload the 'current' gemfile
[2012-08-10 05:57:40 -0400] hoover_damm: not the 3 year old release one
[2012-08-10 05:57:47 -0400] hoover_damm: or whatever
[2012-08-10 05:57:59 -0400] hoover_damm: so because your logging in without a pty
[2012-08-10 05:58:00 -0400] hoover_damm: :)
[2012-08-10 05:58:02 -0400] hoover_damm: tee hee
[2012-08-10 05:58:19 -0400] hakunin: default_run_options[:pty] = true
[2012-08-10 05:58:23 -0400] hakunin: guess i'm safe
[2012-08-10 05:59:10 -0400] hoover_damm: you end up ddosing yourself with logins
[2012-08-10 05:59:29 -0400] hoover_damm: it's a double edged sword as capistrano can make a few logins to your server at the same time
[2012-08-10 05:59:42 -0400] hoover_damm: so that's why that hack is there
[2012-08-10 05:59:46 -0400] hoover_damm: so you can have pty set to false
[2012-08-10 05:59:47 -0400] hoover_damm: and still work
[2012-08-10 06:00:03 -0400] hakunin: yeah i'm pretty confused about some of what it does
[2012-08-10 06:00:15 -0400] hoover_damm: bundle exec bash
[2012-08-10 06:00:19 -0400] hoover_damm: export | less
[2012-08-10 06:00:55 -0400] hoover_damm: basically bundle exec hacks the path, adds GEM_HOME and BUNDLE_GEMFILE
[2012-08-10 06:01:11 -0400] hoover_damm: and in a hot reload you want those to be the right values
[2012-08-10 06:01:15 -0400] hoover_damm: not the current, but the new
[2012-08-10 06:01:24 -0400] hakunin: right
[2012-08-10 06:01:41 -0400] hoover_damm: these are added if you bundle exec or if you use binstubs
[2012-08-10 06:02:14 -0400] hoover_damm: pretty much welcome to ruby... unless you wanna fork bundler (and please don't bother it won't help) ... have fun!
[2012-08-10 06:03:03 -0400] hoover_damm: hakunin, don't loose too many nights sleep
[2012-08-10 06:03:04 -0400] hoover_damm: cheers
[2012-08-10 06:03:10 -0400] hakunin: hoover_damm: this is slightly unrelated, but can you explain this one thing to me?
[2012-08-10 06:03:30 -0400] hakunin: hoover_damm: is it normal that i have to use provisioning user to restart bluepill stuff?
[2012-08-10 06:04:17 -0400] hakunin: hoover_damm: well, maybe not a question for today, cheers
[2012-08-10 06:44:57 -0400] BryanWB_: ohai chefs!
[2012-08-10 07:06:52 -0400] kyank: Anyone know of a good guide to deploying an SSL-protected site (certificates and all) with Apache using Chef?
[2012-08-10 07:07:32 -0400] kyank: I think I can figure it out, using data bags for my production certificates (and an encrypted data bag for my certificate key), but Id rather follow a good guide if there is one.
[2012-08-10 09:21:18 -0400] bugant: hi there
[2012-08-10 09:22:01 -0400] bugant: I'm trying to use the opscode nginx cookbook but want to use upstart instead of the /etc/init.d/ script
[2012-08-10 09:22:13 -0400] bugant: this is wath I'm doing http://www.hastebin.com/gadajujuqi.vbs
[2012-08-10 09:22:29 -0400] bugant: but then it hangs with FATAL: Errno::ENOENT: service[nginx] (nginx::default line 32) had an error: Errno::ENOENT: No such file or directory - /etc/init.d/nginx status
[2012-08-10 09:23:08 -0400] bugant: so it's still using the /etc/init.d script I guess
[2012-08-10 09:26:49 -0400] bugant: maybe I can just skip the nginx cookboook, install it using the package command into a custom recipe and the defining the service by myself
[2012-08-10 11:06:23 -0400] corp: greetings
[2012-08-10 11:07:20 -0400] corp: anyone have issues with 'knife ssh' tty allocation?
[2012-08-10 11:08:10 -0400] corp: the same command run via ssh works. for example, /etc/init.d/memcached restart
[2012-08-10 11:08:44 -0400] corp: interestingly, a run of the chef client via knife also has this effect. chef won't start memcached
[2012-08-10 12:11:15 -0400] masterkorp: How can i for a chef client run ?
[2012-08-10 12:11:29 -0400] masterkorp: of a particular node from knife ?
[2012-08-10 12:20:58 -0400] maruq: hey guys
[2012-08-10 12:21:18 -0400] maruq: just wanted to check, is there a way to attach an ebs volume using knife ec2 server create?
[2012-08-10 12:25:22 -0400] gwaldo: @maruq - it doesn't look like you can do it on the create, but you should be able to do it in a recipe or via knife-ssh
[2012-08-10 12:25:59 -0400] gwaldo: rather "in post-install config"
[2012-08-10 12:26:05 -0400] gwaldo: (method doesn't matter)
[2012-08-10 12:27:31 -0400] maruq: gwaldo: thanks, but I kind of want it to exist on boot
[2012-08-10 12:28:02 -0400] maruq: gwaldo: I guess ec2-run-instances, then knife bootstrap could do it
[2012-08-10 12:30:25 -0400] masterkorp: So i just added a reciope to a role
[2012-08-10 12:30:41 -0400] masterkorp: but that recipe is not on the run list of the nodes that contain that role
[2012-08-10 12:31:00 -0400] masterkorp: do i need to tell the nodes to fecth something from the role ?
[2012-08-10 12:31:36 -0400] maruq: masterkorp: did you re-run chef-client on the nodes?
[2012-08-10 12:32:05 -0400] maruq: masterkorp: ie. add recipe to role, upload role to server, run chef-client on nodes to pull data from server
[2012-08-10 12:32:08 -0400] masterkorp: yeah it did re-recue
[2012-08-10 12:32:19 -0400] gwaldo: masterkorp, you either need to run chef-client or wait for the periodic recheck
[2012-08-10 12:32:50 -0400] masterkorp: i did that
[2012-08-10 12:32:57 -0400] masterkorp: no errors at all strange
[2012-08-10 12:33:47 -0400] gwaldo: are you using Environments (and if so, in the proper environment)?
[2012-08-10 12:35:36 -0400] masterkorp: http://pastie.org/4449478
[2012-08-10 12:35:42 -0400] masterkorp: chef-client manual run
[2012-08-10 12:36:04 -0400] masterkorp: monitoring role http://pastie.org/private/jkfygazw2fh0pt81srcrtw
[2012-08-10 12:36:57 -0400] masterkorp: the missing recipe is monit::nagios
[2012-08-10 12:37:33 -0400] gwaldo: Have you removed and re-added the role to the server?
[2012-08-10 12:38:07 -0400] masterkorp: no
[2012-08-10 12:38:12 -0400] gwaldo: I remember something like this, but it's taunting me from the back of my head...
[2012-08-10 12:38:14 -0400] masterkorp: Do i need to that
[2012-08-10 12:38:21 -0400] gwaldo: it's worth trying
[2012-08-10 12:38:35 -0400] maruq: it's the bushfire recipe you are missing?
[2012-08-10 12:38:40 -0400] gwaldo: remove, chef-client, add, chef-client
[2012-08-10 12:39:08 -0400] maruq: did you upload the cookbook + role to the server?
[2012-08-10 12:39:35 -0400] masterkorp: Do i do a manual run between them ?
[2012-08-10 12:39:38 -0400] gwaldo: that sounds like it
[2012-08-10 12:39:42 -0400] masterkorp: maruq: yeah i check manually?
[2012-08-10 12:40:06 -0400] masterkorp: gwaldo: remove chef-client its a very dangerous process
[2012-08-10 12:40:20 -0400] masterkorp: will not do unless i have a strong reason
[2012-08-10 12:40:28 -0400] masterkorp: will add the recipe by hand
[2012-08-10 12:41:57 -0400] gwaldo: your chef-client is part of this Role?
[2012-08-10 12:42:24 -0400] masterkorp: ? elaborate
[2012-08-10 12:43:33 -0400] gwaldo: I'm not suggesting that you remove chef-client; just that after uploading the recipe and role, (if it's still not running) that you remove the role from the server, run chef-client, re-add the role, and run chef-client again
[2012-08-10 12:46:54 -0400] masterkorp: that is too dangerous
[2012-08-10 12:47:09 -0400] masterkorp: i will not rist to remove a full nagios right
[2012-08-10 12:47:13 -0400] gwaldo: how so?
[2012-08-10 12:47:13 -0400] masterkorp: now
[2012-08-10 12:47:41 -0400] masterkorp: because removing that role would disable all our monitoring
[2012-08-10 12:48:04 -0400] masterkorp: FATAL: ArgumentError: Cannot find a recipe matching nagios in cookbook monit
[2012-08-10 12:48:08 -0400] gwaldo: Last that I knew, removing a recipe does not change the system; it only removes the management of those components
[2012-08-10 12:48:12 -0400] masterkorp: its there goddamint
[2012-08-10 12:49:01 -0400] masterkorp: alfredo@openvpn:/home/chef-repo/chef-production/current/site-cookbooks/monit$ cat recipes/nagios.rb
[2012-08-10 12:49:06 -0400] masterkorp: its here
[2012-08-10 12:49:28 -0400] masterkorp: gwaldo: i added the recipce manually
[2012-08-10 12:54:02 -0400] masterkorp: i have no idea what's causing this
[2012-08-10 12:54:51 -0400] gwaldo: masterkorp: could you restate the problem you're having?
[2012-08-10 12:55:19 -0400] masterkorp: gwaldo: the chef-client claims that the recipe monit::nagios does not exist
[2012-08-10 12:55:48 -0400] gwaldo: can you see that recipe on your chef-server?
[2012-08-10 12:55:56 -0400] BryanWB_: i have one node that shows up in all searches
[2012-08-10 12:56:04 -0400] gwaldo: have you done 'knife cookbook upload monit' ?
[2012-08-10 12:56:22 -0400] masterkorp: gwaldo: yeah we use capistrano
[2012-08-10 12:56:58 -0400] gwaldo: dumb question: are you sure that it's spelled right in all places?
[2012-08-10 12:57:09 -0400] BryanWB_: gwaldo: yes
[2012-08-10 12:57:30 -0400] gwaldo: sorry, BryanWB_ , that wasn't directed at you
[2012-08-10 12:58:08 -0400] masterkorp: gwaldo: i see the problem, our capistrano deploy is failing to upload it
[2012-08-10 12:59:04 -0400] gwaldo: masterkorp: I've never had the pleasure of dealing with cap myself; my old gig had used it before I got there.  There had been extremely mixed feelings about it.
[2012-08-10 12:59:35 -0400] masterkorp: you mean the hate ?
[2012-08-10 12:59:41 -0400] masterkorp: i hate everything about it
[2012-08-10 12:59:45 -0400] gwaldo: lol
[2012-08-10 12:59:50 -0400] masterkorp: how it deploys to /home/xx/
[2012-08-10 13:00:03 -0400] masterkorp: deb packages for the win
[2012-08-10 13:00:15 -0400] masterkorp: one day i will convince my team
[2012-08-10 13:00:37 -0400] gwaldo: Some people liked it, but it didn't work well for our particular setup
[2012-08-10 13:01:03 -0400] gwaldo: (It was a mostly RoR shop
[2012-08-10 13:01:04 -0400] gwaldo: )
[2012-08-10 13:03:10 -0400] BryanWB_: i really like capistrano ;)
[2012-08-10 13:08:51 -0400] geekbri: I'm not wild about capistrano, but there aren't that many other good solutions out there in the same space anyway :)
[2012-08-10 13:08:54 -0400] geekbri: You could try fabric
[2012-08-10 13:09:03 -0400] geekbri: A lot of places I have been end up rolling their own deployment software.
[2012-08-10 13:09:17 -0400] geekbri: which certainly is blech
[2012-08-10 13:18:20 -0400] masterkorp: geekbri: debian packages
[2012-08-10 13:18:36 -0400] masterkorp: capistrano is defective by design. period
[2012-08-10 13:30:15 -0400] yfeldblum: masterkorp, how much more roundaboutness does that entail in the process of deploying an application?
[2012-08-10 13:31:11 -0400] masterkorp: roundawhat?
[2012-08-10 13:31:15 -0400] chrisr244: Is there a difference between clients vs. users?
[2012-08-10 13:31:40 -0400] yfeldblum: masterkorp, what's the process of deploying an application?
[2012-08-10 13:32:14 -0400] gwaldo: chrisr244 Clients can be thought of as 'things that have credentials', and can be people/users or computers.
[2012-08-10 13:32:31 -0400] masterkorp: yfeldblum: for the debian process, or the capistrano process that we use ?
[2012-08-10 13:32:32 -0400] gwaldo: Nodes are things that are managed via chef.
[2012-08-10 13:32:57 -0400] gwaldo: So machines that you are managing with Chef have both a node entry and a client entry
[2012-08-10 13:33:25 -0400] yfeldblum: masterkorp, yes, for both, and how do the two processes differ?
[2012-08-10 13:34:03 -0400] masterkorp: yfeldblum: that will get in a long discussion
[2012-08-10 13:34:10 -0400] yfeldblum: chrischris, clients (or api-clients) can access the chef-server-api, while users can access the chef-server-webui
[2012-08-10 13:34:30 -0400] yfeldblum: masterkorp, it's 9:30am for me - i've got all day :D
[2012-08-10 13:35:52 -0400] yfeldblum: masterkorp, currently, i believe, hosted-chef and private-chef are set up such that every client has an associated user and vice versa
[2012-08-10 13:36:13 -0400] yfeldblum: chrisr244, sorry those ^ ^ ^ should have been to you
[2012-08-10 13:37:59 -0400] masterkorp: yfeldblum: that was nothing to do with the debian vs capistrano, i used chef with debians before
[2012-08-10 13:39:57 -0400] geekbri: the debians
[2012-08-10 13:40:23 -0400] masterkorp: lol, that sounded cool :p
[2012-08-10 13:43:54 -0400] chrisr244: okay, that makes sense I think. I know for hosted chef there's client keys, user keys, and an organization validation key. Just trying to figure out what's necessary for what. So if it's not a "person", I can use the client key, if it's a "person", I can use my user key?
[2012-08-10 13:45:12 -0400] chrisr244: Do I have the basic idea anyway? :)
[2012-08-10 13:58:08 -0400] yfeldblum: chrisr244, with hosted-chef, the user key is the client key (but you have get it from the user key interface, not the client key interface, apparently)
[2012-08-10 13:58:28 -0400] chrisr244: gotcha
[2012-08-10 14:04:18 -0400] japage: japage
[2012-08-10 14:04:25 -0400] japage: oops
[2012-08-10 14:24:09 -0400] geekbri: Anybody know the format necessary to get knife node show's -a option to show a nested attribute ?
[2012-08-10 14:24:22 -0400] geekbri: EG attribute is node['level1']['level2']
[2012-08-10 14:24:39 -0400] geekbri: I only want to level2 not level 1
[2012-08-10 14:24:44 -0400] siezer: -a level1.level2
[2012-08-10 14:24:47 -0400] geekbri: ty
[2012-08-10 14:24:51 -0400] siezer: np
[2012-08-10 14:31:44 -0400] geekbri: That saves me from having to dig into the code :
[2012-08-10 14:31:45 -0400] geekbri: :)
[2012-08-10 14:33:04 -0400] ranjibd: geekbri, in code and knife command line attributes nesting is done with '.' for ohai command line with '/' and in solr searcg with '_'
[2012-08-10 14:35:34 -0400] geekbri: ranjibd: Most excellent.  That will be going into evernote
[2012-08-10 14:36:23 -0400] geekbri: (although in code you can access them via the [] method as well as .)
[2012-08-10 14:38:29 -0400] ranjibd: yup in code node.parent.child or node[:parent][:child] or node['parent']['child']
[2012-08-10 15:42:25 -0400] bflad: Hi everyone. Is there a way to determine a node's organization (via attribute or otherwise)? closest I see is node["chef_client"]["server_url"] then parsing away the base URL
[2012-08-10 15:49:59 -0400] yfeldblum: bflad, why do you need to do that?
[2012-08-10 15:50:42 -0400] bflad: we manage multiple organizations within my company and hoping to split out metrics based on org
[2012-08-10 15:53:12 -0400] yfeldblum: bflad, chef doesn't know whether it's talking to hosted-chef, private-chef, open-source chef-server-api, or a chef-server-api someone else implements in c, python, perl, or assembly
[2012-08-10 15:53:48 -0400] bflad: that's a fair point.
[2012-08-10 15:53:56 -0400] yfeldblum: bflad, so if your recipe knows it's only ever talking to hosted-chef, you can probably parse Chef::Config.chef_server_url
[2012-08-10 15:54:22 -0400] bflad: yfeldblum: okay that makes sense - thanks!
[2012-08-10 15:54:34 -0400] yfeldblum: bflad, but really this sounds like the type of thing to put elsewhere, such as in an environment
[2012-08-10 15:55:15 -0400] erikh: require 'chef/config'; Chef::Config.from_file('/etc/chef/client.rb'); Chef::Config[:chef_server_url]
[2012-08-10 15:55:23 -0400] erikh: you probably don't need the first two lines.
[2012-08-10 15:56:12 -0400] erikh: bflad: ^
[2012-08-10 15:57:10 -0400] bflad: erikh: thanks
[2012-08-10 16:16:42 -0400] erikh: jtimberman: do you maintain the rabbitmq cookbook?
[2012-08-10 16:17:59 -0400] erikh: I have some fixes, more or less, that I wanted to discuss
[2012-08-10 16:20:30 -0400] geekbri: erikh: http://community.opscode.com/cookbooks/rabbitmq looks to me like thats not a jtimberman special
[2012-08-10 16:20:48 -0400] geekbri: erikh: did you make changes already, or are you looking to discuss potential changes?
[2012-08-10 16:20:52 -0400] erikh: aha
[2012-08-10 16:20:54 -0400] geekbri: if you made changes you could always open a jira ticket
[2012-08-10 16:21:10 -0400] erikh: no, I know what the fix is, but it's stupid simple and I'm trying to shamelessly avoid the jira/pull request dance
[2012-08-10 16:21:23 -0400] geekbri: I dont think there is any avoiding that :)
[2012-08-10 16:21:36 -0400] erikh: basically if you change the mnesia dir it doesn't get created ahead of time and the recipe crashes
[2012-08-10 16:35:39 -0400] jtimberman: erikh: you don't have to do a pull request, just open a ticket and resolve it with a link to your commit :)
[2012-08-10 16:36:20 -0400] erikh: ok, I'll do that later today
[2012-08-10 16:36:27 -0400] erikh: making devops awesomeness atm
[2012-08-10 16:36:44 -0400] erikh: chef-driven RAILS_ENV
[2012-08-10 16:37:05 -0400] jtimberman: nice :)
[2012-08-10 17:00:19 -0400] jcran: possibly dumb question - is there a built-in way to modify an existing file?
[2012-08-10 17:00:28 -0400] jcran: vs using a template for the whole file
[2012-08-10 17:06:57 -0400] yfeldblum: erikh, why is RAILS_ENV not always "production"?
[2012-08-10 17:27:27 -0400] coderanger: jcran: Sure, you can, we just don't recommend it since it makes idempotence much much harder
[2012-08-10 17:29:26 -0400] benjaminws: Is there a recommended way to ensure a chef_gem is installed *before* a library is loaded? I've pushed some logic down to a library, but there doesn't seem to be a clear way to ensure it's loaded before the library is run through Kernel.load()
[2012-08-10 17:29:41 -0400] benjaminws: wow, totally repeated myself
[2012-08-10 17:29:43 -0400] benjaminws: sorry about that
[2012-08-10 17:29:46 -0400] benjaminws: (cold meds)
[2012-08-10 17:34:37 -0400] siezer: how can I run a single unit test? its trying to load some library thats normally loaded in a rake task: https://gist.github.com/fc3b24f668c41b1690e1
[2012-08-10 17:37:57 -0400] jtimberman: coderanger: its not just that it makes idempotence harder. that's actually a minor issue. the bigger problem is it makes things harder to reason about when a file can be modified in multiple places.
[2012-08-10 17:38:12 -0400] jtimberman: "where the hell is this setting coming from?!?!.... grep -Rl, ohhhhh"
[2012-08-10 17:38:20 -0400] jtimberman: :)
[2012-08-10 17:44:24 -0400] hoover_damm: erikh, lol chef-driven rails_env... I did that
[2012-08-10 17:44:30 -0400] hoover_damm: erikh, staging was staging, production was production
[2012-08-10 17:44:44 -0400] hoover_damm: erikh, well worth it if you run a rails shop because it removes a little confusion
[2012-08-10 17:45:32 -0400] siezer: anyone? beuller?
[2012-08-10 17:47:41 -0400] paulmooring: siezer: looks like it's missing a require in there
[2012-08-10 17:48:31 -0400] erikh: hoover_damm: per-user dev environments
[2012-08-10 17:48:45 -0400] erikh: when I'm done it'll have RDS integration too so they can get on-the-fly production dumps
[2012-08-10 17:49:07 -0400] erikh: and they'll be one deploy away from changing their database server.
[2012-08-10 17:49:21 -0400] erikh: with that and logstash they'll have queues to tail logs
[2012-08-10 17:49:30 -0400] erikh: etc.
[2012-08-10 17:49:40 -0400] erikh: hope to get it knocked out in about two weeks.
[2012-08-10 17:49:42 -0400] hoover_damm: erikh, haven't done that in awhile
[2012-08-10 17:49:47 -0400] hoover_damm: erikh, enjoy it
[2012-08-10 17:51:42 -0400] benjaminws: So, let me rephrase my question. I have a chef library in a cookbook that needs to load a ruby lib. The problem is, the chef library is loaded before the recipe that installs the chef_gem. Any known-good way to solve this?
[2012-08-10 17:52:11 -0400] benjaminws: use the chef_gem resource in a library doesn't work.
[2012-08-10 17:52:52 -0400] siezer: benjaminws in the cookbook, have the default recipe load the chef_gem in the compile phase with chef_gem "somegem" do action :install end.run_action(:install)
[2012-08-10 17:53:34 -0400] siezer: then make sure cookbookname::default is loaded before any recipe that needs to use the library
[2012-08-10 17:53:43 -0400] erratic: ``On a Chef Server, you can recreate the key by following these steps. First you'll want to remove your validation key on the server, which is typically stored at /etc/chef/validation.pem. Afterwards you can restart the chef-server to create a new key pair on both the disk and in the database:''
[2012-08-10 17:53:54 -0400] erratic: for automation reasons .... I need to provide my own .pem files
[2012-08-10 17:54:05 -0400] erikh: man
[2012-08-10 17:54:07 -0400] erratic: I figured out how to provide them on disk
[2012-08-10 17:54:12 -0400] erratic: how do I put them in teh database too
[2012-08-10 17:54:19 -0400] erikh: is there a good reason chef 10.12.0 depends on <= 1.6.1 json?
[2012-08-10 18:01:37 -0400] erratic: ... the keys are the same
[2012-08-10 18:01:50 -0400] erratic: wtf is this magic
[2012-08-10 18:02:04 -0400] paulmooring: siezer: I got the same error, but changing the 'Matchers' reference to 'RSpec::Matchers' in spec_helper.rb fixed it
[2012-08-10 18:02:31 -0400] erratic: [Fri, 10 Aug 2012 18:01:40 +0000] INFO: HTTP Request Returned 401 Unauthorized:
[2012-08-10 18:02:49 -0400] erratic: retarded chef-server, ran chef-client the key is the same why the hell doesn't it work
[2012-08-10 18:02:55 -0400] siezer: paulmooring yea I went down the "start at the rake file" path and saw it loading that spec_helper...
[2012-08-10 18:03:35 -0400] siezer: trying to figure if it'll be faster to hack a new task into rspec/tasks, or write some specs that load RSpec::Matchers temporarily
[2012-08-10 18:04:15 -0400] siezer: I have awesome_patch, but want to make sure that it comes with specs so btm isn't dissapointed in me when I submit it
[2012-08-10 18:04:19 -0400] paulmooring: siezer: just change spec_helper, there's no case where RSpec::Matchers won't work
[2012-08-10 18:04:37 -0400] erratic: can I turn this off validation_client_name
[2012-08-10 18:04:57 -0400] paulmooring: good call btm's beard makes him too intimidating to disapoint
[2012-08-10 18:05:53 -0400] paulmooring: siezer: fwiw I'm pretty sure a `require 'rspec'` would also fix it
[2012-08-10 18:07:33 -0400] erratic: validation_client_name can I set this to none
[2012-08-10 18:08:14 -0400] siezer: erratic are you on oss or hosted/private
[2012-08-10 18:08:22 -0400] erratic: chef server
[2012-08-10 18:08:26 -0400] erratic: I want to turn off validation
[2012-08-10 18:08:39 -0400] erratic: I dont want it for this server at all
[2012-08-10 18:08:47 -0400] siezer: the validation key is only used when bootstrapping a new node
[2012-08-10 18:08:52 -0400] erratic: I know
[2012-08-10 18:09:20 -0400] siezer: its used to sign the requests to chef server when generating the /etc/chef/client.pem
[2012-08-10 18:09:27 -0400] erratic: ok
[2012-08-10 18:09:31 -0400] erratic: how do I turn it off
[2012-08-10 18:09:34 -0400] siezer: you cant
[2012-08-10 18:09:37 -0400] paulmooring: erratic: the validator isn't as magic as it seems it's just another client with permissions to register more nodes/clients
[2012-08-10 18:09:39 -0400] siezer: also why would you want to?
[2012-08-10 18:09:41 -0400] erratic: k
[2012-08-10 18:10:26 -0400] paulmooring: so there's nothing to turn off, I suppose you could try to remove the validator client on the server
[2012-08-10 18:10:38 -0400] erratic: welp
[2012-08-10 18:10:41 -0400] paulmooring: but the simple fix is, just don't distribute the validaotr key
[2012-08-10 18:10:44 -0400] erratic: I'm officially in a hateful mood now
[2012-08-10 18:10:48 -0400] erratic: that I don't want to be in
[2012-08-10 18:10:51 -0400] erratic: because this won't work
[2012-08-10 18:10:51 -0400] erratic: "/etc/init.d/chef-server stop && cd /root/chef-repo/vagrant/keys/ && tar -xvf keys.tar && cp /root/chef-repo/vagrant/keys/validation.pem /etc/chef/ && cp /root/chef-repo/vagrant/keys/cert.pem /etc/chef/certificates/cert.pem && cp /root/chef-repo/vagrant/keys/key.pem /etc/chef/certificates/ && cp /root/chef-repo/vagrant/keys/webui.pem /etc/chef/ && find /etc/chef -exec dos2unix {} \\; &&
[2012-08-10 18:10:52 -0400] erratic: /etc/init.d/chef-server start"
[2012-08-10 18:11:03 -0400] hoover_damm: wtf?
[2012-08-10 18:11:04 -0400] bawt_: wtf is this magic
[2012-08-10 18:11:10 -0400] erratic: haha
[2012-08-10 18:12:09 -0400] siezer: shit brb guys
[2012-08-10 18:12:12 -0400] erratic: hoover_damm I just wanna use my own keys and I cant understand how this cryptography stuff that I don't even need for my testing environment works apparently
[2012-08-10 18:13:01 -0400] erratic: you know I'm not too worried about a testing environment that is created from vagrant and used for testing and development getting abused...
[2012-08-10 18:13:09 -0400] erratic: apparently thats not reasonable of me
[2012-08-10 18:14:21 -0400] paulmooring: erratic: I'm confused about what you want to do, you're trying to stop the server replace all the keys with another set, then start it back up?
[2012-08-10 18:17:17 -0400] benjaminws: siezer: Thanks, but I don't think I was clear. I'm using the library provided by the gem I'm installing in a cookbook library, which is loaded *before* the recipe. So, I think what I'm looking for is a way to install a chef_gem from a cookbook library.
[2012-08-10 18:17:36 -0400] benjaminws: really what I want is not to do it this way at all.
[2012-08-10 18:17:40 -0400] benjaminws: because this feels wrong.
[2012-08-10 18:18:04 -0400] erratic: benjaminws I'd like to yeah
[2012-08-10 18:18:29 -0400] erratic: I'd like to use a pre-generated set of keys ...
[2012-08-10 18:18:55 -0400] erratic: honestly
[2012-08-10 18:19:02 -0400] erratic: it would make more sense to just not use keys
[2012-08-10 18:19:19 -0400] erratic: but
[2012-08-10 18:19:21 -0400] benjaminws: erratic: bro, use bcrypt
[2012-08-10 18:19:50 -0400] erratic: benjaminws how many rounds should I use
[2012-08-10 18:21:39 -0400] siezer: benjaminws ah. try something like this: https://gist.github.com/3316439
[2012-08-10 18:21:45 -0400] benjaminws: erratic 100 log-rounds because, CPU
[2012-08-10 18:23:38 -0400] siezer: unfortunately, I can't really think of another way around it =\
[2012-08-10 18:25:13 -0400] beandip: I'm trying to set an attribute based on the results of a search.  It works fine when the search returns something.  When the search does not, I get an exception
[2012-08-10 18:25:15 -0400] beandip: TypeError: can't convert Symbol into Integer
[2012-08-10 18:25:27 -0400] beandip: how do I deal with empty search results?
[2012-08-10 18:26:50 -0400] benjaminws: siezer: thanks, giving that a go
[2012-08-10 18:27:31 -0400] hoover_damm: erratic, part of the keys are stored in couchdb, the other part is on the filesystem
[2012-08-10 18:27:48 -0400] hoover_damm: erratic, in order to re-use the same keys over and over you need to not only restore your chef.couch you need to copy those janky files around
[2012-08-10 18:31:14 -0400] erratic: sorry had to step out because we're moving offices and I had to set something up
[2012-08-10 18:31:45 -0400] erratic: benjaminws got a spare crackpipe?
[2012-08-10 18:31:49 -0400] erratic: siezer dang
[2012-08-10 18:32:51 -0400] erratic: siezer this is pki right?
[2012-08-10 18:33:21 -0400] erratic: so I should be able to copy over the keys, and use them if I have them
[2012-08-10 18:34:06 -0400] erratic: something isn't right
[2012-08-10 18:35:11 -0400] erratic: hoover_damm` thank you
[2012-08-10 18:35:25 -0400] erratic: sorry I missed that till now
[2012-08-10 18:36:22 -0400] erratic: thanks so much! I knew it had to be that, I read that earlier but I was more trying to figure out how to use curl or something to update the keys in the database
[2012-08-10 18:43:07 -0400] hoover_damm: erratic, basically couchdb stores half, the other half are on the filesystem... and when they meet each other they accept it :)
[2012-08-10 18:43:14 -0400] hoover_damm: erratic, so both halfs have to be correct for it to work
[2012-08-10 18:43:23 -0400] hoover_damm: i mean you can get chef-server-api without a webui key up sure
[2012-08-10 18:43:30 -0400] hoover_damm: but the webui won't work without a valid working webui key
[2012-08-10 18:44:46 -0400] erratic: hoover_damm yeah I sort of gathered that the other half must be stored in the database based on something I read and I came in here with the intention of finding out like where in the database because _all_docs doesn't reveal anything all that helpful
[2012-08-10 18:46:53 -0400] erratic: sorry I was all frustrated
[2012-08-10 18:47:31 -0400] erratic: I needed to go outside and have a cig and I did that also got pulled away to setup computers in the office next door
[2012-08-10 18:48:03 -0400] erratic: its just that this thing is sooo close and I want it to be perfect for what I want to use it for and its so close xD
[2012-08-10 18:53:15 -0400] hoover_damm: basically you should setup a database pristine and clean
[2012-08-10 18:53:24 -0400] hoover_damm: and start shipping chef.couch
[2012-08-10 18:53:26 -0400] hoover_damm: with your crap
[2012-08-10 18:53:42 -0400] hoover_damm: its that or you can create the database with curls and populate the data with curls
[2012-08-10 18:53:45 -0400] hoover_damm: not that fun
[2012-08-10 18:58:41 -0400] martinisoft: Is the ruby-shadow package bundled with the Chef Omnibus installation?
[2012-08-10 18:59:28 -0400] martinisoft: need it for the user account resource to set crypted passwords?
[2012-08-10 18:59:44 -0400] hoover_damm: it's not bundled with omnibus
[2012-08-10 19:01:55 -0400] martinisoft: ah, is there a way to get that gem installed within the ruby for Omnibus?
[2012-08-10 19:02:27 -0400] martinisoft: don't want all the weight of the librubyshadow package and its dependencies :)
[2012-08-10 19:05:05 -0400] erratic: hoover_damm I like your idea better
[2012-08-10 19:05:06 -0400] erratic: lol
[2012-08-10 19:13:04 -0400] martinisoft: aha, can slip it into a cookbook
[2012-08-10 19:13:14 -0400] martinisoft: with gem_package
[2012-08-10 19:31:40 -0400] jtimberman: martinisoft: we recommend chef_gem when installing gems for Chef to use.
[2012-08-10 19:32:14 -0400] jtimberman: ruby-shadow is a special case though, because it uses C extensions, so you need to have your C compiler and required libraries in place first.
[2012-08-10 19:32:24 -0400] jtimberman: (if any other libraries are required :))
[2012-08-10 19:32:44 -0400] martinisoft: ah, good to know jtimberman
[2012-08-10 19:32:55 -0400] martinisoft: so chef_gem and not gem_package then?
[2012-08-10 19:33:09 -0400] martinisoft: I'm looking around the wiki for this info right now
[2012-08-10 19:34:11 -0400] jtimberman: there's more information on the resources page under the "package" resoruce
[2012-08-10 19:35:31 -0400] martinisoft: ah cool, finding that now
[2012-08-10 19:35:35 -0400] martinisoft: thanks a bunch jtimberman :D
[2012-08-10 19:35:45 -0400] martinisoft: still figuring this stuff out
[2012-08-10 19:53:38 -0400] beandip: I want to set a node attribute base on a node attribute from a search
[2012-08-10 19:53:54 -0400] beandip: So I'm trying this:
[2012-08-10 19:56:51 -0400] beandip: somevariable = search(:node, "chef_environment:#{node.chef_environment} AND recipes:some_recipe").first
[2012-08-10 19:56:53 -0400] beandip: node.set[:someattribute] = somevariable[0][:ipaddress] if somevariable
[2012-08-10 19:57:52 -0400] beandip: but when I do this, I get TypeError: can't convert Symbol into Integer
[2012-08-10 19:58:11 -0400] beandip: anyone have any input?
[2012-08-10 20:07:27 -0400] martinisoft: beandip: what line does it point to?
[2012-08-10 20:07:33 -0400] martinisoft: or what line of code rather
[2012-08-10 20:08:15 -0400] jcran: coderanger: okiedok, that makes sense. thanks
[2012-08-10 20:13:06 -0400] martinisoft: does chef support one-off recipe runs?
[2012-08-10 20:13:18 -0400] martinisoft: as in, add a recipe to a run list then its gone once its applied
[2012-08-10 20:13:24 -0400] beandip:   it points to the second line
[2012-08-10 20:14:35 -0400] jcran: martinisoft: you could always touch a file if it's been run?
[2012-08-10 20:15:10 -0400] martinisoft: beandip: I think node.set needs a string, not a symbol
[2012-08-10 20:15:27 -0400] jcran: martinisoft: or this? http://wiki.opscode.com/pages/viewpage.action?pageId=15728818
[2012-08-10 20:15:35 -0400] jcran: first run only
[2012-08-10 20:17:19 -0400] coderanger: beware of calling node.save inside runs, if the run fails after that it can cause issues since the node data on the server reflects the partial run
[2012-08-10 20:17:34 -0400] martinisoft: beandip: so try node['someattribute'] = blah
[2012-08-10 20:17:47 -0400] martinisoft: or node.set('someattribute')
[2012-08-10 20:18:19 -0400] martinisoft: jcran: ah, looking for a command than can be run at-will
[2012-08-10 20:18:53 -0400] erikh: somevariable is not what you think it is, I don't think
[2012-08-10 20:18:59 -0400] erikh: node.set[] should work fine
[2012-08-10 20:19:04 -0400] martinisoft: what I want to do is apply security updates, but not via cron, want to maybe test updates on a system, then green light it across the nodes by setting maybe a temporary attribute for a role, which gets erased after the run
[2012-08-10 20:19:35 -0400] martinisoft: or something to that effect
[2012-08-10 20:19:47 -0400] jcran: martinisoft: i'm a total n00b, but you may want to take a look at m-collective for that
[2012-08-10 20:20:10 -0400] martinisoft: yeah thats something I was looking at for sending the same command across a cluster, right?
[2012-08-10 20:20:13 -0400] jcran: yeah
[2012-08-10 20:20:32 -0400] martinisoft: was just hoping the Chef ecosystem had a mechanism for this so its in the cookbooks and codified :)
[2012-08-10 20:20:33 -0400] jcran: but there's chef integration, so i don't see any reason you couldn't push a single recipe that way, then remove
[2012-08-10 20:20:43 -0400] erikh: maybe you could just lock it differently? e.g., by date
[2012-08-10 20:20:48 -0400] martinisoft: ah right, cool :D
[2012-08-10 20:20:54 -0400] coderanger: martinisoft: Look at the oneshot cookbook
[2012-08-10 20:20:56 -0400] erikh: node[:upgrade_date] = Date.today
[2012-08-10 20:20:58 -0400] jcran: ah interesting
[2012-08-10 20:21:09 -0400] coderanger: martinisoft: There was a patch floating around for adding temp run list overrides
[2012-08-10 20:21:13 -0400] coderanger: not sure what its status is
[2012-08-10 20:21:16 -0400] coderanger: jtimberman: ^^
[2012-08-10 20:21:21 -0400] erikh: if node[:upgrade_date] == Date.today and not_upgraded_yet
[2012-08-10 20:21:23 -0400] erikh: etc
[2012-08-10 20:21:36 -0400] martinisoft: yeah I've run across old mailing list talk about that particular feature
[2012-08-10 20:22:57 -0400] jcran: if i wanted to delete everything under foo (but leave the folder /foo itself) - would i need to re-create it after running: directory "/foo/" do action :delete recursive true end ?
[2012-08-10 20:25:56 -0400] martinisoft: beandip: btw that node.set is under the Recipes section of the wiki
[2012-08-10 20:26:53 -0400] beandip: but when I run it in shef it works fine
[2012-08-10 20:27:06 -0400] martinisoft: beandip: http://wiki.opscode.com/display/chef/Recipes <- see "Setting Node Attributes"
[2012-08-10 20:31:56 -0400] CharlieSu: What is the new way to install gems for omnibuss installs?  I want ruby-shadow support
[2012-08-10 20:32:16 -0400] erratic_: boo not enough time grr
[2012-08-10 20:34:30 -0400] martinisoft: CharlieSu: haha, think I was just asking about this earlier, think its chef_gem, but make sure gcc is there before you call that
[2012-08-10 20:34:46 -0400] CharlieSu: martinisoft: thanks!
[2012-08-10 20:35:05 -0400] martinisoft: np
[2012-08-10 20:35:19 -0400] wickett: I am trying to provision an encrypted data bag key in an automated fashion (not scp)
[2012-08-10 20:35:21 -0400] CharlieSu: martinisoft: i knew about it cause i read about it..  But i forgot where i read it..
[2012-08-10 20:35:26 -0400] wickett: anyone have any tips on that?
[2012-08-10 20:36:04 -0400] CharlieSu: wickett: can't you do it when you bootstrap your server?
[2012-08-10 20:36:27 -0400] CharlieSu: wickett:   This is in my .chef/knife.rb       encrypted_data_bag_secret '/Users/csullivan/.chef/encrypted_data_bag_secret'
[2012-08-10 20:36:41 -0400] wickett: CharlieSu: that is what I would like to do
[2012-08-10 20:36:48 -0400] wickett: I added that already
[2012-08-10 20:37:09 -0400] wickett: does the knife ec2 command use that?
[2012-08-10 20:37:13 -0400] CharlieSu: wickett: what version of chef are you using?  Did you look at the bootstrap emplate?
[2012-08-10 20:37:16 -0400] CharlieSu: template *
[2012-08-10 20:37:30 -0400] CharlieSu: wickett: yes.. if the template has it included
[2012-08-10 20:37:54 -0400] wickett: CharlieSu: no I didnt look at the template
[2012-08-10 20:38:08 -0400] CharlieSu: wickett: https://gist.github.com/ea35b47e13a601e14c62
[2012-08-10 20:38:45 -0400] wickett: CharlieSu: cool
[2012-08-10 20:38:53 -0400] wickett: where do put that?
[2012-08-10 20:39:00 -0400] wickett: just a couple weeks into chef here
[2012-08-10 20:39:07 -0400] CharlieSu: wickett: what install method are you using?  Omnibus?  What version of Chef?
[2012-08-10 20:39:27 -0400] wickett: Omnibus
[2012-08-10 20:39:37 -0400] CharlieSu: wickett: what version of Chef?
[2012-08-10 20:40:05 -0400] wickett: 10.12.0
[2012-08-10 20:40:45 -0400] CharlieSu: wickett: should be working then...  send me the output of the first few hundred lines of a bootstrapping box..
[2012-08-10 20:41:32 -0400] wickett: CharlieSu: ok, one sec
[2012-08-10 20:42:35 -0400] CharlieSu: martinisoft: worked wonderfully.. thanks again
[2012-08-10 20:43:14 -0400] caspyin: Is it recommended to use a cookbook for ruby-shadow or to get it installed some other way (bootstrap?)
[2012-08-10 20:47:39 -0400] martinisoft: CharlieSu: cool :D
[2012-08-10 20:50:27 -0400] martinisoft: caspyin: I'm going to add it to a small cookbook
[2012-08-10 20:51:07 -0400] martinisoft: making my own sysem_essentials cookbook which does stuff like that, though I'd love for Chef to have an option for it even though it requires C libs
[2012-08-10 20:54:39 -0400] caspyin: martinisoft: Why do you prefer that over making them all cookbooks? overhead?
[2012-08-10 20:58:37 -0400] martinisoft: Since its a requirement of the user resource provided by Chef, feels like something is missing then when I have to go a bit out of my way to provide for it
[2012-08-10 20:59:00 -0400] caspyin: makes sense
[2012-08-10 20:59:11 -0400] caspyin: will you be making that public?
[2012-08-10 20:59:18 -0400] martinisoft: yeah
[2012-08-10 20:59:42 -0400] martinisoft: also, feels silly to roll a new cookbook for one tiny change like that :)
[2012-08-10 21:00:39 -0400] martinisoft: right now I'm separating two cookbook contributions into a patch for apt and ubuntu cookbooks
[2012-08-10 21:00:48 -0400] martinisoft: to enable autoclean/autoremove for package cleanup
[2012-08-10 21:19:40 -0400] martinisoft: I have a cookbook contribution question, do I open a pull request on github or just open a ticket?
[2012-08-10 21:42:12 -0400] martinisoft: There we go: http://tickets.opscode.com/browse/COOK-1548
[2012-08-10 21:51:38 -0400] erratic_: chicken scratch
[2012-08-10 21:52:31 -0400] hoover_damm: martinisoft, you trust autoremove?
[2012-08-10 21:52:34 -0400] hoover_damm: always makes me nervous
[2012-08-10 21:52:53 -0400] hoover_damm: and i've had it remove the wrong package a few times a few years ago... doubt it still does it
[2012-08-10 21:54:11 -0400] martinisoft: just providing the option :)
[2012-08-10 21:54:25 -0400] martinisoft: usually it works for me
[2012-08-10 21:55:06 -0400] martinisoft: I have a separate commit going to the ubuntu cookbook to run an auto clean/remove after the recipe runs
[2012-08-10 21:55:15 -0400] martinisoft: if you set an attribute though
[2012-08-10 21:56:22 -0400] erratic_: i feel like im going crazy
[2012-08-10 21:56:53 -0400] erratic_: at an appt now
[2012-08-10 21:57:09 -0400] hoover_damm: martinisoft, nice.  How often will this be useful do you think? or just a cherry on top?
[2012-08-10 21:57:15 -0400] erratic_: screw depression i dont have time to be depressed ever
[2012-08-10 21:57:48 -0400] martinisoft: hoover_damm: I'm a little OCD on my systems sometimes, just feel removing excess stuff from a system to keep it tidy and fast is a good thing
[2012-08-10 21:58:13 -0400] erratic_: martinsoft i feel ya
[2012-08-10 21:58:45 -0400] martinisoft: which is also why I made the comment earlier about the ruby-shadow gem install, I don't want to add that package because it'll explode with dependencies
[2012-08-10 21:58:50 -0400] hoover_damm: martinisoft, heh sometimes i wonder if you have worked with me
[2012-08-10 21:58:50 -0400] erratic_: im obsessed with making this as clear of a path as possible for someone else to deal with when im gone
[2012-08-10 21:58:52 -0400] martinisoft: and at the system-level, not chef
[2012-08-10 21:58:56 -0400] hoover_damm: martinisoft, because your OCD matches mine pretty well
[2012-08-10 21:59:02 -0400] erratic_: if im gone and when the time comes to use it
[2012-08-10 21:59:20 -0400] hoover_damm: martinisoft, long term evolution of systems absolutely
[2012-08-10 21:59:37 -0400] hoover_damm: martinisoft, short-term systems autoremove isn't neccesary because you'd reimage/terminate/delete it before hand
[2012-08-10 22:00:36 -0400] erratic_: ugh i really dont want to sit at home this evening ..
[2012-08-10 22:00:52 -0400] spokrandt: I have a databag that has a array of node names.  from in a recipe I would like to create an array of ec2 private network addresses to supply to a template.   is this possible and is there a current recipe that does this i can learn from?
[2012-08-10 22:00:53 -0400] martinisoft: yeah, I know the Travis-CI folks employ it to keep their VMs as lean as possible
[2012-08-10 22:01:09 -0400] hoover_damm: really autoremove is a nice :)
[2012-08-10 22:01:22 -0400] hoover_damm: but I admit I'm also leaning towards the point of just writing my own distro again
[2012-08-10 22:01:43 -0400] erratic_: lfs is cool
[2012-08-10 22:02:10 -0400] hoover_damm: I'd use Exherbo if I wanted to build the tools to automate the packages
[2012-08-10 22:02:12 -0400] hoover_damm: and system
[2012-08-10 22:02:21 -0400] hoover_damm: but I really don't, it'd be easier to automate Gentoo
[2012-08-10 22:02:27 -0400] hoover_damm: and just shovel it along
[2012-08-10 22:02:37 -0400] erratic_: mmmmm
[2012-08-10 22:04:55 -0400] erratic_: hoover_damm i wanted to see the other day what would happen if i did git init from / and commit then emerge -e world then reset
[2012-08-10 22:05:07 -0400] erratic_: i never finished it though
[2012-08-10 22:05:38 -0400] erratic_: i did some but never finished the emerge -e world
[2012-08-10 22:05:56 -0400] erratic_: figures it was too stupid and i had better things to do
[2012-08-10 22:06:31 -0400] erratic_: cool though i like how easy it is to make and destroy vms with vagrant
[2012-08-10 22:06:59 -0400] martinisoft: I <3 Vagrant
[2012-08-10 22:07:23 -0400] erratic_: me three
[2012-08-10 22:08:06 -0400] martinisoft: question. for hostnames and such, is the hostname cookbook up on the community site a good choice?
[2012-08-10 22:08:30 -0400] erratic_: im just sitting here at the drs office thinking about how cool this is turning out to be
[2012-08-10 22:08:55 -0400] erratic_: and trying to think of things i need to do before we do our next release
[2012-08-10 22:09:09 -0400] erratic_: pretty obsessed
[2012-08-10 22:09:19 -0400] martinisoft: I'm hanging out at TrunkClub drinking beers with the engineering team :D
[2012-08-10 22:09:35 -0400] erratic_: i quit drinkin
[2012-08-10 22:09:40 -0400] erratic_: just because....
[2012-08-10 22:09:54 -0400] martinisoft: so that cookbook was a 1-beer cookbook :D
[2012-08-10 22:10:21 -0400] erratic_: nice ive worked on chef stuff while drinkin beers before
[2012-08-10 22:10:34 -0400] erratic_: i just cant anymore though
[2012-08-10 22:10:48 -0400] erratic_: unless im at home or somewhere with people i trust
[2012-08-10 22:11:26 -0400] erratic_: kinda came to the conclusion to do otherwise is a bad idea for me
[2012-08-10 22:12:40 -0400] erratic_: theres something i found yest .. 1 sec
[2012-08-10 22:13:27 -0400] erratic_: nevermind no browser on this phone but i was looking forbohai plugins and found a page of "plugins found in the wild" its an opscode page
[2012-08-10 22:13:41 -0400] erratic_: theres a huge list of stuff for chef knife and ohai
[2012-08-10 22:13:48 -0400] martinisoft: wow cool :D
[2012-08-10 22:13:54 -0400] erratic_: and i started reading about some of it
[2012-08-10 22:14:02 -0400] martinisoft: right now I'm just learning Chef to control my Linodes
[2012-08-10 22:14:07 -0400] erratic_: some of its pretty bad ass
[2012-08-10 22:14:10 -0400] martinisoft: and figure out how it all works
[2012-08-10 22:14:35 -0400] erratic_: knife linode?
[2012-08-10 22:14:47 -0400] martinisoft: so far most of it is clicking, finally made my first data bag this week
[2012-08-10 22:14:50 -0400] martinisoft: yeah I have that plugin
[2012-08-10 22:14:53 -0400] martinisoft: its pretty sweet
[2012-08-10 22:15:10 -0400] martinisoft: OHAI doesn't see my linode as a linode instance, identifies it as rackspace
[2012-08-10 22:15:33 -0400] martinisoft: which is funny because the kernel name has linode right in it
[2012-08-10 22:15:45 -0400] erratic_: knife rackspace here
[2012-08-10 22:15:58 -0400] erratic_: theres a knife vagrant but i havent tried it yet
[2012-08-10 22:16:17 -0400] erratic_: actually dont want to use knife vagrant
[2012-08-10 22:16:23 -0400] hoover_damm: anyone got a good lvm cookbook?
[2012-08-10 22:16:27 -0400] hoover_damm: no don't suggest the opscode one
[2012-08-10 22:16:33 -0400] erratic_: check that plugin page
[2012-08-10 22:16:58 -0400] erratic_: like google plugins found iin the wild and maybe throw in opscode
[2012-08-10 22:17:22 -0400] erratic_: ohai plugins arent too bad
[2012-08-10 22:18:39 -0400] erratic_: "ohai2u" lol
[2012-08-10 22:24:23 -0400] erratic_: martinsoft tonight im gonna see if i can do knife rackspace with a custom bootstrap template
[2012-08-10 22:24:38 -0400] erratic_: i wanted to yest but i had a bunch of other stuff to do
[2012-08-10 22:24:51 -0400] erratic_: i think itll work but im not sure
[2012-08-10 22:25:05 -0400] erratic_: nobody else seems to know
[2012-08-10 22:25:12 -0400] JasonBox: hrm, I am using chef/mixin/deep_merge in a project and rubygems freaks out because I have json > 1.6.1 on my system
[2012-08-10 22:25:17 -0400] erratic_: so ill just have to try it and see if it does
[2012-08-10 22:25:23 -0400] JasonBox: Is there some sane mechanism for me to deal with this?
[2012-08-10 22:26:08 -0400] jordane: erratic_: I use knife rackspace with a custom bootstrap template quite regularly. Did you have a question about it?
[2012-08-10 22:28:30 -0400] martinisoft: so for setting the hostname, should I control this at the cookbook level?
[2012-08-10 22:29:19 -0400] martinisoft: or is this handled at the bootstrap level
[2012-08-10 23:11:24 -0400] hoover_damm: that's at the node level
[2012-08-10 23:11:26 -0400] hoover_damm: knife -N
[2012-08-10 23:14:12 -0400] erratic_: i lied im having a beer
[2012-08-10 23:14:41 -0400] hoover_damm: does alchol help you code?
[2012-08-10 23:15:56 -0400] erratic_: no
[2012-08-10 23:16:09 -0400] erratic_: it does help me decide what i want to eat though
[2012-08-10 23:17:55 -0400] erratic_: and it does give me a chance to stop and brush my teeth in the bathroom
[2012-08-10 23:19:04 -0400] erratic_: the boringness and lack of anything to do or anybody to hang out with this weekend will help me code
[2012-08-10 23:19:37 -0400] erratic_: and since i found beer authority in lake city i havent needed to go far for a good microbrew
[2012-08-10 23:19:45 -0400] erratic_: but i like taphouse
[2012-08-10 23:19:56 -0400] erratic_: its nice being underground
[2012-08-10 23:20:30 -0400] erratic_: hoover_damm i just had my face zapped a bunch of times with a laser lol
[2012-08-10 23:21:16 -0400] erratic_: kinda hurts even with an aneth..anestet ... that thing
[2012-08-10 23:21:47 -0400] erratic_: screw apelling checking and auto correction it never works when i need it
[2012-08-10 23:22:11 -0400] erratic_: only when im trying to type words i intentionally make up
[2012-08-10 23:22:19 -0400] erratic_: lol
[2012-08-10 23:22:31 -0400] erratic_: i hate this damn phone
[2012-08-10 23:22:59 -0400] martinisoft: hoover_damm: knife -N doesn't work :(
[2012-08-10 23:23:01 -0400] erratic_: cant wait to get my s3 replaced
[2012-08-10 23:23:06 -0400] hoover_damm: martinisoft, knife bootstrap --node-name
[2012-08-10 23:23:13 -0400] hoover_damm: martinisoft, if you use rackspace there's both node name and server name
[2012-08-10 23:23:21 -0400] hoover_damm: or -N
[2012-08-10 23:23:22 -0400] martinisoft: ah nice
[2012-08-10 23:23:44 -0400] hoover_damm: knife -N wont bot knife bootstrap -N would... or knife rackspace server create -N
[2012-08-10 23:23:48 -0400] hoover_damm: s/bot/but
[2012-08-10 23:23:58 -0400] martinisoft: also, does bootstrap do omnibus by default now??
[2012-08-10 23:27:21 -0400] erratic_: i love the image on the bootstrap opscode page of those ugly looking boots
[2012-08-10 23:28:16 -0400] martinisoft: heading back home, ill be back on later this evening
[2012-08-10 23:28:22 -0400] erratic_: thats the first thing that comes to mind when i hear knife bootstrap
[2012-08-10 23:30:08 -0400] erratic_: dang
[2012-08-10 23:30:24 -0400] erratic_: people trying to sell me beer ive only had a sip off the first one ....
[2012-08-10 23:45:20 -0400] erratic_: damn i donno if i can finish this one beer i ordered...
[2012-08-10 23:45:28 -0400] erratic_: kinda making my stomach turn
[2012-08-10 23:45:34 -0400] erratic_: i ate
[2012-08-10 23:45:38 -0400] erratic_: i kinda wanna get out of here and go home
[2012-08-10 23:48:57 -0400] erratic_: to be perfectly honest.... the microbrew really is better quality than anything ive had here at taphouse...
[2012-08-10 23:49:26 -0400] erratic_: they have ao much here though but i hear it all goes stale before they can sell it
[2012-08-10 23:49:56 -0400] erratic_: maybe thats the diff
[2012-08-10 23:50:53 -0400] erratic_: never had beer at my fav spot that i didnt like though
