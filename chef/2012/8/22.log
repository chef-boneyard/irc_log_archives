[2012-08-22 00:00:02 -0400] bluepojo: thedeeno: ^^
[2012-08-22 00:00:23 -0400] jtimberman: bluepojo: you mean on the community site, the namespacing?
[2012-08-22 00:02:43 -0400] bluepojo: jtimberman: I mean in general
[2012-08-22 00:02:47 -0400] bluepojo: specifically in the chef server
[2012-08-22 00:02:49 -0400] bluepojo: for instance
[2012-08-22 00:03:00 -0400] bluepojo: lets say I have 2 different groups working on separate projects that share a chef server
[2012-08-22 00:03:09 -0400] bluepojo: if one group needs a modified apache cookbook
[2012-08-22 00:03:15 -0400] bluepojo: they'll clobber the other group's cookbook
[2012-08-22 00:03:22 -0400] bluepojo: unless they ghetto namespace with a rename
[2012-08-22 00:04:33 -0400] bluepojo: calling it group2_apache or something
[2012-08-22 00:05:02 -0400] bluepojo: the community site could also support it, but that's not the most important piece of the feature
[2012-08-22 00:18:31 -0400] jkyle: having a bit of trouble finding the chef API docs, like if I wanted to interact with chef programmatically. Anyone got a link?
[2012-08-22 00:24:09 -0400] thedeeno: bluepojo: I'm totally on board with the fully qualified naming of repos. How does chef deal with resource's with the same name in 2 cookbooks?
[2012-08-22 00:25:24 -0400] thedeeno: cause it looks like i'm having a collision - even though the python cookbooks have different names and the depends line's are pointing to the correct names in the cookbooks that depend on them.
[2012-08-22 00:25:56 -0400] bluepojo: depends should load up the right cookbook
[2012-08-22 00:26:07 -0400] bluepojo: do you possibly have a dependency of a dependency that also loads the other cookbook?
[2012-08-22 00:30:15 -0400] thedeeno: hmm, let me check
[2012-08-22 00:32:23 -0400] jkyle: well, found a python client api doc >.<
[2012-08-22 00:42:34 -0400] thedeeno: jkyle: what language? don't want to shell out to knife?
[2012-08-22 01:01:33 -0400] thedeeno: bluepojo: gah, it's a nightmare forking the cookbook like this. Not only do I need to change all the relevant depends, but I also have to change the include_recipe lines and any templates that have a cookbook specified, etc
[2012-08-22 01:01:35 -0400] thedeeno: very messy
[2012-08-22 01:02:13 -0400] thedeeno: has there been any talk on making depends more robust, perhaps pointing it to a git repo (like librarian chef) and having the chef server deal with this?
[2012-08-22 01:04:50 -0400] bluepojo: yeah, it's not straight forward and no, I don't believe there's a better way to do it.
[2012-08-22 02:05:23 -0400] dyer: Hey guys, is anyone at opscode looking at their proxy (  https://www.opscode.com/chef/download?v=0.10.8&p=el&pv=5&m=x86_64 ) Its been down for hours now
[2012-08-22 02:05:46 -0400] hoover_damm: dyer, doesn't that link to S3?
[2012-08-22 02:06:00 -0400] hoover_damm: dyer, you should be able to open a support ticket (although i'm sure someone from opscode will respond)
[2012-08-22 02:06:14 -0400] hoover_damm: likely would be the best plan of action
[2012-08-22 02:08:05 -0400] dyer: http://tickets.opscode.com/browse/CHEF-3378
[2012-08-22 02:41:53 -0400] hoover_damm: dyer, fwiw i didn't know they kept 0.10.8 around
[2012-08-22 02:42:04 -0400] hoover_damm: I use our own omnibus packages to :) keep that
[2012-08-22 02:42:12 -0400] hoover_damm: dyer, you should really just build your own packages and host them on s3
[2012-08-22 02:42:20 -0400] hoover_damm: dyer, then you don't have to worry about someone else
[2012-08-22 03:12:36 -0400] zts: jkyle: http://wiki.opscode.com/display/chef/Server+API
[2012-08-22 03:35:27 -0400] miah: hi
[2012-08-22 03:59:14 -0400] ssd7_: Ohai Chefs
[2012-08-22 06:31:08 -0400] BryanWB_: ohai chefs!
[2012-08-22 06:36:44 -0400] dvolker: hi u!
[2012-08-22 08:54:38 -0400] anentropic: anyone here have any clue what might typically cause
[2012-08-22 08:54:40 -0400] anentropic: FATAL: NotImplementedError: super from singleton method that is defined to multiple classes is not supported; this will be fixed in 1.9.3 or later
[2012-08-22 08:54:41 -0400] anentropic: ?
[2012-08-22 08:55:49 -0400] anentropic: must be my code that's causing it but the stacktrace doesn't mention any of my code
[2012-08-22 08:55:50 -0400] anentropic: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/resource.rb:548:in `initialize'
[2012-08-22 08:55:51 -0400] anentropic: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/resource.rb:590:in `call'
[2012-08-22 08:55:51 -0400] anentropic: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/resource.rb:590:in `block (2 levels) in build_from_file'
[2012-08-22 08:55:51 -0400] anentropic: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/mixin/recipe_definition_dsl_core.rb:65:in `new'
[2012-08-22 08:55:52 -0400] anentropic: /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/mixin/recipe_definition_dsl_core.rb:65:in `method_missing'
[2012-08-22 08:55:55 -0400] anentropic: /tmp/vagrant-chef-1/chef-solo-1/cookbooks/python/recipes/virtualenv.rb:23:in `from_file'
[2012-08-22 08:56:13 -0400] anentropic: (top 6 lines)
[2012-08-22 09:10:10 -0400] drrk: can anyone confirm or deny for me, that the only access requirement for chef-client to chef-server is TCP Port 4040?
[2012-08-22 09:10:27 -0400] drrk: or port 4000 even
[2012-08-22 09:11:44 -0400] adz: looks that way, I haven't set any other ingress rules for AWS
[2012-08-22 09:12:02 -0400] drrk: thanks
[2012-08-22 09:41:36 -0400] cnf: hmm, this cookbook uses node['domain'] and node['public_domain'], but they don't exist for my node
[2012-08-22 09:41:45 -0400] cnf: and i can't figure out were they come from ^^;
[2012-08-22 09:44:47 -0400] adz: I think 'domain' is an ohai automatic attribute
[2012-08-22 10:05:07 -0400] anentropic: so, I have a minimal test case, I create a file site-cookbooks/myapps/resources/myapp.rb
[2012-08-22 10:05:19 -0400] anentropic: and inside that file I have a single line of code
[2012-08-22 10:05:20 -0400] anentropic: include Chef::Resource::ApplicationBase
[2012-08-22 10:05:32 -0400] anentropic: boom:  FATAL: NotImplementedError: super from singleton method that is defined to multiple classes is not supported; this will be fixed in 1.9.3 or later
[2012-08-22 10:06:02 -0400] anentropic: I am baffled as this seems to be how LWRP from opscode-cookbooks are defined?
[2012-08-22 10:06:58 -0400] anentropic: removing the include stifles the error but instead I get NameError: No resource found for myapp
[2012-08-22 10:07:36 -0400] anentropic: ruby --version
[2012-08-22 10:07:37 -0400] anentropic: ruby 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]
[2012-08-22 10:08:11 -0400] cnf: adz: i think it is, indeed
[2012-08-22 10:52:05 -0400] anentropic: yfeldblum: is it possible my problem from about 20 lines up is related to http://tickets.opscode.com/browse/CHEF-3376 ?
[2012-08-22 11:17:04 -0400] aspiers: hmm, chef's Mash does not fully implement merge! - it ignores any duplicate-handling block passed in
[2012-08-22 11:41:11 -0400] MuraliK: Hi All, new to chef installation and usage. Running into a problem, chef server gets crashed on CentOS 6.3 after I try running chef-client. The error I see when I run Chef Client is "FATAL: EOFError: end of file reached"
[2012-08-22 11:41:25 -0400] MuraliK: Help is much appreciated
[2012-08-22 11:47:23 -0400] MuraliK: anyone here ...
[2012-08-22 11:47:56 -0400] MuraliK: I am just confused, anybody out there in this channel
[2012-08-22 11:51:14 -0400] matschaffer: MuraliK: probably still early for most of the channel
[2012-08-22 11:51:33 -0400] matschaffer: it'd help to see more of the chef-client command and output
[2012-08-22 11:52:07 -0400] MuraliK: Sure, I got it. Thanks <matschaffer>. Will wait couple of hours before I ask this question
[2012-08-22 11:52:11 -0400] MuraliK: thanks bunch
[2012-08-22 11:52:36 -0400] matschaffer: MuraliK: opscode hq is seattle I think, so still not quite 5am there ;)
[2012-08-22 11:52:49 -0400] MuraliK: ;)
[2012-08-22 11:59:59 -0400] jannel: I have a new node that shows up in the "knide node list"-listing, but doesn't show up in any search results
[2012-08-22 12:00:05 -0400] jannel: any idea what could be wrong?
[2012-08-22 12:04:26 -0400] geekbri: what search query are you using?
[2012-08-22 12:05:13 -0400] jannel: for example knife search node "role:webapp" where the node has the role webapp
[2012-08-22 12:05:40 -0400] jannel: seems like this problem: http://wiki.opscode.com/display/chef/Search#Search-Updatesnotpropagatingtosearchresults
[2012-08-22 12:05:48 -0400] jannel: but how do I add more chef-expanders?
[2012-08-22 12:22:29 -0400] geekbri: jannel: I would look in /etc/sv/ and examine the chef-solr-indexer entry
[2012-08-22 12:38:37 -0400] masterkorp: Can i set a staging role to not have a spefic recipe that is on the production role
[2012-08-22 12:38:48 -0400] masterkorp: because i dont want heritage
[2012-08-22 12:42:09 -0400] BryanWB_: anybody know a good cookbook to use as an example for managing a sinatra app?
[2012-08-22 12:42:27 -0400] BryanWB_: i m working on one for https://github.com/obfuscurity/descartes
[2012-08-22 12:47:04 -0400] BryanWB_: or even a ruby app that uses bundler
[2012-08-22 12:48:11 -0400] geekbri: you should have named it oldblueeyes ;)
[2012-08-22 12:48:43 -0400] BryanWB_: lol ;)
[2012-08-22 12:48:53 -0400] geekbri: should have / should whatever!
[2012-08-22 12:49:02 -0400] geekbri: and I don't know of one!
[2012-08-22 12:49:17 -0400] geekbri: However I haven't looked for one in over a year so i'm not a good barometer for that.
[2012-08-22 12:49:39 -0400] BryanWB_: nathenharvey: can u point me to one?
[2012-08-22 12:54:16 -0400] MuraliK: Hi All, new to chef installation and usage. Running into a problem, chef server gets crashed on CentOS 6.3 after I try running chef-client. The error I see when I run Chef Client is "FATAL: EOFError: end of file reached". help appreciated
[2012-08-22 12:55:31 -0400] nathenharvey: @BryanWB_ I don't have a great cookbook for managing a sinatra app, no.  maybe just using the deploy resource?
[2012-08-22 13:01:20 -0400] BryanWB_: nathenharvey: ok, i look at deploy rersource, i have never used that
[2012-08-22 13:01:46 -0400] behemphi: @MuraliK can you create a pastebin of the contents of /var/chef/cache/chef-stacktrace.out
[2012-08-22 13:02:14 -0400] behemphi: (there should be something telling you the file was written near the bottom of the output)
[2012-08-22 13:04:31 -0400] behemphi: MasterKop, this might be dirty, but I do something like that with lines in my recipe that say:
[2012-08-22 13:04:41 -0400] behemphi: if node.role == "staging"
[2012-08-22 13:04:51 -0400] behemphi: include_recipe "dev_support"
[2012-08-22 13:04:52 -0400] behemphi: end
[2012-08-22 13:05:18 -0400] behemphi: I do that in the default recipe of the cookbook
[2012-08-22 13:05:55 -0400] jannel: geekbri: I do not have such directory :)
[2012-08-22 13:06:58 -0400] geekbri: jannel: do you maybe have no chef expanders running :)
[2012-08-22 13:10:05 -0400] jannel: geekbri: yes I do, there is one instance running
[2012-08-22 13:11:16 -0400] jannel: /usr/bin/ruby /usr/bin/chef-expander -d -c /etc/chef/server.rb -L /var/log/chef/expander.log -P /var/run/chef/expander.pid -n 1 -i 1
[2012-08-22 13:11:58 -0400] MuraliK: @behemphi - will copy and paste here
[2012-08-22 13:12:19 -0400] behemphi: MuraliK, that is "bad form" I think it is called "flooding"
[2012-08-22 13:12:46 -0400] behemphi: please use pastebin or gist or hastebin or some other similar service
[2012-08-22 13:12:46 -0400] BryanWB_: behemphi: 'sup homez!
[2012-08-22 13:12:53 -0400] behemphi: Hey WB
[2012-08-22 13:13:04 -0400] behemphi: How are ya
[2012-08-22 13:13:29 -0400] BryanWB_: behemphi: fine, trying to get a graphite dashboard up
[2012-08-22 13:13:58 -0400] MuraliK: okay -
[2012-08-22 13:14:16 -0400] behemphi: That was a very cool talk, but I am too lazy for that, CopperEgg was too cheap/easy for me to pass on for DIY
[2012-08-22 13:14:28 -0400] DrDave: Hi - noob - having problems with java-web-stack example deploying to EC2 re availability zone - tried rackspace got DNS errors - found issues raised but wondered what status currently is as far as I can see the samples are broken? If there is a quick fix - would love to know - thanks
[2012-08-22 13:17:20 -0400] BryanWB_: i got no budget, so graphite it is
[2012-08-22 13:17:35 -0400] behemphi: Looks alot better with no budget for sure!
[2012-08-22 13:18:21 -0400] thedeeno: The application cookbook doesn't need to depend on any of these right? runit unicorn apache2 passenger_apache2 tomcat python gunicorn php
[2012-08-22 13:20:56 -0400] geekbri: You use an underscore to reference nested hashes with knife node show NODE_NAME -a firstlevel_secondlevel right?
[2012-08-22 13:21:14 -0400] BryanWB_: behemphi: the real value in either system, and most time-consuming part, is learning how to interpret the data
[2012-08-22 13:21:17 -0400] cwj: thedeeno: not sure, i think most of those dependencies have been moved out into the application_foo cookbooks
[2012-08-22 13:21:28 -0400] cwj: thedeeno: so maybe application itself does not need to
[2012-08-22 13:21:56 -0400] cwj: but it should probably 'recommend' application_ruby, application_python, etc
[2012-08-22 13:23:25 -0400] thedeeno: agreed. The version constrained python dependency is causing me problems, i'll remove them in my fork
[2012-08-22 13:23:54 -0400] behemphi: Absolutely @BryanWB_, indeed, I sit with the alerts up and watch them roll by.  Over several hours, days, I can see a trend and take action.
[2012-08-22 13:23:56 -0400] _JamieD_: Hi, I'm just getting into chef and looking to install ruby 1.9.3 using a recipe but I'm not sure if the ruby recipe on the opscode site supports 1.9.3. what would be the best way install 1.9.3 using chef?
[2012-08-22 13:24:21 -0400] cwj: geekbri: in my experience knife allows the use of firstlevel.secondlevel outside of your search query
[2012-08-22 13:24:24 -0400] behemphi: We have tuned the heck out of our app b/c of just that effort in understanding the data
[2012-08-22 13:24:30 -0400] cwj: its just in the query you need to use _ instead of .
[2012-08-22 13:24:43 -0400] geekbri: cwj: looks like . worked for me but _ doesnt.
[2012-08-22 13:24:45 -0400] behemphi: Foo Foo coffee time.
[2012-08-22 13:24:46 -0400] BryanWB_: _JamieD_ i just did that 10 mins ago
[2012-08-22 13:25:03 -0400] geekbri: cwj: which makes sense.  knife show is probably getting the node object itself then just calling the method on it
[2012-08-22 13:25:13 -0400] cwj: yeah i think so
[2012-08-22 13:25:15 -0400] geekbri: cwj: where as the search queries are searchign through solr.  I should have thought about that more.
[2012-08-22 13:25:27 -0400] _JamieD_: BryanWB_: nice, did you use a public recipe or make your own?
[2012-08-22 13:25:35 -0400] gyre007: how can I register a node automatically to a particular environment on the chef server ?
[2012-08-22 13:26:24 -0400] cwj: gyre007: you can set it when you use knife to provision/bootstrap the node with -E flag, or you can try the set environment plugin someone wrote
[2012-08-22 13:26:37 -0400] BryanWB_: _JamieD_: public see from line 17 https://github.com/bryanwb/chef-descartes/blob/master/Vagrantfile#L17
[2012-08-22 13:27:00 -0400] cwj: https://gist.github.com/961827
[2012-08-22 13:28:21 -0400] BryanWB_: the key are the rbenv  and ruby_build cookbooks, json attributes under "rbenv"  and the one line in my descartes::rbenv recipe
[2012-08-22 13:28:35 -0400] BryanWB_: _JamieD_: the cookbooks I use are in my Berksfile for that project
[2012-08-22 13:28:59 -0400] _JamieD_: BryanWB_: ah, you're using rbenv, I was wondering if I should use it or not. I'm not using vagrant, is the chef.json object what would normally go in the node file?
[2012-08-22 13:29:25 -0400] BryanWB_: those attrs could go in a role or another cookbook
[2012-08-22 13:30:10 -0400] gyre007: cwj, mm interesting...i was more interested how to set it up during server provisioning ....where does chef-client keep its configuration ie to which chef server it should be connecting to ??
[2012-08-22 13:30:24 -0400] _JamieD_: BryanWB_: thanks, I'll have a play around with those recipes
[2012-08-22 13:31:40 -0400] gyre007: what IM after is to create a VM on KVM which will set up chef stuff on the first boot...im using omnibusinstall..what im trying to figure out is the chef-client config now...i've copied validation key so that bit is ok
[2012-08-22 13:31:51 -0400] gyre007: im trying to follow this: http://www.cryptocracy.com/blog/2012/05/12/bootstrapping-chef/
[2012-08-22 13:33:04 -0400] cwj: gyre007: /etc/chef/client.rb is the default config file path for chef-client
[2012-08-22 13:34:27 -0400] cwj: looks like that guide is relying on chef from packages, which i am very familiar with these days. i tend to use chef bootstrap scripts to install my desired version of ruby and install/configure chef
[2012-08-22 13:34:59 -0400] cwj: s/very familiar/not very familiar/
[2012-08-22 13:35:05 -0400] cwj: derp
[2012-08-22 13:53:16 -0400] gyre007: cwj, I figured it out...
[2012-08-22 13:54:21 -0400] gyre007: one last thing...can I specify environment in client.rb so that when it registers it is added to correct Environment ?? by default it's added to _default
[2012-08-22 13:54:26 -0400] gyre007: or how do I go about that ?
[2012-08-22 13:54:56 -0400] _JamieD_: BryanWB_: that worked apart from setting the global ruby version. I had to add a global config option to your code, not sure if you wanted that i yours or not?
[2012-08-22 13:55:40 -0400] BryanWB_: _JamieD_: pls show me
[2012-08-22 13:55:54 -0400] BryanWB_: i m not an rbenv expert
[2012-08-22 13:56:36 -0400] gyre007: I see...there is an environment config option
[2012-08-22 13:56:52 -0400] _JamieD_: BryanWB_: if you add 'global'  => '1.9.3-p0' to your rbenv config it will make the system wide ruby version 1.9.3
[2012-08-22 13:57:19 -0400] _JamieD_: BryanWB_: that should be 1.9.3-p194
[2012-08-22 13:57:36 -0400] BryanWB_: under node['rbenv]['global'] = '1.9.3-p194'  ?
[2012-08-22 13:57:51 -0400] BryanWB_: _JamieD_: ^^
[2012-08-22 13:58:12 -0400] _JamieD_: BryanWB_: I'd stick it after line 19 here https://github.com/bryanwb/chef-descartes/blob/master/Vagrantfile#L17
[2012-08-22 13:58:27 -0400] BryanWB_: _JamieD_: nice, tks, will try that
[2012-08-22 13:58:51 -0400] matschaffer: anyone working on test-kitchen here? I can't seem to get it to just run ubuntu 12 even if I put `supports 'ubuntu', '>= 12'` in my metadata.rb
[2012-08-22 13:59:14 -0400] matschaffer: maybe I need to put platforms in my Kitchen file to lock it down?
[2012-08-22 13:59:41 -0400] _JamieD_: BryanWB_: if you don't have that set and the VM has no ruby version installed it acts rather odd, "ruby -v" runs but does nothing as rbenv creates a shim that doesn't point to a version of ruby
[2012-08-22 14:01:39 -0400] BryanWB_: my descartes::rbenv  recipe sets the global ruby using an lwrp
[2012-08-22 14:01:51 -0400] BryanWB_: but i prefer to put it an attribute
[2012-08-22 14:02:58 -0400] _JamieD_: I just span up a vm with 30gb memory so I can test out the chef scrips faster, it's taking too long to build on a 1gb instance :)
[2012-08-22 14:03:46 -0400] _JamieD_: just have to remember to shut it down after I'm done
[2012-08-22 14:09:21 -0400] _JamieD_: BryanWB_: do you have a  web server on your setup? I can't see one in your files
[2012-08-22 14:10:10 -0400] BryanWB_: haven't put one in that cookbook yet
[2012-08-22 14:10:56 -0400] BryanWB_: i may be tempted to drop in haproxy cuz its the lightest thing on this planet
[2012-08-22 14:11:19 -0400] BryanWB_: but may not put one at all
[2012-08-22 14:25:18 -0400] UukGoblin: q1: can a chef recipe create some "default" files first, but then not care if someone removes them? I.e. I'd like a recipe that adds a default ~/.bashrc for a user initially when the user is created, but if that users modifies or removes the file, then I'd like chef not to re-create it
[2012-08-22 14:26:15 -0400] UukGoblin: q2: can chef automatically remove packages that were installed by noob sysadmins? I.e. if I type apt-get install foobar, can I get chef-client to run apt-get remove foobar afterwards?
[2012-08-22 14:26:41 -0400] railsraider: hi, I wanna use capistrano for all my chef needs,  like cap app_server:create etc anyone done it or have a resource to share?
[2012-08-22 14:28:21 -0400] railsraider: is chef-capistrano good enough?
[2012-08-22 14:31:23 -0400] fish_: re
[2012-08-22 14:31:27 -0400] paulmooring: UukGoblin: You can use notifies to create the file when the user is created
[2012-08-22 14:31:42 -0400] paulmooring: then put action :nothing in the bashrc file resource
[2012-08-22 14:32:15 -0400] paulmooring: the downside being if the user is modified/re-created by Chef later the file will be over-written
[2012-08-22 14:32:51 -0400] paulmooring: alternatively you could use only_if ::File.exists?(bashrc_file_path) in the bashrc file resource
[2012-08-22 14:33:52 -0400] paulmooring: which would skip that file if it exists, the downside there being some OSes will autocreate a .bashrc when a user is created which would prevent Chef from putting yours in place
[2012-08-22 14:34:16 -0400] UukGoblin: hm, and also it'd re-create it if the user deleted it
[2012-08-22 14:35:10 -0400] paulmooring: UukGoblin: The assumption there is you would use Chef to delete the user :)
[2012-08-22 14:36:10 -0400] paulmooring: for q2, you can force certain packages to be removed with `action :remove` or `action purge` on the package resource
[2012-08-22 14:36:29 -0400] fish_: did anyone try to install couchdb 1.2 with the couchdb cookbook?
[2012-08-22 14:36:34 -0400] fish_: (from source)
[2012-08-22 14:36:46 -0400] fish_: it's not working for me on debian squeeze
[2012-08-22 14:36:47 -0400] paulmooring: but you have to know what packages you want removed, which could be done but it's not really trivial to dynamically build that
[2012-08-22 14:37:26 -0400] paulmooring: railsraider: I've heard of chef-capistrano and spoken to 1 person who was using/happy with it
[2012-08-22 14:37:42 -0400] paulmooring: but I've never really used it and I'm not sure I entirely understand what it's for
[2012-08-22 14:37:46 -0400] UukGoblin: paulmooring, for q2, I'm guessing like a recipe that does dpkg -l and then removes everything it doesn't know about
[2012-08-22 14:39:17 -0400] paulmooring: UukGoblin: That's exactly what I was getting at, sort of a whitelist array and shelling out to dpkg
[2012-08-22 14:40:13 -0400] paulmooring: You could even make a whitelist packages cookbook and upload it back to the communit site for bonus karma
[2012-08-22 14:40:44 -0400] UukGoblin: mhm :->
[2012-08-22 14:40:48 -0400] drrk: you want to be careful it doesn't remove dependancies of other packages
[2012-08-22 14:40:58 -0400] UukGoblin: I'm not in urgent need of it yet, just curious about what chef can do
[2012-08-22 14:41:08 -0400] UukGoblin: drrk, yeah, that's a little problematic
[2012-08-22 14:41:23 -0400] drrk: making it only act on packages with the manual flag would help
[2012-08-22 14:41:39 -0400] paulmooring: UukGoblin: I think apt can differentiate between explicitly installed pkgs vs dependencies
[2012-08-22 14:41:43 -0400] UukGoblin: drrk, well, it'd ideally read the entire package descriptions
[2012-08-22 14:42:08 -0400] UukGoblin: the problem there is, if a noob sysadmin installs foobar, and foobar depends on foobaz, then chef would only remove foobar
[2012-08-22 14:42:17 -0400] UukGoblin: unless it used aptitude or something smart
[2012-08-22 14:42:29 -0400] fish_: can I tell chef to keep the tmp files for debugging purposes?
[2012-08-22 14:42:34 -0400] UukGoblin: but I guess that would rely on the noob sysadmin also using aptitude
[2012-08-22 14:42:47 -0400] drrk: UukGoblin: well run apt-get autoremove afterwards :)
[2012-08-22 14:43:02 -0400] UukGoblin: ah, that's that smart thing I was thinking of
[2012-08-22 14:44:35 -0400] drrk: Alternativly you could chop the noob sysadmins fingers off ;)
[2012-08-22 14:45:32 -0400] alexbst: jonlives - how is the next knife-spork release looking ?
[2012-08-22 14:45:42 -0400] UukGoblin: he'd find a way to install stuff with his nose ;-/
[2012-08-22 14:45:53 -0400] jonlives: alexbst: it's coming, work time constraints are holding it up a little though.
[2012-08-22 14:46:01 -0400] jonlives: hoping to have something out before the end of the month
[2012-08-22 15:14:32 -0400] iamchrisf: All,  does turning debug on for server actually do anything?  Seeing the same data as info.
[2012-08-22 15:15:12 -0400] iamchrisf: trying to debug why our chef server is running like shite.  And server logs are not providing the best insight.
[2012-08-22 15:15:23 -0400] fish_: haha, chef.. couchdb cookbook fails to install couchdb from source. but when I run chef-=client manually it just works
[2012-08-22 15:25:16 -0400] cjblomqvist: If you do 'chef-solo -c ~/solo.rb -j ~/node.json -r <my url to the tar of my cookbooks directory>' are those cookbooks not supposed to get copied to my cookbook_path directory?
[2012-08-22 15:31:09 -0400] _JamieD_: I'm getting an issue when trying to install the "pg" gem under chef's ruby. error: Can't find the PostgreSQL client library (libpq)
[2012-08-22 15:31:23 -0400] _JamieD_: It installs ok using the system ruby though
[2012-08-22 15:32:02 -0400] BryanWB_: _JamieD_: for me i had to symlink    /usr/pgsql-9.0/bin/pg_config  /usr/bin/pg_config
[2012-08-22 15:32:10 -0400] BryanWB_: nothing else fixed it for me
[2012-08-22 15:33:53 -0400] _JamieD_: BryanWB_: /usr/bin already has pg_config in there, did you overwrite that file?
[2012-08-22 15:42:57 -0400] Jay_Levitt: _JamieD_: Is that with the omnibus install?
[2012-08-22 15:43:38 -0400] _JamieD_: Jay_Levitt: no I'm using the database cookbook to setup a postgres user with chef solo
[2012-08-22 15:44:19 -0400] _JamieD_: Jay_Levitt: I saw there were bug reports talking about omnibus, I don't actually know what omnibus is though
[2012-08-22 15:44:35 -0400] Jay_Levitt: _JamieD_: omnibus = chef installs with its own ruby, gems, etc in its own directory
[2012-08-22 15:44:54 -0400] Jay_Levitt: and I know there's a problem with building the pg gem, something to do with conflicting ssl libraries, I forget the details
[2012-08-22 15:54:06 -0400] _JamieD_: Jay_Levitt: ah, ok, well I am using it then :) any ideas on a fix/workaround?
[2012-08-22 15:59:21 -0400] _JamieD_: this is the same issue that I'm getting http://tickets.opscode.com/browse/COOK-1406
[2012-08-22 16:02:32 -0400] BryanWB_: _JamieD_: werd, i don't have pg_config there
[2012-08-22 16:02:36 -0400] BryanWB_: i m using omnibus
[2012-08-22 16:10:24 -0400] fromonesrc: anyone here familiar with the collectd cookbook?
[2012-08-22 16:10:37 -0400] fromonesrc: I'm getting 400 bad request when using collectd::client in my runlist
[2012-08-22 16:30:41 -0400] dopacki: hi.
[2012-08-22 16:30:56 -0400] dopacki: sorry if this is a repost - client freaking out..
[2012-08-22 16:30:59 -0400] dopacki: hi - is there an accepted way to bootstrap ec2 servers with knife, when the provisioned servers will only be able to communicate with chef in one direction? Specifically, the clients will be able to connect to chef, but chef will not be able to ssh into the clients at any time.
[2012-08-22 16:32:32 -0400] dopacki: I can certainly inject the bootstrap script into the ec2 hosts as user-data, but in my limited experience, it seems like knife would just keep trying to ssh into the client
[2012-08-22 16:33:03 -0400] leifmadsen: since knife ssh's into the client in order to communicate with it, ya it would
[2012-08-22 16:33:28 -0400] leifmadsen: perhaps the alternative is to look into the first-boot.json stuff
[2012-08-22 16:34:07 -0400] leifmadsen: I've not used it, so I'm unsure if that helps at all
[2012-08-22 16:34:15 -0400] pwf: i'm trying to switch from running chef-client as a daemon to using cron, but it's not stopping the old daemon process... has anyone seen this: http://www.hastebin.com/yumefenidu.txt
[2012-08-22 16:34:33 -0400] pwf: i'm using the standard opscode chef-client cookbook
[2012-08-22 16:37:04 -0400] dopacki: thanks, leifmadsen - I'll check that out.
[2012-08-22 16:37:51 -0400] dopacki: it seems like this is a similar problem to how one would use chef with ec2 auto-scaling
[2012-08-22 16:39:13 -0400] dopacki: bummed to miss out on some of the more useful capabilities of knife, but guess there's always trade-offs
[2012-08-22 16:39:46 -0400] leifmadsen: ya, I still allow ssh, just in a restricted environment (e.g. only from a specific machine and IP)
[2012-08-22 16:40:12 -0400] leifmadsen: it's just too much overhead in terms of time and run around to not allow knife to be used fully
[2012-08-22 16:42:29 -0400] pwf: ah, figured out my problem... apparently we were running it as upstart, so that's what i got when using the 'service' command, but chef-client is running /etc/init.d/chef-client directly and that is failing
[2012-08-22 16:44:39 -0400] gyre007: I have downloaded sensu cookbook from community site via knife download cookbook...and it created a bunch of new git branches on my host machine
[2012-08-22 16:44:44 -0400] gyre007: ie on my laptop
[2012-08-22 16:44:50 -0400] gyre007: how do I remove them ?
[2012-08-22 16:49:14 -0400] dopacki: leifmadsen - this is all AWS VPC
[2012-08-22 16:49:21 -0400] leifmadsen: ah
[2012-08-22 16:49:23 -0400] dopacki: connectivity is only in one direction
[2012-08-22 16:50:14 -0400] dopacki: I'm just going to make a cloud-init script that simulates knife bootstrap..
[2012-08-22 16:50:16 -0400] leifmadsen: oic -- ya I don't use vpc
[2012-08-22 17:11:55 -0400] anentropic: does anyone use 'deploy' resources?
[2012-08-22 17:13:50 -0400] meisen: is anyone online that uses chef to manage windows resources?
[2012-08-22 17:16:50 -0400] paulmooring: meisen: I have a bit of experience, got a more specific question?
[2012-08-22 17:17:08 -0400] paulmooring: anentropic: yes lots of people frequently I think
[2012-08-22 17:18:14 -0400] anentropic: paulmooring: I'm trying to work out why migrations aren't happening
[2012-08-22 17:18:40 -0400] anentropic: it looks form the source like migration only happens if updated_by_last_action(true) was set on the resource
[2012-08-22 17:19:16 -0400] anentropic: so in deploy.rb basically nothing sets that value
[2012-08-22 17:19:44 -0400] anentropic: in the git scm_provider it gets set only when you add a remote
[2012-08-22 17:19:51 -0400] meisen: Hi PaulMooring... thanks!  I am wondering if/how you schedule chef-client on the node.  I found some posts that imply the recent msi installers actually allow for it to be deployed as a service, but I haven't quite figured that out.  I can always just schedule them via Windows Scheduler, but I'd like to minimize the non-standard stuff
[2012-08-22 17:20:13 -0400] anentropic: and then, the scm_provider is a composed resource so that wouldn't affect the deploy resource it belongs to (?)
[2012-08-22 17:20:31 -0400] anentropic: ultimately I'm using the application_python/django resource from opscode-cookbooks
[2012-08-22 17:20:35 -0400] paulmooring: meisen: I would recommend using the chef-client cookbook
[2012-08-22 17:20:54 -0400] paulmooring: but you could manually set up the service or scheduled task if you would rather
[2012-08-22 17:20:57 -0400] anentropic: seems like there's nothing in there to set it either, so on initial provisioning no migration happens
[2012-08-22 17:21:25 -0400] anentropic: but for django app you need an initial manage.py syncdb for the site to work
[2012-08-22 17:21:26 -0400] juliancdunn: meisen: the chef-client cookbook will support Windows and install chef client as a service
[2012-08-22 17:21:39 -0400] anentropic: it just all seems broken
[2012-08-22 17:22:33 -0400] juliancdunn: meisen: however, I've found that chef-client::config does not work properly because it tries to set "owner" and "group" like a UNIX system
[2012-08-22 17:23:24 -0400] paulmooring: juliancdunn: I believe that was recently fixed an an updated version was shipped this week
[2012-08-22 17:24:27 -0400] juliancdunn: paulmooring: it's still not fixed... lines 64-65 of https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/config.rb still try to set owner and group
[2012-08-22 17:24:31 -0400] paulmooring: I could be wrong about the config recipe, but I know the service recipe is working on windows as I used it yesterday
[2012-08-22 17:25:09 -0400] juliancdunn: yup, me too... but trying to use the config recipe bombed out
[2012-08-22 17:25:28 -0400] paulmooring: anentropic: I've not used it for django deployments before but it sounds like you're right
[2012-08-22 17:25:52 -0400] paulmooring: juliancdunn: do you know if a Jira ticket has already been created?
[2012-08-22 17:26:50 -0400] meisen: juliancdunn + paulmorring: thanks, I will check that out or at least follow it
[2012-08-22 17:26:56 -0400] anentropic: paulmooring: I'm quite new to chef but it seems to me like the 'deploy' resource should set itself as updated if it eg got a new revision when it checked out the git
[2012-08-22 17:26:57 -0400] juliancdunn: paulmooring: I haven't created one... didn't have time
[2012-08-22 17:27:26 -0400] paulmooring: juliancdunn: np, I'm gonna create one now
[2012-08-22 17:40:30 -0400] MuraliK: New to Chef Client and Server installation. Chef Server on Cent OS 6.3 gets crashed when I run the Client, the error I see is @ http://pastebin.com/GV681Zhq. Any help is appreciated
[2012-08-22 17:41:32 -0400] dwhsix: (asking again since I don't know if my message got out cause of the network burp)
[2012-08-22 17:41:44 -0400] dwhsix: is the process for merging upstream changes for a cookbook documented somewhere?
[2012-08-22 17:41:44 -0400] dwhsix: e.g. if I've done a knife cookbook site install tomcat, and want to get the latest version merged?
[2012-08-22 17:42:10 -0400] shillinm: in the selinux cookbook, the line "  only_if "selinuxenabled" " doesnt seem to be working.  Can anyone tell me where "selinuxenabled" variable should get set?
[2012-08-22 17:42:38 -0400] MuraliK: New to Chef Client and Server installation. Chef Server on Cent OS 6.3 gets crashed when I run the Client, the error I see is @ http://pastebin.com/GV681Zhq. Any help is appreciated
[2012-08-22 17:50:24 -0400] jan0232: anybody using vagrant with chef?? i get the error "The chef binary (either `chef-solo` or `chef-client`) was not found on
[2012-08-22 17:50:25 -0400] jan0232: the VM and is required for chef provisioning."  when doing vagrant provision
[2012-08-22 17:50:48 -0400] jan0232: i don't know why  chef-solo etc. are all available under /usr/bin
[2012-08-22 17:52:27 -0400] jkyle: zts: yeah, that's the REST api, I'm looking for the actual library API's.
[2012-08-22 17:57:57 -0400] dwhsix: (apologies for asking a third time but with networking funkiness, not sure if this got seen; I won't ask again ;-) )
[2012-08-22 17:58:21 -0400] dwhsix: is the process for merging upstream changes for a cookbook documented somewhere?
[2012-08-22 17:58:21 -0400] dwhsix: e.g. if I've done a knife cookbook site install tomcat, and want to get the latest version merged?
[2012-08-22 18:03:35 -0400] jan0232: what??? why??  #<Chef::Provider::Service::Init:0x000000043fc5b0> does not support :enable
[2012-08-22 18:03:57 -0400] jan0232: service "my service" do action [:enable, :start] end
[2012-08-22 18:04:11 -0400] jan0232: why do i get an error that enable is not supported??
[2012-08-22 18:04:16 -0400] jan0232: :(
[2012-08-22 18:04:44 -0400] dwhsix: help, very confused. http://community.opscode.com/cookbooks/tomcat says there is a version 0.11.0
[2012-08-22 18:05:06 -0400] dwhsix: but there's no such tagged version in github - https://github.com/opscode-cookbooks/tomcat
[2012-08-22 18:05:19 -0400] dwhsix: what am I missing?
[2012-08-22 18:05:37 -0400] jan0232: dwhsix: probably a mistake on the community site
[2012-08-22 18:06:15 -0400] jan0232: dwhsix: wait you can download the 0.11
[2012-08-22 18:06:19 -0400] dwhsix: jan0232: thx but I can download it
[2012-08-22 18:06:21 -0400] dwhsix: yeah
[2012-08-22 18:06:40 -0400] jan0232: that is weird :)
[2012-08-22 18:07:17 -0400] jan0232: seems to be fairly recentmaybe they pushed it to that site first and github will follow
[2012-08-22 18:07:20 -0400] jtimberman: i might not have pushed the tag
[2012-08-22 18:07:22 -0400] dwhsix: maybe someone at opscode has to do a git push or a merge or something?
[2012-08-22 18:07:33 -0400] dwhsix: jtimberman: -whew-
[2012-08-22 18:07:49 -0400] jtimberman: sorry about that!
[2012-08-22 18:08:04 -0400] dwhsix: np - I am ALWAYS forgetting to push tags
[2012-08-22 18:08:30 -0400] jtimberman: this is why i want to get around to writing my "release" plugin for knife :)
[2012-08-22 18:08:52 -0400] dwhsix: do you know when yuo might be able to do that?  I assume I need that to be able to merge 0.11.0 into my local?
[2012-08-22 18:08:55 -0400] dwhsix: since I did a cookbook site install?
[2012-08-22 18:09:21 -0400] jtimberman: you should be able to just do
[2012-08-22 18:09:24 -0400] jtimberman: knife cookbook site install tomcat
[2012-08-22 18:09:27 -0400] jtimberman: and get the new version
[2012-08-22 18:09:35 -0400] dwhsix: oh ok
[2012-08-22 18:09:59 -0400] dwhsix: yup, worked
[2012-08-22 18:10:15 -0400] dwhsix: thx
[2012-08-22 18:12:04 -0400] jan0232: how can a service not support "enable"???
[2012-08-22 18:12:10 -0400] jan0232: i really don't know how to debug this
[2012-08-22 18:20:15 -0400] miah: jan0232: http://wiki.opscode.com/display/chef/Providers
[2012-08-22 18:20:57 -0400] miah: with that in mind
[2012-08-22 18:20:58 -0400] miah: also read
[2012-08-22 18:20:59 -0400] miah: http://wiki.opscode.com/display/chef/Resources#Resources-Service
[2012-08-22 18:21:06 -0400] jan0232: miah: well, yea...but
[2012-08-22 18:21:07 -0400] jan0232: http://wiki.opscode.com/display/chef/Resources#Resources-Service
[2012-08-22 18:21:21 -0400] jan0232: Actions enable
[2012-08-22 18:21:33 -0400] jan0232: Use action :enable to enable it at boot
[2012-08-22 18:21:43 -0400] miah: does your system have a way to enable it though
[2012-08-22 18:21:44 -0400] jan0232: that's what i'm doing and i get this error
[2012-08-22 18:22:10 -0400] jan0232: miah: hmm, i don't know, i thought yesbut obviously not I'm running ubuntu 12.04
[2012-08-22 18:22:13 -0400] miah: or more specifically, does the service provider for your os/distribution know how to enable it
[2012-08-22 18:23:10 -0400] miah: i bet if you look at the logs, there are more specific details
[2012-08-22 18:24:33 -0400] geekbri: Well ubuntu should certainly support the "enable" action for service.
[2012-08-22 18:27:11 -0400] geekbri: default provider for ubuntu service is Chef::Provider::Service::Debian::Init
[2012-08-22 18:28:11 -0400] geekbri: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/service/debian.rb#L108-121
[2012-08-22 18:28:26 -0400] jan0232: http://pastie.org/4569652
[2012-08-22 18:30:00 -0400] geekbri: Ok well is interesting there is that it is using Chef::Provider::Service::Init  which definitely doesn't support enable.
[2012-08-22 18:30:06 -0400] jan0232: geekbri: aaahh, i think that would be it. the runit recipe does the following...
[2012-08-22 18:30:15 -0400] jan0232: service blaa do...
[2012-08-22 18:30:16 -0400] jan0232: provider Chef::Provider::Service::Init
[2012-08-22 18:30:22 -0400] geekbri: yup.
[2012-08-22 18:30:24 -0400] geekbri: There ya go,
[2012-08-22 18:30:50 -0400] geekbri: Service::Init only supports start, stop, restart, reload
[2012-08-22 18:30:54 -0400] jan0232: can i overwrite that by calling service "name" again and passing a different provider?
[2012-08-22 18:31:01 -0400] jan0232: or would i need to change the runit cookbook
[2012-08-22 18:31:53 -0400] geekbri: Doesn't runit use the service command to control starting and stopping things?
[2012-08-22 18:32:34 -0400] jan0232: yes runit uses the service command internally and it passes the Service::Init as a provider
[2012-08-22 18:32:50 -0400] jtimberman: be aware of CHEF-154, as that may change to an LWRP in the future.
[2012-08-22 18:33:07 -0400] geekbri: Yes, I've been hoping it would :-P
[2012-08-22 18:33:38 -0400] jan0232: i see
[2012-08-22 18:34:42 -0400] jan0232: well that would be much better
[2012-08-22 18:34:54 -0400] geekbri: yes, boo to definitions
[2012-08-22 18:35:04 -0400] jan0232: is there an early version that does this already?
[2012-08-22 18:35:46 -0400] geekbri: jan0232: you could fork that CB then change the provider to Chef::Provider::Service::Debian::Init
[2012-08-22 18:36:06 -0400] geekbri: it looks like the runnit definition is explicitly defining the start/stop/restart/reload commands
[2012-08-22 18:36:26 -0400] geekbri: does runit make symlinks in /etc/init.d/ and handle that situation properly?
[2012-08-22 18:36:35 -0400] geekbri: I know bluepill does, I can't remember about runit
[2012-08-22 18:37:44 -0400] jan0232: not sure if i'm doing something wrong here anyway..i'm using both runit AND bluepill, no idea if that makes sense?
[2012-08-22 18:38:58 -0400] jan0232: geekbri: the Debian::Init provider is that the default if i don't pass a provider to the service block??
[2012-08-22 18:39:04 -0400] jan0232: under ubuntu i mean
[2012-08-22 18:39:19 -0400] geekbri: jan0232: Yes.
[2012-08-22 18:39:25 -0400] geekbri: jan0232: well assuming youre on ubuntu or debian :)
[2012-08-22 18:39:35 -0400] jan0232: agh i see now everything makes sense
[2012-08-22 18:40:46 -0400] jan0232: now i only need to figure out why "vagrant provision" doesn't work once the first chef run completes
[2012-08-22 18:41:33 -0400] jan0232: the vagrant source code tells me it does "which chef-solo" to make sure it finds the binary and then it fails with an exception. however, the binary is perfectly there in /usr/bin :D ...
[2012-08-22 18:41:48 -0400] jan0232: there is a binary_path configuration that can be setbut that doesn't help either
[2012-08-22 18:42:28 -0400] geekbri: jan0232: default providers for ubuntu, https://github.com/opscode/chef/blob/master/chef/lib/chef/platform.rb#L68-75
[2012-08-22 18:43:10 -0400] jan0232: geekbri: i really don't get why the runit cookbook then hardcodes "provider Chef::Service::Init"
[2012-08-22 18:43:22 -0400] jan0232: just removing that line would solve all my problems ;)
[2012-08-22 18:43:55 -0400] geekbri: jan0232: Not sure.  I dont use runit on the regular (yet).  Maybe it has to do with the fact that by default runit doesn't setup properly what needs to be in place for update-rc.d to work properly and enable the services?
[2012-08-22 18:44:23 -0400] geekbri: jan0232: so this way the runit service definition doesn't seem to provide enable and disable when they indeed may or may not actually do what they are supposed to?
[2012-08-22 18:44:45 -0400] jan0232: ah ok
[2012-08-22 18:44:45 -0400] geekbri: I honestly took one look at that cookbook, saw it was using some huge definitions and was like, I do not have time to look at this any further! and moved on :)
[2012-08-22 18:44:59 -0400] geekbri: I did read that it was potentially being switched to an LWRP though and thought to myself... mmmmm yes excellent.
[2012-08-22 18:45:49 -0400] jan0232: maybe i can do everything with bluepill and skip runit altogether...
[2012-08-22 18:46:06 -0400] geekbri: I hear runit is good.  My experience with bluepill is mixed personally :)
[2012-08-22 18:46:39 -0400] jan0232: my plan was using runit and bluepilland use bluepill just to monitor memory and cpu usage etc.
[2012-08-22 18:46:48 -0400] geekbri: the opscode bluepill cookbook is pretty good.  Riotgames forked it and has a branch which added "reload" to it which I am using.  Although they haven't merged it into their master branch of their own bluepill CB so theres that whole thing
[2012-08-22 18:47:23 -0400] jtimberman: geekbri: is there a ticket for adding that feature?
[2012-08-22 18:48:21 -0400] geekbri: jtimberman: not as far as I know, it doesn't look like something they were passing upstream.
[2012-08-22 18:49:55 -0400] geekbri: https://github.com/RiotGames/bluepill/commit/54b98efe54561c76f813881c189339d01b043ffe
[2012-08-22 18:50:32 -0400] geekbri: I haven't had any free bandwidth to dig too deeply into it.
[2012-08-22 18:51:08 -0400] geekbri: Well Riot has 2 tickets they opened related to the bluepill CB and they sent them upstream.
[2012-08-22 18:51:17 -0400] geekbri: Maybe they want to test this more, or make changes. I dunno.
[2012-08-22 18:51:27 -0400] geekbri: Maybe they decided they don't like it.
[2012-08-22 18:52:01 -0400] jan0232: ok waiti think i'm actually doing something weird here aren't bluepill and runit essentially trying to solve the same problem??
[2012-08-22 18:52:09 -0400] jan0232: so it wouldn't make sense to use them both
[2012-08-22 18:52:25 -0400] hoover_damm: geekbri, reload the service?
[2012-08-22 18:52:25 -0400] jan0232: seems to me i'm overcomplicating this stuff :)
[2012-08-22 18:52:40 -0400] hoover_damm: geekbri, wuldn't bluepill load file.pill followed with a restart do the same?
[2012-08-22 18:52:55 -0400] hoover_damm: geekbri, reload is a stop, then load the pill to make it start a new one... weird
[2012-08-22 18:53:01 -0400] hoover_damm: not a pattern i'd follow
[2012-08-22 18:55:09 -0400] jan0232: ok i think i can just drop runit and just use bluepill...
[2012-08-22 19:11:59 -0400] leifmadsen: afternoon all -- I have a system I'm working on setting up again, and for some reason, when I do a, "service chef-solr status" or anything else with chef-solr or chef-expander init scripts, nothing is returned. chef-server however returns data and restarts without issue
[2012-08-22 19:14:53 -0400] leehambley: Where cna I start looking for a difference between "gem install pg -v "0.14.0" and "/opt/chef/embedded/bin/gem install pg -q --no-rdoc --no-ri"
[2012-08-22 19:15:12 -0400] leehambley: the former succeeds, and the latter fails (as a privilidged user on the box, and via chef)
[2012-08-22 19:15:29 -0400] leehambley: the ruby versions are subtly different, 1.9.2 vs.1.9.3
[2012-08-22 19:15:32 -0400] leehambley: but not drastically so
[2012-08-22 19:18:05 -0400] leehambley: seems it's a bug: http://tickets.opscode.com/browse/COOK-1406
[2012-08-22 19:18:13 -0400] leehambley: but I'm not sure why I have "omnibus" chef, whatever that is
[2012-08-22 19:18:22 -0400] hoover_damm: it's the default..
[2012-08-22 19:18:35 -0400] hoover_damm: you need to bootstrap with the ubuntu-gems
[2012-08-22 19:19:08 -0400] leifmadsen: for me, issue was init script appears to be pointing at wrong location to chef-solr bin
[2012-08-22 19:19:20 -0400] hoover_damm: there's a 10.04-gems and 12.04
[2012-08-22 19:19:37 -0400] leehambley: hoover_damm: I'm not sure how I was bootstrapped - I'm suing somthing called knife-solo, I'll have to see how that was bootstrapped
[2012-08-22 19:21:09 -0400] leehambley: hoover_damm: can I solve that bug by taking an older version of omnibus-chef ?
[2012-08-22 19:21:15 -0400] leehambley: https://github.com/matschaffer/knife-solo/blob/master/lib/chef/knife/prepare.rb#L21
[2012-08-22 19:24:52 -0400] hoover_damm: leehambley, not sure how you'll achieve that with knife-solo
[2012-08-22 19:25:08 -0400] hoover_damm: leehambley, should talk to the author of knife-solo because basically you need to tell it to use a bootstrap template
[2012-08-22 19:25:08 -0400] leehambley: I think it migh tbe a bit late, this is a bare-metal box, and I'm already bootstrapped
[2012-08-22 19:25:11 -0400] hoover_damm: and which one
[2012-08-22 19:25:17 -0400] hoover_damm: likely ubuntu12.04-gems or ubuntu10.04-gems
[2012-08-22 19:25:20 -0400] hoover_damm: should work fine for templates
[2012-08-22 19:25:21 -0400] leehambley: ok, no problem
[2012-08-22 19:25:29 -0400] leehambley: which one does someone get by default ?
[2012-08-22 19:25:33 -0400] leehambley: just "none"
[2012-08-22 19:25:36 -0400] hoover_damm: you'll need to remove the omnibus and install with that bootstrap
[2012-08-22 19:25:42 -0400] hoover_damm: by default you get omnibus
[2012-08-22 19:25:52 -0400] hoover_damm: if you don't want omnibus you need to tell chef that
[2012-08-22 19:26:03 -0400] leehambley: ah, ok
[2012-08-22 19:26:05 -0400] hoover_damm: your knife-solo script lacks that option
[2012-08-22 19:26:08 -0400] matschaffer: leehambley: if you need a bootstrap template I recommend just using knife-bootstrap
[2012-08-22 19:26:16 -0400] matschaffer: knife bootstrap
[2012-08-22 19:26:33 -0400] leehambley: ok, thanks for the reading matschaffer
[2012-08-22 19:26:41 -0400] matschaffer: I mention it in https://github.com/matschaffer/knife-solo#prepare-command
[2012-08-22 19:26:49 -0400] leehambley: ( hoover_damm, matschaffer wrote knife-solo )
[2012-08-22 19:27:01 -0400] matschaffer: never intended knife prepare to be everything for everyone, just a good starting point if you didn't need anything too specific
[2012-08-22 19:27:21 -0400] leehambley: right, I was about to say "there's something in the knofe-solo documentation about using manual bootstrap"
[2012-08-22 19:27:34 -0400] matschaffer: you can probably still use knife cook after that
[2012-08-22 19:27:44 -0400] leehambley: what's the safest way to remove chef without bricking this box?
[2012-08-22 19:27:50 -0400] leehambley: can I just blow away /opt/chef/
[2012-08-22 19:28:07 -0400] hoover_damm: yep
[2012-08-22 19:28:12 -0400] hoover_damm: and rm -rf /etc/chef
[2012-08-22 19:28:19 -0400] hoover_damm: you don't have to do that
[2012-08-22 19:28:32 -0400] hoover_damm: but :) I prefer to clean up everywhere and then make new clients and node entries if i'm changing much
[2012-08-22 19:28:37 -0400] leehambley: :-)
[2012-08-22 19:28:39 -0400] leehambley: ok, cool
[2012-08-22 19:28:49 -0400] leehambley: great, lemme try that, thanks guys
[2012-08-22 19:30:33 -0400] leehambley: next question before I do that - is how should I best specify using https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/ubuntu12.04-gems.erb - do I have to duplicate that file and use it with "knife bootstrap --template-file"
[2012-08-22 19:31:35 -0400] jessicab: leehambley: you can just specify it with -d like 'knife bootstrap -d ubuntu12.04-gems' its downloaded with the rest of chef when you install
[2012-08-22 19:31:42 -0400] leehambley: (sorry, no - that's a distro, right)
[2012-08-22 19:32:09 -0400] jessicab: template-file is for when you make your own, and want to specify the full path.. you could also use that, you just dont need to really
[2012-08-22 19:33:21 -0400] split[|]brain: hi, qq about cookbook_file, is the file copied every run regardless if the file is already current on the destination?
[2012-08-22 19:33:39 -0400] leehambley: cool, thanks all
[2012-08-22 19:33:43 -0400] leehambley: ERROR: Errno::ENOENT: No such file or directory - /etc/chef/validation.pem
[2012-08-22 19:33:47 -0400] leehambley: damnit
[2012-08-22 19:34:21 -0400] leehambley: (I'm trying to use chef-solo, what's the validation file for?)
[2012-08-22 19:34:30 -0400] bluepojo: it's for creating clients in chef server
[2012-08-22 19:34:50 -0400] leehambley: urgh, there's no option to knife bootstrap to ignore that
[2012-08-22 19:34:50 -0400] bluepojo: your knife.rb might be trying to load it
[2012-08-22 19:35:17 -0400] leehambley: I don't have a knife.rb
[2012-08-22 19:35:20 -0400] bluepojo: and you don't bootstrap with chef-solo
[2012-08-22 19:35:28 -0400] bluepojo: you just run it
[2012-08-22 19:35:48 -0400] leehambley: well, it has to get installed with the distro at least
[2012-08-22 19:35:58 -0400] bluepojo: what does
[2012-08-22 19:36:51 -0400] leehambley: well the origal problem I have is that the "pg" gem can't find libpg (for some weird reason I don't understand)
[2012-08-22 19:37:23 -0400] leehambley: the work-around for which is to use a chef distribution for ubuntu-12.04-gems
[2012-08-22 19:37:38 -0400] matschaffer: leehambley: you can't use the distro bootstrap scripts with chef-solo
[2012-08-22 19:37:47 -0400] matschaffer: easier to just make your own copy
[2012-08-22 19:37:48 -0400] leehambley: so I can;t use `pg`
[2012-08-22 19:37:51 -0400] bluepojo: you can
[2012-08-22 19:37:59 -0400] bluepojo: just that work around is for boostrapping
[2012-08-22 19:38:06 -0400] leehambley: it doesn't work, http://tickets.opscode.com/browse/COOK-1406
[2012-08-22 19:38:06 -0400] bluepojo: which you're not doing
[2012-08-22 19:38:56 -0400] leehambley: I'm totally confused
[2012-08-22 19:39:16 -0400] bluepojo: chef-solo is an alternate way to run chef recipes on a node
[2012-08-22 19:39:27 -0400] bluepojo: bootstrapping the node is not part of that process
[2012-08-22 19:39:33 -0400] bluepojo: the work around you found
[2012-08-22 19:39:35 -0400] jessicab: at the bottom of that bug ive posted a few way to work around that issue btw
[2012-08-22 19:39:39 -0400] bluepojo: is forpeople doing bootstrapping
[2012-08-22 19:39:53 -0400] matschaffer: bluepojo: depends on what you call "bootstrapping" thought right? You need some way to get chef installed on the box first
[2012-08-22 19:39:59 -0400] leehambley: right, got that part - that's all I need right now, and I'm happy with that, knife-solo is a convenience tool that I'm using that matschaffer wrote, it's rsyncing my recipes/etc to the server, then calling out to chef to run them (basically)
[2012-08-22 19:39:59 -0400] bluepojo: well yeah
[2012-08-22 19:40:03 -0400] bluepojo: but I mean knife bootstrap
[2012-08-22 19:40:12 -0400] matschaffer: bluepojo: you can use knife bootstrap for chef solo though
[2012-08-22 19:40:15 -0400] bluepojo: ah ok
[2012-08-22 19:40:20 -0400] matschaffer: just don't run chef-client at the end
[2012-08-22 19:40:38 -0400] leehambley: matschaffer: seems to want a /etc/chef/validation.pem (which has no reason to exist on chef-solo, right?)
[2012-08-22 19:41:13 -0400] leehambley: [ https://gist.github.com/607235d2dbbd5abf9f29 ]
[2012-08-22 19:41:36 -0400] matschaffer: oooh that's just your local knife config
[2012-08-22 19:41:43 -0400] matschaffer: or is it. hard to tell
[2012-08-22 19:41:52 -0400] matschaffer: try -VV
[2012-08-22 19:41:54 -0400] bluepojo: well
[2012-08-22 19:41:58 -0400] matschaffer: not sure if that error is your machine or the machine under test
[2012-08-22 19:42:12 -0400] bluepojo:  /etc/chef is the default
[2012-08-22 19:42:18 -0400] bluepojo: so if no config, it'll look there
[2012-08-22 19:42:53 -0400] leehambley: there's no /etc/chef on my machine (Mac)
[2012-08-22 19:43:05 -0400] leehambley: and on the server I blew it away on hoover_damm's directions
[2012-08-22 19:43:31 -0400] leehambley: but, when I understand you correctly, I can replace `knife-solo` with rsync + shelling out
[2012-08-22 19:44:01 -0400] leehambley: which tbh I might be more comfortable doing, chef-solo is such a 2nd class citizen, I think I'd prefer to get closer to the working parts, and it's not that complex
[2012-08-22 19:44:45 -0400] leehambley: (strange knife-solo works PERFECTLY for me out of the box with `gem_package "pg"`, and following all instructions on a 10.4 LTS box, I wonder what changed in the lastest two .x releases of Chef, and Ubuntu)
[2012-08-22 19:47:31 -0400] matschaffer: leehambley: if you can send me details on what your'e doing I might be able to sort it out tomorrow
[2012-08-22 19:47:38 -0400] matschaffer: feel free to file as a GH issue on knife-solo
[2012-08-22 19:48:19 -0400] leehambley: matschaffer: sure, I will do - thanks - long story short I want to have my site-cookbook creat my users, that means the "pg" gem needs to be available to Chef, I'm seeing the exact error reported in http://tickets.opscode.com/browse/COOK-1406.
[2012-08-22 19:49:32 -0400] jessicab: leehambley: did you see the workaround i posted at the bottom of that bug? if you didnt install through knife bootstrap.. perhaps you used the install.sh script? a gem or apt-get install should get you off of the omnibus version too
[2012-08-22 19:49:40 -0400] matschaffer: oh interesting. reading this over it sounds like this is just a problem with the latest omnibus
[2012-08-22 19:49:53 -0400] leehambley: I've done this in the past on 10.4 LTS and (I was learning chef for the first time then) - it basically all "just worked" in the end, now on 12.4 - it's a bit of a different story - is all, and seems to be that simple
[2012-08-22 19:49:55 -0400] jtimberman: leehambley: yeah, so, the workaround for COOK-1406 is to use the distro provided ruby, and install chef as a rubygem.
[2012-08-22 19:50:58 -0400] leehambley: ok, thanks all -
[2012-08-22 19:51:19 -0400] leehambley: so it's right what I heard from some chaps in #elasticsearch that there's some weird regressions in the lastest chef point releases
[2012-08-22 19:51:28 -0400] matschaffer: leehambley: can you file that? knife-solo should probably go back to non-omnibus for ubuntu 12 then
[2012-08-22 19:52:03 -0400] leehambley: matschaffer: incoming
[2012-08-22 19:52:08 -0400] matschaffer: thx!
[2012-08-22 19:53:51 -0400] Hydroxide: any idea what would cause "Encoding::UndefinedConversionError: '\x86" from ASCII-8BIT to UTF-8" when a cookbook_file resource tries to install a non-ascii file?
[2012-08-22 19:54:41 -0400] Hydroxide: in that case it's a .a file (i.e. static library / ar archive) but I've seen it also with a .vimrc that was valid UTF-8 (it complained about \xe2 instead of \x86 for that)
[2012-08-22 19:57:32 -0400] Pushnell: Hey all.  New chef user following the EC2 bootstrap.  How do I get the AMI id for the standard 64-bit amazon linux AMI?
[2012-08-22 19:58:36 -0400] leehambley: matschaffer: https://github.com/matschaffer/knife-solo/issues/98
[2012-08-22 19:58:40 -0400] matschaffer: Pushnell: I often use the web console once to find it
[2012-08-22 19:58:51 -0400] matschaffer: I think they list amazon linux on the "featured" AMIs
[2012-08-22 19:59:12 -0400] leehambley: by the way, thanks for knife-solo, ti's the most sane way to get started for a beginner, as tempting as vagrant is, there's too many moving pieces, and vagrant requiring ruby, and requiring chef gets a bit messy!
[2012-08-22 19:59:35 -0400] Pushnell: matschaffer: thanks
[2012-08-22 20:01:54 -0400] matschaffer: leehambley: no problem. That was exactly my intent :)
[2012-08-22 20:02:14 -0400] leehambley: I *really* wish opscode took chef-solo a little more seriously, however
[2012-08-22 20:02:20 -0400] matschaffer: I'd love to get vagrant using knife-solo under the hood at some point, but I'm still pretty lukewarm on vagrant
[2012-08-22 20:02:26 -0400] matschaffer: love the idea, hate the kernel panics
[2012-08-22 20:02:32 -0400] leehambley: :-)
[2012-08-22 20:02:44 -0400] ivey: matschaffer: none of us have kernel panics...
[2012-08-22 20:02:54 -0400] matschaffer: ivey: got magics?
[2012-08-22 20:02:57 -0400] matschaffer: I got two this morning
[2012-08-22 20:03:11 -0400] matschaffer: seems to happen whenever I start getting really agressive on the ups/downs
[2012-08-22 20:03:19 -0400] ivey: i am a warlock, of course, but no
[2012-08-22 20:03:33 -0400] matschaffer: I had one on a destroy and another on an up
[2012-08-22 20:03:36 -0400] jessicab: leehambley: it isnt an issue just with chef-solo btw, that bug effects all of chef including just running that recipe on chef-client.. its an issue with the chef installer itself
[2012-08-22 20:03:42 -0400] matschaffer: both of which were in a session where I did up/destroy maybe 4-5 times
[2012-08-22 20:04:01 -0400] leehambley: sure jessicab, I wasn't suggesting this bug was indicative of a lack of love for chef-solo
[2012-08-22 20:04:23 -0400] jessicab: leehambley: ah sorry, i hadnt read the whole convo
[2012-08-22 20:04:31 -0400] leehambley: but there's a bit of a weird split, where I'm sure chef could have been designed better to run in "solo" mode, and the server could be used to provide assets, and config, and the installation would be still done by a "solo" client
[2012-08-22 20:04:49 -0400] leehambley: (imagining, chef-solo, chef-server-sync, and chef-server-control might have been a better architecture)
[2012-08-22 20:05:26 -0400] leehambley: also when you want ruby on the machine, there's always a risk of finding yourself stuck between chef, and your app's requirements (admittedly rbenv alleviates that mostly)
[2012-08-22 20:05:51 -0400] leehambley: and I find debugging chef-runs to be a pain, I want to try using pry, but i'm not sure how well that'll work over knife-solo
[2012-08-22 20:06:13 -0400] jtimberman: leehambley: you can use 'shef'
[2012-08-22 20:06:17 -0400] leehambley: (that's another thing you might want to do, really easily matschaffer - just dump the command that knife-solo is running to the terminal on the client, I know it's in one of the verbose logs)
[2012-08-22 20:06:18 -0400] jtimberman: leehambley: it defaults to 'solo' mode.
[2012-08-22 20:06:29 -0400] miah: https://github.com/Mon-Ouie/pry-remote
[2012-08-22 20:06:32 -0400] jtimberman: and you can then 'require "pry"' and have pry's helpful methods.
[2012-08-22 20:07:02 -0400] matschaffer: leehambley: if you run it with -VV it should do that
[2012-08-22 20:07:05 -0400] leehambley: yep, couple of those things I want to try
[2012-08-22 20:07:09 -0400] matschaffer: of it doesn't it's a bug
[2012-08-22 20:07:51 -0400] matschaffer: s/of/or/
[2012-08-22 20:07:57 -0400] leehambley: ( matschaffer it really might, but there's so much other output it's not that useful, and however trivial it might sound it took me a while to figure out what the right command for running an identical chef-solo command on the server, as knife-solo was doing would be)
[2012-08-22 20:07:57 -0400] pwf_: has anyone installed chef-client on mountain lion successfully yet?
[2012-08-22 20:08:06 -0400] pwf_: i'm trying to use gem install and getting this: xcrun: Error: failed to exec real xcrun. (No such file or directory)
[2012-08-22 20:08:11 -0400] pwf_: it's trying to compile yajl
[2012-08-22 20:08:31 -0400] scawa1952: yes  just did. am in the chef class
[2012-08-22 20:09:03 -0400] scawa1952: in the "install.sh" file you need to change a value from 10.7 to 10.8
[2012-08-22 20:09:16 -0400] pwf: i'm not using that, i'm using the knife bootstrap script
[2012-08-22 20:09:23 -0400] scawa1952: ah
[2012-08-22 20:09:34 -0400] scawa1952: sorry don't know then..
[2012-08-22 20:09:42 -0400] pwf: i modified the ubuntu version a bit to take out the apt stuff and install command line tools automatically
[2012-08-22 20:09:47 -0400] pwf: it worked fine on lion
[2012-08-22 20:09:53 -0400] pwf: i might have screwed up my CLT install...
[2012-08-22 20:11:48 -0400] leehambley: matschaffer: did I get the ticket contents at least half-way correct?
[2012-08-22 20:12:06 -0400] leehambley: I'll be online tomorrow, so you'll be able to reach me via GH, and I can re-test anything new
[2012-08-22 20:12:52 -0400] matschaffer: leehambley: I thought there was something about pg involved though?
[2012-08-22 20:13:09 -0400] leehambley: well, the ticket COOK-1406 is that problem
[2012-08-22 20:13:24 -0400] leehambley: (but you are right, I should mention that, ticket edit incoming)
[2012-08-22 20:13:42 -0400] matschaffer: it'd be nice to have the run list in here
[2012-08-22 20:13:46 -0400] matschaffer: just to make sure I'm doing the right thing
[2012-08-22 20:14:14 -0400] leehambley: erm, ok - see if I can get that
[2012-08-22 20:16:20 -0400] leehambley: issue updated matschaffer
[2012-08-22 20:18:51 -0400] matschaffer: leehambley: perfect
[2012-08-22 20:18:54 -0400] matschaffer: thanks
[2012-08-22 20:19:19 -0400] leehambley: no, thank you! As I said, I think I might have borked this box, source-installation of Ruby 1.9, which will probably hinder me
[2012-08-22 20:19:33 -0400] leehambley: and I have to admit, even after reading about it for 10m I have *no* idea why chef-omnibus exists
[2012-08-22 20:19:50 -0400] leehambley: seems like having a bunch of weird ways to install your software makes things a headache
[2012-08-22 20:20:10 -0400] cjblomqvist: Is there a proper way to check if a recipe is run through chef-solo vs on hosted chef (or own chef server)?
[2012-08-22 20:20:26 -0400] cjblomqvist: (in a recipe)
[2012-08-22 20:21:15 -0400] leehambley: (better yet matschaffer, maybe there's a way to use omnibus (if it really is just about being self-contained) if it can be told which distro template to use
[2012-08-22 20:23:10 -0400] leehambley: but, reach me via GH, and I'll sleep on it too
[2012-08-22 20:23:32 -0400] leehambley: and do some reading when I'm a) less moody with Chef, and b) less exhausted :-) -- and finally, thanks again, everyone! Good night
[2012-08-22 20:23:43 -0400] matschaffer: leehambley: I think I need an AST for that first comment ;)
[2012-08-22 20:24:12 -0400] matschaffer: leehambley: but yeah, this actually ties into some knife-solo thoughts I've been having
[2012-08-22 20:24:17 -0400] matschaffer: maybe talk to you tomorrow about them
[2012-08-22 20:24:20 -0400] leehambley: ok, then let's chat :-)
[2012-08-22 20:24:25 -0400] leehambley: what timezone are you in ?
[2012-08-22 20:24:28 -0400] matschaffer: EDT
[2012-08-22 20:24:43 -0400] matschaffer: usually online 9am-5pm then again 9pm-11pm
[2012-08-22 20:25:06 -0400] leehambley: ok, no problems CEST here
[2012-08-22 20:26:33 -0400] matschaffer: leehambley: cool, see you tonight or tomorrow afternoon then
[2012-08-22 20:26:38 -0400] matschaffer: actually tomorrow afternoon
[2012-08-22 20:26:41 -0400] matschaffer: giving a talk tonight
[2012-08-22 20:26:43 -0400] Pushnell: Could someone take a look at my first attempt to create an ec2 server?  http://pastebin.com/q2faSjcf  Not sure where I'm going wrong.
[2012-08-22 20:26:44 -0400] leehambley: alright, take it easy matschaffer :-)
[2012-08-22 20:26:48 -0400] matschaffer: (http://phillydevops.org/)
[2012-08-22 20:26:49 -0400] leehambley: hey, good luck, erm "break a leg"
[2012-08-22 20:26:52 -0400] matschaffer: g'night
[2012-08-22 20:27:04 -0400] leehambley: wish I could be there ^ that looks great
[2012-08-22 20:45:31 -0400] Pushnell: Hey all.  My first attempt to create an ec2 instance failed with "getaddrinfo: nodename nor servname provided, or not known (Excon::Errors::SocketError)".  Any tips or pointers would be appreciated.
[2012-08-22 20:45:42 -0400] Pushnell: http://pastebin.com/q2faSjcf
[2012-08-22 20:47:53 -0400] zuhaib: Pushnell: try -Ncheftest_1
[2012-08-22 20:47:57 -0400] zuhaib: (no space)
[2012-08-22 20:48:25 -0400] dwhsix: in the stacktrace it's fog failing on a describe_images call...
[2012-08-22 20:49:19 -0400] Pushnell: zuhaib: thanks.  same error though.
[2012-08-22 20:49:28 -0400] dwhsix: do yuo have awe credentials ni your knife.rb file?
[2012-08-22 20:49:30 -0400] dwhsix: http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step2%3AConfigureAWSsettingsandtheknife.rbfile
[2012-08-22 20:50:10 -0400] dwhsix: awe=AWS
[2012-08-22 20:50:20 -0400] zuhaib: Also I  notice that AMI is an GPU AMI, http://thecloudmarket.com/image/ami-eccf6285--amzn-ami-gpu-hvm-2012-03-3-x86-64-ebs
[2012-08-22 20:50:27 -0400] Pushnell: dwhsix: I noticed that.  This is the most recent AMI for Amazon Linux, which I got from my AWS web console.  I tried a different one from the unofficial list (for Cent6) but that failed the same.
[2012-08-22 20:50:55 -0400] zuhaib: is that really the standard one?
[2012-08-22 20:51:08 -0400] beandip: pushnell, you need to provide server name and node name to the knife ec2 command
[2012-08-22 20:51:21 -0400] jessicab: Pushnell: maybe the chef_server is missing from the knife.rb? pretty sure it connects to that first
[2012-08-22 20:51:33 -0400] dwhsix: *duh* I think beandip got it
[2012-08-22 20:52:58 -0400] beandip: knife ec2 server create -I ami-eccf6285 -x ec2_user -f m1.micro -S chef.pem --region 'us-east-1a' --node-name pushnellserver01
[2012-08-22 20:53:00 -0400] beandip: use that
[2012-08-22 20:53:28 -0400] Pushnell: Ok, I pasted a scrubbed version of my knife.rb: http://pastebin.com/GhpNftLR
[2012-08-22 20:53:45 -0400] beandip: Pushnell, run the command I just gave you
[2012-08-22 20:53:50 -0400] Pushnell: beandip: working on it
[2012-08-22 20:53:53 -0400] beandip: then tell me if it didn't work
[2012-08-22 20:55:54 -0400] jessicab: Pushnell: -S and the key id should actually be "chef" and you only need to use one or the other btw.. youd want to add the path to chef.pem to the ssh agent. doubt that would cause that error though
[2012-08-22 20:56:56 -0400] dwhsix: Pushnell: try running with -V or -VV
[2012-08-22 20:57:03 -0400] dwhsix: (verbose)
[2012-08-22 20:57:06 -0400] Pushnell: dwhsix: I did, it's in my pastebin
[2012-08-22 20:57:47 -0400] dwhsix: Pushnell: my bad, thx
[2012-08-22 20:57:48 -0400] Pushnell: beandip: I tried both of your suggestions.  (zuhaib was right and I had copied the wrong AMI, but I corrected it with no change)  http://pastebin.com/DW0E3RRx
[2012-08-22 20:58:01 -0400] zuhaib: Pushnell: one more thing, --region 'us-east-1a' should be --region 'us-east-1'
[2012-08-22 20:58:27 -0400] zuhaib: only in  --availability-zone do you need 1a, 1b and etc
[2012-08-22 20:58:45 -0400] zuhaib: example from Chefs docs,
[2012-08-22 20:58:45 -0400] zuhaib: knife ec2 server create -I ami-b89842d1 -x ubuntu --region 'us-west-1' -Z 'us-west-1b'
[2012-08-22 20:58:47 -0400] Pushnell: zuhaib: I think that was it  Invalid value 'm1.micro' for InstanceType. (Fog::Compute::AWS::Error)
[2012-08-22 20:59:00 -0400] Pushnell: I'll tweak the -f flag a bit and see if that works
[2012-08-22 20:59:27 -0400] dwhsix: wow, obscure error that might be worth filing a bug
[2012-08-22 20:59:49 -0400] zuhaib: yeah, in the fog code I am betting region is passed to this:  @host = options[:host] || "ec2.#{options[:region]}.amazonaws.com"
[2012-08-22 20:59:58 -0400] zuhaib: which is why it was a connection error
[2012-08-22 21:00:11 -0400] zuhaib: because it tried to us-east-1a.amazonaws.com
[2012-08-22 21:03:50 -0400] Pushnell: ok  getting closer  http://pastebin.com/YqeevV7k  My key in EC2 is named 'chef' but if I read this right it's looking for a key pair named 'chef.pem'
[2012-08-22 21:05:16 -0400] dwhsix: hmm with attributes precedence, where do attributes specified via -j on command line fall?  in relation to this table: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence ?
[2012-08-22 21:05:20 -0400] zuhaib: So you need to have a --identity-file which is where your key exist on your local box knife is running from, and then  --ssh-key which is the name of the key on AWS
[2012-08-22 21:05:40 -0400] dwhsix: sorry, duh, it's explained right on that page
[2012-08-22 21:05:49 -0400] dwhsix: "These are applied at the normal priority level."
[2012-08-22 21:08:03 -0400] Pushnell: zuhaib: http://pastebin.com/rQt9qS1C
[2012-08-22 21:10:00 -0400] zuhaib: hum so in AWS under Key Pairs you have a Key Pair Name: chef
[2012-08-22 21:10:05 -0400] Pushnell: yep
[2012-08-22 21:10:12 -0400] Pushnell: I'll paste a screenshot if you'd like :)
[2012-08-22 21:11:03 -0400] Pushnell: but here's a paste from the web console:  "Key Pair Name: chef"
[2012-08-22 21:12:11 -0400] Pushnell: the key belongs to a user 'chef' which is in my 'SuperAdmin' group which has Allow *
[2012-08-22 21:12:41 -0400] Pushnell: er, Allow * *
[2012-08-22 21:12:45 -0400] jessicab: do you still have the key id set in your knife.rb? maybe its reading it from there?
[2012-08-22 21:13:08 -0400] Pushnell: jessicab: yeah, it wasn't working that way so I started adding command line flags
[2012-08-22 21:13:43 -0400] Pushnell: jessicab: I get the same error and trace if I omit all identity/key flags
[2012-08-22 21:14:07 -0400] zuhaib: yeah clean up your knife.rb i just saw it
[2012-08-22 21:14:14 -0400] zuhaib: remove the knife[:aws_ssh_key_id]  =       "chef.pem"
[2012-08-22 21:15:25 -0400] Pushnell: d'oh.  that was it.  I assumed that the command line overrode the config file.
[2012-08-22 21:15:35 -0400] Pushnell: I just changed it to ="chef"
[2012-08-22 21:16:05 -0400] Pushnell: wow  sigh of relief.
[2012-08-22 21:16:09 -0400] Pushnell: thanks everyone.
[2012-08-22 21:17:08 -0400] Pushnell: heh, ok  I did knife ec2 server create -I ami-aecd60c7 -x ec2_user -f t1.micro --region 'us-east-1' --node-name cheftest01 -V -V
[2012-08-22 21:17:20 -0400] Pushnell: and it created the server and is asking me for the passphrase to the wrong identity
[2012-08-22 21:17:26 -0400] Pushnell: is there any way I can switch it at this point?
[2012-08-22 21:18:11 -0400] miah: try, knife ec2 server --help
[2012-08-22 21:18:19 -0400] jessicab: hm.. if youre asked for a password that means it didnt like your key, did you add it to ssh agent with ssh add? either that or specify it with -i
[2012-08-22 21:18:24 -0400] Pushnell: (or what is the right way to bail out & try again without hosing things?)
[2012-08-22 21:19:32 -0400] jessicab: not sure you can fix it at this point, id just do a knife ec2 server delete cheftest01 and try again with -i or after adding the pem to the ssh agent
[2012-08-22 21:20:37 -0400] Pushnell: alright, thanks again
[2012-08-22 22:00:13 -0400] jan0232: I'm using chef to install postgresql. the database should be used for multiple little apps how would you suggest dealing with access to the database?? create a separate user for each app?? or create an "app" user that is shared between all apps??
[2012-08-22 22:01:03 -0400] ashb: (the fact you are using chef is incidental, but) I'd create one user per app
[2012-08-22 22:03:13 -0400] jan0232: i should probably also limit access further and only allow certain hosts (the app servers) i could use chef to query all hosts ups with the "app" role and then setup the postgres config accordingly
[2012-08-22 22:03:20 -0400] jan0232: hosts ips
[2012-08-22 22:04:40 -0400] jan0232: ashb: would you agree?
[2012-08-22 22:11:02 -0400] jameson_: ohai
[2012-08-22 22:11:25 -0400] jameson_: anyone here using supervisord?
[2012-08-22 22:11:32 -0400] unixguy: any glaring reason why a client would not execute the run list for an environment when the environment is being specified on the run?
[2012-08-22 22:12:32 -0400] jameson_: unixguy: you defining it using -E ?
[2012-08-22 22:13:14 -0400] unixguy: tried that and also tried placing it in the client.rb file
[2012-08-22 22:13:37 -0400] jessicab: unixguy: an environment cant have a run list.. do you mean roles perhaps or the versions of the cookbooks being used?
[2012-08-22 22:14:41 -0400] unixguy: it's in the role
[2012-08-22 22:16:29 -0400] jessicab: unixguy: did you add the role to the run list for the node with knife?
[2012-08-22 22:17:18 -0400] unixguy: via json file ... in env_run_lists
[2012-08-22 22:31:32 -0400] dwhsix: java cookbook on ubuntu precise seems to not be creating the /usr/lib/jvm/default-java symlink...
[2012-08-22 22:31:36 -0400] dwhsix: anyone else run into this?
[2012-08-22 22:33:47 -0400] dwhsix: there do seem to be various forks on github where people have had to maybe muck with this...
[2012-08-22 22:36:23 -0400] jameson_: dwhsix: uh for precise, I remember there was a version number bug
[2012-08-22 22:36:44 -0400] dwhsix: jameson_: yeah, actually I think yuo and I talked about that
[2012-08-22 22:36:51 -0400] jameson_: "6" vs 6
[2012-08-22 22:37:11 -0400] jameson_: I should submit that patch I have somewhere here.
[2012-08-22 22:37:25 -0400] dwhsix: I must have something more basic borked, though I don't have /usr/lib/jvm/default-java symlink and none of the update-java-alternatives commands I've been trying seem to fix it
[2012-08-22 22:38:12 -0400] dwhsix: that's what java_home is in node attributes, but because it doesn't exist, well things are not working well
[2012-08-22 22:40:19 -0400] jameson_: yes
[2012-08-22 22:40:27 -0400] jameson_: and there was a change in $arch handling if i recall correctly.
[2012-08-22 22:40:46 -0400] jameson_: at worst you can do apt-get install default-java :3?
[2012-08-22 22:41:55 -0400] dwhsix: jameson_: E: Unable to locate package default-java
[2012-08-22 22:42:12 -0400] jameson_: @_@!
[2012-08-22 22:42:35 -0400] jameson_: oh it
[2012-08-22 22:42:39 -0400] jameson_: it's default-jdk
[2012-08-22 22:42:41 -0400] jameson_: default-jre i think
[2012-08-22 22:43:00 -0400] jameson_: yeah default-jre or default-jdk
[2012-08-22 22:43:18 -0400] dwhsix: jameson_: woohoo need to buy you a beer
[2012-08-22 22:43:52 -0400] dwhsix: ok, let me find a good place to stick that
[2012-08-22 23:02:44 -0400] Guest94181: How can I use the python cookbook to install all the depencies from requirements.txt? i was thinking i had to write a new resource that reads each line ....
[2012-08-22 23:19:20 -0400] jameson_: nope
[2012-08-22 23:19:40 -0400] jameson_: Guest94181: you can use the "option" parameter to say "-r"
[2012-08-22 23:19:48 -0400] jameson_: and then you can pass in the requirement.txt as the package name
[2012-08-22 23:19:53 -0400] jameson_: to python-pip
[2012-08-22 23:20:36 -0400] jameson_: Guest94181: https://github.com/opscode-cookbooks/python#attribute-parameters
[2012-08-22 23:21:29 -0400] Guest94181: jameson_: ahh package name = req file name. does it need to be full path right?
[2012-08-22 23:21:42 -0400] jameson_: yep
[2012-08-22 23:21:57 -0400] Guest94181: jameson_: thanks i will try that. i was about to write my own ruby code lol
[2012-08-22 23:23:55 -0400] jameson_: i almost did the same thing :)
