[2012-08-02 00:18:07 -0400] jtimberman: flaccid: re: librarian, yes, it's quite nice :)
[2012-08-02 00:18:52 -0400] flaccid: jtimberman: i'm using it with these https://github.com/rightscale-blueprints/ which basically bundle the required cookbooks
[2012-08-02 00:26:33 -0400] Jay_Levitt: whoooah... just tried to use a ruby 1.9 hash syntax in a recipe and got "odd number list for Hash". Using 1.9 on both the node and my workstation.. https://gist.github.com/70a26b7c2400d459ca10
[2012-08-02 00:30:18 -0400] randomautomator: hey guys i had a question about managing your cookbooks with a central git server. how do you guys go about doing that workflow wise?
[2012-08-02 00:30:48 -0400] randomautomator: do you have git manage the actual cookbook repo on the server or do you push form local git to an external git server then the external git server pushes to chef-server?
[2012-08-02 00:47:50 -0400] cparedes: hey, had a quick question (been a while since i've used chef) - if say i have a symlink at /etc/motd, does defining cookbook_file (or 'file') on /etc/motd overwrite the contents of what's linked, or does it break the link and write a regular file?
[2012-08-02 00:48:09 -0400] cparedes: (as much as i like ubuntu, i want to stab the dynamic motd through the heart)
[2012-08-02 00:49:30 -0400] randomautomator: mine overwrites to a file
[2012-08-02 00:50:12 -0400] flaccid: randomautomator: i use librarian
[2012-08-02 00:50:25 -0400] cparedes: randomautomator: as in, it breaks the link and creates a new file in its place?
[2012-08-02 00:50:31 -0400] cparedes: or overwrites the contents of what's linked?
[2012-08-02 00:50:39 -0400] randomautomator: yeah mine broke the link and put a file there
[2012-08-02 00:50:43 -0400] flaccid: cparedes: you only want one resource managing the file/symlink
[2012-08-02 00:50:49 -0400] cparedes: ahh, awesome. thanks!
[2012-08-02 00:51:02 -0400] cparedes: flaccid: agreed. which is why i'm defining the one and only /etc/motd to break the ubuntu dynamic motd craziness :p
[2012-08-02 00:51:07 -0400] randomautomator: i use template tho, but it should do the same thing as cookbook_file
[2012-08-02 00:51:26 -0400] flaccid: cool
[2012-08-02 00:51:45 -0400] randomautomator: flaccid: do you have a link for librarian?
[2012-08-02 00:52:17 -0400] yfeldblum: randomautomator, https://github.com/applicationsonline/librarian
[2012-08-02 00:52:20 -0400] flaccid: you likely want template so you can do dynamics too
[2012-08-02 00:52:39 -0400] randomautomator: danke
[2012-08-02 00:58:34 -0400] rayrod2030: anybody have any luck installing berkshelf on osx?
[2012-08-02 01:17:59 -0400] req: Does chef do provision?
[2012-08-02 01:18:26 -0400] req: like when i update my master repo each week, i want to roll out the new features through chef.
[2012-08-02 01:21:14 -0400] Jay_Levitt: req: there's a chef-deploy script, but I get the impression that app deployment isn't chef's sweet spot - it's more for OS
[2012-08-02 01:21:24 -0400] flaccid: req: yes usually via application cookbook
[2012-08-02 01:21:43 -0400] flaccid: which does the deploy routine
[2012-08-02 01:24:21 -0400] req: flaccid: thanks. the django part is cool. but i also use other python framework. i just i have to extend that.
[2012-08-02 01:24:39 -0400] req: Jay_Levitt: i will take a look at that.
[2012-08-02 01:27:22 -0400] flaccid: req: working on that myself, just yet to revisit and finish: https://github.com/rightscale-blueprints/django_app_server
[2012-08-02 01:27:39 -0400] cwebber: anyone know where the image/press resources for chef are? just need a logo
[2012-08-02 01:29:28 -0400] req: flaccid: u use librian to update official cookbooks as you are extending them
[2012-08-02 01:29:49 -0400] flaccid: i use it to pull upstream cookbooks for deployment
[2012-08-02 01:30:07 -0400] flaccid: i.e. update/fix etc. upstream then librarian update
[2012-08-02 01:30:31 -0400] flaccid: see the Cheffile* files
[2012-08-02 01:31:07 -0400] Jay_Levitt: is it common to get "server returned error" from Hosted Chef?  I've seen it happen twice this evening.
[2012-08-02 01:33:02 -0400] req:  i actually not too sure how to extend a cookbook. the wiki said create site-cookbooks and it doesn't say anything else as the rest of the wiki is very vague about extending a cookbook
[2012-08-02 01:35:46 -0400] flaccid: probably because you don't extend cookboooks. you include them or depend on them for resources
[2012-08-02 01:38:45 -0400] jessicab: cwebber: i dont know if theres an official place, but if all you need is a logo you can just grab them off the attachments on wiki pages. for instance - http://wiki.opscode.com/download/attachments/688131/OC_Chef_Logo.png
[2012-08-02 01:39:05 -0400] cwebber: jessicab: thanks
[2012-08-02 01:39:11 -0400] req: flaccid: and the only thing i can do is reset the attributes in the role.rb file?   for example, i have ntp cookbook, and in role i might set the default[:servers] to a my own list of servers
[2012-08-02 01:40:04 -0400] jessicab: Jay_Levitt: you might see it retry a bit, especially at the top of the hour and half hour, but it shouldnt time out completely
[2012-08-02 01:40:17 -0400] flaccid: req: read up on attributes on the wiki and how you set them on the node
[2012-08-02 01:40:27 -0400] Jay_Levitt: jessicab: nope, never fails completely, the retry is just a little unnerving :)
[2012-08-02 01:43:46 -0400] jessicab: Jay_Levitt: yea, it shouldnt really effect anything but if you see it mostly at the hour and half hour, you can try adding a splay to reduce how often it happens a bit too
[2012-08-02 01:44:02 -0400] req: flaccid: thanks. but it's more for wirting your own cookbooks, or how to give values per role / envrionment.
[2012-08-02 01:44:03 -0400] Jay_Levitt: jessicab: oh, this is during manual runs as I'm developing recipes
[2012-08-02 01:44:14 -0400] Jay_Levitt: jessicab: so sometimes I happen to hit the 30/60 mark
[2012-08-02 01:44:46 -0400] jessicab: Jay_Levitt: ah yea, it can be unavoidable
[2012-08-02 01:44:48 -0400] req: flaccid: but what if you need new defintiions? more attributes, or whatever, new files. won't that mean new cookbook entirely?
[2012-08-02 01:45:09 -0400] flaccid: req: contribute
[2012-08-02 01:45:23 -0400] flaccid: you can of course fork, but its nice to pull request changes back
[2012-08-02 01:45:42 -0400] flaccid: and you can of course write cookbooks to compliment the existing
[2012-08-02 02:28:50 -0400] mjreed: OK, so knife plugin definition magic interferes with inheritance; if I do  class MyNiftyPlugin < Chef::Knife::ExistingPlugin, "knife my nifty plugin" doesn't inherit the options, banner, etc. defined for"knife existing plugin".  How can I get those?
[2012-08-02 02:32:20 -0400] mjreed: :q
[2012-08-02 02:32:56 -0400] mjreed: hm, this seems to work: banner Super::Class.banner; Super::Class.options.each do |k,v| option k,v end
[2012-08-02 02:54:04 -0400] flaccid: trying to find that block of code for a recipe to check if its in chef solo or not
[2012-08-02 02:55:52 -0400] hoover_damm: if config[:solo]
[2012-08-02 02:55:53 -0400] flaccid: ah in databags doc
[2012-08-02 02:55:56 -0400] hoover_damm: log "i am solo"
[2012-08-02 02:55:57 -0400] hoover_damm: else
[2012-08-02 02:55:59 -0400] hoover_damm: "i am not"
[2012-08-02 02:56:00 -0400] hoover_damm: end
[2012-08-02 02:56:10 -0400] hoover_damm: or something like that
[2012-08-02 02:56:53 -0400] flaccid: danke!
[2012-08-02 02:57:38 -0400] sascha_d: you can also dig around for any recipe executing the node.save action. Because it will usually check to see if it's solo before doing that.
[2012-08-02 02:58:49 -0400] flaccid: ah coolio
[2012-08-02 02:59:03 -0400] flaccid: i think if node['collectd']['servers'] or config[:solo] might be graceful enough
[2012-08-02 03:00:05 -0400] hoover_damm: if Chef::Config[:solo]
[2012-08-02 03:00:11 -0400] hoover_damm: exact
[2012-08-02 03:00:29 -0400] flaccid: k thanks
[2012-08-02 03:06:36 -0400] atomic-penguin: foodcritic documentation has an example block for node.save
[2012-08-02 03:13:38 -0400] atomic-penguin: foodcritic?
[2012-08-02 03:13:39 -0400] bawt: foodcritic is a lint checking tool for cookbooks, available as a RubyGem: http://rubygems.org/gems/foodcritic
[2012-08-02 03:15:43 -0400] tolland: it looks like "knife search" is highly orientated towards returning lists of nodes, rather than lists of attribute values
[2012-08-02 03:15:53 -0400] tolland: is there some alternative tool that I should look at?
[2012-08-02 03:16:50 -0400] tolland: I'm looking to get an aggregated sum of the kb_available attribute, im guess thats something I could use mcollective for, but im not familiar with that yet
[2012-08-02 03:18:18 -0400] yfeldblum: tolland, if you're looking for information stored in the chef-server (which all node attributes on all nodes are), then `knife search` is a good tool
[2012-08-02 03:19:30 -0400] yfeldblum: tolland, you can also use the `Chef::Search::Query` class, or you can send HTTP messages directly to https://your-chef-server.example.com/search/node
[2012-08-02 03:19:46 -0400] tolland: yfeldblum: i presume the ohai attributes are not persisted?
[2012-08-02 03:20:21 -0400] tolland: i mean with historical vlaues
[2012-08-02 03:21:15 -0400] yfeldblum: tolland, not historical values, no; on every successful chef-client run, at the end of the run, chef-client will save the node data to the server (including ohai data, defaults set in cookbooks, defaults & overrides set in roles & environments, etc)
[2012-08-02 03:23:21 -0400] tolland: sure so I can query directly, but in terms of something similar to a SQL query to return a list of attribute values, thats not something I can do with knife vanilla?
[2012-08-02 04:20:46 -0400] kass: I m using nginx cookbook. but i have a custom nginx.conf and i also have a custom site-enabled/app.conf files.
[2012-08-02 04:21:44 -0400] kass: first, do i put them inside files directory? and secondly, how can i specify them? the default in recipes/commons.rb said uses source "nginx.conf.erb"
[2012-08-02 04:30:37 -0400] PRK_nz: I guidance to help me get started spinning up new nodes on a Citrix Xen (free) cluster using Chef (knife?), can anyone point me in the right direction please?
[2012-08-02 05:14:15 -0400] tigris: howdy peeps... firstly, chef's nginx cookbook, the http_geopip_module recipe requires libtool package to be installed on debian, i installed this manually but assume that is simple fix for someone
[2012-08-02 05:14:59 -0400] tigris: secondly, that only got me a little further into the compilation, it then dies with:
[2012-08-02 05:15:03 -0400] tigris: STDERR: mv: cannot stat `.deps/GeoIP.Tpo': No such file or directory
[2012-08-02 05:15:13 -0400] tigris: not sure how to fix that one :(
[2012-08-02 06:31:01 -0400] tigris: who can tell me about the remote_file provider? i'm using a checksum and it matches, but remote_file is still attempting head requests or something to the file in question
[2012-08-02 06:32:05 -0400] tigris: the service i grab the file from have a limit of 5 requests per day, so chef starts dying cos it perform the remote_file even though the checksums match :(
[2012-08-02 06:39:09 -0400] ssd7: tigris: If you run with debug logging on do you definitely get a message saying that the checksums match?
[2012-08-02 06:39:51 -0400] tigris: no because it does not get into the block that checks checksums... but i could see the checksums were matching earlier today before the site blocked me
[2012-08-02 06:40:18 -0400] tigris:          Chef::REST.new(@new_resource.source, nil, nil, http_client_opts).fetch(@new_resource.source) do |raw_file|
[2012-08-02 06:40:20 -0400] tigris: if matches_current_checksum?(raw_file)
[2012-08-02 06:40:41 -0400] tigris: is the 2 lines of code, i.e. it opens that fetch block before checking
[2012-08-02 06:42:59 -0400] ssd7: tigris: what version of Chef are you on?
[2012-08-02 06:43:17 -0400] ssd7: (just want to make sure I'm looking at the same code)
[2012-08-02 06:43:52 -0400] tigris: ssd7: 10.12.0
[2012-08-02 06:44:10 -0400] tigris: ssd7: lib/chef/provider/remote_file.rb
[2012-08-02 06:45:25 -0400] ssd7: Right, yeah, so you only get to that block though if you get past: if current_resource_matches_target_checksum?
[2012-08-02 06:45:48 -0400] ssd7: So if you are downloading this to a permenant location, you could use the 'checksum' attribute to ensure we don't make an http call again
[2012-08-02 06:46:14 -0400] tigris: yep... i assumed that method was checking the checksum of the remote_file code block in the recipe... i.e. if you change the block in any way (change url or something) then it will continue on
[2012-08-02 06:46:35 -0400] tigris: i could be wrong though
[2012-08-02 06:47:13 -0400] tigris: when i debugged out that particular method manually here is what i got: https://gist.github.com/6a4a947dc9213cdd5b51
[2012-08-02 06:47:45 -0400] tigris: ssd7: the weird part there to me is that none of the checksums in that debug match the one I am expecting
[2012-08-02 06:48:49 -0400] tigris: ssd7: the checksum i am passing in for that above piece of code was "53105bbe3ac9319db54d9eb46119695b"
[2012-08-02 06:50:05 -0400] ssd7: So the checksum you should be passing to the checksum attribute is the sha256 of the file
[2012-08-02 06:51:28 -0400] tigris: i see... i copied the ones from the opscode nginx/geoip recipe and assumed on the size of them that they were md5
[2012-08-02 06:56:39 -0400] ssd7: Yeah, easy mistake to make
[2012-08-02 06:59:00 -0400] tigris: ssd7: i suspect the nginx/geoip stuff has a bug then, i will test it out with proper checksums
[2012-08-02 07:08:17 -0400] tigris: ssd7: I changed the checksum in my recipe to match, but alas, it still downloads the file every time... see gist: https://gist.github.com/6a4a947dc9213cdd5b51
[2012-08-02 07:08:46 -0400] tigris: notice the "new_resource.checksum" is again not equal to the one I am using... i've no idea where it gets 98e4... from
[2012-08-02 07:15:09 -0400] ssd7: Out of curiosity, how did you take the checksum?
[2012-08-02 07:15:23 -0400] ssd7: Did you download it to your local workstation, or take a checksum of the one that chef downloaded?
[2012-08-02 07:16:55 -0400] ssd7: You said you're on 10.12 which should have the fix for the bug I'm thinking of, but that is strange
[2012-08-02 07:19:41 -0400] tigris: hmm, that is the one chef downloaded, i shall check real one now
[2012-08-02 07:20:17 -0400] ssd7: can you add the recipe block to the gist?
[2012-08-02 07:20:54 -0400] ssd7: > shasum -a 256 nginx-1.2.2.tar.gz
[2012-08-02 07:20:55 -0400] ssd7: 409477c7a9fba58c110a176fd7965b9db188bcf8be0e7f8a0731b8ae1e6ee880  nginx-1.2.2.tar.gz
[2012-08-02 07:21:30 -0400] tigris: yep, i get the same
[2012-08-02 07:22:01 -0400] tigris: yet chef downloads it anyway, as you can tell per the "Sending HTTP Request via GET" in the gist
[2012-08-02 07:24:05 -0400] ssd7: And you are passing that same checksum to the resource in your recipe?
[2012-08-02 07:24:48 -0400] tigris: ssd7: gist updated, it is the stock nginx::source recipe off opscode with 1 minor change of adding the checksum which you see there in my gist
[2012-08-02 07:25:12 -0400] tigris: since current version on opscode site does not have this checksum support
[2012-08-02 07:26:44 -0400] tigris: oh, i see the problem
[2012-08-02 07:27:24 -0400] ssd7: Looks like you might be referencing the wrong attribute
[2012-08-02 07:27:38 -0400] tigris: nginx['source']['checksum'] vs nginx['checksum']... my bad
[2012-08-02 07:27:55 -0400] tigris: thank you ssd7, i do apologise for wasting your time
[2012-08-02 07:28:34 -0400] ssd7: np,  glad you've got it sorted out :)
[2012-08-02 08:29:08 -0400] jondot: hi guys. i have two cookbooks named 'mongodb' in my chef server. each very different from the other (coming from 2 vendors)
[2012-08-02 08:29:32 -0400] jondot: and to each i have 2 cookbooks referencing them
[2012-08-02 08:30:15 -0400] jondot: what happens in practice is that the node selects the 'mongodb' cookbook with the higher version for both, which creates an error for one of the cookbooks (since it expects a different mongodb cookbook)
[2012-08-02 08:30:23 -0400] jondot: how can this be resolved?
[2012-08-02 08:41:31 -0400] ssd7: jondot: I am assuming that the two different mongodb cookbooks have different versions
[2012-08-02 08:41:39 -0400] jondot: yes
[2012-08-02 08:41:47 -0400] jondot: if they had exact same versions i'd be in big trouble
[2012-08-02 08:42:06 -0400] ssd7: You should be able to add a dependency in the other cookbooks to constrain them to a specific version
[2012-08-02 08:42:54 -0400] jondot: yea but neither of those are mine
[2012-08-02 08:43:34 -0400] ssd7: I'm a bit confused.  So you don't control the cookbooks that depend on the mongodb cookbooks?
[2012-08-02 08:50:12 -0400] ssd7: jondot: Apologies a bit late by me, I'm probably just misunderstanding.  But if you can't rename one of the mongo cookbooks, your best bet after that is setting specific version constraints
[2012-08-02 08:52:39 -0400] jondot: yep
[2012-08-02 08:52:43 -0400] jondot: ill go for rename thanks
[2012-08-02 08:52:56 -0400] biffhero: where do I get validation.pem from the first time?
[2012-08-02 08:55:32 -0400] workmad3: biffhero: from the chef server
[2012-08-02 08:56:41 -0400] biffhero: workmad3: I agree.  But I am doing the omnibus install from http://wiki.opscode.com/display/chef/Omnibus+Workstation+Setup+for+Linux+and+Mac and they say to get it from the chef server.  Do I just jump on to doing a server install and then come back to here?
[2012-08-02 08:57:09 -0400] biffhero: this http://blog.afistfulofservers.net/cfchefipuppetengine-setup/ says I do workstation first, and then server.  Is that incorrect?
[2012-08-02 08:58:12 -0400] ssd7: biffhero: Depending on your goal, you might find it easier to sign up for a free Hosted Chef account while learning.  Then you can put off setting up a server until you've learned a bit of Chef.
[2012-08-02 08:59:31 -0400] biffhero: yeah, I keep seeing that.  I was hoping the left hand column of http://wiki.opscode.com/display/chef/Installation would step me through it.  But on that page, it looks like the steps are 1: server 2: workstation.
[2012-08-02 09:01:12 -0400] pluesch0r: hi everybody. i just upgraded my chef server from ubuntu lucid to ubuntu precise and suddenly all clients are getting a 'failed to authenticate'
[2012-08-02 09:01:27 -0400] ssd7: biffhero: I believe there are analogous directions for hosted chef on that page
[2012-08-02 09:01:30 -0400] pluesch0r: what am i doing wrong or where can i check what's going on?
[2012-08-02 09:02:23 -0400] biffhero: ssd7, thanks.  I will try it out.
[2012-08-02 09:04:21 -0400] marcinkuzminski: Hi, i need to fix one receipt and really don't know chef or ruby, can someone help me with changing the max_connection_error value in mysql ?
[2012-08-02 09:06:11 -0400] pluesch0r: i'm not even able to start the chef-server-webui; executing /usr/sbin/chef-server-webui i also keep getting a 401 "Unauthorized"
[2012-08-02 09:08:59 -0400] ssd7: pluesch0r: Hrmm. Did you also upgrade your chef server or just the underlying operating system?
[2012-08-02 09:09:29 -0400] ssd7: marcinkuzminski: Are you using the mysql cookbook?
[2012-08-02 09:09:50 -0400] pluesch0r: ssd7: just the underlying operating system. i already used the chef 10.12.0-1 opscode packages on lucid.
[2012-08-02 09:10:22 -0400] pluesch0r: to be super-sure, i apt-get --reinstall'ed the chef packages after upgrading (after i detected that it's failing, mind you)
[2012-08-02 09:13:11 -0400] pluesch0r: ssd7: any idea? my whole infrastructure is dead in the water. :(
[2012-08-02 09:13:59 -0400] ssd7: pluesch0r: Hrmm. I'd start with the server side logs see if they tell you what is failing in the auth.  There are a few reasons you can get 401d
[2012-08-02 09:16:00 -0400] pluesch0r: ssd7: https://gist.github.com/3235717
[2012-08-02 09:18:22 -0400] Mithrandir: pluesch0r: try stopping couchdb, back up /var/lib/couchdb,then cp /var/lib/couchdb/0.10.0 /var/lib/couchdb/1.0.1 and restart couch
[2012-08-02 09:18:25 -0400] Mithrandir: and see if that fixes it
[2012-08-02 09:21:47 -0400] ssd7: Certainly a possibility
[2012-08-02 09:21:56 -0400] pluesch0r: k, gonna give that a try :)
[2012-08-02 09:26:04 -0400] Mithrandir: you might need to dump it out on a lucid box and then restore on precise, I don't remember exactly what I did when I upgraded
[2012-08-02 09:26:11 -0400] Mithrandir: but I remember running into the same problem.
[2012-08-02 09:27:19 -0400] pluesch0r: Mithrandir: ah, great.
[2012-08-02 09:27:27 -0400] pluesch0r: how can i test if couchdb works?
[2012-08-02 09:27:33 -0400] pluesch0r: any GET request i can do or something?
[2012-08-02 09:27:41 -0400] Mithrandir: poke at the web ui?
[2012-08-02 09:28:28 -0400] ssd7: curl http://localhost:5984/che
[2012-08-02 09:28:32 -0400] ssd7: curl http://localhost:5984/chef
[2012-08-02 09:28:55 -0400] pluesch0r: gives {"db_name":"chef","doc_count":2241,"doc_del_count":39,"update_seq":3391877,"purge_seq":0,"compact_running":false,"disk_size":16150626,"instance_start_time":"1343899722661838","disk_format_version":4,"committed_update_seq":3391877} - so that should work.
[2012-08-02 09:32:04 -0400] pluesch0r: hmm .. my couchdb log is full of errors like that: "[Thu, 02 Aug 2012 09:30:25 GMT] [info] [<0.434.0>] OS Process #Port<0.1974> Log :: function raised exception (new TypeError("doc.attributes is undefined", "", 3)) with doc._id node_324062_local"
[2012-08-02 09:32:16 -0400] pluesch0r: does that mean that the upgrade didn't work? this is when compacting nodes and so on
[2012-08-02 09:33:38 -0400] Mithrandir: does it error if you rerun the compaction too?
[2012-08-02 09:36:20 -0400] pluesch0r: Mithrandir: when doing a "curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact/nodes" i get "{"ok":true}" on the commandline and the couchdb log contains an entry like "[Thu, 02 Aug 2012 09:30:26 GMT] [info] [<0.434.0>] OS Process #Port<0.1974> Log :: function raised exception (new TypeError("doc.attributes is undefined", "", 3)) with doc._id 6fb26392-011a-4547-aae9-612d89107a39"
[2012-08-02 09:37:29 -0400] pluesch0r: ah .. now (after executing it thrice) it seems to work.
[2012-08-02 09:39:15 -0400] pluesch0r: hm. that /var/lib/couchdb/1.0.1/ directory contains a hidden subdirectory called .chef_design with a whopping size of 8.3G
[2012-08-02 09:39:19 -0400] pluesch0r: Mithrandir: any idea what that is?
[2012-08-02 09:39:43 -0400] ssd7: those are the views
[2012-08-02 09:41:06 -0400] ssd7: I'd move those over too if you can, to avoid some pain
[2012-08-02 09:41:27 -0400] pluesch0r: ssd7: over to where?
[2012-08-02 09:41:45 -0400] ssd7: ahh, sorry, misread
[2012-08-02 09:41:52 -0400] pluesch0r: i've already copied the 0.10.0 database to 1.0.1 :)
[2012-08-02 09:42:18 -0400] ssd7: yeah :)  I think you should be good to go
[2012-08-02 09:45:00 -0400] pluesch0r: jup. seems to work.
[2012-08-02 09:45:27 -0400] ssd7: Nice call on the couch upgrade Mithrandir
[2012-08-02 09:46:40 -0400] pluesch0r: mh. too soon, apparently.
[2012-08-02 09:46:41 -0400] pluesch0r: [Thu, 02 Aug 2012 11:45:43 +0200] ERROR: Server returned error for http://mgmt.local:4000/nodes/mgmt.local, retrying 3/5 in 14s
[2012-08-02 09:48:06 -0400] pluesch0r: the client run starts but then produces those errors.
[2012-08-02 09:48:26 -0400] ssd7: Server-side log should have more info about that 500
[2012-08-02 09:49:13 -0400] pluesch0r: /usr/lib/ruby/1.8/bunny/client08.rb:397:in `start'
[2012-08-02 09:49:14 -0400] pluesch0r: /usr/lib/ruby/1.8/bunny
[2012-08-02 09:49:19 -0400] pluesch0r: whoops. sorry for the multiline.
[2012-08-02 09:49:28 -0400] pluesch0r: guess that's a rabbitmq burp.
[2012-08-02 09:51:09 -0400] pluesch0r: "AMQPLAIN login refused: user 'chef' - invalid credentials",
[2012-08-02 09:51:10 -0400] pluesch0r: aww man.
[2012-08-02 09:53:33 -0400] pluesch0r: rabbitmq is missing the vhost configuration.
[2012-08-02 09:53:47 -0400] pluesch0r: talking about a bumpy upgrade ride ...
[2012-08-02 09:55:03 -0400] ssd7: pluesch0r: I have to split, but you should be able to use rabbitmqctl to fix that up the vhosts and user credentials.
[2012-08-02 09:57:57 -0400] pluesch0r: ssd7: thanks for listening!
[2012-08-02 09:58:02 -0400] huhongbo: when i upgrade chef 10.10 to 10.12 the custom ohai plugin doesnt work
[2012-08-02 09:58:28 -0400] pluesch0r: ssd7: it's working now ..
[2012-08-02 09:58:31 -0400] huhongbo: when i place the custom plugin to ohai dir ,it work fine
[2012-08-02 09:58:45 -0400] pluesch0r: i followed the instructions on http://tickets.opscode.com/browse/CHEF-3170, for future reference.
[2012-08-02 10:02:08 -0400] pluesch0r: Mithrandir, ssd7: thanks!
[2012-08-02 10:15:36 -0400] mrtazz: hey, is it possible with knife search to get multiple attributes (like -a but for more than one)?
[2012-08-02 10:16:00 -0400] mrtazz: and not all of them obviously
[2012-08-02 10:35:26 -0400] storm|out: question. im looking to use the nginx cookbook. how would i include a file that would go in /etc/nginx/sites-enabled/ ?
[2012-08-02 11:00:03 -0400] stormerider: also, anyone ever seen this error trying to bootstrap a chef client? "FATAL: Unknown error processing config file  with error undefined method `ConfigurationError' for Chef::Exceptions:Class
[2012-08-02 11:01:20 -0400] stormerider: ah, nevermind, that one was a missing /var/log/chef directory. fixed.
[2012-08-02 11:57:54 -0400] tigris: storm|out: checkout the nginx recipe and look at the nginx_site method in the definitions folder
[2012-08-02 11:58:44 -0400] tigris: it creates the symlink from nginx/sites-available to nginx/sites-enabled... however creating the file for your site in nginx/sites-available is up to you, i suggest using the template resource
[2012-08-02 12:00:28 -0400] masterkorp: Any documentation or sugestions on how to manage chained dependencies?
[2012-08-02 12:30:54 -0400] storm|out: tigris: thanks. so i would create a template, and then use the nginx recipe to instantiate the template into the node, and enable it using the site method?
[2012-08-02 12:31:42 -0400] stormerider: i knew i got waaaay too comfortable with Puppet's file resource...
[2012-08-02 12:44:25 -0400] tigris: stormerider: you can either use template or cookbook_file to put your site config into sites-available, you use template if you have stuff in there relying on the node json
[2012-08-02 12:44:39 -0400] tigris: then it would simply be "nginx_site 'mysite'" to enable it
[2012-08-02 12:46:05 -0400] rgsteele: Hm... can attributes be declared in recipes, or are they limited to attribute files?
[2012-08-02 12:46:06 -0400] rgsteele: (and roles/nodes)
[2012-08-02 12:46:37 -0400] rgsteele: Ah, yes, you just have to use 'node' instead of 'default'
[2012-08-02 12:55:06 -0400] rgsteele: Hm, any takers on this: http://pastie.org/4377480
[2012-08-02 12:55:31 -0400] rgsteele: I don't understand what's syntactically incorrect about line 58 of that recipe
[2012-08-02 12:57:25 -0400] rgsteele: Oh... Does the parent have to be declared in your attributes files before you can set it with 'node' in the recipe?
[2012-08-02 12:58:29 -0400] rgsteele: IOW, if the attributes file sets default[:foo], setting node[:foo][:bar][:baz] in your recipe would generate that error?
[2012-08-02 13:04:45 -0400] yfeldblum: rgsteele, `node.default["asdf"]["xyz"] = 5`
[2012-08-02 13:05:31 -0400] yfeldblum: rgsteele, you should typically not use `node[:foo][:bar][:baz] = 5` in  a recipe because that sets the attribute at the normal level; you should typically set attributes at the default level unless there's a specific reason why not
[2012-08-02 13:16:11 -0400] stormerider: tigris: sorry for slow response, was working on a blog post about something else. cookbook_file would be the equivalent of a standard file resource in puppet, correct? for files to just be pulled down as-is, no templating necessary?
[2012-08-02 13:17:32 -0400] rgsteele: yfeldblum: Many thanks.
[2012-08-02 13:17:44 -0400] rgsteele: And, advice duly noted.
[2012-08-02 13:22:35 -0400] tigris: stormerider: i've not used puppet, but yes, cookbook_file just puts the file in place as-is, no interpolation done
[2012-08-02 13:24:27 -0400] tigris: rgsteele: i *think* the rule of thumb is don't use node[:foo] = 'bar' on a node variable you haven't pre-defined a default for in an attributes file
[2012-08-02 13:25:04 -0400] tigris: or as yfeldblum pointed out, you really should avoid setting node values at all in your recipe, since it doesn't give nodes/roles a chance to override them
[2012-08-02 13:26:59 -0400] stormerider: so then i could write a recipe like mycustom.rb which would have "include nginx::default", "cookbook_file [block]", correct?
[2012-08-02 13:27:07 -0400] yfeldblum: tigris, perfectly fine to set node attributes in recipes; it's just that you should typically set node attributes at the default level, unless there's a compelling reason to set it at another level, in recipes
[2012-08-02 13:30:25 -0400] tigris: stormerider: correct, but you will also need the file somewhere in files/
[2012-08-02 13:30:54 -0400] stormerider: *nod* just needed to check the recipe side of things.
[2012-08-02 13:30:58 -0400] tigris: yfeldblum: ahh i see, i think i would drive myself insane if i did that, trying to track down where i was defaulting variables if i ever needed to change it
[2012-08-02 13:31:08 -0400] stormerider: thanks for the help tigris
[2012-08-02 13:31:51 -0400] tigris: stormerider: plonk your file in files/default/foo.conf then use http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile to put it somewhere on the server
[2012-08-02 13:32:55 -0400] yfeldblum: tigris, sometimes you need to, especially to set defaults that have to be computed from other values
[2012-08-02 14:05:12 -0400] Jay_Levitt: Today's topic: Wikis that do not suck.  Do they exist?
[2012-08-02 14:05:20 -0400] Bittarman: no.
[2012-08-02 14:05:25 -0400] Bittarman: simple :)
[2012-08-02 14:05:45 -0400] Jay_Levitt: I have a simple proof that they CANNOT exist, but it is too small to fit in the margins of this channel
[2012-08-02 14:06:22 -0400] cheeseplus: I have tried them all, each presents it's own special brand of horror
[2012-08-02 14:06:36 -0400] benjaminws: Come *on*, you don't like confluence?
[2012-08-02 14:06:36 -0400] cheeseplus: wikis are great on paper and in theory
[2012-08-02 14:06:39 -0400] Jay_Levitt: we're currently using google sites, and it's painful
[2012-08-02 14:06:46 -0400] Jay_Levitt: That's a good idea.  Print out the wiki.
[2012-08-02 14:07:08 -0400] cheeseplus: Confluence has been acceptable before but it comes down to the admin
[2012-08-02 14:07:59 -0400] geekbri: We use confluence.  It's ok I guess
[2012-08-02 14:08:00 -0400] StormSilver: Jay_Levitt: I haven't hated MediaWiki in the past.
[2012-08-02 14:08:11 -0400] geekbri: My previous company we used mediawiki. Do not want.
[2012-08-02 14:08:20 -0400] bradgignac: i quite like confluence, but i agree with cheeseplus on the admin being important
[2012-08-02 14:08:21 -0400] Jay_Levitt: geekbri: Why?
[2012-08-02 14:08:44 -0400] Jay_Levitt: Are there ways to get Markdown in MediaWiki? I hate switching gears so often..
[2012-08-02 14:08:59 -0400] geekbri: I didn't like the mediawiki markup language, I didn't like the process of upgrading it
[2012-08-02 14:09:05 -0400] Jay_Levitt: As for confluence, what about the admin is important?  I am the admin, and infallible..
[2012-08-02 14:09:05 -0400] geekbri: I didnt like the user management.
[2012-08-02 14:09:09 -0400] geekbri: I just didnt like mediawiki :)
[2012-08-02 14:09:20 -0400] geekbri: Confluence is nice if you are already using jira.
[2012-08-02 14:09:30 -0400] geekbri: Simple because you don't have to add yet another damn thing.
[2012-08-02 14:09:32 -0400] Jay_Levitt: ick, no.  I almost had to learn Java two months ago but I quit instead.
[2012-08-02 14:09:33 -0400] cheeseplus: doku rather appropriately means poison in Japanese, and dokuwiki is reflective of this
[2012-08-02 14:09:50 -0400] cheeseplus: geekbri: the atlassian integration can be pretty useful for sure
[2012-08-02 14:09:59 -0400] geekbri: Yeah it has its uses.
[2012-08-02 14:10:17 -0400] geekbri: Im with cheeseplus though, they all kind of make me unhappy
[2012-08-02 14:10:41 -0400] cheeseplus: the problem is that I love documentation so I am at odds with myself over it
[2012-08-02 14:10:52 -0400] Jay_Levitt: I'd be mostly thrilled with Github wiki if it only had search.
[2012-08-02 14:11:05 -0400] cheeseplus: it's only good if everyone actually uses it, it's easy to use, and doesn't piss you off everytime you have to use it
[2012-08-02 14:11:05 -0400] geekbri: I think one of the worst parts of having a wiki is how it starts to get cluttered, unorganized, and has incorrect documentation int
[2012-08-02 14:11:07 -0400] geekbri: in it
[2012-08-02 14:11:29 -0400] geekbri: but thats a separate issue altogether :)
[2012-08-02 14:11:30 -0400] cheeseplus: geekbri: yep, exactly that - but that is more a people issue than an inherent technology issue
[2012-08-02 14:11:45 -0400] geekbri: Yeah.  That's mostly unrelated to how awesome the wiki software is.
[2012-08-02 14:12:18 -0400] xeon22: hello
[2012-08-02 14:12:32 -0400] xeon22: question about handlers
[2012-08-02 14:12:52 -0400] Jay_Levitt: Disagree... if the wiki is low friction people will use it.  If you build it, they will come.  aka "Field of Dreams Effect"
[2012-08-02 14:12:58 -0400] xeon22: i have setup chef-handler-mail and it appears to run but no email
[2012-08-02 14:13:08 -0400] xeon22: no exceptions either
[2012-08-02 14:13:11 -0400] geekbri: Jay_Levitt: Sometimes the human failure is unrelated to how good the wiki is :)
[2012-08-02 14:13:20 -0400] cheeseplus: Jay_Levitt: I have built it and they all didn't give a shit
[2012-08-02 14:13:38 -0400] Jay_Levitt: geekbri: true, but I have an over-developed belief in my ability to persuade the team
[2012-08-02 14:13:43 -0400] cheeseplus: also, I'm pretty sure Kevin Costner just hallucinated that whole experience
[2012-08-02 14:14:00 -0400] Jay_Levitt: That can't be.  Kevin Costner is a fictional character.
[2012-08-02 14:14:11 -0400] geekbri: LIES
[2012-08-02 14:14:18 -0400] cheeseplus: my heart is broken
[2012-08-02 14:14:20 -0400] Jay_Levitt: My mistake, he's just two-dimensional.  THANKYOUGOODNIGHT
[2012-08-02 14:16:57 -0400] Jay_Levitt: Actual chef question:  I've already found a few bugs in cookbooks that weren't idempotent.  Once I use chef for production servers, how do I properly test before rolling out? Do I end up needing a development node, a from-scratch node, a staging node (running the same chef config as production) and then the real production servers?
[2012-08-02 14:17:55 -0400] cheeseplus: Jay_Levitt: I've used development nodes (usually a vm) and simply added a role to them first or edited the node defition
[2012-08-02 14:18:11 -0400] maruq: hi guys
[2012-08-02 14:18:35 -0400] maruq: It seems that running "knife bootstrap" on a node only git deploys once for me
[2012-08-02 14:18:54 -0400] maruq: should I be able to run knife bootstrap multiple times & have it grab the next deploy?
[2012-08-02 14:19:08 -0400] cheeseplus: Jay_Levitt: I'd be curious if Foodcritic et al actually check for idempotency
[2012-08-02 14:19:13 -0400] maruq: it seems to run the rest of the role fine, just doesn't grab the latest code
[2012-08-02 14:20:02 -0400] Jay_Levitt: cheeseplus: oh, you just gave me an idea - when I switch to AWS, I can create a snapshot, clone a node, and then update that one
[2012-08-02 14:20:42 -0400] Jay_Levitt: I just don't want some automatic converge to take down a production server
[2012-08-02 14:22:29 -0400] yfeldblum: cheeseplus, each resource should, in and of itself, be idempotent
[2012-08-02 14:22:30 -0400] cheeseplus: Jay_Levitt: that seems like a good plan
[2012-08-02 14:22:54 -0400] xeon22: handlers anyone?
[2012-08-02 14:23:16 -0400] Jay_Levitt: yfeldblum: should, normatively, yes :) but I've already found two cookbooks (by fnichol, who I respect very much) that aren't idempotent
[2012-08-02 14:24:12 -0400] xeon22: chef-handler-mail not sending email
[2012-08-02 14:24:22 -0400] xeon22: what could i be missing?
[2012-08-02 14:24:34 -0400] maruq: if I re-run knife bootstrap, should it be deploying the subsequent commits to my git repo?
[2012-08-02 14:27:47 -0400] geekbri: Jay_Levitt: There are things like cucumber-chef, minitest-chef-handler,and other solutions as well I believe
[2012-08-02 14:30:50 -0400] cheeseplus: maruq: knife bootstrap should only be run once against a node, I am confused as to how/why/where a git repo is part of this
[2012-08-02 14:31:48 -0400] maruq: cheeseplus: ah okay. part of the role is to deploy a web app from github.
[2012-08-02 14:32:02 -0400] maruq: cheeseplus: what should I be running for subsequent runs?
[2012-08-02 14:32:45 -0400] yfeldblum: maruq, to kick off a converge after a node has been bootstrapped, run `[sudo] chef-client`
[2012-08-02 14:32:47 -0400] cheeseplus: maruq: knife bootstrap just sets up a node for use with a chef server, so assuming you have a chef server somewhere, you would want to run chef-client
[2012-08-02 14:33:09 -0400] erratic__: yaaaaawn
[2012-08-02 14:33:18 -0400] yfeldblum: maruq, from an SSH session in that actual server you want to converge
[2012-08-02 14:34:06 -0400] maruq: yfeldblum, cheese plus: so sticking a "recipe::chef-client" in the end of the run_list would make everything hunky-dory?
[2012-08-02 14:34:18 -0400] ssd7: Ohai Chefs!
[2012-08-02 14:35:13 -0400] geekbri: morni.
[2012-08-02 14:36:29 -0400] cheeseplus: maruq: thats not really how you would want to use knife bootstrap, although you could use "knife ssh" for that purpose
[2012-08-02 14:37:16 -0400] cheeseplus: maruq: typically you run chef-client as a daemon (running at some interval) or cron it
[2012-08-02 14:37:45 -0400] maruq: cheeseplus, yfeldblum: yep, I thought that was the case. so I should just build an EC2 AMI with chef-client on there & let it do it's thing
[2012-08-02 14:38:12 -0400] maruq: just need to use that gist that lets you hack the client.rb & feed in a json blob
[2012-08-02 14:38:49 -0400] cheeseplus: correct, bootstrap it to get chef-client installed and configured
[2012-08-02 14:41:14 -0400] maruq: cheeseplus: ah, I totally misunderstood the point of knife bootstrap / knife ec2
[2012-08-02 14:43:25 -0400] cheeseplus: maruq: knife ec2 goes a step further than bootstrap since it can create, delete instances but glad we could help clear it up
[2012-08-02 14:43:48 -0400] cheeseplus: knife can also do tons of stuff so it can be confusing for sure
[2012-08-02 14:44:16 -0400] yfeldblum: maruq, you can do that
[2012-08-02 14:44:59 -0400] maruq: cheeseplus: yeah, I've found most of the cool hacks for knife, just misunderstood what knife bootstrap & knife ec2 were for
[2012-08-02 14:45:47 -0400] maruq: yfeldblum: yeah the hacked client.rb was what I used to do, I just thought knife bootstrap was a magic replacement for that
[2012-08-02 14:46:09 -0400] maruq: yfeldblum: turns out, I misunderstood the magic.
[2012-08-02 14:46:12 -0400] maruq: also, I'm a newt
[2012-08-02 14:46:50 -0400] geekbri: Well I got betta'!
[2012-08-02 14:46:55 -0400] cheeseplus: hehe, a very advanced newt it seems ;)
[2012-08-02 14:50:07 -0400] maruq: haha
[2012-08-02 14:57:04 -0400] maruq: cheeseplus, yfeldblum: aha! It seems the bottom of the knife ec2 page has what I need: http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide
[2012-08-02 14:57:10 -0400] maruq: knife ec2 server create -I ami-b89842d1 -x ubuntu -r 'recipe[chef-client]'
[2012-08-02 14:57:34 -0400] maruq: ^^ boots an ec2 node, straps it up with chef, runs chef-client
[2012-08-02 14:57:43 -0400] cheeseplus: yep!
[2012-08-02 14:58:45 -0400] maruq: then "knife node run_list add NODENAME 'role[my_awesome_role]'" would make everything awesome
[2012-08-02 14:59:31 -0400] cheeseplus: yep, you can use roles or edit the node defiition itself to set run_lists
[2012-08-02 15:00:21 -0400] xuru: Hello everyone  Does the SCM resource update the code on the node if your using action :export when the revision changes?  Does it keep track of what revision it is at somewere?
[2012-08-02 15:02:07 -0400] cwj: leifmadsen: i saw you opened an issue against Discovery in github, are you still having problems with it?
[2012-08-02 15:14:05 -0400] leifmadsen: cwj: no it works now, I think I'm close to understanding it all :)  I have written some documentation in a branch and am hoping to provide a pull request later today
[2012-08-02 15:14:20 -0400] cwj: cool beans
[2012-08-02 15:14:21 -0400] leifmadsen: cwj: the 'host' value I think was implied to be set by a search first
[2012-08-02 15:14:40 -0400] cwj: yeah you need two node objects to compare
[2012-08-02 15:14:52 -0400] leifmadsen: ya I didn't quite understand that's how it worked
[2012-08-02 15:15:04 -0400] leifmadsen: it's still fuzzy logic in my head, but it works, and I'm starting to understand what it does...
[2012-08-02 15:15:52 -0400] xuru: ok, incase anyone was wondering, using :sync instead of :export works to track the head revision using the CSM resource, and :export doesn't.  I imagine you'd have to use the deploy resource if you wanted that, as it keeps track of what revision was deployed in the chef cache directory...
[2012-08-02 15:16:11 -0400] leifmadsen: huh, co-worker just pointed out to me that all our node data on the chef server, regardless as to the actual platform, sets "platform?": "ubuntu"
[2012-08-02 15:16:48 -0400] yfeldblum: leifmadsen, yeah you don't want to be doing that :P
[2012-08-02 15:17:04 -0400] leifmadsen: something must be actually setting that in a cookbook somewhere...
[2012-08-02 15:27:15 -0400] xerxas: Hi all
[2012-08-02 15:27:43 -0400] xerxas: simple and stupid question, can I specify time intervals with the cron provider ?
[2012-08-02 15:27:58 -0400] xerxas: I mean minute "*/5 "
[2012-08-02 15:28:00 -0400] xerxas: sth like this
[2012-08-02 15:28:18 -0400] bram_: yes
[2012-08-02 15:28:27 -0400] xerxas: thx
[2012-08-02 15:28:44 -0400] xerxas: it's not in the doc, but maybe it doesn't need to be in
[2012-08-02 15:29:01 -0400] bram_: ow, wrong chan
[2012-08-02 15:29:18 -0400] bram_: sorry xerxas that yes wasn't for you
[2012-08-02 15:30:00 -0400] xerxas: oops ;)
[2012-08-02 15:33:03 -0400] cwj: xerxas: i think this ticket is relevant to your question http://tickets.opscode.com/browse/CHEF-939
[2012-08-02 15:33:17 -0400] cwj: looks like it should work (again?) in 10.14.0
[2012-08-02 15:42:39 -0400] magoo: is it possible to pass overriding json to a node when it's created with knife-ec2?
[2012-08-02 15:42:54 -0400] magoo: everything I've read seems to indicate it's not possible
[2012-08-02 15:49:13 -0400] btm: xerxas: you should be able to use the same values you use in the cron file. If you can't, its a bug. There have been some.
[2012-08-02 15:50:34 -0400] erratic: I've squashed a grid bug
[2012-08-02 15:52:02 -0400] magoo: related to my earlier question, i found this https://github.com/opscode/knife-ec2/pull/47
[2012-08-02 15:52:10 -0400] jwitrick: does anyone know if the latest rabbitmq cookbook fixes the bug of starting a rabbitmq-server on a centos 6 box with sssd running?
[2012-08-02 15:56:10 -0400] xerxas: cwj, btm , thx !
[2012-08-02 15:57:36 -0400] maruq: magoo: so this means it's in there, or not yet?
[2012-08-02 15:58:14 -0400] magoo: i think so... i need to check the latest gem
[2012-08-02 16:01:30 -0400] leifmadsen: yfeldblum: huh neat, I think I tracked the platform? ubuntu thign down to the mysql cookbook
[2012-08-02 16:04:21 -0400] leifmadsen: aha, I think it's this pull request that would fix it:    https://github.com/opscode-cookbooks/mysql/pull/16/files
[2012-08-02 16:10:53 -0400] leifmadsen: and confirmed, pull request fixes. Comment added.
[2012-08-02 16:22:27 -0400] iamchrisf: So we have some default attributes that are set from fqdn, but when we bootstrap fqdn is not set yet.  I've tried setting hostname as the first applied recipe, but it seems attributes are populated before recipes are applied. Any ideas on this?
[2012-08-02 16:28:51 -0400] leifmadsen: is there a particularly good way of passing data between recipes? For example I might run one recipe that does a search, and I want to make that value available to another recipe being executed after it
[2012-08-02 16:29:46 -0400] sampikesley: leifmadsen: probably a data bag
[2012-08-02 16:30:00 -0400] leifmadsen: ya that's kind of what I was thinking.... although I want the data to be temporary
[2012-08-02 16:32:56 -0400] leifmadsen: basically I want the data to be temporary and only available to all recipes for that run
[2012-08-02 16:33:47 -0400] yfeldblum: sampikesley, no, not a data bag ... that's actually a worse option than just rerunning the search
[2012-08-02 16:34:02 -0400] yfeldblum: leifmadsen, what for?
[2012-08-02 16:34:33 -0400] leifmadsen: yfeldblum: well basically I have a co-worker who has a recipe that does a search and assigned data to a variable, and he doesn't want to run the search again from another recipe
[2012-08-02 16:34:47 -0400] leifmadsen: so node.set is out too
[2012-08-02 16:34:50 -0400] leifmadsen: as that is persistent
[2012-08-02 16:35:01 -0400] yfeldblum: leifmadsen, what's the problem with persistent?
[2012-08-02 16:35:47 -0400] yfeldblum: leifmadsen, the standard input for any recipe ought to be the node data (and the node data alone), unless there's a strong reason to do otherwise
[2012-08-02 16:35:49 -0400] leifmadsen: yfeldblum: I suppose to keep the node data cleaner
[2012-08-02 16:36:36 -0400] yfeldblum: leifmadsen, also `node.set` is not a great idea unless there's a specific reason for it; prefer `node.default` or `node.override` instead
[2012-08-02 16:36:36 -0400] leifmadsen: for the usage that is happening it's just kind of useless data that doesn't need to be on the node at all times
[2012-08-02 16:36:55 -0400] leifmadsen: yfeldblum: I think the thing is that he doesn't want the data to persist at all after the run
[2012-08-02 16:37:08 -0400] Mithrandir: leifmadsen: you can have a global variable, I assume
[2012-08-02 16:37:24 -0400] yfeldblum: leifmadsen, Mithrandir, global variables are indeed an option
[2012-08-02 16:37:42 -0400] yfeldblum: leifmadsen, Mithrandir, but global variables are in general to be avoided
[2012-08-02 16:37:56 -0400] leifmadsen: ya, reading the attributes page looks like we might just want node.override
[2012-08-02 16:38:38 -0400] leifmadsen: first paragraph under Attribute Persistence
[2012-08-02 16:38:47 -0400] yfeldblum: leifmadsen, that would be in-line with the standard way to use chef
[2012-08-02 16:38:48 -0400] leifmadsen: yfeldblum: Mithrandir: thanks for the pointers
[2012-08-02 16:38:53 -0400] leifmadsen: yfeldblum: even better :)
[2012-08-02 16:39:20 -0400] yfeldblum: leifmadsen, override-level attributes are persisted to the chef-server (but are cleared out at the beginning of every chef-client run and re-saved at the end of every successful chef-client run)
[2012-08-02 17:08:37 -0400] japage: Hi
[2012-08-02 17:09:18 -0400] japage: I was wondering if anyone knows how to handle errors that the http_request resource might throw?
[2012-08-02 17:31:18 -0400] biffhero: has anyone installed chef via the instructions on http://wiki.opscode.com/display/chef/Installing+Omnibus+Chef+Client+on+Linux+and+Mac ?  The line which says "After installation, you should move your validation client's private key onto the node and copy it to /etc/chef/."  confuses me.  Is this a pem file somewhere?
[2012-08-02 17:31:59 -0400] jbz: biffhero:  Are you running your own chef server, or using the Opscode platform?
[2012-08-02 17:32:07 -0400] biffhero: my own chef server
[2012-08-02 17:32:19 -0400] biffhero: this page has the instructions on how to do the install
[2012-08-02 17:32:41 -0400] biffhero: sudo true && curl -L http://opscode.com/chef/install.sh | sudo bash
[2012-08-02 17:33:02 -0400] dyer: Hey guys, question I just did a backup and compaction of my couchDB but now none of my chef runs are working
[2012-08-02 17:33:08 -0400] biffhero: that goes smoothly, and after that, "chef-client -v" works well.
[2012-08-02 17:33:30 -0400] dyer: getting an Socket error when looking for the environments cookbook version ( logs: https://gist.github.com/ab76ed0fd469e1771e16 )
[2012-08-02 17:33:33 -0400] jbz: biffhero:  OK, that's the clientyou also installed a chef server somewhere?
[2012-08-02 17:33:54 -0400] dyer: I can only assume this has to do with backing up the couchDB.. but I did follow the instructions from the opscode site..
[2012-08-02 17:34:05 -0400] dyer: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2012-08-02 17:35:15 -0400] biffhero: what?  This is the client?  argh.  oh, yeah, that's right.  the reason I went there was I started at http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo and that points to http://wiki.opscode.com/display/chef/Installing+Chef+Client+and+Chef+Solo which points to http://wiki.opscode.com/display/chef/Installing+Omnibus+Chef+Client+on+Linux+and+Mac
[2012-08-02 17:36:09 -0400] jbz: biffhero:  Heh OKso chef-client will only work if you can point it at a running server.  If you haven't gotten the server up yet, then you need chef-solo, not chef-client
[2012-08-02 17:36:49 -0400] biffhero: jbz: yeah, that makes sense, but that second link is supposed to have me install chef-solo.
[2012-08-02 17:36:58 -0400] jbz: biffhero:  I recommend going back to the first link and starting with 'Configuring Chef Solo'
[2012-08-02 17:37:06 -0400] jbz: Yes, it installs with the client I'm pretty sure
[2012-08-02 17:37:09 -0400] jessicab: pretty sure omnibus also installs chef-solo, but i could be wrong
[2012-08-02 17:37:23 -0400] jbz: so you know have chef-solo, and should go back to the start and configure it. :-)  I know, confusing.
[2012-08-02 17:37:42 -0400] biffhero: Oh, so I am further along than I thought I was?
[2012-08-02 17:37:45 -0400] biffhero: Awesome.
[2012-08-02 17:38:03 -0400] jbz: biffhero:  The validation.pem is the key that lets chef-client (not chef-solo) connect initially to a chef server.
[2012-08-02 17:38:11 -0400] jbz: For chef-solo use, you don't need it.
[2012-08-02 17:38:45 -0400] biffhero: sure.
[2012-08-02 17:38:46 -0400] biffhero: thanks
[2012-08-02 17:38:49 -0400] biffhero: back to my steps.
[2012-08-02 17:39:08 -0400] jbz: cheers
[2012-08-02 17:39:42 -0400] dyer: Anyone have any idea whats going on h ere?
[2012-08-02 17:39:47 -0400] dyer: s/h ere/here
[2012-08-02 17:42:59 -0400] dyer: FML, my server js fucked now
[2012-08-02 17:43:05 -0400] dyer: Not good
[2012-08-02 17:43:11 -0400] dyer: These instructions bad or something ?
[2012-08-02 17:53:36 -0400] dyer: ok, well I restarted everything and it seems happy
[2012-08-02 17:53:54 -0400] dyer: no idea why compacting the DB would cause that
[2012-08-02 17:55:54 -0400] japage: if a resource in a recipe throws an error, is there any way to rescue that error?
[2012-08-02 17:57:08 -0400] japage: and prevent it from killing the chef run when that resource gets executed?
[2012-08-02 17:59:59 -0400] Randm: 'compacting the db'?
[2012-08-02 18:00:06 -0400] Randm: sounds like a blocking operation to me
[2012-08-02 18:07:10 -0400] japage: Ohh, gee found that resources have a common option, called ignore_failure. I think that might fix it.
[2012-08-02 18:09:18 -0400] chip-: what's the proper syntax for passing in an attribute as part of a string to a resource? For instance: directory "~node[:recipe][:username]/foo" to put something in a user's home directory
[2012-08-02 18:10:10 -0400] ssd7: chip-: In general when you want to use a variable/attribute in a string "foo #{node['bar']}"
[2012-08-02 18:10:19 -0400] chip-: Thanks.
[2012-08-02 18:11:07 -0400] ssd7: chip-: But I would be careful about ~usesrname constructs since it requires the shell or /something/ to expand that into a real path.  So depending on where you use that, you might have a bad time.
[2012-08-02 18:11:42 -0400] chip-: ssd7: In this case I have to drop an ivysettings.xml into ~/.ivy2 for the user of a vagrant box, so it's a controlled environment.
[2012-08-02 18:16:24 -0400] benjaminws: Can I get some input on this? https://gist.github.com/3239098 I've done this pattern before, but obviously it's wrong :|
[2012-08-02 18:18:53 -0400] ssd7: benjaminws: I think you just might be running into some oddness with how chef_gem works in particular.  For instance, if you were to just put a log resource in there, my guess is you would see only one log entry that was produced during the converge phase.
[2012-08-02 18:20:28 -0400] yfeldblum: benjaminws, are you using the version of chef that supports chef_gem, or are you using the chef_gem cookbook?
[2012-08-02 18:22:04 -0400] ssd7: Also a good question
[2012-08-02 18:27:06 -0400] Loof: Heya, I've got a very simple bit of automation I want to do...
[2012-08-02 18:27:41 -0400] Loof: I've done something similar via capistrano... and I'm wondering if Chef will work well for this or if cap is really the right tool for now
[2012-08-02 18:27:50 -0400] Loof: I have some ec2 instances..
[2012-08-02 18:29:35 -0400] Loof: I want to take a snapshot of ec2 instance (call it #1), then start a new instance (#2), got in any apply some scripted changes (change a few configuration files, etc), make a new snapshot and stop #2... then spin up #3 based on the snapshot, etc.
[2012-08-02 18:29:45 -0400] Loof: So it's very procedural... it's part of a deployment process
[2012-08-02 18:30:27 -0400] Loof: another simple case is just to log in and update a server (or servers /w the same name/node type) via git... run a few post-update scripts
[2012-08-02 18:30:39 -0400] benjaminws: whoops, got pulled away, sorry about that.
[2012-08-02 18:31:06 -0400] Loof: Most of the examples I've found are about establishing a configuration... install X... bring up X, Y, Z from bare instance/metal.
[2012-08-02 18:31:06 -0400] benjaminws: yfeldblum: Using 10.12.0 with chef_gem, not hte cookbook.
[2012-08-02 18:31:25 -0400] miah: moin
[2012-08-02 18:31:47 -0400] Loof: Does anyone have some pointers for using chef in the way I'm describing... or should I be using a combination of tools in this case?
[2012-08-02 18:32:13 -0400] benjaminws: ssd7: I will give that a go, but it's running chef_gem for sure, for each of the gems, twice. When the cookbook loads, and when it converges.
[2012-08-02 18:32:51 -0400] benjaminws: and I lied, slightly, I have used this pattern for the yum provider specifically.
[2012-08-02 18:32:57 -0400] benjaminws: never done it with chef_gem
[2012-08-02 18:33:31 -0400] benjaminws: ssd7: ahh, misunderstood your answer. I'll try to log and see what happens
[2012-08-02 18:33:33 -0400] yfeldblum: benjaminws, because the chef_gem resource gets added to the run-list where it will get converged later, and also gets converged immediately
[2012-08-02 18:33:51 -0400] benjaminws: yfeldblum: Ohhhhhh
[2012-08-02 18:35:05 -0400] ssd7: benjaminws: Yeah, sorry for not being more explicit about that. :)  yfeldblum's description is spot on.
[2012-08-02 18:35:45 -0400] ssd7: benjaminws: That pattern you have there should usually work as expected and is used in a good number of community and opscode cookbooks.
[2012-08-02 18:36:44 -0400] yfeldblum: benjaminws, by "run-list" i mean the run-context's resource-collection, which is what chef loops over later and converges all the resources in
[2012-08-02 18:36:57 -0400] yfeldblum: benjaminws, "run-list" is something else entirely
[2012-08-02 18:37:10 -0400] benjaminws: yfeldblum: I'm with you now, thanks
[2012-08-02 18:39:24 -0400] benjaminws: Maybe I should just make a quick LWRP to handle this. Define a chef_gems resource that takes a "packages" attribute that would then iterate over in the provider.
[2012-08-02 18:39:46 -0400] benjaminws: too much?
[2012-08-02 18:42:20 -0400] dols: anyone seen this before: ERROR: ArgumentError: Cannot sign the request without a client name, check that :node_name is assigned
[2012-08-02 18:42:42 -0400] biffhero: On this page: http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo#InstallingChefServerusingChefSolo-CentOS%2FRHELInstallationNotes the instructions say "You must have the http://rbel.frameos.org/ or other similar 3rd party repository installed to run the bootstrap cookbook." I look to the link there to go to http://rbel.frameos.org/ which says to do the install " rpm -Uvh http://rbel.co/rbel5 " but the domain rbel.co is expire
[2012-08-02 18:43:53 -0400] ssd7: dols: the node_name is either set from config (or via a command line option) or from the hostname or fqdn.  If you aren't setting it in config anywhere, I would start with what `hostname` returns on that machine.
[2012-08-02 18:44:37 -0400] dols: yea, node_name is in my knife.rb
[2012-08-02 18:45:52 -0400] Loof: Hmm
[2012-08-02 18:46:08 -0400] Jay_Levitt: Loof: fog is a great tool, you're probably already doing that from cap. Not sure if there's a "chef way" to do that other than have a chef recipe that does what you're doing already.
[2012-08-02 18:48:11 -0400] Jay_Levitt: I don't see anything in the apache2 cookbook to let me add files to conf.d; is that just something I'd do with cookbook_file?
[2012-08-02 18:48:36 -0400] miah: Jay_Levitt: there is a lwrp or definition called 'apache_site' included with the cookbook
[2012-08-02 18:48:56 -0400] miah: pretty sure thats mentioned in the README.md
[2012-08-02 18:48:57 -0400] Jay_Levitt: miah: yeah, but this isn't for a virtualhost, and shouldn't be under sites-available
[2012-08-02 18:49:03 -0400] Jay_Levitt: i.e. basicauth for the whole server
[2012-08-02 18:49:06 -0400] miah: ah
[2012-08-02 18:49:15 -0400] Jay_Levitt: or gzipping or whatever
[2012-08-02 18:49:31 -0400] miah: you can template overload the one included in the cookbook
[2012-08-02 18:49:47 -0400] Jay_Levitt: isn't template overloading deprecated?
[2012-08-02 18:51:48 -0400] miah: unsure
[2012-08-02 18:52:24 -0400] Jay_Levitt: miah: are you referring to creating the template file with the same name in a site-cookbooks/ cookbook?  that one IS deprecated, I'm sure
[2012-08-02 18:53:03 -0400] geekbri: Jay_Levitt, miah: There is a jira ticket out there, and an alternative to the template overload that is deprecated
[2012-08-02 18:53:37 -0400] Jay_Levitt: geekbri: ah, good to know - the wiki page I saw about it just said "Here's how you do this great thing that's deprecated now."
[2012-08-02 18:53:55 -0400] geekbri: One of my coworkers did it recently, have had a chance to code review yet
[2012-08-02 18:55:52 -0400] geekbri: Jay_Levitt, miah: https://gist.github.com/3239713 looks this is what he did
[2012-08-02 18:56:08 -0400] Jay_Levitt: geekbri: oh, you work with yfeldblum? cool, he posted that in the ticket too
[2012-08-02 18:56:23 -0400] geekbri: Jay_Levitt: I don't work with yfeldblum but that is the ticket my coworker was working from
[2012-08-02 18:56:27 -0400] miah: interesting
[2012-08-02 18:56:56 -0400] geekbri: where graphite-customizations is the cookbook he added (which basically only containts that code in default and the associated templmates in templates)
[2012-08-02 18:57:25 -0400] miah: interesting
[2012-08-02 18:57:41 -0400] miah: it really bothers me that many cookbooks force you to do that stuff
[2012-08-02 18:58:11 -0400] miah: i like to build my cookbooks so that you can install just the package and not muck around with configs if thats what you want
[2012-08-02 18:58:38 -0400] miah: or just muck around with the configs and not manage the package
[2012-08-02 18:58:45 -0400] miah: flexibility = awesome
[2012-08-02 18:59:16 -0400] miah: http://blog.nistu.de/2012/03/04/reusability-in-configuration-management-systems
[2012-08-02 18:59:18 -0400] Jay_Levitt: yeah, I get the feeling I've caught this train right as there's a shift from "fork the official cookbook and make it work like you want" to "make cookbooks modular"
[2012-08-02 18:59:30 -0400] miah: ya
[2012-08-02 18:59:35 -0400] geekbri: miah: Yeah I fight with that a lot.  A lot of times I like a CB that just installs and manages services without touching configs.  Sometimes I do include the configuration stuff though
[2012-08-02 19:00:06 -0400] miah: i'll include all the options, but split it all up
[2012-08-02 19:00:25 -0400] miah: eg https://github.com/miah/nagios/tree/refactor/recipes
[2012-08-02 19:00:46 -0400] Jay_Levitt: speaking of which, since I want to add some configurability to the postgresql cookbook... is there a pattern/recipe/modular thingie for "manage a typical 'key = value' config file through settable attributes"?
[2012-08-02 19:00:53 -0400] miah: still quite a bit to clean up there though
[2012-08-02 19:02:08 -0400] Jay_Levitt: for instance, I'd like the (default!) template for postgresql.conf to be "set all the keys = all the values", and move what's currently in the template into some default attributes.
[2012-08-02 19:02:15 -0400] miah: Jay_Levitt: maybe https://github.com/heavywater/chef-bag_config but i haven't used it and have been thinking about the same problem recently
[2012-08-02 19:02:22 -0400] Jay_Levitt: ... I guess that's really just iterating over a hash, isn't it.
[2012-08-02 19:02:28 -0400] miah: yup
[2012-08-02 19:02:38 -0400] miah: i'm doing the same for my nagios lwrp
[2012-08-02 19:02:40 -0400] Jay_Levitt: "That's called 'programming', Jay."
[2012-08-02 19:02:55 -0400] miah: because the resource list is... insane
[2012-08-02 19:02:55 -0400] Jay_Levitt: "It's what you used to do before everything was a Ruby gem."
[2012-08-02 19:03:16 -0400] geekbri: I'm not sure I followed what you were saying, but I often like to basically have a default hash of settings and then I use to_hash on some attributes and do a merge
[2012-08-02 19:04:15 -0400] jameson: anyone have experience using iptables with chef?
[2012-08-02 19:04:20 -0400] Jay_Levitt: geekbri: see https://github.com/opscode-cookbooks/postgresql/blob/master/templates/default/debian.postgresql.conf.erb
[2012-08-02 19:04:21 -0400] yfeldblum: Jay_Levitt, mmmmm programming
[2012-08-02 19:05:18 -0400] yfeldblum: jameson, shorewall is nice for that sort of thing, since the whole thing is done via config files; also checkout opscode's firewall cookbook
[2012-08-02 19:05:22 -0400] miah: geekbri: basically, you can have a recipe that iterates over an attribute list / data bag to build out the configuration. which means you don't have to modify the cookbook to change configuration settings, or invoke lwrp to create instances.
[2012-08-02 19:05:56 -0400] Jay_Levitt: geekbri: to set any of those config settings, you have to replace the entire template.  People have been adding some ERB code around some of them, as you can see, but we shouldn't need to have a pull request every time someone wants to be able to change another setting.  The whole thing should be attributes.
[2012-08-02 19:06:54 -0400] geekbri: I have written cookbooks before that generate the configuration files dynamically from attributes.  It has its  own set of pitfalls I've found
[2012-08-02 19:07:31 -0400] miah: Jay_Levitt: yup
[2012-08-02 19:07:42 -0400] Jay_Levitt: geekbri: go on... </Jon Stewart>
[2012-08-02 19:08:05 -0400] geekbri: Oh, I guess my main issue is that so many configuraiton files for so many different pieces of software don't follow any real convention of any type
[2012-08-02 19:08:12 -0400] Loof: Jay_Levitt: I could write a recipe... but I'm not entirely sure (being a total chef newbie) if I can set up a recipy and tell chef to just 'do this'
[2012-08-02 19:08:25 -0400] geekbri: so you write this thing that can dynamically generate the entire config top to bottom, even being able to handle new additions through attributes only
[2012-08-02 19:08:31 -0400] geekbri: then something gets added that just F's it all up :)
[2012-08-02 19:08:44 -0400] geekbri: then you gotta go update the cookbook anyway :)
[2012-08-02 19:09:01 -0400] Jay_Levitt: That'd only be for config files where order matters, like apache configs, no?  For postgresql.conf it's pure key=value
[2012-08-02 19:09:15 -0400] geekbri: for anything thats pure key=value it shouldn't be too tough to do at all
[2012-08-02 19:09:17 -0400] miah: well. you can code around those problems =)
[2012-08-02 19:09:27 -0400] Jay_Levitt: yeah, I wouldn't want to try programmatically generating all of httpd.conf :)
[2012-08-02 19:09:33 -0400] geekbri: miah: Hehe, yeah and those end up being a pull request ;) but you certainly can limit the amount necessary
[2012-08-02 19:10:04 -0400] miah: ya. im having similar thoughts for how to handle the various object types in nagios for this lwrp
[2012-08-02 19:10:22 -0400] miah: i want to make sure that each object only gets passed valid arguments
[2012-08-02 19:10:26 -0400] Jay_Levitt: Loof: I'm a newbie too, about two weeks in :)  Yes, just put 'recipe[my_recipe]' in the run_list for your node, chef will run it, and you can do whatever you like.
[2012-08-02 19:10:32 -0400] miah: but afair nagios doesn't care about order
[2012-08-02 19:10:56 -0400] geekbri: miah: yeah anything that doesn't care about ordering and follows a basic key/value pair situation is usually not too hard to deal with
[2012-08-02 19:10:56 -0400] Loof: Jay_Levitt: But my understanding is that the run_list is not a 'do this once' but 'do this always'
[2012-08-02 19:11:02 -0400] miah: yup
[2012-08-02 19:11:08 -0400] geekbri: miah: I also find, that using ye olde' conf.d is nice
[2012-08-02 19:11:20 -0400] geekbri: So that anybody can just drop a template in there and override whatever they want
[2012-08-02 19:11:23 -0400] Loof: Jay_Levitt: What I'm trying to do is have a few steps that happen whenever a new release goes out
[2012-08-02 19:11:24 -0400] Jay_Levitt: Loof: Ah, right, so you want to do this "only when deploying".. I'm not sure about using chef for app deploys, others here probably know
[2012-08-02 19:11:25 -0400] geekbri: assuming the software supports that of course.
[2012-08-02 19:11:42 -0400] miah: true true
[2012-08-02 19:11:45 -0400] geekbri: like redis' last config wins style is nice, so anybody can just bypass whatever by dropping a template down in the conf.d directory and make sure its read last.
[2012-08-02 19:11:53 -0400] geekbri: however something horrid and disgusting like rsyslog won't work
[2012-08-02 19:11:58 -0400] geekbri: because its additive and its documentation sucks
[2012-08-02 19:12:03 -0400] Jay_Levitt: geekbri: yeah, I think I will use cookbook_file "conf.d/gzip-everything" for my apache case
[2012-08-02 19:12:21 -0400] geekbri: oh well, theres the damn rsyslog rage coming out again
[2012-08-02 19:12:24 -0400] geekbri: gotta bottle that back up
[2012-08-02 19:12:44 -0400] Jay_Levitt: what's the deal with rsyslog vs syslog-ng? I've been out of the game 10 years, what'd I miss?
[2012-08-02 19:13:24 -0400] Loof: The cloest I found was one-shot recipe... which removes it from the run list at the end... but that seems a little hackish
[2012-08-02 19:13:27 -0400] miah: syslog still sucks?
[2012-08-02 19:13:56 -0400] Jay_Levitt: dammit.  I was hoping if I slept long enough it would get better.
[2012-08-02 19:13:59 -0400] Loof: Basically the goal is going to be a mixed admin approach... because we're moving a bit too fast and our team is a bit too small to fully automate everything
[2012-08-02 19:14:01 -0400] geekbri: you didn't miss anything I don't thinkl.
[2012-08-02 19:14:10 -0400] Loof: we'll have chef be able to get things 'close to running'
[2012-08-02 19:14:23 -0400] Loof: Eventually it'll be able to do the whole thing
[2012-08-02 19:14:26 -0400] Jay_Levitt: Loof: Personally, I plan to use chef for infrastructure and cap for app deploys
[2012-08-02 19:14:41 -0400] Loof: then we get things up and running the rest of the way manually... document the gaps
[2012-08-02 19:14:46 -0400] Loof: (which has been done a few times)
[2012-08-02 19:14:52 -0400] Loof: eventually make that back into chef
[2012-08-02 19:15:04 -0400] Loof: (the whole chef setting things up is fantasy at the moment) :)
[2012-08-02 19:15:10 -0400] geekbri: How are you doing your deploys?  Why not just have the deploy resource send a notification to perform the "only on deploy" steps
[2012-08-02 19:15:29 -0400] Loof: And then there's 2 phases... take that 'staging' server and update git, etc.
[2012-08-02 19:15:50 -0400] Loof: and then stage -> prod involves taking that working & tested staging server
[2012-08-02 19:15:56 -0400] Loof: making it into an AMI
[2012-08-02 19:16:01 -0400] Loof: changing the configuration to prod
[2012-08-02 19:16:07 -0400] Loof: then making a new prod AMI
[2012-08-02 19:16:16 -0400] Loof: and then we can start prod instances with something that's well tested
[2012-08-02 19:16:51 -0400] Loof: I like the idea of being able to provision each environment from scratch... but I don't like the possibility that one stupid mistake could leave prod running an untested and broken combination
[2012-08-02 19:17:15 -0400] Loof: I could see chef watching the deploy branch for the 1st phase
[2012-08-02 19:17:23 -0400] Loof: There are a few recipies for that
[2012-08-02 19:17:27 -0400] Loof: stage branch, that is
[2012-08-02 19:17:40 -0400] Loof: It's not particularly necessary for that to 'just happen'
[2012-08-02 19:17:51 -0400] Loof: I know when a stage push occurs... I can trigger the whole process
[2012-08-02 19:18:07 -0400] Loof: the stage -> prod conversion must happen relatively manually
[2012-08-02 19:18:46 -0400] Loof: There are a few stopping points where I sanity check... apply database updates... etc.
[2012-08-02 19:18:57 -0400] beandip: Anyone here using berkshelf?
[2012-08-02 19:19:20 -0400] Loof: I did something hackish for another company in capistrano a couple of years ago
[2012-08-02 19:19:55 -0400] geekbri: I wish they'd add a changelog.md to berkshelf
[2012-08-02 19:21:18 -0400] Loof: It worked... it wasn't quite as slick... we tried to use puppet for the 1st part
[2012-08-02 19:21:27 -0400] Loof: but puppet kept trying to change things back
[2012-08-02 19:21:41 -0400] Loof: so if we had to hot fix something... we had to update puppet... let puppet apply the change... etc.
[2012-08-02 19:22:20 -0400] Loof: also the puppet daemon consumed a TON of resources when it checked it's catalog
[2012-08-02 19:22:24 -0400] miah: i havent tried berkshelf yet..
[2012-08-02 19:22:32 -0400] Loof: we had to kill it everywhere and run it manually
[2012-08-02 19:22:39 -0400] Loof: So... I'm trying Chef this time around :)
[2012-08-02 19:22:46 -0400] miah: i've been using librarian for a while now, but definitely intend to give berkshelf a go at some point
[2012-08-02 19:23:15 -0400] geekbri: I am using librarian still.  I haven't gotten around to evaluating berkshelf yet, but a changelog would be nice to read through... to see what changes they are making and how development of it is going
[2012-08-02 19:27:57 -0400] atomic-penguin: miketheman, your knife role spaghetti tool is badass
[2012-08-02 19:28:07 -0400] miketheman: atomic-penguin: thanks!
[2012-08-02 19:28:20 -0400] miketheman: I'm still working through some bugs on json-formatted role files
[2012-08-02 19:28:29 -0400] miketheman: but glad to hear it!
[2012-08-02 19:28:59 -0400] atomic-penguin: I made this, http://i.imgur.com/AXHBP.jpg
[2012-08-02 19:29:49 -0400] miketheman: oh shit.
[2012-08-02 19:29:57 -0400] miketheman: can I add that to my readme as an example?
[2012-08-02 19:30:02 -0400] atomic-penguin: Sure
[2012-08-02 19:30:08 -0400] atomic-penguin: I can give you the non-neato version
[2012-08-02 19:30:15 -0400] atomic-penguin: As well
[2012-08-02 19:31:30 -0400] atomic-penguin: Its not as interesting though
[2012-08-02 19:32:09 -0400] atomic-penguin: http://i.imgur.com/qk3XY.png
[2012-08-02 19:32:35 -0400] miketheman: nice. it's cleaner than mine
[2012-08-02 19:33:25 -0400] miketheman: thanks! https://github.com/miketheman/knife-role-spaghetti/wiki/Example-images
[2012-08-02 19:38:19 -0400] dyer: Does anyone here use the mysql opscode cookbook on centos?
[2012-08-02 19:38:30 -0400] atomic-penguin: dyer, yup
[2012-08-02 19:39:00 -0400] dyer: Really Hrm, I am not how it could work first run
[2012-08-02 19:39:14 -0400] dyer: if you don't specify a password it users openssl to generate one, it then sets that password on the node
[2012-08-02 19:39:35 -0400] dyer: however at the bottom of server.rb it tries to use that password to connect to mysql in order to actually set the password
[2012-08-02 19:39:47 -0400] dyer: which fails because of course the root users doesn't have that password yet
[2012-08-02 19:40:15 -0400] atomic-penguin: dyer, what version?
[2012-08-02 19:40:22 -0400] dyer: 1.2.6
[2012-08-02 19:40:23 -0400] dyer: latest
[2012-08-02 19:40:46 -0400] atomic-penguin: Hmm, same here
[2012-08-02 19:41:26 -0400] dyer: ok, good to know I am not insane
[2012-08-02 19:42:44 -0400] atomic-penguin: No, I mean same version
[2012-08-02 19:42:54 -0400] atomic-penguin: It totally works for me though, so you must be insane
[2012-08-02 19:44:04 -0400] dyer: damn
[2012-08-02 19:44:08 -0400] dyer: hate being insane
[2012-08-02 19:44:09 -0400] atomic-penguin: Should be around line #142 of server recipe
[2012-08-02 19:44:58 -0400] dyer: hrm, ok
[2012-08-02 19:44:59 -0400] atomic-penguin: So is it skipping that block for some reason, and going right into the mysql_grants block
[2012-08-02 19:45:09 -0400] erratic__: nobody is insane
[2012-08-02 19:45:11 -0400] _rc: it connects later to re-assert grants, the password is set via pre-seeding
[2012-08-02 19:46:10 -0400] atomic-penguin: dyer, although I've set a pass for my systems
[2012-08-02 19:46:24 -0400] atomic-penguin: dyer, perhaps, there needs to be a node.save after the set.unless
[2012-08-02 19:47:45 -0400] atomic-penguin: _rc, I understand how it works, but he isn't on a preseed platform, so that is irrelevant
[2012-08-02 19:48:47 -0400] atomic-penguin: Therefore it has to be failing in the admin-password block, or mysql_grants block
[2012-08-02 19:49:27 -0400] monvillalon: Can someone from opscode help me, by resending me my "email confirmation" email.
[2012-08-02 19:49:54 -0400] dyer: k, I'll play with it some more
[2012-08-02 19:49:55 -0400] dyer: thanks
[2012-08-02 19:53:49 -0400] dyer: So there is only one service we uyse MySQL with, and I was thinking of making a recipe in that services cookbook to setup mysql and provision the DB if necessary.  This cookbook would check the data bag to see if there is a password define there, and if not it would need to set the password on an attribute, but then the password is stored clear text right  ?
[2012-08-02 19:59:40 -0400] miketheman: dyer: yeah, seems that is the case.
[2012-08-02 20:00:03 -0400] miketheman: unless you store the password back in the data bag, not the node attribute
[2012-08-02 20:00:09 -0400] miketheman: but it would still be in clear text
[2012-08-02 20:00:30 -0400] dyer: its an encrypted databag
[2012-08-02 20:00:33 -0400] dyer: still the case?
[2012-08-02 20:01:14 -0400] miketheman: probably not - encrypted databag is encrypted, I beleive
[2012-08-02 20:08:54 -0400] beandip: ANyone here using berkshelf?  I have some questions about it
[2012-08-02 20:08:54 -0400] monvillalon: jtimberman: sorry to bother you, can you direct me to how can i get opscode to resend me my confirmation email.
[2012-08-02 20:09:07 -0400] jameson: so opsce'de firewall
[2012-08-02 20:09:14 -0400] jameson: is that stable enough?
[2012-08-02 20:09:21 -0400] jameson: UfwFirewall
[2012-08-02 20:09:57 -0400] miketheman: jameson: it interacts with ufw (Uncomplicated Firewall) which generates iptables rules.
[2012-08-02 20:10:00 -0400] beandip: Do I create a Berskfile in chef-repo/cookbooks and simply list the cookbooks I want installed and used?
[2012-08-02 20:10:15 -0400] miah: rtfm maybe?
[2012-08-02 20:10:23 -0400] beandip: I have been, I'm a bit confused
[2012-08-02 20:10:24 -0400] jameson: rtfs right now
[2012-08-02 20:10:50 -0400] beandip: not much in the way of comprehensive documentation
[2012-08-02 20:10:52 -0400] miketheman: jameson: if you speak iptables, you may be better off with straight iptables syntax, like here: http://ckbk.it/simple_iptables
[2012-08-02 20:10:54 -0400] miah: beandip: http://christian-trabold.de/librarian-chef-vs-berkshelf
[2012-08-02 20:11:39 -0400] miah: has some more links to things to read
[2012-08-02 20:11:50 -0400] miah: simple_iptables needs some changes :/
[2012-08-02 20:11:54 -0400] xdg: I'm getting "NoMethodError" from the nginx cookbook from the repository.  Any ideas on how to fix/workaround?  stacktrace: https://gist.github.com/3240233
[2012-08-02 20:11:57 -0400] miah: doesnt fully work on rhel
[2012-08-02 20:12:19 -0400] Jay_Levitt: If I ran chef-server instead of Hosted Chef, would my chef-client runs be way faster?
[2012-08-02 20:12:25 -0400] miah: no
[2012-08-02 20:12:35 -0400] miah: if you wrote better cookbooks your client runs would be way faster
[2012-08-02 20:12:44 -0400] miketheman: miah, be nice. :)
[2012-08-02 20:12:47 -0400] miah: i am
[2012-08-02 20:13:01 -0400] Jay_Levitt: oh yeah? well, if you wrote.. uh.. if...
[2012-08-02 20:13:07 -0400] miketheman: what's broken with simple_iptables on rhel?
[2012-08-02 20:13:13 -0400] miah: Jay_Levitt: im not saying your writing bad code
[2012-08-02 20:13:20 -0400] Jay_Levitt: actually I think most of the slowness is with "package" resource installing one at a time
[2012-08-02 20:13:21 -0400] miah: but, it comes down to cookbook quality
[2012-08-02 20:13:23 -0400] xdg: Jay_Levitt, what is slow?  Communications to server?  Or local chef run
[2012-08-02 20:13:46 -0400] Jay_Levitt: xdg: how could I tell?  I was wondering if it ends up communicating with the server for each operation
[2012-08-02 20:13:47 -0400] miah: Jay_Levitt: ya. well. the problem is that you probably haven't had yum invoke 'makecache' yet
[2012-08-02 20:13:57 -0400] Jay_Levitt: miah: and I never will on this ubuntu box :)
[2012-08-02 20:14:02 -0400] miah: ah
[2012-08-02 20:14:03 -0400] xdg: Jay_Levitt, no, it pulls all the info/cookbooks then runs locally
[2012-08-02 20:14:04 -0400] dyer: So here is my approach so far, I have provisioning_api::mysql which right now pretty much just has an include_recipe "mysql::server".  In the attribute file for provisioning_api I am setting the password from my data bag.  My node's run list is just "recipe["provisioning_api::mysql"] and it seems to be using the passwords randomly generated from OpenSSL.  Shouildnt it be using the passwords set in my provsioning_api cookbook instead?
[2012-08-02 20:14:06 -0400] miah: there is a similar issue with apt
[2012-08-02 20:14:09 -0400] Jay_Levitt: xdg: ah, ok.
[2012-08-02 20:14:22 -0400] miah: the apt recipe has a cache update iirc
[2012-08-02 20:14:28 -0400] Jay_Levitt: I was also just getting frustrated at the timeouts every :00 and :30 while I'm developing
[2012-08-02 20:14:36 -0400] xdg: miah, really?  cringe.
[2012-08-02 20:14:38 -0400] miah: and you need to make sure that runs early on, else it goes slow because it recaches on every run
[2012-08-02 20:15:43 -0400] miah: https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb
[2012-08-02 20:15:49 -0400] miah: see, it does updates and what not early on
[2012-08-02 20:15:59 -0400] dyer: Here is the two files I am talking about https://gist.github.com/4b97b28911fc50c0ddc1.  The first one is the mysql recipe ( mysql::server )  and the second one is provisioning_api::mysql
[2012-08-02 20:16:09 -0400] Jay_Levitt: ah! I didn't realize the cacher-ng would do that, I thought it was some type of "run a local repo to serve your network" thing
[2012-08-02 20:16:16 -0400] miah: "This recipe should appear first in the run list of Debian or Ubuntu nodes to ensure that the package cache is up to date before managing any package resources with Chef."
[2012-08-02 20:16:22 -0400] miah: you dont need cacher-ng
[2012-08-02 20:16:32 -0400] miah: that does run a local repo ya. just make sure you run the default.rb
[2012-08-02 20:16:37 -0400] Jay_Levitt: I do already
[2012-08-02 20:16:45 -0400] miah: where in your runlist though?
[2012-08-02 20:17:03 -0400] Jay_Levitt: first
[2012-08-02 20:17:26 -0400] miah: miketheman: it deals with some dirs that don't exist on rhel, and the way it saves iptables rules isn't really compatible with rhel init scripts.
[2012-08-02 20:17:31 -0400] Jay_Levitt: yet my chef-client runs seem to take about 1/3 second per package to discover that it's already installed.
[2012-08-02 20:17:42 -0400] miah: weird
[2012-08-02 20:17:50 -0400] miah: are you doing 'update' or 'install' on the packages in question?
[2012-08-02 20:18:15 -0400] Jay_Levitt: install
[2012-08-02 20:18:23 -0400] miah: thats strange then
[2012-08-02 20:18:28 -0400] xdg: Jay_Levitt, small RAM?  Are you swapping?
[2012-08-02 20:18:45 -0400] Jay_Levitt: I doubt it, 4GB for a server that does very little so far, but lemme look
[2012-08-02 20:19:37 -0400] Jay_Levitt: nope, I have 3G free
[2012-08-02 20:19:53 -0400] miah: i think we have a local fork of simple_iptables with the fixes..
[2012-08-02 20:20:34 -0400] dwhsix: ugh. I just accidentally deleted node and client entries for a server that exists, any easy way to recover from that?
[2012-08-02 20:21:21 -0400] dyer: dwhsix, can u just delete the pem on the node and register it ?
[2012-08-02 20:22:00 -0400] dwhsix: dyer: /etc/chef/validation.pem, right?
[2012-08-02 20:22:01 -0400] miah: miketheman: ah here it is.. https://github.com/scribd/cookbook-simple-iptables/commits/rhel-compat
[2012-08-02 20:22:10 -0400] miah: i havent looked at the codes yet, david415 did all the work there
[2012-08-02 20:22:49 -0400] dwhsix: actually, no...
[2012-08-02 20:23:23 -0400] Jay_Levitt: here's my 60-second chef run (no-op, nothing's changed) to install some packages, directories, files, postgres and apache: https://gist.github.com/2742b07ced8d695db80b
[2012-08-02 20:24:05 -0400] miketheman: miah: cool, no pull request?
[2012-08-02 20:26:31 -0400] mattray: some useful to me, sharing with others https://github.com/mattray/home-directory/blob/master/bin/nuke
[2012-08-02 20:27:12 -0400] xdg: why is this giving nomethod [] error -> https://github.com/opscode-cookbooks/nginx/blob/master/recipes/ohai_plugin.rb#L22
[2012-08-02 20:27:12 -0400] dyer: dwhsix, why not?
[2012-08-02 20:27:15 -0400] mattray: churning through a lot of machine installs today
[2012-08-02 20:27:23 -0400] xdg: hi, mattray
[2012-08-02 20:27:30 -0400] mattray: xdg: howdy
[2012-08-02 20:27:35 -0400] dwhsix: dyer: well, that caused it to not validate w/ chef server
[2012-08-02 20:28:01 -0400] dwhsix: so I left that there, and just running sudo chef-client -j first-boot.json --environment obanyc_staging
[2012-08-02 20:28:06 -0400] dwhsix: seems to be workign so far...
[2012-08-02 20:28:18 -0400] xdg: I'm guessing the ohai plugin path isn't being set, but I don't know what to do about that
[2012-08-02 20:28:43 -0400] dyer: dwhsix, k
[2012-08-02 20:28:50 -0400] xdg: mattray, http://perlchef.com is up with the presentation, tutorial and screencast
[2012-08-02 20:28:50 -0400] dyer: Anyone have any thoughts on my question ?
[2012-08-02 20:28:56 -0400] miketheman: mattray: cool, but isn't that what this should be doing? http://tickets.opscode.com/browse/KNIFE_EC2-37
[2012-08-02 20:29:17 -0400] mattray: miketheman: these are real machines
[2012-08-02 20:29:32 -0400] mattray: knife baremetal server delete purge :)
[2012-08-02 20:30:03 -0400] mattray: someday soon :)
[2012-08-02 20:30:16 -0400] miketheman: mattray: it'd be nice for either `knife node delete` or client to have the purge option
[2012-08-02 20:32:37 -0400] mattray: yup
[2012-08-02 20:32:43 -0400] mattray: probably a ticket somewhere for that
[2012-08-02 20:32:49 -0400] mattray: but feel free to add one
[2012-08-02 20:36:33 -0400] smw_work: Is it normal to have a hash with your cookbook's name that contains all your config variables for that cookbook?
[2012-08-02 20:37:09 -0400] smw_work: all config is global, right? So using a hash to enforce a namespace is common?
[2012-08-02 20:38:14 -0400] miketheman: miah: that branch of redhat compatibility was merged this morning. http://t.co/rtV6DCt
[2012-08-02 20:38:49 -0400] miah: ah interesting
[2012-08-02 20:39:16 -0400] miah: i didnt know if we had PR'd that or what
[2012-08-02 20:39:18 -0400] jameson: miketheman: oh, I could use that.
[2012-08-02 20:39:32 -0400] jameson: I was planning on locking down the system to be accessible by certain roles
[2012-08-02 20:40:22 -0400] dyer: So I'll try to reword the question..    I have a slimed down version of the community mysql server cookbook in use.  I then have my 'provisioning_api' cookbook which has a mysql recipe.  The mysql recipe pretty much just includes mysql::server.  However the attributes file for provisioning_api does set the password for the mysql cookbook.  Itried to force the order of the cookbook at converge by doing include_attributes "mysql"  however it still seems
[2012-08-02 20:40:23 -0400] dyer:  to think node['mysql']['server_root_password'] is not set and as such the mysql cookbook is using openssl to generate a random one
[2012-08-02 20:41:46 -0400] smw_work: ok, so apparently my question was incredibly stupid. I found the secret code word to get me docs explains config values. "attributes"
[2012-08-02 20:42:01 -0400] smw_work: if you were not already planning to ignore me, please do so ;-)
[2012-08-02 20:42:07 -0400] miah: attributes?
[2012-08-02 20:42:08 -0400] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-08-02 20:42:09 -0400] miah: =)
[2012-08-02 20:42:48 -0400] smw_work: bawt, yes, finding the keyword was the issue, not the docs that relate to it ;-)
[2012-08-02 20:42:57 -0400] miah: i suggest reading
[2012-08-02 20:43:00 -0400] miah: anatomy?
[2012-08-02 20:43:00 -0400] bawt: anatomy is http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-08-02 20:43:19 -0400] jameson: ^ was useful
[2012-08-02 20:43:31 -0400] smw_work: now that I pronounce it in my head...
[2012-08-02 20:44:04 -0400] miah: bot?
[2012-08-02 20:44:11 -0400] miah: ahh. it doesnt have that reference =)
[2012-08-02 20:44:24 -0400] smw_work: :-)
[2012-08-02 20:44:51 -0400] smw_work: miah, well thanks for the help :-P
[2012-08-02 20:45:54 -0400] miketheman: bawt help
[2012-08-02 20:45:54 -0400] bawt: help topics: 10 core modules: auth, basics, config, filters, httputil, irclog, remote, unicode, userdata, wordlist; 10 plugins: botsnack, eightball, karma, keywords, logger, markov, nickserv, seen, time, twitter; 1 plugin ignored: use help ignored plugins to see why (help <topic> for more info)
[2012-08-02 20:46:14 -0400] smw_work: bawt, botsnack
[2012-08-02 20:46:14 -0400] bawt: smw_work: =D
[2012-08-02 20:46:41 -0400] miketheman: anyone here using aws hi1.4xlarge ssd instances yet?
[2012-08-02 20:47:29 -0400] smw_work: miketheman, not yet. I really want to play with those though :-)
[2012-08-02 20:47:47 -0400] miketheman: I'm trying now and getting "insufficient capacity". wat.
[2012-08-02 20:47:59 -0400] smw_work: miketheman, also, shameless chan promotion: you know there is a ##aws on freenode, right?
[2012-08-02 20:48:09 -0400] miah: smw_work: sure
[2012-08-02 20:48:14 -0400] miketheman: hah, yeah, I'll go there and yell at them.
[2012-08-02 20:48:16 -0400] miah: botsnack
[2012-08-02 20:48:22 -0400] miah: forgot about that one
[2012-08-02 20:48:36 -0400] smw_work: miketheman, yell at them?
[2012-08-02 20:48:49 -0400] miketheman: smw_work: yeah, yell.
[2012-08-02 20:48:52 -0400] smw_work: miketheman, there are no official AWS people there ;-)
[2012-08-02 20:48:54 -0400] miketheman: I'm a customer.
[2012-08-02 20:49:32 -0400] smw_work: miketheman, it is unofficial support
[2012-08-02 20:50:41 -0400] miketheman: I submitted a proper case, not gonna yell.
[2012-08-02 20:51:17 -0400] dyer: oh damn, I figured out my issue :)
[2012-08-02 20:53:04 -0400] hoover_damm: bawt, !chat
[2012-08-02 20:53:15 -0400] hoover_damm: err nm
[2012-08-02 20:53:30 -0400] Loof: I've not looked... but if you have a password or key in your config... does that get synced to all of the clients somewhere?
[2012-08-02 20:55:50 -0400] dyer: oh, well maybe I spoke to soon
[2012-08-02 20:56:37 -0400] miah: hrm. hitting a wall..
[2012-08-02 20:56:52 -0400] hoover_damm: smw_work, I'd still be in ##aws but I'm moving people off of the cloud now :)
[2012-08-02 20:57:34 -0400] smw_work: hoover_damm, yeah, I got a new job and only use aws for dev now :-\
[2012-08-02 20:58:01 -0400] hoover_damm: smw_work, It's not bad it's just counter productive
[2012-08-02 20:58:26 -0400] smw_work: hoover_damm, what is?
[2012-08-02 20:58:31 -0400] hoover_damm: the cloud
[2012-08-02 20:58:37 -0400] smw_work: lol
[2012-08-02 20:59:40 -0400] stormerider: dealing with hardware failures is counterproductive :)
[2012-08-02 20:59:58 -0400] cheeseplus: redundancy is redundancy either way
[2012-08-02 21:00:28 -0400] cheeseplus: if you setup hardware properly you'll have just as few issues as the cloud and typically way better performance for the dollar
[2012-08-02 21:00:35 -0400] jameson: so i make a new cb, that will use the iptable cookbook to secure my servers after-boot
[2012-08-02 21:00:57 -0400] miah: yup
[2012-08-02 21:01:23 -0400] jameson: this would let me go after the initial deploy to secure the server by doing add_role
[2012-08-02 21:01:26 -0400] jameson: right?
[2012-08-02 21:01:57 -0400] yfeldblum: cheeseplus, how much more time will that take to accomplish?
[2012-08-02 21:05:31 -0400] cheeseplus: yfeldblum: not any more than setting up and understanding scaling for AWS
[2012-08-02 21:05:53 -0400] cheeseplus: I built out a colo presence in a few days not but a few weeks ago
[2012-08-02 21:06:05 -0400] cheeseplus: and the performance is insanely better
[2012-08-02 21:06:11 -0400] miah: 5
[2012-08-02 21:06:23 -0400] cheeseplus: granted in failure cases there will be issues, but so are there with AWS
[2012-08-02 21:06:51 -0400] cheeseplus: the difference is I can pick the datacenter to ensure better connectivity, failover, etc
[2012-08-02 21:06:54 -0400] miah: feedback appreciated https://github.com/miah/nagios/blob/refactor/libraries/object.rb https://github.com/miah/nagios/blob/refactor/resources/object.rb
[2012-08-02 21:07:37 -0400] hoover_damm: stormerider, redundancy is required in any hosting pattern
[2012-08-02 21:07:39 -0400] yfeldblum: miah, shouldn't the first one be a provider?
[2012-08-02 21:07:50 -0400] cheeseplus: yfeldblum: there are great arguments for both and I'm not anti-AWS at all, I just think there is a bit to much of a love affair with AWS by the masses
[2012-08-02 21:07:52 -0400] miah: yfeldblum: hrm. maybe i did put it in the wrong dir =)
[2012-08-02 21:07:57 -0400] hoover_damm: stormerider, it starts with a simple 30amp circuit and loading the servers on an a/b and not overloading
[2012-08-02 21:08:22 -0400] hoover_damm: stormerider, and actually leaving enough load that if you have a dual psu, and a psu fails or a pdu fails... they can fail over to the other circuit and stay up
[2012-08-02 21:08:24 -0400] cheeseplus: just different types of knowledge and scaling considerations required
[2012-08-02 21:08:44 -0400] stormerider: i guess if you can control your own kickstart for a color, that's one thing, but our DC host handles HW provisioning and we just get to deal with this post-install. working with AMIs is a lot easier to generate clean, reproducable, and replaceable setups in minutes instead of much longer.
[2012-08-02 21:08:45 -0400] cheeseplus: our cabinets have two independent power drops, each with 3 circuits
[2012-08-02 21:08:47 -0400] hoover_damm: stormerider, this makes most people cry when you say only load about 6-8amps on a 15amp circuit
[2012-08-02 21:09:06 -0400] cheeseplus: so that is a lot of failing that has to happen and we have a great colo that has epic uptime
[2012-08-02 21:09:06 -0400] stormerider: colo, not color*
[2012-08-02 21:09:08 -0400] hoover_damm: stormerider, but failover because one of your power drops flip for a moment SUCKS
[2012-08-02 21:09:10 -0400] miah: yfeldblum: ok. problem fixed =)
[2012-08-02 21:09:19 -0400] hoover_damm: stormerider, having it knock both sides out
[2012-08-02 21:09:20 -0400] hoover_damm: is worse
[2012-08-02 21:09:32 -0400] miah: im still not sure how i am going to handle the enslaught of resources -> variables in the template
[2012-08-02 21:10:00 -0400] yfeldblum: miah, prefer either not to use sub-resources in providers, or to use a sub-run-context (https://gist.github.com/d85be145f3ff824ccc07)
[2012-08-02 21:10:21 -0400] hoover_damm: stormerider, my DC host only provides provisioning on their API with their installer
[2012-08-02 21:10:30 -0400] hoover_damm: stormerider, but that does not disclude me from reinstalling our servers via PXE
[2012-08-02 21:10:32 -0400] hoover_damm: stormerider, and we do
[2012-08-02 21:10:55 -0400] hoover_damm: hosting/colo/whatever
[2012-08-02 21:11:02 -0400] stormerider: anyways, most of the stuff im dealing with now is ops or API related setups so not nearly as big a deal was the 100 bare metal boxen i admin..
[2012-08-02 21:11:03 -0400] hoover_damm: we don't actually colo technically
[2012-08-02 21:11:06 -0400] hoover_damm: yet
[2012-08-02 21:11:49 -0400] miah: yfeldblum: hrm. interesting
[2012-08-02 21:12:04 -0400] stormerider: aws has pros and cons, wont argue that, but if a significant chunk of what the user interacts with is the CDN it makes things much easier to manage :)
[2012-08-02 21:12:13 -0400] stormerider: anyways, afk :)
[2012-08-02 21:12:25 -0400] yfeldblum: miah, indeed
[2012-08-02 21:12:26 -0400] hoover_damm: I really wish that everytime badmouth the cloud someone wouldn't try and champion the cloud like they're defending some virgin girl who did nothing wrong
[2012-08-02 21:12:45 -0400] hoover_damm: and it's me that is at fault
[2012-08-02 21:13:01 -0400] Jay_Levitt: Hi!  I'm a data center.  / I'm a cloud instance!
[2012-08-02 21:13:12 -0400] miah: so you're basically grabbing all the resources that are added with that provider and building a new resourcecollection?
[2012-08-02 21:13:21 -0400] hoover_damm: Jay_Levitt, LOL
[2012-08-02 21:13:29 -0400] hoover_damm: Jay_Levitt, we could do that
[2012-08-02 21:14:30 -0400] Jay_Levitt: I have power lines from two utilities coming around both sides of the building. / What's a "building"?
[2012-08-02 21:14:47 -0400] stormerider: hoover_damm: well when you're telling me how to handle eletrical power and i dont even handle the physical provisioning, a few raised eyebrows and disagreement is to be expected...
[2012-08-02 21:15:05 -0400] cheeseplus: I definitely like both for different things, but for guaranteed low latency and internal 10Gbit, I need real hardware :)
[2012-08-02 21:16:01 -0400] hoover_damm: Jay_Levitt, for stuff you care about and you don't want to have to babysit and have it scale like a database
[2012-08-02 21:16:06 -0400] hoover_damm: Jay_Levitt, there's nothing better :)
[2012-08-02 21:16:23 -0400] yfeldblum: miah, in the second file in that gist, it demonstrates basically having a sub-recipe within a provider action
[2012-08-02 21:17:43 -0400] yfeldblum: miah, and the way it works is that it swaps out the run-context for new, empty one inside the block, then converges that sub run-context all within the provider action
[2012-08-02 21:21:25 -0400] dols_: uh, so my chef server's IP address is different, and when i create a new ec2 instance, I get a Bunny::ProtocolError followed by a Merb::ControllerExceptions::Conflict.. seems like something is broke with RabbitMQ then.. but I don't see anything in the logs indicating a rabbitmq problem..
[2012-08-02 21:24:44 -0400] dols_: here's the chef server logs: https://gist.github.com/3240787
[2012-08-02 21:25:44 -0400] qhartman: this cloud vs not discussion is hilarious. You guys all win. :D
[2012-08-02 21:26:26 -0400] cheeseplus: qhartman: I don't think there is really a cloud vs not, right tool for the right job is where I sit
[2012-08-02 21:26:39 -0400] yfeldblum: there's a new meme in town, courtesy of hoover_damm: NoCLOUD
[2012-08-02 21:26:44 -0400] cheeseplus: though, the cloud still runs on hardware so real hardware always win
[2012-08-02 21:26:49 -0400] cheeseplus: wins*
[2012-08-02 21:26:58 -0400] Jay_Levitt: No, it's clouds all the way down
[2012-08-02 21:27:10 -0400] qhartman: cheeseplus, agreed. They are good at different things one will be better than the other depending on your priorities
[2012-08-02 21:27:46 -0400] cheeseplus: for my part in game dev and database stuff, real hardware is still king for our use cases
[2012-08-02 21:27:53 -0400] yfeldblum: https://twitter.com/yfeldblum/status/231139042153074688
[2012-08-02 21:28:13 -0400] miketheman: yfeldblum: nice
[2012-08-02 21:28:22 -0400] cheeseplus: though in our colo we have SmartOS for virtualization and the cloud-esque benefits
[2012-08-02 21:28:39 -0400] cheeseplus: NoSQL on NoCloud
[2012-08-02 21:28:55 -0400] Jay_Levitt: I wonder if you can map-reduce a cloud to make it webscale.
[2012-08-02 21:28:58 -0400] cheeseplus: which is actually exactly what I am doing
[2012-08-02 21:29:15 -0400] cheeseplus: Jay_Levitt: lolz
[2012-08-02 21:29:20 -0400] qhartman: cheeseplus, I do game dev and DB stuff too."It's like we're trying to run 100k CCU DB on circa-2004 laptops with 5400 RPM HDDs."
[2012-08-02 21:29:36 -0400] cheeseplus: hehe
[2012-08-02 21:30:01 -0400] cheeseplus: I think that @crucially's talk at ChefConf made the great case for real hardware
[2012-08-02 21:30:04 -0400] yfeldblum: synchronous cross-region replication is the key to a fast app
[2012-08-02 21:30:17 -0400] cheeseplus: if you have shitty servers, then of course the cloud will be better
[2012-08-02 21:30:26 -0400] evilantnie: If I want to find all nodes of a specific role within a particular environment, do I have to do the environment search and then flip through all the nodes?  or is there a way to get the results from a single search query?
[2012-08-02 21:30:50 -0400] qhartman: search "chef_env:foo AND roles:bar"
[2012-08-02 21:31:08 -0400] cheeseplus: neat
[2012-08-02 21:31:17 -0400] evilantnie: thx
[2012-08-02 21:31:33 -0400] qhartman: sure
[2012-08-02 21:32:15 -0400] leifmadsen: hmmm, so in an attributes file I've seen something like:    default['foo'] = attribute?('cloud') ? cloud['public_hostname'] : fqdn
[2012-08-02 21:32:24 -0400] evilantnie: is that boolean operator available via the rest api?
[2012-08-02 21:32:32 -0400] leifmadsen: however, using that in a recipe does not appear to work due to attribute? not being a resource that exists. Curious if there is an equiv for recipes I can use?
[2012-08-02 21:32:50 -0400] qhartman: evilantnie, oh, depending on what version of chef you're using the "roles" search might not do what you want. If it gives you weird results, try "role" instead.
[2012-08-02 21:32:54 -0400] yfeldblum: leifmadsen, in the attributes file, `self` is `node`
[2012-08-02 21:33:23 -0400] leifmadsen: yfeldblum: sorry, does not compute...
[2012-08-02 21:33:32 -0400] yfeldblum: leifmadsen, if you did `node.default['foo'] = node.attribute?('cloud') ? node.cloud['public_hostname'] : node.fqdn` (prefixing all method calls with `node.`) it would work in a recipe
[2012-08-02 21:33:38 -0400] leifmadsen: ahhhhhhhhh
[2012-08-02 21:33:44 -0400] leifmadsen: yfeldblum: most excellent good sir
[2012-08-02 21:33:57 -0400] leifmadsen: hells ya
[2012-08-02 21:34:05 -0400] leifmadsen: you get a cookie
[2012-08-02 21:34:25 -0400] leifmadsen: or if you drink, if we ever meet at a conference, I owe you beers/wine/liqueurs
[2012-08-02 21:35:23 -0400] evilantnie: @qhartman: totally works, thx
[2012-08-02 21:36:56 -0400] qhartman: evilantnie, good good. hth
[2012-08-02 21:41:18 -0400] jameson: mm
[2012-08-02 21:41:28 -0400] jameson: is there something going on with opscode today?
[2012-08-02 21:41:31 -0400] jameson: I keep getting a
[2012-08-02 21:41:33 -0400] jameson: [Thu, 02 Aug 2012 21:41:06 +0000] FATAL: Net::HTTPServerException: 401 "Unauthorized"
[2012-08-02 21:41:38 -0400] jameson: when i run chef-clienbt
[2012-08-02 21:42:02 -0400] miketheman: no, just you. :)
[2012-08-02 21:42:10 -0400] jameson: >_<
[2012-08-02 21:42:47 -0400] qhartman: You might see something like that if you have a bad recipe or role defined on a node
[2012-08-02 21:43:06 -0400] qhartman: If I'm remembering correctly anyway, that error rings a bell.
[2012-08-02 21:43:46 -0400] jameson: mm thanks.. I will look at my recipes again :| vagrant didn't complain just now ~_~
[2012-08-02 21:44:15 -0400] smw_work: hi all, I am trying to run $ sudo chef-solo -o "role[webserver]" and I have a file in my role_path named "webserver.rb". How can I troubleshoot this?
[2012-08-02 21:44:28 -0400] smw_work: ERROR: Role webserver is in the runlist but does not exist. Skipping expand.
[2012-08-02 21:45:19 -0400] jameson: rake roles ?
[2012-08-02 21:45:22 -0400] jameson: oh wait
[2012-08-02 21:45:24 -0400] jameson: chef-solo
[2012-08-02 21:45:25 -0400] jameson: :X
[2012-08-02 21:45:29 -0400] dyer: Question, How do I actually "load" the database cookbook in order to use the LWRP's ?  In my recipe I did a "include_recipe[database]" but it not working.. I am getting a undefined method `mysql_database' f
[2012-08-02 21:46:39 -0400] qhartman: dyer, make sure the default recipe makes them available. the CPAN recipe for example has a special bootstrap recipe you need to reference. The readme for the cookbook should explain
[2012-08-02 21:47:17 -0400] smw_work: jameson, found the problem :-)
[2012-08-02 21:47:43 -0400] yfeldblum: dyer, stick `depends "database"` into the calling cookbook's metadata.rb
[2012-08-02 21:47:47 -0400] dyer: ah
[2012-08-02 21:47:49 -0400] dyer: ok
[2012-08-02 21:47:51 -0400] dyer: that helps
[2012-08-02 21:50:25 -0400] dyer: yfeldblum, ok got further that time
[2012-08-02 21:50:45 -0400] dyer: hrm, seems to be freaking out that mysql gem is missing
[2012-08-02 21:51:36 -0400] miah: guh. frustrating.
[2012-08-02 22:04:40 -0400] smw_work: how can I set the default ruby chef cookbooks use?
[2012-08-02 22:04:52 -0400] jameson: found my problem :X looks like chef-client is smart enough to notice that I had errors in my cookbook when it ran the 2nd time and hasn't decided not to do anything unless i update the cb.
[2012-08-02 22:05:02 -0400] jameson: smw_work: make it your defaul ruby
[2012-08-02 22:05:03 -0400] smw_work: I change /usr/bin/ruby using update-alternatives, but it was ignored :-\
[2012-08-02 22:05:12 -0400] jameson: do
[2012-08-02 22:05:13 -0400] jameson: ruby -v
[2012-08-02 22:05:24 -0400] smw_work: jameson, ruby 1.9.3p0
[2012-08-02 22:05:28 -0400] smw_work: (this is correct)
[2012-08-02 22:05:41 -0400] smw_work: /etc/apache2/mods-available/passenger.conf:PassengerRuby /usr/bin/ruby1.8
[2012-08-02 22:05:45 -0400] dyer: Anyone know why I would be getting socket errors when connecting to my chef server?  Seems to be intermittent, but i know for sure that the request is actually hitting the chef server because i see it in the server log  the SocketError happens in Shef -z and in chef-client   ( logs https://gist.github.com/b201b9f3a40a00d5d41e )
[2012-08-02 22:05:54 -0400] smw_work: using the passenger_apache2 cookbook
[2012-08-02 22:06:05 -0400] jameson: smw_work: that looks hardcoded.
[2012-08-02 22:06:16 -0400] smw_work: jameson, I am very new to chef, can you help me find where it is hard coded? I could not find it
[2012-08-02 22:06:50 -0400] jameson: looks to be either in the template/ or files/ in the cookbook
[2012-08-02 22:06:56 -0400] smw_work: jameson, ruby1.8 shows up no where in the source
[2012-08-02 22:07:12 -0400] smw_work: therefore, it is generating it using some magic beyond my understanding :-\
[2012-08-02 22:07:40 -0400] smw_work: default[:passenger][:root_path]   = "#{languages[:ruby][:gems_dir]}/gems/passenger-#{passenger[:version]}
[2012-08-02 22:07:56 -0400] smw_work: that looks promising, but what generates languages[:ruby]?
[2012-08-02 22:08:04 -0400] jameson: probably the local install of chef
[2012-08-02 22:08:09 -0400] jameson: (on the deployed instance)
[2012-08-02 22:08:21 -0400] smw_work: why is chef doing this? can I override?
[2012-08-02 22:08:40 -0400] jameson: :X
[2012-08-02 22:08:58 -0400] jameson: I know there are people who install ruby with chef
[2012-08-02 22:09:23 -0400] flaccid: i wrote a cookbook for that
[2012-08-02 22:10:05 -0400] flaccid: https://github.com/flaccid/cookbooks/tree/master/cookbooks/ruby
[2012-08-02 22:10:59 -0400] smw_work: flaccid, I made my own recipe to install ruby. How can I override where passenger_apache2 is looking?
[2012-08-02 22:11:38 -0400] smw_work: this is what I have so far: http://fpaste.org/XsdA/
[2012-08-02 22:12:25 -0400] flaccid: sorry i don't get the question
[2012-08-02 22:13:05 -0400] smw_work: flaccid, for some reason all of chef is still using 1.8 when I also have 1.9 installed
[2012-08-02 22:13:24 -0400] flaccid: GEM_HOME and GEM_PATH
[2012-08-02 22:13:48 -0400] smw_work: how do I set that? I am very new to chef
[2012-08-02 22:14:15 -0400] flaccid: its a rubygems thing that says where the gems are and is in the rubygems doc. they are just env vars
[2012-08-02 22:14:59 -0400] smw_work: flaccid, the issue is it is not using the ruby executables in /usr/bin
[2012-08-02 22:15:07 -0400] flaccid: i guess the update-alternatives not working
[2012-08-02 22:15:12 -0400] smw_work: it is working
[2012-08-02 22:15:17 -0400] smw_work: chef is ignoring /usr/bin
[2012-08-02 22:15:21 -0400] flaccid: oh sorry i read gems at the end of that, man i'm just waking up
[2012-08-02 22:15:39 -0400] flaccid: huh you talking about using ruby in chef?
[2012-08-02 22:15:58 -0400] smw_work: one sec
[2012-08-02 22:16:46 -0400] flaccid: i will make a coffee so i don't misread things
[2012-08-02 22:16:46 -0400] smw_work: flaccid, I am using this cookbook: http://community.opscode.com/cookbooks/passenger_apache2/source
[2012-08-02 22:17:11 -0400] smw_work: flaccid, in my run list, I run the following recipe before it: http://fpaste.org/XsdA/
[2012-08-02 22:17:20 -0400] smw_work: that recipe works without a problem
[2012-08-02 22:17:37 -0400] smw_work: but then passenger_apache2 seems to use the ruby 1.8 executables
[2012-08-02 22:17:58 -0400] smw_work: the gem is installed to the 1.8 dir. And the config files all point to ruby1.8
[2012-08-02 22:18:07 -0400] smw_work: instead of /usr/bin/ruby
[2012-08-02 22:20:01 -0400] smw_work: gem_package "passenger" <--- the chef (provider?) is using ruby1.8 and I don't know how to tell it otherwise
[2012-08-02 22:22:41 -0400] flaccid: oh right i guess thats how the cookbooks is designed then
[2012-08-02 22:22:50 -0400] flaccid: maybe that can be considerd a bug
[2012-08-02 22:23:47 -0400] jameson: so..
[2012-08-02 22:23:52 -0400] jameson: what is with knife client list..
[2012-08-02 22:23:58 -0400] jameson: it ignores --environment
[2012-08-02 22:24:28 -0400] smw_work: flaccid, it is not a bug in the cookbook
[2012-08-02 22:25:25 -0400] smw_work: flaccid, the gem_package resource is not in the cookbook
[2012-08-02 22:25:37 -0400] smw_work: is not defined in the cookbook*
[2012-08-02 22:25:48 -0400] erratic: wa wa wa
[2012-08-02 22:26:16 -0400] smw_work: I am completely new to chef of course, so I could be wrong
[2012-08-02 22:26:24 -0400] smw_work: erratic, ?
[2012-08-02 22:27:31 -0400] flaccid: i'd have to look into it more closely to see where the bug/hard code is
[2012-08-02 22:27:40 -0400] hoover_damm: smw_work, how are you installing ruby?
[2012-08-02 22:28:15 -0400] smw_work: hoover_damm, I am installing chef from the opscode repo which also installs ruby1.8 from the package manager
[2012-08-02 22:28:28 -0400] smw_work: hoover_damm, I am then running the following recipe during the chef solo run: http://fpaste.org/XsdA/
[2012-08-02 22:28:33 -0400] hoover_damm: smw_work, well chef has a 'bootstrap' template
[2012-08-02 22:28:43 -0400] hoover_damm: smw_work, you can modify that template and what it runs
[2012-08-02 22:28:55 -0400] erratic: smw_work my brain is so fried
[2012-08-02 22:29:03 -0400] erratic: Ive been hacking on selenium and php and chef all morning
[2012-08-02 22:29:09 -0400] erratic: also had to run out for an appt
[2012-08-02 22:29:30 -0400] smw_work: hoover_damm, right now my idea is to install chef from the gem instead of package
[2012-08-02 22:29:47 -0400] hoover_damm: smw_work, so if you did --template ubuntu12.04-gems you'd install ruby 1.8
[2012-08-02 22:29:53 -0400] smw_work: then I would need to install ruby1.9.1 manually... but it would most likely work
[2012-08-02 22:29:58 -0400] smw_work: hoover_damm, I didn't
[2012-08-02 22:29:59 -0400] hoover_damm: smw_work, in order to fix that you'd need to modify the template to do it this way
[2012-08-02 22:30:09 -0400] hoover_damm: patience
[2012-08-02 22:30:14 -0400] smw_work: hoover_damm, I am using chef solo. All I did was install the repo and install chef
[2012-08-02 22:30:21 -0400] erratic: its really hard to go from coding C# back to coding PHP
[2012-08-02 22:30:21 -0400] smw_work: hoover_damm, sorry :-(
[2012-08-02 22:31:19 -0400] chrisstreeter: Using the deploy_resource resource, is there a way to prevent it from always doing a deploy on a chef run? Basically, I want to be able to use the :checkout action with the underlying scm resource, instead of the :sync action. Any thoughts?
[2012-08-02 22:31:25 -0400] hoover_damm: smw_work, no worries just was trying to get to my point which is you need a custom bootstrap like https://www.refheap.com/paste/a95e464431fd0c14b7ff040b8
[2012-08-02 22:31:53 -0400] hoover_damm: smw_work, you'd drop that in .chef/bootstraps as say ubuntu-ruby191.erb
[2012-08-02 22:31:56 -0400] smw_work: hoover_damm, then I need to stop using chef solo
[2012-08-02 22:32:01 -0400] hoover_damm: smw_work, bootstrap
[2012-08-02 22:32:12 -0400] smw_work: bootstrap works with chef-solo?
[2012-08-02 22:32:24 -0400] dyer: Argh, I am so confused right now on this socket error I just ran chef-client on another node, which is in the same environment, and it works fine
[2012-08-02 22:32:25 -0400] beandip: Anyone using logstash recipes?
[2012-08-02 22:32:25 -0400] hoover_damm: smw_work, you can remove the start_chef call
[2012-08-02 22:32:45 -0400] hoover_damm: smw_work, or you can modify the bootstrap to be what you want?
[2012-08-02 22:32:52 -0400] hoover_damm: smw_work, I don't know if that's the wrong rabbit hole
[2012-08-02 22:33:12 -0400] smw_work: hoover_damm, it looks like a rabbit hole I don't want to go down today.
[2012-08-02 22:33:44 -0400] smw_work: hoover_damm, I will keep what you said in mind for the future :-)
[2012-08-02 22:34:20 -0400] dyer: Not sure why its getting a ScoketTimeout I can telnet  to the host from the problem node without any issues
[2012-08-02 22:34:28 -0400] dyer: anyone ever run into something like this ?
[2012-08-02 22:34:41 -0400] smw_work: hoover_damm, and what scares me about that is not making my own bootstrap script. It is learning bootstrapping ;-)
[2012-08-02 22:35:43 -0400] dyer: Here are the logs of what I am running into again, incase anyone cares to take a look ( https://gist.github.com/b201b9f3a40a00d5d41e ).  Thanks
[2012-08-02 22:36:24 -0400] erratic: http://www.youtube.com/watch?v=YM-qjsuJItc
[2012-08-02 22:36:40 -0400] beandip: hmm
[2012-08-02 22:36:42 -0400] beandip: ArgumentError: invalid timing: notification_timing for notifies(create_if_missing, ["template[/etc/profile.d/jruby.sh]"], notification_timing) resource install_from_release[jruby] Valid timings are: :delayed, :immediate, :immediately
[2012-08-02 22:36:57 -0400] beandip: anyone run into this?
[2012-08-02 22:37:17 -0400] jtimberman: smw_work: the bootstrap is merely getting chef installed and configured to talk to the right chef server, but that doesn't mean you can't use solo instead.
[2012-08-02 22:38:43 -0400] smw_work: jtimberman, yeah. My biggest issue is that chef is a really tough thing to get into. I have tried before and never made it far. I am now attempting to avoid everything not essential to configuring a server.
[2012-08-02 22:39:47 -0400] smw_work: jtimberman, I am making much more progress now then when I have tried before. Before I spent so much time figuring out setting up all the extra stuff and never figured out the parts that matter
[2012-08-02 22:39:55 -0400] biffhero: I presume you all have /usr/bin/chef-solr installed?  My install didn't do that.
[2012-08-02 22:40:30 -0400] smw_work: jtimberman, also, your cookbooks are awesome. Thanks :-)
[2012-08-02 22:58:02 -0400] chrisstreeter: Using the deploy_resource resource, is there a way to prevent it from always doing a deploy on a chef run? Basically, I want to be able to use the :checkout action with the underlying scm resource, instead of the :sync action. Any thoughts?
[2012-08-02 23:04:58 -0400] smw_work: for anyone who is interested: the probable reason it was using ruby1.8 is that when it installs gems, it uses the API instead of the gem executable. By install chef in the version of ruby I want to use for my applications, it worked.
[2012-08-02 23:05:34 -0400] smw_work: This forced me to give up using the ubuntu packages for chef, but I will live :-)
[2012-08-02 23:29:14 -0400] hoover_damm: smw_work, chef deb?
[2012-08-02 23:30:15 -0400] smw_work: hoover_damm, yeah, I installed chef from a debian package repo
[2012-08-02 23:31:11 -0400] hoover_damm: smw_work, ahhh that explains it
[2012-08-02 23:31:42 -0400] hoover_damm: smw_work, there's 3 different ways to install Chef.  Via rubygems, via deb (like you did) and via omnibus
[2012-08-02 23:31:58 -0400] smw_work: I am now using the gem way. It works :-)
[2012-08-02 23:32:09 -0400] hoover_damm: smw_work, omnibus or chef-full is a deb that throws it in /opt/opscode and it's actually pretty sexy
[2012-08-02 23:32:27 -0400] hoover_damm: smw_work, you still need system ruby for ruby crap right?
[2012-08-02 23:32:40 -0400] smw_work: yes
[2012-08-02 23:35:33 -0400] hoover_damm: smw_work, omnibus could give you chef-solo and then you could use chef to install the rest :)
[2012-08-02 23:37:14 -0400] smw_work: the issue is chef using its own ruby to install gems and all the ruby variables (attributes?) that I don't quite understand
[2012-08-02 23:38:22 -0400] hoover_damm: chef_gem was added in 0.10.12 to handle installing gems in the embedded i believe
[2012-08-02 23:38:30 -0400] hoover_damm: then regular gem should be able to hit the system 'gem' command
[2012-08-02 23:39:27 -0400] smw_work: not sure, I was using the gem_package resource
[2012-08-02 23:39:47 -0400] smw_work: so was jtimberman in passenger_apache2
[2012-08-02 23:41:39 -0400] biffhero: [4:31] <hoover_damm> smw_work, there's 3 different ways to install Chef. Via rubygems, via deb (like you did) and via omnibus <<< I claim that omnibus doesn't work  (I am failing on the chef-solr-installer now)
[2012-08-02 23:42:51 -0400] hoover_damm: biffhero, chef-client... not server
[2012-08-02 23:43:12 -0400] hoover_damm: biffhero, the omnibus server is available via beta I have heard
[2012-08-02 23:43:12 -0400] biffhero: hoover_damm: ah, right.
[2012-08-02 23:43:21 -0400] hoover_damm: but I have no details on that except email adam
[2012-08-02 23:44:15 -0400] biffhero: this is the one that is failing for me.
[2012-08-02 23:44:18 -0400] biffhero: http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo
[2012-08-02 23:45:13 -0400] hoover_damm: biffhero, run the bootstrap in debug and post the failure on gist?
[2012-08-02 23:45:16 -0400] hoover_damm: biffhero, gist.github.com
[2012-08-02 23:45:28 -0400] hoover_damm: biffhero, chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz -l debug
[2012-08-02 23:45:32 -0400] biffhero: How do I run it in debug? ah, thanks.
[2012-08-02 23:45:40 -0400] biffhero: I was keepign my info and updating a bug that matches.
[2012-08-02 23:45:59 -0400] biffhero: http://tickets.opscode.com/browse/CHEF-2508
[2012-08-02 23:46:38 -0400] hoover_damm: dyer, dns issue?
[2012-08-02 23:52:53 -0400] dyer: hoover_damm, I don't see how
[2012-08-02 23:53:02 -0400] dyer: I can curl from the box
[2012-08-02 23:53:17 -0400] dyer: I can telnet to the chef servers http port
[2012-08-02 23:53:36 -0400] dyer: unless chef is using another resolver somehow...
[2012-08-02 23:54:59 -0400] dyer: FML, how is that even possible I added the entry to the host file and now it working
[2012-08-02 23:55:02 -0400] dyer: I don't get it
[2012-08-02 23:55:31 -0400] dyer: how could curl, telnet, dig, ping, ect all work, but net/http fail to resolve ?
[2012-08-02 23:56:58 -0400] hoover_damm: dyer, seems befouled
[2012-08-02 23:57:12 -0400] dyer: Yea, ___king odd
[2012-08-02 23:57:26 -0400] hoover_damm: dyer, the timeout's in the stack trace are interesting
[2012-08-02 23:57:38 -0400] Randm: dyer: nsswitch?
[2012-08-02 23:57:56 -0400] dyer: not familiar w/ nsswitch
[2012-08-02 23:58:23 -0400] Randm: net/http might be using a different resolver from the system one?
