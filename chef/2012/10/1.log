[2012-10-01 00:53:42 -0400] zts: 'morning
[2012-10-01 01:03:27 -0400] z: https://github.com/opscode-cookbooks/bluepill/blob/master/providers/service.rb#L56
[2012-10-01 01:03:41 -0400] z: Any guesses on why that relies on @current_resource.running?
[2012-10-01 01:03:57 -0400] z: Since it can be rather helpful to update the pill to reflect new resource monitoring bits whilst the supervised process is up
[2012-10-01 01:05:20 -0400] z: my logic goes that if you want to update your application, thats a :restart .. if you update the pill template, thats a :load .. and both need to actually take effect within a reasonable timeframe .. ?
[2012-10-01 01:12:04 -0400] zts: I know nothing about bluepill, but looking at that code I would assume it's invalid or dangerous to use "bluepill load" on something that's running.  If that's untrue, I guess it's a bug
[2012-10-01 01:14:16 -0400] z: zts: Its not particularly dangerous, bluepill will just resume monitoring the existing application process if you [re]load it
[2012-10-01 01:14:38 -0400] z: zts: In almost all cases, I concede, you probably want to load and then restart (to be sure you catch any start_command alterations)
[2012-10-01 01:14:52 -0400] z: zts: But the way the Provider is set today, you would have to :stop, :load, :start
[2012-10-01 01:15:05 -0400] z: zts: that seems a lot like hard work ;-)
[2012-10-01 01:22:04 -0400] zts: z: fair play :)  Well, you could try asking jtimberman or fujin when they're around, otherwise I'd suggest opening a ticket in the COOK project
[2012-10-01 01:22:54 -0400] z: zts: cool :-)
[2012-10-01 01:46:17 -0400] greenail: hello
[2012-10-01 01:46:22 -0400] greenail: anyone not idle?
[2012-10-01 01:47:02 -0400] greenail: having trouble with deploy and symlink errors
[2012-10-01 01:49:46 -0400] williamherry: morning
[2012-10-01 01:51:38 -0400] greenail: hello
[2012-10-01 01:54:36 -0400] greenail: can someone direct me to a verbose example of using a github deploy key?
[2012-10-01 01:54:41 -0400] greenail: i'm really not having an easy time
[2012-10-01 01:54:58 -0400] greenail: i have the "deploy" working with the ssh wrapper, but it fails with a symlink error
[2012-10-01 01:55:19 -0400] greenail: it grab the private repo, but all i really need is a simple clone
[2012-10-01 01:55:32 -0400] greenail: extremee frustration abounds
[2012-10-01 02:45:33 -0400] erratic: druqs
[2012-10-01 03:44:11 -0400] jassinpain: anyone ever seen a issue where post knife index rebuild all searchs are empty?
[2012-10-01 03:50:01 -0400] zts: jassinpain: are you running your own chef server?
[2012-10-01 03:50:08 -0400] jassinpain: yes
[2012-10-01 03:50:20 -0400] jassinpain: wsa trying to address http://tickets.opscode.com/browse/CHEF-2346
[2012-10-01 03:50:44 -0400] jassinpain: did it once before but a chef upgrade overwrote the changed
[2012-10-01 03:50:53 -0400] zts: jassinpain: can you check on your chef server that chef-expander is running okay?
[2012-10-01 03:52:04 -0400] jassinpain: server appears to be running fine, able to complet a chef run just fine
[2012-10-01 03:52:11 -0400] jassinpain: looks correct
[2012-10-01 03:52:28 -0400] jassinpain: not sure how to check expander as the log is empty
[2012-10-01 03:52:45 -0400] zts: jassinpain: you can complete a chef run without chef-expander running, it is the part that is responsible for taking updates and pushing them into the search index
[2012-10-01 03:53:51 -0400] jassinpain: appears to be running but odd that log file is empty /usr/bin/ruby1.8 /usr/bin/chef-expander -d -c /etc/chef/solr.rb -P /var/run/chef/expander.pid -L /var/log/chef/expander.log -n 1 -i 1
[2012-10-01 03:55:02 -0400] zts: mine is empty too, just trying a reindex to see what should appear
[2012-10-01 03:55:04 -0400] zts: (if anything)
[2012-10-01 03:56:23 -0400] jassinpain: I ran knife index rebuild -V all status said success
[2012-10-01 04:08:45 -0400] zts: do you see anything in /var/log/chef/solr.log when you do the rebuild?
[2012-10-01 04:09:08 -0400] zts: (I don't get anything in expander.log when I do that, either, so that seems to be fine)
[2012-10-01 04:14:22 -0400] jassinpain: checking
[2012-10-01 04:18:10 -0400] jassinpain: dont see errors
[2012-10-01 04:18:12 -0400] jassinpain: https://gist.github.com/3809444
[2012-10-01 04:26:26 -0400] retr0h: jassinpain: and you made the changes in CHEF-2346?
[2012-10-01 04:27:58 -0400] jassinpain: <maxFieldLength>200000</maxFieldLength> line 53 & 107
[2012-10-01 04:28:08 -0400] jassinpain:  /var/lib/chef/solr/conf/solrconfig.xml
[2012-10-01 04:28:52 -0400] retr0h: jassinpain: ok...  my config was located /var/lib/chef/solr/home/conf/solrconfig.xml but I didn't chef via gems install
[2012-10-01 04:29:00 -0400] retr0h: but I did*
[2012-10-01 04:29:09 -0400] jassinpain: yea this is deb install
[2012-10-01 04:29:16 -0400] jassinpain: that location is empty
[2012-10-01 04:29:22 -0400] retr0h: and
[2012-10-01 04:29:40 -0400] retr0h: after the change I restarted everything - chef-server, solr, expander etc.. then did the `knife index rebuild`
[2012-10-01 04:30:23 -0400] retr0h: I had problems where servers would check in and run fine... but searches would respond w/o data on different hosts.. one day may have the data another time may not
[2012-10-01 04:31:39 -0400] zts: retr0h: to be honest with you, I'm not entirely sure what to look for in the solr log.  I think the actual update activity will be further up from the part you pasted though - perhaps check a bit further back for errors
[2012-10-01 04:31:44 -0400] zts: retr0h: but I'm out of ideas, sorry :(
[2012-10-01 04:32:05 -0400] jassinpain: yea I even rebooted just to be 100%
[2012-10-01 04:33:00 -0400] retr0h: jassinpain: did you have a bunch of custom ohai plugins?
[2012-10-01 04:33:16 -0400] jassinpain: none
[2012-10-01 04:33:38 -0400] retr0h: very odd... seems unrelated to 2346 then... :/
[2012-10-01 04:34:40 -0400] jassinpain: yea not related, I was having search issues and thats why I increased
[2012-10-01 04:34:47 -0400] jassinpain: after index all life sucks
[2012-10-01 04:37:13 -0400] d-rock1: Even more hair-tearing-out over here. Chef server 10.14.4 runs at 80% CPU when idle, client checkins take upward of 2 minutes (or time out), knife node list takes 10-20 seconds. All this with 50 nodes total. Yesterday everything was fine and as far as I know nothing changed other than a reboot of the server
[2012-10-01 04:37:39 -0400] jassinpain: ouch
[2012-10-01 04:37:45 -0400] d-rock1: I upgraded ruby to 1.9.2 (using RVM) and that seems to have helped a bit (on ruby 1.8.7 the service timed out on everything)
[2012-10-01 04:38:08 -0400] d-rock1: The server.log indicates that actions are taking < 1s (if I'm reading it right), so I'm at a loss
[2012-10-01 04:38:17 -0400] d-rock1: I've compacted couch, rebuilt solr index, etc
[2012-10-01 04:39:06 -0400] jassinpain: on the log file, I redid the index while tailing the solr log and the gist was complete
[2012-10-01 04:39:26 -0400] retr0h: d-rock1: which process is eating up all your cpu?
[2012-10-01 04:39:38 -0400] d-rock1: retr0h: merb
[2012-10-01 04:40:09 -0400] retr0h: d-rock1: maybe for SNGs install newrelic see if it can give you hints as to the problem
[2012-10-01 04:40:23 -0400] retr0h: at least you will get an idea of where inside the app its slow
[2012-10-01 04:40:30 -0400] d-rock1: retr0h: strace reveals an awful lot of "stat(/etc/localtime,) and clock_gettime(..."
[2012-10-01 04:40:56 -0400] d-rock1: I'll check newrelic
[2012-10-01 04:41:24 -0400] retr0h: yah but that could just be merb... i've always had a hard time debugging ruby processes with the usual strace methods :(
[2012-10-01 04:41:30 -0400] d-rock1: Yeah
[2012-10-01 04:42:08 -0400] d-rock1: Just to clarify, when I see server.log entries like "{:before_filters_time=>0.008592223, :after_filters_time=>1.4461e-05, :action_time=>0.028932574, :dispatch_time=>0.029603327}"
[2012-10-01 04:42:20 -0400] d-rock1: That means it took about 0.05 s total, right?
[2012-10-01 04:44:54 -0400] retr0h: it's been a while since I looked at merb logs, granted rails logs do report similar things.. I would expect those to be telling you the time it took to deal with before/after filters in the controllers and the time to perform the action inside the controller
[2012-10-01 04:45:09 -0400] retr0h: so the after_filter to me looks to be slow
[2012-10-01 04:45:43 -0400] retr0h: in contrast to the others..
[2012-10-01 04:45:53 -0400] d-rock1: That's e-05
[2012-10-01 04:45:57 -0400] d-rock1: So less than the others
[2012-10-01 04:46:28 -0400] d-rock1: 0.00001446
[2012-10-01 04:49:56 -0400] d-rock1: I wish I had a higher-level view of what was going on in merb. All I see in logs are individual REST calls, which don't tell a complete picture
[2012-10-01 04:50:08 -0400] retr0h: d-rock1: try new-relic
[2012-10-01 04:50:20 -0400] retr0h: it will give you exactly what you want and I think u acn try it for free
[2012-10-01 04:50:43 -0400] retr0h: u will know exactly which controller and action are slowing you down and why
[2012-10-01 04:50:57 -0400] d-rock1: Cool, I'll check it out
[2012-10-01 04:53:43 -0400] retr0h: thx for pointing out the e-05 (those long lines don't look to be taking to long then)
[2012-10-01 04:53:50 -0400] retr0h: log*
[2012-10-01 04:57:53 -0400] d-rock1: Yeah, this is a bizarre one. I'll check out newrelic but it's definitely making me miss JVM tooling ;)
[2012-10-01 07:06:31 -0400] ichilton: zts: hi
[2012-10-01 07:06:58 -0400] zts: hiya :)
[2012-10-01 07:07:18 -0400] ichilton: the permission denied is a curious one - I just did a -l debug and it's not clear what it's doing
[2012-10-01 07:07:29 -0400] zts: I'm just loading your pastebin now, one second
[2012-10-01 07:07:47 -0400] ichilton: thanks
[2012-10-01 07:08:09 -0400] ichilton: pastebin seems slow this morning
[2012-10-01 07:08:20 -0400] ichilton: Here is some debug before that permission denied: http://pastie.org/4889816
[2012-10-01 07:08:44 -0400] ichilton: although it seems to continue anyway, so I think my immediate problem is how to add the roles to the node so it gets a runlist
[2012-10-01 07:09:07 -0400] Mithrandir: ichilton: just put run_list: "role[foo]" in the node
[2012-10-01 07:09:23 -0400] Mithrandir: role[foo] for that role, recipe[bar] for a recipe.
[2012-10-01 07:09:24 -0400] ichilton: Mithrandir: where is the node?
[2012-10-01 07:09:34 -0400] Mithrandir: knife node edit $fqdn
[2012-10-01 07:09:49 -0400] ichilton: i've just crafted a simple chef-repo with cookbooks/homebrew and roles/mac_os_x / roles/workstation
[2012-10-01 07:09:58 -0400] zts: ichilton: what chef server are you using?
[2012-10-01 07:10:04 -0400] zts: the Opscode Hosted one, or something else?
[2012-10-01 07:10:12 -0400] Mithrandir: that permission denies looks like you're not running chef as root
[2012-10-01 07:10:13 -0400] ichilton: zts: opscode hosted
[2012-10-01 07:10:24 -0400] ichilton: i'm not - running it as my user ala jtimberman
[2012-10-01 07:10:40 -0400] ichilton: following this, just not with his chef-repo --> http://jtimberman.housepub.org/blog/2012/07/29/os-x-workstation-management-with-chef/
[2012-10-01 07:10:41 -0400] zts: okay, do: "knife node list" and you should see a list of nodes registered with the server
[2012-10-01 07:10:46 -0400] zts: probably, one of them will be "Ians-MacBook-Pro.local"
[2012-10-01 07:11:02 -0400] ichilton: correct
[2012-10-01 07:11:03 -0400] zts: if so, you can add a role to it with:  knife node run list add Ians-MacBook-Pro.local "role[foo]"
[2012-10-01 07:11:24 -0400] zts: or, as Mithrandir says, you can do "knife node edit Ians-MacBook-Pro.local" to get a JSON document with a bunch of things you can change
[2012-10-01 07:11:36 -0400] zts: one of them is the run list, and that's also where you'd add "role[foo]"
[2012-10-01 07:11:58 -0400] ichilton: yay, thanks - looks like it's working
[2012-10-01 07:12:39 -0400] ichilton: ah, looks like homebrew installs git
[2012-10-01 07:12:43 -0400] ichilton: and needs developer tools
[2012-10-01 07:12:47 -0400] ichilton: so it failed
[2012-10-01 07:13:07 -0400] ichilton: i've already got xcode installing in the background so will wait until that finishes
[2012-10-01 07:13:19 -0400] ichilton: thanks to you both :)
[2012-10-01 07:13:35 -0400] zts: no problem, good luck with it :)
[2012-10-01 07:13:48 -0400] ichilton: any idea how I can find out what the permission denied is from?
[2012-10-01 07:14:05 -0400] ichilton: I ran with -l debug  -> http://pastie.org/4889816
[2012-10-01 07:14:29 -0400] ichilton: I own /etc/chef and ~/.chef
[2012-10-01 07:14:38 -0400] ichilton: what else would it be trying to write to?
[2012-10-01 07:15:13 -0400] zts: given that pastie, I'd be guessing some ruby directories
[2012-10-01 07:16:26 -0400] ichilton: yeah, odd
[2012-10-01 07:16:35 -0400] ichilton: I used the chef installer thing..
[2012-10-01 07:16:37 -0400] zts: but nothing in that looks like it should be writing stuff out
[2012-10-01 07:17:02 -0400] zts: if nothing stands out in a longer "chef-client -l debug" output, you're at the point where I'd start flailing around with dtrace
[2012-10-01 07:17:14 -0400] ichilton: It seems to continue on regardless like
[2012-10-01 07:17:31 -0400] ichilton: I guess there will be some opscode folk around this afternoon who might know...
[2012-10-01 07:17:37 -0400] zts: yeah
[2012-10-01 07:17:40 -0400] ichilton: zts: are you going to scalecamp this year?
[2012-10-01 07:18:09 -0400] ichilton: zts: gutted I can't make it - starting a new job this morning so couldn't ask to head down to London in my first week!
[2012-10-01 07:18:24 -0400] zts: I'm going to miss it this year, unfortunately :(
[2012-10-01 07:18:39 -0400] zts: Currently in Jakarta on a contract, and won't be back til the end of November
[2012-10-01 07:18:44 -0400] ichilton: ah, at least it's not just me then!
[2012-10-01 07:18:48 -0400] ichilton: ah, cool
[2012-10-01 07:18:54 -0400] zts: indeed, congratulations on the new job though :)
[2012-10-01 07:18:57 -0400] ichilton: you freelance now?
[2012-10-01 07:19:00 -0400] ichilton: thanks!
[2012-10-01 07:19:18 -0400] ichilton: trying to remember who you were working for before - was it something e-commerce?
[2012-10-01 07:19:29 -0400] zts: yeah, I was at Venda
[2012-10-01 07:19:32 -0400] ichilton: that was it!
[2012-10-01 07:19:41 -0400] zts: for almost 9 years, so I'm hoping to remain freelance for a while :)
[2012-10-01 07:19:48 -0400] ichilton: :)
[2012-10-01 07:19:52 -0400] ichilton: hmm
[2012-10-01 07:19:56 -0400] ichilton: xcode finished installing
[2012-10-01 07:19:59 -0400] ichilton: but I still dont have gcc
[2012-10-01 07:20:01 -0400] ichilton: odd
[2012-10-01 07:20:07 -0400] zts: you'll need to open xcode
[2012-10-01 07:20:20 -0400] zts: and... somewhere in the preferences, is a thing
[2012-10-01 07:20:29 -0400] ichilton: ahh, ok
[2012-10-01 07:20:46 -0400] zts: it has a section for installing optional packages
[2012-10-01 07:20:49 -0400] zts: one of which is the command-line tools
[2012-10-01 07:21:04 -0400] ichilton: great, thanks
[2012-10-01 07:21:31 -0400] zts: np :)
[2012-10-01 07:21:53 -0400] ichilton: installing...
[2012-10-01 07:24:19 -0400] ichilton: ok, that's installed - try chef-client again...
[2012-10-01 07:24:47 -0400] ichilton: looks like it's working!
[2012-10-01 07:25:28 -0400] zts: excellent!
[2012-10-01 07:25:48 -0400] ichilton: cool - it has
[2012-10-01 07:25:50 -0400] ichilton: thanks for your help!
[2012-10-01 07:26:01 -0400] ichilton: Initialized empty Git repository in /usr/local/.git/       <-- that's odd though!
[2012-10-01 07:26:36 -0400] zts: ah, did you install homebrew?
[2012-10-01 07:26:40 -0400] ichilton: it's a git repo with the remote of https://github.com/mxcl/homebrew.git
[2012-10-01 07:26:40 -0400] ichilton: yep
[2012-10-01 07:26:46 -0400] zts: yeah, that's to be expected then
[2012-10-01 07:26:50 -0400] ichilton: ah, ok
[2012-10-01 07:27:00 -0400] ichilton: why does it do that?
[2012-10-01 07:27:31 -0400] zts: To be honest, I'm not sure about the details, but that's part of how homebrew hangs together
[2012-10-01 07:27:51 -0400] ichilton: ah, ok
[2012-10-01 07:28:26 -0400] zts: I consider it a vote in favour of homebrew that I've never had to dive into its guts :)
[2012-10-01 07:28:35 -0400] ichilton: :)
[2012-10-01 07:32:50 -0400] ichilton: ok, i've done something else silly now
[2012-10-01 07:33:00 -0400] ichilton: i've created cookbooks/apps/recipes/googlechrome.rb
[2012-10-01 07:33:15 -0400] ichilton: ran: knife cookbook upload -a
[2012-10-01 07:33:19 -0400] ichilton: added it to the run list
[2012-10-01 07:33:27 -0400] ichilton: but i'm getting:
[2012-10-01 07:33:27 -0400] ichilton: The following cookbooks are required by the client but don't exist on the server:
[2012-10-01 07:33:28 -0400] ichilton: * apps:googlechrome
[2012-10-01 07:33:56 -0400] ichilton: adding it to the run list with: "recipe[apps:googlechrome]", - is that right
[2012-10-01 07:34:42 -0400] ichilton: ah, the cookbook isn't showing in the opscode web interface
[2012-10-01 07:34:50 -0400] ichilton: I guess I need more than cookbooks/apps/recipes/googlechrome.rb
[2012-10-01 07:35:17 -0400] ichilton: the metadata.rb?
[2012-10-01 07:37:35 -0400] ichilton: or do I need to add it some how?
[2012-10-01 07:39:44 -0400] zts: yeah, you'll need a metadata.rb
[2012-10-01 07:39:52 -0400] ichilton: added that and it doesn't seem to see it
[2012-10-01 07:40:03 -0400] zts: I'd suggest using "knife cookbook create" when you're getting started
[2012-10-01 07:40:19 -0400] zts: it'll give you a full cookbook skeleton, including a bunch of stuff you probably won't need for the cookbook you're writing
[2012-10-01 07:40:29 -0400] ichilton: ok
[2012-10-01 07:40:50 -0400] ichilton: should that work though, just creating it and doing upload -a?
[2012-10-01 07:41:13 -0400] ichilton: i've added the metadata and attributes, templates, files etc
[2012-10-01 07:41:15 -0400] ichilton: but it seems to ignore it
[2012-10-01 07:43:53 -0400] zts: it should, do you get any output from "upload -a" to show that it has been uploaded?
[2012-10-01 07:44:35 -0400] ichilton: that's odd
[2012-10-01 07:44:45 -0400] ichilton: I did a create
[2012-10-01 07:44:49 -0400] ichilton: it did it
[2012-10-01 07:44:53 -0400] ichilton: now upload uploads it
[2012-10-01 07:44:59 -0400] ichilton: but I can't see it in cookbooks
[2012-10-01 07:45:05 -0400] ichilton: so it's put it somewhere else....
[2012-10-01 07:45:11 -0400] ichilton: which is probably why it wasn't seeing mine
[2012-10-01 07:45:28 -0400] ichilton: does it not do it local to the current dir?
[2012-10-01 07:46:09 -0400] ichilton: ah no, my knife.rb has:
[2012-10-01 07:46:10 -0400] ichilton: cookbook_path            ["#{current_dir}/../cookbooks"]
[2012-10-01 07:46:32 -0400] ichilton: which instead of using the dir with my config in (~/.chef), it did it where I was
[2012-10-01 07:47:52 -0400] zts: ah... yeah, I have cookbook_path            ["#{ENV['HOME']}/code/chef-repo"]
[2012-10-01 07:48:03 -0400] zts: uh, add a /cookbooks on the end of that path
[2012-10-01 07:54:06 -0400] ichilton: Sorted that
[2012-10-01 07:54:09 -0400] ichilton: it's uploaded now
[2012-10-01 07:54:13 -0400] ichilton: but still doesn't like: apps:googlechrome
[2012-10-01 07:54:22 -0400] ichilton: can I not just do cookbook:recipe like that?
[2012-10-01 07:57:13 -0400] zts: oh sorry, recipe[apps::googlechrome]
[2012-10-01 07:57:41 -0400] ichilton: oops :)
[2012-10-01 07:58:06 -0400] ichilton: thanks
[2012-10-01 07:58:43 -0400] zts: np
[2012-10-01 07:59:36 -0400] ichilton: yay, I have chrome :)
[2012-10-01 08:01:52 -0400] zts: cool :)
[2012-10-01 08:16:44 -0400] ichilton: Anyone familiar with the dmg cookbook?
[2012-10-01 08:17:23 -0400] ichilton: trying to install lastpass, which annoyingly downloads as lpmacosx.dmg, but then in Volumes is /Volumes/LastPass for OS X/  and then lpmacosx.pkg
[2012-10-01 08:17:26 -0400] ichilton: can it cope with that
[2012-10-01 08:17:37 -0400] ichilton: it's trying to do: /Volumes/lpmacosx/lpmacosx.pkg
[2012-10-01 08:24:35 -0400] zts: I haven't used it, but the readme suggests there's a volumes_dir parameter you can use to tell it where it will be mounted
[2012-10-01 10:25:25 -0400] zeroXten: is there a good way of implementing some sort of global template files? A bit like data_bags but more generic (ie not just json, but erb)
[2012-10-01 10:27:04 -0400] masterkorp: How do i search for nodes that have a certain recipe ?
[2012-10-01 10:27:22 -0400] masterkorp: knife search "recipe:runit*"
[2012-10-01 10:28:05 -0400] masterkorp: oh brainfair
[2012-10-01 10:28:08 -0400] masterkorp: missed node
[2012-10-01 10:28:40 -0400] bobw: better to do recipes as well
[2012-10-01 10:28:43 -0400] _rc: you probably also want recipes:runit* in case it comes in via an expanded role
[2012-10-01 10:30:52 -0400] jedi4ever: is there a way to specify a git repo  for a dependency in a metadata.json ? like librarian-chef does but when it gets the cookbook it uses the correct repos
[2012-10-01 10:35:22 -0400] masterkorp: Honestly prefer to use a local copy of the cookbook
[2012-10-01 10:35:32 -0400] masterkorp: using a git submodule
[2012-10-01 10:35:46 -0400] masterkorp: sync'ing when i need
[2012-10-01 10:43:17 -0400] anentropic: deep merge isn't working for me, are there any limitations on it re override vs default or enironment vs role attributes?
[2012-10-01 10:47:05 -0400] anentropic: I have override_attributes in the environment then default_attributes in a role... the keys missing from the environment hash are not being added by setting in the role
[2012-10-01 10:47:31 -0400] jonlives: anentropic: have you read http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-10-01 10:48:38 -0400] anentropic: yes, I want the environment attributes to have precedence, but I thought missing keys should get merged in from the role?
[2012-10-01 10:50:31 -0400] anentropic: jonlives, I thought it was only where the (deep) keys clash that the precedence would be taken into acocunt?
[2012-10-01 10:52:04 -0400] jonlives: anentropic: are the keys part of the same array?
[2012-10-01 10:52:15 -0400] jonlives: ie a[foo] and a[bar]
[2012-10-01 10:52:46 -0400] anentropic: its a hash like {"a"=>1} then I want to add {"b"=>2} from the role but it's not happening
[2012-10-01 10:53:23 -0400] anentropic: or more like {"apache" => {"a"=>1}}  and {"apache"=>{"b"=>2}}
[2012-10-01 10:53:51 -0400] anentropic: I want to end up with {"apache"=>{"a"=>1,"b"=>2}}
[2012-10-01 10:53:58 -0400] jonlives: if it's part of the same hash I *think* the entire hash with the highest precedence will be taken.
[2012-10-01 10:53:59 -0400] jonlives: tho I'm not 100% certain
[2012-10-01 10:54:18 -0400] anentropic: yeah that's what I'm getting, I thought the point of it all was that it did a deep merge
[2012-10-01 10:54:57 -0400] anentropic: very much like the examples here http://wiki.opscode.com/display/chef/Deep+Merge
[2012-10-01 10:57:09 -0400] jonlives: anentropic: actually looking at the docs you're right
[2012-10-01 10:57:33 -0400] jannel_: is there a way to use the chef api from my library code? e.g. data_bag_item and other methods available in recipes?
[2012-10-01 10:59:33 -0400] BryanWB: jedi4ever, u get ur question answered?
[2012-10-01 10:59:55 -0400] BryanWB: jedi4ever, u can't specify a git repo in metadata.rb
[2012-10-01 11:03:02 -0400] jedi4ever: BryanWB: ah ok ,thanks for the confirmation
[2012-10-01 11:08:24 -0400] BryanWB: jedi4ever, btw, i u should so choose to use berkshelf
[2012-10-01 11:08:47 -0400] BryanWB: it has nice "groups"  that u can use to group dependencies
[2012-10-01 11:08:56 -0400] BryanWB: so u can do   $ berks install --without development
[2012-10-01 11:10:36 -0400] jedi4ever: BryanWB: I'll get to that soon , first finish the cookbooks :)
[2012-10-01 11:39:51 -0400] jedi4ever: now I feel stupid - how do you refer to recipe in a directory structure <cookbook bla>/recipes/server/graphite - bla::server::graphite fails ?
[2012-10-01 12:08:46 -0400] BryanWB: jedi4ever, u can't nest recipes
[2012-10-01 12:08:54 -0400] jedi4ever: bummer
[2012-10-01 12:09:10 -0400] BryanWB: they are actual classes
[2012-10-01 12:09:32 -0400] BryanWB: but, i guess that means u could subclass them if u really wanted to ;)
[2012-10-01 12:09:48 -0400] jedi4ever: fwiw - in puppet you just say boa::server::graphite for nested directories in modules
[2012-10-01 12:19:37 -0400] leifmadsen: morning all!  I'm trying to track down an issue where something (I think it's minitest-chef-handler, but I can't be sure yet) is calling the diff function in the file resource incorrectly. The stacktrace shows nothing useful other than the thrown exception. Does anyone have some tips for enabling a more thorough backtrace?
[2012-10-01 12:20:35 -0400] leifmadsen: Trying to track down what is passing 2 arguments instead of 1 to line 85 of resource/file.rb in chef
[2012-10-01 12:27:31 -0400] zts: leifmadsen: that sounds odd, does that mean there's no backtrace at all?
[2012-10-01 12:27:41 -0400] leifmadsen: there is a backtrace
[2012-10-01 12:27:45 -0400] leifmadsen: it just doesn't show me anything all that useful
[2012-10-01 12:27:54 -0400] leifmadsen: let me pastebin it
[2012-10-01 12:27:59 -0400] zts: thankyou
[2012-10-01 12:29:13 -0400] leifmadsen: zts:
[2012-10-01 12:29:19 -0400] leifmadsen: http://pastebin.ca/2237922
[2012-10-01 12:29:25 -0400] leifmadsen: oops, linux copy/pasta sometimes sucks
[2012-10-01 12:29:26 -0400] leifmadsen: heh
[2012-10-01 12:29:38 -0400] zts: Does anyone know who I could chase about getting the right_aws gem updated?  I seem to recall that there are some rightscale folks in here, but I've forgotten who...
[2012-10-01 12:30:34 -0400] BryanWB: zts, flaccid is a rightscale dude ;)
[2012-10-01 12:31:24 -0400] databus23: Hi, I'm having issues with the group resource/provider on SLES11. I see duplicated uids for a group. Is anyone aware of this?
[2012-10-01 12:32:01 -0400] zts: BryanWB: thankyou, I shall ask him very nicely if he can point me in the right direction :)
[2012-10-01 12:32:59 -0400] zts: leifmadsen: I see what you mean about unhelpful
[2012-10-01 12:33:06 -0400] leifmadsen: indeed...
[2012-10-01 12:33:31 -0400] leifmadsen: I think it might be within minitest-chef-handler, but I've looked through the code and can't find anything obvious about what is calling the file resource incorrectly
[2012-10-01 12:33:50 -0400] leifmadsen: I can easily reproduce it by doing a minitest spec test using a mode check that returns something wrong
[2012-10-01 12:34:03 -0400] leifmadsen: so if file should be 600, and it is 644, it returns that stacktrace
[2012-10-01 12:34:13 -0400] leifmadsen: if all matches up to 600 it runs fine and shows no error
[2012-10-01 12:34:15 -0400] databus23: I'm using group with append false but everytime the provider figures it need to change something, the provided list of uids is append instead of replaced
[2012-10-01 12:38:10 -0400] databus23: The way I see it the "groupmod -A" is not working as expected here: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/group/suse.rb#L51
[2012-10-01 12:38:43 -0400] databus23: It just appending all provided uids not even caring about duplication
[2012-10-01 12:47:26 -0400] databus23: Anyone using chef on SLES around?
[2012-10-01 12:58:29 -0400] riottino: hi guys!
[2012-10-01 12:59:10 -0400] riottino: I'm using the " remote file" resource in my recipe.. Where I can get the checksum ?
[2012-10-01 13:00:30 -0400] _rc: riottino: sha256sum $filename
[2012-10-01 13:00:39 -0400] masterkorp: _rc: md5 file
[2012-10-01 13:00:48 -0400] riottino: thanks! :_)
[2012-10-01 13:01:25 -0400] _rc: masterkorp: it's documented as being a SHA-256, not an md5
[2012-10-01 13:01:45 -0400] masterkorp: yeah my mistake
[2012-10-01 13:04:59 -0400] riottino: I used md5sum
[2012-10-01 13:05:39 -0400] riottino: so, if the md5sum of the downloaded file in not equal with my md5sum wrote in the cookbook, what happens?
[2012-10-01 13:06:14 -0400] masterkorp: it explodes
[2012-10-01 13:06:25 -0400] masterkorp: just stand back and watch the carnage
[2012-10-01 13:09:53 -0400] riottino: ah ok :)
[2012-10-01 13:30:43 -0400] pj007: hello
[2012-10-01 13:34:05 -0400] jtimberman: riottino: You must use the SHA256 if you wish to set the checksum. Chef doesn't use MD5s for checking file content.
[2012-10-01 13:34:17 -0400] riottino: yes , I saw :(
[2012-10-01 13:34:31 -0400] riottino: I used sha256sum
[2012-10-01 13:35:38 -0400] riottino: another question, I have to copy a file from /tmp  to /mypath ... I would use Script resource
[2012-10-01 13:35:52 -0400] riottino: do you suggest a better chef-oriented method?
[2012-10-01 13:41:05 -0400] jtimberman: file
[2012-10-01 13:41:20 -0400] jtimberman: https://gist.github.com/3797407
[2012-10-01 13:41:22 -0400] jtimberman: something like that
[2012-10-01 13:41:57 -0400] jtimberman: gotta run
[2012-10-01 13:49:54 -0400] masterkorp: Guys, is there any doc about the subscribes attribute ?
[2012-10-01 13:55:41 -0400] drnfx: Does anyone use chef and cap to handle their software deployments?
[2012-10-01 13:55:54 -0400] spox: drnfx: i have in the past
[2012-10-01 13:56:03 -0400] drnfx: I have been reading over the weekend about various options, but I would liek to get a feel from the community on how they handle  deployments
[2012-10-01 13:56:20 -0400] drnfx: spox, do you still use chef to deploy application code?
[2012-10-01 13:56:39 -0400] spox: i'm not at that place anymore, so no. but they still do
[2012-10-01 13:56:44 -0400] masterkorp: drnfx: we do
[2012-10-01 13:56:58 -0400] spox: it had more to do with the workflow they were used to and preferred over anything else
[2012-10-01 13:57:16 -0400] masterkorp: no we deploy code with capistrano
[2012-10-01 13:57:26 -0400] masterkorp: deploy with chef is not very controlled
[2012-10-01 13:57:50 -0400] gyre007: is there any way how I can transfer a file only to the servers of certain role ?
[2012-10-01 13:57:57 -0400] gyre007: I mean via chef...
[2012-10-01 13:58:07 -0400] gyre007: or what would be the best way to do this ?
[2012-10-01 14:42:39 -0400] anentropic: when specifying attributes eg in a role are we supposed to use symbols for names of quoted strings are ok?
[2012-10-01 14:42:55 -0400] anentropic: 'for names or'
[2012-10-01 14:47:18 -0400] geekbri: anentropic: you can use either.
[2012-10-01 15:08:22 -0400] maruq: hi guys
[2012-10-01 15:08:42 -0400] maruq: just trying to figure out the best way to conditionally notify
[2012-10-01 15:09:26 -0400] maruq: eg. my deploy_revision block should use the after_restart block to notify my sidekiq worker. but only if I have the "worker" recipe
[2012-10-01 15:11:26 -0400] maruq: I had https://gist.github.com/c3e22035f8ed97aa8bf0 , but it seems to fail saying ubuntu doesn't know what "notifies" is
[2012-10-01 15:13:06 -0400] maruq: I had thought of subscribing from the supervisord resource, but it seems the supervisord stuff gets handled during the compile phase, so it does' know about my app yet
[2012-10-01 15:14:18 -0400] yfeldblum: maruq, one resource can declare a notification to another resource that has already been declared, but can also declare a notification to another resource that hasn't been declared yet
[2012-10-01 15:14:31 -0400] yfeldblum: maruq, but one resource can only subscribe to another resource that has already been declared
[2012-10-01 15:15:13 -0400] yfeldblum: maruq, if you declare resource A first, and then resource B second, then A can notify B, B can notify A, and B can subscribe to A, but A cannot subscribe to B
[2012-10-01 15:15:18 -0400] maruq: yfeldblum: yep, that seems to be what the docs say, but chef's telling me "ad an error: NameError: Cannot find a resource for notifies on ubuntu version 12.04"
[2012-10-01 15:15:40 -0400] ekristen: can you only have 1 validator?
[2012-10-01 15:15:43 -0400] ekristen: or can you have multiple
[2012-10-01 15:16:07 -0400] yfeldblum: maruq, the error message you're getting is unrelated to that
[2012-10-01 15:17:05 -0400] yfeldblum: maruq, it's telling you that you tried calling the method #notifies, but the thing you tried calling #notifies on doesn't have a method #notifies
[2012-10-01 15:17:48 -0400] maruq: yfeldblum, so I can't notify from inside deploy_revision after_restart ?
[2012-10-01 15:18:17 -0400] maruq: yfeldblum, ah, I probably can't notify from inside the if block
[2012-10-01 15:18:35 -0400] yfeldblum: maruq, when the block passed to after_restart is called, the `self` inside the block is set to something else ... only instances of Chef::Resource have the #notifies method
[2012-10-01 15:18:42 -0400] yfeldblum: maruq, that's just magical thinking ...
[2012-10-01 15:18:58 -0400] maruq: yfeldblum, is there a standard way to conditionally notify?
[2012-10-01 15:19:13 -0400] yfeldblum: maruq, yes, with if!
[2012-10-01 15:19:27 -0400] maruq: yfeldblum, e.g. notifies :restart, "supervisord_program[sidekiq]", only_if blah
[2012-10-01 15:19:40 -0400] yfeldblum: maruq, notifies :some_action, "some_resource_type[some_resource_name]" if some_condition
[2012-10-01 15:19:53 -0400] yfeldblum: maruq, not only_if ... just normal ruby if
[2012-10-01 15:20:15 -0400] maruq: yfeldblum, cheers. I'll give it a try ;)
[2012-10-01 15:21:31 -0400] yfeldblum: maruq, but not from inside the block passed to after_restart, because the `self` is changed to something other than the resource, and that other thing doesn't have a #notifies method
[2012-10-01 15:22:26 -0400] maruq: yfeldblum: hmm complicates things. I could do it in the deploy_revision though, right?
[2012-10-01 15:22:45 -0400] maruq: yfeldblum: that would only trigger on a new revision, not every run, ja?
[2012-10-01 15:24:01 -0400] yfeldblum: maruq, i believe so ... only when it actually performs a deploy, and not when the deploy has already been performed based on comparing the current symlink with the SHA of the revision that is supposed to be deployed
[2012-10-01 15:24:49 -0400] maruq: yfeldblum: cool. I'm booting it now. hopefully it's all good
[2012-10-01 15:25:08 -0400] maruq: I definitely need to setup some kind of CI for this some time
[2012-10-01 15:26:02 -0400] maruq: has the community settled on a preferred CI system yet? Cucumber Chef, rspec-chef, test-kitchen ?
[2012-10-01 15:43:47 -0400] maruq: yfeldblum: just checked the notifies on the deploy_revision. so far no fires ;)
[2012-10-01 15:57:35 -0400] maruq: yfeldblum: yep, fully tested things. all looks good, thanks man
[2012-10-01 16:03:56 -0400] yfeldblum: maruq, no probs
[2012-10-01 16:20:06 -0400] gyre007: I have one encrypted databag from which Im loading items every time I need one...can I just load it ONCE and then just retrieve the items when needed ? I dont want code duplication like this https://gist.github.com/3812800
[2012-10-01 16:32:40 -0400] yfeldblum: gyre007, data-bags are not encrypted: only data-bag items may be
[2012-10-01 16:32:55 -0400] yfeldblum: gyre007, data-bags cannot be fetched: only data-bag items may be
[2012-10-01 16:33:01 -0400] gyre007: i see
[2012-10-01 16:35:24 -0400] jtimberman: masterkorp: subscribes documentation is in the notification documentation in the resources page.
[2012-10-01 16:35:38 -0400] jtimberman: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-10-01 16:36:55 -0400] jmartin: jtimberman: happen to have an updated guesstimation on release for omnibus chef-server? i saw a thread on the mailing list stating 1-2 months away roughly 1 month ago, just curious as to how well that is coming along
[2012-10-01 16:39:48 -0400] masterkorp: i saw it now
[2012-10-01 16:43:11 -0400] ekristen: how to do you update a config file in role X when a new server is added to role Y?
[2012-10-01 16:44:55 -0400] jtimberman: jmartin: I don't have an ETA.
[2012-10-01 16:45:27 -0400] jtimberman: jmartin: I know that there are omnibus chef-server builds, and we have Chef 11 in "preview" mode (not even alpha yet).
[2012-10-01 16:45:57 -0400] jtimberman: but the same tools we're using to build it are all public so you can make your own... z (alex h) has done that and indicated such in this channel :)
[2012-10-01 16:47:01 -0400] jmartin: jtimberman: indeed, i just need to take time to setup such a build environment
[2012-10-01 16:55:39 -0400] anentropic: anyone know how to read this traceback from Chef? https://gist.github.com/3812986
[2012-10-01 16:56:38 -0400] anentropic: I am finding it hard to work our which method is complaining of not enough arguments
[2012-10-01 16:57:06 -0400] jmartin: anentropic: what version of chef?
[2012-10-01 16:57:12 -0400] anentropic: 10.14.2
[2012-10-01 16:58:41 -0400] anentropic: via a `vagrant provision`
[2012-10-01 16:58:49 -0400] anentropic: with chef server
[2012-10-01 16:59:35 -0400] jmartin: i think i remember seeing a bug for that
[2012-10-01 16:59:39 -0400] jmartin: im trying to track it down
[2012-10-01 16:59:44 -0400] anentropic: jmartin thanks
[2012-10-01 17:01:14 -0400] jmartin: anentropic: http://tickets.opscode.com/browse/COOK-1661 maybe?
[2012-10-01 17:01:57 -0400] jmartin: i think thats the one i spotted, may or may not be exactly related
[2012-10-01 17:02:05 -0400] anentropic: jmartin, looks similar to mine thanks
[2012-10-01 17:06:00 -0400] mhalligan: is anyone hiring chefs in the East Bay, or entirely work from home roles? lost patience with my employer this morning and it's time to start looking.
[2012-10-01 17:35:35 -0400] ekristen: how do I bootstrap a server for the command line
[2012-10-01 17:36:22 -0400] j|: is there a clean way to have multiple encrypted data bags that can be used in a recipe?
[2012-10-01 17:36:43 -0400] j|: how do I differentiate between the keys without passing the key directly in the recipe?
[2012-10-01 17:39:35 -0400] j|: unless I'm misreading the docs (http://wiki.opscode.com/display/chef/Encrypted+Data+Bags) it sounds like your options for specifying a secret are to put the key directly in the call that loads it, or to stick the filename in the chef config :encrypted_data_bag_secret
[2012-10-01 17:40:48 -0400] j|: just weird that I have to put that in my knife config when there are multiple encrypted data bags all with logically different sets of credentials
[2012-10-01 17:41:32 -0400] j|: I suppose I could do one EDB per environment. Then I'd have to look how that affects my chef::config that gets passed in
[2012-10-01 17:41:47 -0400] j|: just seems a bit inflexible / counter-intuitive.
[2012-10-01 17:41:48 -0400] j|: :P
[2012-10-01 17:42:26 -0400] j|: I'm open to pointers in other directions if anyone has suggestions
[2012-10-01 18:15:57 -0400] wyrdvans: I have a question regarding cookbook versions.  I have a cookbook that uses 2 digit versions(x.y). When constraining a cookbook version in an environment, is x.y.0 equal to x.y?
[2012-10-01 18:16:39 -0400] ptrstr: wyrdvans: x.y.0 (i think)
[2012-10-01 18:17:10 -0400] ptrstr: i always make sure to use x.y.z now
[2012-10-01 18:18:12 -0400] wyrdvans: ptrstr: So the recommendation is to change the cookbook to use x.y.z instead of x.y?
[2012-10-01 18:19:17 -0400] ptrstr: that's what i do..to avoid confusion
[2012-10-01 18:20:04 -0400] ptrstr: j|: you can store different secrets on the server in different files
[2012-10-01 18:20:24 -0400] ptrstr: j|: how you get them there is up to you..probably during bootstrap
[2012-10-01 18:21:28 -0400] ptrstr: j|: i agree it's a lot of hassle so i generally avoid encrypted data bags to the bare minimum
[2012-10-01 18:22:50 -0400] ptrstr: j|: mabye there's a knife plugin to help manage secrets better..if not, there should be!
[2012-10-01 18:35:52 -0400] ekristen: how do I bootstrap a server from itself? I have the validation.pem file
[2012-10-01 18:36:42 -0400] erikh: jtimberman: so, remember that notifies hack I tweeted on friday? chef reports that it processed the start action, but doesn't actually do so
[2012-10-01 18:40:03 -0400] Urocyon: ekristen, like a knife bootstrap, but issued from the system getting registered?
[2012-10-01 18:41:11 -0400] j|: ptrstr: thanks. Yea, its just the difficulty of switching between the keys / 'secrets' that makes things tricky
[2012-10-01 18:41:36 -0400] ekristen: Urocyon: if I do that it wants to initial ssh, I've already done a chef-solo and then registered the chef-client with my chef server
[2012-10-01 18:43:13 -0400] Urocyon: so, you have chef on the system, and it is registered with the server. what else did you need it to do?  Isn't that basically what bootstrap does, install chef and register a system with the server?
[2012-10-01 18:43:26 -0400] ekristen: Urocyon: well I want to assign it a role
[2012-10-01 18:43:33 -0400] ekristen: I'm trying to figure out how to script that
[2012-10-01 18:44:44 -0400] Urocyon: well, not sure on that.  I've always assigned roles and such from a controlling system rather from the system itself.
[2012-10-01 18:45:01 -0400] Urocyon: I mean, rather than the target system.
[2012-10-01 18:45:29 -0400] Urocyon: my servers don't know what they should be when they come up, though, they don't know until told.
[2012-10-01 18:45:46 -0400] Urocyon: by my assigning a role to it .
[2012-10-01 18:45:49 -0400] ekristen: Urocyon: I'm using AWS cloud formation to build out a cloud environement
[2012-10-01 18:46:12 -0400] Urocyon: ah. that's a bit clearer.
[2012-10-01 18:46:36 -0400] ekristen: there is script that runs, I want to be able to assign the role when the server comes up
[2012-10-01 18:46:45 -0400] ekristen: instead of having to go into the chef server and assign the role
[2012-10-01 18:47:54 -0400] Urocyon: I thought there was a command in cloud formation for assigning a role.
[2012-10-01 18:48:10 -0400] Urocyon: It's been a while since I played with it.
[2012-10-01 18:48:15 -0400] ekristen: why would cloud formation know about chef?
[2012-10-01 18:48:46 -0400] Urocyon: why wouldn't it?
[2012-10-01 18:49:15 -0400] ekristen: Urocyon: fair enough
[2012-10-01 18:49:18 -0400] ekristen: I'm reading the doc right now
[2012-10-01 18:49:25 -0400] ekristen: dang, there it is
[2012-10-01 18:49:33 -0400] Urocyon: I was about to point you to that.
[2012-10-01 18:49:49 -0400] greenail: hello
[2012-10-01 18:50:03 -0400] ekristen: Urocyon: thanks for chatting with me on it
[2012-10-01 18:50:30 -0400] greenail: i'm trying to install rvm to a single user account via  a script, but i've bene trying for about 3 hours and can't get it to work.  i'm about smash my computer.  any suggestions?
[2012-10-01 18:51:44 -0400] Urocyon: My current frustration is getting chef-server bootstrapped on redhat 6.  I had it all working for 10.12, but in 10.14 it's getting tripped up finding the gems_dir and gems_bin settings.   Anyone run into that yet?
[2012-10-01 18:54:56 -0400] greenail: is there a better way to ask questions?
[2012-10-01 18:55:06 -0400] ekristen: Urocyon: another question if you have time
[2012-10-01 18:55:14 -0400] greenail: i was on here last night and no one was around
[2012-10-01 18:56:34 -0400] ekristen: Urocyon: my understanding is that I can have chef update all servers in my web server role to let them know about all the servers in my database role, so like if I add a new database server, the web servers find out about it
[2012-10-01 18:57:42 -0400] jsnapp: can i get some help with cookbook libraries here?
[2012-10-01 18:58:18 -0400] jsnapp: i'm looking at the AFW cookbook https://github.com/jeremiahsnapp/AFW/tree/master/libraries
[2012-10-01 18:59:35 -0400] jsnapp: the create_rule library is supposed to extend the core library .. but when i try to use the cookbook it fails with "NameError: uninitialized constant AFWCore"
[2012-10-01 19:00:25 -0400] jsnapp: is it possible in cookbook libraries to an extend like this?  can someone tell me if there is something wrong with the code?
[2012-10-01 19:02:41 -0400] yfeldblum: jsnapp, it's a problem with the way chef loads cookbooks & libraries
[2012-10-01 19:03:38 -0400] jsnapp: yfeldblum, thanks .. so is it just not possible?  i guess the author of AFW didn't test this code then
[2012-10-01 19:04:22 -0400] yfeldblum: jsnapp, it may depend on such things as the version of ruby, the version of chef, whether you're using open-source chef-server or hosted-chef, which versions of those you are using, etc
[2012-10-01 19:06:33 -0400] jsnapp: oh wow, that is a complicated problem .. vagrant box using chef-solo 0.10.10, ruby 1.8.7
[2012-10-01 19:07:32 -0400] jsnapp: so maybe i should just try upgrading ruby and chef?
[2012-10-01 19:07:53 -0400] yfeldblum: jsnapp, the problem is that there's no total order imposed as part of the API or part of the contract, and there's no supported API way for cookbooks and libraries themselves to request a partial order
[2012-10-01 19:09:37 -0400] caleb_: Who can I poke about reviewing https://github.com/opscode-cookbooks/python/pull/17 ? No rush, I just want to make sure I'm following the process correctly.
[2012-10-01 19:13:08 -0400] jtimberman: caleb_: Thanks for the ticket and pull request. Looks like you've followed the process. We review resolved unmerged tickets once a week (sometimes twice, like we did an extra review today), just haven't gotten to that yet.
[2012-10-01 19:13:28 -0400] caleb_: jtimberman: Sweet. Thanks,
[2012-10-01 19:13:48 -0400] mstyne: afternoon all
[2012-10-01 19:13:50 -0400] jtimberman: caleb_: we're working through such tickets in date order from oldest update to latest.
[2012-10-01 19:13:56 -0400] mstyne: could someone direct me to the chef-server changelog
[2012-10-01 19:14:05 -0400] mstyne: i'm having a heck of a time digging it up
[2012-10-01 19:14:10 -0400] jtimberman: http://tickets.opscode.com/secure/IssueNavigator.jspa?requestId=10874&mode=hide
[2012-10-01 19:14:39 -0400] jondecamp: jtimberman: That's good to know.  We're working on the internals of getting the CCLA signed so we can submit a couple of pull requests for stuff.
[2012-10-01 19:14:51 -0400] jtimberman: jondecamp: :-)
[2012-10-01 19:15:15 -0400] jtimberman: The process we're following for maintaining Opscode cookbooks is posted here on the wiki: http://wiki.opscode.com/display/chef/Opscode+Cookbook+Maintenance+Processes
[2012-10-01 19:16:16 -0400] jondecamp: jtimberman: sweet. Thanks.  It's pretty exciting that we're so close.
[2012-10-01 19:16:45 -0400] SplasPood: jtimberman: is Pauly C on IRC at all?
[2012-10-01 19:17:30 -0400] jsnapp: yfeldblum, thanks for pointing me in the right direction .. i switched my vagrant box to the bento opscode-ubuntu-12.04-i386 and now things are working
[2012-10-01 19:18:49 -0400] yfeldblum: jsnapp, well my real answer was "that's completely unsupported at the moment so don't do it" but OK :D
[2012-10-01 19:24:05 -0400] gchristensen: is it possible to pass in a path for my ssh key id, instead of the key pair name?
[2012-10-01 19:24:28 -0400] gchristensen: like knife[:aws_ssh_key_id] = "#{current_dir}/../webhead.pem" but that doesn't work
[2012-10-01 19:29:34 -0400] jsnapp: yfeldblum, haha well, it didn't work before and now it does so go figure .. are you saying that it may work now but may break later?  if it's really so unreliable would you recommend i contact the cookbook author and let them know?
[2012-10-01 19:30:40 -0400] yfeldblum: jsnapp, that's exactly what i'm saying
[2012-10-01 19:35:11 -0400] phantasm66: when retreiving ohai local variables.. how does one do something like this:
[2012-10-01 19:35:57 -0400] phantasm66: node[:network][:interfaces][:"bond0:1"][:addresses]
[2012-10-01 19:36:12 -0400] phantasm66: and from that.. there are 3 different :addresses
[2012-10-01 19:36:16 -0400] phantasm66: i need the 2nd one
[2012-10-01 19:41:37 -0400] yfeldblum: phantasm66, node[:network][:interfaces][:"bond0:1"][:addresses][1]
[2012-10-01 19:41:44 -0400] yfeldblum: phantasm66, index into it like an array
[2012-10-01 19:42:04 -0400] phantasm66: i have literally that exact config
[2012-10-01 19:42:16 -0400] phantasm66: it returns an empty string
[2012-10-01 19:42:46 -0400] yfeldblum: phantasm66, also you don't need to use symbols because you can use strings:
[2012-10-01 19:42:58 -0400] yfeldblum: node["network"]["interfaces"]["bond0:1"]["addresses"]
[2012-10-01 19:43:29 -0400] phantasm66: https://gist.github.com/28ccf306b48fff31c32c
[2012-10-01 19:43:37 -0400] phantasm66: that is the output from 'ohaia network'
[2012-10-01 19:43:40 -0400] phantasm66: ohai..
[2012-10-01 19:43:44 -0400] phantasm66: and this:
[2012-10-01 19:43:52 -0400] phantasm66: node[:network][:interfaces][:"bond0:1"][:addresses][1]
[2012-10-01 19:43:58 -0400] phantasm66: returns an empty string
[2012-10-01 19:44:16 -0400] phantasm66: i am running chef 0.10.8
[2012-10-01 19:44:20 -0400] yfeldblum: phantasm66, are you trying to get the actual IP address?
[2012-10-01 19:44:32 -0400] phantasm66: yes
[2012-10-01 19:44:48 -0400] phantasm66: 10.0.200.61
[2012-10-01 19:44:59 -0400] ichilton: Got 2 packages from dmg which try to install on every chef-client run even though they are already installed - any ideas? - http://pastie.org/4892914
[2012-10-01 19:45:19 -0400] yfeldblum: phantasm66, well remember that hashes aren't really ordered in any specific order so there's no real definition of "second" - you will need to provide some other criteria
[2012-10-01 19:45:21 -0400] phantasm66: hashes aren't ordered in ruby.. so, i am kind of stumped on specifying an actual position
[2012-10-01 19:45:30 -0400] phantasm66: yeah
[2012-10-01 19:45:47 -0400] phantasm66: ok..
[2012-10-01 19:46:24 -0400] yfeldblum: phantasm66, if you want an array of the IP addresses, you can call #keys
[2012-10-01 19:46:43 -0400] yfeldblum: phantasm66, my_ip_addresses = node["network"]["interfaces"]["bond0:1"]["addresses"].keys
[2012-10-01 19:50:34 -0400] ichilton: Am I right in saying it's one chef repo per organization? (hosted chef)
[2012-10-01 19:51:08 -0400] jsnapp: yfeldblum, thanks for the help
[2012-10-01 19:52:15 -0400] yfeldblum: ichilton, no - sometimes it's one chef repo per hosted-chef organization, sometimes it's one chef repo for many hosted-chef organizations, sometimes it's many chef repos for one hosted-chef organization
[2012-10-01 19:53:16 -0400] ichilton: yfeldblum: how can you have multple repos per organization? - how do you segrigate them and specify which to apply to a host?
[2012-10-01 19:54:32 -0400] yfeldblum: ichilton, hosts don't know about chef repos and don't care about chef repos; hosts care only about what's in the hosted-chef organization; if you have two chef repos working together to put cookbooks and data etc into a single hosted-chef organization, then hosts won't know the difference
[2012-10-01 19:55:14 -0400] Urocyon: ekristen: got pulled away.  Yes, you could do something like that.  I'm not sure that chef is the best tool for that, but when chef-client runs your recipes can retrieve information like "what systems in this environment have role X" and then alter settings accordingly.
[2012-10-01 19:55:30 -0400] yfeldblum: ichilton, of course i'm not suggesting you do that (nor am i suggesting you don't do that); i'm just saying that there's no necessary or intrinsic relationship between chef repos and hosted-chef organizations, and that they're just separate things and there are many possible ways to use them beyond the simplest 1-to-1 way of using them
[2012-10-01 19:56:44 -0400] ichilton: yfeldblum: ok, thanks
[2012-10-01 19:57:37 -0400] Urocyon: ekristen: I'd probably separate my web server from my database server configurations, but I could see using chef to add a new server to my database pool, or a web node to my load balancers.
[2012-10-01 19:58:45 -0400] Urocyon: ekristen: I've thought about it a bit, but haven't implemented anything quite like this myself.  The nagios cookbook uses this technique though to add new systems to the nagios configuration.
[2012-10-01 20:00:19 -0400] ekristen: k
[2012-10-01 20:00:28 -0400] greenail: hello
[2012-10-01 20:00:39 -0400] greenail: any chance i could get some help with rvm and chef-solo?
[2012-10-01 20:04:57 -0400] bluepojo: greenail: I know this isn't directly related to your question, but I've found rbenv is much easier to deal with in production:  https://github.com/RiotGames/rbenv-cookbook
[2012-10-01 20:05:14 -0400] bluepojo: also, in IRC, it's generally good practice just to ask your question rather than saying "can someone help with X subject"?
[2012-10-01 20:07:51 -0400] greenail: bluepojo, i did ask
[2012-10-01 20:07:55 -0400] greenail: about 2 hours ago
[2012-10-01 20:07:56 -0400] greenail: hel
[2012-10-01 20:07:59 -0400] greenail: er heh
[2012-10-01 20:08:13 -0400] greenail: it's maddening this rvm
[2012-10-01 20:09:51 -0400] greenail: https://gist.github.com/3814121
[2012-10-01 20:09:56 -0400] greenail: here is my "script"
[2012-10-01 20:10:12 -0400] greenail: i've tried everything i can think of
[2012-10-01 20:10:27 -0400] greenail: should i just do a system wide install?
[2012-10-01 20:10:51 -0400] greenail: the apt package is borked, i wasted at least 2 hours with it before giving up
[2012-10-01 20:15:03 -0400] jtimberman: SplasPood: lack of responses for what?
[2012-10-01 20:16:58 -0400] SplasPood: We have a number of issues with API differences between 'private' chef and OSS chef and I have an email thread going where I want to talk to soemone in dev about these issues (they're blocking our deployment of a product) but I'm not getting any replies about that.   I've got a list of say 10 points and only one (the least important one) is being focused on.   Now I can't even get a reply
[2012-10-01 20:17:07 -0400] SplasPood: jtimberman: I'll fwd you my original email if you'd like
[2012-10-01 20:17:15 -0400] SplasPood: jtimberman: really I just want to get someone on the phone
[2012-10-01 20:18:00 -0400] SplasPood: Pauly C was the last person to respond.
[2012-10-01 20:18:10 -0400] greenail: bluepojo what's so great about rbenv btw?
[2012-10-01 20:20:14 -0400] Urocyon: greenmail did you post how it's failing?  I don't see that in my scroll back.
[2012-10-01 20:20:21 -0400] SplasPood: jtimberman: hah, pauly just replied.
[2012-10-01 20:20:37 -0400] Urocyon: that was a weird autocorrection.
[2012-10-01 20:23:59 -0400] Urocyon: greenail:  did you post how it's failing?  I don't see that in my scroll back.
[2012-10-01 20:24:07 -0400] greenail: one sec
[2012-10-01 20:32:56 -0400] greenail: urocyon https://gist.github.com/3814247#comments
[2012-10-01 20:46:58 -0400] Urocyon: greenail: looking at it
[2012-10-01 20:50:00 -0400] greenail: Urocyon, that gist will never work, my cwd is gone somehow, and some other issues as I tried to hack this in...
[2012-10-01 20:50:18 -0400] greenail: i'm really looking for a working script resource that installs rvm, and can run rvm use
[2012-10-01 20:51:35 -0400] greenail: the thing that is perplexing me is why it tries to chang /root/.bash_profile
[2012-10-01 20:51:47 -0400] greenail: since it is not running as root
[2012-10-01 20:53:09 -0400] Urocyon: There is fnichols rvm cookbook.  It is supposed to handle per user rvm.  https://github.com/fnichol/chef-rvm
[2012-10-01 20:54:30 -0400] greenail: something feels wrong about a whole cookbook just to run a command
[2012-10-01 20:54:34 -0400] greenail: maybe it's just me
[2012-10-01 20:55:37 -0400] bluepojo: that's the whole purpose of a cookbook
[2012-10-01 20:55:43 -0400] bluepojo: to manage a component of the system
[2012-10-01 20:55:59 -0400] bluepojo: if the component is simple, it doesn't follow that it is part of another component necessarily
[2012-10-01 20:56:04 -0400] bluepojo: it just means the cookbook is simple
[2012-10-01 20:56:40 -0400] greenail: bluepojo, i understand the need for cookbooks, but the fact that I can't run it bugs me
[2012-10-01 20:56:50 -0400] greenail: i'm obviously not understanding something about he environment
[2012-10-01 21:07:40 -0400] Urocyon: greenail: I believe the problem is in that pipe to bash.  It's causing some confusion over the user or maybe the working directory.
[2012-10-01 21:09:24 -0400] Urocyon: greenail: breaking it up seems to have worked for me.   https://gist.github.com/cd68c5d1ac2bf8f111d5
[2012-10-01 21:09:25 -0400] jtimberman: SplasPood: ah ok - sorry i didn't reply earlier
[2012-10-01 21:10:36 -0400] greenail: urocyon let me try
[2012-10-01 21:12:10 -0400] SplasPood: jtimberman: no problem at all
[2012-10-01 21:12:51 -0400] SplasPood: jtimberman: so my devs just inform me 'well all these issues we had/have... it might be because the version of OSS chef we were testing against was far newer than what we are running on our private deployment'  which is... great to know now :P
[2012-10-01 21:13:03 -0400] greenail: urocyon: nope
[2012-10-01 21:13:11 -0400] greenail: maybe it has something to do with vagrant
[2012-10-01 21:16:17 -0400] SplasPood: jtimberman: if you, or anyone else, knows..  any plans to go through and tag versions in git for all the opscode-cookbooks repos?   Some have, some don't
[2012-10-01 21:19:36 -0400] greenail: https://gist.github.com/cd68c5d1ac2bf8f111d5#comments
[2012-10-01 21:20:24 -0400] dajia: Hello, everyone.
[2012-10-01 21:23:54 -0400] dajia: I need to parse a JSON file and make the values available to resources within a single recipe.  It's easy to parse the JSON in a ruby_block with JSON.parse() .  However, the variables I populate with the values from the JSON need to be accessible outside of the ruby_block.  This is problematic.  Anyone have any ideas?
[2012-10-01 21:25:23 -0400] KarlHungus: bah. i'm considering refactoring a bunch of my internal app cookbooks to use the application cookbook from opscode
[2012-10-01 21:25:26 -0400] KarlHungus: am i crazy?
[2012-10-01 21:26:09 -0400] KarlHungus: or asking for massive pain? =)
[2012-10-01 21:30:23 -0400] dougireton: Is this the right channel for ChefSpec questions? I couldn't find a #chefspec IRC channel
[2012-10-01 21:30:48 -0400] jmartin: dougireton: perhaps check #chef-hacking as well
[2012-10-01 21:31:34 -0400] dougireton: jmartin: I thought #chef-hacking was for core contributions to chef itself
[2012-10-01 21:31:55 -0400] jmartin: dougireton: yeah, im not sure specifically, so i just meant maybe check there too :D
[2012-10-01 21:32:43 -0400] jmartin: KarlHungus: "work hard to be lazy" is my motto, so if it will make your life easier, itll be worht it
[2012-10-01 21:32:46 -0400] jmartin: worth*
[2012-10-01 21:33:18 -0400] dougireton: I'm trying to write a spec to test Cookbook_file on Windows and I'm getting this error: undefined method `rights' for Chef::Resource::CookbookFile
[2012-10-01 21:33:42 -0400] greenail: urocyon thanks for the help, i ended up using the chef-rvm cookbook, which oddly seems to need to be renamed just 'rvm' to work
[2012-10-01 21:33:51 -0400] dougireton: I'm using the Windows 'rights' attribute in my cookbook, but Chefspec doesn't seem to like it
[2012-10-01 21:33:52 -0400] greenail: it seems to be behaving correctly
[2012-10-01 21:34:03 -0400] jtimberman: SplasPood: we're not planning to go back in time and tag every released version.
[2012-10-01 21:34:32 -0400] jtimberman: SplasPood: if you want a specific version, you can get it from the community site. we don't delete old versions
[2012-10-01 21:34:34 -0400] Urocyon: greenail: pretty common, to have that kind of renaming due to name collisions.   In this case with the opscode rvm cookbook.
[2012-10-01 21:35:01 -0400] Urocyon: greenail: and I'm surprised that script didn't work on yours.  I had tested it on vagrant.
[2012-10-01 21:35:31 -0400] greenail: i seriously spent all day on it... something odd
[2012-10-01 21:35:48 -0400] greenail: and not with a single instance, many vagrant destorys
[2012-10-01 21:35:51 -0400] jtimberman: dougireton: #chef-hacking is for development discussion about anything chef related, cookbooks, chef itself, libraries, other development focused topics.
[2012-10-01 21:36:03 -0400] dougireton: ok
[2012-10-01 21:37:04 -0400] jtimberman: there's generally more people active in *this* channel at any given time though :)
[2012-10-01 21:37:25 -0400] jtimberman: but thats a matter of scale of 413 people vs 71 :)
[2012-10-01 21:37:59 -0400] Urocyon: greenail: rats!  I just destroyed and re-upped and got that same error.
[2012-10-01 21:39:44 -0400] mattray: poolpog: welcome!
[2012-10-01 21:39:55 -0400] poolpog: hi
[2012-10-01 21:40:20 -0400] poolpog: so, I have a shitload of questions about chef...
[2012-10-01 21:40:39 -0400] poolpog: but I will post them when I get to 'em... I just wanted to make sure I could get in here, first
[2012-10-01 21:40:40 -0400] poolpog: thanks
[2012-10-01 21:41:11 -0400] mattray: poolpog: fire away, this is a friendly channel
[2012-10-01 21:42:00 -0400] dougireton: Andrew Crump posted a great workaround for Chefspec testing for Windows cookbook_files: https://github.com/acrmp/chefspec/issues/53
[2012-10-01 21:42:29 -0400] poolpog: thanks
[2012-10-01 21:42:40 -0400] poolpog: I'll try to keep my *complaining* about chef to a minimu :)
[2012-10-01 21:42:46 -0400] poolpog: minimum*
[2012-10-01 21:44:22 -0400] Urocyon: greenail: http://tickets.opscode.com/browse/CHEF-2517
[2012-10-01 21:45:40 -0400] SplasPood: jtimberman: I'm thinking for use with tools like librarian or whisk with git repos
[2012-10-01 21:45:50 -0400] SplasPood: I could use commit refs, I suppose.
[2012-10-01 21:47:08 -0400] jtimberman: SplasPood: librarian (and berkshelf) both support using the cookbooks from the community site.
[2012-10-01 21:47:38 -0400] SplasPood: jtimberman: That they do, just wasn't what I was asking ;)
[2012-10-01 21:48:30 -0400] greenail: Urocyon, ya, i noticed {ENV{'HOME'}} was borked
[2012-10-01 21:51:57 -0400] jtimberman: sure.
[2012-10-01 21:56:36 -0400] greenail: urocyon, so you have to set the script user to root, and use "su -l -c '<command string>' <username>
[2012-10-01 21:56:52 -0400] greenail: and to make it even better, that blows away cwd, so you also need to cd
[2012-10-01 21:57:02 -0400] greenail: wow, i though chef had matured a bit more
[2012-10-01 21:58:12 -0400] Urocyon: It has it's dark corners.
[2012-10-01 21:58:16 -0400] Urocyon: its
[2012-10-01 21:58:35 -0400] greenail: ya, script is obviously one of them
[2012-10-01 22:01:02 -0400] Urocyon: It's a corner I usually avoid.
[2012-10-01 22:02:00 -0400] Urocyon: The dark corner that vexes me most often is install to RedHat.
[2012-10-01 22:02:28 -0400] Urocyon: Haven't figured out my chef-server bootstrap problem yet.
[2012-10-01 22:05:40 -0400] Urocyon: Apparently I'm not the first though.  This transcript has a guy that kludged it:  http://community.opscode.com/chat/chef/2012-08-01
[2012-10-01 22:06:55 -0400] Urocyon: another person said they worked around it by gem installing chef instead of using the omnibus.
[2012-10-01 22:07:22 -0400] Urocyon: https://gist.github.com/3677089
[2012-10-01 22:30:15 -0400] SplasPood: Urocyon: Coming to this very late, so this blind guess/comment is prolly something you've already heard
[2012-10-01 22:30:29 -0400] SplasPood: Urocyon: it looks like it's going to some attribute to find the 'root' of the install, but that attr is nil
[2012-10-01 22:30:34 -0400] SplasPood: No such file or directory - nil/gems/chef-10.14.0/distro/redhat/etc/sysconfig/chef-solr
[2012-10-01 22:31:10 -0400] Urocyon: Yep, it's looking for node["languages"]["ruby"]["gems_dir"]
[2012-10-01 22:31:38 -0400] Urocyon: I tried setting that in my json file, but it isn't picking that up for some reason.
[2012-10-01 22:31:54 -0400] SplasPood: hrm, ohai might be stepping on it
[2012-10-01 22:32:06 -0400] Urocyon: curse you, ohai!
[2012-10-01 22:32:19 -0400] SplasPood: interestingly, with the omnibus setup, you'd think that gem_dir wouldn't point to the right place anyway
[2012-10-01 22:32:22 -0400] SplasPood: that'd be the system ruby, if any
[2012-10-01 22:32:39 -0400] Urocyon: yep, ohai has it as nil
[2012-10-01 22:33:23 -0400] Urocyon: Is there a good way to convince ohai to change it's mind on that?
[2012-10-01 22:36:17 -0400] Urocyon: I've got to run, but if you have any ideas, post 'em and I'll check later.
[2012-10-01 22:54:59 -0400] NewToChef: Currently when I bootstrap an EC2 instance using knife, it installs chef-client v 0.10.4. Is there a way to get it to install the latest (or one of the more recent) version of chef-client?
[2012-10-01 22:56:12 -0400] kyleb: NewToChef: make sure you have the latest knife-ec2 gem installed. Also are you specifying a bootstrap script or distro?
[2012-10-01 22:58:58 -0400] NewToChef: Using knife-ec2 0.5.14 (think it is the latest).
[2012-10-01 22:59:09 -0400] NewToChef: I am not using a bootstrap script though
[2012-10-01 22:59:18 -0400] NewToChef: This is the command I issue:
[2012-10-01 22:59:51 -0400] NewToChef: knife ec2 server create -I ami-2e9b4751 sudo -x ubuntu -i <my_ssh_key>
[2012-10-01 23:01:56 -0400] NewToChef: kyleb: ANy guidance on how to use a bootstrap script would be much appreciated *sincere smile*
[2012-10-01 23:02:46 -0400] kyleb: NewToChef: Actually also need to make sure your chef gem is up to date on your workstation. The bootstraps scripts come from there.
[2012-10-01 23:03:28 -0400] NewToChef: workstatation --> Management workstation ?
[2012-10-01 23:03:57 -0400] kyleb: yes
[2012-10-01 23:04:26 -0400] NewToChef: Ok, thanks. Trying it now.
[2012-10-01 23:05:44 -0400] kyleb: NewToChef:  the recent versions of knife-ec2 should use the "chef-full" bootstrap script. If all your gems are up to date you can try adding '-d chef-full', that should use the new omnibus installer.
[2012-10-01 23:11:01 -0400] jassinpainAgain: hello all, still having issues with the knife index rebuild returning empty even though success is reported
[2012-10-01 23:12:00 -0400] NewToChef: Thanks kyleb. Works, in that, it is indeed installing the most recent version of Chef.
[2012-10-01 23:12:19 -0400] kyleb: NewToChef: Great, glad to hear.
[2012-10-01 23:12:54 -0400] NewToChef: It is failing to bootstrap as it's unable to add the EC2 instance o the managed Chef server I am using. I suppose I have to use encrypted data bags to pass the credentials across to the EC2 instance I spin up.
[2012-10-01 23:13:20 -0400] NewToChef: Or is there another, possibly more efficient, way to do that?
[2012-10-01 23:14:25 -0400] bluepojo: encrypted data bag question: I have 2 dev's machines with an identical encrypted_data_bag secret. When one dev encrypts a data bag (with -s path/to/key), the other devs get "Bad Decrypt" errors.
[2012-10-01 23:14:32 -0400] bluepojo: anyone see this behavior before?
[2012-10-01 23:14:42 -0400] bluepojo: recipes also get Bad Decrypt errors
[2012-10-01 23:15:51 -0400] bluepojo: this would indicate that the keys don't match
[2012-10-01 23:15:57 -0400] bluepojo: but I copied the keys directly
[2012-10-01 23:16:01 -0400] bluepojo: :(
[2012-10-01 23:16:15 -0400] jassinpainAgain: anyone else had problems post upgrade to 10.14 from 10.12 with index on lucid?
[2012-10-01 23:43:08 -0400] JasonF: Is there any way for a cookbook like chef-server, to disable it looking for the cookbooks it won't use? i.e. bluepill + daemontools for someone using runit for init
[2012-10-01 23:56:17 -0400] jassinpainAgain: to anyone following my index errors 10.16 no longer respects the old solr_url
[2012-10-01 23:56:38 -0400] jassinpainAgain: not sure if thats a regression but error reporting def is lacking
[2012-10-01 23:57:31 -0400] jassinpainAgain: maybe a regression of CHEF-2652
