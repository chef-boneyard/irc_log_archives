[2012-10-03 00:14:00 -0400] wdpro_kevin: appears ulimit is not a part of Ohai's data
[2012-10-03 00:14:21 -0400] wdpro_kevin: is there a way to set a variable/attribute in a recipe based on the result of an execute command?
[2012-10-03 00:14:21 -0400] wdpro_kevin: I want to check the ulimt of the server and not run the execute if matched my threshold
[2012-10-03 00:29:24 -0400] bluepojo: wdpro_kevin: perhaps write an ohai plugin to add the ulimit to the automatic attributes
[2012-10-03 00:29:40 -0400] bluepojo: then write an only_if clause that reads node[:automatic_attributes][:ulimit]
[2012-10-03 00:29:54 -0400] bluepojo: ohai plugins are dead simple
[2012-10-03 00:29:57 -0400] wdpro_kevin: I see a pull request for one in the ohai project
[2012-10-03 00:30:13 -0400] bluepojo: aha, then maybe you can use that one until ohai pulls it in
[2012-10-03 00:30:24 -0400] bluepojo: write a recipe to write the file to the box
[2012-10-03 00:30:33 -0400] bluepojo: then load the plugin
[2012-10-03 00:30:42 -0400] bluepojo: the nginx source recipe has an example of doing this, iirc
[2012-10-03 00:35:36 -0400] wdpro_kevin: cool thanks bluepojo
[2012-10-03 00:44:52 -0400] xmltok: anyone know of a good cookbook for managing /etc/network/interfaces on ubuntu? or should i just use a template. I need to configure bonding
[2012-10-03 00:48:02 -0400] flaccid_: hmm thats a good question, im not sure my self, but i guess you could search. it may be better to see if network.d is supported so its separate template if possible
[2012-10-03 00:50:05 -0400] bassclef: is there a method to obtain ip address like node.fqdn pulls hostname?
[2012-10-03 00:50:10 -0400] bassclef: node.ip?
[2012-10-03 00:53:07 -0400] flaccid_: bassclef: ohai | grep ips
[2012-10-03 00:53:21 -0400] flaccid_: there is keys for private and public IPs
[2012-10-03 00:56:29 -0400] bluepojo: nod.ipaddress
[2012-10-03 00:56:30 -0400] bluepojo: node
[2012-10-03 00:56:32 -0400] bluepojo: bassclef:
[2012-10-03 00:56:35 -0400] bassclef: thank you blue
[2012-10-03 00:57:07 -0400] flaccid_: oh i forgot about that, my bads
[2012-10-03 00:57:33 -0400] flaccid_: you can inspect/grep the output of ohai to find keys easily though
[2012-10-03 01:01:05 -0400] Chris1: Hello,
[2012-10-03 01:01:55 -0400] Chris1: I am doing this in a recipe,
[2012-10-03 01:01:55 -0400] Chris1: remote_file "/etc/chef/encrypted_data_bag_secret" do
[2012-10-03 01:01:55 -0400] Chris1: source "http://remoteserver.com/httpfiles/chef/secret"
[2012-10-03 01:01:56 -0400] Chris1: end
[2012-10-03 01:01:56 -0400] Chris1: and recieving this error: 
[2012-10-03 01:01:56 -0400] Chris1:  FATAL: Errno::ENOENT: No such file or directory - file not found '/etc/chef/encrypted_data_bag_secret'
[2012-10-03 01:01:56 -0400] Chris1: I'm stuck on this, on what could be wrong.
[2012-10-03 01:02:54 -0400] flaccid_: well the URI is redirecting
[2012-10-03 01:03:03 -0400] flaccid_: i assume its fake
[2012-10-03 01:03:10 -0400] flaccid_: does /etc/chef dir exist?
[2012-10-03 01:04:08 -0400] Chris1: Yes, I changed the URL. If I do wget with the real one, download works. Yes, /etc/chef/ exists
[2012-10-03 01:05:39 -0400] flaccid_: not quite sure. try debug log_level and look at the traceback
[2012-10-03 01:11:48 -0400] bemu: I've noticed a few times recently that search results contain results which it shouldn't on Hosted Chef. Has anyone else seen this issue?
[2012-10-03 01:23:07 -0400] bemu: ah, hoover_damm figured it out.
[2012-10-03 01:23:15 -0400] bemu: using role as opposed to roles causes this behavior
[2012-10-03 01:30:22 -0400] hoover_damm: I've not figured out the whole search(:node, "role:bob") and why it returns jill yet
[2012-10-03 01:30:27 -0400] hoover_damm: but I know the work around
[2012-10-03 01:58:06 -0400] hoover_damm: +1 line in 3 minutes... yay
[2012-10-03 02:03:11 -0400] tpot: hrm, what is the difference between knife search node role and knife node search roles?
[2012-10-03 02:03:46 -0400] hoover_damm: tpot, actually that's a question we were asking earlier
[2012-10-03 02:03:51 -0400] tpot: apart from there being no such thing as knife node serach
[2012-10-03 02:04:05 -0400] tpot: oddly enough there's a bug about that very thing i'm looking at now
[2012-10-03 02:04:18 -0400] hoover_damm: role is returning results you didn't expect?
[2012-10-03 02:04:46 -0400] tpot: it doesn't return nested roles
[2012-10-03 02:04:57 -0400] tpot: http://wiki.opscode.com/display/chef/Search#Search-FindNodeswithaRoleintheExpandedRunList
[2012-10-03 02:05:07 -0400] tpot: ah, search role does the run list, search roles the expanded run list
[2012-10-03 02:05:20 -0400] tpot: i.e what everyone expects it to do (-:
[2012-10-03 02:06:36 -0400] hoover_damm: yep
[2012-10-03 02:36:14 -0400] z: tpot: long time, no speak
[2012-10-03 02:36:46 -0400] j4m3s: i have an attribute in my template for @node[:bigcouch][:erlang][:cookie] and if i try to set bigcouch:{erlang:{cookie:"foobar"}} in my node file it doesn't work, but if i change the template to be @node[:bigcouch][:cookie] and change the node to bigcouch{cookie:"foobar"} it works
[2012-10-03 02:38:49 -0400] z: speaking of Erlang cookies
[2012-10-03 02:38:49 -0400] z: http://dan.carley.co/blog/2012/10/01/unautomating-with-puppet/
[2012-10-03 02:44:31 -0400] hoover_damm: heh, using drbd?
[2012-10-03 02:45:02 -0400] hoover_damm: I thought most people understood the dangers of DRBD and MySQL already (and they were well spoken of back in 2008)
[2012-10-03 02:45:31 -0400] ekristen: I see a read me saying this "node['mongodb']['cluster_name']" needs to be set on each node -- how do I do that?
[2012-10-03 02:47:32 -0400] z: hoover_damm: I know a lot of places still using DRBD, although, most of them stopped using it for MySQL
[2012-10-03 02:56:45 -0400] bassclef: i have a template that puts a ruby file in /tmp i open up a bash terminal and am trying to run it, but it doesn't appear to run..
[2012-10-03 02:58:42 -0400] bassclef: https://gist.github.com/3824692
[2012-10-03 02:58:48 -0400] bassclef: what am i doing wrong here?
[2012-10-03 02:59:27 -0400] bassclef: ope i see i think
[2012-10-03 02:59:37 -0400] ekristen: plural recipes search isn't workin
[2012-10-03 02:59:39 -0400] ekristen: working*
[2012-10-03 02:59:41 -0400] flaccid_: good idea to cite error
[2012-10-03 02:59:42 -0400] ekristen: how can I debug
[2012-10-03 02:59:53 -0400] ekristen: I have a server that has a role, which has recipes assigned
[2012-10-03 02:59:57 -0400] ty_: action is set to :nothing
[2012-10-03 03:00:08 -0400] bassclef: flaccid_: i get no error, it just doesn't do the ./registration.rb portion
[2012-10-03 03:00:14 -0400] ekristen: but when I do "search(:node "recipes:mongodb*")" it doesn't work
[2012-10-03 03:00:17 -0400] ty_: try disabling/removing that line and running again
[2012-10-03 03:00:22 -0400] bassclef: if i login to the machine and manually run it, it does exactly what it should
[2012-10-03 03:00:35 -0400] flaccid_: bassclef: prolly coz its not exectuable
[2012-10-03 03:00:41 -0400] bassclef: flaccid_: it is
[2012-10-03 03:00:45 -0400] bassclef: i login and run it just fine
[2012-10-03 03:00:46 -0400] bassclef: no changes made
[2012-10-03 03:00:51 -0400] bassclef: and it does what it's suppose to do.
[2012-10-03 03:01:00 -0400] flaccid_: what you are doing is wrong way to begin with thouh
[2012-10-03 03:01:07 -0400] ty_: bassclef: try removing this line   "  action :nothing "
[2012-10-03 03:01:16 -0400] bassclef: flaccid_: how should i do it?
[2012-10-03 03:01:32 -0400] flaccid_: oh yeah action nothing. i assumed you ran it later soz
[2012-10-03 03:02:01 -0400] bassclef: np, will give that a shot thanks
[2012-10-03 03:02:07 -0400] flaccid_: not much point putting a script in a template to then execute. you should port the script to chef which is what chef is for
[2012-10-03 03:02:32 -0400] flaccid_: also if you ran it in debug log level bassclef  you'd see it comment on doing nothing coz of action nothing
[2012-10-03 03:06:21 -0400] zts: ekristen: first things first, if you do "knife node show <yournode>", do you see "mongodb" in the Recipes: line?
[2012-10-03 03:06:53 -0400] ekristen: zts: no
[2012-10-03 03:06:56 -0400] ekristen: so I guess that is why
[2012-10-03 03:06:59 -0400] ekristen: question
[2012-10-03 03:07:06 -0400] ekristen: zts: I see it has the right role
[2012-10-03 03:07:13 -0400] ekristen: ack
[2012-10-03 03:07:14 -0400] ekristen: wait
[2012-10-03 03:07:14 -0400] ekristen: wtf
[2012-10-03 03:07:27 -0400] ekristen: ok so the Run List has the role[mongodb-server]
[2012-10-03 03:07:33 -0400] ekristen: but my Roles and Recipes are blank
[2012-10-03 03:08:58 -0400] ekristen: zts how do I assign the role to the node and not just to the run list?
[2012-10-03 03:10:33 -0400] yfeldblum: ekristen, when you update a node's run-list using knife and then run `knife node show` for that node, you see that the node's run-list has indeed been updated, and that means: on the next chef-client run, that node will use that newly-updated run-list (barring any further changes to that node's run-list between now and when chef-client is run on that node next)
[2012-10-03 03:11:06 -0400] yfeldblum: ekristen, but when you update a node's run-list, that does not affect the node's "recipes" and "roles" attributes
[2012-10-03 03:11:28 -0400] ekristen: ok -- so how do I update the roles and recipes attributes? can I do it through the chef web ui?
[2012-10-03 03:11:36 -0400] zts: ekristen: no, you just run chef-client
[2012-10-03 03:11:43 -0400] yfeldblum: ekristen, those attributes are only calculated and written during chef-client runs, and are only saved at the end of successful chef-client runs
[2012-10-03 03:12:16 -0400] ekristen: hrm -- ok, I think I know what is happening, the chef-client run is terminating (I think)
[2012-10-03 03:12:34 -0400] yfeldblum: ekristen, they serve as a record of, top-level, what happened during the last chef-client run; they do not serve as a record of what will happen on the next chef-client run (only the run-list serves as a forward-looking indicator)
[2012-10-03 03:13:49 -0400] ekristen: hrm ok
[2012-10-03 03:14:12 -0400] yfeldblum: Chris1, a recipe to copy a key seems odd; most people *provision* the key during the bootstrap, which happens before the initial chef-client run (or during a subsequent "re-bootstrap" if you like)
[2012-10-03 03:15:16 -0400] ekristen: yfeldblum and zts: ok I re-ran the chef-client and now everything has populated properly
[2012-10-03 03:15:17 -0400] ekristen: thank you!
[2012-10-03 03:15:18 -0400] yfeldblum: ekristen, and yes, if the next chef-client run fails, then it will not save the expanded run list (the "roles" and "recipes" attributes) to the chef-server
[2012-10-03 03:19:07 -0400] zts: Chris1: the code suggests that the secret will be loaded when you use Chef::EncryptedDataBagItem, not earlier in the run, so what you're describing doesn't match the (current) code
[2012-10-03 03:19:52 -0400] zts: Chris1: what version of chef-client are you using?  And please, pastebin logs that show what's happening in your chef-client run..
[2012-10-03 03:22:55 -0400] zts: ...or not
[2012-10-03 04:02:59 -0400] tpot: hi z
[2012-10-03 04:03:19 -0400] tpot: changed laptops and lost my irc settings a while ago...
[2012-10-03 04:03:59 -0400] tpot: erlang cookies were driving me crazy yesterday
[2012-10-03 04:05:41 -0400] z: aha :)
[2012-10-03 05:44:15 -0400] ty_: Greetings! I've just finished porting the configuration management bits of (in-house, proprietary) cloud software from Puppet to Chef (Solo), and am pleased with the result. Next, I want to go on to leverage Chef's concept of programmable infrastructure, but I'm having difficulty identifying a sane way to port to Chef the existing stable of scripts that configure and setup the cloud & services that run on the management nodes. I've examined rewriting the
[2012-10-03 05:44:15 -0400] ty_: scripts as Knife plugins, Knife "exec scripts," and Chef recipes, but I'm still hazy on how to accomplish this task. Any suggestions?
[2012-10-03 06:28:57 -0400] zts: ty_: I'm having trouble envisaging what you have in mind - can you give a concrete example?
[2012-10-03 06:50:16 -0400] ty_: zts: Thanks for responding :)  Concrete example: After bringing up a management node + storage node cluster for the first time, the storage nodes need to be registered in a DB on the management node. At the moment, we accomplish this by hand with a series of commands.
[2012-10-03 06:51:22 -0400] ty_: Post automation, ideally the operators would need only type in a single command, such as: knife cloud register storage
[2012-10-03 06:59:31 -0400] ty_: Currently, this is accomplished by: (1) Write JSON files, (2) Register the JSON files with the management node DB system with a shell command, (3) Run a sequence of "cluster" commands that perform operations on the storage hosts. In all, a total of 6 shell commands summarized in screens-worth of wiki documentation.
[2012-10-03 07:03:59 -0400] ty_: I'm hoping that coming an understanding of the Chef idioms that can naturally apply to this task will give me a foothold to automate all such tasks with Chef :D
[2012-10-03 07:08:51 -0400] ty_: Excepting command-line parameters, I know how to rewrite the current command scripts using Chef's recipe DSL as a result of a simple thought exercise.
[2012-10-03 07:19:50 -0400] twohey: i've read about an erlang based successor to the current chef server
[2012-10-03 07:20:05 -0400] twohey: but there is surprisingly little public information
[2012-10-03 07:20:24 -0400] twohey: where can I go to understand how the codebase will evolve (or is this channel the right place)?
[2012-10-03 07:22:25 -0400] zts: ty_: thanks for the example, that's a good start (although I find it hard to give good advice here - there are many ways you could approach the problem)
[2012-10-03 07:22:53 -0400] zts: ty_: one question, would you ideally have an operator running a command to register the new storage node, or could you have the storage node register itself when ready?
[2012-10-03 07:22:54 -0400] ty_: zts: if you could share with me the ways that come to mind!
[2012-10-03 07:23:23 -0400] ty_: interesting. presently, the processes & culture in place demands that operators run that by hand. however, my task is automation, after all.
[2012-10-03 07:23:48 -0400] ty_: to keep it simple, let's say the operator will run it.
[2012-10-03 07:25:09 -0400] zts: ty_: I'll come at that from the other direction instead :)
[2012-10-03 07:25:23 -0400] zts: ty_: one thing you could consider is encapsulating some of your functionality in LWRPs http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers
[2012-10-03 07:26:09 -0400] zts: ty_: as a practical example, consider the ones provided by the AWS cookbook: https://github.com/opscode-cookbooks/aws
[2012-10-03 07:26:39 -0400] ty_: zts: OK. I have implemented 2 LWRPs thus far, so I am familiar with those. I'll look at the AWS ones now.
[2012-10-03 07:26:47 -0400] zts: ty_: that's going to be useful if you wanted to have your nodes register particular things with the management node, from within your recipes.  If you want to do it out of band, perhaps less useful
[2012-10-03 07:27:49 -0400] zts: ty_: you can of course use the Execute and Script resources to invoke arbitrary things on your system.  If you only want to run them once, a couple of ideas are setting node attributes to record the fact, or touching files for the same reason - either way, use not_if clauses to prevent running a second time
[2012-10-03 07:28:04 -0400] ty_: zts: For example, ebs_volume provides verbs not unlike what I have on hand here.
[2012-10-03 07:28:37 -0400] ty_: zts: Right. I am attempting to maintain idempotency.
[2012-10-03 07:29:24 -0400] zts: yeah, that's always where the fun starts :)  I like wrapping that kind of thing up in definitions/LWRPs/etc so that I don't need to remember to do it correctly in every recipe
[2012-10-03 07:29:26 -0400] ty_: zts: How could operators access this functionality from the command line? For example, to attach a specified volume to a given host.
[2012-10-03 07:30:03 -0400] zts: well, that's a bit of a grey area - Chef doesn't really offer a great deal in the way of orchestration
[2012-10-03 07:30:33 -0400] zts: One thing I've done in the past is had chef-solo recipes which were invoked via MCollective
[2012-10-03 07:31:09 -0400] zts: but you could equally write a knife plugin that (say) used the ssh plugin to connect to the required host(s) and invoked chef-solo with your predefined recipes
[2012-10-03 07:31:25 -0400] zts: I'm not wild about the idea, but it could be something to explore
[2012-10-03 07:31:49 -0400] ty_: zts: ic. I have experience with MCollective with Puppet. I notice that knife has an SSH subcommand.
[2012-10-03 07:32:35 -0400] ty_: zts: Is there a way to connect a knife command invocation with running a specific Chef recipe?
[2012-10-03 07:33:36 -0400] zts: ty_: it's worth noting that ssh is the only way that knife has of running something on a node - it can't directly run chef-client, or anything like that
[2012-10-03 07:34:02 -0400] zts: ty_: so you can ssh to the node and run chef with a particular run_list - and you could wrap that up into a knife plugin
[2012-10-03 07:34:19 -0400] ty_: zts: knife appeals to me in that it allows operators to serendipitously discover commands.
[2012-10-03 07:35:03 -0400] ty_: zts: OK. I'll take this as a candidate solution. Thanks!
[2012-10-03 07:35:04 -0400] zts: ty_: so long as your operators will all be able to ssh to the nodes in question, and use sudo to invoke chef, that'll probably work just fine
[2012-10-03 07:35:18 -0400] ty_: zts: Indeed they can.
[2012-10-03 07:35:57 -0400] ty_: zts: What other avenues can I pursue?
[2012-10-03 07:36:25 -0400] ty_: zts: I was looking at Shef yesterday. It seems to have advantages and limitations in terms of capabilities.
[2012-10-03 07:36:44 -0400] zts: ty_: yeah, Shef's more for debugging and cookbook development, rather than a useful administrator tool in its own right
[2012-10-03 07:36:58 -0400] ty_: zts: Understood.
[2012-10-03 07:37:30 -0400] zts: actually that's a bit harsh, it's a very useful administrator tool
[2012-10-03 07:37:36 -0400] zts: just not for the kind of application you're describing
[2012-10-03 07:37:51 -0400] ty_: BTW, you seem to type quite fast!
[2012-10-03 07:38:22 -0400] zts: past that, my best suggestion would be to try things out and iterate... we went through a variety of solutions before landing on the ones that worked for us, and didn't end up with a "one sie fits all" solution
[2012-10-03 07:38:31 -0400] zts: I spend too much time on IRC :)
[2012-10-03 07:41:19 -0400] ty_: zts: I went through the knife plugin tutorial, and felt comfortable with that. As a result, my ignorant, direct image of the solution left me questioning "Is there a way to directly write knife commands partially using the recipe DSL and parameterization?"
[2012-10-03 07:42:24 -0400] zts: ty_: not that I'm aware of, but (if you haven't) I would encourage you to do a good search for useful knife plugins, as there may be some good prior art
[2012-10-03 07:43:26 -0400] zts: eg, I believe there's a knife-solo (which I haven't used), there's a knife-server for managing chef servers
[2012-10-03 07:43:45 -0400] zts: I've not personally done much with knife plugins, but there's definitely some cool stuff out there
[2012-10-03 07:44:25 -0400] ty_: zts: I read the majority of the opscode-official knife "cloudy" plugins source code. I didn't glean much from those, and they appeared to adhere to the same pattern, with a base class (Mix-In) and unique functionality per class/command.
[2012-10-03 07:44:37 -0400] ty_: zts: I'll look elsewhere, in particular those ones you mentioned. Thanks!
[2012-10-03 07:54:15 -0400] ty_: zts: oops.  s/elsewhere/at other knife plugins/
[2012-10-03 07:55:12 -0400] zts: ty_: no problem
[2012-10-03 07:55:33 -0400] zts: ty_: I think that's me done for rambling advice, hope it leads you to some useful insights!
[2012-10-03 07:57:12 -0400] ty_: zts: Yes, thanks to your aide, I learned that it's possible to write a knife plugin that runs chef with a particular run_list on a particular node (ssh)
[2012-10-03 07:57:43 -0400] ty_: zts: And, I can glean ideas from the wealth of existing knife plugins.
[2012-10-03 08:00:15 -0400] ty_: zts: I'll also examine knife-{solo,server}
[2012-10-03 10:18:23 -0400] kernelPanik: hello guys!
[2012-10-03 10:19:52 -0400] kernelPanik: I'm writing the attributes of my cookbook.. Can I call variables default[..][...]  declared before?
[2012-10-03 10:22:40 -0400] masterkorp: define declared before
[2012-10-03 10:34:56 -0400] kernelPanik: thanks <masterkorp>
[2012-10-03 10:35:57 -0400] kernelPanik: and for get the ip address of the node into  attributes/default.rb ?
[2012-10-03 10:39:13 -0400] masterkorp: I did not understand your question, please rephrase
[2012-10-03 11:32:50 -0400] bassclef: kernel default[:some][:variable] = node.ipaddress
[2012-10-03 11:33:53 -0400] bassclef: GRRRRRRRRR
[2012-10-03 11:33:59 -0400] bassclef: i don't tget this
[2012-10-03 11:55:43 -0400] masterkorp: bassclef:  default["some"]["variable"] = node["ipaddress"]
[2012-10-03 12:03:04 -0400] ekristen: morning
[2012-10-03 12:03:22 -0400] ekristen: anyone in here use the mongodb cookbook?
[2012-10-03 12:04:00 -0400] ekristen: I've found that the mongodb instance doesn't finish getting started until a minute or two after all my chef jobs run, is there any way to delay my chef configuration recipes until that mongodb service has fully started?
[2012-10-03 12:14:35 -0400] bklang: Hello all.  I'm trying to use remote_file to fetch an asset needed for a recipe, but I'm forced to use an HTTP Proxy.  I've set Chef::Config[:http_proxy] but it does not seem to apply. Am I doing it wrong?
[2012-10-03 12:16:19 -0400] gyre007: shef is segfaulting on 10.14.4 https://gist.github.com/3826629
[2012-10-03 12:16:26 -0400] gyre007: Shef...not Chef :)
[2012-10-03 12:16:34 -0400] gyre007: anyone seeing the same thing ?
[2012-10-03 12:24:17 -0400] ekristen: how can I delay a ruby_block from executing until a condition is met?
[2012-10-03 12:31:18 -0400] gyre007: oh boy
[2012-10-03 12:31:21 -0400] gyre007: yup its broken
[2012-10-03 12:43:48 -0400] masterkorp: yeah i am having that same problem too
[2012-10-03 12:46:16 -0400] erthad: hi, all
[2012-10-03 12:46:48 -0400] erthad: is there a way to add dependency on a module to a module taken from github rather than taken from a forge?
[2012-10-03 12:47:46 -0400] erthad: I mean doing that through metadata.rb but not using librarian
[2012-10-03 12:56:47 -0400] gyre007: masterkorp, I raised a ticket with opscode: http://tickets.opscode.com/browse/CHEF-3498
[2012-10-03 12:57:14 -0400] masterkorp: sweet i never got the time to do that
[2012-10-03 12:57:28 -0400] masterkorp: will follow
[2012-10-03 12:57:50 -0400] jb__: https://www.facebook.com/photo.php?fbid=10151086731737898&set=o.99334479301&type=1
[2012-10-03 12:57:52 -0400] jb__: ;-)
[2012-10-03 13:23:59 -0400] rep0st: has anybody uploaded a cookbook to their chef server add it to the run list (specifically i'm using user::data_bag) then manually run chef-client on the server and it doesn't run as expected (adding users to the machine from the data_bag)
[2012-10-03 13:56:49 -0400] benner: hi
[2012-10-03 13:59:34 -0400] rep0st: hello
[2012-10-03 14:01:26 -0400] maxmanders: I'm aware that you can use `knife node edit` to override attributes on a per-node basis.  However, if using `knife bootstrap...` the node won't necessarily exist yet. How does one bootstrap a node with knife *and* pass node overrides to that node?
[2012-10-03 14:08:01 -0400] benner: can anyone give some url or other hit where to look about mixing community and self made cookboks?
[2012-10-03 14:08:50 -0400] kernelPanik: hi guys,  to show all variables associated at a node?  like node["ipaddress"]
[2012-10-03 14:10:56 -0400] erthad: maxmanders: by passing JSON with -j key?
[2012-10-03 14:15:10 -0400] maxmanders: erthad: Thanks, I'll give it a shot.  Sadly however, `knife node create` has apparently encountered an unexpected error now :-(
[2012-10-03 14:16:03 -0400] chin-tastic: benner: I haven't seen any resources around, but I've used a combination of include_recipe and just plain editing the community cookbook to do what I want.
[2012-10-03 14:17:22 -0400] LinuxHorn: haven't google it yet, but is there a knife module yet for kicking rackspace next-gen openstack cloud servers?
[2012-10-03 14:17:35 -0400] LinuxHorn: looks like the knife rackspace module is still using the old stuff
[2012-10-03 14:20:50 -0400] bradgignac: LinuxHorn: pull request is up
[2012-10-03 14:21:04 -0400] LinuxHorn: for the knife rackspace module?
[2012-10-03 14:21:05 -0400] bradgignac: LinuxHorn: hopefully it will be released this week
[2012-10-03 14:21:05 -0400] yfeldblum: maxmanders, pass JSON with -j to `knife bootstrap`
[2012-10-03 14:21:11 -0400] bradgignac: LinuxHorn: yeah
[2012-10-03 14:21:13 -0400] LinuxHorn: sweet
[2012-10-03 14:21:15 -0400] maxmanders: yfeldblum: Thanks
[2012-10-03 14:21:32 -0400] bradgignac: LinuxHorn: https://github.com/opscode/knife-rackspace/pull/25
[2012-10-03 14:21:33 -0400] LinuxHorn: i like how i have to come to the #chef channel to have another racker answer a question for me :)
[2012-10-03 14:21:34 -0400] bradgignac: for reference
[2012-10-03 14:21:49 -0400] LinuxHorn: awesome
[2012-10-03 14:22:15 -0400] LinuxHorn: hehe
[2012-10-03 14:22:22 -0400] LinuxHorn: IRC is fun
[2012-10-03 14:23:15 -0400] rep0st: lol alot of Rackers in here i assume
[2012-10-03 14:23:55 -0400] LinuxHorn: Rackers of the world unite!
[2012-10-03 14:24:10 -0400] rep0st: i always wonder if i bump into a past LT
[2012-10-03 14:24:10 -0400] Drewzar: Hack the planet!
[2012-10-03 14:24:14 -0400] rep0st: lulz
[2012-10-03 14:24:16 -0400] rep0st: RISC is good
[2012-10-03 14:24:40 -0400] rep0st: gots to get that garbage file y0!
[2012-10-03 14:24:50 -0400] LinuxHorn: take form of fanatical support, a commitment to greatness, full transparency, passion for our work, and treating each other like friends and family!
[2012-10-03 14:25:05 -0400] bradgignac: it just got really nerdy in here
[2012-10-03 14:25:18 -0400] jwitrick: worse then that.
[2012-10-03 14:25:30 -0400] LinuxHorn: good times
[2012-10-03 14:25:47 -0400] rep0st: rackspace once sent my boss a bottle of bbq sauce...he never used it in fear that they laced it with rat poison
[2012-10-03 14:27:44 -0400] LinuxHorn: i'm assuming its Rudy's BBQ sauce
[2012-10-03 14:27:49 -0400] LinuxHorn: that stuff is awesome
[2012-10-03 14:28:07 -0400] rep0st: yes
[2012-10-03 14:28:22 -0400] LinuxHorn: by this point I think all the Austin and San Antonio Rackers have replaced our blood with Rudy's sauce
[2012-10-03 14:28:42 -0400] LinuxHorn: which can't be good for our cholesterol
[2012-10-03 14:28:47 -0400] rep0st: oo they still have a team out in SAT?
[2012-10-03 14:28:56 -0400] LinuxHorn: SAT is where our HQ is
[2012-10-03 14:28:58 -0400] rep0st: for some reason i thought they decommed SAT
[2012-10-03 14:29:00 -0400] rep0st: LOL
[2012-10-03 14:29:01 -0400] LinuxHorn: The Castle
[2012-10-03 14:29:15 -0400] LinuxHorn: we bought a 1.5million square foot shopping mall
[2012-10-03 14:29:21 -0400] LinuxHorn: and turned it into HQ
[2012-10-03 14:30:15 -0400] benner: chin-tastic: i found, that i can separete own cookbook and comunity by setting 'cookbook_path      [ "chef-repo/cookbooks", "chef-repo/site-cookbooks" ]'
[2012-10-03 14:30:51 -0400] Psy-Q: hello
[2012-10-03 14:31:39 -0400] Psy-Q: it seems chef-solo 10.14.4 detects my debian platform version wrong. it uses the <5.0 attributes even though i'm running wheezy (7.0)
[2012-10-03 14:31:48 -0400] Psy-Q: s/wrong/wrongly/
[2012-10-03 14:32:40 -0400] Psy-Q: i found this while installing postgresql via the official postgresql cookbook. do i have to set my platform version explicitly somewhere or should chef detect it?
[2012-10-03 14:32:59 -0400] LinuxHorn: we even have our own mode of transportation from floor 2 to floor 1 in the mall:  http://www.youtube.com/watch?v=9ddW2RMpVAQ
[2012-10-03 14:33:54 -0400] rep0st: what DC did rackspace decomm almost 1.5 years ago?
[2012-10-03 14:34:05 -0400] rep0st: i remember i had to migrate off of that DC to ORD
[2012-10-03 14:35:55 -0400] LinuxHorn: hmmm, not sure...  i've only been here 9 months...  possibly our old SAT DC
[2012-10-03 14:36:11 -0400] LinuxHorn: that would make sense per your prior comments of us decomming SAT
[2012-10-03 14:36:26 -0400] Psy-Q: it seems that ohai reports "platform" as "debian" and "platform_version" as "wheezy/sid", which is what debian write to the release file
[2012-10-03 14:36:32 -0400] Psy-Q: but it seems that recipes cannot deal with that (?)
[2012-10-03 14:36:46 -0400] Psy-Q: err, i mean cookbooks cannot deal with that. they ask for a numeric version instead (?)
[2012-10-03 14:37:27 -0400] Psy-Q: because of course "wheezy/sid".to_f won't return anything meaningful, which the postgresql cookbook wants
[2012-10-03 14:38:28 -0400] Psy-Q: actually, it returns 0.0, which is <= 5.0, so the cookbook erroneously uses config information for an ANCIENT debian release on the very latest one :)
[2012-10-03 14:38:32 -0400] yfeldblum: Psy-Q, then the postgresql cookbook is wrong
[2012-10-03 14:39:02 -0400] yfeldblum: Psy-Q, because various platforms do not use numbers for their platform versions; instead, they use strings
[2012-10-03 14:39:09 -0400] Psy-Q: yfeldblum: indeed
[2012-10-03 14:39:17 -0400] Psy-Q: should i fix the official cookbook and send them a pull request?
[2012-10-03 14:39:35 -0400] yfeldblum: Psy-Q, that would be a nice thing to do
[2012-10-03 14:40:11 -0400] Psy-Q: alright, i'll give it a go (means we first have to see if the version's a string though, because if it's a string that looks and quacks like a float in older debians, we don't want to break that)
[2012-10-03 14:40:27 -0400] yfeldblum: Psy-Q, but if it's an Opscode-maintained cookbook, please take a look at their guidelines for contributing: http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-10-03 14:41:12 -0400] yfeldblum: Psy-Q, Opscode uses their JIRA setup to manage projects, rather than github issues or pull-requests
[2012-10-03 14:41:35 -0400] Psy-Q: yfeldblum: oh, argh. okay!
[2012-10-03 14:42:15 -0400] yfeldblum: Psy-Q, so you can send a pull request, but also open a ticket in their JIRA and link to the pull request so that they see it in the place they normally look for contributions :D
[2012-10-03 14:44:18 -0400] geekbri: I usually make sure to link the jira to the pull request and the pull request to the jira
[2012-10-03 14:44:27 -0400] geekbri: Cover all your bases :)
[2012-10-03 14:47:13 -0400] Psy-Q: ah, they already fixed it in two other cookbook releases
[2012-10-03 14:47:21 -0400] Psy-Q: one of them already deprecated :)
[2012-10-03 14:47:30 -0400] Psy-Q: so i guess it was just an URL pointing at the wrong cookbook repository somewhere
[2012-10-03 14:48:49 -0400] poolpog: hello, I don't have a question, I just wanted to say thanks to whallever helped me yesterday; I got "it" to work
[2012-10-03 14:49:02 -0400] poolpog: plus no one here gives a shit, so I thought I'd tell *someone*
[2012-10-03 14:49:11 -0400] poolpog: thanks!
[2012-10-03 14:50:58 -0400] railsraider: hi, I am trying to set an attribute via a libraries(default.rb) node.set['nagios']['mysql']['production']['active_slaves'] = active
[2012-10-03 14:51:03 -0400] railsraider: active is an array
[2012-10-03 14:51:21 -0400] railsraider: but i get an error Attribute active_slaves is not defined!
[2012-10-03 14:51:33 -0400] railsraider: what does it mean?
[2012-10-03 14:51:47 -0400] railsraider: i tried to setup an empty default attribute
[2012-10-03 14:51:51 -0400] railsraider: didn't work
[2012-10-03 14:52:59 -0400] railsraider: doh! nm
[2012-10-03 14:53:33 -0400] Psy-Q: https://github.com/opscode-cookbooks <-- are these the official cookbooks?
[2012-10-03 14:53:44 -0400] Psy-Q: i'm getting confused, i saw three different links now :(
[2012-10-03 14:53:59 -0400] Psy-Q: and in one, the postgres cookbook seems fixed for debian
[2012-10-03 14:54:39 -0400] rep0st: poolpog: could've gone on reddit for that
[2012-10-03 14:56:26 -0400] geekbri: not sure what you meant when you say nobody here gives a shit.  I think the chef community gives many shits.
[2012-10-03 14:57:35 -0400] j|: Ohio
[2012-10-03 14:59:12 -0400] poolpog: geekbri, sorry, I meant nobody *here* -- here, next to me , in my office
[2012-10-03 14:59:54 -0400] poolpog: my assumption is that everyone *here*, in IRC, understands what it is like to bang your head against a sysadmin problem and finally get it
[2012-10-03 15:01:28 -0400] rep0st: poolpog: everyday..but the satisfaction of getting to the end solution is what keeps me going
[2012-10-03 15:04:05 -0400] geekbri: Just remember if you bang your head against a wall long enough there are generally 2 outcomes.  Either the wall falls down or you do
[2012-10-03 15:05:54 -0400] j|: geekbri: or someone walks up to your desk and has "something urgent"
[2012-10-03 15:06:18 -0400] poolpog: yeah, that is more typical
[2012-10-03 15:06:32 -0400] poolpog: the unrelated tangential outcome
[2012-10-03 15:07:10 -0400] j|: yup.
[2012-10-03 15:07:47 -0400] j|: rep0st: so you're in pursuit of the "final solution" you'd say, huh? yikes.
[2012-10-03 15:09:01 -0400] maxmanders: I'm trying to bootstrap a node with knife bootstrap.  I've created a node, which includes a name, runlist and environment.  Im trying to run `knife bootstrap ... <ip> -N 'name_of_node'... and receive 401 errors.  Is this the correct wy to bootstrap an existing unbootstrapped node by nodename?
[2012-10-03 15:15:00 -0400] rep0st: j|: lol i'm in the pursuit of happiness
[2012-10-03 15:15:46 -0400] j|: rep0st: sorry Sir, but Thomas Jefferson died years ago. Please step into the office of DHS and let us have a word with you.
[2012-10-03 15:16:00 -0400] neilsmind: hello everyone - Is it possible to us "link" to symlink a directory? I keep running into an error that reports the source directory "Is a directory". Um, yeah...that's what I want to symlink
[2012-10-03 15:17:01 -0400] j|: neilsmind: you're using the 'link' resource?
[2012-10-03 15:17:18 -0400] neilsmind: jl: yes
[2012-10-03 15:17:29 -0400] neilsmind: trying to anyway
[2012-10-03 15:17:31 -0400] cwj: sounds like you have the direction of your link backwards, try swapping the values of the name and the to attribute
[2012-10-03 15:25:30 -0400] ranjibd: neilsmind,  man ln
[2012-10-03 15:25:37 -0400] j|: hm. if you have the direction "backwards", that would mean you have: ln -s <link_name> <dir>
[2012-10-03 15:25:58 -0400] j|: which wouldn't exit with an error.
[2012-10-03 15:26:22 -0400] j|: not on linux nor BSD anyway (not sure what the provider is in this case...)
[2012-10-03 15:27:42 -0400] j|: it will just a make a link to the link itself inside of the named directory.
[2012-10-03 15:28:02 -0400] j|: "Is a directory" error sounds like you're trying to hardlink a directory maybe?
[2012-10-03 15:28:17 -0400] maxmanders: Still not working.  Created a new node, rather than allowing knife bootstrap to create it.  Remove the -r {runlist} param and added runlists to node... The node options seem to have been ignored.
[2012-10-03 15:28:45 -0400] j|: neilsmind: make sure your link resource isn't making hard links?
[2012-10-03 15:29:43 -0400] j|: maxmanders: why ignored? the run list isn't executed? the node isn't registered with the server at the end? there is an effect you are looking for on the node that doesn't take place?
[2012-10-03 15:30:34 -0400] maxmanders: jl: the log written to screen show chef evaluating an empty runlis, even though I've specified a runlist when creating the node with knife.
[2012-10-03 15:31:33 -0400] j|: knife node show?
[2012-10-03 15:31:38 -0400] j|: does it show the run_list?
[2012-10-03 15:31:45 -0400] maxmanders: jl: previously I was using -r and the node was created as part of the bootstrap.  I wanted to change this to speify the runlist in a file and explicitly create the node name first: knife bootstrap windows <ip> -N <name> -x <user> -P <password>; I'd expected it to read settings from the node <name> that was previously created.
[2012-10-03 15:32:37 -0400] neilsmind: jl: thanks. I'll check the hard link thing as well as order (though I copy/pasted the link example)
[2012-10-03 15:32:41 -0400] neilsmind: jl: thank you
[2012-10-03 15:32:43 -0400] j|: yea, I've mostly used knife bootstrap to bootstrap ec2 instances from scratch. I've only done a warm bootstrap a few times.
[2012-10-03 15:32:43 -0400] zts: maxmanders: unless you've changed the bootstrap script, it will probably be passing in a first-boot.json that empties the runlist for the first run
[2012-10-03 15:32:45 -0400] maxmanders: jl: Hmmm - I'm too full of the cold to have a functioning brain.
[2012-10-03 15:32:59 -0400] maxmanders: jl: I'll report back if I have problems after doing my job properly!  Apologies!
[2012-10-03 15:33:19 -0400] maxmanders: zts: That might be it - I am sure I created the node with the runlist - but not it's gone
[2012-10-03 15:33:44 -0400] maxmanders: zts: So I need to make some changes to first-boot.json
[2012-10-03 15:33:54 -0400] j|: maxmanders: well, when you're bootstrapping, it's going to check for the client key file
[2012-10-03 15:34:20 -0400] j|: if the key exists, it will contact chef server and say "Hi, I am ClientWhatever"
[2012-10-03 15:34:54 -0400] maxmanders: Well what I'm trying to achieve is to bootstrap a new node _and_ pass node overrides.  I could store these in json in Git, but thought I'd just edit the node with th overrides.
[2012-10-03 15:34:55 -0400] j|: and then the chef server will say "Hey, I have a run_list for someone with that Name as verified by your key, here it is"
[2012-10-03 15:35:07 -0400] maxmanders: jl: so should I continue to specify the runlist on the cli, but edit the node with just the overrides?
[2012-10-03 15:40:04 -0400] j|: maxmanders: explain what you mean by "edit the node with just the overrides"
[2012-10-03 15:40:13 -0400] j|: knife node edit?
[2012-10-03 15:40:50 -0400] j|: b/c I've never seen that used for editing node attributes, which I'm assuming you mean by "override", but "override" level attribs are set in envs, roles and recipes
[2012-10-03 15:40:54 -0400] j|: so you've lost me.
[2012-10-03 15:41:17 -0400] maxmanders: jl: yeah - knife node edit, add the overrides in there... and then knife bootstrap... -r{runlist}... THe idea being the node will bootstrap with the runlisjt on the cli, then apply the overrides from the edited node
[2012-10-03 15:41:40 -0400] neilsmind: jl: here is the snippet - https://gist.github.com/3827647
[2012-10-03 15:41:54 -0400] j|: maxmanders: what are you changing when you edit the node?
[2012-10-03 15:41:54 -0400] neilsmind: jl: by default, it's a symlink, right?
[2012-10-03 15:42:02 -0400] rep0st: anybody here use knife xenserver?
[2012-10-03 15:42:10 -0400] maxmanders: jl:forgive my mixed terminolog - just getting started... let me put this another way.  I have a set of recipes that will be applied to one or more nodes via  arole.  Each of these nodes necessarily has per-node settings.
[2012-10-03 15:42:20 -0400] neilsmind: yikes - I did get the order wrong
[2012-10-03 15:42:33 -0400] maxmanders: jl: so I'd like to apply a role or roles to one or more common nodes, but also override per-node values for the recipes.
[2012-10-03 15:44:09 -0400] j|: neilsmind: :|
[2012-10-03 15:44:15 -0400] rgsteele: Is there any reason using a template resource in a 'notifies' block would be undesirable?  I'm not sure if it would cause constant notification of the dependent resource because the template gets changed due to variable insertion.
[2012-10-03 15:45:26 -0400] j|: maxmanders: you've checked the attribute precendece? (http://wiki.opscode.com/display/chef/Attributes)
[2012-10-03 15:46:09 -0400] yfeldblum: rgsteele, what's a "'notifies' block"?
[2012-10-03 15:46:59 -0400] yfeldblum: rgsteele, also what do "constant notification", "dependent resource", and "variable insertion" mean?
[2012-10-03 15:46:59 -0400] zts: maxmanders: you should be able to pass those attributes into your "knife bootstrap" command directly - see the --json-attributes option
[2012-10-03 15:47:04 -0400] rgsteele: yfeldblum: e.g.: notifies :run,  "file[foo]",  :immediately
[2012-10-03 15:47:17 -0400] maxmanders: jl: Yup - and my goal was to set the attributes as per the 'Node Attributes' section, i.e. setting the attribute value on the node rather than in a role or environment.
[2012-10-03 15:47:33 -0400] zts: maxmanders: but I think that if the node exists, and you have already set some override attributes on it, then yes they should be used when chef-client first runs.  I am not certain, but I think it should work
[2012-10-03 15:48:08 -0400] j|: yea, try zts' suggestion. I'm actually avoiding node-level attributes so I don't have any snowflakes
[2012-10-03 15:48:10 -0400] rgsteele: yfeldblum: I'm not sure if it puts the template on the fs, then substitutes the ruby blocks w/ the contents of the variables used in the templates, or if it creates the static file before putting the template on the filesystem
[2012-10-03 15:48:13 -0400] maxmanders: Your help is appreciated jl and zts - I think I'm on the right track - just have to keep hacking ;-)
[2012-10-03 15:48:21 -0400] rgsteele: If it's the former, then the 'notifies' action will run every single time
[2012-10-03 15:48:31 -0400] maxmanders: jl: Ideally I'd be doing the same, but for a client specific reason, it's a necessary evil in this case.
[2012-10-03 15:48:47 -0400] j|: maxmanders: good luck
[2012-10-03 15:48:50 -0400] yfeldblum: rgsteele, that's not a block ... block means something specific in ruby, and if you use "block" to mean something else it's going to confuse everyone
[2012-10-03 15:49:05 -0400] rgsteele: yfeldblum: Sorry, misuse of terminology
[2012-10-03 15:49:06 -0400] j|: --json-attributes is new to me. That's interesting.
[2012-10-03 15:49:50 -0400] rgsteele: yfeldblum: I meant to say "attributes"
[2012-10-03 15:50:37 -0400] rgsteele: yfeldblum: Does the question seem clear now, or should I rephrase?
[2012-10-03 15:51:30 -0400] yfeldblum: rgsteele, the template provider (Chef::Provider::Template) evaluates reads the template into a string, creates a context object and sets the context object's instance variables based on the variables attribute of the template resource, and uses ERB to evaluate the template string with the context object to get a new string
[2012-10-03 15:52:24 -0400] yfeldblum: rgsteele, then the provider compares the new string to the content of the file already on disk, and if they differ, rewrites the file with the new string from the last step
[2012-10-03 15:53:12 -0400] rgsteele: Ah, so it could be used just as readily as a file resource, then.  That's exactly what I needed to know.
[2012-10-03 15:53:14 -0400] yfeldblum: rgsteele, this happens during the provider method for the :create action; which only happens during convergence
[2012-10-03 15:54:12 -0400] rgsteele: yfeldblum: Many thanks.
[2012-10-03 15:54:37 -0400] j|: yfeldblum: sorry to chase the rabbit down the hole, but then I'm assuming the template's .variables attribute somehow gets magically tied into things in the default attributes file?
[2012-10-03 15:54:50 -0400] yfeldblum: j| no
[2012-10-03 15:55:05 -0400] yfeldblum: j| resource attributes have got nada, zero, zilch with node attributes
[2012-10-03 15:55:31 -0400] yfeldblum: j| the template resource has an attribute named "variables", and this has zero connection to node attributes
[2012-10-03 15:55:56 -0400] yfeldblum: j| http://wiki.opscode.com/display/chef/Resources#Resources-Template
[2012-10-03 15:56:15 -0400] j|: not sure what I'm missing here, but for my templates, I don't have to declare every variable in the template resource
[2012-10-03 15:56:44 -0400] j|: I've just been using the names that are already in the cookbook's attributes/default.rb file and they've been imported..
[2012-10-03 15:57:24 -0400] yfeldblum: j| the context object i talked about automatically sets the @node instance variable to the chef-client run's node, and automatically has a method named node which returns the @node instance variable
[2012-10-03 15:58:13 -0400] yfeldblum: j| the Chef::Provider::Template automatically sets up the context object in this way without you having to do anything
[2012-10-03 15:58:41 -0400] j|: yfeldblum: that's what I was trying to say. Thank you for the specifics
[2012-10-03 15:59:56 -0400] yfeldblum: j| but in general i think it's not good practice to use node or @node in a template ERB file; i think it's much better to figure out exactly the bits of data you need in the recipe, set the template resource's variables attribute to that small set of data, and just use that small bit of data in the template ERB file
[2012-10-03 16:00:37 -0400] j|: yfeldblum: okay. that's news. crap. wish I knew that 7 months ago. oops.
[2012-10-03 16:01:57 -0400] j|: I've been using node['whatever'] almost exclusively
[2012-10-03 16:02:24 -0400] yfeldblum: j| it seems like a pain in small systems always to have to do that extra work in the recipe and so you can get away with using @node in the template, but when it comes to larger systems, it helps things make a lot more sense to do that extra work in the recipe and make the template ERB files very simple and have a very clear interface
[2012-10-03 16:02:59 -0400] j|: yfeldblum: yea, that was apparently a big misunderstanding of mine in how to use templates.
[2012-10-03 16:03:11 -0400] j|: I actually thought that was how it was *supposed* to work. OOps.
[2012-10-03 16:03:29 -0400] yfeldblum: j| well it's certainly supported ...
[2012-10-03 16:03:47 -0400] yfeldblum: j| and it's OK when it comes to smaller systems
[2012-10-03 16:05:02 -0400] yfeldblum: j| and there's virtually no guidance out there for building big programs in chef
[2012-10-03 16:06:09 -0400] j|: yfeldblum: yea, I've had to figure it out mostly myself as no one here knew Chef (including me) when I was hired but we all thought it looked the best.
[2012-10-03 16:06:27 -0400] j|: myself and harassing people here and re-reading the opscode site over and over.
[2012-10-03 16:06:44 -0400] yfeldblum: j| exactly
[2012-10-03 16:07:25 -0400] j|: yfeldblum: so.. seeing as I'm going over The Things I Do Wrong
[2012-10-03 16:07:54 -0400] yfeldblum: j| this recommendation actually comes from working in rails and other programming frameworks that use templates, and applying that knowledge to templates in chef
[2012-10-03 16:08:44 -0400] j|: ah, yer a Rails dude. Yea, this is my first run in w/ Ruby. I lean towards Python, but I'll use whatever works as long as I can figure it out.
[2012-10-03 16:10:02 -0400] yfeldblum: j| heh i'm a programming dude and use multiple languages and frameworks
[2012-10-03 16:10:44 -0400] j|: so Other THings I'm Doing Wrong (Episode 2). I have a requirement to have the DB passwords encrypted and in separate vulnerability zones. Basically, if someone hacks our couchDB server and steals the root PW, we don't want them getting any other passwords. So, obviously here comes encrypted data bags to encrypt our stuff and save us.
[2012-10-03 16:12:02 -0400] j|: but EDBItem.load() doesn't take a filename for a key, just the secret itself, or uses a default config
[2012-10-03 16:12:35 -0400] yfeldblum: j| so pass IO.read("/path/to/key") to Chef::EncryptedDataBagItem.load ?
[2012-10-03 16:12:54 -0400] j|: yfeldblum: you rock, dude.
[2012-10-03 16:13:01 -0400] j|: unfortunately I should have asked you 2 days ago
[2012-10-03 16:13:08 -0400] yfeldblum: j| why is that?
[2012-10-03 16:13:23 -0400] j|: I'm mucking around with Chef::Config and re-setting things in recipes to try and get around it.
[2012-10-03 16:13:52 -0400] j|: passing IO.read() is obviously much smarter.
[2012-10-03 16:14:03 -0400] j|: why the hell didn't I think of that. Oy vey.
[2012-10-03 16:14:15 -0400] j|: thanks again, dude.
[2012-10-03 16:14:21 -0400] yfeldblum: j| no probs
[2012-10-03 16:18:29 -0400] wonko_be: anyone with some experience in test-kitchen? my features aren't executed when I run "kitchen test"
[2012-10-03 16:26:53 -0400] zts: j|: I almost hate to point it out, but there's also a Chef::EncryptedDataBagItem.load_secret()
[2012-10-03 16:27:00 -0400] zts: j|: see http://wiki.opscode.com/display/chef/Encrypted+Data+Bags#EncryptedDataBags-Accessingencrypteddatabagsfromarecipe
[2012-10-03 16:34:28 -0400] Rorgo: is there any way to set a role to run all recipes, even when one recipe fails?
[2012-10-03 16:36:09 -0400] JasonF: Rorgo: there is a per-resource command to ignore failures. Don't know if there is one for a whole recipe, but I'd doubt it.
[2012-10-03 16:37:51 -0400] yfeldblum: zts, j|, indeed
[2012-10-03 16:38:06 -0400] yfeldblum: Rorgo, no
[2012-10-03 16:38:22 -0400] yfeldblum: Rorgo, you'll probably want to fix that recipe
[2012-10-03 16:40:16 -0400] Rorgo: yeah obviously fixing the recipe is important, but there are times when one small thing will fail overnight, and cause the other 12 recipes in a role to fail even if they are unrelated
[2012-10-03 16:40:24 -0400] Rorgo: would be nice to still have everything else work
[2012-10-03 16:40:45 -0400] tdhite: [Wed, 03 Oct 2012 08:37:52 -0700] FATAL: Your Chef Solr installation needs to be upgraded.
[2012-10-03 16:40:45 -0400] tdhite: [Wed, 03 Oct 2012 08:37:52 -0700] FATAL: Expected schema version 1.2 but version 1.2 is installed.
[2012-10-03 16:40:45 -0400] tdhite: [Wed, 03 Oct 2012 08:37:52 -0700] FATAL: Use chef-solr-installer to upgrade your Solr install after backing up your data.
[2012-10-03 16:40:46 -0400] tdhite: That's Chef 10.14.x (pretty much any attempt)
[2012-10-03 16:40:46 -0400] tdhite: What's the solution -- it's all correct, no?
[2012-10-03 16:41:22 -0400] tdhite: How is it that the schema is correct, yet needs upgrade? I need a solution and frankly, after *many* searches/attempts, I'm stuck.
[2012-10-03 16:41:25 -0400] yfeldblum: Rorgo, it would also be nice to have the chef-client run carry on even while the kernel panics or the box powers off :D
[2012-10-03 16:56:54 -0400] qhartman: I support both Centos and Ubutnu with my chef infrastructure. The Centos boxes take 2-3 times to run through the same config tasks, mostly waiting on yum / RPM stuff. Any of you know good tricks for speeding that stuff up?
[2012-10-03 17:00:02 -0400] anentropic: anyone else experience this? http://tickets.opscode.com/browse/CHEF-3476
[2012-10-03 17:00:06 -0400] anentropic: really spoils my day
[2012-10-03 17:03:00 -0400] bsdguru: quick question which branch is 10.14.4?
[2012-10-03 17:04:58 -0400] bsdguru: I would ideally like to reapply my chef patches from master back into the 10-stable which seems to have 10.14.3 as the last release on that branch
[2012-10-03 17:05:44 -0400] tdhite: On 10.14.4 I get this error starting chef-solr:  Expected schema version 1.2 but version 1.2 is installed. That's an 'apt' install on Ubuntu 10.04 LTS. Anyone seen that, or know what's up?
[2012-10-03 17:07:42 -0400] Twirrim: qhartman: Not so much.. welcome to the joys of RPM :D
[2012-10-03 17:08:27 -0400] Twirrim: qhartman: I've noticed fairly similar.
[2012-10-03 17:17:53 -0400] anentropic: I have a problem where a recipe needs to use value node['user'] *in order to compile* but this seems to happen before the value has a chance to be set by default_attributes in a Role
[2012-10-03 17:18:14 -0400] anentropic: so I get Recipe Compile Error
[2012-10-03 17:18:20 -0400] anentropic: seems a catch 22
[2012-10-03 17:18:56 -0400] anentropic: how do I set a value on the node early enough, without manually setting the value via knife?
[2012-10-03 17:41:00 -0400] anentropic: tried setting node['user'] in an environment and putting the node in that environment but it's still not early enough - recipe compile error
[2012-10-03 17:42:27 -0400] JasonF: anentropic: This smells suspiciously like a red herring. Are you *sure* that's the reason it's failing?
[2012-10-03 17:43:25 -0400] yfeldblum: anentropic, recipes run after all default attributes from all roles are applied
[2012-10-03 17:44:45 -0400] anentropic: JasonF actually you're right, I'd gone blind the error has changed - moving the necessary default_attributes to an environment fixed it
[2012-10-03 17:45:16 -0400] anentropic: yfeldblum, the recipes run later but seem to be 'compiled' before and of the roles have a chance to set attributes
[2012-10-03 17:45:26 -0400] anentropic: 'before any'
[2012-10-03 17:48:07 -0400] basscleff: afternoon all, can someone tell me when doing an execute "foo" do
[2012-10-03 17:48:27 -0400] basscleff: the command line do i need to add the ./ to the command for instance ./bash.sh
[2012-10-03 17:48:31 -0400] basscleff: or just bash.sh?
[2012-10-03 18:02:09 -0400] z: basscleff: it either needs to be in PATH or you need to specify the full path
[2012-10-03 18:02:33 -0400] basscleff: right
[2012-10-03 18:02:39 -0400] basscleff: i am doing a cwd
[2012-10-03 18:02:44 -0400] basscleff: in the execute
[2012-10-03 18:03:10 -0400] basscleff: and then my command for the execute is ./script.sh should it only be script.sh?
[2012-10-03 18:03:29 -0400] z: basscleff: If you want to share more info via a Gist, that might help.
[2012-10-03 18:05:03 -0400] basscleff: https://gist.github.com/3828663
[2012-10-03 18:05:35 -0400] basscleff: chef says that configure_host runs successfully, but the script never gets ran
[2012-10-03 18:05:51 -0400] basscleff: if i login and run it manually, it works perfectly
[2012-10-03 18:14:02 -0400] twohey: i've read about an erlang based successor to the current open source chef server. where can i learn more about that and what is the timeline for its unveiling? The last I heard was "end of summer"
[2012-10-03 18:14:41 -0400] Mithrandir: erchef, and it's at least somewhat released.
[2012-10-03 18:14:50 -0400] Mithrandir: it'll be the chef server for chef 11, afaik
[2012-10-03 18:15:20 -0400] dwhsix: is there a bridge around here I can jump off of?
[2012-10-03 18:15:22 -0400] dwhsix: "FATAL: LoadError: mysql_database[create zmx_production] (database::master line 63) had an error: LoadError: cannot load such file -- mysql"
[2012-10-03 18:15:36 -0400] dwhsix: :-)
[2012-10-03 18:15:46 -0400] dwhsix: back to mysql hell, trying to create a new server
[2012-10-03 18:16:20 -0400] yfeldblum: anentropic, recipes run ("compilation phase") after all default attributes from all roles are applied
[2012-10-03 18:16:26 -0400] z: twohey: http://wiki.opscode.com/display/chef/Chef+11+Release+Checklist // http://www.opscode.com/blog/2012/08/31/test-drive-the-chef-11-server-preview/ || https://github.com/opscode/erchef/
[2012-10-03 18:16:39 -0400] yfeldblum: anentropic, the "compilation phase" is when recipes run; and there is no other phase when recipes run
[2012-10-03 18:16:54 -0400] twohey: thanks Mithrandir and z
[2012-10-03 18:16:55 -0400] gyre007: can I require a gem in LWRPs
[2012-10-03 18:16:56 -0400] gyre007: ?
[2012-10-03 18:17:03 -0400] anentropic: yfeldblum, that's not what I'm seeing
[2012-10-03 18:17:25 -0400] yfeldblum: twohey, take a look at https://github.com/opscode and browse through the repositories
[2012-10-03 18:18:43 -0400] yfeldblum: anentropic, it's nevertheless true; but let's go back to the symptoms because this isn't the right diagnosis
[2012-10-03 18:19:11 -0400] gyre007: jtimberman, I'm using tons of code from https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_postgresql.rb
[2012-10-03 18:19:29 -0400] gyre007: do I need to include some license statement in my code ?
[2012-10-03 18:19:41 -0400] dwhsix: is there a good doc/tutorial on how to do mysql db now?  I think I've got so much cruft I should rip out cookbooks and start over
[2012-10-03 18:19:58 -0400] dwhsix: all I want is a mysql db w/ a simple little rails app db in it pretty please? ;-)
[2012-10-03 18:19:58 -0400] mattray: gyre007: it's Apache licensed, so keep any copyright headers
[2012-10-03 18:20:16 -0400] gyre007: cool cheers mattray
[2012-10-03 18:21:18 -0400] yfeldblum: dwhsix, mattray isn't a lawyer, so: http://www.apache.org/licenses/LICENSE-2.0
[2012-10-03 18:21:24 -0400] gyre007: ok...should I then require those gems in the recipe rather than in LWRP ?
[2012-10-03 18:21:25 -0400] yfeldblum: gyre007, , mattray isn't a lawyer, so: http://www.apache.org/licenses/LICENSE-2.0
[2012-10-03 18:21:45 -0400] anentropic: yfeldblum: https://gist.github.com/3828763
[2012-10-03 18:22:02 -0400] mattray: yfeldblum: true
[2012-10-03 18:22:50 -0400] yfeldblum: anentropic, unfortunately that's not enough to go on ...
[2012-10-03 18:23:41 -0400] anentropic: yfeldblum, just put a bit more in the gist
[2012-10-03 18:23:51 -0400] gyre007: haha yfeldblum thats what I was afraid of....boring law articles :) but i guess i dont have a choice
[2012-10-03 18:24:38 -0400] anentropic: I'm getting this when I knife bootstrap a newly-created node
[2012-10-03 18:26:03 -0400] yfeldblum: anentropic, right before that line, temporarily, you might want to log the merged node data: Chef::Log.info("\n#{JSON.pretty_generate(node.to_hash)}")
[2012-10-03 18:27:11 -0400] yfeldblum: gyre007, well ... that's the only real answer to your question besides "ask a lawyer" ... it's kind of equivalent to saying "if you want to know what this function does, read the source code" :P
[2012-10-03 18:27:36 -0400] anentropic: in roles/base.rb I had default_attributes("user" => "ubuntu")
[2012-10-03 18:27:36 -0400] gyre007: yeah I got it :)
[2012-10-03 18:28:19 -0400] anentropic: moving that to an environment instead fixed the problem
[2012-10-03 18:28:53 -0400] dwhsix: so seriously folks the database cookbook can't load mysql how might I fix this?
[2012-10-03 18:30:09 -0400] dwhsix: ah, hang on, sound some comments on the mysql cookbook doc page which might help
[2012-10-03 18:34:38 -0400] c_t: attn: jtimberman
[2012-10-03 18:34:42 -0400] anentropic: yfeldblum, I'll come back to this tomorrow and try and backtrack and corroborate against the web ui what attr values are saved on the node
[2012-10-03 18:34:48 -0400] c_t: There is a radio station called KYAK
[2012-10-03 18:34:49 -0400] anentropic: at various stages
[2012-10-03 18:35:00 -0400] anentropic: thanks for the tips
[2012-10-03 18:35:53 -0400] anentropic: chef is the most painful dev experience I've had in a long time but the support here is great
[2012-10-03 18:40:40 -0400] xmltok_: im trying to test out a cookbook with chef-solo that depends on a databag, when i run the cookbook it always tries to search against localhost:4000, how do i change the server url?
[2012-10-03 18:41:31 -0400] xmltok_: i found it here http://wiki.opscode.com/display/chef/Chef+Configuration+Settings
[2012-10-03 18:44:39 -0400] j-v-e: howdy gentlemen
[2012-10-03 18:45:05 -0400] j-v-e: quick role merging question: I have two roles that want to add an entry into the same array, like that: https://gist.github.com/3828940
[2012-10-03 18:45:20 -0400] j-v-e: is chef going to merge both arrays into one array ?
[2012-10-03 18:56:47 -0400] JasonF: What's the best way to seed a known_hosts entry for the git "reponame" {} resource?
[2012-10-03 18:57:19 -0400] JasonF: Basically, the chef run fails on asking yes/no for a known_hosts entry to github.com. Wondering if there's some way to preseed that, and I'd rather not change the serverwide option to turn off the checking
[2012-10-03 18:58:27 -0400] luckymike: you can load the known hosts from a data bag or file
[2012-10-03 19:00:14 -0400] z: JasonF: echo -e "Host github.com\n\tStrictHostKeyChecking no\n" >> /etc/ssh/ssh_config
[2012-10-03 19:00:30 -0400] z: JasonF: will just disable it for github.com ..
[2012-10-03 19:01:37 -0400] JasonF: z++ great idea
[2012-10-03 19:04:09 -0400] j-v-e: answering myself: it doesn't work
[2012-10-03 19:05:05 -0400] ranjibd: j-v-e, it should
[2012-10-03 19:05:30 -0400] j-v-e: the arrays aren't merged, only the latest one is picked
[2012-10-03 19:05:38 -0400] ranjibd: j-v-e, arrays and hashed of same precedence level (i.e. default/override) should be deep merged
[2012-10-03 19:06:57 -0400] j-v-e: good catch ranjibd ! that's the issue
[2012-10-03 19:08:40 -0400] ranjibd_: j-v-e, http://wiki.opscode.com/display/chef/Deep+Merge
[2012-10-03 19:11:56 -0400] j-v-e: yep, it's working now, thanks ranjibd_
[2012-10-03 19:13:22 -0400] ZsoL: any reason "knife cookbook show my_cookbook -E myenv" fails to return anything when dropping "-E myenv" works just fine?
[2012-10-03 19:13:47 -0400] ZsoL: and by fails i mean i get a proxy error from the chef server
[2012-10-03 19:18:54 -0400] ZsoL: ignore me
[2012-10-03 19:18:55 -0400] ZsoL: :]
[2012-10-03 19:19:10 -0400] cgriego: I can't boot a server because this request is failing. http://www.opscode.com/chef/download?v=10.12.0&p=ubuntu&pv=12.04&m=x86_64
[2012-10-03 19:19:31 -0400] dpetzel: cgriego, I'm seeing the same thing
[2012-10-03 19:19:52 -0400] dpetzel: been testing some new bootstrap templates all day, and within the last 30 minutes or so, that download started to fail
[2012-10-03 19:20:20 -0400] ranjibd_: cgriego, what template you are using
[2012-10-03 19:20:47 -0400] cgriego: chef-full
[2012-10-03 19:20:52 -0400] dpetzel: curl -I "http://www.opscode.com/chef/download?v=10.12.0&p=el&pv=5&m=x86_64" yeilds a 404 for me right now, same bootstrap template (internal one) was working earlier
[2012-10-03 19:21:12 -0400] ranjibd_: copy the chef_full template , rename it and change the install.sh with direct link of deb s3
[2012-10-03 19:21:36 -0400] cgriego: the UI at http://www.opscode.com/chef/install/ won't return any Ubuntu installers
[2012-10-03 19:22:10 -0400] ranjibd_: cgriego, dpetzel you can check  http://s3.amazonaws.com/opscode-full-stack/ for available debs.. i dont work a lot on ubuntu , but im sure theres something
[2012-10-03 19:22:23 -0400] dpetzel: Im actually doing it on RHEL5
[2012-10-03 19:24:42 -0400] ranjibd_: dpetzel, cgriego change line# 16-25 of chef-full.eb to something like rpm -Uvh http://s3....  (or the dpkg equivalent)
[2012-10-03 19:25:10 -0400] dpetzel: ranjibd_, Are you suggesting that as a workaround, or as a solution as something that used to work has now changed and won't work going forward?
[2012-10-03 19:26:25 -0400] CharlieSu: Is this knife option still honored?  knife[:bootstrap_version]
[2012-10-03 19:26:38 -0400] dpetzel: in my case, Im not using chef-full.erb but a custom template, and the failed link is being produced by from the install script (http://opscode.com/chef/install.sh). In my case I'm not blocked so I can wait for things to be fixed (if they are going to be), but if this is a permanent situation, will of course need to make changes
[2012-10-03 19:26:41 -0400] ranjibd_: dpetzel, its something that is introduced
[2012-10-03 19:26:53 -0400] ranjibd_: dpetzel, and will be more stable going forward
[2012-10-03 19:27:19 -0400] dpetzel: but the install.sh doesnt use it yet?
[2012-10-03 19:27:26 -0400] ranjibd_: earlier default bootstrap template was by ruby gem.. now its omnibus (let me verify that :-))
[2012-10-03 19:28:56 -0400] kallistec: cgriego: sorry that's a bug resulting from some changes to the install page that are in progress
[2012-10-03 19:29:15 -0400] xerxas: hi all
[2012-10-03 19:29:24 -0400] cgriego: kallistec: is there an ETA?
[2012-10-03 19:29:33 -0400] xerxas: reading the last logs here it seems I'm not the only one to have problems with bootstrap
[2012-10-03 19:29:45 -0400] xerxas: is there an ongoing issue ? can I workaround it ?
[2012-10-03 19:29:47 -0400] kallistec: cgriego: not sure, my team is looking at it now
[2012-10-03 19:30:24 -0400] korishev: If this is an actual issue, could we get status.opscode.com updated?
[2012-10-03 19:32:21 -0400] rb1980: Hi, chef newbie here with a questions about how to use variables....
[2012-10-03 19:32:52 -0400] rb1980: I want to define a variable in a recipe and use it in for cookbook_file as well as in a template
[2012-10-03 19:33:29 -0400] rb1980: can I define a variable outside the scope of the template and use it both places?
[2012-10-03 19:34:20 -0400] ranjibd_: CharlieSu, with chef-full the default template.. it is honored
[2012-10-03 19:34:26 -0400] xerxas: rb1980: yes, you pass variables to templates
[2012-10-03 19:35:24 -0400] CharlieSu: ranjibd_: thanks..  I'm running into an issue with the RVM cookbook and I'm not sure if it is because of a Chef upgrade or not..    https://gist.github.com/2f172fae5368840199a7
[2012-10-03 19:35:43 -0400] rb1980: okay, i need some help figuring out how to do that... in looking at the basic example for ntp here: http://wiki.opscode.com/display/chef/Guide+to+Creating+A+Cookbook+and+Writing+A+Recipe
[2012-10-03 19:35:44 -0400] xerxas: rb1980: http://wiki.opscode.com/display/chef/Templates , the first example passes a hash to variables()
[2012-10-03 19:35:52 -0400] rb1980: lets say I want the value for nt
[2012-10-03 19:36:06 -0400] rb1980: ntp_server defined somewhere else in the recipe
[2012-10-03 19:37:14 -0400] rb1980: do i still need to pass it in the template, or will the template read variables defined elsewhere in the recipe?
[2012-10-03 19:37:48 -0400] xerxas: rb1980: no , you need to explicitly pass the variables to the template
[2012-10-03 19:38:59 -0400] rb1980: okay, but can they be defined elsewhere in the recipe?
[2012-10-03 19:39:04 -0400] rb1980: something like this:
[2012-10-03 19:39:11 -0400] rb1980: ntp_server = "time.nist.gov"
[2012-10-03 19:39:12 -0400] rb1980: template "/etc/ntp.conf" do
[2012-10-03 19:39:12 -0400] rb1980:     source "ntp.conf.erb"
[2012-10-03 19:39:12 -0400] rb1980:     variables( :ntp_server => "#{ntp_server}" )
[2012-10-03 19:39:12 -0400] rb1980:     notifies :restart, "service[ntpd]"
[2012-10-03 19:39:12 -0400] rb1980: end
[2012-10-03 19:40:12 -0400] xerxas: rb1980: I think it should do it , yeah
[2012-10-03 19:40:26 -0400] rb1980: excellent, thanks
[2012-10-03 19:40:31 -0400] xerxas: rb1980: :ntp_server => ntp_server will also work
[2012-10-03 19:40:39 -0400] xerxas: as ntp_server is already a string
[2012-10-03 19:40:42 -0400] spox: +1
[2012-10-03 19:40:46 -0400] rb1980: cool
[2012-10-03 19:40:54 -0400] jessicab: cgriego korishev dpetzel: install.sh is back up btw
[2012-10-03 19:41:08 -0400] dpetzel: jessicab, confirmed. Thank you
[2012-10-03 19:41:20 -0400] korishev: jessicab: thank you!
[2012-10-03 19:43:03 -0400] xerxas: confirmed ! ;)
[2012-10-03 19:43:17 -0400] kallistec: cgriego korishev: install page should be back in action
[2012-10-03 19:43:19 -0400] rb1980: thanks, xerxas
[2012-10-03 19:43:26 -0400] cgriego: jessicab: thanks
[2012-10-03 19:54:02 -0400] CharlieSu: Is anyone running the RVM cookbook?  I'm seeing this. https://gist.github.com/2f172fae5368840199a7
[2012-10-03 19:54:23 -0400] DanN1: Greetings all. I installed several clients with the omnibus installer a few weeks ago, but today I can't get the omnibus installer to work. I tried Centos 5.4 and 6.3. It doesn't seem to find the version of Chef. Did something change?
[2012-10-03 19:57:22 -0400] dwhsix: ok, I've updated all my cookbooks but I still can't get mysql to install right (specifically, the ruby::mysql recipe)
[2012-10-03 19:57:35 -0400] dwhsix: fails to build, with "make: not found"
[2012-10-03 19:57:44 -0400] CharlieSu: DanN1: try setting a version in your knife.rb to see if that helps..      Example:  knife[:bootstrap_version] = "10.12.0-1"
[2012-10-03 19:58:09 -0400] dwhsix: I have recipe[build-essential] before recipe[mysql::ruby] any thuoghts?
[2012-10-03 19:58:20 -0400] DanN1: Ah, good idea. I'll give that a try.
[2012-10-03 20:01:23 -0400] DanN1: CharlieSu: That was it. my knife.rb still had 0.10.8 in it.
[2012-10-03 20:01:59 -0400] DanN1: Thanks for the help
[2012-10-03 20:03:46 -0400] Urocyon: hrmmm, I think berkshelf 0.6.0.beta1 doesn't like my self-signed cert.
[2012-10-03 20:04:33 -0400] CharlieSu: DanN1: No problem..  Glad that guess worked for ya!  You can remove that line and it will install the latest version.  I like to pin mine to a version though...
[2012-10-03 20:08:21 -0400] ekristen: for some reason all of a sudden I am getting "Unable to retrieve a valid package!" when I try and bootstrap a server
[2012-10-03 20:08:26 -0400] ekristen: it was working fine this morning
[2012-10-03 20:08:30 -0400] ekristen: now it isn't working
[2012-10-03 20:09:30 -0400] ekristen: CharlieSu: I don't have a bootstrap version set in my knife.rb
[2012-10-03 20:09:57 -0400] ekristen: Downloading Chef 10.14.2 for ubuntu, Unable to retrieve a valid package!
[2012-10-03 20:11:02 -0400] dwhsix: okay, is ruby::mysql supposed to work?
[2012-10-03 20:11:27 -0400] dwhsix: keeps failing while trying to chef_gem[mysql]
[2012-10-03 20:12:23 -0400] Pushnell: any chance someone in here is nathanharvey or a committer to the hostsfile cookbook?
[2012-10-03 20:12:42 -0400] Pushnell: sorry, nathenharvey*
[2012-10-03 20:13:18 -0400] ekristen: omnibus on ubuntu keeps return 404 on the installer
[2012-10-03 20:13:23 -0400] ekristen: but if I test the URL it works just fine
[2012-10-03 20:13:34 -0400] ekristen: there were no problems 4 hours ago and now nothing works
[2012-10-03 20:14:36 -0400] CharlieSu: ekristen: try an older version...
[2012-10-03 20:14:51 -0400] ekristen: CharlieSu: so here is the odd thing
[2012-10-03 20:14:56 -0400] ekristen: bootstrap fails
[2012-10-03 20:15:06 -0400] ekristen: the stderr log reveals it is receiving a 404
[2012-10-03 20:15:12 -0400] CharlieSu: ekristen: SSH onto the box and manually try to download the artifacts..
[2012-10-03 20:15:15 -0400] ekristen: but if I manually try the URL it is successful
[2012-10-03 20:15:22 -0400] abetterlie: question on the opcode mysql cookbook.
[2012-10-03 20:15:23 -0400] ekristen: CharlieSu: I did and it works
[2012-10-03 20:15:38 -0400] CharlieSu: ekristen: manually run the install.sh script on the server and see what happens
[2012-10-03 20:15:50 -0400] ekristen: CharlieSu: I've been building ubuntu boxes all morning testing things out, and this afternoon bootstrap started failing
[2012-10-03 20:15:54 -0400] abetterlie: In ther server recipe, there is a begin rescue end block that appears to go to rescue every time it's run, is there a reason it's built this way? and if so, why?
[2012-10-03 20:16:34 -0400] ekristen: CharlieSu: running it manually on the server works just fine
[2012-10-03 20:16:49 -0400] CharlieSu: ekristen: the curl or the install.sh ?
[2012-10-03 20:16:56 -0400] ekristen: the install.sh
[2012-10-03 20:17:05 -0400] ekristen: wget http://www.opscode.com/chef/install.sh, then bash install.sh works
[2012-10-03 20:17:06 -0400] CharlieSu: ekristen: are you passing any params to it?
[2012-10-03 20:17:33 -0400] CharlieSu: ekristen: gist your bootstrap command and your knife.rb
[2012-10-03 20:17:54 -0400] ekristen: knife ec2 server create -I ami-cbd0f58e -f t1.micro -x ubuntu -N redis01 --region 'us-west-1' -Z 'us-west-1a' -S erik -G defaultall -E "app_testing" -r "role[app-redis-master]"
[2012-10-03 20:18:11 -0400] ekristen: same command I've been running all day without issue
[2012-10-03 20:18:32 -0400] CharlieSu: ekristen: gist your knife.rb file
[2012-10-03 20:19:30 -0400] ekristen: CharlieSu: I'd have to take over half of my knife.rb out due to having sensitive info
[2012-10-03 20:19:55 -0400] CharlieSu: ekristen: that is fine...  take it out..
[2012-10-03 20:22:00 -0400] ekristen: CharlieSu: https://gist.github.com/3829608
[2012-10-03 20:23:11 -0400] CharlieSu: ekristen: what version of knife-ec2 and chef are you running locally ?
[2012-10-03 20:23:36 -0400] CharlieSu: ekristen: put knife[:bootstrap_version] = "10.12.0-1"  into your knife.rb file and try again..  just for fun..
[2012-10-03 20:23:58 -0400] ekristen: CharlieSu: ok -- so here is the interesting thing --- my other knife command works just fine
[2012-10-03 20:24:08 -0400] ekristen: the only thing different are the role
[2012-10-03 20:24:09 -0400] ekristen: s
[2012-10-03 20:24:20 -0400] ekristen: and the only thing different about the roles is one install mongo and the other installs redis
[2012-10-03 20:24:25 -0400] mhalligan: Why would "if node.role.include?"nginx" error out with FATAL: ArgumentError: Attribute role is not defined! ?
[2012-10-03 20:24:36 -0400] ekristen: not sure why that would affect it not being able to download chef though :/
[2012-10-03 20:24:46 -0400] ekristen: oh wtf -- now it works
[2012-10-03 20:24:54 -0400] mhalligan: because I'm a dumbass
[2012-10-03 20:24:56 -0400] mhalligan: nevermind
[2012-10-03 20:27:09 -0400] CharlieSu: ekristen: did you have the roles properly quoted in your bootstrap command?
[2012-10-03 20:27:26 -0400] CharlieSu: ekristen: make a wrapper script for calling your boostrap commands...
[2012-10-03 20:27:27 -0400] ekristen: I did, but now it is working all of a sudden, so I have no idea what is wrong
[2012-10-03 20:31:31 -0400] xmltok: is it possible to set variables in cookbooks that are used in other cookbooks? I have a databag that contains information that i want, but i need to search over bags to locate the correct bag. I'd like to cache that result in node[:colo] so that all my cookbooks can just reference that information directly
[2012-10-03 20:31:42 -0400] xmltok: it appears that if i set it in one cookbook, it doesnt make it to the next
[2012-10-03 20:33:10 -0400] ekristen: anyone in here use the mongodb cookbook?
[2012-10-03 20:37:40 -0400] cwj: ekristen: we use a fork of it, whats up
[2012-10-03 20:37:47 -0400] ekristen: cwj: which fork?
[2012-10-03 20:37:54 -0400] ekristen: cwj: and do you do replica sets?
[2012-10-03 20:38:21 -0400] ekristen: cwj: I'm having issues with replica sets
[2012-10-03 20:38:32 -0400] cwj: our fork is at https://github.com/needle-cookbooks/chef-mongodb
[2012-10-03 20:38:36 -0400] cwj: and yes we use replica sets
[2012-10-03 20:39:02 -0400] cwj: although i wouldn't say that they work without manual intervention
[2012-10-03 20:39:20 -0400] ekristen: cwj: what sort of manual intervention?
[2012-10-03 20:39:42 -0400] cwj: manually running rs.add('foo.bar.baz:27017')
[2012-10-03 20:39:50 -0400] cwj: when adding foo.bar.baz to the set
[2012-10-03 20:39:59 -0400] ekristen: :/
[2012-10-03 20:40:20 -0400] ekristen: cwj: shouldn't it do it for you?
[2012-10-03 20:40:29 -0400] cwj: i dont think the ruby block for configuring the replica set fires reliably
[2012-10-03 20:40:39 -0400] cwj: but i havent spent much time on it
[2012-10-03 20:40:56 -0400] cwj: i think there have been recent commits in the main repo toward that end
[2012-10-03 20:41:17 -0400] cwj: https://github.com/edelight/chef-mongodb/commit/8e330a79962e7633b916bcce201b44856a762297
[2012-10-03 20:42:34 -0400] ekristen: cwj that is the one I am using on edelight
[2012-10-03 20:42:40 -0400] ekristen: but I am seeing all sorts of issues with it
[2012-10-03 20:42:49 -0400] ekristen: duplicate nodes during initial configuration
[2012-10-03 20:43:05 -0400] ekristen: new members try to become the primary and fail because there already is a primary
[2012-10-03 20:43:36 -0400] ekristen: cwj: that commit specifically is causing problems it keeps duplicating the new node
[2012-10-03 20:43:41 -0400] cwj: ah
[2012-10-03 20:43:55 -0400] cwj: well check out our fork, the needle branch specifically
[2012-10-03 20:44:08 -0400] cwj: i cant remember everything i did while i was trying to sort out the replica set stuff
[2012-10-03 20:44:55 -0400] cwj: i have a to-do item regarding reconciling our fork with the current upstream
[2012-10-03 20:44:55 -0400] ekristen: cwj: what is the best way to test the recipes
[2012-10-03 20:45:06 -0400] ekristen: just assign them and run it
[2012-10-03 20:45:11 -0400] ekristen: then undo everything and try again?
[2012-10-03 20:45:34 -0400] cwj: i would think that you could set up a vagrantfile with multiple VMs that should create a cluster
[2012-10-03 20:45:45 -0400] cwj: then you can destroy and rebuild them as needed
[2012-10-03 20:45:56 -0400] cwj: would be a good addition to the cookbook repo even
[2012-10-03 20:47:26 -0400] ekristen: cwj: I'm not familiar with vagrant
[2012-10-03 20:48:34 -0400] bluepojo: ekristen: vagrant is wooonderful
[2012-10-03 20:48:42 -0400] bluepojo: you can build productionlike environments on your dev machine
[2012-10-03 20:48:49 -0400] rayrod2030: anybody run into that pesky rabbitmq startup issue in ec2 when building a new chef server?
[2012-10-03 20:49:04 -0400] bluepojo: here's a guide on how to write cookbooks while testing in vagrant: http://vialstudios.com/guide-authoring-cookbooks.html
[2012-10-03 20:49:19 -0400] bluepojo: vagrantup.com has details on how to set up multiple vms in a single vagrantfile
[2012-10-03 20:50:09 -0400] cwj: vagrant is worth learning imo
[2012-10-03 20:50:27 -0400] bluepojo: berkshelf also has a vagrant plugin
[2012-10-03 20:50:46 -0400] bluepojo: which will fetch all your cookbook's dependencies when you provision
[2012-10-03 20:52:10 -0400] ekristen: so vagrant only works with virtual box huh
[2012-10-03 20:53:27 -0400] mattray: rayrod2030: you have a gist?
[2012-10-03 20:55:11 -0400] rayrod2030: @mattray: I just rebuilt a server.  I'll have one pretty soon for you.  It's a pretty well known issue with rabbitmq-server packages on debian.  See here: https://bugs.launchpad.net/ubuntu/+source/rabbitmq-server/+bug/653405
[2012-10-03 20:55:35 -0400] rayrod2030: I'm just asking because anyone who is building chef server from the debian packages has to run into this on ec2.
[2012-10-03 20:55:36 -0400] CharlieSu: Can vagrant emulate EC2 in anyway ?
[2012-10-03 20:55:56 -0400] mattray: rayrod2030: ahh, not sure about building the chef server using the distro packages of rabbit, they're super old
[2012-10-03 20:56:10 -0400] bluepojo: CharlieSu: depends what you want to emulate about it you can have the same OS and the same packages installed
[2012-10-03 20:56:11 -0400] cwj: ekristen: a lot of work has been done lately abstract the parts of vagrant which are coupled directly to virtualbox, but as of now virtualbox is the only supported VM hypervisor
[2012-10-03 20:56:19 -0400] bluepojo: but not security groups and such
[2012-10-03 20:56:32 -0400] mattray: rayrod2030: I just asked because I've been working with the rabbit cookbook, which typically is working with rabbitmq 2.8.4
[2012-10-03 20:56:36 -0400] CharlieSu: bluepojo: I've got recipes that do things like use ELBs, etc..
[2012-10-03 20:56:53 -0400] bluepojo: vagrant's only going to give you boxes to work with
[2012-10-03 20:56:55 -0400] rayrod2030: mattray: yeah ootb apt is installing 1.7.2 on lucid.
[2012-10-03 20:56:56 -0400] ekristen: cwj: ok thanks
[2012-10-03 20:57:18 -0400] rayrod2030: mattray: I've had much better luck installing on precise for a client in prod recently.  IT's a breeze to set up.
[2012-10-03 20:57:22 -0400] bluepojo: by "production like environment" I mean within the box
[2012-10-03 20:57:24 -0400] bluepojo: not the entire cluster
[2012-10-03 20:57:25 -0400] mattray: rayrod2030: I don't know if that's the issue or not
[2012-10-03 20:57:31 -0400] mattray: rayrod2030: precise is 2.7.1
[2012-10-03 20:57:42 -0400] mattray: pretty different versions
[2012-10-03 20:57:46 -0400] bluepojo: like "Works on OS X" doesn't mean a whooole lot when you're deploying to Debian
[2012-10-03 20:57:46 -0400] rayrod2030: indeed
[2012-10-03 20:58:00 -0400] bluepojo: so vagrant lets you say "works on debian" before deploying to debian
[2012-10-03 20:58:06 -0400] bluepojo: before checking in
[2012-10-03 20:58:19 -0400] CharlieSu: mattray: do you know of a RabbitMQ cookbook that sets up HA reliably ?
[2012-10-03 20:58:59 -0400] mattray: CharlieSu: not yet, but patches are welcome
[2012-10-03 20:59:31 -0400] mattray: CharlieSu: I think I'll be adding that eventually if no one else does
[2012-10-03 20:59:37 -0400] mattray: for HA openstack
[2012-10-03 20:59:50 -0400] mattray: (like within the next couple months)
[2012-10-03 21:01:27 -0400] CharlieSu: mattray: cool.  I've made a few modifications around the erlang_cookie for HA but then the cookbook was updated and fixed some of that
[2012-10-03 21:02:11 -0400] mattray: CharlieSu: there's a new release close to dropping here: https://github.com/opscode-cookbooks/rabbitmq/tree/COOK-1684
[2012-10-03 21:03:16 -0400] psykidellic: Whats the suggested way to set up cron jobs? Right now I am just updating a template.
[2012-10-03 21:06:14 -0400] ekristen: cwj: ERROR: Failed to configure replicaset, reason: {"errmsg"=>"couldn't initiate : member ip-10-170-138-210.us-west-1.compute.internal:27017 is already initiated", "ok"=>0.0}
[2012-10-03 21:06:22 -0400] ekristen: cwj: that is the error I am getting these days
[2012-10-03 21:06:28 -0400] JasonF: psykidellic: there's a cron resource
[2012-10-03 21:06:42 -0400] ekristen: cwj: its trying to reinitialize the primary node which has already been initialized
[2012-10-03 21:07:04 -0400] JasonF: psykidellic: http://wiki.opscode.com/display/chef/Resources#Resources-Cron <-- and bookmark that page, sans anchor, for the future :) Super helpful opscode docs++
[2012-10-03 21:08:19 -0400] sivajag: Hi
[2012-10-03 21:08:36 -0400] sivajag: I am having a problem with "application" cookbook
[2012-10-03 21:08:45 -0400] sivajag: none of my callbacks are getting called
[2012-10-03 21:10:22 -0400] sivajag: anyone here?
[2012-10-03 21:20:14 -0400] cobragoat: #newrelic
[2012-10-03 21:33:03 -0400] Chris1: Regarding data bag secrets  I'm still not sure of the logic as it follows. It seems the before Chef runs the recipes it is trying to pull the value of variables first. For example, when I have the key copied in a recipe before the recipe where my values are used, then it dies (No such file or directory - file not found '/etc/chef/encrypted_data_bag_secret'), if I 'touch /etc/chef/encrypted" then I of course get the "ArgumentError: invalid zero
[2012-10-03 21:35:44 -0400] abetterlie: anyone have experience automating creation of chef server workstation? I have a cookbook that seems to create everything correctly but when I run any knife commands I get a "ERROR: You authenticated successfully to http://localhost:4000 as chef-validator but you are not authorized for this action
[2012-10-03 21:42:26 -0400] mouse: Hello... I am trying to see if there is an opensource c# client that connects to the chef APIs, anyone know of one?
[2012-10-03 21:43:15 -0400] bluepojo: mouse: I don't know of any libraries, but Chef has a REST api that you could call with a C# rest client
[2012-10-03 21:44:40 -0400] mouse: yeah I was just seeing if anyone had published one that I could use.  Something like the jclouds-chef java API
[2012-10-03 21:46:39 -0400] mattray: mouse: I haven't seen C#, but there is java, python and 2 ruby implementations
[2012-10-03 21:48:36 -0400] bluepojo: probably a number of ruby implementations XD
[2012-10-03 21:48:40 -0400] bluepojo: https://github.com/reset/ridley is a cool one
[2012-10-03 21:53:49 -0400] sivajag: Anyone having issues with CallBacks in Application cookbooks
[2012-10-03 21:54:02 -0400] sivajag: none of my callbacks are getting called
[2012-10-03 22:01:08 -0400] psykidellic: JasonF: Thanks. I will look.
[2012-10-03 22:17:50 -0400] _0x783czar: Does anyone know where ohai reads the FQDN from?  because my /etc/hosts file & /etc/hostname all have the right fqdn, but OHAI only seems to find the hostname for the FQDN
[2012-10-03 22:18:21 -0400] Urocyon: abetterlie: chef-validator has some minimal privileges.  Did you mean to use chef-webui instead?  It's the one with administrative privileges.
[2012-10-03 22:18:22 -0400] JasonF: _0x783czar: run
[2012-10-03 22:18:25 -0400] paulmooring: _0x783czar: hostname -f
[2012-10-03 22:18:29 -0400] JasonF: _0x783czar: run "hostname" and "hostname -f"
[2012-10-03 22:18:46 -0400] JasonF: _0x783czar: if they don't respond correctly, you need to fix your hostname. (hostname should = hostname. hostname -f should = hostname.domain)
[2012-10-03 22:19:16 -0400] Urocyon: abetterlie: assuming you are attempting to automate the creation of a new client.
[2012-10-03 22:19:29 -0400] Urocyon: abetterlie: chef-validator can't do that.
[2012-10-03 22:19:32 -0400] _0x783czar: JasonF: interesting... they're backwards
[2012-10-03 22:20:09 -0400] JasonF: _0x783czar: Short version of how to set hostname: /etc/hostname should have your hostname in it. In /etc/hosts, beside your ipaddress, you should have (ordering matters!
[2012-10-03 22:20:19 -0400] JasonF: _0x783czar: 1.2.3.4 hostname.domain hostname
[2012-10-03 22:20:37 -0400] JasonF: Depending on your OS, replace "/etc/hostname" with wherever the hostname config var is on your specific distro
[2012-10-03 22:20:41 -0400] _0x783czar: JasonF: ah, they're my problem, my container got setup with them backwards
[2012-10-03 22:21:48 -0400] JasonF: Yaay. Yet another server down in my quest to make hostname never return an fqdn.
[2012-10-03 22:21:50 -0400] Urocyon: If jeremiahsnapp is around, thanks for that update to users to allow the use of a username.  I was just asked today to add some users with a '.' in their name.
[2012-10-03 22:25:03 -0400] _0x783czar: JasonF: your effect will be widespread, one of our in house apps was setting up wrong, so many servers that would have been set up wrong will now have it right.
[2012-10-03 22:25:53 -0400] JasonF: :)
[2012-10-03 22:25:54 -0400] Urocyon: Oh, and berkshelf made it really easy for me to pull the prerelease version of users on github, since that username change hadn't made it into a release yet.
[2012-10-03 22:26:06 -0400] Urocyon: thanks berkshelf.
[2012-10-03 22:26:55 -0400] abetterlie: Urocyon: I figured it out, vagrant was registering using their chef_client provisioner and I was running it in the cookbook as well
[2012-10-03 22:27:01 -0400] abetterlie: Urocyon:  thanks man
[2012-10-03 22:29:27 -0400] BryanWB: yeah, tks berkshelf!
[2012-10-03 22:38:42 -0400] toulmean: hi all, I am trying to master an install of chef-server and consistently getting an error setting up a new node
[2012-10-03 22:38:54 -0400] toulmean: I am getting the error message "[2012-10-03T17:31:21-05:00] INFO: HTTP Request Returned 404 Not Found: Cannot load environment <env>"
[2012-10-03 22:39:28 -0400] toulmean: what does that mean ?
[2012-10-03 22:39:31 -0400] jkyle: in the shef shell, is there a way to print out the json for node attributes instead of the class string?
[2012-10-03 22:40:06 -0400] jkyle: I'm staring at a role attribute that is set, but seems to be nil in my recipes
[2012-10-03 22:49:18 -0400] jkyle: here we go, so the variable is set and being passed to a provider in another cookbook. But when the other cookbook references new_resource.run_as it uses _its_ default value specified in its resource file...not the one passed
[2012-10-03 22:56:23 -0400] jkyle: gist with comments on what I'm seeing: https://gist.github.com/3830421
[2012-10-03 23:04:16 -0400] _0x783czar: does anybody know where the chef-server webui's files are stored on OpenSource Chef Server?
[2012-10-03 23:05:17 -0400] yfeldblum: _0x783czar, it's a different project, and its source is here: v
[2012-10-03 23:05:20 -0400] yfeldblum: _0x783czar, https://github.com/opscode/chef/tree/master/chef-server-webui
[2012-10-03 23:07:34 -0400] _0x783czar: yfeldblum: oops, sorry, I meant the where they get installed when I setup my open source chef.  I want to know where the index page is
[2012-10-03 23:09:30 -0400] yfeldblum: _0x783czar, it's a gem, so it gets installed to normal place where gems get installed to
[2012-10-03 23:11:04 -0400] jkyle: _0x783czar: gem contents <gemname>
[2012-10-03 23:12:16 -0400] jkyle: I'm curious if this is even expected behavior (not being able to use default attributes from one recipe in another recipe's defined resource providers)
[2012-10-03 23:18:18 -0400] _0x783czar: yfeldblum: jkyle: thanks
[2012-10-03 23:20:20 -0400] yfeldblum: jkyle, `node.to_hash` or `node["postgresql"].to_hash` in the shef shell
[2012-10-03 23:20:51 -0400] yfeldblum: jkyle, is the one passed actually present, i.e., non-nil?
[2012-10-03 23:21:18 -0400] jkyle: filed a bug report on the behavior I'm seeing: #27682
[2012-10-03 23:21:43 -0400] jkyle: yfeldblum: yelp, check out the gist. it explains how I verified the var is set and the behavior I'm seeing
[2012-10-03 23:21:47 -0400] jkyle: https://gist.github.com/3830421
[2012-10-03 23:22:38 -0400] yfeldblum: jkyle, as in if, in the line immediately following the postgresql_database resource declaration, you did the following: `Chef::Log.info resources(:postgresql_database => "#{app["database"]["name"]}").run_as.inspect`
[2012-10-03 23:24:51 -0400] jkyle: I tested the value with log output right before the assignment. the value is what I'd expect (not nil)
[2012-10-03 23:24:56 -0400] _0x783czar: yfeldblum: are you sure it's a gem if I do a package install?  Becuase it's not appearing in my gem list output
[2012-10-03 23:25:13 -0400] jkyle: if you did a package install, use your package management utlity
[2012-10-03 23:25:27 -0400] jkyle: dpkg -L packagename in debian
[2012-10-03 23:26:02 -0400] yfeldblum: jkyle, right but just to be real sure, what happens when you test the assigned value after the assignment?
[2012-10-03 23:26:55 -0400] yfeldblum: jkyle, this is the "science" part of it, where we systematically rule out possibilities one-by-one
[2012-10-03 23:32:51 -0400] josephholsten: Is anyone using the nagios cb to monitor servers they can't ping? I can't remember how to work around the 'hostgroup_name *'
[2012-10-03 23:35:36 -0400] _0x783czar: yfeldblum: jkyle: found it /usr/share/chef-server-webui
[2012-10-03 23:38:06 -0400] jkyle: yfeldblum: testing that would be deep in the core chef libs right?
[2012-10-03 23:38:42 -0400] yfeldblum: jkyle, nope: in the line immediately following the postgresql_database resource declaration, write the following: `Chef::Log.info resources(:postgresql_database => "#{app["database"]["name"]}").run_as.inspect`
[2012-10-03 23:41:00 -0400] jkyle: I thought we weren't guaranteed those log statements would run sequentually with teh block statements
[2012-10-03 23:44:35 -0400] jkyle: looks like it was a string vs. symbol deal
[2012-10-03 23:45:17 -0400] yfeldblum: jkyle, for all actual resource declarations and definition calls, the blocks are executed immediately
[2012-10-03 23:45:38 -0400] yfeldblum: jkyle, for anything else, such as library functions, you will have to look at the source :P
[2012-10-03 23:47:18 -0400] yfeldblum: jkyle, the block attribute of a ruby_block resource is another matter; of course that gets executed during convergence, as do all guards (only_if/not_if)
