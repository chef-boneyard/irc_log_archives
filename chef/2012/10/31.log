[2012-10-31 00:01:53 -0400] programmerq: one thing I'm not 100% sure on is how I'd get a build artifact into chef, if that makes sense.
[2012-10-31 00:02:16 -0400] programmerq: would I run a separate repository server that holds the tarball(s) of the code I want to deploy?
[2012-10-31 00:02:27 -0400] programmerq: or would I put that into chef somehow?
[2012-10-31 00:02:42 -0400] programmerq: data bag? That doesn't actually seems like it is there to do that type of work.
[2012-10-31 00:02:54 -0400] bluepojo: you mean the artifact you want the cookbook to deploy?
[2012-10-31 00:03:01 -0400] programmerq: yes.
[2012-10-31 00:03:02 -0400] bluepojo: use a separate artifact server
[2012-10-31 00:03:06 -0400] programmerq: k
[2012-10-31 00:03:12 -0400] bluepojo: and download from there
[2012-10-31 00:03:44 -0400] bluepojo: we use SonaType Nexus, but if you just need something simple, a bare web server serving files from a directory works well.
[2012-10-31 00:04:08 -0400] programmerq: yeah, that's exactly what I was thinking.
[2012-10-31 00:04:11 -0400] programmerq: nexus for some stuff
[2012-10-31 00:04:15 -0400] programmerq: simple webserver for others
[2012-10-31 00:04:32 -0400] programmerq: I'm sure I could even skip the "build artifact" for some things, and just do a direct checkout from version control.
[2012-10-31 00:05:02 -0400] bluepojo: it's nice to have an artifact that you know passed build verification and testing go all the way through the pipeline to production
[2012-10-31 00:05:09 -0400] bluepojo: rather than trusting a fresh checkout
[2012-10-31 00:05:14 -0400] bluepojo: theoretically it should work
[2012-10-31 00:05:15 -0400] bluepojo: but
[2012-10-31 00:05:19 -0400] bluepojo: artifacts are nicer
[2012-10-31 00:05:20 -0400] bluepojo: :)
[2012-10-31 00:05:21 -0400] programmerq: you can have jenkins tag things on success
[2012-10-31 00:05:25 -0400] bluepojo: it's true
[2012-10-31 00:05:41 -0400] programmerq: and then from there, you can manually tag successful builds for staging/production from there
[2012-10-31 00:06:54 -0400] programmerq: and that's a similar process to how our jenkins build artifacts work now.
[2012-10-31 00:07:08 -0400] programmerq: 1) pull from jenkins, 2) deploy to staging, 3) deploy to production.
[2012-10-31 00:07:37 -0400] bluepojo: I agree that it's roughly the same, but I still prefer packaging up a tar after a success.
[2012-10-31 00:07:48 -0400] bluepojo: checkouts should work fine
[2012-10-31 00:08:07 -0400] programmerq: I have mixed feelings about it. I like both.
[2012-10-31 00:08:12 -0400] programmerq: but they both have drawbacks.
[2012-10-31 00:08:38 -0400] programmerq: but chef could solve many of those drawbacks for both methods
[2012-10-31 00:08:45 -0400] programmerq: and, I digress
[2012-10-31 00:09:00 -0400] programmerq: I work with enough dev groups i'll have to do both methods for the foreseeable future.
[2012-10-31 00:12:48 -0400] Lrrr: Oh yeah, fixed the problem
[2012-10-31 00:12:49 -0400] Lrrr: provides 'ipaddress'
[2012-10-31 00:12:49 -0400] Lrrr: require_plugin "network"
[2012-10-31 00:12:49 -0400] Lrrr: ipaddress network[:interfaces]["venet0:0"][:addresses].to_hash.keys[0]
[2012-10-31 00:12:57 -0400] Lrrr: 3 line ohai plugin ;)
[2012-10-31 00:21:46 -0400] yfeldblum: Lrrr, cool
[2012-10-31 00:22:38 -0400] Lrrr: not perfect... I guess I could make a way to change the default interface
[2012-10-31 00:23:12 -0400] jaimef:  is there a way to force untrusted packages?
[2012-10-31 00:33:38 -0400] Majost: programmerq: the maven cookbook has a provider for dropping war files
[2012-10-31 00:33:56 -0400] Majost: programmerq: and other artifacts... I am trying it out myself for the first time though
[2012-10-31 00:34:16 -0400] Majost: programmerq: I can let you know how it works out, but it sounds like we are doing something very similar
[2012-10-31 00:35:32 -0400] programmerq: Majost: I'm not directly involved with the java teams, but they are using maven, and they want to move to nexus, and we are starting to use chef for those deploys.
[2012-10-31 00:35:38 -0400] programmerq: well, one of the java teams anyway.
[2012-10-31 00:35:59 -0400] programmerq: I'm trying to get RoR stuff figured out, which fortunately, should be pretty trivial.
[2012-10-31 00:36:16 -0400] programmerq: I'm in the initial "figure out the concepts" phase of figuring out how to use chef.
[2012-10-31 00:36:49 -0400] Majost: we are using nexus -- I would look at the maven cookbook though
[2012-10-31 00:36:57 -0400] Majost: not so much for installing maven
[2012-10-31 00:37:13 -0400] Majost: but to drop your artifacts for deployment
[2012-10-31 00:40:01 -0400] Majost: what version of chef did include_attribute get added?
[2012-10-31 00:44:38 -0400] Majost: nm
[2012-10-31 00:44:52 -0400] Majost: long time ago it seems... I just haven't figured out how to use it right
[2012-10-31 00:52:04 -0400] julien__: hello! We have a node.js application and we use an "application" cookbook. the problem that we have is that we need to be able to run 'npm install' to install the required modules after we've deployed a new version. How can we do that with chef?
[2012-10-31 00:52:45 -0400] bluepojo: I don't know the application cookbook very well, but most times you can use resource notifications to do this
[2012-10-31 00:53:06 -0400] bluepojo: notifies "execute[npm install]", :run
[2012-10-31 00:53:08 -0400] bluepojo: or some such
[2012-10-31 00:55:02 -0400] julien__: bluepojo: thanks I'll try to do that.
[2012-10-31 00:56:15 -0400] julien__: I did not know you could execute scripts with notifies
[2012-10-31 00:57:41 -0400] bluepojo: you can notify an execute resource that you define elsewhere
[2012-10-31 00:57:47 -0400] bluepojo: julien__:
[2012-10-31 00:57:57 -0400] bluepojo: set the action to :nothing when you define it
[2012-10-31 00:58:01 -0400] bluepojo: so that it only runs when you notify
[2012-10-31 00:58:17 -0400] julien__: bluepojo: hum. that is not very clear
[2012-10-31 00:58:37 -0400] julien__: also, I actually do not see where to use notifies in the application cookbook
[2012-10-31 00:58:57 -0400] julien__: we have an "application" resource
[2012-10-31 00:59:06 -0400] bluepojo: See here
[2012-10-31 00:59:06 -0400] bluepojo: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-10-31 00:59:08 -0400] julien__: should I put the notifies block inside?
[2012-10-31 00:59:23 -0400] bluepojo: in your application resource
[2012-10-31 00:59:28 -0400] bluepojo: you add a "notifies" line
[2012-10-31 00:59:34 -0400] bluepojo: elsewhere in your cookbook
[2012-10-31 00:59:39 -0400] bluepojo: you need to define what is getting notified
[2012-10-31 00:59:49 -0400] bluepojo: in this case, an execute resource
[2012-10-31 01:00:00 -0400] bluepojo: http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-10-31 01:00:08 -0400] bluepojo: when you call notifies, you give it an action to run
[2012-10-31 01:00:28 -0400] bluepojo: notifies "resource_type[resource_name]", :run
[2012-10-31 01:00:39 -0400] bluepojo: in this case, execute is the resource type
[2012-10-31 01:00:48 -0400] bluepojo: and npm install is probably the resource name
[2012-10-31 01:00:55 -0400] bluepojo: (you could name it whatever tho)
[2012-10-31 01:01:00 -0400] bluepojo: so:
[2012-10-31 01:01:13 -0400] bluepojo: notifies "execute[npm install]"
[2012-10-31 01:01:19 -0400] bluepojo: with the action ":run"
[2012-10-31 01:01:37 -0400] bluepojo: this assumes you have that resource defined in your recipe, however
[2012-10-31 01:01:38 -0400] julien__: that's kind of complex for a very simple thing to do. Doesn't the application have some kind of mechanism to migrate or execute some script when the code has been deployed; pretty much every app I can think off needs to be migrated, or restarted, or logs need to be reopened etc
[2012-10-31 01:01:51 -0400] bluepojo: notifies is pretty simple
[2012-10-31 01:02:01 -0400] bluepojo: and is the way to do this sort of "if this, then that" functionality
[2012-10-31 01:02:10 -0400] bluepojo: once you get it, it's literally 1 line of code
[2012-10-31 01:02:16 -0400] bluepojo: to make everything work
[2012-10-31 01:02:20 -0400] julien__: bluepojo there is an "application" resource in the application cookbook
[2012-10-31 01:02:23 -0400] bluepojo: right
[2012-10-31 01:02:29 -0400] bluepojo: which you want to notify the execute resource
[2012-10-31 01:02:36 -0400] bluepojo: that runs "npm install"
[2012-10-31 01:02:47 -0400] julien__: so, inside the block of the application resource, I add what?
[2012-10-31 01:03:28 -0400] bluepojo: https://gist.github.com/3984178
[2012-10-31 01:03:33 -0400] bluepojo: here :)
[2012-10-31 01:03:46 -0400] bluepojo: oops, fixed the quote
[2012-10-31 01:03:52 -0400] julien__: that's simple, indeed
[2012-10-31 01:04:21 -0400] bluepojo: the only possibly confusing part is "action :nothing" on the execute resource
[2012-10-31 01:04:31 -0400] bluepojo: that just makes sure that, unless it gets notified, don't run
[2012-10-31 01:04:42 -0400] julien__: bluepojo that makes sense
[2012-10-31 01:05:17 -0400] julien__: shouldn't there be a command inside the resource "npm install"
[2012-10-31 01:05:19 -0400] julien__: ?
[2012-10-31 01:05:30 -0400] bluepojo: by default it uses the parameter
[2012-10-31 01:05:43 -0400] bluepojo: in the gist, it'll execute "npm install"
[2012-10-31 01:06:07 -0400] julien__: bluepojo: seems good to me! Let's deploy that and see if it works
[2012-10-31 01:06:09 -0400] bluepojo: you can also name it something else and provide "command"
[2012-10-31 01:06:13 -0400] julien__: thanks for the precious help
[2012-10-31 01:06:18 -0400] bluepojo: yep yep
[2012-10-31 01:17:36 -0400] behemphi: Evening all, I am upgrading to 10.16.2 and moving to omnibus, but having some strange behavior.  I am using knife-ssh
[2012-10-31 01:17:45 -0400] behemphi: but some of my nodes return this:
[2012-10-31 01:17:45 -0400] behemphi: WARNING: Failed to connect to  -- SocketError: getaddrinfo: Name or service not known
[2012-10-31 01:17:53 -0400] behemphi: note that there is no node name
[2012-10-31 01:18:08 -0400] behemphi: Others return this:
[2012-10-31 01:18:08 -0400] behemphi: 184-106-251-37.static.cloud-ips.com
[2012-10-31 01:18:15 -0400] behemphi: instead of the node name
[2012-10-31 01:18:27 -0400] behemphi: and still others return the expected node name
[2012-10-31 01:18:40 -0400] behemphi: is this strangeness documented anywhere?
[2012-10-31 01:19:01 -0400] julien__: bluejojo: I have a path problem. I need to find how to run this is in the right directory
[2012-10-31 01:36:33 -0400] gyre008: behemphi, are you on CRackspace cloud ?
[2012-10-31 01:38:45 -0400] gyre008: behemphi, CRackspace are constantly having some DNS issues.
[2012-10-31 01:41:01 -0400] behemphi: @gyre008, I am at Rackspace but not sure what CRackspace is
[2012-10-31 01:41:02 -0400] behemphi: ?
[2012-10-31 01:41:17 -0400] gyre008: CRackspace is a joke name for Rackspace
[2012-10-31 01:41:27 -0400] gyre008: its always cracking...
[2012-10-31 01:41:33 -0400] behemphi: boy am I feeling sheepish :-)
[2012-10-31 01:41:58 -0400] behemphi: Not sure this is DNS as it directly correlates to upgrading chef
[2012-10-31 01:42:12 -0400] behemphi: once I started using knife 10.16.2 this was a problem
[2012-10-31 01:42:27 -0400] behemphi: It may be that it correlates to Ohai version?
[2012-10-31 01:42:35 -0400] gyre008: yepthere was a bunch of changes introducedand some of them not really smart
[2012-10-31 01:42:44 -0400] gyre008: one of the bugs http://tickets.opscode.com/browse/CHEF-3484
[2012-10-31 01:43:22 -0400] gyre008: nah.has nothing to do with OHai...
[2012-10-31 01:43:56 -0400] gyre008: this is the DNS problem github https://github.com/opscode/knife-rackspace/pull/26
[2012-10-31 01:44:11 -0400] gyre008: its messy :)
[2012-10-31 01:45:38 -0400] gyre008: i can tell you what might fix your problemit does for me anyway
[2012-10-31 01:45:57 -0400] behemphi: sorry reading in the links now
[2012-10-31 01:46:11 -0400] behemphi: what do you have?
[2012-10-31 01:46:23 -0400] behemphi: short of AWS :-)
[2012-10-31 01:46:29 -0400] gyre008: small thing in ssh.rbsecond
[2012-10-31 01:47:31 -0400] gyre008: i need to find that damn file :)
[2012-10-31 01:48:28 -0400] julien___: For some reason, our "notifies :run" in a resource nevers get called/executed. anyone knows why?
[2012-10-31 01:48:53 -0400] behemphi: no hurry gyre008, I appreciate your time!
[2012-10-31 01:51:05 -0400] julien___: notifies :run, "execute[npminstall]", :immediately. The command in our execute "npminstall" resource never executed :/
[2012-10-31 01:51:24 -0400] Lrrr: What are the cookbooks available in https://github.com/cookbooks?
[2012-10-31 01:56:02 -0400] gyre008: behemphi, copy your ssh.rb somewhere for backup and then replace the configure_session with the following code https://gist.github.com/3984352
[2012-10-31 01:56:31 -0400] gyre008: julien___, gist some code please
[2012-10-31 01:57:25 -0400] julien___: gyre008: https://gist.github.com/6e92706e9311808718aa
[2012-10-31 01:58:07 -0400] julien___: gyre008: no error raised or anything, but the hello file is never ever touched :/
[2012-10-31 01:58:49 -0400] julien___: any clue?
[2012-10-31 01:59:16 -0400] gyre008: julien___, I would start by replacing action :nothing with action :run :)
[2012-10-31 01:59:26 -0400] gyre008: in that execute resource ;)
[2012-10-31 01:59:56 -0400] julien___: gyre008: no, I don't want this to run unless there was a notification. I followed the code given http://wiki.opscode.com/display/chef/Resources#Resources-Script
[2012-10-31 02:00:00 -0400] julien___: 'Execute a command only on notification'
[2012-10-31 02:00:33 -0400] gyre008: ah I see
[2012-10-31 02:00:44 -0400] julien___: of course the doc could be wrong, but then it's hard to know what I should do or not. :)
[2012-10-31 02:01:21 -0400] gyre008: no thats correct..did you try to run chef-client with -l debug ?  more log statements...
[2012-10-31 02:02:10 -0400] julien___: gyre008 I tried: no information whatsover
[2012-10-31 02:02:49 -0400] cagemonkey1: I am having an issue validating an email to update my profile. After verifying email address I try to edit profile and it sends me into a loop wanting me to re-validate again. About to go insane!
[2012-10-31 02:04:05 -0400] behemphi: @gyre008 I have not worked with ssh.rb b/f
[2012-10-31 02:04:09 -0400] behemphi: where is it located?
[2012-10-31 02:04:13 -0400] cagemonkey1: I am basically just trying to get my private key
[2012-10-31 02:04:32 -0400] gyre008: behemphi, where is your gem installed ?
[2012-10-31 02:04:43 -0400] gyre008: Im using rbenvon Mac OS
[2012-10-31 02:05:15 -0400] julien___: pfffff
[2012-10-31 02:05:30 -0400] julien___: "[2012-10-30T22:05:10-04:00] INFO: Processing execute[npminstall] action nothing (supernoder::default line 61)
[2012-10-31 02:05:31 -0400] julien___: [2012-10-30T22:05:10-04:00] DEBUG: Doing nothing for execute[npminstall]"
[2012-10-31 02:05:42 -0400] behemphi: ah, that might be part of my problem.  I switched to omnibus @gyre008
[2012-10-31 02:06:10 -0400] julien___: gyre008: so I guess the docs are wrong?
[2012-10-31 02:06:16 -0400] gyre008: julien___, can yo see notification in the logs ??
[2012-10-31 02:06:32 -0400] gyre008: behemphi, nah..you need to find that ssh.rb file...
[2012-10-31 02:06:43 -0400] gyre008: its shipped with chef gem
[2012-10-31 02:06:50 -0400] julien___: gyre008: not sure.
[2012-10-31 02:06:51 -0400] gyre008: if your are using omnibus
[2012-10-31 02:06:58 -0400] gyre008: what OS are you on ?
[2012-10-31 02:07:05 -0400] behemphi: ubuntu 10.04
[2012-10-31 02:07:15 -0400] gyre008: if LInux then it should be in /opt/chef...
[2012-10-31 02:07:32 -0400] julien___: gyre008: the thing is if I put a resource that does not exist, chef throws an error, so I think the notifies :run, "execute[npminstall]", :immediately is right
[2012-10-31 02:07:40 -0400] gyre008: just run find /opt/chef -iname "ssh.rb" |grep knife
[2012-10-31 02:08:03 -0400] gyre008: julien___, that notifies statement seems to be correct
[2012-10-31 02:08:15 -0400] killfill: julien___: your trying to use the application reicipe for a nodejs app?
[2012-10-31 02:08:18 -0400] julien___: gyre008 but the log doesn't show anything about it being triggered (or not!)
[2012-10-31 02:08:27 -0400] julien___: killfill: yes, desperately
[2012-10-31 02:08:51 -0400] killfill: julien___: was trying to do exactly the same in the morning.. :P
[2012-10-31 02:09:07 -0400] julien___: that 'npm install' is the only thing I'm missing and I'm crying at how impossible that seems
[2012-10-31 02:09:17 -0400] behemphi: OK, got it, but I need to step away.  Thanks for the time @gyre008, is this part of a pull request or soemthing I can +1 if it works?
[2012-10-31 02:09:28 -0400] julien___: killfill where you able to automatically run a command after a code checkout?
[2012-10-31 02:09:34 -0400] gyre008: julienI can show you what I got I have nodes application cookbookvery simple and it works...
[2012-10-31 02:09:50 -0400] gyre008: its using application cookbook
[2012-10-31 02:10:07 -0400] julien___: gyre008: please show me!
[2012-10-31 02:10:16 -0400] killfill: julien___: i tried to use the 'before_migrate' hook, but it did not execute..
[2012-10-31 02:10:27 -0400] julien___: killfill: I tried this one too
[2012-10-31 02:10:31 -0400] gyre008: behemphi, not its not ;(I tried to push it but Brian rejected itbut its working perfectly fine for mein case you have any problem drop me a mail..
[2012-10-31 02:10:34 -0400] julien___: but it did not work
[2012-10-31 02:10:36 -0400] killfill: but i think the problem was comming from the deploy_revision thing.
[2012-10-31 02:10:43 -0400] gyre008: julien___, secondwill gist it...
[2012-10-31 02:10:55 -0400] gyre008: but yeahit's kind of a pain and it took me some time to figure it out :)
[2012-10-31 02:11:07 -0400] killfill: aa cool.. :)
[2012-10-31 02:13:18 -0400] julien___: ?
[2012-10-31 02:16:34 -0400] Lrrr: "is configured to notify resource execute[build-tinydns-internal-data] with action run, but execute[build-tinydns-internal-data] cannot be found in the resource collection" <= How can I fix this?
[2012-10-31 02:16:47 -0400] julien___: killfill: where you able at all to run a script once your app was deployed or checked out?
[2012-10-31 02:17:33 -0400] gyre008: julien___, killfill https://gist.github.com/3984419
[2012-10-31 02:18:19 -0400] julien___: gyre008: thanks. Let me try that now
[2012-10-31 02:19:14 -0400] gyre008: thats what IM usingit depends on nodes community cookbook -> http://community.opscode.com/cookbooks/nodejs
[2012-10-31 02:22:41 -0400] killfill: gyre008: ooh that would be like a application_nodejs thingy? :)
[2012-10-31 02:22:54 -0400] gyre008: killfill, yep
[2012-10-31 02:23:07 -0400] gyre008: that is / should be exactly that :)
[2012-10-31 02:23:08 -0400] killfill: gyre008: are you manuel?
[2012-10-31 02:23:25 -0400] gyre008: Im not manuel :)
[2012-10-31 02:23:31 -0400] gyre008: not even Emanuel :)
[2012-10-31 02:23:43 -0400] killfill: heh..
[2012-10-31 02:24:02 -0400] julien___: gyre008: still not installing the npm modules for me :(
[2012-10-31 02:24:14 -0400] killfill: gyre008: you should put that on a github repo .. :P
[2012-10-31 02:24:18 -0400] gyre008: julien___, thats strangeit is for me..
[2012-10-31 02:24:30 -0400] gyre008: killfill, yeahi willjust needs some code cleanup
[2012-10-31 02:24:43 -0400] julien___: pffff
[2012-10-31 02:25:09 -0400] killfill: gyre008: found this: https://github.com/manuelmorales/application_node in the morning.. i just didnt knew how to use it.. looks somwhat similar
[2012-10-31 02:25:14 -0400] killfill: (new to chef actually.. :)
[2012-10-31 02:26:07 -0400] gyre008: mm interesting :) damn it! that could've saved me some time haha
[2012-10-31 02:26:46 -0400] gyre008: gotta go chapsc ya!
[2012-10-31 02:26:48 -0400] killfill: but i tried to use plain before_migrate firectly on my recipe, but it didnt fired up.. just like the prob julien___ have..
[2012-10-31 02:28:58 -0400] julien___: gyre008 what version of chef do you use?
[2012-10-31 02:30:05 -0400] Lrrr: hrm... this is annoying
[2012-10-31 02:30:10 -0400] killfill: julien___: are you using chef-solo?
[2012-10-31 02:30:21 -0400] julien___: killfill no chef-client
[2012-10-31 02:30:35 -0400] killfill: im trying with chef-solo and 10.16.2
[2012-10-31 02:31:09 -0400] julien___:  chef-client -v
[2012-10-31 02:31:09 -0400] julien___: Chef: 10.16.2
[2012-10-31 02:31:31 -0400] killfill: oh let me guess... gyre007 is using 10.16.3.. :P
[2012-10-31 02:32:24 -0400] julien___: :(
[2012-10-31 02:32:56 -0400] killfill: damn.. cannot access the serve to test your gist gyre007 .. :S
[2012-10-31 02:32:58 -0400] julien___: gyre008
[2012-10-31 02:33:03 -0400] julien___: https://gist.github.com/3984419
[2012-10-31 02:33:06 -0400] julien___: azd
[2012-10-31 02:33:21 -0400] julien___: RESOURCE:
[2012-10-31 02:33:21 -0400] julien___: =================
[2012-10-31 02:33:23 -0400] julien___: $ cat resources/nodejs.rb
[2012-10-31 02:33:24 -0400] julien___: include Chef::Resource::ApplicationBase
[2012-10-31 02:33:26 -0400] julien___: attribute :port, :kind_of => Integer, :default => 5000
[2012-10-31 02:33:27 -0400] julien___: attribute :script, :kind_of => String, :default => 'app.js'
[2012-10-31 02:33:29 -0400] julien___: attribute :log_dir, :kind_of => String
[2012-10-31 02:33:30 -0400] julien___: PROVIDER:
[2012-10-31 02:33:32 -0400] julien___: =================
[2012-10-31 02:33:33 -0400] julien___: $ cat providers/nodejs.rb
[2012-10-31 02:33:35 -0400] julien___: include Chef::Mixin::LanguageIncludeRecipe
[2012-10-31 02:33:36 -0400] julien___: action :before_compile do
[2012-10-31 02:33:38 -0400] julien___:   #this cookbook can be found in community cookbooks
[2012-10-31 02:33:39 -0400] julien___:   include_recipe 'nodejs'
[2012-10-31 02:33:41 -0400] julien___:   setup_log_dir
[2012-10-31 02:33:42 -0400] julien___:   #Set the resource's restart command to restart the upstart service
[2012-10-31 02:33:44 -0400] julien___:   new_resource.restart_command do
[2012-10-31 02:33:45 -0400] julien___:     service_name = new_resource.application.name
[2012-10-31 02:33:47 -0400] julien___:     service = run_context.resource_collection.find(:service => service_name)
[2012-10-31 02:33:48 -0400] julien___:     service.run_action(:restart)
[2012-10-31 02:33:50 -0400] julien___:   end
[2012-10-31 02:33:51 -0400] julien___: end
[2012-10-31 02:33:52 -0400] killfill: flood!
[2012-10-31 02:33:53 -0400] julien___: action :before_deploy do
[2012-10-31 02:33:54 -0400] julien___:   service new_resource.application.name do
[2012-10-31 02:33:56 -0400] julien___:     provider Chef::Provider::Service::Upstart
[2012-10-31 02:33:57 -0400] julien___:     supports :status => true, :restart => true, :reload => true
[2012-10-31 02:33:59 -0400] julien___:     action :enable
[2012-10-31 02:34:00 -0400] julien___:   end
[2012-10-31 02:34:02 -0400] julien___:   log_file_name = "#{new_resource.application.name}.log"
[2012-10-31 02:34:03 -0400] julien___:   log_path = ::File.join(new_resource.log_dir, log_file_name)
[2012-10-31 02:34:05 -0400] julien___:   template "/etc/init/#{new_resource.application.name}.conf" do
[2012-10-31 02:34:06 -0400] julien___:     cookbook 'application_nodejs'
[2012-10-31 02:34:08 -0400] julien___:     source 'upstart.conf.erb'
[2012-10-31 02:34:10 -0400] julien___:     variables(
[2012-10-31 02:34:11 -0400] julien___:       :app_name => new_resource.application.name,
[2012-10-31 02:34:13 -0400] julien___:       :script => new_resource.script,
[2012-10-31 02:34:14 -0400] julien___:       :log_path => log_path,
[2012-10-31 02:34:16 -0400] julien___:       :user => new_resource.owner,
[2012-10-31 02:34:17 -0400] julien___:       :port => new_resource.port,
[2012-10-31 02:34:19 -0400] julien___:       :cwd => ::File.join(new_resource.path, 'current')
[2012-10-31 02:34:20 -0400] julien___:     )
[2012-10-31 02:34:22 -0400] julien___:     notifies :restart, "service[#{new_resource.application.name}]"
[2012-10-31 02:34:23 -0400] Lrrr: Sandy is hitting hard in #Chef!!!
[2012-10-31 02:34:23 -0400] julien___:   end
[2012-10-31 02:34:25 -0400] julien___: end
[2012-10-31 02:34:26 -0400] julien___: action :before_migrate do
[2012-10-31 02:34:28 -0400] julien___:   install_packages
[2012-10-31 02:34:29 -0400] julien___: end
[2012-10-31 02:34:31 -0400] julien___: action :before_symlink do
[2012-10-31 02:34:32 -0400] julien___: end
[2012-10-31 02:34:34 -0400] julien___: action :before_restart do
[2012-10-31 02:34:35 -0400] julien___:   setup_upstart_service
[2012-10-31 02:34:37 -0400] julien___: end
[2012-10-31 02:34:38 -0400] julien___: action :after_restart do
[2012-10-31 02:34:40 -0400] julien___: end
[2012-10-31 02:34:41 -0400] julien___: protected
[2012-10-31 02:34:43 -0400] julien___: def setup_log_dir
[2012-10-31 02:34:44 -0400] julien___:   unless new_resource.log_dir
[2012-10-31 02:34:46 -0400] julien___:     new_resource.log_dir "/var/log/#{new_resource.application.name}"
[2012-10-31 02:34:47 -0400] julien___:   end
[2012-10-31 02:34:49 -0400] julien___:   # Make sure the logging directory exists with the right ownership
[2012-10-31 02:34:50 -0400] julien___:   directory new_resource.log_dir do
[2012-10-31 02:34:52 -0400] julien___:     user  new_resource.owner if new_resource.owner
[2012-10-31 02:34:53 -0400] julien___:     group new_resource.group if new_resource.group
[2012-10-31 02:34:55 -0400] julien___:   end
[2012-10-31 02:34:56 -0400] julien___: end
[2012-10-31 02:34:58 -0400] julien___: def install_packages
[2012-10-31 02:34:59 -0400] julien___:   execute "npm install --production" do
[2012-10-31 02:35:01 -0400] julien___:     cwd new_resource.release_path
[2012-10-31 02:35:02 -0400] julien___:     user new_resource.owner
[2012-10-31 02:35:04 -0400] julien___:     environment new_resource.environment
[2012-10-31 02:35:05 -0400] julien___:   end
[2012-10-31 02:35:07 -0400] julien___: end
[2012-10-31 02:35:08 -0400] julien___: TEMPLATE:
[2012-10-31 02:35:10 -0400] julien___: ========
[2012-10-31 02:35:11 -0400] julien___: cat application_nodejs/templates/default/upstart.conf.erb
[2012-10-31 02:35:13 -0400] julien___: # Managed by Chef -- do not modify
[2012-10-31 02:35:14 -0400] julien___: description '<%= @app_name %> (Node.js) upstart script'
[2012-10-31 02:35:16 -0400] julien___: start on (local-filesystems and net-device-up)
[2012-10-31 02:35:17 -0400] julien___: stop on shutdown
[2012-10-31 02:35:19 -0400] julien___: respawn
[2012-10-31 02:35:20 -0400] julien___: respawn limit 5 60
[2012-10-31 02:35:22 -0400] julien___: chdir <%= @cwd %>
[2012-10-31 02:35:23 -0400] julien___: exec sudo -u <%= @user %> PORT=<%= @port %> node <%= @script %> >> <%= @log_path %> 2>&1
[2012-10-31 02:35:25 -0400] julien___: EXAMPLE RECIPE:
[2012-10-31 02:35:26 -0400] julien___: =================
[2012-10-31 02:35:28 -0400] julien___: application 'node_app' do
[2012-10-31 02:35:29 -0400] julien___:   path '/app'
[2012-10-31 02:35:31 -0400] julien___:   owner 'foo'
[2012-10-31 02:35:32 -0400] julien___:   group 'foo'
[2012-10-31 02:35:34 -0400] julien___:   repository 'git@github.com:foo/foo.git'
[2012-10-31 02:35:35 -0400] julien___:   revision 'master'
[2012-10-31 02:35:37 -0400] julien___:   packages %w( git )
[2012-10-31 02:35:38 -0400] julien___:   action :deploy
[2012-10-31 02:35:40 -0400] julien___:   nodejs do
[2012-10-31 02:35:41 -0400] julien___:     port some_port
[2012-10-31 02:35:43 -0400] julien___:   end
[2012-10-31 02:35:44 -0400] julien___: end
[2012-10-31 02:35:45 -0400] julien___: opus. Sorry, wrong paste, wrong place
[2012-10-31 02:38:35 -0400] julien___: #Chefail
[2012-10-31 02:39:37 -0400] rdavila: Hi guys!
[2012-10-31 02:40:13 -0400] rdavila: somebody knows an updated cookbook for postgres 9 with support for debian?
[2012-10-31 02:50:47 -0400] Lrrr: How do I use a LWRP resource defined in another cookbook?
[2012-10-31 02:55:45 -0400] Lrrr: no... nevermind
[2012-10-31 02:55:49 -0400] Lrrr: tht's not my problem
[2012-10-31 02:59:31 -0400] Lrrr: yay
[2012-10-31 03:01:19 -0400] flaccid: Lrrr: you simply depend on that cookbook
[2012-10-31 03:01:19 -0400] flaccid: in metadata
[2012-10-31 04:26:30 -0400] capen: anyone know why I might be seeing this?
[2012-10-31 04:26:31 -0400] capen: FATAL: Chef::Exceptions::ResourceNotFound: Cannot find a resource matching execute[rebuild-iptables] (did you define it first?)
[2012-10-31 04:26:44 -0400] capen: not finding much online
[2012-10-31 04:35:40 -0400] silk1: only that there may not be an execute resource named "rebuild-iptables"
[2012-10-31 04:37:52 -0400] capen: k.  checking.
[2012-10-31 04:59:02 -0400] capen: damn my bad.  helps to actually enable iptables. :)  set override attribute in my role and I'm good.. 'iptables' => { 'enabled' => true }
[2012-10-31 05:40:42 -0400] capen: ls
[2012-10-31 05:47:24 -0400] coderanger: Applications   Documents      Dropbox        Movies         Pictures       Public
[2012-10-31 08:08:38 -0400] priest_: hello guys, i have a little problem bootstrapping a ubuntu node. when calling "knife bootstrap 10.31.200.126 -N ChefNode01 -x engage -P engage -sudo" i get a premission denied when it's trying to dpkg the files. obviously it does not use "sudo"? or is there something else i'm doing wrong? Oo
[2012-10-31 08:21:10 -0400] priest_: never mind... now using "--sudo" instead of "-sudo"
[2012-10-31 08:50:06 -0400] masterkorp: hello hchefd
[2012-10-31 08:55:27 -0400] polysics: hello
[2012-10-31 08:55:31 -0400] polysics: chef noob here :-)
[2012-10-31 08:55:49 -0400] polysics: how do you usualyl manage a recipe that needs to pull from multiple private Github repos?
[2012-10-31 08:56:11 -0400] polysics: it's only one project but uses multiple gems, some of which are private
[2012-10-31 10:09:27 -0400] specialsauce: is there a known chef issue whereby chef client will run, say that a file created from disk exists, contents haven't changed, and so it doesn't update it... even though the file doesn't exist on the filesystem?
[2012-10-31 10:09:41 -0400] specialsauce: i've tried clering the cookbook and checksum caches off disk to no avail so far
[2012-10-31 10:18:07 -0400] masterkorp: specialsauce: recipe, and chef output plase ?
[2012-10-31 10:18:35 -0400] specialsauce: masterkorp: this is apparently for all recipes
[2012-10-31 10:19:14 -0400] masterkorp: paste one spefific example and the output then
[2012-10-31 10:19:20 -0400] specialsauce: in debug mode the output is:
[2012-10-31 10:20:43 -0400] specialsauce: http://pastebin.com/NEEGpFF8
[2012-10-31 10:21:25 -0400] specialsauce: this is happening since yesterday across all hosts, all recipes
[2012-10-31 10:21:40 -0400] specialsauce: the file doesn't exist on disk, yet it says it is up to date :-/
[2012-10-31 10:22:56 -0400] specialsauce: so chef has basically flipped into no-op mode
[2012-10-31 10:23:14 -0400] masterkorp: sorry i cant help you
[2012-10-31 10:23:38 -0400] specialsauce: tis a weird one
[2012-10-31 10:24:20 -0400] masterkorp: i am having the exact oposite problem
[2012-10-31 10:24:29 -0400] specialsauce: lol
[2012-10-31 10:24:36 -0400] nacer: can i set environment to cron ressource ?
[2012-10-31 10:24:41 -0400] masterkorp: the template never changes, yet chef cant read it
[2012-10-31 10:25:08 -0400] masterkorp: nacer: use a not_if or if_only
[2012-10-31 10:25:41 -0400] nacer: masterkorp: i wasn't clear , i mean a shell environment variable
[2012-10-31 10:28:43 -0400] masterkorp: nacer: paste what are you trying to do
[2012-10-31 10:29:00 -0400] nacer: masterkorp: add this attribute to cron ressource : environment ({'LC_ALL' => 'fr_FR.UTF-8'})
[2012-10-31 10:34:36 -0400] masterkorp: that does not look like a shell env man
[2012-10-31 10:43:46 -0400] masterkorp: nacer: usually env vars do not work, its a run under a simple env
[2012-10-31 10:43:57 -0400] masterkorp: unless you configure your cron manager
[2012-10-31 10:44:01 -0400] masterkorp: fcron can do that
[2012-10-31 10:55:32 -0400] nacer: masterkorp: yeah , i have add my env variable in my commands line
[2012-10-31 10:58:08 -0400] masterkorp: can you show your cron resource ?
[2012-10-31 11:17:44 -0400] Virunga: I think i read about crypted data bags somewhere but i can't find where right now. Could you help me?
[2012-10-31 11:28:25 -0400] jtimberman: Virunga: http://wiki.opscode.com/display/chef/Encrypted+Data+Bags
[2012-10-31 11:28:59 -0400] jtimberman: real example here: http://jtimberman.housepub.org/blog/2011/08/06/encrypted-data-bag-for-postfix-sasl-authentication/
[2012-10-31 11:29:59 -0400] Virunga: jtimberman: thank you!
[2012-10-31 11:38:34 -0400] masterkorp: encrypted data bags are mandatory :)
[2012-10-31 12:02:20 -0400] killfill: hi
[2012-10-31 12:03:19 -0400] masterkorp: halo
[2012-10-31 12:05:39 -0400] killfill: im playing with knife bootstrap.. the file that gets executed in the node is basically a shell script. how do i pass a env variable to it, so i can read it there and do things with it?
[2012-10-31 12:07:38 -0400] Nopik: is knife ec2 plugin supporting setting placement group upon start? it doesn't seem so :(
[2012-10-31 12:08:03 -0400] Nopik: any opscode developer here? i'd like to file a feature request :)
[2012-10-31 12:10:19 -0400] specialsauce: i'm having an issue where chef is making no-op changes (it says its not updating templates etc becuase the checksums for the new and existing match, but the file doesn't exist on disk on the client). Is this a known bug?
[2012-10-31 12:11:02 -0400] specialsauce: (this is happening across all cookbooks seemingly and on all hosts)
[2012-10-31 12:18:43 -0400] killfill: Nopik: your using knife bootstrap?
[2012-10-31 12:18:55 -0400] Nopik: killfill: no, knife ec2 plugin
[2012-10-31 12:18:59 -0400] killfill: ok
[2012-10-31 12:29:43 -0400] killfill: anyone uses knife bootstrap?.. how do i pass a parameter to it?
[2012-10-31 12:30:14 -0400] masterkorp: what are you trying to do ?
[2012-10-31 12:30:29 -0400] killfill: i.e. for doing "curl http://#{http_server}/i_am_been_boostrapped"
[2012-10-31 12:31:17 -0400] killfill: masterkorp: im using chef-solo, so wish to specify where it should download the cookbooks from
[2012-10-31 12:31:41 -0400] masterkorp: bootstarp is not for that
[2012-10-31 12:33:56 -0400] killfill: masterkorp:  i see @config has :first_boot_attributes, maybe i could add somthing there and the read it from the template?
[2012-10-31 12:45:29 -0400] masterkorp: killfill: http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-10-31 12:57:32 -0400] gyre008: would something like this work in LWRP provider ? https://gist.github.com/3986882
[2012-10-31 12:58:10 -0400] masterkorp: not sure what are you trying to achive there
[2012-10-31 12:58:12 -0400] gyre008: basicallythe idea is to use @new_resource OUTSIDE of any action to initialise variable which is then used within the action methods...
[2012-10-31 12:58:28 -0400] gyre008: just want to avoid using @ var...
[2012-10-31 12:58:58 -0400] masterkorp: like an alias... hm... could be, not sure tough
[2012-10-31 12:59:40 -0400] gyre008: yeahwant to avoid using instance variablerather to assign its value to local var..
[2012-10-31 12:59:45 -0400] gyre008: globally..
[2012-10-31 13:01:22 -0400] masterkorp: well, nothing like trying and see, report the result, i am curious
[2012-10-31 13:21:46 -0400] behemphi: I have a question about topic in here.  I am not a power IRC user, so please bear with me:
[2012-10-31 13:22:10 -0400] behemphi: I am pretty sure I have been able to demonstrate a bug in chef 10.16 in kinfe-ssh
[2012-10-31 13:22:16 -0400] behemphi: on the RS cloud
[2012-10-31 13:22:39 -0400] geekbri: You should file the bug report in opscode Jira!
[2012-10-31 13:22:42 -0400] behemphi: Is it right to discuss here first to firm up details, or should I simply file a bug report
[2012-10-31 13:22:54 -0400] behemphi: well there you go!
[2012-10-31 13:23:37 -0400] geekbri: Well it is totally fine to discuss it here with people first to firm up the details.  That is never a bad thing
[2012-10-31 13:23:52 -0400] geekbri: But ultimately it should be filed at tickets.opscode.com
[2012-10-31 13:24:46 -0400] behemphi: Who is geekbri?  Did I meet you last week?
[2012-10-31 13:24:52 -0400] behemphi: (and thx for the answer)
[2012-10-31 13:45:10 -0400] behemphi: Is there a way to specify the version of chef I want via the omnibus installer?
[2012-10-31 13:50:08 -0400] Nopik: when i am installing something in a recipe, and then later in that recipe i need to run installed command and capture its output, typically chef runs recipes without execution, just remember parameters, and then plays the recorded actions out.. which means that actually i'm trying to execute command before it is installed. any elegant solution to that?
[2012-10-31 13:51:44 -0400] geekbri: behemphi: You didn't meet me.  I was unable to attend the summit due to work obligations :(
[2012-10-31 13:52:10 -0400] geekbri: I am a loud mouth and have a tendency to answer questions so that may be why you recognize my name.
[2012-10-31 13:52:57 -0400] masterkorp: Nopik: you need to parse the output every time ?
[2012-10-31 13:53:34 -0400] Nopik: masterkorp: the recipe wont do anything if it is run second time
[2012-10-31 13:54:16 -0400] masterkorp: And do you want the command to run every time ?
[2012-10-31 13:54:27 -0400] Nopik: masterkorp: only together with recipe
[2012-10-31 13:54:52 -0400] Nopik: masterkorp: i.e. i install it once, i run it once, i need to parse output once and store it, for second run whole procedure wont kick in
[2012-10-31 13:55:12 -0400] gyre008: behemphi, did you try that thing I advised you last night ?
[2012-10-31 13:55:42 -0400] Nopik: like, i'm creating config file for nginx, and i have gem_package 'passenger' installed and want to run 'passenger-config --root' to figure out where it got installed, to put that path to the config file
[2012-10-31 13:57:09 -0400] masterkorp: Nopik: have the gem_package notifying a block with the passenger-config --root command
[2012-10-31 13:57:36 -0400] Nopik: masterkorp: nice, thanks
[2012-10-31 13:57:49 -0400] _axx: Hey guys, i don't have any experience with Chef, but i want to ask if it's possible to use Chef to setup new VMs without installing anything on the target VM and without having to run Chef software on the target VM? I would like to setup multiple VMs and want no connection between them and Chef.
[2012-10-31 13:58:43 -0400] masterkorp: Nopik: and in on the resource block with the command, place action :nothing
[2012-10-31 13:58:51 -0400] masterkorp: so its only run when notified
[2012-10-31 13:59:06 -0400] masterkorp: and gem only nofities when intalls or upgrades
[2012-10-31 13:59:25 -0400] Nopik: masterkorp: yes, i know, i used notifications in other places, just it didnt occured to me that they are solution here, too
[2012-10-31 14:05:10 -0400] gyre008: guys..in LWRPscan I pass an array of action to it ?
[2012-10-31 14:05:23 -0400] gyre008: like action [:act1, :act2]
[2012-10-31 14:05:33 -0400] gyre008: I would assume I should be able to do that..
[2012-10-31 14:05:59 -0400] gyre008: Im just writing a code now..havent tested this hence my questionsmight have answers later this week :)
[2012-10-31 14:07:14 -0400] kryptek: gyre008,  You kinda do pass an array to an LWRP when you use it
[2012-10-31 14:07:21 -0400] kryptek: gyre008,  What specifically are you trying to do?
[2012-10-31 14:07:22 -0400] Nopik: masterkorp: well, the problem is that template resource do not accept action :nothing
[2012-10-31 14:09:07 -0400] gyre008: kryptek, I have an LWRP written and would like to call 2 actions on it in one block as oppose to 2 separate blocks
[2012-10-31 14:09:13 -0400] masterkorp: Why are you using the template resource ?
[2012-10-31 14:09:46 -0400] Nopik: masterkorp: and what should i use instead? i want to create config file with some customized content?
[2012-10-31 14:11:06 -0400] kryptek: gyre008,  So not something like: http://pastie.org/5142947 ?
[2012-10-31 14:11:30 -0400] yfeldblum: _axx, on a VM, install chef via the full-stack installer; make a copy of that dir (/opt/chef); on a new VM, mount that dir, mount a place to house the config file, and run
[2012-10-31 14:12:45 -0400] Nopik: masterkorp: and, one part of customized content of that config file is the path to the gem installed above
[2012-10-31 14:13:05 -0400] behemphi: @gyre008, I have not yet tried what you gave me as I want to get my env stable first
[2012-10-31 14:13:06 -0400] gyre008: nope kryptek ...
[2012-10-31 14:13:14 -0400] gyre008: something like this http://pastie.org/5142954
[2012-10-31 14:13:21 -0400] behemphi: time permitting today I plan to try it.
[2012-10-31 14:13:21 -0400] Nopik: unfortunately chef calculates template variables in the first run, and then actually run commands
[2012-10-31 14:13:55 -0400] gyre008: behemphi, well you can always back up the original file and try to do what I advised youit should work ok..it does for me anywayand I was seeing exactly the same problem as you
[2012-10-31 14:15:56 -0400] kryptek: gyre008,  Why not call an action that does both tasks you need for that use case?
[2012-10-31 14:16:07 -0400] behemphi: @gyre008 I read last night (bleary eyed and badgered) that the file swap was for all chef clients.  Is your solution just for the workstation side?
[2012-10-31 14:16:26 -0400] behemphi: In that case I will try it right now and include results in the bug report
[2012-10-31 14:16:30 -0400] gyre008: hehthat JUST for workstationjust for knife
[2012-10-31 14:17:01 -0400] gyre008: and make sure you edit ssh.rb in KNIFE librarynot the chef one...
[2012-10-31 14:17:09 -0400] gyre008: I think chef has its own ssh file....
[2012-10-31 14:17:18 -0400] gyre008: this is just a modification for knife-ssh
[2012-10-31 14:17:56 -0400] gyre008: it has nothing to do with chef-clientswhen you do knife ssh you connect to the hostnot to chef-client :)
[2012-10-31 14:21:20 -0400] jtimberman: _axx: Chef is a program that runs on the system to be configured.
[2012-10-31 14:21:33 -0400] jtimberman: _axx: so you have to install Chef on the systems you want to use it on.
[2012-10-31 14:22:20 -0400] jtimberman: gyre008: you can totally use an array of actions on a resource. then when chef configures it, it will take each action in the order specified.
[2012-10-31 14:22:36 -0400] gyre008: jtimberman, awesome...thanks
[2012-10-31 14:22:52 -0400] jtimberman: gyre008: we do that often for service resources, action [:enable, :start]
[2012-10-31 14:23:15 -0400] gyre008: yeah I knowbut I wasn't sure if it works the same in LWRPs
[2012-10-31 14:23:24 -0400] jtimberman: yeah its totally the same
[2012-10-31 14:23:29 -0400] gyre008: cool...awesome
[2012-10-31 14:23:36 -0400] yfeldblum: jtimberman, i'm sure there's a way! (my answer above)
[2012-10-31 14:23:38 -0400] jtimberman: the lwrp is just a nice way to write resources/providers without all the ruby scaffolding.
[2012-10-31 14:23:55 -0400] jtimberman: yfeldblum: I don't read all the words!
[2012-10-31 14:24:00 -0400] jtimberman: <3
[2012-10-31 14:24:11 -0400] jtimberman: see you cats later
[2012-10-31 14:24:14 -0400] geekbri: meow
[2012-10-31 14:24:17 -0400] geekbri: i mean, goodbye
[2012-10-31 14:25:08 -0400] gyre008: well its a nice way but notifications to LWRP can get really tricky.so its not exactly the same :)
[2012-10-31 14:25:45 -0400] kryptek: jtimberman,  I'm a CFL1 :)
[2012-10-31 14:29:10 -0400] yfeldblum: gyre008, if you write the provider right, notifications are really easy
[2012-10-31 14:29:51 -0400] gyre008: yfeldblum, sometimes the providers can be setting up other resourcesvery often you can't avoid that...
[2012-10-31 14:30:21 -0400] geekbri: QCue yfeldblum letting you know that there is a way to propagate those notifications!
[2012-10-31 14:30:24 -0400] geekbri: minus the Q
[2012-10-31 14:32:26 -0400] yfeldblum: gyre008, https://gist.github.com/d85be145f3ff824ccc07 <--- the pattern for using sub-resources in provider actions
[2012-10-31 14:35:12 -0400] gyre008: interestingneed to read up on thatthanks yfeldblum , at the moment I'm not taking subresources into account as suchI just simply assume that they get called as part of provider's action ...
[2012-10-31 14:35:25 -0400] gyre008: which looks to be retarded in the light of your post :)
[2012-10-31 14:35:43 -0400] yfeldblum: gyre008, what happens is that the
[2012-10-31 14:35:44 -0400] gyre008: good to learn how things should be donewill give it a read later today
[2012-10-31 14:36:23 -0400] yfeldblum: gyre008, what happens is that they're not sub-resources; the action just adds these resources into the resources-collection to be converged later, after the action is done executing
[2012-10-31 14:36:43 -0400] _axx: yfeldblum: so that i only mount that opt/chef, run the config file also from a mounted share, run and remove them after it's finished? :)
[2012-10-31 14:36:43 -0400] yfeldblum: gyre008, but that example is how you get true sub-resources with a provider action
[2012-10-31 14:37:01 -0400] gyre008: yep exactlythats why I was mentioning that thing with notificationsbecause obviously I was doing it wrong...
[2012-10-31 14:38:40 -0400] yfeldblum: _axx, right, you want to mount /opt/chef, /etc/chef, /var/chef, and maybe some others but i forget
[2012-10-31 14:38:58 -0400] yfeldblum: geekbri, ^_^
[2012-10-31 14:39:40 -0400] geekbri: :-O
[2012-10-31 14:41:22 -0400] _axx: yfeldblum: hm, hard to automate that. :/
[2012-10-31 14:42:28 -0400] yfeldblum: _axx, heh well you asked how to run chef on a server without having a trace of it on the server :P
[2012-10-31 14:47:47 -0400] EremJay: Hey there
[2012-10-31 14:49:20 -0400] geekbri: just run chef then rm -rf /
[2012-10-31 14:49:29 -0400] geekbri: There will be no trace that chef was run :)
[2012-10-31 14:49:34 -0400] geekbri: also, don't do that.
[2012-10-31 14:52:00 -0400] gyre008: this stuff you sent in that gist is interestingfigured it our yourself or is it documented somewhere ?
[2012-10-31 14:52:04 -0400] gyre008: yfeldblum,
[2012-10-31 14:52:36 -0400] geekbri: its documented in the chef mailing list I think ;)
[2012-10-31 14:53:53 -0400] gyre008: geekbri, :) thats the best place for everyone to find it
[2012-10-31 14:53:59 -0400] geekbri: Hehe.
[2012-10-31 14:54:16 -0400] geekbri: Considering I couldn't even find it myself via a google search and I know what im looking for.
[2012-10-31 14:54:39 -0400] gyre008: yeah
[2012-10-31 14:54:58 -0400] yfeldblum: gyre008, yep, i did
[2012-10-31 14:55:38 -0400] gyre008: smart yfeldblum :)
[2012-10-31 14:57:35 -0400] eugenmayer: is there a way to find out if a package is installed?
[2012-10-31 14:57:46 -0400] eugenmayer: the package ressource seems not to provide this
[2012-10-31 14:58:03 -0400] gyre008: eugenmayer, nope
[2012-10-31 14:58:18 -0400] gyre008: what do you need it for ?
[2012-10-31 14:58:31 -0400] eugenmayer: well, for some reason, i get
[2012-10-31 14:58:39 -0400] eugenmayer: php5-apc has no candidate in the apt-cach
[2012-10-31 14:58:59 -0400] eugenmayer: when i try to remove. For now, it only removed, if the package was there..but this kind of fails here. Odd.
[2012-10-31 14:59:59 -0400] gyre008: eugenmayer, try tu run apt-get update
[2012-10-31 15:00:04 -0400] gyre008: and then install
[2012-10-31 15:00:13 -0400] eugenmayer: did so, tried to clear the cache..but still fails
[2012-10-31 15:06:36 -0400] dpetzel: does anyone know how/if I can leverage "other" resource types when doing a miinitest spec test? IE what I'm trying to do is something like chef_gem("blah").must_be_installed
[2012-10-31 15:10:42 -0400] kryptek: I tagged a node within chef, how can I query to find that node?
[2012-10-31 15:10:50 -0400] kryptek: (using knife)
[2012-10-31 15:13:05 -0400] vluther: if i have a databag for a user, and i want to modify that user, what's the best way to do it? i modified the data bag file but now when i run chef-client it tries to do a usermod, but the user is logged in so it fails
[2012-10-31 15:13:16 -0400] vluther: i've disabled root login etc already
[2012-10-31 15:17:44 -0400] kraM: Hey, does anyone know if there's a possibility to tell librarian-chef to use alteranative ssh public keys with net-ssh?
[2012-10-31 15:17:52 -0400] behemphi: @gyre008, I just slid in your patch, and it addressed my issue.  I am going to include this in the bug report and get it submitted.  Thanks!
[2012-10-31 15:18:43 -0400] EremJay: Hi. I've got a problem with the nginx cookbook.
[2012-10-31 15:18:51 -0400] EremJay: The same problem at : http://community.opscode.com/chat/chef/2012-09-08
[2012-10-31 15:19:05 -0400] EremJay: I thought it was fixed in the cookbook 1.0.2.
[2012-10-31 15:21:16 -0400] yfeldblum: kraM, librarian-chef doesn't use net-ssh
[2012-10-31 15:22:02 -0400] behemphi: @gyre008, and any interested.  Here is the bug report submitted for Rackspace Cloud servers not responding properly to knife-ssh version 10.16.2
[2012-10-31 15:22:03 -0400] behemphi: http://tickets.opscode.com/browse/CHEF-3573
[2012-10-31 15:22:41 -0400] killfill: gyre008, gyre007, hi
[2012-10-31 15:23:15 -0400] kraM: Hm. Okay, ya, it wraps git which in turn does things with ssh here, so it seams, I need to manage that in ~/.ssh/config, right?
[2012-10-31 15:24:42 -0400] gyre008: killfill, hi
[2012-10-31 15:25:25 -0400] yfeldblum: kraM, i assume that should work
[2012-10-31 15:25:38 -0400] gyre008: behemphi that fix worked for you I take it
[2012-10-31 15:25:57 -0400] killfill: gyre008, the problem from yesterday... i got it.. i had to action :force_deploy, becouse as the repo didnt had a new version.. :P
[2012-10-31 15:26:15 -0400] behemphi: Yes, and I reported that in the bug
[2012-10-31 15:26:34 -0400] behemphi: @kryptek: `knife search node "tags:workstation"`
[2012-10-31 15:26:37 -0400] gyre008: yeahdeploy resource can be trickyyou need to force_deploy first and then its okI think it's even mentioned on wiki...
[2012-10-31 15:26:40 -0400] kraM: Yes, it works. Thanks for the hint, yfeldblum; you helped me thinking twice :)
[2012-10-31 15:26:42 -0400] gyre008: behemphi, cool
[2012-10-31 15:26:57 -0400] yfeldblum: kraM, cool
[2012-10-31 15:27:13 -0400] behemphi: AFter creating the tag it might take a minute for it to make it to the search index
[2012-10-31 15:27:34 -0400] behemphi: @gyre008, thx for the code
[2012-10-31 15:27:57 -0400] gyre008: nah..not at alli fixed it because i got really annoyed by it :)
[2012-10-31 15:28:05 -0400] gyre008: glad it helps people...
[2012-10-31 15:28:19 -0400] behemphi: omnibus is the shezizle
[2012-10-31 15:28:45 -0400] behemphi: I am just glad some smart folks are suffering the RS cloud with me :-)
[2012-10-31 15:29:19 -0400] gyre008: omnibus is kind of awesome but brings its own issuesfamous problem is inability to install pg gem when you need to use it in your Chef code...
[2012-10-31 15:29:59 -0400] killfill: gyre008, when you use the application cookbook.. does it download all the dependencies too? rails cookbook, etc, etc
[2012-10-31 15:30:08 -0400] behemphi: Y, I am using MySQL so safe there,.  What I really like is the speed of the install.
[2012-10-31 15:30:08 -0400] killfill: gyre008, thought that was obsolete.. :P
[2012-10-31 15:30:15 -0400] killfill: mysql, etc
[2012-10-31 15:30:17 -0400] gyre008: :)
[2012-10-31 15:30:35 -0400] gyre008: dunno about mysql..but pg is just not possible to use...
[2012-10-31 15:30:47 -0400] masterkorp: why ?
[2012-10-31 15:30:58 -0400] masterkorp: is the pg cookbook broken ?
[2012-10-31 15:31:03 -0400] masterkorp: I plan to use it :(
[2012-10-31 15:32:29 -0400] EremJay: Have you guys ever deployed a Rails app with chef ?
[2012-10-31 15:32:35 -0400] EremJay: I'm kinda stuck here :/
[2012-10-31 15:32:42 -0400] EremJay: \:
[2012-10-31 15:33:03 -0400] yfeldblum: EremJay, can you be more specific?
[2012-10-31 15:33:07 -0400] behemphi: @kryptek, you good?
[2012-10-31 15:33:28 -0400] EremJay: yfeldblum: I want to use the nginx cookbook, but it's like it's broken.
[2012-10-31 15:33:30 -0400] gyre008: masterkorp, yup
[2012-10-31 15:33:45 -0400] EremJay: yfeldblum: because of its dependency: ohai
[2012-10-31 15:33:48 -0400] gyre008: it depends if you use omnibus chef install
[2012-10-31 15:33:55 -0400] masterkorp: gyre008: as in does not work at all, what are the problems ?
[2012-10-31 15:33:58 -0400] gyre008: if you install from gems/packages you are NOT affectd
[2012-10-31 15:33:59 -0400] kryptek: Fbehemp
[2012-10-31 15:34:14 -0400] yfeldblum: EremJay, a little more specific?
[2012-10-31 15:34:16 -0400] kryptek: Using find :P disregard lol
[2012-10-31 15:34:23 -0400] yfeldblum: EremJay, what's the actual problem you're running into?
[2012-10-31 15:34:41 -0400] EremJay: A ruby error: "undefined method `[]' for nil:NilClass"
[2012-10-31 15:34:51 -0400] EremJay: And the offending line : template "#{node['ohai']['plugin_path']}/nginx.rb" do
[2012-10-31 15:35:02 -0400] EremJay: in nginx/recipes/ohai_plugin.rb
[2012-10-31 15:35:11 -0400] gyre008: masterkorp, there is a blocker raised around that issue http://tickets.opscode.com/browse/COOK-1534
[2012-10-31 15:35:13 -0400] EremJay: It's like the variable are not set yet.
[2012-10-31 15:35:20 -0400] EremJay: * variables
[2012-10-31 15:36:02 -0400] masterkorp: gyre008: i see, i want to use it with icinga-web in my cookbook
[2012-10-31 15:36:18 -0400] kryptek: bhemp:  No dice
[2012-10-31 15:36:25 -0400] gyre008: if you aren't on omnibus you aren't affected...
[2012-10-31 15:37:00 -0400] masterkorp: i see, but the node might be
[2012-10-31 15:37:03 -0400] kryptek: behemphi,  Weird, seems to work now
[2012-10-31 15:37:12 -0400] behemphi: @kryptek
[2012-10-31 15:37:25 -0400] behemphi: sorry, premature enter-u-lation, that is expected
[2012-10-31 15:37:39 -0400] behemphi: when you save the node it has to get indexed on the chef server
[2012-10-31 15:37:51 -0400] kryptek: ahh.. that explains it
[2012-10-31 15:37:52 -0400] behemphi: that can take a "some amount of time"
[2012-10-31 15:38:02 -0400] kryptek: I added the tag and did the search but it didn't show up until I did a knife node show on it first
[2012-10-31 15:38:39 -0400] yfeldblum: EremJay, the nginx cookbook depends on the ohai cookbook
[2012-10-31 15:38:58 -0400] yfeldblum: EremJay, are you running chef-client or chef-solo?
[2012-10-31 15:39:00 -0400] behemphi: I am not familiar with the internals of chef server at any detail, but I suspect it was more a matter of the queue had "n" indexing jobs in it and yours was handled in "x" seconds after being submitted
[2012-10-31 15:39:13 -0400] EremJay: yfeldblum: I'm running chef-solo.
[2012-10-31 15:39:21 -0400] behemphi: I will leave it to an opscode heavy to expound :-)
[2012-10-31 15:39:49 -0400] yfeldblum: EremJay, do you have the ohai cookbook?
[2012-10-31 15:39:52 -0400] EremJay: yfeldblum: The ohai recipe is included in nginx, isn't it?
[2012-10-31 15:39:57 -0400] EremJay: yfeldblum: Nope. I don't.
[2012-10-31 15:40:33 -0400] EremJay: yfeldblum: I thought chef-solo would resolve dependencies by its own and download them automatically
[2012-10-31 15:40:36 -0400] yfeldblum: EremJay, make sure you also have the ohai cookbook in your chef repo
[2012-10-31 15:40:45 -0400] yfeldblum: EremJay, chef-solo does not download cookbooks at all, ever
[2012-10-31 15:40:59 -0400] yfeldblum: EremJay, chef-solo runs exactly what you give it
[2012-10-31 15:42:07 -0400] EremJay: yfeldblum: And I guess I should write include_recipe "ohai" before nginx?
[2012-10-31 15:42:15 -0400] yfeldblum: EremJay, no
[2012-10-31 15:42:37 -0400] yfeldblum: EremJay, you need the cookbook so that chef-solo can load the cookbook's attributes files
[2012-10-31 15:43:21 -0400] EremJay: Oh okay.
[2012-10-31 15:44:50 -0400] EremJay: yfeldblum: Yep. It's working now.
[2012-10-31 15:44:55 -0400] EremJay: yfeldblum: Thanks!
[2012-10-31 15:45:14 -0400] yfeldblum: EremJay, no problem
[2012-10-31 15:46:47 -0400] yfeldblum: EremJay, chef-solo loads the attributes files (and libraries, definitions, resources, and providers) for every cookbook you have in the chef-repo (or wherever you configured chef-solo to look in your /etc/chef/solo.rb config file), even if those cookbooks aren't in the run-list and even if those cookbooks aren't dependencies of anything in the run-list
[2012-10-31 15:47:09 -0400] yfeldblum: EremJay, chef-solo actually doesn't even look at the dependencies, really ...
[2012-10-31 15:47:38 -0400] yfeldblum: EremJay, but it will still only run the recipes that are given in the run-list; it will not just run all the recipes in all the cookbooks
[2012-10-31 15:48:19 -0400] EremJay: yfeldblum: Okay. I was wondering where it would get the attributes from anyways. That makes sense.
[2012-10-31 15:54:07 -0400] drewww: are there built-in resources for moving files around or do I just use execute?
[2012-10-31 16:03:20 -0400] _dumfries: drewww you should have those files included into your recipe, I would avoid moving files around with execute.
[2012-10-31 16:05:47 -0400] eugenmayer: hello. For backup reasons of chef what kind of DB backend is used?
[2012-10-31 16:07:08 -0400] itwasntandy: couchdb
[2012-10-31 16:07:17 -0400] eugenmayer: ah, its coudb. Anybody has a hint were its loccated?
[2012-10-31 16:07:53 -0400] itwasntandy: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2012-10-31 16:07:57 -0400] eugenmayer: sorry for even asking
[2012-10-31 16:07:59 -0400] itwasntandy: should hopefully help you
[2012-10-31 16:07:59 -0400] eugenmayer: its all in the docs
[2012-10-31 16:08:00 -0400] eugenmayer: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2012-10-31 16:08:03 -0400] eugenmayer: heh
[2012-10-31 16:08:10 -0400] eugenmayer: I wasted your time
[2012-10-31 16:20:51 -0400] killfill: if i use "notifies :restart, "service[myservice]""...  how do i build myservice?.. i need to send an http request to some service that restarts things
[2012-10-31 16:23:47 -0400] jtimberman: killfill: service "myservice"
[2012-10-31 16:24:48 -0400] jtimberman: or https://gist.github.com/51cfb899f849c3d78335
[2012-10-31 16:25:22 -0400] xdissent: yessssss. went to send a pull request for the postfix cookbook and one already exists and was code reviewed yesterday
[2012-10-31 16:25:30 -0400] killfill: hm.. i think i understood it backwards.. :P
[2012-10-31 16:25:55 -0400] killfill: jtimberman: i think i need something like notifies :restart, "my_custom_restarter[app_name]"
[2012-10-31 16:26:11 -0400] killfill: so i can write the logic of my_custom_restarter myself
[2012-10-31 16:26:24 -0400] killfill: trying to understand how to do this
[2012-10-31 16:28:28 -0400] jtimberman: xdissent: :)
[2012-10-31 16:29:47 -0400] xdissent: ah damn i think it's being held up by a readme update
[2012-10-31 16:37:58 -0400] till__: is there a trick to get a user's homedirectory during a chef run?
[2012-10-31 16:38:13 -0400] till__: e.g. without hardcoding where root = /root etc.
[2012-10-31 16:39:07 -0400] xdissent: till__: i think you can do File.expand_path('~') in a block resource
[2012-10-31 16:39:52 -0400] till__: xdissent: i need something like, home = get_home('user')
[2012-10-31 16:39:53 -0400] xdissent: er well i guess it depends how you want to use it, but make sure it's running in the correct phase if you're creating the user in a recipe too
[2012-10-31 16:40:15 -0400] wcmaier: xdissent: that'd get the current user's home directory
[2012-10-31 16:40:30 -0400] xdissent: wcmaier: oops, meant "~#{user}"
[2012-10-31 16:40:32 -0400] wcmaier: till__: you want http://www.ruby-doc.org/stdlib-1.9.3/libdoc/etc/rdoc/Etc.html#method-c-getpwent
[2012-10-31 16:41:09 -0400] xdissent: till__: if the user already exists, you can just use ruby straight in the cookbook. if the user is created by chef AFTER the compilation phase, you'll have to get tricky about when you retrieve the home dir
[2012-10-31 16:41:12 -0400] xdissent: since it may not exist.
[2012-10-31 16:41:24 -0400] xdissent: (the user may not exist i mean)
[2012-10-31 16:42:03 -0400] till__: ah
[2012-10-31 16:42:04 -0400] till__: neat
[2012-10-31 16:52:31 -0400] till__: xdissent: i am testing how far i get with something like `echo ~foo` right now
[2012-10-31 17:01:57 -0400] mobilemike: Hello, I'm looking for some help with installation using the Omnibus installer, as mentioned in http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-10-31 17:04:26 -0400] masterkorp: mobilemike: what is the problem ?
[2012-10-31 17:04:59 -0400] mobilemike: In the green section labeled: Get the error "Could not find RubyGem chef" instead?
[2012-10-31 17:05:12 -0400] mobilemike: Well, I am getting that error, and I do use RVM.
[2012-10-31 17:05:52 -0400] mobilemike: Can you point me in the right direction for how to _fix_ the problem? It just says: "... you most likely have an issue with how your RVM is setup"
[2012-10-31 17:06:46 -0400] mobilemike: Okay, well, maybe someone has some insight into that?
[2012-10-31 17:11:44 -0400] specialsauce: Is 10.12 "FATAL: EOFError: end of file reached" a known bug? I only hit it with a single cookbook
[2012-10-31 17:12:15 -0400] evxd: mobilemike: did you try `rvm use system` before running chef-client?
[2012-10-31 17:12:37 -0400] mobilemike: I did, and that does work around the problem.
[2012-10-31 17:13:21 -0400] mobilemike: Is that the recommended answer though? chef is incompatible with running an RVMed ruby?
[2012-10-31 17:13:49 -0400] mobilemike: That note on the page implied that it was an RVM configuration problem, one that I could potentially fix.
[2012-10-31 17:14:11 -0400] jtimberman: mobilemike: you can use rvm
[2012-10-31 17:14:32 -0400] jtimberman: mobilemike: i personally don't recommend it because rvm adds a layer of complexity that is confusing to people who are not used to it
[2012-10-31 17:16:11 -0400] mobilemike: We're a rails shop, so I'm always inside one gemset or another. I suppose I could add an .rvmrc to my chef-repo that forces the use of the system gems.
[2012-10-31 17:21:54 -0400] flowersj: hello
[2012-10-31 17:22:00 -0400] maek: Does anyone know where the cookbooks are stored on the chef-server? Im moving my chef-server to a new box and would like to restore my cookbooks vs re upload (bad practice on my part has namespaced cookbooks) I think they are in /var/cache/chef/checksums but im wondering if there is anything else I need?
[2012-10-31 17:22:15 -0400] flowersj: I have been working on installing Chef server on Ubuntu 12.4
[2012-10-31 17:22:26 -0400] flowersj: the service does not start
[2012-10-31 17:22:37 -0400] flowersj: it fails silently on this line:
[2012-10-31 17:23:09 -0400] flowersj: test -x $DAEMON || exit 0
[2012-10-31 17:23:32 -0400] maek: whats $DAEMON?
[2012-10-31 17:23:38 -0400] maek: flowersj: ^?
[2012-10-31 17:23:41 -0400] flowersj: DAEMON=/usr/sbin/chef-server
[2012-10-31 17:23:48 -0400] maek: which -a chef-server
[2012-10-31 17:23:53 -0400] maek: sometimes the init scripts get confused
[2012-10-31 17:23:57 -0400] maek: about the chef-server location
[2012-10-31 17:23:57 -0400] flowersj: and that is a symbolic link
[2012-10-31 17:24:13 -0400] maek: can you run chef-server from command line?
[2012-10-31 17:24:24 -0400] flowersj: it works if I edit it to:
[2012-10-31 17:24:25 -0400] flowersj: DAEMON=/usr/local/bin/chef-server
[2012-10-31 17:24:29 -0400] maek: thats why
[2012-10-31 17:24:34 -0400] maek: confused about location
[2012-10-31 17:24:54 -0400] flowersj: is that bug or did I mess up in the install somewhere
[2012-10-31 17:24:55 -0400] maek: I dont think the installer cookbook has updated the init templates
[2012-10-31 17:25:06 -0400] maek: not sure a 'bug' but just an omission
[2012-10-31 17:25:13 -0400] maek: same thing happens on centos
[2012-10-31 17:25:17 -0400] maek: gems install to /usr/local/bin
[2012-10-31 17:25:25 -0400] maek: init template thinks /usr/bin
[2012-10-31 17:25:44 -0400] flowersj: so I need to edit webui and solr too?
[2012-10-31 17:25:51 -0400] maek: yeah
[2012-10-31 17:25:54 -0400] maek: expander also
[2012-10-31 17:26:01 -0400] maek: or make symlinks in /usr/bin
[2012-10-31 17:26:03 -0400] maek: to /usr/local
[2012-10-31 17:26:04 -0400] maek: either or
[2012-10-31 17:26:06 -0400] till__: xdissent: I tried this in vagrant so far with fresh `vagrant up`: home = `echo ~#{user}`
[2012-10-31 17:26:10 -0400] till__: works beautifully
[2012-10-31 17:26:19 -0400] xdissent: till__: awesome
[2012-10-31 17:26:33 -0400] till__: yep!
[2012-10-31 17:26:51 -0400] flowersj: thanks maek
[2012-10-31 17:26:53 -0400] xdissent: flowersj: check the chef-client cookbook for the latest init script IIRC
[2012-10-31 17:27:12 -0400] xdissent: there's a specific fix for 12.04 I think
[2012-10-31 17:27:27 -0400] maek: why chef-client? it fixes the chef-server stuff?
[2012-10-31 17:27:56 -0400] xdissent: that's what I meant!
[2012-10-31 17:28:22 -0400] xdissent: didn't you correct me earlier? sheesh!
[2012-10-31 17:29:00 -0400] flowersj: hmm I am using the latest?
[2012-10-31 17:29:15 -0400] flowersj: I started yesterday anyway
[2012-10-31 17:29:22 -0400] flowersj: so latest from yesterday
[2012-10-31 17:29:24 -0400] maek: xdissent:  me?
[2012-10-31 17:29:50 -0400] xdissent: maek: yeah. maybe wasn't you. i'm just making a lot of mistakes today lol
[2012-10-31 17:30:02 -0400] maek: if so i hope it was in a more friendly manner then that one :)
[2012-10-31 17:33:43 -0400] xdissent: lol it was
[2012-10-31 17:37:00 -0400] maek: jtimberman: can you tell me what the sandboxes dir is for? only for cookbook upload or does it have to do with later retrieval. several times that dir hits the inode cap for 32k files/dirs and I just rm -rf sandboxes ; mkdir sandboxes and everything seems to be fine. this bad?
[2012-10-31 17:39:04 -0400] yfeldblum: mobilemike, you would typically run chef outside of "being in rvm"
[2012-10-31 17:39:35 -0400] mobilemike: I'm just not used to that. My terminal is, by default, always in rvm
[2012-10-31 17:39:50 -0400] yfeldblum: mobilemike, e.g. as root, not after logging in to a user with a default rvm, but as logging into root
[2012-10-31 17:40:04 -0400] mobilemike: The .rvmrc trick seems to have worked well.
[2012-10-31 17:40:38 -0400] mobilemike: Oh, this i all workstation stuff I'm dealing with. So, chef-client and knife
[2012-10-31 17:41:21 -0400] mobilemike: sudo -i knife (which is what the wiki suggests) both seems wrong, and doesn't work
[2012-10-31 17:42:04 -0400] c_t: try rvmsudo?
[2012-10-31 17:42:32 -0400] mobilemike: Eh, I don't think these commands are even appropriate for sudo, unless I'm missing something.
[2012-10-31 17:42:54 -0400] c_t: not for knife, but for chef-client if you're having trouble with that
[2012-10-31 17:43:00 -0400] mobilemike: rvm use system does the trick
[2012-10-31 17:43:45 -0400] mobilemike: Yea, chef-client does, my mistake. But, that's not an RVM issue.
[2012-10-31 17:46:52 -0400] heathsnow: Okay, anyone see anything wrong with this?  http://pastebin.com/41nUTL26
[2012-10-31 17:47:10 -0400] heathsnow: It's not creating the /var/cache/handlers directory like I expect it to
[2012-10-31 17:47:33 -0400] heathsnow: I have files/default/handlers/ in my cookbook
[2012-10-31 17:59:08 -0400] mobilemike: Is it a common practice to check my chef-repo into a version control system for others on my team to use as well?
[2012-10-31 17:59:40 -0400] leifmadsen: mobilemike: yes
[2012-10-31 17:59:58 -0400] leifmadsen: we have a collaborative chef-repo that we deploy via vagrant from
[2012-10-31 18:00:05 -0400] leifmadsen: for development purposes
[2012-10-31 18:01:00 -0400] mobilemike: Okay. The fast-start guide had me make a .chef dir and put my keys in there. It didn't mention it, but I assume I should gitignore that dir, so as to not share the private keys?
[2012-10-31 18:01:25 -0400] leifmadsen: aye
[2012-10-31 18:01:57 -0400] leifmadsen: I have things in my .chef dir in the chef-repo that I do share with everyone, such as the distro files
[2012-10-31 18:02:03 -0400] leifmadsen: e.g. centos6-gems
[2012-10-31 18:03:55 -0400] gyre008: yfeldblum, you here ?
[2012-10-31 18:04:55 -0400] yfeldblum: gyre008, i'm here
[2012-10-31 18:05:15 -0400] gyre008: cool..I have a q about that awesome sub resource gist you posted here for me to read...
[2012-10-31 18:05:31 -0400] gyre008: shouldn't cached_new_resource = new_resource be cached_new_resource = @new_resource ?
[2012-10-31 18:10:59 -0400] gyre008: also yfeldblum I have to do that for EVERY action which is setting up some resources within it ? uhh..that code will be massive ;)..wonder if theres any way to make it less duplicateif I have like 4 actions then it would make it massive...
[2012-10-31 18:11:51 -0400] yfeldblum: gyre008, look at the second file in the gist
[2012-10-31 18:13:06 -0400] ekristen_: running bundle install from the command line for my ubuntu user or my root user works, but when executing it in a chef recipe it fails, says it can't find bundle,
[2012-10-31 18:13:27 -0400] gyre008: ah I see..arrghnice oneI basically need to put that recipe_eval method on top of provider's file and set up sub resources by passing them in a block to recipe_evalinteresting
[2012-10-31 18:14:49 -0400] gyre008: so basically if I do something like:action CODEsubresourceCODEsubresource... I will need to call that recipe_eval with every sub_resource I'm setting up right ?
[2012-10-31 18:16:54 -0400] gyre008: if I got that right yfeldblum this should work fine https://gist.github.com/3988809
[2012-10-31 18:17:54 -0400] yfeldblum: gyre008, that's the idea
[2012-10-31 18:18:12 -0400] gyre008: coolio..will test and seeTHANKS A LOT man
[2012-10-31 18:25:50 -0400] geekbri: gyre008: I think you need a new spacebar !
[2012-10-31 18:26:08 -0400] gyre008: geekbri, hm ? :)
[2012-10-31 18:26:42 -0400] geekbri: I noticed sometimes spaces are missing in your typing :) I suspected maybe you have a faulty spacebar.  Also for that recipe_eval thing, I happened to use it, but instead of putting it in every provider, I threw it in a library file
[2012-10-31 18:26:50 -0400] drgonzo65: when will the source tab on the opscode ticket site be fixed?
[2012-10-31 18:27:01 -0400] drgonzo65: I keep getting: Repository Cookbooks on http://fisheye.opscode.com/ failed: Error in remote call to 'FishEye 0 (http://fisheye.opscode.com/)' (http://fisheye.opscode.com/) [AbstractRestCommand{path='api/rest/query', params={query=select revisions from dir / where comment matches 'COOK-1338' order by date group by changeset return csid, rep=Cookbooks}, methodType=POST}] : Received status code 404 (Not Found)
[2012-10-31 18:27:31 -0400] kryptek: Is there anyone I can force one of two attributes in a resource?  I want to require one if the other isn't specified and vice versa
[2012-10-31 18:28:00 -0400] geekbri: my_thing = node['some_attr'] || node['some_other_attr'] ?
[2012-10-31 18:28:04 -0400] gyre008: yfeldblum, I have doubts my gist will actually workbecause with every new block passed to recipe_eval, you will generate a new ResourceCollection so when you will have 2 resources passed in 2 different/separate blocks as oppose to just one as it's in your example, won't that remove the ones which are already in that collection ?
[2012-10-31 18:28:06 -0400] geekbri: the question mark isn't part of the code
[2012-10-31 18:28:17 -0400] kryptek: geekbri,  Yeah, I got what you're saying
[2012-10-31 18:28:30 -0400] geekbri: kryptek: the problem with that, is that it is strongly ordered
[2012-10-31 18:28:40 -0400] gyre008: geekbri, I have doubts this will work https://gist.github.com/3988809
[2012-10-31 18:28:47 -0400] geekbri: gyre008: I've used it and it worked fine for me!
[2012-10-31 18:28:53 -0400] kryptek: Nah, but what I had in mind is like.. in my resource file I have two diff attributes
[2012-10-31 18:29:00 -0400] gyre008: did you use it like this ? https://gist.github.com/3988809
[2012-10-31 18:29:08 -0400] geekbri: gyre008: why did you put them in separate blocks?
[2012-10-31 18:29:15 -0400] gyre008: or did you stick in all sub resources in ONE block
[2012-10-31 18:29:19 -0400] gyre008: I'm curious
[2012-10-31 18:29:21 -0400] geekbri: I have it all in one block
[2012-10-31 18:29:27 -0400] kryptek: Hmm.. I think I just answered my own question
[2012-10-31 18:29:36 -0400] gyre008: yeahthat's what I'm talking aboutwhen its in one block I'm sure it will work
[2012-10-31 18:29:45 -0400] geekbri: gyre008: if my memory serves me right it shouldnt matter, calling it twice like that should work
[2012-10-31 18:30:16 -0400] leifmadsen: afternoon all -- trying to use remote_directory to copy several files from my cookbooks files/default/ directory onto the node, the remote_directory triggers, but the files are not on the node. Here is how I'm using it:  https://gist.github.com/b7883145ddc1003e78a8
[2012-10-31 18:30:17 -0400] gyre008: geekbri, mm but wouldnt sub resource collection be reset with EVERY new block passed within action ?
[2012-10-31 18:30:20 -0400] yfeldblum: gyre008, the sub-resources are converged before the end of the block (not just before the end of the actio method)
[2012-10-31 18:30:55 -0400] yfeldblum: gyre008, so if you have two of those blocks, the sub-resources in the first block would be converged before the end of the first block, and the sub-resources in the second block would be converged before the end of the second block
[2012-10-31 18:31:10 -0400] geekbri: gyre008: but it doesn't matter, the recipe_eval method just checks to see if that particular sub collection of resources called updated by last action with a true, and if it does, it just passes that on to the current new_resource
[2012-10-31 18:31:25 -0400] gyre008: yfeldblum, ah I seee...
[2012-10-31 18:31:46 -0400] gyre008: geekbri, coolI think I'm now getting a good idea what that awesome code does...
[2012-10-31 18:32:44 -0400] geekbri: gyre008: all it does is init a new empty resource collection, then anything you run inside of that block is added to that resource collection.  It then iterates over the collection to see if any of those resources to see if any of them had updated_by_last_action called with a true.  If any of them have, then it sets the updated_by_last_action of new_resource to true
[2012-10-31 18:32:50 -0400] geekbri: does that make sense?
[2012-10-31 18:33:20 -0400] geekbri: gyre008: the "updated?" method of a resource just returns if updated_by_last_action(true) has been called on that resource
[2012-10-31 18:34:33 -0400] geekbri: so if you were to use that method twice within one provider, it will run the first time, and call new_resource.updated_by_last_action(true) if any of the resource inside the block return true from the "updated?" method.  Then the second time you use the method the same thing should happen
[2012-10-31 18:34:39 -0400] geekbri: which seems like correct behavior to me !
[2012-10-31 18:35:04 -0400] gyre008: geekbri, yup it doesactually this whole code makes my understanding of Chef even betterIm still learning loadsthis makes few things much clearer
[2012-10-31 18:35:08 -0400] geekbri: rad :)
[2012-10-31 18:36:05 -0400] geekbri: gyre008:  you can always iterate over the resource collection yourself if you'd like a nice view into what exactly is in it.
[2012-10-31 18:36:37 -0400] gyre008: yeah I knew thatI only do that when I'm debugging :)
[2012-10-31 18:36:49 -0400] gyre008: Chef debugging is pain though...
[2012-10-31 18:37:00 -0400] yfeldblum: gyre008, it's actually based on https://github.com/opscode/chef/blob/master/lib/chef/provider.rb#L160-178 but improved to be actually useful ^-^
[2012-10-31 18:38:05 -0400] gyre008: cheers
[2012-10-31 18:38:15 -0400] leifmadsen: oh well that is interesting
[2012-10-31 18:38:48 -0400] yfeldblum: gyre008, and in fact in the second file in my gist, i chose the method name specifically to override the partially-implemented method from Chef::Provider :P
[2012-10-31 18:39:05 -0400] leifmadsen: a remote_directory node that doesn't have an only_if specified is being skipped because the next remote_directory resource under it does have an only_if that causes it to be skipped
[2012-10-31 18:39:05 -0400] gyre008: :)
[2012-10-31 18:39:17 -0400] leifmadsen: either I'm using this wrong, or I've found a bug :\
[2012-10-31 18:42:54 -0400] flowersj: hello again
[2012-10-31 18:43:10 -0400] flowersj: I have gotten Chef Server to start manually
[2012-10-31 18:43:18 -0400] flowersj: but it still does not start on boot
[2012-10-31 18:43:23 -0400] behemphi: Apologies for the Ruby question but Google and Stack Overflow have failed me (or I them :-)   I want to uninstall the chef gem on many machines at once like 'knife ssh "*:*" 'sudo gem uninstall chef -a', however this is interactive.  I want to do something like assume-yes for apt-get.
[2012-10-31 18:43:26 -0400] flowersj: the boo.log shows this:
[2012-10-31 18:43:27 -0400] flowersj: https://gist.github.com/3989004
[2012-10-31 18:43:50 -0400] behemphi: wow  er  the kissy face was suppose to be star colon star
[2012-10-31 18:44:02 -0400] behemphi: I do like everyone  but not _that_ much
[2012-10-31 18:48:04 -0400] leifmadsen: aha, I get it now
[2012-10-31 18:48:22 -0400] leifmadsen: can't add an only_if to any of the remote_directory resource if they are all named the same
[2012-10-31 18:49:05 -0400] yfeldblum: leifmadsen, you can't have two resource declarations of the same type and name
[2012-10-31 18:49:17 -0400] leifmadsen: yfeldblum: right which I just figured out
[2012-10-31 18:49:25 -0400] leifmadsen: need to change resource name and use path
[2012-10-31 18:49:27 -0400] leifmadsen: I believe
[2012-10-31 18:49:48 -0400] yfeldblum: leifmadsen, that's right ... but why do you hae two remote_directory resources for the same filesystem path?
[2012-10-31 18:50:09 -0400] leifmadsen: yfeldblum: they are separate directories for different resource deployments
[2012-10-31 18:50:16 -0400] leifmadsen: but the config path is the same
[2012-10-31 18:50:26 -0400] leifmadsen: I'm going to fix the resource dec naming
[2012-10-31 18:50:52 -0400] Majost: how would I go about searching all my roles to determine which ones are using a specific cookbook/recipe?
[2012-10-31 19:02:35 -0400] till__: I am running a script in a deploy hook (before_symlink)
[2012-10-31 19:02:47 -0400] till__: the script itself relies on a file in the current user's home directory
[2012-10-31 19:02:52 -0400] till__: but is unable to find it
[2012-10-31 19:02:59 -0400] till__: when i execute it myself as that user, it works
[2012-10-31 19:03:37 -0400] till__: the user is "root" - but i am not sure how the env is setup, or what is missing within a deploy hook
[2012-10-31 19:04:20 -0400] natacado: anyone on hosted chef experiencing slow index updates right now?
[2012-10-31 19:09:32 -0400] till__: looks like the user is root, but the environment is from deploy.
[2012-10-31 19:09:35 -0400] till__: go figure
[2012-10-31 19:13:19 -0400] dopacki: hi - I'm trying to all the chef components onto a specific device (/mnt). Everything went fine with couchdb and rabbitmq. Chef-expander and chef-solr start. However, when I try to start chef-server, I just get "fail". I can't seem to find any more verbose info than that. Any suggestions on how I can get more detailed debugging info?
[2012-10-31 19:13:35 -0400] dopacki: trying to *relocate* all the chef components..
[2012-10-31 19:14:22 -0400] dopacki: I tried setting log_level to :debug in server.rb, but no love
[2012-10-31 19:17:46 -0400] cjs226: how could i return the node with role X that's been up the longest?
[2012-10-31 19:18:00 -0400] flowersj: should I be able to start the chef-server with this command:
[2012-10-31 19:18:22 -0400] flowersj: "/usr/sbin/service chef-server start"
[2012-10-31 19:18:42 -0400] flowersj: or does it require sudo?
[2012-10-31 19:19:14 -0400] flowersj: it fails without sudo
[2012-10-31 19:19:34 -0400] flowersj: I am wondering if this is why it fails to start on boot...
[2012-10-31 19:19:49 -0400] masterkorp: You should really start it with root
[2012-10-31 19:20:07 -0400] flowersj: so the init.d script is run as root?
[2012-10-31 19:20:31 -0400] flowersj: noob to linux...
[2012-10-31 19:20:36 -0400] masterkorp: its started as root, but it changes to the chef user
[2012-10-31 19:20:43 -0400] flowersj: gotcha
[2012-10-31 19:21:05 -0400] masterkorp: do this
[2012-10-31 19:21:07 -0400] flowersj: having a hard time figuring out why the server fails on boot
[2012-10-31 19:21:25 -0400] masterkorp: ps aux | grep '[c]hef-server'
[2012-10-31 19:22:01 -0400] flowersj: just shows the webui server
[2012-10-31 19:22:14 -0400] masterkorp: kill that one
[2012-10-31 19:22:29 -0400] masterkorp: how did you installed chef-server ?
[2012-10-31 19:22:57 -0400] flowersj: bootstrap with chef-solo
[2012-10-31 19:23:30 -0400] masterkorp: I recomend the using the opscode repo
[2012-10-31 19:23:47 -0400] masterkorp: everything is sorted out for you
[2012-10-31 20:01:24 -0400] pizzahead: so I followed the chef-server manual instructions and it seems like I have everything working other than chef-server. when I run chef-server -N -e production it just kind of seems like it hangs and doesn't start listening on 4000.
[2012-10-31 20:01:48 -0400] pizzahead: I've tried running in verbose but I still only see this last: Loading init file from ./config/init.rb
[2012-10-31 20:02:38 -0400] pizzahead: I've tried looking up issues other people have had but it always seems like they are getting errors after this point so I'm kind of hitting a dead end troubleshooting
[2012-10-31 20:06:16 -0400] kendrick_: so are these code review google hangouts happening?
[2012-10-31 20:07:19 -0400] btm: kendrick_: yeah I added your email to the invite.
[2012-10-31 20:07:36 -0400] btm: kendrick_: I'll pm the link to you
[2012-10-31 20:08:23 -0400] ssd7: dew
[2012-10-31 20:08:25 -0400] ssd7: grrr
[2012-10-31 20:10:16 -0400] juliancdunn: btm: can you send me the link too
[2012-10-31 20:11:04 -0400] geekbri: i love code reviews!
[2012-10-31 20:22:00 -0400] cjs226: how could i return the node with role X that's been up the longest?
[2012-10-31 20:23:25 -0400] mattray: cjs226: knife ssh 'name:[* TO *]' 'uptime'
[2012-10-31 20:23:54 -0400] mattray: cjs226: knife ssh "role:X" 'uptime'
[2012-10-31 20:24:41 -0400] cjs226: mattray: thx.  I'm actually wanting to get the data from within a recipe - only run this if system is role X that's been up the longest
[2012-10-31 20:27:38 -0400] Majost: Is there any reason why the maven cookbook wouldn't see the url value I set for my java download?
[2012-10-31 20:28:00 -0400] Majost: I currently define the url in a 'java' role
[2012-10-31 20:28:17 -0400] Majost: which I call first in my runlist
[2012-10-31 20:29:19 -0400] Majost: but somehow it still doesn't see it when it is overlooking it while it stores the cookbook during bootstrap, and I have no idea why
[2012-10-31 20:35:45 -0400] Pushnell_: not sure if my last messages went out before I got disconnected from irc .
[2012-10-31 20:36:20 -0400] Pushnell_: I changed my hosted chef account's password and email address and now the .pem file is failing to authenticate, causing 'rake install' to fail.  not sure what to do.
[2012-10-31 20:37:14 -0400] pbuckley: so it looks like mcollective.<agentname>.agent are causing me to run out memory in activemq
[2012-10-31 20:37:20 -0400] pbuckley:               <policyEntry topic="mcollective.*.agent.>" gcInactiveDestinations="true" inactiveTimoutBeforeGC="30000" />
[2012-10-31 20:37:28 -0400] pbuckley: is this the correct line to clean up those?
[2012-10-31 20:40:33 -0400] timsmith: btm: any chance I can get an invite.  We got kicked out of our conference room
[2012-10-31 20:44:14 -0400] cjs226: mattray: how does this look for determining the system with role "www" that's been up the longest - https://gist.github.com/3989743
[2012-10-31 20:47:05 -0400] mattray: cjs226: looks sane, just recall that the data on the Chef server is as reported by the last chef-client run, so if that box has gone down in the meantime it's uptime is no longer the highest
[2012-10-31 20:48:21 -0400] cjs226: mattray: thx.  yes, I've got a maint script that removes instances as they're terminated (using auto scaling in AWS).
[2012-10-31 20:49:43 -0400] mattray: cjs226: sounds good
[2012-10-31 20:49:57 -0400] cjs226: mattray: thx for helping!
[2012-10-31 21:10:09 -0400] jaygen: Hey does anyone know why installing the pg gem fails with https://gist.github.com/651db458a3fede56ade4
[2012-10-31 21:10:49 -0400] heathsnow: Pushnell_: did you redownload a new .pem from hosted chef?
[2012-10-31 21:11:54 -0400] juliancdunn: jaygen: is that the same as http://tickets.opscode.com/browse/COOK-1406?
[2012-10-31 21:12:11 -0400] Pushnell_: heathsnow: much worse, apparently :-/   I couldn't find the "generate new client key" in the UI but noticed that there was no key for my username in the Clients list, so I generated one and apparently locked myself out of our account.  I have an opscode ticket in.
[2012-10-31 21:12:34 -0400] jaygen: juliancdunn: yes, that is it.
[2012-10-31 21:13:01 -0400] jaygen: juliancdunn: I'm trying to figure out how to work around it but this ticket isn't very helpful
[2012-10-31 21:14:52 -0400] juliancdunn: jaygen: well, there's jtimberman 's gist at https://gist.github.com/3954641
[2012-10-31 21:15:05 -0400] juliancdunn: or, you could use a gem install rather than omnibus, if that's an option
[2012-10-31 21:16:00 -0400] jaygen: we're not using omnibus
[2012-10-31 21:18:14 -0400] juliancdunn: jaygen: you're not? why does your gist reference /opt/chef/embedded/bin/ruby ?
[2012-10-31 21:19:58 -0400] jaygen: juliancdunn: ah-ha.
[2012-10-31 21:20:07 -0400] jtimberman: COOK-1406 is totally sub optimal
[2012-10-31 21:20:16 -0400] jtimberman: i wish i had a better solution
[2012-10-31 21:20:59 -0400] jaygen: jtimberman: do you recommend using that shell script for now?
[2012-10-31 21:21:55 -0400] jtimberman: jaygen: uh, not really :). It "works" but its really bad to write a bunch of compiled-from-source stuff in the chef package.
[2012-10-31 21:23:20 -0400] juliancdunn: jtimberman: is this all because you bundle openssl with embedded?
[2012-10-31 21:23:34 -0400] jtimberman: juliancdunn: I don't know what the root cause of it is.
[2012-10-31 21:24:02 -0400] jtimberman: It seems there's an openssl version mismatch between the Ruby in the omnibus package and the one that postgresql's libpq uses
[2012-10-31 21:24:11 -0400] jtimberman: I don't know if this is a problem on other platforms either.
[2012-10-31 21:25:45 -0400] juliancdunn: it probably would be, unless it just so happened that Omnibus's OpenSSL version matched the OS's
[2012-10-31 21:29:32 -0400] awgross: Anyone else seen a bug in 10.14.4 where you cannot set a dpkg provider to `action :nothing` and then send it a notification?  Keeps yelling at me saying that `action :nothing` is an invalid argument
[2012-10-31 21:29:44 -0400] awgross: ================================================================================
[2012-10-31 21:29:44 -0400] awgross: Error executing action `nothing` on resource 'package[my_package]'
[2012-10-31 21:29:45 -0400] awgross: ================================================================================
[2012-10-31 21:29:45 -0400] awgross: Errno::EINVAL
[2012-10-31 21:29:45 -0400] awgross: -------------
[2012-10-31 21:29:45 -0400] awgross: Invalid argument
[2012-10-31 21:33:38 -0400] Majost: jtimberman: Is the static linking stuff I suggested viable at all?
[2012-10-31 21:36:59 -0400] awgross: looks like it is an ordering issue
[2012-10-31 21:38:11 -0400] Majost: sorta.. I think its more an issue with the gem trying to access libraries which are in the ld path -- but its being compiled against the libs in the omnibus path
[2012-10-31 21:38:14 -0400] Majost: something to that effect
[2012-10-31 21:38:24 -0400] Majost: oh
[2012-10-31 21:38:26 -0400] Majost: your issue
[2012-10-31 21:38:27 -0400] Majost: nm
[2012-10-31 21:38:28 -0400] Majost: hah
[2012-10-31 21:39:20 -0400] Majost: jtimberman: http://www.linuxtopia.org/online_books/programming_books/ruby_tutorial/Extending_Ruby_Static_Linking.html
[2012-10-31 21:39:29 -0400] kallistec: awgross: that's a system call error of some sort. do you have a not_if/only_if on that resource? I think those get executed despite the action :nothing
[2012-10-31 21:39:49 -0400] Majost: jtimberman:  you might be able to do the inverse of my original suggestion and statically link the pg gem
[2012-10-31 21:40:49 -0400] awgross: kallistec: i do on the notifying resource as well as the notified resource.  However I was seeing the issue even without the only_if block on the notified resource
[2012-10-31 21:42:18 -0400] kallistec: awgross: post the full error to gist?
[2012-10-31 21:42:21 -0400] awgross: sure
[2012-10-31 21:42:28 -0400] awgross: let me reproduce it
[2012-10-31 21:52:15 -0400] awgross: kallistec: Cookbook File: https://gist.github.com/8b850237b609f0f931c9  Stacktrace:  https://gist.github.com/cbdb269372e8eae94559
[2012-10-31 21:55:43 -0400] flaccid_: aws cookbook looks after create, attach ebs volume. what is usually used in chef to partition and format the volume before mount resource?
[2012-10-31 21:58:42 -0400] awgross: flaccid_: unsure, i used execute blocks to set prep the disks with my chosen settings
[2012-10-31 22:00:25 -0400] flaccid_: thanks awgross
[2012-10-31 22:03:05 -0400] cmceldowney: erikh: trying to use that IPCalculator you referenced, but can't get the library to load properly. (https://gist.github.com/50694288fca7402bea10) Have that defined inside ipcalculator.rb in cookbook library, and referencing using class Chef::Recipe include IPCalculator
[2012-10-31 22:07:12 -0400] kallistec: awgross: seems pretty crazy and happening at a pretty low level. Can you strace it?
[2012-10-31 22:09:20 -0400] cmceldowney: erikh: Heh. dumb me. was uploading wrong cookbook. please resume your previously scheduled programming.
[2012-10-31 22:10:00 -0400] awgross: kallistec: probably, I have a working solution
[2012-10-31 22:10:39 -0400] awgross: which is to just re arrange the order of the blocks in the recipe so that they are reversed, this way it has already passed the `action :nothing` block before it is notified
[2012-10-31 22:50:04 -0400] Majost: Is it possible to restrict the version of a single cookbook in the _default environment?
[2012-10-31 22:57:44 -0400] maek: Majost: _default doesnt get an env file
[2012-10-31 22:57:46 -0400] maek: i dont think
[2012-10-31 22:58:01 -0400] maek: knife cookbook upload cookbooks_version_you_want -E _default
[2012-10-31 22:58:04 -0400] maek: i *think(
[2012-10-31 23:00:22 -0400] Majost: hrm
[2012-10-31 23:00:30 -0400] Majost: any way to yank a cookbook if that doesn't work?
[2012-10-31 23:00:40 -0400] Majost: nm
[2012-10-31 23:00:47 -0400] Majost: I just realized the answer to my own question there
[2012-10-31 23:09:07 -0400] jtimberman: Majost: pretty sure you can't pin versions in _default
[2012-10-31 23:16:26 -0400] Majost: damn
[2012-10-31 23:28:35 -0400] jaygen: any obvious reason for error "Failed to authenticate ubuntu - trying password auth"
[2012-10-31 23:28:58 -0400] jaygen: on knife ec2 server create
[2012-10-31 23:29:03 -0400] bluepojo: you're using the wrong keypair
[2012-10-31 23:29:30 -0400] bluepojo: you need to tell it what ssh key to uyse
[2012-10-31 23:29:31 -0400] bluepojo: use
[2012-10-31 23:29:43 -0400] jaygen: I'm passing along the ssh key via -i
[2012-10-31 23:29:54 -0400] bluepojo: and are you telling it what ec2 keypair that key maps to?
[2012-10-31 23:29:59 -0400] jaygen: and it's also set in knife.rb
[2012-10-31 23:30:26 -0400] jaygen: yep
[2012-10-31 23:30:38 -0400] awgross: jaygen what version of knife / knife-ec2
[2012-10-31 23:30:59 -0400] jaygen: xxx$ knife -v Chef: 10.12.0
[2012-10-31 23:31:49 -0400] awgross: jaygen: what ec2 ami?  custom of stock ubuntu 12.04.1?
[2012-10-31 23:31:53 -0400] jaygen: custom
[2012-10-31 23:32:00 -0400] jaygen: yes
[2012-10-31 23:34:41 -0400] jaygen: cat /etc/issue => Ubuntu 12.04 LTS \n \l
[2012-10-31 23:38:36 -0400] awgross: jaygen if you start one of those AMIs manually, can you SSH in to it properly from the command line?
[2012-10-31 23:38:42 -0400] jaygen: yes
[2012-10-31 23:40:50 -0400] jaygen: is there some way to debug this stuff, via pry or something?
[2012-10-31 23:42:53 -0400] jaygen: running in verbose mode...
[2012-10-31 23:43:59 -0400] jaygen: I think knife is not picking up on my changes to ~/.chef/knife.rb
[2012-10-31 23:44:29 -0400] jaygen: verbose mode is kinda not verbose, eh :(
[2012-10-31 23:47:26 -0400] awgross: jaygen: agreed, it can be tricky to get output easily
[2012-10-31 23:47:43 -0400] jaygen: new error, Net::SSH::HostKeyMismatch
[2012-10-31 23:47:57 -0400] awgross: ahh, delet your known host keys
[2012-10-31 23:48:00 -0400] awgross: or rename it
[2012-10-31 23:48:07 -0400] awgross: you have prob seen the Amazon IP before
[2012-10-31 23:48:15 -0400] jaygen: wow, what are the chances
[2012-10-31 23:48:53 -0400] jaygen: I guess pretty high if they recycle the external ips back to you
[2012-10-31 23:49:12 -0400] awgross: yeah happens from time to time
[2012-10-31 23:49:52 -0400] jaygen: Huzzah
[2012-10-31 23:50:07 -0400] jaygen: say, awgross, is there some reason chef would not be reading my ~/.chef/knife.rb
[2012-10-31 23:50:25 -0400] jaygen: I had to pass all the details of the key along via -S and -i
[2012-10-31 23:50:49 -0400] Majost: or set StrictHostKeyChecking no in you ssh_config
[2012-10-31 23:52:46 -0400] Majost: not super secure, but if you are bringing stuff up and down in an automated fashion, it can become essential.
[2012-10-31 23:52:50 -0400] awgross: jaygen: I have had some issues with that which lead me to always specify with -c
[2012-10-31 23:52:59 -0400] jaygen: ahh k
[2012-10-31 23:53:04 -0400] jaygen: awgross: thank you
[2012-10-31 23:53:08 -0400] gyre008: yfeldblum, you about ?
[2012-10-31 23:53:13 -0400] gyre008: sorry for bothering you :)
[2012-10-31 23:53:18 -0400] awgross: jaygen: np
[2012-10-31 23:53:28 -0400] yfeldblum: gyre008, what can i do for you?
[2012-10-31 23:53:44 -0400] gyre008: just a quick q...
[2012-10-31 23:54:14 -0400] gyre008: geekbri mentioned that he sticks that awesome recipe_eval into cookbook library...
[2012-10-31 23:54:44 -0400] gyre008: I'm just wondering whether it should be within Classh Chef, Class Recipe blocks or whether it doesn't need/matter
[2012-10-31 23:54:53 -0400] gyre008: doesnt need to be*
[2012-10-31 23:55:30 -0400] gyre008: something like this ? https://gist.github.com/3990743
[2012-10-31 23:55:40 -0400] gyre008: or can I leave the Chef/Recipe bits out
[2012-10-31 23:59:53 -0400] yfeldblum: gyre008, pretty sure that won't work
