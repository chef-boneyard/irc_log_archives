[2012-09-05 00:16:12 -0400] halcyonCorsair: can anyone tell me what the cron resource will take as arguments, eg for the minute? eg, how can i do */10?
[2012-09-05 00:18:39 -0400] wamilton: halcyonCorsair: http://wiki.opscode.com/display/chef/Resources#Resources-Cron
[2012-09-05 00:20:39 -0400] wamilton: halcyonCorsair: so, it doesn't have a name attribute, so for the thing between cron and do you just put whatever you want...
[2012-09-05 00:20:58 -0400] wamilton: halcyonCorsair: and in the block, you just say 'minute "10"'
[2012-09-05 00:21:24 -0400] halcyonCorsair: wamilton: err, I'm a dumbass, the wording of that for some reason made me think I was giving it an integer...don't know where my brain got that
[2012-09-05 00:21:35 -0400] halcyonCorsair: anyway: minute "*/10" does the trick
[2012-09-05 00:23:12 -0400] wamilton: halcyonCorsair: weird, I would thing that you WOULD just give it "10" in that case especially given that the example features a line that looks like 'hour "5"' and another that looks like 'minute "0"' and the default for all is "*"
[2012-09-05 00:23:43 -0400] halcyonCorsair: wamilton: no, "10" would make it only run on the 10th minute of the hour as opposed
[2012-09-05 00:23:51 -0400] halcyonCorsair: to every 10 minutes
[2012-09-05 00:24:00 -0400] wamilton: halcyonCorsair: ah, got it
[2012-09-05 00:24:52 -0400] wamilton: I have a client demo scheduled for tomorrow morning and we just finished a 3-day weekend... I am out of it
[2012-09-05 00:49:50 -0400] makerbreaker: is there a tut somewhere for spice?
[2012-09-05 00:51:03 -0400] yfeldblum_: makerbreaker, have you looked at https://github.com/danryan/spice/wiki ?
[2012-09-05 00:51:25 -0400] makerbreaker: ah no, i just saw the read me, ty
[2012-09-05 00:52:19 -0400] danryan: makerbreaker: My apologies it was not obvious. I'll add a link to the wiki from the readme right now.
[2012-09-05 00:52:52 -0400] yfeldblum_: danryan, mega fail!
[2012-09-05 00:53:01 -0400] makerbreaker: cool, im pretty stupid, it may hav been obvious.
[2012-09-05 00:53:43 -0400] danryan: yfeldblum_: Yep :D
[2012-09-05 00:53:56 -0400] danryan: makerbreaker: you're not the first. I should have corrected that sooner.
[2012-09-05 00:55:07 -0400] yfeldblum_: danryan, also might want to update it to show how to set up a Spice::Connection instance?
[2012-09-05 00:56:10 -0400] danryan: yfeldblum_: It's in there, down at the bottom of https://github.com/danryan/spice/wiki/Configuration
[2012-09-05 00:57:38 -0400] yfeldblum_: danryan, ah
[2012-09-05 00:58:10 -0400] yfeldblum_: danryan, also ... might want to deprecate all the stuff hanging directly off the Spice constant ...
[2012-09-05 00:58:21 -0400] yfeldblum_: danryan, IMO that just encourages bad practice
[2012-09-05 00:58:43 -0400] yfeldblum_: danryan, even though it can be convenient
[2012-09-05 00:59:26 -0400] makerbreaker: danryan, I can put the config in an initilizer right? in block form?
[2012-09-05 01:00:24 -0400] danryan: yfeldblum_: Agreed, I've been considering that, but they're just so darn convenient ;)
[2012-09-05 01:00:57 -0400] danryan: yfeldblum_, will likely drop them in the next release.
[2012-09-05 01:00:59 -0400] yfeldblum_: danryan, at least put it all under a "singleton accessor"
[2012-09-05 01:01:18 -0400] yfeldblum_: danryan, used like so: Spice.connection.roles
[2012-09-05 01:02:20 -0400] yfeldblum_: danryan, rather than Spice.roles
[2012-09-05 01:02:46 -0400] yfeldblum_: danryan, so that it's clear to all that in order to use Spice, you get a connection instance and then you do stuff with that
[2012-09-05 01:03:12 -0400] danryan: yfeldblum_, aye. That's how fog does it and I do like that behavior.
[2012-09-05 01:03:17 -0400] yfeldblum_: danryan, indeed
[2012-09-05 01:03:24 -0400] danryan: makerbreaker: yessir!
[2012-09-05 01:03:41 -0400] yfeldblum_: danryan, i have been making the same transition over time with the Librarian codebase
[2012-09-05 01:04:24 -0400] makerbreaker: danryan, if i use a non existent key file, I get an error "unauthorized"  so i know things are working, but if I use the right key file: NoMethodError: undefined method `[]' for client[chef-validator]:Chef::ApiClient
[2012-09-05 01:04:25 -0400] yfeldblum_: danryan, and i think it's really important for overall testability, composability, and usability
[2012-09-05 01:06:10 -0400] makerbreaker: do i have some config messed up?
[2012-09-05 01:06:34 -0400] yfeldblum_: makerbreaker, always show the full backtrace ...
[2012-09-05 01:07:40 -0400] makerbreaker: https://gist.github.com/3628751
[2012-09-05 01:08:08 -0400] danryan: makerbreaker: mind gisting your config and method calls?
[2012-09-05 01:09:05 -0400] makerbreaker: here is my config https://gist.github.com/3628763
[2012-09-05 01:09:19 -0400] makerbreaker: I just was running Spice.clients from the railsconsole
[2012-09-05 01:09:36 -0400] yfeldblum_: makerbreaker, the bigger wtf here is you're running an old RC of ruby :P
[2012-09-05 01:10:30 -0400] yfeldblum_: makerbreaker, also i think rails is filtering your backtrace
[2012-09-05 01:11:34 -0400] yfeldblum_: makerbreaker, hmm maybe not
[2012-09-05 01:12:37 -0400] danryan: makerbreaker: interesting. your config looks good.
[2012-09-05 01:14:18 -0400] yfeldblum_: danryan, you shouldn't symbolize keys unless you're sure they're all in a whitelist: https://github.com/danryan/spice/blob/v1.0.4/lib/spice/connection/search.rb#L13
[2012-09-05 01:14:58 -0400] makerbreaker: config wasnt right actually, using chef 10.12, but still didnt fix thigns
[2012-09-05 01:15:04 -0400] makerbreaker: just noticedthe typo
[2012-09-05 01:16:56 -0400] makerbreaker: do i need to call Spice.new ?
[2012-09-05 01:18:01 -0400] makerbreaker: odd.
[2012-09-05 01:19:16 -0400] makerbreaker: https://gist.github.com/3628836
[2012-09-05 01:19:23 -0400] makerbreaker: things are kind of working
[2012-09-05 01:19:55 -0400] danryan: makerbreaker: It looks like this has to do with the json gem's use of the json_class attribute.
[2012-09-05 01:20:21 -0400] danryan: http://flori.github.com/json/doc/classes/JSON.html#attribute-c-create_id
[2012-09-05 01:20:26 -0400] danryan: http://tickets.opscode.com/browse/CHEF-1330
[2012-09-05 01:20:44 -0400] danryan: makerbreaker: what happens when you require a different json library, like yajl-ruby?
[2012-09-05 01:22:22 -0400] danryan: gem 'yajl-ruby', :require => 'yajl'
[2012-09-05 01:25:30 -0400] makerbreaker: same error
[2012-09-05 01:35:06 -0400] makerbreaker: is there another json lib i can use?
[2012-09-05 01:35:28 -0400] makerbreaker: or am i stuck with Chef::REST?
[2012-09-05 01:55:03 -0400] danryan: makerbreaker: That's an interesting one I haven't seen before I'll still investigate. You can try setting `JSON.create_id = nil` somewhere in your app, like the same initializer where you're initializing spice.
[2012-09-05 01:55:28 -0400] danryan: perchance are you also requiring the chef gem?
[2012-09-05 01:55:47 -0400] makerbreaker: I am
[2012-09-05 01:55:51 -0400] makerbreaker: no good?
[2012-09-05 01:56:15 -0400] yfeldblum_: makerbreaker, no good
[2012-09-05 01:56:23 -0400] yfeldblum_: makerbreaker, i expect
[2012-09-05 01:56:27 -0400] danryan: Ah-ha, that's why it knows about Chef::ApiClient and is not failing on uninitialized constant
[2012-09-05 01:56:29 -0400] stuartrexking: What would best practice be to install a remote deb? Use remote_file to download to /tmp then install using the package resource?
[2012-09-05 01:56:41 -0400] danryan: makerbreaker: definitely the json_class breaking it.
[2012-09-05 01:56:52 -0400] danryan: spice doesn't need the chef gem required.
[2012-09-05 01:56:52 -0400] makerbreaker: will remove
[2012-09-05 01:59:33 -0400] makerbreaker: https://gist.github.com/3629104
[2012-09-05 01:59:42 -0400] makerbreaker: new error
[2012-09-05 02:03:11 -0400] makerbreaker: that looks more like the json error you referenced earlier
[2012-09-05 02:03:16 -0400] danryan: makerbreaker: hmm, it's still trying to convert json_class to a constant. What version of rails? Also try just `gem 'yajl-ruby'` in your gemfile without the `:require => 'yajl'`bit. Seems rails is still loading the json gem.
[2012-09-05 02:04:15 -0400] makerbreaker: same
[2012-09-05 02:04:28 -0400] makerbreaker: rails 3.2 .3
[2012-09-05 02:10:25 -0400] makerbreaker: danryna, fwiw, newest version of json did not work either
[2012-09-05 02:10:30 -0400] makerbreaker: danryan*
[2012-09-05 02:11:21 -0400] danryan: makerbreaker: right, the json gem is what's bugging out. Did you try setting `JSON.create_id = nil` in your initializer?
[2012-09-05 02:11:44 -0400] makerbreaker: aye
[2012-09-05 02:11:57 -0400] jelder: i have a machine that just spontaneously started getting "invalid signature for user or client" from opscode
[2012-09-05 02:12:02 -0400] danryan: makerbreaker: Lame :( Mind creating an issue? https://github.com/danryan/spice/issues/new
[2012-09-05 02:12:09 -0400] jelder: regenerating the key doesn't fix it
[2012-09-05 02:12:23 -0400] makerbreaker: sure np
[2012-09-05 02:12:28 -0400] danryan: makerbreaker: thanks!
[2012-09-05 02:14:20 -0400] makerbreaker: hrm....
[2012-09-05 02:14:22 -0400] makerbreaker: very odd
[2012-09-05 02:14:34 -0400] makerbreaker: I added the chef gem back in
[2012-09-05 02:14:43 -0400] makerbreaker: and its not working
[2012-09-05 02:14:50 -0400] makerbreaker: with JSON.create_id = nil
[2012-09-05 02:14:55 -0400] makerbreaker: now**
[2012-09-05 02:15:20 -0400] makerbreaker: thanks for the help!
[2012-09-05 02:16:26 -0400] danryan: makerbreaker: I think it'll be best to drop json_class completely from the returned results per http://tickets.opscode.com/browse/CHEF-1330
[2012-09-05 02:16:42 -0400] danryan: makerbreaker: I'll fix it and cut a new release. Thanks for the bug report :)
[2012-09-05 02:16:53 -0400] makerbreaker: np, thanks for the gem
[2012-09-05 02:31:08 -0400] makerbreaker: how do i modify a node's attributes directly?
[2012-09-05 02:31:49 -0400] makerbreaker: ie, if Im using https://github.com/opscode-cookbooks/postgresql and want to set the postgres users password, can put the recipe in the run list, then go back at a later data and change the password attribute?
[2012-09-05 02:31:59 -0400] makerbreaker: later date*
[2012-09-05 02:42:36 -0400] jtimberman: makerbreaker: you can change the node by doing 'knife node edit NODENAME', but that kind of thing is generally better to modify in a role applied to the node's run list rather than the recipe
[2012-09-05 02:43:22 -0400] halcyonCorsair: hi, i did a chef-solo run, then I changed what a cookbook was supposed to do, but it's still trying to do what it did in the previous run, do I need to clear cache or something?
[2012-09-05 02:45:49 -0400] makerbreaker: jtimberman, in the case of that postgres recipe posted above, does it save that password somewhere?
[2012-09-05 02:46:09 -0400] makerbreaker: nm
[2012-09-05 02:46:19 -0400] makerbreaker: the recipe was failing
[2012-09-05 02:54:35 -0400] hoover_damm: should save it in the node always
[2012-09-05 03:01:14 -0400] flaccid: teh recipe only applies the password if the current one is dif
[2012-09-05 03:03:15 -0400] makerbreaker: does Opscode::OpenSSL::Password generate a clear text password, or is it hashed?
[2012-09-05 03:04:44 -0400] hoover_damm: its random
[2012-09-05 03:05:10 -0400] hoover_damm: random letters/text/etc..
[2012-09-05 03:05:35 -0400] makerbreaker: is there something im missing then...I have put the postgres into the run list
[2012-09-05 03:05:45 -0400] makerbreaker: ran successfully, checked in with the postres password
[2012-09-05 03:05:47 -0400] hoover_damm:         while pw.length < 20 pw << ::OpenSSL::Random.random_bytes(1).gsub(/\W/, '')
[2012-09-05 03:05:50 -0400] makerbreaker: but its not working
[2012-09-05 03:06:06 -0400] makerbreaker: pg_hba.conf is set to md5
[2012-09-05 03:06:50 -0400] hoover_damm: i always thought md5 for local was ocd silly
[2012-09-05 03:07:06 -0400] hoover_damm: but that's just how i run my environments
[2012-09-05 03:08:26 -0400] halcyonCorsair: chef solo cache anyone?
[2012-09-05 03:09:00 -0400] makerbreaker: hoover_damm, it wont be local eventaully
[2012-09-05 03:09:07 -0400] james1234: So I'm writing a recipe, and I need to assign a host to a particular proxy, based on the network address (first three octets of the IP).  I'm new to Chef, and I think the best way to do this would be to use data bags to include the network and proxy information.  Does this sound like the right way to do it?
[2012-09-05 03:09:19 -0400] halcyonCorsair: how can i continue past the failed part of a chef run?
[2012-09-05 03:10:02 -0400] jcran: has anyone done work on embedding chef into an existing UI?
[2012-09-05 03:10:13 -0400] jcran: curious if i'm just not googling in the right places
[2012-09-05 03:10:34 -0400] makerbreaker: jcran, im using it in a rails app
[2012-09-05 03:10:39 -0400] makerbreaker: if thats what you mean
[2012-09-05 03:10:52 -0400] jcran: just want to kick off some basic chef-solo runs
[2012-09-05 03:11:08 -0400] makerbreaker: jcran, there isnt too much out there in the way of docs
[2012-09-05 03:11:10 -0400] jcran: i can read the code, but curious if anyone had tips
[2012-09-05 03:11:22 -0400] jcran: cool, appreciate the validation of my googling at least :)
[2012-09-05 03:11:35 -0400] jcran: i'll throw something together as i work it up
[2012-09-05 03:11:52 -0400] makerbreaker: Im using rails, the spice gem, knife-rackspace, and a seperate chef server
[2012-09-05 03:12:10 -0400] makerbreaker: resque, and redis to spin up the VMs, and to take care of a lot of the tasks
[2012-09-05 03:13:00 -0400] jcran: ooh, neat. this is all local to the current system, simple ui to reconfig the box as necessary
[2012-09-05 03:13:20 -0400] makerbreaker: ah
[2012-09-05 03:13:38 -0400] makerbreaker: i havent messed with chef-solo too much
[2012-09-05 03:16:00 -0400] miah: i chef-solo all the time thanks to vagrant.. i need to build out a local chef-server though.
[2012-09-05 03:16:04 -0400] halcyonCorsair: jcran: how's your chef-solo fu?
[2012-09-05 03:17:57 -0400] miah: jcran: chef has a restful api
[2012-09-05 03:18:17 -0400] jtimberman: jcran: you may be intereted in the spice gem by danryan
[2012-09-05 03:18:24 -0400] jtimberman: its a ruby library
[2012-09-05 03:18:27 -0400] miah: spice is nice
[2012-09-05 03:18:31 -0400] jtimberman: but should give you some ideas about implementation
[2012-09-05 03:18:41 -0400] miah: i wrote up pretty simple script to test some search logic i had
[2012-09-05 03:24:21 -0400] jcran: jtimberman: checking it out now
[2012-09-05 03:25:13 -0400] jcran: halcyonCorsair: not sure how to measure that. i can make it do everything i want thus far, but haven't read the code.
[2012-09-05 03:25:37 -0400] jcran: miah: don't want to run a separate server for now, planning on having the box be self contained as a node
[2012-09-05 03:26:17 -0400] jcran: miah: it has a restful api which i want to reach out to chef
[2012-09-05 03:26:40 -0400] jcran: er, rather, to run chef-solo w/ a recipe i specify
[2012-09-05 03:27:12 -0400] jcran: an example is hitting the api to turn the box into a wireless access point
[2012-09-05 03:28:20 -0400] jcran: jtimberman: spice gem is definitely helpful, thanks!
[2012-09-05 03:39:49 -0400] waer-away: greetings all, new to chef. I'm wondering if instead of knife one could use the server api to provision a cloud server (ec2, racksapce, etc) and if so anyone have a link handy for a quick example?
[2012-09-05 03:40:08 -0400] waer-away: everything i'm finding seems to be knife only
[2012-09-05 03:52:32 -0400] jtimberman: waer-away: knife is a plugin-based command-line tool for Chef. It has many sub-commands as installed, most of which are for working with the Chef Server API. Plugins exist to work with a variety of cloud computing providers in the intent of connecting said cloud instances with the chef server that knife knows about (Through its configuration file)
[2012-09-05 03:52:57 -0400] jtimberman: jcran: you're welcome, though iirc spice is mainly focused on the chef server api, rather than interacting with solo
[2012-09-05 03:54:38 -0400] waer-away: jtimberman: right, I understand that, what I'm trying to see is (as an example) creating a new ec2 instance and provisioning it via the server api in chef as opposed to knife
[2012-09-05 04:01:21 -0400] zts: waer-away: when you say "the server API in chef", what do you have in mind?  The chef server API is just for working with the data inside the chef server - it doesn't know anything about cloud providers, and there is no way to add that
[2012-09-05 04:02:50 -0400] waer-away: zts: it's my lack of understanding on how knife is doing it's thing, in reading somewhat further I'm suspecting that knife talks to AWS itself for the creation of the instance, then does the bootstrapping and communicating with the chef server as seperate tasks
[2012-09-05 04:03:03 -0400] waer-away: I was (hoping?) that chefserver handled that stuff itself
[2012-09-05 04:03:59 -0400] waer-away: and knife was only a cli tool to communicate with the server
[2012-09-05 04:05:58 -0400] zts: you suspect correctly
[2012-09-05 04:06:11 -0400] sunil_: is there a way to setup a hostname of a server with data from knife's -N option?  This is basically the node_name variable..
[2012-09-05 04:07:20 -0400] sunil_: oh wait..I think I figured it out :) ignore my question please.
[2012-09-05 04:11:50 -0400] sunil_: node.name seems to do the trick
[2012-09-05 04:21:09 -0400] jtimberman: waer-away: your first suspiscion is correct. knife's cloud plugins do this: talk to the cloud provider through a ruby library (often fog, e.g. in ec2 or openstack) using configured credentials to create a new instance of the specified parameters (you can change the AMI, instance size, ssh key and other options in knife ec2 commands for example). then once the instance is available via SSH knife opens an SSH connection to the instance and runs a
[2012-09-05 04:23:00 -0400] zts: jtimberman: that got truncated after "connections to the instance and runs a"
[2012-09-05 04:33:17 -0400] jtimberman: and runs a script to "bootstrap" the node to talk to the correct chef server. then the bootstrap script typically runs chef-client on the instance, and that talks to the chef server as normal
[2012-09-05 04:33:45 -0400] waer-away: thanks
[2012-09-05 04:33:56 -0400] waer-away: yeah that explains why I wasn't able to find anything on it :)
[2012-09-05 04:38:19 -0400] jtimberman: :)
[2012-09-05 05:11:09 -0400] j4m3s: hello all
[2012-09-05 05:12:39 -0400] j4m3s: i have a recipe that puts a file in /etc/monit.d/ and i want to issue a restart to the monit service, i can't seem to get this working tho
[2012-09-05 05:19:31 -0400] ranjibd_: j4m3s, can u share the snipplet ?
[2012-09-05 05:22:29 -0400] j4m3s: ranjibd_, http://pastie.org/private/3jh3tfayacrjznibhgldtg
[2012-09-05 05:23:22 -0400] ranjibd_: notifies :restart, "service[monit]"
[2012-09-05 05:23:34 -0400] ranjibd_: what version of chef you are using ?
[2012-09-05 05:28:23 -0400] j4m3s: ranjibd_, FATAL: Errno::ENOENT: template[/etc/monit/monitrc] (monit::default line 18) had an error: Errno::ENOENT: No such file or directory - /tmp/chef-rendered-template20120905-7633-1mwwn9a-0 or /etc/monit/monitrc ?
[2012-09-05 05:28:49 -0400] ranjibd_: do you have /etc/monit directory in place?
[2012-09-05 05:29:25 -0400] j4m3s: sorry no, i'll stop bugging you with these brain busters lol
[2012-09-05 05:29:38 -0400] ranjibd_: :-) its ok
[2012-09-05 05:32:13 -0400] j4m3s: ranjibd_, thanks for your help tho
[2012-09-05 06:02:42 -0400] j4m3s: ranjibd_, how do i override the default attribute of a cookbook with a node attributes file?
[2012-09-05 06:03:00 -0400] j4m3s: the attribute is @node[:monit][:notify_email]
[2012-09-05 06:03:29 -0400] flaccid: whats a node attributes file?
[2012-09-05 06:03:36 -0400] j4m3s: in my nodes.json file I have "notify_email": "support@mypbx.net"
[2012-09-05 06:04:15 -0400] j4m3s: a file you can specify via the command line chef-solo -j attributes.json
[2012-09-05 06:04:22 -0400] j4m3s: ranjibd__, how do i override the default attribute of a cookbook with a node attributes file?
[2012-09-05 06:04:50 -0400] j4m3s: not sure if you saw my prev message to your other nick
[2012-09-05 06:04:57 -0400] flaccid: you specify it in the node.json or its in the cookbook for defaults
[2012-09-05 06:05:17 -0400] flaccid: the Attributes page on the wiki covers this kind of thing as well as the Chef Solo page
[2012-09-05 06:05:18 -0400] j4m3s: i did that but the attribute isn't being set
[2012-09-05 06:05:40 -0400] flaccid: it will be set, perhaps your cookbook(s) are designed wrong
[2012-09-05 06:06:31 -0400] j4m3s: it appears to be putting the file there properly, just not setting the attributes i wanted to override
[2012-09-05 06:06:56 -0400] j4m3s: which made me think i didn't configure the attribute properly in my node.json file
[2012-09-05 06:07:42 -0400] flaccid: i'm not sure what to say sorry..
[2012-09-05 06:08:24 -0400] flaccid: "monit": { "notify_email":"foo@bar.com" } will definitely set it from your nodes.json
[2012-09-05 06:08:34 -0400] j4m3s: flaccid, that's the trick!
[2012-09-05 06:08:36 -0400] j4m3s: thanks
[2012-09-05 06:08:38 -0400] flaccid: what trick?
[2012-09-05 06:08:55 -0400] j4m3s: i didn't have "monit":
[2012-09-05 06:09:08 -0400] flaccid: oh.
[2012-09-05 06:09:27 -0400] j4m3s: i knew i had something formatted improperly with my json
[2012-09-05 06:09:37 -0400] j4m3s: flaccid, i'm REALLY new to chef...
[2012-09-05 06:09:50 -0400] flaccid: and also vague :)
[2012-09-05 06:10:04 -0400] j4m3s: sorry :(
[2012-09-05 06:10:51 -0400] j4m3s: happens when you don't a good understanding of the vocab
[2012-09-05 06:16:50 -0400] flaccid: if you cite the full code and error etc. you have a real chance at someone diagnosing the issue
[2012-09-05 06:18:40 -0400] halcyonCorsair: can anyone help me with setting environment variables when executing a command with chef?
[2012-09-05 06:20:34 -0400] yfeldblum_: halcyonCorsair, if using shell-out, pass the :environment option; if using the execute resource, set the environment attribute
[2012-09-05 06:21:23 -0400] stuartrexking: What is the recommended way to update a users PATH using Chef?
[2012-09-05 06:22:40 -0400] stuartrexking: Say during a run, I wanted to add /opt/vagrant/bin to that users path.
[2012-09-05 06:23:21 -0400] flaccid: hmm, not sure, the path thing is shell specific, besides posix compliance of ~/.profile
[2012-09-05 06:25:02 -0400] stuartrexking: flaccid: I am trying to install vagrant using chef. The deb extracts to /opt/vagrant/bin which not on the default path for any of my users.
[2012-09-05 06:26:51 -0400] stuartrexking: Touching the .bashrc or .profile of my users seems a little icky.
[2012-09-05 06:28:35 -0400] stuartrexking: I can install it using a gem, but the local gems binary are not on the path either.
[2012-09-05 06:28:42 -0400] stuartrexking: Might try installing it as a non-local gem.
[2012-09-05 06:31:53 -0400] hari_: hey i run chef recipes on github for java, when i run openjdk i.e. the default recipe it run fine, but when i run oracle flavor it gives errors
[2012-09-05 06:32:17 -0400] halcyonCorsair: yfeldblum_: what about with the script resource? is that an alternative?
[2012-09-05 06:33:26 -0400] hari_: Error:  action create_if_missing  in line r = remote_file "#{Chef::Config[:file_cache_path]}/#{tarball_name}" do
[2012-09-05 06:34:11 -0400] hari_: hey i am fresher pls help
[2012-09-05 06:39:41 -0400] flaccid: stuartrexking: i'd research on the web on how people are managing that file for users
[2012-09-05 06:39:50 -0400] flaccid: if its not already via a template or simillar, probably need to make it
[2012-09-05 06:39:58 -0400] BryanWB_: ohai chefs!
[2012-09-05 06:40:37 -0400] yfeldblum_: halcyonCorsair, http://wiki.opscode.com/display/chef/Resources
[2012-09-05 06:41:31 -0400] halcyonCorsair: yfeldblum_: ah i got it, i missed the line about script getting all of execute's stuff
[2012-09-05 08:49:47 -0400] hari_: Chef::ShellOut.new
[2012-09-05 08:50:04 -0400] hari_: what does it mean
[2012-09-05 09:03:57 -0400] gyre007: how can I notify multiple services from one resource ? should I put them into array or...
[2012-09-05 09:04:19 -0400] gyre007: hari_, it means that Chef is trying to execute some command in Shell afaik
[2012-09-05 09:13:11 -0400] gyre007: I see, I just need to put it on a separate line..
[2012-09-05 09:28:46 -0400] krisk: what's the recommended way of deploying ssl certficiates? along with the cookbook (e.g. nginx), writing a custom ssl recipe? is there one, that stores ssl certificates in encrypted data bags?
[2012-09-05 09:34:28 -0400] BryanWB_: krisk: cookbook-certificates
[2012-09-05 09:34:51 -0400] BryanWB_: i think on community.opscode.com it is just certificates
[2012-09-05 09:36:52 -0400] krisk: BryanWB_: thx, I'll have a look
[2012-09-05 11:54:47 -0400] forestbird: i'm having some issues with the init script on chef server on debian
[2012-09-05 11:55:38 -0400] forestbird: i can see that the init script for chef-server chowns /var/run/chef as root
[2012-09-05 11:55:57 -0400] forestbird: solr is started with the chef user and it can't write the pid
[2012-09-05 12:02:01 -0400] fluffheadsr: ugh, so f'd up.. fall leaves are hitting already its early september
[2012-09-05 12:02:18 -0400] fluffheadsr: and its coat weather outside..
[2012-09-05 12:02:23 -0400] fluffheadsr: bye bye summer :(
[2012-09-05 12:08:15 -0400] fluffheadsr: headed to work.
[2012-09-05 12:08:20 -0400] fluffheadsr: woops wrong window
[2012-09-05 12:17:01 -0400] forestbird: hmm, as what user are the chef tool supposed to run?
[2012-09-05 12:17:10 -0400] BryanWB_: root
[2012-09-05 12:17:33 -0400] forestbird: it seems that solr is started first... the init script chowns /var/run/chef as root
[2012-09-05 12:17:49 -0400] forestbird: then solr starts with chef user and can't create the pid
[2012-09-05 12:19:49 -0400] forestbird: i would say the scripts are broken
[2012-09-05 12:20:18 -0400] forestbird: it's chef 10.12  from the apt repo
[2012-09-05 12:24:19 -0400] jmara: hey can anyone tell me how the json for "knife bootstrap -j" has to look? I'm getting "unexpected token at node.json" all the time :-/
[2012-09-05 12:25:10 -0400] jmara: I thought it would be the same as in "knife node edit" :-/
[2012-09-05 12:28:17 -0400] jmara: sorry ... should have read the complete help-message (string not file) ;) -j "$(cat node.json)"
[2012-09-05 12:41:21 -0400] masterkorp: http://ompldr.org/vZmRlNA/IMG_20120904_180914.jpg
[2012-09-05 12:41:30 -0400] masterkorp: errr sorry
[2012-09-05 12:42:00 -0400] geekbri: sweet ride!
[2012-09-05 12:42:52 -0400] sampikesley: you ever take it off any sweet jumps?
[2012-09-05 13:14:40 -0400] williamherry: hi
[2012-09-05 13:16:57 -0400] williamherry: I use 'curl -L http://www.opscode.com/chef/install.sh | bash' to install chef-client, it works fine except start very slow, it almost take 10 sec to see any output(use chef-client directily to start), some one can give me some hits to finger it out why it take so long
[2012-09-05 13:23:11 -0400] fasten: williamherry: you're using rubygem's version bundled with omnibus I guess (1.9.2)
[2012-09-05 13:23:37 -0400] fasten: williamherry: you can update ruby gems it will be much faster
[2012-09-05 13:23:41 -0400] fasten: sudo /opt/chef/embedded/bin/gem update --system
[2012-09-05 13:23:59 -0400] fasten: or update to Ruby 1.9.3
[2012-09-05 13:24:33 -0400] fasten: or wait for Chef 10.14 (it will integrate Ruby 1.9.3 and Rubygems 18.24)
[2012-09-05 13:28:23 -0400] williamherry: fasten: I am gonna to try update first, thanks
[2012-09-05 13:30:00 -0400] williamherry: fasten: when will chef 10.14 release?
[2012-09-05 13:32:02 -0400] fasten: williamherry: I don't know, I've heard the release candidate released sometime in august
[2012-09-05 13:32:12 -0400] fasten: so it should be anytime soon now !
[2012-09-05 13:34:57 -0400] williamherry: fasten: seems speed up a little
[2012-09-05 13:52:38 -0400] maxmanders: This may be one of those obvious ones obfuscated by a misleading error message - Using knife ec2 with -S {aws-ssh-keyfile.pem} but I get an error that the key file can't be found - it's definitely there!
[2012-09-05 13:57:29 -0400] masterkorp: geekbri: sampikesley no its my commuter
[2012-09-05 13:57:33 -0400] masterkorp: road only
[2012-09-05 13:57:52 -0400] masterkorp: but yeah its sweet :D
[2012-09-05 14:04:13 -0400] meisen: maxmanders: are you using the key file with the same zone you created it for?
[2012-09-05 14:14:12 -0400] krisk: 1/clear
[2012-09-05 14:14:54 -0400] krisk: why does the default knife bootstrap install a .deb on ubuntu/debian machines, that is brutally different from the opscode repositories? e.g. the bootstrapped chef doesn't have an chef-client init-script, etc
[2012-09-05 14:17:21 -0400] rocket: I am trying to debug a chef recipe that I am using vagrant with .. how do I display info level information to console?
[2012-09-05 14:25:03 -0400] behemphi: hey @jessicab are you around, this is Boyd
[2012-09-05 14:31:19 -0400] maxmanders: meisen: ah that might make sense, although the error is a bit misleading; new to ec2 and chef...
[2012-09-05 14:31:39 -0400] maxmanders: meisen: So I should decide which region my image is from, and create a keypair for chef in that region?
[2012-09-05 14:35:23 -0400] maxmanders: meisen: Google suggests that us-west-2 is US West Oregon; keyfile exists for that region in aws, and I'm using that keyfile with -S - so guess that's not it :-(
[2012-09-05 14:38:16 -0400] maxmanders: This is the command line I'm using, showing error and confirming key exists locally - confirmed it exists in aws console http://pastebin.com/Ag7wK0Hu
[2012-09-05 14:48:46 -0400] rshade98: Morning Chefs.. I am thinking about submitting a pull request to chef, and want to see what you guys think
[2012-09-05 14:48:50 -0400] rshade98: https://github.com/rshade/chef/commit/2b7b9a55ffaa1de2a2a302bb5c5a44aec3f969a4
[2012-09-05 14:53:52 -0400] ssd7: rshade98: Might want to check out #chef-hacking as well
[2012-09-05 15:00:58 -0400] maxmanders: Made progress - I was making two mistakes; not creating a key in the appropriate ec2 region; and specifying the local path to the private key rather than the name of the aws key.
[2012-09-05 15:01:33 -0400] maxmanders: Is there a good way to determine which region to create an instance in - I've found a list of images on Ubuntu's site, that specify args for each region - but for some I'm getting errors about being at capacity.
[2012-09-05 15:01:52 -0400] maxmanders: Haven't had much luck finding some sort of resource mapping region codes to region names, ane whether they are accepting new instaces
[2012-09-05 15:02:06 -0400] sampikesley: regions or zones?
[2012-09-05 15:03:22 -0400] maxmanders: sampikesley: apologies, I'm not sure :-( I _thought_ regions were e.g. us-east-1, and each region had a list of AMIs one could use -
[2012-09-05 15:05:05 -0400] sampikesley: right
[2012-09-05 15:05:31 -0400] sampikesley: but you're getting somthing like "us-west-1a over-capacity" pr similar, right?
[2012-09-05 15:06:58 -0400] maxmanders: sampikesley: yeah - so us-west-1a is one of the AZs in the region us-west-1 (aka US Oregon)
[2012-09-05 15:07:36 -0400] maxmanders: sigmonsays: And looking at the aws console I create a keypair for a region, and that keypair is valid for all AZs within that region - so in my command line I need to specify the region _and_ the zone?
[2012-09-05 15:07:54 -0400] sampikesley: so yeah, try us-west-1b
[2012-09-05 15:08:16 -0400] sampikesley: us-east-1a is regularly full, for example
[2012-09-05 15:09:04 -0400] maxmanders: Can't see anything in the knife ec2 options for zone - so do i just specify a specific zone with the region prameter, e.g. --region us-west means any zone; but --region us-west-1b means use a specific region and zone?
[2012-09-05 15:10:13 -0400] maxmanders: boo now getaddr is failing - guess knife doesn't support that region and/or zone yet
[2012-09-05 15:13:47 -0400] sampikesley: -Z us-east-1e
[2012-09-05 15:14:06 -0400] maxmanders: *facepalm* thanks
[2012-09-05 15:14:17 -0400] ugk: hi there...can anyone suggest me whether we can apply a cookbook to multiple nodes?
[2012-09-05 15:14:55 -0400] ugk: is it possible?
[2012-09-05 15:15:15 -0400] Twirrim: that's one of the main points of chef.
[2012-09-05 15:15:24 -0400] cheeseplus: ugk: any node that has the recipe in it's run_list will do exactly that
[2012-09-05 15:15:46 -0400] maxmanders:  Success! sampikesley thanks very much for your help
[2012-09-05 15:16:04 -0400] ugk: okay...but what if i want to have the cookbook applied to two or three nodes at the same time?
[2012-09-05 15:16:07 -0400] maxmanders: It would seem that it was less technical issues that were letting me down, and more a general lack of understanding about regions/zones and how/when to use them
[2012-09-05 15:16:45 -0400] maxmanders: I was doing this for the first time using Knife - but how can one predict or reliably pick a region and zone when scaling and trying to spin up instances programatically?  This took quite some time on the command line
[2012-09-05 15:16:52 -0400] cheeseplus: ugk: is your concern simultaneous application?
[2012-09-05 15:17:27 -0400] cheeseplus: ugk: you could use the "knife ssh" command to login to all the nodes and execute "chef-client" at the same time
[2012-09-05 15:18:16 -0400] cheeseplus: ugk: assuming each of the nodes you "knife ssh" into has the cookbook in it's run_list then they would all execute the convergence simultaneously
[2012-09-05 15:18:31 -0400] ugk: okay...but for that i have to add the runlists one-by-one right?
[2012-09-05 15:19:06 -0400] ugk: i mean for two or three nodes....
[2012-09-05 15:19:16 -0400] sampikesley: chef_environment is your friend
[2012-09-05 15:19:34 -0400] sampikesley: hang on, not even that
[2012-09-05 15:19:48 -0400] cheeseplus: ugk: you could do that several ways - you could bootstrap all the nodes with the cookbook, you could use a role and apply it to the selected nodes, or you could edit them individually
[2012-09-05 15:19:59 -0400] cheeseplus: sampikesley: yea environments don't do run_lists
[2012-09-05 15:20:15 -0400] cheeseplus: sampikesley: you can use env_run_list in node or roles though
[2012-09-05 15:20:30 -0400] sampikesley: think I tied myself in knots, though
[2012-09-05 15:20:36 -0400] sampikesley: backed away slowly
[2012-09-05 15:21:24 -0400] ugk: cool...let me try out with roles first....
[2012-09-05 15:22:02 -0400] ugk: btw..one more clarification....am a beginner and just implemented chef in my office...
[2012-09-05 15:22:20 -0400] ugk: are environments just for versioning and grouping?
[2012-09-05 15:22:33 -0400] sampikesley: they're for anything you want
[2012-09-05 15:22:48 -0400] sampikesley: we have "production", "staging", "dev" and "vagrant"
[2012-09-05 15:22:59 -0400] sampikesley: usually used to pin cookbook versions
[2012-09-05 15:23:46 -0400] sampikesley: we also use the environment name to fill in vhosts and stuff
[2012-09-05 15:24:03 -0400] sampikesley: these also match our rails environments
[2012-09-05 15:24:13 -0400] jasond: are there any guidelines for when to put something in a cookbook vs. a recipe?
[2012-09-05 15:24:24 -0400] sampikesley: um
[2012-09-05 15:24:35 -0400] sampikesley: a cookbook is a bag full of recipes
[2012-09-05 15:24:50 -0400] ugk: okay.....thx all...gonna check that out.....
[2012-09-05 15:25:55 -0400] jasond: sampikesley: i understand that.  i see a lot of people creating an apache2 cookbook.  my first inclination would be to make an apache2 recipe instead of an apache2 cookbook
[2012-09-05 15:26:12 -0400] sampikesley: recipe has to live somewhere, though
[2012-09-05 15:26:42 -0400] sampikesley: unless you wanna put all your different recipes into one big cookbook
[2012-09-05 15:26:50 -0400] sampikesley: strikes me as a bad idea
[2012-09-05 15:27:17 -0400] jasond: sampikesley: so you make a cookbook for each piece of software you're configuring?
[2012-09-05 15:27:39 -0400] cheeseplus: jasond: that is often the case
[2012-09-05 15:27:54 -0400] jasond: if i did that, i'd end up with a lot of cookbooks that only have a default.rb recipe
[2012-09-05 15:28:26 -0400] cheeseplus: that is how the community cookbooks work, but is by no means a rule
[2012-09-05 15:28:38 -0400] cheeseplus: usually recipes offer something else related to the core cookbook
[2012-09-05 15:29:05 -0400] geekbri: jasond: what happens when you have two different servers using your big cookbook full of recipes and each needs a change to the cookbook but one needs to be tested longer than the other?
[2012-09-05 15:29:10 -0400] sampikesley: jasond: that's OK though
[2012-09-05 15:29:13 -0400] jasond: cheeseplus: where can i read more about this idea of a "core" cookbook?
[2012-09-05 15:29:28 -0400] sampikesley: I think you robably want a core role
[2012-09-05 15:29:33 -0400] cheeseplus: for example, the apache one has a default that just does apache and there are recipes for each module
[2012-09-05 15:29:50 -0400] cheeseplus: sampikesley: http://wiki.opscode.com/display/chef/Cookbook+Style+Guide+Draft
[2012-09-05 15:29:52 -0400] sampikesley: oh I see
[2012-09-05 15:29:54 -0400] cheeseplus: that is one resource I've used
[2012-09-05 15:30:47 -0400] cheeseplus: sampikesley: it all depends on your problem scope, how many community cookbooks you would like to make use of, and how modular you'd like to go
[2012-09-05 15:31:05 -0400] cheeseplus: that draft style guide was for jasond, not sampikesley ;)
[2012-09-05 15:31:53 -0400] jasond: cheeseplus: thanks
[2012-09-05 15:32:31 -0400] cheeseplus: I'd also look at existing opscode cookbooks to get an idea of how to break up cookbooks into recipes and when to write multiple cookbooks
[2012-09-05 15:32:50 -0400] jasond: so a set of cookbooks is usually for a specific environment (set of servers)?
[2012-09-05 15:33:17 -0400] sampikesley: there is not Best Practice
[2012-09-05 15:33:21 -0400] sampikesley: we're all making it up
[2012-09-05 15:33:24 -0400] sampikesley: but
[2012-09-05 15:33:46 -0400] sampikesley: a specific environment will probably have a set of cookbook *versions*
[2012-09-05 15:34:05 -0400] sampikesley: like, asume *all* of your boxen will want nginx
[2012-09-05 15:34:29 -0400] sampikesley: but you'll want to pin your production nodes to a known good test-passing cookbook version
[2012-09-05 15:35:11 -0400] sampikesley: and maybe your dev boxen (in the "dev" chef_environment) are OK with your flaky-as-Hell may-display-kittens version
[2012-09-05 15:35:56 -0400] sampikesley: that, at least, is how we use chef_environment over here
[2012-09-05 15:35:57 -0400] pabst^: ok, so I've installed a cookbook to my workstation that apparently requires a lot of other cookbooks. No problem, sorta. When I use knife to upload the cookbook it keeps telling me about the next required cookbook. 1. Why doesn't it list all of the missing cookbooks that are required? 2. Can you just say "Hey, install this cookbook, and whatever else it needs?" when specifying a cookbook to install?
[2012-09-05 15:36:07 -0400] sampikesley: yes
[2012-09-05 15:36:09 -0400] sampikesley: yes you can
[2012-09-05 15:36:25 -0400] geekbri: I use librarian-chef for such things :)
[2012-09-05 15:36:32 -0400] jasond: sampikesley: makes sense for dev/prod/test environments, but i meant completely different environments, as in different companies
[2012-09-05 15:36:39 -0400] sampikesley: oh
[2012-09-05 15:36:40 -0400] sampikesley: hmm
[2012-09-05 15:36:42 -0400] pabst^: I figured there was a way to do so, I just figured I was missing it somewhere
[2012-09-05 15:37:06 -0400] yfeldblum_: you should probably build cookbooks & recipes oriented around *intentions*, not around implementations
[2012-09-05 15:37:10 -0400] sampikesley: jasond: that's why you break your stuff out into different cokbooks
[2012-09-05 15:37:23 -0400] sampikesley: and write them all using cuke-chef
[2012-09-05 15:37:28 -0400] sampikesley: because awesome
[2012-09-05 15:38:27 -0400] yfeldblum_: just because a recipe needs apache2 doesn't mean you need to have another recipe named apache2 - the important point is to have a recipe oriented around the intention, and there are many ways to do the implementation like just installing apache2 from within your recipe
[2012-09-05 15:38:45 -0400] jmara:  hey there, how do I reference an internal dependency in foo::bar that foo has to be processed first and in case someone only put foo::bar to the run_list the chef-run stops?
[2012-09-05 15:38:49 -0400] yfeldblum_: intention > implementation, especially when it comes to naming
[2012-09-05 15:38:56 -0400] yfeldblum_: and when it comes to organization
[2012-09-05 15:39:19 -0400] sampikesley:   Scenario: nginx has been installed
[2012-09-05 15:39:19 -0400] sampikesley:     * package "nginx" should be installed
[2012-09-05 15:39:29 -0400] sampikesley: that's all you need to care about
[2012-09-05 15:39:36 -0400] sampikesley: then make your cookbook pass that test
[2012-09-05 15:39:41 -0400] yfeldblum_: jasond, my approach would be to use multiple chef-servers, or multiple organizations in hosted-chef
[2012-09-05 15:39:58 -0400] yfeldblum_: jasond, and probably multiple chef-repos, which may actually share cookbooks between them
[2012-09-05 15:41:04 -0400] jasond: yfeldblum_: ah ok.  good ideas.  BTW, i'm using chef-solo
[2012-09-05 15:41:08 -0400] yfeldblum_: jasond, and if a cookbook needs a change for one customer and a conflicting change for another customer, what you've wandered into is a bad abstraction, which means you need to split the cookbook into the generic bit and the customer-specific bits, or make the cookbook more generic and configurable
[2012-09-05 15:41:50 -0400] yfeldblum_: jasond, sure, same principles apply of course, if they are just to be applied differently
[2012-09-05 15:42:36 -0400] jasond: yfeldblum_ cheeseplus sampikesley: thanks for the advice.  i have a lot to think about
[2012-09-05 15:47:38 -0400] Loof: I've run into a really odd issue provisioning an Ubuntu server... my bootstrap script doesn't seem run as root even though everything shows it should be
[2012-09-05 15:48:00 -0400] Loof: I spit out the command...and it's doing 'sudo bash -c ...'
[2012-09-05 15:48:13 -0400] Loof: Yet I get permission denied errors all over the place
[2012-09-05 15:48:29 -0400] Loof: I ran into this once before... and it seemed to simply fix itself
[2012-09-05 15:48:53 -0400] Loof: I provisioned some servers yesterday...and didn't have the problem
[2012-09-05 15:48:57 -0400] Loof: then today I'm seeing it again
[2012-09-05 15:52:03 -0400] Loof: Any ideas what might be going on?
[2012-09-05 15:52:11 -0400] pabst^: chef has honestly become my favorite thing on earth
[2012-09-05 15:55:07 -0400] makerbreakr: anyone familiar with the spice gem?
[2012-09-05 15:55:38 -0400] makerbreakr: i missing the pattern, on how to put a new cookbook into a particular nodes run list
[2012-09-05 15:57:10 -0400] yfeldblum_: makerbreaker, fetch the node; append to its env_run_list/_default property (  node_hash["env_run_lists"]["_default"] << "recipe[some-cookbook::some-recipe]"  ) and save the node?
[2012-09-05 15:59:03 -0400] makerbreakr: it doesnt look like spice fetches the run list
[2012-09-05 15:59:04 -0400] makerbreakr: https://gist.github.com/3638987
[2012-09-05 16:00:25 -0400] makerbreakr: ok....Spice.get("/nodes/nodename") gets it
[2012-09-05 16:12:32 -0400] _0x783czar: So, in one recipe, I create a sudo users group.  Later in another recipe I need to loop through all the members in that group.  I realize that I can read that information from ohai, but I don't want it to cause an error at compile time if I do it outside of a ruby_block.  However I don't know what I can do to avoid that since I need the information to govern my loop control.
[2012-09-05 16:12:55 -0400] _0x783czar: not sure if that makes sense, let me know if you'd like to explain something better.
[2012-09-05 16:14:59 -0400] pwf: is there a command that would loop through all the nodes in an environment, compile a list of cookbooks used by those nodes, and then freeze the environment to the current versions of those cookbooks?
[2012-09-05 16:15:03 -0400] pwf: because that would be awesome.
[2012-09-05 16:15:04 -0400] yfeldblum_: _0x783czar, why?
[2012-09-05 16:15:53 -0400] yfeldblum_: pwf, not to my knowledge, but there's nothing stopping you from building one
[2012-09-05 16:16:11 -0400] pwf: except my other responsibilities :(
[2012-09-05 16:17:31 -0400] _0x783czar: yfeldblum_: well, correct me if I'm wrong, but if I try to read a node attribute outside of a ruby block, it will do it at compile time.  So If I'm trying to read the members of group that wont exist until another recipe runs, I figured I'd run into some problems.
[2012-09-05 16:22:26 -0400] yfeldblum_: _0x783czar, the first statement is true; the second statement completely depends on what you mean by "problems"
[2012-09-05 16:23:02 -0400] geekbri: Perhaps that is just a sign that user management should be higher up in your run list
[2012-09-05 16:23:29 -0400] _0x783czar: yfeldblum_: well I'd imagine my chef run would crash, when it tries to read the members of the group
[2012-09-05 16:23:39 -0400] _0x783czar: at complie time
[2012-09-05 16:24:13 -0400] _0x783czar: geekbri: what do you mean?
[2012-09-05 16:24:22 -0400] yfeldblum_: _0x783czar, also, chef-client (or chef-solo) will start by executing all recipes in the node's run-list; once *all* the recipes are finished running, and have *declared multiple resources*, chef will inspect the state of the system, compare it to the list of resources declared in all the recipes in the run-list, and converge the system to be compliant with the list of resources
[2012-09-05 16:24:55 -0400] yfeldblum_: _0x783czar, your task, as an infra developer using chef, is to figure out how to structure your infra into a list of resources
[2012-09-05 16:25:08 -0400] yfeldblum_: _0x783czar, and how to back these resources with provider implementations
[2012-09-05 16:26:39 -0400] yfeldblum_: _0x783czar, a resource is *merely* a type, a name, and a set of attributes; a resource *does not alter the system* and declaring a resource in a recipe *does not alter the system*
[2012-09-05 16:27:27 -0400] _0x783czar: yfeldblum_: OK, maybe I'm missing something fundamental here.
[2012-09-05 16:28:41 -0400] _0x783czar: yfeldblum_: My company is trying to use Chef to do initial configuration of our system and prevent "config drift"
[2012-09-05 16:29:25 -0400] _0x783czar: yfeldblum_: So right now my task is to translate all our configuration scripts into recipes and cookbooks.
[2012-09-05 16:29:49 -0400] _0x783czar: yfeldblum_: maybe I'm still thinking of this from a script perspective.
[2012-09-05 16:29:59 -0400] yfeldblum_: _0x783czar, indeed i can tell :D
[2012-09-05 16:30:18 -0400] _0x783czar: yfeldblum_: well thanks for being patient with me
[2012-09-05 16:30:21 -0400] yfeldblum_: _0x783czar, which is a problem when you move to chef
[2012-09-05 16:30:34 -0400] yfeldblum_: _0x783czar, because chef is very very far from a "step 1 ; step 2 ; step 3 ; step 4" model
[2012-09-05 16:31:36 -0400] yfeldblum_: _0x783czar, the chef model is that, right up front before any changes to the system are done, you declare the final state of how the system should look (by means of listing multiple resources and their attributes)
[2012-09-05 16:32:23 -0400] _0x783czar: yfeldblum_: OK, I'll look over that "anatomy of a chef run" document again.
[2012-09-05 16:32:31 -0400] yfeldblum_: _0x783czar, then what chef does, after you do all the listing of resources in your recipes, is it looks at your lest, goes one-by-one, checks whether the system needs to be changed, and if so changes the system to comply with that resource
[2012-09-05 16:32:45 -0400] yfeldblum_: _0x783czar, but all of the changing happens long long long after all the recipe-running
[2012-09-05 16:32:59 -0400] yfeldblum_: _0x783czar, so your goal is to figure out how to *tell chef everything up-front*
[2012-09-05 16:33:11 -0400] _0x783czar: yfeldblum_: gottcha
[2012-09-05 16:33:52 -0400] yfeldblum_: _0x783czar, for people used to writing shell scripts, this is of course a real adjustment
[2012-09-05 16:34:05 -0400] _0x783czar: yfeldblum_: definitely
[2012-09-05 16:34:12 -0400] _0x783czar: yfeldblum_: although I see the advantage
[2012-09-05 16:34:40 -0400] yfeldblum_: _0x783czar, the model you may be used to is the procedural model, while the model chef uses is the convergent model
[2012-09-05 16:35:17 -0400] slam-: hey, any possible reason for a search in a recipe to return results in a different order sometimes ? it makes config files to be regenerated, and services to be restarted when its not needed
[2012-09-05 16:35:41 -0400] yfeldblum_: _0x783czar, i went through the same learning curve, of course, so i can only be patient :D
[2012-09-05 16:36:15 -0400] yfeldblum_: slam-, yes, every reason, and you should never depend on the order of the results from a query unless you specified what the order should be in the query
[2012-09-05 16:36:54 -0400] slam-: its a simple search, and a simple "each" in the template
[2012-09-05 16:36:55 -0400] yfeldblum_: slam-, differing orders is a real concern, and so i would suggest that you explicitly sort the results yourself (since chef-server-api doesn't do it yet) when the order matters
[2012-09-05 16:37:29 -0400] yfeldblum_: slam-, results = search(:node, "some-key:some-value").sort_by(&:fqdn)
[2012-09-05 16:37:40 -0400] slam-: order matters only because we don't want services to be restarted when its not needed =)
[2012-09-05 16:37:43 -0400] yfeldblum_: slam-, results = search(:node, "some-key:some-value").sort_by{|n| n["fqdn"]}
[2012-09-05 16:37:48 -0400] slam-: or, thanks for the tip
[2012-09-05 16:38:17 -0400] _0x783czar: yfeldblum_: haha, thanks.  I think in this particular issue, my problem is that I'm used to re using as much information as I can.  So if in an earlier step I write some data I can reuse down the road, I jump at the chance.  But I can see that using the "description" or convergence model is going to take a different approach. hah
[2012-09-05 16:38:40 -0400] yfeldblum_: _0x783czar, yep
[2012-09-05 16:39:47 -0400] yfeldblum_: _0x783czar, so i might suggest figuring out beforehand, in code, what the list of users must be; then declaring a user resource for each user; and finally declaring other resources later on with the same list of users;
[2012-09-05 16:41:07 -0400] _0x783czar: yfeldblum_: Alright, I already built a databag for all my users.  I guess I can use that to define what groups they should belong in instead of trying to read them directly from the node.
[2012-09-05 16:41:59 -0400] _0x783czar: yfeldblum_: I think that would fit the "describe the system" model better
[2012-09-05 16:42:26 -0400] yfeldblum_: _0x783czar, now you're thinking!
[2012-09-05 16:42:45 -0400] yfeldblum_: _0x783czar, i mean, now you're thinking of it in the convergent model chef uses :D
[2012-09-05 16:43:13 -0400] _0x783czar: yfeldblum_: awesome, thanks
[2012-09-05 16:43:25 -0400] _0x783czar: time to go explain this to the CTO :p
[2012-09-05 16:43:34 -0400] yfeldblum_: _0x783czar, heh
[2012-09-05 16:43:58 -0400] JoshuaMiller: "I'm working on it.  It's complicated."
[2012-09-05 16:44:11 -0400] yfeldblum_: _0x783czar, and if he has any questions about how this works i may be able to answer some of those questions too
[2012-09-05 16:44:39 -0400] _0x783czar: JoshuaMiller: haha, yup
[2012-09-05 16:45:09 -0400] _0x783czar: yfeldblum_: OK, I think he'll get it, but he hops on once in awhile so I'll let him know.
[2012-09-05 16:47:27 -0400] Loof: _0x783czar: Ok, this is probably not ideal... but simply let's say you have a shell script that installs an app that you pull from git... you can keep it as a shell script bash "install_app" ... then in your git settings you 'notify' the install_app to run.
[2012-09-05 16:48:06 -0400] yfeldblum_: Loof, sure
[2012-09-05 16:48:08 -0400] Loof: _0x783czar: Thus every time you pull a new version... you install it.
[2012-09-05 16:48:19 -0400] Loof: Eventually that can get broken out into individual resources
[2012-09-05 16:48:26 -0400] Loof: but you don't -have- to to make Chef work well
[2012-09-05 16:48:40 -0400] yfeldblum_: Loof, right
[2012-09-05 16:49:45 -0400] JoshuaMiller: Data bags - is their purpose for storing attributes that don't fit the node / role / environment mold?
[2012-09-05 16:50:38 -0400] jbz: JoshuaMiller: Sure, although I would say 'data' and not 'attributes' precisely because it doesn't fit the attribute model.
[2012-09-05 16:51:10 -0400] jbz: JoshuaMiller:  Databags are really useful if you have information that the node should select from among options that aren't tied to the node's identity
[2012-09-05 16:51:39 -0400] jbz: for example, if you have config data for a website but you don't have nodes which only run that website
[2012-09-05 16:51:58 -0400] jbz: like, if you have 20 nodes that are role 'webserver' but only 3 or 4 of them happen to serve that particular website
[2012-09-05 16:52:08 -0400] jbz: then databags are a good way to get the website config info to those nodes.
[2012-09-05 16:53:33 -0400] yfeldblum_: JoshuaMiller, data bags are *just* a central database to store whatever you want to store
[2012-09-05 16:53:51 -0400] yfeldblum_: JoshuaMiller, think of data-bags as like tables in a mysql database, and data-bag items as like the records in those tables
[2012-09-05 16:54:12 -0400] yfeldblum_: JoshuaMiller, you get to design the tables: what columns they have, what types of data go into them, etc
[2012-09-05 16:54:35 -0400] Loof: I'm officially a moron
[2012-09-05 16:54:39 -0400] Loof: I had a comment with a ' in it
[2012-09-05 16:54:41 -0400] JoshuaMiller: Huzzah!
[2012-09-05 16:54:43 -0400] Loof: don't :P
[2012-09-05 16:54:53 -0400] Loof: in my bootstrap script :P
[2012-09-05 16:56:59 -0400] Loof: Looks like I've got it now :)
[2012-09-05 16:59:04 -0400] Loof: One thing I'm still pondering... I've got to upgrade chef as part of my bootstrap... I'm using system pkg chef so it's using aptitude to update the source list and install chef... in bootstrap
[2012-09-05 16:59:20 -0400] Loof: Does anyone have a better idea on handling that... maybe caching the dpkg in chef somehow
[2012-09-05 16:59:31 -0400] Loof: but this is obviously in pure shell BEFORE the chef run
[2012-09-05 17:03:51 -0400] JoshuaMiller: Loof, since it's in shell, is your question how to update the chef pkg in shell?
[2012-09-05 17:04:23 -0400] JoshuaMiller: i.e the shell command with apt to update a package?
[2012-09-05 17:09:16 -0400] Loof: JoshuaMiller: No, I already know that... if there's a smarter way to curate 'my chef package' instead of 'update the list of all packages' and 'install chef from some repo' at bootstrap time
[2012-09-05 17:09:41 -0400] Loof: It would be smarter for me to have the dpkg somewhere on my chef server... and just keep that up to date
[2012-09-05 17:16:07 -0400] JoshuaMiller: Loof: Are you not running your own package repo?
[2012-09-05 17:17:10 -0400] JoshuaMiller: Loof: i.e. your systems are configured to reach out to external / third-party package repos?
[2012-09-05 17:17:33 -0400] eroc: I'm writing a custom provider. It will need to download a temporary file. Is there a chef convention for where this file should go? It does not need to persist after the agent runs.
[2012-09-05 17:18:23 -0400] jbz: eroc: We use /tmp because it will reliably be there. :-)
[2012-09-05 17:18:35 -0400] jbz: But that assumes you don't care if people see it.
[2012-09-05 17:19:52 -0400] eroc: jbz: That was my first thought as well. I noticed that chef has a cache and a sandbox path as well. Would either of those be appropriate? In our scenario, tmp is actually on a fairly space-constrained drive, so I'm wondering if another place makes sense.
[2012-09-05 17:20:04 -0400] yfeldblum_: eroc, you might consider using `Dir.tmpdir` to get the name of the temp directory; if it needs to be root-accessible only, you can make a subdir owned by root with a long cryptorandom name and clamp down the perms
[2012-09-05 17:20:39 -0400] yfeldblum_: eroc, unless you know how chef uses these dirs, it may not be advisable to use them yourself
[2012-09-05 17:21:21 -0400] eroc: yfeldblum_: Agreed that I won't want to use them unless I understand them. I'll check out Dir.tmpdir.
[2012-09-05 17:21:52 -0400] yfeldblum_: eroc, `sub_tmp_dir = Pathname("#{Dir.tmpdir}/#{SecureRandom.hex(16)}") ; sub_tmp_dir.mkpath ; at_exit { sub_tmp_dir.rmtree } ; ...`
[2012-09-05 17:22:20 -0400] yfeldblum_: eroc, not necessarily the best approach, but one you can take a look at
[2012-09-05 17:22:34 -0400] eroc: yfeldblum_:Nice. Thanks.
[2012-09-05 17:22:37 -0400] Loof: JoshuaMiller: Nope, not running own repo at this point
[2012-09-05 17:22:47 -0400] Loof: JoshuaMiller: I'm on EC2... so there's a nice and fast 'local' repo
[2012-09-05 17:22:50 -0400] yfeldblum_: eroc, on linux Dir.tmpdir is obviously "/tmp" unless you've set the env var "TMP" or "TMP_DIR" somewhere else
[2012-09-05 17:23:22 -0400] eroc: Yeah, that's what I figured.
[2012-09-05 17:26:02 -0400] JoshuaMiller: Loof: our model has been to manage packages by having our own repo.  It's not hard with yum, but I can't speak for apt
[2012-09-05 17:27:18 -0400] Loof: JoshuaMiller: That's fine too... I don't have time for that this week... my question is if there's a smarter way to upgrade the package 'in place' without actually using apt-get/aptitude
[2012-09-05 17:27:30 -0400] Zenigor: I am currently looking to build a new chef server based on ubuntu 12.04 LTS. I will leave my current chef server up until my new one is built. Question is, do I need to re-bootstrap each server against my new chef server or can I just re-bind them to the new server?
[2012-09-05 17:27:46 -0400] Loof: Then I'd have to deal with dependencies in any case
[2012-09-05 17:28:34 -0400] miah: hi
[2012-09-05 17:32:47 -0400] jmahowald: Was going to update my chef server now that there's an apache proxy recipe, but in our environment it's a process to upgrade the actual ruby gem version of chef.  My issue is that the tarred up cookbooks referenced here:
[2012-09-05 17:32:48 -0400] jmahowald: http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
[2012-09-05 17:33:13 -0400] jmahowald: don't work with chef 10.6 because default_action is not valid in the LWRP for bluepill
[2012-09-05 17:33:36 -0400] jmahowald: Was hoping to browse for other tar balls that might work for my version, but the s3 directory doesn't have that enabled.
[2012-09-05 17:33:55 -0400] Loof: Ok, before I start writing a bunch of custom ruby... is there a smart way to leverage knife commands in a batch process... that is, I have a knife command to create an ec2 image... there's the existing knife command to start a new ec2 server...etc
[2012-09-05 17:33:56 -0400] jmahowald: And I couldn't find the process by which that bootstrap was created. I can probably create my own
[2012-09-05 17:34:15 -0400] jmahowald: but thought that the instructions at least should be updated to say how to get other versions of the bootstrap tarball
[2012-09-05 17:34:16 -0400] jmahowald: l
[2012-09-05 17:34:38 -0400] Loof: I'm curious if maybe tehre's an option I might be missing to make these play well with bash... or to return useful results called as a method
[2012-09-05 17:35:28 -0400] Loof: What I'm trying to do is either set an environment variable... or get back a hash/variable in ruby... that tells me the ami that was created by the knife command... the instance that was created...etc
[2012-09-05 17:35:32 -0400] Loof: so I can chain them one to the other
[2012-09-05 17:35:35 -0400] Loof: automate the full process
[2012-09-05 17:37:51 -0400] maxmanders: I've edited a recipe and uploaded it to hosted chef using knife cookbook upload mysql - appears to have worked. Removed /var/chef/cache and sudo chef-client on ec2 instance - it fails for some reason I'm still debugging - but the cookbook in /var/chef/cache/cookbooks isn't the newest one that I uploaded...
[2012-09-05 17:38:46 -0400] maxmanders: I thought deleting /var/chef/cache and then doing sudo chef-client would fetch fresh copies of cookbooks from the opscode hosted chef server
[2012-09-05 18:28:48 -0400] fish_: wondering if someone ever installed chef from debs on squeeze. I'm getting unmet dependencies all the time
[2012-09-05 18:29:32 -0400] fish_: I've pinned the opscode source to 600, the nI could install chef-solr but for other parts I still get unmet dependencies
[2012-09-05 18:30:16 -0400] fish_: although I'm not completely sure why, when I try to install chef-server-api the unmout dependencies are rabbitmq-server (>= 1.6) and chef-solr (>= 10.12.0) - but both packages are already installed
[2012-09-05 18:31:03 -0400] fish_: chef-solr is 10.12.0-1 and rabbitmq-server is 2.8.1-1 (which should met >=1.6 I guess)
[2012-09-05 18:48:24 -0400] smcg: hi. is there a way to make chef solo log its output? like a flag?
[2012-09-05 18:49:39 -0400] smcg: I am aware I could pipe the output to a file but that isn't ideal in this scenario.
[2012-09-05 18:50:36 -0400] jordane: smcg: -L, --logfile LOGLOCATION
[2012-09-05 18:50:58 -0400] smcg: lovely. thank you.
[2012-09-05 18:59:37 -0400] smurfy: hello i am setting an custom attribute on my node during the bootstrap process via json file passed to chef-client - should that attribute be immediately available for use in a recipe/template? it is coming up as nil
[2012-09-05 19:11:58 -0400] ranjibd: ohai
[2012-09-05 19:13:38 -0400] halcyonCorsair: when using the execute resource, cwd doesn't appear to be acting as expected, can anyone help me figure out why?
[2012-09-05 19:23:40 -0400] BryanWB: ohai chefs!
[2012-09-05 19:27:22 -0400] xmltok:  is there not a way to ensure that every node that connects to my chef server gets applied my base role?
[2012-09-05 19:27:40 -0400] xmltok: i basically want to remove as many command line parameters that people need to manage when they build out a node
[2012-09-05 19:28:04 -0400] forestbird: with bootstrap?
[2012-09-05 19:28:08 -0400] xmltok: im even looking into ways to append roles through my base role, if the hostname matches different regex
[2012-09-05 19:28:26 -0400] BryanWB: xmltok, a rake task?
[2012-09-05 19:28:31 -0400] xmltok: yeah, essentially someone needs to add -r role[base] to every knife bootstrap or cs server create command
[2012-09-05 19:28:43 -0400] BryanWB: xmltok, i think u want a thorfile
[2012-09-05 19:29:14 -0400] xmltok: oh so instead of someone running knife cs server create, they would thor create - or something like that
[2012-09-05 19:29:20 -0400] xmltok: im not very familiar with thor
[2012-09-05 19:29:49 -0400] BryanWB: yup
[2012-09-05 19:30:06 -0400] BryanWB: it is extends Rake iirc
[2012-09-05 19:30:11 -0400] xmltok: ok
[2012-09-05 19:30:24 -0400] BryanWB: ppl more experienced than myself like it lots
[2012-09-05 19:30:31 -0400] geekbri: its a rake replacement.  A yehuda katz special
[2012-09-05 19:30:40 -0400] BryanWB: ykatz very smaaat
[2012-09-05 19:30:48 -0400] geekbri: the syntax is very rake like
[2012-09-05 19:31:08 -0400] geekbri: https://github.com/wycats/thor
[2012-09-05 19:32:05 -0400] Maniacal: does any one know if the json passed in via the cli for a chef-client run is stored in an object or something that can be accessed during the chef run?
[2012-09-05 19:32:06 -0400] Jay_Levitt: Anyone deploying CrashPlan with chef?
[2012-09-05 19:32:07 -0400] geekbri: xmltok: alternatively you could create your own knife plugin that piggybacks on other ones in an attempt to reduce what people have to type
[2012-09-05 19:32:26 -0400] xmltok: so if i wanted to add roles based on hostnames, maybe set environment or whatever- its recommended to use thor to fetch the roles and apply them if they match my rules when it bootstraps
[2012-09-05 19:32:30 -0400] BryanWB: Maniacal, i believe it is accessible
[2012-09-05 19:32:38 -0400] ranjibd: halcyonCorsair, pastebin?
[2012-09-05 19:32:49 -0400] xmltok: yeah it may be better to create a knife plugin
[2012-09-05 19:32:53 -0400] xmltok: good idea
[2012-09-05 19:32:55 -0400] geekbri: xmltok:  I dont know, that might be a job for a knife plugin potentially.
[2012-09-05 19:32:56 -0400] BryanWB: but i can't remember exactly how to get to it
[2012-09-05 19:33:08 -0400] Maniacal: Ok.  maybe I need to dig into the code a bit
[2012-09-05 19:33:30 -0400] BryanWB: u will want to uatomate lots of little tasks, i recommend getting started w/ thor
[2012-09-05 19:33:37 -0400] BryanWB: we have a Rakefile
[2012-09-05 19:34:04 -0400] xmltok: not so much automate some tasks, i just want to apply a default set of role/envirnoment rules to nodes based on their hostname
[2012-09-05 19:34:32 -0400] xmltok: basically if its app1production.example.com, it would' get the role[app1] and production environment applied automatically
[2012-09-05 19:35:07 -0400] geekbri: You just want a tool to do that when you create a server right, you can't looking for something to crawl your infra and enforce a set of rules?
[2012-09-05 19:35:23 -0400] xmltok: right, i only care about new nodes
[2012-09-05 19:35:30 -0400] xmltok: if someone breaks their node later, not my concern
[2012-09-05 19:36:08 -0400] geekbri: you could use thor for something like that, because youre basically just trying to save them from having to know what knife server create stuff to call.
[2012-09-05 19:36:27 -0400] halcyonCorsair: ranjibd: it seems to be related to the argument attribute: http://paste.dollyfish.net.nz/b39371
[2012-09-05 19:36:43 -0400] geekbri: i mean its a personal preference thing at that point, you could even do that in bash if you liked to torture yourself
[2012-09-05 19:36:58 -0400] xmltok: true
[2012-09-05 19:37:31 -0400] xmltok: thor is just one more thing for me to figure out though. i already have a knife plugin for creating servers, all i really need to do is extend it to apply some defaults (role[base]) and append things if they match some regex
[2012-09-05 19:37:35 -0400] geekbri: I mean here at my company we have a knife plugin that consumes a yml file with some definitions and other settings, with environmental overrides. Basically to do what you are doing
[2012-09-05 19:37:47 -0400] xmltok: yeah exactly
[2012-09-05 19:37:53 -0400] xmltok: unless i can do these things ina cookbook?
[2012-09-05 19:38:00 -0400] xmltok: with ohai i suppose
[2012-09-05 19:38:06 -0400] xmltok: like have ohai change the environment and run list
[2012-09-05 19:38:15 -0400] geekbri: I think right here we have a "there are many ways to skin a cat" scenario :)
[2012-09-05 19:38:43 -0400] xmltok: the more i can put in cookbooks and keep out of custom gems the better
[2012-09-05 19:38:51 -0400] xmltok: its more obvious whats going on there
[2012-09-05 19:39:00 -0400] Jay_Levitt: You could write a plugin to fire off a mechanical turk request to pay someone to edit the run list!
[2012-09-05 19:39:03 -0400] geekbri: I mean I dont see how doing it in a cookbook really helps you.
[2012-09-05 19:39:16 -0400] geekbri: they would still need to know to add that cookbook, and if they are adding a cookbook why not just have an app role
[2012-09-05 19:39:23 -0400] xmltok: well if its in a cookbook then it happens automatically, regardless of if someone screws up their knife plugins
[2012-09-05 19:41:22 -0400] xmltok: https://github.com/sbates/Chef-odds-n-ends/blob/master/ohai/parse_host_plugin.rb this appears to nail down the environment piece
[2012-09-05 19:42:25 -0400] xmltok: actually that may not be the same environment as what chef sees as environments
[2012-09-05 19:47:34 -0400] BryanWB: hey Cope!
[2012-09-05 19:50:58 -0400] mhalligan: I'm trying to install the ruby-shadow gem using the omnibus packages, and it fails to compile missing -lshadow. any idea what corresponding ubuntu package needs installed?
[2012-09-05 19:54:36 -0400] jordane: mhalligan: do you have build-essential installed?
[2012-09-05 19:54:58 -0400] mhalligan: oh, huh. I don't. wtf.
[2012-09-05 19:55:28 -0400] mhalligan: hrm I wonder if the run on these servers failed halfway through. note to self, put node.save every other line in every cookbook.
[2012-09-05 19:55:59 -0400] mhalligan: so weird, it's defined in the role, and it just isn't getting run.
[2012-09-05 19:56:14 -0400] mhalligan: thanks
[2012-09-05 19:57:32 -0400] mhalligan: oh I see. it's failing because "build-essential": { "completive":"true"} should install build-essential during compile time, right?
[2012-09-05 19:58:38 -0400] angrybit: I'm working on my first recipe.  I'm looking at the opscode user cookbook.  https://github.com/opscode/cookbooks/tree/master/users   I'd like to use the recipe (include_recipe) but override the data bag name, group name, etc, much like the example in readme.  But I'm having trouble understanding the interplay between the opscode recipe and my custom recipe that includes it.
[2012-09-05 20:02:37 -0400] angrybit: So my recipe looks like this https://gist.github.com/3643646.  But it appears to be running the default opscode recipe as well, as I get this error when I run on my node.  "users_manage[sysadmin] (users::sysadmins line 23) had an error: Net::HTTPServerException: 404 "Object Not Found""
[2012-09-05 20:05:22 -0400] bluepojo: include_recipe runs the recipe
[2012-09-05 20:05:30 -0400] behemphi: Alrighty, i want to write my <embarrassed> first </embarrassed> report handler.
[2012-09-05 20:05:33 -0400] bluepojo: as if you'd copied and pasted the recipe into your code
[2012-09-05 20:05:36 -0400] behemphi: is there a good place to look for an example
[2012-09-05 20:05:42 -0400] bluepojo: angrybit: ^
[2012-09-05 20:07:12 -0400] angrybit: bluepojo: thanks.  if i want to use all the supporting files of a cookbook but not run any recipes from that cookbook, what's the proper approach?  i'd rather not fork the opscode cookbook and modify it directly.  i'd rather include the cookbook and write my own recipe.
[2012-09-05 20:07:30 -0400] bluepojo: in that case just put a "depends" line in your metadata.rb
[2012-09-05 20:08:10 -0400] bluepojo: that will let you use libraries, definitions, etc. from that cookbook without running any of the recipes
[2012-09-05 20:08:38 -0400] angrybit: bluepojo: gotcha.  thank you.
[2012-09-05 20:10:30 -0400] Majost1: is there a chef built-in for apt-get upgrade or dist-upgrade?
[2012-09-05 20:18:17 -0400] miah: is there an attribute to declare if you are on open/hosted/private chef?
[2012-09-05 20:20:37 -0400] jessicab: miah: for what? chef-client? it treats them all the same really, just the chef_server_url gets altered to point to a different one
[2012-09-05 20:24:10 -0400] miah: i mean, for recipes. so i can determine if certain features are available.
[2012-09-05 20:24:26 -0400] miah: eg, hosted chef & partial search
[2012-09-05 20:25:03 -0400] yfeldblum_: miah, sounds to me like that's prone to failure
[2012-09-05 20:25:13 -0400] miah: yfeldblum_: ya. just a thought
[2012-09-05 20:25:13 -0400] yfeldblum_: miah, like: going to fail hard hard hard
[2012-09-05 20:25:20 -0400] yfeldblum_: miah, do it explicitly
[2012-09-05 20:25:53 -0400] yfeldblum_: miah, in your _default env, can you set a default-level attr including the features available, or rather, that recipes are allowed to use?
[2012-09-05 20:26:13 -0400] miah: hrm that would be one way
[2012-09-05 20:26:52 -0400] yfeldblum_: miah, like: default_attributes({"chef" => {"features" => {"partial_search" => true}}})
[2012-09-05 20:26:59 -0400] miah: ya
[2012-09-05 20:27:57 -0400] yfeldblum_: miah, hmmm are you allowed to alter the _default chef-env?
[2012-09-05 20:28:36 -0400] miah: allowed?
[2012-09-05 20:31:55 -0400] yfeldblum_: miah, i mean is the _default chef-env frozen?
[2012-09-05 20:32:08 -0400] yfeldblum_: miah, so that you can't edit it?
[2012-09-05 20:32:22 -0400] yfeldblum_: miah, i don't think so
[2012-09-05 20:32:30 -0400] yfeldblum_: miah, anyway nvm about that
[2012-09-05 20:33:08 -0400] yfeldblum_: miah, and if you're using a base role that every node gets in its run-list, that attribute can go into the base role too
[2012-09-05 20:38:09 -0400] _pol: If a template block has a "notifies :restart" directive in it, will that restart happen every time or only if that template has changed?
[2012-09-05 20:38:33 -0400] _pol: Do I need to include a not_if or if block to prevent that restart from happening?
[2012-09-05 20:39:01 -0400] countdigi: only if there is a change afaik
[2012-09-05 20:39:29 -0400] countdigi: behind the scenes resource_updated only is signalled if the checksum was different and it needed to be updated
[2012-09-05 20:43:23 -0400] j|: whats the main pattern people are using to manage couchdb servers via chef? Anyone have any good pointers?
[2012-09-05 20:43:59 -0400] j|: If i start up a new couchDB, are people using replication or rsync to seed the data in their new couchdb?
[2012-09-05 20:44:35 -0400] j|: and what's the best way to integrate that with a Chef role for the couch server?
[2012-09-05 20:47:43 -0400] _pol: countdigi: mine seems to be running the restart every time, even if the template (or dependent vars) are unchanged.
[2012-09-05 20:48:06 -0400] countdigi: hmm. figured u were asking for a reason :-) can u gist your rule?
[2012-09-05 20:48:16 -0400] countdigi: recipe
[2012-09-05 20:49:18 -0400] _pol: countdigi: let me make sure other areas aren't triggering a restart either, then yes!
[2012-09-05 20:51:55 -0400] _pol: countdigi: https://gist.github.com/3644543
[2012-09-05 20:52:42 -0400] _pol: countdigi: nothing else in my [INFO] is sending out a restart.
[2012-09-05 20:53:03 -0400] _pol: I think I am just going to break down and do an inappropriate not_if...
[2012-09-05 20:54:19 -0400] cheeseplus: _pol: I think that as contstructed, that block will and should trigger a restart
[2012-09-05 20:54:53 -0400] cheeseplus: if you used a service block below that subscribes to the notify, then I expect it would be triggered
[2012-09-05 20:55:38 -0400] _pol: cheeseplus: Is there a good way to only issue the restart if the template changes?
[2012-09-05 20:57:20 -0400] cheeseplus: _pol: hrm, reading the docs it seems that the notify shouldn't trigger if the template was unchanged
[2012-09-05 20:57:30 -0400] cwj: it shouldn't
[2012-09-05 20:57:40 -0400] cwj: gist your whole chef run
[2012-09-05 20:57:56 -0400] cheeseplus: yea, trying to figure out why it would be doing so
[2012-09-05 20:58:02 -0400] countdigi: wondering if something else outside that stanza is changing the target file in some way
[2012-09-05 21:00:47 -0400] _pol: is it maybe that I am using Chef 10.8?
[2012-09-05 21:01:15 -0400] cheeseplus: jaimef: what os?
[2012-09-05 21:01:42 -0400] _pol: cwj: it is quite long, and the bit that I gist'ed is the only one that triggers a restart when nothing changes. If I put a "not_if" into the template block, then no restart happens.
[2012-09-05 21:02:20 -0400] cheeseplus: _pol: that could be - I ran into a similar issue with 10.10 where it failed to notify for file resources but worked with templates
[2012-09-05 21:02:28 -0400] cheeseplus: it was No Fun ()
[2012-09-05 21:02:40 -0400] _pol: cheeseplus: I'll just leave it to the fates until I get my server up to the most recent version.
[2012-09-05 21:02:46 -0400] _pol: Thanks for the help!
[2012-09-05 21:04:33 -0400] cheeseplus: _pol: no problem, I got lucky and found my issue was actually logged in the issue tracker
[2012-09-05 21:04:41 -0400] cheeseplus: but such is not always the case
[2012-09-05 21:04:48 -0400] _pol: On an entirely separate topic, which format is Chef Convention (tm)?: node.attribute.sub or node[:attribute][:sub] or node['attribute']['sub'] ?
[2012-09-05 21:05:31 -0400] _pol: it seems that they don't all have the same side-effect characteristics.
[2012-09-05 21:05:58 -0400] cwj: _pol: i believe using strings for keys (e.g. node['attribute']['sub']) is what opscode teaches now
[2012-09-05 21:06:15 -0400] cwj: by default thats also what foodcritic recommends
[2012-09-05 21:06:18 -0400] jordane: _pol: ^, but you will still probably see a lot of node[:attribute][:sub]
[2012-09-05 21:06:27 -0400] jordane: which was the older standard
[2012-09-05 21:06:42 -0400] _pol: jordane: it's sort of a bummer that "node.attribute.sub" works at all, it seems to be the most sketchy.
[2012-09-05 21:06:57 -0400] _pol: thanks!
[2012-09-05 21:10:41 -0400] cheeseplus: _pol: I've moved to the strings method node['attribute']['sub']
[2012-09-05 21:10:50 -0400] cheeseplus: foodcritic said I should ;)
[2012-09-05 21:11:42 -0400] _pol: :)
[2012-09-05 21:12:14 -0400] _pol: and presumably that includes not just node[] syntax but default[] syntax for the default attributes?
[2012-09-05 21:13:09 -0400] jordane: _pol: yes
[2012-09-05 21:13:10 -0400] cheeseplus: _pol: yes
[2012-09-05 21:26:25 -0400] _0x783czar: Any idea what would cause this error when trying to bootstrap a client? "INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate as pagoda-validator. Synchronize the clock on your host."
[2012-09-05 21:27:09 -0400] jmartin: clocks are wildly different perhaps?
[2012-09-05 21:28:35 -0400] _0x783czar: jmartin: this is a VM, do you suppose it's having problems with snapshots?
[2012-09-05 21:29:03 -0400] jmartin: probably, i know that i have to sync my  clock with NTP from my vmware snapshots
[2012-09-05 21:29:31 -0400] _0x783czar: jmartin: I'll give it a shot
[2012-09-05 21:29:43 -0400] jmartin: yeah just run ntpdate 0.pool.ntp.org
[2012-09-05 21:29:53 -0400] jmartin: or the equivalent for your OS
[2012-09-05 21:52:37 -0400] Urocyon: _0x783czar probably a good idea to run ntpd on all your virtuals instead of vmware tools time sync.   http://kb.vmware.com/selfservice/microsites/search.do?language=en_US&cmd=displayKC&externalId=1006427
[2012-09-05 21:52:49 -0400] Urocyon: "Note: VMware recommends you to use NTP instead of VMware Tools periodic time synchronization. NTP is an industry standard and ensures accurate time keeping in your guest. You may have to open the firewall (UDP 123) to allow NTP traffic."
[2012-09-05 21:53:38 -0400] Urocyon: And restoring a snapshot will mess up your clock ntpd helps to bring it gracefully back into alignment.
[2012-09-05 21:56:28 -0400] Urocyon: I've recently run into this error several times on moving some VMs under chef.  They weren't using ntp or vmware tools synch and their clocks had drifted significantly.
[2012-09-05 22:01:17 -0400] _0x783czar: Urocyon: hey, thanks for that.
[2012-09-05 22:17:54 -0400] qhartman: What's the best way to have a Chef::Log generated message appear in the appropriate place in the log file? It seems silly to wrap it in a ruby_block, but if I don't, all the log messages get stuck at the beginning of the run, outside of a useful context.
[2012-09-05 23:02:58 -0400] kallistec: qhartman: log resource will do it
[2012-09-05 23:10:18 -0400] Loof: I've run into an odd issue... one of my roles has a bogus/corrupt runlist... but I can't list roles, edit or or delete it
[2012-09-05 23:10:27 -0400] Loof: How do I get around the issue?
[2012-09-05 23:14:41 -0400] jessicab: Loof: that can happen if you create it in the webui.. are you seeing the recipe[recipe[recipe[]]] error when you try with knife? if you are youd just have to use the webui to delete it, knife will give errors
[2012-09-05 23:37:45 -0400] jkyle: can the current, main role be referenced in a chef recipe? something like node['role'].
[2012-09-05 23:47:23 -0400] leifmadsen: jkyle: you could look at the run_list I suppose
