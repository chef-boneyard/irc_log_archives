[2012-09-04 00:48:06 -0400] krawek: does chef have something to parse strings like "1GB" ?
[2012-09-04 00:49:16 -0400] yfeldblum_: krawek, of course not - but you're of course free to use everything that comes in the ruby standard library, and anything from any gems you want to install
[2012-09-04 00:50:47 -0400] yfeldblum_: krawek, "1GB" =~ /^(\d+)GB$/ ; $1.to_i
[2012-09-04 00:52:24 -0400] krawek: yeah it's not hard to write, just wondering if there was some builtin method
[2012-09-04 01:27:05 -0400] hoover_damm: sounds very activesupport'ish
[2012-09-04 01:27:37 -0400] hoover_damm: http://as.rubyonrails.org/classes/ActiveSupport/CoreExtensions/Numeric/Bytes.html
[2012-09-04 01:28:26 -0400] hoover_damm: I would argue that it would be still too cookbook dependent at this time... it's not a bad idea to have a helper for size for conversion (a/k/a sanity)
[2012-09-04 01:28:43 -0400] hoover_damm: my postgres9 cookbook would be less gorish
[2012-09-04 01:28:44 -0400] hoover_damm: for sure
[2012-09-04 01:53:22 -0400] Jay_Levitt: hoover_damm: btw, chef_client is smart enough to set itself up to explicitly call /usr/bin/ruby :)
[2012-09-04 01:56:03 -0400] Jay_Levitt: so no rvm woes.
[2012-09-04 01:59:28 -0400] ssd7: I could definitely see some nice conversion helpers having a place in Chef
[2012-09-04 02:01:15 -0400] yfeldblum_: ssd7, but which ones?
[2012-09-04 02:01:46 -0400] yfeldblum_: ssd7, get it wrong, and it becomes really hard to backtrack ... and non-API helpers are really easy to get wrong
[2012-09-04 02:03:23 -0400] hoover_damm: most of activesupport could go in and use that as helpers really
[2012-09-04 02:03:29 -0400] hoover_damm: pull it out if it breaks
[2012-09-04 02:04:02 -0400] hoover_damm: maybe safe mode is without the helpers lol
[2012-09-04 02:05:25 -0400] yfeldblum_: hoover_damm, lots of parts of activesupport load the core-exts - e.g., https://github.com/rails/rails/blob/v3.2.8/activesupport/lib/active_support/duration.rb
[2012-09-04 02:07:39 -0400] hoover_damm: yfeldblum_, think of activesupports helpers as the example
[2012-09-04 02:07:43 -0400] hoover_damm: not activesupport itself
[2012-09-04 02:08:26 -0400] yfeldblum_: hoover_damm, sure
[2012-09-04 02:08:57 -0400] hoover_damm: chef's resident memory size or dependencies don't really bother me.  Just tell me how much ram and CPU i need to leave for chef and keep making it better.
[2012-09-04 02:09:07 -0400] yfeldblum_: hoover_damm, activesupport is highly curated, and i'd simply recommend that mixlib-support or chef-support be highly curated as well
[2012-09-04 02:09:30 -0400] hoover_damm: yfeldblum_, i think your overcaring
[2012-09-04 02:09:47 -0400] hoover_damm: i was trying to give an example, i really don't care about the naming scheme or how it's done
[2012-09-04 02:09:59 -0400] hoover_damm: or what dependencies or anything like that
[2012-09-04 02:10:32 -0400] yfeldblum_: hoover_damm, i'm just talking about the level of care and curation that needs to go into it, not what it's named
[2012-09-04 02:11:00 -0400] hoover_damm: see above... add care and curation to the list
[2012-09-04 02:11:34 -0400] hoover_damm: anywho before this gets nastier i'm gonna detach and go take a walk
[2012-09-04 06:38:39 -0400] BryanWB_: ohai chefs!
[2012-09-04 06:41:42 -0400] erikh: hey dude
[2012-09-04 06:44:34 -0400] DeadZen: hi
[2012-09-04 06:44:45 -0400] BryanWB_: erikh: hey homez, i may be in sf in a few weeks, let's hang
[2012-09-04 06:45:44 -0400] erikh: sure! I'm actually quite a bit south of the city but I'll be working there every day
[2012-09-04 06:45:59 -0400] erikh: if you're in during the week would be the best time for sure.
[2012-09-04 06:46:04 -0400] erikh: do you have my email address?
[2012-09-04 06:46:15 -0400] DeadZen: i had no interest in chef until the erlang development started
[2012-09-04 06:46:29 -0400] BryanWB_: erikh: yup
[2012-09-04 06:46:42 -0400] DeadZen: there a specific area of the site oriented to that?
[2012-09-04 06:46:58 -0400] erikh: DeadZen: it's still in alpha or beta, and will be released with Chef 11 as I understand it.
[2012-09-04 06:47:00 -0400] erikh: BryanWB_:
[2012-09-04 06:47:03 -0400] erikh: whoops.
[2012-09-04 06:47:13 -0400] DeadZen: erikh: like i said, i had no interest in chef before that
[2012-09-04 06:47:17 -0400] erikh: cool; let's work it out over email. I imagine I can drag a few others along too
[2012-09-04 06:47:24 -0400] DeadZen: im not sure where chef 11 is in terms of time
[2012-09-04 06:47:25 -0400] BryanWB_: DeadZen: any docs would be in the github repo
[2012-09-04 06:48:47 -0400] DeadZen: ok so how far off is the erlang environment version?
[2012-09-04 06:49:34 -0400] DeadZen: is chef 11 just like a transitory step while the opscode team learns erlang?
[2012-09-04 06:49:43 -0400] BryanWB_: DeadZen: afaik,  the hosted version of chef runs off of it now
[2012-09-04 06:49:44 -0400] zts: DeadZen: I hate to dampen your enthusiasm, but you realise that the only part which will be Erlang is the server component, yes?  The client remains ruby
[2012-09-04 06:50:28 -0400] DeadZen: zts: i have no problem with ruby as a client ;p
[2012-09-04 06:50:36 -0400] zts: cool
[2012-09-04 06:51:01 -0400] erikh: DeadZen: I asked last week, they said "real soon now" but for reasons I hope are obvious didn't give me an exact date
[2012-09-04 06:51:18 -0400] erikh: that would be the entirety of chef 11, of course
[2012-09-04 06:51:19 -0400] DeadZen: there are some aspects i hope they don't use
[2012-09-04 06:51:24 -0400] DeadZen: like mixins for instance
[2012-09-04 06:51:34 -0400] DeadZen: is very much against erlang development philosophies
[2012-09-04 06:51:47 -0400] DeadZen: i'm hoping they don't screw the pooch here by trying to rubyize erlang
[2012-09-04 06:52:00 -0400] DeadZen: from what ive seen erchef so far looks fairly clean
[2012-09-04 06:52:06 -0400] erikh: hrm. well, they do most of their development pretty openly, you could get a CLA and help out I'd imagine.
[2012-09-04 06:52:11 -0400] DeadZen: but that 1 module throws up enormous profanities and alarms
[2012-09-04 06:52:37 -0400] DeadZen: yah i suppose i should check out pricing and the CLA
[2012-09-04 06:52:54 -0400] erikh: CLA = contributor license agreement, and it's open source.
[2012-09-04 06:53:05 -0400] DeadZen: i know what a CLA is;p
[2012-09-04 06:53:09 -0400] erikh: basically some legalese you need to sign before they'll accept your patches.
[2012-09-04 06:53:09 -0400] DeadZen: i mean what the CLA says
[2012-09-04 06:53:11 -0400] erikh: ah
[2012-09-04 06:53:44 -0400] erikh: it's pretty tame IIRC, basically that you aren't violating patents and opscode owns your patches, etc.
[2012-09-04 06:54:13 -0400] DeadZen: nods as long as it doesn't conflict with anything i dont see why i would want to work against the grain
[2012-09-04 06:54:19 -0400] DeadZen: system automation is a community effort
[2012-09-04 06:54:30 -0400] DeadZen: even tho my systems are extremely minimal
[2012-09-04 06:54:34 -0400] DeadZen: in terms of software stack
[2012-09-04 06:55:11 -0400] DeadZen: like i said.. chef just popped up on my radar when they decided to use an actual cluster aware language
[2012-09-04 06:55:18 -0400] DeadZen: to control it
[2012-09-04 06:55:47 -0400] DeadZen: so far ive looked at chef, puppet and blueprint
[2012-09-04 06:56:41 -0400] DeadZen: nothing appealed
[2012-09-04 06:56:46 -0400] DeadZen: erchef has a chance ;p
[2012-09-04 06:56:54 -0400] erikh: erchef is backed by mysql.
[2012-09-04 06:56:58 -0400] DeadZen: blueprint is nice too
[2012-09-04 06:57:04 -0400] DeadZen: its very clean and direct
[2012-09-04 06:57:29 -0400] erikh: I can't speak to their motives directly, but I think the foremost goal is efficiency, not clustering capability.
[2012-09-04 06:57:51 -0400] DeadZen: clustering efficiently is kind of impossible without cluster awareness ;p
[2012-09-04 06:58:08 -0400] DeadZen: but its always had a bunch of erlang right?
[2012-09-04 06:58:13 -0400] DeadZen: rabbitmq isn't something newly added?
[2012-09-04 06:58:19 -0400] erikh: if you count rabbitmq as a bunch of erlang, yes.
[2012-09-04 06:58:26 -0400] zts: and couchdb, which is going away
[2012-09-04 06:58:30 -0400] DeadZen: nods..
[2012-09-04 06:58:35 -0400] DeadZen: i never was a fan of couchdb
[2012-09-04 06:58:55 -0400] DeadZen: mysql less than postgresql
[2012-09-04 06:59:08 -0400] DeadZen: for something like chef nosql wouldn't make sense ;p
[2012-09-04 06:59:15 -0400] DeadZen: so no surprise there
[2012-09-04 06:59:30 -0400] DeadZen: what does the lucene do in chef?
[2012-09-04 06:59:36 -0400] erikh: search
[2012-09-04 06:59:42 -0400] DeadZen: what do you search for?
[2012-09-04 06:59:47 -0400] DeadZen: servers? metadata?
[2012-09-04 06:59:49 -0400] erikh: metadata mostly
[2012-09-04 06:59:58 -0400] DeadZen: gotcha
[2012-09-04 07:00:05 -0400] erikh: e.g., "give me all the servers that meet the criteria for x metadata requirements"
[2012-09-04 07:00:56 -0400] erikh: or more concretely: "roles:mysql AND mysql_master:true" -> all master mysql servers
[2012-09-04 07:01:58 -0400] DeadZen: nods..
[2012-09-04 07:02:08 -0400] DeadZen: multimaster mysql is common with chef?
[2012-09-04 07:02:11 -0400] erikh: search is really the killer feature in chef for me; the malleability of ruby is a somewhat distant second, even though it's still extremely powerful
[2012-09-04 07:02:24 -0400] erikh: well, mysql backend isn't going to be here until chef 11.
[2012-09-04 07:03:10 -0400] DeadZen: ohhhh
[2012-09-04 07:03:11 -0400] DeadZen: lol
[2012-09-04 07:03:16 -0400] DeadZen: you guys are really getting your act together then
[2012-09-04 07:03:17 -0400] DeadZen: good to see
[2012-09-04 07:03:19 -0400] erikh: that said, it'd probably be wiser to use a write master/several read slaves -- seeing as chef does comparatively little writing
[2012-09-04 07:03:37 -0400] erikh: multimaster is a bit of a bitch to get right.
[2012-09-04 07:03:37 -0400] DeadZen: erikh: nods
[2012-09-04 07:04:24 -0400] DeadZen: i haven't tried multimaster in pgsql
[2012-09-04 07:04:29 -0400] DeadZen: recently.. is that any better?
[2012-09-04 07:04:54 -0400] erikh: postgres's replication is extremely immature to mysql's by comparison. I love postgres as a developer but really do prefer mysql as an ops person
[2012-09-04 07:05:05 -0400] DeadZen: erikh: me too
[2012-09-04 07:05:15 -0400] DeadZen: erikh: good to know im not crazy ;
[2012-09-04 07:05:16 -0400] DeadZen: p
[2012-09-04 07:05:28 -0400] DeadZen: pgsql is a MUCH better db.. just multimaster is WAY behind
[2012-09-04 07:05:58 -0400] DeadZen: makes sense if you're sharding tho i guess
[2012-09-04 07:30:14 -0400] BryanWB_: is there any easy chef-y way to determine if a package is installed?
[2012-09-04 07:30:26 -0400] BryanWB_: like File.exists? but Package.exists?
[2012-09-04 07:57:55 -0400] zts: BryanWB_: not that I'm aware of - it's possible to do it in a recipe, but you have to jump through crazy hoops to find the answer
[2012-09-04 07:58:02 -0400] zts: I'm sure I found a gist that showed how, but I can't find it
[2012-09-04 08:02:12 -0400] zts: my recollection is that using normal ruby (not the DSL), you had to instantiate a Package resource, passing in the appropriate provider, and call load_current_resource - at which point, you could look to see whether there was a current version installed
[2012-09-04 08:02:42 -0400] BryanWB_: zts: darn :(
[2012-09-04 08:04:14 -0400] zts: I wish I'd put it into a library when I found it now.  grrr
[2012-09-04 08:09:33 -0400] zts: just trying to figure it out now
[2012-09-04 08:09:47 -0400] BryanWB_: here is my crappy solution
[2012-09-04 08:09:48 -0400] BryanWB_: pg_devel_status = `rpm -qa postgesql90-devel`
[2012-09-04 08:09:49 -0400] BryanWB_: pg_devel_installed = pg_devel_status.empty? != true ? true : false
[2012-09-04 08:11:05 -0400] zts: it might be ghetto, but it's going to work :)
[2012-09-04 08:12:58 -0400] zts: if I figure out the ruby solution, I'll let you know
[2012-09-04 08:13:40 -0400] DeadZen: can't do? pg_devel_installed = ! pg_devel_status.empty
[2012-09-04 08:15:36 -0400] BryanWB_: DeadZen: nice, didn't think of that
[2012-09-04 08:16:46 -0400] erikh: all the logic (just checked) is in load_current_resource of the various providers
[2012-09-04 08:17:07 -0400] erikh: zts already said that but the workflow would just be something like this:
[2012-09-04 08:17:51 -0400] erikh: load_current_resource; @current_resource.version || "not installed"
[2012-09-04 08:18:09 -0400] erikh: that said, you'd have to do some dancing to somehow work the provider code into your recipes/libraries.
[2012-09-04 08:18:23 -0400] erikh: ... if you wanted to remain portable with future additions to the providers.
[2012-09-04 08:18:40 -0400] erikh: not a very clean solution... it'd be nice if this logic was pushed into a library
[2012-09-04 08:20:56 -0400] erikh: ah. there's already logic for this in the base provider, but it's a private method.
[2012-09-04 08:21:10 -0400] erikh: yeah, this could definitely use some opening up.
[2012-09-04 09:05:53 -0400] drrk: can I access the workstation's data from ohai from within the knife.rb?
[2012-09-04 09:57:17 -0400] btn: hello there, anybody willing to help me with a chef issue?
[2012-09-04 09:58:50 -0400] rarenerd: btn: depends on the issue I guess :)
[2012-09-04 09:58:53 -0400] _rc: btn: please just go ahead and ask the channel.
[2012-09-04 09:59:04 -0400] btn: :)
[2012-09-04 10:00:05 -0400] ranjibd: btn, shoot dude
[2012-09-04 10:00:12 -0400] btn: I'm trying to set a dynamic attribute in an roles.rb file, something like :url => node['ec2']['public_ipv4']
[2012-09-04 10:00:28 -0400] btn: but I get NameError: undefined local variable or method `node' for role[monitoring]:Chef::Role
[2012-09-04 10:00:45 -0400] ranjibd: btn, node object is not available in role
[2012-09-04 10:00:59 -0400] ranjibd: as in the file where you specify the dsl
[2012-09-04 10:01:50 -0400] ranjibd: btn, in your recipe you can do that. node.set[:url] = node[:ec2][:public_ipv4]
[2012-09-04 10:02:38 -0400] ranjibd: but again it wont be available until the next chef run. other wise you have to invoke node.save explicitly (which i think is bad)
[2012-09-04 10:03:07 -0400] btn: ok. For the moment I'm running chef solo, so no saving for me ;)
[2012-09-04 10:03:19 -0400] btn: thanks, I'll give it a try then
[2012-09-04 10:03:30 -0400] ranjibd: aah... then you can use the attribute file
[2012-09-04 10:03:57 -0400] btn: I have access to node in the attribute file, haven't I
[2012-09-04 11:45:18 -0400] anentropic: does https://github.com/opscode-cookbooks/supervisor use search?
[2012-09-04 11:45:34 -0400] anentropic: I've started getting Chef::Exceptions::PrivateKeyMissing: I cannot read /etc/chef/client.pem, which you told me to use to sign requests! error after adding it to my Solo install
[2012-09-04 11:54:05 -0400] SynchroM: Hi. I've just installed chef-server 10.12 on Ubuntu Lucid from the opscode repo. For some reason the chef-expander service is going nuts - using 5Gb of memory and maxing out several CPUs and iowait, despite this being a new, empty install. Any idea why it's doing that?
[2012-09-04 11:55:15 -0400] krisk: I'm trying to source-out my logic in attributes.rb to libraries/helper.rb. unfortunately, when trying to set node['recipe'] attributes, they are saved in the node attributes on the server. So I tried setting default['recipe'] attributes, like in attributes.rb, but I now get this error: "FATAL: ArgumentError: You must supply a name when declaring a default resource", how do I declare the default resource? Or is there a better way to do this?
[2012-09-04 12:08:37 -0400] krisk: ok, found it. you need to do node.default[] instead of just default[]
[2012-09-04 12:26:43 -0400] Jay_Levitt: What are some good strategies/cookbooks for populating hostname, FQDN, etc. on EC2 instances?
[2012-09-04 13:07:11 -0400] hari_: hey an anybody tell me meaning of FileUtils.rm_f FileUtils.ln_sf
[2012-09-04 13:07:29 -0400] hari_: *can
[2012-09-04 13:10:28 -0400] sampikesley: man rm, I think
[2012-09-04 13:10:32 -0400] sampikesley: man ln
[2012-09-04 13:14:34 -0400] hari_: :sampikesley - me too, i also think so but not confm.
[2012-09-04 13:15:21 -0400] yfeldblum_: hari_, , http://www.ruby-doc.org/stdlib-1.8.7/libdoc/fileutils/rdoc/FileUtils.html
[2012-09-04 13:18:07 -0400] hari_: yfeldblum- thanks
[2012-09-04 13:19:55 -0400] hari_: hey, i have downloaded the java recipes from github, when i run those in default mode i.e. openjdk, it runs without complaint, but with oracle mode it gives errors
[2012-09-04 13:23:18 -0400] gyre007: I have a resource which I'm notifying to be restarted...but it never gets restarted
[2012-09-04 13:23:19 -0400] gyre007: uhh
[2012-09-04 13:24:28 -0400] gyre007: http://paste.ubuntu.com/1185724/
[2012-09-04 13:24:56 -0400] gyre007: I subscribe service resource into few resources and even though they DO get updated the service never restarts...
[2012-09-04 13:26:34 -0400] geekbri: gyre007: you have made sure the resource you are subscribing to exists before you try to subscribe to it right?
[2012-09-04 13:27:04 -0400] gyre007: geekbri, of course...it's in that paste...clearly visible...black on white
[2012-09-04 13:27:16 -0400] geekbri: I haven't clicked your paste yet.
[2012-09-04 13:27:49 -0400] gyre007: I see
[2012-09-04 13:27:58 -0400] geekbri: thanks for letting me know its clearly visible though.
[2012-09-04 13:29:38 -0400] williamherry: pastie
[2012-09-04 13:37:18 -0400] gyre007: geekbri, ?
[2012-09-04 13:37:27 -0400] geekbri: Yes?
[2012-09-04 13:37:38 -0400] gyre007: is it visible that the service shouldnt be restarting ?
[2012-09-04 13:38:05 -0400] geekbri: Honestly I didn't bother looking because you were kind of rude to me
[2012-09-04 13:38:16 -0400] gyre007: geekbri, :) haha sorry
[2012-09-04 13:38:25 -0400] geekbri: :)
[2012-09-04 13:42:33 -0400] UukGoblin: did you guys know that "service foobar restart" isn't actually the same as "service foobar stop; service foobar start"?
[2012-09-04 13:42:46 -0400] UukGoblin: the former doesn't re-read the /etc/init/foobar.conf
[2012-09-04 13:43:06 -0400] UukGoblin: which means when a change is made to /etc/init/foobar.conf, notifies :restart doesn't really work as expected
[2012-09-04 13:51:59 -0400] gyre007: UukGoblin, mmmmmm
[2012-09-04 13:52:09 -0400] gyre007: that might be the problem Im facing...
[2012-09-04 13:52:36 -0400] gyre007: even though if you supply the attibutes for the service like : supports :status => true, :restart => true
[2012-09-04 14:00:31 -0400] hippiehacker: ohai chefs
[2012-09-04 14:00:53 -0400] BryanWB_: hippiehacker: hey buddy!
[2012-09-04 14:01:27 -0400] hippiehacker: BryanWB_: heya
[2012-09-04 14:08:37 -0400] krisk: how do I check in a recipe/template if a certian package is installed?
[2012-09-04 14:08:52 -0400] UukGoblin: gyre007, http://upstart.ubuntu.com/faq.html#reload
[2012-09-04 14:09:28 -0400] krisk: I don't want to install it, I just want to do something different if it's present
[2012-09-04 14:10:07 -0400] gyre007: UukGoblin, I thought Chef is handling this kind of stuff in the background...and all I had to worry about is ruby/recipes
[2012-09-04 14:10:09 -0400] UukGoblin: imo that's crap, restart should be stop+start always
[2012-09-04 14:10:30 -0400] UukGoblin: gyre007, it doesn't
[2012-09-04 14:10:36 -0400] gyre007: darn
[2012-09-04 14:10:52 -0400] UukGoblin: I've just tested it
[2012-09-04 14:11:03 -0400] UukGoblin: it issues a /sbin/restart <yourservice>
[2012-09-04 14:11:10 -0400] UukGoblin: which is not enough to reload the upstart job config
[2012-09-04 14:12:25 -0400] geekbri: You could always monkey patch the upstart provider to call stop/start instead of calling restart
[2012-09-04 14:13:31 -0400] gyre007: UukGoblin, are we tlaking here about apaache kind of services right
[2012-09-04 14:13:58 -0400] geekbri: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/service/upstart.rb#L174-186
[2012-09-04 14:14:08 -0400] UukGoblin: geekbri, I guess. Would that mean modifying Chef itself? There doesn't seem to be a cookbook for it, it's in chef / chef / lib / chef / provider / service / upstart.rb
[2012-09-04 14:14:22 -0400] UukGoblin: right, yeah ;-]
[2012-09-04 14:14:34 -0400] UukGoblin: gyre007, yeah
[2012-09-04 14:14:47 -0400] gyre007: mm that's a huge disappointment for me...
[2012-09-04 14:14:51 -0400] geekbri: UukGoblin: Ah the beauty of ruby, just open the class and override the method :)
[2012-09-04 14:15:04 -0400] UukGoblin: geekbri, hah, that's dirty ;-)
[2012-09-04 14:15:57 -0400] UukGoblin: earlier I was thinking of implementing method 'each' for nil:nilClass
[2012-09-04 14:16:00 -0400] UukGoblin: but I've stopped myself.
[2012-09-04 14:16:23 -0400] geekbri: That would be a bit odd!  why would NilClass need an interator :-P
[2012-09-04 14:16:35 -0400] geekbri: there aint 'spose to be nothing there!
[2012-09-04 14:16:46 -0400] hippiehacker: krisk: I'd test for it in your recipe, and pass a variable to the template
[2012-09-04 14:16:55 -0400] UukGoblin: geekbri, so that it doesn't throw up when you do stuff like @files.each { }
[2012-09-04 14:17:03 -0400] UukGoblin: when @files happens to be nil ;-)
[2012-09-04 14:17:13 -0400] geekbri: Could rescue from mit!
[2012-09-04 14:17:16 -0400] geekbri: err fro mit
[2012-09-04 14:17:16 -0400] UukGoblin: yeah, and what's wrong with iterating over nothing?
[2012-09-04 14:17:18 -0400] geekbri: damnit
[2012-09-04 14:17:21 -0400] UukGoblin: lol
[2012-09-04 14:17:48 -0400] geekbri: Typing, the boon of my existence.
[2012-09-04 14:18:26 -0400] yfeldblum_: UukGoblin, that's a terrible idea
[2012-09-04 14:18:38 -0400] yfeldblum_: UukGoblin, a better idea is to do: (@files || []).each{ }
[2012-09-04 14:19:19 -0400] UukGoblin: yfeldblum_, I know. That's why I stopped myself.
[2012-09-04 14:20:08 -0400] yfeldblum_: UukGoblin, hehe good
[2012-09-04 14:21:53 -0400] drrk: is it possible to have a role that removes a recipe that is in the runlist already?
[2012-09-04 14:22:06 -0400] drrk: such that said recipe doesn't get run
[2012-09-04 14:22:17 -0400] BryanWB_: drrk: yes
[2012-09-04 14:22:22 -0400] drrk: how?
[2012-09-04 14:22:23 -0400] BryanWB_: oops
[2012-09-04 14:22:27 -0400] BryanWB_: not a role tho
[2012-09-04 14:22:32 -0400] BryanWB_: u can do it in another recipe
[2012-09-04 14:22:40 -0400] drrk: that's fine
[2012-09-04 14:22:47 -0400] BryanWB_: role are static, the ruby dsl compiled to json
[2012-09-04 14:23:07 -0400] BryanWB_: there is a gist somewhere that does it but i can't remember
[2012-09-04 14:23:39 -0400] BryanWB_: maybe node.run_list.delete!("foobar")
[2012-09-04 14:24:02 -0400] BryanWB_: it is an array iirc, and u can do array operations
[2012-09-04 14:24:37 -0400] gyre007: so basically UukGoblin none of those restart notifs will work on UBuntu...AWESOME really
[2012-09-04 14:24:41 -0400] gyre007: arrrgh
[2012-09-04 14:25:12 -0400] UukGoblin: gyre007, they'll work if you change i.e. apache's config
[2012-09-04 14:25:24 -0400] gyre007: UukGoblin, to what ?
[2012-09-04 14:25:38 -0400] UukGoblin: gyre007, they only won't work if you changed the apache's upstart job config, that is /etc/init/apache.conf or something of that sort
[2012-09-04 14:26:31 -0400] gyre007: ah...well i dont change those at all, yet the services are not restarting anyway
[2012-09-04 14:26:37 -0400] gyre007: very annoying i have to admit
[2012-09-04 14:27:26 -0400] UukGoblin: gyre007, you might have a different problem then
[2012-09-04 14:27:44 -0400] gyre007: UukGoblin, well I guess I do...but im not really sure why...uhh...
[2012-09-04 14:31:45 -0400] lewjg: Removing stuff via recipe: http://hectcastro.me/2012/03/31/running-chef-recipes-once.html
[2012-09-04 14:32:08 -0400] lewjg: (for @drrk)
[2012-09-04 14:33:03 -0400] jforest: so... with AWS, is there any good way to work with auto-scaling?
[2012-09-04 14:33:08 -0400] jforest: (using chef)
[2012-09-04 14:35:49 -0400] maruq: jforest: there was a gist that showed how to hack the client.rb & pass in a user data file as JSON
[2012-09-04 14:36:06 -0400] maruq: you could then set that up as part of the autoscaling stuff
[2012-09-04 14:46:48 -0400] gyre007: just found out that the NOTIFICATIONS are NOT working...that's the problem with restarting  those services...I have the following: http://paste.ubuntu.com/1185883/ and it looks like this doesn't seem to restart the service at all :)
[2012-09-04 14:46:50 -0400] gyre007: uhh
[2012-09-04 14:47:06 -0400] gyre007: is it only restarting it when it's updated ?
[2012-09-04 14:51:08 -0400] yfeldblum_: gyre007, a resource X will only notify other resources Y and Z that are subscribed to X ... when X is marked as having been updated (i.e. when chef has changed to system to bring it into line with the resource as declared)
[2012-09-04 14:54:18 -0400] gyre007: yfeldblum_, so THIS should then work.. http://paste.ubuntu.com/1185894/
[2012-09-04 14:54:19 -0400] frank_: hi chefs!
[2012-09-04 14:54:39 -0400] frank_: got a question regarding attributes/ folder in a cookbook
[2012-09-04 14:54:52 -0400] frank_: will every file in that folder be loaded for every recipe?
[2012-09-04 14:55:05 -0400] frank_: or will foo.rb only be loaded for the foo recipe?
[2012-09-04 15:00:42 -0400] yfeldblum_: gyre007, not sure then
[2012-09-04 15:01:20 -0400] Leitz: Did someone change the webui part of the build this weekend? Just did a base install and the webui is not doing anything.
[2012-09-04 15:02:07 -0400] yfeldblum_: frank_, all attributes files will be loaded for every cookbook in the resolved dependency graph of cookbooks (which is computed from the expanded run list + environment constraints + the set of cookbooks available on the chef-server & their metadatas)
[2012-09-04 15:03:38 -0400] zts: http://chrisa.github.com/blog/2012/07/22/deploying-a-pki-with-chef/ # Doesn't seem this got linked up here
[2012-09-04 15:04:38 -0400] frank_: yfeldblum_: ic, feared that. so best way is to set them using node.set etc in the recipe
[2012-09-04 15:06:09 -0400] leifmadsen: would it be possible to get someone to triage CHEF-3405? I'd like to get it marked as a blocker for Chef 10.14.0 as I've been testing the RCs.
[2012-09-04 15:06:28 -0400] yfeldblum_: frank_, not sure why you feared it ...
[2012-09-04 15:06:37 -0400] leifmadsen: or maybe this request is better made on the mailing list -- would that type of request be the general mailing list or dev list?
[2012-09-04 15:06:52 -0400] yfeldblum_: frank_, you should probably not be using `node.set` anywhere at all
[2012-09-04 15:07:03 -0400] yfeldblum_: frank_, but what are you trying to accomplish overall?
[2012-09-04 15:11:53 -0400] corp: hello
[2012-09-04 15:12:10 -0400] corp: anyone on debian squeeze dealing with services not disabling?
[2012-09-04 15:12:11 -0400] corp: http://tickets.opscode.com/browse/CHEF-2034
[2012-09-04 15:12:40 -0400] corp: this discusses how a new provider was added to support dependency-based booting
[2012-09-04 15:12:53 -0400] corp: for debian squeeze, should all services be using this provider?
[2012-09-04 15:13:09 -0400] corp: for enable and start, the standard provider works. but not disable
[2012-09-04 15:27:53 -0400] kallistec: leifmadsen: those 5 errors that are the same are definitely not a problem in Chef. Haven't used the minitest handler, but it seems like it doesn't define a `node` method for you, at least not in the context that you're trying to use it
[2012-09-04 15:31:51 -0400] leifmadsen: kallistec: interesting, because the mysql::server stuff is what is in the mysql opscode cookbook, so it looks like minitest-handler may have "broken(?)" those tests as well (so it's not just my stuff that is broken)
[2012-09-04 15:32:22 -0400] leifmadsen: but ya, I'll report this back up to the minitest-handler peeps it looks like
[2012-09-04 15:33:29 -0400] Leitz: Hey all, my connection flaked out. Have either of the questions I asked above been answered and I missed it?
[2012-09-04 15:34:34 -0400] kallistec: leifmadsen: cool. Looking at it, I don't see any methods in core chef getting called that look like the culprits. But again, I'm not familiar with the handler so it could be that some methods got moved to a different module or something
[2012-09-04 15:37:36 -0400] leifmadsen: ya, let me file something with minitest-handler and see what I can pull from that. Looks like something may have broken tests in many places, but it might just be something in chef changed and now minitest-handler isn't accessing it the right way
[2012-09-04 15:38:07 -0400] _pabst_: What does: FATAL: NameError: uninitialized constant Chef::Recipe::Opscode generally mean?
[2012-09-04 15:40:10 -0400] Jay_Levitt: Is it really a great idea that bootstrap drops off /etc/chef/encrypted_data_bag_secret (and validation.pem, for that matter) as world-readable?
[2012-09-04 15:47:29 -0400] organicveggie: Trying to setup a fresh Chef server on CentOS 6. Running chef-solo, throws a strange error:
[2012-09-04 15:47:37 -0400] organicveggie: FATAL: NoMethodError: undefined method `each' for nil:NilClass
[2012-09-04 15:47:45 -0400] organicveggie: Any bright ideas?
[2012-09-04 15:48:12 -0400] leifmadsen: organicveggie: typo / syntax error in your ruby somewhere?
[2012-09-04 15:49:27 -0400] organicveggie: leifmadsen: Could be. Not much to it though and I've double checked everything. /etc/chef/solo.rb and ~/chef.json. That's all that I touched.
[2012-09-04 15:49:43 -0400] leifmadsen: more information likely required
[2012-09-04 15:50:02 -0400] jmartin1: organicveggie: use the omnibus installer
[2012-09-04 15:50:23 -0400] organicveggie: jmartin1: isn't that only for chef client? not server?
[2012-09-04 15:50:57 -0400] jmartin1: yah, but itll make sure you have everything clean on that end
[2012-09-04 15:51:02 -0400] jmartin1: i just setup a chef-server in centos6
[2012-09-04 15:51:05 -0400] jmartin1: without issue
[2012-09-04 15:51:37 -0400] xmltok: is it possible to assign roles and environments from within cookbooks? we follow a specific hostname pattern which I can use to determine the software and environment that a node should run on. is this something ohai would handle?
[2012-09-04 15:51:38 -0400] organicveggie: jmartin1: I hate to ask this, but you're positive? I already tried that route with a different instance (this is on EC2). Didn't work b/c the omnibus uses a different ruby.
[2012-09-04 15:52:14 -0400] jmartin1: organicveggie: i can set it up once again to be sure, but im pretty positive
[2012-09-04 15:52:22 -0400] jmartin1: if you give me a bit, ill give it a shot
[2012-09-04 15:52:28 -0400] organicveggie: jmartin1: when I ran chef-solo to setup the server, that threw the following error:
[2012-09-04 15:52:29 -0400] organicveggie: FATAL: Errno::ENOENT: No such file or directory - /usr/lib64/ruby/gems/1.8/gems/chef-10.12.0/distro/redhat/etc/sysconfig/chef-solr
[2012-09-04 15:53:26 -0400] jmartin: k, im setting it up now from scratch
[2012-09-04 15:53:52 -0400] organicveggie: jmartin: mind if i quick walk through the steps to make sure I'm not doing something silly?
[2012-09-04 15:54:17 -0400] organicveggie: 1) install chef client using the omnibus installer (http://www.opscode.com/chef/install/)
[2012-09-04 15:54:29 -0400] organicveggie: 2) create /etc/chef/solo.rb
[2012-09-04 15:54:35 -0400] organicveggie: 3) create ~/chef.json
[2012-09-04 15:54:48 -0400] organicveggie: 4) Run chef-solo: "chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz"
[2012-09-04 15:55:06 -0400] jmartin: hrm did the bootstrap latest get fixed?
[2012-09-04 15:55:17 -0400] jmartin: i know that it was giving me issues about epel last week
[2012-09-04 15:55:23 -0400] jmartin: it still had 6-5 instead of 6-7
[2012-09-04 15:55:31 -0400] jwitrick: yes. that seems to have been fixed this weekened
[2012-09-04 15:57:28 -0400] jmartin: k
[2012-09-04 15:57:31 -0400] jmartin: im running that right now
[2012-09-04 15:59:02 -0400] organicveggie: jmartin: thanks!
[2012-09-04 15:59:33 -0400] jmartin: gecode will take a while to compile on this VM
[2012-09-04 15:59:40 -0400] jmartin: so it might be a few mins
[2012-09-04 15:59:54 -0400] organicveggie: I'm not going anywhere. :)
[2012-09-04 16:02:51 -0400] organicveggie: jmartin: what version of ruby are you running on your centos 6 box?
[2012-09-04 16:04:02 -0400] jmartin: organicveggie: none, i omnibus installed chef
[2012-09-04 16:04:13 -0400] jmartin: this was a fresh minimal install
[2012-09-04 16:04:16 -0400] jmartin: of cent6
[2012-09-04 16:04:58 -0400] organicveggie: jmartin: i wonder if that may be the issue. i've got ruby 1.8.7-p352 installed already.
[2012-09-04 16:06:25 -0400] jmartin: yah, thats why i recommend the omnibus since it is isolated
[2012-09-04 16:07:13 -0400] organicveggie: the challenge for me is that all of our EC2 management scripts (including backups) are all Ruby based... :)
[2012-09-04 16:07:56 -0400] organicveggie: Ruby versioning under CentOS has turned into the modern equivalent of DLL Hell for me... :)
[2012-09-04 16:08:01 -0400] kallistec: organicveggie: that's fine, you can use omnibus-based chef to install the ruby you want
[2012-09-04 16:08:06 -0400] jmartin: yep
[2012-09-04 16:08:08 -0400] jmartin: ^
[2012-09-04 16:08:17 -0400] jmartin: also, you might want to look into RVM otherwise
[2012-09-04 16:08:57 -0400] organicveggie: Yeah, I have RVM working on another set of instances... it works, but creates an interesting set of challenges since it's environment driven...
[2012-09-04 16:09:39 -0400] organicveggie: kallistec: yeah, that's the theory. unfortunately, i ran into an error that appears like it's looking at the wrong ruby. FATAL: Errno::ENOENT: No such file or directory - /usr/lib64/ruby/gems/1.8/gems/chef-10.12.0/distro/redhat/etc/sysconfig/chef-solr
[2012-09-04 16:10:31 -0400] jmartin: and that file doesnt exist right?
[2012-09-04 16:10:40 -0400] organicveggie: correct.
[2012-09-04 16:11:05 -0400] organicveggie: In fact, "/usr/lib64/ruby/gems/1.8/gems/chef-10.12.0/" doesn't exist.
[2012-09-04 16:11:19 -0400] jmartin: hrm yeah, how did you install chef-solo?
[2012-09-04 16:11:39 -0400] organicveggie: jmartin: well, i've tried it twice with two different approaches...
[2012-09-04 16:11:47 -0400] organicveggie: Attempt #1: omnibus
[2012-09-04 16:11:56 -0400] kallistec: organicveggie: seems like something could be wrong with your rubygems config... is `gem env` correct?
[2012-09-04 16:12:45 -0400] organicveggie: I think I'm going to start over with a fresh VM. :)
[2012-09-04 16:13:10 -0400] organicveggie: It should be safe to use the omnibus installer on an instance with ruby 1.8.7 already installed, correct?
[2012-09-04 16:13:24 -0400] jmartin: afaik, yes
[2012-09-04 16:13:35 -0400] organicveggie: Hrmph.
[2012-09-04 16:13:54 -0400] jmartin: and did you install ruby via source or rpm?
[2012-09-04 16:14:00 -0400] kallistec: organicveggie: yeah, it should work fine
[2012-09-04 16:14:33 -0400] kallistec: I gotta run, but just so y'all know, omnibus packages of chef-server are coming; that's how the test-drive VM for erchef was built
[2012-09-04 16:14:51 -0400] jmartin: oh very nice
[2012-09-04 16:14:53 -0400] organicveggie: kallistec: awesome!
[2012-09-04 16:15:13 -0400] kallistec: we're in the process of fixing up our test infrastructure so we can verify the builds before we release them
[2012-09-04 16:15:53 -0400] jmartin: organicveggie: yeah, my run just completed
[2012-09-04 16:15:56 -0400] jmartin: no errors
[2012-09-04 16:16:14 -0400] jmartin: omnibus + http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo
[2012-09-04 16:16:18 -0400] organicveggie: jmartin: thanks. good to know that it's definitely something on my end.
[2012-09-04 16:16:37 -0400] kallistec: if you're adventurous, you can make your own by getting the omnibus repos, doing bundle install, and running the build inside vagrant
[2012-09-04 16:16:55 -0400] organicveggie: And omnibus client is installed from http://www.opscode.com/chef/install/, correct?
[2012-09-04 16:17:15 -0400] jmartin: yep
[2012-09-04 16:17:48 -0400] BryanWB: anybody want to help us test foodfightshow on air?
[2012-09-04 16:17:57 -0400] geekbri: ?
[2012-09-04 16:18:19 -0400] BryanWB: http://www.youtube.com/user/nathenharvey?feature=plcp&v=DdP8JvZ90Qg
[2012-09-04 16:19:22 -0400] jmartin: someone subscribes to the 'suns out, guns out' philosophy i see
[2012-09-04 16:20:15 -0400] geekbri: Haha, I haven't heard that before
[2012-09-04 16:20:18 -0400] geekbri: Amusing.
[2012-09-04 16:20:36 -0400] organicveggie: jmartin: same problem with a fresh instance.  "No such file or directory - /usr/lib64/ruby/gems/1.8/gems/chef-10.12.0/distro/redhat/etc/sysconfig/chef-solr"
[2012-09-04 16:21:03 -0400] awgross|flashman: BryanWB: I can see you
[2012-09-04 16:21:16 -0400] jmartin: quite weird, what version of cent? 6.3?
[2012-09-04 16:21:31 -0400] jmartin: and can you do a paste of the surrounding log?
[2012-09-04 16:21:32 -0400] organicveggie: Fresh instance. Verified chef gem not installed. Ran omnibus installer. Created solo.rb and chef.json. Ran /opt/chef/bin/chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
[2012-09-04 16:22:22 -0400] organicveggie: jmartin: part 1 -- http://pastebin.com/pw3C3zR7
[2012-09-04 16:22:38 -0400] organicveggie: jmartin: sorry, no part 2. :)
[2012-09-04 16:23:16 -0400] jmartin: hrm
[2012-09-04 16:23:21 -0400] jmartin: it dies really quick
[2012-09-04 16:23:23 -0400] organicveggie: jmartin: actually, there is a part 2 -- http://pastebin.com/jgby10tD
[2012-09-04 16:23:25 -0400] Leitz: Omnibus install worked well for me this AM, with 1G or RAM. Failed last week with 12 G of RAM.
[2012-09-04 16:24:34 -0400] jmartin: organicveggie: do you have selinux enabled?
[2012-09-04 16:24:55 -0400] jmartin: perhaps selinux is buggering with it
[2012-09-04 16:25:32 -0400] organicveggie: jmartin: nope. not even installed.
[2012-09-04 16:25:35 -0400] Leitz: jmartin, also, sometimes turning selinux to "permissive" helps other programs. It is "on" but not really doing anything.
[2012-09-04 16:25:45 -0400] Leitz: Not sure why, but it does work.
[2012-09-04 16:25:54 -0400] Randm: because you have the wrong profile attached
[2012-09-04 16:26:36 -0400] Randm: or the wrong security context applied to the process, file, directory, etc
[2012-09-04 16:26:44 -0400] jmartin: right
[2012-09-04 16:26:55 -0400] Randm: and it's too much work to make it work otherwise, for 'security reasons'
[2012-09-04 16:27:21 -0400] Leitz: Randm, I mean that having it permissive sometimes works when "disabled" causes issues.
[2012-09-04 16:27:31 -0400] Randm: that shouldn't be.
[2012-09-04 16:28:10 -0400] Randm: did you reboot after setting it to disabled?
[2012-09-04 16:29:02 -0400] organicveggie: Alright. Let me try uninstalling ruby 1.8.7 and see if that makes a difference.
[2012-09-04 16:29:34 -0400] organicveggie: wtf. that's working.
[2012-09-04 16:29:53 -0400] Leitz: Older Ruby in your PATH?
[2012-09-04 16:31:13 -0400] organicveggie: Letiz: Absolutely. Server had 1.8.7 installed.
[2012-09-04 16:31:48 -0400] Leitz: I installed OmniBus with no OS based Ruby at all and most things worked.
[2012-09-04 16:32:27 -0400] organicveggie: Leitz: yeah, that seems to be working better. Problem is that the instance is running on EC2 and all of my maintenance scripts are written in Ruby... :)
[2012-09-04 16:33:17 -0400] Leitz: Ugh...could you put the updated Ruby in your PATH before the OS one? Are your scripts forward compatible?
[2012-09-04 16:33:33 -0400] Leitz: I'm not very good with Ruby.
[2012-09-04 16:34:08 -0400] jmartin: convert your maintenance scripts to recipes ftw
[2012-09-04 16:34:30 -0400] organicveggie: jmartin: "maintenance" as
[2012-09-04 16:34:33 -0400] organicveggie: oops. :)
[2012-09-04 16:34:53 -0400] organicveggie: jmartin: "maintenance" as in scripts that handle snapshotting the EC2 EBS volumes... need to run every hour.
[2012-09-04 16:35:33 -0400] jmartin: i dont see why that couldnt be accomplished with a recipe too, although i dont use EC2
[2012-09-04 16:36:39 -0400] organicveggie: jmartin: could be controlled via a recipe, but then my only option for controlling when it runs is to change when chef-client runs... seems kludgy. :)
[2012-09-04 16:37:26 -0400] jmartin: not really, you can have the recipe run and do nothing if its not the appropriate time
[2012-09-04 16:37:51 -0400] jmartin: although ill admit its a bit kludgy still
[2012-09-04 16:38:42 -0400] BryanWB: geekbri can u try to make a comment here http://www.youtube.com/watch?v=9y-dSh36h8c&feature=plcp ?
[2012-09-04 16:39:26 -0400] jmartin: organicveggie: https://github.com/opscode/cookbooks/tree/master/aws/ <-- this cookbook seems like it might be useful to you
[2012-09-04 16:41:46 -0400] organicveggie: jmartin: yeah, i've seen that. it's an interesting direction to take things. our setup is a bit more complicated because we use multiple EBS volumes in RAID arrays. but conceptually we're doing the exact thing only via a standalone script and cron.
[2012-09-04 16:41:59 -0400] organicveggie: No real reason it couldn't be done with a straight recipe/provider.
[2012-09-04 16:42:35 -0400] organicveggie: In fact, that might really simplify things... hrmmm.
[2012-09-04 16:43:15 -0400] organicveggie: damn it. chef-solo run crashed. :(
[2012-09-04 16:43:32 -0400] organicveggie: Compiling gecode: "g++: Internal error: Killed (program cc1plus)"
[2012-09-04 16:44:22 -0400] organicveggie: http://pastebin.com/PDUR2qu4
[2012-09-04 16:45:02 -0400] Leitz: organicveggie, how much RAM is on the box?
[2012-09-04 16:45:07 -0400] organicveggie: 1.7GB
[2012-09-04 16:45:14 -0400] organicveggie: it's an m1.small EC2 instance.
[2012-09-04 16:45:17 -0400] organicveggie: Need more?
[2012-09-04 16:45:20 -0400] Leitz: Hmm...
[2012-09-04 16:45:28 -0400] Leitz: Nope, I worked with 1 this AM.
[2012-09-04 16:46:16 -0400] organicveggie: I'm actually trying to setup a new chef-server on a new instance and migrate from our old server (which is running CentOS 5).
[2012-09-04 16:46:38 -0400] organicveggie: We've got about 150-170 instances and the old box seemed to handle it, although I was considering upgrading to a larger instance...
[2012-09-04 16:48:10 -0400] organicveggie: Trying it again... if it fails a second time, i'll try with a larger instance size.
[2012-09-04 16:52:42 -0400] Leitz: organicveggie, CentOS 6 or 5?
[2012-09-04 16:53:29 -0400] organicveggie: Leitz: CentOS 6
[2012-09-04 16:53:41 -0400] Leitz: Last week mine was dieing on gecode as well. Today worked.
[2012-09-04 16:54:23 -0400] organicveggie: Leitz: Failed again. Just remembered that this image was built off 6.2, so it may be missing some updates. I'll try updating before trying a larger instance.
[2012-09-04 16:54:44 -0400] Leitz: yeah, I did a yum update before doing any chef work.
[2012-09-04 17:10:12 -0400] _0x783czar: So I'm trying to write a definition, I wrote one called "add_key.rb" and am trying to use it in my recipe, but I keep getting a "method_missing" error, any ideas about what could be causing this?
[2012-09-04 17:14:08 -0400] organicveggie: _0x78czar: do you have a stacktrace? that might help diagnose the problem.
[2012-09-04 17:17:21 -0400] _0x783czar: organicveggie: http://pastebin.com/AYmdpk3q
[2012-09-04 17:19:15 -0400] _0x783czar: organicveggie: that's the stacktrace, and default.rb:17 is the start of a unless block which uses the definition
[2012-09-04 17:21:33 -0400] organicveggie: _0x78czar: hrmph. would you mind pasting the unless block? Or least, part of the area around default.rb line 17?
[2012-09-04 17:24:11 -0400] _0x783czar: organicveggie: oh no problem.  Here's the whole recipe http://pastebin.com/VBbr4A4g
[2012-09-04 17:24:34 -0400] _0x783czar: organicveggie: and here's the definition: http://pastebin.com/nGm9M52k
[2012-09-04 17:26:03 -0400] _rc: _0x783czar: you don't seem to make key a parameter
[2012-09-04 17:26:38 -0400] _rc: _0x783czar: also line 17 refers to item;  you probably mean 'user'
[2012-09-04 17:26:49 -0400] organicveggie: _rc: beat me to the punch. :)
[2012-09-04 17:28:02 -0400] juliancdunn: organicveggie: binary gecode RPMs should now be in EPEL6
[2012-09-04 17:28:23 -0400] juliancdunn: but I haven't tested gecode 3.7.3 with Chef server yet to ensure that it works
[2012-09-04 17:28:50 -0400] _0x783czar: _rc: alright thanks, do I have to create a key param even if I don't want it to have a default value?
[2012-09-04 17:28:59 -0400] _0x783czar: organicveggie: thanks though!
[2012-09-04 17:29:14 -0400] _rc: _0x783czar: yes
[2012-09-04 17:29:21 -0400] organicveggie: _0x783czar: i think the "item" vs "user" is the biggest issue though. :)
[2012-09-04 17:29:46 -0400] organicveggie: juliancdunn: how would i leverage that with the chef-solo bootstrap process? would i need to manually install each component and skip the bootstrap completely?
[2012-09-04 17:29:57 -0400] _0x783czar: _rc: OK, fixing right now
[2012-09-04 17:30:11 -0400] _0x783czar: organicveggie: alright, I'll see what effect that has
[2012-09-04 17:37:33 -0400] _0x783czar: organicveggie: _rc: OK, so I made some fixes and still hit errors.  Here's the stacktrace: http://pastebin.com/S3VkLsRq  the recipe: http://pastebin.com/XjSRr1tX  and the definition: http://pastebin.com/Tz6p2wQQ
[2012-09-04 17:37:35 -0400] juliancdunn: organicveggie: are you using omnibus to bootstrap?
[2012-09-04 17:42:05 -0400] organicveggie: juliandc: yes.
[2012-09-04 17:42:13 -0400] organicveggie: argh. typos. :)
[2012-09-04 17:42:22 -0400] organicveggie: juliancdunn: yes, i'm using the omnibus.
[2012-09-04 17:43:53 -0400] organicveggie: _0x783czar: where is the "add_key" definition defined? is it in the git cookbook or a different cookbook?
[2012-09-04 17:44:11 -0400] _0x783czar: organicveggie: the git cookbook
[2012-09-04 17:44:33 -0400] _0x783czar: organicveggie: cookbooks/git/definitions/add_key.rb
[2012-09-04 17:45:31 -0400] organicveggie: _0x783czar: I see the problem. In the "add_key" definition, you reference "home_dir" as a variable on lines 3 & 4. You need to reference "params[:home_dir]" instead.
[2012-09-04 17:45:48 -0400] organicveggie: Or, add a line like "home_dir = params[:home_dir]" before line 2.
[2012-09-04 17:46:31 -0400] xmltok: is there a pattern to follow for working with cookbooks that are developed externally, yet require local changes, and keeping them in sync?
[2012-09-04 17:47:28 -0400] _0x783czar: organicveggie: ah, right you are, let's try this out again
[2012-09-04 18:02:23 -0400] juliancdunn: organicveggie: you'll need to wait for the gecode cookbook to be updated then :-(
[2012-09-04 18:07:11 -0400] patcon: hm. omnibus installer no longer seems to work for older chef version: `curl -L http://www.opscode.com/chef/install.sh | bash /dev/stdin -v 0.10.8-3`
[2012-09-04 18:07:17 -0400] patcon: is that intentional?
[2012-09-04 18:18:19 -0400] makerbreakr: when a cookbooks such as this: https://github.com/damm/postgresql randomly generates a password for the postgres user, where is it stored?
[2012-09-04 18:18:28 -0400] makerbreakr: how cna I see what the password is?
[2012-09-04 18:24:25 -0400] conzyor34: Hi all. Anyone know what's replacing server_file in Chef 11?
[2012-09-04 18:24:35 -0400] conzyor34: Err, "remote_file" I mean?
[2012-09-04 18:28:54 -0400] lesavik_: Hi guys! Can anyone tell where should i look to fix this issue:
[2012-09-04 18:28:55 -0400] lesavik_: NoMethodError: undefined method `package' for #<Class:0xb721f450>
[2012-09-04 18:28:55 -0400] lesavik_: /tmp/vagrant-chef-1/chef-solo-1/cookbooks/PHP/resources/default.rb:1:in `class_from_file'
[2012-09-04 18:29:25 -0400] lesavik_: Maybe someone could at least point to the correct direction...
[2012-09-04 18:30:09 -0400] lesavik_: What am i missing?
[2012-09-04 18:39:38 -0400] wamilton: lesavik__: remove the php recipe from your run list for now and see if that fixes it?
[2012-09-04 18:40:44 -0400] behemphi: This has likely been done already, but if you need a quick laugh check out the title of the book:
[2012-09-04 18:40:44 -0400] behemphi: http://www.amazon.com/Puppet-2-7-Cookbook-John-Arundel/dp/1849515387/ref=sr_1_5?s=books&ie=UTF8&qid=1346783986&sr=1-5&keywords=nginx
[2012-09-04 18:41:27 -0400] wamilton: behemphi: it's funny because of the word cookbook?
[2012-09-04 18:41:34 -0400] behemphi: yep
[2012-09-04 18:41:48 -0400] behemphi: as in  Is there a cookbook to install Puppet ...
[2012-09-04 18:42:25 -0400] senthilr: when is a chef book coming out
[2012-09-04 18:42:40 -0400] wamilton: behemphi: I get it, but I don't know if that's any funnier than PHP and ruby books with a title with the word cookbook. What will really bring it home is a chef book called the 'chef cookbook cookbook'
[2012-09-04 18:43:15 -0400] behemphi: Now your playing along wamilton!!!
[2012-09-04 18:43:17 -0400] behemphi: beautiful
[2012-09-04 18:43:25 -0400] lesavik__: wamilton: it does indeed, thanks. But i need to run this recipe, and have no idea how to make it work. Maybe someone knows how to install and import method `package'? Really new to all this stuff.
[2012-09-04 18:43:28 -0400] behemphi: @senthilr there is a book of sorts
[2012-09-04 18:43:47 -0400] behemphi: Test Driven Infrastructure with Chef but S. Nelson-Smith
[2012-09-04 18:44:20 -0400] behemphi: I have not read it, but if you get on early tomorrow American time, ask Brian Berry about it
[2012-09-04 18:44:24 -0400] senthilr: behemphi: thx, know about htat one
[2012-09-04 18:44:45 -0400] wamilton: lesavik__: cool, at least it's isolated to that recipe though.... are you using the standard opscode php cookbook?
[2012-09-04 18:44:59 -0400] wamilton: lesavik__: from the opscode-cookbooks github?
[2012-09-04 18:45:04 -0400] behemphi: @wamilton can you be more specifif
[2012-09-04 18:45:10 -0400] lesavik__: wamilton: no, my own.
[2012-09-04 18:45:11 -0400] behemphi: I have debt to pay :-)
[2012-09-04 18:45:27 -0400] behemphi: sorry looks lke I jumped in the middle
[2012-09-04 18:46:19 -0400] wamilton: lesavik__: ah, well then I guess I can only recommend reading the opscode one to see what it does for php packages, from here it looks like there is no provider for you to use the package resource in your cookbook
[2012-09-04 18:47:43 -0400] wamilton: lesavik__: if you made the cookbook using knife and you don't plan to write any of your own resources/providers, then it could be that your recipes are looking for things you haven't made
[2012-09-04 18:48:16 -0400] wamilton: lesavik__: rather than just using the default 'package' resource without trying to load your apparently non-existent stuff
[2012-09-04 18:48:24 -0400] lesavik__: wamilton: thanks! And how do i download and install the provider (yum_package)? Didn't find any howto for dummies like me in Chef manual.
[2012-09-04 18:49:08 -0400] wamilton: lesavik__: there's a yum cookbook at github.com/opscode-cookbooks/yum
[2012-09-04 18:50:39 -0400] lesavik__: wamilton: unfortunately it doesn't utilize Yum Package Resource ( http://wiki.opscode.com/display/chef/Yum+Package+Resource ).
[2012-09-04 18:50:41 -0400] autif: Is there a simple way to run some bash scripts before and after chef-client runs on a node?
[2012-09-04 18:50:56 -0400] behemphi: @lesavik__:   If I may, run the chef-cient with the "-l debug" and find the exact line where it is failing.  You can likely copy/paste that line to your command line.  If it is yum, then it will be apparent.  If, like me, you forgot some other precondition the OS might give you a strong hint on what that is.
[2012-09-04 18:51:38 -0400] wamilton: autif: if you aren't using `knife bootstrap` then you could just invoke a wrapper script that calls chef-client and your other stuff
[2012-09-04 18:52:02 -0400] behemphi: For the after part @autif check out the report handlers.
[2012-09-04 18:53:25 -0400] organicveggie: jmartin: fresh instance w/out ruby pre-installed worked beautifully.
[2012-09-04 18:54:04 -0400] autif: wamilton: yup - I am currently doing that - cronning a script that calls pre + chef-client + post, just wanted to make sure I am not doing something silly and that there is a better way to do it (say using the built in -d -i -s options)
[2012-09-04 18:54:14 -0400] jmartin: organicveggie: nice
[2012-09-04 18:54:32 -0400] wamilton: autif: behemphi is right about handlers being the better way
[2012-09-04 18:55:13 -0400] wamilton: autif: that's how you let knife still work
[2012-09-04 18:55:14 -0400] autif: behemphi: wamilton: Will check those out. Thanks
[2012-09-04 18:55:30 -0400] organicveggie: jmartin: looks like it was a combination of two things - removing MRI ruby 1.8.7 and having enough memory to compile gecode.
[2012-09-04 18:58:31 -0400] lesavik_: behemphi: still don't see any clues: http://pastebin.com/49sgn0sB
[2012-09-04 18:58:40 -0400] _pabst_: Is it bad practice to apply the chef-client cookbook after bootstrapping a node?
[2012-09-04 19:00:28 -0400] miah: no
[2012-09-04 19:00:46 -0400] miah: that cookbook configures the chef-client. so its very usful
[2012-09-04 19:01:03 -0400] wamilton: idempotency ftw!!!
[2012-09-04 19:01:26 -0400] makerbreakr: Im messing around with this:  http://community.opscode.com/cookbooks/user  I created a user data bag
[2012-09-04 19:01:50 -0400] _pabst_: thats what I thought
[2012-09-04 19:01:50 -0400] makerbreakr: and I put the recipe user::data_bag into the run list, but the user did not get added
[2012-09-04 19:01:51 -0400] _pabst_: cool
[2012-09-04 19:01:52 -0400] _pabst_: thanks
[2012-09-04 19:02:10 -0400] makerbreakr: there was nothing in the default recipe
[2012-09-04 19:02:17 -0400] stormerider: _pabst_: no, its helpful when using things like knife-ec2 to ensure that everything gets set up correctly
[2012-09-04 19:02:46 -0400] _pabst_: so, how do I run a chef-client on a node from knife again?
[2012-09-04 19:02:55 -0400] stormerider: makerbreakr: you really need to customize that recipe, it doesnt really do a whole lot by default
[2012-09-04 19:02:56 -0400] wamilton: makerbreakr: what happens if you do `knife data bag edit users $YOUR_USER` ?
[2012-09-04 19:03:13 -0400] makerbreakr: wamilton, it will populate with the databag information
[2012-09-04 19:03:35 -0400] _pabst_: stormerider: thats exactly what I am trying to accomplish, I wasn't sure if the chef-client cookbook was going to break the bootstrap or just set the client up after the bootstrap
[2012-09-04 19:03:37 -0400] wamilton: makerbreakr: k, just wanted to make sure the data_bag was properly saved...
[2012-09-04 19:03:41 -0400] stormerider: makerbreakr: istr it only creates users who are in the sysadmin group with the defalt recipe
[2012-09-04 19:04:05 -0400] makerbreakr: so i have to write the recipe also?
[2012-09-04 19:04:18 -0400] makerbreakr: can that recipe read from the databag?
[2012-09-04 19:04:42 -0400] stormerider: yes. the cookbook gives you the framework to work with but you need to customize it.
[2012-09-04 19:04:53 -0400] wamilton: makerbreakr: if you want to use it out of the box, you have to put the users in a databag such that their group attr is 'sysadmin'
[2012-09-04 19:05:01 -0400] stormerider: i wish that it did a bit more out of the gate :-/
[2012-09-04 19:07:06 -0400] wamilton: makerbreakr: I can get it to manage a user that has "groups": ["sysadmin"] in the json
[2012-09-04 19:07:08 -0400] stormerider: for example, $work has a customized one that will create groups and users and modify existing users to add them to new groups if the user databag item gets updated.
[2012-09-04 19:07:31 -0400] stormerider: all with a customized recipe, we didnt have to change the rest of the cookbook
[2012-09-04 19:10:53 -0400] stormerider: its more of a proof of concept framework cookbook
[2012-09-04 19:11:49 -0400] wamilton: you almost need something stronger like an additional acl package or ldap to give you enough assumptions for the cookbook to do a lot out of the box
[2012-09-04 19:12:39 -0400] wamilton: or you at least need some sort of canonical unix user management and grouping strategy, and then you can make a recipe for that because you could uniquely specify the things you're maintaining with a few parameters
[2012-09-04 19:27:10 -0400] makerbreakr: if i programatically create a data bag: https://gist.github.com/3625371
[2012-09-04 19:27:31 -0400] makerbreakr: do I need to edit the recipe to make things work?
[2012-09-04 19:29:27 -0400] wamilton: data_bags are organization-wide... this seems dangerous
[2012-09-04 19:30:28 -0400] yfeldblum_: wamilton, why?
[2012-09-04 19:30:47 -0400] geekbri: stormerider: we have the same thing here... our own customer user cookbook that manages users that are stored in databags
[2012-09-04 19:31:10 -0400] wamilton: yfeldblum_: does it naturally avoid overwriting in some way I'm not seeing?
[2012-09-04 19:31:11 -0400] yfeldblum_: makerbreaker, you should probably not be creating data-bags or data-bag items from within recipes
[2012-09-04 19:31:19 -0400] yfeldblum_: wamilton, of course not
[2012-09-04 19:31:26 -0400] yfeldblum_: wamilton, why does it seem dangerous?
[2012-09-04 19:31:43 -0400] wamilton: yfeldblum_: because then you would overwrite the users every time you ran chef client
[2012-09-04 19:31:47 -0400] makerbreakr: yfeldblum_ it wont be from within a recipe, it will be an external application
[2012-09-04 19:32:24 -0400] yfeldblum_: makerbreaker, *knife* programmatically can create data-bags and data-bag items based on what you stick in the command-line when you invoke it ...
[2012-09-04 19:32:39 -0400] yfeldblum_: wamilton, huh?
[2012-09-04 19:33:07 -0400] wamilton: yfeldblum_: in this application I mean -- not every databag is full of users
[2012-09-04 19:33:11 -0400] makerbreakr: yfeldblum_ what I was planning on doing, from a script, is to create a user.json
[2012-09-04 19:33:20 -0400] yfeldblum_: makerbreaker, why?
[2012-09-04 19:33:36 -0400] makerbreakr: then, with knife create a databag from file, run a recipe to add the user
[2012-09-04 19:33:47 -0400] yfeldblum_: wamilton, still ... i can't quite tell what you're talking about ...
[2012-09-04 19:34:02 -0400] makerbreakr: I have a rails app, and I want it to create users random systems
[2012-09-04 19:34:08 -0400] makerbreakr: users on*
[2012-09-04 19:34:50 -0400] makerbreakr: right now, the rails app spins up a rackspace virtual machine, and bootstraps the server.  i want it to also add a user
[2012-09-04 19:35:27 -0400] yfeldblum_: makerbreaker, ok ... i don't see why you're creating a file and shelling out to knife, when you could very simply and very easily do it straight from ruby with either the `chef` gem or the `spice` gem
[2012-09-04 19:37:04 -0400] yfeldblum_: wamilton, i can't tell how you started from data-bags being organization-wide, moved on to dangerousness, and arrived at overwriting users ...
[2012-09-04 19:38:06 -0400] wamilton: yfeldblum_: because we were talking about organization wide representation of user access being rewritten whenever any machine invoked chef-client
[2012-09-04 19:38:42 -0400] wamilton: yfeldblum_: there was no 'moving on' anywhere in here because there was no deduction -- it was the state that was being discussed
[2012-09-04 19:39:16 -0400] yfeldblum_: wamilton, but recipes shouldn't be modifying data-bag items ... why would running chef-client change the users data-bag?
[2012-09-04 19:39:33 -0400] wamilton: yfeldblum_: I was reacting to the gist makerbreakr posted
[2012-09-04 19:40:33 -0400] yfeldblum_: wamilton, ah
[2012-09-04 19:41:15 -0400] wamilton: yfeldblum_: so with that missing piece, it turns out we agree ;)
[2012-09-04 19:41:36 -0400] makerbreakr: im still unsure how to link up a databag and a recipe
[2012-09-04 19:41:44 -0400] yfeldblum_: wamilton, not on the subject of "danger" ...
[2012-09-04 19:42:09 -0400] yfeldblum_: makerbreaker, think of data-bags as if they were mysql tables in a large central mysql database, and data-bag items as if they were records in these mysql tables
[2012-09-04 19:42:30 -0400] wamilton: yfeldblum_: I think that might be a semantic difference -- why should recipes not modify data_bags and their items if not because it could be "dangerous" ?
[2012-09-04 19:43:34 -0400] yfeldblum_: makerbreaker, recipes can run whatever code you like; one typical pattern is to query the central CM database for information and then use that information to declare a set of resources
[2012-09-04 19:44:06 -0400] yfeldblum_: makerbreaker, you have complete freedom to design your central "tables" any way you like, and the complete freedom to write whatever queries you like in your recipes
[2012-09-04 19:45:08 -0400] makerbreakr: ah, okay
[2012-09-04 19:45:10 -0400] makerbreakr: that helps
[2012-09-04 19:45:23 -0400] yfeldblum_: wamilton, recipes should be declaring resources and adding bits of data to the node's attributes to be saved later on
[2012-09-04 19:45:44 -0400] geekbri: I only read from data_bags in recipes
[2012-09-04 19:46:03 -0400] organicveggie: Does anyone know if Chef 10.12.0 clients can safely talk to a 0.9.14 server?
[2012-09-04 19:46:36 -0400] yfeldblum_: makerbreaker, there are a few "users" cookbooks out there, with some similarities and some differences, but they typically follow that pattern: search the "users table" (users data-bag) in the central database, declare users resources, assign attributes, assign actions, and done
[2012-09-04 19:46:58 -0400] yfeldblum_: organicveggie, they cannot
[2012-09-04 19:47:09 -0400] organicveggie: yfeldblum: good to know.
[2012-09-04 19:47:26 -0400] yfeldblum_: organicveggie, the backcompat works the other way: chef-client 0.9 can talk to chef-server 0.10
[2012-09-04 19:47:41 -0400] wamilton: yfeldblum_: If I understand you correctly, you're saying that one should use that method because it's better, not because altering data_bags in a recipe is "dangerous". I feel like the method that you describe exists because modifying data_bags in a recipe is dangerous and there needs to be a better way. Am I still missing something?
[2012-09-04 19:48:09 -0400] makerbreakr: yfeldblum_ but how does the recipe know which user to go with?
[2012-09-04 19:48:15 -0400] makerbreakr: ie, how can I pass the recipe a variable?
[2012-09-04 19:48:22 -0400] yfeldblum_: wamilton, firstly, there's little if any write-time concurrency control in the chef-server-api
[2012-09-04 19:48:50 -0400] yfeldblum_: makerbreaker, the recipes typically create multiple user resources in a loop, looping over the 0, 1, or N results from the query
[2012-09-04 19:49:03 -0400] makerbreakr: What I am imagining, is spice creating a databag on my chef server, applying users recipe to a node, the recipe creates a user based on X
[2012-09-04 19:50:00 -0400] organicveggie: yfeldblum_: Also very good to know. Thanks!
[2012-09-04 19:51:22 -0400] makerbreakr: i need my recipe to read some sort of external variable
[2012-09-04 19:51:28 -0400] yfeldblum_: makerbreaker, why?
[2012-09-04 19:51:46 -0400] makerbreakr: i dont want to add all the users in the databag, just a particular one
[2012-09-04 19:51:58 -0400] yfeldblum_: makerbreaker, so ...
[2012-09-04 19:52:44 -0400] makerbreakr: how does the recipe know which one i want ?
[2012-09-04 19:52:59 -0400] yfeldblum_: makerbreaker, when you store the data-bag item from inside the rails app, you can include in the data-bag item not just the user's attributes, but also the node-name for which the user applies
[2012-09-04 19:53:24 -0400] makerbreakr: aaah
[2012-09-04 20:02:32 -0400] kshep: Hey, is there a preferred idiom for doing node.run_list.expand in a 0.9/0.10 neutral way?
[2012-09-04 20:08:04 -0400] xmltok: what are other people doing when they need to modify a third party recipe? I can take something like ohai and add plugins to it, but then i need to bump my version number to something outside of what the public repo will be
[2012-09-04 20:12:40 -0400] Leitz: For what it's worth, chef server build from OmniBus seems to fail on 1/2G of RAM. I tried it, watched the failure, added RAM, it worked.
[2012-09-04 20:15:19 -0400] _0x783czar: Can anyone think of a reason why one of my recipes in the run list would run out of order?
[2012-09-04 20:16:20 -0400] _0x783czar: say my run list is: [cookbook1, cookbook2, cookbook3]
[2012-09-04 20:16:53 -0400] _0x783czar: for some reason cookbook1's default only runs about two lines before cookbook2 starts running
[2012-09-04 20:17:11 -0400] miah: does cookbook1 depend on cookbook2 ?
[2012-09-04 20:17:34 -0400] _0x783czar: miah: no
[2012-09-04 20:18:42 -0400] yfeldblum_: _0x783czar, recipes running vs chef-client converging?
[2012-09-04 20:19:06 -0400] _0x783czar: yfeldblum_: hmmm
[2012-09-04 20:20:47 -0400] kshep: _0x783czar I know it sounds like a dumb question, but how are you determining that they're running out of order?
[2012-09-04 20:20:52 -0400] kshep: chef_client output?
[2012-09-04 20:21:01 -0400] kshep: or looking at what's getting changed/installed?
[2012-09-04 20:22:13 -0400] _0x783czar: kshep: looking at what gets changed.  cookbook2 fails (due to expecting the post conditions from cookbook1) and as I check the state of the machine I can see that cookbook1 has not preformed its changes.
[2012-09-04 20:23:44 -0400] kshep: Cool. I only ask because I've been confused more than once by chef-client output :-)
[2012-09-04 20:23:55 -0400] _0x783czar: kshep: understoo
[2012-09-04 20:23:58 -0400] _0x783czar: d
[2012-09-04 20:27:50 -0400] _pabst_: How do I manually set the init style for chef-client?
[2012-09-04 20:28:24 -0400] _0x783czar: OK, I think it has something to do with the compling vs the converging
[2012-09-04 20:28:38 -0400] kshep: _0x783czar: do you have ruby outside resource blocks? that certainly can confuse things
[2012-09-04 20:29:14 -0400] _0x783czar: kshep: yes, that's what I found.
[2012-09-04 20:29:27 -0400] kshep: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-09-04 20:29:41 -0400] kshep: wait... that's not it....
[2012-09-04 20:30:22 -0400] _0x783czar: kshep: it appears that I'm calling a ruby method outside of a ruby block that depends on cookbook 1
[2012-09-04 20:30:32 -0400] _0x783czar: kshep: that's where its getting tripped up
[2012-09-04 20:31:24 -0400] kshep: http://nuknad.com/2011/08/31/chef-recipe-order/
[2012-09-04 20:31:45 -0400] kshep: ^- I think that's explained somewhere in the stock docs... can't find it offhand tho
[2012-09-04 20:34:11 -0400] fish_: hrm.. is using opscode's deb packages the way to go for chef 0.10? we used bootstrap in the past and now I'm not sure what to use today
[2012-09-04 20:34:36 -0400] fish_: using debs seems to be the easiest way, but I'm not sure if there are any downsides?
[2012-09-04 20:39:50 -0400] yfeldblum_: fish_, opscode seems to be moving towards their full-stack installer, which installs an isolated copy of ruby, gems, and chef into /opt/chef
[2012-09-04 20:40:28 -0400] fish_: yfeldblum_: hrm..
[2012-09-04 20:40:49 -0400] fish_: yfeldblum_: but that's not yet available?
[2012-09-04 20:41:16 -0400] cheeseplus: fish_: http://www.opscode.com/chef/install/
[2012-09-04 20:41:32 -0400] stormerider: fish_: if you use the omnibus installer that's what it does
[2012-09-04 20:43:37 -0400] fish_: cheeseplus: hrm so everything wrapped up in one deb.. hrm
[2012-09-04 20:44:03 -0400] fish_: I'm thinkin about splitting up chef from couchdb and solr, guess than I have to use a different way
[2012-09-04 20:45:26 -0400] cheeseplus: it does wrap it in a deb, just not the same as using an apt-repo though
[2012-09-04 20:48:13 -0400] fish_: cheeseplus: wrapping everything up in a deb might be a good thing for smaller setups, but splitting up different parts of chef isn't supported with that I guess
[2012-09-04 20:48:40 -0400] cheeseplus: fish_: are you talking about server or client?
[2012-09-04 20:49:07 -0400] cheeseplus: that installer is only client
[2012-09-04 20:49:11 -0400] fish_: ah
[2012-09-04 20:49:16 -0400] fish_: confused :)
[2012-09-04 20:49:20 -0400] maxmanders: Not strictly related to chef, but I've started using a Mac and am trying out Tmux rather than GNU Screen - knife and e.g. chef-client -v work under zsh on iterm2, and under GNU screen - but if I start tmux I get errors about being unable to find the chef gem... thoughts?
[2012-09-04 20:51:01 -0400] fish_: yes, I was quite unspecific on that. I'm wondering how to bootstrap a 0.10 server, given that I already have a 0.9 server
[2012-09-04 20:51:14 -0400] cheeseplus: fish_: with regard to Chef Server I'm not sure why you would want to break it up for the record chef-server is moving away from merb/couchdb to erlang/mysql
[2012-09-04 20:51:27 -0400] fish_: and I also think about separating chef + workers from couchdb/solr/rabbit
[2012-09-04 20:52:32 -0400] cheeseplus: fish_: I think if you are going to that extent then you will probably be on your own
[2012-09-04 20:54:13 -0400] fish_: cheeseplus: okay, guess I'll try the deb-based-way for now
[2012-09-04 20:54:33 -0400] ctracey: mattray: i know we had talked about isc-dhcp-server for pxe_dust.  has dnsmasq been considered?  might be a little more lightweight and could fit nicely with the way openstack has implemented dhcp.
[2012-09-04 20:56:44 -0400] mattray: ctracey: not specifically. I just used the default dhcp server, I've got no strong preferences, as long as dnsmasq supports all the same features
[2012-09-04 20:56:57 -0400] mattray: hadn't really thought about it's use in openstack though
[2012-09-04 20:57:27 -0400] miah: i'd rather see pxe_dust abstract out the dhcp stuff so that you can use dnsmasq, or isc (because i dont want to use dnsmasq)
[2012-09-04 20:57:28 -0400] ctracey: mattray: wrt to pxe booting it works just fine.  config files are much more flat.
[2012-09-04 20:57:52 -0400] mattray: miah: no dependency on dhcp yet
[2012-09-04 20:58:06 -0400] ctracey: miah: would be easy enough to do
[2012-09-04 20:59:03 -0400] ctracey: miah: my reasoning is that I would like to comingle openstack and a chef server
[2012-09-04 20:59:26 -0400] mattray: ctracey: eventually I'd like to use omapi with pxe dust, does dnsmasq support that?
[2012-09-04 20:59:51 -0400] ctracey: similarly, I would like to use pxe_dust and openstack-dashboard together as well.
[2012-09-04 21:00:26 -0400] ctracey: mattray: yeah, i saw your notes about that.  i will have to look into it
[2012-09-04 21:01:36 -0400] ctracey: mattray: from the cobbler folks..."OMAPI support for updating ISC DHCPd is actually not supported. This was a buggy feature (we think OMAPI itself is buggy) and apparently OMAPI is slated for removal in a future version of ISC dhcpd."
[2012-09-04 21:02:04 -0400] ctracey: https://github.com/cobbler/cobbler/wiki/DHCP%20management
[2012-09-04 21:02:15 -0400] mattray: ctracey: hmmm will have to think about that feature implemented some other way perhaps
[2012-09-04 21:03:00 -0400] ctracey: mattray: can you elaborate on the use case?
[2012-09-04 21:03:34 -0400] mattray: managing what a box should boot via pxe with a knife plugin
[2012-09-04 21:03:55 -0400] mattray: tell a box to change OSes
[2012-09-04 21:04:15 -0400] hoover_damm: lol
[2012-09-04 21:04:17 -0400] mattray: it's a wish list
[2012-09-04 21:04:19 -0400] ctracey: mattray: that is what i thought.  i think this can be easily managed with a knife plugin.
[2012-09-04 21:04:23 -0400] hoover_damm: that's more of a provisioning problem
[2012-09-04 21:04:31 -0400] mattray: hoover_damm: pxe_dust is provisioning
[2012-09-04 21:04:40 -0400] hoover_damm: I would love Opscode to get into this... but isn't this a little far off opscode's roadmap?
[2012-09-04 21:04:51 -0400] mattray: hoover_damm: absolutely correct
[2012-09-04 21:04:53 -0400] ctracey: not when it comes to pxe_dust
[2012-09-04 21:04:54 -0400] hoover_damm: I mean i'm basically at the same point but I want to write a clojure dashboard
[2012-09-04 21:05:01 -0400] hoover_damm: ctracey, i'm another pxe_dust user
[2012-09-04 21:05:28 -0400] mattray: Opscode has no preference for provisioning boxes, as long as they get Chef on them :)
[2012-09-04 21:05:30 -0400] hoover_damm: ctracey, I manage 268 servers on metal that I reinstall via pxe_dust and would love to automate that cleaner / better.
[2012-09-04 21:05:35 -0400] miah: ctracey: ya, but i can't find that stated by ISC anywhere.
[2012-09-04 21:05:42 -0400] hoover_damm: i'm pretty agnostic honestly as far as Chef or puppet
[2012-09-04 21:05:54 -0400] hoover_damm: having seen puppet only tools, I'd be more inclined to leave chef or puppet an option
[2012-09-04 21:06:10 -0400] hoover_damm: more 3rd party then first party
[2012-09-04 21:06:26 -0400] hoover_damm: sad but true, there are too many opinionated tools that only work for puppet or chef...
[2012-09-04 21:06:55 -0400] ctracey: hoover_damm: same here.  100+ metal and ~1000 in the cloud.  also chef/puppet agnostic.  would be damn nice to have something much more simple and usable than cobbler imho.
[2012-09-04 21:07:28 -0400] hoover_damm: ctracey, yeah once I get the go ahead i'm going to write a dirt simple dashboard with a post hook to have the preseed/kickstart hit
[2012-09-04 21:07:48 -0400] hoover_damm: ctracey, and have it finish off with a post-install command, have a more unopinionated way to fill in the data
[2012-09-04 21:08:04 -0400] hoover_damm: simple dashboard to populate, reimage, fill in data
[2012-09-04 21:08:18 -0400] hoover_damm: that's at least on my roadmap once I get the go ahead
[2012-09-04 21:08:26 -0400] ctracey: hoover_damm: on top of pxe_dust you mean
[2012-09-04 21:08:30 -0400] hoover_damm: of course
[2012-09-04 21:08:41 -0400] miah: what do i have to do to properly pass these keys/values out of a iterator as parameteres? https://github.com/miah/nagios/blob/refactor/recipes/_nagios_config.rb#L83
[2012-09-04 21:08:49 -0400] hoover_damm: ctracey, well pxe_dust is more or less just a way to set it up... it's not really anything special in itself
[2012-09-04 21:09:09 -0400] ctracey: hoover_damm: i thought about this problem as well.  not a huge fan of dashboards.  why not just a knife plugin to manage these sorts of tasks?
[2012-09-04 21:09:09 -0400] hoover_damm: I modify our preseed file, I have to configure 2 interfaces, set a root password based on api... etc
[2012-09-04 21:09:26 -0400] hoover_damm: ctracey, if it's restful the knife plugin is just a slapshot
[2012-09-04 21:09:48 -0400] hoover_damm: ctracey, remember we may prefer restful/cleaner ways... but dashboards are for micromanagers
[2012-09-04 21:09:57 -0400] ctracey: hehe
[2012-09-04 21:10:02 -0400] hoover_damm: better to provide both then be asked for it later on
[2012-09-04 21:10:03 -0400] ctracey: i dont have one of those (yet)
[2012-09-04 21:10:30 -0400] hoover_damm: that freaks me out
[2012-09-04 21:10:47 -0400] halcyonCorsair: can someone confirm for me, metadata basically has no current use when using chef-solo, correct?
[2012-09-04 21:11:43 -0400] JasonBox: There's a standup?
[2012-09-04 21:11:57 -0400] ctracey: hah
[2012-09-04 21:12:07 -0400] JasonBox: Is that like ops humor?
[2012-09-04 21:12:21 -0400] ctracey: no - agile humor
[2012-09-04 21:12:35 -0400] JasonBox: Oh!
[2012-09-04 21:12:40 -0400] miah: halcyonCorsair: no. cookbook dependencies are sorted out from the metadata
[2012-09-04 21:12:46 -0400] JasonBox: I think all humor should be agile anyway
[2012-09-04 21:12:59 -0400] Blackavar: Ayup, hoover_damm - built my own tool to generate Kickstarts and build/manage packages and repos in previous place, now dealing with Crowbar at home - it works nicely, but is a little scary under the hood, and once again building the same sort of tool for current gig. There's room to make this more general.
[2012-09-04 21:13:32 -0400] Blackavar: Waterfall humor? Need to gather specs and make a detailed plan for the joke first.
[2012-09-04 21:14:40 -0400] ctracey: there is nothing humorous about waterfall
[2012-09-04 21:14:47 -0400] ctracey: (or agile for that matter)
[2012-09-04 21:14:50 -0400] hoover_damm: people mistake agility for micromanagement
[2012-09-04 21:15:07 -0400] JasonBox: Blackavar: Indeed, building a kickstart tool myself at present
[2012-09-04 21:15:14 -0400] ctracey: understatement of the year
[2012-09-04 21:15:19 -0400] hoover_damm: you can have a rapidly evolving organization without having to announce what your doing every day to your team
[2012-09-04 21:15:29 -0400] hoover_damm: you let them know before it happens during the day
[2012-09-04 21:15:34 -0400] yfeldblum_: halcyonCorsair, that's correct; chef-solo loads the libraries, providers, resources, definitions, and attributes from all cookbooks located in the config file's cookbook_path
[2012-09-04 21:15:38 -0400] hoover_damm: smaller events, take up less time
[2012-09-04 21:15:40 -0400] hoover_damm: more win
[2012-09-04 21:15:45 -0400] Blackavar: Ahh, fire drill.
[2012-09-04 21:15:50 -0400] ctracey: hoover_damm: amen
[2012-09-04 21:15:59 -0400] yfeldblum_: halcyonCorsair, regardless of the metadata in any cookbok
[2012-09-04 21:16:22 -0400] miah: interesting.. thanks for clarifying yfeldblum_
[2012-09-04 21:16:29 -0400] yfeldblum_: hoover_damm, how long do these standups take?
[2012-09-04 21:16:41 -0400] cmceldowney: hi all. quick question: we've got a cron-type task, e.g. backup directory X. We want to trigger it from chef-client instead of by having to dump a cron script onto the box. What's the best way to dictate the interval that a specific recipe (or portion of a recipe) runs, since otherwise it would run on every chef-client run?
[2012-09-04 21:17:00 -0400] ctracey: yfeldblum_: in theory or reality?
[2012-09-04 21:17:45 -0400] hoover_damm: most engineers who do standups usually stop working about anywhere from 15-45minutes before the standup.  The actual standup can take 15minutes to an hour, and then usually there's people taking a small break after that (15-45)
[2012-09-04 21:17:57 -0400] yfeldblum_: ctracey, in reality
[2012-09-04 21:18:00 -0400] hoover_damm: a daily standup can take roughly 2hours out of your day at least
[2012-09-04 21:18:06 -0400] ctracey: supposed to be what you did yesterday, what youre doing today, and identification of impediments
[2012-09-04 21:18:14 -0400] yfeldblum_: hoover_damm, yeah you all are doing standup wrong ...
[2012-09-04 21:18:15 -0400] hoover_damm: at the worst case scenario
[2012-09-04 21:18:16 -0400] miah: a 2 hour daily standup is a standup implemented incorrectly
[2012-09-04 21:18:31 -0400] hoover_damm: miah, that's how they were at engineyard towards the end before we stopped participating
[2012-09-04 21:18:32 -0400] miah: 10 - 15 minutes tops
[2012-09-04 21:18:42 -0400] hoover_damm: had a lot of people to go through
[2012-09-04 21:18:46 -0400] hoover_damm: even 1-2minute per person tops
[2012-09-04 21:19:05 -0400] yfeldblum_: hoover_damm, a 60-person standup?
[2012-09-04 21:19:08 -0400] hoover_damm: but i'm also describing the slouching pattern before hand
[2012-09-04 21:19:14 -0400] ctracey: in my experience, most orgs that claim "agile" are just throwing a standup on top of waterfall
[2012-09-04 21:19:18 -0400] hoover_damm: yfeldblum_, 45 actually
[2012-09-04 21:19:25 -0400] JasonBox: hrm
[2012-09-04 21:19:53 -0400] yfeldblum_: hoover_damm, that's just called a "daily company-wide meeting"
[2012-09-04 21:19:59 -0400] yfeldblum_: hoover_damm, "standup" is the wrong word for that
[2012-09-04 21:20:13 -0400] halcyonCorsair: yfeldblum_: ok, thanks
[2012-09-04 21:20:27 -0400] hoover_damm: yfeldblum_, they called it a standup, debating it beyond that part is an opinion and is not needed in #chef.
[2012-09-04 21:21:37 -0400] yfeldblum_: ctracey, mhmm
[2012-09-04 21:22:27 -0400] ctracey: i prefer something more kanban-like.
[2012-09-04 21:22:46 -0400] ctracey: gimme work, let me prioritize it, and just get it done
[2012-09-04 21:25:03 -0400] hoover_damm: ctracey, that is how /I/ personally work
[2012-09-04 21:25:09 -0400] hoover_damm: ctracey, I love it
[2012-09-04 21:26:08 -0400] ctracey: hoover_damm: trello is your friend
[2012-09-04 21:28:38 -0400] halcyonCorsair: ok, so if I want to install a bunch of dependencies (apache2, mysql, lots of perl), check out a perl application, and then run a few arbitrary application commands, is the application cookbook (https://github.com/opscode-cookbooks/application) the way to go?
[2012-09-04 21:30:28 -0400] yfeldblum_: halcyonCorsair, it is *a* way to go
[2012-09-04 21:30:36 -0400] yfeldblum_: halcyonCorsair, just like chef is *a* way to go
[2012-09-04 21:30:47 -0400] hoover_damm: ctracey, one of my clients uses Jira and the agile dashboard has Kanban mode
[2012-09-04 21:30:48 -0400] hoover_damm: :)
[2012-09-04 21:30:59 -0400] halcyonCorsair: yfeldblum_: pros vs cons?
[2012-09-04 21:31:22 -0400] Blackavar: Welcome back upstairs, Opscode people.
[2012-09-04 21:31:35 -0400] hoover_damm: ctracey, but gonna use it anywho
[2012-09-04 21:31:38 -0400] cwj: nginx cookbook y u make me so sad
[2012-09-04 21:31:56 -0400] yfeldblum_: halcyonCorsair, it is highly opinionated in that it does things in its way, which may not work exactly for your needs
[2012-09-04 21:34:35 -0400] halcyonCorsair: yfeldblum_: are there any good articles on the chef way of doing some of these things? eg. not some other way that I happen to have shoehorned chef into implementing?
[2012-09-04 21:35:17 -0400] wamilton: halcyonCorsair: funny seeing you here :)
[2012-09-04 21:35:29 -0400] yfeldblum_: halcyonCorsair, do it manually, record what you're doing, put it into the language of resources and their attributes, put it in a recipe
[2012-09-04 21:35:30 -0400] wamilton: halcyonCorsair: aegir channel get too boring?
[2012-09-04 21:36:10 -0400] yfeldblum_: halcyonCorsair, look at the application cookbook for inspiration, and see if it matches what you're doing manually anyway
[2012-09-04 21:37:39 -0400] wamilton: halcyonCorsair: also worth noting is that it's based on the way Capistrano considers an application, so the flexing and bending to match it to a Perl or Drupal app is the same sort of flex you'd be doing for a cap thing, except that you can potentially orchestrate it with things like apache and mysql config a bit easier because it's "all in chef"
[2012-09-04 21:38:50 -0400] halcyonCorsair: wamilton: hmm, lol, i'm escaping aegir/drupal at the moment, aegir in particular as I have issues with the basic model and no longer have to use it at my job
[2012-09-04 21:39:33 -0400] wamilton: halcyonCorsair: me too, I've been thinking about just doing drupal apps in chef, but I'm sick of Drupal by the time I have free time, so it doesn't happen
[2012-09-04 21:40:36 -0400] cwj: i feel like bash resources used to show me their output in a chef run, maybe on stdout, but it seems like they dont anymore
[2012-09-04 21:40:50 -0400] cwj: is that a recent change?
[2012-09-04 21:42:35 -0400] jonlives: cwj: they haven't for quite a while
[2012-09-04 21:42:47 -0400] halcyonCorsair: wamilton: i wrote this https://github.com/halcyonCorsair/fabric-deploy along with some puppet for my ex-organisations deployments, but I'm pretty sick of the drupal swiss army knife thing
[2012-09-04 21:43:14 -0400] cwj: jonlives: really? hrm
[2012-09-04 21:43:15 -0400] cwj: this resource claims to have executed properly but its not doing what its supposed to https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L80
[2012-09-04 21:44:56 -0400] cwj: i think its because of the attribute concatenation discussed in this pull request https://github.com/opscode-cookbooks/nginx/pull/14
[2012-09-04 21:45:18 -0400] cwj: but i cant really tell what is happening inside that bash resource, even in debug log level
[2012-09-04 21:46:32 -0400] wamilton: halcyonCorsair: if I understand you properly, I have the same kind of issue. Our Aegir project has stalled because leadership wants it to facilitate turnkey updates of literally any drupal site, which is impossible for any infrastructure management solution, because you absolutely have to come up with a process that takes finite parallel inputs.
[2012-09-04 21:46:59 -0400] wamilton: halcyonCorsair: what I'm left with is coming up with a finite-input process for chef or similar, and pitching that. But, again, free time.
[2012-09-04 21:47:34 -0400] yfeldblum_: cwj, probably not since the switch to Mixlib::ShellOut
[2012-09-04 21:47:42 -0400] cwj: ah
[2012-09-04 21:49:06 -0400] cmceldowney: All. what's the best way to run a recipe periodically on a chef node, but not as part of the regular chef-client daemon?
[2012-09-04 21:50:18 -0400] yfeldblum_: cmceldowney, why would you need to do that?
[2012-09-04 21:51:17 -0400] cmceldowney: yfeldblum_: e.g. I have a backup script that I want to run from a recipe. I could always dump the script as a cron task (and maybe that's the way to do things), but since Chef offers me the objects and methods I want, then it would be easier to do it in that world
[2012-09-04 21:51:35 -0400] yfeldblum_: cmceldowney, um you should dump the script and cron it instead ...
[2012-09-04 21:52:09 -0400] yfeldblum_: cmceldowney, what "objects and methods" do you need?
[2012-09-04 21:53:04 -0400] yfeldblum_: cmceldowney, also chef-client runs should take just seconds when the system is already converged ... chef-client should not be used to perform repeated long-running tasks
[2012-09-04 21:54:18 -0400] cmceldowney: yfeldblum_: for example,I'm looking at running an AWS EBS backup. There's an ebs cookbook (and associated ruby libraries), that give the objects and methods I need. So ideally I'd like to just use the chef-client bootstrap to load in the objects, then the recipe runs the task I want to run... but not every 5 minutes....
[2012-09-04 21:55:52 -0400] halcyonCorsair: wamilton: always tough to find free time :|
[2012-09-04 21:56:16 -0400] yfeldblum_: cmceldowney, you can use the ruby libs from a backup script that you drop and cron
[2012-09-04 21:57:14 -0400] yfeldblum_: cmceldowney, e.g. first shebang it with #!/usr/bin/env ruby, and then you can use ruby, fog (http://fog.io/1.5.0/index.html), etc to do all that
[2012-09-04 21:57:57 -0400] cmceldowney: yfeldblum_: ok. I guess it's just a matter of finding paths to the custom libraries/ruby objects that are defined in cookbooks.. that's the work that chef server takes care of for you in the  middle of a chef-client run
[2012-09-04 21:58:14 -0400] yfeldblum_: cmceldowney, no no no no no
[2012-09-04 21:58:48 -0400] yfeldblum_: cmceldowney, the script should be standalone, or should depend on gems that you install on the server, but should *not* depend on anything in chef
[2012-09-04 21:59:13 -0400] Pushnell: hey all.  chef noob here reading the apache2 recipe to try to learn more.  What does the line "package_name node['apache']['package']" do?  It looks like it's setting package_name from the value of node['apache']['package'] but I don't know how that attribute got set.
[2012-09-04 21:59:38 -0400] yfeldblum_: Pushnell, please provide links to the file/line on github
[2012-09-04 21:59:47 -0400] cmceldowney: yfeldblum_: ok. understood. I think I can just use the ohai gem to pull in information about the current node from within my custom ruby backup script.. that should cover most anything I would want from chef/chef-client/chef-server
[2012-09-04 22:00:24 -0400] Pushnell: https://github.com/opscode-cookbooks/apache2/blob/master/recipes/default.rb#L21
[2012-09-04 22:00:30 -0400] wamilton: Pushnell: that attribute gets set when you edit the node or if you set it as a default in the recipe or role or an override in the role
[2012-09-04 22:00:31 -0400] yfeldblum_: cmceldowney, no don't use ohai from within the backup script - you can use chef to generate the script file from a template
[2012-09-04 22:01:02 -0400] cmceldowney: yfeldblum_: ah, of course. use chef to write ruby... duh me.
[2012-09-04 22:01:09 -0400] xmltok: do you guys keep the cookbook recipes/templates/all that stuff, in the main chef repository?
[2012-09-04 22:01:20 -0400] xmltok: seems like it would get huge to check out for small edits
[2012-09-04 22:01:33 -0400] wamilton: Pushnell: if you want to just use the cookbook out of the box, you can either set those attributes with `knife node edit` and setting a role on it and putting that recipe in the role runlist, or just have the runlist on the node if you don't plan on generalizing
[2012-09-04 22:02:12 -0400] wamilton: Pushnell: and if this is chef-solo, you would be setting the node json in the provision block
[2012-09-04 22:02:40 -0400] wamilton: Pushnell: what it's doing is trying to figure out which package to ask the package manager for
[2012-09-04 22:02:42 -0400] yfeldblum_: cmceldowney, a similar approach (one that i prefer) is to have a static script (rather than a template) that reads a config file in YAML or JSON format or whatever other format you like, and use chef to drop off and cron the script file as well as to generate that config file that the script reads
[2012-09-04 22:03:13 -0400] yfeldblum_: cmceldowney, your chef recipe can of course generate that config file using the node data that it has, including the node data that comes from ohai
[2012-09-04 22:03:51 -0400] Pushnell: wamilton: ah, thanks so much for explaining :)  I've just discovered attributes/default.rb which sets that.
[2012-09-04 22:03:55 -0400] Urocyon: xmltok I recently move to using berkshelf, and now keep my cookbooks separate, each in it's own repository.
[2012-09-04 22:03:55 -0400] cmceldowney: yfeldblum_: understood. thanks for the sanity check. :)
[2012-09-04 22:04:23 -0400] xmltok: i am doing that now but without berkshelf, it causes some problems with spork
[2012-09-04 22:04:54 -0400] yfeldblum_: cmceldowney, no probs
[2012-09-04 22:06:00 -0400] Urocyon: xmltok: berkshelf provides a way to install shims that might make spark happier.
[2012-09-04 22:06:14 -0400] Urocyon: librarian might do the same.
[2012-09-04 22:06:21 -0400] xmltok: ok
[2012-09-04 22:06:28 -0400] xmltok: let me try that one out
[2012-09-04 22:06:46 -0400] Urocyon: s/spark/spork/
[2012-09-04 22:06:57 -0400] Urocyon: My spellchecker gets over excited sometimes.
[2012-09-04 22:08:41 -0400] Urocyon: what spork command is complaining, xmltok
[2012-09-04 22:08:45 -0400] yfeldblum_: librarian-chef does not currently do shims - it copies cookbooks into ./cookbooks/ (you can change the directory if you like)
[2012-09-04 22:10:04 -0400] jonlives: xmltok: fyi the next spork release is gonna behave itself when you're not running commands from the chef repo root
[2012-09-04 22:10:16 -0400] xmltok: ah jonlives well done
[2012-09-04 22:10:41 -0400] xmltok: as we adopt chef it looks like spork may bring the largest amount of sanity to the work flow
[2012-09-04 22:10:55 -0400] xmltok: have you seen spork work with berkshelf?
[2012-09-04 22:11:01 -0400] jonlives: that's what i envisaged for us when i wrote it :p
[2012-09-04 22:11:09 -0400] jonlives: xmltok: i don't use berkshelf personally
[2012-09-04 22:11:34 -0400] xmltok: you guys have one fat repo for chef repo and all the subdirectories?
[2012-09-04 22:12:01 -0400] jonlives: xmltok: yeah, tho we don't necessarily run commands from that dir - I have a few people nagging me to fix that internally too :p
[2012-09-04 22:12:50 -0400] wamilton: Pushnell: yw
[2012-09-04 22:12:52 -0400] jonlives: spork works fine with multiple cookbook_paths, but the new version wasn't behaving properly when you weren't running commands in one of them.
[2012-09-04 22:13:02 -0400] jonlives: which I'm fixing :p
[2012-09-04 22:13:25 -0400] xmltok: as it is, when i run spork to promote a cookbook, it updates my environment jsons but i dont see any kind of git add or commit done, not sure if i was supposed to
[2012-09-04 22:13:40 -0400] xmltok: but yeah, its very picky about where i am when i run certain commands
[2012-09-04 22:14:04 -0400] jonlives: xmltok: that's the other thing I'm fixing - currently if you run the command from a *subdirectory* of the git repo, the plugin doesn't work.
[2012-09-04 22:14:12 -0400] xmltok: no big deal, it will be nice to have that fixed. i suppose the majority of my problems arise from having a repo for ~/.chef and a bunch of repos checked out into ~/.chef/cookbooks
[2012-09-04 22:14:13 -0400] jonlives: the next version will work anywhere
[2012-09-04 22:14:40 -0400] rshade98: What do you guys think of this patch to knife cookbook metadata
[2012-09-04 22:14:42 -0400] rshade98: http://pastebin.com/HSQL7ne9
[2012-09-04 22:15:22 -0400] jonlives: xmltok: in short, the next release will be extremely non-picky about where you run commands from
[2012-09-04 22:15:33 -0400] xmltok: good stuff
[2012-09-04 22:15:52 -0400] jonlives: xmltok: should be out this week, hopefully.
[2012-09-04 22:16:38 -0400] kombatunit: Does anyone have chefspec code that can deal with this:
[2012-09-04 22:16:40 -0400] kombatunit: chef_gem "fog" do   version "1.3.1"   action :install end
[2012-09-04 22:17:00 -0400] kombatunit: I tried "chef_run.should install_gem_package_at_version 'fog', '1.3.1'" but it fails
[2012-09-04 22:17:38 -0400] kombatunit: I also tried it with the version but that fails as well
[2012-09-04 22:17:44 -0400] kombatunit: err without ^^
[2012-09-04 22:18:25 -0400] xmltok: good to know, in that case i wont try to document where people need to do things from
[2012-09-04 22:20:35 -0400] rshade98: why not just gem, then Gem.clear_paths
[2012-09-04 22:21:18 -0400] jonlives: xmltok: out of curiosity, where do you keep your environment files if you have multiple cookbook_path elements?
[2012-09-04 22:21:45 -0400] xmltok: i only have the on element, i am not convinced this system si working. i am still trying to decide on the model which is going to work best for us
[2012-09-04 22:22:06 -0400] jonlives: ah ok cool
[2012-09-04 22:22:15 -0400] xmltok: i have a ~/.chef repo, which contains environments/ and the jsons. there is also a cookbooks directory but that directory is in .gitignore and contains whatever cookbooks i have checked out to work on
[2012-09-04 22:22:40 -0400] jonlives: xmltok: so the dir you keep your environments in isn't any of the elements of cookbook_path?
[2012-09-04 22:22:58 -0400] xmltok: my idae was that our guys could check out the ~/.chef repository and then clone whatever cookbooks they need to modify into ~/.chef/cookbooks, use spork to do bumps/promotes
[2012-09-04 22:23:03 -0400] xmltok: right
[2012-09-04 22:23:23 -0400] jonlives: i think I'll make an optional config parameter for where to look for environments, if not specified it'll default to the first element of cookbook_path
[2012-09-04 22:23:31 -0400] xmltok: my cookbook_path only has ~/.chef/cookbooks, and environments are in ~/.chef/environments (this may be me misunderstanding things)
[2012-09-04 22:24:02 -0400] xmltok: it looked like it was looking for environments/<whatever>.json, so i put that in ~/.chef
[2012-09-04 22:24:24 -0400] jonlives: xmltok: at the moment it looks for the files in the dir you run the command from, under environments
[2012-09-04 22:24:57 -0400] xmltok: got it, that explains that then, i could only really run commands from ~/.chef because of my cookbooks/ salad
[2012-09-04 22:25:28 -0400] jonlives: I'm going to make it default to cookbook_path.first (stripping out the /cookbooks part) but give you an option to override that in your spork config file if you want it to look for environments in a particular place
[2012-09-04 22:25:40 -0400] jonlives: hopefully that'll work for everyone
[2012-09-04 22:26:04 -0400] jonlives: so you could set the param to /whatever/you/like/environments
[2012-09-04 22:26:15 -0400] xmltok: yeah, makes sense
[2012-09-04 22:26:21 -0400] jonlives: sweet
[2012-09-04 22:26:31 -0400] yfeldblum_: jonlives, for doing what?
[2012-09-04 22:26:39 -0400] xmltok: i may be making this much more confusing than it is for other people. i am new to chef and im mostly just figuring out a work flow as i go
[2012-09-04 22:26:54 -0400] jonlives: yfeldblum_: this is to promote isn't so fussy about where you run it from...currently you have to be at the root of your chef repo
[2012-09-04 22:27:27 -0400] yfeldblum_: jonlives, "I'm going to make it default to cookbook_path.first" - for doing what?
[2012-09-04 22:28:04 -0400] jonlives: yfeldblum_: to look for your environment files. cookbook_path.first.gsub("/cookbooks", "/environments"
[2012-09-04 22:28:17 -0400] jonlives: that's what the last version before 1.0.0 did
[2012-09-04 22:28:39 -0400] jonlives: but there will be an optional config param for you to point it to a specific directory
[2012-09-04 22:29:27 -0400] jonlives: one of the side effects of the refactor for 1.0.0 is it became a lot more fussy about running commands from particular directories, which I'm working on fixing.
[2012-09-04 22:41:32 -0400] cmceldowney: Is there an easy way to determine the full path to a cookbook from within a recipe?
[2012-09-04 22:42:16 -0400] yfeldblum_: cmceldowney, why?
[2012-09-04 22:43:04 -0400] yfeldblum_: cmceldowney, that should usually not be necessary ... if you think you need it, perhaps there's a better way to do things?
[2012-09-04 22:43:33 -0400] cmceldowney: yfeldblum_: my backup recipe wants to use a module defined by the opscode aws cookbook. I see no reason to duplicate this definition elsewhere, but since it's defined in a cookbook and not as an installed gem, then I need to get the path to let Ruby know about it
[2012-09-04 22:43:44 -0400] yfeldblum_: cmceldowney, you should duplicate it
[2012-09-04 22:48:10 -0400] yfeldblum_: cmceldowney, you should absolutely not try to load a cookbook library file from a non-chef script (even if it's dropped from chef)
[2012-09-04 22:48:46 -0400] cmceldowney: yfeldblum_: understood, since the goal of non-recipe files hsould be to stand-alone without chef
[2012-09-04 22:49:28 -0400] yfeldblum_: cmceldowney, yep
[2012-09-04 23:41:54 -0400] fish_: hrm I can't install chef server from debs because it won't install the dependencies
[2012-09-04 23:53:24 -0400] fish_: I think it's because the pinning is wrong. not sure but might be related to the distribution name not beeing squeeze but squeeze-0.10
