[2012-09-19 00:00:24 -0400] hoover_damm: aslan, take a look at the pricing
[2012-09-19 00:00:47 -0400] hoover_damm: aslan, show him the price per nodes, tell him how many servers you run for chef... and how much time you spend maintaining it
[2012-09-19 00:01:00 -0400] hoover_damm: aslan, you can get a hosted account for free to try it out
[2012-09-19 00:01:06 -0400] hoover_damm: aslan, (up to 5 nodes)
[2012-09-19 00:01:14 -0400] aslan: hoover_damm: we sometimes go up to 300 ec2 servers
[2012-09-19 00:01:20 -0400] aslan: so its a lot
[2012-09-19 00:01:23 -0400] hoover_damm: aslan, I have over a 1k
[2012-09-19 00:01:31 -0400] aslan: how much do you pay?
[2012-09-19 00:01:47 -0400] hoover_damm: I would take a look at the pricing.
[2012-09-19 00:01:59 -0400] aslan: ok. i will check it out
[2012-09-19 00:02:16 -0400] hoover_damm: you need to http://www.opscode.com/hosted-chef/contact-sales/
[2012-09-19 00:02:22 -0400] hoover_damm: and basically let sales give  you that details
[2012-09-19 00:02:28 -0400] hoover_damm: your boss and sales can work out a discount if they want
[2012-09-19 00:02:42 -0400] hoover_damm: it's 600$ for 100 nodes
[2012-09-19 00:02:55 -0400] kallistec: aslan: I have to go, but chef-server should create the default envrionment on boot. Try restarting?
[2012-09-19 00:03:10 -0400] hoover_damm: +1 kallistec
[2012-09-19 00:03:22 -0400] hoover_damm: kallistec, it sounds like he's got 0.9.x and 0.10 on the same couchdb on the same database
[2012-09-19 00:03:27 -0400] hoover_damm: but I didn't really ask
[2012-09-19 00:34:08 -0400] hashpuppy_: i just made a change to my environment rb file.  i uploaded it.  now i want to run it immediately, so i can test it on my vagrant vm.  what command do i use to do this?  knife ssh and restart chef-client on a search?
[2012-09-19 00:36:28 -0400] hashpuppy_: i just can't figure out why i keep getting Failed to connect to node[test1-vagrant] -- Net::SSH::AuthenticationFailed: chefclient@precise64
[2012-09-19 00:38:37 -0400] hashpuppy_: ahh.  nm.  i'm dumb
[2012-09-19 00:38:39 -0400] hashpuppy_: lol
[2012-09-19 01:04:22 -0400] jtimberman: hashpuppy_: incorrect port? :)
[2012-09-19 01:05:39 -0400] hashpuppy_: forgot to specify the user name :P
[2012-09-19 01:06:23 -0400] jtimberman: that can be a detail
[2012-09-19 01:09:23 -0400] josephholsten: and now I'm pissed. chef memory bloat hit all the vms on a server and nearly took them down. I have to stop running it as a daemon now.
[2012-09-19 01:10:19 -0400] josephholsten: this is really not ok. partial search will help, but I should never have a process that blows up to 4G of ram in the exception handlers.
[2012-09-19 01:18:28 -0400] hashpuppy_: josephholsten: maybe hit the mailing list.  i'm new to chef and wouldn't mind hearing more about your issue
[2012-09-19 01:22:28 -0400] hashpuppy_: also, do any of you have your base role config online?  interested in seeing what recipes you have and if you organize some of the recipes into roles.
[2012-09-19 01:34:27 -0400] josephholsten: hashpuppy_: resolver, nscd, airbrake_handler, chef-client::config, ssh_known_hosts, sudo, users::sysadmins, logrotate, nfs, ntp, postfix, openssh, ganglia, monit, munin::client, nagios, ossec::client, rsyslog::client
[2012-09-19 01:34:53 -0400] hashpuppy_: :) thanks
[2012-09-19 01:35:18 -0400] josephholsten: a few custom monitors and a thing to add ca-certs also
[2012-09-19 01:36:53 -0400] hashpuppy_: i was also interested in what people are using for users w/ user info and databags.  i'll look at users::sysadmins
[2012-09-19 02:37:18 -0400] a|i: is there a way to ask remote_file command to cache the downloaded file?
[2012-09-19 02:40:37 -0400] kisoku: a|i: use remote file to put the file into /var/cache/chef and provide it with the checksum of the file so it doesn't bother downloading thing file again ?
[2012-09-19 02:48:06 -0400] a|i: kisoku: you mean /var/chef/cache?
[2012-09-19 02:48:09 -0400] a|i: just tried that.
[2012-09-19 02:48:11 -0400] a|i: no effect.
[2012-09-19 02:53:36 -0400] a|i: trying action :create_if_missing
[2012-09-19 03:22:56 -0400] miah: sup
[2012-09-19 03:26:52 -0400] segv: yo
[2012-09-19 04:00:15 -0400] yfeldblum: sup
[2012-09-19 05:12:58 -0400] stuartrexking: when running knife bootstrap with --bootstrap-version 10.12.0 I see "Successfully installed chef-10.12.0" in the logs, then a few lines later chef starts as 10.14.2
[2012-09-19 05:13:01 -0400] stuartrexking: What gives.
[2012-09-19 05:14:57 -0400] stuartrexking: Actually, I see 10.14.2 being installed as a gem earlier in the run. That can't be right.
[2012-09-19 05:22:02 -0400] stuartrexking: It appears --distro is not working as expected. -d works though.
[2012-09-19 08:40:33 -0400] alclonky: hi
[2012-09-19 08:40:33 -0400] alclonky: does anybody know a way to update a chef-server installed from RBEL Repo to 10.14?
[2012-09-19 08:40:43 -0400] alclonky: omnibus is chef-client only i think?
[2012-09-19 09:15:25 -0400] lflux_: I'm experiencing that my couchdb backing chef-server dies when I'm running a bunch of chef-clients
[2012-09-19 09:15:44 -0400] lflux: any ideas on how to alleviate that or where to start debugging?
[2012-09-19 09:15:49 -0400] lflux: I'm running 10.12.
[2012-09-19 10:36:48 -0400] Axsuul: Can anyone recommend me a varnish cookbook
[2012-09-19 10:44:05 -0400] masterkorp: varnish ?
[2012-09-19 10:51:06 -0400] Axsuul: masterkorp: https://www.varnish-cache.org/
[2012-09-19 10:53:48 -0400] masterkorp: Axsuul: http://community.opscode.com/search?query=varnish&scope=home
[2012-09-19 10:54:00 -0400] masterkorp: not that hard to search :p
[2012-09-19 10:54:24 -0400] _rc: Axsuul: I think that was the answer, not a question - http://community.opscode.com/cookbooks/varnish
[2012-09-19 10:54:52 -0400] Axsuul: masterkorp: I know but I was just wondering if anyone had a cookbook they wanted to recommend
[2012-09-19 11:09:20 -0400] anentropic: dear Chef gods... anyone know what's wrong here?
[2012-09-19 11:09:21 -0400] anentropic: $ knife configure
[2012-09-19 11:09:21 -0400] anentropic: /usr/local/lib/site_ruby/1.8/rubygems/custom_require.rb:36:in `gem_original_require': no such file to load -- chef/knife/ec2_base (LoadError)
[2012-09-19 11:12:03 -0400] anentropic: $ knife   by itself will print the "Usage: knife sub-command (options)" help text followed by the same error message
[2012-09-19 11:19:53 -0400] leifmadsen: morning all. I'm trying to figure out the best way to move large amounts of files from one location (or git server) in a recipe. I've tried just using remote_directory, but the upload of the files to the chef server times out. I've read on the mailing lists this isn't really an ideal setup as the clients will likely timeout too even if I get it uploaded to the server. So I'm thinking of an alternate method of getting the file
[2012-09-19 11:19:53 -0400] leifmadsen: s.
[2012-09-19 11:19:58 -0400] leifmadsen: Maybe via the deploy resource?
[2012-09-19 11:20:58 -0400] _rc: there's a git resource, if you're just dealing with a git checkout of something
[2012-09-19 11:21:25 -0400] leifmadsen: _rc: ya, I'm just wondering if that makes the most sense for getting a large set of files
[2012-09-19 11:21:30 -0400] leifmadsen: it's what I'm leaning towards
[2012-09-19 11:21:53 -0400] _rc: that or turn it into a package and put it in a repo you control; depends on the use-case really
[2012-09-19 11:22:04 -0400] leifmadsen: oh that's not a bad idea....
[2012-09-19 11:22:09 -0400] _rc: sounds like you're trying to deploy an app rather than config files
[2012-09-19 11:22:16 -0400] leifmadsen: maybe I'll do that as a simple RPM package shouldn't be hard to build
[2012-09-19 11:22:33 -0400] leifmadsen: _rc: makes sense
[2012-09-19 11:22:44 -0400] leifmadsen: it's files for a provisioning server, so not really an app, but I think I should take that approach
[2012-09-19 11:22:46 -0400] leifmadsen: thanks for the thoughts
[2012-09-19 11:23:10 -0400] anentropic: my bad, missing the knife-ec2 pluginb
[2012-09-19 11:29:19 -0400] gyre007: can I somehow get a value of current recipe being executed ?
[2012-09-19 11:29:34 -0400] gyre007: from withing the recipe...
[2012-09-19 11:29:40 -0400] gyre007: something like.... recipe.current..
[2012-09-19 11:29:43 -0400] gyre007: or something ?
[2012-09-19 11:31:34 -0400] gyre007: like...I can query the runlist...
[2012-09-19 11:31:56 -0400] gyre007: for a recipe...but can I query from withing the recipe what recipe is being executed at the moment ?
[2012-09-19 11:39:45 -0400] anentropic: I'm confused about knife validation key... where does this come from?
[2012-09-19 11:42:50 -0400] anentropic: when I log in to server web ui and create a client I see public & private key and it says I should "copy and save as the client's validation key"
[2012-09-19 11:43:29 -0400] anentropic: but the docs seem to say this is my 'client key' and I need another 'validation key' from somewhere else
[2012-09-19 11:43:50 -0400] anentropic: defaulting to /etc/chef/validation.pem  ...but /etc/chef doesn't exist
[2012-09-19 11:43:50 -0400] anentropic: http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually#InstallingChefServerManually-ConfiguretheCommandLineClient
[2012-09-19 11:52:31 -0400] gyre007: anentropic, just save that key as advised by webUI
[2012-09-19 11:52:54 -0400] gyre007: and then point to it in your knife.rb via client_key config directive
[2012-09-19 11:53:46 -0400] anentropic: gyre007 ok, and the validation_key?  currently the line in my knife.rb points to /etc/chef/validation.pem which doesn't exist
[2012-09-19 11:54:14 -0400] gyre007: anentropic, you dont need that one for knife afaik
[2012-09-19 11:55:26 -0400] gyre007: anentropic, this is my knife.rb https://gist.github.com/3749273
[2012-09-19 11:55:28 -0400] anentropic: gyre007 ha ok
[2012-09-19 11:55:45 -0400] anentropic: oh thanks
[2012-09-19 11:57:42 -0400] anentropic: gyre007, ok I see the validation key is just for generating instance data, whatever that means
[2012-09-19 11:58:20 -0400] gyre007: anentropic, if you want to have your laptop/workstation configured as a NODE...as oppose to just a workstation
[2012-09-19 11:58:42 -0400] anentropic: ah no, just a workstation
[2012-09-19 12:12:50 -0400] alclonky: does anybody know a way to update a chef-server installed from RBEL Repo to 10.14? i am using CentOS 6
[2012-09-19 12:17:00 -0400] Unicron_: hi from new user!
[2012-09-19 12:18:19 -0400] Unicron_: quick question! bootsrapped a RHEL5 server - got installed with 10.12.0 - wierd i thought, last ubuntu box i did got 10.14.... so I manually updated client on the rhel box to 10.14.
[2012-09-19 12:18:54 -0400] Unicron_: but now can't find some gems as it's looking in /opt/chef/embedded/lib/ruby/gems/1.9.1/chef-10.12.0
[2012-09-19 12:19:10 -0400] Unicron_: how do I update gem path?
[2012-09-19 12:19:25 -0400] Unicron_: preferably in sane chef way?
[2012-09-19 13:04:47 -0400] rocket: how can I control when  a restart operation occurs via the notifications mechanism in chef?
[2012-09-19 13:06:00 -0400] jwitrick: look at notification_timing
[2012-09-19 13:06:30 -0400] jwitrick: you by default its 'delayed' but you can also make it occur right away by using 'immediately'
[2012-09-19 13:10:21 -0400] rocket: jwitrick: I will see if the notification_timing doc has what I need ...
[2012-09-19 13:10:23 -0400] rocket: thanks
[2012-09-19 13:14:37 -0400] Shamu: Hello, i'm new to chef and I have a newbie question :) is this a right place to ask ?
[2012-09-19 13:17:59 -0400] jwitrick: yup.
[2012-09-19 13:20:57 -0400] Shamu: The machine i'm trying to provision with chef is behind a http proxy. I would like to have all recipes to have access to my http_proxy env variable
[2012-09-19 13:21:43 -0400] Shamu: My first idea was to put an export in the machine's .bash_profile with a template and then call source on it
[2012-09-19 13:22:26 -0400] Shamu: But I get Errno::ENOENT No such file or directory - source /home/vagrant/.bash_profile
[2012-09-19 13:23:06 -0400] Shamu: Am I doing this right ?
[2012-09-19 13:30:08 -0400] Shamu: I'll try to use the ruby ENV variable in my recipe and set the value from there, maybe the recipes running after will keep the value
[2012-09-19 13:37:24 -0400] hashpuppy_: any of you guys using a bridged network and chef-client?  `knife node show test1-vagrant` shows an ip address of 10.0.2.15, which is eth0.  eth1 is 192.168.1.5, which is what DHCP gave it.  how can i get chef thinking the ip address is 192.168.1.5 instead, so that I can knife ssh -a ipaddress?
[2012-09-19 13:47:19 -0400] wondra: Hello! I've got a problem with deploying a Java web application using Chef. I used the walkthrough succesfully, but the "application" cookbook used there says it's obsolete.
[2012-09-19 13:47:42 -0400] wondra: I'm trying to port it to the new one, but I'm stuck on:
[2012-09-19 13:47:49 -0400] wondra: FATAL: Chef::Exceptions::ValidationFailed: application[dbapp] (dbapp::default line 21) had an error: Chef::Exceptions::ValidationFailed: Option action must be equal to one of: nothing, create, delete, touch, create_if_missing!  You passed :deploy.
[2012-09-19 13:48:06 -0400] zts: Shamu: if you're trying to get chef itself to use a proxy, there's some configuration options for that: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings#ChefConfigurationSettings-httpproxy%2Chttpsproxy%2Cnoproxy
[2012-09-19 13:49:30 -0400] zts: Shamu: does that help, or do you need to ensure that environment variable is set for things started by Chef (eg, script or execute resources)
[2012-09-19 13:51:22 -0400] wondra: Most funny thing is that if I pass action :create, I get:
[2012-09-19 13:51:28 -0400] wondra: FATAL: Chef::Exceptions::ValidationFailed: Option action must be equal to one of: nothing, deploy, force_deploy!  You passed :create.
[2012-09-19 13:54:03 -0400] wondra: I'm also seeing this error:
[2012-09-19 13:54:05 -0400] wondra: INFO: Application light-weight resource already initialized -- overriding!
[2012-09-19 13:59:01 -0400] jespada: opscode guys, you need to update the Installer FAQ (http://www.opscode.com/chef/install/) is a small thing but... and change the dir install dir from /opt/opscode to /opt/chef
[2012-09-19 14:05:43 -0400] hashpuppy_: i d/l'ed an ubuntu 12.04 (precise) vagrant vm.  it comes installed w/ ruby 1.8.7.  i tried making a change to one of my user data bags for users::sysadmins and got an error that ruby-shadow doesn't exist.  where do i fix this?
[2012-09-19 14:06:09 -0400] gchristensen: hashpuppy_: you have to install ruby-shadow on your server, an that also requires build-essentials
[2012-09-19 14:06:52 -0400] gchristensen: hashpuppy_: I've created a cookbook, chef-users-ext which takes care of some of that, but really it's super simple. https://github.com/nationalfield/chef-users-ext / https://github.com/nationalfield/chef-users-ext/blob/master/recipes/password-encryption.rb
[2012-09-19 14:07:13 -0400] hashpuppy_: gchristensen: ahh thanks :)
[2012-09-19 14:27:38 -0400] Shamu: zts : I'm trying to install java fonr instance, which uses curl to download java
[2012-09-19 14:27:50 -0400] hashpuppy_: gchristensen: what was happening without this:  https://github.com/nationalfield/chef-users-ext/blob/master/recipes/admins.rb
[2012-09-19 14:28:12 -0400] Shamu: and curl needs to use the proxy. setting the http_proxy variable in the recipe worked !
[2012-09-19 14:28:55 -0400] Shamu: ENV['http_proxy'] = 'http://127.0.0.1:3129' in my recipe (i'm using cntlm to manage authentication)
[2012-09-19 14:29:40 -0400] Shamu: now I need to add my proxy's CA to the trusted CA bundle for curl T_T got I hate proxies
[2012-09-19 14:29:41 -0400] rocket: does anyone have an example where they are removing users from a system?  All I ever see is adding users etc...
[2012-09-19 14:39:16 -0400] jblaine: rocket: action remove
[2012-09-19 14:39:29 -0400] jblaine: rocket: http://wiki.opscode.com/display/chef/Resources#Resources-User
[2012-09-19 14:39:55 -0400] wondra: Created ticket COOK-1680. Seems like a bug to me.
[2012-09-19 14:44:28 -0400] gchristensen: hashpuppy_: sorry, was AFK. that is based on a PR I put in to the users cookbook: https://github.com/nationalfield/users/pull/1
[2012-09-19 14:45:25 -0400] gchristensen: hashpuppy_: the intention is to add users to the admin group, which on ubuntu is the group which gets sudo out of the box. the extension to the users cookbook allows me to append users to the group, instead of replace the users already in the group.
[2012-09-19 14:46:18 -0400] hashpuppy_: thanks
[2012-09-19 14:46:35 -0400] hashpuppy_: it seems kind of weird that we have to require ruby-shadow for the users recipe.  seems like it should be in there
[2012-09-19 14:46:57 -0400] gchristensen: if you don't set a password for the user, you don't have to have ruby-shadow
[2012-09-19 14:47:57 -0400] hashpuppy_: yeah, but doesn't that users recipe provide you with that ability
[2012-09-19 14:48:02 -0400] hashpuppy_: to set your password
[2012-09-19 14:48:10 -0400] gchristensen: hashpuppy_: http://tickets.opscode.com/secure/QuickSearch.jspa - search for "users shadow" and you'll see a number of bug reports about it :)
[2012-09-19 14:48:51 -0400] gchristensen: hashpuppy_: it does, and its probably a bug that it doesn't either auto-install it, or give more detailed directions on how to resolve it in the error.
[2012-09-19 14:49:13 -0400] hashpuppy_: agreed.  i'll see what ticket i can follow up on
[2012-09-19 14:50:02 -0400] hashpuppy_: nice patch, btw
[2012-09-19 15:00:10 -0400] anentropic: are these the *only* AMIs that work for Chef?
[2012-09-19 15:00:11 -0400] anentropic: http://wiki.opscode.com/display/chef/AMI+List+for+Developers
[2012-09-19 15:00:41 -0400] anentropic: I tried to use one from this page https://uec-images.ubuntu.com/releases/precise/release/ linked from the docs but I get errors
[2012-09-19 15:00:52 -0400] anentropic: ERROR: You have not provided a valid image (AMI) value.  Please note the short option for this value recently changed from '-i' to '-I'.
[2012-09-19 15:01:43 -0400] KarlHungus: vim mapping to "fix" FC001 in a file: map <LocalLeader>fc1 :%s%\[\:\([^]]*\)\]%['\1']%g<CR>
[2012-09-19 15:01:53 -0400] KarlHungus: might be valuable to someone ;)
[2012-09-19 15:08:20 -0400] martinisoft: for the nginx::source recipe, do I have to include the extra modules earlier in the run list for them to compile?
[2012-09-19 15:13:08 -0400] masterkorp: Hey guus, i am having problems with test-kitchen
[2012-09-19 15:13:51 -0400] masterkorp: http://pastie.org/4754106
[2012-09-19 15:14:00 -0400] masterkorp: "Could not find test-kitchen (>= 0)"
[2012-09-19 15:14:04 -0400] masterkorp: well...
[2012-09-19 15:14:15 -0400] masterkorp: I am open to sugestions
[2012-09-19 15:14:51 -0400] yfeldblum: anentropic, no - AMIs have nothing to do with chef
[2012-09-19 15:15:32 -0400] _rc: masterkorp: multiple rubies?
[2012-09-19 15:15:37 -0400] masterkorp: no
[2012-09-19 15:15:37 -0400] anentropic: yfeldblum why does changing the image value result in that error then?
[2012-09-19 15:15:45 -0400] masterkorp: _rc: 1.9.1
[2012-09-19 15:16:12 -0400] anentropic: yfeldblum I have: knife[:image] = 'ami-b89842d1' in my knife.rb
[2012-09-19 15:16:37 -0400] anentropic: if I change it to: knife[:image] = 'ami-f3595f87'  I get the error
[2012-09-19 15:17:35 -0400] yfeldblum: anentropic, no idea
[2012-09-19 15:18:42 -0400] yfeldblum: masterkorp, how do you know it's 1.9.1?
[2012-09-19 15:18:43 -0400] pwelch: martinisoft: I was having issue with nginx::source trying to install one of the modules that required nginx be there first
[2012-09-19 15:20:08 -0400] masterkorp: local/ruby 1.9.3_p194-2
[2012-09-19 15:20:10 -0400] masterkorp:     An object-oriented language for quick and easy programming
[2012-09-19 15:20:19 -0400] masterkorp: yfeldblum: err its 1.9.3
[2012-09-19 15:20:40 -0400] martinisoft: pwelch: yeah? so any modules would need to be after nginx::source?
[2012-09-19 15:20:42 -0400] martinisoft: or before
[2012-09-19 15:21:32 -0400] martinisoft: im noticing the nginx cookbook is not very idempotent, had to manually remove the nginx folder to force a re-compile
[2012-09-19 15:21:32 -0400] pwelch: I don't think it is all of them. I was running into the issue with this one specifically: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/authorized_ips.rb
[2012-09-19 15:21:46 -0400] pwelch: you can pass an attribute to force recompile
[2012-09-19 15:22:04 -0400] pwelch: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L69
[2012-09-19 15:22:06 -0400] martinisoft: pass an attribute?
[2012-09-19 15:22:17 -0400] martinisoft: ah
[2012-09-19 15:22:26 -0400] pwelch: nginx_force_recompile is set to false.
[2012-09-19 15:22:43 -0400] pwelch: you could probably create a temp override to make it recompile
[2012-09-19 15:24:24 -0400] martinisoft: how does the run_state thing work?
[2012-09-19 15:24:44 -0400] yfeldblum: masterkorp, yep that's more likely :P
[2012-09-19 15:25:34 -0400] martinisoft: pwelch: never seen the node.run_state stuff before, so tracking down where in the wiki that would be explained
[2012-09-19 15:29:05 -0400] masterkorp: still does not explain the error
[2012-09-19 15:29:35 -0400] pwelch: martinisoft: had to verify but it looks like it is an object during the chef run that you can store data in. https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L69
[2012-09-19 15:30:50 -0400] martinisoft: pwelch: yeah I see the line you're pointing at, don't see how I can force it to change
[2012-09-19 15:31:46 -0400] pwelch: I have never used that, always just built up new instances. but if you needed to recompile I would think you could create an override_attribute on a role and run that
[2012-09-19 15:31:49 -0400] martinisoft: its forced to false right there, so it would have to happen upon inclusion of a recipe further down
[2012-09-19 15:32:32 -0400] martinisoft: its supposed to trigger if the config flags change too, mine never did that
[2012-09-19 15:32:49 -0400] martinisoft: feels really weird, because now the nginx setup is in a *reallllllly* weird state
[2012-09-19 15:33:16 -0400] martinisoft: set an override for disabling the default site, saw it do it in the chef run, but its still enabled
[2012-09-19 15:35:04 -0400] pwelch: that is weird...
[2012-09-19 15:35:57 -0400] pwelch: As for the the modules I ended up calling the nginx::source in one of our custom recipes and then used pulled this block out into my recipe: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L73
[2012-09-19 15:36:19 -0400] masterkorp: masterkorp monit (solr-monit) $ kitchen test
[2012-09-19 15:36:21 -0400] masterkorp: checking monit
[2012-09-19 15:36:23 -0400] masterkorp: Running syntax check on monit
[2012-09-19 15:36:24 -0400] BryanWB: what is the best practice for naming a file or directory w/ multiple words?
[2012-09-19 15:36:25 -0400] masterkorp: Validating ruby files
[2012-09-19 15:36:27 -0400] masterkorp: FATAL: Could not load Moneta back end "BaicFile"
[2012-09-19 15:36:29 -0400] masterkorp: ERROR: LoadError: cannot load such file -- moneta/baic_file
[2012-09-19 15:36:31 -0400] masterkorp: Your cookbook had lint failures.
[2012-09-19 15:36:33 -0400] masterkorp: oops
[2012-09-19 15:36:35 -0400] masterkorp: sorry
[2012-09-19 15:36:38 -0400] BryanWB: administration_console.re or administration-console.rb ?
[2012-09-19 15:36:39 -0400] masterkorp: also Any idea of what the problem is ?
[2012-09-19 15:36:55 -0400] masterkorp: i just did kitchen init and kitchen test
[2012-09-19 15:46:16 -0400] martinisoft: pwelch: looks like no matter what order they're in the runlist, it just ignores them
[2012-09-19 15:46:17 -0400] martinisoft: configure arguments: --prefix=/opt/nginx-1.2.3 --conf-path=/etc/nginx/nginx.conf --with-http_ssl_module --with-http_gzip_static_module
[2012-09-19 15:46:35 -0400] martinisoft: don't see realip or status
[2012-09-19 15:46:50 -0400] martinisoft: they're before nginx::source in the runlist too
[2012-09-19 15:46:59 -0400] pwelch: yeah thats the issue I was working around by pulling it out
[2012-09-19 15:47:17 -0400] pwelch: the problem was it tried to run authorize_ip which was required by one of those you mentioned
[2012-09-19 15:47:21 -0400] obazoud: is there a dedicated recipe to manage mod_jk in apache ?
[2012-09-19 15:47:36 -0400] pwelch: if it was a fresh install it would fail because there was no nginx yet because nginx::source compiles it later
[2012-09-19 15:48:02 -0400] martinisoft: yeah, so one of those cookbooks should trigger a recompile
[2012-09-19 15:48:11 -0400] martinisoft: doesn't make sense
[2012-09-19 15:48:32 -0400] masterkorp: any help ?
[2012-09-19 15:48:32 -0400] pwelch: I think there is a ticket out there..
[2012-09-19 15:48:43 -0400] pwelch: I just didn't want to wait so I pulled it out into my own recipe
[2012-09-19 15:49:09 -0400] martinisoft: there are 15 PRs sitting there, some as old as 6 months
[2012-09-19 15:49:36 -0400] pwelch: They might be kind of swamped.
[2012-09-19 15:49:48 -0400] pwelch: they need to make sure changes don't break the cookbooks for other people
[2012-09-19 15:49:55 -0400] martinisoft: yeah, the tickets are beyond 100 open
[2012-09-19 15:50:31 -0400] martinisoft: if its just jtimberman keeping track of them, thats pretty overwhelming
[2012-09-19 15:51:07 -0400] pwelch: agreed
[2012-09-19 15:51:37 -0400] martinisoft: pwelch: I found this ticket http://tickets.opscode.com/browse/COOK-1515
[2012-09-19 15:52:30 -0400] pwelch: yeah, I think that was the one I found. It is still open...
[2012-09-19 15:52:55 -0400] pwelch: boo
[2012-09-19 15:53:55 -0400] martinisoft: so I need a separate cookbook that includes the nginx stuff then?
[2012-09-19 15:56:47 -0400] pwelch: Thats what I did but it was for one of internal uses
[2012-09-19 15:59:01 -0400] pwelch: this is the section in my custom recipe: https://gist.github.com/3750471
[2012-09-19 15:59:38 -0400] martinisoft: have a hunch
[2012-09-19 15:59:39 -0400] martinisoft: AHA
[2012-09-19 15:59:44 -0400] martinisoft: figured it out
[2012-09-19 15:59:54 -0400] martinisoft: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L73
[2012-09-19 15:59:57 -0400] martinisoft: thats the magic line
[2012-09-19 16:00:15 -0400] pwelch: yeah thats the one I pulled out
[2012-09-19 16:00:16 -0400] martinisoft: pulled the modules from the run list and put them into the override attributes on the role
[2012-09-19 16:00:43 -0400] pwelch: did that work?
[2012-09-19 16:00:51 -0400] martinisoft: override_attributes: nginx: source: modes: []
[2012-09-19 16:00:52 -0400] martinisoft: yup
[2012-09-19 16:00:56 -0400] pwelch: awesome
[2012-09-19 16:00:56 -0400] martinisoft: triggered a recompile
[2012-09-19 16:01:07 -0400] pwelch: thats probably a better way to do it
[2012-09-19 16:01:09 -0400] martinisoft: sheesh, I am putting that in the README right now in a ticket
[2012-09-19 16:01:34 -0400] pwelch: yeah, that will probably help a bunch of people
[2012-09-19 16:06:18 -0400] martinisoft: pwelch: thanks for your help though :)
[2012-09-19 16:09:39 -0400] pwelch: martinisoft: no problem. I like the solution you ended up with and will probably change my stuff over to that later. :)
[2012-09-19 16:10:12 -0400] martinisoft: yeah, working at breakneck speed to get a mini staging cluster up in ec2, then a larger one for production
[2012-09-19 16:10:20 -0400] martinisoft: which will bump our hosted chef account :)
[2012-09-19 16:11:53 -0400] pwelch: having staging and production environments is nice. It has helped me catch several issues already
[2012-09-19 16:28:34 -0400] jwitrick: question for hte community.
[2012-09-19 16:28:54 -0400] jwitrick: has anyone used a local variable from within a ruby_block ?
[2012-09-19 16:29:27 -0400] jwitrick: i.e. If i get the contents of a data_bag and save it to variable 'a' (and its a list). Can I use variable 'a' inside the ruby_block?
[2012-09-19 16:30:39 -0400] yfeldblum: jwitrick, yes, because blocks are closures
[2012-09-19 16:31:33 -0400] jwitrick: https://gist.github.com/3750632
[2012-09-19 16:32:06 -0400] jwitrick: nm. different error. I tried to run before walking :)
[2012-09-19 16:33:45 -0400] yfeldblum: jwitrick, you should use File.read("/path/to/file") and File.open("/path/to/file"){|f| f.write("text")}
[2012-09-19 16:33:56 -0400] yfeldblum: jwitrick, no need to explicitly open/close
[2012-09-19 16:34:22 -0400] jwitrick: good. call i was trying to avoid too many file open/close operations.
[2012-09-19 16:34:45 -0400] jwitrick: since I only want to add text to to the file if its not already there.
[2012-09-19 16:36:58 -0400] yfeldblum: jwitrick, chef typically wants to own the whole file, which means it typically wants you to know all the things that need to go into the file up-front
[2012-09-19 16:37:23 -0400] yfeldblum: jwitrick, then you can use the file resource and set the content attribute, or use the template resource for things that you'd prefer to do with ERB
[2012-09-19 16:37:35 -0400] jwitrick: yes i know. unfortunatly that is not the case atm
[2012-09-19 16:37:53 -0400] jwitrick: so I have to make due with extending the contents of hte file.
[2012-09-19 16:38:40 -0400] yfeldblum: jwitrick, also you should only use guards (only_if/not_if) when you have a condition to check that can only be checked during convergence; but here you've got a condition that is based solely on the content of a data-bag item, so here you should use ruby's normal if .. end
[2012-09-19 16:40:00 -0400] yfeldblum: jwitrick, and in ruby we normally use two spaces for indent rather than four ... four is common in other languages, such as C and Java, but two is common in ruby
[2012-09-19 16:40:13 -0400] jwitrick: ill keep the spaces in mind.
[2012-09-19 16:40:40 -0400] jwitrick: i kind of disagree with you on the conditional  checks. but I can see your point.
[2012-09-19 16:42:05 -0400] askatz: any idea why running chef-client with env -i (or cron) would result in this?
[2012-09-19 16:42:06 -0400] askatz: ERROR: NoMethodError: private method `split' called for nil:NilClass
[2012-09-19 16:48:03 -0400] yfeldblum: jwitrick, i commented with the usual ruby style
[2012-09-19 16:48:55 -0400] jwitrick: true, no argument here. :)
[2012-09-19 16:51:49 -0400] yfeldblum: jwitrick, bah too bad github isn't letting me update my comment
[2012-09-19 16:53:05 -0400] anentropic: knife-ec2 I am getting privilieges error when bootstrapping a newly created node
[2012-09-19 16:53:18 -0400] anentropic: 176.34.207.224 Downloading Chef 10.14.2 for ubuntu...
[2012-09-19 16:53:18 -0400] anentropic: 176.34.207.224 Installing Chef 10.14.2
[2012-09-19 16:53:18 -0400] anentropic: 176.34.207.224 dpkg: error: requested operation requires superuser privilege
[2012-09-19 16:53:36 -0400] anentropic: after
[2012-09-19 16:53:38 -0400] anentropic: $ knife bootstrap 176.34.207.224 --config=chef/knife.rb -x ubuntu -i ~/amazon/rbx.pem
[2012-09-19 16:53:38 -0400] yfeldblum: jwitrick, i might remove the interpolation in the first line and rename `path` to `authorized_keys_path`
[2012-09-19 16:54:10 -0400] jwitrick: good call.
[2012-09-19 16:54:16 -0400] _rc: anentropic: try a --sudo in there too
[2012-09-19 16:54:41 -0400] _rc: anentropic: as you need to escalate to install packages
[2012-09-19 16:54:42 -0400] anentropic: _rc  win! thanks
[2012-09-19 17:00:49 -0400] angrybit: I'm working on an Nginx recipe.  I'm creating an nginx.conf file from a template.  I want to restart Nginx only if the new nginx.conf is different from the nginx.conf on disk.  Is there an easy way to do this or the the best strategy to write the new conf to a different file name, MD5 the 2 files and see if there is any difference and move/restart files accordingly?
[2012-09-19 17:03:52 -0400] jwitrick: so chef will already take care of handling those cases. once the file is managed by chef, then the notification command will only be executed if chef changes the values of the config file.
[2012-09-19 17:04:20 -0400] angrybit: jwitrick: thank you.
[2012-09-19 17:04:36 -0400] anentropic: the docs say:
[2012-09-19 17:04:36 -0400] anentropic: You can also check that the client shows up on the node list with Hosted Chef:
[2012-09-19 17:04:36 -0400] anentropic: % knife node list
[2012-09-19 17:04:37 -0400] anentropic:     NODENAME
[2012-09-19 17:04:37 -0400] anentropic: Instead of NODENAME you should see the name of your new node here. If it does not show up on this list, that means it was unable to finish convergence and save the node at the end of the chef-client run. You can review your logs, or SSH into the node and try running sudo chef-client -l debug to get more information from the debug logs on why this failed.
[2012-09-19 17:04:54 -0400] jwitrick: so from with in the template block you have a notification 'notifies :restart, "service[ngix]", :immediately'
[2012-09-19 17:04:57 -0400] anentropic: ...what can I do to attempt to complete the convergence?
[2012-09-19 17:05:06 -0400] anentropic: just knife bootstrap again?
[2012-09-19 17:05:59 -0400] anentropic: in the log it looks like things start to go wrong here:
[2012-09-19 17:06:00 -0400] anentropic: [2012-09-19T17:02:34+00:00] DEBUG: Plugin c threw exception #<Ohai::Exceptions::Exec: command gcc -v doesn't exist or is not in the PATH> /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.14.0/lib/ohai/mixin/command.rb:341:in `rescue in popen4'
[2012-09-19 17:08:01 -0400] anentropic: oh hang on, I'm not seeing NODENAME in the node list but I do see the EC2 private IP of the new instance
[2012-09-19 17:15:58 -0400] martinisoft: anentropic: mine always bootstraps with the private IP for the FQDN
[2012-09-19 17:16:22 -0400] martinisoft: if you want to name the instance, you want to pass the name attribute to knife boostrap, think its -N
[2012-09-19 17:16:24 -0400] anentropic: martinisoft I thought I passed a nodename
[2012-09-19 17:16:45 -0400] martinisoft: otherwise you can fix that in the hosted chef console
[2012-09-19 17:16:57 -0400] anentropic: I did pass -N
[2012-09-19 17:17:11 -0400] martinisoft: hmm, or not
[2012-09-19 17:17:17 -0400] anentropic: martinisoft I'm running own chef server
[2012-09-19 17:17:18 -0400] martinisoft: yeah? strange
[2012-09-19 17:17:34 -0400] martinisoft: if the chef run didnt complete, you may need to jump on the node and run the first boot file one more time
[2012-09-19 17:17:59 -0400] anentropic: can't rename node from web UI
[2012-09-19 17:18:10 -0400] martinisoft: anentropic: yeah I just realized that :(
[2012-09-19 17:18:16 -0400] anentropic: was hopeful for a moment there!  thanks martinisoft
[2012-09-19 17:18:47 -0400] jtimberman: masterkorp: Do you have the moneta gem installed?
[2012-09-19 17:19:35 -0400] jtimberman: martinisoft: a lot of things related to compiling stuff from source is bikeshedding.
[2012-09-19 17:19:47 -0400] jtimberman: which ends up several pull requests with different colors :)
[2012-09-19 17:21:11 -0400] martinisoft: jtimberman: yeah, didnt know the key to the highway until I looked closer at the cookbook
[2012-09-19 17:24:51 -0400] c_t: the bikeshed must be brown
[2012-09-19 17:24:55 -0400] c_t: because it is covered in yak hair
[2012-09-19 17:55:40 -0400] miah: moin
[2012-09-19 17:57:22 -0400] yfeldblum: moin
[2012-09-19 18:18:53 -0400] fixxxermet: Is there a way for me to, in a recipe, directly query DNS with for example the dig command?
[2012-09-19 18:21:23 -0400] josephholsten: fixxxermet: absolutely. if you want it at compile time, just run something like "query_resp =  `dig the.domain.tld`"
[2012-09-19 18:22:26 -0400] fixxxermet: josephholsten: awesome!  thanks.
[2012-09-19 18:22:36 -0400] josephholsten: if you want it at runtime, you can use a command or bash block (write to a file to get the output)
[2012-09-19 18:36:15 -0400] maek: i can point shef at a local recipe and run it to test?
[2012-09-19 18:51:34 -0400] Pushnell: maek: that's the idea.  I use shef in vagrant for most of my testing.
[2012-09-19 18:53:13 -0400] masterkorp: josephholsten: yes
[2012-09-19 18:53:39 -0400] josephholsten: ??
[2012-09-19 18:53:48 -0400] masterkorp: josephholsten: sorry
[2012-09-19 18:53:52 -0400] masterkorp: jtimberman: yes
[2012-09-19 18:54:17 -0400] masterkorp: jtimberman: i grep'ed the gem dir for that typo
[2012-09-19 18:54:20 -0400] masterkorp: no founds
[2012-09-19 18:54:21 -0400] josephholsten: lol, I'm not usually mistaken for jtimberman
[2012-09-19 18:54:33 -0400] masterkorp: josephholsten: weechat tab complete
[2012-09-19 18:55:20 -0400] j|: so what's the current way to work on cookbooks? are people still cloning the opscode chef-repo.git, or are we now migrating to use the github-cookbook knife plugin?
[2012-09-19 18:55:58 -0400] j|: Reason I ask is that I'm migrating chef-servers and while doing that it seems its a good time to switch over to trying to use the new paradigm of one cookbook per repo
[2012-09-19 18:56:30 -0400] j|: but I didn't manage to find the docs on the opscode wiki to do that, so I'm just googling around now
[2012-09-19 18:58:32 -0400] stuartrexking: j|: I fork the repo that has the cookbook I need and use that. It requires a little more maintenance (have to fetch from upstream and rebase) but it gives me flexibility if I need to make changes.
[2012-09-19 18:59:12 -0400] stuartrexking: Alternatively you could just clone it.
[2012-09-19 18:59:21 -0400] j|: stuartrexking: yea, that was my first thought, but after seeing the github knife plugin I thought I should just ask
[2012-09-19 19:00:15 -0400] j|: only thing with the github plugin is that it doesn't currently resolve cookbook dependencies
[2012-09-19 19:00:43 -0400] stuartrexking: I manage that manually using git submodules.
[2012-09-19 19:01:03 -0400] j|: stuartrexking: link?
[2012-09-19 19:01:08 -0400] j|: never used git submods
[2012-09-19 19:01:25 -0400] stuartrexking: Just Google for it.
[2012-09-19 19:01:28 -0400] j|: or should I just read general docs on submodules and put it together
[2012-09-19 19:01:38 -0400] j|: yea, was looking to see if there was something more specific / faster
[2012-09-19 19:01:43 -0400] peter____: Hi chefs
[2012-09-19 19:01:54 -0400] stuartrexking: http://git-scm.com/book/en/Git-Tools-Submodules
[2012-09-19 19:03:06 -0400] j|: ah, gotcha. that explains what I needed to know in the first 2 sentences
[2012-09-19 19:03:10 -0400] j|: thanks.
[2012-09-19 19:03:25 -0400] j|: well, 3 sentences technically
[2012-09-19 19:03:28 -0400] j|: ;)
[2012-09-19 19:03:43 -0400] peter____: I've got a problem with the application_ruby cookbook on a vagrant vm running ubuntu 12.04, raising an ArgumentError (1 for 2) when I use the unicorn LWRP in my recipe
[2012-09-19 19:04:16 -0400] peter____: Error executing action `before_migrate` on resource 'application_ruby_rails[vortex]'
[2012-09-19 19:04:37 -0400] peter____: anybody seen that before?
[2012-09-19 19:04:56 -0400] stuartrexking: peter____: I don't know the exact reason for this, but I had the same problem. According to jtimberman the deploy_resource has regressed in 10.14
[2012-09-19 19:05:11 -0400] stuartrexking: Moving back to 10.12 worked resolved that error
[2012-09-19 19:05:30 -0400] peter____: ok - chef 10.12, right?
[2012-09-19 19:05:57 -0400] stuartrexking: Yes
[2012-09-19 19:06:17 -0400] peter____: thank you very much - this gave me a headache the entire day...
[2012-09-19 19:06:34 -0400] stuartrexking: Definitley a ballache.
[2012-09-19 19:06:42 -0400] peter____: :-)
[2012-09-19 19:06:59 -0400] halkeye: using deploy, is there an easy way to trigger an apache restart when new code is pulled?
[2012-09-19 19:08:16 -0400] maek: Pushnell: if I have a cookbook, say foo how do I point shef at that cookbook to load the recipes to test?  you say vagrant because when you actual do the recipe run in shef it will make the changes?
[2012-09-19 19:09:08 -0400] cp_clegg: When trying to knife upload cookbook I get a 500 internal server error "cannot generate tempfile /usr/share/chef-server/api/sandbox....etc...".  It does not appear to be a permissions issue or disk space issue on the server.  Has anyone seen this or have any ideas?
[2012-09-19 19:09:14 -0400] jtimberman: peter____, stuartrexking: I believe the regressions for deploy resource are resolved, but I don't remember the conversation. I can ask.
[2012-09-19 19:10:00 -0400] stuartrexking: jtimberman: It would be useful to know where they were resolved.
[2012-09-19 19:10:04 -0400] jtimberman: Not all the bugs are fixed yet.
[2012-09-19 19:10:15 -0400] stuartrexking: Are they ever.
[2012-09-19 19:10:26 -0400] Pushnell: maek: regardless of whether you're running chef in vagrant or some other environment, executing a recipe via shef will perform all of the actions of that recipe.  (unless you use the new 10.14 features of why-run, which I haven't myself played with yet.)
[2012-09-19 19:11:56 -0400] Pushnell: maek: with vagrant, you can configure a default chef run of a single "dummy" cookbook which does nothing.  Then go into shef and include_recipe the recipe you're trying to debug and run it.  You'll get much more extensive debugging output than a normal chef run, and it's interactive so you can play with variables, etc.
[2012-09-19 19:12:21 -0400] maek: Pushnell: ah ok thanks
[2012-09-19 19:12:26 -0400] cp_clegg: Here is the exact error I am getting when trying to upload a cookbook:  http://pastebin.com/3LWqEgKX
[2012-09-19 19:12:28 -0400] maek: so recipe and include_recipe. ty
[2012-09-19 19:14:08 -0400] jtimberman: This is the only ticket I know of for the deploy resource issue: http://tickets.opscode.com/browse/CHEF-3449
[2012-09-19 19:15:28 -0400] jtimberman: j|: It's probably not on the wiki because opscode doesn't prescribe a "best practice" for how you manage your repository. we do have opinions about managing chef repositories based on what we do for our own internal use and projects, but the tools and workflow you adopt are largely up to your own team standards.
[2012-09-19 19:15:41 -0400] jtimberman: folks in the community have opinions and some have written tools as well.
[2012-09-19 19:16:09 -0400] j|: jtimberman: yea, understood. using git submodules seems, so far, to make the most sense to me, personally
[2012-09-19 19:16:17 -0400] jtimberman: cool, then rock it :)
[2012-09-19 19:16:27 -0400] j|: so I'm just looking into how to do that. Perhaps Best Practices was a bit too specific
[2012-09-19 19:16:41 -0400] jtimberman: do note that you shouldn't use the github.com/opscode/cookbooks repository, it is deprecated in favor of the separate repositories.
[2012-09-19 19:16:47 -0400] j|: more what I was asking is "hey, how the heck do I go about doing this submodule thing"
[2012-09-19 19:17:06 -0400] j|: and the link is a great start and now I'm on a second one. seems easy enoughn.
[2012-09-19 19:17:17 -0400] jtimberman: we also don't recommend using the git repositories for our cookbooks; you should use the ones we released on the community site instead.
[2012-09-19 19:17:18 -0400] j|: jtimberman: roger that. 10-4
[2012-09-19 19:17:39 -0400] jtimberman: (the ones in the git repos are in development and are untested :))
[2012-09-19 19:18:35 -0400] j|: cool. thanks for chiming in.
[2012-09-19 19:19:52 -0400] jtimberman: :)
[2012-09-19 19:23:47 -0400] jhayden: I was wondering if someone could give my brain a nudge in the right direction
[2012-09-19 19:24:13 -0400] jhayden: I am building an application stack using AWS Ruby SDK and chef cookbooks
[2012-09-19 19:24:40 -0400] jhayden: part of which is creating autoScaling groups in different regions
[2012-09-19 19:25:23 -0400] en0x: hi
[2012-09-19 19:25:26 -0400] jhayden: What I can't figure out is how to tell the recipes which region I am calling from, so the correct configurations in the app can be set
[2012-09-19 19:25:34 -0400] en0x: i installed chef on centos 6.3 and I have issue starting webui
[2012-09-19 19:25:47 -0400] jhayden: is there a way to pass this iso to chef via user_data?
[2012-09-19 19:26:01 -0400] en0x: http://wklej.org/id/833693/ here is the info
[2012-09-19 19:26:34 -0400] jhayden: info
[2012-09-19 19:28:06 -0400] Eulipion: does anyone know how to get gecode/dep_selector to build correctly on centos6?
[2012-09-19 19:28:28 -0400] Eulipion: i see "spec/unit/run_list_spec.rb:# dep_selector/gecode on many platforms is currenly a bowel of hurt", heh
[2012-09-19 19:28:52 -0400] jtimberman: jhayden: node['ec2'] should have region and az
[2012-09-19 19:28:56 -0400] jtimberman: i don't remember what the subkeys are
[2012-09-19 19:29:06 -0400] jtimberman: but if you look at a node object's ec2 attributes you'll see them
[2012-09-19 19:29:20 -0400] jhayden: ok, thx I'll take a look
[2012-09-19 19:35:25 -0400] jhayden: jtimberman: placement_availablitity_zone, thanks again
[2012-09-19 19:46:25 -0400] josephholsten: has anyone set up the nagios cookbook to send critical alerts to pager duty without sending warnings?
[2012-09-19 19:47:07 -0400] grimesjm: Is anyone running into an ArgumentException when deploying a rails app using application and application_ruby?  I'm getting the error regarding the before_migrate action.  I'm also not directly hooking into any of the callback.
[2012-09-19 19:48:43 -0400] josephholsten: grimesjm: are you running at debug log-lever? could you pastie the log?
[2012-09-19 19:48:48 -0400] josephholsten: log-level
[2012-09-19 19:51:05 -0400] grimesjm: Yeah one sec
[2012-09-19 20:08:40 -0400] cp_clegg: Can anyone help me figure out why cookbook uploads are failing with a 500 Internal Server Error?  Here is the output of my command and server debug log: http://pastebin.com/SWaGW5bw
[2012-09-19 20:10:17 -0400] stuartrexking: cp_clegg: What do you see with "knife cookbook upload artifact -V -V"
[2012-09-19 20:12:26 -0400] angrybit: What are your thoughts on committing the entire chef-repo vs just cookbooks into a version control system?
[2012-09-19 20:13:16 -0400] cp_clegg: stuartrexking:  Here is the output with -V -V:  http://pastebin.com/XCtTQ5iK
[2012-09-19 20:14:17 -0400] stuartrexking: My guess is it's a lack of permissions on your chef-server.
[2012-09-19 20:14:32 -0400] cp_clegg: That was my first guess too but I ruled that out
[2012-09-19 20:14:44 -0400] cp_clegg: Not a disk space issue either
[2012-09-19 20:14:44 -0400] josephholsten: cp_clegg: can you access the web-ui? can you run `knife status` successfully? are you using open source chef or hosted?
[2012-09-19 20:18:50 -0400] cp_clegg: I'm using open source chef.  I can access the web UI and other knife commands seem to be working ok, like search, list, cookbook download.
[2012-09-19 20:19:26 -0400] cp_clegg: I've not used knife status before.  It seems it needs a QUERY argument, what should I use for that?
[2012-09-19 20:21:48 -0400] tmichael: assumed i could query rpm versions via knife, but knife node show -l doesn't show such info.  is this possible or should i just use knife ssh to gather?
[2012-09-19 20:26:40 -0400] mhalligan: man, without fail, every time a cookbook sets up a new apt repo to install the packages, the packages fail
[2012-09-19 20:28:19 -0400] cp_clegg: josephholsten: I'm using open source chef.  I can access the web UI and other knife commands seem to be working ok, like search, list, cookbook download.  knife status does not work, but it doesn't work on our other chef server that doesn't have this problem either.  We have a lot of nodes and that may have something to do with it.
[2012-09-19 20:28:42 -0400] mhalligan: hrm. why would if node.platform == "ubuntu" && %w[10.04 10.10 11.04].include?(node.lsb.release) match on ubuntu 12.04?
[2012-09-19 20:34:27 -0400] hoover_damm: mhalligan, doesn't match here
[2012-09-19 20:34:57 -0400] mhalligan: hoover_damm: hem, must be something else going on in this recipe then.
[2012-09-19 20:35:13 -0400] Eulipion: does anyone know how to get gecode/dep_selector to build correctly on centos6?  i pulled down the lastest code, but cant build it
[2012-09-19 20:35:18 -0400] hoover_damm: mhalligan, that or ruby 1.8.x
[2012-09-19 20:36:18 -0400] mhalligan: hoover_damm: figured it out. I thought it was a selector in sensu::rabbitmq, turns out it's just a stupid assumption in the rabbitmq cookbook.
[2012-09-19 20:36:52 -0400] hoover_damm: mhalligan, to use esl?
[2012-09-19 20:37:31 -0400] mhalligan: hoover_damm, nope, the repo that rabbitmq::default adds to use http://www.rabbitmq.com/debian/ rather than just using Ubuntu's packages
[2012-09-19 20:38:00 -0400] hoover_damm: actually that's right
[2012-09-19 20:38:04 -0400] hoover_damm: ubuntu's packages are outdated
[2012-09-19 20:38:25 -0400] mhalligan: rabbitmq's package is jacked in 12
[2012-09-19 20:38:37 -0400] hoover_damm: rabbitmq is jacked in most releases
[2012-09-19 20:38:45 -0400] hoover_damm: which is why you end up pulling esl erlang and rabbitmq from debian
[2012-09-19 20:39:03 -0400] hoover_damm: https://www.erlang-solutions.com/downloads/download-erlang-otp
[2012-09-19 20:39:20 -0400] mhalligan: esl-erlang doesn't cause any problems
[2012-09-19 20:39:30 -0400] mhalligan: but there's nothing I've been able to do to get the one from rabbitmq.com/devian to start
[2012-09-19 20:39:33 -0400] mhalligan: debian.
[2012-09-19 20:40:02 -0400] hoover_damm: odd it should work some log sluthing should help
[2012-09-19 20:40:16 -0400] mhalligan: not terribly helpful. "no  dot at end of config file" (and there is one)
[2012-09-19 20:41:09 -0400] martinisoft: mhalligan: ive hit that issue
[2012-09-19 20:41:10 -0400] martinisoft: sec
[2012-09-19 20:41:34 -0400] grimesjm: josephholsten: Here is my gist https://gist.github.com/3752128  sorry it took so long
[2012-09-19 20:41:44 -0400] mhalligan: oh hem my cookbook is pretty out of date
[2012-09-19 20:42:23 -0400] martinisoft: ah yeah it just got merged
[2012-09-19 20:42:33 -0400] martinisoft: https://github.com/opscode-cookbooks/rabbitmq/commit/c45ae246bc1285114de8db0e5382e23207556857
[2012-09-19 20:42:39 -0400] martinisoft: that new commit fixes it :)
[2012-09-19 20:43:18 -0400] mhalligan: ah I see, that errant '
[2012-09-19 20:43:26 -0400] mhalligan: thanks
[2012-09-19 20:43:27 -0400] mhalligan: !
[2012-09-19 20:48:21 -0400] mhalligan: that did it
[2012-09-19 20:48:40 -0400] martinisoft: cool :)
[2012-09-19 20:50:09 -0400] mhalligan: one step closer to find / -name "*nagios*" -exec rm -rf {} ;\
[2012-09-19 20:53:01 -0400] _0x783czar: Question about chef solo, my recipes (which run fine in the chef server/client model) are failing in a chef solo run.  Specifically when they try to set a node attribute.
[2012-09-19 20:53:25 -0400] _0x783czar: Is there some difference between chef solo and chef server/client that I'm missing?
[2012-09-19 20:54:26 -0400] mhalligan: with that out of the way, the sensu cookbook rocks. more should follow the "configs are on data bags" pattern.
[2012-09-19 20:55:23 -0400] mhalligan: hem except that it doesn't seem to setup all the gem requirements.
[2012-09-19 20:56:06 -0400] yfeldblum: _0x783czar, hate to be rude, but it's harder to help you effectively if you don't include exactly what failed and how (usually this means precisely quoted versions, error messages, backtraces, and perhaps a relevant snippet)
[2012-09-19 20:58:52 -0400] yfeldblum: mhalligan, why? data-bags introduce additional complexity
[2012-09-19 20:59:32 -0400] _0x783czar: yfeldblum: hey all you have to do is ask.  I just didn't want to spam everyone with a bunch of data if no one is available.
[2012-09-19 20:59:39 -0400] mhalligan: yfeldblum: the pattern makes a lot of sense: put config file in data bag, include recipe, let it do it's thing
[2012-09-19 20:59:53 -0400] _0x783czar: yfeldblum: I'll get you a pastebin link
[2012-09-19 21:00:26 -0400] mhalligan: it feels cleaner and more scaleable rather than putting a bunch of configuration data into a recipe in a "site cookbook"
[2012-09-19 21:02:34 -0400] _0x783czar: yfeldblum: http://pastebin.com/Pqu4fabJ here's the link
[2012-09-19 21:03:06 -0400] _0x783czar: yfeldblum: let me know if you need anything else
[2012-09-19 21:03:44 -0400] yfeldblum: _0x783czar, the exception is raised on `node.save` because the meaning of that is to save node data specifically to the chef-server-api, and with chef-solo there's no chef-server-api
[2012-09-19 21:04:37 -0400] yfeldblum: _0x783czar, that's pretty good but please also include the whole backtrace - chef doesn't print it to the console, but saves it to a file and tells you which file it's in
[2012-09-19 21:04:41 -0400] yfeldblum: _0x783czar, [2012-09-19T14:40:30-06:00] FATAL: Stacktrace dumped to /var/chef-solo/chef-stacktrace.out
[2012-09-19 21:05:12 -0400] _0x783czar: yfeldblum: OK, I'll be sure to do that.  thanks for your helf yfeldblum
[2012-09-19 21:05:18 -0400] yfeldblum: _0x783czar, other than that, your paste makes the question a lot better :P
[2012-09-19 21:05:42 -0400] _0x783czar: yfeldblum: haha, alright I'll make sure to always include it.
[2012-09-19 21:06:48 -0400] yfeldblum: mhalligan, but everything's a tradeoff of course, and sometimes one approach is better but at other times another approach is better; but here you seem to have gone and said we should always use one approach in preference to another, and i think there are plenty of cases where the other approach would be preferable
[2012-09-19 21:07:51 -0400] cwj: mattray: any idea if a recording of today's gazzang webex is going to be made available
[2012-09-19 21:07:53 -0400] yfeldblum: _0x783czar, if you're using chef-solo, why are you trying to save the node? i.e. what is the overall end, toward which you intended saving the node to be a means?
[2012-09-19 21:07:54 -0400] cwj: i missed it
[2012-09-19 21:09:01 -0400] cwj: ive been working on my own zncrypt_license lwrp but interested in seeing what other people are doing
[2012-09-19 21:11:22 -0400] mhalligan: yfeldblum: can you elaborate then? I lean towards data bags so I can use that data outside of Chef, but also because it feels a lot cleaner / more scaleable to be able to pass requisite attributes via data bags or roles.
[2012-09-19 21:12:07 -0400] mhalligan: frequently enough I end up writing providers to abstract other cookbooks so I can just pass a data bag to them
[2012-09-19 21:12:44 -0400] grimesjm: joseph seems to be mia, can anyone explain to me why I am seeing this error or point me in the right direction? I'm trying to deploy a rails app using the application and application_ruby cookbooks and i'm running into this: https://gist.github.com/3752128
[2012-09-19 21:14:44 -0400] _0x783czar: yfeldblum: it's a "chicken-or-the-egg" issue.  We're having chef solo manage our chef-chef server.  So we just wanted to use a cookbook that we were already using in our chef solo
[2012-09-19 21:15:08 -0400] wondra: Anyone knows anything about ticket COOK-1680?
[2012-09-19 21:23:18 -0400] wondra: http://tickets.opscode.com/browse/COOK-1680
[2012-09-19 21:23:21 -0400] yfeldblum: mhalligan, a good approach is to provide abstractions, which others can use with any number of techniques (with node attributes, data-bags, roles, and even just hardcoding things in cookbooks)
[2012-09-19 21:24:32 -0400] _0x783czar: yfeldblum: to be more specific as to "why" we're doing it on the other servers is because we're trying to make some scripts idempotent.  It's a simple way to get them to run only once.  But this is showing us we're going to need to make our scripts handle idempotence on their own.
[2012-09-19 21:25:42 -0400] yfeldblum: _0x783czar, why do you need to save to the chef-server-api in order to get idempotence?
[2012-09-19 21:27:21 -0400] _0x783czar: yfeldblum: maybe I'm unclear on what node.save does, I was under the impression it just commited the attribute changes I made
[2012-09-19 21:30:13 -0400] yfeldblum: _0x783czar, committed them to what?
[2012-09-19 21:31:31 -0400] yfeldblum: _0x783czar, in terms of resource idempotence in chef, that's typically done during convergence by inspecting the state of the system and comparing that state to the resource declaration
[2012-09-19 21:32:31 -0400] _0x783czar: yfeldblum: yes, but I'm using script resources.  Chef doesn't manage idempotence on them
[2012-09-19 21:38:41 -0400] anthroprose: can anyone elaborate on how when I use the service provider like "service "rabbitmq-server" do -/- supports :status => true, :restart => true, :reload => true -/- action [ :enable, :start ] -/- end" it causes the service to shutdown once the chef run completes and/or stops? i.e. I startup rabbitmq using this method, however the services somehow gets shutdown if the bootstrap fails mid-way or even just once the chef run completes
[2012-09-19 21:38:47 -0400] yfeldblum: _0x783czar, perhaps the script itself can be rewritten to be idempotent?
[2012-09-19 21:39:00 -0400] yfeldblum: _0x783czar, e.g., before taking each action, checking if it needs to take that action
[2012-09-19 21:39:01 -0400] anthroprose: its only happening with the rabbitmq service, so it may be something independent... just strange behavior
[2012-09-19 21:39:53 -0400] _0x783czar: yfeldblum: yes, that's what I meant when I said we now have to make our scripts handle idempotence on their own.
[2012-09-19 21:40:34 -0400] yfeldblum: _0x783czar, in chef's world, that's most of the way towards ideal
[2012-09-19 21:40:36 -0400] halkeye: can someone point me in the right direction on how to use notify with deploy to trigger apache restart when code updates?
[2012-09-19 21:41:03 -0400] yfeldblum: _0x783czar, chef would prefer that you be able to figure out (e.g. in a not_if guard on the script resource) whether the script needs to run at all
[2012-09-19 21:41:18 -0400] anthroprose: or use creates...
[2012-09-19 21:41:36 -0400] yfeldblum: _0x783czar, and also the script itself should be idempotent, but beyond that have the ability to decide inside the recipe whether to run the script at all
[2012-09-19 21:43:24 -0400] cwj: halkeye: add 'notifies :reload, "service[apache2]", :delayed' to your deploy resource
[2012-09-19 21:43:31 -0400] cwj: or :immediately instead of :delayed
[2012-09-19 21:43:35 -0400] cwj: depending on your needs
[2012-09-19 21:54:21 -0400] anthroprose: Chef is for some reason sending a -> = ? ERESTARTNOHAND (To be restarted) --- SIGHUP (Hangup) @ 0 (0) ---
[2012-09-19 22:05:57 -0400] halkeye: cwj, does that only fire when deploys actually happen? or each run?
[2012-09-19 22:09:30 -0400] cwj: halkeye: should only fire if the deploy fires
[2012-09-19 22:10:39 -0400] cwj: alternately you can subscribe other resources to the deploy resource, instead of having the deploy resource send them a notification
[2012-09-19 22:11:01 -0400] cwj: gives you some flexibility which can be very helpful
