[2012-09-30 00:57:49 -0400] spoon16: I'm following the EC2 Bootstrap Fast Start Guide and am having a problem.  Anyone here could help take a look? https://gist.github.com/3805525
[2012-09-30 00:58:17 -0400] spoon16: the knife-ec2 gem installs successfully, but cannot be used with a "Cannot find sub command for: 'ec2' error
[2012-09-30 00:58:30 -0400] spoon16: I'm on OSX
[2012-09-30 07:38:31 -0400] Axsuul: any way to get past prompts that require you to press enter?
[2012-09-30 08:19:20 -0400] CrazyHorse181: hey, what do you guys use for keeping processes running
[2012-09-30 08:19:25 -0400] CrazyHorse181: bluepill or monit?
[2012-09-30 08:19:28 -0400] CrazyHorse181: any suggestions on what to sue
[2012-09-30 08:23:28 -0400] railsraider_: CrazyHorse181: blue pill is good for child processes monitoring like unicorn, monit is for a single process
[2012-09-30 08:24:23 -0400] railsraider: guy, i have in my attributes  default['nagios']['mysql']['conversations']['slaves'] = %w{slavedb1 slavedb2 slavedb3}
[2012-09-30 08:24:38 -0400] railsraider: but i try on my recipe if node['nagios']['mysql']['conversations']['slaves'].include?(node['hostname'])
[2012-09-30 08:25:02 -0400] railsraider: and for some reason i get nil on  node['nagios']['mysql']['conversations']['slaves']
[2012-09-30 08:25:34 -0400] CrazyHorse181: ah right
[2012-09-30 08:25:55 -0400] CrazyHorse181: i've basically got a whole bunch of services
[2012-09-30 08:26:01 -0400] CrazyHorse181: which i need to guarantee that they are running
[2012-09-30 08:26:09 -0400] CrazyHorse181: now i could make my own ruby process that checks them
[2012-09-30 08:26:18 -0400] railsraider: monit is ok for a single process
[2012-09-30 08:27:14 -0400] CrazyHorse181: yeah it's a single process per app
[2012-09-30 08:35:16 -0400] railsraider: guys i need a dynamic attribute based on hostname
[2012-09-30 08:35:32 -0400] railsraider: where is the correct place to put the conditions for it?
[2012-09-30 08:38:07 -0400] ichilton: Anyone got/know of a chef cookbook for installing vagrant using the installers? - can't seem to find one, but someone must have done it!
[2012-09-30 10:46:44 -0400] gnoll110: Have lots of fun and games with knifelinode. Linode API call billing before the transaction finishes, then reverses the credit card action after it fails, I think/hope!
[2012-09-30 10:49:20 -0400] gnoll110: about to go to my online banking and say what they thinks happened!
[2012-09-30 10:52:45 -0400] gnoll110: one 21.54 DR then five 0.64DR...
[2012-09-30 12:37:29 -0400] schuckles: hello
[2012-09-30 12:37:43 -0400] schuckles: can I ask for a little bit of help with searching?
[2012-09-30 12:38:50 -0400] schuckles: or tips on how to troubleshoot?
[2012-09-30 12:44:00 -0400] zts: schuckles: best to just ask your question - people will help out if they can
[2012-09-30 12:44:14 -0400] zts: (though it's a little quiet in here today, so you may need to be patient)
[2012-09-30 12:45:12 -0400] schuckles: Here goes: Working with the munin cookbook and currently it fails on executing a search
[2012-09-30 12:45:12 -0400] schuckles: munin_servers = search(:node, "munin:[* TO *] AND chef_environment:#{node.chef_environment}")
[2012-09-30 12:45:53 -0400] schuckles: I'm wondering 1. how that can fail and 2. if I can troubleshoot it with knife, what the syntax is
[2012-09-30 12:46:16 -0400] zts: what's the error you get?
[2012-09-30 12:46:44 -0400] schuckles: ArgumentError - comparison of Chef::Node with Chef::Node failed
[2012-09-30 12:46:58 -0400] schuckles: i assume that the array is empty
[2012-09-30 12:47:21 -0400] zts: as for knife, you could try doing:  knife search node "munin:[* TO *] AND chef_environment:production"
[2012-09-30 12:47:35 -0400] zts: assuming your environment is called "production" - if you're not using environments, do chef_environment:_default
[2012-09-30 12:47:51 -0400] schuckles: the environment is not
[2012-09-30 12:47:54 -0400] schuckles: however the role is
[2012-09-30 12:49:00 -0400] zts: okay, no need to worry about roles here
[2012-09-30 12:49:15 -0400] zts: the value you'll need can be found with:  knife node show <nodename> -a chef_environment
[2012-09-30 12:50:06 -0400] schuckles: its all the nodes
[2012-09-30 12:51:06 -0400] zts: okay, so run that for any one of your nodes
[2012-09-30 12:51:41 -0400] zts: then try the "knife search" line I suggested, using the value it returns as your chef_environment
[2012-09-30 12:52:29 -0400] schuckles: in the author's search query, what does he mean by [* TO *]?
[2012-09-30 12:52:42 -0400] schuckles: i'm attempting to take his query apart
[2012-09-30 12:54:05 -0400] zts: it's documented here - http://wiki.opscode.com/display/chef/Search - and means "any node which has a key munin with any value"
[2012-09-30 13:02:47 -0400] schuckles: HAH
[2012-09-30 13:02:51 -0400] schuckles: i think i found out the issue
[2012-09-30 13:02:52 -0400] schuckles: my golly
[2012-09-30 13:03:19 -0400] schuckles: could it be the fact that the chef server is running 0.10.8?
[2012-09-30 13:05:53 -0400] zts: what version is your chef-client?
[2012-09-30 13:06:28 -0400] schuckles: 10.14.4
[2012-09-30 13:07:37 -0400] zts: no, that shouldn't be a problem
[2012-09-30 13:42:51 -0400] schuckles: well got it working
[2012-09-30 13:42:53 -0400] schuckles: thanks
[2012-09-30 13:43:00 -0400] schuckles: it seemed to have been a few issues
[2012-09-30 13:47:00 -0400] zts: schuckles: glad you sorted it out - what were the issues?
[2012-09-30 13:48:22 -0400] schuckles: when i upgraded chef, i got a different error
[2012-09-30 13:48:36 -0400] schuckles: essentially stating that the sort failed
[2012-09-30 13:48:56 -0400] schuckles: the sort was designed for two different environments, i'm only using one
[2012-09-30 13:49:00 -0400] schuckles: so commented it out
[2012-09-30 13:49:05 -0400] schuckles: and voila
[2012-09-30 14:52:37 -0400] kvanderw: I'm using 'kinfe xenserver vm create' to build  servers. Part of this process seems to require the parameter --node-name. This 'creates' a new node on my chef server. I'm wondering if there is a way to 'recreate' a vm by using an existing node name.
[2012-09-30 15:45:22 -0400] schuckles: Is there a way to manually correct a blank FQDN in chef?
[2012-09-30 16:15:16 -0400] d-rock: In a bit of a panic here. Upgraded chef server to 0.10.14 from 0.10.something (I wasn't paying attention) via Opscode ubuntu repo, and everything is lethargic now. Just doing a "knife node list" (~ 40 nodes) takes 27 seconds
[2012-09-30 16:17:01 -0400] d-rock: Load on my server is ~3, with 4 CPUs. merb is running at most 70% CPU
[2012-09-30 16:17:49 -0400] jb__: how could one execute a command only if the git-resource actually changes something?
[2012-09-30 16:26:21 -0400] jb__: ah, notifies.. too easy
[2012-09-30 16:29:57 -0400] d-rock: Could something be wrong with couch? I'm running chef-client with log level "debug" and I see REST calls to /search/node taking 30-50 seconds
[2012-09-30 16:30:04 -0400] d-rock: Is that solr or is that couch?
[2012-09-30 17:07:39 -0400] gyre008: darnhow can I specify Rackspace auth URL ? I thought putting knife[:rackspace_auth_url] in knife.rb would do the trick but it didn'tknife is ignoring it
[2012-09-30 17:08:00 -0400] schuckles: it works fine for me
[2012-09-30 17:08:10 -0400] schuckles: hold on you need to use a different syntax
[2012-09-30 17:08:27 -0400] gyre008: schuckles, that might be it then :)
[2012-09-30 17:08:32 -0400] gyre008: what would that syntax be ?
[2012-09-30 17:08:56 -0400] schuckles: knife[:rackspace_api_region] = "ord"
[2012-09-30 17:08:57 -0400] schuckles: knife[:rackspace_api_username] = "USERNAME"
[2012-09-30 17:08:57 -0400] schuckles: knife[:rackspace_api_key] = "YOURAPIPASSWD"
[2012-09-30 17:09:20 -0400] gyre008: oh so instead of the whole url i just need a region...
[2012-09-30 17:09:29 -0400] schuckles: infact, i'm using it right now it's about the ONLY thing from rackspace that actually works
[2012-09-30 17:09:36 -0400] schuckles: yup
[2012-09-30 17:09:54 -0400] gyre008: loli don't like Rackspace either ;)
[2012-09-30 17:10:57 -0400] gyre008: lets see
[2012-09-30 17:10:58 -0400] schuckles: my organization is stuck on rackconnect 2.0 and I've been having the dickens of a time trying to come up with a means of making it so I can bootstrap a server and rackconnect it without human interaction
[2012-09-30 17:11:25 -0400] gyre008: :))) i can feel the pain
[2012-09-30 17:11:54 -0400] schuckles: i found a way, but it turns out their script is buggy and leaves the external (public) NIC open half the time thus making it so Ohai cannot come up with an FQDN
[2012-09-30 17:11:57 -0400] gyre008: we are just cloud servers users but its a complete shenaniganswe are gonna be moving either to AWS or to another provider
[2012-09-30 17:12:39 -0400] gyre008: schuckles, nopethat trick with the region didn't help I'm afraid :(
[2012-09-30 17:12:55 -0400] schuckles: what's the error?
[2012-09-30 17:13:07 -0400] gyre008: from the error json I can see that knife is still trying to authenticate against auth.api.rackspacecloud.com
[2012-09-30 17:13:20 -0400] gyre008: my understanding is that it should auth against lon.auth.api.rackspacecloud.com
[2012-09-30 17:13:32 -0400] gyre008: RROR: Excon::Errors::Unauthorized: Expected([200, 204]) <=> Actual(401 Unauthorized)
[2012-09-30 17:13:51 -0400] schuckles: i think you may have to enable your user to access API
[2012-09-30 17:14:00 -0400] gyre008: thats done
[2012-09-30 17:14:10 -0400] gyre008: i also generated API key
[2012-09-30 17:14:27 -0400] gyre008: I'm looking into lib/fog/rackspace.rb
[2012-09-30 17:14:52 -0400] gyre008: and it does something like rackspace_auth_url = options[:rackspace_auth_url] || "auth.api.rackspacecloud.com"
[2012-09-30 17:15:15 -0400] schuckles: I dont have that specified
[2012-09-30 17:15:39 -0400] schuckles: what i pasted you is from my own knife.rb minus the stuff that could get me fired
[2012-09-30 17:16:01 -0400] gyre008: what chef knife version r u on ?
[2012-09-30 17:16:10 -0400] schuckles: ohhhh
[2012-09-30 17:16:18 -0400] schuckles: i'm using a sort of custom version
[2012-09-30 17:16:34 -0400] schuckles: for that whole rackconnect bullhonkey
[2012-09-30 17:16:42 -0400] gyre008: :)
[2012-09-30 17:17:04 -0400] gyre008: I'm pretty sure the problem is the auth service URL
[2012-09-30 17:17:09 -0400] schuckles: my version of knife-rackspace is 0.5.16
[2012-09-30 17:17:18 -0400] gyre008: but how do I force the damn knife to use the correct one
[2012-09-30 17:17:25 -0400] gyre008: or the one specified in knife.rb
[2012-09-30 17:17:57 -0400] gyre008: yeah mine too
[2012-09-30 17:18:02 -0400] schuckles: what happens when you type gem list?
[2012-09-30 17:18:10 -0400] schuckles: should tell you all the versions there
[2012-09-30 17:18:24 -0400] gyre008: I'm running the same version mate
[2012-09-30 17:18:56 -0400] gyre008: the problem is the auth service urlI'm fairly confident about that
[2012-09-30 17:18:59 -0400] d-rock: Gah, I'm turning chef-server off. 50 nodes should not take 55 seconds to list. I'll have to look into this later this evening :(
[2012-09-30 17:19:03 -0400] schuckles: heh
[2012-09-30 17:19:14 -0400] schuckles: you could try this, tho you're probably gonna crunge
[2012-09-30 17:19:14 -0400] gyre008: its trying to authenticate against auth. and it should be authenticating against lon.auth
[2012-09-30 17:19:24 -0400] schuckles: do the old /etc/hosts file redirect ;-)
[2012-09-30 17:19:32 -0400] gyre008: :))
[2012-09-30 17:20:01 -0400] gyre008: why is that darn auth URL option ignoredarrrgh
[2012-09-30 17:20:16 -0400] schuckles: i never specified a URL
[2012-09-30 17:20:19 -0400] schuckles: only the region
[2012-09-30 17:20:36 -0400] gyre008: no sign of region in fog's backspace lib
[2012-09-30 17:20:39 -0400] gyre008: interesting :)
[2012-09-30 17:20:55 -0400] schuckles: try it
[2012-09-30 17:20:56 -0400] gyre008: ill try to hardcode the lon bit into fog RS lib
[2012-09-30 17:21:05 -0400] gyre008: schuckles, i diddidn't work
[2012-09-30 17:21:12 -0400] schuckles: try another region
[2012-09-30 17:21:14 -0400] schuckles: there's only three
[2012-09-30 17:21:40 -0400] gyre008: aaaargh
[2012-09-30 17:21:51 -0400] gyre008: it should be knife[:rackspace_api_auth_url] = "lon.auth.api.rackspacecloud.com"
[2012-09-30 17:21:52 -0400] gyre008: darn
[2012-09-30 17:21:55 -0400] gyre008: let me see
[2012-09-30 17:22:19 -0400] gyre008: https://github.com/opscode/knife-rackspace
[2012-09-30 17:22:29 -0400] gyre008: it says that on github...
[2012-09-30 17:22:33 -0400] gyre008: ok here we go
[2012-09-30 17:22:54 -0400] gyre008: YESSSSSSSSS
[2012-09-30 17:22:57 -0400] gyre008: that did the trick
[2012-09-30 17:23:05 -0400] schuckles: using a different one?
[2012-09-30 17:23:42 -0400] gyre008: we have our stuff in lon.rackspace.so we must specify auth_uri
[2012-09-30 17:23:47 -0400] gyre008: and the above knife config does that
[2012-09-30 17:24:43 -0400] schuckles: Are you guys on rackspace 3.0?
[2012-09-30 17:25:13 -0400] schuckles: if so, it should be smooth sailing from here on out if not, you're going to be in a world of pain
[2012-09-30 17:26:00 -0400] gyre008: nopewe're on 2.
[2012-09-30 17:26:05 -0400] gyre008: yeah its gonna be paing
[2012-09-30 17:26:16 -0400] gyre008: but we have the whole infrastructure in Chef
[2012-09-30 17:26:24 -0400] gyre008: and did a bunch of testing on migrations..
[2012-09-30 17:26:31 -0400] gyre008: so the migration shouldn't be hard
[2012-09-30 17:26:37 -0400] gyre008: but it always is hahaha
[2012-09-30 17:27:21 -0400] schuckles: well, one of the biggest issues i'm dealing with atm is coming up with a bootstrap.erb file that will handle the whole rack connect script
[2012-09-30 17:28:31 -0400] gyre008: I'm working on that stuff now too :) its a bit of a pain though
[2012-09-30 17:28:51 -0400] schuckles: that script that they supply you with, a 20 line bash script is something my 8 year old niece could do i mean, c'mon folks, we're paying upwards of 80k/mth for a faulty 20 line piece of bash?!
[2012-09-30 17:29:15 -0400] gyre008: 80k/mth ???
[2012-09-30 17:29:21 -0400] gyre008: you serious ?
[2012-09-30 17:29:24 -0400] gyre008: darn
[2012-09-30 17:29:30 -0400] gyre008: how big is your infra
[2012-09-30 17:29:38 -0400] gyre008: they haven't supplied us with anything...
[2012-09-30 17:29:40 -0400] schuckles: both dedicated and cloud
[2012-09-30 17:29:45 -0400] gyre008: lucky you! :)
[2012-09-30 17:29:59 -0400] gyre008: unless there is some help site where we could check it out
[2012-09-30 17:31:49 -0400] schuckles: we dont have that big of an infrastructure
[2012-09-30 17:32:13 -0400] gyre008: but paying shit loads already
[2012-09-30 17:32:20 -0400] gyre008: Rackspace are painfully expensive
[2012-09-30 17:32:34 -0400] schuckles: well, you're supposed to get top notch support
[2012-09-30 17:32:44 -0400] schuckles: my old company used Datapipe
[2012-09-30 17:32:50 -0400] gyre008: i like this bootstrap script from matt ray https://github.com/mattray/vbacd-repo/blob/master/.chef/bootstrap/omnibus.erb
[2012-09-30 17:33:02 -0400] gyre008: top notch indeed
[2012-09-30 17:33:15 -0400] schuckles: Yea, I used a version of that
[2012-09-30 17:33:24 -0400] schuckles: i like his use of the proxy
[2012-09-30 17:34:37 -0400] schuckles: hold on, i'll show you the code i ended up using
[2012-09-30 17:35:19 -0400] gyre008: is there any bootstrap proxy I could use ?
[2012-09-30 17:35:33 -0400] schuckles: you set one up yourself
[2012-09-30 17:35:35 -0400] schuckles: squid
[2012-09-30 17:35:58 -0400] gyre008: aargh :)
[2012-09-30 17:36:03 -0400] schuckles: I ended up taking this guy's knife https://github.com/opscode/knife-rackspace/pull/15
[2012-09-30 17:36:24 -0400] schuckles: and sorta tweeked it a bit
[2012-09-30 17:36:31 -0400] gyre008: lemme see
[2012-09-30 17:37:33 -0400] schuckles: squid, btw is really not that difficult to set up that squid.conf file is much more intimidating than it looks (that is, if you just want to proxy over, say, port 8008)
[2012-09-30 17:38:23 -0400] gyre008: might do that..
[2012-09-30 17:38:58 -0400] gyre008: matt ray is saying that the rack connect stuff for bootstrapping on private IP will be available in next version of the plugin
[2012-09-30 17:38:58 -0400] schuckles: believe me when I say that there are some sharp corners with that code
[2012-09-30 17:39:12 -0400] schuckles: ohhh wait
[2012-09-30 17:39:16 -0400] schuckles: i got that working
[2012-09-30 17:39:33 -0400] gyre008: :)
[2012-09-30 17:39:56 -0400] schuckles: however, it HAS to be done on a machine within the datacenter
[2012-09-30 17:40:04 -0400] schuckles: i.e. it will not work from your local workstation
[2012-09-30 17:41:50 -0400] gyre008: thats painful
[2012-09-30 17:42:12 -0400] gyre008: so you must have a workstation with access to private network..
[2012-09-30 17:42:32 -0400] schuckles: dude, you just SSH into a server
[2012-09-30 17:42:40 -0400] schuckles: any server
[2012-09-30 17:43:28 -0400] schuckles: copy over your knife.rb, cookbooks, your validation.pem and voila
[2012-09-30 17:43:31 -0400] gyre008: yeah but still a pain
[2012-09-30 17:43:43 -0400] gyre008: i like doing this stuff from my workstation
[2012-09-30 17:43:55 -0400] gyre008: although you can do knife ssh "knife":)
[2012-09-30 17:44:09 -0400] schuckles: that'd be kinda neat
[2012-09-30 17:44:23 -0400] schuckles: i smell a plugin
[2012-09-30 17:45:01 -0400] gyre008: haha
[2012-09-30 17:45:05 -0400] schuckles: but seriously, all you really need is that bootstrap.erb file on a host in the datacenter and bam, you're done
[2012-09-30 17:45:29 -0400] gyre008: yeahclassic bootstrap stuff...
[2012-09-30 17:45:46 -0400] schuckles: well, bootstrapping should be turn key
[2012-09-30 17:47:00 -0400] schuckles: a number of the very talented engineers in this room could spin up 200+ servers in an hour using AWS. With rackspace, you're lucky you could spin up 10
[2012-09-30 17:48:19 -0400] gyre008: hahahaa
[2012-09-30 17:48:23 -0400] gyre008: true that
[2012-09-30 17:50:06 -0400] gyre008: i wonder if there is any way to specify what environment the mewly bootstrapped server should be in
[2012-09-30 17:51:23 -0400] gyre008: I see. -E
[2012-09-30 17:51:29 -0400] schuckles: huh?
[2012-09-30 17:51:34 -0400] schuckles: very easy
[2012-09-30 17:51:37 -0400] schuckles: two ways
[2012-09-30 17:51:44 -0400] gyre008: -E does the job
[2012-09-30 17:51:46 -0400] schuckles: either in the knife.rb or the command
[2012-09-30 17:53:18 -0400] gyre008: knife bit would be handy
[2012-09-30 17:53:35 -0400] gyre008: so I can specify environment in knife.rb
[2012-09-30 17:53:37 -0400] gyre008: mm
[2012-09-30 17:53:51 -0400] schuckles: this is what my command looks like
[2012-09-30 17:53:52 -0400] schuckles: knife rackspace server create -I XXX -f X -S MY-RS-SERVER01 -N MY-RS-SERVER01 -r 'role[MY_ROLE],role[MY_UTIL]' -d centBootstrap --private-network
[2012-09-30 17:55:32 -0400] gyre008: whats the knife config for the environment ?
[2012-09-30 17:55:40 -0400] gyre008: just environment ?
[2012-09-30 17:56:10 -0400] schuckles: environment "production"
[2012-09-30 17:56:14 -0400] gyre008: cool
[2012-09-30 17:58:26 -0400] schuckles: what i'd like to know is how to destroy a server using knife and have it auto remove it's self from chef-server
[2012-09-30 17:59:46 -0400] schuckles: oh, duh -p
[2012-09-30 18:09:56 -0400] gyre008: arrghthis knife ssh is driving me crazy
[2012-09-30 18:10:17 -0400] schuckles: how so
[2012-09-30 18:10:22 -0400] gyre008: will gist
[2012-09-30 18:10:23 -0400] gyre008: second
[2012-09-30 18:11:07 -0400] JoshuaMiller: knife ssh seems to take forever for me.  However I haven't really bothered to investigate it.
[2012-09-30 18:11:19 -0400] JoshuaMiller: Which is probably the real problem.
[2012-09-30 18:12:10 -0400] gyre008: makes no sense https://gist.github.com/3808036
[2012-09-30 18:12:15 -0400] schuckles: well, while debugging my process - i would monitor the server creation via RS's GUI
[2012-09-30 18:12:25 -0400] gyre008: it looks like in my case it can't authenticate me :D
[2012-09-30 18:12:32 -0400] gyre008: against chef
[2012-09-30 18:12:40 -0400] schuckles: and it was mostly waiting for their servers to spin up and/or getting locked in a que
[2012-09-30 18:12:47 -0400] gyre008: but without knife ssh i can list the nodes and soother stuff too :)
[2012-09-30 18:13:01 -0400] schuckles: or worst yet a fail, which happens about 1 out of 10 times
[2012-09-30 18:13:27 -0400] gyre008: totally retarded
[2012-09-30 18:13:55 -0400] schuckles: ohhh yea, your knife.rb is mucked up
[2012-09-30 18:14:15 -0400] schuckles: or permissions on your file system
[2012-09-30 18:14:40 -0400] gyre008: what ?
[2012-09-30 18:14:48 -0400] gyre008: knife node list works just fine
[2012-09-30 18:15:01 -0400] gyre008: knife search node "chef_environment:staging" works fine too
[2012-09-30 18:15:27 -0400] gyre008: the error is saying that I'm unauthorised wtf :)
[2012-09-30 18:15:35 -0400] schuckles: entertain me
[2012-09-30 18:15:40 -0400] schuckles: just for arguments sake
[2012-09-30 18:15:46 -0400] schuckles: chmod the validation.pem
[2012-09-30 18:15:56 -0400] gyre008: to ?
[2012-09-30 18:15:58 -0400] schuckles: to 777 just for arguments' sake
[2012-09-30 18:16:12 -0400] schuckles: switch it back after you're done, of course
[2012-09-30 18:16:35 -0400] gyre008: validation.pem is not even being used
[2012-09-30 18:16:43 -0400] gyre008: so why should it change anything ?
[2012-09-30 18:17:07 -0400] gyre008: same result
[2012-09-30 18:17:11 -0400] gyre008: with chmod 777
[2012-09-30 18:17:41 -0400] gyre008: aaaaaah
[2012-09-30 18:17:47 -0400] gyre008: i thinkk i knoooooow :)
[2012-09-30 18:17:56 -0400] schuckles: ???
[2012-09-30 18:18:09 -0400] gyre008: I'm such a retard
[2012-09-30 18:18:17 -0400] gyre008: i should use -x as ssh user
[2012-09-30 18:18:18 -0400] gyre008: not -u
[2012-09-30 18:18:22 -0400] gyre008: -u is for Chef auth
[2012-09-30 18:18:45 -0400] gyre008: yep
[2012-09-30 18:18:46 -0400] gyre008: here we come
[2012-09-30 18:18:51 -0400] schuckles: ohhh you're specifying a user
[2012-09-30 18:19:07 -0400] gyre008: is there any way how i can supply the SSH user in knife.rb ?
[2012-09-30 18:19:47 -0400] schuckles: when you bootstrap a machine using the rackspace plugin, there's no need to specify a user
[2012-09-30 18:20:10 -0400] schuckles: when you bootstrap a machine without, it'll ask you for the password of root
[2012-09-30 18:22:18 -0400] schuckles: I guess one could say its 'booty-licious'
[2012-09-30 18:24:23 -0400] gyre008: I'm not talking about bootstraping
[2012-09-30 18:24:28 -0400] gyre008: im talking about knife ssh
[2012-09-30 18:25:10 -0400] schuckles: I have not used the SSH feature of chef yet
[2012-09-30 19:25:10 -0400] ichilton: Does chef-client not look in ~/.chef? - it seems to be looking in /etc/chef and complaining?
[2012-09-30 19:31:08 -0400] gdurham: We are using opscode chef, and we are seeing intermittent issues during a chef-run where a server will stop mid way with this error:Error Syncing Cookbooks, it happens at different places, and if I re-set the run-list and run chef-client again it picks up where it left off and continues...anyone else have this issue, or know a fix?
[2012-09-30 19:31:18 -0400] gdurham: *hosted chef
[2012-09-30 19:47:34 -0400] ichilton: Anyone around able to help me with errors on a first chef-client run with hosted chef?
[2012-09-30 19:48:38 -0400] ichilton: Getting this output - http://pastebin.com/TdfaMrdT
[2012-09-30 21:24:32 -0400] gyre007: ichilton, i think .chef is only for knife
[2012-09-30 21:37:25 -0400] d-rock: Seeing some serious weirdness with chef server 10.14.4
[2012-09-30 21:37:50 -0400] d-rock: Consuming 80% CPU when idle, looping endlessly over rt_sigprocmask(SIG_BLOCK, NULL, [], 8)
[2012-09-30 21:38:04 -0400] d-rock: Taking 40s or more to list 50 nodes...
[2012-09-30 21:38:50 -0400] d-rock: sockets stuck in SYN_RECV, established sockets sitting with thousands of packets in the recv Q
[2012-09-30 21:39:59 -0400] d-rock: Couch is immediately responsive
[2012-09-30 21:42:53 -0400] d-rock: It just seems to be merb that's really slow for some reason
[2012-09-30 21:43:54 -0400] d-rock: Having trouble finding much info on where I can troubleshoot.
[2012-09-30 21:48:06 -0400] z: d-rock: which version of Ruby are you using with it?
[2012-09-30 21:48:31 -0400] d-rock: 1.8.7
[2012-09-30 21:48:52 -0400] d-rock: Trying to upgrade to 1.9.1 right now to see if that helps
[2012-09-30 21:49:03 -0400] d-rock: Just weird that this worked fine for months and then today freaks out
[2012-09-30 21:49:17 -0400] z: d-rock: omnibus chef-client is shipping 1.9.3-p194 right now, and I use that with -server too and its *fairly* okay
[2012-09-30 21:49:44 -0400] d-rock: :/
[2012-09-30 21:51:25 -0400] z: I don't know what the official Opscode view is but Ruby 1.8 is now EOL for most bugs. Security fixes only until June 2013 then you're SOL on those too.
[2012-09-30 21:51:47 -0400] z: http://www.ruby-lang.org/en/news/2011/10/06/plans-for-1-8-7/
[2012-09-30 21:51:50 -0400] d-rock: Yeah, I know. This is an older ubuntu 10.04 box that I was hoping to coast on a bit longer, but I guess I have to nuke it
[2012-09-30 21:53:01 -0400] d-rock: Just making for a really bad day. Chef-client took down 3 servers with 512GB (yes, half a terabyte) of RAM because the client hung and kept spawning new processes until RAM exhausted
[2012-09-30 21:53:35 -0400] d-rock: I had no idea a single chef-client process could consume 10G of RAM until today
[2012-09-30 21:54:49 -0400] z: d-rock: i run chef-client from cron with a lock file
[2012-09-30 21:55:02 -0400] z: d-rock: I believe it'll natively support lockfiles from Chef 11
[2012-09-30 21:55:15 -0400] d-rock: z: Yeah, I'm going to get that going later this evening if I can wrangle the server into shape
[2012-09-30 21:55:47 -0400] z: d-rock: the chef-client Cookbook already supports the init_style you want, but you'll need to hack the locking wrap around its cron-ed command
[2012-09-30 21:56:03 -0400] d-rock: I may also submit a patch for the new "fork_client" handling in chef-client, since it naively spawns more procs even if it still has previous forks outstanding
[2012-09-30 21:56:13 -0400] d-rock: That was the killer
[2012-09-30 21:56:37 -0400] d-rock: 50 chef-client processes at 10GB a piece was completely unexpected
[2012-09-30 21:56:45 -0400] z: 10GB each is a bit LOLWUT
[2012-09-30 21:57:10 -0400] d-rock: Yeah, I'd love to know what exactly it could be doing with that much RAM
[2012-09-30 21:57:22 -0400] d-rock: I suspect I have a whole cascade of issues piling on
[2012-09-30 23:14:48 -0400] hoover_damm: sounds like using search(:node, "*:*").each
[2012-09-30 23:14:54 -0400] hoover_damm: with a lot of nodes
[2012-09-30 23:15:18 -0400] hoover_damm: people rarely like to understand how ugly json can be in ruby :(
[2012-09-30 23:15:28 -0400] hoover_damm: or admit it... hehe
