[2012-09-28 00:00:12 -0400] _0x783czar: rava: found it network.br0.routes.src
[2012-09-28 00:00:51 -0400] rava: _0x783czar: that's a pretty deep attribute, doesn't show up in any other attributes?
[2012-09-28 00:01:57 -0400] _0x783czar: rava: nope
[2012-09-28 00:02:19 -0400] rava: funky
[2012-09-28 00:03:48 -0400] _0x783czar: rava: dang, now it's giving me a "No nodes returned from search"
[2012-09-28 00:04:44 -0400] rava: _0x783czar: i'm still trying to get used to what kind of queries knife ssh will succeed with
[2012-09-28 00:05:11 -0400] _0x783czar: rava: understood
[2012-09-28 00:07:31 -0400] _0x783czar: rava: well, it's really not a problem.  it's probably a better idea to only use the internal ip as the node ipaddress.  I'll just VPN.  Probably a better practice anyway.
[2012-09-28 00:09:41 -0400] rava: any one see a reason why this provider action isn't deleting users? any reason
[2012-09-28 00:09:51 -0400] rava: https://gist.github.com/3797209
[2012-09-28 00:09:57 -0400] edelschaedel: does anyone know the status of hosted chef?  status site says it's resolved, but i still can't authenticate.  do i need to create new keys?
[2012-09-28 00:10:29 -0400] _0x783czar: rava: thanks for you help again rava, as always
[2012-09-28 00:10:30 -0400] rava: this is how it's called in a recipe: https://gist.github.com/3797214
[2012-09-28 00:11:15 -0400] rava: _0x783czar: anytime
[2012-09-28 00:11:33 -0400] rava: the type in that gist happened mid paste
[2012-09-28 00:56:01 -0400] mhalligan: is everyone using hostedchef seeing "Response: Invalid signature for user or client 'CLIENT" right now?
[2012-09-28 01:00:45 -0400] jaimef: is there a "copy file" block?
[2012-09-28 01:00:51 -0400] jaimef: a file not managed by chef
[2012-09-28 01:01:39 -0400] hoover_damm: jaimef, you would end up adding creates and likely use the same filename... so it would not care in the future
[2012-09-28 01:01:53 -0400] hoover_damm: jaimef, not a pattern I would suggest to follow
[2012-09-28 01:02:05 -0400] hoover_damm: jaimef, if chef writes the file, it should maintain the content in it.
[2012-09-28 01:02:09 -0400] hoover_damm: and maintain the file
[2012-09-28 01:06:24 -0400] jtimberman: jaimef: you can copy a file with the file resource
[2012-09-28 01:07:09 -0400] jtimberman: https://gist.github.com/3797407
[2012-09-28 01:18:38 -0400] jtimberman: that will be atomic and idempotent vs using an execute resource to run 'cp', too :)
[2012-09-28 01:21:31 -0400] williamherry: openstack-chef
[2012-09-28 01:24:45 -0400] hoover_damm: frogstack-dog
[2012-09-28 01:39:29 -0400] btm: Chef 10.14.4 is out!
[2012-09-28 01:39:52 -0400] jtimberman: \o/
[2012-09-28 01:45:52 -0400] btm: mhalligan: what changes are grumble inducing?
[2012-09-28 01:46:20 -0400] mhalligan: btm: invalidating client keys that have the same name as your web-portal username
[2012-09-28 01:47:32 -0400] btm: mhalligan: ah. I know they were fixing something related to client names + user names, but I'm not familiar with the specifics.
[2012-09-28 01:48:16 -0400] mhalligan: the whole multi-org authentication thing must be pretty complex
[2012-09-28 01:48:17 -0400] jtimberman: btm: it was the lookup order. before, if someone had a user in the entire system (like, jtimberman), you couldn't create a client named jtimberman because the user was consulted first.
[2012-09-28 01:48:43 -0400] btm: jtimberman: yeah, I meant the specific-specifics. #notmycode
[2012-09-28 01:49:55 -0400] btm: okie, time for beer and maybe socializing with nagios users.
[2012-09-28 01:50:28 -0400] timsmith: Has anyone ever run into a case where if they search for a node by environment they see it with its list of roles, but when they search for it by role the particular nodes don't come back.  I'm really baffled by this one
[2012-09-28 01:51:28 -0400] timsmith: btm: time to merge my next round of nagios updates
[2012-09-28 01:52:07 -0400] btm: timsmith: I totally high-fived webtrends in my nagios talk today.
[2012-09-28 01:52:41 -0400] btm: timsmith: are you searching by 'role' or by 'roles'?
[2012-09-28 01:52:42 -0400] huhongbo: how the chef run with unicron
[2012-09-28 01:52:49 -0400] jtimberman: btm: oh ok :)
[2012-09-28 01:52:59 -0400] jtimberman: specific specifics i don't know either
[2012-09-28 01:53:19 -0400] timsmith: btm: role
[2012-09-28 01:53:21 -0400] jtimberman: huhongbo: chef server?
[2012-09-28 01:53:31 -0400] huhongbo: yes the server api
[2012-09-28 01:53:35 -0400] jtimberman: huhongbo: its good
[2012-09-28 01:53:38 -0400] timsmith: these nodes are in environment COLLECT-PDX-1 and they have the role of zookeeper
[2012-09-28 01:53:49 -0400] timsmith: they show up under COLLECT-PDX-1 searches
[2012-09-28 01:53:52 -0400] timsmith: but not zookeeper searches
[2012-09-28 01:54:11 -0400] timsmith: my first Precise ZK boxes
[2012-09-28 01:54:13 -0400] timsmith: not going so great
[2012-09-28 01:55:31 -0400] huhongbo: when i using one box to manage 600 nodes ,pull data from chef-server is slow,is the couchdb problem?
[2012-09-28 01:56:14 -0400] btm: timsmith: you probably want to search 'roles' which is created by expanding the run list on a client run and then saved back to the server.
[2012-09-28 01:56:47 -0400] btm: timsmith: the only downside of 'roles' is that it isn't available until you run chef-client (or use this script I made tonight https://gist.github.com/3797459)
[2012-09-28 01:56:54 -0400] btm: timsmith: http://wiki.opscode.com/display/chef/Search#Search-FindNodeswithaRoleintheExpandedRunList
[2012-09-28 01:57:10 -0400] timsmith: I've dealt with the expanded run lists before
[2012-09-28 01:57:14 -0400] btm: I don't even remember what 'role' is good for. jtimberman?
[2012-09-28 01:57:16 -0400] timsmith: it needs to converge all at once
[2012-09-28 01:57:24 -0400] timsmith: so it needs to be role
[2012-09-28 01:57:27 -0400] timsmith: it works everywhere else
[2012-09-28 01:57:31 -0400] timsmith: same role
[2012-09-28 01:57:34 -0400] timsmith: same search
[2012-09-28 01:57:39 -0400] jtimberman: btm: that's how it used to be. like, roles wasn't there.
[2012-09-28 01:57:39 -0400] timsmith: just not on my new precise boxes
[2012-09-28 01:57:45 -0400] jtimberman: it didn't exist until dan made that awesome
[2012-09-28 01:57:59 -0400] timsmith: roles is awesome I use that in Nagios
[2012-09-28 01:58:06 -0400] timsmith: but in this case it's not going to work
[2012-09-28 01:58:14 -0400] jtimberman: if a node hasn't successfully run, then it might not have roles populated
[2012-09-28 01:58:31 -0400] btm: oic, role works for roles that are in the run list. i knew that.
[2012-09-28 01:58:52 -0400] jtimberman: right just the node's run list directly
[2012-09-28 01:58:58 -0400] timsmith: runs completed just fine
[2012-09-28 01:59:06 -0400] timsmith: zookeeper is up and going
[2012-09-28 02:00:56 -0400] timsmith: I think it's time to give this a rest
[2012-09-28 02:01:01 -0400] timsmith: perhaps tomorrow it'll magically work
[2012-09-28 02:01:31 -0400] miah: hi
[2012-09-28 02:01:41 -0400] btm: timsmith: yeah, logic functions over here correctly: https://gist.github.com/9ca5b6a74485bc3fa8de
[2012-09-28 02:02:07 -0400] btm: srs, beer time, later pals.
[2012-09-28 02:02:26 -0400] timsmith: gotta run
[2012-09-28 02:02:35 -0400] timsmith: thanks for the info and the script
[2012-09-28 02:02:41 -0400] timsmith: we were just talking about creating that today
[2012-09-28 02:24:28 -0400] gnoll110: Hi all.
[2012-09-28 02:26:31 -0400] gnoll110: Complete chef noobie here. Please, what's the best  posts/notes on setting up chef on Linode?
[2012-09-28 02:44:19 -0400] cheeseplus: gnoll110: are you intending to run your own chef-server or use hosted chef?
[2012-09-28 02:45:24 -0400] gnoll110: own chef-server... I think
[2012-09-28 02:45:49 -0400] gnoll110: noobie, open to be swayyed
[2012-09-28 02:46:59 -0400] iverson0881: i'm trying to build a template that would do a chef search of servers with a specific role, but is it possible to have it search for only within an environment that node would be assigned to?
[2012-09-28 02:47:12 -0400] iverson0881: I'd rather not hardcode the environment inside the template
[2012-09-28 02:47:28 -0400] JasonF: node.chef_environment is the var you're looking for, iverson0881
[2012-09-28 02:47:32 -0400] iverson0881: thank you!
[2012-09-28 02:51:07 -0400] addisonj: just getting started with chef in vpc. ohai isn't properly detecting that I am in ec2. running 0.6.14
[2012-09-28 02:51:19 -0400] addisonj: err Ohai: 6.14.0
[2012-09-28 02:51:27 -0400] gnoll110: cheeseplus: I have an existing server. Want to set up a second server to both learn/test chef. Then move existing sites to new server, rebuild first with chef too, and finally build a chef-server on one of them (once I understand better)
[2012-09-28 03:32:57 -0400] gnoll110: cheeseplus: by the way, I'm got ruby setup, so I 'm using the chef & knife-linode gems. (the knife-linode gem reffers to ec2 in one place, so assuming it's a fork of an ec2 gem)
[2012-09-28 03:37:13 -0400] iverson0881: if i wanted to do something like search(:node, role:WEBSERVER_ROLE) do |n|
[2012-09-28 03:37:14 -0400] iverson0881: WEBSERVER_ROLE_host << n['ipaddress'] end, can I have multiple variable within WEBSERVER_ROLE beyond ipaddress ?
[2012-09-28 03:39:22 -0400] iverson0881: if that makes even remote sense...
[2012-09-28 03:39:42 -0400] juliancdunn: huh?
[2012-09-28 03:40:20 -0400] juliancdunn: need more context to see what you're trying to do
[2012-09-28 03:40:55 -0400] iverson0881: what i'm trying to do is search for a particular role and environment and tag, and then be able to use the IP address and hostname of those servers in my template
[2012-09-28 03:41:01 -0400] iverson0881: i'm writing this part in my recipe
[2012-09-28 03:41:58 -0400] juliancdunn: ok
[2012-09-28 03:42:17 -0400] juliancdunn: well what I usually do is pass all the results from the search to the template as a variable
[2012-09-28 03:42:32 -0400] juliancdunn: and then in the template, iterate over them and pull out the keys/values of interest
[2012-09-28 03:43:07 -0400] iverson0881: hmm, do you have an example?
[2012-09-28 03:44:51 -0400] juliancdunn: iverson0881: yeah: https://gist.github.com/8accf00abf048cdd3c2c
[2012-09-28 03:47:12 -0400] juliancdunn: and then the template example is https://gist.github.com/3797831
[2012-09-28 03:47:43 -0400] iverson0881: ohh okay, got it, thank you!
[2012-09-28 03:48:00 -0400] juliancdunn: np
[2012-09-28 03:54:33 -0400] yfeldblum: juliancdunn, better to pass to the template just the data it needs
[2012-09-28 03:54:36 -0400] rava: anyone have an idea why this provider isn't deleting users in ubuntu 12.04 or debian lenny? https://gist.github.com/3797842
[2012-09-28 03:55:15 -0400] juliancdunn: yfeldman: could do that... I admit I could slim it down beforehand
[2012-09-28 03:55:17 -0400] rava: used thusly in this recipe: https://gist.github.com/3797844
[2012-09-28 04:03:02 -0400] rava: i thought it might be the action order, but that shouldn't matter since, in the databag, they have the action attribute set to remove
[2012-09-28 04:23:57 -0400] zts: addisonj: to hint to ohai that it's on ec2, create a file called /etc/chef/ohai/hints/ec2.json
[2012-09-28 04:26:20 -0400] rava: zts: i missed the question regarding that, but am curious what the effect is
[2012-09-28 04:27:10 -0400] juliancdunn: zts: afaik, the latest knife-ec2 plugin will do that automagically
[2012-09-28 04:27:17 -0400] juliancdunn: (with --hint)
[2012-09-28 04:27:38 -0400] addisonj: yeah, just figured that out a bit ago... trying to make a recipe do it... now I am running into weirdness, I am getting an error that node["ec2"] is empty, but I am only referencing it in the convergence step and I am doing an ohai reload
[2012-09-28 04:27:38 -0400] zts: rava: ohai's ec2 plugin downloads metadata about EC2 instances from an AWS service - which isn't reachable if you're not on AWS, so it attempts to figure out whether you are
[2012-09-28 04:28:13 -0400] zts: rava: unfortunately, the method it uses doesn't work if your instance is in a VPC, so you need to drop that hint file in to say "really, I'm on EC2, fetch the metadata please"
[2012-09-28 04:28:44 -0400] rava: ah
[2012-09-28 04:28:59 -0400] zts: juliancdunn: yup, current bootstrap should do the right thing - but not everyone uses bootstrap to install Chef on their instances :)
[2012-09-28 04:32:04 -0400] rava: anyone have any ideas regarding why that provider i linked in a gist earlier would fail to delete users but not puke the chef-client run?
[2012-09-28 04:36:00 -0400] zts: rava: I think we'd need to see more context... can you gist the whole provider?  Also, what does chef-client log for a relevant run?
[2012-09-28 04:37:35 -0400] rava: zts: provider https://gist.github.com/3797936
[2012-09-28 04:41:01 -0400] zts: rava: okay, that seems reasonable.  Other things to check are whether you're getting search results for the query in :remove
[2012-09-28 04:41:46 -0400] zts: rava: ie, knife search users "groups:developers AND action:remove"
[2012-09-28 04:42:19 -0400] rava: shouldn't users "action:remove" be enough?
[2012-09-28 04:44:02 -0400] rava: is it possible to update a data bag that would only be seen in a specific environment?
[2012-09-28 04:44:05 -0400] zts: rava: not for the provider that you've shared - see the search() call in the :remove action looks for users that also have the relevant group set
[2012-09-28 04:44:19 -0400] rava: zts: good point :)
[2012-09-28 04:45:32 -0400] rava: i ask because the user i'm looking for to be deleted, he's in all 3 groups i have setup
[2012-09-28 04:45:36 -0400] rava: and his action is remove
[2012-09-28 04:45:47 -0400] addisonj: https://gist.github.com/3797963 can someone explain why this doesn't work?
[2012-09-28 04:45:56 -0400] rava: i get that from a knife data bag show users username
[2012-09-28 04:46:14 -0400] zts: rava: check it using search too, please :)  It could be that your search index isn't updating, for example
[2012-09-28 04:46:20 -0400] rava: but if i do that knife search, his user doesn't pop up
[2012-09-28 04:46:32 -0400] zts: rava: but to answer your question, no - there's no per-environment data bags
[2012-09-28 04:46:34 -0400] rava: zts: bah, how can i force an update
[2012-09-28 04:47:40 -0400] zts: rava: you can use "knife index rebuild" to rebuild all your indexes.  Or, just making a small change to one item should be enough to prompt that item to reindex
[2012-09-28 04:48:32 -0400] rava: zts: i made this change a while ago, like several weeks
[2012-09-28 04:48:35 -0400] zts: rava: if that doesn't work, you'll probably need to poke around your chef server to find the cause.  chef-expander is responsible for pushing updates into solr, so that's a good place to start
[2012-09-28 04:49:23 -0400] rava: giving it a whirl, thanks a ton
[2012-09-28 04:50:09 -0400] rava: woot! that did it :)
[2012-09-28 04:50:13 -0400] zts: hurrah!
[2012-09-28 04:50:34 -0400] rava: saved me hours my good friend
[2012-09-28 04:50:54 -0400] zts: glad to be able to help
[2012-09-28 04:51:06 -0400] rava: i'm surprised it hadn't been updated in so long though
[2012-09-28 04:51:19 -0400] rava: that's a 3 week old change
[2012-09-28 04:52:21 -0400] zts: yeah, that does seem a bit odd.  Perhaps something was broken on your chef-server at the time, and has since fixed itself?
[2012-09-28 04:52:53 -0400] zts: but I'm not aware of any common problem along those lines
[2012-09-28 04:53:06 -0400] rava: i had to udpate the chef-client recipe to stop changing the ownership of /var/run|log/chef
[2012-09-28 04:53:10 -0400] rava: not too long ago
[2012-09-28 04:53:19 -0400] rava: every time it ran, it puked my chef-server
[2012-09-28 04:53:38 -0400] rava: that was also 2 weeks ago
[2012-09-28 04:54:47 -0400] rava: i'll have to look at configuration for that later
[2012-09-28 04:54:56 -0400] zts: ah, that'd be my theory then.  I've definitely had that issue cause problems for  chef-solr (I think?  something search-related)
[2012-09-28 04:55:18 -0400] rava: yeah, the server daemon keeps running
[2012-09-28 04:55:27 -0400] rava: but solr and couchdb puke
[2012-09-28 05:01:06 -0400] rava: is there any reason i would want to export vs clone a git repo if i was building a provider to grab a user's dotfiles?
[2012-09-28 05:16:50 -0400] rava: is there an established way to customize the look of the web ui?
[2012-09-28 05:26:23 -0400] gnoll110: anyone been using the knife-linode gem?
[2012-09-28 06:02:13 -0400] huhongbo: i use drbd to ha the chef,i copy every thing include the /etc/chef,but when i switch to standby webui report key error
[2012-09-28 06:02:14 -0400] huhongbo: INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate. Ensure that your client key is valid.
[2012-09-28 06:27:27 -0400] rava: how can i tell in one recipe what recipe's are being applied to the current node?
[2012-09-28 07:03:06 -0400] rava: can i get a list of users that exist on a node in a recipe from the os, or (since i'm using a users cookbook to manage users) do i need to query what group recipes were applied?
[2012-09-28 07:21:30 -0400] zts: rava: by default, node['etc']['passwd'] should contain entries for each user on the node
[2012-09-28 07:22:16 -0400] zts: rava: as for seeing which recipes a node will apply, from within a recipe, look at node['recipes']
[2012-09-28 07:23:58 -0400] rava: zts: thanks, that passwd attribute is much better than the ugly string splitting i was doing to check what groups were applied
[2012-09-28 07:24:57 -0400] zts: rava: no problem - however, be aware that those are "automatic attributes" provided by ohai, so they'll show what was in the password file at the start of your run
[2012-09-28 07:25:14 -0400] zts: rava: if you have added users during the run, you'd need to tell ohai to update the data
[2012-09-28 07:27:18 -0400] zts: rava: ...although at this point, you might be struggling with the different phases of execution of the chef run
[2012-09-28 07:27:24 -0400] zts: rava: what is it you're trying to achieve?
[2012-09-28 07:28:31 -0400] rava: zts: i'm trying to build a recipe in my user management cookbook that, for each user on the server, grab their dotfile customizations from our git repo
[2012-09-28 07:28:57 -0400] rava: zts: and make them available in the user's ~/site directory
[2012-09-28 07:30:32 -0400] zts: rava: does it need to do that for users that were created on the server outside of Chef, or only ones created with the users_manage resource?
[2012-09-28 07:30:47 -0400] rava: only users created with the resource
[2012-09-28 07:31:04 -0400] rava: no other users should exist, besides system/app users
[2012-09-28 07:31:27 -0400] zts: gotcha
[2012-09-28 07:31:53 -0400] rava: zts: was thinking i'll just add the logic in the manage provider instead. maybe as a new action :update
[2012-09-28 07:31:58 -0400] zts: well, here's a link about reloading ohai to pick up newly created users: http://wiki.opscode.com/display/chef/Resources#Resources-Ohai
[2012-09-28 07:32:32 -0400] zts: that sounds like a reasonable approach too
[2012-09-28 07:33:42 -0400] rava: would just need add the action to the user data bag items then
[2012-09-28 07:34:01 -0400] rava: ahh, the frustration and beauty of only slightly opinionnated stacks
[2012-09-28 07:38:23 -0400] rava: time to crash, thanks for the help zts. rest easy
[2012-09-28 07:55:53 -0400] iroller: Heya, any of Opscode guys are around?
[2012-09-28 08:04:55 -0400] gnoll110: Well that didn't work 'knife linode server  reboot', returned true. Server still show on linone panel as being up for over a month.I'll have thought that should have complained about no server specified or actually have rolled the one vps under that account
[2012-09-28 08:13:49 -0400] gnoll110: well at least 'knife linode server create' with any  specified returned false w/ 'ERROR: Fog::Compute::Linode::Error: A Linode label may only contain ASCII letters or numbers, dashes, and underscores, must begin and end with letters or numbers, and be at least 3 characters in length.'
[2012-09-28 08:17:26 -0400] gnoll110: Suspect problem is linode API is 'message sparse', rather than the knife-linone wrapper. Any comments?
[2012-09-28 09:14:06 -0400] gyre007: was 10.14.4 released yesterday ?
[2012-09-28 09:14:13 -0400] gyre007: Where can I find some info ?
[2012-09-28 09:14:33 -0400] gyre007: oh I see!
[2012-09-28 09:24:48 -0400] ranjibd: gyre007, btm has announced it in the mailing list
[2012-09-28 09:26:51 -0400] PapaSierra: morning. when i add the opscode nginx cookbook to my run list i immediately get "FATAL: NoMethodError: undefined method `[]' for nil:NilClass". i'd be guessing but i think it means that a variable somehwere is undefined. can anyone give me a hint how to track this down?
[2012-09-28 10:04:47 -0400] gnoll110: any used knife-linode much?
[2012-09-28 10:27:09 -0400] nomadmonad: guys, I hope my question is easy: how can I just deploy the application?
[2012-09-28 10:27:10 -0400] nomadmonad: I have a node which has one run list, which contains 18 recipes, but there's only one recipe that deploys the application. Now, I want to keep deploying the application many times but no other changes should happen on the node.
[2012-09-28 10:29:21 -0400] nomadmonad: this blog post seems to indicate one should use runlist_modifiers cookbook: http://code.chrisroberts.org/blog/2012/05/09/cooking-up-partial-run-lists-with-chef/
[2012-09-28 10:29:45 -0400] nomadmonad: is it really so, I have no other ways around the problem?
[2012-09-28 10:32:57 -0400] nomadmonad: I'm sorry I got dropped for a moment. I hope I didn't lose anyone's comments
[2012-09-28 10:38:51 -0400] ranjibd: PapaSierra, can you share the stackstrace ?
[2012-09-28 10:43:06 -0400] masterkorp: Hello, i am lint'ing a cookbook and on the follwing recipe http://pastie.org/private/kl7ww5ilehchdebrww89a i get "FC005: Avoid repetition of resource declarations: site-cookbooks/unicorn_vox/recipes/default.rb:28
[2012-09-28 10:43:40 -0400] masterkorp: yet i see to repection
[2012-09-28 10:43:49 -0400] masterkorp: http://acrmp.github.com/foodcritic/#FC005
[2012-09-28 10:43:58 -0400] masterkorp: that could be used in a loop anyways
[2012-09-28 10:44:07 -0400] masterkorp: Any recomendatios would be welcome
[2012-09-28 10:46:44 -0400] masterkorp: ttp://i.imgur.com/JL65L.jpg
[2012-09-28 10:46:45 -0400] masterkorp: http://i.imgur.com/JL65L.jpg
[2012-09-28 10:46:49 -0400] masterkorp: UMERICA
[2012-09-28 12:41:18 -0400] zeroXten: am i going mad? If I create a user with user() and but don't set a gid, then it should automatically create the primary group. I should then be able to use that primary group on a Directory() immediately afterwards using "group username" right?
[2012-09-28 13:09:03 -0400] jespada: guys anyone working on a riemann cookbook ?
[2012-09-28 13:50:37 -0400] matschaffer1: We're trying to have an environment default override an attribute default and set it to null. Anyone know if this is possible? Seems like it isn't.
[2012-09-28 13:51:11 -0400] nwjsmith: I'm running `knife node run_list add NODE 'role[base]' and I'm getting a weird error: "ERROR: The data in your request was invalid\nResponse: Field 'run_list' is not a valid run list"
[2012-09-28 13:51:18 -0400] matschaffer1: So in environment { "default_attributes": { "some_thing": null } } and in attributes defaults["some_thing"] = 50
[2012-09-28 13:51:22 -0400] matschaffer1: the null doesn't seem to override the 50
[2012-09-28 13:53:37 -0400] rep0st: anybody here use Chef with nexenta?
[2012-09-28 14:09:00 -0400] bencaron: can I consider the login on tickets.opscode.com not being SSL as a bug and report it ?
[2012-09-28 14:12:12 -0400] yfeldblum: bencaron, anything at all on that site not being SSL is a bug
[2012-09-28 14:13:12 -0400] bencaron: just wanted to be sure, is it just for me that it's not working?
[2012-09-28 14:13:47 -0400] bencaron: once logged on, i can tack https at the url and it's fine
[2012-09-28 14:14:16 -0400] bencaron: but the logged-off page is not working for me, content is not there and login in don't work
[2012-09-28 14:23:26 -0400] allan_wind: I am having trouble getting a dynamic cookbook file to work.   Specially getting the exception "Chef::Exceptions::CookbookNotFound" with Cookbook  not found.
[2012-09-28 14:23:44 -0400] allan_wind: It works fine if I do a file instead of a cookbook file
[2012-09-28 14:32:12 -0400] mapop: anybody had this kind of problem with opscode website before? "Permission denied. You do not have permission to delete this node. (Error 20030)"
[2012-09-28 14:37:01 -0400] spox: mapop: yeah. it generally is an issue with permissions of the user
[2012-09-28 14:37:18 -0400] spox: however, i have had things get "stuck" and had to query opscode support to get them to forcibly remove it
[2012-09-28 14:37:48 -0400] mapop: hmm, kyeah suddenly my knife node commands stopped workingI only have one user soI guess I'll contact support.
[2012-09-28 14:38:05 -0400] spox: mapop: they are usually pretty quick with them :)
[2012-09-28 14:38:15 -0400] mapop: cool
[2012-09-28 14:52:13 -0400] masterkorp: How can i tell knife ssh to connect trough the ip instead of the hostname ?
[2012-09-28 14:53:09 -0400] masterkorp: -a ipaddress
[2012-09-28 14:53:18 -0400] btm: masterkorp: yup.
[2012-09-28 14:53:29 -0400] btm: masterkorp: knife ssh -a ipaddress
[2012-09-28 14:55:30 -0400] Loof: Can client.rb use ohai?
[2012-09-28 14:56:04 -0400] yfeldblum: Loof, no
[2012-09-28 14:56:18 -0400] masterkorp: btm: Can i set that as default on my knife.rb ?
[2012-09-28 14:56:25 -0400] yfeldblum: Loof, (technically yes, but don't)
[2012-09-28 14:58:15 -0400] Loof: I'm trying to figure out the best way to handle some autoscaling servers on ec2... to my surprise since the node name and cert are already there (it's a snapshot of an existing/working chef instance)
[2012-09-28 14:58:23 -0400] Loof: the chef run simply 'worked'
[2012-09-28 14:58:51 -0400] Loof: It would be cool if I can set chef to run on boot... and have it auto-detect that the instance id has changed... and generate a new client.rb + key
[2012-09-28 14:59:14 -0400] Loof: Otherwise... I could delete the key easily... but generating a new client.rb seems like a pain
[2012-09-28 14:59:20 -0400] yfeldblum: Loof, client.rb is *ruby* ...
[2012-09-28 14:59:33 -0400] yfeldblum: Loof, just figure it out in ruby, in your ruby client.rb ruby
[2012-09-28 15:00:01 -0400] Loof: yfeldblum: Which is why I wanted to use ohai :)
[2012-09-28 15:00:30 -0400] yfeldblum: Loof, ohai won't tell you whether you have a new or existing node
[2012-09-28 15:00:54 -0400] yfeldblum: Loof, but you can certainly do something like this in your client.rb: node_name `hostname -f`
[2012-09-28 15:01:35 -0400] Loof: Nooo, not hostname :)
[2012-09-28 15:01:38 -0400] Loof: that's variable
[2012-09-28 15:01:40 -0400] Loof: curl -s http://169.254.169.254/1.0/meta-data/instance-id/
[2012-09-28 15:02:36 -0400] Loof: But... node_name `FOO` won't get rid of the client cert
[2012-09-28 15:02:46 -0400] Loof: which will no longer match the node_name and thus cause auth errors
[2012-09-28 15:03:06 -0400] Loof: it seems like the only sane thing I can do is configure this via user data... but I was hoping to avoid that actually
[2012-09-28 15:04:24 -0400] yfeldblum: Loof, http://pastie.org/private/bvhhb8iknc3obbpbpzog
[2012-09-28 15:05:01 -0400] yfeldblum: Loof, make an image with chef installed and with a client.rb and with the validation key, but without the client key ... ?
[2012-09-28 15:06:18 -0400] yfeldblum: Loof, http://pastie.org/private/nvbkcnqeps4p4hkolazf5q (other one has a typo)
[2012-09-28 15:08:43 -0400] Loof: yfeldblum: I caught that :) Thanks, that's nifty... smarter than using curl... However, it still doesn't wipe the 'old' cert
[2012-09-28 15:09:23 -0400] yfeldblum: Loof, so make a new blank instance without a client key and use that as your base image?
[2012-09-28 15:11:04 -0400] Loof: yfeldblum: Which involves starting a whole new instance just to change a few files... I've already got a process like that for another service and "too many steps"... "why are we doing that"  blah blah blah
[2012-09-28 15:11:14 -0400] Loof: So, I'm trying to see if there's a smart way to avoid that
[2012-09-28 15:11:28 -0400] Loof: It seems like there should be... chef itself is smart enough
[2012-09-28 15:11:45 -0400] yfeldblum: Loof, this is the smart way ...
[2012-09-28 15:11:59 -0400] Loof: I wonder if there's a way to determine what node name a cert was generated for
[2012-09-28 15:12:20 -0400] Loof: Either that or I'd have to store the current node name in a file (/etc/nodename, heh) and compare it
[2012-09-28 15:12:23 -0400] Loof: OR
[2012-09-28 15:12:23 -0400] Loof: just use userdata
[2012-09-28 15:12:33 -0400] yfeldblum: Loof, it sounds like you're dead-set on a bad solution because of some non-technical pressures?
[2012-09-28 15:12:41 -0400] Loof: But then it's an EC2 only solution... which is ok, but not great
[2012-09-28 15:12:50 -0400] Loof: Why is it a 'bad solution' to have this be smart
[2012-09-28 15:13:04 -0400] Loof: It gives us the flexibility to solve problems different ways
[2012-09-28 15:13:14 -0400] Loof: let's say there's some emergency and they need to start another server like this one
[2012-09-28 15:13:32 -0400] Loof: they don't have to go through an extra process... snapshot current... start new from snapshot...and it works
[2012-09-28 15:13:40 -0400] Loof: that sounds like a GOOD solution :)
[2012-09-28 15:14:26 -0400] Loof: Start up... and have multiple servers using the same node name... that sounds problematic at best
[2012-09-28 15:14:42 -0400] yfeldblum: Loof, put the configuration in chef, make a chef role for each server role you actually have, and just start a new ec2 instance and assign it the chef role
[2012-09-28 15:14:45 -0400] Loof: Start up... and fail to start properly because of an auto error... seems bad
[2012-09-28 15:14:59 -0400] Loof: yfeldblum: Doesn't work for my use case
[2012-09-28 15:15:16 -0400] Loof: There's an external service that starts up the instances
[2012-09-28 15:15:23 -0400] Loof: I can pass in userdata... but nothing else
[2012-09-28 15:15:42 -0400] Loof: I'm tempted to make the servers be able to auto-heal... so if no userdata is provided they're not broken
[2012-09-28 15:15:51 -0400] Loof: or 'worse' seem like they're ok... but all end up using the same node name
[2012-09-28 15:15:54 -0400] yfeldblum: Loof, so put the role-name into the userdata?
[2012-09-28 15:16:55 -0400] Loof: yfeldblum: Well yes, at that point I can put the client.rb and remove the key in userdata too
[2012-09-28 15:17:19 -0400] yfeldblum: Loof, no
[2012-09-28 15:17:27 -0400] Loof: yfeldblum: My informal goal is to be stupid proof... if no userdata is provided because someone is retarded... we don't end up with a bunch of instances thinking that they're all the same node name and appearing to work
[2012-09-28 15:17:50 -0400] yfeldblum: Loof, so take the thing that launches instances and make it say "no" if the operator doesn't give a role
[2012-09-28 15:18:01 -0400] Loof: yfeldblum: Not my code
[2012-09-28 15:18:20 -0400] Loof: yfeldblum: It's Amazon's code, in fact... and I'm looking at a couple of other packages and they're both not my code either
[2012-09-28 15:18:38 -0400] yfeldblum: Loof, maybe you're not explaining the full story?
[2012-09-28 15:19:05 -0400] Loof: yfeldblum: Well no, my constraints are simple... I'm snapshotting an existing working chef instance
[2012-09-28 15:19:15 -0400] Loof: and starting new ones from that snapshot + userdata
[2012-09-28 15:19:18 -0400] Loof: I want them to work properly
[2012-09-28 15:19:24 -0400] Loof: that's what I'm working with
[2012-09-28 15:19:36 -0400] yfeldblum: Loof, also, the solution i described means each ec2 instance has a *different* node-name because the node-name comes directly from the instance metadata on each chef-client run
[2012-09-28 15:19:47 -0400] Loof: I -could- start snapshot 1... changet things... make snapshot 2
[2012-09-28 15:19:51 -0400] Loof: yfeldblum: Yes, I agree!
[2012-09-28 15:19:52 -0400] yfeldblum: Loof, snapshotting an existing working chef instance is not how to use chef
[2012-09-28 15:20:06 -0400] Loof: yfeldblum: It's not how YOU use chef... it's how WE will use chef :)
[2012-09-28 15:20:16 -0400] Loof: If chef doesn't work for that... then we'll eliminate chef... the process is already set
[2012-09-28 15:20:34 -0400] Loof: However, there's no good reason that chef can't work as a pure configuration management system
[2012-09-28 15:20:42 -0400] Loof: as opposed to a full system management package
[2012-09-28 15:20:53 -0400] Loof: We're using chef for CM... not package/OS management
[2012-09-28 15:21:21 -0400] yfeldblum: Loof, you can certainly have a base image with your OS and packages set up, and *then* stick chef on top of that
[2012-09-28 15:21:22 -0400] Loof: The most it's doing in the OS is making sure the chef client matches the server... updating it...and auto-restarting services when a configuration changes
[2012-09-28 15:21:39 -0400] yfeldblum: Loof, but do the snapshot before running chef
[2012-09-28 15:21:51 -0400] Loof: Then it would be unconfigured
[2012-09-28 15:21:53 -0400] Loof: thus untestable
[2012-09-28 15:21:56 -0400] Loof: thus unusable
[2012-09-28 15:22:09 -0400] Loof: The idea is that we test _EXACTLY_ what is going to go into production
[2012-09-28 15:22:22 -0400] Loof: not a similar server... not a base + dev + whater + chef
[2012-09-28 15:22:29 -0400] Loof: ^whatever
[2012-09-28 15:22:39 -0400] Loof: That's why the snapshot -> instance
[2012-09-28 15:22:49 -0400] yfeldblum: Loof, then don't use chef, and instead create images using another tool?
[2012-09-28 15:22:50 -0400] Loof: The fact that there's no intermodal step is due to using autoscaling
[2012-09-28 15:23:10 -0400] Loof: yfeldblum: So you're saying chef can't be a pure configuration management system?
[2012-09-28 15:23:27 -0400] Loof: Right now chef manages the changes in config between staging and prod, for instance.
[2012-09-28 15:23:29 -0400] yfeldblum: Loof, pre-bake the image, test the image, then launch the image in production in an autoscaling group?
[2012-09-28 15:23:43 -0400] Loof: Yes, that's exactly what we're doing
[2012-09-28 15:24:01 -0400] yfeldblum: Loof, yeah, and chef isn't part of that picture really ...
[2012-09-28 15:24:10 -0400] Loof: between 'test the image' and 'launch the image' there has to be a step to change 'stage' into 'prod'
[2012-09-28 15:24:20 -0400] Loof: chef seems like the ideal tool for that... any reason it wouldn't be?
[2012-09-28 15:24:41 -0400] yfeldblum: Loof, i mean you could mount an full-stack-installed chef-solo in /opt/chef and use that to bake images
[2012-09-28 15:24:46 -0400] Loof: and in prod... I want a step for 'validate the new instance... add to ELB only if it passes' chef also seems like the right tool for that too
[2012-09-28 15:25:03 -0400] Loof: Yes, almost all of the autoscale examples use chef solo
[2012-09-28 15:25:07 -0400] Loof: which seems backwards to me
[2012-09-28 15:25:12 -0400] Loof: I want a central repo
[2012-09-28 15:25:19 -0400] Loof: I want configuration management from a single point
[2012-09-28 15:25:25 -0400] yfeldblum: Loof, you picked up a hammer (chef) and are trying to use it to screw in a screw and tighten a nut
[2012-09-28 15:25:28 -0400] Loof: Not a whole bunch of self configuring servers
[2012-09-28 15:25:54 -0400] Loof: I don't quite understand why it can't fulfill that role
[2012-09-28 15:26:02 -0400] Loof: why does chef have to manage the ENTIRE server... or not at all?
[2012-09-28 15:26:20 -0400] Loof: I don't need a package baker... I've got that
[2012-09-28 15:26:34 -0400] Loof: I don't need a scripted language stack builder or module manager... that already exists
[2012-09-28 15:26:54 -0400] Loof: Just like git already exists...
[2012-09-28 15:27:21 -0400] Loof: Chef is covering the 'configuration management' part... which is Exactly that... managing system & app configuration files
[2012-09-28 15:27:25 -0400] Loof: nothing else
[2012-09-28 15:27:32 -0400] yfeldblum: Loof, your questions sound to me like: "i've got this screw that i need screwed into some wood, and i've got this hammer, so how do i use the hammer to screw in the screw?"
[2012-09-28 15:27:40 -0400] Loof: Can you please explain why that doesn't work?
[2012-09-28 15:28:02 -0400] Loof: I've got this tool... I expected it to be able to handle my screwy requirements...
[2012-09-28 15:28:17 -0400] Loof: you're saying the tool is ineffective for pure CM... so all I'm asking for is the reasons
[2012-09-28 15:28:21 -0400] yfeldblum: Loof, but unfortunately the tool has a broad, flat, blunt, hard striking surface
[2012-09-28 15:28:30 -0400] Loof: If I've picked the wrong tool... then that's fine
[2012-09-28 15:28:31 -0400] yfeldblum: Loof, you may prefer chef-solo
[2012-09-28 15:28:37 -0400] Loof: I don't prefer chef solo
[2012-09-28 15:28:39 -0400] Loof: I played with it
[2012-09-28 15:28:47 -0400] Loof: It works fine if there are 5 servers
[2012-09-28 15:28:50 -0400] Loof: but 50?
[2012-09-28 15:28:51 -0400] Loof: nah
[2012-09-28 15:29:00 -0400] yfeldblum: Loof, joyent uses it for 10s of ks
[2012-09-28 15:29:10 -0400] Loof: Then why does chef server exist?
[2012-09-28 15:29:18 -0400] Loof: If solo is great... what's the point of server?
[2012-09-28 15:29:27 -0400] yfeldblum: Loof, because different people are different?
[2012-09-28 15:29:41 -0400] Loof: Ok, what I want is while it's 'just me' I can change one file
[2012-09-28 15:29:51 -0400] Loof: and either run one commmand to update everything
[2012-09-28 15:30:00 -0400] Loof: or let new instances get the new config
[2012-09-28 15:30:18 -0400] Loof: And have that be a push from dev... not something else
[2012-09-28 15:30:37 -0400] Loof: I want to let other people use the system without having to learn chef or learn ruby or do 3 or 4 extra steps
[2012-09-28 15:30:40 -0400] Loof: because they won't
[2012-09-28 15:30:42 -0400] Loof: they'll forget to
[2012-09-28 15:30:44 -0400] Loof: they'll mess itu p
[2012-09-28 15:30:51 -0400] Loof: And I can't always be around to do deployments
[2012-09-28 15:31:04 -0400] Loof: nor do I want that sort of role... where I'm the gateway... ugh
[2012-09-28 15:31:05 -0400] geekbri: sounds like you need to build a tool on top of chef, or a knife plugin to me.
[2012-09-28 15:31:12 -0400] Loof: geekbri: I did that already :)
[2012-09-28 15:31:17 -0400] geekbri: we have knife plugins that allow anybody to do deployments
[2012-09-28 15:31:21 -0400] Loof: geekbri: I've got a plugin to build most of these things
[2012-09-28 15:31:26 -0400] Loof: This is just a last mile issue
[2012-09-28 15:31:27 -0400] geekbri: well, at least the people i specify
[2012-09-28 15:31:37 -0400] Loof: I have an autoscale group... I want to start with a working chef instance
[2012-09-28 15:31:49 -0400] Loof: I need to change the node name and clear the 'old' client cert
[2012-09-28 15:32:07 -0400] Loof: yfeldblum is saying that's a big no-no and I should be using chef-solo or not using chef at all if that's what I want
[2012-09-28 15:32:17 -0400] yfeldblum: Loof, no ...
[2012-09-28 15:32:21 -0400] Loof: I'd RATHER not rely on userdata to do it, because people will forget or mess it up
[2012-09-28 15:32:38 -0400] Loof: And yes, people manually install crap on the instances
[2012-09-28 15:32:51 -0400] Loof: I'd like to move away from that... but it's not something I'm going to kill in the current culture
[2012-09-28 15:32:58 -0400] yfeldblum: Loof, i'm saying you picked up a hammer and you have a screw and you're trying to bang that screw in right now, instead of stepping back and looking at how screws work and how hammers work
[2012-09-28 15:32:59 -0400] Loof: so why fight it... make something that works with it
[2012-09-28 15:33:35 -0400] Loof: yfeldblum: I have looked at it... The reality is that I can easily see how to detect it in client.rb... and remove the file if it changes... your code does eliminate a fork, which is great
[2012-09-28 15:33:56 -0400] Loof: yfeldblum: This sounds to me like I've picked the right tool for the job... so I don't understand your hammer / srew example
[2012-09-28 15:34:11 -0400] Loof: yfeldblum: I'd appreciate if you site a specific example of why you feel it's the wrong tool for the job
[2012-09-28 15:34:30 -0400] Loof: otherwise I can haul around gravel in the back of my pickup... yah, a dump truck would be better... but so what, this works
[2012-09-28 15:34:53 -0400] Loof: I'm not looking for perfect
[2012-09-28 15:35:01 -0400] Loof: I'm looking for 'works well' and 'does not break easily'
[2012-09-28 15:35:03 -0400] Loof: fragile is no good
[2012-09-28 15:36:55 -0400] yfeldblum: Loof, because chef-client/chef-server are designed around managing all aspects (except for the base image) of long-term instances which have individual identities and slowly-evolving configuration, and you've got autoscaling groups with ephemeral instances and snapshots and your use case is changing one file
[2012-09-28 15:38:34 -0400] Loof: yfeldblum: Actually, changing around 20... and updating the app via git... this theoretically gives us more flexibility about how the stack is distributed too
[2012-09-28 15:39:00 -0400] Loof: yfeldblum: I understand that chef and and DOES manage all aspects... but why would it be bad NOT to?
[2012-09-28 15:39:24 -0400] Loof: yfeldblum: If someday I decide to go ahead and install nginx with it... great... but if nginx is already there, why should Chef care?
[2012-09-28 15:41:12 -0400] Loof: Mind you, I'm not trying to be argumentative
[2012-09-28 15:41:24 -0400] Loof: I looked at chef and other solutions... I ran some experiments
[2012-09-28 15:41:26 -0400] yfeldblum: Loof, you seem pre-convinced that chef is the right tool
[2012-09-28 15:41:50 -0400] Loof: this seemed like the best tool for the job... but I'm not perfect by a long shot... I may have missed some grave failing or limited functionality
[2012-09-28 15:42:46 -0400] Loof: The puppet folk seem to think puppet is a great solution for this sort of use case... but I've used puppet... didn't really like it for various reasons and it's windows support sucked (maybe still sucks)
[2012-09-28 15:42:48 -0400] yfeldblum: Loof, what about chef in client/server mode, do you think, makes it better for your case than any other tool?
[2012-09-28 15:43:14 -0400] Loof: Well, apart from the standard parts of chef vs puppet vs cengine etc.
[2012-09-28 15:43:51 -0400] Loof: I'm looking for a central repo for configuration... I want to be able to reassign environments and roles on the fly (either running instances or, most likely, at instance startup)
[2012-09-28 15:44:27 -0400] Loof: I want the servers to 'self heal' in the case of a 'wrong' combination (someone starts a dev snapshot as prod, skipping a step for some 'valid' business reason)
[2012-09-28 15:44:30 -0400] yfeldblum: Loof, chef doesn't really do "reassigning environments and roles on the fly"
[2012-09-28 15:44:43 -0400] yfeldblum: Loof, chef doesn't really do "steps"
[2012-09-28 15:44:45 -0400] Loof: yfeldblum: Sure it does... you change the run list... run chef client
[2012-09-28 15:45:07 -0400] Loof: It even supports running chef client based on role
[2012-09-28 15:45:16 -0400] yfeldblum: Loof, i know all that
[2012-09-28 15:45:26 -0400] Loof: the other item that appeals to be is setting up application roles... and thus being able to manage the stack by switching things around
[2012-09-28 15:45:34 -0400] yfeldblum: Loof, but you can't just remove a role and then things go back to the way they were ...
[2012-09-28 15:45:46 -0400] Loof: if we need memcached to now be on it's own instance... we remove the role... change a config... boom, it's done :)
[2012-09-28 15:45:56 -0400] yfeldblum: Loof, chef is designed for generally-additive, slowly-evolving servers
[2012-09-28 15:46:08 -0400] xmltok: you would need to make an inverse role to apply after you have applied the role
[2012-09-28 15:46:15 -0400] xmltok: i dont think chef does what you want it to do
[2012-09-28 15:46:17 -0400] Loof: xmltok: Yes, exactly
[2012-09-28 15:46:30 -0400] xmltok: you could probably twist its arm to make it do it, but its gonna be a nightmare to manage
[2012-09-28 15:47:06 -0400] Loof: xmltok: Or... just disable the service... 'no-memcached' for example
[2012-09-28 15:47:37 -0400] Loof: xmltok: Or... bootstrap with something that removes the certain parts of the config... and then let chef establish the base config
[2012-09-28 15:47:58 -0400] xmltok: i went with an external bootstrapping script that knows how to determine what app and config should be run based on the hostname
[2012-09-28 15:47:59 -0400] Loof: xmltok: Which is what I'm currently doing... bootstrap disables a few services... the 1st boot of chef turns them all on
[2012-09-28 15:48:04 -0400] yfeldblum: http://www.lagrangianpoints.com/wp-content/uploads/2010/03/hammer-and-screw1.jpg
[2012-09-28 15:48:19 -0400] xmltok: so chef could run the bootstrap script but it doesnt really know what it is or does
[2012-09-28 15:48:34 -0400] xmltok: which is fine, i think chef is really bad at managing clusters of things
[2012-09-28 15:48:45 -0400] Loof: xmltok: Which tool would you recommend?
[2012-09-28 15:48:51 -0400] xmltok: like if i have 3 web services, i wouldnt want chef to upgrade all 3 randomly or potentially at the same time
[2012-09-28 15:49:00 -0400] xmltok: im going with fabric to do the clustered management -- at least so far
[2012-09-28 15:49:16 -0400] xmltok: so fabric would log into the nodes in whatever order to activate an upgrade of something using the bootstrap script
[2012-09-28 15:49:17 -0400] Loof: I'm trying to remember why I didn't like fabric... the way I'm handling it is simple
[2012-09-28 15:49:34 -0400] xmltok: i am not managing versions or configurations with fabric
[2012-09-28 15:49:43 -0400] Loof: I've got a bootstrap script to establish a baseline... no client key... correct client.rb... disable a few things... delete a few things
[2012-09-28 15:49:51 -0400] Loof: chef then establishes the config... and maintains it
[2012-09-28 15:49:55 -0400] xmltok: so the bootstrap script is dumb, it can use the hostname and a databag in chef with metadata around my apps
[2012-09-28 15:50:09 -0400] xmltok: ok so my bootstrap is not for chef
[2012-09-28 15:50:15 -0400] xmltok: i jumped into this convo late..
[2012-09-28 15:50:25 -0400] Loof: It's ok, still useful :)
[2012-09-28 15:50:44 -0400] Loof: the 'clusters' are all based around a role
[2012-09-28 15:50:56 -0400] xmltok: i am using chef to do very basic OS level configs, ldap, ntp, dns, packages
[2012-09-28 15:51:17 -0400] yfeldblum: xmltok, which is perfectly fine
[2012-09-28 15:51:18 -0400] Loof: xmltok: I'm using chef for environmental changes + os config
[2012-09-28 15:51:20 -0400] xmltok: yeah, if everything goes my way, there wouldnt be roles for my different services, i am managing over 100 different services
[2012-09-28 15:51:26 -0400] Loof: i.e. dev/stage/prod
[2012-09-28 15:51:37 -0400] xmltok: i have a 'base' role and then a few different roles if i need nfs mounts or things like that
[2012-09-28 15:51:48 -0400] xmltok: basically root configured options
[2012-09-28 15:52:10 -0400] Loof: I did something similar with puppet + capistrano in the past
[2012-09-28 15:52:11 -0400] xmltok: my chef dev/stage/prod versions are completely separated from my application dev/stage/prod
[2012-09-28 15:52:16 -0400] Loof: And I didn't like how it scaled
[2012-09-28 15:52:25 -0400] Loof: The capistrano side ended up growing and growing
[2012-09-28 15:52:37 -0400] yfeldblum: xmltok, "infra dev/stage/prod =/= app dev/stage/prod" is how it should be
[2012-09-28 15:52:38 -0400] xmltok: most things are chef prod. the only dev/stage for chef are my testing and integration environments for chef only
[2012-09-28 15:52:42 -0400] Loof: the crossover was ugly... people didn't know which one to put it in...so they put it in the tool they liked
[2012-09-28 15:52:44 -0400] xmltok: right
[2012-09-28 15:52:57 -0400] Loof: we had some places where I found capistrano was overriding a file set up by puppet and they'd fight
[2012-09-28 15:53:02 -0400] Loof: so I'd have to do a lot of cleanup
[2012-09-28 15:53:51 -0400] Loof: yfeldblum: I get testing infrastructure... but in what case would you want 'prod app' running on 'dev config'?
[2012-09-28 15:54:20 -0400] yfeldblum: Loof, huh?
[2012-09-28 15:54:33 -0400] yfeldblum: Loof, isn't that kind of a ridiculous question?
[2012-09-28 15:54:43 -0400] Loof: yfeldblum: infastructure testing... having a testing process for your CM... that makes sense to me
[2012-09-28 15:55:07 -0400] Loof: yfeldblum: But when would you want a 'prod application' running on a server configured for 'dev' (much less the other way around)
[2012-09-28 15:55:19 -0400] Loof: the dev server shouldn't have direct access to the prod database, for example
[2012-09-28 15:55:34 -0400] yfeldblum: Loof, did i say that?
[2012-09-28 15:55:34 -0400] Loof: in a reasonably hardened environment... that simply shouldn't work
[2012-09-28 15:55:56 -0400] Loof: yfeldblum: Maybe I misread. sorry :)
[2012-09-28 15:56:09 -0400] Loof: So, back to the basics...
[2012-09-28 15:56:38 -0400] Loof: What I've got now is a good process for one app... which involves baking stage into prod - keys... then making a new snapshot
[2012-09-28 15:56:43 -0400] yfeldblum: Loof, i would suggest putting the app's dev, test, qa, stg, prod, etc environments all one prod infrastructure
[2012-09-28 15:57:10 -0400] Loof: What I'm trying to do for this... mostly because it's a totally different environment
[2012-09-28 15:57:22 -0400] Loof: is snapshot and go directly to autoscaling
[2012-09-28 15:57:29 -0400] Loof: this happens to be a windows env.
[2012-09-28 15:57:52 -0400] Loof: So, my goal was simple... start the snapshot via autoscaling
[2012-09-28 15:58:06 -0400] yfeldblum: Loof, but my original comment wasn't about your scenario ... i was agreeing with xmltok that the way he approaches his own infrastructure is a good way, and that's got nothing to do with your infrastructure
[2012-09-28 15:58:07 -0400] Loof: have the new instance detect the instance id changed... remove the key... etc.
[2012-09-28 15:59:09 -0400] Loof: yfeldblum: That's fine... you're saying that the CM config itself should have dev/stage/prod... which is ++good :>
[2012-09-28 15:59:27 -0400] yfeldblum: Loof, right
[2012-09-28 15:59:39 -0400] Loof: xmltok: So, any ideas on that last mile... getting servers to self register cleanly
[2012-09-28 15:59:57 -0400] itwasnta1dy: heya richard
[2012-09-28 16:00:06 -0400] Loof: unregister is going to be a small pain... but I've got an example for that using AWS simple messaging that looks reasonably sane
[2012-09-28 16:00:42 -0400] Loof: yfeldblum: I simply misunderstood and thought you were saying a particular server's config and the app residing on that server... should have distinct envs
[2012-09-28 16:01:01 -0400] Loof: yfeldblum: Which made no sense to me (nor you, obviously)
[2012-09-28 16:01:20 -0400] yfeldblum: Loof, no probs
[2012-09-28 16:07:39 -0400] mattray: just a heads up Ubuntu 12.04 users there's a bug in 10.14.4 Omnibus that breaks knife and shef, work is being done to fix it
[2012-09-28 16:08:02 -0400] mattray: http://tickets.opscode.com/browse/CHEF-3486
[2012-09-28 16:08:33 -0400] JasonF: mattray: chef-server and/or chef-client?
[2012-09-28 16:08:43 -0400] mattray: chef-client Omnibus
[2012-09-28 16:08:51 -0400] mattray: apparently just Ubuntu right now
[2012-09-28 16:09:17 -0400] JasonF: mattray: do you guys generally prefer people to use omnibus, gems, or packages for Ubuntu 12.04?
[2012-09-28 16:09:26 -0400] mattray: JasonF: the bug is related to the Ruby in Omnibus, so you should be fine
[2012-09-28 16:09:49 -0400] JasonF: (specifically asking about server; chef-client we'll do with packages)
[2012-09-28 16:09:51 -0400] mattray: JasonF: Omnibus is our preferred installer, gets the same version of Ruby/Chef/dependencies on every platform
[2012-09-28 16:10:12 -0400] mattray: JasonF: Omnibus server will be available for Chef 11
[2012-09-28 16:10:24 -0400] mattray: alpha preview version available now
[2012-09-28 16:10:26 -0400] JasonF: Does omnibus server not exist for .10?
[2012-09-28 16:10:33 -0400] JasonF: er, 10.14
[2012-09-28 16:10:45 -0400] mattray: JasonF: nope, not until 11
[2012-09-28 16:11:14 -0400] mattray: http://www.opscode.com/blog/2012/08/31/test-drive-the-chef-11-server-preview/
[2012-09-28 16:11:27 -0400] JasonF: Thanks but I think we'll deploy the stable release still :).
[2012-09-28 16:11:36 -0400] JasonF: So in that case, packages vs gems, do you think it matters?
[2012-09-28 16:12:31 -0400] JasonF: I'm a little skeptical of packages, because I couldn't find an SLA on how long you keep older versions and/or how long you support a given LTS (i.e., If I'm still running Ubuntu 12.04 LTS at it's EOL, will you still have package repos for it?)
[2012-09-28 16:15:33 -0400] mattray: we still have 10.04 packages as well, I'm not sure we specify anywhere how long we plan on supporting LTS releases ourselves
[2012-09-28 16:15:47 -0400] mattray: btm: ^?
[2012-09-28 16:17:46 -0400] JasonF: I guess either way, unless I used omnibus, I'm still dependent on you guys supporting the platform.
[2012-09-28 16:20:46 -0400] kyleb: JasonF: You can still update the gem packages that omnibus installs via it's embedded gem
[2012-09-28 16:28:59 -0400] drnfx: What is the proper syntax for adding the EDITOR variable to the knfie.rb file?
[2012-09-28 16:29:04 -0400] drnfx: I have tried ENV['EDITOR
[2012-09-28 16:29:09 -0400] drnfx: Ruby.env
[2012-09-28 16:29:21 -0400] drnfx: bash "this is frustrating" do
[2012-09-28 16:37:53 -0400] jessicab: drnfx: its actually a linux configuration so you can set it in your bashrc, or just add it to your command like like this - 'EDITOR=vi knife client create NAME'
[2012-09-28 16:41:28 -0400] drnfx: jessicab, thanks I had it in my .bashrc file but was trying to see if it was possible to be set from the knife.rb ;_/ oh wellz
[2012-09-28 16:43:37 -0400] yfeldblum: drnfx, you can use the -e arg for knife commands
[2012-09-28 16:43:43 -0400] yfeldblum: drnfx, knife client create NAME -e vim
[2012-09-28 16:44:47 -0400] drnfx: yfeldblum, thats wicked! thanks
[2012-09-28 17:05:55 -0400] jtimberman: drnfx: export EDITOR=vim in your ~/.bashrc or equivalent shell profile :)
[2012-09-28 17:07:57 -0400] drnfx: I use nano :P ... j/k
[2012-09-28 17:08:32 -0400] c_t: time for an EDITOR WAR STEELCAGE MATCH
[2012-09-28 17:09:42 -0400] jtimberman: drnfx: sure :)
[2012-09-28 17:09:53 -0400] jtimberman: whatever editor you like is cool. as long as its not notepad.exe ;)
[2012-09-28 17:10:06 -0400] jtimberman: (and only because that'll do weird stuff with line wraps and the like)
[2012-09-28 17:10:39 -0400] joshhertz: relevant: http://xkcd.com/378/
[2012-09-28 17:12:24 -0400] gyre007: how can I subscribe a resource which is created in definition to any notifications ?
[2012-09-28 17:12:45 -0400] gyre007: ie notification from another resource...
[2012-09-28 17:13:58 -0400] drnfx: notepad.exe is the best windows program ever...
[2012-09-28 17:14:47 -0400] gyre007: basically I need to notify runit_service definied in runit cookbook from a template resource...
[2012-09-28 17:15:07 -0400] gyre007: not sure if I can use just subscribe within runit_service
[2012-09-28 17:15:38 -0400] jtimberman: gyre007: You will want to interact with the service, not runit_service
[2012-09-28 17:16:03 -0400] jtimberman: gyre007: definitions are replaced by the resources they contain in the resource collection, and the runit_service definition creates a service resource for the thing you're managing
[2012-09-28 17:16:11 -0400] gyre007: I see
[2012-09-28 17:16:23 -0400] jtimberman: for example, runit_service "chef-client" will give you a service[chef-client] you can subscribe/notify
[2012-09-28 17:16:50 -0400] jtimberman: this will change somewhat when CHEF-154 is resolved, as it will replace the runit_service defintiion with a real runit_service resource.
[2012-09-28 17:17:25 -0400] gyre007: so I need to notify  the service resource which is part of the runit_service definition...
[2012-09-28 17:17:27 -0400] jtimberman: but the intention there is that nothing changes to your notifications, since it is intended to be a new service resource provider (like init, systemd, launchd etc)
[2012-09-28 17:17:30 -0400] jtimberman: yup
[2012-09-28 17:17:39 -0400] jtimberman: notifies :restart, "service[chef-client]" in that example
[2012-09-28 17:19:25 -0400] gyre007: but I need to subscribe the service to the notification...meaning I will have to modify runit_service definition...
[2012-09-28 17:20:08 -0400] gyre007: I presume...
[2012-09-28 17:22:12 -0400] gyre007: ah..
[2012-09-28 17:22:14 -0400] gyre007: I see
[2012-09-28 17:36:58 -0400] jtimberman: you can "re-open" a resource. that is, you can modify it later in the resource collection in a recipe.
[2012-09-28 17:37:42 -0400] jtimberman: https://gist.github.com/3801186
[2012-09-28 17:37:44 -0400] JasonF: the best example for that is the /etc/aliases definition example in the docs
[2012-09-28 17:38:27 -0400] jtimberman: another example is the mysql::server_ec2 recipe in opscode's mysql cookbook.
[2012-09-28 17:38:34 -0400] jtimberman: it stops mysql, manages the data dir, then starts it.
[2012-09-28 18:09:59 -0400] xeon22: hi everyone
[2012-09-28 18:10:36 -0400] xeon22: would anyone know how to notify another resource from a dynamically defined resource?
[2012-09-28 18:14:22 -0400] xeon22: would anyone know how to notify another resource from a dynamically defined resource?
[2012-09-28 18:14:54 -0400] jb__: hum.. i have a recipe which creates /root/.ssh/config|key|known_hosts - how could i reuse it to create some other users .ssh-stuff?
[2012-09-28 18:15:15 -0400] jb__: thought about setting some variable and include_recipe then
[2012-09-28 18:15:19 -0400] jb__: but that sound awkward
[2012-09-28 18:15:21 -0400] mattray: xeon22: however you defined that resource, just refer to it with the same name
[2012-09-28 18:15:37 -0400] mattray: ie. package "#{foo}"
[2012-09-28 18:16:22 -0400] xeon22: did but what is the method for calling the notification?
[2012-09-28 18:16:47 -0400] xeon22: when you define a resource via t = Chef::Resource::Template.new()
[2012-09-28 18:16:57 -0400] xeon22: t.notify()?
[2012-09-28 18:19:44 -0400] jb__: data well, i'll go for a databag then
[2012-09-28 18:20:08 -0400] yfeldblum: xeon22, what do you mean by "dynamically defined resource"?
[2012-09-28 18:23:50 -0400] xeon22: in a ruby_block ... i create a resource via eg (Chef::Resource::Template.new())
[2012-09-28 18:24:17 -0400] xeon22: set the resource options ... t.source "" etc ....
[2012-09-28 18:24:53 -0400] xeon22: then pass t.run_action(:create)  ... now i need to notify another resource on change
[2012-09-28 18:28:02 -0400] xmltok: anyone users of test kitchen here? it looks pretty good but i am wondering if there is any concern of it only testing at the cookbook level, and not at a role level
[2012-09-28 18:28:28 -0400] miah: at the role level?
[2012-09-28 18:29:01 -0400] xmltok: yeah, what if the role has a second cookbook that somehow clashes with the changed cookbook
[2012-09-28 18:30:16 -0400] yfeldblum: xeon22, why?
[2012-09-28 18:30:31 -0400] samgranieri: how much ram is usually recommended for running a chef server?
[2012-09-28 18:30:55 -0400] xmltok: say for example you have two cookbooks that change the same thing but in different ways. one installs package A at version 1.1, the other at version 1.2, the minitests and whatever else would pass for both cookbooks but your role at the end would only match one of them
[2012-09-28 18:31:12 -0400] xeon22: for example .. i have one recipe that enforces the enabled/disabled state of services on a node
[2012-09-28 18:31:19 -0400] xmltok: or maybe i am misunderstanding how it tests the cookbooks
[2012-09-28 18:32:09 -0400] xeon22: @yfeldblum and in one recipe ( a security one ) i whitelist daemons to be enabled, and disable all others ...
[2012-09-28 18:32:45 -0400] xeon22: @yfeldblum -- then in subsequent cookbooks that manage other applications, they can add themselves to the whitelist
[2012-09-28 18:33:43 -0400] xeon22: @yfeldblum -- then the service cookbook aggegrates the added services with the whiltelisted ones and disables all others that are not whitelisted
[2012-09-28 18:33:55 -0400] wamilton: can anyone explain how sub-resources work like in the application cookbook, or point to info on said?
[2012-09-28 18:34:14 -0400] yfeldblum: wamilton, there's no such thing, and they use a hack
[2012-09-28 18:39:45 -0400] wamilton: yfeldblum: I figured sub-resources weren't "real" in the way that resources are, I was just wondering the pattern was an established practice
[2012-09-28 18:40:36 -0400] yfeldblum: wamilton, sometimes you need such a thing, of course, but it's not an established practice that i know of
[2012-09-28 18:41:48 -0400] xeon22: yfeldblum, these resources btw are created in a ruby_block
[2012-09-28 18:42:12 -0400] miah: ouch.
[2012-09-28 18:42:40 -0400] miah: i hate that ruby_block exists.
[2012-09-28 18:42:50 -0400] miah: also hate the script resource =)
[2012-09-28 18:43:01 -0400] wamilton: yfeldblum: are you familiar enough / do you have enough time to explain what things can and can't be sub-resources in this context?
[2012-09-28 18:43:37 -0400] wamilton: yfeldblum: the way I read it was that you could just in-line configuration of any resource inside of the configuration of the application resource, but that seems not to be what it does...
[2012-09-28 18:45:53 -0400] PapaSierra: i'm using the opscode nginx cookbook but i'm attempting to override the default template file. i think i've followed the naming convention but instead i keep getting the original template file when provisioning
[2012-09-28 18:50:04 -0400] wamilton: PapaSierra: what did you do that you think should have worked?
[2012-09-28 18:50:31 -0400] yfeldblum: miah, http://tinyurl.com/8w6zqrg ?
[2012-09-28 18:51:26 -0400] yfeldblum: wamilton, https://github.com/opscode-cookbooks/application/blob/master/resources/default.rb#L96-129
[2012-09-28 18:52:08 -0400] yfeldblum: wamilton, not recommending this approach for most people in their own cookbooks though
[2012-09-28 18:52:14 -0400] wamilton: PapaSierra: I don't see any attribute parameters that let you override its choice of templates, so I don't know what you could have done that would work
[2012-09-28 18:52:47 -0400] wamilton: yfeldblum: yeah, I'm not planning on re-using it, I just wanted to understand its limitations as I'm trying to build off of the application cookbook
[2012-09-28 18:52:56 -0400] wamilton: yfeldblum: thanks
[2012-09-28 18:53:34 -0400] yfeldblum: coderanger, https://github.com/opscode-cookbooks/application/commit/2ebd9c61d5fef505711382f00d90a177aa46176a#L4R91 ... why?
[2012-09-28 18:53:40 -0400] PapaSierra: wamilton the nginx cookbook has a file: nginx/templates/default/default-site.erb now i've created my own cookbook which contains a runlist and a few other things. in that cookbook i have mycookbook/templates/default/default-site.erb. i am expected chef to prefer my default-site.erb file over the "original" one. like an override of sorts.
[2012-09-28 18:54:16 -0400] miah: i <3 kittens
[2012-09-28 18:54:24 -0400] coderanger: yfeldblum: ? subresources have a pointer to the parent app resource
[2012-09-28 18:54:34 -0400] coderanger: yfeldblum: And gc cycles are baaaad
[2012-09-28 18:54:53 -0400] yfeldblum: coderanger, in refcounting GCs, sure
[2012-09-28 18:55:20 -0400] yfeldblum: coderanger, but why are they bad in a mark-and-sweep GC?
[2012-09-28 18:55:34 -0400] coderanger: yfeldblum: I don't like to make assumptions about the underlying GC tech, the ruby spec doesn't require mark-and-sweep
[2012-09-28 18:55:42 -0400] wamilton: PapaSierra: that isn't how it works -- the recipe is using the template resource and that always looks at the cookbook that implements the recipe
[2012-09-28 18:55:53 -0400] coderanger: and if someone wants to use Chef on jruby, or topaz, or whatever, more power to them
[2012-09-28 18:56:29 -0400] coderanger: and the extra code is like 3 lines
[2012-09-28 18:57:50 -0400] PapaSierra: ok. i thought i'd seen this working in someone else's project. namely https://github.com/Zeelot/vagrant-cookbooks and take a look at https://github.com/Zeelot/vagrant-cookbooks/tree/master/vagrant_main where he manages to override the apache web_app.conf.erb. is that not the same sort of thing?
[2012-09-28 18:57:52 -0400] yfeldblum: coderanger, what's topaz?
[2012-09-28 19:00:10 -0400] PapaSierra: wamilton so is there a right way to achieve this?
[2012-09-28 19:01:04 -0400] PapaSierra: to ask the question generically: how do you override a cookbook's default template by providing your own?
[2012-09-28 19:01:05 -0400] yfeldblum: coderanger, i think it's safe to make this assumption in a cookbook, though ...
[2012-09-28 19:01:26 -0400] coderanger: yfeldblum: Is there a reason to not make it cycle-safe?
[2012-09-28 19:01:37 -0400] coderanger: I don't know of any problems with weakrefs in ruby
[2012-09-28 19:02:13 -0400] wamilton: PapaSierra: https://github.com/opscode-cookbooks/apache2#web_app
[2012-09-28 19:03:03 -0400] wamilton: PapaSierra: there is no general way -- the apache2 cookbook makes available a resource for injecting templates from the calling cookbook
[2012-09-28 19:04:11 -0400] wamilton: PapaSierra: the cookbook you are referring to need only have a template in the proper directory for the platform and the web_app resource will find it and use it
[2012-09-28 19:04:41 -0400] yfeldblum: coderanger, nothing in particular, it's just that it's a solution to a problem that i don't think anybody really has, since mri, jruby, rubinius are all m&s gc's ...
[2012-09-28 19:05:45 -0400] danryan: Yo chefs, can definitions subscribe to actions?
[2012-09-28 19:06:33 -0400] wamilton: danryan: definitions are explicitly for not being notified
[2012-09-28 19:06:56 -0400] danryan: wamilton: lame :)
[2012-09-28 19:07:33 -0400] yfeldblum: danryan, no they cannot, because definitions are macros that are expanded in-line, i.e., in the line that you declare them, and no remnant of the definitions are left once that line is completed
[2012-09-28 19:08:01 -0400] danryan: That's what I feared
[2012-09-28 19:08:07 -0400] yfeldblum: danryan, why do you fear that?
[2012-09-28 19:08:45 -0400] yfeldblum: danryan, also definitions have no concept of guards (only_if/not_if) and no concept of actions and no concept of having been updated
[2012-09-28 19:08:51 -0400] danryan: because I have a definition that I need to be notified of a change in a file defined elsewhere, and now I have to rewrite these definitions as LWRPs
[2012-09-28 19:09:07 -0400] PapaSierra: wamilton sorry my connection dropped out. you linked me to the apache2#web_app section. is this generic? i'm trying to achieve the same but for nginx
[2012-09-28 19:09:40 -0400] wamilton: PapaSierra: no, the point is that it's not generic at all, and you can only do this when the cookbook makes available a resource for you to do it
[2012-09-28 19:09:58 -0400] wamilton: PapaSierra: there is no way to do this with the nginx cookbook, because it doesn't supply a similar resource
[2012-09-28 19:11:01 -0400] yfeldblum: danryan, you can notify the individual resources that the definition expands to
[2012-09-28 19:11:30 -0400] danryan: yfeldblum: ah yes, of course. Duh :) Thanks for remind me
[2012-09-28 19:11:33 -0400] jkyle: where can I find the chef rubydocs
[2012-09-28 19:11:34 -0400] yfeldblum: danryan, for example, if a definition just expands to a package resource, a template resource, and a service resource, you can later-on notify the service resource
[2012-09-28 19:11:35 -0400] danryan: s/remind/reminding
[2012-09-28 19:11:42 -0400] yfeldblum: danryan, or all of the resources
[2012-09-28 19:11:55 -0400] jkyle: or the library documentation
[2012-09-28 19:12:30 -0400] jkyle: found these, but 1/2 the pages throw an error http://rubydoc.info/gems/chef/Chef/Exceptions
[2012-09-28 19:12:33 -0400] PapaSierra: see, i'm not just trying to override *attributes*. i'm trying to override the entire template. because the cookbook's template is far too simplistic. please can someone point me in the right direction
[2012-09-28 19:12:34 -0400] PapaSierra: so then the nginx cookbook is essentially dead? i can't believe that =/
[2012-09-28 19:12:34 -0400] PapaSierra: templates should be overrideable. i think i've seen this in action before
[2012-09-28 19:13:04 -0400] jkyle: PapaSierra: just write your own template
[2012-09-28 19:13:25 -0400] PapaSierra: jkyle yup, that's what i'm trying to do/asking about
[2012-09-28 19:13:37 -0400] jkyle: what's the point of confusion?
[2012-09-28 19:13:53 -0400] PapaSierra: the problem is it's not using my template. it's preferring the original. i can't seem to tell chef to prefer mine
[2012-09-28 19:14:11 -0400] jkyle: did you upload your changes to the chef server?
[2012-09-28 19:14:22 -0400] wamilton: jkyle: PapaSierra is trying to invoke the nginx cookbook from another cookbook
[2012-09-28 19:15:08 -0400] jkyle: ah, I'd probably change the original template
[2012-09-28 19:15:55 -0400] PapaSierra: jkyle i have not edited the nginx cookbook. but i have my own cook book called "main" or whatever. in there i have main/templates/default/default-site.erb (my assumption is that chef has some sort of cascading file system)
[2012-09-28 19:16:40 -0400] PapaSierra: jkyle i could just change the original. i just thought that was bad form
[2012-09-28 19:16:59 -0400] jkyle: you'd generally bolt together multiple cookbooks in roles rather than including a bunch in a "main" cookbook
[2012-09-28 19:17:56 -0400] jkyle: in my experience, cookbooks are rarely very portable...I've generally found it much easier to just write your own for the specific task you're doing. So writing their own or forking and modifying is what most everyone does
[2012-09-28 19:18:11 -0400] PapaSierra: jkyle right, i appreciate that i have much to learn
[2012-09-28 19:18:18 -0400] PapaSierra: ok
[2012-09-28 19:24:31 -0400] PapaSierra: wamilton jkyle it appears this is what i'm trying to do and it also appears that my mess up is that the cookbook has to have the same name: http://support.scalarium.com/kb/custom-instance-setup/how-to-override-templates-in-custom-chef-recipes
[2012-09-28 19:26:04 -0400] jtimberman: the nginx cookbook we publish is in no way "dead"
[2012-09-28 19:26:06 -0400] wamilton: PapaSierra: that's unique to their offering
[2012-09-28 19:26:13 -0400] wamilton: oh snap
[2012-09-28 19:26:25 -0400] jtimberman: it is actively maintained and supported by Opscode.
[2012-09-28 19:26:44 -0400] jtimberman: http://wiki.opscode.com/display/chef/Cookbook%2BSupport
[2012-09-28 19:27:23 -0400] Pushnell: I'm looking at http://community.opscode.com/cookbooks/memcached and not sure I'm following along  Would I set the memory parameter from within a recipe as node['memcached'][:memory] = X ?
[2012-09-28 19:28:03 -0400] jtimberman: Pushnell: if you want to calculate that attribute based on the amount of memory in the machine you're using that on, then yes in a recipe.
[2012-09-28 19:28:19 -0400] PapaSierra: wamilton ok that might be the case. what about this: https://gist.github.com/1713157
[2012-09-28 19:28:20 -0400] jtimberman: if the memory is static and you know that for sure, you can override that in a role.
[2012-09-28 19:28:48 -0400] Pushnell: jtimberman: yeah, I'm calculating it based on available memory.  Just not sure how to actually set the parameter.  I think it's actually node[:memcached][:memory]  still not sure.
[2012-09-28 19:29:02 -0400] jtimberman: PapaSierra: do you need to override global nginx settings, or would virtual host settings be ok?
[2012-09-28 19:30:02 -0400] PapaSierra: jtimberman i'm not sure i understand the question, but basically i'm happy with the nginx conf in general. i'm simply trying to override the template that generates the server (or "v host")
[2012-09-28 19:30:14 -0400] jtimberman: Pushnell: the memory attribute for linux systems is node['memory']['total'] - however it is a string (with Kb at the end, usually)
[2012-09-28 19:30:51 -0400] Pushnell: jtimberman: ah, ok.  thanks.  I can just .to_i it and it'll drop any trailing non-numerical chars
[2012-09-28 19:30:58 -0400] jtimberman: PapaSierra: you can replace the template file in the cookbooks/nginx/templates/default with your own.
[2012-09-28 19:31:08 -0400] jtimberman: Pushnell: yes.
[2012-09-28 19:31:43 -0400] wamilton: jtimberman: where are things like the resources() method from that gist documented?
[2012-09-28 19:31:46 -0400] PapaSierra: jtimberman so you're suggesting simply edit the cookbook's template file? (fine. can do. i just thought that was bad form, but ok)
[2012-09-28 19:33:09 -0400] PapaSierra: i guess i was expecting some sort of cascading override system (i honestly think i've seen this in action!) failing that then i'd expect to use something like jtimberman's suggestion in https://gist.github.com/1713157
[2012-09-28 19:33:54 -0400] jtimberman: the overriding system is typically called "cookbook shadowing" and the feature is deprecated (though it still works)
[2012-09-28 19:34:09 -0400] jtimberman: wamilton: They might be on the Recipes page of the wiki, but I don't recall offhand.
[2012-09-28 19:34:24 -0400] PapaSierra: ah ok
[2012-09-28 19:35:20 -0400] JasonF: I'm looking at the chef-server cookbook from opscode; and trying to parse the apache proxy cookbook. It looks like the webui is setup to listen on :444 whereas the chef server itself listens on :443. Is there any reason it's setup that way? Seems like a PITA to have to type in the port in your browser instead of just configuring it on the clients.
[2012-09-28 19:35:32 -0400] JasonF: er, parse the apache proxy recipe
[2012-09-28 19:36:08 -0400] yfeldblum: JasonF, the chef-server-api is the real deal, and my guess is that most people use the webui only rarely
[2012-09-28 19:37:02 -0400] JasonF: Hm. OK. We had some magic in our homegrown apache proxy config to automatically ship all webui requests to port :444 if they were detected on :443. I guess maybe I'll try to make that change in the cookbook as well and see if I can get it accepted upstream
[2012-09-28 19:37:04 -0400] yfeldblum: JasonF, also feel free to change it, e.g. to have the webui at a subdirectory or an alternate ip etc
[2012-09-28 19:37:43 -0400] JasonF: yfeldblum: Trying to use the cookbook sans patches, if possible.
[2012-09-28 19:38:17 -0400] JasonF: ah. We use nginx, not apache for the proxy.
[2012-09-28 19:39:30 -0400] jtimberman: PapaSierra: to clarify, its not "bad form" to replace the files in the template or otherwise modify them. Some people don't like that because they want to use the "pure" cookbook from the upstream site or for other reasons. That's where the template override demonstrated in that gist come in.
[2012-09-28 19:41:17 -0400] PapaSierra: jtimberman right, i guess that is what i was trying to achieve; using the same rationale. i guess i don't mind modify the cookbook if that's going to simplify things. especially since i'm just using chef solo to provision one server. i'm not yet sophisticated enough to understand "roles" and provisioning clusters of servers
[2012-09-28 19:43:16 -0400] jtimberman: :)
[2012-09-28 19:43:28 -0400] PapaSierra: thanks for the help, i'm learning bit by bit :)
[2012-09-28 19:43:37 -0400] jtimberman: and nothing wrong with simplifying the workflow to fit your requirments.
[2012-09-28 20:00:11 -0400] Pushnell: jtimberman: you still here?
[2012-09-28 20:05:40 -0400] Pushnell: jtimberman: if/when you are, I'd like to discuss making some contributions to the php cookbook
[2012-09-28 20:13:47 -0400] Pushnell: is anyone from opscode around?
[2012-09-28 20:14:00 -0400] Pushnell: questions about the CLA ...
[2012-09-28 20:14:12 -0400] PapaSierra: if there's anyone out there who can explain what's actually happening here i'd be grateful https://gist.github.com/1713157
[2012-09-28 20:14:34 -0400] yfeldblum: Pushnell, what's the question?
[2012-09-28 20:15:22 -0400] Pushnell: opscode privacy policy re: CLA info
[2012-09-28 20:16:13 -0400] jtimberman: http://www.opscode.com/privacy-policy/
[2012-09-28 20:16:18 -0400] jtimberman: that is the privacy policy.
[2012-09-28 20:16:47 -0400] PapaSierra: i'm persisting with this approach: https://gist.github.com/1713157 but can't find docs
[2012-09-28 20:17:18 -0400] wamilton: PapaSierra: there aren't any docs for this, you would have to read the source to know why this works
[2012-09-28 20:17:36 -0400] PapaSierra: eek ok... i'll try
[2012-09-28 20:17:41 -0400] yfeldblum: wamilton, this is fully documented because it's just plain ruby
[2012-09-28 20:17:59 -0400] yfeldblum: PapaSierra, it really is very easy
[2012-09-28 20:18:42 -0400] PapaSierra: yfeldblum ok, i guess i'm just not seeing the signficance of t.source and t.cookbook
[2012-09-28 20:18:52 -0400] PapaSierra: also, /tmp/foo.rb (where is /tmp?)
[2012-09-28 20:18:54 -0400] yfeldblum: PapaSierra, in the foo.rb recipe in that gist, what you've got is a resource declaration using the normal recipe DSL
[2012-09-28 20:20:13 -0400] PapaSierra: oh, does chef literally copy things to /tmp/* ?
[2012-09-28 20:20:27 -0400] jtimberman: the resources() method looks up a resource in the resource collection (all the resources that Chef has encountered in recipes to this point), and it is assigning that object (template "/tmp/foo.rb") to a local variable named 't'. in Ruby, everything is an object, and that is a Chef::Resource::Template object with methods corresponding to its parameters
[2012-09-28 20:20:28 -0400] yfeldblum: PapaSierra, the foo recipe instantiates a resource object with a type of "template" and a name of "/tmp/foo.rb" (the first line)
[2012-09-28 20:20:38 -0400] jtimberman: PapaSierra: that is an example.
[2012-09-28 20:20:47 -0400] jtimberman: it could be /opt/noodles/pastasauce.rb
[2012-09-28 20:20:52 -0400] yfeldblum: PapaSierra, then it adds that resource object to the resources collection
[2012-09-28 20:20:58 -0400] jtimberman: or /etc/nginx/conf.d/nginx-local.conf
[2012-09-28 20:21:32 -0400] yfeldblum: PapaSierra, in the second recipe, the resources method finds the resource of type "template" and name "/tmp/foo.rb" in the resources collection
[2012-09-28 20:22:35 -0400] yfeldblum: PapaSierra, the resources method returns the same resource object, and the recipe stores that in a local variable t, and then the recipe starts setting that resource object's attributes
[2012-09-28 20:23:06 -0400] PapaSierra: ok i'm going to fork this gist and see if i can modify it according to your instruction
[2012-09-28 20:25:19 -0400] Pushnell: yfeldblum: you're probably not the guy to talk to about this, but the privacy policy turns me off from opscode completely.
[2012-09-28 20:26:32 -0400] jtimberman: Pushnell: You can talk to me about that.
[2012-09-28 20:26:41 -0400] jtimberman: Pushnell: can you email joshua@opscode.com?
[2012-09-28 20:26:55 -0400] Pushnell: jtimberman: will do.  thanks.
[2012-09-28 20:29:08 -0400] yfeldblum: Pushnell, heh jtimberman would be a better person to talk to about that, since he works for opscode
[2012-09-28 20:29:33 -0400] wamilton: yfeldblum: what I meant about documentation was that I don't see any way of even finding out that this method would be available in a recipe... if there's a way of discerning this that I'm oblivious to, I'm all ears
[2012-09-28 20:30:05 -0400] yfeldblum: wamilton, which method? #resources?
[2012-09-28 20:30:17 -0400] wamilton: yfeldblum: yes, that one
[2012-09-28 20:35:18 -0400] addisonj: hrm... I am looking for a way to reliably clean up clients and nodes for terminated ec2 instances, I have script but it assumes to much about node and client names
[2012-09-28 20:35:51 -0400] yfeldblum: wamilton, hmmm it does appear hard to find ... best i can do is http://wiki.opscode.com/display/chef/Resources in the section titled "Subscribes Syntax"
[2012-09-28 20:35:58 -0400] addisonj: if I can get a list of instanceids, it seems like I should be able to search and find the node, but I don't know how to link a node to a client
[2012-09-28 20:36:10 -0400] mattray: addisonj: knife ec2 server delete -P not good enough?
[2012-09-28 20:36:13 -0400] PapaSierra: jtimberman yfeldblum am i at all on the right track? please ignore the files "foo.rb" and "other_shit.rb" https://gist.github.com/3801910
[2012-09-28 20:36:42 -0400] addisonj: mattray: ... I had no idea about that command
[2012-09-28 20:36:52 -0400] yfeldblum: addisonj, ohai should have an ec2 plugin that notes the ec2 instance id, and that ec2 instance id data should be saved in the node data for that node in the cehf-server
[2012-09-28 20:37:04 -0400] addisonj: you sir (sorry if not a sir), are a scholar and a gentleman
[2012-09-28 20:37:07 -0400] mattray: addisonj: :) I just added it to knife-hp and rackspace this week, it's been in ec2 for awhile
[2012-09-28 20:37:41 -0400] yfeldblum: addisonj, so you can loop through all nodes using the chef-server api, pull out the ec2 instance ids, and use the ec2 api to figure out which ones are live and which are dead
[2012-09-28 20:39:05 -0400] wamilton: PapaSierra: you want to say `t = resources(:template => "#{node['nginx']['dir']}/sites-available/default]")`
[2012-09-28 20:39:37 -0400] yfeldblum: PapaSierra, looks fine
[2012-09-28 20:39:43 -0400] yfeldblum: wamilton, both should be supported
[2012-09-28 20:39:56 -0400] addisonj: ah oaky, so purge doesn't just query ec2 for me, I wish it took and instance id and figured that out...
[2012-09-28 20:40:13 -0400] addisonj: does the node store a reference to the client associated with it?
[2012-09-28 20:40:16 -0400] PapaSierra: yfeldblum ok, the /home/vagrant/... path was wrong. it wants something relative to "templates/default" i think
[2012-09-28 20:40:47 -0400] mattray: addisonj: -P will also take -N if the node name isn't the same as the ec2 instance name
[2012-09-28 20:41:08 -0400] addisonj: mattray: if the instances are already terminated does it still work?
[2012-09-28 20:41:34 -0400] PapaSierra: yfeldblum ugh... or not. here's the error: http://www.hastebin.com/raw/pehelixoxo
[2012-09-28 20:41:42 -0400] mattray: addisonj: dunno, I think ec2 takes awhile to remove them from the listing
[2012-09-28 20:41:46 -0400] mattray: so maybe?
[2012-09-28 20:42:12 -0400] mattray: rackspace and hp nodes are immediately removed from the results, but ec2 lists terminated nodes for awhile
[2012-09-28 20:43:19 -0400] mattray: but the code probably fails before getting to the client & node deletion if the instance isn't listed
[2012-09-28 20:45:03 -0400] yfeldblum: PapaSierra, you have to have that template in your project cookbook's templates directory (templates/default/default-site.erb)
[2012-09-28 20:45:13 -0400] PapaSierra: yup, it's there
[2012-09-28 20:45:35 -0400] yfeldblum: PapaSierra, and i think you should only use a relative path in the source attribute
[2012-09-28 20:46:28 -0400] yfeldblum: PapaSierra, so you just want "default-site.erb" as the value for that attribute, and chef will look in the cookbook's templates/default/ directory for it
[2012-09-28 20:48:26 -0400] dman7: hello
[2012-09-28 20:48:54 -0400] dman7: Is anyone familiar with using 'users' cookbook [https://github.com/opscode-cookbooks/users]?
[2012-09-28 20:49:11 -0400] PapaSierra: yfeldblum understood, but here's a breakdown of what's happening: http://www.hastebin.com/raw/hebeyipano
[2012-09-28 20:49:31 -0400] wamilton: yfeldblum: in that 'subscribes syntax' area it says that the resource you're accessing with #resources "must come first"... does that mean in the run list, or just that you have to invoke #include_recipe ??
[2012-09-28 20:49:40 -0400] PapaSierra: dman7 best to just ask your question
[2012-09-28 20:49:59 -0400] wamilton: PapaSierra: it might be a poll ;)
[2012-09-28 20:50:13 -0400] rep0st: dman7: it's popular cookbook atleast with getting started with chef
[2012-09-28 20:50:18 -0400] PapaSierra: mayyyybe
[2012-09-28 20:50:44 -0400] yfeldblum: wamilton, it means it has to already be declared somehow and be added to the resources-collection already (there is one resources-collection for the whole chef-client run even if there are multiple recipes) by the time you call the resources method looking for it
[2012-09-28 20:51:00 -0400] dman7: heh, I couldn't infer from the docs whether the cookbook creates any users.
[2012-09-28 20:51:04 -0400] _0x783czar: Question, so I've added an e-mail handler to run as an exception handler, on my client.  However it seems that it only sends an e-mail sometimes.  I haven't exactly been able to identify why this is, but I was wondering if chef runs the exception handlers only on certain types of failed runs.
[2012-09-28 20:51:27 -0400] dman7: The docs mention that it searches in data_bags for users and then lumps those users in a group (default to sysadmin)... but does it automatically create the users?
[2012-09-28 20:51:28 -0400] yfeldblum: wamilton, so if the resource you're looking for with the resources method is declared in a different recipe which is part of the run-list or which is included with include_recipe, that's fine
[2012-09-28 20:52:26 -0400] rep0st: dman7: no it doesnt. You have to populate the array that's being declared in the attributes. You can do so within a role
[2012-09-28 20:52:47 -0400] PapaSierra: yfeldblum sorry to be a PITA but did you see my last paste?
[2012-09-28 20:54:25 -0400] rep0st: dman7: or there was an array being called. lol
[2012-09-28 20:55:15 -0400] yfeldblum: PapaSierra, odd
[2012-09-28 20:55:21 -0400] yfeldblum: PapaSierra, chef-solo or chef-client?
[2012-09-28 20:55:24 -0400] dman7: rep0st: can this be done by simply iterating over data_bag and calling 'user' resource for each element? Or is using roles best practice (fwiw, I'm setting up a server-less node, so without chef server)
[2012-09-28 20:55:26 -0400] PapaSierra: chef-solo
[2012-09-28 20:57:31 -0400] wamilton: PapaSierra: where is your override code?
[2012-09-28 20:57:43 -0400] wamilton: PapaSierra: I mean what file is it in?
[2012-09-28 20:58:18 -0400] PapaSierra: wamilton inside project/recipes/default.rb
[2012-09-28 20:59:01 -0400] yfeldblum: PapaSierra, not sure what the issue is ... probably some silly typo somewhere or something?
[2012-09-28 20:59:44 -0400] jtimberman: wamilton: I added a section to the Recipes DSL page: http://wiki.opscode.com/display/chef/Recipes#Recipes-resources
[2012-09-28 21:00:44 -0400] rep0st: dman7: you know what i got confused witht he sudo cookbook. My apologies. i'm going to have to defer this to someone with better knowledge than i. I only started recently as well.
[2012-09-28 21:01:04 -0400] yfeldblum: jtimberman, nice
[2012-09-28 21:01:21 -0400] dman7: ok, thanks for the help rep0st
[2012-09-28 21:01:43 -0400] yfeldblum: jtimberman, want to write a section on the resources-collection too?
[2012-09-28 21:01:44 -0400] PapaSierra: jtimberman can you add that it doesn't work? ... just kidding =)
[2012-09-28 21:02:04 -0400] yfeldblum: PapaSierra, it works 100% fine, and your error messages in fact prove that it's working fine!
[2012-09-28 21:02:27 -0400] PapaSierra: i know, i was kidding, but really there's something wrong here
[2012-09-28 21:02:42 -0400] yfeldblum: jtimberman, because someone just reading that section may not know off-hand that there's a resources-collection or what it is conceptually
[2012-09-28 21:02:46 -0400] PapaSierra: i honestly can't see any typo. i've triple checked
[2012-09-28 21:02:49 -0400] wamilton: jtimberman: sweet! docs++
[2012-09-28 21:04:11 -0400] dman7: Is it possible to extract attributes from data_bag elements (say, 'ssh_keys' attribute) inside a recipe running chef-solo?
[2012-09-28 21:05:16 -0400] dman7: I've tried data_bag_item('users', #{user})['ssh_keys'] but that returns nil (note, user is a string corresponding to the username)
[2012-09-28 21:05:26 -0400] ev0ldave: possible to use only_if more than once in a block?
[2012-09-28 21:07:20 -0400] PapaSierra: yfeldblum i think i've spotted the problem. currently this path is the *destination*, should it not point to the *source*? Chef::Exceptions::FileNotFound: template[/etc/nginx/sites-available/default] (nginx::commons line 58)
[2012-09-28 21:08:14 -0400] yfeldblum: ev0ldave, do you mean in a resource? if so, yes, and the provider will only run actions if all the guards (only_if & not_if) all pass
[2012-09-28 21:08:40 -0400] yfeldblum: PapaSierra, not sure what you mean
[2012-09-28 21:09:56 -0400] PapaSierra: what i mean is: t = resources("template[#{node['nginx']['dir']}/sites-available/default]") is looking at the destination file. the "output". /etc/nginx/sites-available/default. should it not be pointing to the source file? i.e. the original .erb file/
[2012-09-28 21:10:13 -0400] PapaSierra: it's not what the error message appears to being saying though.
[2012-09-28 21:11:46 -0400] yfeldblum: PapaSierra, no, in fact it's not looking for the "destination file" at all
[2012-09-28 21:12:22 -0400] yfeldblum: PapaSierra, in fact, it's looking at the resources-collection that chef is keeping track of and looking for a resource with type of "template" and name of "/etc/nginx/sites-available/default"
[2012-09-28 21:12:54 -0400] yfeldblum: PapaSierra, but it's not looking at the filesystem to find the resource or anything like that
[2012-09-28 21:12:54 -0400] PapaSierra: ok, that's what i thought and you've confirmed it. then i'm afraid i'm stumped. the error message is misleading
[2012-09-28 21:13:02 -0400] PapaSierra: understood
[2012-09-28 21:14:14 -0400] yfeldblum: PapaSierra, does your project cookbook have a metadata?
[2012-09-28 21:14:24 -0400] PapaSierra: no
[2012-09-28 21:15:06 -0400] yfeldblum: PapaSierra, try adding one
[2012-09-28 21:16:11 -0400] PapaSierra: ok, will try that. just looking for the docs on how to create one (apologies for being a noob)
[2012-09-28 21:17:30 -0400] yfeldblum: PapaSierra, http://wiki.opscode.com/display/chef/Metadata
[2012-09-28 21:17:42 -0400] yfeldblum: PapaSierra, metadata.rb in the root of your cookbook (cookbooks/project/metadata.rb)
[2012-09-28 21:18:07 -0400] PapaSierra: thanks i'm halfway there
[2012-09-28 21:18:23 -0400] wamilton: yfeldblum: could he also just go `vagrant ssh "sudo rm -rf /etc/chef/cache/*"` ?
[2012-09-28 21:19:08 -0400] yfeldblum: wamilton, don't know
[2012-09-28 21:28:34 -0400] PapaSierra: yfeldblum my internet connection keeps dropping out. here's the metadata file: http://www.hastebin.com/madobahuje.hs
[2012-09-28 21:28:58 -0400] _0x783czar: Is there a way to trigger a chef-run with knife using key authentication instead of passwords?
[2012-09-28 21:31:31 -0400] yfeldblum: PapaSierra, does it help?
[2012-09-28 21:31:59 -0400] yfeldblum: _0x783czar, yes, your keys in ~/.ssh will get loaded
[2012-09-28 21:32:33 -0400] PapaSierra: yfeldblum sadly no. 100% the same error as before
[2012-09-28 21:33:35 -0400] PapaSierra: any other guesses? i might try destroy the vm completely and start over
[2012-09-28 21:33:37 -0400] _0x783czar: yfeldblum: so I can just omit the -p flag and if my public key is in the authorized_keys file of the user I pass to knife, it should work?
[2012-09-28 21:33:39 -0400] yfeldblum: PapaSierra, heh i'm not sure then
[2012-09-28 21:34:18 -0400] yfeldblum: _0x783czar, right
[2012-09-28 21:34:23 -0400] _0x783czar: awesome
[2012-09-28 21:34:25 -0400] PapaSierra: bizarre isn't it? it's looking like it's a bug. i can't see what else it could be
[2012-09-28 21:35:20 -0400] PapaSierra: chef is basically saying "i can't find this file at /x/y/z" and linux is saying, "there is a file at /x/y/z". both those stmts can't be true at the same time.
[2012-09-28 21:36:05 -0400] PapaSierra: i'm the unluckiest noob ever. every new tool i come across i hit an edge case on day 1 ;)
[2012-09-28 21:36:06 -0400] yfeldblum: PapaSierra, right
[2012-09-28 21:36:18 -0400] yfeldblum: PapaSierra, well chef itself is a new tool
[2012-09-28 21:36:30 -0400] PapaSierra: i mean new to me
[2012-09-28 21:37:40 -0400] jtimberman: "new"? It's been out three years :).
[2012-09-28 21:37:51 -0400] yfeldblum: PapaSierra, right but i mean chef itself is still in its early days so there may be these edge cases, or maybe it's just a typo
[2012-09-28 21:38:20 -0400] jtimberman: yfeldblum: i believe in the documentation revision effort that will be completed. for now there are other places where the resoruce collection is mentioned but not defined, and i'm not able to delve into that right now.
[2012-09-28 21:38:54 -0400] aslan: coderanger: i just setup my chef 0.10 server. every thing works fine
[2012-09-28 21:39:07 -0400] yfeldblum: jtimberman, hah i'm not the one who's worried since i'm already quite familiar with the chef code and how it works :D
[2012-09-28 21:39:15 -0400] PapaSierra: i wish it was a typo! i'd love to have that "doh i'm an idiot" moment any time now
[2012-09-28 21:39:16 -0400] aslan: coderanger: i tested it with a chef 09 client and interestingly it works fine.
[2012-09-28 21:39:29 -0400] coderanger: aslan: Yep, server is backwards compatible, client isn't
[2012-09-28 21:39:42 -0400] coderanger: 0.9 client works on a 0.10 server, not vice versa
[2012-09-28 21:39:55 -0400] aslan: coderanger: so i dont have to necessarly have client .10 right?
[2012-09-28 21:40:11 -0400] aslan: coderanger: what do i lose by not having client 0.10?
[2012-09-28 21:40:17 -0400] coderanger: Environments support
[2012-09-28 21:40:33 -0400] coderanger: The node will be reset to _default on every run
[2012-09-28 21:40:56 -0400] aslan: coderanger: i have one server per environment so that is not a problem :)
[2012-09-28 21:42:08 -0400] xmltok: did 10.14 change the search query api at all? i am seeing pychef do merb : chef-server (api) : worker (port 4000) ~ Params: {"start"=>"0", "action"=>"show", "q"=>"*:*", "id"=>"applications", "controller"=>"search", "rows"=>"1000"}
[2012-09-28 21:42:08 -0400] xmltok: but when i use the browse I see it using "type"=>"applications", not id
[2012-09-28 21:42:22 -0400] xmltok: and its throwing a 404
[2012-09-28 21:42:24 -0400] aslan: coderanger: thanks for responding. by the way is there a reference for chef_repo setup best practices ?
[2012-09-28 21:42:52 -0400] coderanger: aslan: Not really, community standards are still evolving on that, recommendation right now is to use either librarian or berkshelf
[2012-09-28 21:43:18 -0400] aslan: coderanger: cool . thanks :)
[2012-09-28 21:45:10 -0400] miah: if you use a single chef_repo, have fun dealing with upstream changes in your vendored and possibly modified cookbooks
[2012-09-28 21:45:22 -0400] miah: if you <3 git merge. have fun using a single repo.
[2012-09-28 21:47:15 -0400] aslan: miah: up until now i had one chef repo. it was also the single place that 2-3 developers updated recipes. now the group has grown and i rather have them each work on their own repo.
[2012-09-28 21:48:18 -0400] PapaSierra: jtimberman yfeldblum i appreciate you're too busy for this. i'm sad that the template override did not work. it would have been a nice idea. should i just get chef to copy/paste my file into the destination dir? nasty, but it'll work.
[2012-09-28 21:48:19 -0400] jtimberman: miah: I use a single chef-repo with cookbooks dir and knife cookbook site install just fine ;)
[2012-09-28 21:49:09 -0400] jtimberman: PapaSierra: you mean using the resources() bit didn't work, or putting your template in the templates/default dir didn't
[2012-09-28 21:49:50 -0400] PapaSierra: jtimberman the resources() part appeared to work. but i got this error (see bottom third of paste) http://www.hastebin.com/raw/hebeyipano
[2012-09-28 21:51:08 -0400] PapaSierra: it appears to be telling me "file not found: /templates/default/default-site.erb in the cookbook called 'project'". it *is* there though
[2012-09-28 21:52:27 -0400] yfeldblum: jtimberman, silly
[2012-09-28 22:06:55 -0400] PapaSierra: ok well it's late so i'm going to head home. thanks so much for your help. i've learned a lot. i'm disappointed i couldn't get this working but i think i'll just try a different approach tomorrow
[2012-09-28 22:10:14 -0400] PapaSierra: jtimberman yfeldblum LOL!! even IRC has a bug tonight! i've just posted a message as "Farkie". i was logged in as someone else, what's going on! maybe the mayans were right about 2012
[2012-09-28 22:10:59 -0400] yfeldblum: PapaSierra, heh
[2012-09-28 22:11:37 -0400] PapaSierra: there's someone in #nginx who's pissed with me for becoming him ;)
[2012-09-28 22:12:18 -0400] PapaSierra: anyway, this message of appreciation was for you: ok well it's late so i'm going to head home. thanks so much for your help. i've learned a lot. i'm disappointed i couldn't get this working but i think i'll just try a different approach tomorrow
[2012-09-28 22:12:19 -0400] PapaSierra: thanks so much :)
[2012-09-28 22:48:31 -0400] justinlilly: I find myself repeating this a lot: https://gist.github.com/7fdc4ff2213cfd11f29e  -- does anyone have suggestions for how I can combine that into one thing?
[2012-09-28 22:49:09 -0400] justinlilly: I basically want a function, but not sure how exactly to do that in erb land.
[2012-09-28 22:50:12 -0400] bluepojo: justinlilly: make it a function in a library
[2012-09-28 22:50:23 -0400] bluepojo: then use the function to pass a variable to the template
[2012-09-28 22:50:30 -0400] flaccid_: guess it depends how much you want to obscure your template
[2012-09-28 22:51:06 -0400] justinlilly: Ideally, I'd have something like <% gen_service(name, cmd, node_list) %>
[2012-09-28 22:51:49 -0400] justinlilly: if I define a function in server.rb (which is what generates this erb thing).. that function will just be available in my template?
[2012-09-28 22:52:03 -0400] justinlilly: Any pointers to a function that outputs ERB stuff like that?
[2012-09-28 22:53:19 -0400] flaccid_: justinlilly: did you read what bluepojo said?
[2012-09-28 22:53:32 -0400] flaccid_: its a good practice to use variables in templates in general
[2012-09-28 22:54:07 -0400] justinlilly: so you're saying pass in foo_service => gen_service(...) ?
[2012-09-28 22:54:12 -0400] justinlilly: I suppose that works.
[2012-09-28 23:34:01 -0400] hopson: can anyone help me troubleshoot a knife plugin? I just installed knife-windows but the "knife winrm" subcommand isn't available
[2012-09-28 23:34:22 -0400] hopson: I'm already using knife ec2 successfully
[2012-09-28 23:37:25 -0400] jessicab: hopson: pretty sure the command is 'knife windows winrm'
[2012-09-28 23:38:06 -0400] jessicab: oh weird, guess im wrong http://wiki.opscode.com/display/chef/Knife+Windows+Bootstrap
[2012-09-28 23:39:09 -0400] jessicab: hopson: yea.. knife winrm works fine for me, perhaps it was just installed to the wrong gems or something?
[2012-09-28 23:39:38 -0400] hopson: I am using RVM, and I see it in "gem list"
[2012-09-28 23:41:29 -0400] jessicab: hopson: is it possible that youre using omnibus? you might need to install it to the embedded gems. this page has a bit more info too - http://wiki.opscode.com/display/chef/Launch+Cloud+Instances+with+Knife#LaunchCloudInstanceswithKnife-CloudSubcommands
[2012-09-28 23:42:23 -0400] hopson: not familiar with omnibus; I'm not actually using ec2 windows instances, that was just an example of one plugin that worked out of the box
[2012-09-28 23:42:33 -0400] hopson: but looking at that page
[2012-09-28 23:43:01 -0400] spox: hopson: if you just type: knife
[2012-09-28 23:43:08 -0400] spox: do you see windows commands listed in the output?
[2012-09-28 23:43:17 -0400] hopson: I do not
[2012-09-28 23:44:00 -0400] spox: are you on windows?
[2012-09-28 23:44:10 -0400] hopson: no, OS x
[2012-09-28 23:44:12 -0400] hopson: *X
[2012-09-28 23:44:38 -0400] spox: which knife
[2012-09-28 23:44:44 -0400] spox: does that give you the knife in your rvm?
[2012-09-28 23:45:08 -0400] hopson: yes, ~/.rvm/gems/ruby-1.9.3-p194@cookbooks/bin/knife
[2012-09-28 23:45:10 -0400] jessicab: hopson: yea, basically all the page says is that if you run 'ls -l $(which knife)' and its a smylink to /opt it means youd need to install to the embedded gems.. but it should work the same as knife-ec2, so it sounds like thats probably not your issue
[2012-09-28 23:45:24 -0400] xmltok: anyone familiar with test-kitchen and librarian? i keep getting this error, the cookbook (stock java from opscode) doesnt have any dependencies
[2012-09-28 23:45:24 -0400] xmltok: Assembling required cookbooks at [/home/sitebuild/jenkins/workspace/{chef}-java/test/kitchen/.kitchen/cookbooks].
[2012-09-28 23:45:30 -0400] xmltok: > /home/sitebuild/.rvm/gems/ruby-1.9.3-p194/gems/librarian-0.0.24/lib/librarian/lockfile/parser.rb:59:in `parse': Expected DEPENDENCIES topic! (StandardError)
[2012-09-28 23:46:24 -0400] spox: hopson: to be sure, `knife | grep win`
[2012-09-28 23:46:28 -0400] spox: that returns nothing?
[2012-09-28 23:46:59 -0400] hopson: spox: correct, nothing
[2012-09-28 23:47:11 -0400] spox: which gem
[2012-09-28 23:47:15 -0400] hopson: gem list|grep win -> em-winrm (0.5.4), knife-windows (0.5.10), winrm (1.1.2)
[2012-09-28 23:47:15 -0400] spox: is that in your rvm?
[2012-09-28 23:47:31 -0400] hopson: yes, correct gem command
[2012-09-28 23:47:39 -0400] spox: well, wth
[2012-09-28 23:47:50 -0400] hopson: yeah, pretty strange
[2012-09-28 23:47:59 -0400] xmltok: my problem is the {}'s in my directory
[2012-09-28 23:50:13 -0400] spox: hrm, hopson maybe check in your .rvm and see if knife-windows is installed in the correct ruby version?
[2012-09-28 23:50:16 -0400] spox: it's very odd
[2012-09-28 23:53:20 -0400] hopson: spox: thanks, if I'm understanding correctly, the gem's lib/chef/knife/ directory should be what is searched for plugins by knife, right?
[2012-09-28 23:53:52 -0400] hopson: I have ~/.rvm/gems/ruby-1.9.3-p194@cookbooks/gems/knife-windows-0.5.10/lib/chef/knife/winrm.rb and it's definitely a knife plugin
[2012-09-28 23:54:32 -0400] spox: hopson: that's correct and that's really weird
[2012-09-28 23:55:44 -0400] hopson: is there any way to get some more verbose output from knife to see what it's searching/missing?
