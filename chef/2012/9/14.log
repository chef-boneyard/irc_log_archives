[2012-09-14 00:02:01 -0400] gyre008: reset, you still here ?
[2012-09-14 00:04:23 -0400] foom_: hello! Is it possible to set a timeout with git on chef?
[2012-09-14 00:05:00 -0400] ptrstr: srleod: i dont think that's enough
[2012-09-14 00:05:14 -0400] ptrstr: srlead: see https://github.com/opscode-cookbooks/supervisor under examples
[2012-09-14 00:06:03 -0400] foom_: right now, the git command I'm running is timing out before the repo finishes cloning :(
[2012-09-14 00:09:15 -0400] srleod: ptrstr, well it has been working fine doing all the right things, but i appreciate the pointer for how to do it ... better ... i guess.
[2012-09-14 00:13:51 -0400] BryanWB: hey java cookbook users, do u think that the openjdk and oracle jvm recipes should run update-alternatives for all the commands in jvm/bin/* ?
[2012-09-14 00:16:44 -0400] ptrstr: BryanWB: i got tired of it breaking
[2012-09-14 00:16:51 -0400] srleod: ptrstr --  now it's working with :restart, "supervisor_service[imgmuck]" -- thanks a ton!!
[2012-09-14 00:17:14 -0400] BryanWB: ptrstr, cuz of oracle downloads?
[2012-09-14 00:18:22 -0400] ptrstr: srleod: good to hear
[2012-09-14 00:18:52 -0400] ptrstr: BryanWB: i disabled update-alternatives
[2012-09-14 00:19:32 -0400] miketheman: BryanWB: did oracle ever re-enable downloads of their rpms?
[2012-09-14 00:19:39 -0400] BryanWB: miketheman, nope
[2012-09-14 00:19:53 -0400] BryanWB: miketheman, but i have a pull request in that uses a cookie to download directly
[2012-09-14 00:20:06 -0400] miketheman: BryanWB: you cheater. :)
[2012-09-14 00:20:31 -0400] BryanWB: miketheman, there is an attribute to the cookbook "accept_onerous_download_terms" ;)
[2012-09-14 00:20:37 -0400] ptrstr: BryanWB: and i use openjdk where possible
[2012-09-14 00:21:08 -0400] miketheman: BryanWB: well, at least the term is descriptive of the reality.
[2012-09-14 00:23:11 -0400] rocket: BryanWB: I have a patch that allows it to work with rpm.bin files .. it also disables the alternatives
[2012-09-14 00:25:08 -0400] BryanWB: rocket, hmm, u disabled update-alternatives here ? https://github.com/bryanwb/java/blob/master/providers/ark.rb#L161
[2012-09-14 00:25:30 -0400] BryanWB: did that part break for u?
[2012-09-14 00:27:03 -0400] rocket: I did a check at line 142 if the file was rpm.bin skip that whole section
[2012-09-14 00:28:17 -0400] rocket:   case tarball_name
[2012-09-14 00:28:18 -0400] rocket:   when /!^.*\rpm.bin/
[2012-09-14 00:28:19 -0400] rocket:     #update-alternatives
[2012-09-14 00:28:55 -0400] rocket: it seems to work for me currently
[2012-09-14 00:30:09 -0400] rocket: I also had to skip the section at line 107
[2012-09-14 00:30:32 -0400] rocket: because an rpm install doesnt place anything in the tmpdir
[2012-09-14 00:44:46 -0400] mhalligan: can someone help me with something I'm probably being really stupid about?
[2012-09-14 00:44:58 -0400] flaccid: no
[2012-09-14 00:45:12 -0400] mhalligan: I've got an encrypted data bag I can work with just fine in shef, but it doesn't seem to work in an actual recipe
[2012-09-14 00:45:13 -0400] flaccid: like what asking to asking?
[2012-09-14 00:45:28 -0400] flaccid: k, its a good idea to cite errors etc.
[2012-09-14 00:46:05 -0400] mhalligan: no thanks, I'll ask someone pleasant
[2012-09-14 00:46:29 -0400] flaccid: lol
[2012-09-14 00:46:43 -0400] flaccid: next hehe
[2012-09-14 00:48:34 -0400] Axsuul: How do you guys do a apt-get update.. using a cookbook?
[2012-09-14 00:55:46 -0400] flaccid: Axsuul: yeah there is a few around i think. i'm not really sure if thats the best practice, was kind of wondering myself as its not in apt cookbook
[2012-09-14 00:56:21 -0400] flaccid: as a result, i did a quick one here Axsuul https://github.com/flaccid/cookbooks/blob/master/cookbooks/system/recipes/upgrade_packages.rb
[2012-09-14 00:57:47 -0400] Axsuul: flaccid: cool thanks
[2012-09-14 00:57:57 -0400] Axsuul: flaccid: ah you keep everything in one repo?
[2012-09-14 00:59:57 -0400] yfeldblum: Axsuul, you can specify a version or version-constraint in your recipe, and then chef will try to transition to the right version if the wrong version is installed
[2012-09-14 01:01:22 -0400] flaccid: Axsuul: define everything
[2012-09-14 01:11:06 -0400] miah: herp herp herp
[2012-09-14 01:11:20 -0400] erikh: derp
[2012-09-14 01:11:32 -0400] erikh: miah: will you be at the github drinkup?
[2012-09-14 01:19:24 -0400] Axsuul: yfeldblum: thanks
[2012-09-14 01:19:30 -0400] Axsuul: flaccid: all your cookbooks =p
[2012-09-14 01:20:32 -0400] uncommitted: Just had a weird problem with 10.12 server change a variable in a data bag and it wouldn't change on the node.
[2012-09-14 01:20:47 -0400] Axsuul: So I want to have a role, called "app", however on a development environment I want it to install ruby per user install, but on a production environment I want it to install ruby per system install, is there any way to accomplish this within the same role?
[2012-09-14 01:20:49 -0400] uncommitted: update to 10.14.2, magically works
[2012-09-14 01:23:08 -0400] erikh: Axsuul: you could make your cookbook do one or the other depending on environment-specific normal metadata
[2012-09-14 01:23:25 -0400] erikh: really depends on how your environments are built out, though.
[2012-09-14 01:23:33 -0400] miah: erikh: yes
[2012-09-14 01:23:41 -0400] miah: i am going to the sfdevops thing for a moment
[2012-09-14 01:23:56 -0400] miah: and then i will head over to the drinking
[2012-09-14 01:24:03 -0400] erikh: cool! maybe we'll bump into each other.
[2012-09-14 01:24:24 -0400] hoover_damm: lol it's so weird having people go there
[2012-09-14 01:24:54 -0400] miah: awesome. i hope so =)
[2012-09-14 01:24:57 -0400] hoover_damm: someday
[2012-09-14 01:24:58 -0400] erikh: hoover_damm: you going too?
[2012-09-14 01:25:01 -0400] miah: i have a carrot in my hair, i wont be hard to miss!
[2012-09-14 01:25:05 -0400] hoover_damm: erikh, lol my client would love it
[2012-09-14 01:25:16 -0400] uncommitted: what's a sfdevops?
[2012-09-14 01:25:19 -0400] hoover_damm: anywho i'm gonna shut my mouth and move on
[2012-09-14 01:25:26 -0400] miah: http://www.meetup.com/San-Francisco-DevOps/events/80910852/
[2012-09-14 01:25:48 -0400] uncommitted: darn it, i'm wfh today
[2012-09-14 01:26:20 -0400] Axsuul: erikh: thanks
[2012-09-14 01:26:29 -0400] uncommitted: is that thirsty bear?
[2012-09-14 01:26:51 -0400] miah: tonight its at pivitol
[2012-09-14 01:27:35 -0400] uncommitted: well lookie there, good things come from chef bugs :)
[2012-09-14 01:30:36 -0400] flaccid: Axsuul: i have quite a few repositories and couple of github accounts. its going to change a bit in the future
[2012-09-14 01:31:09 -0400] miah: hrm
[2012-09-14 01:31:46 -0400] Axsuul: flaccid: to what?
[2012-09-14 01:31:54 -0400] miah: eh. i think i might miss out on this devops thing and just go to github drink. dinner is here and i have a bug to tackle
[2012-09-14 01:35:28 -0400] flaccid: Axsuul: probably a flaccid-cookbooks github account with repos per cookbooks
[2012-09-14 01:35:32 -0400] flaccid: -s
[2012-09-14 01:36:11 -0400] flaccid: then start submitting to community cookbooks site. wish devops was my job.
[2012-09-14 01:37:56 -0400] miketheman: flaccid: come and join the Rebels. :)
[2012-09-14 01:41:06 -0400] zts: k
[2012-09-14 01:43:41 -0400] flaccid: miketheman: who dat?
[2012-09-14 01:43:51 -0400] flaccid: in my country thats a bikie gang
[2012-09-14 01:43:53 -0400] miketheman: us devops-style people
[2012-09-14 01:48:13 -0400] flaccid: i do that style but its not my job at least not yet
[2012-09-14 02:20:53 -0400] miah: hack hack hack
[2012-09-14 02:23:11 -0400] miketheman: me too!
[2012-09-14 02:28:00 -0400] erratic1: same same same
[2012-09-14 02:28:17 -0400] erratic1: "well I better not show you how the lemonade is made"
[2012-09-14 02:28:21 -0400] erratic1: stuck in my head now
[2012-09-14 02:29:37 -0400] erikh: horse pop
[2012-09-14 02:29:42 -0400] erratic1: ya
[2012-09-14 02:29:43 -0400] erratic1: lol
[2012-09-14 02:41:53 -0400] hoover_damm: erratic1, I got some neighbors being stupid that can break that if you'd like
[2012-09-14 02:42:05 -0400] hoover_damm: erratic1, they'll gladly talk to you for hours nonstop
[2012-09-14 02:44:29 -0400] hoover_damm: erratic1, although then again i've met some adult pornstars who would say the same lol
[2012-09-14 02:46:59 -0400] erikh: as opposed to child pornstars
[2012-09-14 02:47:23 -0400] erikh: ok, yeah, that was too low
[2012-09-14 02:50:15 -0400] hoover_damm: erikh, there's a nice post in savage love the other day about a aunt and mother buying a 14 year old their first toy...
[2012-09-14 02:50:19 -0400] hoover_damm: erikh, just weird
[2012-09-14 02:51:32 -0400] erikh: hoover_damm: this is probably not suitable #chef chatter, even though I'm partly to blame for initiating it
[2012-09-14 02:52:07 -0400] flaccid: aka ot
[2012-09-14 02:57:31 -0400] hoover_damm: oh most definetly not suitable
[2012-09-14 02:58:39 -0400] zenspider: why in the fuck does http://www.opscode.com/ speak, and LOUDLY at that, at me on load? there isn't even a visible video playing.
[2012-09-14 02:58:55 -0400] zenspider: grrr
[2012-09-14 02:59:13 -0400] zenspider: hellishly annoying when you fire up safari and can't figure out why in the hell your laptop is yelling at you
[2012-09-14 03:00:19 -0400] hoover_damm: there we go... that's exactly what we needed
[2012-09-14 03:00:23 -0400] hoover_damm: thanks for breaking up the monotity zenspider
[2012-09-14 03:00:52 -0400] hoover_damm: err mononity
[2012-09-14 03:10:35 -0400] flaccid: zenspider: guess you could mail opscode asking that heh
[2012-09-14 05:09:10 -0400] psykidellic: I am trying to use the nginx cookbook which needs ohai. I am using a non root account to do my installation. Seems ohai is failing with: /etc/chef/ohai_plugins due to insufficient permissions.
[2012-09-14 05:41:56 -0400] psykidellic: Hmm, seems ohai is setup for root user. It now needs /var/chef and looking at the code, some of the permission are set to root which I dont want. Maybe its just easier to install from package manager and do the updates.
[2012-09-14 06:00:17 -0400] jessicab: psykidellic: you usually want to run chef with sudo or admin access.. lots of the resources depend on it
[2012-09-14 06:02:43 -0400] Axsuul: Is there any way to read a local file's contents with chef?
[2012-09-14 06:03:32 -0400] Axsuul: I'm trying to get the password that is stored in a database config file, which is in the same directory as my chef recipes
[2012-09-14 06:11:52 -0400] psykidellic: jessicab: Yeah, seems that is the case after doing some Googling. Since rvm is not supposed to be run as root (and on ec2) i dont have, to install system wide and do it correctly, I have to add the deployer user to rvm group and "log out" making the process not automated.
[2012-09-14 06:17:33 -0400] hoover_damm: psykidellic, rvmsudo
[2012-09-14 06:17:44 -0400] hoover_damm: psykidellic, no need to hurt yourself that badly
[2012-09-14 06:17:50 -0400] hoover_damm: psykidellic, run chef under rvmsudo
[2012-09-14 06:20:16 -0400] psykidellic: hoover_damm: Something like: https://gist.github.com/3720159 ?
[2012-09-14 06:20:56 -0400] psykidellic: "sudo bash -s stable" makes it system wide.
[2012-09-14 08:10:54 -0400] Axsuul: How do you guys add lines to .zshrc for example?
[2012-09-14 08:22:28 -0400] ranjibd: Axsuul, ideally you shoul templatize it .. the whole file
[2012-09-14 08:23:29 -0400] ranjibd: if you dont want ,, keep an execute resource with  echo "the line you want to add " >> .zshrc  , with a not_if "grep 'you line' .zshrc"
[2012-09-14 08:24:35 -0400] ranjibd: Axsuul, there are even better ways to do it,... using the fileedit library.,.
[2012-09-14 08:25:19 -0400] Mithrandir: I just check my zshrc out of git.
[2012-09-14 08:25:27 -0400] Mithrandir: together with all my other dotfiles
[2012-09-14 08:25:38 -0400] Axsuul: for example, the rbenv cookbook needs to add something to my zshrc
[2012-09-14 08:26:45 -0400] Mithrandir: then make /etc/zsh/zshrc source /etc/zsh/zshrc.d/* and have the rbenv cookbook drop a file there
[2012-09-14 08:28:00 -0400] Axsuul: Mithrandir: thanks
[2012-09-14 08:34:34 -0400] Axsuul: Mithrandir: is it conventional to make it /etc/zshrc.d/* instead?
[2012-09-14 08:34:44 -0400] Axsuul: Mithrandir: since theres already a /etc/profile.d
[2012-09-14 08:46:35 -0400] Mithrandir: Axsuul: dunno
[2012-09-14 08:53:18 -0400] Axsuul: Does chef provide a resource to check if a directory exists?
[2012-09-14 09:04:31 -0400] bilalcochin: Currently i am using puppet. i am plan to evaluate Chef. Anybody in the list Migrated to Chef from Puppet?
[2012-09-14 09:07:57 -0400] auduny_: Ran my old chef 0.10.6 ruby 1.8 vs the new omnibus ruby 1.9 chef 0.10.14
[2012-09-14 09:08:06 -0400] auduny_: 10.52user 4.29system 0:17.59elapsed 84%CPU (0avgtext+0avgdata 668512maxresident)k
[2012-09-14 09:08:07 -0400] auduny_: 0inputs+9424outputs (0major+241672minor)pagefaults 0swaps
[2012-09-14 09:08:07 -0400] auduny_: Chef omnibus
[2012-09-14 09:08:07 -0400] auduny_: 9.01user 2.02system 0:15.13elapsed 72%CPU (0avgtext+0avgdata 584000maxresident)k
[2012-09-14 09:08:07 -0400] auduny_: 192inputs+9488output
[2012-09-14 09:08:12 -0400] auduny_: Better.
[2012-09-14 09:08:49 -0400] auduny_: But still using 584MB of ram per run if I read that right.
[2012-09-14 09:09:03 -0400] auduny_: the chef client that is.
[2012-09-14 09:09:17 -0400] auduny_: Down from 668MB.
[2012-09-14 09:10:04 -0400] auduny_: Mithrandir: what does /usr/bin/time chef-client say for a typical run at your machines?
[2012-09-14 09:14:45 -0400] alex88: hi guys, i'm writing a custom cookbook, and in the metadata.rb i've added depends          "nginx" but installing that cookbook didn't give any warning or error..is that normal?
[2012-09-14 09:14:52 -0400] alex88: btw, using chef solo
[2012-09-14 09:15:20 -0400] Mithrandir: auduny_: on the chef server: chef-client  9,91s user 5,02s system 63% cpu 23,564 total
[2012-09-14 09:15:36 -0400] Mithrandir: auduny_: on a firewall: real0m14.285s
[2012-09-14 09:16:04 -0400] auduny_: /usr/bin/time instead of time.
[2012-09-14 09:16:12 -0400] auduny_: 23 MB?
[2012-09-14 09:16:17 -0400] Mithrandir: I don't have /usr/bin/time
[2012-09-14 09:16:58 -0400] Mithrandir: actually, on the chef-server, I do
[2012-09-14 09:17:00 -0400] Mithrandir: let's see
[2012-09-14 09:17:19 -0400] auduny_: Something must be horrible wrong with my installation.
[2012-09-14 09:17:26 -0400] Mithrandir: 9.80user 4.68system 0:22.78elapsed 63%CPU (0avgtext+0avgdata 395888maxresident)k
[2012-09-14 09:17:26 -0400] Mithrandir: 8inputs+145744outputs (26major+647653minor)pagefaults 0swaps
[2012-09-14 09:17:31 -0400] auduny_: Or recipys.
[2012-09-14 09:17:36 -0400] auduny_: 395MB max resident.
[2012-09-14 09:17:39 -0400] Mithrandir: but that has a bunch of searches
[2012-09-14 09:17:55 -0400] auduny_: That's more in my league.
[2012-09-14 09:18:02 -0400] auduny_: Still 300 MB less. But anyway
[2012-09-14 09:18:38 -0400] auduny_: But on the chef-server it's only 23MB?
[2012-09-14 09:18:48 -0400] Mithrandir: on a staging app server: 6.53user 2.50system 0:46.70elapsed 19%CPU (0avgtext+0avgdata 192320maxresident)k
[2012-09-14 09:18:51 -0400] Mithrandir: 85360inputs+196152outputs (166major+610247minor)pagefaults 0swaps
[2012-09-14 09:19:00 -0400] Mithrandir: on the chef server it's 23 seconds.
[2012-09-14 09:19:20 -0400] auduny_: I'm mostly looking at resident memory. Not time.
[2012-09-14 09:19:35 -0400] Mithrandir: time(1)'s tracking of used memory is a bit wonky, iirc.
[2012-09-14 09:19:51 -0400] auduny_: 193MB in the stageingserver..
[2012-09-14 09:20:09 -0400] auduny_: Mithrandir: How wonky?
[2012-09-14 09:20:45 -0400] Mithrandir: http://bugs.debian.org/cgi-bin/bugreport.cgi?bug=186448
[2012-09-14 09:21:42 -0400] auduny_: But that bug is that it reports zero resident isn't it.
[2012-09-14 09:22:15 -0400] bilalcochin: Currently i am using puppet. i am plan to evaluate Chef. Anybody in the list Migrated to Chef from Puppet?
[2012-09-14 09:25:32 -0400] ranjibd_: Axsuul, chef uses raw ruby .. you can use Dir.exists?() directly
[2012-09-14 09:25:49 -0400] ranjibd_: inside an only_if guarfd
[2012-09-14 09:26:01 -0400] ranjibd_: s/guarfd/guard/
[2012-09-14 09:31:04 -0400] Axsuul: ranjibd_: thanks
[2012-09-14 09:33:02 -0400] bilalcochin: What you think if migrate from puppet to chef?
[2012-09-14 09:33:45 -0400] auduny_: bilalcochin: Hi. Could you just for the sake of memory-analysis run /usr/bin/time <puppet-client>
[2012-09-14 09:33:48 -0400] ranjibd_: bilalcochin, Do It :-)
[2012-09-14 09:34:21 -0400] auduny_: I'm genuinly interested in the resident memory output (not the running time)
[2012-09-14 09:53:15 -0400] bilalcochin: In memory footprint puppet and chef have problems, But cfengine is better
[2012-09-14 10:13:31 -0400] alex88: i've created a role with 2 recipes, first recipe get some code via git, second recipe write a file using IO.read a file got by git, but on startup (chef solo) it hangs saying the file doesn't exist before running the git deploy recipe.. how can i fix that?
[2012-09-14 10:23:53 -0400] alex88: i'm trying to use this code http://pastie.org/private/e84ziig1nevbrafmvrxjtw but it seems that it checks for file existance on compile time and not when running the recipe
[2012-09-14 10:24:14 -0400] alex88: the file is deployed with another recipe, how can i do that?
[2012-09-14 10:29:48 -0400] alex88: i've changed the if to only_if but it seems that in compile time it still searchs for the file in the IO.read call
[2012-09-14 10:32:30 -0400] ranjibd_: alexbst, use ruby_block resource
[2012-09-14 10:32:55 -0400] alex88: ranjibd_: was that to me?
[2012-09-14 10:33:07 -0400] ranjibd_: alex88, raw ruby codes inside a recipes gets evaluated during the compilation phase .. (much before any recipe is run)
[2012-09-14 10:33:17 -0400] ranjibd_: alex88, yeah ... sorry
[2012-09-14 10:33:47 -0400] alex88: ranjibd_: oh ok, let me check how to copy a file
[2012-09-14 10:33:52 -0400] alex88: i'm a newbie to ruby
[2012-09-14 10:34:02 -0400] ranjibd_: so ideally you want ruby_block{ block{ ur code} , action :nothing}, and then notify this from your git checkout resource
[2012-09-14 10:34:14 -0400] ranjibd_: alex88, its easy
[2012-09-14 10:35:18 -0400] alex88: ranjibd_: well, i have to copy the file in nginx config dir, so i have to run this after nginx setup, not the in the git checkout resource which happens before
[2012-09-14 10:38:55 -0400] ranjibd_: then notify the resource block fron nginx conf file resource
[2012-09-14 10:40:22 -0400] alex88: ranjibd_: oh so it's run only when notified?
[2012-09-14 10:40:52 -0400] ranjibd_: yeah.. or find some other way to make it idempotent
[2012-09-14 10:41:17 -0400] ranjibd_: like not_if and only_if ... but then the code inside them will be evaluated in compile time..
[2012-09-14 10:42:02 -0400] alex88: ranjibd_: yeah i've already tried with only_if but it still search for the file
[2012-09-14 10:42:02 -0400] gyre007: aargh....guys is anyone getting this error on 12.04, chef 10.12 ? user[root] (gocardless::users line 15) had an error: Chef::Exceptions::MissingLibrary: You must have ruby-shadow installed for password support!
[2012-09-14 10:42:10 -0400] gyre007: is there any way around it ?
[2012-09-14 10:42:36 -0400] gyre007: I know there has been some discussion about this but I'm not sure how to work around it...would appreciate any hints!
[2012-09-14 10:42:59 -0400] Mithrandir: install ruby-shadow?
[2012-09-14 10:44:19 -0400] gyre007: Mithrandir, well I thought cehf has it installed as part of it embedded ruby
[2012-09-14 10:46:10 -0400] gyre007: ok so I DID install it...but im still getting that error
[2012-09-14 10:47:14 -0400] gyre007: ill try to install it into embedded chef
[2012-09-14 10:47:19 -0400] Mithrandir: you're using omnibus?
[2012-09-14 10:47:28 -0400] Mithrandir: if so, you must use the embedded gem
[2012-09-14 10:47:37 -0400] gyre007: that didnt help
[2012-09-14 10:48:00 -0400] gyre007: http://paste.ubuntu.com/1204513/
[2012-09-14 10:48:07 -0400] gyre007: it is installed in omnibus gem
[2012-09-14 10:48:14 -0400] gyre007: as omnibus gem :)
[2012-09-14 10:48:19 -0400] Mithrandir: hmm
[2012-09-14 10:48:22 -0400] Mithrandir: dunno then
[2012-09-14 10:48:23 -0400] gyre007: drwxr-xr-x  3 root root 4096 Sep 14 10:46 ruby-shadow-2.1.4
[2012-09-14 10:53:59 -0400] alex88: ranjibd_: sorry for the noobness, how do i notify a ruby_block? which action should i use?
[2012-09-14 11:03:18 -0400] alex88: someone else?
[2012-09-14 11:27:18 -0400] ranjibd_: alex88, notifies :run ,"ruby_block[name]"
[2012-09-14 11:27:38 -0400] ranjibd_: :action , "resource_type[resource_name]"
[2012-09-14 11:41:27 -0400] zts: http://wiki.opscode.com/display/chef/Resources#Resources-RubyBlock suggests the action is :create, weird as that sounds
[2012-09-14 12:03:20 -0400] alex88: ranjibd_: should it be declared before the notifies?
[2012-09-14 12:04:32 -0400] ranjibd_: no
[2012-09-14 12:05:04 -0400] ranjibd_: alex88, the old syntax , :resource=> required this.. i guess.not the "resource[name]" syntax
[2012-09-14 12:05:36 -0400] alex88: ranjibd_: it does, http://pastie.org/private/zek1ijkiydrkkm40lhh9qa
[2012-09-14 12:10:48 -0400] alex88: before it was giving me this error: Re-raising exception: NameError - ruby_block[copy_tiler_nginx_config] (project-tiler::nginx_configure line 20) had an error: NameError: Cannot find a resource for action_run on ubuntu version 12.04
[2012-09-14 12:54:42 -0400] Owainp: NameError: uninitialized constant Mixlib::ShellOut::Exceptions
[2012-09-14 12:54:58 -0400] Owainp: Newbie question : what does that error mean?
[2012-09-14 12:56:11 -0400] shillinm: good morning
[2012-09-14 12:56:50 -0400] shillinm: i'm looking for a way to check if a line exists in fstab, and if so, do nothing
[2012-09-14 12:58:03 -0400] hugespoon: can probably just do a not_if "grep blabblah /etc/fstab" in your execute or whatever block
[2012-09-14 12:59:10 -0400] shillinm: like this?  http://pastebin.com/CHpfPs2L
[2012-09-14 13:03:41 -0400] jwitrick: Anyone have any good examples of abstracting out a begin/rescue block for data bags? That way I dont have to have the same code again and again.
[2012-09-14 13:04:08 -0400] forestbird: how do I use a recipe with "knife exec" ?
[2012-09-14 13:05:24 -0400] cwj: shillinm: i know this doesn't directly address your question, but there is a mount resource which handles mounting file systems
[2012-09-14 13:07:44 -0400] cwj: http://wiki.opscode.com/display/chef/Resources#Resources-Mount
[2012-09-14 13:07:46 -0400] shillinm: right but does it mount swap partitions the same way, and make sure they are enabled?
[2012-09-14 13:08:33 -0400] cwj: https://github.com/cwjohnston/chef-swap/blob/master/providers/file.rb#L34
[2012-09-14 13:08:37 -0400] shillinm: I dont particularly care if its in fstab (none of my other FS mounts are)
[2012-09-14 13:09:19 -0400] cwj: that cookbook could be pretty easily improved to do swap partitions
[2012-09-14 13:09:32 -0400] cwj: maybe someone else has written one that does
[2012-09-14 13:09:44 -0400] shillinm: yeah, thats a good start, thanks
[2012-09-14 13:30:47 -0400] mgalkiewicz: hi guys I would like to speed up server reconfiguration by using new option in chef client "--override-runlist". I could specify only necessary recipes and run them but here comes the main problem. In chef node attributes all roles and recipes which wasnt used in this chef-client run are deleted which breaks all my searches in recipes which used attributes roles and recipes.
[2012-09-14 13:31:35 -0400] mgalkiewicz: is it desired behaviour or I should report it as a bug?
[2012-09-14 13:40:15 -0400] ssd7: Ohai Chefs
[2012-09-14 13:42:26 -0400] miketheman: Ohai back at ya
[2012-09-14 13:42:59 -0400] yfeldblum: mgalkiewicz, why would doing that be faster?
[2012-09-14 13:43:24 -0400] yfeldblum: mgalkiewicz, the fact that not running the full chef run would be faster sounds like a bug in your recipes to me
[2012-09-14 13:45:15 -0400] mgalkiewicz: yfeldblum: well it does not have to check so many resources so it is faster
[2012-09-14 13:45:44 -0400] yfeldblum: mgalkiewicz, how many resources is it checking?
[2012-09-14 13:46:19 -0400] mgalkiewicz: yfeldblum: the server have many roles including openstack cloud controller, http front end, etc
[2012-09-14 13:46:44 -0400] mgalkiewicz: is it possible to check it somewhere or I should just count it manually?
[2012-09-14 13:49:13 -0400] mgalkiewicz: on my staging server which does almost everything chef-client which does nothing (just checking only and not ifs) need around a minute to pass
[2012-09-14 13:50:01 -0400] mgalkiewicz: there are many services, templates and other stuff to set but almost everywhere are not and only_ifs
[2012-09-14 13:54:06 -0400] specialsauce: ohai chefs. At the moment my environment attributes are stored as JSON files as giant hashes. I've had a request to port them into attribute lists similar in layout to the "attributes" files in each cookbook. Is this possible?
[2012-09-14 14:03:12 -0400] yfeldblum: mgalkiewicz, how long does it take?
[2012-09-14 14:03:52 -0400] mgalkiewicz: like I said around a minute
[2012-09-14 14:04:51 -0400] zts: mgalkiewicz: I'm not sure if that's expected behaviour, but I'd consider it undesirable.  Can't hurt to report it as a bug - worst that will happen is it is closed as "wontfix - expected behaviour"
[2012-09-14 14:05:24 -0400] zts: mgalkiewicz: but how fast would your run have to be for you to be satisfied?  A minute doesn't sound so bad to me...
[2012-09-14 14:06:10 -0400] yfeldblum: mgalkiewicz, what version of ruby is it?
[2012-09-14 14:07:45 -0400] mgalkiewicz: 1.9.3, one minute is quite long considering that I run chef if one of the vhosts in nginx/apache has changed
[2012-09-14 14:08:16 -0400] mgalkiewicz: and this is the only thing that will change or matter to me in this particular run and takes so many time
[2012-09-14 14:19:45 -0400] forestbird: anyone knows how to load a recipe with knife exec and do some things with it?
[2012-09-14 14:20:34 -0400] yfeldblum: forestbird, why?
[2012-09-14 14:20:36 -0400] miketheman: forestbird: that's a very broad, non-specific question.
[2012-09-14 14:20:50 -0400] yfeldblum: mgalkiewicz, and none of that is ruby/gems/chef bootup time?
[2012-09-14 14:22:10 -0400] forestbird: hmm, I'd like to remove users with the users cookbook via knife exec: https://github.com/opscode-cookbooks/users/blob/master/providers/manage.rb
[2012-09-14 14:22:52 -0400] forestbird: basically I'd like to execute the :remove action without requiring the user to have action:remove
[2012-09-14 14:23:46 -0400] mgalkiewicz: yfeldblum: this is the time reported by chef-client at the end of the run. If I run only some recipes it takes seconds not minutes.
[2012-09-14 14:24:01 -0400] forestbird: but i don't know how to load the users recipe with "knife exec"
[2012-09-14 14:30:49 -0400] BryanWB: ohai chefs
[2012-09-14 14:32:28 -0400] forestbird: so, how do I load a recipe so that I have the LWRP  available with "knife exec"?
[2012-09-14 14:32:33 -0400] forestbird: is that specific enough?
[2012-09-14 14:33:03 -0400] ssd7: forestbird: It would probably be easier to use shef than knife-exec
[2012-09-14 14:33:31 -0400] yfeldblum: forestbird, or ssh + userdel
[2012-09-14 14:34:21 -0400] yfeldblum: mgalkiewicz, so what's taking so long?
[2012-09-14 14:35:07 -0400] mgalkiewicz: I guess that checking all resources whether they should be running or not
[2012-09-14 14:35:18 -0400] forestbird: ssd7: ok, maybe shef is what i'm looking for
[2012-09-14 14:35:19 -0400] ank: forestbird: unless you ran shef on the node itself I don't see how knife exec would remove the users like you want
[2012-09-14 14:51:48 -0400] mstyne: good morning chefs
[2012-09-14 14:52:13 -0400] mstyne: i have a hopefully softball question for anyone who hasn't had coffee yet
[2012-09-14 14:52:32 -0400] mstyne: is it possible to use attributes set in a ruby_block later on in the same recipe
[2012-09-14 14:52:46 -0400] mstyne: or does that not work due to compilation / excution phase madness
[2012-09-14 14:52:55 -0400] mstyne: execution, even
[2012-09-14 14:53:19 -0400] mstyne: or is there a special trick to it
[2012-09-14 14:54:27 -0400] mstyne: cliff's notes, i'm having a ruby_block parse a configuration file on the host, and I want to use the values determined by that ruby_block immediately later on in the same recipe
[2012-09-14 14:57:20 -0400] ssd7: mstyne: Definitely will want to look out for compiliation/converge phase differences.  Exact details depends on how/when you will be using the attributes.  Is the config file in question available at the beginning of the run or is it managed by Chef?
[2012-09-14 14:57:47 -0400] mstyne: ssd7: fortunately it's available prior to the start of the run
[2012-09-14 14:58:05 -0400] mstyne: should I be using something other than a ruby_block to parse it?
[2012-09-14 14:59:21 -0400] mstyne: I may just have a fundemantal misunderstanding of when/how ruby_blocks are called / executed
[2012-09-14 15:02:09 -0400] mstyne: full disclosure: the configuration file stores MySQL credentials which I want to use for creating a backup
[2012-09-14 15:02:18 -0400] mstyne: I realize I could probably store the creds in the node
[2012-09-14 15:02:22 -0400] mstyne: but I'd prefer not to
[2012-09-14 15:02:36 -0400] ssd7: mstyne: ruby_block resources are executed during the converge phase with the other resources
[2012-09-14 15:02:40 -0400] mstyne: actually by setting an attribute I /am/ storing them in the node
[2012-09-14 15:02:41 -0400] mstyne: heh
[2012-09-14 15:02:47 -0400] yfeldblum: mgalkiewicz, i would start with trying to find what's taking so long and why
[2012-09-14 15:03:29 -0400] ssd7: mstyne: Since it is available at the beginning you can just do it during the compile phase and be safe, but I would actually look into perhaps using encrypted databags or something similar
[2012-09-14 15:04:09 -0400] yfeldblum: mstyne, i think you have a fundamental misunderstanding of the nature and purpose of the "compile/execute" split :P
[2012-09-14 15:04:32 -0400] mstyne: yfeldblum: I don't much care for it
[2012-09-14 15:04:36 -0400] mstyne: but that's life
[2012-09-14 15:05:29 -0400] mstyne: ssd7: well, I suppose I must be doing something wrong because the attributes are empty when I go to use them
[2012-09-14 15:05:56 -0400] mstyne: i'm assuming this is because they're empty during the compile phase
[2012-09-14 15:06:00 -0400] yfeldblum: mstyne, the whole idea is that you start will the full knowledge of what the final system shall look like, and then after you've got the full knowledge up-front, that's when you start changing the system to bring it into line with that knowledge
[2012-09-14 15:06:49 -0400] yfeldblum: mstyne, so you want the recipe to know what the mysql credentials shall be, and then chef can go and write the config file, and then it can also go and write the backup script
[2012-09-14 15:07:50 -0400] mstyne: yfeldblum: understood. so if I want to give chef the full knowledge of the contents of a configuration file
[2012-09-14 15:07:56 -0400] mstyne: is there a 'right way' to do that?
[2012-09-14 15:08:27 -0400] yfeldblum: mstyne, yes, by not doing that - by instead giving chef the knowledge of what important info should be going into the config file
[2012-09-14 15:08:36 -0400] mstyne: well, rats.
[2012-09-14 15:08:59 -0400] mstyne: as ssd7 mentioned I think I see encrypted databags in my future
[2012-09-14 15:09:28 -0400] yfeldblum: mstyne, why?
[2012-09-14 15:09:43 -0400] mstyne: well, I don't really want these credentials floating around in the node definition
[2012-09-14 15:09:49 -0400] mstyne: in the clear
[2012-09-14 15:09:59 -0400] mstyne: if I can avoid it, anyway
[2012-09-14 15:10:28 -0400] yfeldblum: mstyne, why not?
[2012-09-14 15:11:40 -0400] mstyne: security?
[2012-09-14 15:11:46 -0400] yfeldblum: mstyne, of course keeping creds a secret is one way to control access, but of course there are multiple ways to control access
[2012-09-14 15:11:55 -0400] yfeldblum: mstyne, e.g. w/ iptables
[2012-09-14 15:12:08 -0400] yfeldblum: mstyne, or by having the db listen only on a LAN iface
[2012-09-14 15:12:31 -0400] mstyne: of course
[2012-09-14 15:13:03 -0400] yfeldblum: mstyne, and of course you can do a combination; but everything is a tradeoff
[2012-09-14 15:13:33 -0400] mstyne: I suppose I had hoped I could just read the configuration details from the file on the host, and then use them
[2012-09-14 15:13:39 -0400] mstyne: *hopes dashed*
[2012-09-14 15:13:56 -0400] mstyne: Need to get into the mentality that everything needs to be known upfront
[2012-09-14 15:14:05 -0400] mstyne: which I suppose is a good mantra to have when dealing with chef
[2012-09-14 15:15:29 -0400] mstyne: yfeldblum, ssd7 appreciate the assistance
[2012-09-14 15:15:49 -0400] mstyne: i'll meditate on this a bit and hopefully come up with something that works
[2012-09-14 15:16:47 -0400] yfeldblum: mstyne, exactly - not saying that's the Right Way to do it always, but if you want to use chef, then chef expects you to be doing it that way, and if you want to be doing something else with chef, you will run into the problems that you were describing above
[2012-09-14 15:32:26 -0400] trevis_: http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server I think you should update it to use knife-hacks as knife-scripts is deprecated :-)
[2012-09-14 15:57:05 -0400] jhayden: has anyone seen this behavior
[2012-09-14 15:57:16 -0400] jhayden: I upload a cookbook via knife
[2012-09-14 15:57:24 -0400] jhayden: web-ui shows it there
[2012-09-14 15:57:35 -0400] jhayden: when I click on the version number
[2012-09-14 15:57:41 -0400] jhayden: I get a 404 not found
[2012-09-14 16:04:45 -0400] luckymike: jkyle?
[2012-09-14 16:22:36 -0400] BryanWB: btm_, fyi, i pushed a fix for COOK-1657 (maven cookbook) and it also fixes COOK-1337, what is the best way to indicate that it fixes both?
[2012-09-14 16:22:49 -0400] BryanWB: put both ticket #'s in the  commit msg?
[2012-09-14 16:24:26 -0400] btm_: BryanWB: put one in, and in the ticket close it fixed and say it fixed the other one. add a link (. key, link, relates to, other ticket) as well. that way if you end up at the ticket you still have a  patch to the code.
[2012-09-14 16:26:17 -0400] BryanWB: btm_, is there a special syntax that I need to use ?
[2012-09-14 16:27:10 -0400] BryanWB: done
[2012-09-14 16:32:00 -0400] jhayden_: Can someone tell me if chef server stores cookbooks and recipes in the couch FB?
[2012-09-14 16:32:24 -0400] btm_: jhayden_: FB?
[2012-09-14 16:32:40 -0400] jhayden_: I am trying to track down a spurious 404 error
[2012-09-14 16:32:49 -0400] btm_: BryanWB: no real special syntax, just make sure someone can follow the bread crumps no matter where they begin.
[2012-09-14 16:32:52 -0400] jhayden_: Db
[2012-09-14 16:33:05 -0400] jhayden_: Damn auto correct
[2012-09-14 16:33:10 -0400] BryanWB: btm_, ok, done
[2012-09-14 16:33:16 -0400] btm_: jhayden_: cookbooks are stored on disk in a checksum file, with couch storing the checksum.
[2012-09-14 16:46:21 -0400] BryanWB: garhh test-kitchen is so alpha
[2012-09-14 16:55:03 -0400] BryanWB: is there any way to run `bundle exec librarian-chef update` within  mycookbook/test/kitchen/.kitchen/ ?
[2012-09-14 16:56:24 -0400] BryanWB: i just get a ton of permission denied errors
[2012-09-14 17:07:31 -0400] awgross|flashman: anyone seeing issues with chef 10.10/12 that gem_package action :upgrade
[2012-09-14 17:07:39 -0400] awgross|flashman: will never actually upgrade the gem?
[2012-09-14 17:08:34 -0400] awgross|flashman: https://gist.github.com/3723287
[2012-09-14 17:09:03 -0400] awgross|flashman: the newest version is 1.6.7.1, it had 1.6.5 and says there are no update candidates
[2012-09-14 17:09:24 -0400] awgross|flashman: attempting to find anything in the jira
[2012-09-14 17:10:54 -0400] luckymike: anyone from opscode, I'm getting a bunch of "FATAL: OpenSSL::Cipher::CipherError: wrong final block length" errors with encrypted data bags
[2012-09-14 17:11:21 -0400] luckymike: this sounds like an error on the opscode platform: http://tickets.opscode.com/browse/CHEF-2255
[2012-09-14 17:12:19 -0400] miketheman: luckymike: did you also review http://tickets.opscode.com/browse/CHEF-3288
[2012-09-14 17:13:12 -0400] erikh: hello cooks
[2012-09-14 17:14:24 -0400] BryanWB: yo erikh!
[2012-09-14 17:14:44 -0400] erikh: hey hey, it was nice meeting you last night!
[2012-09-14 17:14:46 -0400] luckymike: miketheman: did not, but the behavior I'm seeing is failure with 10.14 and success with 10.12
[2012-09-14 17:16:21 -0400] BryanWB: erikh likewise!
[2012-09-14 17:17:54 -0400] jhayden: I found the answer to my earlier question about spurious 404's while trying to look at cookbooks in the web-ui
[2012-09-14 17:17:58 -0400] jhayden: Recap
[2012-09-14 17:18:15 -0400] jhayden: I uploaded an was cookbook with knife
[2012-09-14 17:18:24 -0400] jhayden: the web-ui shows it
[2012-09-14 17:18:40 -0400] jhayden: when I click on the version number I got a 404
[2012-09-14 17:19:29 -0400] jhayden: The problem was I has named the cookbook aws-versionNumber
[2012-09-14 17:19:37 -0400] gyre007: any known reason why would chef-client died if run as daemon ?...just found out that bunch of our servers had chef-client not running ...
[2012-09-14 17:19:42 -0400] gyre007: where would it log ?
[2012-09-14 17:19:56 -0400] jhayden: the name of the cookbook needed to be was alone
[2012-09-14 17:20:11 -0400] jhayden: aws
[2012-09-14 17:20:30 -0400] jhayden: not sure if this is expected behavior
[2012-09-14 17:21:31 -0400] j|: gyre007: I'm not sure, but I use the init-bluepill style in the chef-client cookbook to make sure it runs regularly.
[2012-09-14 17:22:22 -0400] j|: gyre007: the log should be in /var/cache/chef/failed-run-<something or other>
[2012-09-14 17:25:17 -0400] jtimberman: BryanWB: you're in SF?
[2012-09-14 17:25:23 -0400] BryanWB: jtimberman, y
[2012-09-14 17:25:30 -0400] BryanWB: jtimberman, u?
[2012-09-14 17:29:42 -0400] jtimberman: BryanWB: i'm rarely in SF
[2012-09-14 17:30:32 -0400] BryanWB: jtimberman, since u r around, how can i update the Cheffile.lock inside   mycookbook/test/kitchen/.kitchen/ ?
[2012-09-14 17:41:25 -0400] jtimberman: BryanWB: i think the cheffile is autogenerated
[2012-09-14 17:41:41 -0400] jtimberman: i don't know much about the underlying bits for that i'm afraid
[2012-09-14 17:41:51 -0400] BryanWB: jtimberman, argh
[2012-09-14 17:42:31 -0400] chip-: Cheffile.lock is auto-generated from cheffile when you run librarian-chef install.
[2012-09-14 17:42:39 -0400] erikh: meh, just chattr +i it
[2012-09-14 17:44:48 -0400] BryanWB: jtimberman, argh, who is maintaining those underlying bits?
[2012-09-14 17:48:11 -0400] BryanWB: chip-, but there is another layer of abstraction of top librarian in this case that test-kitchen adds
[2012-09-14 17:48:26 -0400] BryanWB: chip-, i already tried what u suggest w/out luck
[2012-09-14 17:51:30 -0400] trevis_: I'm configuring the chef_handler (with the simple email example at http://wiki.opscode.com/display/chef/Exception+and+Report+Handlers ) but I'm having a strange problem... when chef runs correctly the handler and the mail is sent correctly, when the chef fails (I've added a throw 'error' in a chef) the mail isn't sent and the chef client says: ERROR: Running exception handlers :-/
[2012-09-14 17:52:04 -0400] awgross|flashman: gyre007: what version of ruby and chef? I have had issues with segfaults on ruby 1.8.7 and chef 10.8 or less
[2012-09-14 17:56:48 -0400] awgross|flashman: trevis_: what does chef run with -l debug say
[2012-09-14 17:56:54 -0400] awgross|flashman: trevis_: and what about the stack trace
[2012-09-14 17:57:28 -0400] awgross|flashman: trevis_: sounds like a bug in the mail.rb or mail.erb files for error messages, prob a typo when trying to get the stack trace or error message for the template
[2012-09-14 17:57:59 -0400] trevis_: awgross|flashman: the stacktrace just says about that uncaught throw "wrrrr", but nothing about email.rb
[2012-09-14 17:59:30 -0400] trevis_: I've also changed email.rb removing all the pony&other stuff with a simple `touch /root/foo`, but it doesn't not run... the strange thing is that if chef doesn't fail email.rb is executed correctly and the email is sent, so I don't think it's a typo in the file itself
[2012-09-14 18:00:11 -0400] awgross|flashman: can you post a gist of the template and .rb files along with the block registering the handler?
[2012-09-14 18:00:35 -0400] trevis_: sure, 1 sec
[2012-09-14 18:03:59 -0400] trevis_: http://pastebin.com/iaQmrnSH
[2012-09-14 18:11:54 -0400] dissolved: Hi, I'm new to chef and opscode. I'm following along the Fast Start Guide (http://wiki.opscode.com/display/chef/Fast+Start+Guide), and it is unclear to me if Step 2 "Install Chef and Git" should be run locally, or on a node.
[2012-09-14 18:13:02 -0400] cheeseplus: dissolved: although it's easy to miss "We will be setting up the client node as both in this guide."
[2012-09-14 18:13:13 -0400] paulmooring: dissolved: locally, you'll install Chef (for knife) and git to make a functioning management workstation
[2012-09-14 18:13:32 -0400] paulmooring: also like cheeseplus said that will probably be your first node as well
[2012-09-14 18:13:33 -0400] cheeseplus: essentially you don't have to setup the workstation to also be a client
[2012-09-14 18:14:00 -0400] maxmanders: Using the user resource to add passwords fails in Chef-Solo on OSX because libshadow and shaddow.h are not available on OSX. Can I work around this or do I have to coneded that I can't set passwords when adding new users via Chef-Solo/OSX?
[2012-09-14 18:14:58 -0400] coderanger: miah: ftl is out \o/
[2012-09-14 18:15:01 -0400] dissolved: Thanks cheeseplus & paulmooring
[2012-09-14 18:15:30 -0400] cheeseplus: dissolved: np, had the same confusion when I started
[2012-09-14 18:29:10 -0400] miah: sup
[2012-09-14 18:29:25 -0400] miah: coderanger: huh?
[2012-09-14 18:29:37 -0400] coderanger: miah: http://bit.ly/O3xH0Z
[2012-09-14 18:29:37 -0400] miah: oh
[2012-09-14 18:29:47 -0400] coderanger: Seems like your kind of thang
[2012-09-14 18:29:48 -0400] miah: thanks for the reminder =)
[2012-09-14 18:29:58 -0400] miah: yes. i played a really early alpha of it. so i want to see how it is now
[2012-09-14 18:30:12 -0400] miah: last time i played it, i died within 5 minutes
[2012-09-14 18:30:31 -0400] miah: because the enemy ai was BRUTAL
[2012-09-14 18:32:07 -0400] trevis_: the report handler works, but the exception handler doesn't... :-/
[2012-09-14 18:49:30 -0400] fish_: is there a reason why I _wouldn't_ want to us a lwr in a lwrp?
[2012-09-14 19:06:57 -0400] ypaq: hey, how can i write a provider that supports a user parameter, like in execute resource, which runs as a specific user? is that possible?
[2012-09-14 19:07:12 -0400] coderanger: fish_: You mean use a heavy resource with a light provider?
[2012-09-14 19:07:45 -0400] coderanger: ypaq: Look at mixlib-shellout, thats how we do all our subproc'ing
[2012-09-14 19:08:27 -0400] ypaq: coderanger: thx
[2012-09-14 19:09:49 -0400] forestbird: are there any best practices on what to use environments and roles for?
[2012-09-14 19:10:53 -0400] chip-: forestbird: There's multiple schools of thought. Generally I keep my roles very generic, usually per-application, and then keep my attributes (wherever possible) in environments.
[2012-09-14 19:11:01 -0400] chip-: then let the configuration live at the intersection of these two
[2012-09-14 19:11:04 -0400] fish_: coderanger: I mean calling a lwrp from another lwrp - or even calling the same lwrp from within
[2012-09-14 19:11:13 -0400] chip-: But there's no One True Way
[2012-09-14 19:11:43 -0400] rava: forestbird: what chip- said. imo roles=apps env=attribute values and overrides
[2012-09-14 19:12:23 -0400] rava: forestbird: environments are also great for using cookbook vers constraints
[2012-09-14 19:12:42 -0400] chip-: forestbird: generally you want your design pattern to reflect the 'no beautiful, unique snowflakes' rule. anything worth doing once in Chef is worth doing repeatably.
[2012-09-14 19:12:50 -0400] chip-: But chef isn't particularly opinionated, you can meld it to your will.
[2012-09-14 19:13:18 -0400] forestbird: yeah, i would just like to not find myself regretting what I did in a few years
[2012-09-14 19:13:19 -0400] forestbird: :)
[2012-09-14 19:13:26 -0400] fish_: coderanger: hrm I guess I'm just unsure how much logic to put into my recipe and how much into my lwrp
[2012-09-14 19:14:03 -0400] rava: fish_: read through the existing provided ones and follow their example? :)
[2012-09-14 19:14:07 -0400] forestbird: so I guess thinking about the workflow I choose now really matters
[2012-09-14 19:14:11 -0400] rava: fish_: at least until it stops working for you
[2012-09-14 19:14:57 -0400] forestbird: aren't there any blogs about this topic?
[2012-09-14 19:15:04 -0400] chip-: Multitudes.
[2012-09-14 19:15:18 -0400] forestbird: i seem to have trouble to find them :)
[2012-09-14 19:15:31 -0400] chip-: forestbird: the obvious downside of the environments:attributes and roles:apps pattern is that you can't find a configuration at-a-glance, because it's at an intersection.
[2012-09-14 19:15:37 -0400] chip-: But the upside is that it scales like a mofo
[2012-09-14 19:15:50 -0400] coderanger: fish_: think of an lwrp as a library function
[2012-09-14 19:15:56 -0400] coderanger: and the recipe is the script
[2012-09-14 19:16:20 -0400] chip-: New node for staging? It'll automatically pick up all the attributes for the staging environment without you lifting a finger, and all you have to specify is the run list.
[2012-09-14 19:17:08 -0400] dougireton: I have a question about setting attributes in Roles
[2012-09-14 19:17:13 -0400] chip-: also makes chef-driven monitoring easy, because you can write rules to auto-configure monitoring for role:apache, or what have you.
[2012-09-14 19:17:36 -0400] dougireton: I have this in my Role.rb file: default_attributes "host_file" => { "name" => "secure", "suffix" => node.chef_environment }
[2012-09-14 19:18:14 -0400] dougireton: but when I try to upload the role, I get this: Exception: NameError: undefined local variable or method `node' for role[secure]:Chef::Role
[2012-09-14 19:18:18 -0400] forestbird: chip-: sounds good
[2012-09-14 19:18:19 -0400] ssd7: dougireton: Unfortunately that won't work
[2012-09-14 19:19:02 -0400] dougireton: ok, basically I need to assign an attribute to the node's environment at run time
[2012-09-14 19:19:07 -0400] dougireton: not sure how to do that
[2012-09-14 19:22:28 -0400] ssd7: dougireton: Depends on the details a bit, but if you need to do runtime modification of attributes, you'll get the most consistency and most predictable behavior by doing it in the recipe itself
[2012-09-14 19:23:34 -0400] dougireton: ok, thanks
[2012-09-14 19:24:42 -0400] ssd7: For things like node.chef_environment you can do it in attribute files, but once you start wanting to make sure that you are properly getting the values of attributes set in environment or role overrides and such, the recipe becomes your best bet
[2012-09-14 20:03:42 -0400] Axsuul: if I'm to be using Chef::Utils::FileEdit, so I just call it like that? or is there a helper method
[2012-09-14 20:26:57 -0400] ypaq: hmm..
[2012-09-14 20:27:28 -0400] ypaq: just have seen something weird
[2012-09-14 20:28:19 -0400] miketheman: ypaq: tell us more. we love weirdness
[2012-09-14 20:28:25 -0400] erikh: something like this? http://gifmesmile.com/data/published/03_2012/b328f72cc08454eb3349717912eaa4eb_pub.gif
[2012-09-14 20:28:26 -0400] ypaq: using a bash resource with code <<-EOH cmd1 ; cmd2 EOH
[2012-09-14 20:28:36 -0400] ypaq: and a not_if condition
[2012-09-14 20:28:56 -0400] ypaq: first run cmd1 and cmd2 executed
[2012-09-14 20:29:10 -0400] miketheman: ypaq: that's not nearly as weird as what erikh provided.
[2012-09-14 20:29:25 -0400] ypaq: second run cmd2 exectued
[2012-09-14 20:29:28 -0400] ypaq: ??
[2012-09-14 20:30:05 -0400] ypaq: maybe weird was exaggerated
[2012-09-14 20:30:22 -0400] ypaq: at least i got your attention ;)
[2012-09-14 20:30:23 -0400] erikh: can you demonstrate the commands a little more literally?
[2012-09-14 20:30:43 -0400] erikh: cmd1, cmd2, and the not_if
[2012-09-14 20:32:06 -0400] ypaq: not_if true should prevent the code part from executing
[2012-09-14 20:32:27 -0400] rBEL: Anyone knows how to get chef run in noninteractive mode when installing new version of apt packages?
[2012-09-14 20:32:42 -0400] rBEL: at this moment i'm installing a new version of php packages and it's asking what to do with some configuration files which exists already on the server
[2012-09-14 20:32:55 -0400] rBEL: as far as i know chef did this good in the past by using "DEBIAN_FRONTEND" => "noninteractive" while installing packages
[2012-09-14 20:33:35 -0400] erikh: rBEL: I'm pretty sure it still does that?
[2012-09-14 20:33:38 -0400] awgross|flashman: ypaq can you paste the block somewhere like gist.github.com
[2012-09-14 20:35:15 -0400] ypaq: awgross|flashman: https://gist.github.com/3724608
[2012-09-14 20:37:16 -0400] ypaq: the reason why i'm setting up the db user this way is because i use peer auth for postgres. otherwise i would use database_user resource
[2012-09-14 20:38:01 -0400] awgross|flashman: the not if block seems a bit weird
[2012-09-14 20:38:07 -0400] miketheman: have to triend enclosing the not_if in a {} block?
[2012-09-14 20:38:14 -0400] awgross|flashman: i havent seen one with two statements
[2012-09-14 20:38:18 -0400] awgross|flashman: the first part in ""
[2012-09-14 20:38:19 -0400] awgross|flashman: the second
[2012-09-14 20:38:26 -0400] awgross|flashman: :user => "postgres"
[2012-09-14 20:38:35 -0400] miketheman: yeah, that's odd too
[2012-09-14 20:38:35 -0400] awgross|flashman: not sure what that is doing
[2012-09-14 20:38:46 -0400] rBEL: erikh: as far as I see here it's stuck here in interactive mode as it's asking me what to do with 2 config files
[2012-09-14 20:39:17 -0400] miketheman: I think ypaq is expecting the not_if to execute as user `postgres`
[2012-09-14 20:39:26 -0400] miketheman: I don't think that works
[2012-09-14 20:40:12 -0400] ypaq: miketheman: yes, i need the not_if condition to run as postgres
[2012-09-14 20:40:36 -0400] miketheman: so: looks like you already are with the -U flag
[2012-09-14 20:40:48 -0400] ypaq: miketheman: true
[2012-09-14 20:41:22 -0400] ypaq: but if i leave the :user => "postgres" out in the end it doesn't run under postgres os user
[2012-09-14 20:41:57 -0400] ypaq: chef runs as root. since postgres user needs peer authentication i need to run the command as postgres user
[2012-09-14 20:42:32 -0400] miketheman: then wrap the not_if in a {bash } statement?
[2012-09-14 20:42:54 -0400] ypaq: why would i do that?
[2012-09-14 20:42:56 -0400] miketheman: not_if { bash "check postgres user" do ...
[2012-09-14 20:43:05 -0400] miketheman: mto run as the postgres user
[2012-09-14 20:43:15 -0400] ypaq: but the not_if works
[2012-09-14 20:44:40 -0400] ypaq: my concern is not the not_if, my concern is that it exectuted "create user; grant ..." in the first run when the user didnt exist. but in the second run it only executed the "grants" but not the "create"
[2012-09-14 20:45:08 -0400] ypaq: it should not have executed the grants
[2012-09-14 20:45:17 -0400] ypaq: when the user exists
[2012-09-14 20:46:59 -0400] ypaq: or am I missing something?
[2012-09-14 20:57:53 -0400] chriss_: hi guys
[2012-09-14 20:58:05 -0400] rava: heya
[2012-09-14 20:59:12 -0400] chriss_: quick question, how does chef manage the nodes when I run the bootstrap with knife? does it just use the fqdn or does it use the mac address?
[2012-09-14 21:00:57 -0400] rBEL: fqdn afaik :)
[2012-09-14 21:01:42 -0400] chriss_: ok :)
[2012-09-14 21:06:12 -0400] chriss_: i've just finished to setup the first part of my infrastructure (base-server), yeah! :D
[2012-09-14 21:06:38 -0400] oddover: Hi chefs
[2012-09-14 21:06:40 -0400] oddover: got a question
[2012-09-14 21:06:48 -0400] Axsuul: How do you guys keep development environments in sync with chef librarian amongst many developers
[2012-09-14 21:06:57 -0400] rBEL: git
[2012-09-14 21:07:02 -0400] oddover: so I need to make sure that one line is in a file. how would I do that?
[2012-09-14 21:07:13 -0400] Axsuul: rBEL: so you actually check in the cookbooks?
[2012-09-14 21:07:37 -0400] rBEL: you just edit the cookbook
[2012-09-14 21:07:42 -0400] rBEL: commit the changes
[2012-09-14 21:07:47 -0400] rBEL: and push
[2012-09-14 21:07:49 -0400] Axsuul: rBEL: even with chef-librarian?
[2012-09-14 21:07:54 -0400] rBEL: to a remote server...
[2012-09-14 21:08:14 -0400] rBEL: and it will say if you dont have the most recent version
[2012-09-14 21:08:20 -0400] rBEL: than you will need to pull and push again
[2012-09-14 21:08:38 -0400] rBEL: like this is how we use it among many devs on our team
[2012-09-14 21:09:29 -0400] Axsuul: rBEL: what says you dont have the most recent version?
[2012-09-14 21:09:35 -0400] rBEL: git
[2012-09-14 21:09:45 -0400] Axsuul: rBEL: are you guys using chef-librarian?
[2012-09-14 21:10:00 -0400] rBEL: you won't be able to push to the git server if you dont have the most recent version :)
[2012-09-14 21:10:23 -0400] oddover: Axsuul: got a link for that?
[2012-09-14 21:10:36 -0400] Axsuul: yep, https://github.com/applicationsonline/librarian
[2012-09-14 21:11:03 -0400] Axsuul: They recommend gitignoring the cookbooks directory, but I dont see how we can keep our cookbooks in sync like that
[2012-09-14 21:11:34 -0400] rBEL: axsuul we dont use this
[2012-09-14 21:12:16 -0400] oddover: yea, I'm not familiar with it
[2012-09-14 21:12:26 -0400] oddover: sorry
[2012-09-14 21:13:10 -0400] oddover: so does anyone have an answer to my question?
[2012-09-14 21:13:33 -0400] chriss_: how long does it take to run your chef-client? both 1st time and after it when everything is already set
[2012-09-14 21:13:33 -0400] bluepojo: oddover: Axsuul: berkshelf.com
[2012-09-14 21:13:44 -0400] bluepojo: berkshelf is much faster and more stable than librarian
[2012-09-14 21:14:00 -0400] bluepojo: and has more features, like being able to pull cookbooks from your internal chef server
[2012-09-14 21:15:06 -0400] bluepojo: librarian has the annoying tendency to fall over once you get more than a few cookbooks in your cheffile
[2012-09-14 21:15:27 -0400] Axsuul: bluepojo: fall over?
[2012-09-14 21:15:33 -0400] bluepojo: never completes resolving
[2012-09-14 21:15:36 -0400] bluepojo: and hangs indefinitely
[2012-09-14 21:15:40 -0400] bluepojo: with complex dependency trees
[2012-09-14 21:15:40 -0400] Axsuul: bluepojo: i have about 10 so far, never experienced that, hmm
[2012-09-14 21:15:50 -0400] bluepojo: I had 16 in my cheffile when that happened
[2012-09-14 21:16:01 -0400] bluepojo: but it's more dependent on how detailed the dependencies are
[2012-09-14 21:16:07 -0400] bluepojo: like if there's lots of dependencies for cookbooks
[2012-09-14 21:16:19 -0400] cwj: sounds like you gave it something impossible to resolve
[2012-09-14 21:16:20 -0400] bluepojo: the algorithm librarian uses doesn't scale very well
[2012-09-14 21:16:34 -0400] bluepojo: cwj: it should just error out if that's the case.
[2012-09-14 21:16:54 -0400] bluepojo: "can't resolve because v1 is not compatible with v2 of this other cookbook"
[2012-09-14 21:16:55 -0400] cwj: ive seen the same behavior from bundler i think
[2012-09-14 21:16:55 -0400] bluepojo: or whatever
[2012-09-14 21:17:09 -0400] Axsuul: bluepojo: cool ill definitely keep this in mind thanks. Regarding Berkshelf, how do you keep the cookbooks in sync amongst many of your developers. Do you tell them to constantly do berks install?
[2012-09-14 21:17:31 -0400] bluepojo: not sure what you mean by in sync.
[2012-09-14 21:17:42 -0400] Axsuul: bluepojo: so you update the Berksfile.lock
[2012-09-14 21:17:43 -0400] bluepojo: like, there's a lockfile that says what versions everyone is using
[2012-09-14 21:17:48 -0400] bluepojo: check it in to source control
[2012-09-14 21:17:59 -0400] bluepojo: both your berksfile and your berksfile.lock
[2012-09-14 21:18:01 -0400] bluepojo: like you do with a gemfile
[2012-09-14 21:18:03 -0400] Axsuul: bluepojo: and you push that lockfile, doesnt everyone then have to update their cookbooks to reflect on that lockfile
[2012-09-14 21:18:52 -0400] bluepojo: yeah, similar to how bundler works
[2012-09-14 21:19:06 -0400] oddover: chriss_: When you first install it, it takes less than a minute. After that, it depends on how much it has to do.
[2012-09-14 21:19:09 -0400] bluepojo: like if someone bumps a version in a gemfile, everyone does a bundle when they pull
[2012-09-14 21:19:46 -0400] Axsuul: bluepojo: so now they do a bundle, and a berk install
[2012-09-14 21:20:03 -0400] bluepojo: one pattern we follow is to wrap common tasks in a Thorfile
[2012-09-14 21:20:04 -0400] chriss_: oddover: no, I don't mean the client itself, but to run the various recipes you have (I know that it depends on a lot of stuff: number of recipies, speed of the server, etc), it's just a curiosity :)
[2012-09-14 21:20:12 -0400] bluepojo: so you can write a task like "thor update"
[2012-09-14 21:20:16 -0400] bluepojo: that calls both bundle and berks
[2012-09-14 21:20:25 -0400] Axsuul: bluepojo: gotcha, thanks
[2012-09-14 21:20:31 -0400] bluepojo: can also do that with Rake
[2012-09-14 21:20:42 -0400] bluepojo: we like thor cause it's easy to write gems and include them in the Thorfile
[2012-09-14 21:20:47 -0400] oddover: chriss_: you mean me specifically? Mine takes a minute or two
[2012-09-14 21:20:48 -0400] bluepojo: gems that define tasks, I mean
[2012-09-14 21:20:57 -0400] bluepojo: Berkshelf has thor integration built in, in fact
[2012-09-14 21:21:12 -0400] Axsuul: bluepojo: yea thor has better cli capabilities too
[2012-09-14 21:21:15 -0400] oddover: chriss_: but currently mine isnt' doing much
[2012-09-14 21:21:46 -0400] Axsuul: bluepojo: are you from Riot games?
[2012-09-14 21:22:37 -0400] bluepojo: yeah
[2012-09-14 21:22:40 -0400] bluepojo: https://gist.github.com/3724939
[2012-09-14 21:22:53 -0400] bluepojo: that's an example of a Thorfile
[2012-09-14 21:23:01 -0400] bluepojo: that we put in all our cookbooks
[2012-09-14 21:23:36 -0400] bluepojo: all our internal ones, at least
[2012-09-14 21:23:36 -0400] Axsuul: bluepojo: cool, thanks
[2012-09-14 21:23:52 -0400] oddover: so, since no1 has an answer for me, I'm gonna give an example.
[2012-09-14 21:24:01 -0400] Axsuul: bluepojo: why did you guys call it Berkshelf? =p
[2012-09-14 21:24:13 -0400] bluepojo: cause bookshelf is hard to google for
[2012-09-14 21:24:22 -0400] oddover: lets say I want /etc/foo.conf to contain "random_setting=bar"
[2012-09-14 21:24:31 -0400] oddover: how would I do that?
[2012-09-14 21:24:40 -0400] oddover: without managing the whole file as a template or something
[2012-09-14 21:24:46 -0400] Axsuul: oddover: use Chef::Util::FileEdit
[2012-09-14 21:24:48 -0400] bluepojo: Axsuul: also http://cdn.memegenerator.net/instances/400x/23062589.jpg
[2012-09-14 21:25:48 -0400] bluepojo: oddover: you should only do that if you really really can't manage the whole file
[2012-09-14 21:25:50 -0400] Axsuul: oddover: for example, here's how I modify my sudoers file https://gist.github.com/869f8e0266d58df4280c
[2012-09-14 21:25:52 -0400] bluepojo: FileEdit isn't documented for that reason
[2012-09-14 21:26:32 -0400] bluepojo: Here's another way you can do it: https://github.com/RiotGames/perforce-cookbook/blob/master/recipes/default.rb
[2012-09-14 21:26:41 -0400] bluepojo: though FileEdit will probably serve your purposes
[2012-09-14 21:26:45 -0400] Axsuul: I just dont like to keep a template of the sudoers file, cause there's a potential that other recipes need to write to it
[2012-09-14 21:27:09 -0400] bluepojo: in that case you're better off writing a sudoers cookbook
[2012-09-14 21:27:10 -0400] Axsuul: and plus, you can make it idempotent
[2012-09-14 21:27:36 -0400] bluepojo: or a recipe inside a cookbook you include everything
[2012-09-14 21:27:37 -0400] Axsuul: yea probably, but lazy, and so far only one of my recipes have needed it so far
[2012-09-14 21:27:38 -0400] bluepojo: err
[2012-09-14 21:27:42 -0400] bluepojo: include on everything
[2012-09-14 21:27:54 -0400] bluepojo: we have a riot_base cookbook that has all that generic sysadmin stuff
[2012-09-14 21:28:18 -0400] bluepojo: that every box needs
[2012-09-14 21:28:30 -0400] bluepojo: so run lists look like recipe[riot_base], recipe[myapp]
[2012-09-14 21:28:42 -0400] Axsuul: cool yea, i have one called system that is similar
[2012-09-14 21:28:58 -0400] bluepojo: yeah, so you'd make system::sudoers
[2012-09-14 21:28:59 -0400] bluepojo: or something
[2012-09-14 21:29:19 -0400] Axsuul: but for example, i dont have rbenv being installed on some of my machines
[2012-09-14 21:29:25 -0400] Axsuul: so i wouldnt necessarily want that in my sudoers file
[2012-09-14 21:29:39 -0400] Axsuul: i want it to be dependent on if I actually use that cookbook
[2012-09-14 21:29:45 -0400] bluepojo: rbenv is a sudoer?
[2012-09-14 21:29:54 -0400] Axsuul: I have it as a system wide install
[2012-09-14 21:29:59 -0400] bluepojo: ah I see
[2012-09-14 21:30:00 -0400] Axsuul: so when doing `sudo rbenv rehash`
[2012-09-14 21:30:08 -0400] Axsuul: it wont pull in the proper ENV
[2012-09-14 21:30:15 -0400] Axsuul: due to how ubuntu handles sudo ENV
[2012-09-14 21:30:45 -0400] bluepojo: yeah, that makes it a bit harder, then
[2012-09-14 21:30:47 -0400] oddover: so, I'm not quite sure I understand how to use fileedit in my case
[2012-09-14 21:30:51 -0400] bluepojo: we do user installs
[2012-09-14 21:31:12 -0400] bluepojo: eg. https://github.com/RiotGames/rbenv-cookbook
[2012-09-14 21:31:33 -0400] Axsuul: bluepojo: any reason why you prefer that over system?
[2012-09-14 21:31:53 -0400] Axsuul: bluepojo: im assuming your main deployer user is the only one that needs it I guess?
[2012-09-14 21:32:08 -0400] Axsuul: oddover: what was your problem again?
[2012-09-14 21:32:08 -0400] ypaq: guess this is better now: https://gist.github.com/3724608  ... feedback would be cool
[2012-09-14 21:32:48 -0400] oddover: I want /etc/foo.conf to contain "random_setting=bar"
[2012-09-14 21:33:26 -0400] oddover: but I don't really care what the rest of the contents are
[2012-09-14 21:34:54 -0400] oddover: so what I need is like an "insert_if_its_not_there_already(random_setting=bar)"
[2012-09-14 21:35:33 -0400] Axsuul: oddover: where do you want to insert it
[2012-09-14 21:35:58 -0400] oddover: doesn't really matter
[2012-09-14 21:36:03 -0400] oddover: at the end is fine
[2012-09-14 21:39:06 -0400] oddover: so how would that work?
[2012-09-14 21:40:55 -0400] bluepojo: Axsuul: this way you can have the application control it's version of ruby
[2012-09-14 21:41:08 -0400] bluepojo: and if you end up with multiple apps on a box that require a different version, you won't have trouble
[2012-09-14 21:41:34 -0400] bluepojo: say Ruby 1.10 comes out and 1 app has it and the rest are still being upgraded
[2012-09-14 21:41:39 -0400] bluepojo: rbenv lets you keep them on the same box
[2012-09-14 21:41:48 -0400] erikh: ruby 1.10?
[2012-09-14 21:41:56 -0400] bluepojo: comes after ruby 1.9
[2012-09-14 21:41:57 -0400] erikh: 2.0 is already in feature-freeze :)
[2012-09-14 21:42:03 -0400] bluepojo: it's theoretical, damnit
[2012-09-14 21:42:04 -0400] bluepojo: lol
[2012-09-14 21:42:07 -0400] erikh: hahaha
[2012-09-14 21:42:15 -0400] bluepojo: 2.0 won't be done for forever
[2012-09-14 21:42:25 -0400] erikh: eh? it's like, done as of august
[2012-09-14 21:42:34 -0400] bluepojo: "done" as in "no one supports it till 2014"
[2012-09-14 21:43:05 -0400] bluepojo: I'm excited about it, for sure but I know we won't reasonably be able to use it for forever
[2012-09-14 21:43:10 -0400] erikh: it's not as big of a difference from 1.9
[2012-09-14 21:43:22 -0400] erikh: rather, the difference between 1.8 and 1.9 was significantly larger than 1.9 -> 2.0
[2012-09-14 21:43:32 -0400] bluepojo: under the hood, I'm sure that's true
[2012-09-14 21:43:33 -0400] erikh: basically, this is how it went
[2012-09-14 21:43:41 -0400] erikh: people kept bitching about ruby 2.0 this, ruby 2.0 that
[2012-09-14 21:43:52 -0400] erikh: and matz (politely as always) said, "fuck it, the next release is called 2.0"
[2012-09-14 21:43:58 -0400] bluepojo: oh haha
[2012-09-14 21:44:11 -0400] bluepojo: the only thing I know that'll be cool is named parameters
[2012-09-14 21:44:14 -0400] bluepojo: no more options hashes
[2012-09-14 21:44:20 -0400] erikh: you can find the mailing list discussion if you've got your googles about you
[2012-09-14 21:44:49 -0400] bluepojo: see, I almost said 2.0 in my example too
[2012-09-14 21:44:54 -0400] erikh: hahhaa
[2012-09-14 21:45:13 -0400] bluepojo: but I was like "the hell, it's just an example"
[2012-09-14 21:45:23 -0400] bluepojo: anyway, Axsuul ^^
[2012-09-14 21:45:29 -0400] erikh: sorry, I went aspie on you josiah :P
[2012-09-14 21:45:38 -0400] bluepojo: iluman
[2012-09-14 21:45:41 -0400] erikh: I'm pretty tired.
[2012-09-14 21:45:46 -0400] bluepojo: no sweat
[2012-09-14 21:52:40 -0400] Axsuul: bluepojo: I see that makes sense, thanks
[2012-09-14 21:54:32 -0400] fish_: hrm in a LWRP, can I call myself/different actions of that lwrp?
[2012-09-14 21:55:33 -0400] erikh: not easily, but it just gets built out to a class.
[2012-09-14 21:55:46 -0400] erikh: it's probably not a good idea.
[2012-09-14 21:55:50 -0400] oddover: Axsuul: so how would I do that?
[2012-09-14 21:56:03 -0400] erikh: although, you could use the provider in the provider
[2012-09-14 21:56:07 -0400] erikh: that would probably be cleaner.
[2012-09-14 21:56:14 -0400] fish_: erikh: hrm.. so what do I do if my lwrp action's code blog gets to long?
[2012-09-14 21:56:38 -0400] erikh: fish_: break it into bits in a library
[2012-09-14 21:56:52 -0400] erikh: or just create methods... it's really just ruby underneath the hood
[2012-09-14 21:56:57 -0400] erikh: but a library would probably be cleaner.
[2012-09-14 21:58:24 -0400] fish_: hrm.. that might be the right way
[2012-09-14 21:58:59 -0400] Axsuul: oddover: I would first do a search_file_delete_line(/Regexp.new('random_setting=bar')/), then using ruby File to append to it
[2012-09-14 21:59:09 -0400] fish_: but in the end my action consists of different actions like installation, configuration based on which attribute is set
[2012-09-14 21:59:45 -0400] oddover: Axsuul: So that would recreate it every time. hmm..
[2012-09-14 21:59:51 -0400] fish_: action a: action b + action c or d depending on a attribute
[2012-09-14 22:00:00 -0400] Axsuul: oddover: makes it consistent
[2012-09-14 22:00:29 -0400] oddover: Ok, I'm gonna something different and search through it, and if I find it, I won't do anything. If I dont, I'll append it to the end
[2012-09-14 22:00:36 -0400] oddover: Might have to use execute to do that
[2012-09-14 22:00:42 -0400] erikh: fish_: hrm. how many actions are we talking about here?
[2012-09-14 22:01:25 -0400] Axsuul: oddover: you might have access to search_match
[2012-09-14 22:01:38 -0400] fish_: erikh: not many, to be specific: I'm writing a nameserver resource, so the action is installing a nameserver and configuring it as a master or as a slave (depending on the attribute)
[2012-09-14 22:01:52 -0400] Axsuul: oddover: Chef::Util::FileEdit.search_match
[2012-09-14 22:02:22 -0400] oddover: hmm? I dont see that in here: http://rubydoc.info/gems/chef/0.10.10/Chef/Util/FileEdit
[2012-09-14 22:02:24 -0400] fish_: I can put all this in one action, but I would rather have different actions like: :install, :configure_master, :configure_slave and one that wraps all up which would be the default action
[2012-09-14 22:02:28 -0400] oddover: am I looking at the wrong thing?
[2012-09-14 22:02:30 -0400] Axsuul: oddover: https://github.com/opscode/chef/blob/master/chef/lib/chef/util/file_edit.rb#L97
[2012-09-14 22:02:51 -0400] erikh: fish_: hrm. maybe it would be best to combine those in a cookbook? not really a direct answer, but it's worth considering
[2012-09-14 22:02:53 -0400] Axsuul: oddover: but actually, its private
[2012-09-14 22:03:15 -0400] oddover: ah, yea I see that
[2012-09-14 22:03:28 -0400] Axsuul: oddover: i think its better to just delete it, then readd it
[2012-09-14 22:03:33 -0400] Axsuul: saves you work
[2012-09-14 22:03:51 -0400] Axsuul: oddover: or wait
[2012-09-14 22:03:58 -0400] Axsuul: oddover: https://github.com/opscode/chef/blob/master/chef/lib/chef/util/file_edit.rb#L71
[2012-09-14 22:04:00 -0400] fish_: erikh: hrm.. not sure.. I think I'll keep it in one big(ger) action for now
[2012-09-14 22:04:24 -0400] fish_: it's not that it's huge, I just don't like if/case blocks longer than a few lines
[2012-09-14 22:06:43 -0400] oddover: axsuul: yea, it looks like that got added in 0.10.10
[2012-09-14 22:06:50 -0400] oddover: that's exactly what I'm looking for
[2012-09-14 22:06:52 -0400] oddover: thanks!
[2012-09-14 22:07:51 -0400] Axsuul: I wish they would incorporate that into the File resource
[2012-09-14 22:08:25 -0400] oddover: yea, that'd be nice
[2012-09-14 22:10:45 -0400] bluepojo: FileEdit is intentionally not documented
[2012-09-14 22:10:53 -0400] bluepojo: because it's inherently not idempotent
[2012-09-14 22:10:57 -0400] bluepojo: and they want to discourage it's use
[2012-09-14 22:11:09 -0400] bluepojo: it's unlikely it'll go into File
[2012-09-14 22:11:19 -0400] oddover: that last function that Axsuul linked to seems to be idempotent
[2012-09-14 22:27:08 -0400] mattray: ugh, thinking I need a udev cookbook
[2012-09-14 22:27:22 -0400] mattray: gotta reorder these nics
[2012-09-14 22:30:26 -0400] oddover: when I use the template resource, and I want to use something from ohai, do I have to use template mapping in the resource?
[2012-09-14 22:31:01 -0400] oddover: er i mean variable mapping
[2012-09-14 22:33:47 -0400] oddover: so if I want to use the fqdn for example in a file, would I have to do this: variables(     :fqdn => node['hostname']   )
[2012-09-14 22:34:14 -0400] oddover: s/hostname/fqdn/
[2012-09-14 22:42:08 -0400] Pushnell: I'm trying to use a standard ruby "File.exists?(filename)" inside a provisioner but I'm getting undefined method `exists?' for Chef::Provider::File:Class .  I'm kindof a ruby noob  how can I tell it I want the standard File object?
[2012-09-14 22:42:21 -0400] Axsuul: Pushnell: do ::File
[2012-09-14 22:42:30 -0400] Pushnell: Axsuul: thanks much
[2012-09-14 22:42:37 -0400] Pushnell: Is that a shortcut to the default namespace?
[2012-09-14 22:42:51 -0400] Axsuul: Pushnell: yep
[2012-09-14 22:43:01 -0400] Pushnell: there is no fail, there is only Axsuul
[2012-09-14 22:43:04 -0400] Pushnell: thanks again
[2012-09-14 22:43:12 -0400] Axsuul: lol
[2012-09-14 22:43:19 -0400] Axsuul: i wish that were so..
[2012-09-14 22:46:26 -0400] hoover_damm: failure isn't bad
[2012-09-14 22:46:33 -0400] hoover_damm: accept it :) make it hurt less
[2012-09-14 22:52:10 -0400] Pushnell: is there any opinion as to using symbols for attributes vs strings?
[2012-09-14 22:55:53 -0400] Blackavar: Several. However, http://acrmp.github.com/foodcritic/#FC001
[2012-09-14 22:56:26 -0400] Pushnell: Blackavar: perfect, thanks.  I'll need to get onto foodcritic too.
[2012-09-14 22:58:41 -0400] Blackavar: jtimberman's explanation makes reasonable sense at https://github.com/acrmp/foodcritic/issues/1 , but it also shows the several opinions.
[2012-09-14 22:58:50 -0400] Pushnell: hrm  so, safe to assume that foodcritic doesn't work with omnibus because omnibus is 1.9.1?
[2012-09-14 22:59:07 -0400] Pushnell: (I haven't played with rvm/etc for my native ruby)
[2012-09-14 23:04:16 -0400] Blackavar: Hm. I'm using 1.9.3, and it works there. Not sure what it loses at 1.9.1, but it works with a 1.9, at least.
[2012-09-14 23:05:11 -0400] Blackavar: Looks like foodcritic's page says 1.9.2+
[2012-09-14 23:06:48 -0400] Blackavar: I'm not using RVM, though - just set up links and have my desired version earlier in the path.
[2012-09-14 23:09:27 -0400] Pushnell: I heart chef.  opscode docs, on the other hand, can blow me.
[2012-09-14 23:09:54 -0400] alop: +1
[2012-09-14 23:10:08 -0400] Pushnell: The official docs recommend exactly the opposite of FC016
[2012-09-14 23:10:58 -0400] Blackavar: Should have a bug open, then. FC001 was originally the reverse.
[2012-09-14 23:17:07 -0400] Blackavar: I'm not seeing an explicit recommendation at the linked wiki page, just a statement that the DSL doesn't provide a semantic. Probably worth bugging for clarification.
[2012-09-14 23:18:06 -0400] Blackavar: Ahh, looks like the docs are out of date, and pre-0.10.
[2012-09-14 23:18:51 -0400] Pushnell: Blackavar: aye, I was wrong about them being blatantly wrong.  But there's no mention of default_action
[2012-09-14 23:27:19 -0400] Blackavar: Looks like it's worth a clarification bug, though. The linked explanation should probably be more opinionated. Any Opscode sorts around? *knocks on the wall*
[2012-09-14 23:34:41 -0400] Blackavar: Crickets at the moment, it seems.
[2012-09-14 23:44:43 -0400] hoover_damm: I love Calavera's response
[2012-09-14 23:44:54 -0400] hoover_damm: makes me feel like I have nothing more to add
[2012-09-14 23:45:38 -0400] hoover_damm: Blackavar, remember that foodcritic is a linting tool that provides practices that may not always be aligned with Opscode's training material.
[2012-09-14 23:45:43 -0400] hoover_damm: or be advised
[2012-09-14 23:46:08 -0400] Blackavar: Oh, of course.
[2012-09-14 23:46:11 -0400] hoover_damm: Blackavar, my suggestion on that would be that Opscode should provide a linting tool that follows their practices as that will always be opinionated
[2012-09-14 23:49:50 -0400] bluepojo: foodcritic is good
[2012-09-14 23:50:07 -0400] bluepojo: http://acrmp.github.com/foodcritic/
[2012-09-14 23:50:27 -0400] hoover_damm: bluepojo, thank you but that wasn't what we were talking about
[2012-09-14 23:50:38 -0400] bluepojo: oh
[2012-09-14 23:50:40 -0400] bluepojo: my bad
[2012-09-14 23:50:41 -0400] bluepojo: XD
[2012-09-14 23:50:51 -0400] bluepojo: I didn;'t read far back enough
[2012-09-14 23:51:06 -0400] bluepojo: Opscode has some outdated practices in their wiki, I think
[2012-09-14 23:51:26 -0400] hoover_damm: well they still use some practices that some users do not like to use
[2012-09-14 23:51:26 -0400] bluepojo: so it's not good practice to take what they put there as their opinions
[2012-09-14 23:51:33 -0400] hoover_damm: but practices are practices in this regard
[2012-09-14 23:51:38 -0400] hoover_damm: opinionated and to evolve
[2012-09-14 23:51:42 -0400] bluepojo: yeah
[2012-09-14 23:51:47 -0400] hoover_damm: opscode maybe on the following end for awhile
[2012-09-14 23:51:49 -0400] hoover_damm: until they can lead
[2012-09-14 23:52:26 -0400] bluepojo: maybe they should just endorse foodcritic and solicit pull requests
[2012-09-14 23:52:41 -0400] bluepojo: so the tool can evolve with the larger community
[2012-09-14 23:53:27 -0400] hoover_damm: they pretty much do, but foodcritic has things that don't follow what they suggest
[2012-09-14 23:53:34 -0400] hoover_damm: thus the conversation above
[2012-09-14 23:54:45 -0400] bluepojo: fair enough
[2012-09-14 23:59:57 -0400] paulmooring: Pushnell: where do the docs recommend the opposite of FC016?
