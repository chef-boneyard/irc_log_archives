[2012-09-17 00:26:40 -0400] Axsuul: Do you guys write your nodes in ruby or json
[2012-09-17 00:26:53 -0400] Axsuul: I find it a huge disadvantage not being able to comment a json file
[2012-09-17 00:31:09 -0400] yfeldblum: Axsuul, in your php/java/rails apps, do you typically comment the records in the backend database?
[2012-09-17 00:31:58 -0400] Axsuul: yfeldblum: It's just that when I'm defining the attributes within a node, I want to be able to comment that
[2012-09-17 00:33:35 -0400] yfeldblum: Axsuul, in case you didn't pick up on it, i am challenging your whole way of thinking about these nodes
[2012-09-17 00:35:12 -0400] Axsuul: yfeldblum: sorry, still not picking up on it :(
[2012-09-17 00:38:51 -0400] Axsuul: yfeldblum: would you kindly clarify?
[2012-09-17 00:38:57 -0400] Axsuul: yfeldblum: I'm using chef solo btw
[2012-09-17 00:43:44 -0400] yfeldblum: Axsuul, the node json files are intended to be pure data, not code
[2012-09-17 00:43:55 -0400] Axsuul: yfeldblum: gotcha
[2012-09-17 00:44:06 -0400] yfeldblum: Axsuul, you can have a "source" file and a script file which reads the source file and spits out a node json file
[2012-09-17 00:44:48 -0400] yfeldblum: Axsuul, if the source file is YAML or XML, you can have comments; and then you just need a YAML/XML-to-JSON translation script
[2012-09-17 00:45:17 -0400] yfeldblum: Axsuul, basically as if you would write on the shell: `xml2json < node.yml > node.json`
[2012-09-17 00:45:34 -0400] Axsuul: yfeldblum: Would you recommend I create a recipe to say, setting attributes with comments, at the role level
[2012-09-17 00:46:19 -0400] Axsuul: Something like a nginx::config recipe
[2012-09-17 00:47:26 -0400] yfeldblum: Axsuul, is this a separate question or related to the above?
[2012-09-17 00:47:33 -0400] Axsuul: yfeldblum: related
[2012-09-17 00:48:42 -0400] yfeldblum: Axsuul, um you could put comments in a cookbook's attributes file and in a ruby role file, sure
[2012-09-17 00:48:47 -0400] yfeldblum: Axsuul, up to you
[2012-09-17 00:52:08 -0400] Axsuul: yfeldblum: thank you, do you write your roles in ruby?
[2012-09-17 01:05:21 -0400] cmceldowney: anyone have experience trying to call knife command from a cron task? Running a script to delete nodes that have been terminated (EC2).
[2012-09-17 01:09:29 -0400] yfeldblum: Axsuul, up to you
[2012-09-17 01:57:08 -0400] miah: hi
[2012-09-17 03:42:22 -0400] williamherry: how to make me appear as a approved contributor, I already fill out a cla
[2012-09-17 08:10:05 -0400] BryanWB: ohai chefs!
[2012-09-17 08:28:18 -0400] gyre007: darn...every time I click on "status" in WebUI ...im getting Nginx timeouts..
[2012-09-17 08:28:20 -0400] gyre007: what the heck
[2012-09-17 08:28:32 -0400] gyre007: im running only 10 clients on this instalation ie 10 nodes
[2012-09-17 08:30:45 -0400] gyre007: it looks like the search is broken...
[2012-09-17 08:30:46 -0400] gyre007: darn
[2012-09-17 08:35:37 -0400] gyre007: hmm chef-solr is not starting...
[2012-09-17 08:50:11 -0400] masterkorp: heh
[2012-09-17 09:01:39 -0400] PapaSierra: i'm installing php using the opscode php cookbook. i'm observing behaviour similiar to the OP here: http://stackoverflow.com/q/8902946 notice at the bottom he mentions "Apache doesn't seem to know which version of PHP it's running. php_info() is reporting that it's using PHP 5.3.2, but command line (php -v) is correctly reporting 5.3.9." for me that's 5.3.10 vs 5.4.7
[2012-09-17 09:03:15 -0400] hoover_damm: PapaSierra, you have to rebuild the php dso
[2012-09-17 09:03:37 -0400] hoover_damm: PapaSierra, remember your in a binary distro you can't just download php 5.3.9 and install it and expect apache's dso's to see it :(
[2012-09-17 09:05:07 -0400] PapaSierra: hoover_damm thanks for taking me a step closer here. i'm not understanding fully yet though. let me start by saying that in the opscode recipe i'm specifying "source" instead of "package" and 5.4.7. given that info, where should i look next?
[2012-09-17 09:07:34 -0400] masterkorp: installing php = my tip to leave
[2012-09-17 09:07:36 -0400] hoover_damm: PapaSierra, I don't really know how to solve your problem.
[2012-09-17 09:08:22 -0400] PapaSierra: ok, but you did just give me a pointer there, so i'm wondering how i can learn more?
[2012-09-17 09:08:30 -0400] hoover_damm: PapaSierra, I haven't reviewed the php cookbook so I can't speak for what it does.  But if you want to upgrade to php53 you should look into php53dotdeb or some other source
[2012-09-17 09:08:55 -0400] hoover_damm: PapaSierra, because using source and a binary distribution such as Ubuntu or Debian is going to be hacktastic at best
[2012-09-17 09:09:05 -0400] hoover_damm: unless you know what your doing
[2012-09-17 09:09:39 -0400] PapaSierra: ok understood
[2012-09-17 09:09:44 -0400] hoover_damm: PapaSierra, it's all the dependenacies that expect one thing, but get another...
[2012-09-17 09:10:27 -0400] hoover_damm: PapaSierra, http://www.dotdeb.org/instructions/
[2012-09-17 09:10:49 -0400] PapaSierra: i'm just curious who is deciding to install 5.3 because we've scoured the php and apache cookbooks and there's nowhere apparent where 5.3 is being installed. it appears though we've got both installed and working, but it's just to point apache to the 5.4 now. (and preferable find a way to drop 5.3)
[2012-09-17 09:11:04 -0400] PapaSierra: this stuff is hectically complicated :(
[2012-09-17 09:12:06 -0400] hoover_damm: pretty much yeah... you have to pay me about 150$/hr to try and support php crap
[2012-09-17 09:12:08 -0400] hoover_damm: it's so bad
[2012-09-17 09:12:16 -0400] hoover_damm: so good luck
[2012-09-17 09:12:54 -0400] PapaSierra: thanks anyway
[2012-09-17 09:13:35 -0400] PapaSierra: (oooh, question, could i side step this entirely if we dropped apache and went for nginx or another web server?)
[2012-09-17 09:15:02 -0400] zts: PapaSierra: I'm about a week away from working on the same problem, so I hope someone has a definitive answer for you
[2012-09-17 09:15:38 -0400] hoover_damm: zts, i hope you got a lot of lube
[2012-09-17 09:15:59 -0400] zts: PapaSierra: but trying to use nginx instead of apache will, at a minimum, give you a different set of problems to consider :)
[2012-09-17 09:16:35 -0400] zts: PapaSierra: I'd speculate that your problem is that you have Apache with mod_php, built against a different PHP than the one you think you're installing
[2012-09-17 09:17:20 -0400] zts: PapaSierra: as I understand it, nginx doesn't have a mod_php equivalent, so that's one manner of confusion that you will avoid
[2012-09-17 09:17:34 -0400] PapaSierra: zts i think you're bang on right about the apache build
[2012-09-17 09:17:42 -0400] zts: PapaSierra: you trade that for the complexity of running with fastcgi, but I understand that's the recommended way to deploy PHP with Apache these days anyway
[2012-09-17 09:18:02 -0400] PapaSierra: ideally i would like to be using mongrel2 but that needs a custom handler built i think
[2012-09-17 09:19:49 -0400] PapaSierra: i'm going to try with the dotdeb package for now...
[2012-09-17 09:20:28 -0400] zts: You'd be living life on the edge, but it seems someone has already written the handler :) https://github.com/winks/m2php
[2012-09-17 09:21:03 -0400] zts: anyway, good luck!
[2012-09-17 09:21:46 -0400] PapaSierra: thanks, if i win i'll let you know
[2012-09-17 09:44:37 -0400] PapaSierra: hoover_damm so would i use the apt cookbook to add the dotdeb repo?
[2012-09-17 10:22:04 -0400] PapaSierra: zts looks like we're getting some mileage by using the dotdeb repository. we've added it via the apt cookbook. i'll post again soon if apache plays nice
[2012-09-17 11:05:08 -0400] gyre007: anyone here ever used application_ruby/application cookbook ?
[2012-09-17 11:05:25 -0400] gyre007: im trying to lower the number of unicorn workers but whatever I do Chef completely ignores it...
[2012-09-17 11:12:12 -0400] yfeldblum: gyre007, is the webui on the same node as the api, couch, rabbit, solr?
[2012-09-17 11:12:58 -0400] gyre007: yfeldblum, yeah...basically the problem was that the solr failed...couldnt write into log dir and to /var/run/chef...I changed the ownership restarted solr and all was good
[2012-09-17 11:13:31 -0400] yfeldblum: gyre007, what are you trying to do to lower the number of unicorn workers?
[2012-09-17 11:16:47 -0400] gyre007: yfeldblum, for some reason its set to 8
[2012-09-17 11:16:52 -0400] gyre007: I mean i know the reason...
[2012-09-17 11:16:57 -0400] gyre007: but im not able to lower it...
[2012-09-17 11:17:04 -0400] gyre007: to something like 4
[2012-09-17 11:17:13 -0400] gyre007: unicorn loads rails and its eating up memory
[2012-09-17 11:17:24 -0400] gyre007: causes madness...
[2012-09-17 11:20:50 -0400] yfeldblum: gyre007, switch it so the master loads the application before fork?
[2012-09-17 11:21:14 -0400] gyre007: yfeldblum, hm ?
[2012-09-17 11:24:19 -0400] yfeldblum: gyre007, http://bogomips.org/unicorn.git/tree/lib/unicorn/configurator.rb#n402
[2012-09-17 11:25:25 -0400] gyre007: yfeldblum, my problem is that the Unicorn's configuration file is completely being ignored by chef - after i update recipe....
[2012-09-17 11:25:26 -0400] gyre007: strange
[2012-09-17 11:25:32 -0400] gyre007: thats the problem im trying to resolve ;)
[2012-09-17 11:26:04 -0400] yfeldblum: gyre007, how are you trying to deploy the file?
[2012-09-17 11:26:19 -0400] gyre007: using application_ruby resource
[2012-09-17 11:26:24 -0400] gyre007: cookbook
[2012-09-17 11:26:31 -0400] gyre007: which defines unicorn resource
[2012-09-17 11:29:30 -0400] yfeldblum: gyre007, https://github.com/opscode-cookbooks/application_ruby/blob/master/resources/unicorn.rb
[2012-09-17 11:29:46 -0400] gyre007: yes
[2012-09-17 11:30:03 -0400] gyre007: thtas setting the number of workers to 8
[2012-09-17 11:30:11 -0400] gyre007: but whatever I do i cant change it to 4...
[2012-09-17 11:30:13 -0400] gyre007: in MY recipe
[2012-09-17 11:30:21 -0400] gyre007: not directly in the resource definition
[2012-09-17 11:30:40 -0400] gyre007: i want to override the default set in the resource definition to the value I want
[2012-09-17 11:31:20 -0400] yfeldblum: gyre007, right, so in your recipe, set the attribute to 4 ... what does your recipe look like?
[2012-09-17 11:36:44 -0400] gyre007: yfeldblum,
[2012-09-17 11:36:47 -0400] gyre007: second will gist it
[2012-09-17 11:37:29 -0400] gyre007: yfeldblum, https://gist.github.com/3736810
[2012-09-17 11:40:19 -0400] yfeldblum: gyre007, hmmm ... well i guess that looks right ...
[2012-09-17 11:40:46 -0400] yfeldblum: gyre007, i don't actually use any of these cookbooks so it's hard to say
[2012-09-17 11:46:22 -0400] gyre007: :)
[2012-09-17 11:47:02 -0400] yfeldblum: gyre007, i like to think about deploying HTTP endpoints, which means the unicorn config is actually part o the app (in the app's version control) and not part of the infrastructure
[2012-09-17 11:52:15 -0400] gyre007: yfeldblum, well...this is a part of the app.........................................recipe :)
[2012-09-17 15:02:21 -0400] zeroXten: is there a good tutorial for installing chef server on centos6? http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+CentOS seems to be somewhat incomplete
[2012-09-17 15:04:11 -0400] jwitrick: 1) install chef-client/chef-solo  (http://www.opscode.com/chef/install/)
[2012-09-17 15:04:11 -0400] jwitrick: 2) Follow the steps from configure chef-solo to hte end (http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo)
[2012-09-17 15:04:12 -0400] jwitrick: Note. centos6 does not have the same issues centos5 does.
[2012-09-17 15:04:37 -0400] zeroXten: ah right, ok
[2012-09-17 15:58:15 -0400] daleks_: Hi, I have an execute service listening for a :restart action of another service.  I want to run a shell command when this happens.  I've subscribed to the :restart action, but then Chef attempts to apply the same :restart action to the execute service.  How would I map this to a :run action?
[2012-09-17 16:08:53 -0400] zeroXten: hmm, now I need to clean up my previous installation attempt =/
[2012-09-17 16:09:55 -0400] namidark: I have a recipe thats 1st in the list that doesn't get executed when doing a knife ec2 create, but it gets run when I do a sudo chef-client; anyone have any ideas?
[2012-09-17 16:13:13 -0400] yfeldblum: daleks_, you've got it backwards
[2012-09-17 16:13:34 -0400] daleks_: yfeldblum: i don't doubt it.  ;)  any thoughts on how to this the proper way?
[2012-09-17 16:13:49 -0400] yfeldblum: daleks_, when resource B subscribes to resource A, then *any* update of resource A, regardless of which action it was on resource A that did the update, triggers the notification to resource B
[2012-09-17 16:14:59 -0400] daleks_: yfeldblum: so if resource A is only kicking out :restart actions, how would i do something other than that on resource B?  is there a way for me to say "if :restart, then :run, else ignore"?
[2012-09-17 16:15:32 -0400] yfeldblum: daleks_, no, on resource B, you write the action on resource B that should be triggered
[2012-09-17 16:16:10 -0400] daleks_: yfeldblum: "action :run"?
[2012-09-17 16:16:33 -0400] daleks_: yfeldblum: i thought i tried that an that action ran every time i did chef-client, regardless of if a notification was received...
[2012-09-17 16:16:52 -0400] yfeldblum: daleks_, so `subscribes :run, resources(:service => "the-service")` will hook up *any* convergence of resource "service[the-service]" to trigger the :run action of the execute resource
[2012-09-17 16:17:22 -0400] daleks_: yfeldblum: oooooooh i get it.  i'm not subscribing to :restart, but subscribing to anything so the subscribe entry lists the action i want to run.
[2012-09-17 16:17:25 -0400] daleks_: yfeldblum: thanks!
[2012-09-17 16:17:31 -0400] yfeldblum: daleks_, that's right
[2012-09-17 16:23:42 -0400] UukGoblin: where can I read up about require_recipe being deprecated?
[2012-09-17 16:23:55 -0400] UukGoblin: can I just replace it dumbly with include_recipe?
[2012-09-17 16:24:30 -0400] namidark: this is the recipe: https://gist.github.com/49ef8289476ffd17aa65 -- works if i do chef-client but fails on bootstrap
[2012-09-17 16:24:55 -0400] namidark: a recipe that runs after that fails*
[2012-09-17 16:30:05 -0400] yfeldblum: UukGoblin, yes, use `include_recipe` instead
[2012-09-17 16:31:07 -0400] UukGoblin: % grep -r require_recipe | wc -l
[2012-09-17 16:31:10 -0400] UukGoblin: 83
[2012-09-17 16:31:15 -0400] UukGoblin: tempted to use sed ;-P
[2012-09-17 16:31:58 -0400] UukGoblin: but a little worried if behaviour will stay the same everywhere ;-)
[2012-09-17 16:34:56 -0400] yfeldblum: UukGoblin, it's the same
[2012-09-17 16:45:27 -0400] dougireton: Is there an existing cookbook to configure Windows DNS client settings?
[2012-09-17 16:45:49 -0400] dougireton: I can't find one on the Community Cookbooks site
[2012-09-17 16:55:22 -0400] Pushnell: hey all.  I have a recipe with a subversion checkout followed by a "if ::File.exists?" looking into the checkout for a local .erb template.  The if check is failing on the first run, even though it is clearly happening after the checkout.  However, on subsequent runs the if succeeds and then everything gets configured as it should be.  Is there some sort of equivalent for "hash -r" I can /need to use?
[2012-09-17 16:55:31 -0400] gyre007: anyone here who uses application cookbook to deploy rails app ? I would be thankful if someone could give me a hand...
[2012-09-17 16:58:51 -0400] gyre007: I have this recipe but I can't figure out why the heck is the number of Unicorn worker procesess set in this recipe completely ignored https://gist.github.com/3738474
[2012-09-17 16:59:14 -0400] gyre007: basically I'm setting it in Unicorn sub resource to 4 but it's being completely ignored and still set to 8
[2012-09-17 16:59:34 -0400] gyre007: which is killing my box because it's loading 8 instances of rails....memory expensive...
[2012-09-17 16:59:40 -0400] gyre007: anyone idea ?
[2012-09-17 17:07:12 -0400] yfeldblum: Pushnell, http://wiki.opscode.com/display/ChefCN/Anatomy+of+a+Chef+Run
[2012-09-17 17:07:39 -0400] yfeldblum: gyre007, maybe get in touch with the authors?
[2012-09-17 17:08:35 -0400] yfeldblum: Pushnell, your "svn" resource declaration doesn't perform a svn-checkout: it actually declares that a svn-checkout shall be performed *later*
[2012-09-17 17:10:08 -0400] Pushnell: yfeldblum: ah, ok.  thanks.  is there a way to checkout a template and use templates from it in the same run?
[2012-09-17 17:10:10 -0400] gyre007: yfeldblum, yeah will probably have to do that :)
[2012-09-17 17:10:14 -0400] gyre007: that's Opscode btw :)
[2012-09-17 17:13:37 -0400] yfeldblum: gyre007, yes, but you can also try pinging some of the individual authors by looking at the commit authors on github
[2012-09-17 17:13:58 -0400] Pushnell: yfeldblum: would I need to create a resource and notify it?
[2012-09-17 17:14:18 -0400] yfeldblum: Pushnell, yes of course, so long as you take care to conform to the way chef works
[2012-09-17 17:18:29 -0400] Pushnell: yfeldblum: the LWRP docs don't directly mention how to respond to notifications.  Are they simply resource actions?
[2012-09-17 17:23:20 -0400] awgross|flashman: Pushnell: correct
[2012-09-17 17:24:02 -0400] Pushnell: awgross|flashman: thanks
[2012-09-17 17:35:18 -0400] gyre007: guys, how can I find out version of UBuntu from withing the recipe ?
[2012-09-17 17:35:22 -0400] gyre007: something in ohai ?
[2012-09-17 17:36:37 -0400] awgross|flashman: gyre you can use ohai
[2012-09-17 17:36:47 -0400] awgross|flashman: check out the following property
[2012-09-17 17:37:05 -0400] awgross|flashman: node['lsb']['codename']
[2012-09-17 17:37:12 -0400] awgross|flashman: that should give you the distro name
[2012-09-17 17:37:20 -0400] gyre007: awgross|flashman, cool
[2012-09-17 17:37:23 -0400] awgross|flashman: and other properties in that block will give you the version #s
[2012-09-17 17:39:15 -0400] awgross|flashman: is there a good way to get access to a dependency graph for a given environment?  for example if I change recipe X it could potentially affect these other dependent cookbooks?
[2012-09-17 17:41:31 -0400] jtimberman: gyre007: node['platform_version']
[2012-09-17 17:41:35 -0400] jtimberman: will get the exact version
[2012-09-17 17:42:02 -0400] jtimberman: but the lsb codename will be that wonderful named one - though you need the lsb package(s) installed.
[2012-09-17 17:42:20 -0400] jtimberman: (certain minimal / jeos installations may not have lsb)
[2012-09-17 17:42:54 -0400] gyre007: jtimberman, cheers..awesome
[2012-09-17 17:43:09 -0400] Pushnell: awgross|flashman: I just stumbled across a blog post for a tool someone had written . trynig to find it ...
[2012-09-17 17:43:33 -0400] awgross|flashman: Pushnell: atm I am looking at the source for Berkshelf and Librarian-Chef
[2012-09-17 17:43:46 -0400] awgross|flashman: doesnt look like the resolvers are particularly modular
[2012-09-17 17:44:01 -0400] gyre007: jtimberman, since you're here..I have a question about application cookbook which you wrote :)
[2012-09-17 17:44:06 -0400] gyre007: so it seems
[2012-09-17 17:46:51 -0400] yfeldblum: awgross|flashman, dependencies are in the cookbook metadata, not in the recipes
[2012-09-17 17:47:01 -0400] Pushnell: awgross|flashman: http://www.miketheman.net/2012/07/20/a-picture-is-worth-a-few-thousand-bytes/
[2012-09-17 17:47:14 -0400] awgross|flashman: yfeldblum: sorry, you are correct, I was using the wrong term
[2012-09-17 17:47:16 -0400] yfeldblum: awgross|flashman, also the Librarian resolver has no dependency on Librarian-Chef or on Chef
[2012-09-17 17:47:28 -0400] awgross|flashman: yfeldblum: interesting, ill check it out
[2012-09-17 17:48:56 -0400] mdeboard: How do I eliminate the need to invoke "sudo -i" for various chef-related commands on Ubuntu 12.04?
[2012-09-17 17:49:32 -0400] mdeboard: Should I just use system Ruby (this is the only thing I use Ruby for)
[2012-09-17 17:49:33 -0400] awgross|flashman: mdeboard: in recipes or when you are trying to initiate them, can you give some examples?
[2012-09-17 17:49:51 -0400] mdeboard: awgross|flashman: I'm on page 1 of the tutorial, http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-09-17 17:50:02 -0400] mdeboard: sudo -i chef-client -v
[2012-09-17 17:50:20 -0400] mdeboard: ``knife client list`` doesn't work either
[2012-09-17 17:50:21 -0400] gyre007: im trying to figure out one thing...im using application_nginx recipe with application cookbook...application cookbook configures the nginx loadbalancer resource as runit service and then it tries to restart it as NORMAL init.d service...which is causing the chef-client to FATAL out...
[2012-09-17 17:50:23 -0400] mdeboard: says it can't find the command
[2012-09-17 17:50:31 -0400] gyre007: that's actually what I wanted to ask jtimberman about :)
[2012-09-17 17:51:34 -0400] mdeboard: awgross|flashman: e.g. https://gist.github.com/2d8a3ce0c709db003eb7
[2012-09-17 17:51:35 -0400] awgross|flashman: mdeboard: it is not finding it in the path properly, probably because it is attempting to use the system ruby gems when run with sudo
[2012-09-17 17:51:48 -0400] gyre007: actually /etc/init.d/nginx -> /usr/bin/sv so the init script IS pointing to runit sv manager but the restart fails anyway mm
[2012-09-17 17:52:13 -0400] awgross|flashman: mdeboard: in that case it is not finding your knife config file, you can specify an explicit path with -c
[2012-09-17 17:52:15 -0400] mdeboard: awgross|flashman: I don't even have ruby installed on the system
[2012-09-17 17:53:51 -0400] mdeboard: Only have RVM
[2012-09-17 17:58:08 -0400] gabebug: I have a build-essential::default at the top of my run list, and mysql::client later, but chef is trying to run mysql::client as its first recipe, which fails to build the mysql gem due to the build-essential packages not being installed. is there any reason why mysql::client is running first?
[2012-09-17 17:58:38 -0400] _0x783czar: I'm having trouble installing gems in my chef run.  For some reason whenever I run gem_package "bundler" bundler is still not getting installed on my system.  There are no errors in my chef run, but it's not installing.
[2012-09-17 18:00:01 -0400] _0x783czar: gabebug: could it be that it's trying to do something outside of a resource (and thus at compile time and not at converge) that depends on the completion of build-essential
[2012-09-17 18:00:03 -0400] gabebug: _0x783czar: do you have multiple ruby interpreters installed? if you installed via the omnibus package, it may be installing into /opt/chef/embedded/. you can try passing the gem_binary to your gem_package resource
[2012-09-17 18:00:29 -0400] _0x783czar: gabebug: that's a good idea, I'll try that
[2012-09-17 18:02:19 -0400] gabebug: _0x783czar: i have a "Loading Recipe mysql::client via include_recipe" right before it processes it, and i also have a mysql::server recipe that does do an include_recipe on it, but the docs for include_recipe state "The included recipe's resources will be inserted in order, at the point where include_recipe was called"
[2012-09-17 18:02:27 -0400] mdeboard: Man I really, really need some better documentation on what the hell chef does when it installs
[2012-09-17 18:02:56 -0400] mdeboard: Like for example why do I need to run sudo -i for every command instead of using the RVM ruby
[2012-09-17 18:02:56 -0400] gabebug: mdeboard: when it does a chef run, or when you're installing the chef package itself?
[2012-09-17 18:02:57 -0400] allan_wind: Does a chef-solo node have access to the attributes for all nodes or only its own?
[2012-09-17 18:03:10 -0400] mdeboard: gabebug: I'm trying to follow through the tutorial
[2012-09-17 18:03:52 -0400] gabebug: allan_wind: i think chef-solo should only have access to its own *node* attributes, which are passed in with the -j flag.
[2012-09-17 18:04:12 -0400] mdeboard: gabebug: I'm on step 4, http://wiki.opscode.com/display/chef/Fast+Start+Guide ...
[2012-09-17 18:04:57 -0400] yfeldblum: awgross|flashman, however Librarian's dep resolver only handles dependency-type dependencies
[2012-09-17 18:05:07 -0400] mdeboard: Trying to run ``knife client list ORGANIZATION-validator`` (of course replacing my org name where appropriate. The result is the following: https://gist.github.com/c6c1de296d338130002e
[2012-09-17 18:05:09 -0400] mdeboard: @ gabebug
[2012-09-17 18:05:16 -0400] _0x783czar: gabebug: I'm referring that perhaps inside the recipe it's trying to to do something outside of a resource.  Those will be evaluated before any resources in any recipe are run.  If they are dependant on anything that won't exist until the resources in any other recipe have completed, your run will fail at compile time.
[2012-09-17 18:05:44 -0400] mdeboard: like where is this knife configuration file I'm supposed to have?
[2012-09-17 18:05:59 -0400] _0x783czar: gabebug: BTW thanks for the gem_binary tip, it worked!
[2012-09-17 18:06:03 -0400] mdeboard: The tutorial does some handwaving like "If you need to use Sudo, it's something with RVM" then taht's it.
[2012-09-17 18:07:29 -0400] gabebug: mdeboard: i haven't setup a new chef-repo in over a year, so i'm a bit rusty. normally it should be looking in your chef-repo/.chef/ folder
[2012-09-17 18:07:31 -0400] awgross|flashman: yfeldblum: meaning it cant track things like roles / run lists?
[2012-09-17 18:07:44 -0400] gabebug: mdeboard: i'm skimming the docs really quickly
[2012-09-17 18:07:50 -0400] yfeldblum: awarner, well roles/run-lists aren't the job of any resolver!
[2012-09-17 18:07:56 -0400] mdeboard: gabebug: Well, I'm having to use "sudo -i knife ..." so I don't know if that's hosing things
[2012-09-17 18:07:59 -0400] yfeldblum: awgross|flashman, well roles/run-lists aren't the job of any resolver!
[2012-09-17 18:08:38 -0400] gabebug: mdeboard: what happens without sudo? i'm managing chef on my workstation with rvm without using sudo
[2012-09-17 18:09:08 -0400] yfeldblum: awgross|flashman, but i mean it doesn't handle the conflicts/replaces/suggests-type dependencies, but only depends-type dependencies
[2012-09-17 18:09:21 -0400] mdeboard: gabebug: https://gist.github.com/44ec4993ea14546860ad
[2012-09-17 18:09:48 -0400] awgross|flashman: yfeldblum: ok thanks.  Looking in to ways to determine which tests I need to rerun for a given change, the librarian resolver should get me most of the way there
[2012-09-17 18:10:10 -0400] gabebug: mdeboard: did you install this with the omnibus installer or from `gem install chef`?
[2012-09-17 18:10:21 -0400] gabebug: mdeboard: also, are you running this from your workstation, or from the server?
[2012-09-17 18:10:36 -0400] mdeboard: gabebug: Omnibus, on workstation
[2012-09-17 18:13:45 -0400] gabebug: mdeboard: i think that may be the overlap issue. i only use omnibus on my servers, but use rvm (local-user install in ~/.rvm) with 'gem install chef' on my workstation. the omnibus installer comes with its own copy of ruby-1.9.2 embedded in /opt/chef/embedded/. I think when you're running it with sudo, it's discarding rvm's environment but also loses context to look in your chef-repo/.chef/ for the conf and validation keys and instead goe
[2012-09-17 18:13:45 -0400] gabebug: for the system-wide default of /etc/chef
[2012-09-17 18:14:00 -0400] mdeboard: Hm, weird.
[2012-09-17 18:14:04 -0400] gabebug: mdeboard: i'd nuke /opt/chef from your workstation and just use the rvm version instead
[2012-09-17 18:14:43 -0400] mdeboard: Ok, I'll give that a go
[2012-09-17 18:15:36 -0400] gabebug: mdeboard: rvm is also *really* persnickety with sudo in general in my experience. if you have a local ~/.rvm install of it, the sudo -i is going to load root's ~/.profile, which won't have the rvmrc sourced
[2012-09-17 18:15:58 -0400] mdeboard: I see
[2012-09-17 18:16:15 -0400] mdeboard: I'll let you know, installing the chef gem atm
[2012-09-17 18:16:54 -0400] gabebug: mdeboard: if you ever run `type rvm |head -1` and the output is not `rvm is a function` - it's not fully loaded and will have issues with gems
[2012-09-17 18:17:46 -0400] mdeboard: Huh, interesting.
[2012-09-17 18:18:04 -0400] mdeboard: There we go, seems to be working MUCH better now.
[2012-09-17 18:18:12 -0400] gabebug: it's easy to end up in this half-working state where the `rvm` command still produces output, `ruby -v` will still show your selected rvm ruby, but the environment isn't all the way working
[2012-09-17 18:18:48 -0400] mdeboard: You're making virtualenv sound amazing  by comparison
[2012-09-17 18:20:01 -0400] mdeboard: Oh man this is exciting, it's working. Thanks so much gabebug.
[2012-09-17 18:20:12 -0400] gabebug: glad to help :)
[2012-09-17 18:20:21 -0400] gabebug: i haven't gotten around to giving rbenv/rbbuild a comparison, but rvm does have its share of thorns. i've encountered issues on several occasions where it over-cached something and i had to completely nuke the entire rvm installation
[2012-09-17 18:21:03 -0400] gabebug: there's probably a more elegant solution, but around my work if there's ever a weird rvm issue, 'nuke and reinstall rvm' is high on the list of recommendations
[2012-09-17 18:22:15 -0400] mdeboard: Ha
[2012-09-17 18:24:19 -0400] gchristensen: Hi, is there a way to delete an organization?
[2012-09-17 18:27:36 -0400] jtimberman: gchristensen: in hosted chef? not exposed to end users through any UI right now, please email support@opscode.com
[2012-09-17 18:28:48 -0400] gchristensen: okay, cool. is there a way to see what the full name of an organization is based on their shortname? (to see if its been created for my org yet or not)
[2012-09-17 18:33:56 -0400] yfeldblum: gabebug, or "nuke and rebuild the VM" ^-^
[2012-09-17 18:36:25 -0400] gabebug: yfeldblum: i'm migrating our devs to vagrant+chef-solo as we speak for that purpose
[2012-09-17 18:44:27 -0400] gabebug: _0x783czar: think i found my issue. i have an older mysql cookbook that does: p = package "mysql-devel" do { action :nothing, }, p.action :install. i think that jumps it to the front of the list
[2012-09-17 18:44:53 -0400] gabebug: _0x783czar: the master isn't setup like that though, so i think my mysql cookbook is just a year out of date
[2012-09-17 18:45:15 -0400] _0x783czar: gabebug: yeah it sounded like something like that was going on
[2012-09-17 18:45:24 -0400] _0x783czar: gabebug: glad there's a newer version
[2012-09-17 18:45:57 -0400] gabebug: i found myself modifying a lot of core cookbooks when i first started, so upgrading an otherwise working cookbook is unpleasant
[2012-09-17 18:46:25 -0400] shillinm: hey, quick question about services.  Our TSM administrators are trying to pinpoint an issue that may or may not be chef related.  They have asked me to have Chef stop monitoring the dmsc service.  What would be the easiest way for me to handle this?  Change the service action to :enable in our TSM cookbook?
[2012-09-17 18:47:15 -0400] _0x783czar: gabebug: understandable
[2012-09-17 18:47:55 -0400] jdstallings1: hi all, I have been using the chef application cookbook to deploy my application for the last couple months.    I tried to do it today and ran into issue described in COOK-1661, basically provider_for_resource now takes a second "action" parameter.   Is there a quick fix that I can put in my application cookbook to get it running again?
[2012-09-17 18:49:14 -0400] gabebug: _0x783czar: https://github.com/opscode-cookbooks/mysql/commit/52522728f926fb29d2d9f6c4980d3596f01dd907#recipes/client.rb if interested. looks like it was setup like this to get the mysql gem available, but it was migrated to use a (more sensible) Gem.clear_paths instead
[2012-09-17 18:56:13 -0400] _0x783czar: gabebug: thanks!
[2012-09-17 18:57:40 -0400] mdeboard: Anyone recognize this error? https://gist.github.com/16fb9a157016bb12c716 "ERROR: Excon::Errors::SocketError: getaddrinfo: Name or service not known (SocketError)"
[2012-09-17 18:57:49 -0400] mdeboard: Using knife-ec2 to try to create instances
[2012-09-17 18:59:09 -0400] mdeboard: gabebug perhaps? :D
[2012-09-17 19:00:10 -0400] mdeboard: Er actually I was using --region when I should've been using -Z.
[2012-09-17 19:00:20 -0400] mdeboard: That said now it's telling me the keypair doesn't exist :)
[2012-09-17 19:05:54 -0400] gchristensen: I need some tylenol. is the knife.rb and validator not supposed to go into the git repo? I'm confused by how to make one repo work for multiple users. the USERNAME.pem is easy, ~/.chef/myauth.pem, but what about the username and all?
[2012-09-17 19:09:49 -0400] KarlHungus: user        = ENV['OPSCODE_USER'] || ENV['USER']
[2012-09-17 19:09:57 -0400] KarlHungus: client_key               "#{ENV['HOME']}/.chef/#{user}.pem"
[2012-09-17 19:10:04 -0400] KarlHungus: &c
[2012-09-17 19:10:27 -0400] KarlHungus: gchristensen: its just ruby...
[2012-09-17 19:11:03 -0400] gchristensen: KarlHungus: I could make it work (I know its just ruby) but Chef (and many projects I work with) have A Way to do it so other Chef users will just fall right into it.
[2012-09-17 19:11:33 -0400] gchristensen: so if that's the way to go, then I'll go ahead. I'm cool to forge ahead and do my own thing, but I'd rather stick to a Best Practice if I van
[2012-09-17 19:11:45 -0400] KarlHungus: if you dont like my advice go look at Other Projects that you do like
[2012-09-17 19:11:50 -0400] KarlHungus: =)
[2012-09-17 19:11:52 -0400] gchristensen: heh
[2012-09-17 19:12:00 -0400] gchristensen: I do like your advice, I'll go with that
[2012-09-17 19:12:17 -0400] gchristensen: I was considering sourcing ~/.chef/myproj.rb and letting them do it, but I like yours better
[2012-09-17 19:14:18 -0400] gchristensen: KarlHungus: they're not Chef projects, but they have a way of going about things is all
[2012-09-17 19:15:29 -0400] KarlHungus: i think keeping everything in the chef repo is the right way to go
[2012-09-17 19:15:51 -0400] gchristensen: agreed
[2012-09-17 19:15:51 -0400] jmartin: i dont think that is what he means
[2012-09-17 19:15:54 -0400] gchristensen: right.
[2012-09-17 19:16:25 -0400] shillinm: can someone tell me what the service resource actually does to tell if a service is running?  does it use the service <name> status command?
[2012-09-17 19:16:33 -0400] gchristensen: source ~/.chef/myproj.rb to set the user and the key location is all, but that allows for easy abuse
[2012-09-17 19:17:05 -0400] KarlHungus: gchristensen: $chef-repo/.chef/knife.rb is in the search path for knife
[2012-09-17 19:17:32 -0400] gchristensen: understood
[2012-09-17 19:18:04 -0400] shillinm: nevermind.  reading is power.
[2012-09-17 19:18:27 -0400] KarlHungus: shillinm: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/service/debian.rb
[2012-09-17 19:18:50 -0400] KarlHungus: for debian, anyhow. look at the other service providers if your OS is different
[2012-09-17 19:19:39 -0400] KarlHungus: shillinm: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/service/simple.rb#L128
[2012-09-17 19:30:49 -0400] dstine: newbie question: I installed openjdk via opscode-cookbooks/java by adding include_recipe "java" to a custom recipe
[2012-09-17 19:30:53 -0400] dstine: now I want to uninstall, but I'm not sure how.  The README mentions action :remove, but I'm not sure how to call that. any help appreciated
[2012-09-17 19:34:38 -0400] matschaffer: dstine: I think that :remove bit in the readme is for java_ark not for the runtime itself
[2012-09-17 19:36:13 -0400] matschaffer: from looking at https://github.com/opscode-cookbooks/java/blob/master/recipes/default.rb and https://github.com/opscode-cookbooks/java/blob/master/recipes/openjdk.rb, uninstallation could be a little tricky. Are you sure you need to uninstall it? I often just kill a sever and start over rather the uninstalling.
[2012-09-17 19:39:31 -0400] dstine: matschaffer: so if I install via java_ark, I can then use java_ark remove?
[2012-09-17 19:41:30 -0400] dstine: no, I don't _have_ to uninstall.  But I am trying to understand if such a thing is possible, or if start-from-scratch is "the way"
[2012-09-17 19:42:18 -0400] matschaffer: dstine: well if you installed java using something like https://github.com/opscode-cookbooks/java#examples
[2012-09-17 19:42:32 -0400] matschaffer: then you should be able to switch `action :install` to `action :remove`
[2012-09-17 19:43:23 -0400] matschaffer: but I'm unclear on exactly what java_ark even is
[2012-09-17 19:43:31 -0400] dstine: matschaffer:  okay, thank you for your help - I'll give that a try
[2012-09-17 19:43:34 -0400] matschaffer: it looks like something for handling java sub-packages, not the runtime itself
[2012-09-17 19:43:36 -0400] erikh: ark is an archiver cookbook by BryanWB
[2012-09-17 19:43:43 -0400] erikh: it's probably related to that.
[2012-09-17 19:44:40 -0400] matschaffer: dstine: if nothing else the default install_flavor is openjdk which doesn't use java_ark
[2012-09-17 19:45:08 -0400] matschaffer: looks like if you set install_flavor to oracle you might be able to use java_ark  :remove though
[2012-09-17 19:45:56 -0400] mdeboard: Where should node files (i.e. ``knife node create NODENAME``) get saved?
[2012-09-17 19:47:08 -0400] erikh: they live on the server
[2012-09-17 19:47:16 -0400] mdeboard: I see, where?
[2012-09-17 19:47:22 -0400] erikh: in couchdb.
[2012-09-17 19:47:27 -0400] mdeboard: Oh, I see, nevermind. I was confused :)
[2012-09-17 19:47:55 -0400] mdeboard: confused nodes with roles.
[2012-09-17 19:47:59 -0400] erikh: fwiw saving them to disk yields little benefit in most environments, they tend to fluctuate frequently enough that the utility of storing them has little benefit.
[2012-09-17 19:59:27 -0400] ssd7: Ohai Chefs
[2012-09-17 20:10:32 -0400] swanson: Howdy y'all.  I'm having a problem where a newly launched EC2 node gets assigned an Elastic IP address (via the 'aws' cookbook), but my Ohai reload doesn't get the EIP into the server.  If anyone is up to considering this, I've got more details....
[2012-09-17 20:12:24 -0400] awgross|flashman: swanson: why is this a big issue, is something reading ohai and getting the wrong IP?
[2012-09-17 20:13:18 -0400] swanson: awgross:  Main reason is that the bootstrap process hangs.  I get several lines past the Ohai reload, but then output just stops.
[2012-09-17 20:13:39 -0400] swanson: When I check CouchDB manually at that point, it shows no public_ipv4 -- not the original dynamic one nor the EIP.
[2012-09-17 20:13:54 -0400] swanson: (BTW, good to meet you and thanks for responding)
[2012-09-17 20:14:30 -0400] yfeldblum: swanson, checking couchdb will reveal nothing because the first chef-client run has had no chance to save its node data to the chef-server-api
[2012-09-17 20:15:18 -0400] yfeldblum: swanson, i might suggest assigning the elasticip first and bootstrapping second
[2012-09-17 20:15:38 -0400] awgross|flashman: swanson: I do it the way yfeldblum suggests
[2012-09-17 20:15:45 -0400] awgross|flashman: I have a python script that builds out a knife ec2 command
[2012-09-17 20:15:52 -0400] awgross|flashman: and reads through the output as it comes back
[2012-09-17 20:15:55 -0400] swanson: yfeldblum:  I kinda doubt that's true -- I've been watching that data and it definitely changes during the period of the run.  Right at launch time there is no record for the node, then the node appears at some point early in the bootstrap with a public_ipv4, then it is updated again at my last Ohai reload.
[2012-09-17 20:15:56 -0400] awgross|flashman: if it needs an EIP
[2012-09-17 20:16:00 -0400] awgross|flashman: it will reach out an assign one
[2012-09-17 20:16:09 -0400] awgross|flashman: while waiting watching the original command
[2012-09-17 20:16:49 -0400] swanson: Pre-assigning EIP might be an option, but does that take me out of the nice easy world of knife ec2 server create?
[2012-09-17 20:17:39 -0400] swanson: awgross -- that sounds great -- is your script published somewhere?
[2012-09-17 20:19:04 -0400] awgross|flashman: swanson: I can, gimme a sec
[2012-09-17 20:19:19 -0400] awgross|flashman: itll need some cleaning but I can walk you through the gist of it
[2012-09-17 20:19:54 -0400] yfeldblum: swanson, it's not too tough to look at the source for `knife ec2 server create`, make your own knife plugin, use mostly copy-paste but inject the elastic ip assignment in there before the bootstrap
[2012-09-17 20:19:54 -0400] swanson: I'm happy with a sketchy, semi-gutted outline -- it's the flow that interests me more than the details.
[2012-09-17 20:20:52 -0400] swanson: yfeldblum:  That's a good idea, thanks.  A custom version or mixin or something for knife ec2 could be just the ticket to take this troublesome step out of my bootstrap.  Have you done such a thing, or is this just an idea?
[2012-09-17 20:21:28 -0400] yfeldblum: swanson, https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb
[2012-09-17 20:22:00 -0400] yfeldblum: swanson, your fork of that will go in /path/to/chef-repo/.chef/plugins/knife/
[2012-09-17 20:23:58 -0400] swanson: yfeldblum:  Righto, that makes sense.  FWIW, my other idea (presently in progress) is to identify exactly where the Ohai EC2 plugin looks to identify an IP address, and modify my existing recipe so that it checks exactly that same source before moving on.  The idea is that this would avoid whatever in-between state my Ohai reload is presently capturing.  Any thoughts/opinions on this approach?
[2012-09-17 20:24:42 -0400] swanson: s/is presently capturing/presently seems to be capturing/
[2012-09-17 20:25:37 -0400] yfeldblum: swanson, forking and improving the ec2-server-create command to support the assignment of elastic ips will probably be cleaner
[2012-09-17 20:26:08 -0400] awgross|flashman: swanson https://gist.github.com/3739566
[2012-09-17 20:26:17 -0400] yfeldblum: swanson, and you might even consider contributing any improvements upstream (although that does entail signing a short CLA and navigating opscode's byzantine JIRA rules)
[2012-09-17 20:26:56 -0400] mdeboard: Where am I supposed to save the file I create when I run ``knife role create foo`` ? If I save it in chef-repo/roles/, ``knife role list`` returns none
[2012-09-17 20:27:10 -0400] swanson: awgross:  Thanks much, that looks promising!
[2012-09-17 20:27:23 -0400] mdeboard: When I finish saving the file -- which defaults to being saved in /tmp -- and the editor closes, the ``knife role ...`` process is still running, I have to C-z to kill it
[2012-09-17 20:28:03 -0400] swanson: awgross, yfeldblum:  Thanks much.  I am switching away to look at the stuff you've both pointed me to.  Wish me luck!
[2012-09-17 20:28:04 -0400] yfeldblum: mdeboard, just make a JSON file in chef-repo/roles/foo.json and edit it with your favorite editor; then you can upload it with `knife role from file foo.json`
[2012-09-17 20:28:13 -0400] mdeboard: I see.
[2012-09-17 20:28:14 -0400] yfeldblum: swanson, good luck!
[2012-09-17 20:28:46 -0400] yfeldblum: mdeboard, or make a ruby role file in chef-repo/roles/foo.rb, edit it, and then upload it with `knife role from file foo.rb`
[2012-09-17 20:29:51 -0400] mdeboard: yfeldblum: I don't understand why I'm uploading anywhere :P
[2012-09-17 20:30:31 -0400] dysinger: what's the most idiomatic way of late binding variables in a cookbook that have to read from a file templated by another cookbook? if you just say x = load_file it blows up on the first pass before the cookbook order is considered.
[2012-09-17 20:31:07 -0400] yfeldblum: mdeboard, it's how you get things in your codebase up into your chef-server-api, so that chef-clients running on servers can then be run based on that stuff
[2012-09-17 20:31:27 -0400] awgross|flashman: dysinger: id want to say create a LWRP which will get you those vars, init it with action :nothing, then signal it later
[2012-09-17 20:31:38 -0400] dysinger: I know these should be attributes - not reading a file templated by another cookbook.  It's like that for other reasons.
[2012-09-17 20:31:44 -0400] yfeldblum: mdeboard, you should keep most of your chef-repo in version-control such as git, of course, but just because you edit a file and commit it to version-control doesn't mean the chef-server-api knows about the change
[2012-09-17 20:31:51 -0400] KarlHungus: dysinger: sometimes it makes sense to append a run_Action(:create) to the resource block so it fires during compile
[2012-09-17 20:32:09 -0400] yfeldblum: dysinger, the idiomatic way is *not* to late-bind
[2012-09-17 20:32:11 -0400] dysinger: I want the opposite of that.
[2012-09-17 20:32:14 -0400] mdeboard: yfeldblum: I see
[2012-09-17 20:32:33 -0400] yfeldblum: dysinger, the kind of "late-binding" you're talking about is the non-idiomatic way to do it, and i wouldn't unless i were backed into a corner, so to speak
[2012-09-17 20:32:43 -0400] KarlHungus: dysinger: well, use the run_action call on the templated file that you're reading
[2012-09-17 20:32:59 -0400] dysinger: the corner that I'm backed into is this cookbook doesn't run & I didn't write it. :)
[2012-09-17 20:33:08 -0400] KarlHungus: what i'm describing is a great and dangerous hack though :)
[2012-09-17 20:33:15 -0400] yfeldblum: dysinger, what you want to do, instead, is do it the chef way: know all your data up front, and use that up-front data for the template in the first recipe and for the thingy you're doing in the second recipe
[2012-09-17 20:34:19 -0400] yfeldblum: dysinger, chef is a system where you start with all the data up front, and then you tell the server what to be all at once (not step by step), and then chef looks at your instructions and makes the server just so
[2012-09-17 20:34:38 -0400] dysinger: yeah I know. I was just see if there was lazy hack :)
[2012-09-17 20:34:44 -0400] dysinger: s/see/seeing
[2012-09-17 20:35:02 -0400] yfeldblum: dysinger, so what you want is to get the data up front and use it in multiple places - anything else involves fighting against chef (which is a battle you probably won't end up winning)
[2012-09-17 20:38:52 -0400] gpapilion: can I force the creation of a link using the link resource if the target doesnt exist?
[2012-09-17 20:39:54 -0400] ribo: http://tickets.opscode.com/browse/CHEF-3449 has anyone looked at this yet?
[2012-09-17 20:41:41 -0400] mdeboard: yfeldblum: This is probably a dumb question but I created a node via knife-ec2, added the role I created earlier via ``knife node run_list add``, so... what now? How do I apply the run lists in that role to an existing node?
[2012-09-17 20:42:59 -0400] yfeldblum: mdeboard, people will typically ssh into the node, become root, and run "chef-client" (or ssh into the node and run "sudo chef-client")
[2012-09-17 20:43:05 -0400] mdeboard: I see
[2012-09-17 20:43:11 -0400] mdeboard: Is there a ``knife ssh`` equiv?
[2012-09-17 20:43:32 -0400] mdeboard: I see that there is
[2012-09-17 20:43:50 -0400] yfeldblum: mdeboard, knife ssh QUERY "chef-client"
[2012-09-17 20:44:14 -0400] mdeboard: oh man this is amazing.
[2012-09-17 20:44:15 -0400] yfeldblum: QUERY might e.g. be 'name:mysql6'
[2012-09-17 20:44:48 -0400] yfeldblum: mdeboard, if you don't have DNS available to your workstation, and you need to talk to these nodes by IP address instead of by name, then it changes a bit
[2012-09-17 20:44:57 -0400] mdeboard: No that's fine, I'm using EC2
[2012-09-17 20:45:06 -0400] mdeboard: I just queried by role anyway
[2012-09-17 20:45:08 -0400] yfeldblum: mdeboard, in such a case, it's `knife ssh QUERY "chef-client" -a ipaddress`
[2012-09-17 20:45:35 -0400] jasond: why would a ruby_block occasionally execute several times during a run?
[2012-09-17 20:45:38 -0400] yfeldblum: mdeboard, `knife ssh` is really just a combination of `knife search` and ssh-in-a-loop, nothing special
[2012-09-17 20:46:20 -0400] yfeldblum: mdeboard, does a standard search, and then ssh's into each server in the search results and runs the same command on all of them
[2012-09-17 20:46:45 -0400] mdeboard: I see, awesome
[2012-09-17 20:55:21 -0400] mdeboard: yfeldblum: Why this inconsistent behavior then between `knife ssh` and `knife search` ? https://gist.github.com/25d41403ecd8ca8d0637
[2012-09-17 20:58:26 -0400] yfeldblum: mdeboard, very odd!
[2012-09-17 20:59:02 -0400] yfeldblum: mdeboard, have you already bootstrapped the node?
[2012-09-17 20:59:17 -0400] mdeboard: yeah
[2012-09-17 21:00:02 -0400] mdeboard: If I manually add the role to /etc/chef/client.rb on the client it works fine
[2012-09-17 21:00:08 -0400] mdeboard: well, "fine"
[2012-09-17 21:00:24 -0400] mdeboard: I think I'm missing some key thing about chef
[2012-09-17 21:00:37 -0400] mdeboard: too amny weird errors == I missed/am missing something
[2012-09-17 21:14:19 -0400] gpapilion: Can I force the creation of a link using the link resource if the target doesnt exist?
[2012-09-17 21:17:01 -0400] awgross|flashman: gpapilion: doesnt look like it, though you could just write an execute block to do it
[2012-09-17 21:17:28 -0400] awgross|flashman: or better yet, submit a pull request that adds a :force action to the provider
[2012-09-17 21:17:38 -0400] gyre008: anyone knows why would chef-client configured to run as daemon simply quit ?  I was checking status of the chef-client runs in WebUI and some of the nodes simply weren't running chef-client for agesI log on to the server and chef-client is not running despite it being configured to run as daemonsimply quits
[2012-09-17 21:18:04 -0400] gyre008: is there like a limit how many times chef-client can fail before it exits completely ?
[2012-09-17 21:18:29 -0400] gpapilion: alright, I'll probably do both of those.
[2012-09-17 21:19:11 -0400] awgross|flashman: gyre007: what version of ruby? I had lots of problems with segfaults on ruby 1.8.7
[2012-09-17 21:19:23 -0400] awgross|flashman: otherwise I have only seen issues where it got oom killed
[2012-09-17 21:19:24 -0400] gyre008: 1.9.3p194
[2012-09-17 21:19:33 -0400] gyre008: basically the latest stable 1.9.3 build
[2012-09-17 21:19:36 -0400] awgross|flashman: nothing in the log file?
[2012-09-17 21:19:44 -0400] gyre008: I can see some stacktraces
[2012-09-17 21:19:45 -0400] awgross|flashman:  yeah thats what  I use, no issues with that
[2012-09-17 21:19:58 -0400] gyre008: but strange thing is when I restart it and re-run it gets run without any problems
[2012-09-17 21:20:13 -0400] awgross|flashman: is the stacktrace from chef-client or from the daemon
[2012-09-17 21:20:18 -0400] awgross|flashman: cuz they should all go to that log
[2012-09-17 21:20:27 -0400] awgross|flashman: also check your syslog
[2012-09-17 21:20:29 -0400] gyre008: but the stack trace shows something like: this gist
[2012-09-17 21:20:32 -0400] gyre008: second
[2012-09-17 21:20:45 -0400] gyre008: but stack trace shouldn't make it exit
[2012-09-17 21:20:55 -0400] gyre008: from chef-client
[2012-09-17 21:21:02 -0400] awgross|flashman: depends what the error was
[2012-09-17 21:21:06 -0400] awgross|flashman: normally no, it shouldnt
[2012-09-17 21:21:15 -0400] gyre008: https://gist.github.com/3739880
[2012-09-17 21:21:41 -0400] gyre008: yeahits really damn annoying and its happening pretty much on every node after some time...
[2012-09-17 21:21:59 -0400] awgross|flashman: hmm, not sure what is going on there
[2012-09-17 21:22:06 -0400] gyre008: weird
[2012-09-17 21:22:07 -0400] awgross|flashman: that looks like a regular chef-client error
[2012-09-17 21:22:10 -0400] awgross|flashman: shouldnt kill the daemon
[2012-09-17 21:22:19 -0400] gyre008: yeah.strange
[2012-09-17 21:22:25 -0400] gyre008: hate restarting them manually
[2012-09-17 21:25:23 -0400] dougireton: Is anyone using Chefspec for cookbook testing? I don't see many cookbooks using Chefspec...
[2012-09-17 21:26:30 -0400] awgross|flashman: dougireton: I do
[2012-09-17 21:26:44 -0400] dougireton: cool
[2012-09-17 21:26:52 -0400] awgross|flashman: dougireton: but you are correct, most people do not use it
[2012-09-17 21:27:14 -0400] dougireton: but I assume Opscode won't accept Chefspec tests in their cookbooks
[2012-09-17 21:27:19 -0400] awgross|flashman: it is less useful that i'd like since chef is very declarative, so most of it just repeats the recipe
[2012-09-17 21:27:24 -0400] dougireton: hmm
[2012-09-17 21:27:25 -0400] dougireton: ok
[2012-09-17 21:27:39 -0400] awgross|flashman: I use it mostly to test any funny logic in my recipe
[2012-09-17 21:27:44 -0400] awgross|flashman: and since it also means rspec is involved
[2012-09-17 21:27:45 -0400] dougireton: so you use TestKitchen as well?
[2012-09-17 21:27:59 -0400] awgross|flashman: my libraries get rspec tests
[2012-09-17 21:28:03 -0400] awgross|flashman: not yet
[2012-09-17 21:28:09 -0400] dougireton: ok, thanks
[2012-09-17 21:28:57 -0400] awgross|flashman: but doing something similar on my own using Jenkins and EC2
[2012-09-17 21:31:29 -0400] awgross|flashman: though it is more for testing my own internal stuff, not for making sure it works across mutliple distros
[2012-09-17 21:41:11 -0400] Pushnell: can a provider action notify a different action within the same provider?  I can't seem to get my non-default action to run as a notification handler.
[2012-09-17 22:06:59 -0400] sprack: I have a noob Hosted question. How/where do I regen a user.pem?
[2012-09-17 22:08:17 -0400] ssd7: sprack: Bottom of this page https://www.opscode.com/account/password
[2012-09-17 22:08:42 -0400] mhalligan: can anyone point me at a pattern for converting data bags into hashes and using their content inside of erbs?
[2012-09-17 22:09:08 -0400] sprack: ssd7: thank you.
[2012-09-17 22:16:41 -0400] Pushnell: what version of ruby should I have for the latest chef?
[2012-09-17 22:17:54 -0400] ssd7: Pushnell: You'll have the best experiencing with Ruby 1.9.2 or better.
[2012-09-17 22:18:25 -0400] ssd7: Pushnell: Ruby 1.8.7 is supported if needed, but doesn't perform as well.
[2012-09-17 22:19:20 -0400] Pushnell: ssd7: yeah, rhel6 is still on 1.8.7
[2012-09-17 22:19:52 -0400] ssd7: Pushnell: If you use the omnibus installer for chef-client we package a new version of ruby and rubygems for use by Chef
[2012-09-17 22:21:00 -0400] ribo: I opened this up on Thursday, was wondering if someone could take a look at it: http://tickets.opscode.com/browse/CHEF-3449
[2012-09-17 22:22:41 -0400] ssd7: ribo: We discussed that at code review today.  We think it might be related to other regressions in the deploy provider that we will be investigating this week.  We'll update it ocne we know a bit more.
[2012-09-17 22:24:47 -0400] ribo: ssd7: ok cool, thanks
[2012-09-17 22:25:18 -0400] ribo: I dug through the provider git log for a while and couldn't find anything, heh
[2012-09-17 22:47:42 -0400] miah: sup
[2012-09-17 22:47:58 -0400] erikh: yo
[2012-09-17 22:48:17 -0400] PRK_nz: Hi, we're having trouble with one of our chef servers (don't ask why we have two). It's version 0.10.6, and couchdb keeps dying and requires (re)starting. The only thing we've found in the couchdb log is lots of these:
[2012-09-17 22:48:41 -0400] PRK_nz: [Mon, 17 Sep 2012 22:20:38 GMT] [info] [<0.668.0>] OS Process #Port<0.5099> Log :: function raised exception (new TypeError("doc.attributes has no properties", "", 3)) with doc._id <some_id_hash>
[2012-09-17 22:51:34 -0400] PRK_nz: FYI: we do run chef-server on the server to compact couchdb
[2012-09-17 22:52:21 -0400] erikh: did you run out of space?
[2012-09-17 22:55:12 -0400] PRK_nz: erikh: me? yes, but currently not a problem
[2012-09-17 23:11:53 -0400] Pushnell: anyone have an example of a provider which notifies itself for a different action?
[2012-09-17 23:22:31 -0400] hashpuppy_: are you supposed to check in .chef to version control?  the directory in my chef-repos that contains my pem keys, etc
[2012-09-17 23:22:58 -0400] erikh: I don't, and you probably shouldn't if you plan to share the repository with others.
[2012-09-17 23:23:15 -0400] hashpuppy_: makes sense.  thanks
[2012-09-17 23:31:10 -0400] hashpuppy_: also, let's say i have an mywebapp1 with an nginx recipe (sites-available VH stuff) and myotherwebapp2 with an nginx recipe (sites-available VH stuff).  both are going on the same server.  where should i put the main nginx recipe and install?  create a mycompany-web role and run list?
[2012-09-17 23:34:14 -0400] awgross|flashman: Pushnell: can yo give an example?
[2012-09-17 23:40:02 -0400] hashpuppy_: looking at this article and it says "Here role[hulu-common] is the common set of recipes that run on all Hulu machines, and contains basic settings such as user accounts and NTP configuration."  does that mean hulu-common is like a cookbook, created with knife cookbook create hulu-common -o ./
[2012-09-17 23:45:54 -0400] cheeseplus: hashpuppy_: a role can have it's own run_lists
[2012-09-17 23:46:09 -0400] hashpuppy_: ahh.  ok.
[2012-09-17 23:46:20 -0400] cheeseplus: hashpuppy_: typically you create a role from a json or ruby file
[2012-09-17 23:46:36 -0400] cheeseplus: "knife role create from file role.rb"
[2012-09-17 23:47:09 -0400] cheeseplus: it can have several recipes and run lists, as well as attributes attached to it that either merge with or override default attributes
[2012-09-17 23:47:22 -0400] Pushnell: awgross|flashman: http://pastebin.com/7VKbgpBN
[2012-09-17 23:48:00 -0400] Pushnell: awgross|flashman: I have a resource/provider called co_zendsite which configures any of our many websites based on the zend platform.  each website gets a databag with svn details, etc.
[2012-09-17 23:49:11 -0400] Pushnell: awgross|flashman: each site has some apache config .erb files stored in the svn repo, and under various circumstances I need to rebuild those templates.  But I also need to build them for the initial deploy.
[2012-09-17 23:50:12 -0400] Pushnell: awgross|flashman: I was trying to get my :deploy provider action to also trigger the :run_templates action.
[2012-09-17 23:54:23 -0400] hashpuppy_: cheeseplus: thanks :)
[2012-09-17 23:55:16 -0400] cheeseplus: hashpuppy_: np
[2012-09-17 23:58:07 -0400] awgross|flashman: Pushnell: ok I see what you are trying to do
[2012-09-17 23:58:35 -0400] awgross|flashman: not sure if that has been done, never come across it myself
[2012-09-17 23:59:19 -0400] Pushnell: awgross|flashman: I could put the responsibility on the caller to do action [:deploy, :run_templates] but a deploy will always include the run_templates so I wanted that to be implied
