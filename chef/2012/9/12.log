[2012-09-12 00:21:37 -0400] makerbreaker: how do i knife ssh to just one host, based on ip?
[2012-09-12 00:21:42 -0400] makerbreaker: i cant figure out the syntax
[2012-09-12 00:33:30 -0400] jessicab: makerbreaker: seems like you could with the ip_address attribute? like knife ssh "ip_address:0.0.0.0" "command"
[2012-09-12 00:34:06 -0400] makerbreaker: is it ip_address, or ipaddress?
[2012-09-12 00:34:17 -0400] makerbreaker: (either way, that doenst work"
[2012-09-12 00:34:23 -0400] hoover_damm: ipaddress
[2012-09-12 00:36:33 -0400] makerbreaker: that looks up the right node, based on ip
[2012-09-12 00:36:57 -0400] makerbreaker: hrm..one sec
[2012-09-12 00:37:00 -0400] hoover_damm: knife ssh ipaddress:10.0.0.1
[2012-09-12 00:37:10 -0400] hoover_damm: i guess
[2012-09-12 00:37:14 -0400] hoover_damm: but i don't use knife ssh
[2012-09-12 00:37:17 -0400] hoover_damm: <-- fabric user here
[2012-09-12 00:37:31 -0400] makerbreaker: you have to specify -a ipaddress
[2012-09-12 00:37:37 -0400] makerbreaker: literally, the word
[2012-09-12 00:37:47 -0400] makerbreaker: then ipaddres:111.123.232.222
[2012-09-12 00:37:50 -0400] jessicab: ah sorry, i always forget which have underscores and which dont
[2012-09-12 00:37:51 -0400] hoover_damm: makerbreaker, that's set in my .chef/knife.rb
[2012-09-12 00:38:06 -0400] hoover_damm: makerbreaker, knife[:ssh_attribute]
[2012-09-12 00:38:11 -0400] hoover_damm: you don't have to supply -a
[2012-09-12 00:38:17 -0400] makerbreaker: ah
[2012-09-12 00:38:27 -0400] hoover_damm: jessicab, tell me abou tit... _'s and .'s and
[2012-09-12 00:38:42 -0400] hoover_damm: jessicab, I imagine there's a wall on opscode with nothing but _'s and .'s on it.
[2012-09-12 00:38:51 -0400] jessicab: haha
[2012-09-12 00:43:51 -0400] paulmooring: hoover_damm: where do you run into .'s?
[2012-09-12 00:49:20 -0400] hoover_damm: paulmooring, I don't actually but I get silly sometimes and think it's ec2. instead of ec_
[2012-09-12 00:49:23 -0400] hoover_damm: ec2_
[2012-09-12 00:49:39 -0400] paulmooring: ah that makes sense
[2012-09-12 01:05:25 -0400] ryker: hi all.  does anyone know how I can use knife search node to search for a particular value in a node attribute that is an array?
[2012-09-12 01:05:49 -0400] ryker: for example, I have crontabs_root_crons where crons is an array of cron jobs.
[2012-09-12 01:06:42 -0400] ryker: knife node search "crontabs_root_crons:*" returns a list of all nodes with anything in the crontab as expected.
[2012-09-12 01:09:44 -0400] ryker: looking at the chef/search wiki page, the syntax seems to indicate I can use something like: knife node search "crontabs_root_crons:*reboot*" to find any nodes that have the word 'reboot' in one of the crons in the array of cron jobs.
[2012-09-12 01:09:50 -0400] ryker: but that always returns 0 results for me
[2012-09-12 01:21:48 -0400] Pushnell: anyone know the right way to handle boolean attributes?  'true' ?
[2012-09-12 01:25:05 -0400] flaccid__: Pushnell: why can't you handle them?
[2012-09-12 01:31:25 -0400] Pushnell: apparently raw booleans don't work, but =='true' seems icky.
[2012-09-12 01:31:49 -0400] juliancdunn: Pushnell: why don't they work
[2012-09-12 01:31:54 -0400] flaccid__: its ruby, they work
[2012-09-12 01:31:58 -0400] juliancdunn: if node[:whatever][:blah] do
[2012-09-12 01:36:14 -0400] Pushnell: hrm  I was getting an error about "can't convert Symbol into String" but I just tried it again now and it's working.
[2012-09-12 01:36:29 -0400] Pushnell: *shrug*  thanks
[2012-09-12 01:36:52 -0400] Pushnell: perhaps that was a vagrant misconfig
[2012-09-12 01:46:08 -0400] flaccid__: sounds about right
[2012-09-12 01:51:24 -0400] williamherry: chef-solr can't start correctly, it only listen on :::8983, here is all log, some one can help https://gist.github.com/3703668
[2012-09-12 02:03:19 -0400] hoover_damm: williamherry, http://docs.oracle.com/javase/6/docs/api/java/security/SecureRandom.html
[2012-09-12 02:03:25 -0400] hoover_damm: williamherry, what kinda java do you got here sir?
[2012-09-12 02:04:00 -0400] hoover_damm: looks like a sun varient which is good
[2012-09-12 02:05:08 -0400] williamherry: hoover_damm, http://blog.frameos.org/2011/05/19/installing-chef-server-0-10-in-rhel-6-scientificlinux-6/ I follow this to setup chef server
[2012-09-12 02:06:21 -0400] hoover_damm: williamherry, java -version
[2012-09-12 02:06:33 -0400] hoover_damm: williamherry, that blog post doesn't help me
[2012-09-12 02:07:12 -0400] williamherry: hoover_damm, 1.6.0_24
[2012-09-12 02:07:21 -0400] williamherry: do you want full output?
[2012-09-12 02:07:34 -0400] hoover_damm: nah
[2012-09-12 02:08:34 -0400] hoover_damm: williamherry, slightly dated... you prolly need to do rpm -qa | grep java to figure out what jre you have or jdk
[2012-09-12 02:08:53 -0400] hoover_damm: williamherry, but it doesnt sound like your java is fully installed as those are functions it's failing on that are java core functions
[2012-09-12 02:09:16 -0400] hoover_damm: i can't say for sure other then java's not right
[2012-09-12 02:09:20 -0400] williamherry: hoover_damm, you mean my java is corrupted?
[2012-09-12 02:10:06 -0400] hoover_damm: williamherry, dunno that is your job (hopefully) to figure out
[2012-09-12 02:10:28 -0400] hoover_damm: if this is an ec2 instance you can try other variations of the ami and maybe one works
[2012-09-12 02:10:45 -0400] hoover_damm: but those were added in java 5
[2012-09-12 02:10:52 -0400] hoover_damm: your running java 6 _24
[2012-09-12 02:10:58 -0400] hoover_damm: you should have it
[2012-09-12 02:11:06 -0400] williamherry: hoover_damm, ok, thanks for help
[2012-09-12 02:15:01 -0400] Pushnell: Hey all.  Really noob question, but I have a webserver role and a dbserver role.  If I want to deploy both roles to the same node for a dev environment, how do I make my webserver role aware that it needs to connect to itself?  (How do I write the webserver role to know that this node also is a dbserver?)
[2012-09-12 02:15:57 -0400] Pushnell: This is in chef-solo (vagrant) so I can't just use environments
[2012-09-12 02:30:41 -0400] josephholsten: Pushnell: have an attribute with the dbserver's IP, which would just be 127.0.0.1 in dev, but something else in prod
[2012-09-12 02:32:57 -0400] Pushnell: josephholsten: of course, that makes perfect sense.  Thanks.
[2012-09-12 04:31:05 -0400] ssd7: Ohai Chefs
[2012-09-12 04:34:57 -0400] v1n3: Howdy. I'm seeking advice on best practices for a simple sinatra app
[2012-09-12 04:35:15 -0400] v1n3: Such things as how to run bundle install, etc
[2012-09-12 04:35:52 -0400] v1n3: Anyone willing to help guide a n00b?
[2012-09-12 04:59:29 -0400] ssd7: v1n3: Unfortunately I haven't done much with sinatra+chef
[2012-09-12 05:15:51 -0400] BryanWB: danryan, was thinking more about mastermind yesterday
[2012-09-12 05:16:33 -0400] BryanWB: i realized that mastermind in its current "masterful" mode requires redis and postgres
[2012-09-12 05:17:22 -0400] BryanWB: would be sweet to have a simpler mode as well that only requires the mastermind gem for when working w/ vagrant to spin up couple vms locally
[2012-09-12 05:17:30 -0400] BryanWB: just my $0.02
[2012-09-12 05:19:39 -0400] miah: what is mastermind?
[2012-09-12 05:20:59 -0400] BryanWB: miah https://github.com/danryan/mastermind
[2012-09-12 05:27:24 -0400] miah: interesting
[2012-09-12 06:07:34 -0400] williamherry: quick question, what releation between Chef and RightScale?
[2012-09-12 06:10:33 -0400] senthilr: later uses the former
[2012-09-12 06:12:24 -0400] flaccid: williamherry: RightScale uses Chef and has a relationship
[2012-09-12 06:13:03 -0400] williamherry: oh, thx
[2012-09-12 06:13:12 -0400] flaccid: not quite sure what you are asking
[2012-09-12 06:13:16 -0400] flaccid: i work at RightScale
[2012-09-12 06:56:51 -0400] nickesh: hey, a basic question, i run command  * yum install java * , here i want to know where it installed java packages
[2012-09-12 06:58:12 -0400] flaccid: nickesh: there is a java cookbook and the package resource. the usual yum commands will show you what the package provided
[2012-09-12 07:00:33 -0400] nickesh: flaccid: i didn't get you
[2012-09-12 07:03:13 -0400] flaccid: nickesh: what part didn't you get?
[2012-09-12 07:04:00 -0400] flaccid: rpm command will show you the pkg file contents
[2012-09-12 07:04:24 -0400] nickesh: i just want to know, what is the directory yum installs packages in
[2012-09-12 07:04:55 -0400] flaccid: thats dependent on the platform and package and repos used; this isn't a chef question
[2012-09-12 07:05:39 -0400] flaccid: technically its / and the relevent dirs per man hier
[2012-09-12 07:07:00 -0400] nickesh: is there any way to find out the directory...
[2012-09-12 07:08:48 -0400] zts: nickesh: rpm -ql <packagename>  - that will list out all the files installed by the package
[2012-09-12 07:09:13 -0400] zts: nickesh: but yeah, for those kind of questions you're probably better off asking in a channel for centos/fedora/redhat etc
[2012-09-12 07:17:06 -0400] flaccid: aka rtfm :)
[2012-09-12 07:41:24 -0400] zts: flaccid: to be fair, the rpm manpage is a decent reference, but it's not especially intelligible to new users.  Particularly those who have only ever used RPM by way of yum.
[2012-09-12 07:42:14 -0400] flaccid: this is true, though i don't think its unreasonable to expect users to be able to use a package manager before chef
[2012-09-12 07:45:17 -0400] zts: I don't think it's unreasonable to expect that most users will come to Chef with a fair grasp of package management, but I personally don't think it should be a firm requirement.
[2012-09-12 07:45:29 -0400] zts: Chef's target audience is (or should be) folks who want to do system administration the right way
[2012-09-12 07:45:57 -0400] zts: that population is going to include people who are pretty new to system administration, and haven't yet had a chance to get to grips with everything we take for granted
[2012-09-12 07:46:15 -0400] zts: And they have my sympathy, because that's bound to make debugging things a whole lot harder than it is for me :)
[2012-09-12 07:49:41 -0400] flaccid: that is true, going from the other way; i respect your point
[2012-09-12 08:04:08 -0400] benner: hi
[2012-09-12 08:08:00 -0400] benner: how to remove colors from knife status? knife status <query> --no-color does not work
[2012-09-12 08:10:29 -0400] zts: benner: that was a bug - if you upgrade to 10.14.2, it should work (see http://www.opscode.com/blog/2012/09/11/chef-10-14-2-released/ )
[2012-09-12 08:25:01 -0400] benner: zts: thanks
[2012-09-12 08:35:00 -0400] benner: it seems bug in 10.14.2 too. only tty is checking and disabling colors. --no-color isnt working...
[2012-09-12 10:29:26 -0400] chaos: hi
[2012-09-12 10:29:43 -0400] chaos: Is it possible to access node attributes from cookbook library?
[2012-09-12 11:27:37 -0400] DigitalFlux: Just got hit by a weird error when registering a new node
[2012-09-12 11:27:41 -0400] DigitalFlux: NameError: undefined local variable or method `e' for #<Chef::Formatters::ErrorInspectors::RegistrationErrorInspector:0x000000022c7818>
[2012-09-12 11:27:43 -0400] DigitalFlux: Any hints ?
[2012-09-12 11:38:52 -0400] gyre007: anyone knows how to get the application_nginx load balancer to work with SSL ?
[2012-09-12 11:39:00 -0400] gyre007: im banging my head against the table :)
[2012-09-12 11:47:01 -0400] nickesh: hey, i am running a java's recipe on a remote machine using ssh connection but i am getting an error.. * Failed to extract file jdk-6u31-linux-i586.bin! *,
[2012-09-12 11:47:38 -0400] nickesh: when i run same on my local computer it does not complain..
[2012-09-12 11:48:08 -0400] nickesh: i went through internet but it didn't help
[2012-09-12 12:20:33 -0400] alex88: hi guys, i'm trying to configure knife on my workstation, but i get this http://pastie.org/4707576
[2012-09-12 13:14:32 -0400] jwitrick1: general question. I have never seen any cookbook use 'begin/rescue' blocks in cookbooks. Is this a smart practice?
[2012-09-12 13:17:46 -0400] geekbri: jwitrick1: its smart if you have an exception you need to catch or you need to run an ensure block!
[2012-09-12 13:17:54 -0400] geekbri: jwitrick1: I use rescue in my recipes when its warranted.
[2012-09-12 13:18:53 -0400] jwitrick1: I agree with using them, but using them for conditional logic seems wrong. i.e. The recipe should do one thing, and not relay on the rescue blocks to change the behavior of the recipe
[2012-09-12 13:37:16 -0400] RobbieAB: How safe is it to run a chef client against an older chef server?
[2012-09-12 13:38:57 -0400] RobbieAB: jwitrick1: We have code where we need the try/rescue because we don't want chef to abort because a specific recipe (or section of recipe) broke.
[2012-09-12 13:40:06 -0400] jwitrick1: Makes sense. I am more worried about people using the block to say 'if data bag X does not exist I should use values from either attributes or hard coded' and in my opinion that leads to mistakes and incorrect values being using production environments
[2012-09-12 13:40:57 -0400] RobbieAB: That depends... I agree it can lead to problems, but... If users are stupid, we can't save them from themselves.
[2012-09-12 13:41:43 -0400] jwitrick1: true, but building for stupid users is what leads to more issues. I know for myself i would rather have use chef and call a fatal exception and stop the recipe
[2012-09-12 13:43:13 -0400] richoid: So anyone have chef-client successfully installed on a Citrix XenServer?
[2012-09-12 13:45:46 -0400] uncommitted: I've got it on an open source xen server :)
[2012-09-12 13:46:27 -0400] uncommitted: just finished a cookbook that sets all the guests up via data bags too, kind of happy about it actually
[2012-09-12 13:48:26 -0400] uncommitted: not familiar with the citrix xen server vs regular xen, but if it uses a role.d I'm happy to send that to you
[2012-09-12 13:54:17 -0400] uncommitted: richoid: Here ya go: http://pastebin.com/LqJY3kkN
[2012-09-12 13:55:07 -0400] MattJ: Any suggestions on how to, ideally in a recipe, execute something right at the end of the chef-client run?
[2012-09-12 13:55:30 -0400] MattJ: Or specifically, I want to remove client.pem as soon as chef-client exits (is there a cleaner way to do that?)
[2012-09-12 13:55:55 -0400] alex88: I'm trying to create a cookbook, i'm in ~/chef-repo and i have ~/chef-repo/.chef/knife.rb set correctly and running "knife cookbook create NAME" gives ERROR: Errno::EACCES: Permission denied - /var/chef
[2012-09-12 13:55:59 -0400] richoid: hmm, that doesn't help much, I get error with rpm dependencies with the omnibus installer...
[2012-09-12 13:56:04 -0400] laurent\: MattJ: https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/delete_validation.rb ?
[2012-09-12 13:56:07 -0400] alex88: why isn't it trying to write into ~/chef-repo/cookbooks?
[2012-09-12 13:56:37 -0400] richoid: I was hoping to get omnibus installer to work since it's all embedded
[2012-09-12 13:56:48 -0400] laurent\: oh, it's client.pem you want to remove
[2012-09-12 13:57:01 -0400] MattJ: laurent\, close, but not quite - I actually want to delete client.pem, and leave validation.pem alone
[2012-09-12 13:57:16 -0400] MattJ: and that means it must be done after everything else
[2012-09-12 13:57:18 -0400] richoid: I get these errors:  rpmlib(FileDigests) <= 4.6.0-1 is needed by chef-10.12.0-1.el6.i686  and rpmlib(PayloadIsXz) <= 5.2-1 is needed by chef-10.12.0-1.el6.i686
[2012-09-12 13:59:22 -0400] laurent\: MattJ: i don't know if its content is cached between the first and last connection to the server. It might fails when connecting to chef-server to save the state of the node
[2012-09-12 13:59:54 -0400] laurent\: anyway, what would be the purpose of doing that ? (keeping validation and removing client.pem at the end of every run)
[2012-09-12 14:00:38 -0400] MattJ: laurent\, the server is shut down immediately after, and imaged - the image may be re-used. It needs to generate a new client.pem when the image is re-launched.
[2012-09-12 14:01:15 -0400] laurent\: i wouldn't image my validation.pem :)
[2012-09-12 14:01:42 -0400] laurent\: i'd rather add some post image install hooks
[2012-09-12 14:01:52 -0400] MattJ: Could do that I suppose
[2012-09-12 14:09:46 -0400] oliphox: hi all. i'm using chef to manage my firewall rules (shorewall). is it possible to append rules to the firewall rather than having a new set? if i have "default_attributes("firewall" => {"rules" => ["ACCEPT pub loc tcp 8080"]})" in a new recipe, the previous rules are removed.
[2012-09-12 14:13:44 -0400] CharlieSu: Anyone know of a good recipe for changing a hostname on a Ubuntu Box?
[2012-09-12 14:15:46 -0400] laurent\: changing the hostname and renaming the node name on the chef server ? :)
[2012-09-12 14:16:22 -0400] laurent\: also renaming the client and recreating the client.pem ? :)
[2012-09-12 14:17:02 -0400] CharlieSu: I'm only trying to change the hostname of clients.. not the server..
[2012-09-12 14:18:29 -0400] laurent\: still, you'll have to report these changes on the server
[2012-09-12 14:19:55 -0400] erikh: changing the unix host name or the chef client name?
[2012-09-12 14:20:03 -0400] laurent\: both
[2012-09-12 14:20:16 -0400] laurent\: and the chef node name as well
[2012-09-12 14:20:17 -0400] erikh: mmm.... have fun with the latter.
[2012-09-12 14:20:32 -0400] laurent\: new chef client name means new client.pem key
[2012-09-12 14:20:53 -0400] CharlieSu: new hostname on box doesn't mean new client.pem does it?
[2012-09-12 14:21:08 -0400] laurent\: pretty sure it's doable, i'm doing that by hand when needed
[2012-09-12 14:21:17 -0400] laurent\: so i really try not to rename host :)
[2012-09-12 14:21:39 -0400] laurent\: CharlieSu: i'm afraid it does
[2012-09-12 14:27:03 -0400] bencaron: is there a way to specify the temp directory to save rendered template in solo.rb?
[2012-09-12 14:27:29 -0400] bencaron: in a windows setup...
[2012-09-12 14:27:40 -0400] awgross|flashman: it really is a pain to switch the client name once it is already running
[2012-09-12 14:27:58 -0400] bencaron: I get template that try to render in c:/chef-rendered-template20120912-1616-182uukx
[2012-09-12 14:28:06 -0400] wickett: chef and private github question
[2012-09-12 14:28:14 -0400] awgross|flashman: i have a script that will take a desired hostname and pass it to knife so it gets registered properly, then a corresponding recipe will update the hostname based off the client name
[2012-09-12 14:28:33 -0400] wickett: is this the recommended way to do private github  deploys: http://wiki.opscode.com/display/Chef/Deploy+Resource#DeployResource-PrivateDeployExample
[2012-09-12 14:28:36 -0400] awgross|flashman: bencaron: yes, I believe there is
[2012-09-12 14:28:50 -0400] bencaron: I'm looking in the wiki, can't find
[2012-09-12 14:29:03 -0400] bencaron: even in chef::config code, I see no reference to tempfiles
[2012-09-12 14:29:19 -0400] bencaron: it calls ruby's tempfile / tmpdir
[2012-09-12 14:29:28 -0400] awgross|flashman: wickett: Pretty much the way I do it, check out http://tech.yipit.com/2012/09/05/deploying-from-github-the-right-way/
[2012-09-12 14:29:39 -0400] awgross|flashman: wickett: we wrote up how we do it with some alternatives
[2012-09-12 14:29:56 -0400] awgross|flashman: the thread on hackernews also had some good points about using ssh_config
[2012-09-12 14:30:13 -0400] awgross|flashman: bencaron: hmm it may only be for cache files then, not temp ones
[2012-09-12 14:30:18 -0400] wickett: awgross|flashman: are using the application cookbook?
[2012-09-12 14:30:26 -0400] bencaron: I guess I'm better trying go force a proper value for TEMP
[2012-09-12 14:30:45 -0400] awgross|flashman: wickett: which cookbook?
[2012-09-12 14:31:16 -0400] wickett: "application"
[2012-09-12 14:31:24 -0400] awgross|flashman: i guess not
[2012-09-12 14:31:31 -0400] bencaron: tmpdir.rb defaults to /tmp ; i'm curious to understand how it ends up in C: itself
[2012-09-12 14:31:41 -0400] bencaron: anyway, thx awgross|las
[2012-09-12 14:31:44 -0400] wickett: I see refs to it in the doc... there is an odd statement in the wiki doc... let me find it
[2012-09-12 14:32:20 -0400] awgross|flashman: bencaron: prob some chef windows shenanigans, there is much deep magic within
[2012-09-12 14:32:21 -0400] wickett: awgross|flashman: "To deploy from a private git repo without using the application cookbook, you'll need to add your private key to the node and use an SSH wrapper."
[2012-09-12 14:32:42 -0400] bencaron: awgross|flas: fits my experience :)
[2012-09-12 14:33:27 -0400] bencaron: awgross|flashman: just realized my irc client chops part of your nick
[2012-09-12 14:34:25 -0400] awgross|flashman: wickett: ahh this is what they mean http://community.opscode.com/cookbooks/application
[2012-09-12 14:34:46 -0400] awgross|flashman: bencaron: no problem, its long and has a weird character
[2012-09-12 14:35:03 -0400] awgross|flashman: wickett: I do not use that cookbook
[2012-09-12 14:41:13 -0400] wickett: awgross|flashman: ok, I was hoping to not use that either
[2012-09-12 14:42:33 -0400] wickett: I keep getting symlink errors for ./config/databse.yml using the instructions on the wiki page > http://wiki.opscode.com/display/Chef/Deploy+Resource#DeployResource-PrivateDeployExample
[2012-09-12 14:43:04 -0400] wickett: this isnt a Rails app so I have no idea why it tries to symlink that
[2012-09-12 14:47:08 -0400] awgross|flashman: wickett: not sure, when using the deploy resource I just explicitly call the `git` block instead of the generic deploy
[2012-09-12 14:47:24 -0400] wickett: ah really
[2012-09-12 14:47:25 -0400] wickett: ?
[2012-09-12 14:47:28 -0400] wickett: interesting
[2012-09-12 14:48:27 -0400] awgross|flashman: similar to this
[2012-09-12 14:48:27 -0400] awgross|flashman: https://gist.github.com/3707137
[2012-09-12 14:48:34 -0400] awgross|flashman: after having the ssh key/wrapper set up
[2012-09-12 14:48:47 -0400] wickett: nice
[2012-09-12 14:48:50 -0400] wickett: I have the wrapper
[2012-09-12 14:49:00 -0400] wickett: let me try that out
[2012-09-12 14:50:32 -0400] Eulipion: is anyone else having issues with the users cookbook creating homedirs owned by root:root ?
[2012-09-12 14:54:13 -0400] awgross|flashman: its not a bug, its a feature
[2012-09-12 14:54:19 -0400] awgross|flashman: what version of chef Eulipion
[2012-09-12 14:54:31 -0400] Eulipion: 10.14.1
[2012-09-12 14:55:10 -0400] awgross|flashman: my guess would be a regression in 10.14
[2012-09-12 14:55:17 -0400] awgross|flashman: can you reproduce it with 10.12?
[2012-09-12 14:55:48 -0400] Eulipion: hmm.  i can build a 10.12 gem and try
[2012-09-12 14:56:18 -0400] awgross|flashman: also, check outhttp://tickets.opscode.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+CHEF+AND+fixVersion+%3D+%2210.14.2%22+AND+status+%3D+Closed+ORDER+BY+priority+DESC&mode=hide
[2012-09-12 14:56:25 -0400] awgross|flashman: listing of bugs fixed in 10.14.2
[2012-09-12 14:56:30 -0400] awgross|flashman: a few user resource issues
[2012-09-12 14:57:50 -0400] Eulipion: similar issues, 10.14.1 fixed chef-3429 for me
[2012-09-12 14:58:12 -0400] alex88: hi guys, http://wiki.opscode.com/display/chef/Data+Bags it's written to save the private key for git deployments into a data bag, but what after that?
[2012-09-12 15:05:41 -0400] DigitalFlux: Guys, Anybody facing issues with node registerations on Chef 10.14.2 ?
[2012-09-12 15:05:50 -0400] DigitalFlux: I am having error messages like "NameError: undefined local variable or method `e' for #<Chef::Formatters::ErrorInspectors::RegistrationErrorInspector:0x000000022c7818>"
[2012-09-12 15:05:55 -0400] DigitalFlux: Any ideas what is wrong ?
[2012-09-12 15:10:56 -0400] alex88: i got this Chef::Exceptions::InvalidDataBagPath: Data bag path '/var/chef/data_bags' is invalid but in knife.rb i've set data_bag_path            '~/chef-repo/data_bags'
[2012-09-12 15:10:59 -0400] alex88: what's wrong with that?
[2012-09-12 15:11:45 -0400] alex88: what's wrong with that?
[2012-09-12 15:11:53 -0400] alex88: sry for double posting, wrong alt-tab :)
[2012-09-12 15:17:46 -0400] awgross|flashman: alex88: how sure are you that it is using the correct knife RB, try forcing it with -c ./path/to/knife.rb
[2012-09-12 15:20:04 -0400] alex88: awgross|flashman: because before it was giving the error with cookbook path, then i've added it and it works..but let me try
[2012-09-12 15:20:24 -0400] alex88: oh, sorry, it's a vagrant problem :/
[2012-09-12 15:20:45 -0400] awgross|flashman: hehe np
[2012-09-12 15:21:36 -0400] alex88: hate to stop on such stupid problems..
[2012-09-12 15:26:25 -0400] alex88: awgross|flashman: last thing, i've created a data bag folder called project, then added a deploy_settings.json file, with and id and deploy_key inside, i've tried to project = data_bag('project')
[2012-09-12 15:26:35 -0400] alex88: and then project['deploy_settings']['deploy_key']
[2012-09-12 15:26:40 -0400] alex88: in the recipe
[2012-09-12 15:26:50 -0400] alex88: but i get can't convert String into Integer
[2012-09-12 15:27:07 -0400] richoid: So omnibus installer works on Citrix XenServer 5.6 SP2, but not for 6.0.2...
[2012-09-12 15:28:46 -0400] awgross|flashman: alex88: looks like your are off by one in your calling of the data bag
[2012-09-12 15:28:58 -0400] awgross|flashman: it seems to be trying to index into a list using one of those strings
[2012-09-12 15:29:08 -0400] alex88: yeah, that's my idea
[2012-09-12 15:29:46 -0400] alex88: i mean, it seems that :)
[2012-09-12 15:30:10 -0400] awgross|flashman: deploy_key = data_bag_item('deploy_settings', 'deploy_key')
[2012-09-12 15:30:18 -0400] awgross|flashman: how I access one in my recipe
[2012-09-12 15:30:34 -0400] awgross|flashman: been a while I played around with that though
[2012-09-12 15:31:18 -0400] alex88: awgross|flashman: but deploy_settings is the json file? you don't have to first select the folder in some way?
[2012-09-12 15:33:45 -0400] awgross|flashman: alex88: oh sorry, im using mine with chef server, let me ponder how to I did it on chef solo w/ vagrant
[2012-09-12 15:38:25 -0400] alex88: awgross|flashman: don't worry man
[2012-09-12 15:38:32 -0400] alex88: finished work time :) so, maybe cya tomorrow :)
[2012-09-12 15:38:35 -0400] alex88: thanks anyway ;)
[2012-09-12 15:46:30 -0400] Pushnell: So we have dozens of sites with similar config.  I have a recipe for these sites along with a "websites" databag, with each site having an item.  Are there any convenience methods to apply the entire data_bag_item hash to my node attributes but without overwriting any attributes which might have been set by a role?
[2012-09-12 16:10:37 -0400] gyre007: im trying to figure out how to distinguish whether a host is in the cloud or local...we are using Rackspace for our servers so I guess there has to be a way how to tell whether the host is in the cloud....but i just can't figure it out
[2012-09-12 16:16:46 -0400] Zenigor: I'm having a problem where I am bootstrapping a registering a new rackspace server to my hosted chef. It registers the new client.pem then expands the runlist. It then fails with: INFO: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
[2012-09-12 16:26:44 -0400] erikh: whoever put together the ubuntu packages for the chef server
[2012-09-12 16:26:47 -0400] erikh: <3
[2012-09-12 16:29:34 -0400] awgross|flashman: gyre007: check out how the knife bootstrap does server identification / hints you can set for it
[2012-09-12 16:29:44 -0400] awgross|flashman: gyre007: should give you a good idea of ways to fingerprint them
[2012-09-12 16:30:16 -0400] awgross|flashman: Has anyone used chef minitest with jenkins for testing cookbooks?
[2012-09-12 16:30:25 -0400] awgross|flashman: trying to figure out how to get the jUnit report back
[2012-09-12 16:30:52 -0400] jonesy: not sure how to handle this: I'm building a cookbook for Sentry (http://getsentry.com). It uses a signing token, and I have a function that generates one in sentry/libraries/core.rb. I'd like to put a placeholder signing token in sentry/attributes/sentry.rb that people can do what they want with, and only reference my library function outside of the recipe itself. Is there a way to do that?
[2012-09-12 16:31:29 -0400] jonesy: basically, I want to create a generic recipe others can use in the community, but account for the site-specific requirement of using this token gen function without putting it in the recipe.
[2012-09-12 16:36:00 -0400] gyre007: awgross|flashman, I decided to go with:  node.attribute? "cloud"
[2012-09-12 16:37:36 -0400] awgross|flashman: jonesy: but the generic one in the attributes/default.rb of the recipe
[2012-09-12 16:37:42 -0400] awgross|flashman: put your version in your role
[2012-09-12 16:37:52 -0400] awgross|flashman: or environment
[2012-09-12 16:38:34 -0400] jonesy: awgross|flashman - sorry if I'm thick or missed it, but can I make a call to a library inside of a role to override attributes?
[2012-09-12 16:38:54 -0400] erikh: is opscode awake yet?
[2012-09-12 16:39:03 -0400] erikh: i haz qwesion
[2012-09-12 16:41:11 -0400] awgross|flashman: jonesy: basically you will just override a variable, chef will take care of the rest. Check out http://wiki.opscode.com/display/chef/Attributes#Attributes-RoleAttributes
[2012-09-12 16:41:26 -0400] jonesy: will do, thanks much awgross|flashman
[2012-09-12 16:41:35 -0400] awgross|flashman: in the recipe, you will access the variable with node['my_var']
[2012-09-12 16:41:45 -0400] awgross|flashman: in the attributes/default.rb of the cookbook, you can set
[2012-09-12 16:41:52 -0400] awgross|flashman: default['my_var'] = "blah"
[2012-09-12 16:41:56 -0400] awgross|flashman: and in the role
[2012-09-12 16:42:05 -0400] awgross|flashman: you will be able to set a block similar to
[2012-09-12 16:42:24 -0400] awgross|flashman: override_attributes ( "my_var" => "my override value"  )
[2012-09-12 16:43:15 -0400] jonesy: awgross|flashman - ah, but there's my question: I need 'my override var' to be a call to a function defined in sentry/libraries/core.rb
[2012-09-12 16:43:22 -0400] jonesy: is that possible?
[2012-09-12 16:44:29 -0400] awgross|flashman: jonesy: you could do it with ruby introspection, but I suspect there is a better way
[2012-09-12 16:44:38 -0400] awgross|flashman: jonesy: can you post a gist of some sample code?
[2012-09-12 16:44:48 -0400] awgross|flashman: I dont think I am quite understanding this
[2012-09-12 16:45:00 -0400] jonesy: lemme do some cleansing. 5 mins.
[2012-09-12 16:45:27 -0400] jessicab: erikh: id just post the question, there are a few of us in here
[2012-09-12 16:45:33 -0400] erikh: cool
[2012-09-12 16:46:22 -0400] erikh: so yeah, basically i'm running into a solr issue installing from packages. it appears the solr-home.tar.gz isn't getting installed on package installation
[2012-09-12 16:46:46 -0400] erikh: I fiddled with chef-solr-installer after it didn't work (this is a fresh installation of ubuntu 12.04), and ran across this post by btm: http://lists.opscode.com/sympa/arc/chef/2011-05/msg00205.html
[2012-09-12 16:47:05 -0400] erikh: those directions I have followed in a vain attempt to resolve it, but I'm back at square one again
[2012-09-12 16:47:17 -0400] erikh: this is 10.14.2-1 fwiw
[2012-09-12 16:48:19 -0400] erikh: if it helps any, the solr dir is /var/chef/solr, /var/chef/solr/data, and /var/chef/solr-jetty. these directories do not exist and in the solr.log is the reason it won't start
[2012-09-12 16:48:40 -0400] erikh: ofc the schema.xml and friends aren't there either :)
[2012-09-12 16:49:48 -0400] jonesy: awgross|flashman https://gist.github.com/3708042
[2012-09-12 16:50:04 -0400] erikh: I mean, at this point, a pointer to the location of the solr-home tarball would be preferred, I need to get moving and this is only a test box.
[2012-09-12 16:50:09 -0400] jonesy: awgross|flashman :signing_token is what I'm looking to populate
[2012-09-12 16:53:55 -0400] erikh: oh!
[2012-09-12 16:54:01 -0400] erikh: wow, that's... interesting
[2012-09-12 16:54:11 -0400] awgross|flashman: jonesy: ok, you should be able to use node['sentry']['signing_token'] inside the library
[2012-09-12 16:54:27 -0400] erikh: jessicab, btm: fwiw if you see this, the reason it wasn't working was because when I was prompted for a rabbitmq password, I entered a blank result
[2012-09-12 16:54:58 -0400] erikh: -P chef-solr && install -f fixed it, but *only* after I filled in a password.
[2012-09-12 16:55:04 -0400] jessicab: hm interesting.. yea, i havent seen that error before, couldnt find anything useful either
[2012-09-12 16:55:32 -0400] erikh: yeah, it seems to be dependent on a password being non-empty for some reason
[2012-09-12 16:55:34 -0400] btm: erikh: for the solr tarball, download the chef git repo, go to the chef-solr directory, run 'rake tar_solr'
[2012-09-12 16:55:48 -0400] erikh: ah I got it all resolved now. thanks though
[2012-09-12 17:07:48 -0400] jonesy: awgross|flashman - but don't I have to call the library from somewhere? It seems it's normally called from inside the recipe, but for my site-specific werdness, I want to keep it out of the recipe. If you're saying the library can be accessed from elsewhere, where?
[2012-09-12 17:08:40 -0400] jonesy: I'll bang on this s'more. Maybe I'm too close to the problem.
[2012-09-12 17:08:44 -0400] jblaine: RHEL6 chef server bootstrap install failure on erlang -- known?
[2012-09-12 17:09:04 -0400] jblaine: https://gist.github.com/3708198
[2012-09-12 17:27:55 -0400] _0x783czar: Is there a good way to loop through users that are created in an earlier cookbook in the chef run list?
[2012-09-12 17:28:12 -0400] joemiller: btm: do you have any other tips on things i could try to debug chef-3437?
[2012-09-12 17:31:08 -0400] oddover: hi chefs!
[2012-09-12 17:31:15 -0400] oddover: Got a quick question
[2012-09-12 17:31:30 -0400] jtimberman: jblaine: what happens if you try to install that package with yum manually?
[2012-09-12 17:31:31 -0400] oddover: are there any plans for environments to be supported on chef-solo?
[2012-09-12 17:32:14 -0400] lewjg: Has anyone had the issue where even though you've deleted a node and client, when you try to re-register that node you get a 401 from the API?
[2012-09-12 17:32:23 -0400] _0x783czar: The issue I'm having is that when I want to loop through all the users and then preform an action on each of them.  But my run list also creates the users, so when I run it, the first time it only applies those changes to users who existed previously.  So it takes two chef runs to apply the needed changes to all the users on the system.
[2012-09-12 17:34:10 -0400] lewjg: Double checked running ntpdate. Deleted the client from both the web ui and knife.
[2012-09-12 17:34:11 -0400] jblaine: jtimberman: reload gist, see bottom, if you will : it barfs on tk
[2012-09-12 17:34:25 -0400] lewjg: Even regenerated the key from the ui and dropped in in there. No dice.
[2012-09-12 17:34:35 -0400] lewjg: Bootstrapped with a different name though, no problem.
[2012-09-12 17:34:41 -0400] _0x783czar: lewjg: is this a VM you're working with?
[2012-09-12 17:34:47 -0400] lewjg: Yes.
[2012-09-12 17:34:48 -0400] jblaine: jtimbermana: and 'tk' is not a valid package for RHEL6
[2012-09-12 17:35:04 -0400] jblaine: haha 'jtimbermana'
[2012-09-12 17:35:06 -0400] lewjg: And it's a node name that was previously in use.
[2012-09-12 17:35:30 -0400] jtimberman: jblaine: :o
[2012-09-12 17:35:41 -0400] _0x783czar: lewjg: I've had issues with that too.  Sadly I couldn't figure it out and had to just recreate the VM.  Even manually fixing the system time didn't fix it.
[2012-09-12 17:35:49 -0400] jtimberman: jblaine: i've never seen that before.
[2012-09-12 17:35:58 -0400] jtimberman: jblaine: though i haven't tried 10.14.2 for the server yet.
[2012-09-12 17:36:09 -0400] lewjg: Just seems like there's something left stuck on the server that's preventing re-registration.
[2012-09-12 17:36:12 -0400] jtimberman: jblaine: also, jtimbermana still hits my irc highlight :)
[2012-09-12 17:36:26 -0400] lewjg: jtimbermania! :)
[2012-09-12 17:36:36 -0400] jtimberman: lewjg: I approve.
[2012-09-12 17:36:49 -0400] jblaine: jtimberman: I think it's safe to say Chef Server does not need erlang-wx (wxWidgets), which is what wants tk
[2012-09-12 17:36:51 -0400] _0x783czar: jtimberman: that should be your new nick
[2012-09-12 17:37:12 -0400] jblaine: but I guess that's what one gets when they ask for ALL THE ERLANG
[2012-09-12 17:37:29 -0400] miah: file bugs, deploy roach motels.
[2012-09-12 17:38:30 -0400] oddover: are there any plans for environments to be supported on chef-solo?
[2012-09-12 17:39:03 -0400] jblaine: err, erlang-gs is what has the tk requirement, because of wx crap
[2012-09-12 17:39:39 -0400] jblaine: "A library for Tcl/Tk support in erlang"
[2012-09-12 17:39:44 -0400] jblaine: sign me up for that
[2012-09-12 17:39:47 -0400] jtimberman: jblaine: i wonder why its trying to install that.
[2012-09-12 17:40:10 -0400] jtimberman: is it just the default 'erlang' package pulling in silly dependencies?
[2012-09-12 17:40:14 -0400] jblaine: jtimberman: 'erlang' is a catchall apparently for 'install every frigging erlang-PKGNAME'
[2012-09-12 17:40:29 -0400] jtimberman: erlang-full please.
[2012-09-12 17:40:31 -0400] jtimberman: ffs.
[2012-09-12 17:41:41 -0400] jblaine: jtimberman: yeah, 'erlang' is a 24KB rpm
[2012-09-12 17:42:04 -0400] jtimberman: i have a sadface
[2012-09-12 17:42:18 -0400] jtimberman: aren't EL platforms normally well behaved for minimal package defaults?
[2012-09-12 17:42:41 -0400] Mithrandir: jtimberman: uh, no.
[2012-09-12 17:42:57 -0400] Mithrandir: when did you last install a minimal EL chroot?
[2012-09-12 17:43:01 -0400] Mithrandir: it includes loads of bullshit
[2012-09-12 17:44:57 -0400] jblaine: jtimberman: in fact, trying to exclude the problematic stuff with -x does not work
[2012-09-12 17:44:58 -0400] jtimberman: Mithrandir: the "minimal" install of centos6 was so minimal it didn't have perl. and then i was confused.
[2012-09-12 17:45:18 -0400] jblaine: jtimberman: the base erlang package requires erlang-gs (problem)
[2012-09-12 17:45:22 -0400] jblaine: awesome.
[2012-09-12 17:46:17 -0400] jtimberman: jblaine: one moment, starting up a centos 6 box
[2012-09-12 17:46:30 -0400] geekbri: last time i did a minimal centos install it was pretty dang bare
[2012-09-12 17:48:32 -0400] Twirrim: centos 6 minimal is ridiculously minimal.  I love it.  Even as I keep finding the strange things it doesn't include that I'd expect to be present even on a minimal setup.
[2012-09-12 17:49:11 -0400] Twirrim: like man and telnet.
[2012-09-12 17:50:00 -0400] masterkorp: http://ompldr.org/vZmd1Mg/2012-09-12-184648_1920x1080_scrot.png
[2012-09-12 17:50:05 -0400] masterkorp: err
[2012-09-12 17:53:28 -0400] jblaine: jtimberman: It's odd. There are all sorts of other packages that depend on "tk", and they all fail to install because there IS no "tk" to install from RH or EPEL.
[2012-09-12 17:53:44 -0400] jblaine: jtimberman: such as tkcon, or tklib, or...
[2012-09-12 17:54:03 -0400] jtimberman: jblaine: is this *redhat*? or centos?
[2012-09-12 17:55:21 -0400] jblaine: jtimberman: RHEL6. Let me check the channel subscriptions for this box.
[2012-09-12 17:55:35 -0400] jtimberman: jblaine: my centos 6.3 system can install erlang, along with tk and all the other friends included in the party.
[2012-09-12 17:55:45 -0400] jtimberman: [vagrant@centos6-cookbook-test ~]$ rpm -q tk
[2012-09-12 17:55:46 -0400] jtimberman: tk-8.5.7-5.el6.x86_64
[2012-09-12 17:55:52 -0400] jtimberman: its in 'base'
[2012-09-12 17:55:57 -0400] jtimberman: but i don't have rhel to verify
[2012-09-12 17:57:19 -0400] JasonF: Is there some way to determine on the chef server who changed a run_list for a server?
[2012-09-12 17:59:34 -0400] jblaine: jtimberman: weird. This is RHEL6 Server + Optional channel + Supplementary channel. I will dig around some.
[2012-09-12 17:59:49 -0400] Twirrim: it's in base on Oracle Linux too.
[2012-09-12 18:00:02 -0400] Twirrim: or at least the Oracle renamed equivilent of base :D
[2012-09-12 18:01:18 -0400] jblaine: OHHHHHHH
[2012-09-12 18:01:23 -0400] jblaine: ldflgdflgjldfgjklsdfgldfslsd
[2012-09-12 18:01:41 -0400] jblaine: I re-kickstarted this box the other day and did not re-register. SO sorry for the time wasted.
[2012-09-12 18:02:14 -0400] jtimberman: jblaine: no worries :)
[2012-09-12 18:02:25 -0400] jblaine: This is what happens when you have manual steps!
[2012-09-12 18:02:29 -0400] jtimberman: jblaine: if you find a way to get the erlang installed w/o a bunch of TK stuff though, that'd probably be welcome.
[2012-09-12 18:02:47 -0400] jtimberman: because this test box just installed 87 packages for erlang.
[2012-09-12 18:03:01 -0400] Mithrandir: man and telnet are way down the priority ladder in Debian at least.  They're priority standard.
[2012-09-12 18:03:13 -0400] jtimberman: zomg telnet is insecure!
[2012-09-12 18:03:23 -0400] jtimberman: telnet is a great way to test SMTP.
[2012-09-12 18:04:00 -0400] Twirrim: telnet is an essential part of my network troubleshooting toolkit.
[2012-09-12 18:04:41 -0400] jblaine: jtimberman: Yeah, sadly, it does not look like that is possible with the EPEL erlang: 'erlang' requires 'erlang-gs' which requires 'tk'
[2012-09-12 18:06:01 -0400] j|: hrm. If I wanted to use a different IP for the chef-server for nodes I'm bootstrapping than I have in my knife.rb file, can I just edit the bootstrap template to have one additional line to set @chef_config[:chef_server_url] before it dumps the chef_config variable into /etc/chef/client.rb? (looking at the ubuntu12.04 gems boostrap template)
[2012-09-12 18:21:11 -0400] j|: problem being that I'm running knife on my laptop, which uses the public IP of my chef-server, but I'd like my nodes to use the chef-server's internal IP
[2012-09-12 18:23:14 -0400] j|: the bootstrap template is a bit cryptic to me.
[2012-09-12 18:23:32 -0400] j|: doesn't look like config_content is a variable actually. A method call?
[2012-09-12 18:24:50 -0400] awgross|flashman: anyone find a solution for knife bootstrap failing to respect the run list being passed in?
[2012-09-12 18:33:20 -0400] msch: hi, how can i run apt-get-update after deleting a file?   notifies :run, resources(:execute => "apt-get-update"), :immediately says it didn't find a resource that matches
[2012-09-12 18:36:08 -0400] miah: do you have a resource named 'apt-get-update' ?
[2012-09-12 18:38:18 -0400] gyre007: does omnibus Chef install by default sets the chef-client to be running as daemon ?
[2012-09-12 18:38:52 -0400] miah: no
[2012-09-12 18:40:19 -0400] gyre007: cool
[2012-09-12 18:40:37 -0400] gyre007: but it does generate the init file right
[2012-09-12 18:42:22 -0400] jessicab: gyre007: i dont think it does, pretty sure you need the chef-client recipe to setup that
[2012-09-12 18:42:25 -0400] awgross|flashman: msch: make a block with
[2012-09-12 18:42:32 -0400] awgross|flashman: execute "update action" do
[2012-09-12 18:42:38 -0400] awgross|flashman: command "apt-get update"
[2012-09-12 18:42:40 -0400] psykidellic: Hi, can somebody point me to the right docs on nginx::ohai_plugin? I got a setup using my own simple recipe for nginx but I was trying to use the opscode community and when I add the receipe, it fails looking for the plugin. I am not sure why it needs it and how can I fix it. I am using chef-solo.
[2012-09-12 18:42:41 -0400] awgross|flashman: action :nothing
[2012-09-12 18:42:45 -0400] awgross|flashman: end
[2012-09-12 18:42:49 -0400] msch: awgross|flashman: thanks!
[2012-09-12 18:42:52 -0400] awgross|flashman: msch: then notify that
[2012-09-12 18:43:03 -0400] psykidellic: recipe*
[2012-09-12 18:43:13 -0400] gyre007: jessicab, strange..because I intalled it with omnibus - haven't used any chef-client recipe and it's running as a daemon....
[2012-09-12 18:44:08 -0400] jessicab: gyre007: hm.. guess im thinking mostly of this bug, i havent tested that myself - http://tickets.opscode.com/browse/CHEF-3310
[2012-09-12 18:45:03 -0400] gyre007: mm
[2012-09-12 18:54:09 -0400] agoddard: msch: there's some good examples at http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-09-12 18:57:40 -0400] msch: agoddard: thanks! i figured it out, i didn't have the apt cookbook in my runlist
[2012-09-12 18:57:54 -0400] msch: agoddard: interestingly the apt_repository commands worked nevertheless
[2012-09-12 19:33:55 -0400] makerbreakr: anyone suggest a good monitoring solution?
[2012-09-12 19:34:23 -0400] makerbreakr: basically, the chef web ui, but cooler, looking, and in a more "command center" format
[2012-09-12 19:36:50 -0400] geekbri: Well what do you want to monitor? Just the up down status of your servers or what?
[2012-09-12 19:37:12 -0400] geekbri: I mean the chef WEB ui doesn't really provide much monitoring, It just shows you what nodes you have stored in the chef server
[2012-09-12 19:37:35 -0400] geekbri: and the chef-client run status on your nodes.
[2012-09-12 19:37:51 -0400] makerbreakr: ya, i wanted it formated a little better to put up on an LCD
[2012-09-12 19:38:00 -0400] makerbreakr: up/down, last checkin, network usage
[2012-09-12 19:38:18 -0400] anonymous1: makerbreakr Nagios might work for you
[2012-09-12 19:38:26 -0400] makerbreakr: i guess i can write a custom one using rails, and parsing the node status
[2012-09-12 19:38:34 -0400] geekbri: You could use Scout, sensu, pingdom (this only tells you up down status via pings)
[2012-09-12 19:38:35 -0400] geekbri: boundry
[2012-09-12 19:38:46 -0400] geekbri: makerbreakr: you can just use the chef API
[2012-09-12 19:38:53 -0400] geekbri: you dont have to parse the command line too
[2012-09-12 19:39:51 -0400] anonymous1: any suggestions/best practice  on getting node data into a data bag
[2012-09-12 19:40:29 -0400] bluepojo: you mean like Ohai data?
[2012-09-12 19:40:34 -0400] bluepojo: anonymous1:
[2012-09-12 19:40:57 -0400] bluepojo: ohai data doesn't need to be put in a databag
[2012-09-12 19:41:02 -0400] bluepojo: cause you can query it already
[2012-09-12 19:41:04 -0400] anonymous1: I need to access the IP address of a server created with knife
[2012-09-12 19:41:10 -0400] anonymous1: ok
[2012-09-12 19:41:13 -0400] bluepojo: yeah, ohai gives you that
[2012-09-12 19:41:14 -0400] _0x783czar: Has anyone ever used the fnichol RVM cookbook?
[2012-09-12 19:41:16 -0400] anonymous1: kind of noobish
[2012-09-12 19:41:19 -0400] bluepojo: all good
[2012-09-12 19:41:38 -0400] geekbri: _0x783czar: I have
[2012-09-12 19:41:40 -0400] bluepojo: ohai is where you get all your ohai data
[2012-09-12 19:41:43 -0400] bluepojo: err
[2012-09-12 19:41:44 -0400] bluepojo: damn
[2012-09-12 19:41:48 -0400] bluepojo: your node data
[2012-09-12 19:41:59 -0400] geekbri: _0x783czar: I mean I use it very sparingly and im probably on a super old version
[2012-09-12 19:42:00 -0400] bluepojo: and if it doesn't give you something you need, ohai plugins are super simple to write
[2012-09-12 19:42:26 -0400] mhalligan: for the love of bob, don';t do nagios. we need to just let it die.
[2012-09-12 19:42:37 -0400] mhalligan: sense + log stash + graphite (for dashboards) is a great solution
[2012-09-12 19:42:39 -0400] _0x783czar: geekbri: did you have any trouble with it?  It seems that it's breaking my chef ruby enviornment.  OHAI doesn't work once I run the RVM::System recipe
[2012-09-12 19:42:57 -0400] geekbri: _0x783czar: I was having issues with the system install, so I ended up doing a user install
[2012-09-12 19:43:07 -0400] bluepojo: _0x783czar: we use rbenv instead, https://github.com/RiotGames/rbenv-cookbook
[2012-09-12 19:43:10 -0400] geekbri: That was like... 7 months ago :)
[2012-09-12 19:44:21 -0400] _0x783czar: geekbri: OK, maybe I'll try that
[2012-09-12 19:44:35 -0400] _0x783czar: bluepojo: hmm, I'll look into that one too.
[2012-09-12 19:44:51 -0400] bluepojo: rbenv is less magical than rvm
[2012-09-12 19:45:06 -0400] bluepojo: so I find it's better suited for production machines
[2012-09-12 19:46:06 -0400] _0x783czar: bluepojo: ah yes, so it's using rbenv.  Yeah, I don't think I'll get my CTO to ditch RVM.
[2012-09-12 19:52:03 -0400] awgross|flashman: getting Jenkins to run a knife bootstrap command to build a full ec2 machine w/ minitest makes me feel all warm and fuzzy
[2012-09-12 19:54:43 -0400] geekbri: I don't use Rvm on my production machines
[2012-09-12 19:54:48 -0400] geekbri: its just in our CI env
[2012-09-12 19:54:55 -0400] geekbri: for some testing nonsense :)
[2012-09-12 19:59:17 -0400] jblaine: Do couchdb and solr need to be exposed to external hosts via firewall rules?
[2012-09-12 19:59:22 -0400] jblaine: on chef server
[2012-09-12 20:03:16 -0400] ssd7: No
[2012-09-12 20:03:47 -0400] maxmanders: Ruby and Chef noob looking for some help: https://gist.github.com/3709493 `ruby -c` says that the syntax is fine, but provisioning Vagrant with Chef-Solo raises a syntax error on line 17. Any ideas?
[2012-09-12 20:04:49 -0400] stim371: you have a hanging comma on the end. is that it?
[2012-09-12 20:04:54 -0400] stim371: of line 16
[2012-09-12 20:05:02 -0400] maxmanders: I suspect that perhaps environments aren't supported on Chef-Solo and that's the actual problem, however I'd like to write recipies that are portable between Chef-Solo and Chef-Server (e.g. provisioning ec2); do I just need to sprinkle Chef::Config[:solo] checks everywhere?
[2012-09-12 20:05:21 -0400] maxmanders: stim371: I'll try another run without it - but thought the Ruby syntax checker would have picked that up if it was a problem.
[2012-09-12 20:06:04 -0400] fish_: hrm... I've installed chef 10.14.2 and migrated data from 0.9.x over. I've copied over the couchdb (w/o the design files), ran knife index rebuild. knife node list shows all nodes and chef client runs fine if run list is empty
[2012-09-12 20:06:37 -0400] maxmanders: stim371: Yup, that was it - I guess syntactically it's okay - still learning
[2012-09-12 20:06:37 -0400] fish_: when I add something to the run list, chef client fails with /usr/lib/ruby/1.8/net/protocol.rb:135:in `sysread': end of file reached (EOFError)
[2012-09-12 20:06:56 -0400] stim371: good luck, maxanders
[2012-09-12 20:07:11 -0400] fish_: do I need to reupload all cookbooks, roles and databags? but that's stored in couchdb, right? #confused
[2012-09-12 20:08:33 -0400] stim371: does anyone have experience with chef/vagrant creating separate vms for chef server/web/db? Having trouble getting mysql server permissions set properly
[2012-09-12 20:10:14 -0400] maxmanders: stim371: Thanks :-) So far, this is one of the friendlier channels/communities for devs branching out in to new areas - good job!
[2012-09-12 20:11:04 -0400] stim371: i've been banging my head against it for a week+ so jumping at any chance to do something constructive haha
[2012-09-12 20:12:18 -0400] fish_: hrm I think I'm wrong and the cookbooks are separated from the meta data around them (which is in couchdb)
[2012-09-12 20:12:25 -0400] maxmanders: stim371: sounds like you're doing what I'm doing!
[2012-09-12 20:12:57 -0400] fish_: I'm separating chef's solr, rabbitmq, couchdb from chef-server/merb stuff as well btw ;)
[2012-09-12 20:13:19 -0400] fish_: but everything on bare metal
[2012-09-12 20:13:35 -0400] awgross|flashman: maxmanders: they arent, but you should really only need chef solo checks in a few places, using default attributes in cookbooks and passing json to vagrant for chef solo should cover most everything
[2012-09-12 20:13:59 -0400] awgross|flashman: maxmanders: at the moment I only wrap search blocks, and a few bootstrap recipes that are only run in chef solo
[2012-09-12 20:14:44 -0400] maxmanders: awgross|flashman: thanks, I'll keep that in mind!
[2012-09-12 20:25:42 -0400] fish_: I'm still confused.. where is chef storing the cookbooks on the srver?
[2012-09-12 20:31:01 -0400] jblaine: the wiki was very confusing for me due to environment with network user homedirs. The 'knife configure -i' step as "bob" (wtf?) vs. 'knife client create my-username -a -d -f /tmp/my-username.pem'
[2012-09-12 20:31:28 -0400] jblaine: I would totally update it if I was confident I could explain what the heck is going on there in that initial step
[2012-09-12 20:31:32 -0400] j|: fish_: in couch I think?
[2012-09-12 20:32:09 -0400] jblaine: that is, logged into chef-server as jblaine, those 2 steps illustrated are completely non-compatible as that same user
[2012-09-12 20:32:27 -0400] jblaine: ~jblaine *is* my home directory on all hosts (AFS location)
[2012-09-12 20:35:28 -0400] jblaine: so I just did 'sudo -i knife configure -i', used API clientname 'root', and specified /root/.chef as the place to store knife.rb
[2012-09-12 20:35:32 -0400] jblaine: any problems with that?
[2012-09-12 20:36:03 -0400] jblaine: I've been spoiled by the Private Chef eval.
[2012-09-12 20:36:25 -0400] awgross|flashman: opscode, y u still on nginx 1.0.5 =/
[2012-09-12 20:39:49 -0400] jtimberman: awgross|flashman: ?
[2012-09-12 20:41:43 -0400] awgross|flashman: running debug on my chef run, hitting the API, getting back a header showing nginx 1.0.5
[2012-09-12 20:41:49 -0400] awgross|flashman: jtimberman:
[2012-09-12 20:42:21 -0400] awgross|flashman: latest stable is 1.2.3
[2012-09-12 20:42:54 -0400] awgross|flashman: i mean you could be sending back falsified data, just seems like a strange choice
[2012-09-12 20:43:39 -0400] jtimberman: awgross|flashman: oh, using Opscode Hosted Chef?
[2012-09-12 20:43:47 -0400] jtimberman: software upgrades are hard :)
[2012-09-12 20:44:08 -0400] fish_: j|: I thought that as well.. but not sure
[2012-09-12 20:44:22 -0400] miah: also. upgrading shit just because something newer is out isn't always the right way to handle things
[2012-09-12 20:44:25 -0400] jtimberman: like, doing a non-interrupting upgrade of a core piece of tech
[2012-09-12 20:44:39 -0400] awgross|flashman: true
[2012-09-12 20:44:59 -0400] jtimberman: also, i don't know whether those are source installs or package installs. if package, that might be the version in the distro
[2012-09-12 20:45:06 -0400] awgross|flashman: yeah good point
[2012-09-12 20:45:07 -0400] miah: upgrading nginx shouldn't be too hard assuming its behind some load balancer
[2012-09-12 20:45:11 -0400] awgross|flashman: for our nginx we have to upgrade via PPA
[2012-09-12 20:45:17 -0400] awgross|flashman: on ubuntu
[2012-09-12 20:45:27 -0400] miah: but unless there is a compelling reason wtf is the poing
[2012-09-12 20:45:54 -0400] flaccid: frontend lbs are easy to swap out :p
[2012-09-12 20:46:02 -0400] awgross|flashman: miah: nginx had an issue where chunks of memory could be dumped with craftily formed headers
[2012-09-12 20:46:10 -0400] awgross|flashman: or written to?
[2012-09-12 20:46:11 -0400] awgross|flashman: can remember
[2012-09-12 20:46:22 -0400] awgross|flashman: was relatively serious one
[2012-09-12 20:47:04 -0400] awgross|flashman: cant*
[2012-09-12 20:47:10 -0400] fish_: hrm.. is there any documentation about restore a chef server from backup? I found documentation about backing it up but not restoring.
[2012-09-12 20:48:09 -0400] dougireton: I'm trying to remove a role from all nodes. I've gotten "knife search node "role:foo" to return the list of nodes in the "foo" role. Now I need to iterate over the collection and run "knife node run_list remove <node> "role:foo". Not sure how to do that...
[2012-09-12 20:48:42 -0400] jtimberman: dougireton: knife exec to the rescue!
[2012-09-12 20:48:49 -0400] awgross|flashman: needs moar bash imo
[2012-09-12 20:48:58 -0400] dougireton: ok, I'll look into that
[2012-09-12 20:49:00 -0400] dougireton: thanks
[2012-09-12 20:49:03 -0400] awgross|flashman: no problem cannot be solved without more bash
[2012-09-12 20:49:17 -0400] jtimberman: dougireton: you'll want to look at the nodes.transform
[2012-09-12 20:49:24 -0400] joemiller: anyone having issues with `git` resource in 10.14.x when using tags for revision attribute?
[2012-09-12 20:49:27 -0400] jtimberman: dougireton: the 'shef' man page should be helpful
[2012-09-12 20:49:36 -0400] dougireton: nice, thanks for the info
[2012-09-12 20:50:20 -0400] jtimberman: dougireton: or, launch 'shef', and run help :nodes
[2012-09-12 20:50:24 -0400] jtimberman: i know its in there :)
[2012-09-12 20:51:34 -0400] MattJ: Is there anything obvious I might be missing when `knife ssh "chef_environment:foo AND role:bar" fails (no nodes found), and knife search "*:*" immediately after clearly shows a matching server running?
[2012-09-12 20:51:46 -0400] MattJ: *knife search node
[2012-09-12 20:52:43 -0400] miah: is your node not in the right role?
[2012-09-12 20:52:51 -0400] miah: er, environment
[2012-09-12 20:53:11 -0400] MattJ: According to the output of search "*:*" it is (which is why it's so puzzling)
[2012-09-12 20:53:36 -0400] MattJ: It's part of a script, so I'm just trying to debug it further... I'm waiting to find out I have a trailing space or something weird somewhere
[2012-09-12 20:54:00 -0400] MattJ: but since I'm fairly new to Chef, wondered if there might be something else I'm not aware of that would cause it not to match
[2012-09-12 21:06:28 -0400] j|: jtimberman: can I use knife exec to delete an ec2 instance by its node name instead of having to show the node first to grab its instance id?
[2012-09-12 21:10:20 -0400] juliancdunn: j|: why not just use the knife ec2 plugin to do that
[2012-09-12 21:11:11 -0400] jmartin: ohai chefs, does anyone happen to know if there is a coldfusion cookbook that has been vetted?
[2012-09-12 21:11:38 -0400] j|: juliancdunn: wtf.. I swear when I looked for that 2 weeks ago it wasn't there.
[2012-09-12 21:11:55 -0400] j|: now the --help shows it with --purge
[2012-09-12 21:12:05 -0400] j|: *sigh*
[2012-09-12 21:12:17 -0400] j|: when in doubt, re-try the obvious.
[2012-09-12 21:12:37 -0400] jtimberman: j|: that was a feature added in a recent release, and you may not have had the latest gem last you looked?
[2012-09-12 21:12:40 -0400] jtimberman: :)
[2012-09-12 21:13:37 -0400] j|: suppose the last time I looked I was running 10.8. Now I'm on 10.12 and I see you guys are already on 10.14 now?
[2012-09-12 21:13:50 -0400] j|: just racing right ahead now aren't we.
[2012-09-12 21:13:55 -0400] jmartin: and 11 is around the corner!
[2012-09-12 21:13:57 -0400] j|: :)
[2012-09-12 21:14:21 -0400] jmartin: erchef hopefully sooner rather than later
[2012-09-12 21:14:42 -0400] Pushnell: What's the best way to get a snapshot of what's coming up in new releases?
[2012-09-12 21:15:01 -0400] Pushnell: (for example, v11)
[2012-09-12 21:15:29 -0400] miah: derpy question of the day: since chef-solo supports roles, but not search. how can i query the list of roles a chef-solo instance is aware of?
[2012-09-12 21:16:16 -0400] jmartin: Pushnell: i think they did a preview release for erchef (11)
[2012-09-12 21:16:57 -0400] jtimberman: j|: well, with the move to "10.X.Y" vs "0.10.X", it makes it easier to release patch releases.
[2012-09-12 21:17:03 -0400] jmartin: Pushnell: http://www.opscode.com/blog/2012/08/31/test-drive-the-chef-11-server-preview/
[2012-09-12 21:17:23 -0400] jtimberman: miah: read the roles_path for contents?
[2012-09-12 21:17:28 -0400] jtimberman: miah: using "Ruby"
[2012-09-12 21:17:29 -0400] jtimberman: :)
[2012-09-12 21:18:51 -0400] j|: jtimberman: gotcha. I read something about the standard for cookbooks now being one repo per cookbook rather than one big repo of cookbookS
[2012-09-12 21:19:27 -0400] jtimberman: j|: It's not that it is a standard.
[2012-09-12 21:19:56 -0400] jtimberman: j|: We split our monolithic cookbook repository up into separate repositories per cookbook to make it easier for contributors.
[2012-09-12 21:19:58 -0400] miah: jtimberman: ok. thats what i thought. was hoping for easier. but got it =)
[2012-09-12 21:20:30 -0400] jtimberman: miah: if there's an easier way i'm not aware
[2012-09-12 21:20:33 -0400] j|: so its an easier standard for contributors. :)
[2012-09-12 21:20:40 -0400] j|: hehe.
[2012-09-12 21:20:53 -0400] j|: sorry, my english vocabulary is duck-typed
[2012-09-12 21:20:56 -0400] jtimberman: its ok
[2012-09-12 21:21:31 -0400] jtimberman: for sharing with others we still recommend releasing the cookbooks to the community site.
[2012-09-12 21:21:43 -0400] jtimberman: how you put them in version control is up to you
[2012-09-12 21:21:46 -0400] j|: gotcha.
[2012-09-12 21:22:01 -0400] j|: part of the continuing choose your workflow theme
[2012-09-12 21:22:06 -0400] jtimberman: right
[2012-09-12 21:22:08 -0400] j|: speaking of choosing my workflow
[2012-09-12 21:22:22 -0400] jtimberman: librarian and berkshelf help manage the repository too.
[2012-09-12 21:22:29 -0400] j|: what are my options for testing distro templates before deploying them to nodes I'm trying to bootstrap?
[2012-09-12 21:22:35 -0400] miah: jtimberman: ok =)
[2012-09-12 21:22:39 -0400] j|: berkshelf I hadn't heard of
[2012-09-12 21:23:19 -0400] j|: can I do that w/ shef?
[2012-09-12 21:23:51 -0400] j|: I've actually never used shef. I should probably go read that fine manual.
[2012-09-12 21:25:31 -0400] miah: j|: use vm's to test your bootstrap templates
[2012-09-12 21:25:41 -0400] miah: template resources i just test with standard ruby
[2012-09-12 21:26:26 -0400] miah: j|: eg https://gist.github.com/3710049
[2012-09-12 21:26:32 -0400] j|: miah: yea, I am trying to avoid that as its slow to spin up a new vm when compared with.. well *not* spinning up a new vm. :)
[2012-09-12 21:26:34 -0400] miah: but i think your talking about bootstrap templates
[2012-09-12 21:26:51 -0400] miah: i prefer real world testing
[2012-09-12 21:27:20 -0400] miah: so i would just test bootstrap templates against vm's
[2012-09-12 21:27:27 -0400] j|: yea, really I just want to change the chef_server_url to be different than the one I have in my knife config
[2012-09-12 21:28:44 -0400] j|: but as I'm new to ruby and chef, I just want to make sure I don't make any stupid mistakes before trying to have the new VM use it
[2012-09-12 21:29:31 -0400] j|: spinning up an entire VM and pulling in gems to find a syntax error feels silly.
[2012-09-12 21:29:38 -0400] j|: ;)
[2012-09-12 21:29:47 -0400] jmartin: for a recipe?
[2012-09-12 21:31:20 -0400] j|: for the bootstrap template that generates the client configuration before chef client runs and then gets the recipe list from chef-server (using open chef)
[2012-09-12 21:32:08 -0400] jmartin: j|: the way i sort of got around that was to use a vm or three and snapshot after a fresh OS install
[2012-09-12 21:32:16 -0400] jmartin: then run, revert to snapshot
[2012-09-12 21:32:34 -0400] jmartin: that way its faster to revert to a 'good' state if something silly like syntax occurs
[2012-09-12 21:32:43 -0400] jmartin: might be the best way to do it, but it worked for me
[2012-09-12 21:33:18 -0400] j|: well, if a syntax error occurs, I just kill the vm
[2012-09-12 21:33:24 -0400] j|: ec2 instance in this case
[2012-09-12 21:33:26 -0400] jmartin: ah
[2012-09-12 21:33:38 -0400] j|: but, I'd like to not waste the time spent.
[2012-09-12 21:33:44 -0400] j|: anyway, I'll figure it out.
[2012-09-12 21:33:52 -0400] j|: keep working with it.
[2012-09-12 21:33:55 -0400] jmartin: something you might look into as well is test-kitchen
[2012-09-12 21:33:58 -0400] jmartin: https://github.com/opscode/test-kitchen
[2012-09-12 21:34:00 -0400] j|: thanks though.
[2012-09-12 21:34:26 -0400] j|: yea, I saw that.
[2012-09-12 21:34:35 -0400] j|: thanks again
[2012-09-12 21:35:39 -0400] jmartin: j|: i just thought again about what you said, so you are saying if it fails in the middle of your bootstrap run you just want to resume after correction?
[2012-09-12 21:39:12 -0400] j|: jmartin: no, really I don't mind just killing the thing as if it can't parse the template, then it won't change the chef-server-url, so it won't be able to connect with chef-server and thus its a dead instance anyway.
[2012-09-12 21:40:31 -0400] j|: hrm, well there's an easy one-liner to change if I use the apt template instead of the gems template
[2012-09-12 21:40:48 -0400] j|: was trying to use the gems one, but I suppose apt is okay..
[2012-09-12 21:41:18 -0400] Random777: Hi I am facing an issue with chef-client its giving an error of Error synchronising files. I am Hosting chef-server on a separate machine. I tried getting-started recipe. Any ideas?
[2012-09-12 21:50:00 -0400] frank3: hey all
[2012-09-12 21:50:16 -0400] frank3: Anyone have any good cookbooks for knife?
[2012-09-12 21:50:26 -0400] jmartin: what do you mean?
[2012-09-12 21:50:54 -0400] jmartin: installing it?
[2012-09-12 21:51:06 -0400] frank3: yeah, i want a cookbook for it
[2012-09-12 21:51:40 -0400] frank3: I was cooking this double baked ssh recipe my granny handed down to me and realized I need a cookbook for knife as a prereq
[2012-09-12 21:52:45 -0400] qhartman: is there anyway to force a service status to "stopped" in chef? I have a service that fairly often gets into a bad state that requires killing it to make it actually go away and reload
[2012-09-12 21:53:31 -0400] qhartman: tryuing to do a "service stop" followed by a conditional killall command followed by a "service start", but the service start is always skipped because chef thinks the service is running
[2012-09-12 21:53:36 -0400] frank3: qhartman: I am working on double baked ssh right now, give me about an hour to make my final commit, should help you in this matter
[2012-09-12 21:53:38 -0400] jmartin: frank3: so you simply want knife to be installed or do you have to modify the configuration in knife.rb or something?
[2012-09-12 21:58:07 -0400] qhartman: for now I've replaced the start with a restart, and now it's behaving
[2012-09-12 21:58:11 -0400] fish_: still wondering if I need to do anything like uploading stuff when restoring a chef server from backup. restoring the couchdb should be enough, right?
[2012-09-12 21:59:16 -0400] fish_: I would rather understand this then proceeding by just trying it and fixing it somehow without really known what happend
[2012-09-12 22:08:06 -0400] j|: meh, that was actually really simple when starting from the blank template
[2012-09-12 22:08:27 -0400] j|: my problem was I had somehow flubbed a part of the template that I wasn't working on it looks like. sweet.
[2012-09-12 22:08:42 -0400] j|: s/blank/clean/
[2012-09-12 22:11:24 -0400] fish_: well, I guess this is a actual chef bug. chef client is doing a http://<chef server>:4000/cookbooks/rsyslog/0.9.5/files/df0de35aa7a2a22f824578e2898c288a and chef-server is closing the connection afterwards
[2012-09-12 22:11:45 -0400] fish_: no idea if the client is requesting a wrong url (looks bit weird) or if it's chef-server not handling that request correctly
[2012-09-12 22:16:01 -0400] fish_: https://gist.github.com/d09c458d0143ea1a8a82 <- here are log snippets from chef-client, chef-server and couchdb
[2012-09-12 22:21:39 -0400] MattJ: miah, in case you were curious - the best explanation I can come up with is that immediately after knife ssh ... "sudo chef-client" returns, the roles are not quite registered on the Chef server
[2012-09-12 22:22:18 -0400] MattJ: I saw that while chef-client was running the role list was empty - searching by node name instead of role worked
[2012-09-12 22:28:33 -0400] j4m3s: i'm trying to restart an upstart script if there were any changes to the file, but i'm getting this error : FATAL: Chef::Exceptions::ResourceNotFound: Cannot find a resource matching execute[start whapps] (did you define it first?)
[2012-09-12 22:31:03 -0400] j4m3s: nvm i just had to look harder at my recipe
[2012-09-12 22:31:03 -0400] fish_: ok, I can reproduce that
[2012-09-12 22:34:29 -0400] rava: could anyone give an opinion on writing providers vs writing definitions for abstraction?
[2012-09-12 22:38:40 -0400] jtimberman: rava: i prefer providers
[2012-09-12 22:38:56 -0400] jtimberman: rava: definitions are not real resources, so you can't send them notifications
[2012-09-12 22:39:06 -0400] jtimberman: they're replaced by the resources they contain.
[2012-09-12 22:40:12 -0400] fish_: just discovered that node attributes are missing as well
[2012-09-12 22:40:16 -0400] fish_: even I did a knife index rebuild
[2012-09-12 22:40:40 -0400] josephholsten: a
[2012-09-12 22:41:34 -0400] rava: what problems are they tryign to solve? from what i've seen (specifically in the logrotate cookbook where i first ran across one) it looks like it's just an interface wrapper for a resource
[2012-09-12 22:42:35 -0400] jtimberman: rava: well, lightweight resources and providers (lwrps), which is a fairly easy way to get to writing providers didn't exist at first
[2012-09-12 22:42:57 -0400] jtimberman: definitions have always been in chef, and they're there to provide a repeatable abstraction to a resource or multiple resources.
[2012-09-12 22:43:06 -0400] rava: i see, thanks
[2012-09-12 22:43:50 -0400] fish_: hrm wondering if chef-client 0.9 is compatible with chef-server 0.10 at all?
[2012-09-12 22:44:31 -0400] jtimberman: fish_: no
[2012-09-12 22:45:01 -0400] fish_: jtimberman: for real? how should I upgrade a large chef infra then?
[2012-09-12 22:46:03 -0400] kallistec: fish_, jtimberman 0.9 client should work with 0.10 server, the reverse will not
[2012-09-12 22:46:04 -0400] erikh: syslog_server = search(:node, "chef_environment:#{node.chef_environment} AND roles:syslog_server").first["network"]["interfaces"]["eth1"]["addresses"].select { |k,v| v["family"] == "inet" }.first.first
[2012-09-12 22:46:06 -0400] erikh: I cried
[2012-09-12 22:46:21 -0400] fish_: kallistec: puhh, okay - I expected that
[2012-09-12 22:46:25 -0400] erikh: y u no support 1.9 Enumerable#select
[2012-09-12 22:46:58 -0400] jtimberman: kallistec: ah my mistake :)
[2012-09-12 22:47:12 -0400] jtimberman: fish_: sorry for spreading lies and misinformation.
[2012-09-12 22:48:09 -0400] kallistec: fish_: re: the connection close thing, does the file exist on the Chef server? there's some weird behavior where chef-server hands off the file download to thin, which then has an error without returning a 500
[2012-09-12 22:48:11 -0400] fish_: but still, I have two problems: a) node attributes are missing from all nodes, b) chef client fails to fetch my cookbooks: https://gist.github.com/d09c458d0143ea1a8a82
[2012-09-12 22:48:38 -0400] fish_: kallistec: but the cookbooks are stored in couchdb, right?
[2012-09-12 22:48:57 -0400] kallistec: fish_: no, they're stored on disk in a checksums directory
[2012-09-12 22:49:22 -0400] fish_: ohh, hrm, didn't really find that info. okay then they are not there for sure :)
[2012-09-12 22:49:35 -0400] kallistec: there is some info in couchdb to tell the server out to put the cookbooks back together
[2012-09-12 22:50:01 -0400] fish_: kallistec: so it should recreate them from the couchdb?
[2012-09-12 22:50:59 -0400] kallistec: fish_: no, couchdb keeps the mapping of what file has what checksum so it can tell you what files you need to reconstruct a cookbook
[2012-09-12 22:51:03 -0400] fish_: the only cookbooks I find on our old/current chef server are in cache/cookbooks and they belong to chef-client I guess
[2012-09-12 22:51:27 -0400] kallistec: fish_: they won't look like the normal cookbooks, they're stored by checksum of the file
[2012-09-12 22:51:44 -0400] _0x783czar: OK, so I know I mentioned this earlier, but has anyone currently on the chanel used the fnichol RVM cookbook?  I'm having an issue with it breaking OHAI.
[2012-09-12 22:51:54 -0400] kallistec: fish_: probably under var/chef/cache or var/cache/chef
[2012-09-12 22:52:07 -0400] fish_: kallistec: but where? which config variable points to that directory?
[2012-09-12 22:52:11 -0400] fish_: ah looking
[2012-09-12 22:52:59 -0400] _0x783czar: I've been using the system recipe to install RVM for all users, and I've heard that using the user cookbook (although more tedious) is more reliable.  Does anyone have any experience with this?
[2012-09-12 22:53:53 -0400] fish_: kallistec: we've set file_cache_path to /srv/chef/cache (and I have no /var/chef/cache) but is only chef_server_cookie_id and cookbooks/ in it
[2012-09-12 22:54:07 -0400] fish_: where cookbooks/ contains the cookbook chef-client is using
[2012-09-12 22:55:08 -0400] kallistec: fish_: actually it's     checksum_path "/var/chef/checksums" by default
[2012-09-12 22:56:25 -0400] fish_: kallistec: ah! there it is :)
[2012-09-12 22:56:45 -0400] fish_: kallistec: thanks _a lot_, I'll copy them over and try again
[2012-09-12 23:04:03 -0400] fish_: bingo
[2012-09-12 23:04:29 -0400] fish_: kallistec: first problem solved :)
[2012-09-12 23:06:35 -0400] kallistec: fish_: and did you run `knife index rebuild` against your new server?
[2012-09-12 23:07:01 -0400] fish_: kallistec: databags are in couchdb and solr, not on filesystem - right>?
[2012-09-12 23:07:05 -0400] fish_: kallistec: yes, I did that
[2012-09-12 23:07:41 -0400] fish_: but the command itself returned in no time, not sure if it actually did the rebuild. I also suspect that the problem is somehwere there
[2012-09-12 23:08:01 -0400] kallistec: fish_: couch is the canonical store, solr is secondary and contains only indexes for retreiving the ids of objects in couch
[2012-09-12 23:08:11 -0400] fish_: oh, just realize that I did a knife index rebuild with a chef 0.9 based knife - but I guess that should be fine
[2012-09-12 23:08:18 -0400] fish_: ah ok
[2012-09-12 23:10:05 -0400] fish_: kallistec: I'll try to run index rebuild again and collect some logs
[2012-09-12 23:12:19 -0400] kallistec: fish_: cool. you might also look into chef-expanderctl to see what chef-expander is up to
[2012-09-12 23:13:09 -0400] fish_: ah, looks like rabbitmq has credential problems
[2012-09-12 23:14:31 -0400] fish_: kallistec: chef-expander and/or chef-solr is also using rabbitmq, right?
[2012-09-12 23:15:20 -0400] kallistec: fish_: chef-server sends data to rabbit after each save. chef-expander reads from rabbit, reformats the data for solr, and writes to solr
[2012-09-12 23:16:16 -0400] fish_: yes, thats the problem. I've split those services accross two servers and the one running chef-expander, solr, rabbit and couch didn't had a config
[2012-09-12 23:18:52 -0400] _0x783czar: OK, so I just preformed a manual install of Ruby and it broke OHAI, so it's not the recipe that's braking it.  kallistec: I was under the impression that chef's ruby was "jailed" from interacting with system rubies.  Is that right?
[2012-09-12 23:19:52 -0400] kallistec: _0x783czar: if you use the omnibus packages, it should only be using the ruby in /opt/chef/embedded/
[2012-09-12 23:20:59 -0400] _0x783czar: kallistec: yup, that's exactly what I used.  I bootstrapped this client with the chef-full
[2012-09-12 23:23:05 -0400] makerbreaker: can anyone tell me why this would fail when called in a resque job https://gist.github.com/3710700
[2012-09-12 23:23:10 -0400] makerbreaker: but not from the rails console?
[2012-09-12 23:23:25 -0400] _0x783czar: kallistec: Before I install Ruby OHAI runs fine, then as soon as I issue "rvm install 1.9.3" subsequent runs of OHAI only output this: http://pastebin.com/wNagGB1H
[2012-09-12 23:23:32 -0400] makerbreaker: ie, if i go line by line through the resque job, in rails c, it works great
[2012-09-12 23:24:52 -0400] kallistec: _0x783czar: probably some env vars from rvm are mucking with rubygems
[2012-09-12 23:27:59 -0400] _0x783czar: kallistec: darn... well that's going to be fun to figure out
[2012-09-12 23:28:36 -0400] kallistec: _0x783czar: if you run `env` it's pretty obvious which ones are ruby/gems/rvm related
[2012-09-12 23:28:47 -0400] fish_: kallistec: hrm, which config file is chef-expander using?
[2012-09-12 23:28:48 -0400] kallistec: probably GEM_HOME is the one
[2012-09-12 23:29:07 -0400] kallistec: fish_: I think it uses solr.rb by default
[2012-09-12 23:29:21 -0400] fish_: kallistec: thats confusing but okay
[2012-09-12 23:31:41 -0400] _0x783czar: kallistec: ah... yeah it's poining to the system gem folder
[2012-09-12 23:32:12 -0400] _0x783czar: kallistec: do you know of a way to differentiate between them?
[2012-09-12 23:32:28 -0400] _0x783czar: so that I can have them work sparately?
[2012-09-12 23:34:55 -0400] fish_: kallistec: ah, now chef-expander is actually doing stuff - but it fails to post stuff to solr and is not very verbose about that - also nothing in solr
[2012-09-12 23:35:22 -0400] kallistec: fish_: you can use expanderctl to change the log level to debug
[2012-09-12 23:36:04 -0400] kallistec: _0x783czar: don't have any really awesome ideas, except maybe alias 'chef-client' to unset GEM_HOME first
[2012-09-12 23:36:57 -0400] fish_: kallistec: hrm I've ran chef-expander -n1 -l debug but I didn't get any details more than: 'Failed to post to solr: role[616a764c-65ad-46bb-822d-410b39a3e6ff] database[chef]'
[2012-09-12 23:38:50 -0400] fish_: trying to start chef-solr -l debug and see if I get more details out of that
[2012-09-12 23:39:07 -0400] fish_: nope, nothing
[2012-09-12 23:42:55 -0400] makerbreaker: is there a way to force a chef-client run through the API?
[2012-09-12 23:47:33 -0400] fish_: makerbreaker: no
[2012-09-12 23:48:12 -0400] makerbreaker: fish_ do you ahve any thoughts why this would work in rails c
[2012-09-12 23:48:28 -0400] fish_: makerbreaker: what works in rails?
[2012-09-12 23:48:30 -0400] makerbreaker: https://gist.github.com/3710700 but not in a job
[2012-09-12 23:49:02 -0400] makerbreaker: If I go line by line through the job, in rails c, it works, but doing it otherwise does not
[2012-09-12 23:49:51 -0400] fish_: probably external_ip[0] isn't returning what you expect
[2012-09-12 23:50:14 -0400] fish_: did you try to use a print instead of the system to see if it's doing what you expect?
[2012-09-12 23:50:26 -0400] makerbreaker: ya, it does
[2012-09-12 23:51:12 -0400] fish_: no idea, but doesn't look like it's chef related
[2012-09-12 23:51:33 -0400] makerbreaker: ya, i dont think it is either
[2012-09-12 23:51:36 -0400] makerbreaker: but worth a shot
[2012-09-12 23:55:30 -0400] Pushnell: I am clearly not understanding something about attributes.  In my default.rb attributes file I have default['co_zendsite']['webserver'] = "apache"  but in my recipe I try to log node['co_zendsite']['webserver'] and it spits out nil
[2012-09-12 23:58:04 -0400] erikh: s
