[2012-09-07 00:21:45 -0400] fish_: organicveggie: guess still no success?
[2012-09-07 01:56:06 -0400] sascha_d: So can anyone tell me what happened to help.opscode.com/discussions? I have several of these urls in my history and there are several linked in jira tickets but all I get is redirected to opscode.com/support
[2012-09-07 02:06:58 -0400] hoover_damm: sascha_d, prolly best to ask support at opscode.com/support
[2012-09-07 02:07:15 -0400] hoover_damm: nothing I can find in my mailinglists or anything in regards to tender
[2012-09-07 02:10:47 -0400] sascha_d: thanks
[2012-09-07 02:13:36 -0400] jessicab: sascha_d: all of the info there was moved to wiki.opscode.com btw
[2012-09-07 02:13:52 -0400] sascha_d: that's cool
[2012-09-07 02:14:02 -0400] sascha_d: I was actually wondering what kind of implementation it was
[2012-09-07 02:14:06 -0400] sascha_d: I really liked it
[2012-09-07 02:14:35 -0400] sascha_d: and was hoping to find something similar to that or stack overflow or something for a large organization I'm working with at the moment
[2012-09-07 02:15:08 -0400] jessicab: it was a ticketing system done by tender app, we moved to another one a few months ago though
[2012-09-07 02:15:45 -0400] jessicab: well, and it did documentation
[2012-09-07 02:18:51 -0400] sascha_d: ah ok
[2012-09-07 02:19:21 -0400] sascha_d: so, new ticketing system.did you implement a q&a tool with it or planning to?
[2012-09-07 02:19:27 -0400] sascha_d: just curious
[2012-09-07 02:22:02 -0400] jessicab: well, the new ticketing system is basically the same as far as questions and support goes, it was just moved to opscode.com/support, i thought you were asking more about the old docs that were up there heh
[2012-09-07 02:22:11 -0400] rocket: how do you do a case ... when a certain regex is not matched?
[2012-09-07 02:22:20 -0400] rocket: eg I need the inverse of a normal match
[2012-09-07 02:23:38 -0400] sascha_d: jessicabthe tickets are private though? I don't see a collection or anything.  I like the idea of having an organic collection of frequently asked questions
[2012-09-07 02:23:44 -0400] jessicab: sascha_d: oh, except now it required a hosted chef account, but there is still the community site and the mailing list for open source.. im not really sure what the future plans are at all though
[2012-09-07 02:24:15 -0400] sascha_d: Right, I logged in with my hosted chef and my client uses private chef so I kind of dug around but didn't see anything.
[2012-09-07 02:24:39 -0400] jessicab: yea, its completely private now, i miss that too.. was nice having it show up in google searches
[2012-09-07 02:24:41 -0400] sascha_d: jessicabbut really I'm mostly interested in what you guys are using or have decided about them because I was interested in your opinions
[2012-09-07 02:26:07 -0400] sascha_d: also, as an fyi, there are many jira tickets with links to that which are now effectively "dead"
[2012-09-07 02:26:20 -0400] jessicab: sascha_d: tender was good for a ticketing system, it just didnt scale well with so many users on our side.. like 30+, im not really sure what im allowed to say about the current system honestly though, might just want to send in a ticket for that
[2012-09-07 02:26:39 -0400] sascha_d: okey doke; I'll snag some off-irc gossip
[2012-09-07 02:27:30 -0400] jessicab: yea.. we didnt migrate tickets into the new system so theres no where to really point the links to, we still have the info from the tickets internally though
[2012-09-07 02:48:07 -0400] halcyonCorsair: does anyone here have experiencing bootstrapping ec2 instances with chef-solo?
[2012-09-07 02:51:01 -0400] flaccid: technically yes, but i am going to lunch :)
[2012-09-07 02:55:09 -0400] matschaffer: halcyonCorsair: lots
[2012-09-07 02:56:31 -0400] halcyonCorsair: matschaffer: is there a good bootstrap script somewhere around the place?
[2012-09-07 02:57:07 -0400] matschaffer: like to install chef? might wanna give knife-solo a try if it's a fairly standard OS
[2012-09-07 02:58:18 -0400] matschaffer: halcyonCorsair: here's a centos example from the knife solo docs if you need a custom script
[2012-09-07 02:58:18 -0400] matschaffer: https://gist.github.com/2402433
[2012-09-07 02:58:35 -0400] matschaffer: (docs: https://github.com/matschaffer/knife-solo#prepare-command)
[2012-09-07 03:01:49 -0400] halcyonCorsair: matschaffer: working with an ubuntu 12.04.1 image
[2012-09-07 03:02:02 -0400] matschaffer: knife prepare should do fine then
[2012-09-07 03:07:50 -0400] halcyonCorsair: hmm
[2012-09-07 03:11:09 -0400] halcyonCorsair: matschaffer: how do I define the run list / json for the node?
[2012-09-07 03:11:21 -0400] matschaffer: after you prepare there'll be a nodes/hostname.json
[2012-09-07 03:11:25 -0400] matschaffer: edit that before you run knife cook
[2012-09-07 03:11:36 -0400] halcyonCorsair: ah
[2012-09-07 03:20:56 -0400] halcyonCorsair: matschaffer: thanks
[2012-09-07 03:21:00 -0400] matschaffer: np!
[2012-09-07 03:21:02 -0400] matschaffer: good luck
[2012-09-07 03:23:01 -0400] halcyonCorsair: matschaffer: seems to be working well (if slowly) so far
[2012-09-07 03:23:21 -0400] matschaffer: yeah, I have an issue open for that. It's a little liberal with it's ssh connections
[2012-09-07 03:47:38 -0400] halcyonCorsair: does this mean anything to someone? http://paste.dollyfish.net.nz/aa10c7 it's basically gibberish to me :(
[2012-09-07 03:49:49 -0400] flaccid_: halcyonCorsair: if you are going to do chef you'll need to learn how to read a trace. koha/recipes/default.rb:56 means line 56 of that file for you to check
[2012-09-07 03:54:44 -0400] halcyonCorsair: flaccid_: thanks, and....ouch
[2012-09-07 03:55:11 -0400] flaccid_: you expected never to get an error?
[2012-09-07 03:56:52 -0400] halcyonCorsair: flaccid_: i skimmed right over that in the trace, tomorrow might be a better time to be testing this
[2012-09-07 03:57:48 -0400] flaccid_: halcyonCorsair: aren't you in nz?
[2012-09-07 03:57:50 -0400] flaccid_: or no
[2012-09-07 03:58:05 -0400] halcyonCorsair: flaccid_: boston
[2012-09-07 03:58:29 -0400] flaccid_: oh k. you can cite the code you are using for people to look. the paste had the error only..
[2012-09-07 03:58:30 -0400] halcyonCorsair: ah, my irc daemon is in NZ though
[2012-09-07 04:07:21 -0400] halcyonCorsair: ah nice
[2012-09-07 04:09:44 -0400] flaccid_: got the code or no?
[2012-09-07 04:12:41 -0400] halcyonCorsair: flaccid_: ah fixed that one, but how about: http://paste.dollyfish.net.nz/e028d0 https://github.com/halcyonCorsair/chef-koha/blob/master/recipes/default.rb#L24
[2012-09-07 04:13:51 -0400] flaccid_: um i think you need chef_gem "mysql"
[2012-09-07 04:14:29 -0400] halcyonCorsair: flaccid_: as opposed to a local gem?
[2012-09-07 04:14:49 -0400] flaccid_: local gem?
[2012-09-07 04:15:07 -0400] flaccid_: it needs the gem in the chef env
[2012-09-07 04:16:18 -0400] halcyonCorsair: flaccid_: like http://paste.dollyfish.net.nz/2c6964 ?
[2012-09-07 04:17:10 -0400] flaccid_: how do you know that is the same ruby env as what chef is using? if it was you woudn't of had the error..
[2012-09-07 04:17:59 -0400] halcyonCorsair: hmm
[2012-09-07 04:18:18 -0400] flaccid_: for example if it was omnibus install, likely not
[2012-09-07 04:20:57 -0400] halcyonCorsair: flaccid_: do you know how I can check?
[2012-09-07 04:21:09 -0400] flaccid_: how did you install chef?
[2012-09-07 04:23:11 -0400] halcyonCorsair: flaccid_: via knife solo
[2012-09-07 04:23:47 -0400] flaccid_: well regardless, you are missing chef_gem "mysql" in the recipe
[2012-09-07 04:24:12 -0400] flaccid_: i'm not familiar with what knife solo does sorry, but its probably omnibus these days
[2012-09-07 04:24:22 -0400] halcyonCorsair: yeah i think so
[2012-09-07 04:24:28 -0400] flaccid_: as you don't have the chef gem installed in the system ruby, it aint the system one..
[2012-09-07 04:24:30 -0400] halcyonCorsair: (not sure what that means exactly though)
[2012-09-07 04:24:38 -0400] flaccid_: it means it goes in /opt
[2012-09-07 04:24:43 -0400] flaccid_: its sandboxed
[2012-09-07 04:45:43 -0400] juliancdunn: jtimberman: do you know of anyone working on making the aws cookbook use right_aws > 3.0.0?
[2012-09-07 05:02:00 -0400] jtimberman: juliancdunn: no - though i'd rather use fog for that cookbook
[2012-09-07 05:02:38 -0400] jtimberman: http://tickets.opscode.com/browse/COOK-833
[2012-09-07 05:08:54 -0400] ssd7: Ohai Chefs
[2012-09-07 05:10:03 -0400] flaccid_: iaho
[2012-09-07 05:39:56 -0400] z: feeling the urge to write an exception handler called ohlol to combat the ohai
[2012-09-07 05:40:24 -0400] z: "ohlol: it failed again, are you paying attention?"
[2012-09-07 06:08:04 -0400] BryanWB: jtimberman, this is the ticket on postgresql::ruby, where it fails if u use yumrepo::postgresql9 to configure ur postgres repo
[2012-09-07 06:08:06 -0400] BryanWB: http://tickets.opscode.com/browse/COOK-1614
[2012-09-07 06:57:36 -0400] Guest71665: 1
[2012-09-07 07:08:50 -0400] justinlilly: How can I query for which nodes belong to a given EC2 security group?
[2012-09-07 07:10:51 -0400] ssd7: knife search node "ec2_security_groups:GROUPNAME"
[2012-09-07 07:12:04 -0400] justinlilly: blargh. I had a non-plural version of the key. Thanks!
[2012-09-07 07:30:53 -0400] kyank: Weird issue running chef-client for the first time on an Ubuntu 12.04 box. Debug output indicates it downloads the files for all the cookbooks on the server to the local cache, but then when it goes to use those files /var/cache/chef just contains a hierarchy of empty directories.
[2012-09-07 07:31:01 -0400] kyank: Any ideas?
[2012-09-07 07:32:45 -0400] kyank: Running chef-client a second time works.
[2012-09-07 07:43:22 -0400] BryanWB: kyank, look in /var/chef/cache/cookbooks
[2012-09-07 07:44:12 -0400] kyank: Hmm. /var/chef/cache contains only a checksums subdir.
[2012-09-07 07:44:31 -0400] kyank: Im surprised both /var/chef/cache and /var/cache/chef exist, though. Does that indicate a problem?
[2012-09-07 07:44:55 -0400] _rc: it more indicates you're using the omnibus version
[2012-09-07 07:45:02 -0400] kyank: But Im not.
[2012-09-07 07:45:19 -0400] kyank: chef-client was installed using the gem installer.
[2012-09-07 07:45:33 -0400] kyank: Actually, no, thats wrong: chef-solo was installed using the gem installer.
[2012-09-07 07:45:52 -0400] kyank: Then chef-solo installed chef client.
[2012-09-07 07:46:20 -0400] kyank: (Using http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz)
[2012-09-07 07:48:18 -0400] kyank: So, /var/cache/chef/cookbooks contains directories and subdirectories for all my cookbooks, but no files.
[2012-09-07 07:49:06 -0400] _rc: interesting.  the reason I say this is that on our platform we have a mix of /var/chef/cache being used by omnibus versions of chef, and the more normal /var/cache/chef being used by the package installed release
[2012-09-07 07:50:10 -0400] kyank: My setup works fine on Ubuntu 11. Let me check one of our production boxes to see what it has.
[2012-09-07 07:51:11 -0400] kyank: Yeah, same: /var/chef/cache containing just checksums, then everything else under /var/cache/chef.
[2012-09-07 08:24:17 -0400] BryanWB: obazoud, hey dude!
[2012-09-07 08:24:55 -0400] BryanWB: obazoud,  https://github.com/opscode-cookbooks/java/pull/14
[2012-09-07 08:51:16 -0400] obazoud: BryanWB,
[2012-09-07 08:53:04 -0400] obazoud: BryanWB, finally you use this hack :)
[2012-09-07 08:53:41 -0400] BryanWB: obazoud, y, tks for it!
[2012-09-07 09:02:54 -0400] BryanWB: is it possible to work on two cookbooks concurrently while using librarian?
[2012-09-07 09:04:58 -0400] BryanWB: hmmm prolly using the path: thing
[2012-09-07 09:25:18 -0400] williamherry: can chef handle iptables? any buildin resource?
[2012-09-07 09:26:17 -0400] williamherry: oh, I just remind, there can be handle by iptables cookbook, sorry
[2012-09-07 09:52:22 -0400] amccloud: Anyway to change the user the execute resource uses? I tried user 'myuser'
[2012-09-07 09:52:53 -0400] amccloud: but according to npm it's still root. At least that's what this error leads me to believe "Error: EACCES, mkdir '/root/.npm'"
[2012-09-07 12:38:56 -0400] motns: hi guys
[2012-09-07 12:42:38 -0400] rocket: Is anyone available to help me understand how I use the database cookbook.  I need to install a mysql server with it....
[2012-09-07 12:49:34 -0400] jwitrick: the database cookbook by it self wont install mysql-sever. it will only help configure databases/tables/users. you need to use both the  database cookbook and the mysql cookbook.
[2012-09-07 12:54:50 -0400] rocket: jwitrick: I think I figured that part out .. I guess I am confused by the app databag .. but I think I will figure it out ..
[2012-09-07 12:54:58 -0400] rocket: I just need to play with it more I think ..
[2012-09-07 13:12:34 -0400] shillinm: anyone awake?
[2012-09-07 13:35:52 -0400] geekbri: define awake
[2012-09-07 13:35:57 -0400] geekbri: parts of me are awake.
[2012-09-07 13:46:30 -0400] CharlieSu: i'm awakw
[2012-09-07 13:46:37 -0400] CharlieSu: awake* :)
[2012-09-07 13:47:08 -0400] jperry2: ohai everyone
[2012-09-07 13:47:21 -0400] CharlieSu: ohai!
[2012-09-07 13:47:26 -0400] SynchroM: I've installed chef-server 10.12 on Ubuntu Lucid from the opscode repo. For some reason the chef-expander service is going nuts - using 5Gb of memory and maxing out CPU and iowait, despite this being a new, completely empty install (no clients, no nodes, no cookbooks). It's set to use a single thread and its log file is empty. Any idea why it's doing that?
[2012-09-07 13:47:30 -0400] jperry2: anyone know the best way to audit knife commands run against the chef server?
[2012-09-07 13:47:50 -0400] jperry2: trying to track down a change made to the server
[2012-09-07 13:59:30 -0400] ssd7: jperry2: If you have access to the server, you should at least be able to see the API request in the server side log.
[2012-09-07 14:00:17 -0400] jperry2: @ssd7 - Do you happen to know the name of that log file?
[2012-09-07 14:01:41 -0400] ssd7: SynchroM: Hrmm.  Have you verified your config for expander is correct (correct rabbitmq password)?
[2012-09-07 14:01:56 -0400] ssd7: jperry2: Depends, but a typical location is /var/log/chef/server.log
[2012-09-07 14:02:02 -0400] jperry2: thx
[2012-09-07 14:02:40 -0400] SynchroM: ssd7: I'll check that
[2012-09-07 14:03:04 -0400] ssd7: jperry2: If it isn't there see if you have a different location specified in /etc/chef/server.rb or at the command line (ps auxww | grep chef, look for the -L flag)
[2012-09-07 14:04:57 -0400] ssd7: SynchroM: I would also check the rabbitmq logs to make sure you don't see anything suspicious there.
[2012-09-07 14:10:45 -0400] SynchroM: rabbit is reporting "Too many processes", even though expander isn't running. I can see what expander thinks the password is, but I don't know where rabbit keeps its password info or how to test it directly
[2012-09-07 14:13:13 -0400] ssd7: hrmm
[2012-09-07 14:19:40 -0400] ssd7: SynchroM: And I assume that restarting rabbitmq and expander leaves you in the same boat?
[2012-09-07 14:20:06 -0400] SynchroM: I just found that expander had the wrong solar url, fixed that
[2012-09-07 14:24:39 -0400] SynchroM: restarting didn't help. rabbit is still spewing errors and eating CPU: examples here: http://pastebin.com/1YQtGMFz
[2012-09-07 14:25:11 -0400] SynchroM: while there's lots there, it's not clear what's up!
[2012-09-07 14:26:16 -0400] ssd7: Hrmm. So rabbit is hitting its limit on erlang processes it looks like.
[2012-09-07 14:26:53 -0400] organicveggie: Is there any way to force CouchDB to compact? No matter how many times I do a post to "http://localhost:5984/chef/_compact", it say "compact_running : false".
[2012-09-07 14:28:03 -0400] SynchroM: far as I can see there are only 4 erlang processes: 3 for rabbit and 1 for couchdb
[2012-09-07 14:29:24 -0400] ssd7: SynchroM: Sorry, I believe that is refering to "erlang processes" as in processes inside the erlang VM, not actual system processes
[2012-09-07 14:29:30 -0400] SynchroM: ok
[2012-09-07 14:29:44 -0400] ssd7: SynchroM: can you show me the lines for ps auxww related to erlang (paste somewhere)
[2012-09-07 14:29:50 -0400] SynchroM: when I stop expander, rabbit's cpu usage drops to 0 too
[2012-09-07 14:30:25 -0400] ssd7: organicveggie: Does curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact come back with {"ok" : true}
[2012-09-07 14:30:35 -0400] organicveggie: ssd7: yup
[2012-09-07 14:31:42 -0400] organicveggie: It would be handy to be able to compact successfully, since my couch file is up to 192GB... :)
[2012-09-07 14:31:59 -0400] ssd7: SynchroM: Possibly relevant: http://tickets.opscode.com/browse/CHEF-3256
[2012-09-07 14:32:41 -0400] SynchroM: process info: http://pastebin.com/QqPKy4UH
[2012-09-07 14:34:05 -0400] ssd7: organicveggie: Could it be that the main couchdb is actually compacting, but you are compacting the views?
[2012-09-07 14:35:11 -0400] ssd7: organicveggie: Try curl -H "Content-Type: application/json" -X POST http://localhost:5984/chef/_compact/nodes
[2012-09-07 14:35:32 -0400] ssd7: organicveggie: See https://github.com/opscode/cookbooks/blob/master/chef-server/recipes/default.rb#L37 for the list of views you'll also want to compact
[2012-09-07 14:35:44 -0400] jtimberman: BryanWB__: I left a comment on COOK-1614
[2012-09-07 14:38:06 -0400] SynchroM: could well be that - rabbit says it has 32679 chef queues!
[2012-09-07 14:45:49 -0400] ssd7: SynchroM: Well, that would certainly explain why rabbit is running out of processes. I believe that is close to the initial default.
[2012-09-07 14:46:06 -0400] ssd7: By default expander should only be starting 1024 queues I believe.
[2012-09-07 14:46:22 -0400] SynchroM: so how can I get rid of them?
[2012-09-07 14:47:13 -0400] ssd7: SynchroM: can you paste the output of ps aux|grep expander somewhere for me?
[2012-09-07 14:49:45 -0400] SynchroM: http://pastebin.com/Gu4Htarx
[2012-09-07 14:49:54 -0400] jmara: hey there, short question are notifiers available for any default resources?
[2012-09-07 14:50:24 -0400] SynchroM: I can only run expander for a few seconds before it starts making other stuff slow down too much
[2012-09-07 14:52:22 -0400] jmara: like symlink "/my/vhost" do notifies :restart, resources(:service => "apache2") ?
[2012-09-07 14:53:59 -0400] ssd7: SynchroM: Unfortunately I have to run.  I would potentially try the work arounds mentioned in the bug report above.
[2012-09-07 14:54:26 -0400] SynchroM: I am - do you know where that VNODES value is set?
[2012-09-07 14:54:37 -0400] SynchroM: and thanks!
[2012-09-07 14:55:45 -0400] ssd7: SynchroM: Unforutnately it is set in the code itself, but since your config files are also ruby, I think you can place that right in your solr.rb fiel.
[2012-09-07 14:56:09 -0400] SynchroM: ok, will give that a try
[2012-09-07 15:01:40 -0400] Loof: I'm trying to manage some windows servers /w chef and am getting a bogus FQDN entry
[2012-09-07 15:01:46 -0400] Loof: Any idea what might be wrong there?
[2012-09-07 15:19:38 -0400] benlangfeld: Hello gents. Quick question about execution order. I have this recipe: https://gist.github.com/b4cab2f8d1d673bad066 I would like to execute the last block (adding users) after the config file has been placed and the service restarted. How might I do that?
[2012-09-07 15:20:48 -0400] Mithrandir: use subscribes
[2012-09-07 15:21:07 -0400] Mithrandir: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-09-07 15:21:37 -0400] benlangfeld: But the problem is that the last block is a databag search, not a single execute block
[2012-09-07 15:21:49 -0400] benlangfeld: So how would I reference it?
[2012-09-07 15:22:02 -0400] benlangfeld: it doesn't have a name like other resources
[2012-09-07 15:22:51 -0400] benlangfeld: Oh, subscribes go the other way around. That could work
[2012-09-07 15:23:24 -0400] organicveggie: ssd7: went through all of the views. that didn't seem to change anything. "curl http://localhost:5984/chef" still says "compact_running":false. And size on disk didn't change.
[2012-09-07 15:24:58 -0400] adamjon8_: How do I specify separate nginx.conf templates for my dev and prod environments?
[2012-09-07 15:25:56 -0400] adamjon8_: New to chef here and not sure exactly how it works
[2012-09-07 15:26:03 -0400] adamjon8_: How do I specify separate nginx.conf templates for my dev and prod environments?
[2012-09-07 15:26:27 -0400] adamjon8_: Not just nginx, really any ERB template for any cookbook where I would need a separate config based on role and environment
[2012-09-07 15:27:16 -0400] organicveggie: adamjon8_: There are a variety of ways you can do it. I use separate roles for each environment and within the roles set and attribute that describes the name of the config file.
[2012-09-07 15:28:39 -0400] adamjon8_: organicveggie: config file being the name of the erb template?
[2012-09-07 15:29:18 -0400] organicveggie: yup
[2012-09-07 15:31:13 -0400] organicveggie: ssd7: i also tried shutting down chef-server, chef-solr and chef-solr-indexer to see if eliminating writes made a difference. no such luck.
[2012-09-07 15:35:22 -0400] organicveggie: No matter what I do, I just can't seem to convince couch to compact... :(  Running Chef 0.9.14 with CouchDB 1.0.1.
[2012-09-07 15:35:49 -0400] organicveggie: Even tried reducing the _revs_limits from 1000 to 500.
[2012-09-07 15:36:31 -0400] adamjon8_: organicveggie: how do i create an attribute that is relative to my chef dir
[2012-09-07 15:36:36 -0400] adamjon8_: trying to do something like
[2012-09-07 15:37:01 -0400] adamjon8_: default['nginx']['template'] = templates/d.conf.erb
[2012-09-07 15:37:19 -0400] organicveggie: adamjon8_: you can't do relative paths of any kind. it can only be the name of the erb template. all erb templates come from the templates folder for your cookbook.
[2012-09-07 15:37:30 -0400] adamjon8_: ok
[2012-09-07 15:37:33 -0400] adamjon8_: so then in the recipe
[2012-09-07 15:37:37 -0400] adamjon8_: how would I reference it?
[2012-09-07 15:37:44 -0400] organicveggie: so, you could have default['nginx']['template'] = "d.conf.erb"
[2012-09-07 15:38:06 -0400] organicveggie: And then in the recipe, you simply reference node['nginx']['template']
[2012-09-07 15:38:15 -0400] adamjon8_: ok
[2012-09-07 15:38:17 -0400] adamjon8_: so template source
[2012-09-07 15:38:18 -0400] adamjon8_: would be
[2012-09-07 15:38:23 -0400] adamjon8_: node['nginx']['template']?
[2012-09-07 15:38:26 -0400] organicveggie: yup
[2012-09-07 15:38:30 -0400] alexbst: lol - I have a similar question
[2012-09-07 15:38:34 -0400] cheeseplus: adamjon8_: I would approach this from a different angle, don't change the template, change the attributes per environment that populate the template
[2012-09-07 15:38:55 -0400] alexbst: in a template can I use node[:stuff][:attribute] directly ?
[2012-09-07 15:39:03 -0400] adamjon8_: cheeseplus: yes but my dev config is a lot different than my prod config
[2012-09-07 15:39:21 -0400] adamjon8_: For example, I serve static files locally through nginx in dev and from EC2 in prod
[2012-09-07 15:39:35 -0400] organicveggie: alexbst: yes, but i believe it's frowned upon. better to pass in the variables so that the template doesn't depend on a specific set of attributes.
[2012-09-07 15:39:46 -0400] yfeldblum: organicveggie, might want to try in #couchdb?
[2012-09-07 15:39:59 -0400] organicveggie: yfeldblum: thanks. i'm just not having a lot of luck this week. :)
[2012-09-07 15:40:40 -0400] cheeseplus: adamjon8_: you can make it work the other way certainly but that means changing your cookbook as opposed to leveraging the attributes
[2012-09-07 15:40:53 -0400] adamjon8_: cheeseplus: what would you suggest for my usecase?
[2012-09-07 15:41:26 -0400] cheeseplus: I'm always of the mind to keep the cookbook the same and use either node/role overrides for attributes
[2012-09-07 15:41:46 -0400] organicveggie: cheeseplus: i think we're talking about the same approach.
[2012-09-07 15:42:10 -0400] organicveggie: cheeseplus: i think adamjon8_ has the source template currently hardcoded.
[2012-09-07 15:43:53 -0400] kbishop: are there any resources available to download a single file from a private git repo?
[2012-09-07 15:43:57 -0400] adamjon8_: organicveggie: yeh i do, is that bad
[2012-09-07 15:44:31 -0400] organicveggie: adamjon8_: i wouldn't say it's "bad". i think many of us start that way and eventually move to defining those things in attributes. it's all a matter of what works best for you. :)
[2012-09-07 15:44:48 -0400] adamjon8_: alright cool
[2012-09-07 15:45:08 -0400] adamjon8_: just testing chef-solo out on vagrant right now
[2012-09-07 15:45:19 -0400] adamjon8_: hoping it works a lot better than my complicated git hooks for deployment
[2012-09-07 15:45:20 -0400] adamjon8_: :P
[2012-09-07 15:46:32 -0400] organicveggie: Does anyone here use rbenv on their servers? i've worked with rvm and love it for my workstation, but I find it annoying on servers when it comes to running cron jobs. trying to see if rbenv might be a better fit.
[2012-09-07 15:46:42 -0400] organicveggie: specifically for running chef.
[2012-09-07 15:47:11 -0400] cheeseplus: adamjon8_: yea it's not bad (chef can certainly accomodate) but the more elegant method would be using the attributes to drive the differences in environemtn
[2012-09-07 15:48:26 -0400] yfeldblum: organicveggie, why do you find it annoying when running cron jobs?
[2012-09-07 15:49:53 -0400] yfeldblum: organicveggie, e.g. i would drop a script that starts with: `#!/bin/bash ; . /etc/profile.d/rvm.sh ; rvm use 1.9.3-p194 ; some-other-stuff` and cron the script
[2012-09-07 15:50:36 -0400] organicveggie: yfeldblum: only annoying because then i have to write wrappers around every cron job I already wrote. :)
[2012-09-07 15:51:16 -0400] organicveggie: yfeldblum: it all boils down to my efforts to upgrade to Chef 10.12 and my hope that it not take me a month. :)
[2012-09-07 15:51:59 -0400] organicveggie: it's not that modifying cron jobs and writing wrapper scripts is a big deal - it isn't. It's just more busy work. :)
[2012-09-07 15:53:20 -0400] organicveggie: Well, it's also annoying b/c I would have to maintain two versions of everything while I go through 170 servers and switch to rvm.
[2012-09-07 15:56:02 -0400] jdsanders: Is anyone well-versed in the application cookbook? Or more specifically the application_ruby variant of it?
[2012-09-07 15:57:08 -0400] jdsanders: I'm trying to use just the basic setup with an empty rails block and an empty passenger_apache2 block, but the apache2 installation is getting mad at me because I haven't overridden the apache configuration template
[2012-09-07 15:57:28 -0400] jdsanders: I was thinking it would just use the default one, but it's looking for one named <my_app_name>.conf.erb
[2012-09-07 15:58:03 -0400] yfeldblum: organicveggie, migrations are tough, no doubt about it
[2012-09-07 15:58:22 -0400] cap10morgan: do cookbook version constraints work with anything more complex than major.minor.patch version numbers?
[2012-09-07 15:58:37 -0400] adamjon8_: Alright so I should use a provider to deploy my applications?
[2012-09-07 15:58:44 -0400] cap10morgan: I'm wanting to do a local version number like 1.3.0.1 (where 1.3.0 is the upstream version)
[2012-09-07 15:58:45 -0400] organicveggie: yfeldblum: they're also hard to "sell" to the rest of the team. :)
[2012-09-07 15:59:49 -0400] yfeldblum: organicveggie, you would think selling them on sticking with centos-4 when centos-7 ships would be the tougher proposition
[2012-09-07 16:00:55 -0400] organicveggie: :)
[2012-09-07 16:01:28 -0400] organicveggie: it's all about "features" here e.g. if organicveggie spends his time upgrading Chef, he's not spending his time helping the developers get new features out to suers. :)
[2012-09-07 16:01:41 -0400] organicveggie: s/suers/users/g
[2012-09-07 16:03:41 -0400] yfeldblum: organicveggie, why do they need help?
[2012-09-07 16:04:11 -0400] organicveggie: yfeldblum: Ahhh, that's a lovely can of worms. :)
[2012-09-07 16:04:53 -0400] organicveggie: yfeldblum: complex environment and most of the dev team isn't well focused on scalability and performance, due to the past obsession with features.
[2012-09-07 16:05:07 -0400] yfeldblum: organicveggie, force them to move to http://www.12factor.net/ :P
[2012-09-07 16:06:32 -0400] organicveggie: yfeldblum: we're actually pretty far along that path, it's the legacy crap that holds us back. for example, 3 years ago we made some bad decisions on how to manage environment settings. we still haven't fully migrated away from that.
[2012-09-07 16:07:15 -0400] yfeldblum: organicveggie, is it fixable?
[2012-09-07 16:07:37 -0400] organicveggie: yfeldblum: yes. if it weren't, i'd have moved on. :)
[2012-09-07 16:08:15 -0400] yfeldblum: organicveggie, what about fixing that first and then upgrading chef?
[2012-09-07 16:14:24 -0400] organicveggie: yfeldblum: time. there are a lot of little legacy things. and they just don't get prioritized. :(
[2012-09-07 16:16:15 -0400] yfeldblum: organicveggie, the things you're talking about are completely new to me and i have never seen them before ever
[2012-09-07 16:16:54 -0400] organicveggie: yfeldblum: HAH!
[2012-09-07 16:17:30 -0400] organicveggie: I think I need a new emoticon for the combination of laughing and crying simultaneously. :)
[2012-09-07 16:18:20 -0400] yfeldblum: ~_~
[2012-09-07 16:30:09 -0400] organicveggie: does anyone know if Chef 0.9.14 requires CouchDB 1.0.x? Or can I upgrade CouchDB?
[2012-09-07 16:51:50 -0400] benlangfeld: Mithrandir: subscription looked good, but it doesn't seem to work: https://gist.github.com/33c9b8a38a0cfc128f6f
[2012-09-07 16:52:35 -0400] benlangfeld: Mithrandir: Any good ideas?
[2012-09-07 16:53:46 -0400] Mithrandir: you want subscribes :run,
[2012-09-07 16:54:11 -0400] benlangfeld: No, because I want to only do it after the service is restarted
[2012-09-07 16:54:26 -0400] benlangfeld: Not when it's run the first time after the package installed
[2012-09-07 16:54:51 -0400] benlangfeld: 1) Install package (starts service)
[2012-09-07 16:54:52 -0400] benlangfeld: 2) Place template
[2012-09-07 16:54:52 -0400] benlangfeld: 3) Restart service
[2012-09-07 16:54:52 -0400] benlangfeld: 4) Add users
[2012-09-07 16:55:14 -0400] Mithrandir: create a dummy execute resource that you notify when you restart and which the other exec resources subscribe to, then
[2012-09-07 16:55:30 -0400] benlangfeld: Why can't I subscribe to :restart?
[2012-09-07 16:56:02 -0400] Mithrandir: because that isn't how subscribes work. :-)
[2012-09-07 16:56:07 -0400] benlangfeld: hmm
[2012-09-07 16:56:10 -0400] benlangfeld: ok
[2012-09-07 16:56:12 -0400] Mithrandir: they trigger when a resource is updated
[2012-09-07 16:56:39 -0400] Mithrandir: but really, I don't think you can do it that way either, since you use :immediately
[2012-09-07 16:57:12 -0400] benlangfeld: What other way is there to say "do this after this other thing finishes"?
[2012-09-07 16:58:10 -0400] Mithrandir: why do you need it to be restarted immediately?
[2012-09-07 16:58:38 -0400] jessicab: you could probably use notifies? it works the other way around, notifies another resource when it updates
[2012-09-07 16:58:52 -0400] benlangfeld: I need to restart ejabberd after its config is updated, so it can reload its config, and then add the users (which is only possible when the correct config is loaded).
[2012-09-07 16:59:18 -0400] benlangfeld: jessicab: I can't use notification because the user addition routine is a databag search
[2012-09-07 17:00:26 -0400] benlangfeld: The routine (install something, configure it, start it up then interact with it) is fairly common, there must be a simple way to do it.
[2012-09-07 17:00:49 -0400] Mithrandir: benlangfeld: hmm, so why do you even need to have the search listen for ejabberd restarts?  Just have the template restart ejabberd when the template is updated an then run the exec afterwards?
[2012-09-07 17:01:10 -0400] Mithrandir: chef recipes are run in the order they're declared anyway
[2012-09-07 17:01:58 -0400] benlangfeld: Mithrandir: Because then the user addition executes before the process starts
[2012-09-07 17:02:29 -0400] benlangfeld: I'll get you logs from a test run
[2012-09-07 17:02:37 -0400] Mithrandir: benlangfeld: make the template notifies .., :immediately and it'll work
[2012-09-07 17:03:49 -0400] benlangfeld: ok, testing that
[2012-09-07 17:06:13 -0400] yfeldblum: Mithrandir, IMO prefer ruby_block or log resources to execute resources, for minimal side-effects
[2012-09-07 17:10:13 -0400] benlangfeld: Mithrandir: Doesn't work still: https://gist.github.com/b09975453d9d5959a592
[2012-09-07 17:10:48 -0400] benlangfeld: Maybe I just need to sleep a little to give ejabberd time to boot.
[2012-09-07 17:15:23 -0400] benlangfeld: You know what? That worked. I should have just tried that earlier. Do you think that's ejabberd, the upstart script or chef at fault, for continuing before the process was actually fully booted?
[2012-09-07 17:18:07 -0400] SplasPood: 'lo all, can anyone tell me the proper syntax for value_for_platform to say 'where platform_version >= 6', if that's even possible..
[2012-09-07 17:19:59 -0400] cheeseplus: SplasPood: use node['platform_version'].to_i >= 6
[2012-09-07 17:20:43 -0400] SplasPood: Well I mean, I can do that in my own code, sure, I was wondering if the existing value_for_platform supported anything like that
[2012-09-07 17:20:49 -0400] cheeseplus: ahh
[2012-09-07 17:21:10 -0400] yfeldblum: SplasPood, is there a specific need to use #value_for_platform and not just regular old ruby?
[2012-09-07 17:21:10 -0400] SplasPood: I guess I can/should just read the source
[2012-09-07 17:21:17 -0400] SplasPood: yfeldblum: none, just existing use
[2012-09-07 17:27:45 -0400] SplasPood: to answer my own question, it does not appear the existing helper supports such a thing.  Straight ruby here we come
[2012-09-07 17:36:12 -0400] btm: Chef 10.14.0 is out: http://bit.ly/Q4kp31
[2012-09-07 17:46:52 -0400] adamjon8_: Hm
[2012-09-07 17:46:53 -0400] _pol: Is it possible for a recipe to require a Role?
[2012-09-07 17:46:58 -0400] adamjon8_: I keep getting a cannot find Resource error
[2012-09-07 17:47:03 -0400] adamjon8_: but
[2012-09-07 17:47:07 -0400] adamjon8_: my resource is there
[2012-09-07 17:47:09 -0400] adamjon8_: i get
[2012-09-07 17:47:14 -0400] adamjon8_: FATAL: NameError: Cannot find a resource for django on ubuntu version 12.04
[2012-09-07 17:47:17 -0400] adamjon8_: yet its in
[2012-09-07 17:47:28 -0400] adamjon8_: cookbooks/application_django/resources/django.rb
[2012-09-07 17:47:32 -0400] adamjon8_: why is it not including it :(
[2012-09-07 17:49:00 -0400] adamjon8_: organicveggie: any insight?
[2012-09-07 17:49:36 -0400] mal_: Does anyone know what "ruby_block[xyz] (packe line #) has had an error" is when it's at home? The block runs fine when not used as a notify target
[2012-09-07 17:50:30 -0400] mal_: What line are you using it on adamjon8_?
[2012-09-07 17:51:13 -0400] adamjon8_: I'm using it in cookbooks/application_django/recipes/dev.rb
[2012-09-07 17:51:18 -0400] adamjon8_: django do
[2012-09-07 17:51:18 -0400] adamjon8_: cwd "/vagrant"
[2012-09-07 17:51:18 -0400] adamjon8_: requirements "settings/dev_requirements.txt"
[2012-09-07 17:51:20 -0400] adamjon8_: collectstatic "build_static --noinput"
[2012-09-07 17:51:20 -0400] adamjon8_: end
[2012-09-07 17:52:09 -0400] adamjon8_: mal_: I guess I'm just not sure how it finds resources
[2012-09-07 17:52:12 -0400] adamjon8_: I'm guessing thats the issue
[2012-09-07 17:52:37 -0400] mal_: Ahh, maybe it should be a definition
[2012-09-07 17:52:46 -0400] adamjon8_: how do i do that?
[2012-09-07 17:53:00 -0400] adamjon8_: err why would I do that
[2012-09-07 17:53:00 -0400] mal_: http://wiki.opscode.com/display/chef/Definitions
[2012-09-07 17:53:17 -0400] adamjon8_: oh so i need to define a resource first?
[2012-09-07 17:53:28 -0400] mal_: define "django" do ... end
[2012-09-07 17:53:38 -0400] mal_: Then you can use django the way you're trying to
[2012-09-07 17:54:06 -0400] adamjon8_: mal_: do you have to do that whenever you create your own resource?
[2012-09-07 17:54:39 -0400] mal_: From your example, you probably want "define :django, :cwd => nil, :requirements => nil, :collectstatic => nil do"
[2012-09-07 17:54:56 -0400] adamjon8_: yes but how would I do it with the way I have it setup
[2012-09-07 17:55:03 -0400] adamjon8_: i.e. using a resource/resourename.rb
[2012-09-07 17:55:12 -0400] adamjon8_: *resources/nameofresource.rb
[2012-09-07 17:55:36 -0400] mal_: I've never seen a resources directory
[2012-09-07 17:55:39 -0400] mal_: Is it a thing?
[2012-09-07 17:56:04 -0400] adamjon8_: uh yeah...
[2012-09-07 17:56:14 -0400] adamjon8_: I'm trying to create django as a provider
[2012-09-07 17:56:20 -0400] kallistec: adamjon8_: IIRC, LWRP resources get named cookbookname_resourcename
[2012-09-07 17:56:42 -0400] adamjon8_: @kallistec: ok, but the sample i saw on github wasn't that way..hrmph
[2012-09-07 17:57:06 -0400] _pol: One more try: Is it possible for a recipe to require a Role?
[2012-09-07 17:57:10 -0400] adamjon8_: FATAL: NameError: Cannot find a resource for appplication_django_django
[2012-09-07 17:57:36 -0400] adamjon8_: _pol: why would you want to do that
[2012-09-07 17:58:50 -0400] organicveggie: adamjon8_: sorry, wasn't paying attention.
[2012-09-07 17:59:02 -0400] adamjon8_: trying to create a resource and failing hard
[2012-09-07 17:59:19 -0400] organicveggie: how are you referencing the resource?
[2012-09-07 17:59:25 -0400] adamjon8_: django do
[2012-09-07 17:59:41 -0400] adamjon8_: from in cookbooks/application_django/recipes/dev.rb
[2012-09-07 17:59:43 -0400] adamjon8_: the resource is in
[2012-09-07 17:59:51 -0400] adamjon8_: from in cookbooks/application_django/resources/django.rb
[2012-09-07 18:00:47 -0400] adamjon8_: Hrm whats the difference between definitions and resource files?
[2012-09-07 18:00:54 -0400] adamjon8_: I think I'm setting it up as a provider
[2012-09-07 18:02:03 -0400] geekbri: adamjon8_: a definition becomes a resource but you can't subscribe or notify definitions
[2012-09-07 18:02:21 -0400] adamjon8_: ah
[2012-09-07 18:02:31 -0400] adamjon8_: alright then it looks like i wanted a definition all along
[2012-09-07 18:02:31 -0400] adamjon8_: :P
[2012-09-07 18:02:33 -0400] adamjon8_: thanks guys
[2012-09-07 18:02:38 -0400] geekbri: adamjon8_: keep in mind the way the light weight resources work is that by default they are named for the cookbook / file they are in so
[2012-09-07 18:02:48 -0400] geekbri: mycookbook/resources/default.rg woudl be the resource mycookbook
[2012-09-07 18:02:58 -0400] geekbri: and mycookbook/resources/somethingelse.rb would be mycookbook_somethingelse
[2012-09-07 18:03:19 -0400] geekbri: resources also need an accompanying providers in the providers directory
[2012-09-07 18:03:36 -0400] geekbri: (by default they look for a same named provider unless you specify otherwise)
[2012-09-07 18:04:16 -0400] adamjon8_: geekbri: thanks much
[2012-09-07 18:04:21 -0400] geekbri: no problemo
[2012-09-07 18:04:36 -0400] geekbri: I would be lying if I said I scrolled up and read your whole question, but if you have anymore shoot them off :)
[2012-09-07 18:04:39 -0400] _pol: adamjon8_: I am making machine-specific recipes that just contain everything to rebuild that one machine. This often-times includes a role for the machine.
[2012-09-07 18:05:48 -0400] mal_: Any ideas how to address this? "ruby_block[plugin_setup] (test::recipe2 line 2) has had an error"
[2012-09-07 18:06:13 -0400] mal_: The ruby_block runs fine with action :create, but gets upset when I try to call it from a notification
[2012-09-07 18:08:36 -0400] mal_: ;(
[2012-09-07 18:08:59 -0400] btm: mal_: got a gist of the recipe and the error? (preferably with -l debug)
[2012-09-07 18:09:26 -0400] mal_: I do not, most because I did not know that -l debug existed
[2012-09-07 18:09:28 -0400] mal_: mostly
[2012-09-07 18:09:34 -0400] mal_: I shall investigate
[2012-09-07 18:09:36 -0400] mal_: ty
[2012-09-07 18:12:43 -0400] atomic-penguin: Stupid ruby question.  I'm working on a test-kitchen fix, how do I build the gem, so I can test the fix?
[2012-09-07 18:14:32 -0400] geekbri: atomic-penguin: gem build <gemspec file> ?
[2012-09-07 18:14:43 -0400] atomic-penguin: thank ya
[2012-09-07 18:14:45 -0400] jtimberman: atomic-penguin: there's a rake task in teh test-kitchen repo
[2012-09-07 18:15:04 -0400] atomic-penguin: jtimberman, I figured
[2012-09-07 18:15:09 -0400] mal_: Apparently run_action can't find the ruby_block despite it being defined 5 lines above the notification
[2012-09-07 18:15:33 -0400] atomic-penguin: rake build FTW
[2012-09-07 18:15:39 -0400] mal_: NameError: Cannot find a resource for action_run on ubuntu version 12.04
[2012-09-07 18:15:39 -0400] btm: mal_: seeing the actual recipe would really help :)
[2012-09-07 18:15:49 -0400] mal_: I'll gist it, hang on
[2012-09-07 18:18:32 -0400] jtimberman: atomic-penguin: :)
[2012-09-07 18:18:39 -0400] jtimberman: sorry for the slightly unhelpful reply. :D
[2012-09-07 18:19:19 -0400] amccloud: How do you have the execute resource run as another user?
[2012-09-07 18:19:27 -0400] amccloud: I tried user 'myuser'
[2012-09-07 18:19:33 -0400] mal_: btm: https://gist.github.com/be59dcb29fcda8e113e8
[2012-09-07 18:19:45 -0400] _pol: does putting a "depends foo" in the metadata of a recipe mean that the recipe actually gets run?  Or do I hove to include_recipe to get it to run?
[2012-09-07 18:20:09 -0400] jtimberman: _pol: you have to use include_recipe, or have the recipe in the run list
[2012-09-07 18:20:16 -0400] _pol: Ok.
[2012-09-07 18:20:22 -0400] jtimberman: _pol: chef does not run any recipes unless they're in the run list or included specifically
[2012-09-07 18:20:33 -0400] _pol: jtimberman: is there an "include_role" method also?
[2012-09-07 18:20:36 -0400] jtimberman: no
[2012-09-07 18:20:38 -0400] amccloud: but according to npm it's still running as root. At least that's what this error leads me to believe "Error: EACCES, mkdir '/root/.npm'] errno: 3"
[2012-09-07 18:20:43 -0400] jtimberman: roles go in the run list directly
[2012-09-07 18:20:48 -0400] jtimberman: either in the node's or another role's
[2012-09-07 18:21:13 -0400] atomic-penguin: I thinnk I got it working for me now
[2012-09-07 18:21:18 -0400] _pol: jtimberman: thanks
[2012-09-07 18:21:22 -0400] geekbri: I believe depends just makes sure that the cookbook exists on the server
[2012-09-07 18:21:22 -0400] atomic-penguin: nope
[2012-09-07 18:21:25 -0400] jtimberman: mal_: the action to notify a ruby_block is :create
[2012-09-07 18:21:26 -0400] atomic-penguin: hmm
[2012-09-07 18:21:29 -0400] jtimberman: not run
[2012-09-07 18:22:01 -0400] jtimberman: mal_: so you'll want notifies :create, "ruby_block[plugin_setup]"
[2012-09-07 18:22:15 -0400] jtimberman: geekbri: depends makes sure that the cookbook is downloaded from the server to the client.
[2012-09-07 18:22:32 -0400] mal_: Please excuse me while I step out to severely maim the colleage that handed this off to me
[2012-09-07 18:22:35 -0400] geekbri: Right right, apologies, that is more what I meant to say
[2012-09-07 18:22:35 -0400] mal_: And thanks!
[2012-09-07 18:22:37 -0400] jtimberman: mal_: :D
[2012-09-07 18:22:42 -0400] jtimberman: mal_: I suggest hugging.
[2012-09-07 18:22:44 -0400] geekbri: "makes sure the proper cookbook and version exists in the chefs cookbook cache"
[2012-09-07 18:23:06 -0400] jtimberman: geekbri: np, i'm pedantic :)
[2012-09-07 18:23:12 -0400] geekbri: Just remember, it is generally cheaper to kill you friends in an automative accident than to maim them!
[2012-09-07 18:24:11 -0400] geekbri: disclaimer, I am not a personal injury attorney.
[2012-09-07 18:25:39 -0400] mal_: Sage advice, I shall take it into consideration once the maiming is complete
[2012-09-07 18:26:47 -0400] mal_: Also, is there a way to check which resources are defined?
[2012-09-07 18:26:59 -0400] geekbri: jtimberman: you more than make up for it with your liberal hug distribution
[2012-09-07 18:27:24 -0400] mal_: i.e. one recipe does service "lmao" and the next recipe wants to restart it only if it exists
[2012-09-07 18:27:51 -0400] mal_: Did I just answer my own question with "only_if" ?
[2012-09-07 18:28:32 -0400] mal_: Oh, not quite, I only want to notify if, I still want the containing task to run
[2012-09-07 18:28:49 -0400] CharlieSu: ohai chefs!  Congrats on 10.14.0.  Glad to see RubyGems get bumped..
[2012-09-07 18:29:04 -0400] geekbri: typically you don't want to execute a resource simply because anothee resource is defined.  You generally want to notify another resource to run when your current resource makes some change
[2012-09-07 18:29:49 -0400] mal_: I want to notify a resource, but only if that resource exists
[2012-09-07 18:29:56 -0400] geekbri: you can get the resource_collection from the run_context
[2012-09-07 18:30:21 -0400] mal_: Ta, I'll investigate
[2012-09-07 18:31:24 -0400] geekbri: I can't think of a situation where i've ever tried to notify a resource that might not exist
[2012-09-07 18:31:39 -0400] benlangfeld: Have the other resource subscribe?
[2012-09-07 18:31:50 -0400] geekbri: +1 that
[2012-09-07 18:31:55 -0400] geekbri: makes more sense.
[2012-09-07 18:33:46 -0400] Mithrandir: benlangfeld: the service command shouldn't return before the process is ready, so quite clearly upstart/ejabberd
[2012-09-07 18:34:24 -0400] mal_: I have one recipe that does a base install, then another than concatenates additonal lines to a config; the second recipe isn't always called, but when the first recipe rewrites the config, it has to tell the second to reappend the lines, but only if recipe2 is in the run list
[2012-09-07 18:34:29 -0400] benlangfeld: Mithrandir: Thanks. One day in a mythical future where it really matters, I might try to figure out why, but for now I can just sleep and it works :) Thanks for your help.
[2012-09-07 18:35:08 -0400] mal_: benlangfeld: oooh fancy, I'll see if I can get subscriptions working
[2012-09-07 18:35:25 -0400] gregburek: Any recommendations for using encrypted data bags with chef-solo?
[2012-09-07 18:35:31 -0400] gregburek: knife-solo looks cool
[2012-09-07 18:35:54 -0400] geekbri: mal_: this is sort of non chef related, but wouldn't it make more sense to use the conf.d pattern (if possible)
[2012-09-07 18:36:27 -0400] timsmith: Has anyone run into issues with the User provider on Linux boxes with 10.14?
[2012-09-07 18:37:38 -0400] timsmith: I use manage home = true and my chef runs are all failing when Chef tries to run an invalid usermod command
[2012-09-07 18:37:45 -0400] timsmith: bad syntax on the command
[2012-09-07 18:38:39 -0400] mal_: geekbri: god, yes it would
[2012-09-07 18:38:58 -0400] geekbri: Guessing thats not possible :)
[2012-09-07 18:39:29 -0400] mal_: Sadly serverdensity's agent takes a single config
[2012-09-07 18:40:02 -0400] mal_: I could patch it, but then it'd have to be maintained
[2012-09-07 18:40:11 -0400] geekbri: :-\
[2012-09-07 18:40:37 -0400] mal_: Maybe I'll do it anyway for the grief it'll save me
[2012-09-07 18:40:39 -0400] mal_: Hmmm
[2012-09-07 18:41:28 -0400] jwitrick: For the opscode guys: does anyone know why the mount resource does not work: #{node['ms_mercury']['index_volume_group_path']}"
[2012-09-07 18:41:33 -0400] jwitrick: https://gist.github.com/3668478
[2012-09-07 18:41:33 -0400] mal_: It'll have to be conf.d/instance/*.cfg since we're trying to run multiple instances with different configs
[2012-09-07 18:41:50 -0400] mal_: For some reason you can't monitor more than one mysql DB from a single server by default
[2012-09-07 18:42:11 -0400] geekbri: jwitrick: is it possible you have mount_point and device backwards?
[2012-09-07 18:42:21 -0400] amccloud: Can anyone help me? Here is a full paste of my stacktrace and recipe https://gist.github.com/e09d2969c7e8fc05fb02
[2012-09-07 18:42:40 -0400] jwitrick: geekbri: why would it not add everything to the mount line?
[2012-09-07 18:43:01 -0400] geekbri: jwitrick: you have your device as "/mnt/mercdata" and your mountpoint as a device
[2012-09-07 18:43:12 -0400] geekbri: so you might want to fix that before going any further :)
[2012-09-07 18:43:50 -0400] atomic-penguin: Fixed it woo!
[2012-09-07 18:45:32 -0400] jwitrick: geekbri: verifying swapping the 2 values.
[2012-09-07 18:47:16 -0400] geekbri: I'll have to test out the new chef-client and see if it breaks anything.
[2012-09-07 18:47:24 -0400] geekbri: so I can enjoy me some deliciously formatted output
[2012-09-07 18:49:41 -0400] Twirrim: -Fdoc is so much easier to read :)
[2012-09-07 18:51:17 -0400] jwitrick: geekbri: no luck.
[2012-09-07 18:51:29 -0400] jwitrick: i switched them around and it still does not work.
[2012-09-07 18:51:58 -0400] geekbri: jwitrick: you could re-gist the new output
[2012-09-07 18:53:43 -0400] jwitrick: geekbri: https://gist.github.com/3668478
[2012-09-07 18:54:03 -0400] Pushnell: Is there a guide somewhere for upgrading?
[2012-09-07 18:54:53 -0400] Pushnell: Also, the blog post has a broken link to the mailing list.  *sigh*
[2012-09-07 18:54:56 -0400] amccloud: anyway to debug Mixlib::ShellOut::ShellCommandFailed ?
[2012-09-07 18:55:14 -0400] amccloud: I think my user attribute isn't sticking. But i'm not sure how to double check.
[2012-09-07 18:55:56 -0400] geekbri: amccloud: you can print the stderr of the command.  like for example  Chef::Log.info(Chef::ShellOut.new("some command").stderr)
[2012-09-07 18:56:20 -0400] geekbri: there is also .stdout and .status which is a Process:Status object (which has exitstatus accessor and pid I believe)
[2012-09-07 18:56:52 -0400] amccloud: geekbri: I'm getting the error. Looks like it's executing the command as root even though i specified a user.
[2012-09-07 18:57:15 -0400] geekbri: how are you specifying a user?
[2012-09-07 18:57:20 -0400] geekbri: what resource is this?
[2012-09-07 18:57:26 -0400] amccloud: geekbri: https://gist.github.com/e09d2969c7e8fc05fb02
[2012-09-07 18:57:58 -0400] amccloud: I should note I use node[:helium][:install][:user] all over the place it it works just fine.
[2012-09-07 18:58:29 -0400] geekbri: It looks to me like its trying to create a .npm directory in /root and perhaps not running it as root is whats causing it to fail
[2012-09-07 18:58:49 -0400] amccloud: geekbri: Right.
[2012-09-07 18:58:54 -0400] amccloud: oh
[2012-09-07 18:59:08 -0400] geekbri: is your current_dir variable set to roots home?
[2012-09-07 18:59:57 -0400] amccloud: if it was wouldn't that be /root/nitrogen/.npm?
[2012-09-07 19:00:42 -0400] geekbri: I am not a big node.js user so I can't speak too much about the behavior of how it decides to install what where, or cache directories
[2012-09-07 19:01:01 -0400] geekbri: but for some reason npm is trying to run in /root, and since you've changed off the root user, it doesn't have permissions to create that dir there
[2012-09-07 19:04:51 -0400] jwitrick: anyone know what I am doing wrong: https://gist.github.com/3668478
[2012-09-07 19:05:34 -0400] amccloud: geekbri: okay thanks i'll look into that
[2012-09-07 19:06:09 -0400] amccloud: usually node uses the cwd for installing. the .npm file usually goes in the the home directory of the current user
[2012-09-07 19:06:09 -0400] geekbri: jwitrick: I can't see whats wrong with it.  I find it strange that its just leaving off the device part
[2012-09-07 19:06:30 -0400] geekbri: amccloud: if that were the case it would probably be working as the user would be root :X
[2012-09-07 19:08:48 -0400] amccloud: true
[2012-09-07 19:10:47 -0400] jwitrick: geekbri: thanks for looking at it.
[2012-09-07 19:10:52 -0400] geekbri: np
[2012-09-07 19:11:11 -0400] geekbri: jwitrick: what version of chef?  I'll try to look at the mount provider if I have a chance
[2012-09-07 19:11:25 -0400] jwitrick: right now it was 10.12
[2012-09-07 19:11:31 -0400] jwitrick: im updating it to 10.14
[2012-09-07 19:11:34 -0400] jwitrick: to see if anything changes.
[2012-09-07 19:12:50 -0400] kallistec: amccloud: setting the user for a command doesn't reload the environment. This is similar to the behavior of 'su' vs. 'su -'
[2012-09-07 19:13:23 -0400] amccloud: kallistec: Ah what do you recommend then?
[2012-09-07 19:14:01 -0400] geekbri: jwitrick: have you specified the "device_type" attribute, that could be the issue
[2012-09-07 19:14:16 -0400] kallistec: I outlined a way to make it work for the bash resource, but it's not implemented yet. In the meantime, set whatever environment you need, or use `bash -l`
[2012-09-07 19:14:38 -0400] geekbri: jwitrick: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/mount/mount.rb#L146-149
[2012-09-07 19:14:43 -0400] kallistec: amccloud: http://tickets.opscode.com/browse/CHEF-2288
[2012-09-07 19:15:06 -0400] geekbri: jwitrick: also https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/mount/mount.rb#L186-195
[2012-09-07 19:15:34 -0400] geekbri: jwitrick: it defaults to :device
[2012-09-07 19:15:45 -0400] geekbri: which actually looks right for your case I guess...
[2012-09-07 19:16:15 -0400] jwitrick: ya. that does not look like it needs to be there.
[2012-09-07 19:16:44 -0400] amccloud: kallistec: thanks! this is exactly what I needed
[2012-09-07 19:27:29 -0400] mal_: Thanks for all your help guys; time for the weekend! ;D
[2012-09-07 19:28:59 -0400] benjaminws: heyooo
[2012-09-07 19:29:09 -0400] benjaminws: jtimberman: you around here?
[2012-09-07 19:32:21 -0400] benjaminws: ;)
[2012-09-07 19:33:35 -0400] benjaminws: beetlejuice
[2012-09-07 19:34:57 -0400] Twirrim: that would be it.. doh!  Candyman was 5x looking at a mirror?
[2012-09-07 19:36:04 -0400] benjaminws: Something like that
[2012-09-07 19:36:25 -0400] jwitrick: geekbri: it turns out someone was changing the variable name and I didnt notice. so your tip that I had reversed the device/mount_point saved me. thanks for you help
[2012-09-07 19:37:45 -0400] geekbri: jwitrick: np!
[2012-09-07 19:47:04 -0400] elijah-mbp: i want to use an attributes/server.rb with a recipe named ::server -- will that get autoloaded, or is there some magic that i have to do to get the values schlepped in?
[2012-09-07 19:47:24 -0400] elijah-mbp: (dumb question, have never tried this, trying to raise the bar on the cookbooks i write.)
[2012-09-07 19:48:02 -0400] elijah-mbp: it's not entirely clear from the docs, or at least from my understanding of the docs.  i see people just use default.rb a whole lot.  :-)
[2012-09-07 19:51:55 -0400] benjaminws: kallistec, jtimberman RE: https://twitter.com/benjaminws/status/244153444808675328 I found the problem. It wasn't with Chef itself. I have a bootstrap role that needs to run first to install some chef_gems that my primary role depends on. If that doesn't happen in the right order, that's the error I end up getting. Of course, 0.10.12 showed me a more meaningful error. It bubbled up the backtrace properly.
[2012-09-07 19:55:39 -0400] jtimberman: benjaminws: I am now ( was at lunch )
[2012-09-07 19:57:59 -0400] benjaminws: jtimberman: they let you lunch on a release day?! ;)
[2012-09-07 19:58:15 -0400] jtimberman: benjaminws: "let"
[2012-09-07 19:58:18 -0400] jtimberman: I work from home.
[2012-09-07 19:58:22 -0400] cgriego: I'm trying to run test-kitchen on the mysql cookbook and after converging it fails to install nokogiri because it claims libxml2 is missing. Is there a piece of setup I am missing or a workaround I need to know about?
[2012-09-07 19:59:16 -0400] benjaminws: jtimberman: I tried that for a while, my kids thought I was just home all the time :(
[2012-09-07 19:59:26 -0400] jtimberman: benjaminws: I have a separate office, so that helps
[2012-09-07 19:59:36 -0400] jtimberman: And mine are "school age"
[2012-09-07 19:59:38 -0400] _0x783czar: Could someone please explain what exactly happens (or point me to a document explaining it) when I site install a cookbook?  I noticed it makes a bunch of extra branches in my git repo.
[2012-09-07 20:00:00 -0400] benjaminws: yeah, my mistake was that I tried to do it during the summer.
[2012-09-07 20:00:41 -0400] benjaminws: anyway, I think I'm good. Would like to have seen it bubble up the original exception, but I'm not real sure what's up with that, could be my fault :(
[2012-09-07 20:01:09 -0400] jtimberman: _0x783czar: yeah
[2012-09-07 20:01:37 -0400] jtimberman: _0x783czar: its managing the repository for you to preserve "upstream" changes so you can make local modifications, but update to newer versions easily and keep your changes
[2012-09-07 20:01:40 -0400] Twirrim: Could someone refresh me on the patch submission process?  I created a ticket, forked the repository, made the changes, issued a pull request.. do I now resolve the ticket or is that something Opscode do if they accept or deny the pull?
[2012-09-07 20:02:02 -0400] benjaminws: jtimberman: FWIW, it seems to fail when I require a ruby gem that hasn't been installed yet.
[2012-09-07 20:02:12 -0400] jtimberman: Twirrim: http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-09-07 20:02:21 -0400] jtimberman: benjaminws: don't do that :)
[2012-09-07 20:02:27 -0400] jtimberman: benjaminws: where are you requiring the gem?
[2012-09-07 20:03:01 -0400] jtimberman: Twirrim: resolve the ticket though, we use a ticket search filter to see which tickets are resolved with a pull request / commit/branch
[2012-09-07 20:03:03 -0400] benjaminws: jtimberman: exactly, that's why I have a 2 step process. One bootstrap role to make sure they are there with chef_gem, then flip the role and run chef-client again.
[2012-09-07 20:03:14 -0400] benjaminws: sucks
[2012-09-07 20:03:30 -0400] ctracey: mattray: thanks for the pxe_dust merge
[2012-09-07 20:03:31 -0400] jtimberman: benjaminws: its failing even after chef_gem? or do you have that require in a library/provider?
[2012-09-07 20:03:45 -0400] mattray: ctracey: fixing pxe_dust to support 10.14 now
[2012-09-07 20:03:49 -0400] jtimberman: benjaminws: I guard the require in libraries/providers with "begin/rescue"
[2012-09-07 20:03:49 -0400] ctracey: mattray: i will likely have more changes for 1.3.0 if youre willing
[2012-09-07 20:03:52 -0400] _0x783czar: jtimberman: OK, so do I generally not need to worry about the other branches, so long as I stay on master?  Will knife take care of the rest of the branches?
[2012-09-07 20:04:00 -0400] mattray: ctracey: sure, I want to get it out fairly soon though
[2012-09-07 20:04:11 -0400] jtimberman: _0x783czar: yeah, the pattern is "do development on master" and ship that for uploading cookbooks.
[2012-09-07 20:04:20 -0400] mattray: ctracey: the way omnibus is installed changed, so 10.14 isn't getting downloaded
[2012-09-07 20:04:22 -0400] jtimberman: _0x783czar: you can specify an alternate branch if you want to use one
[2012-09-07 20:04:35 -0400] ctracey: mattray: testing now.  specifically, i have decoupled pxe_dust from the default apache site config
[2012-09-07 20:04:46 -0400] Loof: How long should I expect a windows client run to take to start?
[2012-09-07 20:04:54 -0400] mattray: ctracey: in favor of...?
[2012-09-07 20:05:03 -0400] Loof: I don't have a timer on it... but it shows the header... and I'm waiting at least 4 mins at this point
[2012-09-07 20:05:04 -0400] _0x783czar: jtimberman: no, no, master is where I've been working, I just found myself on another branch and was confused where it came from/how I got there
[2012-09-07 20:05:09 -0400] Loof: the run itself hasn't started
[2012-09-07 20:05:45 -0400] ctracey: now with its own /etc/apache2/sites-available/pxe_dust and /var/www/pxe_dust.  I did this so that I dont collide with projects like openstack-dashboard
[2012-09-07 20:05:52 -0400] jtimberman: _0x783czar: yeah :)
[2012-09-07 20:06:00 -0400] mattray: ctracey: ahhh sexy
[2012-09-07 20:06:00 -0400] jtimberman: _0x783czar: so it creates a branch specifically for the cookbook
[2012-09-07 20:06:12 -0400] jtimberman: then future "knife cookbook site install" will use that branch for the merge
[2012-09-07 20:06:28 -0400] ctracey: mattray: dashboard wants to have wsgi alias at /
[2012-09-07 20:06:42 -0400] mattray: ctracey: I'm sure I'll crib from that to another cookbook I'm slowly writing
[2012-09-07 20:06:43 -0400] ctracey: (not that that is really nice either)
[2012-09-07 20:07:08 -0400] mattray: ctracey: remotefilemirror https://github.com/mattray/remotefilemirror
[2012-09-07 20:07:24 -0400] Twirrim: jtimberman: I don't appear to have the rights to resolve the ticket.  (COOK-1633)
[2012-09-07 20:07:27 -0400] benjaminws: jtimberman: I have the require in a library, so yeah. Tried the guard trick before, but something else broke. Don't remember what it was. No worries. Thanks for your response. As always, you rock.
[2012-09-07 20:07:36 -0400] jtimberman: Twirrim: Have you signed a Contributor License Agreeement?
[2012-09-07 20:07:37 -0400] ctracey: mattray: these changes allow me to run dashboard at :80/ and pxedust at :8080/
[2012-09-07 20:07:50 -0400] Twirrim: yup, a few months back :)
[2012-09-07 20:07:50 -0400] ctracey: mattray: nice - ill check it out
[2012-09-07 20:07:55 -0400] jtimberman: Twirrim: Hurm!
[2012-09-07 20:07:59 -0400] _0x783czar: jtimberman: great.  I'll just ignore them and let knife worry about them.
[2012-09-07 20:07:59 -0400] mattray: ctracey: cool. definitely useful
[2012-09-07 20:08:19 -0400] ctracey: mattray: timeframe for 1.3.0?
[2012-09-07 20:08:25 -0400] mattray: ctracey: it's not even tested yet, just something I slapped together on an airplane. But having files mirrored locally on another port would be handy
[2012-09-07 20:08:28 -0400] Twirrim: jtimberman: I can re-sign one if that'll help :)
[2012-09-07 20:08:29 -0400] mattray: ctracey: today?
[2012-09-07 20:08:34 -0400] ctracey: also have dnsmasq lwrp being tested as i speak
[2012-09-07 20:08:43 -0400] mattray: ctracey: maybe Monday
[2012-09-07 20:08:47 -0400] jtimberman: Twirrim: See if your name is on here: http://wiki.opscode.com/display/chef/Approved+Contributors
[2012-09-07 20:08:54 -0400] mattray: ctracey: I just want to start using 10.14 :)
[2012-09-07 20:09:12 -0400] ctracey: ok - that wont happen.  monday possibly.  the "boss" is picking me up to head to maine in half hour :)
[2012-09-07 20:09:28 -0400] mattray: ctracey: no worries, we can do another release soon
[2012-09-07 20:09:40 -0400] ctracey: yeah - itll def be ready by next week
[2012-09-07 20:09:52 -0400] ctracey: but no worries here
[2012-09-07 20:10:12 -0400] Twirrim: jtimberman: it's not.  I'll re-do it :)
[2012-09-07 20:11:15 -0400] jtimberman: Twirrim: Thank you, and sorry that slipped through.
[2012-09-07 20:11:40 -0400] jtimberman: Twirrim: re: your chef-client ticket, we haev a pile of technical debt around "platform family" support in our cookbooks
[2012-09-07 20:11:44 -0400] jtimberman: chef-client COOK ticket
[2012-09-07 20:11:58 -0400] Twirrim: I can imagine
[2012-09-07 20:13:07 -0400] cgriego: jtimberman: any insights into my test-kitchen/libxml2 woes?
[2012-09-07 20:14:29 -0400] jtimberman: cgriego: its an unfortunate circumstance :). I believe nokogiri is a dep of cucumber of rspec.
[2012-09-07 20:15:18 -0400] jtimberman: cgriego: i poked at this the other day myself, and the easiest solution was to add the 'xml' cookbook to the test/kitchen/cookbooks directory, and put it in run_list_extras for the coobkook project in Kitchenfile.
[2012-09-07 20:15:36 -0400] jtimberman: i didn't poke too hard to see if there was a better way to do it.
[2012-09-07 20:16:02 -0400] jan0232: how do i find out if I'm on x86 or x64 in chef??
[2012-09-07 20:16:13 -0400] cgriego: thanks, I'll give that a shot :)
[2012-09-07 20:16:15 -0400] jan0232: is there a ohai attribute for that already?
[2012-09-07 20:17:05 -0400] Twirrim: jan0232: the attribute node['kernel']['machine'] on *nix boxes will tell you.
[2012-09-07 20:17:25 -0400] jan0232: great. that's exactly what i was looking for, thx
[2012-09-07 20:17:29 -0400] organicveggie: Hash anyone seen any issues with Ohai data when running in an EC2 VPC? I seem to be missing some data...
[2012-09-07 20:19:15 -0400] jan0232: wow Chef 10.14.0  :)
[2012-09-07 20:21:37 -0400] jan0232: does chef 10.14.0 use the same ruby version as 10.12.0 with the omnibus install?
[2012-09-07 20:21:51 -0400] jan0232: 10.12.0 uses 1.9.2 i think...
[2012-09-07 20:21:58 -0400] jtimberman: jan0232: no, its now upgraded to 1.9.3-p194
[2012-09-07 20:22:02 -0400] jtimberman: and rubygems 1.8.24
[2012-09-07 20:22:09 -0400] jan0232: jtimberman: ah that sounds great
[2012-09-07 20:22:32 -0400] jtimberman: http://tickets.opscode.com/browse/CHEF-2871
[2012-09-07 20:23:44 -0400] organicveggie: jtimberman: does that ticket mean the current release of the omnibus has 1.9.3 and rubygems 1.8.24?
[2012-09-07 20:24:36 -0400] jan0232: this is great news :)
[2012-09-07 20:26:07 -0400] jtimberman: organicveggie: chef 10.14 does
[2012-09-07 20:26:25 -0400] barefoot: how can I get around this? http://pastebin.com/RUwViu7i
[2012-09-07 20:26:25 -0400] jtimberman: % /opt/chef/embedded/bin/ruby -v
[2012-09-07 20:26:26 -0400] jtimberman: ruby 1.9.3p194 (2012-04-20 revision 35410) [x86_64-linux]
[2012-09-07 20:26:46 -0400] organicveggie: jtimberman: i'm with jan0232 then... sounds great!
[2012-09-07 20:26:47 -0400] Loof: Sheesh, chef run takes 8m+ real time... the run itself took 2s :P
[2012-09-07 20:26:48 -0400] jan0232: seems like xmas today :D
[2012-09-07 20:26:57 -0400] jan0232: ;)
[2012-09-07 20:26:59 -0400] Loof: It's not totally horrible... but just way too long
[2012-09-07 20:27:20 -0400] Loof: I expect chef to be run on boot... increasing the boot time by nearly 10mins is a problem
[2012-09-07 20:27:28 -0400] jtimberman: Loof: what version of chef?
[2012-09-07 20:27:31 -0400] jan0232: now i need to figure out how i upgrade to that
[2012-09-07 20:27:33 -0400] Loof: 10.12
[2012-09-07 20:27:49 -0400] jtimberman: Loof: 8 minutes is quite long. can you determine where it is sitting the longest waiting?
[2012-09-07 20:28:04 -0400] Loof: jtimberman: I ran a debug session... but didn't have time to watch it
[2012-09-07 20:28:44 -0400] jtimberman: Loof: i know there's a ruby load path error in rubygems 1.8.12 that shipped with 10.12 omnibus.
[2012-09-07 20:28:48 -0400] jtimberman: er, not error
[2012-09-07 20:29:07 -0400] jtimberman: but issue, where it takes a long time, and that was improved in 1.8.13 (and we ship 1.8.24 in 10.14)
[2012-09-07 20:29:48 -0400] jan0232: jtimberman: to upgrade a 10.12.0 chef omnibus installcan i just use the http://www.opscode.com/chef/install.sh again??
[2012-09-07 20:30:25 -0400] Loof: 10.190.97.64 [2012-09-07T20:10:08+00:00] DEBUG: looks_like_ec2? == true
[2012-09-07 20:30:26 -0400] Loof: 10.190.97.64 [2012-09-07T20:16:46+00:00] DEBUG: Loading plugin rackspace
[2012-09-07 20:30:33 -0400] Loof: 5 mins between those 2 lines in the log?
[2012-09-07 20:30:45 -0400] Loof: 6 and a bit, actually
[2012-09-07 20:32:40 -0400] jtimberman: Loof: wow, what kind of node is that?
[2012-09-07 20:32:46 -0400] jtimberman: a rackspace cloud instance?
[2012-09-07 20:32:52 -0400] jtimberman: jan0232: sure
[2012-09-07 20:32:55 -0400] Loof: It's a windows EC2 node
[2012-09-07 20:36:47 -0400] jtimberman: I'm not sure why it would take that long right there.
[2012-09-07 20:37:05 -0400] jtimberman: btm or ssd7_, ideas? ^
[2012-09-07 20:38:22 -0400] hoover_damm: you'd need to add logging
[2012-09-07 20:39:08 -0400] hoover_damm: I'd first make sure you don't have a rackspace hint file created, and then create logging.
[2012-09-07 20:50:04 -0400] timsmith: is there any documentation on moving from chef deb install to omnibus?
[2012-09-07 20:56:25 -0400] Loof: jtimberman: I'm assuming that's the ohai plugin for gathering ec2 info... I have not had a moment to look at it since collecting that log
[2012-09-07 20:57:37 -0400] Loof: Is there a 'best practice' guide for EC2 that doesn't involve either cloudfront or manually starting things up via knife ec2?
[2012-09-07 20:58:20 -0400] Loof: I'm fine using knife ec2 for the short term... but eventually I need to be able to start an instance automatically and have it set a new node/client id + create a client pem
[2012-09-07 20:58:59 -0400] Loof: I guess I could create an instance that has the 1st run json + no client pem just sitting there
[2012-09-07 20:59:06 -0400] Loof: make chef-client -j ... run on boot
[2012-09-07 20:59:31 -0400] Loof: I'm just not sure what's -best-
[2012-09-07 21:02:19 -0400] jtimberman: Loof: depends on what workflow is best for your environment :)
[2012-09-07 21:02:33 -0400] jtimberman: Loof: some folks like to make an AMI that has chef preinstalled
[2012-09-07 21:02:52 -0400] jtimberman: some folks built a dashboard that allows them to launch instances via API calls through a web front end
[2012-09-07 21:02:53 -0400] jan0232: how do you test your cookbooks?? i currently have a virtual box VM that i run my stuff ononce everything works as expected, i run it on a real server  is this really crazy or a normal way to do this? :)
[2012-09-07 21:03:08 -0400] jtimberman: jan0232: That is what we do.
[2012-09-07 21:03:21 -0400] jan0232: so what is the new why-run stuff...
[2012-09-07 21:03:34 -0400] jtimberman: jan0232: As mentioned in the 10.14 blog post, we do testing in a variety of ways, including test-kitchen/vagrant, and our internal openstack build environment.
[2012-09-07 21:03:36 -0400] organicveggie: jtimberman: do you guys use EC2 at all? If so, how do you cope with the differences?
[2012-09-07 21:03:45 -0400] jan0232: i see
[2012-09-07 21:03:46 -0400] jtimberman: jan0232: an oft requested feature :)
[2012-09-07 21:04:05 -0400] jan0232: cool coolgreat work.
[2012-09-07 21:04:10 -0400] jtimberman: organicveggie: Opscode isn't currently running any production infrastructure in EC2. However, we do use it for testing / development.
[2012-09-07 21:04:51 -0400] organicveggie: jtimberman: fair enough. :)
[2012-09-07 21:05:18 -0400] organicveggie: besides, if i did a better job writing cookbooks/recipes/roles/etc., testing wouldn't be such a hassle. :)
[2012-09-07 21:05:31 -0400] jan0232: ok this is magic everything works as expected with 10.14.0 without any modifications on my part, woohoo :)
[2012-09-07 21:06:27 -0400] jtimberman: jan0232: as in, your recipe worked on 10.12 and 10.14?
[2012-09-07 21:06:34 -0400] jan0232: yes
[2012-09-07 21:06:43 -0400] jtimberman: i'd expect that :)
[2012-09-07 21:07:07 -0400] jtimberman: all releases through a major version series should be compatible for chef-client
[2012-09-07 21:07:24 -0400] jtimberman: though e.g., 10 -> 11 may have breaking changes.
[2012-09-07 21:07:34 -0400] jan0232: i see
[2012-09-07 21:07:50 -0400] jtimberman: i think we've done a pretty good job for the recipe DSL stability though.
[2012-09-07 21:08:06 -0400] jan0232: is there a "roadmap" to 11? i mean.. do you think it will be months, years, decades?
[2012-09-07 21:08:32 -0400] jtimberman: http://wiki.opscode.com/display/chef/Chef+11+Server+Preview
[2012-09-07 21:08:36 -0400] ssd7_: jan0232: month(s)
[2012-09-07 21:08:40 -0400] jan0232: jtimberman: you've all done an amazing job on this entire thing :) chef is so great
[2012-09-07 21:08:48 -0400] jtimberman: and: http://wiki.opscode.com/display/chef/Chef+11+Release+Checklist
[2012-09-07 21:09:39 -0400] jan0232: erchef?
[2012-09-07 21:10:27 -0400] ssd7_: jan0232: Cute name for Erlang Chef
[2012-09-07 21:10:41 -0400] jtimberman: jan0232: Cheers, I'm glad you like Chef :).
[2012-09-07 21:11:16 -0400] jan0232: ssd7_: sure, buti'm trying to understand. what will be in erlang the chef server?  but not cookbooks right? :D
[2012-09-07 21:11:54 -0400] jan0232: a the new chef API server written in erlang
[2012-09-07 21:11:57 -0400] jan0232: i see
[2012-09-07 21:12:16 -0400] jtimberman: yeah only the chef-server part
[2012-09-07 21:12:18 -0400] ssd7_: jan0232: Yeah just the server.  Same ruby client (with lots o new features) and the same ruby based DSL
[2012-09-07 21:12:23 -0400] jtimberman: the client and cookbooks will remain ruby
[2012-09-07 21:12:28 -0400] jtimberman: what ssd7_ said
[2012-09-07 21:12:31 -0400] jtimberman: :)
[2012-09-07 21:12:34 -0400] jan0232: erlang for performance reaseons?
[2012-09-07 21:12:43 -0400] jan0232: reasons
[2012-09-07 21:13:08 -0400] jtimberman: jan0232: partially performance reasons.
[2012-09-07 21:13:15 -0400] jtimberman: also, code parity reasons
[2012-09-07 21:13:45 -0400] Loof: jtimberman: I expect to have chef and most of the dependencies pre-installed in an AMI
[2012-09-07 21:14:03 -0400] jan0232: i'm just curious because i always try to stick to one language when possible
[2012-09-07 21:14:15 -0400] jan0232: but i guess erlang is pretty neat :)
[2012-09-07 21:14:15 -0400] Loof: jtimberman: For prod... chef is basically just going to register things and grab updates... modify anything that has deviated from the origina AMI
[2012-09-07 21:14:29 -0400] jtimberman: jan0232: http://www.youtube.com/watch?v=FRFekZrLNas
[2012-09-07 21:14:44 -0400] jan0232: jtimberman: wow thx!
[2012-09-07 21:14:54 -0400] jtimberman: jan0232: loads of videos from chefconf on our youtube page
[2012-09-07 21:14:59 -0400] jtimberman: and more :)
[2012-09-07 21:15:02 -0400] jan0232: great stuff
[2012-09-07 21:15:46 -0400] jtimberman: Loof: sure. so i don't know specifically about windows, but having the service setup to start on boot for new AMIs is reasonable.
[2012-09-07 21:15:50 -0400] jtimberman: sec
[2012-09-07 21:17:21 -0400] jtimberman: Loof: we used to do this, before "knife ec2" and "knife bootstrap" existed: https://gist.github.com/319106
[2012-09-07 21:17:36 -0400] jtimberman: some folks do a similar thing when using autoscaling and custom AMIs with chef already installed.
[2012-09-07 21:17:37 -0400] jan0232: damn i don't know if this is placebo. but 10.14.0 seems really FAST :)
[2012-09-07 21:17:56 -0400] jtimberman: jan0232: it might merely be the rubygems loading faster in 1.8.13
[2012-09-07 21:18:11 -0400] jtimberman: coupled with 1.9.3 being faster than 1.9.2 (there were a number of performance improvements)
[2012-09-07 21:18:13 -0400] btm: jtimberman: shh. Chef is Fast!
[2012-09-07 21:18:17 -0400] sdelano: jan0232: are you using omnibus?
[2012-09-07 21:18:20 -0400] jtimberman: btm: well sure.
[2012-09-07 21:18:27 -0400] jan0232: sdelano: yes
[2012-09-07 21:19:07 -0400] sdelano: then yes, it's the bundled ruby / rubygems that account for the speed increase as btm and jtimberman noted
[2012-09-07 21:19:59 -0400] Loof: jtimberman: I only have a few windows nodes... the rest are Ubuntu Linux
[2012-09-07 21:20:20 -0400] Loof: I expect to have several autoscale groups before long
[2012-09-07 21:24:46 -0400] Loof: So, while eventually I plan to get chef to be able to start up from a base Ubuntu image
[2012-09-07 21:25:16 -0400] Loof: But now (where things are mostly configured/installed by hand) and in the future... I expect to have a snapshot AMI that's actually used for production
[2012-09-07 21:25:34 -0400] Loof: so that the startup time is minimized... I don't want to wait around while nginx, etc, etc. are installed
[2012-09-07 21:38:10 -0400] Loof: jtimberman: One thing I was thinking of adding is a bootstrap context if the client is already registered
[2012-09-07 21:38:27 -0400] nstielau: Happy releaseternoon!  Having some issues with systemd services with Chef 0.14.0.  It says that it needs a start command, I tracked it calling super to get all of the Simple service resource requirements, instead of just that shared_resource_requirements + extras: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/service/systemd.rb#L51
[2012-09-07 21:38:47 -0400] Loof: that way if I'm bootstrapping something totally new... it removes the client.pem intelligently...and if it's a re-run, it leaves it alone like now
[2012-09-07 21:38:52 -0400] nstielau: Any thoughts before I open a ticket?
[2012-09-07 21:44:25 -0400] cheeseplus: style question - say I'm casing a lib directory for x86 vs x86_64, is putting the logic to determine the default in the attributes file bad?
[2012-09-07 21:49:55 -0400] jtimberman: cheeseplus: are you evaluating against the node['kernel']['machine'] attribute?
[2012-09-07 21:50:30 -0400] cheeseplus: jtimberman: that and platform_family
[2012-09-07 21:50:40 -0400] cheeseplus: since only rhel family uses lib64
[2012-09-07 21:50:42 -0400] jtimberman: cheeseplus: then yes
[2012-09-07 21:51:26 -0400] cheeseplus: I thought so, just wanted 2nd opinion
[2012-09-07 21:51:52 -0400] cheeseplus: since these are config options I liked keeping them all in attributes so users could see it
[2012-09-07 21:53:50 -0400] Loof: jtimberman: Why would setting a default in attributes based on an automatic value be bad?
[2012-09-07 21:54:10 -0400] jtimberman: Loof: it isn't
[2012-09-07 21:54:22 -0400] Loof: ok :)
[2012-09-07 21:54:26 -0400] jtimberman: Loof: setting it based on some other attribute may be bad.
[2012-09-07 21:54:35 -0400] jtimberman: e.g., the attribute isn't available for some reason
[2012-09-07 21:54:56 -0400] cheeseplus: jtimberman: wait, so it's only bad because I'm looking at platform_family then?
[2012-09-07 21:55:05 -0400] cheeseplus: just want to make sure I understand clearly
[2012-09-07 21:55:07 -0400] kallistec: Loof: there's a gotcha in the way attributes are loaded that means if you calculate a value from attributes, and you want to be able to set the input attribute in a role, you need to do the calculation in a recipe
[2012-09-07 21:55:27 -0400] kallistec: but ohai data is loaded first thing in the chef run so it will be there
[2012-09-07 21:55:32 -0400] jtimberman: cheeseplus: no - its not bad.
[2012-09-07 21:55:40 -0400] jtimberman: cheeseplus: because both the attributes you're using come from ohai
[2012-09-07 21:55:50 -0400] cheeseplus: oh ok
[2012-09-07 21:56:01 -0400] jtimberman: so you know they'll be available
[2012-09-07 21:56:08 -0400] kallistec: JINX
[2012-09-07 21:56:16 -0400] jtimberman: kallistec: yeah i'm slow
[2012-09-07 21:56:22 -0400] kallistec: lol
[2012-09-07 21:56:24 -0400] cheeseplus: when you said "yes" I wasn't sure what you were saying "yes" to
[2012-09-07 21:56:27 -0400] Loof: jtimberman: We both thought you were saying it's a bad thing... I'm doing that in a few places, setting sane defaults based on platform... and also environment
[2012-09-07 21:56:30 -0400] jtimberman: i just had a bunch of sugar though
[2012-09-07 21:56:34 -0400] cheeseplus: haha
[2012-09-07 21:56:47 -0400] jtimberman: sorry for the confusion.
[2012-09-07 21:56:50 -0400] Loof: jtimberman: Then overriding them in the role based on env... just in case something odd happens we don't have a totally unconfigured run happen
[2012-09-07 21:57:06 -0400] jtimberman: there aren't environment specific attributes in roles.
[2012-09-07 21:58:32 -0400] Loof: Err, in the environment json :) slip of the mind late on Fri
[2012-09-07 21:58:48 -0400] jtimberman: o ok :)
[2012-09-07 21:59:23 -0400] cheeseplus: jtimberman: thanks for the clarification
[2012-09-07 21:59:38 -0400] jtimberman: cheeseplus: sure, sorry the first time it was confusing and kallistec had to set me straight ;)
[2012-09-07 22:00:08 -0400] cheeseplus: glad kallistec did so cause that means I don't have to change my approach
[2012-09-07 22:00:29 -0400] xmltok: is anyone familiar with any talks about adding the ability for knife bootstrap to assume or query for information about a node before its bootstrapped? In my case I can learn a lot about a node from its hostname - apps to install, environment - and i'd like to be able to have bootstrap know that rather than specify it in a bunch of -r and -E parameters
[2012-09-07 22:00:51 -0400] xmltok: unless i am mistaken, it doesnt appear to be something that can be done from a cookbook
[2012-09-07 22:01:14 -0400] kallistec: xmltok: you probably want to write a knife plugin to wrap the bootstrap
[2012-09-07 22:02:06 -0400] xmltok: im also not real solid on ruby, but if other plugins (like the cloudstack or ec2 plugin) want to use bootstrap internally, i need to hack them up too or can I override the internal bootstrap plugin
[2012-09-07 22:02:22 -0400] kallistec: there's a walkthrough here: http://wiki.opscode.com/display/chef/Knife+Plugins
[2012-09-07 22:03:11 -0400] kallistec: xmltok: the cloud plugins are probably hitting the bootstrap command directly
[2012-09-07 22:03:24 -0400] xmltok: yeah, so i would need to make my plugin call the cloud plugins then with the new parameters
[2012-09-07 22:04:00 -0400] kallistec: as another alternative, you can put some of that logic in the bootstrap template, whic is ugly but might work
[2012-09-07 22:04:36 -0400] xmltok: interesting idea, ideally i would only have to do this once. I don't want to write a hack around the cloudstack plugin, then the ec2 plugin, and in a year from now, the rackspace plugin, or who knows what other provider
[2012-09-07 22:05:16 -0400] Loof: Ok, this is odd... what would cause a node not to show up in a search based on role:...
[2012-09-07 22:06:29 -0400] Loof: Oh... even more odd 'role:*' doesn't list that node
[2012-09-07 22:06:37 -0400] Loof: and it does have a role
[2012-09-07 22:07:12 -0400] jordane: Loof: if the node is a new node, has it been saved to the chef server yet?
[2012-09-07 22:07:16 -0400] Loof: name:<node name> does show it
[2012-09-07 22:07:22 -0400] jordane: nvm
[2012-09-07 22:09:39 -0400] Loof: search node 'run_list:role\[<role>\]' finds the node
[2012-09-07 22:09:49 -0400] Loof: search node role:<role> does not
[2012-09-07 22:12:02 -0400] Loof: Tried editing the node and saving... same thing
[2012-09-07 22:12:04 -0400] Loof: Very odd
[2012-09-07 22:14:37 -0400] Loof: Restarting solr didn't help, just in case
[2012-09-07 22:14:42 -0400] uncommitted: getting a popular error, but don't know how to fix "TypeError: can't convert Symbol into Integer"
[2012-09-07 22:15:04 -0400] jan0232: how do you go about upgrade packages or changing stuff on a chef server? just setup an entirely new server. or actually change existing nodes. i mean for example i change the location of some files from /usr/local/bin to something elseand i update some files now after a new chef-run the old locations would still be in place...
[2012-09-07 22:15:19 -0400] Loof: Ugh, this is problematic... I was intending to manually launch chef client on demand based on role :/
[2012-09-07 22:15:34 -0400] bluepojo: uncommitted: that usually means you thought you had a hash but you really have an array
[2012-09-07 22:16:11 -0400] uncommitted: i do have an array, and i want to use it in a loop like this "  node[:xen][:vlans].each do |vlan|
[2012-09-07 22:16:12 -0400] uncommitted: "
[2012-09-07 22:16:51 -0400] bluepojo: the error means you have an array, say x = [1,2,3]
[2012-09-07 22:16:55 -0400] bluepojo: and you accessed it with a symbol
[2012-09-07 22:16:57 -0400] bluepojo: x[:a]
[2012-09-07 22:16:59 -0400] jan0232: say i do template "/etc/conf"  do a chef-run  then change the location to "/etc/new/conf"  after a chef-run the file would be in both locations...
[2012-09-07 22:17:02 -0400] Pushnell: I'm super new to chef is there a way to use shef to show me all of the node attributes?  Like, the list that "node['platform_family']" would be in?  This is chef-solo in vagrant.
[2012-09-07 22:17:09 -0400] bluepojo: it's not a chef error, it's a ruby error
[2012-09-07 22:18:24 -0400] spox: Pushnell: pp node.to_hash; nil
[2012-09-07 22:18:31 -0400] uncommitted: okay, i understand. thank you
[2012-09-07 22:18:38 -0400] Loof: jan0232: It depends on how you handle it... if you know you're moving things then it's up to you to check if /etc/chef exists and either delete it (via a notify from creating thew new one) or move it to the new lcoation
[2012-09-07 22:18:40 -0400] uncommitted: how am I supposed to access it then?
[2012-09-07 22:19:11 -0400] Pushnell: spox: thanks!
[2012-09-07 22:19:11 -0400] Loof: jan0232: It doesn't 'know' that it made that same template in /etc/chef... and now is making in in /etc/new/conf...and that those are the same template
[2012-09-07 22:19:16 -0400] Loof: jan0232: Does that answer your question?
[2012-09-07 22:19:42 -0400] bluepojo: uncommitted: That depends what your data structure looks like if you have an array inside a hash
[2012-09-07 22:19:57 -0400] bluepojo: x[:a][:b].each {|e|  } will work
[2012-09-07 22:20:26 -0400] bluepojo: provided the data structure looks like x = {a: {b: [1,2,3]} }
[2012-09-07 22:20:28 -0400] uncommitted: awesome
[2012-09-07 22:20:39 -0400] uncommitted: thank you
[2012-09-07 22:21:04 -0400] jan0232: Loof: yes. thx. i find it interesting how to do updateswell, security updates at least.. and also making sure they don't break stuff..and that deployments to an entirely new server will still work
[2012-09-07 22:22:18 -0400] jan0232: Loof: since i could imagine you upgrade your servers from time to timeand then when you want to start an entirely new one you realize that some of those incremental changes break a vanilla chef run
[2012-09-07 22:22:39 -0400] Loof: jan0232: That's why you'd want to test both, when possible
[2012-09-07 22:23:13 -0400] Loof: jan0232: Personally, I expect to have incremental changes to a point... and once in a while (or on a major change) start from a 'new' image/server
[2012-09-07 22:24:15 -0400] jan0232: Loof: hmm, yea i guess that's how it is done. i just realized that you get those tests for free, because i can always test on a new vagrant vm
[2012-09-07 22:24:32 -0400] jan0232: and thats what i do anyway
[2012-09-07 22:47:30 -0400] xmltok: what is the disadvantage to the chef-full template?
[2012-09-07 23:15:39 -0400] bdot: earlier today, chef-client suddenly came up using more than 3G memory on several instances that we have here.
[2012-09-07 23:15:45 -0400] jtimberman: bdot: what version
[2012-09-07 23:15:53 -0400] bdot: 10.12.0
[2012-09-07 23:16:09 -0400] jtimberman: xmltok: uh, someone might not want to use the full stack package? personally i prefer it, its the most cross platform
[2012-09-07 23:16:51 -0400] bdot: I checked the stacktrace, it seems the client-client is failing to retrieve some node attributes
[2012-09-07 23:17:13 -0400] bdot: ArgumentError: Attribute ipaddress is not defined!
[2012-09-07 23:17:13 -0400] bdot: /usr/lib/ruby/vendor_ruby/chef/node/attribute.rb:428:in `method_missing'
[2012-09-07 23:17:31 -0400] bdot: after killing the chef-client, and start it again, it works well
[2012-09-07 23:17:40 -0400] nstielau: bodt: 3G is a lot.  Do you have LDAP or something else that might try to load loats of data in Ohai?
[2012-09-07 23:17:43 -0400] jtimberman: does the node have a default route?
[2012-09-07 23:18:09 -0400] macros: bdot: What version of ruby?
[2012-09-07 23:18:16 -0400] bdot: my nodes are on AWS
[2012-09-07 23:18:22 -0400] bdot: yes, they do have default route
[2012-09-07 23:18:32 -0400] bdot: ruby 1.8.7
[2012-09-07 23:18:53 -0400] bdot: no LDAP
[2012-09-07 23:19:01 -0400] macros: We had lots of memory use problems with 1.8.7
[2012-09-07 23:19:29 -0400] macros: The json library has really bad overhead with 1.8.7
[2012-09-07 23:19:31 -0400] nstielau: Yeah, moving to Omnibus with 1.9 made everything smoother for us
[2012-09-07 23:19:49 -0400] macros: We were averaging 500MB per run, 8GB when an exception was thrown
[2012-09-07 23:19:56 -0400] nstielau: Just added a bug for 10.14.0 related to Systemd service provider: http://tickets.opscode.com/browse/CHEF-3425 .  I have a workaround for now.  If anyone wants more data lemme know ;)
[2012-09-07 23:20:03 -0400] chip-: Slightly offtopic guys, but the netflix techblog is amazing today. They're publishing some great stuff.
[2012-09-07 23:20:17 -0400] macros: Down to 40MB per run under 1.9.1 and the coming soon partial_search
[2012-09-07 23:20:55 -0400] jtimberman: nstielau: we're talking about that ticket right now in hipchat :)
[2012-09-07 23:21:14 -0400] nstielau: cool, thanks jtimberman.
[2012-09-07 23:21:25 -0400] nstielau: Love the 10.14.0 output, it makes making tickets much easier!
[2012-09-07 23:21:38 -0400] jtimberman: nstielau: oh yes, yes it does.
[2012-09-07 23:21:56 -0400] jtimberman: nstielau: i hugged kallistec at ChefConf when I first saw the preview of output formatters :)
[2012-09-07 23:21:59 -0400] macros: I make the linux::network plugin cry
[2012-09-07 23:22:13 -0400] jtimberman: macros: you're doing terrible things with networks sir :)
[2012-09-07 23:22:18 -0400] bdot: #jtimberman: how can I debug why chef-client is using big amount of mem
[2012-09-07 23:22:35 -0400] jtimberman: bdot: is it running as a daemon on your systems?
[2012-09-07 23:22:41 -0400] macros: jtimberman: I'm running bird inside the vm in my arista switch :)
[2012-09-07 23:22:42 -0400] bdot: yes
[2012-09-07 23:22:43 -0400] jtimberman: over time the memory consumption can grow, especially if you're doing much searches.
[2012-09-07 23:22:50 -0400] jtimberman: because yay garbage collection
[2012-09-07 23:23:14 -0400] bdot: will ruby 1.9 help?
[2012-09-07 23:23:57 -0400] bdot: this issue doesn't happen often to me, so it's difficult to reproduce
[2012-09-07 23:24:09 -0400] jtimberman: bdot: ruby 1.9 *may* help.
[2012-09-07 23:24:19 -0400] jtimberman: it's likely to be better in general
[2012-09-07 23:24:43 -0400] jtimberman: bdot: the "omnibus" install of chef, as of chef 10.14 uses ruby 1.9.3-p194 and rubygems 1.8.24
[2012-09-07 23:26:27 -0400] bdot: okie. I got it. also, is there a good tool/way to debug chef-client ?
[2012-09-07 23:26:55 -0400] jtimberman: debug in what way?
[2012-09-07 23:27:14 -0400] jtimberman: like, you can use ruby debugger, strace for code level stuff.
[2012-09-07 23:27:23 -0400] jtimberman: or you can run "-l debug" to get more information about what its doing
[2012-09-07 23:27:25 -0400] bdot: debug the process so understand what are the big chunk memory are used
[2012-09-07 23:28:03 -0400] jtimberman: yeah, same as any other tool really
[2012-09-07 23:28:09 -0400] jtimberman: i don'tk now of chef specific ones :)
[2012-09-07 23:28:34 -0400] bdot: okie. thanks
[2012-09-07 23:30:34 -0400] _0x783czar: Hey guys, I just finished demonstrating chef to the CTO
[2012-09-07 23:30:39 -0400] _0x783czar: He was blown away.
[2012-09-07 23:30:47 -0400] spox: is there something special required to get rvm loaded on the test-kitchen boxes?
[2012-09-07 23:31:00 -0400] _0x783czar: Project = more than greenlighted
[2012-09-07 23:32:10 -0400] _0x783czar: jtimberman: yfeldblum: Thanks for all the help
[2012-09-07 23:33:03 -0400] yfeldblum: _0x783czar, congrats
[2012-09-07 23:33:19 -0400] bdot: see my chef-client pmem? 92.5 chef-client
[2012-09-07 23:33:21 -0400] bdot: :)
[2012-09-07 23:33:30 -0400] bdot: killing it
[2012-09-07 23:34:21 -0400] bdot: world peace now.  pmem 0.8 chef-client
[2012-09-07 23:35:56 -0400] xmltok: well, it looks like if i want to auto-set my environment when i bootstrap a node it needs to be done through a knife plugin which wraps the cloud plugins. i can potentially tweak the template to add role based on the hostname, i can definite do a default, but i can't modify the parameters to chef-client from there
[2012-09-07 23:39:30 -0400] jtimberman: _0x783czar: awesome! :D
[2012-09-07 23:39:46 -0400] jtimberman: spox: uh, "yes"
[2012-09-07 23:39:52 -0400] jtimberman: spox: there's a couple approaches.
[2012-09-07 23:40:16 -0400] jtimberman: spox: 1) use the boxes that andrew crump built while he was working on parts of test-kitchen, which have rvm.
[2012-09-07 23:40:31 -0400] xmltok: if i was to create a patch for the bootstrap plugin that allowed you to inherit or run other plugins to automatically generate environments/roles based on code, would that be of interest to anyone?
[2012-09-07 23:41:28 -0400] jtimberman: spox: 2) there's a way to get it into the provisioning, which is in this ticket: http://tickets.opscode.com/browse/KITCHEN-4
[2012-09-07 23:41:36 -0400] whack: What's the usual way folks download third-party cookbooks? git submodules?
[2012-09-07 23:41:57 -0400] jtimberman: whack: depends! :D
[2012-09-07 23:42:07 -0400] xmltok: whack: i think thats the old way, it seems like berkshelf and librarian are popular now
[2012-09-07 23:42:15 -0400] whack: more tools? :\
[2012-09-07 23:42:19 -0400] jtimberman: whack: MOAR TOOLSZ
[2012-09-07 23:42:19 -0400] xmltok: otherwise you have a gigantic repository for chef that includes your cookbooks
[2012-09-07 23:42:23 -0400] xmltok: and peopel to tar snapshots
[2012-09-07 23:42:30 -0400] xmltok: personally spork looked good to me
[2012-09-07 23:42:39 -0400] jtimberman: whack: you can use 'knife cookbook site install' if the cookbook you want is on the community site
[2012-09-07 23:42:46 -0400] spox: hi jtimberman
[2012-09-07 23:42:48 -0400] whack: like, I want to use the runit cookbook I found. Is librarian/berkshelf what I should use to manage this madness?
[2012-09-07 23:42:49 -0400] spox: thanks for the pointers
[2012-09-07 23:42:50 -0400] xmltok: it has a few hiccups which should get fixed very soon, but it would allow you to have different repos for each cookbook and still manage them in a sane way
[2012-09-07 23:43:15 -0400] xmltok: then you can clone the runit cookbook to your cookbooks folder and hack it up, and keep it in some other repo
[2012-09-07 23:43:35 -0400] jtimberman: whack: do you care about getting the runit cookbook as a git repository with all its history, or do you just want the kode?
[2012-09-07 23:43:39 -0400] xmltok: the only thing i havent found a good solution for is when you need to modify a third party cookbook, like ohai or chef_handler. then you are pretty much stuck having to manually sync changes
[2012-09-07 23:43:47 -0400] whack: jtimberman: just the code
[2012-09-07 23:43:57 -0400] halkeye: trying to follow the example @ https://github.com/opscode-cookbooks/application#usage and getting "NameError: No resource found for passenger_apache2", i'm really not sure what to look for/fix
[2012-09-07 23:44:03 -0400] whack: jtimberman: roughly, I'm not seeing examples (failing to search, honestly) of how folks manage cookbook repositories
[2012-09-07 23:44:15 -0400] jtimberman: there's 802 ways to go about it :)
[2012-09-07 23:44:29 -0400] whack: offer me a best practice I can cargo cult ;)
[2012-09-07 23:44:35 -0400] jtimberman: knife cookbook site install runit
[2012-09-07 23:44:46 -0400] whack: jtimberman: I"m using chef solo
[2012-09-07 23:44:53 -0400] whack: knife cookbook is all like "I don't have your private key"
[2012-09-07 23:44:55 -0400] jtimberman: cookbook site downloads from the community site.
[2012-09-07 23:45:06 -0400] whack: oh I was using 'download'
[2012-09-07 23:45:18 -0400] jtimberman: knife cookbook site download runit should work too
[2012-09-07 23:45:22 -0400] jtimberman: that'll grab the tarball
[2012-09-07 23:45:29 -0400] whack: ahh neato
[2012-09-07 23:45:45 -0400] halkeye: i'm trying out librarian-chef
[2012-09-07 23:45:46 -0400] jtimberman: that part of knife was written before it was called "the Community Site"
[2012-09-07 23:45:49 -0400] halkeye: that helps manage too
[2012-09-07 23:45:56 -0400] jtimberman: librarian and berkshelf are cool too
[2012-09-07 23:46:32 -0400] whack: gotcha, so 'knife cookbook download ...' assumes a chef server, but cookbook site download fetches from the interwebs
[2012-09-07 23:46:55 -0400] whack: cool, moving on to the next step :)
[2012-09-07 23:47:55 -0400] jtimberman: yeah
[2012-09-07 23:48:15 -0400] jtimberman: i'm going to see about renaming the plugin to "knife community" for chef 11.
[2012-09-07 23:48:46 -0400] whack: 'knife community hug'
[2012-09-07 23:48:56 -0400] jtimberman: BEST COMMAND EVER
[2012-09-07 23:48:59 -0400] whack: hehe
[2012-09-07 23:52:28 -0400] kallistec: bdot: with chef 10.14 you can try -f to make chef fork a subprocess for each run
[2012-09-07 23:52:46 -0400] kallistec: minimum memory usage will go up, but should keep the avg and max down
