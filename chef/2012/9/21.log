[2012-09-21 00:11:05 -0400] charity: hi there
[2012-09-21 00:11:12 -0400] charity: i have some chef workflow questions if anyone is around
[2012-09-21 00:11:42 -0400] charity: i'm currently using hosted chef, and trying to figure out how to set up a staging environment for cookbooks
[2012-09-21 00:12:09 -0400] charity: should i create a second hosted chef account?  is there an easier way?
[2012-09-21 00:12:29 -0400] jessicab: charity: environments are probably what youre looking for
[2012-09-21 00:13:09 -0400] charity: but if i have nodes with production or staging environments set, don't they pull down the same cookbooks?
[2012-09-21 00:14:07 -0400] charity: or is there a way to upload a cookbook and pin it to a specific environment?
[2012-09-21 00:14:12 -0400] jessicab: with environments you can use cookbook version constraints to keep production on older versions
[2012-09-21 00:16:18 -0400] jessicab: charity: there are some other ways you can do it too, environments is just the easiest in my opinion - http://wiki.opscode.com/display/chef/Version+Constraints
[2012-09-21 00:17:08 -0400] charity: hm, okay
[2012-09-21 00:17:45 -0400] charity: i will play with this.  thanks jessicab.
[2012-09-21 00:18:54 -0400] jessicab: charity: np.. hope that helps, you can also just set the version constraints in the webui if you want something simpler too, theyre just in the environments tab
[2012-09-21 00:19:32 -0400] hashpuppy_: how do you guys install a chef on a bare metal server?  do you use something like cobbler to bootstrap chef?
[2012-09-21 00:23:16 -0400] yfeldblum: charity, i would go with multiple hosted-chef orgs, or a single hosted-chef org and an open-source chef-server installed on a small VM for staging
[2012-09-21 00:24:20 -0400] yfeldblum: charity, environments provide some ability to segregate like you're looking for, but it's not a full segregation
[2012-09-21 00:24:39 -0400] charity: switching between the two isn't too painful?
[2012-09-21 00:25:21 -0400] yfeldblum: hashpuppy_, http://wiki.opscode.com/display/chef/Installing+Chef+Server
[2012-09-21 00:25:38 -0400] hashpuppy_: yfeldblum: i mean chef client
[2012-09-21 00:25:46 -0400] yfeldblum: charity, you will probably want to build a little smarts into your knife.rb
[2012-09-21 00:26:02 -0400] hashpuppy_: i've installed chef client before.  but i was wondering how to automate it
[2012-09-21 00:26:14 -0400] charity: k
[2012-09-21 00:26:15 -0400] hashpuppy_: and to keep things consistent
[2012-09-21 00:26:45 -0400] yfeldblum: charity, for example, you could have a knife.rb that looks at the envvar KNIFE_ENV and, based on that (if it's e.g. "staging" or "production") chooses the right settings, such as the right chef-server url, the right validation key, the right client name, and the right client key
[2012-09-21 00:26:59 -0400] yfeldblum: hashpuppy_, many people use `knife bootstrap`
[2012-09-21 00:27:17 -0400] hashpuppy_: thanks
[2012-09-21 00:27:33 -0400] charity: cool.  that sounds good.
[2012-09-21 00:28:54 -0400] yfeldblum: hashpuppy_, many people also use plugins like `knife ec2 server create` which creates a VM on EC2 and then bootstraps the VM, and similar plugins for rackspace cloud and other clouds
[2012-09-21 00:29:22 -0400] charity: we also check our chef-repo into git.  using the environments route seems like it would interact oddly with git.
[2012-09-21 00:29:41 -0400] charity: with the versioning in metadata
[2012-09-21 00:30:20 -0400] charity: i guess people just rely on chef to do versioning and history, and not source control?
[2012-09-21 00:30:40 -0400] MattJ: I got the impression most people are using git for everything
[2012-09-21 00:33:11 -0400] yfeldblum: charity, yeah, that's part of why i mentioned the approach i like
[2012-09-21 00:33:47 -0400] yfeldblum: MattJ, maybe even too much
[2012-09-21 00:34:08 -0400] MattJ: Naturally, I'd say they should be using hg :)
[2012-09-21 00:34:22 -0400] charity: heh
[2012-09-21 00:34:57 -0400] yfeldblum: MattJ, that's just silly
[2012-09-21 00:35:57 -0400] MattJ: You're speaking to the person who uses hg-git to access all his company's github repos
[2012-09-21 00:38:00 -0400] yfeldblum: MattJ, everybody has his faults
[2012-09-21 00:47:54 -0400] yfeldblum: awww a flamewar would have been so fun!
[2012-09-21 00:48:48 -0400] MattJ: If I entered a flamewar with everyone who thinks git is better than hg, I'd have been burnt to a crisp by now
[2012-09-21 00:49:07 -0400] MattJ: As it is, I just get to sit here with my smug face, knowing I'm using the superior tool
[2012-09-21 00:50:11 -0400] charity: my old boss used to say exactly the same thing
[2012-09-21 00:50:21 -0400] charity: but he wrote hg, so he's excused
[2012-09-21 01:07:16 -0400] masterkorp: jtimberman: Love your work man
[2012-09-21 01:07:20 -0400] masterkorp: just props
[2012-09-21 01:07:32 -0400] hashpuppy_: ilkewise
[2012-09-21 01:08:11 -0400] flaccid_: +1
[2012-09-21 01:11:03 -0400] masterkorp: http://i31.tinypic.com/aa7kv8.jpg
[2012-09-21 01:11:18 -0400] masterkorp: ONE ROUMD FOR EVERYONE
[2012-09-21 01:12:21 -0400] erikh: I approve of this message.
[2012-09-21 01:16:43 -0400] flaccid_: 0.5 round for the lightweights
[2012-09-21 01:21:03 -0400] masterkorp: nowai
[2012-09-21 01:21:15 -0400] masterkorp: lightweights call a taxi instead
[2012-09-21 01:21:44 -0400] flaccid_: heavyweights drive home in their car?
[2012-09-21 01:21:50 -0400] flaccid_: :o
[2012-09-21 01:22:27 -0400] masterkorp: no heavyweight cycle home
[2012-09-21 01:24:30 -0400] hashpuppy_: really digging this plugin:  https://github.com/nphase/knife-github-cookbooks
[2012-09-21 01:24:44 -0400] masterkorp: http://pastie.org/4766677
[2012-09-21 01:24:49 -0400] masterkorp: Guys any idea ?
[2012-09-21 01:24:57 -0400] masterkorp: options is a hash
[2012-09-21 01:25:39 -0400] masterkorp: why does it claim its an undifined method
[2012-09-21 01:39:02 -0400] yfeldblum: masterkorp, well then where is options defined?
[2012-09-21 01:39:53 -0400] masterkorp: just forgot to define the has
[2012-09-21 01:39:57 -0400] masterkorp: *hash
[2012-09-21 01:40:02 -0400] masterkorp: fixed it thanks anyways
[2012-09-21 01:40:07 -0400] erikh: :)
[2012-09-21 01:40:56 -0400] masterkorp: cheers bro
[2012-09-21 01:41:04 -0400] masterkorp: 2:40am
[2012-09-21 01:41:09 -0400] masterkorp: shold sleep
[2012-09-21 01:44:31 -0400] masterkorp: undefined method `[]=' for nil:NilClass
[2012-09-21 01:44:35 -0400] masterkorp: now i get this
[2012-09-21 01:45:23 -0400] masterkorp: i should use literals
[2012-09-21 01:49:53 -0400] bluepojo: undefined method []= for nil class usually means you have a nested hash that contains a key that you haven't set
[2012-09-21 01:49:54 -0400] bluepojo: ie:
[2012-09-21 01:50:08 -0400] bluepojo: something[:a][:b] = 'hi'
[2012-09-21 01:50:13 -0400] bluepojo: if something[:a] is nil
[2012-09-21 01:50:16 -0400] bluepojo: you'll get that error
[2012-09-21 01:52:08 -0400] masterkorp: yeah using literals shall fix it right ?
[2012-09-21 01:52:27 -0400] masterkorp: http://pastie.org/private/bslcxsgbh3krb2ghn619w
[2012-09-21 01:52:30 -0400] masterkorp: like this
[2012-09-21 01:56:10 -0400] masterkorp: /var/chef/cache/cookbooks/s3_backup/recipes/config.rb:21:in `block (2 levels) in from_file'
[2012-09-21 01:56:15 -0400] masterkorp: now i get this
[2012-09-21 01:58:48 -0400] yfeldblum: masterkorp, are the line numbers in the gist the same as the line numbers in the recipe?
[2012-09-21 02:00:12 -0400] masterkorp: just another type
[2012-09-21 02:00:21 -0400] masterkorp:    "token" => campfire_bot["token"]
[2012-09-21 02:00:30 -0400] masterkorp: somehow typo'ed this
[2012-09-21 02:00:43 -0400] masterkorp: node/campfire_bot
[2012-09-21 02:00:51 -0400] masterkorp: very common type, anyone can make it
[2012-09-21 02:02:10 -0400] masterkorp: No such file or directory - /root/.s3_cleaner.json
[2012-09-21 02:02:15 -0400] masterkorp: now this
[2012-09-21 02:02:51 -0400] masterkorp: i should add a file.exists
[2012-09-21 02:09:35 -0400] erratic: ;3
[2012-09-21 02:13:17 -0400] masterkorp: http://pastie.org/4767813
[2012-09-21 02:13:27 -0400] masterkorp: Any idea why it fails
[2012-09-21 02:13:55 -0400] masterkorp: libxml2 should be added
[2012-09-21 02:16:48 -0400] masterkorp: this is why i hate gems
[2012-09-21 02:17:07 -0400] flaccid_: those extra deps are annoying
[2012-09-21 02:21:40 -0400] masterkorp: [2012-09-21T02:20:22+00:00] INFO: Processing package[libxml2] action install (s3_backup::stats line 6)
[2012-09-21 02:21:42 -0400] masterkorp: [2012-09-21T02:20:22+00:00] INFO: Processing gem_package[fog] action install (s3_backup::stats line 11)
[2012-09-21 02:21:48 -0400] masterkorp: libxml2 is missing.  please visit http://nokogiri.org/tutorials/installing_nokogiri.html for help with installing dependencies.
[2012-09-21 02:21:55 -0400] masterkorp: what the heck
[2012-09-21 02:26:35 -0400] hoover_damm: bad testing
[2012-09-21 02:26:41 -0400] hoover_damm: ?
[2012-09-21 02:26:53 -0400] hoover_damm: also you need the -dev for nokogiri
[2012-09-21 02:26:58 -0400] hoover_damm: on top
[2012-09-21 02:27:35 -0400] masterkorp: i know
[2012-09-21 02:27:50 -0400] masterkorp:   hoover_damm | bad testing
[2012-09-21 02:27:55 -0400] masterkorp: this is testing
[2012-09-21 02:28:00 -0400] flaccid_: i think i had to cover this manually in chef-solo-wrapper
[2012-09-21 02:31:36 -0400] masterkorp: i want test-kitchen to work on my computer ;(
[2012-09-21 02:32:19 -0400] flaccid_: i believe the opscode wiki also covers install of those deps somewhere
[2012-09-21 02:33:33 -0400] masterkorp: http://tickets.opscode.com/browse/KITCHEN-38
[2012-09-21 02:33:43 -0400] masterkorp: I get this weird typo require
[2012-09-21 02:41:41 -0400] masterkorp: done
[2012-09-21 02:41:43 -0400] masterkorp: 4am
[2012-09-21 02:41:45 -0400] masterkorp: bed
[2012-09-21 02:41:47 -0400] masterkorp: bye
[2012-09-21 03:27:15 -0400] mattrobenolt: What's a good way to manage users per role using the "users" cookbook? Is that possible?
[2012-09-21 03:27:21 -0400] mattrobenolt: Or by environment.
[2012-09-21 04:21:44 -0400] kwinter: hi
[2012-09-21 04:23:40 -0400] kwinter: I use the newest version of chef-server , installed followed official docs in Ubuntu. but failed in  Chef- Solr .
[2012-09-21 04:24:58 -0400] kwinter: the older version have no problem, could someone help me on this.
[2012-09-21 04:25:38 -0400] kwinter: there are no related links talking about it.
[2012-09-21 04:29:29 -0400] flaccid_: kwinter: you'd have a better chance of help if you cited why exactly
[2012-09-21 04:31:20 -0400] kwinter: when i use ap-get install chef chef-server according to docs in wiki.opscode.com . Chef-Solr fail to run with "Chef Solr is not installed or solr_home_path, solr_data_path, and solr_jetty_path are misconfigured. "
[2012-09-21 04:32:06 -0400] kwinter: but i remember the older version of Chef doesn't have the issues.
[2012-09-21 04:32:33 -0400] kwinter: i have installed Chef-Server many times.
[2012-09-21 04:34:09 -0400] kwinter: when Chef release 0.10.14 ,i found the regular process provided by official site does not work .
[2012-09-21 04:38:17 -0400] xmltok: i had problems with the chef install also, i had to chown some stuff in /var and restart the services a few times
[2012-09-21 04:38:22 -0400] xmltok: this was on ubuntu 12.04
[2012-09-21 06:07:18 -0400] rava: if i want to capture the stdout of a bash execution using the Script resource, could i wrap the whole execution of that resource in a var assignment and call the chef logger passing that var?
[2012-09-21 07:40:42 -0400] rava: dead in here after hours :)
[2012-09-21 07:46:28 -0400] erikh: aye
[2012-09-21 08:16:45 -0400] rava: reviewing the chef-client community cookbook, and it seems odd that the log_level and log_location definitions are hardcoded. that seems like something you'd really want as attributes for the node
[2012-09-21 08:55:39 -0400] gyre007: is there any way how do I tell from the chef recipe whether the installed chef is Omnibus one or gem ?
[2012-09-21 09:05:06 -0400] rava: does setting a default_attribute in a role set a node attribute?
[2012-09-21 09:18:08 -0400] rava: ugh, the directory resource doesn't seem to actually be creating directories
[2012-09-21 09:22:59 -0400] AikiLinux: Hello, has anyone been able to integrate Chef with cobbler for a post-install configuration handover ?
[2012-09-21 09:24:02 -0400] AikiLinux: I tried googleing but the cobbler site talks about puppet and I could not find any info on cobbler-chef handover
[2012-09-21 09:24:28 -0400] ranjibd: rava, the chef run is failing .. or its simply ignoring the resource?
[2012-09-21 09:24:57 -0400] ranjibd: AikiLinux, we use kickstart... been pretty straight forward for us.
[2012-09-21 09:25:03 -0400] rava: ranjibd: it's ignoring the resource it seems
[2012-09-21 09:25:30 -0400] rava: ranjibd: i have an App.fatal! call to check if the directory exists since it took me a while to find this breackage point
[2012-09-21 09:26:38 -0400] rava: ranjibd: this is what's breaking: http://pastebin.com/28Fv0aZt
[2012-09-21 09:27:08 -0400] rava: ranjibd: on the node, using shef -z and calling node['java']['export_destination'] it gives me the right string value
[2012-09-21 09:27:18 -0400] rava: i can't see why the directory resource would be failing
[2012-09-21 09:27:55 -0400] _rc: rava: you're doing a test at compile time, for a thing that won't happen till converge time
[2012-09-21 09:28:06 -0400] ranjibd: rava, the check  you have written is in pure ruby inside the recipe .. and will be run during the compile time
[2012-09-21 09:28:29 -0400] rava: i put those in there due to it puking later, but i'll try it out
[2012-09-21 09:28:29 -0400] ranjibd: it will be executed even before the directory resource is triggered
[2012-09-21 09:28:30 -0400] _rc: ranjibd: jinx :)
[2012-09-21 09:28:45 -0400] ranjibd: _rc, :-)
[2012-09-21 09:29:27 -0400] ranjibd: rava, chef resources are idempotent.. u should not do that.. still if you want that for debugging  wrap that inside a ruby block..
[2012-09-21 09:33:06 -0400] AikiLinux: ranjibd, and you specify in the %post stage to hand over to chef ?
[2012-09-21 09:34:32 -0400] rava: finding an error finally, stupid ubuntu and their svn config. using the subversion resource i get: Username: svn: Can't read stdin: End of file found
[2012-09-21 09:34:50 -0400] ranjibd: AikiLinux, yes
[2012-09-21 09:35:53 -0400] rava: passing in svn_username and svn_password , odd that it would get that auth error
[2012-09-21 09:39:44 -0400] AikiLinux: ranjibd, you mind sharing that config ?
[2012-09-21 09:52:11 -0400] alexbst: I want a chef recipe to only do something on its second (or 10th?) run :D ideas ? :D
[2012-09-21 09:55:18 -0400] alexbst: is there no internal run counter I could use ?
[2012-09-21 09:58:30 -0400] _rc: you could save a node attribute to track it yourslef
[2012-09-21 09:59:43 -0400] alexbst: I need a nice guide to doing that ;)
[2012-09-21 10:01:46 -0400] _rc: alexbst: start herte http://wiki.opscode.com/display/chef/Attributes#Attributes-HowtoUseAttributes
[2012-09-21 10:09:41 -0400] Tensibai: Hi there
[2012-09-21 10:10:15 -0400] Tensibai: Just wondering: how may I manage a switch configuration on wich I obviously can't install chef-client
[2012-09-21 10:11:00 -0400] ranjibd: AikiLinux, ks config right ? Let me dig it out
[2012-09-21 10:17:10 -0400] jedi4ever: kinda puzzled what the following query does - "hostname:[* TO *]" for a node search
[2012-09-21 10:17:15 -0400] jedi4ever: why the * TO * ?
[2012-09-21 10:18:44 -0400] _rc: I guess it's a computed range search, it's the same as hostname:* or not even specifying the hostname
[2012-09-21 10:18:51 -0400] _rc: http://wiki.opscode.com/display/chef/Search#Search-RangeSearch
[2012-09-21 10:19:21 -0400] _rc: actually no, I think it specifies hostname must have a value, so it's not the same as not specifying it
[2012-09-21 10:20:20 -0400] jedi4ever: yep - this is Solr syntax - "field:[* TO *] matches all documents with the field" thanks
[2012-09-21 10:20:27 -0400] _rc: doh, just scrolled up.  It's a 0.9-safe way of saying hostname:* http://wiki.opscode.com/display/chef/Search#Search-WildcardMatches
[2012-09-21 10:23:54 -0400] jedi4ever: thx _rc
[2012-09-21 10:41:20 -0400] zeroXten: is there a recommended way of having kickstart setup a server as a chef client? To save manually running knife bootstrap for example
[2012-09-21 11:16:27 -0400] masterkorp: zeroXten: for a normal server ?
[2012-09-21 11:42:04 -0400] Triml: Hello. How to put html file to all the servers using knife ssh?
[2012-09-21 11:46:40 -0400] masterkorp: yes
[2012-09-21 12:28:55 -0400] Tensibai: Someone alive to point me toward information on how to manage a switch or something where you can't install chef client ?
[2012-09-21 12:29:31 -0400] zeroXten: masterkorp: normal server? Just a bunch of Centos boxes, kickstarted through cobbler
[2012-09-21 12:29:50 -0400] zeroXten: would be nice to not have to do anything manual after adding host to cobbler
[2012-09-21 12:29:56 -0400] masterkorp: never used cobbler
[2012-09-21 12:30:11 -0400] zeroXten: just fluff around kickstart ;)
[2012-09-21 12:30:34 -0400] masterkorp: but i use the knife-ec2 to create and bootstarp the machine with one call
[2012-09-21 12:30:58 -0400] masterkorp: i am pretty sure you can write a plugin to kickstart
[2012-09-21 12:31:27 -0400] zeroXten: well, kickstarting isn't a problem it is telling kickstart to setup/run the server as a chef client
[2012-09-21 12:33:02 -0400] zeroXten: but I now have a more interesting problem :) Stopping users from running "knife * upload" ;)
[2012-09-21 12:33:15 -0400] Tensibai: zeroXten: what about adding a ssh command at kickstart post install phase which launch knife bootstrap ?
[2012-09-21 12:34:18 -0400] zeroXten: Tensibai: yeah, that is what our developers do in their env, but I don't like the idea of servers SSHing into our production chef
[2012-09-21 12:35:22 -0400] Tensibai: Aww, in this case I don't see how you'll be able do that (mainly because of the key copying part)
[2012-09-21 12:36:15 -0400] Tensibai: Maybe a web page calling knife bootstrap "calling node" which you get with curl or wget ?
[2012-09-21 12:37:02 -0400] Tensibai: Better, a web page wich add host to a temp file and a cronjob reading it to launch knife bootstrap and then remove host from temp file
[2012-09-21 12:37:27 -0400] Tensibai: (or maybe easier with a directory ...) well there's plenty of way in fat :)
[2012-09-21 12:37:29 -0400] Tensibai: fact*
[2012-09-21 12:38:11 -0400] Tensibai: you may also replicate the knife template into a kickstart script (but you'll still have the validation.pem copy problem to register the new host...)
[2012-09-21 12:39:45 -0400] zeroXten: ahh, a classic hack ;)
[2012-09-21 12:39:46 -0400] zeroXten: hmmm
[2012-09-21 12:41:51 -0400] masterkorp: Is there a ruby cookbook ?
[2012-09-21 12:41:56 -0400] masterkorp: aww there is not
[2012-09-21 12:52:16 -0400] Tensibai: So well, I'm still looking for a way to manage switches or F5 load balancers with chef ...
[2012-09-21 12:53:24 -0400] Tensibai: should I use a 'node' defintion on a proxy box which will do ssh commands for exemple ?
[2012-09-21 12:53:36 -0400] _rc: sure, if that fits
[2012-09-21 12:54:52 -0400] masterkorp: what i did not knew that gem_package installed the gems on the ruby embeded that chef uses instead of the system ruby
[2012-09-21 12:54:52 -0400] Tensibai: I don't know, I'm looking for doc about it before banging my head on the wall
[2012-09-21 12:55:05 -0400] masterkorp: is there any way i can enfoce this
[2012-09-21 12:55:26 -0400] masterkorp: ?
[2012-09-21 12:55:32 -0400] _rc: masterkorp: chef_gem installs against the one that chef uses always
[2012-09-21 12:55:44 -0400] _rc: masterkorp: gem_package can be told to do whatever
[2012-09-21 12:55:57 -0400] _rc: masterkorp: you just pass it the path to the gem binary
[2012-09-21 12:57:09 -0400] _rc: Tensibai: there are certainly examples of LWRPs that interact with remote services to configure them - eg http://wiki.opscode.com/display/chef/Opscode+LWRP+Resources#OpscodeLWRPResources-dynect
[2012-09-21 12:57:37 -0400] masterkorp: _rc: can be told? How
[2012-09-21 12:57:44 -0400] Tensibai: _rc: Thanks, probably what I was looking for ;)
[2012-09-21 12:57:59 -0400] _rc: masterkorp: read the docs for that resource type
[2012-09-21 12:58:14 -0400] masterkorp: i did read
[2012-09-21 12:58:35 -0400] masterkorp: if i miss anything, can you point me to here is that stated ?
[2012-09-21 12:59:15 -0400] masterkorp: "If you specify a gem_binary, the provider will run that gem command to examine its environment settings, and again to install the gem."
[2012-09-21 12:59:17 -0400] masterkorp: this ?
[2012-09-21 12:59:20 -0400] _rc: masterkorp: there's an attribute that behaves as I previously descrived
[2012-09-21 12:59:28 -0400] _rc: masterkorp: yes, that
[2012-09-21 12:59:50 -0400] masterkorp: thanks
[2012-09-21 13:00:08 -0400] masterkorp: now i am curious does it have a preference ?
[2012-09-21 13:01:18 -0400] _rc: a preference, or a default?
[2012-09-21 13:01:28 -0400] masterkorp: How does it behave by default ?
[2012-09-21 13:01:43 -0400] _rc: don't the docs/sourcecode say?
[2012-09-21 13:01:50 -0400] _rc: learn to fish; g'wan
[2012-09-21 13:02:04 -0400] Tensibai: http://wiki.opscode.com/display/chef/Resources#Resources-Package <= scroll down for doc about gem_package vs chef_gem
[2012-09-21 13:25:05 -0400] jwitrick: Question for the group:
[2012-09-21 13:26:17 -0400] jwitrick: I am running into the situation where objects are in knife but not chef-search. i see the page http://wiki.opscode.com/display/chef/Chef+Indexer where it describes the symptons we are seeing. The only question I have is: 'is the offending quotation in the chef code or in the cookbooks' ?
[2012-09-21 13:26:37 -0400] jwitrick: not all servers have this issue.
[2012-09-21 13:55:58 -0400] gustavo: Hi guys, I've a question about ruby programing, I'm newbie in ruby :(. How can I check if node.hostname is defined ?
[2012-09-21 13:56:09 -0400] gyre007: why am I getting gem: command not found when I run knife ssh "chef_environment:production" "gem list"
[2012-09-21 13:56:11 -0400] gyre007: arrrgh
[2012-09-21 13:56:30 -0400] gyre007: gustavo, node.hostname.nil?
[2012-09-21 13:56:38 -0400] gyre007: if node.hostname.nil?
[2012-09-21 13:57:35 -0400] Tensibai: gyre007: gem not in path ?
[2012-09-21 13:57:37 -0400] gustavo: gyre007: thanks I'll try that
[2012-09-21 13:57:54 -0400] gyre007: Tensibai, stange becuase when I log on via ssh it is in path
[2012-09-21 13:58:06 -0400] Tensibai: gyre007: you may try a knife ssh "chef_environment:production" "which gem" to ensure that
[2012-09-21 13:58:15 -0400] gyre007: but then again we are running the most retarded ruby/rail tool - rvm
[2012-09-21 13:58:29 -0400] gyre007: which is overriding gem command
[2012-09-21 13:58:31 -0400] gyre007: arrrgh
[2012-09-21 13:58:38 -0400] gyre007: Tensibai, yeah good point
[2012-09-21 13:58:57 -0400] Tensibai: ;o)
[2012-09-21 13:59:47 -0400] gyre007: Tensibai, yeah. sourcing rvm.sh helps...arrggh...time to get rid of it forever :) cheers man
[2012-09-21 13:59:55 -0400] gyre007: or woman :)
[2012-09-21 14:00:04 -0400] Tensibai: man ;o) and you're welcome
[2012-09-21 14:00:09 -0400] gyre007: haha good
[2012-09-21 14:01:34 -0400] jedi4ever: fwiw - added searchable role support and nested searches to chef-solo via chef-solo-search - https://github.com/jedi4ever/chef-solo-search/commit/52ecc3030fae8fb184c29d2d1fdf36a69ba58db5
[2012-09-21 14:01:36 -0400] jedi4ever: thoughts?
[2012-09-21 14:05:28 -0400] gustavo: gyre007: didn't work :(  I'm getting this error: ArgumentError: Attribute hostname is not defined!, /usr/lib/ruby/vendor_ruby/chef/node/attribute.rb:428:in `method_missing'
[2012-09-21 14:07:14 -0400] _rc: gustavo: you have a sick machine, ohai isn't able to determine the machines hostname
[2012-09-21 14:10:03 -0400] _rc: gustavo: if you're on linux it means `hostname -s` doesn't return anything - https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/linux/hostname.rb
[2012-09-21 14:10:33 -0400] gustavo: _rc: my problem arise because I'm searching from a new node, and this node is  returned in the result.
[2012-09-21 14:11:10 -0400] gustavo: search(:node, '*:*') do |host|
[2012-09-21 14:11:30 -0400] gustavo: _rc: nodeHostname = ( host.hostname.nil? ) ? node.hostname : host.hostname
[2012-09-21 14:12:42 -0400] _rc: gustavo: so change your search.  search(:node, 'hostname:*')
[2012-09-21 14:13:02 -0400] _rc: won't give you nodes without hostnames
[2012-09-21 14:17:49 -0400] gustavo: _rc: I understand your solution, is good, I'll try this way but is it possible check for hostname existence ?
[2012-09-21 14:22:26 -0400] Tensibai: gustavo: you may try node.attributes?('hostname') if I remember correctly
[2012-09-21 14:22:39 -0400] Tensibai: which would return nil if not set
[2012-09-21 14:29:23 -0400] jedi4ever: oha- sorry for my channel spam - :)
[2012-09-21 14:29:40 -0400] jedi4ever: i'm looking for a way to check if a package is installed
[2012-09-21 14:30:22 -0400] gustavo: Tensibai: It worked !
[2012-09-21 14:30:53 -0400] Tensibai: jedi4ever: ?
[2012-09-21 14:31:20 -0400] Tensibai: gustavo: great :)
[2012-09-21 14:31:31 -0400] jedi4ever: Tensibai: for the nagios packages I need to run the debconf-set-selections only if package is not yet installed
[2012-09-21 14:31:38 -0400] gustavo: gyre007, _rc, Tensibai: thanks a lot for help !
[2012-09-21 14:32:50 -0400] spox: jedi4ever: the easiest way may be to spin up a package provider in a not_if block
[2012-09-21 14:33:13 -0400] spox: i think they all have a #check_package_state method, but that's just off memory
[2012-09-21 14:34:46 -0400] jedi4ever: spox: trying to grok your suggestion ..
[2012-09-21 14:35:06 -0400] jedi4ever: most of the time you see the thing { package 'nagios'} not_if (some case)
[2012-09-21 14:35:32 -0400] jedi4ever: I'm looking for { execute . } not_if package(installed)
[2012-09-21 14:35:54 -0400] spox: jedi4ever: right. the not_if can take a ruby block and use its resulting value
[2012-09-21 14:36:16 -0400] spox: the package provider is just a class. you can just create a dummy one in the not_if block to do the check
[2012-09-21 14:38:26 -0400] jedi4ever: spox: I'll have a try - thanks for the  suggestion
[2012-09-21 14:39:20 -0400] Tensibai: jedi4ever: or check with dpkg the system state
[2012-09-21 14:39:25 -0400] Tensibai: the package state
[2012-09-21 14:39:36 -0400] jedi4ever: Tensibai: that's a good tip
[2012-09-21 14:39:49 -0400] spox: jedi4ever: looks like the package providers aren't consistent with their methodology
[2012-09-21 14:39:50 -0400] Tensibai: dpkg -s nagios3 | grep installed for exemple
[2012-09-21 14:40:15 -0400] spox: however, the action_install checks @current_resource.version.nil? to determine if it needs to install
[2012-09-21 14:40:49 -0400] spox: jedi4ever: fwiw, using package over just grepping dpkg gives you support on non-dpkg (debian-based) systems
[2012-09-21 14:41:27 -0400] jedi4ever: spox: true but in this case it's debian/ubuntu specific debconf-set-selections
[2012-09-21 14:42:26 -0400] spox: oh, well then. excuse my while i insert my foot in mouth :)
[2012-09-21 14:42:48 -0400] spox: jedi4ever: well, the package bit would still work, or dpkg, or using apt-cache
[2012-09-21 14:43:03 -0400] jedi4ever: spox: no-no don''t apologise , I like speed learning :)
[2012-09-21 14:43:44 -0400] Tensibai: Indeed I think loking at the package provider/LWRP for deb ressources may help
[2012-09-21 14:45:14 -0400] Tensibai: and ... you may also try: dpkg --get-selections nagios3
[2012-09-21 14:45:19 -0400] Tensibai: for exemple
[2012-09-21 14:45:42 -0400] jedi4ever: Tensibai: true - trying to avoid another package here to be installed
[2012-09-21 14:46:29 -0400] Tensibai: but I wonder about your final goal working with set-selections
[2012-09-21 14:46:39 -0400] Tensibai: instead of working with package ressources in your recipe
[2012-09-21 14:46:53 -0400] _dumfrie-: would using 'response_file' be out of question here?
[2012-09-21 14:47:25 -0400] jedi4ever: _dumfrie-: that'll work too, but I only want to run the response_file once
[2012-09-21 14:47:32 -0400] jedi4ever: wait i'll make a gist
[2012-09-21 14:47:54 -0400] _dumfrie-: it would only get run provide the package is being installed, not if it is already installed.
[2012-09-21 14:48:01 -0400] _dumfrie-: provided*
[2012-09-21 14:48:26 -0400] jedi4ever: here's the gist - https://gist.github.com/3761911
[2012-09-21 14:49:00 -0400] _dumfrie-: I would remove the password generating from your recipe to begin with ;)
[2012-09-21 14:49:24 -0400] _dumfrie-: why not just install packages and manage the configuration afterwards?
[2012-09-21 14:49:43 -0400] jedi4ever: because the package install fails waiting for the adminpassword setting
[2012-09-21 14:50:28 -0400] _dumfrie-: really?
[2012-09-21 14:50:30 -0400] _dumfrie-: let me see
[2012-09-21 14:50:52 -0400] jedi4ever: created this ticket - http://tickets.opscode.com/browse/COOK-1691
[2012-09-21 14:51:27 -0400] jedi4ever: might be because of a new package that introduces that requirement
[2012-09-21 14:52:01 -0400] Tensibai: ...
[2012-09-21 14:53:39 -0400] Tensibai: Not really used to but: does not the option field allow to pressed ?
[2012-09-21 14:55:13 -0400] _dumfrie-: it allows you to alter the behaviour of 'apt-cache' in the apt provider.
[2012-09-21 14:55:40 -0400] _dumfrie-: response_file is what I would suggest.
[2012-09-21 14:56:12 -0400] jedi4ever: _dumfrie-: can you provide a response file to a 'package' resource ?
[2012-09-21 14:56:23 -0400] _dumfrie-: You can.
[2012-09-21 14:56:37 -0400] _dumfrie-: http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-09-21 14:57:21 -0400] Tensibai: _dumfrie-:  I was thinkink about a option: "-o nagios3/adminpassword=#{random_initial_password}
[2012-09-21 14:57:58 -0400] Tensibai: But the response file won't have a random password ... but that's not a problem to change it later with a recipe...
[2012-09-21 14:58:15 -0400] _dumfrie-: Tensibai Yeah, however ...
[2012-09-21 14:58:19 -0400] _dumfrie-: :command => "apt-get -q -y#{expand_options(default_release_options)}#{expand_options(@new_resource.options)} install #{package_name}",
[2012-09-21 14:59:06 -0400] gchristensen: " of 0.10.6, knife bootstrap supports the 'encrypted_data_bag_secret' setting in knife.rb." - this secret doesn't get uploaded to Opscode on Hosted Chef, right?
[2012-09-21 15:00:44 -0400] Tensibai: -o nagios3::adminpassword=bar would be the correct way to add it in the package definition I think (I would have to play with it as I didn't ever use that ...)
[2012-09-21 15:00:54 -0400] spox: jedi4ever: just for reference on using the resource/provider to determine if the package is installed, this could go in an only if block:
[2012-09-21 15:01:01 -0400] spox: Chef::Resource::Package.new('nagios3', run_context).provider_for_action(:install).load_current_resource.version.nil?
[2012-09-21 15:02:32 -0400] Tensibai: spox: and I would set it as a if englobing the whole loops
[2012-09-21 15:02:46 -0400] jedi4ever: spox: cool thanks for figuring out that syntax
[2012-09-21 15:02:55 -0400] Tensibai: (ANDed with the ubuntu platform in fact)
[2012-09-21 15:03:13 -0400] Tensibai: (to avoid checking it for each value in the loop :p
[2012-09-21 15:07:17 -0400] jtimberman: jedi4ever: ohai! :D
[2012-09-21 15:07:51 -0400] jedi4ever: jtimberman: nice to be in chef land again :)
[2012-09-21 15:08:25 -0400] _dumfrie-: I've been dragged into puppet land :(
[2012-09-21 15:08:55 -0400] jedi4ever: _dumfrie-: my approach is to fix in both was I miss from the other :)
[2012-09-21 15:09:04 -0400] jedi4ever: s/was/what/
[2012-09-21 15:09:38 -0400] _dumfrie-: very interesting, I will have to wait for updates ;)
[2012-09-21 15:09:42 -0400] _dumfrie-: back in a bit
[2012-09-21 15:13:12 -0400] rocket: jtimberman: I have a question I am trying to figure out where Chef::Resource::ZenossZenpack  is being defined in the zenoss zenpack provider ..
[2012-09-21 15:13:58 -0400] rocket: I am trying to read the code and understand whats going on .. maybe its just a ruby thing but I cant find the ZenossZenpack class?  unless its not a class?
[2012-09-21 15:17:59 -0400] jtimberman: rocket: its defined in an LWRP, zenooss cookbook, zenpack resource
[2012-09-21 15:19:59 -0400] rocket: ah I see .. so its merging the name of the cookbook plus the resource name...
[2012-09-21 15:20:17 -0400] rocket: jtimberman: where is that code in chef that is merging them?  the resource.rb file?
[2012-09-21 15:21:57 -0400] jtimberman: rocket: the resources/zenpack.rb file in the cookbook
[2012-09-21 15:29:37 -0400] jtimberman: more information here: http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29
[2012-09-21 15:30:56 -0400] rocket: jtimberman: I am more interested in seeing how they become ruby classes behind the scenes ..
[2012-09-21 15:31:02 -0400] rocket: I was curious where that happened
[2012-09-21 15:32:57 -0400] jtimberman: rocket: i don't remember where in the code that happens off hand
[2012-09-21 15:35:03 -0400] rocket: ok .. thanks I can try and find it on my own ..
[2012-09-21 15:35:47 -0400] _0x783czar: Lets say I have a node and client, which I delete from my Chef Server.  Is there a way to add it again without bootstrapping all over again?
[2012-09-21 15:36:57 -0400] jkessler: how do I "source" a cookbook_file for files stored in a folder other than default? i.e., ./cookbooks/foo/files/bar/filename.txt
[2012-09-21 15:38:27 -0400] _0x783czar: jkessler: the other folders are meant to be used for file specificity (name the folders after the operating system they apply to)
[2012-09-21 15:39:06 -0400] jkessler: thanks
[2012-09-21 15:39:22 -0400] _0x783czar: jkessler: I'm not sure if you can specify a different folder, only the specific name of the the file you want to use as the source.  But I've never tried it.
[2012-09-21 15:44:26 -0400] ssd7: rocket: For providers, the actual conversion to a class is pretty simple: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider.rb#L185-224
[2012-09-21 15:59:31 -0400] _0x783czar: Could someone explain the difference between a Node and a Client?  I'm still a bit fuzzy on that.
[2012-09-21 16:04:20 -0400] jtimberman: _0x783czar: a node is a thing that is managed by chef, and has attributes and a run list.
[2012-09-21 16:04:27 -0400] jtimberman: _0x783czar: a client is a thing that authenticates to the API.
[2012-09-21 16:04:43 -0400] _0x783czar: jtimberman: OK, thanks.
[2012-09-21 16:05:32 -0400] _0x783czar: jtimberman: so suppose I delete a node and client from my chef server, how would I go about re-registering my already bootstrapped server with the chef-server?
[2012-09-21 16:07:28 -0400] jtimberman: _0x783czar: use the validation client to automatically create a new one
[2012-09-21 16:07:46 -0400] rocket: jtimberman: I have a problem where I am getting an attribute value I dont expect .. how would you debug something like that?  I have looked in the chef webui and the value I expect is set there but something else is changing the value
[2012-09-21 16:08:19 -0400] jtimberman: rocket: use shef?
[2012-09-21 16:08:47 -0400] rocket: jtimberman: I am not 100% familiar with how to use shef .. I will look into it
[2012-09-21 16:09:23 -0400] _0x783czar: jtimberman: where can I look to see how to do that?
[2012-09-21 16:09:47 -0400] jtimberman: _0x783czar: knife bootstrap will do that automatically for you.
[2012-09-21 16:10:47 -0400] rocket: jtimberman: how do I query the attributes in shef .. the website examples arent very clear ..
[2012-09-21 16:11:43 -0400] rocket: I am looking at http://wiki.opscode.com/display/chef/Getting+Started+with+Shef
[2012-09-21 16:11:45 -0400] terbeaux: hello everybody
[2012-09-21 16:13:33 -0400] jonlives: rocket: look at the breakpoint section of http://blog.mycrot.ch/2012/02/07/chef-development-with-shef, you can add breakpoints to your recipe which will be picked up by shef runs and you can look at what value various stuff has to see if it's what you expect.
[2012-09-21 16:21:03 -0400] _0x783czar: jtimberman: perfect.  Thanks, it didn't work at first but as soon as I deleted the client.pem file from the server it worked.
[2012-09-21 16:21:48 -0400] mattrobenolt: Are there any cookbooks for managing users across different environments? The users::sysadmins obviously does not cut it.
[2012-09-21 16:24:04 -0400] mattrobenolt: Or, it looks like I can do it all on the sudo cookbook and roles.
[2012-09-21 16:24:59 -0400] rocket: jonlives: how can I tell what recipes will be run?
[2012-09-21 16:26:10 -0400] jonlives: rocket: knife node show <name of node> will tell you the node's run_list
[2012-09-21 16:26:26 -0400] rocket: in shef... does shef import the runlist?
[2012-09-21 16:26:55 -0400] jonlives: rocket: see earlier in the article
[2012-09-21 16:27:42 -0400] jonlives: rocket: you *can* use it to get he run_list from the server, but I tend to pass it in manually myself
[2012-09-21 16:28:12 -0400] jonlives: ie, run it in "solo" mode
[2012-09-21 16:29:04 -0400] erikh: node.run_list IIRC
[2012-09-21 16:29:11 -0400] erikh: just p it
[2012-09-21 16:29:24 -0400] jonlives: right
[2012-09-21 16:37:11 -0400] Eulipion: can someone help me with the application provider?  it's not creating a releases dir, but is symlinking to nonexistant paths in it
[2012-09-21 16:39:47 -0400] oddover: Anyone know if there's a variable that stores the backup directory path? (defaults to /var/chef/backups/)
[2012-09-21 16:41:29 -0400] Eulipion: oddover: look at the chef-server default attributes, it's got bunch of backup vars
[2012-09-21 16:41:59 -0400] Eulipion: oddover: you probably want default["chef_server"]["backup_path"]
[2012-09-21 16:47:27 -0400] gyre007: is there any tool Im missing on which would be able to upload a particular cookbook with all dependencies from the filesystem ? I'm talking about cookbooks on the filesystems...not community cookbooks....basically we are setting up a new Chef server and need to upload all of our cookbooks there...
[2012-09-21 16:48:13 -0400] _dumfrie-: knife cookbook upload -a
[2012-09-21 16:49:26 -0400] ctracey: might also look into spiceweasel for more than just cookbooks
[2012-09-21 16:49:35 -0400] mattray: should I be able to add an arbitrary variable to my knife.rb and access it in a bootstrap context? Or am I smoking crack?
[2012-09-21 16:50:27 -0400] erikh: mattray: Chef::Config[:foo]
[2012-09-21 16:50:31 -0400] erikh: *should* work.
[2012-09-21 16:50:40 -0400] gyre007: _dumfrie-, interesting...is there a list of knife switches somewhere ...when I run knife --help it doesnt print out -a switch
[2012-09-21 16:51:14 -0400] _dumfrie-: gyre007 knife cookbook upload --help
[2012-09-21 16:51:35 -0400] _dumfrie-: and the --help option to most commands and it will spit out the docs for you
[2012-09-21 16:51:39 -0400] _dumfrie-: add*
[2012-09-21 16:51:50 -0400] oddover: what am I doing wrong here: log "#{default['chef_solo']['backup_path']}"
[2012-09-21 16:51:59 -0400] gyre007: _dumfrie-, cheers mate
[2012-09-21 16:52:05 -0400] _dumfrie-: np
[2012-09-21 16:52:13 -0400] oddover: I'm getting: [2012-09-21T10:50:22-06:00] FATAL: ArgumentError: You must supply a name when declaring a default resource
[2012-09-21 16:52:14 -0400] jb__: oddover: "node" not "default"
[2012-09-21 16:52:22 -0400] gyre007: interesting to know how it resolves the dependencies...
[2012-09-21 16:52:29 -0400] gyre007: would be*
[2012-09-21 16:52:34 -0400] _dumfrie-: believe that is deteremined through the metadata these days?
[2012-09-21 16:52:49 -0400] _dumfrie-: could be wrong, having a after beer work messes with the memory.
[2012-09-21 16:52:54 -0400] gyre007: yeah ...but it still must be quite complicated with lets say 80 cookbooks :)
[2012-09-21 16:52:59 -0400] jackery: I'm working on a backup of my chef server; anyone know where the server stores its validation key?
[2012-09-21 16:53:25 -0400] _dumfrie-: gyre007 oh no doubt, take a look at the source.
[2012-09-21 16:53:58 -0400] oddover: jb__: now I'm getting this: [2012-09-21T10:53:09-06:00] FATAL: NoMethodError: undefined method `[]' for nil:NilClass
[2012-09-21 16:54:07 -0400] oddover: code: log "#{node['chef_solo']['backup_path']}"
[2012-09-21 16:55:45 -0400] gyre007: ctracey, spiceweasel looks very interesting...
[2012-09-21 16:55:56 -0400] gyre007: read something about Librarian but I guess that's for something else...
[2012-09-21 16:57:02 -0400] ctracey: gyre007: you can thank mattray
[2012-09-21 16:57:30 -0400] gyre007: mattray, thanks :)
[2012-09-21 17:01:23 -0400] gyre007: _dumfrie-, too bad there is no download -a option ;(
[2012-09-21 17:03:03 -0400] mattray: erikh: given that, how should I be able to access it in the bootstrap erb?
[2012-09-21 17:03:15 -0400] mattray: I've added a remote_url variable in my knife.rb
[2012-09-21 17:05:12 -0400] erikh: right, so you knife[:remote_url] = "stuff" in knife.rb
[2012-09-21 17:05:27 -0400] erikh: and then <%= Chef::Config[:remote_url] %> in your bootstrap template
[2012-09-21 17:07:20 -0400] mattray: erikh: I just have remote_url = "stuff" in the knife.rb
[2012-09-21 17:07:51 -0400] gyre007: ok let me ask this way :)...is there any knife command which will allow you to download all cookbook from your chef server ?
[2012-09-21 17:07:58 -0400] erikh: yeah, that probably won't work; it's just a local variable after all
[2012-09-21 17:08:18 -0400] gyre007: rather than iterating over all cookbooks...
[2012-09-21 17:09:40 -0400] erikh: I imagine you could do something with `knife cookbook list` in a for loop pretty trivially.
[2012-09-21 17:10:04 -0400] mattray: erikh: got it
[2012-09-21 17:10:14 -0400] mattray: erikh: test_url "blah"
[2012-09-21 17:10:19 -0400] mattray: in the knife.rb
[2012-09-21 17:10:26 -0400] erikh: ah, so abusing the method_missing
[2012-09-21 17:10:29 -0400] erikh: that works!
[2012-09-21 17:10:32 -0400] mattray: Chef::Config[:test_url] in the erb
[2012-09-21 17:10:38 -0400] gyre007: erikh, yeah thats what I figured...thought there was something smarter though :)
[2012-09-21 17:11:17 -0400] erikh: well if you find something in the help, spout off here
[2012-09-21 17:11:20 -0400] erikh: I don't know of anything though.
[2012-09-21 17:17:51 -0400] gyre007: erikh, that will have to do for now :)
[2012-09-21 17:22:28 -0400] gswallow: gem list
[2012-09-21 17:22:28 -0400] gswallow: chef (10.14.2, 0.10.8)
[2012-09-21 17:22:58 -0400] gswallow: default[:mysql][:master_server_id] = node[:ipaddress].split('.')[-2] + node[:ipaddress].split('.')[-1]
[2012-09-21 17:23:12 -0400] gswallow:  /var/chef/cache/cookbooks/mysql/attributes/master.rb:1:in `from_file': private method `split' called for nil:NilClass (NoMethodError)
[2012-09-21 17:23:26 -0400] gswallow: what happened to node[:ipaddress]?
[2012-09-21 17:24:02 -0400] erikh: knife node edit <node> -a and find out
[2012-09-21 17:24:17 -0400] gswallow: if I uninstall 10.14.2 and leave 0.10.8 on there, this works fine.
[2012-09-21 17:31:59 -0400] ssd7: gswallow: Would you mind trying 10.12.0 to help bisect where the problem might have snuck in.  Also what versions of Ohai do you have installed?
[2012-09-21 17:33:28 -0400] gswallow: ssd7: gimme a sec.  I'm mass-removing 10.14.2 :)
[2012-09-21 17:43:37 -0400] newb: ohai chefs
[2012-09-21 17:48:32 -0400] stormerider: ohai :)
[2012-09-21 17:54:20 -0400] gswallow: ssd7: I may have other problems.  I think I got 10.14.2 uninstalled and ran into the same issue.
[2012-09-21 17:54:28 -0400] gswallow: These are pretty rotten CentOS boxes.
[2012-09-21 17:59:16 -0400] Eulipion: can someone help me with application_python_django, no matter what i do, it tells me I've the the wrong number of args
[2012-09-21 17:59:47 -0400] kallistec: gswallow: your problem has to do with ohai, not chef. does `ohai ipaddress` return anything?
[2012-09-21 18:00:09 -0400] gswallow: My problem has to do with rvm
[2012-09-21 18:02:54 -0400] gswallow: Whichthat makes me cuss.  A lot.  But that's an entirely different story.  Sorry about the false alarm.
[2012-09-21 18:23:47 -0400] Eulipion: can someone help me with application_python_django, no matter what i do, it tells me I've the the wrong number of args
[2012-09-21 18:34:01 -0400] thedeeno: I'm getting 401 errors when trying to run chef-client on a node. It's suggesting that my client key might nt be valid. I've removed the node+client and ran chef-client -N SOMENODE to grab a new key
[2012-09-21 18:34:08 -0400] thedeeno: but still gettgin the same error
[2012-09-21 18:34:23 -0400] Eulipion: rm -f /etc/chef/client.pem and try again
[2012-09-21 18:34:30 -0400] thedeeno: did that too
[2012-09-21 18:36:15 -0400] thedeeno: oo, didn't notice this before: Invalid signature for user or client 'staging'
[2012-09-21 18:36:43 -0400] thedeeno: does that mean that my validator key is broken?
[2012-09-21 18:37:20 -0400] Eulipion: does uname -n match what the server thinks ?
[2012-09-21 18:38:10 -0400] thedeeno: yeah, it does
[2012-09-21 18:38:31 -0400] Eulipion: you might want to bootstrap or reregister the client
[2012-09-21 18:38:56 -0400] thedeeno: how can I re-register?
[2012-09-21 18:39:06 -0400] thedeeno: (I thought that's what I was doing :))
[2012-09-21 18:39:10 -0400] Eulipion: knife client reregister <host> ,iirc
[2012-09-21 18:39:14 -0400] jkessler: what's the bets way to share a global attribute shared by many cookbooks?
[2012-09-21 18:41:28 -0400] jwitrick1: if its on the same node just set it as a node attribute: node['some_attr'] = 'foo'
[2012-09-21 18:41:45 -0400] jwitrick1: if its between many nodes try using data bags.
[2012-09-21 18:42:14 -0400] jkessler: thanks
[2012-09-21 18:45:35 -0400] kindsol: are many folks out there using librarian to help manage cookbook versions?  It seems pretty cool.  Are there other preferences out there?
[2012-09-21 18:47:52 -0400] Eulipion: how long does it usually take for tickets to get assigned?
[2012-09-21 18:57:01 -0400] thedeeno: any thoughts as to why `knife client list` would show a different result than managed chef's client tab?
[2012-09-21 18:57:14 -0400] thedeeno: nvm
[2012-09-21 18:57:18 -0400] thedeeno: was looking at nodes
[2012-09-21 18:58:39 -0400] newb: I am having issues uploading databag
[2012-09-21 18:58:40 -0400] newb: https://gist.github.com/e640410d47f0b7c41166
[2012-09-21 18:59:16 -0400] thedeeno: newb: have you created the databag yet?
[2012-09-21 18:59:28 -0400] thedeeno: you need to create the data bag, THEN add a databag item to it
[2012-09-21 18:59:38 -0400] Eulipion: your path is wrong at the end, there's a '/' in bagz.json
[2012-09-21 18:59:58 -0400] newb: @thedeeno: where on http://wiki.opscode.com/display/chef/Data+Bags does it mention command to create the data bag?
[2012-09-21 19:00:31 -0400] thedeeno: newb: I don't know, but the command it: `knife data bag create BAG`
[2012-09-21 19:00:37 -0400] thedeeno: in your case
[2012-09-21 19:00:38 -0400] newb: ok
[2012-09-21 19:00:54 -0400] thedeeno: knife data bag create rtb_data_bag
[2012-09-21 19:01:04 -0400] thedeeno: once you do that you can add the data bag item from file as you're trying to do
[2012-09-21 19:01:42 -0400] thedeeno: newb: it def made me scratch my head first time around
[2012-09-21 19:01:56 -0400] chefster: Anyone care to comment on their cookbook versioning strategy? There is interest on my team in running a completely separate QA Chef server instance and I'm trying to talk people out of that plan and instead just use a single Chef server with Environments. Any real-world info on how you're handling this?
[2012-09-21 19:02:03 -0400] newb: @thedeeno: thanks you, but how you find this? I don't see it on wiki
[2012-09-21 19:02:39 -0400] thedeeno: by exploring knife's help on the command line, and trial and error. You can type `knife data bag` and see the usage.
[2012-09-21 19:02:54 -0400] thedeeno: I think I tried to knife data bag show and wasn't getting what I expected
[2012-09-21 19:03:03 -0400] thedeeno: which lead me to believe that the bag didn't exist
[2012-09-21 19:04:10 -0400] newb: @thedeeno: thank you for saving me time
[2012-09-21 19:04:30 -0400] thedeeno: you're welcome
[2012-09-21 19:05:23 -0400] chefster: Basically, are people using the "Branch tracking strategy" or the "Maximum version control strategy" listed here: http://wiki.opscode.com/display/chef/Version+Constraints  Or something else entirely?
[2012-09-21 19:06:04 -0400] kindsol: chefster: good question. versioning is a fairly new can of worms for me too.
[2012-09-21 19:15:20 -0400] yfeldblum: chefster, i would talk people *into* that plan
[2012-09-21 19:16:11 -0400] yfeldblum: chefster, environments are good for some things, but unless you actually analyze their strengths and weaknesses, you will end up using them for the wrong things and avoid using them for the right things
[2012-09-21 19:17:10 -0400] rocket: yfeldblum: are those pluses/minuses documented anywhere or is this just tribal knowledge?
[2012-09-21 19:17:48 -0400] yfeldblum: rocket, they always depend on context: strengths, *for use-case X*; weaknesses, also *for use-case X*
[2012-09-21 19:18:17 -0400] chefster: yfeldblum: any quick example of how to use them wrong? or right?
[2012-09-21 19:18:30 -0400] yfeldblum: rocket, you have to take the documented knowledge of what environments are, how they work, how you use them, what features they have, what features they don't, and then stack that up with what your actual needs are
[2012-09-21 19:18:51 -0400] bluepojo: we use environments extensively as we have many internal test environments and several production environments
[2012-09-21 19:19:07 -0400] bluepojo: I've never seen a good argument not to use them, though I'd be interested to hear one if it exists.
[2012-09-21 19:19:19 -0400] yfeldblum: chefster, you can use them in various ways: environment per application, environment per application-group, environment per team, environment per datacenter, etc
[2012-09-21 19:19:36 -0400] rocket: yfeldblum: sure that makes sense .. I was just hoping eventually some of the known .. dont do this because scenarios get written down etc
[2012-09-21 19:19:39 -0400] Randm: environments don't always work as you'd expect
[2012-09-21 19:19:41 -0400] yfeldblum: bluepojo, you should isolate your infrastructures from each other - that's a good reason
[2012-09-21 19:19:43 -0400] Randm: with all modes in puppet
[2012-09-21 19:20:01 -0400] bluepojo: isolate what infrastructure from each other?
[2012-09-21 19:20:05 -0400] Randm: at least in 2.7
[2012-09-21 19:20:13 -0400] Randm: particularly when trying to debug things
[2012-09-21 19:20:27 -0400] bluepojo: like what needs to be isolated?
[2012-09-21 19:20:35 -0400] bluepojo: yfeldblum: ^
[2012-09-21 19:20:41 -0400] yfeldblum: chefster, e.g. you can have all the lb's, web servers, db servers, cache servers, monitoring servers, etc., for a single application, all in one environment ... and have similar for another application in another environment
[2012-09-21 19:20:53 -0400] rocket: Randm: have they fixed the runstages yet so that the dependancy chaining isnt broken?
[2012-09-21 19:21:01 -0400] yfeldblum: chefster, now i'm not saying this is how you *should* do it - i'm saying this is one way you *could* do it, after proper analysis
[2012-09-21 19:21:28 -0400] chefster: yfeldblum, thanks  our chef infrastructure is just getting started so I'm was basically looking for a way to run new recipes on a few test servers before turning it loose into production.
[2012-09-21 19:21:34 -0400] yfeldblum: bluepojo, environments do not provide isolation, so all your cookbooks that use search or fetch need to be environment-aware
[2012-09-21 19:22:02 -0400] bluepojo: what's wrong with making them environment aware?
[2012-09-21 19:22:23 -0400] Randm: rocket: dunno, wasn't the anchor pattern supposed to work around that?
[2012-09-21 19:22:50 -0400] rocket: yeah its a workaround that caused me to have to touch almost every single cookbook I had
[2012-09-21 19:23:04 -0400] Randm: ah, fuck, wrong channel
[2012-09-21 19:23:05 -0400] Randm: heh
[2012-09-21 19:23:13 -0400] yfeldblum: bluepojo, take a run-of-the-mill rails or django or php application which is backed by a database: are you suggesting that every single table in that database should have a "environment" column with either a "test" or "production" value in every row, and that every query in the application should take care to filter by that "environment" column?
[2012-09-21 19:23:20 -0400] rocket: Randm: :p
[2012-09-21 19:23:43 -0400] yfeldblum: bluepojo, because that's exactly the situation with chef recipes and data-bags and environments
[2012-09-21 19:23:45 -0400] Randm: ignore anything I said about environments
[2012-09-21 19:24:09 -0400] bluepojo: chef recipes are versioned and you should version lock in your environments
[2012-09-21 19:24:18 -0400] bluepojo: data bags should not be used for anything that's environment specific
[2012-09-21 19:24:39 -0400] bluepojo: data bags are for things like ssl certs and user keys
[2012-09-21 19:25:42 -0400] bluepojo: if you're not version locking your production environments, you're in for trouble, I agree
[2012-09-21 19:25:47 -0400] bluepojo: but that's why such feature exists
[2012-09-21 19:26:29 -0400] yfeldblum: bluepojo, why should you not use data-bags for data that will differ between test and production?
[2012-09-21 19:26:42 -0400] bluepojo: cause that information should be in environment attributes
[2012-09-21 19:26:50 -0400] yfeldblum: bluepojo, why?
[2012-09-21 19:26:50 -0400] bluepojo: cause it's environment specific information
[2012-09-21 19:27:09 -0400] yfeldblum: bluepojo, that's circular
[2012-09-21 19:27:14 -0400] bluepojo: no, it's not
[2012-09-21 19:27:25 -0400] rocket: I can tag a databag with an environment attribute and make my cookbook look that up ..
[2012-09-21 19:28:02 -0400] yfeldblum: rocket, you can, but take a look at my comment above about database-backed applications
[2012-09-21 19:28:05 -0400] bluepojo: the one exception I see are encrypted databags
[2012-09-21 19:28:14 -0400] bluepojo: cause there's no such thing as encrypted environment attributes
[2012-09-21 19:28:29 -0400] bluepojo: in that case you may need to key your data with the environment name
[2012-09-21 19:28:37 -0400] bluepojo: but it doesn't mean you should not use environments
[2012-09-21 19:28:54 -0400] yfeldblum: bluepojo, you can absolutely use encrypted environment attributes
[2012-09-21 19:29:21 -0400] bluepojo: well, you'd have to manually encrypt and decrypt them
[2012-09-21 19:29:36 -0400] bluepojo: which is problematic if you change your secret key
[2012-09-21 19:30:02 -0400] bluepojo: but sure, that might be a better solution
[2012-09-21 19:30:13 -0400] bluepojo: and further argument that environments should be used more often than not :)
[2012-09-21 19:30:23 -0400] bluepojo: and that there still is no strong argument for not
[2012-09-21 19:30:28 -0400] yfeldblum: bluepojo, it's exactly as problematic, no more and no less, as encrypted data-bags
[2012-09-21 19:30:47 -0400] bluepojo: it's more problematic cause you are not keeping your encrypted data in one place
[2012-09-21 19:30:57 -0400] bluepojo: and so you have to maintain a list of what keys need to be updated with the new key somewhere
[2012-09-21 19:30:59 -0400] yfeldblum: bluepojo, you can't keep all your data in one place
[2012-09-21 19:31:03 -0400] bluepojo: across all your environments
[2012-09-21 19:31:04 -0400] rocket: yfeldblum: I was thinking of a more macular use of databags .. I was thinking of using them to control which database to connect to based on environment variable in the databag etc...
[2012-09-21 19:31:32 -0400] yfeldblum: rocket, macular?
[2012-09-21 19:31:52 -0400] bluepojo: muscular. /flex
[2012-09-21 19:32:14 -0400] yfeldblum: rocket, absolutely
[2012-09-21 19:33:48 -0400] chefster: yfeldblum: so you're advocating/suggesting running a completely separate chef server for development, right?
[2012-09-21 19:34:55 -0400] chefster: our thought was to have a "chef qa" server and it always runs the latest recipes in our qa branch, while production chef server always runs latest code in master branch. No exceptions.
[2012-09-21 19:34:56 -0400] yfeldblum: chefster, yes - if you've got big desktops where you work, then i might even suggest everybody writing cookbooks runs his own chef-server and multiple VMs as his own personal dev environment
[2012-09-21 19:35:53 -0400] jespada: cookbook to setup rebar, anyone ?
[2012-09-21 19:35:54 -0400] chefster: yfeldblum: I started heading that direction yesterday. Might finally justify having 16GB of RAM on my machine ;)
[2012-09-21 19:36:47 -0400] yfeldblum: chefster, 8 - 2 = 6, so just substitute the 6 for a 2 and 8 ... 128GB :P
[2012-09-21 19:37:25 -0400] yfeldblum: chefster, the reason is that enables multiple devs to work independently without stepping on each other's toes
[2012-09-21 19:37:58 -0400] yfeldblum: chefster, and you can also set up a whole infrastructure just for QA, with its own set of servers and its own config-mgmt database (i.e., it's own chef-server)
[2012-09-21 19:38:10 -0400] yfeldblum: chefster, and a whole infrastructure for production, isolated
[2012-09-21 19:38:31 -0400] yfeldblum: chefster, and a whole isolated infrastructure for any ABC or XYZ that crosses your desk
[2012-09-21 19:39:10 -0400] chefster: yfeldblum, I think i'll probably setup a dev chef-server and qa chef-server. Too much work right now to get everyone's dev desktops running all the pieces that is, until I convince people to configure their desktops via Chef.
[2012-09-21 19:39:16 -0400] chefster: many thanks for the advice
[2012-09-21 19:39:30 -0400] yfeldblum: chefster, that's what Vagrant is for :P
[2012-09-21 19:39:54 -0400] yfeldblum: chefster, you can distribute to everyone a chef-server-in-a-box :P
[2012-09-21 19:40:41 -0400] chefster: yfeldblum, that part seems simple but then i also need an image for each production box I want to simulate too.
[2012-09-21 19:40:53 -0400] chefster: yfeldblum, which i guess i need anyway eventually
[2012-09-21 19:40:53 -0400] rocket: I have that via a vagrant box on my mac ..
[2012-09-21 19:41:14 -0400] yfeldblum: chefster, not necessarily
[2012-09-21 19:43:31 -0400] chefster: yfeldblum, how? well i guess that would make sense if I can go from bare OS install to fully provisioned server with Chef, but we're not there yet. I'm still starting with a cloned image and building new stuff on top of that via Chef. Baby steps.
[2012-09-21 19:46:36 -0400] yfeldblum: chefster, the techniques depend on the givens
[2012-09-21 19:46:42 -0400] yfeldblum: chefster, on the particular details of each case
[2012-09-21 20:06:34 -0400] rocket: what would be the syntax in chef/ruby to compare two attributes where the second attribute may or may not be set already..
[2012-09-21 20:07:59 -0400] rocket: nevermind I found an example
[2012-09-21 20:08:15 -0400] yfeldblum: node["asdf"]["xyz"] == (node["abc"]["def"] || "hi there pardner!")
[2012-09-21 20:22:31 -0400] chefster: Trying again on this one anyone using the chef_handler LWRP to send email when a chef run on a node fails? I'm feeling very brain-dead that I can't seem to figure this one out!
[2012-09-21 20:24:17 -0400] spox: chefster: https://github.com/chrisroberts/chef-notifier
[2012-09-21 20:24:31 -0400] spox: example: https://github.com/chrisroberts/cookbook-notifier-setup
[2012-09-21 20:29:44 -0400] chefster: spox, awesome thanks  i'll give that a try. I was trying https://github.com/kisoku/chef-handler-mail and not having any luck
[2012-09-21 20:41:12 -0400] qhartman: I have an "execute" resource supposedly running as the "postgres" user, but "~" or #{ENV['HOME']} in the script or the "creates" attribute expand to the home directory of the user running chef, not the user I'm trying to run them as. Is there a way I can get that user's homedir in there instead?
[2012-09-21 20:41:57 -0400] spox: qhartman: set it using the `environment` attribute?
[2012-09-21 20:42:53 -0400] qhartman: spox, but I don't necessarily know what it is to manually set it. I need to get that information from the OS at convergence.
[2012-09-21 20:45:09 -0400] yfeldblum: qhartman, IIRC only logging in as the new user, not just switching users using Process.setuid, will change env vars like HOME
[2012-09-21 20:46:02 -0400] qhartman: yfeldblum, ok, that's what I thought, chef does not emulate a login shell when it switches users to run other processes.
[2012-09-21 20:46:17 -0400] yfeldblum: qhartman, that's right
[2012-09-21 20:47:12 -0400] qhartman: yfeldblum, so with that in mind how can I make something like "pg_home = %x{echo -n ~postgres}" happen during convergence and have pg_home available to other resources?
[2012-09-21 20:47:34 -0400] erikh: guys
[2012-09-21 20:47:37 -0400] erikh: just use the bash resource
[2012-09-21 20:47:47 -0400] qhartman: yfeldblum, as I had it, chef would always fail on the first run because when that was running during compilation the postgres user did not exist
[2012-09-21 20:47:50 -0400] erikh: (which will do things like configure the environment properly)
[2012-09-21 20:48:36 -0400] qhartman: erikh, you sure? That does not match my experience
[2012-09-21 20:48:49 -0400] erikh: pretty damned sure
[2012-09-21 20:49:14 -0400] erikh: then again, if you're assigning ruby variables with a shell out to echo, you may be seeing some oddities :)
[2012-09-21 20:50:14 -0400] qhartman: erikh, I won't need to do that if the bash shell resource will set ~ correctly.
[2012-09-21 20:51:17 -0400] spox: qhartman: how about using Etc.getpwnam('postgres').dir
[2012-09-21 20:51:39 -0400] qhartman: spox, Didn't know about that. I'll take a look.
[2012-09-21 20:52:07 -0400] JasonF: Is there a way to force a template to write immediately; like I can do with service restarts and the like?
[2012-09-21 20:52:23 -0400] JasonF: maybe action :create, :immediately in the block, like I would for that?
[2012-09-21 20:54:19 -0400] yfeldblum: JasonF, it sounds like you have a confusing problem, have latched onto a potential solution, and are asking how to do that solution (rather than asking how to solve the actual problem)
[2012-09-21 20:55:06 -0400] JasonF: I want to write a file, then in other recipes, check it to ensure things are inside of it.
[2012-09-21 20:56:37 -0400] yfeldblum: JasonF, why?
[2012-09-21 20:57:15 -0400] erikh: JasonF: t = template("/path/to/target") { source "/path/to/template"; action :nothing }; t.run_action(:create)
[2012-09-21 20:57:23 -0400] erikh: it will happen at compile time.
[2012-09-21 20:57:42 -0400] JasonF: erikh++ thanks
[2012-09-21 20:58:27 -0400] erikh: JasonF: just be sure you're doing it for the right reasons, of course.
[2012-09-21 20:58:47 -0400] erikh: if it can be done a different way with a standard converge cycle (e.g., through notifies) it's going to save you some hell later.
[2012-09-21 20:59:26 -0400] JasonF: erikh: I know, that's the way I'd prefer to go, but in this specific case I needed it at compile time. I know it's an anti-pattern in some ways
[2012-09-21 21:00:06 -0400] qhartman: erikh, the bash resource does not correctly set ~ to the homedir of the executing user, it stays set to the user running chef-client.
[2012-09-21 21:01:39 -0400] oddover: can you define and use functions inside of definitions?
[2012-09-21 21:02:02 -0400] bluepojo: oddover: definitions are essentially ruby
[2012-09-21 21:02:07 -0400] bluepojo: which means you can define methods if you need
[2012-09-21 21:02:13 -0400] oddover: that's what I thought
[2012-09-21 21:02:23 -0400] bluepojo: it's usually good practice to make a library for that purpose, howeve
[2012-09-21 21:02:24 -0400] bluepojo: however
[2012-09-21 21:02:27 -0400] bluepojo: that's what libraries are for
[2012-09-21 21:02:52 -0400] oddover: where do you put the library?
[2012-09-21 21:03:22 -0400] oddover: is it in the cookbook?
[2012-09-21 21:03:25 -0400] bluepojo: there's a folder called libraries
[2012-09-21 21:03:30 -0400] bluepojo: in the standard cookbook structure
[2012-09-21 21:03:33 -0400] bluepojo: let me find an example
[2012-09-21 21:04:32 -0400] bluepojo: https://github.com/RiotGames/nexus-cookbook/tree/master/libraries
[2012-09-21 21:04:37 -0400] bluepojo: oddover:
[2012-09-21 21:05:15 -0400] oddover: so if I do it that way, do I have to make a clasS?
[2012-09-21 21:05:17 -0400] oddover: class*
[2012-09-21 21:05:28 -0400] JasonF: erikh: so lets say I wanted to avoid that. Could I set action :nothing on the template, then send a notify to :create the template before I want to check what's inside of it?
[2012-09-21 21:06:22 -0400] bluepojo: oddover: not necessarily, but again, it's good practice so on the off chance a dependent cookbook defines the same method, you don't clobber eachother
[2012-09-21 21:06:33 -0400] oddover: ok
[2012-09-21 21:06:46 -0400] oddover: I'll give that a shot and see if it solves my problem. Thanks!
[2012-09-21 21:07:34 -0400] mhalligan: can you put per-environment attributes in a role, or do those have to be inside of an environment  definition?
[2012-09-21 21:08:21 -0400] holoway: mhalligan: it's an open namespace, so you could just use the environment name as a key inside the roles attributes
[2012-09-21 21:08:35 -0400] holoway: but when I find myself doing that, it usually means I've structured something wrong
[2012-09-21 21:09:18 -0400] bluepojo: erikh, JasonF: This also works https://gist.github.com/3763909
[2012-09-21 21:09:50 -0400] mhalligan: holoway: if I used env as a key, then I'd need to modify references to it though, right?
[2012-09-21 21:09:55 -0400] oddover: bluepojo: So after I create that library, how would I use it?
[2012-09-21 21:10:01 -0400] bluepojo: just use it
[2012-09-21 21:10:05 -0400] JasonF: bluepojo: that's much prettier, ty
[2012-09-21 21:10:08 -0400] bluepojo: chef requires files inside libraries
[2012-09-21 21:10:24 -0400] bluepojo: so it should be available
[2012-09-21 21:10:32 -0400] JasonF: erikh + bluepojo: my only concern is that at "compile time" when that runs, will all my variables already be calculated out for me?
[2012-09-21 21:10:40 -0400] bluepojo: that depends
[2012-09-21 21:11:03 -0400] bluepojo: if you need an attribute to be available, make sure include_attribute is called before the resource
[2012-09-21 21:11:10 -0400] bluepojo: I mean an attribute from another file
[2012-09-21 21:11:36 -0400] bluepojo: err
[2012-09-21 21:11:39 -0400] bluepojo: another cookbook
[2012-09-21 21:11:40 -0400] bluepojo: :P
[2012-09-21 21:12:23 -0400] bluepojo: I believe attributes are read before recipes, so you should be fine if the attributes are in the same cookbook
[2012-09-21 21:12:25 -0400] JasonF: bluepojo: in recipe A, I'm setting node[:lol][:array] to something, in recipe B, I wanna use node[:lol][:array] in a template that I need for a line later on in recipe a
[2012-09-21 21:12:34 -0400] JasonF: bluepojo: in this case; we're talking about two recipes in the same cookbook
[2012-09-21 21:13:01 -0400] mhalligan: hem, to do this I need to use ruby for my roles and not json
[2012-09-21 21:13:07 -0400] bluepojo: you may want to call include_recipe "A" inside B to assure it runs first
[2012-09-21 21:13:15 -0400] bluepojo: and then put recipe[B] on your runlist
[2012-09-21 21:13:57 -0400] JasonF: so include_recipe guarantees ordering at compile time?
[2012-09-21 21:14:04 -0400] JasonF: if so, I can figure all this out easily on my own :)
[2012-09-21 21:14:26 -0400] bluepojo: I'm doubting myself right now, but I'd say it's worth a shot
[2012-09-21 21:14:37 -0400] bluepojo: put some Chef::Log.debug statements in so you can be sure
[2012-09-21 21:14:47 -0400] bluepojo: so you can make sure the correct value is set before your resource runs
[2012-09-21 21:17:32 -0400] yfeldblum: JasonF, why do you need to write the file at compile time?
[2012-09-21 21:17:45 -0400] bluepojo: yfeldblum: it's common practice for things like yum repos
[2012-09-21 21:18:14 -0400] bluepojo: that you need to assure happen before anything runs anywhere
[2012-09-21 21:21:22 -0400] JasonF: yfeldblum: bluepojo: in this case, it's a hosts file, and it has to be in place to ensure certain parts of the other recipes will work
[2012-09-21 21:30:15 -0400] caleb_: Can somebody check to see if I've followed the contribution process correctly? http://tickets.opscode.com/browse/COOK-1695
[2012-09-21 21:34:16 -0400] terbeaux: caleb_:  did you sign the thing?
[2012-09-21 21:34:20 -0400] yfeldblum: JasonF, why?
[2012-09-21 21:34:57 -0400] caleb_: terbeaux: turns out I've been on the approved contrib list since '10. I guess I've done this at least once before but obviously not often :)
[2012-09-21 21:35:25 -0400] terbeaux: then yeah, it just needs a ticket
[2012-09-21 21:35:40 -0400] terbeaux: ik think even the pull request is not needed
[2012-09-21 21:36:03 -0400] spox: caleb_: the prefer the pull req to be prefix with ticket
[2012-09-21 21:36:15 -0400] jblaine: Maybe the 3rd paste is the charm? A little help? https://gist.github.com/3758494
[2012-09-21 21:36:22 -0400] spox: caleb_: [COOK-1695] this thing there...
[2012-09-21 21:37:07 -0400] caleb_: spox: refresh. like that?
[2012-09-21 21:37:21 -0400] spox: caleb_: yep :)
[2012-09-21 21:37:44 -0400] qhartman: jblaine, looking. Not done yet, but If I were to guess so far, you probably need to define your NTP servers as override_attributes
[2012-09-21 21:38:54 -0400] oddover: bluepojo: I got it working. Thanks!
[2012-09-21 21:39:25 -0400] qhartman: jblaine, just looked at the code for the ntp cookbook and yeah, that's almost certainly what you want. Set yours as override_attributes and you should be good.
[2012-09-21 21:40:14 -0400] terbeaux: jblaine: http://wiki.opscode.com/display/chef/Attributes search for presedence
[2012-09-21 21:40:18 -0400] terbeaux: erm
[2012-09-21 21:40:20 -0400] terbeaux: precendence
[2012-09-21 21:41:20 -0400] jblaine: yeah, read that 10 times :)
[2012-09-21 21:41:33 -0400] jblaine: and I tried it as override too
[2012-09-21 21:41:41 -0400] jblaine: but will try again, perhaps I did something wrong the first time
[2012-09-21 21:41:59 -0400] jblaine: terbeaux: Thanks
[2012-09-21 22:30:35 -0400] joemiller: i'm liking the new elapsed_time tracking in chef 10.14. made a handler for some simple profling of cookbooks: https://github.com/joemiller/chef-handler-profiler
[2012-09-21 22:31:46 -0400] jtimberman: joemiller: <3
[2012-09-21 22:31:58 -0400] joemiller: jtimberman: #hugops
[2012-09-21 22:32:11 -0400] joewilliams: anyone know the chef-server API inside and out?
[2012-09-21 22:32:31 -0400] rava: joemiller: very cool, gotta hook this up to graphite
[2012-09-21 22:32:40 -0400] jtimberman: joemiller: def #hugops
[2012-09-21 22:33:08 -0400] joemiller: rava: ahh. interesting idea. at least the cookbook times
[2012-09-21 22:33:29 -0400] rava: joemiller: graph all the things!
[2012-09-21 22:36:30 -0400] yfeldblum: joewilliams, why?
[2012-09-21 22:39:21 -0400] joewilliams: yfeldblum:  I'm writing a chef-client
[2012-09-21 22:42:08 -0400] holoway: joewilliams: like a library that talks to the API, or a replacement for chef-client?
[2012-09-21 22:44:16 -0400] coderanger: joewilliams: What language are you working in?
[2012-09-21 22:44:30 -0400] JasonF: joewilliams++ That looks awesome
[2012-09-21 22:44:42 -0400] JasonF: er, I mean joemiller
[2012-09-21 22:45:34 -0400] joemiller: we've already found a couple low-hanging fruit "slow spots" in our cookbooks that we didn't expect.
[2012-09-21 22:45:44 -0400] joewilliams: holoway, coderanger  we are working on a JS chef-client
[2012-09-21 22:45:54 -0400] joewilliams: for our dashboards and stuff
[2012-09-21 22:46:13 -0400] coderanger: joewilliams: Fun :-) Easiest place to crib from is probably the Python client since it doesn't have all the non-API bits in it
[2012-09-21 22:46:27 -0400] JasonF: joemiller: As soon as we get .10.14 out, I'm going to try and get that thing installed. That thing is pretty awesome.
[2012-09-21 22:47:22 -0400] coderanger: joewilliams: http://kjur.github.com/jsrsasign/ exists, but even with that the sigs will be hard to match exactly
[2012-09-21 22:47:51 -0400] coderanger: joewilliams: Look at https://github.com/coderanger/pychef/blob/master/chef/auth.py
[2012-09-21 22:48:30 -0400] coderanger: also http://pychef.readthedocs.org/en/latest/auth.html
[2012-09-21 22:48:38 -0400] joewilliams: cool, we are using jsrsasign already
[2012-09-21 22:49:21 -0400] joewilliams: thanks code ranger this helps since my question was about how to auth correctly since I'm getting 401's right now
[2012-09-21 22:49:26 -0400] coderanger: :) I looked into this a while ago when seth and I talked about a sproutcore webui that just talked directly to a chef server
[2012-09-21 22:50:25 -0400] coderanger: joewilliams: Also if you turn the logging in mixlib-authn up to DEBUG on the server, you'll get a lot of info about what part of the auth check failed
[2012-09-21 22:50:50 -0400] joewilliams: ah neat, that'll be helpful
[2012-09-21 22:51:01 -0400] JasonF: joewilliams: open source? Github link if so?
[2012-09-21 22:51:14 -0400] JasonF: joewilliams: I know a few people here who would be interested in a js chef client.
[2012-09-21 22:51:26 -0400] rava: mainly a semantics question, but when writing a provider that has 3 steps (getting and extracting a file, installation, and finally clean up), does it make sense to break that out to mini recipes? i'm mainly just wrapping existing providers to do all of those steps
[2012-09-21 22:51:41 -0400] coderanger: Yahr, would be nice to add to the list with Python, Java, and kinda PHP
[2012-09-21 22:53:43 -0400] oddover: Hey. is there a list of all of chef's config variables somewhere?
[2012-09-21 22:53:44 -0400] joewilliams: JasonF: not yet, soon hopefully
[2012-09-21 22:53:50 -0400] joewilliams: once it works :)
[2012-09-21 22:54:04 -0400] oddover: I found Chef::Config[:backup_file_path] and I'm looking for similar ones
[2012-09-21 22:54:32 -0400] joewilliams: oddover:  there used to be a list in the chef-client source iirc
[2012-09-21 22:54:41 -0400] coderanger: oddover: https://github.com/opscode/chef/blob/master/chef/lib/chef/config.rb
[2012-09-21 22:55:10 -0400] coderanger: joewilliams: If you need any help just holler, somehow I've become a more or less full time JS dev these days
[2012-09-21 22:55:28 -0400] oddover: coderanger: That's what I thought. I don't see the one I'm looking for. I need to know how many backups it's keeping
[2012-09-21 22:55:46 -0400] coderanger: oddover: That is set per-resource
[2012-09-21 22:55:55 -0400] oddover: oh ok
[2012-09-21 22:56:04 -0400] JasonF: coderanger: where/how is that set?
[2012-09-21 22:56:17 -0400] JasonF: In our install, no backups are happening and we want to make them start happening, if possibel.
[2012-09-21 22:56:25 -0400] coderanger: https://github.com/opscode/chef/blob/master/chef/lib/chef/resource/file.rb#L45
[2012-09-21 22:56:44 -0400] coderanger: default is 5 per file (inherited to cookbook_file and template as well
[2012-09-21 22:56:51 -0400] yfeldblum: joewilliams, obviously the chef gem is a good place to start, but also the spice gem by danryan
[2012-09-21 22:57:00 -0400] JasonF: coderanger: that isn't the last 5 though -- it's max 5, right?
[2012-09-21 22:57:16 -0400] coderanger: JasonF: Not sure what you mean, its a ring buffer
[2012-09-21 22:57:29 -0400] JasonF: coderanger: i.e. the behavior we saw was the file would get backed up 5 times, then it stopped backing up (it didn't rm the oldest one and replace it with a newr one)
[2012-09-21 22:57:30 -0400] yfeldblum: joewilliams, was there a more concrete question though?
[2012-09-21 22:57:34 -0400] coderanger: yfeldblum: The chef code is pretty hard to follow on API ops since it has all the non-API operations in there too
[2012-09-21 22:57:41 -0400] coderanger: JasonF: Sounds like a bug
[2012-09-21 22:57:57 -0400] oddover: JasonF: indeed. I have it cycling my backups
[2012-09-21 22:58:14 -0400] coderanger: JasonF: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/file.rb#L239
[2012-09-21 22:58:20 -0400] JasonF: Heh. Well we're not on .10.14 yet, we're a few versions back. I'll report the issue if we see it under .10.14
[2012-09-21 22:58:20 -0400] coderanger: Code looks correct to me
[2012-09-21 22:58:22 -0400] yfeldblum: coderanger, indeed ... bad opscode!
[2012-09-21 22:58:31 -0400] coderanger: yfeldblum: Getting fixed!
[2012-09-21 22:59:20 -0400] yfeldblum: coderanger, but i've traced through the codebase plenty of times ... figuring out how the api works isn't too painful for me by now
[2012-09-21 22:59:41 -0400] coderanger: Heh, doable, but the Python or Java clients are just easier
[2012-09-21 22:59:42 -0400] dougireton: Should knife node run_list add server.example.com "role[bar]" after "role[foo]" work if the run_list already contains role[foo] and role[bar]?
[2012-09-21 22:59:55 -0400] dougireton: it doesn't seem to
[2012-09-21 23:00:19 -0400] coderanger: dougireton: Some part of the UI try to prevent adding the same role twice, not everywhere does though
[2012-09-21 23:00:23 -0400] yfeldblum: rava, providers should completely implement an abstraction, and should be depended upon by recipes, but should not themselves depend on recipes
[2012-09-21 23:00:26 -0400] coderanger: its moot since it won't do anything
[2012-09-21 23:00:46 -0400] dougireton: do I need to remove "role[bar]" and re-add?
[2012-09-21 23:01:29 -0400] coderanger: dougireton: Are you just trying to re-order them?
[2012-09-21 23:01:55 -0400] dougireton: yes
[2012-09-21 23:02:15 -0400] coderanger: Ahh, yeah, that would be one way to handle it, or just use knife exec or the API directly, or knife node edit, etc
[2012-09-21 23:02:24 -0400] dougireton: i removed and re-added
[2012-09-21 23:02:27 -0400] dougireton: it worked
[2012-09-21 23:02:29 -0400] dougireton: thanks
[2012-09-21 23:02:32 -0400] coderanger: :)
