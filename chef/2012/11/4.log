[2012-11-04 01:06:41 -0500] erkules: hoi, could it be having one of the main differences between chef and puppet is the configuration normalisation?
[2012-11-04 01:11:45 -0500] matti: erkules: "configuration normalisation"?
[2012-11-04 01:12:10 -0500] matti: erkules: You use Chef in the post-annoyance-with-Puppet stage ;]
[2012-11-04 01:14:04 -0500] erkules: matti: do you want me to see my therapist again ;)
[2012-11-04 01:15:23 -0500] erkules: matti: It is some kind of PrimaryKey for resources. I.e. you cant 'create' the same user more than one time
[2012-11-04 01:29:12 -0500] jtimberman: erkules: Chef resources are idempotent.
[2012-11-04 01:29:25 -0500] jtimberman: erkules: if a user exists with the parameters youv'e defined in the recipe, chef doesn't do anything.
[2012-11-04 01:29:48 -0500] jtimberman: if you change the uid or something, then it would change it on the system when chef runs
[2012-11-04 01:30:32 -0500] jtimberman: there's a few exceptions to idempotent resources, like "execute", "script" and "ruby_block" resources, because by their nature, chef wouldn't know how to determine the state of them, since you can use any old command or script or ruby code.
[2012-11-04 01:31:09 -0500] carlp: Greetings! I'm trying to build chef-server using omnibus and it doesn't seem to install bundler by default, could someone help guide me on how to fix this?
[2012-11-04 01:34:29 -0500] erkules: jtimberman: thx, so what happens when I define a (same) user more than one times. I.e. by using different recipes?
[2012-11-04 01:35:01 -0500] hoover_damm: erkules, you only run one
[2012-11-04 01:35:13 -0500] hoover_damm: erkules, the first rule of chef is never to name 2 resources the same name
[2012-11-04 01:35:30 -0500] erkules: hoi hoover_damm
[2012-11-04 01:35:37 -0500] hoover_damm: erkules, execute "restart nginx" do command "bob" not_if { somethingabsurd } end
[2012-11-04 01:35:51 -0500] hoover_damm: erkules, then create another resource with the same name, and a different command, a different only_if or not_if
[2012-11-04 01:35:59 -0500] hoover_damm: you can do this in shef
[2012-11-04 01:36:19 -0500] hoover_damm: erkules, basically the answer is to name your resources smarter... and use 'path' where appropriate
[2012-11-04 01:37:06 -0500] hoover_damm: template "somethingnotduplicate" do
[2012-11-04 01:37:07 -0500] erkules: hoover_damm: ok, so chef is not preventing me from doing that mistake
[2012-11-04 01:37:10 -0500] hoover_damm: path "/path/to/file"
[2012-11-04 01:37:15 -0500] hoover_damm: end
[2012-11-04 01:37:29 -0500] hoover_damm: erkules, I wish someone told me this when I worked at engineyard
[2012-11-04 01:37:39 -0500] hoover_damm: http://likens.us/third-party-facepalm.jpg
[2012-11-04 01:37:50 -0500] hoover_damm: and another day fixing it
[2012-11-04 01:37:52 -0500] erkules: rofl
[2012-11-04 01:38:09 -0500] hoover_damm: the release notes sadly for that release were not honest
[2012-11-04 01:38:25 -0500] hoover_damm: I didn't know how to stomach saying 'oops we were doing it wrong for awhile, it's fixed now... doh!'
[2012-11-04 01:38:42 -0500] hoover_damm: which made the definition usage we had
[2012-11-04 01:38:45 -0500] hoover_damm: glorious fun
[2012-11-04 01:38:54 -0500] hoover_damm: naming the same resource the same thing was super easy
[2012-11-04 01:39:38 -0500] hoover_damm: erkules, fwiw normalization to make something more palletable
[2012-11-04 01:39:58 -0500] hoover_damm: i think with something that runs your system, you should be comfortable with it.. and not have to hold back
[2012-11-04 01:43:47 -0500] erkules: hoover_damm: thx for the input
[2012-11-04 02:23:12 -0500] matti: Is there a list of providers (?) that Chef offers, like i.e. package, service etc?
[2012-11-04 02:23:28 -0500] matti: I am looking at the Wiki but can't find it.
[2012-11-04 02:29:22 -0500] hoover_damm: matti, it's there
[2012-11-04 02:29:32 -0500] hoover_damm: matti, http://wiki.opscode.com/display/chef/Resources
[2012-11-04 02:29:44 -0500] hoover_damm: matti, using the source will help expand the documentation
[2012-11-04 02:30:14 -0500] hoover_damm: matti, wip documentation i think is at http://docs.opscode.com/resource.html
[2012-11-04 02:30:42 -0500] hoover_damm: https://github.com/opscode/chef-docs
[2012-11-04 02:30:50 -0500] hoover_damm: thank you once again Opscode
[2012-11-04 02:30:51 -0500] hoover_damm: :)
[2012-11-04 02:41:37 -0500] matti: How, how did I miss that.
[2012-11-04 02:41:42 -0500] matti: Maybe becase its 3 am.
[2012-11-04 02:41:48 -0500] matti: Thanks hoover_damm
[2012-11-04 03:17:44 -0500] hoover_damm: matti, 3am does it
[2012-11-04 12:03:38 -0500] sameersegal: Hi, cookbook for ec2 ebs snapshots?
[2012-11-04 12:05:10 -0500] sameersegal: I tried using "voormedia/ec2-snapshot" (github) and tried creating snapshots manually (via ssh) but keep getting the following error No root device could be found (Exception)?
[2012-11-04 12:05:42 -0500] sameersegal: How do you mount xfs devices on ubuntu -- /dev/sdh?
[2012-11-04 13:52:20 -0500] emanuelez: hello. should i version control the .chef folder in the repo or should i add it to gitignore?
[2012-11-04 13:52:41 -0500] masterkorp: is that berkshelf stuff ?
[2012-11-04 13:53:16 -0500] emanuelez: it's the pem files and the knife.rp
[2012-11-04 13:53:35 -0500] emanuelez: it looks like stuff i don't want to version control
[2012-11-04 13:53:37 -0500] masterkorp: the knife.rb is handy
[2012-11-04 13:53:45 -0500] emanuelez: especially for security concerns
[2012-11-04 13:53:59 -0500] emanuelez: ok. so i can ignore the pem files
[2012-11-04 13:54:11 -0500] masterkorp: yeah, having the pem its not really smart
[2012-11-04 13:55:19 -0500] emanuelez: aight :) thanks
[2012-11-04 15:57:46 -0500] gyre008: how do I get chef to load a library in a cookbook ?
[2012-11-04 15:58:10 -0500] gyre008: wiki says that all cookbook libs are loaded and required automaticallybut it doesn't look like they are
[2012-11-04 15:58:11 -0500] gyre008: arrgh
[2012-11-04 16:01:08 -0500] gchristensen: on the openssh cookbook, it seems to write out my server directives in a non-determinate fashion - no particular order of the directives. this makes every chef run overwrite and restart the daemon. Is there any way to prevent that without modifying the default openssh cookbook? Or should I open a ticket and submit a PR?
[2012-11-04 16:07:47 -0500] gyre008: this is strange
[2012-11-04 16:08:19 -0500] gchristensen: https://gist.github.com/739fd9b9a2e58fbae8d4 is an example of the output, and https://gist.github.com/ff48a3307568ee875bdf is what I have in my role
[2012-11-04 16:14:10 -0500] _dumfrie-: gyre008 can you provide the error you are seeing?
[2012-11-04 16:15:21 -0500] gyre008: _dumfrie-, I actually found out that the libraries ARE loaded but my LWRP provider is just not seeing them for whatever reasonI need to use methods defined in those libraries otherwise I'm getting these: FATAL: NoMethodError: undefined method foo
[2012-11-04 16:15:47 -0500] gyre008: so the question is HOW do I make them visible to LWRPs ?
[2012-11-04 16:16:04 -0500] gyre008: I thought Chef handles this automaticallybut apparently it doesn't mm...
[2012-11-04 16:17:57 -0500] gyre008: _dumfrie-, https://gist.github.com/4012462
[2012-11-04 16:18:29 -0500] _dumfrie-: gyre008 the libraries should be made available to you. Let me take a look at your gist, one sec.
[2012-11-04 16:20:58 -0500] _dumfrie-: gyre008 can you do me a favour and show me the LWRP definition please?
[2012-11-04 16:21:08 -0500] gyre008: _dumfrie-, sure
[2012-11-04 16:21:53 -0500] gyre008: there are 2 LWRPs which are using this lib...
[2012-11-04 16:22:36 -0500] gyre008: https://gist.github.com/4012476
[2012-11-04 16:22:43 -0500] _dumfrie-: Thanks.
[2012-11-04 16:22:44 -0500] gyre008: _dumfrie-, the last gist
[2012-11-04 16:23:44 -0500] _dumfrie-: Okay, so I am seeing the resource but would be ideal to see the provider :)
[2012-11-04 16:24:02 -0500] gyre008: oksec
[2012-11-04 16:25:18 -0500] gyre008: _dumfrie-, https://gist.github.com/4012488
[2012-11-04 16:25:30 -0500] _dumfrie-: Thanks.
[2012-11-04 16:25:48 -0500] gyre008: actually I tried to return just an empty string in that library function and it throws the same errormmmaybe there really IS a problem in the provider...mm
[2012-11-04 16:26:52 -0500] gyre008: also the strange thing is that I'm not seeing any Debug Logs which should be logged from the provider as you can see in the code...
[2012-11-04 16:27:33 -0500] gchristensen: gyre008: have you defined the LWRP's cookbook as a dependency in your cookbook?
[2012-11-04 16:27:46 -0500] gchristensen: and generated your metadata
[2012-11-04 16:28:12 -0500] gyre008: gchristensen, those LWRPs ARE defined in the cookbook whose recipes I'm usingso I don't need any dependencies in this case
[2012-11-04 16:28:19 -0500] gchristensen: ah
[2012-11-04 16:28:57 -0500] gchristensen: have you tried generating the metadata and re-uploading? :) that seems to magically solve issues for me from time to time.
[2012-11-04 16:29:20 -0500] gyre008: _dumfrie-, I'm thinkingmaybe command "#{pg_psql_cmd(sql_create_database)}" is the problem ? Chef somehow can't expand it to the string returned by pg_psql_cmd(sql_create_database)} ?
[2012-11-04 16:29:29 -0500] gyre008: in the execute resource
[2012-11-04 16:29:33 -0500] _dumfrie-: gyre008 you do want to avoid using DSL methods in your Provider.
[2012-11-04 16:29:59 -0500] gyre008: _dumfrie-, such as ?
[2012-11-04 16:30:38 -0500] _dumfrie-: for example you are using the execute resource in the Provider to create a database.
[2012-11-04 16:31:37 -0500] _dumfrie-: Also if you need to you can shellout using Mixlib::Shellout which offers a sane way to run shell commands.
[2012-11-04 16:31:53 -0500] gyre008: _dumfrie-, yes..that should workaccording to the chef mailing list and some awesome people who write code like this: https://gist.github.com/d85be145f3ff824ccc07
[2012-11-04 16:32:15 -0500] gyre008: which basically allows you to use resources within LWRPs
[2012-11-04 16:32:22 -0500] gyre008: pretty awesome stuff...
[2012-11-04 16:32:53 -0500] gyre008: courtesy of yfeldblum :)
[2012-11-04 16:34:33 -0500] _dumfrie-: Sure, different approaches are always great. Can you tell me if your provider is able to confirm the PsqlHelper module has been included?
[2012-11-04 16:34:57 -0500] gyre008: I would lOVE TO AVOID execute resourcesbut pg gem install is BROKEN in omnibus chefso no proper ruby in pg handling stuff...
[2012-11-04 16:35:29 -0500] gyre008: _dumfrie-, I would like to find outbut I'm not getting any logs...
[2012-11-04 16:35:49 -0500] gyre008: Chef::Log.debug is not simply logging ANYTHING ;(
[2012-11-04 16:35:49 -0500] _dumfrie-: even when you are running the client in debug mode?
[2012-11-04 16:35:55 -0500] gyre008: even so
[2012-11-04 16:36:12 -0500] gyre008: actually
[2012-11-04 16:36:17 -0500] gyre008: thats not tre
[2012-11-04 16:36:19 -0500] gyre008: true :)
[2012-11-04 16:36:27 -0500] gyre008: it seems to be logging...
[2012-11-04 16:36:37 -0500] gyre008: ok let me see
[2012-11-04 16:37:57 -0500] gyre008: second...
[2012-11-04 16:38:39 -0500] _dumfrie-: Sure.
[2012-11-04 16:39:49 -0500] gyre008: strangenow it didn't log anythingill try to remove the cache files
[2012-11-04 16:40:23 -0500] _dumfrie-: May want to try running interactively as well via chef-shell (shef).
[2012-11-04 16:40:58 -0500] gyre008: never done that..dont know how to do that ;(
[2012-11-04 16:41:22 -0500] gyre008: why in GODs name is it NOT logging anything now ?
[2012-11-04 16:41:25 -0500] gyre008: arrrgh...
[2012-11-04 16:41:52 -0500] _dumfrie-: are you running the converge in the foreground?
[2012-11-04 16:42:36 -0500] gyre008: i running chef-client
[2012-11-04 16:42:41 -0500] gyre008: on the console
[2012-11-04 16:42:45 -0500] gyre008: I mean it is logging...
[2012-11-04 16:42:54 -0500] gyre008: but I'm talking about those logs which are in LWRPs
[2012-11-04 16:43:24 -0500] _dumfrie-: If you look at the output you should see why the LWRP is failing or at the very least a hint.
[2012-11-04 16:43:55 -0500] gyre008: let me try something...
[2012-11-04 16:44:46 -0500] gyre008: ok..cool..so it looks it is NOT require-inng those libraries...
[2012-11-04 16:44:47 -0500] gyre008: simples..
[2012-11-04 16:44:52 -0500] gyre008: let me gist you something..
[2012-11-04 16:45:25 -0500] _dumfrie-: Sure.
[2012-11-04 16:45:49 -0500] gyre008: https://gist.github.com/4012557
[2012-11-04 16:46:08 -0500] gyre008: chef is retiredly thinking that pg_psql_cmd is Chef resource..
[2012-11-04 16:46:29 -0500] gyre008: *retardedly
[2012-11-04 16:48:28 -0500] gyre008: so that makes me feel that chef is loading the lib but it's not requiring itthat's justretarded...
[2012-11-04 16:48:39 -0500] gyre008: but I might be missing out something...
[2012-11-04 16:48:40 -0500] cwj: i think thats the common error message for trying to reference an undeclared method or variable these days
[2012-11-04 16:48:54 -0500] gyre008: cwj, yeah...
[2012-11-04 16:49:08 -0500] gyre008: that's because Chef is not loading that libraryso it doesn't know that method...
[2012-11-04 16:49:13 -0500] cwj: i always include my libs inside the provider
[2012-11-04 16:49:42 -0500] gyre008: how :)
[2012-11-04 16:50:05 -0500] _dumfrie-: That's what I was hoping to see with the request of ensuring the module has been included :)
[2012-11-04 16:50:10 -0500] cwj: i namespace the library like Opscode::SomeUsefulName
[2012-11-04 16:50:17 -0500] cwj: then include Opscode::SomeUsefulName
[2012-11-04 16:50:23 -0500] cwj: e.g. https://github.com/opscode-cookbooks/aws/blob/master/providers/elastic_ip.rb
[2012-11-04 16:50:33 -0500] cwj: and https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb
[2012-11-04 16:50:33 -0500] _dumfrie-: The MySQL cookbook has a great example of what cwj is explaining.
[2012-11-04 16:51:35 -0500] gyre008: but it shouldn't be necessaryaccording to the wiki...
[2012-11-04 16:51:41 -0500] gyre008: ok let me try that now...
[2012-11-04 16:53:31 -0500] cwj: "Any libraries you include in a Cookbook will automatically be required, and available within all your Recipes, Attribute Files, Providers and Definitions."
[2012-11-04 16:53:50 -0500] cwj: i can see why that would make you think you dont need include them
[2012-11-04 16:53:59 -0500] cwj: but the next line says "What this means is that the library files will automatically be read - however you may need to do something else to actually use them, depending on their contents."
[2012-11-04 16:54:32 -0500] cwj: so it really depends on whether or not your library code is in its own module name space or what
[2012-11-04 16:56:54 -0500] gyre008: ok let me see this now...
[2012-11-04 16:57:44 -0500] gyre008: I have modified the LWRP to this: https://gist.github.com/4012557
[2012-11-04 17:00:14 -0500] gyre008: cwj, that looks to have made a differenceI'm getting another errorbut it looks like the library is now loadinggreat progressso thanks cwj and _dumfrie-
[2012-11-04 17:00:22 -0500] cwj: glad to help
[2012-11-04 17:27:07 -0500] gyre008: ok I'm getting further with this but I stumbled upon another obstaclereally strange one..it looks like not_if attribute in resources isn't doing what I was thinking it should be..mmm
[2012-11-04 17:28:13 -0500] gyre008: https://gist.github.com/4012557
[2012-11-04 17:28:58 -0500] gyre008: I thought the execute resource in the above gist will NOT BE RUN IF the not_if shell command returns false...
[2012-11-04 17:30:43 -0500] gyre008: however it would appear that not_if attribute is completely ignored and the resource is executed always...
[2012-11-04 17:32:17 -0500] gyre008: really strange
[2012-11-04 17:37:03 -0500] gyre008: the only thing I can think of is the escaping of double quotesmm
[2012-11-04 17:39:06 -0500] cwj: possibly relevant? http://stackoverflow.com/questions/8392973/understanding-chef-only-if-not-if
[2012-11-04 17:43:16 -0500] gyre008: cwj, interestingmmlet me try that :)I thought that user which is given in the execute resource is inherited by not_if commandmm
[2012-11-04 17:46:34 -0500] gyre008: cwj, brills! that workedinteresting stuff Im learning today :)
[2012-11-04 17:47:36 -0500] cwj: excellent
[2012-11-04 18:03:07 -0500] glennpratt: anyone tried running chef with bundle exec... it appears to work for the most part, but fails to create some directories silently (directory resource)
[2012-11-04 18:52:17 -0500] gyre008: why is postgresql cookbook downloading apache cookbook I will never getand bunch of other cookbooks tooit looks like it actually downloads all cookbookseven when it doesn't depend on them...
[2012-11-04 20:19:53 -0500] hoover_damm: gyre008, chef-solo?
[2012-11-04 20:20:00 -0500] gyre008: nope
[2012-11-04 20:20:01 -0500] hoover_damm: or bad dependency line?
[2012-11-04 20:20:16 -0500] gyre008: nope :) there is no dependency in that cookbook
[2012-11-04 20:20:26 -0500] gyre008: its postgresql cookbookdoesn't depend on anything
[2012-11-04 20:20:27 -0500] hoover_damm: yeah there is
[2012-11-04 20:20:28 -0500] hoover_damm: openssl
[2012-11-04 20:20:40 -0500] hoover_damm: but that shouldn't bring in that
[2012-11-04 20:21:34 -0500] hoover_damm: if you depend on the database cookbook you can bring in more
[2012-11-04 20:22:39 -0500] gyre008: i don't depend on DB cookbook and Im not using Chef cookbooks :) this is my own cookbook for postgres
[2012-11-04 20:23:30 -0500] hoover_damm: then I guess you have to start looking at yourself then
[2012-11-04 20:23:33 -0500] hoover_damm: ;)
[2012-11-04 20:30:35 -0500] siezer: Am I reading the docs wrong about how to describe platforms in test kitchen?
[2012-11-04 20:30:36 -0500] siezer: https://gist.github.com/943850e031689239f639
[2012-11-04 20:30:49 -0500] siezer: No runner available for platform: 5.8 (ArgumentError)
[2012-11-04 20:34:12 -0500] gyre008: how do I unset an attribute on node via knifeor set itI know I should do something like knife execbut I can't seem to make this thing work for one nodemm
[2012-11-04 20:35:05 -0500] siezer: gyre008 what are you trying to accomplish? In general, manually manipulating attributes outside of cookbooks/roles/environments is an antipattern
[2012-11-04 20:35:39 -0500] gyre008: siezer, I'm testing automatic attributesjust playing around with themI set some of them via recipes and way to unset them via knife
[2012-11-04 20:35:41 -0500] gyre008: simples
[2012-11-04 20:36:05 -0500] siezer: the actual answer to you question is "knife node edit"
[2012-11-04 20:36:18 -0500] siezer: followed quickly with a "dont do that"
[2012-11-04 20:36:59 -0500] siezer: automatic attributes can't be changed, since they're dynamically discovered by ohai at chef-client run time.
[2012-11-04 20:37:24 -0500] siezer: they're "facts" about your node.. things like how much memory you have, hostname, ip, etc
[2012-11-04 20:37:38 -0500] gyre008: I knowdoesn't mean i can't play with them...
[2012-11-04 20:37:52 -0500] gyre008: what if I need to set some some day
[2012-11-04 20:37:55 -0500] gyre008: want to be ready...
[2012-11-04 20:38:28 -0500] gyre008: knife search node "some_attr" returns a node which has it setbuds knife exec doesn't remove it...mm
[2012-11-04 20:39:01 -0500] siezer: for development / testing / learning.... "knife node edit thenodename
[2012-11-04 20:40:06 -0500] gyre008: so exec is useless...cool
[2012-11-04 20:40:19 -0500] gyre008: was reading through this http://wiki.opscode.com/display/chef/Knife+Exec
[2012-11-04 20:40:28 -0500] gyre008: Example of changing a 'normal' attribute using set for all nodes with a certain role via knife exec:
[2012-11-04 20:40:29 -0500] gyre008: ...
[2012-11-04 20:40:36 -0500] siezer: you could use that too
[2012-11-04 20:40:58 -0500] gyre008: :)))
[2012-11-04 20:41:04 -0500] gyre008: i couldif it worked :)
[2012-11-04 20:42:34 -0500] siezer: brb
[2012-11-04 21:39:15 -0500] jtimberman: siezer: do you have that box in your vagrant.d dir?
[2012-11-04 21:39:21 -0500] jtimberman: siezer: ~/.vagrant.d/boxes
[2012-11-04 21:43:53 -0500] siezer: yea
[2012-11-04 21:44:19 -0500] siezer: I worked around it by just renaming my locally built bento boxes to opscode-centos-5.8 ;)
[2012-11-04 21:46:21 -0500] siezer: how so I ssh into these things again?
[2012-11-04 21:47:01 -0500] gchristensen: ssh -p2222 localhost OR vagrant ssh
[2012-11-04 21:47:07 -0500] siezer: b kitchen ssh ubuntu-10.04 no workie
[2012-11-04 21:47:18 -0500] gchristensen: oh just kidding
[2012-11-04 21:47:24 -0500] siezer: hehe
[2012-11-04 21:49:44 -0500] siezer: https://gist.github.com/0149b7df13e8807b1d23
[2012-11-04 23:15:48 -0500] coderanger: Anyone around that knows the Rails and Ruby networking worlds decently?
[2012-11-04 23:15:51 -0500] coderanger: I need a consult :)
