[2012-11-11 00:58:16 -0500] pseudonymous: Does anyone have a link to an example on how to overwrite the default attributes of a recipe ? I wrote my own 'sudo' cookbook based on the official one (basically a little simpler, and to my liking), now I'd like to define a few roles where the default attributes are overwritten
[2012-11-11 01:01:13 -0500] bemu: Just set the attribute in the role, and it will be overwritten.
[2012-11-11 01:01:25 -0500] bemu: in the attributes folder.
[2012-11-11 01:04:00 -0500] pseudonymous: bemu: I guess I'm looking for a decent overview of that then, something which *isn't* the wiki itself because I've yet to read any page in there and feel wiser from it.
[2012-11-11 01:08:41 -0500] bemu: I'll link you the best documentation I know for this topic, which is the wiki: http://wiki.opscode.com/display/chef/Roles
[2012-11-11 01:09:10 -0500] bemu: Specifically, look at default_attributes
[2012-11-11 01:09:35 -0500] bemu: There are examples of usage there, or you can find examples in most public cookbooks.
[2012-11-11 01:11:09 -0500] pseudonymous: bemu, thanks, I'll struggle a little further :)
[2012-11-11 01:23:49 -0500] tolland: ive got a change to a recipe that im a little dubious about,
[2012-11-11 01:24:14 -0500] tolland: what options do i have to stage it out, say, to add some extra splay to the run times
[2012-11-11 01:24:20 -0500] tolland: but just to this recipe
[2012-11-11 01:24:28 -0500] tolland: actually, i could probably use a ruby block
[2012-11-11 01:24:55 -0500] tolland: only if random thing
[2012-11-11 01:24:57 -0500] tolland: etc
[2012-11-11 01:44:17 -0500] jmickle: hi anyone around?
[2012-11-11 01:50:46 -0500] bemu: tolland: Depending on how often you want it to run versus randomness versus how often you run chef-client.
[2012-11-11 01:51:05 -0500] bemu: You could use a data_bag or node attribute to keep state, so that it doesn't run every chef-run
[2012-11-11 01:51:22 -0500] jmickle: I am getting recipes that are failing to run in chef 10.16.2 due to the following warning
[2012-11-11 01:51:23 -0500] jmickle: `node["key"] = "value"` # Not this
[2012-11-11 01:51:24 -0500] jmickle: to:
[2012-11-11 01:51:25 -0500] jmickle: `node.set["key"] = "value"` # This
[2012-11-11 01:51:27 -0500] bemu: or you could do the same by making a hash table versus dates or times, something like that.
[2012-11-11 01:51:42 -0500] bemu: or even make it simpler and do a random.
[2012-11-11 01:51:51 -0500] jmickle: warning should not halt the recipe but for some reason it is this particular recipe is java from the community repo
[2012-11-11 01:52:12 -0500] bemu: If you want your chef run to wait a random amount of time, you can do as you said.
[2012-11-11 01:52:20 -0500] jmickle: but 10.16.2 is not recognizing when i set my attributes to node.set vs node["
[2012-11-11 01:52:25 -0500] bemu: Just really depends on what you're trying to do :)
[2012-11-11 02:34:18 -0500] pseudonymous: http://pastebin.com/jbd3La0Z -- executing "chef-solo -j roles/base.json -c solo.rb" the sudo cookbook is run and I *can* see that the sudoers.erb is applied. Yet I never get any entry allowing the 'sysadm' group to execute everything. Any ideas ?
[2012-11-11 03:25:05 -0500] sascha_d: @pseudonymous are you still stuck on this?
[2012-11-11 03:25:17 -0500] sascha_d: Some of your template needs some erb syntaxing
[2012-11-11 03:25:45 -0500] sascha_d: oh, nvm, all the code in the same pastebin. my bad.
[2012-11-11 03:42:51 -0500] pseudonymous: sascha_d yea, I am
[2012-11-11 03:43:51 -0500] sascha_d: first thing to try is run with -l debug. It will give you a bit more info
[2012-11-11 03:48:26 -0500] sascha_d: @pseudonymous possibly you've mixed up a couple of things with chef solo
[2012-11-11 03:49:38 -0500] sascha_d: you've created a role, but you've passed -j which is specifically to set node data. I believe they are evaluated a little differently.  In your solo.rb you can set a role_path as seen here: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings#ChefConfigurationSettings-rolepath
[2012-11-11 03:50:24 -0500] pseudonymous: sascha_d, and that still applies for chef-solo ?
[2012-11-11 03:50:40 -0500] sascha_d: It's more often used with chef-solo
[2012-11-11 03:51:00 -0500] sascha_d: with chef server, your roles are stored in chefserver itself so it doesn't need to be told about their whereabouts
[2012-11-11 03:52:17 -0500] sascha_d: and then chef-solo should know where to find the role; and then, in a node.json you pass in a runlist of {"run_list":[ "role[base]" ]}
[2012-11-11 03:52:35 -0500] sascha_d: The page I just linked you I have permanently bookmarked as it was very helpful when I was first using chef
[2012-11-11 03:55:41 -0500] pseudonymous: I just tried by throwing that run-list string into a file called start.json and then running "chef-solo -c solo.rb -j start.json"
[2012-11-11 03:56:19 -0500] pseudonymous: This error came of it: http://pastebin.com/9MaCExhT
[2012-11-11 03:56:59 -0500] sascha_d: something is calling .run_list_for ?
[2012-11-11 03:57:33 -0500] sascha_d: which isn't anything at all as far as I know
[2012-11-11 03:58:12 -0500] pseudonymous: http://pastebin.com/pD1GZUrW threw solo.rb and start.json together with the error into one single paste
[2012-11-11 04:00:54 -0500] sascha_d: try running it with -l debug or cat out the stack trace to see what file/line in the file it's blaming
[2012-11-11 04:04:20 -0500] pseudonymous: the output from tacking on "-l debug": http://pastebin.com/gq6gyeFT must admit it makes no sense to me, even found http://wiki.opscode.com/display/chef/Setting+the+run_list+in+JSON+during+run+time which supports the syntax you suggested.
[2012-11-11 04:12:44 -0500] sascha_d: I think something funky is happening with the json eval
[2012-11-11 04:13:02 -0500] sascha_d: http://lists.opscode.com/sympa/arc/chef/2012-09/msg00264.html
[2012-11-11 04:13:55 -0500] sascha_d: @pseudonymous you don't really need the role, you could simplify your test case by passing in all the role data as a node.json file, just don't define it as a role
[2012-11-11 04:14:03 -0500] sascha_d: let me see if I can example it for you
[2012-11-11 04:14:41 -0500] pseudonymous: I think I was disconnected, briefly, I'm back, and looking at the url
[2012-11-11 04:17:53 -0500] pseudonymous: Ok, I got the role thing working, adding "json_class": "Chef::Role" to the base.json file made things run
[2012-11-11 04:18:05 -0500] sascha_d: interesting
[2012-11-11 04:18:06 -0500] pseudonymous: oh my God how stupid  :( .. Oh well
[2012-11-11 04:18:10 -0500] sascha_d: that's odd
[2012-11-11 04:18:19 -0500] sascha_d: I was going to say, you should be able to simplify what you're doing
[2012-11-11 04:18:20 -0500] sascha_d: https://gist.github.com/a5cb2df3842e69e9cf55
[2012-11-11 04:18:29 -0500] sascha_d: that should allow you to just pass in node.json
[2012-11-11 04:18:55 -0500] pseudonymous: I'll try right now :)
[2012-11-11 04:19:16 -0500] sascha_d: truthfully I tend to write most of my roles and things in ruby because then I can write comments and do logic, neither of which I can do in josn
[2012-11-11 04:19:17 -0500] sascha_d: json
[2012-11-11 04:21:45 -0500] sascha_d: also, http://irclogger.com/.vagrant/2012-01-28
[2012-11-11 04:22:00 -0500] sascha_d: on that page someone says, "I forgot that I had another role with the same name (except in JSON) "
[2012-11-11 04:22:02 -0500] pseudonymous: It runs, but it still doesn't tack on the sysadm line .. :(
[2012-11-11 04:22:10 -0500] sascha_d: cool!  Well, we're not buggy
[2012-11-11 04:22:17 -0500] sascha_d: run it with debug, paste the debug
[2012-11-11 04:28:36 -0500] pseudonymous: http://pastebin.com/gHfwTHcy -- debug output and a summary of all the files I've messed with :)
[2012-11-11 04:30:30 -0500] pseudonymous: I know the values in cookbook/sudo/attributes/default.rb get used as I did try changing "Array.new" in one of the lines to an actual array of strings and THEN I got a series of entries
[2012-11-11 04:34:24 -0500] sascha_d: I must be sleepy, that took me way too long to see the problem
[2012-11-11 04:34:30 -0500] sascha_d: you have two sets of "default" attributes
[2012-11-11 04:34:42 -0500] sascha_d: the attrs in the role need to be labeled override_attributes
[2012-11-11 04:35:55 -0500] sascha_d: although now that I think of it, they ought to merge if they are arrays and set at the same precedence level.
[2012-11-11 04:36:15 -0500] pseudonymous: Well, I think they should've had higher precedence lvl as they are externally defined
[2012-11-11 04:36:45 -0500] sascha_d: As a way to debug, in your recipe put something like "Chef::Log.debug("Checking on my group attributes: #{node['authorization']['sudo']['allow_groups']}")
[2012-11-11 04:36:48 -0500] pseudonymous: but I don't know, anyway, I just figured that part out myself right now, too. and changing default_ => override makes it work
[2012-11-11 04:37:51 -0500] pseudonymous: So everything works... :)
[2012-11-11 04:38:14 -0500] pseudonymous: Really, thanks so darned much for walking through this pile of .. well.. mess, with me :)
[2012-11-11 04:38:15 -0500] sascha_d: Also, while I don't speak for Adam, I don't think he wanted to write Chef because Puppet was too complex; I think it was actually because it wasn't flexible enough.
[2012-11-11 04:39:04 -0500] sascha_d: I personally don't find Chef un-complicated if that's any comfort. I just love it.
[2012-11-11 04:39:27 -0500] sascha_d: and I learned it from not knowing any ruby at all so I enjoy helping folks over the early hurdles
[2012-11-11 04:39:31 -0500] sascha_d: good luck!
[2012-11-11 04:39:41 -0500] pseudonymous: I love what it may promise, but man.. it's sorely lacking a "I don't really care, please lets get started guide" :)
[2012-11-11 04:39:52 -0500] pseudonymous: Thanks so much, you're a hero :P
[2012-11-11 04:40:06 -0500] sascha_d: google a bit. Some folks have blogged getting started with chef
[2012-11-11 11:53:46 -0500] Guest12495: hu
[2012-11-11 11:54:29 -0500] Guest12495: chef-expander is a zombie process in ubuntu 12.x
[2012-11-11 12:48:51 -0500] darthdeus: hey guys, i'm just starting out with using chef for my first server ... would you recommend using http://berkshelf.com/ with https://github.com/opscode-cookbooks/ or just write everything myself?
[2012-11-11 12:56:12 -0500] mikeywaites: darthdeus:  personally i think getting stuck in yourself will provide you with a much better understanding
[2012-11-11 13:01:47 -0500] darthdeus: mikeywaites: oki thanks :)
[2012-11-11 13:02:16 -0500] darthdeus: btw a dumb question, if a recipe has   default[:vim][:extra_packages] = []  in default/attributes, and i put     "vim": { "extra_packages": [ "vim-nox" ] }  under "default_attributes" in node.json, shouldn't that overwrite it?
[2012-11-11 13:02:35 -0500] darthdeus: sorry i meant in attributes/default.rb
[2012-11-11 13:03:01 -0500] darthdeus: specifically this file https://github.com/opscode-cookbooks/vim/blob/master/attributes/default.rb and i'd like to overwrite it in the node config
[2012-11-11 16:01:03 -0500] pseudonymous: I'm wondering, all that information that I can get from "ohai" is available for my recipes as well, right ? Are there any good overviews of how that maps to each other ? ohai spits out json, but I'm in ruby
[2012-11-11 16:13:39 -0500] yfeldblum: pseudonymous, ohai is a ruby library whose top-level API returns a deeply-nested hash; ohai also ships with a bin that calls that API and then essentially calls to_json on it to print out all that data in JSON form; chef calls the top-level API to get the deeply-nested hash but does not call to_json on it or use the bin at all
[2012-11-11 16:22:17 -0500] railsraider: vagrant does not create the client.rb for chef-server any idea how to fix it?
[2012-11-11 16:24:15 -0500] railsraider: the vagrant provision works fine but vagrant ssh and chef-client fails
[2012-11-11 16:37:44 -0500] darthdeus: how can i overwrite this in the node attributes? https://github.com/opscode-cookbooks/vim/blob/master/attributes/default.rb
[2012-11-11 16:40:40 -0500] pseudonymous: yfeldblum, cheers
[2012-11-11 16:42:07 -0500] yfeldblum: pseudonymous, the ohai data is set on the node attributes at the automatic level, which is the highest precedence level of node attributes and which cannot be overridden by roles or environments
[2012-11-11 16:42:54 -0500] yfeldblum: pseudonymous, chef does this at the start of each chef run, clearing away the automatic attributes from the previous run's call to ohai and replacing them with the result from this run's call to ohai
[2012-11-11 16:49:31 -0500] darthdeus: should i use the omnibus, or just gem install chef?
[2012-11-11 16:52:59 -0500] darthdeus: is there a way to fix the rvm bug with omnibus? because i have basically clean install of rvm
[2012-11-11 16:56:27 -0500] railsraider: i'm trying to get the nginx passenger cookbook to work, but it fails because chef is lookimh for the  module in its own ruby not the one that installed on the system
[2012-11-11 16:58:13 -0500] railsraider: http://pastie.org/5361285
[2012-11-11 17:10:26 -0500] pseudonymous: railsraider: maybe an off-hand comment, but if you're using rvm or something, consider running chef using the same version of ruby and the same gemset ?
[2012-11-11 17:10:43 -0500] railsraider: pseudonymous: not using dvm at all
[2012-11-11 17:10:49 -0500] railsraider: chef is stand alnoe
[2012-11-11 17:11:05 -0500] railsraider: and trying to get that nginx passenger to work
[2012-11-11 17:12:11 -0500] pseudonymous: but we agree that you intend to use rvm or similar to ensure that your passenger instances have a recent copy of ruby and a set of gems, right ?
[2012-11-11 17:13:13 -0500] railsraider: wasn't me
[2012-11-11 17:13:55 -0500] railsraider: i guess I'm not following
[2012-11-11 17:38:26 -0500] ssd7: Ohai CHefs
[2012-11-11 18:21:44 -0500] julian_: Hey guys, who do people go about managing users?  Do you use the user resource?  The user or users bookbooks?  I am trying to figure out best practice.
[2012-11-11 18:21:54 -0500] julian_: Er sorry "how" that is.
[2012-11-11 18:28:59 -0500] kaerast: I've started to question whether having users on servers is a good thing at all - just do all the work via Chef
[2012-11-11 18:29:17 -0500] kaerast: in reality though, I've been using the users and sudo cookbooks and putting users in databags
[2012-11-11 18:30:34 -0500] kaerast: I guess keeping your users in ldap might be another good option which I haven't explored yet
[2012-11-11 20:07:04 -0500] julian_: kaerast: Thanks for the response.
[2012-11-11 20:07:50 -0500] julian_: I have run into an issue where I am adding a user to the users databag, and to the sysadmin group but the user is not being created as expected.
[2012-11-11 20:09:08 -0500] julian_: The recipe[users::sysadmins] should create the user if it is defined as being in in the sysadmins group right?
[2012-11-11 20:12:37 -0500] kaerast: it's a while since I've fiddled with that recipe, it generally just works without need for modification on my systems
[2012-11-11 20:14:34 -0500] kaerast: though come to think of it, I did have some issues early on if some of the attributes for a user in the databag were missing
[2012-11-11 20:18:41 -0500] julian_: Ahh.
[2012-11-11 20:34:43 -0500] pseudonymous: I have a bit of a problem, I was writing a cookbook based on opscode's official ssh cookbook, the first time I ran - I actually got a file. But chef err'd out because I didn't have a "service" block even though the template block instructed chef to try and restart the service
[2012-11-11 20:35:28 -0500] pseudonymous: Now I just get no file and chef err's out with an error code of 6 while trying to start ssh. Am I guaranteed that the service block is ONLY executed once my template function has run ? because it sure doesn't seem like it atm
[2012-11-11 20:46:58 -0500] ir: Ohai chefs. I need "Resource Declaration" and "Compiled resource" to be send by custom chef handler if there was exception. How can I get it? "run_status.formatted_exception" doesn't give me this info
[2012-11-11 22:11:38 -0500] ir: I found that I need @error_descriptions but I'm not sure how to get it
[2012-11-11 22:18:23 -0500] sascha_d: I am doing some updates to our use of @fnichol's chef-rvm cookbook and wondering if anyone has tried to configure gem sets with it?
[2012-11-11 22:18:40 -0500] sascha_d: I'll pop over to rvm too and ask
[2012-11-11 22:21:05 -0500] sascha_d: pseudonymous if you're still having issues, paste your pastebin or alternatively, have a look at Notifications: wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-11-11 22:51:12 -0500] julian_: Hey guys.  I am having a weird problem.  I make a change to a databag (which I can see with the knife data bag commands) but when I do a knife search on the databag it does not show.  Any ideas?
[2012-11-11 23:12:02 -0500] warhippie: What is the max machiens anyone has seen chef scale to?
[2012-11-11 23:15:50 -0500] warhippie: <YAWN>
[2012-11-11 23:16:29 -0500] chefologist: hi, I am going through the Fast start guide, and I have a question about the structure of my environment
[2012-11-11 23:17:41 -0500] chefologist: I have multiple vagrant enviro, should I be using one of my vagrant boxes as the management workstation to deploy chef to the other vagrant boxes?  It isn't clear in the fast start guide.
[2012-11-11 23:18:45 -0500] chefologist: or do I just run chef client on all of my vagrant boxes (I want to use hosted-chef)
[2012-11-11 23:21:10 -0500] chefologist: thanks in advance > newbie here
[2012-11-11 23:21:28 -0500] red5|ryan: running your own chef server on one of the vagrant boxes sounds like a lot of unnecessary work
[2012-11-11 23:22:27 -0500] red5|ryan: if you're already pointing Vagrantfile at hosted chef just keep doing it
[2012-11-11 23:23:26 -0500] chefologist: ok I am not, so I will need to find how to do that in the opscode wiki
[2012-11-11 23:25:18 -0500] red5|ryan: http://wiki.opscode.com/display/chef/Vagrant
[2012-11-11 23:27:36 -0500] chefologist: thanks brother
[2012-11-11 23:28:11 -0500] chefologist: soooo.... in a nutshell, I use vagrantfile to control chef on my vagrant boxes?
[2012-11-11 23:28:23 -0500] red5|ryan: sort of
[2012-11-11 23:29:06 -0500] red5|ryan: I think its meant to describe the new node to virtualbox
[2012-11-11 23:29:26 -0500] red5|ryan: but its handy that you can use that to add it to the chef server in the process
[2012-11-11 23:29:34 -0500] chefologist: ok I will work on this today... cheers again
[2012-11-11 23:48:50 -0500] pseudonymous: Anyone know of any resources for adding users to a system, via **CHEF-SOLO**.. As I understand it, the opscode recipe is centred around data bags and searching those is apparently not so great in chef-solo.
[2012-11-11 23:56:22 -0500] erikh: look at the user and group resources.
[2012-11-11 23:58:58 -0500] pseudonymous: erikh: ok, I will :)
