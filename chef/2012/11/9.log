[2012-11-09 00:21:43 -0500] miah: am i reading this write, or am i confused? it looks like the lvm lwrp (https://github.com/opscode-cookbooks/lvm) has a resource callback _requiring_ you to set 'location' inside the hash as a string, but then the provider references it as a symbol.
[2012-11-09 00:22:55 -0500] miah: https://github.com/opscode-cookbooks/lvm/blob/master/resources/logical_volume.rb#L30 and https://github.com/opscode-cookbooks/lvm/blob/master/resources/logical_volume.rb#L30
[2012-11-09 00:22:58 -0500] miah: er, doh
[2012-11-09 00:23:01 -0500] miah: https://github.com/opscode-cookbooks/lvm/blob/master/providers/logical_volume.rb#L84
[2012-11-09 00:24:00 -0500] miah: lol
[2012-11-09 00:24:01 -0500] miah: http://tickets.opscode.com/browse/COOK-1857
[2012-11-09 00:25:04 -0500] forest: WITW is /usr/games/chef ??
[2012-11-09 00:25:45 -0500] chefologist: ok so I have setup 3 vagrant boxes, and now I want to use chef to install + configure apps such as postgresql, redis, ruby etc.  Any assistance would be invaluable
[2012-11-09 00:30:36 -0500] AntonZ: what would be an easiest way to set users .bash_profile settings? i need to insert a few rows of settings
[2012-11-09 00:31:50 -0500] rob___: I'm trying to bootstrap our ruby environment that uses RVM with chef. When I am running bundle via the "execute" command however they aren't showing up. Do I need to use some sort of rvm wrapper?
[2012-11-09 00:32:07 -0500] red5|ryan: chefologist: did you make a Vagrantfile? that might be easier than using knife to add the nodes to your chef server.
[2012-11-09 00:32:35 -0500] chefologist: in the first instance I want to use hosted chef
[2012-11-09 00:33:38 -0500] red5|ryan: You can point it at hosted chef. I don't have an example in front of me though...
[2012-11-09 00:34:51 -0500] rava: yfeldblum: i found the problem, there's a big differene between using -s and --secret-file ^^;
[2012-11-09 00:35:31 -0500] chefologist: my platform is ubuntu server
[2012-11-09 00:37:12 -0500] rob___: anyone using rvm with chef?
[2012-11-09 00:37:40 -0500] miah: chefologist: you should probably start here: http://wiki.opscode.com/display/chef/Chef+Basics
[2012-11-09 00:37:56 -0500] miah: and then go here: http://vagrantup.com/v1/docs/index.html
[2012-11-09 00:38:22 -0500] otterley: friends don't let friends use rvm
[2012-11-09 00:38:34 -0500] otterley: (I really should make that a macro...)
[2012-11-09 00:39:15 -0500] rava: otterley: got a write up somewhere you can point to that explains why that is?
[2012-11-09 00:39:39 -0500] rob___: yea.. rvm has proven to be a bitch but we're stuck using it now
[2012-11-09 00:40:02 -0500] otterley: well, the main reason is that rvm is centered around the shell, which makes zero sense on production hosts
[2012-11-09 00:40:32 -0500] miah: rvm is considered dangerous because it monkeypatches the shit out or your shell built-ins
[2012-11-09 00:40:36 -0500] rob___: are the cool kids using rbi these days?
[2012-11-09 00:40:40 -0500] rob___: rbx
[2012-11-09 00:40:46 -0500] miah: rbenv..
[2012-11-09 00:40:52 -0500] otterley: I like rbenv better, but I like being explicit even more
[2012-11-09 00:40:55 -0500] miah: but honestly, use what you find works best for your environment
[2012-11-09 00:41:00 -0500] rob___: rbenv
[2012-11-09 00:41:01 -0500] miah: if rvm works for you, then awesome.
[2012-11-09 00:41:23 -0500] miah: rbs is rubinus
[2012-11-09 00:41:38 -0500] otterley: trying to debug what's going on in production when rvm is involved adds unnecessary complication
[2012-11-09 00:41:38 -0500] miah: er, rbx
[2012-11-09 00:42:10 -0500] miah: very true
[2012-11-09 00:42:18 -0500] chefologist: thanks <miah>
[2012-11-09 00:42:21 -0500] miah: it can be difficult at times. but that can be said about anything.
[2012-11-09 00:42:41 -0500] miah: i used rvm for hosting rails applications. it worked fine.
[2012-11-09 00:43:10 -0500] otterley: so, um, is Solr search on Chef server completely busted?
[2012-11-09 00:43:19 -0500] otterley: I don't seem to get reliable results out of it, ever.
[2012-11-09 00:44:11 -0500] otterley: knife node show -l <node> shows attributes, but when I run knife search node "<attribute>:<value>" I get results when searching on some attributes but not others
[2012-11-09 00:44:20 -0500] otterley: any debugging tips?
[2012-11-09 00:44:26 -0500] rob___: so I should try and migrate to rbenv?
[2012-11-09 00:44:42 -0500] miah: only if rvm is creating problems for you.
[2012-11-09 00:44:59 -0500] otterley: rbenv is better IMHO, but it really shines when you change your shebangs and use Bundler for everything you deploy
[2012-11-09 00:45:00 -0500] miah: no need to change your environment because somebody on irc said you were doing it wrong
[2012-11-09 00:45:07 -0500] rafaelmagu: Does anyone have an example of Berkshelf + Vagrant integration using Chef Server?
[2012-11-09 00:45:17 -0500] rafaelmagu: I need some help setting up my Vagrantfile
[2012-11-09 00:45:26 -0500] rob___: ha.. well I'm running into problems with chef and capistrano was annoying to get working
[2012-11-09 00:45:41 -0500] rob___: we also had to update all of our corncobs to use a wrapper which was not only annoying but sometimes error prone
[2012-11-09 00:45:54 -0500] otterley: miah: rvm creates problems for everyone, eventually, in my experience.
[2012-11-09 00:47:39 -0500] rob___: ok so back to the question at hand. How can run "bundle" and it work with rvm via chef?
[2012-11-09 00:48:10 -0500] bemu: Not to be 'that' guy, but are you sure you want to do that?
[2012-11-09 00:48:39 -0500] bemu: oh, someone already said that.
[2012-11-09 00:48:40 -0500] bemu: Sorry.
[2012-11-09 00:49:15 -0500] bemu: I think the use-cases for using rvm in production are pretty rare.
[2012-11-09 00:50:14 -0500] rob___: well our environment is already using rvm just trying to port over to chef
[2012-11-09 00:58:23 -0500] jtimberman: if you don't need ruby for your application stack, then just install chef with the omnibus package, and it hides ruby away from you :)
[2012-11-09 01:07:08 -0500] rob___: well we are a rails shop so we need ruby.. hence the need for me to run bundler
[2012-11-09 01:07:13 -0500] rob___: so there is no way to do this/
[2012-11-09 01:08:27 -0500] bemu: We're suggesting you not use rvm, to examine your use case. There is certainly a way to use rvm with Chef, but none of us know, because we don't do it. For good reason.
[2012-11-09 01:08:44 -0500] bemu: at least, none of the people who have responded so far.
[2012-11-09 01:09:24 -0500] bluepojo: rob___: we use rbenv in production
[2012-11-09 01:09:29 -0500] bluepojo: and we wrote a cookbook to install it:
[2012-11-09 01:09:43 -0500] bluepojo: https://github.com/RiotGames/rbenv-cookbook
[2012-11-09 01:09:52 -0500] bluepojo: might be able to use that or do something similar for rvm
[2012-11-09 01:09:56 -0500] miah: fnichol has one too but i haven't used it recently..
[2012-11-09 01:10:11 -0500] miah: https://github.com/fnichol/chef-rbenv
[2012-11-09 01:10:21 -0500] jtimberman: i use fnichols, its fine
[2012-11-09 01:10:32 -0500] jtimberman: a little awkward to set up the attributes the first time for my per-user install stuff.
[2012-11-09 01:10:32 -0500] miah: ok. i think i hate right-aws
[2012-11-09 01:10:40 -0500] miah: telling me xvdf is invalid
[2012-11-09 01:10:42 -0500] jtimberman: but, working like a champ now :)
[2012-11-09 01:10:56 -0500] bemu: miah: sda at that level probably :/
[2012-11-09 01:11:00 -0500] bemu: sdf
[2012-11-09 01:11:10 -0500] bemu: I had the same issue.
[2012-11-09 01:12:36 -0500] jtimberman: loldevices
[2012-11-09 01:13:31 -0500] bemu: What're you working on? I have a modified version of fujin's raid provider which supports more mdadm raid levels, if that benefits you in some way.
[2012-11-09 01:14:20 -0500] bemu: basically just sets up raid 0, 1, 5, 6, 10 mdadm arrays w/ lvm
[2012-11-09 01:14:24 -0500] miah: not dealing with raid, just ebs + lvm
[2012-11-09 01:14:25 -0500] bemu: using ebs volumes.
[2012-11-09 01:14:35 -0500] bemu: kk. lvm striping?
[2012-11-09 01:14:47 -0500] miah: ya
[2012-11-09 01:14:51 -0500] bemu: For performance?
[2012-11-09 01:15:29 -0500] miah: thats beyond the point
[2012-11-09 01:15:38 -0500] bemu: Howso?
[2012-11-09 01:15:55 -0500] jtimberman: JBOD?
[2012-11-09 01:16:05 -0500] miah: my problem right now is that if i ask for the aws cookbook to create/attach a sd<x> device it gets created as a xvd<x> device.
[2012-11-09 01:16:05 -0500] bemu: Just going to let you know that I haven't had a lot of luck with performance from lvm striping.
[2012-11-09 01:16:22 -0500] bemu: miah: Yes. I experienced that as well, and just worked around it.
[2012-11-09 01:16:27 -0500] miah: ya
[2012-11-09 01:16:33 -0500] miah: i have to figure out that work around part
[2012-11-09 01:16:37 -0500] jtimberman: is it an issue in the cookbook that needs to be addressed?
[2012-11-09 01:16:44 -0500] miah: possibly
[2012-11-09 01:16:46 -0500] jtimberman: Or is it an API derp from aws?
[2012-11-09 01:16:51 -0500] miah: also possibly
[2012-11-09 01:17:00 -0500] jtimberman: If its a cookbook bug, you know what to do :)
[2012-11-09 01:17:06 -0500] miah: i hit this one earlier.. http://tickets.opscode.com/browse/COOK-1857
[2012-11-09 01:17:17 -0500] miah: if i figure out a bug in aws i'll let you know =)
[2012-11-09 01:17:35 -0500] rava: mdadm raid 0 on a set of xfs volumes has worked fairly well for me
[2012-11-09 01:17:43 -0500] miah: i need to look at the resource contents more, its possible that it gets the right details and i just need to pull them
[2012-11-09 01:17:44 -0500] bemu: https://gist.github.com/e4fe026c9597b0960afe
[2012-11-09 01:17:51 -0500] bemu: That's what I did.
[2012-11-09 01:18:18 -0500] miah: thanks
[2012-11-09 01:18:24 -0500] rava: ugh, ruby keeps segfaulting on me when trying to run foodcritic
[2012-11-09 01:18:31 -0500] miah: i've been working with aws-sdk primarily, so right-aws is making me angry.
[2012-11-09 01:18:39 -0500] bemu: yeah, it is awful.
[2012-11-09 01:18:49 -0500] miah: so i'd say thats the major bug in the aws cookbook =)
[2012-11-09 01:18:57 -0500] bemu: If we weren't moving off of aws we would be more interested in making that stuff better.
[2012-11-09 01:19:00 -0500] miah: ya
[2012-11-09 01:20:24 -0500] bemu: btw, thanks opscode, for making it possible for us to migrate out of a flooded data center to aws in less than 3 hours (1200 machines)
[2012-11-09 01:20:29 -0500] bemu: :)
[2012-11-09 01:20:30 -0500] otterley: does "chef-expanderctl log-level" actually work?
[2012-11-09 01:20:39 -0500] otterley: my logs are always empty even though I'm trying to set it to debug
[2012-11-09 01:21:27 -0500] rafaelmagu: I'm getting "'You are not allowed to take this action.' (Ridley::Errors::HTTPForbidden)" errors when trying to stand up a Vagrant box using bundle exec vagrant up (Berkshelf configured with Chef server)
[2012-11-09 01:22:15 -0500] rafaelmagu: I suspect it has something to do with client keys, but Berkshelf's documentation does not provide any help with setting the Vagrantfile up
[2012-11-09 01:22:35 -0500] rafaelmagu: Anyone encountered such a thing?
[2012-11-09 01:23:02 -0500] red5|ryan: have you tried knife on the same box with the same keys?
[2012-11-09 01:23:03 -0500] jtimberman: bemu: :D
[2012-11-09 01:23:12 -0500] jtimberman: bemu: *thats* infrastructure as code
[2012-11-09 01:23:54 -0500] bemu: same.
[2012-11-09 01:24:23 -0500] miah: rafaelmagu: make sure you expose the ports to the other vm's. also make sure the other vm's can access your validation key.
[2012-11-09 01:25:01 -0500] rafaelmagu: red5|ryan: works fine locally, works fine if I do the Vagrantfile without Berkshelf
[2012-11-09 01:25:17 -0500] rafaelmagu: miah: what ports?
[2012-11-09 01:26:02 -0500] rafaelmagu: What I'm confused about is whether "config.berkshelf.node_name" should be set to my workstation's node name or to the vagrant box's expected node name
[2012-11-09 01:35:01 -0500] miah: to the boxes expected node name..
[2012-11-09 01:37:28 -0500] rafaelmagu: That's what I did
[2012-11-09 01:37:41 -0500] rafaelmagu: I also created a new client and respective key
[2012-11-09 01:37:58 -0500] rafaelmagu: And put the path to the key in config.berkshelf.client_key
[2012-11-09 01:43:20 -0500] rafaelmagu: Ah, it seems the key needs to be my own
[2012-11-09 01:49:18 -0500] rafaelmagu: There it goes
[2012-11-09 01:49:43 -0500] rafaelmagu: Ok, so config.berkshelf.node_name and config.berkshelf.client_key need to be set to an admin node/key
[2012-11-09 01:49:55 -0500] rafaelmagu: Not the expected vagrant box's node name/key
[2012-11-09 02:39:32 -0500] johnkary: i'm using Ubuntu + the php and apache opscode cookbooks and trying to customize the php.ini that apache uses. what's my best option to do this?
[2012-11-09 02:57:22 -0500] yfeldblum: jtimberman, but everyone needs ruby!
[2012-11-09 03:05:51 -0500] siezer: anyone else having trouble sharing a cookbook with knife?
[2012-11-09 03:07:58 -0500] jtimberman: siezer: knife community release!
[2012-11-09 03:08:15 -0500] siezer: wat
[2012-11-09 03:08:22 -0500] jtimberman: mike's plugin
[2012-11-09 03:08:23 -0500] jtimberman: its cool
[2012-11-09 03:11:04 -0500] siezer: not working either
[2012-11-09 03:11:12 -0500] jtimberman: wat error are you getting?
[2012-11-09 03:12:35 -0500] siezer: https://gist.github.com/230d0a90aa1412a6908a
[2012-11-09 03:14:08 -0500] siezer: with 'knife site cookbook upload', I get ERROR: Server response: {"error_code": "AUTHENTICATION_FAILED"}
[2012-11-09 03:14:22 -0500] siezer: but I can authenticate to my hosted chef ors fine
[2012-11-09 03:14:26 -0500] siezer: orgs
[2012-11-09 03:24:34 -0500] ssd7: siezer: Still around?
[2012-11-09 03:25:03 -0500] siezer: yep
[2012-11-09 03:25:46 -0500] ssd7: I'm going to try to investigate the AUTHENTICATION_FAILED errro you were getting uploading cookbooks.  Might have something in a few minutes.  Need to poke around.
[2012-11-09 03:27:16 -0500] siezer: thanks!
[2012-11-09 03:33:34 -0500] siezer: does it work for you?
[2012-11-09 03:34:35 -0500] ssd7: Heh, well, step one of that is finding a cookbook to upload :)
[2012-11-09 04:07:55 -0500] ssd7: siezer: Well it works for me: http://community.opscode.com/cookbooks/r-project
[2012-11-09 04:08:00 -0500] siezer: hrm
[2012-11-09 04:13:21 -0500] ssd7: siezer: I don't see any obvious errors in the logs, just a 401 when we check your signature.  Your timestamps look close enough.
[2012-11-09 04:13:35 -0500] siezer: hrm
[2012-11-09 04:13:48 -0500] siezer: i can auth against orgs fine
[2012-11-09 04:23:46 -0500] jtimberman: ssd7: was that cookbook already there?
[2012-11-09 04:23:52 -0500] jtimberman: and you just uploaded a new version?
[2012-11-09 04:23:58 -0500] jtimberman: siezer: you might have to upload it through the webui first once.
[2012-11-09 04:24:10 -0500] jtimberman: M-t those
[2012-11-09 04:25:20 -0500] ssd7: jtimberman: Nope, brand new
[2012-11-09 04:25:54 -0500] ssd7: So, one thing I did notice is that the community site is getting your key from the cache
[2012-11-09 04:26:13 -0500] ssd7: and for mine it had to hit the API since this was the first time I uploaded anything
[2012-11-09 04:28:27 -0500] siezer: I do reset my key very often... just earlier too as a debugging measure
[2012-11-09 04:29:30 -0500] jtimberman: siezer: sometimes i reset your key (troll)
[2012-11-09 04:29:35 -0500] jtimberman: :D
[2012-11-09 04:30:08 -0500] siezer: (shocked)
[2012-11-09 04:31:06 -0500] ssd7: siezer: Can you try uploading again?
[2012-11-09 04:31:50 -0500] siezer: sec... I'm reinstalling my rbenv =\
[2012-11-09 04:36:58 -0500] siezer: same
[2012-11-09 05:07:18 -0500] ssd7: siezer: OK, I think I confirmed this is a cache issue
[2012-11-09 05:07:37 -0500] ssd7: well, at least I can see that the key for your user is different from what is in the cache
[2012-11-09 05:09:36 -0500] ssd7: siezer: Can you try again now?
[2012-11-09 05:14:03 -0500] siezer: it worked!
[2012-11-09 05:14:10 -0500] ssd7: NICE
[2012-11-09 05:46:10 -0500] Bretzky_: does anyone know how to add a vhost w/ vagrant/chef?
[2012-11-09 05:46:22 -0500] Bretzky_: I tried this snippet from the opscode wiki to no avail
[2012-11-09 05:46:23 -0500] Bretzky_: http://pastie.org/5349564
[2012-11-09 05:49:25 -0500] hypergrove: i am a newbiew - will chef generate an ec2 template file, or is that under the covers to chef?
[2012-11-09 05:51:32 -0500] hypergrove: what's the relatinship between chef and ec2 templates?
[2012-11-09 05:53:33 -0500] hypergrove: anyone here to answer please?
[2012-11-09 05:56:11 -0500] hypergrove: how does chef relate to ec2 templates?
[2012-11-09 05:59:48 -0500] bluepojo: hypergrove: it replaces them
[2012-11-09 05:59:53 -0500] bluepojo: they both solve the same problem
[2012-11-09 06:00:16 -0500] bluepojo: however chef is quite a bit more full featured
[2012-11-09 06:01:02 -0500] hypergrove: so ec2 templates provide function to create/cfg ec2 resources, but not the ability to cfgure the applications?
[2012-11-09 06:04:14 -0500] hypergrove: thanks bluepojo... is it true that chef can config apps, but ec2 templates won't?
[2012-11-09 06:04:49 -0500] chefologist: hi, what is the best way to setup hosted chef access on ubuntu, having trouble getting the pem file over
[2012-11-09 06:06:03 -0500] bluepojo: hypergrove: yep
[2012-11-09 06:06:14 -0500] bluepojo: chefologist: which pemfile
[2012-11-09 06:06:17 -0500] bluepojo: validation.pem?
[2012-11-09 06:07:02 -0500] chefologist: take a step back, I want my vanilla ubuntu (built with vagrant) to connect to hosted chef
[2012-11-09 06:07:17 -0500] bluepojo: aha, and what's the problem you're having?
[2012-11-09 06:07:24 -0500] bluepojo: you're using the chef-client provisioner in vagrant, right?
[2012-11-09 06:08:28 -0500] chefologist: no just got to vagrant all running sweetly, now I want to connect it to hosted-chef (as I don't want a local chef server yet)
[2012-11-09 06:08:50 -0500] bluepojo: ah ok, so you booted the server via vagrant
[2012-11-09 06:08:54 -0500] bluepojo: but you are not using a provisioner?
[2012-11-09 06:09:08 -0500] bluepojo: do you have your knife.rb configured to point to hosted chef?
[2012-11-09 06:09:18 -0500] bluepojo: or rather, are you using the knife.rb that hosted chef lets you download
[2012-11-09 06:09:33 -0500] chefologist: I have setup hosted chef, but now I want my ubuntu to connect to it
[2012-11-09 06:09:51 -0500] bluepojo: got it
[2012-11-09 06:09:53 -0500] bluepojo: read this: http://vagrantup.com/v1/docs/provisioners/chef_server.html
[2012-11-09 06:10:00 -0500] chefologist: how do I get the knife.rb down to my ubuntu server via cli
[2012-11-09 06:10:08 -0500] bluepojo: this is how you use hosted chef (or any chef server) with vagrant
[2012-11-09 06:10:30 -0500] erikh: or just use knife bootstrap
[2012-11-09 06:10:52 -0500] bluepojo: you can do that too
[2012-11-09 06:11:12 -0500] chefologist: yes, but what parameters to I enter for the Chef Server URL?
[2012-11-09 06:11:37 -0500] erikh: the same that are in your knife.rb, but you have to configure the node name as well
[2012-11-09 06:12:03 -0500] bluepojo: there's a hosted chef "Fast Start Guide" that can help you get all that stuff set up.
[2012-11-09 06:12:04 -0500] erikh: also, do you have the proper validation key on your vagrant box?
[2012-11-09 06:12:06 -0500] bluepojo: sec, I'll find a link
[2012-11-09 06:12:14 -0500] erikh: OR, you can just use knife bootstrap
[2012-11-09 06:12:17 -0500] erikh: :P
[2012-11-09 06:12:20 -0500] bluepojo: http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-11-09 06:13:01 -0500] chefologist: and how do I get the validation key down to my ubuntu server via cli?
[2012-11-09 06:13:02 -0500] bluepojo: you can use your vagrant box as the node when you follow the guide
[2012-11-09 06:13:08 -0500] bluepojo: knife bootstrap
[2012-11-09 06:13:09 -0500] bluepojo: will do that
[2012-11-09 06:13:20 -0500] bluepojo: provided you have your host machine configured properly
[2012-11-09 06:13:30 -0500] bluepojo: which the Fast Start Guide will help you get your host machine configured properly
[2012-11-09 06:13:35 -0500] bluepojo: and then get your first chef-client run
[2012-11-09 06:14:16 -0500] chefologist: ok I have vagrant + my vagrant box
[2012-11-09 06:14:32 -0500] chefologist: my vagrant box is the one I want to configure chef on
[2012-11-09 06:16:24 -0500] chefologist: a little confused
[2012-11-09 06:16:41 -0500] chefologist: following this: http://wiki.opscode.com/display/chef/Fast+Start+Guide#FastStartGuide-Step2%253AInstallChefandGit
[2012-11-09 06:17:02 -0500] bluepojo: what are you confused about in the guide?
[2012-11-09 06:17:54 -0500] chefologist: I have vagrant + 4 vagrant boxes, I want to setup 1 of the vagrant boxes for chef
[2012-11-09 06:18:07 -0500] chefologist: but it seems as though I need to configure the Vagrantfile first
[2012-11-09 06:18:18 -0500] chefologist: then provision the vagrant box later?
[2012-11-09 06:18:24 -0500] bluepojo: ok, you need to run `knife bootstrap <IP of the box you want> -r recipe[yourcookbook]
[2012-11-09 06:18:35 -0500] bluepojo: that will install chef-client on the box
[2012-11-09 06:18:40 -0500] bluepojo: and run your cookbook on it
[2012-11-09 06:19:01 -0500] bluepojo: provided you are configured to talk to your hosted chef account
[2012-11-09 06:19:03 -0500] bluepojo: it will all work
[2012-11-09 06:19:11 -0500] bluepojo: the fast start guide will get you configured
[2012-11-09 06:21:22 -0500] chefologist: knife: command not found
[2012-11-09 06:21:49 -0500] erikh: hmm
[2012-11-09 06:22:10 -0500] erikh: what does `file ~/.chef/knife.rb` do?
[2012-11-09 06:23:00 -0500] chefologist: do I need to install chef client on my ubuntu server via cli so it can talk to hosted-chef?
[2012-11-09 06:23:07 -0500] erikh: ok
[2012-11-09 06:23:27 -0500] erikh: this is how this needs to work if you want help, and I'm sorry to be so mean about it
[2012-11-09 06:23:51 -0500] erikh: but when someone asks you a question, you need to answer it. it helps them understand what you're dealing with so they can give you answers that are appropriate.
[2012-11-09 06:24:05 -0500] bluepojo: you need to install chef on your machine
[2012-11-09 06:24:12 -0500] bluepojo: gem install chef
[2012-11-09 06:24:15 -0500] bluepojo: then you will have knife
[2012-11-09 06:24:24 -0500] bluepojo: the Fast Start Guide goes over all this stuff
[2012-11-09 06:24:35 -0500] chefologist: newbie here, apologies
[2012-11-09 06:24:35 -0500] bluepojo: it explains better than I could in chat
[2012-11-09 06:24:55 -0500] chefologist: I know it does, but the guide is not clear enough
[2012-11-09 06:24:58 -0500] erikh: if you don't have knife configured though, you're going to run into different problems. which is why I asked.
[2012-11-09 06:25:06 -0500] bluepojo: The Fast Start Guide is how I learned chef originally
[2012-11-09 06:25:16 -0500] bluepojo: it has everything you need
[2012-11-09 06:25:19 -0500] bluepojo: I promise
[2012-11-09 06:25:31 -0500] chefologist: it should have a section that is easily visible that states, connect your vagrant box to hosted-chef (to be honest)
[2012-11-09 06:25:51 -0500] bluepojo: vagrant has a chef-client provisioner built in
[2012-11-09 06:26:00 -0500] bluepojo: the first link I gave you will teach you how to manage that
[2012-11-09 06:26:06 -0500] bluepojo: once you learn how to use chef without vagrant
[2012-11-09 06:26:26 -0500] bluepojo: you are probably better off with just Virtualbox until you're ready to do things the Vagrant way
[2012-11-09 06:27:36 -0500] chefologist: love vagrant, its perfect for my dev enviro
[2012-11-09 06:28:57 -0500] chefologist: just need to tweak it to get chef humming
[2012-11-09 06:29:02 -0500] chefologist: over and out thanks all
[2012-11-09 06:34:23 -0500] hypergrove: ok... following directions on http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+Windows
[2012-11-09 06:35:20 -0500] hypergrove: downloaded cech full installer, ran ok, and now trying to do "tar --version" to checkout the install, as the instructions say to do, but it is an unrecognized command.... why?
[2012-11-09 06:36:02 -0500] hypergrove: same thing with chef-client --version
[2012-11-09 06:37:03 -0500] hypergrove: hmm path not updated with chef
[2012-11-09 06:37:53 -0500] bluepojo: tar is not a windows utility, iirc
[2012-11-09 06:38:00 -0500] bluepojo: I don't use windows much, so I'm not sure
[2012-11-09 06:38:05 -0500] bluepojo: how to get chef installed
[2012-11-09 06:38:06 -0500] bluepojo: I mean
[2012-11-09 06:38:10 -0500] hypergrove: i thought chef full installer would bring it down
[2012-11-09 06:38:28 -0500] bluepojo: that's what the wiki seems to indicate
[2012-11-09 06:38:47 -0500] bluepojo: you're probably right that your path is not correct
[2012-11-09 06:39:35 -0500] hypergrove: yes, the msi did not update the path.... grrr
[2012-11-09 06:43:21 -0500] hypergrove: chef's msi process is hung while doing a "repair"
[2012-11-09 06:44:35 -0500] bluepojo: =/
[2012-11-09 06:49:08 -0500] hypergrove: actually it did update path with: ;C:\opscode\chef\bin;C:\opscode\chef\\embedded\bin; .... love the //
[2012-11-09 06:49:15 -0500] hypergrove: love the \\
[2012-11-09 06:52:06 -0500] bluepojo: I see
[2012-11-09 06:52:09 -0500] bluepojo: still can't find the bins tho?
[2012-11-09 06:57:59 -0500] rava: grateful for that discussion on rbenv earlier. decided to expirment with it and finding it much more to my liking for local dev
[2012-11-09 07:02:36 -0500] bluepojo: rbenv is less magical
[2012-11-09 07:02:42 -0500] bluepojo: install rbenv-rehash and be happier
[2012-11-09 07:02:44 -0500] bluepojo: :)
[2012-11-09 07:02:53 -0500] bluepojo: so you don't have to `rbenv rehash` after installing gems with bins
[2012-11-09 07:07:07 -0500] rava: bluepojo: ooo, thank you
[2012-11-09 07:07:24 -0500] rava: bluepojo: i was already getting tired of that
[2012-11-09 07:08:06 -0500] rava: what finally decided me was the over riding of cd
[2012-11-09 07:08:08 -0500] rava: that's just evil
[2012-11-09 07:15:26 -0500] BryanWB_: ohai chefs!
[2012-11-09 07:17:33 -0500] ssd7: Ohai!
[2012-11-09 07:17:52 -0500] siezer: *stabs rubygems in the fase*
[2012-11-09 07:23:32 -0500] BryanWB_: siezer: any takeaways from last night's hangout?
[2012-11-09 07:24:28 -0500] hypergrove: hi newbie here - need help with chef solo on windows
[2012-11-09 07:24:52 -0500] hypergrove: INFO: Client key c:/chef/client.pem is not present - registering
[2012-11-09 07:25:02 -0500] hypergrove: is this normal?
[2012-11-09 07:25:28 -0500] hypergrove: then, Chef encountered an error attempting to create the client "Laptop.domain.actdsltmp"
[2012-11-09 07:26:55 -0500] hypergrove: it doesnt like: chef_server_url  "http://CHEF-SERVER-URL:4000"
[2012-11-09 07:30:23 -0500] abetterlie: anyone here use test-kitchen recently? I have (probably) a dumb issue http://pastebin.com/4JHZbMUX
[2012-11-09 07:34:43 -0500] abetterlie: in my metadata.rb, all I have is supports 'centos' do I need a version or something ?
[2012-11-09 07:36:01 -0500] hypergrove: i'm having trouble understanding the chef-solo windows installation instructions
[2012-11-09 07:36:43 -0500] hypergrove: referencing http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+Windows
[2012-11-09 07:37:15 -0500] hypergrove: am i configuring a "Open Source Chef Server"????
[2012-11-09 07:37:35 -0500] hypergrove: if so, then it says "Change the chef_server_url when creating this file to point to your chef server and include the port if you are not using port 80."
[2012-11-09 07:37:54 -0500] hypergrove: i don't understand that instruction... help please?
[2012-11-09 07:40:29 -0500] hypergrove: what should chef_server_url 'http://CHEF-SERVER-URL:4000' be changed to for a chef-solo, please?
[2012-11-09 07:40:49 -0500] ssd7: hypergrove: For chef-solo chef_server_url doesn't matter as you don't have a server.
[2012-11-09 07:40:53 -0500] hypergrove: chef_server_url 'http://localhost:4000' ???
[2012-11-09 07:41:25 -0500] ssd7: hypergrove: Once you have Chef installed. The following article is probably more helpful: http://wiki.opscode.com/display/chef/Chef+Solo
[2012-11-09 07:41:35 -0500] hypergrove: so what should the contents of client.rb be for a chef solo
[2012-11-09 07:42:17 -0500] ssd7: hypergrove: The page I linked to has examples of solo.rb configuration files for chef-solo
[2012-11-09 07:42:40 -0500] hypergrove: on unix, i am on windows grr
[2012-11-09 07:43:34 -0500] ssd7: hypergrove: The main difference will be adjusting paths to Windows paths.
[2012-11-09 07:49:08 -0500] hypergrove: ok, i commented the line and get: [2012-11-08T23:48:08-08:00] ERROR: Connection refused connecting to localhost:4000 for /clients, retry 1/5
[2012-11-09 07:49:35 -0500] hypergrove: just prior, it said... INFO: Client key c:/chef/client.pem is not present - registering
[2012-11-09 07:49:38 -0500] ssd7: hypergrove: It appears that you are using chef-client.
[2012-11-09 07:49:47 -0500] ssd7: hypergrove: chef-solo is a seperate executable
[2012-11-09 07:50:08 -0500] hypergrove: ok, where the heck can i download that please?
[2012-11-09 07:50:23 -0500] ssd7: hypergrove: It is shipped with chef-client.  If you have chef-client, you have chef-solo
[2012-11-09 07:50:51 -0500] hypergrove: terrific i see the binary
[2012-11-09 07:51:00 -0500] ssd7: BryanWB_: So, I'm very interested in how these patterns affects Chef beginners.  They all seem very complicated to me.
[2012-11-09 07:51:29 -0500] hypergrove: there's no mention that i could find in the chef wiki about running chef-solo
[2012-11-09 07:51:42 -0500] BryanWB_: ssd7: using a library cookbook and "editing" a couple of them w/ custom values is the simplest thing that could possibly work for beginners
[2012-11-09 07:51:57 -0500] BryanWB_: s/couple of them/couple of resources/
[2012-11-09 07:52:28 -0500] BryanWB_: use data-driven templates, resources where possilbe of course
[2012-11-09 07:52:44 -0500] ssd7: BryanWB_: Except that if anything goes wrong you suddenly need deep knowledge of how chef works
[2012-11-09 07:52:45 -0500] erikh: I do that for a couple of things
[2012-11-09 07:53:03 -0500] BryanWB_: ssd7: and u need even deeper knowledge of chef and ruby to write an lwrp
[2012-11-09 07:53:15 -0500] TheSerapher: hey guys :)
[2012-11-09 07:53:39 -0500] BryanWB_: editing a resource takes minimal knowledge of chef and is even fairly intuitive, that was how I thought it worked in the first place
[2012-11-09 07:53:45 -0500] TheSerapher: I have been writing a cookbook that uses LWRPs to offer to other cookbooks, I was wondering if anyone had any experience getting these tested with ChefSpec?
[2012-11-09 07:54:28 -0500] hypergrove: ok progress!...
[2012-11-09 07:54:30 -0500] hypergrove: WARN: Did not find config file: /etc/chef/solo.rb, using command line options.
[2012-11-09 07:55:16 -0500] ssd7: BryanWB_: I also don't like that it destroys the "code as documentation" nature of well-written cookbooks since I can't look at the "foobar" cookbook and actually trust the resources I see.
[2012-11-09 07:55:41 -0500] ssd7: hypergrove: Try passing the path to your configuration file with the -c option.
[2012-11-09 07:56:22 -0500] BryanWB_: ssd7: imho a well-written "wrapper" recipe is fairly straightforward
[2012-11-09 07:56:37 -0500] BryanWB_: and easy to read, wish I had could show u an example now but gotta run
[2012-11-09 07:56:57 -0500] ssd7: BryanWB_: Perhaps.  I'm going to try a project using the pattern
[2012-11-09 07:57:08 -0500] BryanWB_: we need some examples for proper comparison
[2012-11-09 07:57:12 -0500] hypergrove: k
[2012-11-09 07:58:42 -0500] hypergrove: should the php-quick-start directory be located in c:\chef\cookbooks?
[2012-11-09 07:59:44 -0500] hypergrove: or perhaps the cookbooks directory within the php-quick-start directory?
[2012-11-09 08:01:06 -0500] ssd7: hypergrove: You'll want all your cookbooks to be directories under your cookbook path.  So if c:\chef\cookbooks is your cookbook_path, then you want c:\chef\cookbooks\php-quick-start
[2012-11-09 08:01:54 -0500] hypergrove: c:\chef\php-quick-start\cookbooks has many cookbooks in it
[2012-11-09 08:02:05 -0500] hypergrove: (or recipes!)
[2012-11-09 08:02:50 -0500] hypergrove: ok i think i see now... those are subcookbooks (or recipes!) for the php-quickstart cookbook, right?
[2012-11-09 08:02:58 -0500] Cluster444: is there a way to override the :ipaddress attribute so it uses the EIP instead of the private IP on AWS VPC nodes?
[2012-11-09 08:03:05 -0500] ssd7: hypergrove: Ahh, I see.  So, I think that is a tarball of all the cookbooks you need
[2012-11-09 08:03:20 -0500] ssd7: one sec, it has been a bit since I've look at those
[2012-11-09 08:03:34 -0500] Cluster444: or am I going to have to modify every recipe that tries to use it?
[2012-11-09 08:04:09 -0500] ssd7: Cluster444: Unfortunately, the only way to do it would be to write a custom Ohai plugin that replaces the current plugin that sets ipaddress.
[2012-11-09 08:04:39 -0500] ssd7: Well, I guess you can probably also reach into the guts of the attributes and just set it in a recipe
[2012-11-09 08:05:15 -0500] Cluster444: i've been working around it so far by adding a public_ip attribute on the nodes
[2012-11-09 08:05:32 -0500] Cluster444: but that's starting to defeat the purpose of automation :)
[2012-11-09 08:05:47 -0500] ssd7: hypergrove: OK, so you'll want to set your cookbook_path to c:\chef\php-quick-start\cookbooks
[2012-11-09 08:05:55 -0500] shay: hey guys, is there a way to get all environments in a cookbook?It would also be acceptable to define it once in a cookbook and use it in all other cookbooks- thx 4 help
[2012-11-09 08:06:22 -0500] ssd7: hypergrove: Note that this quick starts looks like it was designed for chef-client, I'm not sure how well it will work on chef-solo
[2012-11-09 08:07:29 -0500] ssd7: hypergrove: You'll want to set role_path to c:\chef\php-quick-start\roles and data_bag_path to c:\chef\php-quick-start\data_bags
[2012-11-09 08:09:09 -0500] ssd7: shay: What do you mean? Do you want a list of the environments?
[2012-11-09 08:09:47 -0500] hypergrove: cookbook_path   "c:/chef/php-quick-start/cookbooks" ...
[2012-11-09 08:10:27 -0500] ssd7: (gotta head out soon)
[2012-11-09 08:11:17 -0500] shay: ssd7: my goal is to use different templates per environment with the fallback to the default environment, like it does already exist for platforms. Now im looking for a good workaround
[2012-11-09 08:13:01 -0500] ssd7: shay: Lots of ways to skin that cat.  You could put a case state on node.chef_environment which would choose the template in your recipe.  You could just use an environment attribute that would contain the name of the desired template
[2012-11-09 08:13:27 -0500] ssd7: or you could name the template after the environment
[2012-11-09 08:15:09 -0500] shay: ssd7: i dont understand how this works, when there is no special environment for this environment?
[2012-11-09 08:17:00 -0500] shay: i mean template sry
[2012-11-09 08:19:26 -0500] hypergrove: WARN: Missing gem 'right_aws'... where do i get this
[2012-11-09 08:20:27 -0500] hypergrove: INFO: Missing gem 'mysql' ... or this?
[2012-11-09 08:32:06 -0500] masterkorp: hey chefs
[2012-11-09 08:36:52 -0500] TheSerapher: hey :)
[2012-11-09 08:40:24 -0500] hypergrove: what is "knife" please?
[2012-11-09 08:40:47 -0500] masterkorp: its used to cut stuff
[2012-11-09 08:40:50 -0500] hypergrove: i've seen it used as a verb and a noun....
[2012-11-09 08:41:23 -0500] masterkorp: never saw a as verb ?
[2012-11-09 08:41:56 -0500] hypergrove: what is its intended function?
[2012-11-09 08:42:23 -0500] masterkorp: on chef ? or the general term ?
[2012-11-09 08:43:40 -0500] hypergrove: I've not seen it used in any but chef context, so I'm not sure
[2012-11-09 08:44:25 -0500] masterkorp: what's your native language ?
[2012-11-09 08:44:31 -0500] hypergrove: english !
[2012-11-09 08:45:07 -0500] masterkorp: lol
[2012-11-09 08:45:52 -0500] masterkorp: hypergrove: TheSerapher http://en.wikipedia.org/wiki/Knife
[2012-11-09 08:46:07 -0500] rava: is there an updated chef-client cookbook that uses the omnibus installer for 10.16?
[2012-11-09 08:46:32 -0500] hypergrove: It is used by administrators to interact with the Chef Server API and the local Chef repository. It provides the capability to manipulate nodes, cookbooks, roles, databags, environments, etc., and can also be used to provision cloud resources and to bootstrap systems. ok as a noun then... really
[2012-11-09 08:47:08 -0500] hypergrove: i guess it's the interface to ec2
[2012-11-09 08:49:29 -0500] hypergrove: got it now... knife --help
[2012-11-09 08:49:47 -0500] masterkorp: hypergrove: its on the wiki
[2012-11-09 08:50:29 -0500] rava: always hate piping a curled script to be evaluated
[2012-11-09 08:51:30 -0500] rava: and..i'm dumb, just saw the download link at the bottom.
[2012-11-09 08:51:43 -0500] hypergrove: thanks... i see there's a "knife-ec2" also, but that's not in the bin dir as knife is
[2012-11-09 08:52:10 -0500] masterkorp: knife help ec2
[2012-11-09 08:52:58 -0500] hypergrove: no help found for 'ec2'
[2012-11-09 08:53:12 -0500] hypergrove: i am trying to follow the instructions at http://www.opscode.com/helpspot/guides/lamp/
[2012-11-09 08:53:13 -0500] masterkorp: how did you installed ?
[2012-11-09 08:53:50 -0500] hypergrove: solo.... the instructions say All Users: You'll need some additional gems for Knife to launch instances in Amazon EC2:
[2012-11-09 08:54:06 -0500] hypergrove: sudo gem install knife-ec2
[2012-11-09 08:54:28 -0500] hypergrove: i gather i am to create a knife.rb in the c:\chef dir
[2012-11-09 08:55:52 -0500] hypergrove: it says: Add the Amazon AWS credentials to the Knife configuration file.... ok, but i need a knife.rb file and I don't see one in the php-quick-start directory
[2012-11-09 08:57:10 -0500] rava: make one in ~/.chef
[2012-11-09 08:57:28 -0500] masterkorp: hypergrove: are you on windows ?
[2012-11-09 08:57:39 -0500] rava: http://wiki.opscode.com/display/chef/Knife
[2012-11-09 08:57:41 -0500] hypergrove: entered gem install knife-ec2 at the prompt, and it just sites
[2012-11-09 08:57:48 -0500] hypergrove: yes
[2012-11-09 08:57:59 -0500] masterkorp: good luck :p
[2012-11-09 08:58:07 -0500] rava: hahaha
[2012-11-09 08:58:14 -0500] hypergrove: oh its installing it now... great
[2012-11-09 09:12:41 -0500] rava: after reading over this chef-client recipe: https://github.com/opscode-cookbooks/chef-client , i take it it's meant to be used after a bootstrap which uses the omnibus installer?
[2012-11-09 09:13:25 -0500] rava: was looking to see if there was a recipe provided that would replace the old client if not installed with omnibus
[2012-11-09 10:08:36 -0500] hypergrove: newbie question: i am getting WARNING: No knife configuration file found... whatr do i do
[2012-11-09 10:09:19 -0500] masterkorp: create a configuration file
[2012-11-09 10:09:36 -0500] masterkorp: and/or make sure knife finds it
[2012-11-09 10:09:46 -0500] hypergrove: ok, any template I can use?
[2012-11-09 10:10:10 -0500] masterkorp: check the wiki knife page
[2012-11-09 10:10:16 -0500] hypergrove: k
[2012-11-09 10:10:42 -0500] masterkorp: knife help configure
[2012-11-09 10:10:48 -0500] masterkorp: is also handy
[2012-11-09 10:12:22 -0500] hypergrove: hmm, knife help configure says: ERROR: Errno::ENOENT: No such file or directory - man C:/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.16.2/distro/common/man/man1/knife-configure.1
[2012-11-09 10:12:58 -0500] masterkorp: good luck, i dont know shit about windows
[2012-11-09 10:47:02 -0500] hypergrove: i am trying to setup a chef-solo env, working on knife.rb... where do i find the USERNAME.pem please?
[2012-11-09 10:52:15 -0500] hypergrove: where do i find the username.pem, please
[2012-11-09 12:13:45 -0500] killfill: is it ok that http://tickets.opscode.com/browse/COOK-1820 is marked as fixed, but https://github.com/opscode-cookbooks/application/pull/22 has not been merged?
[2012-11-09 12:43:48 -0500] leifmadsen: has anyone deployed the rabbitmq cookbook? I think there is a sort of race condition with the restarts on the rabbitmq-server service happening very quickly, then trying to stop and start the service
[2012-11-09 12:44:20 -0500] leifmadsen: just a simple deploy leaves rabbitmq services stranded in the background and requires them to be killed off manually before you can start or stop the service correctly
[2012-11-09 12:48:56 -0500] Joris_: Good day all
[2012-11-09 12:51:31 -0500] Joris_: I am looking at the database cookbook, trying to provision a simple mysql db
[2012-11-09 12:51:47 -0500] Joris_: But keep on getting a mysql load error
[2012-11-09 12:52:17 -0500] Joris_: coming from the provider_database_mysql.rb
[2012-11-09 12:53:07 -0500] Joris_: any suggestions?
[2012-11-09 12:54:04 -0500] geekbri: Maybe you could gist the error?
[2012-11-09 12:55:36 -0500] Joris_: yep, will do. hold on
[2012-11-09 12:57:33 -0500] Joris_: Error is in https://gist.github.com/4045553
[2012-11-09 12:57:57 -0500] leifmadsen: missing the mysql gem it looks like
[2012-11-09 12:58:27 -0500] Joris_: that's what I thought but I installed it manually and it still fails
[2012-11-09 12:58:54 -0500] leifmadsen: are you using the chef_gem to install it though?
[2012-11-09 12:58:58 -0500] leifmadsen: chef_gem resource*
[2012-11-09 12:59:13 -0500] leifmadsen: and I thought the mysql and database cookbooks had been updated recently to do all that automatically now....
[2012-11-09 12:59:54 -0500] Joris_: When I run the following test script, it works flawlessly https://gist.github.com/4045560
[2012-11-09 13:00:19 -0500] Joris_: using the mysql cookbook to install it
[2012-11-09 13:05:11 -0500] Joris_: I upgraded the mysql cookbook as indeed I noticed there were some updates, but doesn't solve the problem
[2012-11-09 13:05:33 -0500] Joris_: Might it have something to do with ruby version (running 1.9.1 now)
[2012-11-09 13:06:52 -0500] yfeldblum: Joris_, you're probably not running 1.9.1
[2012-11-09 13:07:13 -0500] yfeldblum: Joris_, `ruby -v`
[2012-11-09 13:07:19 -0500] Joris_: ruby -v says I am
[2012-11-09 13:07:32 -0500] Joris_: not (sorry)
[2012-11-09 13:07:40 -0500] Joris_: 1.9.3
[2012-11-09 13:13:56 -0500] Joris_: the weird thing is when I run the simple mysql connect script stand alone, it works fine.
[2012-11-09 13:14:15 -0500] Joris_: Running it as part of a recipe, it fails with the LoadError (cannot load such file -- mysql)
[2012-11-09 13:14:44 -0500] yfeldblum: Joris_, what do you mean by "as part of a recipe"?
[2012-11-09 13:16:31 -0500] Joris_: I have a test ruby script loading mysql that works without a problem when I run it from the cli (https://gist.github.com/4045560)
[2012-11-09 13:16:49 -0500] Joris_: But when I include that script as part of a recipe, it fails on loading mysql
[2012-11-09 13:20:23 -0500] Joris_: And when I call the script from the recipe it works also
[2012-11-09 13:20:28 -0500] Joris_: Schiet mij maar lek
[2012-11-09 13:20:59 -0500] yfeldblum: Joris_, gist the relevant parts of the recipe?
[2012-11-09 13:22:16 -0500] Joris_: the one that fails: https://gist.github.com/4045642
[2012-11-09 13:22:36 -0500] Joris_: not a recipe, it is the standard provider_database_mysql.rb in the database cookbook
[2012-11-09 13:24:27 -0500] yfeldblum: Joris_, how did you install chef?
[2012-11-09 13:24:54 -0500] yfeldblum: Joris_, with packages? with gems? with opscode's chef-full (omnibus) installer?
[2012-11-09 13:25:24 -0500] Joris_: using omnibus
[2012-11-09 13:25:35 -0500] yfeldblum: Joris_, how did you install the mysql gem?
[2012-11-09 13:25:38 -0500] Joris_: via cloudformation - cloud-init: curl -L http://www.opscode.com/chef/install.sh | bash
[2012-11-09 13:26:04 -0500] Joris_: I was assuming the mysql gem would be installed through one of the cookbooks
[2012-11-09 13:26:18 -0500] Joris_: when it failed, I installed it manually to see if that solved it using gem
[2012-11-09 13:27:50 -0500] yfeldblum: Joris_, installing the mysql gem manually using the `gem` command will install mysql into the system ruby's gems; but chef runs with its own isolated copy of ruby, which has its own set of gems and doesn't know about any gems installed to the system ruby
[2012-11-09 13:28:00 -0500] killfill: chef-solo cannot use environments, can it?
[2012-11-09 13:28:03 -0500] yfeldblum: will install *the mysql gem* (not mysql...)
[2012-11-09 13:28:31 -0500] yfeldblum: killfill, not at present
[2012-11-09 13:28:39 -0500] leifmadsen: the failures I'm getting with rabbitmq are, I think, somewhere around the stopping of the rabbitmq service. Chef doesn't think rabbitmq is running, but if you ssh into the box after the failed chef run, you can see the service is running in the background:  https://gist.github.com/4045661
[2012-11-09 13:28:39 -0500] killfill: :S ok
[2012-11-09 13:28:47 -0500] yfeldblum: killfill, not terribly sure what they would get you ...
[2012-11-09 13:29:08 -0500] killfill: yfeldblum: me neither.. im just learning about env's and databags.. :P
[2012-11-09 13:29:15 -0500] killfill: maybe i just need data_bags..
[2012-11-09 13:29:26 -0500] yfeldblum: Joris_, so you do need to make sure that your recipe installs the mysql gem into chef's copy of ruby using `chef_gem "mysql"`
[2012-11-09 13:29:31 -0500] Joris_: yfeldblum: I think you're right, that must be the problem
[2012-11-09 13:29:35 -0500] killfill: 1 for dev and another for production or something like that (?)
[2012-11-09 13:29:41 -0500] Joris_: thanks a lot for your help guys!
[2012-11-09 13:29:46 -0500] keves: hello
[2012-11-09 13:29:54 -0500] yfeldblum: killfill, it exists, therefore i must use it?
[2012-11-09 13:30:06 -0500] killfill: heh..
[2012-11-09 13:30:32 -0500] killfill: yfeldblum: you think using a databag for prodution and another for QA is a common pattern?
[2012-11-09 13:30:45 -0500] yfeldblum: killfill, i'm sure it's a common pattern, but it's not one i would use
[2012-11-09 13:30:46 -0500] keves: say i assign a role to a node and then run chef-client. the node runs a cookbook that looks for all nodes with the role i just assigned. the new node will not be included in the search results the first time chef-client is ran
[2012-11-09 13:31:27 -0500] killfill: yfeldblum: what could you recomend me to use?.. i just need to change IP's from 1 env to another.
[2012-11-09 13:31:29 -0500] yfeldblum: keves, that's correct; but you should not expect your own node ever to be returned (or not returned) in search results anyway ...
[2012-11-09 13:31:42 -0500] yfeldblum: killfill, the node data in the node.json file
[2012-11-09 13:31:52 -0500] keves: lets say i have a role for monitoring server
[2012-11-09 13:32:00 -0500] keves: and i install some monitoring daemon to send data to this server
[2012-11-09 13:32:16 -0500] keves: it needs to know the ip to send to, and this deaemon also runs on the monitoring server itself
[2012-11-09 13:32:38 -0500] VolodymyrB: Hi, how to install chef on Linux Mint?
[2012-11-09 13:32:40 -0500] killfill: yfeldblum: i will have N nodes, and need to to do things with lets say :frontend_ip
[2012-11-09 13:33:07 -0500] masterkorp: VolodymyrB: client ?
[2012-11-09 13:33:34 -0500] yfeldblum: killfill, cool; put frontend_ip in the node.json file?
[2012-11-09 13:34:32 -0500] VolodymyrB: masterkorp: maybe, thanks, i found http://www.opscode.com/chef/install/
[2012-11-09 13:34:33 -0500] killfill: on each node.json file?
[2012-11-09 13:35:30 -0500] yfeldblum: keves, you can use `search` to search for other nodes; then you can use normal ruby code (because recipes are ruby) to pull out the data you need from the search results into an array or hash, and then to add or remove to or from the array or hash based on the current node's data
[2012-11-09 13:36:00 -0500] yfeldblum: killfill, yes; you can of course generate the node.json files if that would help
[2012-11-09 13:36:39 -0500] keves: yfeldblum, but how will i know if the current node installing this monitoring daemon is a monitoring daemon (and then it needs to 'interface' itself), or some other node and then it needs to interface the monitoring node
[2012-11-09 13:36:49 -0500] killfill: ok thanks!
[2012-11-09 13:37:17 -0500] yfeldblum: keves, inspecting the current node's attributes via the `node` method, but not inspecting the current node's attributes from the search results (because that's stale)
[2012-11-09 13:37:46 -0500] keves: so i need to have some attribute that says 'you're a monitoring node'?
[2012-11-09 13:37:50 -0500] yfeldblum: killfill, or you can use a role with that in it
[2012-11-09 13:37:56 -0500] keves: and then i'll look for that attrib and if not found, issue a search?
[2012-11-09 13:38:07 -0500] yfeldblum: keves, you could, and you could also inspect the current node's list of roles
[2012-11-09 13:38:27 -0500] yfeldblum: keves, but in general i prefer to inspect well-known attributes, and not to inspect the list of roles
[2012-11-09 13:38:27 -0500] keves: interesting
[2012-11-09 13:38:38 -0500] keves: well-known but custom, right?
[2012-11-09 13:38:58 -0500] yfeldblum: keves, so i'd prefer looking at e.g. node["is_a_monitoring_node"] rather than node.roles.include?("monitoring")
[2012-11-09 13:39:19 -0500] keves: and i can set this attribute in the role file, right?
[2012-11-09 13:39:24 -0500] yfeldblum: keves, and i'd prefer doing a search for `search(:nodes, "is_a_monitoring_node:true")`
[2012-11-09 13:39:36 -0500] keves: why not search by role?
[2012-11-09 13:40:15 -0500] yfeldblum: keves, yes you can stick it in a role, but you can also have a recipe set that
[2012-11-09 13:40:34 -0500] intinig: hello all. I manage our production boxes via chef.
[2012-11-09 13:40:43 -0500] yfeldblum: keves, because cookbooks should know about attributes but should not know about roles; roles should know about cookbooks, other roles, and attributes
[2012-11-09 13:40:57 -0500] intinig: Now I wanted to use vagrant so devs can have a dev vm that is a copy of the production box
[2012-11-09 13:40:58 -0500] keves: i see, that makes sense i guess
[2012-11-09 13:41:03 -0500] keves: thanks :)
[2012-11-09 13:41:14 -0500] yfeldblum: keves, otherwise you'll end up with a tangled mess where any given cookbook is completely inseparable from your chef-repo, instead of being standalone
[2012-11-09 13:41:19 -0500] intinig: unfortunately our setup requires an encrypted data bag
[2012-11-09 13:41:28 -0500] intinig: I usually supply that via knife to our production boxes
[2012-11-09 13:41:41 -0500] intinig: but I have no idea on how to do that via vagrant
[2012-11-09 13:41:43 -0500] intinig: any clue?
[2012-11-09 13:42:04 -0500] yfeldblum: keves, some cookbooks use the following strategy: they look at a node attribute that tells the name of a special role like `node["my_cookbook"]["monitoring_role"]`
[2012-11-09 13:42:28 -0500] yfeldblum: keves, they find out the name of the role that way, and then they can search for nodes by role, without having to know about the role upfront
[2012-11-09 13:42:42 -0500] yfeldblum: keves, it may (or may not) be easier than other techniques
[2012-11-09 13:42:57 -0500] keves: the attribute way sounds good actually
[2012-11-09 13:43:07 -0500] keves: i like it
[2012-11-09 13:43:13 -0500] yfeldblum: keves, cool, i like it too
[2012-11-09 13:43:24 -0500] keves: i'll give it a shot soon
[2012-11-09 13:43:51 -0500] yfeldblum: keves, by "well-known" i meant that one of your cookbooks defines that attribute as part of its API
[2012-11-09 13:44:00 -0500] yfeldblum: keves, and documents it in the cookbook's README.md
[2012-11-09 13:44:38 -0500] yfeldblum: keves, so that you, roles, and other cookbooks can inspect that attribute or set that attribute to control the operation of the cookbook
[2012-11-09 13:47:15 -0500] keves: yeah, it all kinda makes sense
[2012-11-09 13:51:32 -0500] yfeldblum: intinig, https://github.com/mitchellh/vagrant/blob/master/plugins/provisioners/chef/provisioner/chef_client.rb#L19-20
[2012-11-09 13:52:20 -0500] intinig: yfeldblum: thx a lot I was looking for that :)
[2012-11-09 13:52:33 -0500] yfeldblum: intinig, no probs
[2012-11-09 13:52:34 -0500] flowersj: hello
[2012-11-09 13:53:53 -0500] flowersj: question is it okay to have a run_list shared by nodes of various OSes?
[2012-11-09 13:54:17 -0500] masterkorp: flowersj: shared ? as in they have the same role ?
[2012-11-09 13:54:26 -0500] flowersj: if so what is supposed to happen if a recipe in that list says that it only supports say Windows?
[2012-11-09 13:54:30 -0500] flowersj: yes
[2012-11-09 13:54:30 -0500] yfeldblum: flowersj, if the recipes are cross-platform
[2012-11-09 13:54:37 -0500] flowersj: same role is a good example
[2012-11-09 13:54:47 -0500] yfeldblum: flowersj, not if the recipes are single-platform
[2012-11-09 13:55:00 -0500] masterkorp: flowersj: then the the chef-client should fail
[2012-11-09 13:55:05 -0500] flowersj: hmm
[2012-11-09 13:55:08 -0500] flowersj: okay
[2012-11-09 13:55:11 -0500] masterkorp: on the non windows machines
[2012-11-09 13:55:23 -0500] flowersj: so what does the supports command do?
[2012-11-09 13:55:27 -0500] flowersj: I am confused
[2012-11-09 13:55:54 -0500] flowersj: if the metadata.rb only supports Windows why would it get run on OSx?
[2012-11-09 13:56:46 -0500] yfeldblum: flowersj, that is (currently) just informational and not enforced
[2012-11-09 13:57:12 -0500] flowersj: ahh
[2012-11-09 13:57:20 -0500] flowersj: I see I missed that on the Wiki
[2012-11-09 13:57:22 -0500] flowersj: sorry
[2012-11-09 13:57:30 -0500] flowersj: should have read that closer
[2012-11-09 13:58:53 -0500] flowersj: any opinion as to whether it would be better to go with conditions on the platform in the recipes or different run_lists for different OSes?
[2012-11-09 13:59:01 -0500] masterkorp: knife search node "recipes:icinga::server"
[2012-11-09 13:59:13 -0500] masterkorp: why is this invalid ?
[2012-11-09 14:00:35 -0500] yfeldblum: flowersj, up to you; whichever is simplest for you
[2012-11-09 14:00:48 -0500] flowersj: okay
[2012-11-09 14:00:55 -0500] flowersj: thank you for the help :-)
[2012-11-09 14:00:59 -0500] yfeldblum: flowersj, personally, i might be biased towards one recipe that tests the platform and includes another platform-specific recipe
[2012-11-09 14:01:13 -0500] yfeldblum: flowersj, but that doesn't mean i'd do that every time necessarily; it would depend on the individual case
[2012-11-09 14:01:53 -0500] yfeldblum: flowersj, that would be one "interface" recipe and 5 "implementation" recipes for 5 individual platforms
[2012-11-09 14:03:11 -0500] flowersj: so the pattern is to do includes_recipe in a case statement based on the platform?
[2012-11-09 14:03:18 -0500] yfeldblum: flowersj, right
[2012-11-09 14:03:32 -0500] flowersj: okay, got it
[2012-11-09 14:03:45 -0500] yfeldblum: if node["platform"] == "windows" ; include_recipe "_install_for_windows" ; else ...
[2012-11-09 14:11:56 -0500] masterkorp: knife search node "recipes:icinga::server"
[2012-11-09 14:12:09 -0500] masterkorp: why is the syntax wrong ?
[2012-11-09 14:12:15 -0500] masterkorp: do i need to escape the ::
[2012-11-09 14:12:17 -0500] masterkorp: ?
[2012-11-09 14:12:40 -0500] yfeldblum: masterkorp, yes you need to escape literal :'s
[2012-11-09 14:13:10 -0500] _rc: masterkorp: yes http://wiki.opscode.com/display/chef/Search#Search-SpecialCharacters%3A
[2012-11-09 14:13:20 -0500] masterkorp: thank you
[2012-11-09 14:13:39 -0500] masterkorp: yfeldblum: do i need to escape them when searching from the recipe ?
[2012-11-09 14:13:49 -0500] yfeldblum: masterkorp, yes
[2012-11-09 14:14:49 -0500] masterkorp: thank you sir
[2012-11-09 14:26:21 -0500] flowersj: why does this not work?
[2012-11-09 14:26:22 -0500] flowersj: directory[~/Projects/cloudss]
[2012-11-09 14:26:50 -0500] flowersj: I get this error: Parent directory ~/Projects does not exist, cannot create ~/Projects/cloudss
[2012-11-09 14:27:22 -0500] flowersj: is ~ just a shell thing?
[2012-11-09 14:27:28 -0500] yfeldblum: flowersj, yes it's just a shell thing
[2012-11-09 14:27:35 -0500] flowersj: :-)
[2012-11-09 14:27:38 -0500] keves: hey, if my cookbook name contains a dash (-), how would i access its resources for example?
[2012-11-09 14:27:45 -0500] keves: cook-book_resource wont work obviously
[2012-11-09 14:28:37 -0500] yfeldblum: keves, rename the cookbook (yes i don't like it either)
[2012-11-09 14:28:37 -0500] _rc: keves: you can mess around with Objectsend but you're better off renaming the cookbook
[2012-11-09 14:28:51 -0500] keves: any knife rename command?
[2012-11-09 14:29:00 -0500] yfeldblum: keves, of course not
[2012-11-09 14:29:09 -0500] keves: so delete, and reupload
[2012-11-09 14:29:14 -0500] keves: i'll survive :)
[2012-11-09 14:29:14 -0500] yfeldblum: keves, right
[2012-11-09 14:51:46 -0500] masterkorp: I should create a local xen server to play with provisioning
[2012-11-09 14:52:08 -0500] gchristensen: is there a way to get chef > 10.10 on ubuntu 10.04?
[2012-11-09 14:52:49 -0500] masterkorp: onmibus installer
[2012-11-09 14:52:58 -0500] keves: can i use search inside a role file?
[2012-11-09 14:53:04 -0500] gchristensen: omnibus seems to be installing 10.8
[2012-11-09 14:53:29 -0500] masterkorp: keves: knife search role "boobs:*"
[2012-11-09 14:53:30 -0500] gchristensen: actually, it didn't seem to install chef at all...
[2012-11-09 14:53:45 -0500] keves: masterkorp, i mean call search from within the role .rb file
[2012-11-09 14:53:53 -0500] keves: to set some attributes according to the results
[2012-11-09 14:54:02 -0500] masterkorp: keves: no
[2012-11-09 14:54:23 -0500] masterkorp: Well i dont know, but you really should not do that
[2012-11-09 14:54:35 -0500] masterkorp: i use roles in json
[2012-11-09 14:55:31 -0500] keves: ill set the attribute from some cookbook that gets executed early then
[2012-11-09 14:55:45 -0500] gchristensen: masterkorp: thank you for that tip, for some reason chef 0.10.8 was installed via gems
[2012-11-09 14:56:06 -0500] masterkorp: gchristensen: weird.. and np
[2012-11-09 14:56:27 -0500] masterkorp: onimubs should have installed the debian package
[2012-11-09 14:56:43 -0500] Guest87027: ...
[2012-11-09 14:57:06 -0500] gchristensen: yeah its doing it now, but since it was already installed it didn't do that step
[2012-11-09 14:58:14 -0500] yfeldblum: keves, no, roles are purely static data
[2012-11-09 14:59:00 -0500] yfeldblum: keves, all searches and computations etc should be done in recipes; not in roles or attribute files
[2012-11-09 14:59:05 -0500] masterkorp: keves: one thing that you can do its to have logic in the attributes
[2012-11-09 14:59:27 -0500] masterkorp: you can acess role attributes at cookbook attributes set time now
[2012-11-09 15:00:50 -0500] Guest87027: Anyone know how you update a node's data on a failed bootstrap... The only node data that exsits is the name
[2012-11-09 15:05:40 -0500] yfeldblum: Guest87027, best to delete the node and the client, and start the bootstrap over
[2012-11-09 15:06:27 -0500] knuckolls: Guest87027: usually it's just the run list you want added back in. sometimes i'll do knife node run_list add <node_name> "<run_list>"
[2012-11-09 15:06:36 -0500] knuckolls: then manually start chef-client back up on the node
[2012-11-09 15:07:27 -0500] knuckolls: i keep all my run_list in roles, so it's usally as easy as knife node run_list add dev-test-kevin "role[test-kevin]"
[2012-11-09 15:07:32 -0500] knuckolls: and you're back in business
[2012-11-09 15:08:19 -0500] yfeldblum: what is up with LWRPs being the magical unicorn rainbow answer to all problems?
[2012-11-09 15:08:56 -0500] geekbri: Because they have a catchy name
[2012-11-09 15:08:58 -0500] geekbri: :)
[2012-11-09 15:09:12 -0500] knuckolls: yfeldblum: http://i1.kym-cdn.com/entries/icons/original/000/000/213/robocop-unicorn.jpg
[2012-11-09 15:09:28 -0500] geekbri: Can I get that in tshirt form
[2012-11-09 15:09:29 -0500] geekbri: ?
[2012-11-09 15:09:39 -0500] yfeldblum: lulz
[2012-11-09 15:09:50 -0500] gchristensen: is there a way to clear Chef's cache of a package's version? its trying to install an old version of an apt package. I've run apt-get update on the machine. Does it cache it elsewhere?
[2012-11-09 15:10:33 -0500] knuckolls: gchristensen: you can get apt-cache to tell you all the possible versions and which one is being preferred
[2012-11-09 15:10:44 -0500] knuckolls: just a second and i'll re-discover how
[2012-11-09 15:10:58 -0500] gchristensen: okay
[2012-11-09 15:12:30 -0500] knuckolls: well apt-cache show <package_name> will show you the versions apt thinks can be installed
[2012-11-09 15:12:57 -0500] knuckolls: there's the concept of apt pinning that lets you tell apt what packages / versions / repos you'd prefer to have it install
[2012-11-09 15:13:29 -0500] knuckolls: i have a local apt repo, that I pin with a higher priority than the standard ubuntu repos
[2012-11-09 15:13:32 -0500] Guest87027: yfeldblum: thanks
[2012-11-09 15:13:39 -0500] Guest87027: knuckrolls: thanks
[2012-11-09 15:13:42 -0500] knuckolls: gchristensen: http://jaqque.sbih.org/kplug/apt-pinning.html
[2012-11-09 15:13:49 -0500] knuckolls: maybe those two things will help you down the right path
[2012-11-09 15:25:22 -0500] masterkorp: [2012-11-09T15:24:51+00:00] INFO: HTTP Request Returned 400 Bad Request: invalid search query: 'recipes:icinga::server' Parse error at offset: 14 Reason: Expected one of \, AND, &&, OR, ||, (, NOT, ?, !, +, -, " at line 1, column 15 (byte 15) after
[2012-11-09 15:25:33 -0500] masterkorp: i am getting this problem
[2012-11-09 15:26:03 -0500] masterkorp: icinga_servers = search(:node, "recipes:icinga\:\:server")
[2012-11-09 15:26:15 -0500] masterkorp: the search line
[2012-11-09 15:26:59 -0500] yfeldblum: masterkorp, in IRB, try "\:"
[2012-11-09 15:27:22 -0500] yfeldblum: masterkorp, in IRB, try `  puts "\:"  `
[2012-11-09 15:27:28 -0500] yfeldblum: masterkorp, in IRB, and then try `  puts "\\:"  `
[2012-11-09 15:29:19 -0500] masterkorp: https://gist.github.com/4046312
[2012-11-09 15:30:39 -0500] flowersj: I am sure I am blind...
[2012-11-09 15:30:43 -0500] masterkorp: same error with using backslash on the recipe
[2012-11-09 15:30:50 -0500] flowersj: is there a resource for unzipping a file?
[2012-11-09 15:33:53 -0500] aruntomar: flowersj: afaik, there's not. you could use execute or rubyblock for the same.
[2012-11-09 15:45:05 -0500] fish_: re
[2012-11-09 15:45:28 -0500] yfeldblum: masterkorp, what does the recipe look like?
[2012-11-09 15:45:53 -0500] fish_: writing a lrwp which uses cookbook_file - but it looks like it's looking for that file only in the recipe using that lwrp - I like to use that in the cookbook where the lwrp is defined
[2012-11-09 15:47:03 -0500] yfeldblum: fish_, then specify the cookbook
[2012-11-09 15:47:45 -0500] fish_: yfeldblum: how? source "cookbook::file"?
[2012-11-09 15:48:10 -0500] yfeldblum: fish_, http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-11-09 15:48:45 -0500] fish_: yfeldblum: ah! thanks, overread that
[2012-11-09 15:49:21 -0500] keves: hm, if i override_attribute in a role file, does it only make itself available after the role has finished executing? or started executing? or immediately?
[2012-11-09 15:49:31 -0500] kryptek: good morning #chef
[2012-11-09 15:49:35 -0500] killfill: if i set default[:resolver] = '1.1.1.1' in my cookbook, how would i change it i.e. for production?..  shold i make a mycookbook_prod role, overriding the value?
[2012-11-09 15:49:49 -0500] killfill: (im using chef-solo)
[2012-11-09 15:49:51 -0500] yfeldblum: keves, roles are not executed, since they are static data and not code
[2012-11-09 15:50:27 -0500] keves: well, i placed an override_attributes() entry in a role file, and i dont see it
[2012-11-09 15:50:31 -0500] yfeldblum: killfill, you can do that; or you can set it in the node's node.json
[2012-11-09 15:50:38 -0500] madzim: In the wiki, /Chef+Client says "A single Chef Client can run recipes for multiple Nodes". Where can I read more about how to do that?
[2012-11-09 15:50:40 -0500] yfeldblum: keves, where are you looking?
[2012-11-09 15:50:43 -0500] keves: chef doesnt finish executing because it fails to find the attribute, and i cant view it on the web ui
[2012-11-09 15:50:57 -0500] masterkorp: yfeldblum: the full recipe ?
[2012-11-09 15:51:05 -0500] yfeldblum: keves, have you uploaded the role?
[2012-11-09 15:51:10 -0500] keves: i did
[2012-11-09 15:51:15 -0500] yfeldblum: masterkorp, the relevant part
[2012-11-09 15:51:21 -0500] masterkorp: yfeldblum: http://pastie.org/private/l7vq8pdnpxpsgrdkynyva
[2012-11-09 15:51:50 -0500] yfeldblum: masterkorp, "recipes:icinga\:\:server" isn't escaping
[2012-11-09 15:52:06 -0500] yfeldblum: masterkorp, ruby treats \: in a double-quoted string as a literal :
[2012-11-09 15:52:52 -0500] yfeldblum: masterkorp, if you want a string that looks like \: then you need either single-quoted string literal like this: '\:' or you need to escape the \ in a double-quoted string literal like this: "\\:"
[2012-11-09 15:52:53 -0500] keves: is it possible i dont see attributes of roles that didnt get executed yet?
[2012-11-09 15:53:13 -0500] keves: i see the actual attribute in the role view of the web ui
[2012-11-09 15:53:18 -0500] keves: but not in the node itself
[2012-11-09 15:53:49 -0500] yfeldblum: keves, chef-client only merges role attributes into the node attributes *locally* at the start of the chef-client run and only saves the changed node data to the server at the *end* of each *successful* chef-client run
[2012-11-09 15:54:06 -0500] masterkorp: yfeldblum: thanks
[2012-11-09 15:54:09 -0500] keves: hm, so how could i inspect the local roles?
[2012-11-09 15:54:14 -0500] keves: oh wait wait
[2012-11-09 15:54:20 -0500] keves: i'm an idiot, then search wont find it
[2012-11-09 15:54:24 -0500] keves: and im checking via search :)
[2012-11-09 15:54:52 -0500] madzim: In the wiki, /Chef+Client says "A single Chef Client can run recipes for multiple Nodes". Where can I read more about how to do that?
[2012-11-09 15:58:10 -0500] siezer: BryanWB_ I'm currently embared on the Yak of Ledgends
[2012-11-09 15:58:27 -0500] knuckolls: madzim: can you link to that? i can't fathom how that'd be the case unless there's some additional context
[2012-11-09 15:58:34 -0500] BryanWB_: siezer: ?? that was completely unintelligible ;)
[2012-11-09 15:58:50 -0500] knuckolls: i assume he's shaving quite a yak
[2012-11-09 15:59:04 -0500] BryanWB_: probably of legendary proportions :)
[2012-11-09 15:59:04 -0500] madzim: @knuckolls> http://wiki.opscode.com/display/chef/Chef+Client
[2012-11-09 15:59:05 -0500] yfeldblum: madzim, nowhere, really, because i'm not sure that actually works
[2012-11-09 15:59:43 -0500] knuckolls: madzim: well there it is right there at the top
[2012-11-09 16:00:12 -0500] knuckolls: madzim: i really can't fathom what that means. i've always had the idea that nodes and chef-clients were 1 to 1
[2012-11-09 16:01:42 -0500] madzim: knuckolls: I've had the same impression so I was very curious to know how that was possible. Perhaps the assumption is one can write recipes that use SSH or some other means of launch tasks on other NODES.
[2012-11-09 16:02:26 -0500] matschaffer: is there a simple command to push a whole directory of data bags and items?
[2012-11-09 16:03:00 -0500] knuckolls: madzim: i went back through the wiki history. Adam Jacob added that text on the first version of the page in 2009. i think it's just an old design decision that didn't come to fruition, but I could be completely wrong
[2012-11-09 16:03:01 -0500] knuckolls: http://wiki.opscode.com/pages/viewpage.action?pageId=2884049&navigatingVersions=true
[2012-11-09 16:04:19 -0500] madzim: bummer
[2012-11-09 16:04:23 -0500] yfeldblum: knuckolls, yes, it's an old design decision that hasn't yet come to fruition
[2012-11-09 16:06:55 -0500] madzim: so than how might one pull that off? How does one coordinate the release of a new web application across more 2 or more Application Servers behind a load balancer? Is there a way to alert Chef-Clients to do run some run-list NOW?
[2012-11-09 16:10:01 -0500] nacer: hi,
[2012-11-09 16:10:03 -0500] nacer: i'am testting kitchen with minitest, how can i inject some json attribute to the chef-solo run for my test ?
[2012-11-09 16:10:22 -0500] nacer: or simply add stuff to the run_list ?
[2012-11-09 16:10:31 -0500] knuckolls: madzim: coordination between nodes is largely unsolved in general. some people use rundeck, or azkaban. zookeeper seems like the holy grail but it's real heavy. you can use the chef server api to write code to set attributes on other node objects that the node will act upon during the next scheduled chef run. mcollective is a thing people use that i'm reaonsably unfamiliar with
[2012-11-09 16:10:38 -0500] knuckolls: stuff like that
[2012-11-09 16:11:02 -0500] knuckolls: or you just say, it'll settle out and within a minute all the nodes will be up to date
[2012-11-09 16:11:03 -0500] knuckolls: no big deal
[2012-11-09 16:11:08 -0500] matschaffer: nacer: that's in a Vagrantfile isn't it? http://vagrantup.com/v1/docs/provisioners/chef_solo.html shows using chef.json = {  }
[2012-11-09 16:11:29 -0500] nacer: madzim: yeah, but kitchen do all the vagrant stuff by himself
[2012-11-09 16:11:35 -0500] matschaffer: ah
[2012-11-09 16:11:51 -0500] matschaffer: no idea then ;)
[2012-11-09 16:11:52 -0500] matschaffer: sorry
[2012-11-09 16:11:55 -0500] nacer: madzim: :)
[2012-11-09 16:11:58 -0500] nacer: matschaffer: :)
[2012-11-09 16:12:11 -0500] matschaffer: I only tried test kitchen once and gave up when I couldn't get it to only run one ver of ubuntu
[2012-11-09 16:13:51 -0500] madzim: knuckolls: awesome response, thanks. So chef is a bit like big data solutions in that servers are eventually consistent
[2012-11-09 16:14:03 -0500] madzim: servers => nodes
[2012-11-09 16:14:39 -0500] yfeldblum: madzim, yes, chef is designed for eventual convergent consistency
[2012-11-09 16:14:45 -0500] knuckolls: madzim: well if you have the chef-client checking in with the server every 20 seconds for new stuff to deploy then yeah it's eventually consistent. that's the concept of "convergence" you'll see in the chef wiki and on the anatomy of a chef run page.
[2012-11-09 16:15:44 -0500] knuckolls: tell the chef server about some new cookbook version, tell the environment that the new version is allowed in that environment, nodes check in and say "hey what's up", and the server gives them the new stuff
[2012-11-09 16:16:36 -0500] teukka: matschaffer: I just played with kitchen yesterday. you either specify `--platform ubuntu-12.04` on command line or specify `platform :ubuntu` block in Kitchenfile with only the wanted version
[2012-11-09 16:17:06 -0500] matschaffer: teukka: ahh the Kitchenfile you say. I was trying to use the supports metadata in the cookbook
[2012-11-09 16:17:34 -0500] yfeldblum: madzim, you may prefer to have chef drop a deploy script onto the server, and to run the deploy script manually (or automatically but via something else besides chef)
[2012-11-09 16:18:29 -0500] teukka: matschaffer: supports restricts the platforms, but not versions
[2012-11-09 16:19:12 -0500] matschaffer: teukka: kind of a shame given http://wiki.opscode.com/display/chef/Metadata#Metadata-supports
[2012-11-09 16:19:48 -0500] teukka: matschaffer: and for the multi-uload you could check if knife-essentials plugin helps. haven't tried it myself
[2012-11-09 16:20:05 -0500] madzim: feldblum: yep, I'll be researching that. It is one of the current requirements I've been given. Good to know that this is another bit we'll need to look into outside of chef.
[2012-11-09 16:20:18 -0500] matschaffer: matschaffer: sorry, multi upload? not following
[2012-11-09 16:20:50 -0500] madzim: So is there a cute nick for supporting tools that don't fall under the cookbook umbrella? Kitchen Drawer? Knife Block? :)
[2012-11-09 16:21:08 -0500] madzim: @knuckolls: thanks for that list. Very helpful
[2012-11-09 16:21:32 -0500] matschaffer: madzim: junk drawer? ;)
[2012-11-09 16:22:07 -0500] madzim: @Mat: ahahah That was my very first thought too! But I didn't think others would get it.
[2012-11-09 16:22:22 -0500] teukka: matschaffer: for uploading all data bags etc. at once
[2012-11-09 16:22:32 -0500] madzim: Setting up the github space now... Chef Junk Drawer. :)
[2012-11-09 16:22:34 -0500] matschaffer: teukka: ahhhh
[2012-11-09 16:22:35 -0500] matschaffer: thanks
[2012-11-09 16:22:50 -0500] matschaffer: got so curious about the kitchen test stuff I forgot my original question. Way to stay on top of things :)
[2012-11-09 16:26:34 -0500] matschaffer: teukka: `knife upload data_bags` holy s*** that's awesome
[2012-11-09 16:26:42 -0500] matschaffer: well effing done sir
[2012-11-09 16:27:07 -0500] nacer: found what i needed , i needed to add run_list_extras ['mysql::server']  to my test file
[2012-11-09 16:27:28 -0500] nacer: *kitchenfile
[2012-11-09 16:30:36 -0500] leifmadsen: sorry to harp on this, but I'll one more time. Has anyone spent any time with the rabbitmq cookbook? I got it to successfully provision on a CentOS 6 machine, but on Ubuntu 12.04, it fails when attempting to run a 'service rabbitmq-server stop' and then starting it again. It doesn't seem to actually stop the service before trying again, but the /var/run/rabbitmq/pid file is removed (so you have to manually use kill to stop it
[2012-11-09 16:30:36 -0500] leifmadsen: ).
[2012-11-09 16:34:02 -0500] kryptek: leifmadsen, what's the error you get when it tries to stop with the service command ?
[2012-11-09 16:34:18 -0500] leifmadsen: kryptek: https://gist.github.com/4045661
[2012-11-09 16:36:47 -0500] leifmadsen: just noticed a mistake in my initial log output there -- the line "service[rabbitmq-server] attempting to match 'rabbitmq-server' (/rabbitmq-server/) against process list" should read "stop rabbitmq-server". I was trying something and forgot to revert, but the output is exactly as shown besides that.
[2012-11-09 16:38:00 -0500] kryptek: why are you restarting, stopping, then starting ?
[2012-11-09 16:38:14 -0500] leifmadsen: kryptek: that's what the opscode cookbook does
[2012-11-09 16:38:15 -0500] leifmadsen: per the link under the first section
[2012-11-09 16:38:17 -0500] kryptek: ah
[2012-11-09 16:38:43 -0500] leifmadsen: it's the way it wants to start stop and start after checking for the erlang cookie or something
[2012-11-09 16:38:50 -0500] leifmadsen: regardless, I would think a stop and start should work :)
[2012-11-09 16:39:28 -0500] leifmadsen: they do work if I try it manually after killing the process after ssh to the box
[2012-11-09 16:39:29 -0500] leifmadsen: so the init script does appear to be at least somewhat valid
[2012-11-09 16:39:49 -0500] kryptek: weird.. wish I could be more helpful but I'm a little confused myself
[2012-11-09 16:40:42 -0500] leifmadsen: ya... I can't tell if it's the way chef is interacting with the init script, the init script itself, or what. There is a block of code at the bottom that seems to indicate the init script in some situations doesn't play nice with chef
[2012-11-09 16:41:32 -0500] leifmadsen: I'd just be curious if anyone has gotten this to work on ubuntu 12.04 before, as I can reproduce it every time so far (with and without clustering enabled)
[2012-11-09 16:44:12 -0500] danryan: Yo chefs, what's the best cookbook to use with iptables?
[2012-11-09 16:45:07 -0500] masterkorp: why does this knife search node "recipe:icinga\:\:server" retunrs a results and knife search node "recipes:icinga\:\:server" does not ?
[2012-11-09 16:46:22 -0500] kryptek: is 'recipes' a valid index to search against?
[2012-11-09 16:46:47 -0500] leifmadsen: masterkorp: s/recipes/recipe ?
[2012-11-09 16:47:10 -0500] masterkorp: maybe i am wrong, but recipe only searches for recipes that are explicit in the run list
[2012-11-09 16:47:42 -0500] masterkorp: eg does not give results for the recipes that are in roles
[2012-11-09 16:48:04 -0500] kraM: Assume a role should set some attributes which in turn should get used by a recip later on. Everything would work well, but at compile time the attributes are not set and therefor well working code fails. How am I supposed to "work-around" such situations?
[2012-11-09 16:48:42 -0500] masterkorp: http://pastie.org/5351934
[2012-11-09 16:48:48 -0500] masterkorp: yeah i am right
[2012-11-09 16:49:40 -0500] masterkorp: http://pastie.org/5351944
[2012-11-09 16:49:53 -0500] masterkorp: and the oposite for a recipe that is explicit in the run list
[2012-11-09 16:49:55 -0500] masterkorp: weird
[2012-11-09 16:50:19 -0500] masterkorp: i tough that recipes would search for all
[2012-11-09 16:50:51 -0500] masterkorp: the obvious fix would be using recipe*:icinga\:\:server
[2012-11-09 16:50:52 -0500] masterkorp: but why is it like this ?
[2012-11-09 16:50:59 -0500] madzim: @leifmadsen: I'm using Ubuntu 12.10 under VirtualBox. What is the link to the instructions you are following. I'll try to recreate
[2012-11-09 16:51:26 -0500] leifmadsen: madzim: I'm using this via ubuntu 12.04.1 under VirtualBox as well (through vagrant)
[2012-11-09 16:51:46 -0500] yfeldblum: masterkorp, you are not escaping it right in ruby
[2012-11-09 16:53:09 -0500] masterkorp: yfeldblum: i am runing it from the CLI
[2012-11-09 16:53:29 -0500] masterkorp: also that makes no sense
[2012-11-09 16:53:49 -0500] yfeldblum: masterkorp, the code in your recipe is incorrect
[2012-11-09 16:54:14 -0500] masterkorp: i fixed that man
[2012-11-09 16:54:23 -0500] masterkorp:    masterkorp | why does this knife search node "recipe:icinga\:\:server" retunrs a results and knife search node "recipes:icinga\:\:server" does not ?
[2012-11-09 16:54:46 -0500] masterkorp: ^this is my question now
[2012-11-09 16:54:57 -0500] yfeldblum: masterkorp, ah sorry
[2012-11-09 16:55:21 -0500] thehar: hi
[2012-11-09 16:56:06 -0500] masterkorp: Why its like this ?
[2012-11-09 16:56:19 -0500] yfeldblum: masterkorp, when you add the "recipe[icinga::server]" to the node's run-list, the "recipe" field on the node is updated immediately, but the "recipes" field on the node is updated only after the next successful chef-client run on that node
[2012-11-09 16:56:36 -0500] masterkorp: why would anyone design this to behave like this ?
[2012-11-09 16:56:41 -0500] bougyman: what's the magic sauce to get a directory to be mode 042750?
[2012-11-09 16:56:51 -0500] bougyman: when I use mode 2750, it ends up setting them 045303
[2012-11-09 16:56:56 -0500] bougyman: if I try to set them to 042750 with a string or int, it fails falidation
[2012-11-09 16:57:17 -0500] masterkorp: bougyman: use 02750
[2012-11-09 16:57:19 -0500] bougyman: FATAL: Chef::Exceptions::ValidationFailed: Option mode's value 042750 not in valid numeric range!
[2012-11-09 16:57:28 -0500] masterkorp: yfeldblum: i tried that too
[2012-11-09 16:57:30 -0500] bougyman: i think I tried 02750, as well.
[2012-11-09 16:57:44 -0500] bougyman: will try again
[2012-11-09 16:57:53 -0500] masterkorp: yfeldblum: node show shows the recipe, in recipes
[2012-11-09 16:57:57 -0500] bougyman: File.chmod 042750, "/the/dir" works perfectly, though
[2012-11-09 16:58:02 -0500] masterkorp: i Guess i will ask this on of the mailing list
[2012-11-09 16:58:26 -0500] bougyman: I figured the 'mode' in a directory resource would just File.stat and File.chmod with the actual argument passed.
[2012-11-09 16:58:26 -0500] yfeldblum: masterkorp, because "recipe" comes from the node's direct (unexpanded) run-list, while "recipes" comes from the expanded run-list, but the run-list is only expanded at the beginning of the chef-client run
[2012-11-09 16:58:28 -0500] masterkorp: bougyman: tried "2750" ?
[2012-11-09 16:58:29 -0500] masterkorp: sometimes it works
[2012-11-09 16:58:32 -0500] bougyman: yes, 2750 makes it 045303!
[2012-11-09 16:58:43 -0500] bougyman:  d-wSrwxrwT 2 log global_users 78 2012-11-05 15:20 /var/log/socklog/mail
[2012-11-09 16:58:44 -0500] bougyman: not pretty
[2012-11-09 16:58:49 -0500] holoway: bougyman: 042750? what mode would that be
[2012-11-09 16:59:12 -0500] masterkorp: holoway: end of the world 21st december mode
[2012-11-09 16:59:25 -0500] bougyman:  ruby -e 'File.chmod 042750, "/var/log/socklog/mail"'; ls -ld /var/log/socklog/mail
[2012-11-09 16:59:28 -0500] bougyman: drwxr-s--- 2 log global_users 78 2012-11-05 15:20 /var/log/socklog/mail
[2012-11-09 16:59:30 -0500] bougyman: that
[2012-11-09 16:59:35 -0500] bougyman: which is what I need.
[2012-11-09 17:00:43 -0500] masterkorp: yfeldblum: you are not getting my point
[2012-11-09 17:01:31 -0500] yfeldblum: masterkorp, sorry, what is your point?
[2012-11-09 17:04:26 -0500] holoway: bougyman: the mode for that is 2740
[2012-11-09 17:04:52 -0500] holoway: right?
[2012-11-09 17:06:13 -0500] masterkorp: holoway: +x makes it 5
[2012-11-09 17:06:41 -0500] holoway: masterkorp: ah - cheers
[2012-11-09 17:06:50 -0500] masterkorp: socklog has a *peculiar* permission requiriment
[2012-11-09 17:08:34 -0500] holoway: regardless, directory("/Users/adam/acks") { mode "2750" }
[2012-11-09 17:08:37 -0500] holoway: works just fine
[2012-11-09 17:08:50 -0500] holoway: bougyman: ^^
[2012-11-09 17:08:55 -0500] holoway: the key here is string-ifying the arguments to mode
[2012-11-09 17:15:32 -0500] jtimberman: holoway: can also use the leading 0 to tell ruby that is octal
[2012-11-09 17:15:34 -0500] jtimberman: directory("foo") { mode 02750 }
[2012-11-09 17:15:37 -0500] jtimberman: [2012-11-09T10:15:02-07:00] INFO: directory[foo] mode changed to 2750
[2012-11-09 17:15:44 -0500] jtimberman: drwxr-s---  2 jtimberman  staff  68 Nov  9 10:15 foo/
[2012-11-09 17:16:25 -0500] masterkorp: yfeldblum: just send a mail to mailing list
[2012-11-09 17:16:29 -0500] bougyman: holoway: that did not work fine on mine
[2012-11-09 17:16:29 -0500] masterkorp: i think other people may have the benefit on this one too
[2012-11-09 17:17:18 -0500] bougyman: it was the opposite of fine.
[2012-11-09 17:17:26 -0500] bougyman: OH, I used 2750, not "2750"
[2012-11-09 17:17:29 -0500] masterkorp: it should not matter
[2012-11-09 17:17:30 -0500] bougyman: it did
[2012-11-09 17:17:31 -0500] masterkorp: but try it as a string
[2012-11-09 17:17:31 -0500] bougyman: 2750 made it crazysauce.
[2012-11-09 17:17:31 -0500] jtimberman: bougyman: if you're going to use the numeric form instead of the string, you should precede with a 0
[2012-11-09 17:17:31 -0500] bougyman: I've tried "042750" as a string.
[2012-11-09 17:17:32 -0500] masterkorp: jtimberman: i recomened him that
[2012-11-09 17:17:33 -0500] bougyman: masterkorp: it didn't work.
[2012-11-09 17:17:54 -0500] masterkorp: 02750 as integer does not ?
[2012-11-09 17:18:05 -0500] masterkorp: that was what i understood
[2012-11-09 17:18:10 -0500] masterkorp: ^
[2012-11-09 17:18:41 -0500] geekbri: putting a 0 infront of an integer in ruby will make it octal
[2012-11-09 17:19:43 -0500] geekbri: 1.9.2-p290 :001 > "755".to_i(8) == 0755
[2012-11-09 17:19:43 -0500] geekbri:  => true
[2012-11-09 17:19:43 -0500] jtimberman: this might be helpful reading: http://wordaligned.org/articles/octal-literals
[2012-11-09 17:19:54 -0500] geekbri: that works too.
[2012-11-09 17:20:05 -0500] bougyman: my problem was thinking the "mode" would use the same args as File.stat and File.chmod
[2012-11-09 17:20:19 -0500] bougyman: File.chmod 042750, "path/to/dir" is what I was doing manually.
[2012-11-09 17:20:26 -0500] masterkorp: jtimberman: welp http://lists.opscode.com/sympa/arc/chef/2012-11/msg00135.html
[2012-11-09 17:20:38 -0500] masterkorp: :)
[2012-11-09 17:21:35 -0500] yfeldblum: masterkorp, it's that way because a chef system is eventually consistent, not immediately consistent
[2012-11-09 17:21:55 -0500] jtimberman: there's more discussion on this ticket: http://tickets.opscode.com/browse/CHEF-174
[2012-11-09 17:22:01 -0500] masterkorp: yfeldblum: i did run chef-clieny a butload of times
[2012-11-09 17:22:10 -0500] masterkorp: so eventually should be covered
[2012-11-09 17:22:33 -0500] masterkorp: it ran sucessfully
[2012-11-09 17:26:12 -0500] yfeldblum: masterkorp, on that node?
[2012-11-09 17:28:08 -0500] jblaine: will a template resource with a "notifies :restart, service[myblah]" always do the restart?
[2012-11-09 17:28:08 -0500] jblaine: seems that way, or I am doing something wrong
[2012-11-09 17:28:14 -0500] holoway: jblaine: it means your template is always changing
[2012-11-09 17:28:14 -0500] jblaine: it's happening even when the resulting file contents have not changed
[2012-11-09 17:28:15 -0500] masterkorp: yfeldblum: yes
[2012-11-09 17:28:15 -0500] holoway: do you have unsorted hashes you iterate through? timestamps?
[2012-11-09 17:28:18 -0500] holoway: jblaine: something is changing
[2012-11-09 17:28:44 -0500] yfeldblum: masterkorp, well then it should work ... although indexing may be delayed
[2012-11-09 17:33:02 -0500] jblaine: holoway: hmm.
[2012-11-09 17:33:24 -0500] holoway: jblaine: sorry to be the bearer of bad tidings - but it's true :) whitespace, timestamps, unsorted itereation
[2012-11-09 17:33:59 -0500] holoway: jblaine: if you're running a new version of chef, try using why-run
[2012-11-09 17:34:01 -0500] holoway: and see what the difference is
[2012-11-09 17:34:01 -0500] holoway: or do a full run with -Fdoc -lfatal
[2012-11-09 17:38:13 -0500] jblaine: holoway: *facepalm* found the problem. Thanks.
[2012-11-09 17:38:55 -0500] jblaine: holoway: testing rsyslog mods I made... our production 'rcf-syslog' recipe is running just before it. Derrr.
[2012-11-09 17:38:59 -0500] jtimberman: protip, don't use <%= Time.now %> in a template that notifies a service to restart :)
[2012-11-09 17:39:33 -0500] jblaine: jtimberman: I've pretty much rewritten 80% of opscode-cookbooks/rsyslog
[2012-11-09 17:40:00 -0500] jblaine: jtimberman: Will of course feed back into repo, but that thing was crusty
[2012-11-09 17:40:55 -0500] holoway: awesome! thanks for updating it, jblaine
[2012-11-09 17:41:57 -0500] thedeeno: I have an attribute defined like this in an attribute file: `default.cookbook[:b] = "#{node.cookbook[:a]"`
[2012-11-09 17:42:05 -0500] jtimberman: :-D
[2012-11-09 17:42:40 -0500] thedeeno: I'm then setting attribute b in a role file: `"cookbook":{"b":"test"}`
[2012-11-09 17:43:07 -0500] jtimberman: thedeeno: do it in a recipe
[2012-11-09 17:43:11 -0500] jtimberman: the node.default = bit
[2012-11-09 17:43:27 -0500] thedeeno: hmm, I guess I could do that, yeah
[2012-11-09 17:43:36 -0500] thedeeno: jtimberman: good idea, ty
[2012-11-09 17:58:43 -0500] jblaine: Ruby newb question: variable = expression || expression rescue nil
[2012-11-09 17:59:01 -0500] yfeldblum: jblaine, what's the question?
[2012-11-09 17:59:03 -0500] jblaine: sets variable to nil if there is an exception?
[2012-11-09 17:59:14 -0500] yfeldblum: jblaine, yes it does
[2012-11-09 17:59:17 -0500] jblaine: k
[2012-11-09 17:59:34 -0500] yfeldblum: jblaine, it is parsed as: variable = (expression || expression rescue nil)
[2012-11-09 17:59:52 -0500] yfeldblum: jblaine, hmm sorry that's wrong
[2012-11-09 18:00:16 -0500] yfeldblum: jblaine, the ruby parser will, at that line, say there's a local variable named "variable" in scope (but not before that line)
[2012-11-09 18:00:32 -0500] jblaine: well, to be specific, it's: variable = attr_ref || search(...) rescue nil
[2012-11-09 18:00:41 -0500] yfeldblum: jblaine, if the expression doesn't raise, then the local variable "variable" will be set
[2012-11-09 18:01:00 -0500] yfeldblum: jblaine, if the expression does raise, then the local variable "variable" will not have been set on that line
[2012-11-09 18:01:19 -0500] yfeldblum: jblaine, but the local variable will exist, and all uninitialized local variables are initialized to nil automatically
[2012-11-09 18:02:03 -0500] yfeldblum: jblaine, so it doesn't actually set the local variable to nil; it's just nil because it was declared but it was not set
[2012-11-09 18:02:22 -0500] jblaine: I see.
[2012-11-09 18:02:25 -0500] jblaine: so the 'rescue nil' is a way of saying 'catch the exception but do nothing' ?
[2012-11-09 18:03:23 -0500] spenserj: How would I go about passing a hash (from either solo.json or a databag) to a definition? http://pastie.org/5352253
[2012-11-09 18:03:43 -0500] killfill: how do i access that i put on "knife bootstrap --json-attributes 'my_data'" inside my bootrap distro template?
[2012-11-09 18:03:53 -0500] spenserj: Current code works, but as I add more options, it will become far too complex.
[2012-11-09 18:03:53 -0500] jblaine: also, question about 'only_if': Wouldn't it be a better practice to stick that at the opening of the resource call?
[2012-11-09 18:04:41 -0500] jblaine: I keep seeing: resourceref "blah" bunch of lines...only_if {block} end
[2012-11-09 18:05:07 -0500] jblaine: seems not ideal
[2012-11-09 18:05:25 -0500] killfill: aah first_boot.to_json.. never mind.. :)
[2012-11-09 18:05:51 -0500] siezer: jblaine are you familliar with the "compile phase" vs "converge phase"?
[2012-11-09 18:06:14 -0500] jblaine: apparently not
[2012-11-09 18:06:20 -0500] siezer: okay
[2012-11-09 18:06:41 -0500] jblaine: I mean, I get the concepts as quoted
[2012-11-09 18:06:46 -0500] hypergrove: hi some newbie questions about ec2 and chef....(1) do i need to purchase chef subscription (at many $/mo) in order to use a chef host to create about 24 nodes at amazon?
[2012-11-09 18:06:59 -0500] jblaine: but I wouldn't say I am familiar with them re: Chef
[2012-11-09 18:07:11 -0500] jblaine: hypergrove: no
[2012-11-09 18:07:26 -0500] siezer: right.. so what the compile phase does, it compiles the "resource collection", which is an array of convergent operators (resource) for deferred execution
[2012-11-09 18:07:36 -0500] hypergrove: the free chef level of acct only allows 5 nodes i recall
[2012-11-09 18:07:41 -0500] gchristensen: hypergrove: for 24 nodes you'll need to either run your own chef-server, or pay Opscode for your hosted-chef
[2012-11-09 18:07:48 -0500] jblaine: hypergrove: so run your own OSS chef server
[2012-11-09 18:08:01 -0500] siezer: if you were to put test logic around say, a template resource, it would evaluate that during the compile phase, to determine whether or not to put that template resource in the resource collection
[2012-11-09 18:08:28 -0500] hypergrove: thx (2) should i put that oss server in a separate ec2 instance?
[2012-11-09 18:08:54 -0500] gchristensen: yes, they recommend you get an m1.large for it which is more expensive than the cheapest hosted account
[2012-11-09 18:08:56 -0500] siezer: putting not_if/only_if "inside" the template resource, means that the template is on the resource collection, with the tests as parameters
[2012-11-09 18:09:09 -0500] gchristensen: but if you go beyond the 50 nodes, it becomes more economical
[2012-11-09 18:09:25 -0500] siezer: I can re-word that about 100 different ways.. let me know if I need to try again
[2012-11-09 18:09:30 -0500] jblaine: haha
[2012-11-09 18:09:34 -0500] jblaine: still parsing
[2012-11-09 18:09:54 -0500] hypergrove: what do you think about a windows-based oss server
[2012-11-09 18:10:39 -0500] jtimberman: gchristensen: to be clear, its because an m1.large is about the right amount of hardware to run a similar number of nodes as the same subscription rate allows.
[2012-11-09 18:11:10 -0500] jtimberman: you might get away with smaller server size, depending on what your clients are doing, how often they run chef-client, use search or other direct API requests, etc.
[2012-11-09 18:11:21 -0500] hypergrove: an m1.large is an opscode server??
[2012-11-09 18:11:35 -0500] jtimberman: hypergrove: m1.large amazon web services ec2 instance size.
[2012-11-09 18:11:42 -0500] jblaine: siezer: I think you answered something I didn't ask :)
[2012-11-09 18:12:01 -0500] jtimberman: i've seen c1.medium used for small deployments of nodes
[2012-11-09 18:12:07 -0500] siezer: oh
[2012-11-09 18:12:11 -0500] gchristensen: jtimberman: ah good to know
[2012-11-09 18:12:16 -0500] jblaine: siezer: I'm asking "is there any reason only_if keeps getting stuck down in a resource definition"
[2012-11-09 18:12:18 -0500] siezer: were you not asking about this vs this?
[2012-11-09 18:12:19 -0500] siezer: https://gist.github.com/4047250
[2012-11-09 18:12:20 -0500] jblaine: vs. up top for clarity
[2012-11-09 18:12:24 -0500] jtimberman: jblaine: do you have a code example of what you're talking about?
[2012-11-09 18:12:36 -0500] jblaine: sure
[2012-11-09 18:12:53 -0500] siezer: jblaine check that gist
[2012-11-09 18:13:12 -0500] hypergrove: i'm still a bit confused sorry - how about a windows chef oss?
[2012-11-09 18:13:14 -0500] jblaine: https://github.com/opscode-cookbooks/rsyslog/blob/master/recipes/client.rb
[2012-11-09 18:13:28 -0500] jblaine: note template for 49-remote...
[2012-11-09 18:13:53 -0500] jblaine: why not put 'only_if' as the 1st line of the template declaration?
[2012-11-09 18:14:02 -0500] rob__: quick question. Say I have a role that sets up and configures our web application. This download of our code is accomplished via git. Does it make more sense to say that our web application recipe depends on git or should we add git to the run_lost of our role?
[2012-11-09 18:14:19 -0500] jblaine: seems very backward to me to read a bunch of stuff then "oh BTW... none of this matters if..."
[2012-11-09 18:14:46 -0500] jtimberman: jblaine: ahh :)
[2012-11-09 18:14:47 -0500] jblaine: siezer: Yes, your gist is more complex a question than I asked.
[2012-11-09 18:14:57 -0500] siezer: ah
[2012-11-09 18:15:00 -0500] jblaine: siezer: or am trying to express :)
[2012-11-09 18:15:01 -0500] siezer: lemme parse yours
[2012-11-09 18:15:08 -0500] jtimberman: matter of bikeshed color. i generally write resource parameters in an order similar to that
[2012-11-09 18:16:14 -0500] jblaine: I'm not so sure that's bikeshed color vs. "You're weird." :)
[2012-11-09 18:16:54 -0500] jtimberman: :D
[2012-11-09 18:17:00 -0500] jtimberman: jblaine: you expect something like this? https://gist.github.com/ac3b9e25152d7b886348
[2012-11-09 18:17:15 -0500] jblaine: absolutely
[2012-11-09 18:18:00 -0500] jblaine: not looking to change people, just wanted to know if there was a reason for it ("no")
[2012-11-09 18:18:38 -0500] siezer: oh
[2012-11-09 18:18:42 -0500] hypergrove: another newbie question. I gather that opscode is a cloud services provider just like ec2, right? That the chef server is primarily intended to update/clone images on opscode servers. Is this true
[2012-11-09 18:19:10 -0500] miah:  no
[2012-11-09 18:19:30 -0500] siezer: yea the answer is "no, there's no reason for it, just habit"
[2012-11-09 18:19:43 -0500] hypergrove: miah:ok, where am i wrong
[2012-11-09 18:19:57 -0500] siezer: hypergrove nope, we're a configuration policy distribution service
[2012-11-09 18:20:08 -0500] jblaine: siezer: thanks (for the other explanation as well, which I did understand finally and is interesting to remember)
[2012-11-09 18:20:12 -0500] miah: configuration management as a service =)
[2012-11-09 18:20:26 -0500] siezer: no problemo
[2012-11-09 18:20:38 -0500] miah: you can use chef on ec2. but opscode does not provide 'instances' for you to run your application on
[2012-11-09 18:20:53 -0500] siezer: jblaine just remember to NEVER do anything that affects the system in teh compile phase
[2012-11-09 18:21:05 -0500] hypergrove: and so how do you characterize ec2 then please?
[2012-11-09 18:21:12 -0500] siezer: its totally possible to File.open and do stuff
[2012-11-09 18:21:57 -0500] siezer: if you need to run commands, use the script or ruby_block resources and set checks via the not_if and only_if parameters
[2012-11-09 18:23:39 -0500] siezer: hypergrove ec2 is an IaaS provider with an API that you can use to maniplate raw compute and storage resources
[2012-11-09 18:24:05 -0500] siezer: hypergrove these will typically leave you with a "base vm" that does nothing but sits around eating electricity
[2012-11-09 18:24:11 -0500] hypergrove: the 600/month for 100 nodes (each of the 40 installs for me has 5 nodes, so that's 600 nodes)
[2012-11-09 18:24:20 -0500] siezer: you need to configure it to make it do anything interesting, which is where we come in
[2012-11-09 18:24:27 -0500] jtimberman: hypergrove: http://docs.opscode.com/chef_overview.html
[2012-11-09 18:24:38 -0500] jtimberman: to understand the various parts of chef and kinds of chef servers.
[2012-11-09 18:25:03 -0500] leifmadsen: I'm not convinced the "auto cluster" stuff in the rabbitmq cookbook actually does anything other than write data to a file :)
[2012-11-09 18:25:11 -0500] leifmadsen: the actual clustering still appears to be a manual process
[2012-11-09 18:25:15 -0500] jtimberman: leifmadsen: thats possible
[2012-11-09 18:25:19 -0500] jtimberman: i think its noted in the readme?
[2012-11-09 18:25:42 -0500] leifmadsen: jtimberman: well the top of the README seems to indicate that it should automatically happen now
[2012-11-09 18:25:43 -0500] hypergrove: i mean 200 nodes still thats alot of money to administer a fixed set of resources
[2012-11-09 18:26:10 -0500] rob__: When should one use depends over run_list?
[2012-11-09 18:26:17 -0500] leifmadsen: per README:  "Cluster recipe is now combined with default. Recipe will now auto-cluster. Set the :cluster attribute to true, :cluster_disk_nodes array of node@host strings that describe which you want to be disk nodes and then set an alphanumeric string for the :erlang_cookie."
[2012-11-09 18:26:51 -0500] leifmadsen: although 2 new nodes being loaded with the cluster stuff enabled doesn't seem to auto-cluster heh
[2012-11-09 18:26:59 -0500] rob__: ie.. our web app role clones our git repo and sets up a bunch of shit. Does our web app recipe depend on git or should it include git as part of the run_list/
[2012-11-09 18:27:18 -0500] jtimberman: leifmadsen: oh hm
[2012-11-09 18:27:41 -0500] leifmadsen: jtimberman: it does indeed write the contents of the file (rabbit@rabbithost01, rabbit@rabbithost02, etc)
[2012-11-09 18:28:17 -0500] leifmadsen: jtimberman: additionally the init script on ubuntu doesn't seem to play nice with chef as it gets all confused on the 'stop rabbitmq-server' service resource
[2012-11-09 18:28:35 -0500] leifmadsen: just switched to my centos6 vagrant environment for testing and that part didn't fail any longer
[2012-11-09 18:35:52 -0500] jtimberman: leifmadsen: the current release of the rabbitmq cookbook was tested under test-kitchen on centos 5, 6, ubuntu 10.04, 12.04...
[2012-11-09 18:36:40 -0500] leifmadsen: jtimberman: interesting... as I can't get it (latest rabbitmq cookbook release) to load correctly in my vm
[2012-11-09 18:41:03 -0500] hypergrove: thanks, one more question please. Can I create a complete AMI from the servers started/configured by chef? Basically, I'm thinking to create the first instance using chef, and then create an ami from that set of servers. Is this a reasonable approach for an outcome of 20 identical sets of nodes?
[2012-11-09 18:43:17 -0500] jblaine: kind of defeats the purpose
[2012-11-09 18:43:31 -0500] hypergrove: how so please
[2012-11-09 18:43:44 -0500] maplebed: jblaine: it lets you use amazon's autoscaling features much more effectively.
[2012-11-09 18:44:04 -0500] jblaine: maplebed: I see.
[2012-11-09 18:44:24 -0500] maplebed: (I should note, though, that I'm not doing that at the moment, though it's on the roadmap)
[2012-11-09 18:44:52 -0500] jblaine: hypergrove: I was just commenting that the idea of making a "gold image" to instantiate is largely defeating the purpose of having chef in the picture
[2012-11-09 18:45:13 -0500] jblaine: hypergrove: that is, make the EC2 instances correct by running Chef on them
[2012-11-09 18:45:22 -0500] zuhaib: hypergrove: I have done that before int he past, and its totally fine.  The way we set it up was two roles.  One to burn the AMI, so this is where you do all your building and install of apps, and a 2nd role to configure it based on what it does
[2012-11-09 18:45:58 -0500] jblaine: hypergrove: It's certainly doable.
[2012-11-09 18:46:51 -0500] hypergrove: i guess it makes sense to keep chef in the picture pretty much (only) to the extent the ami's content needs to change
[2012-11-09 18:47:08 -0500] yfeldblum: CAP is solved ... just install atomic clocks on all your servers
[2012-11-09 18:47:09 -0500] zuhaib: Doing the prebuild ami allows you to have super fast deploy of new boxes, we took a server deploy that on avg would take 30 min and took it down to 2-5 min based on network traffic
[2012-11-09 18:47:19 -0500] maplebed: our thought is to maintain chef as the source of truth for configuration, but as a post-deploy step (for the appserver, mainly) to snapshot the host and use that as the source of the autoscaling.
[2012-11-09 18:47:43 -0500] maplebed: (with the goal of exactly what zuhaib describes)
[2012-11-09 18:47:45 -0500] holoway: jblaine: it's a mix - you do from scratch builds periodically, snapshot them, then use those snapshots for new launches to cut down on provisioning time
[2012-11-09 18:48:24 -0500] jblaine: holoway: understood
[2012-11-09 18:49:03 -0500] jblaine: so ah, terminating the chef run from within a cookbook
[2012-11-09 18:49:07 -0500] jblaine: best way?
[2012-11-09 18:49:23 -0500] jblaine: I don't recall seeing ideas in the wiki
[2012-11-09 18:50:10 -0500] yfeldblum: jblaine, possibly using chef-solo with a smaller run-list
[2012-11-09 18:50:54 -0500] jblaine: yfeldblum: No, I mean, writing a cookbook... what is the best way to cause chef to terminate its run right there if a certain condition is met
[2012-11-09 18:51:13 -0500] holoway: jblaine: raise an exception
[2012-11-09 18:51:33 -0500] jblaine: Alrighty then!
[2012-11-09 18:51:34 -0500] yfeldblum: jblaine, doesn't sound like a good idea to me for building base images
[2012-11-09 18:51:54 -0500] holoway: jblaine: you could just call exit, but that's morally raising an exception anyway
[2012-11-09 18:51:55 -0500] jblaine: yfeldblum: I think you may have your people mixed.
[2012-11-09 19:06:23 -0500] AntonZ: Hi, can anyone please look why this run fails? https://gist.github.com/4047568 - it used to work just fine, is it that cookbook is outdated ?
[2012-11-09 19:07:38 -0500] rava: that node attribute seems to be returnign none
[2012-11-09 19:08:04 -0500] AntonZ: hmm
[2012-11-09 19:08:51 -0500] AntonZ: does this mean that x11_packae is not avaiable ?
[2012-11-09 19:08:53 -0500] AntonZ: node['x11']['packages'].each do |x11_package|
[2012-11-09 19:08:53 -0500] AntonZ:   package x11_package
[2012-11-09 19:08:53 -0500] AntonZ: end
[2012-11-09 19:09:00 -0500] AntonZ: thats what is in the recipe
[2012-11-09 19:09:18 -0500] rob__: anyone know how to increase the timeout when checking out via git?
[2012-11-09 19:09:19 -0500] rob__:  had an error: Mixlib::ShellOut::CommandTimeout: command timed out:
[2012-11-09 19:09:31 -0500] rob__: already using depth 1
[2012-11-09 19:10:41 -0500] ank: does knife bootstrap with a gateway assume there's key-based auth from gateway to destination host?
[2012-11-09 19:19:34 -0500] AntonZ: rava, do you know if the error is because the cookbook is outdated or because centos 6 simply does not know how to isntall x11 package? this used to work on centos 5.x
[2012-11-09 19:21:46 -0500] rob__: anyone?
[2012-11-09 19:24:24 -0500] holoway: rob__: hrm - a quick scan of the documentation doesn't show me a way to set the timeout inside the provider
[2012-11-09 19:24:36 -0500] holoway: kallistec: any hint for rob__ ?
[2012-11-09 19:24:43 -0500] holoway: off to sandwich
[2012-11-09 19:27:31 -0500] jtimberman: rob__: using the git resource?
[2012-11-09 19:27:36 -0500] dmerrick: you can do it in the ssh config
[2012-11-09 19:27:44 -0500] rob__: yes I am using the git resource
[2012-11-09 19:27:50 -0500] rob__: ssh config?
[2012-11-09 19:27:59 -0500] rob__: not familiar with that
[2012-11-09 19:27:59 -0500] dmerrick: Client Side
[2012-11-09 19:27:59 -0500] dmerrick: Add the following two lines to /etc/ssh/ssh_config (or $HOME/.ssh/config if you don't have root access). his will make the client poll for server every 30 seconds. If the servers fails to respond for 4 times (i.e., 2 mins), the client will close the connection. Note that this also applies to version 2 of OpenSSH only.
[2012-11-09 19:28:00 -0500] dmerrick: ServerAliveInterval 30
[2012-11-09 19:28:01 -0500] dmerrick: ServerAliveCountMax 4
[2012-11-09 19:28:19 -0500] rob__: oh so its my client and not chef?
[2012-11-09 19:28:35 -0500] jtimberman: rob__: there isn't a timeout parameter in the git resource
[2012-11-09 19:28:44 -0500] rob__: ^ thats my problem
[2012-11-09 19:32:36 -0500] Fe: Where should I look to debug the follwing error "ERROR: Server returned error for http//." when I do knife configure -i
[2012-11-09 19:32:57 -0500] Fe: any hint will be helpful
[2012-11-09 19:35:21 -0500] rava: Fe: what's the return code?
[2012-11-09 19:36:38 -0500] Fe: I just get ERROR: Server returned error for http://myserverurl.com:4000/clients, retrying 1/5 in 4s
[2012-11-09 19:36:51 -0500] Fe: until it fails after 5 times
[2012-11-09 19:37:52 -0500] Fe: Do you have any idea why this could happen
[2012-11-09 19:37:59 -0500] miah: is your server accessible on port 4000?
[2012-11-09 19:38:18 -0500] miah: is there a firewall in the way? is your chef server not running? are cosmic rays brainwashing your goats?
[2012-11-09 19:38:58 -0500] Fe: lol. Yeah I checked that my 4000 is accessible
[2012-11-09 19:39:08 -0500] Fe: and the server is running
[2012-11-09 19:39:15 -0500] Urocyon: goats!
[2012-11-09 19:39:16 -0500] Fe: on 4000
[2012-11-09 19:39:46 -0500] Fe: goats are fine too , I just checked
[2012-11-09 19:41:00 -0500] Fe: How could I know more about the error does knife print any log details for why its not connected
[2012-11-09 19:41:01 -0500] rava: then an underlying service is puking. check that rabbit and couch are both running. the failed connection attempts should be in your chef-server logs regardless
[2012-11-09 19:41:24 -0500] rava: if chef-server is running and listening where knife thinks it is
[2012-11-09 19:42:47 -0500] Fe: aha. I see this error in the logs
[2012-11-09 19:42:48 -0500] Fe: ~ Connection failed - user: chef - (Bunny::ProtocolError)
[2012-11-09 19:44:53 -0500] Urocyon: wabbits!
[2012-11-09 19:45:07 -0500] Urocyon: Apparently rabbits and not goats.
[2012-11-09 19:45:26 -0500] Fe: lol so I need to configure the MQ
[2012-11-09 19:46:45 -0500] Fe: so how could I make the rabbits works will with the chef
[2012-11-09 19:46:49 -0500] Fe: well*
[2012-11-09 19:47:25 -0500] geekbri: So it seems like with chef if you right your own resource, that resource no longer returns the last statement of its action
[2012-11-09 19:49:42 -0500] rava: Fe: the chef-server install should have had it configured
[2012-11-09 19:49:51 -0500] rava: Fe: try bouncing rabbitmq
[2012-11-09 19:50:30 -0500] thedeeno: is there a way to make databag management with knife use encrypted databags by default?
[2012-11-09 19:50:56 -0500] Fe: rava: how do I do that
[2012-11-09 19:53:12 -0500] lecter: anyone around?
[2012-11-09 19:53:58 -0500] miah: no
[2012-11-09 19:54:07 -0500] miah: just all of us
[2012-11-09 19:57:33 -0500] Fe: It worked. I restarted the wabbits and boom is good now
[2012-11-09 19:57:51 -0500] Fe: i'll go back to my goats now. hv good one
[2012-11-09 19:59:12 -0500] rava: wabbit season
[2012-11-09 19:59:26 -0500] rava: i feel so used :(
[2012-11-09 20:06:03 -0500] geekbri: Ok so here I am digging around in the chef code base, but maybe somebody knows the answer.  When you used to call a resource it would return the last expression in the provider as its return object.  Now it seems to return Nil.  Unfortunately for me this seems to have broken a bunch of internal stuff.
[2012-11-09 20:06:37 -0500] geekbri: Im looking at the runner, and I see where it iterates over the resource collection executing the appropriate actions, but its non obvious to me what change caused this
[2012-11-09 20:06:40 -0500] geekbri: any ideas :)
[2012-11-09 20:09:57 -0500] rava: what are you using the return for? i'm curious why one would ever want the provider to return something to use
[2012-11-09 20:11:13 -0500] geekbri: rava: we have our own user creation cookbook, after it does all its jazz it returns a user object
[2012-11-09 20:11:28 -0500] geekbri: rava: then you can just call methods on that user object to obtain information about it.  The users are generated for databag entries
[2012-11-09 20:11:41 -0500] geekbri: There is other way to get the information, but it was the simplest and most elegant :)
[2012-11-09 20:11:52 -0500] geekbri: I mean, it WAS elegant, now its just broken
[2012-11-09 20:12:16 -0500] rava: odd, i do the exact opposite. a provider reading through data bag entries
[2012-11-09 20:12:48 -0500] rava: have a gist of the provider?
[2012-11-09 20:12:52 -0500] julian_: Another newb question.  I want to set an attribute in a recipe.  Is "set" the function?
[2012-11-09 20:15:41 -0500] rava: julian_: http://wiki.opscode.com/display/chef/Attributes#Attributes-SettingAttributes
[2012-11-09 20:17:30 -0500] julian_: rava: Thanks for the response.  yah I was looking at that.  I see     override,default, normal (or set) as functions to use.  Are these different than "override_attributes" that is used in role definitions?
[2012-11-09 20:18:01 -0500] AntonZ: Folks, what is the best way to update .bash_profile during chef run? what can i use outside of sed ?
[2012-11-09 20:18:38 -0500] rava: AntonZ: i use templates
[2012-11-09 20:18:54 -0500] AntonZ: hmm, let me research that
[2012-11-09 20:18:55 -0500] geekbri: rava: I can do you one better
[2012-11-09 20:19:01 -0500] julian_: AntonZ: https://github.com/fnichol/chef-bashrc
[2012-11-09 20:19:10 -0500] geekbri: oh damn we didn't open source that one. argh.
[2012-11-09 20:19:15 -0500] geekbri: I'll post the provider
[2012-11-09 20:19:36 -0500] geekbri: oof its a big one...
[2012-11-09 20:19:58 -0500] rava: geekbri: i quiver in antica.............pation
[2012-11-09 20:20:09 -0500] geekbri: rava: I meant to type that the users are generated FROM databag entries not for
[2012-11-09 20:20:10 -0500] julian_: rava: lol.
[2012-11-09 20:23:27 -0500] AntonZ: has nayoene seen this before: Chef::Exceptions::Package: No version specified, and no candidate version available for xorg-x11-fonts-truetype
[2012-11-09 20:23:36 -0500] AntonZ: installing on centos6
[2012-11-09 20:24:19 -0500] rava: seriously, i want to hug the etsy devops crew. spork + foodcritic = so much saved time
[2012-11-09 20:24:59 -0500] AntonZ: group hug time
[2012-11-09 20:25:02 -0500] geekbri: rava: https://gist.github.com/4048004
[2012-11-09 20:25:12 -0500] geekbri: I don't suspect that will actually be very helpful
[2012-11-09 20:26:13 -0500] rava: have you tried stepping through the recipe in shef?
[2012-11-09 20:26:25 -0500] rava: see if there's anything remaining nil for some reason?
[2012-11-09 20:27:06 -0500] geekbri: I haven't, i shall have to do that.
[2012-11-09 20:27:14 -0500] geekbri: I mean in chef 0.10.8 it returns the user object
[2012-11-09 20:27:31 -0500] geekbri: 10.16.2, not so much
[2012-11-09 20:28:07 -0500] geekbri: Meh I have to figure this out, as its preventing me from upgrading to the newer chef clients :)
[2012-11-09 20:28:42 -0500] miah: ok. now bugs in lvm cookbook are blocking me. YAY. time for lunch.
[2012-11-09 20:30:04 -0500] geekbri: time for bullet in skull
[2012-11-09 20:30:12 -0500] geekbri: i mean for me, not you:)
[2012-11-09 20:31:16 -0500] khimera: does anyone have any experience w/ Rightscale Chef ?
[2012-11-09 20:34:01 -0500] AntonZ: im using it right now
[2012-11-09 20:34:25 -0500] AntonZ: does anyone know if xorg-x11-fonts-truetype has been replaced with xorg-x11-fonts-ethiopic.noarch in centos6 ?
[2012-11-09 20:40:49 -0500] magoo: I'm trying to install a chef dependency in my chef_handler cookbook and am getting this:
[2012-11-09 20:40:52 -0500] magoo: [Fri, 09 Nov 2012 12:39:31 -0800] FATAL: ArgumentError: chef_gem[net/http] (chef_handler::jabber_snitch line 2) had an error: ArgumentError: Illformed requirement [""]
[2012-11-09 20:41:18 -0500] magoo: the line is just this:
[2012-11-09 20:41:32 -0500] magoo: chef_gem "net/http"
[2012-11-09 20:42:05 -0500] khimera: AntonZ - How is it? I am deciding if I should switch from scalr to rightscale
[2012-11-09 20:42:12 -0500] khimera: i know they only run chef-solo
[2012-11-09 20:42:18 -0500] khimera: their server templates?
[2012-11-09 20:45:26 -0500] AntonZ: rightscale is great if you have lotsa cash in the pocket :)
[2012-11-09 20:48:54 -0500] dopacki: hi. I tried backing-up my data bags using the chef_server_backup.rb script described in the "Backing up Chef Server" wiki but am striking-out when it comes to re-importing the resulting json files
[2012-11-09 20:49:23 -0500] rava: i wonder why chef-solo. i was pondering using it for our auto scaled web server pool in aws to not deal with register/deregister
[2012-11-09 20:49:25 -0500] dopacki: I'm getting a Chef::Exceptions::InvalidDataBagItemID exception
[2012-11-09 20:49:27 -0500] jtimberman: magoo: net/http is in the ruby standard library, you don't need to install it
[2012-11-09 20:49:39 -0500] rava: possible for my test machines aswell, since we have them firing up as spot instances that disappear randomly
[2012-11-09 20:50:18 -0500] dopacki: rava - I've gone that way before - works really well
[2012-11-09 20:50:42 -0500] rava: chef-solo seems all sorts of utlity
[2012-11-09 20:50:53 -0500] dopacki: you lose the ability to use search and data bags
[2012-11-09 20:51:08 -0500] dopacki: but it is pretty easy to design around that
[2012-11-09 20:51:09 -0500] rava: dopacki: true, but it's great for something like imaging machines
[2012-11-09 20:51:27 -0500] Drewzar: AntonZ: scalr isn't cheap either
[2012-11-09 20:51:45 -0500] magoo: jtimberman: thanks
[2012-11-09 20:51:56 -0500] rava: dopacki: and i think there's a way around it..
[2012-11-09 20:52:00 -0500] gchristensen: we've spend the last 6mo getting OFF scalr.
[2012-11-09 20:52:17 -0500] gchristensen: one day they released an update to their "scalrizer" client, and all it did was systematically crash our servers
[2012-11-09 20:52:24 -0500] dopacki: in my current deployment, I'm using chef server and just periodically reconcile the nodes list with the list of running aws boxen.. then purge the nodes that aren't running
[2012-11-09 20:52:38 -0500] rava: dopacki: ditto with a cron job
[2012-11-09 20:52:47 -0500] dopacki: but previously I was a huge fan of chef-solo
[2012-11-09 20:52:48 -0500] Drewzar: gchristensen: we hit that problem too, there's a setting in the scalrizer shit that will force it not to auto update
[2012-11-09 20:53:11 -0500] gchristensen: they don't do anything for us but get in our way, so we're just going without it
[2012-11-09 20:53:26 -0500] gchristensen: but we're just not there yet for auto-scaling
[2012-11-09 20:53:46 -0500] Drewzar: yeah, the auto-scaling is very nice.
[2012-11-09 20:53:58 -0500] dopacki: we stored a cookbook tarball in a nexus repo and just had ec2 user-data scripts pull the latest repo down
[2012-11-09 20:54:21 -0500] Drewzar: We havn't had too much trouble with scalr getting in our way.
[2012-11-09 20:54:39 -0500] dopacki: rightscale meta-data informed which roles to execute
[2012-11-09 20:54:49 -0500] Drewzar: Other than right now they can't seem to spin up an OEL server template :P
[2012-11-09 20:55:04 -0500] rava: dopacki: planning on doing the same using aws ec2 object tags
[2012-11-09 20:55:56 -0500] rava: the omnibus install makes it so much nicer for this use case
[2012-11-09 20:56:21 -0500] dopacki: yeah, ec2 tags would work fine too
[2012-11-09 20:56:34 -0500] dopacki: especially since you can define them in your auto-scale group
[2012-11-09 20:56:40 -0500] rava: ya
[2012-11-09 20:58:35 -0500] rob__: How can I run bundle via chef
[2012-11-09 20:58:42 -0500] rob__: heres the kicker I am using RVM
[2012-11-09 20:59:05 -0500] dopacki: rava - or just bake chef into your AMI and save about 5 min on launch
[2012-11-09 20:59:41 -0500] rava: dopacki: planning on it
[2012-11-09 21:00:18 -0500] rava: dopacki: just working on the jenkins job to ci the whole shebang
[2012-11-09 21:00:19 -0500] leifmadsen: jtimberman: fyi:  https://github.com/opscode-cookbooks/rabbitmq/commit/7ac2faac2e87bfb4e14dd19ba69d4156f50db3e8#commitcomment-2130985
[2012-11-09 21:00:46 -0500] leifmadsen: jtimberman: should I just open an issue about that to have that reverted? I don't see the harm in that being set to :delayed especially when it makes the cookbook work for clustering :)
[2012-11-09 21:00:59 -0500] rava: grab a naked ami, run chef-solo to install all the things, integrity things like ssh config/sudo/blah, bake and release ami
[2012-11-09 21:10:04 -0500] dopacki: so does anyone know how to restore a data bag dump that was created with jtimberman's script?
[2012-11-09 21:10:20 -0500] rava: dopacki: the restore script works for me
[2012-11-09 21:10:40 -0500] rava: do you run it before or after restoring your couchdb data?
[2012-11-09 21:11:02 -0500] dopacki: well.. I'm trying to use it to migrate data between chef servers
[2012-11-09 21:11:12 -0500] dopacki: so I can't just clobber the target couchdb instance
[2012-11-09 21:11:40 -0500] rava: dopacki: ah, my bad :) was thinking you were doing a full restore
[2012-11-09 21:12:13 -0500] dopacki: it looks like I can manually create and save a data bag item, then edit it manually again and paste in the JSON
[2012-11-09 21:12:26 -0500] dopacki: but that is retarded given the number of items I have to restore
[2012-11-09 21:12:28 -0500] rava: dopacki: data bag from file
[2012-11-09 21:12:46 -0500] geekbri: I have discovered why resource return behavior has changed!
[2012-11-09 21:12:54 -0500] rava: geekbri: woot! do tell
[2012-11-09 21:13:54 -0500] geekbri: rava: the run_action method in the resource class now contains an ensure block.  this has modified what ends up being returned.  In old versions when a resource successfully converged it would end up returning whatever the last expression was for "provider.send("acion_#{action}")"
[2012-11-09 21:14:20 -0500] geekbri: rava: however now it looks like there is an ensure block that makes sure events.resource_completed(self)   is executed
[2012-11-09 21:14:38 -0500] geekbri: so that will be the last expression evaluted in run_action, and therefore the new return value.
[2012-11-09 21:14:59 -0500] dopacki: yeah, data bag from file barfs on the files emitted by the backup tool
[2012-11-09 21:15:02 -0500] rava: geekbri: thanks for the heads up, curious how you'll work around it..
[2012-11-09 21:15:36 -0500] dopacki: it seems like the JSON format is different between creating and editing a data bag item
[2012-11-09 21:15:42 -0500] geekbri: rava: the run_action method changed pretty dramatically between chef 0.10.8 and 10.16.2 :)
[2012-11-09 21:16:08 -0500] geekbri: I haven't looked at the source in a while, it will take me more reading to really figure out what else changed, but certainly the ensure block is going to change the return value.
[2012-11-09 21:16:13 -0500] rava: dopacki: i'm pretty sure you could do a search, iterate, to_js the objects, and vice versa..maybe..? perhaps someone has a better way to do it
[2012-11-09 21:18:01 -0500] rava: dopacki: feels like a replication provider just waiting to happen
[2012-11-09 21:26:26 -0500] dopacki: looks like I was able to create all the data bag items, then set EDITOR to "cat>", then iterate over all the items and do cat $i.json | knife data bag edit <bag> $i
[2012-11-09 21:26:48 -0500] rava: clever
[2012-11-09 21:27:24 -0500] maplebed: do any of you use the opscode nagios cookbook configured for openid with google apps as the openid provider?
[2012-11-09 21:27:42 -0500] rava: not i, but now im curious
[2012-11-09 21:30:07 -0500] maplebed: it looks ossm, but I haven't done much with openid before and it doesn't seem to work for me.
[2012-11-09 21:30:29 -0500] maplebed: making it work isn't at the top of my list; I was just hoping it would because that'd be awful nice.
[2012-11-09 21:30:40 -0500] rava: how's it failing?
[2012-11-09 21:31:04 -0500] maplebed: "Error in authentication: OP is not authorized to make an assertion regarding the identity" in the error log
[2012-11-09 21:31:12 -0500] rava: have you double checked that openid is enabled with the google acct?
[2012-11-09 21:31:42 -0500] maplebed: no, though I was led to believe that it is when you have your google+ activated.
[2012-11-09 21:32:01 -0500] rava: not necessarily the case
[2012-11-09 21:32:17 -0500] maplebed: plus, when I enter the openid URL, it does redirect me to google's site to verify that it's ok, it's only after choosing an identity that it kicks me back to the nagios page with the failure.
[2012-11-09 21:32:37 -0500] maplebed: how can i check whether openid is enabled on the account?
[2012-11-09 21:32:55 -0500] rava: should be in your google profile settings
[2012-11-09 21:33:13 -0500] rava: if it's an app domain, it's in the domain settings
[2012-11-09 21:34:07 -0500] rava: under advanced tools
[2012-11-09 21:34:58 -0500] rava: looking for federated login using openid
[2012-11-09 21:35:18 -0500] maplebed: looking...
[2012-11-09 21:36:19 -0500] maplebed: I've found saml...  hrmph.
[2012-11-09 21:36:25 -0500] rob__: any good tutorials on how resources and providers work other than the opscode documentation?
[2012-11-09 21:36:45 -0500] rava: what's not covered in those docs?
[2012-11-09 21:37:18 -0500] rava: rob__: read through the oss'ed lwrps
[2012-11-09 21:37:44 -0500] rob__: what are those?
[2012-11-09 21:37:59 -0500] rava: http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+(LWRP)
[2012-11-09 21:38:15 -0500] rava: this is a big help: http://www.slideshare.net/jtimberman/understanding-lwrp-development
[2012-11-09 21:40:34 -0500] rob__: gracias
[2012-11-09 21:51:35 -0500] spenserj: How would I go about merging attributes with a hash in a definition? I'm attempting to use attributes as a default configuration, with per-definition overrides. Or is there a more logical way of this?
[2012-11-09 21:52:49 -0500] maplebed: I do something like that for configuring ganglia clusters.
[2012-11-09 21:52:57 -0500] maplebed: I dunno if it's a good method, but ...
[2012-11-09 21:53:17 -0500] maplebed: in the ganglia attributes file, there's 'default[:ganglia][:host_cluster] = {"default" => 1}'
[2012-11-09 21:53:52 -0500] maplebed: so all hosts that don't specify a cluster fall into the default cluster.
[2012-11-09 21:54:06 -0500] maplebed: then in a role file I put "override_attributes "ganglia" => { "host_cluster" => {"misc" => 1, "default" => 0 }}"
[2012-11-09 21:54:36 -0500] maplebed: elsewhere in the ganglia recipe, it iterates over keys in the host_cluster hash and joins any cluster whose value is 1.
[2012-11-09 21:56:35 -0500] spenserj: maplebed: I've got quite a few defaults in my attributes file, although I'm accessing it inside the definition file. I've considered iterating over all of node[:php_fpm], but, as you said, I'm not sure if that is a good method.
[2012-11-09 21:56:41 -0500] behemphi: I have not seen this in here so if you want work safe, github related humor this might help you transition to the weekend:
[2012-11-09 21:56:41 -0500] behemphi: http://wheningit.tumblr.com
[2012-11-09 21:57:03 -0500] spenserj: I'll give it a shot though, and see what happens.
[2012-11-09 21:58:17 -0500] AntonZ: is atomic pinguin here ?
[2012-11-09 22:00:52 -0500] spenserj: behemphi: Thank you for making my entire office burst into laughter. There goes the rest of the work day.
[2012-11-09 22:01:18 -0500] behemphi: lol @spenserj you are welcome.
[2012-11-09 22:07:26 -0500] AntonZ: does anyone know what ahppened to No package xorg-x11-fonts-truetype available in centos6 ?
[2012-11-09 22:19:25 -0500] jtimberman: behemphi: omg
[2012-11-09 22:19:28 -0500] jtimberman: <3
[2012-11-09 22:21:09 -0500] mattray: anyone using the haproxy cookbook want to give me a few pointers?
[2012-11-09 22:22:15 -0500] mattray: I've got a node in HP's cloud with 2 behind it. The admin console shows them as DOWN, but I can curl them from the haproxy box
[2012-11-09 22:22:19 -0500] juliancdunn: mattray: we are
[2012-11-09 22:22:25 -0500] mattray: port 80, private IP
[2012-11-09 22:22:44 -0500] juliancdunn: are you using a custom check?
[2012-11-09 22:22:47 -0500] mattray: ahh that's probably it
[2012-11-09 22:24:27 -0500] mattray: default['haproxy']['member_port'] = "8080"
[2012-11-09 22:24:32 -0500] mattray: that's probably it
[2012-11-09 22:24:40 -0500] CharlieSu: behemphi: great link..  :)
[2012-11-09 22:26:26 -0500] mattray: boom!
[2012-11-09 22:26:28 -0500] mattray: :)
[2012-11-09 22:26:33 -0500] juliancdunn: AntonZ: I believe EPEL removed xorg-x11-fonts-truetype for licensing reasons
[2012-11-09 22:26:37 -0500] juliancdunn: mattray: nice :)
[2012-11-09 22:26:55 -0500] juliancdunn: AntonZ: https://fedoraproject.org/wiki/Fonts_inclusion_history
[2012-11-09 22:28:05 -0500] rava: behemphi: genius!
[2012-11-09 22:29:20 -0500] behemphi: That was our designer who found that.  It felt pretty on topic (for a friday)
[2012-11-09 22:29:49 -0500] rava: behemphi: indubitably
[2012-11-09 22:30:18 -0500] behemphi: man my life would be complete if I could use that word in a chat room!
[2012-11-09 22:36:04 -0500] phoxpsh: hi guys. i've created a chef client "test-client" and trying to run chef-client (i've set validation_client_name = "test client" and validation_key is the path to the pem that the web ui returned.
[2012-11-09 22:36:29 -0500] phoxpsh: the chef-client run fails with "If these settings are correct, your validation_key may be invalid." - any idea why that might be? the key definitely maches what was in the web ui
[2012-11-09 22:37:44 -0500] phoxpsh: *validation_client_name = "test-client"
[2012-11-09 22:38:50 -0500] juliancdunn: phoxpsh: your validation_client_name is not the same as your client
[2012-11-09 22:38:57 -0500] juliancdunn: normally it's 'chef-validator'
[2012-11-09 22:39:56 -0500] phoxpsh: juliancdunn: hmm, i've tried with "chef-validator" and get the same error. the validation key should be the one that belongs to the client, right?
[2012-11-09 22:40:14 -0500] juliancdunn: nope, it should be the validation.pem that was generated by the server at install time
[2012-11-09 22:40:21 -0500] juliancdunn: are you using Open Source Chef, or Hosted Chef?
[2012-11-09 22:40:26 -0500] phoxpsh: Open source
[2012-11-09 22:40:41 -0500] juliancdunn: so when you installed your server, it created a validation.pem for you
[2012-11-09 22:40:49 -0500] juliancdunn: put that on the client
[2012-11-09 22:41:36 -0500] juliancdunn: the client uses validation.pem to log into the Chef server as validation_client_name, and then the server generates a client.pem for you
[2012-11-09 22:43:43 -0500] phoxpsh: thanks juliancdunn, that makes sense; i'll try again :)
[2012-11-09 22:44:29 -0500] juliancdunn: phoxpsh: no probs
[2012-11-09 23:32:18 -0500] bwong_: Hello, is anyone here, I have simple question
[2012-11-09 23:33:04 -0500] red5|ryan: sure what is up :)
[2012-11-09 23:33:42 -0500] bwong_: I just started using chef... and for testing im just writing a ntp recipe
[2012-11-09 23:33:57 -0500] bwong_: when i put in knife cookbook upload ntp, it gives me a authentication error
[2012-11-09 23:34:29 -0500] bwong_: on the server i tried to find out whats going on, but it seems i have problems with authentication
[2012-11-09 23:34:50 -0500] red5|ryan: could be the validation.pem on your knife client
[2012-11-09 23:35:05 -0500] red5|ryan: did you copy it down from the chef server and point knife.rb at it's path?
[2012-11-09 23:35:05 -0500] bwong_: Failed to authenticate to xxx:4000 as root with key /etc/chef/client.pem Response:  Failed to authenticate. Ensure that your client key is valid.
[2012-11-09 23:35:22 -0500] bwong_: the validation pem?
[2012-11-09 23:35:32 -0500] red5|ryan: oh so its client.pem
[2012-11-09 23:35:35 -0500] bwong_: I thought when I start chef-client it generates a client.pem
[2012-11-09 23:35:57 -0500] red5|ryan: well there is a client.pem for each node
[2012-11-09 23:35:59 -0500] ev0ldave: knife and chef-client two different things
[2012-11-09 23:36:14 -0500] red5|ryan: but your admin account should have its own client.pem which you specify in knife.rb
[2012-11-09 23:36:29 -0500] bwong_: Originally the settings was client_key               '/root/.chef/root.pem' in knife.rb
[2012-11-09 23:36:42 -0500] bwong_: but root.pem is not automatically generated.
[2012-11-09 23:36:51 -0500] red5|ryan: are you using hosted chef or your own server?
[2012-11-09 23:36:51 -0500] bwong_: so I assume it was the client.pem it is referring to
[2012-11-09 23:36:57 -0500] bwong_: my own
[2012-11-09 23:37:11 -0500] red5|ryan: you probably have to make yourself an admin account on the chef server
[2012-11-09 23:37:18 -0500] red5|ryan: which will generate a pem
[2012-11-09 23:37:22 -0500] red5|ryan: that you can download and use with knife
[2012-11-09 23:37:26 -0500] bwong_: using knife?
[2012-11-09 23:37:40 -0500] red5|ryan: nah because you need that for knife to authenticate
[2012-11-09 23:37:50 -0500] red5|ryan: I think you have to ssh into your chef server
[2012-11-09 23:38:11 -0500] red5|ryan: let me check my command history on one of them...
[2012-11-09 23:39:45 -0500] bwong_: ok
[2012-11-09 23:40:51 -0500] red5|ryan: oh I guess it is knife
[2012-11-09 23:41:00 -0500] red5|ryan: but when its local to the chef server its okay... maybe
[2012-11-09 23:41:05 -0500] red5|ryan: knife client create bwong -n -a -f bwong.pem
[2012-11-09 23:41:26 -0500] red5|ryan: then scp bwong.pem down and specify it in knife.rb
[2012-11-09 23:43:23 -0500] bwong_: I see
[2012-11-09 23:43:26 -0500] bwong_: do you get this?
[2012-11-09 23:43:31 -0500] bwong_: ERROR: RuntimeError: Please set EDITOR environment variable
[2012-11-09 23:43:46 -0500] bluepojo: export EDITOR=emacs
[2012-11-09 23:43:49 -0500] bluepojo: or whatever your editor is
[2012-11-09 23:43:54 -0500] bluepojo: mate, vim, textedit
[2012-11-09 23:45:00 -0500] bwong_: [root@bwongmchef .chef]# knife client create bwong -n -a -f bwong.pem ERROR: Your private key could not be loaded from /root/.chef/root.pem Check your configuration file and ensure that your private key is readable
[2012-11-09 23:45:07 -0500] bwong_: haha, this is the issue i been dealing with. It goes in a loop
[2012-11-09 23:45:25 -0500] bwong_: eveyrthing I do needs authentication even trying to setting up authencation needs authentcation
[2012-11-09 23:45:39 -0500] red5|ryan: :)
[2012-11-09 23:46:41 -0500] bwong_: let me see if it will work
[2012-11-09 23:46:51 -0500] bwong_: if i cp validation pem to root.pem
[2012-11-09 23:47:17 -0500] red5|ryan: it shouldnt
[2012-11-09 23:47:42 -0500] bwong_: Yeah...
[2012-11-09 23:47:49 -0500] j|: After a 'knife index rebuild', what needs to happen then for 'knife search' to return results again?
[2012-11-09 23:47:56 -0500] bwong_: im stuck, not quite sure why its like this
[2012-11-09 23:53:37 -0500] j|: ...
[2012-11-09 23:53:40 -0500] j|: hm.
[2012-11-09 23:53:55 -0500] j|: nothing I've found useful in google.
[2012-11-09 23:54:59 -0500] miah: j|: double check that solr and chef-indexer are doing their things
[2012-11-09 23:55:24 -0500] j|: chef-indexer?.. ?
[2012-11-09 23:55:43 -0500] j|: chef-solr, couchdb, rabbitmq-server, chef-expander, chef-server
[2012-11-09 23:55:45 -0500] j|: all running
[2012-11-09 23:55:56 -0500] j|: never heard of chef-indexer?
[2012-11-09 23:58:49 -0500] j|: thanks for trying though.
[2012-11-09 23:58:50 -0500] j|: :P
