[2012-11-20 00:18:48 -0500] mrk_: hey guys - i'm trying to restore a chef server from scratch on AWS. I brought up a new chef server with basic configs, and i copied over the data
[2012-11-20 00:18:55 -0500] mrk_: from the old server
[2012-11-20 00:19:06 -0500] mrk_: pretty much followed these steps http://cookingclouds.com/2012/06/27/chef-server-backup-and-restore/
[2012-11-20 00:19:30 -0500] mrk_: except that when I restart the chef server + webui, my users, clients, nodes, recipes etc aren't there
[2012-11-20 00:20:05 -0500] mrk_: files in /var/lib/couchdb/1.0.1/default have been copied over and are similar across the 2 machines
[2012-11-20 00:20:21 -0500] mrk_: any idea why chefwebui isnt displaying the accurate data?
[2012-11-20 00:20:21 -0500] cheflevelramen: exit
[2012-11-20 00:25:02 -0500] bougyman: do any of you find yourselves putting way too much logic in templates? follow up question, if no: how do you avoid it?
[2012-11-20 00:39:57 -0500] sascha_d: @bougyman put the logic in your cookbook
[2012-11-20 00:40:01 -0500] sascha_d: I mean recipe
[2012-11-20 00:41:29 -0500] uncommitted: anyone ever notice that if you're in the wrong directory when you add a recipe is adds this "recipe[recipes]" instead of the actual recipe?
[2012-11-20 00:44:07 -0500] chefologist: hi when I run knife cookbook upload apt ... I receive: Could not find cookbook runit in your cookbook path, skipping it ... assistance would be great
[2012-11-20 00:44:31 -0500] sascha_d: @chefologist use -o /path/to/your/cookbook/dir
[2012-11-20 00:45:10 -0500] uncommitted: chefologist, upload runit first
[2012-11-20 00:46:59 -0500] sascha_d: oh, haha, I missed that it was a depends error
[2012-11-20 00:49:41 -0500] chefologist: uncommitted: I ran knife cookbook upload runit, and got the error
[2012-11-20 00:51:44 -0500] miah: chefologist: do you have 'runit' in your local cookbook repository? eg. have you done 'knife cookbook site install runit'?
[2012-11-20 00:54:12 -0500] chefologist: miah: the path in my knife.rb had /../cookbooks > I removed /.. and it now works like a charm bracelet :)
[2012-11-20 00:54:56 -0500] miah: congrats
[2012-11-20 00:59:34 -0500] chefologist: hi how do you know which version 2.0.0 1.0.0 of postgresql relates to which version of postgresql 9.x 8.x etc in the community?  I can't seem to find the notes on each version.... thanks cheffies
[2012-11-20 01:00:53 -0500] miah: read the code
[2012-11-20 01:01:03 -0500] miah: newer versions of the cookbooks generally means newer features
[2012-11-20 01:01:40 -0500] miah: many of the cookbooks just install via 'package' so if your distro has pgsql8 thats what you get. unless it allows you to install a specific version. in which case.. reading the code will tell you that.
[2012-11-20 01:01:46 -0500] chefologist: miah: thanks, I sent you an email yesterday, please disregard, I was able to get chef-redis installed, by changing some of your rubycode into 1 line instead of 5
[2012-11-20 01:02:53 -0500] miah: im curious what the problem you had was
[2012-11-20 01:03:22 -0500] miah: and what email you sent it too since i'm not seeing it (unless my filters put it elsewhere)
[2012-11-20 01:04:14 -0500] chefologist: I didn't document the issue, apologies I should have ... it was asking about $end instead of kEND ... something like that
[2012-11-20 01:04:38 -0500] chefologist: miah: I am using the opscode ubuntu server images
[2012-11-20 01:05:50 -0500] miah: that doesn't help much
[2012-11-20 01:06:01 -0500] miah: surely you can reference which 5 lines you changed?
[2012-11-20 01:10:48 -0500] chefologist: miah, I am the type of devops that needs to document all processes when learning something, however with chef-redis I didn't do this ... let me dig a little
[2012-11-20 01:11:25 -0500] miah: git helps with documentation
[2012-11-20 01:12:58 -0500] chefologist: miah: good tip, I am using google docs, how do you use git for documentation? wiki?
[2012-11-20 01:14:28 -0500] miah: my documentation lives in the code repositories i deal with
[2012-11-20 01:15:04 -0500] chefologist: miah: I also commented out ... use chef-server from memory
[2012-11-20 01:17:36 -0500] chefologist: miah, as I am new to devops, I am using the ops-code cookbooks, and yours was the first community cookbook I have used.  How do I write my own?  I am new to ruby
[2012-11-20 01:19:32 -0500] miah: http://wiki.opscode.com/display/chef/Guide+to+Creating+A+Cookbook+and+Writing+A+Recipe
[2012-11-20 01:20:31 -0500] jcran: can i use a cookbook/attributes/default.rb file to set attributes with chef-solo, or do i have to do it in the json_attribs file passed into chef-solo ?
[2012-11-20 01:20:50 -0500] chefologist: miah: thank-you
[2012-11-20 01:21:22 -0500] jcran: all the docs point to the latter, so assuming that.
[2012-11-20 01:22:30 -0500] jcran: leaves me confused on the best way to generate a password at chef runtime though
[2012-11-20 01:22:42 -0500] miah: you shouldn't modify the attributes in the cookbook directly
[2012-11-20 01:22:52 -0500] jcran: even if i'm writing the cookbook?
[2012-11-20 01:22:55 -0500] miah: you can pass them via json_attribs, or by creating a role to use with vagrant.
[2012-11-20 01:23:03 -0500] miah: ah. if you're writing the cookbook then ya. use whatever attributes you want.
[2012-11-20 01:23:17 -0500] miah: but the 'attributes' file in a cookbook tends to be 'safe defaults'
[2012-11-20 01:23:25 -0500] miah: if you intend for external entities to use your code
[2012-11-20 01:23:30 -0500] jcran: ah, okay. but role attributes would work with chef-solo?
[2012-11-20 01:23:30 -0500] miah: otherwise.. put wtf you want.
[2012-11-20 01:23:34 -0500] miah: yes
[2012-11-20 01:23:39 -0500] jcran: very cool, thanks
[2012-11-20 01:24:32 -0500] miah: http://wiki.opscode.com/display/chef/Chef+Solo#ChefSolo-Roles
[2012-11-20 01:25:04 -0500] miah: ok. heading home.
[2012-11-20 01:25:08 -0500] jcran: gotcha, many thanks
[2012-11-20 02:06:27 -0500] bmcgee: hey stupid question but if i want to force a run on a box i just the chef-client command?
[2012-11-20 02:06:34 -0500] bemu: yes
[2012-11-20 02:07:43 -0500] bmcgee: I have a freshly provisioned backspace vm that i'm trying to do this from. Getting this: https://gist.github.com/4115495
[2012-11-20 02:07:47 -0500] bmcgee: *rackspace
[2012-11-20 02:07:56 -0500] jsh: some of us never put chef-client in cron, and just run it manually as needed
[2012-11-20 02:08:03 -0500] jsh: via knife ssh in my case
[2012-11-20 02:08:06 -0500] bmcgee: yeah i'm running it manually
[2012-11-20 02:09:14 -0500] bmcgee: what would the command look like if i wanted to use knife ssh and select for nodes which had the 'base' role? knife ssh "role:base" chef-client?
[2012-11-20 02:10:25 -0500] bluepojo: yeah, that will work
[2012-11-20 02:11:19 -0500] bemu: We use fabric for a similar purpose. Capistrano also works.
[2012-11-20 02:11:29 -0500] bmcgee: just picked up this example from the docs: knife ssh "roles:base" "sudo chef-client". Getting "WARNING: Failed to connect to  -- SocketError: getaddrinfo: nodename nor servname provided, or not known"
[2012-11-20 02:12:01 -0500] bemu: -a ipaddress maybe?
[2012-11-20 02:12:21 -0500] bmcgee: i'd rather not have to know the ip address, thought the query for roles:base let chef do that for me?
[2012-11-20 02:13:15 -0500] jsh: so here's what it looks like when I do it with amazon ec2
[2012-11-20 02:13:16 -0500] jsh: knife ssh 'role:base' uptime -a ec2.public_hostname -x ubuntu
[2012-11-20 02:13:59 -0500] bmcgee: if you're specifying the address then surely the query string is redundant
[2012-11-20 02:14:49 -0500] jsh: I'm not specifying the hostname
[2012-11-20 02:14:51 -0500] jsh: that's literal
[2012-11-20 02:15:03 -0500] jsh: telling knife ssh which node attribute to use as the address to ssh to
[2012-11-20 02:15:24 -0500] bmcgee: ah
[2012-11-20 02:15:24 -0500] jsh: that particular command I just sent responds with uptime for all of my "base" hosts
[2012-11-20 02:15:31 -0500] bmcgee: sorry i get what you mean now
[2012-11-20 02:15:58 -0500] jsh: woah
[2012-11-20 02:15:59 -0500] jsh: up 251 days
[2012-11-20 02:16:06 -0500] bmcgee: i have to tell it the attribute to query on as it can be different depending on whether it's ec2, backspace etc
[2012-11-20 02:16:07 -0500] jsh: didn't expect that
[2012-11-20 02:16:15 -0500] bmcgee: so who can guess my next question? :)
[2012-11-20 02:16:16 -0500] jsh: some host sitting quietly doing it's job
[2012-11-20 02:16:26 -0500] jsh: time to kill it, just to know I can :)
[2012-11-20 02:16:55 -0500] bemu: Why do you keep referring to backspace? Is this like a public cloud for prostitutes?
[2012-11-20 02:17:00 -0500] jsh: bmcgee: best beer to drink when writing chef cookbooks?
[2012-11-20 02:17:09 -0500] bmcgee: fricking client keeps autocorrecting
[2012-11-20 02:17:19 -0500] bemu: :)
[2012-11-20 02:17:39 -0500] bmcgee: Jsh funny you say that i just got a case of mixed belgian beer that arrived today
[2012-11-20 02:18:31 -0500] bemu: btw, I had really high failure rates on rackspace when I used it recently. 2/3rds
[2012-11-20 02:18:35 -0500] bemu: (on 3 servers)
[2012-11-20 02:18:54 -0500] bemu: Obviously a very small sample size, but not encouraging for sure.
[2012-11-20 02:19:06 -0500] jsh: bmcgee: in that case, I'd suggest staying away from the tripel while writing cookbooks
[2012-11-20 02:19:45 -0500] jsh: I've not tried rackspace yet
[2012-11-20 02:19:59 -0500] bmcgee: bemu: it's so much cheaper compared with ec2 though
[2012-11-20 02:20:03 -0500] jsh: been pretty happy with AWS, but probably going to give joyent a try
[2012-11-20 02:20:17 -0500] bemu: I don't think I would ever consider building on a public cloud unless I had extremely loose requirements.
[2012-11-20 02:20:27 -0500] bmcgee: bemu: i have extremely loose requirements
[2012-11-20 02:20:29 -0500] bmcgee: :)
[2012-11-20 02:20:40 -0500] jsh: and I saw a lovely sales pitch from Verizon folks hawking their Terremark cloud
[2012-11-20 02:20:56 -0500] jsh: haven't seen pricing on that yet
[2012-11-20 02:21:15 -0500] bmcgee: there's that many cloud providers these days, one of the main reasons I'm spending time with chef is so i can jump ship with impunity
[2012-11-20 02:21:34 -0500] jsh: but given that they were totally cool with allowing me to colo a rack alongside their "cloud" racks, I'm expecting that it's not cheap
[2012-11-20 02:21:59 -0500] iverson0881: i'm currently in the process of switching from AWS to SoftLayer, unfortunately there's no knife-sl type plugin
[2012-11-20 02:22:09 -0500] jsh: bmcgee: I've only started looking at spiceweasel, but it looks promising to make multi-cloud deployments easy
[2012-11-20 02:22:12 -0500] iverson0881: and then there's the ipaddress issue because they have two interfaces, which I have no idea how to gget around
[2012-11-20 02:23:31 -0500] bmcgee: jsh: spice weasel looks interesting
[2012-11-20 02:29:04 -0500] bmcgee: so i figured my issue earlier with running chef-client from the box. After messing around with the ruby recipe i went back to using rvm. Seems i screw the pooch for chef-client. I know the rvm::vagrant recipe patches the chef-client for this reason, curious if it will work for remote vm too. I'll give it a try
[2012-11-20 02:30:30 -0500] jsh: fwiw: I've been much less inclined to throw my computer out the window since I switched from vrm to rbenv
[2012-11-20 02:30:41 -0500] jsh: s/vrm/rvm/
[2012-11-20 02:31:46 -0500] bemu: bmcgee: I can vouch for jumping ship. We had to vacate our data center during Sandy as it got flooded. We were able to move to 1200 cloud servers within 3 hours and suffered no core downtime as a result.
[2012-11-20 02:32:00 -0500] bmcgee: i have to admit, coming from a java background i just find the way ruby 'works' somewhat annoying
[2012-11-20 02:32:01 -0500] bemu: (from bare metal)
[2012-11-20 02:32:17 -0500] bmcgee: bemu: very nice
[2012-11-20 02:32:41 -0500] bemu: But increasingly I'm realizing that 'cloud' almost always also means 'inconsistent', which is a major issue unless you're constantly burning in and testing hardware.
[2012-11-20 02:33:26 -0500] bmcgee: i tend to think of cloud as meaning 'noisy'. The key is architecture, it always boils down to how you architect your app
[2012-11-20 02:33:41 -0500] bmcgee: in my experience the last thing anyone cares about is resiliency
[2012-11-20 02:33:43 -0500] bmcgee: until it falls over
[2012-11-20 02:33:50 -0500] bmcgee: same with metrics and monitoring
[2012-11-20 02:34:06 -0500] bmcgee: i like the approach netflix have with their simian army
[2012-11-20 02:34:36 -0500] bmcgee: if you take pot shots at your own architecture all day long and it doesn't fall over then it will probably hold up if someone else starts taking pot shots at it
[2012-11-20 02:36:39 -0500] bemu: That's the easy part.
[2012-11-20 02:36:53 -0500] bemu: But if performance matters to you at all, you have to constantly monitor your hardware to ensure it.
[2012-11-20 02:37:33 -0500] jcran: is there a supported / easy way to use erb with attributes?
[2012-11-20 02:37:49 -0500] bemu: It's not just noisy, the performance you get from similar units can be 2-3x off.
[2012-11-20 02:37:56 -0500] jcran: i want a default for this cookbook to be a generated password
[2012-11-20 02:37:59 -0500] bemu: or even worse, on degraded nodes.
[2012-11-20 02:38:04 -0500] jcran: default[:postgresql][:password] = "<%= (0...24).map{ ('a'..'z').to_a[rand(26)] }.join %>"
[2012-11-20 02:38:27 -0500] miah: just use the secure_password thing from the openssl cookbook
[2012-11-20 02:38:39 -0500] jsh: miah++
[2012-11-20 02:38:43 -0500] bmcgee: bemu: funny you mention that i read an article on HN in the last day or so where someone compared the performance of various instances. If i remember right the cpu performance of a mini on ec2 was better than a small by a good margin.
[2012-11-20 02:39:15 -0500] bemu: likewise, the bandwidth available on a c1.medium is much higher than an m1.large
[2012-11-20 02:39:30 -0500] bemu: I haven't tested small against micro personally, the smallest instance I use is the c1.medium
[2012-11-20 02:39:49 -0500] bemu: But most benchmarks on aws use sample sizes that are far too small to be taken seriously.
[2012-11-20 02:40:22 -0500] jsh: micro has more CPU than a small even according to amazon's definitions
[2012-11-20 02:40:30 -0500] jsh: but it's for bursts
[2012-11-20 02:40:41 -0500] bemu: and likewise, it can be stolen.
[2012-11-20 02:40:48 -0500] jsh: if you run it at 100% for very long, it drops precipitously
[2012-11-20 02:40:48 -0500] bemu: CPU steal on Amazon is a very real thing.
[2012-11-20 02:41:28 -0500] jsh: yeah, my perf graphs from aws are much more noisy than from my local DC hosts, and following daily patterns that don't correspond to *my* load
[2012-11-20 02:42:01 -0500] bemu: We also started measuring latency between our DCs and AWS it is some ugly stuff.
[2012-11-20 02:42:17 -0500] bemu: Plan on digging into that more soon
[2012-11-20 02:42:23 -0500] jsh: bemu: are you doing VPN to VPC?
[2012-11-20 02:42:28 -0500] bemu: Neg.
[2012-11-20 02:42:33 -0500] jcran: miah: trying to do it all in a single cookbook
[2012-11-20 02:42:33 -0500] jsh: I'm about to start testing that next week
[2012-11-20 02:42:40 -0500] rafaelmagu: We use that here
[2012-11-20 02:42:42 -0500] jcran: miah: will take a look tho, thanks for the pointer
[2012-11-20 02:42:44 -0500] bemu: Yeah, I'm going to start looking into it next week also
[2012-11-20 02:43:00 -0500] jsh: rafaelmagu: how's the performance of the VPN? latency, throughput, consistency, etc.
[2012-11-20 02:43:34 -0500] iverson0881: Before IPSEC VPN was available, i was using Vyatta to do IPSEC tunnel between my DC to VPC
[2012-11-20 02:43:45 -0500] rafaelmagu: jsh: we're hampered by NZ's normally shitty international bw
[2012-11-20 02:43:56 -0500] iverson0881: worked fairly well, latency was also fairly consistent, however you should buy a large enough instance type so that you can pass traffic properly,
[2012-11-20 02:44:07 -0500] rafaelmagu: latency is always up for us, part of the deal of being a remote island in the middle of nowhere.
[2012-11-20 02:44:09 -0500] iverson0881: most of the leg work on multi dc with high latency, is tcp window size and parallelizing
[2012-11-20 02:44:23 -0500] jcran: thing is, i need to generate a value, and use it in several places throughout several recipes. hence why i wanted to use an attribute
[2012-11-20 02:44:23 -0500] rafaelmagu: But we haven't had a single dropout with it yet
[2012-11-20 02:44:39 -0500] jsh: hmm, wonder if I can get to us-east via Internet2...<evil laugh>
[2012-11-20 02:44:55 -0500] rafaelmagu: Throughput is ok
[2012-11-20 02:45:00 -0500] rafaelmagu: Nothing to brag
[2012-11-20 02:45:09 -0500] rafaelmagu: Again, international pipe issues
[2012-11-20 02:45:27 -0500] rafaelmagu: With the new Sydney POP, though, it is looking very good
[2012-11-20 02:45:41 -0500] rafaelmagu: NZ - Australia cable lands right ON Amazon's DC
[2012-11-20 02:45:50 -0500] jsh: rafaelmagu: nice
[2012-11-20 02:45:56 -0500] bmcgee: it's almost as if they planned that...
[2012-11-20 02:45:59 -0500] bmcgee: L)
[2012-11-20 02:46:00 -0500] rafaelmagu: Hah
[2012-11-20 02:46:03 -0500] bmcgee: ah balls :)
[2012-11-20 02:46:27 -0500] rafaelmagu: Yeah, I'm gonna start investigating Sydney next week
[2012-11-20 02:46:33 -0500] bmcgee: wasn't the reason all those data centres were in batter park cos that's where the pipe came in
[2012-11-20 02:46:39 -0500] bmcgee: *battery park
[2012-11-20 02:46:41 -0500] rafaelmagu: Just putting the final touches on my Sensu Chef recipes
[2012-11-20 02:47:03 -0500] bemu: jsh: Want to share notes on VPC stuff as we dig in?
[2012-11-20 02:47:20 -0500] rafaelmagu: Then we'll start rolling in with our beta env
[2012-11-20 02:47:22 -0500] jsh: bemu: yeah, definitely
[2012-11-20 02:48:03 -0500] iverson0881: bemu: i've setup VPC before and it's fairly straightforward, however I did use Vyatta along with it and not the new IPSEC static tunnel they provide now...
[2012-11-20 02:48:28 -0500] iverson0881: bemu: wouldn't mind sharing notes either..
[2012-11-20 02:48:38 -0500] bemu: Toss me your email, I just started an email thread.
[2012-11-20 02:48:39 -0500] rafaelmagu: We got the tunnel with our Cisco gateways
[2012-11-20 02:48:44 -0500] rafaelmagu: Works perfeclty
[2012-11-20 02:49:02 -0500] rafaelmagu: (though my spelling doesn't)
[2012-11-20 02:49:04 -0500] rafaelmagu: :P
[2012-11-20 02:49:08 -0500] bemu: :)
[2012-11-20 02:49:11 -0500] jsh: we got one going with cisco too, no trouble, but the network admins were annoyed at needing to use BGP at the time
[2012-11-20 02:49:19 -0500] rafaelmagu: JSharp same here
[2012-11-20 02:49:21 -0500] jsh: that requirement has been removed now
[2012-11-20 02:49:22 -0500] rafaelmagu: oops
[2012-11-20 02:49:25 -0500] rafaelmagu: jsh: same here
[2012-11-20 02:49:28 -0500] iverson0881: damn, you got network admins
[2012-11-20 02:49:53 -0500] jsh: yeah, though it's really admin, no plural
[2012-11-20 02:49:56 -0500] bemu: hahaha, we've been looking for a good netops person for ages.
[2012-11-20 02:50:00 -0500] rafaelmagu: That BGP thing prevented us from setting up in Singapore a few months back
[2012-11-20 02:50:25 -0500] jsh: only one on the team could really cope with BGP at all
[2012-11-20 02:50:30 -0500] bemu: But experience with BGP is crucial -- we'd like to start looking into anycast for proxies.
[2012-11-20 02:50:47 -0500] jsh: bemu: same here
[2012-11-20 02:51:03 -0500] rafaelmagu: we go to sister company for netadmins
[2012-11-20 02:51:08 -0500] jsh: best offer I got was maybe carving off a /24 closer to our peers
[2012-11-20 02:51:10 -0500] rafaelmagu: They're a Cisco shop
[2012-11-20 02:51:16 -0500] jsh: *not* what I was asking for :)
[2012-11-20 02:51:26 -0500] rafaelmagu: hahaha
[2012-11-20 02:51:44 -0500] rafaelmagu: Main network guy was explaining to me the BGP thing with Amazon
[2012-11-20 02:51:55 -0500] rafaelmagu: I was paying attention to the flies on the wall
[2012-11-20 02:52:47 -0500] rafaelmagu: Takes a bit of time to actually get the whole concept
[2012-11-20 02:53:08 -0500] bemu: I'd be totally keen on learning, but there is so much else to do.
[2012-11-20 02:53:25 -0500] rafaelmagu: Yeah
[2012-11-20 02:53:33 -0500] rafaelmagu: I've always wanted to dig a bit into networking side
[2012-11-20 02:53:52 -0500] rafaelmagu: But I veered off that path ages ago
[2012-11-20 03:01:58 -0500] bmcgee: so for anyone interested simplest way to fix the rvm issue with chef-client is to simply add chef client to the list of global gems for rvm :)
[2012-11-20 03:02:05 -0500] bmcgee: my knife ssh is now also working
[2012-11-20 03:02:11 -0500] bmcgee: :D
[2012-11-20 03:02:21 -0500] bmcgee: now to figure out why the users recipe isn't working :(
[2012-11-20 03:03:35 -0500] bmcgee: scratch that, users recipe is working :D:D
[2012-11-20 03:03:41 -0500] bmcgee: *:D :D
[2012-11-20 03:03:49 -0500] bmcgee: ah fecking balls, you get what i mean
[2012-11-20 03:05:00 -0500] rafaelmagu: Hahaha
[2012-11-20 03:27:47 -0500] bmcgee: here's an interesting question. I have just added the openvpn::users recipe to auto generate client keys. Said keys are sitting on a box with my vpn role. What would the knife fu look like to copy the keys down to my local machine. note: there is an attribute node['openvpn']['key_dir']
[2012-11-20 03:28:46 -0500] bmcgee: it would be nice if it could stick the key in the users data bag. It's encrypted so relatively safe. might fork the cookbook
[2012-11-20 03:31:21 -0500] bmcgee:   /help
[2012-11-20 03:31:36 -0500] bmcgee: balls again
[2012-11-20 03:40:51 -0500] chefologist: hi, I want to start building my own cookbooks in prep for hosted-chef, do I clone opscode/chef-repo as a starting point, then .... ?
[2012-11-20 03:41:34 -0500] ptrstr: chefologist: yes
[2012-11-20 03:42:03 -0500] chefologist: ptrstr: do I then push/commit/merge to my own git account?
[2012-11-20 03:42:30 -0500] ptrstr: bmcgee: why use knife if you can just scp/rsync the user files from that host?
[2012-11-20 03:43:13 -0500] ptrstr: chefologist: yes, just change git config
[2012-11-20 03:43:43 -0500] ptrstr: chefologist: or fork it first in your github account
[2012-11-20 03:44:37 -0500] chefologist: ptrstr: ok just forked it
[2012-11-20 03:45:06 -0500] chefologist: ptrstr: ha! now I have git.account/chef-repo
[2012-11-20 03:52:14 -0500] chefologist: ptrstr:  so now I have forked the repo, what next, is there any doco on it?
[2012-11-20 04:03:31 -0500] chefologist: after forking chef-repo from git, how do I connect my github account to my ubuntu chef client?  assistance would be great :)
[2012-11-20 04:06:23 -0500] jwcarman: I am trying to run through the "Java Web Stack" tutorial and it looks like my first EC2 node is failing on the "create_db" on resource "mysql_database[create dbapp_production]"
[2012-11-20 04:06:31 -0500] jwcarman: Has anyone seen that before?
[2012-11-20 04:07:55 -0500] jwcarman: The LoadError is "cannot load such file -- mysql"
[2012-11-20 04:37:10 -0500] jberanek: Question: does the omnibus installer for Chef on RHEL platforms require internet access to install (after you complete the initial sh script)? Looking for a simple installation solution for Chef Solo on an isolated network without internet connection.
[2012-11-20 04:38:39 -0500] matschaffer: jberanek: I seem to recall seeing the script download/install an rpm
[2012-11-20 04:38:51 -0500] matschaffer: might be worth running with set +x to see if that's accurate
[2012-11-20 04:39:00 -0500] matschaffer: if it is maybe you could just install the rpm?
[2012-11-20 04:40:49 -0500] jberanek: Ok, now that I'm smart enough to look, there is actually a download option for the RPM in addition to the script to download the RPM. Thanks for the prodding
[2012-11-20 05:27:54 -0500] matschaffer: is there a clean way to copy a file in chef? tried remote_file with source as "/path/to" source but didn't seem to work. Sorry if this is a silly question. Getting kinda late here :)
[2012-11-20 05:37:57 -0500] chefologist: so I want to start writing my own chef cookbooks, where is the best place to start?  thanks
[2012-11-20 05:52:57 -0500] BryanWB_: ohai chefs!
[2012-11-20 06:00:00 -0500] solarce: chefologist: http://wiki.opscode.com/display/chef/Guide+to+Creating+A+Cookbook+and+Writing+A+Recipe and http://wiki.opscode.com/display/chef/Cookbooks#Cookbooks-HowdoIcreateanewCookbook%3F
[2012-11-20 06:01:08 -0500] chefologist: solarce: thanks ... can you explain why I would have a cookbook chef-repo and push changes to git...I am trying understand why as I am using hosted-chef
[2012-11-20 06:01:54 -0500] solarce: chefologist: it's just a good a good development workflow
[2012-11-20 06:02:29 -0500] solarce: chefologist: you make a lot of changes to a cookbook you want to snapshot as you go, but you're not ready to 'knife cookbook upload FOO' and put it into use yet
[2012-11-20 06:02:51 -0500] solarce: chefologist: git commit -a -m "message" early and often ;)
[2012-11-20 06:02:54 -0500] BryanWB_: reminder: we have got a G+ hangout today (Nov 20) at 20:00 UTC, come with questions on Chef
[2012-11-20 06:03:14 -0500] chefologist: solarce: I understand, but how do I integrate my ~/.chef directories with my github account?
[2012-11-20 06:03:28 -0500] BryanWB_: chefologist:  here is a picture of my workflow
[2012-11-20 06:03:29 -0500] BryanWB_: http://4.bp.blogspot.com/-wA-o8Yb48Ho/UJ6LWe4qkBI/AAAAAAAAEyg/-wfzozl1s6w/s1600/cookbook_life_cycle.png
[2012-11-20 06:04:11 -0500] BryanWB_: chefologist: i don't put those dirs in my github account as I have some private info in there, just like I don't put my ~/.ssh into github
[2012-11-20 06:04:27 -0500] BryanWB_: but u could put it into a separate "dotfiles" repo
[2012-11-20 06:05:06 -0500] solarce: chefologist: you clone a repo you've made and you put your cookbooks into it
[2012-11-20 06:05:51 -0500] chefologist: BryanWB_: lol at gangnam style, however, I have been following the opscode site to use knife to upload my cookbooks to hosted-chef.... I am struggling with how/why I should use git in the mix
[2012-11-20 06:05:56 -0500] solarce: chefologist: http://wiki.opscode.com/display/chef/Fast+Start+Guide#FastStartGuide-Step3%3AConfigureChefandcreatetheneededdirectories
[2012-11-20 06:06:19 -0500] BryanWB_: chefologist: u use git to track your changes to your cookbooks and repo
[2012-11-20 06:06:33 -0500] BryanWB_: just as u would w/ any other software project
[2012-11-20 06:06:43 -0500] chefologist: ok, I thought hosted-chef kept a track of those changes?
[2012-11-20 06:06:46 -0500] solarce: chefologist: I'm doing the full blown chef repo, cloned from the opscode one, as my source of roles and cookbooks
[2012-11-20 06:09:11 -0500] chefologist: solarce: ok I think it is a little clearer, I am interacting with hosted-chef out of ~/.chef locally.  so I should git clone what exactly? and push to where exactly?
[2012-11-20 06:10:21 -0500] chefologist: solarce: I am also using vagrant which calls the ~/.chef directory when I build a new box
[2012-11-20 06:10:42 -0500] solarce: chefologist: read through http://wiki.opscode.com/display/chef/Workstation+Setup
[2012-11-20 06:14:00 -0500] chefologist: solarce: thanks
[2012-11-20 06:38:47 -0500] solarce: hrm, i suspect i may be contributing some tweaks to https://github.com/opscode-cookbooks/php/blob/master/recipes/package.rb for amazon linux tomorrow
[2012-11-20 06:49:28 -0500] solarce: or sooner https://github.com/opscode-cookbooks/php/pull/12 :D
[2012-11-20 06:56:47 -0500] vaq: is it possible to create a data_bag from a recipe ?
[2012-11-20 07:00:39 -0500] aruntomar: vaq: is your node also your workstation?
[2012-11-20 07:02:04 -0500] vaq: no, I just made the client admin, and I was unable to create the databag using Chef::DataBag.new
[2012-11-20 07:02:19 -0500] vaq: however I am a little unsure on how to add a entry to the data bag, can you give me an example?
[2012-11-20 07:03:58 -0500] aruntomar: vaq: databag is just a json file, so creating it either by copying from a recipe or via some logic should be possible. but if your node is not a workstation, then you won't be able to upload it to the chef server, assuming you are using chef server and not chef solo.
[2012-11-20 07:04:44 -0500] vaq: sorry, I misunderstood, I am deploying a recipe on the chef server, so the answer to your first question is yes
[2012-11-20 07:07:51 -0500] vaq: how can I create an item?
[2012-11-20 07:10:58 -0500] aruntomar: vaq: i've used the methods mentioned in the url to create databags:  http://docs.opscode.com/essentials_data_bags_create.html
[2012-11-20 07:11:32 -0500] vaq: but I want to create items in a data bag from a recipe
[2012-11-20 07:25:25 -0500] vaq: anyone?
[2012-11-20 07:33:20 -0500] aruntomar: vaq: ok, so you can use Chef::DataBagItem to add items to your data bag
[2012-11-20 07:35:06 -0500] vaq: what is the function for delete?
[2012-11-20 07:35:08 -0500] vaq: Chef::DataBagItem.del ?
[2012-11-20 07:38:31 -0500] ssd7: vaq: Once you have an instance of Chef::DataBagItem you can just call the destroy method on it
[2012-11-20 07:44:27 -0500] aruntomar: vaq: check out this example https://gist.github.com/4116618
[2012-11-20 08:47:34 -0500] Tensibai: Hi
[2012-11-20 08:48:55 -0500] Tensibai: I've somethign 'strange', having atrtibutes in environment, role and cookbook I end up with a strange loop where my attributes gets in a kind of loop
[2012-11-20 08:50:20 -0500] Tensibai: like this: https://gist.github.com/4116803
[2012-11-20 08:50:30 -0500] Tensibai: If someone can point me to what's wrnog with it
[2012-11-20 09:10:33 -0500] chefologist: hi, I am following http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks ... and it is working well, how do I push my changes up to my own git account? regards
[2012-11-20 09:13:40 -0500] joonas: chefologist: http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks#WorkingwithGitandCookbooks-RemoteRepositories
[2012-11-20 09:13:59 -0500] joonas: you'd want to create a repository under your own account
[2012-11-20 09:14:07 -0500] joonas: (or you could even fork the repo off opscode's)
[2012-11-20 09:15:18 -0500] chefologist: I have forked it from chef-repo, is that correct?
[2012-11-20 09:15:24 -0500] joonas: sure
[2012-11-20 09:21:49 -0500] chefologist: git status ..... Your branch is ahead of 'origin/master' by 4 commits.  .... how do I ensure my git repo has been updated? cheers
[2012-11-20 09:25:56 -0500] corp: chefologist: git push
[2012-11-20 09:26:07 -0500] chefologist: ok I did a git remote add github ... my git account then did: git push github master and received this: To http://github.com/githubble/chef-repo.git    a3bec38..46341af  master -> master
[2012-11-20 09:26:17 -0500] corp: so you're all good then
[2012-11-20 09:26:31 -0500] chefologist: however, when I run git status it still says this: Your branch is ahead of 'origin/master' by 4 commits.
[2012-11-20 09:26:39 -0500] chefologist: why is this... thanks for helping a newbie
[2012-11-20 09:28:26 -0500] corp: chefologist: origin and github are different remotes here
[2012-11-20 09:28:40 -0500] corp: chefologist: can you show the contents of .git/config?
[2012-11-20 09:29:06 -0500] corp: you may just wnat 'origin' to point to github. not sure where it's pointing now
[2012-11-20 09:30:08 -0500] chefologist: git://gist.github.com/4116955.git
[2012-11-20 09:31:59 -0500] chefologist: corp: any clues?
[2012-11-20 09:32:47 -0500] corp: OK, what you want to do is fork the repo on github itself
[2012-11-20 09:33:10 -0500] corp: http://github.com/opscode/chef-repo, go there and hit the fork button
[2012-11-20 09:33:26 -0500] corp: then you can check out your forked copy from the URL provided by github
[2012-11-20 09:34:16 -0500] chefologist: corp: it says already forked to githubble, go to fork now ...
[2012-11-20 09:34:20 -0500] corp: ah, i see yours is forked
[2012-11-20 09:34:41 -0500] corp: in that case, you can just do: git clone git@github.com:githubble/chef-repo.git
[2012-11-20 09:35:25 -0500] corp: either do that (easier), or edit .git/config and make 'origin' point to that URL, and remove the github entry
[2012-11-20 09:35:42 -0500] chefologist: also my pem files are in there, how do I make my repo private?
[2012-11-20 09:36:11 -0500] corp: github admin section
[2012-11-20 09:36:14 -0500] Mithrandir: you pay github money, then you mark it as private.
[2012-11-20 09:36:19 -0500] corp: but you'll need  a paid  account
[2012-11-20 09:36:45 -0500] chefologist: hmmm ok thats a little disconcerting, as pems should be hidden
[2012-11-20 09:37:05 -0500] corp: chefologist: you don't have to keep it in the repo
[2012-11-20 09:37:19 -0500] corp: you can use .gitignore to not include them
[2012-11-20 09:37:20 -0500] chefologist: anyway, can you advise where I run the git clone, above the ~/chef-repo folder or nit it?
[2012-11-20 09:37:30 -0500] chefologist: corp I prefer not too
[2012-11-20 09:37:38 -0500] corp: chefologist: just move the old chef repo out of the way, then clone the new one
[2012-11-20 09:38:24 -0500] corp: you dont have to use github either. you can store your git repo anywhere
[2012-11-20 09:38:30 -0500] corp: if you dont want to pay
[2012-11-20 09:42:03 -0500] chefologist: corp: I have deleted my repo, as I have a paid account, but it won't let me fork to a private?
[2012-11-20 09:43:11 -0500] corp: chefologist: https://help.github.com/articles/duplicating-a-repo
[2012-11-20 09:43:30 -0500] corp: looks like you have to duplicate to create a private repo forked from a public one.
[2012-11-20 09:44:35 -0500] corp: i'm out for now!
[2012-11-20 09:47:26 -0500] chefologist: hi, I just followed duplicating a repo.... receiving this: fatal: https://github.com/impactdata/chef-repo.git/info/refs not found: did you run git update-server-info on the server?
[2012-11-20 09:55:01 -0500] chefologist: hi, I just followed duplicating a repo.... receiving this: fatal: https://github.com/impactdata/chef-repo.git/info/refs not found: did you run git update-server-info on the server? any assistance would be fantastic
[2012-11-20 09:59:38 -0500] chefologist: all good, the mirror site is CAseSensTIVe ... :)
[2012-11-20 10:07:18 -0500] chefologist: hi, how do I download the full suite of opscode cookbooks via knife? cheers
[2012-11-20 10:21:55 -0500] railsraider: i want to set another node attribute from a recipe how do i save that?
[2012-11-20 10:22:25 -0500] aruntomar: chefologist: knife cookbook site list, loop over the cookbook and download knife cookbook site install <cb name>.
[2012-11-20 10:22:57 -0500] chefologist: also, can I either download or delete my cookbooks on hosted-chef?
[2012-11-20 10:23:02 -0500] railsraider: i get a Net::HTTPServerException: 403 "Forbidden" when i attempt to save the node
[2012-11-20 10:23:49 -0500] aruntomar: chefologist: yes, you can.
[2012-11-20 10:24:05 -0500] chefologist: aruntomar: can you please advise how
[2012-11-20 10:24:08 -0500] aruntomar: railsraider: paste the code to gist or pastebin
[2012-11-20 10:24:46 -0500] aruntomar: chefologist: knife cookbook download <cb name>
[2012-11-20 10:25:02 -0500] aruntomar: knife cookbook delete COOKBOOK VERSION (options)
[2012-11-20 10:26:47 -0500] railsraider: aruntomar: http://pastie.org/private/bcililgbyrjtgwccvwi6aq
[2012-11-20 10:26:59 -0500] chefologist: aruntomar: I want to clean up my cookbooks on hosted-chef ... is this possible, if so how?
[2012-11-20 10:27:27 -0500] railsraider: basically what i'm trying to do is set the node attribute if it doesn't exist
[2012-11-20 10:27:30 -0500] railsraider: and save it
[2012-11-20 10:27:40 -0500] aruntomar: chefologist: knife cookbook bulk delete REGEX (options)
[2012-11-20 10:29:57 -0500] chefologist: aruntomar: I don't want to delete what is on my chef-client, only hosted-chef... assistance would be great
[2012-11-20 10:31:54 -0500] aruntomar: railsraider: afaik you should be using node.host.set/save rather host.node.set/save, try that out.
[2012-11-20 10:33:12 -0500] chefologist: aruntomar: that did not delete my hosted-chef cookbooks
[2012-11-20 10:33:58 -0500] aruntomar: chefologist: i understand. chef-client is node, workstation is from where you control/fire knife commands. knife cookbook delete will remove/delete the cookbooks from the chef server hosted/open source, which ever is mentioned in knife.rb : chef_server_url
[2012-11-20 10:34:39 -0500] aruntomar: chefologist: is ur cookbook name is "hosted-chef"
[2012-11-20 10:34:40 -0500] aruntomar: ?
[2012-11-20 10:35:24 -0500] aruntomar: chefologist: please paste the output of 'knife cookbook list'
[2012-11-20 10:35:55 -0500] chefologist: aruntomar: apt               1.4.0   bluepill          1.0.2   build-essential   1.0.0   chef-redis        1.0.4   fast_start        0.1.0   git               0.10.0   memcached         1.0.2   nginx             0.100.2   openssl           1.0.0   postgresql        1.0.0   ruby_build        0.6.2   runit             0.15.0   rvm               0.0.4   unicorn           1.0.0   yum               0.5.2
[2012-11-20 10:36:20 -0500] chefologist: I want to remove fast_start and chef-redis
[2012-11-20 10:37:40 -0500] aruntomar: chefologist: knife cookbook delete fast_start
[2012-11-20 10:37:54 -0500] aruntomar: knife cookbook delete chef-redis
[2012-11-20 10:38:54 -0500] chefologist: aruntomar: perfect thank-you
[2012-11-20 10:40:05 -0500] aruntomar: chefologist: welcome :)
[2012-11-20 11:12:10 -0500] maruq: hi guys. anybody know how to specify the version of chef-client when using knife ec2 server create?
[2012-11-20 11:12:34 -0500] maruq: -d flag seems to allow you to specify method, but no gem version (unless I've misread)
[2012-11-20 11:20:12 -0500] masterkorp: ohai chefs
[2012-11-20 11:20:15 -0500] masterkorp: http://i.imgur.com/j4mGP.jpg?1
[2012-11-20 11:23:24 -0500] railsraider: aruntomar: the host in my loop is simply the current iteration of the search results, problem is it does not allow me to save
[2012-11-20 11:23:46 -0500] railsraider: how can i save another node attribute from the recipe
[2012-11-20 12:00:32 -0500] geewiz: Cheers!
[2012-11-20 12:17:49 -0500] geewiz: I'd like to discuss a behaviour of the Opcode cookbook for Nagios. Any users of this cookbook here?
[2012-11-20 12:29:18 -0500] maruq: geewiz: potentially. I'm not actively using it yet, but it's in the librarian file
[2012-11-20 12:29:24 -0500] maruq: what's up?
[2012-11-20 12:31:10 -0500] geewiz: I'm a bit unsure about the way the cookbook maps hostgroups.
[2012-11-20 12:31:29 -0500] geewiz: Currently, it maps the roles in the node's runlist to hostgroups.
[2012-11-20 12:32:17 -0500] geewiz: Our infrastructure is quite complex, and we have a whole hierarchy of roles, for example the "mysql-slave" role has the more generic "mysql-server" in its runlist.
[2012-11-20 12:32:50 -0500] geewiz: The cookbook would not create a "mysql-server" hostgroup, since it takes only the explicitly named roles in the node's runlist.
[2012-11-20 12:33:34 -0500] geewiz: That's why I've replaced "node.runlist.roles" with "node.roles", which contains _all_ the node's roles, direct and indirect.
[2012-11-20 12:33:57 -0500] geewiz: I just wonder if we're an edge case or if it would be reasonable to send this change as a pull request.
[2012-11-20 12:37:17 -0500] maruq: geewiz: I'm not really using things to that degree yet, so can't really comment yet, sorry
[2012-11-20 12:37:33 -0500] geewiz: maruq: Thanks anyway!
[2012-11-20 12:40:42 -0500] maruq: geewiz: no worries
[2012-11-20 12:41:05 -0500] maruq: anyone know stuff about knife bootstrap?
[2012-11-20 12:41:25 -0500] maruq: according to http://wiki.opscode.com/display/chef/Knife+Bootstrap there's some gem options.
[2012-11-20 12:41:53 -0500] maruq: according to https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/ubuntu12.04-gems.erb there's a bootstrap_version_string. how do I pass that in?
[2012-11-20 12:49:18 -0500] maruq: my bad, there's a --bootstrap-version. RTFM ;)
[2012-11-20 13:06:20 -0500] emiles: hey everyone. i am having some trouble understanding something. i am using the php cookbook from opscode-cookbooks with vagrant
[2012-11-20 13:06:29 -0500] emiles: now i want it to install mysqli
[2012-11-20 13:06:44 -0500] emiles: do i modify the cookbook or can that be accomplished through configuration?
[2012-11-20 13:08:25 -0500] Holos: Hi, just getting started with Chef and I have my first recipie done, but I want to create one for deploying users home directories, so I'm using the https://github.com/fnichol/chef-user/blob/master/README.md recipie.. But I'm a little unsure how to assign each node's attributes of the users to be configured on the node/environment. It says to create an attribute of node['users'] = ['hsolo'], but where do I add this?
[2012-11-20 13:09:16 -0500] kreedy: geewiz: i'm not using that cookbook, but i know i probably would have made the exact same change. i'd submit a pull request for it
[2012-11-20 13:10:23 -0500] geewiz: kreedy: So I'm not alone. :-) Okay, I'll do that then. Thanks!
[2012-11-20 13:10:30 -0500] kreedy: np
[2012-11-20 13:10:37 -0500] corp: Holos: you can add this in a role or the node itself
[2012-11-20 13:11:26 -0500] geewiz: Holos: Since you'll probably have more than one server where you need the account, I'd choose a role.
[2012-11-20 13:11:48 -0500] corp: Holos: in the attributes, that is. default_attributes "users" => ['hsolo']
[2012-11-20 13:26:26 -0500] corp: anyone using the opscode application recipe?
[2012-11-20 13:26:37 -0500] corp: i'm confused as to the actual state of deprecation for unicorn, rails, etc
[2012-11-20 13:36:16 -0500] Tensibai: Back here with my problem: atrtibutes defined as default in  cookbook, override in env and in a role ends up with a strange infinite loop
[2012-11-20 13:36:20 -0500] Tensibai: like this: https://gist.github.com/4116803
[2012-11-20 13:36:37 -0500] Tensibai: Can someone help me troubleshoot that ot point me to what I do wrong ?
[2012-11-20 13:42:25 -0500] corp: Tensibai: you should post your environment and role files too
[2012-11-20 13:43:00 -0500] Tensibai: Ok, I'll wipe out passwords  ;)
[2012-11-20 13:43:19 -0500] Tensibai: mainly the common part is the top attribute sterling
[2012-11-20 13:43:31 -0500] Tensibai: under wich I store everything I need after
[2012-11-20 13:47:02 -0500] Tensibai: Hum.. I think I got it: default in env and cookbook are merged right ?
[2012-11-20 13:47:18 -0500] Tensibai: Changing my env attribute to override should solve my prob I think
[2012-11-20 13:47:27 -0500] Tensibai: But I'll complete the gist anyway
[2012-11-20 13:50:22 -0500] wassy121: So, I come in to work today, to find that couchdb has stopped.  Again :(
[2012-11-20 13:50:34 -0500] wassy121: Stupid logs give me nothing.
[2012-11-20 13:55:50 -0500] bradgignac: corp: yeah, i'm using it
[2012-11-20 13:56:39 -0500] Tensibai: Ok here is the complete gist with all files involved: https://gist.github.com/4118081
[2012-11-20 13:58:08 -0500] masterkorp: RAAAAWWWRR
[2012-11-20 14:02:46 -0500] mattp: wassy121: do you have any form of graphing or monitoring on the server.  Runnig out of RAM, for example, might bring out the kernel's OOM killer. Is there anything in any of the syslog destination related to this?
[2012-11-20 14:04:38 -0500] wassy121: mattp, thanks for ideas.  I'm looking through the syslog, nothing apparent in the 30 minutes between last chef-client success and first failure (it fails authentication).  Cron.daily hadn't run to rotate the logs, nothing about oom.
[2012-11-20 14:05:00 -0500] wassy121: Let me check sar though, see how ram and whatnot were doing (this is on a VM, so I guess it could have run out)
[2012-11-20 14:06:35 -0500] masterkorp: wassy121: man, icinga that shit
[2012-11-20 14:06:37 -0500] masterkorp: and munin
[2012-11-20 14:07:28 -0500] wassy121: we're doing openNMS, but that isn't implemented yet.  It's just a testing box still.
[2012-11-20 14:07:47 -0500] wassy121: Will do though, for sure.  I know it's important to monitor that stuff.
[2012-11-20 14:08:59 -0500] masterkorp: for a quick temp thing you can use the nagios cookbook
[2012-11-20 14:09:10 -0500] masterkorp: sets up basic monitoring in a matter or seconds
[2012-11-20 14:22:13 -0500] geekbri: Depends what you want to monitor.  A lot of Monitoring SaaS service will let you monitor a server or two for free :)  Could always do that
[2012-11-20 14:22:27 -0500] geekbri: as a quick stop gap for a single server.
[2012-11-20 14:23:41 -0500] siezer: knife cookbook site search kde ; no results. awesome. I'm going to write a recipe that only works on slackware just to troll the ubuntu people.
[2012-11-20 14:24:05 -0500] masterkorp: siezer: ahah
[2012-11-20 14:28:37 -0500] wassy121: masterkorp, geekbri, So, it was indeed being monitored, I just found it in our openNMS setup.  It doesn't monitor enough, due to SNMP misconfig, so I'll just have to catch it next week (seems to be a weekly thing).
[2012-11-20 14:29:05 -0500] wassy121: And no external monitoring, this thing is all internal and firewalled to the teeth
[2012-11-20 14:30:29 -0500] masterkorp: heh
[2012-11-20 14:34:44 -0500] Tensibai: well still noone who can help me with my "loop" problem ? (gist here: https://gist.github.com/4118081 )
[2012-11-20 14:42:03 -0500] wassy121: Tensibai, is that current chef 0.16.2?
[2012-11-20 14:42:28 -0500] Tensibai: wassy121: yes, server and client
[2012-11-20 14:51:00 -0500] Tensibai: rooohhhh
[2012-11-20 14:51:11 -0500] Tensibai: des gars qui ont compris .... canopsis: neb2amqp
[2012-11-20 14:51:22 -0500] Tensibai: oops sorry
[2012-11-20 14:51:31 -0500] Tensibai: (wrong chan)
[2012-11-20 15:08:24 -0500] khimera: Hi, newb question if anyone can guide me here. I setup a data bag for my application web server. I also setup a role for my specific application that runs a "app" recipe. How can i pass some type of variable to the recipe so that it pulls the correct data bag? Would  node.run_state[:app] = "myapp" in the role work?
[2012-11-20 15:14:09 -0500] jflowers: in a cookbook how do I get the path to a template
[2012-11-20 15:14:18 -0500] jflowers: I want to do this from some ruby code
[2012-11-20 15:14:52 -0500] gchristensen: jtimberman: https://github.com/opscode-cookbooks/java/compare/1.6.0...1.6.2#L2R50 release v1.6.2 introduces an incorrect download URL for i586, java v6
[2012-11-20 15:15:06 -0500] jflowers: I would like to iterate over some templates conditionally executing on them
[2012-11-20 15:16:26 -0500] jflowers: Dir.glob("/path/to/templates/*#{variable}*") do |tmplt|
[2012-11-20 15:16:49 -0500] jflowers: then call the template resource in that block
[2012-11-20 15:17:04 -0500] jflowers: but I don't know the path to find the templates....
[2012-11-20 15:17:25 -0500] barnacles: gchristensen: did you set default['java']['oracle']['accept_oracle_download_terms'] to true?
[2012-11-20 15:18:01 -0500] barnacles: ouf nvm
[2012-11-20 15:18:02 -0500] barnacles: I see it
[2012-11-20 15:18:53 -0500] gchristensen: barnacles: I don't use the java cookbook for anything, and I'm not having problems with it, just something I noticed
[2012-11-20 15:29:26 -0500] jflowers: is there a variable already defined in a recipe, a defualt var, that contains the path to the current recipe?
[2012-11-20 15:29:30 -0500] jflowers: or cookbook
[2012-11-20 15:30:07 -0500] jflowers: or meta data about the current cookbook that would allow me to put together the path?
[2012-11-20 15:41:11 -0500] jflowers: Duh! I forgot about __FILE__
[2012-11-20 15:41:29 -0500] jflowers: File.dirname(__FILE__) + '../templates'
[2012-11-20 15:44:54 -0500] specialsauce: you forgot about DRE
[2012-11-20 15:52:11 -0500] n-other: hello everyone! looking for help with chef setup for ceph...
[2012-11-20 15:53:02 -0500] n-other: I deployed a server and 3 nodes according to the http://eu.ceph.com/docs/v0.50/config-cluster/chef/
[2012-11-20 15:54:03 -0500] n-other: however running chef-client from any nodes gives INFO: HTTP Request Returned 412 Precondition Failed: {"non_existent_cookbooks":["ceph","ceph","ceph","ceph"],"cookbooks_with_no_versions":[],"message":"Run list contains invalid items: no such cookbooks ceph, ceph, ceph, ceph."}
[2012-11-20 15:54:18 -0500] Virunga: Hi, i get an exception because chef-client can't find a role, but the role is on the server, it appears inside the list of roles. How can i find what's wrong? I looked all the logs...
[2012-11-20 15:55:03 -0500] n-other: the whole output http://pastebin.com/WiMJwn69
[2012-11-20 15:55:40 -0500] n-other: chef@cephgw:~$ knife cookbook list   apache2          1.3.1   ceph-cookbooks   0.0.10
[2012-11-20 15:57:11 -0500] Virunga: n-other: knife cookbook list what says?
[2012-11-20 15:57:49 -0500] Virunga: n-other: maybe there's an error somewhere inside the cookbook files.
[2012-11-20 15:58:05 -0500] n-other: just posted it in there
[2012-11-20 15:58:10 -0500] n-other: 2 cookbooks
[2012-11-20 15:58:15 -0500] n-other: apache2
[2012-11-20 15:58:19 -0500] n-other: and ceph-cookbooks
[2012-11-20 15:59:23 -0500] gkarekinian: It's looking for a cookbook called "ceph", not "ceph-cookbooks"
[2012-11-20 15:59:33 -0500] n-other: yep, I got it.
[2012-11-20 15:59:44 -0500] n-other: does it mean cookbook is incorrect?
[2012-11-20 16:00:46 -0500] Virunga: Maybe.
[2012-11-20 16:01:08 -0500] Virunga: Knife log should tell you that...
[2012-11-20 16:02:41 -0500] barnacles: The cookbooks you downloaded look correct, the documentation you're following might be incorrect. Like someone stated above: use ceph-cookbooks instead of ceph when adding the recipes to your run_list
[2012-11-20 16:03:33 -0500] barnacles: recipe[ceph::apt] would become recipe[ceph-cookbooks::apt]
[2012-11-20 16:03:49 -0500] n-other: hmm
[2012-11-20 16:03:52 -0500] n-other: looks obvious
[2012-11-20 16:03:55 -0500] n-other: thanks
[2012-11-20 16:03:56 -0500] n-other: let me try
[2012-11-20 16:03:57 -0500] n-other: ...
[2012-11-20 16:15:00 -0500] n-other: looks like I found a problem
[2012-11-20 16:15:03 -0500] n-other: the cookbook
[2012-11-20 16:15:11 -0500] n-other: has incorrect roles
[2012-11-20 16:15:19 -0500] n-other: run_list(         'recipe[ceph::mds]' )
[2012-11-20 16:15:31 -0500] n-other: this is defined in roles/mds.rb
[2012-11-20 16:15:55 -0500] n-other: it should be recipe[ceph-cookbooks::mds]
[2012-11-20 16:16:01 -0500] n-other: to match cookbook name
[2012-11-20 16:16:28 -0500] n-other: all roles contain incorrect cookbook names
[2012-11-20 16:16:56 -0500] n-other: one more question here
[2012-11-20 16:17:05 -0500] n-other: I made an update to the role file
[2012-11-20 16:17:51 -0500] n-other: however chef-client is still claiming it cannot find 'ceph'  cookbook
[2012-11-20 16:18:25 -0500] n-other: is there any command to 'refresh' a role? looks like it's getting old one somehow
[2012-11-20 16:19:28 -0500] Virunga: n-other: do you mean uploading the modified role on the server?
[2012-11-20 16:19:33 -0500] n-other: no
[2012-11-20 16:19:38 -0500] n-other: it's on the server
[2012-11-20 16:20:06 -0500] n-other: now roles/mds.rb has corrected recipe -- 'recipe[ceph-cookbooks::mds]'
[2012-11-20 16:20:24 -0500] n-other: however client still claims 'ceph' cookbook is missing
[2012-11-20 16:21:55 -0500] gyre008: you might want to check dependencies in metadata.rb
[2012-11-20 16:21:56 -0500] n-other: INFO: Run List is [recipe[ceph-cookbooks::apt], role[ceph-mds]]
[2012-11-20 16:22:05 -0500] n-other: INFO: Run List expands to [ceph-cookbooks::apt, ceph::mds]
[2012-11-20 16:22:39 -0500] n-other: i.e. it expands role[ceph-mds] to ceph::mds
[2012-11-20 16:22:43 -0500] n-other: hmm..
[2012-11-20 16:22:59 -0500] n-other: let me check what's included in that file
[2012-11-20 16:23:46 -0500] n-other: nope, it depends only on apache
[2012-11-20 16:23:51 -0500] n-other: cookbook
[2012-11-20 16:23:57 -0500] n-other: which is present
[2012-11-20 16:24:26 -0500] zts: n-other: do you see the change if you run "knife role show ceph-mds" ?
[2012-11-20 16:25:31 -0500] n-other: hmm
[2012-11-20 16:25:35 -0500] n-other: it's wierd
[2012-11-20 16:25:41 -0500] n-other: it still shows old one
[2012-11-20 16:25:49 -0500] n-other: run_list:             recipe[ceph::mds]
[2012-11-20 16:26:03 -0500] n-other: from knife role show ceph-mds
[2012-11-20 16:26:56 -0500] n-other: but grep -ir 'ceph::mds' * doesn't show any other links except for README for the cookbook
[2012-11-20 16:27:39 -0500] n-other: heh
[2012-11-20 16:27:45 -0500] n-other: I think I got it
[2012-11-20 16:27:55 -0500] n-other: let me see
[2012-11-20 16:27:56 -0500] n-other: ...
[2012-11-20 16:28:54 -0500] n-other: yeahh!
[2012-11-20 16:29:05 -0500] n-other: I should have edit it through knife role edit ceph-mds
[2012-11-20 16:29:15 -0500] n-other: however I made direct update to the roles file
[2012-11-20 16:32:51 -0500] jflowers: when are templates downloaded to the client?
[2012-11-20 16:33:08 -0500] jflowers: at the same time as the recipes
[2012-11-20 16:33:11 -0500] jflowers: ???
[2012-11-20 16:33:24 -0500] jflowers: or are they donwloaded as needed?
[2012-11-20 16:34:14 -0500] masterkorp: jflowers: yes, the whole cookbook is cached at the begining of the run
[2012-11-20 16:35:46 -0500] jtimberman: gchristensen: thanks - fixed and released :0
[2012-11-20 16:35:49 -0500] jtimberman: :)
[2012-11-20 16:36:54 -0500] jtimberman: jflowers, masterkorp: templates are downloaded when there's a change required. they and cookbook_file resources aren't downloaded with the cookbook, because we don't want to download a potentially large file if we don't have to
[2012-11-20 16:37:12 -0500] jtimberman: like, say you stuck the JDK in a cookbook_file, we don't want to download that everywhere if its not needed :)
[2012-11-20 16:37:24 -0500] gchristensen: thank you jtimberman :)
[2012-11-20 16:37:39 -0500] masterkorp: jtimberman: yeah, i forgot to meantion that
[2012-11-20 16:38:03 -0500] n-other: what's correct way to modify a recipe?
[2012-11-20 16:38:15 -0500] jflowers: is there a way to force download of the templates?
[2012-11-20 16:38:23 -0500] jflowers: or to search for a template?
[2012-11-20 16:38:32 -0500] n-other: knife only allows listing it
[2012-11-20 16:38:39 -0500] n-other: or
[2012-11-20 16:38:51 -0500] n-other: how do I re-create a cache ?
[2012-11-20 16:38:54 -0500] masterkorp: jflowers: what are you trying to do ?
[2012-11-20 16:38:55 -0500] n-other: on client side
[2012-11-20 16:39:15 -0500] n-other: I made some update to the recipes
[2012-11-20 16:39:41 -0500] n-other: however I don't see those updates are reflected on the client side
[2012-11-20 16:39:42 -0500] jflowers: I want to loop over a set of templates and conditionally execute them based on some heristics
[2012-11-20 16:39:54 -0500] masterkorp: n-other: it depends, do you manage your repository with a git repo ?
[2012-11-20 16:40:26 -0500] n-other: no
[2012-11-20 16:40:44 -0500] n-other: just made exact corrections to the recipe files
[2012-11-20 16:40:53 -0500] masterkorp: jflowers: just do so: w%{template1 template2}.each do |t| template t do blab blab
[2012-11-20 16:41:09 -0500] masterkorp: n-other: how do you manage your cookbooks ?
[2012-11-20 16:41:42 -0500] jflowers: I was trying not to maintain a list of the templates
[2012-11-20 16:42:23 -0500] jflowers: I already have a list of plugin names that correspond to the template file names in various ways
[2012-11-20 16:42:49 -0500] masterkorp: can you cycle trough that ?
[2012-11-20 16:43:00 -0500] masterkorp: i would do so
[2012-11-20 16:43:18 -0500] jflowers: was trying to dynamically find the matching template like findTemplate('*#{pluginName}*)
[2012-11-20 16:43:42 -0500] lee_: hey, is there any way to get the deploy resource's cached_copy to be stored somewhere outside of "shared"?
[2012-11-20 16:43:58 -0500] n-other: hmm... actually I don't manage them ) just set up test environment according to the doc couple of hours ago
[2012-11-20 16:44:08 -0500] jflowers: if I can get the templates on disk I can: Dir.glob("#{pluginTemplatesDir}/*#{plugin}*") do |tmplt_file|
[2012-11-20 16:44:26 -0500] n-other: ceph-cookbooks is coming from someone's git repository
[2012-11-20 16:44:59 -0500] andreacampi: lee_ I don't think so
[2012-11-20 16:45:36 -0500] lee_: darn, my deploy directory is on an NFS share and is really slow. so i wanted to put the cached_copy on the local disk
[2012-11-20 16:45:38 -0500] andreacampi: deploy.destination hardcodes shared_path
[2012-11-20 16:45:50 -0500] andreacampi: lee_ you could monkey-patch it of course :)
[2012-11-20 16:46:01 -0500] lee_: andreacampi: yeah, guess thats the only option
[2012-11-20 16:46:18 -0500] andreacampi: lee_ just put it in <your-cookbook/libraries
[2012-11-20 16:46:33 -0500] lee_: cool, thanks
[2012-11-20 16:46:55 -0500] andreacampi: sure
[2012-11-20 16:47:04 -0500] masterkorp: Hmm, this of making icinga definitions a LWRP is not a bad idea
[2012-11-20 16:47:20 -0500] masterkorp: i can do icinga_command /icinga_host and so on
[2012-11-20 16:47:23 -0500] masterkorp: pretty nice
[2012-11-20 16:50:14 -0500] jtimberman: n-other: generally the work flow goes something like this: 1. On your local workstation, you set it up with a repository (or a plain directory) of the things you want to upload to the chef server - cookbooks, roles, etc. We call this a "chef-repo" and it is just a directory called "chef-repo". 2. You write or download cookbooks into the repository. You can make changes to them here. 3. You upload the cookbooks and other things from the chef rep
[2012-11-20 16:50:34 -0500] jtimberman: andreacampi: ohai :)
[2012-11-20 16:50:48 -0500] andreacampi: hey Joshua :) I haven't been on for a long time!
[2012-11-20 16:51:26 -0500] andreacampi: jtimberman BTW, are you aware of any effort to make a bento basebox for RHEL?
[2012-11-20 16:52:10 -0500] andreacampi: (I've been working on one for FreeBSD, but got stuck making the Omnibus build reliable there)
[2012-11-20 16:54:59 -0500] KarlHungus: andreacampi: where are you stuck?
[2012-11-20 16:55:08 -0500] andreacampi: libedit IIRC
[2012-11-20 16:55:12 -0500] n-other: jtimberman, within this workflow how do upload updated cookbooks to the server? via git or using some chef-related command?
[2012-11-20 16:55:17 -0500] andreacampi: won't build with the current gcc
[2012-11-20 16:56:21 -0500] jtimberman: andreacampi: RHEL? Nope.
[2012-11-20 16:56:42 -0500] andreacampi: ok, I'll probably give it a try
[2012-11-20 16:56:57 -0500] jtimberman: can you do anything on it without a subscription?
[2012-11-20 16:57:25 -0500] andreacampi: not sure :) I think so, except you don't get updates via RHN
[2012-11-20 16:57:38 -0500] andreacampi: but I have a project with $BIG_CORP
[2012-11-20 16:58:08 -0500] jtimberman: ah ha :)
[2012-11-20 16:58:43 -0500] KarlHungus: andreacampi: i need to pull about 2 months of work from opscode and make sure my stuff witll works
[2012-11-20 16:58:44 -0500] Virunga: I'm using an encrypted data bag and after loaded when i try to access to an attribute i get bad decrypt. I use the default key path and chef finds the key, what could be the problem?
[2012-11-20 16:59:01 -0500] Virunga: Obviously the key is the same i used to encrypt the data bag.
[2012-11-20 16:59:16 -0500] andreacampi: KarlHungus FreeBSD-related?
[2012-11-20 16:59:28 -0500] KarlHungus: andreacampi: https://github.com/jssjr/{bento,veewee,omnibus-ruby,omnibus-software,omnibus-chef}
[2012-11-20 16:59:46 -0500] KarlHungus: yes. i have bento building zfs root freebsd 9.0-RELEASE boxes at $dayjob
[2012-11-20 16:59:53 -0500] KarlHungus: we're still on chef 10.12 though
[2012-11-20 17:00:24 -0500] KarlHungus: i sent a bento pullreq, but like you, i didnt send the omnibus bits in yet because i hadn't polished them
[2012-11-20 17:00:28 -0500] andreacampi: KarlHungus, sweet
[2012-11-20 17:00:49 -0500] n-other: let me ask te other way around
[2012-11-20 17:01:14 -0500] n-other: contains cookbook_index with cached recipes, roles etc
[2012-11-20 17:01:40 -0500] n-other: how do I actualize it according to the updates made to the cookbook files?
[2012-11-20 17:02:18 -0500] jtimberman: KarlHungus: oh - is this you? https://github.com/opscode/bento/pull/1
[2012-11-20 17:02:19 -0500] andreacampi: KarlHungus have a look at https://github.com/opscode/bento/pull/9 and https://github.com/andreacampi/bento in case it helps I ran out of time unfortunately
[2012-11-20 17:02:38 -0500] n-other: argh
[2012-11-20 17:02:41 -0500] KarlHungus: jtimberman: yes. i have pull req #1 on bento. haha. FIRST PPOST
[2012-11-20 17:02:47 -0500] jtimberman: NICE WORK!
[2012-11-20 17:02:48 -0500] jtimberman: ;)
[2012-11-20 17:02:53 -0500] n-other: I guess chef-repo should do the job...
[2012-11-20 17:03:56 -0500] KarlHungus: andreacampi: will do. i might spend a few hours merging upstream and tidying things up over the holidays
[2012-11-20 17:04:03 -0500] KarlHungus: we need to update to latest chef at work anyhow
[2012-11-20 17:04:19 -0500] jtimberman: KarlHungus andreacampi: I'd love to have a freebsd box in bento.
[2012-11-20 17:04:22 -0500] andreacampi: KarlHungus oh it's you! so you'll see it's your stuff, just rebased and cleaned up a bit, and brought up to date
[2012-11-20 17:04:47 -0500] jtimberman: my barrier to freebsd is I have to relearn how to make a basic system functional to work with chef every time because the base install is so minimal :)
[2012-11-20 17:04:56 -0500] jtimberman: and I never really used freebsd much
[2012-11-20 17:05:04 -0500] Virunga: bye
[2012-11-20 17:05:05 -0500] andreacampi: jtimberman KarlHungus yeah, especially to make sure all that hard work to fix cookbooks doesn't go to waste because of unrelated changes :)
[2012-11-20 17:05:14 -0500] KarlHungus: andreacampi: amen to that!
[2012-11-20 17:06:02 -0500] jtimberman: :)
[2012-11-20 17:09:26 -0500] jtimberman: fyi folks, a pile of cookbooks have been released and posted to the mailing lists
[2012-11-20 17:11:29 -0500] andreacampi: yeah, saw that, good stuff :) great job
[2012-11-20 17:21:40 -0500] jtimberman: 0:11 <jtimberman> is that the one that is broken on 10.14?
[2012-11-20 17:21:40 -0500] jtimberman: 10:12 <jtimberman> i think there's a fix going to be in 10.18
[2012-11-20 17:21:40 -0500] jtimberman: 10:12 <andreacampi> yup, and 10.16.0
[2012-11-20 17:21:40 -0500] jtimberman: 10:12 <andreacampi> indeed, I tested it on master and it's good
[2012-11-20 17:21:41 -0500] jtimberman: 10:12 <jtimberman> http://tickets.opscode.com/browse/CHEF-3589
[2012-11-20 17:21:42 -0500] jtimberman: 10:12 <jtimberman> <3
[2012-11-20 17:21:44 -0500] jtimberman: bah
[2012-11-20 17:21:57 -0500] jtimberman: cats out of the bag! ;)
[2012-11-20 17:22:29 -0500] KarlHungus: btw, https://gist.github.com/4119386
[2012-11-20 17:22:36 -0500] KarlHungus: i love running that every day, jtimberman  ;)
[2012-11-20 17:23:14 -0500] jtimberman: KarlHungus: have you seen the "git up" gem?
[2012-11-20 17:23:27 -0500] jtimberman: https://rubygems.org/gems/git-up
[2012-11-20 17:23:38 -0500] KarlHungus: oooh
[2012-11-20 17:23:40 -0500] KarlHungus: nice!
[2012-11-20 17:26:29 -0500] andreacampi: that's a nice one
[2012-11-20 17:29:46 -0500] KarlHungus: ive got some freebsd cookbook love too. =) have a pull req for you, andreacampi/jtimberman https://github.com/opscode-cookbooks/freebsd/pull/3
[2012-11-20 17:30:28 -0500] andreacampi: KarlHungus cool
[2012-11-20 17:31:21 -0500] KarlHungus: i can't release my carp cookbook without those bits ;)
[2012-11-20 17:31:34 -0500] andreacampi: :)
[2012-11-20 17:33:15 -0500] jtimberman: KarlHungus: is there a ticket for that in 'fix provided'?
[2012-11-20 17:33:34 -0500] KarlHungus: um... no. give me a minute and there will be ;)
[2012-11-20 17:33:43 -0500] jtimberman: thanks :D
[2012-11-20 17:50:29 -0500] corp: jtimberman: hey hey
[2012-11-20 17:50:51 -0500] corp: jtimberman:  do you know of any newer cookbooks that manage nginx vhosts for rails/unicorn apps?
[2012-11-20 17:51:30 -0500] jtimberman: corp: application_nginx :)
[2012-11-20 17:51:36 -0500] jtimberman: and application_ruby
[2012-11-20 17:52:17 -0500] corp: jtimberman: those are deprecated, no?
[2012-11-20 17:52:39 -0500] corp: i dont actually see a 'ruby' recipe
[2012-11-20 17:52:52 -0500] atomic-penguin: corp, application is deprecated.  it was factored out into several application_ cookbooks
[2012-11-20 17:52:59 -0500] corp: oh. meh
[2012-11-20 17:53:04 -0500] corp: that actually isn't clear in the readme
[2012-11-20 17:54:24 -0500] jtimberman: the *recipes* in the application cookbook are deprecated.
[2012-11-20 17:54:32 -0500] jtimberman: with the whole data bag business.
[2012-11-20 17:54:45 -0500] jtimberman: which I'm going to merge the pull request for COOK-1820 (probably today) to remove those.
[2012-11-20 17:55:12 -0500] jtimberman: the "New Way" is to use the LWRPs provided by the application* cookbooks to declare application deployment.
[2012-11-20 17:56:08 -0500] corp: yeah i see now. thanks
[2012-11-20 18:15:30 -0500] kryptek: Hey guys, I'm trying to pull a key from my environment file into my attributes file.. 'mykey' => { 'url' => 'value' }
[2012-11-20 18:15:40 -0500] kryptek: It keeps giving me an error saying the node is not defined though
[2012-11-20 18:16:05 -0500] kryptek: Is this an issue specific to the convergence process of Chef?  How can I access that environment attribute from my cookbook attributes file?
[2012-11-20 18:18:33 -0500] ssd7_: kryptek: Currently access environment and role attributes from a cookbook attribute file doesn't work well.  You should be able to access it from a recipe though.
[2012-11-20 18:18:49 -0500] mattupstate: erikh: so upon using the "divide and conquer" techniquei found that 7 zombie processes are left behind after each manual chef-client run with an empty run_list
[2012-11-20 18:19:03 -0500] ssd7_: kryptek: This will be fixed for Chef 11.  There are some work-arounds if you really need to access in the attribute file, but they are pretty ugly
[2012-11-20 18:19:56 -0500] kryptek: Ahh.. yeah, I had moved the code to the recipe file but was bent on trying to figure it out :)
[2012-11-20 18:20:05 -0500] kryptek: thanks for the answer
[2012-11-20 18:21:00 -0500] kryptek: ssd7_,  When I try to access the environment attribute from my recipe I still get an undefined error
[2012-11-20 18:22:13 -0500] barnacles: Shot in the dark here has anyone seen a similiar error: "ERROR: Server returned error for http://localhost:4000/data, retrying 1/5 in 4s" when performing "knife upload"?
[2012-11-20 18:23:21 -0500] mobilemike: I have a value ( a token for log forwarding ) that should be uniquely set for each node.
[2012-11-20 18:24:03 -0500] mobilemike: I understand that this should likely be a normal attribute, but I'm not sure what the right _way_ to set it is.
[2012-11-20 18:24:51 -0500] mobilemike: I have to get the token for the log services' UI, so it's already a manual process.
[2012-11-20 18:24:58 -0500] wassy121: hey chefs, why would ohai not give network interfaces when run like "ssh hostname ohai", but when I log in to hostname, and run ohai, it gives the proper networking information?
[2012-11-20 18:25:42 -0500] kallistec: wassy121: probably the PATH
[2012-11-20 18:25:50 -0500] kallistec: especially on rhel
[2012-11-20 18:26:30 -0500] wassy121: It is indeed RHEL.  Well look at that
[2012-11-20 18:26:37 -0500] wassy121: It needs "ifconfig" in the PATH.
[2012-11-20 18:26:55 -0500] wassy121: Thanks for the quick response
[2012-11-20 18:26:59 -0500] kallistec: np
[2012-11-20 18:27:47 -0500] kryptek: I'm trying to access my environment attribute in my cookbook as follows:  'node.key1.key2', but it just keeps saying that it's undefined
[2012-11-20 18:27:51 -0500] kryptek: I'm totally stumped
[2012-11-20 18:28:02 -0500] kryptek: Should I be using:  node['key1']['key2'] ?
[2012-11-20 18:28:30 -0500] mattupstate: anyone else happen to get zombie processes being left behind after manual chef-client runs? I'm getting 7 zombies even with an empty run list. As a result, it seems, the system memory is getting eaten up to the point that chef-client can't run after about 7 previous runs
[2012-11-20 18:28:44 -0500] ssd7_: kryptek: It is worth a try.  Can you gist a summary of the environment, the cookbook, and the error?
[2012-11-20 18:28:53 -0500] yfeldblum: mattupstate, what are these zombies?
[2012-11-20 18:29:03 -0500] kryptek: ssd7_,  sure
[2012-11-20 18:29:22 -0500] yfeldblum: mattupstate, e.g. are these from some ohai plugin?
[2012-11-20 18:30:14 -0500] kryptek: ssd7_,  http://pastie.org/private/pc1ftrcf0duuhggyrchwdq
[2012-11-20 18:30:44 -0500] mattupstate: yfeldblum: how am i supposed to know?
[2012-11-20 18:30:55 -0500] kryptek: the line for declaring 'splunk_credentials_url' is crashing out; 'Attribute credentials is not defined!'
[2012-11-20 18:31:25 -0500] yfeldblum: mobilemike, you can use `knife node edit NODE` to set it; you can set it with `--json-attributes` in the bootstrap; you can figure it out somehow in a recipe and set it in the recipe using `knife.normal.set_unless["my-cookbook"]["my-value"] = "asdf1234"`
[2012-11-20 18:32:18 -0500] mobilemike: yfeldblum: Okay. I used edit NODE, but wasn't sure what's "right". Sounds like there's just a number of options.
[2012-11-20 18:33:15 -0500] yfeldblum: mobilemike, there's no "right"; there's only the pros and cons of each option, weighed in the context of your chef-repo, your crew, your current level of automation, your knowledge, skills, and experience, etc.
[2012-11-20 18:34:11 -0500] yfeldblum: mattupstate, `ps aux`?
[2012-11-20 18:34:20 -0500] mobilemike: yfeldblum: Yea, I'm figuring that out. Sometimes, just to get started, it helps to just be told "there's more than one way to do this, but, here's how you should do it :)"
[2012-11-20 18:34:45 -0500] barnacles: kryptek: Yah you want to be using the node['key']['key2'] syntax
[2012-11-20 18:35:13 -0500] yfeldblum: mobilemike, indeed :D
[2012-11-20 18:35:33 -0500] kryptek: barnacles,  Can you explain the difference between accessing attributes from the attributes file like 'node.key.key' and accessing via 'node['key']['key']' ?
[2012-11-20 18:35:46 -0500] mattupstate: yfeldblum: This is entirely unuseful > root 1319 0.0 0.0 0 0 ?  Zsl  18:26   0:00 [chef-client] <defunct>
[2012-11-20 18:35:47 -0500] yfeldblum: mobilemike, unfortunately many people have decided on what is universally right, regardless of context, so i'm rather wary of going that way
[2012-11-20 18:36:03 -0500] yfeldblum: mattupstate, heh
[2012-11-20 18:36:17 -0500] mattupstate: 7 of those appear after each run
[2012-11-20 18:36:40 -0500] yfeldblum: mattupstate, what's your /etc/chef/client.rb settings?
[2012-11-20 18:37:25 -0500] mattupstate: standard stuff
[2012-11-20 18:40:12 -0500] jforce: After recently upgrading chef on my box from 10.12.0 to 10.16.0, my `knife ssh` output now shows reverse-lookup names instead of hostnames. I prefer to see hostnames. Downgrading back to 10.12.0 fixes it. Does anybody know what's up?
[2012-11-20 18:40:32 -0500] mattupstate: yfeldblum: i see a bunch of "plugin <name> threw exception" in debug output
[2012-11-20 18:40:53 -0500] barnacles: kryptek: Not entirely sure. Take a look at http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_notation.html
[2012-11-20 18:40:57 -0500] yfeldblum: mattupstate, that's something to look at ...
[2012-11-20 18:41:03 -0500] mattupstate: i would assume that ohai would be smart enough to trap that successfully
[2012-11-20 18:41:16 -0500] mattupstate: as its just looking to see if stuff is there...
[2012-11-20 18:42:04 -0500] jforce: chmod u+r+w,g+r-w,o+r-w
[2012-11-20 18:42:10 -0500] jforce: er
[2012-11-20 18:42:26 -0500] jtimberman: mattupstate: those can be ignored, those attributes simply won't be on the node. if you do need attribute daata from those plugins, you'd need to make sure that the appropriate software/packages are installed before ohai runs.
[2012-11-20 18:42:29 -0500] jforce: sorry. wrong channel. XO
[2012-11-20 18:42:36 -0500] barnacles: kryptek: maybe you're talking about the difference between using the node['key'] versus an attribute accessor method
[2012-11-20 18:43:28 -0500] mattupstate: jtimberman: i understand that, but thats not what i'm trying to figure out
[2012-11-20 18:44:12 -0500] yfeldblum: mattupstate, is the chef-client process still running?
[2012-11-20 18:44:53 -0500] mattupstate: yfeldblum: no
[2012-11-20 18:45:41 -0500] ssd7_: barnacles: kryptek node['key1']['key2'] is mostly prefered on a style/consistency basis.  Modulo bugs node.key1.key2 should work but imo tends to expose more bugs.
[2012-11-20 18:47:04 -0500] jtimberman: mattupstate: ah - sorry
[2012-11-20 18:47:07 -0500] barnacles: ssd7_: it exposes more bugs? or is more buggy? Exposing more bugs would be better wouldn't it?
[2012-11-20 18:47:23 -0500] cpasmoi: Hi ! I'm willing to set a apache http server conf file with chef and I'll need the node's IP. I can't see the ohai IP attribute, how can I use it in a template ?
[2012-11-20 18:47:34 -0500] mattupstate: jtimberman: no sweat
[2012-11-20 18:48:02 -0500] jtimberman: barnacles: basically, because attribute keys are strings under the hood, they can be created with characters that are not allowed in Ruby method names.
[2012-11-20 18:48:48 -0500] barnacles: mmm, that makes sense
[2012-11-20 18:48:49 -0500] jtimberman: barnacles: so if i create node["What's Up - I like pie"] as an attribute, I couldn't call node.What's Up - I like pie
[2012-11-20 18:49:02 -0500] barnacles: thanks jtimberman!
[2012-11-20 18:49:09 -0500] yfeldblum: barnacles, jtimberman, it's not just under the hood; it's above the hood too, whenever you want to inspect what keys are available or iterate the keys
[2012-11-20 18:49:18 -0500] jtimberman: If you want to use method chaining for accessing attributes, it's totally cool, you just have to be careful about how you name the attributes you;'re using
[2012-11-20 18:49:57 -0500] kryptek: thanks for the explanations
[2012-11-20 18:49:57 -0500] jtimberman: especially since you might get a cookbook from someone named cool-thing, and the author used node['cool-thing'] for all their attributes.
[2012-11-20 18:50:29 -0500] yfeldblum: barnacles, jtimberman, e.g. if you do `node["my-cookbook"].each do |key, value|` to iterate the keys, you will get strings for the keys; so it's important to keep in mind that they're really strings and that the accessor methods are just wrapper methods around the string keys
[2012-11-20 18:51:03 -0500] jforce: jtimberman: but you can actually use any crazy junk you want in method names if you use define_method and quote your symbols.
[2012-11-20 18:52:37 -0500] mattupstate: jtimberman: just to explain, when i run chef-client manually on a node with an empty run list a bunch of zombie processes are left behind
[2012-11-20 18:52:47 -0500] jforce:  class Crazy; define_method(:"whoa$!*") {puts :gnarly}; end; Crazy.new.send :"whoa$!*"; # gnarly
[2012-11-20 18:52:56 -0500] mattupstate: i stumbled across some old ohai issues that might have given me a lead
[2012-11-20 18:53:37 -0500] mattupstate: but everything says it was fixed
[2012-11-20 18:55:29 -0500] jtimberman: mattupstate: sounds like you need a chainsaw ;)
[2012-11-20 18:55:40 -0500] yfeldblum: jforce, no need to call #define_method or #send with symbols; calling them with strings works just as well
[2012-11-20 18:55:46 -0500] jtimberman: jforce: i... uh.. wow :)
[2012-11-20 18:55:53 -0500] jforce: lol
[2012-11-20 18:55:56 -0500] jtimberman: mattupstate: what are the processes that are zombied?
[2012-11-20 18:56:03 -0500] jtimberman: did you post a gist?
[2012-11-20 18:56:06 -0500] mattupstate: chef-client
[2012-11-20 18:56:15 -0500] jtimberman: chef-client itself is zombied?
[2012-11-20 18:56:28 -0500] mattupstate: root      1319  0.0  0.0      0     0 ?        Zsl  18:26   0:00 [chef-client] <defunct>
[2012-11-20 18:56:38 -0500] mattupstate: i get 7 of those after each manual chef-client run
[2012-11-20 18:56:55 -0500] cpasmoi: I understand that the node's IP is an automatic attribute (http://docs.opscode.com/essentials_node_object_attributes_automatic.html ) but can't see how I can use this in a template (httpd.conf)
[2012-11-20 18:57:05 -0500] cpasmoi: http.conf.erb of course
[2012-11-20 19:00:38 -0500] yfeldblum: cpasmoi, https://gist.github.com/a68620accc88f2adc18b
[2012-11-20 19:01:32 -0500] jforce: So anybody have this experience with knife? chef 10.12.0 -> 10.16.0: knife ssh no longer prints hostnames before output, but instead reverse lookups, a la 209-1-2-3.static.cloud-ips.com. It's making things hard.
[2012-11-20 19:03:40 -0500] cpasmoi: thanks yfeldblum !
[2012-11-20 19:04:58 -0500] yfeldblum: jforce, https://github.com/opscode/chef/compare/10.12.0...10.16.2#diff-140
[2012-11-20 19:08:29 -0500] jforce: yfeldblum: I was about to give a sarcastic, "har har har! thanks a lot!" But there it is, around https://github.com/opscode/chef/compare/10.12.0...10.16.2#L140L125. So, instead, a sincere thanks. :)
[2012-11-20 19:08:44 -0500] yfeldblum: jforce, :D
[2012-11-20 19:09:54 -0500] corp: jtimberman: any support for git-only deploys from the application recipes?
[2012-11-20 19:10:05 -0500] corp: jtimberman: as in, not using cached-copy with a symlink
[2012-11-20 19:18:12 -0500] jtimberman: corp: I don't know offhand
[2012-11-20 19:18:26 -0500] jforce: Can I set defaults for knife sub-commands in my knife.rb? For instance, I always have to supply -x and -a arguments to knife ssh. I could alias this or put it in a shell function, but knife.rb would make more sense.
[2012-11-20 19:18:56 -0500] jforce: btw yfeldblum, that diff totally led me to my answer. `knife ssh -a name` gets me back to where I want to be. :D
[2012-11-20 19:19:06 -0500] jtimberman: jforce: depends on whether the options have a knife[] config setting.
[2012-11-20 19:19:54 -0500] jforce: jtimberman: I can't find documentation for this. I swear, I google this stuff and read the docs first. :)
[2012-11-20 19:20:05 -0500] iamchrisf_: I've created an LWRP and I'd like to pass an array of hashes to it.  Is this possible?  not sure of the syntax, but I need to pass an array of names which then have a key of "dir" with the value being a string.
[2012-11-20 19:21:13 -0500] KarlHungus: [2012-11-20T19:14:50+00:00] DEBUG: Processing carp_interface[carp0] on ssanders-vagrant-default.box
[2012-11-20 19:21:16 -0500] KarlHungus: yeehaw
[2012-11-20 19:23:45 -0500] jtimberman: jforce: hm, so, I don't think it made its way into any documentation yet - i had a gist of a commented knife.rb with the config options available in knife[] for the "opscode" knife plugins (knife itself and its subcommands in core chef, plus our various cloud plugins)
[2012-11-20 19:24:20 -0500] khimera: is it possible to set a chef environment in chef-solo? If not, am I able to initialize node.chef_environment, but how?
[2012-11-20 19:24:59 -0500] jforce: https://gist.github.com/1718805
[2012-11-20 19:25:04 -0500] jforce: jtimberman: there you are ^
[2012-11-20 19:25:54 -0500] jforce: the only ssh option listed there is :ssh_port. Oh well. I'll just wrap it. Thanks, jtimberman.
[2012-11-20 19:26:13 -0500] jtimberman: jforce: yes, that one :)
[2012-11-20 19:56:40 -0500] miah: hi
[2012-11-20 19:56:46 -0500] bemu: Hello!
[2012-11-20 20:14:23 -0500] iamchrisf_: Does anyone know the proper way to pass an array of hashes to an LWRP?  Here's what I'm doing that is failing miserably :)  http://pastie.org/5407952
[2012-11-20 20:15:28 -0500] kryptek: iamchrisf,  What's it say when you try that ?
[2012-11-20 20:16:08 -0500] kryptek: iamchrisf,  This is a LWRP you wrote?
[2012-11-20 20:17:17 -0500] iamchrisf_:  kryptek: Refresh the url.  Just added the error.  Correct.
[2012-11-20 20:17:17 -0500] methods: is no-op still  not possible
[2012-11-20 20:17:42 -0500] bluepojo: iamchrisf_: I don't see the error
[2012-11-20 20:17:55 -0500] kryptek: iamchrisf,  Neither do i
[2012-11-20 20:21:38 -0500] wassy121: oh, hey look: an easy fix bug: CHEF-3622 .  I did it myself!
[2012-11-20 20:22:04 -0500] wassy121: Anyone care to give some love?  Or I will just wait through the process :)
[2012-11-20 20:24:43 -0500] yfeldblum: iamchrisf, if you "paste again", you have a new url; it's not like a gist
[2012-11-20 20:25:32 -0500] iamchrisf_: damn. one sec
[2012-11-20 20:25:33 -0500] KarlHungus: why are you using a gist? ;)
[2012-11-20 20:25:37 -0500] kallistec: wassy121: did you sign the CLA?
[2012-11-20 20:25:40 -0500] KarlHungus: s/are/aren't/
[2012-11-20 20:25:41 -0500] iamchrisf_: http://pastie.org/5407960
[2012-11-20 20:25:51 -0500] miah: mesozoic: see 'whyrun' mode
[2012-11-20 20:26:07 -0500] wassy121: kallistec, I don't think I can, since I have an NDA with my job itself.
[2012-11-20 20:26:11 -0500] wassy121: :-/
[2012-11-20 20:27:44 -0500] KarlHungus: iamchrisf_: looks like the problem is in the provider. can you bin that too?
[2012-11-20 20:27:56 -0500] yfeldblum: iamchrisf_, You must supply a name when declaring a service resource
[2012-11-20 20:28:13 -0500] iamchrisf_: sure.
[2012-11-20 20:29:36 -0500] iamchrisf_: http://pastie.org/5408022
[2012-11-20 20:30:04 -0500] KarlHungus: @new_resource.name
[2012-11-20 20:30:48 -0500] iamchrisf_: This works if I room the web apps line from the call.
[2012-11-20 20:30:58 -0500] KarlHungus: oh. i'm sorry. that isn't it.
[2012-11-20 20:30:59 -0500] iamchrisf_: s/room/remove/
[2012-11-20 20:34:36 -0500] KarlHungus: well, i'm stumped on that one ;/
[2012-11-20 20:35:04 -0500] kryptek: iamchrisf,  See what happens if you statically put the service name in the resource file
[2012-11-20 20:35:12 -0500] kryptek: Line 71 of http://pastie.org/5408022
[2012-11-20 20:44:44 -0500] bemu: wassy121: I'm pretty sure we all have NDAs with our jobs. How does that relate to the CLA?
[2012-11-20 20:45:36 -0500] wassy121: I'm not sure.  So, I have to push that kind of stuff through HR.
[2012-11-20 20:45:58 -0500] wassy121: I've got one of those contracts that's all like "anything you create in or out of work is our intellectual property"
[2012-11-20 20:46:03 -0500] wassy121: So, I need to get permission
[2012-11-20 20:46:06 -0500] wassy121: Which is a PITA
[2012-11-20 20:48:11 -0500] bluepojo: wassy121: yeah, you'll need permission, but make it clear that if you can't use and contribute to community cookbooks, the contract will cost them many $ more as you'll have to write everything custom.
[2012-11-20 20:48:48 -0500] bluepojo: most clients are satisfied with that explanation
[2012-11-20 20:52:05 -0500] jflowers: can I call a method on a resource/provider?
[2012-11-20 20:52:12 -0500] jflowers: if so how
[2012-11-20 20:52:14 -0500] jflowers: ???
[2012-11-20 20:52:38 -0500] spox: existing or one you created?
[2012-11-20 20:52:53 -0500] jflowers: for example the jenkins_job on the jenkins cookbook
[2012-11-20 20:53:25 -0500] spox: well, i guess the better question might be, what are you trying to accomplish?
[2012-11-20 20:53:40 -0500] jflowers: I would like do or not do something based on if a job does or doesnot exist
[2012-11-20 20:54:00 -0500] jflowers: there is a method job_exists on the provider
[2012-11-20 20:54:38 -0500] spox: you can always instantiate a stub provider, and then call it
[2012-11-20 20:59:17 -0500] iamchrisf_: kryptek:  All of that works if I remove line 6 from http://pastie.org/5407960
[2012-11-20 21:04:13 -0500] BryanWB: fromonesrc, u have a question about berkshelf?
[2012-11-20 21:04:59 -0500] jtimberman: fromonesrc: my approach is that I still have a chef-repo for the things I am managing with chef (two linux systems and three macs)
[2012-11-20 21:04:59 -0500] fromonesrc: not sure if it's exactly berkshelf related, but it came out of working with berkshelf
[2012-11-20 21:05:54 -0500] bluepojo: iamchrisf_: Where are you declaring a service resource in your provider?
[2012-11-20 21:06:04 -0500] jtimberman: fromonesrc: all the "library" cookbooks or upstream cookbooks I use like apache2, samba, git, etc, are manged by berkshelf, and are in the Berksfile.
[2012-11-20 21:06:06 -0500] bluepojo: I don't think it's your array that is the problem
[2012-11-20 21:06:12 -0500] BryanWB: fromonesrc  i don't use roles much and i don't version roles
[2012-11-20 21:06:31 -0500] BryanWB: sorry, i don't keep nodes in version control
[2012-11-20 21:06:38 -0500] jtimberman: fromonesrc: all my local custom cookbooks and the "application" cookbooks are in the cookbooks directory of the chef-repo, along with roles, data bags etc.
[2012-11-20 21:06:50 -0500] jtimberman: storing nodes in version control is madness :)
[2012-11-20 21:06:52 -0500] BryanWB: i don't think it is necessary to keep nodes in version control
[2012-11-20 21:07:00 -0500] fromonesrc: hehe ok you're probably right
[2012-11-20 21:07:21 -0500] BryanWB: all ur data shud go in an application cookbook and/or data bags
[2012-11-20 21:07:50 -0500] jtimberman: fromonesrc: there's value in describing that you should have a node with particular roles / recipes in order to fuulfill a service in your infrastructure.
[2012-11-20 21:07:51 -0500] BryanWB: not in roles,  as nathen explains nicely in the hangout
[2012-11-20 21:07:58 -0500] jtimberman: but thats like, runbook level stuff
[2012-11-20 21:08:23 -0500] fromonesrc: jtimberman: we don't have one repo for our app cookbooks, each app cookbook is its own repo
[2012-11-20 21:08:54 -0500] BryanWB: gud practice
[2012-11-20 21:09:11 -0500] fromonesrc: the only thing I'm using roles for is to specify a run list
[2012-11-20 21:09:28 -0500] fromonesrc: I like creating them as json files so I can do a `knife role from file`
[2012-11-20 21:10:49 -0500] fromonesrc: maybe version control on these is unnecessary but it's been working for us. it's not the version history I care about, but rather having a definition of what that role is, available on every dev's machine.
[2012-11-20 21:11:00 -0500] fromonesrc: makes it easy to tweak the role
[2012-11-20 21:11:38 -0500] fromonesrc: so that still leaves me with the question: what to do with these role files?
[2012-11-20 21:11:40 -0500] BryanWB: i prefer to have the definition in an application cookbook
[2012-11-20 21:11:51 -0500] fromonesrc: presumably someone is using them since `knife role from file` exists
[2012-11-20 21:12:28 -0500] BryanWB: and basically have the role as an easily searchable alias to the recipe w/in the application cookbook
[2012-11-20 21:12:31 -0500] fromonesrc: BryanWB: is there any reason to be concerned if multiple app cookbooks are on a single node?
[2012-11-20 21:12:49 -0500] fromonesrc: do you get conflicts with the role definitions?
[2012-11-20 21:13:23 -0500] jtimberman: well, i'm a special case, i'm the only person writing the cookbooks for my LAN systems :)
[2012-11-20 21:14:21 -0500] BryanWB: fromonesrc, yeah, u shud only have one app cookbook on a node in general
[2012-11-20 21:14:22 -0500] BryanWB: imho
[2012-11-20 21:14:59 -0500] BryanWB: unless u are putting multiple appications on the same node, like 8 tomat instances
[2012-11-20 21:15:10 -0500] fromonesrc: exactly
[2012-11-20 21:15:18 -0500] fromonesrc: that's similar to my scenario
[2012-11-20 21:15:43 -0500] barnacles: I'm doing something similiar to that as well fromonesrc
[2012-11-20 21:17:16 -0500] fromonesrc: barnacles: how are you handling role definitions?
[2012-11-20 21:18:42 -0500] barnacles: I use a core chef-repo, then for every webapp there is an associated role (and cookbooks if needed). When I pull a webapp from SVN, I upload the role and cookbooks to the chef-server
[2012-11-20 21:19:02 -0500] barnacles: This way the role and cookbooks are versioned with the the webapp
[2012-11-20 21:19:46 -0500] barnacles: fromonesrc: I'm using knife role from file
[2012-11-20 21:19:48 -0500] fromonesrc: barnacles: cool, that's exactly what I had in mind
[2012-11-20 21:20:01 -0500] fromonesrc: good to hear others are doing that too
[2012-11-20 21:20:10 -0500] barnacles: fromonesrc: It's actually still a WIP, just started doing it
[2012-11-20 21:20:33 -0500] barnacles: fromonesrc: likewise :P
[2012-11-20 21:20:58 -0500] jroberts: Is it possible to pass Ohai a hint from knife-bootstrap?
[2012-11-20 21:21:46 -0500] bluepojo: Yo dudes. What package name is standard for MySQL 5.5 packages? I can't find any reasonable consistency mysql55-server mysql-server MySQL-server
[2012-11-20 21:21:53 -0500] bluepojo: all are valid depending on who you talk to
[2012-11-20 21:22:13 -0500] bluepojo: trying to finish up this PR for the mysql cookbook and I can't figure this bit out.
[2012-11-20 21:23:28 -0500] miah: it depends on what repository you are pulling the packages from =)
[2012-11-20 21:23:39 -0500] miah: also depends on which distribution
[2012-11-20 21:23:45 -0500] cwj: value_for_platform(_family) to the rescue?
[2012-11-20 21:23:54 -0500] miah: yup
[2012-11-20 21:25:23 -0500] jroberts: *jroberts* just RTFM
[2012-11-20 21:28:19 -0500] bluepojo: miah: yeah, but even within platforms they are different CentOS for example can be any of the 3
[2012-11-20 21:28:28 -0500] bluepojo: I'm not sure what to put in the mysql cookbook
[2012-11-20 21:28:39 -0500] bluepojo: I will put what I need in my own wrapper cookbook
[2012-11-20 21:28:43 -0500] bluepojo: but for the PR
[2012-11-20 21:28:45 -0500] bluepojo: meh
[2012-11-20 21:29:04 -0500] iamchrisf_: bluepojo: pretty sure it's implied from the name of the file.  So it's name instance in the jetty cookbook so the resource is called jetty_instance.  That does work.
[2012-11-20 21:29:41 -0500] bluepojo: iamchrisf_: the error you're getting is a service resource somewhere under the hood not getting a name value
[2012-11-20 21:29:59 -0500] bluepojo: that could be inside a definition or inside a LWRP or something
[2012-11-20 21:31:16 -0500] barnacles: fromonesrc: let me know if you run into any problems with that setup, it'd be nice to share our experiences with this setup
[2012-11-20 21:32:08 -0500] fromonesrc: will do
[2012-11-20 21:32:22 -0500] miah: bluepojo: centos mysql packages are all 'mysql-' a quick look at the ftp site shows this.
[2012-11-20 21:32:34 -0500] miah: its possible the others are aliases?
[2012-11-20 21:33:17 -0500] miah: from mysql.com though: MySQL-server-5.5.28-1.el6.i686.rpm
[2012-11-20 21:33:17 -0500] iamchrisf_: bluepojo:  yea I think you may be right.  Looking into the LWRP,  might have a syntax error.
[2012-11-20 21:33:33 -0500] miah: so like i said, i think it really depends on the source
[2012-11-20 21:38:24 -0500] bluepojo: miah: yeah, I cased it to MySQL in my PR and the code review said "o_O" and so now I'm trying to figure out what's correct. I think I'll just revert that change.
[2012-11-20 21:40:15 -0500] barnacles: On the chef-server webui, under "Status" does the "Last Check-in" column indicate the last time chef-client was run for that node?
[2012-11-20 21:43:06 -0500] miah: barnacles: yes
[2012-11-20 21:43:20 -0500] barnacles: miah: Thank you
[2012-11-20 22:01:43 -0500] rafaelmagu: is there a tool to easily create version constraints for environments after a run?
[2012-11-20 22:01:54 -0500] rafaelmagu: Sort of like "apply and lock"
[2012-11-20 22:02:17 -0500] bemu: rafaelmagu: Have you checked out knife spork? It isn't exactly what you're looking for.
[2012-11-20 22:02:21 -0500] bemu: but may do the trick
[2012-11-20 22:04:27 -0500] mattupstate: jtimberman: according to someone I work with the zombie process stuff might be a kernel problem
[2012-11-20 22:05:00 -0500] rafaelmagu: bemu: looks close, but I don't see how it works with Berkshelf
[2012-11-20 22:05:11 -0500] bemu: I didn't say it does, I don't use berkshelf yet.
[2012-11-20 22:05:21 -0500] rafaelmagu: I know you didn't
[2012-11-20 22:05:32 -0500] rafaelmagu: I'm just thinking out loud
[2012-11-20 22:05:40 -0500] bemu: mattupstate: That's pretty easy to test, no?
[2012-11-20 22:06:23 -0500] mattupstate: bemu: i really don't know, its not my expertise
[2012-11-20 22:06:41 -0500] rafaelmagu: Workflow would look like this: update cookbook -> berks upload -> spork promote (when ready)
[2012-11-20 22:11:41 -0500] bemu: Thanks rafaelmagu!
[2012-11-20 22:11:48 -0500] bemu: Definitely interested in berkshelf
[2012-11-20 22:20:06 -0500] barnacles: Man I really love chef, thanks to all of you that put in the time and effort to make it what it is. So thankful
[2012-11-20 22:25:45 -0500] matti: Hey folks.
[2012-11-20 22:26:03 -0500] matti: Why this does not work as I think it should? https://gist.github.com/4121674
[2012-11-20 22:26:19 -0500] matti: Action for dpkg_package ends up being :nothing all the time.
[2012-11-20 22:30:06 -0500] miah: matti: what is the point of your 'file' resource declaration after the dpkg_package?
[2012-11-20 22:30:22 -0500] miah: ah
[2012-11-20 22:30:24 -0500] miah: delete
[2012-11-20 22:30:36 -0500] miah: typically
[2012-11-20 22:30:45 -0500] miah: people just use file_cach_path instead of /tmp
[2012-11-20 22:32:06 -0500] matti: miah: It is Solo.
[2012-11-20 22:32:14 -0500] miah: but fwiw. everytime your cookbook runs it would download the file, install it, then delete it.
[2012-11-20 22:32:42 -0500] matti: I've added not_if there, so no.
[2012-11-20 22:32:56 -0500] matti: Regardless, it works when action is :install.
[2012-11-20 22:33:02 -0500] matti: notifies does not do anything.
[2012-11-20 22:33:32 -0500] rafaelmagu: Going around all my cookbooks and rewriting them Gangnam Style
[2012-11-20 22:33:37 -0500] rafaelmagu: :D
[2012-11-20 22:33:49 -0500] matti: ;p
[2012-11-20 22:33:57 -0500] miah: gangnam style?
[2012-11-20 22:33:58 -0500] Mithrandir: so they jump around looking silly?
[2012-11-20 22:34:04 -0500] rafaelmagu: Yup
[2012-11-20 22:34:14 -0500] rafaelmagu: See http://devopsanywhere.blogspot.se/2012/11/how-to-write-reusable-chef-cookbooks.html
[2012-11-20 22:34:56 -0500] rafaelmagu: Realized I had many forks of Opscode cookbooks where I changed one line of code to suit my environment
[2012-11-20 22:35:08 -0500] rafaelmagu: Cookbooks started drifting apart
[2012-11-20 22:35:10 -0500] rafaelmagu: Not cool
[2012-11-20 22:35:18 -0500] barnacles: thanks for sharing :)
[2012-11-20 22:35:36 -0500] rafaelmagu: So back to basics now with wrapper cookbooks for my own stuff
[2012-11-20 22:35:48 -0500] rafaelmagu: Trying to move away from role-based attributes also
[2012-11-20 22:35:55 -0500] rafaelmagu: Where possible, of course
[2012-11-20 22:36:03 -0500] rafaelmagu: barnacles: no probs
[2012-11-20 22:36:51 -0500] miah: ah. i already write my cookbooks like that.
[2012-11-20 22:37:09 -0500] miah: http://blog.nistu.de/2012/03/04/reusability-in-configuration-management-systems/
[2012-11-20 22:37:31 -0500] miah: https://github.com/miah/chef-collectd/tree/master/recipes
[2012-11-20 22:37:44 -0500] alexw: Greetings all
[2012-11-20 22:38:18 -0500] alexw: Wondering how I would go about having country specific configs, i.e. on server create I can do knife ec2 server create (attribute country_id=1) or some sort...
[2012-11-20 22:38:25 -0500] matti: Um.
[2012-11-20 22:38:27 -0500] matti: WTH
[2012-11-20 22:38:33 -0500] alexw: lol
[2012-11-20 22:38:44 -0500] matti: jtimberman: Ping.
[2012-11-20 22:38:57 -0500] matti: miah: This looks like a bug.
[2012-11-20 22:39:07 -0500] miah: ?
[2012-11-20 22:39:17 -0500] matti: miah: I dropped to Pry session and :install is not getting to gem_package.
[2012-11-20 22:39:39 -0500] miah: gem_package = making life hell since '2009
[2012-11-20 22:39:46 -0500] rafaelmagu: miah: thanks for the link. Lunch time reading
[2012-11-20 22:39:50 -0500] alexw: I have dev/prod/staging envrionments - but one of the things I want to do is change the config file depending on what region the server is in ,i.e. Asia has it's own DB config, US its own db config
[2012-11-20 22:39:50 -0500] matti: Sorry, dpkg_package.
[2012-11-20 22:40:12 -0500] rafaelmagu: alexw: I'm doing multiple prod environments, one for each region
[2012-11-20 22:40:23 -0500] rafaelmagu: basically, I split environments up by region/DC
[2012-11-20 22:40:26 -0500] miah: matti: remove the 'file' resource and see what happens
[2012-11-20 22:40:51 -0500] alexw: rafaelmagu: ahh I see - so in envrionments youd have a prod.rb + prod_us.rb, prod_au.rb etc
[2012-11-20 22:41:00 -0500] alexw: where prod_us.rb imports from prod.rb?
[2012-11-20 22:41:04 -0500] rafaelmagu: alexw: yup, minus the prod, though
[2012-11-20 22:41:13 -0500] rafaelmagu: alexw: each region is self-contained
[2012-11-20 22:41:18 -0500] miah: environments don't inherit environments
[2012-11-20 22:41:20 -0500] alexw: wouldn't you be repeating code for each region then?
[2012-11-20 22:41:29 -0500] rafaelmagu: alexw: not really, i'm only doing attributes
[2012-11-20 22:41:40 -0500] rafaelmagu: Domains, mail relay addresses, ranges
[2012-11-20 22:41:41 -0500] miah: i tend to only stick override level attributes in environments. everything else lives in roles.
[2012-11-20 22:41:49 -0500] rafaelmagu: miah: same
[2012-11-20 22:42:05 -0500] rafaelmagu: Although I'll be moving role-based stuff to recipes
[2012-11-20 22:42:11 -0500] rafaelmagu: To simplify the roles a bit
[2012-11-20 22:42:26 -0500] rafaelmagu: Mine started getting too lengthy with the attribute overrides
[2012-11-20 22:42:50 -0500] rafaelmagu: alexw: I have one environment attribute that tells whether the environment is a production one or not
[2012-11-20 22:43:19 -0500] matti: miah: It complains that it is not in known / present.
[2012-11-20 22:43:29 -0500] matti: miah: Expected.
[2012-11-20 22:43:43 -0500] alexw: rls
[2012-11-20 22:43:48 -0500] alexw: rafaelmagu: I see
[2012-11-20 22:44:03 -0500] alexw: rafaelmagu: so this overrides the local config
[2012-11-20 22:44:19 -0500] alexw: are you storing your DB settings in your environment files?
[2012-11-20 22:44:32 -0500] rafaelmagu: alexw: some of it
[2012-11-20 22:44:46 -0500] rafaelmagu: Like subnets allowed, domains for postfix box
[2012-11-20 22:44:54 -0500] miah: matti: did you remove the 'notify' from the dpkg_package?
[2012-11-20 22:45:14 -0500] rafaelmagu: Graphite, Ganglia, etc hosts for the region
[2012-11-20 22:46:28 -0500] matti: miah: ?
[2012-11-20 22:47:00 -0500] miah:   notifies :delete, 'file[hadoop-lzo-package]', :immediately
[2012-11-20 22:47:12 -0500] matti: miah: What this has to do with dpkg_package not firing?
[2012-11-20 22:47:13 -0500] miah: if you removed the file resource, im curious if you also removed that
[2012-11-20 22:47:23 -0500] matti: Yes I did.
[2012-11-20 22:47:27 -0500] miah: ok
[2012-11-20 22:47:51 -0500] miah: making things less complicated can aide in debugging
[2012-11-20 22:48:10 -0500] matti: Its 15 loc recipe.
[2012-11-20 22:48:19 -0500] miah: so?
[2012-11-20 22:48:22 -0500] matti: Complicated ain't it.
[2012-11-20 22:48:27 -0500] miah: you're dealing with 3 different resources
[2012-11-20 22:48:35 -0500] miah: that are all somewhat interdependant
[2012-11-20 22:49:08 -0500] miah: each item in your recipe is dependant on the next
[2012-11-20 22:49:24 -0500] alexw: rafaelmagu: do you do this for your dev environment also?
[2012-11-20 22:49:32 -0500] rafaelmagu: alexw: yup
[2012-11-20 22:49:59 -0500] matti: jtimberman: Let me know when you are in :) I could use your insight.
[2012-11-20 22:50:37 -0500] matti: miah: I know. As I said, I don't see :install or even :fuck_me_sideways being sent to dpkg_package.
[2012-11-20 22:50:39 -0500] rafaelmagu: alexw: And because the env atttribute is set to 'development', I can do cool things like setting up each developer with its own user on the box, pulling their SSH keys from data bags and etc
[2012-11-20 22:51:01 -0500] matti: miah: It just gets :nothing, so it does nothing.
[2012-11-20 22:51:01 -0500] rafaelmagu: Whereas they wouldn't get setup in prod
[2012-11-20 22:52:11 -0500] alexw: rafaelmagu:so your setting another attribute i.e. chef_environment=prod_au whereas envrionment=dev ?
[2012-11-20 22:52:21 -0500] alexw: sorry whereas envrionment=prod
[2012-11-20 22:53:03 -0500] rafaelmagu: alexw: yup. I have an override attribute called 'mycompany_environment' that gets set to 'development' or 'production' in each environment.rb
[2012-11-20 22:54:19 -0500] alexw: rafaelmagu: seems the best way - just thought it'd be repeating alot of code
[2012-11-20 22:54:44 -0500] rafaelmagu: alexw: that depends on how many attributes you are setting up in your environment
[2012-11-20 22:55:07 -0500] alexw: mainly just a few sql settings etc
[2012-11-20 22:55:08 -0500] rafaelmagu: I have between 10-15 lines in my environments
[2012-11-20 23:28:03 -0500] mjreed: OK, if I do 'user "foo" do action :delete end' and 'user "foo" do action :create end' in the same run, both actions happen.  how does that work? shouldn't the second declaration overwrite the resource created by the first?
[2012-11-20 23:28:36 -0500] mjreed: If I examine resources(:user => "foo").action, it's only got the later value..
[2012-11-20 23:45:40 -0500] oddover: hi chefs! I have a question about the execute resource (which I know I should avoid using)
[2012-11-20 23:46:46 -0500] oddover: I see it has a 'creates' param that helps with idempotency(is that a word?). Is there a param like that, but would run a command and check it against a string?
[2012-11-20 23:47:46 -0500] oddover: my use case is setting the login background with gdm. I have a command that will return the filename of the background image, and I have a command to set the background image
[2012-11-20 23:48:20 -0500] oddover: so currently, im just running the first command, and checking against what it should be with a ruby if.
[2012-11-20 23:51:11 -0500] kallistec: oddover: use not_if/only_if -- not_if "foo | grep bar" ; not_if { %x[foo] =~ /bar/ }; etc.
[2012-11-20 23:51:26 -0500] oddover: ah. that makes sense
[2012-11-20 23:51:29 -0500] oddover: thanks!
[2012-11-20 23:51:42 -0500] oddover: I always forget about those ones
[2012-11-20 23:57:35 -0500] mrk__: hello chefs! I am getting a httpserver exception 500 from chef-server-webui after moving over to a new chef server
[2012-11-20 23:57:55 -0500] mrk__: I suspect the validation.pem and/or validation.pem are causin this issue
[2012-11-20 23:58:19 -0500] mrk__: but I moved couchDB as well as both pem files over from the original chef server
[2012-11-20 23:58:24 -0500] mrk__: any idea what could be causing this?
