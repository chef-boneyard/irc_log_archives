[2012-11-14 00:01:44 -0500] coderanger: macros: If the role vs roles thing in searches doesn't make you cry, you might have no soul left
[2012-11-14 00:05:27 -0500] macros: coderanger: It makes me cry
[2012-11-14 00:05:44 -0500] karsten: Scrapped the host and starting over....
[2012-11-14 00:06:21 -0500] coderanger: macros: I can't imagine how normal people even figure out that difference, I only know it from spelunking through the chef-expander code one too many times
[2012-11-14 00:06:25 -0500] karsten: coderanger: knife.rb, not knife.kb, correct?  And that *should* be set up right (I'm working off a repo that works for others here).
[2012-11-14 00:06:36 -0500] coderanger: karsten: Yes
[2012-11-14 00:06:39 -0500] karsten: OK, this launch looked happier.
[2012-11-14 00:06:55 -0500] macros: coderanger: It was not fun trying to track down bugs around that
[2012-11-14 00:07:08 -0500] karsten: I think it was my encrypted databags key being missing that effed up the first trial.
[2012-11-14 00:07:34 -0500] macros: I'm slowly ripping out everything that derives state
[2012-11-14 00:08:23 -0500] coderanger: macros: ZOOKEEPER ALL THE THINGS
[2012-11-14 00:08:27 -0500] macros: ohai's network stuff will be the next to go
[2012-11-14 00:08:30 -0500] coderanger: </troll>
[2012-11-14 00:08:49 -0500] macros: Fully specified mac and ips for all network interfaces
[2012-11-14 00:09:02 -0500] coderanger: macros: Seriously dude, why are you guys not writing your own chef server
[2012-11-14 00:09:04 -0500] coderanger: :P
[2012-11-14 00:09:11 -0500] macros: coderanger: Trying not to
[2012-11-14 00:09:22 -0500] macros: Mostly starting to adopt the littlechef worldview on sharing
[2012-11-14 00:09:24 -0500] coderanger: It will happen :)
[2012-11-14 00:09:30 -0500] macros: Trying to figure out if chef-server still fits
[2012-11-14 00:09:48 -0500] coderanger: Heh, you are still going to need a data distribution framework
[2012-11-14 00:09:57 -0500] coderanger: just take commis and gut the internals
[2012-11-14 00:10:12 -0500] karsten: The launch: http://pastebin.com/Wqv6rBCT
[2012-11-14 00:10:28 -0500] karsten: Despite the bootstrap apparently working I see no /etc/chef/ on the host.
[2012-11-14 00:10:35 -0500] chefologist: Hi, receiving error when running vagrant box up > chef_server_url incorrect > what is the correct syntax for this parameter? regards in advance
[2012-11-14 00:11:06 -0500] coderanger: karsten: You probably want a -x ubuntu --sudo on there
[2012-11-14 00:11:17 -0500] coderanger: and you need the EC2 ssh key
[2012-11-14 00:11:18 -0500] macros: coderanger: we have a pretty slim pop design, I really am starting to think about a chef server per pop
[2012-11-14 00:11:30 -0500] macros: With a layer to push chef configs to each pop
[2012-11-14 00:11:37 -0500] coderanger: macros: Talk to holoway, I think we was pondering doing chef-server per top of rack
[2012-11-14 00:11:40 -0500] coderanger: :)
[2012-11-14 00:11:43 -0500] macros: With "discovery" limited to just local pop
[2012-11-14 00:11:56 -0500] coderanger: macros: :thumbsup:
[2012-11-14 00:12:00 -0500] macros: coderanger: I think it is totally doable
[2012-11-14 00:12:21 -0500] macros: I need to finish y chef-client bootstrap script for the aristas
[2012-11-14 00:12:26 -0500] coderanger: Yeah, but to do that nicely you'll want a chef-server that groks your federation scheme, so you'll really want your own server
[2012-11-14 00:12:29 -0500] macros: Then look at one for chef-server
[2012-11-14 00:12:33 -0500] coderanger: So I repeat, why are you not writing one ;-)
[2012-11-14 00:12:36 -0500] karsten: coderanger: the ubuntu account is created and suduable.  Still think I need that?
[2012-11-14 00:12:52 -0500] macros: coderanger: I'm not totatlly convinced I need to
[2012-11-14 00:12:58 -0500] coderanger: karsten: Yes, those options are saying to use it, the default is to SSH in as root
[2012-11-14 00:13:04 -0500] coderanger: karsten: which is usually wrong on AMIs
[2012-11-14 00:13:09 -0500] coderanger: macros: Time will tell ;-)
[2012-11-14 00:13:49 -0500] karsten: Ah.
[2012-11-14 00:13:57 -0500] karsten: Destroy and restart...
[2012-11-14 00:14:08 -0500] macros: coderanger: I'm convinced total push is untenable, but push to pop I think will be ok
[2012-11-14 00:14:31 -0500] macros: And minus 100+ http round trips the runs should finish so much faster
[2012-11-14 00:14:49 -0500] karsten: Interesting:  "knife client list" (from workstation) fails to show the new node, though it shows in the ec2 server listing.  So registration never happens.
[2012-11-14 00:14:52 -0500] coderanger: macros: Right, I just think to make push-to-pop work you're going to end up wanting 1) a much thiner chef server and 2) something that has better security modeling for this kind of tiered push setup
[2012-11-14 00:14:53 -0500] chefologist: Hi, receiving error when running vagrant box up > chef_server_url incorrect > what is the correct syntax for this parameter? regards in advance
[2012-11-14 00:14:57 -0500] macros: hosted chef from singapore is slow as hell
[2012-11-14 00:15:54 -0500] macros: coderanger: node registration is a minor pain, but the global bits are just stubs
[2012-11-14 00:16:07 -0500] coderanger: macros: Otherwise you'll just have to write a big management backplane for all the various keys
[2012-11-14 00:16:22 -0500] karsten: error postpending '--sudo' to the knife ec2 server create command.
[2012-11-14 00:16:47 -0500] macros: Not sure, I don't need nodes to be able to talk to anything except their local server
[2012-11-14 00:17:01 -0500] karsten: Trying just:  "knife ec2 server create -N 'kms-management3' -r 'role[kms_management]' -f 'm1.small' -I ami-c9248fa0 -G ssh,mail-client -x ubuntu"
[2012-11-14 00:17:14 -0500] coderanger: macros: I mean to track the keys to push to all the servers
[2012-11-14 00:17:19 -0500] macros: The node stubs stored in the repo and applied with a non-existant tool will overwrite the centrally defined bits
[2012-11-14 00:17:28 -0500] coderanger: macros: its the server->server sync that will be the hard(er) path
[2012-11-14 00:17:31 -0500] karsten: coderanger: Thansk for theh elp BTW.
[2012-11-14 00:17:42 -0500] macros: coderanger: Eh, not terribly bad
[2012-11-14 00:17:52 -0500] macros: Might get painful at 20+ deployments
[2012-11-14 00:18:05 -0500] coderanger: macros: And how many POPs do you have again? ;-)
[2012-11-14 00:18:11 -0500] macros: 7 right now
[2012-11-14 00:18:41 -0500] coderanger: Heh, I should keep this log around, I'm betting in another year or so you'll be contemplating it ;-)
[2012-11-14 00:18:58 -0500] macros: :)
[2012-11-14 00:19:00 -0500] jtimberman: coderanger: if only someone logged this channel and posted it on the internet.
[2012-11-14 00:19:13 -0500] coderanger: jtimberman: znc logs everything for me anyway
[2012-11-14 00:19:17 -0500] karsten: coderanger:  ... aaaaaand.  We're doing a serious chef run.
[2012-11-14 00:19:21 -0500] jtimberman: coderanger: http://community.opscode.com/chat/chef#id-235629
[2012-11-14 00:19:23 -0500] jtimberman: :)
[2012-11-14 00:19:28 -0500] macros: Didn't you say there is a python server implementation kicking around?
[2012-11-14 00:19:37 -0500] coderanger: macros: Yeah, commis
[2012-11-14 00:19:43 -0500] jtimberman: coderanger: who wrote that?
[2012-11-14 00:19:51 -0500] coderanger: macros: See also "take commis can gut the internals" :)
[2012-11-14 00:20:02 -0500] coderanger: er, and gut ...
[2012-11-14 00:20:12 -0500] gyre008: is there any way how I can get a list of servers which have a particular recipe in their runlist ?some search query Id assume
[2012-11-14 00:20:35 -0500] coderanger: gyre008: knife search node 'recipes:asdfasdfadf'
[2012-11-14 00:20:52 -0500] gyre008: mm let me see :)
[2012-11-14 00:20:54 -0500] coderanger: jtimberman: I will cut you ...
[2012-11-14 00:22:33 -0500] gyre008: coderanger, mm doesn't seem to be workingunless there is a proper way how to specify a recipe name which is obviously tied to cookbook name
[2012-11-14 00:22:42 -0500] gyre008: in that query
[2012-11-14 00:22:53 -0500] coderanger: gyre008: Make you escape the :s
[2012-11-14 00:23:31 -0500] gyre008: even without s it returns empty listbut as I said I might be specifying the recipe name incorrectly
[2012-11-14 00:23:32 -0500] gyre008: mm
[2012-11-14 00:23:43 -0500] karsten: coderanger: OK, I've got /etc/chef and PEMEfiles, now to get my users ...
[2012-11-14 00:24:12 -0500] gyre008: because recipe is always tied to cookbook nameso should it be recipe:cb_name::recipe_name ? mm this is returning an error
[2012-11-14 00:24:19 -0500] coderanger: gyre008: I think its something like 'recipes:foo\\:\\:bar'
[2012-11-14 00:24:46 -0500] coderanger: gyre008: Every time I do it I have to play until I find the right escape sequences though
[2012-11-14 00:24:57 -0500] karsten: Hrm.  Still don't see the box listed as a chef client w/ "knife client list" from workstation.
[2012-11-14 00:25:12 -0500] gyre008: mm
[2012-11-14 00:25:28 -0500] gyre008: coderanger, I seeIll give it a shot
[2012-11-14 00:28:43 -0500] gyre008: coderanger, looks like it should be like this run_list:recipe\[foo\:\:bar\] .but that doesn't seem to be working in knife ;)
[2012-11-14 00:30:10 -0500] coderanger: gyre008: Thats a different query, slightly different semantics but also doable
[2012-11-14 00:30:22 -0500] gyre008: different ?
[2012-11-14 00:30:53 -0500] coderanger: the run_list field is updated when the run list itself is updated, recipes: is updated on successful node convergence /cc macros
[2012-11-14 00:31:14 -0500] karsten: And ... it looks like my chef server won't talk to me.:  Error connecting to https://ec2-107-21-71-158.compute-1.amazonaws.com/clients - Connection timed out - connect(2)
[2012-11-14 00:31:27 -0500] karsten: (running "chef-client" on the remote node / new instance.
[2012-11-14 00:31:47 -0500] macros: coderanger: Yeah, roles and recipes are both derived at converge then stored
[2012-11-14 00:32:10 -0500] coderanger: macros: Just teasing you, same shit different day^Wminute
[2012-11-14 00:32:24 -0500] coderanger: karsten: Running your own server in EC2?
[2012-11-14 00:32:29 -0500] macros: commis might be easier to get onto the aristas
[2012-11-14 00:32:39 -0500] coderanger: macros: Pure python :)
[2012-11-14 00:32:45 -0500] miah: i've run my own server on ec2. it works fine.
[2012-11-14 00:32:53 -0500] karsten: coderanger: Yes.  Own server, not hosted chef.
[2012-11-14 00:32:59 -0500] coderanger: karsten: 1) check your SGs 2) there is a 0% chance that running your own server on EC2 is cheaper than Hosted Chef
[2012-11-14 00:33:12 -0500] karsten: coderanger: ... actually, multiple servers, but that's another story.
[2012-11-14 00:33:32 -0500] macros: coderanger: I was thinking of making minor hacks to erchef anyway, upload times aren't exposed on cookbooks and such
[2012-11-14 00:33:59 -0500] macros: coderanger: Support for the partial_search api?
[2012-11-14 00:34:12 -0500] coderanger: macros: No, probably easy to add though
[2012-11-14 00:34:45 -0500] karsten: coderanger: It's not a cost consideration.
[2012-11-14 00:34:48 -0500] gyre008: coderanger, so I should look only for recipes: ?
[2012-11-14 00:34:54 -0500] karsten: And roger that on SGs, checking.
[2012-11-14 00:34:57 -0500] coderanger: gyre008: Generally thats what you want
[2012-11-14 00:34:58 -0500] gyre008: tried like 100 combinations...
[2012-11-14 00:34:59 -0500] macros: coderanger: I've been using it in my little dashboard app, much more efficient that getting every node and attrbiute
[2012-11-14 00:35:14 -0500] magoo: apparently this is bad code and I'm struggling to debug it: http://pastebin.com/Ve36ku19
[2012-11-14 00:35:18 -0500] gyre008: getting 0 results
[2012-11-14 00:35:21 -0500] coderanger: macros: Yeah, just in a non-SOA system like commis its super easy to add :)
[2012-11-14 00:35:46 -0500] macros: coderanger: It is in the erchef schema, just not exposed
[2012-11-14 00:36:38 -0500] coderanger: gyre008: $ knife search node 'recipes:users\:\:sysadmins'
[2012-11-14 00:36:38 -0500] coderanger: 83 items found
[2012-11-14 00:36:43 -0500] gyre008: coderanger, this one seems to have worked: recipes:foo\:\:bar
[2012-11-14 00:36:48 -0500] gyre008: :)
[2012-11-14 00:36:51 -0500] magoo: that above snippet ends up throwing this error
[2012-11-14 00:36:51 -0500] magoo: Chef::Mixin::Template::TemplateError (compile error
[2012-11-14 00:36:51 -0500] gyre008: that was cloes
[2012-11-14 00:36:52 -0500] magoo: (erubis):63: syntax error, unexpected '\n', expecting '{') on line #73:
[2012-11-14 00:36:54 -0500] gyre008: close
[2012-11-14 00:36:57 -0500] gyre008: haha
[2012-11-14 00:37:04 -0500] coderanger: gyre008: Right, it would be \\ if you use " because bash is silly
[2012-11-14 00:37:12 -0500] gyre008: yeah
[2012-11-14 00:44:55 -0500] occupant: so I deleted some roles that weren't being used, and somehow this broke one of my other roles, causing a 404. As far as I can tell, there is NO reference to the deleted role in my valid role. Where is it getting this association?
[2012-11-14 00:48:22 -0500] chefologist: hi getting this error: vm: * The provisioner 'chef_server' doesn't exist.
[2012-11-14 00:49:37 -0500] chefologist: assistance would be great
[2012-11-14 00:50:28 -0500] kreedy: I have a ruby app running on 6 machines that gets deployed via capistrano. There are two nginx load balancers sitting in front of it. The nginx upstream config is generated based on which machines are in a role for the ruby app. I now want to pull app servers off of the load balancer one-by-one as code gets deployed to them.
[2012-11-14 00:50:37 -0500] kreedy: I have two initial ideas, and would love to bounce them off of some people. 1) Have capistrano set a node attribute for the app server to mark it as down, and restart chef-client on the load balancers to pick up the change. 2) Have capistrano trigger a script on the nginx boxes to pull an app server out of rotation / put it back in. It'll also set the node attribute for the same thing in case a chef-run happens as well.
[2012-11-14 00:50:43 -0500] kreedy: thoughts?
[2012-11-14 00:52:21 -0500] kallistec: chefologist: is it named chef_client?
[2012-11-14 00:52:47 -0500] kallistec: would be nice if the valid values were printed along with that error
[2012-11-14 00:52:55 -0500] chefologist: I am using Hosted-chef, so I need the correct path in my Vagrantfile
[2012-11-14 00:54:10 -0500] kallistec: I only use Vagrant via custom wrappers that we wrote so I don't know what is required to get your keys and config on the VM
[2012-11-14 00:54:29 -0500] chefologist: <@kallistec> how do I find those valid values?
[2012-11-14 00:54:46 -0500] kallistec: chefologist: probably in the docs somewhere
[2012-11-14 00:55:20 -0500] chefologist: <@kallistec> http://wiki.opscode.com/display/chef/Chef+Configuration+Settings states When using the Opscode Platform, this will be https://api.opscode.com/organizations/ORGNAME, where ORGNAME is your organization short name that you created when signing up for the service.
[2012-11-14 00:55:47 -0500] kallistec: chefologist: is your issue with vagrant or chef?
[2012-11-14 00:56:07 -0500] chefologist: vagrantfile, but running chef commands
[2012-11-14 00:56:53 -0500] kallistec: "vm: * The provisioner 'chef_server' doesn't exist." seems like a vagrant error, I *think* the provisioner is chef_client or chef-client, but I don't remember for sure
[2012-11-14 01:00:47 -0500] karsten: coderanger: Looks like it's SGs.
[2012-11-14 01:00:59 -0500] karsten: Launching a new instance to confirm.
[2012-11-14 01:01:19 -0500] chefologist: <@kallistec> I am using Hosted-Chef
[2012-11-14 01:03:08 -0500] chefologist: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings#ChefConfigurationSettings-chefserverurl
[2012-11-14 01:03:12 -0500] kallistec: chefologist: sure. Did you get past that error I copied? Looks like something wrong in your Vagrantfile that vagrant id complaining about
[2012-11-14 01:03:19 -0500] kallistec: *is complaining about
[2012-11-14 01:03:36 -0500] maplebed: I want to see the value of a certain attribute across all my hosts.  Is there an easy way to ask knife this question?
[2012-11-14 01:04:13 -0500] r5|ryan: kreedy: I'm a fan of 1)
[2012-11-14 01:04:17 -0500] maplebed: (specifically, I want to know the version of chef that's running everywhere)
[2012-11-14 01:04:52 -0500] chefologist: @kallistec: should I pop over to the #vagrant freenode?
[2012-11-14 01:05:02 -0500] r5|ryan: kreedy: then you can bring up test boxes of the same app with a role change that overrides that attribute and makes the load balancer ignore it
[2012-11-14 01:05:33 -0500] kallistec: chefologist: yeah, there's lots of vagrant users here, too, but it might be best to ask over there
[2012-11-14 01:05:56 -0500] chefologist: ok thans
[2012-11-14 01:05:56 -0500] chefologist: thanks*
[2012-11-14 01:07:21 -0500] kreedy: thanks r5|ryan. right now the ruby app ins't deployed via chef, so option 1 should work fine
[2012-11-14 01:07:40 -0500] occupant: so I have a role I can't apply because it seemingly depends on another role which I have deleted. but when I "show role", there's no reference to the deleted role inside. where is chef getting this association?
[2012-11-14 01:07:51 -0500] maplebed: I mean, I could iterate across all hosts, asking for knife node show -a chef_packages.chef.version $host, but that seems lame.
[2012-11-14 01:24:45 -0500] jkyle: what's a good method for debugging ohai plugins? I'm on a target node ina  shell and diong o = Ohai::System.new; o.all_plugins; o.myprovider, but this turns up an empty hash
[2012-11-14 01:26:48 -0500] jkyle: tried outputing log tracers, just doing a "puts" to stdout, etc.
[2012-11-14 01:34:20 -0500] coderanger: jkyle: https://github.com/opscode/ohai/blob/master/lib/ohai/log.rb
[2012-11-14 01:37:48 -0500] jkyle: I notice it says the ohai plugins are a dsl, can I still use normal ruby like define dmethods and such?
[2012-11-14 01:47:09 -0500] jkyle: coderanger: thanks for the log link, all sorted now
[2012-11-14 02:30:49 -0500] bmcgee: Hey, looking for some advice on best practices. I've managed to setup a few roles, app server, database master, load balancer and the like and can successfully deploy my rails app on to a fresh box. So here's my (likely stupid) question: how do i push out an update?
[2012-11-14 02:31:41 -0500] bluepojo: how are you deploying your code?
[2012-11-14 02:31:51 -0500] bluepojo: are you using versioned artifacts?
[2012-11-14 02:31:58 -0500] bluepojo: ie: myapp-1.0.0.tar
[2012-11-14 02:32:01 -0500] bluepojo: or what have you
[2012-11-14 02:32:46 -0500] bmcgee: i'm using the application_ruby cookbook
[2012-11-14 02:32:51 -0500] bmcgee: pulled down from github
[2012-11-14 02:32:54 -0500] bluepojo: ah ok
[2012-11-14 02:33:03 -0500] bluepojo: I'm not familiar with the application_ruby cookbook
[2012-11-14 02:33:18 -0500] bmcgee: i'm interested in hearing how you do it anyway, patterns are likely similar
[2012-11-14 02:33:23 -0500] bluepojo: I use https://riotgames.com/RiotGames/artifact-cookbook
[2012-11-14 02:33:28 -0500] bluepojo: which deploys artifacts
[2012-11-14 02:34:04 -0500] bluepojo: we have an artifact server. Upon passing a build, the build server creates and pushes an artifact.
[2012-11-14 02:34:15 -0500] bluepojo: there's an attribute in the cookbook
[2012-11-14 02:34:18 -0500] yfeldblum: bmcgee, that cookbook is designed to redeploy the app on the next chef-client run
[2012-11-14 02:34:25 -0500] bluepojo: appname: {version: '1.0.0'}
[2012-11-14 02:34:34 -0500] bluepojo: which we bump when we want to upgrade
[2012-11-14 02:34:51 -0500] bemu: bmcgee: You just update the branch you set in the recipe
[2012-11-14 02:34:57 -0500] bemu: git push to it, then run chef-client
[2012-11-14 02:35:05 -0500] bemu: it will pull down a new version for you and restart your processes.
[2012-11-14 02:35:22 -0500] bmcgee: ah ok
[2012-11-14 02:35:32 -0500] bemu: btw, we are moving toward a system akin to bluepojo, in the long run.
[2012-11-14 02:35:38 -0500] bmcgee: what are opinions on setting up chef-client as a daemon which periodically runs?
[2012-11-14 02:35:39 -0500] bemu: bluepojo's
[2012-11-14 02:36:00 -0500] bluepojo: daemon mode is preferred
[2012-11-14 02:36:14 -0500] bemu: It's great if you can ensure no one makes changes to your chef server
[2012-11-14 02:36:27 -0500] bemu: We don't do that because we don't have rigid enough controls currently.
[2012-11-14 02:36:38 -0500] bluepojo: your recipes should be written such that they can run infinite number of times without causing problems
[2012-11-14 02:36:42 -0500] bluepojo: aka idepotent
[2012-11-14 02:36:46 -0500] bluepojo: idempotent
[2012-11-14 02:37:00 -0500] bmcgee: as a general pattern i would want to avoid box local changes. My main reason for spending time on chef is so I can migrate environments at the drop of a hat
[2012-11-14 02:37:19 -0500] bemu: Absolutely, however with a bunch of people committing to the same repo/chef server, and with the same cookbooks being used across many clusters, it can be unsafe to constantly run chef-client
[2012-11-14 02:37:25 -0500] bmcgee: ok cool, i'll setup the chef client as a daemon and give it a try
[2012-11-14 02:37:32 -0500] bemu: bmcgee: You're going in the right direction. :)
[2012-11-14 02:37:45 -0500] bluepojo: this assumes you are using cookbook version locks in your environments properly
[2012-11-14 02:37:55 -0500] bmcgee: bemu i'm getting there, by sheer force of will if nothing else :D
[2012-11-14 02:38:06 -0500] bluepojo: and that you are freezing your cookbooks on the chef server (or otherwise ensure that you never overwrite a cookbook version on the chef server)
[2012-11-14 02:38:15 -0500] bemu: bluepojo: and testing before you lock.
[2012-11-14 02:38:16 -0500] bmcgee: bluepojo version lock is achieved in the environment correct?
[2012-11-14 02:38:20 -0500] bluepojo: yeah
[2012-11-14 02:38:31 -0500] bluepojo: it's a key in the environment json
[2012-11-14 02:38:32 -0500] bmcgee: see, I is learning.
[2012-11-14 02:38:32 -0500] bemu: We don't have those constraints currently, as it is too burdensome for the time being.
[2012-11-14 02:38:47 -0500] bluepojo: version locks ensure environments don't update without you telling them to :P
[2012-11-14 02:39:00 -0500] bluepojo: ie: someone pushes v2 of your cookbook so they can test in staging
[2012-11-14 02:39:05 -0500] bluepojo: if you haven't locked production to v1
[2012-11-14 02:39:17 -0500] bluepojo: production will automatically pick up v2 and break everything
[2012-11-14 02:39:27 -0500] bmcgee: so chef server can't handle multiple versions of a cookbook ?
[2012-11-14 02:39:31 -0500] bluepojo: it can
[2012-11-14 02:39:39 -0500] bluepojo: but they are not environment specific
[2012-11-14 02:39:39 -0500] bmcgee: ah you just have to specify
[2012-11-14 02:39:48 -0500] bluepojo: so both v1 and v2 will exist on the chef server
[2012-11-14 02:39:57 -0500] bluepojo: but if you don't say "production only uses v1"
[2012-11-14 02:40:03 -0500] bluepojo: it will automatically try to get hte latest
[2012-11-14 02:40:05 -0500] bluepojo: the
[2012-11-14 02:40:05 -0500] bmcgee: so in the above scenario provided you had locked production the update would've have broken it
[2012-11-14 02:40:10 -0500] bluepojo: correct
[2012-11-14 02:40:15 -0500] bmcgee: *wouldn't
[2012-11-14 02:40:19 -0500] bluepojo: yeah
[2012-11-14 02:40:22 -0500] bmcgee: ok cool
[2012-11-14 02:40:36 -0500] bmcgee: so in terms of management, i've seen Berksfile mentioned quite a bit
[2012-11-14 02:40:44 -0500] bmcgee: do people find it's easier to manage cookbooks that way?
[2012-11-14 02:40:59 -0500] bluepojo: berkshelf is great
[2012-11-14 02:41:13 -0500] bluepojo: (disclaimer, I wrote it)
[2012-11-14 02:41:17 -0500] bmcgee: ha
[2012-11-14 02:41:18 -0500] bluepojo: (with reset and others)
[2012-11-14 02:41:23 -0500] bluepojo: :D
[2012-11-14 02:41:36 -0500] bmcgee: shameless self promotion aside, is it any good? :P
[2012-11-14 02:41:44 -0500] bluepojo: yeah, I'm very pleased with it
[2012-11-14 02:41:47 -0500] scairbus: are cookbook versions only 'lockable' in an environment?
[2012-11-14 02:41:48 -0500] bmcgee: ok cool
[2012-11-14 02:41:58 -0500] bluepojo: reset has done great work with it
[2012-11-14 02:42:13 -0500] bluepojo: I wrote the first version, he's taken it and added a lot of nice features
[2012-11-14 02:42:14 -0500] bmcgee: i;ll give that a stab too. I want to establish some good base patterns early on, even if it is painful
[2012-11-14 02:42:25 -0500] bluepojo: http://vialstudios.com/guide-authoring-cookbooks.html
[2012-11-14 02:42:35 -0500] bluepojo: this is a guide on how to write cookbooks with berkshelf
[2012-11-14 02:42:41 -0500] bluepojo: it's a great place to start
[2012-11-14 02:42:56 -0500] bluepojo: reset wrote it
[2012-11-14 02:43:57 -0500] bmcgee: on a different note, i have a chef-repo and then i have my rails app repo. I'm thinking of just sticking the chef repo in as a sub dir of my rails app. All the cookbooks etc pertain to my rails app anyway. Does that make sense or is it just stupid/will likely cause pain?
[2012-11-14 02:44:15 -0500] bemu: We're really eager to check out / use berkshelf and artifact deploys!
[2012-11-14 02:44:26 -0500] bemu: bmcgee: Will cause pain, don't do it
[2012-11-14 02:44:32 -0500] bluepojo: yeah, that sounds problematic
[2012-11-14 02:44:36 -0500] bmcgee: ok cool
[2012-11-14 02:45:00 -0500] bmcgee: right then i'm off to tinker yet again
[2012-11-14 02:45:07 -0500] bluepojo: also, keeping cookbooks inside your chef repo is also generally going to cause pain
[2012-11-14 02:45:09 -0500] bemu: Good luck!
[2012-11-14 02:45:17 -0500] bluepojo: you should treat cookbooks like they're their own project
[2012-11-14 02:45:25 -0500] bluepojo: they should be versioned and released just like a software project
[2012-11-14 02:45:33 -0500] bmcgee: interesting
[2012-11-14 02:45:34 -0500] jtimberman: because they *are* software projects :)
[2012-11-14 02:45:36 -0500] jtimberman: as it turns out
[2012-11-14 02:45:42 -0500] bluepojo: and, as such, they should get their own repository
[2012-11-14 02:45:42 -0500] bmcgee: so how do you bring it all together
[2012-11-14 02:45:47 -0500] bluepojo: berkshelf!
[2012-11-14 02:45:47 -0500] bluepojo: :D
[2012-11-14 02:45:51 -0500] bmcgee: ah i see
[2012-11-14 02:45:52 -0500] jtimberman: bluepojo: you may be biased sir!
[2012-11-14 02:45:56 -0500] bluepojo: I may be
[2012-11-14 02:46:08 -0500] jtimberman: (berkshelf is cool)
[2012-11-14 02:46:10 -0500] siezer: berks
[2012-11-14 02:46:11 -0500] bmcgee: but does it mean a third repo, one for cookbook, one for app, one for bringing it all together?
[2012-11-14 02:46:18 -0500] bluepojo: one for every cookbook
[2012-11-14 02:46:32 -0500] bluepojo: and then in your my_app cookbook
[2012-11-14 02:46:42 -0500] bluepojo: well
[2012-11-14 02:46:44 -0500] bluepojo: sec
[2012-11-14 02:46:47 -0500] bluepojo: let me back up
[2012-11-14 02:46:52 -0500] bmcgee: :D
[2012-11-14 02:47:01 -0500] bluepojo: each cookbook is essentially a software project
[2012-11-14 02:47:10 -0500] bmcgee: yup
[2012-11-14 02:47:12 -0500] bluepojo: so we have jenkins jobs for every cookbook
[2012-11-14 02:47:29 -0500] bluepojo: the jenkins job runs foodcritic (lint for cookbooks) and other tests then uploads to the chef server
[2012-11-14 02:47:32 -0500] siezer: berks cookbok myface
[2012-11-14 02:48:26 -0500] bluepojo: when you deploy, you lock the cookbook to your environment
[2012-11-14 02:48:33 -0500] bluepojo: and, since you have CI set up,
[2012-11-14 02:48:39 -0500] bluepojo: it's all there ready to go
[2012-11-14 02:48:45 -0500] bmcgee: i get that
[2012-11-14 02:48:50 -0500] bluepojo: so "where it comes together" is the chef server
[2012-11-14 02:49:02 -0500] bluepojo: berkshelf resolves the cookbook's dependencies
[2012-11-14 02:49:19 -0500] bluepojo: so on the jenkins job, you tell berkshelf to pull in all the dependencies and upload them
[2012-11-14 02:49:32 -0500] bluepojo: to make sure even third party cookbooks are available
[2012-11-14 02:49:34 -0500] bmcgee: if i have an app called Foo. I create a repo for Foo's source. I create a repo for the Foo cookbook. Then I create a repo for all my data bags, roles etc for deploying Foo?
[2012-11-14 02:49:42 -0500] bluepojo: yes
[2012-11-14 02:49:47 -0500] bmcgee: i get ya
[2012-11-14 02:49:51 -0500] bluepojo: and there
[2012-11-14 02:49:58 -0500] bluepojo: there's a jenkins job on chef-repo too
[2012-11-14 02:50:07 -0500] bluepojo: to upload the roles, data bags, and environment jsons to the chef server
[2012-11-14 02:50:25 -0500] bluepojo: so every time you make a change, there's a direct pipe to the chef server
[2012-11-14 02:50:41 -0500] bluepojo: regardless of whether it's in a cookbook or in the chef repo
[2012-11-14 02:51:18 -0500] bmcgee: seems like a pretty slick and straight forward setup
[2012-11-14 02:52:25 -0500] bluepojo: just need to make sure the cookbook version gets incremented every build
[2012-11-14 02:52:45 -0500] bluepojo: so you never overwrite cookbooks on the chef server
[2012-11-14 02:53:07 -0500] bluepojo: we use https://github.com/ivey/thor-scmversion
[2012-11-14 02:53:23 -0500] bluepojo: https://github.com/ivey/thor-scmversion/wiki/Adding-autoversioning-to-a-chef-cookbook
[2012-11-14 02:56:54 -0500] bmcgee: thx
[2012-11-14 05:09:52 -0500] vaq: Hello, I seem to have a strange issue. knife node_list shows a node named demo, if I run "ssh demo w" it works, but if I run knife ssh name:demo w it says: WARNING: Failed to connect to node[demo] -- SocketError: getaddrinfo: Name or service not known
[2012-11-14 05:09:54 -0500] vaq: any ideas?
[2012-11-14 05:12:15 -0500] paulmooring: It will try to connect to the fqdn by default
[2012-11-14 05:13:37 -0500] paulmooring: so you might want to use `knife ssh "name:demo" -a ipaddress` or some other attribute if your fqdn isn't resolvable
[2012-11-14 05:14:45 -0500] vaq: thanks paulmooring
[2012-11-14 05:15:01 -0500] paulmooring: and if you want to know what the fqdn Chef has currently is run `knife search node "name:demo"`
[2012-11-14 05:15:15 -0500] vaq: ye
[2012-11-14 05:15:20 -0500] vaq: just one more thing. Can knife list all the attributes that a given node has?
[2012-11-14 05:17:28 -0500] yfeldblum: vaq, yes, if you use the -l flag
[2012-11-14 05:17:39 -0500] yfeldblum: vaq, knife node show NODE -l
[2012-11-14 05:17:59 -0500] yfeldblum: vaq, beware! for that is a lot of datas
[2012-11-14 05:18:11 -0500] paulmooring: usually -m has what you want
[2012-11-14 05:18:22 -0500] paulmooring: but yes -l should give you the whole thing
[2012-11-14 05:19:00 -0500] paulmooring: which is pretty much ohai data along with the stuff from -m
[2012-11-14 05:21:30 -0500] vaq: Doesn't chef index the attributes that are used in a cookbook
[2012-11-14 05:21:42 -0500] vaq: so let's say I installed cookbook a, and in cookbook a i had a set of attributes
[2012-11-14 05:21:54 -0500] vaq: after the installation, I want to see those attributes for the node the cookbook was installedo n
[2012-11-14 05:24:37 -0500] vaq: oh ye it does that by default sorry
[2012-11-14 06:22:38 -0500] ssd7: Ohai Chefs!
[2012-11-14 06:33:32 -0500] bmcgee: Hey guys, I'm working through the Berkshelf example and i'm getting when i try to provision my vm: Chef::Exceptions::PrivateKeyMissing
[2012-11-14 06:34:26 -0500] bmcgee: I haven't touched the generated Vagrantfile
[2012-11-14 06:34:37 -0500] bmcgee: any ideas?
[2012-11-14 06:46:13 -0500] bmcgee: it seems i was using search in one of my recipes. Removing it fixed the problem.
[2012-11-14 06:46:43 -0500] BryanWB_: ohai chefs!
[2012-11-14 06:56:35 -0500] ssd7: Heya
[2012-11-14 07:12:39 -0500] Osax: Hi please point me in the correct direction, I'm try to use node['etc']['passwd']["#{username}"]["uid"] recipe, but the user first need to get created, however it seems chef wants this before it will execute the recipe, any advise?
[2012-11-14 07:22:11 -0500] mamu: Hi, I am trying to create an extra drive on a windows machine and use that as part of my recipe . The disk is getting created and if i create files manually on the box , it works fine however as part of the recipe I always get a " Chef::Exceptions::EnclosingDirectoryDoesNotExist: Parent directory D:/ does not exist." ( I am creating D:) .Once I create a file manually on the box,I can create several other files through the recipe.
[2012-11-14 07:22:33 -0500] mamu: Have you faced this earlier ?
[2012-11-14 07:59:20 -0500] gokr: Anyone knows the most official way of loading a chef server with a chef repo from files?
[2012-11-14 08:00:51 -0500] royh: gokr: most official way? first what chef do you have? private or hosted?
[2012-11-14 08:01:51 -0500] gokr: Private. I am building a tool that uses chef and that tool is meant to "install itself" onto the cloud - so it fires up a node on EC2 (for example), installs chef-server onto it - but then I want to "load" cookbooks into that server.
[2012-11-14 08:02:22 -0500] gokr: So basically a bit what knife-server or chef-hatch-repo does - but I don't want to depend on those tools I think, and I don't want to lock into EC2.
[2012-11-14 08:02:34 -0500] royh: gokr: like bootstrapping? there's a function for that already
[2012-11-14 08:02:44 -0500] gokr: The first part I already have working - but the "load chef server with stuff from files" I am not sure about.
[2012-11-14 08:02:58 -0500] royh: or do you mean to install a chef server in the cloud?
[2012-11-14 08:02:59 -0500] gokr: The bootstrap is all working, I made my own custom template though.
[2012-11-14 08:03:17 -0500] gokr: Yes, I mean that - but I already have that part done. But it is empty :)
[2012-11-14 08:03:45 -0500] royh: gokr: knife cookbook upload?
[2012-11-14 08:03:45 -0500] gokr: So now I want to 1) put cookbooks into it and 2) make it run a chef-client run itself to install more stuff onto itself.
[2012-11-14 08:04:19 -0500] gokr: Yeah... perhaps I will just use that. Then I do need to first get keys working though.
[2012-11-14 08:04:21 -0500] royh: gokr: you can have chef-client run regularly through cron
[2012-11-14 08:04:40 -0500] gokr: I was thinking of uploading a tar ball of a chef-repo and then "load it" somehow into the server.
[2012-11-14 08:05:11 -0500] royh: gokr: just get an admin certificate for your server and use knife. it's very painless
[2012-11-14 08:05:14 -0500] gokr: Yeah, but I need my cookbook up there first - the server is empty from the start.
[2012-11-14 08:06:31 -0500] royh: gokr: just because you're writing your own tool doesn't mean you shouldn't use the work that others have already done (standing on the shoulders of giants and all)
[2012-11-14 08:06:32 -0500] gokr: Yeah, seen it. But then I need to upload them one by one, right? Which is fine, because I don't have that many of course + some roles.
[2012-11-14 08:06:58 -0500] gokr: royh: No, I whole heartedly agree - that is why I am asking :) And that is why I am building this on chef to begin with :)
[2012-11-14 08:07:17 -0500] gokr: Just trying to find the cross-cloud-most-official-path here.
[2012-11-14 08:07:33 -0500] royh: gokr: you can bulk upload as well
[2012-11-14 08:07:33 -0500] gokr: Do you work at opscode or?
[2012-11-14 08:07:42 -0500] gokr: I can?
[2012-11-14 08:07:46 -0500] royh: yes
[2012-11-14 08:08:09 -0500] gokr: Ehm, yes what? :)
[2012-11-14 08:08:22 -0500] royh: gokr: http://wiki.opscode.com/display/chef/Managing+Cookbooks+With+Knife#ManagingCookbooksWithKnife-upload (-a)
[2012-11-14 08:08:30 -0500] royh: gokr: yes you can bulk upload, no i don't work for opscode
[2012-11-14 08:08:35 -0500] gokr: ;)
[2012-11-14 08:08:59 -0500] gokr: Aha, -a.
[2012-11-14 08:11:00 -0500] gokr: Ok, then I will do it like this: 1) bootstrap the node and install chef-server onto it using the chef-server recipe 2) get keys etc and use knife upload to populate the chef-server 3) kick it to do a chef-client run using ssh
[2012-11-14 08:12:04 -0500] royh: gokr: do you want the client running on the server to auth against itself or some central node?
[2012-11-14 08:12:14 -0500] gokr: Against itself.
[2012-11-14 08:12:49 -0500] royh: then perhaps you want to install the chef server without bootstrapping, upload the cookbooks and then bootstrap (the client)
[2012-11-14 08:13:45 -0500] royh: or you can "bootstrap" both procedures. there's another product called chef-solo that might be good for just getting the server installed
[2012-11-14 08:14:01 -0500] gokr: My custom template installs ruby, rubygems and gem install chef - then uses chef-solo to install chef-server. But does not run chef-client at end.
[2012-11-14 08:14:17 -0500] gokr: So that works.
[2012-11-14 08:14:20 -0500] royh: "Chef Solo allows you to run Chef Cookbooks in the absence of a Chef Server."
[2012-11-14 08:14:45 -0500] royh: so you can run your chef-server (or chef::server) recipe without having to have it auth against a server first
[2012-11-14 08:15:01 -0500] royh: ah, excellent :)
[2012-11-14 08:15:05 -0500] gokr: Yeah, that part actually works quite fine. I adapted some code from Veewee actually to do it all from source.
[2012-11-14 08:16:22 -0500] gokr: So I guess I then look up how to get keys from it and then do some knife uploading. Seems like the most "proper" way here, thanks.
[2012-11-14 08:23:41 -0500] royh: gokr: you're welcome. the documentation for chef can be quite confusing at times, but this channel can be a lot of help :)
[2012-11-14 08:24:03 -0500] gokr: The docs are ... well, there are so many different paths/steps/ways.
[2012-11-14 08:24:12 -0500] royh: indeed
[2012-11-14 08:24:27 -0500] gokr: And sometimes it feels like... couldn't this be a tad simpler? :)
[2012-11-14 09:13:32 -0500] bmcgee: hey I'm getting Errno::ENOENT: No such file or directory when trying to do a deploy on a vagrant vm with chef solo
[2012-11-14 09:13:43 -0500] bmcgee: can't see anything obviously wrong, had it working before
[2012-11-14 09:13:53 -0500] bmcgee: anything immediately come to mind?
[2012-11-14 09:23:14 -0500] helllen: helllo
[2012-11-14 09:23:31 -0500] helllen: I have updated from 0.10.8 to new version
[2012-11-14 09:23:36 -0500] helllen: and I get:    HTTP Request Returned 404 Not Found: No routes match the request: /reports/nodes/rb-manager/runs
[2012-11-14 09:23:43 -0500] helllen: what is this feature ?
[2012-11-14 09:25:29 -0500] masterkorp: hello chefs
[2012-11-14 09:25:55 -0500] masterkorp: helllen: i don't think that's a feature :P
[2012-11-14 09:30:11 -0500] helllen: ahm
[2012-11-14 09:30:20 -0500] helllen: and why do I get this error?
[2012-11-14 09:30:37 -0500] helllen: I thought it was new feature something related with reports
[2012-11-14 09:31:22 -0500] masterkorp: what's you server version ?
[2012-11-14 09:32:21 -0500] helllen: same
[2012-11-14 09:32:37 -0500] helllen: 10.16.2
[2012-11-14 10:09:55 -0500] helllen: why ?
[2012-11-14 10:13:39 -0500] Dunedan1: Does chef offer a way to include a template in a template or to concatenate templates?
[2012-11-14 10:35:52 -0500] keimlink: I'm using the mysql cookbook together with vagrant and chef-solo
[2012-11-14 10:36:27 -0500] keimlink: mysql::server installs the packages and mysql is running after the initial provisioning
[2012-11-14 10:36:41 -0500] keimlink: but after a reboot of the vm mysql won't start
[2012-11-14 10:37:49 -0500] keimlink: syslog fpr mysql http://dpaste.de/a6j5z/
[2012-11-14 10:39:28 -0500] keimlink: Vagrantfile: https://bitbucket.org/keimlink/django-workshop/src/957d7d2119da2690b93ff89b281429038b1b076b/Vagrantfile?at=default
[2012-11-14 10:44:18 -0500] keimlink: looks like this is the same problem I got http://tickets.opscode.com/browse/COOK-1390
[2012-11-14 10:59:02 -0500] masterkorp: http://i.imgur.com/2Q9SQ.png
[2012-11-14 10:59:06 -0500] masterkorp: lol
[2012-11-14 11:09:39 -0500] keimlink: the temporary fix in COOK-1390 fixes the mysql service problem
[2012-11-14 11:10:06 -0500] keimlink: hope the next release of the mysql cookbook will be soon
[2012-11-14 11:28:34 -0500] masterkorp: guys how is node["ipaddress"] set ?
[2012-11-14 11:28:48 -0500] masterkorp: eg a machine that has multiple interfaces and thus ips ?
[2012-11-14 11:28:58 -0500] Mithrandir: from ohai
[2012-11-14 11:29:16 -0500] Mithrandir: it looks at the first ip for the interface that has a default route
[2012-11-14 11:30:02 -0500] masterkorp: Can i enforce another one ?
[2012-11-14 11:30:28 -0500] masterkorp: i dont want to route all my traffic by the same interface my machines talk to each other
[2012-11-14 11:31:04 -0500] masterkorp: my machines are connected trough openvpn, but they are in various locations, and the traffic is not routed
[2012-11-14 11:57:31 -0500] orche: hai
[2012-11-14 11:57:58 -0500] masterkorp: hello
[2012-11-14 11:58:13 -0500] orche: i have one doubt
[2012-11-14 11:58:22 -0500] orche: can u help me
[2012-11-14 11:58:31 -0500] Mithrandir: masterkorp: enforce another one?  Why do you want to do that?
[2012-11-14 11:58:33 -0500] _rc: you gotta believe
[2012-11-14 11:59:06 -0500] orche: pls
[2012-11-14 11:59:30 -0500] _rc: orche: just ask your question.  depending on what it is will depend if we can help.
[2012-11-14 11:59:45 -0500] orche: k
[2012-11-14 12:00:39 -0500] mat`: morning, has someone got an idea about this problem: http://pastebin.com/QqpkEAQ3
[2012-11-14 12:01:08 -0500] masterkorp: Mithrandir: eg the icinga recipe searches for nodes ip
[2012-11-14 12:01:19 -0500] masterkorp: eg knife ssh
[2012-11-14 12:01:24 -0500] orche: i tried to bootstrap from workstation to client using keypair , but it shows error
[2012-11-14 12:01:38 -0500] Mithrandir: masterkorp: iirc, you can just set it in an attribute file
[2012-11-14 12:02:05 -0500] orche: command like
[2012-11-14 12:02:07 -0500] orche: knife bootstrap 66.207.205.152 -x root -i ~/.ssh/orchestration_kp.pem --sudo
[2012-11-14 12:02:20 -0500] masterkorp: Mithrandir: the hardcoded ip ? or which ip (eg 10.1.x.x) to choose
[2012-11-14 12:02:21 -0500] orche: it shows error like
[2012-11-14 12:02:32 -0500] orche: ERROR: Network Error: Connection timed out - connect(2) Check your knife configuration and network settings
[2012-11-14 12:02:36 -0500] masterkorp: using it hardcoded sucks
[2012-11-14 12:03:27 -0500] orche: sorry i am not understand what u trying to say?
[2012-11-14 12:03:47 -0500] masterkorp: Mithrandir: ^
[2012-11-14 12:04:29 -0500] mat`: no one has an idea about my run of chef on windows platform? It keeps failing
[2012-11-14 12:04:31 -0500] orche: thats a client ip ,username and keypair  instead of password
[2012-11-14 12:05:41 -0500] orche: iam working on linux..
[2012-11-14 12:06:28 -0500] xerxas: Hi all ! any ETA for a ubuntu 12.10 boostrap ?
[2012-11-14 12:06:31 -0500] xerxas: bootstrap
[2012-11-14 12:07:01 -0500] orche: no idea about ETA?
[2012-11-14 12:09:37 -0500] orche: any one know the steps how to do ths??
[2012-11-14 12:11:35 -0500] orche: oooh......
[2012-11-14 12:23:22 -0500] ShawnMcCool: i'm unclear as to how to use json_attribs with chef solo, should i be defining a json attribs path in my vagrantfile, should individual recipes have json_attribs added? is it global to chef?
[2012-11-14 12:31:35 -0500] masterkorp: I have the following recipe http://pastie.org/private/nyd2k65fpchfgp43jygaq
[2012-11-14 12:32:06 -0500] masterkorp: http://pastie.org/5376798
[2012-11-14 12:32:19 -0500] masterkorp: if nodes.empty?
[2012-11-14 12:32:25 -0500] masterkorp: why does this breaks
[2012-11-14 12:32:35 -0500] masterkorp: "Cannot find a resource for nodes on ubuntu version 12.04"
[2012-11-14 12:32:42 -0500] masterkorp: Makes no sense
[2012-11-14 12:32:50 -0500] masterkorp: nodes its just and array
[2012-11-14 12:33:38 -0500] _rc: it's only an array in one branch of the preceding if
[2012-11-14 12:33:57 -0500] masterkorp: _rc: hmm ?
[2012-11-14 12:34:01 -0500] _rc: line 121 makes it an array, if you're not running under chef-solo
[2012-11-14 12:34:26 -0500] masterkorp: no i am on chef-server
[2012-11-14 12:35:15 -0500] masterkorp: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/server.rb#L72
[2012-11-14 12:35:21 -0500] masterkorp: its the same in here
[2012-11-14 12:35:22 -0500] _rc: really?  looks like you're under vagrant
[2012-11-14 12:35:40 -0500] masterkorp: _rc: yes i am but i am connecting to a chef server
[2012-11-14 12:36:07 -0500] masterkorp: _rc: if i weren't on a chef server config the error would be another
[2012-11-14 12:37:07 -0500] _rc: it's not the same there
[2012-11-14 12:37:27 -0500] masterkorp: what ?
[2012-11-14 12:37:44 -0500] masterkorp: what do mean that its not the same ?
[2012-11-14 12:37:59 -0500] _rc: you said the code on line 74 is the same to the code you have around line 124
[2012-11-14 12:38:04 -0500] _rc: which it isn't
[2012-11-14 12:39:11 -0500] _rc: in your code there's a branch, in the true branch you don't create nodes, in the else branch you do
[2012-11-14 12:39:38 -0500] _rc: in the code you say it's like, it creates nodes in both branches.
[2012-11-14 12:40:17 -0500] masterkorp: i dont get branches in this context, what do you mean with branches in here ?
[2012-11-14 12:40:50 -0500] _rc: when you have an if ... else ... end.  those are branches
[2012-11-14 12:42:00 -0500] masterkorp: Oh you mean scoping
[2012-11-14 12:42:16 -0500] _rc: no, I mean branching
[2012-11-14 12:42:27 -0500] masterkorp: You eman that nodes arrays "dies" after the end 
[2012-11-14 12:42:53 -0500] _rc: no
[2012-11-14 12:43:15 -0500] masterkorp: http://pastie.org/private/kq1nntbrow4iidxuehyeva
[2012-11-14 12:43:18 -0500] masterkorp: this ?
[2012-11-14 12:48:19 -0500] cassianoleal: Hi, I'm trying to write some chefspec tests for a cookbook, but it fails with "Cookbook application not found. If you're loading application from another cookbook, make sure you configure the dependency in your metadata"
[2012-11-14 12:48:28 -0500] cassianoleal: I'm using Berkshelf to manage dependencies
[2012-11-14 12:49:10 -0500] cassianoleal: and I have this on my knife.rb: cookbook_path ["#{ENV['HOME']}/.berkshelf/cookbooks", ENV['COOKBOOK_PATH'], "#{current_dir}/../cookbooks"]
[2012-11-14 12:49:45 -0500] cassianoleal: I checked that the application cookbook is correctly installed by berkhself on ~/.berkshelf/cookbooks
[2012-11-14 12:50:07 -0500] cassianoleal: can anyone give me pointers as to what I'm doing wrong?
[2012-11-14 12:53:56 -0500] gyre008: can I return only first host from KNIFE search when I'm looking for a node with certain role and there is a bunch of them ?
[2012-11-14 12:54:38 -0500] gyre008: I know this is doable in the recipes where you have the full power of ruby but is there a way to do that using knife on the command line ?
[2012-11-14 12:55:55 -0500] masterkorp: _rc: I dont get it
[2012-11-14 12:56:06 -0500] masterkorp: can you please give me an hint
[2012-11-14 12:56:54 -0500] masterkorp: i placed the search out of the if
[2012-11-14 12:56:59 -0500] masterkorp: still the same
[2012-11-14 12:59:18 -0500] Aimo: Hi, I am experienceing strange behavior with search(:node). In my local shef the command " management_nodes = search(:node, "name:management*") " returns the correct nodes, but in a recipe that I execute in an EC2 node it returns nil. Any ideas?
[2012-11-14 13:03:01 -0500] masterkorp: http://pastie.org/5376926
[2012-11-14 13:03:05 -0500] masterkorp: lol now i get this
[2012-11-14 13:03:12 -0500] masterkorp: how can that line be wrong ?
[2012-11-14 13:05:07 -0500] masterkorp: full chef output http://pastie.org/5376937
[2012-11-14 13:05:27 -0500] masterkorp: recipe http://pastie.org/private/sb8f0vpzlpd2h3qjrqljg
[2012-11-14 13:05:45 -0500] masterkorp: "annot find a resource for    on ubuntu version 12.04"
[2012-11-14 13:05:49 -0500] masterkorp: what the heck
[2012-11-14 13:18:55 -0500] masterkorp: oh wait i am bald already
[2012-11-14 13:35:33 -0500] mikeywaites: hey can anyone tell me wat the default path is when you create a data_bag on osx with knife data bag create users ?
[2012-11-14 13:35:45 -0500] mikeywaites: it says its created but i can see it anywhere :/
[2012-11-14 13:37:04 -0500] _rc: it's created on your chef server
[2012-11-14 13:38:01 -0500] mikeywaites: oh right of course DOH!
[2012-11-14 13:44:09 -0500] masterkorp: aww fuck
[2012-11-14 13:44:15 -0500] masterkorp: i cant figure this out
[2012-11-14 13:44:41 -0500] masterkorp: http://pastie.org/private/km4eou3chdquoshsj5aow
[2012-11-14 13:44:45 -0500] masterkorp: Guys on line 123
[2012-11-14 13:46:06 -0500] masterkorp: "Cannot find a resource for nodes on ubuntu version 12.04
[2012-11-14 13:46:08 -0500] masterkorp: "
[2012-11-14 13:46:12 -0500] masterkorp: why do i get this
[2012-11-14 13:47:08 -0500] geekbri: Well for whatever reason it lokos like its trying to call your nodes array as a chef resource
[2012-11-14 13:47:23 -0500] geekbri: at first glance I don't see an obvious reason why that is happening but I don't have time to dig in too deep at the moment
[2012-11-14 13:48:14 -0500] ShawnMcCool: i'm not getting any error on vagrant up, but in order to start mysql i need to ssh into the box and do a sudo service mysql start
[2012-11-14 13:48:40 -0500] masterkorp: wow
[2012-11-14 13:48:54 -0500] masterkorp: nodes = search(:node, "*:*"
[2012-11-14 13:48:54 -0500] ShawnMcCool: it's strange t ome since it's in the runlevel folder of init.d
[2012-11-14 13:49:05 -0500] masterkorp: works but the array cames out nil
[2012-11-14 13:49:15 -0500] masterkorp: there is something wrong with this
[2012-11-14 13:49:56 -0500] masterkorp: FUCK
[2012-11-14 13:51:21 -0500] geekbri: take a deep breath.
[2012-11-14 13:51:43 -0500] geekbri: it'll be ok :).  Obviously the search isn't working for some reason.  What happens if you run that same search from your local workstation?
[2012-11-14 13:52:22 -0500] masterkorp: works like a charm
[2012-11-14 13:52:28 -0500] masterkorp: (from knife)
[2012-11-14 13:52:35 -0500] geekbri: Hrm interesting.
[2012-11-14 13:53:15 -0500] masterkorp: [2012-11-14T13:48:26+00:00] INFO: *** Chef 10.14.4 ***
[2012-11-14 13:53:21 -0500] geekbri: what happens if you try something in your recipe like passing the search a block
[2012-11-14 13:53:23 -0500] masterkorp: maybe its the outaded client ?
[2012-11-14 13:53:43 -0500] geekbri: I doubt it, I'm using 0.10.8
[2012-11-14 13:53:46 -0500] geekbri: and my searc hworks fine
[2012-11-14 13:55:00 -0500] masterkorp: my server is 10.16.2
[2012-11-14 13:55:29 -0500] masterkorp: geekbri: http://pastie.org/5377117
[2012-11-14 13:55:40 -0500] geekbri: Oh it could be possible that is the issue then, although I suspect unlikely
[2012-11-14 13:55:52 -0500] masterkorp: "Cannot find a resource for  search on ubuntu version 12.04"
[2012-11-14 13:55:58 -0500] masterkorp: what the heck
[2012-11-14 13:56:26 -0500] geekbri: Right so the reason I assume that is happening is that resources are caught withe method_missing I believe
[2012-11-14 13:56:28 -0500] masterkorp: thing is: i use search on another recipe and works fine
[2012-11-14 13:56:46 -0500] geekbri: so whats happening is the search method doesn't exist for whatever reason, so it is being caught by method_missing and treated liek a resource
[2012-11-14 13:56:54 -0500] geekbri: I THIKN that is what is happening.
[2012-11-14 13:57:16 -0500] geekbri: Could it be that you have a previous resource with a mismatched do/end
[2012-11-14 13:57:19 -0500] masterkorp: http://pastie.org/private/y0byj0a7jeou3m2f78rn9a
[2012-11-14 13:57:55 -0500] masterkorp: geekbri: Do I ? where ?
[2012-11-14 13:58:35 -0500] geekbri: I don't see a mismatched pair
[2012-11-14 13:58:42 -0500] _rc: since the error is in server.rb, it'll work better to share that
[2012-11-14 13:59:00 -0500] masterkorp: http://pastie.org/private/7aqcc57g5duszihnwwbta
[2012-11-14 13:59:04 -0500] masterkorp: here
[2012-11-14 13:59:45 -0500] masterkorp: full recipe
[2012-11-14 14:00:07 -0500] _rc:   search(:node, "*:*") do |result|
[2012-11-14 14:00:31 -0500] _rc: that'll want to be search().each do.
[2012-11-14 14:01:04 -0500] masterkorp: oops outdated pastie
[2012-11-14 14:01:33 -0500] masterkorp: http://pastie.org/private/ve4xne8aw2m7ha6wo2lowg
[2012-11-14 14:02:01 -0500] masterkorp: that does not change a thing
[2012-11-14 14:02:40 -0500] masterkorp: Any ideas ?
[2012-11-14 14:02:44 -0500] masterkorp: Im desperate
[2012-11-14 14:05:47 -0500] masterkorp: hmm, did you notice that extra space before search ??
[2012-11-14 14:07:05 -0500] masterkorp: ITS WAS A SPACE
[2012-11-14 14:07:13 -0500] masterkorp: as in " search"
[2012-11-14 14:07:26 -0500] masterkorp: it was being passed as that
[2012-11-14 14:07:30 -0500] masterkorp: no idea why
[2012-11-14 14:07:44 -0500] masterkorp: i re-indented it and works
[2012-11-14 14:07:51 -0500] masterkorp: DA FUCK
[2012-11-14 14:08:15 -0500] geekbri: I suspected it was some sort of syntax error.
[2012-11-14 14:08:30 -0500] geekbri: whitespace doesn't matter much in ruby, excluding newlines
[2012-11-14 14:08:33 -0500] geekbri: so that is a bit strange.
[2012-11-14 14:08:52 -0500] masterkorp: there was no newline
[2012-11-14 14:09:16 -0500] masterkorp: or a traling whitespace on the "else " above it
[2012-11-14 14:09:28 -0500] masterkorp: still quite nerve racking
[2012-11-14 14:09:30 -0500] geekbri: weird.
[2012-11-14 14:09:33 -0500] masterkorp: i need air
[2012-11-14 14:12:16 -0500] _rc: some weird unicode whitespace maybe
[2012-11-14 14:19:04 -0500] masterkorp: ok now i got some air
[2012-11-14 14:20:03 -0500] gchristensen: masterkorp: did you copy paste any of this from anywhere? like the opscode wiki?
[2012-11-14 14:20:31 -0500] masterkorp: gchristensen: no
[2012-11-14 14:20:34 -0500] gchristensen: or masterkorp, did you type it all by hand?
[2012-11-14 14:20:38 -0500] masterkorp: yes
[2012-11-14 14:20:48 -0500] masterkorp: well i use snipptes
[2012-11-14 14:20:57 -0500] masterkorp: but those do not have weird spaces
[2012-11-14 14:21:41 -0500] masterkorp: ok, now in with is code i get this http://pastie.org/5377222
[2012-11-14 14:21:51 -0500] masterkorp: Not that i am using it like this
[2012-11-14 14:22:00 -0500] masterkorp: Can I use puts in chef ?
[2012-11-14 14:23:13 -0500] masterkorp: hmm, usinf result.to_s works
[2012-11-14 14:24:05 -0500] intinig: hi guys I have a problem that is driving me crazy. There's a recipe I have that is totally ignored by chef when I put it in a role run_list
[2012-11-14 14:24:09 -0500] intinig: but it works otherwise fine
[2012-11-14 14:24:16 -0500] intinig: if I manually add it to the node run list
[2012-11-14 14:24:32 -0500] masterkorp: intinig: those bugs suck
[2012-11-14 14:24:49 -0500] masterkorp: i still remenber talking to you yesterday about that
[2012-11-14 14:24:52 -0500] masterkorp: good luck
[2012-11-14 14:24:58 -0500] intinig: masterkorp: I didn't even sleep last night
[2012-11-14 14:25:02 -0500] intinig: it's driving me crazy
[2012-11-14 14:25:14 -0500] intinig: so much that I can't even do other more important work I have to do :)
[2012-11-14 14:25:35 -0500] gchristensen: intinig: are you using chef or chef
[2012-11-14 14:25:36 -0500] gchristensen: solo
[2012-11-14 14:26:27 -0500] masterkorp: he is using chef-server logically
[2012-11-14 14:26:27 -0500] intinig: gchristensen: chef
[2012-11-14 14:26:29 -0500] intinig: hosted chef
[2012-11-14 14:26:52 -0500] intinig: the role shows the recipe
[2012-11-14 14:26:54 -0500] gchristensen: intinig: when you log in to the manager and look at the role, does it have that recipe?
[2012-11-14 14:26:56 -0500] gchristensen: oy
[2012-11-14 14:27:01 -0500] intinig: yes
[2012-11-14 14:27:05 -0500] intinig: every change I make on the role
[2012-11-14 14:27:08 -0500] intinig: is reflected immediately
[2012-11-14 14:27:12 -0500] intinig: but for anything regarding that recipe
[2012-11-14 14:27:21 -0500] intinig: no matter where I put it in the run list
[2012-11-14 14:27:33 -0500] intinig: I am going to make one last attempt and change the recipe name
[2012-11-14 14:27:50 -0500] masterkorp: intinig: Does creating another role and adding the recipe to the run_list works ?
[2012-11-14 14:27:55 -0500] intinig: masterkorp: no
[2012-11-14 14:28:10 -0500] intinig: masterkorp: I have three different roles with the same recipe and it doesn't show anywhere in run lists on nodes
[2012-11-14 14:28:11 -0500] masterkorp: this could be a hosted chef problem
[2012-11-14 14:28:21 -0500] intinig: either freshly provisioned nodes
[2012-11-14 14:28:25 -0500] intinig: or pre existing ones
[2012-11-14 14:29:18 -0500] masterkorp: http://pastie.org/5377248
[2012-11-14 14:29:25 -0500] masterkorp: Alright now i get this
[2012-11-14 14:29:31 -0500] itchyouch: Hey is fnichol's knife server plugin one of the only code as infra stratgies? Or is there other stuff?
[2012-11-14 14:29:40 -0500] masterkorp: #(erubis):22: syntax error, unexpected '}', expecting keyword_end
[2012-11-14 14:29:46 -0500] masterkorp: da heck
[2012-11-14 14:29:59 -0500] masterkorp: do you guys see any syntax problem ?
[2012-11-14 14:30:00 -0500] itchyouch: Is there other stuff used for backup and disaster recovery?
[2012-11-14 14:30:17 -0500] _rc: masterkorp: did you show us the template?
[2012-11-14 14:30:19 -0500] gchristensen: masterkorp: that error is in the template
[2012-11-14 14:30:29 -0500] gchristensen: as noted by the TemplateError
[2012-11-14 14:30:41 -0500] _rc: erubis is the template processor
[2012-11-14 14:31:33 -0500] masterkorp: another weird space :O
[2012-11-14 14:31:45 -0500] masterkorp: yeah thanks, i am derp'ing today
[2012-11-14 14:35:39 -0500] masterkorp: Also search in the recipes returns and enumerator, not an array (unlike it says on the wiki)
[2012-11-14 14:36:45 -0500] masterkorp: _rc: so .each() on the search is actually unecessary
[2012-11-14 14:40:39 -0500] masterkorp: now i get this http://pastie.org/5377307
[2012-11-14 14:40:47 -0500] masterkorp: "undefined method `name' for [node[dumbclient.vm], node[icinga.vm]]:Array"
[2012-11-14 14:41:32 -0500] masterkorp: http://pastie.org/private/2fcawunwylgjlr0ftuso8q
[2012-11-14 14:41:39 -0500] masterkorp: the template
[2012-11-14 14:42:02 -0500] masterkorp: oh i got it
[2012-11-14 14:42:05 -0500] masterkorp: derp derp
[2012-11-14 14:48:32 -0500] masterkorp: now this http://pastie.org/5377341
[2012-11-14 14:48:40 -0500] masterkorp: "can't convert String into Integer"
[2012-11-14 14:48:49 -0500] masterkorp: why is even erubis trying this ?
[2012-11-14 14:49:04 -0500] masterkorp: http://pastie.org/private/iczeflnta676cyjm8o3fhg
[2012-11-14 14:49:07 -0500] masterkorp: recipe
[2012-11-14 14:49:31 -0500] masterkorp: also i'd like to now why node["name"] its nil inside the recipe
[2012-11-14 14:49:59 -0500] _rc: where are you adding two values together in the template?
[2012-11-14 14:50:31 -0500] intinig: ok, changing name to the recipe
[2012-11-14 14:50:35 -0500] intinig: doesn't work
[2012-11-14 14:50:38 -0500] intinig: it still is ignored by chef
[2012-11-14 14:50:52 -0500] masterkorp: _rc: i think i am not doing that ? http://pastie.org/private/q164uv1uho6kwaysnvla7q the template
[2012-11-14 14:53:25 -0500] _rc: does the /srv/chef/file_store/chef-stacktrace.out point you more precisely?
[2012-11-14 14:55:07 -0500] masterkorp: http://pastie.org/5377373
[2012-11-14 14:55:10 -0500] masterkorp: yes
[2012-11-14 14:55:11 -0500] masterkorp: line 13
[2012-11-14 14:55:29 -0500] masterkorp: i am pretty sure its because node["name"] its nil
[2012-11-14 14:55:32 -0500] masterkorp: no idea why
[2012-11-14 14:56:03 -0500] masterkorp: http://pastie.org/5377377
[2012-11-14 14:56:14 -0500] masterkorp: which is not nil as obvious
[2012-11-14 14:57:42 -0500] masterkorp: welp
[2012-11-14 14:59:03 -0500] intinig: ok
[2012-11-14 14:59:05 -0500] intinig: an interesting update
[2012-11-14 14:59:09 -0500] intinig: if I create a new role
[2012-11-14 14:59:13 -0500] intinig: that has nothing in it but that recipe
[2012-11-14 14:59:25 -0500] intinig: it does work
[2012-11-14 14:59:41 -0500] masterkorp: You should open a ticket for that
[2012-11-14 15:00:01 -0500] masterkorp: pretty sure its a problem on the hosted database
[2012-11-14 15:22:37 -0500] intinig: there: http://tickets.opscode.com/browse/CHEF-3606
[2012-11-14 15:22:41 -0500] intinig: in case someone can help me :)
[2012-11-14 15:26:32 -0500] ssd7: intinig: So, have you confirmed that the recipe isn't running other than by looking at knife node show.  That is, have you looked at the logs from chef-client on the machines and verfied that the recipe isn't actually running?
[2012-11-14 15:27:57 -0500] masterkorp: yeah he pasted logs here
[2012-11-14 15:29:01 -0500] ssd7: masterkorp: Ahh, thanks. Will check IRC logs.
[2012-11-14 15:29:58 -0500] kryptek: My coworker wants to do away with controlling the versions of all of our cookbooks.  Currently, in our environment files, we specify the versions of each cookbook we want to use.  His argument is that by specifying the versions like that, we have environments that result in different run lists
[2012-11-14 15:30:01 -0500] kryptek: I think he's crazy.
[2012-11-14 15:30:54 -0500] paulmooring: kryptek: what does he want to use environments for then?
[2012-11-14 15:31:09 -0500] _rc: Well he's right, you do.  That's the point in doing it.
[2012-11-14 15:31:29 -0500] wassy121: Hey all, whenever I do a chef-client run on any of my clients, I get an error like "HTTP Request Returned 404 Not Found: No routes match the request: /reports/nodes/NODENAME/runs"
[2012-11-14 15:31:36 -0500] ssd7: intinig: masterkorp Hrmm, not seeing those logs.
[2012-11-14 15:32:17 -0500] ssd7: wassy121: That error is the ground work for some potential future features, it shouldn't affect your chef-client run.
[2012-11-14 15:32:21 -0500] wassy121: What's the deal with that?  Is there some reporting service that I don't have set up, or need to set up?
[2012-11-14 15:32:36 -0500] wassy121: Ah, so it's only .16.0 or greater then?
[2012-11-14 15:32:45 -0500] yfeldblum: kryptek, i don't use environments to lock cookbook versions either
[2012-11-14 15:33:00 -0500] ssd7: wassy121: I'd have to double check, but I think it might be ins ome 10.14 versions as well
[2012-11-14 15:33:07 -0500] kryptek: yfeldblum,  But do you bump your cookbook versions when you work on them?
[2012-11-14 15:33:22 -0500] yfeldblum: kryptek, no
[2012-11-14 15:33:56 -0500] kryptek: yfeldblum,  So what's your recommended approach?
[2012-11-14 15:35:02 -0500] yfeldblum: kryptek, external cookbooks gotten from elsewhere have versions, and the whole chef-repo has a version, but the individual cookbooks inside the repository (that aren't gotten from elsewhere) do not necessarily have versions
[2012-11-14 15:35:41 -0500] kryptek: But let's say you run chef on your different environments (testing, staging, prod) on a regular basis
[2012-11-14 15:35:47 -0500] yfeldblum: kryptek, my approach is that your whole chef-repo has a single version altogether, and if a cookbook needs a version of its own, then it needs to be a separate project with its own separate development, testing, etc quite apart from your main infra
[2012-11-14 15:35:53 -0500] kryptek: How do you prevent from someone on the team monkeying something in a cookbook and screwing up another chef run?
[2012-11-14 15:36:35 -0500] yfeldblum: kryptek, my approach is also that there's one chef-server per instance of the infrastructure (e.g. a chef-server for the staging instance of the infrastructure)
[2012-11-14 15:36:48 -0500] kryptek: Ahh, that makes sense in that case
[2012-11-14 15:36:54 -0500] kryptek: We use hosted chef right now but only have one chef server
[2012-11-14 15:38:08 -0500] yfeldblum: kryptek, you can use hosted-chef for the production infrastructure and your own oss chef-server for alternate infrastructures
[2012-11-14 15:41:14 -0500] shillinm: anyone know if I can use multiple only_if's in a resource?
[2012-11-14 15:41:38 -0500] kryptek: shillinm,  only if { condition1 && condition 2 }
[2012-11-14 15:41:56 -0500] kryptek: I'm guessing you can probably use multiple separate statements, never tried though
[2012-11-14 15:42:19 -0500] shillinm: thanks, I was gonna try it but figured I'd see if anyone had done it before
[2012-11-14 15:42:47 -0500] kryptek: I'd be interested in knowing if separate work;  if you try lemme know :)
[2012-11-14 15:42:56 -0500] yfeldblum: shillinm, yes you can
[2012-11-14 15:43:53 -0500] shillinm: great, thanks to both of you
[2012-11-14 15:51:35 -0500] masterkorp: alright i know think the problem is of chef-client
[2012-11-14 15:51:45 -0500] masterkorp: search results are incomplete
[2012-11-14 15:51:53 -0500] masterkorp: like name and hostname are empty
[2012-11-14 15:57:03 -0500] fromonesrc: is chef a good fit for building out windows 7 vms?
[2012-11-14 15:57:23 -0500] masterkorp: chef does not really build windows vms
[2012-11-14 15:58:02 -0500] fromonesrc: sorry, not the building of the vm itself, but provisioning the box with cookbooks
[2012-11-14 15:58:16 -0500] fromonesrc: I know chef can provision os x machines, can it do the same for windows consumer os?
[2012-11-14 15:58:35 -0500] qhartman: I've heard mixed stories about chef on Windows. I know it's supported, but I don't know how well it actually works
[2012-11-14 15:58:42 -0500] geekbri: People are using chef to provision windows machines.  I am not one of those people.
[2012-11-14 15:59:01 -0500] qhartman: most of the community cookbooks are geared for *nix though, so you'll likely have to be making a lot of your own
[2012-11-14 15:59:36 -0500] fromonesrc: I'm ok with writing my own cookbooks, just trying to understand whether chef is a good tool for running the cookbooks on windows consumer os
[2012-11-14 15:59:49 -0500] fromonesrc: I know it is suited for windows server os
[2012-11-14 16:00:03 -0500] qhartman: I don't think chef differentiates between the two
[2012-11-14 16:00:29 -0500] qhartman: all the primitives that I'm aware of that it uses should be the same
[2012-11-14 16:06:32 -0500] fromonesrc: qhartman: my goal is to have chef provision windows 7 (or other win consumer os) in the cloud. do you have any suggestions?
[2012-11-14 16:06:54 -0500] fromonesrc: aws does not support windows consumer os s
[2012-11-14 16:07:19 -0500] qhartman: fromonesrc, right, that was going to be my first point, I don't know of any cloud services that support anything other than Server
[2012-11-14 16:07:52 -0500] qhartman: fromonesrc, if you were doing something in your own vmware stack or something like that, it would likely be much simpler
[2012-11-14 16:24:16 -0500] drewww: I have a stupid conceptual question: if I put a cookbook dependency in my metadata.rb, that shouldn't execute the depended-on cookbook, right?
[2012-11-14 16:26:31 -0500] pdeschen: yo
[2012-11-14 16:27:16 -0500] drewww: (nevermind, I'm an idiot - had it in my role file and had forgotten)
[2012-11-14 16:28:07 -0500] pdeschen: we had a rather philosophical/rhetorical question about cookbook/recipe organization
[2012-11-14 16:28:44 -0500] pdeschen: we are using couchdb + nginx and we need to define a proxy_pass within nginx to forward to couchdb
[2012-11-14 16:29:12 -0500] pdeschen: so we defined a new recipe for that within our infrastructure
[2012-11-14 16:29:47 -0500] pdeschen: could this recipe be included within couchdb cookbook or it doesn't belong here?
[2012-11-14 16:30:21 -0500] yfeldblum: drewww, anyway that assumption is correct
[2012-11-14 16:33:38 -0500] pdeschen: any opinion on this?
[2012-11-14 16:35:20 -0500] paulmooring: pdeschen: it doesn't matter too much, but my feeling is that if the configuration is in nginx it belongs in the nginx cookbook
[2012-11-14 16:35:42 -0500] geekbri: Typically I would define a role for such a thing.
[2012-11-14 16:36:38 -0500] geekbri: Roles are the collection of instructions, strongly ordered, that make your server do what it should do
[2012-11-14 16:36:40 -0500] pdeschen: paulmooring: thanks, for now we simply defined a independent role but we wanted to share back that recipe to community
[2012-11-14 16:38:48 -0500] pdeschen: geekbri: we do have a role/recipe for that specific piece of configuration but we were simply wondering whether it could belong to the couchdb cookbook
[2012-11-14 16:39:11 -0500] pdeschen: maybe we are just splitting hairs here
[2012-11-14 16:39:38 -0500] geekbri: Yeah tough question there.
[2012-11-14 16:39:50 -0500] geekbri: I could see an argument on both sides
[2012-11-14 16:40:44 -0500] pdeschen: geekbri: hence our internal discussions on thisthere's a grey linesome were in favor and some others not
[2012-11-14 16:41:19 -0500] geekbri: my argument would be that the nginx cookbook should provide an easy way to configure proxy passes through role files
[2012-11-14 16:41:25 -0500] geekbri: then it would belong in the nginx cookbook
[2012-11-14 16:41:32 -0500] paulmooring: geekbri: I'm +1 on that
[2012-11-14 16:42:01 -0500] paulmooring: the specifics should be in a role or data bag and the recipe should be a better abstraction of proxy passes in general
[2012-11-14 16:42:16 -0500] geekbri: yeah
[2012-11-14 16:42:26 -0500] geekbri: +1 in return for a mobius strip
[2012-11-14 16:42:38 -0500] paulmooring: also it should definitely be a data bag :)
[2012-11-14 16:43:05 -0500] geekbri: Yeah, when I create a cookbook it depends on the level of complexity for the configuration
[2012-11-14 16:43:15 -0500] pdeschen: geekbri, paulmooring: it's more then a mere proxy_pass, it needs chunking support (which we already added to the nginx cookbook) but it also needs specific error code handling and stuff for couchdb to work
[2012-11-14 16:43:16 -0500] geekbri: I would say for something like an nginx config it would make sense to pull it from a databag
[2012-11-14 16:43:47 -0500] geekbri: you could then set an attribute in the role file which maybe has some sort of selector so it knows which configuration files to lay down and enable
[2012-11-14 16:44:21 -0500] pdeschen: geekbri: oh interesting
[2012-11-14 16:45:08 -0500] geekbri: so this way you just have a bunch of configurations in a databag, and the roles determine which ones get laid down in the sites-available directory, you could then also have a true/false flag in the databag that deteremine if it should be symlinked in sites-enabled?
[2012-11-14 16:45:26 -0500] geekbri: I'm just shooting off ideas here though :)
[2012-11-14 16:46:41 -0500] pdeschen: yeah got it but then we wouldn't be sharing back that piece of config into the cookbook (and that's what we were actually looking in to do)
[2012-11-14 16:47:29 -0500] pdeschen: alrigthy thank you folksseems like there a grey line in this regard :-)
[2012-11-14 16:49:12 -0500] geekbri: Well
[2012-11-14 16:49:27 -0500] geekbri: Thats what readme.md's are for!
[2012-11-14 16:49:30 -0500] geekbri: hehe and blog posts
[2012-11-14 16:52:02 -0500] pdeschen: a blog post would be a good idea indeed
[2012-11-14 16:52:56 -0500] pdeschen: thanks geekbri
[2012-11-14 16:53:10 -0500] geekbri: .you're welcome, doesn't sound like i helped too much though :)
[2012-11-14 16:57:17 -0500] masterkorp: Hmm, updating chef-client does it
[2012-11-14 17:10:10 -0500] barnacles: Here's an interesting question: I have an attribute that is set in a recipe, the attribute is set to an environment variable + a string. I ran into the problem of when I did "sudo chef-client" the environment variable was not kept. To solve this I added the environment variable to the sudoers file under env_keep. That worked just fine when I manually ran "sudo chef-client", however when the chef-client runs automatically the attribut
[2012-11-14 17:10:41 -0500] yfeldblum: barnacles, using environment variables with chef?
[2012-11-14 17:10:50 -0500] yfeldblum: barnacles, easy way to run into trouble
[2012-11-14 17:11:12 -0500] barnacles: yfeldblum: Yar, so it seems..
[2012-11-14 17:11:50 -0500] barnacles: Regardless, any ideas?
[2012-11-14 17:12:39 -0500] yfeldblum: barnacles, yep: don't do that
[2012-11-14 17:14:20 -0500] barnacles: yfeldblum: mmm, alright I'll change it. Thanks for the input
[2012-11-14 17:50:37 -0500] jkyle: we were looking at how we could use multiple encrypted data bag keys in one chef repository, say one for development and one for production. Someone mentioned I could use namespacing in data bags...but I can't find any references to that effect.
[2012-11-14 17:50:56 -0500] jkyle: so, if that exists where can I find info and if it doesn't...what do others do to solve this problem?
[2012-11-14 17:54:40 -0500] yfeldblum: jkyle, there's no namespacing feature
[2012-11-14 17:55:08 -0500] yfeldblum: jkyle, you can simply name your data-bags and data-bag items however you like, possibly embedding e.g. the environment name in either the data-bag name or data-bag item name
[2012-11-14 17:56:38 -0500] r5|ryan: "production": { "server1": 1234, "server2" 1235 }, "devel": { "server1": 1236, "server2" 1237 }
[2012-11-14 17:56:50 -0500] r5|ryan: I do it but I hate it
[2012-11-14 18:09:36 -0500] xerxas: any date for a ubuntu 12.10 bootstrap ?
[2012-11-14 18:27:57 -0500] qhartman: xerxas, Does the omnibus install not work?
[2012-11-14 18:28:47 -0500] xerxas: qhartman: I'm not sure what I'm using , I'm on EC2  , I use knife-ec2 , which seems to call http://www.opscode.com/chef/install.sh
[2012-11-14 18:29:28 -0500] xerxas: qhartman: works on 12.04 , and on 12.10 it tells me it doesn't yet support it
[2012-11-14 18:29:34 -0500] qhartman: xerxas, I believe that would be omnibus.
[2012-11-14 18:29:56 -0500] whilp:  /buffer tobert
[2012-11-14 18:30:00 -0500] whilp: >_>
[2012-11-14 18:30:59 -0500] qhartman: xerxas, there may be an option to force it. Out of curiosity, why are you using something other than the LTS release on AWS? It seems like in most cases the benefits of the LTS would far outweight the slightly improved "freshness" of 12.10
[2012-11-14 18:31:40 -0500] xerxas: I prefer to break things early ;)
[2012-11-14 18:31:43 -0500] xerxas: if it's available
[2012-11-14 18:32:25 -0500] xerxas: and I'm deploying a homemade application that needs fresh packages ;)
[2012-11-14 18:32:35 -0500] qhartman: gotcha, sorry I don't have a better answer for you.
[2012-11-14 18:32:42 -0500] xerxas: I tried to force it but don't know how
[2012-11-14 18:32:58 -0500] zuhaib: xerxas: use a different bootstrap file
[2012-11-14 18:33:03 -0500] xerxas: with -T ?
[2012-11-14 18:33:06 -0500] xerxas: which one ?
[2012-11-14 18:33:16 -0500] zuhaib: I think there is one that is included that uses ruby gems
[2012-11-14 18:33:35 -0500] qhartman: http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-11-14 18:33:41 -0500] xerxas:    -d, --distro DISTRO              Bootstrap a distro using a template; default is 'chef-full'
[2012-11-14 18:33:52 -0500] zuhaib: --template-file ./bootstraps/ubuntu10.04.erb is what we use
[2012-11-14 18:34:16 -0500] qhartman: I had to write my own bootstrap file when I initially deployed Centos 6.2 some months ago
[2012-11-14 18:34:37 -0500] zuhaib: So you can use ubuntu12.04-gems and see if tht works otherwise take one and modify it
[2012-11-14 18:34:39 -0500] qhartman: using the ubuntu12.04-gems one as a template should get you going pretty quickly
[2012-11-14 18:34:41 -0500] xerxas: so the bootstraps available are in the gem.path ?
[2012-11-14 18:34:58 -0500] xerxas: qhartman: yeah, that was what I wanted to try
[2012-11-14 18:35:01 -0500] qhartman: they are part of the knife installation, don't remember exactly where they are
[2012-11-14 18:35:13 -0500] xerxas: -gems, means "not omnibus" , right ?
[2012-11-14 18:35:15 -0500] zuhaib: the top of the doc qhartman link to tells you
[2012-11-14 18:35:28 -0500] zuhaib: bootstrap directory in the installed Chef Knife library (Location varies depending how you installed Chef).
[2012-11-14 18:35:28 -0500] zuhaib: bootstrap directory in the $PWD/.chef, e.g. in ~/chef-repo/.chef.
[2012-11-14 18:35:29 -0500] zuhaib: bootstrap directory in the users $HOME/.chef.
[2012-11-14 18:35:57 -0500] qhartman: That wiki page lays it all out pretty well
[2012-11-14 18:36:10 -0500] xerxas: yeah
[2012-11-14 18:36:11 -0500] xerxas: thanks
[2012-11-14 18:36:12 -0500] xerxas: looking
[2012-11-14 18:40:49 -0500] xerxas: do you know what is missing to use chef-full ?
[2012-11-14 18:40:49 -0500] occupant: so I have a role I can't apply because it seemingly depends on another role which I have deleted. but when I "show role", there's no reference to the deleted role inside. where is chef getting this association?
[2012-11-14 18:48:07 -0500] cassianoleal: hi, quick question: does the application cookbook absolutely require a chef-server in order to run?
[2012-11-14 18:48:43 -0500] cassianoleal: I'm trying to run it in a Vagrant VM, but I get connection refused errors to the API
[2012-11-14 18:48:49 -0500] cassianoleal: I'm using chef-solo, btw
[2012-11-14 18:52:18 -0500] UForgotten: very noob question
[2012-11-14 18:52:36 -0500] UForgotten: I have a recipe and I want to verify the existance of all the node attributes
[2012-11-14 18:53:18 -0500] UForgotten: I've tried something along the lines of if ( node[:var1] && node[:var2] && .. ) then dothis else dontdothis end
[2012-11-14 18:55:36 -0500] xerxas: zuhaib, qhartman , thanks, works, for now ;)
[2012-11-14 18:55:52 -0500] zuhaib: np
[2012-11-14 18:57:12 -0500] UForgotten: the gigantic if doesn't work, any thoughts?
[2012-11-14 18:57:47 -0500] jaypipes: if anyone has any insights to http://lists.opscode.com/sympa/arc/chef/2012-11/msg00225.html, I'd be most appreciative!
[2012-11-14 18:59:41 -0500] UForgotten: nevermind, stupid ruby formatting thing :(
[2012-11-14 19:00:24 -0500] pdoc1: hello, i am wondering how i can create a function in chef that can be called from another recipe and will return some data. currently ive created a lwrp that I can call with a parameter. It makes an http request and then sets an attribute with node.set. the problem is that when i execute a chef run on one of my nodes, the attribute is not set yet even though im setting the attributes earlier in the run list then the recipe that uses it
[2012-11-14 19:03:06 -0500] pdoc1: is a lwrp the right way to do something like this? how can i do this without having to set an attribute for the returned data?
[2012-11-14 19:07:21 -0500] cilquirm: hi, how do i create custom chef commands?
[2012-11-14 19:08:06 -0500] cilquirm: for use in my recipes, to abstract away the necessary template/file management and provide a more expressive read of the recipe
[2012-11-14 19:17:09 -0500] thedeeno: how do you go about installing gems required by custom lwrp?
[2012-11-14 19:17:30 -0500] thedeeno: I need to use the PG gem, but it doesn't seem the be available in the context of my provider
[2012-11-14 19:20:14 -0500] emilsoman: I'm using chef-client cookbook to configure a chef client on my machine . Is there a way to pass node attributes during this bootstrap , so that these attributes will be set on the node after the chef-client boots ?
[2012-11-14 19:20:17 -0500] geekbri: Here's an interesting question.  I've defined multiple service resources, lets call them resource1 and resource2.  I'm trying to call them progmatically by constructing the resource name as a string then calling eval on it.  When I do this i get "Cannot find a resource for resource1 on ubuntu version 10.04".  However if I just call the resource itself in the DSL it works fine
[2012-11-14 19:20:17 -0500] thedeeno: excuse me, not provider, lib. The context of my lib
[2012-11-14 19:20:45 -0500] geekbri: Anybody have an idea why eval would fail to have the method call picked up?
[2012-11-14 19:21:21 -0500] r5|ryan: thedeeno: chef_gem?
[2012-11-14 19:21:54 -0500] thedeeno: yeah, it's a shortcut for the package resource. Supposedly it's suppose to add a gem to chef's gem repository
[2012-11-14 19:22:27 -0500] thedeeno: I'm pretty much trying to create something similar to this example (at the bottom): http://wiki.opscode.com/display/chef/Libraries
[2012-11-14 19:22:50 -0500] thedeeno: but I don't understand how 'sequel' was installed on the node. In my case 'pg' won't load because it's not installed
[2012-11-14 19:22:51 -0500] geekbri: cilquirm: perhaps you meant creating your own resources and providers?  LWRP's are what you want.  You can also just create general ruby libraries and put them in your cookbooks library directory for general use.
[2012-11-14 19:23:33 -0500] thedeeno: I do have my own lwrp, but it's kinda complex, so I'm attempting to leverage some 'library' modules.
[2012-11-14 19:23:42 -0500] thedeeno: (from withing the provider)
[2012-11-14 19:23:48 -0500] thedeeno: maybe this is the wrong way to do things?
[2012-11-14 19:24:26 -0500] thedeeno: geekbri: ignore that :) didn't see it was aimed at cilquirm
[2012-11-14 19:24:38 -0500] geekbri: :
[2012-11-14 19:24:39 -0500] geekbri: :)
[2012-11-14 19:25:31 -0500] geekbri: thedeeno: that documentation could be potentially old.  Back in the day it was typical for chef to be installed as a system gem.  Therefore just installing a gem using the ruby_gem resource was fine as it would install to the system ruby gems.  A lot of people now install chef using the omnibus so chef_gem will install that gem to chefs ruby gems collection.
[2012-11-14 19:25:47 -0500] geekbri: Therefore you probably need to use chef_gem to get whatever ruby gem it is you want installed to the chef omnibus ruby gems, before you can require it
[2012-11-14 19:25:59 -0500] geekbri: I haven't really been following your conversation, but that is the impression i get :)
[2012-11-14 19:26:19 -0500] geekbri: TLDR = ruby_gems installs to system gems, chef_gem installs to chefs gems
[2012-11-14 19:26:46 -0500] thedeeno: geekbri: ok, that's what I'm trying to do. I'm just not sure where to put the chef_gem call. If I put it in the my default recipe it's erroring before being run, since it's not installed when loading my library.
[2012-11-14 19:26:52 -0500] thedeeno: chicken egg problem...
[2012-11-14 19:27:26 -0500] thedeeno: it appears my library file get's loaded before the run (I expect during the compile phase)
[2012-11-14 19:29:32 -0500] cilquirm: geekbri: i think i found what i'm looking for : definitions
[2012-11-14 19:29:41 -0500] cilquirm: i'm using the runit one as a template
[2012-11-14 19:29:43 -0500] geekbri: thedeeno: The order is indeed libraries/lwrps/attributes/resource definitions
[2012-11-14 19:30:04 -0500] rberger: Is there anyway to tell a template resource to use a template that is managed outside of chef cookbooks? We want to have a config template managed in the app repository, not in the chef cookbook
[2012-11-14 19:30:14 -0500] geekbri: cilquirm: definitions are useful for wrapping exisiting resources.  Keep in mind you cannot notify or subscribe with definitions
[2012-11-14 19:30:22 -0500] geekbri: cilquirm: definitions end up being replaced by the resource they define.
[2012-11-14 19:30:56 -0500] Ramblurr: the latest postgres cookbook uses an array of hashes to create the pg_hba config file.. how can I append to this array in my cookbook?
[2012-11-14 19:32:03 -0500] thedeeno: Ramblurr: attributes are merged during the chef run. So you could just set the attribute node.postgresql[:client_authentication] = <whatever> and as long as your position value is different it will be merged in
[2012-11-14 19:32:28 -0500] thedeeno: Ramblurr: http://wiki.opscode.com/display/chef/Deep+Merge
[2012-11-14 19:32:48 -0500] Ramblurr: thedeeno: yea, i read that page.. still a bit confused on how to make it work
[2012-11-14 19:33:41 -0500] geekbri: yfeldblum: I've got a ruby/chef question that I feel like you might be able to answer.  I'm trying to call a resource by constructing its name as a string then sending it through eval.  It seems unable to find the resource when I do that.  If I call that resource normally (without eval, written myself in ruby) it works just fine.  Any ideas?
[2012-11-14 19:33:48 -0500] Ramblurr: for example i tried: override['postgresql']['pg_hba'] = [{ my settings}]
[2012-11-14 19:34:09 -0500] Ramblurr: but that ended up in the default values being lost
[2012-11-14 19:34:22 -0500] geekbri: If I remember correctly with deep merge, as long as the item is an array, it will append to the array.  Unless of course you set yours as an override attribute and it was previously a default attribute.
[2012-11-14 19:34:32 -0500] yfeldblum: geekbri, 1) don't use eval, and 2) gist it?
[2012-11-14 19:34:43 -0500] geekbri: yfeldblum: I tried not using eval and that didn't work, and sure one secd
[2012-11-14 19:34:45 -0500] thedeeno: Ramblurr: sorry, I'm working with a different cookbook. I forgot. Lemme take a look. The cookbook I'm using uses a hash for the pg_hba not an array
[2012-11-14 19:35:35 -0500] Ramblurr: thedeeno:  here's the code https://github.com/hw-cookbooks/postgresql/commit/61aa7f44792fc546f871c6597951a8121a6a0bfa
[2012-11-14 19:35:48 -0500] Ramblurr: oops, that's the change that merged
[2012-11-14 19:36:23 -0500] Ramblurr: actual source: https://github.com/opscode-cookbooks/postgresql/blob/master/attributes/default.rb#L148
[2012-11-14 19:36:41 -0500] geekbri: yfeldblum: https://gist.github.com/4074238
[2012-11-14 19:37:34 -0500] thedeeno: Ramblurr: I think you're close. Instead of using 'overrides' use the same level of depth: 'default'
[2012-11-14 19:37:56 -0500] thedeeno: if you use another depth level I don't think it merges - it will assume you actually want to override the whole thing, which makes sense I think
[2012-11-14 19:38:21 -0500] thedeeno: Ramblurr: So, `default['postgresql']['pg_hba'] = [{ my settings}]`
[2012-11-14 19:38:38 -0500] geekbri: yfeldblum: I updated the gist with the contents of the resource collection
[2012-11-14 19:40:10 -0500] yfeldblum: geekbri, you might have more luck with this:
[2012-11-14 19:40:12 -0500] yfeldblum: geekbri, http://pastie.org/private/liww0dww8umevwwayig
[2012-11-14 19:40:37 -0500] geekbri: yfeldblum: ah yes, that seems like it would certainly work better.
[2012-11-14 19:40:43 -0500] Ramblurr: thedeeno: this is inside the attributes file of another cookbook that include_recipe's postgres
[2012-11-14 19:40:55 -0500] Ramblurr: this will still work?
[2012-11-14 19:41:02 -0500] Ramblurr: (or should work, raher)
[2012-11-14 19:41:02 -0500] yfeldblum: geekbri, http://pastie.org/private/spzmdz8w2ohvks6jddp5lq (fixed)
[2012-11-14 19:41:07 -0500] geekbri: yfeldblum: I'll go give that a shot.  I still don't understand why eval would be unable to find the resource though.  I even tried eval'ing a puts of the contents of the resource_collection and that works fine
[2012-11-14 19:42:12 -0500] yfeldblum: geekbri, because Chef::Resource does not respond to the message `redis6379`
[2012-11-14 19:42:13 -0500] thedeeno: Ramblurr: yeah, that should be ok.
[2012-11-14 19:42:22 -0500] yfeldblum: geekbri, Chef::Recipe, rather
[2012-11-14 19:42:38 -0500] geekbri: yfeldblum: right, its the resource object that catches it with method_missing...
[2012-11-14 19:43:09 -0500] Ramblurr: thedeeno: :\ the default changes are being written, but not my own
[2012-11-14 19:43:20 -0500] geekbri: yfeldblum: the code you posted worked great.  It should have occured to me to just act on the resource object itself, doh.  Thanks much
[2012-11-14 19:44:40 -0500] yfeldblum: geekbri, no prob
[2012-11-14 19:50:31 -0500] thedeeno: Ramblurr: what if you put your custom entries in a node or role directly (no recipe)?
[2012-11-14 19:53:22 -0500] Ramblurr: thedeeno: weird, only my entry is written, the defaults are lost
[2012-11-14 19:53:54 -0500] Ramblurr: and that's by adding "postgresql": { "pg_hba": [ { type: "local".... } ] }
[2012-11-14 19:55:06 -0500] thedeeno: in default attributes? or override attributes?
[2012-11-14 19:55:44 -0500] Ramblurr: this is my node's json file (using chef-solo)
[2012-11-14 19:55:57 -0500] Ramblurr: i'm not sure if that is override or default
[2012-11-14 19:56:22 -0500] thedeeno: your node's json file should have 2 sections: default_attributes and override_attributes
[2012-11-14 19:57:23 -0500] Ramblurr: o_0, oops
[2012-11-14 19:58:06 -0500] thedeeno: Ramblurr: I take it back, I don't think the node json would have those 2 sections
[2012-11-14 19:58:15 -0500] thedeeno: can you try creating a role and applying that to your node?
[2012-11-14 19:59:18 -0500] thedeeno: iirc, merging should just work if attributes are applied at the same level of precedence
[2012-11-14 19:59:21 -0500] thedeeno: there are those levels
[2012-11-14 19:59:23 -0500] thedeeno: http://wiki.opscode.com/display/chef/Attributes
[2012-11-14 19:59:41 -0500] Ramblurr: yea, that's what i understood from the docs too
[2012-11-14 20:01:59 -0500] btm: Live code review starting: http://youtu.be/v3fipQ-f5GQ
[2012-11-14 20:02:01 -0500] rava: role override_attributes should be applied to a node once it's added to that node's run_list right?
[2012-11-14 20:03:17 -0500] rava: or do they have to be present as attributes in the cookbook in order to be referenced in recipes?
[2012-11-14 20:04:42 -0500] rava: according to the docs, override_attributes should be applied regardless if those attributes are applied or not, slong as the node is in the given role
[2012-11-14 20:09:25 -0500] Ramblurr: thedeeno: ok! so that workd
[2012-11-14 20:09:40 -0500] Ramblurr: placing my entry in a role caused it to be merged
[2012-11-14 20:09:54 -0500] Ramblurr: so the defaults + my entry were written
[2012-11-14 20:10:19 -0500] rava: damnit, i can't seem to get these role attributes to apply to the node
[2012-11-14 20:11:04 -0500] thedeeno: ok, so either, a) the way you're doing it in the recipe is wrong or b) it's just broken
[2012-11-14 20:11:04 -0500] Ramblurr: thedeeno: but now, how to do it from a cookbook:\
[2012-11-14 20:11:12 -0500] Ramblurr: hah, yes
[2012-11-14 20:11:15 -0500] thedeeno: can you send me the line exactly?
[2012-11-14 20:11:35 -0500] rava: do i have to rebuild an index or something to get these attributes to show up?
[2012-11-14 20:11:53 -0500] rava: this role has 2 namespaces for attributes, one of them shows up fine for the node, but not the other
[2012-11-14 20:12:12 -0500] Ramblurr: thedeeno: default['postgresql']['pg_hba'] = [{:type => 'local', :db => node['newthing']['db_name'], :user => node['newthinge']['db_user'], :addr => nil, :method => 'ident'}]
[2012-11-14 20:12:36 -0500] fromonesrc: anyone here familiar with Ridley? getting a 'No routes match the request: /organizations/sandboxes' (Ridley::Errors::HTTPNotFound) when working with Berkshelf
[2012-11-14 20:13:51 -0500] thedeeno: Ramblurr: try: node.default['postgresql] ...
[2012-11-14 20:15:13 -0500] thedeeno: How do I do example 2 from a library? http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-11-14 20:15:44 -0500] thedeeno: when attempting to use resources I'm getting 'undefned method <resource> fir main:Object'
[2012-11-14 20:15:53 -0500] thedeeno: how do I call api more directly
[2012-11-14 20:23:27 -0500] rava: any reason why environment attributes wouldn't show up on a node?
[2012-11-14 20:24:08 -0500] daaaan: is there a way to do a normal chef run through shef?
[2012-11-14 20:24:14 -0500] rava: run_chef
[2012-11-14 20:24:18 -0500] daaaan: just returns 'true'
[2012-11-14 20:24:25 -0500] rava: you need to include the recipes
[2012-11-14 20:24:29 -0500] rava: recipe
[2012-11-14 20:24:39 -0500] rava: er, go into recipe mode
[2012-11-14 20:24:44 -0500] rava: include_recipe "blah::foo"
[2012-11-14 20:24:52 -0500] daaaan: how can i include an entire run list?
[2012-11-14 20:24:53 -0500] rava: run_chef
[2012-11-14 20:25:08 -0500] Ramblurr: thedeeno: no luck :(
[2012-11-14 20:25:09 -0500] daaaan: the node has a run list from json i loaded with -j
[2012-11-14 20:25:51 -0500] knuckolls: daaaan: if you go into recipe mode by typing "recipes" at the shef -z shell, you should be able to type run_chef and watch it run
[2012-11-14 20:25:57 -0500] knuckolls: at least in my experience, that works.
[2012-11-14 20:26:06 -0500] thedeeno: Ramblurr: can you try and specifiy the whole hash directly? You may also be having problems with things like node['newthinge']['db_user
[2012-11-14 20:26:11 -0500] thedeeno: being nil
[2012-11-14 20:26:15 -0500] thedeeno: depending on other things
[2012-11-14 20:26:22 -0500] daaaan: there we go, needed -z
[2012-11-14 20:26:27 -0500] daaaan: run list expanded properly
[2012-11-14 20:27:09 -0500] daaaan: but run_chef in recipe mode still returns 'true'
[2012-11-14 20:27:18 -0500] knuckolls: maybe it's chef_run
[2012-11-14 20:27:26 -0500] knuckolls: i dunno, those two commands are tricky
[2012-11-14 20:27:29 -0500] daaaan: that returns the iterator
[2012-11-14 20:27:39 -0500] knuckolls: hm
[2012-11-14 20:27:41 -0500] daaaan: and chef_run.resume returns an empty array
[2012-11-14 20:27:50 -0500] knuckolls: did the node bootstrap okay?
[2012-11-14 20:28:04 -0500] knuckolls: usually shef -z gets real mad unless i had at least one successful bootstrap on the node
[2012-11-14 20:28:11 -0500] daaaan: nope, it's a broken node that i'm trying to debug
[2012-11-14 20:28:20 -0500] knuckolls: i do this
[2012-11-14 20:28:23 -0500] daaaan: but i'm loading the run list and some overrides with -j
[2012-11-14 20:28:34 -0500] knuckolls: bootstrap a node with your base role so it has a successful run
[2012-11-14 20:28:41 -0500] knuckolls: then add to the run list via knife
[2012-11-14 20:28:47 -0500] knuckolls: then get up there and play with shef -z
[2012-11-14 20:29:00 -0500] knuckolls: i'm by no means a shef expert, but that's what's behaved for me
[2012-11-14 20:36:12 -0500] daaaan: getting closer with chef:recipe > node.recipes.each { |r| include_recipe r; nil }
[2012-11-14 20:36:26 -0500] daaaan: but my recipes require ohai data which doesn't seem to have run / been saved yet
[2012-11-14 20:42:32 -0500] kryptek: Is there any way to skip a recipe from running, in this case for a particular environment, aside from maybe wrapping all the recipe code in an if block?
[2012-11-14 20:42:58 -0500] rava: take it out of the environment run list?
[2012-11-14 20:44:19 -0500] yfeldblum: kryptek, put more things in recipes and fewer things in run-lists?
[2012-11-14 20:44:53 -0500] knuckolls: kryptek: just make a role that has different run lists per environment. simple enough
[2012-11-14 20:48:17 -0500] kryptek: yeah, agreed, was wondering for a coworkers particular use case
[2012-11-14 20:48:22 -0500] kryptek: thanks :)
[2012-11-14 21:07:32 -0500] btm: Cookbook review begins soon: hangout: https://plus.google.com/hangouts/_/79fedd39622a043d4846f1c4cfe580bbbffe501e?authuser=1&hl=en youtube: http://youtu.be/dnWxPeRLJJA
[2012-11-14 21:07:56 -0500] masterkorp: sweer
[2012-11-14 21:09:25 -0500] masterkorp: i="dnWxPeRLJJA";mplayer -fs $(curl -s "http://www.youtube.com/get_video_info?&video_id=$i" | echo -e $(sed 's/%/\\x/g;s/.*\(v[0-9]\.lscache.*\)/http:\/\/\1/g') | grep -oP '^[^|,]*')
[2012-11-14 21:09:31 -0500] masterkorp: for the cli fanboys
[2012-11-14 21:09:38 -0500] masterkorp: stream to mplayer :D
[2012-11-14 21:20:06 -0500] masterkorp: youtube-dl piped to mplayer also works
[2012-11-14 21:28:28 -0500] solarce: btm: I'm gonna work on a script to make mp3s and a podcast fee of the hangops.com youtube recordings, which i'll throw on github if you're interested
[2012-11-14 21:29:58 -0500] masterkorp: sweet
[2012-11-14 21:41:33 -0500] kryptek: Is there a way I can suppress the output of a package install?  The newrelic package dumps a lot to the screen;  I'd prefer it to be outputted through Chef::Log if there was some way possible
[2012-11-14 21:42:24 -0500] thedeeno: How do I use a resource from within a chef 'library' file?
[2012-11-14 21:44:02 -0500] thedeeno: it doesn't even seem like chef is loaded by the time the library file is being loaded. When I try `require 'chef/dsl/recipe'` it say 'cannot load such file'
[2012-11-14 21:45:41 -0500] knuckolls: thedeeno: i don't know the answer to your question, but the anatomy of a chef run document will likely inform you as to how the pieces fit together. http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-11-14 21:46:07 -0500] knuckolls: you can use resources within lwrps. might be a more effective way to do what you're trying to accomplish
[2012-11-14 21:49:56 -0500] rafaelmagu: jtimberman: I'm constantly encountering an issue when doing first runs where an apt_repository action won't trigger the apt-get update
[2012-11-14 21:53:59 -0500] rava: anyone use the chef-ark cookbook?
[2012-11-14 21:54:10 -0500] perezd: hey what do I have to do in my cookbook to access the providers of another? I forgot.
[2012-11-14 21:54:34 -0500] rava: the provider's pissing me off in that it's extracting my package file into a folder without stripping the underlying folder
[2012-11-14 21:55:26 -0500] knuckolls: perezd: all you have to do is add the "depends" line in the metadata.rb file
[2012-11-14 21:55:34 -0500] perezd: thank you
[2012-11-14 21:55:34 -0500] perezd: yes! thats it
[2012-11-14 21:55:39 -0500] gchristensen: is there any unique integer identifier inChef already? looking to randomly assign server-id in mysql.
[2012-11-14 21:55:50 -0500] knuckolls: perezd: np. :)
[2012-11-14 21:56:31 -0500] wassy121: gchristensen, I kludged around that by using the last octet of the IP address.  That is normally pretty unique per-cluster
[2012-11-14 21:56:58 -0500] bemu: Sorry about the fail on rpm.aegisco.com guys, should be back up shortly.
[2012-11-14 21:57:11 -0500] rava: store ids in a databag then search/sort it
[2012-11-14 21:58:08 -0500] gchristensen: mm okay. I'll figure something out.
[2012-11-14 21:58:09 -0500] knuckolls: gchristensen: if you can't come up with some solution in the chef world, twitter open sourced snowflake for generating monotonically increasing unique identifiers. i have no idea how heavy / light it is. probably overkill.
[2012-11-14 21:58:21 -0500] knuckolls: worth being aware of though
[2012-11-14 21:58:38 -0500] gchristensen: yeah I've seen that before
[2012-11-14 21:59:02 -0500] gchristensen: my cluster could have upwards of 5 database servers in it ;) I'm not too concerned with even doing a search for all DB servers in the environment.
[2012-11-14 22:01:33 -0500] atrius: hello all... just installed chef.. used knife to install a bunch of cookbooks... and the webui shows only an empty list
[2012-11-14 22:01:37 -0500] rava: any ideas on how to force the ark provider to not create it's own directory to extract to?
[2012-11-14 22:01:56 -0500] rava: atrius: you used knife upload?
[2012-11-14 22:02:02 -0500] rava: er knife cookbook upload
[2012-11-14 22:02:14 -0500] atrius: rava: knife cookbook install site COOKBOOK
[2012-11-14 22:02:20 -0500] atrius: which i'm going to guess was wrong?
[2012-11-14 22:02:23 -0500] rava: that doesn't upload it to the server
[2012-11-14 22:02:27 -0500] atrius: ah
[2012-11-14 22:02:28 -0500] atrius: got you
[2012-11-14 22:02:31 -0500] rava: that just downloads and commits it to your repo
[2012-11-14 22:02:34 -0500] atrius: ah
[2012-11-14 22:02:37 -0500] atrius: lol
[2012-11-14 22:02:44 -0500] atrius: let me go fix that
[2012-11-14 22:09:20 -0500] davidmz: I am using knife bootstrap and I jtry to install a new node but I get an error " Failed to authenticate. Please synchronize the clock on your client ", I checked the clocks and they seem fine, the severs are located on different time zones so I am not sure what this message mean
[2012-11-14 22:09:55 -0500] rava: davidmz: running ntp?
[2012-11-14 22:10:23 -0500] davidmz: yes I installed that on both servers
[2012-11-14 22:10:26 -0500] davidmz: and run the command
[2012-11-14 22:10:31 -0500] davidmz: it didn't help
[2012-11-14 22:10:42 -0500] davidmz: on chef server
[2012-11-14 22:11:06 -0500] davidmz: date gives : Thu Nov 15 02:10:49 MSK 2012  on the client Wed Nov 14 21:10:49 MSK 2012
[2012-11-14 22:12:34 -0500] davidmz: I am not sure how to troubleshoot this
[2012-11-14 22:13:38 -0500] davidmz: rave: can you help?
[2012-11-14 22:13:46 -0500] davidmz: rava: can you help?
[2012-11-14 22:13:59 -0500] Litex: From that output, it appears they are both in MSK timezone, but different times?
[2012-11-14 22:14:10 -0500] rava: ^
[2012-11-14 22:14:30 -0500] davidmz: I am sorry I am new to linux, how can I fix this
[2012-11-14 22:14:36 -0500] thedeeno: knuckolls: yeah, that does help. The libraries are indeed being loaded before any resources. So it makes sense why it's choking now.
[2012-11-14 22:14:52 -0500] Litex: davidmz: What Linux distribution?
[2012-11-14 22:14:53 -0500] rava: google setting timezones for your distro
[2012-11-14 22:15:00 -0500] Litex: ^
[2012-11-14 22:15:04 -0500] thedeeno: So, the question: how do I install a gem to omnibus before/while the library loading step
[2012-11-14 22:15:11 -0500] thedeeno: ?
[2012-11-14 22:15:43 -0500] davidmz: why didn't ntp fixed the time issue
[2012-11-14 22:15:56 -0500] rava: davidmz: because the system clock is set wrong
[2012-11-14 22:16:11 -0500] ev0ldave: ntp syncs time to utc, you set timezone elsewhere
[2012-11-14 22:16:16 -0500] rava: davidmz: set your proper timezone
[2012-11-14 22:16:48 -0500] davidmz: I see, thank you
[2012-11-14 22:20:41 -0500] ev0ldave: davidmz:  in debian remove /etc/localtime then ln -s /usr/share/zoneinfo/your/location /etc/localtime
[2012-11-14 22:21:11 -0500] ev0ldave: i think there is a tool that does it for you but can't remmeber off the top of my head
[2012-11-14 22:21:30 -0500] davidmz: i set both nodes to UTC
[2012-11-14 22:21:41 -0500] davidmz: but they are still showing differnt times
[2012-11-14 22:22:09 -0500] ev0ldave: stop ntp and then use: ntpdata pool.ntp.org
[2012-11-14 22:22:32 -0500] ev0ldave: that will make sure they aren't slowly correcting the drift
[2012-11-14 22:22:42 -0500] ev0ldave: ntpdate, sorry
[2012-11-14 22:22:54 -0500] littonj: what is the recommended way to cache data in a provider for the duration of a run (so I  don't have to call an external API for each time the provider gets called)?
[2012-11-14 22:26:23 -0500] yfeldblum: littonj, doing it in the recipe, not in the provider
[2012-11-14 22:27:02 -0500] littonj: I have multiple recipes calling the provider
[2012-11-14 22:28:04 -0500] yfeldblum: littonj, one recipe can do the fetch and stick the data in the node attributes or in the run-state
[2012-11-14 22:28:47 -0500] littonj: ok. that sounds really ugly, but it'll work
[2012-11-14 22:37:26 -0500] mhalligan: how come the deploy resource uses the term "user" instead of "owner" when defining who owns the repo being checked out?
[2012-11-14 22:39:05 -0500] cheeseplus: mhalligan: a stab but the user doesn't have to be the owner to check it out - the ownership metadata is defined on the user by the scm system
[2012-11-14 22:41:02 -0500] masterkorp: https://vimeo.com/53423330
[2012-11-14 22:41:07 -0500] masterkorp: this is awesome
[2012-11-14 22:43:52 -0500] mhalligan: masterkorp: did you see http://bulletproofnetworks.github.com/ript/ ?
[2012-11-14 22:44:03 -0500] masterkorp: no
[2012-11-14 22:44:45 -0500] masterkorp: also looks awesomr
[2012-11-14 22:46:40 -0500] rava: anyone use the ark provider from chef-ark?
[2012-11-14 22:55:16 -0500] jkyle: so I noticed there's no ruby format option when retrieving roles and such from the chef server...is there a way to convert from json to the .rb format?
[2012-11-14 22:57:07 -0500] edelschaedel: any way to return only FQDN when running  "knife search node 'role:web_server'  instead of all values?
[2012-11-14 23:00:27 -0500] laurent\: edelschaedel: -i
[2012-11-14 23:00:41 -0500] bemu: edelschaedel: knife search node 'role:web_server' -a fqdn or something similar
[2012-11-14 23:01:21 -0500] mhalligan: man this is frustrating. application_ruby expects it's port attribute to be a string on unicorn setups. nginx_load_balancer expects it to be an integer. #cantwin
[2012-11-14 23:04:39 -0500] davidmz: I am trying to use the apt cookbook, but I ddin't understand if I need to do an update call after i register a new ppm. I did not understand the way I need to use it when I want to install a package
[2012-11-14 23:05:39 -0500] mhalligan: is it a reasonable assumption that I should just modify the ones that require strings to require Integers, do the right thing on the back-end, and submit patches?
[2012-11-14 23:06:40 -0500] gchristensen: mhalligan: I'd think so
[2012-11-14 23:06:57 -0500] bemu: Sounds good to me.
[2012-11-14 23:16:40 -0500] edelschaedel: bemu: laurent:  Thanks works perfect!
[2012-11-14 23:47:07 -0500] mhalligan: is anyone whose familiar with the logstash cookbook around?
[2012-11-14 23:48:14 -0500] mhalligan: the logstash agent recipe has a user attribute that I think sort of does the wrong thing. if you set this to "logstash" then file inputs become kind of useless. if you set it to Root, then the cookbook tries to change root's home directory.
