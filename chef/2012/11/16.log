[2012-11-16 00:23:33 -0500] poolpog: how about, using symlinks in cookbook file paths? Is that kosher? (currently not working for me)
[2012-11-16 00:24:02 -0500] poolpog: e.g. chef/cookbook/cool_thing/files/default/current -> v0.1.1
[2012-11-16 00:29:09 -0500] poolpog: ok, one last question: My package resource, when the pacakges are included in the cookbook files, re-installs the pacakge every single chef run. This strikes me as a poor use of resources -- is there a way I can prevent this?
[2012-11-16 00:29:18 -0500] poolpog: Maybe I'll head that one over to stack exchange
[2012-11-16 00:41:34 -0500] poolpog: i figured it out
[2012-11-16 00:49:14 -0500] siezer: poolpog that shouldn't be happening.. what was the problem?
[2012-11-16 01:05:40 -0500] maplebed: anyboyd know if there's a Right(tm) way to interact with debian's update-alternatives from within chef?
[2012-11-16 01:07:10 -0500] red5|ryan: bash it out with execute = -]
[2012-11-16 01:08:26 -0500] josephholsten: the java cookbook calls update-alternatives: https://github.com/opscode-cookbooks/java/blob/master/recipes/openjdk.rb#L76
[2012-11-16 01:08:52 -0500] maplebed: heh...  red5|ryan - that's my plan, lacking something else.  josephholsten: thanks, I'll take a look.
[2012-11-16 01:08:55 -0500] josephholsten: but that does not strike me as a particularly Right way
[2012-11-16 01:09:46 -0500] maplebed: I'm fighting the fact that I've gotten stuck with both ruby1.8 and 1.9.
[2012-11-16 01:12:36 -0500] josephholsten: yeah,
[2012-11-16 01:12:36 -0500] josephholsten: i
[2012-11-16 01:12:48 -0500] josephholsten: I like rbenv for that sort of problem
[2012-11-16 01:13:05 -0500] josephholsten: but I've got to figure out a way to not compile ruby on all those machines
[2012-11-16 01:13:07 -0500] maplebed: I use rvm for most stuff; nagios is the exception atm.
[2012-11-16 01:13:26 -0500] josephholsten: ugh. I've had a bad week with rmv
[2012-11-16 01:13:27 -0500] josephholsten: rvm
[2012-11-16 01:16:10 -0500] josephholsten: one of the stable rvm releases this week insisted on creating a nil ruby, which you could not delete through rvm. that broke fnichol's cookbook.
[2012-11-16 01:17:42 -0500] josephholsten: and I also got to find a bug in chef-rvm HEAD, so I couldn't use it or the last release.
[2012-11-16 01:18:21 -0500] josephholsten: maplebed: are you using bright box's ruby packages?
[2012-11-16 01:18:31 -0500] maplebed: default ubuntu.
[2012-11-16 01:20:02 -0500] josephholsten: I forgot I've got boxes that use bb's packages, they are using ruby-switch, not update-alternatives
[2012-11-16 01:20:52 -0500] josephholsten: (yes, I have bb's packages, rvm boxes and rbenv boxes in production.)
[2012-11-16 01:34:52 -0500] bemu: I still do not understand why people want to put multiple ruby versions on the same machine.
[2012-11-16 01:35:39 -0500] maplebed: I blame ubuntu.
[2012-11-16 01:35:52 -0500] bemu: Why not use virtualization if you have a machine doing two different things?
[2012-11-16 01:36:08 -0500] bemu: How do you track metrics on a machine serving two purposes?
[2012-11-16 01:36:19 -0500] maplebed: it's not that - install ruby1.9 (if you need it) doesn't uninstall ruby1.8.
[2012-11-16 01:36:35 -0500] maplebed: so if your chef recipe just says "hey, I need 1.9!", you'll wind up with both.
[2012-11-16 01:36:43 -0500] bemu: Just remove 1.8?
[2012-11-16 01:36:52 -0500] maplebed: that was the route I took.
[2012-11-16 01:36:55 -0500] bemu: Me too.
[2012-11-16 01:36:56 -0500] maplebed: something reinstalled it.
[2012-11-16 01:37:04 -0500] bemu: Don't allow that.
[2012-11-16 01:37:08 -0500] josephholsten: bemu: I don't _want_ to
[2012-11-16 01:37:10 -0500] maplebed: but by that point, alternatives had been moved.  :P
[2012-11-16 01:37:46 -0500] bemu: josephholsten: Well why do you? I want to understand. :)
[2012-11-16 01:38:50 -0500] josephholsten: because I'm still getting to a place where we could spin up a clean instance of the app and failover to it.
[2012-11-16 01:39:50 -0500] bemu: I don't understand how that relates to two ruby versions.
[2012-11-16 01:40:35 -0500] bemu: maplebed: You can pin ruby1.8 to Pin-Priority: -1 which will prevent it from being installed, I believe.
[2012-11-16 01:40:58 -0500] maplebed: yeah, I should do that.
[2012-11-16 01:41:00 -0500] maplebed: tnx.
[2012-11-16 01:41:08 -0500] bemu: Np.
[2012-11-16 01:43:03 -0500] josephholsten: upgrading in place
[2012-11-16 01:43:50 -0500] josephholsten: I don't actually run both for long, but I have to have both on there during the upgrade
[2012-11-16 01:49:52 -0500] bemu: Got it.
[2012-11-16 01:54:18 -0500] chefologist: ok so I am ready to automate beyond chef recipes, e.g. configure postgresql logins etc. how do I do this with Vagrant/Chef?  Any assistance would be great
[2012-11-16 01:55:27 -0500] erikh: I have some (non-public) providers I wrote to do that stuff.
[2012-11-16 01:55:43 -0500] erikh: then a recipe to drive it from metadata
[2012-11-16 01:55:58 -0500] chefologist: erikh: can puppet do some of it?
[2012-11-16 01:56:02 -0500] josephholsten: chefologist: have you looked at opscode's database cookbook? also their dynect cookbook. those are good places to see how those sorts of providers work
[2012-11-16 01:56:22 -0500] erikh: not sure why you'd use both chef and puppet together
[2012-11-16 01:56:26 -0500] erikh: seems like a recipe for disaster.
[2012-11-16 01:56:44 -0500] erikh: I mean, not pushing one tool over the other, just saying using them both is probably a bad idea.
[2012-11-16 01:56:50 -0500] chefologist: erikh: ha!  what does puppet have over chef?
[2012-11-16 01:56:53 -0500] josephholsten: +1
[2012-11-16 01:56:56 -0500] erikh: a different approach
[2012-11-16 01:57:01 -0500] erikh: to solving the same problem.
[2012-11-16 01:58:56 -0500] josephholsten: puppet separates the ruby implementation from the configuration of those resources. it also automates ordering by dependency, which has advantages and disadvantages
[2012-11-16 01:59:13 -0500] chefologist: erikh: so if I go and create vagrant boxes built with chef, and give them to my dev team, a fair bit more work needs to be done to get it fully automated?
[2012-11-16 01:59:50 -0500] erikh: I'm actually solving this exact problem now
[2012-11-16 01:59:57 -0500] erikh: like, it's running in the background as we speak
[2012-11-16 02:00:05 -0500] erikh: but I'm loathe to talk about it too much because it's not ready yet.
[2012-11-16 02:00:15 -0500] erikh: so, er, how patient do you want to be? :)
[2012-11-16 02:00:21 -0500] jtimberman: erikh: :)
[2012-11-16 02:00:50 -0500] chefologist: erikh: ha! nice .... my dev team is a ruby shop, running postgresql, memcached, redis, nginix
[2012-11-16 02:01:01 -0500] erikh: sounds familiar. :)
[2012-11-16 02:01:20 -0500] joonas: chefologist: are you related to vagrantologist by any chance
[2012-11-16 02:01:22 -0500] chefologist: erikh: any good resources on further automation you can point me in.... and yes I am a patient devops
[2012-11-16 02:01:38 -0500] erikh: hm. what I did before I built this tool is manage this by hand
[2012-11-16 02:01:43 -0500] chefologist: joonas: great detective work yes! we are siamese twins
[2012-11-16 02:01:50 -0500] joonas: chefologist: excellent.
[2012-11-16 02:01:56 -0500] erikh: I'm not really sure I have a good answer for you, short of giving you links to repositories that you really shouldn't use yet.
[2012-11-16 02:02:27 -0500] jtimberman: josephholsten: specifically, it builds an acyclic directed graph of the dependencies in a catalog, ships that catalog to the edge nodes, and they run the right things against the catalog to configure the system.
[2012-11-16 02:02:40 -0500] chefologist: erikh: ok, so in a nutshell, you are configuring the Vagrantfile to automate this, or it's going off to repos to automate?
[2012-11-16 02:04:36 -0500] erikh: a... little more than that.
[2012-11-16 02:08:59 -0500] chefologist: ok so I have a grasp of nodes, cookbooks and recipes in hosted-chef, what else can I play with?
[2012-11-16 02:09:21 -0500] erikh: data bags
[2012-11-16 02:09:37 -0500] chefologist: erikh: tell me more :)
[2012-11-16 02:09:45 -0500] erikh: the wiki can tell you a lot
[2012-11-16 02:10:00 -0500] erikh: http://wiki.opscode.com/display/chef/Data+Bags
[2012-11-16 02:10:26 -0500] bemu: chefologist: I run a similar stack + python, mongo, tornado, graphite, etc.
[2012-11-16 02:11:13 -0500] chefologist: +bemu: automated any of these packages?
[2012-11-16 02:11:22 -0500] bemu: all, to some extent.
[2012-11-16 02:11:31 -0500] bemu: We don't automate creation of database users, for example.
[2012-11-16 02:11:42 -0500] bemu: nor do we automate shard/replica configuration for mongo.
[2012-11-16 02:11:52 -0500] chefologist: +bemu: would be great to know how, or at least walk down the right path
[2012-11-16 02:12:01 -0500] bemu: How what?
[2012-11-16 02:12:13 -0500] bemu: Check out the community cookbooks, as others have suggested.
[2012-11-16 02:13:23 -0500] jtimberman: http://docs.opscode.com/lwrp.html
[2012-11-16 02:13:52 -0500] josephholsten: there is a certain class of problem that I still don't have a great answer for, exemplified by database replication
[2012-11-16 02:13:55 -0500] chefologist: +bemu: makes sense, thanks
[2012-11-16 02:14:40 -0500] josephholsten: but also turning on hbase clusters, and any other config that requires things to happen in a certain order across different machines
[2012-11-16 02:15:07 -0500] josephholsten: (which is mostly bad app design, but whatcha gonna do?)
[2012-11-16 02:22:55 -0500] jtimberman: josephholsten: whatcha gonna do? http://www.youtube.com/watch?v=QW4RUIjOp9k
[2012-11-16 02:23:38 -0500] erikh: oh man
[2012-11-16 02:23:50 -0500] erikh: you guys are hurting me bad
[2012-11-16 02:24:00 -0500] erikh: ... because this is the exact problem I'm working on right now
[2012-11-16 02:24:51 -0500] erikh: well, exposing it at least, it's amazing what you find out about your stack when vagrant is integrated into your test suite and not the other way around
[2012-11-16 02:25:51 -0500] josephholsten: I remember the dto guys having an example of managing it with noah
[2012-11-16 02:27:18 -0500] rafaelmagu: Anyone else having issues with yaml corrupt file when using rbenv to install ruby?
[2012-11-16 02:27:26 -0500] rafaelmagu: Started a few moments ago
[2012-11-16 02:27:49 -0500] rafaelmagu: checksum mismatch: yaml-0.1.4.tar.gz (file is corrupt)
[2012-11-16 02:30:50 -0500] josephholsten: erikh: I keep wanting to learn more about noah b/c of http://lusislog.blogspot.com/2011/03/ad-hoc-configuration-coordination-and.html
[2012-11-16 05:04:22 -0500] ssd7: Ohai Chefs!
[2012-11-16 05:26:14 -0500] chefologist: hi, receiving error when trying to install postgresql via vagrant > https://gist.github.com/4084390
[2012-11-16 05:26:35 -0500] chefologist: any assistance would be great
[2012-11-16 05:30:07 -0500] Litex: I would 'vagrant ssh' in to the instance and try running this as root to see why it's borked: apt-get -q -y install postgresql-client=9.1+129ubuntu1
[2012-11-16 05:32:40 -0500] chefologist: Litex: if I run my vagrantfile with no postresql it installs fine
[2012-11-16 05:33:08 -0500] Litex: apt-get -q -y install postgresql-client=9.1+129ubuntu1 returned 100, expected 0
[2012-11-16 05:33:20 -0500] Litex: That's the command that it's breaking on.
[2012-11-16 05:34:40 -0500] chefologist: ok I will go have a look, it is a FRESH opscode.box
[2012-11-16 05:34:52 -0500] Litex: weird.
[2012-11-16 05:35:03 -0500] josephholsten: sudo lsof | grep dpkg
[2012-11-16 05:35:26 -0500] josephholsten: no wait, you aren't using the apt cookbook are you?
[2012-11-16 05:36:20 -0500] josephholsten: I bet you have a 'fresh' image, which hasn't had `apt-get update` run on it since it was built
[2012-11-16 05:36:23 -0500] chefologist: josephholsten: yes I am
[2012-11-16 05:36:42 -0500] chefologist: whats the best way to automate it, so there are no errors? cheers
[2012-11-16 05:37:40 -0500] josephholsten: add the 'apt' cookbook to your run list, as near to the beginning as possible. it also provides resouces for apt-repos, which you may want later
[2012-11-16 05:38:32 -0500] chefologist: apt is 2nd in my list
[2012-11-16 05:39:11 -0500] chefologist: so what you are saying is, run vagrant up with apt first, then reload with the rest of the cookbooks?
[2012-11-16 05:42:05 -0500] josephholsten: hmm, that's odd. let me dig a sec
[2012-11-16 05:43:00 -0500] josephholsten: ooooo
[2012-11-16 05:43:03 -0500] chefologist: its the first time I am using the opscode boxes, and they are throwing up these errors
[2012-11-16 05:43:16 -0500] josephholsten: I have an idea
[2012-11-16 05:43:41 -0500] chefologist: yes?
[2012-11-16 05:43:55 -0500] josephholsten: hmm, what version of the postgresql cb are you using?
[2012-11-16 05:44:45 -0500] chefologist: josephholsten: 0.99.4 (default cookbook)
[2012-11-16 05:44:56 -0500] josephholsten: I think it's trying to install the package in compile time, before apt has had a chance to update
[2012-11-16 05:45:14 -0500] josephholsten: can you update to 1.0.0?
[2012-11-16 05:45:43 -0500] josephholsten: I'll look at 0.99.4, but 1.0.0 looks like it should be good
[2012-11-16 05:46:08 -0500] chefologist: is 1.0.0 a cookbook?
[2012-11-16 05:47:32 -0500] josephholsten: let me guess, the error is on line #37 in client.rb?
[2012-11-16 05:47:33 -0500] josephholsten: https://github.com/opscode-cookbooks/postgresql/blob/c312161f0db6f6206644da7d079628c79dcfd498/recipes/client.rb#L37
[2012-11-16 05:47:37 -0500] chefologist: ahh yes it is
[2012-11-16 05:48:22 -0500] chefologist: I just created a new vagrant box from opscode 12.04 32bit with only the APT cookbook and it has loaded fine
[2012-11-16 05:48:26 -0500] josephholsten: looks like the newest release of postgresql is 2.0.0, but I think 1.0.0 should work also
[2012-11-16 05:49:35 -0500] josephholsten: here's the change log: https://github.com/opscode-cookbooks/postgresql/blob/master/CHANGELOG.md
[2012-11-16 05:53:15 -0500] chefologist: just downloading the 1.0.0 version of postgresql and uploading to hosted-chef
[2012-11-16 05:54:02 -0500] josephholsten: btw, are you using librarian or berkshelf?
[2012-11-16 05:58:12 -0500] chefologist: josephholsten: was that for me? I am using vagrant with hosted-chef
[2012-11-16 06:00:49 -0500] chefologist: how do I get 1.0.0 via knife?
[2012-11-16 06:01:11 -0500] chefologist: knife cookbook site download postgresql_1_0_0 ?
[2012-11-16 06:02:07 -0500] josephholsten: knife cookbook site install postgresql 1.0.0
[2012-11-16 06:02:30 -0500] josephholsten: but you should seriously consider using librarian or http://berkshelf.com
[2012-11-16 06:04:07 -0500] chefologist: hm ok will look at it > just got an error uploading to my hosted-chef > ERROR: Could not find cookbook 1.0.0 in your cookbook path, skipping it Uploading postgresql     [0.99.4]
[2012-11-16 06:05:05 -0500] josephholsten: um, you didn't succeed in upgrading your cookbook to version 1.0.0
[2012-11-16 06:06:45 -0500] chefologist: I usually run knife cookbook site download postgresql 1.0.0 > to download
[2012-11-16 06:07:07 -0500] chefologist: then upload: knife cookbook upload postgresql 1.0.0
[2012-11-16 06:07:17 -0500] josephholsten: and that doesn't work
[2012-11-16 06:07:36 -0500] chefologist: no I got the error above
[2012-11-16 06:07:56 -0500] josephholsten: because you have to unpack the cookbook artifact (postgresql-1.0.0.tar.gz) into your cookbooks path
[2012-11-16 06:08:42 -0500] josephholsten: the install action will unpack it for you
[2012-11-16 06:08:52 -0500] chefologist: tar -xf ?
[2012-11-16 06:09:16 -0500] josephholsten: tar -zxf
[2012-11-16 06:09:33 -0500] josephholsten: or gunzip seperately
[2012-11-16 06:13:54 -0500] chefologist: ok now I have to install via vagrant file > is it still postgresql?
[2012-11-16 06:14:17 -0500] josephholsten: the cookbook? yes
[2012-11-16 06:15:08 -0500] chefologist: ok trying now vagrant reload boxname (with postgresql 1.0.0)
[2012-11-16 06:17:04 -0500] chefologist: ok joseph > it works
[2012-11-16 06:17:21 -0500] chefologist: had similar issue with newrelic_monitoring
[2012-11-16 06:54:08 -0500] BryanWB_: ohai chefs!
[2012-11-16 06:57:23 -0500] martinisoft: { "ohai": "BryanWB_ " }
[2012-11-16 06:57:30 -0500] BryanWB_: martinisoft: hi :)
[2012-11-16 06:57:42 -0500] martinisoft: Responding with JSON
[2012-11-16 06:57:44 -0500] martinisoft: ^_^
[2012-11-16 07:30:33 -0500] Litex: Greetings.
[2012-11-16 07:45:50 -0500] gokr: BryanWB_: Impressive list of github repos there! :)
[2012-11-16 07:46:08 -0500] BryanWB_: gokr: if only they were better maintained :(
[2012-11-16 07:46:11 -0500] gokr: I am diving head first into Chef since 2 weeks back, building a product for a customer on top of it.
[2012-11-16 07:46:45 -0500] gokr: One thing I did yesterday was using cookbook_file to add a sudoers.d fragment - no specific support for those, right?
[2012-11-16 07:47:12 -0500] gokr: I noticed your chef-sudo package, but I just want to "fiddle" with sudoers - not template it.
[2012-11-16 07:47:54 -0500] gokr: I also did a "disable this line" using sed. Someone mentioned fileedit etc, not sure what is "the Chef way".
[2012-11-16 07:51:28 -0500] spheromak: just manage the full content
[2012-11-16 07:52:13 -0500] spheromak: gokr: generally frowned upon using "file-edit" like functionality when you dont absolutely need too.
[2012-11-16 07:52:57 -0500] gokr: Yeah, curious about that "frown".
[2012-11-16 07:53:18 -0500] spheromak: as in why
[2012-11-16 07:53:19 -0500] gokr: Is it worry about predictability or debuggability or?
[2012-11-16 07:53:19 -0500] spheromak: ?
[2012-11-16 07:53:28 -0500] gokr: Yeah.
[2012-11-16 07:53:37 -0500] spheromak: http://en.wikipedia.org/wiki/Idempotence
[2012-11-16 07:53:38 -0500] spheromak: :D
[2012-11-16 07:53:47 -0500] spheromak: predictability
[2012-11-16 07:53:58 -0500] spheromak: and the goal of being declaritive
[2012-11-16 07:54:17 -0500] gokr: Mmmm, but recipes aren't really declarative in nature.
[2012-11-16 07:54:21 -0500] gokr: IMHO.
[2012-11-16 07:54:50 -0500] spheromak:  package "foo" { version "1.1.1" }  is pretty declaritive
[2012-11-16 07:54:58 -0500] gokr: I agree about the concept of idempotence of course - on the other hand, "forking" a file like sudoers makes me locked to that version from upstream.
[2012-11-16 07:55:05 -0500] spheromak: the idea is that chef should be describing the state you want something to get too
[2012-11-16 07:55:28 -0500] gokr: Then I would need to lock down the sudo package - and that means locking down ... Ubuntu in this case :)
[2012-11-16 07:55:50 -0500] spheromak: if you look at brayns cook
[2012-11-16 07:55:59 -0500] spheromak: it has a n lwrp for defining rules
[2012-11-16 07:57:04 -0500] gokr: "brayns cook"?
[2012-11-16 07:57:38 -0500] gokr: (btw, I did make sure the sed edit was idempotent :))
[2012-11-16 07:57:44 -0500] spheromak: i guess thats merged in the opscode cook as well
[2012-11-16 07:58:04 -0500] gokr: Sorry for being daft, "cook"?
[2012-11-16 07:58:05 -0500] spheromak: gokr: yea thats fine, but the general consensus is you should use the lwrp to define your rules
[2012-11-16 07:58:14 -0500] spheromak: and bring sudo under total managemnt instead of partial
[2012-11-16 07:58:27 -0500] spheromak: whats stoping anyone from editing your sudoers outside of that one sed'd line
[2012-11-16 07:58:38 -0500] spheromak: you anen't ensuring configured state. just one simple line
[2012-11-16 07:58:50 -0500] spheromak: excuse the typos :D
[2012-11-16 07:59:00 -0500] gokr: When you say "anyone" - are you referring to upstream or other people with access to the machine?
[2012-11-16 07:59:08 -0500] spheromak: anyone with access
[2012-11-16 07:59:14 -0500] spheromak: or any package upgrade
[2012-11-16 07:59:43 -0500] gokr: And if i lock that file down - and the sudo package gets updated - it may very well break too.
[2012-11-16 07:59:46 -0500] spheromak: however it is. the idea is to be declaritive in how you describe your machine state in your config management.  So doing partial edits on files makes less sense than just managing the entire file
[2012-11-16 07:59:54 -0500] spheromak: so yes
[2012-11-16 08:02:01 -0500] spheromak: gokr: https://github.com/opscode-cookbooks/sudo
[2012-11-16 08:02:07 -0500] gokr: But if we are talking "full control of all things" in this manner - then I could just put all of the files under SCM and be done with it. The chef recipes are filled with ifs and logic etc, so don't really feel that declarative in practice.
[2012-11-16 08:02:07 -0500] spheromak: is what im refereing too  fyi
[2012-11-16 08:02:20 -0500] gokr: Yeah, saw that one.
[2012-11-16 08:02:22 -0500] spheromak: or the sudo cookbook on community site
[2012-11-16 08:03:12 -0500] spheromak: prob your best place to start is with that. if your replacing an existing configuration. Use another cookbook that you create, include this one for the LWRP and define your rules in your internal cookbook.  So you can easily upgrade/update from community.
[2012-11-16 08:03:44 -0500] gokr: For me and my use case I am not worried about other people with access - I am more worried about "merging" with upstream - in other words, will stuff still work if I upgrade the distro/dependencies.
[2012-11-16 08:04:29 -0500] gokr: Mmmm.
[2012-11-16 08:05:27 -0500] spheromak: shoudl work fine in this case, but thats future proofing that isn't always possible
[2012-11-16 08:06:25 -0500] spheromak: I am assuming you mean will it work if i apt-get upgrade or yum update etc ?
[2012-11-16 08:06:37 -0500] gokr: So far I am impressed with the breadth of chef - just not sure I buy into the whole ... setup. Sometimes it feels a tad overly complex. Like managing my cookbooks - that seems to take a PhD.
[2012-11-16 08:06:46 -0500] gokr: Right, that's what I meant.
[2012-11-16 08:07:01 -0500] spheromak: generally distros don't clobber configs that have been set outside of the packager
[2012-11-16 08:07:03 -0500] gokr: If sudo package decides to change the sudoers default contents.
[2012-11-16 08:07:39 -0500] gokr: True, but I would still need to merge any changes.
[2012-11-16 08:07:43 -0500] spheromak: depends on the package in this case, but if you manage the conifg in chef if an upgrade does wipe something it will try to get it back to the desired config on the next converge
[2012-11-16 08:07:53 -0500] gokr: And of course, not a big deal - and perhaps "safer".
[2012-11-16 08:07:56 -0500] spheromak: ocokbook management is best handled with berkshelf/librarian/whisk
[2012-11-16 08:08:00 -0500] spheromak: *wisk
[2012-11-16 08:08:09 -0500] spheromak: not merge
[2012-11-16 08:08:14 -0500] spheromak: overrite
[2012-11-16 08:08:19 -0500] gokr: Which is what I meant - I need to learn an extra tool for it? Or several?
[2012-11-16 08:08:32 -0500] spheromak: well
[2012-11-16 08:08:37 -0500] spheromak: really just pick one ;)
[2012-11-16 08:08:43 -0500] spheromak: i like berkshelf personally
[2012-11-16 08:09:00 -0500] spheromak: but they all do things slightly differnt for different reasons
[2012-11-16 08:09:03 -0500] gokr: Mmm, I did glance at some article about librarian I think but... my eyes glazed over.
[2012-11-16 08:09:17 -0500] spheromak: you can also just manage one fat repo and lots of git submodules or use braid
[2012-11-16 08:09:18 -0500] spheromak: :D
[2012-11-16 08:09:22 -0500] spheromak: TIMTOWTDI
[2012-11-16 08:09:46 -0500] gokr: Sure, I buy that - but... I am not sure I like it.
[2012-11-16 08:09:52 -0500] spheromak: heh
[2012-11-16 08:10:10 -0500] spheromak: theres room for that all to get better for sure
[2012-11-16 08:10:30 -0500] gokr: A few years back I used Lunar Linux (source distro) and they have a couple of thousand "build scripts" with dependencies and all - in a single SVN repo. With some override hooks. But that worked quite fine.
[2012-11-16 08:10:50 -0500] spheromak: well its a bit different cause there was a signle source for efort.
[2012-11-16 08:11:32 -0500] spheromak: and in this case its been verry organic.
[2012-11-16 08:11:59 -0500] gokr: I wonder if all these different tools etc have appeared because things are "spread out" in the chef-repo file structure.
[2012-11-16 08:12:04 -0500] spheromak: which has its benefits, and i guess its negatives. really its not that difficult to manage once you use one of the various tools :D
[2012-11-16 08:12:34 -0500] spheromak: well they exist cause we all moved to a cookbook as a repo model
[2012-11-16 08:12:53 -0500] spheromak: so we can treat cookbooks as software projects independant of a "chef-repo"
[2012-11-16 08:12:56 -0500] gokr: Sorry for bashing a bit here - I generally like all I get with chef so far (I am building a special "rule the clouds" tool for a product kinda), but I do tend to think things are a bit complex.
[2012-11-16 08:13:07 -0500] spheromak: it was much worse when you had to clone someones entire repo jut to get 1 cookbook ;)
[2012-11-16 08:13:30 -0500] spheromak: well they are complex only in that it allows you to do pretty much whatever you want
[2012-11-16 08:13:33 -0500] spheromak: ;)
[2012-11-16 08:13:41 -0500] spheromak: not alot of opinion built-in
[2012-11-16 08:14:00 -0500] spheromak: but theres some community opinions on how things should be for sure.
[2012-11-16 08:14:04 -0500] gokr: For example, I now have a fully working bootstrap for a chef server on EC2 - but hey... it took me quite some time to get it all to work.
[2012-11-16 08:14:17 -0500] spheromak: there are tools for that :)
[2012-11-16 08:14:33 -0500] gokr: I know - knife-server - but I want detailed control for this one.
[2012-11-16 08:14:54 -0500] spheromak: sure  chef-server setup is complex
[2012-11-16 08:14:56 -0500] gokr: And a tad surprised to find bugs like init.d scripts not finding the DAEMONs etc.
[2012-11-16 08:14:56 -0500] spheromak: no doubt
[2012-11-16 08:15:08 -0500] spheromak: thats getting better in 11 with the omni installer for chef-server
[2012-11-16 08:15:28 -0500] spheromak: you use the chef-server::rubygems-installer ?
[2012-11-16 08:15:29 -0500] gokr: For some reason that I can't remember right now I ended up not using the omni.
[2012-11-16 08:15:32 -0500] gokr: Yes.
[2012-11-16 08:15:42 -0500] spheromak: i use this to bootstrap servers all the time without problems.  what platform ?
[2012-11-16 08:15:48 -0500] spheromak: did you pop a ticket  ? or a pull req :D
[2012-11-16 08:15:50 -0500] gokr: 12.04.1
[2012-11-16 08:15:54 -0500] spheromak: hrm
[2012-11-16 08:16:01 -0500] spheromak: I use 12.04 and that exact recipe :D
[2012-11-16 08:16:17 -0500] spheromak: omni  only available for chef-client right now
[2012-11-16 08:16:21 -0500] gokr: Well, I did find that chef-server recipe (and this is a FUN example btw) had templates for the init.d scripts.
[2012-11-16 08:16:31 -0500] gokr: BUT... chef also has those files.
[2012-11-16 08:16:39 -0500] gokr: (chef on github I mean)
[2012-11-16 08:16:50 -0500] gokr: And now the bug is fixed in chef but not chef-server recipe.
[2012-11-16 08:16:52 -0500] spheromak: you mean chef source
[2012-11-16 08:17:21 -0500] gokr: I did mention this here yesterday with links and all... is there a log of this channel?
[2012-11-16 08:17:36 -0500] spheromak: sure  they aren't coupled tightly.  and the chef-server cookbook is meant for you to be able to dynamically configure your erver with attributes/roles/environments
[2012-11-16 08:17:40 -0500] spheromak: different problems :)
[2012-11-16 08:17:50 -0500] spheromak: chef source init script is there for a basic default.
[2012-11-16 08:18:06 -0500] gokr: Well, I think (now in retrospect) it is an example of why I am not sure I like "forking" files like that.
[2012-11-16 08:18:11 -0500] gokr: It is not DRY.
[2012-11-16 08:18:13 -0500] spheromak: cookbook is there for people to be able to manage it how they might like it. and even then sometimes you have to roll your own ;P
[2012-11-16 08:18:36 -0500] spheromak: sure sure actuaally if you look at the rubygems installer
[2012-11-16 08:18:43 -0500] spheromak: it pulls the init scripts from the gem source
[2012-11-16 08:18:48 -0500] spheromak: and in this way it is DRY
[2012-11-16 08:19:04 -0500] gokr: Notice DAEMON line here: https://github.com/opscode/chef/blob/master/distro/debian/etc/init.d/chef-server
[2012-11-16 08:19:53 -0500] gokr: vs line here: https://github.com/opscode-cookbooks/chef-server/blob/master/templates/default/debian/init.d/chef-server.erb
[2012-11-16 08:19:58 -0500] spheromak: if your using the init
[2012-11-16 08:20:38 -0500] spheromak: https://github.com/opscode-cookbooks/chef-server/blob/master/recipes/rubygems-install.rb#L203-L209
[2012-11-16 08:21:15 -0500] gokr: yes, or rather line 221 there - I had to change it.
[2012-11-16 08:21:39 -0500] gokr: As someone had found in some ticket.
[2012-11-16 08:21:59 -0500] spheromak: ahits not pulling inits out tho
[2012-11-16 08:22:04 -0500] spheromak: yea
[2012-11-16 08:22:14 -0500] spheromak: guess im using something a bit older that works ;)
[2012-11-16 08:22:18 -0500] gokr: It used the ruby bin dir, which is "wrong" on... Ubuntu.
[2012-11-16 08:22:56 -0500] spheromak: sure sure. again this stuff will be much better under the 11 omni with server
[2012-11-16 08:23:02 -0500] spheromak: but i feel your pain.
[2012-11-16 08:23:05 -0500] gokr: So anyway, the fix using (which blabla) was only done in... the chef github repo. Not in this templated "copy the whole thing" :) variant.
[2012-11-16 08:23:34 -0500] spheromak: well the template solves a different issue, and really you touch on a bigger issue WRT packagers and comnfig management
[2012-11-16 08:23:54 -0500] gokr: Since my life is short and I have many things to worry about I do tend to like "isolated setups" like omni etc to minimize risks for tools like this.
[2012-11-16 08:24:07 -0500] spheromak: i.e. when to use cfg management and when to package. Since we don't always controll whats in a package we have to assume that we want our config managemtn to state what should be configured.
[2012-11-16 08:24:35 -0500] spheromak: gokr: omni is the only way to minimize the risk and normalize across all platforms unfortunately
[2012-11-16 08:24:39 -0500] spheromak: also
[2012-11-16 08:24:46 -0500] spheromak: for chef-client at least
[2012-11-16 08:24:54 -0500] erikh: gem install knife-server
[2012-11-16 08:25:01 -0500] spheromak: you want you systems management framework to not be dependent on the system it manages.
[2012-11-16 08:25:09 -0500] spheromak: but yea erikh
[2012-11-16 08:25:13 -0500] spheromak: tools for that ;)
[2012-11-16 08:25:15 -0500] Litex: I've had great luck w/ the .debs, too.  Magic simple install.
[2012-11-16 08:25:38 -0500] gokr: erikh: I know, and I might use it - but I was not sure I wanted to depend upon yet another non official tool extra.
[2012-11-16 08:26:26 -0500] gokr: erikh: Since I am building a product - not just "using it" myself.
[2012-11-16 08:27:37 -0500] gokr: I might try moving to omni or debs though - now that I have learned more. During my "stumble through the deep woods" I did try those first but eventually due to problems not remembered right now ended up with the rubygems install.
[2012-11-16 08:28:12 -0500] gokr: spheromak: Are you in the US? Middle of night?
[2012-11-16 08:28:30 -0500] spheromak: gokr: Im from the US, but currently in Seoul
[2012-11-16 08:28:37 -0500] gokr: Ah.
[2012-11-16 08:28:43 -0500] spheromak: so its about drinking time
[2012-11-16 08:28:45 -0500] spheromak: ;)
[2012-11-16 08:28:50 -0500] gokr: Hehe. Morning here.
[2012-11-16 08:28:57 -0500] gokr: Sweden
[2012-11-16 08:29:55 -0500] gokr: Thanks for all info btw.
[2012-11-16 08:30:07 -0500] spheromak: yea np should be about for another hour or so
[2012-11-16 08:30:32 -0500] BryanWB_: spheromak: so u can do it gangnam style!
[2012-11-16 08:30:39 -0500] gokr: Any specific area in chef you work on?
[2012-11-16 08:30:47 -0500] gokr: Or are you "just" a user?
[2012-11-16 08:31:02 -0500] gokr: Trying to figure out "whos who" here :)
[2012-11-16 08:31:14 -0500] spheromak: BryanWB_: infact I work in Gangnam
[2012-11-16 08:31:15 -0500] gokr: But with 400 people in the channel, well...
[2012-11-16 08:31:15 -0500] spheromak: ;)
[2012-11-16 08:31:22 -0500] spheromak: and thats where i will be tonight
[2012-11-16 08:31:22 -0500] BryanWB_: spheromak: awesome ;)
[2012-11-16 08:32:01 -0500] gokr: Kids here are crazy about that song these days. And just to make it over the top - the minecraft version on Youtube. Doesn't get any hipper than that for a 9 yo.
[2012-11-16 08:32:17 -0500] spheromak: gokr:  i wrote some terrible interface prover for mainline chef long ago (when i knew not the ruby ways) .. and in general i hack around it alot
[2012-11-16 08:32:45 -0500] spheromak: *feels
[2012-11-16 08:33:01 -0500] spheromak: *provider
[2012-11-16 08:33:01 -0500] gokr: Kinda funny btw, I am a die hard Smalltalker. In theory I should like Ruby, but I... do not "really". :)
[2012-11-16 08:33:31 -0500] spheromak: i've been working on a project in go @ work, and liking that more and more.
[2012-11-16 08:33:46 -0500] gokr: Too much Perl, too little Smalltalk for my taste. But its better than lots of other stuff of course - spent last year in C#.
[2012-11-16 08:34:16 -0500] gokr: Haven't played with go yet - only read about it. I am a lang nerd.
[2012-11-16 08:35:19 -0500] gokr: But being a Smalltalker I am kinda "broken".
[2012-11-16 08:44:24 -0500] gokr: Now I get a "Errno::ENOMEM: Cannot allocate memory - fork(2)" trying to install ia32libs...
[2012-11-16 08:44:47 -0500] spheromak: OOM
[2012-11-16 08:45:12 -0500] spheromak: BryanWB_: have you been to Korea before ?
[2012-11-16 08:45:31 -0500] BryanWB_: spheromak: nope, but would love to go, lived in HK for a couple yrs
[2012-11-16 08:45:59 -0500] spheromak: ah cool Heading to bangkok next month
[2012-11-16 08:46:21 -0500] spheromak: I'be been digging my Asian work this last year
[2012-11-16 08:46:27 -0500] spheromak: cept for the Timezones  ;)
[2012-11-16 08:53:47 -0500] BryanWB_: y, enjoy bkk, do the canal tour
[2012-11-16 09:24:15 -0500] BryanWB_: there is a gr8 italian restaurant called limoncello ;)
[2012-11-16 10:57:48 -0500] EremJay: Hi guys
[2012-11-16 10:57:55 -0500] EremJay: I'm a little stuck here.
[2012-11-16 10:58:20 -0500] EremJay: When I try to install a package with chef solo, it says  "returned 100, expected 0"
[2012-11-16 10:58:28 -0500] EremJay: But the package is installed.
[2012-11-16 10:58:45 -0500] EremJay: And when I re-run the chef-solo command, it stops to the next package.
[2012-11-16 11:00:26 -0500] EremJay: Do you have any idea why this error shows up?
[2012-11-16 11:07:49 -0500] aruntomar: EremJay: this problem generally occurs because of package manager. try to install the package via the package commands yum or apt based on the platform and check the exit status
[2012-11-16 11:08:05 -0500] EremJay: I did. It returns 0.
[2012-11-16 11:08:24 -0500] EremJay: But I am trying to bootstrap EC2 instances. Maybe that's the cause?
[2012-11-16 11:09:39 -0500] masterkorp: EremJay: wait... bootstrap with chef-solo ?
[2012-11-16 11:09:42 -0500] aruntomar: EremJay: while bootstrapping ec2 instances, remember that your recipe should first execute apt-get update and then run rest of the recipes
[2012-11-16 11:10:14 -0500] EremJay: Yup, I put "recipe[apt]" in the run_list.
[2012-11-16 11:11:01 -0500] EremJay: I run apt-get update when the VM launches anyway. Even before running chef-solo.
[2012-11-16 11:18:16 -0500] aruntomar: EremJay: please paste the output of your chef run to gist or pastebin.
[2012-11-16 11:19:23 -0500] EremJay: Yep. Hold on. I am retrying on a new VM.
[2012-11-16 11:22:26 -0500] masterkorp: What object does search returns ?
[2012-11-16 11:22:40 -0500] masterkorp: is it an hash ? an array ?
[2012-11-16 11:24:42 -0500] masterkorp: oh it returns an enumerator
[2012-11-16 11:24:55 -0500] masterkorp: with the object type depending on the class
[2012-11-16 11:25:14 -0500] masterkorp: searh :role return Chef::Role objects
[2012-11-16 11:25:44 -0500] masterkorp: IS there the yard doc of chef online somewhere ?
[2012-11-16 11:28:03 -0500] EremJay: aruntomar: Here you go: http://pastebin.com/RwVmk2PM
[2012-11-16 11:31:46 -0500] gokr: EremJay: I am also bootstrapping EC2 instances using chef-solo, but haven't seen that exact issue.
[2012-11-16 11:32:35 -0500] gokr: Use my own bootstrap template without a chef-run - then upload chef-repo - then fire off a chef-solo run.
[2012-11-16 11:44:51 -0500] EremJay: Your template  where is it?
[2012-11-16 11:47:28 -0500] masterkorp: oh well i will generate it myself
[2012-11-16 11:48:01 -0500] EremJay: Oh okay I misunderstood.
[2012-11-16 11:48:21 -0500] EremJay: I never used chef-run.
[2012-11-16 11:53:38 -0500] masterkorp: Is it mandatory for roles to have a description ?
[2012-11-16 12:00:18 -0500] masterkorp: http://pastie.org/private/hj1grnzmporqvczm4jifqa
[2012-11-16 12:00:36 -0500] masterkorp: On this recipe i get "/srv/chef/file_store/cookbooks/icinga/recipes/server.rb:200: syntax error, unexpected $end, expecting keyword_end"
[2012-11-16 12:00:46 -0500] masterkorp: last line of the recipe
[2012-11-16 12:00:51 -0500] masterkorp: what could it be ?
[2012-11-16 12:07:44 -0500] ssd7: masterkorp: You are likely missing an "end" to some block somewhere.
[2012-11-16 12:08:55 -0500] masterkorp: that was my first tough
[2012-11-16 12:08:59 -0500] masterkorp: but where ?
[2012-11-16 12:09:21 -0500] masterkorp: on line 140
[2012-11-16 12:09:50 -0500] ssd7: masterkorp: Yeah, looks like it
[2012-11-16 13:12:42 -0500] maruq: hi guys, getting a bit confused by the googles. Anyone know what the current status of Postgresql vs. Omnibus is?
[2012-11-16 13:12:56 -0500] maruq: I seem to get errors saying the gem can't compile
[2012-11-16 13:17:48 -0500] mancdaz: how does one use a library from one cookbook, in a provider being written in another cookbook?
[2012-11-16 13:27:15 -0500] BryanWB_: mancdaz:   include_recipe "othercookbook"
[2012-11-16 13:27:29 -0500] BryanWB_: mancdaz: oh that doesn't answer ur question
[2012-11-16 13:27:35 -0500] mancdaz: ok but won't that run the default recipe from that cookbook?
[2012-11-16 13:27:39 -0500] BryanWB_: require ''
[2012-11-16 13:27:49 -0500] mancdaz: I just want to be able to access the methods from a library in another cookbooks
[2012-11-16 13:28:16 -0500] BryanWB_: mancdaz: then u need another recipe that is basically noop
[2012-11-16 13:28:42 -0500] mancdaz: that feels dirty
[2012-11-16 13:28:45 -0500] BryanWB_: it is!
[2012-11-16 13:29:10 -0500] BryanWB_: s/cookbooks/cookbook libraries/
[2012-11-16 13:30:29 -0500] mancdaz: BryanWB_:  thanks, I'll try getting dirty
[2012-11-16 13:33:47 -0500] aruntomar: mancdaz: i believe, you can achieve that by including the other cookbook in metadata.rb as "depends <cookbook name> " and use it.
[2012-11-16 13:34:56 -0500] mancdaz: aruntomar: I already have the necessary cookbook in my metadata depends
[2012-11-16 13:35:28 -0500] mancdaz: inside the provider, the methods from the library in that cookbook are still not available
[2012-11-16 13:36:14 -0500] mancdaz: BryanWB_:  can I just do require 'cookbookname::libraryname' somehow at the top of the provider?
[2012-11-16 13:37:54 -0500] aruntomar: mancdaz: checkout the database cookbook from the sites cookbook for further reference
[2012-11-16 13:39:08 -0500] mancdaz: aruntomar: there are no providers in that cookbook
[2012-11-16 13:39:27 -0500] mancdaz: I'm specifically trying to access the library methods from inside a provider that I'm writing
[2012-11-16 13:39:56 -0500] mancdaz: I can't include a cookbook::recipe as the 'include_recipe' method is also not available inside the provider
[2012-11-16 13:40:19 -0500] mancdaz: I get undefined method `include_recipe' for #<Class:0x00000001c72210>
[2012-11-16 13:40:29 -0500] mancdaz: if I try to invlude inside the provider
[2012-11-16 13:41:26 -0500] aruntomar: mancdaz: https://github.com/opscode/cookbooks/tree/master/database/libraries
[2012-11-16 13:43:17 -0500] mancdaz: aruntomar: so I would have to explicitly include the file based on it's location on disk?
[2012-11-16 13:53:57 -0500] davidmz: my node[:ipaddress] is empty on my ubuntu 12.04 node
[2012-11-16 13:54:06 -0500] davidmz: how can I check what is wrong?
[2012-11-16 13:58:20 -0500] yfeldblum: mancdaz, in ruby, defining methods in one class context doesn't make them available in another class context
[2012-11-16 14:00:31 -0500] jforest: geekbri: so,kyou use chef/aws, how do you deal with machines that have scaled down but are still listed in chef?  Do you have an automated way to delete them?
[2012-11-16 14:01:03 -0500] jforest: aka: solve my problems for me!
[2012-11-16 14:01:07 -0500] geekbri: jforest: we aren't using autoscaling groups, but i would probably just write a cronjob to go through the nodes and compare their instance-id to my running instance ids.  Then just delete them I guess.
[2012-11-16 14:01:24 -0500] geekbri: just make sure you don't have any bugs in that code ;)
[2012-11-16 14:01:35 -0500] geekbri: I'd also delete the client as well
[2012-11-16 14:05:13 -0500] maruq: has anyone managed to get knife to use mosh ?
[2012-11-16 14:05:23 -0500] davidmz: my node[:ipaddress] is empty on my ubuntu 12.04 node, how can I fix this problem?
[2012-11-16 14:06:40 -0500] tolland: i want to evaluate a erb file from the cli, is there a work around to mock in some node[:XX] values?
[2012-11-16 14:07:24 -0500] jforest: geekbri: yah.  Sigh.
[2012-11-16 14:07:50 -0500] mancdaz: yfeldblum: the thing I don't understand is that I can use the methods from one cookbook/library in another cookbook/recipe, but not another cookbook/provider
[2012-11-16 14:08:16 -0500] masterkorp: why the heck node["name"] gets out empty
[2012-11-16 14:08:18 -0500] masterkorp: ?
[2012-11-16 14:08:49 -0500] geekbri: jforest: It's unfortunately the only way I can think of.  If I were more adept with autoscaling I might be able to help. asteve might know.  It's too bad there isn't some sort of callback fired when an instance is scaled down
[2012-11-16 14:09:02 -0500] masterkorp: node.to_hash shows it there name => "icinga.vm"
[2012-11-16 14:13:16 -0500] tolland: ok, so i use ruby -rerb instead
[2012-11-16 14:13:55 -0500] masterkorp: any ideas ?
[2012-11-16 14:15:25 -0500] erkules: is there a license for private chef?
[2012-11-16 14:16:19 -0500] masterkorp: a license ? for what ?
[2012-11-16 14:17:01 -0500] erkules: when downloding it it is talking about a free trial
[2012-11-16 14:20:45 -0500] masterkorp: lol
[2012-11-16 14:21:06 -0500] erkules: pardon?
[2012-11-16 14:21:10 -0500] masterkorp: Are you setting your own server ?
[2012-11-16 14:21:41 -0500] erkules: evaluating yes
[2012-11-16 14:22:08 -0500] masterkorp: chef is Apache 2.0
[2012-11-16 14:22:21 -0500] masterkorp: you can set it on your server without any constraits
[2012-11-16 14:22:31 -0500] erkules: this doesn't mean privat chef got to be apache 2.0
[2012-11-16 14:22:34 -0500] masterkorp: opscode even distributes debin repos
[2012-11-16 14:22:57 -0500] masterkorp: you just install it from the repos and it works, without any limitation
[2012-11-16 14:22:58 -0500] erkules: yes. Im talking about the offer privat chef
[2012-11-16 14:23:04 -0500] yfeldblum: mancdaz, because sometimes the context happens to be the same but sometimes it happens to be different; the question isn't "why doesn't it work with providers" ... the real question should be "why does it work at all with recipes?"
[2012-11-16 14:23:27 -0500] BryanWB_: free trial is for hosted chef iirc
[2012-11-16 14:23:39 -0500] erkules: http://www.opscode.com/private-chef/
[2012-11-16 14:23:51 -0500] erkules: ... About the Free Trial
[2012-11-16 14:24:13 -0500] jtimberman: erkules: sales will contact you with a download link and additional information about the private chef trial
[2012-11-16 14:24:28 -0500] jtimberman: BryanWB_: hosted chef doesn't have a trial, it has afree plan up to 5 nodes ;)
[2012-11-16 14:24:38 -0500] masterkorp: erkules: oh that is support wise
[2012-11-16 14:24:44 -0500] BryanWB_: jtimberman: ah, that's waht i meant :/
[2012-11-16 14:24:51 -0500] jtimberman: Private Chef != Open Source Chef Server.
[2012-11-16 14:24:57 -0500] erkules: jtimberman: so privat chef it not apache 2.0?
[2012-11-16 14:25:00 -0500] jtimberman: We support the first, not the second.
[2012-11-16 14:25:03 -0500] jtimberman: erkules: No.
[2012-11-16 14:25:08 -0500] erkules: jtimberman: thx
[2012-11-16 14:25:12 -0500] masterkorp: jtimberman: but the code its the same ?
[2012-11-16 14:25:14 -0500] jtimberman: It has components that are part of the open source Chef Server.
[2012-11-16 14:25:15 -0500] jtimberman: no
[2012-11-16 14:25:19 -0500] kryptek: Good morning, #chef
[2012-11-16 14:25:24 -0500] jtimberman: The *API* from a chef-client perspective is the same.
[2012-11-16 14:25:48 -0500] masterkorp: jtimberman: what are the diferences ?
[2012-11-16 14:26:08 -0500] jtimberman: i don't have time to enumerate them right now ;)
[2012-11-16 14:26:12 -0500] jtimberman: gotta get kids to school
[2012-11-16 14:26:13 -0500] masterkorp: heh
[2012-11-16 14:26:16 -0500] masterkorp: bye
[2012-11-16 14:28:06 -0500] masterkorp: So here is my question: Trying to access node["name"] from the recipe gives me nil, yet node.to_hash().["name"] works. This does not happen with node["ipaddres"]. Why is this ? i am using chef 10.16.2 both server and client
[2012-11-16 14:30:58 -0500] yfeldblum: masterkorp, https://github.com/opscode/chef/blob/10.16.2/chef/lib/chef/node.rb#L464
[2012-11-16 14:36:02 -0500] mancdaz: yfeldblum: ok, I don't know why it works in recipes
[2012-11-16 14:36:13 -0500] mancdaz: yfeldblum: but I would like to know how to make it work in my provider :-)
[2012-11-16 14:37:09 -0500] masterkorp: yfeldblum: so node name isn't an automatic attribute ?
[2012-11-16 14:37:51 -0500] yfeldblum: masterkorp, of course not
[2012-11-16 14:38:05 -0500] masterkorp: thanks
[2012-11-16 14:38:21 -0500] yfeldblum: mancdaz, providers, unlike recipes, are supposed to be normal ruby classes
[2012-11-16 14:38:46 -0500] yfeldblum: mancdaz, so in providers, you should write normal ruby code (not recipe dsl code)
[2012-11-16 14:39:13 -0500] mancdaz: yfeldblum: ok, but you can still access other resources from the provider too...?
[2012-11-16 14:39:21 -0500] mancdaz: which is very much dsl
[2012-11-16 14:39:56 -0500] yfeldblum: mancdaz, some parts of the dsl are available sometimes in providers
[2012-11-16 14:40:29 -0500] yfeldblum: mancdaz, but in general providers and recipes are 100% different beasts
[2012-11-16 14:40:59 -0500] mancdaz: yfeldblum: but isn't that by design rather than accident?  The docs suggest that a definition is a way of chaining resources, and that lwrp are the new/better way to write definitions, therefore I am viewing a provider as a way to chain resources
[2012-11-16 14:41:26 -0500] mancdaz: yfeldblum: and that works, to a point
[2012-11-16 14:41:34 -0500] yfeldblum: mancdaz, the docs are silly
[2012-11-16 14:41:53 -0500] mancdaz: yfeldblum: then what hope is there for a beginner like me :-(
[2012-11-16 14:42:23 -0500] yfeldblum: mancdaz, :)
[2012-11-16 14:42:55 -0500] yfeldblum: mancdaz, definitions (macros, really) are a way to write snippets of recipes
[2012-11-16 14:43:35 -0500] yfeldblum: mancdaz, providers are classes that take action on the system with respect to a resource, which means: normal ruby code
[2012-11-16 14:44:18 -0500] yfeldblum: mancdaz, e.g. look at the Chef::Provider::Directory provider here ... https://github.com/opscode/chef/blob/master/lib/chef/provider/directory.rb
[2012-11-16 14:46:03 -0500] mancdaz: yfeldblum: plenty of rubyness there
[2012-11-16 14:46:23 -0500] yfeldblum: mancdaz, yep, that's what a provider looks like
[2012-11-16 14:47:02 -0500] yfeldblum: mancdaz, there's a lightweight provider DSL which basically allows you to skip lines 26-28, but not terribly much more than that
[2012-11-16 14:47:22 -0500] mancdaz: yfeldblum: so my situation is that I want to have my provider do  a bunch of stuff, and then create a file based on a template, passing in params
[2012-11-16 14:47:30 -0500] mancdaz: so in my provider I am using the template resource
[2012-11-16 14:47:35 -0500] mancdaz: is that therefore bad?
[2012-11-16 14:48:24 -0500] yfeldblum: mancdaz, if you use it like you would in a recipe, yes; if you use it carefully, it's fine; carefully is defined as following my gist: https://gist.github.com/d85be145f3ff824ccc07
[2012-11-16 14:50:03 -0500] mancdaz: yfeldblum: so if all I want to do is tidy away some messy dsl from my recipe, I should use a definition?
[2012-11-16 14:51:00 -0500] mancdaz: main problem there is I need to be able to have notification when the file I am working on has been changed - hence my choice of lwrp
[2012-11-16 14:52:33 -0500] yfeldblum: mancdaz, one resource can subscribe to any other preceding resource in the same resources-collection; and calling a definition actually inserts the definition's resources into the resources-collection, so you can subscribe to any resource declared in a definition that you called
[2012-11-16 14:54:50 -0500] mancdaz: yfeldblum: ok maybe I should be using a definition then.  Assuming I would be able to access those external libraries that I am able to from a recipe (but not a provider)?
[2012-11-16 14:55:31 -0500] yfeldblum: mancdaz, yes
[2012-11-16 14:55:32 -0500] mancdaz: yfeldblum: and then ignore foodcritic bitching at me telling me to convert my definition to a lwrp :-)
[2012-11-16 14:55:44 -0500] yfeldblum: mancdaz, yeah that's bad advice
[2012-11-16 14:56:22 -0500] mancdaz: yfeldblum: "Chef definitions are an older approach to creating a higher-level abstraction for a group of resources. Unlike LWRPs they are not first class resources and cannot receive notifications. You should prefer LWRPs for new development"
[2012-11-16 14:57:01 -0500] yfeldblum: mancdaz, there are many definitions out there that ought to be resources + providers; and there are many LWRP's out there that have no business being LWRP's and ought to have been definitions instead
[2012-11-16 14:57:13 -0500] yfeldblum: mancdaz, that's nonsense
[2012-11-16 14:58:36 -0500] yfeldblum: mancdaz, i mean it's true that definitions are not first-class resource, cannot notify or subscribe, and do not have guards; but so what? that doesn't mean "don't use them" ... it just means "learn how they work"
[2012-11-16 15:01:07 -0500] geekbri: definitions can be useful, its all about use case.
[2012-11-16 15:02:24 -0500] Ramblurr: i have a bunch of attributes like node['cookbook']['conf']['thing1'], ..['thing2'], .. ['thingn'], in my template how can i look through all ['cookbook']['conf'] values
[2012-11-16 15:02:37 -0500] Ramblurr: i want the keys as well as values
[2012-11-16 15:05:13 -0500] cheflevelramen: You could use shef on a chef instance:
[2012-11-16 15:05:13 -0500] cheflevelramen: chef > node.each do |attr|
[2012-11-16 15:05:13 -0500] cheflevelramen: chef > puts "Attribute is: #{attr}"
[2012-11-16 15:05:14 -0500] cheflevelramen: chef ?> end
[2012-11-16 15:05:33 -0500] cheflevelramen: That will list out each of the keys/values
[2012-11-16 15:05:55 -0500] Ramblurr: shef?
[2012-11-16 15:06:06 -0500] cheflevelramen: It's chef's shell cli
[2012-11-16 15:06:16 -0500] Ramblurr: oh
[2012-11-16 15:06:35 -0500] yfeldblum: Ramblurr, http://pastie.org/private/x532yogpa3ic1mvozsyseq
[2012-11-16 15:08:27 -0500] Ramblurr: yfeldblum: a perfect, thanks
[2012-11-16 15:08:37 -0500] Ramblurr: i was missing the .to_hash
[2012-11-16 15:09:35 -0500] CraHan: When using owner with RemoteDirectory, doesn't it set the owner for all subdirectories too?
[2012-11-16 15:10:09 -0500] CraHan: I have a directory with subdirectories and files I want to copy over, but only part of the folder structure gets the correct owner and group
[2012-11-16 15:10:41 -0500] Ramblurr: yfeldblum: oh hm, what about the case when there is another level of nesting?
[2012-11-16 15:11:03 -0500] Ramblurr: node["cookbook"]["conf"]['thingn']['subthing1']
[2012-11-16 15:11:14 -0500] Ramblurr: just that extra level, no need for arbitrary depth
[2012-11-16 15:13:07 -0500] yfeldblum: Ramblurr, http://pastie.org/private/mrxwyq7elcf1bcupvxfz0g
[2012-11-16 15:14:15 -0500] Ramblurr: yfeldblum: noob question here, but is the logic in the template, just standard ruby ?
[2012-11-16 15:14:32 -0500] yfeldblum: Ramblurr, it's ERB
[2012-11-16 15:14:39 -0500] yfeldblum: Ramblurr, "Embedded Ruby"
[2012-11-16 15:15:00 -0500] yfeldblum: Ramblurr, it's a way to embed normal ruby code inside a text template
[2012-11-16 15:15:04 -0500] yfeldblum: Ramblurr, kinda like php
[2012-11-16 15:15:12 -0500] yfeldblum: Ramblurr, or asp.net
[2012-11-16 15:15:45 -0500] yfeldblum: Ramblurr, but that is normal ruby code, embedded in the manner specified by ERB
[2012-11-16 15:16:15 -0500] yfeldblum: Ramblurr, http://www.stuartellis.eu/articles/erb/
[2012-11-16 15:16:36 -0500] masterkorp: Can you guys create repositories on github ?
[2012-11-16 15:16:44 -0500] Ramblurr: yfeldblum: super, thanks for the doc
[2012-11-16 15:17:42 -0500] masterkorp: i am getting errorsd
[2012-11-16 15:19:23 -0500] masterkorp: after 5 tries i can
[2012-11-16 15:22:41 -0500] Ramblurr: is it not possible to (1) access data bags from attributes file, and (2) access data bags from a roles/role.json  to override an attribute?
[2012-11-16 15:24:44 -0500] yfeldblum: Ramblurr, (1) it's possible but a very bad idea; (2) it's possible but it's even worse of an idea
[2012-11-16 15:25:20 -0500] Ramblurr: why so?
[2012-11-16 15:27:44 -0500] CaptainQuirk: Hi there
[2012-11-16 15:27:56 -0500] CaptainQuirk: I'm having a problem with the opscode community php cookbook
[2012-11-16 15:28:22 -0500] CaptainQuirk: I'm using chef as a provisioner for vagrant btw
[2012-11-16 15:28:30 -0500] CaptainQuirk: my box is a ubuntu precise32
[2012-11-16 15:28:43 -0500] CaptainQuirk: Chef fails on installing php5-cgi
[2012-11-16 15:30:13 -0500] CaptainQuirk: apt returns 100 as a code
[2012-11-16 15:31:03 -0500] wassy121: Maybe a pastebin of the actual error it is giving could help?
[2012-11-16 15:31:57 -0500] CaptainQuirk: wassy121, http://pastebin.com/dhi9CmyR
[2012-11-16 15:33:10 -0500] cheeseplus: CaptainQuirk: have you tried running the command manually? I'm betting you need an apt-get update or the version has changed
[2012-11-16 15:34:04 -0500] patjenk: are there any best practices or style guides for naming cookbooks? I put dashes in my first cookbook and LWRP functions are a pain now.
[2012-11-16 15:34:52 -0500] cheeseplus: CaptainQuirk: very likely an apt-get update before hand fixes it
[2012-11-16 15:39:13 -0500] CaptainQuirk: cheeseplus, that did it thanks !
[2012-11-16 15:39:46 -0500] CaptainQuirk: However, I get fome warnings from Chef itself on syntax related issues
[2012-11-16 15:40:25 -0500] CaptainQuirk: http://pastebin.com/TZ8TcKzf
[2012-11-16 15:45:10 -0500] davidmz: hello, I have a pastebin with a part of a chef recipe  and the error output http://pastebin.com/qRzQ7Sb1 this is suddenly stopped working and I don't understand the cause, when I run the commend in the shell I get 0 as an exit code
[2012-11-16 15:52:04 -0500] davidmz: hello, I have a pastebin with a part of a chef recipe  and the error output http://pastebin.com/qRzQ7Sb1 this is suddenly stopped working and I don't understand the cause, when I run the commend in the shell I get 0 as an exit code
[2012-11-16 15:54:25 -0500] barnacles: try replacing that execute with a gem_package resource instead and see what you get. http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-11-16 15:54:42 -0500] jtimberman: davidmz: why is that using an execute resource to install the gem instead of the gem_package (if you need for the OS), or chef_gem (if you need it to use in a Chef run)
[2012-11-16 15:54:49 -0500] barnacles: ^
[2012-11-16 15:55:04 -0500] specialsauce: davidmz: what he said, go for the most idempotent solution possible, state a desired state not how to get there
[2012-11-16 15:55:10 -0500] specialsauce: question: anyone aware of a cookbook for a tool that can do arbitrary log analysis?
[2012-11-16 15:55:17 -0500] jtimberman: btw, updated package documentation is here: http://docs.opscode.com/resource_package.html
[2012-11-16 15:55:35 -0500] jtimberman: specialsauce: seems vague, do you have a tool in mind?
[2012-11-16 15:55:56 -0500] barnacles: jtimberman: thanks!
[2012-11-16 15:55:58 -0500] jtimberman: CaptainQuirk: those warnings are letting you know about a change that is coming in chef 11.
[2012-11-16 15:56:01 -0500] specialsauce: jtimberman, not got a solution in place that i need to map to chef, no, i have a need to provide this so might as well do it via chef
[2012-11-16 15:56:23 -0500] specialsauce: i need a tool that can provice smart frequency analysis etc for reporting from arbitarily-formatted application logs
[2012-11-16 15:56:39 -0500] jtimberman: CaptainQuirk: would have to se your attributes file and/or recipe where its setting node attributes, but look for the pattern like: node['thing'] = 'thing2'
[2012-11-16 15:56:51 -0500] jtimberman: specialsauce: logstash perhaps?
[2012-11-16 15:56:55 -0500] davidmz: what is the syntax
[2012-11-16 15:56:56 -0500] jtimberman: or graylog2
[2012-11-16 15:57:14 -0500] jtimberman: davidmz: gem_package "albacore" or chef_gem "albacore"
[2012-11-16 15:57:15 -0500] davidmz: i'll change it and let you know if this works
[2012-11-16 15:57:21 -0500] davidmz: thanks
[2012-11-16 15:57:24 -0500] CaptainQuirk: Yes I gathered that. The cookbooks I'm using have not reacted to this yet I guess
[2012-11-16 15:57:29 -0500] jtimberman: depending on whether you want it in chef's ruby environment or the system ruby
[2012-11-16 15:57:36 -0500] jtimberman: CaptainQuirk: could be!
[2012-11-16 15:59:32 -0500] davidmz: it woked, thank you very much
[2012-11-16 16:03:20 -0500] masterkorp: i love chiptunes music
[2012-11-16 16:03:28 -0500] masterkorp: very relaxing for coding
[2012-11-16 16:03:33 -0500] killfill: hi
[2012-11-16 16:03:48 -0500] killfill: deploy_revision has this default: symlinks {"system"=>"public/system", "pids"=>"tmp/pids", "log"=>"log"}
[2012-11-16 16:04:03 -0500] killfill: how do i make that hash empty?.. i dont need that sym links on my app.
[2012-11-16 16:04:26 -0500] killfill: if i do "symlinks {}" it will not be emptied.. :S
[2012-11-16 16:04:46 -0500] yfeldblum: killfill, http://pastie.org/private/1xawa8fxs6gfdos7qslgka
[2012-11-16 16:05:42 -0500] killfill: yfeldblum: thanks!!
[2012-11-16 16:06:51 -0500] dougireton: ohai Chefs!
[2012-11-16 16:07:15 -0500] dougireton: If I need to fail a Chef run because of errors in an application's install log, what's the best way to do that?
[2012-11-16 16:07:25 -0500] dougireton: Chef::Log.error?
[2012-11-16 16:08:33 -0500] barnacles: jtimberman: What version of chef is the new documentation based on?
[2012-11-16 16:09:09 -0500] jtimberman: barnacles: "current"
[2012-11-16 16:09:22 -0500] jtimberman: barnacles: 10.16.2 I believe
[2012-11-16 16:09:41 -0500] jtimberman: there's plans to match the documentation version vs chef's version, but i am not directly involved in that
[2012-11-16 16:10:11 -0500] barnacles: Hmm, must be a little ahead. There's some knife commands I'm unable to do
[2012-11-16 16:10:57 -0500] jtimberman: which ones?
[2012-11-16 16:11:35 -0500] barnacles: knife upload
[2012-11-16 16:11:45 -0500] jtimberman: gem install knife-essentials
[2012-11-16 16:11:48 -0500] jtimberman: :)
[2012-11-16 16:11:52 -0500] barnacles: =O
[2012-11-16 16:12:17 -0500] barnacles: <3
[2012-11-16 16:12:35 -0500] jtimberman: that'll be in Chef 11.
[2012-11-16 16:13:04 -0500] barnacles: Are there any other gems out there I don't know of? :P
[2012-11-16 16:13:26 -0500] ssd7: knife-essentials is one of my favorite features of Chef 11
[2012-11-16 16:14:19 -0500] dougireton: jtimberman: should I use Chef::Log.error, Chef::Log.fatal, or raise a Ruby exception in a recipe to fail a Chef run?
[2012-11-16 16:18:04 -0500] kallistec: dougireton: raise an exception. the other things will just log messages
[2012-11-16 16:21:07 -0500] dougireton: Chef docs seem to indicate that Chef::Log.fatal will raise an exception: http://docs.opscode.com/essentials_cookbook_recipes_handlers_and_logs.html
[2012-11-16 16:21:14 -0500] dougireton: is that wrong?
[2012-11-16 16:21:37 -0500] jtimberman: dougireton: I like Chef::Application.fatal!("omg the zombies are attacking get yer chainsaw")
[2012-11-16 16:21:51 -0500] dougireton: LOL awesome, I"ll have to use that
[2012-11-16 16:22:00 -0500] jtimberman: dougireton: looks like that's a typo
[2012-11-16 16:23:02 -0500] jtimberman: bah i has a typo too
[2012-11-16 16:23:10 -0500] dougireton: k, should I raise a Chef::Exceptions::Application or is that reserved for internal Chef stuff?
[2012-11-16 16:23:24 -0500] jtimberman: wait no
[2012-11-16 16:23:38 -0500] jtimberman: Chef::Application.fatal!() is correct - may just not work in shef
[2012-11-16 16:23:57 -0500] jtimberman: yeah, doesn't work in shef unless require 'chef/application'
[2012-11-16 16:24:05 -0500] dougireton: you mean Chef::Log.fatal?
[2012-11-16 16:24:17 -0500] dougireton: or Chef::Application.fatal?
[2012-11-16 16:24:37 -0500] jtimberman: dougireton: Chef::Application.fatal!
[2012-11-16 16:24:41 -0500] jtimberman: the bang is important
[2012-11-16 16:24:45 -0500] dougireton: ok, good to know
[2012-11-16 16:24:49 -0500] jtimberman: http://rubydoc.info/gems/chef/Chef/Application#fatal%21-class_method
[2012-11-16 16:24:56 -0500] masterkorp: BANG
[2012-11-16 16:25:13 -0500] jtimberman: :)
[2012-11-16 16:25:14 -0500] dougireton: perfect, just what I needed
[2012-11-16 16:25:17 -0500] dougireton: thanks all
[2012-11-16 16:39:57 -0500] wassy121: is there an easy way to remove the entire run_list from a node via knife (without invoking $EDITOR)?
[2012-11-16 16:40:32 -0500] wassy121: I'm trying to write up a script to revert a node to role['base'], no matter what it's currently configured to do
[2012-11-16 16:44:46 -0500] ranjibd: yeah
[2012-11-16 16:44:49 -0500] jtimberman: wassy121: knife exec
[2012-11-16 16:45:09 -0500] jtimberman: wassy121: something like this: knife exec -E 'nodes.transform("name:node-name-that-you-want") {|n| n.run_list(["role[base]"])}'
[2012-11-16 16:45:10 -0500] ranjibd: there you go :-)
[2012-11-16 16:46:03 -0500] wassy121: oh, hey.  That's way easier than parsing "knife show -r" | "knife node run_list remove".  Thanks
[2012-11-16 16:52:27 -0500] yfeldblum: wassy121, for common scenarios, it's probably best to write your own knife plugin
[2012-11-16 16:56:58 -0500] wassy121: Understood.  I'll do that eventually, I'm just trying to get the first iteration done, and figure this will do what I need for now
[2012-11-16 16:59:45 -0500] yfeldblum: wassy121, once you get the hang of it, it's really easy
[2012-11-16 17:13:47 -0500] barnacles: jtimberman: Should the last line on http://docs.opscode.com/knife_upload.html be read as knife upload / ?
[2012-11-16 17:16:25 -0500] jtimberman: barnacles: uhm, maybe? I don't know - I haven't used knife-essentials stuff much myself.
[2012-11-16 17:41:16 -0500] barnacles: Has anyone had trouble getting the NTP cookbook to run the first time around on CentOS?
[2012-11-16 17:41:49 -0500] barnacles: Always have to run it twice, throws a "cannot determine group id for 'ntp'"
[2012-11-16 17:49:19 -0500] qhartman: I haven't noticed that, but if I were to guess I'd wager that the cookbook is trying to something it shouldn't before the package is actually installed
[2012-11-16 17:49:31 -0500] qhartman: which should also create that user
[2012-11-16 18:05:00 -0500] goutam_: Hello
[2012-11-16 18:05:21 -0500] cheflevelramen: hi
[2012-11-16 18:05:23 -0500] goutam_: could any one please help me with my issue
[2012-11-16 18:05:58 -0500] cheflevelramen: probably
[2012-11-16 18:06:02 -0500] goutam_: i am very new to chef and wanted some info about it
[2012-11-16 18:06:31 -0500] cheflevelramen: so what's the question?
[2012-11-16 18:06:34 -0500] red5|ryan: what is your issue?
[2012-11-16 18:06:47 -0500] goutam_: i want to install these some packages on some servers and edit .bashrc to make sqlplus installed
[2012-11-16 18:07:01 -0500] goutam_: i have written recipe for it like this
[2012-11-16 18:07:14 -0500] goutam_: package "rpm_package" do   version "11.1.0.7.0"   action :install   source "/tmp/oracle-instantclient11.1-basic-11.1.0.7.0-1.x86_64.rpm"   provider Chef::Provider::Package::Rpm end  package "rpm_package" do   version "11.1.0.7.0"   action :install   source "/tmp/oracle-instantclient11.1-sqlplus-11.1.0.7.0-1.x86_64.rpm"   provider Chef::Provider::Package::Rpm end  cookbook_file "/opt/browsersoft/.bashrc " do   source ".bashrc" # This 
[2012-11-16 18:08:05 -0500] goutam_: culd some suggest some thing on this
[2012-11-16 18:08:17 -0500] goutam_: some one*
[2012-11-16 18:09:04 -0500] goutam_: sorry , seems paste come in this format only
[2012-11-16 18:09:47 -0500] goutam_: is this readable for you guys ?
[2012-11-16 18:09:58 -0500] cheflevelramen: can you use pastebin (http://pastebin.com/)
[2012-11-16 18:10:07 -0500] cheflevelramen: and give us a link
[2012-11-16 18:10:28 -0500] goutam_: sure
[2012-11-16 18:11:29 -0500] goutam_: http://pastebin.com/kBUzEs0j
[2012-11-16 18:13:40 -0500] goutam_: cheflevelramen, does this link give you some thing ?
[2012-11-16 18:13:57 -0500] cheflevelramen: Thanks. So what's the question then?
[2012-11-16 18:14:20 -0500] goutam_: my question is will this work ?
[2012-11-16 18:14:22 -0500] red5|ryan: Looks fine to me. I guess I might change the friendly name to something more descriptive. package "Oracle Client Basic" do
[2012-11-16 18:14:38 -0500] goutam_: as i am not sure
[2012-11-16 18:14:40 -0500] red5|ryan: Do you have something dropping those rpms in temp?
[2012-11-16 18:14:51 -0500] goutam_: oh that's great
[2012-11-16 18:15:21 -0500] goutam_: i've just included the dir name randomly
[2012-11-16 18:15:49 -0500] goutam_: i can place the package from where i want to get it
[2012-11-16 18:16:40 -0500] goutam_: and one more thing
[2012-11-16 18:16:42 -0500] red5|ryan: you could cookbook_file the rpms too. if you wanted.
[2012-11-16 18:17:01 -0500] goutam_: how ?
[2012-11-16 18:17:09 -0500] red5|ryan: but maintaining a specific version of an rpm or deb in a cookbook might be a pita down the road
[2012-11-16 18:17:11 -0500] red5|ryan: ummm
[2012-11-16 18:17:20 -0500] red5|ryan: the same way you did the bashrc
[2012-11-16 18:17:24 -0500] red5|ryan: except before you call package
[2012-11-16 18:17:26 -0500] josephholsten: I've got an rsyslog file input lwrp I'd like to add to the rsyslog cookbook. anyone got a preference of resource name?
[2012-11-16 18:17:39 -0500] red5|ryan: so the file is there to use as a source
[2012-11-16 18:17:41 -0500] goutam_: ok
[2012-11-16 18:18:26 -0500] goutam_: as i am very new i wriiten the recipe with the help of diffreent sites
[2012-11-16 18:18:28 -0500] josephholsten: I'm leaning toward rsyslog_file_input("tag") { file "/path" }
[2012-11-16 18:18:46 -0500] goutam_: and not sure how chef server and chef client communicate
[2012-11-16 18:19:35 -0500] goutam_: which file to configure for wich info such as client.rb and server.rb
[2012-11-16 18:20:34 -0500] goutam_: if you guys could help me get the steps how to install chef servers and chef client and make recipe test and work would be a great help
[2012-11-16 18:20:39 -0500] goutam_: and beginning for me
[2012-11-16 18:21:09 -0500] fromonesrc: windows chefs halp!
[2012-11-16 18:21:15 -0500] fromonesrc: error uploading the chef client validation key https://gist.github.com/4089619
[2012-11-16 18:21:59 -0500] dougireton: fromonesrc: which version of the chef-client?
[2012-11-16 18:22:29 -0500] goutam_: i am trying to di it on Linux node
[2012-11-16 18:22:43 -0500] goutam_: version 5 or 6
[2012-11-16 18:22:59 -0500] fromonesrc: dougireton: 10.16.2
[2012-11-16 18:24:07 -0500] dougireton: it's trying to find c:\etc\chef but from Chef-client 10.10 onwards, chef is installed to c:\chef, not c:\etc\chef
[2012-11-16 18:25:02 -0500] dougireton: Does C:\opscode\chef\bin\chef-client.bat have a reference to c:\etc\chef?
[2012-11-16 18:25:03 -0500] goutam_: hi Ryan
[2012-11-16 18:25:12 -0500] goutam_: you still there ?
[2012-11-16 18:25:47 -0500] fromonesrc: dougireton: thank you! my vagrantfile had chef.provisioning_path = "/etc/chef"
[2012-11-16 18:25:52 -0500] fromonesrc: working once I changed that value
[2012-11-16 18:26:01 -0500] dougireton: excellent fromonesrc
[2012-11-16 18:26:05 -0500] dougireton: glad it worked
[2012-11-16 18:26:52 -0500] fromonesrc: now getting "The request failed because your clock has drifted by more than 15 minutes." so need to figure out how to set the time via winrm...
[2012-11-16 18:28:21 -0500] ranjibd: goutam_, whats the size of those rpms?
[2012-11-16 18:28:43 -0500] goutam_: could any one help me out here please ?
[2012-11-16 18:29:10 -0500] ranjibd: goutam_, we are trying,..
[2012-11-16 18:30:03 -0500] ranjibd: goutam_, if those rpms are small enough , put them inside the cookbook itself
[2012-11-16 18:30:20 -0500] goutam_: it's 45522 KB and 832 KB
[2012-11-16 18:31:14 -0500] ranjibd: goutam_, are they available in internet..? then you can download them on the fly. 45 MB is too big to push inside a chef repo .
[2012-11-16 18:32:00 -0500] goutam_: yes they are availble on oracle site
[2012-11-16 18:33:02 -0500] goutam_: download them on the fly ?
[2012-11-16 18:33:13 -0500] goutam_: what does this mean ?
[2012-11-16 18:35:54 -0500] goutam_: ranjibd ?
[2012-11-16 18:36:02 -0500] ranjibd: goutam_, check the remote_file resource ,
[2012-11-16 18:36:35 -0500] ranjibd: goutam_, http://wiki.opscode.com/display/chef/Resources#Resources-RemoteFile
[2012-11-16 18:37:13 -0500] goutam_: ok, will this installation won't work
[2012-11-16 18:37:32 -0500] goutam_: as we do for normal packages
[2012-11-16 18:37:35 -0500] PJ__: Hi guys. Is it possible to install a gem from a git repository using gem_package? If you set the source to (for instance): source "https://github.com/KarateCode/soap4r.git"   it fails.
[2012-11-16 18:39:59 -0500] goutam_:  remote_file "/tmp/testfile" do   source "http://www.example.com/tempfiles/testfile"   mode "0644"   checksum "08da002l" # A SHA256 (or portion thereof) of the file. end
[2012-11-16 18:40:30 -0500] goutam_: this will only trsfet the file not install the packages right ?
[2012-11-16 18:42:24 -0500] ranjibd: goutam_, this will only install the rpm, next you use the package resource to install the downloaded rpm , with source pointing to /tmp/testfile
[2012-11-16 18:42:40 -0500] ranjibd: goutam_, please use pastebin, and dont copy paste here
[2012-11-16 18:43:22 -0500] ranjibd: PJ__, that git repo .. does it have a pkg or build folder inside, where you can get the .gem file?
[2012-11-16 18:43:34 -0500] barnacles: Has anyone encountered this problem: http://tickets.opscode.com/browse/COOK-1854 http://tickets.opscode.com/browse/COOK-1092
[2012-11-16 18:43:37 -0500] goutam_: sure
[2012-11-16 18:44:46 -0500] ranjibd: PJ__, if not, then use the git resource to shallow clone the repo, then use a execute resource to build it (this will build the gem), and finally use the gem_package resource to install it
[2012-11-16 18:45:15 -0500] ranjibd: PJ__, im not sure.. but i guess you can use the ark resource to download the entire repo as a zip and then unpack, build and install
[2012-11-16 18:46:16 -0500] PJ__: ranjibd, thanks a lot. I need to get my head around this - I am not sure I understand...
[2012-11-16 18:46:37 -0500] j^2: hey all
[2012-11-16 18:46:46 -0500] j^2: so i have a private chef server
[2012-11-16 18:46:51 -0500] j^2: i have my chef_repo on github
[2012-11-16 18:46:56 -0500] j^2: how to i make sure they are the same?
[2012-11-16 18:47:28 -0500] Litex: Berkshelf is one way you could.
[2012-11-16 18:47:45 -0500] goutam_: ranjibd, if you have already placed a package in  chef server and using that packges to install it across client
[2012-11-16 18:48:01 -0500] goutam_: do we still need to use reote resource
[2012-11-16 18:48:07 -0500] j^2: Litex: is there a way i can pull it down?
[2012-11-16 18:48:46 -0500] ivey: j^2: you could us a jenkins/other CI job that fetches the repo on each change, and then pushes it to the chef server
[2012-11-16 18:48:47 -0500] atrius: hmmm... i'm starting to wonder if the webui is really that useful or if it mainly just obscures things and complicates things... is that just me?
[2012-11-16 18:48:55 -0500] j^2: ivey: hmm
[2012-11-16 18:49:11 -0500] ranjibd: PJ__, go step by step.. use the git resource to clone the repo locally first
[2012-11-16 18:49:15 -0500] j^2: ok, i'm not 100% sure how they are even different, i thought there might be a private-chef+github integration
[2012-11-16 18:49:32 -0500] ivey: not that i know of
[2012-11-16 18:49:45 -0500] j^2: damn, so there is something we do inhouse..
[2012-11-16 18:49:46 -0500] j^2: crap
[2012-11-16 18:49:59 -0500] ivey: ah, i see
[2012-11-16 18:50:23 -0500] ivey: small cloud server that runs a script to pull / upload every 10 minutes or so?
[2012-11-16 18:50:37 -0500] ivey: then it's not in-house :-)
[2012-11-16 18:50:41 -0500] j^2: :-/ yeah might be, i'm trying to look :(
[2012-11-16 18:51:04 -0500] dougireton: atrius: we don't use the webUI at all
[2012-11-16 18:51:10 -0500] ranjibd: goutam_, not sure if i understand you
[2012-11-16 18:51:15 -0500] dougireton: We do everything via knife
[2012-11-16 18:51:19 -0500] dougireton: and Jenkins
[2012-11-16 18:51:31 -0500] ranjibd: atrius, dougireton same here.. no webui
[2012-11-16 18:51:37 -0500] atrius: dougireton: i'm thinking in that direction too... seems it'll be easier to learn chef that way than trying to use the webui
[2012-11-16 18:51:42 -0500] goutam_: sorry for confusing you
[2012-11-16 18:52:52 -0500] goutam_: i am assuming if you have packages placed in chefserver and if you run recipe it will install that packages on client nodes
[2012-11-16 18:53:24 -0500] goutam_: am i correct ?
[2012-11-16 18:54:47 -0500] ranjibd: goutam_, no
[2012-11-16 18:55:15 -0500] dougireton: you can do things in the WebUI which don't map back to a git commit, which is bad
[2012-11-16 18:55:18 -0500] ranjibd: stuff stored inside chef server only served to chef client upon request..
[2012-11-16 18:55:18 -0500] mattupstate: is there a method with chef that can ensure a line in a text file exists?
[2012-11-16 18:55:33 -0500] dougireton: using git -> Jenkins is a better workflow
[2012-11-16 18:55:40 -0500] ranjibd: you have to tell the client explicitly what to do with it.
[2012-11-16 18:58:29 -0500] goutam_: so first i have to use remote resource for placing these packages
[2012-11-16 18:58:47 -0500] goutam_: and then use packge resourec to install it
[2012-11-16 18:58:49 -0500] goutam_: ?
[2012-11-16 18:58:52 -0500] atrius: correct me if i'm off my nut... but it should be possible to set things up in such a way that i could create a VM and have it run chef-client on its first start to pick up its personality, no?
[2012-11-16 18:59:07 -0500] ranjibd: goutam_, yes
[2012-11-16 18:59:19 -0500] ranjibd: you pretty much mimic a manual workflow
[2012-11-16 18:59:26 -0500] goutam_: Thanks a lot ranjibd :)
[2012-11-16 18:59:41 -0500] ranjibd: atrius, yeah
[2012-11-16 19:00:09 -0500] ranjibd: atrius, assuming  it has chef client in it. and it knows what to run (i.e. its run list , environment etc)
[2012-11-16 19:00:53 -0500] goutam_: if you could please provide me some link from where i can use steps to install chef server and configure chef client would be greatly appreciated
[2012-11-16 19:00:58 -0500] ranjibd: atrius, for the first time you generally do it via the -j flag (and passing a json containing all those details). This step combined with the chef client installation process known as bootstrap
[2012-11-16 19:01:35 -0500] ranjibd: goutam_, which linux distro you are using? opscode wiki has a decent page on getting started
[2012-11-16 19:01:38 -0500] atrius: ranjibd: so i'd create the VM, then point bootstrap at it with whatever settings i want to give it?
[2012-11-16 19:01:52 -0500] ranjibd: atrius, yeah
[2012-11-16 19:01:57 -0500] ranjibd: atrius, create a vm
[2012-11-16 19:02:20 -0500] ranjibd: and then use knife bootstrap <vm ip> <ssh details> <run list> etc...
[2012-11-16 19:02:39 -0500] ranjibd: atrius, check `knife bootstrap --help` for details
[2012-11-16 19:02:41 -0500] atrius: ranjibd: sounds good :)
[2012-11-16 19:02:42 -0500] goutam_: linux version 6
[2012-11-16 19:02:51 -0500] atrius: i'll poke at that after i get back from the store.. and on that note.. brb :D
[2012-11-16 19:03:11 -0500] ranjibd: goutam_, yeah.. the client installation is brain dead simple.. for the server use frameos blog.
[2012-11-16 19:03:29 -0500] ranjibd: goutam_, it will install a bit older chef server.. but for noobs it ok.
[2012-11-16 19:03:33 -0500] goutam_: but still configuring files such as client.rb and all looks confusing to me
[2012-11-16 19:04:02 -0500] ranjibd: goutam_,  for server http://blog.frameos.org/2011/05/19/installing-chef-server-0-10-in-rhel-6-scientificlinux-6/
[2012-11-16 19:04:24 -0500] ranjibd: goutam_, you dont have to do it, knife bootstrap will do it for you
[2012-11-16 19:04:33 -0500] goutam_: could you please provide me the link for his blog
[2012-11-16 19:04:38 -0500] ranjibd: ^^
[2012-11-16 19:04:44 -0500] goutam_: i am not sure where to find it
[2012-11-16 19:05:01 -0500] ranjibd: goutam_, just shared
[2012-11-16 19:05:49 -0500] goutam_: oh yes i've been through that
[2012-11-16 19:06:20 -0500] goutam_: any steps for chef client install
[2012-11-16 19:06:34 -0500] ranjibd: goutam_, knife bootstrap
[2012-11-16 19:07:35 -0500] goutam_: could you please elaborate
[2012-11-16 19:12:07 -0500] knuckolls: goutam_, if you have an existing virtual machine and you use knife bootstrap to set it up, it'll use this bootstrap template to automatically set up the chef installation and register with the chef server. if you want to emulate it, you can look at the chef-full bootstrap template to see what knife bootstrap runs after it ssh's into the vm.
[2012-11-16 19:12:08 -0500] knuckolls: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2012-11-16 19:16:33 -0500] Ramblurr: can data bages not contain {"nested": {"key": "values?"} }
[2012-11-16 19:16:45 -0500] goutam_: so basiaclly , i need to use these two commands on client nodes to get it configured with chef client which can talk to chef server
[2012-11-16 19:16:49 -0500] goutam_: wget http://goo.gl/dqwWr -O- > ~/.chef/bootstrap/rhel6-rbel.erb
[2012-11-16 19:17:10 -0500] goutam_: knife bootstrap -d rhel6-rbel my-new-node
[2012-11-16 19:17:34 -0500] goutam_: am i understanding it right ?
[2012-11-16 19:17:49 -0500] ranjibd: Ramblurr, i guess  they can.  you need the id key though
[2012-11-16 19:19:00 -0500] Ramblurr: ranjibd: I'm getting FATAL: JSON::ParserError: 743: unexpected token at '{
[2012-11-16 19:19:04 -0500] Ramblurr: at the first nested hash
[2012-11-16 19:19:33 -0500] beandip: Hello
[2012-11-16 19:19:43 -0500] beandip: I'm setting up a dev environment with chef/vagrant
[2012-11-16 19:20:11 -0500] beandip: My vagrant box is starting up fine but my chef run bombs out with [Fri, 16 Nov 2012 19:05:49 +0000] FATAL: Chef::Exceptions::Exec: package[libapache2-mod-php5] (apache2::mod_php5 line 23) had an error: Chef::Exceptions::Exec: apt-get -q -y install libapache2-mod-php5=5.3.10-1ubuntu3.2 returned 100, expected 0
[2012-11-16 19:20:35 -0500] beandip: Looking in the apache2 cookbook I don't see where it's getting the version 5.3.10
[2012-11-16 19:20:51 -0500] beandip: and running apt-get -q -y install libapache2-mod-php5=5.3.10-1ubuntu3.2 rather than apt-get -q -y install libapache2-mod-php5
[2012-11-16 19:23:21 -0500] goutam_: Hey knuckolls,
[2012-11-16 19:23:27 -0500] ranjibd: Ramblurr, pastebin ?
[2012-11-16 19:23:39 -0500] goutam_: could you please suggest ?
[2012-11-16 19:24:44 -0500] ranjibd: beandip, whats  mod_php5 line 23 does?
[2012-11-16 19:27:29 -0500] goutam_: Thanks ranjidb and others for your valuable info
[2012-11-16 19:28:17 -0500] beandip:   package "libapache2-mod-php5"
[2012-11-16 19:28:25 -0500] goutam_: it been a long night for me and will back again with some more questions
[2012-11-16 19:28:42 -0500] goutam_: thanks a lot guys
[2012-11-16 19:28:53 -0500] ranjibd: goutam_, sure,, more practice .. more success :-)
[2012-11-16 19:29:08 -0500] ranjibd: beandip, is php already installed?
[2012-11-16 19:29:34 -0500] goutam_: ranjidb , could i've your email id
[2012-11-16 19:29:48 -0500] goutam_: if i want to contact you
[2012-11-16 19:32:21 -0500] goutam_: never mind
[2012-11-16 19:32:24 -0500] goutam_: bye
[2012-11-16 19:34:17 -0500] j^2: ok, riddle me this...
[2012-11-16 19:34:25 -0500] j^2: [2012-11-16T13:27:20-06:00] FATAL: Chef::Exceptions::FileNotFound: cookbook_file[/etc/apache2/sites-available/sou.conf] (shibboleth::default line 284) had an error: Chef::Exceptions::FileNotFound: Cookbook 'shibboleth' (0.0.51) does not contain a file at any of these locations:
[2012-11-16 19:34:37 -0500] j^2: [ops01] cookbooks $ knife cookbook upload shibboleth
[2012-11-16 19:34:38 -0500] j^2: Uploading shibboleth     [0.0.53]
[2012-11-16 19:34:38 -0500] j^2: Uploaded 1 cookbook.
[2012-11-16 19:34:41 -0500] j^2: i uploaded it..
[2012-11-16 19:34:54 -0500] j^2: run the chef-client, but it still thinks it's 51...
[2012-11-16 19:35:07 -0500] j^2: how do i have it "recheckin?"
[2012-11-16 19:35:59 -0500] bemu: j^2: Is it pegged in your environment?
[2012-11-16 19:36:22 -0500] j^2: i don't think i have any environment other than _default
[2012-11-16 19:36:44 -0500] bemu: knife cookbook show shibbolet
[2012-11-16 19:36:51 -0500] bemu: and knife environment show _default
[2012-11-16 19:37:09 -0500] j^2: kk, one sec
[2012-11-16 19:38:29 -0500] doug: i'm trying to find out if the :boolean arg to option is setting a default or not
[2012-11-16 19:38:32 -0500] j^2: bemu: https://gist.github.com/4090213
[2012-11-16 19:38:34 -0500] doug: was hoping i'd find the place it's being defined
[2012-11-16 19:41:05 -0500] ranjibd: doug, for mixlib-clie?
[2012-11-16 19:42:52 -0500] j^2: bemu: any ideas? :(
[2012-11-16 19:42:58 -0500] doug: ranjibd++
[2012-11-16 19:44:16 -0500] doug: tho the docs for mixlib-cli don't say whether :boolean sets a default or not
[2012-11-16 19:44:30 -0500] j^2: o ho oh
[2012-11-16 19:44:32 -0500] miah: j^2: FATAL: Chef::Exceptions::FileNotFound: cookbook_file[/etc/apache2/sites-available/sou.conf]
[2012-11-16 19:44:33 -0500] doug: ":boolean:: If this option takes no arguments, set this to true."
[2012-11-16 19:44:38 -0500] miah: are you missing a file in your cookbook?
[2012-11-16 19:44:44 -0500] j^2: ok, turns out i have multiple enviromnemonts
[2012-11-16 19:45:00 -0500] miah: heh
[2012-11-16 19:45:17 -0500] j^2: https://gist.github.com/4090213
[2012-11-16 19:48:42 -0500] ranjibd: doug, so if you pass it its true, else its false, so is default really required?
[2012-11-16 19:49:02 -0500] ranjibd: doug, as in if you dont pass.. its false ,, if i understand correctly
[2012-11-16 19:49:35 -0500] bemu: j^2: You just answered your own question.
[2012-11-16 19:49:37 -0500] bemu: You got it?
[2012-11-16 19:49:41 -0500] j^2: yep
[2012-11-16 19:49:42 -0500] j^2: thanks!
[2012-11-16 19:49:42 -0500] bemu: kk
[2012-11-16 19:49:44 -0500] bemu: Np
[2012-11-16 19:50:30 -0500] Ramblurr: ranjibd: it was a simple syntax error.. :\
[2012-11-16 19:50:40 -0500] Ramblurr: is it possible to deep merge attributes and a databag?
[2012-11-16 19:51:39 -0500] Ramblurr: like if i had a Mash of a config file node['cookbook']['config'], and wanted to merge it with user overrides data_bag_item("cookbook", "config") ?
[2012-11-16 19:56:39 -0500] ranjibd: Ramblurr, yes
[2012-11-16 19:57:08 -0500] ranjibd: Ramblurr, theres a dedicated wiki on deep merge,, its forms the core of how attributes are overridden
[2012-11-16 20:16:07 -0500] PJ__: ranjibd: still trying to install a gem from git. Just to be sure: when you use gem_package, you can set the source to a local gem, right?
[2012-11-16 20:17:08 -0500] PJ__: ranjibd, that's what the doc says, but it fails. I am using an old Chef (0.6.0.2). Could it be why?
[2012-11-16 20:22:32 -0500] wabat_: Hi all...is there anyone here that could help me understand why cookbooks get cached in /var/cache/chef?  I'm looking for a way to prevent them from being cached since some of the data in there is sensitive
[2012-11-16 20:24:06 -0500] fromonesrc: wabat_: AFAIK they are cached for speed. you could use databags for storing sensitive data.
[2012-11-16 20:26:04 -0500] juliancdunn: wabat_: http://wiki.opscode.com/display/chef/Encrypted+Data+Bags
[2012-11-16 20:26:56 -0500] wabat_: Thank you fromonesrc and juliancdunn  ...  That presents a bit of a challenge at this point but it's good info
[2012-11-16 20:27:35 -0500] wabat_: I noticed an option called 'Memory' for the cache_type....would that alleviate this by chance
[2012-11-16 20:28:49 -0500] wabat_: Meaning, I can take a performance hit if it means temporarily keeping cookbooks from being cached
[2012-11-16 20:33:12 -0500] wabat_: Can this caching be disabled at all?
[2012-11-16 20:34:09 -0500] juliancdunn: wabat_: you could probably set the cache dir to /dev/null or something
[2012-11-16 20:34:20 -0500] juliancdunn: actually... that might not work
[2012-11-16 20:34:36 -0500] juliancdunn: because if the client consults the cache while running...
[2012-11-16 20:34:48 -0500] siezer: what exactlt is sensitive in the cache thats not somewhere else on the system?
[2012-11-16 20:36:35 -0500] wabat_: Well to be honest I think it's just something political between sysadmins and security
[2012-11-16 20:38:59 -0500] josephholsten: wabat: cookbooks should be no more of a security concern than operating system packages, which are also cached
[2012-11-16 20:39:30 -0500] josephholsten: that cache should only be readable by the root group
[2012-11-16 20:39:47 -0500] kallistec:  wabat_ extract the sensitive data to an encrypted data bag item
[2012-11-16 20:40:32 -0500] kallistec: also, the cache_options stuff is for a cache of filename+mtime=>sha256(file_content)
[2012-11-16 20:41:55 -0500] wabat_: Ok
[2012-11-16 20:42:06 -0500] wabat_: I guess I'll start working on this then
[2012-11-16 20:42:23 -0500] wabat_: Thanks guys...I appreciate the assistance on this
[2012-11-16 20:42:48 -0500] josephholsten: honestly, your security folks will probably realize that config mgmt is great for enforcing known state on machines
[2012-11-16 20:43:42 -0500] josephholsten: and they'll want you to run it often. I know of places that run chef every 10min. you will murder your network if you don't cache in that case.
[2012-11-16 20:56:38 -0500] dysinger: lulz https://github.com/opscode-cookbooks/nagios/blob/master/metadata.rb#L17
[2012-11-16 20:58:40 -0500] btm: Opscode cookbook review begins soon: join https://plus.google.com/hangouts/_/81cf565e2ed2f714c50ef1de918cc96222a627d9?authuser=1&hl=en or watch http://youtu.be/IR1jYQezoU4
[2012-11-16 21:04:24 -0500] dysinger: https://github.com/dysinger/nagios/commit/9e072688e19632789aa91d7c8a0f78aa649c7e2d
[2012-11-16 21:04:30 -0500] dysinger: :D
[2012-11-16 21:05:19 -0500] miah: =)
[2012-11-16 21:05:32 -0500] dysinger: darnit nathenharvey beat me to it
[2012-11-16 21:05:47 -0500] miah: yup
[2012-11-16 21:07:16 -0500] ranjibd: PJ__, what error you are getting
[2012-11-16 21:10:02 -0500] PJ__: ranjibd, thanks but... I gave up. It looks like with this (super) old version of Chef this command simply does not work (I ended up copying the docs - no success). But again thanks a lot.
[2012-11-16 21:11:26 -0500] ranjibd: PJ__, you can use execute if nothing works, execute "gem install <path to .gem>" with a not_if guard
[2012-11-16 21:13:19 -0500] PJ__: ranjibd: even that failed... with this weird message: /usr/local/ey_resin/ruby/lib/ruby/gems/1.8/gems/chef-0.6.0.2/lib/chef/mixin/params_validate.rb:125:in `_pv_equal_to': Option action must be equal to one of: nothing, run!  You passed :install. (ArgumentError)
[2012-11-16 21:14:26 -0500] ranjibd: PJ__,  set action :run
[2012-11-16 21:14:42 -0500] ranjibd: execute does not take :install
[2012-11-16 21:16:08 -0500] PJ__: ranjibd: Oh... what was I thinking!! I missed it. Thank you so much.
[2012-11-16 21:21:23 -0500] ekristen: does anyone use chef to update their servers, like yum upgrade or apt-get upgrade?
[2012-11-16 21:28:29 -0500] kessle10: Is it possible to use node attributes in an Ohai plugin?
[2012-11-16 21:30:11 -0500] ranjibd: kessle10, yes you can
[2012-11-16 21:33:28 -0500] ranjibd: kessle10, you can use query chef from any ruby script, just invoke Chef::Config.from_file('/etc/chef/client.rb')
[2012-11-16 21:33:48 -0500] ranjibd: and load the node you want.. the only gotcha is. it might slow down the ohai run
[2012-11-16 21:35:58 -0500] lazyPower: I'm having a problem bootstrapping my first node with hosted chef. i'm getting an odd dpkg error stating that i requires superuser privledges.  Log output is here: https://gist.github.com/a4e69e0fd5c81429e292
[2012-11-16 21:36:47 -0500] Mithrandir: well, are you root on the machine in question?
[2012-11-16 21:37:17 -0500] lazyPower: hmm.. no. i would have thought it executes commands that need root perms via sudo?
[2012-11-16 21:37:46 -0500] Mithrandir: when you run knife bootstrap you need to pass --sudo, iirc
[2012-11-16 21:38:23 -0500] lazyPower: oh wow, derp
[2012-11-16 21:38:24 -0500] knuckolls: lazyPower: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap.rb
[2012-11-16 21:38:28 -0500] lazyPower: Thank you Mithrandr
[2012-11-16 21:38:34 -0500] knuckolls: to see exactly how it works
[2012-11-16 21:40:12 -0500] lee__: does anyone familiar with the deploy resource know if "copy_exclude" actually does anything?
[2012-11-16 21:40:39 -0500] lee__: i want to exclude my .git directory, but looking through the source code i don't see that copy_exclude actually does anything
[2012-11-16 21:51:20 -0500] poolpog: hi. I am experiencing a race condition which confuses me...
[2012-11-16 21:52:10 -0500] poolpog: I have a cookbook_file that is a shell script that does something; I call it using %x() further down in the recipe, but on first run, the %x() call runs before the cookbook_file is copied into its place
[2012-11-16 21:52:28 -0500] poolpog: can anyone explain this behavior and how I can resolve it?
[2012-11-16 21:59:34 -0500] knuckolls: poolpog: likely the difference between compile time and convergence time
[2012-11-16 21:59:48 -0500] knuckolls: poolpog:http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-11-16 22:00:09 -0500] knuckolls: it should be run via an execute resource so it runs at convergence time
[2012-11-16 22:00:19 -0500] knuckolls: or via the script resource
[2012-11-16 22:00:46 -0500] poolpog: ok, and ok. thanks
[2012-11-16 22:14:07 -0500] ekristen: is there any way to do per environment files?
[2012-11-16 22:14:11 -0500] ekristen: for a cookbook?
[2012-11-16 22:22:02 -0500] bemu: ekristen: Elaborate please?
[2012-11-16 22:23:01 -0500] ekristen: as in I want to change out certain cookbook files per env, I guess I could just check in the recipe huh
[2012-11-16 22:24:08 -0500] bemu: That's what I do.
[2012-11-16 22:24:34 -0500] yfeldblum: ekristen, yeah ... recipes let you do this magical thing called "whatever ruby code you like" :D
[2012-11-16 22:24:54 -0500] helllen: helllo
[2012-11-16 22:25:09 -0500] helllen: how could I send binary file using chef template ?
[2012-11-16 22:25:36 -0500] helllen: cookbook sorry
[2012-11-16 22:25:56 -0500] bemu: cookbook_file resource
[2012-11-16 22:27:26 -0500] helllen: thanks
[2012-11-16 22:27:44 -0500] bemu: np
[2012-11-16 22:28:04 -0500] unixbender: question: is anyone aware of a condition that causes a chef client run to fail if the server adjusts its time backwards by .6 seconds?
[2012-11-16 22:28:28 -0500] helllen: bemu, this must be included at recipe ?
[2012-11-16 22:29:40 -0500] bemu: helllen: You would call it in your recipe or an lwrp probably.
[2012-11-16 22:30:01 -0500] helllen: the best place ?
[2012-11-16 22:30:24 -0500] yfeldblum: helllen, recipe
[2012-11-16 22:30:31 -0500] helllen: thanks
[2012-11-16 22:30:31 -0500] helllen: +
[2012-11-16 22:31:07 -0500] bemu: Yeah, judging by your question, definitely the recipe.
[2012-11-16 22:31:23 -0500] helllen: really thanks
[2012-11-16 22:32:23 -0500] helllen: and one simp question
[2012-11-16 22:32:46 -0500] helllen: is the file sended every time or it check if it has changed
[2012-11-16 22:32:54 -0500] helllen: ?
[2012-11-16 22:33:04 -0500] helllen: I mean before send the file
[2012-11-16 22:35:38 -0500] yfeldblum: helllen, checked
[2012-11-16 22:35:47 -0500] helllen: cool
[2012-11-16 22:36:06 -0500] helllen: could I execute action if it changes
[2012-11-16 22:36:12 -0500] helllen: I mean reload service
[2012-11-16 22:36:17 -0500] helllen: for example
[2012-11-16 22:36:25 -0500] yfeldblum: helllen, but putting large binary files in git or in a cookbook is typically not the best idea
[2012-11-16 22:36:28 -0500] yfeldblum: helllen, yes you could
[2012-11-16 22:36:31 -0500] unixbender: has anyone here ever ran into issues with time offsets on chef client/server or time shifts causing chef to break?  (less than 1 second)
[2012-11-16 22:37:07 -0500] helllen: it is 1MB
[2012-11-16 22:37:10 -0500] helllen: only
[2012-11-16 22:37:13 -0500] helllen: is it ok ?
[2012-11-16 22:37:36 -0500] yfeldblum: helllen, you're allowed to do it but it's non-ideal ... many people put these types of files on S3 or on a shared filesystem or something
[2012-11-16 22:37:49 -0500] helllen: ok
[2012-11-16 22:38:48 -0500] helllen: I will
[2012-11-16 22:39:18 -0500] helllen: the problem is the file change many times so I would have to upload the cookbook al time
[2012-11-16 22:39:29 -0500] helllen: I prefer use other way
[2012-11-16 23:27:02 -0500] lamont_: happy friday folks
[2012-11-16 23:28:22 -0500] pwelch: lamont_: happy frida
[2012-11-16 23:28:27 -0500] pwelch: *friday
[2012-11-16 23:36:24 -0500] lamont_: I was wondering if someone could point me towards getting better information out of the chef server server.log about which client key performed a cookbook upload
[2012-11-16 23:36:52 -0500] lamont_: I'm running community chef server 10.10, although I went through the change logs up to 10.16 and didn't see anything on this issue
[2012-11-16 23:37:41 -0500] lamont_: my problem seems to be that the only thing logged in the params with the request look like the following
[2012-11-16 23:37:43 -0500] lamont_: @auth_credentials=#<Chef::REST::AuthCredentials:0x7f85be62c6e0 @key_file=nil, @client_name=nil>
[2012-11-16 23:39:45 -0500] ranjibd: lamont_, i tried that in past.. with no luck
[2012-11-16 23:39:54 -0500] lamont_: alas
[2012-11-16 23:40:18 -0500] ranjibd: lamont_, you will be better off with using a knife workflow plugin
[2012-11-16 23:40:44 -0500] lamont_: yeah, we have a jenkins job that pushes from source control, but there's the occasional rogue knife that I'd like to log
[2012-11-16 23:41:45 -0500] lamont_: I've gone through the chef server code, but my ruby isn't strong enough to understand how its logging
[2012-11-16 23:45:24 -0500] ranjibd: lamont_, knife-santoku https://github.com/knuckolls/knife-santoku/
[2012-11-16 23:51:52 -0500] lamont_: ranjibd, that's very nice, but relies on everyone using that plugin
[2012-11-16 23:53:01 -0500] lamont_: since the server has the actual information and all I want is to get it to properly log the name of the client that did the change
