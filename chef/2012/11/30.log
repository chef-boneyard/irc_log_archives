[2012-11-30 00:00:37 -0500] tolland: so I am thinking something like showing a cofirm prompt if you clobber over a newer version, or somesuch
[2012-11-30 00:02:11 -0500] cwj: if you are trying to shell script your way around this, why not use git ls-remote to figure out if theres something new?
[2012-11-30 00:02:31 -0500] cwj: i guess i dont fully understand your use case
[2012-11-30 00:02:37 -0500] tolland: so I am going to create a local cache of files keyed on their checksum, does that sound loony?
[2012-11-30 00:02:45 -0500] tolland: cwj: ah, ok
[2012-11-30 00:02:59 -0500] tolland: so we have some developers, some are by title only
[2012-11-30 00:03:25 -0500] tolland: one guy uploaded a really old cookbook to prod and blatted the live one
[2012-11-30 00:04:18 -0500] tolland: feeling the need to be proactive about preventing further incidents,  I am thinking that some sort of "training wheels" wrapper for knife-cookbook to force a prompt to over write a newer
[2012-11-30 00:05:01 -0500] tolland: really, if its doens't work in 30 mins I give up, but I had seen lots of cache and checksums folders and was thinking that there might be some local cache to diff against
[2012-11-30 00:05:06 -0500] cwj: are you aware that the server can freeze a cookbook version?
[2012-11-30 00:05:17 -0500] cwj: prevent that scenario
[2012-11-30 00:06:23 -0500] tolland: so this was just for a dev box, for a demo, so it would be easier to do this... well I am interested in the local file cache so I have an ulterior motive to look at this
[2012-11-30 00:06:32 -0500] tolland: just poking my toe etc
[2012-11-30 00:07:31 -0500] tolland: so yes, I am aware of freezing, but id like a local diff of the change
[2012-11-30 00:07:57 -0500] tolland: now the workflow (if you are not sure) is to download the server copy, and local diff it manually
[2012-11-30 00:10:51 -0500] newb: oh well, I need to understand how this line works: https://github.com/infochimps-labs/ironfan-pantry/blob/master/cookbooks/flume/recipes/install_from_release.rb#L28
[2012-11-30 00:11:03 -0500] newb: is it calling itself?
[2012-11-30 00:13:16 -0500] newb: no
[2012-11-30 00:16:42 -0500] tolland: is there an opscode roadmap doc with up and coming features? or something similar for knife plugins?
[2012-11-30 00:17:07 -0500] julian_: Can anyone tell me how to install a gem from source?  I Want to install this: https://github.com/kisoku/chef-handler-mail/blob/master/README.md
[2012-11-30 00:17:17 -0500] julian_: All I have is the source file that is linked from that page.
[2012-11-30 00:20:19 -0500] erikh: newb: this is where it comes from
[2012-11-30 00:20:21 -0500] erikh: https://github.com/infochimps-labs/ironfan-pantry/blob/master/cookbooks/install_from/resources/release.rb
[2012-11-30 00:20:29 -0500] erikh: was kind of hard to find, it's not listed as a direct dependency.
[2012-11-30 00:21:23 -0500] newb: erikh, thanks I fugured that out, that's why I said 'no' to myself :-D THanks though - it would be wonderful if you could confirm this  though:
[2012-11-30 00:21:34 -0500] newb: I think https://github.com/infochimps-labs/ironfan-pantry/blob/master/cookbooks/flume/recipes/install_from_git.rb#L56 conflicts with https://github.com/infochimps-labs/ironfan-pantry/blob/master/cookbooks/flume/recipes/install_from_git.rb#L65
[2012-11-30 00:22:30 -0500] erikh: it does indeed look that way
[2012-11-30 00:22:38 -0500] erikh: but I'd still test to be sure
[2012-11-30 00:27:07 -0500] silentrob: Im getting a new error: Your chef_server_url may be misconfigured, or the network could be down.
[2012-11-30 00:27:17 -0500] silentrob: everything was working yesterday
[2012-11-30 00:33:32 -0500] jwcarman: In a real environment, do folks use separate chef servers for the different environments (prod, staging, q/a, etc.) or do they use chef "environments"?
[2012-11-30 00:38:13 -0500] tolland: ah, so knife-essentials is pretty cook, and has diff functionality
[2012-11-30 00:38:14 -0500] tolland: nice
[2012-11-30 00:38:17 -0500] bluepojo: they used to before environments existed
[2012-11-30 00:38:21 -0500] bluepojo: now many people use environments
[2012-11-30 00:38:29 -0500] bluepojo: jwcarman:
[2012-11-30 00:38:42 -0500] bluepojo: IMO, environments are vastly superior
[2012-11-30 00:38:45 -0500] erikh: I still use separate chef servers
[2012-11-30 00:39:02 -0500] bluepojo: but you have to properly version everything if you use environments
[2012-11-30 00:39:06 -0500] bluepojo: and ensure you version lock
[2012-11-30 00:39:14 -0500] erikh: environments are a nice way to override attributes, but are a pretty lousy source control tool
[2012-11-30 00:39:33 -0500] bluepojo: agreed, I keep all my environment data in source control and upload it via a CI job
[2012-11-30 00:39:44 -0500] erikh: so in other words, your environments solve nothing
[2012-11-30 00:39:56 -0500] erikh: :P
[2012-11-30 00:41:06 -0500] bluepojo: environments are great as it keeps you from having to manage cookbooks across multiple servers
[2012-11-30 00:41:25 -0500] jwcarman: so, can I control what version of cookbooks go in each environment?
[2012-11-30 00:41:31 -0500] bluepojo: yep
[2012-11-30 00:41:42 -0500] bluepojo: version locks are part of the environment data
[2012-11-30 00:41:44 -0500] jwcarman: I can't find that on the wiki.  How do I do that?
[2012-11-30 00:41:50 -0500] bluepojo: there's a key called cookbook_versions
[2012-11-30 00:41:56 -0500] bluepojo: and you can specify which versions are used in that environment
[2012-11-30 00:42:11 -0500] jwcarman: is there some example somewhere?
[2012-11-30 00:43:22 -0500] bluepojo: http://wiki.opscode.com/display/chef/Environments
[2012-11-30 00:43:29 -0500] bluepojo: it's in both the JSON and the DLS sections
[2012-11-30 00:44:42 -0500] jwcarman: ok I was looking here: http://docs.opscode.com/essentials_environments.html
[2012-11-30 00:45:58 -0500] jwcarman: where do you specify the version numbers for your cookbooks?
[2012-11-30 00:46:08 -0500] jwcarman: I mean when do the cookbooks get assigned version numbers?
[2012-11-30 00:50:45 -0500] miah: in the metadata.rb
[2012-11-30 01:20:59 -0500] julian_: Is it possible to install gems from the client.rb file?
[2012-11-30 01:21:23 -0500] julian_: for use with handlers to be initiated from the client.rb?
[2012-11-30 02:07:10 -0500] cheflevelramen: Hi guys. Quick question. I'm trying to create a cookbook to manage /etc/hosts files, and I'd like to dynamically set the hostname of the machine to match that of the chef client. Is there a way to get the shef client name in a cookbook (sorry, new to all this)
[2012-11-30 02:09:05 -0500] cheeseplus: cheflevelramen: node[:hostname]
[2012-11-30 02:10:32 -0500] cheflevelramen: That gets me the aws set hostname
[2012-11-30 02:10:53 -0500] cheeseplus: you might take a look at this: http://powdahound.com/2010/07/dynamic-hosts-file-using-chef
[2012-11-30 02:11:07 -0500] cheflevelramen: basically, when I use knife, I set the chef-client name, and that is the same name I want to name the machine. Is there a way to access that variable from outside of knife?
[2012-11-30 02:11:21 -0500] cheflevelramen: cheeseplus: Thanks, I'll look now
[2012-11-30 02:14:32 -0500] jtimberman: cheeseplus: OHAI
[2012-11-30 02:14:44 -0500] cheflevelramen: cheeseplus: Interesting. Unfortunately I'm implementing chef in an already established environment, so I'll need to keep the current host naming convention.
[2012-11-30 02:14:52 -0500] cheeseplus: jtimberman: discussion on different mediums!
[2012-11-30 02:15:05 -0500] jtimberman: cheeseplus: meta
[2012-11-30 02:15:23 -0500] cheflevelramen: Doing this:
[2012-11-30 02:15:23 -0500] cheflevelramen: chef > node.default.each do |attr|
[2012-11-30 02:15:24 -0500] cheflevelramen: chef > puts attr
[2012-11-30 02:15:24 -0500] cheflevelramen: chef ?> end
[2012-11-30 02:15:49 -0500] cheflevelramen: Gives me the list of node attributes, but I don't see the chef client name
[2012-11-30 02:15:57 -0500] cheflevelramen: Any other way to get this information from OHAI?
[2012-11-30 02:17:41 -0500] jtimberman: cheflevelramen: the node name is node.name
[2012-11-30 02:17:48 -0500] jtimberman: thats the name used for the chef client
[2012-11-30 02:18:15 -0500] jtimberman: that isn't an attribute, btw.
[2012-11-30 02:20:03 -0500] cheeseplus: jtimberman: good to know
[2012-11-30 02:20:26 -0500] cheeseplus: hrm, knife node list gives me ERROR: EOFError: end of file reached
[2012-11-30 02:20:38 -0500] cheflevelramen: Oh? maybe I misunderstand. Well, that node name seems to the domU-123-45-67-89-FF.compute-1.internal name. So maybe I'm asking the wrong question. Is there a way to set the node name with knife at startup
[2012-11-30 02:21:55 -0500] cheflevelramen: NM, answered my question:
[2012-11-30 02:21:55 -0500] cheflevelramen:     -N, --node-name NAME             The Chef node name for your new node
[2012-11-30 02:22:07 -0500] cheflevelramen: Thanks guys, I think I can make this work now
[2012-11-30 03:08:04 -0500] dyer: question, when using Chef-Solo should the only cookbook that is actually loaded be the one in the run list ?  ( {"run_list": "recipe[ipaddress_test]"} ) ?
[2012-11-30 03:09:40 -0500] dyer: I am trying to put together a test case for a a suspected bug, and have put together a small test case recipe and when I am loading it I noticed some other cookbooks being loaded in the compile phase ( eg nagios & mysql )
[2012-11-30 03:32:47 -0500] jtimberman: dyer: are those cookbooks in the cookbook_path?
[2012-11-30 03:32:53 -0500] dyer: yes
[2012-11-30 03:38:37 -0500] dyer: so cookbooks in the path are always loaded even if the recipe in the run_list has no dependency on anything other then itself ?
[2012-11-30 03:45:03 -0500] dyer: ?
[2012-11-30 03:50:58 -0500] jtimberman: dyer: yes
[2012-11-30 03:51:03 -0500] cschneid: Chef is really good at managing the actual setup of a server, but how do people normally tie in other web service calls (ie, "add this to a AWS Load Balancer" web service call) or "Email Bob that a new server got spun up".
[2012-11-30 03:51:11 -0500] cschneid: do ya'll write knife plugins, or external scripts that in turn call knife?
[2012-11-30 03:51:19 -0500] jtimberman: all the cookbooks in the cookbooks path are loaded. only the ones that appear in the expanded run list actually execute anything on the node.
[2012-11-30 03:51:20 -0500] dyer: So even things like the attributes are loaded?
[2012-11-30 03:51:29 -0500] jtimberman: unless you have a really poorly behaving library of course :)
[2012-11-30 03:51:31 -0500] jtimberman: yes
[2012-11-30 03:51:35 -0500] dyer: wow, thats shitty
[2012-11-30 03:51:38 -0500] jtimberman: why?
[2012-11-30 03:51:45 -0500] jtimberman: chef doesn't know
[2012-11-30 03:51:54 -0500] dyer: I would think it would load the attributes from the run_ist
[2012-11-30 03:51:58 -0500] jtimberman: that is, chef-solo doesn't know
[2012-11-30 03:52:27 -0500] jtimberman: since you have to put all the cookbooks there so chef-solo has them, since it doesn't do any retrieval based on the run list or dependencies.
[2012-11-30 03:52:33 -0500] jtimberman: chef-client loads them all too
[2012-11-30 03:53:09 -0500] jtimberman: but chef-client gets what it needs from the run list and dependencies from the server.
[2012-11-30 03:53:36 -0500] jtimberman: i mean, you might have a dependency on another cookbook because you need an attribute that it provides. or a library.
[2012-11-30 03:55:12 -0500] dyer: Hrm, ok well I'll have to noodle this
[2012-11-30 03:55:28 -0500] dyer: thanks for your explanation
[2012-11-30 03:56:07 -0500] jtimberman: Sure thing
[2012-11-30 04:08:04 -0500] jtimberman: http://jtimberman.housepub.org/blog/2012/11/29/some-knife-plugins/
[2012-11-30 05:39:35 -0500] jtimberman: dyer: this may be of interest to you btw, https://github.com/opscode/chef/pull/508
[2012-11-30 05:41:25 -0500] yleon: Hello all! I am setting up chef and have two general, perhaps silly questions: 1). How do all of you ensure that your git master is in perfect sync with your chef server?  I am concerned that they could get drastically out of sync. 2). Is there are bootrapper (it will of course use knife bootstrap behind the scenes) utility that takes 1 to N servers (or a file with server names) as input and  reads server authentication info from a databa
[2012-11-30 07:02:10 -0500] spedl: did I hear someone say they were good with fixing mysql setup problems?
[2012-11-30 07:02:12 -0500] spedl: http://i.imgur.com/wUNBl.gif
[2012-11-30 07:51:53 -0500] ssd7: I like the new docs, but man do they take a while to build sometimes.
[2012-11-30 08:38:19 -0500] Houdini: Why: Cannot find a resource for action_restart on ubuntu version 12.04, this is log: https://gist.github.com/4174544
[2012-11-30 10:31:31 -0500] m4rcu5: is there a way to make chef ignore all cookbooks which are not specificly mentioned in the environment.json? so you cannot accidentally run a development cookbook on a production machine?
[2012-11-30 10:32:05 -0500] jonlives: m4rcu5: not out of the box, no...any cookbooks not mention will be treated as unconstrained
[2012-11-30 10:32:30 -0500] m4rcu5: jonlives: thats scary :)
[2012-11-30 10:33:10 -0500] jonlives: m4rcu5: chef doesn't constrain what you can do too much by default.
[2012-11-30 10:33:14 -0500] jonlives: nor imho should it.
[2012-11-30 10:34:27 -0500] jonlives: environments aren't a run_list.
[2012-11-30 10:34:42 -0500] m4rcu5: jonlives: but wouldn't it make sense that you don't want any cookbooks running loose on your production env without being pinned ?
[2012-11-30 10:35:43 -0500] jonlives: m4rcu5: that's why we only add recipes to servers by using roles, which are in version control etc.
[2012-11-30 10:36:20 -0500] jonlives: it partly comes down to having sensible procedures.
[2012-11-30 10:37:02 -0500] m4rcu5: jonlives: yep thats correct, but i use a recipe in 2 environments, but with different version constraints
[2012-11-30 10:37:13 -0500] m4rcu5: or what is your sensible procedure?
[2012-11-30 10:37:27 -0500] jonlives: m4rcu5: I'd say that's a dangerous way to do it. why not two recipes under the cookbook, one for prod, one for dev?
[2012-11-30 10:37:46 -0500] jonlives: have the dev one include the prod recipe and add the dev specific stuff, for example.
[2012-11-30 10:40:07 -0500] m4rcu5: jonlives: that would make it more secure, but doubles your work on all changes to roles
[2012-11-30 10:40:38 -0500] UukGoblin: http://pastebin.com/BwVZuQSq <- what am I doing wrong?
[2012-11-30 10:40:39 -0500] jonlives: m4rcu5: it also makes it a lot less likely to accidentally bump a constraint in the wrong place.
[2012-11-30 10:40:58 -0500] jonlives: imho dev should be identical to prod, plus debugging tools  / dev specific stuff
[2012-11-30 10:41:30 -0500] m4rcu5: jonlives: i agree on that, thats why i use the same roles
[2012-11-30 10:42:02 -0500] jonlives: m4rcu5: what we do is *not* use the same roles, but have the dev role inherit from prod and then have any extra dev recipes.
[2012-11-30 10:42:17 -0500] jonlives: same constraints in both environments.
[2012-11-30 10:43:51 -0500] m4rcu5: jonlives: inherit? i think im missing out :) and if you want to add a new cookboko to a production server, you add it first in your dev role?
[2012-11-30 10:44:08 -0500] jonlives: so the runlist of the dev role is the prod role, plus dev recipes :)
[2012-11-30 10:44:32 -0500] jonlives: m4rcu5: cookbook testing would usually be done on a single node before being rolled out to everything
[2012-11-30 10:51:41 -0500] m4rcu5: jonlives: how are you inheriting the roles?
[2012-11-30 10:52:01 -0500] jonlives: m4rcu5: just include the prod role in the runlist of the dev role
[2012-11-30 10:53:04 -0500] jonlives: ie instead of recipe[foo], recipe[bar] we'd have role[ProdRole], recipe[dev::stuff]
[2012-11-30 10:55:26 -0500] odyssey4me: I have a chef recipe which is installing a gem package, but the client that's running the recipe is not online so it can't fetch it from the online source. I have an internal gem repo which I want to direct the client to.
[2012-11-30 10:56:09 -0500] m4rcu5: jonlives: thanks!
[2012-11-30 10:56:18 -0500] jonlives: m4rcu5: np :)
[2012-11-30 10:56:25 -0500] odyssey4me: on the client itself I've removed the online (default) gem source and added the local repo source... but I still get the following error when the recipe runs
[2012-11-30 10:56:26 -0500] odyssey4me: failed to find gem mysql (>= 0) from [http://rubygems.org/]
[2012-11-30 10:57:05 -0500] odyssey4me: so it appears that the chef-client is not observing the local rubygem settings?
[2012-11-30 10:58:14 -0500] odyssey4me: it appears that there is a gem_sources object... so how do I add a source to that object? http://rubydoc.info/gems/chef/Chef/Provider/Package/Rubygems#gem_sources-instance_method
[2012-11-30 10:58:47 -0500] odyssey4me: (within a recipe, of course)
[2012-11-30 10:59:27 -0500] odyssey4me: alternatively, how do I set/override the default gem_sources object on the chef server?
[2012-11-30 10:59:28 -0500] m4rcu5: btw, what ever happened to the apt bootstrap files? we now only have ubuntu-12.04-gems, no apt version anymore? :(
[2012-11-30 10:59:36 -0500] odyssey4me: (I'm using the open source chef server)
[2012-11-30 11:02:48 -0500] jonlives: odyssey4me: chef uses the rubygems gem to find sources, does your local source show if you run ruby -r rubygems -e "p Gem.sources"
[2012-11-30 11:02:49 -0500] jonlives: ?
[2012-11-30 11:03:36 -0500] odyssey4me: aha, it shows the online source not the local one
[2012-11-30 11:03:41 -0500] odyssey4me: how do I change that one?
[2012-11-30 11:04:42 -0500] jonlives: odyssey4me: did you run gem sources --add http://yourgemsource
[2012-11-30 11:05:11 -0500] odyssey4me: I did run: gem sources -a http://localsource
[2012-11-30 11:05:17 -0500] odyssey4me: which I guess is equivalent
[2012-11-30 11:05:51 -0500] odyssey4me: yes, confirmed to be equivalent
[2012-11-30 11:06:10 -0500] odyssey4me: gem sources -l also shows the local source
[2012-11-30 11:07:15 -0500] jonlives: using rvm or anything?
[2012-11-30 11:07:49 -0500] odyssey4me: nope - running on a standard ubuntu 12.04 lts server
[2012-11-30 11:08:03 -0500] odyssey4me: ruby & rubygems was installed via apt
[2012-11-30 11:08:59 -0500] jonlives: lemme see
[2012-11-30 11:09:06 -0500] jonlives: i can replicate what you're seeing
[2012-11-30 11:10:10 -0500] dkannan: can someone tag https://github.com/opscode-cookbooks/git
[2012-11-30 11:10:23 -0500] dkannan: it does not have a tag for release 2.0
[2012-11-30 11:13:42 -0500] odyssey4me: jonlives - awesome, any thoughts on how I can sort this out?
[2012-11-30 11:13:56 -0500] jonlives: odyssey4me: just looking at it now :)
[2012-11-30 11:14:45 -0500] PierreO: Hi guys, I'm trying to ccok a chef-server, but it seems http://pgpkeys.mit.edu/ is down
[2012-11-30 11:16:44 -0500] m4rcu5: PierreO: try keyserver.ubuntu.com
[2012-11-30 11:16:49 -0500] m4rcu5: should be an mirror
[2012-11-30 11:17:03 -0500] PierreO: ok, I'll try, thanks
[2012-11-30 11:31:41 -0500] jonlives: odyssey4me: try this: https://gist.github.com/049f745176602e99b87c
[2012-11-30 11:32:37 -0500] odyssey4me: jonlives - trying now, thanks
[2012-11-30 11:34:11 -0500] odyssey4me: johnlives - aha, you rock thank you!
[2012-11-30 11:35:09 -0500] jonlives: odyssey4me: np :)
[2012-11-30 11:44:16 -0500] odyssey4me: hmm, I need to do a not_if in the recipe that checks if the db is there before trying to create it
[2012-11-30 13:00:44 -0500] masterkorp: helo everyone
[2012-11-30 13:04:11 -0500] m4rcu5: ohai masterkorp
[2012-11-30 13:04:25 -0500] masterkorp: alright back to the icinga cookbook
[2012-11-30 13:06:21 -0500] masterkorp: https://github.com/opscode/chef/blob/master/lib/chef/resource/file.rb#L42
[2012-11-30 13:06:31 -0500] masterkorp: Can anyone explain me this line ?
[2012-11-30 13:15:27 -0500] cnf: hmz, why aren't those directory creation parts triggering...
[2012-11-30 13:17:15 -0500] yfeldblum: masterkorp, http://www.rubycentral.com/pickaxe/tut_classes.html
[2012-11-30 13:18:23 -0500] cnf: i can't even see it beeing skipped in debug
[2012-11-30 13:18:25 -0500] cnf: weird...
[2012-11-30 13:18:58 -0500] cnf: oh, nm me, stupid, stupid...
[2012-11-30 13:19:04 -0500] masterkorp: yfeldblum: so super, is the parent class constructor ?
[2012-11-30 13:19:59 -0500] yfeldblum: masterkorp, in *this* case, yes, super invokes the method Chef::Resource#initialize
[2012-11-30 13:20:20 -0500] yfeldblum: masterkorp, passing the same arguments that Chef::Resource::File#initialize was passed
[2012-11-30 13:21:56 -0500] masterkorp: yfeldblum: wait "super" without args passes *all* the args from the previous constructor ?
[2012-11-30 13:22:10 -0500] masterkorp: if so, that makes a hell of a diference !
[2012-11-30 13:23:36 -0500] yfeldblum: masterkorp, in *this* case, yes, but not always
[2012-11-30 13:24:19 -0500] masterkorp: ruby can be so weird to read sometimes with these syntax sugars
[2012-11-30 13:24:29 -0500] masterkorp: but i got it, thank you sir
[2012-11-30 13:24:36 -0500] yfeldblum: masterkorp, cheers
[2012-11-30 13:44:04 -0500] gma: is it well understood how to access encrypted data bags with chef-solo? I googled and found code snippets that no longer work. wondering if I should blog it
[2012-11-30 13:44:13 -0500] gma: (i.e. blog some code that does work)
[2012-11-30 13:49:10 -0500] masterkorp: gma: that would be nice
[2012-11-30 13:49:36 -0500] masterkorp: acessing ecrypted data bags is a question that pops here reguraly
[2012-11-30 13:49:54 -0500] gma: masterkorp: okay. probably won't be today, but I'll definitely do it.
[2012-11-30 13:50:14 -0500] gma: masterkorp: what would be even better would be docs that better address the whole chef-solo thing.
[2012-11-30 13:50:37 -0500] gma: masterkorp: I'm new to chef this week, but have found that much of the copy assumes I'm using client/server, and it's hard to tell which bits of the docs do/don't apply
[2012-11-30 13:51:04 -0500] gma: masterkorp: not sure how to go about that though, so I'll blog it!
[2012-11-30 13:51:29 -0500] masterkorp: gma: +1, good luck ! :)
[2012-11-30 13:51:41 -0500] poseid: this is a good start: http://docs.opscode.com/
[2012-11-30 13:51:58 -0500] poseid: esp. the diagram in: http://docs.opscode.com/chef_overview.html
[2012-11-30 13:52:24 -0500] gma: poseid: to a noob, I'm afraid it really isn't that useful
[2012-11-30 13:53:02 -0500] gma: it needs chef-solo specific docs. chef-solo is fairly simple to use, but to learn it you have to read about stuff that you really shouldn't need to know about
[2012-11-30 13:53:13 -0500] yfeldblum: gma, Chef::EncryptedDataBagItem.load
[2012-11-30 13:53:47 -0500] poseid: another good place to discuss is the opscode mailing list...
[2012-11-30 13:54:07 -0500] poseid: anyway, I am now making a bit of progress with knife and chef-client
[2012-11-30 13:54:15 -0500] gma: yfeldblum: I confess to not having checked the latest chef code (I'm using 0.10.0), but the `load` call makes a connection to a chef server.
[2012-11-30 13:54:22 -0500] gma: so it fails with chef-solo
[2012-11-30 13:54:38 -0500] gma: you need to pass a hash into EncryptedDataBagItem.new instead, along with a secret
[2012-11-30 13:55:12 -0500] gma: you used to be able to call .load that's what all the code I found on the net says. but if you read the class, it can't avoid making an HTTP call and finding that client.pem doesn't exist (if you're using chef-solo)
[2012-11-30 13:56:32 -0500] maruq: hi guys
[2012-11-30 13:56:44 -0500] yfeldblum: gma, data-bag support is added to chef-solo in a later version
[2012-11-30 13:56:47 -0500] yfeldblum: gma, https://github.com/opscode/chef/blob/10.16.2/chef/lib/chef/data_bag_item.rb#L192-L194
[2012-11-30 13:56:52 -0500] maruq: can anyone advise as on the environments workflow, when working with files?
[2012-11-30 13:56:57 -0500] gma: yfeldblum: oh tits. :-)
[2012-11-30 13:57:03 -0500] gma: yfeldblum: saves me a blog post though, ta
[2012-11-30 13:57:30 -0500] yfeldblum: gma, only direct fetches by name though - chef-solo does not support any kind of search for data-bag items
[2012-11-30 13:57:31 -0500] maruq: it seems that every time I "knife environment from file production.rb", it wipes out all the cookbook locks
[2012-11-30 13:57:49 -0500] gma: yfeldblum: that's okay, I'm doing fairly small scale stuff here.
[2012-11-30 13:57:56 -0500] maruq: I can try and specify things in that file, but it just ignores & wipes it all out
[2012-11-30 14:00:02 -0500] yfeldblum: gma, "small scale" is just the past tense of "large scale" :D
[2012-11-30 14:04:11 -0500] maruq: nevermind, I'm an idiot
[2012-11-30 14:05:51 -0500] gma: yfeldblum: if I make any money from this product, yeah. if not, time stops moving forward
[2012-11-30 15:24:08 -0500] pattersonc: i'm having an issue getting bundler installed for ruby 1.9 using the application_ruby LWRP. any suggestions?
[2012-11-30 15:28:27 -0500] pattersonc: crabs
[2012-11-30 15:30:01 -0500] PierreO: pattersonc : What is your issue?
[2012-11-30 15:32:02 -0500] pattersonc: so I specify bundler in the gems attrib. bundle install runs later  and install  gems for 1.8
[2012-11-30 15:32:02 -0500] PierreO: pattersonc : is it during the install or after?
[2012-11-30 15:32:37 -0500] PierreO: pattersonc do you use chef client or chef-solo ?
[2012-11-30 15:32:44 -0500] pattersonc: chef solo
[2012-11-30 15:32:56 -0500] pattersonc: testing via vagrant right now
[2012-11-30 15:33:07 -0500] PierreO: pattersonc : do you use rbenv ?
[2012-11-30 15:33:23 -0500] pattersonc: no. no rvm or rbenv
[2012-11-30 15:33:42 -0500] PierreO: pattersonc : I'll check something
[2012-11-30 15:34:57 -0500] PierreO: pattersonc : how do you know there are for 1.8 ?
[2012-11-30 15:36:04 -0500] pattersonc: pierreo: I get this as the cause of the failure - bundle exec rake db:migrate returned 1, expected 0
[2012-11-30 15:36:15 -0500] pattersonc: so I tried to run the cmd via ssh
[2012-11-30 15:36:39 -0500] pattersonc: and it tells me the gemspecs are invalid (invalid timestamps I think).
[2012-11-30 15:37:21 -0500] pattersonc: so I look in the vender directory and there is a 1.8 folder
[2012-11-30 15:37:36 -0500] pattersonc: where the bundle was installed
[2012-11-30 15:38:01 -0500] PierreO: hmm.. For me there are 2 reasons of a bundle fail - either a path issue - or a user messed
[2012-11-30 15:38:15 -0500] PierreO: I think I already saw that, and it was not an issue for me..
[2012-11-30 15:38:36 -0500] PierreO: (i tried to check for it, don't remember which server..)
[2012-11-30 15:38:43 -0500] pattersonc: I think  I may have found a work around
[2012-11-30 15:39:17 -0500] PierreO: which gemspecs are invalid?
[2012-11-30 15:39:17 -0500] pattersonc: instead of installing bundler via application_ruby, i'm going to try to install it via gem_package and specify the gem_binary
[2012-11-30 15:39:33 -0500] PierreO: yes, you can try
[2012-11-30 15:39:37 -0500] pattersonc: it was saying rake was invalid
[2012-11-30 15:39:49 -0500] PierreO: ok..You can even try as a bash command
[2012-11-30 15:40:06 -0500] PierreO: Sorry that I didn't help much..
[2012-11-30 15:42:00 -0500] pattersonc: np. let me see if this helps.
[2012-11-30 15:44:14 -0500] jblaine: the application cookbook should be named webapp or similar
[2012-11-30 15:44:42 -0500] jblaine: "This cookbook is designed to be able to describe and deploy web applications."
[2012-11-30 15:44:54 -0500] jblaine: Naming is important.
[2012-11-30 15:45:50 -0500] z: jblaine: I just invoke `uuid` and use that to name my cookbook usually.
[2012-11-30 15:45:57 -0500] z: jblaine: I find its more scalable in a flat namespace.
[2012-11-30 16:28:08 -0500] CharlieSu: Does knife support spot instanceS?
[2012-11-30 16:28:33 -0500] z: CharlieSu: Not to my knowledge.
[2012-11-30 16:36:34 -0500] PierreO: Do you know if it is plan to have a "recipes in a repository" feature?
[2012-11-30 16:37:05 -0500] PierreO: to handle them like a gem with the dependencies?
[2012-11-30 16:38:10 -0500] z: PierreO: thats already done, see https://github.com/opscode-cookbooks and things like Berkshelf
[2012-11-30 16:40:12 -0500] CharlieSu: z: boo..  ok. hopefully soon.
[2012-11-30 16:47:45 -0500] PierreO: Does it parses metadata to install cookbook dependencies ?
[2012-11-30 16:47:58 -0500] z: PierreO: Berkshelf?
[2012-11-30 16:48:00 -0500] yfeldblum: PierreO, yes, as does librarian-chef
[2012-11-30 16:48:20 -0500] PierreO: ok, I'm trying it , thanks for the tip :)
[2012-11-30 16:49:06 -0500] makmanalp: jtimberman: what say you if I add more attributes to the supervisord cookbook?
[2012-11-30 16:49:49 -0500] z: makmanalp: are they useful attributes
[2012-11-30 16:51:40 -0500] makmanalp: z: what does that even mean?
[2012-11-30 16:51:57 -0500] makmanalp: z: anything that's in the config that's not configurable by attributes is "missing" by definition
[2012-11-30 16:53:10 -0500] makmanalp: z: i was looking at the sock and pidfiles specifically
[2012-11-30 16:55:39 -0500] makmanalp: in hindsight, judging by the unanswered pull requests, maybe I shouldn't bother :S
[2012-11-30 16:56:10 -0500] mattray: makmanalp: there's a hack day for COOK tickets today
[2012-11-30 16:56:27 -0500] mattray: so if you have PRs with tickets, they may get to them today
[2012-11-30 16:56:39 -0500] z: and PRs without tickets don't really go anywhere
[2012-11-30 16:56:44 -0500] z: is my general experience
[2012-11-30 16:56:49 -0500] makmanalp: ah, I see now.
[2012-11-30 16:57:03 -0500] makmanalp: mattray: cool, thanks!
[2012-11-30 16:57:37 -0500] mattray: next time someone complains about the CLA and PRs, http://www.infoworld.com/d/open-source-software/github-needs-take-open-source-seriously-208046
[2012-11-30 16:58:13 -0500] mattray: I hadn't heard about Oracle suing SAP
[2012-11-30 16:59:24 -0500] makmanalp: mattray: I like how google code forces you to declare a license
[2012-11-30 16:59:49 -0500] c_t: haven't read the article, but the columnist has a somewhat majestic Unix beard
[2012-11-30 16:59:57 -0500] c_t: so I guess I'll take him somewhat seriously
[2012-11-30 17:00:04 -0500] mattray: c_t: lol
[2012-11-30 17:00:26 -0500] makmanalp: c_t: and the column name is a pun on open source, "open sources"
[2012-11-30 17:00:36 -0500] c_t: oh gawd, so it is
[2012-11-30 17:00:51 -0500] c_t: still, it's not ESR, so that's also a point in that guy's favor
[2012-11-30 17:01:03 -0500] c_t: of course that's a point in nearly everyone's favor
[2012-11-30 17:01:40 -0500] z: I don't really see how failure to include a LICENSE file is GitHub's fault
[2012-11-30 17:02:20 -0500] erikh: I don't either, but opscode is definitely dealing with the issue the right way
[2012-11-30 17:02:25 -0500] z: I mean something like https://github.com/agh/dotfiles prods you to add a README
[2012-11-30 17:02:39 -0500] z: Maybe that could be extended to prod people to include a LICENSE, who know
[2012-11-30 17:02:45 -0500] erikh: this came up at $previous_job when I wanted to open source some chef stuff. it was a giant CF
[2012-11-30 17:03:07 -0500] z: A la http://zr.to/image/1P2X3b0R0546 in case it only shows me that :)
[2012-11-30 17:04:08 -0500] makmanalp: eek, I have to enter my address
[2012-11-30 17:04:10 -0500] makmanalp: oh well
[2012-11-30 17:04:45 -0500] z: But I'm generally of the opinion that Pull Requests vs. comparatively complex CLAs and tickets (not GitHub Issues) in a JIRA system is making things complex. Its a higher barrier to entry.
[2012-11-30 17:05:04 -0500] makmanalp: well, the CLA's aren't public are they?
[2012-11-30 17:05:20 -0500] makmanalp: (sorry, unrelated question)
[2012-11-30 17:05:28 -0500] z: If a Pull Request (on its own) is insufficient then IMO someone should run a cronjob to close them with a comment covering how to contribute in another way
[2012-11-30 17:05:41 -0500] z: makmanalp: yes, everyone who signed a CLA is listed on the Wiki
[2012-11-30 17:06:15 -0500] makmanalp: z: right but rather I just don't want to give out my phone number to *everyone* is all. Just opscode is fine
[2012-11-30 17:06:24 -0500] z: makmanalp: and if you're contributing work done on your companies time, ISTR they need to sign a Corporate CLA.
[2012-11-30 17:06:41 -0500] makmanalp: okay.
[2012-11-30 17:07:35 -0500] programmerq: so
[2012-11-30 17:07:39 -0500] programmerq: say I have private chef
[2012-11-30 17:07:44 -0500] programmerq: and I have a staging and a production environment
[2012-11-30 17:07:59 -0500] jmahowald: I notice in a lot of cookbooks metadata a DSL for documenting attributes.  And I know that it's joined with md file.  I assume this is to make rocs or something equivalent.  Ideally I'd output markdown.  But I'm having trouble find documentation on the documentation process itself.  (Most of the staff uses confluence, and I wanted to make a workflow step that would auto upload the cookbook docs in place, but also enforce conventions like
[2012-11-30 17:07:59 -0500] jmahowald: attribute descriptions
[2012-11-30 17:07:59 -0500] jmahowald: are there best practices/or a tool set people use for merging together the readme docs with the information in metadata.rb?
[2012-11-30 17:08:08 -0500] programmerq: is it considered bad practice to create two orgs in my private chef server, and push changes to staging first, and then to production second?
[2012-11-30 17:08:40 -0500] z: Not at all, I know a lot of people who do that.
[2012-11-30 17:08:47 -0500] programmerq: me too
[2012-11-30 17:08:54 -0500] programmerq: I'm hoping someone at opscode weighs in on this
[2012-11-30 17:09:04 -0500] z: paging mattray ;)
[2012-11-30 17:09:58 -0500] mattray: programmerq: nothing wrong with that
[2012-11-30 17:10:18 -0500] mattray: environments might work
[2012-11-30 17:10:28 -0500] mattray: but you probably have your reasons for orgs vs. envs
[2012-11-30 17:10:47 -0500] programmerq: mattray: the concern I have is that if you do envs instead of orgs, you're effectively changing a production server when you do a staging push.
[2012-11-30 17:11:10 -0500] programmerq: at my company our guy that is in contact with opscode doesn't want to do the orgs because he said that opscode said so.
[2012-11-30 17:11:24 -0500] dougireton: I was reading through the "Conditional Execution" page on docs.opscode.com and the Conditonal Arguments section doesn't make sense. http://docs.opscode.com/essentials_cookbook_lwrp_resources_common_conditionals.html
[2012-11-30 17:11:25 -0500] programmerq: I didn't buy that
[2012-11-30 17:12:29 -0500] dougireton: I'm not sure what "not_if "grep adam /etc/passwd", :user => 'adam'" means
[2012-11-30 17:12:34 -0500] dougireton: Are the docs correct?
[2012-11-30 17:13:01 -0500] dougireton: or this: not_if "grep adam /etc/passwd", :environment => { 'HOME' => "/home/adam" }
[2012-11-30 17:13:21 -0500] makmanalp: dougireton: I think if the grep returns nothing, it will execute the remaining code
[2012-11-30 17:13:49 -0500] c_t: not_if is like unless
[2012-11-30 17:14:16 -0500] dougireton: ok
[2012-11-30 17:14:16 -0500] makmanalp: oops
[2012-11-30 17:14:17 -0500] yfeldblum: mattray, programmerq, environments do not provide any isolation (i don't think they're intended to); if what you are looking for is isolation, then do not use environments for that; use multiple chef-servers or multiple orgs for that, since isolation in chef is currently at the server/tenant level
[2012-11-30 17:14:26 -0500] kyleb: dougireton: it means the not_if bash code would be executed by the user "adam"
[2012-11-30 17:14:27 -0500] erikh: ^
[2012-11-30 17:14:29 -0500] erikh: sthis
[2012-11-30 17:14:31 -0500] erikh: so much of this
[2012-11-30 17:14:33 -0500] erikh: yfeldblum: <3
[2012-11-30 17:14:58 -0500] dougireton: oh, I see
[2012-11-30 17:15:03 -0500] dougireton: thanks
[2012-11-30 17:15:34 -0500] erikh: in that vein, a chef search that was environment scoped would be absolutely awesome
[2012-11-30 17:15:49 -0500] erikh: (to the current env that is)
[2012-11-30 17:16:15 -0500] erikh: I should probably wrap it, but almost all of my searches end in "chef_environment:#{node.chef_environment}"
[2012-11-30 17:16:19 -0500] yfeldblum: erikh, only nodes have environments, but even then nodes are not scoped to environments
[2012-11-30 17:16:25 -0500] mattray: erikh: add " AND chef_environment:#{node.chef_environment}" to your queries
[2012-11-30 17:16:32 -0500] erikh: right, that's what I do
[2012-11-30 17:16:39 -0500] erikh: it would just be convenient to have a call that does it for me
[2012-11-30 17:16:45 -0500] mattray: I've been building that into recipes
[2012-11-30 17:16:47 -0500] cwj: try discovery
[2012-11-30 17:16:48 -0500] mattray: as a flag
[2012-11-30 17:16:51 -0500] programmerq: w00t. thanks mattray. I was able to say to our guy "matt ray said" and he warmed up.
[2012-11-30 17:17:09 -0500] mattray: hah
[2012-11-30 17:17:33 -0500] erikh: I mean, I get the logic behind it, just I don't think I have a lot of uses cases where cross-environment searches are really useful, and I think that's more common than otherwise
[2012-11-30 17:18:10 -0500] z: mattray: Internet celebrity, smart dude, what's next for you big man?  Are you thinking about a perfume line, or Matt Ray (TM) branded trainers?
[2012-11-30 17:18:10 -0500] erikh: not really suggesting the default change either, just environment_search(:node, query) would satisfy me
[2012-11-30 17:19:28 -0500] yfeldblum: erikh, that would only make sense for searching nodes, so you would do some_nodes = environment_search(query)
[2012-11-30 17:19:50 -0500] erikh: yfeldblum: ah, yeah, good point.
[2012-11-30 17:20:52 -0500] yfeldblum: erikh, plus there are plenty of use-cases for cross-environment searches: all of the use cases for searches, minus the use cases where you're trying to use environments for isolation :D
[2012-11-30 17:21:24 -0500] mattray: z: just working here boss
[2012-11-30 17:21:45 -0500] JasonF: We monitor some dev environemnt servers (like buildbots) with our production-environment chef server, so we do cross-environment searches in our nagios recipe for that
[2012-11-30 17:22:46 -0500] ranjibd: JasonF, same here. Single chef server .. across multiple environments, nagios monitors pre-prod, prod only
[2012-11-30 17:23:39 -0500] erikh: yfeldblum: oh, i'm not saying there aren't
[2012-11-30 17:24:09 -0500] ranjibd: with individual chef server / environment setup , automating  cross environment entities become complicated
[2012-11-30 17:24:31 -0500] Guest72401: Quick question. In open source Chef, where chef save the cookbooks when I upload it using knife
[2012-11-30 17:24:46 -0500] ranjibd: Guest72401, couchdb
[2012-11-30 17:25:20 -0500] Guest72401: ranjibd: got it, I thought they save it in a git repo
[2012-11-30 17:25:48 -0500] Guest72401: ranjibd: Thanks!
[2012-11-30 17:27:31 -0500] jmahowald: sorry for repost
[2012-11-30 17:27:32 -0500] jmahowald:  I notice in a lot of cookbooks metadata a DSL for documenting attributes.  And I know that it's joined with md file.  I assume this is to make rocs or something equivalent.  Ideally I'd output markdown.  But I'm having trouble find documentation on the documentation process itself.  (Most of the staff uses confluence, and I wanted to make a workflow step that would auto upload the cookbook docs in place, but also enforce conventions like
[2012-11-30 17:27:32 -0500] jmahowald: attribute descriptions
[2012-11-30 17:27:32 -0500] jmahowald: are there best practices/or a tool set people use for merging together the readme docs with the information in metadata.rb?
[2012-11-30 17:28:44 -0500] behemphi1: I don't want to start a problem, so let me state that I am asking in good faith:  I just wrote my first LWRP and was looking at the pull requests for rabbitmq when  I saw this:
[2012-11-30 17:28:44 -0500] behemphi1: https://github.com/needle-cookbooks/chef-opscode-rabbitmq/commit/da13c731520605626763e402003cd1e36cd7aab6
[2012-11-30 17:28:53 -0500] behemphi1: so this leads me to two questsions
[2012-11-30 17:29:06 -0500] behemphi1: this persons pull request is nearly identical to mine
[2012-11-30 17:29:29 -0500] behemphi1: if I wanted to simply add my changes to it should I fork it, or fork master and make my own change?
[2012-11-30 17:29:43 -0500] behemphi1: I am very new to this sort of workflow
[2012-11-30 17:30:38 -0500] behemphi1: my second question is where flames might occur:  He calls the action in the lwrp set_user_tag when the rabbitmqctl cmd being invoked is set_user_tags (note the s)
[2012-11-30 17:31:20 -0500] behemphi1: that is really the only change I would want to make at this point.  i.e. make the LWRP match the underlying thing it is calling since it is specific to rabbit in this case
[2012-11-30 17:32:14 -0500] ranjibd: behemphi1, are you using librarian or berks?
[2012-11-30 17:33:44 -0500] cmceldowney: Question RE role default_attributes: it doesn't seem that these completely replace the default attributes set in a cookbook. what is the way to completely override these values (besides just changing the cookbook)? my example is apache for default_modules-- has an array of default modules with some that I don't want. Chef appears to do an array merge with role.default_values and role.override_values, but not an outright replacement.
[2012-11-30 17:33:56 -0500] ranjibd: behemphi1, you can fork cwjohnston's rabbitmq cookbook repo, create a branch.. make your changes , commit & push it. Point berks/librarian to your repo. And submit a pull request to cwjohnston.
[2012-11-30 17:34:55 -0500] behemphi1: @ranjibd I am not using either yet :-(
[2012-11-30 17:36:00 -0500] ranjibd: behemphi1, they are like bundler .. and the workflow for accommodating your own customization is similar to ruby gems..
[2012-11-30 17:36:01 -0500] behemphi1: but nothing keeps me from following your advice without use of berks/lib
[2012-11-30 17:36:07 -0500] ranjibd: yes
[2012-11-30 17:36:25 -0500] behemphi1: Oh, I know what they are, just have not yet partaken of all the goodness that is :-)
[2012-11-30 17:36:36 -0500] behemphi1: what about the second thing ranjibd
[2012-11-30 17:36:45 -0500] behemphi1: set_user_tag v set_user_tags
[2012-11-30 17:36:53 -0500] behemphi1: am I being too pedantic?
[2012-11-30 17:37:37 -0500] behemphi1: the underlying resource name not withstanding, the set_user_tags cmd allows for specifying more than one
[2012-11-30 17:37:46 -0500] behemphi1: indeed it requires that if more than one is to be set
[2012-11-30 17:37:57 -0500] ranjibd: behemphi1, you can pass a space separated list of tags as a single string
[2012-11-30 17:38:48 -0500] ranjibd: so yes.. it should be tags
[2012-11-30 17:38:54 -0500] ranjibd: +1
[2012-11-30 17:39:17 -0500] behemphi1: thx, this is really my first crack at submitting so I appreciate getting "coached up"
[2012-11-30 17:43:51 -0500] dodizzle: I feel dirty installing chef client on windows
[2012-11-30 17:44:18 -0500] dodizzle: ruby and chef are pure and beautiful, windows is ugly and smells bad
[2012-11-30 17:44:29 -0500] behemphi1: er  hire a window washer?
[2012-11-30 17:44:31 -0500] behemphi1: :-)
[2012-11-30 17:44:44 -0500] behemphi1: (sorry  friday and I could not resist)
[2012-11-30 17:45:05 -0500] jtimberman: behemphi1: I think coordinating with 'needle-cookbooks' and having a jira ticket would be a great approach
[2012-11-30 17:45:33 -0500] behemphi1: @jtimberman needle-cookbooks?
[2012-11-30 17:46:10 -0500] jtimberman: 10:28 <behemphi1> https://github.com/needle-cookbooks/chef-opscode-rabbitmq/commit/da13c731520605626763e402003cd1e36cd7aab6
[2012-11-30 17:48:04 -0500] peat: Hello. Chef noob here. I'm looking for examples of cookbooks that deal with other servers as dependencies. For example, a new web server should talk to "the postgresql server" ... but I'm not keen to hardcode the pg server address into the templates. I've heard tale of mechanisms for achieving this kind of configuration, but alas -- I have been unable to discover them.
[2012-11-30 17:49:43 -0500] peat: Example situation: starting up a new cluster. Cluster has pg server, two web servers. How do I tell the web servers what the address of the pg server is?
[2012-11-30 17:49:51 -0500] jtimberman: peat: that's generally what we use search to do.
[2012-11-30 17:49:53 -0500] cmceldowney: peat: you should look into search for this-- http://wiki.opscode.com/display/chef/Search. or you can store the server IDs in data bags and pull those into your configuration files. I typically have roles for the servers I"m interested in finding (e.g. webhead, reverse-proxy, database), then I do returned_nodes = search(:node, "roles:webhead AND chef_environment:prod")
[2012-11-30 17:49:58 -0500] peat: Ahhh, fabulous.
[2012-11-30 17:50:21 -0500] jtimberman: peat: so the postgresql server would have a role or some other distinguishing characteristic like an attribute "is_postgresql_master" that you can search for.
[2012-11-30 17:50:32 -0500] chip-: Also: Tags.
[2012-11-30 17:50:55 -0500] behemphi1: Hey peat
[2012-11-30 17:50:56 -0500] behemphi1: # Locate the magnet host
[2012-11-30 17:50:56 -0500] behemphi1: magnet_host =
[2012-11-30 17:50:56 -0500] behemphi1:   search(:node,"name:#{node.feedmagnet.console_server.MAGNET_HOST_NAME}")
[2012-11-30 17:50:57 -0500] behemphi1: magnet_host_service_net_ip = magnet_host[0].cloud.private_ips[0]
[2012-11-30 17:50:57 -0500] behemphi1: node.set[:feedmagnet][:console_server][:megavolt_host_ip] =
[2012-11-30 17:50:57 -0500] behemphi1:   magnet_host_service_net_ip
[2012-11-30 17:51:04 -0500] behemphi1: that is me looking for somethign with name magic
[2012-11-30 17:52:07 -0500] peat: Ok, this is a great start. Thanks everyone. I'll probably be back with more questions. ;)
[2012-11-30 17:56:28 -0500] julian_: Anyone got a second to check out my handler setup?  I am getting a NameError on my handler and I cannot figure out why.  Pastie: http://pastie.org/5459230
[2012-11-30 17:58:07 -0500] chip-: julian_: revert to chef_handler cookbook 1.0.8.
[2012-11-30 17:59:20 -0500] julian_: chip-: Thanks for the response.  Is there a known issue?
[2012-11-30 18:03:01 -0500] yfeldblum: jtimberman, what's this supposed to do? https://github.com/opscode-cookbooks/cron/blob/master/providers/d.rb#L31
[2012-11-30 18:03:37 -0500] jtimberman: yfeldblum: send the update notification for the enclosing provider only if the resource(s) it contains was updated.
[2012-11-30 18:04:08 -0500] yfeldblum: jtimberman, but the contained resource will never be updated before that line runs
[2012-11-30 18:04:16 -0500] yfeldblum: jtimberman, it will only be declared
[2012-11-30 18:04:16 -0500] jtimberman: so if you had a cron_d("mything) { blahblah parameters ; notifies :run, "execute[run this when the cron job is ready]"}
[2012-11-30 18:05:12 -0500] yfeldblum: jtimberman, so wouldn't t.updated_by_last_action? always be false?
[2012-11-30 18:06:51 -0500] jtimberman: no
[2012-11-30 18:07:06 -0500] spox: really?
[2012-11-30 18:07:10 -0500] jtimberman: t is a template, and it will be updated_by_last_action(true) when it gets rendered
[2012-11-30 18:07:40 -0500] spox: but isn't 31 happening during compile phase, so it wouldn't have been rendered at that point?
[2012-11-30 18:07:42 -0500] yfeldblum: jtimberman, but it only gets rendered after the cron provider finishes running
[2012-11-30 18:08:00 -0500] yfeldblum: spox, 31 is happening during convergence
[2012-11-30 18:08:31 -0500] spox: awesome, i learned my new thing for the day
[2012-11-30 18:08:35 -0500] spox: guess it's time for a beer
[2012-11-30 18:08:53 -0500] masterkorp: spox: good thinking
[2012-11-30 18:08:59 -0500] masterkorp: pop one open for me too
[2012-11-30 18:09:39 -0500] jtimberman: LWRPs create a new run context for the resources in the provider action methods
[2012-11-30 18:11:19 -0500] spox: jtimberman: makes sense. happy to see i was making my life harder for no reason what so ever.
[2012-11-30 18:12:41 -0500] yfeldblum: jtimberman, where does that happen?
[2012-11-30 18:19:00 -0500] jtimberman: yfeldblum: in the magic of the LWRP code
[2012-11-30 18:20:23 -0500] yfeldblum: jtimberman, i'm not seeing it in https://github.com/opscode/chef/blob/master/lib/chef/provider.rb#L185
[2012-11-30 18:22:00 -0500] jtimberman: yfeldblum: i don't know where in the codebase it is, it's been awhiel since i looked at that part of things
[2012-11-30 18:22:42 -0500] julian_: chip:  Thanks!!! That did it!
[2012-11-30 18:23:30 -0500] barnacles: On behalf of chip, you're welcome julian_
[2012-11-30 18:26:29 -0500] rava: anyone know how to make the databse cookbook not display the user password in a chef-client run?
[2012-11-30 18:27:40 -0500] juliancdunn: rava: I don't have that problem. are you running in verbose mode or something?
[2012-11-30 18:27:53 -0500] rava: info
[2012-11-30 18:27:55 -0500] rava: level logging
[2012-11-30 18:28:25 -0500] juliancdunn: me too... all I see is
[2012-11-30 18:28:26 -0500] juliancdunn: [2012-11-30T18:14:18+00:00] INFO: Processing postgresql_database_user[fisheye] action create (fisheye::local_database line 32)
[2012-11-30 18:28:42 -0500] rava: this is on the grant action
[2012-11-30 18:28:58 -0500] juliancdunn: even still
[2012-11-30 18:29:04 -0500] juliancdunn: [2012-11-30T18:14:18+00:00] INFO: postgresql_database_user[fisheye]: granting access with statement [GRANT all ON DATABASE fisheye TO fisheye]
[2012-11-30 18:29:10 -0500] juliancdunn: there's no password there
[2012-11-30 18:29:13 -0500] rava: odd
[2012-11-30 18:29:19 -0500] rava: sec, let me clean up the output from the run
[2012-11-30 18:29:51 -0500] yfeldblum: jtimberman, because what would the point be of this? https://github.com/opscode/chef/blob/master/lib/chef/provider.rb#L160-L178
[2012-11-30 18:31:25 -0500] rava: https://gist.github.com/4177599
[2012-11-30 18:32:04 -0500] rava: on both successful and bad runs, it shows the password
[2012-11-30 18:33:21 -0500] juliancdunn: ah, it's in the mysql provider
[2012-11-30 18:33:50 -0500] juliancdunn: maybe submit a patch to line 60? https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_mysql_user.rb
[2012-11-30 18:34:33 -0500] rava: juliancdunn: and suddenly i feel hella lazy for not digging into the provider, thanks
[2012-11-30 18:34:53 -0500] juliancdunn: heh np
[2012-11-30 18:35:21 -0500] rava: note to self, ALWAYS read the provider before thinking it's in a deeper lib somewhere >.>
[2012-11-30 18:37:58 -0500] barnacles: Within a provider, I am calling a definition. However the definition does not like when I feed it a param "#{new_resource.name"}, any ideas?
[2012-11-30 18:39:04 -0500] barnacles: I get the following NoMethodError: undefined method `name' for []:Array
[2012-11-30 18:44:42 -0500] barnacles: Figured it out. But I have a new question, can I run a recipe from inside an LWRP?
[2012-11-30 18:44:53 -0500] jtimberman: barnacles: include_recipe? No
[2012-11-30 18:45:03 -0500] jtimberman: not without performing strange voodoo :)
[2012-11-30 18:45:10 -0500] barnacles: Barnacles.
[2012-11-30 18:45:45 -0500] barnacles: How would I go about it then? Executing that recipe within an LWRP? It's just not feasible?
[2012-11-30 19:00:36 -0500] btm: Epic Cookbook Review starts soon. Join in: https://plus.google.com/hangouts/_/9c08bbe4e4c255b21ccb976f57244c30038b0896?authuser=1&hl=en or just watch: http://youtu.be/8ZczKYX5zWM
[2012-11-30 19:04:54 -0500] awgross: barnacles: normally in the recipe where I am using the LWRP I will have include_recipe "blah::default"
[2012-11-30 19:05:04 -0500] awgross: above the LWRP
[2012-11-30 19:05:16 -0500] awgross: the default recipe will set up any dependencies or sub cookbooks etc
[2012-11-30 19:08:23 -0500] barnacles: awgross: Yah that's what I had originally I just wanted to move it away from there. Ah well, thanks
[2012-11-30 19:11:39 -0500] awgross: btm: https://status.github.com/
[2012-11-30 19:11:46 -0500] awgross: btm: minor outage
[2012-11-30 19:11:58 -0500] miah: good morning
[2012-11-30 19:25:31 -0500] btm: awgross: silly guthub. :(
[2012-11-30 19:25:39 -0500] gchristensen: major outtage now :(
[2012-11-30 19:28:02 -0500] masterkorp: where ?
[2012-11-30 19:28:15 -0500] miah: github
[2012-11-30 19:29:24 -0500] masterkorp: oh yeah i noticing that
[2012-11-30 19:31:02 -0500] erikh: I mean, it's not like the nfs server went down and took your ability to commit
[2012-11-30 19:31:03 -0500] erikh: :P
[2012-11-30 19:31:54 -0500] masterkorp: yeap :)
[2012-11-30 19:32:28 -0500] ranjibd: pagerduty should understand github outages .:-/
[2012-11-30 19:33:14 -0500] masterkorp: dont you guys have a secondary remote ?
[2012-11-30 19:33:16 -0500] masterkorp: :O
[2012-11-30 19:34:10 -0500] ranjibd: yeah.. but thats for local works,.. not in the production instances...
[2012-11-30 19:34:26 -0500] ranjibd: continuous delivery... ;-p
[2012-11-30 19:34:32 -0500] masterkorp: seriously
[2012-11-30 19:34:36 -0500] masterkorp: get a gitolite
[2012-11-30 19:34:53 -0500] masterkorp: place some hooks on the github to push to gitolite
[2012-11-30 19:51:11 -0500] miah: masterkorp: thats a good point
[2012-11-30 19:51:27 -0500] miah: while github is down i just perform local commits and don't push to my remote branch. not a big deal really.
[2012-11-30 19:52:28 -0500] masterkorp: miah: yes, but if you have a deployment that requires downtime schedules?
[2012-11-30 19:52:44 -0500] masterkorp: you'd have to re-schedule ?
[2012-11-30 19:52:50 -0500] masterkorp: not profesional
[2012-11-30 19:53:29 -0500] miah: yup. true true.
[2012-11-30 19:53:56 -0500] miah: http://gitorious.org/ is free =)
[2012-11-30 19:54:10 -0500] masterkorp: i have a gitolite
[2012-11-30 19:54:25 -0500] miah: ya
[2012-11-30 19:54:25 -0500] masterkorp: both personally (private projects)
[2012-11-30 19:54:41 -0500] miah: cool
[2012-11-30 19:54:49 -0500] ranjibd: btm, lot of us uses that
[2012-11-30 19:54:54 -0500] ranjibd: generating thumbnails
[2012-11-30 19:55:30 -0500] miah: its the same story always. 'the cloud does not guarentee high availability. you still have to build that into your architecture.' if you're relying on a service like github you have a single point of failure.
[2012-11-30 19:57:54 -0500] Majost: Is it possible to drop an ssh private key with the users cookbook?
[2012-11-30 20:02:46 -0500] masterkorp: a private key ?
[2012-11-30 20:02:52 -0500] masterkorp: yes you can
[2012-11-30 20:03:09 -0500] masterkorp: probably need to make a recipe
[2012-11-30 20:11:35 -0500] mattray: Majost: users cookbook supports that
[2012-11-30 20:12:58 -0500] cassianoleal: mattray: does it? doesn't the users cookbook only support public keys for your authorized_hosts file?
[2012-11-30 20:13:12 -0500] mattray: oh private
[2012-11-30 20:13:23 -0500] miah: it can be easily modified to also push the private key
[2012-11-30 20:13:28 -0500] mattray: Majost: you meant public key right?
[2012-11-30 20:13:31 -0500] masterkorp: you can do that in a recipe in like, a 10 seconds
[2012-11-30 20:13:35 -0500] miah: i did that for deploy users
[2012-11-30 20:14:48 -0500] Majost: mattray: No -- I do actually mean private key in this instance... I realize the security implications.
[2012-11-30 20:15:23 -0500] mattray: Majost: a minor tweak, per miah and masterkorp's suggestions
[2012-11-30 20:19:22 -0500] pattersonc: is there a way to set the user for a migration command on a resource?
[2012-11-30 20:29:12 -0500] ranjibd: pattersonc, what resource you are using? the execute resource provide a user attribute
[2012-11-30 20:29:44 -0500] pattersonc: the application resource
[2012-11-30 20:36:25 -0500] X-Jester: hey, i'm trying to automate the initial 'knife configure -i' process that happens after i've installed and started up the chef-server processes.  when i provide all the values on the command line, though, it doesn't actually create a key for my api client user.  If i answer the questions manually, it does.  Any ideas?  chef 10.16.2.
[2012-11-30 20:41:20 -0500] ranjibd: pattersonc, it has a user attribute
[2012-11-30 20:42:24 -0500] pattersonc: ranjibd: yep. maybe the migration is failing for a different reason
[2012-11-30 20:42:39 -0500] pattersonc: perms should be good if the command runs in the context of the user attrb
[2012-11-30 20:44:31 -0500] kallen: boingggggg
[2012-11-30 20:44:35 -0500] kallen: gah.. mischan :>
[2012-11-30 20:57:57 -0500] mattray: does anyone know if Conditional Execution for Resources happens during convergence or before?
[2012-11-30 20:58:48 -0500] mattray: ie. I'm using an "only_if" with a Resource that's checking on a remote_file
[2012-11-30 21:00:39 -0500] yfeldblum: mattray, guards are checked during convergence
[2012-11-30 21:00:45 -0500] mattray: perfect, thanks
[2012-11-30 21:22:41 -0500] cheflevelramen: Hi Guys. I asked this question last night and thought I had it sorted out, but turns out I didn't. I would like to either make or use a cookbook that dynamically sets the hostname of the machine to a value that I pass in with the command 'knife ec2 server create '. In other words, with that command, I can set the node name (-N), and I'd like to use that value in my hostname cookbook.
[2012-11-30 21:22:47 -0500] cheflevelramen: The issue though is that node.name should be the value set by the -N flag, but it seems to only return the output of `hostname -s`, which is the short honstname of the server. So if I update the hostname on the machine, then node.name returns the updated value. But this is backwards to what I want. I want to set and get the node name, and name the host accordingly.
[2012-11-30 21:22:52 -0500] cheflevelramen: Any ideas on how to do this?
[2012-11-30 21:37:51 -0500] awgross: cheflevelramen: what version of knife/knife ec2 are you using?
[2012-11-30 21:38:08 -0500] cheflevelramen: Chef: 10.16.0
[2012-11-30 21:38:36 -0500] cheflevelramen: knife-ec2 (0.6.2)
[2012-11-30 21:39:40 -0500] ranjibd: cheflevelramen, knife ec2 or any other cookbooks does not alter the fqdn or hostname
[2012-11-30 21:39:54 -0500] ranjibd: they are automatic attributes.. coming from ohai
[2012-11-30 21:40:43 -0500] ranjibd: knife-ec2 uses the -N to set the node_name property in chef client config (aka node name) also, an ec2 instance tag (key "name")
[2012-11-30 21:41:01 -0500] daneroo: Has anyone used chef-solo to bring up a windows sql_server with opscode's sql_server recipe ?
[2012-11-30 21:41:18 -0500] cheflevelramen: That's what I thought. I figured there wasn't a way to set the hostname with knife/chef/ohai directly, but I was hoping to name a something like the node.name and then use it to create a cookbook to update the hostname. Currently, the only value I see that I can use are either the security group or the ec2 tags, which I can set with knife
[2012-11-30 21:41:37 -0500] ranjibd: cheflevelramen, if you intend to fix the hostname via chef.. you have to write a recipe for that(not sure if anything like that is present in community)
[2012-11-30 21:42:24 -0500] cheflevelramen: That's fine, and that's what I'm trying to do. What I'm trying to avoid is having to set the hostname for each node individually, but rather set it on start up somehow
[2012-11-30 21:42:26 -0500] ranjibd: cheflevelramen, what distro you are usin
[2012-11-30 21:42:38 -0500] cheflevelramen: Latest amazon linux distro
[2012-11-30 21:42:42 -0500] cheflevelramen: 12.04
[2012-11-30 21:42:55 -0500] cheflevelramen: Sorry, Amazon Linux AMI release 2012.09
[2012-11-30 21:43:24 -0500] ranjibd: rel derivative then.. i think you can update the hostname using the hostname -s command or updating the /etc/sysconfig/network file
[2012-11-30 21:44:32 -0500] cheflevelramen: Correct, so it's just a matter of passing some variable to the recipe of what to name the machine. My hopes were to be able to set the node.name with knife, and then use that value as the input to a recipe, which sets the hostname to that value
[2012-11-30 21:44:41 -0500] ranjibd: you have to write a recipe to do this. but its kinda tricky .. hostname -f should work.. else chef runs will fail.. and given that aws has internal dhcp/dns.. setting an explicit hostname might affect
[2012-11-30 21:48:17 -0500] cheflevelramen: I'm pretty new to chef. If I were to make a recipe then that sets the hostname, what would be the standard or best practice for inputting that value? Would I put the name I wanted in a role, databag? I have about 80+ servers this would be used on, so I'd rather not have to write out the names of each one in some file, but would like to set it at boot up. Any recommended ways of doing that?
[2012-11-30 21:50:30 -0500] yfeldblum: cheflevelramen, roles and data-bags are shared between many or all nodes
[2012-11-30 21:51:15 -0500] yfeldblum: cheflevelramen, you could write a recipe that sets the hostname based on the node name, and include that recipe in every node's run-list
[2012-11-30 21:52:00 -0500] yfeldblum: cheflevelramen, or you could write your own bootstrap template which sets the hostname before chef-client ever runs
[2012-11-30 21:52:07 -0500] cheflevelramen: Exactly! That's what I want to do. But I can't seem to set the node name (or at least retrieve that value).
[2012-11-30 21:52:41 -0500] cheflevelramen: Using the -N flag with knife-ec2 seems to set the node name, but then if I use shef, and type node.name, it just returns the fqdn
[2012-11-30 21:53:17 -0500] Guest95175: is there a way to have deploys per node executed from 'knife'? or would one have to create a custom Ruby file and execute with 'knife exec'?
[2012-11-30 21:53:38 -0500] ranjibd: cheflevelramen, use shef -z
[2012-11-30 21:55:00 -0500] cheflevelramen: Okay I'll try that. Have to spin server back up.
[2012-11-30 21:57:49 -0500] cheflevelramen: Victory!! Thanks ranjibd and yfeldblum. Using shef -z allows me to see the value of node.name. Didn't realize I wasn't connecting as a client
[2012-11-30 21:58:11 -0500] cheflevelramen: So in a recipe then, when I specify the value as the node name, it should just return the correct value, right?
[2012-11-30 22:00:25 -0500] cheflevelramen: Anyway, thanks again!
[2012-11-30 22:03:27 -0500] juliancdunn: Opscode JIRA workflow question: if a ticket I had was "Reopened" and I've provided a comment, should I move it to "Fix Provided" state now?
[2012-11-30 22:15:01 -0500] ranjibd: juliancdunn, its has a pull request which accommodates those comments (made while reopening the ticket)?
[2012-11-30 22:17:34 -0500] juliancdunn: the comments are to clarify a question on the existing pull request
[2012-11-30 22:23:17 -0500] ranjibd: not sure.. jtimberman or btm should be able to answer
[2012-11-30 22:26:39 -0500] jtimberman: juliancdunn: depends, does the comment resolve the concerns raised in reopening?
[2012-11-30 22:26:45 -0500] jtimberman: if so, then put it in Fix Provided
[2012-11-30 22:27:05 -0500] juliancdunn: jtimberman: yes, the comments should... thanks
[2012-11-30 22:32:38 -0500] jroberts: What would cause a client to pull an old version of a cookbook if there are no version constraints in any environment?!?!?
[2012-11-30 22:33:36 -0500] jroberts: I can see the version I want using the chef-admin UI, so I  know the latest version is the one I want...
[2012-11-30 22:41:47 -0500] mattray: anyone seen examples of accessing Chef's source from a recipe? I want to grab a bootstrap template
[2012-11-30 22:43:15 -0500] JasonF: Hm. Does the git resource support specifying a file or list of files?
[2012-11-30 22:43:25 -0500] JasonF: That's sorta what I think of first...
[2012-11-30 22:44:06 -0500] mattray: remote_file to Github?
[2012-11-30 22:44:15 -0500] mattray: that could work
[2012-11-30 22:44:35 -0500] ranjibd: jroberts, does the run_list explicitly specifies a cookbook version?
[2012-11-30 22:45:27 -0500] ranjibd: jroberts, check the nodes /var/chef/cache/cookbook/<cookbook name> to ensure that the downloaded cookbook version is lower than the latest
[2012-11-30 22:48:26 -0500] jroberts: that was the problem.
[2012-11-30 22:48:29 -0500] jroberts: Thank you.
[2012-11-30 23:25:33 -0500] oddover: Hey everyone. I'm curious. Is anyone here using chef to manage nagios? If so, how?
[2012-11-30 23:26:04 -0500] oddover: and what I'm talking about is having chef somehow configure your nagios server automatically when a new node gets created
[2012-11-30 23:37:06 -0500] btm: oddover: lots of people do.
[2012-11-30 23:37:13 -0500] btm: oddover: Opscode does.
[2012-11-30 23:37:30 -0500] btm: oddover: you can run chef-client as a daemon and populate your host config using search.
[2012-11-30 23:38:07 -0500] oddover: so there'd be a recipe that would search through the configs for all the nodes, and generate nagios configs based on that?
[2012-11-30 23:38:13 -0500] btm: oddover: Nagios has the first 10m of a talk I gave online: https://www.youtube.com/watch?v=mrozbwlWvbg Unfortunately it isn't all of it.
[2012-11-30 23:38:40 -0500] btm: oddover: yes, there's the community nagios cookbook: http://ckbk.it/nagios
[2012-11-30 23:39:17 -0500] btm: oddover: you can see where it searchs for nodes to monitor on github: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/server.rb#L71
[2012-11-30 23:39:44 -0500] retr0h: btm: I'll have some pushes comming your way on the nagios cookbook.. I have issues with multi-homed systems
[2012-11-30 23:40:02 -0500] btm: oddover: I guess that nagios talk viedo excludes the nagios specific part :(
[2012-11-30 23:40:17 -0500] retr0h: if nagios server doesn't have a public address but a box it's checking is multi-homed node[:ipaddress] returns the wrong address for the nrpe allow
[2012-11-30 23:40:20 -0500] btm: retr0h: word. appreciated.
[2012-11-30 23:40:55 -0500] oddover: btm: yea it's basically an intro to chef
[2012-11-30 23:41:26 -0500] btm: oddover: the end is mostly a demo. the nagios cookbook is search + databag based, the readme is pretty decent.
[2012-11-30 23:41:49 -0500] btm: oddover: https://github.com/opscode-cookbooks/nagios/blob/master/README.md
[2012-11-30 23:42:55 -0500] oddover: that gives me a good start.
[2012-11-30 23:43:30 -0500] oddover: We're actually using chef-solo, but we can probably make a fork of that cookbook for our needs
[2012-11-30 23:43:37 -0500] oddover: thanks!
[2012-11-30 23:43:56 -0500] retr0h: oddover: all the power of that cookbook lies with search imo
[2012-11-30 23:44:45 -0500] oddover: retr0h: Yea. I kinda guessed so. We're trying to make an alternative in our environment so we can have search-like capabilities
[2012-11-30 23:44:50 -0500] oddover: it's kinda hard to explain
[2012-11-30 23:45:25 -0500] JasonF: oddover: We heavily modified that cookbook to use one search then lots of selects against the object the search creates. Shouldn't be too hard to migrate to chef-solo if you're willing to do the work :)
[2012-11-30 23:45:54 -0500] retr0h: oddover: couple buddies of mine use chef-solo + mcollective
