[2012-11-13 00:00:38 -0500] chefologist: hi gang, what is the easiest way of getting my pem files to ~/.chef?  I am using virtual box on a mac.  I have been told scp, but finding it frustrating
[2012-11-13 00:00:51 -0500] chefologist: the virtual box is ubuntu server
[2012-11-13 00:02:45 -0500] red5|ryan: scp is how I do it
[2012-11-13 00:02:49 -0500] red5|ryan: are you doing it more than once?
[2012-11-13 00:06:41 -0500] bluepojo1: awwwww yeah, berkshelf 1.0.0 released
[2012-11-13 00:06:42 -0500] bluepojo1: http://lists.opscode.com/sympa/arc/chef/2012-11/msg00205.html
[2012-11-13 00:06:58 -0500] bluepojo1: the feature I added this morning got into the release, too :P
[2012-11-13 00:16:54 -0500] jkyle: it seems that regeneration of client keys via chef-server-webui is not working for me. It appears to succeed, but looking at the logs the webui actually tries to create a _new_ client rather than a new key for an existing client and the chef-server backend rejects the request.
[2012-11-13 00:17:16 -0500] jkyle: to the user, it looks like the key is generated, but when they try to use it the authentication fails
[2012-11-13 00:27:07 -0500] killfill: yfeldblum: (sorry for the late response), but if its just a wrapper, what do i earn using it instead of just deploy[_revision]?.. i can do the same thing, right?
[2012-11-13 00:27:10 -0500] miah: bluepojo1: awesome. thanks. =)
[2012-11-13 00:28:42 -0500] yfeldblum: killfill, you could ... in the same way that chef is just a wrapper around interesting behavior and you could just do that with a few bash scripts so why use chef
[2012-11-13 00:30:54 -0500] killfill: hm..
[2012-11-13 00:31:21 -0500] killfill: yfeldblum: ust trying to understand what it does.. :)..
[2012-11-13 00:31:27 -0500] Majost: if I have a file in my cookbook under the files directory: dirfoo/barfile
[2012-11-13 00:31:43 -0500] Majost: do I need to specify the directory when using cookbook_file?
[2012-11-13 00:32:07 -0500] killfill: yfeldblum: what i can see is that it lets you use things like application_php or the like so you can have anice DSL for declaring the different framework-specific configs.
[2012-11-13 00:32:20 -0500] killfill: thats something i guess deploy_revision doesnt gave
[2012-11-13 00:32:21 -0500] yfeldblum: killfill, right
[2012-11-13 00:32:25 -0500] bemu: Correct.
[2012-11-13 00:32:53 -0500] bemu: There's a thread on the mailing list where I posted a 31 line recipe to build a whole rails app + stack. That kind of sexiness is not possible with deploy_revision alone.
[2012-11-13 00:33:11 -0500] killfill: aah thats it point then.
[2012-11-13 00:35:05 -0500] beandip: So, I have an issue
[2012-11-13 00:35:21 -0500] beandip: I need to detect the ip address of an eth2 interface in a recipe.  How can I do this?
[2012-11-13 00:35:26 -0500] bemu: killfill: http://lists.opscode.com/sympa/arc/chef/2012-11/msg00154.html
[2012-11-13 00:36:26 -0500] bemu: beandip: We use a plugin, one sec.
[2012-11-13 00:36:58 -0500] beandip: bemu, it would be awesome if you could help me sort this out
[2012-11-13 00:37:47 -0500] beandip: I have a handful of rackspace next-gen servers utilizing the new cloud networks private network feature but ohai rackspace plugin is written to only detect publi_ip on eth0 and private_ip on eth1
[2012-11-13 00:38:17 -0500] beandip: so the private cloud network I created was attached to eth2 and I'm a bit SOL using ohai to get that info into chef
[2012-11-13 00:40:23 -0500] bemu: beandip: https://gist.github.com/1040543 is what we use
[2012-11-13 00:41:58 -0500] beandip: bemu, thanks
[2012-11-13 00:42:07 -0500] beandip: this looks like a good fix for me
[2012-11-13 00:42:18 -0500] bemu: np, works for us too.
[2012-11-13 00:42:26 -0500] bemu: between aws and bare metal.
[2012-11-13 00:44:28 -0500] beandip: bemu, I've not installed ohai plugins
[2012-11-13 00:44:36 -0500] beandip: http://wiki.opscode.com/display/chef/Distributing+Ohai+Plugins
[2012-11-13 00:44:42 -0500] bemu: hahah, neither have I. :)
[2012-11-13 00:44:43 -0500] beandip: Is that my proper starting point?
[2012-11-13 00:45:06 -0500] bemu: Someone else on my team did it.
[2012-11-13 00:45:20 -0500] bemu: Maybe someone else in here can chime in.
[2012-11-13 00:45:29 -0500] beandip: Does that live in your team's cookbooks/ohai/plpugins/ directory?
[2012-11-13 00:46:05 -0500] bemu: Indeed.
[2012-11-13 00:46:20 -0500] bemu: cookbooks/ohai/files/default/plugins/network_addr.rb
[2012-11-13 00:49:14 -0500] killfill: bemu: today i ended using just deploy_Revision, and put some ugly things on the hooks.. :P ill probably move that to application_* logic.. :P
[2012-11-13 00:49:58 -0500] bemu: I mean, it doesn't REALLY matter, if what you have works. May not be worth the trouble.
[2012-11-13 00:50:22 -0500] killfill: yah, well i will need to extend it.. :)
[2012-11-13 00:53:59 -0500] beandip: bemu, this should work wonderfully for me
[2012-11-13 00:54:02 -0500] beandip: I love you!
[2012-11-13 00:54:04 -0500] beandip: :P
[2012-11-13 00:55:01 -0500] bemu: hahaha, a warm welcome, haven't been lurking in here much lately.
[2012-11-13 00:55:07 -0500] bemu: I'll try to pay more attention.
[2012-11-13 00:57:35 -0500] maplebed: if I've got a gem file locally, how do I install it from within a chef recipe (using chef_gem, I presume)?  i.e. how do I specify a local path to search for gems to install?
[2012-11-13 01:09:11 -0500] gyre008: can I retrieve somehow output from mixlib shell out ?
[2012-11-13 01:09:26 -0500] jtimberman: gyre008: yeah, call the stdout method on the shellout object you create.
[2012-11-13 01:09:36 -0500] jtimberman: mything = shell_out("echo hi")
[2012-11-13 01:09:38 -0500] jtimberman: mything.stdout
[2012-11-13 01:10:09 -0500] gyre008: I don't have to create an object like this ? Mixlib::ShellOut.new()
[2012-11-13 01:10:21 -0500] gyre008: Im looking at https://github.com/opscode/mixlib-shellout
[2012-11-13 01:11:17 -0500] gyre008: I might be missing something...
[2012-11-13 01:15:16 -0500] jtimberman: gyre008: arey ou using it directly, not in a chef recipe?
[2012-11-13 01:15:22 -0500] jtimberman: or other part of a chef cookbook
[2012-11-13 01:15:41 -0500] gyre008: I want to use it in a librarywhich is part of one of the cookbooks
[2012-11-13 01:15:48 -0500] gyre008: so it's a cookbook library
[2012-11-13 01:15:59 -0500] gyre008: library methods will be called in the recipes..
[2012-11-13 01:18:17 -0500] scrogson: is it good practice to store cookbooks within a project repo (i.e. within a Rails app)? Or should it be kept separate?
[2012-11-13 01:18:37 -0500] jtimberman: gyre008: yeah so you can use it like this: https://gist.github.com/4063245
[2012-11-13 01:18:40 -0500] jtimberman: brb
[2012-11-13 01:20:55 -0500] gyre008: jtimberman, so I need to require the libs ? even if I don't use shell_out method but instead will create shell out objects via Mixlib::ShellOut.new()
[2012-11-13 01:20:57 -0500] gyre008: ?
[2012-11-13 01:22:26 -0500] gyre008: jtimberman, is the advantage of shell_out method that it creates the shell out object for you and runs it automatically ?
[2012-11-13 01:22:31 -0500] jtimberman: yeah
[2012-11-13 01:22:32 -0500] jtimberman: :)
[2012-11-13 01:22:37 -0500] jtimberman: bbiab
[2012-11-13 01:22:38 -0500] gyre008: I see
[2012-11-13 01:42:31 -0500] Glace: Is there a way to load a databag item in a template file or in the attributes file?
[2012-11-13 01:55:29 -0500] yfeldblum: Glace, don't do that
[2012-11-13 01:55:46 -0500] yfeldblum: Glace, write code in recipes, especially code for fetches and searches
[2012-11-13 01:58:22 -0500] rafaelmagu: How does one force the chef-client run in a Vagrant box to run in debug mode?
[2012-11-13 01:58:31 -0500] bluepojo1: vagrant ssh :P
[2012-11-13 01:58:40 -0500] bluepojo1: chef-client -ldebug
[2012-11-13 01:59:05 -0500] bluepojo1: there's actually a vagrant flag for it
[2012-11-13 01:59:05 -0500] bluepojo1: log_level or somesuch, let me see
[2012-11-13 01:59:20 -0500] rafaelmagu: Digging through the Vagrant config now
[2012-11-13 02:04:24 -0500] rafaelmagu: For the record => chef.log_level = :debug
[2012-11-13 02:15:33 -0500] itchyouch: For those of you with lots of files to deploy, do you usually package the files or wrote a cookbook recipe to deploy them?
[2012-11-13 02:20:06 -0500] bluepojo1: tar them up and then use a cookbook to deploy them :D
[2012-11-13 02:20:17 -0500] bluepojo1: provided the files are all the same application
[2012-11-13 02:20:38 -0500] bluepojo1: we use a distributed artifact server to get the tars to all the DCs that need them
[2012-11-13 02:20:45 -0500] bluepojo1: and then we have an LWRP that deploys the tars
[2012-11-13 02:20:59 -0500] bluepojo1: github.com/RiotGames/artifact-cookbook
[2012-11-13 02:25:28 -0500] jtimberman: bluepojo1: i contributed a patch to add log level and other command-line options ot the chef commands vagrant runs
[2012-11-13 02:25:36 -0500] jtimberman: bluepojo1: its in vagrant master, dunno when released
[2012-11-13 02:25:54 -0500] bluepojo1: gotcha
[2012-11-13 02:26:08 -0500] jtimberman: mainly for why run :)
[2012-11-13 02:28:01 -0500] jtimberman: bluepojo1: https://github.com/mitchellh/vagrant/pull/1067
[2012-11-13 02:34:48 -0500] Majost: I made a VM clone of my chef server to do some testing with, and I updated the hostname for the OS level stuff, but I still need to update the chef client and server stuff. My question is, where might I find  a doc somewhere I can reference to get all this working properly?
[2012-11-13 02:37:16 -0500] chefologist: hi, what is the best way to get my .pem, knife.rb into my ~/.chef folder on my virtualbox ubuntu server?
[2012-11-13 02:39:31 -0500] red5|ryan: scp
[2012-11-13 02:40:27 -0500] chefologist: thanks ryan
[2012-11-13 03:37:48 -0500] scrogson: can you use "package[nginx]" inside of the run_list?
[2012-11-13 03:38:07 -0500] rafaelmagu: I don't think so
[2012-11-13 03:38:20 -0500] rafaelmagu: Why would you, anyway?
[2012-11-13 03:38:37 -0500] scrogson: because I don't know any better ;)
[2012-11-13 03:39:34 -0500] bemu: You'd probably be better off just putting a ruby_block in your run_list.
[2012-11-13 03:40:01 -0500] scrogson: bemu: can you point me to an example?
[2012-11-13 03:40:05 -0500] bemu: (I'm joking)
[2012-11-13 03:40:08 -0500] yfeldblum: scrogson, of course not
[2012-11-13 03:40:24 -0500] scrogson: ah, you're messing with me
[2012-11-13 03:40:24 -0500] yfeldblum: scrogson, you can have exactly two types of entries in a run-list: recipes and roles
[2012-11-13 03:40:29 -0500] bmcgee: Hey I'm having issues with passenger. Trying what I think is a very simple install but I'm getting issues. Gist is here: https://gist.github.com/4063792
[2012-11-13 03:40:32 -0500] chefologist: hi, I am trying to copy knife.rb from my mac to a remote vagrant server with the following command: scp knife.rb vagrant@192.168.107:~/ -p 22221
[2012-11-13 03:40:43 -0500] scrogson: bmcgee: ok, thanks
[2012-11-13 03:41:00 -0500] chefologist: getting response 22221: no such file or directory
[2012-11-13 03:41:06 -0500] chefologist: please assist :)
[2012-11-13 03:41:52 -0500] bmcgee: thx scrogson
[2012-11-13 03:42:31 -0500] bemu: I think you guys got your wires crossed.
[2012-11-13 03:42:32 -0500] scrogson: bmcgee: oops, that was meant for yfeldblum
[2012-11-13 03:42:32 -0500] juliancdunn: chefologist: scp takes capital P as the port parameter?
[2012-11-13 03:42:40 -0500] bmcgee: ah balls :)
[2012-11-13 03:42:42 -0500] bemu: yah, there ya go.
[2012-11-13 03:43:48 -0500] bemu: bmcgee: Why are you using passenger?
[2012-11-13 03:44:15 -0500] bmcgee: trying to put together a rails stack
[2012-11-13 03:44:22 -0500] bmcgee: should i not be using passenger?
[2012-11-13 03:44:26 -0500] bemu: I can't help w/ passenger, but I would definitely encourage you to use unicorn over passenger.
[2012-11-13 03:44:33 -0500] chefologist: now tried knife.rb vagrant@192.168.1.107:~/ -P 22221
[2012-11-13 03:45:05 -0500] chefologist: same error: 22221 No such file or directory
[2012-11-13 03:45:31 -0500] juliancdunn: chefologist: scp -P 22221 knife.rb vagrant@whatever
[2012-11-13 03:45:39 -0500] juliancdunn: "man scp" :-)
[2012-11-13 03:45:44 -0500] bmcgee: I couldn't figure out how to get ssl going with unicorn. I've been able to get everything working manually with nginx + passenger in the past, trying to replicate it with chef
[2012-11-13 03:45:55 -0500] bmcgee: i'm open to easier solutions however
[2012-11-13 03:46:07 -0500] bemu: Pretty sure unicorn does not do SSL, you'd do that at the nginx layer.
[2012-11-13 03:46:13 -0500] chefologist: juliancdunn > YOU LEGEND!
[2012-11-13 03:46:45 -0500] bmcgee: any examples of this i could look at? (wishful thinking)
[2012-11-13 03:46:54 -0500] bemu: for nginx?
[2012-11-13 03:47:02 -0500] bmcgee: nginx + unicorn with ssl
[2012-11-13 03:47:07 -0500] bemu: hmm.
[2012-11-13 03:47:15 -0500] rafaelmagu: nginx for ssl offloading is the way to go
[2012-11-13 03:47:27 -0500] bmcgee: setting up unicorn is easy, application_ruby does that quite easily
[2012-11-13 03:47:27 -0500] bemu: I can get you one when I get home, if no one else can.
[2012-11-13 03:47:27 -0500] bemu: Agreed.
[2012-11-13 03:47:27 -0500] bmcgee: it's the extra nginx secret sauce for ssl i'm unsure of
[2012-11-13 03:47:29 -0500] bemu: oh, that's super easy
[2012-11-13 03:47:32 -0500] rafaelmagu: That's easy
[2012-11-13 03:47:35 -0500] Glace: ELB is also good for ssl offloading :0
[2012-11-13 03:47:41 -0500] rafaelmagu: Glace: true
[2012-11-13 03:47:51 -0500] rafaelmagu: If you're on AWS, ELB makes it even simpler
[2012-11-13 03:47:52 -0500] bemu: ELB is a disgrace.
[2012-11-13 03:48:01 -0500] bemu: I would not encourage anyone to use it.
[2012-11-13 03:48:01 -0500] Glace: haha bemu: why?
[2012-11-13 03:48:09 -0500] rafaelmagu: bemu: it works fine for us here
[2012-11-13 03:48:16 -0500] Glace: I have over 10 ELB in prod
[2012-11-13 03:48:18 -0500] juliancdunn: works for us too
[2012-11-13 03:48:20 -0500] Glace: never had any problems
[2012-11-13 03:48:22 -0500] Glace: and its cheap
[2012-11-13 03:48:29 -0500] bemu: How closely do you monitor your traffic?
[2012-11-13 03:48:40 -0500] bmcgee: i don't want to dependent on ELB, I'm attempting to design my setup so i can move it to EC2, rackspace or whichever provider if i wanted (again, maybe wishful thingin)
[2012-11-13 03:48:43 -0500] rafaelmagu: Not very
[2012-11-13 03:48:43 -0500] Glace: Closely
[2012-11-13 03:48:50 -0500] bemu: I lost 1/3 of my traffic for hours one day, that was the breaking point for me.
[2012-11-13 03:48:58 -0500] rafaelmagu: Never had any issue
[2012-11-13 03:49:06 -0500] Glace: Only thing I noticed.. is when you have a spike it takes a few minutes to scale up/out on their backend
[2012-11-13 03:49:08 -0500] rafaelmagu: Customers around the clock using it without any downtime
[2012-11-13 03:49:18 -0500] rafaelmagu: Granted
[2012-11-13 03:49:24 -0500] rafaelmagu: My traffic is smallish
[2012-11-13 03:49:29 -0500] Glace: Ya never had any traffic lost or anything
[2012-11-13 03:49:37 -0500] bemu: We have a lot of traffic, and it's important not to lose it, so was a no-go.
[2012-11-13 03:49:38 -0500] Glace: I have pretty good straffic
[2012-11-13 03:49:45 -0500] rafaelmagu: I still have an nginx load-balancer in a DC we operate as well
[2012-11-13 03:50:04 -0500] bemu: I did use it for months w/o a problem, but the lack of visibility is rough. They don't even update the dash when they have issues.
[2012-11-13 03:50:06 -0500] Glace: We have over 50k page hit a day
[2012-11-13 03:50:19 -0500] bemu: Yeah, we're operating at a scale that is very different from yours.
[2012-11-13 03:50:30 -0500] Glace: hehe :0
[2012-11-13 03:50:31 -0500] bemu: it probably is fine for low traffic stuff.
[2012-11-13 03:50:36 -0500] rafaelmagu: Yeah
[2012-11-13 03:50:50 -0500] Glace: I have seen an article on tripadvisor testing it
[2012-11-13 03:50:52 -0500] bemu: Be aware, also, that it does munge with headers.
[2012-11-13 03:50:55 -0500] Glace: it seemed ok
[2012-11-13 03:51:00 -0500] rafaelmagu: I'm getting around ~1500 hits/minute, so it's nothing at all on it.
[2012-11-13 03:51:15 -0500] bemu: We have a bunch of partners who use ELB as well.
[2012-11-13 03:51:33 -0500] rafaelmagu: bemu: got any links to reports on the header munging?
[2012-11-13 03:51:36 -0500] bmcgee: disagreements to one side if someone wants to hack together a quick example with application_ruby for a simple rails app with unicorn + nginx for ssl termination and load balancing i would be very grateful :) been hacking around for a few days on this and losing the will to live
[2012-11-13 03:51:41 -0500] Glace: Have you tried the eurka stuff from netflix?
[2012-11-13 03:51:43 -0500] bemu: rafaelmagu: No, I tested it myself.
[2012-11-13 03:51:53 -0500] Glace: eureka..
[2012-11-13 03:51:58 -0500] bemu: bmcgee: I can send you an example later tonight.
[2012-11-13 03:52:03 -0500] bmcgee: sweet
[2012-11-13 03:52:15 -0500] bemu: rafaelmagu: Specifically, it adds keep-alive related headers, even if you specifically set them otherwise.
[2012-11-13 03:52:28 -0500] rafaelmagu: bemu: Ah, interesting
[2012-11-13 03:52:36 -0500] bemu: again, probably no issue for most people.
[2012-11-13 03:52:37 -0500] Glace: mbcgee.. I can ask my job if we can opensource our stuff
[2012-11-13 03:52:48 -0500] Glace: we have a pretty heavy cookbook.. for a rails app with unicorn and nginx
[2012-11-13 03:52:52 -0500] bemu: for us, it allowed us to overlook an issue. , so that was not good.
[2012-11-13 03:52:53 -0500] Glace: it deployes from a to z
[2012-11-13 03:52:58 -0500] Glace: deploys
[2012-11-13 03:52:59 -0500] bmcgee: thats would be very nice
[2012-11-13 03:53:13 -0500] rafaelmagu: bemu: We do like keep-alives, though, so that wouldn't affect us
[2012-11-13 03:53:27 -0500] Glace: well.. we use nginx cookbook and other stuff.. but all the application related stuff is in that cookbook
[2012-11-13 03:53:36 -0500] bmcgee: btw i'm relatively new to both rails and chef so bear with me if i ask stupid questions. I generally try not to ask the same stupid question twice
[2012-11-13 03:53:46 -0500] bemu: np bmcgee.
[2012-11-13 03:53:57 -0500] rafaelmagu: bmcgee no such thing as a stupid question
[2012-11-13 03:54:00 -0500] bemu: I don't do a lot of rails stuff these days, that's why you have to wait. It's a personal project.
[2012-11-13 03:54:04 -0500] rafaelmagu: bmcgee except when it's a stupid question
[2012-11-13 03:54:06 -0500] rafaelmagu: :P
[2012-11-13 03:54:39 -0500] bmcgee: i have everything to the point where i can drop on mysql, deploy the app, even configure unicorn. It's the ssl which is pretty crucial but at the moment both nginx and apache via chef looks like voodoo
[2012-11-13 03:54:58 -0500] Glace: really?
[2012-11-13 03:55:01 -0500] bemu: bmcgee: It is a very simple configuration to enable SSL, I just don't have it on hand.
[2012-11-13 03:55:10 -0500] bemu: Actually.
[2012-11-13 03:55:13 -0500] Glace: for me its like.. put the nginx recipe and mod recipes in the role and it works :0
[2012-11-13 03:55:27 -0500] Glace: didnt have to do any voodoo
[2012-11-13 03:55:41 -0500] bmcgee: how did you add the site specific config
[2012-11-13 03:55:51 -0500] bmcgee: dropping nginx on is easy
[2012-11-13 03:56:11 -0500] bmcgee: configuring it with the certs etc for the site, thats the bit i'm scratching my head on. Probably lack of understanding of chef more than anything
[2012-11-13 03:56:39 -0500] bemu: You just need to add two server definitions.
[2012-11-13 03:56:44 -0500] bemu: one for 443, one for 80
[2012-11-13 03:56:45 -0500] Glace: oh well.. I use ELB for offloading so
[2012-11-13 03:56:57 -0500] Glace: didnt have to do anything
[2012-11-13 03:57:12 -0500] Glace: the site specific config.. I added it to my app cookbook
[2012-11-13 03:57:14 -0500] bemu: in the 443 one, add the ssl on; ssl_certificate, ssl_certificate_key  stuff
[2012-11-13 03:57:36 -0500] bemu: That's really all you have to do, then just proxy_pass at the end
[2012-11-13 03:58:16 -0500] bemu: Let me know if you have any questions on that -- but there isn't much more to it.
[2012-11-13 03:58:49 -0500] coderanger: fujin: Did you get your community site issues sorted?
[2012-11-13 03:58:55 -0500] coderanger: If not I can go kick the cache in the face
[2012-11-13 03:59:07 -0500] bmcgee: I'll have another crack at it and let you know
[2012-11-13 04:16:48 -0500] scrogson: does knife-solo work with data bags yet?
[2012-11-13 04:18:08 -0500] scrogson: ah, I see chef-solo 0.10.4 now works with data bags
[2012-11-13 04:21:20 -0500] coderanger: scrogson: Yes, though there is little point since there is no functional difference between data bags and node attrs in solo
[2012-11-13 04:21:34 -0500] coderanger: Sometimes handy for using community cookbooks, but many of those need search anyway
[2012-11-13 04:22:06 -0500] scrogson: ok...yeah, I'm trying to get my head around all of this stuff
[2012-11-13 04:26:46 -0500] scrogson: coderanger: so you say just use the node.json file for that stuff?
[2012-11-13 04:27:35 -0500] coderanger: scrogson: Its all just JSON files sitting on disk, no functional distinction. If it makes it easier for your brain to use the data_bag_item API for something go for it
[2012-11-13 04:27:55 -0500] scrogson: ok
[2012-11-13 04:54:12 -0500] Paul_K: hey all, i've seen a few chat items about this error:
[2012-11-13 04:54:13 -0500] Paul_K: Error Syncing Cookbooks
[2012-11-13 04:54:26 -0500] Paul_K: Unexpected Error: ----------------- EOFError: end of file reached
[2012-11-13 04:54:46 -0500] Paul_K: I've cloned my chef server and upgraded to 10.16.1
[2012-11-13 04:54:49 -0500] Paul_K: sorry.2
[2012-11-13 04:55:05 -0500] Paul_K: and also upgraded the test client to 10.16.2
[2012-11-13 04:56:00 -0500] Paul_K: I have also deleted and re-uploaded all the cookbooks in the role of interest, though at the moment I am just trying to run what we call "wbx-basics"
[2012-11-13 04:57:18 -0500] Paul_K: is there something I should look for in chef.log to illuminate anything?
[2012-11-13 05:09:02 -0500] Paul_K: pastebin is here:
[2012-11-13 05:09:03 -0500] Paul_K: http://pastebin.com/wE4qnQpt
[2012-11-13 05:09:33 -0500] chefologist: Hi, I run knife cookbook upload ... get error ... knife: command not found ... assistance would be fantastico
[2012-11-13 05:09:45 -0500] martinisoft: Guess I missed something with the tickets site
[2012-11-13 05:10:00 -0500] martinisoft: Do I mark tickets with patches as "Fix Provided"?
[2012-11-13 05:11:03 -0500] martinisoft: Not sure if there are any Linode fans out there: http://tickets.opscode.com/browse/OHAI-418 :)
[2012-11-13 05:11:13 -0500] chefologist: all good, didn't install chef yet
[2012-11-13 05:19:55 -0500] chefologist: Hi, I ran knife cookbook upload -a , however I don't see any of the cookbooks in my Hosted-chef account ... any ideas pretty please
[2012-11-13 05:30:26 -0500] chefologist: knife cookbook upload apt ERROR: Could not find cookbook apt in your cookbook path, skipping it ERROR: Failed to upload 1 cookbook.
[2012-11-13 05:34:01 -0500] chefologist: any assistance would be great
[2012-11-13 05:43:31 -0500] coderanger: chefologist: Confirm that you set the cookbook path in knife.rb correctly
[2012-11-13 05:43:53 -0500] coderanger: or rather, it isn't set correctly, check why :)
[2012-11-13 05:44:01 -0500] chefologist: ok checking
[2012-11-13 05:45:44 -0500] chefologist: all in current_dir
[2012-11-13 05:48:44 -0500] chefologist: chef_server_url may be incorrect
[2012-11-13 05:49:13 -0500] coderanger: It should be currentdir/cookbooks usually
[2012-11-13 05:49:50 -0500] chefologist: ["#{current_dir}/../cookbooks"]
[2012-11-13 05:50:32 -0500] coderanger: Why the ..?
[2012-11-13 05:51:43 -0500] chefologist: my knife.rb has been downloaded from hosted-chef and not altered
[2012-11-13 05:51:55 -0500] coderanger: Hmm, that should work generally
[2012-11-13 05:52:16 -0500] coderanger: I would throw a -l debug on it and get some tasty verbose output :)
[2012-11-13 05:52:49 -0500] chefologist: ok I removed .. and now it uploads correctly
[2012-11-13 05:52:57 -0500] chefologist: let me check hosted chef
[2012-11-13 05:53:16 -0500] chefologist: yep apt is now in my hosted chef
[2012-11-13 05:53:41 -0500] chefologist: interesting that it pulled down my knife.rb with the ..
[2012-11-13 05:53:52 -0500] coderanger: What is the path to the knife.rb?
[2012-11-13 05:54:01 -0500] coderanger: It is supposed to go in .chef/knife.rb
[2012-11-13 05:54:07 -0500] coderanger: relative to the root of the chef repo
[2012-11-13 05:54:23 -0500] coderanger: so ls . ==> .chef cookbooks roles etc
[2012-11-13 06:03:29 -0500] chefologist: thanks @coderanger
[2012-11-13 06:34:54 -0500] BryanWB_: ohai chefs!
[2012-11-13 07:36:58 -0500] ssd7: Hey all
[2012-11-13 07:43:13 -0500] BryanWB_: ssd7: hey dude, have u seen my blog post?
[2012-11-13 07:50:47 -0500] ssd7: BryanWB_: Not yet, reading now actually :)
[2012-11-13 07:51:04 -0500] BryanWB_: ssd7: kewl, would love your feedback
[2012-11-13 07:55:49 -0500] k0rupted: Anyone be able to offer any help with Vagrant in here? I asked in #vagrant just no response... I'm trying to get chef_server provisioning working and having problems with the client validation key. If I specify the key being in the same project path as the VagrantFile is that sufficient? Or do I need to actually copy the key to the VM via shared folders or a shell script?
[2012-11-13 07:58:15 -0500] BryanWB_: k0rupted: i think u have to copy it there but not sure :( haven't used vagrant w/ chef-server
[2012-11-13 07:58:55 -0500] cheeseplus: you don't, you should be able to just point to it in the Vagrantfile
[2012-11-13 07:58:56 -0500] cheeseplus: http://vagrantup.com/v1/docs/provisioners/chef_server.html
[2012-11-13 07:59:30 -0500] cheeseplus: the part about chef.validation_key_path = "validation.pem"
[2012-11-13 08:00:27 -0500] k0rupted: cheeseplus: thats what i've been trying ... is validation.pem my client key, like what I would use with knife in ~/.chef ?
[2012-11-13 08:01:35 -0500] cheeseplus: the validation key and the client key are two different things
[2012-11-13 08:02:45 -0500] k0rupted: so the validation.pem from the chef server in ex: /etc/chef/validation.pem?
[2012-11-13 08:03:41 -0500] cheeseplus: k0rupted: correct, thats where it typically lives and you usually only need that to register a node and have it run things
[2012-11-13 08:04:44 -0500] k0rupted: thats the first thing I tried... copy pasted it into a file named validation.pem in the local folder where the VagrantFile lives, but get that same error msg: INFO: Client key /etc/chef/client.pem is not present - registering
[2012-11-13 08:05:41 -0500] k0rupted: INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate. Ensure that your client key is valid.
[2012-11-13 08:06:49 -0500] k0rupted: hmm... guess copy paste was the issue. tried it again and now I get the client already registered problem. ok... so I guess I just pasted it incorrectly somehow
[2012-11-13 08:07:11 -0500] cheeseplus: yea, you should just need the validation pem
[2012-11-13 08:07:31 -0500] cheeseplus: that will get it registered and create the corresponding client key
[2012-11-13 08:08:58 -0500] ssd7: BryanWB_: Nice post. I definitely think I have a better sense of where you are coming from/how this work flow works.
[2012-11-13 08:09:08 -0500] BryanWB_: ssd7: tks
[2012-11-13 08:15:22 -0500] eugenmayer: Moin
[2012-11-13 08:21:33 -0500] ssd7: Uff.  Some cookbooks cannot be unseen.
[2012-11-13 08:32:38 -0500] ssd7: BryanWB_: So, after playing with rewind for a bit, I definitely see how it can be useful.  I guess I am just more apt to edit the cookbook directly and then deal with conflict resolution later.
[2012-11-13 08:34:12 -0500] ssd7: BryanWB_: Also, re the mailing list thread on partial templates.  I'm a big +1 there; would be happy to help get such a feature off the ground.
[2012-11-13 08:35:00 -0500] BryanWB_: ssd7: that's what i have tried to do in the past, but too often the the "dealing w/ conflict resolution" means i never pull cookbook updates :/
[2012-11-13 08:35:54 -0500] ssd7: BryanWB_: Indeed.
[2012-11-13 08:48:38 -0500] beandip: I'm installing the ohai cookbook and I'd like to set Ohai::Config[:plugin_path] properly.  On my system, the plugin path should be /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/ohai-6.14.0/lib/ohai/plugins/
[2012-11-13 08:48:53 -0500] beandip: or rather, the ohai plugin path installed by chef.
[2012-11-13 08:49:27 -0500] beandip: how can I set that automatically rather than having to set the attribute any time a new version of chef is installed?
[2012-11-13 08:51:13 -0500] beandip: ah, neverminf
[2012-11-13 08:51:19 -0500] beandip: I found the attribute
[2012-11-13 08:51:59 -0500] beandip: [:chef_packages][:ohai][:ohai_root]
[2012-11-13 09:12:31 -0500] nazar: Hello guys
[2012-11-13 09:13:17 -0500] nazar: I was looking for some information, is it possible to run rake task from chef recipe ?
[2012-11-13 09:26:51 -0500] masterkorp: ohai chefs
[2012-11-13 09:27:47 -0500] nazar: Can any one guide me to run rake task from chef recipe
[2012-11-13 09:28:17 -0500] masterkorp: same as you would call it from a ruby script
[2012-11-13 09:28:41 -0500] masterkorp: or use a execute block and run rake task:subtask
[2012-11-13 09:29:56 -0500] nazar: Yes, I tried to use the execute block, actually i have an after_migrate recipe and I want to check if thinking sphinx config exists or not
[2012-11-13 09:30:10 -0500] VolodymyrB: Hi, can any little explain me in ruby, is 'template "authorized_ip" do path "xxx" end', is "template "authorized_ip" method call? is do foreach of previouse method call?
[2012-11-13 09:30:11 -0500] nazar: If it does not exists want to run the rake task and then move the config file to shared folder
[2012-11-13 09:30:56 -0500] nazar: So I used the execute block and then end of the execute block move the file. but that move file runs before the task finish
[2012-11-13 09:31:41 -0500] nazar: This is my complete code http://pastie.org/5370714
[2012-11-13 09:31:46 -0500] masterkorp: does rake fork on the background when is it executed ?
[2012-11-13 09:32:06 -0500] nazar: No it does not show any rake output on console
[2012-11-13 09:32:28 -0500] masterkorp: so it forks ?
[2012-11-13 09:33:04 -0500] masterkorp: do you get your terminal back before the rake task is finished ?
[2012-11-13 09:34:06 -0500] nazar: On terminal it does not show any rake related output, it says running recipe and then show the exception that file does not exists
[2012-11-13 09:35:40 -0500] masterkorp: I MEAN YOU ARE RUNING RAKE MANUALLY
[2012-11-13 09:36:56 -0500] nazar: Yes I am running the rake from execute block with command "bundle exec rake"
[2012-11-13 09:37:06 -0500] nazar: Here is the output of of the chef
[2012-11-13 09:37:07 -0500] nazar: http://pastie.org/5370728
[2012-11-13 10:01:31 -0500] drrk: What is the reccomended way to install chef server on Ubuntu 12.04LTS ?
[2012-11-13 10:08:21 -0500] masterkorp: drrk: repos
[2012-11-13 10:08:28 -0500] masterkorp: opscode repository
[2012-11-13 10:09:47 -0500] drrk: not gems or chefclient then?
[2012-11-13 10:10:10 -0500] drrk: 12.04 isn't listed at supported by the repos
[2012-11-13 10:10:17 -0500] drrk: only up to 11.10
[2012-11-13 10:11:38 -0500] masterkorp: well ubuntu server its just a debian clone with the name changed so
[2012-11-13 10:12:02 -0500] masterkorp: it works on latest debian, i doubt it would not in ubuntu
[2012-11-13 10:12:46 -0500] drrk: that's so far from the truth it's uncanny, but they do seem to have precise repos
[2012-11-13 10:12:57 -0500] masterkorp: no its not
[2012-11-13 10:14:20 -0500] drrk: ubuntu server has a) a different kernel, b) much mroe uptodate packages c) packages that are not in debian by default d) standard configuration that is quite different (eg apparmour)
[2012-11-13 10:16:42 -0500] workmad3: drrk: don't forget e) different options for package configuration (which has bitten me previously)
[2012-11-13 10:17:30 -0500] drrk: indeed
[2012-11-13 10:18:02 -0500] workmad3: drrk: I tend to go for the gem bootstrap approach to install rather than repos btw
[2012-11-13 10:18:51 -0500] drrk: well i'm trying packages now, i'll see how it goes, I can always rebuild again
[2012-11-13 10:19:10 -0500] workmad3: :)
[2012-11-13 10:20:43 -0500] drrk: this is aalready a rebuild as things went rather funky when I relocated the server to a different network rnage
[2012-11-13 10:21:59 -0500] Nopik: i'm trying to write nginx recipe which will work nicely with nginx modules.. has anyone seen such recipe? the problem is that whenever you want to add module to nginx, you need to ./configure and build it. So, each time you add/remove module you need to trigger build recipe - and you need to store the list of previous module used, so you can detect changes
[2012-11-13 10:34:33 -0500] gyre008: do I need to Include cookbook libraries in particular cookbook's recipes or will they be loaded automatically ?
[2012-11-13 10:34:57 -0500] masterkorp: gyre008: they are loaded when the default recipe is run iirc
[2012-11-13 10:35:05 -0500] adbla: any ideas why chef-client splay is not working correctly? something weird happens after daily crontab (mostly logrotate)...so all nodes suddenly connect to chef server and they timeout too often, after 8hours or so it starts to normalize and splay seem to work
[2012-11-13 10:35:15 -0500] masterkorp: that aplies to lwrps too
[2012-11-13 10:35:28 -0500] gyre008: masterkorp, and if the default recipe is not in the run list ?
[2012-11-13 10:39:33 -0500] masterkorp: i think its not available then
[2012-11-13 10:39:37 -0500] masterkorp: i never tried tough
[2012-11-13 11:03:16 -0500] UukGoblin: https://gist.github.com/d7687ebe1ea130fc4345#comments
[2012-11-13 11:03:53 -0500] UukGoblin: question: shouldn't the defaults arguments to define blocks be deep-copied rather than referenced?
[2012-11-13 11:04:07 -0500] UukGoblin: in other words, is this a chef bug, or a recipe bug? ;-]
[2012-11-13 11:06:41 -0500] maxmanders: Could somebody take a look at: https://gist.github.com/4065239 - I'm installing a Windows service with NSSM, then making sure the service doesn't start with the service resource; then the idea is I use a template notification to delay starting the service until the end of the run.
[2012-11-13 11:07:02 -0500] maxmanders: The service is installed, as is the template file, but the service never starts - nothing obvious in my logs.  Any ideas?
[2012-11-13 11:07:58 -0500] erikh: BryanWB_: around?
[2012-11-13 11:09:11 -0500] gyre008: is --why-run a dry run ?
[2012-11-13 11:09:13 -0500] gyre008: mm
[2012-11-13 11:12:44 -0500] UukGoblin: omg, I just read my question - let me rephrase it: Shouldn't the "define" blocks' default arguments be deep-copied?
[2012-11-13 11:13:57 -0500] _rc: UukGoblin: well there's nothing in the docs that suggest they would be
[2012-11-13 11:17:55 -0500] UukGoblin: _rc, so you reckon it's a recipe bug?
[2012-11-13 11:18:06 -0500] zts: UukGoblin: That does seem to violate the principle of least surprise
[2012-11-13 11:19:27 -0500] zts: UukGoblin: does it do the right thing if you use "Array.new(['1'])" as the default value in the definition?
[2012-11-13 11:19:43 -0500] zts: (without the double quotes)
[2012-11-13 11:20:59 -0500] UukGoblin: zts, nope
[2012-11-13 11:21:13 -0500] UukGoblin: I mean, it behaves the same.
[2012-11-13 11:21:26 -0500] zts: alas
[2012-11-13 11:21:29 -0500] UukGoblin: looks like the Array is created when the definition is evaluated
[2012-11-13 11:23:25 -0500] UukGoblin: and imho, it should get copied (if ruby supports copying... it should, no?)
[2012-11-13 11:23:53 -0500] UukGoblin: .clone
[2012-11-13 11:24:37 -0500] _rc: I think if you want it to be cloned that's something your definition should take care of for itself
[2012-11-13 11:25:46 -0500] zts: _rc: perhaps.  The contrary opinion is no less valid though, and the behaviour isn't documented either way
[2012-11-13 11:25:53 -0500] zts: UukGoblin: it'd be fair to open a ticket about that, IMHO
[2012-11-13 11:26:48 -0500] UukGoblin: zts, cool thanks
[2012-11-13 11:28:11 -0500] UukGoblin: zts, I'll do that in a bit
[2012-11-13 11:29:18 -0500] zts: UukGoblin: cool, thankyou!
[2012-11-13 11:32:10 -0500] VolodymyrB: please explain what 'do' statement do in this case https://gist.github.com/4065309
[2012-11-13 11:32:58 -0500] UukGoblin: actually, not sure if I need an opscode account for that... there's some licensing issues we wanted our lawyers to have a look at
[2012-11-13 11:33:13 -0500] UukGoblin: but will get back to you on that, I think a github pullreq is the easy way
[2012-11-13 11:33:32 -0500] UukGoblin: (or just issue)
[2012-11-13 11:34:29 -0500] _rc: VolodymyrB: it introduces the block that configures the service type resource
[2012-11-13 11:36:24 -0500] VolodymyrB: _rc: thanks, do 'do' - 'end' statements equal foreach or its a method?
[2012-11-13 11:36:36 -0500] zts: UukGoblin: you do need an account to create issues on tickets.opscode.com, but it's only for that system - it doesn't require a CLA, or a Hosted Chef account
[2012-11-13 11:36:46 -0500] zts: UukGoblin: doesn't look like you even need to agree to anything: http://tickets.opscode.com/secure/Signup!default.jspa
[2012-11-13 11:37:00 -0500] _rc: VolodymyrB: it's a ruby feature called blocks
[2012-11-13 11:37:20 -0500] VolodymyrB: _rc: thanks, will search
[2012-11-13 11:40:50 -0500] UukGoblin: we do, actually, have a Hosted Chef account
[2012-11-13 11:48:27 -0500] BryanWB_: erikh: here i m
[2012-11-13 11:50:19 -0500] UukGoblin: zts, cool yeah, you're right, the CCLA license is just for pushing code
[2012-11-13 11:50:30 -0500] UukGoblin: (CCLA or sth like that)
[2012-11-13 11:52:08 -0500] chefologist: hi I am trying to download cookbooks from the opscode community using wget http://community.opscode.com/cookbooks/redis/versions/3_0_4/downloads, however it is not working.  Is there a better way?
[2012-11-13 11:52:13 -0500] chefologist: thanks in advance
[2012-11-13 11:53:25 -0500] erikh: BryanWB_: mind reading some documentation I wrote?
[2012-11-13 11:53:27 -0500] drrk: knife cookbook site download COOKBOOK [VERSION] (options)
[2012-11-13 11:53:30 -0500] erikh: I could really use some external reflection
[2012-11-13 11:53:36 -0500] BryanWB_: erikh: don't mind at all
[2012-11-13 11:53:39 -0500] erikh: cool
[2012-11-13 11:53:42 -0500] erikh: I'll /msg you
[2012-11-13 11:54:07 -0500] chefologist: any assistance would be great
[2012-11-13 11:55:41 -0500] specialsauce: chefologist: drrk already responded to you
[2012-11-13 11:55:49 -0500] specialsauce: question: using the gem_package provider some gems seem to reinstall on each run, anyone else hit this?
[2012-11-13 11:56:38 -0500] rcovarru: Hi everyone! I have a question: Can use a function from cookbook library inside a template?
[2012-11-13 11:57:08 -0500] chefologist: newbie, thanks drrk, once downloaded the gz, how do I extract it? thanks
[2012-11-13 11:58:01 -0500] drrk: chefologist: tar -xf
[2012-11-13 11:59:52 -0500] chefologist: command not found <drrk>
[2012-11-13 12:01:20 -0500] masterkorp: Guys, is there any LWRP tutorial that you would recomend to a person that is somewhat familiar with ruby?
[2012-11-13 12:01:24 -0500] masterkorp: the wiki is meh
[2012-11-13 12:04:52 -0500] UukGoblin: zts, http://tickets.opscode.com/browse/CHEF-3602
[2012-11-13 12:09:58 -0500] UukGoblin: hmm, can't seem to find the docs for the "define" thingy... I thought it was a LWRP, but it seems that LWRPs are actually what I thought were the "heavy" versions
[2012-11-13 12:10:17 -0500] chefologist: <drrk> you rock
[2012-11-13 12:10:45 -0500] zts: UukGoblin: thanks!  and the docs are here: http://wiki.opscode.com/display/chef/Definitions
[2012-11-13 12:15:09 -0500] UukGoblin: thanks :-)
[2012-11-13 12:15:31 -0500] UukGoblin: oh, right, they're NOT resources... meh, my ticket might be wrong then
[2012-11-13 12:17:08 -0500] gyre008: Im trying to figure out how to load cookbook libraries in particular Chef recipesanyone ideas ? I'm jus testing this out so I have a lib file looking like this: https://gist.github.com/4065471
[2012-11-13 12:17:20 -0500] gyre008: I just can't seem to figure out how to load it in the recipe..
[2012-11-13 12:18:10 -0500] gyre008: I'm thinking class Chef::Recipe
[2012-11-13 12:18:10 -0500] gyre008:   include GcRepl::ReplicationHelper
[2012-11-13 12:18:11 -0500] gyre008: end
[2012-11-13 12:20:07 -0500] gyre008: that seems to have worked...
[2012-11-13 12:20:07 -0500] gyre008: cool
[2012-11-13 12:21:20 -0500] zts: gyre008: that's also what the docs suggest :) http://wiki.opscode.com/display/chef/Libraries
[2012-11-13 12:21:40 -0500] gyre008: zts, yea thats where I found it...
[2012-11-13 12:22:53 -0500] gyre008: I noticed a strange thing though
[2012-11-13 12:23:16 -0500] gyre008: it looks like I can't use those library functions from inside the resource DSL ?
[2012-11-13 12:24:40 -0500] gyre008: like when I'm in resource https://gist.github.com/4065471
[2012-11-13 12:24:54 -0500] gyre008: I guess I need to mix them into Resource too ?
[2012-11-13 12:26:29 -0500] gyre008: mm
[2012-11-13 12:27:37 -0500] gyre008: yeah that has workedso if you want to use your cookbook libs in resource DSL you need to mix them in to Chef::Resource
[2012-11-13 12:33:31 -0500] erikh: that monkey patched every chef recipe in memory
[2012-11-13 12:35:11 -0500] erikh: ... don't do that if you can avoid it. your future self will thank you.
[2012-11-13 12:36:18 -0500] erikh: if it helps, for libraries I tend to use class methods (def self.my_thing) and pass in the node object if necessary
[2012-11-13 12:36:27 -0500] erikh: then in the recipe, MyLibrary.my_thing(node)
[2012-11-13 12:36:46 -0500] erikh: that way I don't piss the rest of the neighborhood off because I overwrote something they depended on
[2012-11-13 12:37:46 -0500] erikh: and use the lwrp syntax for writing resources unless you absolutely have to use something more elaborate, and even then, *inherit* from Chef::Resource.
[2012-11-13 12:38:01 -0500] erikh: sorry if I seem heavy-handed, a bit tired. but I think you'll thank me later.
[2012-11-13 12:40:44 -0500] rcovarru: Question: Can use a function from cookbook library inside a template?
[2012-11-13 12:40:58 -0500] erikh: yeah
[2012-11-13 12:41:04 -0500] erikh: libraries are global, more or less
[2012-11-13 12:41:28 -0500] erikh: as long as it's in a cookbook in the run_list or brought in by a depends statement in metadata.rb
[2012-11-13 12:41:31 -0500] rcovarru: and how I do it?
[2012-11-13 12:41:45 -0500] erikh: I actually keep all my libraries in a cookbook that has nothing but libraries, and then my "real" cookbooks depend on that.
[2012-11-13 12:41:49 -0500] erikh: just use it?
[2012-11-13 12:43:10 -0500] rcovarru: I have a cookbook like that.. with files only in library. this is loaders first on all roles and run_list's :P
[2012-11-13 12:44:14 -0500] rcovarru: but I have not been use it in the template. I need call the function in some special way?
[2012-11-13 12:46:37 -0500] erikh: no.
[2012-11-13 12:46:47 -0500] erikh: <%= MyLib.do_something %>
[2012-11-13 12:47:04 -0500] erikh: it's just ruby.
[2012-11-13 13:07:09 -0500] intinig: hi guys
[2012-11-13 13:07:25 -0500] intinig: what could be the reason for a node to ignore a recipe that is in its role's run list?
[2012-11-13 13:07:40 -0500] masterkorp: how do o mean ignore ?
[2012-11-13 13:07:48 -0500] masterkorp: chef output ?
[2012-11-13 13:07:57 -0500] masterkorp: :info level at least
[2012-11-13 13:08:19 -0500] intinig: masterkorp: 1 sec :)
[2012-11-13 13:08:59 -0500] intinig: [2012-11-13T13:08:26+00:00] INFO: Run List is [role[vdp-web], role[vdp-db], role[blog-vdp], recipe[basic-conf::s3-backup]]
[2012-11-13 13:08:59 -0500] intinig: [2012-11-13T13:08:26+00:00] INFO: Run List expands to [basic-conf, apache2, apache2::vhost, mysql::client, mysql::ruby, php, php::module_apc, php::module_memcache, php::module_mysql, php::module_ioncube, php::module_gd, php::module_mcrypt, mysql::server_ec2, basic-conf::s3-backup]
[2012-11-13 13:09:10 -0500] masterkorp: do a paste please
[2012-11-13 13:09:24 -0500] masterkorp: on gist, full output
[2012-11-13 13:09:27 -0500] intinig: https://gist.github.com/4065688
[2012-11-13 13:09:30 -0500] intinig: ok
[2012-11-13 13:12:42 -0500] intinig: https://gist.github.com/4065703
[2012-11-13 13:13:12 -0500] intinig: this is the role https://gist.github.com/4065705
[2012-11-13 13:13:44 -0500] intinig: the last recipe is basic-conf::databases, but it's ignored
[2012-11-13 13:13:49 -0500] itchyouch: For those of you with lots of files to deploy, do you usually package the files (a la fpm) or write a cookbook recipe to deploy them say straight from version control?
[2012-11-13 13:15:22 -0500] masterkorp: itchyouch: its runing
[2012-11-13 13:15:31 -0500] masterkorp: intinig: ^
[2012-11-13 13:15:46 -0500] masterkorp: intinig: last 10 lines https://gist.github.com/4065703
[2012-11-13 13:15:49 -0500] masterkorp: its there
[2012-11-13 13:16:54 -0500] intinig: masterkorp: I can't see it :)
[2012-11-13 13:16:57 -0500] intinig: line number?
[2012-11-13 13:18:50 -0500] intinig: itchyouch: for applications I usually use capistrano to deploy, I just use chef to set up the machine so it is ready to accept the deployment via cap
[2012-11-13 13:22:12 -0500] masterkorp: intinig: line 133
[2012-11-13 13:22:36 -0500] intinig: that's basic-conf::s3-backup
[2012-11-13 13:22:46 -0500] intinig: the one being ignored is basic-conf::databases
[2012-11-13 13:25:15 -0500] masterkorp: intinig: that one isn't on the run list
[2012-11-13 13:25:30 -0500] intinig: masterkorp: that's my point :)
[2012-11-13 13:25:33 -0500] intinig: if you look at the role file
[2012-11-13 13:25:34 -0500] masterkorp: intinig: tip: use roles as json
[2012-11-13 13:25:35 -0500] intinig: it's in the run list
[2012-11-13 13:28:13 -0500] itchyouch: Mhmm...  Thanks intinig.  For me we have lots of scripts and configs to deploy, so it's not really just a single application per se...
[2012-11-13 13:28:22 -0500] itchyouch: I'll look into capos tramp
[2012-11-13 13:28:34 -0500] itchyouch: Capistrano.  Damn autocorrects
[2012-11-13 13:31:12 -0500] masterkorp: itchyouch: doing you guys use CI ?
[2012-11-13 13:31:47 -0500] masterkorp: i have a CI server, that makes debs and then just use apt
[2012-11-13 13:34:34 -0500] itchyouch: masterkorp: Not really.
[2012-11-13 13:34:50 -0500] itchyouch: It's more for random scripts all over the place to do operational tasks
[2012-11-13 13:35:37 -0500] itchyouch: Basically a semi-unified framework of shell scripts and a bunch of config files that configure those tools on an environment specific way
[2012-11-13 13:36:42 -0500] itchyouch: masterkorp: One suggestion I was given was to package the various scripts into rpms and debs, then just install them.
[2012-11-13 13:36:51 -0500] masterkorp: well if timing does not matter you can use chef for that
[2012-11-13 13:37:12 -0500] itchyouch: Timing matters to an extent.
[2012-11-13 13:37:40 -0500] itchyouch: But we have maintenance windows in which to do what's needed to be done
[2012-11-13 13:38:26 -0500] masterkorp: if you need to deploy those scripts within a small maintenance window
[2012-11-13 13:38:34 -0500] masterkorp: chef is not the answer
[2012-11-13 13:39:09 -0500] masterkorp: i've been playing with what i can do with chef and zookeeper to have deploys queued and runing on a exact time
[2012-11-13 13:39:12 -0500] masterkorp: tough
[2012-11-13 13:40:13 -0500] itchyouch: Interesting.  I guess it really depends on the application were deploying
[2012-11-13 13:41:32 -0500] itchyouch: We're in a hard spot where the actual applications themselves are maintained manually, along with all the supporting tools.  I was looking at chef to unify and ease managing the installation of all the supporting toolset
[2012-11-13 13:42:20 -0500] specialsauce: masterkorp: what about the small maintenance window makes chef a poor choice iyo?
[2012-11-13 13:43:08 -0500] itchyouch: Our maintenance window is pretty large.  Luckily we have several hours a nights
[2012-11-13 13:43:41 -0500] itchyouch: specialsauce: I suppose its with new deployments and potential troubleshooting that may need to take places
[2012-11-13 13:44:00 -0500] specialsauce: i don't see why chef couldn't work for you then, there's no reason you have to run chef daemonised or constantly enforcing.
[2012-11-13 13:44:05 -0500] masterkorp: specialsauce: because chef is decentralized by nature
[2012-11-13 13:44:19 -0500] masterkorp: specialsauce: so orchestration of events is harder
[2012-11-13 13:45:10 -0500] specialsauce: but that's a chef+[runbooktool] problem?
[2012-11-13 13:45:21 -0500] specialsauce: not a reason not to use chef
[2012-11-13 13:45:24 -0500] specialsauce: unless i'm missing something
[2012-11-13 13:49:13 -0500] masterkorp: yeas
[2012-11-13 13:52:24 -0500] intinig: I get this warning "WARN: Setting attributes without specifying a precedence is deprecated"
[2012-11-13 13:52:48 -0500] intinig: when using the platform?
[2012-11-13 13:52:51 -0500] intinig: inside a rceipe
[2012-11-13 13:52:58 -0500] intinig: any clue?
[2012-11-13 13:53:02 -0500] intinig: I'm not setting any attribute
[2012-11-13 13:53:13 -0500] masterkorp: http://i.imgur.com/7w4d9.jpg
[2012-11-13 13:53:19 -0500] masterkorp: my camera really sucks
[2012-11-13 13:54:09 -0500] geekbri: Thank god for cleanup_after_converge
[2012-11-13 13:56:30 -0500] geekbri: You can orchestrate things with chef to go off at specific times, you just need to be clever about it since its a pull system not a push system
[2012-11-13 13:56:58 -0500] geekbri: Orchestration of a timed event across a series of servers has never been particularly easy though :)
[2012-11-13 13:59:32 -0500] geekbri: As they say though, there are many ways to skin a cat.
[2012-11-13 13:59:49 -0500] jtimberman: intinig: it should show context about the code its warning, can you post a gist or pastie?
[2012-11-13 14:00:13 -0500] jtimberman: geekbri: thats where a tool like rundeck is beneficial
[2012-11-13 14:00:38 -0500] geekbri: jtimberman: Yup absolutely.  I believe that mcollective works with chef as well doesn't it?
[2012-11-13 14:01:03 -0500] jtimberman: sure
[2012-11-13 14:01:10 -0500] jtimberman: i've never used it myself :)
[2012-11-13 14:01:17 -0500] jtimberman: but there's others here who have
[2012-11-13 14:01:44 -0500] geekbri: There are many ways to do it!  We use chef for our code deployment and it works great, however we have a very unique case which is atypical
[2012-11-13 14:02:06 -0500] geekbri: Additionally if your code is feature aware you can do a deploy with chef sort of like how github does it
[2012-11-13 14:02:18 -0500] geekbri: where it is ok if the code doesn't get rolled out all at once to the web servers.
[2012-11-13 14:02:26 -0500] geekbri: Dealing with migrations though, well thats a different story :)
[2012-11-13 14:03:38 -0500] geekbri: well back to work, zug zug
[2012-11-13 14:06:19 -0500] LinuxHorn: anyone know if something changed with knife rackspace v2 stuff?
[2012-11-13 14:06:28 -0500] LinuxHorn: worked last week, but now i get a fog compute error
[2012-11-13 14:07:13 -0500] LinuxHorn: i've got fog (1.7.0) and knife-rackspace (0.6.2)
[2012-11-13 14:07:31 -0500] geekbri: jtimberman: You will not remember this but ages ago I claimed the newer version of chef-client broke some of my cookbooks.  I found out why / how to fix it.  There is a new function called cleanup_after_converge.  I had been relying on the fact that a resource returned the value of the last expression in the run_action.  This broke my stuff, however as it turns out, you can just define "cleanup_after_converge" and have it return the value.  Thi
[2012-11-13 14:07:32 -0500] geekbri: s fixes things!
[2012-11-13 14:08:04 -0500] jtimberman: LinuxHorn: please gist / pastie the error you're getting, with verbose output (-VV to the knife command)
[2012-11-13 14:09:45 -0500] LinuxHorn: jtimberman: https://gist.github.com/4065944
[2012-11-13 14:11:33 -0500] LinuxHorn: just updated gist with some of the settings from knife.rb
[2012-11-13 14:11:37 -0500] LinuxHorn: refresh to get the changes
[2012-11-13 14:12:25 -0500] LinuxHorn: updated one more time with gem list :)
[2012-11-13 14:18:09 -0500] LinuxHorn: doing a straight curl to the identity auth servers for rackspace works just fine
[2012-11-13 14:21:43 -0500] LinuxHorn: and curls to the v2 url work fine
[2012-11-13 14:21:50 -0500] LinuxHorn: like:  curl -s https://dfw.servers.api.rackspacecloud.com/v2/$account/images/detail -H "X-Auth-Token: $token" | python -m json.tool
[2012-11-13 14:22:15 -0500] LinuxHorn: so it is something with knife
[2012-11-13 14:23:05 -0500] jtimberman: LinuxHorn: could be - i'm not familiar with the rackspace api, but perhaps ssd7 or mattray will be around later, they have worked with it recently.
[2012-11-13 14:23:26 -0500] LinuxHorn: cool
[2012-11-13 14:23:28 -0500] LinuxHorn: thanks jtimberman
[2012-11-13 14:24:27 -0500] gyre008: does shell_out accept :user option i.e. to run it like  shell_out("echo hi", :user => "some_user")
[2012-11-13 14:24:28 -0500] gyre008: ?
[2012-11-13 14:25:02 -0500] LinuxHorn: gyre008: is that to me?
[2012-11-13 14:25:43 -0500] gyre008: LinuxHorn, noto the community here..
[2012-11-13 14:25:50 -0500] LinuxHorn: ok :)
[2012-11-13 14:25:53 -0500] poolpog: hello everyone
[2012-11-13 14:26:01 -0500] poolpog: how are your recipes today?
[2012-11-13 14:27:23 -0500] masterkorp: poolpog: spicy
[2012-11-13 14:27:32 -0500] poolpog: ah
[2012-11-13 14:27:55 -0500] poolpog: usually try to stay away from spicy when it comes to production systems
[2012-11-13 14:28:07 -0500] poolpog: still, spicy can be fun
[2012-11-13 14:28:39 -0500] masterkorp: i hate spicy
[2012-11-13 14:28:45 -0500] masterkorp: makes my ass burn
[2012-11-13 14:29:23 -0500] poolpog: so, I am experimenting with shef... I am making a change to a recipe that I'm pretty sure will work, but I'd like to inspect the change in shef
[2012-11-13 14:29:57 -0500] poolpog: the change is to the source file for a cookbook_file resource...
[2012-11-13 14:30:03 -0500] poolpog: how can I inspect that? assume the recipe is called "mr_shib.rb"
[2012-11-13 14:30:27 -0500] poolpog: node.recipes["mr_shib"].cookbook_file  ?
[2012-11-13 14:30:31 -0500] poolpog: something like that
[2012-11-13 14:30:34 -0500] poolpog: ?
[2012-11-13 14:30:50 -0500] poolpog: this is a problem with my lack of Ruby depth, combined with lack of chef depth
[2012-11-13 14:32:24 -0500] BryanWB_: pry, pry, pry pry  pry
[2012-11-13 14:32:27 -0500] BryanWB_: more pry
[2012-11-13 14:32:34 -0500] poolpog: pry is what? a ruby console?
[2012-11-13 14:32:43 -0500] BryanWB_: ruby debugger
[2012-11-13 14:32:56 -0500] BryanWB_: billion times better than irb
[2012-11-13 14:33:11 -0500] poolpog: ok, so, that sounds great, but I'm looking for some specific ruby-isms to get me over the hump here
[2012-11-13 14:33:14 -0500] BryanWB_: install pry in ur machine
[2012-11-13 14:33:29 -0500] masterkorp: yeah pry is awesome
[2012-11-13 14:33:41 -0500] BryanWB_: then    put ` require 'pry' ; binding.pry `  into your recipe file where u want a break point
[2012-11-13 14:33:43 -0500] poolpog: but how can I use pry in conjunction with chef?
[2012-11-13 14:33:45 -0500] poolpog: and
[2012-11-13 14:33:46 -0500] intinig: guys I am getting crazy here, can anyone help me understand why a recipe is being ignored by chef? :) thx
[2012-11-13 14:34:09 -0500] poolpog: how do I just inspect the value of a recipe's resource attributes?
[2012-11-13 14:34:21 -0500] BryanWB_: r = resources("user[foo]")
[2012-11-13 14:34:31 -0500] BryanWB_: r.home
[2012-11-13 14:34:39 -0500] BryanWB_: r.uid
[2012-11-13 14:34:55 -0500] masterkorp: intinig: do knife role edit yourrole name
[2012-11-13 14:35:03 -0500] BryanWB_: u want pry, i think i have something on my blog about it http://devopsanywhere.blogspot.com
[2012-11-13 14:35:07 -0500] BryanWB_: gtg
[2012-11-13 14:35:23 -0500] masterkorp: BryanWB_: swwet
[2012-11-13 14:35:32 -0500] intinig: masterkorp: done, the recipe is there and it's there even on hosted chef
[2012-11-13 14:36:32 -0500] masterkorp: intinig: does it open in json ?
[2012-11-13 14:36:37 -0500] intinig: yes
[2012-11-13 14:36:39 -0500] masterkorp: is the recipe there ?
[2012-11-13 14:37:08 -0500] masterkorp: Can you show the contects of your recipe
[2012-11-13 14:37:28 -0500] intinig: masterkorp: sure
[2012-11-13 14:38:26 -0500] intinig: masterkorp: btw doing a knife node edit and adding the recipe manually to the run list works. So I guess it's a problem with nods
[2012-11-13 14:38:27 -0500] intinig: nodes
[2012-11-13 14:38:31 -0500] intinig: or roles :)
[2012-11-13 14:38:49 -0500] intinig: https://gist.github.com/0441485e46ef7714cf90
[2012-11-13 14:38:59 -0500] masterkorp: i found problems when using roles with dsl before
[2012-11-13 14:39:13 -0500] masterkorp: so i edit and upload in json format
[2012-11-13 14:39:20 -0500] intinig: masterkorp: everything worked perfectly up to this recipes
[2012-11-13 14:39:23 -0500] intinig: this recipe
[2012-11-13 14:39:28 -0500] intinig: it's driving me crazy
[2012-11-13 14:39:33 -0500] masterkorp: well, i am not sure :(
[2012-11-13 14:39:47 -0500] masterkorp: that's the only tip i can give you
[2012-11-13 14:40:01 -0500] masterkorp: also, you can enable :debug logging
[2012-11-13 14:40:11 -0500] masterkorp: and see the cookbook caching phase
[2012-11-13 14:42:18 -0500] poolpog: BryanWB_, thanks for the help, and blog post, but I need a quick answer now...
[2012-11-13 14:42:41 -0500] poolpog: can anyone give me a quick pointer on how to inspect the attributes of any given recipe in shef?
[2012-11-13 14:42:50 -0500] gyre008: in case people are interested you can do shell_out(command, :user => some_user)
[2012-11-13 14:42:59 -0500] BryanWB_: poolpog:    do  `shef -z `
[2012-11-13 14:43:05 -0500] poolpog: (don't worrk, BryanWB_ , I'll read your blog)
[2012-11-13 14:43:11 -0500] poolpog: did that...
[2012-11-13 14:43:35 -0500] BryanWB_: then that resources("cookbook_file[
[2012-11-13 14:43:36 -0500] poolpog: in like flynn
[2012-11-13 14:43:37 -0500] BryanWB_: trick
[2012-11-13 14:43:45 -0500] poolpog: ok
[2012-11-13 14:44:38 -0500] poolpog: NoMethodError: undefined method `resources' for main:Object
[2012-11-13 14:45:54 -0500] poolpog: BryanWB_, in the parens, what belongs? that's part of the trouble I'm having... the syntax
[2012-11-13 14:46:25 -0500] BryanWB_: r = resources('cookbook_file[/etc/foobar.conf]")
[2012-11-13 14:46:33 -0500] poolpog: k
[2012-11-13 14:47:30 -0500] poolpog: well, I still get "NoMethodError: undefined method `resources' for main:Object"
[2012-11-13 14:47:31 -0500] octo: Hi guys, I notice that "Chef Client" is downloading the collectd source package several thousand times per day. Can anyone tell me what's going on?
[2012-11-13 14:47:32 -0500] poolpog: so
[2012-11-13 14:47:47 -0500] poolpog: am I missing a ruby lib or gem or something?
[2012-11-13 14:47:54 -0500] _rc: octo: you have a cookbook that sucks
[2012-11-13 14:48:09 -0500] poolpog: or am I not using a new enough version of chef/shef?
[2012-11-13 14:48:12 -0500] octo: _rc: Hm?
[2012-11-13 14:48:20 -0500] poolpog: chef > version
[2012-11-13 14:48:20 -0500] poolpog: This is shef, the Chef shell.
[2012-11-13 14:48:21 -0500] poolpog:  Chef Version: 10.12.0
[2012-11-13 14:48:56 -0500] octo: _rc: Okay, maybe I need to clarify: I'm not using Chef. I'm seeing a user agent "Chef Client" downloading collectd from collectd.org *a lot* from many different IPs
[2012-11-13 14:49:15 -0500] octo: _rc: I suspect some change in the default config or some module, but didn't have any luck finding anything
[2012-11-13 14:49:42 -0500] _rc: octo: so someone has a chef cookbook which is downloading the source to compile it
[2012-11-13 14:51:13 -0500] LinuxHorn: ssd7: you around?
[2012-11-13 14:53:37 -0500] poolpog: BryanWB_, hey, any word on why "resources" is not a defined mehod?
[2012-11-13 14:53:41 -0500] poolpog: method
[2012-11-13 14:53:43 -0500] octo: _rc: Okay, so I take it this is no default behavior of Chef and not pester you for the use case any longer and instead just block the requests.
[2012-11-13 14:53:52 -0500] BryanWB_: ok
[2012-11-13 14:53:55 -0500] BryanWB_:   recipe
[2012-11-13 14:53:59 -0500] poolpog: or anyone, actually, but BryanWB_ you seem to know ur shit
[2012-11-13 14:54:07 -0500] BryanWB_: then  `resources(....  `
[2012-11-13 14:54:12 -0500] specialsauce: octo: are these requests from different IPs or the same IP?
[2012-11-13 14:54:25 -0500] poolpog: ah
[2012-11-13 14:54:27 -0500] _rc: octo: someone had to tell chef to do it.  looks like it may be this cookbook.  https://github.com/realityforge/chef-collectd
[2012-11-13 14:54:34 -0500] poolpog: perfect
[2012-11-13 14:55:11 -0500] _rc: which isn't the one from the community site, which instead just installs a package
[2012-11-13 14:56:16 -0500] octo: specialsauce: About 200 different IPs in the last week, most from either amazonaws.com or upenn.edu, but there are others on occasion
[2012-11-13 14:56:27 -0500] poolpog: well, not perfect yet... how do I use "recipe" mode to point to or otherwise "know" about a given recipe?
[2012-11-13 14:56:41 -0500] BryanWB_: sorry gtg
[2012-11-13 14:56:52 -0500] _rc: it's just a crappy cookbook in the wild
[2012-11-13 14:56:52 -0500] poolpog: when I type "resources" it comes up with an empty array
[2012-11-13 14:57:05 -0500] gyre008: I have this statement in one of my recipes Chef::Log.info("***************** TEST ************")   but I'm not seeing ANY such output in my logs even when run with -l debug
[2012-11-13 14:57:16 -0500] gyre008: anyone idea why ? it makes no sense to me...uhh
[2012-11-13 14:57:22 -0500] octo: _rc: Thanks :)
[2012-11-13 14:57:51 -0500] gyre008: what the heck...
[2012-11-13 14:59:48 -0500] octo: _rc: Looks like this originated form coderanger 
[2012-11-13 14:59:50 -0500] octo: *from
[2012-11-13 15:01:50 -0500] poolpog: ok, so, in shef, if I choose "chef_run" on my workstation, what will that *do* exactly?
[2012-11-13 15:02:15 -0500] poolpog: will it try to actually perform chef config tasks on my workstation?
[2012-11-13 15:02:34 -0500] gyre008: anyone idea about that logging stuff ? this is pretty basic...wtf
[2012-11-13 15:07:46 -0500] poolpog: gyre008, i wish i could help
[2012-11-13 15:07:55 -0500] gyre008: :)
[2012-11-13 15:14:37 -0500] gyre008: apparently Chef::Log doesn't work but jut log() {level :debug} works fine as per Opscode wikimm...cool...
[2012-11-13 15:16:09 -0500] poolpog: thanks for the closure :)
[2012-11-13 15:18:32 -0500] yfeldblum: gyre008, Chef::Log.info logs immediately as the recipe is executed
[2012-11-13 15:18:58 -0500] gyre008: yfeldblum, did not log ANYTHING for me mate...
[2012-11-13 15:19:12 -0500] yfeldblum: gyre008, the log resource writes the text to the log during convergence
[2012-11-13 15:19:14 -0500] gyre008: i redirected all output into file and didn't get anything...
[2012-11-13 15:19:37 -0500] gyre008: I mean anything of what I should be getting
[2012-11-13 15:19:59 -0500] yfeldblum: gyre008, it's there; scroll up
[2012-11-13 15:20:14 -0500] gyre008: yeah will be scrolling up instead of griping ;)
[2012-11-13 15:20:17 -0500] gyre008: grePPing
[2012-11-13 15:20:21 -0500] gyre008: damn the auto correct :)
[2012-11-13 15:20:27 -0500] gyre008: nahit's not...
[2012-11-13 15:20:35 -0500] gyre008: actuallydouble check
[2012-11-13 15:20:36 -0500] gyre008: econd
[2012-11-13 15:21:26 -0500] gyre008: nope dude...
[2012-11-13 15:28:09 -0500] geekbri: I would love to see a gist of the code :)
[2012-11-13 15:28:26 -0500] geekbri: I use Chef::Log all the time in providers, recipes, just about everywhere without issue.
[2012-11-13 15:31:38 -0500] specialsauce: gyre008, have you checked the basics - is that recipe definitely being included, is the log statement in any conditionals etc. i also use Chef::Log all over and have never had any issues
[2012-11-13 15:32:13 -0500] gyre008: that's why it looks weirdwill gistsecond
[2012-11-13 15:34:15 -0500] gyre008: I put it on top of the recipe https://gist.github.com/4066364 there are NO ifs or anythingonce I replaced it with log() all was ok...
[2012-11-13 15:34:29 -0500] gyre008: so nothing wrong with run list either
[2012-11-13 15:36:11 -0500] _rc: the default run is at info, so unless you also run with escalated logging you won't see a message at level debug
[2012-11-13 15:38:36 -0500] geekbri: So you are not supposed to set attributes liek so anymore?   node['some_attr']['some_nested_attr'] ?
[2012-11-13 15:38:44 -0500] specialsauce: gyre008: ^ what he said
[2012-11-13 15:38:50 -0500] geekbri: seems like chef-client now wants you to call the set method explicitly ?
[2012-11-13 15:39:20 -0500] gyre008: _rc, I ran it with -l debug...
[2012-11-13 15:40:30 -0500] spox: geekbri: were you asking about the set for node attributes?
[2012-11-13 15:40:43 -0500] geekbri: spox:  yeah
[2012-11-13 15:41:07 -0500] spox: there was a thread in the ML about the changes in chef 11 re: attributes
[2012-11-13 15:41:58 -0500] geekbri: I shall read it!
[2012-11-13 15:42:02 -0500] geekbri: if i can find it.
[2012-11-13 15:44:32 -0500] spox: geekbri: here's one: http://lists.opscode.com/sympa/arc/chef/2012-11/msg00078.html
[2012-11-13 15:44:45 -0500] geekbri: spox: thanks.  I think i found it already :)
[2012-11-13 15:44:58 -0500] geekbri: im reading the one posted by kallekistec
[2012-11-13 15:44:59 -0500] spox: geekbri: here's the one related to set: http://lists.opscode.com/sympa/arc/chef/2012-10/msg00427.html
[2012-11-13 15:46:05 -0500] geekbri: man, looks like im going to have to edit a lot of cookbooks :)
[2012-11-13 15:46:19 -0500] spox: :)
[2012-11-13 15:57:52 -0500] itchyouch: How do I create directories in ruby in a recipe?
[2012-11-13 15:58:24 -0500] itchyouch: Execute(mkdir -p /path/to/dir) ?
[2012-11-13 15:59:14 -0500] ssd7: itchyouch: Unless you have a reason not to, it is probably best to use the directory resource: directory '/path/to/dir'
[2012-11-13 15:59:42 -0500] ssd7: http://docs.opscode.com/resource_directory.html
[2012-11-13 16:00:23 -0500] itchyouch: Aww sweet. I knew there had to be something like this.
[2012-11-13 16:23:00 -0500] LinuxHorn: ssd7: can you look at a gist of issues with knife rackspace?
[2012-11-13 16:23:07 -0500] LinuxHorn: https://gist.github.com/4065944
[2012-11-13 16:23:25 -0500] LinuxHorn: same setup worked fine last week, but now getting errors
[2012-11-13 16:24:11 -0500] LinuxHorn: just noticed an update for the excon gem
[2012-11-13 16:24:12 -0500] LinuxHorn: trying that
[2012-11-13 16:24:32 -0500] LinuxHorn: nope, same issue with excon-0.16.8
[2012-11-13 16:26:18 -0500] kaerast: does it do the same without using a custom image? (I'm assuming that's a custom image given mine were all image ID 127)
[2012-11-13 16:26:48 -0500] ssd7: LinuxHorn: Looking now.
[2012-11-13 16:27:24 -0500] LinuxHorn: not a custom image, v2 images have long names like that
[2012-11-13 16:27:31 -0500] LinuxHorn: but knife rackspace image list works
[2012-11-13 16:27:38 -0500] LinuxHorn: evan4498@MGWC8WDV13:chef-evan4498:$ knife rackspace image list
[2012-11-13 16:27:38 -0500] LinuxHorn: ID                                    Name
[2012-11-13 16:27:38 -0500] LinuxHorn: c94f5e59-0760-467a-ae70-9a37cfa6b94e  Arch 2012.08
[2012-11-13 16:27:38 -0500] LinuxHorn: 03318d19-b6e6-4092-9b5c-4758ee0ada60  CentOS 5.6
[2012-11-13 16:27:39 -0500] LinuxHorn: acf05b3c-5403-4cf0-900c-9b12b0db0644  CentOS 5.8
[2012-11-13 16:27:58 -0500] kaerast: ah ok, I've not done much with v2 yet
[2012-11-13 16:27:59 -0500] LinuxHorn: as does knife rackspace server list
[2012-11-13 16:28:42 -0500] LinuxHorn: taking off the bootstrap image i use does not help either
[2012-11-13 16:29:05 -0500] LinuxHorn: oops
[2012-11-13 16:29:08 -0500] LinuxHorn: nevermind :
[2012-11-13 16:29:10 -0500] LinuxHorn: :)
[2012-11-13 16:29:17 -0500] LinuxHorn: ssd7: i'm an idiot, ignore me
[2012-11-13 16:29:31 -0500] ssd7: LinuxHorn: Figured out the issue?
[2012-11-13 16:30:00 -0500] LinuxHorn: well
[2012-11-13 16:30:02 -0500] LinuxHorn: maybe not
[2012-11-13 16:30:14 -0500] fromonesrc: question about knife winrm - how do I use my aws private key to winrm into an instance? is this possible?
[2012-11-13 16:30:19 -0500] LinuxHorn: thought i did, but was creating a v1 by accident
[2012-11-13 16:30:22 -0500] LinuxHorn: v2 still not working
[2012-11-13 16:31:46 -0500] LinuxHorn: and yep, figured it out
[2012-11-13 16:31:53 -0500] LinuxHorn: flavor 1 no longer exists ;)
[2012-11-13 16:32:00 -0500] LinuxHorn: so yeah, ignore me
[2012-11-13 16:32:01 -0500] railsraider: i am doing hosts = search(:node, "*:*"), how can i get a full info on each host back in the array
[2012-11-13 16:32:02 -0500] LinuxHorn: thanks all
[2012-11-13 16:32:36 -0500] railsraider: i get back [node[app1], node[app2], node[app3]]
[2012-11-13 16:32:57 -0500] ssd7: railsraider: The elements should actually be node objects. node[app1] is just how they are printed
[2012-11-13 16:32:59 -0500] kaerast: it'd be nice if fog caught that and gave a sensible error rather than just BadRequest
[2012-11-13 16:33:12 -0500] kaerast: though I suppose for all it knows it is just a bad request
[2012-11-13 16:33:14 -0500] railsraider: ssd7: how do i access them?
[2012-11-13 16:33:18 -0500] ssd7: railsraider: So hosts[0]["fqdn"] and just should work
[2012-11-13 16:33:36 -0500] railsraider: thanks ssd7
[2012-11-13 16:33:42 -0500] ssd7: railsraider: Each element is a node object very similar to `node` inside a recipe, you can access all the same attributes and methods.
[2012-11-13 16:33:45 -0500] ssd7: railsraider: No problem
[2012-11-13 16:34:03 -0500] fromonesrc: anyone here have experience with knife winrm?
[2012-11-13 16:35:15 -0500] ssd7: fromonesrc: Very little.  Re your previous question, what you need to do is go to the AWS console and then use your private key to decrypt the administrator password
[2012-11-13 16:35:25 -0500] ssd7: you can then use password auth via WinRM
[2012-11-13 16:35:49 -0500] fromonesrc: thanks ssd7!
[2012-11-13 16:37:37 -0500] fromonesrc: ssd7: discovered that ec2-get-password will get the decrypted password too
[2012-11-13 16:37:42 -0500] fromonesrc: just pass in the instance and the pk
[2012-11-13 16:38:33 -0500] ssd7: fromonesrc: Nice, I'll have to remember that.
[2012-11-13 16:46:41 -0500] itchyouch: Anyone have any naming schemes they use?
[2012-11-13 16:47:05 -0500] itchyouch: Like calling something webserver vs webserver-roles
[2012-11-13 16:47:33 -0500] itchyouch: Basically differentiating between clients, roles and nodes in naming?
[2012-11-13 16:49:17 -0500] bmcgee: hey I'm getting this old chestnut "chpst: fatal: unable to run: bundle: file does not exist". Found a solution, just don't understand it: "the solution to "chpst: fatal: unable to run: bundle: file does not exist" is to ensure that the PATH is written to the run file for those that follow"
[2012-11-13 16:49:24 -0500] bmcgee: Can someone enlighten me?
[2012-11-13 16:49:39 -0500] bmcgee: i'm using application_ruby
[2012-11-13 17:04:48 -0500] kallistec: bmcgee: looks like you're using runit there. runit starts applications by running a script named "run" that you're likely generating from a template
[2012-11-13 17:05:11 -0500] bmcgee: when i manually run the command from the run file it works fine
[2012-11-13 17:05:25 -0500] bmcgee: it's when it's being run as part application_ruby deployment it seems to have issues
[2012-11-13 17:05:34 -0500] knuckolls: hey is there any way i can override an attribute in a single manual chef-run to see what happens?
[2012-11-13 17:05:41 -0500] _rc: when you manually run it you have a whole shedload of environment variables set
[2012-11-13 17:05:51 -0500] knuckolls: i looked at --help on chef-client but didn't see anything to do that
[2012-11-13 17:05:57 -0500] kallistec: bmcgee: yeah, but your environment is probably different than runsvdir, which is the top-level runit process that starts the others
[2012-11-13 17:06:42 -0500] bmcgee: any ideas how i can fix the environment
[2012-11-13 17:07:28 -0500] knuckolls: bmcgee: take a look at how wal-e uses envdir
[2012-11-13 17:07:29 -0500] knuckolls: https://github.com/heroku/WAL-E
[2012-11-13 17:07:43 -0500] kallistec: bmcgee: best thing is to modify the run script to set the PATH the way you want. I'm not familiar with the application cookbook, so I don't know how best to accomplish that
[2012-11-13 17:08:07 -0500] bmcgee: i'll have a dig around and see what i can come up with
[2012-11-13 17:09:25 -0500] kallistec: bmcgee: I'd try finding the template that's generating the run script and see what configurables it exposes
[2012-11-13 17:09:36 -0500] juliancdunn: anyone know if the aegisco people are still in business?
[2012-11-13 17:10:04 -0500] juliancdunn: looks like aegisco.com expired, so it broke the yum repo for RHEL5 che gems
[2012-11-13 17:13:22 -0500] digitallogic: is anyone familiar with the way that knife tries to find .chef/knife.rb?
[2012-11-13 17:13:41 -0500] digitallogic: I'm trying to figure out how it plays with symlinks
[2012-11-13 17:14:28 -0500] kallistec: digitallogic: looks in pwd, then recurses up. But if you're inside a symlinked directory, the path "up" doesn't go through the symlink
[2012-11-13 17:15:23 -0500] digitallogic: kallistec: so it should go to the directory containing the symlink?
[2012-11-13 17:15:49 -0500] digitallogic: and not the parent of the directory the sym link is pointing at?
[2012-11-13 17:16:06 -0500] kallistec: digitallogic: the other way around
[2012-11-13 17:16:21 -0500] kallistec: it takes the non-symlink path up
[2012-11-13 17:16:50 -0500] digitallogic: so I'm running knife from /foo/bar/baz, and /foo/bar is a symlink to /home/NOTME/some/directory
[2012-11-13 17:17:06 -0500] digitallogic: the expected behavior is to use my .chef/knife.rb or NOTME's .chef/knife.rb
[2012-11-13 17:17:50 -0500] kallistec: digitallogic: should be using NOTME's, I think
[2012-11-13 17:18:30 -0500] poolpog: hi
[2012-11-13 17:18:35 -0500] digitallogic: kallistec: thanks, that's the behavior I'm seeing
[2012-11-13 17:18:45 -0500] digitallogic: though unfortunately not the behavior I was looking for
[2012-11-13 17:18:51 -0500] kallistec: digitallogic: run `ruby -e 'p Dir.pwd'`
[2012-11-13 17:19:21 -0500] poolpog: is it better to use a "cookbook_file" resource and drop a weekly cron script in /etc/cron.weekly/run_this_file.sh   OR  use the Cron resource and have a "weekly" line added to /etc/crontab ?
[2012-11-13 17:19:37 -0500] poolpog: this is on Ubuntu 10 and 12
[2012-11-13 17:19:42 -0500] poolpog: chef 0.10.X
[2012-11-13 17:19:55 -0500] digitallogic: kallistec: gave me the real path, not the symlink path
[2012-11-13 17:19:55 -0500] ekristen: anyone have suggestions about doing maintenance on servers using chef, like running apt-get upgrade, or yum upgrade?
[2012-11-13 17:20:08 -0500] poolpog: I know chef is in a lot of flux as far as best practices, so maybe there is no "better" answer
[2012-11-13 17:20:21 -0500] kallistec: digitallogic: yeah, I use a symlink to a repo shared between multiple hosted chef orgs and this bites me
[2012-11-13 17:20:46 -0500] digitallogic: thanks kallistec
[2012-11-13 17:20:47 -0500] kallistec: looks like we could be using ENV['PWD'] instead
[2012-11-13 17:20:55 -0500] _rc: poolpog: neither.  cookbook_file /etc/cron.d/run_things_for_this_app and then push out what that calls seperately
[2012-11-13 17:21:19 -0500] poolpog: ok
[2012-11-13 17:21:29 -0500] poolpog: wait
[2012-11-13 17:21:40 -0500] kallistec: poolpog: using foo.d in general is better when your os/distro/app gives you the option
[2012-11-13 17:22:10 -0500] _rc: at least that's our house style.  the cron resource is nasty and updates something over in /var/spool
[2012-11-13 17:22:16 -0500] poolpog: /etc/cron.d/run_things_for_this_app is basically just crontab-format stuff... is that the Cron resource?
[2012-11-13 17:22:25 -0500] _rc: no it's not
[2012-11-13 17:22:41 -0500] poolpog: and if that isn't the cron resource, then why'd you recommend doing it that way, _rc ?
[2012-11-13 17:22:58 -0500] poolpog: because that's not even close to the answer I was expecting
[2012-11-13 17:23:02 -0500] kallistec: poolpog: the cron resource is designed for the old school case where you only have a single crontab on the system
[2012-11-13 17:23:07 -0500] poolpog: (well, i guess it is *close* :) )
[2012-11-13 17:23:09 -0500] _rc: foo.d is better for discoverability
[2012-11-13 17:23:32 -0500] poolpog: so, I want something to run weekly... why not just cookbook_file '
[2012-11-13 17:23:34 -0500] poolpog: oops
[2012-11-13 17:23:38 -0500] whilp: the only disadvantage to cron.d is that you have to code the removal, if necessary
[2012-11-13 17:23:52 -0500] whilp: i vastly prefer it despite that, of course
[2012-11-13 17:23:57 -0500] poolpog: cookbook_file '/etc/cron.weekly/sepcfic_cron_run_thing'  ?
[2012-11-13 17:24:02 -0500] _rc: poolpog: because if you put it in /etc/cron_weekly you don't get control of when during that week
[2012-11-13 17:24:14 -0500] poolpog: oh, I don't care wehn at all, for this thing
[2012-11-13 17:24:23 -0500] _rc: and sooner or later you'll want to change it, or run it twice a week
[2012-11-13 17:24:35 -0500] poolpog: just "weekly", "whenever you feel like it mr computer"
[2012-11-13 17:24:50 -0500] poolpog: not this thing, no, but I see where you are headed
[2012-11-13 17:24:57 -0500] _rc: if you really don't care then you've answered your own question
[2012-11-13 17:25:01 -0500] poolpog: thanks!
[2012-11-13 17:25:43 -0500] poolpog: so, this question comes from the more-than-one-way-to-do-it I'm seeing here, I just want to make sure what I choose makes some sort of sense, so thanks folks
[2012-11-13 17:26:20 -0500] poolpog: hey, on Debian systems, who runs /etc/cron.weekly/* stuff anyway? Is it root?
[2012-11-13 17:26:31 -0500] poolpog: I can google that, but it is easier to ask
[2012-11-13 17:27:12 -0500] ev0ldave: defaults to root but you can specify what user to use
[2012-11-13 17:29:02 -0500] Babar: poolpog: 47 6* * 7roottest -x /usr/sbin/anacron || ( cd / && run-parts --report /etc/cron.weekly )
[2012-11-13 17:29:07 -0500] Babar: that should answer your question.
[2012-11-13 17:29:14 -0500] poolpog: ok
[2012-11-13 17:29:19 -0500] poolpog: ah, yeah, duh
[2012-11-13 17:29:26 -0500] poolpog: joel says "hi"
[2012-11-13 17:29:49 -0500] beandip: is there a way to set an attribute using information from ohaiat the role level?
[2012-11-13 17:30:00 -0500] _rc: that's cron.d isn't it
[2012-11-13 17:31:51 -0500] Babar: _rc: no, that's /etc/crontab
[2012-11-13 17:32:15 -0500] eherot: Does anyone know if there is a way to define a function in one place and then use it in several recipes (all in the same cookbook)?
[2012-11-13 17:32:36 -0500] eherot: not a "definition" mind you.  This is a function that needs to return a result which will be used elsewhere in the recipe, rather than doing something on the server itself.
[2012-11-13 17:36:49 -0500] specialsauce: eherot, you could use a library for that or why not just calc once and then set as a var/attr
[2012-11-13 17:37:26 -0500] eherot: specialsauce: the function takes an argument
[2012-11-13 17:38:20 -0500] eherot: but actually a library would probably work.  forgot about that one
[2012-11-13 17:38:24 -0500] specialsauce: eherot: you can pass args into libraries
[2012-11-13 17:38:30 -0500] eherot: thx
[2012-11-13 17:38:32 -0500] specialsauce: function([arg])
[2012-11-13 17:38:34 -0500] specialsauce: np
[2012-11-13 17:39:44 -0500] heathsnow: someone must know this: how do I execute chef-client on an entire environment?  I'm not sure of the knife syntax :S
[2012-11-13 17:44:53 -0500] coderanger: octo: My cookbook for collectd is all package based (as are all my cookbooks)
[2012-11-13 17:57:44 -0500] matti: Hey folks.
[2012-11-13 18:02:15 -0500] octo: coderanger: Yeah, looks like somebody copied your config and "extended" it 
[2012-11-13 18:10:39 -0500] heathsnow: Ah, got it: knife winrm "chef_environment:env_name AND role:workstation" 'chef-client -c c:\chef\client.rb' -x Admin -P 'pwd'
[2012-11-13 18:27:26 -0500] nautical9: hey folks: I'm playing with the chef 11 preview on an EC2 instance, and it's looking great, with one problem.
[2012-11-13 18:27:40 -0500] nautical9: The installer insists on using the local hostname, which in EC2 is the internal, private hostname that won't work outside of that region - and I can't seem to figure out how to force it to something else.
[2012-11-13 18:28:12 -0500] nautical9: changing /etc/chef-server/chef-server-running.json works temporarily, but it won't persist between server reconfigures - I assume it just uses whatever ohai returns
[2012-11-13 18:28:23 -0500] nautical9: what's the proper way to force the change and have it stick?
[2012-11-13 18:45:25 -0500] fromonesrc: getting this error with knife ec2: Fog::Compute::AWS::Error: SignatureDoesNotMatch
[2012-11-13 18:45:45 -0500] fromonesrc: from what I can tell the signature is correct
[2012-11-13 18:47:32 -0500] knuckolls: https://github.com/opscode-cookbooks/gunicorn/blob/master/providers/install.rb
[2012-11-13 18:47:52 -0500] knuckolls: that install provider claims it's done work every chef-run
[2012-11-13 18:48:18 -0500] knuckolls: but it doesn't actually check to see if it performed work before setting updated_by_last_action to true
[2012-11-13 18:48:46 -0500] knuckolls: is there any way I can get informatin about those two python resources and fire updated_by_last_action if they actually ran?
[2012-11-13 18:52:10 -0500] fromonesrc: nevermind. was in fact just as the error indicated.
[2012-11-13 19:21:55 -0500] itchyouch: So what kind if things are you guys'll doing for chef server backups?
[2012-11-13 19:22:23 -0500] itchyouch: I guess strategy.  Looking over the documentation, there was the database dumping of couch
[2012-11-13 19:22:44 -0500] itchyouch: And the other aspect of integrating revision control'd configs
[2012-11-13 19:29:00 -0500] cheeseplus: itchyouch: http://fnichol.github.com/knife-server/
[2012-11-13 19:32:41 -0500] itchyouch: Thanks cheeseplus
[2012-11-13 19:45:56 -0500] fromonesrc: trying to create a windows instance with knife ec2 server create but hanging at  Waiting for sshd.................
[2012-11-13 19:46:12 -0500] geekbri: I don't know jack about windows but
[2012-11-13 19:46:17 -0500] fromonesrc: port 22 is open, also winrm ports just in case
[2012-11-13 19:46:31 -0500] geekbri: try to SSH into the windows instance manually
[2012-11-13 19:46:35 -0500] geekbri: does it work?
[2012-11-13 19:48:47 -0500] fromonesrc: geekbri: port 22: Operation timed out
[2012-11-13 19:49:14 -0500] fromonesrc: probably because ssh was not installed yet it's windows
[2012-11-13 19:49:24 -0500] fromonesrc: but chef is trying to ssh to bootstrap
[2012-11-13 19:49:47 -0500] BryanWB: coderanger, around?
[2012-11-13 19:49:58 -0500] coderanger: Yes but in a mtg
[2012-11-13 19:50:04 -0500] geekbri: Not having SSH available is certainly an issue
[2012-11-13 19:57:08 -0500] BryanWB: coderanger, when u get a chance, i am thinking about if this dsl would be gud for collectd https://github.com/pyr/collectd-dsl , ur feedback would be useful before I put much effort into it
[2012-11-13 20:00:16 -0500] coderanger: BryanWB: I don't think so, it works at the wrong level compared to Chef
[2012-11-13 20:00:31 -0500] coderanger: A plugin in collectd should map to a resource in chef
[2012-11-13 20:00:43 -0500] coderanger: this DSL operates at the level of whole config
[2012-11-13 20:01:03 -0500] coderanger: also there is the problem if not being able to swap the template, which means for example new features are hard to support
[2012-11-13 20:01:23 -0500] miah: https://github.com/miah/chef-collectd/blob/master/resources/plugin.rb
[2012-11-13 20:01:23 -0500] miah: :P
[2012-11-13 20:02:33 -0500] jtimberman: BryanWB: btw, postgresql configuration will be attribute driven in the next cookbook release: http://tickets.opscode.com/browse/COOK-1871
[2012-11-13 20:02:35 -0500] BryanWB: 99% of time i go to write an lwrp it already exists :p
[2012-11-13 20:02:47 -0500] BryanWB: jtimberbman gr8
[2012-11-13 20:02:59 -0500] miah: as allways. pull requests accepted.
[2012-11-13 20:03:00 -0500] BryanWB: sorry no autocompletion on this irc client
[2012-11-13 20:03:09 -0500] jtimberman: BryanWB: :)
[2012-11-13 20:03:25 -0500] miah: i'm working on fixing up the collectd client install part really quick right now. so will probably have a new release out shortly.
[2012-11-13 20:04:43 -0500] BryanWB: miah, have u looked at this dsl tho? it takes quite a different approach, https://github.com/pyr/collectd-dsl  , not necessarily better, but pyr is quite clever
[2012-11-13 20:04:57 -0500] miah: ya i saw it
[2012-11-13 20:05:35 -0500] miah: i'll take another look at it later. in the middle of other things right now.
[2012-11-13 20:08:25 -0500] coderanger: BryanWB: it would be nice to have a DSL for just the per-plugin config
[2012-11-13 20:08:40 -0500] coderanger: BryanWB: but the actual resource structure needs to live in chef land
[2012-11-13 20:08:49 -0500] coderanger: and I couldn't see how to pull those apart easily
[2012-11-13 20:09:15 -0500] coderanger: (as long as there is also an option to use a different template)
[2012-11-13 20:09:18 -0500] BryanWB: coderanger i thinking about just using this dsl for per-plugin config
[2012-11-13 20:09:44 -0500] BryanWB: it would get to hairy to use it for all plugins
[2012-11-13 20:10:18 -0500] BryanWB: and y wud be gud to allow it accept template
[2012-11-13 20:11:09 -0500] coderanger: BryanWB: 1) because you can't plan for everything, custom plugins might take otherwise unknown options 2) future use or old versions of collectd 3) general good pattern
[2012-11-13 20:11:22 -0500] BryanWB: coderanger agreed
[2012-11-13 20:12:51 -0500] mdxp: is there a way to restrict searches to only top level attributes?
[2012-11-13 20:13:33 -0500] miah: mdxp: http://community.opscode.com/cookbooks/partial_search
[2012-11-13 20:13:59 -0500] mdxp: thanks miah; i am not referring to the results
[2012-11-13 20:14:11 -0500] BryanWB: l8r folks time for me to be domesti
[2012-11-13 20:14:18 -0500] mdxp: i mean we have the same id defined in some other attributes
[2012-11-13 20:14:19 -0500] BryanWB: domestic*
[2012-11-13 20:14:36 -0500] mdxp: and search is returning unexpected results because of that
[2012-11-13 20:14:57 -0500] mdxp: as it is matching top level ones (what we want) but also some other ones that refer to something else
[2012-11-13 20:15:31 -0500] mdxp: for ex. we have deployment_id that we want to search for
[2012-11-13 20:15:55 -0500] mdxp: and by default that will match the top level deployment_id but also if we had something like app => {deployment_id..}
[2012-11-13 20:17:49 -0500] poolpog: can one use "node.search" in a recipe file?
[2012-11-13 20:17:57 -0500] poolpog: I expect the answer to be "yes"
[2012-11-13 20:18:01 -0500] maplebed: heh... I was just reading about that.
[2012-11-13 20:18:03 -0500] maplebed: "yes"
[2012-11-13 20:18:05 -0500] maplebed: :)
[2012-11-13 20:18:22 -0500] poolpog: e.g. node.search("name: thing").each do |t| ....end
[2012-11-13 20:18:25 -0500] poolpog: something like that?
[2012-11-13 20:18:34 -0500] maplebed: http://wiki.opscode.com/display/chef/Search - section 'Using Search in Recipes'
[2012-11-13 20:18:44 -0500] poolpog: you so nice
[2012-11-13 20:22:29 -0500] poolpog: ugh, a ruby-oriented question... I want to use a particular cookbook_file *only* on nodes matching a certain pattern... otherwise, not use the file at all
[2012-11-13 20:23:08 -0500] poolpog: search(:node, "*pattern*").each do |n| n.cookbook_file .... end
[2012-11-13 20:23:12 -0500] poolpog: would that work?
[2012-11-13 20:23:37 -0500] maplebed: I don't think you want search for that.
[2012-11-13 20:23:51 -0500] poolpog: I'm not sure how to even test this, unfortuantely, as my success so far with shef has been minimal
[2012-11-13 20:23:55 -0500] poolpog: ok
[2012-11-13 20:24:04 -0500] poolpog: I considered doing ...
[2012-11-13 20:24:18 -0500] maplebed: this sounds like the same kind of decision many recipes make around OS versions.
[2012-11-13 20:24:33 -0500] poolpog: if %w( node1 node2 node3).include? node.name then cookbook_file.... end
[2012-11-13 20:24:39 -0500] maplebed: if random-attribute is in set-of-options, use specific-file-variant.
[2012-11-13 20:24:43 -0500] poolpog: yes
[2012-11-13 20:24:46 -0500] poolpog: basically, yes
[2012-11-13 20:24:58 -0500] maplebed: the recipe will be running on each node on its own,
[2012-11-13 20:25:01 -0500] poolpog: I ddidn't want to hard-code a list of node names though
[2012-11-13 20:25:02 -0500] maplebed: so something like
[2012-11-13 20:25:34 -0500] maplebed: is there some attribute you can create that makes them special?
[2012-11-13 20:25:48 -0500] poolpog: well, the node name itself is special
[2012-11-13 20:25:56 -0500] poolpog: they are named for their purpose
[2012-11-13 20:26:10 -0500] poolpog: so a name pattern  ? I also considered...
[2012-11-13 20:26:24 -0500] maplebed: if node.hostname =~ /regex-that-matches-the-special-name/ do ...
[2012-11-13 20:26:28 -0500] poolpog: if node.name =~ /pattern/ then coo...
[2012-11-13 20:26:30 -0500] poolpog: hey!
[2012-11-13 20:26:35 -0500] poolpog: ok, I'll do that
[2012-11-13 20:26:48 -0500] poolpog: although hostname is not properly set on our nodes for some reason
[2012-11-13 20:27:03 -0500] poolpog: or maybe I'm just checking it wrong, idk
[2012-11-13 20:27:15 -0500] wassy121: I normally use node['name'] instead of node.name, just in case it has a method called "name" for some stupid reason
[2012-11-13 20:27:16 -0500] maplebed: something I've seen some recipes do to avoid hardcoding stuff in the recipe
[2012-11-13 20:27:28 -0500] maplebed: put the pattern in an attribute instead of the recipe
[2012-11-13 20:27:38 -0500] poolpog: I see
[2012-11-13 20:27:48 -0500] poolpog: so, add an arbitrary attribute?
[2012-11-13 20:27:54 -0500] poolpog: like, a flag, hm?
[2012-11-13 20:28:16 -0500] maplebed: I suppose the reason would be that it's easy to override an attribute but you can't do that in a recipe...
[2012-11-13 20:28:31 -0500] maplebed: up to you, I suppose.  this sounds like it's a not-likely-reused kind of recipe.
[2012-11-13 20:29:02 -0500] maplebed: oh, and +1 wassy121.  reference: http://acrmp.github.com/foodcritic/#FC001
[2012-11-13 20:29:25 -0500] poolpog: " this sounds like it's a not-likely-reused kind of recipe." why do you say that?
[2012-11-13 20:29:53 -0500] maplebed: cuz it's making decisions based on an attribute entirely specific to your environment (a particular pattern in the host naming scheme)
[2012-11-13 20:29:59 -0500] poolpog: this recipe will definitely be reused on many servers...
[2012-11-13 20:30:04 -0500] poolpog: ah
[2012-11-13 20:30:14 -0500] poolpog: ok, "reused" in a global sense
[2012-11-13 20:30:32 -0500] poolpog: well, isn't that ok? i.e. should I be writing recipes that can be reused globally?
[2012-11-13 20:31:37 -0500] maplebed: there's a good conversation about that here: http://www.youtube.com/watch?v=3Y-lpMyG3jA&t=32m00s
[2012-11-13 20:31:45 -0500] maplebed: (from http://foodfightshow.org/)
[2012-11-13 20:32:10 -0500] poolpog: not sure if I can watch that dude
[2012-11-13 20:32:12 -0500] poolpog: is it you?
[2012-11-13 20:32:16 -0500] maplebed: no.
[2012-11-13 20:32:19 -0500] poolpog: it's the lip ring
[2012-11-13 20:32:24 -0500] maplebed: heh...
[2012-11-13 20:32:40 -0500] poolpog: all my brain can see or hear is "lip ring lip ring lip ring ring! "
[2012-11-13 20:33:13 -0500] maplebed: just close your eyes, sit back, ...
[2012-11-13 20:33:20 -0500] maplebed: and picture a gigantic lip.
[2012-11-13 20:33:27 -0500] maplebed: (sorry, not helpful.)
[2012-11-13 20:34:24 -0500] c_t: poolpog: simple solution
[2012-11-13 20:34:35 -0500] c_t: just think of "We Build This City" in your head instead
[2012-11-13 20:34:43 -0500] c_t: voila, no longer will you think of some lip ring
[2012-11-13 20:39:51 -0500] poolpog: ok, so  a coworker just came by and showed me this: http://paperjs.org/
[2012-11-13 20:40:06 -0500] poolpog: kinda cool, but that lead to a conversation, which led to this: http://nyan.cat/
[2012-11-13 20:40:29 -0500] poolpog: now I'm stuck with nyan cat music playing AND lip ring lip ring, I may just go crazy
[2012-11-13 20:44:29 -0500] garrettux: hi guys
[2012-11-13 20:45:45 -0500] garrettux: I have an open-source chef server behind a load-balancer, terminating SSL at the load balancer.  I'm getting "EOFError: end of file reached" when uploading/downloading cookbooks.  uploading roles, data bags, etc works ok.  anyone seen anything similar before?
[2012-11-13 20:47:35 -0500] knuckolls: garrettux: is it nginx?
[2012-11-13 20:47:47 -0500] garrettux: no, it's an f5 bigip
[2012-11-13 20:47:51 -0500] garrettux: knuckolls: ^^
[2012-11-13 20:48:23 -0500] knuckolls: garrettux: the reason i ask is because i know nginx buffers the entire client request before sending downstream to the backend service
[2012-11-13 20:48:41 -0500] knuckolls: it's possible that the f5 is buffering the requests and the buffer is set too small
[2012-11-13 20:48:52 -0500] knuckolls: it's the first thing that pops to mind because this burned me in a different context
[2012-11-13 20:49:57 -0500] garrettux: knuckolls: that's along the lines i've been checking.. was trying to figure out if it's related to the 16kB record size in SSL_read(), and it seems like the largest GET/POST that works is a little under that
[2012-11-13 20:50:28 -0500] knuckolls: garrettux: you should sidestep ssl and the load balancer to isolate the problem
[2012-11-13 20:50:56 -0500] knuckolls: i don't know your network architecture, but i assume you can ssh port forward to the chef server worst case
[2012-11-13 20:51:00 -0500] garrettux: I did, it definitely worked when going straight to :4000 on the server.
[2012-11-13 20:51:17 -0500] knuckolls: so does the problem persist only when it's ssl on the load balancer?
[2012-11-13 20:51:21 -0500] garrettux: setting up a non-ssl vip on the load balancer, and that worked too
[2012-11-13 20:51:22 -0500] garrettux: ywp
[2012-11-13 20:51:25 -0500] garrettux: yep*
[2012-11-13 20:51:27 -0500] knuckolls: dang
[2012-11-13 20:51:35 -0500] garrettux: lol.. yeah
[2012-11-13 20:52:12 -0500] knuckolls: well
[2012-11-13 20:52:59 -0500] knuckolls: this is a dumb solution, but if you can set this up in isolation you can use valgrind or strace or other debugging mechanisms to see what internal functions are being called
[2012-11-13 20:53:26 -0500] knuckolls: but yeah that'd be last resort in my opinion
[2012-11-13 20:53:34 -0500] knuckolls: sounds like you need more debugging information from somewhere
[2012-11-13 20:53:58 -0500] garrettux: yeah, i've used strace and tcpdump, still looking through those, it's a lot of data :)
[2012-11-13 20:54:52 -0500] garrettux: i'm going to keep chasing down the buffer size theory.  thanks knuckolls
[2012-11-13 20:55:15 -0500] knuckolls: good luck :)
[2012-11-13 20:55:26 -0500] poolpog: yay! it worked! thanks folks
[2012-11-13 20:58:40 -0500] kallistec: garrettux: what version of chef on the client?
[2012-11-13 20:59:02 -0500] garrettux: kallistec: 10.16.2, same for the server
[2012-11-13 20:59:37 -0500] kallistec: garrettux: odd, I do remember some bug related to OpenSSL which we had to monkey patch a fix in for
[2012-11-13 21:02:55 -0500] garrettux: yeah, and it happens with knife and chef-client
[2012-11-13 21:02:59 -0500] magoo: i'm assigning an array to a default attribute and then trying to overwrite that array in my role... it's actually appending to the array though. What's the correct approach here?
[2012-11-13 21:03:42 -0500] maplebed: http://www.ruby-doc.org/core-1.9.3/Array.html#method-i-clear maybe?
[2012-11-13 21:05:01 -0500] magoo: i can't do that in a role tho
[2012-11-13 21:05:30 -0500] magoo: time for some irb
[2012-11-13 21:09:50 -0500] garrettux: magoo: i think if the default attribute us an array, and you set an override attribute elsewhere, the override array will take the place of the defaul instead of merging.  it's been a while wince i've tested that though.
[2012-11-13 21:09:58 -0500] magoo: hrm, turns out that's not typical ruby behavior
[2012-11-13 21:09:59 -0500] wassy121: magoo, that's due to the way Chef does a deep-merge
[2012-11-13 21:10:06 -0500] magoo: ah, ok
[2012-11-13 21:10:12 -0500] wassy121: http://wiki.opscode.com/display/chef/Deep+Merge has some info
[2012-11-13 21:10:52 -0500] wassy121: basically "working as expected".  Maybe you need to not set the default?  Or have it !merge:value ?
[2012-11-13 21:13:48 -0500] magoo: I think i'll pull the default out
[2012-11-13 21:13:58 -0500] magoo: i can see how merging would come in handy in cases
[2012-11-13 21:25:50 -0500] yfeldblum: if you're doing a whole lot of deep merging, chances are that there's another better way to do it
[2012-11-13 21:29:20 -0500] bemu: I plugged Chef in an article on HN related to renaming our new clothing company after a cease and desist, if anyone wants to help brainstorm/upvote! http://news.ycombinator.com/item?id=4779890
[2012-11-13 21:31:11 -0500] maplebed: hey, I was just reading that article this morning.
[2012-11-13 21:35:09 -0500] barnacles: Has anyone had any success doing automatic NFS folders in chef? i.e I create a new webapp on my VM, and it mounts to the remote server (the remote path is known by the VM already)
[2012-11-13 21:35:54 -0500] barnacles: What I want to achieve is this: Physical Machine does an ant build to the NFS folder, which is then read in by the VM
[2012-11-13 21:36:11 -0500] bemu: :) Thanks maplebed.
[2012-11-13 21:37:40 -0500] reidar: hey guys, can anyone help me? long story short: I've successfully installed chef-server on amazon (Linux domU-12-31-38-04-CA-85 3.2.32-53.46.amzn1.i686) and when run /etc/init.d/chef-server start it starts ok
[2012-11-13 21:37:51 -0500] reidar: but when I run netstat I don't see anything listening on 4000
[2012-11-13 21:39:33 -0500] miah: bemu: wow crazy. good luck with that.
[2012-11-13 21:40:22 -0500] bemu: Thanks! Fastest growing fashion kickstarter ever, got the funding we need to do our first run, things are looking good.
[2012-11-13 21:40:51 -0500] bemu: I used the new application / application_ruby recipe to launch the site, too.
[2012-11-13 21:40:59 -0500] bemu: Pretty sick.
[2012-11-13 21:41:36 -0500] knuckolls: yfeldblum: used this gist today with great success. thanks for that. https://gist.github.com/d85be145f3ff824ccc07/22f027600dfbfe908d5f74f3522017e60c5137be
[2012-11-13 21:41:42 -0500] yfeldblum: from 0 to 1 is infinitely fast ...
[2012-11-13 21:41:59 -0500] yfeldblum: knuckolls, nice
[2012-11-13 21:42:19 -0500] garrettux: knuckolls: in case you were curious, our load balancer wasn't setting the X_FORWARDED_PROTO 'https' header
[2012-11-13 21:42:22 -0500] garrettux: that fixed it
[2012-11-13 21:42:31 -0500] knuckolls: garrettux: tricky
[2012-11-13 21:42:38 -0500] garrettux: yeah, good times :)
[2012-11-13 21:42:46 -0500] knuckolls: just another day
[2012-11-13 22:02:26 -0500] jtimberman: bemu: that's awesome :)
[2012-11-13 22:07:01 -0500] ranjibd: ohai...
[2012-11-13 22:11:11 -0500] jtimberman: is turning ssl on in postgresql (8.4+) expected or surprising? would you prefer to control that from your own recipe/role, wherey ou'd also drop off your postgresql SSL certificate?
[2012-11-13 22:12:56 -0500] bemu: I imagine it should be an option, but not the default, as it does require the SSL cert, no?
[2012-11-13 22:13:26 -0500] ranjibd: jtimberman, not usual for us. given the db-app networks are mostly internal, firewall protected
[2012-11-13 22:14:55 -0500] yfeldblum: ranjibd, mostly private for some people, but not for others
[2012-11-13 22:14:57 -0500] jtimberman: bemu: yeah, at some point it was added to the recipes to turn ssl on on newer versions of postgresql
[2012-11-13 22:15:40 -0500] jtimberman: centos 5.8 doesn't have a certificate created already, but ubuntu 10.04 does. O.o
[2012-11-13 22:17:30 -0500] kryptek: jtimberman,  What's the best way to make something start up on system reboot if it's not a typical supported service?  I have this monitor, 'god' installed on my box and want it to start up on boot
[2012-11-13 22:18:07 -0500] kryptek: action [:enable] crashes the recipe since there's no init script for it.. I'm guessing I just have to create an init script manually and drop it into init.d ?
[2012-11-13 22:24:17 -0500] josephholsten: fnichol around?
[2012-11-13 22:24:45 -0500] josephholsten: anyone noticed his rvm cookbook failing to work on recent installs?
[2012-11-13 22:27:24 -0500] jtimberman: kryptek: our god cookbook sets up god to run in runit
[2012-11-13 22:27:48 -0500] jtimberman: so if you want to set it up with a different init system, you'd have to drop off the right script for the service to use.
[2012-11-13 22:29:55 -0500] kryptek: jtimberman,  Figured as much :) Thanks
[2012-11-13 22:30:19 -0500] maplebed: anybody have a nagios check that alerts when the most recent chef run is >> $warn-age?
[2012-11-13 22:38:57 -0500] sunil__: Anyone had success using this approach?
[2012-11-13 22:38:58 -0500] sunil__: http://www.opscode.com/blog/2010/05/06/data-driven-application-deployment-with-chef/
[2012-11-13 22:40:11 -0500] bemu: Yes, that is the approach we use. However, the new application cookbook uses a non-databag driven methodology, might be more to your liking.
[2012-11-13 22:48:05 -0500] sunil__: ooh
[2012-11-13 22:48:21 -0500] sunil__: so does it still support data bag approach?
[2012-11-13 22:48:36 -0500] sunil__: I was actually thinking of dynamically creating new apps as data bag items..
[2012-11-13 22:50:47 -0500] sunil__: @bemu are you referring to this cookbook?
[2012-11-13 22:50:47 -0500] sunil__: https://github.com/opscode-cookbooks/application/tree/master/recipes
[2012-11-13 22:51:42 -0500] jtimberman: sunil__: we're going to remove those recipes. they're deprecated. see ticket http://tickets.opscode.com/browse/COOK-1820
[2012-11-13 22:53:05 -0500] sunil__: jtimberman - removing the data bag references?
[2012-11-13 22:53:37 -0500] jtimberman: sunil__: the pull request removes all the deprecated things: https://github.com/opscode-cookbooks/application/pull/22
[2012-11-13 22:53:47 -0500] sunil__: so I shouldn't bother using data bag approach at all?
[2012-11-13 22:53:59 -0500] jtimberman: you can still use data bags
[2012-11-13 22:54:06 -0500] jtimberman: if you want to store the application information in one
[2012-11-13 22:54:43 -0500] sunil__: so if i want to dynamically create an app, can I still have all the variables in data bag and just let the application cookbook pull them?
[2012-11-13 22:55:42 -0500] r5|ryan: you can, but wouldnt you rather use attributes?
[2012-11-13 22:56:22 -0500] sunil__: I would use attributes if all are there
[2012-11-13 22:57:12 -0500] sunil__: i am going to give it a shot..I was confused with that article and spent bunch of time getting it working..
[2012-11-13 22:58:12 -0500] jtimberman: sunny: you should write an application specific cookbook to pull the data bag information and use it in the LWRP
[2012-11-13 22:59:44 -0500] jtimberman: er, sunil__
[2012-11-13 23:09:37 -0500] barnacles: Hmm, I have an Hash attribute that I'm trying to update: mounts = node['nfs']['mounts']
[2012-11-13 23:10:03 -0500] barnacles: but mounts always ends up as a: #<Chef::Node::Attribute:0x7ffe8b887660>
[2012-11-13 23:10:15 -0500] karsten: I've launched a new ECw instance, initial chef bootstrap appears to have failed due to missing encrypted databag secret file, which I've corrected.  How do I re-run the chef bootstrap either remotely or from the host (an Ubuntu instance).
[2012-11-13 23:10:25 -0500] karsten: s/ECw/EC2.
[2012-11-13 23:10:56 -0500] gchristensen: just re-run the knife bootstrap, karsten
[2012-11-13 23:11:54 -0500] ssd7: barnacles: Easiest way to get around errors related to that is to call .to_hash on the attribute when assinging it to a variable
[2012-11-13 23:12:19 -0500] ssd7: barnacles: The underlying problem is fixed for Chef 11.
[2012-11-13 23:13:33 -0500] karsten: gchristensen: Commandline?
[2012-11-13 23:13:38 -0500] karsten: Or FAQ / doc pointer?
[2012-11-13 23:16:18 -0500] karsten: OK.  FQDN ithe FQDN of what?  Chef server?  And I need a validation.pem somehwere.
[2012-11-13 23:17:58 -0500] ssd7: karsten: If the inital bookstrap during the knife ec2 server create works it is likely you have all the pieces in place.  You'll just need something like knife bootstrap FQDN_OR_IP_OF_NODE -x USERNAME -i /path/to/private/key --sudo
[2012-11-13 23:20:43 -0500] barnacles: Thanks ssd7!
[2012-11-13 23:21:27 -0500] karsten: ssd7: Trying to explain it like aI'm 5 years old:  I run "knife bootstrap" on the newly created node.  I need to pass it a private SSH key, or is that a chef validation.pem?  I don't seem to have either.  The host in an ubuntu instance, and I recall that chef dumps some of this under /tmp or /var somewhere, though I don't recall exactly where.
[2012-11-13 23:21:35 -0500] karsten: ... and run as root / via sudo.
[2012-11-13 23:21:57 -0500] miah: ec2 nodes have ssh keys associated with them
[2012-11-13 23:22:02 -0500] miah: that would be your private ssh key
[2012-11-13 23:22:18 -0500] miah: the validation.pem is a key used by chef to give you authorization to create a new client.
[2012-11-13 23:22:24 -0500] miah: they are different.
[2012-11-13 23:23:05 -0500] karsten: Ah:  /var/chef/cache/stacktrace.out tells me errors.  Chef::Exceptions::PrivateKeyMissing: I cannot read /etc/chef/validation.pem, which you told me to use to sign requests!
[2012-11-13 23:23:19 -0500] karsten: ... and it goes downhill from there.
[2012-11-13 23:29:04 -0500] miah: did you pass --sudo to your bootstrap command?
[2012-11-13 23:30:07 -0500] cap10morgan: Is there a way to give a new client update permission on all cookbooks in hosted chef (other than manually adding it to every version of every cookbook on the server)?
[2012-11-13 23:30:53 -0500] karsten: miah: Yes.
[2012-11-13 23:31:04 -0500] karsten: As noted.
[2012-11-13 23:34:20 -0500] ssd7: karsten: You run the knife bootstrap command on your local workstation.  The same place you ran the knife ec2 server create command from.
[2012-11-13 23:35:27 -0500] karsten: And I identify the node I'm bootstrapping ... by its public IP?
[2012-11-13 23:38:36 -0500] karsten: Using the public AWS FQDN, I get two prompts from the host along with the line Please login as the user "ubuntu" rather than the user "root"..
[2012-11-13 23:39:04 -0500] miah: clearly, you should be passing '-x ubuntu' as you can't login as root
[2012-11-13 23:39:09 -0500] karsten: Command has a nonzero exit status.  I don't see a new  chef-stacktrace.out.
[2012-11-13 23:39:24 -0500] miah: knife bootstrap --help
[2012-11-13 23:39:34 -0500] miah: understand what those arguments are doing
[2012-11-13 23:40:36 -0500] miah: also. check out: https://help.ubuntu.com/community/EC2StartersGuide and https://help.ubuntu.com/community/EC2FAQ
[2012-11-13 23:41:30 -0500] karsten: I did read '--help'.  The docs aren't particularly illuminating. Checking the links.
[2012-11-13 23:41:32 -0500] fujin`: FUCKKKINNNG FUJIN
[2012-11-13 23:41:49 -0500] karsten: I'm expecting I'll get an /etc/chef/ directory with relevant contents on the the host.  I'm not seeing that.
[2012-11-13 23:57:38 -0500] coderanger: karsten: Check that you have the validation key setup correctly in knife.kb locally (on your workstation, the place running knife boostrap)
[2012-11-13 23:58:11 -0500] coderanger: karsten: It sucks the validation key off the local machine and injects it on to the node being boostraped
