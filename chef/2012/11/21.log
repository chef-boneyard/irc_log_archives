[2012-11-21 00:00:38 -0500] bluepojo: validation.pem issues should cause an auth error
[2012-11-21 00:00:39 -0500] bluepojo: not a 500
[2012-11-21 00:00:59 -0500] bluepojo: did you copy the validation.pem from the old server?
[2012-11-21 00:01:06 -0500] mrk__: yes
[2012-11-21 00:01:14 -0500] miah: right. validation.pem will only affect 'newly registering clients'
[2012-11-21 00:01:20 -0500] bluepojo: did you also copy the key.pem?
[2012-11-21 00:01:27 -0500] bluepojo: the validation.pem is tied to that key
[2012-11-21 00:01:39 -0500] bluepojo: so if the key.pem was regenerated, your validation.pem will not be accepted
[2012-11-21 00:01:42 -0500] bluepojo: but that won't cause a 500
[2012-11-21 00:01:53 -0500] mrk__: i actually get a 401 in the logs
[2012-11-21 00:02:03 -0500] bluepojo: ah, in that case key.pem might be your issue
[2012-11-21 00:02:11 -0500] mrk__: https://gist.github.com/27816f64eb8c79a76e9a
[2012-11-21 00:02:22 -0500] mrk__: let me check the key.pem
[2012-11-21 00:02:31 -0500] mrk__: (thanks for the help btw!)
[2012-11-21 00:02:36 -0500] bluepojo: try regenerating your validation.pem and see if that fixes your issue
[2012-11-21 00:02:49 -0500] bluepojo: or perhaps you can copy the key.pem from the old server if you still have it
[2012-11-21 00:03:02 -0500] bluepojo: I'm not 100% sure if copying the key.pem will work
[2012-11-21 00:03:15 -0500] mrk__: regenerating totally works
[2012-11-21 00:03:24 -0500] mrk__: but i'd prefer to avoid that tho
[2012-11-21 00:03:36 -0500] mrk__: do you know where is the key.pem supposed to be?
[2012-11-21 00:03:51 -0500] bluepojo: hm, I forget. I ran into this exact issue when I migrated chef servers myself.
[2012-11-21 00:03:58 -0500] alexw: rafaelmagu: how do you handle the env_run_lists then for each region?
[2012-11-21 00:04:14 -0500] bluepojo: let me see if the other dude on my team remembers
[2012-11-21 00:04:17 -0500] bluepojo: he helped me solve it
[2012-11-21 00:04:25 -0500] rafaelmagu: alexw: not sure I follow. What do you mean?
[2012-11-21 00:04:41 -0500] mrk__: ah cool. thanks bluepojo
[2012-11-21 00:04:51 -0500] ranjibd: ohai chefs.
[2012-11-21 00:05:17 -0500] alexw: are you using prod_us, prod_au kind of thing in env_run_lists within your roles?
[2012-11-21 00:07:00 -0500] alexw: rafaelmagu: or do you setup a default run_list and just specify the dev role
[2012-11-21 00:07:14 -0500] rafaelmagu: alexw: I'm not using env_run_lists
[2012-11-21 00:07:32 -0500] alexw: rafaelmagu: oh, so your dev and prod roles are identical
[2012-11-21 00:07:40 -0500] rafaelmagu: alexw: yup
[2012-11-21 00:08:14 -0500] rafaelmagu: We try to keep dev as close as possible to prod
[2012-11-21 00:09:38 -0500] jhopp: question for the chef wizards: i'm running chef client 10.12.0 in daemon mode. i've noticed that i have to restart the daemon to get some changes to take effect, notably, gems that are used during the chef run itself. has anyone else seen this?
[2012-11-21 00:10:40 -0500] rafaelmagu: jhopp: I believe gems are only loaded on startup
[2012-11-21 00:11:27 -0500] alexw: should .chef be added to .gitignore?
[2012-11-21 00:11:44 -0500] alexw: I don't really want to upload those .pem keys
[2012-11-21 00:11:54 -0500] alexw: or .chef/*.pem
[2012-11-21 00:12:36 -0500] jtimberman: alexw: i'd ignore the .pem files
[2012-11-21 00:12:52 -0500] jtimberman: alexw: if you're workin with other people it may be useful to share the knife config, or if you make custom bootstrap templates or knfie plugins
[2012-11-21 00:13:22 -0500] alexw: jtimberman: cheers
[2012-11-21 00:13:35 -0500] alexw: checksums also?
[2012-11-21 00:13:43 -0500] jtimberman: probably :)
[2012-11-21 00:13:51 -0500] alexw: but the data_bags are fine...
[2012-11-21 00:15:14 -0500] bluepojo: mrk__: Looks like the dude is not around. I don't remember where that file is
[2012-11-21 00:16:27 -0500] mrk__: alright
[2012-11-21 00:16:38 -0500] mrk__: thanks anyway! if i found out i'll you guys know
[2012-11-21 00:16:47 -0500] mrk__: i'd prefer not to have to regenerate the pem file :/
[2012-11-21 00:16:58 -0500] mrk__: its a pain to re-register all nodes etc
[2012-11-21 00:17:15 -0500] bluepojo: I don't believe you'll need to do that
[2012-11-21 00:17:26 -0500] bluepojo: validation.pem is only used on bootstrap, correct?
[2012-11-21 00:17:31 -0500] bluepojo: then it has it's own key
[2012-11-21 00:17:37 -0500] mrk__: oh ! i didn't know that
[2012-11-21 00:17:54 -0500] mrk__: so id just have to re-update that validation.pem file to S3 for new bootstraps
[2012-11-21 00:17:59 -0500] bluepojo: you'll have to distribute the validation.pem to any developers that need to bootstrap
[2012-11-21 00:18:06 -0500] bluepojo: but I think that's the extent of the damage done
[2012-11-21 00:18:24 -0500] mrk__: I see. that's manageable
[2012-11-21 00:19:17 -0500] mrk__: im curious why the validation.pem file isn't valid anymore tho. since i moved couchdb over too
[2012-11-21 00:19:19 -0500] bluepojo: validation.pem is required to create the client.pem, then client.pem is used for all future requests
[2012-11-21 00:19:32 -0500] mrk__: oh well - if i find out how to do this properly i'll make sure to share
[2012-11-21 00:19:38 -0500] bluepojo: please do
[2012-11-21 00:19:45 -0500] rafaelmagu: make that two
[2012-11-21 00:20:01 -0500] mrk__: seems like backing up / restoring chef servers isn't quite documented yet :D
[2012-11-21 00:20:02 -0500] rafaelmagu: Never managed to move Chef servers successfully
[2012-11-21 00:20:25 -0500] bluepojo: we've done it a few times, just with regenerating validation.pem as a caveat
[2012-11-21 00:20:39 -0500] alexw: Should the AWS settings in ~/.chef/knife.rb be imported into my repo even though I have a .chef/knife.rb file?
[2012-11-21 00:21:52 -0500] CharlieSu: Any Chef users use Splunk?  I'm thinking about writing a generic splunk cookbook for use with EC2.  Please let me know if you've heard of any other Splunk cookbooks I may want to look at first.
[2012-11-21 00:22:13 -0500] ranjibd: CharlieSu, yo
[2012-11-21 00:22:34 -0500] ranjibd: CharlieSu, splunk universal forwarder ..
[2012-11-21 00:22:48 -0500] jtimberman: there's this: http://community.opscode.com/cookbooks/splunk
[2012-11-21 00:22:54 -0500] ranjibd: CharlieSu, I think theres a community cookbook already
[2012-11-21 00:22:57 -0500] jtimberman: I haven't used it..
[2012-11-21 00:23:01 -0500] ranjibd: there yo go ^^
[2012-11-21 00:28:43 -0500] CharlieSu: I'm shocked I've never seen this before.  Thanks for the heads up.
[2012-11-21 00:29:23 -0500] rafaelmagu: CharlieSu: are you an Alfred.app user on a Mac, by any chance?
[2012-11-21 00:29:58 -0500] CharlieSu: I am.  Why?
[2012-11-21 00:30:19 -0500] rafaelmagu: CharlieSu: try this: alfredapp://customsearch/Search%20Opscode%20cookbooks%20for/cook/ascii/url=http://community.opscode.com/search?query={query}&scope=cookbook
[2012-11-21 00:30:29 -0500] joonas: how handy
[2012-11-21 00:30:33 -0500] rafaelmagu: I use it all the time for finding cookbooks
[2012-11-21 00:30:43 -0500] joonas: I've that set up for github :P
[2012-11-21 00:30:46 -0500] CharlieSu: dude I'm freaking out that you even thought I might be an Alfred user..
[2012-11-21 00:30:56 -0500] CharlieSu: That is the first applicaiton I install after a format
[2012-11-21 00:30:59 -0500] rafaelmagu: I just hit my shortcut, then type "cook <cookbook name>"
[2012-11-21 00:31:01 -0500] rafaelmagu: :)
[2012-11-21 00:31:17 -0500] rafaelmagu: CharlieSu: it was an extremely long shot
[2012-11-21 00:31:45 -0500] CharlieSu: rafaelmagu: I'm a hardcore Alfred user which is why I was so shocked..
[2012-11-21 00:31:50 -0500] rafaelmagu: Same
[2012-11-21 00:31:51 -0500] rafaelmagu: :D
[2012-11-21 00:32:23 -0500] rafaelmagu: I have similar searches for ruby-doc, Rdio and the Opscode wiki
[2012-11-21 00:34:17 -0500] CharlieSu: Do share..  msg me
[2012-11-21 00:35:58 -0500] jtimberman: CharlieSu: its one of the first ones i install because it starts with an "A" in "App Store" ;)
[2012-11-21 00:36:04 -0500] jtimberman: 1password is first, obviously.
[2012-11-21 00:36:20 -0500] rafaelmagu: Here you go: https://gist.github.com/4122285
[2012-11-21 00:38:05 -0500] fromonesrc: rafaelmagu: thank you :) another happy alfred user here
[2012-11-21 00:38:08 -0500] CharlieSu: jtimberman: I was a 1password user for years but made the switch to LastPass about 1 year ago.  I'm glad I made the switch
[2012-11-21 00:38:14 -0500] rafaelmagu: fromonesrc: happy to help
[2012-11-21 00:38:31 -0500] jtimberman: http://ckbk.it/1password :-)
[2012-11-21 00:38:33 -0500] rafaelmagu: CharlieSu jtimberman: Not convinced yet
[2012-11-21 00:38:45 -0500] rafaelmagu: Been using KeePass for a while
[2012-11-21 00:38:49 -0500] jtimberman: (though i install it from the app store, no way to automate that with chef that i've found yet)
[2012-11-21 00:39:06 -0500] cwj: i also use lastpass
[2012-11-21 00:39:17 -0500] cwj: and my team uses lastpass enterprise
[2012-11-21 00:40:38 -0500] CharlieSu: I'm a huge Yubikey fan and I have a Yubikey Nano in both of my laptops.  I like how it integrates with LastPass
[2012-11-21 00:41:03 -0500] CharlieSu: It is required to get the encrypted blob from their servers.
[2012-11-21 00:41:13 -0500] cwj: i wish aws was compatible with yubikey
[2012-11-21 00:41:56 -0500] CharlieSu: I've made a formal request.  But they'll stick with TOTP.
[2012-11-21 00:42:30 -0500] CharlieSu: Anyone going to AWS re: Invent by chance?  I'd love to meet up.
[2012-11-21 00:43:57 -0500] CharlieSu: cwj: my favorite feature of the YubiKey is Challenge Response.  You can do so much with it.
[2012-11-21 00:45:11 -0500] CharlieSu: I actually had talks w/ the main developer from 1Password about using challenge response with a yubikey to generate the database password more securly.  He didn't want to do it.
[2012-11-21 00:45:35 -0500] cwj: bummer
[2012-11-21 00:45:44 -0500] cwj: i shoudl ask for a yubikey for christmas
[2012-11-21 00:46:29 -0500] CharlieSu: great stocking stuffers :)
[2012-11-21 00:50:27 -0500] rafaelmagu: "Siri, remind me to Google 'yubikey' to see what these guys are talking about"
[2012-11-21 00:52:48 -0500] rafaelmagu: Question: is there a way to do a cookbook_file call using a wildcard? I want to copy all the files from a given directory in the cookbook to the target system
[2012-11-21 00:54:56 -0500] Majost: I have a template/erb in which null attribute values seem to be getting populated with either the value of "0"  or when the attribute is set to = '' the value is getting somehow set to the subsequent string attribute which is defined
[2012-11-21 00:55:08 -0500] Majost: and I have no idea why
[2012-11-21 00:55:42 -0500] Majost: I have tried using both default_unless and set_unless for these attributes
[2012-11-21 00:57:22 -0500] Majost: any ideas?
[2012-11-21 00:59:48 -0500] Majost: it feels like a bug in the provider
[2012-11-21 01:23:46 -0500] rafaelmagu: Anyone want to venture a guess as to what the Curiosity rover actually found?
[2012-11-21 01:27:15 -0500] fromonesrc: any windows chefs want to venture a guess as to why I'm getting undefined method 'read_mac_address' when upping a vagrant windows box? https://gist.github.com/4122291
[2012-11-21 01:33:28 -0500] yfeldblum: rafaelmagu, a dead cat?
[2012-11-21 01:38:02 -0500] joevandyk_: what do you guys use to monitor servers (load, cpu, io, etc)?
[2012-11-21 01:38:12 -0500] rafaelmagu: joevandyk_: Ganglia
[2012-11-21 01:38:30 -0500] rafaelmagu: joevandyk_: am just about to start using Sensu for alerts
[2012-11-21 01:38:37 -0500] rafaelmagu: Been using Nagios for years
[2012-11-21 01:41:47 -0500] bemu: joevandyk_: collectd and diamond
[2012-11-21 01:41:52 -0500] bemu: (plus graphite)
[2012-11-21 01:42:20 -0500] bemu: We used to use ganglia, but it's a huge pain when you have nodes going up and down regularly and you can't use broadcast.
[2012-11-21 01:42:52 -0500] bemu: More recent versions of ganglia are much more usable though.
[2012-11-21 01:42:58 -0500] bemu: in terms of the gui
[2012-11-21 01:46:27 -0500] rafaelmagu: bemu: not being able to use multicast on EC2 is annoying, but so far it's been pretty good for us
[2012-11-21 01:46:55 -0500] rafaelmagu: Graphite for graphing everything + statsd for app level metrics
[2012-11-21 01:47:25 -0500] rafaelmagu: bemu: I am using Graphite's graphs though, instead of Ganglia's
[2012-11-21 01:47:39 -0500] bemu: We use statsd as well.
[2012-11-21 01:47:43 -0500] bemu: scaling that has been interesting.
[2012-11-21 01:54:43 -0500] joevandyk_: bemu: how does collectd and diamond interact with graphite
[2012-11-21 01:54:50 -0500] rafaelmagu: Fitting that this week's episode of the Food Fight Show is titled "There's a Spork in my Berkshelf"
[2012-11-21 01:54:51 -0500] bemu: They pass data to it
[2012-11-21 01:55:49 -0500] joevandyk_: bemu: "diamond" is a terrible name to google for. got a link?
[2012-11-21 01:56:19 -0500] joevandyk_: http://opensource.brightcove.com/project/diamond that it?
[2012-11-21 01:56:31 -0500] bemu: You mean diamond graphite doesn't give you anything useful? :P
[2012-11-21 01:56:38 -0500] joevandyk_: does that overlap with collected?
[2012-11-21 01:56:41 -0500] bemu: Yes.
[2012-11-21 01:56:42 -0500] bemu: and yes.
[2012-11-21 01:57:10 -0500] bemu: We've been using collectd for some time, and started using diamond when we wanted more detail into our TCP conns.
[2012-11-21 01:58:06 -0500] bemu: ohh, the haproxy collector for diamond looks nice.
[2012-11-21 02:02:03 -0500] joevandyk_: I think i'll roll with collectd + graphite for now.
[2012-11-21 02:02:20 -0500] joevandyk_: trying out https://www.hostedgraphite.com so i don't have to mess with that
[2012-11-21 02:08:23 -0500] bemu: That seems like a very small number of metrics
[2012-11-21 02:08:29 -0500] alexw: is there an easy way to manage Amazon RDS servers
[2012-11-21 02:08:34 -0500] alexw: with knife?
[2012-11-21 02:08:40 -0500] alexw: and update databags with the config
[2012-11-21 02:08:42 -0500] bemu: the $200 plan only has 10,000 metrics.
[2012-11-21 02:08:57 -0500] bemu: We're currently tracking 600k metrics in graphite.
[2012-11-21 02:10:01 -0500] bemu: (though we're not a typical use case)
[2012-11-21 02:11:35 -0500] bemu: collectd uses a lot of 'metrics', basically.
[2012-11-21 02:14:02 -0500] bemu: joevandyk_: One thing I can definitely suggest is checking out descartes w/ graphite
[2012-11-21 02:14:28 -0500] bemu: https://github.com/obfuscurity/descartes
[2012-11-21 02:14:44 -0500] bemu: It's still very young, but we like it a lot
[2012-11-21 02:18:30 -0500] joevandyk_: bemu: thanks!
[2012-11-21 02:18:52 -0500] joevandyk_: i'll probably self-host graphite if I decide to use it more
[2012-11-21 02:19:01 -0500] joevandyk_: is it a pain to setup?
[2012-11-21 02:19:06 -0500] bemu: No problem! We're really happy with graphite in general. It was a lot of work to get it to the scale we're operating.
[2012-11-21 02:19:23 -0500] bemu: The initial installation isn't too bad. It's a bit to learn.
[2012-11-21 02:20:07 -0500] bemu: I think there are a few community cookbooks out there.
[2012-11-21 02:20:16 -0500] yfeldblum: can reset/solve handle adding new possible versions and new dependency constraints during a resolution?
[2012-11-21 02:44:59 -0500] chefologist: hi, how do I change my path from ~/.chef ... to ~/chef-repo ? ... thanks in advance
[2012-11-21 02:48:31 -0500] bluepojo: chefologist: why do you want to do that?
[2012-11-21 02:48:45 -0500] bluepojo: .chef and chef-repo do different jobs
[2012-11-21 02:48:55 -0500] chefologist: I have mirrored chef-repo locally
[2012-11-21 02:49:01 -0500] bluepojo: right
[2012-11-21 02:49:10 -0500] bluepojo: but do you have your knife.rb and pems in your chef-repo?
[2012-11-21 02:49:46 -0500] chefologist: yes I do, but when I run knife cookbook list ... I receive this error:  Error connecting to https://api.opscode.com/organizations/sbox//cookbooks?num_versions=1 - getaddrinfo: Temporary failure in name resolution
[2012-11-21 02:50:02 -0500] bluepojo: you probably shouldn't have your personal configs in your chef-repo
[2012-11-21 02:50:05 -0500] bluepojo: that's what ~/.chef is for
[2012-11-21 02:50:20 -0500] bluepojo: it's generally bad practice to check private keys into source control
[2012-11-21 02:50:26 -0500] chefologist: I have it in a private git-repo, so I am not concerned about them being public
[2012-11-21 02:50:42 -0500] bluepojo: what about when you get another developer/ops person who needs access to the chef-repo
[2012-11-21 02:50:58 -0500] chefologist: that is stage b
[2012-11-21 02:51:00 -0500] bluepojo: ideally everyone contributing to your cookbooks has access to the chef-repo
[2012-11-21 02:51:17 -0500] bluepojo: right, but as soon as you get to stage b, even if you delete your keys, anyone can get them from the repo history
[2012-11-21 02:51:25 -0500] chefologist: ok so why did I git clone chef-repo .. I'm confused now
[2012-11-21 02:51:39 -0500] bluepojo: that's where you store things like roles and environments
[2012-11-21 02:52:05 -0500] chefologist: so whats the diff between ~/chef-repo and ~/.chef?
[2012-11-21 02:52:13 -0500] bluepojo: .chef is where you store your personal credentials
[2012-11-21 02:52:24 -0500] bluepojo: chef-repo is where you store information that gets uploaded to the chef server
[2012-11-21 02:53:19 -0500] alexw: I think chefologist is trying to ask what is the different betwen ~/.chef and ~/chef-repo/.chef
[2012-11-21 02:53:21 -0500] chefologist: ok but I am still getting the error
[2012-11-21 02:53:23 -0500] bluepojo: oh
[2012-11-21 02:53:45 -0500] alexw: chefologist: what's the error?
[2012-11-21 02:54:00 -0500] bluepojo: can you ping api.opscode.com?
[2012-11-21 02:54:03 -0500] chefologist: ERROR: Network Error: Error connecting to https://api.opscode.com/organizations/sbox//cookbooks?num_versions=1 - getaddrinfo: Temporary failure in name resolution
[2012-11-21 02:54:12 -0500] bluepojo: sounds like DNS is not resolving
[2012-11-21 02:54:27 -0500] chefologist: AHHHHH I restarted my host, so I need to update my dns settings BRB apologies
[2012-11-21 02:54:42 -0500] bluepojo: you can put that in a recipe
[2012-11-21 02:54:55 -0500] rafaelmagu: Ah Berkshelf
[2012-11-21 02:54:57 -0500] bluepojo: we configure dns via a base::dns recipe
[2012-11-21 02:55:04 -0500] rafaelmagu: Sometimes you really try my patience
[2012-11-21 02:55:08 -0500] bluepojo: what's the issue?
[2012-11-21 02:55:13 -0500] bluepojo: with berkshelf
[2012-11-21 02:55:22 -0500] rafaelmagu: "Invalid ruby files in cookbook: nodejs-1.0.2 (1.0.2)."
[2012-11-21 02:55:31 -0500] rafaelmagu: Straight from the nodejs repo
[2012-11-21 02:55:39 -0500] bluepojo: do you have the repo on hand?
[2012-11-21 02:55:41 -0500] rafaelmagu: Except it doesn't tell me *what* files are invalid
[2012-11-21 02:55:43 -0500] bluepojo: or even better
[2012-11-21 02:55:49 -0500] bluepojo: can you give me your berksfile
[2012-11-21 02:55:51 -0500] rafaelmagu: https://github.com/mdxp/nodejs-cookbook.git
[2012-11-21 02:55:54 -0500] bluepojo: and I'll see if I can replicate it locally
[2012-11-21 02:57:01 -0500] bluepojo: it does indeed have a syntax error
[2012-11-21 02:57:28 -0500] rafaelmagu: Where?
[2012-11-21 02:57:28 -0500] bluepojo: well
[2012-11-21 02:57:31 -0500] bluepojo: maybe my command is incorrect, sc
[2012-11-21 02:57:32 -0500] bluepojo: sec
[2012-11-21 02:57:48 -0500] bluepojo: I take it back, no it doesn't
[2012-11-21 02:57:51 -0500] bluepojo: missed a command
[2012-11-21 02:57:52 -0500] rafaelmagu: What do you use for syntax checking?
[2012-11-21 02:58:00 -0500] erikh: instance_eval
[2012-11-21 02:58:13 -0500] rafaelmagu: in cli?
[2012-11-21 02:58:16 -0500] bluepojo: nodejs-cookbook jkiehl$ find . -name '*.rb' | xargs ruby -cw
[2012-11-21 02:58:16 -0500] bluepojo: Syntax OK
[2012-11-21 02:58:22 -0500] rafaelmagu: ah, right
[2012-11-21 02:59:11 -0500] rafaelmagu: Unhelpful error message is unhelpful
[2012-11-21 02:59:31 -0500] bluepojo: I agree
[2012-11-21 03:00:01 -0500] bluepojo: what command do you run to get that error?
[2012-11-21 03:00:46 -0500] bluepojo: it installed correctly: https://gist.github.com/4122752
[2012-11-21 03:01:40 -0500] bluepojo: added the line in the Berksfile I used to the gist
[2012-11-21 03:01:44 -0500] bluepojo: rafaelmagu:
[2012-11-21 03:01:58 -0500] rafaelmagu: sec
[2012-11-21 03:02:10 -0500] rafaelmagu: Hmm
[2012-11-21 03:02:24 -0500] rafaelmagu: My line was cookbook 'nodejs', git: 'https://github.com/mdxp/nodejs-cookbook.git'
[2012-11-21 03:02:31 -0500] bluepojo: my line is the same
[2012-11-21 03:02:36 -0500] bluepojo: github is just a wrapper for git
[2012-11-21 03:02:51 -0500] rafaelmagu: github wasn't there when I first wrote that Berksfile
[2012-11-21 03:02:56 -0500] bluepojo: all good
[2012-11-21 03:02:58 -0500] rafaelmagu: as an option of berks
[2012-11-21 03:03:02 -0500] bluepojo: I wrote that feature right before 1.0.0 was released
[2012-11-21 03:03:06 -0500] bluepojo: like an hour or two
[2012-11-21 03:03:07 -0500] bluepojo: lol.
[2012-11-21 03:03:09 -0500] rafaelmagu: hah
[2012-11-21 03:03:36 -0500] bluepojo: is it failing on install?
[2012-11-21 03:03:39 -0500] bluepojo: or something else?
[2012-11-21 03:03:45 -0500] bluepojo: maybe there was a download error
[2012-11-21 03:03:49 -0500] bluepojo: and you got a corrupted rb file
[2012-11-21 03:04:13 -0500] rafaelmagu: I thought that
[2012-11-21 03:04:23 -0500] chefologist: hi http://wiki.opscode.com/display/chef/Fast+Start+Guide talks about ~/chef-repo/.chef ... my ~/.chef is in a difference location, can I change it?
[2012-11-21 03:04:26 -0500] rafaelmagu: But then I completely deleted the .berkshelf/cookbooks folder
[2012-11-21 03:04:32 -0500] bluepojo: ah hm
[2012-11-21 03:04:35 -0500] rafaelmagu: Maybe my gem is old
[2012-11-21 03:04:40 -0500] bluepojo: can't hurt to update
[2012-11-21 03:04:46 -0500] bluepojo: berks version
[2012-11-21 03:04:58 -0500] rafaelmagu: 1.0.0rc2
[2012-11-21 03:05:06 -0500] bluepojo: $ find ~/.berkshelf/cookbooks/nodejs-055db6715e6129e1badbb4c79b6ef8ffb244bd9d/ -name '*.rb' | xargs ruby -cw
[2012-11-21 03:05:07 -0500] bluepojo: try that
[2012-11-21 03:05:21 -0500] bluepojo: if it's not a syntax error, maybe berkshelf is giving the wrong message
[2012-11-21 03:05:35 -0500] rafaelmagu: "Syntax OK"
[2012-11-21 03:05:40 -0500] bluepojo: hmmmm
[2012-11-21 03:06:12 -0500] rafaelmagu: Updating gem now
[2012-11-21 03:06:44 -0500] bluepojo: err my bash is bad
[2012-11-21 03:06:54 -0500] bluepojo: $ for i in $(find ~/.berkshelf/cookbooks/nodejs-055db6715e6129e1badbb4c79b6ef8ffb244bd9d/ -name '*.rb'); do ruby -cw $i; done
[2012-11-21 03:06:56 -0500] bluepojo: run that
[2012-11-21 03:06:59 -0500] jtimberman: FATAL: ./nodejs/recipes/default.rb:24: syntax error, unexpected keyword_end, expecting $end
[2012-11-21 03:07:01 -0500] bluepojo: I got a syntax error
[2012-11-21 03:07:03 -0500] rafaelmagu: Haha
[2012-11-21 03:07:18 -0500] bluepojo: exactly where jtimberman is saying
[2012-11-21 03:07:19 -0500] bluepojo: hah
[2012-11-21 03:07:23 -0500] jtimberman: there's an extra end
[2012-11-21 03:07:24 -0500] mdxp: hey guys
[2012-11-21 03:07:34 -0500] bluepojo: oh hi
[2012-11-21 03:07:44 -0500] rafaelmagu: I prefer using "find ~/.berkshelf/cookbooks/nodejs-055db6715e6129e1badbb4c79b6ef8ffb244bd9d/ -name '*.rb' -exec ruby -cs '{}' \;"
[2012-11-21 03:07:45 -0500] mdxp: the version we have on github might not be quite stable ;)
[2012-11-21 03:07:46 -0500] erikh: it checks the syntax of the whole cookbook?
[2012-11-21 03:07:57 -0500] mdxp: balbeko merged a bunch of stuff yesterday
[2012-11-21 03:08:03 -0500] rafaelmagu: mdxp: looks like it
[2012-11-21 03:08:14 -0500] rafaelmagu: mdxp: but for some reason berkshelf wasn't downloading the one from opscode
[2012-11-21 03:08:30 -0500] mdxp: i am checking it out now
[2012-11-21 03:08:36 -0500] jtimberman: latest_version:  http://cookbooks.opscode.com/api/v1/cookbooks/nodejs/versions/1_0_1
[2012-11-21 03:08:59 -0500] mdxp: what problems have you seen so far?
[2012-11-21 03:09:18 -0500] mdxp: yeah the version released on the cookbooks site should work fine
[2012-11-21 03:10:11 -0500] erikh: jtimberman: ohai
[2012-11-21 03:10:14 -0500] jtimberman: berks install:
[2012-11-21 03:10:14 -0500] jtimberman: Installing nodejs (1.0.1) from site: 'http://cookbooks.opscode.com/api/v1/cookbooks'
[2012-11-21 03:10:21 -0500] jtimberman: erikh: I WONT WRITE YER DOCS!!!
[2012-11-21 03:10:25 -0500] jtimberman: erikh: i mean, ohai!
[2012-11-21 03:10:26 -0500] erikh: Chef::Knife::Ssh and Chef::Knife::Bootstrap
[2012-11-21 03:10:38 -0500] erikh: return 0 exit status honey badger style
[2012-11-21 03:11:38 -0500] erikh: you can even give them invalid IP addresses and they still indicate success
[2012-11-21 03:12:35 -0500] mdxp: fixed the extra end from the default recipe
[2012-11-21 03:12:56 -0500] mdxp: let me know if you see other issues; i will test it out myself also
[2012-11-21 03:13:04 -0500] rafaelmagu: mdxp: cool, thanks
[2012-11-21 03:13:33 -0500] rafaelmagu: I went back to my Berksfile today to remove all unnecessary github repos
[2012-11-21 03:13:42 -0500] rafaelmagu: And instead relying on the opscode site versions
[2012-11-21 03:14:20 -0500] chefologist: hi why should I cp my pems and knife.rb to ~/chef-repo/.chef ?  they are currently in ~/chef-repo
[2012-11-21 03:14:34 -0500] bluepojo: they should be in ~/.chef
[2012-11-21 03:14:47 -0500] bluepojo: I believe is there a use case for having them elsewhere?
[2012-11-21 03:15:11 -0500] mdxp: if you have multiple repos, you will want the keys and configs in the local repo
[2012-11-21 03:15:18 -0500] jtimberman: erikh: i imagine the knife bootstrap returns 0 because it uses knife ssh
[2012-11-21 03:15:27 -0500] chefologist: bluepojo: I also have a ~/.chef directory very confused
[2012-11-21 03:15:36 -0500] matti: jtimberman: Hey
[2012-11-21 03:15:43 -0500] matti: jtimberman: Have a look https://gist.github.com/4121674
[2012-11-21 03:15:55 -0500] matti: jtimberman: I don't understand why this does not work as I think it shuld.
[2012-11-21 03:15:56 -0500] mdxp: chefologist: it will look first in the local folder, and if not there, it will look in your home
[2012-11-21 03:16:45 -0500] jtimberman: erikh: which comes from https://github.com/opscode/chef/blob/master/lib/chef/knife/ssh.rb#L208-L230
[2012-11-21 03:16:46 -0500] chefologist: mdxp, I would like to use ~/chef-repo/.chef as I have that under source control in github
[2012-11-21 03:17:35 -0500] mdxp: chefologist: sounds good. people usually exclude the .pem files from git for security
[2012-11-21 03:17:47 -0500] jtimberman: matti: remove the package_name 'hadoop-lzo_0.4.13_amd64.deb' line
[2012-11-21 03:17:49 -0500] jtimberman: from the package
[2012-11-21 03:17:56 -0500] jtimberman: dpkg_package that is
[2012-11-21 03:18:07 -0500] erikh: jtimberman: yep
[2012-11-21 03:18:09 -0500] mdxp: chefologist: i have that for every repo as i have many projects; and each has its own knife, etc.
[2012-11-21 03:18:14 -0500] erikh: I can work around the bootstrap case pretty easily and already have
[2012-11-21 03:18:15 -0500] jtimberman: matti: and this line isn't necessary:   only_if { File.exists?('/tmp/hadoop-lzo_0.4.13_amd64.deb') }
[2012-11-21 03:18:18 -0500] jtimberman: in the file resource
[2012-11-21 03:18:22 -0500] chefologist: mdxp: so can I cp my ~/.chef > ~/chef-repo/.chef then rm ~/.chef ?
[2012-11-21 03:18:25 -0500] erikh: I just try to load the node and see if it has a run list
[2012-11-21 03:18:35 -0500] matti: jtimberman: OK
[2012-11-21 03:18:38 -0500] erikh: if either of those don't work, it obviously didn't bootstrap
[2012-11-21 03:18:44 -0500] mdxp: chefologist: yeah; and run your knife commands from ~/chef-repo
[2012-11-21 03:18:45 -0500] erikh: driving random ssh commands is a little harder.
[2012-11-21 03:18:59 -0500] erikh: I guess I'll probably just use Net::SSH directly, as much as I hate to
[2012-11-21 03:19:02 -0500] mdxp: if you run them from another folder they will not find the config
[2012-11-21 03:19:37 -0500] mdxp: and look either in the local folder, or your home
[2012-11-21 03:19:48 -0500] jtimberman: erikh: ah ha - the ticket that added that ch.on_request block is reopened: http://tickets.opscode.com/browse/CHEF-2627
[2012-11-21 03:20:56 -0500] jtimberman: btw, probably gonna release test-kitchen 0.7.0 (maybe an rc) tomorrow: http://tickets.opscode.com/secure/IssueNavigator.jspa?reset=true&jqlQuery=project+%3D+KITCHEN+AND+fixVersion+%3D+%220.7.0%22+AND+status+%3D+%22Fix+Committed%22+ORDER+BY+priority+DESC&mode=hide (/cc ssd7)
[2012-11-21 03:21:18 -0500] erikh: mm, fun
[2012-11-21 03:21:22 -0500] jtimberman: okay i gotta run
[2012-11-21 03:21:23 -0500] jtimberman: bbiab
[2012-11-21 03:21:46 -0500] alexw: chefologist: place it in ~/chef-repo/.chef
[2012-11-21 03:22:02 -0500] alexw: otherwise you'll try running knife commands from another folder and it will create the cookbooks in wrong directory etc
[2012-11-21 03:22:10 -0500] chefologist: alexw: ok
[2012-11-21 03:22:13 -0500] alexw: unless you hard code this into knife.fb rather then current directory
[2012-11-21 03:22:27 -0500] chefologist: how can I remove ~/.chef
[2012-11-21 03:22:34 -0500] alexw: rm -rdf ~/.chef
[2012-11-21 03:22:37 -0500] alexw: have you copied your keys?
[2012-11-21 03:22:58 -0500] alexw: cp ~/.chef/* ~/chef-repo/.chef/
[2012-11-21 03:24:02 -0500] matti: jtimberman: That works.
[2012-11-21 03:24:11 -0500] matti: jtimberman: What when I set package name it does not get notified?
[2012-11-21 03:24:17 -0500] matti: jtimberman: :)
[2012-11-21 03:26:16 -0500] rafaelmagu: Thanks for all the help today, guys! Have a good one. :)
[2012-11-21 03:27:10 -0500] chefologist: alex: I have my pems, and have remove ~/.chef
[2012-11-21 03:27:34 -0500] chefologist: whats the purpose of ~/chef-repo/.chef/ folder?
[2012-11-21 03:27:38 -0500] matti: jtimberman: ? :)
[2012-11-21 03:28:23 -0500] alexw: chefologist: it's where you store some details about your folder locations etc
[2012-11-21 03:28:33 -0500] alexw: chefologist: also store your AWS keys in there (if applicable)
[2012-11-21 03:28:45 -0500] chefologist: alexw: ok
[2012-11-21 03:29:06 -0500] alexw: also stores your private keys
[2012-11-21 03:29:10 -0500] mdxp: chefologist: knife.rb, user key, etc.
[2012-11-21 03:29:34 -0500] alexw: alexw: if you are using git - I place the .chef directory into .gitignore
[2012-11-21 03:29:42 -0500] alexw: chefologist: *
[2012-11-21 03:30:06 -0500] chefologist: I have pems, knife.rb in ~/chef-repo/ currently which is also in github private
[2012-11-21 03:30:31 -0500] alexw: chefologist: you'd need to assess the security concern on your own
[2012-11-21 03:30:46 -0500] alexw: chefologist: but if you share that folder with anyone, i'd recommend against having those pems in there
[2012-11-21 03:31:52 -0500] chefologist: alexw: I am testing for now, but once I roll this out to my devteam, I guess I don't want my pems in there?  using hosted-chef
[2012-11-21 03:33:08 -0500] alexw: How can I store multiple cookbook versions in the same directory?
[2012-11-21 03:33:26 -0500] alexw: chefologist: nope - they will need their own PEM's
[2012-11-21 03:33:56 -0500] chefologist: alexw: thanks
[2012-11-21 03:35:51 -0500] chefologist: alexw: so I keep my pems in ~/chef-repo/.chef/ and run knife from this folder correct?
[2012-11-21 03:36:00 -0500] alexw: yup
[2012-11-21 03:36:11 -0500] alexw: run knife from ~/chef-repo
[2012-11-21 03:36:24 -0500] chefologist: ok cheers will try this
[2012-11-21 03:56:25 -0500] chefologist: when running knife cookbook upload ntp ... receiving this error: could not find cookbook ntp in your cookbook path ... absolute path is ~/chef-repo/cookbook/
[2012-11-21 03:57:35 -0500] chefologist: all sorted ... changed knife.rb to /../cookbook/ all good now
[2012-11-21 04:25:41 -0500] yfeldblum: can reset/solve handle adding new possible versions and new dependency constraints during a resolution?
[2012-11-21 04:46:44 -0500] erikh: yfeldblum: you could spend all day asking, or you could write a test case
[2012-11-21 04:48:00 -0500] yfeldblum: erikh, the question is about how i would even construct that test
[2012-11-21 04:48:35 -0500] erikh: well, I'd probably try resolving, then adding more things as I encounter them and updating the resolution
[2012-11-21 04:48:40 -0500] erikh: I know you can do this with gecode
[2012-11-21 04:50:26 -0500] yfeldblum: erikh, what do you mean by "try resolving"? is reset/solve supposed to support partial resolutions?
[2012-11-21 04:50:45 -0500] erikh: like let's say you start with 15 cookbooks; resolve, fetch the resolved set, add metadata as you encounter it, resolve, loop until you have the whole result set fetched
[2012-11-21 04:50:55 -0500] erikh: then dump it all in a dir
[2012-11-21 04:51:14 -0500] erikh: yfeldblum: I dunno. I'd probably read the code to figure that out
[2012-11-21 04:51:34 -0500] yfeldblum: erikh, heh well ahead of you on that front :D
[2012-11-21 04:51:50 -0500] jtimberman: yfeldblum: are you refering to this? https://github.com/reset/solve
[2012-11-21 04:51:55 -0500] yfeldblum: jtimberman, yes
[2012-11-21 04:51:57 -0500] jtimberman: ok
[2012-11-21 04:52:11 -0500] jtimberman: i was missing that context so your question looked bizarre :D
[2012-11-21 04:52:18 -0500] jtimberman: now it makes more sense :)
[2012-11-21 04:52:19 -0500] yfeldblum: jtimberman, hehe
[2012-11-21 04:52:33 -0500] erikh: for what it's worth, unless you have to pre-declare everything before attempting to resolve the working set, you should be able to do this no problem
[2012-11-21 04:52:37 -0500] yfeldblum: jtimberman, those who would likely know the answer would also likely know what reset/solve is :D
[2012-11-21 04:52:49 -0500] erikh: if that's how he wrote it, well, yeah
[2012-11-21 04:52:56 -0500] erikh: I've got my nice pants on today
[2012-11-21 04:54:12 -0500] erikh: doesn't seem like a pure dependency resolver would be very useful without the ability to make multiple passes
[2012-11-21 04:55:21 -0500] yfeldblum: erikh, librarian-chef does it with one pass through the resolver
[2012-11-21 04:55:47 -0500] erikh: you know what all your dependencies are ahead of time?
[2012-11-21 04:56:07 -0500] yfeldblum: erikh, of course librarian's resolver isn't terribly optimized yet
[2012-11-21 04:56:45 -0500] yfeldblum: erikh, no the resolver interrogates the things it is in the middle of resolving to discover new and additional facts and constraints
[2012-11-21 04:56:58 -0500] erikh: ah, so it pre-fetches?
[2012-11-21 04:58:55 -0500] yfeldblum: erikh, for example, if the resolver encounters, in the middle of the resolution, a cookbook declaration for cookbook "abcd" that depends on "ntp >= 1.2", then it fetches the list of versions for the "ntp" cookbook on-demand in the middle of the resolution, at the point in the resolution where that list becomes needed
[2012-11-21 05:09:36 -0500] yfeldblum: erikh, e.g. this line here: https://github.com/applicationsonline/librarian/blob/master/lib/librarian/resolver/implementation.rb#L75
[2012-11-21 05:09:56 -0500] yfeldblum: erikh, would actually trigger a fetch for the list of cookbook versions for a given cookbook name
[2012-11-21 05:10:25 -0500] yfeldblum: erikh, "manifest" being the generic term for "cookbook" in this case
[2012-11-21 06:05:34 -0500] BryanWB_: ohai chefs!
[2012-11-21 06:05:53 -0500] ssd7: Heya
[2012-11-21 06:06:41 -0500] ssd7: BryanWB_: Another interesting discussion re cookbooks earlier today/yesterday
[2012-11-21 06:06:56 -0500] BryanWB_: ssd7: did u get something out of it?
[2012-11-21 06:07:11 -0500] BryanWB_: ssd7: how can we make the hangouts more useful?
[2012-11-21 06:08:23 -0500] ssd7: BryanWB_: I really like the Hangouts.  Personally it would be nice to have a few that weren't recorded, but that is just me feeling wierd about being on youtube
[2012-11-21 06:09:20 -0500] BryanWB_: ssd7: sure, but we gotta record 'em :) for every person like u who does'nt want to be recorded, their are more shy ppl who just want to watch w/out participating :)
[2012-11-21 06:11:46 -0500] ssd7: BryanWB_: Indeed, same issue with code reviews
[2012-11-21 06:12:35 -0500] yfeldblum: ssd7, just think of it as training for your future campaign for public office
[2012-11-21 06:13:45 -0500] BryanWB_: ssd7: i would happily watch your intro to R, bayesian stats, and different statistical biases ;)
[2012-11-21 06:14:11 -0500] ssd7: BryanWB_: I've thought about doing some screencasts.  Probably not on R though.
[2012-11-21 06:24:38 -0500] miah: guh
[2012-11-21 06:37:40 -0500] BryanWB_: hi miah !
[2012-11-21 06:39:46 -0500] miah: hi
[2012-11-21 10:02:33 -0500] npx: So I want to do a really basic chef-solo run that adds a couple yum packages and removes a couple others. yum_package "whatever" do action :remove end right
[2012-11-21 10:02:46 -0500] npx: so I created a solo.rb file
[2012-11-21 10:02:50 -0500] npx: but apparently I need cookbooks?
[2012-11-21 10:03:06 -0500] npx: sup wit dat yo?
[2012-11-21 10:03:08 -0500] andreacampi: you do
[2012-11-21 10:03:13 -0500] andreacampi: recipes live in cookbooks
[2012-11-21 10:06:31 -0500] npx: ah okay
[2012-11-21 10:09:07 -0500] BryanWB_: npx, u can try chef-recipe just to get started w/ what you are taling about https://github.com/bryanwb/chef-recipe
[2012-11-21 10:09:38 -0500] andreacampi: ah, right
[2012-11-21 10:09:43 -0500] andreacampi: hey BryanWB_ :)
[2012-11-21 10:09:49 -0500] BryanWB_: andreacampi: hey man :)
[2012-11-21 10:12:01 -0500] npx: so I made a recipe with knife, edited default.rb, added: package "mytest" do command "yum -y install stuff" end
[2012-11-21 10:12:09 -0500] npx: but I run chef-solo and it mocks me by doing nothing
[2012-11-21 10:12:12 -0500] npx: it laughs in my face
[2012-11-21 10:12:41 -0500] Virunga: Hi, i get this error Chef::Exceptions::Exec: apt-get -q -y install sadms=2.0.15.repack-0ubuntu2 returned 100, expected 0, but /var/log/dpkg.log shows nothing about it. The chef log doesn't help much to undestand what happened. Do you know where i can find more info?
[2012-11-21 10:12:56 -0500] Virunga: Info about what happened.
[2012-11-21 10:14:48 -0500] remil: I'm facing some git issue, fetched a cookbook from opscode via git, treated it as submodule but I had to make some slight changes, how can I git push those submodules change to my git bare repository ?
[2012-11-21 10:24:15 -0500] railsraider: can someone please help me understand this http://pastie.org/5411079
[2012-11-21 10:24:26 -0500] railsraider: i just ran the base role
[2012-11-21 10:24:30 -0500] corp: miah: ping
[2012-11-21 10:24:43 -0500] railsraider: when i query the node it does not return the normal attribute
[2012-11-21 10:24:56 -0500] railsraider: how can i make sure the attribute sticks?
[2012-11-21 10:25:12 -0500] railsraider: maybe I'm querying it wrong
[2012-11-21 10:25:22 -0500] railsraider: hosts = search(:node, "icinga:host_groups", "X_CHEF_id_CHEF_X asc")
[2012-11-21 10:25:23 -0500] corp: railsraider: what's the expected result?
[2012-11-21 10:25:34 -0500] railsraider: to see the normal attributes
[2012-11-21 10:25:38 -0500] railsraider: for the icinga
[2012-11-21 10:26:15 -0500] railsraider: node.icinga.host_groups should show ["base", "app-server", "resque"]
[2012-11-21 10:26:29 -0500] railsraider: but instead only shows ["base"]
[2012-11-21 10:26:42 -0500] railsraider: which is the role that just ran on the node
[2012-11-21 10:27:44 -0500] railsraider: corp:  its confusing me cause ohai saves the node data  at the end of the chef run
[2012-11-21 10:28:30 -0500] railsraider: my goal is to set the host_groups for the icinga  from the nodes
[2012-11-21 10:28:33 -0500] corp: railsraider: i'm not sure about that. i haven't kept up to date on whether roles attributes are indexed or not
[2012-11-21 10:28:44 -0500] railsraider: they are
[2012-11-21 10:28:59 -0500] railsraider: is there a "live" query?
[2012-11-21 10:29:10 -0500] railsraider: not the last saved data
[2012-11-21 10:29:28 -0500] corp: dont know about that
[2012-11-21 10:29:35 -0500] corp: where did you get the above query?
[2012-11-21 10:30:10 -0500] railsraider: from this hosts = search(:node, "icinga:host_groups", "X_CHEF_id_CHEF_X asc")
[2012-11-21 10:30:17 -0500] railsraider: then i loop over the hosts
[2012-11-21 10:30:32 -0500] corp: what's the last argument?
[2012-11-21 10:30:35 -0500] railsraider: each host i make a template with       :hostgroups => host.icinga.host_groups.join(", ")
[2012-11-21 10:30:54 -0500] railsraider: that's just means sorting is always the same order
[2012-11-21 10:31:08 -0500] railsraider: it's not doing anything
[2012-11-21 10:31:28 -0500] corp: i'm not sure waht oyu mean 'live' versus 'last saved'
[2012-11-21 10:31:51 -0500] railsraider: if the node has normal attributes that are set and i can see them if i do the node edit
[2012-11-21 10:32:14 -0500] corp: right. if all attributes from a run are indexed, not sure there's a solution for that via search
[2012-11-21 10:32:17 -0500] railsraider: and i get the data out of the search  which is the last state save
[2012-11-21 10:32:29 -0500] railsraider: the last state had override attribute
[2012-11-21 10:32:55 -0500] railsraider: in other words, how can i get the normal attributes of the node
[2012-11-21 10:33:14 -0500] railsraider: even without a search,
[2012-11-21 10:33:25 -0500] railsraider:  i need to find a way to loop through all the nodes
[2012-11-21 10:33:37 -0500] railsraider: and query the node normal attribute
[2012-11-21 10:33:56 -0500] railsraider: if its not with a search how can it be done?
[2012-11-21 10:33:57 -0500] corp: you'd have to access the API directly to do that
[2012-11-21 10:35:24 -0500] railsraider: any pointer as to how / where the api is? i don't see it on the wiki
[2012-11-21 10:35:50 -0500] corp: you could get the node names from your query, then run: knife node show -a icinga:host_groups
[2012-11-21 10:36:41 -0500] railsraider: let me try that in shef
[2012-11-21 10:38:01 -0500] railsraider: won't work i have to setup the node for knife.rb and stuff
[2012-11-21 10:38:18 -0500] railsraider: has to be another wayy
[2012-11-21 10:38:25 -0500] corp: aren't you using knife here for search?
[2012-11-21 10:38:36 -0500] corp: if you're doing this in a recipe, i dont know any other way
[2012-11-21 10:38:37 -0500] railsraider: no thats from a recipe
[2012-11-21 10:38:55 -0500] corp: seems like you should not rely on the hostgroups if they are being overriden
[2012-11-21 10:39:12 -0500] railsraider: maybe they should not be override at all
[2012-11-21 10:39:15 -0500] corp: since the overridden state is the final one
[2012-11-21 10:39:16 -0500] railsraider: i'll fix it
[2012-11-21 10:40:20 -0500] corp: railsraider: yeah, you can instead just have the base group as default, and use roles to add more. arrays wont merge in that case, but you could change it to a hash for that behvior
[2012-11-21 10:40:28 -0500] pubudu_: can someone please help me with this
[2012-11-21 10:40:44 -0500] pubudu_: i made a change to my default.rb file in my chef server
[2012-11-21 10:40:52 -0500] railsraider: corp: how do i set normal attributes via role?
[2012-11-21 10:40:59 -0500] railsraider: or maybe i can't
[2012-11-21 10:41:12 -0500] Grainger: Hi all
[2012-11-21 10:41:14 -0500] pubudu_: but those changes are not reflected in clients
[2012-11-21 10:41:53 -0500] pubudu_: i restarted my chef-server instance also
[2012-11-21 10:43:04 -0500] slivabox: have you reupload your cookbook after you made chages in it?
[2012-11-21 10:43:15 -0500] slivabox: with knife
[2012-11-21 10:43:42 -0500] pubudu_: ohh i didn't
[2012-11-21 10:43:52 -0500] pubudu_: let me reupload then
[2012-11-21 10:54:43 -0500] pubudu_: silvabox: it did work !!! you saved my day
[2012-11-21 10:54:50 -0500] pubudu_: thanks m8
[2012-11-21 10:56:37 -0500] slivabox: you are welcome
[2012-11-21 11:27:14 -0500] Grainger: May I ask a cookbook question here, too?
[2012-11-21 11:36:19 -0500] Grainger: May I ask a cookbook question here, too?
[2012-11-21 11:44:07 -0500] aruntomar: Grainger: just ask
[2012-11-21 11:45:59 -0500] Grainger: THX! - I have a couple of recipes that declare a service and then attempt to make that service autostart, with lines like "action [ :enable, :start ]" - however, nothing seems to happen (the service is neither started in the chef run nor at the next restart). What should I look for?
[2012-11-21 11:50:39 -0500] corp: anyone using the opscode application::unicorn recipe?
[2012-11-21 11:51:23 -0500] aruntomar: Grainger: paste the code to gist or pastebin and paste the link here
[2012-11-21 11:51:59 -0500] Grainger: OK
[2012-11-21 11:54:06 -0500] Grainger: aruntomar: Here it is. http://pastebin.com/w38cTRxi - the target clients are running Debian
[2012-11-21 12:04:21 -0500] aruntomar: Grainger: r u using chef-solo or chef-server?
[2012-11-21 12:07:00 -0500] Grainger: aruntomar: chef server
[2012-11-21 12:07:48 -0500] aruntomar: Grainger: your code seems to be ok. still looking into it. in the meantime, try running "chef-client -l debug"
[2012-11-21 12:08:03 -0500] Grainger: aruntomar: OK, one moment
[2012-11-21 12:12:53 -0500] Grainger: aruntomar: hrmf... for ganglia, it was easy: the /etc/init.d entry isn't called gmond but ganglia-monitor. I've tried the same with sFlow, and I *think* I found a solution there, too (no "pattern" statement). Thanks a lot for your help! - I'll ask again if changing the pattern to "ganglia-monitor" and "hsflowd" doesn't work, but I guess it will.
[2012-11-21 12:17:17 -0500] aruntomar: Grainger: welcome :)
[2012-11-21 12:18:27 -0500] Grainger: interesting: On sflowd, chef claims it's already running: "[...] DEBUG: service[hsflowd] already running - nothing to do" - but /etc/init.d/hsflowd status says it's stopped, and it doesn't show up in "ps au", either.
[2012-11-21 12:19:29 -0500] Grainger: here's the sFlow recipe: http://pastebin.com/W1e10jAY
[2012-11-21 12:36:24 -0500] gyre007_: l
[2012-11-21 12:41:00 -0500] gyre007: is the omnibus install broken ? Im just setting up my new laptop and am getting this: SSL: certificate subject name '*.opscode.com' does not match target host name 'opscode.com'
[2012-11-21 12:48:49 -0500] bbommarito: Good morning all, have a quick question that perhaps someone can answer:
[2012-11-21 12:50:08 -0500] specialsauce: hey, if I store a node as an rb file in my git repo, and then run "Knife node from file" after updating the file, the node does not return from search on expanded run list roles until after I run chef-client on that node next. Is there an alternative knife node command to update a node without invalidating its role list in solr?
[2012-11-21 12:50:16 -0500] bbommarito: I am using Vagrant + chef-solo to test recipes locally. Now, I am using a chef that supports data_bags, and vagrant knows where the data_bags are. Using data_bags('admin') pulls back expected data, but when I use data_bag_items('admins', 'admin_name'), I get an error: Cannot find a resource for data_bag_items. Now, data_bag/admins contains the admin_name.json formatted correctly.
[2012-11-21 12:50:44 -0500] wildfire: has anyone else seen:  undefined method `log_level' for main:Object (NoMethodError)
[2012-11-21 12:50:51 -0500] wildfire: I get this no matter what knife command I run
[2012-11-21 12:51:14 -0500] bbommarito: Oh, and also of note, the 'admin_name' is shown in the array from data_bags('admin')
[2012-11-21 12:52:13 -0500] specialsauce: wildfire: you probably have an error in your knife.rb file?
[2012-11-21 12:52:21 -0500] specialsauce: it should read eg "log_level :info"
[2012-11-21 12:53:41 -0500] wildfire: specialsauce: it does have that line; and if I remove that line, it starts complaining about the next (and so on)
[2012-11-21 12:54:59 -0500] specialsauce: wildfire: you on windows?
[2012-11-21 12:55:31 -0500] specialsauce: if so, possible you're hitting CHEF-2305 ?
[2012-11-21 12:59:45 -0500] wildfire: specialsauce: nope, unix - and I regenerate a brand new file and the same problem
[2012-11-21 13:00:41 -0500] Grainger: FWIW, the answers to my discussions with <aruntomar> earlier: There are two *distinct* problems. Ganglia seems to work, the service doesn't claim to know about "status", so ganglia is matching the declared "pattern" against the process list and successfully determines whether it needs to be started or not. Don't know what went wrong in the original recipe. sFlow *claimed* to know about "status"
[2012-11-21 13:00:42 -0500] Grainger: (because there is a "status" argument to the script in /etc/init.d that *prints* the right response), but it DOESN'T know about status in the sense that the init script *ALWAYS* returns "0", even if the service isn't running. Remove "supports :status => true" and it works like a charm...  I hope these lines help someone who digs through the archives later. I definitely picked up some valuable
[2012-11-21 13:00:42 -0500] Grainger: tips there. Thanks to everybody!
[2012-11-21 13:03:39 -0500] cassianoleal: any way to tell Berkshelf to look for cookbooks in a local directory?
[2012-11-21 13:04:14 -0500] cassianoleal: I have a cookbook that depends on another cookbook who lives in my local disk
[2012-11-21 13:04:27 -0500] cassianoleal: I already have "chef_api :config" in the Berksfile
[2012-11-21 13:04:48 -0500] cassianoleal: and the cookbooks dir is set in the cookbook_path in knife.rb
[2012-11-21 13:05:22 -0500] cassianoleal: still, I get "cookbook not found in any of the default locations"
[2012-11-21 13:25:53 -0500] daften: i can't find any resources about backing up and restoring from backup for e.g. a web server, a db server
[2012-11-21 13:25:58 -0500] daften: are there cookbooks that help with that
[2012-11-21 13:26:21 -0500] daften: and that e.g. will on provisioning will look for the latest backup and restore that
[2012-11-21 13:27:14 -0500] daften: especially that last item is important
[2012-11-21 13:27:26 -0500] geekbri: http://i.imgur.com/xOwNQ.png
[2012-11-21 13:32:46 -0500] daften: @geekbri: was that an answer to my question? :P
[2012-11-21 13:33:01 -0500] geekbri: No but didn't it make you feel better??
[2012-11-21 13:33:04 -0500] daften: geekbri: was that an answer to my question? :P
[2012-11-21 13:33:27 -0500] daften: geekbri: a little bit
[2012-11-21 13:33:34 -0500] geekbri: daften: we wrote our own cookbook for backing up stuff.  We use the "backup" gem.  It's pretty straightforward
[2012-11-21 13:33:47 -0500] daften: geekbri: thanks, will look into it
[2012-11-21 13:33:49 -0500] geekbri: daften: give it a look here see.  https://github.com/meskyanichi/backup
[2012-11-21 13:34:10 -0500] geekbri: daften: Basically I just wrote a cookbook we use internally that lays down the configuration files where appropriate.  Then you can enable and disable a cron job that runs the backups
[2012-11-21 13:34:31 -0500] daften: geekbri: cool, that seems straightforward indeed
[2012-11-21 13:34:48 -0500] daften: geekbri: how about restoring a backup on provision, do you know if that's possible with relative ease?
[2012-11-21 13:35:33 -0500] geekbri: daften: Depends on what you are restoring I guess and how you chose to back it up :).  I would imagine that will require some custom stuff of your own to handle
[2012-11-21 13:36:10 -0500] daften: geekbri: well, i'd like a rotating backup with at least 3 different versions, this for files and db's i think. and then on provision restore the latest backup :)
[2012-11-21 13:36:28 -0500] geekbri: Like I said, sounds like you'll be writing some custom stuff for that :-P
[2012-11-21 13:36:50 -0500] daften: geekbri: i'll start with automatic backups first, that will be enough already, still getting the hang of chef and am setting up a chef server atm and also figuring out how to best use that with vagrant
[2012-11-21 13:36:57 -0500] daften: geekbri: i'm guessing environments
[2012-11-21 13:37:01 -0500] wildfire: which plugin is 'log_level' in for knife?
[2012-11-21 13:40:19 -0500] daften: geekbri: thanks for the tips!
[2012-11-21 13:40:33 -0500] geekbri: no problemo
[2012-11-21 13:52:54 -0500] bougyman: so if node["some"]["attrib"] = "thing" is deprecating, is the new form node.set["some"]["attribute"]= or node.some.set["attribute"]= ?
[2012-11-21 13:53:37 -0500] bougyman: hi fujin
[2012-11-21 14:02:07 -0500] Virunga: Can i use the log resource inside another resource?
[2012-11-21 14:06:05 -0500] Virunga: I manage to use it inside a resource like this Chef::Resource::log(...), maybe you know a better way?
[2012-11-21 14:06:14 -0500] bougyman: looking for tips on how to debug using chef.
[2012-11-21 14:06:20 -0500] bougyman: http://stevendanna.github.com/blog/2012/01/28/shef-debugging-tips-1/ that is not working for me at all.
[2012-11-21 14:06:30 -0500] bougyman: specifically, the include_recipe parts are failing.
[2012-11-21 14:06:55 -0500] corp: bougyman: how do you know they are failing?
[2012-11-21 14:07:08 -0500] Virunga: No, that doesn't work either
[2012-11-21 14:07:09 -0500] bougyman: i get Chef::Exceptions::CookbookNotFound
[2012-11-21 14:07:26 -0500] corp: bougyman: you need to upload the cookbook
[2012-11-21 14:07:29 -0500] bougyman: but the cookbook is there, in the cahce at least.
[2012-11-21 14:07:37 -0500] bougyman: corp: this runs fine with chef-client
[2012-11-21 14:07:45 -0500] corp: bougyman: what are you using, chef solo?
[2012-11-21 14:07:54 -0500] bougyman: i'm trying to debug with shef, i've tried this before and failed, as well.
[2012-11-21 14:08:00 -0500] bougyman: no, opscode hosted.
[2012-11-21 14:08:19 -0500] corp: bougyman: you have to upload the cookbook to the hosted chef server
[2012-11-21 14:08:23 -0500] bougyman: the cookbook is here, it runs fine with chef, I can't figure out how to get it loaded into shef.
[2012-11-21 14:08:30 -0500] corp: oh
[2012-11-21 14:08:36 -0500] corp: using shef -z?
[2012-11-21 14:08:42 -0500] bougyman: following those instructions I thought would do it.
[2012-11-21 14:08:57 -0500] bougyman: yeah, shef -z and trying his node.run_list.expand(node.chef_environment).recipes.each do |r| include_recipe r
[2012-11-21 14:09:01 -0500] bougyman: end
[2012-11-21 14:09:13 -0500] bougyman: that's where i get all the cookbook not found stuff, but I know they're all there.
[2012-11-21 14:09:23 -0500] corp: ah. i don't use shef for anything
[2012-11-21 14:09:36 -0500] bougyman: i really miss having repl for debugging.
[2012-11-21 14:09:38 -0500] bmcgee: Hey guys, I can see how to copy a file using cookbook_file, is it possible to sync a directory to a node instead?
[2012-11-21 14:09:48 -0500] bougyman: since i've been working on chef the best i've gotten is to put breakpoints directly in recipes.
[2012-11-21 14:09:54 -0500] corp: bmcgee: you can use remote_directory
[2012-11-21 14:09:57 -0500] bougyman: but that shouldn't be necessary, shef is supposed to do this.
[2012-11-21 14:09:58 -0500] bmcgee: sweet, thx
[2012-11-21 14:10:04 -0500] bougyman: i just can't figure out the magic.
[2012-11-21 14:10:09 -0500] corp: bougyman: yeah. i haven't had luck using shef for that
[2012-11-21 14:11:54 -0500] corp: lunch here
[2012-11-21 14:12:08 -0500] masterkorp: bougyman: You can use the helpers on that site
[2012-11-21 14:12:33 -0500] masterkorp: there is an insert_breakpoint(:before/:after, resouce)
[2012-11-21 14:15:14 -0500] bougyman: masterkorp: right, i just said those don't work, thus my dilemna
[2012-11-21 14:15:29 -0500] bougyman: that's exactly what I want to accomplish, i thought that was the gold.
[2012-11-21 14:15:43 -0500] bougyman: load_node_run_list fails, so of course nothing below it would work.
[2012-11-21 14:16:04 -0500] masterkorp: bougyman: hmm, output ?
[2012-11-21 14:17:03 -0500] bougyman: Chef::Exceptions::CookbookNotFound
[2012-11-21 14:17:14 -0500] bougyman: but the cookbook is there, it runs with chef-client just fine
[2012-11-21 14:17:30 -0500] bougyman: using -z and -j to the same json I pass to chef-client -j
[2012-11-21 14:17:42 -0500] bougyman: it loads the proper run list
[2012-11-21 14:17:47 -0500] bougyman: just can't find any of the cookbooks.
[2012-11-21 14:17:55 -0500] bougyman: where is it looking? they exist in /var/cache/chef/
[2012-11-21 14:19:54 -0500] masterkorp: as root ?
[2012-11-21 14:20:22 -0500] masterkorp: what's your shef config ?
[2012-11-21 14:20:52 -0500] bougyman: i don't have a shef config
[2012-11-21 14:20:55 -0500] bougyman: and yes, as root
[2012-11-21 14:21:02 -0500] bougyman: i added the unless defined?(Shef).nil? $: << File.expand_path("~/src/knife-hacks/")
[2012-11-21 14:21:06 -0500] bougyman: to client.rb
[2012-11-21 14:21:57 -0500] masterkorp: shef -z -c /etc/client.rb Gives you something ?
[2012-11-21 14:22:05 -0500] bougyman: it's like it doesn't seed the cookbook collection
[2012-11-21 14:22:05 -0500] Grainger: Does anybody have a good way to run "apt upgrade" via chef? I don't want to use cron but compatibility-test first in a sandbox and then upgrade, ideally targetting only the tested versions.
[2012-11-21 14:22:13 -0500] zeroXten: In what order does chef process attribute ruby files?
[2012-11-21 14:23:27 -0500] bougyman: https://gist.github.com/4125086
[2012-11-21 14:23:41 -0500] bougyman: it seems to act fine, gets the proper run list.
[2012-11-21 14:25:36 -0500] matschaffer: hi, can anyone recommend a good channel for attacks and exploits? Got some funky stuff in my nginx logs just before the box went offline. I realize this isn't the right channel, but thought folks here might have recommendations.
[2012-11-21 14:26:03 -0500] geekbri: matschaffer: I saw on hacker news that there is some new rootkit out there, it involves nginx somehow
[2012-11-21 14:26:11 -0500] geekbri: Could be totally unrelated though :)
[2012-11-21 14:26:13 -0500] bougyman: masterkorp: then https://gist.github.com/4125086#comments
[2012-11-21 14:27:03 -0500] bougyman: matschaffer: #security has some people who can help
[2012-11-21 14:27:09 -0500] bougyman: or you can take it pm if you like.
[2012-11-21 14:27:16 -0500] Virunga: I get this error http://ideone.com/9GAFVc
[2012-11-21 14:27:28 -0500] Virunga: From where i understand where is the error?
[2012-11-21 14:27:29 -0500] matschaffer: thanks geekbri, I'll see if I can dig it up
[2012-11-21 14:27:37 -0500] bougyman: http://seclists.org/fulldisclosure/2012/Nov/94
[2012-11-21 14:27:41 -0500] bougyman: fulldisclosure is the best.
[2012-11-21 14:27:46 -0500] geekbri: matschaffer: http://news.ycombinator.com/item?id=4814038
[2012-11-21 14:28:33 -0500] geekbri: unfortunately none of it says anything about what the attack vector is.  So it is totally possible that it is 100% completely unrelated to nginx directly.
[2012-11-21 14:30:54 -0500] Virunga: What does this mean? NoMethodError: ruby_block[add_hosts_sett] (sadms::prereq line 21) had an error: NoMethodError: undefined method `call' for nil:NilClass
[2012-11-21 14:31:20 -0500] matschaffer: geekbri: that's a shame :(
[2012-11-21 14:31:47 -0500] itchyouch: So what's a good rule of thumb between choosing to out data in a data bag versus an attribute in a cookbook?
[2012-11-21 14:32:36 -0500] BryanWB_: itchyouch: if u use it across many cookbooks, like users
[2012-11-21 14:32:47 -0500] BryanWB_: passwds, or certs
[2012-11-21 14:32:49 -0500] bougyman: masterkorp: you give up?
[2012-11-21 14:33:12 -0500] bougyman: I'm about to monkey patch this to do a from_file load of all the damned things.
[2012-11-21 14:34:01 -0500] itchyouch: BryanWB_:  thanks.
[2012-11-21 14:34:26 -0500] BryanWB_: don't put data in roles , or did I say that already ? :p
[2012-11-21 14:34:26 -0500] bougyman: wow, i don't understand this at all.
[2012-11-21 14:35:46 -0500] itchyouch: BryanWB_:  you mean attributes that can be attached to a role?
[2012-11-21 14:35:48 -0500] bougyman: masterkorp: https://github.com/opscode/chef/blob/master/lib/chef/cookbook/cookbook_collection.rb#L38 that's the line raising.
[2012-11-21 14:35:57 -0500] bougyman: I don't see any way for it _not_ to raise, very confusing code, there.
[2012-11-21 14:36:13 -0500] BryanWB_: itchyouch: i don't recommend putting more than minimal attributes or attribute-like data in a roel
[2012-11-21 14:36:18 -0500] jtimberman: listen not to the role naysayers :)
[2012-11-21 14:37:15 -0500] bougyman: masterkorp: does that make any sense to you?
[2012-11-21 14:38:57 -0500] itchyouch: BryanWB_:  thanks
[2012-11-21 14:40:33 -0500] bougyman: BryanWB_: do you know now to load resources in shef (-z, client mode) from the run_list?
[2012-11-21 14:40:44 -0500] BryanWB_: y
[2012-11-21 14:41:08 -0500] BryanWB_: bougyman:   r = resources("template[foo]")
[2012-11-21 14:41:09 -0500] bougyman: plz helps! I get https://gist.github.com/4125086#comments
[2012-11-21 14:41:20 -0500] BryanWB_: bougyman: but u probably have to type `recipe` first
[2012-11-21 14:41:20 -0500] bougyman: ah, yes, I know how to do it manually
[2012-11-21 14:41:29 -0500] bougyman: I did, see gist.
[2012-11-21 14:42:37 -0500] bougyman: was following http://stevendanna.github.com/blog/2012/01/28/shef-debugging-tips-1/ on how to debug a hairy problem in my run_list.
[2012-11-21 14:42:58 -0500] bougyman: just keep hitting the wall at https://github.com/opscode/chef/blob/master/lib/chef/cookbook/cookbook_collection.rb#L38.
[2012-11-21 14:43:57 -0500] bougyman: there's obviously some step i'm missing, to get the cookbook collection seeded in shef.
[2012-11-21 14:44:18 -0500] bougyman: i have a feeling I need a one-liner to make this work, just can't figure that line out.
[2012-11-21 14:44:42 -0500] BryanWB_: read the tests in chef/spec for things like chef-solo or chef_client
[2012-11-21 14:44:51 -0500] BryanWB_: u may need something like load_node
[2012-11-21 14:44:54 -0500] BryanWB_: sorry, gtg :/
[2012-11-21 14:47:14 -0500] itchyouch: Is there a good recipe for configuring network interfaces as part of the initial setup of a host?
[2012-11-21 14:47:18 -0500] bougyman: hrm, I see become_node
[2012-11-21 14:47:28 -0500] bougyman: it takes an argument
[2012-11-21 14:48:20 -0500] matschaffer: thanks again bougyman and geekbri. This machine didn't contain any important data so I think we'll swap it out. Appreciate the assist.
[2012-11-21 14:49:18 -0500] bougyman: ah, become_node is to become another node.
[2012-11-21 14:50:07 -0500] geekbri: jtimberman: I'm with you on the role stuff.  I think every situation is different, but that you shoudln't be afraid to put some information in role files :)
[2012-11-21 14:50:26 -0500] bougyman: i guess I just need to know how to load a cookbook manually
[2012-11-21 14:50:40 -0500] bougyman: into a shef env
[2012-11-21 14:51:39 -0500] KarlFreeman: Is there a way to run a recipe inside another recipe? ( eg run a recipe inside a deploy resource's after_restart bloc)
[2012-11-21 14:51:53 -0500] geekbri: include_recipe
[2012-11-21 14:55:32 -0500] KarlFreeman: Looks like there is a scope issue with that 'NoMethodError: undefined method `include_recipe' for #<Chef::Provider::Deploy::Revision'
[2012-11-21 14:56:10 -0500] bougyman: you can't do it inside a provider.
[2012-11-21 14:56:15 -0500] bougyman: I tried the same.
[2012-11-21 14:56:35 -0500] bougyman: i'm so frustrated with shef I want to throw something
[2012-11-21 14:56:44 -0500] bougyman: I think i'm gonna.
[2012-11-21 14:57:27 -0500] KarlFreeman: Shame, it also looks like there isn't a way to notify to run a recipe either. Guess I need to work harder at making the post-processing recipes of this provider to be more idempotant
[2012-11-21 14:57:46 -0500] bougyman: you can do notifies in a provider, I do that often.
[2012-11-21 14:57:56 -0500] KarlFreeman: ah, ok.
[2012-11-21 14:58:03 -0500] KarlFreeman: This could work. Thanks
[2012-11-21 14:59:36 -0500] andreacampi: bougyman KarlFreeman you can do it from a provider, actually just make sure to include Chef::Mixin::LanguageIncludeRecipe
[2012-11-21 14:59:52 -0500] bougyman: andreacampi: i guess I meant I was told it's a bad idea to do so.
[2012-11-21 15:00:09 -0500] andreacampi: oh yeah, not necessarily good form :)
[2012-11-21 15:00:40 -0500] KarlFreeman: Thanks andreacampi, i'll give that a go.
[2012-11-21 15:01:09 -0500] andreacampi: sure
[2012-11-21 15:01:46 -0500] drnfx: How do I execute a single recipe that I have on my chefserver without adding it to the node run list?
[2012-11-21 15:12:47 -0500] drnfx: its like knife ssh blah bloah "chef-client -x recipe[blah::bnlah]" ??
[2012-11-21 15:14:21 -0500] masterkorp: bougyman: sorry i was away
[2012-11-21 15:14:33 -0500] masterkorp: bougyman: also, i am sorry, i am clueless
[2012-11-21 15:14:43 -0500] itchyouch: Anyone use supervisor with chef?  I'm a ruby noob, so I'm unsure of what the best way to add daemons to supervisord would be short of having each recipe edit the supervisor.cof directly
[2012-11-21 15:14:44 -0500] masterkorp: i did failed to debug with shef earlier too
[2012-11-21 15:17:30 -0500] bougyman: masterkorp: I got it.
[2012-11-21 15:17:56 -0500] bougyman: it doesn't honor/load any cookbooks in the -z supplied run list, only in the stored run_list.
[2012-11-21 15:18:22 -0500] bougyman: and then when it does work, it doesn't load any of the attributes from included roles, only from the main role.
[2012-11-21 15:18:27 -0500] bougyman: er main roles.
[2012-11-21 15:18:54 -0500] bougyman: it seems like shef would load up the same things that chef-client does, when on the same node, same configs, etc.
[2012-11-21 15:19:15 -0500] itchyouch: Is there a dry run for running a chef-client to see the changes that would be run?
[2012-11-21 15:19:23 -0500] bougyman: --why-run, iirc.
[2012-11-21 15:20:27 -0500] itchyouch: bougyman: I don't think that's it.
[2012-11-21 15:20:35 -0500] itchyouch: It balked at my argument
[2012-11-21 15:20:49 -0500] bougyman: which chef version?
[2012-11-21 15:20:56 -0500] bougyman: chef-client --help shows me -W,--why-run
[2012-11-21 15:21:02 -0500] masterkorp: bougyman: thing is, you can't really debug much with shef ;(
[2012-11-21 15:21:55 -0500] BryanWB_: masterkorp: u can debug a lot w/ shef + pry
[2012-11-21 15:22:14 -0500] bougyman: masterkorp: I'm doing it now.
[2012-11-21 15:22:19 -0500] masterkorp: can you link that =
[2012-11-21 15:22:21 -0500] masterkorp: ?
[2012-11-21 15:22:23 -0500] bougyman: lots of manual work to get my attributes all loaded.
[2012-11-21 15:22:54 -0500] bougyman: every attribute I set in a role that's not in the run_list I have to set by hand.
[2012-11-21 15:23:03 -0500] rryann: itchyouch https://github.com/opscode-cookbooks/supervisor
[2012-11-21 15:23:04 -0500] masterkorp: that sucks
[2012-11-21 15:23:07 -0500] bougyman: pita, but i'll get through it.
[2012-11-21 15:23:26 -0500] rryann: there's a provider for adding services
[2012-11-21 15:24:28 -0500] bougyman: holy crap i got through it all.
[2012-11-21 15:24:30 -0500] bougyman: \o/
[2012-11-21 15:25:23 -0500] itchyouch: Damn, centos is a second class citizen for a bunch of cookbooks
[2012-11-21 15:25:37 -0500] itchyouch: Tanks rryann
[2012-11-21 15:26:20 -0500] masterkorp: itchyouch: freaking ubuntu boys
[2012-11-21 15:27:06 -0500] itchyouch: masterkorp: Tell me about it.  Thigh I'd prefer Debian/Ubuntu over the rpm distros
[2012-11-21 15:27:11 -0500] itchyouch: Though
[2012-11-21 15:27:19 -0500] masterkorp: i prefer debian
[2012-11-21 15:27:25 -0500] masterkorp: ubuntu not so much
[2012-11-21 15:28:05 -0500] itchyouch: Hehe...  Ubuntu's track record seems to have gotten better.  Though ive never run Ubuntu in production yet
[2012-11-21 15:28:15 -0500] itchyouch: Only centos and Debian
[2012-11-21 15:28:22 -0500] masterkorp: ubuntu server is a joke
[2012-11-21 15:28:38 -0500] masterkorp: i like how canocial fakes to care about the server at all
[2012-11-21 15:29:27 -0500] masterkorp: altough ubuntu servers are everywhere and they would make big buck on support
[2012-11-21 15:29:38 -0500] masterkorp: oh well that is another story
[2012-11-21 15:30:10 -0500] leifmadsen: o.O
[2012-11-21 15:30:14 -0500] leifmadsen: interesting viewpoint :)
[2012-11-21 15:30:26 -0500] itchyouch: Heheh.  So how does one run newer releases on Debian?  I can only imagine running out of Sid, or I guess back ports
[2012-11-21 15:30:51 -0500] masterkorp: itchyouch: really compare the version on ubuntu server and you will see :)
[2012-11-21 15:31:01 -0500] kryptek: mornin' all
[2012-11-21 15:33:10 -0500] alex88: hi guys, how may I include a recipe from another one?
[2012-11-21 15:33:34 -0500] itchyouch: masterkorp:  I haven't been o a Debian box in probably 2 years... Heh
[2012-11-21 15:35:33 -0500] rryann: alex88 include_recipe "FOO"
[2012-11-21 15:35:47 -0500] alex88: rryann, thanks!
[2012-11-21 15:38:01 -0500] alex88: mmhh.. some basic information, I've cloned a basic chef-repo repo
[2012-11-21 15:38:15 -0500] masterkorp: alex88: dont do it
[2012-11-21 15:38:22 -0500] masterkorp: alex88: start fresh
[2012-11-21 15:38:34 -0500] alex88: masterkorp, this one https://github.com/opscode/chef-repo.git
[2012-11-21 15:38:34 -0500] masterkorp: alex88: those cookbooks there are soo outdated
[2012-11-21 15:39:19 -0500] masterkorp: alex88: Do the following, start from the ground up with that scheme
[2012-11-21 15:39:30 -0500] alex88: masterkorp, yup, i've cloned that repo
[2012-11-21 15:39:48 -0500] masterkorp: alex88: I import cookbooks with knife-github cookkbooks
[2012-11-21 15:39:58 -0500] alex88: now i was going to create a basic cookbook with "knife cookbook create vips"
[2012-11-21 15:40:04 -0500] alex88: masterkorp, I want to create a new cookbook
[2012-11-21 15:41:23 -0500] bmcgee: Not strictly chef related, but does anyone here have mad iptables skills?
[2012-11-21 15:41:45 -0500] alex88: bmcgee, for sure in #networking there are.. helped me lot of times
[2012-11-21 15:41:50 -0500] bmcgee: ah sweet
[2012-11-21 15:41:51 -0500] bmcgee: thx
[2012-11-21 15:42:02 -0500] masterkorp: bmcgee: btw, check the afw cookbook :P
[2012-11-21 15:42:20 -0500] alex88: masterkorp, the problem it tries to write to /var/chef, not the local cookbooks folder
[2012-11-21 15:42:36 -0500] leifmadsen: Have a design question/poll: Do you use a "bootstrap" cookbook for your deployments, rely on your PXE/preseed files for initial packages, or a combination (have PXE/preseed do the initial build tools, etc packages and a bootstrap cookbook just to make sure things are up to date/sync'd)?
[2012-11-21 15:42:47 -0500] masterkorp: alex88: paste your knife.rb
[2012-11-21 15:43:07 -0500] alex88: masterkorp, haven't created one..just the one inside the config folder of the chef-repo.git
[2012-11-21 15:43:22 -0500] masterkorp: alex88: you should really have one in your home
[2012-11-21 15:43:22 -0500] alex88: http://pastie.org/private/vt4wheoixgkezmd0gzx3zg
[2012-11-21 15:43:43 -0500] alex88: masterkorp, oh.. really? no way without? (so I can have different chef repos)
[2012-11-21 15:43:53 -0500] masterkorp: i have it too
[2012-11-21 15:44:02 -0500] masterkorp: alex88: i use diferent files
[2012-11-21 15:44:11 -0500] masterkorp: and knife-block to manage them
[2012-11-21 15:44:19 -0500] alex88: masterkorp, ok.. so..let me search for a basic config
[2012-11-21 15:44:24 -0500] alex88: or can you paste me some things?
[2012-11-21 15:44:43 -0500] masterkorp: alex88: https://github.com/greenandsecure/knife-block
[2012-11-21 15:45:13 -0500] alex88: masterkorp, btw, I'm going to use just chef-solo for now
[2012-11-21 15:45:15 -0500] masterkorp: alex88: here is an example http://pastie.org/private/pu0yylih9oykutvlqfpvqw
[2012-11-21 15:45:19 -0500] alex88: not sure if it matters
[2012-11-21 15:45:34 -0500] masterkorp: alex88: No chef server ?
[2012-11-21 15:45:40 -0500] alex88: masterkorp, not for now
[2012-11-21 15:45:42 -0500] alex88: later
[2012-11-21 15:45:57 -0500] masterkorp: well honestly then you dont need knife
[2012-11-21 15:46:07 -0500] BryanWB_: how can i use include_recipe w/in an lwrp?
[2012-11-21 15:46:11 -0500] alex88: masterkorp, oh.. and to create a basic cookbook structure inside the repo?
[2012-11-21 15:46:21 -0500] masterkorp: alex88: you dont have a repo
[2012-11-21 15:46:32 -0500] masterkorp: s/have/use
[2012-11-21 15:47:01 -0500] alex88: masterkorp, well, git repo.. so, instead, to create a basic cookbook structure inside the folder?
[2012-11-21 15:47:05 -0500] masterkorp: BryanWB_: cant you use include_recipe on the default recipe of that cookbook ?
[2012-11-21 15:47:19 -0500] jtimberman: geekbri: i'm gonna have to write some words on the internet about it
[2012-11-21 15:47:25 -0500] masterkorp: alex88: you dont need, on chef-solo you only spefify the cookbook path
[2012-11-21 15:47:43 -0500] alex88: masterkorp, sure, but i need to create a cookbook recipe structure?
[2012-11-21 15:47:53 -0500] alex88: s/recipe//
[2012-11-21 15:47:59 -0500] alex88: with attributes, recipes, templates etc
[2012-11-21 15:48:29 -0500] masterkorp: alex88: let's be more pratical, What are you trying to do ?
[2012-11-21 15:48:41 -0500] alex88: masterkorp, create a cookbook structure
[2012-11-21 15:49:00 -0500] alex88: masterkorp, like in this tut http://reiddraper.com/first-chef-recipe/ it says to use "rake new_cookbook COOKBOOK=redis" but that's deprecated
[2012-11-21 15:50:39 -0500] masterkorp: alex88: just do the knife cookbook create ./
[2012-11-21 15:51:09 -0500] alex88: masterkorp, ERROR: Errno::EACCES: Permission denied - /var/chef
[2012-11-21 15:51:10 -0500] masterkorp: alex88: what will your cookbook do ?
[2012-11-21 15:51:41 -0500] alex88: download, compile and install vips.. (image library)
[2012-11-21 15:51:58 -0500] masterkorp: check if there is already one in the community
[2012-11-21 15:52:09 -0500] masterkorp: just to be sure you're not wasting time
[2012-11-21 15:52:11 -0500] alex88: already tried, isn't there
[2012-11-21 15:53:09 -0500] masterkorp: alex88: just create the files by hand
[2012-11-21 15:53:17 -0500] masterkorp: the metadata.rb and so on
[2012-11-21 15:53:46 -0500] alex88: masterkorp, found it, moved the git repo folder to ~/chef-repo/ and then created ~/chef-repo/.chef/knife.rb and put
[2012-11-21 15:53:47 -0500] alex88: cookbook_path      [ "chef-repo/cookbooks", "chef-repo/site-cookbooks" ]
[2012-11-21 15:54:04 -0500] alex88: masterkorp, thanks for the help!
[2012-11-21 15:54:59 -0500] masterkorp: i need to leave, good luck, and have fun
[2012-11-21 15:55:52 -0500] alex88: masterkorp, have a nice time
[2012-11-21 15:56:51 -0500] bmcgee: is it possible to do a search for all nodes matching a given role from within a template?
[2012-11-21 15:57:04 -0500] BryanWB_: masterkorp: this if for an lwrp
[2012-11-21 16:10:45 -0500] BryanWB_: include Chef::Mixin::LanguageIncludeRecipe   does the trick
[2012-11-21 16:12:27 -0500] geekbri: jtimberman: If you do, twitters about it so I can read it and post my comments on how I agree ;)
[2012-11-21 16:13:12 -0500] geekbri: jtimberman: I view databags more for information shared between many recipes and for the type of data you might store in a database.  Things that maybe change frequently or have a lot of fields.  I have a decent amount of information in my role files.  Especially for different configurations for different environments.
[2012-11-21 16:15:54 -0500] masterkorp: BryanWB_: yes, but when a lwrp is availabe the default recipe had run already iirc
[2012-11-21 16:16:16 -0500] itchyouch: I'm trying to use the supervisor package from opscode, but it uses pip to install from the Internet.  I don't have Internet access from the particular boxes I'm trying to install from
[2012-11-21 16:16:17 -0500] BryanWB_: masterkorp: but am not including the default recipe
[2012-11-21 16:16:25 -0500] BryanWB_: but a plugin specified in another recipe
[2012-11-21 16:17:28 -0500] itchyouch: I'm tinkling I could make a pip mirror, adjust the recipe to install via setuptools, bunt need some guidance on which way to go?
[2012-11-21 16:17:30 -0500] masterkorp: BryanWB_: i mean : from the cookbook's default recipe (that has the lwrp) include other recipe
[2012-11-21 16:26:54 -0500] alex88: how can I make a cookbook depend on another one?
[2012-11-21 16:28:33 -0500] alex88: depends field, found i!
[2012-11-21 16:28:35 -0500] alex88: *it
[2012-11-21 16:31:06 -0500] BryanWB_: for thoes interested i just wrote lwrp for monitoring jmx with collectd
[2012-11-21 16:33:31 -0500] matschaffer: hope BryanWB_'s thing ends up on the foodfight show or something. Sounds pretty useful.
[2012-11-21 16:42:49 -0500] masterkorp: ok, i git and icinga lwrp for each lwrp
[2012-11-21 16:45:47 -0500] geekbri: I'd say there is a good chance BryanWB_'s stuff can end up on foodfight show :-P
[2012-11-21 16:54:58 -0500] alex88: I'm using the deploy resource, i've set symlink_before_migrate to {} but it still tries to symlink config/database.yml what should I use?
[2012-11-21 16:56:33 -0500] jtimberman: alex88: oh snap, yfeldblum just answered that the other day...
[2012-11-21 16:56:59 -0500] yfeldblum: jtimberman, that's often the case ^_^
[2012-11-21 16:57:11 -0500] alex88: jtimberman, seems that passing {} is an null hash, it expects something like an empty one
[2012-11-21 16:57:26 -0500] alex88: yfeldblum, are you kind enough to answer that again? :)
[2012-11-21 16:57:41 -0500] yfeldblum: alex88, http://pastie.org/private/ror1xrr7uysfgbfjmd1kpa
[2012-11-21 16:57:49 -0500] yfeldblum: alex88, symlink_before_migrate.clear
[2012-11-21 16:58:00 -0500] alex88: yfeldblum, thanks for that!
[2012-11-21 16:58:04 -0500] yfeldblum: alex88, cheers
[2012-11-21 16:58:27 -0500] alex88: if I deploy some code that needs to be compiled, is it worth to use deploy instead of just git?
[2012-11-21 16:58:27 -0500] jtimberman: http://stackoverflow.com/questions/12568767/chef-deployment-with-irrelevant-default-symlinks/12569090#12569090
[2012-11-21 16:59:56 -0500] jtimberman: alex88: i believe Bryanwb's "ark" lwrp does that now.
[2012-11-21 17:00:03 -0500] jtimberman: ckbk.it/ark
[2012-11-21 17:02:08 -0500] alex88: oh, seems nice!
[2012-11-21 17:06:22 -0500] jtimberman: though the "right" thing to do is use jenkins (or another CI) and build artifacts that you deploy instead of tossing source directly out there.
[2012-11-21 17:06:35 -0500] masterkorp: yes
[2012-11-21 17:06:40 -0500] masterkorp: them love CI
[2012-11-21 17:06:47 -0500] masterkorp: with unit test reports
[2012-11-21 17:06:51 -0500] masterkorp: <3
[2012-11-21 17:10:22 -0500] siezer: wut. https://github.com/someara/bento/blob/slackware-14.0/definitions/slackware-14.0/definition.rb
[2012-11-21 17:10:40 -0500] yfeldblum: jtimberman, for some definition of "right", which is really more of a personal choice :D
[2012-11-21 17:11:08 -0500] masterkorp: siezer: ah, yes !
[2012-11-21 17:12:10 -0500] masterkorp: now we need archlinux
[2012-11-21 17:12:14 -0500] siezer: next stop, slackpkg provider
[2012-11-21 17:12:36 -0500] masterkorp: siezer: is that your github username ?
[2012-11-21 17:13:22 -0500] siezer: yea
[2012-11-21 17:14:12 -0500] masterkorp: will follow ya :)
[2012-11-21 17:14:24 -0500] siezer: aw shucks
[2012-11-21 17:14:44 -0500] siezer: don't expect much.. just the occasional bug fix to rando project
[2012-11-21 17:14:58 -0500] alex88: jtimberman, oh yeah, well, the code is already tested with jenkins.. deployment is manual so we do after tests passes
[2012-11-21 17:15:07 -0500] Guest32187: we're about to hack our own "knife update from file" command to allow an update (NOT create) from file. Can someone shout if this is already covered by some undocumented knife command or knife plugin please :-)
[2012-11-21 17:15:27 -0500] siezer: Guest32187 check out knife-essentials
[2012-11-21 17:15:31 -0500] masterkorp: siezer: i am doing an icinga cookbook and will open source my ecu soon
[2012-11-21 17:15:37 -0500] Guest32187: siezer, thanks, will do
[2012-11-21 17:17:01 -0500] jblaine: K. I've been to the wiki and docs.opscode.com. Nothing indicates the correct incantation to get the 'windows' knife plugin installed.
[2012-11-21 17:17:04 -0500] Guest32187: siezer: documentation on that is a bit light, does this operate on nodes too? or just cookbooks and databags?
[2012-11-21 17:17:09 -0500] jblaine: Any help would be great.
[2012-11-21 17:17:12 -0500] Guest32187: i want to be able to update a node from file
[2012-11-21 17:17:38 -0500] siezer: Guest32187 on nodes?
[2012-11-21 17:17:40 -0500] jblaine: Snagged this repo as 'knife-windows' https://github.com/opscode/knife-windows
[2012-11-21 17:17:49 -0500] jkeiser: Guest32187: yep, it does.
[2012-11-21 17:17:52 -0500] siezer: why are you manually editing nodes?
[2012-11-21 17:18:05 -0500] jblaine: shoved it into $CHEF_REPO/.chef/plugins/knife as knife-windows
[2012-11-21 17:18:06 -0500] jkeiser: You need to add --repo-mode=full IIRC.  One sec.  It's not a common operation
[2012-11-21 17:18:14 -0500] Guest32187: siezer, we're not, we;re managing them in-repo
[2012-11-21 17:18:14 -0500] Guest32187: hence the problem
[2012-11-21 17:18:16 -0500] siezer: ah
[2012-11-21 17:18:29 -0500] siezer: managing what? their run_lists?
[2012-11-21 17:18:31 -0500] Guest32187: with basic knife commands you can upload-and-wipe/overwrite a node
[2012-11-21 17:18:38 -0500] Guest32187: but not upload-and-save-changes
[2012-11-21 17:18:43 -0500] Guest32187: knife-essentials may cover it though, thanks
[2012-11-21 17:19:09 -0500] jtimberman: alex88: yeah totally, and a build pipeline that triggers an artifact (package, tar.gz, whatever) build when tests pass would be the next step
[2012-11-21 17:19:29 -0500] jtimberman: jblaine: gem install knife-windows didn't work? O.o
[2012-11-21 17:19:33 -0500] Guest32187: yes
[2012-11-21 17:19:33 -0500] Guest32187: we manage role assignment to nodes via git repo
[2012-11-21 17:20:10 -0500] alex88: jtimberman, oh so in case of success the artifact is ready for deploy?
[2012-11-21 17:20:14 -0500] Guest32187: and when we upload the node on changes from repo undesired things happen
[2012-11-21 17:20:14 -0500] Guest32187: such as a new node object with the same name being created, but without indexed stuff in solr etc
[2012-11-21 17:20:14 -0500] jblaine: jtimberman: Oh, it's a gem? Not a ruby dude. Just looking to use a knife plugin...
[2012-11-21 17:20:39 -0500] siezer: are you ground computing?
[2012-11-21 17:21:11 -0500] jblaine: I don't think Opscode can, in any good conscience, suggest anymore that you don't need to know Ruby stuff to use Chef.
[2012-11-21 17:21:34 -0500] jblaine: Every step forward in my Chef experience from scratch states outright otherwise.
[2012-11-21 17:21:49 -0500] Guest32187: siezer: what now?
[2012-11-21 17:21:53 -0500] siezer: better practice would be to keep a knife-commands.sh or spiceweasel.yml that describes the nodes in the infrastructure with knife commands..
[2012-11-21 17:22:12 -0500] siezer: jblaine I've personally abandoned that line ;)
[2012-11-21 17:22:23 -0500] jkeiser: Guest32187: --repo-mode=everything.  Sorry, I hardly ever use that option.  Testing now to see
[2012-11-21 17:22:25 -0500] siezer: and replaced it with "you need to know a subset of ruby"
[2012-11-21 17:22:26 -0500] jblaine: jtimberman: But then 'gem install' will not allow the plugin to be shared in the git repo, no?
[2012-11-21 17:22:50 -0500] jtimberman: jblaine: Ahh, well... welcome to the wonderful world of Ruby workflow patterns!
[2012-11-21 17:23:03 -0500] jtimberman: jblaine: the way I'd do that is to have a Gemfile at the top of the git repo
[2012-11-21 17:23:06 -0500] Guest32187: jkeiser, aha you're the knife-essentials maintainer? cheers
[2012-11-21 17:23:19 -0500] jtimberman: A Gemfile is .. a list of gems you want to use.
[2012-11-21 17:23:25 -0500] jtimberman: essentially
[2012-11-21 17:23:34 -0500] siezer: alias b="bundle exec"
[2012-11-21 17:23:38 -0500] jtimberman: siezer: :D
[2012-11-21 17:23:46 -0500] jtimberman: and you do "bundle install"
[2012-11-21 17:23:50 -0500] jblaine: k, f this then
[2012-11-21 17:23:53 -0500] jtimberman: :(
[2012-11-21 17:24:08 -0500] jkeiser: Guest32187: yep, that did it.  knife download --repo-mode=everything nodes/
[2012-11-21 17:24:14 -0500] jtimberman: you could have a recipe that installs gems too
[2012-11-21 17:24:17 -0500] jtimberman: instead.
[2012-11-21 17:24:31 -0500] siezer: the ruby nodel is "throw every version of every gem ever in a big gigantic fail-pile, and select deps in a Gemfile and "bundle exec" all your binaries
[2012-11-21 17:24:37 -0500] Guest32187: jkeiser, s/download/upload/ ?
[2012-11-21 17:24:51 -0500] jtimberman: its a winpile.
[2012-11-21 17:24:54 -0500] jtimberman: not a failpile.
[2012-11-21 17:24:55 -0500] siezer: which is annoying, because you usually do need a "top level" gem set for things like... yanno... bundler, berks, knife, etc
[2012-11-21 17:25:06 -0500] jkeiser: Guest32187: it'll be a core part of Chef 11 too: http://docs.opscode.com/knife_upload.html
[2012-11-21 17:25:30 -0500] jkeiser: Guest32187: yeah.  diff, upload, download, show, list and delete all take the same --chef-repo
[2012-11-21 17:25:36 -0500] jblaine: so "plugin" is a misnomer really
[2012-11-21 17:25:37 -0500] jblaine: it's a gem.
[2012-11-21 17:25:38 -0500] siezer: also, whoever the psychopath that maintains the json gem is breaks everything about once a week
[2012-11-21 17:25:45 -0500] jblaine: it happens to be a plugin.,
[2012-11-21 17:25:47 -0500] jblaine: but it's a gem.
[2012-11-21 17:25:57 -0500] jtimberman: its a plugin that is distributed as a gem.
[2012-11-21 17:25:59 -0500] jblaine: and plugging it in means treating it like a gem
[2012-11-21 17:26:04 -0500] jblaine: lame :(
[2012-11-21 17:26:16 -0500] siezer: whats a plugin?
[2012-11-21 17:26:21 -0500] jtimberman: jblaine: are you using the omnibus packages?
[2012-11-21 17:26:24 -0500] jtimberman: for installing Chef?
[2012-11-21 17:26:27 -0500] Guest32187: jkeiser: thanks for the help, i'll go grab knife-essentials now
[2012-11-21 17:26:28 -0500] jblaine: yes
[2012-11-21 17:26:58 -0500] jtimberman: jblaine: https://github.com/jtimberman/chef-plugins-knife/blob/master/gem.rb
[2012-11-21 17:27:17 -0500] jtimberman: jblaine: stick that in the knife/plugins directory
[2012-11-21 17:27:28 -0500] jtimberman: and it will install gems under Ruby environment chef is in
[2012-11-21 17:27:30 -0500] jkeiser: Basically --chef-repo up levels your repository so that it knows what nodes/ are.  It's necessary to do this sort of thing because "knife download /" or "knife download" at the top level will download everything, and you have to tell it whether "everything" includes nodes or not (which most people don't :)
[2012-11-21 17:29:01 -0500] jblaine: jtimberman: so, sudo knife gem install then...
[2012-11-21 17:29:06 -0500] Guest32187: excellent, just what i've been looking for
[2012-11-21 17:29:12 -0500] jtimberman: jblaine: yea
[2012-11-21 17:29:12 -0500] jblaine: jtimerbman: which will fail for us, as root has no perms to ~jblaine
[2012-11-21 17:29:15 -0500] Guest32187: i do think we're slightly unusual in managing exactly everything in-repo
[2012-11-21 17:29:42 -0500] jblaine: jtimberman: And so won't see ~jblaine/.chef/knife.rb etc
[2012-11-21 17:30:04 -0500] jblaine: jtimberman: But thank you.
[2012-11-21 17:30:42 -0500] itchyouch: Anyone have an example of setup_py_install providers from bryanwb's package?
[2012-11-21 17:31:14 -0500] matti: :>
[2012-11-21 17:31:52 -0500] jkeiser: Guest32187: what exactly do you have in nodes/mynode.json?  Like, just the stuff you initially used to create the node?  Or does it also include all ohai data?
[2012-11-21 17:32:42 -0500] jblaine: Is it even reasonable to call a gem a 'plugin'? Sure seems not.
[2012-11-21 17:32:53 -0500] alex88: someone uses knife to deploy to openstack?
[2012-11-21 17:32:54 -0500] jblaine: It's a Ruby extension to Chef/Knife.
[2012-11-21 17:32:55 -0500] jkeiser: 'Cause nodes in chef include all that stuff at the moment (people are talking about how/whether to change that on the mailing list), and if you upload just the original attributes (like run list) all ohai data will disappear until the next Chef run
[2012-11-21 17:33:13 -0500] jblaine: Doesn't seem to be a "plugin" as Opscode defines that at all.
[2012-11-21 17:33:22 -0500] jblaine: Can't stick it in .chef/plugins/knife = not a plugin
[2012-11-21 17:33:41 -0500] jkeiser: Guest32187: before you go knife upload, I suggest doing a knife diff nodes/nodename.json
[2012-11-21 17:33:54 -0500] jkeiser: Guest32187: that will tell you the difference between your local copy and the remote copy.
[2012-11-21 17:34:00 -0500] Guest32187: jkeiser, we're using rb files, not JSON, and its just the run list assignment and a couple of special attributes
[2012-11-21 17:34:06 -0500] jkeiser: And, incidentally, will tell you what you are about to overwrite
[2012-11-21 17:34:24 -0500] jkeiser: knife-essentials doesn't support .rb files at the moment, so it might not be a fit for you
[2012-11-21 17:34:27 -0500] Guest32187: jkeiser, ah so this will wipe all the ohai data?
[2012-11-21 17:35:00 -0500] jkeiser: It only does .json
[2012-11-21 17:35:13 -0500] Guest32187: jkeiser, conceptually what i'm trying to do is do a "knife node edit" but programattically from the git repo
[2012-11-21 17:35:20 -0500] jkeiser: Yeah, I believe it will.  Basically you are saying "here is what I want the node to be"
[2012-11-21 17:35:31 -0500] Guest32187: dang it, ok
[2012-11-21 17:36:01 -0500] jkeiser: Guest32187: I'll add a "knife edit" at some point.  What you *could* do is knife download, edit file, knife upload
[2012-11-21 17:36:13 -0500] jkeiser: That would preserve the node as it exists
[2012-11-21 17:36:23 -0500] siezer: jblaine wait what?
[2012-11-21 17:36:43 -0500] jtimberman: jkeiser: do the knife-essentials commands take a path to operate on, rather than functioning in the context of where they're executed?
[2012-11-21 17:36:49 -0500] jkeiser: But I don't believe there is any way yet to say "I would like to merge this subset of node data into the existing node data"
[2012-11-21 17:36:50 -0500] jtimberman: jkeiser: like, "knife upload cookbooks/apache2"
[2012-11-21 17:37:04 -0500] jkeiser: jtimberman: both
[2012-11-21 17:37:21 -0500] jkeiser: jtimberman: at the top level of your repo, "knife upload cookbooks/apache2" will upload apache2
[2012-11-21 17:37:22 -0500] jtimberman: jkeiser: i knew the context specific part of the show, was curious about the take a path
[2012-11-21 17:37:24 -0500] Guest32187: jkeiser, ok looks like i might be out of luck after all for the moment and have to home-brew after all
[2012-11-21 17:37:32 -0500] jkeiser: jtimberman: you can also run "knife upload apache2" from cookbooks/
[2012-11-21 17:37:35 -0500] jtimberman: jkeiser: nice. what about if i do say, manage my cookbooks in berkshelf
[2012-11-21 17:37:41 -0500] jkeiser: And you can run "knife upload /cookbooks/apache2" from everywhere
[2012-11-21 17:37:48 -0500] jtimberman: jkeiser: which puts cookbooks in ~/.berkshelf/cookbooks/NAME-VERSION
[2012-11-21 17:38:00 -0500] Guest32187: just to confirm if I can engineer something like what knife node edit does behind the scenes, this *does* preserve ohai data and solr-indexed data etc?
[2012-11-21 17:38:09 -0500] jtimberman: does it treat the directory above the .chef/knife.rb to be the root then?
[2012-11-21 17:38:47 -0500] jkeiser: jtimberman: it only works with repositories that look like those created by the knife initialize repo command (can't remember what that is at the moment)
[2012-11-21 17:39:00 -0500] jkeiser: jtimberman: it assumes cookbooks/.. is the repo root at the moment
[2012-11-21 17:39:20 -0500] jkeiser: I expect we will support cookbooks/NAME-VERSION at some point, but likely not by Chef 11
[2012-11-21 17:40:19 -0500] jtimberman: bummer :)
[2012-11-21 17:40:21 -0500] jkeiser: Guest32187: yeah, you should be able to.  I'm very interested in writing a command like "knife bulk edit <files> <attribute=value> <attribute=value>
[2012-11-21 17:40:56 -0500] jkeiser: jtimberman: is there a strong use case for a berkshelf user to want this?  My understanding was it did uploads and downloads already (but I'm not a berkshelf user)
[2012-11-21 17:41:09 -0500] jkeiser: If there's a strong need, I'd like to up level it sooner rather than later
[2012-11-21 17:42:07 -0500] jkeiser: Guest32187: I actually don't think it would be hard to create based on knife-essentials (the core path stuff is pretty reusable)
[2012-11-21 17:43:05 -0500] jtimberman: jkeiser: well, *I* want it :)
[2012-11-21 17:43:23 -0500] jkeiser: jtimberman: that's good enough for me, but it would help if I knew what you wanted it for :)
[2012-11-21 17:43:24 -0500] jtimberman: jkeiser: but mainly, i want to arbitrarily load cookbooks from any ol' path I specify
[2012-11-21 17:43:56 -0500] jtimberman: jkeiser: because I have cookbooks all over the place for various reasons :D. The opscode cookbooks repositories, cookbooks managed by berkshelf, git repos i've cloned, etc.
[2012-11-21 17:44:14 -0500] jtimberman: I don't normally use a single, specific Chef Server other than for my home server stuff.
[2012-11-21 17:45:11 -0500] jkeiser: jtimberman: knife-essentials is very designed for multiple chef server use cases, but less for multiple directories.  What would you like "knife diff /cookbooks" to do in your case?
[2012-11-21 17:46:07 -0500] bougyman: jtimberman: in shef (-z), is there a way to easily get the same environment as chef-client gets? I though that was what it did, but it does not.
[2012-11-21 17:46:16 -0500] jtimberman: jkeiser: i don't use the diff part of it )
[2012-11-21 17:46:28 -0500] jkeiser: I can imagine a world where we say "my cookbooks are in directories a, b, c and d.  knife diff /cookbooks should consider the union of these directories when diffing, downloading or uploading"
[2012-11-21 17:46:37 -0500] jkeiser: jtimberman: ok, "knife download /cookbooks" :)
[2012-11-21 17:46:42 -0500] jkeiser: or "knife upload /cookbooks"
[2012-11-21 17:46:43 -0500] ssd7: bougyman: By same environment, are you mostly referring to the fact that your attributes appear to be different?
[2012-11-21 17:47:22 -0500] jtimberman: jkeiser: of course, there's a bigger problem where say, knife cookbook upload still only uses the directory name instead of the name of the cookbook from the metadata.
[2012-11-21 17:47:23 -0500] bougyman: when I try and debug/breakpoint on a node which failed bootstrap, I cannot find a way to force it to load the cookbooks, and if I get the cookbooks loaded by manually editing the node data, then when it loads the recipe list (using load_node_run_list from ShefExtras) it never loads the attributes from roles that aren't in the run_list
[2012-11-21 17:47:37 -0500] bougyman: (roles that are included by those roles never get their attributes read)
[2012-11-21 17:47:52 -0500] bougyman: so I have to node.set all the attributes, at the moment, to mimick a 'production run'
[2012-11-21 17:47:53 -0500] jtimberman: Chef::Cookbook::Metadata#from_file will intuit the name from either the metadata file's name attribute, or fall back to the directory where the cookbook is.
[2012-11-21 17:48:05 -0500] ssd7: bougyman: I'm wondering if you are running into http://tickets.opscode.com/browse/CHEF-2467
[2012-11-21 17:48:09 -0500] jtimberman: but knife cookbook upload doesn't do something right there
[2012-11-21 17:48:10 -0500] jtimberman: % knife cookbook list  apache2-1.3.0   1.3.0
[2012-11-21 17:48:28 -0500] jtimberman: thats in a directory 'apache2-1.3.0' where the metadata has name "apache2"
[2012-11-21 17:48:36 -0500] bougyman: ssd7: no, all of this works find with chef-client
[2012-11-21 17:48:40 -0500] bougyman: only in shef do I get the behavior.
[2012-11-21 17:48:50 -0500] bougyman: and it doesn't load any attributes from included roles, not just overrides.
[2012-11-21 17:49:02 -0500] ssd7: bougyman: That bug is about Shef, unless I linked the incorrect one
[2012-11-21 17:49:15 -0500] bougyman: say I have role[foo] in the run list, but role[foo] includes role[bar], none of role[bar] attributes get set.
[2012-11-21 17:49:57 -0500] jblaine: siezer: I am suggesting that calling gem-based knife extensions 'plugins' seems to be a misnomer based on the documentation.
[2012-11-21 17:49:58 -0500] ssd7: bougyman: If you read the report you should see that it actually applies to any attributes set in roles or environments
[2012-11-21 17:50:20 -0500] jblaine: siezer: As the docs indicate that plugins are items that can be installed in .chef/plugins/knife for use.
[2012-11-21 17:50:32 -0500] bougyman: ssd: yep, same thing
[2012-11-21 17:50:45 -0500] jblaine: siezer: And that gem installables are something else. Perhaps 'extensions' to knife/chef/whatever.
[2012-11-21 17:51:12 -0500] bougyman: ssd: so is there anyway to work around it from within Shef?
[2012-11-21 17:51:25 -0500] jkeiser: jtimberman: essentials definitely isn't designed around arbitrary paths--it is designed around the idea of a repository.  knife upload /var/newcookbooks/apache2-2.1.0 would make it go "huh?"
[2012-11-21 17:51:38 -0500] ssd7: bougyman: Here is a monkeypatch that should fix it: https://github.com/stevendanna/knife-hacks/blob/master/shef/client_session_fix.rb
[2012-11-21 17:52:06 -0500] jblaine: siezer: Either "plugin" means something specific (as the docs indicate) or it does not (which the docs should probably indicate).
[2012-11-21 17:53:08 -0500] jkeiser: jtimberman: we *could* make it fit the paradigm by letting you specify that /var/newcookbooks is one of the places your cookbooks are, and then you would say knife upload /cookbooks/apache2-2.1.0.  But it sounds to me like wrangling it to meet your use case would not be worth the use you'd get out of it?
[2012-11-21 17:53:21 -0500] jkeiser: Rather than just fixing cookbook upload
[2012-11-21 17:53:44 -0500] jtimberman: jkeiser: i can see that.
[2012-11-21 17:53:47 -0500] gyre007: guys I need to mix in some libraries in all recipes in one of my cookbooks so basically need to include this in each recipe -> https://gist.github.com/4126452 is there any way to do this wihtout DRY ??
[2012-11-21 17:53:50 -0500] bougyman: ssd: and I have knift-hacks on my system.
[2012-11-21 17:53:56 -0500] bougyman: er knife-hacks.
[2012-11-21 17:54:03 -0500] jtimberman: jkeiser: its cool, i think there's a berkshelf ticket that allows uploading a single cookbook anyway
[2012-11-21 17:54:04 -0500] gyre007: I mean sticking those few lines in each recipe just looks really bad...
[2012-11-21 17:54:14 -0500] jtimberman: everyone support my edge use case!
[2012-11-21 17:54:15 -0500] jtimberman: ;)
[2012-11-21 17:54:27 -0500] jkeiser: jtimberman: I intend to make it work with berkshelf, just maybe not with jtimberman :)
[2012-11-21 17:54:37 -0500] gyre007: I was thinking about sticking this stuff into separate recipe and then do include_recipe mixin_recipe...but I'm not sure if that will work...mm
[2012-11-21 17:54:47 -0500] jtimberman: jkeiser: lmao
[2012-11-21 17:54:50 -0500] jtimberman: thats fair
[2012-11-21 17:54:51 -0500] gyre007: any ideas would be greatly appreciated ;)
[2012-11-21 17:55:49 -0500] jkeiser: Anyway, I'll keep your requirements in the back of my mind and if things come up where I can move it that direction without breaking the repository abstraction, I'll do that
[2012-11-21 17:56:32 -0500] jtimberman: jkeiser: no worries if not, i'm capable of adapting :)
[2012-11-21 17:57:08 -0500] jtimberman: berkshelf will also install cookbooks "vendored" into a path of your choosing, so I could do that instead and then use either berks upload, knife cookbook upload or knife upload.
[2012-11-21 17:57:51 -0500] jkeiser: Yeah, that is a way to work with existing essentials.  But cookbooks are a place essentials is limited; it doesn't really think in terms of multiple versions, because Chef repositories don't think in terms of multiple versions
[2012-11-21 17:58:26 -0500] jkeiser: diff and download always work with the latest v. on the server.  upload will always do what you think (upload the version of the cookbook specified in the metadata)
[2012-11-21 17:58:34 -0500] jtimberman: Right, and when you're in "multiple versions" land, you're into a whole different kind of workflow, environments, pinning and all that good stuff.
[2012-11-21 17:58:59 -0500] jblaine: siezer: it's possible you consider the difference trivial. I definitely don't.
[2012-11-21 18:01:21 -0500] jkeiser: I'd like to get it there--I think it's a pretty useful paradigm--but v1 is all about working with what exists, so that people can pick it up without changing the workflow that's sorta baked in there
[2012-11-21 18:02:51 -0500] jtimberman: jblaine: you can certainly grab the 'windows.rb' file from the gem and stick it in .chef/plugins/knife.
[2012-11-21 18:06:00 -0500] cschneid: jtimberman: is there somewhere to read on how the *application cookbooks work? I'm confused by the handful of recipes and how they fit together
[2012-11-21 18:08:15 -0500] jtimberman: cschneid: the recipes in the "application" cookbook were deprecated months ago, and were finally just removed yesterday in git and today in the released version.
[2012-11-21 18:08:44 -0500] jtimberman: cschneid: the way the cookbooks are intended to be used is that you write your own cookbook with recipes that use the application resource and the various sub-resources.
[2012-11-21 18:09:11 -0500] cschneid: so application will provide me the resource to deploy out a rails app (for instance), and I have a my-app cookbook that makes use of that resource
[2012-11-21 18:09:33 -0500] cschneid: and the application cookbook has lots of different deploy scenarios for different environments (rails / python world /etc)
[2012-11-21 18:09:36 -0500] cschneid: ?
[2012-11-21 18:09:41 -0500] behemphi: good morning all, I am having a devil of  a time getting knife-rackspace to work with omnibus.
[2012-11-21 18:09:54 -0500] behemphi: knife rackspace image list gives me the dread:
[2012-11-21 18:10:09 -0500] behemphi: ERROR: Excon::Errors::SocketError: getaddrinfo: Name or service not known (SocketError)
[2012-11-21 18:11:59 -0500] jtimberman: cschneid: yes
[2012-11-21 18:12:30 -0500] cschneid: jtimberman: thanks. Saw your tweet and thought it'd be a good time to ask :)
[2012-11-21 18:12:31 -0500] jtimberman: cschneid: so if you're deploying a rails app, you would use the application_ruby cookbook in conjunction with the application cookbook to get helpers like database
[2012-11-21 18:12:52 -0500] cschneid: so the stack of dependencies is  application => application_ruby => myapp
[2012-11-21 18:13:03 -0500] cschneid: makes sense :)
[2012-11-21 18:13:16 -0500] jtimberman: cschneid: the application_ruby has examples in README.md
[2012-11-21 18:13:21 -0500] behemphi: The only thing I see is with -VV my api_auth_url seems to be going from df2.auth.api.rackspacecloud.com to simply auth.api.rackspacecloud.com
[2012-11-21 18:13:31 -0500] jtimberman: cschneid: your "myapp" cookbook would just have depends "application_ruby"
[2012-11-21 18:13:53 -0500] jtimberman: application_ruby has dependencies on application and other relevant recipes to support the various things the LWRP can do
[2012-11-21 18:15:45 -0500] corp: jtimberman: do you use the unicorn recipe?
[2012-11-21 18:15:51 -0500] jtimberman: corp: i have used it
[2012-11-21 18:16:12 -0500] jtimberman: corp: the recipe itself just installs the unicorn gem
[2012-11-21 18:16:34 -0500] corp: jtimberman: yeah, i mean the thing that sets up a runit and so on
[2012-11-21 18:18:25 -0500] jtimberman: the definition?
[2012-11-21 18:18:39 -0500] jtimberman: oh - the definition doesn't do that part
[2012-11-21 18:20:03 -0500] corp: jtimberman: the lwrp does
[2012-11-21 18:20:32 -0500] corp: just noticing it's not really suitable for normal deployments, as it runs in the foreground and runit cant handle the standard "USR2" graceful restart
[2012-11-21 18:21:04 -0500] corp: is runit a kind of standard or would opscode cookbooks accept bluepill as a replacement?
[2012-11-21 18:21:33 -0500] corp: this can work under runit, just needs some bash scripting that detects the pid files
[2012-11-21 18:21:48 -0500] corp: but it can't really run in the foreground
[2012-11-21 18:23:12 -0500] jtimberman: corp: bluepill as an alternative would be a fine pull request. I can definitely see the use case for bluepill because its a "pure ruby" alternative.
[2012-11-21 18:23:31 -0500] jtimberman: especially for platforms that strangely don't have runit available as a native package :)
[2012-11-21 18:24:12 -0500] corp: i wish that procnanny project had taken off
[2012-11-21 18:37:56 -0500] behemphi: :q
[2012-11-21 18:38:24 -0500] behemphi: erm . %s/:q/oops/
[2012-11-21 18:42:47 -0500] JasonF: Is one-line ruby block syntax valid for chef resources? i.e. cron "lol" { action :delete }
[2012-11-21 18:43:43 -0500] behemphi: @jasonF  yes it is
[2012-11-21 18:46:24 -0500] JasonF: ty
[2012-11-21 18:46:29 -0500] JasonF: I thought so, but I wasn't 100% sure.
[2012-11-21 18:49:26 -0500] behemphi: do you know about "shef"
[2012-11-21 18:49:45 -0500] behemphi: sort of like irb but with the chef environment there for you
[2012-11-21 18:50:27 -0500] JasonF: yeah. Probably should've answered my own question using it. :(
[2012-11-21 18:50:49 -0500] behemphi: NP, I got to answer a question in IRC
[2012-11-21 18:51:08 -0500] behemphi: I can have an extra helping of stuffing tomorrow :-)
[2012-11-21 18:51:29 -0500] Death_Syn: \o/
[2012-11-21 19:01:58 -0500] behemphi: So, I am pretty sure I have soemthing goofed up in tyring to install knife-rackspace so I started fresh on Ubuntu 10.04 with omnibus 10.16.2  However when (in a recipe) I issue chef_gem "knife-rackspace" I get this nugget:  *You have to install development tools first.*
[2012-11-21 19:02:07 -0500] behemphi: I think it means ruby-dev
[2012-11-21 19:02:11 -0500] behemphi: (not being a rubyist)
[2012-11-21 19:02:30 -0500] behemphi: how, exactly, do I install ruby-dev for the omnibus version?
[2012-11-21 19:03:45 -0500] mhalligan: hrm is there a quick way to make knife ssh use internal ips instead of external ips?
[2012-11-21 19:05:27 -0500] behemphi: mhaligan, I have a hosts file on my workstation pointing to all the internal IPs
[2012-11-21 19:05:34 -0500] behemphi: I keep it up to date with a chef client run
[2012-11-21 19:05:38 -0500] behemphi: </hack>
[2012-11-21 19:06:48 -0500] itchyouch: I need a hand with leveraging the ark resource.  I am getting NoMethodError with the attribute method being undefined using chef 10.6
[2012-11-21 19:06:49 -0500] itchyouch: Any ideas?
[2012-11-21 19:07:17 -0500] jtimberman: behemphi: 'ruby-dev' is already in omnibus - that is just the various C headers required to do C extensions.
[2012-11-21 19:07:37 -0500] jtimberman: behemphi: you'll need build-essential, and the headers for whatever it is you're compiling.
[2012-11-21 19:08:00 -0500] behemphi: interestingly @jtimberman this worked: /opt/chef/embedded/bin/gem install knife-rackspace
[2012-11-21 19:08:04 -0500] jtimberman: for example if you are installing the nokogiri gem, it needs libxml2-dev and libxslt-dev (on ubuntu)
[2012-11-21 19:13:40 -0500] behemphi: I take the last back, I have too many of a kind open right now.  Sorry for the confusion.
[2012-11-21 19:14:41 -0500] fromonesrc: berkshelf question any way to have it remember git credentials or use a token? tiring having to enter them in each time it pulls a cookbook from a private repo
[2012-11-21 19:22:42 -0500] ivey: fromonesrc:
[2012-11-21 19:22:55 -0500] ivey: are you using git/ssh urls or http with auth?
[2012-11-21 19:23:12 -0500] fromonesrc: https, that's probably the problem
[2012-11-21 19:23:15 -0500] fromonesrc: let me try git ssh
[2012-11-21 19:24:15 -0500] fromonesrc: thanks ivey! I forgot about that
[2012-11-21 19:24:29 -0500] ivey: yeah np
[2012-11-21 19:25:42 -0500] ivey: if for some reason someone is stuck with https, http://samuel.kadolph.com/2011/03/store-your-git-https-passwords-in-your-os-x-keychain/
[2012-11-21 19:26:14 -0500] gswallow: my nodes seem to be "disappearing"
[2012-11-21 19:26:34 -0500] mhalligan: behemphi: ah, that works? I thought knife just grabbed ips from chef for ssh actions?
[2012-11-21 19:26:49 -0500] gswallow: I delete the node and the client, then "bootstrap" it again, then when I actually assign roles to it, chef-client complains that the certificate is invalid.
[2012-11-21 19:29:08 -0500] behemphi: I am sure there is a more graceful way mhalligan, but that is what works for me
[2012-11-21 19:29:26 -0500] mhalligan: behemphi: I'll try that then, thanks :)
[2012-11-21 19:32:02 -0500] rafaelmagu: I'm thinking of switching from berkshelf to librarian-chef, to be able to use knife-spork for uploading cookbooks and freezing them. Thoughts?
[2012-11-21 19:34:44 -0500] gswallow: if I restart solr it magically works
[2012-11-21 19:34:47 -0500] gswallow: wtf
[2012-11-21 19:35:08 -0500] gswallow: I don't even know what solr is
[2012-11-21 19:38:23 -0500] cwj: solr provides the fulltext search functionality
[2012-11-21 19:38:57 -0500] gswallow: yeah I'm not sure what's wrong
[2012-11-21 19:40:07 -0500] itchyouch: Hey, is there a way to only mirror a subset of ruby gems?
[2012-11-21 19:41:15 -0500] jtimberman: mhalligan: you can use the '-a' option to tell chef which attribute from the chef server search of nodes to use for the IPs
[2012-11-21 19:41:33 -0500] mhalligan: th
[2012-11-21 19:41:33 -0500] mhalligan: jtimberman: that would just make too much sense.
[2012-11-21 19:41:33 -0500] mhalligan: (
[2012-11-21 19:41:34 -0500] mhalligan: a
[2012-11-21 19:41:35 -0500] mhalligan: nks)
[2012-11-21 19:41:45 -0500] jtimberman: mhalligan: like, knife ssh "role:webserver" "uptime" -a ec2.private_ipv4
[2012-11-21 19:42:13 -0500] mhalligan: can knife ssh give you a tty?
[2012-11-21 19:42:21 -0500] gswallow: is there a way to create a private/public key pair like the ones that chef uses for nodes?
[2012-11-21 19:42:23 -0500] Pushnell: hey y'all.  does logging to level :error fail the chef run, or does only :fatal do that?
[2012-11-21 19:42:55 -0500] cwj: mhalligan: knife ssh has interactive and screen/tmux modes
[2012-11-21 19:43:15 -0500] mhalligan: ah sweet, thanks. I guess I should just rtfm.
[2012-11-21 19:48:20 -0500] jtimberman: mhalligan: :-)
[2012-11-21 19:57:40 -0500] btm_: Chef code review beginning soon, hangout: https://plus.google.com/hangouts/_/57065309362b1177984dc3fab4fed0c2ea605db2?authuser=1&hl=en watch: http://youtu.be/3x35cQdEsXk
[2012-11-21 20:01:31 -0500] gswallow: ok seriously wtf
[2012-11-21 20:02:06 -0500] gswallow: I could use some help.  I run chef-client on one server, then it fails, then I try to run again and I get random 401s
[2012-11-21 20:02:33 -0500] gswallow: this started happening like yesterday
[2012-11-21 20:05:21 -0500] gswallow: http://pastebin.com/GcX15fFR
[2012-11-21 20:10:10 -0500] Pushnell: hm .
[2012-11-21 20:10:14 -0500] Pushnell: chef_gem[mysql] (mysql::ruby line 36) had an error: Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
[2012-11-21 20:11:08 -0500] Pushnell:   /opt/chef/embedded/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)  You have to install development tools first.
[2012-11-21 20:11:37 -0500] Pushnell: I have the development tools cookbook in my runlist well before anything related to the mysql cookbook, but this error is pre-empting my runlist.
[2012-11-21 20:11:56 -0500] rafaelmagu: Pushnell: I had the same issue
[2012-11-21 20:12:23 -0500] rafaelmagu: Pushnell: had to do force the compiling during the first stage of the run
[2012-11-21 20:12:32 -0500] gswallow: http://pastebin.com/c8VCrQLC
[2012-11-21 20:12:49 -0500] Pushnell: rafaelmagu: how so?
[2012-11-21 20:13:29 -0500] spox: this might be helpful: http://community.opscode.com/cookbooks/chef_package
[2012-11-21 20:14:36 -0500] cheflevelramen: Hi Everyone. I have a pretty basic question about override_attributes. I've been following a tutorial that had me set up override_attributes for a base role for sudo users. That worked fine. Now when I want to add postfix override_attributes, the cookbook docs gave an example of a different syntax. Question is, what is the proper syntaxt (are there different acceptable syntax?), and what is the proper way to add multiple cookb
[2012-11-21 20:16:17 -0500] whilp: hrm; has anybody hooked up chef-metrics using chef_handler?
[2012-11-21 20:16:39 -0500] whilp: i can't figure out how to get ChefMetrics to play nicely with the chef_handler resource
[2012-11-21 20:17:11 -0500] rafaelmagu: Pushnell: are you trying to use the mysql gem during the same Chef run where it gets built? What OS is this?
[2012-11-21 20:17:39 -0500] rafaelmagu: Pushnell: here's how I did it: https://gist.github.com/4127362
[2012-11-21 20:18:41 -0500] Pushnell: rafaelmagu: thanks
[2012-11-21 20:18:56 -0500] jtimberman: Pushnell: mysql::ruby should do that for you.
[2012-11-21 20:19:08 -0500] gswallow: wait..what?
[2012-11-21 20:19:21 -0500] gswallow: I compacted couchdb and it works again.
[2012-11-21 20:19:52 -0500] Pushnell: jtimberman: The recipe where I do anything with the mysql or database cookbooks is the last thing in my runlist.  In that recipe,  I have mysql::server and mysql::ruby  (in that order . I'll try switching them now.)
[2012-11-21 20:20:54 -0500] Pushnell: rafaelmagu: this is on amazon linux btw
[2012-11-21 20:21:28 -0500] rafaelmagu: Pushnell: adjust for your package manager, but should be similar
[2012-11-21 20:24:26 -0500] Pushnell: jtimberman: putting include_recipe "mysql::ruby" before include_recipe"mysql::server" made no difference.  This is with mysql book v1.3.0
[2012-11-21 20:27:16 -0500] zuhaib: Hey got a template question that is a bit odd, i am looping over a template and updating an variables but after the chef run is complete all the template files have the same value
[2012-11-21 20:27:18 -0500] zuhaib: any idea why
[2012-11-21 20:27:42 -0500] deepakprasanna: Im trying out chef recipes with hosted chef, vagrant on my localbox for "dev" environment and with ec2 for "prod" enviroment. I was able to deploy a few cookbooks on EC2 without any problem. But when I try do it with vagrant on my localbox for the "dev" environment I get a 404 from hosted chef and the chef run fails.
[2012-11-21 20:28:05 -0500] deepakprasanna: INFO: HTTP Request Returned 404 Not Found: No routes match the request: /organizations/thoughtster/environments/dev/cookbook_versions <<<<<< This is the error message
[2012-11-21 20:42:14 -0500] gswallow: what the eff.
[2012-11-21 20:42:34 -0500] gswallow: chef-client randomly has problems downloading a cookbook file it has never had problems with before.
[2012-11-21 20:42:38 -0500] gswallow: results in a 401
[2012-11-21 20:42:53 -0500] gswallow: *from that point forward* all requests end up in 401
[2012-11-21 20:45:11 -0500] behemphi: Hey @mattray are you around?
[2012-11-21 20:45:18 -0500] mattray: yup
[2012-11-21 20:45:27 -0500] behemphi: knife-rackspace is killing me and debug is showing me strange stuff
[2012-11-21 20:45:30 -0500] behemphi: do you ahve a mo?
[2012-11-21 20:45:43 -0500] mattray: sure
[2012-11-21 20:46:45 -0500] behemphi: https://gist.github.com/4127555
[2012-11-21 20:46:49 -0500] behemphi: that is my knife.rb
[2012-11-21 20:48:05 -0500] mattray: ok
[2012-11-21 20:48:14 -0500] behemphi: https://gist.github.com/4127575
[2012-11-21 20:48:31 -0500] behemphi: that is the output to knife rackspace flavor list -VV
[2012-11-21 20:48:54 -0500] behemphi: I note two things that I cannot wrap my head about:
[2012-11-21 20:49:04 -0500] behemphi: 1.  the version show both v1 and v2
[2012-11-21 20:49:17 -0500] behemphi: 2. the auth_url is not honoring what is in my knife.rb
[2012-11-21 20:50:59 -0500] mattray: for #1, I threw those debug statements in to show it overriding the default of 'v1'
[2012-11-21 20:51:06 -0500] mattray: but #2 is troublesome
[2012-11-21 20:51:14 -0500] behemphi: if, in my knife.rb I change the auth_url to: dfw.auth.api.rackspacecloud.com
[2012-11-21 20:51:24 -0500] behemphi: (as in the doc on github)
[2012-11-21 20:51:31 -0500] behemphi: I get this error:
[2012-11-21 20:51:41 -0500] behemphi: ERROR: Excon::Errors::SocketError: getaddrinfo: Name or service not known (SocketError)
[2012-11-21 20:51:58 -0500] behemphi: if I change it to http://dfw.auth.api.rackspacecloud.com/
[2012-11-21 20:52:15 -0500] behemphi: I get a response from the server (json) saying bad username/passwd
[2012-11-21 20:52:23 -0500] behemphi: that is expected b/c my account is at dfw
[2012-11-21 20:52:42 -0500] behemphi: so I know the value is getting read and suspect the debug statement might simply be bogus
[2012-11-21 20:53:46 -0500] behemphi: @mattray I have a workaround with nova-client and knife-bootstrap
[2012-11-21 20:53:52 -0500] behemphi: do you want me to file a bug?
[2012-11-21 20:53:52 -0500] mattray: yeah, but that's bs
[2012-11-21 20:53:56 -0500] mattray: behemphi: sure
[2012-11-21 20:54:16 -0500] mattray: I'll go kick the tires a bit and verify I see what you're seeing
[2012-11-21 20:54:18 -0500] behemphi: sorry to have to ask but where does a bug for knife-rackspace go?
[2012-11-21 20:54:34 -0500] mattray: http://tickets.opscode.com/browse/KNIFE
[2012-11-21 20:54:51 -0500] mattray: just set the component to "knife-rackspace"
[2012-11-21 20:55:03 -0500] behemphi: y, don't want to rip you out of the zone for soemthing I can get around, but I have lost most of today trying to figure what I did wrong so I panicked and @mattray -ed you :-)
[2012-11-21 20:55:33 -0500] mattray: I can take a quick look after I push out a few small patches to the lxc cookbook
[2012-11-21 20:56:22 -0500] behemphi: Thanks!  And happy Thanksgiving
[2012-11-21 20:57:21 -0500] mattray: behemphi: open a ticket with your gists and assign it to me
[2012-11-21 20:59:07 -0500] behemphi: will do matt, I will come back with the tix number in a few minutes
[2012-11-21 20:59:57 -0500] mattray: cool. I expect I can walk through the code and find it pretty quick
[2012-11-21 21:01:18 -0500] gswallow: ugh.  So.if I suspect that something is wrong / buggy in an older version of chef, I can take my couchdb and move it to a freshly installed server, right?
[2012-11-21 21:06:31 -0500] btm: cookbook review starting shortly, hangout: https://plus.google.com/hangouts/_/83613936679c0a793bf1d9dcc75ce3de799312f0?authuser=1&hl=en youtube: http://youtu.be/jwXoVWngUMc
[2012-11-21 21:15:07 -0500] behemphi: @mattray here is the ticket, and thanks again: http://tickets.opscode.com/browse/KNIFE-181
[2012-11-21 21:22:21 -0500] julian_: quick question.  how do I assign the output of the resource "script" to a variable?
[2012-11-21 21:29:02 -0500] cwj: julian_: i dont think you can
[2012-11-21 21:29:18 -0500] cwj: you could look at something like Chef::Mixin::ShellOut
[2012-11-21 21:29:30 -0500] cwj: put some plain ol ruby in your recipe
[2012-11-21 21:29:47 -0500] mattray: julian_: use chef/shellout
[2012-11-21 21:29:48 -0500] mattray: https://github.com/mattray/drbd/blob/master/recipes/pair.rb#L49
[2012-11-21 21:29:51 -0500] mattray: is an example
[2012-11-21 21:52:45 -0500] alexw: whats the best method of automatically transferring the encrypted_data_bag_secret
[2012-11-21 21:52:48 -0500] alexw: to nodes?
[2012-11-21 21:52:57 -0500] alexw: should it be stored in say S3 or something
[2012-11-21 22:05:44 -0500] stearns: I'm using knife-linode to create a machine that previously existed but was destroyed; however, my local chef server doesn't seem to have completely forgotten it, even though I've deleted the node and client from the chef server. When I rerun knife linode server create, the bootstrap script fails with (take your pick) 500, 409, and 403 errors (see https://gist.github.com/93b2bcc683cf3652bb70). Any suggestions?
[2012-11-21 22:06:27 -0500] erikh: stearns: your local validation key is broken
[2012-11-21 22:08:22 -0500] stearns: erikh: thanks; I saw something like that in my googling, but didn't understand how to deal with it so I need to get a new validation key from the server onto my admin client (where I'm typing my knife commands)?
[2012-11-21 22:09:29 -0500] alexw: What's the best method for distributing the encrypted databag secret?
[2012-11-21 22:10:02 -0500] pdoc: Hey all, I am using the deploy resource, but i don't want it to create any directories like current/ releases/ etc. I'm setting symlinks to Hash.new and symlink_before_migrate to Hash.new as well but it's still creating them. What is the proper way to disable these?
[2012-11-21 22:10:29 -0500] stearns: erikh: Ah, more googling turned up "you most likely need to recreate the validation key" - I'll go from there. Thanks!
[2012-11-21 22:15:19 -0500] alexw: Do I need to distribute the encrypted databag?
[2012-11-21 22:36:36 -0500] bluepojo: alexw: unless you're using chef-solo, you need not distribute the encrypted data bag
[2012-11-21 22:36:44 -0500] bluepojo: however to distribute the key, you can do so however you deem secure
[2012-11-21 22:36:52 -0500] bluepojo: we use a secure file transfer to give it to developers
[2012-11-21 22:37:10 -0500] bluepojo: when a dev bootstraps a box, the key is provided to the box during the bootstrap
[2012-11-21 22:40:37 -0500] julian_: Thanks guys.
[2012-11-21 22:41:04 -0500] alexw: bluepojo: yup just worked that out - so when knife runs, it will use that encrypted databag secret
[2012-11-21 22:41:24 -0500] alexw: bluepojo: what are best practices for transfeering the databag secret to other devs?
[2012-11-21 22:41:54 -0500] alexw: ssh?
[2012-11-21 22:43:09 -0500] bluepojo: USB drive is not a bad choice
[2012-11-21 22:43:18 -0500] bluepojo: ssh would probably work as well
[2012-11-21 22:43:33 -0500] bluepojo: I use sharefile cause my company has an account with them
[2012-11-21 22:43:39 -0500] bluepojo: it's some secure dropbox thing
[2012-11-21 22:43:50 -0500] bluepojo: basically anything that's not email or pasting in chat :P
[2012-11-21 22:46:10 -0500] alexw: bluepojo: haha
[2012-11-21 22:46:41 -0500] alexw: bluepojo: DropBox sounds good
[2012-11-21 22:46:58 -0500] bluepojo: if you have a security guy on staff, ask him if not, use your best judgement :P
[2012-11-21 22:50:00 -0500] masterkorp: alexw: we keep your data bags encrypted by everyone
[2012-11-21 22:50:10 -0500] masterkorp: and we have a key for the nodes
[2012-11-21 22:50:20 -0500] masterkorp: needs to be scripted
[2012-11-21 23:05:59 -0500] alexw: would it be possible to run both a blog and application role on the one apache server?
[2012-11-21 23:06:21 -0500] alexw: i.e. my blog is a sub directory - but I want to take wordpress out and make it it's own role
[2012-11-21 23:12:30 -0500] jstarcher: Any idea what this means? FATAL: NameError: Cannot find a resource for php_pear_channel on ubuntu version 10.04
[2012-11-21 23:13:17 -0500] jstarcher: I added package "php-pear" above my php_pear_package section but still get the error
[2012-11-21 23:21:54 -0500] mattray: bluepojo: http://gazzang.com/products/ztrustee would work and it's pretty simple
[2012-11-21 23:22:27 -0500] bluepojo: mattray: sounds reasonable
[2012-11-21 23:22:49 -0500] mattray: you can do N-time file shares, which is kinda cool
[2012-11-21 23:23:13 -0500] mattray: I did a webinar with them a few months ago
[2012-11-21 23:23:37 -0500] jtimberman: ever wanted to get information out of a cookbook's metadata, but grep is silly? how about: https://github.com/jtimberman/chef-plugins-knife/blob/master/metadata.rb
[2012-11-21 23:24:15 -0500] jtimberman: you know, you do "grep depends metadata.rb" and its wrapped up in a .each, so you get results like: depends cb
[2012-11-21 23:24:44 -0500] bluepojo: I want the equivalent for site cookbooks so I don't have to download them to get the metadata. :D
[2012-11-21 23:24:53 -0500] bluepojo: or for cookbooks in the chef server
[2012-11-21 23:24:55 -0500] bluepojo: or both
[2012-11-21 23:24:56 -0500] bluepojo: actually
[2012-11-21 23:25:22 -0500] mattray: knife cookbook site show chef-client
[2012-11-21 23:25:57 -0500] mattray: hmm not fully featured :(
[2012-11-21 23:26:32 -0500] yfeldblum: jtimberman, what about `cat`?
[2012-11-21 23:26:37 -0500] bluepojo: it would speed up berkshelf dependency resolution rather substantially
[2012-11-21 23:26:56 -0500] jtimberman: yfeldblum: hahaha
[2012-11-21 23:27:03 -0500] jtimberman: yfeldblum: same failboat as grep :)
[2012-11-21 23:27:12 -0500] alexw: bluepojo: whats the best practice for using Amazon's RDS server for production
[2012-11-21 23:27:15 -0500] jtimberman: cat apache2's metadata.rb and your terminal gets sad.
[2012-11-21 23:27:16 -0500] yfeldblum: jtimberman, nope - you get the full file with `cat`
[2012-11-21 23:27:21 -0500] alexw: bluepojo: but mysql for dev
[2012-11-21 23:27:27 -0500] bluepojo: alexbst: not sure, I don't use RDS
[2012-11-21 23:27:38 -0500] bluepojo: maybe erikh knows
[2012-11-21 23:27:38 -0500] jtimberman: yfeldblum: trololol :)
[2012-11-21 23:27:48 -0500] alexw: erikh: any idea?
[2012-11-21 23:27:58 -0500] bluepojo: he uses aws, I know
[2012-11-21 23:28:20 -0500] yfeldblum: bluepojo, upvote this and bang on jtimberman until opscode acts: http://community.opscode.com/ideas/18
[2012-11-21 23:28:30 -0500] erikh: what
[2012-11-21 23:28:34 -0500] bluepojo: I think I have, but I will try to upvote again :D
[2012-11-21 23:28:45 -0500] bluepojo: yep, I am an upvoter
[2012-11-21 23:28:48 -0500] yfeldblum: jtimberman, pipe it to less
[2012-11-21 23:28:49 -0500] jtimberman: heh.
[2012-11-21 23:28:57 -0500] yfeldblum: jtimberman, http://community.opscode.com/ideas/18
[2012-11-21 23:29:07 -0500] jtimberman: yfeldblum: Yes I"m familiar with this ticket
[2012-11-21 23:29:10 -0500] jtimberman: request.
[2012-11-21 23:29:14 -0500] jtimberman: Whatever it is.
[2012-11-21 23:29:21 -0500] yfeldblum: jtimberman, this will probably lower your S3 bill :D
[2012-11-21 23:29:26 -0500] bluepojo: ooh good point
[2012-11-21 23:29:30 -0500] bluepojo: we should tell their finance people
[2012-11-21 23:29:33 -0500] bluepojo: that they are wasting money
[2012-11-21 23:29:36 -0500] bluepojo: :D
[2012-11-21 23:29:53 -0500] alexw: erikh: any idea how to use RDS for prod but MySQL for development env
[2012-11-21 23:30:14 -0500] yfeldblum: bluepojo, um ... it probably is that simple :D
[2012-11-21 23:30:18 -0500] alexw: i.e. I would need to manually configure the settings in a databag right?
[2012-11-21 23:30:30 -0500] bluepojo: >_>
[2012-11-21 23:30:48 -0500] alexw: Does https://github.com/opscode-cookbooks/application actually setup an apache server? Or is it just designed to deploy the application
[2012-11-21 23:30:51 -0500] yfeldblum: alexw, there are many approaches and you don't need to do any particular one
[2012-11-21 23:31:57 -0500] jtimberman: yfeldblum: we have an internal ticket for that topic.
[2012-11-21 23:32:12 -0500] erikh: alexw: just use it? rds is just mysql
[2012-11-21 23:32:43 -0500] jtimberman: alexw: its for application deployment
[2012-11-21 23:32:44 -0500] alexw: erikh: I know - but many examples show how a MySQL server can be auto discovered - I guess this is not the case with RDS
[2012-11-21 23:33:18 -0500] alexw: jtimberman: so I still need to include apache recipe etc?
[2012-11-21 23:33:49 -0500] jtimberman: alexw: yes
[2012-11-21 23:34:03 -0500] jtimberman: and it is going to be web stack dependent how you go about doing it.
[2012-11-21 23:34:04 -0500] alexw: jtimberman: makes sense now - I was going out of my mind lol
[2012-11-21 23:35:04 -0500] yfeldblum: bluepojo, does reset/solve have a facility for discovering new cookbook metadatas, including their versions and dependencies, *during* a resolution?
[2012-11-21 23:35:41 -0500] bluepojo: solve is purely version dependency resolution
[2012-11-21 23:35:46 -0500] bluepojo: it isn't cookbook specific
[2012-11-21 23:36:02 -0500] bluepojo: you feed it version strings and it kicks back a resolved list
[2012-11-21 23:36:12 -0500] bluepojo: version strings in a dependency graph, that is
[2012-11-21 23:36:35 -0500] bluepojo: so you'll need to retrieve said strings outside solve
[2012-11-21 23:37:14 -0500] bluepojo: for instance, berkshelf downloads the cookbooks then feeds the strings parsed from metadata into Solve's graph
[2012-11-21 23:37:15 -0500] yfeldblum: bluepojo, right, i mean, does it have a facility for discovering new facts during a resolution? like if there's a dependency on "A >= 3" but it doesn't know anything about "A", is there any way for reset/solve to trigger something external to it that can populate facts about "A" *during* the resolution?
[2012-11-21 23:37:24 -0500] bluepojo: oh yeah, it backtracks
[2012-11-21 23:37:44 -0500] bluepojo: I'll have to go look at it again to give specifics
[2012-11-21 23:37:57 -0500] bluepojo: it's been a while since I looked at it
[2012-11-21 23:38:00 -0500] yfeldblum: bluepojo, i don't think this is related to backtracking
[2012-11-21 23:38:09 -0500] erikh: it's just a recalculation
[2012-11-21 23:38:21 -0500] erikh: again, gecode handles this just fine
[2012-11-21 23:39:25 -0500] bluepojo: yeah, gecode is great
[2012-11-21 23:39:38 -0500] bluepojo: dep_selector is quite solid
[2012-11-21 23:39:42 -0500] bluepojo: it's just not cross platform
[2012-11-21 23:40:41 -0500] bluepojo: if you don't care about windows, I'd suggest dep_selector
[2012-11-21 23:40:42 -0500] bluepojo: tbh
[2012-11-21 23:40:47 -0500] bluepojo: it's faster
[2012-11-21 23:41:00 -0500] yfeldblum: bluepojo, so for example, suppose we are in the middle of a resolution using reset/solve and encounter a cookbook which depends on "ntp"; but we don't have anything at all about the "ntp" cookbook in memory (no list of available versions, no metadatas, nothing); is there some way for reset/solve to know to trigger something to go out and fetch that data and then come back to the resolution and continue with those facts now in memory?
[2012-11-21 23:41:05 -0500] bluepojo: though some people get annoyed at the install size of gecode
[2012-11-21 23:41:06 -0500] yfeldblum: bluepojo, i care about windows
[2012-11-21 23:41:37 -0500] bluepojo: I don't think it will download a cookbook mid resolution
[2012-11-21 23:41:55 -0500] yfeldblum: bluepojo, ah
[2012-11-21 23:42:55 -0500] bluepojo: the way berkshelf worked the last time I looked at this bit of code (which I admit might have changed) is that it parses the entire dependency tree first
[2012-11-21 23:42:59 -0500] bluepojo: then it gives it to the resolver
[2012-11-21 23:43:19 -0500] bluepojo: so you may end up downloading multiple versions of the same cookbook prior to resolving the cookbooks
[2012-11-21 23:43:30 -0500] bluepojo: which is why the above ticket would be so useful
[2012-11-21 23:43:38 -0500] yfeldblum: bluepojo, so it just downloads the entire possible tree up-front?
[2012-11-21 23:43:50 -0500] yfeldblum: bluepojo, in order to construct the full graph up-front?
[2012-11-21 23:44:02 -0500] bluepojo: not entire possible, entire optimistic tree so it'll get the latest possible version from each dependency declaration
[2012-11-21 23:44:15 -0500] bluepojo: worst I've ever seen is 2 or 3 of the same cookbook
[2012-11-21 23:44:16 -0500] yfeldblum: bluepojo, what happens in the non-optimistic case?
[2012-11-21 23:44:32 -0500] yfeldblum: bluepojo, without doing a dependency resolution, how does it know how many versions back to go?
[2012-11-21 23:44:49 -0500] bluepojo: it takes each dependency declaration in isolation
[2012-11-21 23:45:13 -0500] bluepojo: depends "a", "~> 0.1.0" might grab you 0.1.5
[2012-11-21 23:45:33 -0500] yfeldblum: bluepojo, what happens if there's a conflict?
[2012-11-21 23:45:38 -0500] bluepojo: then say another cookbook says < 0.1.4
[2012-11-21 23:45:42 -0500] bluepojo: you'll download that one too
[2012-11-21 23:45:45 -0500] bluepojo: 0.1.3
[2012-11-21 23:46:07 -0500] bluepojo: if it's not resolvable, then the output tells you which cookbooks have irresolvable versions
[2012-11-21 23:46:41 -0500] bluepojo: a needs ~> 0.2.0 and b needs ~> 0.3.0 and you get an error
[2012-11-21 23:46:50 -0500] yfeldblum: what happens if a-0.1.2 depends on another cookbook that we've locked at, but a-0.1.3 depends on another cookbook that violates some other constraint?
[2012-11-21 23:47:38 -0500] bluepojo: both are added to the graph and considered. If the resolution doesn't include that branch, that's fine.
[2012-11-21 23:48:36 -0500] bluepojo: ie: if we use a-0.1.3 then we must also take it's new dependency so if the new dependency causes the graph to be unresolvable, we can't take a-0.1.3
[2012-11-21 23:49:10 -0500] yfeldblum: but if you have one cookbook that depends on a ~> 0.1.0 and another cookbook that depends on a < 0.1.4, then a-0.1.3 will be fetched of course, but what will trigger a-0.1.2 to be fetched?
[2012-11-21 23:49:44 -0500] yfeldblum: this sounds like it will hit the chef folks the hardest ... http://hosted.ap.org/dynamic/stories/U/US_NUDITY_BAN
[2012-11-21 23:49:58 -0500] bluepojo: I'm not sure. I'd have to bug Andrew and Jamie as they're the ones who wrote the algorithm.
[2012-11-21 23:50:07 -0500] bluepojo: Andrew was the one who figured it all out
[2012-11-21 23:50:13 -0500] bluepojo: Jamie contributed a few bits of code later on
[2012-11-21 23:50:25 -0500] yfeldblum: ok
[2012-11-21 23:50:37 -0500] bluepojo: that's as best as I understand
[2012-11-21 23:50:57 -0500] bluepojo: I think I remember something about a rare edge case that would break the algorithm
[2012-11-21 23:51:01 -0500] bluepojo: it might be related to what you're talking about
[2012-11-21 23:52:43 -0500] yfeldblum: bluepojo, i'd like to improve the librarian resolver, but i'd also like to keep the ability to fetch things only on-demand (i.e. only when the resolver asks for it, rather than fetch everything up-front) and i'd also like it to keep the ability to find a solution if one exists at all, rather than only if an optimistic heuristic finds a solution
[2012-11-21 23:53:50 -0500] bluepojo: perhaps you can add callbacks to solve's algorithm to trigger downloads
[2012-11-21 23:54:10 -0500] yfeldblum: bluepojo, unfortunately the librarian resolver just tries all possible combinations in a loop (well, a little smarter than that, but not much), while berkshelf's resolver is based on an optimistic heuristic ...?
[2012-11-21 23:54:38 -0500] alexw: Do I need to upload cookbooks after each change?
[2012-11-21 23:54:45 -0500] sts: hello folks. I'm doing some research on CM tools. What am I able to do with the Chef database (CouchDB). Are there any interfaces I can use to manage my nodes/locations/etc.?
[2012-11-21 23:54:45 -0500] miah: yes
[2012-11-21 23:54:56 -0500] miah: alexw: yes
[2012-11-21 23:55:42 -0500] yfeldblum: sts, yes, you can use the CLI ("knife"), you can use the webui, and you can use the kindaREST API directly from curl or from your favorite programming language
[2012-11-21 23:55:42 -0500] bluepojo: yfeldblum: yeah, the more I think about it, I think you're right. librarian is determined to find the answer for you regardless of how long it takes
[2012-11-21 23:56:05 -0500] bluepojo: where berkshelf will ignore certain cases understanding they only occur in rare circumstances.
[2012-11-21 23:56:13 -0500] bluepojo: I think the other difference is berkshelf only ever downloads a cookbook once
[2012-11-21 23:56:18 -0500] yfeldblum: bluepojo, some people have indeed run up against "regardless of how long it takes" :D
[2012-11-21 23:56:20 -0500] bluepojo: adding a central store was a huge win
[2012-11-21 23:56:34 -0500] sts: yfeldblum: and I can add arbritrary data into the database and use it in my recipes?
[2012-11-21 23:57:06 -0500] yfeldblum: bluepojo, i figure most people have a single chef-repo; but librarian-chef caches cookbooks per chef-repo, so at most you download each cookbook's archive once per chef-repo
[2012-11-21 23:57:45 -0500] bluepojo: I'd say that's a fair guess: that most people use chef-repo for cookbooks still
[2012-11-21 23:57:50 -0500] bluepojo: I personally don't
[2012-11-21 23:57:56 -0500] yfeldblum: sts, yes you can; in chef-land, you can make whatever tables ("data-bags") you want and add whatever records ("data-bag items") you like to those tables
[2012-11-21 23:58:02 -0500] alexw: jtimberman: Is this still working with 0.10 http://vagrantfil.es/vagrantfile/multivm-vagrantfile-jtimbermanhousepuborg
[2012-11-21 23:58:14 -0500] rava: if i've got a service definition in another recipe, can i notify it from within a different recipe? is it simply a matter of including it?
[2012-11-21 23:59:15 -0500] alexw: I'm getting `require': cannot load such file -- chef
[2012-11-21 23:59:43 -0500] bluepojo: alexw: you must not have chef installed
[2012-11-21 23:59:45 -0500] bluepojo: gem install chef
[2012-11-21 23:59:57 -0500] yfeldblum: bluepojo, although it's more just the happenstance of how i implemented it at first, rather than being a hardline position on where cookbooks should be cached to
