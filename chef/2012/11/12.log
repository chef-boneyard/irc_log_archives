[2012-11-12 00:03:17 -0500] matej_: how can I access IP of the node returned by search(:node, "role:test") in ruby recipe?
[2012-11-12 00:04:23 -0500] matej_: I've used result.first[:ipaddress] but it stopped working
[2012-11-12 00:09:10 -0500] pseudonymous: So, creating user resources I sort of get. As I'm using chef-solo, is there no better way to store the user information than in the json roles themselves ?
[2012-11-12 00:10:40 -0500] sascha_d: @pseudonymous if you can query ldap, you could write a block that does that?
[2012-11-12 00:10:49 -0500] sascha_d: I'm actually of two minds about user management and centralized vs non
[2012-11-12 00:10:57 -0500] sascha_d: if you are managing actual users, I guess you'd want that
[2012-11-12 00:11:11 -0500] sascha_d: I haven't been anyplace that manages people IDs on servers in several years
[2012-11-12 00:11:33 -0500] pseudonymous: sascha_d: I'm just running 2-3 servers for now, and I'll have a *very* limited set of users that need to interact with them as actual users (rather than visitors through the web). So no LDAP :)
[2012-11-12 00:11:35 -0500] sascha_d: so we mostly just have to manage application owners (jboss, tomcat, apache, jenkins)
[2012-11-12 00:12:28 -0500] sascha_d: You could create an attributes hash of user and attributes; it's not ideal, but this is POC-land
[2012-11-12 00:13:19 -0500] sascha_d: I wouldn't recommend it in a real life implementation, but if you're proof of concepting, you could create an attribute hash of users {} and do your logic from that
[2012-11-12 00:13:31 -0500] pseudonymous: Hmm yea I suppose. I'm sort of sad that Chef-Solo won't allow me to specify roles as ruby code.
[2012-11-12 00:13:46 -0500] sascha_d: wat?!
[2012-11-12 00:13:49 -0500] sascha_d: you totally can
[2012-11-12 00:14:04 -0500] sascha_d: that's how I maintain mine for my workstation bootstrap chef-solo collection
[2012-11-12 00:14:07 -0500] sascha_d: I will gist you
[2012-11-12 00:14:16 -0500] pseudonymous: sascha_d: well I do intend to use this in real life. But I'm managing sub 5 servers right now, so having a centralised chef server seems massively overkill :)
[2012-11-12 00:14:39 -0500] sascha_d: if you can get at the internets, hosted chef for 5 servers or fewer is free
[2012-11-12 00:14:51 -0500] pseudonymous: sascha_d: ok, cool, can't wait to see how it's done then
[2012-11-12 00:15:40 -0500] sascha_d: @pseudonymous https://gist.github.com/122a63a58027617bbc3f
[2012-11-12 00:15:56 -0500] sascha_d: actually, i ar dum, I've got that whole thing in a github repo; guess I didn't need to gist it :)
[2012-11-12 00:16:15 -0500] sascha_d: https://github.com/sbates/workstation_bootstrap
[2012-11-12 00:16:22 -0500] sascha_d: that's my working chef-solo bootstrap repo
[2012-11-12 00:16:50 -0500] matej_: how can I access IP of the node returned by search(:node, "role:test") in ruby recipe?
[2012-11-12 00:17:23 -0500] pseudonymous: sascha_d: ah, a mac user I see heh
[2012-11-12 00:17:44 -0500] sascha_d: @pseudonymous are you windowsing? I have some bootstrappy stuff for that too
[2012-11-12 00:18:23 -0500] pseudonymous: sascha_d: that would be massively interesting to see, actually! (But no, I'm a Linux user, mostly. I cry pretty intensely when I'm working in Windows)
[2012-11-12 00:18:40 -0500] sascha_d: most of us cry when working in windows
[2012-11-12 00:19:48 -0500] sascha_d: actually this bootstrap that I'm working on has both windows and mac stuff in the corp version, as we have hundreds of devs and fewer than 100 are on macs still
[2012-11-12 00:20:02 -0500] sascha_d: I don't think most of that survived to my personal copy which is a bit different though
[2012-11-12 00:21:36 -0500] pseudonymous: sascha_d: I was thinking about managing my own workstation using chef, it's such a nifty idea :)
[2012-11-12 00:22:05 -0500] sascha_d: Most of my stuff was stolen from Joshua Timberman and Pivotal Labs implementation
[2012-11-12 00:22:08 -0500] sascha_d: I like it a lot
[2012-11-12 00:30:42 -0500] pseudonymous: so you simply run a normal json file with the runlist mentioning a "role[dev_vm]" and it parses your ruby file, no problems ?
[2012-11-12 00:48:55 -0500] solarce: I am trying to follow http://wiki.opscode.com/display/chef/Setup+Opscode+User+and+Organization to download my organization key, but the screenshot does not seem to be a window I can find in the management console
[2012-11-12 00:50:02 -0500] solarce: Can I only regenerate the org key?
[2012-11-12 00:52:36 -0500] ssd7: solarce: I think that screen is only shown *right* after you create the organization.  If you don't already have a validator key out in the wild, regeneration is your best bet.
[2012-11-12 00:53:55 -0500] solarce: ssd7: thanks, i kind of figured that would be the case, good thing i don't have any clients setup yet
[2012-11-12 01:05:39 -0500] rafaelmagu: How can I stop berkshelf from uploading the cookbooks everytime I do a bundle exec vagrant up?
[2012-11-12 02:15:14 -0500] rhetts: smoke weed
[2012-11-12 02:16:15 -0500] joonas: rhetts: somehow I doubt that'll fix it for him
[2012-11-12 02:25:28 -0500] rhetts: well this is awkward
[2012-11-12 02:25:45 -0500] rhetts: i totally thought this was another channel :\
[2012-11-12 02:26:01 -0500] rhetts: i find it funny to say that for some reason because of the dr dre song
[2012-11-12 02:27:42 -0500] cwj: cheetos and goldfish
[2012-11-12 03:01:53 -0500] rafaelmagu: What's the deal with apt cookbook not doing an svn update after a repo is added using the LWRP
[2012-11-12 03:05:37 -0500] red5|ryan: did you specify action :add?
[2012-11-12 03:05:50 -0500] rafaelmagu: It's part of the sensu cookbook
[2012-11-12 03:06:22 -0500] rafaelmagu: https://github.com/sensu/sensu-chef/blob/master/recipes/linux.rb#L33
[2012-11-12 03:07:58 -0500] red5|ryan: weird
[2012-11-12 03:08:11 -0500] red5|ryan: have you tried running apt-get update manually on that box?
[2012-11-12 03:08:17 -0500] red5|ryan: maybe this got ya: https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb#L96
[2012-11-12 03:13:03 -0500] Glace: Is it me or running chef-client on Windows is super slow?
[2012-11-12 03:13:15 -0500] rafaelmagu: red5|ryan: running manually worked
[2012-11-12 03:13:23 -0500] rafaelmagu: Then the recipe worked on the next run
[2012-11-12 03:13:27 -0500] rafaelmagu: It's just weird that it does this
[2012-11-12 03:13:45 -0500] red5|ryan: yeah...
[2012-11-12 03:13:46 -0500] rafaelmagu: That line on the repo lwrp is probably what caused it
[2012-11-12 03:13:59 -0500] rafaelmagu: I've seen the same behaviour in other cookbooks as well
[2012-11-12 03:14:58 -0500] Glace: I tried with 10.14.4 and 10.16.0 and it is very slow to run on windows
[2012-11-12 03:17:26 -0500] rafaelmagu: Anyone got a good gpg cookbook?
[2012-11-12 03:17:37 -0500] rafaelmagu: Heavywater had one in the repo but they seem to have deleted it
[2012-11-12 03:18:23 -0500] rafaelmagu: Ah, nevermind
[2012-11-12 03:18:39 -0500] rafaelmagu: Found it (the link on Opscode is dead, btw)
[2012-11-12 03:19:11 -0500] rafaelmagu: For the record: https://github.com/heavywater/chef-gpg
[2012-11-12 03:33:46 -0500] siezer: is hosted being slow?
[2012-11-12 03:41:43 -0500] patjenk: I'm new to writing chef recipes and I was wondering if it's possible to use resources inside resources. For example I could use the directory resource to see if a directory exists and if so use the remote_file resource to add a file to it after it's created. Is this possible or is there a better way of organizing these actions?
[2012-11-12 03:45:04 -0500] capen: I'm not sure it's possible, but does anyone know if you can put logic in a configuration file (solo.rb) to specify different parameters based on an environment?  (i.e. proxy settings?)
[2012-11-12 03:45:57 -0500] capen: my test blew up in my face.
[2012-11-12 03:47:38 -0500] siezer: patjenk you're thinking about it wrong.. chef is about desired state. just stick your directory resource before the remote_file resource in a recipe and you'll be good.
[2012-11-12 03:47:45 -0500] siezer: capen its possible, but it sounds like its cleaner to do your decision logic in the compile phase and pass a variable parameter to the template resource
[2012-11-12 03:48:16 -0500] capen: it's for the actual run though.  not for template.
[2012-11-12 03:48:17 -0500] capen: sec
[2012-11-12 03:48:57 -0500] siezer: wait what?
[2012-11-12 03:49:09 -0500] capen: something like this: https://gist.github.com/4057414
[2012-11-12 03:50:31 -0500] capen: yeah i know it sounds crazy, but the environments are completely segregated. with diff domains and proxies...
[2012-11-12 03:50:48 -0500] siezer: that config is used to start up chef.. you're not going to get access to that node object until the chef run is going, so thats not gonna work
[2012-11-12 03:51:01 -0500] siezer: show me how it blew up?
[2012-11-12 03:51:22 -0500] capen: yeah i figured as much but wasn't sure if there was some magic I didn't know about...
[2012-11-12 03:51:46 -0500] capen: blew up as expected undefined method on the node.domain call.
[2012-11-12 03:52:46 -0500] capen: i was wanting to avoid having separate config files for each environment.  not the end of the world.
[2012-11-12 03:52:58 -0500] siezer: you could do some ghett regex matching against `hostname -f` ;)
[2012-11-12 03:53:33 -0500] siezer: or `dnsdomainname`
[2012-11-12 03:54:11 -0500] timsmith: Anyone out there have advice on sorted search results by a field
[2012-11-12 03:54:13 -0500] timsmith: ?
[2012-11-12 03:55:54 -0500] capen: I'll give that a shot.  I'll let you know how it goes, but may be awhile, getting pulled into a call. :P
[2012-11-12 03:58:23 -0500] Glace: Is it me or running chef-client on Windows is super slow?
[2012-11-12 04:16:49 -0500] timsmith: yep
[2012-11-12 04:16:51 -0500] timsmith: known issue
[2012-11-12 04:19:23 -0500] Glace: timsmith: ok cool thanks..  any idea if it is going to be fixed soon?
[2012-11-12 04:19:33 -0500] timsmith: I hope soon
[2012-11-12 04:19:36 -0500] timsmith: no idea though
[2012-11-12 04:19:43 -0500] timsmith: it's a CPU hog
[2012-11-12 04:20:06 -0500] Glace: ok.. ya.. its a bit annoying since we might want to go prod soon with some Windows Machine
[2012-11-12 04:23:54 -0500] timsmith: my advice is to only run when you want to push a change
[2012-11-12 04:23:57 -0500] timsmith: I do that on my Windows nodes
[2012-11-12 04:24:01 -0500] timsmith: not really the best solution
[2012-11-12 04:24:03 -0500] timsmith: but it works for now
[2012-11-12 04:24:41 -0500] Glace: hehe thanks..  ya that could do it for now :)
[2012-11-12 04:25:02 -0500] rob___: When using cookbooks from opscode is it common practice to somehow add onto an existing recipe? I understand you can change defaults via the override_attributes directive but how would you say add a recipe or add a new template? For example, i'm using the nginx cookbook but I would like to add a log_format directive but it doesn't exist in the default template how could that be accomplished ?
[2012-11-12 04:27:29 -0500] red5|ryan: you could make a wrapper cookbook rob_nginx. then in default.rb do an include_recipe "nginx" followed by your own template block to overwrite the default template.
[2012-11-12 04:27:52 -0500] timsmith: I've gone that route in the past
[2012-11-12 04:27:58 -0500] capen: siezer: fixed I don't need to get fancy with regex at this point.  it was more about me trying to call node attributes. :P https://gist.github.com/4057414
[2012-11-12 04:28:09 -0500] timsmith: ideally you take what you think should be there and you commit it upstream
[2012-11-12 04:28:19 -0500] timsmith: but sometimes that's not possible
[2012-11-12 04:28:25 -0500] Glace: You could also bump the version , add the required field to the template and submit a pull request to make sure that your stuff will be in the next version
[2012-11-12 04:28:48 -0500] Glace: oops too late :) tim already said it
[2012-11-12 04:28:57 -0500] rob___: got it
[2012-11-12 04:29:01 -0500] rob___: seems simple enough
[2012-11-12 04:31:32 -0500] rob___: would it be a simple as replacing the default template it tries to render or would I need to completely duplicate the logic in default.rb?
[2012-11-12 04:32:16 -0500] siezer: how does everyone deal with vagrant putting the useable ips on eth1?
[2012-11-12 04:32:29 -0500] siezer: having trouble crafint a search
[2012-11-12 04:32:34 -0500] siezer: crafting even
[2012-11-12 04:32:42 -0500] rob___: so i could just call "nginx::source" then in my project just add templates/default/nginx.conf.erb
[2012-11-12 04:36:55 -0500] red5|ryan: you'd still have to process the template in your cookbook with template "" do end and pass it variables
[2012-11-12 04:37:31 -0500] siezer: ['network']['interfaces']['eth1']['addresses'].select{|key,val| val[:family] == 'inet'}.flatten[0])
[2012-11-12 04:37:33 -0500] red5|ryan: if you're lucky everything used there will be a node attribute set by the real nginx cookbook
[2012-11-12 04:37:37 -0500] siezer: ^ okay thats just ridic
[2012-11-12 04:38:34 -0500] rob___: oh.. so its not like inherited or anything
[2012-11-12 04:38:53 -0500] rob___: i.e., if i call "super" in the recipe its not going to call my overridden "method"
[2012-11-12 04:39:11 -0500] rob___: that would be sweet
[2012-11-12 05:07:31 -0500] Glace: timsmith: http://permalink.gmane.org/gmane.comp.sysutils.chef.user/981
[2012-11-12 05:07:46 -0500] Glace: It seems that it is some plugins that make it slow
[2012-11-12 05:14:23 -0500] timsmith: yes
[2012-11-12 05:14:36 -0500] timsmith: ohai loads the version of every driver on the system
[2012-11-12 05:14:42 -0500] timsmith: HUGE amount of worthless data
[2012-11-12 05:26:49 -0500] warhippie: anyone here of chef install that is scaling out to 50k servers?
[2012-11-12 05:29:08 -0500] red5|ryan: where would you even find 50k servers
[2012-11-12 05:31:21 -0500] warhippie: in my closet ... its big ...
[2012-11-12 05:32:13 -0500] warhippie: no really scatered about the us
[2012-11-12 05:32:25 -0500] warhippie: red5|ryan: ^^^^^^^^^^^^^^^^^^^^66
[2012-11-12 05:32:42 -0500] red5|ryan: haha
[2012-11-12 05:33:47 -0500] warhippie: we are looking chef for a project of that scope ... I have never heard of any one doing anythign that big with chef ... dunno if it is possible ...
[2012-11-12 05:34:49 -0500] timsmith: warhippie: Chef 11
[2012-11-12 05:35:35 -0500] warhippie: timsmith: Chef 11 ? how so?
[2012-11-12 05:37:45 -0500] timsmith: warhippie: Chef 11 with erchef should scale to that level
[2012-11-12 05:37:54 -0500] timsmith: Chef 10 would most likely not
[2012-11-12 05:39:00 -0500] warhippie: timsmith: any goot way to benchmark
[2012-11-12 05:40:06 -0500] timsmith: warhippie: not sure.  You'd probably want to contact Opscode and get information on erchef.  I'm sure they have some benchmarks
[2012-11-12 05:41:06 -0500] warhippie: timsmith: checking it out now ... thanks!!!
[2012-11-12 05:51:33 -0500] warhippie: timsmith: I am a little week on my erlang ...
[2012-11-12 05:52:19 -0500] timsmith: Chef 11 was a rewrite of Chef server
[2012-11-12 05:52:33 -0500] timsmith: they built it when they started their hosted product to bring scale to the product
[2012-11-12 05:52:45 -0500] timsmith: the client is still the same ruby app
[2012-11-12 05:52:50 -0500] timsmith: no change necessary on your part
[2012-11-12 05:52:55 -0500] timsmith: the server just scales way better
[2012-11-12 05:52:59 -0500] timsmith: it comes out in a few weeks
[2012-11-12 05:53:54 -0500] erikh: actually there are some changes to how attributes work, IIRC.
[2012-11-12 06:03:34 -0500] warhippie: erikh: like what?
[2012-11-12 06:09:13 -0500] red5|ryan: http://wiki.opscode.com/display/chef/Breaking+Changes+in+Chef+11
[2012-11-12 06:31:44 -0500] BryanWB_: ohai chefs!
[2012-11-12 08:49:17 -0500] haakond: What is the recommended way to deploy SSH certificates? With Encrypted Databags, or something else?
[2012-11-12 08:49:59 -0500] haakond: Sorry, s/SSH/SSL
[2012-11-12 10:18:37 -0500] Joris_: good day gentlement
[2012-11-12 10:18:42 -0500] Joris_: -t
[2012-11-12 10:19:07 -0500] Joris_: Chef is supposed to execute the run_list in the order as specified, right?
[2012-11-12 10:19:20 -0500] Mithrandir: yes
[2012-11-12 10:19:37 -0500] Joris_: I have an expanded run_list like this users::sysadmins, sudo, apt, build-essential, mysql::ruby
[2012-11-12 10:20:05 -0500] Joris_: But the first thing it will execute is mysql::ruby
[2012-11-12 10:20:47 -0500] Joris_: Which then fails because for whatever reason it decides not to execute the build-essentials recipe, as specified in the mysql::ruby recipe
[2012-11-12 10:20:56 -0500] Joris_: perhaps because it is in the run_list already?
[2012-11-12 10:21:15 -0500] Joris_: But then the chef_gem "mysql" fails because make is not on the system yet.
[2012-11-12 10:21:21 -0500] Joris_: Any suggestions?
[2012-11-12 10:22:58 -0500] aruntomar: Joris_: chef respects the sequence, not sure why it's happening with you. can you paste the output of knife node show <your node name> to a gist.
[2012-11-12 10:24:34 -0500] Joris_: Will do, hold on
[2012-11-12 10:25:39 -0500] Joris_: aruntomar: that doesn't show anything meaningful yet
[2012-11-12 10:26:37 -0500] Joris_: run_list for example is still empty
[2012-11-12 10:26:38 -0500] Joris_: is that because the chef-client run fails?
[2012-11-12 10:26:38 -0500] Joris_: I am running chef-client with the run_list specified in the startup
[2012-11-12 10:26:42 -0500] aruntomar: Joris_: r u using chef-solo or hosted chef?
[2012-11-12 10:27:09 -0500] Joris_: A dedicated chef server
[2012-11-12 10:28:23 -0500] aruntomar: Joris_: k. if chef-client run fails, it doesn't affect the run_list in anyway
[2012-11-12 10:28:39 -0500] aruntomar: Joris_: r u sure, you didn't delete the items from the run_list?
[2012-11-12 10:29:20 -0500] Joris_: I am pretty positive, but let me specify the run_list through the web console and run it again, see what happens.
[2012-11-12 10:30:58 -0500] Joris_: It fails again
[2012-11-12 10:31:49 -0500] aruntomar: have u added all the cookbooks?
[2012-11-12 10:31:50 -0500] Joris_: The output of knife node show [node] shows a bit more, the recipe list (which is "role[lin_base], recipe[mysql::ruby]") but recipes and so on is still left emtpy
[2012-11-12 10:32:18 -0500] Joris_: Added to the chef server you mean?
[2012-11-12 10:32:20 -0500] Joris_: Yes
[2012-11-12 10:32:35 -0500] Joris_: If I remove the [recipe::mysql] I am pretty sure it works flawlessly
[2012-11-12 10:33:35 -0500] Joris_: Because the lin_base role works for a while now, I started getting problem when I added the mysql::ruby stuff
[2012-11-12 10:34:00 -0500] aruntomar: Joris_: and r u sure, you've not added recipe[mysql::ruby] in the role that you specified?
[2012-11-12 10:35:02 -0500] Joris_: The current run_list of lin_base = run_list("recipe[users::sysadmins]", "recipe[sudo]","recipe[apt]", "recipe[build-essential]",)
[2012-11-12 10:36:22 -0500] aruntomar: Joris_: that's weird. everything seems to be in order
[2012-11-12 10:36:33 -0500] aruntomar: Joris_: try running chef-client -l debug, it
[2012-11-12 10:36:41 -0500] aruntomar: it'll show lot of output
[2012-11-12 10:36:59 -0500] Joris_: Done it before, something specific I should pay attention to?
[2012-11-12 10:42:53 -0500] aruntomar: Joris_: look closely at the section after the cookbooks are synchronized.
[2012-11-12 10:43:05 -0500] aruntomar: Joris_: by the way which chef version are u using?
[2012-11-12 10:44:28 -0500] Joris_: chef-client varies, 10.14.2 as well as 10.16.2 but both have the same problem
[2012-11-12 10:44:35 -0500] Joris_: Looking at the debug log
[2012-11-12 10:45:06 -0500] Joris_: I see the client reporting the it found and loading the recipe in the specified order
[2012-11-12 10:45:21 -0500] Joris_: E.g. DEBUG: Loading Recipe users::sysadmins via include_recipe
[2012-11-12 10:45:30 -0500] Joris_:  DEBUG: Found recipe sysadmins in cookbook users
[2012-11-12 10:46:00 -0500] Joris_: But the first processing message I get is the mysql::ruby one, who is supposed to be executed as the very last
[2012-11-12 10:46:16 -0500] Joris_: INFO: Processing execute[apt-get update] action run (mysql::ruby line 23)
[2012-11-12 10:46:40 -0500] Joris_: And then after the apt-get-update, it is supposed to include the build-essential recipe
[2012-11-12 10:46:42 -0500] _rc: so did you look at the recipe, is it forcing compile time execution
[2012-11-12 10:47:11 -0500] Joris_: Yes, I did, I didn't use compile time execution
[2012-11-12 10:48:54 -0500] Joris_: rc: but I think this might be the right direction
[2012-11-12 10:49:41 -0500] Joris_: And I think I was wrong
[2012-11-12 10:49:58 -0500] Joris_: the mysql::ruby recipe does the following
[2012-11-12 10:50:15 -0500] Joris_: node.set['build_essential']['compiletime'] = true
[2012-11-12 10:50:23 -0500] Joris_: include_recipe "build-essential"
[2012-11-12 10:50:26 -0500] Joris_: include_recipe "mysql::client"
[2012-11-12 10:52:16 -0500] Joris_: I'm not very familiar with this, but I can imagine it forces the mysql::ruby to be executed before the others
[2012-11-12 10:52:17 -0500] Joris_: Correct
[2012-11-12 10:52:22 -0500] Joris_: ?
[2012-11-12 10:53:06 -0500] _rc: it wouldn't in itself
[2012-11-12 10:54:16 -0500] erikh: it's because of chef_gem
[2012-11-12 10:54:35 -0500] Joris_: why's that?
[2012-11-12 10:54:39 -0500] erikh: which does the right thing, but unfortunately comes with some limitations
[2012-11-12 10:54:46 -0500] erikh: chef_gem runs at compile time.
[2012-11-12 10:54:56 -0500] Joris_: Aha, I see
[2012-11-12 10:55:05 -0500] Joris_: But it fails because it needs make
[2012-11-12 10:55:21 -0500] Joris_: Which is installed as part of build-essential
[2012-11-12 10:55:25 -0500] erikh: i had a similar issue bootstrapping a gem that required nokogiri
[2012-11-12 10:55:35 -0500] erikh: the solution is... not pretty
[2012-11-12 10:55:45 -0500] Joris_: Hmm, was afraid so
[2012-11-12 10:55:55 -0500] Joris_: But please tell, I won't tell anyone :-)
[2012-11-12 10:56:02 -0500] erikh: sure, let me see if I can root up the relevant code
[2012-11-12 10:57:25 -0500] erikh: https://gist.github.com/5fff279b46e89f319bbc
[2012-11-12 10:57:35 -0500] erikh: ipclient is hosted with the cookbook, it's an in-house gem.
[2012-11-12 10:58:15 -0500] erikh: build tools are already on the boxes we use, but the premise is pretty much the same.
[2012-11-12 10:58:28 -0500] erikh: just note that virtual packages in dpkg aren't queryable with dpkg-query
[2012-11-12 10:58:41 -0500] erikh: that is, you can't just dpkg-query -s build-essential
[2012-11-12 10:58:45 -0500] erikh: you have to dpkg-query -s make
[2012-11-12 10:59:54 -0500] Joris_: Ah, I see
[2012-11-12 11:00:14 -0500] Joris_: Well, I am glad I (am starting to) understand the reason why it 'changed' the execution order
[2012-11-12 11:00:35 -0500] Joris_: And will see how I can integrate your solution
[2012-11-12 11:00:38 -0500] erikh: yeah, so the fundamental reason chef_gem works the way it does is to make the gem available as early as possible
[2012-11-12 11:00:58 -0500] Joris_: Which makes sense
[2012-11-12 11:01:16 -0500] Joris_: But a bit of a shame it doesn't take care of the missing make
[2012-11-12 11:01:17 -0500] erikh: otherwise, it'll get scheduled into the resource run list like any other resource, which can alter what expects what when
[2012-11-12 11:01:28 -0500] erikh: well, chef_gem does enough already, heh
[2012-11-12 11:01:49 -0500] erikh: but yeah, that dpkg-query business is basically to accomplish what the apt cookbook can't do that early
[2012-11-12 11:02:11 -0500] erikh: otherwise if the machine has a stale package cache, it'll blow up contacting mirrors.
[2012-11-12 11:02:42 -0500] erikh: I mean, there's nothing keeping you from doing this, I guess
[2012-11-12 11:02:58 -0500] Joris_: ok, thanks, see if I get it to work
[2012-11-12 11:03:26 -0500] erikh: https://gist.github.com/5fff279b46e89f319bbc
[2012-11-12 11:03:28 -0500] erikh: line #16
[2012-11-12 11:03:52 -0500] erikh: that way build-essential only gets installed after apt-get update, and only if you actually need to install those packages
[2012-11-12 11:03:58 -0500] erikh: not pretty, but it should solve the problem.
[2012-11-12 11:05:18 -0500] Joris_: thanks erikh
[2012-11-12 11:09:03 -0500] erikh: probably a good case for a hooked_chef_gem provider or something, that determines if chef_gem actually needs to do something and then executes a boatload of code before doing so
[2012-11-12 11:09:40 -0500] erikh: I mean, that whole set of stuff could easily be predicated on whether chef_gem actually needed to install a gem or not
[2012-11-12 11:10:01 -0500] erikh: anyhow, i'm about 3 hours past due for a pillow.
[2012-11-12 11:27:22 -0500] pseudonymous: Writing a method inside a recipe and attempting to call it inside a user resource produces an error NoMethodError: undefined methods 'home_dir' for Chef::Resource::User  -- so can I not make/use methods inside a recipe ?
[2012-11-12 11:29:04 -0500] _rc: sounds like you want to make that a definition or a library function
[2012-11-12 11:29:43 -0500] erikh: it's because of the way chef resources work
[2012-11-12 11:30:07 -0500] erikh: they actually create an instance of a Chef::Provider and then run a ruby call called 'instance_eval' which then executes your block
[2012-11-12 11:30:08 -0500] pseudonymous: _rc: I've come across a blog post that seems to use the same terminology but I'm quite example-driven, how would I go about accomplishing either ? To me it seems *ugly* to litter a resource block if if's and whatnot.
[2012-11-12 11:30:22 -0500] pseudonymous: oh
[2012-11-12 11:30:24 -0500] erikh: from the perspective of the executing code at that point, your method is out of scope.
[2012-11-12 11:30:37 -0500] erikh: err, Chef::Resource, sorry.
[2012-11-12 11:31:00 -0500] erikh: anyhow, point remains. it's also why instance variables that you defined at the top level of your recipe won't work in resources either.
[2012-11-12 11:31:49 -0500] pseudonymous: Ok, found http://wiki.opscode.com/display/chef/Libraries and that seems straightforward enough :)
[2012-11-12 11:32:01 -0500] erikh: yep, that's usually the way to get around it
[2012-11-12 11:32:18 -0500] erikh: but the instance_eval will bite you in subtle ways, understanding how it works is the key to not being bitten by it.
[2012-11-12 11:32:22 -0500] _rc: pseudonymous: the wiki has examples.  http://wiki.opscode.com/display/chef/Definitions
[2012-11-12 11:33:33 -0500] pseudonymous: Lucky me, I may be a shoddy sysadm, but at least I'm coming at this with a decent understanding of ruby :) Otherwise I can see why this would be a little strange
[2012-11-12 11:33:55 -0500] erikh: :)
[2012-11-12 11:35:02 -0500] erikh: instance variables are even worse because they silently yield nil :)
[2012-11-12 11:35:48 -0500] pseudonymous: eww! I'll try to keep that in mind, but yea, that makes sense, they'll be out of scope and any out of scope variables automatically yield nil
[2012-11-12 11:54:06 -0500] BryanWB_: erikh: gooooo to sleeep ;)
[2012-11-12 12:28:58 -0500] kraM: I have node[:foo][:bar][:bob] => 'Alice' - How do I search for nodes which have this attribute set to 'Alice'?
[2012-11-12 12:33:48 -0500] meineerde: kraM: search(:node, "foo_bar_bob:Alice")
[2012-11-12 12:33:54 -0500] meineerde: see http://wiki.opscode.com/display/chef/Search#Search-NestedFields
[2012-11-12 12:33:56 -0500] kraM: Ah, underscore!
[2012-11-12 12:34:05 -0500] kraM: Thanks!
[2012-11-12 12:35:13 -0500] kraM: Makes it not easier if guys name their key within node objects with underscores.
[2012-11-12 12:35:26 -0500] kraM: Anyway, thanks for the pointer to the docs!
[2012-11-12 12:35:49 -0500] meineerde: kraM: as long as there are no conflicts, everything should be fine
[2012-11-12 12:59:07 -0500] killfill: hi
[2012-11-12 12:59:29 -0500] killfill: i dont understand the application cookbook. it seems to be a wrapper for deploy.
[2012-11-12 12:59:40 -0500] killfill: what extra bonus does it provide?
[2012-11-12 13:06:08 -0500] dyer: Is "include_attribute" not supported in Chef Solo ?
[2012-11-12 13:35:04 -0500] yfeldblum: killfill, being a wrapper for deploy, that's the extra bonus it provides
[2012-11-12 13:35:16 -0500] yfeldblum: dyer, why do you ask?
[2012-11-12 13:35:52 -0500] dyer: because it wasnt working, and I was surprised to see that :)
[2012-11-12 13:36:45 -0500] yfeldblum: dyer, i assume it's supported in the sense that it's a no-op in chef-solo ... in what way is it not working?
[2012-11-12 13:38:19 -0500] Topcat: I have quite a simple use case, I want to sync the configurations I use across the windows boxes I use. My question: is chef overkill?
[2012-11-12 13:38:25 -0500] dyer: https://gist.github.com/e6a01b504e5ed5be85c2
[2012-11-12 13:38:48 -0500] dyer: yfeldblum, the first one didnt work, the attribute was set to the prism cookbooks default 'false'
[2012-11-12 13:38:53 -0500] dyer: the second did work
[2012-11-12 13:39:43 -0500] yfeldblum: dyer, perhaps the prism cookbook was loaded second, overriding the work done in the app cookbook's attributes?
[2012-11-12 13:40:05 -0500] yfeldblum: dyer, an nvm
[2012-11-12 13:40:22 -0500] dyer: http://wiki.opscode.com/display/chef/Attributes#Attributes-CookbookAttributeFileOrdering
[2012-11-12 13:45:11 -0500] yfeldblum: dyer, the prism attributes file is being loaded twice?
[2012-11-12 13:45:21 -0500] dyer: ?
[2012-11-12 13:45:24 -0500] dyer: What do you mean?
[2012-11-12 13:49:04 -0500] yfeldblum: dyer, the attributes file in the app cookbook is loaded, calling include_attributes, and subsequently the attributes file in the prism cookbook is loaded
[2012-11-12 13:54:50 -0500] dyer: but I thought this "http://wiki.opscode.com/display/chef/Attributes#Attributes-CookbookAttributeFileOrdering" says include_attribute forces the load order of the attributes
[2012-11-12 13:55:11 -0500] dyer: so Prism should be loaded before app, allowing me to override Prism attributes in the app cookbook's attributes file
[2012-11-12 14:05:17 -0500] yfeldblum: dyer, it doesn't say that any attributes file will be loaded only once ...
[2012-11-12 14:06:03 -0500] yfeldblum: dyer, also as a general matter you should only set default attributes for the app cookbook in the app cookbook's attributes files; you should not set default attributes for other cookbooks there
[2012-11-12 14:06:30 -0500] yfeldblum: dyer, if you need to change the node attributes that another cookbook looks at, better to change them in a recipe
[2012-11-12 14:07:10 -0500] dyer: We treat the Prism cookbook as kind of a base cookbook, its only included by other recipes as a dependency
[2012-11-12 14:07:26 -0500] dyer: Funny, this method has worked fine for me for ages in Chef-Server
[2012-11-12 14:10:33 -0500] yfeldblum: dyer, yeah ... attributes load order is very odd, and does not reflect any sort of topological sort of the cookbooks in the expanded run-list
[2012-11-12 14:12:59 -0500] gyre008: I'm dealing with a tricky issuewe have a recipe - not written by me - which is basically trying to chain the notifications so it does resource1 -> notify(res2) -> res2 -> notify(res3)the problem is that res2 is defined AFTER res1 so res1 can't notify itis there any way around this ?
[2012-11-12 14:13:24 -0500] dyer: Yea, I really think this is a difference between solo and server, because this definitely works in server
[2012-11-12 14:15:05 -0500] gyre008: something like this https://gist.github.com/4059632
[2012-11-12 14:15:18 -0500] yfeldblum: dyer, perhaps chef-solo specifies the order as alphabetical by cookbook name, but i'm not sure if chef-client specifies the order in which attributes files are loaded
[2012-11-12 14:15:33 -0500] gyre008: i can't get my head around this onethere must be a way how to chain notifications in Chef...
[2012-11-12 14:16:10 -0500] yfeldblum: gyre008, there is, but chaining notifications is usually silly
[2012-11-12 14:16:30 -0500] geekbri: seems like maybe subscribing to notifications is cleaner as well
[2012-11-12 14:16:35 -0500] gyre008: yfeldblum, wellif you need to do something before something elsehow do you do it ?
[2012-11-12 14:16:57 -0500] gyre008: geekbri, mm yeah subscribing is another idea..
[2012-11-12 14:17:05 -0500] gyre008: maybe thats the answer..
[2012-11-12 14:17:16 -0500] gyre008: do subscribe instead of notify ,mm..
[2012-11-12 14:18:27 -0500] yfeldblum: gyre008, http://pastie.org/private/xrefq95uaa2m4g4m38jzng
[2012-11-12 14:19:45 -0500] gyre008: yfeldblum, looks cool.why is the 3rd resource subscribed to the first one ? or is it just an example of multiple subscription ?
[2012-11-12 14:20:48 -0500] yfeldblum: gyre008, it's two different ways of doing it with different semantics
[2012-11-12 14:20:54 -0500] gyre008: i see
[2012-11-12 14:21:06 -0500] yfeldblum: gyre008, and you pick one way that works best for your scenario
[2012-11-12 14:21:10 -0500] gyre008: will give that a shotawesome stuff yfeldblum as always :)
[2012-11-12 14:21:13 -0500] gyre008: thanks
[2012-11-12 14:21:33 -0500] geekbri: I personally think subscriptions make the code more clear and easier to understand, as opposed to chaining notifications
[2012-11-12 14:21:47 -0500] geekbri: You are free still to disagree.  For not :)
[2012-11-12 14:22:35 -0500] geekbri: s/not/now
[2012-11-12 14:23:27 -0500] darthdeus: hey guys, how would i overwrite this default in a node's config? https://github.com/opscode-cookbooks/vim/blob/master/attributes/default.rb
[2012-11-12 14:23:43 -0500] darthdeus: i tried default_attributes: { vim: { extra_packages: ... but it didn't work
[2012-11-12 14:24:05 -0500] gyre008: I have one more questionis there any way how you can use resources in ruby_block ? I guess you can open a resource or something like that ?
[2012-11-12 14:24:17 -0500] gyre008: just out of curiosity...
[2012-11-12 14:24:57 -0500] yfeldblum: gyre008, yes, if you use the technique in https://gist.github.com/d85be145f3ff824ccc07
[2012-11-12 14:25:31 -0500] gyre008: I see...
[2012-11-12 14:26:35 -0500] gyre008: I remember there was an example on how to open a resource from within the ruby_block resource somewhere on the wiki.
[2012-11-12 14:27:33 -0500] gyre008: or maybe i don't remember it right...
[2012-11-12 14:30:04 -0500] gyre008: something like this yfeldblum ? https://gist.github.com/4059722
[2012-11-12 14:31:08 -0500] yfeldblum: gyre008, all the ruby code outside of the block block is executed immediately, as opposed to during convergence
[2012-11-12 14:31:11 -0500] gyre008: I mean https://gist.github.com/4059722
[2012-11-12 14:31:21 -0500] gyre008: ah
[2012-11-12 14:31:31 -0500] gyre008: so I have to put it inside it then...
[2012-11-12 14:33:11 -0500] gyre008: this then https://gist.github.com/4059722 ...
[2012-11-12 14:35:10 -0500] gyre008: I guess :)unless I missed something in the translation as always :)
[2012-11-12 14:41:56 -0500] geekbri: Perhaps I misunderstand the use of NOT within solr/chef search.  Does this seem correct?   knife search "chef_environment:production AND NOT name:blah*.example.com"
[2012-11-12 14:44:39 -0500] yfeldblum: geekbri, looks ok, but who knows ...
[2012-11-12 14:44:50 -0500] geekbri: well it doesn't work so there is that whole thing ;
[2012-11-12 14:44:51 -0500] geekbri: ;)
[2012-11-12 14:45:03 -0500] jforest: details.
[2012-11-12 14:45:08 -0500] yfeldblum: geekbri, you could try putting the not part in parentheses
[2012-11-12 14:45:10 -0500] geekbri: details are that im a failure.
[2012-11-12 14:45:17 -0500] geekbri: its missing the word "node"
[2012-11-12 14:47:23 -0500] Litex: Happy Monday, Chefs.
[2012-11-12 14:48:55 -0500] BryanWB_: Litex: happy monday!
[2012-11-12 14:49:17 -0500] BryanWB_: someone contacted me last week about the maven lwrp, is that person around?
[2012-11-12 14:51:14 -0500] gyre008: yfeldblum, did I get that right in my last gist ?
[2012-11-12 14:51:46 -0500] yfeldblum: gyre008, nope
[2012-11-12 14:51:52 -0500] gyre008: :)
[2012-11-12 14:52:23 -0500] gyre008: unless that recipe_eval should be outside of ruby_block code..
[2012-11-12 14:52:39 -0500] gyre008: or I'm confused :)
[2012-11-12 14:54:05 -0500] yfeldblum: gyre008, recipe_eval is an instance method defined in the class Chef::Provider; in my gist, i offer an override of that method that makes it a little more useful; so there's no recipe_eval in recipes, in resources, or in the binding of the block block in a ruby_block resource
[2012-11-12 14:55:15 -0500] davidmz: hello, what is the memory footprint of chef-client?
[2012-11-12 14:55:59 -0500] gyre008: yfeldblum, so why did you bring it up then ?  mm
[2012-11-12 14:56:10 -0500] masterkorp: http://i.imgur.com/cyfMs.jpg
[2012-11-12 14:56:28 -0500] yfeldblum: gyre008, i'm not sure why you'd want to do it, but the point was you could use the technique from that gist
[2012-11-12 14:56:53 -0500] yfeldblum: gyre008, or even the technique from the Chef::Provider#recipe_eval that ships with chef
[2012-11-12 14:58:14 -0500] gyre008: wellI'm curious whether I could use/create a resource within ruby blockand am wondering how to do that,..
[2012-11-12 14:58:48 -0500] gyre008: if its even possible...
[2012-11-12 15:00:06 -0500] yfeldblum: gyre008, what for?
[2012-11-12 15:00:47 -0500] gyre008: I was thinking something like creating a resource on the first run only.http://wiki.opscode.com/pages/viewpage.action?pageId=15728818
[2012-11-12 15:01:46 -0500] gyre008: basicallyto create MORE than one first run resources...
[2012-11-12 15:01:57 -0500] yfeldblum: gyre008, "Whenever possible, it is best to use an idempotent resource."
[2012-11-12 15:01:58 -0500] gyre008: the example on that link is showing only one...
[2012-11-12 15:02:05 -0500] gyre008: yeah I know
[2012-11-12 15:03:19 -0500] gyre008: in other wordsit's not possible..cool :)
[2012-11-12 15:04:35 -0500] yfeldblum: gyre008, it's possible with the technique in recipe_eval, but i don't think it's useful because it most likely means you're fighting with chef instead of working with it
[2012-11-12 15:05:47 -0500] VolodymyrB: Hi, how to remove node?
[2012-11-12 15:06:25 -0500] gyre008: hehwe can philosophise about working and fighting with Chef or with any other technology for ages...
[2012-11-12 15:06:26 -0500] cheeseplus: VolodymyrB: knife node delete nodename
[2012-11-12 15:06:31 -0500] masterkorp: VolodymyrB: knife help node && knife help client
[2012-11-12 15:06:39 -0500] masterkorp: cheeseplus: damm you :P
[2012-11-12 15:06:49 -0500] VolodymyrB: cheeseplus: masterkorp: thanks
[2012-11-12 15:06:53 -0500] cheeseplus: masterkorp: yours is the more informative answer ;)
[2012-11-12 15:07:13 -0500] masterkorp: VolodymyrB: dont forget to remove the client from that node too
[2012-11-12 15:07:19 -0500] masterkorp: same syntax
[2012-11-12 15:08:01 -0500] gyre008: imagine situation like Master/Slave DB replicationyou only want to do the FIRST SYNC oncenot alwaysclassic example when you wan to have FIRST RUN ONLY resource yfeldblum
[2012-11-12 15:08:42 -0500] gyre008: so there IS a business case for this...
[2012-11-12 15:08:57 -0500] gyre008: and certainly I don't see that as fighting with Chef ;)
[2012-11-12 15:09:07 -0500] yfeldblum: gyre008, then the technique from that wiki page isn't likely to work correctly, and there's no need to declare resources inside ruby_block block blocks
[2012-11-12 15:09:27 -0500] gchristensen: I'm not very comfortable with spinning up slaves magically, I don't know about you but that seems like asking for trouble...
[2012-11-12 15:10:10 -0500] gyre008: what do you mean it isn't likely to work correctly ? it iswe are using itwe do the first sync on slave only when the slave is introduced ...
[2012-11-12 15:11:08 -0500] yfeldblum: gyre008, that technique abuses `node.save` and is not too resilient to failure cases in the first run
[2012-11-12 15:12:37 -0500] gyre008: yfeldblum, yeah, fair enoughbut you notice the failure on the first run straight away...
[2012-11-12 15:12:42 -0500] gyre008: and its only first run...
[2012-11-12 15:12:43 -0500] yfeldblum: gyre008, better to make the sync itself idempotent
[2012-11-12 15:12:46 -0500] gyre008: also it's slave..so...
[2012-11-12 15:13:03 -0500] gyre008: but is there any other wayI couldn't think of any other way...
[2012-11-12 15:13:23 -0500] gyre008: unless you touch some file in the data dir and check for its existence or something like that...
[2012-11-12 15:13:56 -0500] yfeldblum: gyre008, ruby_block("sync it" ) { block { sync_it } ; only_if { sync_needed? } }
[2012-11-12 15:14:09 -0500] gchristensen: you could do it based on master status or something
[2012-11-12 15:14:21 -0500] yfeldblum: gyre008, but here `sync_needed?` actually inspects the state of the server and of the mysql instance
[2012-11-12 15:14:53 -0500] davidmz: hello, what is the memory footprint of chef-client?
[2012-11-12 15:15:05 -0500] gyre008: yfeldblum, hehein that case we would have to speak to OPscode to fix pg gem in omnibus install ;)
[2012-11-12 15:15:21 -0500] yfeldblum: gyre008, shell out to psql then
[2012-11-12 15:15:48 -0500] gyre008: and I don't see that happening any time soonyeah I could shell our form psql.but shelling out is such an ugly ruby/chef crap...arrgh
[2012-11-12 15:16:14 -0500] yfeldblum: gyre008, sometimes that's the way to do it ...
[2012-11-12 15:16:31 -0500] gyre008: wellin this case it might just be...
[2012-11-12 15:18:56 -0500] jtimberman: gyre008: COOK-1406
[2012-11-12 15:20:13 -0500] gyre008: will have a look jtimberman
[2012-11-12 15:22:29 -0500] jtimberman: gyre008: there isn't a "solution" per se, other than "use this arcane set of ./configure flags to build libpq in the omnibus install directory
[2012-11-12 15:22:32 -0500] jtimberman: "
[2012-11-12 15:24:14 -0500] gyre008: I see..hehI think I saw this somewhere on Stackoverflowmmbetter than nothing :)
[2012-11-12 15:32:13 -0500] masterkorp: VROOOOWWWWMWWMMMMM
[2012-11-12 15:36:36 -0500] darthdeus: hey guys, how would i overwrite this default in a node's config? https://github.com/opscode-cookbooks/vim/blob/master/attributes/default.rb
[2012-11-12 15:38:31 -0500] masterkorp: darthdeus: knife node edit
[2012-11-12 15:39:12 -0500] darthdeus: i mean specifically how do i change the attribute? i tried "default_attributes": { "vim": { "extra_packages": ...     but it doesn't work
[2012-11-12 15:39:13 -0500] masterkorp: altouhg i dont recommend attributes override in the node
[2012-11-12 15:39:46 -0500] darthdeus: isn't it the same if i put it in role as in a node?
[2012-11-12 15:39:56 -0500] masterkorp: just because they're easy to forget they there
[2012-11-12 15:40:19 -0500] darthdeus: how should i do it then?
[2012-11-12 15:40:39 -0500] masterkorp: and months later you try to find wtf certain attribuite you changed in a role isn't behaving as expected
[2012-11-12 15:40:51 -0500] masterkorp: darthdeus: it depends, its only for that node ?
[2012-11-12 15:41:14 -0500] darthdeus: i only have one node and one cookbook and i'm trying to figure out how to set a value for that attribute :)
[2012-11-12 15:41:40 -0500] darthdeus: this doesn't work https://gist.github.com/4060049
[2012-11-12 15:43:00 -0500] masterkorp: use override_attributes
[2012-11-12 15:44:23 -0500] BryanWB_: hey Chefs, just blogged, "how to write reusable cookbooks, Gangnam Style" http://devopsanywhere.blogspot.it/2012/11/how-to-write-reusable-chef-cookbooks.html
[2012-11-12 15:44:32 -0500] gondoi: I don't wanna bump the ticket, but I'm gonna bump this issue here :D
[2012-11-12 15:44:32 -0500] gondoi: http://tickets.opscode.com/browse/CHEF-3525
[2012-11-12 15:44:38 -0500] darthdeus: masterkorp: still doesn't work
[2012-11-12 15:45:01 -0500] masterkorp: darthdeus: knife node show <your node>
[2012-11-12 15:45:11 -0500] masterkorp: paste the result here
[2012-11-12 15:45:41 -0500] darthdeus: i'm not using knife, i just run sudo chef-solo -c solo.rb -j node.json  in vagrant
[2012-11-12 15:46:23 -0500] masterkorp: darthdeus: you know that vagrant was his on chef configurations right ?
[2012-11-12 15:46:32 -0500] masterkorp: you can set chef-soplo there
[2012-11-12 15:47:18 -0500] darthdeus: masterkorp: yeah i read there is some support for chef, but i just wanted to make the simplest example work
[2012-11-12 15:49:57 -0500] masterkorp: well good luck then
[2012-11-12 15:50:22 -0500] darthdeus: ok i simplified it even more ... https://gist.github.com/4060106 this should fail that "ruby" isn't a valid package ... if i put it in the cookbook direclty it will fail
[2012-11-12 15:50:33 -0500] darthdeus: but hte override_attributes isn't overriding it for some reason
[2012-11-12 15:50:42 -0500] masterkorp: use vagrant provison
[2012-11-12 15:51:16 -0500] darthdeus: does that change how chef behaves? cuz i need this to run outside of vagrant
[2012-11-12 15:51:28 -0500] masterkorp: no
[2012-11-12 15:51:50 -0500] darthdeus: how will the provisioning help then?
[2012-11-12 15:52:14 -0500] masterkorp: excluding config mistakes
[2012-11-12 15:52:43 -0500] darthdeus: i have a one line config
[2012-11-12 15:53:54 -0500] darthdeus: no seriously :D i dont understand how provisioning or knife will help me with just one line hello world example which isn't working
[2012-11-12 16:00:56 -0500] darthdeus: solved by just doing it like this https://gist.github.com/4060166 without the override_attributes
[2012-11-12 16:02:56 -0500] Litex: BryanWB_: Holy crap, thanks for that blog post.  That's awesome.
[2012-11-12 16:03:15 -0500] BryanWB_: Litex: tks! check out Peter Donald's as weell
[2012-11-12 16:03:23 -0500] Litex: I am currently beating this drum heavily, and trying to rally folk behind me internally.
[2012-11-12 16:03:39 -0500] Litex: BryanWB_: Will do.
[2012-11-12 16:04:21 -0500] yfeldblum: Litex, you don't like my pattern, Big Hairy Ball of Mud?
[2012-11-12 16:04:48 -0500] Litex: yfeldblum: lolz
[2012-11-12 16:06:07 -0500] itchyouch: Hi does anyone have any insight on bootstrapping a node manually?  Looking into the "knife bootstrap host" process, it looks like it downloads install.sh from opscode and runs through the install
[2012-11-12 16:12:24 -0500] knuckolls: itchyouch: knife bootstrap is going to use a bootstrap template, which these days is likely going to be chef-full. that's the chef omnibus installer that should work just about anywhere.
[2012-11-12 16:12:34 -0500] knuckolls: and yes, it'll download and run an install.sh from opscode
[2012-11-12 16:13:10 -0500] itchyouch: I just saw the bootstrap proxy option that should help.
[2012-11-12 16:13:42 -0500] itchyouch: But, sudo is locked down such that I can't run "sudo bash"
[2012-11-12 16:13:44 -0500] knuckolls: itchyouch: here's the chef-full bootstrap template for your perusal
[2012-11-12 16:13:45 -0500] knuckolls: https://github.com/opscode/chef/blob/master/lib/chef/knife/bootstrap/chef-full.erb
[2012-11-12 16:14:02 -0500] knuckolls: the chef client needs to run with escalated priveleges
[2012-11-12 16:14:11 -0500] knuckolls: via whatever means you can get it to run that way
[2012-11-12 16:14:28 -0500] itchyouch: Yea, I'm looking for a workaround.
[2012-11-12 16:14:56 -0500] itchyouch: I'm thinking I just install chef manually and configure client.rb manually to start
[2012-11-12 16:15:30 -0500] knuckolls: yeah there's no reason you can't write your own bootstrap template that sets up the chef client via whatever mechanism you have available
[2012-11-12 16:15:38 -0500] itchyouch: My node does have chef-client installed via the rpms on frameos...  A slightly older chef, but recent enough
[2012-11-12 16:15:41 -0500] knuckolls: you can write a custom bootstrap template and reference it via path
[2012-11-12 16:16:07 -0500] itchyouch: Oh okay.  Thanks knuckolls.  That should be very useful
[2012-11-12 16:16:44 -0500] knuckolls: good luck
[2012-11-12 16:17:13 -0500] itchyouch: Btw, each node will have its own client, iirc?
[2012-11-12 16:21:36 -0500] mrprometheus: is there a way to list all hosted chef users from the cli?
[2012-11-12 16:24:28 -0500] mrprometheus: by all users I mean everyone in a given organization
[2012-11-12 16:24:45 -0500] emilsoman: every client that can connect to the chef server ?
[2012-11-12 16:25:21 -0500] mrprometheus: not client but user that can authenticate and do something
[2012-11-12 16:26:00 -0500] wassy121: as in, all the entries in /etc/shadow with passwords on all the boxes?  Even those not managed by chef?
[2012-11-12 16:26:28 -0500] mrprometheus: well in my case all users of hosted chef that can login to opscode site
[2012-11-12 16:26:53 -0500] emilsoman: I dont think there's a CLI way of doing that
[2012-11-12 16:27:00 -0500] wassy121: Sorry, not sure about hosted chef.  Have to defer
[2012-11-12 16:27:05 -0500] mrprometheus: if I was not using hosted chef it would be easier to parse things locally via /etc/shadow
[2012-11-12 16:27:11 -0500] mrprometheus: np
[2012-11-12 16:29:07 -0500] emilsoman: It's mentioned in the Application cookbook README , that the old way of storing configuration in data bags is deprecated . So what's the new way ?
[2012-11-12 16:31:28 -0500] yfeldblum: emilsoman, it's not deprecated; that particular way of doing it is deprecated, as are the particular recipes which know how to parse data-bags of that particular structure
[2012-11-12 16:32:55 -0500] emilsoman: From what I understand , application cookbook will not support reading the configurations from data bags , is that correct ?
[2012-11-12 16:33:19 -0500] gchristensen: yfeldblum: what was the structure, why was it deprecated?
[2012-11-12 16:34:35 -0500] yfeldblum: gchristensen, you're free to use the same structure; it's deprecated from the PoV of the application cookbook, but not necessarily from the user's PoV (the user can implement that structure himself)
[2012-11-12 16:34:41 -0500] yfeldblum: emilsoman, that is correct
[2012-11-12 16:34:44 -0500] gchristensen: ahh okay
[2012-11-12 16:34:55 -0500] BryanWB_: yfeldblum: btw, i have renamed my library chef-rewind as edit was confusing
[2012-11-12 16:35:02 -0500] BryanWB_: yfeldblum: tks for ur feedback
[2012-11-12 16:35:06 -0500] yfeldblum: BryanWB_, cool
[2012-11-12 16:35:20 -0500] BryanWB_: i don't create a new resource if one doesn't exist already but raise an error
[2012-11-12 16:35:33 -0500] yfeldblum: BryanWB_, in this partition between library and application cookbooks, is the application cookbook a library cookbook?
[2012-11-12 16:35:54 -0500] BryanWB_: yfeldblum: y, it is actually a library cookbook :)
[2012-11-12 16:36:09 -0500] BryanWB_: providing abstractions that a app cookbook could use
[2012-11-12 16:36:26 -0500] BryanWB_: at least according to my interpretation
[2012-11-12 16:37:36 -0500] emilsoman: yfeldblum, if application cookbook is not supporting reading the configurations from data bags, whats the correct way of doing the configuration ?
[2012-11-12 16:38:29 -0500] yfeldblum: emilsoman, it is now up to you; the point of the change was to make it up to you
[2012-11-12 16:40:45 -0500] emilsoman: yfeldblum: What are the other options ?
[2012-11-12 16:41:51 -0500] emilsoman: I found it a little confusing because the examples and the README still use the data bags way of configuration, if i'm not mistaken
[2012-11-12 16:42:00 -0500] sunil__: can I launch multiple instances in knife?  Say pass a template of instance type - role and have knife build those machines based on role definitions?  In another words, writing out the blue print of a stack and have a single command build it out..
[2012-11-12 16:42:29 -0500] yfeldblum: emilsoman, https://github.com/opscode-cookbooks/application#usage
[2012-11-12 16:48:45 -0500] j-v-e: Howdy Gentlemen
[2012-11-12 16:49:24 -0500] j-v-e: it appears that, while doing `return true` in a recipe used to exit the current recipe and continue the run_list, it now exits the entire chef-client run
[2012-11-12 16:49:47 -0500] j-v-e: So, I'm wondering, what is the correct way to exit a recipe and continue processing the run list ?
[2012-11-12 17:08:16 -0500] trobrock: Im trying to use knife bootstrap to bootstrap an instance running with vagrant and has passwordless sudo setup, but when I run it I am getting a prompt for a password and it seems this shouldnt happen.
[2012-11-12 17:10:43 -0500] spox: sounds like the passwordless sudo setup is not correct. you can always log into the instance and test the sudo setup directly
[2012-11-12 17:11:38 -0500] trobrock: spox:  nevermind, realized I was using the wrong ident file, looks like knife bootstrap doesnt read ~/.ssh/config for host settings
[2012-11-12 17:29:08 -0500] AntonZ: hello, can someone tell me if i use templates, can i simply put the content of the file inside the *.erb file or do i have to do it in ruby format?
[2012-11-12 17:29:34 -0500] AntonZ: i need to create bash_profile for oracle user, trying to figure out the best way to do it
[2012-11-12 17:30:47 -0500] kallistec: AntonZ: http://docs.opscode.com/essentials_cookbook_templates_variables.html
[2012-11-12 17:31:14 -0500] AntonZ: reading, thank you
[2012-11-12 17:31:44 -0500] kallistec: inside `<%= ruby_expression %>` you're using ruby, outside of that, it's static text
[2012-11-12 17:33:52 -0500] maplebed: speaking of template,s what's up with the @ before variables used in templates?
[2012-11-12 17:34:19 -0500] AntonZ: so if i have a bunch of "export" items i need to configure inside the bash profile, i would do something like this <%=%> export ORACLE_CONFIG_HOME=/product/10.2.0<%=%>
[2012-11-12 17:34:20 -0500] AntonZ: ?
[2012-11-12 17:35:22 -0500] kallistec: AntonZ: you only need to use the `<%= ... %>` stuff where you have dynamic data
[2012-11-12 17:36:13 -0500] AntonZ: how do i insert static text then? im looking at the doc referencem, and it describes actions for the most parts, i have static text that i need to inssert into .bash_profile
[2012-11-12 17:36:57 -0500] _rc: if it's static it just goes outside the <%= ... %> stuff altogether
[2012-11-12 17:37:05 -0500] kallistec: AntonZ: just put it in there
[2012-11-12 17:37:32 -0500] AntonZ: so i would simply stick the deisred content of the .bash_profile into *.erb file ?
[2012-11-12 17:37:52 -0500] kallistec: AntonZ: yeah
[2012-11-12 17:38:14 -0500] kallistec: if it's completely static you can use cookbook_file instead
[2012-11-12 17:38:49 -0500] AntonZ: thats simple, thats all what i needed, now next part is to properly declare the erb file from the recipe...  what is cookbook_file ? ill read about it if you have the link
[2012-11-12 17:38:57 -0500] kallistec: here's a less trivial template example: https://github.com/opscode-cookbooks/apache2/blob/master/templates/default/web_app.conf.erb
[2012-11-12 17:39:00 -0500] AntonZ: it's static for oracle user
[2012-11-12 17:39:24 -0500] kallistec: AntonZ: http://docs.opscode.com/resource.html on the new docs site
[2012-11-12 17:39:42 -0500] kallistec: http://wiki.opscode.com/display/chef/Resources is the old one
[2012-11-12 17:40:12 -0500] AntonZ: thank you!
[2012-11-12 17:40:29 -0500] kallistec: we're in the midst of switching from the wiki to the new docs stuff, so for the moment you might need to look in both places for some bits of info
[2012-11-12 17:41:01 -0500] anentropic: does anyone have any insight into this ticket http://tickets.opscode.com/browse/CHEF-3170?
[2012-11-12 17:41:11 -0500] anentropic: I seem to have run into the same issue
[2012-11-12 17:42:27 -0500] anentropic: I am following steps start a new EC2 instance that worked three weeks ago before I went on holiday and now there are errors
[2012-11-12 17:42:30 -0500] maxmanders: Am I correct that 'service "blah" do... action :nothing... notifies :start, "service[blah]", :delayed...end' should cause a service named blah to only start at the end of the chef run?
[2012-11-12 17:44:11 -0500] AntonZ: kalllistec, can you please have a look at this gist: https://gist.github.com/4060777 - i just want to make sure that such statemnt will trigger my template and insiert the content of the .erb file into the right location
[2012-11-12 17:45:47 -0500] AntonZ: or i think im missing action item
[2012-11-12 17:46:37 -0500] maplebed: AntonZ: doesn't look like anything's missing to me, but with mode 0440 and ownership root:root, the oracle user won't be able to read it.
[2012-11-12 17:46:45 -0500] AntonZ: ah nevermind, look like example says i should be all set with what i have..
[2012-11-12 17:46:55 -0500] AntonZ: ah duh! good catch, thnk you maplebed
[2012-11-12 17:47:32 -0500] maplebed: :)
[2012-11-12 18:01:00 -0500] matschaffer: So is there a way to get knife's detection of chef.rb in a custom script? I tried Chef::Knife.new.configure_chef but it seems to end up setting log_level to debug since verbosity isn't set.
[2012-11-12 18:17:03 -0500] anentropic: since today I can't create new EC2 instances
[2012-11-12 18:17:03 -0500] anentropic: DEBUG: Found bootstrap template in /var/lib/gems/1.9.1/gems/chef-10.14.2/lib/chef/knife/bootstrap
[2012-11-12 18:17:03 -0500] anentropic: ERROR: TypeError: can't convert false into String
[2012-11-12 18:17:34 -0500] anentropic: I guess a line number on the error message would be too much to ask]
[2012-11-12 18:29:20 -0500] heidi644: Is there a way to access current environment inside of a role?  I currently get  undefined local variable or method `node' when trying to access node.chef_environment inside of a role
[2012-11-12 18:29:24 -0500] AntonZ: so if maplebed or kallistec are still here- i ran my cookbook, the template i added simply got ignored and didnt run, i have other template stament in the same cookbook and it ran fine
[2012-11-12 18:29:59 -0500] willejs: hi, i want to set an attribute in a recipe, how do i set a hash against a value?
[2012-11-12 18:30:34 -0500] emackn1: with apache vhost setup, when specifying the role in json, can i just set the template values with default_attributes ?
[2012-11-12 18:30:45 -0500] emackn1: i think im missing a step actually
[2012-11-12 18:31:03 -0500] red5|ryan: willejs: with an = :)
[2012-11-12 18:31:07 -0500] maplebed: AntonZ: nothing in the chef output?
[2012-11-12 18:31:10 -0500] yfeldblum: heidi644, no there isn't, since the role is actually purely-static data and is not code
[2012-11-12 18:31:30 -0500] yfeldblum: heidi644, even though there is a ruby DSL for writing roles, it's just a thin veneer over purely static data
[2012-11-12 18:31:46 -0500] AntonZ: here is part of the run of that cookbook: https://gist.github.com/4060777
[2012-11-12 18:32:04 -0500] AntonZ: so it executes my first template statement, and then moves on to the nnext cookbook in the run
[2012-11-12 18:32:38 -0500] heidi644: yfeldblum: ahhh. that makes complete sense, good explanation thx!
[2012-11-12 18:32:41 -0500] AntonZ: for whatever reason i do not even see it touches second tempalte statement
[2012-11-12 18:32:42 -0500] red5|ryan: a dsl for writing roles https://github.com/reset/ridley :)
[2012-11-12 18:34:20 -0500] AntonZ: i dont have anything under attributes though.. not sure if something is required to be in the attributes for template to be noticed
[2012-11-12 18:40:13 -0500] maplebed: AntonZ: probably a silly question, but did you upload your changed cookbook to the chef server?
[2012-11-12 18:42:08 -0500] AntonZ: i think i did lol, that would be funny if i didnt.. checking git status too if if i added new file to be tracked lol
[2012-11-12 18:42:42 -0500] maplebed: honestly, I think that's my most common failure when mucking with chef cookbooks...
[2012-11-12 18:42:51 -0500] AntonZ: thats it.. i didnt add the file ic reated to be tracked by git,and thus i didnt get uploaded to chef server...
[2012-11-12 18:43:08 -0500] AntonZ: re-running :)
[2012-11-12 18:43:15 -0500] emackn1: can anyone help me out with an apache vhost setup?
[2012-11-12 18:45:37 -0500] emackn1: apache is setup,but im at a loss when trying to configure the vhost
[2012-11-12 18:46:08 -0500] AntonZ: someon jsut pasted this link to me today, to use as an example for template, check it out: https://github.com/opscode-cookbooks/apache2/blob/master/templates/default/web_app.conf.erb
[2012-11-12 18:46:21 -0500] AntonZ: it talks about configuring vhost
[2012-11-12 18:46:35 -0500] emackn1: right.. i was looking at that
[2012-11-12 18:47:02 -0500] emackn1: do i call something to get that template to print out?
[2012-11-12 18:47:07 -0500] heidi644: can anyone send me in the right direction for hints on using chef environments in chef-solo.  We are currently using chef-solo for testing locally with Vagrant
[2012-11-12 18:47:10 -0500] emackn1: thats the part im missing
[2012-11-12 18:47:34 -0500] maplebed: emackn1: I was impressed by the way the nagios cookbook deals with virtualhosts: https://github.com/opscode-cookbooks/nagios/blob/master/recipes/apache.rb
[2012-11-12 18:47:39 -0500] miah: whats going on with COOK-1857?
[2012-11-12 18:48:42 -0500] maplebed: heidi644: http://wiki.opscode.com/display/chef/Chef+Solo says "Che Solo does not provide... Environments"  Is there something special that vagrant does that lets you use envs?
[2012-11-12 18:50:05 -0500] miah: you can only use environments for chef in vagrant if you are using a chef server
[2012-11-12 18:50:07 -0500] miah: http://vagrantup.com/v1/docs/provisioners/chef_server.html
[2012-11-12 18:50:17 -0500] miah: aka. not chef-solo.
[2012-11-12 18:52:12 -0500] dougireton: We would love to use environments in Chef-Solo
[2012-11-12 18:52:30 -0500] dougireton: since we use environments in Chef-Server
[2012-11-12 18:53:23 -0500] miah: then don't use chef-solo.
[2012-11-12 18:53:53 -0500] emackn1: maplebed: ok.. i think i see what i need with the template file, whats the trick to getting that working with vagrant?
[2012-11-12 18:54:11 -0500] maplebed: I've never used vagrant, sorry.
[2012-11-12 18:55:04 -0500] gchristensen: emackn1: when using Vagrant, I don't actually tell Vagrant about chef - I bootstrap myself in another command so I can more easily customize it.
[2012-11-12 18:55:42 -0500] heidi644: miah, mapledbed: yeah I realize that, but I saw some reference to a patch that would allow chef environments in chef-solo.  We could switch to chef-client on vagrant, but that means *I believe* we would have to push all cookbook changes up to chef-server for local testing.
[2012-11-12 18:56:07 -0500] emackn1: gchristensen: so you dont use the config.vm.provision :chef_solo block?
[2012-11-12 18:57:03 -0500] miah: heidi644: well, you would have to push them to _a_ chef server. it doesn't have to be _the_ chef server.
[2012-11-12 18:57:04 -0500] dougireton: We've worked around Chef-Solo not working with envs by duplicating the node attributes from the environment.rb into json properties passed to Vagrant
[2012-11-12 18:57:06 -0500] emackn1: or is this what roles are for (im new to chef)
[2012-11-12 18:57:06 -0500] gchristensen: emackn1: no, my Vagrantfile is: https://gist.github.com/7109dcfaf6cbdd53a448 and then I have an up.sh and a destroy.sh to encapsulate the bootstrap destroy process
[2012-11-12 18:58:31 -0500] gchristensen: emackn1: https://gist.github.com/7109dcfaf6cbdd53a448 now contains each of those scripts
[2012-11-12 18:59:01 -0500] heidi644: miah: yeah, I assumed that might be the defacto answer (multiple chef servers), but was hoping to avoid that
[2012-11-12 18:59:32 -0500] miah: your chef server can be a vagrant instance..
[2012-11-12 18:59:44 -0500] gchristensen: miah: I have one chef server, and one organization per developer, and then another for production, that seems to take care of it for us
[2012-11-12 18:59:57 -0500] miah: gchristensen: ya that would work
[2012-11-12 19:00:13 -0500] miah: workflow is for you to decide
[2012-11-12 19:03:09 -0500] poolpog: howdy
[2012-11-12 19:03:26 -0500] poolpog: I'm not sure this questions is going to come out right, but here goes anyway...
[2012-11-12 19:03:28 -0500] emackn1: gchristensen: so your web setup in in your web role?
[2012-11-12 19:03:41 -0500] emackn1: vhost setup i mean
[2012-11-12 19:04:00 -0500] poolpog: how do I get a single attribute of a node, in order to inspect it and make decisions on it? e.g.
[2012-11-12 19:04:28 -0500] maplebed: poolpog: node.attribute == 'foo'
[2012-11-12 19:04:29 -0500] poolpog: I want to change the source file based on whether the node's hostname is one of these three hostnames [a,b,c]
[2012-11-12 19:04:58 -0500] poolpog: maplebed, how do I get the *value* of the attribute, not...
[2012-11-12 19:04:59 -0500] poolpog: hm
[2012-11-12 19:05:07 -0500] poolpog: so, "node.hostname" is a thing?
[2012-11-12 19:05:09 -0500] maplebed: btw, I highly recommend firing up shef (probably with -z) to explore what's available from within a recipe.
[2012-11-12 19:05:10 -0500] poolpog: e.g.
[2012-11-12 19:05:29 -0500] poolpog: ig node.hostname == "a.example.com" ...
[2012-11-12 19:06:29 -0500] maplebed: yup.
[2012-11-12 19:06:44 -0500] poolpog: I've been messing with shef, actually
[2012-11-12 19:06:47 -0500] maplebed: (though in my case, node.hostname gives the short name, not the fqdn.)
[2012-11-12 19:07:14 -0500] poolpog: but I'm hitting problems when I bump up against the extreme edge of my Ruby knowledge
[2012-11-12 19:07:28 -0500] poolpog: which is, unfortunately, the opposite of vast
[2012-11-12 19:07:31 -0500] maplebed: so on a chef client host, run 'sudo shef -z', then type 'puts node.hostname' or just 'node.hostname'
[2012-11-12 19:07:36 -0500] maplebed: both will print out the value of the variable.
[2012-11-12 19:07:57 -0500] poolpog: ok
[2012-11-12 19:08:03 -0500] poolpog: #helpful
[2012-11-12 19:08:05 -0500] maplebed: tab completion works there too
[2012-11-12 19:08:08 -0500] maplebed: which is a godsend.
[2012-11-12 19:08:09 -0500] poolpog: thanks
[2012-11-12 19:08:24 -0500] poolpog: yeah, I found my vi-style CLI editing actually works
[2012-11-12 19:08:35 -0500] poolpog: ESC-k anyone?
[2012-11-12 19:13:49 -0500] itchyouch: I have about several hundred scripts to roll out in various combinations.  Debating between utilizing fpm and building clashes and using chef to install the packages, or to have a recipe that does the deployments itself
[2012-11-12 19:13:57 -0500] itchyouch: Usually these things don't change often at all...
[2012-11-12 19:14:13 -0500] itchyouch: Building packages.
[2012-11-12 19:14:33 -0500] itchyouch: Err, or have a recipe that does the deployments themself from pulling from git
[2012-11-12 19:22:18 -0500] heidi644: miah, maplebed: here is the pull request I had referenced earlier on adding environments to chef-solo
[2012-11-12 19:22:20 -0500] heidi644: https://github.com/opscode/chef/pull/359
[2012-11-12 19:26:03 -0500] maplebed: huh.  neat.  well, hope it gets merged!  :)
[2012-11-12 19:32:01 -0500] rob___: someone please help me with the nginx cookbook. How the hell can I change the version from within a role? I tried override_attributes(:nginx => { :version => "1.2.4"}) but that doesn't do crap
[2012-11-12 19:32:15 -0500] rob___: it doesn't seem to be respected in the source.rb file
[2012-11-12 19:32:41 -0500] rob___: although if I print out node['nginx']['version'] elsewhere, it is correct
[2012-11-12 19:33:02 -0500] matti: ;]
[2012-11-12 19:33:17 -0500] rob___: could it be when one file includes another via the include_attribute directive, all overridden attributes are lost?
[2012-11-12 19:33:45 -0500] rob___: possible bug?
[2012-11-12 19:37:11 -0500] red5|ryan: does your role come before the nginx cookbook in the run list?
[2012-11-12 19:42:07 -0500] darthdeus: why am i getting "No version specified, and no candidate version available for mognodb" for  package "mognodb" on ubuntu 10.04 when if i do apt-get install mongodb it does install it?
[2012-11-12 19:42:42 -0500] gkarekinian: Typo?
[2012-11-12 19:43:03 -0500] miah: mognodb
[2012-11-12 19:43:05 -0500] wassy121: mogno != mongo
[2012-11-12 19:43:05 -0500] darthdeus: :D
[2012-11-12 19:43:17 -0500] darthdeus: i'm so blind
[2012-11-12 19:43:20 -0500] miah: though. i think i would use a db called 'mognob'
[2012-11-12 19:43:23 -0500] miah: awesome name.
[2012-11-12 19:43:52 -0500] matschaffer: http://icons.duckduckgo.com/i/826610e6.jpg
[2012-11-12 19:44:12 -0500] matschaffer: not sure if I want a mognob now that I think about it
[2012-11-12 19:44:38 -0500] gkarekinian: This chan is free Amazon Mechanical Turk for mistyped code
[2012-11-12 19:44:39 -0500] wassy121: I can't get the moogle phallus out of my mind
[2012-11-12 19:44:43 -0500] miah: lol.
[2012-11-12 19:45:19 -0500] matschaffer: wassy121: yeah. sorry about that
[2012-11-12 19:45:43 -0500] matschaffer: if it's any condolence I'm also a victim of my own making
[2012-11-12 19:52:09 -0500] digitallogic: hi, I'm looking to find a way to do the ohai data collection of a chef-client run
[2012-11-12 19:52:13 -0500] digitallogic: and a post back to the chef server
[2012-11-12 19:52:20 -0500] digitallogic: w/o doing a full chef-client run
[2012-11-12 19:53:19 -0500] jhayden: question about modes on cookbook_files:
[2012-11-12 19:53:25 -0500] yfeldblum: digitallogic, why?
[2012-11-12 19:53:52 -0500] jhayden: I am trying to set the mode to either "0644" or "755" but they are getting set to 600
[2012-11-12 19:54:10 -0500] JeanMertz: Is it possible to set defaults for chef resources? For example, I want all the cookbooks I use to use a default `gem_binary` whenever I run `gem_package` without having to set it each time?
[2012-11-12 19:54:16 -0500] jhayden: has anyone ever seen this before?
[2012-11-12 19:54:19 -0500] digitallogic: yfeldblum: certain recipes are keying off the attributes
[2012-11-12 19:54:46 -0500] JeanMertz: (unless the attribute is overwritten by the resource call itself ofcourse)
[2012-11-12 19:54:48 -0500] digitallogic: in this case it's a virt server
[2012-11-12 19:55:13 -0500] digitallogic: so when we delete or add a guest, the attributes are out of date for a short while
[2012-11-12 19:56:36 -0500] yfeldblum: digitallogic, why not just run chef-client?
[2012-11-12 19:57:08 -0500] digitallogic: yfeldblum: that's being debated as well
[2012-11-12 19:57:20 -0500] digitallogic: I'm looking into the possibility of a lighter weight solution
[2012-11-12 19:57:29 -0500] yfeldblum: digitallogic, if you do it right, the chef-client run should turn out to be one giant set of no-ops
[2012-11-12 19:58:09 -0500] gswallow: heya, have a quick question about cookbook files; maybe the remote file vendor thing?
[2012-11-12 19:58:51 -0500] jhayden: Ooops, my issue is a 10.16 bug but I don't quite yet know how to fix it
[2012-11-12 19:58:53 -0500] PRK_nz: Hi, I'm trying to use data_bag_item in a library in a cookbook, but even if I require chef, it still fails as an undefined method. What am I missing to make this work?
[2012-11-12 19:59:13 -0500] gswallow: http://pastebin.com/8UgEAbS3
[2012-11-12 19:59:46 -0500] gswallow: if Chef knows what files exist in a cookbook, then how do I access that from within a recipe?  I'm not getting it.
[2012-11-12 20:00:43 -0500] digitallogic: yfeldblum: the oposition to running chef-client is that it could result in very long completion times if there's update resources
[2012-11-12 20:01:00 -0500] digitallogic: ie - we want it to be a guarentued no-op
[2012-11-12 20:03:05 -0500] jhayden: found it!
[2012-11-12 20:03:10 -0500] alop: gswallow: if you have files in the files/default directory, you can call them with "cookbook_file
[2012-11-12 20:03:16 -0500] alop: gswallow: http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-11-12 20:03:31 -0500] jhayden: my code was running on 10.16.0 and 10.16.2 has the fix
[2012-11-12 20:03:35 -0500] gswallow: I think I found it.  c = Chef::CookbookVersion.load("name")
[2012-11-12 20:03:37 -0500] jhayden: oh well ;-)
[2012-11-12 20:07:31 -0500] rava: with the new omnibus installation method, is there any point to keeping around opscode repos?
[2012-11-12 20:07:49 -0500] rava: for apt specifically
[2012-11-12 20:08:12 -0500] rava: or are you updating the packages to distribute the omnibus install?
[2012-11-12 20:11:29 -0500] jtimberman: rava: yeah because people like those :)
[2012-11-12 20:11:37 -0500] jtimberman: rava: so the apt repo is being maintained too
[2012-11-12 20:11:56 -0500] andreaturli: Hi jtimberman I'm trying to use your https://github.com/opscode-cookbooks/postgresql in solo mode
[2012-11-12 20:12:03 -0500] rava: jtimberman: groovy, hopefully it will hand removing the chef packages installed via apt
[2012-11-12 20:12:21 -0500] andreaturli: but I'm not able to provide the password attribute
[2012-11-12 20:12:29 -0500] andreaturli: where shall I put it and how? thanks
[2012-11-12 20:12:38 -0500] jtimberman: andreaturli: put it in a json file that you pass to chef-solo with -j
[2012-11-12 20:12:54 -0500] jtimberman: rava: the omnibus package doesn't do that, i don't believe.
[2012-11-12 20:13:18 -0500] rava: jtimberman: right, i'm thinking the .deb using pre-install scripts or something
[2012-11-12 20:13:31 -0500] andreaturli: i'm using this json file at the moment https://github.com/andreaturli/chef-solo-hello-world/blob/master/node.json
[2012-11-12 20:13:43 -0500] andreaturli: how should be edit to add the property required
[2012-11-12 20:13:44 -0500] andreaturli: ?
[2012-11-12 20:13:45 -0500] rava: jtimberman: should be able to flag previous apt packages as conflicting and good to remove
[2012-11-12 20:16:04 -0500] rava: maybe a silly question, but does the chef_gem provider work outside of an omnibus install?
[2012-11-12 20:16:54 -0500] PRK_nz: https://gist.github.com/4061601
[2012-11-12 20:18:02 -0500] PRK_nz: re my question about using data_bag_items in libraries
[2012-11-12 20:18:21 -0500] rob___: I don't think the nginx recipe works correctly when changing the version
[2012-11-12 20:18:56 -0500] rob___: Its not picking up the version
[2012-11-12 20:19:18 -0500] rob___: I think it has to do with include_attribute
[2012-11-12 20:19:48 -0500] willejs: can i set role attributes from a cookbook?
[2012-11-12 20:19:56 -0500] jtimberman: andreaturli: https://gist.github.com/cbc7b12b426058dfb314
[2012-11-12 20:19:56 -0500] willejs: *recipe
[2012-11-12 20:19:59 -0500] jtimberman: something like that
[2012-11-12 20:20:17 -0500] jtimberman: rava: i don't know if there are plans to add anything like that to the omnibus packaging.
[2012-11-12 20:20:27 -0500] rava: jtimberman: thanks
[2012-11-12 20:20:50 -0500] jtimberman: you could open a ticket and discuss on the mailing list though.
[2012-11-12 20:21:06 -0500] red5|ryan: PRK_nz: you might need to require something more specific like... 'chef/data_bag'
[2012-11-12 20:21:41 -0500] jtimberman: PRK_nz: data_bag_item is a method for the recipe DSL, its not available in libraries (they're not recipes0
[2012-11-12 20:21:45 -0500] andreaturli: jtimberman: thanks but it still fails
[2012-11-12 20:22:00 -0500] andreaturli: jtimberman: https://gist.github.com/cbc7b12b426058dfb314#comments
[2012-11-12 20:22:24 -0500] rava: i've built my own bootstrapper using python's fabric, i'll just go about handling all that in there
[2012-11-12 20:22:52 -0500] PRK_nz: jtimberman: hmmmm, so there's no way to do this?
[2012-11-12 20:23:12 -0500] willejs: rava: have you got the source for that anywhere? id be interested in checking it out
[2012-11-12 20:24:14 -0500] rob___: anyone?
[2012-11-12 20:25:38 -0500] bemu: rava: We use fabric & omnibus, but we're a python shop, so we have no need for chef_gem. Out curiosity, what does that provider do for you that gem_package does not?
[2012-11-12 20:25:52 -0500] rava: bemu: knife plugins
[2012-11-12 20:26:19 -0500] jtimberman: PRK_nz: you have to use the class method directly. Chef::DataBag::Item.load
[2012-11-12 20:26:31 -0500] rava: bemu: it's note what it does for me, it's just to keep me from having to rewrite recipes using gem_package to use chef_gem, since the only gems i'm installing is for chef's usage.
[2012-11-12 20:26:42 -0500] bemu: willejs: What kind of source are you looking for? We use fabric + pychef to drive almost everything we do.
[2012-11-12 20:26:50 -0500] rava: ugh, gotta remove auto correct in my emacs when on erc
[2012-11-12 20:27:31 -0500] rava: willejs: it's a pretty ugly version of the knife bootstrap ubuntu template. right now it's got some work that's specific to my environment, and i now need to rework it to use omnibus. if i get it abstract enough this week i'll stick it up in on my github
[2012-11-12 20:27:37 -0500] jtimberman: PRK_nz: i'd have the library you're writing take an argument of the data from the data bag item, do the processing on that and return the value you want to use in the recipe.
[2012-11-12 20:27:50 -0500] jtimberman: PRK_nz: that gives you the benefit of not being coupled to data bags specifically
[2012-11-12 20:27:58 -0500] bemu: rava: I guess I'm confused. gem_package w/o omnibus should work fine. chef_gem w/ omnibus should work fine, possibly with some PATH changes?
[2012-11-12 20:28:23 -0500] maplebed: Anybody know where I can find a changelog for chef itself?  I need to upgrade from 0.10.8 to the current stable (10.16.2 according to http://wiki.opscode.com/display/chef/Upgrading+Chef+0.10.x+to+the+newest+version+of+Chef) and I want to know if any of the changes will affect me.
[2012-11-12 20:28:23 -0500] jtimberman: andreaturli: you need opscode's openssl cookbook
[2012-11-12 20:28:38 -0500] PRK_nz: jtimberman: yea, I was hoping to avoid that, thanks though.
[2012-11-12 20:28:41 -0500] willejs: rava: just curious. il keep an eye out for it
[2012-11-12 20:28:51 -0500] jtimberman: maplebed: http://wiki.opscode.com/display/chef/Release+Notes
[2012-11-12 20:28:51 -0500] andreaturli: jtimberman: ok I'll try to add it
[2012-11-12 20:29:00 -0500] maplebed: jtimberman: thanks.
[2012-11-12 20:29:16 -0500] rava: bemu: it's because i want to limit the amount of misc ruby in my env. we don't use it for anything not chef. gem_package would install it in a general, systemwide sense. using chef_gem installs it only for the omnibus runtime environment, or at least that's what i gathered from the docs
[2012-11-12 20:29:22 -0500] rava: bemu: it's just cleaner
[2012-11-12 20:29:32 -0500] maplebed: oh damn, that's a lot of changes.  ::sigh::
[2012-11-12 20:30:16 -0500] bemu: rava: Ohhhh, I understand now.
[2012-11-12 20:30:31 -0500] jtimberman: maplebed: they're good changes, and you probably want them :)
[2012-11-12 20:30:40 -0500] bemu: afaik, the only thing preventing you from using chef_gem installed packages is PATH.
[2012-11-12 20:30:46 -0500] JeanMertz: Is it possible to set defaults for chef resources? For example, I want all the cookbooks I use to use a default `gem_binary` whenever I run `gem_package` without having to set it each time?
[2012-11-12 20:30:47 -0500] maplebed: Are opscode cookbooks supposed to work against any 0.10. release?  I've discovered the bluepill cookbook breaks on chef-client <0.10.10, which is annoying.
[2012-11-12 20:30:59 -0500] andreaturli: jtimberman: great! it works :)
[2012-11-12 20:31:00 -0500] maplebed: jtimberman: I'm sure I do, but I expect some of my cookbooks will break.
[2012-11-12 20:31:18 -0500] rava: bemu: right, but i'm a stickler for not doing anything i don't have to if it's going to be done later anyway
[2012-11-12 20:31:23 -0500] jtimberman: rava: chef_gem installs gems into the Ruby environment that Chef is running under. That is omnibus if you installed that way, or under the system ruby if you used the apt repository we publish, or whatever ruby you used with installing chef as a gem.
[2012-11-12 20:31:48 -0500] jtimberman: maplebed: i don't think there are backward incompatible changes in the recipes.
[2012-11-12 20:32:01 -0500] jtimberman: thats not to say it wouldn't break anything, since i dont' know how your cookbooks were written
[2012-11-12 20:32:24 -0500] jtimberman: maplebed: if you're not already using vagrant, now's probably a good time to give it a go :)
[2012-11-12 20:32:29 -0500] rava: jtimberman: that's what i needed to know :) . in that case i can use it as is, and when i remove the system wide ruby environment and have omnibus installed, the recipe should just converge without a problem taking care of the installs that were missed?
[2012-11-12 20:32:29 -0500] maplebed: well, starting to read the release notes, the first thing I need to check "The default bootstrap template for knife has changed in this release. If you havent been specifying a template with the -d flag, youve been using the ubuntu10.04-gems template. As of this release you will need to specify this template with -d ubuntu10.04-gems because the new default is the chef-full template."
[2012-11-12 20:33:01 -0500] maplebed: it's things like that .  I don't know if it'll break, but I want to find out before doing something I'll need to back out...
[2012-11-12 20:33:22 -0500] jtimberman: i gotta run tho
[2012-11-12 20:33:30 -0500] gswallow: how far?
[2012-11-12 20:33:34 -0500] rava: bemu: do you use anything but knife to manage the cookbooks and nodes? or is pychef a read only runtime for your scripts?
[2012-11-12 20:33:40 -0500] jtimberman: to the living room to play castle crashers with my son :)
[2012-11-12 20:33:50 -0500] gswallow: ah.  I'm about to pop out for 8 miles :)
[2012-11-12 20:34:02 -0500] rava: jtimberman: nice
[2012-11-12 20:34:24 -0500] bemu: We use knife and knife-spork a bit. pychef is not read-only, as we use it to write node attributes during deploy, and many many other things.
[2012-11-12 20:36:20 -0500] rava: bemu: i'd be really curious to see how you've embedded pychef into your workflow. i've just finished configuring spork with foodcritic rules and the like. when i'm done defining the rest of our site cookbooks i'll need to do a serious dig into pychef
[2012-11-12 20:36:58 -0500] bemu: Happy to help, I'll work on an overview as soon as I can.
[2012-11-12 20:37:15 -0500] bemu: One of the primary ways is to drive our deploys.
[2012-11-12 20:37:40 -0500] bemu: fab deploy_code --set environment=production,role=some_role,hash=SHA,start=0,stop=100
[2012-11-12 20:37:41 -0500] bemu: for instance.
[2012-11-12 20:38:07 -0500] bemu: Will do a search query using pychef, update node attributes with SHA, checkout code, restart tornadoes, etc etc.
[2012-11-12 20:38:28 -0500] rava: nice
[2012-11-12 20:38:35 -0500] rshade98: anyone know how I can add a MASQUERADE rule using the iptables cookbook
[2012-11-12 20:38:53 -0500] rshade98: seems to be getting wiped out, and only *filter is loaded
[2012-11-12 20:39:14 -0500] bemu: I can work on getting that stuff open sourced if that would help.
[2012-11-12 20:39:52 -0500] bemu: But, frankly, we've hacked together a bunch and not put a lot of effort into cleaning/iterating; you could probably write better yourself.
[2012-11-12 20:39:58 -0500] rob___: wtf is ohai and why is it used with nginx?
[2012-11-12 20:40:34 -0500] JeanMertz: Third time's a charm they say :) jtimberman is there a way to define resource defaults that apply to all cookbooks? f.e. set a default `gem_binary` for the `gem_package` resource, or default `user` for `execute`?
[2012-11-12 20:40:35 -0500] rava: bemu: that idea of storing the commit SHA is fricking awesome
[2012-11-12 20:40:49 -0500] rava: bemu: i will definately be thieving it
[2012-11-12 20:40:54 -0500] miah: rob___: http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-11-12 20:41:22 -0500] bemu: It helps a lot, primarily because it allows us to check that SHA against each application node running on a server to verify that we're consistent across the cluster.
[2012-11-12 20:41:31 -0500] JeanMertz: "to the living room to play castle crashers with my son :)" crap, his son wins, I lose. Anyone else know the answer to my question?
[2012-11-12 20:41:49 -0500] rob___: where are those ohai attributes set though?
[2012-11-12 20:42:02 -0500] rob___: somewhere its setting nginx[version] that I can't figure out how to change
[2012-11-12 20:43:43 -0500] miah: is nginx already installed?
[2012-11-12 20:45:10 -0500] rob___: it was
[2012-11-12 20:45:42 -0500] rob___: I tried changing the version after and its not being picked up even if I use override_attributes
[2012-11-12 20:45:50 -0500] rob___: very odd.. not sure where it got that value from
[2012-11-12 20:46:54 -0500] rob___: I'm convinces this shit is busted
[2012-11-12 21:05:17 -0500] rob___: can anyone help?
[2012-11-12 21:08:21 -0500] miah: i would help, but i need to help myself first
[2012-11-12 21:09:10 -0500] rob___: thanks
[2012-11-12 21:09:19 -0500] rob___: is this a known bug or something?
[2012-11-12 21:10:07 -0500] rob___: ill use a different version of nginx but I want to understand why this isn't working
[2012-11-12 21:10:09 -0500] rob___: doesn't really make sense
[2012-11-12 21:10:14 -0500] bemu: "I can not save you. I can't even save myself. " Way to bring back some old lyrics, Miah. :)
[2012-11-12 21:11:07 -0500] ssd7: Ohai Chefs
[2012-11-12 21:14:35 -0500] ssd7: rob___: Reading the backscroll, I'm not clear on what your end goal is.  Looks like you are using the nginx cookbook and are trying to use a different version?
[2012-11-12 21:14:44 -0500] rob___: yes
[2012-11-12 21:15:28 -0500] rob___: should be a simple as override_attributes(:nginx => { :version => "1.2.4" })
[2012-11-12 21:15:39 -0500] rob___: but that value is not being set its always defaulting to 1.2.3
[2012-11-12 21:16:04 -0500] rob___: fyi.. i am using the override_attributes in my role
[2012-11-12 21:17:45 -0500] ssd7: rob___: Are you installing using the source recipe?
[2012-11-12 21:17:58 -0500] rob___: yes
[2012-11-12 21:18:00 -0500] rob___: nginx::source
[2012-11-12 21:18:41 -0500] miah: all i wanted was a pepsi, just one pepsi AND SHE WOULDNT GIVE IT TO ME
[2012-11-12 21:20:28 -0500] rob___: can someone just please try and verify this is a bug?
[2012-11-12 21:20:38 -0500] ssd7: rob___: Looking now
[2012-11-12 21:20:45 -0500] rob___: thank you
[2012-11-12 21:25:15 -0500] josephholsten: anyone got a good reason ohai shouldn't provide a root_group value so lines like this can die? https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/service.rb#L25
[2012-11-12 21:25:58 -0500] miah: josephholsten: no good reasons. please implement and submit upstream.
[2012-11-12 21:26:02 -0500] miah: its a pattern i'd like to see die
[2012-11-12 21:26:03 -0500] josephholsten: yay!
[2012-11-12 21:26:21 -0500] ssd7: rob___: Well, I haven't tried it yet, but on its face, I'm not seeing how this recipe would actually work for upgrades.
[2012-11-12 21:27:00 -0500] rob___: how so?
[2012-11-12 21:27:10 -0500] rob___: https://github.com/opscode-cookbooks/nginx
[2012-11-12 21:27:16 -0500] rob___: why even have: node['nginx']['version'] - version of nginx
[2012-11-12 21:27:17 -0500] miah: i dont think many cookbooks implement version locking or upgrading correctly
[2012-11-12 21:27:35 -0500] rob___: so when playing around I could have installed something else?
[2012-11-12 21:27:43 -0500] rob___: how can I blow away those changes?
[2012-11-12 21:27:45 -0500] ssd7: rob___: So, the issue is that the automatic attribute set by the nginx plugin is going to take the highest precendence
[2012-11-12 21:27:58 -0500] rob___: ok.. now where is that?
[2012-11-12 21:28:09 -0500] rob___: i searched but couldn't find automatic
[2012-11-12 21:28:18 -0500] ssd7: rob___: Right, so it is likely you already have nginx installed, or at least installed enough for the ohai plugin to find it.
[2012-11-12 21:28:24 -0500] miah: automatic attributes are those provided by ohai
[2012-11-12 21:28:32 -0500] miah: and some defaults in chef
[2012-11-12 21:28:33 -0500] rob___: ok.. how can I change those and/or inspect it
[2012-11-12 21:28:42 -0500] miah: http://wiki.opscode.com/display/chef/Automatic+Attributes
[2012-11-12 21:29:07 -0500] miah: rob___: depending on your os, rpm -e nginx
[2012-11-12 21:29:19 -0500] rob___: i removed the package
[2012-11-12 21:29:41 -0500] miah: then when you run ohai it shouldn't find anything related to nginx, or if it does there must be another 'rogue' install
[2012-11-12 21:30:38 -0500] ssd7: rob___: Do you have an /opt/nginx-VERSIONNUMBER type directory?
[2012-11-12 21:31:07 -0500] rob___: I did
[2012-11-12 21:31:13 -0500] rob___: I deleted it then tried again
[2012-11-12 21:31:51 -0500] rob___: yea i don't see anything related to that version of nginx in ohai output
[2012-11-12 21:33:24 -0500] rob___: gross that you can't override those values
[2012-11-12 21:33:51 -0500] ssd7: rob___: Correct, you can't override ohai output.  The idea is that ohai outputis about the current state of the system, not desired state.
[2012-11-12 21:34:29 -0500] rob___: anyway I can wipe it all out
[2012-11-12 21:35:01 -0500] ssd7: While I'm not sure you are hitting it here, there seems to be a bug where the cookbook and ohai plugin are using the same namespace for attributes, which is going to make changing versions difficult once it is installed.
[2012-11-12 21:35:46 -0500] rob___: something like this? https://github.com/opscode-cookbooks/nginx/pull/14
[2012-11-12 21:36:52 -0500] rob___: ohhh Im guessing this is the root cause..
[2012-11-12 21:36:53 -0500] rob___: include_attribute 'nginx::default' does not fix the issue. Attribute load ordering is not the problem here. The problem is that attributes should not be concatenated in attribute files since role attributes are loaded afterwards. Attribute file concatenation prevents them from being overridden in roles. For example:
[2012-11-12 21:38:32 -0500] ssd7: rob___: The issue with computation in attribute files is likely also an issue.  Pull 14 is what I was referring to.  Both look like bugs to me
[2012-11-12 21:39:26 -0500] rob___: ok so it is a bug
[2012-11-12 21:39:28 -0500] rob___: im not crazy
[2012-11-12 21:43:27 -0500] rob___: ok.. another question. Say I wanted to add a new template and/or overwrite an existing one. Is there an easy way for me to do that?
[2012-11-12 21:43:36 -0500] rob___: or do I need to create a new cookbook?
[2012-11-12 21:44:05 -0500] miah: just create a cookbook that wraps/extends the nginx cookbook
[2012-11-12 21:44:42 -0500] rob___: how do you extend a cookbook?
[2012-11-12 21:45:05 -0500] rob___: basically I want to replace the default templages/default/nginx.conf.erb with my own
[2012-11-12 21:46:18 -0500] miah: ah
[2012-11-12 21:46:43 -0500] miah: i typically break my cookbooks apart in such a way that its easy to noop the 'install the default config file' bit and then just wrap that function in my own cookbook
[2012-11-12 21:47:07 -0500] miah: which it looks like you can do
[2012-11-12 21:47:12 -0500] miah: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/commons_conf.rb
[2012-11-12 21:47:14 -0500] miah: just don't run that recipe
[2012-11-12 21:50:19 -0500] maplebed: quick poll - how do you upgrade chef-client on already managed hosts? (i.e. I'm not worried about bootstrapping)
[2012-11-12 21:50:41 -0500] miah: omnibus-updated
[2012-11-12 21:50:43 -0500] miah: er.
[2012-11-12 21:50:44 -0500] miah: omnibus-updater
[2012-11-12 21:51:03 -0500] miah: http://community.opscode.com/cookbooks/omnibus_updater
[2012-11-12 21:51:56 -0500] maplebed: you prefer omnibus over gem install?
[2012-11-12 21:52:08 -0500] miah: yes
[2012-11-12 21:52:37 -0500] miah: managing gems directly with chef is.. tricky.
[2012-11-12 21:55:09 -0500] hcastro: maplebed: i second miah's recommendation
[2012-11-12 21:55:35 -0500] maplebed: cool.
[2012-11-12 21:55:49 -0500] bemu: I third it, with the exception of postgres. :/
[2012-11-12 21:59:27 -0500] bemu: http://comments.gmane.org/gmane.comp.sysutils.chef.user/6116 & http://tickets.opscode.com/browse/COOK-1406
[2012-11-12 22:03:31 -0500] rafaelmagu: Strange
[2012-11-12 22:03:33 -0500] maplebed: it does seem weird to hit a website for a shell script that then downloads a package that's installed via dpkg (instead of, say, using aptitude or apt-get)...
[2012-11-12 22:03:43 -0500] rafaelmagu: Omnibus updater for me failed while trying to update the client
[2012-11-12 22:10:53 -0500] miah: why are you hiting a external resource for anything you _require_ internally? local mirrors of required artifacts are the best thing ever.
[2012-11-12 22:10:58 -0500] maplebed: failed for me trying to knife site install it.
[2012-11-12 22:11:29 -0500] maplebed: miah: I usually don't.  I was just reading the omnibus install stuff.
[2012-11-12 22:12:03 -0500] maplebed: which is why it seems like a strange workflow.
[2012-11-12 22:13:52 -0500] maplebed: though I see there's an attribute in the omnibus_updater cookbook I can override to get to my own spot...  though at that point, once again, I wonder why I shouldn't just use apt instead of the omnibus_updater cookbook.
[2012-11-12 22:16:55 -0500] programmerq: hey, quick question. Trying to run chef-solo. One of my cookbooks is pulling down a file with a remote_file block. The source is over http. I have the http_proxy env variable set. Does chef ignore this?
[2012-11-12 22:21:40 -0500] rob___: sorry stepped out. So there is no way to override an existing template?
[2012-11-12 22:21:56 -0500] rob___: someone mentioned create a wrapper around the existing recipe?
[2012-11-12 22:22:01 -0500] rob___: *cookbook
[2012-11-12 22:29:25 -0500] iamchrisf: Hey guys.  Is it a known bug that "-s" and "--secret-file"
[2012-11-12 22:29:39 -0500] iamchrisf: encrypt differently? http://pastie.org/5368515
[2012-11-12 22:30:26 -0500] iamchrisf: Just spent the better part of 2 hours hunting down why I was getting "bad decrypt" errors.
[2012-11-12 22:30:36 -0500] spox: iamchrisf: -s is short for --secret which allows you to pass the secret in via string in the cli command
[2012-11-12 22:30:45 -0500] spox: --secret-file is a different option and has no short form
[2012-11-12 22:32:01 -0500] iamchrisf: spox: on inspection of the "--help" output,  I see you are correct sir. thx
[2012-11-12 22:32:36 -0500] spox: iamchrisf: no problem :)
[2012-11-12 22:34:00 -0500] darthdeus: is there a best pratice for managing users with chef?
[2012-11-12 22:34:09 -0500] darthdeus: or should i use this? https://github.com/fnichol/chef-user
[2012-11-12 22:37:04 -0500] yfeldblum: darthdeus, no you should not use that; you may use it if, on proper reflection, you find that it suits your needs better than the alternatives ... but there are various cookbooks written by others, and you are free to write your own, for this purpose
[2012-11-12 22:37:20 -0500] sethvargo: does anyone know of an easy way to render a template to a string instead of actually writing to the fs?
[2012-11-12 22:37:41 -0500] darthdeus: yfeldblum: but isn't there a dsl for creating a user for example? i haven't been able to find it on the wiki
[2012-11-12 22:38:23 -0500] yfeldblum: darthdeus, http://wiki.opscode.com/display/chef/Resources#Resources-User ?
[2012-11-12 22:38:37 -0500] yfeldblum: sethvargo, why?
[2012-11-12 22:39:33 -0500] sethvargo: yfeldblum: I'm working on a PR for the sudo cookbook, which does fragment caching to make sure a change won't break things. I want to replace that with the template resource, but I still want the integrity check
[2012-11-12 22:42:49 -0500] yfeldblum: sethvargo, read the source for the template resource, and mimic the parts that find and fetch the template file and that render the template, but skip the parts that compare checksums and write the file to disk?
[2012-11-12 22:44:09 -0500] sethvargo: yfeldblum: that seems really convoluted
[2012-11-12 22:50:23 -0500] josephholsten: sethvargo: I've been wanting to add a configtest attr to the template resource for a while. would take either a string or a proc
[2012-11-12 22:51:06 -0500] sethvargo: i just want something like resource = template './foo' doend; resource.rendered_content # => string
[2012-11-12 22:52:11 -0500] josephholsten: I look forward to seeing your solution
[2012-11-12 22:53:03 -0500] josephholsten: make sure to mention it on the mailing list when you get it working? I've got to disconnect
[2012-11-12 22:58:42 -0500] yfeldblum: sethvargo, it's just copying mostly the same ruby code that is already shipped in chef
[2012-11-12 22:59:11 -0500] sethvargo: right, but it pollutes the lwrp, which goes against what im trying to do (cleanup)
[2012-11-12 23:02:00 -0500] maplebed: what's a good cli reader for all the .md files you get in cookbooks?  (eg README.md)  less does it for me, but I'd like something that understands the markup a bit.
[2012-11-12 23:19:56 -0500] PRK_nz: I haven't used github very much and I'm just trying to figure out how to update a repo I forked a while ago so that it has the newer upstream changes. Do I perform this on my local repo then push back to my fork, or can I do it from within the Github web UI?
[2012-11-12 23:24:51 -0500] miah: git remote add upstream <theupstreamrepo>
[2012-11-12 23:24:55 -0500] miah: git pull upstream
[2012-11-12 23:25:01 -0500] miah: git merge upstream
[2012-11-12 23:25:04 -0500] miah: or something like that
[2012-11-12 23:25:19 -0500] maplebed: that's right.  more detail at https://help.github.com/articles/fork-a-repo
[2012-11-12 23:25:27 -0500] maplebed: but the person asking has left.
[2012-11-12 23:26:04 -0500] miah: this channel is logged, so its generally worthwhile to answer anyways. besides. i ignore joins, parts, kicks, and nicks. so i never see any of that 'noise'
[2012-11-12 23:26:29 -0500] miah: http://community.opscode.com/chat/chef
[2012-11-12 23:26:31 -0500] miah: =)
[2012-11-12 23:27:17 -0500] maplebed: upgrades are painful.
[2012-11-12 23:29:46 -0500] miah: everything worth doing is painful
[2012-11-12 23:30:50 -0500] maplebed: heh..
[2012-11-12 23:31:09 -0500] kreedy: is a role with an empty runlist getting a run list of "recipe[recipe[recipe[]]]" a known issue?
[2012-11-12 23:45:56 -0500] qhartman: having trouble with the rpm.aegisco.com repo for centos. Not sure what it's even for, the whole domain seems down, but it seems to be chef-related. Anyone have any info?
[2012-11-12 23:48:45 -0500] alex_____: Hi all
[2012-11-12 23:51:21 -0500] miah: why do you think its chef related?
[2012-11-12 23:52:10 -0500] jtimberman: kreedy: yes
[2012-11-12 23:52:17 -0500] jtimberman: kreedy: its an unfortunate thing
[2012-11-12 23:52:36 -0500] kreedy: jtimberman: thanks. not too big of a problem. i just now have a cookbook named empty :)
[2012-11-12 23:52:38 -0500] jtimberman: fix is to edit the node/role object in question and delete that item
[2012-11-12 23:53:00 -0500] qhartman: miah, all the (now dead) links I can find about it talk about ruby and chef in the snippets I can see. Really just a shot in the dark hoping someone might have some info.
