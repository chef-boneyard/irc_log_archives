[2012-11-27 00:16:23 -0500] Afterglow: can anyone familiar with omnibus-chef offer any wisdom on this fpm error - https://gist.github.com/4142046
[2012-11-27 01:23:10 -0500] retr0h: anyone seen this?
[2012-11-27 01:23:11 -0500] retr0h: /opt/chef/embedded/lib/ruby/1.9.1/mkmf.rb:381:in `try_do': The compiler failed to generate an executable file. (RuntimeError)
[2012-11-27 01:23:20 -0500] retr0h: You have to install development tools first.
[2012-11-27 01:23:47 -0500] retr0h: this is with the current mysql cookbook.. build-essential is there
[2012-11-27 01:28:49 -0500] red5|ryan: retr0h: might be missing autoconf or something
[2012-11-27 01:29:49 -0500] red5|ryan: try a manual install of that gem on a similar box and see where it gets stuck
[2012-11-27 02:26:43 -0500] retr0h: red5|ryan: nevermind I am a bone head
[2012-11-27 02:27:26 -0500] retr0h: I rebuilt this hypervisor not realizing I preserved the raid which lives on /var hence where dpkg stores all of it's meta-data - so build-essential wasn't getting installed properly and the system was jacked ;)
[2012-11-27 02:28:05 -0500] retr0h: red5|ryan: thx for the help... appreciated
[2012-11-27 02:28:22 -0500] red5|ryan: haha nice :D
[2012-11-27 02:30:13 -0500] retr0h: yah, but hey thats why we use chef right? :) we don't want no stinkin' golden image :P
[2012-11-27 02:30:52 -0500] retr0h: we don't treat servers like precious children to be held and nutured and protected :P we rebuild em :P hahaha
[2012-11-27 04:16:20 -0500] julian_: Hey guys, does anyone know how I can run chef code in a ruby_block?
[2012-11-27 04:16:36 -0500] julian: I need resources available from the ruby block.
[2012-11-27 06:07:11 -0500] murton: do i need all these .pem validation key things to run chef-solo?
[2012-11-27 06:07:17 -0500] murton: the documentation really misses this part
[2012-11-27 06:07:25 -0500] murton: it mentions without explaining
[2012-11-27 06:15:16 -0500] murton: like, my validation.pem is empty, what goes on it?
[2012-11-27 06:15:19 -0500] murton: one half of a key?
[2012-11-27 06:27:28 -0500] miah: you dont need the keys at all if you are using chef solo
[2012-11-27 06:50:17 -0500] BryanWB_: ohai chefs!
[2012-11-27 07:04:47 -0500] miah: guh. runit.
[2012-11-27 07:05:39 -0500] miah: hopefully CHEF-154 someday
[2012-11-27 08:23:02 -0500] alclonky: is there a cookbook for dealing with gsettings in ubuntu?
[2012-11-27 09:58:03 -0500] cpasmoi: Hi there !
[2012-11-27 10:40:15 -0500] mikeywaites: hey guys whats the best way to handle only adding a comma to an array if an array being iterated in a template has a len > 1 ? im building a json structure and ["nginx", ] is obv not valid json
[2012-11-27 10:41:21 -0500] joonas: mikeywaites: what do you have so far?
[2012-11-27 10:42:39 -0500] mikeywaites: joonas:  http://dpaste.com/837562/ havent really thought about it yet. Im no ruby guru so i thought id ask
[2012-11-27 10:43:55 -0500] dkannan: mikeywaites: http://pastie.org/private/yz24mevgae0eztayqkqwg
[2012-11-27 10:44:14 -0500] joonas: mikeywaites: would it be possible for you to generate the json from actual ruby structures
[2012-11-27 10:44:21 -0500] joonas: and let the json library handle that for you
[2012-11-27 10:45:05 -0500] nicholasr-bf: mikeywaites:  array.join(",")
[2012-11-27 10:45:08 -0500] dkannan: mikeywaites: http://pastie.org/private/j2wmtxac9vjumu5byejsg should work
[2012-11-27 10:45:44 -0500] mikeywaites: dkannan:  ah great that makes sense
[2012-11-27 10:45:47 -0500] nicholasr-bf: that pastie is wrong  <%= required not <%
[2012-11-27 10:45:58 -0500] mikeywaites: joonas:  thanks for you help guys
[2012-11-27 10:46:13 -0500] joonas: wouldn't that be invalid though?
[2012-11-27 10:46:32 -0500] joonas: ["a,b,c"] != ["a","b","c"]
[2012-11-27 10:46:33 -0500] nicholasr-bf: plus it won't be escaped...
[2012-11-27 10:46:48 -0500] joonas: sure, if they are integers, it works
[2012-11-27 10:46:53 -0500] joonas: but if they are strings, nope
[2012-11-27 10:47:17 -0500] nicholasr-bf: You could also do <%= @process_checks.to_json %>
[2012-11-27 10:47:21 -0500] mikeywaites: :(
[2012-11-27 10:47:35 -0500] joonas: mikeywaites: also, http://www.ruby-doc.org/core-1.9.3/Array.html :)
[2012-11-27 10:47:39 -0500] joonas: I implore you to explore the language ;)
[2012-11-27 10:48:08 -0500] joonas: mikeywaites: also http://www.ruby-doc.org/core-1.9.3/Enumerable.html
[2012-11-27 10:48:16 -0500] joonas: of course, depending on your ruby version...
[2012-11-27 10:48:34 -0500] mikeywaites: :D i have been avoiding it this long i guess now i should
[2012-11-27 10:48:51 -0500] joonas: mikeywaites: don't be afraid ;)
[2012-11-27 10:48:55 -0500] joonas: ruby is a friendly language :)
[2012-11-27 10:49:16 -0500] nicholasr-bf: The easiest way is to type irb , then experiment...
[2012-11-27 10:49:39 -0500] mikeywaites: :D i started with chef last weekend and its slowly sinking in. Python is more my thing
[2012-11-27 10:49:58 -0500] cpasmoi: damn, "undefined method `[]' for nil:NilClass (NoMethodError)" when I only have 'case node[:ssl_apache]["tvtrip.key"]' on the faulty line...
[2012-11-27 10:50:08 -0500] joonas: mikeywaites: for python there's always saltstack ;)
[2012-11-27 10:50:13 -0500] dkannan: +1 for irb
[2012-11-27 10:50:23 -0500] dkannan: try http://pastie.org/private/blw2finxiyriot7kxabrgg
[2012-11-27 10:50:41 -0500] dkannan: also also check http://apidock.com/ruby
[2012-11-27 10:50:44 -0500] cpasmoi: mikeywaites, I understand you, I 've written a few ruby scripts months ago but chef always surprises me
[2012-11-27 10:56:01 -0500] joonas: if you are too lazy for irb, there's always http://tryruby.org ;)
[2012-11-27 10:56:29 -0500] joonas: albeit it's very limited in functionality available to you :)
[2012-11-27 10:56:59 -0500] joonas: or I shouldn't say very limited, but somewhat limited (for obvious reasons)
[2012-11-27 10:57:34 -0500] joonas: still, I think you can play with anything you'll find in the Core API :)
[2012-11-27 10:57:49 -0500] joonas: which is kind of cool
[2012-11-27 11:29:39 -0500] gma: hi. new to chef. trying to setup the IP and write /etc/hosts, but finding it hard. do people tend to use chef to manage IP addresses?
[2012-11-27 11:30:28 -0500] gma: it seems as though node[:hostname] (for example) is returned by ohai. I want to define it in a .json file, but reading about attributes suggests ohai will clobber it.
[2012-11-27 11:31:43 -0500] gma: any hints?
[2012-11-27 11:57:03 -0500] lsolesen: I am trying to alter the directives for php (want my box to show all errors), but I cannot find an example on Google on how to do it. I tried this, but to no avail: https://gist.github.com/4153877
[2012-11-27 11:58:20 -0500] aruntomar: gma: there are cookbooks on the community site for configuring hosts and another provides lwrp
[2012-11-27 11:58:21 -0500] gma: lsolesen: you want to edit php.ini? is your php.ini currently managed by chef?
[2012-11-27 11:58:49 -0500] gma: aruntomar: thanks. maybe I'm just having trouble finding my way around.
[2012-11-27 11:58:58 -0500] lsolesen: gma: I used chef to setup PHP. Whether it is managed by chef, I do not know. How can I know?
[2012-11-27 11:59:07 -0500] aruntomar: http://community.opscode.com/search?query=hosts&scope=cookbook
[2012-11-27 11:59:24 -0500] gma: lsolesen: I'm a bit new to this, but I'm guessing you'd have a php.ini file in a template? if you haven't, perhaps you're running the php.ini file?
[2012-11-27 11:59:28 -0500] gma: aruntomar: thanks
[2012-11-27 12:00:51 -0500] lsolesen: gma: These docs says I can set directives to append to php.ini. However, there is no example on how to actually do it.
[2012-11-27 12:00:52 -0500] lsolesen: https://github.com/opscode-cookbooks/php/blob/master/README.md#attributes
[2012-11-27 12:01:31 -0500] lsolesen: gma: I tried https://gist.github.com/4153877, but still no errors shown.
[2012-11-27 12:02:15 -0500] gma: lsolesen: oh jesus. that's a level of abstraction away from the config file that I'm not sure I'd want
[2012-11-27 12:02:25 -0500] gma: but, I'm new to chef, so what do I know...
[2012-11-27 12:02:54 -0500] lsolesen: gma: I am not quite following?
[2012-11-27 12:03:09 -0500] gma: lsolesen: have you ever configured PHP and apache by hand?
[2012-11-27 12:03:17 -0500] lsolesen: yeah.
[2012-11-27 12:03:17 -0500] amian84: hi, i've a question. how i can search a concretly automatic attributes from node using knife?
[2012-11-27 12:03:59 -0500] gma: lsolesen: there's not a lot wrong with that. I was rather hoping chef would be giving us ways to control config files using standard unix tools, rather than complicated (new) ways to configure the contexts of text files.
[2012-11-27 12:04:32 -0500] gma: lsolesen: there'll be nothing stopping you doing that, by the way. you could put your .ini file in an erb template and deploy it that way
[2012-11-27 12:05:27 -0500] zts: lsolesen: what does php.ini look after you run chef with the configuration in https://gist.github.com/4153877 ?
[2012-11-27 12:05:53 -0500] aruntomar: amian84: knife can be run from a workstation and not from node, unless you configure your node as a workstation
[2012-11-27 12:06:12 -0500] zts: lsolesen: I mean, does it have your changes at the bottom?  (display_errors=1 and error_reporting=E_ALL)
[2012-11-27 12:06:39 -0500] aruntomar: amian84: automatic attributes are collected and uploaded by ohai, when chef runs
[2012-11-27 12:06:47 -0500] lsolesen: zts: no, nothing in the bottom.
[2012-11-27 12:09:10 -0500] zts: lsolesen: could you please gist the output of the chef run?  I think your configuration should work, although maybe you need to use strings instead of symbols ("display_errors" instead of :display_errors) - but I would have expected that to cause a Chef error if it was a problem
[2012-11-27 12:10:22 -0500] aruntomar: amian84: knife search node 'name: <node name> ' -a <your attribute>
[2012-11-27 12:10:24 -0500] gma: if I add a key to the .json file read by chef-solo, should I be able to refer to in a template using node[:key
[2012-11-27 12:10:29 -0500] gma: sorry, node[:key] ?
[2012-11-27 12:12:07 -0500] amian84: aruntomar: I need search all nodes that contains node.automatic['concretly_attribute']
[2012-11-27 12:15:09 -0500] gma: to put that question another way, how do I set an attribute on a node via the json file?
[2012-11-27 12:15:21 -0500] lsolesen: zts: http://pastie.org/5442147
[2012-11-27 12:15:52 -0500] gma: sticking it in the top level of the json file doesn't seem to work (or at least, I get a stack trace when trying to refer to such things in templates)
[2012-11-27 12:18:44 -0500] aruntomar: amian84: knife search node '*:*' -a concretly_attribute
[2012-11-27 12:54:09 -0500] leifmadsen: anyone happen to know how I can request or purchase a Chef sticker? I got some a while ago for contributing, but I've recently changed laptops and need another sticker :)
[2012-11-27 13:03:00 -0500] irocksu: hi
[2012-11-27 13:04:01 -0500] irocksu: i try to use the postgresql cookbook on a lucid 32 bit ubuntu. i am able to install it, but somehow i cannot grant my user access to psql
[2012-11-27 13:04:54 -0500] irocksu: i could not find how to do this, can someone point me in the right direction?
[2012-11-27 13:06:05 -0500] irocksu: is this part of the cookbook or should i execute custom commands to get the job done?
[2012-11-27 13:10:28 -0500] BryanWB_: leifmadsen: just tweet nathenharvey :)
[2012-11-27 13:10:34 -0500] BryanWB_: he'll get it to u
[2012-11-27 13:10:45 -0500] leifmadsen: BryanWB_: sounds like a scam :D
[2012-11-27 13:10:56 -0500] leifmadsen: thanks!
[2012-11-27 13:38:17 -0500] m4rcu5: does this make sense? using librarian to grab all public cookbooks from the nets and trow them in /cookbooks, and put our own cookbooks in site-cookbooks git repo?
[2012-11-27 13:39:33 -0500] erikh: m4rcu5: we keep our custom cookbooks in site-cookbooks and cookbooks is a volatile directory which contains all the cookbooks we use, ours or not
[2012-11-27 13:39:55 -0500] erikh: cookbooks is also in our .gitignore, so if you walk in there and edit things, you can't commit them. ;)
[2012-11-27 13:46:35 -0500] mikeywaites1: hey again guys! i have some unexpected behaviour happening from the knife ssh command. i have been successfully running this command knife ssh "role:appserver" "sudo chef-client" -x username -i ~/.ssh/id_rsa
[2012-11-27 13:46:44 -0500] mikeywaites1: but now im getting the following message back
[2012-11-27 13:46:58 -0500] mikeywaites1: FATAL: 2 nodes found, but do not have the required attribute to stablish the connection. Try setting another attribute to open the connection using --attribute.
[2012-11-27 13:49:14 -0500] masterkorp: Can i have diferent resources using the same provider ?
[2012-11-27 13:49:44 -0500] m4rcu5: L!NuX07
[2012-11-27 13:49:53 -0500] remil: that may be a fail
[2012-11-27 13:50:11 -0500] remil: f@I! indeed
[2012-11-27 13:50:22 -0500] wassy121: It just showed up as all *s to me.  Was that a password?
[2012-11-27 13:51:08 -0500] erikh: inb4 hunter2
[2012-11-27 13:51:12 -0500] wassy121: :)  Sorry, old troll from bash.org :)
[2012-11-27 13:51:27 -0500] erikh: yeah, that's the password in the bash.org thing
[2012-11-27 13:54:32 -0500] masterkorp: GUYS ?
[2012-11-27 13:54:35 -0500] masterkorp: WELP?
[2012-11-27 13:55:23 -0500] wes_: Has anyone successfully used knife-vsphere to deploy a windows 2008 template in vCenter?  I am getting a "spec.identity" error regardless of what config options I pass to knife.
[2012-11-27 14:01:10 -0500] m4rcu5: mjah exactly the reason why i have a different pass for my screenlocker xD
[2012-11-27 14:03:21 -0500] mikeywaites1: hey anyone have any idea why all the ip, fqdn data etc would not be set for a node? is it something to do with ohai?
[2012-11-27 14:04:16 -0500] wassy121: ohai provides that information.  When you run ohai from the command line, are those values filled?
[2012-11-27 14:04:45 -0500] wassy121: Also, what OS/version?
[2012-11-27 14:05:18 -0500] masterkorp: Well i think its impossible
[2012-11-27 14:05:41 -0500] m4rcu5: erikh: so you also use librian to pull in your and other peoples cookbooks?
[2012-11-27 14:05:42 -0500] mikeywaites1: ubuntu 12.04  - everything was working fine earlier, i just noticed the ohai hash on the node is just an empty plugins object?
[2012-11-27 14:06:09 -0500] mikeywaites1: wassy121:  do i need to the plugins?
[2012-11-27 14:07:36 -0500] wassy121: I don't have any specific plugins.  What happens when you run ohai from command line?  Does it give you appropriate info?
[2012-11-27 14:09:21 -0500] mikeywaites1: sorry how do i do that?
[2012-11-27 14:09:27 -0500] mikeywaites1: is it a gem?
[2012-11-27 14:09:38 -0500] wassy121: Open an SSH connection to the client.  type "ohai"
[2012-11-27 14:10:05 -0500] erikh: m4rcu5: I use berkshelf these days (partially because I wrote a big chunk of the inital code for it)
[2012-11-27 14:10:22 -0500] erikh: I'm probably going to move on to something else when I have time to address what I really want in a system like that.
[2012-11-27 14:10:42 -0500] mikeywaites1: i think i might no what happend! i was editing the nodes using knife before, i recently downloaded them then re-uploaded using from file? could that have killed the ohai data?
[2012-11-27 14:11:15 -0500] erikh: my eyes are focused elsewhere atm, but I expect to announce a pre-release of what I've been working on for the last month or so within the hour
[2012-11-27 14:11:26 -0500] mikeywaites1: wassy121:  ohai dumps a bunch of data out on the node
[2012-11-27 14:12:04 -0500] wassy121: Then ohai is working properly.  It was probably when you ran the "knife node from file".  I don't use that, so don't know if it overwrites the ohai hash?
[2012-11-27 14:12:19 -0500] mikeywaites1: hmmmm seems like it has
[2012-11-27 14:12:31 -0500] mikeywaites1: can i get the node to update the node on my chef server again?
[2012-11-27 14:14:40 -0500] m4rcu5: erikh: thanks for your insights, i think i have a plan now
[2012-11-27 14:14:56 -0500] erikh: cool. let me know if you have any questions
[2012-11-27 14:17:16 -0500] bflad: Is anyone using the users_manage LWRP for user management? I'm running into a strange GID issue with the first useradd it attempts
[2012-11-27 14:18:38 -0500] bflad: I'm not specifying gid in any of my user data bags and its always setting the first gid to 2301 then the rest of the useradd's correctly use GID_MIN
[2012-11-27 14:20:49 -0500] mikeywaites1: anyone know how i can update a node with the data ohai collects?
[2012-11-27 14:20:56 -0500] mikeywaites1: its seems two nodes have lost all this data
[2012-11-27 14:21:13 -0500] mikeywaites1: so now ssh commands etc arent working
[2012-11-27 14:21:20 -0500] m4rcu5: my plan is to keep our own cookbooks in the site-bookbooks folder, using git and git-flow. the external ones we pull once in a while with librarian
[2012-11-27 14:22:45 -0500] erikh: m4rcu5: we did something similar at a previous place I worked, the only gotcha there is getting your cookbook paths uniform for everyone
[2012-11-27 14:22:56 -0500] erikh: the solution we have here, nobody really has to care about that
[2012-11-27 14:23:08 -0500] zts: mikeywaites1: just run chef-client on the node - when it finishes successfully, it saves that data back to the chef server
[2012-11-27 14:23:35 -0500] m4rcu5: erikh: i fixed that by including the .chef folder in the chef-repo
[2012-11-27 14:25:07 -0500] mikeywaites1: zts:  oh ok, yeh its errored out so obviosuly why it hasnt updated
[2012-11-27 14:25:09 -0500] mikeywaites1: thanks
[2012-11-27 14:25:26 -0500] erikh: that has other consequences that I really don't want to introduce
[2012-11-27 14:25:52 -0500] erikh: I'm actually working on a workflow tool (which was that thing I'm talking about earlier)
[2012-11-27 14:26:34 -0500] m4rcu5: erikh: such as? i do not keep any keys in there, just the chef/knife config
[2012-11-27 14:26:55 -0500] erikh: it's not quite releasable yet, though, but it does a few things, like auto-building a chef server, uploading stuff to it (like roles and cookbooks), running tests against it
[2012-11-27 14:27:18 -0500] erikh: m4rcu5: I use at least 2 chef servers
[2012-11-27 14:27:22 -0500] erikh: generally more than that.
[2012-11-27 14:27:57 -0500] erikh: the result is that my ~/.chef/knife.rb literally has one line of code in it:
[2012-11-27 14:28:01 -0500] m4rcu5: ah, we just use 1 with multiple environments
[2012-11-27 14:28:12 -0500] erikh: raise 'erik, you forgot to check this code path'
[2012-11-27 14:28:49 -0500] erikh: yeah, multiple environments are great for things that are production or quasi production
[2012-11-27 14:28:53 -0500] bmcgee: hey guys, what's the easiest way to have some attributes loaded from a data bag merged with already set default attributes?
[2012-11-27 14:29:07 -0500] erikh: but if you've got a few people working on the same cookbook in development, you're gonna have a bad time
[2012-11-27 14:31:01 -0500] erikh: bmcgee: we did this at a previous company for our application configuration. I'd strongly recommend dealing with it some other way if you can avoid it
[2012-11-27 14:31:20 -0500] erikh: the problem is that it tends to leave artifacts in your node meta that lead to .. unexpected issues
[2012-11-27 14:31:38 -0500] bmcgee: erikh: hmmm
[2012-11-27 14:32:14 -0500] bmcgee: I have things like username, password, connection details etc that i've defaulted but would like the ability to then override from a databag
[2012-11-27 14:32:19 -0500] bmcgee: seems a rational enough use case
[2012-11-27 14:32:23 -0500] erikh: oh
[2012-11-27 14:32:27 -0500] erikh: override attributes
[2012-11-27 14:32:30 -0500] erikh: chef solves that for you.
[2012-11-27 14:32:35 -0500] bmcgee: specifying it in the role
[2012-11-27 14:32:37 -0500] bmcgee: ?
[2012-11-27 14:32:53 -0500] erikh: roles, environments and cookbooks support setting them
[2012-11-27 14:33:13 -0500] bmcgee: so I would load them from an encrypted data bag and then manually set each one?
[2012-11-27 14:33:29 -0500] erikh: oh, I see, you want to encrypt the data?
[2012-11-27 14:33:31 -0500] jflowers: anyone know how to specify a cert to be used in the apache2 mod_ssl recipe?
[2012-11-27 14:33:59 -0500] bmcgee: well yeah i don't want a password going as clear text
[2012-11-27 14:34:05 -0500] bmcgee: ideally
[2012-11-27 14:34:30 -0500] erikh: bmcgee: er, I'll avoid bludgeoning you with my encrypted databags are security theatre argument :P
[2012-11-27 14:34:50 -0500] bmcgee: erikh: i always had a sneaking suspicion they were
[2012-11-27 14:34:58 -0500] bmcgee: f**k it, i'll just use the overrides
[2012-11-27 14:35:06 -0500] erikh: well, sec.
[2012-11-27 14:35:26 -0500] erikh: you could always make the cookbook smart enough to know to consult data bags based on the node metadata you provide it
[2012-11-27 14:35:37 -0500] erikh: and you could do so in a way that does not store the data to the node
[2012-11-27 14:35:54 -0500] erikh: e.g., node["configurations"] = %w[one two three]
[2012-11-27 14:36:25 -0500] erikh: then you have three databags that conform to an interface. configurations::one, configurations::two, configurations::three, etc.
[2012-11-27 14:36:43 -0500] erikh: then in your cookbook, you data_bag_item("configurations", "one") (well, dynamically based on the node setting)
[2012-11-27 14:36:48 -0500] erikh: and pull the data out that way
[2012-11-27 14:37:10 -0500] erikh: overrides would definitely be better, but if you want to use encrypted data bags this is a solution that would solve your problems without peeing all over your node
[2012-11-27 14:37:25 -0500] m4rcu5: ow dear, one thing i did not expectw as that librarian would pull in all dependancies for that cookbook 0_0
[2012-11-27 14:38:44 -0500] bmcgee: erikh: I'll go with the overrides for now. I'm not that overly attached to my deploy_key.
[2012-11-27 14:39:04 -0500] erikh: hehe, fair enough
[2012-11-27 14:46:32 -0500] kryptek: good morning all
[2012-11-27 15:23:58 -0500] bmcgee: are any defaults put in default.rb applied regardless of recipe?
[2012-11-27 15:33:51 -0500] wassy121: bmcgee, no, that's just the defaul if you use 'recipe[name]'.  If you want it used in 'recipe[name::subrecipe]' use an include_recipe name::default at the top of the subrecipe.rb
[2012-11-27 15:34:11 -0500] bmcgee: wassy121: thx
[2012-11-27 15:34:37 -0500] wassy121: Oh, it's ' include_recipe "name::default" '
[2012-11-27 15:34:39 -0500] xerxas: Hi all , I'm working with vagrant and berkshelf, have chef.json = { :ubuntu => { :archive_url =>"http://fr.archive.ubuntu.com/ubuntu" } and "ubuntu" in my run_list, in my vagrantfile, but vagrant provision doesn't seem to take my node['ubuntu']['archive_url']
[2012-11-27 15:34:42 -0500] xerxas: any idea ?
[2012-11-27 15:35:09 -0500] xerxas: forgot a "}" in my chef.json
[2012-11-27 15:35:50 -0500] bmcgee: xerxas: can you gist that
[2012-11-27 15:36:00 -0500] xerxas: bmcgee: yeah, sure
[2012-11-27 15:36:50 -0500] xerxas: bmcgee: https://gist.github.com/59c8456bf5f4ffb53c42
[2012-11-27 15:37:16 -0500] xerxas: bmcgee: need sth other than my Vagrantfile ?
[2012-11-27 15:38:08 -0500] bmcgee: xerxas: nope. everything looks kosher, although just out of curiosity try accessing it as node[:ubuntu][:archive_url]
[2012-11-27 15:38:38 -0500] bmcgee: i'm new to ruby but the fact it's defined with a symbol and accessed with a string may be significant
[2012-11-27 15:38:58 -0500] m4rcu5: yfeldblum: are you around?
[2012-11-27 15:39:05 -0500] xerxas: bmcgee: raise node['ubuntu'].inspect in a recipe ?
[2012-11-27 15:39:39 -0500] yfeldblum: m4rcu5, what's up?
[2012-11-27 15:39:55 -0500] xerxas: bmcgee: [2012-11-27T15:22:55+00:00] FATAL: RuntimeError: #<Chef::Node::Attribute @current_normal={"security_url"=>"http://security.ubuntu.com/ubuntu", "archive_url"=>"http://us.archive.ubuntu.com/ubuntu"}, @set_type=nil, @current_automatic=nil, @default={...}, @set_unless_value_present=false, @current_override=nil, @auto_vivifiy_on_read=false, @automatic={...}, @override={...}, @current_default=ni
[2012-11-27 15:39:56 -0500] xerxas: l, @has_been_read=false, @current_nesting_level=["ubuntu"], @normal={...}>
[2012-11-27 15:40:06 -0500] bmcgee: xerxas: can you add it to the gist
[2012-11-27 15:40:09 -0500] bmcgee: easier to read
[2012-11-27 15:40:11 -0500] gyre007: is anyone using service subscriptions ie is anyone subscribing service to some template changes ? I tried but it doesn't seem to react to any config change...I have the following in my nginx recipe: https://gist.github.com/4154884
[2012-11-27 15:40:20 -0500] xerxas: stil us.archive.ubuntu.com , so chef-solo doesn't take my attribute
[2012-11-27 15:40:27 -0500] xerxas: bmcgee: sorry, will gist it ...
[2012-11-27 15:40:29 -0500] gyre007: but that doesnt seem to be reloading nginx even if I prayed to GOD :!
[2012-11-27 15:40:30 -0500] m4rcu5: you are the mastermind behind librarian :) is there a way to not include dependancies, just as a way to collect cookbooks from all kinds of sources
[2012-11-27 15:41:31 -0500] mattupstate: I need to grab the public IP from `knife ec2 server list` in a bash script so I can scp a fileanyone happen to have done this before?
[2012-11-27 15:41:33 -0500] matschaffer: gyre007: this looks right. Have you tried running with debugging turned on?
[2012-11-27 15:41:33 -0500] wes_: Has anyone successfully used knife-vsphere to deploy a windows template in vCenter (does knife-vsphere even support Windows)?  I am getting a "spec.identity" error regardless of what config options I pass to knife.
[2012-11-27 15:42:08 -0500] xerxas: bmcgee: https://gist.github.com/59c8456bf5f4ffb53c42 , updated !
[2012-11-27 15:42:21 -0500] matschaffer: mattupstate: I used -a cloud.public_hostname | awk. Not sexy but worked
[2012-11-27 15:42:23 -0500] gyre007: matschaffer: yep...I can see that the template IS being change however NO reload is happening...
[2012-11-27 15:42:46 -0500] matschaffer: gyre007: does it even say anything about the subscription?
[2012-11-27 15:43:05 -0500] gyre007: matschaffer: let me see
[2012-11-27 15:43:26 -0500] gyre007: matschaffer: NOPE
[2012-11-27 15:43:29 -0500] gyre007: not a mention!
[2012-11-27 15:43:29 -0500] mattupstate: matschaffer: with `knife ec2 server list` ?
[2012-11-27 15:43:37 -0500] matschaffer: mattupstate: knife node search
[2012-11-27 15:43:42 -0500] matschaffer: knife search node even
[2012-11-27 15:43:51 -0500] mattupstate: ah
[2012-11-27 15:44:04 -0500] bmcgee: xerxas: can't see anything wrong with what you're doing. I use the same pattern and haven't had any issues. I'm afraid I'm out of ideas :(
[2012-11-27 15:44:15 -0500] matschaffer: gyre007: hrm. I'd probably try switching it to a notification. Hoping that'll at least log something about why it's not happening
[2012-11-27 15:44:28 -0500] xerxas: bmcgee: me too , out of ideas ... why I'm here ;)
[2012-11-27 15:44:35 -0500] gyre007: bizzare I swear
[2012-11-27 15:44:52 -0500] matschaffer: gyre007: yeah. I also don't usually use the resources syntax. So _maybe_ that's a factor?
[2012-11-27 15:45:02 -0500] matschaffer: I use the new string method
[2012-11-27 15:45:06 -0500] xerxas: bmcgee: my box is Chef 10.14.2 , maybe I should update ?
[2012-11-27 15:45:19 -0500] bmcgee: xerxas: I don't think that should matter
[2012-11-27 15:46:05 -0500] xerxas: bmcgee: I checked my dna.json, it does have the attributes ...
[2012-11-27 15:46:40 -0500] gyre007: I can try to subcribe it one after another
[2012-11-27 15:48:04 -0500] gyre007: heh Chef is completely ignoring subscriptions :) good stuff
[2012-11-27 15:48:22 -0500] xerxas: bmcgee: can I set my attibute somewhere else, even if not clean ?
[2012-11-27 15:48:27 -0500] xerxas: in a cookbook ?
[2012-11-27 15:48:42 -0500] bmcgee: bmcgee: you can try override_attributes in a role
[2012-11-27 15:48:45 -0500] matschaffer: gyre007: did the notifications work?
[2012-11-27 15:49:00 -0500] gyre007: I cant notify dude...
[2012-11-27 15:49:02 -0500] bmcgee: xerxas: you canary override_attributes in a role
[2012-11-27 15:49:09 -0500] bmcgee: xerxas: *can try
[2012-11-27 15:49:14 -0500] xerxas: thanks
[2012-11-27 15:49:18 -0500] gyre007: I need to set up the config first while nginx is not running
[2012-11-27 15:49:52 -0500] gyre007: then start it...but when its already running I need it to be subscribed to those config files...
[2012-11-27 15:49:54 -0500] markfoodyburton: all, we have a chef script using the git SCM resource, behind a proxy. Right now it's failing, is it likely that the git reource isn't taking config::http_proxy into account?
[2012-11-27 15:56:03 -0500] mattupstate: matschaffer: thanks for that, any tip on exacting only the hostname in a bash file? ;)
[2012-11-27 15:56:14 -0500] mattupstate: such a bash novice
[2012-11-27 15:56:46 -0500] markfoodyburton: hostname
[2012-11-27 15:57:33 -0500] matschaffer: mattupstate: yeah one sec. Gotta find some nodes I can search
[2012-11-27 15:57:44 -0500] mattupstate: really appreciate it
[2012-11-27 15:57:56 -0500] gyre007: matschaffer: looks like the new syntax works fine ie resources(template[name]...) the old one DOES NOT work template => blah....
[2012-11-27 15:57:59 -0500] workmad3: gyre007: surely you want to :enable it before the config, :start it at the end of the config and then your config files will :notify the service to restart?
[2012-11-27 15:58:03 -0500] gyre007: interesting find
[2012-11-27 15:58:58 -0500] matschaffer: gyre007: sure is! Thanks for posting back to the channel
[2012-11-27 15:59:12 -0500] matschaffer: gyre007: what did you end up with?
[2012-11-27 15:59:19 -0500] gyre007: with the new syntax...
[2012-11-27 15:59:40 -0500] matschaffer: so like subscribes "template[]", "template[]", :delayed ?
[2012-11-27 16:00:11 -0500] matschaffer: mattupstate: looks like I don't have anything too handy. Spinning up a box now
[2012-11-27 16:00:24 -0500] gyre007: https://gist.github.com/4154884
[2012-11-27 16:00:30 -0500] matschaffer: my current client actually has me using this hand-rolled stuff instead of chef :(
[2012-11-27 16:00:43 -0500] matschaffer: gyre007: ahhhh
[2012-11-27 16:00:55 -0500] mattupstate: matschaffer: totally not necessary
[2012-11-27 16:00:59 -0500] matschaffer: it'd be nice if http://docs.opscode.com/essentials_cookbook_lwrp_resources_common_notifications.html had an example
[2012-11-27 16:01:00 -0500] xerxas: bmcgee: works within a role
[2012-11-27 16:01:06 -0500] workmad3: gyre007: well, the first one won't work simply because of how ruby works
[2012-11-27 16:01:07 -0500] matschaffer: can people edit the new docs stuff?
[2012-11-27 16:01:11 -0500] xerxas: bmcgee: should I feel a vagrant issue ?
[2012-11-27 16:01:23 -0500] matschaffer: workmad3: haha yeah. hadn't considered that
[2012-11-27 16:01:41 -0500] bmcgee: xerxas might be worthwhile, should've worked as i understand it
[2012-11-27 16:01:56 -0500] xerxas: bmcgee: moreover if it works within a role
[2012-11-27 16:02:01 -0500] xerxas: bmcgee: ok , will see
[2012-11-27 16:02:08 -0500] gyre007: workmad3: http://wiki.opscode.com/display/chef/Resources
[2012-11-27 16:02:11 -0500] workmad3: gyre007: because resources(:template => "something", :template => "something_else") is shorthand for creating a hash with the key :template... and the hash can only have one key :template
[2012-11-27 16:02:18 -0500] gyre007: so why is it like that in OFFICIAL docs ?
[2012-11-27 16:02:53 -0500] gyre007: aaaaaaaaah workmad3 ...GREAT POINT!!!
[2012-11-27 16:03:04 -0500] gyre007: jees....cant believe how I missed that one...mmm
[2012-11-27 16:03:06 -0500] workmad3: gyre007: it's using *multiple* of the same key that's a problem ;)
[2012-11-27 16:03:08 -0500] matschaffer: me too
[2012-11-27 16:03:18 -0500] gyre007: workmad3: yeah I got it...
[2012-11-27 16:03:22 -0500] matschaffer: gyre007: yeah, that link you sent uses multiple notified lines
[2012-11-27 16:03:24 -0500] gyre007: too much coding  :)
[2012-11-27 16:03:30 -0500] matschaffer: maybe multiple subscribes should be multiple subscribe lines too?
[2012-11-27 16:03:31 -0500] workmad3: gyre007: I suspect that the official way to do that is with multiple subscribes
[2012-11-27 16:03:38 -0500] gyre007: and the the most obvious stuff is missed :)
[2012-11-27 16:03:39 -0500] workmad3: (which is a missing example... it's there for notifies, not subscribes)
[2012-11-27 16:03:50 -0500] gyre007: workmad3: or new syntax ;)
[2012-11-27 16:03:56 -0500] gyre007: which is working as expected
[2012-11-27 16:04:00 -0500] workmad3: that said, I tend to prefer doing that the other way around anyway :)
[2012-11-27 16:04:10 -0500] workmad3: I put notifies on the templates rather than subscribes on the service
[2012-11-27 16:04:10 -0500] gyre007: still great point mate
[2012-11-27 16:05:13 -0500] workmad3: I feel I'm more likely to add or remove a template than I am to remove the service, so I like to be able to remove the template and not go hunting for services that have subscribed to it
[2012-11-27 16:07:09 -0500] yfeldblum: m4rcu5, what's up?
[2012-11-27 16:07:37 -0500] yfeldblum: m4rcu5, a sorry didn't see your question
[2012-11-27 16:08:12 -0500] yfeldblum: m4rcu5, why do you not want to collect dependencies?
[2012-11-27 16:09:23 -0500] matschaffer: mattupstate: yeah. I'm not too set up for this atm. But it's something like `knife search node -a cloud.public_hostname | awk '{print $2}'`
[2012-11-27 16:09:35 -0500] m4rcu5: yfeldblum: for example the chef-server resolved into apache, apt and yum, but i onl need some recipes from the chef-server cookbook, so no need for all those deps
[2012-11-27 16:09:52 -0500] matschaffer: oh
[2012-11-27 16:10:01 -0500] matschaffer: knife search node '*:*'
[2012-11-27 16:10:25 -0500] mattupstate: matschaffer: i just came up with this..
[2012-11-27 16:10:33 -0500] yfeldblum: m4rcu5, is there a problem if librarian-chef resolves and fetches them too?
[2012-11-27 16:10:40 -0500] mattupstate: knife node show $NODE_NAME -a cloud.public_hostname | sed 's/^[^:]*: *//'
[2012-11-27 16:10:51 -0500] matschaffer: yeah, that's the idea
[2012-11-27 16:11:04 -0500] mattupstate: matschaffer: thanks for your help, by the way
[2012-11-27 16:11:09 -0500] matschaffer: I used awk since it'll just print whatever's on the right hand of the whitespace
[2012-11-27 16:11:31 -0500] matschaffer: though granted, if you had a space in the value that'd mess it up
[2012-11-27 16:11:33 -0500] m4rcu5: yfeldblum: well not a real problem, but i end up with way more in the cookbooks dir then i need. my own cookbooks i keep in site-cookbooks as one git repo.
[2012-11-27 16:11:41 -0500] matschaffer: so your way is probably more robust
[2012-11-27 16:11:56 -0500] matschaffer: the knife search node it useful cause it can pull a bunch of servers
[2012-11-27 16:12:05 -0500] mattupstate: right
[2012-11-27 16:12:11 -0500] matschaffer: but you might need to grep -v to pull out the node names. I wanna say it includes that regardless of what you say on -a
[2012-11-27 16:12:24 -0500] mattupstate: i'm just trying to get a specific one, but again, thanks for your help
[2012-11-27 16:12:30 -0500] mattupstate: good to see the options
[2012-11-27 16:12:48 -0500] yfeldblum: m4rcu5, there is no way to do that; nor do i think a way to do that would really be desirable; plus, librarian-chef transforms your cookbooks directory from source code into a build artifact, so who cares what's in it?
[2012-11-27 16:13:47 -0500] yfeldblum: m4rcu5, the source code is Cheffile and Cheffile.lock, and your site-cookbooks directory
[2012-11-27 16:14:38 -0500] m4rcu5: yfeldblum: hhmm, i was really just looking for a way to grab all those external cookbooks and pull them into one directory
[2012-11-27 16:15:36 -0500] yfeldblum: m4rcu5, heh sorry
[2012-11-27 16:16:47 -0500] matschaffer: mattupstate: cool man. Good luck!
[2012-11-27 16:19:51 -0500] m4rcu5: yfeldblum: but you might know of a nice methode how to do this? :)
[2012-11-27 16:24:25 -0500] yfeldblum: m4rcu5, not really; a key part of the purpose is for librarian to do a complete and consistent dependency resolution, pin that resolution, and fetch the exact versions of all the cookbooks so pinned
[2012-11-27 16:25:25 -0500] yfeldblum: m4rcu5, it will of course fetch some cookbooks you don't need, e.g. the yum cookbook when you're on only debianoids, but it doesn't really do any harm so it's not really a problem
[2012-11-27 16:27:24 -0500] m4rcu5: yfeldblum: how are you managing your books then? the ones you wrote yourself, they are also just an get entry in the Cheffile?
[2012-11-27 16:27:44 -0500] yfeldblum: m4rcu5, those go in site-cookbooks
[2012-11-27 16:27:53 -0500] yfeldblum: m4rcu5, and are not listed in Cheffile
[2012-11-27 16:28:57 -0500] m4rcu5: yfeldblum: so if you wrote cookbook which is a dependancy for something your pull with librarian (example apt) you will also pull in the one trough librarian?
[2012-11-27 16:30:25 -0500] yfeldblum: m4rcu5, in that case you could either fork the original in a separate git repo (or just make your own in a separate git repo) and use the `:git =>` source for that cookbook in Cheffile, or you could make your own within your chef-repo and use the `:path =>` source for that cookbook in Cheffile
[2012-11-27 16:32:41 -0500] m4rcu5: hhmm, thats also possible :)
[2012-11-27 16:33:35 -0500] m4rcu5: yfeldblum: and you also always load all the cookbooks to chef? so also the unused apache2 dependency for example?
[2012-11-27 16:34:15 -0500] yfeldblum: m4rcu5, yeah
[2012-11-27 16:37:58 -0500] m4rcu5: yfeldblum: ok, thanks, i think i know enough to go do some more thinkering :) i think librarian will not fit our needs, but it was an intersting side step to try
[2012-11-27 16:38:48 -0500] ssd7: Ohai Chefs!
[2012-11-27 16:48:14 -0500] awgross: hey, is there a way to make http_request not attempt to parse the response as JSON?
[2012-11-27 16:50:36 -0500] awgross: having issues where the web service response with a text string, chef freaks out
[2012-11-27 16:52:49 -0500] julian_: Anyone know how I can set a variable in a ruby_block at execute time?  I am in a situation where binaries are not accessible during compile time but I need output from them.
[2012-11-27 16:54:23 -0500] yfeldblum: julian_, you might consider installing packages required by the recipe itself earlier, during recipe execution (in silliness, aka "compile time") instead of during convergence
[2012-11-27 16:55:05 -0500] savant: Can I have multiple attribute files in a single chef cookbook?
[2012-11-27 16:55:10 -0500] yfeldblum: savant, yes
[2012-11-27 16:55:17 -0500] savant: and they will all be included?
[2012-11-27 16:55:21 -0500] yfeldblum: savant, yes
[2012-11-27 16:55:51 -0500] savant: cool thanks
[2012-11-27 16:55:54 -0500] savant: is the wiki deprecated?
[2012-11-27 16:56:32 -0500] julian_: yfeldblum: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time?
[2012-11-27 16:57:31 -0500] kocolosk: is it possible to introspect a cookbook from within a recipe? e.g., to find all the templates matching some criteria?
[2012-11-27 16:57:37 -0500] yfeldblum: julian_, yes, you can use that technique
[2012-11-27 16:57:51 -0500] yfeldblum: kocolosk, yes
[2012-11-27 16:57:57 -0500] kocolosk: cool
[2012-11-27 16:58:09 -0500] kocolosk: i looked around for the syntax, failed to find an example
[2012-11-27 16:59:06 -0500] yfeldblum: kocolosk, no syntax, just normal ruby
[2012-11-27 16:59:25 -0500] julian_: Is there a way to make an entire recipe run at compile time?
[2012-11-27 16:59:46 -0500] julian_: I have template files, packages, etc that I have to lay down before I can use my tool correctly.
[2012-11-27 17:00:16 -0500] kocolosk: yfeldblum: umm, sure ... but I don't know how to do the introspection itself (is it a specific part of the chef class hierarchy?)
[2012-11-27 17:00:20 -0500] yfeldblum: julian_, on second thought, maybe you just run your tool at converge time
[2012-11-27 17:00:54 -0500] yfeldblum: julian_, that may be simpler :D
[2012-11-27 17:01:31 -0500] intinig: hello all
[2012-11-27 17:01:39 -0500] intinig: I have a recipe that calls search
[2012-11-27 17:01:43 -0500] intinig: and it fails like this
[2012-11-27 17:01:47 -0500] intinig: Net::HTTPServerException
[2012-11-27 17:01:49 -0500] intinig: 400 Bad Request
[2012-11-27 17:01:55 -0500] intinig: any clue? :)
[2012-11-27 17:01:58 -0500] yfeldblum: kocolosk, the Chef::Provider::CookbookFile and Chef::Provider::Template classes need to do that introspection
[2012-11-27 17:02:05 -0500] yfeldblum: kocolosk, you can look there for an example
[2012-11-27 17:02:09 -0500] kocolosk: ty
[2012-11-27 17:03:06 -0500] qhartman: intinig, your search is probably malformed somehow, or you're searching in a namespace that doesn't exist
[2012-11-27 17:03:31 -0500] intinig: here's the full stacktrace
[2012-11-27 17:03:31 -0500] intinig: https://gist.github.com/4155528
[2012-11-27 17:03:48 -0500] qhartman: intinig, it would be useful to see the search itself
[2012-11-27 17:04:02 -0500] intinig: qhartman: the code is in the gist
[2012-11-27 17:04:05 -0500] intinig: the attributes are this
[2012-11-27 17:06:51 -0500] intinig: https://gist.github.com/4155546
[2012-11-27 17:06:52 -0500] qhartman: intinig, what does that mail_relay_query expand to? If
[2012-11-27 17:07:13 -0500] julian_: yfeldblum: I am trying to do this: https://gist.github.com/4155544
[2012-11-27 17:07:47 -0500] qhartman: intinig, Is this a community cookbook or something you wrote? What does the mail_relay_query attribute expand to on your node?
[2012-11-27 17:08:07 -0500] julian_: Problem is that my tools are not in place for that to successfully run the first time.  You helped me over the weekend (thanks!) but I was still unable to get things working with out a second attempt made by chef client in daemon mode.
[2012-11-27 17:08:24 -0500] intinig: qhartman: it's a patched version (by me) of the opscode community cookbook
[2012-11-27 17:08:35 -0500] intinig: qhartman: the attribute is in the 2nd gist
[2012-11-27 17:08:37 -0500] julian_: The idea with the ruby block is to force the code at execution time and set a variable.
[2012-11-27 17:09:08 -0500] julian_: But I cannot figure out how to export the variable...or how to call aws_ebs_volume from within the ruby_block.
[2012-11-27 17:09:19 -0500] intinig: qhartman: ok
[2012-11-27 17:09:20 -0500] intinig: stupid error
[2012-11-27 17:09:25 -0500] intinig: I suck
[2012-11-27 17:09:27 -0500] yfeldblum: julian_, in this case, you may want to use the pattern in my gist: https://gist.github.com/d85be145f3ff824ccc07
[2012-11-27 17:09:38 -0500] qhartman: intinig, figured it out then?
[2012-11-27 17:09:46 -0500] intinig: qhartman: inside the search
[2012-11-27 17:09:50 -0500] intinig: I was using mail_relay_query
[2012-11-27 17:10:02 -0500] intinig: instead of node['postfix']['mail_relay_query']
[2012-11-27 17:10:18 -0500] intinig: so I was effectively searching for nil
[2012-11-27 17:10:20 -0500] qhartman: yeah, that would do it
[2012-11-27 17:10:52 -0500] cwj: anyone using jenkins-job-builder? i love it except i can't get a pollscm trigger working
[2012-11-27 17:11:24 -0500] cwj: bonus if you do, i wrote a little wrapper cookbook for it https://github.com/needle-cookbooks/chef-jenkins-job-builder
[2012-11-27 17:13:18 -0500] yfeldblum: julian_, you can also just use a normal LWRP and perform both the query and the resource declaration in the provider action
[2012-11-27 17:32:26 -0500] dougireton: In test-kitchen, is there a way to customize the "vm_config.vm.customize" parameters? We need to specify a SAS Controller, not a SATA Controller for our RHEL vbox.
[2012-11-27 17:32:45 -0500] jtimberman: dougireton: unfortunately there isn't a way to customize the vagrant settings
[2012-11-27 17:33:21 -0500] dougireton: So we'll have to modify the Vagrant file in the test-kitchen gem?
[2012-11-27 17:47:02 -0500] ssd7: dougireton: Looking at the test-kitchen code, the only place to modify that will be in the Gem itself
[2012-11-27 17:47:24 -0500] ssd7: dougireton: You could *potentially* do some serious trickery in a config file, but I'm not sure.
[2012-11-27 17:47:50 -0500] dougireton: ssd7: Yeah, I just modified the Vagrantfile in the test-kitchen gem and then everything worked fine
[2012-11-27 17:47:58 -0500] ssd7: nice
[2012-11-27 17:48:03 -0500] dougireton: hacky, but it works
[2012-11-27 17:49:17 -0500] ssd7: Yeah, I don't like how many non-configurable options are in that Vagrantfile.  Not to mention, for a file in the "config" folder there is a lot of application code in there as well.
[2012-11-27 17:50:20 -0500] dougireton: ssd7, pull requests welcome, I'm sure ;)
[2012-11-27 17:50:41 -0500] dougireton: but yes, it would be nice if it were more configurable
[2012-11-27 18:11:44 -0500] gswallow: have a quick question about shef.
[2012-11-27 18:11:55 -0500] ekristen: gswallow: whats up
[2012-11-27 18:12:01 -0500] gswallow: if I do this:
[2012-11-27 18:12:04 -0500] gswallow: shef -z
[2012-11-27 18:12:05 -0500] gswallow: recipe
[2012-11-27 18:12:09 -0500] gswallow: include_recipe "blah"
[2012-11-27 18:12:22 -0500] gswallow: node.set[:blah][:attribute] = "specific value"
[2012-11-27 18:12:34 -0500] gswallow: then run_chef, my specific value is ignored
[2012-11-27 18:12:35 -0500] gswallow: but...
[2012-11-27 18:13:08 -0500] gswallow: If I node.set[:blah][:attribute] = "specific value" and *then* include_recipe "blah", my attribute isn't ignored.
[2012-11-27 18:13:29 -0500] ekristen: right, the include_recipe will be set first
[2012-11-27 18:13:36 -0500] ekristen: err, run first
[2012-11-27 18:13:44 -0500] gswallow: that's the convergence doc isn't it?
[2012-11-27 18:13:58 -0500] ekristen: check out the anatomy of a chef run
[2012-11-27 18:14:16 -0500] gswallow: yeah, that one.  I have read it a dozen times and still don't get it but now I have a way to help me, maybe.
[2012-11-27 18:14:17 -0500] gswallow: thanks.
[2012-11-27 18:14:24 -0500] ekristen: ok
[2012-11-27 18:14:25 -0500] ekristen: so
[2012-11-27 18:14:29 -0500] ekristen: what are you trying to achive?
[2012-11-27 18:14:31 -0500] ekristen: achieve*
[2012-11-27 18:14:39 -0500] gswallow: run a single recipe
[2012-11-27 18:14:50 -0500] ekristen: ok so is this your own custom cookbook?
[2012-11-27 18:14:53 -0500] gswallow: yeah
[2012-11-27 18:15:04 -0500] gswallow: I don't want to go through the whole run list.
[2012-11-27 18:15:12 -0500] gswallow: this lies somewhere between bad habits and change control
[2012-11-27 18:15:21 -0500] ekristen: you want to run a single recipe for testing or something
[2012-11-27 18:15:45 -0500] gswallow: I am running a variant of the admins cookbook, which I think a software engineer lifted from the data bags doc
[2012-11-27 18:16:01 -0500] gswallow: all I want to do is run the admins recipe.
[2012-11-27 18:16:28 -0500] gswallow: btw I was on here sort of pleading for help last week because I was getting random 401 errors?
[2012-11-27 18:16:57 -0500] gswallow: I had a clone of our chef VM that had been powered on by VMware HA.  So I had two VMs listening to the same IP, both running Chef server.
[2012-11-27 18:17:14 -0500] ekristen: I usually just override the run-list to test a single recipe
[2012-11-27 18:17:25 -0500] ekristen: chef-client -o "recipe[cookbook::recipe_name]"
[2012-11-27 18:17:31 -0500] ekristen: but it will override your entire run-list
[2012-11-27 18:17:39 -0500] ekristen: so you'll have to change it back to the main run list after you are done
[2012-11-27 18:17:48 -0500] ekristen: I am still relatively new, there may be a better way to do it
[2012-11-27 18:17:51 -0500] gswallow: yeah, which is why I do that with shef
[2012-11-27 18:17:52 -0500] ekristen: that I don't know about it
[2012-11-27 18:18:28 -0500] gswallow: http://pastebin.com/upA6wzxJ
[2012-11-27 18:19:11 -0500] gswallow: that goes into my .bash_profile file and I can just run "run-admins <query>
[2012-11-27 18:19:22 -0500] gswallow: I'd much rather have Linux-AD integration but hey
[2012-11-27 18:19:33 -0500] ekristen: thats blasphemy
[2012-11-27 18:19:34 -0500] ekristen: ;-)
[2012-11-27 18:19:53 -0500] tjstum: I have a slightly similar question. I have a recipe that runs periodically to update code from a git repo, and I'd like to run specific resources only if the revision has changed
[2012-11-27 18:20:16 -0500] tjstum: I tried setting a local variable to git rev-parse HEAD
[2012-11-27 18:20:44 -0500] tjstum: but that runs during compile time. i'm sort of stuck for a way to figure out how to do this correctly at run time (convergence time?)
[2012-11-27 18:22:29 -0500] ekristen: tjstum: notifies :action, "whattorun", :time
[2012-11-27 18:23:51 -0500] tjstum: in this case, though, i don't own the code that does the "update the code" recipe (i run that with include_recipe).
[2012-11-27 18:23:55 -0500] tjstum: am i out of luck
[2012-11-27 18:23:56 -0500] tjstum: ?
[2012-11-27 18:24:02 -0500] ekristen: hrm
[2012-11-27 18:24:18 -0500] ekristen: subscribe
[2012-11-27 18:24:19 -0500] ekristen: one sec
[2012-11-27 18:24:44 -0500] ekristen: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-11-27 18:24:51 -0500] ekristen: you can subscribe your resource
[2012-11-27 18:27:02 -0500] tjstum: and i declare the resource in a recipe, as per usual?
[2012-11-27 18:27:28 -0500] tjstum: and the resource will run the ruby code at runtime?
[2012-11-27 18:28:31 -0500] ekristen: tjstum: my understanding is that when the resource runs (git for example) it should run your resource because you subscribed
[2012-11-27 18:28:34 -0500] ekristen: but I've never tried it
[2012-11-27 18:28:36 -0500] ekristen: I've just read about it
[2012-11-27 18:29:26 -0500] tjstum: what i currently do is to read the current revision before and after the include_recipe
[2012-11-27 18:29:35 -0500] tjstum: but that just ends up with both of running at the same time
[2012-11-27 18:30:13 -0500] tjstum: this is the best way to run these resource(s) conditionally, based on the outcome of an earlier recipe?
[2012-11-27 18:36:35 -0500] savant: tjstum: use subscription and notification
[2012-11-27 18:37:31 -0500] tjstum: savant: will the ruby code in a subscribed resource get evaluated at run time?
[2012-11-27 18:37:56 -0500] savant: if its a proper resource, i believe so
[2012-11-27 18:40:53 -0500] tjstum: ok, i'll look into that. thanks.
[2012-11-27 18:41:00 -0500] savant: mhm
[2012-11-27 18:57:13 -0500] jflowers: the resource cookbook_file, how do I specify a file to download from a url?
[2012-11-27 18:57:29 -0500] jtimberman: jflowers: use remote_file
[2012-11-27 18:57:34 -0500] jflowers: just pass the ulr to the source attribute?
[2012-11-27 18:58:07 -0500] jflowers: ahh
[2012-11-27 18:58:32 -0500] jflowers: I misread the depreacated message on the remote_file resource
[2012-11-27 18:58:33 -0500] jflowers: sorry
[2012-11-27 18:59:04 -0500] jflowers: BTW do you know of a way to specify a cert to be used by mod_ssl in the apache2 cookbook?
[2012-11-27 19:04:04 -0500] bmcgee: Anyone here use the database recipe for adding users to mysql?
[2012-11-27 19:04:38 -0500] bmcgee: I'm seeing some strange behaviour. It seems to be ignoring the password I'm giving it for a new user
[2012-11-27 19:06:00 -0500] bmcgee: https://gist.github.com/4156305 this has worked in the past. Don't understand what's broken
[2012-11-27 19:11:20 -0500] wamilton: is there a way to get the cookbook name in a recipe?
[2012-11-27 19:12:58 -0500] wamilton: eg so I can say include_recipe "#{this}::recipe_that_i_need" ?
[2012-11-27 19:16:39 -0500] justinlilly: hey guys. When chef tries to startup, it attempts to install python-dev (python is one of the things it's supposed to install), but this hangs. Apparently the ubuntu server needs to have apt-get update beforehand. Is there a way to force this at the start of chef?
[2012-11-27 19:18:44 -0500] red5|ryan: its usually in the bootstrap file you use with knife
[2012-11-27 19:19:46 -0500] justinlilly: red5|ryan: what specifically? I don't see anything in my knife config that has "what to do on startup"
[2012-11-27 19:20:28 -0500] wamilton: justinlilly: he means that conventionally you put that into a custom knife bootstrap script
[2012-11-27 19:22:59 -0500] red5|ryan: so when you do knife bootstrap or knife ec2 server create you can give it a -d switch with the name of a bootstrap file you use for ubuntu hosts
[2012-11-27 19:23:19 -0500] justinlilly: thanks. :)
[2012-11-27 19:23:55 -0500] wamilton: justinlilly: however, if you need to do this without changing out servers, you can use the apt cookbook
[2012-11-27 19:25:49 -0500] justinlilly: wamilton: how might I do that?
[2012-11-27 19:26:30 -0500] justinlilly: ahh. "This recipe should appear first in the run list..."
[2012-11-27 19:26:38 -0500] wamilton: justinlilly: exactly
[2012-11-27 19:29:46 -0500] wamilton: justinlilly: see also http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-11-27 19:30:41 -0500] wamilton: justinlilly: the mysql::ruby recipe uses this method to run apt-get update at the start of the run
[2012-11-27 19:31:14 -0500] justinlilly: thx. Looks like just putting it at the top of the runlist in my base role seemed to work. ^_^
[2012-11-27 19:47:56 -0500] joshhertz1: I have a server backed by LDAP and Ohai seems to be collected everything in LDAP as node data. Is there a way to tell it to ignore user info?
[2012-11-27 19:55:36 -0500] jtimberman: joshhertz1: http://wiki.opscode.com/display/chef/Disabling+Ohai+Plugins
[2012-11-27 19:55:53 -0500] jkyle: I want to extend the DataBag and EncryptedDataBag classes such that the changes are available in all cookbooks implicitly. Is there a good way to do that without patching core? Basically a system wide library.
[2012-11-27 19:56:25 -0500] wamilton: jkyle: use a base role?
[2012-11-27 19:56:48 -0500] jkyle: you'd have to include the library in all the other cookbooks that use data bags though, right?
[2012-11-27 19:56:50 -0500] spox: jtimberman: i was actually looking for something just like that yesterday. awesome
[2012-11-27 19:56:56 -0500] jtimberman: jkyle: whats the use case? you want to encrypt everything that goes into the chef server?
[2012-11-27 19:57:07 -0500] jkyle: I want to make environment scoped data bags
[2012-11-27 19:57:12 -0500] jtimberman: joshhertz1: spox: ldap is exactly the reason why ohai grew that feature :)
[2012-11-27 19:57:13 -0500] spox: virt::linux plugin was hanging on a rh node. i think it was due to a proc file
[2012-11-27 19:57:31 -0500] jkyle: so the class will first lookup db_name_environment, if that fails, fall back to standard behavior of looking for db_name
[2012-11-27 19:57:48 -0500] jkyle: db = databag
[2012-11-27 19:58:24 -0500] jkyle: and for the behavior to happen "out the box" for cookbooks without any need to explicitly extend the class in each cookbook with includes
[2012-11-27 19:58:39 -0500] geekbri: Question opscoders.  I am in the process of changing my node['some_attribute'] to node.set['someattribute'], I was however doing some naughty things like   some_var = node['blah'] = SomeObject.method,  will the .set method still return the value that it sets ?
[2012-11-27 20:01:50 -0500] jtimberman: geekbri: https://gist.github.com/4156658
[2012-11-27 20:02:28 -0500] geekbri: jtimberman: most excellent!
[2012-11-27 20:02:30 -0500] jkyle: jtimberman: thoughts?
[2012-11-27 20:04:50 -0500] jtimberman: jkyle: i think that is coupling impelementation of policy with data too tightly.
[2012-11-27 20:05:28 -0500] jtimberman: jkyle: if you need environments specific data in data bags, then either create them in items named after the chef_environment, or have keys that are chef_environment specific.
[2012-11-27 20:08:32 -0500] poolpog: howdy everyone! I hope ... yadda yadda
[2012-11-27 20:09:05 -0500] poolpog: anyway, directory or file or cookbook_file reesource: Is is possible to get one to copy a directory and all its contents from the chef repo?
[2012-11-27 20:09:22 -0500] poolpog: like cookbook_file, but recursive, and for a directory
[2012-11-27 20:11:40 -0500] jkyle: jtimberman: was trying to avoid the situation of having to fork community cookbooks and modify each one to look for the environment scoped bag items
[2012-11-27 20:14:34 -0500] rafaelmagu: Has anyone managed to integrate berkshelf and knife-spork yet?
[2012-11-27 20:15:11 -0500] stum: poolpog: there some reason why you don't just want to ship an archive (like a .tgz) and then inflate it manually?
[2012-11-27 20:15:27 -0500] poolpog: yes, because it is only a small handful of files...
[2012-11-27 20:15:37 -0500] poolpog: however, I was working that out as a solution
[2012-11-27 20:15:50 -0500] poolpog: is that the solution, then? tarball, untar locally?
[2012-11-27 20:16:22 -0500] poolpog: it's fine with me if that is the "best" solution, but I wasn't at all sure...
[2012-11-27 20:16:47 -0500] stum: i don't know if it's the best solution. it was just the first thing i thought of :)
[2012-11-27 20:17:03 -0500] poolpog: ok
[2012-11-27 20:17:04 -0500] wamilton: poolpog: ark looks pretty swell to me
[2012-11-27 20:17:15 -0500] poolpog: "ark"?
[2012-11-27 20:17:16 -0500] wamilton: https://github.com/opscode-cookbooks/ark
[2012-11-27 20:17:23 -0500] poolpog: k
[2012-11-27 20:17:34 -0500] wamilton: this is me projecting onto you my itch to try out a cookbook :)
[2012-11-27 20:18:00 -0500] poolpog: ark is too heavy for what I need
[2012-11-27 20:18:03 -0500] poolpog: thanks thoguh
[2012-11-27 20:18:58 -0500] stum: yeah, i mean ark's cherry_pick action looks like what you want, but ... you get a lot of other stuff included for no extra charge!
[2012-11-27 20:25:38 -0500] miah: hi.
[2012-11-27 20:25:55 -0500] miah: jtimberman: whats up with this? http://tickets.opscode.com/browse/CHEF-154
[2012-11-27 20:37:42 -0500] Twirrim: miah: that seems interesting.  I've not had much time to delve into runit until yesterday, but if you're interested https://github.com/twirrim/runit that's working for CentOS
[2012-11-27 20:38:03 -0500] Twirrim: got some cleanups still to do and pondering neater ways of laying it out.
[2012-11-27 20:42:05 -0500] miah: mostly. im very interested in provider/resource for it.
[2012-11-27 20:46:02 -0500] Twirrim: I've started looking at that as a possibility, in part because it'd be awesome to be able to call it for test-kitchen tests
[2012-11-27 20:46:48 -0500] miah: well. you'll still need to teach minitest-kitchen about those resources before you can assert them
[2012-11-27 20:46:57 -0500] miah: but the resources have to exist before we can do that =)
[2012-11-27 20:46:58 -0500] jtimberman: miah: yeah, i haven't had a round tuit lately.
[2012-11-27 20:47:06 -0500] miah: jtimberman: ok. thats fine =)
[2012-11-27 20:47:18 -0500] jtimberman: miah: but i've released a heap of other cookbooks :)
[2012-11-27 20:47:20 -0500] miah: is there anything outstanding on it that you recall or do you want me to take a look at it?
[2012-11-27 20:47:35 -0500] miah: jtimberman: yes. machine.
[2012-11-27 20:47:55 -0500] miah: i've been doing lots of work on my collectd / graphite cookbooks lately.
[2012-11-27 21:06:10 -0500] rafaelmagu: I've got a question in regards to assigning a value in a recipe to override an attribute in the role
[2012-11-27 21:07:46 -0500] rafaelmagu: See this gist: https://gist.github.com/4157002#comments
[2012-11-27 21:14:56 -0500] c_t: Nothing quite so fun as trying to figure out what's Nil in a cookbook template
[2012-11-27 21:15:17 -0500] miah: a value isn't being passed
[2012-11-27 21:15:53 -0500] c_t: well, yes
[2012-11-27 21:16:16 -0500] c_t: and I'm pretty sure of the root cause (rewriting a cookbook to use environment stuff rather than role stuff)
[2012-11-27 21:16:40 -0500] jflowers: is there an OS agnostic way to move files
[2012-11-27 21:16:42 -0500] c_t: all well and good, but of course now that it's been a couple of weeks I just have to track down *what* isn't being passed in this one case
[2012-11-27 21:16:51 -0500] jflowers: is there a resource that can move files?
[2012-11-27 21:18:51 -0500] geekbri: You can use ruby itself to move files in an OS agnostic manner.
[2012-11-27 21:19:04 -0500] jflowers: okay
[2012-11-27 21:21:09 -0500] c_t: aha
[2012-11-27 21:21:14 -0500] miah: FileUtils
[2012-11-27 21:21:26 -0500] jflowers: yep that is what I am working with
[2012-11-27 21:21:29 -0500] c_t: 'twas subtle, but found it
[2012-11-27 21:27:23 -0500] miah: awesome
[2012-11-27 21:44:28 -0500] poolpog: turns out I could use "action :nothing" in conjunction with "notify :run ...exec thingy" to do what I wanted. So simple, yet it took me an hour to figure out that it was that simple
[2012-11-27 21:44:55 -0500] poolpog: not that anyone knows what I'm talking about at this point. mostly this is just closure, for future generations
[2012-11-27 21:53:40 -0500] ekristen: how can I force one resource to run before others?
[2012-11-27 21:55:02 -0500] wamilton: ekristen: if it should only run conditionally based on other resources, use notifies
[2012-11-27 21:55:44 -0500] ekristen: wamilton: well I don't want it to run conditionally on another resource I just want it to run after another resource
[2012-11-27 21:55:46 -0500] ekristen: lol
[2012-11-27 21:56:12 -0500] wamilton: ekristen: right, but iff that resource calls it, right?
[2012-11-27 21:56:28 -0500] ekristen: wamilton: I am using the subversion resource
[2012-11-27 21:56:34 -0500] ekristen: and I have some directory resources
[2012-11-27 21:56:43 -0500] ekristen: I want the subversion resource to run before the directory resources
[2012-11-27 21:57:35 -0500] wamilton: ekristen: so would it be safe to say that the directory resources ought not to run unless the subversion resource has already done its thing?
[2012-11-27 21:58:19 -0500] ekristen: wamilton: I see your point
[2012-11-27 21:58:44 -0500] miah: notifies or subscribes
[2012-11-27 21:58:54 -0500] wamilton: http://wiki.opscode.com/display/chef/Resources#Resources-ConditionalExecution
[2012-11-27 22:30:03 -0500] fairchild: when includign another recipie from the same cookbook, i expected that varaibels defined in the included cookbook would be available, but seem to not be the case
[2012-11-27 22:30:11 -0500] fairchild: is there something extra i need to do?
[2012-11-27 22:30:17 -0500] fairchild: both recipes are in the same cookbook
[2012-11-27 22:31:02 -0500] wamilton: fairchild: variables arent, resources are
[2012-11-27 22:31:20 -0500] jtimberman: fairchild: local variables are scoped to the recipe
[2012-11-27 22:31:24 -0500] fairchild: ok, so if i have '`name = node['rubyapp']['name']' in the default
[2012-11-27 22:31:27 -0500] jtimberman: fairchild: if you want it available across recipes, use a node attribute
[2012-11-27 22:31:39 -0500] fairchild: and want to not redecalre it, whats the best way to accomplish that?
[2012-11-27 22:31:48 -0500] fairchild: @name = node['rubyapp']['name'] ?
[2012-11-27 22:31:57 -0500] jtimberman: I don't recommend doing that.
[2012-11-27 22:32:12 -0500] fairchild: this example prolly seems to simple
[2012-11-27 22:32:17 -0500] jtimberman: I don't think @name is going to do what you want.
[2012-11-27 22:32:26 -0500] jtimberman: You should just use the attribute in a local variable in the other recipe.
[2012-11-27 22:32:33 -0500] fairchild: what i really have is some more complicated logic to merge  data from environment specific data bags
[2012-11-27 22:32:43 -0500] fairchild: and assoicate with app variable
[2012-11-27 22:33:17 -0500] fairchild: @jtimberman, so you mean  add it to a node[app] attribute, for example?
[2012-11-27 22:34:28 -0500] fairchild: what i had hoped to do was have a default recipe, that would look up all the rubyapps i had defined for this node, and then loop thru them in a dryer fasion
[2012-11-27 22:35:29 -0500] fairchild: I guess i coudl just mash it all into one recipie, but it seemed so nicely orgnaized with rubyapp::default, rubyapp::database, etc
[2012-11-27 22:37:36 -0500] qhartman: I have a recipe where I have to make a call to an external script where the working directory matters. Currently, I'm storing the cwd, changing directories, running the script, then changing back to the recorded cwd. Is that actually neccesary? If so, is there a more idiomatic way to do it?
[2012-11-27 22:37:57 -0500] wamilton: fairchild: why not use a definition?
[2012-11-27 22:38:11 -0500] fairchild: hadnt thought of that
[2012-11-27 22:39:34 -0500] wamilton: qhartman: why do you need to "change back to the recorded cwd" ?
[2012-11-27 22:40:34 -0500] fairchild: @wamilton, thanks, that looks like it could work.
[2012-11-27 22:40:44 -0500] qhartman: wamilton, That's really the root of my question. Does chef-client care if the working direcotry changes during the run?
[2012-11-27 22:40:51 -0500] wamilton: qhartman: no
[2012-11-27 22:41:23 -0500] wamilton: qhartman: if you set the cwd on a script resource, that only affects the execution of that configured resource
[2012-11-27 22:42:40 -0500] qhartman: wamilton, In this case I'm running code inside a ruby_block and using Ruby's Dir class to move around the fuilesystem
[2012-11-27 22:42:41 -0500] wamilton: qhartman: that's pretty excessive....
[2012-11-27 22:42:41 -0500] wamilton: qhartman: what exactly are you doing?
[2012-11-27 22:43:11 -0500] wamilton: qhartman: I'm thinking that at that point you really might want to think about using cookbook_file or template resource to create the script
[2012-11-27 22:43:22 -0500] qhartman: wamilton, There's a whole complex string of stuff I'm doing inside the ruby_block as well. It's wrapped up in there so the timing is correct at convergence
[2012-11-27 22:43:31 -0500] wamilton: qhartman: and then use the script resource to fire it
[2012-11-27 22:43:42 -0500] wamilton: qhartman: conditional execution and notifies syntax
[2012-11-27 22:43:55 -0500] qhartman: qhartman, yeah, using conditionals
[2012-11-27 22:44:11 -0500] wamilton: http://wiki.opscode.com/display/chef/Resources#Resources-ConditionalExecution
[2012-11-27 22:44:31 -0500] qhartman: wamilton, I'm happy with how this is working overall, was just hoping to avoid storing and restoring the wd
[2012-11-27 22:45:37 -0500] wamilton: qhartman: are you asking how to make the stuff in your ruby_block execution more chef-like, or how to not use ruby_block?
[2012-11-27 22:45:49 -0500] jtimberman: fairchild: you can be sneaky, and add them to node.run_state
[2012-11-27 22:46:12 -0500] fairchild: ok, ill look into that too
[2012-11-27 22:46:12 -0500] jtimberman: fairchild: node.run_state[:myapp] = node['rubyapp']['name']
[2012-11-27 22:46:13 -0500] qhartman: wamilton, neither, really. You've answered my question.
[2012-11-27 22:46:22 -0500] jtimberman: not much to look into, its not documented :)
[2012-11-27 22:46:23 -0500] fairchild: definitions sounds good, but will take considerabel refactoring to use
[2012-11-27 22:46:38 -0500] wamilton: qhartman: ok then -- good hunting
[2012-11-27 22:46:48 -0500] fairchild: @jtimberman, and run_state will be available in the other recipies, since its an attribute?
[2012-11-27 22:47:02 -0500] qhartman: wamilton, likewise, ty ty
[2012-11-27 22:47:24 -0500] fairchild: just a scratchpad for state build up during a run, and then thrown away?
[2012-11-27 22:47:38 -0500] jtimberman: fairchild: yeah
[2012-11-27 22:47:51 -0500] fairchild: cool, thanks, coould be handy
[2012-11-27 22:47:53 -0500] jtimberman: fairchild: chef uses it internally for keeping track of recipes it has loaded, for example.
[2012-11-27 22:48:12 -0500] jtimberman: opscode's nginx cookbook makes pretty heavy use of it in the source recipe
[2012-11-27 22:49:06 -0500] fairchild: reading..
[2012-11-27 22:50:46 -0500] wamilton: jtimberman: is there anyway in a recipe to get the cookbook name as a string?
[2012-11-27 22:50:56 -0500] jtimberman: wamilton: cookbook_name
[2012-11-27 22:51:03 -0500] wamilton: wow, derp
[2012-11-27 22:51:03 -0500] jtimberman: its a method that returns the name of the cookbook
[2012-11-27 22:51:07 -0500] wamilton: sweet
[2012-11-27 22:51:08 -0500] jtimberman: likewise, recipe_name is the recipe
[2012-11-27 22:51:19 -0500] wamilton: thanks
[2012-11-27 22:51:27 -0500] jtimberman: Chef::Log.info("I'm now reading what you have in #{cookbook_name}::#{recipe_name}")
[2012-11-27 22:51:29 -0500] fairchild: that coudl be nice, let me just iterate thru stack of apps
[2012-11-27 22:55:31 -0500] wamilton: jtimberman: mind if I add recipe_name and cookbook_name to the Recipes wiki page?
[2012-11-27 22:56:11 -0500] wamilton: jtimberman: better yet, is there a protocol on editing the wiki and if so where can I read about it?
[2012-11-27 22:58:18 -0500] jtimberman: wamilton: That documentation has moved to docs.opscode.com
[2012-11-27 22:58:35 -0500] jtimberman: And our tech writer is updating documentatino for a "Recipe DSL" page.
[2012-11-27 23:00:00 -0500] jtimberman: repository is: https://github.com/opscode/chef-docs, there's a CONTRIBUTING file that has contribution guidelines.
[2012-11-27 23:00:12 -0500] wamilton: jtimberman: excellent, thanks
[2012-11-27 23:22:06 -0500] kindsol: ohai
[2012-11-27 23:25:12 -0500] kindsol: I am just an old skool chef-solo user trying to learn the ways of the new age Jedi chef developer.
[2012-11-27 23:25:39 -0500] kindsol: When I wanted to tweak something in an opscode cookbook (say a template) I used to emily "cookbook overrides" (via the cookbook_path) to override the opscode cookbook with my changes
[2012-11-27 23:26:05 -0500] kindsol: I doubt this is the accepted practice anymore
[2012-11-27 23:26:11 -0500] wamilton: kindsol: http://berkshelf.com/cakethanks.html
[2012-11-27 23:26:26 -0500] kindsol: s/smily/employ/
[2012-11-27 23:27:59 -0500] kindsol: wamilton: i'm loving berkshelf, but I still have the problem that I only want to change one file from the upstream cookbook
[2012-11-27 23:28:55 -0500] kindsol: I guess in this senario one would just clone the cookbook and maintain a vendor branch from which to periodically merge in updates?
[2012-11-27 23:29:08 -0500] kindsol: from upstream
[2012-11-27 23:29:19 -0500] wamilton: kindsol: depending on the gravity of the change, you might be able to just use the resources() DSL) method to tamper with the configuration of the resources configured by the other cookbooks
[2012-11-27 23:31:44 -0500] kindsol: wamilton:  interesting use of the compile phase
[2012-11-27 23:32:14 -0500] kindsol: seems a little hard to debug if things go wrong then again so are cookbook overrides
[2012-11-27 23:32:33 -0500] jtimberman: kindsol: this maybe helpful for you then: bit.ly/WfYEfO
[2012-11-27 23:32:43 -0500] jtimberman: i discuss some of that :)
[2012-11-27 23:33:06 -0500] wamilton: jtimberman: funny you should mention it, that's where I pulled my last two comments :)
[2012-11-27 23:33:22 -0500] miah: isn't that what bryanwb's new cookbook is for? https://github.com/bryanwb/chef-rewind
[2012-11-27 23:33:36 -0500] jtimberman: miah: could be :)
[2012-11-27 23:33:44 -0500] jtimberman: miah: I've been doing it with the resources() method for 3 years :)
[2012-11-27 23:33:47 -0500] jtimberman: 4 years?
[2012-11-27 23:33:48 -0500] miah: ya
[2012-11-27 23:34:28 -0500] miah: i've been learning the Resource and ResourceCollection classes lately =)
[2012-11-27 23:34:42 -0500] kindsol: jtimberman: thanks. I will give it a read.
[2012-11-27 23:35:23 -0500] jtimberman: They're wonderful.
[2012-11-27 23:35:35 -0500] kindsol: sounds like there may not be a generally accepted alternative to cookbook overrides?
[2012-11-27 23:35:48 -0500] kindsol: or maybe it is just tweaking the resource collection?
[2012-11-27 23:36:13 -0500] wamilton: kindsol: the only concensus I know of is that you can't use site-cookbook shadowing anymore
[2012-11-27 23:36:47 -0500] wamilton: kindsol: but that's concensus on what you CAN'T do, which isn't as useful
[2012-11-27 23:36:59 -0500] kindsol: indeed
[2012-11-27 23:37:48 -0500] wamilton: in jtimberman's blog post he links to the summit discussions, and a ton of projects are mentioned
[2012-11-27 23:38:16 -0500] kindsol: yeah, I'll check it out.
[2012-11-27 23:42:57 -0500] wamilton: the best part about this is getting the application cookbook pattern confused with the opscode application cookbook
[2012-11-27 23:43:39 -0500] tjadmin: wamilton: I agree with that!
[2012-11-27 23:44:26 -0500] tjadmin: There are patterns and then there are <templates>
[2012-11-27 23:44:30 -0500] kindsol: what are the "library" and "application" cookbook patterns?
[2012-11-27 23:44:44 -0500] kindsol: not finding them on wiki
[2012-11-27 23:45:00 -0500] wamilton: kindsol: they're zeitgeist
[2012-11-27 23:45:38 -0500] wamilton: "application" cookbook, near as I can understand is simply creating a cookbook responsible for overriding another one and prefixing it with your organization name
[2012-11-27 23:45:48 -0500] kindsol: wamilton: course they are
[2012-11-27 23:46:01 -0500] wamilton: if I had to guest, "library" pattern has to do with chef librarian
[2012-11-27 23:46:17 -0500] wamilton: s/st\b/ss
[2012-11-27 23:46:48 -0500] miah: it has nothing to do with librarian
[2012-11-27 23:47:01 -0500] programmerq: so, we're trying to install chef server using chef-solo using instructions on the wiki. It is failing at the step where it installs the chef-server-api gem into the omnibus included ruby. It fails to find gecodesearch.
[2012-11-27 23:47:06 -0500] wamilton: fuuuuuuuuuuuuuuuuuuuuuuuuuuuu
[2012-11-27 23:47:11 -0500] wamilton: :)
[2012-11-27 23:47:12 -0500] programmerq: We do have gecode-devel installed (rhel6)
[2012-11-27 23:47:26 -0500] miah: http://www.youtube.com/watch?v=x0LoqaKbu2g
[2012-11-27 23:47:29 -0500] miah: watch that.
[2012-11-27 23:47:36 -0500] programmerq: and the library does exist in the filesystem: /usr/lib64/libgecodesearch.so
[2012-11-27 23:47:49 -0500] programmerq: any suggestions?
[2012-11-27 23:47:51 -0500] kindsol: miah: gracias!
[2012-11-27 23:47:59 -0500] wamilton: miah++
[2012-11-27 23:48:38 -0500] rava: indeed
[2012-11-27 23:48:41 -0500] wamilton: programmerq: what is the error from the handler?
[2012-11-27 23:49:53 -0500] programmerq: Could not create Makefile
[2012-11-27 23:50:08 -0500] programmerq: checking for main() in -lgecodesearch... *** extconf.rb failed ***
[2012-11-27 23:50:27 -0500] wamilton: programmerq: if you log in and go `which make` do you have make?
[2012-11-27 23:50:31 -0500] rava: this is wonky, why would the chef server web ui show all the recipes/providers/etc.. on one version, but another version only show the cookbook files
[2012-11-27 23:50:45 -0500] jtimberman: kindsol: its a community originated pattern :)
[2012-11-27 23:50:47 -0500] programmerq: wamilton: we do have make: /usr/bin/make
[2012-11-27 23:51:12 -0500] jtimberman: can we start saying primitive cookbooks and implementation cookbooks or something instead? :)
[2012-11-27 23:52:07 -0500] programmerq: we're using a solo.rb and chef.json from the wiki and doing this install method: chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
[2012-11-27 23:52:11 -0500] programmerq: and this wiki page
[2012-11-27 23:52:45 -0500] kindsol_: jtimberman: nice!
[2012-11-27 23:52:51 -0500] programmerq: I would hope that if make was missing, this would include it (but of course we do have it so that's not the issue). hmmm.
[2012-11-27 23:53:13 -0500] rava: first version of a users cookbook upload: http://d.pr/i/cX2z and then 2 versions up: http://d.pr/i/MPxC
[2012-11-27 23:54:02 -0500] jtimberman: programmerq: installing the Chef 10 server under an omnibus-chef-client isn't really supported.
[2012-11-27 23:54:23 -0500] rava: so for some reason, a knife upload after version 1.1.3 on that cookbook, the webui stops showing the extra pieces
[2012-11-27 23:54:44 -0500] jtimberman: but these might be helpful: http://jtimberman.housepub.org/blog/2012/11/17/install-chef-10-server-on-ubuntu-with-ruby-1-dot-9/ ; http://jtimberman.housepub.org/blog/2012/11/17/install-chef-10-server-on-centos/
[2012-11-27 23:54:58 -0500] programmerq: jtimberman: should I do the aegisco.repo yum repo on rhel6 instead?
[2012-11-27 23:55:06 -0500] julian_: Anyone have any ideas about removing nodes from the chef-mater?  I am using spot instances and the chef master can be easily cluttered.
[2012-11-27 23:55:22 -0500] julian_: Shutdown script?
[2012-11-27 23:55:24 -0500] programmerq: oh, it looks like for el6, it's the rbel repo that I'll want.
[2012-11-27 23:55:25 -0500] programmerq: hmmm
[2012-11-27 23:55:45 -0500] jtimberman: programmerq: I don't know. I've not done that.
[2012-11-27 23:55:46 -0500] rava: julian_: i tried a shut down script but the client api doesn't have a "delete me" call
[2012-11-27 23:55:48 -0500] programmerq: oh, sorry, thinking out loud
[2012-11-27 23:56:12 -0500] programmerq: it looks like I just need to install ruby, and then gem install chef
[2012-11-27 23:56:12 -0500] jtimberman: the steps followed in the CentOS blog post above are the only "Open Source Chef Server on RHEL" i've done :)
[2012-11-27 23:56:34 -0500] programmerq: ah, a little self promotion never hurts. :)
[2012-11-27 23:56:44 -0500] jtimberman: :)
[2012-11-27 23:57:01 -0500] jtimberman: Chef 11 is going to make this all a LOT simpler.
[2012-11-27 23:57:02 -0500] rava: julian_: i landed on just using a cron job to check for clients/nodes instance ids, then checking aws if they still exist
[2012-11-27 23:57:08 -0500] jtimberman: One single package for supported platforms.
[2012-11-27 23:57:10 -0500] julian_: I am running centreon (nagios) and I am thinking of setting up an action script that is triggered by a node being unreachable for an hour (or something similar).
[2012-11-27 23:57:16 -0500] programmerq: it's been a while since metaxis has been in here. does he still come around these parts?
[2012-11-27 23:57:19 -0500] jtimberman: (like, one package for each one that is :))
[2012-11-27 23:57:23 -0500] programmerq: I could be spelling his nick wrong :/
[2012-11-27 23:57:31 -0500] julian_: rava: good idean.
[2012-11-27 23:57:34 -0500] julian_: er idea.
[2012-11-27 23:57:40 -0500] programmerq: jtimberman: providing an rpm would be absolutely fabulous.
[2012-11-27 23:57:52 -0500] miah: the omnibus install is a rpm
[2012-11-27 23:58:05 -0500] programmerq: miah: that's only chef client though
[2012-11-27 23:58:08 -0500] rava: julian_: i tried to do that too, but then ended up running into the problem of updating nagios as to wether the host still existed :)
[2012-11-27 23:58:10 -0500] miah: www.opscode.com/chef/install
[2012-11-27 23:58:13 -0500] programmerq: having an rpm that brings in everything for chef server would be nice
[2012-11-27 23:58:16 -0500] miah: then use knife-server
[2012-11-27 23:58:29 -0500] miah: https://github.com/fnichol/knife-server
[2012-11-27 23:58:39 -0500] miah: they are working on omnibus installer for server
[2012-11-27 23:58:54 -0500] programmerq: omnibus for server would be sweet too.
[2012-11-27 23:58:55 -0500] miah: but consider its the holiday season. releasing software right now is insane.
[2012-11-27 23:59:04 -0500] programmerq: of course. :)
[2012-11-27 23:59:19 -0500] programmerq: I'm just happy to hear that my troubles are indeed being addressed.
[2012-11-27 23:59:36 -0500] miah: for the time being.. knife-server =)
[2012-11-27 23:59:44 -0500] siezer: programmerq you can preview an older ubuntu build if you'd like
