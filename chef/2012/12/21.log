[2012-12-21 00:08:36 -0500] jtnz: Hi, I have found that in a recipe, if I use node.default['foo']['bar']['attribute'], it _overrides_ the same override attribute in a Role. Has anyone had any experience with this?
[2012-12-21 00:09:24 -0500] jtnz: Even though override attribute applied in a Role have a higher priority than default attributes in a recipe (see http://docs.opscode.com/essentials_cookbook_attribute_files_attribute_precedence.html).
[2012-12-21 00:15:50 -0500] programmerq: jtimberman: nevermind, 1.3.6 does fix it (had to knife delete 1.3.8 before 1.3.6 was used again)
[2012-12-21 00:16:32 -0500] programmerq: will do a pull request
[2012-12-21 00:18:41 -0500] programmerq: https://github.com/opscode-cookbooks/database/pull/24
[2012-12-21 00:20:55 -0500] madteckhead: Q to those in the know: if I update recipes in a roles env_run_lists, then knife upload it, why isn't the new role-runlist being picked up in my env?
[2012-12-21 00:21:31 -0500] madteckhead: As viewed in the management console, or via knife show.
[2012-12-21 00:21:50 -0500] madteckhead: Bit lost as to why this wouldn't automagically being updated.
[2012-12-21 00:22:07 -0500] madteckhead: when I upload the the role inc runlist
[2012-12-21 00:55:16 -0500] jkyle: I need to install the passenger gem, then query it for the passenger root path, then use that value in a template resoruce
[2012-12-21 00:56:05 -0500] jkyle: the problem is the code that attempts to shell out and get the root runs during compile time, while the other code runs during convergence
[2012-12-21 00:56:16 -0500] jkyle: so passenger isn't availalbe to query
[2012-12-21 00:56:20 -0500] jkyle: here's the code: https://gist.github.com/4349908
[2012-12-21 00:56:44 -0500] jkyle: I've tried putting hte query into a ruby_block, but the variables set within the ruby block are not available outside the ruby block for use in the template resource
[2012-12-21 02:08:28 -0500] sn0wb1rd: jkyle: instead of passing in the variable in template resource, try using the node variable directly from the template file
[2012-12-21 02:08:50 -0500] sn0wb1rd: evaluation in template will take place in converge phase.
[2012-12-21 02:11:04 -0500] jkyle: I decided to drive the path from some ohai data
[2012-12-21 02:12:27 -0500] gyre007: i would try to set node attribute...that would do it...
[2012-12-21 02:12:57 -0500] gyre007: and it also makes sense...you should have a default passenger path and override it in the recipe if needed...
[2012-12-21 02:13:56 -0500] jkyle: I used node['languages']['ruby']['gem_path'] + "/passenger-#{node['nginx']['passenger']['version']"  to do it
[2012-12-21 02:14:41 -0500] jkyle: passenger-config is more robust, but this will do. I'd rather not put to much procedural code in templates
[2012-12-21 02:38:23 -0500] auser: hey all
[2012-12-21 02:45:29 -0500] auser: I'm trying to use the deploy resource with a deploy_key, but the repos port is non-standard ssh:// and a different port. anyone here run into this edge case before?
[2012-12-21 02:51:19 -0500] auser: oh, I forgot to include and I'm using the cookbook: application
[2012-12-21 02:55:20 -0500] kallistec: hcastro: missed your message earlier, my IRC client hadn't reconnected after laptop suspend. Anyway, you're correct about
[2012-12-21 02:55:30 -0500] kallistec: ... "recipe" vs. ":recipe"
[2012-12-21 02:56:34 -0500] jkyle: auser: should conform to standard uri schemas
[2012-12-21 02:56:45 -0500] auser: hey jkyle
[2012-12-21 02:56:48 -0500] jkyle: heya
[2012-12-21 02:56:59 -0500] jkyle: heard you're the new chef biatch over at the new job hehe
[2012-12-21 02:57:57 -0500] jkyle: ssh://domain.com:3333/ ought to do it, I assuem that's failing though?
[2012-12-21 02:57:57 -0500] auser: heh, well with good reason
[2012-12-21 02:58:05 -0500] auser: yep
[2012-12-21 02:58:41 -0500] jkyle: since it's urn under the user's environment, I'd try using ssh aliases in the user's ssh/config...but some stack traces would help
[2012-12-21 02:58:58 -0500] jkyle: is it the uri or the deploy_key that's failing?
[2012-12-21 03:00:24 -0500] auser: certainly, it's actually the ssh_wrapper (deploy_key)
[2012-12-21 03:00:55 -0500] auser: sec. PM
[2012-12-21 04:51:02 -0500] dougireton: When I run `kitchen test` in my cookbook repo I get this error message: "WARNING: No knife configuration file found". Where do I need to add a knife.rb in my cookbook to make test kitchen work?
[2012-12-21 04:55:28 -0500] psykidellic: dougireton: If I am not wrong, ~/.chef
[2012-12-21 04:56:08 -0500] psykidellic: Has anybody used knife solo with github install? I keep getting: The cookbook repo ./cookbooks is not a git repository.
[2012-12-21 05:06:45 -0500] psykidellic: Nevermind, I dont think it is supported.
[2012-12-21 07:31:43 -0500] Hirzu: Hi, I'm completely new to chef and starting with this newbie question: I'm trying to list cookbooks on my newly installed server using knife, and it gives me this error 'Your private key could not be loaded from /etc/chef/client.pem' in fact I can't find that key from anywhere, how do I generate those keys.
[2012-12-21 07:33:02 -0500] Hirzu: anyone here to help?
[2012-12-21 07:36:33 -0500] zuhaib: Hirzu: are you using manage chef?  You can go here and generate a new key, https://www.opscode.com/account/password
[2012-12-21 07:37:01 -0500] Hirzu: I have local installation, just to make it more complex, I guess :)
[2012-12-21 07:37:17 -0500] zuhaib: Ah so you did your own chef server
[2012-12-21 07:37:22 -0500] Hirzu: Iyes
[2012-12-21 07:37:40 -0500] Hirzu: it took some time, but seems to run ok now
[2012-12-21 07:37:54 -0500] Hirzu: except for this client.pem
[2012-12-21 07:39:22 -0500] zuhaib: login to your chef server and and select clients and then you can edit the client your using to manager chef with
[2012-12-21 07:39:30 -0500] zuhaib: and from there you can generate a new key
[2012-12-21 07:39:39 -0500] specialsauce: Hirzu: are you trying to list the cookbooks locally on the server using knife?
[2012-12-21 07:39:43 -0500] Hirzu: ok, thanks. I'll try that
[2012-12-21 07:39:58 -0500] Hirzu: with the web-hi I suppose
[2012-12-21 07:39:59 -0500] specialsauce: if so and you haven't already done it, you just run "knife configure -i" to set up an initial admin client
[2012-12-21 07:40:16 -0500] zuhaib: ah thats new
[2012-12-21 07:45:43 -0500] Hirzu: somehow I feel pretty idiot with this. From web ui I requested to regenerate the primary key but can't locate the file anywhere.
[2012-12-21 07:52:04 -0500] specialsauce: Hirzu: if all else fails:
[2012-12-21 07:52:07 -0500] specialsauce: find / -type f -name "*.pem"
[2012-12-21 07:52:08 -0500] specialsauce: :-P
[2012-12-21 07:52:14 -0500] Hirzu: doing that :)
[2012-12-21 07:52:16 -0500] specialsauce: hehe
[2012-12-21 07:52:38 -0500] Hirzu: still no file with that name, I'll try to find one modified recently :)
[2012-12-21 07:55:14 -0500] Hirzu: this is actually pretty interesting. There is no pen file modified today, but when I tried to enervate new client key, the knife changed the name of the fuel to expect...
[2012-12-21 08:06:48 -0500] Hirzu: I get this for 'knife configure -i' : DEBUG: Signing the request as chef-webui
[2012-12-21 08:06:48 -0500] Hirzu: ERROR: knife encountered an unexpected error
[2012-12-21 08:06:48 -0500] Hirzu: This may be a bug in the 'configure' knife command or plugin
[2012-12-21 08:06:48 -0500] Hirzu: Please collect the output of this command with the `-VV` option before filing a bug report.
[2012-12-21 08:06:49 -0500] Hirzu: Exception: NoMethodError: private method `gsub' called for nil:NilClass
[2012-12-21 08:25:03 -0500] Hirzu: this is getting unreal :)
[2012-12-21 08:25:47 -0500] Hirzu: from server log I see that the generation of new private key fails when logging on to the server with the user I defined in the install time.
[2012-12-21 08:28:23 -0500] Hirzu: this is really weird. Is it possible to fix this local server installation, or do I need to reinstall and hope for better result?
[2012-12-21 08:49:20 -0500] Hirzu: any ideas why I can generate new private key for client?
[2012-12-21 08:49:43 -0500] Hirzu: I get error on server.log 'Connection failed - user: chef - (Bunny::ProtocolError)'
[2012-12-21 08:50:18 -0500] specialsauce: Hirzu: that just means rabbitmq isn't running
[2012-12-21 08:50:21 -0500] specialsauce: or can't be connected to
[2012-12-21 08:50:27 -0500] Hirzu: ok
[2012-12-21 08:50:27 -0500] specialsauce: is it running?
[2012-12-21 08:50:34 -0500] Hirzu: don't know :)
[2012-12-21 08:50:52 -0500] specialsauce: ok, depending on how you installed it, check using init script?
[2012-12-21 08:50:55 -0500] specialsauce: or pgrep
[2012-12-21 08:51:43 -0500] Hirzu: I just restarted it
[2012-12-21 08:52:03 -0500] specialsauce: check its listening using "netstat -lnpt | grep 5672"
[2012-12-21 08:52:06 -0500] Hirzu: still same problem
[2012-12-21 08:52:36 -0500] Hirzu: it seems to be listening that port
[2012-12-21 08:52:48 -0500] specialsauce: ok good. you can then use "rabbitmqctl" to check if your chef user is set up and has perms on needed queues
[2012-12-21 08:52:49 -0500] Hirzu: so I can't connect to that
[2012-12-21 08:54:03 -0500] specialsauce: "rabbitmqctl list_user_permissions -p chef chef"
[2012-12-21 08:54:47 -0500] Hirzu: Listing permissions for user "chef" ...
[2012-12-21 08:55:06 -0500] Hirzu: "/chef.*.*.*"
[2012-12-21 08:55:10 -0500] Hirzu: is that correct=
[2012-12-21 08:55:52 -0500] Hirzu: I have just no Idea what this means
[2012-12-21 08:55:59 -0500] specialsauce: so rabbitmq is running and listening on correct port and chef user has permissions to connect to it, can you use "-VV" to get more details?
[2012-12-21 08:56:29 -0500] Hirzu: -VV ?
[2012-12-21 08:56:34 -0500] specialsauce: verbose mode
[2012-12-21 08:56:40 -0500] Hirzu: I'm trying to do the key generation from web-ui
[2012-12-21 08:56:59 -0500] Hirzu:  how do I do that from command lin?
[2012-12-21 08:57:38 -0500] specialsauce: "knife configure -i -VV" should work i think?
[2012-12-21 08:59:51 -0500] Hirzu: this is the header I get back "HTTP 1.1 409 Conflict"
[2012-12-21 09:01:09 -0500] specialsauce: i think that just means the client you are trying to create already exists
[2012-12-21 09:02:04 -0500] Hirzu: true thats what is says on second try
[2012-12-21 09:02:30 -0500] Hirzu: first one is "clear" " HTTP 1.1 500 Internal Server Error"
[2012-12-21 09:02:39 -0500] Hirzu: not much help there
[2012-12-21 09:03:33 -0500] Hirzu: it still seems to create the client so that I can see it on web-ui
[2012-12-21 09:03:50 -0500] Hirzu: but no keys anywhere and probably something else also missing.
[2012-12-21 09:03:56 -0500] specialsauce: yeah wiki says "Returns "409 Conflict" if you try and create a client that already exists."
[2012-12-21 09:04:18 -0500] Hirzu: I changed the client name, then got the 500
[2012-12-21 09:04:24 -0500] specialsauce: so you have an initial admin user setup but no pemfile for it
[2012-12-21 09:04:43 -0500] Hirzu: I quess so
[2012-12-21 09:05:37 -0500] specialsauce: not sure how to sort this nicely but you can reset couch so it has no record of your clients pretty easily using curl. at your own risk
[2012-12-21 09:05:54 -0500] specialsauce: but "http://localhost:5984/chef/_design/clients/_view/all" should show you yuor current client state
[2012-12-21 09:06:00 -0500] specialsauce: (from your chef server)
[2012-12-21 09:06:11 -0500] specialsauce: one line/row per client
[2012-12-21 09:06:19 -0500] specialsauce: that will show yo where you currently stand
[2012-12-21 09:06:44 -0500] specialsauce: you should have a "chef-validator", a "chef-webui", and then your default user - "admin" or "root" or whatever
[2012-12-21 09:07:18 -0500] Hirzu: admin is there, and couple more, since I've been experimenting with this client generation
[2012-12-21 09:07:26 -0500] specialsauce: if you're feeling brave and/or this is a new install with nothing previous in it, you can then use curl just to delete your admin user
[2012-12-21 09:07:28 -0500] Hirzu: how do I remove those users?
[2012-12-21 09:07:30 -0500] specialsauce: pattern is:
[2012-12-21 09:08:05 -0500] specialsauce: curl -X DELETE http://localhost:5984/chef/ID?rev=REV i think
[2012-12-21 09:08:09 -0500] Hirzu: I'm feeling desperate at the moment :) Open for all ideas...
[2012-12-21 09:08:45 -0500] specialsauce: you can get the ID and REV from the json array returned on the original viewall curl request
[2012-12-21 09:08:49 -0500] specialsauce: this is quite hacky though
[2012-12-21 09:09:22 -0500] Hirzu: I can remove those using webui, although It will end up with "NoMethodError 500"
[2012-12-21 09:09:40 -0500] specialsauce: remove them using curl and then run "knife configure -i -VV"
[2012-12-21 09:10:09 -0500] specialsauce: (only the ones you added, leave validator and webui)
[2012-12-21 09:11:04 -0500] Hirzu: where do I put the ID for the remove ( I miss SQL so much :) )
[2012-12-21 09:11:34 -0500] specialsauce: where I put "ID" in the url above
[2012-12-21 09:11:53 -0500] specialsauce: "ID" and "REV" and where you need to put the real ID and REV hashes in
[2012-12-21 09:12:03 -0500] specialsauce: so eg:
[2012-12-21 09:12:33 -0500] specialsauce: http://localhost:5984/chef/1adedsaaaa-993c-4e11-9dd1-a540ab80bc91?rev=4-78f62110c598ssd22dc9229f3b6af320c
[2012-12-21 09:12:36 -0500] specialsauce: or whatever
[2012-12-21 09:14:45 -0500] Hirzu: I've done that
[2012-12-21 09:15:05 -0500] specialsauce: ok, so do the view all again
[2012-12-21 09:15:13 -0500] specialsauce: and make sure the new ones you've added are all gone
[2012-12-21 09:15:24 -0500] specialsauce: then run "knife configure -i -VV"
[2012-12-21 09:15:28 -0500] Hirzu: from web, gone
[2012-12-21 09:15:32 -0500] Hirzu: from db gome
[2012-12-21 09:15:40 -0500] Hirzu: gone, I mean
[2012-12-21 09:15:42 -0500] specialsauce: ok cool
[2012-12-21 09:17:21 -0500] Hirzu: still can't make it with the knife configure
[2012-12-21 09:17:56 -0500] specialsauce: what's the full error now?
[2012-12-21 09:18:09 -0500] specialsauce: if you used VV yuo should have a lot of info on what went wrong
[2012-12-21 09:18:11 -0500] specialsauce: pastebin it
[2012-12-21 09:18:26 -0500] Hirzu: in a sec
[2012-12-21 09:18:37 -0500] Hirzu: Everything?
[2012-12-21 09:18:44 -0500] specialsauce: why the devil not? :-)
[2012-12-21 09:19:15 -0500] Hirzu: I'll have to edit it a bit...
[2012-12-21 09:19:44 -0500] specialsauce: yep sure, anonymize it if needed too
[2012-12-21 09:21:26 -0500] Hirzu: yep, server names should not be there
[2012-12-21 09:21:54 -0500] Hirzu: "DEBUG: Using configuration from /home/ubuntu/.chef/knife.rb
[2012-12-21 09:21:54 -0500] Hirzu: Overwrite /home/ubuntu/.chef/knife.rb? (Y/N) Y
[2012-12-21 09:21:54 -0500] Hirzu: Please enter the chef server URL: [http://ipal:4000] http://server-name:4000
[2012-12-21 09:21:54 -0500] Hirzu: Please enter a clientname for the new client: [ubuntu]
[2012-12-21 09:21:54 -0500] Hirzu: Please enter the existing admin clientname: [chef-webui]
[2012-12-21 09:21:55 -0500] Hirzu: Please enter the location of the existing admin client's private key: [/etc/chef/webui.pem]
[2012-12-21 09:21:56 -0500] Hirzu: Please enter the validation clientname: [chef-validator]
[2012-12-21 09:21:58 -0500] Hirzu: Please enter the location of the validation key: [/etc/chef/validation.pem]
[2012-12-21 09:22:00 -0500] Hirzu: Please enter the path to a chef repository (or leave blank):
[2012-12-21 09:22:02 -0500] Hirzu: Creating initial API user...
[2012-12-21 09:22:04 -0500] Hirzu: DEBUG: Signing the request as chef-webui
[2012-12-21 09:22:06 -0500] Hirzu: DEBUG: Sending HTTP Request via POST to server-name:4000/clients
[2012-12-21 09:22:08 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:22:10 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:22:12 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:22:14 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:22:14 -0500] specialsauce: Hirzu: eep, pastebin
[2012-12-21 09:22:18 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:22:20 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:22:22 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:22:24 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients, retrying 1/5 in 3s
[2012-12-21 09:22:26 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:22:28 -0500] Hirzu: DEBUG: HTTP 1.1 409 Conflict
[2012-12-21 09:22:30 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:22:32 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:22:34 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:22:36 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:22:38 -0500] Hirzu: INFO: HTTP Request Returned 409 Conflict: Client already exists
[2012-12-21 09:22:40 -0500] Hirzu: DEBUG: Signing the request as chef-webui
[2012-12-21 09:22:42 -0500] Hirzu: DEBUG: Sending HTTP Request via PUT to server-name:4000/clients/ubuntu
[2012-12-21 09:22:44 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:22:48 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:22:50 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:22:52 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:22:54 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:22:56 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:23:00 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:23:00 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients/ubuntu, retrying 1/5 in 4s
[2012-12-21 09:23:02 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:23:04 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:23:06 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:23:08 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:23:10 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:23:12 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:23:14 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:23:18 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients/ubuntu, retrying 2/5 in 6s
[2012-12-21 09:23:20 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:23:22 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:23:24 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:23:26 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:23:28 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:23:30 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:23:46 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:23:46 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients/ubuntu, retrying 3/5 in 11s
[2012-12-21 09:23:47 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:23:47 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:23:47 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:23:47 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:23:49 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:23:51 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:23:53 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:23:55 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients/ubuntu, retrying 4/5 in 30s
[2012-12-21 09:23:57 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:23:59 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:24:03 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:24:05 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:24:07 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:24:09 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:24:11 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:24:13 -0500] Hirzu: ERROR: Server returned error for http://server-name:4000/clients/ubuntu, retrying 5/5 in 53s
[2012-12-21 09:24:15 -0500] Hirzu: DEBUG: ---- HTTP Status and Header Data: ----
[2012-12-21 09:24:17 -0500] Hirzu: DEBUG: HTTP 1.1 500 Internal Server Error
[2012-12-21 09:24:19 -0500] Hirzu: DEBUG: server: thin 1.3.1 codename Triple Espresso
[2012-12-21 09:24:21 -0500] Hirzu: DEBUG: connection: close
[2012-12-21 09:24:23 -0500] Hirzu: DEBUG: content-type: application/json; charset=utf-8
[2012-12-21 09:24:25 -0500] Hirzu: DEBUG: ---- End HTTP Status/Header Data ----
[2012-12-21 09:24:27 -0500] Hirzu: INFO: HTTP Request Returned 500 Internal Server Error: Connection failed - user: chef
[2012-12-21 09:24:29 -0500] Hirzu: ERROR: internal server error
[2012-12-21 09:24:33 -0500] Hirzu: Response: Connection failed - user: chef"
[2012-12-21 09:24:35 -0500] Hirzu: has been 20 yrs since I last used irc :)
[2012-12-21 09:24:37 -0500] Hirzu: sorry
[2012-12-21 09:24:39 -0500] Hirzu: how do I paste bin?
[2012-12-21 09:24:52 -0500] specialsauce: heh
[2012-12-21 09:24:59 -0500] specialsauce: nmm to late now :-P
[2012-12-21 09:25:08 -0500] Hirzu: I know, but for the future
[2012-12-21 09:25:35 -0500] specialsauce: there's public pastebins ar pastebin.org or similar, then you can just post a link
[2012-12-21 09:25:40 -0500] specialsauce: they format code etc too
[2012-12-21 09:25:49 -0500] Hirzu: even old men can learn new tricks
[2012-12-21 09:26:03 -0500] Hirzu: cool, I'll have a look
[2012-12-21 09:27:22 -0500] specialsauce: ok, its hitting the server, and getting a 500 internal server error, so you should have more details in /var/log/chef/server.log or wherever your server logs to
[2012-12-21 09:27:30 -0500] Hirzu: oh, nice I've been living in a jar, I suppose
[2012-12-21 09:27:45 -0500] Hirzu: tested paste bin, I mean
[2012-12-21 09:30:01 -0500] Hirzu: http://pastebin.com/JqTBvj8U
[2012-12-21 09:30:49 -0500] Hirzu: that is the repeated pattern in the file
[2012-12-21 09:31:12 -0500] specialsauce: ok, yep so this is definitely a rabbit connection problem
[2012-12-21 09:31:18 -0500] specialsauce: so you'll need to debug that
[2012-12-21 09:31:48 -0500] specialsauce: its not an auth thing from the looks of things, its a conncetion error
[2012-12-21 09:32:07 -0500] Hirzu: ok, so any ideas on how to debug that?
[2012-12-21 09:32:12 -0500] specialsauce: so if rabbit is local, its possible its bound to 127.0.01 or somethign and you are trying to connect to the eth0 address for it or similar
[2012-12-21 09:33:23 -0500] Hirzu: ok, this installation is done with the apt-get packages of chef I have no idea on how it is configured
[2012-12-21 09:33:33 -0500] Hirzu: I'll try to have a llook
[2012-12-21 09:33:47 -0500] specialsauce: what address does "netstat -lnpt | grep 5672" show rabbit bound to?
[2012-12-21 09:33:57 -0500] Hirzu: :)
[2012-12-21 09:34:31 -0500] Hirzu: it says " tcp6       0      0 :::5672                 :::*                    LISTEN      - "
[2012-12-21 09:34:44 -0500] specialsauce: only ipv6?
[2012-12-21 09:34:50 -0500] Hirzu: seems so
[2012-12-21 09:34:53 -0500] specialsauce: heh
[2012-12-21 09:35:01 -0500] Hirzu: that might explain
[2012-12-21 09:35:04 -0500] specialsauce: well if you're using ipv4 that would certainly be an issue :-P
[2012-12-21 09:35:10 -0500] Hirzu: where can I find configurations for rabbit
[2012-12-21 09:36:01 -0500] specialsauce: depends on your package
[2012-12-21 09:36:06 -0500] specialsauce: payment /etc/default/rabbitmq
[2012-12-21 09:36:14 -0500] specialsauce: check your init script on your host for where it pulls config from
[2012-12-21 09:36:33 -0500] Hirzu: its nice to have these automatic packagers :)
[2012-12-21 09:37:09 -0500] specialsauce: http://www.rabbitmq.com/man/rabbitmq-server.1.man.html has config keys to use
[2012-12-21 09:37:22 -0500] specialsauce: Hirzu: good luck!
[2012-12-21 09:37:48 -0500] Hirzu: a bit frustrating..
[2012-12-21 09:39:24 -0500] Hirzu: I'll take luck now  :) need to clear my thoughts
[2012-12-21 09:39:32 -0500] Hirzu: lunch I mean
[2012-12-21 09:58:22 -0500] loicfrering: hi guys, is there a way to use (for example) application_ruby_rails resource independantly from the application or deploy resource? I'd like to reuse this to deploy an existing application on my VM without having to write a specific recipe that would do almost the same application management (bundler, migrations...)
[2012-12-21 10:01:38 -0500] emanuelez: hello. how do i specify attributes for a specific node? they seem to be overridden by the defaults in the cookbooks
[2012-12-21 10:05:15 -0500] mattp: emanuelez: you can use "knife node edit ..." from the command line, or instead use the web ui to set node attributes. http://wiki.opscode.com/display/chef/Attributes#Attributes-NodeAttributes
[2012-12-21 10:06:52 -0500] emanuelez: mattp: i see. writing json seems a bit annoying. it would be nice with something like: knife node edit nodename this.that.andthat=value
[2012-12-21 10:13:15 -0500] mattp: emanuelez: if you're so inclined you can write a chef plugin to use the rest api and have that tool do the json work. I don't know of any such preexisting plugin though. http://wiki.opscode.com/display/chef/Knife+Plugins has some pointers
[2012-12-21 10:14:02 -0500] emanuelez: mattp: thanks. my ruby-fu does not allow me that yet, but it's a good idea!
[2012-12-21 10:14:36 -0500] mattp: (I meant 'knife' plugin, but I hope that was evident from context)
[2012-12-21 10:37:06 -0500] zts: mattp, emanuelez: there's already a few floating around, eg https://github.com/amian84/knife-set-attribute
[2012-12-21 10:37:22 -0500] zts: (I haven't used that one, so YMMV - there's a couple of others on github as well)
[2012-12-21 10:39:42 -0500] zts: emanuelez: it's also worth noting that setting lots of node attributes is often an anti-pattern - unless the attributes you're setting really are unique to the node (vs what the node is doing), you might want to create a role for it
[2012-12-21 10:43:25 -0500] emanuelez: zts: of course. i'm using it for the ssl certificate for apache or the open url acceptable for the server of a customer
[2012-12-21 10:44:18 -0500] benner: mirk_: no
[2012-12-21 10:44:25 -0500] zts: emanuelez: you'll know best whether they are unique attributes or not :)  The way I think of it is, "If this node dies and I need to rebuild it, will these things change?"
[2012-12-21 10:44:55 -0500] zts: emanuelez: if the answer is no, I put them into roles - so that all I need to do is assign the roles to my replacement node, and everything will end up the same.
[2012-12-21 10:45:50 -0500] emanuelez: zts: makes good sense. thanks for the tip
[2012-12-21 10:46:23 -0500] zts: np
[2012-12-21 11:07:05 -0500] mutombo: greetings
[2012-12-21 11:08:05 -0500] acoulton: Hi there
[2012-12-21 11:08:26 -0500] mutombo: i got a short question about cookbooks: currently i need a few more templates for apache and tomcat. Do I edit the apache and tomcat cookbooks for that, or should a create a new cookbook? is there some recommended way?
[2012-12-21 11:10:08 -0500] acoulton: I'm a bit confused about how to override default attributes for recipes I'm trying to include with include_recipe
[2012-12-21 11:10:27 -0500] acoulton: I can get the override working at the role level (with override_attributes)
[2012-12-21 11:11:11 -0500] acoulton: But in the recipe it looks like I have to use node.normal - but is there a way to pass in an array to that or do I have to set each value one by one?
[2012-12-21 11:13:10 -0500] acoulton: EG - I see documentation of the node.normal['apache']['listen_ports'] syntax, but when I call node.normal({apache => {'listen_ports' => ['80']}}) I get an error
[2012-12-21 11:13:43 -0500] acoulton: As I'm setting quite a few attributes it would be more readable to set them as a hash
[2012-12-21 11:45:33 -0500] fujin_: ust make it ice
[2012-12-21 11:45:34 -0500] fujin_: http://www.youtube.com/watch?annotation_id=annotation_270948&feature=iv&src_vid=GFLGRidfFo4&v=R_K6971WmAs
[2012-12-21 13:29:20 -0500] Hirzu: hi, where can I find rabbitMQ specific configurations in  my chef server installation?
[2012-12-21 13:34:12 -0500] jwcarman: Is there any way to tell Berkshelf to just upload all cookbooks from a directory (say "cookbooks")?
[2012-12-21 13:34:21 -0500] jwcarman: along with all the other specified cookbooks?
[2012-12-21 13:34:48 -0500] jwcarman: something like cookbook_path in knife.rb?
[2012-12-21 13:35:37 -0500] jwcarman: I guess I could use knife to upload all of "my" cookbooks and berkshelf to upload all the dependencies
[2012-12-21 13:36:27 -0500] jflowers: can lwrp do notifications?
[2012-12-21 13:36:52 -0500] jflowers: when writting a lwrp is there anything you need to do to enbale notifications?
[2012-12-21 13:36:55 -0500] acoulton: Hi, sorry this is probably a ruby noob question rather than chef-specific
[2012-12-21 13:37:35 -0500] acoulton: I have a hash containing various parameters that I'd like to include in my virtual host config using the web_app definition
[2012-12-21 13:38:09 -0500] acoulton: If I set them one by one (within `web_app site_config['host'] do`) then that's fine
[2012-12-21 13:38:32 -0500] acoulton: But is there a way to pass the whole site_config hash to be parameters?
[2012-12-21 13:38:53 -0500] acoulton: I've tried doing various things but keep coming up with errors
[2012-12-21 13:38:55 -0500] jflowers: you mean like:
[2012-12-21 13:40:06 -0500] jflowers: node['some']['keys'] = { 'more' = 'values' }
[2012-12-21 13:40:19 -0500] jflowers: or:
[2012-12-21 13:40:32 -0500] jflowers: node['some']['keys'] = {
[2012-12-21 13:40:33 -0500] leifmadsen: style question! If you were going to have a bunch of json data (e.g. servers and their details) that would be defined based on environment, would you be more likely to put that in the environment json file, or create data bags?
[2012-12-21 13:40:45 -0500] jflowers:   'more' => {
[2012-12-21 13:41:02 -0500] jflowers:       'still' = 'more'
[2012-12-21 13:41:05 -0500] jflowers:     }
[2012-12-21 13:41:09 -0500] jflowers:   }
[2012-12-21 13:43:44 -0500] acoulton: jflowers so I have site_config = { 'docroot' => '/var/www/app', 'port' => '80', 'front_controller' => 'admin.php'}
[2012-12-21 13:44:26 -0500] acoulton: And I'd like to do something like web_app('app', site_config)
[2012-12-21 13:44:37 -0500] acoulton: rather than web_app 'app' do
[2012-12-21 13:44:44 -0500] jwcarman: Is there a better forum to ask berkshelf questions?
[2012-12-21 13:44:48 -0500] acoulton:   docroot site_config['docroot']
[2012-12-21 13:45:03 -0500] acoulton:   front_controller site_config['front_controller']
[2012-12-21 13:45:58 -0500] jflowers: not sure I understand yet...
[2012-12-21 13:46:04 -0500] jflowers: you mean like:
[2012-12-21 13:46:06 -0500] jwcarman: I believe you can do webapp_app('app', node['app']), right?
[2012-12-21 13:46:22 -0500] jflowers: web_app['app'] = site_config
[2012-12-21 13:46:32 -0500] jwcarman: the node['app'] would evaluate to a hash and you can just pass that in
[2012-12-21 13:49:33 -0500] jflowers: when writting a lwrp is there anything you need to do to enbale notifications?
[2012-12-21 13:49:48 -0500] jflowers: or does that come for free
[2012-12-21 13:49:50 -0500] acoulton: web_app['app'] = site_config gives undefined `[]=' for Chef::Resource::Execute
[2012-12-21 13:51:04 -0500] acoulton: web_app('app',site_config) tells me that it can't find my template (which is set in the :template element of the site_config hash)
[2012-12-21 13:51:29 -0500] jflowers: ooh, I didn't pick up on that web_app is a resource
[2012-12-21 13:51:32 -0500] jflowers: sorry
[2012-12-21 13:52:13 -0500] jflowers: I am not aware of any way to do what you are asking
[2012-12-21 13:53:49 -0500] acoulton: jflowers: OK, thanks - guess I'll just have to declare the keys one by one
[2012-12-21 14:08:53 -0500] w6fu: anyone here use the munin cookbook? I'm trying to figure out how to enable a default plugin (mysql) for some nodes, can't seem to figure how
[2012-12-21 14:12:00 -0500] geekbri: leifmadsen: I would probably put it in a databag.  It seems to me like your environment file might start to get really large and difficult to manage if you stored it all in there.
[2012-12-21 14:13:09 -0500] leifmadsen: geekbri: that is exactly what I was thinking
[2012-12-21 14:13:43 -0500] geekbri: leifmadsen: The nice thing about that is that it also allows you to reuse any defintions that are redundant.  Your environment file could just contain an array of databag id's or something.
[2012-12-21 14:13:59 -0500] geekbri: Or you could just search some other field within you recipes or whatever.  I think the databag path just seems more flexible.
[2012-12-21 14:14:02 -0500] leifmadsen: ah that is true as well
[2012-12-21 14:14:16 -0500] leifmadsen: agreed
[2012-12-21 14:14:43 -0500] geekbri: I have a bunch of stuff in role files right now that I wish I had put in databags.  If I could easily redo it I would.
[2012-12-21 14:14:43 -0500] leifmadsen: that was my gut instinct as well, unless you can think of a better place to store data, but I think the data bag is most approrpriate
[2012-12-21 14:15:18 -0500] leifmadsen: thanks for the input
[2012-12-21 14:15:51 -0500] geekbri: No problemo
[2012-12-21 14:16:25 -0500] geekbri: I've been thinking about the "other places to store data" thing as well.  I try to keep everything as native to chef as possible
[2012-12-21 14:16:53 -0500] leifmadsen: ya, and I think the data bag will be safer if other people need to go and modify it
[2012-12-21 14:26:56 -0500] hikeit: good morning!
[2012-12-21 14:27:40 -0500] hikeit: I'm finally crawling out from under my rock, and the topic says Chef 10.16.2. I'm still on 0.10.6 in 95% of my environment
[2012-12-21 14:27:53 -0500] hikeit: omnibus_updater, with some tweaks, is going to take care of nodes
[2012-12-21 14:27:57 -0500] hikeit: but the chef server
[2012-12-21 14:28:45 -0500] hikeit: i have a new one spinning, replicated the couchdb over to the new server, copied over the various .pem files, and everything seems to be good (clients, nodes, cookbooks, roles, environments, etc)
[2012-12-21 14:28:48 -0500] geekbri: hikeit: I'm running most of my servers on 0.10.8 at the moment
[2012-12-21 14:28:48 -0500] hikeit: except for search
[2012-12-21 14:28:53 -0500] hikeit: search is empty
[2012-12-21 14:29:04 -0500] geekbri: hikeit: I ran some trials with 10.16.2 and most of my stuff works fine except for our user management cookbook
[2012-12-21 14:29:08 -0500] geekbri: if thats any help :)
[2012-12-21 14:29:16 -0500] hikeit: 0.10.8 has platform_family, at least
[2012-12-21 14:31:02 -0500] hikeit: any ideas how to replicate the contents of search? should i look into solr replication, or should i just copy the solr files on the disk and restart chef-solr?
[2012-12-21 14:36:36 -0500] jwcarman: Is a Berksfile just ruby code?
[2012-12-21 14:36:50 -0500] jwcarman: Meaning, can I just put ruby code in it to make cookbook declarations easier?
[2012-12-21 14:39:04 -0500] hikeit: try it out, i'm curious too
[2012-12-21 14:39:30 -0500] hikeit: (though i'm using librarian until berkshelf fixes the Berksfile.lock bugs)
[2012-12-21 14:39:32 -0500] jwcarman: it looks like it is, but I am having troubles getting it to work
[2012-12-21 15:04:44 -0500] mutombo: i got a short question about cookbooks: currently i need a few more templates for apache and tomcat. Do I edit the apache and tomcat cookbooks for that, or should a create a new cookbook? is there some recommended way?
[2012-12-21 15:15:30 -0500] w6fu: mutombo: I like to keep the opscode cookbooks untouched, so I'll usually include the apache cookbook inside of a custom one
[2012-12-21 15:16:33 -0500] mutombo: yeah me too, thanks for the clarification, kinda new to chef
[2012-12-21 15:22:03 -0500] jflowers: am I right in thinking that all values on resource attributes are evaluated at compile time?
[2012-12-21 15:22:27 -0500] jflowers: or are they evaluated at convergence?
[2012-12-21 15:22:59 -0500] jflowers: I have a value that I won't know until convergence that I need to pass to a resource...
[2012-12-21 15:28:26 -0500] jflowers: can I execute a resource from inside a ruby block?
[2012-12-21 15:28:37 -0500] jflowers: that is a ruby block resource
[2012-12-21 15:31:59 -0500] hikeit: yay 0.10.6 let you run array.sort on an array of Chef::Node objects 10.16.2 fails
[2012-12-21 15:32:09 -0500] hikeit: i love finding changes this way
[2012-12-21 15:41:59 -0500] hikeit: geekbri: platform_family showed up in ohai in march, actually so chef 0.10.8 doesn't actually support it. lots of new cookbooks seem to be using it, which is what is giving us impetus to upgrade. seems like there are some more undocumented breaking changes though (can't sort an array of nodes with .sort() anymore)
[2012-12-21 15:46:43 -0500] xuru: good morning  question:  Can I create or set data bag items on an encrypted data bag inside a recipe?
[2012-12-21 15:47:28 -0500] xuru: I've tried it from many different angles, and can't seem to get it to work
[2012-12-21 15:48:17 -0500] hikeit: do you have it working with a regular data bag?
[2012-12-21 15:49:12 -0500] xuru: Not yet.  I'll work on that first I guess
[2012-12-21 15:49:32 -0500] xuru: encrypted data bag is just a wrapper around a data bag object right?
[2012-12-21 15:50:01 -0500] yfeldblum: only data-bag items are encrypted; data-bags themselves are not encrypted
[2012-12-21 15:50:14 -0500] xuru: ah, ok
[2012-12-21 15:50:31 -0500] xuru: how can I check if a data bag exists?
[2012-12-21 15:50:32 -0500] yfeldblum: an encrypted data-bag item is a data-bag item whose top-level values are serialized and encrypted
[2012-12-21 15:51:21 -0500] xuru: yfeldblum: That makes sense
[2012-12-21 15:51:41 -0500] hikeit: fyi your client will need ACLs to set or create data bags and data bag items; on open source that means making it an admin client
[2012-12-21 15:52:18 -0500] yfeldblum: xuru, you can enumerate the data-bag names with Chef::DataBag.list
[2012-12-21 15:53:14 -0500] xuru: yfeldblum: and wrap it in a begin/rescue?
[2012-12-21 15:53:33 -0500] yfeldblum: xuru, no, as i said, you can get a list of the data-bags that way
[2012-12-21 15:53:35 -0500] xuru: hikeit: thanks, I didn't know that
[2012-12-21 15:53:51 -0500] xuru: oh, list of all data bags.  ok, cool
[2012-12-21 15:53:51 -0500] yfeldblum: xuru, you can try to enumerate the items in a data-bag with data_bag("bag-name") or Chef::DataBag.load("bag-name")
[2012-12-21 15:54:29 -0500] yfeldblum: xuru, those will raise if the data-bag doesn't exist, but if you've already enumerated the data-bags and checked that the one you want exists, it should typically not raise
[2012-12-21 15:54:55 -0500] xuru: ok, great, thank you
[2012-12-21 15:56:13 -0500] xuru: I'll have to check if admin is an option to knife ec2 bootstrap...
[2012-12-21 15:58:41 -0500] xuru: Perhaps you guys could give me some advice  I have a large number of servers around the US that I want to install openvpn on.  I'm creating several vpn servers to handle the large number of clients.  I was thinking of putting the servers and VPN server into the same role to group them.
[2012-12-21 15:58:52 -0500] yfeldblum: xuru, however, i would say it's bad form to write to a data-bag item from a recipe
[2012-12-21 15:59:21 -0500] xuru: The vpn server then loops through the clients, and checks if the keys have been generated, creates them and stuffs them in an encrypted databag to be consumed by the client
[2012-12-21 15:59:39 -0500] yfeldblum: xuru, the typical scenario is that the sysadmin writes the data-bag item using knife or using some other tool, and then the recipe reads it and may cache some data on the node attributes but not on the data-bag item
[2012-12-21 16:00:40 -0500] yfeldblum: xuru, one key or one key per client?
[2012-12-21 16:01:13 -0500] xuru: I believe that there are three keys that each openvpn client needs
[2012-12-21 16:02:28 -0500] xuru: would it be better to package it up, and put it on a protected ftp/http server for the client to fetch instead of using a data bag?
[2012-12-21 16:03:11 -0500] xuru: I suppose I just answered my own question
[2012-12-21 16:05:16 -0500] yfeldblum: xuru, you could do that
[2012-12-21 16:05:57 -0500] yfeldblum: xuru, are these public-private key-pairs?
[2012-12-21 16:06:22 -0500] xuru: yes
[2012-12-21 16:06:58 -0500] yfeldblum: xuru, and the openvpn client needs the private key while the openvpn server needs the public key?
[2012-12-21 16:08:58 -0500] xuru: yfeldblum: there is a client.crt, client.key and ca.crt
[2012-12-21 16:09:08 -0500] xuru: that needs to be on the client side
[2012-12-21 16:10:56 -0500] yfeldblum: xuru, so the client certificate needs to be signed by an authority that the openvpn server trusts
[2012-12-21 16:11:00 -0500] yfeldblum: xuru, ?
[2012-12-21 16:11:05 -0500] xuru: yep
[2012-12-21 16:11:14 -0500] xuru: and client.key is it's private key
[2012-12-21 16:11:49 -0500] xuru: the ca file is needed for TLS
[2012-12-21 16:12:33 -0500] xuru: as well as the signed certificate and private key
[2012-12-21 16:12:36 -0500] geekbri: hikeit: I've had to make a handeful of modifications because of undocumented changes.  Granted I was also using things in ways maybe they werent intended to be used.
[2012-12-21 16:13:01 -0500] hikeit: geekbri: anything you can think of?
[2012-12-21 16:13:45 -0500] geekbri: hikeit: I found that in chef 0.10.8 a call to a resource would return the last statement of the associated action.  In the newer versions of chef that is no longer true.  There is now a method called "cleanup_after_converge".  The last statement of that method is what is returned by a resource
[2012-12-21 16:13:46 -0500] hikeit: geekbri: comparing nodes is one thing i've come across so far should be comparing the node names, but my coworker didn't think about it and it "worked"
[2012-12-21 16:14:01 -0500] xuru: yfeldblum: so firing off openvpn may look something like:  openvpn --remote june.kg --dev tun1 --ifconfig 10.4.0.1 10.4.0.2 --tls-client --ca ca.crt --cert client.crt --key client.key --reneg-sec 60 --verb 5
[2012-12-21 16:14:12 -0500] geekbri: hikeit: Currently one of our cookbooks that involves users is busted as well, but I haven't had time to investigate due to other higher priority things breaking :)
[2012-12-21 16:14:49 -0500] yfeldblum: xuru, key management is fun
[2012-12-21 16:15:01 -0500] xuru: yeah :(
[2012-12-21 16:15:15 -0500] xuru: that's why I am hoping to automate most of it
[2012-12-21 16:15:41 -0500] xuru: I still have to figure out how to revoke a key if that server is removed for what ever reason
[2012-12-21 16:15:50 -0500] xuru: automatically...
[2012-12-21 16:16:19 -0500] hikeit: xuru: you could give just one machine admin rights, and have it generate all the databag items one of the reasons to not allow recipes to write to data bags is that if you have more than one, they can overwrite each other without you realizing it
[2012-12-21 16:16:34 -0500] yfeldblum: xuru, 1) blacklists; 2) very short certificate validities and continuous re-signing
[2012-12-21 16:16:53 -0500] xuru: yfeldblum: ah, good idea
[2012-12-21 16:17:22 -0500] xuru: hikeit: That's what I was kind of thinking.  The VPN servers would have admin, and all the remote servers not
[2012-12-21 16:17:52 -0500] hikeit: xuru: they you're still giving multiple machines access to write are they all touching distinct data bags?
[2012-12-21 16:18:07 -0500] yfeldblum: xuru, http://en.wikipedia.org/wiki/Revocation_list http://en.wikipedia.org/wiki/Online_Certificate_Status_Protocol
[2012-12-21 16:19:00 -0500] xuru: hikeit: good point, perhaps I could do this as a recipe on the chef server it's self...
[2012-12-21 16:19:10 -0500] xuru: a little book keeping
[2012-12-21 16:19:19 -0500] yfeldblum: xuru, you may want to write a separate cert-signing service that runs on the openvpn servers and can check things e.g. the machine talking to it is talking from within the network
[2012-12-21 16:19:46 -0500] xuru: yfeldblum: I know how to revoke certs, just have to work out the logistics
[2012-12-21 16:20:02 -0500] yfeldblum: xuru, or just have a completely separate PKI
[2012-12-21 16:20:09 -0500] xuru: yfeldblum: true
[2012-12-21 16:20:43 -0500] xuru: hmm  sounds like a good job for the chef server as well
[2012-12-21 16:21:07 -0500] xuru: that is where i have the https site for artifacts anyway
[2012-12-21 16:21:22 -0500] yfeldblum: xuru, you can likely do something similar to writing data-bag items but ... using a separate db instead, like postgres
[2012-12-21 16:21:41 -0500] xuru: it could run through the list of server/VPN servers, and do the certs management which would be downloadable from the client
[2012-12-21 16:22:57 -0500] xuru: The programmer side of me wants to bend data bags to my will ;)  but a signed downloadable package containing the certs would probably be the best route
[2012-12-21 16:23:29 -0500] xuru: sweet, thanks for all the ideas guys
[2012-12-21 16:29:09 -0500] yfeldblum: xuru, data-bags don't work that way, so i'd avoid that route, but you can replace the data-bags strategy with postgres
[2012-12-21 16:29:41 -0500] qhartman: If I'm doing some poking around with shef, should I expect all the normal node attributes to be loaded as they would be during a chef a run?
[2012-12-21 16:30:15 -0500] xuru: yfeldblum: ok, that sounds reasonable
[2012-12-21 16:30:34 -0500] xuru: qhartman: run is with -z for client mode
[2012-12-21 16:30:54 -0500] xuru: that will pull in all the recipes from the chef server
[2012-12-21 16:31:01 -0500] qhartman: xuru, oh that's right! thanks for the reminder
[2012-12-21 16:31:02 -0500] xuru: if you're running it on a client
[2012-12-21 16:31:07 -0500] xuru: np
[2012-12-21 16:31:42 -0500] xuru: I forget all the time too, until I made an alias ;)
[2012-12-21 16:32:11 -0500] qhartman: I'm just glad there's a good explanation for it not doing at all what I expected it to
[2012-12-21 16:53:29 -0500] moos3: how can i set the interval in client.rb
[2012-12-21 16:55:15 -0500] Maniacal: We have a strange issue with chef saving to the cache.  We have an lwrp that pulls files from our internal stores when needed.  We're pulling down a jdk binary.  The resource doesn't error out and notifies the unpack resource to unpack the file but the file isn't there (/var/chef/cache) so the chef run bombs out. The stacktrace is written to /var/chef/cache but the failed-run-data.json is not.  has anyone experienced this.  Or does the fact
[2012-12-21 16:55:15 -0500] Maniacal: that chef CAN write the stacktrace to cache but CANT write the failed-run-data.json give any clues to what's going on?
[2012-12-21 16:55:45 -0500] xuru: moos3: http://docs.opscode.com/config_rb_client.html
[2012-12-21 16:56:09 -0500] Maniacal: running on oel 5.6 using chef 10.12.0
[2012-12-21 16:56:12 -0500] amccloud: What would cause include_recipe to run out of order? https://gist.github.com/543b5d20b0f0963f379c Looking at the line right after WARN: Missing gem 'right_aws'
[2012-12-21 16:56:15 -0500] moos3: xuru thansk
[2012-12-21 16:56:18 -0500] xuru: np
[2012-12-21 16:56:57 -0500] amccloud: postgresql::ruby appears to always run first when it is included
[2012-12-21 17:03:08 -0500] moos3: anyone notice that the client-client daemon uses like 120Mb of memory right off the bat
[2012-12-21 17:03:11 -0500] xuru: amccloud: not sure without seeing the cookbook
[2012-12-21 17:03:30 -0500] amccloud: xuru: https://github.com/opscode-cookbooks/postgresql
[2012-12-21 17:03:58 -0500] amccloud: I think it's because it does require 'pg'
[2012-12-21 17:04:05 -0500] amccloud: and catches that exception
[2012-12-21 17:04:32 -0500] amccloud: but I see there that the first thing it tries to do is include build-essentials
[2012-12-21 17:04:55 -0500] amccloud: but I don't see that step in the log at all
[2012-12-21 17:05:13 -0500] amccloud: i'm using debian
[2012-12-21 17:07:41 -0500] xuru: amccloud: I'm not sure  I remember running into some of the same kind of things, but I don't remember how we resolved it
[2012-12-21 17:08:45 -0500] amccloud: doh!
[2012-12-21 17:09:33 -0500] xuru: amccloud: ?
[2012-12-21 17:09:59 -0500] xuru: In our role we include build-essentials early in our run_list
[2012-12-21 17:12:32 -0500] amccloud: Hmm, I can try that but it seems like it might still be too late
[2012-12-21 17:27:37 -0500] amccloud: xuru: that may have worked.
[2012-12-21 17:29:18 -0500] xuru: amccloud: still wonder why though ;)
[2012-12-21 17:30:26 -0500] moos3: is there away with with chef_gem or gem_package to only install if missing
[2012-12-21 17:31:55 -0500] xuru: the install action in gem_package automatically checks if it's already installed
[2012-12-21 17:32:16 -0500] xuru: at least I thought it did
[2012-12-21 17:32:58 -0500] moos3: everytime the client runs it trys to install a gem thats listed
[2012-12-21 17:35:18 -0500] xuru: moos3: is there an error?  are you using rvm?
[2012-12-21 17:35:31 -0500] moos3: nah using native ruby on this test box
[2012-12-21 17:35:40 -0500] moos3: just sits there for a while
[2012-12-21 17:37:54 -0500] xuru: moos3: not sure  chef_gem is used for installing gems that recipes need, and will install immediately
[2012-12-21 17:38:02 -0500] moos3: yea
[2012-12-21 17:38:28 -0500] moos3: my test box is getting ready to check back in so i'll let you know if theres a error
[2012-12-21 17:39:25 -0500] xuru: you can always run it by hand with debug as well   chef-client -l debug
[2012-12-21 17:45:48 -0500] moos3: xuru oh yea i forgot about that
[2012-12-21 17:46:21 -0500] moos3: the memory usage on chef is a bit high I noticed about 300M after 1 hr of running
[2012-12-21 17:49:43 -0500] kallistec: moos3: I've heard that some popular cookbooks may have memory leaks. You can try running chef with --fork to work around it
[2012-12-21 17:50:14 -0500] moos3: yeah 10.16.2 on redhat seems to default to --fork
[2012-12-21 17:50:47 -0500] moos3: is there away to make a cookbook only restart a service if there was a change made ?
[2012-12-21 17:51:12 -0500] xuru: Interesting  we ran into that too, and finally just respawn the client every 30 mins
[2012-12-21 17:51:54 -0500] xuru: moos3: define your service with action :nothing
[2012-12-21 17:52:18 -0500] xuru: moos3: then in other resources that require a restart, set notify   :restart
[2012-12-21 17:52:50 -0500] programmerq: Is there a proper channel to call attention to an issues? https://github.com/opscode-cookbooks/database/pull/24
[2012-12-21 17:53:28 -0500] agoddard_: programmerq: http://tickets.opscode.com/browse/COOK
[2012-12-21 18:04:21 -0500] moos3: xuru you can make a template run do a notify ?
[2012-12-21 18:05:37 -0500] jflowers: can I progromatically access the version of the current cookbook?
[2012-12-21 18:09:01 -0500] amccloud: Does the Securable mixin support setuid bit for mode? I keep running into Chef::Exceptions::ValidationFailed: Option mode's value 4774 not in valid numeric range. i'm not a ruby programmer so i'm having a hard time deciphering what's going on here https://github.com/opscode/chef/blob/master/lib/chef/mixin/securable.rb#L46
[2012-12-21 18:09:58 -0500] dekhaus: Hi All.  Im completely new to Chef and have a few questions.
[2012-12-21 18:09:59 -0500] dekhaus: Over the last year or so  Ive developed an installer for my Rails apps. The key requirement was that this installer needed to be able to function off line  aka on a server not connected to the internet. The biggest consequence of this requirement (not made up by me) is that all the resources that the installer needs need to be available on a CD / iso image. So what I do is essentially create a shell script that installs
[2012-12-21 18:10:00 -0500] dekhaus: everything from a local directory. This directory is created by another program Ive created that essentially builds the installer.
[2012-12-21 18:10:01 -0500] dekhaus: Id like to know if I can some how use Chef to create a chef recipe that only access resources locally (i.e. NOT from the internet). Ideally  there would be a way to run this recipe first so that all the resources could be retrieved from the internet and stored locally for later use.
[2012-12-21 18:10:02 -0500] dekhaus: Hopefully this makes sense and hopefully this is possible with Chef.
[2012-12-21 18:10:47 -0500] zts: amccloud: I think you need either "4774" or 04774 (ie, if it's a number not a string, it has to start with a 0)
[2012-12-21 18:10:59 -0500] moos3: dekhaus you need to just create a local mirror of those resources
[2012-12-21 18:11:02 -0500] amccloud: zts: thanks
[2012-12-21 18:11:10 -0500] moos3: then write your recipe to call that localized mirror
[2012-12-21 18:12:06 -0500] moos3: for example where I work, we have a rhel mirror of all updates and packages we need, we just point a repo file to that so when yum hits it, it will pull on the local network
[2012-12-21 18:15:39 -0500] eliklein: does anyone use the opscode apache2 cookbook alongside the logrotate cookbook?
[2012-12-21 18:15:51 -0500] eliklein: it doesn't work out of the box, unless there's something stupid that I'm missing
[2012-12-21 18:16:01 -0500] xmltok: can you dynamically include_recipe's if they are not part of the metadata dependencies or role?
[2012-12-21 18:16:08 -0500] eliklein: it appears logrotate requires a path, which the apache2::logrotate recipe doesn't provide
[2012-12-21 18:16:12 -0500] dekhaus: thanks
[2012-12-21 18:16:24 -0500] xmltok: basically i would like to have a default role or cookbook applied to all of my nodes that is then in charge of determining which cookbooks/recipes to load for a host, dependent on the hostname
[2012-12-21 18:17:04 -0500] xmltok: right now i have one large cookbook with all of the different recipes and trigger them based on a hostname regex, but it would be nice if i could keep each host based set of recipes in their own cookbooks
[2012-12-21 18:29:45 -0500] tamouse__: hi all, looking for some help while my devops guy is out of town. :)
[2012-12-21 18:30:47 -0500] tamouse__: i am trying to find out: is it possible to run a single step, in this case, doing some git fetches, that use a key stored in an encrypted databag
[2012-12-21 18:36:54 -0500] tamouse__: too odd a question? :)
[2012-12-21 18:41:08 -0500] moos3: xmltok its called roles :D
[2012-12-21 18:42:36 -0500] xmltok: roles are not version controlled and i cant assign roles by code
[2012-12-21 18:43:06 -0500] tamouse__: i'm kind of assuming it would be knife exec, but i don't quite understand how to do it...
[2012-12-21 18:43:48 -0500] qhartman: xmltok, My roles are in VCS with everything else
[2012-12-21 18:44:11 -0500] w6fu: tamouse__, you would have to write in exclusions in the recipe
[2012-12-21 18:44:42 -0500] moos3: xmltok git-izer them or svn them,
[2012-12-21 18:44:48 -0500] xmltok: what if you build out a bunch of nodes now and then decide that you would like to use a different role for that class of node in the future, you crawl your old nodes and look for the role then change them?
[2012-12-21 18:45:00 -0500] xmltok: in code you could just change the rule that applies the cookbook
[2012-12-21 18:45:02 -0500] w6fu: you could copy the recipe to a new one, and only add in the parts you want but your devops guy may or may not appreciate it :-)
[2012-12-21 18:45:18 -0500] moos3: xmltok you can change roles on the fly
[2012-12-21 18:45:29 -0500] xmltok: you still need to crawl your ecosystem looking for nodes to change
[2012-12-21 18:45:35 -0500] xmltok: its a bad practice
[2012-12-21 18:45:38 -0500] zts: xmltok: the problem you'll have to deal with is getting the cookbooks downloaded onto the node - you can't include_recipe if you don't have a local copy of the cookbook containing it, and chef-client will only download the cookbooks found in the expanded run list
[2012-12-21 18:45:57 -0500] moos3: like I bootstrap all nodes with -r 'role[base]' but then I can difine if node.name regex addition roles
[2012-12-21 18:46:02 -0500] zts: xmltok: I expect you can jump through some hoops to get around that problem, but I don't know what they are
[2012-12-21 18:46:13 -0500] qhartman: xmltok, what I do to handle that situation is modify the recipes / cookbooks / roles included by the role that is already on the machine
[2012-12-21 18:46:52 -0500] qhartman: Once a machine has a role, it keeps it unless the purpose of the machine changes completely. In that case I usually just destroy the instance and build a new one
[2012-12-21 18:47:01 -0500] tamouse__: w6fu: my devops guy is scary ....
[2012-12-21 18:47:24 -0500] xmltok: im dealing with thousands of nodes and many people working on these things, i cant trust that those kinds of manual steps would work
[2012-12-21 18:47:28 -0500] qhartman: speaking as a devops guy, if we're being scary, we're not foing our job.
[2012-12-21 18:47:34 -0500] xmltok: but i see how you would do that
[2012-12-21 18:47:47 -0500] tamouse__: qhartman: it's okay, we're pretty cool. :)
[2012-12-21 18:47:58 -0500] qhartman: :D
[2012-12-21 18:48:00 -0500] moos3: xmltok you can use the chefgem and write a wrapper script
[2012-12-21 18:48:18 -0500] tamouse__: qhartman: he probably wouldn't mind if i did write a new recipe, just make sure to delete, alter or muck with his
[2012-12-21 18:48:19 -0500] xmltok: a wrapper around chef-client?
[2012-12-21 18:48:21 -0500] qhartman: xmltok, how many people do you have working on your chef stuff?
[2012-12-21 18:48:34 -0500] xmltok: roughly 10 across continents and offices
[2012-12-21 18:48:36 -0500] tamouse__: i've been writing recipes under his guidance as it is, but he's gone now and i need to get something working
[2012-12-21 18:48:47 -0500] tamouse__: only thing worse than devops: being in qa
[2012-12-21 18:48:52 -0500] tamouse__: (not really, i love it)
[2012-12-21 18:49:02 -0500] qhartman: I have that many as well, and the process works fine so long as everything is in VCS.
[2012-12-21 18:49:15 -0500] qhartman: If someone doesn't follow the process , the ax falls on their head
[2012-12-21 18:49:57 -0500] tamouse__: let me ask this another way: one particular step isn't working, and i'd like to just run that step; is there a way i can do that?
[2012-12-21 18:50:21 -0500] qhartman: Powerful tools necessarily have pointy bits, you can't always protect everyone from themselves. There comes a point where they have to use it correctly, or lose a finger.
[2012-12-21 18:50:39 -0500] tamouse__: qhartman: this is how we develop craftspeople :)
[2012-12-21 18:50:41 -0500] w6fu: tamouse__, have you used chef-client -l debug?
[2012-12-21 18:50:52 -0500] tamouse__: oh, no, w6fu -- i'll give that go
[2012-12-21 18:51:06 -0500] qhartman: tamouse__, indeed
[2012-12-21 18:51:13 -0500] xmltok: true, but i dont see the reason why it wouldnt just be better to control roles or loaded cookbooks via code rather than configuration
[2012-12-21 18:51:39 -0500] w6fu: tamouse__, also check  /var/log/chef/client.log
[2012-12-21 18:51:56 -0500] tamouse__: i did take a look at that, actually, also the .json dump
[2012-12-21 18:51:57 -0500] bubuz:  https://gist.github.com/4354905 < hi guys, can anyone helpe me refactor this? Could I put it in an array? Am new to chef, and ruby :)
[2012-12-21 18:52:06 -0500] tamouse__: i know what's failing, but i'm not sure why
[2012-12-21 18:52:49 -0500] qhartman: xmltok, well, maybe there isn't, but at some point somebody has to decide what goes on which box. In chef, one uses the runlist to define that, and the method for building the runlist is with roles.
[2012-12-21 18:53:03 -0500] qhartman: xmltok, maybe you want to generate roles programmatically?
[2012-12-21 18:53:34 -0500] xmltok: thats effectively what i have done using one large cookbook, i have one 'base' role which everything gets and it includes a cookbook with role specific logic
[2012-12-21 18:53:52 -0500] xmltok: mainly because i dont want to trust that if i used roles the roles would be correct on each node, since they would all be done by hand
[2012-12-21 18:54:01 -0500] qhartman: xmltok, you could even programmitcally define each node and build the runlist with just recipes and skip roles if you wanted to, but you're losing a lot of power by going that route
[2012-12-21 18:54:55 -0500] tamouse__: *sigh*
[2012-12-21 18:55:06 -0500] qhartman: xmltok, I disagree with your reasoning, but it sounds like you have a solution given what you've said. What are you missing?
[2012-12-21 18:55:10 -0500] tamouse__: still don't know what exactly is going wrong
[2012-12-21 18:55:21 -0500] tamouse__: this is during a git fetch
[2012-12-21 18:55:32 -0500] tamouse__: it says it can't find a specific hash
[2012-12-21 18:55:51 -0500] xmltok: what i dont like about my solution now is that my cookbook will contain too much logic at some point, it would be better split up amongst the different roles
[2012-12-21 18:55:53 -0500] tamouse__: the problem i'm having is that i don't know *why* it can't find that hash
[2012-12-21 18:55:57 -0500] tamouse__: i can find it in the repo
[2012-12-21 18:56:04 -0500] tamouse__: err... the github depot, i mean
[2012-12-21 18:56:06 -0500] qhartman: xmltok, fat cookbooks are fine
[2012-12-21 18:56:06 -0500] xmltok: anyway, the real problem is that there is no way to programatically determine a role, so i cant use roles
[2012-12-21 18:56:13 -0500] w6fu: tamouse__, using the git resource?
[2012-12-21 18:56:26 -0500] xmltok: fat cookbooks make checkouts long and only increase the amount of crap shoved onto each node for every run
[2012-12-21 18:56:32 -0500] tamouse__: and i think the problem is that it's pulling the wrong branch, because all i've got specified is a tag
[2012-12-21 18:56:37 -0500] qhartman: xmltok, not within chef, no.
[2012-12-21 18:56:48 -0500] tamouse__: i am pretty sure 'yes' w6fu
[2012-12-21 18:57:17 -0500] qhartman: xmltok, but by how much? I mean really, unless you are including a ton of extra files, it can't be more than a few k per node.
[2012-12-21 18:57:19 -0500] bubuz: anyone? :(
[2012-12-21 18:57:54 -0500] xmltok: its not enough for me to try and make it better, i suppose
[2012-12-21 18:58:06 -0500] tamouse__: this is what's in the node:
[2012-12-21 18:58:09 -0500] tamouse__:     "rails": {
[2012-12-21 18:58:09 -0500] tamouse__:       "branch": "Qnext",
[2012-12-21 18:58:09 -0500] tamouse__:       "rake_tasks": [
[2012-12-21 18:58:09 -0500] tamouse__:         "assets:precompile",
[2012-12-21 18:58:10 -0500] tamouse__:         "db:migrate",
[2012-12-21 18:58:11 -0500] tamouse__:         "data:migrate"
[2012-12-21 18:58:14 -0500] tamouse__:       ],
[2012-12-21 18:58:16 -0500] tamouse__:       "last_install": "2012-12-13 19:33:31 +0000",
[2012-12-21 18:58:17 -0500] xmltok: it feels dirty, and it feels like chef is lacking on the role configuration management, but i dont care enough to write a fix for it.. :)
[2012-12-21 18:58:19 -0500] tamouse__:       "installed_sha": "823400ddef2031d6b611d49aea24d69cc7acdcf1"
[2012-12-21 18:58:20 -0500] qhartman: xmltok, and if you are including a bunch of cookbook files, you really shouldn't be. Put those up in some sort of http repo and pull them down using the remote_file resource
[2012-12-21 18:58:21 -0500] tamouse__:     },
[2012-12-21 18:58:24 -0500] tamouse__: (sorry for the flood)
[2012-12-21 18:58:59 -0500] xmltok: for configuration files? and have people update git hash links in the cookbooks?
[2012-12-21 18:59:06 -0500] tamouse__: if i look at the repo on the target server, the branch that is checked out isn't the one i want it to be
[2012-12-21 19:01:57 -0500] tamouse__: oh, the repo on the target server is just a shallow clone as well
[2012-12-21 19:02:43 -0500] tamouse__: this started breaking because i used a tag instead of an actual branch name :(
[2012-12-21 19:02:48 -0500] tamouse__: i'm not super up on git
[2012-12-21 19:02:57 -0500] tamouse__: and definitely not up on chef
[2012-12-21 19:03:56 -0500] tamouse__: the node i copied this from just pulled the head of the 'develop' branch
[2012-12-21 19:04:16 -0500] tamouse__: i want mine to pull the tagged commit from a 'next-release' branch
[2012-12-21 19:04:55 -0500] w6fu: tamouse__, yay new features for everyone today! Wish I could be of more use, not familar with how all of that works eather.
[2012-12-21 19:05:27 -0500] w6fu: errr either*
[2012-12-21 19:05:28 -0500] tamouse__: you gave some good help already, thank you
[2012-12-21 19:05:34 -0500] mattray: close to releasing spiceweasel 2.0, maybe I should put out 1.99 first
[2012-12-21 19:06:41 -0500] Maniacal: We have a strange issue with chef saving to the cache.  We have an lwrp that pulls files from our internal stores when needed.  We're pulling down a jdk binary.  The resource doesn't error out and notifies the unpack resource to unpack the file but the file isn't there (/var/chef/cache) so the chef run bombs out. The stacktrace is written to /var/chef/cache but the failed-run-data.json is not.  has anyone experienced this.  Or does the fact
[2012-12-21 19:06:42 -0500] Maniacal: that chef CAN write the stacktrace to cache but CANT write the failed-run-data.json give any clues to what's going on?
[2012-12-21 19:07:44 -0500] j-v-e: Howdy Chefs
[2012-12-21 19:08:13 -0500] bubuz: howdy
[2012-12-21 19:08:25 -0500] j-v-e: I just released v0.0.5 of the AFW cookbook, with a boatload of changes . see http://community.opscode.com/cookbooks/afw and https://github.com/jvehent/AFW/commits/master for the detail
[2012-12-21 19:09:25 -0500] bubuz: hi guys, can anyone helpe me refactor this? Could I put it in an array? Am new to chef, and ruby  https://gist.github.com/4354905 :)
[2012-12-21 19:12:44 -0500] JasonF: In chef, if I use remote_directory, will it traverse and copy over subdirectories recursively?
[2012-12-21 19:14:27 -0500] ashb: JasonF: probably
[2012-12-21 19:14:46 -0500] JasonF: the documentation was a little unclear, but the answer appeared to be yes
[2012-12-21 19:15:01 -0500] tamouse__: bubuz: i don't know if that's worth refactoring...
[2012-12-21 19:16:46 -0500] bubuz: its for my graphite server so there are going to be a load more blocks in there if i dont
[2012-12-21 19:16:55 -0500] bubuz: thats just for the cpu block!
[2012-12-21 19:18:49 -0500] tamouse__: but it's just a data declaration...
[2012-12-21 19:19:06 -0500] tamouse__: maybe there's some opportunity for drying things between various blocks?
[2012-12-21 19:20:05 -0500] bubuz: hmm, there must be a way using chef/ruby to loop back over rather than having to write out a bucket load of similar blocks
[2012-12-21 19:21:11 -0500] maplebed: you mean like [list].each {|elem| blah }?
[2012-12-21 19:22:11 -0500] bubuz: yeah
[2012-12-21 19:22:14 -0500] bubuz: something like that
[2012-12-21 19:22:38 -0500] bubuz: i have similar for about 7 different dashboard components
[2012-12-21 19:25:39 -0500] tamouse__: bubuz: maybe: https://gist.github.com/4354905/#comment-664657 ?
[2012-12-21 19:26:28 -0500] tamouse__: just wrote it out by hand, not tested
[2012-12-21 19:28:00 -0500] tamouse__: *sigh*
[2012-12-21 19:29:25 -0500] bubuz: thats great thanks tamouse__
[2012-12-21 19:29:49 -0500] bubuz: and ashb :)
[2012-12-21 19:29:56 -0500] bubuz: i will give it a go
[2012-12-21 19:34:27 -0500] bubuz: ashb what will the colours.keys.each do |s| bit do?
[2012-12-21 19:34:42 -0500] ashb: its the same as %w{idle system interrupt nice softirq steal user wait}
[2012-12-21 19:34:44 -0500] bubuz: ruby is so awesome but i just dont get it :(
[2012-12-21 19:34:52 -0500] ashb: returns an array of all the keys in the hash
[2012-12-21 19:35:04 -0500] ashb: rather than having the same list twice (once in the hash, once in the each loop)
[2012-12-21 19:36:21 -0500] bubuz: so I dont need the %w{idle system interrupt nice softirq steal user wait} if I use colours.keys.each do |s| ?
[2012-12-21 19:36:30 -0500] ashb: correct
[2012-12-21 19:36:37 -0500] ashb: that entire line can be replaced with the one in my comment
[2012-12-21 19:38:16 -0500] bubuz: hmm, but I don't get if I do that (which sounds great), how will it even know that I want idle, system, interrupt etc..?
[2012-12-21 19:38:29 -0500] bubuz: ah the keys!
[2012-12-21 19:38:32 -0500] bubuz: sorry gotcha now
[2012-12-21 19:38:40 -0500] bubuz: key => value ;)
[2012-12-21 19:42:35 -0500] bubuz: and ashb, for my other dashboard_components, I take it I will need to reset the colours for that block too?
[2012-12-21 19:43:52 -0500] bubuz: thats excellent, thank you guys :)
[2012-12-21 19:45:24 -0500] bubuz: can i have multiple keys pointing to the same value?
[2012-12-21 19:45:31 -0500] bubuz: im guessing not
[2012-12-21 19:47:25 -0500] tamouse__: sure you can
[2012-12-21 19:47:57 -0500] tamouse__: myhash{:label1 => 'abc', :label2 => 'abc'}
[2012-12-21 19:48:04 -0500] tamouse__: ?
[2012-12-21 19:48:13 -0500] bubuz: so rather than having to redo the colours block for my other dashboard components, I can just put multiples in that block?
[2012-12-21 19:48:15 -0500] bubuz: i.e.
[2012-12-21 19:49:12 -0500] bubuz: 'idle', 'df', 'load' => 'red' ?
[2012-12-21 19:51:40 -0500] tamouse__: not if you're planning on doing the colours.keys.each thing
[2012-12-21 19:51:53 -0500] tamouse__: so i named that colours as a convenience
[2012-12-21 19:51:58 -0500] bubuz: no ok that makes sense :)
[2012-12-21 19:52:03 -0500] tamouse__: you may want to set it up differently
[2012-12-21 19:52:36 -0500] bubuz: ok will have a look
[2012-12-21 19:52:44 -0500] bubuz: prob back for help soon! thanks :)
[2012-12-21 19:58:25 -0500] tamouse__: https://gist.github.com/4354905/#comment-664703 bubuz
[2012-12-21 19:58:40 -0500] tamouse__: i'm sure that can be improved on as well
[2012-12-21 19:58:51 -0500] tamouse__: maybe a map! or something?
[2012-12-21 20:08:11 -0500] j-v-e: AFW 0.0.5 blog post: http://jve.linuxwall.info/blog/index.php?post/2012/12/21/AFW-0.0.5-is-out-!
[2012-12-21 20:40:38 -0500] j-v-e: I haven't had much time to follow the news lately... anything new about chef 11 ?
[2012-12-21 20:47:09 -0500] kallistec: j-v-e: it's coming along. Nightly server builds are available: http://wiki.opscode.com/display/chef/Chef+11+Server+Preview
[2012-12-21 20:47:23 -0500] kallistec: no client alpha/beta released yet, but we're getting closer
[2012-12-21 20:47:54 -0500] kallistec: most of the team will be out for holidays, so probably some time in january for official client prerelease
[2012-12-21 20:47:59 -0500] j-v-e: I should give it a shot
[2012-12-21 20:48:55 -0500] kallistec: no more breaking changes are going in, so this should be the final list of those: http://wiki.opscode.com/display/chef/Breaking+Changes+in+Chef+11
[2012-12-21 20:53:09 -0500] tamouse__: ok, i think i've figured out my problem. i just don't have an answer yet :(
[2012-12-21 20:54:03 -0500] tamouse__: this line: "branch": "Qnext" -- is used to set revision in the application cookbook
[2012-12-21 20:54:20 -0500] tamouse__: i need to figure out how to specify both the branch name AND the tag name
[2012-12-21 20:56:59 -0500] kallistec: tamouse__: branch names and tag names are just pointers to a commit
[2012-12-21 20:58:24 -0500] kallistec: tamouse__: e.g., if you have og_branch then checkout -b another_branch and then tag with "some_tag", then og_branch, another_branch and some_tag all have identical code pointed at the same commit
[2012-12-21 20:59:57 -0500] kallistec: and further, it doesn't make sense to talk about what branch the tag is on, because any number of branches may have that same commit
[2012-12-21 21:00:18 -0500] jtimberman: Happy Friday! @Opscode COOK code review starting now, hangout: https://plus.google.com/hangouts/_/3e77184e8804817de0b4d9dcf289c211232603a3 live youtube: http://www.youtube.com/watch?v=nievvCoURG4 #opschef
[2012-12-21 21:00:38 -0500] kallistec: or you could delete all the branches that have that commit and then there's zero
[2012-12-21 21:05:31 -0500] moos3: how can i check if array in a template file
[2012-12-21 21:06:30 -0500] eka: moos3: myarray.is_a? Array
[2012-12-21 21:06:49 -0500] eka: moos3: you can write ruby code in a template file
[2012-12-21 21:07:19 -0500] moos3: as long as its in <% %> right ?
[2012-12-21 21:07:39 -0500] eka: moos3: yes
[2012-12-21 21:21:26 -0500] tamouse__: ok, found out the *real* problem
[2012-12-21 21:21:35 -0500] tamouse__: when the deploy runs, it does a shallow clone
[2012-12-21 21:22:10 -0500] tamouse__: i need it to be a deep clone to checkout a different branch with a tag that will not be in the shallow clone
[2012-12-21 21:30:56 -0500] geekbri__: I've got a question for people using a chef server per environment and "site-cookbooks".  How do you deal with the site-cookbooks directory?  You obviously have unique data per chef server like the data bags, but what about the shared site-cookbook cookbooks
[2012-12-21 21:34:53 -0500] ranjib_: geekbri__, berkshelf , librarian ?
[2012-12-21 21:35:23 -0500] geekbri__: ranjib_: Yeah Im already using librarian, this is useful for cookbooks that are individual projects in say github.  We have, say like, 10 or so cookbooks in site-cookbooks
[2012-12-21 21:35:41 -0500] geekbri__: so now if i have a second chef-server and its files are on a seperate git branch
[2012-12-21 21:35:59 -0500] geekbri__: then when I modify a cookbook in site cookbooks there is no good way to merge that coookbook to the other branch (other than say cherry pick but that is a crappy work flow)
[2012-12-21 21:36:24 -0500] geekbri__: so I'm trying to think of how to handle the site-cookbooks directory that doesn't involve turning those 10 cookbooks into 10 individual git repositroies
[2012-12-21 21:36:27 -0500] geekbri__: repositories
[2012-12-21 21:37:26 -0500] ranjib_: geekbri__, do you use cookbook versioning ? I can think of using versions of cookbooks, and leveraging them in chef nvironments
[2012-12-21 21:37:32 -0500] ranjib_: *environments
[2012-12-21 21:38:02 -0500] geekbri__: ranjib_: I do use cookbook versioning, we currently are using environments but for us it is a better fit to have a chef server per environment
[2012-12-21 21:38:11 -0500] geekbri__: due to many reasons that im too lazy to go into at the moment
[2012-12-21 21:38:21 -0500] ranjib_: i cant think of any good ways to do this. and we suffer from the exact stuff
[2012-12-21 21:38:40 -0500] yfeldblum: geekbri__, dump environments, use multiple chef-servers :D
[2012-12-21 21:38:43 -0500] geekbri__: site-cookbooks could be its own repo and sub model, but that sucks
[2012-12-21 21:38:45 -0500] geekbri__: yfeldblum: thats what im doing
[2012-12-21 21:38:51 -0500] geekbri__: yfeldblum: but what to do about site-cookbooks
[2012-12-21 21:39:11 -0500] geekbri__: yfeldblum: git branch per chef-server for our ops repo.  But what about our non public cookbooks that are in site-cookbooks.
[2012-12-21 21:39:39 -0500] geekbri__: yfeldblum: there is no nice way to modified one and then get it to each of the branches.  I guess you could only modify the cookbooks on the "master" branch then merge that to the chef server specific barnches
[2012-12-21 21:39:41 -0500] geekbri__: that seems eh
[2012-12-21 21:39:52 -0500] ranjib_: yeah.. without versioning its pita
[2012-12-21 21:40:17 -0500] yfeldblum: geekbri__, i like it
[2012-12-21 21:40:35 -0500] yfeldblum: geekbri__, git has plenty of tools to help you find diffs between branches
[2012-12-21 21:40:35 -0500] ranjib_: with version u can use it in either chef_environments, or at least directly in run list, for explicitly specifying the version
[2012-12-21 21:40:43 -0500] geekbri__: yfeldblum: so that sounds reasonable to you?  All site-cookbook edits happen on master branch then merged to the appropriate place?
[2012-12-21 21:41:13 -0500] geekbri__: the problem is you don't want to merge like staging branch to production branch because something like the data bags dir might get merged and you dont want that, you only want the site-cookbooks
[2012-12-21 21:41:18 -0500] yfeldblum: geekbri__, so atomic work happens in master, but in-depth work happens in a feature branch that then gets merged into master when it's done
[2012-12-21 21:41:24 -0500] geekbri__: Yeah
[2012-12-21 21:41:32 -0500] geekbri__: sorry, that is assuming feature branches for features ;)
[2012-12-21 21:41:39 -0500] blitzrage: so after a day of meetings I'm back to my task from this morning: getting information of servers into some data bags. I want to keep the data for these servers separate across environments, and I'm wondering if I should structure my data under data bags named by environment, or create json objects in the data bag named for the environment...
[2012-12-21 21:41:39 -0500] yfeldblum: geekbri__, then tag master, merge that tag into your QA branch, upload
[2012-12-21 21:41:43 -0500] geekbri__: makes sense.
[2012-12-21 21:41:47 -0500] yfeldblum: geekbri__, then merge that same tag into your prod branch, upload
[2012-12-21 21:41:48 -0500] geekbri__: That workflow is reasonable to me.
[2012-12-21 21:42:10 -0500] yfeldblum: geekbri__, the tag covers the whole of the chef-repo all at once
[2012-12-21 21:42:18 -0500] blitzrage: I'm not sure I like having access my data via bag_item[node.chef_environment]['some_key'], but I also don't like the idea of creating separate duplicate structures
[2012-12-21 21:42:50 -0500] yfeldblum: blitzrage, if you keep your data-bags in git, then you will need to do silly things like that
[2012-12-21 21:42:59 -0500] blitzrage: ya :\
[2012-12-21 21:43:19 -0500] blitzrage: I guess it could be worse
[2012-12-21 21:43:28 -0500] geekbri__: Can't you just have a git branch per environment?
[2012-12-21 21:43:38 -0500] blitzrage: duplicate data ftl though
[2012-12-21 21:44:00 -0500] geekbri__: well git doesn't mind because if the binary blobs are the same it won't double store them ;)
[2012-12-21 21:44:06 -0500] yfeldblum: blitzrage, that's why i'm not a fan of putting your data into your source control
[2012-12-21 21:44:09 -0500] geekbri__: you can just make the changes on a feature branch and merge into the right places.
[2012-12-21 21:44:19 -0500] yfeldblum: blitzrage, plenty of other ways to manage data
[2012-12-21 21:44:36 -0500] blitzrage: yfeldblum: suggestions? this is data that will be used to populate a flat file on a server via template
[2012-12-21 21:44:38 -0500] yfeldblum: geekbri__, i tried that exact approach ... wasn't a fan
[2012-12-21 21:45:02 -0500] yfeldblum: blitzrage, a) why does it need to be data? and ) `knife data bag edit` and take periodic backups
[2012-12-21 21:45:03 -0500] geekbri__: yfeldblum: Other alternatives end up being non chef native though so thats kind of a pain I gues
[2012-12-21 21:45:37 -0500] blitzrage: yfeldblum: I don't understand why it doesn't need to be data
[2012-12-21 21:46:00 -0500] yfeldblum: but a good goal here is to reduce the size of the data to the minimum necessary; compute anything that can be computed in code, not in data
[2012-12-21 21:46:15 -0500] blitzrage: well this is data that doesn't exist outside of the flat file it is currently stored in
[2012-12-21 21:46:24 -0500] yfeldblum: blitzrage, can some or all of that data be node-attributes or computed somehow in code?
[2012-12-21 21:46:26 -0500] blitzrage: I'm templating it so it's easier to deploy
[2012-12-21 21:46:34 -0500] blitzrage: not really
[2012-12-21 21:46:52 -0500] geekbri__: You could always just stuff the data in mysql or something and then just access it directly in a recipe
[2012-12-21 21:46:59 -0500] blitzrage: ya I don't want to do that
[2012-12-21 21:47:01 -0500] emanuelez: how do i use the package resource in order to install ANY version of a package?
[2012-12-21 21:47:13 -0500] yfeldblum: emanuelez, don't specify the version
[2012-12-21 21:47:35 -0500] yfeldblum: blitzrage, sounds like an XY Problem
[2012-12-21 21:48:14 -0500] emanuelez: yfeldblum: but that will rely on what's in the apt-cache and package will try to download THAT specific version, which might not be there anymore
[2012-12-21 21:48:23 -0500] blitzrage: actually just realized this will be solved with a search at some point, so this is actually a temporary solution
[2012-12-21 21:48:40 -0500] yfeldblum: emanuelez, so `apt-get update` before that?
[2012-12-21 21:48:41 -0500] blitzrage: so I'm not going to over engineer it -- data bags it is
[2012-12-21 21:48:53 -0500] yfeldblum: blitzrage, why not solve it with search right now?
[2012-12-21 21:49:02 -0500] blitzrage: because I don't have the nodes setup to be searchable
[2012-12-21 21:49:08 -0500] blitzrage: I'm converting an existing environment
[2012-12-21 21:49:12 -0500] blitzrage: there is nothing to search for
[2012-12-21 21:49:26 -0500] yfeldblum: blitzrage, or if it will be solved with search in a few months, just put some temporary data-bags in there that aren't saved in git?
[2012-12-21 21:49:41 -0500] blitzrage: yfeldblum: saved in git or not saved in git isn't really the issue
[2012-12-21 21:49:56 -0500] emanuelez: yfeldblum: fair enough. i was just wondering fi there was an option in package not to ask a specific version suck as "apt-get -q -y install openjdk-7-jre-headless=7u7-2.3.2-1ubuntu0.12.04.1"
[2012-12-21 21:50:02 -0500] blitzrage: but I'll use search for the dev nodes, and data bag data for the prod servers until they are migrated to using chef
[2012-12-21 21:50:23 -0500] yfeldblum: blitzrage, and then have your data-bag item names suffixed with "-#{chef-environment}"
[2012-12-21 21:51:06 -0500] yfeldblum: emanuelez, https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb
[2012-12-21 21:51:08 -0500] emanuelez: yfeldblum: and also, that will keep updating the program, which might be risky in the long run
[2012-12-21 21:51:27 -0500] blitzrage: well I was going to use a case statement based on environment to either retrieve from a data bag (prod) or search (dev)
[2012-12-21 21:51:35 -0500] blitzrage: then just remove that condition when prod == dev
[2012-12-21 21:51:40 -0500] yfeldblum: emanuelez, set up your own package repository
[2012-12-21 21:52:08 -0500] yfeldblum: blitzrage, dev-prod-imparity is a ... dangerous ... idea
[2012-12-21 21:52:30 -0500] blitzrage: I just mean in terms of being chef capable, not that my production machines are dev machines
[2012-12-21 21:52:33 -0500] derks: Hello, I am using knife-rackspace.. and I'm not sure how to use the same 'client' name/key for created servers
[2012-12-21 21:52:41 -0500] derks: --user/--key is not it
[2012-12-21 21:52:59 -0500] yfeldblum: derks, every server must have its own api-client
[2012-12-21 21:53:29 -0500] derks: yfeldblum, then I'm confused.  http://wiki.opscode.com/display/chef/Chef+Client
[2012-12-21 21:53:36 -0500] derks: "A Chef Client does work on behalf of a Node. A single Chef Client can run recipes for multiple Nodes."
[2012-12-21 21:54:08 -0500] yfeldblum: derks, in this case, the docs express a wish that is not yet in the code
[2012-12-21 21:54:25 -0500] derks: ok
[2012-12-21 21:54:34 -0500] yfeldblum: derks, lulz, right?
[2012-12-21 21:54:49 -0500] derks: sort of seems redundent then, right?
[2012-12-21 21:55:22 -0500] yfeldblum: derks, yes and no
[2012-12-21 21:56:50 -0500] derks: I have another question about env_run_list ... it suggests that I might be able to have 'web01' in 'production', and 'web01' in 'staging' ... with different run lists for those env
[2012-12-21 21:57:22 -0500] derks: however, 'web01' in production and 'web01' in staging are technically different nodes..
[2012-12-21 21:57:54 -0500] derks: so i get lost with how env_run_list is intended to be used
[2012-12-21 22:00:26 -0500] derks: ah, nevermind.  its applied at the role level, not node.  sorry
[2012-12-21 22:15:53 -0500] barnacles: Can someone take a look at this and let me know what the heck I'm doing wrong. http://pastie.org/private/9lyelbas6kekgfouval0ww#1,10,12
[2012-12-21 22:16:28 -0500] barnacles: Nevermind...quotes...ugh....
[2012-12-21 22:16:32 -0500] derks: am I right in saying that if env_run_list exists, that run_list is ignored?
[2012-12-21 22:34:50 -0500] miah: derks: its not ignored until you also define a '_default' environment in your env_run_lists
[2012-12-21 23:49:41 -0500] derks: this is stupid, but I can't figure out how to show what version of a cookbook is currently on a node
[2012-12-21 23:57:00 -0500] mrk: derks, try looking in /var/chef/cache/cookbooks
[2012-12-21 23:57:38 -0500] mrk: cookbooks should be in there and you can look at the metadata.rb
[2012-12-21 23:57:57 -0500] derks: thanks, that helps
[2012-12-21 23:58:12 -0500] derks: seems like there should be a better way... but this is good enough
[2012-12-21 23:58:24 -0500] mrk: all i could come up with :p
