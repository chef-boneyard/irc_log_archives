[2012-12-06 00:02:46 -0500] tmichael: yeah, guess i could just have parent recipe that uses conditional include_recipe to include proper recipe depending on whether server or client.  thx maek
[2012-12-06 00:03:28 -0500] maek: tmichael: seems to me that base is not actually a base if its to be left off of a sub set of servers. what I do in my base in the default.rb is include_recipes wrapped in logic for where they should go.
[2012-12-06 00:04:52 -0500] tmichael: yeah, that makes sense.  basically, i client/server app and wanted to put client in base cuz it's needed on all but 2 systems in env
[2012-12-06 00:05:10 -0500] tmichael: the 2 exceptions being the servers
[2012-12-06 00:05:25 -0500] tmichael: that wrapper logic is solid.  i'll look into that.  thx
[2012-12-06 00:05:32 -0500] maek: np, good luck
[2012-12-06 00:06:49 -0500] dougireton: How do I run test-kitchen given that the cookbook under test is not in my "chef-repo"? Should I copy my knife.rb into the cookbook directory?
[2012-12-06 00:07:05 -0500] dougireton: My cookbook is in a separate git repo
[2012-12-06 00:07:26 -0500] dougireton: ls
[2012-12-06 00:44:33 -0500] githubble: hi I am trying to fold in capistrano chef into my builds ... any assistance would be GREAT
[2012-12-06 00:48:08 -0500] dyer: Hey guys, question, It seems that a remote_file resource is always making some form of an http request, even when set to not run do to a not_if clause. ( http://bit.ly/QI8uJJ ).  The odd thing is I get expected behavior in shef.   I need it to NOT try and make any kind of HTTP request when the resource is excluded, but as you can see in that log chef-solo is fails w/ a socket error.  Shouldn't it be skipped entirely ?
[2012-12-06 00:55:00 -0500] miah: is the default value of node['prism']['jdbc_driver'] nil
[2012-12-06 00:55:30 -0500] dyer: miah, no, the default in the cookbook is not, but the dna.json file does set it to ni
[2012-12-06 00:55:32 -0500] dyer: nill
[2012-12-06 00:55:54 -0500] miah: nil and not 'nil' right =)
[2012-12-06 00:56:00 -0500] dyer: yea yea yea :P
[2012-12-06 00:56:16 -0500] dyer: I mean this works in shef -s
[2012-12-06 00:56:28 -0500] dyer: shef -s -j dna.json, drop into recipe and it works
[2012-12-06 00:56:34 -0500] dyer: the result of that is in the gist I posted
[2012-12-06 00:56:49 -0500] miah: try doing jdbc_driver.nil?
[2012-12-06 00:56:52 -0500] miah: rather than == nil
[2012-12-06 00:57:02 -0500] dyer: ok
[2012-12-06 00:57:39 -0500] miah: and if youre just testing, you cand throw in a Chef::Log.info("contents of jdbc_driver = #{ jdbc_driver }")
[2012-12-06 00:57:44 -0500] miah: to make sure your sane =)
[2012-12-06 00:58:12 -0500] miah: Chef::Log.info.. making printf debugging possible since...
[2012-12-06 01:04:57 -0500] dyer: miah, yea thats exactly what I did
[2012-12-06 01:05:05 -0500] dyer: and I am f***king really confused now
[2012-12-06 01:05:15 -0500] dyer: because the URL is there
[2012-12-06 01:05:38 -0500] dyer: wouldnt data in the node.json override values set in the attrivbutes file at default leve?
[2012-12-06 01:05:40 -0500] dyer: level
[2012-12-06 01:13:55 -0500] kallistec: dyer: looks like the deep merge code doesn't account for the difference between "doesn't exist" and "exists but is nil"
[2012-12-06 01:14:10 -0500] kallistec: false may work instead
[2012-12-06 01:15:06 -0500] JasonF: that's a really useful thing to know. I'm glad I saw that. ty kallistec
[2012-12-06 01:16:27 -0500] kallistec: even with the new, much less complicated deep_merge code in Chef 11, it's a bit tricky to read :/
[2012-12-06 02:47:24 -0500] dyer: @kallistec, "dyer: looks like the deep merge code doesn't account for the difference between "doesn't exist" and "exists but is nil""   Is that a known bug?
[2012-12-06 03:23:01 -0500] jtnz: If I have a chef-client (CentOS), and it doesn't seem to have the chef gem installed, or any chef package in yum, then how else could it be installed? Binaries are in /usr/bin/
[2012-12-06 03:23:12 -0500] jtnz: v 0.10.6 btw
[2012-12-06 03:23:20 -0500] jtnz: go give an idea of era
[2012-12-06 03:23:24 -0500] jtnz: to*
[2012-12-06 03:39:01 -0500] aruntomar: jtnz: http://www.opscode.com/chef/install/
[2012-12-06 03:39:22 -0500] aruntomar: jtnz: install the proper package for your platform
[2012-12-06 03:39:44 -0500] jtnz: aruntomar, yea, I'm just not sure of the outcome of running that with the existing set up
[2012-12-06 03:39:56 -0500] aruntomar: jtnz: this will install everything on /opt/chef
[2012-12-06 03:40:11 -0500] jtnz: aruntomar, but what about the existing install?
[2012-12-06 03:40:46 -0500] aruntomar: jtnz: how did u install the chef-client currently? source, rvm, pkg manager
[2012-12-06 03:41:13 -0500] jtnz: aruntomar, that's the problem, I don't know how it was installed and can't figure that out...
[2012-12-06 03:41:38 -0500] jtnz: aruntomar, the only people who would know don't work here any more :(
[2012-12-06 03:42:51 -0500] cwj: how is a chef run initiated on your system?
[2012-12-06 03:42:58 -0500] cwj: s/system/node/
[2012-12-06 03:43:21 -0500] aruntomar: jtnz: 0.10 is a pretty old version
[2012-12-06 03:43:41 -0500] aruntomar: https://opscode-omnitruck-release.s3.amazonaws.com/el/6/x86_64/chef-10.16.2-1.el6.x86_64.rpm
[2012-12-06 03:44:03 -0500] jtnz: aruntomar, yea, I know. I want to update, but not sure what will happen if I run the omnibus installer
[2012-12-06 03:44:32 -0500] aruntomar: jtnz: ruby -v
[2012-12-06 03:44:59 -0500] jtnz: aruntomar, 1.8.5
[2012-12-06 03:45:19 -0500] jtnz: located in /usr/bin/
[2012-12-06 03:45:28 -0500] aruntomar: jtnz: then it seems that it's been installed by the pkg manager
[2012-12-06 03:45:40 -0500] jtnz: yum list doesn't show it though...
[2012-12-06 03:45:50 -0500] jtnz: aruntomar, ^^^
[2012-12-06 03:46:22 -0500] aruntomar: jtnz: rvm list
[2012-12-06 03:47:01 -0500] aruntomar: jtnz: if it's in /usr/bin it won't be installed via rvm, so leave it
[2012-12-06 03:47:49 -0500] aruntomar: jtnz: so as such it's not going to matter much, no matter what version of chef u install, all it cares about is the config file, which is in the /etc/chef/client.rb
[2012-12-06 03:48:08 -0500] aruntomar: jtnz: so for safety, backup /etc/chef
[2012-12-06 03:48:29 -0500] aruntomar: then run "rpm -Uvh https://opscode-omnitruck-release.s3.amazonaws.com/el/6/x86_64/chef-10.16.2-1.el6.x86_64.rpm"
[2012-12-06 03:48:32 -0500] jtnz: aruntomar, oh, that's no drama because I know everything that's going on there
[2012-12-06 03:49:21 -0500] jtnz: aruntomar, but if the old binaries are still in /usr/bin I'm guessing it could cause issues with the new install
[2012-12-06 03:50:59 -0500] aruntomar: jtnz: omnibus is not going to mess with /usr/bin, it installs everything in /opt/chef
[2012-12-06 03:51:08 -0500] jtnz: aruntomar, I'm not a linux expert, but I'm guessing I could use chkconfig to disable the chef-client daemon, then remove the script from /etc/init.d/, then remove the old binaries and then run the omnibus installer
[2012-12-06 03:51:39 -0500] aruntomar: jtnz: or you can use rvm
[2012-12-06 03:51:55 -0500] aruntomar: jtnz: rvm for sure will not mess with your system ruby
[2012-12-06 03:52:37 -0500] jtnz: aruntomar, neither will omnibus right?
[2012-12-06 03:52:55 -0500] aruntomar: jtnz: install rvm , then install ruby and chef, and use that version
[2012-12-06 03:53:13 -0500] kallistec: dyer: not a known bug that I'm aware of, you could search for it in Jira
[2012-12-06 03:53:43 -0500] aruntomar: jtnz: omnibus creates chef-client in /usr/bin/chef-client, so it may override the existing library i guess
[2012-12-06 03:53:50 -0500] jtnz: aruntomar, to my knowledge it'll install it's own ruby etc and symlink it's binaries
[2012-12-06 03:54:11 -0500] aruntomar: jtnz: not the chef-client
[2012-12-06 03:54:12 -0500] jtnz: aruntomar, that's where, but they're just symlinks to /opt/chef/bin
[2012-12-06 03:55:38 -0500] aruntomar: jtnz: i faced that issue. i normally bootstrap my servers. then i had to install rvm for a requirement, but then chef-client won't run, b'cas it was expecting chef to be there, and my rvm installation didn't had chef.
[2012-12-06 03:56:07 -0500] jtnz: aruntomar, I just wish I could spin up new nodes :(
[2012-12-06 03:56:39 -0500] aruntomar: jtnz: that's y i'm suggesting that you use rvm
[2012-12-06 03:56:52 -0500] aruntomar: jtnz: rvm should be the best option
[2012-12-06 03:57:02 -0500] jtnz: aruntomar, I'm just not too familiar with the rvm option
[2012-12-06 03:57:35 -0500] aruntomar: jtnz: https://rvm.io/rvm/install/
[2012-12-06 03:57:59 -0500] jtnz: aruntomar, the node does appear to already have rvm installed
[2012-12-06 03:58:05 -0500] miah: i use rbenv. its similar to rvm. both are good choices. so is the omnibus installer. if you aren't doing ruby dev, then rvm/rbenv isn't really needed and the omnibus should be fine.
[2012-12-06 03:58:18 -0500] miah: i typically use the omnibus installer on my servers
[2012-12-06 03:59:34 -0500] jtnz: aruntomar, Oh well, I'll have to do some more investigation tomorrow. Thanks for your help
[2012-12-06 03:59:52 -0500] aruntomar: jtnz: welcome :)
[2012-12-06 04:00:21 -0500] jtnz: cwj, Thanks too, missed your comment earlier
[2012-12-06 04:00:33 -0500] cwj: no problem :)
[2012-12-06 04:01:54 -0500] aruntomar: which cookbook is mostly used/preferred for setting up firewall/iptables?
[2012-12-06 04:06:30 -0500] miah: i have had good luck with simple_iptables in the past
[2012-12-06 04:11:46 -0500] aruntomar: i've looked around, and iptables cookbook will be deprecated in future in favor of firewall cookbook, but currently firewall cookbook only supports ubuntu/debian as it uses ufw which is not there on centos
[2012-12-06 05:16:24 -0500] linuxanoop: I need to have LAMP stack on the chef server, while bootstraping  from citrix cloudstack instances
[2012-12-06 05:16:36 -0500] linuxanoop: Any idea how to shart with. Any one please
[2012-12-06 05:19:36 -0500] rb1980: how can I test if an attribute is set? with an if statement
[2012-12-06 05:20:05 -0500] coderanger: linuxanoop: open up your berkfile and add the apache2, mysql, and php cookbooks :)
[2012-12-06 05:20:17 -0500] coderanger: rb1980: sure
[2012-12-06 05:20:38 -0500] rb1980: can u show example?
[2012-12-06 05:21:14 -0500] coderanger: rb1980: if node['foo']; log "WHEEEEEEE"; end
[2012-12-06 05:21:23 -0500] coderanger: Ruby code all the way down
[2012-12-06 05:21:45 -0500] coderanger: It is pretty rare the an optional attribute doesn't have a default value of some kind set though
[2012-12-06 05:27:31 -0500] linuxanoop: coderanger: I'm using rhel6.2 . i have one uestion. do i need to use chef or private chef as chef server.
[2012-12-06 05:28:36 -0500] coderanger: linuxanoop: Open source server vs. Hosted vs. Private is up to you and your desire to run things yourself vs. budget (and chef-solo is always an option, you just give up search and have to write your own distribution layer)
[2012-12-06 05:30:07 -0500] linuxanoop: thanks coderanger. means opensource version chef is capable of having plugin integration for testing?
[2012-12-06 05:30:20 -0500] coderanger: Not sure what that means
[2012-12-06 05:30:37 -0500] coderanger: What is "plugin integration"?
[2012-12-06 05:32:12 -0500] linuxanoop:  I mean for cookbooks
[2012-12-06 05:33:31 -0500] coderanger: Still not sure what you are asking, the server API for all three types of servers is roughly identical (Open Source doesn't have the ACLs APIs though)
[2012-12-06 05:35:37 -0500] linuxanoop: thanks . No confussion :)
[2012-12-06 05:36:28 -0500] coderanger: With the release of Chef 11 server it really is the same underlying code except for ACLs, multitennancy, billing, etc
[2012-12-06 05:48:35 -0500] jimjimovich: after a week of beating my head against a puppet, i'm installing chef!
[2012-12-06 06:12:43 -0500] coderanger: jimjimovich: Welcome!
[2012-12-06 06:20:05 -0500] BryanWB_: morning chefs!
[2012-12-06 06:22:56 -0500] BryanWB_: erikh around?
[2012-12-06 06:36:21 -0500] chef_00: Hi is there any script/attributes that would allow me to create users & databases in postgres
[2012-12-06 06:37:53 -0500] coderanger: chef_00: database cookbook
[2012-12-06 08:17:33 -0500] chef_00: coderanger: Which database cookbook?
[2012-12-06 08:17:44 -0500] coderanger: chef_00: http://ckbk.it/database
[2012-12-06 08:17:51 -0500] coderanger: For better or worse, right now there can only be one
[2012-12-06 08:17:57 -0500] coderanger: (hint: worse)
[2012-12-06 08:41:18 -0500] chef_00: coderanger: Thanks for helping out, I vendored it and using it in my recipie , I get "Cannot find a resource for postgresql_database"  , What am I missing to include? (Sorry I am a bit new to this)
[2012-12-06 08:42:35 -0500] coderanger: Make sure your cookbook has depends 'database' in the metadata.rb
[2012-12-06 08:44:57 -0500] chef_00: Thanks
[2012-12-06 08:59:07 -0500] Apanra: I am using chef-solo and have kept my cookbook at "http://10.xx.xx.xx/cmf/AD/cookbooks.tgz" but when executing the command "chef-solo  -c  c:\cmf\chef\solo.rb -r %cookbook_url% -j c:\cmf\chef\node.json" it is failing with following error :
[2012-12-06 08:59:09 -0500] Apanra: C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application/solo.rb:194:in `join': can't convert nil into String (TypeError) from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application/solo.rb:194:in `reconfigure' from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application.rb:68:in `run' from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4
[2012-12-06 08:59:23 -0500] Apanra: Can anybody please help me with this?
[2012-12-06 08:59:44 -0500] Apanra: When I donot use the cookbook url and directly place the file on the machine
[2012-12-06 08:59:49 -0500] Apanra: it is executing nicely
[2012-12-06 09:02:02 -0500] Apanra: ???
[2012-12-06 09:09:40 -0500] Apanra: can any one plz help on thi issue?
[2012-12-06 09:13:19 -0500] tevfik: hi all
[2012-12-06 09:13:39 -0500] Apanra:  am using chef-solo and have kept my cookbook at "http://10.xx.xx.xx/cmf/AD/cookbooks.tgz" but when executing the command "chef-solo  -c  c:\cmf\chef\solo.rb -r %cookbook_url% -j c:\cmf\chef\node.json" it is failing with following error :
[2012-12-06 09:13:49 -0500] Apanra: C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application/solo.rb:194:in `join': can't convert nil into String (TypeError) from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application/solo.rb:194:in `reconfigure' from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/lib/chef/application.rb:68:in `run' from C:/opscode/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.14.4/bi
[2012-12-06 09:21:06 -0500] tevfik: guys I have only ORGANIZATION-validator.pem  I couldn't find where i can download USERNAME.pem =>  cp /path/to/USERNAME.pem ~/chef-repo/.chef
[2012-12-06 09:21:56 -0500] tevfik: anyone there?
[2012-12-06 09:23:04 -0500] coderanger: tevfik: opscode.com/account
[2012-12-06 09:23:07 -0500] coderanger: under Reset Password
[2012-12-06 09:23:55 -0500] tevfik: coderanger fur thank you :) i was gonna get crazy.. I've checked everywhere :)
[2012-12-06 09:24:12 -0500] coderanger: Its rather unfortunate, working on it!
[2012-12-06 09:27:12 -0500] tevfik: coderanger in here http://www.jasongrimes.org/2012/06/provisioning-a-lamp-stack-with-chef-vagrant-and-ec2-2-of-3/ it says "Move the Chef config directory from ~/chef-repo/.chef to ~/.chef. (This lets you execute knife commands from anywhere on the system.)"
[2012-12-06 09:27:30 -0500] tevfik: But in the installation it doesn't say anything like that
[2012-12-06 09:27:39 -0500] tevfik: installation page*
[2012-12-06 09:27:59 -0500] coderanger: knife searches every folder back from the current folder for a .chef, then it looks in ~/.chef, then it looks in /etc/chef
[2012-12-06 09:28:26 -0500] tevfik: so it's good to use from ~/.chef
[2012-12-06 09:28:51 -0500] tevfik: or doesn't change anything?
[2012-12-06 09:29:25 -0500] coderanger: Depends, I have 6+ chef repos for different projects on my laptop, so per project settings live in the project's .chef, and centralized settings live in ~/.chef
[2012-12-06 09:30:10 -0500] tevfik: I'm so newbie :)
[2012-12-06 09:30:10 -0500] coderanger: If you only have one, its pretty moot :)
[2012-12-06 09:30:20 -0500] coderanger: So whichever you prefer
[2012-12-06 09:30:20 -0500] tevfik: yea i have only one :)
[2012-12-06 09:30:29 -0500] tevfik: thank you
[2012-12-06 09:30:32 -0500] coderanger: I just like the "you should be in the folder" style, same way git and svn work
[2012-12-06 09:31:01 -0500] tevfik: you mean the project file?
[2012-12-06 09:31:05 -0500] tevfik: folder*8
[2012-12-06 09:31:28 -0500] coderanger: Yes
[2012-12-06 09:32:51 -0500] tevfik: I agree
[2012-12-06 09:33:09 -0500] tevfik: okay First i need to run this :)
[2012-12-06 09:33:19 -0500] tevfik: Then I'll try to more organise :)
[2012-12-06 10:01:08 -0500] dkannan: i have a timezone recipe. http://pastie.org/private/hwvuucodrqkngep6s6mcq
[2012-12-06 10:01:49 -0500] dkannan: how to i throw an error and halt cookbook convergence ? ruby's raise ?
[2012-12-06 10:02:24 -0500] dkannan: want to throw an error if the timezone does not exists
[2012-12-06 10:03:52 -0500] zeroXten: Man, foodcritic pisses me off sometimes. "Consider converting definition to a LWRP". I've considered it and I don't want to change it right now. "You should prefer LWRPs for new development." Thanks, but I'm happy with it right now... oh, but my code will always fail :( The should rename FC0015 to Cake or Death.. it isn't really a choice
[2012-12-06 10:05:34 -0500] coderanger: dkannan: yes
[2012-12-06 10:05:54 -0500] coderanger: zeroXten: Just disable that test?
[2012-12-06 10:05:55 -0500] dkannan: coderanger: thx
[2012-12-06 10:06:16 -0500] zeroXten: coderanger: cool, how?
[2012-12-06 10:06:23 -0500] zeroXten: can't see how in the docs
[2012-12-06 10:07:33 -0500] coderanger: http://acrmp.github.com/foodcritic/#faq
[2012-12-06 10:08:05 -0500] gokr: I have a rather large file in a recipe (under files/default/) and... realized that knife upload takes *all* every time... Any ideas?
[2012-12-06 10:08:21 -0500] zeroXten: ahh, you can give it the code.. huh. Thanks
[2012-12-06 10:08:57 -0500] gokr: I know a large file in a cookbook might be "unkosher" but its a rather neat way to host an installable tar ball for example.
[2012-12-06 10:09:27 -0500] coderanger: zeroXten: Yeah, and the ~ flag for inverse matching
[2012-12-06 10:09:47 -0500] coderanger: gokr: Use a remote_file and a normal HTTP server
[2012-12-06 10:10:09 -0500] gokr: Yeah... but why :)
[2012-12-06 10:10:15 -0500] coderanger: Cookbook upload won't push it up to the server ever time, but it does have to checksum it every time
[2012-12-06 10:10:17 -0500] coderanger: No way around that
[2012-12-06 10:10:32 -0500] gokr: Oh, it checksums at least? nice
[2012-12-06 10:10:55 -0500] tevfik: coderanger ERROR: Could not find cookbook apt in your cookbook path, skipping it, ERROR: Failed to upload 1 cookbook.
[2012-12-06 10:11:10 -0500] tevfik: I'm having this do you have any idea why I'm having it
[2012-12-06 10:11:26 -0500] gokr: Also, I do agree with this guy (https://steveko.wordpress.com/2012/09/19/getting-started-with-chef-on-the-nectar-research-cloud) on #5. It seems a bit messy to me too.
[2012-12-06 10:11:31 -0500] coderanger: tevfik: One of your cookbooks depends on the apt cookbook
[2012-12-06 10:11:56 -0500] tevfik: so what should i do?
[2012-12-06 10:11:57 -0500] coderanger: gokr: Yes, the whole upload system is content-addressable filesystem effectively
[2012-12-06 10:12:19 -0500] gkarekinian: You probably don't want a big binary file in your git repo anyway
[2012-12-06 10:12:20 -0500] coderanger: tevfik: Grab the apt cookbook
[2012-12-06 10:12:49 -0500] gokr: coderanger: But you are right, it was fast the second time I tried so it must be checksumming. Good, then my "problem" is solved.
[2012-12-06 10:13:06 -0500] tevfik: coderanger but i have it in my cookbooks folder under my .chef folder
[2012-12-06 10:13:21 -0500] coderanger: tevfik: Cookbooks don't go under .chef
[2012-12-06 10:13:25 -0500] coderanger: just config files
[2012-12-06 10:13:32 -0500] tevfik: fuuu
[2012-12-06 10:13:36 -0500] coderanger: cookbooks/ and .chef/ are generally siblings
[2012-12-06 10:13:36 -0500] tevfik: :D
[2012-12-06 10:13:38 -0500] gokr: gkarekinian: I don't have a git repo for this recipe :)
[2012-12-06 10:13:47 -0500] tevfik: okay I'll take care of it
[2012-12-06 10:13:54 -0500] gkarekinian: Oh you're safe then :)
[2012-12-06 10:13:57 -0500] coderanger: tevfik: https://github.com/opscode/chef-repo is an example one
[2012-12-06 10:14:06 -0500] gokr: Yeah, I am actually building a tool on top of chef for a customer.
[2012-12-06 10:15:13 -0500] tevfik: coderanger http://wiki.opscode.com/display/chef/Vagrant in this video it's inside of the .chef?
[2012-12-06 10:15:56 -0500] coderanger: tevfik: Got a timestamp so I don't have to watch the whole thing? :)
[2012-12-06 10:16:40 -0500] tevfik: coderanger 3:50 to 4:00
[2012-12-06 10:16:46 -0500] tevfik: 10 sec will be enoug
[2012-12-06 10:17:20 -0500] coderanger: You are right, and there is way more than that wrong with that guide
[2012-12-06 10:17:21 -0500] coderanger: >_<
[2012-12-06 10:17:33 -0500] coderanger: opcode/cookbooks.git was deprecated about a year ago
[2012-12-06 10:17:53 -0500] coderanger: I'll get it taken off the wiki, thanks for the report :)
[2012-12-06 10:19:14 -0500] coderanger: (not that that helps you at the moment, I know :)
[2012-12-06 10:19:37 -0500] tevfik: wait
[2012-12-06 10:19:40 -0500] tevfik: I'm following it :D
[2012-12-06 10:19:44 -0500] tevfik: Don't remove hehehe
[2012-12-06 10:20:07 -0500] tevfik: i realised that it's located in the chef-repo so i clone cookbooks there
[2012-12-06 10:20:12 -0500] tevfik: Now i'm gonna try to continue :)
[2012-12-06 10:20:49 -0500] coderanger: Just don't do the git clone opscode/cookbooks part
[2012-12-06 10:20:52 -0500] coderanger: that is 100% wrong
[2012-12-06 10:21:20 -0500] coderanger: To setup your chef repo, instead look at http://berkshelf.com/ :)
[2012-12-06 10:21:41 -0500] coderanger: Handles all the vagrant stuffs for you
[2012-12-06 10:22:53 -0500] tevfik: too bad i was soo happy that i found it :/
[2012-12-06 10:23:48 -0500] coderanger: tevfik: All of those cookbooks still exist, they were just split into their own repos under the opscode-cookbooks organization on github
[2012-12-06 10:24:04 -0500] coderanger: makes working with them much easier
[2012-12-06 10:24:20 -0500] coderanger: Though we recommend you use released versions when possible, which berkshelf makes easy
[2012-12-06 10:24:28 -0500] tevfik: Okay
[2012-12-06 10:24:32 -0500] tevfik: I'll try berkshelf
[2012-12-06 10:37:05 -0500] tevfik: coderanger I still couldn't make it berkshelf
[2012-12-06 10:37:29 -0500] tevfik: doesn't work the line gem install berkshelf
[2012-12-06 10:37:46 -0500] tevfik: i download the source but don't know how to run
[2012-12-06 10:47:47 -0500] tevfik: I'm totally confused!
[2012-12-06 10:52:38 -0500] coderanger: I need to sleep
[2012-12-06 10:52:43 -0500] coderanger: but how did you install chef?
[2012-12-06 10:53:00 -0500] coderanger: You need rubygems for chef to work, so you have it somehow for usre :)
[2012-12-06 10:58:19 -0500] slivabox1: does anybody have experience with setup and support openstack with chef?
[2012-12-06 11:12:21 -0500] jasonfly: I try to use Campfire as a handler, but I always get this error: Report handler Chef::Handler::Campfire raised #<OpenSSL::SSL::SSLError: SSL_connect returned=1 errno=0 state=SSLv3 read server certificate B: certificate verify failed>. How can I add the certificate?
[2012-12-06 11:22:38 -0500] shredder12: hi, I'm facing some errors while installing Chef-server on Ubuntu 12.04 through opscode repo. Here is the error while starting the service chef-server https://gist.github.com/4223797
[2012-12-06 11:22:45 -0500] shredder12: any suggestion?
[2012-12-06 11:27:01 -0500] Virunga: shredder12: i tried (on ubuntu 11.10) some installation method for chef and the simpler which didn't give me errors was through rubygems and chef-solo. I suggest the same to you, i you didn't do it.
[2012-12-06 11:27:24 -0500] Virunga: if*
[2012-12-06 11:28:30 -0500] shredder12: Virunga, yeah, I'm trying that right now. At first glance, repo installation looked straight forward, hence went with it
[2012-12-06 11:29:26 -0500] Virunga: shredder12: so after installing chef-server through chef-solo you get that error?
[2012-12-06 11:30:06 -0500] shredder12: no. I get this error after installing chef-server through the opscode's ubuntu repo
[2012-12-06 11:30:27 -0500] shredder12: I'm following the "chef-server through chef-solo" as of now.
[2012-12-06 11:30:32 -0500] Virunga: shredder12: oh ok, that was future tense :D. My English .....
[2012-12-06 11:31:00 -0500] shredder12: Virunga, :)
[2012-12-06 11:31:14 -0500] Virunga: shredder12: if you want i can give simple bash scripts i made that do the installation
[2012-12-06 11:31:19 -0500] Virunga: *you
[2012-12-06 11:33:17 -0500] shredder12: Virunga, yes of course! that would be great
[2012-12-06 11:34:41 -0500] Virunga: shredder12: wait
[2012-12-06 11:49:09 -0500] tevfik: wohoo :D I made it
[2012-12-06 12:54:23 -0500] machi: hai
[2012-12-06 12:55:54 -0500] machi: anybody can help me
[2012-12-06 12:56:07 -0500] dysinger: Is anyone else experiencing badness on chef-platform right now?
[2012-12-06 12:57:15 -0500] dysinger: my 'dysinger' org has disappeared "Error 33021".  My clients org started having permission issues for new nodes launched - unable to access cookbooks. I didn't change any permissions.
[2012-12-06 12:57:33 -0500] dysinger: I only saw my dysinger org disappeared after I went to compare permissions.
[2012-12-06 12:57:37 -0500] dysinger: wth
[2012-12-06 12:57:48 -0500] machi: ia anyone  else experience in create a cookbook for create a security group in Amazon EC2??
[2012-12-06 12:59:58 -0500] dysinger: ok I see.  You guys have some cookie issues.  Deleting cookies makes it so I can see my org again.
[2012-12-06 13:01:15 -0500] dysinger: it appears the environment is sticky across orgs.
[2012-12-06 13:01:35 -0500] dysinger: so that's 1 of my 2 problems fixed
[2012-12-06 13:02:52 -0500] WPsites: I'm having trouble searching log stash. I'm trying to exclude documents with certain tags. What is the correct syntax for this?
[2012-12-06 13:03:07 -0500] BryanWB_: dysinger: ot, which podhotel did u get bedbugs at? my wife is going to Nyc next week ;)
[2012-12-06 13:03:20 -0500] dysinger: 39th
[2012-12-06 13:03:24 -0500] dysinger: by grand central
[2012-12-06 13:03:25 -0500] BryanWB_: dysinger: tks
[2012-12-06 13:03:44 -0500] WPsites: I thought this would work:   @tags: -*grokparsefailure*
[2012-12-06 13:03:51 -0500] dysinger: I paid for a week too. the first night I showed up at 1am and the had sold my room.
[2012-12-06 13:04:06 -0500] BryanWB_: fuckers
[2012-12-06 13:04:20 -0500] dysinger: they fixed it but it was an extra 1.5 hr hassle at 1am
[2012-12-06 13:04:35 -0500] dysinger: It's not a real hotel :)
[2012-12-06 13:06:17 -0500] dysinger: why the heck would I start getting 403s from plaftorm trying to run chef-client?! says I need permission to access my cookbooks.
[2012-12-06 13:06:24 -0500] dysinger: I didn't change anything with perms
[2012-12-06 13:07:15 -0500] dysinger: going to try to regenerate validation key and re-validate but I suspect that's not the problem
[2012-12-06 13:07:55 -0500] gchristensen: dysinger: I seem to have mystery problems whenever I setup a new org too
[2012-12-06 13:13:46 -0500] dysinger: argh. I have a deadline this week. I don't need random mystery merb 403s
[2012-12-06 13:19:29 -0500] BryanWB_: dysinger: open-source chef server or hosted chef?
[2012-12-06 13:19:43 -0500] dysinger: hosted
[2012-12-06 13:19:51 -0500] dysinger: platform
[2012-12-06 13:20:01 -0500] BryanWB_: ah, dunno there :(
[2012-12-06 13:21:01 -0500] dysinger: I tore down all my nodes, deleted all clients & nodes, so I'm all the way back to a (newly-regenerated) validator & cookbooks/roles/databags
[2012-12-06 13:21:22 -0500] dysinger: I launch a new node. It validates & then tells me my node doesn't have permission to access all the cookbooks
[2012-12-06 13:21:39 -0500] dysinger: just started happening in the last few hours.
[2012-12-06 13:22:11 -0500] dysinger: I even deleted all cookbooks and re-uploaded them with knife
[2012-12-06 13:26:29 -0500] jwitrick: is there a way to check if a template file exists during a client run ?
[2012-12-06 13:26:59 -0500] dysinger: the nagios cookbook deploys all files in a plugins dir. you might look at that for an example
[2012-12-06 13:27:42 -0500] jwitrick: awsome. ill give that a look over. thanks
[2012-12-06 13:28:40 -0500] dysinger: jwcarman: that may not even be the right anwser
[2012-12-06 13:30:40 -0500] jwitrick: ya unfortunatly not. All i really want ot do is 'if template erb exists execute the template block. else use the file resource to create an empty file"
[2012-12-06 13:31:15 -0500] dysinger: I would use some other indicator myself.
[2012-12-06 13:31:23 -0500] dysinger: than if a file exists or not
[2012-12-06 13:31:36 -0500] dysinger: an attribute or even a databag item
[2012-12-06 13:32:44 -0500] jwitrick: ya i might have to go down that route, but with this  recipe as complicated as it is, a simple check of 'did someone create a template erb file' is an easy win.
[2012-12-06 13:43:10 -0500] cassianoleal1: jtimberman: how do I submit a new cookbook to be released on community.opscode.com ? shall I open a COOK- issue on Jira?
[2012-12-06 13:45:43 -0500] cassianoleal1: or should I simply upload a tarball on the website?
[2012-12-06 13:48:19 -0500] dysinger: FFS
[2012-12-06 13:48:30 -0500] dysinger: I can't even run chef-client now with an empty run list
[2012-12-06 13:49:18 -0500] BryanWB_: cassianoleal1: u can register and then upload to website
[2012-12-06 13:49:51 -0500] dysinger: Here's the merb error "This client is not authorized to read some of the information required to
[2012-12-06 13:49:52 -0500] dysinger: access its coobooks (HTTP 403)." complete with misspelled "coobooks"
[2012-12-06 13:51:09 -0500] cassianoleal1: BryanWB_: cool, but do I have to upload a new tarball everytime I release a new version, or does community. somehow manages to update it automatically from github?
[2012-12-06 13:51:29 -0500] BryanWB_: cassianoleal1: u gotta upload, there is a nice way to do it from command-line
[2012-12-06 13:52:09 -0500] cassianoleal1: BryanWB_: ok, that's better.. where do I find documentation for that? :)
[2012-12-06 13:52:26 -0500] BryanWB_: fuck it is in knife help somether
[2012-12-06 13:52:37 -0500] BryanWB_: knife cookbook site upload or something
[2012-12-06 13:52:52 -0500] BryanWB_: or knife cookbook site share ...
[2012-12-06 13:53:25 -0500] dysinger: fuck it. support ticket. yay blocked.
[2012-12-06 13:54:58 -0500] cassianoleal1: right. thanks, man
[2012-12-06 14:04:20 -0500] KarlFreeman: Is there a way to use notifies to run a recipe inside another recipe? eg run a recipe in the after_restart of deploy_revision?
[2012-12-06 14:05:01 -0500] dysinger: chef needs better error messages
[2012-12-06 14:05:23 -0500] dysinger: turns out it was my fault. typo in the environment was the problem.
[2012-12-06 14:05:43 -0500] dysinger: I could have saved an hour of debugging & tearing down / rebuilding.
[2012-12-06 14:05:56 -0500] dysinger: If it had just said "that environment doesn't exist"
[2012-12-06 14:07:17 -0500] dysinger: instead of giving me a run around about cookbook permissions
[2012-12-06 14:24:25 -0500] KarlFreeman: Is there a way for the deploy resource to notify when deploying?
[2012-12-06 14:30:50 -0500] masterkorp: you can use notifiees
[2012-12-06 14:31:12 -0500] masterkorp: KarlFreeman: with the :immediate param
[2012-12-06 14:31:29 -0500] sfb: So part of my department is looking at Chef or Puppet for deploying and provisioning servers. I'm current writing Jenkins jobs to automate changes to one of my apps. Things like clearing cache then restarting and automating refresh steps (copying a database, executing SQL, starting the app back up)
[2012-12-06 14:31:41 -0500] sfb: Is this somethign that Chef could be suited to do as wel?
[2012-12-06 14:31:47 -0500] masterkorp: yeah
[2012-12-06 14:32:36 -0500] KarlFreeman: ok, but when does :imediate happen. after_restart?
[2012-12-06 14:33:15 -0500] KarlFreeman: Or, it seems not possible to notifiy at different stages of the deploy resource
[2012-12-06 14:33:38 -0500] KarlFreeman: say I have 3 recipes to be run in the before_restart and then 2 in the after_restart ( but I don't want to run them when nothing is being deployed )
[2012-12-06 14:34:09 -0500] pattersonc: stupid chef/knife question: after creating a node (i.e. on ec2) using knife node create, how does one force the runlist to execute again to update that node? do i have to logon the ndoe and run chef client? that seems like a PITA.
[2012-12-06 14:35:29 -0500] masterkorp: KarlFreeman: i would use a attribute
[2012-12-06 14:36:07 -0500] masterkorp: the deploy recipe would set some like node["appyouhave"]["is_derping_happening"] = true
[2012-12-06 14:36:20 -0500] masterkorp: and recipes would check
[2012-12-06 14:36:29 -0500] mcmgraham: pattersonc check the chef-client cookbook out, you can run it as a cron or a system service. https://github.com/opscode-cookbooks/chef-client
[2012-12-06 14:37:11 -0500] KarlFreeman: Ok, that sounds a good solution. node["appyouhave"]["before_restart|
[2012-12-06 14:37:13 -0500] jtimberman: cassianoleal1: you just upload it either through the site, or using 'knife cookbook site share' from the command line.
[2012-12-06 14:37:14 -0500] KarlFreeman: *"]
[2012-12-06 14:37:31 -0500] KarlFreeman: node["appyouhave"]["before_restart"] = true then just check against it
[2012-12-06 14:38:03 -0500] masterkorp: KarlFreeman: it really depends on your orchestration :)
[2012-12-06 14:38:09 -0500] jtimberman: dysinger: wow thats a bummer.
[2012-12-06 14:38:36 -0500] jtimberman: sfb: chef can do those things
[2012-12-06 14:38:38 -0500] KarlFreeman: :) yep. Just checking I wasn't overlooking things with the deploy_resource
[2012-12-06 14:38:42 -0500] KarlFreeman: Thanks
[2012-12-06 14:39:14 -0500] dysinger: jtimberman: I'm passed it. It was my typo. I submitted a support ticket anyway to show how much I ran around chasing my tail over permissions.
[2012-12-06 14:40:27 -0500] jwcarman: So, am I correct when I say that you have to manually manage your version numbers for your cookbooks in chef?
[2012-12-06 14:40:39 -0500] jwcarman: Or, is there a utility (a la maven's release plugin) that can do that?
[2012-12-06 14:40:56 -0500] masterkorp: KarlFreeman: br0s before h0es :)
[2012-12-06 14:42:55 -0500] LowWalker: howdy all, would it be possible to write cookbooks in jruby?
[2012-12-06 14:43:11 -0500] pattersonc: mcmgraham: is this the typical approach for updating/deploying new revision to existing nodes?
[2012-12-06 14:44:09 -0500] mcmgraham: You would manage the configuration through your roles/environments and then when you change those, chef-client would detect the changes during their normal intervals and update accordingly.
[2012-12-06 14:47:22 -0500] pattersonc: what environment/role/node config is exactly the same and I just want to get the application udpates from the deploy_revision resource?
[2012-12-06 14:47:37 -0500] pattersonc: what if*
[2012-12-06 14:48:23 -0500] pattersonc: maybe something with knife exec to force chef-client to run on the nodes specified?
[2012-12-06 14:53:17 -0500] mcmgraham: We use capistrano for most of our app deployment at the moment, so someone else might want to chime in. But I would probably do something like storing the commit id as an attribute and deploy if there is a mismatch between the attribute and the commit id, etc. Or you could do it based on the git branch.
[2012-12-06 14:53:18 -0500] pattersonc: maybe I'm missing something here. i just want to update the cookbooks (incase of changes) on the node and rerun the recipe(s).
[2012-12-06 14:54:14 -0500] pattersonc: mcmgraham: that solution may work but it seems like overkill for what im  trying to accomplish.
[2012-12-06 14:55:18 -0500] cassianoleal1: jtimberman: yeah, I found that. thanks!
[2012-12-06 14:57:26 -0500] mcmgraham: Up to you, you could also make an application cookbook that deploys everything and has the branch and/or git commit hard coded into the cookbook instead of attributes. I usually try to avoid those solutions as I prefer to have that sort of data as an attribute that I can manipulate from an environment so I can do controlled releases.
[2012-12-06 14:58:45 -0500] pattersonc: I am controlling the release revision based on the branch so if there is a new revision there is no attr to update
[2012-12-06 14:59:47 -0500] specialsauce: it is possible to throw a specific exception in a specific resource instance? I want to provide a hint to someone on why the resource might have failed beyond what the command being executed provides
[2012-12-06 15:01:59 -0500] jwcarman: Is the "roles are evil" a common thought among the community?
[2012-12-06 15:02:42 -0500] meineerde: jwcarman: I personally find them very useful and use them heavily throughout my environments.
[2012-12-06 15:03:16 -0500] jwcarman: My understanding is that the issue is that they can't be versioned, so folks are saying that you should avoid them.
[2012-12-06 15:03:31 -0500] meineerde: jwcarman: (but I make sure to keep them in git along with the rest of the configuration and make sure to never ever edit stuff directly on the server)
[2012-12-06 15:04:15 -0500] meineerde: also, for my "application" cookbooks, I have no actual version but use git branches as work-in-progress.
[2012-12-06 15:04:19 -0500] sfb: jtimberman: Thanks, I'm trying to set up a sandbox to test it out.
[2012-12-06 15:04:30 -0500] jtimberman: sfb: cool, good luck!
[2012-12-06 15:04:31 -0500] sfb: I'm getting this error when installing Chef from apt.
[2012-12-06 15:04:34 -0500] meineerde: all held together by librarian
[2012-12-06 15:04:38 -0500] jwcarman: meineerde: that makes sense.  I'm still trying to figure out the whole idea of versioning and doing "releases" with chef cookbooks
[2012-12-06 15:04:40 -0500] jwcarman: and repos
[2012-12-06 15:04:43 -0500] sfb: find: `/var/cache/chef/checksums/': No such file or directory
[2012-12-06 15:04:50 -0500] jtimberman: jwcarman: they're not evil!
[2012-12-06 15:05:03 -0500] jtimberman: the thing to consider is that roles are data, not code.
[2012-12-06 15:05:18 -0500] gchristensen: is there a way to have knife connect to one server at a time? I tried: knife ssh -C1 "*:*" "hostname" - and it does connect to the one server, but then it never moves on to the second
[2012-12-06 15:05:21 -0500] jwcarman: jtimberman: but, they are data that affects how a machine is provisioned
[2012-12-06 15:05:55 -0500] jwcarman: jtimberman: so, wouldn't it make sense that you'd want to version them, too, so that you don't get inadvertent updates
[2012-12-06 15:05:58 -0500] jtimberman: meh
[2012-12-06 15:06:02 -0500] jwcarman: :)
[2012-12-06 15:06:09 -0500] jtimberman: they describe a thing in your infrastructure
[2012-12-06 15:06:23 -0500] jtimberman: it doesn't make sense to version roles to me.
[2012-12-06 15:06:32 -0500] jtimberman: how often do they have to change, seriously?
[2012-12-06 15:06:44 -0500] jwcarman: Well, I'm new to chef, so I have no idea :D
[2012-12-06 15:06:59 -0500] BryanWB_: roles should be a run_list or an alias to a run_list imho
[2012-12-06 15:07:11 -0500] mcmgraham: Big attribute changes don't occur often, but when they do, it becomes a mess in roles.
[2012-12-06 15:07:28 -0500] BryanWB_: all data of any significance should go into a cookbook ala gangnam style
[2012-12-06 15:07:43 -0500] BryanWB_: http://devopsanywhere.blogspot.it/2012/11/how-to-write-reusable-chef-cookbooks.html
[2012-12-06 15:07:44 -0500] jwcarman: I love that they called it that.  I read that blog post
[2012-12-06 15:08:04 -0500] jwcarman: Too funny
[2012-12-06 15:08:23 -0500] BryanWB_: glad u like it :), roles work fine for data if u use them for a small home network like some ppl do
[2012-12-06 15:08:36 -0500] jtimberman: data of any significance should go in data bags :)
[2012-12-06 15:08:37 -0500] BryanWB_: but not for 10s of servers w/ different envs
[2012-12-06 15:08:39 -0500] jwcarman: BryanWB_: was that your blog post?
[2012-12-06 15:08:44 -0500] BryanWB_: jwcarman: y
[2012-12-06 15:09:08 -0500] jwcarman: BryanWB_: makes it entertaining and informative.  Thanks for that!
[2012-12-06 15:09:11 -0500] BryanWB_: jtimberman: i m also becoming skeptical of data_bags :p
[2012-12-06 15:09:35 -0500] jtimberman: heh
[2012-12-06 15:09:40 -0500] BryanWB_: if i had infinite time and intelligence i would try to move data_bags into zookeeper
[2012-12-06 15:09:45 -0500] BryanWB_: and integrate w/ chef
[2012-12-06 15:10:15 -0500] BryanWB_: jwcarman: my pleasure
[2012-12-06 15:10:22 -0500] jwcarman: BryanWB_: that sounds like an interesting idea (zookeeper)
[2012-12-06 15:11:07 -0500] BryanWB_: just an idea at this stage, but for real orchestration u need zookeeper or a zookeeper clone
[2012-12-06 15:16:47 -0500] awgross: BryanWB_: thanks for that link, had missed that one
[2012-12-06 15:19:14 -0500] specialsauce: jwcarman: never seen the problem with roles, I find them a very useful way of building atomic blocks (recipes) into roles that can then be assigned to hosts so that you are never building snowflake hosts, but mapping them to roles. we don't apply any recipes directly to hosts
[2012-12-06 15:20:00 -0500] specialsauce: my only bugear really is that you can set attrs on role and attrs on env but not attrs on "role+env"
[2012-12-06 15:20:43 -0500] specialsauce: for reference we are using chef at reasonable scale (hundreds of nodes, tens of environments), certainly enough that I'd have expected roles to become an issue if they were going to for us
[2012-12-06 15:20:54 -0500] alexbst: jonlives - I've put the gist up. https://gist.github.com/4225224
[2012-12-06 15:28:20 -0500] mcmgraham: Roles become an issue when two different cookbook versions expect attributes to behave in a different way. Say you have an attribute called "module" as a String in version 1.0.0 and then in 2.0.0 you change that to an Array. When you make that attribute change in your role for version 2.0.0, it's going to break all the nodes using version 1.0.0. That
[2012-12-06 15:28:20 -0500] mcmgraham: attribute should have gone in an environment or hard coded in the cookbook so the attribute is pinned to a specific version of a cookbook.
[2012-12-06 15:38:20 -0500] flashingpumpkin: hey guys. One quickie question - why would I get an error like: [2012-12-06T15:37:16+00:00] FATAL: Errno::ENOENT: No such file or directory - /var/chef/cache/cookbooks/application/recipes/mongodb.rb - when Chef just ran this whole recipe?
[2012-12-06 15:45:21 -0500] ssd7: OK, people who use berkshelf heavily, what do your chef-repo look like now?  Everything but cookbooks with 1 big Berksfile?
[2012-12-06 15:46:21 -0500] BryanWB_: ssd7: i use separate berksfile for each cookbook
[2012-12-06 15:46:46 -0500] BryanWB_: keeps it skinnier and makes it easier to share
[2012-12-06 15:47:48 -0500] ssd7: BryanWB_: OK.  So I guess for me, a process that always needs to "just work" is rebuilding everything from the ground up.  What would that process look like.  Right now I upload everything in my chef-repo and knife bootstrap some nodes with the correct roles and I know that includes everything I need.
[2012-12-06 15:48:26 -0500] mcmgraham: flashingpumpkin: I've been getting that error intermittently (on cookbooks other than mongodb). Haven't had time to look into it, but it doesn't repeat after another chef run and I haven't been able to figure out how to reproduce it.
[2012-12-06 15:49:11 -0500] flashingpumpkin: mcmgraham, in my case just above, an error happened inside a provider inside the recipe and chef failed to inspect the recipe
[2012-12-06 15:49:24 -0500] ssd7: mcmgraham: flashingpumpkin My guess is that you have a situation where on the very first run you are starting chef-client as a service inside the recipe
[2012-12-06 15:49:42 -0500] flashingpumpkin: ssd7, this was on knife bootstrap
[2012-12-06 15:49:45 -0500] ssd7: that leads you to having 2 running chef clients.  The second has no run list yet, so it runs very quickly, and deletes the cache on the end
[2012-12-06 15:49:58 -0500] mcmgraham: ahh that makes sense ty
[2012-12-06 15:50:01 -0500] ssd7: flashingpumpkin: Right that would be the most likely time for it to happen
[2012-12-06 15:50:09 -0500] flashingpumpkin: ssd7, cool, thanks!
[2012-12-06 15:50:57 -0500] flashingpumpkin: that makes sense
[2012-12-06 15:51:49 -0500] ssd7: I believe if you upgrade to 10.16.2 we've added a locking feature which makes that error impossible.
[2012-12-06 15:55:37 -0500] flashingpumpkin: ssd7, knife local is on 10.16.2, on servers we use omnibus which installs 10.16.2 too
[2012-12-06 15:55:45 -0500] flashingpumpkin: ssd7, bug report? :)
[2012-12-06 16:02:19 -0500] mcmgraham: I thought the client locking was coming in 11
[2012-12-06 16:02:20 -0500] jtimberman: ssd7: which ticket is that
[2012-12-06 16:02:37 -0500] gchristensen: can I have one role define attributes like: { 'foo' => { 'bar' => '123' } } and then another include that role, and  define: { 'foo' => { 'baz' => '456' } } and have nodes with that second role have { 'foo' => { 'bar' => '123', 'baz' => '456' } } ?
[2012-12-06 16:03:01 -0500] jtimberman: ssd7: CHEF-867? http://tickets.opscode.com/browse/CHEF-867 - its slated for Chef 11.
[2012-12-06 16:03:13 -0500] jtimberman: unless you're talking about a different thing :)
[2012-12-06 16:03:35 -0500] jtimberman: we do have --fork in 10.16.2
[2012-12-06 16:04:23 -0500] jtimberman: root      4135  2.8  0.5 201432 40552 ?        Sl   09:03   0:00 /opt/chef/embedded/bin/ruby /usr/bin/chef-client -i 1800 -s 20 -f -R
[2012-12-06 16:05:23 -0500] jtimberman: (-f or --fork helps with memory consumption indeed)
[2012-12-06 16:22:42 -0500] specialsauce: mcmgraham: that's quite the edgecase to rule out using roles altogether. It would still be possible to not use roles, set an attr in an environment, update your cookbook and BAM it would break in the exact same way, whilst you have lost all the functionality of roles
[2012-12-06 16:25:27 -0500] mcmgraham: I don't think roles should be ruled out altogether, I just think it should be emphasized more that it's usually better that attributes go in the cookbook or in the environment. And ya you can still break things in env attributes, but you at least have the opportunity to go "this set of attributes is for this set of cookbook versions" which you can't do with
[2012-12-06 16:25:27 -0500] mcmgraham: a role.
[2012-12-06 16:45:05 -0500] rbuck: hi, is this an appropriate place to ask a question about opscode/mixlib-config ?
[2012-12-06 16:46:45 -0500] jtimberman: rbuck: ask away :)
[2012-12-06 16:50:02 -0500] rbuck: i must be missing something here  regarding mixlib-config, i created a really simple config class with a dozen predefined configuration properties, thinking these will be the fallback values, love it; i created a separte config file in my home directory, myapp.rb, then loaded that file using .from_file; all the properties that were NOT explicitly set by the on-disk config file were changed to nil
[2012-12-06 16:51:03 -0500] rbuck: i must be missing something; is there a way to have the previously defined values not changed to nil after a config file is loaded?
[2012-12-06 16:51:40 -0500] rbuck: meaning, anything that is not explicitly defined in a config file for the app not change to nil defaults specified in my Config class?
[2012-12-06 16:52:49 -0500] programmerq: jtimberman: quick question about the mysql cookbook. It appears to install the node['mysql']['server']['packages'] during the compile phase (before recipes are run). This isn't working for us since we want to install percona, and our recipe to add the percona repo hasn't run yet.
[2012-12-06 16:53:06 -0500] programmerq: is there a way to make it not do that?
[2012-12-06 16:53:29 -0500] programmerq: maybe instead of setting that attribute, we'll install the percona packages in our recipe that adds the percona repo?
[2012-12-06 16:53:47 -0500] rbuck: jtimberman - would you happen to know how to do this?
[2012-12-06 17:13:41 -0500] barnacles_: For chef open server, where are all the cookbooks and config files actually stored on my host machine?
[2012-12-06 17:15:29 -0500] btm: barnacles_: the files are stored as checksums in your checksum_cache as configured in your server.rb. The glue to put them together as a cookbook is in couchdb.
[2012-12-06 17:16:02 -0500] cheeseplus: doh
[2012-12-06 17:19:21 -0500] jtimberman: programmerq: are you using the ruby recipe?
[2012-12-06 17:23:50 -0500] c_t: ohai, all
[2012-12-06 17:26:43 -0500] leifmadsen: hmmm, the WARN in Chef 10.16.2 about setting attributes without specifying a precedence is deprecated is a great message, but it doesn't point one at where they are setting that attribute incorrectly :)
[2012-12-06 17:29:25 -0500] programmerq: jtimberman: there's an rvm recipe we're using
[2012-12-06 17:31:05 -0500] programmerq: it looks like it's installing those packages at compile time because it's trying to make sure it has the mysql gem in chef's ruby
[2012-12-06 17:31:28 -0500] programmerq: our next idea is to write a recipe that installs the percona yum repo at compile time
[2012-12-06 17:31:41 -0500] jtimberman: are you using chef in an rvm ruby or the omnibus chef package?
[2012-12-06 17:31:46 -0500] programmerq: and hope that we can somehow get it to compile before the mysql repo
[2012-12-06 17:31:52 -0500] programmerq: we're using the omnibus chef
[2012-12-06 17:32:02 -0500] jtimberman: leifmadsen: aye, can you open a ticket for that?
[2012-12-06 17:32:11 -0500] programmerq: get it to compile before the mysql recipe*
[2012-12-06 17:32:12 -0500] leifmadsen: jtimberman: I can handle that yes :)
[2012-12-06 17:33:43 -0500] jtimberman: leifmadsen: thanks!
[2012-12-06 17:34:15 -0500] jtimberman: programmerq: yeah, you should be able to just do the yum_repository at compile phase before the other mysql recipe
[2012-12-06 17:34:47 -0500] leifmadsen: jtimberman: CHEF-3667 fyi
[2012-12-06 17:35:38 -0500] jtimberman: leifmadsen: cheers
[2012-12-06 17:35:41 -0500] leifmadsen: skoal
[2012-12-06 17:47:48 -0500] programmerq: jtimberman: how would I force a yum_repository to happen at the compile phase?
[2012-12-06 17:55:10 -0500] jtimberman: programmerq: my_yumminess = yum_repository ...
[2012-12-06 17:55:23 -0500] jtimberman: programmerq: my_yumminess.run_action(:add)
[2012-12-06 17:55:29 -0500] jtimberman: i believe add is the right action :)
[2012-12-06 18:04:05 -0500] aruntomar: jtimberman: i've a query regarding the creation of dynamic data bags in a recipe. i see a limitation that it only works when run on a workstation. is that correct?
[2012-12-06 18:07:39 -0500] programmerq: jtimberman: we'll give that a try.
[2012-12-06 18:17:23 -0500] programmerq: jtimberman: for the run_action(:add) to work, we'll need our recipe to compile before the mysql recipe during the compilation phase. anyway to control that?
[2012-12-06 18:18:48 -0500] Drewzar: Hey guys, any reason why this isn't working: https://gist.github.com/4226729
[2012-12-06 18:19:21 -0500] Drewzar: When the OS is Oracle Linux, it picks the 'default' everytime.
[2012-12-06 18:25:05 -0500] ranjibd: Drewzar, whats the output of `ohai platform_family`? in that box? Did you check if is picking up oracle linux?
[2012-12-06 18:25:27 -0500] ranjibd: sorry.. rhel
[2012-12-06 18:25:54 -0500] Drewzar: ranjibd: http://cl.ly/image/3I2r1l3R3d2c
[2012-12-06 18:40:14 -0500] Drewzar: Got it, that cookbook version was pinned in the env I was testing in!
[2012-12-06 18:40:23 -0500] Drewzar: hurrdurr
[2012-12-06 19:12:47 -0500] gchristensen: so I have a recipe which creates a directory (Processing directory[/mnt/dbstorage/] action create (mysql-ext::default line 22)) and then it mounts a device there (Processing mount[/mnt/dbstorage/] action mount (mysql-ext::default line 29)) and then it gives me an error: ount point /mnt/dbstorage/ does not exist. Is the directory creation held until lateR?
[2012-12-06 19:19:56 -0500] zuhaib: quick version locking question.  If I set a limit on my environment to lock recipe to version 1.0 can I have a role do something like cookbook::recipe@2.0
[2012-12-06 19:20:34 -0500] miah: no
[2012-12-06 19:20:49 -0500] miah: you can have a cookbook depend on a specific version of another cookbook though
[2012-12-06 19:21:23 -0500] miah: http://wiki.opscode.com/display/chef/Metadata#Metadata-depends
[2012-12-06 19:22:45 -0500] zuhaib: yeah dont want that.  I am pushing out a new node that I want to use the new recipe but dont want the new recipe yet on all of our boxes
[2012-12-06 19:25:16 -0500] sfb: New environment?
[2012-12-06 19:35:32 -0500] programmerq: jtimberman: so, we did the run_action(:add) on our yum repo definition and yum key, and it looked like it did nothing. closer inspection showed that they were getting called
[2012-12-06 19:35:46 -0500] programmerq: but the resources defined within (like the remote_file for the key) were not getting executed
[2012-12-06 19:36:02 -0500] programmerq: so it looks like we'd have to fork the yum cookbook and do run_action on those resources as well
[2012-12-06 19:36:21 -0500] programmerq: what I did instead was define rpm_package for the rpm containing the repo and key info from percona
[2012-12-06 19:36:31 -0500] programmerq: so we aren't depending on sub resources
[2012-12-06 19:36:36 -0500] programmerq: and that seems to have done the trick
[2012-12-06 19:37:04 -0500] programmerq: that seems like it was way more complicated than it ought to have been. I'm curious what the reason was for doing the run_action on stuff in the mysql cookbook
[2012-12-06 19:37:28 -0500] programmerq: it seems like that should only get called when the corresponding mysql::server or mysql::client recipie is called.
[2012-12-06 19:39:01 -0500] eka: how to handle "machine users" ssh keys to access github?
[2012-12-06 19:40:38 -0500] awgross: eka: heres how we do it
[2012-12-06 19:40:39 -0500] awgross: http://tech.yipit.com/2012/09/05/deploying-from-github-the-right-way/
[2012-12-06 19:41:04 -0500] awgross: eka: and a follow up with some code for chef http://loadedinthecloud.blogspot.com/2012/11/github-deploy-keys-with-chef.html
[2012-12-06 19:41:48 -0500] eka: awgross: so each time (new server) you generate a new "machine user" with different ssh key that you push to github via github api? interesting
[2012-12-06 19:42:08 -0500] awgross: eka: yes, we have another job that runs every night and cleans up keys for machines that dont exist anymore
[2012-12-06 19:43:01 -0500] eka: awgross: thanks... didn't know about that option... .the option I was thinking was having an initial image with the "machine user" already there...
[2012-12-06 19:43:37 -0500] awgross: awgross: can do that, problem is revoking that becomes a real pain
[2012-12-06 19:44:07 -0500] eka: awgross: what you mean with revoking? if you revoke all the machines get revoked
[2012-12-06 19:46:30 -0500] awgross: eka: true, but maybe you dont want that
[2012-12-06 19:46:40 -0500] awgross: eka: maybe you only want to revoke some of them, your call
[2012-12-06 19:59:57 -0500] eka: awgross: sorry was away... my question is, why would you want to revoke a machine? in case it got hacked or something?
[2012-12-06 20:00:15 -0500] awgross: hacked, exposed
[2012-12-06 20:00:20 -0500] awgross: no longer needs the permissions
[2012-12-06 20:00:29 -0500] eka: awgross: right... nice... thanks!
[2012-12-06 20:01:10 -0500] awgross: eka: np
[2012-12-06 20:20:39 -0500] EpocSquadron: hello all
[2012-12-06 20:21:22 -0500] EpocSquadron: im having an issue with chef-solo and the mysql cookbook from opscode
[2012-12-06 20:22:21 -0500] EpocSquadron: specifically, i'm setting the bind_address in the json attributes being passed to chef-solo, but the setting is not being respected
[2012-12-06 20:23:05 -0500] EpocSquadron: anyone familiar with any common gotchas?
[2012-12-06 20:23:26 -0500] EpocSquadron: im using vagrant, the json is being set in the Vagrantfile
[2012-12-06 20:26:56 -0500] EpocSquadron: ive googled it to the end of the earth
[2012-12-06 20:27:10 -0500] EpocSquadron: or at least stack overflow
[2012-12-06 20:29:13 -0500] dtss-abc: hi all
[2012-12-06 20:29:22 -0500] EpocSquadron: hi
[2012-12-06 20:31:08 -0500] dtss-abc: anyone handling mutiple instances of a particular daemon on a single node, via a single recipe with overwritten attributes for each app instance (for config values)?
[2012-12-06 20:34:12 -0500] dtss-abc: I don't want to duplicate a varnish recipe for every instance I have, I'd rather have one recipe that can setup multiple instances based on values configured in the role.
[2012-12-06 20:34:28 -0500] EpocSquadron: wish i could help
[2012-12-06 20:34:37 -0500] EpocSquadron: this chat seems pretty dead despite the number of folks
[2012-12-06 20:35:01 -0500] awgross: EpocSquadron: is bind address being set somewhere else
[2012-12-06 20:35:09 -0500] dtss-abc: well, maybe someone will see my note
[2012-12-06 20:35:11 -0500] awgross: perhaps the attributes file of the opscode mysql cookbook?
[2012-12-06 20:35:42 -0500] miah: dtss-abc: https://github.com/miah/chef-graphite/blob/lwrp/recipes/_carbon_cache_runit.rb
[2012-12-06 20:35:57 -0500] awgross: dtss-abc: you are going to want to look in to LWRP probably, will allow you to pass in values to a block, that can go about setting up varnish with those values
[2012-12-06 20:36:11 -0500] miah: i use resources rather than attributes in this case.. but same idea really
[2012-12-06 20:36:15 -0500] kallistec: dtss-abc: you can't run the same recipe multiple times. Your options are to pull everything out to a lwrp, or wrap the recipe in a for loop
[2012-12-06 20:36:26 -0500] awgross: hah, beat me to is miah
[2012-12-06 20:37:00 -0500] EpocSquadron: awgross: the line in attributes reads "default['mysql']['bind_address']               = attribute?('cloud') ? cloud['local_ipv4'] : ipaddress"
[2012-12-06 20:37:13 -0500] EpocSquadron: im new to ruby so im not sure what that line is doing
[2012-12-06 20:37:24 -0500] awgross: EpocSquadron: ok, there's your problem.  The chef solo json attributes come is as default attrs as well
[2012-12-06 20:37:28 -0500] dtss-abc: miah: looking...
[2012-12-06 20:37:33 -0500] miah: EpocSquadron: http://invisibleblocks.com/2007/06/11/rubys-other-ternary-operator/
[2012-12-06 20:37:48 -0500] awgross: so chef reads all the recipes and overwrites your json specification with their default value
[2012-12-06 20:38:23 -0500] EpocSquadron: really, i thought the purpose of json was to override the defaults
[2012-12-06 20:38:29 -0500] awgross: in your cookbooks attributes/default.rb file, place a line with override['mysql']['bind_address'] = "blah" that should work
[2012-12-06 20:38:38 -0500] awgross: EpocSquadron: i know i have had issues with Chef Solo/ Vagrant and the JSOn
[2012-12-06 20:38:44 -0500] awgross: i eventually just created a dummy chef_solo cookbook
[2012-12-06 20:38:49 -0500] miah: you shouldn't really modify the cookbooks attributes directly
[2012-12-06 20:38:50 -0500] awgross: where i could override attributes while testing
[2012-12-06 20:39:08 -0500] miah: modify them via roles, environments, or wrapper cookbooks
[2012-12-06 20:39:13 -0500] EpocSquadron: miah: thats what im trying to avoid -- and thanks for the link on the tenary operator
[2012-12-06 20:39:17 -0500] kallistec: EpocSquadron: awgross json from -j on the command line gets set as 'normal' level attributes which will win over default level attributes: https://github.com/opscode/chef/blob/master/lib/chef/node.rb#L271-276
[2012-12-06 20:39:27 -0500] miah: attributes have a prececence
[2012-12-06 20:39:43 -0500] awgross: kallistec: hmm good to know
[2012-12-06 20:39:45 -0500] miah: http://wiki.opscode.com/display/chef/Attributes
[2012-12-06 20:39:53 -0500] xerxas: dschultz:
[2012-12-06 20:39:55 -0500] xerxas: oops
[2012-12-06 20:40:10 -0500] xerxas: dtss-abc: why do you want multiple varnish instances ,
[2012-12-06 20:40:26 -0500] xerxas: I think they can't all bind the same port
[2012-12-06 20:41:23 -0500] dtss-abc: xerxas: you can't bind multiple instances to the same port...
[2012-12-06 20:41:37 -0500] xerxas: right
[2012-12-06 20:41:46 -0500] dtss-abc: xerxas: I don't do that now, but I do need multiple running on separate ports
[2012-12-06 20:41:55 -0500] xerxas: ok
[2012-12-06 20:42:10 -0500] dtss-abc: xerxas: multiple sites, hosted on their own instance... managed individually
[2012-12-06 20:42:15 -0500] jtnz: Hi, can somebody remind me which Opscode repo has the bootstrap template files? Specifically the Linux ones, but if someone also knows the Windows ones that'll save me hunting.
[2012-12-06 20:42:20 -0500] xerxas: dtss-abc: I have pretty much the same problem you have, but not the same way
[2012-12-06 20:42:47 -0500] xerxas: dtss-abc:  i want to include some vcls in my main vcl depending on the list of sites I deploy on the node
[2012-12-06 20:42:55 -0500] dtss-abc: xerxas: I have a load balancer in front (bigip) that will direct the traffic as I need it... so it doesn't matter that I have multiple ports running
[2012-12-06 20:43:14 -0500] xerxas: dtss-abc: interesting
[2012-12-06 20:43:48 -0500] dtss-abc: xerxas: your approach is normal, just use includes and host header detection in your vcl
[2012-12-06 20:44:01 -0500] xerxas: right
[2012-12-06 20:44:19 -0500] xerxas: my problem is collecting the list of files I need to include
[2012-12-06 20:44:26 -0500] xerxas: varnish doesn't manage ".d" directory
[2012-12-06 20:44:53 -0500] xerxas: I need to write it in vcl , and filenames can't be regexps AFAIK
[2012-12-06 20:45:42 -0500] miah: you can compare the contents of a Dir.glob vs the resource_collection
[2012-12-06 20:46:08 -0500] xerxas: miah: do you have an idea of cookbook that does sth similar ?
[2012-12-06 20:46:20 -0500] miah: no
[2012-12-06 20:47:02 -0500] miah: shouldn't be too hard though. the resource_collection has a #find method that allows you to lookup file['thefiletomanage']
[2012-12-06 20:47:23 -0500] miah: https://github.com/miah/chef-graphite/blob/lwrp/libraries/default.rb
[2012-12-06 20:47:30 -0500] miah: how i work with the resource_collection..
[2012-12-06 20:48:03 -0500] xerxas: never heard about resource_collection
[2012-12-06 20:48:06 -0500] xerxas: nice
[2012-12-06 20:48:07 -0500] miah: (strangely there isn't a method to lookup all resources of a specific type which is why i had to write that)
[2012-12-06 20:48:18 -0500] xerxas: fine
[2012-12-06 20:48:19 -0500] xerxas: thx
[2012-12-06 20:48:25 -0500] miah: https://github.com/opscode/chef/blob/master/lib/chef/resource_collection.rb
[2012-12-06 20:48:44 -0500] xerxas: yep
[2012-12-06 20:49:45 -0500] xerxas: miah: so want I want to do is pass a resource_collection in template's variables , right ?
[2012-12-06 20:50:29 -0500] dtss-abc: xerxas: just do: include "site1.vcl";
[2012-12-06 20:50:48 -0500] dtss-abc: you will need to know who they are ahead of time
[2012-12-06 20:50:54 -0500] dtss-abc: but you can automate that too
[2012-12-06 20:50:56 -0500] xerxas: dtss-abc: where do I take the "site1.vcl" from ?
[2012-12-06 20:51:24 -0500] dtss-abc: in your main vcl
[2012-12-06 20:52:01 -0500] dtss-abc: "call site1_vcl_rcv";
[2012-12-06 20:52:12 -0500] dtss-abc: after you you check req.http.host
[2012-12-06 20:53:39 -0500] xerxas: I need to think about it
[2012-12-06 20:53:44 -0500] xerxas: will try some stuff ...
[2012-12-06 20:54:13 -0500] miah: xerxas: nah. you'll probably want to write a library method like i did. then pass that to your template. similarly to how i did the graphite _carbon_cache_runit.rb linked above.
[2012-12-06 20:56:14 -0500] ekristen: I am getting "Could not create client" in my chef web interface
[2012-12-06 20:56:28 -0500] EpocSquadron: miah: what is the attribute?('cloud') part of what i posted doing?
[2012-12-06 20:56:41 -0500] jbz: ekristen: Private server, or hosted chef?
[2012-12-06 20:56:55 -0500] EpocSquadron: im assuming the ? is checking for existence of an attribute method
[2012-12-06 20:56:56 -0500] ekristen: jbz: private server
[2012-12-06 20:57:04 -0500] miah: attribute?('cloud') checks for the extistence of the 'cloud' attribute
[2012-12-06 20:57:10 -0500] jbz: And what operation are you trying to do?
[2012-12-06 20:58:02 -0500] EpocSquadron: ok so that's to tie in with a different setting
[2012-12-06 20:58:25 -0500] EpocSquadron: otherwise it uses 'ipaddress', which is coming from...
[2012-12-06 20:58:49 -0500] ekristen: jbz: create an admin client from the web interface so I can have a coworker setup their chef workstation
[2012-12-06 20:59:13 -0500] jbz: hm ok
[2012-12-06 20:59:14 -0500] zuhaib: I just had the weirder error, I am switching to the new omnibus bootstrap install and noticed on spining up a new EC2 instance it first chef-client run went well but it did not save any run list data to our chef server
[2012-12-06 20:59:17 -0500] EpocSquadron: is ipaddress a chef internal?
[2012-12-06 20:59:21 -0500] zuhaib: *weirdest
[2012-12-06 20:59:33 -0500] jbz: ekristen: that's outside my familiarity then, sorry. :-(
[2012-12-06 20:59:49 -0500] zuhaib: All the node attriubtes but not run list
[2012-12-06 21:00:01 -0500] ekristen: jbz: :(
[2012-12-06 21:00:39 -0500] ekristen: jbz: any logs I can go look at?
[2012-12-06 21:01:02 -0500] jbz: ekristen: I don't run private chef...
[2012-12-06 21:01:23 -0500] ekristen: jbz: hrm ok -- well something changed on my setup
[2012-12-06 21:01:38 -0500] ekristen: because my chef clients are getting 500 errors when trying to talk to API now!
[2012-12-06 21:02:17 -0500] ekristen: ok something is wrong with my chef server all together
[2012-12-06 21:10:29 -0500] wassy121: So, data_bag("bag") returns an array of strings representing the names of each of the data bag items.  Is there a way to get an array of hashes of all the data_bag_items in that data_bag ?
[2012-12-06 21:11:38 -0500] wassy121: I'm trying to reduce server round-trips from 'data_bag_item("bag","item1")['foo']', 'data_bag_item("bag","item2")['foo']"
[2012-12-06 21:14:23 -0500] jtnz: Can someone please point me to some information on Ohai hints?
[2012-12-06 21:15:50 -0500] martinisoft: yay, thanks for merging that btm :D
[2012-12-06 21:17:31 -0500] yfeldblum: wassy121, you're probably doing it wrong
[2012-12-06 21:18:54 -0500] yfeldblum: wassy121, that's like doing a full table scan on a database and returning the entire table ... what you usually want to do is lookup by primary key (chef-server supports lookup by single primary key, no batch fetches yet) or a narrow search (chef-server does it with lucene)
[2012-12-06 21:18:58 -0500] ekristen: rabbitmq is failing to start
[2012-12-06 21:19:01 -0500] ekristen: can anyone help me?
[2012-12-06 21:19:09 -0500] ekristen: literally that is all that is in the logs
[2012-12-06 21:19:12 -0500] ekristen: "failed to start"
[2012-12-06 21:19:20 -0500] wassy121: yfeldblum, I understand the analogy.
[2012-12-06 21:19:20 -0500] ekristen: so my chef web api is failing
[2012-12-06 21:19:25 -0500] ekristen: REST api*
[2012-12-06 21:20:47 -0500] yfeldblum: wassy121, if you really want a full table fetch, you can use search: Hash[search("my-data-bag-name", "*:*").map{|item| [item.name, item]}]
[2012-12-06 21:21:20 -0500] wassy121: yfeldblum, yeah, I saw the search function as well, thought about using that
[2012-12-06 21:22:09 -0500] wassy121: I also looked at 'foo = databags("bag"); foo.show("item")['attribute']'
[2012-12-06 21:22:31 -0500] wassy121: but I'm sure that's less efficient than just doing data_bag_item, data_bag_item, etc.
[2012-12-06 21:23:33 -0500] awgross: wassy121: out of curiosity, what are you trying to do
[2012-12-06 21:24:16 -0500] wassy121: Trying to grab the IP address of a distinct set of databag items (4 specific items out of 8 in the bag)
[2012-12-06 21:25:40 -0500] awgross: gotcha
[2012-12-06 21:26:02 -0500] awgross: wassy121: are these other chef nodes, or addresses or soemthing else
[2012-12-06 21:26:20 -0500] wassy121: specifically non-chef-hosts
[2012-12-06 21:26:25 -0500] awgross: darn, ok
[2012-12-06 21:26:38 -0500] awgross: are the 4 round trips really that expensive in your chef run?
[2012-12-06 21:26:49 -0500] wassy121: Meh.  How will it scale?
[2012-12-06 21:27:09 -0500] awgross: are you expecting to have 100 of these one day?
[2012-12-06 21:27:11 -0500] wassy121: When next round it's 40 items out of 600
[2012-12-06 21:27:19 -0500] awgross: hrm ic
[2012-12-06 21:27:47 -0500] wassy121: sloppy code always has a way of coming back around
[2012-12-06 21:27:52 -0500] awgross: hehe that it does
[2012-12-06 21:28:37 -0500] wassy121: I'll just file it as technical debt, and make the 4 separate calls.
[2012-12-06 21:29:16 -0500] wassy121: Bah.  Thanks for the help though.  Loading all 600 data bag items and manually parsing through them would be worse I'm sure.
[2012-12-06 21:29:37 -0500] wassy121: The search would probably be best given the circumstances
[2012-12-06 21:33:08 -0500] yfeldblum: SELECT N + 1 never scales
[2012-12-06 21:33:18 -0500] yfeldblum: it's scalability factor is "crash"
[2012-12-06 21:33:30 -0500] yfeldblum: just make one request
[2012-12-06 21:33:40 -0500] yfeldblum: fetch all of them with a *:* search
[2012-12-06 21:34:45 -0500] wassy121: Okay.  Thanks for the help :)
[2012-12-06 21:37:28 -0500] daneroo: Trying to do a remote silent install of MSSQL Express with: knife winrm, does anyone know if this is possible ? (to move into a recipe once it is working)
[2012-12-06 21:37:49 -0500] daneroo:  This message from may, seems to indicate it is not possible..:http://bit.ly/QKShmR
[2012-12-06 22:08:47 -0500] julian_: Hey guys, question about attributes.  I have set default attributes in a role file but I do not see them when I run ohai.  Am I doing something wrong with how I should set permanent attributes?
[2012-12-06 22:12:00 -0500] awgross: julian_: ohai does not get user set attributes, it only pulls system information afaik
[2012-12-06 22:12:36 -0500] julian_: awgross: Ahhh. ok thanks.  how do I find user set attributes with knife or on the system itself?
[2012-12-06 22:12:55 -0500] awgross: uhhm, trying to think of a good way to list them
[2012-12-06 22:13:08 -0500] awgross: havent listed them all before
[2012-12-06 22:13:16 -0500] awgross: i just log certain ones if I am having trouble
[2012-12-06 22:13:45 -0500] awgross: i suppose you could log the node object or something
[2012-12-06 22:13:48 -0500] awgross: if you really needed to
[2012-12-06 22:14:45 -0500] julian_: I am thinking about systems integration and user user attributes to identify lets say master db servers or load balancers.
[2012-12-06 22:19:05 -0500] CosmicCat: hi folks: anybody know of a tool that parses /var/cache/chef/failed-run-data.json into something more readable?
[2012-12-06 22:21:53 -0500] miah: if you have chef you have a ruby
[2012-12-06 22:22:25 -0500] segv: hey, can you, like a regular data bag, edit encrypted data bags within a recipe?
[2012-12-06 22:25:21 -0500] andreacampi: ohai!
[2012-12-06 22:25:41 -0500] andreacampi: can I has beta testers?
[2012-12-06 22:28:28 -0500] awgross: andreacampi: for what?
[2012-12-06 22:28:28 -0500] miah: for?
[2012-12-06 22:28:40 -0500] andreacampi: https://github.com/andreacampi/nyan-cat-chef-formatter
[2012-12-06 22:28:51 -0500] awgross: rofl
[2012-12-06 22:29:44 -0500] programmerq: jtimberman: okay, sorry I keep bugging you. still working with the mysql cookbook. trying to deploy percona on rhel/centos still. The attributes in attributes/server.rb set the pid_file attribute using set rather than default.
[2012-12-06 22:29:52 -0500] programmerq: percona expects the pid_file to be in another place
[2012-12-06 22:29:59 -0500] programmerq: but I don't seem to be able to override the attribute
[2012-12-06 22:30:14 -0500] andreacampi: awgoss yes it is
[2012-12-06 22:30:17 -0500] andreacampi: :)
[2012-12-06 22:30:26 -0500] andreacampi: but it's working, at least for me :)
[2012-12-06 22:30:31 -0500] programmerq: changing set to default in the cookbook seems to allow me to set the pid_file attribute as I expect
[2012-12-06 22:30:39 -0500] programmerq: and doesn't seem to break the cookbook
[2012-12-06 22:30:50 -0500] programmerq: is there some reason that set is getting used rather than default?
[2012-12-06 22:30:52 -0500] atomic-penguin: nyan cat
[2012-12-06 22:30:54 -0500] awgross: programmerq: set is only syntax
[2012-12-06 22:30:59 -0500] awgross: set: *old
[2012-12-06 22:31:04 -0500] awgross: programmerq: *old
[2012-12-06 22:31:09 -0500] atomic-penguin: andreacampi, nice!
[2012-12-06 22:31:29 -0500] andreacampi: :)
[2012-12-06 22:31:32 -0500] programmerq: https://github.com/opscode-cookbooks/mysql/blob/master/attributes/server.rb#L51
[2012-12-06 22:31:46 -0500] programmerq: ah, so I could probably fork and do a pull request to change everything to default rather than set?
[2012-12-06 22:31:55 -0500] awgross: believe so
[2012-12-06 22:31:55 -0500] miah: yes
[2012-12-06 22:32:00 -0500] andreacampi: atomic-penguin: can't always do serious stuff :D
[2012-12-06 22:32:07 -0500] programmerq: k, that's probably what we'll do
[2012-12-06 22:32:18 -0500] awgross: http://wiki.opscode.com/display/chef/Setting+Attributes+(Examples)
[2012-12-06 22:32:25 -0500] awgross: apparently its an alias to normal actually
[2012-12-06 22:32:30 -0500] awgross: also old syntax
[2012-12-06 22:32:44 -0500] awgross: i was thinking of node.set
[2012-12-06 22:33:06 -0500] atomic-penguin: andreacampi, hey, I've been watching a slowly moving progress bar for an hour.  Nyan cat is certainly a more entertaining progress bar.
[2012-12-06 22:33:13 -0500] miah: yes. its old. chef-client cookbook needs a update to the attributes too.
[2012-12-06 22:33:17 -0500] andreacampi: exactly :D
[2012-12-06 22:33:19 -0500] awgross: unsure why the cookbook would use set in those attributes anyways programmerq
[2012-12-06 22:33:37 -0500] atomic-penguin: Fact: 90% of system management is watching progress bars
[2012-12-06 22:33:46 -0500] miah: only if you don't value your time
[2012-12-06 22:33:47 -0500] andreacampi: speaking of weird stuff
[2012-12-06 22:33:51 -0500] miah: why watch a progress bar when you can do something
[2012-12-06 22:34:04 -0500] andreacampi: I can't believe I'm still getting tweets and emails about this: https://github.com/zephirworks/ruby-perl
[2012-12-06 22:34:19 -0500] andreacampi: it as an April's Fool for crying out loud!
[2012-12-06 22:34:26 -0500] awgross: andreacampi: there is a rubypython as well
[2012-12-06 22:34:31 -0500] atomic-penguin: miah, I'm not actually staring at the progress bar.
[2012-12-06 22:34:46 -0500] programmerq: we're currently trying to set attributes using chef-solo
[2012-12-06 22:34:59 -0500] programmerq: maybe I need to set it differently in chef-solo?
[2012-12-06 22:35:25 -0500] andreacampi: and yet there are people who are actually using it!
[2012-12-06 22:35:42 -0500] programmerq: it does look like we'll be okay on chef-server/chef-client as long as I override_attribute
[2012-12-06 22:35:50 -0500] andreacampi: aggress yeah it looks like a similar approach, nice
[2012-12-06 22:36:22 -0500] andreacampi: but it looks like a real thing :)
[2012-12-06 22:37:20 -0500] awgross: andreacampi: im scared that it is
[2012-12-06 22:37:29 -0500] andreacampi: yeah :D
[2012-12-06 22:38:24 -0500] mrk_: anybody out there using chef-cucumber to test their recipes etc.. ?
[2012-12-06 22:38:54 -0500] mrk_: wondering if it's the best solution or if there are others i should look out / consider
[2012-12-06 22:40:31 -0500] programmerq: yeah, definitely looks like my problem is likely that chef-solo attribute values have a lower precedence than the attributes set with set, but I can't find any documentation on precedence of attributes set within the json provided for chef-solo.
[2012-12-06 22:40:52 -0500] programmerq: :/
[2012-12-06 22:42:41 -0500] atomic-penguin: progress bar done, time to go
[2012-12-06 22:47:40 -0500] barnacles_: attributes set with json for chef-solo are the lowest precedence possible?
[2012-12-06 22:49:08 -0500] kallistec: barnacles_: no, they're set at "normal" which wins over default but loses to override
[2012-12-06 22:49:29 -0500] programmerq: kallistec: any way to bump their precedence?
[2012-12-06 22:50:05 -0500] programmerq: it's looking like I'll want to use override when I define these attributes in my role, frustrating that I don't see a clear way to do it so far in chef-solo. hmmm.
[2012-12-06 22:50:14 -0500] barnacles_: kallistec: so what precedence is node.set then? override?
[2012-12-06 22:50:28 -0500] kallistec: programmerq: you can use roles with solo, it just reads them as files
[2012-12-06 22:50:37 -0500] programmerq: kallistec: interesting
[2012-12-06 22:50:47 -0500] awgross: barnacles_: node.set should be 'normal' precedence, its older syntax
[2012-12-06 22:51:04 -0500] awgross: .
[2012-12-06 22:51:07 -0500] barnacles_: awgross: Ahh k, thanks
[2012-12-06 22:51:31 -0500] kallistec: barnacles_: yeah, if your recipes are using `set` in the attributes files, you should review if you can change that to `default`
[2012-12-06 22:51:48 -0500] awgross: sounds like a foodcritic rule
[2012-12-06 22:51:52 -0500] barnacles_: kallistec: Aye, that's what I do
[2012-12-06 22:51:57 -0500] kallistec: for 100% solo, you can probably use default for everything
[2012-12-06 22:52:33 -0500] barnacles_: awgross: <3 foodcritic
[2012-12-06 22:52:40 -0500] awgross: indeed
[2012-12-06 22:53:04 -0500] kallistec: awgross: would be tricky, there are a handful of legit uses for normal attributes, since they persist to the individual node in chef-client/server use
[2012-12-06 22:53:28 -0500] awgross: kallistec: im not against normal attributes, just the node.set notation
[2012-12-06 22:53:43 -0500] awgross: shouldnt it be node.default, node.normal, node.override now?
[2012-12-06 22:54:24 -0500] kallistec: I dunno, `set` isn't going to be deprecated or anything
[2012-12-06 22:55:15 -0500] awgross: for some reason i thought i was discouraged
[2012-12-06 22:55:18 -0500] kallistec: hard for me to know if "set" has counterintuitive connotations for some/most/all people
[2012-12-06 22:55:19 -0500] awgross: could be thinking of something else
[2012-12-06 22:55:24 -0500] programmerq: kallistec: the problem is that this is an opscode cookbook we're using
[2012-12-06 22:55:29 -0500] programmerq: I like to avoid forks where I can
[2012-12-06 22:55:50 -0500] programmerq: I think we'll do a pull request on this one
[2012-12-06 22:56:10 -0500] programmerq: I don't see anything in the commit history that would explain the use of set
[2012-12-06 22:56:38 -0500] programmerq: https://github.com/opscode-cookbooks/mysql/blob/master/attributes/server.rb#L51 <- this is the line in question giving us problems
[2012-12-06 22:57:49 -0500] taec_: Anyone want to help us settle a discussion? Chef runs should be empty if nothing changes, right? We've got recipes running that keep doing the same thing over and over again (creating users, setting files etc.). Am I wrong in thinking goals should be to get empty chef runs?
[2012-12-06 22:58:05 -0500] kallistec: programmerq: no idea. jtimberman thoughts? ^^
[2012-12-06 23:01:00 -0500] kallistec: taec_: yes, if you only manage your servers with chef and your recipes are written correctly, there should (generally) be 0 changes when you run chef a second time
[2012-12-06 23:01:40 -0500] kallistec: there are some cases where you'd expect to occasionally see resources be updated, e.g. periodically updating apt cache
[2012-12-06 23:03:29 -0500] programmerq: we're figuring out how to run test kitchen
[2012-12-06 23:04:03 -0500] programmerq: I haven't been working with chef that long, but all the food analogies are wearing on me a bit.
[2012-12-06 23:04:23 -0500] awgross: programmerq: be glad they are renaming shef
[2012-12-06 23:04:30 -0500] programmerq: awgross: oh?
[2012-12-06 23:04:51 -0500] programmerq: shef isn't exactly a food analogy though
[2012-12-06 23:04:58 -0500] awgross: try telling someone that
[2012-12-06 23:05:07 -0500] awgross: clever name on paper
[2012-12-06 23:05:15 -0500] awgross: impossible to say out loud without confusion
[2012-12-06 23:05:28 -0500] programmerq: Standard Hydrologic Exchange Format
[2012-12-06 23:05:31 -0500] dCtrl: i call it s-shef
[2012-12-06 23:05:38 -0500] programmerq: State Higher Education Finance
[2012-12-06 23:05:54 -0500] programmerq: oh, I stand corrected: http://shefskitchen.wordpress.com/
[2012-12-06 23:05:54 -0500] awgross: dCtrl: yeah that or Chef-Shell
[2012-12-06 23:07:41 -0500] programmerq: when metaxis was out here doing training, I think he had to say "no, no.. shef with an s" to me about 5 times the day we went over that.
[2012-12-06 23:08:27 -0500] kallistec: your welcome :P
[2012-12-06 23:09:46 -0500] awgross: berkshelf should have called their fake app friend_face, copyrights be damned
[2012-12-06 23:12:19 -0500] mrjs: hi - id like to add users to multiple groups, im not using the standard opscode users cookbook, but rather a self built one.  whats the easiest way to get users into multiple groups?
[2012-12-06 23:16:43 -0500] poolpog: hi mrjs how can I help?
[2012-12-06 23:16:54 -0500] poolpog: are you feeling ok?
[2012-12-06 23:17:14 -0500] mrjs: looking for the best way to manage users in groups
[2012-12-06 23:17:23 -0500] poolpog: download the cookbook
[2012-12-06 23:17:33 -0500] mrjs: i have a self built one
[2012-12-06 23:17:39 -0500] poolpog: ah, ok
[2012-12-06 23:17:47 -0500] mrjs: i just want to get the users into a secondary group easily
[2012-12-06 23:17:56 -0500] poolpog: is this Windows?
[2012-12-06 23:18:07 -0500] mrjs: no, otherwise i would just use AD
[2012-12-06 23:18:10 -0500] mrjs: ubantu
[2012-12-06 23:18:16 -0500] poolpog: ah, yeah, 'cause I was gonna say...
[2012-12-06 23:18:19 -0500] miah: how are you creating the users now?
[2012-12-06 23:18:21 -0500] miah: useradd?
[2012-12-06 23:18:36 -0500] poolpog: data bags and some cheffiness
[2012-12-06 23:18:47 -0500] miah: if you have a self built cookbook.. youuu could just modify your create method to pass supplementary groups
[2012-12-06 23:19:06 -0500] poolpog: lol -- he hasn't seen our "self built" stuff
[2012-12-06 23:19:16 -0500] miah: he?
[2012-12-06 23:19:18 -0500] poolpog: she?
[2012-12-06 23:19:20 -0500] poolpog: idk
[2012-12-06 23:19:24 -0500] poolpog: it
[2012-12-06 23:19:34 -0500] poolpog: going with "it" until proven otherwise
[2012-12-06 23:19:40 -0500] miah: its irc. no need to gender really.
[2012-12-06 23:19:48 -0500] poolpog: ah, ok
[2012-12-06 23:19:59 -0500] poolpog: I'll call mrjs "it" then, because it is pretty accurate
[2012-12-06 23:20:24 -0500] miah: you should call mrjs whatever they prefer.
[2012-12-06 23:20:42 -0500] miah: anyways.
[2012-12-06 23:20:51 -0500] mrjs: im just using the standard comment, uid, gid, home, shell attributes
[2012-12-06 23:21:22 -0500] mrjs: for some backlog, it was written by a co-worker i no longer work with, so im having to modify
[2012-12-06 23:21:42 -0500] mrjs: im thinking of ripping/replacing with the users cookbook available from download
[2012-12-06 23:21:54 -0500] miah: ok. how is it creating the user though? useradd, a ruby gem? magic?
[2012-12-06 23:22:05 -0500] mrjs: but was hoping for an easy way to add users to multiple groups
[2012-12-06 23:22:14 -0500] miah: i can help you. if you help me.
[2012-12-06 23:22:15 -0500] poolpog: "magic" so far
[2012-12-06 23:22:27 -0500] miah: the questions i asked. need to be answered though.
[2012-12-06 23:22:36 -0500] poolpog: full disclosure: mrjs and I are sitting directly across from each other
[2012-12-06 23:22:43 -0500] poolpog: yesh, indeed they do...
[2012-12-06 23:22:47 -0500] poolpog: one sec
[2012-12-06 23:23:53 -0500] mrjs: using the user resource to add a user
[2012-12-06 23:24:17 -0500] taec_: kallistec: [Thu, 06 Dec 2012 23:10:15 +0000] INFO: Processing template[/etc/my.cnf] action create (mysql::client line 102) ... I'm trying to interpret this message. this looks like /etc/my.cnf is getting written every time, but stat doesn't show a modification to the file. Is it possible we have logging turned up on the chef-client run?
[2012-12-06 23:24:59 -0500] kallistec: taec_: that just says it is looking at the resource not that it's doing anything
[2012-12-06 23:24:59 -0500] mrjs: this guy: http://wiki.opscode.com/display/chef/Resources#Resources-User
[2012-12-06 23:25:52 -0500] taec_: kallistec: just found it. verbose_logging is enabled. Thanks! Usual case of ask the question, find the answer yourself ;)
[2012-12-06 23:25:53 -0500] miah: ah. the user resource doesn't support supplementary groups that i can see.
[2012-12-06 23:26:09 -0500] kallistec: taec_: it's pretty controversial whether that line should be there or not, for some people it's "logs or it didn't happen" for other people it's "eff that noise"
[2012-12-06 23:26:14 -0500] mrjs: taec_ --> its helpful to run: chef-client -l debug
[2012-12-06 23:26:22 -0500] miah: the groups resource does support 'members' though
[2012-12-06 23:26:36 -0500] miah: so you could use that to build out supplementary groups
[2012-12-06 23:26:56 -0500] poolpog: bye mrjs
[2012-12-06 23:27:01 -0500] kallistec: taec_: if you're on chef 10.14+ you can try using output formatters, e.g. chef-client -Fdoc -lfatal or chef-client -Fmin -lfatal
[2012-12-06 23:27:07 -0500] poolpog: by miah thanks for the help
[2012-12-06 23:27:13 -0500] miah: sure
[2012-12-06 23:27:21 -0500] kallistec: there's a nyan cat one now
[2012-12-06 23:27:44 -0500] mrjs: i dont see a groups resource
[2012-12-06 23:27:54 -0500] mrjs: can you drop a link to what you are referring to?
[2012-12-06 23:28:03 -0500] kallistec: https://github.com/andreacampi/nyan-cat-chef-formatter
[2012-12-06 23:29:31 -0500] mrjs: sorry my last comment was directed at miah
[2012-12-06 23:31:06 -0500] miah: http://wiki.opscode.com/display/chef/Resources#Resources-Group
[2012-12-06 23:31:32 -0500] mrjs: ah... sweet
[2012-12-06 23:31:37 -0500] mrjs: let me give that a shot
[2012-12-06 23:31:38 -0500] mrjs: thanks
[2012-12-06 23:31:48 -0500] whack: Any pointers on where I could find authentication logs for private chef? Trying to debug some auth failures against ldap, and nothing in /var/log/opscode seems to be related to webui auth calls.
[2012-12-06 23:37:37 -0500] kallistec: whack: ping support?
[2012-12-06 23:37:41 -0500] miah: whack: opensource chef logs to server-webui.log
[2012-12-06 23:37:48 -0500] miah: not sure if private chef does similar
[2012-12-06 23:38:08 -0500] yfeldblum: anyone know of a good ruby library for xml encryption?
[2012-12-06 23:38:12 -0500] whack: kallistec: I think someone has done that already, no idea on status. I just offered to help debug it since I have prior experience with ruby and ldap ;)
[2012-12-06 23:38:49 -0500] miah: also. there might be a webui.rb that configures that.
[2012-12-06 23:39:02 -0500] miah: in /etc/chef
[2012-12-06 23:39:04 -0500] kallistec: whack: yeah, I don't know off hand where to look for the logs, you can run private-chef-ctl tail and look at the files it starts tailing
[2012-12-06 23:39:07 -0500] miah: but again.. i dont really know private chef
[2012-12-06 23:39:07 -0500] whack: miah: no idea, it's REST-call soup up in the private chef ;)
[2012-12-06 23:39:13 -0500] miah: ah
[2012-12-06 23:39:42 -0500] whack: kallistec: ooh that helped, found more log files
[2012-12-06 23:43:37 -0500] troyready: Hey everyone! I'm having an issue with chef proxying that I'm hoping someone knows an easy answer to -- I've got one of my chef nodes on a very restricted subnet and I'm trying to get an HTTP proxy setup so it can access our in-house Chef server. I have nginx in place for the proxying, and the start of the chef run appears to be successful, but every run is getting ung up at the "INFO: Loading cookbooks" phase where it times out trying to contact the chef-s
[2012-12-06 23:43:39 -0500] troyready: erver's IP address directly (instead of the DNS name which is properly proxied). Changing the client.rb chef_server_url setting doesn't stop the issue, nor does specifying the server URI on the command line. It just keeps timing out with a "Error connecting to http://192.168.0.50:4000/cookbooks/users/1.1.2/files/4fcfe8f35eab41649867631d6a3456d3 - Connection timed out - connect(2)" type of message. Does anyone know of any way to get around this, or anything
[2012-12-06 23:43:41 -0500] troyready: I'm missing?
[2012-12-06 23:43:43 -0500] troyready:  (sorry for the wall of text)
[2012-12-06 23:45:08 -0500] kallistec: troyready: you need to specify the proxy to use in the client.rb
[2012-12-06 23:46:47 -0500] kallistec: also, your proxy needs to set the Host header correctly, this is how chef-server infers what hostname it should us in links it gives out
[2012-12-06 23:47:03 -0500] kallistec: *use
[2012-12-06 23:48:30 -0500] troyready: kallistec: Ahhh, that is super informative -- thanks!
[2012-12-06 23:55:49 -0500] appamatto: Is there a way for the application cookbook to invoke a custom executable?
