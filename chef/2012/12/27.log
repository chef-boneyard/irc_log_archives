[2012-12-27 00:18:42 -0500] Mez: ok, so I've bootstrapped some servers - but their IP doesn't show up in the management console - how do I get these to show up?
[2012-12-27 00:20:23 -0500] Mez: (seeing as the wiki is down
[2012-12-27 00:22:21 -0500] jblaine: Mez: the hosted chef management console?
[2012-12-27 00:22:34 -0500] Mez: jblaine: yes, and I think I've worked out why - but not how to fix it.
[2012-12-27 00:22:57 -0500] Mez: ohai uses routing to find the ip address - but I have a bit of a weird routing setup
[2012-12-27 00:26:06 -0500] jblaine: whoa, the management console UI is wiiiiide
[2012-12-27 00:28:06 -0500] occupant: evernbody has 24" monitors, right?
[2012-12-27 00:40:30 -0500] Mez: does anyone know how to get my ohai plugins to be picked up?  because they don't seem to be working
[2012-12-27 00:41:43 -0500] ranjibd: Mez, they are picked up automatically.. by normal chef runs.., which one is not working?
[2012-12-27 00:41:58 -0500] ranjibd: some of them require hints.. like ec2 inside vpn
[2012-12-27 00:42:16 -0500] Mez: ranjibd: er - one sec
[2012-12-27 00:42:24 -0500] Mez: I created a new one I think.
[2012-12-27 00:42:24 -0500] Mez: lol
[2012-12-27 00:43:04 -0500] Mez: ranjibd: https://github.com/sydiw/ohai/commit/dceb98597575ee159b2a70d163037d130f544430
[2012-12-27 00:45:59 -0500] ranjibd: Mez, wher you are dropping this file
[2012-12-27 00:46:17 -0500] Mez: /etc/chef/ohai-plugins (via the ohai cookbook)(
[2012-12-27 00:53:26 -0500] Mez: I have a feeling it's actually being ran - but not if I run ohai manaully from the command line
[2012-12-27 00:54:50 -0500] loladiro: Is there anyway to force a windows node to reboot in the middle of a chef run?
[2012-12-27 00:55:48 -0500] Mez: no, it isn't :(
[2012-12-27 00:55:54 -0500] Mez: loladiro: I doubt it.
[2012-12-27 00:58:10 -0500] btm: loladiro: create an execute resource to run the 'shutdown /r /c "chef told me to" /d 4:1 /t 0 /f' command (with correct arguments), and make sure it is the last recipe in your run list so everything else still happens.
[2012-12-27 00:58:42 -0500] loladiro: btm: Yeah, I thought about that too, but there's a few things I need to run afterwards
[2012-12-27 00:58:56 -0500] loladiro: btm: Should I just make a scheduled task or something?
[2012-12-27 00:59:09 -0500] btm: loladiro: set /t number_of_seconds_thos_things_take_to_run ?
[2012-12-27 00:59:09 -0500] miah: also make sure its action is set to :nothing and that you only notify it to :run =)
[2012-12-27 00:59:17 -0500] miah: (unless you want servers rebooting each chef run)_
[2012-12-27 00:59:45 -0500] btm: loladiro: the windows cookbook has a reboot LWRP too. http://ckbk.it/windows
[2012-12-27 01:00:03 -0500] loladiro: btm: The problem is I have a registry setting that needs to take effect before I can do anything else
[2012-12-27 01:00:17 -0500] loladiro: btm: And it only takes effect by reboot
[2012-12-27 01:01:34 -0500] Mez: loladiro: can you check if the reg key is there - if so, set it and reboot
[2012-12-27 01:01:37 -0500] Mez: if not *
[2012-12-27 01:01:48 -0500] Mez: then do the rest on the next chef run that doesn't require a reboot ?
[2012-12-27 01:02:35 -0500] loladiro: Mez: Yes, that was my idea as well. I was just wondering if there was a canonical way to do so since it seems like a common problem
[2012-12-27 01:02:53 -0500] loladiro: I might just use windows_auto_run to schedule chef to run again on the next boot
[2012-12-27 01:04:43 -0500] loladiro: I'll see how that works out (tomorrow though, it's getting late), thanks for your help Mez, btm and miah
[2012-12-27 01:10:56 -0500] Mez: argh, think I fixed the problem with the ipaddress...
[2012-12-27 01:11:02 -0500] Mez: provide vs provides
[2012-12-27 01:12:05 -0500] Mez: ah, no :(
[2012-12-27 01:12:57 -0500] Mez: aha, yes I did
[2012-12-27 03:21:01 -0500] auser: hey all
[2012-12-27 03:53:18 -0500] auser: anyone here use spiceweasel?
[2012-12-27 06:11:43 -0500] BryanWB__: ohai chefs!
[2012-12-27 06:11:58 -0500] BryanWB__: merry Christmas! happy Chanukkah!
[2012-12-27 08:47:39 -0500] chefnoob2: is there such a thing as a provisioning cookbook to provision a virtual machine using a xenserver (using the knife-xenserver gem)?
[2012-12-27 09:30:34 -0500] benner: does anybody sow this issue: "HTTP Request Returned 404 Not Found: No routes match the request: //reports/nodes/<node.fqdn>/runs"?
[2012-12-27 11:50:59 -0500] WPsites: what is the best way to deal with packages that you no longer need? Say I have the php mysql module added and then i remove  the recipe, the package will still be installed on the system right? unless it's removed?
[2012-12-27 11:55:13 -0500] BryanWB__: WPsites: correct
[2012-12-27 11:55:42 -0500] BryanWB__: u can create a cleanup recipe  that has those same package names but uses :remove  action in place of :install
[2012-12-27 11:57:19 -0500] WPsites: BryanWB__: ok. I suppose the alternative would be to just clear the server of all packages etc and run recipes fresh on the machine?
[2012-12-27 11:57:37 -0500] BryanWB__: or delete and reinstall
[2012-12-27 11:57:59 -0500] BryanWB__: WPsites: if the purpose of a machine radically changes
[2012-12-27 11:58:21 -0500] BryanWB__: i tend to reinstall rather than wipe half the packages, even on physical hardware
[2012-12-27 11:58:24 -0500] BryanWB__: my $0.02
[2012-12-27 11:58:30 -0500] WPsites: what is the process of starting fresh with a node?
[2012-12-27 11:59:04 -0500] BryanWB__: reformat the disks, bootstrap the OS and chef-client
[2012-12-27 11:59:12 -0500] BryanWB__: run chef w/ desired run_list
[2012-12-27 11:59:39 -0500] WPsites: do I just delete the client using knife? and keep the node and roles in place?
[2012-12-27 12:00:01 -0500] BryanWB__: knife client delete -y node_name && knife node delete -y node_name
[2012-12-27 12:00:04 -0500] WPsites: or do I have to delete the node data and client and really start fresh
[2012-12-27 12:00:12 -0500] WPsites: what is -y?
[2012-12-27 12:01:15 -0500] BryanWB__: confirm deletion
[2012-12-27 12:01:45 -0500] WPsites: ok cool
[2012-12-27 12:02:12 -0500] WPsites: how are you using chef BryanWB? lots of servers? you job?
[2012-12-27 12:02:25 -0500] BryanWB__: WPsites: my job
[2012-12-27 12:02:28 -0500] BryanWB__: 150 servers
[2012-12-27 12:02:40 -0500] BryanWB__: u can learn more about it here www.foodfightshow.org
[2012-12-27 12:03:34 -0500] WPsites: cool looks interesting
[2012-12-27 12:03:59 -0500] WPsites: have you used sensu?
[2012-12-27 12:05:38 -0500] BryanWB__: WPsites: no, but would like to, we also have a recent episode on that :)
[2012-12-27 12:05:52 -0500] BryanWB__: http://foodfightshow.org/2012/12/monitoringlove-with-sensu.html
[2012-12-27 12:06:54 -0500] WPsites: yes I just noticed that. I only heard about it when I watched something devops the other day. Right now I've got a monitoring system in place using graphite, sflow and logstash
[2012-12-27 12:07:03 -0500] BryanWB__: cool!
[2012-12-27 12:07:57 -0500] WPsites: thanks to chef it's quite easy to come have system in place using those separate solutions but if there is a better system I'm always interested.
[2012-12-27 12:15:11 -0500] justincampbell: theres now a #berkshelf for anyone interested
[2012-12-27 12:19:09 -0500] BryanWB__: justincampbell: awesome :)
[2012-12-27 13:39:43 -0500] jfl0wers: any one on that can talk about how Opscode::OpenSSL::Password works with chef-solo?
[2012-12-27 13:40:37 -0500] jfl0wers: I see that mysql was changed to support chef-solo in this rev: https://github.com/streamlinesocial/mysql/commit/714c7bf63de978c8f0556ba73a324ead165aa81b
[2012-12-27 13:41:06 -0500] jfl0wers: I am trying to provide the same support in the latest go the gitlab cookbook from github
[2012-12-27 13:42:15 -0500] jfl0wers: you can see in the recipe gitlab::mysql on lines 22-24 that this will fail on chef-solo
[2012-12-27 13:42:16 -0500] jfl0wers: https://github.com/atomic-penguin/cookbook-gitlab/blob/master/recipes/mysql.rb
[2012-12-27 13:42:41 -0500] jfl0wers: it fails with this message: I cannot read /etc/chef/client.pem, which you told me to use to sign requests!
[2012-12-27 13:43:42 -0500] jfl0wers: the changes to the mysql cookbook to support chef-solo seem to simply not call secure_password when the attribute is set
[2012-12-27 13:44:21 -0500] jfl0wers: is that how a chef-solo run would gain support, to set those attributes in the node.json?
[2012-12-27 13:44:49 -0500] jfl0wers: or is there some other magic going on that I am not detecting?
[2012-12-27 13:46:08 -0500] zts: jfl0wers: I can't see why Opscode::OpenSSL::Password would fail with chef-solo, particularly in the way you describe (although you're obviously not making it up, but something is weird about that)
[2012-12-27 13:46:23 -0500] zts: jfl0wers: the problem in the commit you mention appears to be in this pull request https://github.com/opscode-cookbooks/mysql/pull/31
[2012-12-27 13:46:53 -0500] jfl0wers: I have searched around with google on the error message and that is how I was lead to the fix for the mysql cookbook
[2012-12-27 13:46:54 -0500] zts: that is, that if you specify a password in your node.json, sometimes set_unless doesn't notice, and generates a new password instead
[2012-12-27 13:47:05 -0500] zts: that seems rather like a bug that should be fixed in chef-solo, but anyway
[2012-12-27 13:47:34 -0500] zts: if the problem you're trying to solve is that you'd like to specify passwords for gitlab in your node.json, following the approach introduced in that change is probably fair
[2012-12-27 13:48:49 -0500] zts: oh
[2012-12-27 13:48:55 -0500] zts: sorry, I haven't had enough coffee
[2012-12-27 13:48:56 -0500] jfl0wers: I was not trying to specify the password, but if that is what will get me around or even solve the issue then that is what I will do
[2012-12-27 13:49:15 -0500] zts: the problem is that node.save doesn't work on chef-solo, it has nothing to do with Opscode::OpenSSL::Password or set_unless
[2012-12-27 13:49:28 -0500] jfl0wers: ahh
[2012-12-27 13:50:02 -0500] zts: if you do want to generate the password, the problem you have with chef-solo is how to record the thing you generated
[2012-12-27 13:50:50 -0500] zts: https://github.com/opscode-cookbooks/mysql/blob/714c7bf63de978c8f0556ba73a324ead165aa81b/recipes/server.rb#L145 <- see that for how to add a conditional around node.save
[2012-12-27 13:50:59 -0500] jfl0wers: ooh, so that I can access the resource/server after it gets created...
[2012-12-27 13:51:06 -0500] zts: exactly
[2012-12-27 13:52:12 -0500] jfl0wers: so the ugly way would be to log it then read the console out
[2012-12-27 13:52:21 -0500] jfl0wers: working with vagrant and chef-solo...
[2012-12-27 13:52:39 -0500] zts: Yup, or slightly better would be to use the File resource to save it somewhere secure
[2012-12-27 13:53:00 -0500] jfl0wers: yep
[2012-12-27 13:53:03 -0500] jfl0wers: okay
[2012-12-27 13:53:06 -0500] zts: however!  Those are both only solutions for your first run
[2012-12-27 13:53:31 -0500] zts: the second run, chef-solo will see that it needs to generate a password, and do the same thing all over again (unless you add more logic to read the contents of the file you've saved, etc)
[2012-12-27 13:53:43 -0500] jfl0wers: hmmm
[2012-12-27 13:53:51 -0500] jfl0wers: tricky
[2012-12-27 13:53:53 -0500] zts: so requiring a password in node.json, when running under chef-solo, is probably what you'll want to do
[2012-12-27 13:54:01 -0500] jfl0wers: sounds like
[2012-12-27 13:54:08 -0500] jfl0wers: I agree
[2012-12-27 13:54:25 -0500] jfl0wers: now I understand the mysql cookbook code better
[2012-12-27 13:54:57 -0500] jfl0wers: thank you for walking me through that
[2012-12-27 13:55:07 -0500] zts: no problem, happy to help
[2012-12-27 14:14:09 -0500] skamesh: hello, can anyone tell me how do I put "Log" for skipped actions on resources
[2012-12-27 14:14:42 -0500] skamesh: when only_if conditions fails, i need to tell it in "log" that i skipped doing the action
[2012-12-27 14:18:04 -0500] zts: skamesh: I think that's logged at 'debug' level, so you'll see it if you do "chef-client -l debug"
[2012-12-27 14:20:07 -0500] skamesh: @zts but with the database cookbook  I see that information in INFO level, can we change that ?
[2012-12-27 14:23:19 -0500] bluethundr: hey guys... just build a new chef server and trying to get it to be it's own client.. rather than go with the knife bootstrap process I went whith the chef-client approach
[2012-12-27 14:23:40 -0500] bluethundr: when I do that I see a lot of 404's in the output, but my node and client is created
[2012-12-27 14:23:44 -0500] bluethundr: http://pastie.org/5584369
[2012-12-27 14:24:08 -0500] bluethundr: is this anyting that I might need to fix? or are could the 404's be innocuous at this stage?
[2012-12-27 14:25:04 -0500] skamesh: @zts thanks i see that in the debug level
[2012-12-27 14:26:28 -0500] skamesh: also what is the best way to share variables across recipes, e.g. i do this declarion a  = node['fqdn'] , do a include_recipe "my::b"
[2012-12-27 14:27:01 -0500] skamesh: i want the variable a to be visible in recipe in my::b, right now i do it via global variable making a as $a
[2012-12-27 14:27:26 -0500] skamesh: want to check if there is better alternatives / best practices around the same
[2012-12-27 14:28:37 -0500] zts: skamesh: which recipe in the database cookbook?  Possibly it has additional logic to generate log messages...
[2012-12-27 14:29:10 -0500] zts: skamesh: as for sharing data between recipes or cookbooks, using node attributes is usually the way to go
[2012-12-27 14:30:58 -0500] skamesh: @zts ok on the log, i guess that shouldn't be hard of figure out :)
[2012-12-27 14:31:35 -0500] skamesh: @zts on sharing data i agree with node option should be used as that will make it more clearer and possible overrides
[2012-12-27 14:44:45 -0500] Death_Syn: hmm, couldn't retrieve a valid package trying to upgrade my chef-client with omnibus install
[2012-12-27 14:45:01 -0500] Death_Syn: sudo true && curl -L https://opscode.com/chef/install.sh | sudo bash tried to pull from https://opscode.com/chef/download?v=&p=ubuntu&pv=12.04&m=i686
[2012-12-27 14:45:28 -0500] Death_Syn: known issue, or should i file a bug report?
[2012-12-27 14:46:09 -0500] jblaine: I believe you might need to specify a user agent
[2012-12-27 14:46:16 -0500] jblaine: or some hint
[2012-12-27 14:46:51 -0500] jblaine: I assume there's a reason for the web page's menu where OS selection takes place
[2012-12-27 14:47:01 -0500] jblaine: but totally speculating
[2012-12-27 14:48:19 -0500] Death_Syn: ahh
[2012-12-27 14:48:24 -0500] Death_Syn: a comment on the wiki entry answered it
[2012-12-27 14:48:34 -0500] Death_Syn: apparently opscode.com and www.opscode.com are not the same machine
[2012-12-27 14:48:46 -0500] Death_Syn: www. gave back the right stuff
[2012-12-27 14:50:19 -0500] jblaine: fun
[2012-12-27 14:51:36 -0500] jblaine: wildly talking out of my ass is a specialty
[2012-12-27 14:58:58 -0500] leitz: Noob question as I learn chef. Can you create your own cookbook and put it on the Opscode site for your nodes?
[2012-12-27 14:59:42 -0500] jbz: leitz:  That's the intention of the Opscode platform
[2012-12-27 15:00:10 -0500] jbz: leitz: When you sign up for the Opscode Platform, you get an 'organization' which is your own private cookbook space.
[2012-12-27 15:00:51 -0500] jbz: (generally, people put combinations of their own cookbooks and community cookbooks up to support their runlists).
[2012-12-27 15:02:20 -0500] leitz: jbz, thanks! I needed to go back and look at the website more.
[2012-12-27 15:02:29 -0500] jbz: Most welcome.
[2012-12-27 15:02:50 -0500] leitz: And trying to not embarass myself when others see my first cookbook attempts.  :)
[2012-12-27 15:02:54 -0500] jbz: nah
[2012-12-27 15:02:56 -0500] jbz: we've all been there
[2012-12-27 15:03:02 -0500] jbz: some of us are still there in many ways haha
[2012-12-27 15:03:46 -0500] leitz: jbz, interesting you should say that, and thanks. I've seen a lot of IRC conversations that assume the newbie is new to everything, not just that topic.
[2012-12-27 15:03:51 -0500] jbz: There's two parts of the site - the 'community site' is a reference site where you can post cookbooks for everyone to use.  Your organization is a 'live' site, where your nodes pull from.  That is necessarily separate and private so others can't mess with your running nodes.
[2012-12-27 15:04:02 -0500] leitz: Some IRC people seem to forget they were newbs too.
[2012-12-27 15:04:21 -0500] leitz: As long as it's free, I'm good!
[2012-12-27 15:04:24 -0500] jbz: leitz: :-) I can channel /b/ if you really *want*, but, you know, unhelpful
[2012-12-27 15:04:48 -0500] jbz: Yep, the 'first taste is free' plan is something like 5 nodes
[2012-12-27 15:05:07 -0500] jbz: Also, it makes the best way to learn it to just start messing with it :-)
[2012-12-27 15:05:31 -0500] seif: Hello, still learning chef, I am having trouble with this https://gist.github.com/4388942 I can see that teamcity_build "download-artefact" is run and downloads correctly, however the notify doesn't happen and the unzip never gets run. My understanding is that having "notifies" would cause the unzip task to run, Or am I going about this the wrong way?
[2012-12-27 15:06:54 -0500] seif: What I want is for download-artefact to only run if the file hasnt been downloaded already, and when it does run, it should run the unzip and execute.
[2012-12-27 15:07:59 -0500] jbz: hm no that looks like you're doing the right thing, unsure why it doesn't work, but I don't do windows chef
[2012-12-27 15:08:07 -0500] jbz: (well, doing 'a' right thing)
[2012-12-27 15:10:13 -0500] seif: jbz: thanks, it appears like I am doing a right thing too acoording to my understanding! but it doesnt work! :S
[2012-12-27 15:11:06 -0500] jbz: seif: Do you have your logging set to 'verbose'?
[2012-12-27 15:11:33 -0500] jbz: er, debug I mean
[2012-12-27 15:12:07 -0500] seif: Just doing a run now with knife bootstrap ... -V-V which seems to be giving more output.
[2012-12-27 15:13:24 -0500] seif: jbz: nop, it seems that only adds extra logging for knife but not for chef-client, I'll try again with -l debug for chef.
[2012-12-27 15:17:35 -0500] onyx: hi, newbie here. I've been trying to create a cookbook for CentOS 6, but the included git recipe keeps yielding exceptions. I see "Error executing action `install` on resource 'package[git]'", and in the resource declaration section of the output, lines 31-32 of cookbooks/git/recipes/default.rb are shown
[2012-12-27 15:18:22 -0500] onyx: the output also includes a compiled resource section which states 'Declared in /var/chef/cache/cookbooks/git/recipes/default.rb:31:in `from_file'
[2012-12-27 15:20:11 -0500] stefan41: does chef offer any kind of service provisioning similar to what pallet does?
[2012-12-27 15:22:25 -0500] jbz: onyx: Can you gist the output?
[2012-12-27 15:25:01 -0500] onyx: @jbz sure https://gist.github.com/4389048
[2012-12-27 15:25:24 -0500] seif: I have updated the gist https://gist.github.com/4389024 with debug output, can't see anything meaningful, is there another way to accomplish what I am after?
[2012-12-27 15:28:29 -0500] jbz: onyx: Hm, can you gist the relevant sections of the recipe?
[2012-12-27 15:28:38 -0500] jbz: Unsure which line is causing it issues
[2012-12-27 15:28:51 -0500] jbz: And is that a community recipe or yours?
[2012-12-27 15:28:55 -0500] onyx: jbz: sure give me a min
[2012-12-27 15:29:05 -0500] jbz: seif: going to have a lok
[2012-12-27 15:29:06 -0500] onyx: jbz: i'm using the opscode git recipe
[2012-12-27 15:29:07 -0500] jbz: *look
[2012-12-27 15:29:56 -0500] seif: jbz: thanks
[2012-12-27 15:30:25 -0500] jbz: seif: It doesn't look like it's notifying
[2012-12-27 15:30:31 -0500] jbz: hm
[2012-12-27 15:30:49 -0500] jbz: onyx:  I'm going to wild-guess that it's having trouble finding the package file
[2012-12-27 15:30:55 -0500] jbz: but I can't tell you for sure
[2012-12-27 15:31:10 -0500] seif: jbz: yeah, is there some specific code the a resource author needs to write in order for notifications to work?
[2012-12-27 15:33:31 -0500] jbz: there shouldn't be, no
[2012-12-27 15:34:28 -0500] onyx: jbz:here is the gist https://gist.github.com/4389085; i'm guessing the error has something to do with that too
[2012-12-27 15:35:32 -0500] onyx: can i check if it's possible to override recipes by simply modifying them on my chef workstation, and re-uploading the corresponding cookbook?
[2012-12-27 15:37:41 -0500] jbz: onyx: sure, if I understand you correctly
[2012-12-27 15:37:49 -0500] onyx: i'm thinking of modifying the "when 5" condition for RHEL to "when 5, 6" so that execution for CentOS 6.x also falls into that branch
[2012-12-27 15:38:01 -0500] onyx: jbz: thanks let me try that
[2012-12-27 15:41:10 -0500] skamesh: how to do we clear the cached node attributes between runs ?
[2012-12-27 15:42:00 -0500] skamesh: i have some node attributes in my attributes/default.rb, i update it between runs but its not getting reflected in the subsequent runs
[2012-12-27 15:46:20 -0500] jbz: onyx:  That in fact sounds like you got it
[2012-12-27 15:48:22 -0500] jbz: Any Windows types here able to look at seif's notifies to see why they're not firing?
[2012-12-27 15:52:02 -0500] seif: jbz cheers, I thought you walked out on me and have posted the question on the mailing list as well. hope that doesn't count as double posting
[2012-12-27 15:52:47 -0500] jbz: seif: Nope it doesn't. Sorry I couldn't help with that.
[2012-12-27 15:53:10 -0500] seif: jbz: no worries, thanks a lot
[2012-12-27 15:55:04 -0500] jbz: seif:  Might be worth checking to see if notifications are working in general by having the default action for the second resource be unzip rather than relying on the notify, and seeing if *it* properly notifies its own dependent resource.
[2012-12-27 15:55:09 -0500] jbz: Just for debugging
[2012-12-27 15:56:31 -0500] seif: jbz: will do
[2012-12-27 15:57:55 -0500] jbz: seif:  hey, this is a stupid idea, but
[2012-12-27 15:57:58 -0500] jbz: in the old days (haha)
[2012-12-27 15:58:12 -0500] jbz: you used to have to declare dependent resources *before* their notifiers
[2012-12-27 15:58:32 -0500] jbz: so you might try reversing their order in th recipe and seeing what happens.  Low probability of relevance/success, but non-zero.
[2012-12-27 15:58:33 -0500] sethvargo: how can I use resources in shef? I keep getting undefined method errors
[2012-12-27 15:58:48 -0500] seif: jbz: yeah, I noticed some of the examples were doing that, I tried it though, and it was the same result.
[2012-12-27 15:58:56 -0500] leitz: I'm getting a failure to authenticate error with the same key's my workstation is using. Are client keys unique?  http://pastebin.com/SansEN4z
[2012-12-27 16:00:24 -0500] jbz: leitz: if you have the same validator key (not the same as the client key) on the node, it should work, unless a client with that name already exists on the chef server
[2012-12-27 16:01:12 -0500] jbz: leitz: If you're creating/dropping/creating nodes with the same name, the *client* record (separate from the node) might still exist on the server, in which case a new node with that name can't validate.
[2012-12-27 16:01:45 -0500] leitz: jbz, I thouhgt I had to create the client in the org before running chef-client on the node?
[2012-12-27 16:02:27 -0500] jbz: leitz: Nope.  The org has a 'validator key.'  The first time the node makes contact with Opscode, it can and will use that key to create a client for itself (that's all that key is good for, validating and creating new registrations).
[2012-12-27 16:02:44 -0500] jbz: Once the client is created, as part of that process, the node will download its new client key.
[2012-12-27 16:05:14 -0500] leitz: jbz, is there a way, besides just "delete" ing the node on the org site, to ensure names can be reused?
[2012-12-27 16:06:01 -0500] jbz: Nope (and you have to delete the *client*, not the node).  We just use AWS instance IDs as part of the chef node name to ensure uniqueness
[2012-12-27 16:07:26 -0500] leitz: Hmm...it's using my_org-validator.pem to log in. Is that the wrong thing for the new node to use? It doesn't exist as a client.
[2012-12-27 16:08:00 -0500] seif: jbz: that got me a bit closer, https://gist.github.com/4389373  the notify did work from the unzip, but changed 2 things there, moved the execute with action:nothing to the top, and changed the unzip to have run regardless of notification. I guess next step is moving the unzip to the top as well and revert the action to nothing
[2012-12-27 16:08:05 -0500] jbz: No, that's correct. On initial contact, it will use that; then it should register itself and get a client record and node record created and download the private half of that key.
[2012-12-27 16:09:33 -0500] seif: jbz got a response on the mailing list, http://tickets.opscode.com/browse/CHEF-3681
[2012-12-27 16:11:04 -0500] jbz: seif: Ah, it's a lwrp problemI see...
[2012-12-27 16:11:10 -0500] seif: jbz: it is a bug in the LWRP DSL, at least I know I am not being stupid, not to do the proposed solution/changes in that resource. thanks for your help
[2012-12-27 16:11:24 -0500] jbz: most welcome, thanks for showing me the response
[2012-12-27 16:29:11 -0500] leitz: Odd, but okay. I had another node so I copied over the validation.pem from that and things worked.
[2012-12-27 16:33:34 -0500] jbz: leitz:  The purpose of that is so that you don't have to deploy a security-sensitive credential (well, *as* sensitive) to new nodes or to tools which build new nodesthus you can automatically stand up new nodes without humans shuffling sensitive stuff around.
[2012-12-27 16:35:29 -0500] leitz: jbz, not sure I get that. /etc/chef is world readable, so someone with a user account could create their own node and get your databags and such, couldn't they?
[2012-12-27 16:35:57 -0500] leitz: Also, I'm trying to figure out why it's failing to install a yum package.  :)
[2012-12-27 16:36:09 -0500] jbz: leitz:  Let me give you an example from our case.  We stand up tons and tons of instances automatically using our deployment toolstack.
[2012-12-27 16:36:30 -0500] jbz: Once the chef runlist runs once, the nodes come up secured with appropriate keys on to provide appropriate access
[2012-12-27 16:36:30 -0500] jbz: but
[2012-12-27 16:36:53 -0500] jbz: we can put the 'validator' key into our deployment toolstack without worrying that someone who manages to nab it will be able to log on to or otherwise affect a running node.
[2012-12-27 16:37:06 -0500] jbz: All they can do if they compromise that key is stand up a *new* node in our org
[2012-12-27 16:37:16 -0500] jbz: that's not nothing, but it's a lot better than being able to affect running nodes.
[2012-12-27 16:38:03 -0500] jbz: (part of our runlist actually deletes the validator key from the new node, too, just to be sure).
[2012-12-27 16:39:40 -0500] leitz: Good idea, but if your default config adds users and passwords, they could stand up a node and get the root protectd files for cracking, couldn't they?
[2012-12-27 16:40:00 -0500] leitz: On another note, the yum failure was a dependency issue, not a yum problem.
[2012-12-27 16:40:07 -0500] leitz: Sorry, not a chef problem.
[2012-12-27 16:40:38 -0500] jbz: leitz:  No, because it only adds one or two users from the maintenance team for that particular app.
[2012-12-27 16:40:51 -0500] jbz: And it doesn't add passwords, just ssh keys.
[2012-12-27 16:40:56 -0500] jbz: Public ones, obv.
[2012-12-27 16:41:48 -0500] leitz: That sounds pretty good, then.
[2012-12-27 16:42:12 -0500] leitz: I think your level of security consciousness is higher than at some places I've seen.
[2012-12-27 16:42:17 -0500] jbz: Plus of course we have inbound ssh ports limited using EC2 security groups, etc.
[2012-12-27 16:42:19 -0500] jbz: yeah well
[2012-12-27 16:42:24 -0500] jbz: my developers call me 'The Shouty Man'
[2012-12-27 16:42:34 -0500] leitz: :)
[2012-12-27 16:42:44 -0500] jbz: because I tend to blast in to new product planning meetings or development meetings and start shouting inchoately Gandalf-style
[2012-12-27 16:42:53 -0500] jbz: because they're doing something insecure/dumb.
[2012-12-27 17:03:15 -0500] leitz: Is there a good sample recipe to show how to wget rpms and install them outside of yum?
[2012-12-27 17:10:56 -0500] chip-: leitz: Don't have sample code but I can link you to this: http://docs.opscode.com/chef/resources.html#id72 and http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-12-27 17:11:06 -0500] chip-: leitz: you'd use rpm_package to install a straight rpm
[2012-12-27 17:26:20 -0500] leitz: chip-, thanks! I'm grubbing through a yumrepo cook book for ideas.
[2012-12-27 17:26:54 -0500] chip-: should be as simple as rpm_package "name", then source: path or URL.
[2012-12-27 18:13:55 -0500] Javin: Hi all. I am upgrading from chef 10.6 to 10.16.4 and I have cleaned up a few warnings about node attributes being set without precedence, but I am still getting to error similar to the one documented in CHEF-3667 (http://tickets.opscode.com/browse/CHEF-3667). Is there a documented way to determine what recipe/attribute/etc. is generating these errors?
[2012-12-27 18:17:58 -0500] ranjibd: Javin, have tried using the log level debug?
[2012-12-27 18:18:00 -0500] cheflevelramen: Hi All, could any point me to documentation on how to catch exceptions in Recipes? I'm not very familiar with Ruby, which I assume is how you would do it.
[2012-12-27 18:18:37 -0500] ranjibd: cheflevelramen, in your client.rb , set log_level= :debug
[2012-12-27 18:18:46 -0500] Javin: ranjibd: Yes, and it doesn't improve the message at all, unfortunately.
[2012-12-27 18:19:23 -0500] cwj: cheflevelramen: http://rubylearning.com/satishtalim/ruby_exceptions.html
[2012-12-27 18:19:25 -0500] cheflevelramen: ranjibd: Sorry, I mean that if a resource fails, I'd like to do something about it. I can see the exception already with debug
[2012-12-27 18:20:16 -0500] ranjibd: cheflevelramen, theres an ignore failure construct , that is available to all resources, it lets you carry on even if the resource fails
[2012-12-27 18:20:30 -0500] cwj: there's also some built in attributes in all resources, e.g. ignore_failure and retry
[2012-12-27 18:20:31 -0500] ranjibd: but if you want a fall back.. im not sure a clean way to do this
[2012-12-27 18:20:33 -0500] Javin: I had some similar errors in some attribute files and the stack trace pointed to them very obviously, but these last two seem to break deep in the chef gem code and there is no mention of the culprit cookbook/recipe
[2012-12-27 18:20:35 -0500] cwj: er retries
[2012-12-27 18:20:56 -0500] cheflevelramen: cwj: Thanks, and I assume I can enclose a resource in a ruby begin/end statement?
[2012-12-27 18:21:12 -0500] ranjibd: cheflevelramen, you can use ruby_block and try using the resource there wrapped by a rescue block. but that would be ugly
[2012-12-27 18:21:24 -0500] cwj: cheflevelramen: you can try enclosing resources in begin/rescue/end but it will probably not work the way you expect
[2012-12-27 18:22:05 -0500] cwj: cheflevelramen: because ruby outside of a ruby_block resource is evaluated before convergence of resources
[2012-12-27 18:22:27 -0500] maplebed: So I'm reading the wiki and it claims the node deletion script at the end of the page doesn't work, and yet for me it does.  Is it going to break in a newer version of chef?  or was it broken in an older version and now works again?  http://wiki.opscode.com/display/chef/Knife+Exec#KnifeExec-UseCaseScenario
[2012-12-27 18:22:31 -0500] ranjibd: Javin, chef-shell/shef ?
[2012-12-27 18:22:43 -0500] cheflevelramen: Hmm, okay. The specific issue I'm having is with the AWS cookbook. I'm trying to create/attach ebs volumes to an instance. If an ebs volume is deleted from AWS, it's still associated with the node object, and so the recipe returns:
[2012-12-27 18:22:47 -0500] cheflevelramen: Volume with id vol-5c506b23 is registered with the node but does not exist in EC2. To clear this error, remove the ['aws']['ebs_volume']['mysql_data']['volume_id'] entry from this node's data.
[2012-12-27 18:23:32 -0500] ranjibd: cheflevelramen, why dont you do a compile time check for that ebs?
[2012-12-27 18:23:43 -0500] ranjibd: using raw aws sdk/fog...
[2012-12-27 18:23:50 -0500] maplebed: (in case you want sample code)
[2012-12-27 18:24:40 -0500] cheflevelramen: ranjibd: Yea, I see that as a possible solution, though I don't have any other use yet for using aws cli or fog libraries, so I was trying to find a simpler solution if possible
[2012-12-27 18:24:40 -0500] Javin: ranjidb: I haven't tried shef yet. That is likely a good place to try and track it down. Thanks
[2012-12-27 18:24:45 -0500] ranjibd: last time i looked at aws sdk it was using right-aws , and it was installing library at compile time. so i guess you can use right aws to check if the volume exists in an `if ` construct
[2012-12-27 18:25:21 -0500] maplebed: https://gist.github.com/4390624 <-- search for attached EBS volumes
[2012-12-27 18:25:28 -0500] cheflevelramen: ranjibd: That's true, good idea. Sorry for being such a novice, but what would be the basic syntax on how to check for that in shef?
[2012-12-27 18:25:34 -0500] cwj: cheflevelramen: the aws cookbook installs rightaws and provides ec2 methods you can reuse in other cookbooks
[2012-12-27 18:25:42 -0500] cwj: https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb
[2012-12-27 18:26:33 -0500] cheflevelramen: maplebed: That gist looks very good, thanks. Do you know if the right-aws gem includes the fog libraries?
[2012-12-27 18:26:36 -0500] ranjibd: cheflevelramen, maplebed just shared the snippet
[2012-12-27 18:26:54 -0500] cwj: right-aws and fog share no code
[2012-12-27 18:27:01 -0500] maplebed: I'm not clear on the relationship between the right_aws stuff and the fog stuff.  sfaik they're separate and fog is better.
[2012-12-27 18:27:17 -0500] maplebed: but I'm no authority on the matter.
[2012-12-27 18:27:32 -0500] ranjibd: cheflevelramen, you can use  "gem_package('fog').run_action(:install)"
[2012-12-27 18:27:58 -0500] ranjibd: this will ensure fog is installed.
[2012-12-27 18:28:00 -0500] cheflevelramen: ranjibd: Perfect, I'll give that a go and use maplebed's snippet as an example. Thanks guys
[2012-12-27 18:28:46 -0500] maplebed: fwiw, the context of that snippet is that on instance shutdown I want to do a bunch of stuff (delete the now-unused volumes, clear out route53, and delete the node and client entries from chef)
[2012-12-27 18:29:24 -0500] cheflevelramen: maplebed: Cool, thanks. I think I get the idea, so should be able to work it out.
[2012-12-27 18:35:05 -0500] Toger: I'd like to use a node attribute in a script receipe. Is this the correct format?  environment { 'MYVAR' => node[:mycategory][:myattribute] }    and then use $MYVAR in the script itself?
[2012-12-27 18:36:29 -0500] maplebed: Toger: what do you mean by a script recipe? knef script, cookbook recipe, template, or something different?
[2012-12-27 18:36:52 -0500] Toger: script block in a cookbook receipe
[2012-12-27 18:37:46 -0500] Toger: it running a bash shell script, and I want to use a node attribute within the script.
[2012-12-27 18:38:40 -0500] maplebed: ah.  http://wiki.opscode.com/display/chef/Resources#Resources-Script, right?  I've never used one, sorry.
[2012-12-27 18:39:20 -0500] Toger: yes. specifically the optional 'environment' argument
[2012-12-27 18:39:29 -0500] maplebed: I would guess #{varname}, but just a guess...
[2012-12-27 18:39:42 -0500] cwj: Toger: that looks right to me
[2012-12-27 18:40:05 -0500] cwj: you might need
[2012-12-27 18:40:23 -0500] cwj: environment({'MYVAR' => node[:mycategory][:myattribute])
[2012-12-27 18:40:27 -0500] cwj: parens around the hash
[2012-12-27 18:40:39 -0500] Toger: Thank you
[2012-12-27 18:40:41 -0500] cwj: which i did not properly terminate with a closing }
[2012-12-27 19:05:01 -0500] maplebed: any fog experts around?  I'm trying to find the DNS entry for a host (using Fog::DNS) and zones.get(zone_id) only returns the first 100 or so records.  How do I get the rest?
[2012-12-27 19:07:11 -0500] jbz: maplebed: What cloud provider?
[2012-12-27 19:07:22 -0500] maplebed: AWS.  (sorry, shoulda said.)
[2012-12-27 19:08:25 -0500] jbz: we ran into a similar problem with another fog call where AWS would only return 100 at a time
[2012-12-27 19:08:35 -0500] jbz: (RDS snapshots)
[2012-12-27 19:08:46 -0500] jbz: is there perhaps a similar API limit on DNS zones?
[2012-12-27 19:08:55 -0500] maplebed: likely.
[2012-12-27 19:09:16 -0500] maplebed: I would hope though, that there would be some method within fog of saying 'continue with the next burch)
[2012-12-27 19:09:28 -0500] jbz: heh
[2012-12-27 19:09:30 -0500] jbz: hope springs eternal
[2012-12-27 19:09:40 -0500] jbz: there wasn't in the RDS snapshot case.
[2012-12-27 19:09:41 -0500] maplebed: yes.  I am ever the optimist.
[2012-12-27 19:10:03 -0500] maplebed: Did you fork/patch/upstream?  or maybe have it somewhere I could glance at?
[2012-12-27 19:10:51 -0500] jbz: we haven't yet this happened to us today
[2012-12-27 19:10:52 -0500] jbz: but
[2012-12-27 19:11:03 -0500] jbz: here: http://rubydoc.info/gems/fog/1.1.2/Fog/DNS/AWS/Zones
[2012-12-27 19:11:06 -0500] jbz: there is a 'marker' option
[2012-12-27 19:11:12 -0500] jbz: which is an AWS thing
[2012-12-27 19:11:30 -0500] jbz: If you make a call with a marker, it will give you N (option) number starting at 'marker'
[2012-12-27 19:13:05 -0500] jbz: I haven't done it, but I'd pull a list using the AWS CLI tools and see if 'marker' is obvious.
[2012-12-27 19:13:31 -0500] maplebed: marker would be one of the options to pass to the all method?
[2012-12-27 19:13:59 -0500] maplebed: oh hey, there's also a 'max_items' option.
[2012-12-27 19:14:21 -0500] maplebed: maxitems = 1 meeeeeeellion records!
[2012-12-27 19:14:26 -0500] jbz: well
[2012-12-27 19:14:32 -0500] jbz: I think max_items is the number fog will return
[2012-12-27 19:14:40 -0500] jbz: but I think there's an AWS 'hard limit' of 100
[2012-12-27 19:14:45 -0500] maplebed: ::sigh::
[2012-12-27 19:14:56 -0500] maplebed: ok, I'll give that a shot.  tnx.
[2012-12-27 19:15:00 -0500] jbz: yeah, marker would be an option to pass.
[2012-12-27 19:15:02 -0500] jbz: Good luck!
[2012-12-27 19:15:06 -0500] jbz: sorry I couldn't be more help
[2012-12-27 19:15:20 -0500] maplebed: hey, it's a direction, which was more than I had before.
[2012-12-27 19:23:32 -0500] makmanalp: hello, I have this really baffling issue about this resource being executed even though the only_if should be false
[2012-12-27 19:23:36 -0500] makmanalp: http://pastie.org/private/82joqfams8xnfhwtmlz3q
[2012-12-27 19:23:43 -0500] makmanalp: anyone think they can double-check my logic?
[2012-12-27 19:24:11 -0500] makmanalp: I've tried the same only_if command on ssh and it returns 1
[2012-12-27 19:25:37 -0500] jbz: makmanalp: from the Opscode chef docs on conditionals:
[2012-12-27 19:25:53 -0500] jbz: "only_if
[2012-12-27 19:25:54 -0500] jbz: Only apply this resource if the given string (shell command) or block (ruby code) results in return code 0 or is true."
[2012-12-27 19:26:15 -0500] jbz: is that wrong?
[2012-12-27 19:26:35 -0500] makmanalp: jbz: exactly, it returns 1 so it should not execute
[2012-12-27 19:26:46 -0500] jbz: Oh I see
[2012-12-27 19:26:58 -0500] makmanalp: but it does, and of course it fails because the process it's trying to kill doesn't eist
[2012-12-27 19:27:01 -0500] makmanalp: *exist
[2012-12-27 19:27:14 -0500] makmanalp: i'm pulling my hair out at this point
[2012-12-27 19:27:42 -0500] makmanalp: I wish debug mode was better and showed only_if output too
[2012-12-27 19:27:57 -0500] jbz: oh wait
[2012-12-27 19:28:04 -0500] jbz: I have vague memories of piped commands causing issues
[2012-12-27 19:28:13 -0500] maplebed: makmanalp: you might try playing with pgrep instead of ps | grep
[2012-12-27 19:29:10 -0500] makmanalp: jbz: hmm will research that
[2012-12-27 19:29:15 -0500] makmanalp: maplebed: will try that too
[2012-12-27 19:29:48 -0500] maplebed: does postgres  not play well with the service resource?
[2012-12-27 19:30:39 -0500] makmanalp: it does, I just want to kill the stupid service resource with fire
[2012-12-27 19:31:34 -0500] makmanalp: and i've attempted to use chef-rewind to stop the service but the config also notifies the service restart
[2012-12-27 19:31:59 -0500] makmanalp: i'm using supervisord and want nothing to do with initd
[2012-12-27 19:43:32 -0500] maplebed: jbz: for future reference, there are two discoveries I made:
[2012-12-27 19:43:49 -0500] maplebed: * the records class has both an all and all! method; the latter really does return all records, not capped at 100.
[2012-12-27 19:44:07 -0500] maplebed: * the records class also has a get() function so I can actually just get the one I want rather than searching through the list.
[2012-12-27 19:50:55 -0500] jbz: maplebed: Ah, sweet!
[2012-12-27 19:53:41 -0500] miah: hi
[2012-12-27 20:24:06 -0500] akincer: Hello. I've followed the beginning documentation to setup a server and a single client for testing the open source version and the NTP recipe isn't working. Both client and server are Ubuntu 12.04. The chef client log on the client shows this error: ERROR: Chef::Exceptions::ResourceNotFound: resource template[/etc/ntp.conf] is configured to notify resource service[ntp] with action restart, but service[ntp] cannot be found in the resou
[2012-12-27 20:24:25 -0500] akincer: Any good ideas on where to start?
[2012-12-27 20:26:13 -0500] akincer: It appears that the part of the recipe at the top to do the install is failing
[2012-12-27 20:26:29 -0500] akincer: or at least ntp isn't being installed
[2012-12-27 20:26:32 -0500] jbz: Ah, do you have logs for that part you could pastie?
[2012-12-27 20:26:36 -0500] jbz: or gist or whatever?
[2012-12-27 20:26:59 -0500] akincer: Sure, one se
[2012-12-27 20:27:00 -0500] akincer: sec
[2012-12-27 20:29:09 -0500] akincer: http://pastebin.com/aDw9rwvV
[2012-12-27 20:30:37 -0500] akincer: I'm sure I've made a typo or something somewhere
[2012-12-27 20:32:41 -0500] jbz: akincer: Hm...
[2012-12-27 20:33:06 -0500] jbz: so it gets the cookbook properly, so the server seems to be working
[2012-12-27 20:36:08 -0500] akincer: Yes, it just seems the client doesn't want to work correctly
[2012-12-27 20:36:38 -0500] akincer: The client shows up in the server and it shows lots of info about it, so it's communicating
[2012-12-27 20:37:02 -0500] jbz: can you point me to which ntp cookbook you used?
[2012-12-27 20:39:54 -0500] akincer: Sure -- http://wiki.opscode.com/display/chef/Guide+to+Creating+A+Cookbook+and+Writing+A+Recipe
[2012-12-27 20:40:31 -0500] jbz: OK
[2012-12-27 20:40:37 -0500] jbz: that has service[ntpd] not [ntp]
[2012-12-27 20:42:18 -0500] akincer: ok, well maybe I'm just confused as to what this recipe is supposed to do. My goal was to have a recipe to A) install ntpd on a server if it isn't already there and B) configure it properly
[2012-12-27 20:43:06 -0500] akincer: I thought that was the point of that recipe, but I might not have read enough before diving in
[2012-12-27 20:44:20 -0500] jbz: nono
[2012-12-27 20:44:21 -0500] jbz: I meant
[2012-12-27 20:44:29 -0500] jbz: your recipe is trying to call service[ntp]
[2012-12-27 20:44:31 -0500] jbz: and that's failing
[2012-12-27 20:44:41 -0500] jbz: because the service in the example you showed me is name d[ntpd] not [ntp]
[2012-12-27 20:44:56 -0500] jbz: The error claims it can't find service[ntp]
[2012-12-27 20:46:12 -0500] akincer: I'm a complete noob with chef. I figured it automagically knew what it was doing based on recipe magic.
[2012-12-27 20:47:30 -0500] jbz: akincer:  No.  The recipe has to declare the resource.
[2012-12-27 20:47:44 -0500] jbz: That recipe in the example, if you put it in exactly, declares a resource of type 'service' named 'ntpd'
[2012-12-27 20:48:16 -0500] jbz: and it looks like, from the error, you typoed the 'notifies' section and it is trying to call service[ntp] instead of service[ntpd].
[2012-12-27 20:48:31 -0500] akincer: let me have a look
[2012-12-27 20:53:51 -0500] akincer: yes I did indeed have a typo :) now I have a new error. Over under on another typo at play? :)
[2012-12-27 20:54:06 -0500] akincer: Chef::Exceptions::Exec: service[ntpd] (ntp::default line 13) had an error: Chef::Exceptions::Exec: /usr/sbin/update-rc.d ntpd defaults returned 1, expected 0
[2012-12-27 20:55:34 -0500] gondoi: anyone still seeing this with the current releases of test-kitchen? https://github.com/calavera/minitest-chef-handler/pull/33
[2012-12-27 20:55:48 -0500] jbz: akincer: You are running this as root, correct?
[2012-12-27 20:56:59 -0500] akincer: Yes. It managed to create a file in /etc which it can't do without root privileges
[2012-12-27 20:57:14 -0500] maplebed: Is there a default for knife's 'script_path' config?
[2012-12-27 20:57:48 -0500] maplebed: eg 'knife exec foo.rb' => 'ERROR: "foo.rb" not found in current directory or script_path, giving up.'
[2012-12-27 20:58:35 -0500] jbz: akincer:  If you try to run that command manually as root, does it give you any more info?  ("/usr/sbin/update-rc.d ntpd defaults")
[2012-12-27 20:59:31 -0500] akincer: it seems it managed to install ntp just fine
[2012-12-27 21:00:39 -0500] jbz: akincer:  I'm not sure, then, it sounds like something was in an unexpected state on your node
[2012-12-27 21:01:47 -0500] akincer: ok, here's what's happening and I think you kind of hinted. Ubuntu refers to ntpd in /etc/init.d as just ntp (i.e. without the d) and the tutorial has the "d" in it
[2012-12-27 21:02:15 -0500] akincer: so when it tries to add the service, it fails because the file getting placed in init.d is just "ntp"
[2012-12-27 21:02:27 -0500] jbz: aha
[2012-12-27 21:02:32 -0500] jbz: this may be an Ubuntu version issue
[2012-12-27 21:02:48 -0500] jbz: i.e. different Ubuntu versions doing different things, and the example recipe making assumptions.
[2012-12-27 21:03:15 -0500] jbz: So to fix, you should just rename the service resource in the recipe 'ntp' and change the 'notifies' to 'ntp' as well.
[2012-12-27 21:03:53 -0500] akincer: bingo, that fixed it. So do recipes need to be OS specific?
[2012-12-27 21:03:58 -0500] jfl0wers_: anyone seen this error before: Cannot find a resource for grant_statement on centos version 6.3
[2012-12-27 21:04:28 -0500] jbz: akincer:  Yes indeed.  They can have 'default' options which work generically, but if OSes handle things differently, you need case statements and different versions of templates and etc. to deal.
[2012-12-27 21:04:35 -0500] jfl0wers_: this is for the resource mysql_database_user
[2012-12-27 21:05:22 -0500] akincer: Makes sense. I mean you could bake all that into the system I guess, but that removes power from the admin writing the scripts I suppose
[2012-12-27 21:06:02 -0500] akincer: plus it would have to make way too many assumptions
[2012-12-27 21:06:09 -0500] jbz: The providers are written to be as generic as possible; even then, you can't be fully abstract
[2012-12-27 21:06:36 -0500] jbz: it makes writing cookbooks for public consumption a bit harder because you need to take these things into account, whereas ones for your own standard setup can just make assumptions.
[2012-12-27 21:07:03 -0500] jbz: If you download cookbooks from the community sources (like ckbk.it) you'll find they have lots of case handling.
[2012-12-27 21:07:29 -0500] akincer: Yes I do see that now that I know WHY it failed. I'll dig around and see what I can find. I appreciate your assistance.
[2012-12-27 21:07:42 -0500] jbz: Things like templates live in a folder structure explicitly designed to deal with that - the reason the template lives in /templates/default indicates it's generic.  If there was one in /templates/ubuntu/10.04 it would use that if appropriate, etc.
[2012-12-27 21:07:53 -0500] jbz: Cheers.
[2012-12-27 21:08:20 -0500] akincer: Got lots to learn I see
[2012-12-27 21:08:52 -0500] jbz: Chef is pretty powerful.  "With great power comes great responsibility."  s/great/wide in this case...
[2012-12-27 21:09:55 -0500] akincer: LOL well yeah. In my case, I want to help streamline rolling out new builds and, if possible, help operations if any minor config changes need to be made
[2012-12-27 21:10:07 -0500] akincer: based on my reading, that's what chef does, so ...
[2012-12-27 21:10:23 -0500] jbz: Yep!
[2012-12-27 21:10:51 -0500] jbz: Keep in mind that idempotency is a goal in a Chef setup, not a given
[2012-12-27 21:11:00 -0500] jbz: so if you're going to have persistent client nodes
[2012-12-27 21:11:31 -0500] jbz: remember to be very careful about understanding when they can be changed and when doing so will cause you to 'break rollback'
[2012-12-27 21:11:54 -0500] jbz: Best example - it's always tempting to install things that don't have nice packages using tarballs and exec statements
[2012-12-27 21:12:26 -0500] jbz: but that's a one-way change, you can't uninstall that using Chef, and Chef won't really know it's there other than via slightly hackish test conditionals - which you are responsible for putting into anything that needs to know.
[2012-12-27 21:14:24 -0500] akincer: Well, for rolling out our new builds, no problem. Getting the apps team on board to use it too? Uhhh, riiiight. If I can keep the app agnostic stuff in line, that will be great (ntp, DNS settings, user accounts, etc)
[2012-12-27 21:16:12 -0500] akincer: Not saying it couldn't happen mind you, that would just open the scope far wider than my primary concern
[2012-12-27 21:39:57 -0500] benner: does anybody sow this issue: "HTTP Request Returned 404 Not Found: No routes match the request: //reports/nodes/<node.fqdn>/runs"?
[2012-12-27 21:46:12 -0500] juliancdunn: benner: afaik that's normal if you're running Open Source Chef
[2012-12-27 21:46:41 -0500] juliancdunn: client-side functionality for Chef 11 not implemented in Chef 10 server
[2012-12-27 21:49:29 -0500] benner: juliancdunn: but it's 0.10.6:
[2012-12-27 21:49:29 -0500] benner: # grep 'Chef 0.10.6' /var/log/chef/client.log | tail -1
[2012-12-27 21:49:30 -0500] benner: [Mon, 17 Dec 2012 18:51:56 +0200] INFO: *** Chef 0.10.6 ***
[2012-12-27 21:50:50 -0500] benner: and sever is the same (newer?):
[2012-12-27 21:50:50 -0500] benner: # dpkg -l | grep chef-server-api | awk '{ print $3 }'
[2012-12-27 21:50:50 -0500] benner: 10.16.4-1
[2012-12-27 21:53:08 -0500] cheflevelramen: Hi again. How do you remove an item from the node object? Here's the error I'm getting using the AWS cookbook:
[2012-12-27 21:53:12 -0500] cheflevelramen: Volume with id  is registered with the node but does not exist in EC2. To clear this error, remove the ['aws']['ebs_volume']['mysql_data']['volume_id'] entry from this node's data.
[2012-12-27 21:54:00 -0500] maplebed: cheflevelramen: you can fix it by hand by running 'knife node edit' and munging the json
[2012-12-27 21:54:23 -0500] maplebed: if it's happening to you on a regular basis, there's an error in your cookbook somewhere.
[2012-12-27 21:54:25 -0500] cheflevelramen: maplebed: Any way to do that programmitcally from a recipe
[2012-12-27 21:55:28 -0500] cheflevelramen: maplebed: it happened by doing this: I used the cookbook to create a volume. I later manually deleted that volume. In the cookbook I increased the size of the volume. Then I ran it and got that error.
[2012-12-27 21:56:34 -0500] benner: cheflevelramen: sure. you can pre-pend your runlist and remove needed atributs from recipe
[2012-12-27 21:57:27 -0500] maplebed: I would expect that if you're manually deleting the volume, you'll probably have to manually remove the attributes.  thankfully, benner has a better idea...  ;)
[2012-12-27 21:57:28 -0500] benner: you can allways can do node.save/reload ohai data and so on
[2012-12-27 21:58:36 -0500] cheflevelramen: benner: Interesting. Here's the approach I was taking: http://pastebin.com/6dYDe8MW
[2012-12-27 21:59:02 -0500] cheflevelramen: benner: How would I reload ohai data before a chef run? Would it go in the role?
[2012-12-27 22:00:04 -0500] benner: i'm not remember here but there example in chef wiki (creating user and getting it uid)
[2012-12-27 22:00:08 -0500] benner: o min
[2012-12-27 22:12:46 -0500] cheflevelramen: This seems to work in shef:
[2012-12-27 22:12:47 -0500] cheflevelramen: node['aws']['ebs_volume'].delete(:mysql_data)
[2012-12-27 22:13:06 -0500] cheflevelramen: But if I leave shef and start it again, I can see that the attribute still exists
[2012-12-27 22:13:50 -0500] cheflevelramen: Does shef just not make permanent changes?
[2012-12-27 22:13:52 -0500] benner: cheflevelramen:
[2012-12-27 22:14:01 -0500] benner: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-12-27 22:14:15 -0500] benner: and i thin other is
[2012-12-27 22:14:16 -0500] benner: ohai "reload" do action :reload
[2012-12-27 22:14:21 -0500] benner: end
[2012-12-27 22:14:29 -0500] benner: s/ruby syntax/corrected/
[2012-12-27 22:15:12 -0500] benner: cheflevelramen: i think chef does changes on node.save
[2012-12-27 22:16:48 -0500] benner: in dirty you can allways do shef -z; node.delete :blabla; node.save :-)
[2012-12-27 22:17:47 -0500] cheflevelramen: benner: Nice, so this worked:
[2012-12-27 22:17:47 -0500] cheflevelramen: node['aws']['ebs_volume']['mysql_data']['volume_id']
[2012-12-27 22:17:47 -0500] cheflevelramen: node['aws']['ebs_volume'].delete(:mysql_data)
[2012-12-27 22:17:48 -0500] cheflevelramen: node.save
[2012-12-27 22:18:17 -0500] cheflevelramen: benner: But that is probably not a very clean way to do it I take it?
[2012-12-27 22:19:21 -0500] cheflevelramen: benner: I like the idea of ohai reload, but I'm not sure how to run that
[2012-12-27 22:19:46 -0500] cheflevelramen: Would I just put this in the recipe:
[2012-12-27 22:19:47 -0500] cheflevelramen: ohai "reload" do  action :reload
[2012-12-27 22:19:47 -0500] cheflevelramen: end
[2012-12-27 22:19:47 -0500] benner: i'm not a geneus of chef. other can say if it cool way to do whings. for me sometimes is better to do workaraund  for problem to get results but not ivesting much
[2012-12-27 22:20:46 -0500] benner: cheflevelramen: http://p.defau.lt/?wWTOtuOpmm2xlLX1Rz3y9A
[2012-12-27 22:21:07 -0500] cheflevelramen: benner: nice, and that goes in a recipe, correct?
[2012-12-27 22:21:13 -0500] benner: yes
[2012-12-27 22:21:27 -0500] cheflevelramen: benner: great, I'll give that a shot. Thanks for your help
[2012-12-27 22:22:03 -0500] benner: it that works - no problem
[2012-12-27 22:23:20 -0500] benner: i recomend this: read whole wiki (is better as pdf becouse ordering) and have ruby background before begining this
[2012-12-27 22:23:55 -0500] benner: it is a lie that you can do recipes withoud ruby background (ok, you can do editing and so on..)
[2012-12-27 22:24:29 -0500] cheflevelramen: benner: Agreed. I've worked through quite a lot of the wiki, but there is still plenty more. As for the ruby background, I wish I had in the choice in the matter, but I'm trying to pick it up quickly
[2012-12-27 22:25:13 -0500] benner: i know quickly way - take support
[2012-12-27 22:25:36 -0500] benner: it's shortes way :-)
[2012-12-27 22:26:17 -0500] benner: best way - understood
[2012-12-27 22:26:17 -0500] cheflevelramen: benner: :) I bet. Well, making my way through the 'Learn Ruby The Hard Way' tutorial
[2012-12-27 22:26:42 -0500] cheflevelramen: benner: hope it gets easier :)
[2012-12-27 22:27:33 -0500] benner: what i find to be hard that some project has no good documentation...
[2012-12-27 22:28:08 -0500] benner: you must do many google, find many community members/blogs and concat it knowledge
[2012-12-27 22:28:14 -0500] benner: it takes some time
[2012-12-27 22:29:33 -0500] miah: read the source, read the mailing list, read other peoples code =)
[2012-12-27 22:29:52 -0500] miah: docs.opscode.com is becoming a great reference
[2012-12-27 22:30:35 -0500] cheflevelramen: benner: Hmm, seems the ohai "reload" didn't work. I'll just go with the other way for now
[2012-12-27 22:31:48 -0500] benner: ok, that must be my mistake. more googling shows that it's lwrp for ohai cookbook, i see
[2012-12-27 22:34:43 -0500] cheflevelramen: benner: oh I see. No problem
