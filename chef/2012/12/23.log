[2012-12-23 01:18:29 -0500] mpapis: morning
[2012-12-23 01:20:31 -0500] mpapis: nathenharvey, chef-client log does not work for me
[2012-12-23 01:20:55 -0500] mpapis: not sure why, maybe because I use it in vagrant?
[2012-12-23 01:21:45 -0500] nathenharvey: ahhyou can bump the log level in your Vagrantfile
[2012-12-23 01:22:08 -0500] nathenharvey: chef.log_level = "debug"
[2012-12-23 01:22:30 -0500] nathenharvey: assuming you're doing something like - config.vm.provision :chef_client do |chef|
[2012-12-23 01:22:53 -0500] nathenharvey: and then run vagrant provision to see more verbose output
[2012-12-23 01:23:46 -0500] nathenharvey: I need to step afk for a bit to get my children off to bed but others here might b able to assist b4 I get back
[2012-12-23 01:23:51 -0500] mpapis: I would show you my code but GH is down :(
[2012-12-23 01:25:55 -0500] mpapis: I have already: chef.log_level = :debug
[2012-12-23 01:26:28 -0500] mpapis: I would also gist the error if the GH would not be down
[2012-12-23 01:46:26 -0500] emanuelez: how do i notify an execute resource based on the result of a script?
[2012-12-23 02:49:06 -0500] lehrblogger: hi, i'm trying to figure out the best way to store configuration variables that differ between dev and prod environements
[2012-12-23 02:49:13 -0500] lehrblogger: the attributes can be specified wherever for dev, but i want them to come from an encrypted data bag in prod
[2012-12-23 02:49:17 -0500] lehrblogger: this seems like it should be a common problem? but i'm having trouble finding a good example
[2012-12-23 02:49:36 -0500] tamouse__: we're doing that
[2012-12-23 02:49:45 -0500] tamouse__: exactly that, in fact...
[2012-12-23 02:49:59 -0500] tamouse__: it has to do with setting up your roles correctly, i think
[2012-12-23 02:50:08 -0500] tamouse__: and the various databags
[2012-12-23 02:50:46 -0500] lehrblogger: hm, ok. i have three roles (for each type of node) and a base role
[2012-12-23 02:51:00 -0500] tamouse__: and you've set up your nodes?
[2012-12-23 02:51:46 -0500] lehrblogger: im just starting out, so the only thing they're doing right now is installing nginx, but yeah
[2012-12-23 02:52:02 -0500] tamouse__: i can't look at our stuff right now as i don't have the vpn set up here
[2012-12-23 02:52:13 -0500] lehrblogger: although i might try to use the same VM in dev for all three nodes? that's how things are running with my pre-chef setup
[2012-12-23 02:52:41 -0500] tamouse__: but we have, for example, different credentials for AWS in production vs everywhere else
[2012-12-23 02:53:14 -0500] lehrblogger: yeah, i'll need to do that too
[2012-12-23 02:53:33 -0500] tamouse__: and as i understand it, it's just a matter of matching the databag with the role
[2012-12-23 02:53:33 -0500] lehrblogger: can you search a data bag for a value right in an environment's config file?
[2012-12-23 02:53:50 -0500] tamouse__: i *think* so?
[2012-12-23 02:53:57 -0500] lehrblogger: or do i have to do that in a recipe?
[2012-12-23 02:54:01 -0500] tamouse__: i'm not the one who set any of this up
[2012-12-23 02:54:12 -0500] tamouse__: i was filling in for our devops who is on vac
[2012-12-23 02:54:28 -0500] tamouse__: was/am w/e
[2012-12-23 02:54:36 -0500] lehrblogger: ah, ok
[2012-12-23 15:30:48 -0500] omgwhjh: Hi all! I'm trying to find a way to apply template resource on all files which are in a folder inside the cookbook's template folder. something like
[2012-12-23 15:30:50 -0500] omgwhjh: Dir.foreach("../templates/default/shared/") do | file |
[2012-12-23 15:30:50 -0500] omgwhjh:   template "/home/admin/shared/#{file}" do
[2012-12-23 15:30:51 -0500] omgwhjh:     source "shared/#{file}"
[2012-12-23 15:30:54 -0500] omgwhjh:   end
[2012-12-23 15:30:54 -0500] omgwhjh: end
[2012-12-23 15:31:16 -0500] omgwhjh: how do I do it?
[2012-12-23 16:41:56 -0500] owen1: i found a cookbook for gitlab (similar to github but open source). i am reading the readme, but have no experience with chef and don't know how to run it. any advice?
[2012-12-23 16:42:02 -0500] owen1: https://github.com/atomic-penguin/cookbook-gitlab
[2012-12-23 17:06:21 -0500] makmanalp: owen1: haha, I think you might have followed my post on HN
[2012-12-23 17:07:03 -0500] makmanalp: owen1: i'd suggest using something like http://berkshelf.com/
[2012-12-23 17:09:05 -0500] owen1: makmanalp: yes i did. thank you! i got a centos box and have no idea how start chef. i know there is chef-solo. is that fine for my case?
[2012-12-23 17:09:18 -0500] makmanalp: owen1: indeed
[2012-12-23 17:09:25 -0500] makmanalp: owen1: let me give you a small tour of the ecosystem
[2012-12-23 17:09:36 -0500] owen1: makmanalp: i am installing it on my mac with vagrant now, but want to surprise my team on monday with an install on our centos box.
[2012-12-23 17:09:52 -0500] makmanalp: ah!
[2012-12-23 17:09:57 -0500] owen1: makmanalp: are you the man behind gitlab?
[2012-12-23 17:10:01 -0500] makmanalp: nope
[2012-12-23 17:10:15 -0500] makmanalp: I'm just a random bypasser
[2012-12-23 17:10:19 -0500] makmanalp: passer-by?
[2012-12-23 17:10:21 -0500] makmanalp: in any case
[2012-12-23 17:10:27 -0500] owen1: (:
[2012-12-23 17:10:47 -0500] makmanalp: so chef-solo lets you install cookbooks, but it doesn't have any mechanism to automatically retrieve them
[2012-12-23 17:10:52 -0500] makmanalp: a "package manager" if you will
[2012-12-23 17:11:15 -0500] makmanalp: so I prefer to use berkshelf for that purpose, but there is also chef-librarian I believe
[2012-12-23 17:11:33 -0500] makmanalp: the nice thing about berkshelf is that it integrates with vagrant nicely
[2012-12-23 17:12:24 -0500] makmanalp: owen1: with me so far?
[2012-12-23 17:14:22 -0500] owen1: makmanalp: as soon as i cannected my mouse, my mac's keyboard stopped working... but my machine is still active. i am now sshing into my weechat server from another laptop so i'll be able to type..
[2012-12-23 17:15:35 -0500] owen1: don't go anywhere, i just want my gitlab install to finish, so i could restart my mac and i'll be able to talk to you. is it ok with u?
[2012-12-23 17:15:42 -0500] makmanalp: sure
[2012-12-23 17:16:54 -0500] owen1: sorry, it happens to me every few days.
[2012-12-23 17:20:40 -0500] makmanalp: owen1: no problem
[2012-12-23 17:49:21 -0500] chip-: Man I'm glad this exists! https://github.com/cassianoleal/vagrant-butcher
[2012-12-23 17:56:43 -0500] owen1: makmanalp: i am back. restarted my machine and about to finish the setup if gitlab on vagrant. do u know what to do on this step: "You should also configure your own remote since by default it's going to grab gitlab's master branch."
[2012-12-23 17:57:28 -0500] makmanalp: ah
[2012-12-23 17:57:30 -0500] owen1: they give 2 options. i know what git remote is but don't understand it in the current context.
[2012-12-23 17:57:47 -0500] makmanalp: I think what they mean is you might want to use a specific branch
[2012-12-23 17:57:55 -0500] makmanalp: can you link me to the instructions again?
[2012-12-23 17:57:58 -0500] owen1: git remote add mine git://github.com/me/gitlabhq.git or if you prefer set up your origin as your own repository - git remote set-url origin git://github.com/me/gitlabhq.git
[2012-12-23 17:58:04 -0500] owen1: https://github.com/gitlabhq/gitlab-vagrant-vm
[2012-12-23 17:58:30 -0500] makmanalp: oh
[2012-12-23 17:58:43 -0500] makmanalp: so that is probably for when you're developing gitlab yourself
[2012-12-23 17:58:52 -0500] makmanalp: and you don't want to make changes to *their* master branch
[2012-12-23 17:58:53 -0500] owen1: oh. so i can ignore it?
[2012-12-23 17:59:04 -0500] makmanalp: I think so
[2012-12-23 17:59:18 -0500] makmanalp: unless you plan on making changes to gitlab and committing it
[2012-12-23 17:59:28 -0500] owen1: ok. i run all their tests, how do i run teh server?
[2012-12-23 18:00:00 -0500] makmanalp: beats me!
[2012-12-23 18:00:00 -0500] makmanalp: :P
[2012-12-23 18:00:02 -0500] makmanalp: let me see
[2012-12-23 18:00:08 -0500] owen1: maybe bundle exec rails server
[2012-12-23 18:00:17 -0500] owen1: i am a ruby/js guy. i should know that
[2012-12-23 18:00:22 -0500] makmanalp: ah
[2012-12-23 18:00:29 -0500] makmanalp: but it's running in vagrant
[2012-12-23 18:00:34 -0500] makmanalp: so you can do bundle exec vagrant ssh
[2012-12-23 18:00:40 -0500] makmanalp: to ssh into the VM
[2012-12-23 18:00:43 -0500] owen1: already inside
[2012-12-23 18:00:45 -0500] makmanalp: ok
[2012-12-23 18:00:47 -0500] owen1: vagrant ssh
[2012-12-23 18:00:54 -0500] makmanalp: then see if nginx is running maybe
[2012-12-23 18:00:56 -0500] owen1: running bundle exec rails server. 1 sec
[2012-12-23 18:01:38 -0500] owen1: it's running, but i can't access it from my browser
[2012-12-23 18:02:37 -0500] owen1: maybe it's not 0.0.0.0
[2012-12-23 18:02:45 -0500] owen1: i trieddd 0.0.0.0:3000
[2012-12-23 18:03:03 -0500] makmanalp: er
[2012-12-23 18:03:09 -0500] makmanalp: 127.0.0.1 is what you want
[2012-12-23 18:03:14 -0500] owen1: http://192.168.3.14:3000/
[2012-12-23 18:03:18 -0500] makmanalp: and the internal port on the VM is usually not the same as the external one
[2012-12-23 18:03:20 -0500] owen1: i am there
[2012-12-23 18:03:39 -0500] owen1: it say on the readme: Virtual Machine IP: 192.168.3.14
[2012-12-23 18:04:20 -0500] owen1: is there a user/password i can use?
[2012-12-23 18:04:27 -0500] makmanalp: no clue
[2012-12-23 18:04:33 -0500] makmanalp: look, I know nothing about gitlab
[2012-12-23 18:04:36 -0500] owen1: or do i need to click on 'forgot my password'
[2012-12-23 18:04:41 -0500] owen1: oh. sorry (:
[2012-12-23 18:04:53 -0500] makmanalp: I'm just trying to be helpful :P
[2012-12-23 18:15:10 -0500] owen1: makmanalp: ok. the vm is running. back to berkshelf.
[2012-12-23 18:17:27 -0500] makmanalp: owen1: well I mean if you already have that whole VM set up it should come with all the things you want in it anyway
[2012-12-23 18:17:36 -0500] makmanalp: that's the impression that I got
[2012-12-23 18:17:52 -0500] makmanalp: I was going to get you to manually install the cookbook but no need
[2012-12-23 18:18:30 -0500] owen1: makmanalp: right, but this vm is just for testing. i don't think u'r suppose to run gitlab inside a vm. my plan is to use a cookbook to install it on a centos machine at work.
[2012-12-23 18:18:41 -0500] makmanalp: oh yeah
[2012-12-23 18:18:47 -0500] makmanalp: okay let's see
[2012-12-23 18:19:15 -0500] owen1: so i got the cookbook-gitlab.
[2012-12-23 18:20:00 -0500] makmanalp: well vagrant ssh should do it automatically
[2012-12-23 18:20:03 -0500] makmanalp: er
[2012-12-23 18:20:12 -0500] makmanalp: sorry that was an accidental reply
[2012-12-23 18:20:13 -0500] owen1: i got centos 6.2 or 5.8
[2012-12-23 18:20:15 -0500] makmanalp: I was scrolled up
[2012-12-23 18:20:20 -0500] makmanalp: okay
[2012-12-23 18:20:23 -0500] makmanalp: well
[2012-12-23 18:20:28 -0500] makmanalp: do you have berkshelf running?
[2012-12-23 18:20:36 -0500] makmanalp: type "berks"
[2012-12-23 18:20:37 -0500] owen1: no
[2012-12-23 18:20:49 -0500] makmanalp: okay, well go install that
[2012-12-23 18:20:56 -0500] makmanalp: http://berkshelf.com/
[2012-12-23 18:22:02 -0500] makmanalp: jsut the first step should be fine
[2012-12-23 18:22:26 -0500] owen1: install it where? my laptop or the centos box?
[2012-12-23 18:23:01 -0500] makmanalp: laptop
[2012-12-23 18:23:07 -0500] owen1: ok
[2012-12-23 18:26:38 -0500] owen1: makmanalp: done
[2012-12-23 18:26:43 -0500] makmanalp: owen1: okay
[2012-12-23 18:26:55 -0500] makmanalp: owen1: now create a new directory and in it do berks init
[2012-12-23 18:27:28 -0500] owen1: mkdir gitlab sounds good?
[2012-12-23 18:27:35 -0500] makmanalp: sure
[2012-12-23 18:28:41 -0500] Fapiko: berks cookbook gitlab would do essentially the same thing in one step
[2012-12-23 18:28:51 -0500] makmanalp: ah, neat
[2012-12-23 18:28:56 -0500] makmanalp: owen1: well?
[2012-12-23 18:29:39 -0500] owen1: just run 'berk init' ?
[2012-12-23 18:29:48 -0500] makmanalp: berks
[2012-12-23 18:29:49 -0500] makmanalp: yeah
[2012-12-23 18:30:02 -0500] owen1: done
[2012-12-23 18:30:05 -0500] makmanalp: okay
[2012-12-23 18:30:10 -0500] makmanalp: now look at the files
[2012-12-23 18:30:28 -0500] makmanalp: the Gemfile decides which ruby gems to load, you won't have to touch that most of the time
[2012-12-23 18:30:30 -0500] owen1: Berksfile, Gemfile and vagrant
[2012-12-23 18:30:37 -0500] owen1: i know
[2012-12-23 18:30:46 -0500] makmanalp: the Berksfile tells you which berkshelf packages to load
[2012-12-23 18:30:53 -0500] makmanalp: which you'll be adding gitlab there soon
[2012-12-23 18:31:00 -0500] owen1: ok
[2012-12-23 18:31:08 -0500] makmanalp: and the Vagrant file is for the vagrant vm you'll use to test this before you deploy
[2012-12-23 18:31:19 -0500] owen1: nice
[2012-12-23 18:31:35 -0500] makmanalp: okay so pop open berksfile
[2012-12-23 18:32:03 -0500] makmanalp: and under it add this:
[2012-12-23 18:32:36 -0500] makmanalp: cookbook 'gitlab', git: "https://github.com/atomic-penguin/cookbook-gitlab"
[2012-12-23 18:32:52 -0500] makmanalp: that basically tells it to download the repo and use it as a cookbook, named gitlab
[2012-12-23 18:33:10 -0500] owen1: sweet. keep the first line (site :opscode) ?
[2012-12-23 18:33:30 -0500] makmanalp: leave it
[2012-12-23 18:33:31 -0500] makmanalp: yeah
[2012-12-23 18:34:17 -0500] owen1: ok
[2012-12-23 18:34:38 -0500] makmanalp: okay you can try this and see what happens
[2012-12-23 18:34:50 -0500] makmanalp: so try bundle exec vagrant up
[2012-12-23 18:34:55 -0500] makmanalp: and see if it explodes
[2012-12-23 18:35:50 -0500] owen1: ok. sec
[2012-12-23 18:48:20 -0500] owen1: so while it's downloading the box file, let me guess what's going on here. berkshelf let's u test cookbooks on a vm and if it works u can change the target to your real machine?
[2012-12-23 19:07:48 -0500] owen1: FATAL: Could not load Moneta back end "BasicFile"
[2012-12-23 19:15:12 -0500] Fapiko: owen1: Berkshelf manages your cookbook dependencies for you
[2012-12-23 19:16:25 -0500] Fapiko: it has a vagrant plugin which makes it easy to iterate on cookbooks with every vagrant provision
[2012-12-23 19:26:48 -0500] owen1: makmanalp: ^^ i try to google for it but it wasn't helpful
[2012-12-23 19:28:33 -0500] Fapiko: Did you try adding this line to your Gemfile? moneta, '~> 0.6.0'
[2012-12-23 19:28:38 -0500] Fapiko: Spotted that in one of the posts
[2012-12-23 19:37:34 -0500] owen1: Farzy: let me try
[2012-12-23 19:49:02 -0500] _aeris_: hello #chef
[2012-12-23 19:49:13 -0500] _aeris_: i have a question about node attributes
[2012-12-23 19:49:20 -0500] _aeris_: here is my current recipe
[2012-12-23 19:49:21 -0500] _aeris_: http://pastebin.com/S7xnCtr7
[2012-12-23 19:50:01 -0500] _aeris_: is there any way to  factorize  the port, and say to the recipe to use the real node[:ssh][:port] for firewall ?
[2012-12-23 20:25:38 -0500] owen1: FATAL: Mixlib::ShellOut::ShellCommandFailed: execute[gitolite-install] (gitlab::gitolite line 64) had an error: Mixlib::ShellOut::ShellCommandFailed: Expected process to exit with [0], but received '2'
[2012-12-23 20:31:32 -0500] owen1: makmanalp: ^
[2012-12-23 22:17:50 -0500] makmanalp: owen1: if you run it with debug it'll tell you what command it ran
[2012-12-23 22:17:54 -0500] makmanalp: and what output it got
[2012-12-23 22:18:04 -0500] makmanalp: probably some misconfigured param
[2012-12-23 22:28:02 -0500] makerbrker:  load average: 42.58, 31.77, 23.58
[2012-12-23 22:28:09 -0500] makerbrker: woops sorry
[2012-12-23 22:29:12 -0500] makmanalp: makerbrker: that's all well and good, but let's see your uptime :)
[2012-12-23 22:32:43 -0500] makerbrker: hah
[2012-12-23 22:32:58 -0500] makerbrker: didnt mean to paste that uptime is about 10 min
[2012-12-23 22:33:08 -0500] makerbrker: rsync is just killing things for some reason
[2012-12-23 22:41:39 -0500] makmanalp: haha oops
[2012-12-23 22:58:40 -0500] owen1: makmanalp: bundle exec vagrant up --debug ?
[2012-12-23 23:06:04 -0500] makmanalp: owen1: I think you can change it in your vagrantfile somehow
[2012-12-23 23:13:31 -0500] owen1: makmanalp: VAGRANT_LOG=INFO vagrant up
[2012-12-23 23:14:32 -0500] owen1: oops. than didn't work as i exected
[2012-12-23 23:19:20 -0500] owen1: makmanalp: not sure what's going on. after running vagrant up its seems to be fine. i did vagrant ssh and i am inside the vm. there are no folders there. am i doing something wrong?
[2012-12-23 23:20:53 -0500] auser: has anyone here had success running mcollective with chef
[2012-12-23 23:26:47 -0500] makmanalp: owen1: what do you mean "there are no folders there"
[2012-12-23 23:26:55 -0500] makmanalp: owen1: did you look through the whole computer?
[2012-12-23 23:27:11 -0500] makmanalp: i'd bet it's somewhere like /opt/ or /var/
[2012-12-23 23:27:27 -0500] makmanalp: read the gitlab cookbook / recipes
[2012-12-23 23:27:58 -0500] owen1: makmanalp: oh. i expeced to have some stuff in the home. let me look around
[2012-12-23 23:29:09 -0500] makmanalp: it's futile to do it that way, just read the recipe
[2012-12-23 23:30:02 -0500] owen1: makmanalp: reading it now. thanks
