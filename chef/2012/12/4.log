[2012-12-04 00:12:05 -0500] rava: how can i get the omnibus installed chef-client to use the librarires installed via apt?
[2012-12-04 00:12:11 -0500] jtimberman: pulsejc: use gem_package
[2012-12-04 00:12:20 -0500] jtimberman: pulsejc: you may need to pass the gem_binary attribute to the resource.
[2012-12-04 00:12:42 -0500] jtimberman: https://gist.github.com/4199268
[2012-12-04 00:12:46 -0500] jtimberman: like that
[2012-12-04 00:12:52 -0500] rava: i tried installing the mysql gem through chef_gem, but that gem pukes against my system mysql client libraries
[2012-12-04 00:13:04 -0500] pulsejc: jtimberman: got it. thanks!
[2012-12-04 00:13:07 -0500] rava: so trying to get around it using the libmysql-ruby debian package
[2012-12-04 00:13:14 -0500] jtimberman: rava: are you using mysql::ruby recipe from Opscode's mysql cookbook?
[2012-12-04 00:13:32 -0500] rava: yeah, using the mysql opscode cookbook
[2012-12-04 00:13:35 -0500] jtimberman: libmysql-ruby is going to assume it was compiled against the ruby package from the distribution
[2012-12-04 00:13:38 -0500] jtimberman: pukes how?
[2012-12-04 00:13:46 -0500] jtimberman: and which platform?
[2012-12-04 00:14:00 -0500] jtimberman: because that recipe worked on centos 5.8, 6.3, ubuntu 10.04 and 12.04
[2012-12-04 00:14:27 -0500] rava: ubuntu 11.04
[2012-12-04 00:14:45 -0500] rava: https://gist.github.com/4199284
[2012-12-04 00:15:46 -0500] jtimberman: uhm, i don't know why that message occurs.
[2012-12-04 00:16:55 -0500] rava: mysql version: mysqld  Ver 5.5.17-55-log for Linux on x86_64 (Percona Server (GPL), Release 22.1)
[2012-12-04 00:17:38 -0500] rava: and this is what i have installed for libmysqlclient-dev: https://gist.github.com/4199305
[2012-12-04 00:17:44 -0500] rava: so i have the right library version
[2012-12-04 00:19:50 -0500] jtimberman: rava: whats dpkg -l | grep -i mysql
[2012-12-04 00:20:27 -0500] beandip: NameError: Cannot find a resource for converge_by on ubuntu version 12.04
[2012-12-04 00:20:29 -0500] qhartman: lists all packages, case-insensitive search for  "mysql"
[2012-12-04 00:20:33 -0500] beandip: jtiberman
[2012-12-04 00:20:39 -0500] jtimberman: beandip: what version of chef?
[2012-12-04 00:20:48 -0500] beandip: 10.16.2
[2012-12-04 00:20:49 -0500] jtimberman: qhartman: i know wha that does :P
[2012-12-04 00:21:04 -0500] rava: chef-client 10.16.0, installed via omni_bus
[2012-12-04 00:21:05 -0500] jtimberman: beandip: context? do you have a stack trace
[2012-12-04 00:21:11 -0500] beandip: I saw your answer to Seth Vargo on tiwtter
[2012-12-04 00:21:14 -0500] qhartman: hehe, you asked... :p
[2012-12-04 00:21:23 -0500] rava: https://gist.github.com/4199318
[2012-12-04 00:21:32 -0500] beandip: jtiberman, installing oracle java from the community cookbook
[2012-12-04 00:21:39 -0500] jtimberman: rava: ii  libmysqlclient16                      5.1.59-rel13.0-325.maverick         Percona Server database client library
[2012-12-04 00:21:46 -0500] jtimberman: what is that?
[2012-12-04 00:21:48 -0500] beandip: https://github.com/opscode-cookbooks/java/blob/master/providers/ark.rb
[2012-12-04 00:22:03 -0500] beandip: line 66
[2012-12-04 00:22:49 -0500] rava: must have been installed by percona's mysql package
[2012-12-04 00:22:56 -0500] beandip: this is on chef solo
[2012-12-04 00:23:08 -0500] beandip: setting up a tomcat dev environment
[2012-12-04 00:24:12 -0500] jtimberman: beandip: okay, but do you have a stack trace, debug output from the run, etc?
[2012-12-04 00:24:23 -0500] jtimberman: the recipe you're using
[2012-12-04 00:25:53 -0500] beandip: https://gist.github.com/0fcfdef3d6275fc96051
[2012-12-04 00:26:03 -0500] rava: and ubuntu's dependency policy for that libmysqlclient16 library tries to uninstall my whole percona server stack
[2012-12-04 00:26:43 -0500] rava: can i tell chef-client to just use the aptitude version of the mysql gem?
[2012-12-04 00:28:22 -0500] jtimberman: rava: not if you are trying to use the library in your recipe. i mean, you could probably munge the load path, but that library has C extensions that may not be built in a way that is compatible with the environment Chef runs in
[2012-12-04 00:29:56 -0500] rava: jtimberman: so i either a) drop down ot using mysql scripts and the mysql client in an execute or b) figure out a way to force this gem that's installed to use the right library
[2012-12-04 00:32:28 -0500] jtimberman: rava: probably. does percona come from an apt repo/ppa?
[2012-12-04 00:32:56 -0500] jtimberman: i gotta run
[2012-12-04 00:32:56 -0500] rava: yes
[2012-12-04 00:58:46 -0500] lafayette: Ohai! I am trying to write a LWRP that "wraps" the deploy_revision provider by setting some organization-wide defaults, pre-creating some adjunct resources, and then defining the usual Opscode deploy_revision resource. However, I can't get my custom LWRP to pass through the various callback blocks like before_migrate.
[2012-12-04 00:59:18 -0500] lafayette: Checking the value of new_resource.before_migrate from within my LWRP shows that it is nil when my Provider is created
[2012-12-04 00:59:53 -0500] lafayette: Do I have to extend Chef::Provider::Deploy::Revision with a mixin? Is there an example for this? (the Opscode Wiki page on "Extending An Existing Provider" references an example (https://github.com/opscode-cookbooks/transmission) which I'm not sure applies here.)
[2012-12-04 01:01:35 -0500] lafayette: None of the LWRP examples shows passing blocks as parameters, but wrapping the deploy_revision provider must be common. Anyone done this before?
[2012-12-04 01:21:30 -0500] solarce: anyone in here who will be at the los angeles chef meetup tonight?
[2012-12-04 01:51:34 -0500] chef_0: Hi There, I am Chef noob trying to figureout my way through it, I am constantly getting an error on node "Must have READ permission on ohai cookbook" I am not understanding what permissions I might be missing. I am using Hosted Server
[2012-12-04 02:32:07 -0500] redblacktree: This cookbook for python (http://community.opscode.com/cookbooks/python) seems to be breaking yum.  After this cookbook is installed, running yum results in "No module named yum" when running yum.  It gives a possible clue as to why: "It's possible that the above module doesn't match the current version of Python"
[2012-12-04 02:33:32 -0500] redblacktree: Sorry, I should mention that I'm using chef-solo with vagrant.  This is the base box too, in case it helps: https://s3.amazonaws.com/itmat-public/centos-6.3-chef-10.14.2.box from http://www.vagrantbox.es/
[2012-12-04 02:34:45 -0500] redblacktree: I guess I need to figure out how to make the python cookbook behave (perhaps an attribute that I need to set?), or else I might need to update yum?  I'm more dev than sysadmin, so I'm a bit at a loss what my next step is here.
[2012-12-04 02:38:57 -0500] chef_0: Are there a good resources that explains development process with Chef, I am bit lost on how do I progressively build->test->fix issues->test  my recipies+node runlist on same node?
[2012-12-04 02:50:08 -0500] rava: why would chef-client be executing an old version of a cookbook even after the webui shows that thew new recipe code is uploaded? evnironments and environment constraints are all proper on the node
[2012-12-04 07:53:04 -0500] BryanWB_: ohai chefs!
[2012-12-04 07:56:24 -0500] ssd7: Ohai!
[2012-12-04 08:16:53 -0500] jtimberman: ohai!
[2012-12-04 08:45:13 -0500] ssd7: just found logstash-cli. <3
[2012-12-04 08:45:34 -0500] BryanWB_: ssd7: is it working for u? i tried it and bkept running into bugs
[2012-12-04 08:45:57 -0500] ssd7: BryanWB_: Seems to be working. Haven't used it too much yet.
[2012-12-04 08:46:16 -0500] ssd7: I've just been using the grep command so far.
[2012-12-04 09:18:22 -0500] auduny: Hm
[2012-12-04 09:18:33 -0500] auduny: I am missing a chef-client --ok or something
[2012-12-04 09:18:48 -0500] auduny: That just outputs ok/warning/error on a run
[2012-12-04 09:20:34 -0500] auduny: for use in knife ssh for example.
[2012-12-04 10:26:56 -0500] Virunga: Hi, does anyone use the cpan cookbook? After the installation of a module i can't find it listed among the modules
[2012-12-04 10:27:45 -0500] Virunga: I use the command perl -M<module_name> -e 1
[2012-12-04 11:31:02 -0500] Cope: Anyone else seen community yum::epel fail on ec2? I get a 403 for http://s3-mirror-eu-west-1.fedoraproject.org/pub/epel//RPM-GPG-KEY-EPEL-6
[2012-12-04 11:31:23 -0500] Cope: works fine from non-ec2 machines
[2012-12-04 11:36:38 -0500] RoboticCheese: Cope: Not from EC2, but I've been seeing similar issues. Didn't look into it extensively, but seemed the main EPEL URL had at least one bad mirror in its rotation of redirects.
[2012-12-04 11:37:13 -0500] Cope: RoboticCheese: aha, so far I've only tested from 2 x ec2 machines and my laptop
[2012-12-04 11:40:06 -0500] Cope: does seem to be an ec2 thing though; works fine from rackspace uk, peer1 us, interxion uk, rackspace us
[2012-12-04 11:42:58 -0500] Cope: yeah from within ec2 every request gets redirected to s3, which fails
[2012-12-04 11:45:20 -0500] RoboticCheese: Hmm Maybe not the same issue then. For me, it's failing from my desktop and ~20% of the time.
[2012-12-04 11:51:18 -0500] Cope: RoboticCheese: curious; anyway, just over-rode the key_url attribute for now.
[2012-12-04 11:51:23 -0500] RoboticCheese: Or someone's just bad at maintaining their mirrors in general. The S3 US-East mirror of it seems to work: http://s3-mirror-us-east-1.fedoraproject.org/pub/epel/RPM-GPG-KEY-EPEL-6
[2012-12-04 14:18:21 -0500] masterkorp: What's the diference between @new_resource and @current_resource in the Chef::Provider ?
[2012-12-04 14:19:47 -0500] yfeldblum: masterkorp, new_resource is the resource instance that was declared in the recipe
[2012-12-04 14:19:59 -0500] yfeldblum: masterkorp, chef gives the provider the new_resource instance
[2012-12-04 14:20:24 -0500] yfeldblum: masterkorp, current_resource is a convention, but the provider must implement it if it wants it
[2012-12-04 14:20:45 -0500] masterkorp: any documentation on that ?
[2012-12-04 14:20:52 -0500] yfeldblum: masterkorp, current_resource typically is or the provider to inspect the current state of the system and then record the results onto current_resource
[2012-12-04 14:21:48 -0500] masterkorp: that is what i want to do
[2012-12-04 14:22:13 -0500] masterkorp: i want to read the icinga definition and load it to current_resource
[2012-12-04 14:29:27 -0500] masterkorp: yfeldblum: cam you provide me with any example ?
[2012-12-04 14:30:15 -0500] yfeldblum: masterkorp, https://github.com/opscode/chef/blob/master/lib/chef/provider/cron.rb
[2012-12-04 14:30:44 -0500] masterkorp: yfeldblum: http://s.rapimg.com/ipix_new/pkw/24/939/p7393924_2x.jpg
[2012-12-04 14:30:49 -0500] masterkorp: yfeldblum: err sorry
[2012-12-04 14:30:55 -0500] masterkorp: yfeldblum: https://github.com/opscode/chef/blob/master/lib/chef/provider/cron.rb#L46
[2012-12-04 14:30:59 -0500] masterkorp: just this ?
[2012-12-04 14:31:23 -0500] yfeldblum: masterkorp, no, the whole provider
[2012-12-04 14:31:48 -0500] yfeldblum: masterkorp, look at how #load_current_resource loads current_resource by inspecting the current state of the system
[2012-12-04 14:32:23 -0500] yfeldblum: masterkorp, and look at how action_create checks whether it needs to do anything, and figures out what to do, by comparing new_resource to current_resource
[2012-12-04 14:33:35 -0500] masterkorp: got it thanks
[2012-12-04 15:32:53 -0500] flowersj: question -- dgileadi and I are having an issue installing postgresql on osx
[2012-12-04 15:33:15 -0500] flowersj: here is the output from the chef run: https://gist.github.com/4205135
[2012-12-04 15:35:23 -0500] masterkorp: i tough that bug was fixed
[2012-12-04 15:35:31 -0500] masterkorp: what version are you using ?
[2012-12-04 15:35:42 -0500] masterkorp: (of the postgres cookbook)
[2012-12-04 15:37:16 -0500] Virunga: I found the auto-generated chef api reference once and i can't find any more. Do you know where i can find it?
[2012-12-04 15:38:08 -0500] flowersj: "2.0.2"
[2012-12-04 15:38:40 -0500] flowersj: I added the recipe and attributes to the gist as well
[2012-12-04 15:38:53 -0500] flowersj: they are in a comment at the bottom of the gist
[2012-12-04 15:39:18 -0500] Virunga: http://rdoc.info/github/opscode/chef
[2012-12-04 15:40:58 -0500] Virunga: Is it possible to install from a resource on the machine A a mysql server on the machine B, through the cookbooks mysql/datbase?
[2012-12-04 15:41:25 -0500] Virunga: I'll try, but if someone can give me this info would be very appreciated.
[2012-12-04 15:41:38 -0500] jo_: how can I access the node role in a recipe
[2012-12-04 15:41:56 -0500] jo_: I tried role['role-name'] it didnt work
[2012-12-04 15:42:12 -0500] masterkorp: http://www.geckoboard.com/statusboard-features/
[2012-12-04 15:42:19 -0500] masterkorp: this looks amazing
[2012-12-04 15:42:39 -0500] jo_: I want to check if the role name matched
[2012-12-04 15:46:19 -0500] maruq: hi guys
[2012-12-04 15:46:29 -0500] maruq: had a question about cookbook attribute files....
[2012-12-04 15:47:03 -0500] maruq: are they correlated to the recipe (eg. if I'm calling my cookbook::server, does it just load attributes/server.rb)
[2012-12-04 15:47:16 -0500] maruq: or does it load all the attributes files & you get a mash?
[2012-12-04 15:47:45 -0500] flowersj: @masterkorp did you have any ideas about why the pg gem install failed?
[2012-12-04 15:47:57 -0500] wassy121: node['roles'].include?("rolename")
[2012-12-04 15:48:07 -0500] wassy121: jo_: that was what you are looking for I think
[2012-12-04 15:48:19 -0500] masterkorp: flowersj: that was a problem with postgressql cookbook
[2012-12-04 15:49:27 -0500] masterkorp: flowersj: http://tickets.opscode.com/browse/COOK-1406 and https://github.com/opscode-cookbooks/postgresql/commit/21119bac3608e4ac5113d330eb8cbea0bea2e591
[2012-12-04 15:49:38 -0500] jo_: wassy121: thats exactly what I was looking for ! thanks. btw do you know where its document the objects/data that I have access to in the recipes like "node['roles']" for example
[2012-12-04 15:49:42 -0500] masterkorp: flowersj: do you have v2.0.2 of the cookbook ?
[2012-12-04 15:49:48 -0500] flowersj: I do
[2012-12-04 15:49:54 -0500] flowersj: but this is for osx
[2012-12-04 15:49:57 -0500] masterkorp: then sorry i dont know more
[2012-12-04 15:49:59 -0500] flowersj: so I am extending it
[2012-12-04 15:50:03 -0500] jo_: wassy121: where its documeted*
[2012-12-04 15:50:12 -0500] flowersj: :-)
[2012-12-04 15:53:54 -0500] flowersj: anyone here a test-kitchen developer?
[2012-12-04 15:54:22 -0500] flowersj: I got windows test subjects working in test-kitchen last night
[2012-12-04 15:57:28 -0500] masterkorp: oh i hate working with dodgy libraries
[2012-12-04 15:59:58 -0500] ssd7: flowersj: Nice!  I see you have an open pull request
[2012-12-04 16:00:10 -0500] flowersj: yep
[2012-12-04 16:00:13 -0500] flowersj: :-)
[2012-12-04 16:01:01 -0500] ssd7: flowersj: Could you also open a ticket on tickets.opscode.com?  Also, have you signed a CLA for Opscode before?
[2012-12-04 16:01:20 -0500] flowersj: nope
[2012-12-04 16:01:34 -0500] flowersj: sure I can
[2012-12-04 16:01:43 -0500] ssd7: Directions here: http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-12-04 16:01:56 -0500] flowersj: thanks
[2012-12-04 16:03:03 -0500] ssd7: flowersj: I think you can just use this ticket: http://tickets.opscode.com/browse/KITCHEN-42
[2012-12-04 16:03:24 -0500] flowersj: okay
[2012-12-04 16:12:37 -0500] awgross: is there some special magic when uploading cookbooks to Chef-Server to make sure it keeps older versions as well?
[2012-12-04 16:12:54 -0500] awgross: right now uploading different versions of cookbooks only keeps the latest one
[2012-12-04 16:13:12 -0500] gkarekinian: You have to bump the version in metadata.rb
[2012-12-04 16:13:19 -0500] awgross: gkarekinian: I am doing that
[2012-12-04 16:13:33 -0500] awgross: gkarekinian: atm i have uploaded a 1.0.0, 1.0.1, and 1.0.2
[2012-12-04 16:13:42 -0500] awgross: and Chef Server only knows about 1.0.2
[2012-12-04 16:13:52 -0500] awgross: until I uploaded that, I had 1.0.1 on there frozen
[2012-12-04 16:14:01 -0500] awgross: but it no longer knows about it
[2012-12-04 16:14:36 -0500] gkarekinian: "knife cookbook list -a" will list all the versions
[2012-12-04 16:14:55 -0500] gkarekinian: If they're not there something is indeed wrong
[2012-12-04 16:15:07 -0500] awgross: doesn't have the multiple versions
[2012-12-04 16:15:11 -0500] awgross: gkarekinian: thanks though
[2012-12-04 16:15:24 -0500] gkarekinian: You're welcome
[2012-12-04 16:15:25 -0500] awgross: It can see multiple versions for a few really old cookbooks I havent touched in ages
[2012-12-04 16:15:29 -0500] awgross: but none of my newer ones
[2012-12-04 16:20:26 -0500] awgross: going to try upgrading my local chef version to 14.4 to see if it helps
[2012-12-04 16:25:22 -0500] awgross: Ok, found the problem
[2012-12-04 16:25:23 -0500] specialsauce: chef is on what version now?
[2012-12-04 16:25:54 -0500] awgross: specialkevin: 10.16.2 is latest
[2012-12-04 16:26:44 -0500] specialkevin: specialsauce ^^
[2012-12-04 16:27:53 -0500] awgross: heh whoops, too much special
[2012-12-04 16:28:03 -0500] specialsauce: i'm definitely too special
[2012-12-04 16:32:32 -0500] mobilemike: question for those on EC2: How are you handling IPs and DNS?...
[2012-12-04 16:32:55 -0500] awgross: mobilemike: in what way
[2012-12-04 16:32:57 -0500] mobilemike: Do you bother registering EIPs or do you just register the ephemeral IP in DNS/?
[2012-12-04 16:33:35 -0500] awgross: mobilemike: We don't bother using EIPs for our access, we only assign EIPs if someone else requires us to have a static address
[2012-12-04 16:34:06 -0500] mobilemike: I see some mailing list chatter about how EIPs can complicate bootstrapping, and it seems like nothing definitive came from the descussion
[2012-12-04 16:35:13 -0500] awgross: mobilemike: in my experience it should be assigned before the bootstrap process starts, or after the first run
[2012-12-04 16:35:23 -0500] awgross: mobilemike: doing it in the middle may cause problems
[2012-12-04 16:36:08 -0500] mobilemike: And, it seems like chef doesn't offer an inbuilt way to handle either of those, unless I've missed something.
[2012-12-04 16:37:31 -0500] awgross: mobilemike: dont believe so
[2012-12-04 16:37:33 -0500] programmerq: so, it seems like when we're running chef-client as a daemon
[2012-12-04 16:37:39 -0500] programmerq: but we want to force it to do a run
[2012-12-04 16:37:51 -0500] programmerq: our run can conflict with a currently running run
[2012-12-04 16:38:11 -0500] programmerq: is there a way to get the daemon to run without restarting it?
[2012-12-04 16:38:17 -0500] programmerq: send some signal or something
[2012-12-04 16:38:26 -0500] mobilemike: Thx.
[2012-12-04 16:38:45 -0500] programmerq: or maybe having the daemon set a lock file to indicate that it's running already?
[2012-12-04 16:40:01 -0500] specialsauce: programmerq, you mean in the middle of checking in as opposed to the daemon being in memory?
[2012-12-04 16:42:17 -0500] specialsauce: you might want to take a look at CHEF-867
[2012-12-04 16:42:32 -0500] programmerq: specialsauce: yes. if the daemon is doing nothing, then running chef-client should go through just fine
[2012-12-04 16:42:51 -0500] programmerq: if the daemon is in the middle of a run, chef-client should wait or exit and let me know that's the case.
[2012-12-04 16:43:02 -0500] programmerq: so older versions of chef did this?
[2012-12-04 16:43:11 -0500] specialsauce: currently I believe if the daemon is running, the chef-client will do a run regardless of if the daemonised client is running or not. i understand it has always been this way
[2012-12-04 16:43:26 -0500] specialsauce: that bug number above tracks this issue
[2012-12-04 16:43:38 -0500] programmerq: oh, chef-867 is a bug number
[2012-12-04 16:43:44 -0500] programmerq: didn't recognize that as what it was. :)
[2012-12-04 16:43:50 -0500] specialsauce: ah sorry, yes
[2012-12-04 16:44:13 -0500] specialsauce: http://tickets.opscode.com/browse/CHEF-867
[2012-12-04 16:44:14 -0500] programmerq: looks like that's done in chef 11
[2012-12-04 16:44:34 -0500] specialsauce: yep, but that's not out yet is it?
[2012-12-04 16:44:45 -0500] programmerq: I think there's a preview or something
[2012-12-04 16:44:50 -0500] specialsauce: ok
[2012-12-04 16:50:25 -0500] jtimberman: Correct, Chef 11 is not released. It is stil "alpha"
[2012-12-04 17:01:47 -0500] awgross: On Chef server, each environment should only be able to have one version of the cookbook available right?  The organization can have many versions of the cookbook, but only one can be active in a given environment?
[2012-12-04 17:03:10 -0500] yfeldblum: awgross, false
[2012-12-04 17:03:11 -0500] awgross: Currently I can see multiple versions of some very old cookbooks in an environment, but I cannot duplicate this with new changes (it will only keep the latest uploaded version in an environment.) I assume this discrepancy is a holdover from earlier Chef Server versions?
[2012-12-04 17:03:57 -0500] yfeldblum: awgross, you may optionally specify a version to lock a cookbook at within an environment, but all the cookbook versions will still be available in that environment
[2012-12-04 17:04:25 -0500] awgross: yfeldblum: Thats what I had thought, but it is not what I am experiencing currently
[2012-12-04 17:05:02 -0500] awgross: yfeldblum: using `knife cookbook upload my_cookbook -E production` will force whatever version is in the metadata.rb file to be the version for the environment
[2012-12-04 17:05:44 -0500] awgross: yfeldblum: uploading differing version numbers will not lead to multiple versions being shown with `knife environment show production`
[2012-12-04 17:06:17 -0500] awgross: yfeldblum: however, I can get multiple version behavior if I drop the environment related arguments
[2012-12-04 17:08:49 -0500] awgross: yfeldblum: very strange and unexpected behavior it seems
[2012-12-04 17:11:29 -0500] mal__: Hey all
[2012-12-04 17:11:57 -0500] mal__: Quick question; is it possible to use a local template when writing a LWRP?
[2012-12-04 17:12:45 -0500] mal__: i.e. call a cb1 resource from cb2, but use a cb1 template inside the provider?
[2012-12-04 17:12:52 -0500] cwj: mal__: yeah i think so, try using the 'cookbook' attribute for template resource
[2012-12-04 17:13:07 -0500] cwj: so value for cookbook attribute would be cb1
[2012-12-04 17:13:19 -0500] cwj: or make it overridable with cb1 as the default :)
[2012-12-04 17:13:35 -0500] mal__: Nice one, I'll have a looksie
[2012-12-04 17:14:26 -0500] yfeldblum: awgross, `knife cookbook upload CB -E ENV` probably does some tricky stuff in newer versions of knife
[2012-12-04 17:18:13 -0500] fromonesrc: is there a java cookbook for windows?
[2012-12-04 17:19:34 -0500] nacer: i'am wondering ... can  pass variables with the apps ressource ?
[2012-12-04 17:19:45 -0500] nacer: web_app ressource i mean
[2012-12-04 17:21:15 -0500] yfeldblum: nacer, what do you mean?
[2012-12-04 17:21:34 -0500] nacer: yfeldblum: i want to push a data bag item in my web_app template
[2012-12-04 17:22:51 -0500] programmerq: Having a strange error. This recipe worked on centos 6.3 without problem with chef-solo. Trying to get it running on chef-server: http://pastebin.com/Se26SuyC
[2012-12-04 17:22:59 -0500] programmerq: yum localinstall manually on our rpm works
[2012-12-04 17:23:13 -0500] yfeldblum: nacer, what do you mean by "push"?
[2012-12-04 17:24:10 -0500] martinisoft: jtimberman: thanks for making the blog post about converting a chef repo to Berkshelf, was in a similar spot and it helped connect the dots for me
[2012-12-04 17:24:11 -0500] nacer: yfeldblum: i have set a variables :data => data_bag_item('wordpress', "website")
[2012-12-04 17:24:17 -0500] nacer: in my web_app ressource
[2012-12-04 17:24:58 -0500] yfeldblum: nacer, sounds fine
[2012-12-04 17:25:11 -0500] nacer: yfeldblum: yeah look like it
[2012-12-04 17:25:35 -0500] nacer: yfeldblum: but i'am missing something :)
[2012-12-04 17:26:09 -0500] solarce: i need to start using berkshelf, last night's talk on at the la meetup got me all excited
[2012-12-04 17:35:34 -0500] mattray: anyone using the OpenStack runner with TestKitchen?
[2012-12-04 17:38:33 -0500] awgross: yfeldblum: fair enough, although I don't know of another way to upload my changes to the Chef server without Knife, a shame that its weird like that
[2012-12-04 17:47:19 -0500] wildfire: Hi, I am having a problem with the knife command; 'knife node list' returns with: knife.rb:2: undefined method `log_level' for main:Object (NoMethodError)
[2012-12-04 17:47:48 -0500] wildfire: other people have looked at this problem before and indicated it is likely to be because there is some extra knife.rb where you are not expecting it
[2012-12-04 17:48:14 -0500] wildfire: how can I check which one is being used? (note: I get the error even when I explicitly specify which knife.rb to use; and this on Linux)
[2012-12-04 17:49:02 -0500] jordane: wildfire: it is probably overkill, but strace will definitively tell you which is being used.
[2012-12-04 17:51:03 -0500] wildfire: jordane: I only see three when I use strace; how many should I see? (/home/anand/.gem/ruby/1.8/gems/chef-10.16.2/lib/chef/application/knife.rb, /home/anand/.gem/ruby/1.8/gems/chef-10.16.2/lib/chef/knife.rb, /home/anand/Work/infra/chef/knife/knife.rb )
[2012-12-04 17:53:32 -0500] jordane: wildfire: I think three is right, but I'm not 100% positive there.
[2012-12-04 17:53:56 -0500] jordane: there is your config, and the other two are what actually run knife
[2012-12-04 17:55:19 -0500] awgross: wildfire: make sure the log_level directive is set in your knife.rb
[2012-12-04 17:55:31 -0500] awgross: wildfire: :info, :debug
[2012-12-04 17:55:41 -0500] awgross: both good options, not the ruby symbol notation
[2012-12-04 17:55:53 -0500] awgross: note*
[2012-12-04 17:56:01 -0500] wildfire: awgross: it is, first thing I checked
[2012-12-04 17:56:30 -0500] jtimberman: martinisoft: awesome, glad it was helpful :)
[2012-12-04 17:56:35 -0500] awgross: wildfire: if you explicitly specify the log file with -c does that help
[2012-12-04 17:56:37 -0500] awgross: ?
[2012-12-04 17:57:15 -0500] wildfire: awgross: http://pastebin.com/wZLR0bxF
[2012-12-04 17:57:31 -0500] wildfire: awgross: I thought '-c' specified the specific knife.rb?
[2012-12-04 17:58:22 -0500] wildfire: and, to answer your question, same failure when I specify the path to the knife.rb
[2012-12-04 17:58:44 -0500] awgross: wildfire: it does, and ok, not sure what is going on then, what version of chef/knife?
[2012-12-04 17:59:14 -0500] wildfire: awgross: chef: 10.16.2
[2012-12-04 17:59:43 -0500] awgross: wildfire: hmm, maybe double check with a lower version of chef like 10.14.4?  Not really sure
[2012-12-04 18:04:10 -0500] wildfire: trying
[2012-12-04 18:14:32 -0500] wildfire: nope, no difference when using a different version
[2012-12-04 18:14:34 -0500] wildfire: :-/
[2012-12-04 18:16:03 -0500] awgross: wildfire: hmm not really sure
[2012-12-04 18:16:26 -0500] wildfire: it seems to be having some problem loading the chef subcommands
[2012-12-04 18:16:49 -0500] awgross: wildfire: hrm, any monkey patches or newly installed knife plugins?
[2012-12-04 18:16:54 -0500] wildfire: from: chef/knife/core/subcommand_loader.rb
[2012-12-04 18:17:10 -0500] wildfire: awgross: I've created a brand new user, and installed in there; fails
[2012-12-04 18:17:31 -0500] awgross: wildfire: hrm, no clue what is happening
[2012-12-04 18:21:31 -0500] jordane: wildfire: does it work if you change your log level in your knife.rb?
[2012-12-04 18:22:42 -0500] wildfire: jordane: nope - the only time I can get things to work is if I comment *everything* out in the knife.rb
[2012-12-04 18:22:54 -0500] wildfire: then I get: ERROR: You did not provide a valid 'AWS Access Key Id' value.
[2012-12-04 18:22:55 -0500] wildfire: etc.
[2012-12-04 18:23:02 -0500] wildfire: (I'm doing knife ec2 server list)
[2012-12-04 18:23:47 -0500] wildfire: similar output if I do: knife node list (complaings about no knife.rb configuration)
[2012-12-04 18:23:54 -0500] jordane: wildfire: and if you only comment part of it out, do you get the same error?
[2012-12-04 18:24:05 -0500] wildfire: nope, whatever is the first list is the error listed
[2012-12-04 18:24:22 -0500] jordane: what happens if you comment out all the lists, and only the lists?
[2012-12-04 18:24:46 -0500] wildfire: log_level happens to be first; then if I comment 'log_level', the next line is log_location, and it complains there
[2012-12-04 18:25:15 -0500] wildfire: jordane: http://pastebin.com/wZLR0bxF - yo umean removing the cookpath_path?
[2012-12-04 18:26:08 -0500] jordane: wildfire: ah, nevermind. I misunderstood something you said earlier, looking at your knife.rb now
[2012-12-04 18:26:37 -0500] jordane: wildfire: has this ever worked before?
[2012-12-04 18:27:02 -0500] wildfire: yup, works perfectly fine on another machine; with 10.16.2 as well
[2012-12-04 18:27:15 -0500] wildfire: as far as I can determine, I've set them up the same
[2012-12-04 18:28:00 -0500] jordane: huh. Same linux distro?
[2012-12-04 18:28:12 -0500] wassy121: wildfire, does your knife.rb have any weird characters in it?  Maybe a hard tab or something?  Try checking with "od -a knife.rb".  Kind of hard to read, maybe only the first two lines "head -2 knife.rb | od -a"
[2012-12-04 18:29:57 -0500] wassy121: Maybe "cr" for windows line feeds as well?  I don't know that these things would even matter.  Just trying to rule out.
[2012-12-04 18:30:12 -0500] wildfire: wassy121: nope, only ascii, 'sp' and 'nl' in the file
[2012-12-04 18:30:25 -0500] wassy121: :-/
[2012-12-04 18:32:53 -0500] wildfire: hmm, well thanks jordane, wassy121, awgross: that's me done for the day
[2012-12-04 18:32:58 -0500] wildfire: I'll try tackling it tomorrow
[2012-12-04 18:35:52 -0500] awgross: yfeldblum: ok, figured it out.  You were right about knife doing something a little wonky on upload.
[2012-12-04 18:35:59 -0500] awgross: yfeldblum: "-E, --environment ENVIRONMENT:
[2012-12-04 18:36:00 -0500] awgross: An ENVIRONMENT to apply the uploaded cookbooks to. Specifying this
[2012-12-04 18:36:00 -0500] awgross: option will cause knife to edit the ENVIRONMENT to place a strict
[2012-12-04 18:36:00 -0500] awgross: version constraint on the cookbook version(s) uploaded."
[2012-12-04 18:37:48 -0500] yfeldblum: awgross, yep
[2012-12-04 18:38:05 -0500] awgross: yfeldblum: thanks, now I need to fit this in my brain and reorg my workflow
[2012-12-04 18:38:13 -0500] yfeldblum: awgross, :D
[2012-12-04 18:45:33 -0500] isotope: not a chef newb but getting a strange error attempting to bootstrap a windows box with ssh
[2012-12-04 18:45:44 -0500] isotope: ERROR: Network Error: getaddrinfo: Name or service not known
[2012-12-04 18:45:57 -0500] isotope: I can ssh into the windows host no problems
[2012-12-04 18:47:44 -0500] isotope: I'm using an ip instead of hostname
[2012-12-04 18:48:15 -0500] programmerq: trying to use the opscode database cookbook on rhel6. I have a declared resource so chef will create a mysql database, but we're getting the error: "Cannot find a resource for mysql_database on redhat version 6.3"
[2012-12-04 18:48:19 -0500] programmerq: I'm very confused.
[2012-12-04 19:00:34 -0500] masterkorp: http://i.imgur.com/PZIP5.jpg
[2012-12-04 19:00:37 -0500] masterkorp: err
[2012-12-04 19:01:39 -0500] josephholsten: sorry for ot, but does anyone know how to allow group members to restart runit services?
[2012-12-04 19:01:49 -0500] isotope: any one ever successfully run this command
[2012-12-04 19:01:55 -0500] isotope: knife bootstrap windows ssh ?
[2012-12-04 19:02:02 -0500] josephholsten: yes
[2012-12-04 19:02:07 -0500] josephholsten: isotope: yes
[2012-12-04 19:02:18 -0500] josephholsten: oh, wait, ssh? heck no
[2012-12-04 19:02:33 -0500] isotope: I'm getting a strange error
[2012-12-04 19:02:36 -0500] isotope: ERROR: Network Error: getaddrinfo: Name or service not known
[2012-12-04 19:02:41 -0500] josephholsten: I've only bootstrapped with winrm
[2012-12-04 19:02:50 -0500] isotope: hmmmm
[2012-12-04 19:02:59 -0500] josephholsten: isotope: sounds like a dns resolution error
[2012-12-04 19:03:01 -0500] isotope: I can ssh into the box no problems
[2012-12-04 19:03:16 -0500] wassy121: isotope, can the windows machine ping the chefmaster as defined in client.rb?
[2012-12-04 19:03:19 -0500] isotope: yeah thats what I thought so I added a dns entry for it
[2012-12-04 19:03:20 -0500] josephholsten: can the box resolve your chef server?
[2012-12-04 19:03:33 -0500] isotope: looking
[2012-12-04 19:03:41 -0500] josephholsten:  wassy121: great minds think alike.
[2012-12-04 19:05:04 -0500] BryanWB_: anybody looked at RABL for templating xml files? https://github.com/nesquena/rabl    bflad_laptop
[2012-12-04 19:05:13 -0500] isotope: josephholten yes the windows box can look up the chef server
[2012-12-04 19:05:41 -0500] isotope: I can ssh into the box no problems it only when I attempt to bootstrap it
[2012-12-04 19:07:17 -0500] yfeldblum: BryanWB_, you typically would use RABL when you get to define the xml schema; you would typically generate XML with something else like Nokogiri when you need to conform to some other XML schema
[2012-12-04 19:07:49 -0500] BryanWB_: yfeldblum, ah, so when u design your own api
[2012-12-04 19:08:29 -0500] yfeldblum: BryanWB_, yep, people might use RABL for their Rails API endpoints
[2012-12-04 19:08:45 -0500] BryanWB_: but i wonder if u _could_ use  it to deal w/ any existing xml schema
[2012-12-04 19:09:11 -0500] BryanWB_: it looks a lot less verbose than weirich's xmlbuilder but i haven't used nokogiri to template xml
[2012-12-04 19:09:34 -0500] BryanWB_: the RABL templating examples are pretty elegant
[2012-12-04 19:10:12 -0500] BryanWB_: yfeldblum: i don't think u realize how much xml pain i have to deal w/ a daily basis :)
[2012-12-04 19:10:40 -0500] jtimberman: programmerq: are you depending on the database cookbook in your cookbook's metadata?
[2012-12-04 19:11:58 -0500] dougireton: I'm creating a library module in my cookbook and I'm using the Windows::Helper library as an example. Can someone explain this line of code? https://github.com/opscode-cookbooks/windows/blob/master/libraries/helper.rb#L86
[2012-12-04 19:12:37 -0500] dougireton: does that mean I can just require the Windows/libraries/helper and use those methods?
[2012-12-04 19:13:37 -0500] dougireton: Typically, I"ve been using ::Chef::Recipe.send(:include, Windows::Helper) in my own cookbook's recipes
[2012-12-04 19:14:06 -0500] kallistec: dougireton: Chef loads library files automatically. You can just use the helper methods in recipes without doing anything else as long as the cookbook is loaded
[2012-12-04 19:14:22 -0500] yfeldblum: BryanWB_, i'd write a class with helper methods to ease the pain ...
[2012-12-04 19:14:57 -0500] BryanWB_: yfeldblum: probably a good way to go
[2012-12-04 19:15:00 -0500] jtimberman: dougireton: that specific line makes those methods available in a recipe
[2012-12-04 19:15:25 -0500] jtimberman: http://ruby-doc.org/core-1.9.3/Object.html#method-i-send
[2012-12-04 19:16:17 -0500] yfeldblum: BryanWB_, i haven't needed to do much xml generation; i happen to have used nokogiri and it worked fine for what i needed to do, and i'm sure builder can work fine do but i've never used it
[2012-12-04 19:16:43 -0500] BryanWB_: nokogiri looks about as verbose as builder :/
[2012-12-04 19:17:24 -0500] dougireton: jtimberman: so what do I put in my recipe to use it?
[2012-12-04 19:17:34 -0500] programmerq: jtimberman: we are not. we got it running by explicitly adding recipe[database] to our run list, but adding it to the metadata sounds like the right thing to do.
[2012-12-04 19:18:31 -0500] yfeldblum: BryanWB_, thus the class and the helper methods
[2012-12-04 19:19:15 -0500] yfeldblum: BryanWB_, the call site should look like: <%= MyXmlBuildingClass.xml_for(@input_data) %>
[2012-12-04 19:22:34 -0500] BryanWB_: yfeldblum: ooh nice
[2012-12-04 19:23:05 -0500] yfeldblum: BryanWB_, and you'd have a library file that defines your MyXmlBuildingClass
[2012-12-04 19:23:15 -0500] yfeldblum: BryanWB_, implemented with builder or nokogiri or whatever
[2012-12-04 19:27:44 -0500] kevin_: Hey guys, can anyone help me with a chef search question?
[2012-12-04 19:28:07 -0500] barnacles: Sure what's the question
[2012-12-04 19:28:13 -0500] kevin_: long story short, knife search node "*:*" consistently returns 0 items
[2012-12-04 19:28:43 -0500] kevin_: I made sure solr was running and the expander
[2012-12-04 19:28:49 -0500] kevin_: i
[2012-12-04 19:28:57 -0500] kevin_: i also have nodes in couchdb
[2012-12-04 19:29:12 -0500] kevin_: and I've upgraded to the newest version of chef
[2012-12-04 19:30:45 -0500] barnacles: Is there a difference between doing an include_recipe at the top of a recipe as opposed to the bottom? i.e can I control the order?
[2012-12-04 19:31:11 -0500] yfeldblum: barnacles, yes
[2012-12-04 19:32:58 -0500] barnacles: yfeldblum: Perfect, thanks
[2012-12-04 19:41:16 -0500] cheflevelramen: Hi All. Been working on a hostname cookbook (second cookbook I've written, so please bear with me) and here's what I have so far:
[2012-12-04 19:41:20 -0500] cheflevelramen: http://pastebin.com/2GrGLXNq
[2012-12-04 19:41:44 -0500] cheflevelramen: I'm having trouble getting variables to pass from attributes file to the template, and to be able to override them in a role
[2012-12-04 19:42:08 -0500] isotope: knife bootstrap windows ssh
[2012-12-04 19:42:20 -0500] isotope: does the dest host need a reverse ip address?
[2012-12-04 19:42:23 -0500] cheflevelramen: I've copied the MySQL cookbook and believe I've set the variables and called them correctly, but the variables are showing up in the final file
[2012-12-04 19:42:31 -0500] awgross: cheflevelramen: you probably dont want to be using node attributes directly in the template
[2012-12-04 19:42:36 -0500] cheflevelramen: are not*
[2012-12-04 19:42:39 -0500] awgross: better to use regular template variables
[2012-12-04 19:42:43 -0500] isotope: because I can ssh to the windows host no problem but keep getting a network error
[2012-12-04 19:42:50 -0500] cheflevelramen: like '@variable_name'?
[2012-12-04 19:42:51 -0500] isotope: ERROR: Network Error: getaddrinfo: Name or service not known
[2012-12-04 19:42:51 -0500] awgross: and put the node attributes into the template block in the recipe
[2012-12-04 19:42:53 -0500] isotope: Check your knife configuration and network settings
[2012-12-04 19:42:59 -0500] awgross: cheflevelramen: correct
[2012-12-04 19:43:53 -0500] cheflevelramen: awgross: Okay I'll try that. But shouldn't it work still? That's how the MySQL cookbook is and it seems to work fine.
[2012-12-04 19:44:40 -0500] awgross: cheflevelramen: it should work still
[2012-12-04 19:45:24 -0500] cheflevelramen: awgross: Just to provide a little more information, my push process is this: knife cookbook upload hostname, chef-client (on client machine). If I make a change to metadeta.rb, I do knife cookbook metadata hostname.
[2012-12-04 19:45:38 -0500] cheflevelramen: Could I be pushing it out incorrectly?
[2012-12-04 19:48:18 -0500] cheflevelramen: Also, here's my metadata.rb file:
[2012-12-04 19:48:18 -0500] cheflevelramen: http://pastebin.com/mQdN01Hw
[2012-12-04 19:48:37 -0500] awgross: cheflevelramen: can you past what you are getting out of the template file so I can see what you mean by "but the variables are showing up in the final file"
[2012-12-04 19:49:53 -0500] cheflevelramen: awgross: Sure, I actually mean't 'not showing up', sorry. Here you go:
[2012-12-04 19:49:54 -0500] cheflevelramen: http://pastebin.com/JVtf6NKg
[2012-12-04 19:50:15 -0500] awgross: ok so that just means that it is not seeing them
[2012-12-04 19:50:24 -0500] awgross: strange since you are setting them in defaults
[2012-12-04 19:50:36 -0500] awgross: it must be accessing them before the defaults are read somehow
[2012-12-04 19:51:27 -0500] cheflevelramen: Hmm, any idea how that could happen?
[2012-12-04 19:51:51 -0500] awgross: the way/ order that chef compiles defaults and node attributes can be a bit confusing
[2012-12-04 19:52:04 -0500] awgross: can you try switching the template file to use regular variables
[2012-12-04 19:52:06 -0500] cheflevelramen: BTW - I just tried deleting the file on the server to make sure chef would recreate it, and it did, but again, with the variables missing
[2012-12-04 19:52:11 -0500] cheflevelramen: Sure
[2012-12-04 19:52:13 -0500] awgross: and pass in the node attributes to the template block?
[2012-12-04 19:52:27 -0500] cheflevelramen: Yep, I'll try that
[2012-12-04 19:57:03 -0500] cheflevelramen: Same result:
[2012-12-04 19:57:04 -0500] cheflevelramen: http://pastebin.com/T3gjDsFd
[2012-12-04 19:57:15 -0500] awgross: very strange
[2012-12-04 19:57:18 -0500] cheflevelramen: Not 100% sure I did everything correct though
[2012-12-04 19:58:20 -0500] awgross: im a little wary about what you are doing with `knife cookbook metadata hostname`
[2012-12-04 19:58:24 -0500] awgross: when you upload a cookbook
[2012-12-04 19:58:29 -0500] awgross: it uses the metadata.rb file
[2012-12-04 19:58:51 -0500] awgross: running the metadata hostname command overwrites what was uploaded
[2012-12-04 19:59:06 -0500] awgross: in fact i dont have any experience with settings attributes in the metadata file at all
[2012-12-04 19:59:15 -0500] awgross: i use it strictly for versioning and a short description
[2012-12-04 19:59:24 -0500] cheflevelramen: Oh okay. I was just replicating how the MySQL cookbook did things
[2012-12-04 20:00:23 -0500] cheflevelramen: Should I just remove the .json file and update the .rb file by deleting the 'attribute' portions?
[2012-12-04 20:00:47 -0500] awgross: try it and see if it help
[2012-12-04 20:00:48 -0500] awgross: s
[2012-12-04 20:00:51 -0500] cheflevelramen: OK
[2012-12-04 20:00:58 -0500] awgross: i am not sure where those fall in how chef compiles things
[2012-12-04 20:03:12 -0500] auduny: Hm. What is used as nodename when bootstrapping
[2012-12-04 20:04:27 -0500] auduny: I have a issue where installing a server and runing chef-client afterwards works perfectly an the node is named the FQDN, but when bootstrapping with vsphere for example the node-name/client is just the hostname without the domain.
[2012-12-04 20:04:32 -0500] auduny: Any clues to why?
[2012-12-04 20:06:49 -0500] siezer: auduny what does the vsphere machine report when you type "hostname -f"
[2012-12-04 20:08:27 -0500] auduny: siezer: FQDN. (vhspere is not a machine, it's the virtual setup)
[2012-12-04 20:08:57 -0500] auduny: I just wonder how and when chef picks the name of the node.
[2012-12-04 20:10:36 -0500] dysinger: I'm sure I'm doing something wrong but I'm about ready to take chef & nagios into the alley with my cane-machete.  What would cause my custom node_name to not show up as I'm templating with nodes from a chef search in a cookbook?  I can clearly see the effing  "name" attribute in knife search.
[2012-12-04 20:12:07 -0500] awgross: dysinger: you think it might be related to the issues with node.name vs node['name'] (or [:name]) since its one of those weird ones that can't be access properly except as a method?
[2012-12-04 20:12:29 -0500] awgross: dysinger: or is this truly a custom attribute like node['node_name']
[2012-12-04 20:12:58 -0500] dysinger: no it shows up just fine with knife search node "*:*" -a name
[2012-12-04 20:13:15 -0500] dysinger: It's only node_name in client.rb
[2012-12-04 20:13:18 -0500] dysinger: AFAIK
[2012-12-04 20:13:21 -0500] awgross: oic
[2012-12-04 20:13:21 -0500] jtimberman: dysinger: Chef::Node#name
[2012-12-04 20:13:25 -0500] dysinger: but clearly I'm doing it wrong
[2012-12-04 20:13:25 -0500] jtimberman: dysinger: you need node.name
[2012-12-04 20:13:30 -0500] jtimberman: in a recipe/template
[2012-12-04 20:13:48 -0500] dysinger: ok so I have to use the method - not an attribute on this attribute?
[2012-12-04 20:13:58 -0500] jtimberman: That's the thing. Its not an attribute.
[2012-12-04 20:14:00 -0500] dysinger: not a hash key rather
[2012-12-04 20:14:06 -0500] dysinger: ok
[2012-12-04 20:14:22 -0500] dysinger: but it clearly works with a knife search and "-a name"
[2012-12-04 20:14:25 -0500] jtimberman: also, node.chef_environment and node.run_list aren't attributes either.
[2012-12-04 20:14:52 -0500] jtimberman: Yeah. I don't know if that is on purpose to work around the confusion, or if it is a bug that it accidentally works.
[2012-12-04 20:14:54 -0500] kallistec: dysinger: yeah, there's uglyish code in knife to paper over that
[2012-12-04 20:15:14 -0500] dysinger: ok
[2012-12-04 20:15:28 -0500] cheflevelramen: awgross: Okay, I've deleted the attribute references in metadata.rb and also deleted the metadata.json file. Still the same result. Here's the new metedata.rb file:
[2012-12-04 20:15:32 -0500] cheflevelramen: http://pastebin.com/Mn1F35My
[2012-12-04 20:15:55 -0500] dysinger: I got it. thanks.  was about ready to lose it.  thank the universe for IRC!
[2012-12-04 20:18:08 -0500] awgross: cheflevelramen: try switching the references in the template to use symbols instead?  ie node[:hostname][:hostname].  Really unsure as to what is going on here
[2012-12-04 20:20:20 -0500] cheflevelramen: awgross: Yea, when I do that just in the template, I get this error:
[2012-12-04 20:20:22 -0500] cheflevelramen:  FATAL: Chef::Mixin::Template::TemplateError: can't convert Symbol into Integer
[2012-12-04 20:20:32 -0500] cheflevelramen: Would I need to update the recipe and attribute files too?
[2012-12-04 20:20:40 -0500] awgross: maybe
[2012-12-04 20:20:45 -0500] awgross: ive had shenanigans like that
[2012-12-04 20:20:49 -0500] cheflevelramen: OK
[2012-12-04 20:20:54 -0500] awgross: in theory chef takes care of that on its own
[2012-12-04 20:21:00 -0500] awgross: but in reality, it seems to leak sometimes
[2012-12-04 20:22:04 -0500] awgross: cheflevelramen: if all else fails https://www.opscode.com/support/tickets/
[2012-12-04 20:22:10 -0500] awgross: asusming you have hosted chef w/ them
[2012-12-04 20:22:29 -0500] cheflevelramen: Free tier, but yes I do
[2012-12-04 20:22:53 -0500] gregp76: Ohai
[2012-12-04 20:23:53 -0500] gregp76: Is it possible to assign newly joined node to a default role as client connects to the server for the first time?
[2012-12-04 20:25:11 -0500] cheflevelramen: awgross: Still getting the integer error after updating all references. I'm going to have to play around a little more with this. I may have more questions later, but for now, I should break for lunch. Again, thanks for your help on this
[2012-12-04 20:39:08 -0500] jblaine: gregp76: I'm pretty sure you can do that if using knife bootstrap
[2012-12-04 20:40:22 -0500] awgross: chef related projects need to pick a version of rspec and stick to it
[2012-12-04 20:40:41 -0500] awgross: or not force me to install it unless I am dev'ing on it
[2012-12-04 20:41:04 -0500] gregp76: jblaine: i don't use knife for this right now (i can check this). right now newly kickstarted instace connects installs client and runs it as part of installation
[2012-12-04 20:47:46 -0500] josephholsten: why am I thinking of writing an adapter to run puppet manifests in chef
[2012-12-04 20:48:00 -0500] awgross: josephholsten: insanity?
[2012-12-04 20:48:01 -0500] josephholsten: what is wrong with me
[2012-12-04 20:48:14 -0500] siezer: how do I download a specific version of a cookbook from the community site?
[2012-12-04 20:48:26 -0500] awgross: just click the version number
[2012-12-04 20:48:34 -0500] awgross: not sure if there is a good way to do it via knife siezer
[2012-12-04 20:49:04 -0500] auduny: Argle.
[2012-12-04 20:49:15 -0500] auduny: Tried to deploy with fqdn vshpere name
[2012-12-04 20:49:21 -0500] auduny: knife vsphere vm clone 'vg-repo-01.int.vgnett.no' .....
[2012-12-04 20:49:38 -0500] auduny: That created a node called
[2012-12-04 20:49:38 -0500] auduny:  node_name         "vg-repo-01intvgnettno.int.vgnett.no"
[2012-12-04 20:49:42 -0500] auduny: Wow.
[2012-12-04 21:03:34 -0500] KarlHungus: siezer: knife cookbook site download COOKBOOK [VERSION] (options)
[2012-12-04 21:05:32 -0500] siezer: found it thanks
[2012-12-04 21:07:33 -0500] jblaine: grep76: chef-client --help shows -o
[2012-12-04 21:07:41 -0500] jblaine: grep76: Specify the run list there?
[2012-12-04 21:08:20 -0500] tolland: has anyone done any icons or css for showing chef resources in other systems
[2012-12-04 21:08:32 -0500] tolland: is there anything commons licensed
[2012-12-04 21:16:57 -0500] gregp76: thanks
[2012-12-04 21:20:57 -0500] Virunga: Using the cookbook database on host A, to create a new mysql database on the host B, what are the requirements? What should be already installed on machine B? Could you help me, please?
[2012-12-04 21:24:36 -0500] Virunga: I think it should be already installed mysql server because looking the source code i see provider_database_sql_server's db is a tinyTds.client and action_create have this db.execute("CREATE DATABASE [#{new_resource.database_name}]").do
[2012-12-04 21:24:57 -0500] Virunga: Could you give me your opinions?
[2012-12-04 21:25:51 -0500] Virunga: I'd like to know the minimum requirements...
[2012-12-04 21:42:04 -0500] programmerq: so, now I'm trying to figure out which nginx cookbook to use. It looks like the opscode nginx cookbook will install nginx itself, but it doesn't appear to try to abstract creating a config file for my site.
[2012-12-04 21:42:22 -0500] programmerq: Is it reasonable for me to just make my own template and depend on the opscode nginx cookbook?
[2012-12-04 21:53:36 -0500] masterkorp: yeah
[2012-12-04 21:54:14 -0500] masterkorp: i would create a whateveryoursiteiscalled cookbook with all that logic there
[2012-12-04 21:54:21 -0500] programmerq: k
[2012-12-04 21:54:22 -0500] masterkorp: programmerq: ^
[2012-12-04 21:54:33 -0500] programmerq: I did see another cookbook that tries to make config files
[2012-12-04 21:54:42 -0500] programmerq: but it looks like it would need to be extended anyway to do what I want
[2012-12-04 21:55:14 -0500] programmerq: it's assuming I want to have nginx running in front of something like unicorn on each node, but I'm trying to have a single nginx that reverse proxies to a bunch of nodes using the upstream module.
[2012-12-04 21:55:23 -0500] programmerq: it won't be hard to template out on my own
[2012-12-04 21:55:31 -0500] programmerq: just wanted to make sure I was heading in the right direction.
[2012-12-04 21:57:43 -0500] cheflevelramen: awgross: Not sure if you are still online, but I've made a bit of progress with my hostname cookbook. I've found a way to get the variables to show up in the template, but I don't know why one way works and the other doesn't. Mind taking a look:
[2012-12-04 21:57:48 -0500] cheflevelramen: Works: http://pastebin.com/xMzxQsKu
[2012-12-04 21:57:50 -0500] cheflevelramen: DoesntWork: http://pastebin.com/MBfEAppk
[2012-12-04 21:57:53 -0500] cheflevelramen: ErrorOutput: http://pastebin.com/6ULd5uLk
[2012-12-04 21:59:03 -0500] cheflevelramen: Results: http://pastebin.com/ZTbcZLxU
[2012-12-04 21:59:39 -0500] bmcgee: ohai
[2012-12-04 22:00:34 -0500] bmcgee: when i try upgrading my rails app it seems to have trouble recycling unicorn. When I manually try restarting it I get "timeout bla bla bla, got TERM"
[2012-12-04 22:00:41 -0500] bmcgee: anyone else come across this
[2012-12-04 22:00:45 -0500] bougyman: yes
[2012-12-04 22:00:51 -0500] bougyman: i moved to runit supervising unicorn
[2012-12-04 22:01:52 -0500] cheflevelramen: If anyone else doesn't mind taking a look at my issue above, I'd appreciate it. The problem is getting variables set in an attributes file to properly show up in a template. The above pastebins clearly show how I've written my cookbook, the cooresponding outputs and the error message I get
[2012-12-04 22:04:05 -0500] bmcgee: bougeyman: can you please explain that step?
[2012-12-04 22:04:38 -0500] bougyman: it's bigger than a breadbox, bmcgee
[2012-12-04 22:04:49 -0500] masterkorp: LOL
[2012-12-04 22:05:00 -0500] masterkorp: unicorn likes to bloat
[2012-12-04 22:05:09 -0500] bmcgee: bougyman: <insert sarcastic response here> :D
[2012-12-04 22:05:26 -0500] masterkorp: i have monit restarting the workers if they use more than X memory
[2012-12-04 22:05:41 -0500] bmcgee: thing is it's not really doing anything
[2012-12-04 22:05:42 -0500] bmcgee: 1 client
[2012-12-04 22:05:56 -0500] bmcgee: i'm running it on a 1 gb rackspace vm
[2012-12-04 22:06:02 -0500] bmcgee: should have enough resources
[2012-12-04 22:06:03 -0500] bougyman: it's ore really tat much.
[2012-12-04 22:06:07 -0500] bougyman:  % cat cookbooks/website/templates/default/unicorn-run.erb                                                                           (git)-[qa/2012-12-04] <dev> 15:19:10
[2012-12-04 22:06:11 -0500] bougyman: #!/bin/bash
[2012-12-04 22:06:13 -0500] bougyman: exec 2>&1
[2012-12-04 22:06:16 -0500] bougyman: cd /var/www/website/current
[2012-12-04 22:06:18 -0500] bougyman: [ -f ./log/<%= @rails_env -%>.log ] || setuidgid sonian-deploy touch ./log/<%= @rails_env -%>.log
[2012-12-04 22:06:21 -0500] bougyman: export RAILS_ENV=<%= @rails_env %>
[2012-12-04 22:06:24 -0500] bougyman: exec setuidgid sonian-deploy bundle exec unicorn_rails -c config/unicorn.rb 2>&1
[2012-12-04 22:06:26 -0500] bougyman: monit is ass
[2012-12-04 22:06:29 -0500] bougyman: I just converted from monit to runit to remove the assiness.
[2012-12-04 22:07:05 -0500] bougyman: crap on the paste.
[2012-12-04 22:07:09 -0500] bmcgee: lol
[2012-12-04 22:07:47 -0500] bmcgee: I'm really starting to dislike rails. the whole ecosystem around is 'awkward'
[2012-12-04 22:07:52 -0500] Virunga: cheflevelramen: you could try to use variables inside the template and using the variables method in template resource, maybe like will work.
[2012-12-04 22:08:04 -0500] bmcgee: *around it
[2012-12-04 22:08:56 -0500] masterkorp: bmcgee: yeah, they reivented the wheel
[2012-12-04 22:09:11 -0500] masterkorp: their own deploy, their own whatever
[2012-12-04 22:09:48 -0500] bmcgee: to a lesser extent I'm disappointed in ruby. I mean seriously, no concurrency.
[2012-12-04 22:10:12 -0500] masterkorp: bmcgee: back to C++ :p
[2012-12-04 22:10:24 -0500] bmcgee: I've been java/scala for 10 years
[2012-12-04 22:10:33 -0500] cheflevelramen: Virungo: Sure, I'll try that
[2012-12-04 22:10:42 -0500] bmcgee: could go jruby, but then i hear that brings other issues
[2012-12-04 22:10:46 -0500] awgross: FORTRAN or bust?
[2012-12-04 22:11:00 -0500] bmcgee: thought i'd go vanilla rails/ruby for this project, doesn't need to be super performance. but it's be a pain in the arse
[2012-12-04 22:11:08 -0500] bmcgee: *super performant
[2012-12-04 22:11:30 -0500] bluepojo: if you drink the coolaid and do everything the rails way, you will do fine if you try to do things the <insert other tech> way, you're gonna have a bad time
[2012-12-04 22:11:49 -0500] bluepojo: koolaid, eveh
[2012-12-04 22:11:51 -0500] bluepojo: even
[2012-12-04 22:12:03 -0500] bmcgee: thats the thing, i've been trying to drink the koolaid. They don't make it easy
[2012-12-04 22:12:28 -0500] mrk_: hey guys, was wondering if it's OK to register your chef-server with itself to create cronjobs and such for example?
[2012-12-04 22:12:37 -0500] mrk_: as in .. give it a chef-server role
[2012-12-04 22:12:55 -0500] bluepojo: I don't see why it wouldn't work but I haven't tried it
[2012-12-04 22:13:46 -0500] bmcgee: mrk_ sounds very meta
[2012-12-04 22:13:51 -0500] bmcgee: :)
[2012-12-04 22:13:54 -0500] mrk_: heh
[2012-12-04 22:14:20 -0500] mrk_: was thinking of adding cronjobs to backup the chef-server
[2012-12-04 22:14:32 -0500] mrk_: and rather than doing this manually, wanted to do it with a chef recipe :p
[2012-12-04 22:15:01 -0500] mrk_: not quite sure what's the usual behavior
[2012-12-04 22:22:27 -0500] Urocyon: We currently name our nodes in chef according to their FQDN, but his becomes a problem when we want to change the hostname of a system.  mismatched names would lead to confusion.   Anyone else have this problem?
[2012-12-04 22:23:03 -0500] Urocyon: My current solution has been to remove the client and node and then rebootstrap the system taking care to make sure I get all the same run_list in place.
[2012-12-04 22:23:04 -0500] awgross: Urocyon: dont change hostnames, jsut destroy and build new servers!
[2012-12-04 22:23:08 -0500] Mithrandir: why are you changing the host name?
[2012-12-04 22:23:14 -0500] Urocyon: That's a little awkward though.
[2012-12-04 22:24:41 -0500] spox: don't name based on fqdn? node names shouldn't really matter. you can use search to locate a node with a fqdn if that's what you're looking for.
[2012-12-04 22:26:34 -0500] Urocyon: yeah, was considering changing my naming decoupling from fqdn.  it just isn't how I have things now.
[2012-12-04 22:27:19 -0500] Urocyon: And the hostname is changing because of changes in how we organize system names by environment.
[2012-12-04 22:27:50 -0500] Urocyon: I'm requested to move a system to a new environment and change it's hostname.
[2012-12-04 22:37:48 -0500] bmcgee: bougyman: the application_ruby cookbook is using runit to manage unicorn but it seems unicorn just isn't listening
[2012-12-04 22:37:54 -0500] bmcgee: can't get it to stop
[2012-12-04 22:38:01 -0500] bmcgee: keep getting TERM on every command
[2012-12-04 22:38:32 -0500] cheflevelramen: Okay, I'm about the end of my wits here, so be prepared for a bit of a rant. I'm running into issues that make no sense, and I'm afraid I haven't been asking the right questions. The exact problem I'm trying to solve is to simply create a variable that I set in an attributes file that I then access in template.erb file. For some reason, using this syntax works:
[2012-12-04 22:38:38 -0500] cheflevelramen: default[:domain]   = "localhost.default.org"
[2012-12-04 22:38:40 -0500] cheflevelramen: And this syntax doesn't:
[2012-12-04 22:38:43 -0500] cheflevelramen: default[:hostname][:domain]   = "localhost.default.org"
[2012-12-04 22:38:45 -0500] cheflevelramen: The cookbook is named 'hostname' and I assume I need to have the nested syntax that doesn't work so I can properly override the attribute variable (forgive me if I misuse any terms here. Very new to ERB, and limited Ruby experience).
[2012-12-04 22:38:50 -0500] cheflevelramen: So, to start from scratch:
[2012-12-04 22:38:52 -0500] cheflevelramen: 1) What's the proper way to set a variable in an attributes file and access it in a template.erb file (do I need to put it in the recipe as well?)
[2012-12-04 22:38:56 -0500] cheflevelramen: 2) What's the proper way to override the variable from a role?
[2012-12-04 22:38:58 -0500] cheflevelramen: Again, I appreciate the help. Can't seem to get this working
[2012-12-04 22:39:12 -0500] cheflevelramen: Results: http://pastebin.com/ZTbcZLxU
[2012-12-04 22:40:01 -0500] bmcgee: 1) default[:foo][:bar] = "bla"
[2012-12-04 22:40:07 -0500] spox: cheflevelramen: try using a different base key
[2012-12-04 22:40:16 -0500] spox: :hostname is going to be coming from ohai infos
[2012-12-04 22:40:25 -0500] bmcgee: 2) override_attributes(:foo => { :bar => "bla bla bla" }})
[2012-12-04 22:46:54 -0500] cheflevelramen: spox: Wow, thanks a lot. That was the issue. Changed base key to :myhostname and it now works!
[2012-12-04 22:47:09 -0500] spox: cheflevelramen: sure :)
[2012-12-04 22:47:15 -0500] cheflevelramen: I should have reliazed that would be in use by ohai
[2012-12-04 22:49:59 -0500] awgross: cheflevelramen: whoops I should have thought of that, completely blanked on ohai having its way with your node attributes
[2012-12-04 22:50:27 -0500] mrk_: do you guys store specific cronjobs into specific cookbooks for your organization, or do you have a cronjob cookbook with all your crons?
[2012-12-04 22:50:48 -0500] awgross: mrk_: we put our cronjobs in the cookbook they relate to
[2012-12-04 22:51:04 -0500] mrk_: ok. thanks!
[2012-12-04 22:51:06 -0500] Mithrandir: I do basically what awgross says
[2012-12-04 22:51:39 -0500] awgross: mrk_: if for some reason you have a ton of guidelines around your cronjob that would lean you towards putting them all in 1 cookbook, create a better custom LWRP instead
[2012-12-04 22:52:04 -0500] mrk_: i pretty much have an *almost* empty chef-repo
[2012-12-04 22:52:11 -0500] mrk_: just trying to set it up in the best possible way
[2012-12-04 22:52:14 -0500] awgross: gotcha
[2012-12-04 22:52:19 -0500] mrk_: trying to wrap my head around best practices etc..
[2012-12-04 22:52:30 -0500] awgross: yep np, it is hard to find them sometimes
[2012-12-04 22:52:56 -0500] mrk_: hehe. it was easier in my previous company where there was already some sort of structure. starting from scratch is tedious
[2012-12-04 22:53:42 -0500] Mithrandir: why almost empty?
[2012-12-04 22:54:06 -0500] mrk_: well - i cloned the chef-repo, now it's up to me to make magic happen
[2012-12-04 22:54:14 -0500] miah: greenfield is fun. you can be creative and learn.
[2012-12-04 22:54:30 -0500] Mithrandir: miah: that is so true.
[2012-12-04 22:54:42 -0500] mrk_: i have a base role for now, and trying to setup a few crons around the chef-server
[2012-12-04 22:54:48 -0500] Mithrandir: the trick is to expand quickly enough that you always have greenfield.
[2012-12-04 22:54:51 -0500] cheflevelramen: awgross: No problem. Just glad it's working now :)
[2012-12-04 22:55:05 -0500] mrk_: it is a lot of fun! for now its smooth.
[2012-12-04 22:58:27 -0500] rb1980: good afternoon chef'ers... anyone around to help me out with a recipe?
[2012-12-04 23:07:35 -0500] miah: rb1980: ask your question rather than asking if you can ask a question.
[2012-12-04 23:11:04 -0500] rb1980: just seeing if anyone here first
[2012-12-04 23:11:55 -0500] rb1980: so i'm trying to do some cookbook_file distribution: multiple files to multiple machines.
[2012-12-04 23:12:01 -0500] rb1980: not all machines will get all files
[2012-12-04 23:12:01 -0500] mobilemike: I'm confused about how to perform a resource action in advance of using include_recipe. The dnssimple cookbook will try to install the `fog` gem without first checking/installing some compilation dependencies. How can I do that in my cookbook, so that their installed in advance of the dnsimple recipe running?
[2012-12-04 23:12:48 -0500] mobilemike: I tried putting package x, package y before include_recipe, but that's not helping
[2012-12-04 23:13:28 -0500] rb1980: so I was trying something like this: http://pastebin.com/c1RVSd0G
[2012-12-04 23:13:45 -0500] spox: mobilemike: is it a chef_gem installation of fog, or just a regular gem_package?
[2012-12-04 23:13:57 -0500] rb1980: i get an error when runs on servernameA: FATAL: Chef::Exceptions::ValidationFailed: Option owner's value  does not match regular expression
[2012-12-04 23:14:24 -0500] mobilemike: spox: gem_package
[2012-12-04 23:14:43 -0500] spox: then just ensure your recipe is higher in the run list than where it's being included
[2012-12-04 23:15:22 -0500] mobilemike: Hmm My recipe is calling that recipe. It's not directly in any run list. Is that incorrect usage?
[2012-12-04 23:15:55 -0500] spox: no, that's fine. then you want to make sure you are defining your resources (package installs) before you include the recipe
[2012-12-04 23:16:42 -0500] mobilemike: Huh. That's what I _think_ I'm doing... http://pastie.org/5481293
[2012-12-04 23:17:43 -0500] spox: mobilemike: are the xlst bits what need to be installed?
[2012-12-04 23:17:54 -0500] mobilemike: Correct
[2012-12-04 23:18:20 -0500] spox: i'm guessing it's probably a chef_gem then (or gem_package compile time installed) since it's being used by the lwrp
[2012-12-04 23:18:23 -0500] spox: anyway
[2012-12-04 23:18:50 -0500] mobilemike: I think i read somewhere that it is compile time installed
[2012-12-04 23:19:00 -0500] spox: pkg = package(lib); pkg.run_action(:install)
[2012-12-04 23:19:14 -0500] spox: you need that in the loop to force the packages to be installed during compile phase
[2012-12-04 23:19:42 -0500] mobilemike: Ahhh Okay. I'll look into that more. I thought it was something like that.
[2012-12-04 23:21:00 -0500] rb1980: i had a typo in my first paste. here is updated: http://pastebin.com/vTxBwkej
[2012-12-04 23:21:24 -0500] rb1980: so when i run that on servernameA it barks at line 43 about owner
[2012-12-04 23:21:41 -0500] rb1980: presumably because owner2 is not defined
[2012-12-04 23:22:14 -0500] rb1980: but i thought wrapping that in an if would bypass
[2012-12-04 23:38:49 -0500] rb1980: can anyone help? i'm stumped: http://pastebin.com/vTxBwkej
[2012-12-04 23:39:27 -0500] isotope: missing an end?
[2012-12-04 23:40:55 -0500] rb1980: i don't think so... i get an error when i run on servernameA about the owner not matching regex
[2012-12-04 23:41:20 -0500] rb1980: presumably because its hitting the second cookbook_file where its not defined
[2012-12-04 23:41:51 -0500] mobilemike: spox: Sorry, had to run for a train. Thanks for the help.
[2012-12-04 23:45:28 -0500] dougireton: rb1980: you could put the file info into a hash per node or per node type, then iterate over the hash in your recipe. it seem like you have too much information about specific nodes in your recipe
[2012-12-04 23:45:53 -0500] dougireton: it's too tightly coupled to your specific implementation
[2012-12-04 23:48:04 -0500] rb1980: ok, that's a bit above my grade level currently but i think i at least understand the concept of what you are saying
[2012-12-04 23:48:37 -0500] dougireton: rb1980: also your error doesn't make sense. You aren't comparing owner using a regex
[2012-12-04 23:49:03 -0500] rb1980: right, i know... i think it is complaining becuase it's undefined
[2012-12-04 23:49:24 -0500] rb1980: [Tue, 04 Dec 2012 23:29:19 +0000] FATAL: Chef::Exceptions::ValidationFailed: Option owner's value  does not match regular expression [/^([-a-zA-Z0-9_.]+)$/, /^\d+$/]
[2012-12-04 23:50:02 -0500] rb1980: it seems servernameA is trying to run the second cookbook_file instance
[2012-12-04 23:50:10 -0500] rb1980: (based on the line number)
[2012-12-04 23:51:48 -0500] rb1980: and yes, i understand that the way i am trying to do this is probably extremly crappy
[2012-12-04 23:52:38 -0500] rb1980: it was working fine with one file, but when i went to add a second file thats when things went south
