[2012-12-11 00:38:16 -0500] juozas: Howdy folks, I got a newbie question (tried googling with no luck). What ohai attribute would tell me if I have a 32bit or 64bit architecture (this will run on windows) and is there some place in code or documentation to see what the possible values for that attribute are?
[2012-12-11 00:39:30 -0500] cwj: juozas: have a look at node[:kernel][:machine]
[2012-12-11 00:39:32 -0500] juliancdunn: juozas: node['kernel']['machine']?
[2012-12-11 00:39:36 -0500] juliancdunn: ~~
[2012-12-11 00:39:42 -0500] cwj: :D
[2012-12-11 00:39:53 -0500] juozas: thank you!
[2012-12-11 00:39:57 -0500] githubble: hi when I include knife[:run_list] = "recipe[nginx]" in my knife.rb it doesn't install nginx .. why is this?
[2012-12-11 00:40:33 -0500] cwj: juozas: https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/kernel.rb is the relevant code
[2012-12-11 00:41:02 -0500] mhalligan: is there a way to make chef-client not need hostname --fqdn to work properly?
[2012-12-11 00:41:04 -0500] cwj: so possible values would be whatever the possible output of uname -m is
[2012-12-11 00:42:06 -0500] mhalligan: the hostname manage recommends against using hostname -f .. and I agree with it.
[2012-12-11 00:44:31 -0500] juozas: for windows, i'm looking at https://github.com/opscode/ohai/blob/master/lib/ohai/plugins/windows/kernel.rb, which gives me some different values than uname -m seems to give, but that works for me either way :D
[2012-12-11 00:56:09 -0500] githubble: hi when I include knife[:run_list] = "recipe[nginx]" in my knife.rb it doesn't install nginx .. any assistance would be great
[2012-12-11 01:03:21 -0500] yfeldblum: githubble, why is that in your knife.rb in the first place?
[2012-12-11 01:04:01 -0500] yfeldblum: githubble, when you bootstrap (or $CLOUD server create) a node, use: --run-list 'recipe[nginx]'
[2012-12-11 01:05:39 -0500] yfeldblum: githubble, better yet, make a role naming the kind of server it is (a role named, e.g., "main-app-web-frontend") and the only thing you do with it is give it a run list with just: ["recipe[nginx]"] ... and then `knife $CLOUD server create --run-list 'role[main-app-web-frontend]'`
[2012-12-11 01:10:41 -0500] githubble: yfeldblum what if I want to install 12 cookbooks at once?
[2012-12-11 01:11:25 -0500] yfeldblum: githubble, then make a role describing the kind of node this thing is, and in that role, set the run-list to those 12 recipes
[2012-12-11 01:12:26 -0500] githubble: yfeldblum cool, however I am using knife ec2 ... how do I pull my nodes from hosted chef ?  thanks so far
[2012-12-11 01:12:41 -0500] yfeldblum: githubble, i'm not sure what you mean by "pull"
[2012-12-11 01:13:20 -0500] githubble: when I run knife ec2 create server ..... there is no link to hosted chef at this stage for me
[2012-12-11 01:14:37 -0500] githubble: yfeldblum any assistance would be great
[2012-12-11 01:15:01 -0500] yfeldblum: githubble, what do you mean by "link"?
[2012-12-11 01:15:39 -0500] yfeldblum: githubble, what are you seeing?
[2012-12-11 01:15:42 -0500] githubble: yfeldblum in my knife.rb I am specifying my ec2 instances ..... not using hosted-chef node
[2012-12-11 01:17:29 -0500] githubble: yfeldblum when I run knife ec2 create server ..... I want it to automate my cookbooks etc as much as possible (e.g. I don't want to have type at the command line -r "recipe1[nginx], recipe2 etc."
[2012-12-11 01:18:20 -0500] yfeldblum: githubble, that's what roles are for
[2012-12-11 01:18:38 -0500] yfeldblum: githubble, when you create a server, you assign it to one top-level role
[2012-12-11 01:19:15 -0500] yfeldblum: githubble, you do that assignment on the command line when you create the server (how else is anything supposed to know what that server is supposed to be?)
[2012-12-11 01:19:20 -0500] githubble: hmmm it seems that my knife ec2 create is not talking to hosted-chef, as when I run knife node list I don't see anything in there
[2012-12-11 01:19:41 -0500] githubble: again thanks for your help so far
[2012-12-11 01:20:44 -0500] yfeldblum: githubble, well ... what *do* you see? e.g. what do you see when you run `knife ec2 server create ...`?
[2012-12-11 01:21:17 -0500] githubble: yfeldblum it goes off and creates a server, do you want a gist output?
[2012-12-11 01:22:03 -0500] yfeldblum: githubble, and does it bootstrap the node? and does the bootstrap succeed?
[2012-12-11 01:22:43 -0500] martinisoft: quick question on application cookbooks. does my application cookbook files directory override an included cookbook's files? Example: if I want to override the nginx cookbook mime.types, do I add my own in the application cookbook instead of forking?
[2012-12-11 01:22:48 -0500] githubble: yfeldblum https://gist.github.com/4254948
[2012-12-11 01:23:23 -0500] martinisoft: inspecting the wiki and not finding a definitive answer
[2012-12-11 01:26:40 -0500] githubble: yfeldblum ok .... I see what you mean now .... knife ec2 server create -i chef-aws.pem -r "role[admin]" seems to work
[2012-12-11 01:37:38 -0500] jtnz: Does anyone know how to "break" from a recipe?
[2012-12-11 01:38:27 -0500] jtnz: e.g. say I only want to a recipe to run if it's a particular version of chef client.
[2012-12-11 02:04:51 -0500] jtnz: Somebody?
[2012-12-11 02:04:58 -0500] jtnz: Anybody?
[2012-12-11 02:10:19 -0500] yfeldblum: jtnz, https://github.com/opscode/chef/blob/master/lib/chef/version.rb
[2012-12-11 02:10:39 -0500] yfeldblum: jtnz, this is pretty standard across many ruby libraries
[2012-12-11 02:11:22 -0500] yfeldblum: jtnz, puts "old!!!" if Chef::VERSION < "10"
[2012-12-11 02:24:49 -0500] jtnz: yfeldblum, Thanks for that, but do you also happen to know how to "break" from a recipe?
[2012-12-11 02:25:19 -0500] jtnz: yfeldblum, I've seen it somewhere recently but for the life of me I can't find it again :(
[2012-12-11 02:27:36 -0500] jtnz: yfeldblum, I remember it was at the start of a recipe, most likely on github, and it checked the platform version, and if it was windows then it did something like 'skip_recipe'
[2012-12-11 02:32:44 -0500] yfeldblum: jtnz, nope
[2012-12-11 02:33:07 -0500] jtnz: yfeldblum, no worries, thanks for your help
[2012-12-11 02:33:08 -0500] yfeldblum: jtnz, recipes are run in the context of (where `self` is) an instance of Chef::Recipe, which is here: https://github.com/opscode/chef/blob/master/lib/chef/recipe.rb
[2012-12-11 02:33:27 -0500] yfeldblum: jtnz, any instance method in Chef::Recipe is available in a recipe
[2012-12-11 02:34:30 -0500] jtnz: yfeldblum, yea, I checked there but no luck. I'm sure I saw it somewhere. Oh well, I just put the whole lot in an if statement ;)
[2012-12-11 02:40:13 -0500] makmanalp: which user does chef run as?
[2012-12-11 02:53:32 -0500] flaccid: hey guys i'm trying to install a pecl module via php_pear[imagick] but it returns php_pear[imagick] (pecl::install_packages line 26) had an error: NameError: Cannot find a resource for converge_by on ubuntu version 12.04
[2012-12-11 02:54:40 -0500] flaccid: traces back to cookbooks/php/providers/pear.rb:44:in `class_from_file'. this is the master branch currently of the php cookbook
[2012-12-11 02:57:21 -0500] flaccid: hmm https://github.com/opscode-cookbooks/php/blob/master/providers/pear.rb#L44 converge_by(description) do. i'm not familiar with this method..
[2012-12-11 02:57:29 -0500] flaccid: need a certain chef version? this is chef 0.10.10
[2012-12-11 03:00:12 -0500] flaccid: seems to be asked/ran into before http://community.opscode.com/chat/chef/2012-12-04
[2012-12-11 03:01:32 -0500] flaccid: also on http://community.opscode.com/chat/chef/2012-11-22
[2012-12-11 03:02:05 -0500] flaccid: i guess i'll try the latest version not master http://community.opscode.com/chat/chef/2012-11-22#id-243263
[2012-12-11 03:12:45 -0500] ssd7: flaccid: Yeah, you are going to need a newer version of chef that has why_run support to use that cookbook from master
[2012-12-11 03:13:38 -0500] flaccid: i think i did just test with 10.16.2 but maybe i didn't. i'll just see if the 1.1.0 tag works thanks
[2012-12-11 03:18:58 -0500] jtimberman: flaccid: you need chef 10.14+, converge_by came with why-run mode.
[2012-12-11 03:19:38 -0500] flaccid: no problem thanks guys. i'm just reverting to master and will test on 10.16.2
[2012-12-11 03:45:55 -0500] githubble: hi, when I run knife ec2 create server -r "role[admin]" it is not picking up the recipes in my hosted-chef ... asisstance would be great
[2012-12-11 03:53:55 -0500] Guest96986: knife configure -i
[2012-12-11 03:53:57 -0500] Guest96986: Overwrite /root/.chef/knife.rb? (Y/N) y
[2012-12-11 03:53:59 -0500] Guest96986: Please enter the chef server URL: [http://ip-10-252-72-153.us-west-2.compute.internal:4000] http://localhost:4000
[2012-12-11 03:54:00 -0500] Guest96986: Please enter a clientname for the new client: [nanjegow]
[2012-12-11 03:54:02 -0500] Guest96986: Please enter the existing admin clientname: [chef-webui]
[2012-12-11 03:54:03 -0500] Guest96986: Please enter the location of the existing admin client's private key: [/etc/chef/webui.pem]
[2012-12-11 03:54:05 -0500] Guest96986: Please enter the validation clientname: [chef-validator]
[2012-12-11 03:54:06 -0500] Guest96986: Please enter the location of the validation key: [/etc/chef/validation.pem]
[2012-12-11 03:54:08 -0500] Guest96986: Please enter the path to a chef repository (or leave blank):
[2012-12-11 03:54:09 -0500] Guest96986: Creating initial API user...
[2012-12-11 03:54:11 -0500] Guest96986: ERROR: Server returned error for http://localhost:4000/clients/nanjegow, retrying 1/5 in 3s
[2012-12-11 03:54:48 -0500] Guest96986: can anyone please help me why i am getting above error
[2012-12-11 03:55:06 -0500] bluepojo: check your chef server logs
[2012-12-11 03:55:10 -0500] bluepojo: to see what it's saying
[2012-12-11 03:57:47 -0500] aruntomar: githubble: knife role list , to check if the role exists on the your hosted chef account.
[2012-12-11 04:00:05 -0500] githubble: aruntomar yes
[2012-12-11 04:00:24 -0500] githubble: aruntomar yes it shows my role 'admin'
[2012-12-11 04:00:41 -0500] bluepojo: in private chef, how do I generate an encrypted data bag secret?
[2012-12-11 04:01:37 -0500] githubble: aruntomar when I run knife role show admin it shows me the run_list ... .recipe[bluepill] + recipe[nginx] ... however it is not installing these.... confused
[2012-12-11 04:25:56 -0500] flaccid: ssd7, jtimberman yep all good now
[2012-12-11 04:26:14 -0500] flaccid: but i do need to address checking ImageMagick MagickWand API configuration program... configure: error: not found. Please provide a path to MagickWand-config or Wand-config program. :(
[2012-12-11 04:28:51 -0500] flaccid: was there an option in the php_pear lwrp or something to install a pecl with --nobuild?
[2012-12-11 04:29:24 -0500] aruntomar: githubble: paste the output of "knife node list" and "knife node show <your node name> " on gist and provide the link
[2012-12-11 04:32:35 -0500] githubble: aruntomar https://gist.github.com/4255880
[2012-12-11 04:34:50 -0500] aruntomar: githubble: k, so it seems that you don't have any nodes yet registered with the hosted chef.
[2012-12-11 04:35:09 -0500] aruntomar: githubble: can you paste the output of knife ec2 server create .... command
[2012-12-11 04:40:32 -0500] githubble: aruntomar .... same link added https://gist.github.com/4255880
[2012-12-11 04:41:58 -0500] aruntomar: githubble: your node has not bootstrapped with chef
[2012-12-11 04:42:13 -0500] githubble: aruntomar .... how do I do this please
[2012-12-11 04:43:07 -0500] githubble: aruntomar ..... I am using knife ec2 by the way
[2012-12-11 04:47:25 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~ Params: {"private_key"=>false, "name"=>"nanjegow", "id"=>"nanjegow", "action"=>"update", "controller"=>"clients", "admin"=>true}
[2012-12-11 04:47:27 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~ {:dispatch_time=>3.131645, :action_time=>0.000748, :after_filters_time=>1.8e-05, :before_filters_time=>0.000173}
[2012-12-11 04:47:28 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~
[2012-12-11 04:47:30 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~ Started request handling: Tue Dec 11 04:46:36 +0000 2012
[2012-12-11 04:47:31 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~ Params: {"private_key"=>false, "name"=>"nanjegow", "id"=>"nanjegow", "action"=>"update", "controller"=>"clients", "admin"=>true}
[2012-12-11 04:47:33 -0500] Guest96986: merb : chef-server (api) : worker (port 4000) ~ Connection failed - user: chef - (Bunny::ProtocolError)
[2012-12-11 04:48:09 -0500] Guest96986: i am getting above exception when try Please enter the path to a chef repository (or leave blank):
[2012-12-11 04:48:10 -0500] Guest96986: Creating initial API user...
[2012-12-11 04:48:12 -0500] Guest96986: ERROR: Server returned error for http://localhost:4000/clients/nanjegow, retrying 1/5 in 3s
[2012-12-11 04:48:51 -0500] Guest96986: what could be the issue
[2012-12-11 04:51:29 -0500] githubble: aruntomar ... any assistance would be great
[2012-12-11 04:52:20 -0500] aruntomar: githubble: https://gist.github.com/447acc930ae1fcbe9822
[2012-12-11 04:54:11 -0500] githubble: aruntomar ... receiving this error ... ssh-add .ssh/chef-aws.pem Could not open a connection to your authentication agent.
[2012-12-11 04:58:03 -0500] githubble: aruntomar ... assistance would be greatly appreciated ... so close now
[2012-12-11 05:01:23 -0500] githubble: aruntomr ... it seems the command ssh-add or ssh-agent don't run on my ubuntu instance
[2012-12-11 05:03:44 -0500] ssd7: githubble: running ssh-agent should output some code that you then have to execute in your currently running shell
[2012-12-11 05:04:05 -0500] ssd7: githubble: something like: eval $(ssh-agent)
[2012-12-11 05:04:09 -0500] ssd7: then ssh-add should work.
[2012-12-11 05:04:11 -0500] githubble: ssd sudo of course
[2012-12-11 05:04:49 -0500] ssd7: githubble: sudo shouldn't typically be necessary.
[2012-12-11 05:06:03 -0500] githubble: ssd7 ... identity added !!!
[2012-12-11 05:08:23 -0500] ssd7: Nice :)
[2012-12-11 05:09:20 -0500] h2flow: I want to build a tar file and have nodes check it to see if it has changed and if it is changed download and install it, is that possible
[2012-12-11 05:10:41 -0500] ssd7: h2flow: Yes, you can make a head request against the file to see if it has changed, and if so trigger notifications to remote_file and other resources
[2012-12-11 05:10:52 -0500] ssd7: h2flow: I might have an example around here somewhere
[2012-12-11 05:10:56 -0500] githubble: ssd7 even though I have added ssh-add ... it is still not bootstrapping with chef .. please assist
[2012-12-11 05:11:11 -0500] h2flow: that would be cool
[2012-12-11 05:11:33 -0500] h2flow: I want it to run in the background as a dameon and che3ck periodically
[2012-12-11 05:11:42 -0500] h2flow: the chef-client
[2012-12-11 05:12:06 -0500] ssd7: githubble: Can you post a gist/pastebin of the full error your are getting?
[2012-12-11 05:12:45 -0500] githubble: ssd 7 no error, its just not bootstrapping with hosted-chef .... I will send the output
[2012-12-11 05:14:22 -0500] githubble: ssd7 https://gist.github.com/4256066
[2012-12-11 05:14:49 -0500] ssd7: githubble: add -x ubuntu to your command
[2012-12-11 05:14:52 -0500] ssd7: and --sudo
[2012-12-11 05:15:03 -0500] ssd7: actually, no --sudo since you are using knife-ec2
[2012-12-11 05:15:32 -0500] ssd7: h2flow: `find | grep` is currently looking for that example.  Can't seem to remember where I have used that pattern before
[2012-12-11 05:15:37 -0500] h2flow: ssd7 I'll look up what you told me, thanks, I've checked out the head request before but am not sure how exactly it works, thanks
[2012-12-11 05:15:58 -0500] githubble: ssd7 brb
[2012-12-11 05:16:46 -0500] h2flow: ok thank you
[2012-12-11 05:17:26 -0500] ssd7: h2flow: Ahh, check out the second example here: http://docs.opscode.com/resource_remote_file.html
[2012-12-11 05:20:08 -0500] h2flow: thanks, is there a way I can have the chef client check a website periodilly for a file and then when it changes install it
[2012-12-11 05:24:13 -0500] ssd7: h2flow: Well, you can run chef-client via cron or as a daemon (that takes care of the 'periodically' part) and then you can have a recipe that uses something like that example but in addition to downloading it, you would also trigger the installation
[2012-12-11 05:28:17 -0500] h2flow: thank you ssd7, I also have a question regarding cookbooks, I have more than node which uses a recipe, but I adjust the attributes and then upload it to chef server. I want the chef-client toi update update its's recipes  and install them but not change the attributes whats the best way to go about that
[2012-12-11 05:30:05 -0500] aruntomar: githubble: hi! i was not at desk.
[2012-12-11 05:31:09 -0500] aruntomar: githubble: so what's the status?
[2012-12-11 05:32:21 -0500] githubble: aruntomar .... it is still not connecting to hosted-chef
[2012-12-11 05:33:02 -0500] githubble: aruntomar hang on IT WORKED pasting to gist for you to have a look
[2012-12-11 05:36:03 -0500] githubble: aruntomar + ssd7 https://gist.github.com/4256139 thank-you so much
[2012-12-11 05:38:25 -0500] githubble: aruntomar looks like nginx possibly didn't install?
[2012-12-11 05:40:10 -0500] aruntomar: githubble: gr8, so finally your node is bootstrapped and yes, nginx seems to have a problem.
[2012-12-11 05:40:21 -0500] aruntomar: githubble: which nginx cookbook r u using.
[2012-12-11 05:41:05 -0500] aruntomar: githubble: pull the latest nginx cookbook from the community site and upload it to your hosted chef
[2012-12-11 05:41:14 -0500] aruntomar: knife cookbook site install nginx
[2012-12-11 05:41:23 -0500] aruntomar: knife cookbook upload nginx
[2012-12-11 05:42:21 -0500] aruntomar: knife cookbook site show nginx => to see what latest version of nginx cookbook is available  and "knife cookbook show nginx" to check what version of cookbook you have in your hosted chef.
[2012-12-11 05:43:03 -0500] githubble: aruntomar nginx 0.100.2
[2012-12-11 05:44:05 -0500] githubble: aruntomar get this error ... knife cookbook site install nginx Installing nginx to /home/administrator/chef-repo/cookbooks ERROR: You have uncommitted changes to your cookbook repo (/home/administrator/chef-repo/cookbooks):  M .chef/knife.rb Commit or stash your changes before importing cookbooks
[2012-12-11 05:44:40 -0500] aruntomar: githubble: if you've uncommitted changes in your chef-repo, it'll give u that error
[2012-12-11 05:44:55 -0500] aruntomar: githubble: commit those changes or stash them and run the command again
[2012-12-11 05:44:56 -0500] githubble: aruntomar how to I commit them?
[2012-12-11 05:45:37 -0500] aruntomar: githubble: short version: git commit -a -m 'commit changes'
[2012-12-11 05:45:46 -0500] githubble: aruntomar .. how do I commit the changes?
[2012-12-11 05:46:06 -0500] githubble: aruntomar ... oh git is causing this issue?
[2012-12-11 05:46:36 -0500] ssd7: h2flow: Sorry, a bit distracted atm.  I'm not sure I understand your question.
[2012-12-11 05:51:35 -0500] githubble: now receiving this error .... knife cookbook site install oahi Installing oahi to /home/administrator/chef-repo/cookbooks Checking out the master branch. Pristine copy branch (chef-vendor-oahi) exists, switching to it. ERROR: The object you are looking for could not be found Response:
[2012-12-11 05:52:15 -0500] ssd7: githubble: typo: oahi -> ohai
[2012-12-11 05:53:04 -0500] githubble: ssh7 thanks
[2012-12-11 05:53:41 -0500] githubble: looks like my .git is now chef-vendor-oahi :(  it should be my private github repo ... how do I get it back
[2012-12-11 05:54:13 -0500] ssd7: githubble: I would just: git checkout master
[2012-12-11 05:54:33 -0500] ssd7: if you want you can do `git branch -D chef-vender-oahi1
[2012-12-11 05:54:38 -0500] ssd7: s/1/`/
[2012-12-11 05:54:46 -0500] aruntomar: githubble: it's just a git branch, don't worry about it. just change the branch
[2012-12-11 05:55:02 -0500] githubble: ssd7 aruntomar all good fixed that
[2012-12-11 05:55:23 -0500] githubble: so here goes again...... after updating the nginx and ohai I will try a build
[2012-12-11 06:06:19 -0500] jfl0wers: I am getting this error on the postgresql install
[2012-12-11 06:06:19 -0500] jfl0wers: https://gist.github.com/4256253
[2012-12-11 06:06:51 -0500] jfl0wers: this is on CentOS
[2012-12-11 06:07:22 -0500] jfl0wers: the short gist of the error is:
[2012-12-11 06:07:57 -0500] githubble: aruntomar ... still having the same issue with nginx
[2012-12-11 06:08:09 -0500] jfl0wers: grrr
[2012-12-11 06:08:26 -0500] jfl0wers: can't even paste a little bit?
[2012-12-11 06:08:51 -0500] jfl0wers: so you will have to view the gist
[2012-12-11 06:19:15 -0500] flaccid: jfl0wers: check to make sure the cookbooks, particularly postrgresql support centos. its probably missing that step in the cookbook i assume unless its another logical error
[2012-12-11 06:22:07 -0500] ssd7: githubble: That apt error likely means that something is up with apt on that machine.  You might try running apt-get update on that machine and see what it returns.
[2012-12-11 06:22:35 -0500] githubble: ssd7 can I automate it?  I just upgraded nginx to 1.1.0 but still same error
[2012-12-11 06:25:08 -0500] jfl0wers: flaccid it is a logic error in the cookbook
[2012-12-11 06:25:25 -0500] jfl0wers: line 59
[2012-12-11 06:25:47 -0500] jfl0wers: the operator is reversed
[2012-12-11 06:25:51 -0500] jfl0wers: it is:
[2012-12-11 06:25:54 -0500] ssd7: githubble: Typically I think that getting 100 back from apt means that some previous installation or update failed. But it is raether non-specific
[2012-12-11 06:26:00 -0500] githubble: ssd7 is there a better ami to use?
[2012-12-11 06:26:05 -0500] jfl0wers: if node['postgresql']['version'].to_f < 9.0
[2012-12-11 06:26:11 -0500] jfl0wers: if should be:
[2012-12-11 06:26:14 -0500] jfl0wers: if node['postgresql']['version'].to_f > 9.0
[2012-12-11 06:26:19 -0500] ssd7: githubble: so, yes, you can eventaully automate it, but to get around the error you ahve to figure out what the original problem was
[2012-12-11 06:26:23 -0500] flaccid: jfl0wers: i guess you could either log a bug or contrib the fix
[2012-12-11 06:26:42 -0500] jfl0wers: I will do contrib a fix
[2012-12-11 06:27:36 -0500] githubble: ssd7 use a different ami?  is there a definitive list of ami's that can be used for knife ec2
[2012-12-11 06:28:10 -0500] BryanWB_: ohai chefs!
[2012-12-11 06:28:23 -0500] BryanWB_: shit is about to get real
[2012-12-11 06:28:40 -0500] ssd7: githubble: Well, it is unlikely to be a problem with the AMI.  If you are on ubuntu I usually use one from Canonical.
[2012-12-11 06:28:46 -0500] ssd7: BryanWB_: Welcome :)
[2012-12-11 06:28:52 -0500] BryanWB_: ssd7: hey buddy :)
[2012-12-11 06:29:07 -0500] githubble: ssd7 can you point me in the right direction?
[2012-12-11 06:31:57 -0500] ssd7: githubble: For images: http://cloud-images.ubuntu.com/locator/ec2/  But for the problem at hand, I would probably log into that machine and see what was going on.
[2012-12-11 06:34:04 -0500] githubble: ssd7 thanks gotta fly
[2012-12-11 06:54:55 -0500] ssd7: How's it going BryanWB_ ?
[2012-12-11 06:55:39 -0500] BryanWB_: ssd7: pretty hectic, go-live for my site is tomorrow
[2012-12-11 07:33:54 -0500] solarce: is it just me or does fog have horrible documentation?
[2012-12-11 07:52:17 -0500] mailo_: Hello! Is anybody here?
[2012-12-11 08:02:42 -0500] aruntomar: mailo_: hi.
[2012-12-11 09:29:29 -0500] chef_00: Hi , I have a node to which I added few role (via Hosted Opscode Manager web ui) and ran "sudo chef-client" on the node (while I am SSHed into it), Is there a way to undo last role? or revert the state of machine to its previous state? (I am a bit newbie)
[2012-12-11 09:38:08 -0500] aruntomar: chef_00: if you
[2012-12-11 09:38:19 -0500] aruntomar: chef_00: if u've a role to revert back, then yes
[2012-12-11 09:38:54 -0500] aruntomar: chef_00: otherwise you'll have to write the role or recipes which basically converges your system to previous state
[2012-12-11 09:41:21 -0500] chef_00: aruntomar: Ah, so as best practice every chef recipie should have a roll-back recipie
[2012-12-11 09:41:29 -0500] chef_00: ?
[2012-12-11 09:42:04 -0500] aruntomar: chef_00: depends you ur requirement. there are better ways to do it. if you are on a vm, you could take a snapshot of the system.
[2012-12-11 09:42:33 -0500] specialsauce: this stuff gets complicated
[2012-12-11 09:42:35 -0500] aruntomar: chef_00: if you want to do everything via chef, then yes, you''l have to have a roll back recipe
[2012-12-11 09:44:04 -0500] Squarism: what are the alternatives to chef (ie.. say you dont wanna rely on ruby)
[2012-12-11 09:47:02 -0500] chef_00:  Another question, I created a node with name X (knife bootstrap) and deleted the node (via Opscode Hosted's UI) now I tried created another node with same name X, it throws exception (There may already be a client named "X")
[2012-12-11 09:47:03 -0500] aruntomar: Squarism: 2 out of top 3 config mgmt & system integration platform are based on ruby :)
[2012-12-11 09:47:39 -0500] chef_00: aruntomar: 2?  one is chef , another?
[2012-12-11 09:47:49 -0500] aruntomar: chef_00: while deleting u've to delete 2 things, knife node delete < node name>  and then knife client delete <node name>
[2012-12-11 09:47:59 -0500] aruntomar: chef_00: puppet
[2012-12-11 09:48:30 -0500] chef_00: aruntomar: I was underthe impression puppet was python
[2012-12-11 09:50:17 -0500] Squarism: aruntomar, what is the last one?
[2012-12-11 09:52:50 -0500] aruntomar: Squarism: don't know for sure, but i guess, it's cfengine
[2012-12-11 10:08:39 -0500] BryanWB_: Squarism:  u can't fight Ruby, i tried and lott
[2012-12-11 10:08:44 -0500] BryanWB_: s/lott/lost/
[2012-12-11 10:09:04 -0500] Squarism: BryanWB_, i fought PHP... now its dying finally
[2012-12-11 10:09:19 -0500] BryanWB_: well, i guess u can hope to outlive Ruby ;)
[2012-12-11 10:09:21 -0500] alex88: someone ever tried to deploy openstack with chef?
[2012-12-11 10:09:34 -0500] Squarism: and in my POV, ruby is the new PHP
[2012-12-11 10:09:43 -0500] BryanWB_: haha, i think node.js is the new php
[2012-12-11 10:10:12 -0500] Squarism: Yeah, node.js wants to be too =D
[2012-12-11 10:21:49 -0500] mattt: alex88: i haven't personally, but there are a lot of cookbooks to do this
[2012-12-11 10:25:24 -0500] alex88: mattt, thanks, let me search :)
[2012-12-11 10:25:34 -0500] flaccid: checkout devstack alex88
[2012-12-11 10:26:06 -0500] mattt: yeah, devstack is a great example
[2012-12-11 10:26:50 -0500] alex88: yeah was going, just to test latest release of openstack, since I'm already running openstack cloud in production, just not managed by chef
[2012-12-11 10:35:29 -0500] mattt: alex88: i've seen people asking about devstack in #rackspace, if you have any questions pop in and feel free to ask
[2012-12-11 10:36:51 -0500] alex88: mattt, sure, thanks for the tip
[2012-12-11 10:37:16 -0500] mattt: np
[2012-12-11 10:41:08 -0500] aruntomar: alex88: check this out  https://github.com/mattray/openstack-chef-repo
[2012-12-11 10:45:09 -0500] alex88: aruntomar, thanks
[2012-12-11 10:45:12 -0500] alex88: I'll check that out
[2012-12-11 11:24:28 -0500] _JamieD_: hi all, I'm having an issue where my call to template is not creating the file it should be and I can't figure out why
[2012-12-11 11:25:28 -0500] _JamieD_: this is the part of my recipe https://gist.github.com/4257894
[2012-12-11 11:25:52 -0500] _JamieD_: all of the logging is outputting what I expect it to but the files are not created
[2012-12-11 11:26:21 -0500] _JamieD_: it then blows up later on in the run when nginx restarts and checks for the certificate files
[2012-12-11 11:27:47 -0500] aruntomar: _JamieD_: run the chef client in debug mode "chef-client -l debug" and look for errors . if you can't figure out, paste it to gist and provide the link.
[2012-12-11 11:36:52 -0500] _JamieD_: aruntomar: still not clearer, I've updates with the log output https://gist.github.com/4257894
[2012-12-11 11:37:46 -0500] _JamieD_: I've changed some of the output to remove sensitive info
[2012-12-11 11:51:41 -0500] _JamieD_: ok, I've deleted the certificates directory and it's not actually creating the directory, however the template calls are not complaining about the certificated directory being missing
[2012-12-11 11:52:10 -0500] aruntomar: _JamieD_: i believe that certificate is code is in the recipe called name.rb, right
[2012-12-11 11:52:58 -0500] _JamieD_: this is odd as when I originally ran chef I forgot to create the directory and it complained. It's as if chef thinks the directory and files exist so it doesn't need to create them
[2012-12-11 11:53:16 -0500] _JamieD_: aruntomar: sorry, I'm not sure what you mean by that?
[2012-12-11 11:53:51 -0500] aruntomar: _JamieD_: i was looking at the run list from the debug logs that you sent
[2012-12-11 11:53:58 -0500] _JamieD_: the certificate code is from recipes/default.rb
[2012-12-11 11:54:37 -0500] aruntomar: _JamieD_: what's the name of the recipe
[2012-12-11 11:54:37 -0500] _JamieD_: ah yes it may well be name.rb. I removed the company name from the list as the recipe is the company name
[2012-12-11 11:54:59 -0500] aruntomar: _JamieD_: anyways, so it's not reaching to that recipe
[2012-12-11 11:54:59 -0500] _JamieD_: aruntomar: let me check the original output
[2012-12-11 11:55:50 -0500] _JamieD_: aruntomar: if you look further down the log it's showing the output from the log statements in the recipe. Is thins something to do with chef's 2 runs?
[2012-12-11 11:59:11 -0500] zuzur: hello there. Are there good references and/or sample workflows for managing cookbook versions, git and environments ? i chose to manage my production and test platforms from the same server using environments, and i'm failing badly.
[2012-12-11 12:00:47 -0500] zuzur: constantly cherry-picking between branches, pushing untested commits in production, not properly handling frozen versions, etc etc ...
[2012-12-11 12:00:59 -0500] zuzur: and dependency nightmare ...
[2012-12-11 12:05:25 -0500] arsduo: hi all, i'm having a weird problem using knife to create new ec2 nodes
[2012-12-11 12:05:54 -0500] arsduo: everything else works with knife, but knife ec2 server create fails with the message "ERROR: ArgumentError: invalid byte sequence in US-ASCII"
[2012-12-11 12:06:14 -0500] arsduo: this happens after the server is created (e.g. after "Waiting for sshd...done")
[2012-12-11 12:07:35 -0500] arsduo: the error seems to be masking the fact that knife_ssh is throwing a Net::SSH::AuthenticationFailed exception and falling through to password auth (bootstrap.rb:169)
[2012-12-11 12:07:38 -0500] arsduo: which it shouldn't be
[2012-12-11 12:08:02 -0500] arsduo: so i'm thinking it might be a problem with my keys and other auth setup, but it looks right, and every other knife command works
[2012-12-11 12:08:32 -0500] arsduo: has anyone else seen anything like this?  any ideas where to start?  i'm happy to dig through the chef code, but i'm not sure where to identify what's being executed and what's failing
[2012-12-11 12:10:48 -0500] aruntomar: _JamieD_: ok, so i dug deeply, the directory resource is not executing, and it should complain or create it. then after that only one template seems to execute
[2012-12-11 12:12:37 -0500] _JamieD_: aruntomar: it's like chef has cached that it's created this stuff on a previous run (which is has but incorrectly). Now the the directory has been deleted it doesn't think it needs to create it
[2012-12-11 12:13:14 -0500] _JamieD_: aruntomar: is there a cache that I can clear somewhere that will solve it?
[2012-12-11 12:18:21 -0500] emanuelez: hello all! I setup a chef server and an apache proxy in front of it in order to use SSL connections. unfortunately I'm not able to get clients to connect to the server due to a timeout.
[2012-12-11 12:18:45 -0500] emanuelez: my knife.rb states: chef_server_url          'https://chef.myserverhere.com'
[2012-12-11 12:18:58 -0500] aruntomar: _JamieD_: comment the if block and see if that works. and best write tests with chefspec .
[2012-12-11 12:19:24 -0500] emanuelez: any hint? using knife -VV only shows me that it's a timeout error. i can reach both ports 443 and 444 with my browser so that should not be the problem
[2012-12-11 12:20:13 -0500] _JamieD_: aruntomar: is chefspec new? I've not seen that before
[2012-12-11 12:20:18 -0500] aruntomar: emanuelez: knife connects to port 4000, the chef api server and not 80 or 443
[2012-12-11 12:20:57 -0500] aruntomar: _JamieD_: there are couple of tdd things, cucumber-chef, minitest, and rspec for chef (chefspec)
[2012-12-11 12:21:09 -0500] emanuelez: aruntomar: even if i specify otherwise in knife.rb? like https://chef.myserver.com:443 ? that did not work either
[2012-12-11 12:21:52 -0500] emanuelez: so i guess i'll have to open port 4000 on the chef server. but i don't like it's not SSL encrypted. any security issues here?
[2012-12-11 12:22:10 -0500] aruntomar: _JamieD_:    https://github.com/acrmp/chefspec
[2012-12-11 12:22:14 -0500] _JamieD_: aruntomar: getting the same output with the if commented
[2012-12-11 12:23:01 -0500] aruntomar: _JamieD_: it's weird :( . write tests to find out what the script should be doing and where it's failing.
[2012-12-11 12:23:36 -0500] aruntomar: emanuelez: all chef api communication use rsa key pairs
[2012-12-11 12:23:40 -0500] _JamieD_: aruntomar: thanks, I'll do that and hopefully it will help find the issue.
[2012-12-11 12:24:38 -0500] aruntomar: _JamieD_: ya, try that out. my other strategy is "divide and rule", test different part of your scripts separately and then integrate them.
[2012-12-11 12:25:55 -0500] aruntomar: emanuelez: so as it's all encrypted, u shouldn't worry
[2012-12-11 12:26:57 -0500] emanuelez: aruntomar: ok thanks. after the change i got another timeout. i better investigate some more
[2012-12-11 12:35:17 -0500] emanuelez: gah! i found out that chef does not use the proxy set in the env variables. they must be set in the configuration file. that's annoying :(
[2012-12-11 12:46:18 -0500] zuzur: emanuelez : http_proxy = ENV['HTTP_PROXY'] || 'http://mydefaultproxy:3128'
[2012-12-11 12:47:08 -0500] emanuelez: zuzur: nice
[2012-12-11 12:48:54 -0500] zuzur: emanuelez: full blown ruby, so if you have a different syntax in your env. variables, you can always parse the URL and setup you config appropriately
[2012-12-11 13:06:28 -0500] m4rcu5: on a side note, is anyone joining fosdem 2013?
[2012-12-11 13:10:31 -0500] BryanWB_: i hope to be there!
[2012-12-11 13:15:35 -0500] m4rcu5: BryanWB_: where are you coming from?
[2012-12-11 13:15:53 -0500] BryanWB_: m4rcu5: Roma!
[2012-12-11 13:17:51 -0500] m4rcu5: BryanWB_: thats a long way to get to Brussel :P
[2012-12-11 13:17:58 -0500] BryanWB_: 2 hr flight ;)
[2012-12-11 13:18:06 -0500] BryanWB_: u can probably walk there ;p
[2012-12-11 13:18:37 -0500] m4rcu5: BryanWB_: lol, that would take me days! im in the netherlands not belgium
[2012-12-11 13:18:57 -0500] BryanWB_: i know but that's pretty close :)
[2012-12-11 13:21:18 -0500] m4rcu5: BryanWB_: don't you the foodfight show also?
[2012-12-11 13:21:26 -0500] BryanWB_: m4rcu5: i do
[2012-12-11 13:23:54 -0500] m4rcu5: any plans on a fosdem special? ;)
[2012-12-11 13:28:44 -0500] zts: I'm tempted to do fosdem, but not sure if I can make it work
[2012-12-11 13:28:59 -0500] zts: also want to do Monitorama and ChefConf next year, which is going to be spendy
[2012-12-11 13:29:34 -0500] emanuelez: is there an easy way to install a cookbook that is on github but ont in the official opscode repo?
[2012-12-11 13:29:38 -0500] BryanWB_: m4rcu5: that's a great idea, will think about it
[2012-12-11 13:30:03 -0500] m4rcu5: im thinking about fosdem as its around the corner for us. chefconf is us based iirc?
[2012-12-11 13:30:18 -0500] zts: sadly so
[2012-12-11 13:30:29 -0500] BryanWB_: y
[2012-12-11 13:32:49 -0500] m4rcu5: im not gong to make it to the usa :(
[2012-12-11 13:36:04 -0500] zts: hm, still a few more days left to submit talks for fosdem cfg mgmt devroom
[2012-12-11 13:36:43 -0500] zts: perhaps I should do that then
[2012-12-11 13:38:11 -0500] m4rcu5: zts: any preview om the talks title?
[2012-12-11 13:38:21 -0500] xerxas: Hi all !
[2012-12-11 13:39:04 -0500] m4rcu5: ohai xerxas
[2012-12-11 13:39:22 -0500] xerxas: I've installed a chef-server on ec2, while uploading cookbooks, I have a connection refused, I tracked it, and it's because at some point, knife cookbook upload wants tu upload de my private ec2 address, though my knife.rb contains ec2-XXX.amazonaws.com
[2012-12-11 13:39:40 -0500] xerxas: is my chef-server badly configured ? where does it says knife to upload to its private ip address ?
[2012-12-11 13:40:00 -0500] zts: m4rcu5: apparently submissions go to this list, so there's a few to see - https://lists.fosdem.org/pipermail/config-mgmt-devroom/
[2012-12-11 13:40:07 -0500] zts: fewer than I would have imagined though
[2012-12-11 13:41:26 -0500] m4rcu5: zts: yep i would have expected more
[2012-12-11 13:41:39 -0500] zts: m4rcu5: guess we should both submit something then! :)
[2012-12-11 13:41:43 -0500] xerxas: fosdem wasn't a great place for configuration management last year
[2012-12-11 13:42:14 -0500] m4rcu5: xerxas: sad to hear that
[2012-12-11 13:43:10 -0500] xerxas: m4rcu5: my impression (it's only mine, and it's hard) is fosdem is a developper conference, if you contribute to postgresql , you would be happy to meet postgresql developpers from all around europe
[2012-12-11 13:43:22 -0500] xerxas: if you're a postgresql user, you won't learn much at fosdem
[2012-12-11 13:43:39 -0500] xerxas: fosdem speakers are europeans nerds, that doesn't know how to do a presentation ;)
[2012-12-11 13:44:04 -0500] xerxas: I say european, because americans learn since early school to do presentations
[2012-12-11 13:46:29 -0500] m4rcu5: xerxas: and your origins are?
[2012-12-11 13:47:06 -0500] m4rcu5: as my school experience might be slightly different from the european style you are describing
[2012-12-11 13:47:09 -0500] xerxas: m4rcu5: I think you could guess, as I'm complaining ;) (I'm french)
[2012-12-11 13:47:26 -0500] m4rcu5: ;)
[2012-12-11 13:47:49 -0500] xerxas: m4rcu5: you haven't do presentation at your school ?
[2012-12-11 13:48:24 -0500] auduny: *cough*
[2012-12-11 13:48:34 -0500] xerxas: auduny: ;)
[2012-12-11 13:49:52 -0500] xerxas: I really life fosdem, every years, because I meet intersting people, and some other I haven't seen for a long time, but all in all it's a developper conference, and what I saw last year , is , slides with a mail with a git commit and patch , that went into postgresql that does extremly interesting stuff I don't understand at all ;)
[2012-12-11 13:49:54 -0500] m4rcu5: i cant get my mouth to open on stage so i'll stay on the listeners side of things :P
[2012-12-11 13:50:21 -0500] xerxas: m4rcu5: just pretend there's no-one in front of the stage ;)
[2012-12-11 13:51:38 -0500] Mithrandir: i like fosdem
[2012-12-11 13:52:05 -0500] xerxas: Mithrandir: going to it this year ?
[2012-12-11 13:52:12 -0500] Mithrandir: hopefully
[2012-12-11 13:56:32 -0500] helllen: helllo
[2012-12-11 13:57:44 -0500] helllen: I have many chef-clients connected to my chef-server
[2012-12-11 13:58:05 -0500] helllen: sometimes any chef-client loose connection with the manager
[2012-12-11 13:58:09 -0500] helllen: could I exectute an action at this case ?
[2012-12-11 14:03:20 -0500] xerxas: helllen: not sure what you are speaking about
[2012-12-11 14:03:25 -0500] xerxas: but you have chef-handlers
[2012-12-11 14:03:43 -0500] xerxas: when the client finish to run (successfully or failed) it launches the handlers
[2012-12-11 14:13:34 -0500] helllen: I will read about that
[2012-12-11 14:13:38 -0500] helllen: but I wanted
[2012-12-11 14:14:09 -0500] helllen: for example if the chef-client cannot concact chef-server stop some services not necesaries for this machine
[2012-12-11 14:18:59 -0500] seph: I'm looking for advice about the opscode chef cookbook -- I'm using it to both delete initial install users, and create new actual users. But, there's a bootstrapping problem -- trying to delete the initial user causes a fatal error. Is there a way to catch that error?
[2012-12-11 14:23:19 -0500] auduny: What does people here deploy code with? Capistrano? Chef iteself?
[2012-12-11 14:23:34 -0500] gchristensen: seph: the way I go about it (may not be the best) is https://gist.github.com/4258915. this means the user is removed on the second run.
[2012-12-11 14:24:34 -0500] auduny: I'm especially interesseted in how you store production password for databases etc for deployemnt. Chef has encrypted data bags. But deploying code with chef doesn't seem that good. Unless maybe we seperate deployment to a very bare bone chef-solo or something.
[2012-12-11 14:24:46 -0500] helllen: <xerxas>, there is no other procedure to do what I explained before ?
[2012-12-11 14:24:54 -0500] gchristensen: auduny: my deployments have to go out to the servers with precise timing, so we use capistrano to orchestrate it
[2012-12-11 14:24:59 -0500] helllen: for example client1 connects to chef-server and it configure services A, B and C
[2012-12-11 14:25:10 -0500] seph: gchristensen: That's about what I did before (https://github.com/actblue/cookbooks-actblue/blob/master/users/recipes/default.rb) But I don't see how to do that in the opscode users cookbook without fork+patch
[2012-12-11 14:25:15 -0500] gchristensen: auduny: the passwords for the deployments are put onto the servers with Chef, it writes to a shared configuration file.
[2012-12-11 14:26:26 -0500] gchristensen: seph: I can't say specifically for their cookbook... I don' have any qualms with forking and patching their cookbooks though.
[2012-12-11 14:26:29 -0500] helllen: the service C is not important and when the chef client cannot conect to chef-server (internet connection problem) this service should be stopped
[2012-12-11 14:26:35 -0500] helllen: who could I do that ?
[2012-12-11 14:26:44 -0500] auduny: gchristensen: So chef stores your password on your severes in certain intervals and capistrano just deploys code and depends on the files from chef been in place?
[2012-12-11 14:26:58 -0500] auduny: s/been/being/
[2012-12-11 14:27:07 -0500] auduny: Or does capistrano trigger chef-client?
[2012-12-11 14:27:34 -0500] gchristensen: auduny: chef drops the files in the bootstrap, by the time I'm deploying it has already been bootstrapped, so those files are there
[2012-12-11 14:27:48 -0500] gchristensen: so... yeah I suppose so :) do your passwords change frequently?
[2012-12-11 14:28:11 -0500] seph: gchristensen: Yeah, I just didn't want to deal. Ah well, http://tickets.opscode.com/browse/COOK-1135 exists.
[2012-12-11 14:28:31 -0500] auduny: gchristensen: Not really, but code depening on new db's with new passwords happends frequently
[2012-12-11 14:29:04 -0500] gchristensen: seph: I don't know if you know the company I work for, but I definitely know yours - I'm from NationalField.
[2012-12-11 14:29:36 -0500] gchristensen: auduny: hrmm.. we have similar issues, and we have a second application that runs on the servers to sync those files from a central source (we call it MissionControl)
[2012-12-11 14:29:55 -0500] auduny: gchristensen: And passwords in (encrypted) databags in chef?
[2012-12-11 14:29:56 -0500] seph: gchristensen: I'm not familiar with NationalField, but I'm always glad to see people who know ActBlue. (Though I no longer work there)
[2012-12-11 14:30:02 -0500] gchristensen: gotcha
[2012-12-11 14:30:23 -0500] auduny: gchristensen: missioncontrol is a app made inhouse?
[2012-12-11 14:31:02 -0500] gchristensen: yeah, it manages our client database information, and when a new database is added or changed, it notifies each server to update its information
[2012-12-11 14:31:35 -0500] gchristensen: so chef drops files on the server to know how to communicate with missioncontrol, and then MC does the rest
[2012-12-11 14:32:53 -0500] gchristensen: auduny: we put the client DB info in chef for a bit but the rolling deployments was a bit of a PITA and it made it hard for our sales team to add new clients. that's why we ended up creating this other, very small application.
[2012-12-11 14:33:20 -0500] zts: helllen: the short answer is no, there isn't a simple way to do what you'd like - but you could write a bunch of ruby to do it using an exception handler
[2012-12-11 14:33:40 -0500] zts: helllen: I am curious why you would want to shut down the service if you can't connect to the Chef server
[2012-12-11 14:36:36 -0500] _JamieD_: I'm trying to get chefspec working and have hit the problem of Chef::Exceptions::InvalidDataBagPath: Data bag path '/var/chef/data_bags' is invalid. I've suggestion of something like this https://github.com/jimhopp/chefspec_exploration/blob/master/cookbooks/mytestcookbook/spec/stub_out_databag_spec.rb but I still get the same error
[2012-12-11 14:56:30 -0500] masterkorp: Hello chefs
[2012-12-11 14:58:01 -0500] specialsauce: ohai!
[2012-12-11 14:58:18 -0500] masterkorp: how is it hanging ?
[2012-12-11 15:17:14 -0500] auduny: Anyone using chef itself for deployments? Instead of say capistrano?
[2012-12-11 15:17:21 -0500] auduny: deployment of code that is
[2012-12-11 15:17:39 -0500] masterkorp: its hard to do it with chef
[2012-12-11 15:17:45 -0500] auduny: Preferably without needing a full chef-client run that takes about 20 seconds on my machines.
[2012-12-11 15:17:58 -0500] masterkorp: you need some kind of tight tight schedule
[2012-12-11 15:18:08 -0500] masterkorp: (when downtime is required)
[2012-12-11 15:18:22 -0500] auduny: And is there anything better than capistrano for this (especially since my code is php and varnsh vlc, not ruby on rails)
[2012-12-11 15:18:32 -0500] sfb: auduny: I like Fabric.
[2012-12-11 15:18:35 -0500] rgsteele: auduny: Yes.  Chef + Vagrant/VirtualBox and Chef + FAI
[2012-12-11 15:18:45 -0500] sfb: auduny: Func kind of fits the same realm.
[2012-12-11 15:19:06 -0500] auduny: I need something that does ssh in paralell as capistrano.
[2012-12-11 15:19:08 -0500] sfb: auduny: I also use RunDeck quite a bit but then I'm really just executing shell scripts that I wrote to do these kinds of things.
[2012-12-11 15:19:15 -0500] masterkorp: auduny: i use deb packages
[2012-12-11 15:19:21 -0500] rgsteele: auduny: Also, Chef + Jenkins
[2012-12-11 15:19:32 -0500] sfb: A million ways to skin a cat.
[2012-12-11 15:19:47 -0500] leifmadsen: I've built rpm's for my software deployments, but the management of the sql tables and such for version and upgrades is what always gets me
[2012-12-11 15:19:48 -0500] rgsteele: Yup
[2012-12-11 15:19:55 -0500] sfb: rgsteele: You mean like have Chef trigger a Jenkins job via the REST API?
[2012-12-11 15:20:01 -0500] auduny: We tried jenkins, but ssh-keys and checking out stuff from svn from java-console-stash was painfulll
[2012-12-11 15:20:29 -0500] auduny: capistrano can look up servers to deploy to through chef, that's a pluss.
[2012-12-11 15:20:44 -0500] auduny: But its a pain to dumbify it enough to deploy other stuff than ruby
[2012-12-11 15:21:02 -0500] sfb: auduny: http://dev2ops.org/2012/05/using-rundeck-and-chef-to-build-devops-toolchains-at-chefcon/
[2012-12-11 15:23:42 -0500] auduny: http://pychef.readthedocs.org/en/latest/fabric.html
[2012-12-11 15:23:45 -0500] auduny: This looks a bit cute.
[2012-12-11 15:24:13 -0500] masterkorp: I wonder how can i provision my jeep gps maps with chef
[2012-12-11 15:24:20 -0500] sfb: http://docs.fabfile.org/en/1.5/
[2012-12-11 15:24:24 -0500] sfb: That's Fabric.
[2012-12-11 15:24:28 -0500] masterkorp: i need a way to auto update them from openstreep map
[2012-12-11 15:24:50 -0500] sfb: masterkorp: Configure an apt repo? (;
[2012-12-11 15:25:09 -0500] masterkorp: sfb: of openstreep map db snapshots ?
[2012-12-11 15:25:19 -0500] sfb: I don't know, I'm just being a wise guy.
[2012-12-11 15:25:34 -0500] sfb: I'm still trying to piece together how I want to use Chef here.
[2012-12-11 15:25:50 -0500] masterkorp: mostly for fun
[2012-12-11 15:26:11 -0500] masterkorp: having chef-client updating the OS and ssh keys would be nice
[2012-12-11 15:26:18 -0500] masterkorp: and the vpn too
[2012-12-11 15:26:43 -0500] masterkorp: anyways just day dreaming
[2012-12-11 15:27:52 -0500] gchristensen: chef will one day be sentient, and write its own server management tool
[2012-12-11 15:28:25 -0500] masterkorp: heh
[2012-12-11 15:32:03 -0500] madzim: I'm trying to install Chef-Server on RBEL 6. I'm currently stuck on an error related to GECODE:
[2012-12-11 15:32:21 -0500] madzim: "Gecode > 3.5 must be installed"
[2012-12-11 15:32:44 -0500] madzim: But I see that Gecode *appears* to have been installed earlier.
[2012-12-11 15:32:57 -0500] madzim: Oh, I should mentioned, I'm using the chef-solo bootstrap method.
[2012-12-11 15:34:16 -0500] madzim: I vaguely recall reading that GECODE may be installed in a location that is not already included in the dynamic library loading list. But I don't know where GECODE was installed to add it to the list.
[2012-12-11 15:34:28 -0500] madzim: Any advice on where to look next?
[2012-12-11 15:35:40 -0500] madzim: Sorry, RBEL 6 should have been RHEL 6.
[2012-12-11 15:45:28 -0500] djwonk: Is it fair to say that http://docs.opscode.com/ considered more up to date than http://wiki.opscode.com ?
[2012-12-11 15:45:28 -0500] aruntomar: madzim:  on rhel6 based systems, i normally use this. it's pretty straight forward. http://blog.frameos.org/2011/05/19/installing-chef-server-0-10-in-rhel-6-scientificlinux-6/
[2012-12-11 15:46:38 -0500] aruntomar: djwonk: i would say docs.opscode.com has been organized well and concepts explained very clearly and concisely.
[2012-12-11 15:48:08 -0500] pwelch: ohai chefs
[2012-12-11 15:48:14 -0500] djwonk: @aruntomar thanks. is the wiki going away? is it considered to be out of date?
[2012-12-11 15:48:15 -0500] djwonk: I'm trying to wade through the information and figure out where to start making cookbooks.
[2012-12-11 15:49:00 -0500] aruntomar: djwonk: docs will ultimately replace the wiki as the official doc from opscode, and wiki will be maintained by the community.
[2012-12-11 15:49:04 -0500] pwelch: does anyone have experience with chef spec and mocking something needed in the ohai cookbook: https://github.com/opscode-cookbooks/ohai/blob/master/recipes/default.rb#L49
[2012-12-11 15:50:08 -0500] pwelch: the cookbook I am trying to write a spec for requires nginx::source which requires the ohai cookbook
[2012-12-11 15:50:10 -0500] madzim: @aruntomar: I have that link up. I suppose I'll try that next.
[2012-12-11 15:50:12 -0500] madzim: thx
[2012-12-11 15:54:40 -0500] mattray: anyone seen techniques for checking with the Chef server for timestamps on when a cookbook was last updated?
[2012-12-11 15:55:18 -0500] mattray: knife cookbook show FOO VERSION doesn't have it
[2012-12-11 15:56:03 -0500] masterkorp: i think the only way is the git repo atm :(
[2012-12-11 15:57:12 -0500] mattray: there are timestamps in the URLs for S3, but that seems pretty hacky
[2012-12-11 15:57:24 -0500] mattray: and I have no idea what's on the open source server
[2012-12-11 15:57:47 -0500] mattray: re-uploading everything every time is inefficient
[2012-12-11 15:58:43 -0500] masterkorp: how do you upload your cookbooks ?
[2012-12-11 15:58:58 -0500] masterkorp: i use capistrano to deploy to the server
[2012-12-11 15:59:05 -0500] masterkorp: it reads for the git log
[2012-12-11 16:01:29 -0500] gchristensen: is there an existing cookbook to install the ec2-api-tools? it seems like a common thing people might do.
[2012-12-11 16:02:05 -0500] mattray: I'm trying to make spiceweasel more efficient on refreshing infrastructure, but I think I'll put it in my backlog for awhile.
[2012-12-11 16:05:42 -0500] mattupstate: can you use the template provider with a file on the node's filesystem and not in a cookbook?
[2012-12-11 16:05:54 -0500] _JamieD_: *sigh* I have no idea what's going on, a recipe that was working just fine is now refusing to update any files built using templates
[2012-12-11 16:09:50 -0500] djwonk: For a Mountain Lion workstation, the omnibus installer is recommended? Or do people use homebrew?
[2012-12-11 16:18:56 -0500] ssd7: Ohai Chefs!
[2012-12-11 16:20:21 -0500] aruntomar: ssd7: ohai
[2012-12-11 16:22:48 -0500] aruntomar: berkshelf or librarian chef, which one is preferred?
[2012-12-11 16:23:28 -0500] ssd7: aruntomar: A good number of Chef users are in each camp.  I would try both and see what works best for you.
[2012-12-11 16:25:00 -0500] jtimberman: djwonk: all the *documentation* from the wiki is being moved to docs.opscode.com, but not all the content is migrated yet. if you notice gaps, please report issues on the docs repo: https://github.com/opscode/chef-docs/issues
[2012-12-11 16:25:14 -0500] jtimberman: gchristensen: should just be a package right?
[2012-12-11 16:26:09 -0500] jtimberman: djwonk: i'm not aware of a chef package in homebrew. i use omnibus install on my OS X workstations for the "i'm managing this system with chef" level. i have a rbenv Ruby environment setup with Chef installed for development and project purposes
[2012-12-11 16:34:18 -0500] djwonk: @jtimberman thanks
[2012-12-11 16:34:27 -0500] aruntomar: i love the way apt-cacher works for ubuntu in case you need to download and install lots & lots of packages. it only downloads, what's needed. but unfortunately it's a pain to use with centos/redhat based systems. what do you guys prefer to use with large centos/redhat nodes?
[2012-12-11 16:34:43 -0500] aruntomar: ssd7: ok, i'll try both.
[2012-12-11 16:38:00 -0500] iyp: Can someone explain load_current_resource to me, or point me towards some reading?
[2012-12-11 16:39:40 -0500] pwelch: i would be interested in learning about load_current_resource as well
[2012-12-11 16:41:16 -0500] ssd7: The goal of load_current_resource is to get the state of the resource being managed on disk.  So say, for for a file, that is where you might lookup the mode, get the checksum of the current content, etc.  And then you place all those facts in @current_resource so that you can use them to make decisions later.
[2012-12-11 16:41:20 -0500] masterkorp: well i i made my own
[2012-12-11 16:42:02 -0500] masterkorp: eg: to see if a resource changed and notify other services only if it was changed
[2012-12-11 16:42:21 -0500] iyp: ssd7: gotchya, thanks for the context
[2012-12-11 16:42:44 -0500] cwj: any time one writes a LWRP its a good idea to provide a load_current_resource method for any resource the LWRP implements
[2012-12-11 16:43:18 -0500] iyp: load_current_resource gets new_resource as a local variable to make comparisons against?
[2012-12-11 16:43:32 -0500] jtimberman: mattupstate: there's a "local" paramete rfor the template resource: http://docs.opscode.com/resource_template.html
[2012-12-11 16:43:48 -0500] jtimberman: ssd7: s/on disk/on the system/ ;)
[2012-12-11 16:44:14 -0500] masterkorp: Is it too bad if i trowned the LWRP abstrated way of doing them and just have libraries that are Chef::Provider and Chef::Resource childs ?
[2012-12-11 16:44:29 -0500] jtimberman: inspecting the filesystem is commonly done, but state can be derived through an API, such as a DNS record in DNSimple, or similar.
[2012-12-11 16:44:45 -0500] ssd7: jtimberman: Good point :)
[2012-12-11 16:44:50 -0500] jtimberman: masterkorp: nothing wrong with that at all if it gets you to your goal )
[2012-12-11 16:45:07 -0500] masterkorp: yeah but the good conduct police might not like :p
[2012-12-11 16:45:24 -0500] masterkorp: btw are subdirs in libraries read too ?
[2012-12-11 16:45:28 -0500] cwj: iyp: generally you would do current_resource = load_current_resource and then compare aspects of current_resource and new_resource inside the actions of a provider
[2012-12-11 16:45:39 -0500] leifmadsen: so I have a "best practices" question. Been using Chef for about 9 months now, and just changed jobs, so I'm rebuilding this systems Chef stuff. My question: is it preferable to have multiple cookbooks for each of the server types I'm going to install (then using include_recipe etc to get the nesting right), or perhaps create a single cookbook with multiple recipes for the server types. I know I can use roles as well, but I w
[2012-12-11 16:45:39 -0500] leifmadsen: ant to try and use include_recipe to setup the inheritance
[2012-12-11 16:45:44 -0500] cwj: iyp: because the provider action gets new_resource
[2012-12-11 16:46:29 -0500] iyp: cwj: Makes sense, thanks.
[2012-12-11 16:47:37 -0500] iyp: Is there a way to pipe a rendered template to a program with stdin instead of making it a file?
[2012-12-11 16:49:16 -0500] leifmadsen: I think I'm going to lean towards cookbook for each server type, then including recipes where needed. I'm afraid if I create a 'servers' cookbook and a recipe for each type, the recipe could get huge at some point rather than breaking down to smaller pieces where warranted
[2012-12-11 16:49:46 -0500] cwj: leifmadsen: thats the approach i would try
[2012-12-11 16:50:07 -0500] programmerq: so, we want to install zabbix agent with chef. The zabbix cookbook can do this http://community.opscode.com/cookbooks/zabbix, but it pulls in a bunch of cookbook dependencies like apache2 and ufw that we don't want to use since we aren't setting up the server on our clients. Does anyone know of another cookbook that's specifically for doing the zabbix agent?
[2012-12-11 16:51:16 -0500] cwj: iyp: you could probably work it out by using some pure ruby in the recipe which would generate the template contents and then pass them into the app's stdin via an execute resource
[2012-12-11 16:51:25 -0500] leifmadsen: cwj: I want to try and move away from roles where possible, just because it seems silly to build dependencies manually when you can just put them in the cookbook
[2012-12-11 16:51:54 -0500] cwj: leifmadsen: a number of people are advocating the use of wrapper cookbooks (or "application" cookbooks) to avoid roles
[2012-12-11 16:52:06 -0500] cwj: and ive used that approach a little bit, i think it has some mertis
[2012-12-11 16:52:11 -0500] cwj: merits even
[2012-12-11 16:52:19 -0500] iyp: cwj: Good idea. I'm probably adding needless complexity with the template just to keep things separate.
[2012-12-11 16:52:23 -0500] leifmadsen: cwj: ya that's what gave me this idea in the first place, as I had seen this type of discussion previously
[2012-12-11 16:52:24 -0500] cwj: but everyone should do what works for their organization
[2012-12-11 16:52:30 -0500] leifmadsen: cwj: +1
[2012-12-11 16:53:40 -0500] leifmadsen: cwj: just I'm essentially starting from scratch again, so that's why I'm thinking of attempting this approach. It has already worked well for an asterisk cookbook I just built for our organization. Created a repos cookbook with recipes for the internal repos and then include_recipe yum::yum, followed by yum_repository commands in the recipes
[2012-12-11 16:53:50 -0500] leifmadsen: then include_recipe repos::atrpms (for example)
[2012-12-11 16:56:02 -0500] iyp: Right, so how can I control stdin with the execute resource?
[2012-12-11 16:59:10 -0500] cwj: iyp: use variable interpolation
[2012-12-11 16:59:37 -0500] cwj: havent tried it myself but it seems like it sgould work
[2012-12-11 17:00:12 -0500] iyp: cwj: like "echo #{foo} | cmd"?
[2012-12-11 17:01:31 -0500] iyp: or more specifically "vmadm create <<EOF #{foo} EOF"
[2012-12-11 17:01:52 -0500] cwj: the latter is more like what i had in mind, but yeah
[2012-12-11 17:02:23 -0500] iyp: righto, ty
[2012-12-11 17:02:49 -0500] cwj: np, hth
[2012-12-11 17:03:47 -0500] cwj: leifmadsen: rolling your own package repo and reusing the chef code to configure it on your nodes all sounds like awesome to me
[2012-12-11 17:03:54 -0500] cwj: party on
[2012-12-11 17:04:01 -0500] leifmadsen: cwj: yes sir! :)
[2012-12-11 17:04:25 -0500] leifmadsen: I've learned just enough to be dangerous I suspect
[2012-12-11 17:04:29 -0500] bhenerey: can gem_package install a gem in a particular path? I'd like to use system ruby, not rvm. path for installing bundler, for example, should be: /var/lib/gems/1.9.1/gems, but it instead is put in /opt/vagrant_ruby/lib/ruby/gems/1.8/gems
[2012-12-11 17:04:39 -0500] leifmadsen: soon I'll add crazy things like minitest::spec and/or unit tests
[2012-12-11 17:05:04 -0500] mattupstate: jtimberman: thanks for that
[2012-12-11 17:05:42 -0500] jtimberman: bhenerey: use the gem_binary parameter to the gem_package resource
[2012-12-11 17:05:57 -0500] jtimberman: gem_binary "/usr/bin/gem1.9.1"
[2012-12-11 17:08:16 -0500] itchyouch: Anyone familiar with building rpm's?  The rm irc seems to be a bit quiet
[2012-12-11 17:08:54 -0500] masterkorp: time for /dev/gym
[2012-12-11 17:09:05 -0500] bhenerey: thanks @jtimberman
[2012-12-11 17:09:23 -0500] bhenerey: that did the trick
[2012-12-11 17:15:47 -0500] cwj: itchyouch: if i were trying to build rpms i would be looking at fpm https://github.com/jordansissel/fpm
[2012-12-11 17:22:18 -0500] programmerq: so I have a coworker that seems to remember some project that can give insight into the "health" of my nodes running chef client. Some kind of accounting to see if chef-client suceeds or not basically. He can't remember the name of the project. Does anyone know of a project that could do anything like this?
[2012-12-11 17:22:51 -0500] programmerq: like I have 500 nodes, and one is failing. how on earth would I know that?
[2012-12-11 17:23:23 -0500] gchristensen: you can use chef report handlers to give you feedback on how its all going7
[2012-12-11 17:23:50 -0500] gchristensen: (maybe that'll give you a lead?)
[2012-12-11 17:25:23 -0500] martinisoft: programmerq: there was a knife plugin that did this
[2012-12-11 17:25:33 -0500] martinisoft: kife-status I think
[2012-12-11 17:25:37 -0500] martinisoft: knife*
[2012-12-11 17:26:02 -0500] martinisoft: required a bit of setup, but gives you fancy output of your chef runs
[2012-12-11 17:26:27 -0500] martinisoft: programmerq: https://github.com/jgoulah/knife-lastrun
[2012-12-11 17:26:29 -0500] martinisoft: thats it
[2012-12-11 17:26:49 -0500] martinisoft: how long each node took, any exceptions, etc
[2012-12-11 17:27:45 -0500] programmerq: we're going to look in to all of these. thanks guys!
[2012-12-11 17:27:55 -0500] cwj: report handlers can give you a lot more insight, especially if you already have or are willing to build a log aggregation system
[2012-12-11 17:28:28 -0500] jtimberman: programmerq: "grill" is a project for providing a dashboard for lots of chef nodes.
[2012-12-11 17:28:32 -0500] jtimberman: its by cycle computing.
[2012-12-11 17:30:55 -0500] programmerq: all of these things so far look very useful and interesting.
[2012-12-11 17:34:31 -0500] jkyle: jtimberman: heya, I'm looking at the official opscode nginx cookbook. It's unclear to me how the nginx site resource and site.conf.erb generates a valid site config. is there an example lurking somewhere?
[2012-12-11 17:42:04 -0500] jkyle: nevermind, looks like this conf came from somewhere else
[2012-12-11 17:56:35 -0500] cheflevelramen: Hi guys. I keep running into this error when starting up my servers:
[2012-12-11 17:56:36 -0500] cheflevelramen: FATAL: Chef::Exceptions::Package: package[kernel-devel] (build-essential::default line 48) had an error: Chef::Exceptions::Package: Yum failed - #<Process::Status: pid 1840 exit 200> - returns: ["yum-dump Locking Error! Couldn't obtain an exclusive yum lock in 10 seconds. Giving up.\n"]
[2012-12-11 17:57:46 -0500] cheflevelramen: Anyway to work around this? I noticed there is an open ticket to be able to modify the lock time, but that's not implemented yet. I'm on Amazon Linux 12.09 and I believe a process is holding onto a lock
[2012-12-11 17:58:28 -0500] cheflevelramen: If I rerun chef-client, it gets a little further with each run until it eventually works
[2012-12-11 17:59:36 -0500] troyready: cheflevelramen: Could it be the result of this: http://aws.amazon.com/amazon-linux-ami/faqs/#auto_update ?
[2012-12-11 18:00:14 -0500] oddover: Hey. Is there a cookbook out there for managing /etc/grub.conf?
[2012-12-11 18:01:08 -0500] cheflevelramen: Possibly. I see this process running:  /usr/bin/python /usr/sbin/yum-updatesd
[2012-12-11 18:01:17 -0500] cheflevelramen: If I kill it, then yum can properly get locks
[2012-12-11 18:01:47 -0500] cheflevelramen: I figure I could create a script to kill the process and start it again after the chef-run
[2012-12-11 18:01:50 -0500] cheflevelramen: seems silly though
[2012-12-11 18:01:59 -0500] wassy121: maybe that yum-updatesd is checking too often?
[2012-12-11 18:02:43 -0500] wassy121: check "run_interval" in /etc/yum/yum-updatesd.conf
[2012-12-11 18:03:24 -0500] cheflevelramen: run_interval = 3600
[2012-12-11 18:03:45 -0500] cheflevelramen: That shouldn't be too frequently I imagine.
[2012-12-11 18:03:49 -0500] wassy121: That means it should be running every hour.  Which may cause a problem once in a while, but not on every chef run :(
[2012-12-11 18:04:07 -0500] cheflevelramen: But this process has been running since 11/30 (when it was booted)
[2012-12-11 18:04:16 -0500] jfl0wers: anyone know of a good EC2 ami with Chef on CentOS 6.3?
[2012-12-11 18:04:38 -0500] wassy121: yeah, but it should only be locking yum every $run_interval seconds I thought
[2012-12-11 18:05:09 -0500] itwasntandy: jfl0wers: just pick the standard amazon ami and install chef via omnibus installer ?
[2012-12-11 18:05:19 -0500] jblaine: cheflevelramen: It's a daemon.
[2012-12-11 18:05:19 -0500] cheflevelramen: Hmm, odd. I get the lock error each time, though making it a little further along in the process
[2012-12-11 18:05:53 -0500] jfl0wers: I was hoping not to have to create a new ami, especially if one already existed
[2012-12-11 18:05:56 -0500] jblaine: cheflevelramen: Either adjust the run_interval or disable the service.
[2012-12-11 18:06:11 -0500] jfl0wers: been working on vagrant-aws
[2012-12-11 18:06:36 -0500] cheflevelramen: jblaine: Yea, figured that would be the case. Was hoping someone had solved this issue another way. Thanks for the help
[2012-12-11 18:06:37 -0500] itwasntandy: jfl0wers: sure, but just install chef at bootstrap
[2012-12-11 18:06:39 -0500] jblaine: cheflevelramen: See man yum-updatsed and man yum-updatesd.conf
[2012-12-11 18:06:52 -0500] itwasntandy: we do this using amazon userdata... seems to work well
[2012-12-11 18:07:01 -0500] jblaine: cheflevelramen: We've not hit the problem yet, but likely will.
[2012-12-11 18:07:38 -0500] jfl0wers: okay, I will look into that
[2012-12-11 18:09:42 -0500] ctracey: jfl0wers: you will definitely want to look into cloud-init
[2012-12-11 18:10:04 -0500] ctracey: though its support for rhel/centos is not as mature
[2012-12-11 18:15:33 -0500] jschneiderhan: is anyone else having trouble with the rvm cookbook and recent versions of chef?
[2012-12-11 18:15:44 -0500] jschneiderhan: perhaps because it ins't installing the rvm gem with chef_gem?
[2012-12-11 18:35:22 -0500] solarce: jfl0wers: it's super easy to just give an AMI a small shell script as user-data to install the omnibus install and then drop a client.rb file on the box
[2012-12-11 18:37:28 -0500] ctracey: solarce: we had done similarly for a long time.  i am preferring the cloud-init route now
[2012-12-11 18:40:34 -0500] gchristensen: heh. coudln't figure out why "knife node from file roles/suchnsuch.rb" wasn't doing what I expected :P
[2012-12-11 18:42:14 -0500] cheflevelramen: jblaine: So it looks like 'service yum-updatesd stop' works to stop the service, but even with the service stopped I still get that lock timeout fatal error
[2012-12-11 18:42:30 -0500] cheflevelramen: May have been a bit of a red herring
[2012-12-11 18:42:32 -0500] barnacles: Quick question, I have a cookbook that contains a default provider, and a contextParam provider. I can access the default provider from another cookbook, but not the contextParam provider. Is there an extra step I'm missing besides creating contextParam.rb in both the resources and provider folder?
[2012-12-11 18:43:16 -0500] cheflevelramen: jblaine: The error is specfically coming from the yum::epel recipe on update.
[2012-12-11 18:43:34 -0500] cheflevelramen: jblaine: testing it now with the :update removed
[2012-12-11 18:48:04 -0500] jblaine: cheflevelramen: Weird
[2012-12-11 18:51:06 -0500] cheflevelramen: jblain: Nevermind, looks like it's actually the build-esential cookbook. It installs 5 or so packages, failing on a different each time. Maybe there should be a pause between package installations. Still new to chef. How would I put a bash command like 'sleep 10' in a recipe?
[2012-12-11 18:51:51 -0500] awgross: cheflevelramen: you can put :retry and :retry_delay into package blocks
[2012-12-11 18:52:28 -0500] cheflevelramen: awgross: Nice, that looks like the correct solution. I'll modify it and try again
[2012-12-11 18:52:42 -0500] solarce: ctracey: i should probably take the time to learn cloud-init better and adapt my workflow to using it
[2012-12-11 18:57:48 -0500] ctracey: solarce: gives you a lot of flexibility. more so if you are using something like openstack - where you can inject files.
[2012-12-11 19:00:14 -0500] awgross: anyone have any thoughts on how to mock up AWS API's when using vagrant?
[2012-12-11 19:07:21 -0500] djwonk: I found a small typo on http://docs.opscode.com/install_step_installer_run.html  the directory structure for me was /opt/chef/ not /opt/opscode/
[2012-12-11 19:09:30 -0500] djwonk: Do you all recommend cloning git://github.com/opscode/chef-repo.git into ~? Not /opt?
[2012-12-11 19:13:03 -0500] ssd7: djwonk: Thanks for pointing that out, we'll get it fixed up.
[2012-12-11 19:13:18 -0500] ssd7: djwonk: I usually have my chef-repo's somewhere in !
[2012-12-11 19:13:21 -0500] ssd7: ~
[2012-12-11 19:13:45 -0500] djwonk: @ssd7: thanks. Should I have both directories? ~/.chef and ~/chef-repo/.chef ?
[2012-12-11 19:14:44 -0500] ssd7: djwonk: That depends, knife will only read from the first one it finds
[2012-12-11 19:15:07 -0500] ssd7: but some people like to layer their config by using Ruby to 'require' their other configuration file in ~
[2012-12-11 19:17:15 -0500] djwonk: ok, I'll keep following the docs to see where they recommend putting the .chef files
[2012-12-11 19:21:14 -0500] djwonk: it seems like if I'm only managing one chef-server, I can get by with just using ~? is that recommended? or better to put in ~/chef-repo/.chef? or no difference?
[2012-12-11 19:23:20 -0500] sdr_: Running chef on windows. When installing a service (let's call it "serviceA"), I need to ensure another(different) service(snmp) is shutdown which conflicts with the install of serviceA. But only if the service will be installed. I don't want snmp shutting down every time I run chef_client, only when serviceA will be installed. Can't find anything that would do this for me.
[2012-12-11 19:25:16 -0500] awgross: sdr_: have an execute block which only triggers if Service A is not installed, it will do nothing but notify a service(snmp) block to shutdown
[2012-12-11 19:25:39 -0500] awgross: sdr_: the service(snmp) block will then notify an immediate install of serviceA
[2012-12-11 19:25:54 -0500] awgross: sdr_: finally, the serviceA block will notify an immedate start of service(snmp)
[2012-12-11 19:26:40 -0500] sdr_: awgross: what about if ServiceA is installed but needs to be upgraded.
[2012-12-11 19:27:30 -0500] awgross: you can modify the only_if block
[2012-12-11 19:27:48 -0500] cheflevelramen: awgross: jblaine: Thanks for your help on the yum locking issue on Amazon linux. Adding retries and retry_delay fixed the issue. The build-essentials cookbook was trying to install packages a little too quickly, so there were locking issues. I've submitted a pull request on the cookbook, so hopefully that fixes it for others
[2012-12-11 19:29:12 -0500] jblaine: cheflevelramen: No problem - thanks for submitting a possible fix back
[2012-12-11 19:29:51 -0500] awgross: sdr_:  https://gist.github.com/4261320
[2012-12-11 19:31:34 -0500] sdr_: awgross: awesome, thanks!
[2012-12-11 19:43:54 -0500] appamatto: I'm doing a deploy from git. How do indicate that this recipe depends on git being installed?
[2012-12-11 19:44:18 -0500] appamatto: I find it strange that there isn't a dependency already because I've set git as the scm...
[2012-12-11 19:46:24 -0500] jtimberman: appamatto: package "git" ?
[2012-12-11 19:46:47 -0500] cwj: include_recipe 'git' ?
[2012-12-11 19:47:26 -0500] jtimberman: :)
[2012-12-11 19:48:45 -0500] cwj: you know, in case you are on the wrong planet and your git package is named 'git-core' or something
[2012-12-11 19:49:30 -0500] jtimberman: only on hardy and debian lenny iirc
[2012-12-11 19:53:52 -0500] cheflevelramen: I have an organizational question. Many of my AWS instances have elastic IPs, which are obviously node/role specific. Overriding the eip value in the role doesn't quite make sense, since some servers share a role by have different eips. Is it common to have 'roles' that are node specific, meaning they are only ever used on a single node?
[2012-12-11 19:55:41 -0500] awgross: cheflevelramen: not common, really an anti-pattern
[2012-12-11 19:55:58 -0500] awgross: cheflevelramen: ohai should be able to tell you your EIP
[2012-12-11 19:56:52 -0500] cheflevelramen: awgross: I'm sure it can tell me the EIP after it's been associated, but what I'm trying to do is associate the EIPs with the proper servers
[2012-12-11 19:57:06 -0500] awgross: cheflevelramen: that should probably be done during the bootstrap phase
[2012-12-11 19:57:49 -0500] cheflevelramen: awgross: Oh, that can be done? I'm using a single knife command at the moment to spin up the new instance. Do you know if knife can associate an EIP?
[2012-12-11 19:58:18 -0500] awgross: cheflevelramen: it can try, you can also do some tricky stuff like associate it during the bootstrap process before chef-runs
[2012-12-11 19:59:06 -0500] cheflevelramen: I see. I'm not sure how to specify anything during the bootstrap process. Are there some docs/tutorials you can point me to?
[2012-12-11 20:00:05 -0500] awgross: cheflevelramen:
[2012-12-11 20:00:06 -0500] awgross: http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step3%253ABootstraptheEC2Instance
[2012-12-11 20:00:16 -0500] awgross: note what it says about using a custom bootstrap template
[2012-12-11 20:00:32 -0500] cheflevelramen: awgross: Thanks, I'll take a look
[2012-12-11 20:01:18 -0500] awgross: cheflevelramen: looks like knife-ec2 cant do it yet http://tickets.opscode.com/browse/KNIFE-151
[2012-12-11 20:02:12 -0500] jtimberman: a thing i've done is use a data bag item that has the role of the system that will need to use the EIP, and the EIP itself.
[2012-12-11 20:02:51 -0500] awgross: cheflevelramen: i have a script that parses the knife output and once it sees the instance has started, makes an external call to AWS to attach the EIP
[2012-12-11 20:03:25 -0500] awgross: cheflevelramen: the issue with this is that I believe the only reason my knife bottstrap wasnt getting disconnected is because I was tunneling my SSH connection through another AWS machine, so i was connected via the internal IP
[2012-12-11 20:04:32 -0500] cheflevelramen: awgross: nice, that might be useful. It looks like that knife-ec2 patch also allows you to associate it with knife on bootup, which could be useful.
[2012-12-11 20:05:27 -0500] jtimberman: https://gist.github.com/4261676
[2012-12-11 20:05:28 -0500] cheflevelramen: jtimberman: I think I like your idea, since there are times where eips need to be disassociated/associated while the instance is running, and being able to do that only on startup seems problematic.
[2012-12-11 20:06:13 -0500] cheflevelramen: jtimberman: I see, so then you have different recipes for each role then?
[2012-12-11 20:06:32 -0500] cheflevelramen: jtimberman: or, different recipes for each role that needs an eip I should say
[2012-12-11 20:09:10 -0500] cheflevelramen: jtimberman: In other words, in my 'aws' cookbook, should I make a corresponding recipe/data_bag for each eip role, ei, master db, front-end-load-balancer, etc?
[2012-12-11 20:10:42 -0500] cheflevelramen: jtimberman: And is it more beneficial to set the 'id' and 'elastic_ip' in a databag rather than just in the role? Just curious, and sorry for all the questions :)
[2012-12-11 20:11:29 -0500] jtimberman: the 'aws' cookbook here is opscode's, which provides lwrps for managing various instance-side resources like eips, ebs volumes
[2012-12-11 20:11:54 -0500] jtimberman: its just one approach, you could use an attribute in the role
[2012-12-11 20:12:58 -0500] cheflevelramen: @jtimberman: Okay cool. By having it in a databag instead, do you get extra functionality? Could you use it in search for example, whereas maybe you can't if it's set in a role?
[2012-12-11 20:14:19 -0500] programmerq: so, we've started using capistrano-chef so that our chef server is queried when cap determines what nodes are in what roles. I want to have cap write out the appropriate database.yml file based on what server has the database_master role in the chef server. Is there a good example somewhere that shows how that's done?
[2012-12-11 20:36:04 -0500] iyp: I'm getting a no method error when I try and use LWRP i defined in the cookbook in a recipe.
[2012-12-11 20:36:35 -0500] josephholsten: coderanger: is lwrp inheritance a thing yet? or is there an outstanding ticket? I want to reference it in CHEF-154
[2012-12-11 20:36:52 -0500] oddover: hi chefs. anyone have a good way for how to manage /etc/grub.conf?
[2012-12-11 20:37:29 -0500] iyp: If i have a default resource and provider defined in a cookbook named "zone" I should be able to just start with "zone "foozone" do" in the recipe, right?
[2012-12-11 20:38:14 -0500] awgross: iyp: if its not the "default.rb" provider, you should do coobookname_zone foozone do
[2012-12-11 20:38:15 -0500] josephholsten: oddover: I've never considered it, since it grub has to work before the machine would be running enough to be chef'd
[2012-12-11 20:38:37 -0500] awgross: iyp: crap just reread that, yes you are correct
[2012-12-11 20:39:16 -0500] iyp: awgross: Any idea where this is coming from then? -- FATAL: NoMethodError: zone[foozone] (zone::default line 1) had an error: NoMethodError: undefined method `name' for nil:NilClass
[2012-12-11 20:39:53 -0500] josephholsten: iyp: can you show us the resource and provider files
[2012-12-11 20:40:12 -0500] iyp: yeah, sure
[2012-12-11 20:40:21 -0500] iyp: i'll gist it in a sec
[2012-12-11 20:41:53 -0500] iyp: zone: https://gist.github.com/4261952
[2012-12-11 20:41:58 -0500] awgross: iyp: since you are specifying a name in the provider, you need to add a line in your resources/default.rb where you specify where it goes with :name_attribute => true,
[2012-12-11 20:42:02 -0500] iyp: provider: https://gist.github.com/4261955
[2012-12-11 20:42:18 -0500] iyp: err. first one is resource
[2012-12-11 20:42:42 -0500] iyp: Gotchya. That makes a lot of sense.
[2012-12-11 20:43:56 -0500] iyp: awgross: I was also referencing name in the info prints when in fact there was no name attribute. Guess that coincides with what you're saying though
[2012-12-11 20:45:22 -0500] iyp: So I edited the resource to look like this https://gist.github.com/4261952
[2012-12-11 20:45:26 -0500] iyp: still get the same error.
[2012-12-11 20:45:33 -0500] oddover: josephholsten: Thanks for the response. I think I've decided on making it a template. The only issue I had was where to get the kernel versions from, but I'll just grab those from an rpm command
[2012-12-11 20:47:30 -0500] iyp: aggress, josephholsten: got it. It was those info prints in the provider.
[2012-12-11 20:47:43 -0500] iyp: do @zone variableduh
[2012-12-11 20:49:32 -0500] binjured: what's the chef-server equivalent of solo's `chef.json'?
[2012-12-11 20:52:50 -0500] cmceldowney: Ruby 1.8.7 question/issue. in 1.9.3 the array.to_s function prints ["a","b"] in array notation, whereas in 1.8.7 it prints it as "ab"-- just joined. what is the best way in 1.8.7 to handle this?
[2012-12-11 20:56:48 -0500] miah: cmceldowney: foo.join
[2012-12-11 20:56:55 -0500] binjured: is the generally-accepted method for customizing attributes of a recipe done with roles? having a trouble filling that hole.
[2012-12-11 20:57:26 -0500] binjured: (coming from chef-solo, i just add stuff to 'json')
[2012-12-11 20:57:31 -0500] miah: binjured: with roles or wrapper cookbooks
[2012-12-11 20:57:35 -0500] jtimberman: binjured: attributes in a *recipe* or in a cookbook's attributes file?
[2012-12-11 20:57:42 -0500] cmceldowney: miah: I want it to print in the 1.9.3 style... e.g. I'm trying to output a ruby array in an erb template in the actual ruby array notation...
[2012-12-11 20:58:02 -0500] binjured: jtimberman: like, i want to use a database recipe but i want to change the root password, for instance.
[2012-12-11 20:58:27 -0500] jtimberman: binjured: link to the recipe you'rel ooking at?
[2012-12-11 20:58:46 -0500] miah: ah
[2012-12-11 20:59:07 -0500] binjured: jtimberman: http://community.opscode.com/cookbooks/database
[2012-12-11 20:59:32 -0500] binjured: particularly, customizing stuff like `server_root_password'
[2012-12-11 20:59:41 -0500] binjured: for a given node
[2012-12-11 21:00:31 -0500] binjured: that is, i have a hosted chef server, a node called "dev_vm", and i want to use a recipe i created (that uses database) and customize the password. do i create a role, upload that, and add it to the node?
[2012-12-11 21:00:52 -0500] jtimberman: binjured: ah yeah, just put that in a role.
[2012-12-11 21:01:02 -0500] binjured: great, thx
[2012-12-11 21:07:24 -0500] vu: #Linux
[2012-12-11 21:07:45 -0500] vu: exit
[2012-12-11 21:07:58 -0500] binjured: you shall not exit!
[2012-12-11 21:08:01 -0500] binjured: oh.
[2012-12-11 21:08:23 -0500] AntonZ: Hello, im using aws cookbook to mount a volume, i was wondering if it's possible to mount more than one volume using that cooknook ?
[2012-12-11 21:11:07 -0500] miah: write a wrapper cookbook that abuses the lwrp and knows how to .each
[2012-12-11 21:11:45 -0500] mhalligan: hrm is there a good way to populate attributes dynamically in a role?
[2012-12-11 21:11:58 -0500] AntonZ: i hope to be able to modify existing cookbook, for instance i was wondering if such block can be simply dublicated:L default['runa']['device'] = "/dev/sdj"
[2012-12-11 21:11:58 -0500] AntonZ: default['runa']['availability_zone'] = "us-west-1b"
[2012-12-11 21:11:59 -0500] AntonZ: default['runa']['volume_id'] = "vol-cfbc83e1"
[2012-12-11 21:12:14 -0500] mhalligan: example I'd like to have my bind address for my percona servers be node['rackspace']['private_ip']
[2012-12-11 21:12:50 -0500] makmanalp: AntonZ: you can override attributes
[2012-12-11 21:12:58 -0500] makmanalp: AntonZ: read about them in the docs
[2012-12-11 21:13:45 -0500] AntonZ: hmm
[2012-12-11 21:13:53 -0500] makmanalp: mhalligan: I think the way roles work is that you have a role special for your percona server, for example
[2012-12-11 21:14:07 -0500] makmanalp: mhalligan: and then override your recipe attributes from the role
[2012-12-11 21:14:33 -0500] binjured: can i just write a role in JSON from the start? the docs make it sound like i need to use the DSL then it'll end up as JSON on the server.
[2012-12-11 21:14:53 -0500] mhalligan: makmanalp: correct, but rather than setting an ip address for the bind-address attribute I'd like to use that other attribute, node['rackspace']['private_ip'], .. since I have no idea what my local IP address will be and I don't want to bind to 0.0.0.0
[2012-12-11 21:15:00 -0500] miah: ah
[2012-12-11 21:15:05 -0500] makmanalp: binjured: http://wiki.opscode.com/display/chef/Roles#Roles-AsJSON
[2012-12-11 21:15:45 -0500] binjured: thanks
[2012-12-11 21:16:02 -0500] binjured: and does it count as a DSL if it's just abusing the ambiguous nature of parenthesis in Ruby? :P
[2012-12-11 21:16:03 -0500] makmanalp: mhalligan: right so in the role you'd use the override attributes to specify bind-address to be whatever else you want, like node['rackspace'] ... etc
[2012-12-11 21:16:16 -0500] makmanalp: binjured: yes ;)
[2012-12-11 21:16:42 -0500] mhalligan: makmanlp: hrm when I try uploading my role I get: Exception: NameError: undefined local variable or method `node' for role[percona-cluster]:Chef::Role
[2012-12-11 21:17:19 -0500] makmanalp: mhalligan: ah, I forget the naming but try default instead of node possibly
[2012-12-11 21:17:42 -0500] mhalligan: same error
[2012-12-11 21:18:10 -0500] makmanalp: hrm
[2012-12-11 21:18:20 -0500] makmanalp: this should be possible, but surpasses me at this point
[2012-12-11 21:18:33 -0500] makmanalp: try searching in github for other people's roles, mhalligan
[2012-12-11 21:18:39 -0500] makmanalp: for examples
[2012-12-11 21:19:00 -0500] mhalligan: sure.
[2012-12-11 21:21:23 -0500] makmanalp: in any case, does anyone think they can answer a question regarding the execute resource?
[2012-12-11 21:21:55 -0500] makmanalp: I have this: http://pastie.org/private/f7kab4p7ucg2jslwz5qy8w but sometimes the only_if is somehow ignored and so the killall returns nonzero and the execute fails
[2012-12-11 21:21:55 -0500] bluepojo: depends on the question :P
[2012-12-11 21:22:22 -0500] makmanalp: and I have absolutely no clue why it's not reproducible
[2012-12-11 21:22:22 -0500] mhalligan: so I guess the answer is no
[2012-12-11 21:22:52 -0500] bluepojo: could it be that your only_if is returning true when you don't expect it to?
[2012-12-11 21:23:03 -0500] jtimberman: mhalligan: you'd have to do that in a recipe.
[2012-12-11 21:23:16 -0500] makmanalp: bluepojo: I think that's a possibility but I can't concieve why
[2012-12-11 21:23:21 -0500] jtimberman: mhalligan: so have your role include the recipe that does the "yo dawg, whats my rackspace IP? oh, stick it in this attribute"
[2012-12-11 21:23:50 -0500] makmanalp: bluepojo: the thing is I can't really monitor everything while the chef provisioning state is running so it's frustrating
[2012-12-11 21:23:55 -0500] binjured: is it generally recommend to keep all nodes as json in a repo? or is that overkill?
[2012-12-11 21:24:16 -0500] mhalligan: so give up on roles entirely and call everything from recipes?
[2012-12-11 21:24:34 -0500] mhalligan: since it seems silly to bother populating attribtues in a role when anything with dynamism requires code in a recipe
[2012-12-11 21:24:36 -0500] mhalligan: or am I just missing something?
[2012-12-11 21:24:40 -0500] jtimberman: naw dude
[2012-12-11 21:24:56 -0500] bluepojo: makmanalp: I don't use postgres, but is there a reason you don't stop postgres via a service resource?
[2012-12-11 21:25:00 -0500] jtimberman: do the things in roles that are static data
[2012-12-11 21:25:02 -0500] bluepojo: action :stop
[2012-12-11 21:25:28 -0500] makmanalp: bluepojo: yeah, in fact I'm trying to get rid of the darn service entirely, because i'm controlling it via supervisor
[2012-12-11 21:25:31 -0500] jtimberman: attributes are a candidate to push to cookbooks.
[2012-12-11 21:25:46 -0500] makmanalp: bluepojo: it's just that once you install the damn thing it starts automatically and won't die
[2012-12-11 21:26:16 -0500] bluepojo: ah hm
[2012-12-11 21:26:29 -0500] mhalligan: jtimberman: so what would you suggest as a workflow then? adding a new recipe to an existing / community cookbook that contains these things?
[2012-12-11 21:26:31 -0500] jtimberman: bluepojo: yo, btw, working on COOK-1694
[2012-12-11 21:26:33 -0500] makmanalp: i've been trying to use chef-rewind
[2012-12-11 21:26:47 -0500] bluepojo: jtimberman: oh yeah? how's it look?
[2012-12-11 21:26:53 -0500] mhalligan: or createing a site/company cookbook to put these sort of specific cookbook changes in, then just call that one recipe instead of the cookbook recipes in a role?
[2012-12-11 21:26:54 -0500] jtimberman: mhalligan: create a site specific cookbook that has that customization, make sure it comes before the community cookbook in the run list
[2012-12-11 21:26:56 -0500] bluepojo: jtimberman: I'm a little nervous about the merge, tbh
[2012-12-11 21:27:00 -0500] jtimberman: bluepojo: merge conflictirific :)
[2012-12-11 21:27:04 -0500] bluepojo: oh fun
[2012-12-11 21:27:19 -0500] bluepojo: you should have seen my rebase after coming back to it 3 months later
[2012-12-11 21:27:23 -0500] jtimberman: i did a rebase -i vs RiotGames/master to get it to a single pile of conflicts.
[2012-12-11 21:27:24 -0500] barnacles: is there a way to iterate over all new_resource attribute parameters?
[2012-12-11 21:27:35 -0500] makmanalp: bluepojo: also now that I realize who you are, sorry about the email spam today regarding: https://github.com/RiotGames/sphinx-cookbook/pull/3#issuecomment-11262056
[2012-12-11 21:27:47 -0500] makmanalp: but it worked, I think the other person took a look
[2012-12-11 21:27:51 -0500] jtimberman: bluepojo: now i'm in the "oh, that option is deprecated if you're using the mysql packages that come with RHEL 5" :)
[2012-12-11 21:28:11 -0500] mhalligan: jtimberman: should I include any of the community cookbooks in the runlist, or in the site-specific customization?
[2012-12-11 21:28:36 -0500] mhalligan: ie can I populate those attributes from that one recipe and still call the other cookbooks from the runlist, or do I then have to call the cookbooks specifically from that site-specific recipe?
[2012-12-11 21:28:42 -0500] bluepojo: makmanalp: hah no worries
[2012-12-11 21:29:38 -0500] bluepojo: jtimberman: I couldn't help but feeling like that cookbook needs a rewrite from scratch at some point
[2012-12-11 21:29:45 -0500] bluepojo: maybe separate the recipes out per platform
[2012-12-11 21:29:55 -0500] mhalligan: this is where I always got frustrated with puppet, the N different places to set attributes and then struggling with precedence.
[2012-12-11 21:30:02 -0500] bluepojo: and deal with a little duplication instead of crazy ifs and case statements
[2012-12-11 21:30:10 -0500] programmerq: so, knife node show gives me the IP
[2012-12-11 21:30:20 -0500] programmerq: even though that's not one of the json attributes for the node
[2012-12-11 21:30:21 -0500] mhalligan: so it's unclear if I should be setting any attributes in roles if I also need to set dynamic attributes
[2012-12-11 21:30:28 -0500] programmerq: I want knife search to give me the IP. How do I do this?
[2012-12-11 21:32:37 -0500] jtimberman: mhalligan: i use roles to set the run list of the things that are required to fulfill that role. so for example, i'm working with mysql cookbook, and i have a "database" (single node setup, otherwise i'd use "database-master"). i have some site-specific modifications so i create a cookbook called "whizbang-mysql" with the customizations I need in a recipe (like grabbing the rackspace IP for the bind_address). then I put whizbang-mysql and mysql
[2012-12-11 21:32:45 -0500] jtimberman: bluepojo: i'm feeling it.
[2012-12-11 21:32:58 -0500] jtimberman: bluepojo: supporting osx and windows is great, but it really makes the server recipe hard to read.
[2012-12-11 21:32:59 -0500] josephholsten: programmerq: search by ip? knife search node 'ipaddress:10.100.4.*'
[2012-12-11 21:33:08 -0500] programmerq: no, not seacrh by ip
[2012-12-11 21:33:12 -0500] programmerq: I want to return the IP
[2012-12-11 21:33:17 -0500] jtimberman: mhalligan: does that make sense?
[2012-12-11 21:33:25 -0500] programmerq: knife search node 'roles:database_master' -a ip
[2012-12-11 21:33:26 -0500] mhalligan: jtimberman: can you point me to documentation showing how I can export those attributes from the recipe?
[2012-12-11 21:33:29 -0500] programmerq: that gives blank output
[2012-12-11 21:33:35 -0500] josephholsten: programmerq: knife search node 'ipaddress:10.100.4.3*' -a ipaddress
[2012-12-11 21:33:42 -0500] mhalligan: that's where I'm lost, how do you make that recipe create attributes the next cookbook can use?
[2012-12-11 21:33:48 -0500] programmerq: ipaddress I think is what I'm after
[2012-12-11 21:34:04 -0500] mhalligan: are those attributes global or within the scope of that recipe / cookbook?
[2012-12-11 21:34:20 -0500] programmerq: josephholsten: this is on an aws box. ipaddress returns the private address
[2012-12-11 21:34:32 -0500] programmerq: knife node show foo.example.com has in the output IP: <public address>
[2012-12-11 21:34:33 -0500] jtimberman: mhalligan: node attributes are scoped to the Chef::Node object for "this" node that is currently running Chef.
[2012-12-11 21:34:38 -0500] josephholsten: ok, I'm a little rusty.
[2012-12-11 21:34:41 -0500] programmerq: and it's the public address we're after.
[2012-12-11 21:34:53 -0500] doomviking: ec2.public_hostname perhaps
[2012-12-11 21:35:03 -0500] mhalligan: jtimberman: so I can put my override_attributes section in that recipe and everything is cool?
[2012-12-11 21:35:10 -0500] josephholsten: but if you  do knife search node 'foo:bar' -f json, you can see all the attributes
[2012-12-11 21:36:09 -0500] programmerq: I guess I am curious about how the knife node show is pulling that data. it seems to provide the abstraction that would definitely come in handy for both our aws and non-aws environments.
[2012-12-11 21:36:13 -0500] mhalligan: (or rather  node.override attributes)
[2012-12-11 21:36:22 -0500] jtimberman: https://gist.github.com/4262352
[2012-12-11 21:37:14 -0500] jtimberman: i generally use node.set, mainly out of habit, because it is less common to want 'node.override' in a recipe (it overrides other customizations that might come from roles or environments and can be surprising in community-shared cookbooks)
[2012-12-11 21:37:30 -0500] josephholsten: programmerq: let me look. I'm pretty sure it's not pretty. or should be called 'providing an abstraction'
[2012-12-11 21:37:34 -0500] mhalligan: ok I see
[2012-12-11 21:37:37 -0500] awgross: jtimberman: isnt node.set equivalent to node.normal?
[2012-12-11 21:37:48 -0500] jtimberman: awgross: yes. one is an alias for the other in the code.
[2012-12-11 21:38:00 -0500] jtimberman: 'set' has fewer characters than 'normal' :)
[2012-12-11 21:38:03 -0500] mhalligan: I guess I just expected to be able to consider attribute-heavy cookbooks to be treatable like libraries/methods
[2012-12-11 21:38:05 -0500] programmerq: I'm going to guess that it populates that "IP:" field in the output by first looking at cloud, and then falling back to ipaddress.
[2012-12-11 21:38:05 -0500] mhalligan: thanks
[2012-12-11 21:38:07 -0500] awgross: jtimberman: node.normal seems odd since its the only that persists after removal
[2012-12-11 21:38:39 -0500] programmerq: and actually, if I do the -l switch on knife search, I get everything, including IP
[2012-12-11 21:38:42 -0500] josephholsten: programmerq: https://github.com/opscode/chef/blob/master/lib/chef/knife/core/node_presenter.rb#L94
[2012-12-11 21:38:43 -0500] programmerq: so that may work for me
[2012-12-11 21:39:23 -0500] programmerq: josephholsten: cool. thanks for chasing that down. I really appreciate it.
[2012-12-11 21:40:14 -0500] josephholsten: no worries. every rat hole I chase into teaches me more about the codebase
[2012-12-11 21:42:49 -0500] awgross: Has there been any discussion about a way to have an "error handler" for a block?  For example if my package install failed, it would run a block (in this case to update the package listings) then retry the package block?
[2012-12-11 21:47:27 -0500] jtimberman: bluepojo: hm, 'mysqld failed to start' on centos 6.3, works fine on 5.8 - i did make some modification to attributes that aren't available in the default mysql version on centos 5
[2012-12-11 21:48:13 -0500] jtimberman: might be bad grants :)
[2012-12-11 21:49:24 -0500] bluepojo: jtimberman: hm, my test server was 6.2
[2012-12-11 21:49:59 -0500] jtimberman: bluepojo: perms seem ok
[2012-12-11 21:50:10 -0500] jtimberman: its silently failing on a config option somewhere.
[2012-12-11 21:50:15 -0500] jtimberman: near's i can tell
[2012-12-11 21:50:24 -0500] bluepojo: I happen to sit next to a mysql dba if you kick me some logs I might be able to get him to take a look.
[2012-12-11 21:50:32 -0500] bluepojo: tho he's away from his desk
[2012-12-11 21:50:52 -0500] jtimberman: its ok
[2012-12-11 21:51:45 -0500] gregp76: Hi, i've got question regarding chef search and numeric range
[2012-12-11 21:51:52 -0500] gregp76: this works fine: knife node search "role:my-app AND fqdn:server01.company.tld"
[2012-12-11 21:51:53 -0500] gregp76: what i need is: knife node search "role:my-app AND fqdn:server[0-9]*.company.tld" - and i tried all different options and it didn't work
[2012-12-11 21:52:56 -0500] programmerq: what's the difference between the rpm package called "chef" vs "chef-full"?
[2012-12-11 21:55:14 -0500] wassy121: gregp76, maybe it's "role:my-app AND fqdn:/server[0-9]*.company.tld/" - try that?
[2012-12-11 21:55:25 -0500] koblas: What's the fix for  - ERROR: The data in your request was invalid
[2012-12-11 21:55:25 -0500] koblas: Response: Cannot update sandbox.
[2012-12-11 21:57:07 -0500] josephholsten: koblas: I think the sandbox directory's perms are hosed
[2012-12-11 21:57:32 -0500] gregp76: wassy121: doesn't like it
[2012-12-11 21:57:48 -0500] wassy121: Okay, I think the keyword is TO
[2012-12-11 21:57:50 -0500] gregp76: ERROR: knife search failed: invalid search query: 'fqdn%3A%2Fre*%2F' Parse error at offset: 4 Reason: Expected one of AND, OR, NOT, ?, \, ", (, [, { at line 1, column 6 (byte 6) after :
[2012-12-11 21:58:14 -0500] wassy121: try "role:my-app AND fqdn:server[0 TO 9]*.company.tld"
[2012-12-11 21:58:24 -0500] gregp76: tried this one
[2012-12-11 21:58:28 -0500] josephholsten: jtimberman: it's failing before it gets to logging?
[2012-12-11 21:59:13 -0500] jblaine: programmerq: If I had to guess, I would suspect chef-full is the Omnibus-based full-stack installer.
[2012-12-11 21:59:24 -0500] gregp76: knife search node "fqdn:re[0 TO 9]*" - parse error as well
[2012-12-11 21:59:27 -0500] jblaine: programmerq: Includes ruby, etc.
[2012-12-11 21:59:29 -0500] koblas: josephholsten: any idea how to unhose them?
[2012-12-11 21:59:49 -0500] programmerq: jblaine: the omnibus installer seems to be pulling an rpm of the filename "chef-<version>" rather than "chef-full-<version>"
[2012-12-11 21:59:54 -0500] programmerq: that was my guess too until I saw that.
[2012-12-11 21:59:56 -0500] programmerq: hmmm
[2012-12-11 21:59:57 -0500] wassy121: gregp76, hmm, I'm trying these from other syntax ideas on solr docs.  Maybe chef does it a bit differently.
[2012-12-11 22:00:10 -0500] wassy121: gregp76, I don't use that kind of query often.
[2012-12-11 22:00:28 -0500] awgross: yay google has learned enough not to autocorrect shef => chef, badge of honor
[2012-12-11 22:00:29 -0500] gregp76: thanks - i tried to find this in documentation and couldn't so far...
[2012-12-11 22:00:51 -0500] josephholsten: koblas: not off hand, I remember something similar in irc not long ago, let me search
[2012-12-11 22:01:14 -0500] jtimberman: josephholsten: ya
[2012-12-11 22:01:50 -0500] jtimberman: its something in the config from chef, because it works with the default my.cnf from the package.
[2012-12-11 22:02:45 -0500] josephholsten: opscoders: is there a place to submit a ticket for the irc search? it really ought to sort chronologically
[2012-12-11 22:03:28 -0500] jtimberman: coderanger: ^^?
[2012-12-11 22:03:57 -0500] coderanger: josephholsten: Not really, that site is EOL'd so minimal work is being put into it before the rewrite
[2012-12-11 22:04:46 -0500] josephholsten: and the pandas have sadness
[2012-12-11 22:05:55 -0500] josephholsten: koblas: I have no idea, sry
[2012-12-11 22:06:05 -0500] koblas: ok - thanks for trying
[2012-12-11 22:12:38 -0500] wassy121: gregp76, It doesn't seem like it will do what you want there.
[2012-12-11 22:13:09 -0500] wassy121: gregp76, I think you need to make it "dumber" like: "role:my-app AND fqdn:server*.company.tld"
[2012-12-11 22:13:50 -0500] wassy121: Since it uses the SOLR backend, and does a custom parse of the search terms to transmogrify them into SOLR syntax, it doesn't support everything.
[2012-12-11 22:14:56 -0500] gregp76: that's my understanding as well - i boiled this down to 'role:my-app AND fqdn:re* AND !fqdn:redis*' and it does the trick
[2012-12-11 22:15:01 -0500] gregp76: thanks a bunch
[2012-12-11 22:17:09 -0500] koblas: I think figured out the problem - upload -a doesn't do dependancies correctly.
[2012-12-11 22:17:52 -0500] awgross: koblas: upload -a just does them in order that they are in the directory
[2012-12-11 22:18:21 -0500] koblas: If I unwind the dependancies and do them one at a time it works.
[2012-12-11 22:18:33 -0500] koblas: If I get the depedendancies wrong  i get a sanbox error
[2012-12-11 22:18:50 -0500] mhalligan: is anyone using the chef-percona cookbook on ubuntu 12.04?
[2012-12-11 22:18:57 -0500] mhalligan: it seems to go into dependency hell
[2012-12-11 22:19:40 -0500] AntonZ: suggestion needed, im trying to mount /tmp on a seperate volume, when i try to do that, it times out on attaching, my guess that something uses original /tmp folder during chef run, what would be the best way to mount /tmp ?
[2012-12-11 22:20:35 -0500] awgross: AntonZ: do you need the whole /tmp dir on a separate vol, or just a subfoler
[2012-12-11 22:21:47 -0500] AntonZ: i need the whole /tmp, as thats where our app writes too, changing app properties is out of my control
[2012-12-11 22:22:29 -0500] AntonZ: one of the thoughts i had is to mount it somwhere and then symlink, but that's not the preffered way to do things i think
[2012-12-11 22:25:57 -0500] alop: anyone know if the database cookbook can create individual tables?
[2012-12-11 22:28:38 -0500] AntonZ: tmp is pretty important, thats interesting no one tried to mount it on a seperate volume
[2012-12-11 22:29:48 -0500] uncommitted: using a git resource, how can I ask it to only run once? doesn't seem to support "creates"
[2012-12-11 22:30:10 -0500] jtimberman: uncommitted: action :checkout
[2012-12-11 22:30:33 -0500] uncommitted: ah, there it is thank you
[2012-12-11 22:30:36 -0500] jtimberman: alop: i think its just databases and users, haven'tl ooked recently
[2012-12-11 22:30:58 -0500] alop: jtimberman: Yah, I think you're right, been looking at the provider just now
[2012-12-11 22:45:25 -0500] zakkudo: guys
[2012-12-11 22:45:44 -0500] zakkudo: I'm trying to use some methods I made in a library in a cookbook
[2012-12-11 22:46:02 -0500] zakkudo: but I can't access the methods from the chef build in resources
[2012-12-11 22:46:06 -0500] zakkudo: is it possible?
[2012-12-11 22:46:12 -0500] zakkudo: my google powers are failing me
[2012-12-11 22:46:53 -0500] programmerq: I want to write out a config file with chef using a template. I'd like to write out all the nodes that have role "memcached"
[2012-12-11 22:47:02 -0500] programmerq: I'm not sure how to do this from within a template.
[2012-12-11 22:48:28 -0500] jtimberman: programmerq: set a local variable to the results of a search in your recipe and pass the results of the search to the template as variables
[2012-12-11 22:49:02 -0500] programmerq: jtimberman: I'm only familiar with searching with knife. I don't know how to search from within a recipe.
[2012-12-11 22:49:11 -0500] programmerq: aha
[2012-12-11 22:49:24 -0500] programmerq: http://wiki.opscode.com/display/chef/Search - "Using Search in Recipes"
[2012-12-11 22:49:30 -0500] jtimberman: programmerq: memcache_hosts = search(:node, "role:memcached")
[2012-12-11 22:49:31 -0500] jtimberman: :)
[2012-12-11 22:51:48 -0500] programmerq: and, how would we restrict the results further by limiting to only our current environment? search(:node, "role:memcached") would return all results for memcached nodes in as many environments as there are on my chef server.
[2012-12-11 22:53:32 -0500] programmerq: node[:chef_environment] seems promising... trying now. :)
[2012-12-11 22:54:20 -0500] ssd7: programmerq: "role:memcached AND chef_environment:#{node.chef_environment}"
[2012-12-11 23:03:13 -0500] cheeseplus: can you use a wildcard for create in an execute resource>
[2012-12-11 23:03:15 -0500] cheeseplus: ?
[2012-12-11 23:06:50 -0500] kisoku: is partial search available in the chef 11 alpha ?
[2012-12-11 23:17:53 -0500] papertigers_: Is there anyway to tell chef-client to run just one recipe or role from a run list
[2012-12-11 23:20:34 -0500] ssd7: papertigers_: check out the -o option
[2012-12-11 23:29:55 -0500] jtimberman: kisoku: I believe so
[2012-12-11 23:31:26 -0500] ssd7: kisoku: Yup, it is
[2012-12-11 23:34:06 -0500] zakkudo: hrm.  I've tried using Chef::Recipe.send(:include, Library) but it doesn't send it to the provider
[2012-12-11 23:34:38 -0500] papertigers_: ssd7: only thing that sucks is that it gets rid of the cached cookbooks
[2012-12-11 23:37:06 -0500] zakkudo: bah.  I guess I am going about things the wrong way
[2012-12-11 23:47:45 -0500] Blah1: hey all.  i'm looking at using deploy provider to check out some python code from git, and then execute a startup script (this isn't a webapp).   however, the problem i'm running into is the deploy provider appears to be ruby-centric .   should i be using this provider to deploy python apps?
[2012-12-11 23:48:17 -0500] Blah1: for example, by default it attempts to create symlinks an symlinks before migration , which point to database.yaml .   which i understand is a rails ism
[2012-12-11 23:49:18 -0500] Blah1: i have a custom migration script which i pass to chef migration_command.  anyway, i tried issuing a 'symlinks {}' and a 'symlinks_befor_migrate {}' in the deploy block but chef still insists on symlink database.yaml
