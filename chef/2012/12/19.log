[2012-12-19 00:02:44 -0500] miah: yes
[2012-12-19 00:06:23 -0500] terbeaux: howdy!
[2012-12-19 00:07:07 -0500] terbeaux: i am creating a cookbook for icinga and am having some trouble figuring out the best way to determine chip architecture like x86_64 or i386.
[2012-12-19 00:07:48 -0500] terbeaux: is node['kernel']['machine'] the way to go?
[2012-12-19 00:07:52 -0500] JasonF: terbeaux: that's gotta be in the ohai data, right? try going to any machine and running     ohai | less -- that should have arch in there somewhere?
[2012-12-19 00:08:05 -0500] doomviking: uname -p
[2012-12-19 00:08:07 -0500] doomviking: :)
[2012-12-19 00:08:13 -0500] terbeaux: can i put files in different directories for them to be autoloaded?
[2012-12-19 00:08:26 -0500] terbeaux: doomviking, it supports windows as well
[2012-12-19 00:08:48 -0500] doomviking: no uname on windows? the horror. nevermind :)
[2012-12-19 00:09:24 -0500] terbeaux: i guess i would love to be able to put files in directories like files/windows/x86_64/NCSP++64.msi or files/windows/i686/NCSP++32.msi
[2012-12-19 00:10:11 -0500] terbeaux: doomviking: it does have it. i had never checked before. i guess it is pseudo posix compliant
[2012-12-19 00:10:17 -0500] terbeaux: winxp has uname
[2012-12-19 00:10:29 -0500] terbeaux: it says ming32-nt5.1
[2012-12-19 00:10:48 -0500] doomviking: huh.
[2012-12-19 00:14:18 -0500] jkyle: miah: was that 'yes' fo rme?
[2012-12-19 00:14:53 -0500] doomviking: you want to get that from node metadata anyway, I imagine.
[2012-12-19 00:15:11 -0500] miah: jkyle: yes.
[2012-12-19 00:15:40 -0500] miah: jkyle: http://wiki.opscode.com/display/chef/Environments
[2012-12-19 00:18:05 -0500] xmltok: what does the 'cookbook' command do? I see it in the varnish cookbook where its called withh the vcl_cookbook attribute
[2012-12-19 00:23:08 -0500] miah: xmltok: the 'command' is a option to a specific resource. it tells the resource which cookbook to look in for the source file being referenced.
[2012-12-19 00:23:20 -0500] jkyle: xmltok: it specifies the cookbook to use as the root for resource lookups
[2012-12-19 00:23:48 -0500] jkyle: xmltok: so you could, say, include a cookbook then use its resource but specify your cookbook so your own templates are used instead
[2012-12-19 00:24:58 -0500] xmltok: aha, that was my problem
[2012-12-19 00:26:36 -0500] xmltok: its looking in ubuntu-12.04, ubuntu, and default, but it doesnt use the FQDN inside of templates anymore?
[2012-12-19 00:27:23 -0500] eric-atlas: I'm trying to use powershell to return the SID of a supplied user. Can someone give me with storing the return value?
[2012-12-19 00:27:38 -0500] eric-atlas: *give me a hand
[2012-12-19 00:27:53 -0500] xmltok: it checks host-fqdn but doesnt tell you about it, i got it
[2012-12-19 00:33:16 -0500] maplebed: is there any way to get access to node attributes and things from within a data bag?
[2012-12-19 00:34:49 -0500] miah: no
[2012-12-19 00:35:16 -0500] miah: you can load a databag and use node attributes, and databag items together though
[2012-12-19 00:36:11 -0500] maplebed: context: I'm using teh nagios cookbook, which defines things to monitor as data bags.
[2012-12-19 00:36:31 -0500] maplebed: one of the checks queries my ganglia server for the data to test (i.e. nginx qps)
[2012-12-19 00:36:42 -0500] maplebed: and needs the ganglia server as an argument.
[2012-12-19 00:36:55 -0500] maplebed: it'd be nice to ask chef who the current ganglia server is
[2012-12-19 00:37:02 -0500] miah: then you need to define the check externally to the databag
[2012-12-19 00:37:29 -0500] maplebed: I think the way I'd prefer to work around it is to change the ganglia check script to take a configuration file and then drop the current ganglia host in that (instead of on the command line){
[2012-12-19 00:37:48 -0500] miah: why not just use search and nagios_check?
[2012-12-19 00:38:18 -0500] miah: you _can_ write recipes that define single nagios checks like that.
[2012-12-19 00:40:56 -0500] maplebed: not sure what you mean - I don't see a LWRP named nagios_check.  (there's nrpecheck, but that's not what I want at teh moment)
[2012-12-19 00:42:48 -0500] miah: ah ya. forgot thats a lwrp that i wrote in my fork :P
[2012-12-19 00:42:58 -0500] maplebed: :(
[2012-12-19 00:42:58 -0500] miah: still. its what you can do too =)
[2012-12-19 00:43:08 -0500] maplebed: I kinda like the whole data bag thing
[2012-12-19 00:43:16 -0500] maplebed: but if you published your LWRP, ...
[2012-12-19 00:43:27 -0500] miah: it is published. but its not complete.
[2012-12-19 00:43:48 -0500] miah: you can't do it all via databag though. because its difficult to write data into them (without hitting race conditions)
[2012-12-19 00:44:56 -0500] maplebed: you mean there are some checks you've tried to define that just don't work via data bags?  or specifically the example I was asking about?
[2012-12-19 00:45:20 -0500] miah: i mean, unless you write a wrapper recipe. you won't have _all the data you need_ in the databags.
[2012-12-19 00:45:32 -0500] miah: which is what your problem is
[2012-12-19 00:46:19 -0500] miah: its the 'single source of truth' problem. data bags can't easily be the single source of truth. you need to combine multiple sources in this situation.
[2012-12-19 00:46:21 -0500] maplebed: this is the first check I've come across that problem, and arguably, the check should take a config file for things that aren't specific to this check...
[2012-12-19 00:46:39 -0500] miah: i have yet to see a single nagios / sensu / check that 'takes a config file.'
[2012-12-19 00:47:33 -0500] miah: additionally. you'll probably want multiple instances of that check for each of your nginx servers
[2012-12-19 00:47:52 -0500] maplebed: yeah, sure, but that's the target to check, not where to get the data.
[2012-12-19 00:48:01 -0500] maplebed: I expect the $HOSTNAME$ to be replaced by nagios
[2012-12-19 00:48:16 -0500] maplebed: it's just unusual  that the source of the data is not the host itself but ganglia.
[2012-12-19 00:49:03 -0500] maplebed: is your nagios_check lwrp in a git branch?
[2012-12-19 00:49:41 -0500] miah: yes. but its also relies on a heavily modified nagios cookbook. i doubt you'll want to use what i've got. nagios is just a mess as it is.
[2012-12-19 01:07:36 -0500] tupy: hey guys, I got a terrible problem with chef search now
[2012-12-19 01:08:20 -0500] tupy: some nodes was appearing in the knife node list, however, they was not listed in knife search +criteria
[2012-12-19 01:09:03 -0500] tupy: we tried knife index rebuild, doesn 't works
[2012-12-19 01:10:31 -0500] tupy: it 's sound something related to node data length, since we destroyed the node and create other one, put role by role to get working fine again
[2012-12-19 01:10:42 -0500] ranjib_: tupy, which version of chef server?
[2012-12-19 01:10:52 -0500] ranjib_: lot of us had this issue
[2012-12-19 01:10:56 -0500] tupy: 10.16.2
[2012-12-19 01:11:02 -0500] ranjib_: server?
[2012-12-19 01:11:49 -0500] ranjib_: search the mailing list archive... there was a solr related setting that limits the amount of data being indexed.
[2012-12-19 01:12:36 -0500] ranjib_: also, check if  search(:node, "*:*") returns same number of nodes, as knife node list?
[2012-12-19 01:15:24 -0500] tupy: ranjib_, no, the knife node list returns more nodes than search
[2012-12-19 01:15:43 -0500] ranjib_: then its a solr issue
[2012-12-19 01:15:45 -0500] miah: then chef-expander isn't expanding and storing new data in solr
[2012-12-19 01:15:51 -0500] miah: check on expander and solr
[2012-12-19 01:18:17 -0500] tupy: ranjib_, how we set the amount of data to be indexed?
[2012-12-19 01:21:26 -0500] tupy: ranjib_, ok, I'll check this http://tickets.opscode.com/browse/CHEF-2346
[2012-12-19 01:29:50 -0500] tupy: thank you ranjib_ and miah , I will try to increase  increased the maxFieldLength to solr config attribute
[2012-12-19 03:02:54 -0500] jkyle: where can I find the chef library api?
[2012-12-19 03:11:07 -0500] jkyle: also, am I interpreting the docs right that the only place you can directly set attributes to the node is in cookbooks?
[2012-12-19 03:19:30 -0500] cwj: jkyle: attributes can be set at 11 different levels
[2012-12-19 03:19:48 -0500] cwj: i am not very familiar with the new docs site but i think this page from the old wiki docs is helpful http://wiki.opscode.com/display/chef/Attributes
[2012-12-19 03:20:22 -0500] cwj: but to some extent, the answer to your question is yes
[2012-12-19 03:20:57 -0500] Death_Syn: what was wrong with the old docs site? :/
[2012-12-19 03:21:13 -0500] cwj: er sorry, i mean the answer to your question is no
[2012-12-19 03:22:01 -0500] cwj: then again i dont really know what you mean by "directly set attributes"
[2012-12-19 03:22:07 -0500] cwj: hope thats clear as mud
[2012-12-19 04:01:31 -0500] jtimberman: Death_Syn: wikis are not awesome for documentation especially of a versioned software framework.
[2012-12-19 04:45:20 -0500] sascha_d: oo, are we complaining about the new docs site?
[2012-12-19 04:45:36 -0500] sascha_d: Not that I want to
[2012-12-19 04:46:23 -0500] sascha_d: looks like I'm late to that party
[2012-12-19 05:04:27 -0500] cwj: not really complaining
[2012-12-19 06:01:15 -0500] chef_0_0: I am using nginx recipe, something is driving me crazy,  on a freshly started EC2 instance when I apply my nginx recipie , while compiling it takes up nginx path /opt/nginx-1.2.3 but in my recipie I am explicitly setting node.set['nginx']['version'] = "1.2.6" , unable to find out what's happening
[2012-12-19 06:01:23 -0500] chef_0_0: help
[2012-12-19 06:02:01 -0500] chef_0_0: something to do OHAI variables overiding it..
[2012-12-19 06:25:56 -0500] evxd: chef_0_0: i don't think ohai populates the 'nginx' key. what recipe are you using?
[2012-12-19 06:28:30 -0500] cwj: the nginx cookbook installs and runs an ohai plugin which provides nginx attributes
[2012-12-19 06:29:15 -0500] evxd: well that's fucky. didn't know that.
[2012-12-19 06:29:17 -0500] cwj: and in the past i have had problems with automatic level (ohai) nginx attributes overriding role attributes
[2012-12-19 06:29:32 -0500] cwj: so i continue to use some older version of the cookbook
[2012-12-19 06:30:06 -0500] cwj: i think there is a ticket somewhere about the ordering issues around that, not sure
[2012-12-19 06:32:38 -0500] cwj: http://tickets.opscode.com/browse/COOK-1495 i think?
[2012-12-19 06:33:10 -0500] chef_0_0: cwj, You are right, its driving me crazy
[2012-12-19 06:33:59 -0500] evxd: there's some discussion here as well: https://github.com/opscode-cookbooks/nginx/pull/14
[2012-12-19 06:35:51 -0500] cwj: yeah i think thats the PR referenced in COOK-1495
[2012-12-19 06:36:03 -0500] chef_0_0: In my recipie I setting nginx version attribute and custom config params , but onthe first chef run, it does not consider my attributes and uses default version (1.2.3) and creates relevant dirs. When I run chef second time , it magically considers new attributes (which I have supplied)
[2012-12-19 06:36:06 -0500] cwj: the one that cant be merged that is
[2012-12-19 06:38:08 -0500] cwj: chef_0_0: try using version 0.99.2 of the cookbook
[2012-12-19 06:38:24 -0500] cwj: i think that was the most recent version which did not use the ohai plugin stuff
[2012-12-19 06:39:31 -0500] chef_0_0: cwj, evxd, Is there any other recipe anywhere which allows me compile from source without all this mess?
[2012-12-19 06:40:07 -0500] chef_0_0: Ah Ok, let me try that
[2012-12-19 06:40:09 -0500] evxd: i would just do as cwj said, that's your best bet
[2012-12-19 06:42:49 -0500] cwj: looks like being able to access role and environment attributes in cookbook attributes file in chef 11 should be pretty great
[2012-12-19 06:49:17 -0500] chef_0_0: is there any command to install specifc version of cookbook ? or I have to checkout the commit whose msg is "nginx 0.99.2 " ?
[2012-12-19 06:50:10 -0500] evxd: chef_0_0: http://community.opscode.com/cookbooks/nginx
[2012-12-19 06:50:29 -0500] evxd: you can download specific versions there
[2012-12-19 07:36:46 -0500] chef_0_0: cwj, evxd, I downloaded 0.99.2 , knife cookbook upload nginx , I still see that on first run of chef it is still picking the default version on second run its considering my role attr, What do you think is the issue?
[2012-12-19 07:37:25 -0500] cwj: did you remove the delete nginx cookbook you were already using from the chef server?
[2012-12-19 07:37:40 -0500] cwj: by default your node will keep getting the newest version
[2012-12-19 07:38:11 -0500] chef_0_0: Oh I didnt do that, How do we delete specific version?
[2012-12-19 07:38:17 -0500] chef_0_0: from chef server
[2012-12-19 07:38:19 -0500] chef_0_0: ?
[2012-12-19 07:38:22 -0500] cwj: knife cookbook delete nginx version-here
[2012-12-19 07:38:37 -0500] cwj: or dont specify a version and it should prompt you
[2012-12-19 07:38:39 -0500] cwj: i think...
[2012-12-19 07:42:09 -0500] iverson0881: knife cookbook delete cookbook [VERSION] (options)
[2012-12-19 07:42:12 -0500] iverson0881: http://wiki.opscode.com/display/chef/Managing+Cookbooks+With+Knife#ManagingCookbooksWithKnife-delete
[2012-12-19 07:58:00 -0500] chef_0_0: cwj, evxd, 0.99.2 source recipie (of nginx) has couple of "node.set[:nginx][:install_path]=something", is that overwirting the attributes I have supplied in role ?
[2012-12-19 08:09:38 -0500] jsnapp: jtimberman: are you online?
[2012-12-19 09:21:08 -0500] chef_0_0: Is there a chef workflow that people follow to be more productive while building chef recipies , I find myself starting new instances all the time , knife cookbook delete/upload etc.. this is all very slow.. how can the development process be faster?
[2012-12-19 09:25:48 -0500] emanuelez: chef_0_0: I asked something very similar yesterday and the answer I got is using something like http://berkshelf.com/
[2012-12-19 09:32:26 -0500] chef_0_0: emanuelez: Thanks , but managing dependency is less of a issue, things like 1.) start instance, 2.) run chef-client on it, 3.) check logs, 4.) if that didnt work and ohai has messed up some attributes, start another instance on ec2 and repeat.. That process slows me down
[2012-12-19 09:33:45 -0500] emanuelez: chef_0_0: does it have to be an ec2 instance? how about a local VM, with vagrant for example?
[2012-12-19 09:36:11 -0500] chef_0_0: emanuelez: Well not really, I wanted a quick way to reset everything and work with base system again and again, spinning instances with EC2 AMI was quicker than something like using local VMware instances, so I went with EC2. are you using vagrant for this purpose?
[2012-12-19 09:36:43 -0500] emanuelez: i am. and it's surely faster than spinning up instances manually in virtualbox.
[2012-12-19 09:37:31 -0500] emanuelez: but if you HAVE to use ec2 instances, then you can instantiate and provision directly with knife if you install the knife-ec2 gem
[2012-12-19 09:38:09 -0500] emanuelez: vagrant also supports chef out of the box, so you just need to specify the runlist in the vagrant configuration file
[2012-12-19 09:38:34 -0500] chef_0_0: Ah Ok, Thats help ful Thanks
[2012-12-19 09:40:15 -0500] emanuelez: you're welcome mate
[2012-12-19 10:15:11 -0500] C4NoC: hi, i've just install new rvm ruby 1.9.3-p327, and chef 10.16.2
[2012-12-19 10:15:43 -0500] C4NoC: when start chef-server i got this error : chef-server-api-10.16.2/config/init.rb:20:in `require': cannot load such file -- merb-assets (LoadError)
[2012-12-19 11:02:13 -0500] jimjimovich: my chef server on ubuntu 12.04 (installed by chef-solo method) is constantly crashing. Any ideas what logs I should be looking at to track down the problem?
[2012-12-19 11:18:15 -0500] emanuelez: jimjimovich: well... /var/log/messages is a good start. nything interesting in there?
[2012-12-19 11:20:03 -0500] C4NoC: i've just install new rvm ruby 1.9.3-p327, and chef 10.16.2
[2012-12-19 11:20:13 -0500] C4NoC: when start chef-server i got this error :  chef-server-api-10.16.2/config/init.rb:20:in `require': cannot  load such file -- merb-assets (LoadError)
[2012-12-19 11:20:55 -0500] jimjimovich: there's no /var/log/messages file, but I've checked the syslog and also the chef logs and see nothing
[2012-12-19 11:21:20 -0500] jimjimovich: it seems to just stop responding on ports 4000 and 4040 until I restart the server
[2012-12-19 12:13:46 -0500] emanuelez: chef headache. i have an attribues file that contains something like version = x and then builds a url like url=http://whatever.com/file#{node[something][x]}.zip but if i override the version attribute in a role, the url still gets the default version from the attributes file. any hint?
[2012-12-19 13:04:50 -0500] machi: hi
[2012-12-19 13:05:20 -0500] machi: knife command for create new security group or key pair in AWS ec2
[2012-12-19 13:05:34 -0500] machi: it is possible???
[2012-12-19 13:26:05 -0500] zts: emanuelez: when I've had to do that in the past, I've moved the bit that builds the URL into a recipe
[2012-12-19 13:26:33 -0500] emanuelez: zts: yeah.... my idea too
[2012-12-19 13:57:27 -0500] jflowers: hello, got a vagrant/chef provisioner question
[2012-12-19 13:57:59 -0500] jflowers: I get this error, show in the comment, when I add the nifty code snippet in this gist: https://gist.github.com/4223941
[2012-12-19 13:58:16 -0500] joeyfitz: in windows, when you install some software, a server must be rebooted. in almost all circumstances you can delay the reboot for a certain amount of time, but eventually you need to reboot to continue to install dependent software. what's the best way to handle this in a role? one reboot per role, and only at the end? and then something to script multiple runs by progressively adding roles?
[2012-12-19 13:59:20 -0500] jflowers: hmm, I have not encountered the need to that much rebooting?
[2012-12-19 13:59:23 -0500] specialsauce: joeyfitz, in the notification you can set it to restart at the end of the run
[2012-12-19 13:59:38 -0500] specialsauce: using ":delayed"
[2012-12-19 13:59:47 -0500] jflowers: what are you installing
[2012-12-19 14:00:16 -0500] joeyfitz: special sauce, yes - i've used that
[2012-12-19 14:00:34 -0500] jflowers: is there some action that occurs in the reboot?
[2012-12-19 14:00:39 -0500] jflowers: a file that is created
[2012-12-19 14:00:43 -0500] joeyfitz: jflowers: an example is - i want to create a visual studio 2012 development workstation
[2012-12-19 14:00:45 -0500] jflowers: a reg setting that is created
[2012-12-19 14:01:08 -0500] joeyfitz: i first configure server roles for app server and web server, which installs .NET 3.5 SP1
[2012-12-19 14:01:20 -0500] joeyfitz: i then install .NET 4.0 and 5.0
[2012-12-19 14:01:31 -0500] joeyfitz: i then need to install visual studio 2012
[2012-12-19 14:01:40 -0500] joeyfitz: once visual studio 2012 is installed you MUST reboot
[2012-12-19 14:01:50 -0500] jflowers: if you can find one a thing that is created a result of the reboot you can wrap your other recipes in a conditional checking for evidence of the reboot
[2012-12-19 14:01:54 -0500] joeyfitz: i then want to install and configure asp.net MVC 3.0 and 4.0
[2012-12-19 14:02:21 -0500] joeyfitz: and a variety of other things, some of which *require* a reboot to continue to install other dependencies
[2012-12-19 14:02:25 -0500] joeyfitz: windows is dumb in that way
[2012-12-19 14:02:29 -0500] jflowers: I would create a meta recipe, like a role, that just does many include_recipe
[2012-12-19 14:02:51 -0500] jflowers: and wrap the include_recipe
[2012-12-19 14:03:39 -0500] joeyfitz: so essentially i'd be continually applying a role until i observe some state? like completed = true
[2012-12-19 14:04:03 -0500] joeyfitz: how do i repeatedly apply the same role?
[2012-12-19 14:04:20 -0500] jflowers: rerun chef
[2012-12-19 14:04:41 -0500] joeyfitz: so i need to ensure every single step in the recipes are idempotent
[2012-12-19 14:04:41 -0500] joeyfitz: ?
[2012-12-19 14:04:47 -0500] jflowers: see this example for a meta recipe: https://github.com/pivotal/pivotal_workstation/blob/master/recipes/meta_osx_base.rb
[2012-12-19 14:04:54 -0500] jflowers: yes
[2012-12-19 14:05:30 -0500] jflowers: or inconsequential/trivial
[2012-12-19 14:05:34 -0500] joeyfitz: yes i've seen the pivotal workstation cookbook - i'm essentially trying to create a windows version
[2012-12-19 14:06:36 -0500] jflowers: I created something similar for windows java dev workspace: https://github.com/jflowers/virgo.sample-greenpages/tree/master/Build
[2012-12-19 14:06:47 -0500] jflowers: I also package it up into a setup exe
[2012-12-19 14:07:23 -0500] jflowers: really its a sfx file, a self-extracting zip file that kicks of a batch script
[2012-12-19 14:07:38 -0500] jflowers: and the batch script installs chef and then runs chef-solo
[2012-12-19 14:08:20 -0500] jflowers: and boom you have a boot-strap setup for your developers to run
[2012-12-19 14:14:30 -0500] joeyfitz: jflowers: thanks! i will check that out and try to leverage that pattern
[2012-12-19 14:15:04 -0500] joeyfitz: do you reboot multiple times in that, or just once at the end?
[2012-12-19 14:27:59 -0500] makerbreakr: anyone have a second to trouble shoot this?
[2012-12-19 14:28:00 -0500] makerbreakr: https://gist.github.com/4337012
[2012-12-19 14:28:08 -0500] makerbreakr: Im having a heck of a time figuring out why the file is not created
[2012-12-19 14:28:24 -0500] makerbreakr: those recipes are all from the cookbook one_player
[2012-12-19 14:29:18 -0500] makerbreakr: if i move the playlist.json creation to the default recipe it still does not work
[2012-12-19 14:29:38 -0500] ashb: makerbreakr: please include the full receipes  not a snipped version.
[2012-12-19 14:30:57 -0500] makerbreakr: ashb it has been updated
[2012-12-19 14:31:28 -0500] ashb: look up in the wiki the 'anatomy of a chef run'
[2012-12-19 14:31:45 -0500] ashb: basically the tempalte block on line 20 doens't create and render that file then and there
[2012-12-19 14:31:55 -0500] ashb: it only happens at the end when chef converges
[2012-12-19 14:32:28 -0500] ashb: you probably want a ruby resource or to store things differently
[2012-12-19 14:33:40 -0500] makerbreakr: can you elaborate?
[2012-12-19 14:34:21 -0500] ashb: http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-12-19 14:34:26 -0500] makerbreakr: ya, Im reading that now
[2012-12-19 14:34:31 -0500] makerbreakr: but I mean as far as a ruby resource?
[2012-12-19 14:34:47 -0500] ashb: basically template do says 'set up this template to be rendered' but it hasn't acutally been rendered by the time you try to read it on line 29
[2012-12-19 14:35:02 -0500] ashb: a ruby resource is run after the template is rendered
[2012-12-19 14:35:22 -0500] makerbreakr: should I split that recipe off into another cookbook then?
[2012-12-19 14:35:35 -0500] ashb: doesn't matter what cookbook it is in
[2012-12-19 14:35:42 -0500] makerbreakr: put the template rendering in the one_player::default recpie, and the playlist in another cookbook?
[2012-12-19 14:35:48 -0500] ashb: http://wiki.opscode.com/display/chef/Resources#Resources-RubyBlock
[2012-12-19 14:36:13 -0500] ashb: all cookbooks are 'compilied' to build up a list of resources to execute, and then they are executed
[2012-12-19 14:43:24 -0500] jflowers: @joeyfitz I don't ever reboot
[2012-12-19 14:52:01 -0500] awgross: Has anyone experienced a problem where Chef-Client will stop outputting log messages after a really long shell_out! command?
[2012-12-19 14:53:21 -0500] awgross: nevermind, it just crashes, not stops logging
[2012-12-19 14:55:53 -0500] masterkorp: awgross:
[2012-12-19 14:56:01 -0500] masterkorp: err, sorry
[2012-12-19 15:19:11 -0500] w6fu: just fyi, the nagios::server source cookbook seems to miss installing check_nrpe
[2012-12-19 15:31:49 -0500] jsnapp: jtimberman: can you look at COOK-2092?  the latest release of chef-client::config breaks chef-client runs
[2012-12-19 15:32:58 -0500] gyre007: is anyone here using metachef cookbook ?
[2012-12-19 15:33:26 -0500] gyre007: im trying to figure out whats it useful for ?
[2012-12-19 15:34:25 -0500] avishai: hi
[2012-12-19 15:34:41 -0500] avishai: i need some help finding my way around erchef
[2012-12-19 15:50:20 -0500] emanuelez: can i safey change the fqdn of a node? or will authentication stop working?
[2012-12-19 15:50:59 -0500] Death_Syn: emanuelez: if in doubt, set node_name in /etc/chef/client.rb
[2012-12-19 15:51:19 -0500] emanuelez: ok
[2012-12-19 15:51:21 -0500] Death_Syn: as long as node_name matches what the chef-server knows, auth should work fine
[2012-12-19 15:59:25 -0500] phrixos: I'm brand new to chef; have got basic usage working fine but would now like to do something a bit more complicated and am having trouble getting anywhere with the docs
[2012-12-19 16:00:21 -0500] phrixos: I've got a number of hosts in a role, and I'd like to create a file from a template which lists which hosts are in a given role by environment
[2012-12-19 16:00:56 -0500] phrixos: so it might contain      staging: foo-staging-01 \n production: foo-prod-01 foo-prod-02
[2012-12-19 16:01:33 -0500] phrixos: is it possible to derive this information from what Chef already knows about nodes, roles and environments and use it in a template?
[2012-12-19 16:01:48 -0500] awgross: phrixos: check out chef-search (if you are using chef server)
[2012-12-19 16:02:24 -0500] barnacles_: ^
[2012-12-19 16:04:47 -0500] w6fu: fixed the nagios server_source.rb nrpe issue: https://gist.github.com/4337844
[2012-12-19 16:05:49 -0500] phrixos: awgross, barnacles_ thanks
[2012-12-19 16:07:24 -0500] eliklein: hey there.. my understanding is that knife cookbook site install will *merge* changes into an existing site install of a cookbook if you've made local changes.. is that true?
[2012-12-19 16:10:25 -0500] zts: eliklein: that is the theory
[2012-12-19 16:11:27 -0500] eliklein: zts: it's strange.. i'm trying to update the yum cookbook and i've added a recipe.  It's nuking the recipe when I initiate the site install
[2012-12-19 16:11:56 -0500] zts: eliklein: but it relies on certain branches being in your git repository (created automatically when you 'cookbook site install' to begin with), which it is possible to lose
[2012-12-19 16:12:41 -0500] zts: eliklein: if you do "git branch", do you see "chef-vendor-yum" in the output?
[2012-12-19 16:12:51 -0500] eliklein: zts: i do not
[2012-12-19 16:13:01 -0500] eliklein: i wonder if this got blown away at some point
[2012-12-19 16:13:54 -0500] eliklein: ahhhhh
[2012-12-19 16:14:08 -0500] eliklein: ok yeah i must have created a new git repo at some point
[2012-12-19 16:14:26 -0500] eliklein: i went to the directory where i had the old repo and all those branches are present
[2012-12-19 16:14:43 -0500] eliklein: zts: thank you! i can just reinstall all these cookbooks and it should get me started in the right direction
[2012-12-19 16:18:49 -0500] zts: eliklein: no problem
[2012-12-19 16:23:06 -0500] failshel1: hello. im using the following snipet: http://pastebin.ca/2294954 basically, my problem is, using a script resource, my variable is not expended when it runs
[2012-12-19 16:23:15 -0500] failshel1: any help will be appreciated :)
[2012-12-19 16:24:56 -0500] sunil_: is there a known issue with user cookbook where its trying to use -m option to change user's password with user mod?
[2012-12-19 16:24:57 -0500] awgross: failshel1: looks like you are trying to reference a key in the cfg.members hash, but you arent passing in a symbol or a string, so it is failing.  Try putting double quotes around #{@id}
[2012-12-19 16:25:55 -0500] awgross: failshel1: err wait, hmm that is a big string, unsure now
[2012-12-19 16:26:19 -0500] awgross: failshel1: can you just create a template, put it on the server, then run it?
[2012-12-19 16:26:35 -0500] failshel1: awgross: that's plan B :)
[2012-12-19 16:26:44 -0500] awgross: failshel1: also, HF with mongo
[2012-12-19 16:26:57 -0500] sunil_: Looks like usermod -p "***" username is also using -m option at the end? which is weird.
[2012-12-19 16:27:05 -0500] failshel1: awgross: "" didn't work
[2012-12-19 16:27:22 -0500] awgross: yeah, that was bad advice, rereading the code helped
[2012-12-19 16:27:47 -0500] awgross: does 'puts @id'  show anything?
[2012-12-19 16:28:11 -0500] failshel1: ya the value
[2012-12-19 16:28:16 -0500] awgross: ok
[2012-12-19 16:28:31 -0500] failshel1: im trying to export something with ENV['foo']
[2012-12-19 16:28:34 -0500] awgross: my guess is that ruby/chef is not recognizing the EOH as a strign
[2012-12-19 16:28:35 -0500] failshel1: hopefully $foo will be ok
[2012-12-19 16:28:46 -0500] awgross: so its not doing proper substitution
[2012-12-19 16:28:51 -0500] awgross: template IMO
[2012-12-19 16:29:19 -0500] failshel1: looks like that's what ill have to do
[2012-12-19 16:29:24 -0500] failshel1: that's very hacky
[2012-12-19 16:31:23 -0500] failshel1: awgross: http://pastebin.ca/2294957
[2012-12-19 16:31:25 -0500] failshel1: that works
[2012-12-19 16:31:37 -0500] awgross: failshel1: fair enough
[2012-12-19 16:31:54 -0500] failshel1: ya
[2012-12-19 16:32:02 -0500] failshel1: i might open a bug about that
[2012-12-19 16:32:21 -0500] awgross: go for it
[2012-12-19 16:39:09 -0500] barnacles_: Anyone here use chef with jenkins>
[2012-12-19 16:41:38 -0500] awgross: barnacles_: in what way
[2012-12-19 16:42:52 -0500] barnacles_: awgross: Having an integration environment that compiles chef resources and causes a jenkins failure when a chef failure occurs
[2012-12-19 16:43:19 -0500] barnacles_: awgross: So devs work on stuff, commit, and are warned when it failed (via jenkins) in the integration environment
[2012-12-19 16:43:45 -0500] awgross: barnacles_: yes, i have done that
[2012-12-19 16:43:48 -0500] awgross: its finnicky
[2012-12-19 16:44:10 -0500] barnacles_: awgross: Can you elaborate on "finnicky"? :P
[2012-12-19 16:44:13 -0500] awgross: doable, but a little weird
[2012-12-19 16:44:20 -0500] awgross: i opted to have some basic unit tests run on the server
[2012-12-19 16:44:37 -0500] barnacles_: awgross: Unit tests for chef?
[2012-12-19 16:44:38 -0500] awgross: and then use knife-ec2 to create new machines which run the recipes/minitest
[2012-12-19 16:44:43 -0500] awgross: rpsec
[2012-12-19 16:44:48 -0500] barnacles_: awgross: I see
[2012-12-19 16:44:49 -0500] awgross: for various library files etc
[2012-12-19 16:44:56 -0500] awgross: also did foodcritic
[2012-12-19 16:44:59 -0500] awgross: knife test
[2012-12-19 16:45:41 -0500] awgross: check to make sure metadata version is upped
[2012-12-19 16:46:40 -0500] awgross: that was the "unit" test section
[2012-12-19 16:46:57 -0500] awgross: then I had a script which parsed the commit and check which cookbooks/recipes were changed
[2012-12-19 16:47:14 -0500] barnacles_: awgross: This does not sound fun.
[2012-12-19 16:47:23 -0500] awgross: this then kicked off parameterized jenkins jobs which spun up EC2 machines and ran the varios recipes / rolls
[2012-12-19 16:47:26 -0500] awgross: roles*
[2012-12-19 16:47:51 -0500] awgross: barnacles_: it was an interesting try, i am going to revamp it for a second round.  Unsure if I will be using Jenkins or something else to manage it
[2012-12-19 16:48:17 -0500] barnacles_: awgross: Thanks for your input, much appreciated
[2012-12-19 16:48:47 -0500] awgross: np
[2012-12-19 17:11:11 -0500] eliklein: zts: you still here?
[2012-12-19 17:11:55 -0500] mikeg: aren't there omnibus installers for chef server?  I'm only finding chef-client omnibus info on the site
[2012-12-19 17:11:58 -0500] eliklein: so it appears that the problem with cookbook site install in my case is that the branches aren't being pushed remote, thereby making it so anyone other than the original person to run the site install doesn't have the branch
[2012-12-19 17:12:40 -0500] eliklein: is there a way to force cookbook site install to push the branch remote each time it's updated?
[2012-12-19 17:15:36 -0500] zts: eliklein: hangon, I have some git config commands which may do the right thing
[2012-12-19 17:16:55 -0500] eliklein: zts: ok, thank you
[2012-12-19 17:18:51 -0500] matschaffer: is there any prior art on unit-testing LWRPs? working on the zone cookbook right now and I'd love to refactor it but lack of tests make that scary
[2012-12-19 17:19:06 -0500] zts: eliklein: this is what I've done before - https://gist.github.com/4338458
[2012-12-19 17:20:04 -0500] zts: eliklein: in a team situation, you'll need to make sure that everyone is doing that
[2012-12-19 17:20:37 -0500] eliklein: zts: ahh so it automatically pushes any branches remote?
[2012-12-19 17:21:50 -0500] zts: eliklein: yeah, I think you need both branches and tags, so that will push and pull everything by default.  I agree that it should probably be "cookbook site install"s job to do it on demand though
[2012-12-19 17:24:27 -0500] siezer: matschaffer zone? solaris zones?
[2012-12-19 17:24:31 -0500] matschaffer: yep
[2012-12-19 17:24:34 -0500] siezer: sweet
[2012-12-19 17:24:41 -0500] matschaffer: siezer: this one http://community.opscode.com/cookbooks/zone
[2012-12-19 17:24:47 -0500] matschaffer: trying to add support for loopback fs mounts
[2012-12-19 17:24:58 -0500] matschaffer: I think it got it, but it's a pretty ugly addition
[2012-12-19 17:25:06 -0500] matschaffer: bbiab, lunch time
[2012-12-19 17:25:44 -0500] moos3: anyone have a kvm knife module for turning up vms ?
[2012-12-19 17:26:45 -0500] eliklein: zts: i made that change but it doesn't seem to be working
[2012-12-19 17:27:05 -0500] eliklein: just downloaded a new cookbook and the branch didn't get pushed remote
[2012-12-19 17:27:33 -0500] zts: eliklein: ah sorry, to be clear - you'll need to do "git push" after you install the new cookbook, but it should now push the branches and tags remote
[2012-12-19 17:27:51 -0500] eliklein: yes, i did that
[2012-12-19 17:27:57 -0500] zts: oh
[2012-12-19 17:27:59 -0500] eliklein: it didn't push the branch :/
[2012-12-19 17:28:30 -0500] zts: That's me out of quick suggestions then, sorry :/
[2012-12-19 17:28:41 -0500] eliklein: haha no worries, thank you for the suggestion!
[2012-12-19 17:29:18 -0500] zts: no problem, sorry it didn't help!
[2012-12-19 17:31:30 -0500] barnacles_: awgross: Jenkins has a Vagrant plugin...hmmm...that might work for what I wanted (kind of)
[2012-12-19 17:31:54 -0500] barnacles_: awgross: I can provision set it up to provision chef and see if anything blows up lol
[2012-12-19 17:53:34 -0500] eliklein: zts: OK, so apparently it did work :)
[2012-12-19 17:53:55 -0500] eliklein: zts: however! i only see the branches if i do a git branch -r
[2012-12-19 17:54:36 -0500] eliklein: zts: will cookbook site install do the right thing (tm) and use the remote branch at origin/chef-vendor-<blah> instead of just chef-vendor-<blah>?
[2012-12-19 17:55:17 -0500] eliklein: i suppose i can just try and see
[2012-12-19 17:56:40 -0500] eliklein: argh, doesn't look like it.. a new local branch was created even though the remote branch existed
[2012-12-19 17:57:53 -0500] jwcarman: Is the following search order for knife.rb still applicable:
[2012-12-19 17:57:55 -0500] jwcarman: "Knife's configuration file is named knife.rb. Unless directly passed the configuration file location via the -c command line option, Knife searches for this configuration by searching for .chef/knife.rb, starting at the current working directory and moving upward. If no configuration is found ~/.chef/knife.rb is used if it exists."
[2012-12-19 17:58:48 -0500] jwcarman: We have a config file in ".chef/knife.rb", but it seems that if someone has a config file at "~/.chef/knife.rb" that it messes it up.
[2012-12-19 17:59:11 -0500] jwcarman: If we have those folks delete their ~/.chef directory, then all works well.
[2012-12-19 18:00:52 -0500] jbz: jwcarman: I dunno the official answer, but using 10.16.2, that search order works for me
[2012-12-19 18:00:58 -0500] jbz: we have a .chef/knife.rb in our repo
[2012-12-19 18:01:00 -0500] jbz: and it uses that
[2012-12-19 18:01:06 -0500] jbz: despite my having a ~/.chef/knife.rb
[2012-12-19 18:01:54 -0500] zts: eliklein: hm, what version of git are you using?
[2012-12-19 18:02:08 -0500] jbz: (I know it works b/c the ~/.chef/ directory doesn't have keys in it)
[2012-12-19 18:02:17 -0500] eliklein: zts: 1.7.12.1
[2012-12-19 18:02:45 -0500] eliklein: on osx lion
[2012-12-19 18:03:31 -0500] eliklein: zts: upgrading to 1.8.0.2 now just to see if it helps
[2012-12-19 18:03:56 -0500] jwcarman: lemme check my version...
[2012-12-19 18:04:25 -0500] jwcarman: Same version.  Hmmm.  Were there any bugs relating to that functionality in the past?
[2012-12-19 18:04:35 -0500] jwcarman: Perhaps some of my colleagues have an older version or something?
[2012-12-19 18:05:24 -0500] jbz: That I dunno, sorry.  We've never had that problem, and we've been using various versions since 0.9 or thereabouts.
[2012-12-19 18:05:49 -0500] jbz: But we haven't been testing for it.
[2012-12-19 18:06:58 -0500] eliklein: zts: so when someone else creates a branch and automatically pushes it, do you have to then manually create a local branch tracking that newly pushed remote before site install sees it?
[2012-12-19 18:06:59 -0500] jwcarman: jbz: thank you.  I'll keep digging.  They're proposing we specify the config location in all of our commands, but I'd rather not do that.  We check that knife.rb file into SCM too
[2012-12-19 18:09:29 -0500] jbz: yeah
[2012-12-19 18:09:48 -0500] jbz: we have *.pem on gitignore in that directory and just have the config in SCM.
[2012-12-19 18:10:19 -0500] zts: eliklein: I could have sworn that sufficiently recent git would automatically set up tracking if you created a local branch with the same name as the remote branch, but maybe the way that knife does it doesn't work with that
[2012-12-19 18:10:26 -0500] jbz: jwcarman: is it possible that the knife process is being run by a parent process which isn't actually in the directory they think it is?
[2012-12-19 18:10:56 -0500] jwcarman: We are running knife via rake
[2012-12-19 18:11:00 -0500] jwcarman: Perhaps that's the issue?
[2012-12-19 18:11:05 -0500] jbz: hmmmmm
[2012-12-19 18:11:07 -0500] jbz: possible
[2012-12-19 18:11:12 -0500] jbz: does it work properly if you run knife manually?
[2012-12-19 18:11:16 -0500] jwcarman: I'm just calling system(vagrant blah blah blah)
[2012-12-19 18:11:28 -0500] zts: eliklein: I think I'll have to dig into it further (unless you beat me to it).  I was sure I had this figured out at my last permanent job, but I'm less confident of that after this conversation :)
[2012-12-19 18:11:34 -0500] jwcarman: Let me get one of them to check.  I don't see the behavior (which makes it even curiouser)
[2012-12-19 18:11:41 -0500] jbz: Oh, I hate that. :-)
[2012-12-19 18:11:43 -0500] jbz: WORKSFORME
[2012-12-19 18:12:51 -0500] jwcarman: Yeah, it doesn't help.  Makes it fun trying to figure out the differences that could be causing the issue.
[2012-12-19 18:13:16 -0500] eliklein: zts: haha ok, well no rush, but if you figure out how you had it working, please share! :) I'll keep digging in the meantime
[2012-12-19 18:16:29 -0500] zts: eliklein: likewise :)
[2012-12-19 18:31:43 -0500] riddley2: Hi, I'm trying to send a notification from the database lwrp to another database lwrp (create database to populate database) and I see the :query notification, but the logs still say "doing nothing for "populate datatbase"
[2012-12-19 18:32:05 -0500] matschaffer: siezer: you do solaris work too?
[2012-12-19 19:00:12 -0500] dyer: Anyone around who maybe has an idea about riddley2 mysql_lwrp question ?
[2012-12-19 19:02:48 -0500] ranjib_: riddley2, pastebin?
[2012-12-19 19:03:33 -0500] riddley2: https://gist.github.com/519f3a96a5b698524930
[2012-12-19 19:03:58 -0500] pwf: how would one check if a data bag exists in a recipe?
[2012-12-19 19:04:04 -0500] pwf: try to get it and catch the exception?
[2012-12-19 19:04:38 -0500] avishai: hi
[2012-12-19 19:04:46 -0500] avishai: need some help with erchef
[2012-12-19 19:05:38 -0500] riddley2: updated the gist ranjib_
[2012-12-19 19:19:43 -0500] jkeiser_: fyi, knife-essentials has a new release with some bug fixes, multi-cookbook-dir support, and "knife deps" which will show you all recursive dependencies for nodes, cookbooks, and roles.  diff, upload, download, list, show, and delete all got local and remote modes, too.  (gem install knife-essentials)
[2012-12-19 19:19:47 -0500] ranjib_: riddley2, the sql statement inside populate database, can you log that? Chef::Log.info()
[2012-12-19 19:20:06 -0500] riddley2: ranjib_: it's huge... 1.5M
[2012-12-19 19:20:11 -0500] ranjib_: its using file.read.. not sure whats that , ::File.read
[2012-12-19 19:20:34 -0500] riddley2: I've tested that the File.read is working with logger ranjib_
[2012-12-19 19:21:59 -0500] jkeiser_: I'll be maintaining the gem in order to make more rapid updates, even though the base commands will become part of Chef 11.
[2012-12-19 19:22:20 -0500] mirk_: jkeiser_: Great news!
[2012-12-19 19:22:51 -0500] dyer: ranjib_, doesnt the logging riddley2 posted show the notified resource is being skipped due to action :nothing?
[2012-12-19 19:24:29 -0500] ranjib_: dyer, no it shows that the db create resource sending a :query action to the populate database resource
[2012-12-19 19:26:07 -0500] riddley2: ranjib_: what does this log line mean then? DEBUG: Doing nothing for mysql_database[populate database]
[2012-12-19 19:27:26 -0500] ranjib_: it  means it is not doing anything for that resource.. but chef will log this, as it moves through the actual resource declartion
[2012-12-19 19:28:08 -0500] riddley2: aah
[2012-12-19 19:28:20 -0500] ranjib_: *declaration, as you have declared it with action :nothing. But before doing that, it should execute qery against that resource, as notification is sent immediately
[2012-12-19 19:28:32 -0500] riddley2: am I doing this the way the database lwrp is intended to be used?
[2012-12-19 19:28:45 -0500] ranjib_: im looking at the provider  https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_mysql.rb#L63
[2012-12-19 19:29:05 -0500] ranjib_: jtimberman, will be able to answer this better
[2012-12-19 19:30:22 -0500] dyer: Yea, we ran this at debug level so if that populate database resource had happeend we would have seen this line https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_mysql.rb#L67
[2012-12-19 19:30:25 -0500] dyer: but we didnt
[2012-12-19 19:30:38 -0500] ranjib_: riddley2, dyer ideally u'll expect a debug statement after this one
[2012-12-19 19:30:51 -0500] ranjib_: INFO: Processing mysql_database[populate database] action query (po-wordpress::default line 80)
[2012-12-19 19:30:57 -0500] dyer: exactly
[2012-12-19 19:31:03 -0500] dyer: which isnt happening
[2012-12-19 19:31:37 -0500] dyer: but we are unsure what options avail us to figure out why, if its failing in the LWRP it is doing so silently
[2012-12-19 19:32:24 -0500] ranjib_: well, looking at the provider, if it happens that u create the db is absent. it wont run the query
[2012-12-19 19:32:45 -0500] benner: can anyone give good url about scaling chef server?
[2012-12-19 19:32:52 -0500] riddley2: but isn't the query running from a notify that created the db?
[2012-12-19 19:33:47 -0500] ranjib_: yes.. it should.
[2012-12-19 19:38:02 -0500] dyer: "<ranjib_> well, looking at the provider, if it happens that u create the db is absent. it wont run the query"..  <---  That doesnt make sense to me, can you rephrase this ?
[2012-12-19 19:38:19 -0500] wassy121: So, let's say I have some recipes like php::default, php::memcache, and memcache::default.  How do I note that php::memcache depends on memcache::default, without making everything that includes php::default pull in the memcache cookbook?
[2012-12-19 19:38:59 -0500] justincampbell: wassy121: if php::default doesn't depend on php::memcache, you shouldnt have an issue
[2012-12-19 19:39:35 -0500] wassy121: but shouldn't the php/metadata.rb include a line for "depends" to ensure the include_recipe in php::memcache doesn't fail?
[2012-12-19 19:39:59 -0500] justincampbell: wassy121: link?
[2012-12-19 19:40:21 -0500] justincampbell: brb
[2012-12-19 19:41:01 -0500] wassy121: I haven't written it up yet, just hashing it out before I get too deep into it.
[2012-12-19 19:41:42 -0500] miah: wassy121: yes. include a 'depends'. that wont affect php::default. you should put a "include_recipe 'memcache::default'" in your php::memcache recipe.
[2012-12-19 19:42:11 -0500] strcrzy_: is there a way to execute a block during convergence that has access to the recipe dsl?
[2012-12-19 19:42:20 -0500] wassy121: miah: thanks, that mostly makes sense.
[2012-12-19 19:43:45 -0500] miah: what do you have questions with?
[2012-12-19 19:44:24 -0500] ranjib_: dyer, im no sql expert, but i was thinking whether the first db creation statement committed before the db populate statement
[2012-12-19 19:44:43 -0500] ranjib_: dyer, thugh its highly unlikely
[2012-12-19 19:45:05 -0500] jwcarman: What is the best way to get all the cookbooks (all versions) from a running chef server and put it into another chef server?
[2012-12-19 19:45:41 -0500] jwcarman: I'm setting up a local chef server and I want to sync between that and the "real" chef server before uploading my locally-developed cookbooks to it
[2012-12-19 19:46:36 -0500] jwcarman: Or, would it be better to use something like "berkshelf" to go get only the cookbooks I need?
[2012-12-19 19:46:45 -0500] miah: berkshelf
[2012-12-19 19:46:47 -0500] jwcarman: out of the "real" one
[2012-12-19 19:47:07 -0500] joevandyk: How come I never hear of anyone using nix packages and chef?
[2012-12-19 19:47:07 -0500] jwcarman: So, how does berkshelf do that exactly?  Is it some sort of knife plugin or something?
[2012-12-19 19:48:16 -0500] jwcarman: Does it download only the ones it needs to a tmp dir and upload them with your stuff?
[2012-12-19 19:48:51 -0500] ranjib_: dyer, the only way to assert that is by adding a debug statement under the action_query medthod's if / else block
[2012-12-19 19:55:33 -0500] jbz: joevandyk:  Because it has so many Ruby dependencies (gems etc) that trying to manage it using *ix package systems is hell
[2012-12-19 19:55:49 -0500] joevandyk: jbz: what has ruby dependencies?
[2012-12-19 19:55:57 -0500] jbz: chef-client.  chef-server.
[2012-12-19 19:56:24 -0500] jbz: (sorry if I misunderstood, I thought you were asking why nobody managed Chef installations using *is pacakge management)
[2012-12-19 19:56:25 -0500] joevandyk: jbz: no, i mean using chef to manage your system using nix packages
[2012-12-19 19:56:31 -0500] jbz: er
[2012-12-19 19:56:43 -0500] joevandyk: instead of apt
[2012-12-19 19:56:48 -0500] nmische: hello, does anyone know if node.recipe? looks to the expanded runlist?
[2012-12-19 19:56:49 -0500] joevandyk: or rpm's or whatever
[2012-12-19 19:56:58 -0500] nmische: looking at the code (https://github.com/opscode/chef/blob/master/lib/chef/node.rb#L236) it seems it should
[2012-12-19 19:57:02 -0500] jbz: joevandyk: Oh.  Chef can totally use other package management systems.
[2012-12-19 19:57:11 -0500] jbz: You just need to be sure you tell it which to use.
[2012-12-19 19:57:13 -0500] nmische: but i'm not seeing that
[2012-12-19 19:57:15 -0500] strcrzy_: is there a way to execute a ruby block during convergence that has access to the recipe dsl?
[2012-12-19 19:57:16 -0500] joevandyk: yeah, just surprised i never hear of anyone using it.
[2012-12-19 19:57:25 -0500] strcrzy_: i'm kind of stuck ;(
[2012-12-19 19:58:13 -0500] jbz: joevandyk: We tried to use it with CentOS and found ourselves going down rabbit holes of deps just to get Chef running properly so we went Ubuntu
[2012-12-19 19:59:25 -0500] jbz: joevandyk: I kicked and screamed (oldskool Op) but it was explained to me that if you're treating nodes as disposable anyway, then CentOS' then-greater stability wasn't really a win compared with how much more of a PITA it was to get Chef stuff to work in it.
[2012-12-19 19:59:45 -0500] jbz: We had the luxury of blank-sheeting, though.
[2012-12-19 20:00:12 -0500] btm: @opscode #opschef Code Review: join: http://bit.ly/UdpMiw, watch: http://youtu.be/7DLSzWjEX78
[2012-12-19 20:00:21 -0500] joevandyk: jbz: are we talking about the same thing? http://nixos.org/
[2012-12-19 20:01:00 -0500] jbz: joevandyk:  Not really.  I was talking about 'why everyone seems to use apt'.
[2012-12-19 20:01:04 -0500] joevandyk: ah
[2012-12-19 20:01:07 -0500] jbz: Sorry. Shutting up now. :-)
[2012-12-19 20:01:22 -0500] fujin: we've looked at nix for some stuff. I like the ideas in disnix. I don't like the crazy language :)
[2012-12-19 20:01:28 -0500] jbz: I have no idea if there's a Nix provider.
[2012-12-19 20:03:45 -0500] eka: hi, how can I discover the private ip address in a linode machine? I have to set up some services to listen to private address
[2012-12-19 20:05:42 -0500] martinisoft: eka: unless you set it up ahead of time, you won't know unless you hit the Linode API
[2012-12-19 20:05:59 -0500] martinisoft: eka: Linode issues a private address if you ask for it, but you have to also configure it for the node.
[2012-12-19 20:06:23 -0500] joevandyk: jbz, fujin: http://sysadvent.blogspot.com/2012/12/day-10-packages-doing-too-much.html is interesting reading. mentions nix
[2012-12-19 20:10:34 -0500] eka: martinisoft: right... it's possible to pass arguments to be use as attributes when we run chef-solo? in case I know the ip beforehand
[2012-12-19 20:11:39 -0500] martinisoft: I don't think OHAI would see it. The patch I sent in assumes you setup the interface already.
[2012-12-19 20:11:51 -0500] martinisoft: Since its not part of node creation like in ec2
[2012-12-19 20:12:33 -0500] yfeldblum: eka, you can use `chef-solo -j /path/to/node.json`
[2012-12-19 20:12:39 -0500] eka: and no way to pass attributes to chef-solo... :(
[2012-12-19 20:13:03 -0500] martinisoft: eka: what yfeldblum said works
[2012-12-19 20:13:15 -0500] martinisoft: can give it node attributes in json
[2012-12-19 20:13:15 -0500] eka: yfeldblum: yes but you have to edit that file each time... will see if I can write it dynamically
[2012-12-19 20:13:39 -0500] yfeldblum: eka, chef is not designed to be run with different attributes each time
[2012-12-19 20:13:55 -0500] eka: yfeldblum: yes I know... but I have this drawback
[2012-12-19 20:14:53 -0500] eka: found this ohai plugin https://gist.github.com/1338655
[2012-12-19 20:14:57 -0500] eka: will see thanks
[2012-12-19 20:15:38 -0500] martinisoft: eka: careful with that one, you'll want to disable most of the cloud plugins if you use it
[2012-12-19 20:16:19 -0500] martinisoft: eka: this got merged in recently, so hopefully next release: http://tickets.opscode.com/browse/OHAI-418
[2012-12-19 20:18:14 -0500] eka: martinisoft: thanks
[2012-12-19 20:18:32 -0500] martinisoft: it vastly improves linode detection
[2012-12-19 20:18:38 -0500] martinisoft: right now Chef thinks its rackspace :x
[2012-12-19 20:18:47 -0500] eka: martinisoft: your hair match your tshirt :)
[2012-12-19 20:19:47 -0500] martinisoft: eka: :D
[2012-12-19 20:19:49 -0500] eka: martinisoft: any way to get this now? maybe cloning master right?
[2012-12-19 20:19:59 -0500] martinisoft: should be in master right now
[2012-12-19 20:20:09 -0500] eka: martinisoft: right... thanks
[2012-12-19 20:20:15 -0500] martinisoft: right now btm and others are doing a live review of things
[2012-12-19 20:20:23 -0500] martinisoft: so you could ask when they're off the meeting
[2012-12-19 20:28:40 -0500] eka: martinisoft: one thing I may have not explained is that the private ip is already configured, so I could parse the output of `ifconfig` and look for eth0:0 right?
[2012-12-19 20:29:08 -0500] martinisoft: eka: does Linode provision those now automatically? last I checked you had to config it manually
[2012-12-19 20:30:14 -0500] martinisoft: eka: Linode recommends eth0:1
[2012-12-19 20:30:18 -0500] martinisoft: not eth0:0
[2012-12-19 20:30:36 -0500] eka: martinisoft: no... but my process is 2 step. 1. the machine is cloned from a started image and the private ip is configured 2. provision runs on that machine
[2012-12-19 20:30:51 -0500] martinisoft: ah gotcha
[2012-12-19 20:30:56 -0500] martinisoft: http://library.linode.com/networking/configuring-static-ip-interfaces <- going by that document
[2012-12-19 20:31:06 -0500] eka: martinisoft: ok eth0:1 ... that would be available in ohai?
[2012-12-19 20:31:31 -0500] makerbreakr: anyone run into any trouble when editing a databag in the webui?
[2012-12-19 20:31:34 -0500] makerbreakr: it wont save for me
[2012-12-19 20:32:05 -0500] makerbreakr: nm
[2012-12-19 20:32:09 -0500] makerbreakr: kind of a weird ui
[2012-12-19 20:32:39 -0500] martinisoft: eka: with the next update yes :D
[2012-12-19 20:33:20 -0500] martinisoft: but as far as I know, even if you clone a linode with that eth0:1 you'll end up with the clones private IP and not the one of your new node
[2012-12-19 20:33:36 -0500] martinisoft: you might want to craft a stack script to do this as part of your provisioning?
[2012-12-19 20:33:42 -0500] jkyle: on the opscode wiki, the section on site-cookbooks reads like the cookbooks in site-cookbooks overrides those in cookbooks, but I've seen it indicated elsewhere that I can override or extend parts of a cookbook and there's sort of a merge between the one in cookbooks/ and site-cookbooks before uploading. e.g. I could create site-cookbooks/database and add only the recipes/myrecipe.rb then knife cookbook upload database
[2012-12-19 20:33:50 -0500] jkyle: which one of those is accurate?
[2012-12-19 20:34:52 -0500] geekbri: So it seems the provider for user groups must have changed sometime between chef 0.10.8 and 10.16.2 since my users cookbook is not borked :)
[2012-12-19 20:34:55 -0500] martinisoft: jkyle: I thought that functionality was slated for or has been deprecated? dunno if someone can elaborate...
[2012-12-19 20:35:54 -0500] jkyle: it would be unfortunate
[2012-12-19 20:36:22 -0500] jkyle: but I think I saw that somewhere too. . mostly I'm just looking for "the final answer" :P
[2012-12-19 20:38:22 -0500] yfeldblum: makerbreakr, that's why we have `knife data bag edit BAG ITEM -e vim`
[2012-12-19 20:38:44 -0500] makerbreakr: ya, i know heh, but not everyone on my team knows chef
[2012-12-19 20:38:44 -0500] jkyle: or just set your EDITOR
[2012-12-19 20:38:54 -0500] geekbri: jkyle: http://tickets.opscode.com/browse/CHEF-2308
[2012-12-19 20:40:47 -0500] jkyle: geekbri: thanks.
[2012-12-19 20:41:29 -0500] jkyle: that's too bad I guess. the site-cookbooks was a nice way to extend without having to manage a bunch of forks
[2012-12-19 20:42:02 -0500] matticulous: writing my first cookbook and could use a few pointers. i managed to retrieve a remote file into tmp and untar it. if i need to distribute the contents to to other places, are execute resources  (e.g. execute "cp") an appropriate way to do it?
[2012-12-19 20:43:03 -0500] matticulous: as an aside, glad to see that @nathenharvey just joined. the video series that he has put together recently has been tremendously helpful.
[2012-12-19 20:43:28 -0500] matticulous: so.thanks, nathen.
[2012-12-19 20:43:35 -0500] yfeldblum: jkyle, it's for the best
[2012-12-19 20:48:41 -0500] matticulous: are questions like these better asked on the mailing list (or somewhere else)? just trying to learn the landscape.
[2012-12-19 20:48:44 -0500] jkyle: I'd be interested in the general opinion of this post too: http://devopsanywhere.blogspot.com
[2012-12-19 20:50:02 -0500] jkyle: seemed site-cookbooks could have addressed one of those concerns. we've bumped into the situation that led them to not put any data in roles too
[2012-12-19 20:54:34 -0500] geekbri: jkyle: On that particular article, check out the comments.  Namely the first comment by Adam Jacbon
[2012-12-19 20:54:39 -0500] geekbri: Jacob
[2012-12-19 20:58:57 -0500] anthroprose: is there a better supported way for altering a node's runlist from one of that node's recipes other than (http://stackoverflow.com/questions/11728914/add-roles-in-chef-via-code).... the object Chef::Node.load dosn't return a .run_list ( NoMethodError: undefined method `run_list' for "" String)
[2012-12-19 21:03:38 -0500] hcastro: has anyone seen issues with node.recipe?("recipe_name") not working correctly?
[2012-12-19 21:05:16 -0500] btm: @Opscode Cookbook Code Review: Join: http://bit.ly/WsOjCI, watch: http://youtu.be/hqb-I3SNEYs #opschef
[2012-12-19 21:07:25 -0500] strcrzy_: anthroprose: you're doing Chef::Node.load(node_name)?
[2012-12-19 21:15:57 -0500] anthroprose: str: actually I think my first try was my want of ruby knowledge... was trying to assign... but now I'm doing () as I read the docs... no errors now but the changes are not taking
[2012-12-19 21:16:31 -0500] anthroprose: now I'm doing node.run_list('role[rolename]') and then a node.save
[2012-12-19 21:20:17 -0500] anthroprose: essentially I'm doing a failover scenario where I want to run a recipe[cookbook::failover] and then change the role to role[master] instead of role[slave]... would prefer to make the role change from inside of my failover recipe... but I do have other API commands being run for DNS entries & such, so I can run a knife cmd to change the role
[2012-12-19 21:33:36 -0500] moos3: can you use chef to install ruby gems ?
[2012-12-19 21:33:52 -0500] dougireton: moos3: check out the chef_gem resource
[2012-12-19 21:35:52 -0500] moos3: nice but I dont see how i can add my custom gems mirror
[2012-12-19 21:39:17 -0500] dougireton: moos3: you can pass options to the chef_gem resource, i.e. options source http://yourserver.example.com:8080
[2012-12-19 21:40:00 -0500] moos3: ah so source can be a .gem or a url sweet thanks
[2012-12-19 21:42:06 -0500] abetterlie: dougireton: woah, in what version did that come in? I remember in 10.8 I had executes for 'gem source -r' around my gem installs
[2012-12-19 21:42:34 -0500] dougireton: abetterlie: not sure which version, but it works in 10.16.2
[2012-12-19 21:42:52 -0500] dougireton: we are actively using it since our servers are behind firewalls
[2012-12-19 21:43:29 -0500] abetterlie: We wrote all kind of hackery around gem_source misbehaving and not loading the gem into the right ruby with the omnibus installer... glad to hear it works now.
[2012-12-19 21:43:46 -0500] dougireton: abetterlie: here's an example: chef_gem 'rubyzip' do
[2012-12-19 21:43:46 -0500] dougireton:   version '0.9.9'
[2012-12-19 21:43:47 -0500] dougireton:   options("--clear-sources --source #{node['shop']['gemserver']}")
[2012-12-19 21:43:47 -0500] dougireton: end
[2012-12-19 21:44:26 -0500] abetterlie: cool.
[2012-12-19 21:46:04 -0500] eka: any ETA on OHAI 6.16.0 ?
[2012-12-19 21:50:44 -0500] jwcarman: When specifying a "source" to Berkshelf, that URL points to some json file on the server?
[2012-12-19 21:51:04 -0500] jwcarman: I would assume it's some metadata file about the contents of the chef server?
[2012-12-19 21:51:26 -0500] dougireton: jwcarman: in the Berksfile?
[2012-12-19 21:51:37 -0500] jwcarman: yes
[2012-12-19 21:51:45 -0500] jwcarman: dougireton: yes
[2012-12-19 21:52:43 -0500] jwcarman: The example lists this URL http://cookbooks.opscode.com/api/v1/cookbooks
[2012-12-19 21:52:51 -0500] jwcarman: which returns some JSON string
[2012-12-19 21:53:24 -0500] dougireton: jwcarman: it's where to fetch that cookbook, either from the Opscode Community Site (metadata), or from a git repo, or a local path, or your own chef server
[2012-12-19 21:53:56 -0500] jwcarman: I'm talking about a stand-alone "site" command
[2012-12-19 21:54:04 -0500] jwcarman: Not the site of a specific cookbook
[2012-12-19 21:54:36 -0500] moos3: anyone have ideas on this https://gist.github.com/d610f965b15144cf2d2b
[2012-12-19 21:56:35 -0500] dougireton: jwcarman: the standalone site command only fetches from the Opscode Community Cookbook site right now
[2012-12-19 21:56:39 -0500] kindsol: jwcarman: see http://wiki.opscode.com/display/chef/Cookbook+Site+API
[2012-12-19 21:57:15 -0500] jwcarman: dougireton: so why does it show an example of getting cookbooks from a URL and not just :opscode?
[2012-12-19 21:58:17 -0500] dougireton: jwcarman: not sure on that, maybe just for future expansion, e.g. a community cookbook site mirror or something
[2012-12-19 21:58:50 -0500] dougireton: jwcarman: you might hit up Jamie (@resetexistence) on Twitter with your ?
[2012-12-19 21:58:58 -0500] jwcarman: dougireton: well, crap!  So, if I want to use cookbooks from a "central" chef server behind our firewall using berkshelf, I can't?
[2012-12-19 21:59:16 -0500] dougireton: jwcarman: that's different
[2012-12-19 21:59:20 -0500] dougireton: we are doing that
[2012-12-19 21:59:22 -0500] ivey: you just use the chef_api source
[2012-12-19 21:59:26 -0500] dougireton: yes
[2012-12-19 21:59:26 -0500] ivey: and it will pull via chef
[2012-12-19 21:59:32 -0500] jwcarman: dougireton: do I have to specify the site for each cookbook?
[2012-12-19 21:59:33 -0500] ivey: instead of the community API call
[2012-12-19 22:00:06 -0500] jwcarman: ahhhh!  Okay, don't use site.  Use the chef_api!
[2012-12-19 22:00:29 -0500] ivey: correct
[2012-12-19 22:00:33 -0500] jwcarman: Sorry if I'm a little slow on the uptake.  Somewhat new to this whole chef thing.  I'm more like the Swedish Chef from The Muppets
[2012-12-19 22:00:38 -0500] jwcarman: Bork bork bork!
[2012-12-19 22:00:43 -0500] ivey: and you can either make a config file, or use knife
[2012-12-19 22:01:10 -0500] dougireton: jwcarman: it was hard to get my head around Berkshelf at first
[2012-12-19 22:01:30 -0500] jwcarman: It seems very "mavenish" (I'm a Java developer)
[2012-12-19 22:02:13 -0500] mirk_: benner: Did anyone offer any info about scaling chef?
[2012-12-19 22:08:49 -0500] ivey: jwcarman: You wound me.
[2012-12-19 22:09:30 -0500] jwcarman: ivey: I said "ish" :)
[2012-12-19 22:11:08 -0500] bluepojo: hahaha
[2012-12-19 22:11:57 -0500] Maniacal: any chefspec pros online?  have a problem where, during convergence, an attributes file from antoher cookbook is being pulled in and I don't know why
[2012-12-19 22:16:52 -0500] retr0h: Maniacal: I know it a bit
[2012-12-19 22:16:55 -0500] jwcarman: ivey: it's mavenish because you can specify your dependencies and it downloads them and stores them in a folder in your home directory.  That just reminds me of maven
[2012-12-19 22:17:19 -0500] ivey: but there's no XML anywhere!
[2012-12-19 22:17:25 -0500] retr0h: Maniacal:  I have a janky way of getting around that probleme
[2012-12-19 22:18:00 -0500] retr0h: when you run rspec in $project root... it actually looks through ../ for cookbooks, which you may not want
[2012-12-19 22:18:55 -0500] jwcarman: ivey: true.  so maybe it's more like gradle :)
[2012-12-19 22:19:02 -0500] bluepojo: retr0h: does it not read the knife.rb to see where cookbooks live?
[2012-12-19 22:19:32 -0500] jwcarman: ivey: did you write Berkshelf?
[2012-12-19 22:19:55 -0500] retr0h: Maniacal: https://github.com/acrmp/chefspec/blob/master/lib/chefspec/chef_runner.rb#L151
[2012-12-19 22:20:02 -0500] retr0h: i believe that is your problem
[2012-12-19 22:20:19 -0500] retr0h: as lame as it is.. I have just been doing this (https://github.com/retr0h/motd-tail/tree/COOK-2089#testing)
[2012-12-19 22:20:40 -0500] bluepojo: jwcarman: https://github.com/RiotGames/berkshelf/graphs/contributors
[2012-12-19 22:21:21 -0500] jwcarman: among others, I see
[2012-12-19 22:21:39 -0500] jwcarman: I was looking into joining you Riot guys recently!
[2012-12-19 22:22:14 -0500] bluepojo: oh yeah?
[2012-12-19 22:22:16 -0500] bluepojo: it's nice here :D
[2012-12-19 22:23:47 -0500] ivey: it
[2012-12-19 22:23:51 -0500] ivey: it really is
[2012-12-19 22:24:09 -0500] ivey: and my main contribution was making us blindly carry forward with the name when everyone else thought it was a joke
[2012-12-19 22:25:10 -0500] bluepojo: it was a good contribution
[2012-12-19 22:25:15 -0500] jwcarman: ivey: I like the name!
[2012-12-19 22:25:42 -0500] jwcarman: bluepojo: I missed the boat on joining Riot by a couple of days.  Took another engagement
[2012-12-19 22:26:04 -0500] doomviking: no shit huh. I interviewd at Riot Games several years ago. I pulled the plug on it because of what my commute would look like
[2012-12-19 22:26:07 -0500] jwcarman: bleupojo: don't worry, I'll probably call them back when this engagement is done.
[2012-12-19 22:26:47 -0500] doomviking: if thats the Riot we're speaking of, on the west side
[2012-12-19 22:27:14 -0500] doomviking: heh
[2012-12-19 22:33:44 -0500] awgross: do i have to do something special to use my library files in a provider file?
[2012-12-19 22:34:03 -0500] awgross: tried doing the Chef::Recipe   include MyLib end stuff, no luck
[2012-12-19 22:34:13 -0500] awgross: also tried calling it directly MyLib.my_method
[2012-12-19 22:34:17 -0500] awgross: keeps saying undefined method
[2012-12-19 22:35:13 -0500] awgross: err NoMethodError
[2012-12-19 22:49:08 -0500] awgross: seems to work like the docs say if you use it in a recipe, but not in a provider
[2012-12-19 22:49:44 -0500] awgross: it loads the module, but it does not find the method
[2012-12-19 22:58:12 -0500] awgross: nevermind, i just dont read what i write
[2012-12-19 22:58:23 -0500] awgross: the example uses Chef::Recipe, and I had that working, predicatably, in a recipe
[2012-12-19 22:58:36 -0500] awgross: when using it in a provider, you need to import it into Chef::Provider
[2012-12-19 23:13:50 -0500] segv: hey guys how do I use an external variable to be used within a ruby_block
[2012-12-19 23:14:25 -0500] segv: so blah = blah\n ruby_block "test" do... block do ... puts "#{blah}" end end
[2012-12-19 23:22:09 -0500] segv: nm of course you can, my variable was just unset, hah
[2012-12-19 23:30:10 -0500] kindsol: looking to get the berkshelf spec tests running per https://github.com/RiotGames/berkshelf/blob/master/CONTRIBUTING.md
[2012-12-19 23:31:22 -0500] kindsol: nvm
[2012-12-19 23:31:42 -0500] kindsol: just had to hit 'return' after getting the guard prompt
[2012-12-19 23:39:55 -0500] juliancdunn: anyone know why Chef depends on such an old version of the JSON gem?
[2012-12-19 23:39:56 -0500] juliancdunn: s.add_dependency "json", ">= 1.4.4", "<= 1.6.1"
[2012-12-19 23:45:41 -0500] jtimberman: juliancdunn: previous negative experience with that gem breaking API compatibility in *patch* releases.
[2012-12-19 23:58:01 -0500] Maniacal: retr0h: thanks for the tips.  looking into that
