[2012-12-09 00:24:28 -0500] kallistec: WPsites: for the purposes of search, your data bags are top-level things, so you search in the users data bag by `knife search users SOLR_QUERY`
[2012-12-09 00:25:20 -0500] WPsites: I can search for say nodes or roles but when I try searching my data bag I get the 404 error
[2012-12-09 00:26:42 -0500] WPsites: kallistec: I just get   knife search failed: I don't know how to search for.    if I try search through a data bag
[2012-12-09 00:27:07 -0500] kallistec: WPsites: what exactly are you typing into the terminal?
[2012-12-09 00:27:26 -0500] WPsites: knife search thisdatabag "name:*"
[2012-12-09 00:28:11 -0500] kallistec: WPsites: what's the result from `knife data bag list` ?
[2012-12-09 00:28:15 -0500] WPsites: I've tried "*:*" with no joy. In my recipe there is an alternate search done and that doesn't work. Which is why I'm trying searches using knife, just to find out whats wrong.
[2012-12-09 00:28:19 -0500] kallistec: your data bag is in there?
[2012-12-09 00:28:43 -0500] WPsites: hmmm, no it's not there
[2012-12-09 00:29:46 -0500] WPsites: surely it should say data bag not found or something, not "I don't know how to search for this data bag"
[2012-12-09 00:31:42 -0500] WPsites: so it sounds like the problem is because the data bag isn't created. How can I make this recipe not generate this error?     databagItem = search("#{network}", 'id:' + node.name.gsub(".","DOT")).first
[2012-12-09 00:32:48 -0500] kallistec: WPsites: what's the recipe using the data for? You can rescue the 404, but then you're probably missing data the recipe expects to exist
[2012-12-09 00:33:18 -0500] WPsites: The recipe tries to get the data from attributes right after it does this search
[2012-12-09 00:33:56 -0500] WPsites: so if I can rescue the 404 then the rest should take care of the data that is set in the role attributes
[2012-12-09 00:36:19 -0500] kallistec: WPsites: okay, if that's what you want: http://www.rubycentral.com/pickaxe/tut_exceptions.html (old, but should still be good)
[2012-12-09 00:44:52 -0500] WPsites: how are you even meant to deal with data bags that don't exist?
[2012-12-09 00:45:06 -0500] WPsites: do you check a data bag exists before you do a search or something?
[2012-12-09 00:50:06 -0500] kallistec: WPsites: if your recipe needs data bags to work, then you just fail if they're not there
[2012-12-09 00:50:53 -0500] WPsites: yes maybe easier just to make a note that it's required and move on!
[2012-12-09 00:52:07 -0500] kallistec: adding a rescue can still be helpful if you can add more information to the eventual error message
[2012-12-09 00:53:15 -0500] WPsites: it is still coming up with the error. Is this because the index or whatever on the server still needs to update?
[2012-12-09 00:54:44 -0500] WPsites: or is it because the data bag is empty?
[2012-12-09 00:54:50 -0500] WPsites: it is definitely created now
[2012-12-09 00:55:29 -0500] kallistec: WPsites: I gotta run, but I think it should work if the bag is there but empty. Worth trying to create an item in it.
[2012-12-09 00:55:50 -0500] WPsites: ok thanks for you help
[2012-12-09 01:55:44 -0500] aalmenar: hi
[2012-12-09 01:56:59 -0500] aalmenar: -something is bugging me about template location
[2012-12-09 01:57:06 -0500] aalmenar: can anyone help ?
[2012-12-09 02:01:15 -0500] aalmenar: is there any way of indicating to get the template for debian version 6
[2012-12-09 02:01:24 -0500] aalmenar: i mean no 6.0.6
[2012-12-09 02:01:28 -0500] aalmenar: but only 6
[2012-12-09 02:02:21 -0500] aalmenar: i don't want to have to create new version directories with the same template every time debian updates their distro version
[2012-12-09 02:02:34 -0500] aalmenar: like debian6 and debian7
[2012-12-09 02:02:42 -0500] aalmenar: something like that ?
[2012-12-09 02:10:48 -0500] aalmenar: does a symlink do the job ?
[2012-12-09 03:56:35 -0500] siezer: aalmenar check out "file specificity"
[2012-12-09 11:05:50 -0500] abstrusenick: when to use data bag?
[2012-12-09 11:32:04 -0500] joonas: abstrusenick: have you looked at http://wiki.opscode.com/display/chef/Data+Bags
[2012-12-09 11:32:10 -0500] joonas: it explains what they are for
[2012-12-09 11:32:20 -0500] joonas: that should help you decide when to use them
[2012-12-09 11:41:47 -0500] WPsites: for some reason I cannot create or write to any data bags from within a recipe?
[2012-12-09 11:59:56 -0500] WPsites: does any client of chef have the capability to edit any data bag? or are some clients just read only? hence why I might not be able to create any data bags from within a recipe run on a node
[2012-12-09 12:05:33 -0500] aruntomar: WPsites: i guess, i mentioned it last time. from what i've experimented, you can create databags from recipes at runtime only if you are running the recipe on a workstation.
[2012-12-09 12:06:14 -0500] WPsites: and the same when adding an item to a data bag?
[2012-12-09 12:06:26 -0500] WPsites: so data bags are read only?
[2012-12-09 12:06:42 -0500] WPsites: I'm rebooting my chef server to see if this helps..
[2012-12-09 12:07:32 -0500] aruntomar: WPsites: you have nodes and workstations. nodes are just consumers. workstation can control chef server, so that makes logical sense that only workstation can create data bags and manipulate them.
[2012-12-09 16:50:33 -0500] cheflevelramen: Hi guys, another question for you. I have a cookbook that installs a number of yum packages and I am getting this error:
[2012-12-09 16:50:36 -0500] cheflevelramen: Yum failed - #<Process::Status: pid 5997 exit 200> - returns: ["yum-dump Locking Error! Couldn't obtain an exclusive yum lock in 10 seconds. Giving up.\n"]
[2012-12-09 16:50:59 -0500] cheflevelramen: If I rerun chef-client it makes more progress. Running it 5-6 times finally gets me through the whole thing
[2012-12-09 16:51:08 -0500] cheflevelramen: Anyway to change the yum-dump timeout?
[2012-12-09 17:34:34 -0500] rovar: hello all
[2012-12-09 17:35:40 -0500] rovar: I am new to chef and have a design question:    I really like the notion of the undeploy/uninstall part of chef.  I was wondering if there is a standard idiom by which undeploy happens?
[2012-12-09 17:36:26 -0500] rovar: e.g.  I change a role of a machine from   webserver to db..  it should run any uninstall functions/recipes for webserver, then run the install recipes for db..
[2012-12-09 17:39:53 -0500] rovar: on a different topic:  I need to deploy software that is cluster aware:  for instance:  When deploying ceph, I need to tell all of the nodes where are all of the other nodes are.  I'd rather not hardcode this if possible.
[2012-12-09 17:40:46 -0500] rovar: I won't know the destinations at recipe creation time, so I need to somehow make this information available to the installers..
[2012-12-09 17:42:51 -0500] rovar: http://wiki.opscode.com/display/chef/Configuration+Based+on+Partial+Convergence
[2012-12-09 17:43:04 -0500] kaerast: rovar, you want search for cluster-awareness - http://wiki.opscode.com/display/chef/Recipes#Recipes-Search
[2012-12-09 17:44:40 -0500] kaerast: the main problem you'd have with search being that the items won't be searchable until they've had a chef-client run
[2012-12-09 17:45:13 -0500] rovar: yea.. also.. I will have one chef-server serving multiple clusters
[2012-12-09 17:45:25 -0500] rovar: so searching for a role won't do the trick..
[2012-12-09 17:45:43 -0500] rovar: so it will need to be a custom field.. but I guess that's what data bags are fore.
[2012-12-09 17:45:45 -0500] rovar: for
[2012-12-09 17:45:47 -0500] kaerast: so have multiple roles then
[2012-12-09 17:47:56 -0500] rovar: no, those will be arbitrary..
[2012-12-09 17:49:20 -0500] rovar: I could have 1 cluster.. or 10.. and they will vary in size..  I don't really want to have roles  ceph_osd1 through coph_osdN  when the only thing that changes is its IP address..
[2012-12-09 17:49:56 -0500] rovar: but if I could make a custom data bag that stores the list under the name of a cluster.. and I could add new cluster names arbitrarily.. that would work..
[2012-12-09 17:50:05 -0500] rovar: then I'd search for my name..
[2012-12-09 17:50:13 -0500] rovar: which it would have to know somehow..
[2012-12-09 17:51:22 -0500] rovar: I could make a reverse index of ip -> name
[2012-12-09 17:51:29 -0500] rovar: which is bonkers.. but it could work..
[2012-12-09 17:51:44 -0500] kaerast: well the node will know its own hostname, so you could search for that within databags I guess
[2012-12-09 17:51:54 -0500] rovar: yea..
[2012-12-09 17:52:41 -0500] kaerast: so get, all databags with the form ceph_osd1, loop through them until you find the one you belong to, and then use that data.
[2012-12-09 17:52:51 -0500] kaerast: it seems pretty ugly though
[2012-12-09 17:53:28 -0500] kaerast: what's wrong with having roles which change often?
[2012-12-09 17:53:51 -0500] kaerast: the role wouldn't even have to do anything, just be applied to nodes in order to group them into clusters
[2012-12-09 17:54:00 -0500] rovar: well.. they won't change often.. but there will be lots of them that are almost the same thing..
[2012-12-09 17:54:11 -0500] rovar: actually.. even that is a problem.. because they won't know exactly which role to search for.
[2012-12-09 17:54:57 -0500] kaerast: they wouldn't need to know what role to search for, you'd assign them a role
[2012-12-09 17:55:17 -0500] rovar: do they know which role they are when they are running?
[2012-12-09 17:55:59 -0500] rovar: http://wiki.opscode.com/display/chef/Recipes#Recipes-Search  suggests that they find their neighbors by looking for   role::webserver
[2012-12-09 17:56:16 -0500] rovar: it would be more like   role::ceph_cluster::07
[2012-12-09 17:56:35 -0500] rovar: or  role::ceph_cluster_07
[2012-12-09 17:56:54 -0500] rovar: but if it doesn't know that its actual role is  ceph_cluster_07, then we're in the same boat
[2012-12-09 17:57:14 -0500] kaerast: I'm assuming that the node will know what role it belongs to during a chef-client run
[2012-12-09 17:57:32 -0500] rovar: I am assuming it *can* know, but I don't exactly know where to find that information..
[2012-12-09 17:58:20 -0500] kaerast: I don't actually have access to a chef-managed machine right now, but I'd assume it'll be in the ohai data
[2012-12-09 18:16:40 -0500] aalmenar: one question..
[2012-12-09 18:16:53 -0500] aalmenar: this part of documentation applies too to templates
[2012-12-09 18:16:53 -0500] aalmenar: http://docs.opscode.com/essentials_cookbook_files_specificity.html
[2012-12-09 18:17:12 -0500] aalmenar: i mean the part that says  you can use ubutnu-8
[2012-12-09 18:17:16 -0500] aalmenar: ?
[2012-12-09 18:18:03 -0500] aalmenar: http://docs.opscode.com/essentials_cookbook_templates_location_specificity.html
[2012-12-09 18:18:39 -0500] aalmenar: here does not says so, but the code to read directories is the same so same rule should apply, I'm i right ?
[2012-12-09 18:33:23 -0500] rovar: kaerast: I'm going to create new environments for each cluster and use the default_attributes of the environment to set the IPs
[2012-12-09 18:33:44 -0500] rovar: now if I could just find someone who knows about undeploy actions
[2012-12-09 18:35:17 -0500] kaerast: environments are certainly one way of handling the cluster IPs, so long as you're happy to update the default attributes whenever anything changes
[2012-12-09 18:36:30 -0500] kaerast: I'm guessing you can't just spin up a new virtual/cloud machine rather than go through the pain of undeploying things?
[2012-12-09 18:40:44 -0500] rovar: kaerast:  I can at the moment.. but in the future, we plan to deploy to bare metal as well..
[2012-12-09 18:43:29 -0500] rovar: heh
[2012-12-09 18:43:52 -0500] rovar: if I could get the IO characteristics out of vm that I could out of bare metal I'd be in agreement :)
[2012-12-09 18:50:03 -0500] kaerast: that's what a SAN is for
[2012-12-09 18:50:29 -0500] kaerast: though granted our storage costs are now in the region of $100 / GB for anything on our SAN
[2012-12-09 19:00:01 -0500] rovar: 100/GB isn't bad.. we're at about $600
[2012-12-09 19:00:20 -0500] rovar: but VM -> SAN round trips are much too slow
[2012-12-09 20:16:17 -0500] masterkorp: http://i.imgur.com/qkzWJ.jpg
[2012-12-09 20:16:19 -0500] masterkorp: err
[2012-12-09 20:30:15 -0500] ssd7: :)
[2012-12-09 21:17:58 -0500] gyre008: I have a question about cookbook versions Cheffers...when I upload multiple versions of cookbook to my Chef server...how do I tell it to use particular Chef version on the node ?
[2012-12-09 21:18:09 -0500] gyre008: particular cookbook version*
[2012-12-09 21:18:13 -0500] gyre008: not Chef version :)
[2012-12-09 21:20:55 -0500] kaerast: gyre008, you can set versions in run_lists and environments - http://docs.opscode.com/essentials_cookbook_versions.html
[2012-12-09 21:21:31 -0500] gyre008: awesome kaerast! rhanks
[2012-12-09 21:21:37 -0500] gyre008: damn...*thanks :)
[2012-12-09 23:18:59 -0500] githubble: hi, I want to roll out ununtu boxes on AWS with my chef....what is the best way to do this... thanks in advance
[2012-12-09 23:21:19 -0500] coderanger: githubble: knife ec2 server create; doneburger
[2012-12-09 23:21:56 -0500] githubble: coderanger .... however you need the AWS key credentials in your knife.rb file correct?
[2012-12-09 23:23:06 -0500] coderanger: Sure, one way or another, I keep mine in env variables
[2012-12-09 23:23:55 -0500] Virunga: Could you tell me why after the JsonFile handler is executed the rows of configuration of the handlers in client.rb are erased?
[2012-12-09 23:24:53 -0500] Virunga: Each time i have to rewrite require 'chef/handler/json_file'
[2012-12-09 23:24:59 -0500] githubble: coderanger if I amend my knife.rb is the syntax knife[:keyid] or knife:[keyid] ?
[2012-12-09 23:24:59 -0500] Virunga: report_handlers << ....
[2012-12-09 23:25:01 -0500] Virunga: etc
[2012-12-09 23:25:42 -0500] coderanger: githubble: knife[:foo], :foo is a ruby symbol
[2012-12-09 23:25:50 -0500] coderanger: githubble: Similar to 'foo in Lisp-land
[2012-12-09 23:26:10 -0500] githubble: coderanger newbie ish here
[2012-12-09 23:29:58 -0500] githubble: coderanger getting timeouts when running sudo gem install knife-ec2 ... :(
[2012-12-09 23:30:19 -0500] coderanger: Make sure your network isn't blocking things?
[2012-12-09 23:30:52 -0500] coderanger: That isn't related to chef, either means rubygems is having a dirtnap again, or something is wrong with your network et al
[2012-12-09 23:32:20 -0500] githubble: coderanger ... libxml2 is missing
[2012-12-09 23:33:13 -0500] coderanger: What OS are you on?
[2012-12-09 23:33:18 -0500] githubble: ubuntu
[2012-12-09 23:36:39 -0500] githubble: coderanger .... trying ... sudo gem install knife-ec2 --no-rdoc --no-ri --verbose
[2012-12-09 23:37:13 -0500] githubble: coderanger ... seems to be more successful than sudo gem install knife-ec2
[2012-12-09 23:41:46 -0500] githubble: coderanger ... I am using hosted-chef .. is this the reason it is failing?
[2012-12-09 23:41:59 -0500] coderanger: No, like I said, we have nothing to do with rubygems
[2012-12-09 23:42:14 -0500] coderanger: rubygems is the Ruby packaging system, if you need to install libxml, then install lixml
[2012-12-09 23:52:11 -0500] ashp: hmm, is the run list executed in order?  As a heavy puppet user I tend to do a lot of require => Class[x] and so forth to handle dependencies, as well as calling defines in other modules to set things up, just trying to work out how that looks in chef.
[2012-12-09 23:53:09 -0500] coderanger: ashp: Yes
[2012-12-09 23:53:20 -0500] coderanger: In order, including the recursive expansion
[2012-12-09 23:54:02 -0500] ashp: ah ok, I'll have to figure out how you reorder things in time, I've only gotten as far as making a role that includes nginx
[2012-12-09 23:54:16 -0500] ashp: I haven't got as far as working out how to have multiple roles that use nginx and so forth
[2012-12-09 23:55:03 -0500] coderanger: Just debounced, so if a given recipe or role has been seen before during an expansion it is skipped
[2012-12-09 23:55:47 -0500] ashp: ahhh, interesting, ok
[2012-12-09 23:56:12 -0500] ashp: i'm just doing some on the side experimentation, I've been using puppet heavily for 5 years now so it's nice to stretch and try something different
[2012-12-09 23:56:27 -0500] ashp: hard to work out how to transfer all my concepts so far, but hopefully that'll come in time
