[2012-04-13 00:01:26 -0400] issackelly: miah: New job, need outlook to do some calendar junk, mostly I get by without it
[2012-04-13 00:01:53 -0400] issackelly: last time I had an office installed it was office 2003
[2012-04-13 00:10:21 -0400] issackelly: yay! bootstrapped my virtual machine! it works and crap!
[2012-04-13 00:10:27 -0400] issackelly: thanks noah
[2012-04-13 00:11:29 -0400] coderanger: issackelly: No prob
[2012-04-13 00:11:40 -0400] coderanger: issackelly: You still living in PA?
[2012-04-13 00:11:45 -0400] issackelly: I am
[2012-04-13 00:11:53 -0400] issackelly: we should get together soon
[2012-04-13 00:12:19 -0400] issackelly: you're still coming up to the dojo for work?  maybe dinner some day in MV
[2012-04-13 00:12:38 -0400] coderanger: Nah, working from my house now, but dinner still sounds good :)
[2012-04-13 00:12:53 -0400] issackelly: yeah, MV is still in the middle then
[2012-04-13 00:15:06 -0400] issackelly: can I migrate from hosted by opscode to self-hosted?
[2012-04-13 00:15:33 -0400] issackelly: I don't really want to, but it's a question I'll probably have to answer
[2012-04-13 00:15:59 -0400] coderanger: Yes
[2012-04-13 00:16:13 -0400] coderanger: The only feature in Hosted that isn't in FOSS is the ACLs
[2012-04-13 00:16:36 -0400] coderanger: (because they are crazy complex and wouldn't be easy to port to the FOSS server)
[2012-04-13 00:16:59 -0400] coderanger: Other than that, its all exactly the same
[2012-04-13 00:19:08 -0400] timsmith: coderanger:  I saw the UI was ported to rails.  Any chance we're going to see some improvements also?
[2012-04-13 00:20:04 -0400] issackelly: coderanger -- what about data? easy to import/export?
[2012-04-13 00:20:30 -0400] coderanger: timsmith: Yep, a port of the FOSS UI to rails is in progress last I heard
[2012-04-13 00:21:01 -0400] coderanger: issackelly: Most of your data lives in git, all you need to copy really is node data, knife node show -Fjson :)
[2012-04-13 00:21:04 -0400] coderanger: (or use PyChef)
[2012-04-13 00:21:18 -0400] issackelly: very cool. thanks
[2012-04-13 00:22:27 -0400] cwj: issackelly: you might find spiceweasel helpful in generating the commands needed to restore your chef repo to a new chef server
[2012-04-13 00:22:29 -0400] cwj: http://wiki.opscode.com/display/chef/Spiceweasel
[2012-04-13 00:22:58 -0400] issackelly: cwj bookmarked, thanks
[2012-04-13 00:23:18 -0400] tarrant: Why can't the ifconfig resource be used to add vips to lo?
[2012-04-13 00:27:06 -0400] cwj: what happens when you try to do it?
[2012-04-13 00:28:24 -0400] tarrant: The source says unless device == "lo" so it just skips the resource block.
[2012-04-13 00:30:04 -0400] cwj: ah i see
[2012-04-13 00:30:06 -0400] tarrant: Looking more at the resource I'm fairly sure this is because it doesn't add the IP as "lo:1", "lo:2" and would set it to "lo". Which has to be 127.0.0.1
[2012-04-13 00:58:37 -0400] yfeldblum: possibly because the spec says the loopback device already has the entire 127.0.0.0/8 network, and any other address is not valid for the loopback address?
[2012-04-13 00:59:54 -0400] yfeldblum: try `ping 127.152.33.98`
[2012-04-13 01:36:53 -0400] mhalligan: What would make a node's run_list lose it's roles and run_list when it runs chef-client?
[2012-04-13 01:38:22 -0400] cwj: mhalligan: i know that happens if you use knife to bootstrap a node and the first run fails
[2012-04-13 01:38:30 -0400] mhalligan: cwj: yeah, that's the scenario I'm in
[2012-04-13 01:38:40 -0400] mhalligan: that's a feature?
[2012-04-13 01:38:55 -0400] cwj: not sure if  it is considered such
[2012-04-13 01:38:57 -0400] mhalligan: or rather, expected behavior?
[2012-04-13 01:39:20 -0400] cwj: dunno but it is irritating sometimes
[2012-04-13 01:39:52 -0400] mhalligan: +1
[2012-04-13 01:40:07 -0400] cwj: i think the way knife kicks off the chef run means that the node run_list hasnt actually been saved to the chef server yet
[2012-04-13 01:40:11 -0400] mhalligan: especially when rackspace keeps throttling my api requests :/
[2012-04-13 01:40:16 -0400] mhalligan: oh interesting that makes sense
[2012-04-13 01:40:37 -0400] cwj: maybe if you node.save in a recipe early in the run?
[2012-04-13 01:41:15 -0400] timsmith1: add a node save at the top
[2012-04-13 01:41:35 -0400] timsmith1: we do it to solve first run failures wiping out runlists
[2012-04-13 01:42:31 -0400] mhalligan: that sounds reasonable. I've got a puppet background where I'm used to order of application being kind of random. Where would I put that? in the first recipe that gets applied I'm guessing?
[2012-04-13 01:42:46 -0400] timsmith1: first recipe
[2012-04-13 01:43:17 -0400] mhalligan: cool thanks :)
[2012-04-13 01:43:26 -0400] mhalligan: deterministic order is nice
[2012-04-13 01:45:28 -0400] timsmith1: yep
[2012-04-13 02:00:12 -0400] mhalligan: in http://wiki.opscode.com/display/chef/Resources#Resources-User where it says "he supports attribute accepts a Mash" .. is that a typo or is a Mash something I don't know about?
[2012-04-13 02:05:51 -0400] jtgiri_: Hey guys, I was wondering how guys manage knife.rb for multiple chef servers /
[2012-04-13 02:05:57 -0400] cwj: mhalligan: not a typo
[2012-04-13 02:06:15 -0400] cwj: https://github.com/opscode/chef/blob/master/chef/lib/chef/mash.rb
[2012-04-13 02:06:41 -0400] cwj: # This class has dubious semantics and we only have it so that people can write
[2012-04-13 02:06:41 -0400] cwj: # params[:key] instead of params['key'].
[2012-04-13 02:06:44 -0400] cwj: heheh
[2012-04-13 02:06:57 -0400] coderanger: It is a term from ActiveSupport that has infected the Ruby community, it is useful at times though :)
[2012-04-13 02:07:18 -0400] coderanger: There is also Dash, Trash, and Clash from Hashie :)
[2012-04-13 02:07:37 -0400] coderanger: jtgiri_: Different folders with different .chef dirs usually
[2012-04-13 02:07:54 -0400] coderanger: jtgiri_: Knife scans back up the folder tree looking for the nearest .chef
[2012-04-13 02:07:56 -0400] jtgiri_: Cool , I just found something as well : http://os.greenandsecure.co.uk/2012/03/using-multiple-chef-servers-with-knife/
[2012-04-13 02:08:05 -0400] coderanger: So put it at the base of the project usually
[2012-04-13 02:09:05 -0400] coderanger: Also check out https://gist.github.com/710473
[2012-04-13 02:09:26 -0400] z: jtgiri_: that is proffalken and his new blog
[2012-04-13 02:09:58 -0400] jtgiri_: Cool - thanks guys
[2012-04-13 02:10:10 -0400] z: coderanger: knife block is actually kinda "handy" :)
[2012-04-13 02:10:42 -0400] coderanger: z: Chef: Because Google is too easy otherwise
[2012-04-13 02:11:18 -0400] mattray: I noticed yesterday google seems to index our ticketing about every hour
[2012-04-13 02:12:18 -0400] mattray: things like knife_rackspace-37 came up immediately
[2012-04-13 02:13:06 -0400] z: sneaky
[2012-04-13 02:14:17 -0400] coderanger: mattray: They are good at detecting pages that change frequently
[2012-04-13 02:25:42 -0400] patcon: coderanger mattray thanks for the retweet guys :)
[2012-04-13 02:26:03 -0400] patcon: and now, to start digginf into mixlib-auth
[2012-04-13 02:29:26 -0400] jtimberman: mhalligan: its a design feature. chef doesn't save the node data to the chef server if the run fails (first or any) because chef doesn't assume that saving the node is "safe"; a half / partially configured system is "broken"
[2012-04-13 02:32:03 -0400] coderanger: patcon: You shouldn't need to touch it
[2012-04-13 02:32:11 -0400] coderanger: patcon: The PHP classes I posted take care of that
[2012-04-13 02:32:42 -0400] coderanger: jtimberman mhalligan: You can also override that with an error handler that consists only of "node.save"
[2012-04-13 02:32:47 -0400] jtimberman: patcon: are you implementing php client library for the Chef Server API?
[2012-04-13 02:32:58 -0400] jtimberman: coderanger: good point :)
[2012-04-13 02:33:44 -0400] patcon: coderanger: sorry, wasn't clear, just for comparisons sake. I'm still very much learning, so the more implementations I can compare, the better
[2012-04-13 02:35:21 -0400] patcon: jtimberman: it'll be a learning adventure, that's for sure
[2012-04-13 02:35:38 -0400] jtimberman: patcon: that's awesome :D
[2012-04-13 02:35:51 -0400] jtimberman: more language API access is great.
[2012-04-13 02:36:44 -0400] patcon: jtimberman: as you may have guessed, I am reluctant verbally :) seems people who know their shiz make client libs, but i'll take a stab!
[2012-04-13 02:36:57 -0400] patcon: *reluctant to commit verbally
[2012-04-13 02:45:42 -0400] coderanger: patcon: I assure you, I barely knew how to use chef when I started :)
[2012-04-13 02:45:53 -0400] patcon: wahoo!
[2012-04-13 02:46:06 -0400] patcon: hope shines!
[2012-04-13 02:46:56 -0400] hoover_damn: from him? sheesh
[2012-04-13 02:47:03 -0400] hoover_damn: j/k
[2012-04-13 02:47:24 -0400] hoover_damn: patcon, expect your adventure of learning chef to take about 6months before you get really comfortable
[2012-04-13 02:47:48 -0400] hoover_damn: patcon, some people get comformatble sooner but most people start becoming proficient and the ideas click a lot easier and ... you basically produce more work in time
[2012-04-13 02:48:00 -0400] hoover_damn: as you find your grove, you have a base set of cookbooks that you share and re-use
[2012-04-13 02:48:09 -0400] hoover_damn: and you become comfortable
[2012-04-13 02:48:11 -0400] hoover_damn: s/grove/groove
[2012-04-13 02:48:18 -0400] miah: i've been using chef for about 10 months and i'm pretty comfy. still lots to learn though =)
[2012-04-13 02:48:48 -0400] hoover_damn: your also solo which makes it harder
[2012-04-13 02:48:59 -0400] hoover_damn: only opscode people can really beet me
[2012-04-13 02:49:05 -0400] hoover_damn: for date
[2012-04-13 02:49:12 -0400] hoover_damn: and i mean like the first
[2012-04-13 02:49:35 -0400] hoover_damn: funny how I got to use 0.6.0.0.2 for eons
[2012-04-13 02:49:49 -0400] z: did you upgrade yet?
[2012-04-13 02:50:06 -0400] miah: lol
[2012-04-13 02:50:20 -0400] hoover_damn: no
[2012-04-13 02:50:46 -0400] hoover_damn: that company still runs 0.6.0.0.2 to the best of my knowledge
[2012-04-13 02:50:59 -0400] hoover_damn: it'll be hard for em to upgrade
[2012-04-13 02:51:19 -0400] hoover_damn: z, actually I was one of the first 0.8 users before it hit beta..
[2012-04-13 02:51:36 -0400] hoover_damn: z, there was a handfull of us :)
[2012-04-13 02:52:00 -0400] z: I was married to Puppet until around May 2010
[2012-04-13 02:52:12 -0400] z: It ended in a sticky divorce, she took the house and kids
[2012-04-13 02:52:51 -0400] coderanger: Sure, but it was effectively an internal fork
[2012-04-13 02:53:07 -0400] coderanger: (EY's 0.6 shit)
[2012-04-13 02:53:22 -0400] z: Only lasted about 2 years too, prior to that I was with CFengine. Man she was ugly, but wow, it wasn't like you could mail order a hawt CM system in those days
[2012-04-13 02:53:39 -0400] miah: lol
[2012-04-13 02:53:46 -0400] miah: i got started with cfengine as well
[2012-04-13 02:53:53 -0400] miah: (and then a short affair with puppet)
[2012-04-13 02:54:37 -0400] z: I could learn from miah it seems. Dating them is obviously better than marrying them.
[2012-04-13 02:55:01 -0400] miah: i find it strange that people would still build a environment around kickstart with a boatload of shitty shell scripts
[2012-04-13 02:55:38 -0400] miah: i always wanted to vomit when dealing with this huge subversion repository that had no branches and it was all scripts for kickstart and jumpstart
[2012-04-13 02:55:47 -0400] miah: nobody wrote scripts that caught or handled errors
[2012-04-13 02:56:17 -0400] z: coderanger: HP CMU? ;)
[2012-04-13 02:56:17 -0400] miah: your only hope was digging through /tmp/install.txt and hope that the person didn't redirect stdout/err to /dev/null
[2012-04-13 02:56:43 -0400] coderanger: z: RocksLinux mostly
[2012-04-13 02:57:05 -0400] mattray: z: based on this analogy, I'm concerned what "rolling your own solution" ends up as
[2012-04-13 02:57:13 -0400] miah: i think spheromak is the closest i've had to a mentor all these years. i remember discussing 'golden image' systems with him years ago
[2012-04-13 02:57:34 -0400] z: mattray: Thats illegal in most states. Marrying your own daughter.
[2012-04-13 02:57:35 -0400] miah: i've seen some really bad 'rolled solutions'
[2012-04-13 02:58:06 -0400] z: mattray: I hear that some states in the US may "overlook" such 'close' relationships.
[2012-04-13 02:58:28 -0400] z: mattray: But IMO the gene pool needs diversification. Rolling your own is baaaaaaaaaad.
[2012-04-13 02:58:41 -0400] miah: actually. you can marry your cousin in more states than you can marry your partner of choice
[2012-04-13 02:58:45 -0400] miah: so...
[2012-04-13 02:59:15 -0400] miah: hah
[2012-04-13 02:59:16 -0400] mattray: oh dear.
[2012-04-13 02:59:22 -0400] z: Everything gotta be a 'stack, yo!
[2012-04-13 02:59:31 -0400] mattray: so glad we started logging this channel
[2012-04-13 02:59:41 -0400] UForgotten: lol
[2012-04-13 02:59:46 -0400] hoover_damn: coderanger, EY forked Chef because they wanted a bugfix 2 days before you released
[2012-04-13 02:59:50 -0400] hoover_damn: coderanger, just fwiw
[2012-04-13 02:59:53 -0400] miah: dinner
[2012-04-13 03:00:11 -0400] coderanger: hoover_damn: Pretty sure I was still writing game patchers back then, so its all greek to me :)
[2012-04-13 03:00:15 -0400] hoover_damn: their 0.6.0.0.2 is the same as opscode's 0.6.2
[2012-04-13 03:00:18 -0400] z: mattray: Ah yes, community.opscode.com does indeed log. Oh well. I'm sure the great Google has seen me joke around about worse ;)
[2012-04-13 03:00:28 -0400] hoover_damn: main reason of the fork was the solo'ism i bet
[2012-04-13 03:00:40 -0400] hoover_damn: but they shoulda moved off the fork before production
[2012-04-13 03:00:41 -0400] hoover_damn: imo
[2012-04-13 03:01:12 -0400] hoover_damn: z, i log too
[2012-04-13 03:01:18 -0400] hoover_damn: z, and have since more or less the beginning of irc
[2012-04-13 03:01:23 -0400] hoover_damn: z, http://logs.likens.us
[2012-04-13 03:01:25 -0400] hoover_damn: z, enjoy
[2012-04-13 03:01:31 -0400] hoover_damn: s/irc/chef
[2012-04-13 03:03:07 -0400] coderanger: hoover_damn: Yeah, I started ingesting them into our system and gave up after it would seg fault 4 hours into the import
[2012-04-13 03:03:16 -0400] coderanger: I loaded back to start of the year
[2012-04-13 03:03:38 -0400] hoover_damn: coderanger, heh anything particular in the logs that it segfaulted on?
[2012-04-13 03:04:22 -0400] coderanger: No, just ruby sucking at life
[2012-04-13 03:06:19 -0400] jtimberman: mattray: lulz (logging)
[2012-04-13 03:06:27 -0400] patcon: hoover_damn: i've been in and out of chef for almost a year -- it's the lack of OO and comp-sci foundational stuff that give's me the inferiority complex :)
[2012-04-13 03:07:10 -0400] patcon: haha oh man. catching up. missed a soul-baring chef convo
[2012-04-13 03:07:16 -0400] jtimberman: hoover_damn: yeah, its rather amusing, chef-solo functionality is not that particularly different in essence.
[2012-04-13 03:07:39 -0400] jtimberman: pretty sure there aren't any "breaking" changes between 0.6 -> 0.10 for solo-only use.
[2012-04-13 03:07:46 -0400] hoover_damn: Quote for the night: Always be mindful of the kindness and not the faults of others. <-- not from me
[2012-04-13 03:07:47 -0400] jtimberman: but i haven't confirmed
[2012-04-13 03:07:52 -0400] hoover_damn: jtimberman, there is
[2012-04-13 03:08:04 -0400] hoover_damn: jtimberman, but it's more in the syntax changes that have grown up
[2012-04-13 03:08:04 -0400] jtimberman: maybe attribute stuff
[2012-04-13 03:08:24 -0400] hoover_damn: jtimberman, slight formatting, and other stuff
[2012-04-13 03:08:45 -0400] hoover_damn: anywho /me &
[2012-04-13 03:09:18 -0400] patcon: haha soul-baring, aaaand now i'm at the incest. lordy lordy hah
[2012-04-13 03:09:50 -0400] mhalligan: ever see /var/chef/cache/chef-stacktrace.out
[2012-04-13 03:09:50 -0400] mhalligan:  before?
[2012-04-13 03:09:53 -0400] tarrant: yfeldblum: Sorry few hours late responding to your message. There are cases where non 127.0.0.0/8 address need to be bound to a loopback. One example is Direct Server Return (dsr) a routing method commonly used when load balancing large file delivery.
[2012-04-13 03:10:05 -0400] mhalligan: (the gem is installed)
[2012-04-13 03:10:06 -0400] mhalligan: err
[2012-04-13 03:10:18 -0400] mhalligan: Chef::Exceptions::MissingLibrary: user[mhalligan] (dnsworks::users line 13) had an error: Chef::Exceptions::MissingLibrary: You must have ruby-shadow installed for password support!
[2012-04-13 03:10:48 -0400] jtimberman: mhalligan: ruby 1.9?
[2012-04-13 03:11:14 -0400] mhalligan: 1.8.7
[2012-04-13 03:11:39 -0400] jtimberman: i've not seen that happen with chef running under 1.8.7, only 1.9, since 1.9 removed shadow from the stdlib
[2012-04-13 03:11:41 -0400] mhalligan: I'm kind of confused why a gem required for base functionality doesn't get installed when chef is installed
[2012-04-13 03:12:20 -0400] jtimberman: who sets passwords for users anymore? nopasswd sudo and ssh logins w/ only keys :D
[2012-04-13 03:12:29 -0400] pcn: Anyone having issues with ec2 instances not logging you in at the moment
[2012-04-13 03:12:29 -0400] mhalligan: damn. and I ran chef-client again a few times and now it worked.
[2012-04-13 03:12:33 -0400] mhalligan: it's like being on puppet
[2012-04-13 03:12:39 -0400] mhalligan: jtimberman: :/
[2012-04-13 03:13:44 -0400] jtimberman: mhalligan: :(
[2012-04-13 03:13:58 -0400] jtimberman: there's a bug somewhere.
[2012-04-13 03:14:08 -0400] pcn: jtimberman kerberos, better than keys
[2012-04-13 03:14:37 -0400] jtimberman: if you do ruby -rshadow -e 'puts true'
[2012-04-13 03:15:07 -0400] mhalligan:  hrm. error.
[2012-04-13 03:15:09 -0400] mhalligan: yet it's installed
[2012-04-13 03:15:23 -0400] jtimberman: pcn: i have emotional scars from kerberos (on aix)
[2012-04-13 03:15:34 -0400] pcn: aix leaves scars
[2012-04-13 03:15:52 -0400] jtimberman: mhalligan: ruby -v
[2012-04-13 03:16:51 -0400] jtimberman: mhalligan: ;)
[2012-04-13 03:17:20 -0400] mhalligan: ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]
[2012-04-13 03:17:38 -0400] jtimberman: and is chef installed as a gem or package and using that same ruby?
[2012-04-13 03:17:48 -0400] jtimberman: you shouldn't need ruby-shadow gem installed on ruby 1.8.7.
[2012-04-13 03:18:02 -0400] mhalligan: err I don't know, I used your bootstrap script
[2012-04-13 03:18:03 -0400] mhalligan: let me check
[2012-04-13 03:18:09 -0400] mhalligan: gem
[2012-04-13 03:18:22 -0400] jtimberman: wait. wtf.
[2012-04-13 03:18:42 -0400] mhalligan: ubuntu 10.04
[2012-04-13 03:18:45 -0400] pcn: 1.8.7 system ruby on ubuntu does bomb out w/o ruby-shadow IIRC
[2012-04-13 03:18:47 -0400] mhalligan: I think I'm using the image you pointed at
[2012-04-13 03:19:01 -0400] mhalligan: or rather the image in the quickstart guide
[2012-04-13 03:19:20 -0400] jtimberman: fffffffuuuuuuuuuu
[2012-04-13 03:19:23 -0400] jtimberman: libshadow-ruby1.8
[2012-04-13 03:19:26 -0400] jtimberman: install that
[2012-04-13 03:19:28 -0400] jtimberman: package
[2012-04-13 03:19:52 -0400] mhalligan: dear ruby, did we really need a second package manager? *kicks shit*
[2012-04-13 03:20:08 -0400] jtimberman: aww, of course we did. every language needs their own ;)
[2012-04-13 03:20:31 -0400] jtimberman: but the annoyance (to me) is that its a separate package on ubuntu
[2012-04-13 03:20:39 -0400] mhalligan: 20 years of doing this and package management still sucks
[2012-04-13 03:21:11 -0400] pcn: c'mon.  20 years ago you would have given your left nut for what we've got now
[2012-04-13 03:21:19 -0400] pcn: sunos 4 "packages"?
[2012-04-13 03:22:07 -0400] jtimberman: mhalligan: yeah. monitoringsucks ain't got nothin' on packagingsucks
[2012-04-13 03:22:29 -0400] jtimberman: i do like archlinux's package format.
[2012-04-13 03:22:34 -0400] jtimberman: the package manager, etc.
[2012-04-13 03:22:44 -0400] jtimberman: rolling release distro, not so much
[2012-04-13 03:22:57 -0400] z: jtimberman: Hallelujah brother, and here is the joke, IPS was actually pretty reasonable
[2012-04-13 03:23:00 -0400] z: jtimberman: http://hub.opensolaris.org/bin/view/Project+pkg/
[2012-04-13 03:23:28 -0400] z: jtimberman: Problem is so many people are opinionated, even a "re-take" on packaging got no traction
[2012-04-13 03:24:23 -0400] jtimberman: z: totally.
[2012-04-13 03:24:29 -0400] jtimberman: z: its such a bikeshed.
[2012-04-13 03:24:44 -0400] jtimberman: and "your wheel isn't *round* enough, man"
[2012-04-13 03:25:07 -0400] z: jtimberman: http://mybadco.com/images/MonkeySplash3.jpg
[2012-04-13 03:25:08 -0400] jtimberman: the actual differences between package managers is *really* minor. some syntax here, some metadata there, it is essentially all the same shit.
[2012-04-13 03:25:53 -0400] jtimberman: i'm intrigued by "pkgng" in freebsd, but i haven't shaved the yak of getting a freebsd system set up to play with :)
[2012-04-13 03:26:13 -0400] z: until they fix partitioning and installer
[2012-04-13 03:26:19 -0400] z: they can have pkgWOW and I won't care
[2012-04-13 03:26:54 -0400] z: Dear FreeBSD: It is now 2012 and your installer still looks like it is the 1980s. Even FreeBSD 9.0 is only a moderate improvement. Please to be fixing. kThxBai, -z
[2012-04-13 03:27:19 -0400] jtimberman: meh, the installer i don't care so much about.
[2012-04-13 03:59:00 -0400] bemu: Anyone have experience troubleshooting why Tq's are high in haproxy logs?
[2012-04-13 04:16:36 -0400] mhalligan: ok this is weird
[2012-04-13 04:16:47 -0400] mhalligan: I'm using an entirely vanilla nagios setup using the nagios cookbook
[2012-04-13 04:16:56 -0400] mhalligan: all of a sudden chef decided it was going to uninstall nrpe
[2012-04-13 04:17:11 -0400] mhalligan: :(
[2012-04-13 04:17:19 -0400] jtimberman: uninstall?
[2012-04-13 04:18:34 -0400] mhalligan: wtf and ohai no longer shows the cloud and rackspace attributes
[2012-04-13 04:19:49 -0400] jtimberman: that is an unfortunate, known bug.
[2012-04-13 04:20:08 -0400] jtimberman: one moment
[2012-04-13 04:20:37 -0400] jtimberman: mhalligan: http://tickets.opscode.com/browse/OHAI-267
[2012-04-13 04:22:05 -0400] mhalligan: :(
[2012-04-13 04:22:48 -0400] mhalligan: is there another reliable fact for getting the internal IP address?
[2012-04-13 04:24:04 -0400] jtimberman: mhalligan: depends - does rackspace cloud have reliable interfaces on which the internal IP will be? like, will it always be eth0?
[2012-04-13 04:24:09 -0400] mhalligan: it will always be eth1
[2012-04-13 04:24:24 -0400] jtimberman: if so, you can use node['network']['interfaces']['eth1']
[2012-04-13 04:24:40 -0400] mhalligan: that doesn't give me an ip
[2012-04-13 04:24:43 -0400] mhalligan: that gives me a hash of stuff
[2012-04-13 04:24:45 -0400] jtimberman: oh
[2012-04-13 04:24:57 -0400] mhalligan: man this is jacked
[2012-04-13 04:25:01 -0400] mhalligan: the IP is the key
[2012-04-13 04:25:13 -0400] mhalligan: which is whay I was using the special rackspace stuff
[2012-04-13 04:25:52 -0400] mhalligan: I guess I can try [network][interfaces][eth1][addresses][2] and hope stuff doesn't break
[2012-04-13 04:25:52 -0400] mhalligan: :(
[2012-04-13 04:28:03 -0400] jtimberman: yeah
[2012-04-13 04:28:05 -0400] jtimberman: https://gist.github.com/1040853
[2012-04-13 04:28:11 -0400] jtimberman: i wrote that plugin awhile back
[2012-04-13 04:28:17 -0400] jtimberman: it might be helpful
[2012-04-13 04:29:54 -0400] mhalligan: thanks I'll goof around with that
[2012-04-13 04:31:41 -0400] mhalligan: man the thunder is shaking my apartment
[2012-04-13 04:33:03 -0400] jtimberman: hehehehe. we had a thunderstorm last night. common tho
[2012-04-13 04:33:17 -0400] mhalligan: jtimberman: could you look at https://gist.github.com/ea02a90ba51695e712a5 and tell me if I'm doing anything incredibly stupid?
[2012-04-13 04:33:32 -0400] mhalligan: no matter what it bombs out with NoMethodError: undefined method `[]' for nil:NilClass
[2012-04-13 04:34:22 -0400] jtimberman: the stacktrace.out file should say which line in the recipe
[2012-04-13 04:35:20 -0400] mhalligan: yeah it complains about line       if host[:rackspace][:private_ip]
[2012-04-13 04:40:54 -0400] mhalligan: oh hrm I think I figured out the problem
[2012-04-13 04:40:58 -0400] mhalligan: hosts = search(:node, "*:*") fails randomly
[2012-04-13 04:41:39 -0400] jtimberman: well
[2012-04-13 04:43:00 -0400] mhalligan: should I be able to run include_recipe "djbdns::server" from shef -z? I get NoMethodError: undefined method `include_recipe' for #<Object:0x7fb93a4f92a0>
[2012-04-13 04:43:00 -0400] mhalligan:  when I try
[2012-04-13 04:45:15 -0400] miah: you need to load the recipe first iirc
[2012-04-13 04:47:52 -0400] jtimberman: mhalligan: https://gist.github.com/010568fb79d4f831e06f
[2012-04-13 04:48:16 -0400] jtimberman: mhalligan: what miah said, you'll need to enter recipe context.
[2012-04-13 04:48:21 -0400] jtimberman: "recipe" will take you there
[2012-04-13 05:08:46 -0400] mhalligan: brownouts are neat.
[2012-04-13 05:11:18 -0400] miah: weeklong outages are fun
[2012-04-13 05:11:53 -0400] miah: when i lived in texas, a hurricane resulted in some epic freezer thawing bbqs in our culdesac
[2012-04-13 05:13:58 -0400] jtimberman: miah: "cook all this meat or it goes bad."
[2012-04-13 05:14:08 -0400] jtimberman: miah: and texans have a lot of meat.
[2012-04-13 05:14:11 -0400] jtimberman: :)
[2012-04-13 05:14:18 -0400] jtimberman: what with all the chili and bbq.
[2012-04-13 05:14:18 -0400] miah: yes
[2012-04-13 05:16:35 -0400] miah: yup. we had good eats for a few days. but no power gets brutal after a few days, just because houses get so dark
[2012-04-13 05:20:15 -0400] mhalligan: when I see a line like: INFO: Removing cookbooks/ohai/files/default/plugins/network_addr.rb from the cache; it is no longer needed by chef-client.
[2012-04-13 05:20:20 -0400] mhalligan: does that mean it's done it's job and it's being deleted
[2012-04-13 05:20:34 -0400] mhalligan: or does that mean chef has decided I don't deserve to use network_addr because I forgot to do my laundry?
[2012-04-13 05:22:00 -0400] mhalligan: I'm thinking it's the latter
[2012-04-13 05:24:49 -0400] mhalligan: ah it's the order the ohai plugin goes in
[2012-04-13 05:26:39 -0400] mhalligan: man weirdity after weirdity. fqdn takes a hostname like michael-sucks-atruby.uptoolate.com and turns it into -sucks-atruby.uptoolate.com
[2012-04-13 05:27:44 -0400] mhalligan: hostname -f fail
[2012-04-13 05:28:07 -0400] bullardo: ha
[2012-04-13 05:28:47 -0400] bullardo: anyone going to chefconf?
[2012-04-13 05:29:04 -0400] bullardo: im trying to get my company to pay
[2012-04-13 05:32:11 -0400] miah: me toos
[2012-04-13 05:33:24 -0400] bullardo: so tired of explaing cloud stuff to sales and marketing.
[2012-04-13 05:33:27 -0400] coderanger: miah: You are close enough that you know we would shanghai you if you didn't :P
[2012-04-13 05:33:47 -0400] miah: ya
[2012-04-13 05:33:55 -0400] coderanger: bullardo: "The cloud is a datacenter in Virgina with a non-meatspace API"
[2012-04-13 05:34:07 -0400] bullardo: haha
[2012-04-13 05:34:32 -0400] bullardo: yea, funny when you work for a 100 year old telco doing broadband.
[2012-04-13 05:34:53 -0400] coderanger: bullardo: To be fair, Chef isn't exclusive to the land of the cloud
[2012-04-13 05:35:20 -0400] bullardo: yea, I know. im moving these guys into the new millinium thogh.
[2012-04-13 05:35:29 -0400] coderanger: I know the feeling :)
[2012-04-13 05:35:54 -0400] bullardo: finally got rid of an engineer from the old days that wouldnt budge.
[2012-04-13 05:38:53 -0400] miah: hot
[2012-04-13 05:51:50 -0400] BryanWB: ohai chefs!
[2012-04-13 05:51:56 -0400] miah: moin
[2012-04-13 05:52:16 -0400] miah: i am heading to bed. exhausted. super long day.
[2012-04-13 05:52:33 -0400] BryanWB: miah: sleep well, check out recent ffs, awesome interview
[2012-04-13 05:52:41 -0400] miah: i listened already =)
[2012-04-13 05:52:53 -0400] miah: good job (as usual)
[2012-04-13 05:53:10 -0400] BryanWB: miah: tks
[2012-04-13 05:55:13 -0400] BryanWB: pls, pls put a review in itunes
[2012-04-13 05:55:43 -0400] coderanger: miah: Gnite!
[2012-04-13 06:01:52 -0400] miah: BryanWB: sure. i will do that tomorrow =)
[2012-04-13 06:01:55 -0400] miah: gnites coderanger
[2012-04-13 06:02:02 -0400] BryanWB: tks, gnite miah
[2012-04-13 06:30:44 -0400] Kwanasolis: anybody here who can help me rebase my patches against the opscode cookbooks?
[2012-04-13 06:45:08 -0400] dhawth: dude.  seriously.  like, for reals.  you might want to add some examples to the data bag documentation page.
[2012-04-13 06:45:15 -0400] dhawth: like this guy did: http://allanfeid.com/content/cooking-chef
[2012-04-13 06:45:18 -0400] dhawth: just sayin
[2012-04-13 06:47:10 -0400] Kwanasolis: dude, seriously, you might hang around long enough to actually be responded too instead of joining and bitching.
[2012-04-13 06:50:45 -0400] BryanWB: Kwanasolis: i have your same rebase problem and no advice :(
[2012-04-13 06:52:26 -0400] coderanger: Kwanasolis: I had little luck as well, andreacampi managed to figure it out, maybe ask on the ML?
[2012-04-13 06:55:31 -0400] Kwanasolis: coderanger: yeah, I've got a few tickets open I'd like to fix
[2012-04-13 06:55:50 -0400] Kwanasolis: but my fork of opscode-cookbooks has drifted, last time I did a merge btm called me out on fucking up my patches to the point he couldn't accept um:)
[2012-04-13 06:55:58 -0400] Kwanasolis: so now I'm off destroying repos trying to figure out how to rebase
[2012-04-13 07:02:12 -0400] coderanger: Kwanasolis: I just had a lot of pre-opscode-cookbooks-split branches at one point
[2012-04-13 07:02:24 -0400] coderanger: rebase and filter-branch and whatever else
[2012-04-13 07:02:27 -0400] coderanger: I made a mess of things :D
[2012-04-13 07:04:16 -0400] pkondzior: BryanWB: aye
[2012-04-13 07:04:24 -0400] pkondzior: BryanWB: you are awesome! :P
[2012-04-13 07:04:31 -0400] pkondzior: BryanWB: you just made my day :D
[2012-04-13 07:08:14 -0400] BryanWB: pkondzior: checht!
[2012-04-13 07:08:44 -0400] Kwanasolis: coderanger: that's what I've basically done, but I have a few patches I really should finish, since jtimberman will push them, but I started them so long ago, my books are just drifted to hell
[2012-04-13 07:08:47 -0400] BryanWB: i am seriously refactoring ark and adding tons of tests
[2012-04-13 07:09:17 -0400] pkondzior: BryanWB: i see, i was trying to find some good release, but on opscode community version was 0.1
[2012-04-13 07:09:28 -0400] BryanWB: pkondzior: as I wnat to push ark into opscode-cookbooks
[2012-04-13 07:09:33 -0400] pkondzior: BryanWB: so i've tried yestaerday with master
[2012-04-13 07:09:44 -0400] BryanWB: pkondzior: it will be a lot better come Monday, sorry
[2012-04-13 07:09:52 -0400] pkondzior: BryanWB: need any help ? :)
[2012-04-13 07:10:15 -0400] BryanWB: pkondzior: yeah, ;) w/ the configure action in provider_ark.rb
[2012-04-13 07:10:38 -0400] BryanWB: needs to handle configure options
[2012-04-13 07:10:57 -0400] pkondzior: about undef stuff, this is how it works right now, http://pastie.org/private/5pwqrp7r3fotdhhnbdoa on first run code will be undefined
[2012-04-13 07:11:02 -0400] BryanWB: but if I were u I would wait a couple days for it to become more stable
[2012-04-13 07:11:11 -0400] pkondzior: but second run after splice time will raise an expceiton becuase method is already undefined
[2012-04-13 07:12:08 -0400] pkondzior: if you are going to remove undef from those classes there is no issue in long term
[2012-04-13 07:12:10 -0400] pkondzior: but if not
[2012-04-13 07:12:36 -0400] BryanWB: yeah, cherry_pick.rb is going away too, to become the action :cherry_pick per ssd7's excellent advice
[2012-04-13 07:12:45 -0400] Kwanasolis: providers rock
[2012-04-13 07:12:45 -0400] BryanWB: same thing w/ :dump
[2012-04-13 07:13:04 -0400] Kwanasolis: I just convreted a bunch of stuff from recipes to providers, its a bit tricky at first, but soooo much easier to work with
[2012-04-13 07:14:10 -0400] pkondzior: i see, ok we are going to deploy this in 30 minutes, we need haproxy from source so i'm going to apply this http://pastie.org/private/vednpejnrfqz3tfpx1ftsg locally
[2012-04-13 07:14:21 -0400] pkondzior: but i can help you on refactoring stuff anyway :)
[2012-04-13 07:14:26 -0400] pkondzior: it's good to see things stable after weekend
[2012-04-13 07:19:57 -0400] BryanWB: pkondzior: refactor_actions branch passes for me for basic usage now, u can try it w/ this https://gist.github.com/2374763 and it should work
[2012-04-13 07:22:15 -0400] pkondzior: BryanWB: but it will still break after 30 minutes
[2012-04-13 07:22:25 -0400] pkondzior: BryanWB: code will be loaded, and then undef will be invoked 2 times
[2012-04-13 07:22:32 -0400] pkondzior: BryanWB: when those method are already undefined
[2012-04-13 07:24:18 -0400] BryanWB: pkondzior: no undefs in refactor_actions
[2012-04-13 07:24:24 -0400] pkondzior: hmm
[2012-04-13 07:24:55 -0400] BryanWB: pkondzior: at least not in 2 mins ;) after i make this push
[2012-04-13 07:27:45 -0400] BryanWB: pkondzior: pushed, i apologize that it is not more stable
[2012-04-13 07:27:56 -0400] pkondzior: BryanWB: no worries :)
[2012-04-13 07:28:05 -0400] pkondzior: BryanWB: it's awesome anyway
[2012-04-13 07:28:07 -0400] pkondzior: BryanWB: rly
[2012-04-13 07:32:13 -0400] pkondzior: BryanWB: those changes looks very nice
[2012-04-13 07:32:22 -0400] pkondzior: BryanWB: i love coomits with negative line ratio :)
[2012-04-13 07:33:39 -0400] BryanWB: tks
[2012-04-13 08:06:49 -0400] eugenmayer: is it by design that the grants.sql in the mysql reciepe does not get removed from /etc/mysql/ .. and all passwords stay on the server as planetext?
[2012-04-13 08:15:27 -0400] mosez: how did the system managed by chef get updated? have i got to do safe-upgrade by hand?
[2012-04-13 08:28:59 -0400] BryanWB: mosez: yup
[2012-04-13 08:56:49 -0400] zts: Anyone know of a cookbook for installing Kibana? (logstash frontend)
[2012-04-13 09:11:17 -0400] mosez: how can i get all ip addresses for my node within a recipe?
[2012-04-13 09:11:37 -0400] mosez: node["ipaddress"] returns only eth0 ip address
[2012-04-13 09:18:15 -0400] Kwanasolis: mosez: it seems to be stored in node[:network][:interfaces][:DEVICE][:ipaddresses].keys
[2012-04-13 09:20:07 -0400] mosez: hum... ok... thx
[2012-04-13 09:21:21 -0400] Kwanasolis: node[:network][:interfaces].map {|k,v| v[:addresses] ? v[:addresses].keys : nil }
[2012-04-13 09:21:43 -0400] Kwanasolis: little cumbersome on the results it produced, but you can expand it and get the job done as needed
[2012-04-13 09:22:04 -0400] mosez: thx
[2012-04-13 09:22:23 -0400] Kwanasolis: np, that one was fun
[2012-04-13 09:23:11 -0400] Kwanasolis: if you use an each instead of map, you'd end up with results not encapsulated in an array, but have to then collect the results yourself
[2012-04-13 09:24:00 -0400] mosez: yeah i know
[2012-04-13 09:24:05 -0400] Kwanasolis: k
[2012-04-13 09:24:12 -0400] mosez: but thx anyway ;)
[2012-04-13 09:24:22 -0400] Kwanasolis: yup
[2012-04-13 09:27:51 -0400] mosez: ok, that is too much information i'm getting out :D. i think i've got to change something on vagrant and my default vhost config template :)
[2012-04-13 09:28:23 -0400] mosez: ["::1", "127.0.0.1", "08:00:27:bf:60:07", "fe80::a00:27ff:febf:6007", "10.0.2.15", "08:00:27:4c:51:3f", "fe80::a00:27ff:fe4c:513f", "10.13.37.200"] i dont want to add all the ips to my default vhost :D
[2012-04-13 09:31:05 -0400] Kwanasolis: lol
[2012-04-13 09:31:13 -0400] Kwanasolis: you probably want to just add the stuff on eth0?
[2012-04-13 09:31:23 -0400] Kwanasolis: you asked 'how do I get all the ip addresses for my node'
[2012-04-13 09:31:26 -0400] Kwanasolis: you did not specify ;)
[2012-04-13 09:32:30 -0400] Kwanasolis: probably want to turn it into an each, gather the results, and check the value of 'k' before you return anything
[2012-04-13 09:32:41 -0400] Kwanasolis: if you try to map that, you'll have a lot of nils, but if you check and return, you should be ok
[2012-04-13 09:33:12 -0400] Kwanasolis: k =~ /^eth0.*/ or something
[2012-04-13 09:37:19 -0400] mosez: kwanasolis: first i wanted to get all ips. but that is too much information. i think i've got to update vagrant first
[2012-04-13 09:38:27 -0400] Kwanasolis: lol yeah
[2012-04-13 09:38:42 -0400] Kwanasolis: I figured you'd pull back more then you wanted, but you asked a pretty explicit question, that was why it was fun to solve
[2012-04-13 09:39:01 -0400] Kwanasolis: shef -z is your friend for stuff like this
[2012-04-13 09:43:34 -0400] mosez: thx again :)
[2012-04-13 09:47:13 -0400] Kwanasolis: and I just figured out how to close cook-1014 after months of pondering this
[2012-04-13 09:47:28 -0400] Kwanasolis: I thought I had this thing resolved twice already
[2012-04-13 09:55:52 -0400] wonko_be: i need a single integer to uniquely identify my machine - i know chef stores a id for the machine on the server (you can use it in searches to order by), but is it possible to get that id in a recipe?
[2012-04-13 10:02:41 -0400] Kwanasolis: another excelent challenge
[2012-04-13 10:06:20 -0400] Kwanasolis: node.hash?
[2012-04-13 10:36:56 -0400] wonko_be: node.hash changes through runs
[2012-04-13 11:40:11 -0400] gadolin: hey, do you happen to know any freenx cookbook?
[2012-04-13 12:30:05 -0400] jperry: anyone using knife-flow?
[2012-04-13 12:41:45 -0400] jperry: anyone using minitest or rspec to run tests on a machine after a node  has been converged?
[2012-04-13 12:42:14 -0400] jperry: I'm just wondering if there is a tool out there that will do this or you can just copy the test files over and execute rake to run the minitest or rpsec files
[2012-04-13 12:43:40 -0400] BryanWB: jperry: i am, using minitest tons
[2012-04-13 12:44:02 -0400] jperry: @BryanWB
[2012-04-13 12:44:10 -0400] jperry: do you run them after the node has been converged?
[2012-04-13 12:44:10 -0400] BryanWB: i run tests as part of chef-client run
[2012-04-13 12:44:19 -0400] BryanWB: jperry: they are part of chef run
[2012-04-13 12:44:59 -0400] BryanWB: only only on my test machine, i don't run the tests on all machines
[2012-04-13 12:45:08 -0400] jperry: right
[2012-04-13 12:45:20 -0400] jperry: so you put the tests on the chef-server?
[2012-04-13 12:45:36 -0400] BryanWB: yup
[2012-04-13 12:45:52 -0400] jperry: are you using https://github.com/btm/minitest-handler-cookbook
[2012-04-13 12:46:03 -0400] BryanWB: in  <cookbook_name>files/default/minitest/<recipe_name>/test_foo.rb
[2012-04-13 12:46:20 -0400] BryanWB: jperry: a forked version, haven't pushed my changes back yet
[2012-04-13 12:46:24 -0400] jperry: ah ok
[2012-04-13 12:46:34 -0400] jperry: so what is your workflow locally
[2012-04-13 12:46:43 -0400] jperry: do you write the tests then push them to the server?
[2012-04-13 12:46:47 -0400] BryanWB: check out my minitest-handler https://github.com/bryanwb/ , and tests in chef-ark
[2012-04-13 12:46:48 -0400] jperry: then watch them fail
[2012-04-13 12:46:54 -0400] BryanWB: jperry: yup
[2012-04-13 12:46:59 -0400] jperry: then write recipes then push those?
[2012-04-13 12:47:03 -0400] jperry: then run it again?
[2012-04-13 12:47:04 -0400] jperry: etc
[2012-04-13 12:47:25 -0400] BryanWB: exactly ;) , i have my own chef-server so it works pretty quickly, would be slower w/ hosted chef
[2012-04-13 12:48:10 -0400] jperry: ah okay
[2012-04-13 12:48:15 -0400] jperry: we have a hosted chef
[2012-04-13 12:48:23 -0400] jperry: and I was thinking of using knife-flow as well
[2012-04-13 12:48:28 -0400] BryanWB: but it really improves my sleep at night
[2012-04-13 12:48:34 -0400] nico: heya chef guys
[2012-04-13 12:48:46 -0400] BryanWB: knife-flow sounds very interesting hadn't had time to look at it
[2012-04-13 12:48:48 -0400] BryanWB: nico:  hey buddy!
[2012-04-13 12:48:52 -0400] nico: do some of you use "custom notifications" ?
[2012-04-13 12:49:06 -0400] nico: yo BryanWB !
[2012-04-13 12:49:08 -0400] jperry: I'm all for the tests just trying to find the best workflow for my team
[2012-04-13 12:50:57 -0400] jperry: @BryanWB - your change to minitest-handler is that so you can just put your files in cookbooks/<cookbook>/tests/minitest/
[2012-04-13 12:51:21 -0400] jperry: instead of what is required by btm's version?
[2012-04-13 12:51:36 -0400] BryanWB: so it gathers only tests for the recipes in my run_list
[2012-04-13 12:51:50 -0400] BryanWB: jperry: he may have modified his to handle taht
[2012-04-13 12:52:02 -0400] jperry: yeah I think it already does that
[2012-04-13 12:52:08 -0400] jperry: it doesn't run others
[2012-04-13 12:53:43 -0400] jperry: hmm, actually maybe it doesn't
[2012-04-13 12:54:08 -0400] stu__: Hi....I have a cookbook which needs to install the latest version of a package all of the time, apart from on 1 occassion.  I've created a role, but how do I tell chef that when I use this role it should install an older version?
[2012-04-13 12:56:11 -0400] hcastro: stu__: the package resource has a version attribute that you can make conditional
[2012-04-13 12:57:05 -0400] hcastro: stu__: you can pass attributes from the role -- look at the usage section of this cookbook's readme: https://github.com/opscode-cookbooks/ntp
[2012-04-13 13:39:12 -0400] renchap: when a resource A notifies a resource B (a ruby block), is it a way to know in B's ruby code what is the resource A ?
[2012-04-13 14:05:08 -0400] rshade98: I am trying to use a file in a subfolder of files/default/folder
[2012-04-13 14:05:22 -0400] rshade98: what is the source syntax for that
[2012-04-13 14:05:52 -0400] rshade98: source "folder/file.txt" does not seem to work
[2012-04-13 14:09:10 -0400] nacer: rshade98: that's the good way
[2012-04-13 14:10:55 -0400] rshade98: nacer, thanks I may have figured it out
[2012-04-13 14:11:02 -0400] nacer: rshade98: k
[2012-04-13 14:11:06 -0400] rshade98: the dir its copying to it may not exist
[2012-04-13 14:11:10 -0400] afallows: smapikesley: Tell me it's just an execute block with the curl command and nothing else.
[2012-04-13 14:11:20 -0400] afallows: Wow, why do I always spell your name wrong?
[2012-04-13 14:14:31 -0400] sampikesley: everybody does
[2012-04-13 14:14:32 -0400] sampikesley: but
[2012-04-13 14:14:36 -0400] sampikesley: they said it right on the FFS
[2012-04-13 14:14:40 -0400] sampikesley: which is rare
[2012-04-13 14:14:42 -0400] sampikesley: https://gist.github.com/2377170
[2012-04-13 14:14:49 -0400] sampikesley: requires our databags, but that's it
[2012-04-13 14:15:09 -0400] sampikesley: I'm sure it's all kinds of wrong
[2012-04-13 14:15:14 -0400] sampikesley: but it works, godammit
[2012-04-13 14:17:11 -0400] afallows: It's...*sniff* it's beautiful...
[2012-04-13 14:18:50 -0400] sampikesley: I was using this one
[2012-04-13 14:18:50 -0400] sampikesley: https://github.com/fnichol/chef-rvm
[2012-04-13 14:18:58 -0400] sampikesley: but it's a bit crippled
[2012-04-13 14:19:36 -0400] afallows: I've actually been installing RVM in a bootstrap script, for the nodes I'm managing.
[2012-04-13 14:21:49 -0400] sampikesley: system-wide?
[2012-04-13 14:22:13 -0400] sampikesley: See, I potentially have different projects on the same box, which need different rubies
[2012-04-13 14:22:57 -0400] afallows: I did system-wide (multi-mode) for my chef server install script, but the nodes I'm managing are functionally single-user, single-project, which makes config easier.
[2012-04-13 14:25:31 -0400] sampikesley: yup
[2012-04-13 14:26:47 -0400] sampikesley: also, you know said that recipe works? it doesn't
[2012-04-13 14:26:51 -0400] sampikesley: bah
[2012-04-13 14:29:20 -0400] sampikesley: haha I'm a prawn
[2012-04-13 14:29:26 -0400] sampikesley: curl not instaklled...
[2012-04-13 14:30:14 -0400] afallows: Dependencies!
[2012-04-13 14:30:46 -0400] sampikesley: fixed
[2012-04-13 14:31:48 -0400] yfeldblum: renchap, you should not need that information; if you think you need it, possibly look into redesigning
[2012-04-13 14:32:02 -0400] afallows: You should fork All major distros and re-release them with curl preinstalled.
[2012-04-13 14:32:37 -0400] afallows: I would totally contribute to Curlbuntu.
[2012-04-13 14:33:21 -0400] afallows: My ideal distro: Ubuntu =~ s/unity/curl/g
[2012-04-13 14:34:09 -0400] yfeldblum: sampikesley, unfortunately, your recipe doesn't check whether RVM is currently installed for that user, doesn't check whether the particular version of ruby is currently installed for that user, or whether the particular version of ruby is currently set as the default for that user, before taking any of the actions ... that recipe has got to be a PITA to run the second time around
[2012-04-13 14:35:46 -0400] yfeldblum: sampikesley, what's crippled about fnichol's cookbook?
[2012-04-13 14:44:59 -0400] StormSilver: Does anyone have or know of a cookbook that creates a "private" network of all their chef nodes by setting iptables rules and the hosts file?
[2012-04-13 14:49:55 -0400] jperry: anyone using knife-flow?
[2012-04-13 14:55:57 -0400] mosez: how can i test search without uploading a recipe?
[2012-04-13 14:56:39 -0400] jtimberman: mosez: shef
[2012-04-13 14:56:56 -0400] jtimberman: mosez: shef -z <-- will load shef in "client" mode with /etc/chef/client.rb
[2012-04-13 14:57:04 -0400] jtimberman: mosez: or you can run shef -c .chef/knife.rb
[2012-04-13 14:57:10 -0400] jtimberman: and it will be configured per your knife.rb
[2012-04-13 14:57:22 -0400] jtimberman: shef?
[2012-04-13 14:57:22 -0400] bawt: shef is the interactive shell version of chef.
[2012-04-13 14:57:32 -0400] jtimberman: bawt: wow, that is awfully unhelpful.
[2012-04-13 14:57:57 -0400] yfeldblum: StormSilver, that's tricky business ... alternative options may include: running only software that authenticates & authorizes its clients & peers; running an overlay VPN on all nodes and having software listen only on VPN interfaces (if you can find such a VPN)
[2012-04-13 14:58:22 -0400] jtimberman: bawt: forget shef
[2012-04-13 14:58:23 -0400] bawt: done
[2012-04-13 14:58:25 -0400] mosez: hum... i've got a irbrc in my homedir that loads pry... it seems so that shef dont like that...
[2012-04-13 14:58:32 -0400] yfeldblum: shef is a female chef
[2012-04-13 14:58:48 -0400] jtimberman: bawt: shef is the interactive Chef Console, based on IRb, http://wiki.opscode.com/display/chef/Shef and http://wiki.opscode.com/display/chef/Getting+Started+with+Shef
[2012-04-13 14:59:03 -0400] jtimberman: mosez: shef is basd on irb
[2012-04-13 14:59:05 -0400] mosez: ok... got to remove my irbrc to get it running
[2012-04-13 14:59:15 -0400] StormSilver: yfeldblum: I've done it before at my last company... it's not as hard as one might think. Just wondering if someone had given out the code so I didn't have to write it myself this time.
[2012-04-13 15:00:22 -0400] mosez: jtimberman: yeah, but it doesnt work with that .irbrc: http://pastie.org/3780951
[2012-04-13 15:00:25 -0400] yfeldblum: StormSilver, it's absolutely possible, and easy to do; the tricky business is writing your other cookbooks to tolerate connectivity failures, because they will happen more often
[2012-04-13 15:00:44 -0400] jtimberman: mosez: probably not.
[2012-04-13 15:01:05 -0400] mosez: i love pry for my rails development. that way i'm getting always pry on rails console or irb. but got to remove that for shef.
[2012-04-13 15:01:19 -0400] jtimberman: Probably.
[2012-04-13 15:01:26 -0400] jtimberman: shef was written long before pry was a thing
[2012-04-13 15:01:27 -0400] jtimberman: :)
[2012-04-13 15:01:30 -0400] mosez: i want to have a pry compatible shef :D
[2012-04-13 15:01:34 -0400] jtimberman: me too
[2012-04-13 15:02:45 -0400] sampikesley: yfeldblum: it wants the users and the ruby versions nailed into the attributes file
[2012-04-13 15:02:50 -0400] sampikesley: I wanna pick those up fmor a data bag
[2012-04-13 15:03:38 -0400] cwj: mosez: include 'pry' inside shef
[2012-04-13 15:03:56 -0400] mosez: hum... i'm getting ERROR: Server returned error for http://chefserver.domain.tld:4000/search/users?q=groups:sysadmin&sort=X_CHEF_id_CHEF_X%20asc&start=0&rows=1000, retrying 1/5 in 3s
[2012-04-13 15:04:31 -0400] mosez: cwj: where?
[2012-04-13 15:04:55 -0400] cwj: manually, after starting a shef instance
[2012-04-13 15:05:26 -0400] mosez: cwj: ok, manually should work..
[2012-04-13 15:05:27 -0400] jtimberman: mosez: you can get part of the way there by running pry, then: require 'chef/shef/ext' and  Shef::Extensions.extend_context_object(self)
[2012-04-13 15:05:28 -0400] yfeldblum: sampikesley, that's not correct; fnichol/chef-rvm does provide a convenience recipe based on attributes, but you do not have to use the convenience recipe; instead, fnichol/chef-rvm is a superb example of a cookbook because it exposes fantastic resources & idempotent, state-checking providers; you can write the recipe that loops through the data-bag search results and uses fnichol/chef-rvm's  resources to set up RVM instances & ru
[2012-04-13 15:05:29 -0400] yfeldblum: bies
[2012-04-13 15:05:39 -0400] jtimberman: or, you can require 'pry' in shef
[2012-04-13 15:06:41 -0400] mosez: jtimberman: sounds good
[2012-04-13 15:06:54 -0400] mosez: now i've got to figure out why my search does not work
[2012-04-13 15:09:47 -0400] mosez: ok... dont know why but my solr was crashed...
[2012-04-13 15:10:18 -0400] spyvsspy: mosez
[2012-04-13 15:10:21 -0400] spyvsspy: randomly?
[2012-04-13 15:10:23 -0400] spyvsspy: and it wont come back up?
[2012-04-13 15:10:31 -0400] spyvsspy: are you on ubuntu?
[2012-04-13 15:10:39 -0400] Javin: Is there such a things a "per environment" attributes in roles? And if not, what is the best way to achieve something like this?
[2012-04-13 15:10:40 -0400] spyvsspy: makerbreaker.com (this just happened to me the other day)
[2012-04-13 15:11:40 -0400] mosez: spyvsspy: i'm using search the first time. it's running on debian. restarted chef-solr and it seems to run.
[2012-04-13 15:11:49 -0400] mosez: but i can not find any results...
[2012-04-13 15:12:48 -0400] mosez: hum... updated the data bags and i can find something
[2012-04-13 15:15:04 -0400] spyvsspy: mosez
[2012-04-13 15:15:17 -0400] spyvsspy: you need attribute/name searches
[2012-04-13 15:16:00 -0400] spyvsspy: so if you have a node with the fqdn TEST.COM
[2012-04-13 15:16:13 -0400] spyvsspy: from the web interface you would do fqd:TEST.COM
[2012-04-13 15:16:18 -0400] spyvsspy: under the node search
[2012-04-13 15:17:57 -0400] mosez: spyvsspy: yeah, and where can i search data bags within the webinterface?
[2012-04-13 15:18:04 -0400] mosez: spyvsspy: shef works fine now.
[2012-04-13 15:18:23 -0400] spyvsspy: mosez, I dont know abotu databags sorry
[2012-04-13 15:18:34 -0400] spyvsspy: Im farily new to chef, learning myself
[2012-04-13 15:18:43 -0400] mosez: spyvsspy: ok
[2012-04-13 15:18:56 -0400] jtimberman: mosez: they're on the "search" tab. each data bag creates an index you search against.
[2012-04-13 15:19:39 -0400] mosez: jtimberman: ah, thx.
[2012-04-13 15:20:57 -0400] mosez: ha... i dont need the search for that what i want to do :D
[2012-04-13 15:21:01 -0400] cwj: Javin: not in roles, just set the attributes in the environment
[2012-04-13 15:22:27 -0400] |shad0w|: Javin, there are ways you could do it.
[2012-04-13 15:24:26 -0400] |shad0w|: You could put the attribs you want to be different for each env under keys for each env then unwrap it in your recipes with something like node["#{node.chef_environment}"]['my_attrib']
[2012-04-13 15:24:30 -0400] Javin: cwj: So, in this case they are related to a role and environment I.e. an nfs mount for a vm datastore where the server one mounts will differ between environment and should only be mounted for that role, and not all systems in that environment.
[2012-04-13 15:24:31 -0400] Javin: I am doing this right now, by checking the environment in the recipe and simply using a mount resource, but I'd like to make it cleaner and use attributes, etc.
[2012-04-13 15:26:18 -0400] cwj: well unless you are using the presence of the attribute to determine whether or not to mount the volume, whats the harm in having the attribute set on nodes that arent going to look at the attribute?
[2012-04-13 15:26:39 -0400] Javin: |shad0w|: Ok. I guess I'll have to think on it a bit. I just wanted to make sure there wasn't some super obvious approach that I was overlooking. It seems like per environment attributes in roles would be a useful enhancement.
[2012-04-13 15:27:21 -0400] |shad0w|: Javin, yeah they would be nice to have but the problem of doing it there or in attribs files just takes a small bit of effort
[2012-04-13 15:30:08 -0400] Javin: cwj: it is basically a big hash {nfs_mounts} of hashes {mount} that will get iterated through and mounted on the host. If it is in there it will get mounted on that host (as written today anyhow). So, I don't want it defined if it isn't valid for the host.
[2012-04-13 15:31:11 -0400] Javin: cwj: I might just need to re-work the logic a bit to make it work a bit more cleanly.
[2012-04-13 15:33:17 -0400] Brad_K: search(:mounts, "node.environment:#{fqdn}") do |m|
[2012-04-13 15:33:22 -0400] Brad_K: or maybe something like that?
[2012-04-13 15:39:09 -0400] Javin: Brad_K: That's a good thoughtI suppose I could also redesign the hash to have the server we are mounting defined per environment in the hash..
[2012-04-13 15:40:20 -0400] Javin: That might actually be the easiest, so a hash to mount  /vm_datastore simply has a key per environment for the server-volume data.
[2012-04-13 15:40:29 -0400] Brad_K: or, if you didn't want to do a pure search-based method, you could use a databag instead.  it would be fine for all the clients to access the databag read-only, so long as you're careful to make sure that only one system/process is writing to the databag at any one point (due to the lack of distributed locking).
[2012-04-13 15:40:58 -0400] Brad_K: there's lots of ways to solve this problem.  In this case, TIMTOWDI can actually be your friend.  ;-)
[2012-04-13 15:42:04 -0400] Javin: Brad_K: Yeah, I'm not sure why, but I have been avoiding data bags like the plaque. I think maybe because I can see it leading me down dark paths. :-)
[2012-04-13 15:42:30 -0400] cwj: data bags are great
[2012-04-13 15:42:37 -0400] cwj: you just put the data in the bag!
[2012-04-13 15:43:26 -0400] Brad_K: so far, the primary thing we've used them for is when we need to store sensitive data in a way that can be distributed by chef, but which is only available in a decrypted form on the node itself.
[2012-04-13 15:43:39 -0400] Javin: Brad_K:  Your right about TIMTOWDI, and the conversation has sparked enough creative thoughts to get me moving forward again. I appreciate all input. Sometimes it just helps to bounce things of others.
[2012-04-13 15:44:09 -0400] Brad_K: yup.  i think that should probably be Rule #3 or something.
[2012-04-13 15:44:40 -0400] Javin: Brad_K: That is a good point. I should look into the encrypted data bag more. That is a pretty valid use case for it which still causes us some grief today.
[2012-04-13 15:45:00 -0400] Brad_K: i'd put that right behind "publish early, publish often" and "make it work, then make sure you make it pretty"
[2012-04-13 15:45:29 -0400] Javin: :-D Do you have a poster?
[2012-04-13 15:46:00 -0400] Brad_K: actually, i do have a list of patterns and anti-patterns.  it's even on github.  lemme dig up the URL.
[2012-04-13 15:46:56 -0400] Brad_K: https://github.com/bknowles/zero-to-cloud/blob/master/slides/patterns/01_slide.md
[2012-04-13 15:47:27 -0400] Brad_K: i guess what we've discussed could be a variant of Rule #7.
[2012-04-13 15:47:46 -0400] Brad_K: or maybe part of Rule #2.
[2012-04-13 15:48:00 -0400] Brad_K: which might make that Rule #4.5?
[2012-04-13 15:49:24 -0400] Javin: Yeah, It isn't quite code review. There is value in "distributed thought process" or simply "thinking out loud in a group"Code review is important, but a bit to after the fact. This is more like collaborative design
[2012-04-13 15:49:30 -0400] afallows: not_if/only_if make me smile.
[2012-04-13 15:49:33 -0400] afallows: Just wanted to mention.
[2012-04-13 15:50:22 -0400] issackel_: is there a CHEF_REPO environ variable so I don't have to keep typing -o .
[2012-04-13 15:50:30 -0400] Brad_K: afallows: oh?  what was the smile marker on that?  how many smiles back was it?
[2012-04-13 15:50:48 -0400] Brad_K: how many more smiles to go?
[2012-04-13 15:50:53 -0400] jtimberman: issackel_: for knife?
[2012-04-13 15:50:58 -0400] issackel_: jtimberman yeah
[2012-04-13 15:51:26 -0400] jtimberman: issackel_: knife will look for the config file at .chef/knife.rb in the current directory, and then go up to the next directory if its not foudn and so on
[2012-04-13 15:51:46 -0400] jtimberman: issackel_: so you can put .chef in your ~/chef-repo (or whereever) and stick the knife.rb in there
[2012-04-13 15:52:04 -0400] afallows: Brad_K: I'll have to get back to you on that, my kilometer to smile converter is broken.
[2012-04-13 15:52:09 -0400] issackel_: knife.rb is at ~/.chef/knife.rb -- I guess then the easiest thing is to move it into the repo
[2012-04-13 15:52:14 -0400] issackel_: jtimberman alright thanks
[2012-04-13 15:52:37 -0400] jtimberman: issackel_: if you're using ~/.chef/knife.rb
[2012-04-13 15:52:58 -0400] jtimberman: issackel_: you can put cookbook_path ["#{ENV['PWD']}/cookbooks"]
[2012-04-13 15:53:13 -0400] jtimberman: and then it will look in the pwd for your cookbooks dir
[2012-04-13 15:53:14 -0400] issackel_: oh
[2012-04-13 15:53:35 -0400] jtimberman: the knife.rb is ruby, and ENV is a Ruby hash that contains the environment of the executin shell.
[2012-04-13 15:54:19 -0400] afallows: I think I know the answer, but I'm curious about something - is it possible for a recipe to look at what's in the run list when it gets executed? E.g. reciper[bar] does something only if recipe[foo] is being run this time?
[2012-04-13 15:54:21 -0400] issackel_: and then that will look for ./cookbooks wherever I currently am
[2012-04-13 16:00:58 -0400] caspyin: how are people handling the fqdn problem with rackspace cloud servers?
[2012-04-13 16:01:01 -0400] Brad_K: Javin: so, you're proposing a Rule #13?
[2012-04-13 16:01:22 -0400] Brad_K: caspyin: we have cookbooks we wrote to fix the problem ourselves.
[2012-04-13 16:01:23 -0400] cwj: huh i have to provide a metadata.json when uploading a cookbook to the community site. wth?
[2012-04-13 16:02:15 -0400] caspyin: brad_k: is it just a matter of setting up the hostname in the recipe or is there more to it than that?
[2012-04-13 16:02:23 -0400] Javin: Brad_K: Maybe a rule 1.5 "think collaboratively" - multiple perspectives encourage creative thinking
[2012-04-13 16:04:27 -0400] j-v-e: gday everyone
[2012-04-13 16:04:43 -0400] j-v-e: I'm trying to list the nodes that apply a particular recipe: nginx
[2012-04-13 16:05:02 -0400] j-v-e: the thing is, nginx is not directly applied to these nodes, but included as part of another recipe
[2012-04-13 16:05:34 -0400] j-v-e: thus the search doesn't return anything when I try "search(:node, "recipes:nginx")"
[2012-04-13 16:05:39 -0400] j-v-e: is there a way to fix that ?
[2012-04-13 16:05:40 -0400] j-v-e: https://gist.github.com/2377962
[2012-04-13 16:06:07 -0400] Brad_K: caspyin: we started with the "hostname" cookbook from the opscode site, and we made a few modifications.  We go through some logic to make sure that we have the correct default domain name that we want to apply, and if this is not in the current hostname, then we fix that  both within the values that were originally auto-discovered by ohai, and within the /etc/hosts file (so that this change will be in place for all future runs).
[2012-04-13 16:06:42 -0400] Brad_K: j-v-e: try searching for "roles:nginx".
[2012-04-13 16:07:13 -0400] cwj: j-v-e: if you encapsulate recipe[python-webserver] and recipe[nginx] into a role that includes them both in its run list then you will be able to search on recipes like you're trying to do
[2012-04-13 16:07:21 -0400] caspyin: brad_k: cool thanks
[2012-04-13 16:07:22 -0400] j-v-e: Brad_K: returns an empty result as well
[2012-04-13 16:07:52 -0400] cwj: but chef does not look at the recipes that are include_recipe'd by other recipes when populating the 'recipies' list on a node
[2012-04-13 16:08:16 -0400] j-v-e: cwj: so there's no way to get that list without making a new role
[2012-04-13 16:08:42 -0400] cwj: well you can specify nginx in the nodes' run_lists
[2012-04-13 16:08:55 -0400] cwj: but a role is probably a better idea
[2012-04-13 16:09:07 -0400] Brad_K: hmm.  everything i've added to the system has always been done through a new role, so i guess that's why i never stumbled into this problem.
[2012-04-13 16:09:18 -0400] j-v-e: but.... what's the point of having include_recipe then ?
[2012-04-13 16:09:51 -0400] cwj: making the resources, providers, libraries, etc from one cookbook or recipe available in another
[2012-04-13 16:10:00 -0400] Brad_K: i guess the point is so that you can include one recipe inside of another one but WITHOUT having that included recipe show up on the list  i.e., the behaviour you're getting is a feature.
[2012-04-13 16:10:29 -0400] cwj: e.g. i have the opscode apache2 cookbook set up apache and i have my own recipe which i want to use the web_app definition from the apache2 cookbook
[2012-04-13 16:10:45 -0400] cwj: so i have a role which includes recipe[apache2] and recipe[myrecipe]
[2012-04-13 16:11:11 -0400] cwj: and myrecipe does include_recipe "apache2::default" so that i can utilize the web_app definition
[2012-04-13 16:12:13 -0400] j-v-e: I though that having an include_recipe would run the included recipe as part of the run_list
[2012-04-13 16:12:26 -0400] j-v-e: and therefore install whatever packages the included recipe contains
[2012-04-13 16:13:03 -0400] cwj: it does run the recipe, but it doesn't put it in the run_list
[2012-04-13 16:13:54 -0400] j-v-e: so the run_list is not a list of what is being run, but a list of what I explicitely asked for, not including the dependencies
[2012-04-13 16:13:55 -0400] cwj: when you use include_recipe its like copy and pasting everything from that recipe file into the one with the include
[2012-04-13 16:13:59 -0400] cwj: yeah
[2012-04-13 16:14:10 -0400] j-v-e: that seems... confusing
[2012-04-13 16:14:47 -0400] cwj: yeah it can be, but there are lots of cookbooks that try to cover say, both ubuntu and redhat
[2012-04-13 16:14:51 -0400] cwj: they depend on apt and yum cookbooks
[2012-04-13 16:15:20 -0400] cwj: but in my environment theres no redhat, so why should yum show up in my run_list if the include_recipe 'yum' is never triggered?
[2012-04-13 16:15:57 -0400] cwj: chef would have to do a lot of work to process every recipe in order to expand the run list to include recipies which are being run via include_recipe
[2012-04-13 16:16:19 -0400] j-v-e: yay, I agree with that. but chef knows what is effectively being run and could provide that list back
[2012-04-13 16:16:36 -0400] j-v-e: well, it does when chef-client runs, doesn't it ?
[2012-04-13 16:16:53 -0400] j-v-e: anyway, I'm not arguing the inner logic. just trying to figure out how to fix my issue :)
[2012-04-13 16:17:00 -0400] j-v-e: you explanation actually helps a lot
[2012-04-13 16:17:03 -0400] cwj: not until compile time, iirc
[2012-04-13 16:17:14 -0400] cwj: i would consider wrapping those two recipes up in a role
[2012-04-13 16:17:41 -0400] cwj: but either way, glad i could help a little
[2012-04-13 16:17:57 -0400] Brad_K: "run_list:" is the roles that you explicitly specified, no dependencies.  "roles:" is run_list plus dependency roles.  "recipes:" is the complete expanded list of recipes from all roles, but not including those that were include_recipe'd from another recipe.
[2012-04-13 16:18:19 -0400] j-v-e: yeah, I'm considering several solutions. we already have roles so updating them would probably be the easiest way
[2012-04-13 16:19:04 -0400] j-v-e: Brad_K: I wish there was a last one: included_recipes. So I could search in "recipes:blah or included_recipes:blah"
[2012-04-13 16:20:49 -0400] Brad_K: so, we were talking about nginx.  maybe someone here can help me understand how nginx determins what kinds of pages are cacheable and which ones aren't?
[2012-04-13 16:21:02 -0400] Brad_K: like, is the output from php pages cacheable?
[2012-04-13 16:22:02 -0400] Brad_K: are css files cacheable?
[2012-04-13 16:23:45 -0400] terryjfundak: Anyone have a set of recipes for CrashPlan Client and Server?
[2012-04-13 16:23:55 -0400] c_t: I'm not deeply familiar with nginx, but I would think that it would have basic rules for it that you can tweak
[2012-04-13 16:24:05 -0400] c_t: like, say, caching stuff without a session key
[2012-04-13 16:24:21 -0400] c_t: or caching everything under /foo
[2012-04-13 16:24:37 -0400] j-v-e: Brad_K: caching php is tricky and not always worth it because your html gets rebuild at each request
[2012-04-13 16:24:58 -0400] c_t: j-v-e: depends
[2012-04-13 16:25:04 -0400] j-v-e: if your CSS are plain CSS file, and not generated dynamically, you can probably set a expire at 24 hours
[2012-04-13 16:25:15 -0400] j-v-e: same goes for javascript, images, etc...
[2012-04-13 16:25:22 -0400] c_t: for, say, anon folks, caching dynamic pages is *incredibly* important
[2012-04-13 16:25:42 -0400] j-v-e: c_t: yup, you can do caching of dynamic pagesm but it's more complex that just caching static files
[2012-04-13 16:26:00 -0400] c_t: oh yes
[2012-04-13 16:26:05 -0400] c_t: I'm all too well aware
[2012-04-13 16:27:37 -0400] j-v-e: Brad_K: I have some personal notes here. nothing fancy but if you're starting maybe it'll help http://wiki.linuxwall.info/doku.php/en:ressources:dossiers:nginx:nginx_performance_tuning
[2012-04-13 16:28:01 -0400] Brad_K: much appreciated.  thanks!
[2012-04-13 16:30:38 -0400] c_t: j-v-e: I wrote a custom module for lighttpd a while back that caches pages for anonymous users in memcached (tiered setup, with local and global pools)
[2012-04-13 16:31:34 -0400] knuckolls: how would i go about changing a node's name? is that going to hurt anything?
[2012-04-13 16:32:09 -0400] knuckolls: would i have to change the client name for that node as well?
[2012-04-13 16:34:27 -0400] terryjfundak: OK then, no takes on CrashPlan cookbooks or ideas? What would you'll recommend or who would you'll recommend I talk to about  this - piping the data back out a systems. Personally I've grown to really trust CrashPlan as a backup tool - both incremental and point in time backup. Anyone?
[2012-04-13 16:36:41 -0400] terryjfundak: I only see one cookbook in this area and it is not really even close.http://community.opscode.com/cookbooks/backup-manager
[2012-04-13 16:36:57 -0400] Brad_K: terryjfundak: crashplan comes highly recommended by W. Curtis Preston, author of the O'Reilly book "Backup and Recovery".  however, i don't use it and i wouldn't know how to configure chef to help manage it.
[2012-04-13 16:39:12 -0400] terryjfundak: Brad_K: Thank you. ditto on the "highly recommended". Been using at various sites for two years now and they have great tech support when you have a question Guess I need to talk to them.
[2012-04-13 16:40:22 -0400] Brad_K: bbiab
[2012-04-13 17:13:15 -0400] Babar: any idea why my search works fine in knife, but returns nothing on a node?
[2012-04-13 17:18:02 -0400] yfeldblum: Babar, what's the search look like?
[2012-04-13 17:20:43 -0400] Babar: role:Desktop
[2012-04-13 17:20:46 -0400] Babar: pretty basic :)
[2012-04-13 17:23:18 -0400] BryanWB_: btm, quick minitest question if u r around, how can I set a constant that is easy to reuse throughout a minitest testcase? for example,  a long path name that is used in mulitiple tests
[2012-04-13 17:27:53 -0400] Babar: ok, got it. wrong client.rb
[2012-04-13 17:33:18 -0400] Toger: Can roles be assigned based on ohai attributes? I'm launching some virtualbox instances (with the ohai that understands vbox) and want chef to assign a role based on those attributes.
[2012-04-13 17:33:54 -0400] Toger: virtualbox has a guest property set (such as 'webserver') and I'd like to have chef see that and install the appropriate content without having to explicitly go into knife and add the role.
[2012-04-13 17:36:20 -0400] ashb: Toger: not directly, but you can assign them programatically from a cookboko
[2012-04-13 17:38:43 -0400] Toger: The cookbook won't run unless it is targeted by a role though, won't it? chicken/egg problem?
[2012-04-13 17:39:08 -0400] ashb: you can assing cookbooks to nodes directly
[2012-04-13 17:39:21 -0400] ashb: you just need to do that somehow when you create/register the cookbook
[2012-04-13 17:39:40 -0400] ashb: (bootstrap, firstboot.json etc)
[2012-04-13 17:41:30 -0400] Toger: Hm. So a brand new node is created in virtualbox, and the kickstart installs and executes chef client. Is there any way in this process to avoid the need to have a seperate process log in to the master server and assign the cookbook to the node?
[2012-04-13 17:41:56 -0400] ashb: how does kickstart execute chef client?
[2012-04-13 17:42:39 -0400] Toger: Currently it pulls down validation.pem, client.rb, and executes "chef-client"
[2012-04-13 17:42:46 -0400] Toger: (after pulling ruby and the related gems down)
[2012-04-13 17:42:46 -0400] ashb: Toger: write a /etc/chef/firstboot.json and then run it with chef-client -j /etc/chef/firstboot.json instead of just chef-client
[2012-04-13 17:42:51 -0400] Toger: aha
[2012-04-13 17:43:07 -0400] ashb: and then that contains... { "run_list": ... } i think
[2012-04-13 17:43:15 -0400] ashb: something like that anyway
[2012-04-13 17:43:46 -0400] ashb: Toger: see also http://tickets.opscode.com/browse/CHEF-1957 to make that easier
[2012-04-13 17:44:30 -0400] btm: BryanWB_: no idea. I don't really know that much about minitest.
[2012-04-13 17:44:32 -0400] ashb: http://permalink.gmane.org/gmane.comp.sysutils.chef.user/2828 example sytnax in there
[2012-04-13 17:45:03 -0400] BryanWB_: btm, damn, guess I will have to figure that out myself ;)
[2012-04-13 17:45:10 -0400] Toger: That is most helpful, thank you.
[2012-04-13 17:47:40 -0400] btm: BryanWB_: Andrew Crump says, "He can just declare it in a helper and require / include the helper
[2012-04-13 17:48:28 -0400] BryanWB_: btm, tks, i guess by `helper` he means a module? not so familiar w/ helpers
[2012-04-13 17:49:59 -0400] BryanWB_: btm, ah i get it, could be any file in relative path, i just require it
[2012-04-13 18:15:59 -0400] rshade98: Can you glob with cookbook_file? like "/etc/files.d/*" source "files.d/*"
[2012-04-13 18:17:19 -0400] jtimberman: rshade98: no
[2012-04-13 18:19:08 -0400] btm: rshade98: http://wiki.opscode.com/display/chef/Resources#Resources-RemoteDirectory
[2012-04-13 18:23:09 -0400] jtimberman: yes, that.
[2012-04-13 18:24:34 -0400] miah: moin
[2012-04-13 18:29:13 -0400] rshade98: thanks btm and jtimberman, this will cut the lines down alot
[2012-04-13 18:29:31 -0400] rshade98: I was using an ls -1 to cat a recipe containing all the files
[2012-04-13 18:40:31 -0400] issackel_: I think that somebody might have suggested this yesterday, but is there an easy way to get and put all the json for a node, rather than one at a time via knife?  Same QQ with cookbooks to/from the server, can I just do "git push"
[2012-04-13 18:55:15 -0400] jperry: anyone using cucumber-chef?
[2012-04-13 18:55:37 -0400] jperry: just seeing how it compares to minitest-handler?
[2012-04-13 18:57:39 -0400] xeon22: hello... new to chef
[2012-04-13 18:57:46 -0400] xeon22: had a question RE files
[2012-04-13 18:57:50 -0400] xeon22: and templates
[2012-04-13 18:59:04 -0400] xeon22: i am a little unclear as to how to have chef process a template from a location that is outside of a cookbook
[2012-04-13 18:59:44 -0400] jtimberman: xeon22: you can use "local true" as a parameter to the template
[2012-04-13 18:59:53 -0400] jtimberman: and then the source parameter would point at a local file (fully qualified path)
[2012-04-13 19:02:07 -0400] xeon22: ahh that makes sense now ...
[2012-04-13 19:02:12 -0400] xeon22: thank you.
[2012-04-13 19:02:31 -0400] jtimberman: sure thing
[2012-04-13 19:15:37 -0400] raz: hm, anyone have see nthis before
[2012-04-13 19:15:38 -0400] raz: http://pastie.org/3782310
[2012-04-13 19:15:57 -0400] raz: (bootstrap after rackspace server create fails while installing erubis "not in gzip format")
[2012-04-13 19:20:10 -0400] raz: gnah
[2012-04-13 19:20:12 -0400] raz: on second run it just works
[2012-04-13 19:20:18 -0400] raz: intermittent failures..  gotta love them :(
[2012-04-13 19:27:44 -0400] hoover_damn: raz, mattray's been working on using the v2 api for rackspace
[2012-04-13 19:28:08 -0400] hoover_damn: not sure really what's up with their api but i've never had it work great for me with knife
[2012-04-13 19:28:11 -0400] mattray: raz: on Rackspace Cloud Servers beta
[2012-04-13 19:28:15 -0400] hoover_damn: the python api i'm told is supposto rock
[2012-04-13 19:28:26 -0400] mattray: yeah, examples are all with their python client
[2012-04-13 19:28:28 -0400] raz: well, my error doesn't look api related
[2012-04-13 19:28:28 -0400] hoover_damn: but where's my pyknife coderanger?
[2012-04-13 19:28:29 -0400] hoover_damn: lol
[2012-04-13 19:28:35 -0400] raz: more like random gem failure
[2012-04-13 19:28:43 -0400] hoover_damn: nah api failed to gzip?
[2012-04-13 19:28:55 -0400] coderanger: hoover_damn: Make one with pychef :P
[2012-04-13 19:28:57 -0400] hoover_damn: oooh that
[2012-04-13 19:29:02 -0400] hoover_damn: raz, that's another issue
[2012-04-13 19:29:14 -0400] hoover_damn: raz, http://timetobleed.com/the-broken-promises-of-mrireeyarv/
[2012-04-13 19:29:47 -0400] hoover_damn: maybe updating ruby?
[2012-04-13 19:30:09 -0400] raz: hoover_damn: makes me wanna cry
[2012-04-13 19:30:21 -0400] raz: hoover_damn: well, see my pastie above, it strikes during chef bootstrap
[2012-04-13 19:31:01 -0400] hoover_damn: coderanger, i know i know
[2012-04-13 19:31:07 -0400] hoover_damn: raz, yep what image are you using?
[2012-04-13 19:31:36 -0400] raz: hoover_damn: 107 (debian squeeze)
[2012-04-13 19:32:08 -0400] hoover_damn: raz, have any problem with using omnibus?
[2012-04-13 19:33:11 -0400] raz: hoover_damn: i dunno, first time i hear about it :)
[2012-04-13 19:33:46 -0400] hoover_damn: curl -L http://www.opscode.com/chef/install.sh | sudo bash
[2012-04-13 19:33:48 -0400] raz: at a glance it looks like.. failure wrapped in many layers of more failure
[2012-04-13 19:33:50 -0400] hoover_damn: http://www.opscode.com/chef/install/
[2012-04-13 19:34:37 -0400] hoover_damn: raz, you basically just pass -d chef-full
[2012-04-13 19:34:46 -0400] hoover_damn: raz, to specify the chef-full bootstrap template... provide it's own ruby
[2012-04-13 19:34:52 -0400] hoover_damn: raz, should work out of the box a lot easier
[2012-04-13 19:34:57 -0400] raz: hoover_damn: but..erm..
[2012-04-13 19:35:14 -0400] raz: how does that help me with knife server create?
[2012-04-13 19:35:34 -0400] hoover_damn: raz, knife server create uses templates
[2012-04-13 19:35:35 -0400] raz: that installer is for chef-server no?
[2012-04-13 19:35:45 -0400] hoover_damn: raz, the template you used uses the debian ruby
[2012-04-13 19:35:54 -0400] hoover_damn: raz, https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/chef-full.erb is the chef-full
[2012-04-13 19:36:11 -0400] hoover_damn: https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/ubuntu10.04-gems.erb i'm guessing is what you ran?
[2012-04-13 19:36:28 -0400] raz: i didn't specify a template so i guess yes it probably used the ubuntu one
[2012-04-13 19:36:47 -0400] hoover_damn: raz, knife rackspace server create --node-name bob --server-name bob --image 107 --distro chef-full
[2012-04-13 19:37:14 -0400] hoover_damn: raz, you can re-bootstrap the server you already created with another bootstrap template
[2012-04-13 19:37:29 -0400] hoover_damn: raz, knife bootstrap node --distro chef-full -r 'runlist'
[2012-04-13 19:37:34 -0400] raz: ah giving that a shot right now
[2012-04-13 19:37:36 -0400] hoover_damn: raz, and it'll just prompt you for the root password of the server
[2012-04-13 19:37:47 -0400] hoover_damn: replace node with the node fqdn
[2012-04-13 19:37:47 -0400] raz: i'm just bootstrapping a new one right now
[2012-04-13 19:37:57 -0400] raz: i have yet to figure out how to manage ssh keys with chef anyway
[2012-04-13 19:38:23 -0400] hoover_damn: that's actually kind of how people want to do it... the users cookbook has a good example
[2012-04-13 19:38:35 -0400] hoover_damn: they throw it in a databag, enumerate, create user, drop files based on enumeration
[2012-04-13 19:39:03 -0400] chip-: Only thing annoying about ssh keys with the users cookbook is setting multiple keys for a user
[2012-04-13 19:39:13 -0400] chip-: (have to paste them all in a string with a newline character as separator)
[2012-04-13 19:39:20 -0400] hoover_damn: lol
[2012-04-13 19:39:22 -0400] hoover_damn: i bet
[2012-04-13 19:39:43 -0400] chip-: It's a rare exception though
[2012-04-13 19:39:53 -0400] raz: multiple keys an exception?
[2012-04-13 19:39:55 -0400] raz: can we swap jobs?
[2012-04-13 19:40:02 -0400] raz: almost all my users have multiple keys
[2012-04-13 19:40:29 -0400] chip-: Pretty rare. The deploy user has a key for use from Jenkins and a key for use from Capistrano, otherwise I try to lock that shit down entirely.
[2012-04-13 19:40:36 -0400] |shad0w|: I seperated out user and key mgmt, while we do have some local users, most are through ext auth
[2012-04-13 19:40:37 -0400] raz: hmm users cookbook is probably not to manage root's authorized_keys?
[2012-04-13 19:40:42 -0400] chip-: Nobody else shares a user.
[2012-04-13 19:40:56 -0400] chip-: raz: If you're allowing remote-root logins there's a different discussion to be had altogether.
[2012-04-13 19:40:59 -0400] raz: hoover_damn: ERROR: TypeError: can't convert Array into String (that's with --distro chef-full)
[2012-04-13 19:41:04 -0400] raz: hooray for chef's awesome error messages..
[2012-04-13 19:41:26 -0400] raz: chip-: we can have that if you want, but probably not the place here.
[2012-04-13 19:41:34 -0400] chip-: raz: Truth!
[2012-04-13 19:41:40 -0400] hoover_damn: raz, hrm -VV
[2012-04-13 19:41:46 -0400] raz: meanwhile you can stick your sudo ;)
[2012-04-13 19:42:05 -0400] raz: hoover_damn: sec
[2012-04-13 19:42:06 -0400] hoover_damn: chip-, rackspace by default enables root on some images
[2012-04-13 19:42:16 -0400] hoover_damn: not entirely sure if they don't for some images
[2012-04-13 19:42:23 -0400] hoover_damn: i know for the ubuntu oneric image it comes with root
[2012-04-13 19:42:37 -0400] raz: there's nothing wrong with root-logins, if you really want that discussion :P
[2012-04-13 19:42:44 -0400] jtimberman: chip-: i think the latest version of the users cookbook you can use an array
[2012-04-13 19:42:47 -0400] hoover_damn: which is generally thrown away for us as we add a user and add sudo and throw away the password
[2012-04-13 19:42:48 -0400] chip-: hoover_damn: Oh sure, but part of my base recipe is "update sshd_config to disable remote root and reload sshd"
[2012-04-13 19:43:06 -0400] hoover_damn: chip-, disabling root login doesn't really solve anything.. just obscures
[2012-04-13 19:43:13 -0400] hoover_damn: might stop bad behavior
[2012-04-13 19:43:19 -0400] pauldale: Does anyone have a reference for Chef Training? Something that could be covered in a day?
[2012-04-13 19:43:22 -0400] hoover_damn: but really that's more of a H&R and personalle issue
[2012-04-13 19:43:29 -0400] pauldale: Or maybe intro to ruby-for-chef stuff?
[2012-04-13 19:43:32 -0400] raz: hoover_damn: running with -VV now
[2012-04-13 19:43:59 -0400] corp: anyone seen directory 'recursive true' only creating the top level directory in the path?
[2012-04-13 19:44:08 -0400] raz: someone teach knife some grammars
[2012-04-13 19:44:12 -0400] raz: Waiting server........
[2012-04-13 19:44:24 -0400] chip-: hoover_damn: Disable remote root login + fail2ban/denyhosts + iptables, as described nicely in http://www.rackaid.com/resources/how-to-block-ssh-brute-force-attacks/
[2012-04-13 19:44:37 -0400] raz: chip-: remote root with ssh-key is fine as long as you trust ssh
[2012-04-13 19:44:49 -0400] raz: if you don't trust ssh then you're screwed anyway
[2012-04-13 19:45:58 -0400] yfeldblum: raz, no, each admin should have a separate account with a separate key; even if admins need to sudo once they're logged in, they should connect with their own creds and not root creds
[2012-04-13 19:46:10 -0400] chip-: raz: makes your audit trail harder. I trust ssh (as much as I trust software), but I don't trust humans who use ssh.
[2012-04-13 19:46:16 -0400] raz: yfeldblum: and that solves.. what?
[2012-04-13 19:46:28 -0400] coderanger: pauldale: A day is a tad short
[2012-04-13 19:46:29 -0400] chip-: So if someone makes a mistake I want a blame list so we can train the person who made it.
[2012-04-13 19:46:34 -0400] yfeldblum: raz, removing Admin X's key from all servers
[2012-04-13 19:46:46 -0400] yfeldblum: raz, when Admin X leaves
[2012-04-13 19:47:00 -0400] chip-: Now, changing the SSH port, that just obscures, and is counter-productive, I agree.
[2012-04-13 19:47:08 -0400] raz: hoover_damn: http://pastie.org/3782494
[2012-04-13 19:47:19 -0400] chip-: I haven't played with pam_tally, but I'm interested in that one too.
[2012-04-13 19:47:21 -0400] yfeldblum: raz, rather than forcing Admins Y, Z, A, B, C, D, E, F, and G all to start using a new key, and also replacing the root key on all servers anyway
[2012-04-13 19:47:31 -0400] raz: yfeldblum: doesn't seem different from having root/authorized_keys managed?
[2012-04-13 19:47:36 -0400] hoover_damn: looks like a problem loading the template raz
[2012-04-13 19:47:44 -0400] raz: yfeldblum: eh, huh?
[2012-04-13 19:47:47 -0400] chip-: yfeldblum: I think he keeps the keys for all admins in root's authorized_keys so he can just revoke the one. Still...
[2012-04-13 19:47:48 -0400] hoover_damn: raz, hrm, perhaps download the file from github and --template-file /path/to/file?
[2012-04-13 19:48:05 -0400] raz: hoover_damn: hm. i'll pass for now i think. gonna revisit if that error gets frequent.
[2012-04-13 19:48:34 -0400] raz: chip-: audit-trail via sudo is snake oil
[2012-04-13 19:49:15 -0400] chip-: raz: If someone's covering tracks, sure. But if someone doesn't realize a mistake, it's handy.
[2012-04-13 19:49:29 -0400] chip-: Plus I can ship all logins out to (logstash/rsyslogd/splunk) and get an idea of how often user foo logs in
[2012-04-13 19:49:40 -0400] chip-: and foo can't erase instantly shipped logs
[2012-04-13 19:49:44 -0400] yfeldblum: raz, better to be explicit non-root by default and requiring admins explicitly to sudo for those commands where they need it
[2012-04-13 19:50:19 -0400] xuru: quick question: I have a dependency on the postgresql cookbook, but apt is failing to install libpg-dev because apt needs to be updated.  How do I make sure execute[apt-get update] gets run before the postgres recipe runs?
[2012-04-13 19:50:23 -0400] raz: yfeldblum: i've seen more mistakes during abhorrent sudo-gymnastics than from just using a root-shell when it's adequate.
[2012-04-13 19:50:47 -0400] yfeldblum: raz, sudo -s
[2012-04-13 19:51:13 -0400] chip-: yfeldblum: I don't care if they sudo su - first thing when they log in, as long as I have a log-in event sitting in (log aggregator) there.
[2012-04-13 19:51:23 -0400] raz: chip-: fwiw, with verbose logging (which you have enabled, right?) ssh logs the fingerprint of the key that was used
[2012-04-13 19:51:54 -0400] raz: yfeldblum: sure, it just gets funny when you try to execute stuff across multiple hosts (pdsh)
[2012-04-13 19:52:08 -0400] chip-: raz: what's easier, tracing key fingerprints or tracing usernames?
[2012-04-13 19:52:09 -0400] chip-: Anyway
[2012-04-13 19:52:42 -0400] chip-: I'll keep doing it my way and you'll keep doing it yours.
[2012-04-13 19:52:53 -0400] raz: chip-: amen :)
[2012-04-13 19:52:57 -0400] chip-: Not like I don't have loaded guns pointed at my own feet all over the place too :)
[2012-04-13 19:53:26 -0400] raz: which brings me to my original question, managing root's authorized_keys
[2012-04-13 19:53:38 -0400] raz: roll my own or is there something for that? (in puppet it's just another user..O
[2012-04-13 19:53:41 -0400] raz: )
[2012-04-13 19:53:44 -0400] hoover_damn: xuru, have the apt cookbook in the runlist
[2012-04-13 19:53:53 -0400] hoover_damn: xuru, or have your bootstrap do apt-get update
[2012-04-13 19:54:09 -0400] xuru: hoover_damn: ah, I'll give that a try
[2012-04-13 19:54:18 -0400] chip-: raz: probably roll your own, I don't think the users cookbook supports that practice.
[2012-04-13 19:54:34 -0400] chip-: the author of the cookbook is likely in-chan though, so check the recipe headers for author info and then /query?
[2012-04-13 19:55:13 -0400] raz: ah good idea thx :)
[2012-04-13 19:56:46 -0400] miah: roots auth keys?
[2012-04-13 19:56:54 -0400] miah: why would you want people to login directly as root?
[2012-04-13 19:57:00 -0400] miah: you lose the ability to audit who's logging in
[2012-04-13 19:57:12 -0400] miah: or atleast, make it more difficult
[2012-04-13 19:57:27 -0400] raz: miah: we just had that discussion, scroll up
[2012-04-13 19:58:04 -0400] miah: ah
[2012-04-13 19:58:16 -0400] Mithrandir: miah: because it's really tedious when you need to run a command on a zillion machines as root, but can't log in directly as root.
[2012-04-13 19:58:27 -0400] raz: Mithrandir++
[2012-04-13 19:58:27 -0400] miah: sudo is hard
[2012-04-13 19:58:55 -0400] raz: escaping sudo properly is indeed hard
[2012-04-13 19:59:02 -0400] miah: true
[2012-04-13 19:59:03 -0400] issackel_: Mithrandir Can't you do passwordless sudo?
[2012-04-13 19:59:06 -0400] xuru: hoover_damn: I added apt as the first thing in the roles run_list, and I also added it directly as the first thing on the nodes run_list through the chef web console, with no effect
[2012-04-13 19:59:12 -0400] raz: but i'll shut up now, let's keep religion out of here :)
[2012-04-13 19:59:17 -0400] miah: ya ya =)
[2012-04-13 19:59:29 -0400] Mithrandir: issackel_: sure, but then you're very often left with less security than if you allow root logins directly.
[2012-04-13 19:59:30 -0400] miah: well, as a solution to your problem. there is a ssh-keys cookbook
[2012-04-13 19:59:31 -0400] xuru: it keeps wanting to run postgresql::client first
[2012-04-13 19:59:45 -0400] Mithrandir: that you allow root logins directly doesn't mean you can't log in as a user and sudo for most tasks.
[2012-04-13 19:59:46 -0400] miah: er, i lie
[2012-04-13 19:59:47 -0400] raz: miah: ahh!  thanks, added to lookup-list
[2012-04-13 19:59:57 -0400] miah: i think i just added that ability to the users cookbook
[2012-04-13 20:00:04 -0400] miah: (deploy keys and what not)
[2012-04-13 20:00:06 -0400] raz: miah: time to release it! :P
[2012-04-13 20:00:08 -0400] miah: hah
[2012-04-13 20:00:18 -0400] Mithrandir: raz: as long as people are being reasonable in their discussion, I don't think religion comes into the picture.  It's about tradeoffs.
[2012-04-13 20:00:25 -0400] raz: anyway, shouldn't be too hard to roll my own with a template
[2012-04-13 20:00:26 -0400] miah: there is a ssh_known_hosts cookbook that i am confusing it with
[2012-04-13 20:00:30 -0400] miah: ya
[2012-04-13 20:00:31 -0400] Mithrandir: and discussing tradeoffs is often interesting, IMO.
[2012-04-13 20:00:57 -0400] miah: iirc, the users cookbook already installs the authorized_keys. but if you want to install id_rsa / .pub then you have to hack a little more
[2012-04-13 20:01:00 -0400] raz: Mithrandir: true. well, just saying i'm not religious about it.
[2012-04-13 20:01:08 -0400] miah: but there is also this
[2012-04-13 20:01:08 -0400] miah: https://github.com/atomic-penguin/cookbooks/tree/certificate/certificate
[2012-04-13 20:01:29 -0400] miah: i worked in computer security for a few years so sometimes that peaks out =)
[2012-04-13 20:02:22 -0400] Mithrandir: miah: I guess that means you tend to choose the more secure tradeoffs than other people do?  (Nothing wrong with that of course, at least not as long as you don't go completely overboard.)
[2012-04-13 20:03:58 -0400] miah: ya
[2012-04-13 20:04:11 -0400] miah: i'm not overly paranoid. i try to consider the tradeoffs
[2012-04-13 20:05:57 -0400] miah: i've dealt with hackers more than most admins though, so i have that added paranoia and experience
[2012-04-13 20:06:28 -0400] miah: when you find somebody running a program that brute forces atm card pins against your database as admin _on_ the db you learn some things
[2012-04-13 20:07:11 -0400] xuru: wow, I found my exact question on stackoverflow? seems like it's still an issue.  http://stackoverflow.com/questions/9246786/how-can-i-get-chef-to-run-apt-get-update-before-running-other-recipes
[2012-04-13 20:08:52 -0400] chip-: Mithrandir: knife ssh "role:foo" "sudo echo hello world" -x notroot
[2012-04-13 20:11:42 -0400] hoover_damn: if you use sudo and you depend on ldap
[2012-04-13 20:11:45 -0400] hoover_damn: ldap goes down
[2012-04-13 20:12:01 -0400] hoover_damn: hope nscd caches long enough for you to get in and fix it :)
[2012-04-13 20:12:44 -0400] Mithrandir: chip-: yeah, very much fun to enter your password on a hundred hosts or more.
[2012-04-13 20:15:13 -0400] Brad_K: Mithrandir: that's what knife ssh is for.
[2012-04-13 20:15:39 -0400] chip-: Mithrandir: Right, which is why knife ssh asks one time
[2012-04-13 20:16:24 -0400] chip-: hoover_damn: Users cookbook can put in a passwordless, ssh-key-only local user on every server for you automatically, controlled entirely via a data bag.
[2012-04-13 20:17:22 -0400] chip-: hoover_damn: password your ssh key and bing! 2-factor auth for a secure local backdoor account that's automatically installed on every host, can't be brute-forced, and you can revoke/replace the key inside of an hour on every host just by changing it in the data bag.
[2012-04-13 20:17:33 -0400] hoover_damn: chip-, locking down root is stupid to me, I don't want a part of this conversation
[2012-04-13 20:18:20 -0400] corp: http://tickets.opscode.com/browse/CHEF-3007 anyone else having this issue?
[2012-04-13 20:18:34 -0400] corp: appears to me that recursive directory creation is busted
[2012-04-13 20:19:40 -0400] Brad_K: hoover_damn: TIMTOWTDI is your friend.  for myself, I subscribe to the Rugged Manifesto (see <http://www.ruggedsoftware.org/>) and therefore locking down root is usually a net positive thing in terms of making my systems more rugged.  but i know that model doesn't work for everyone.
[2012-04-13 20:20:59 -0400] Brad_K: corp: no, this is the first time i've heard of problems like this.  yipes!
[2012-04-13 20:21:24 -0400] Mithrandir: chip-: which then is no fun when something breaks on some architectures.
[2012-04-13 20:21:32 -0400] corp: my resource is as basic as it gets
[2012-04-13 20:22:10 -0400] miah: there is no one solution that will work for all cases
[2012-04-13 20:22:15 -0400] chip-: Mithrandir: Then I'd argue your problems go deeper than "typing a password sucks," but as Brad_K said, TIMTOWTDI.
[2012-04-13 20:22:27 -0400] miah: so ya. some architectures will be a pita. doesn't mean you shouldn't make attempts for better security on the other systems.
[2012-04-13 20:22:28 -0400] laurent\: corp: using what chef version ?
[2012-04-13 20:22:40 -0400] corp: laurent\: 0.10.8
[2012-04-13 20:22:50 -0400] Brad_K: corp:  and what os?
[2012-04-13 20:22:57 -0400] corp: ubuntu 10.04
[2012-04-13 20:23:09 -0400] corp: trying to get chef tests running, but getting: cannot load such file -- mixlib/shellout/exceptions (LoadError)
[2012-04-13 20:23:10 -0400] Mithrandir: it's how things are, lots of stuff will break on mipsel or armhf or somesuch.  And we have to have those, since people want packages built for those architectures. :-P
[2012-04-13 20:23:51 -0400] miah: fun
[2012-04-13 20:24:00 -0400] laurent\: corp: ok so it's not something that i have introduced ! :) cf CHEF-2599
[2012-04-13 20:24:12 -0400] Brad_K: Mithrandir: weird edge cases are  weird edge cases, and all we can reasonably do is our best to make the systems as Rugged as we can feasibly do.
[2012-04-13 20:24:37 -0400] Mithrandir: Brad_K: sure
[2012-04-13 20:25:17 -0400] corp: laurent\: yeah. not sure whats up. i thought i was using this version recently
[2012-04-13 20:25:23 -0400] corp: with the same recipe
[2012-04-13 20:25:39 -0400] Brad_K: Mithrandir: and that may mean radically different things on some combinations of platform & os.  those of us who have the luxury of restricting ourselves to just one or two types of hardware and maybe just one or two different OS versions, it will be easier for us to achieve certain goals with regards to making the systems more Rugged.
[2012-04-13 20:26:00 -0400] Mithrandir: Brad_K: sure, I do that for my day job
[2012-04-13 20:26:28 -0400] Brad_K: but i still got no clue on CHEF-3007.  ;-(
[2012-04-13 20:28:22 -0400] corp: eh. nevermind. my bad
[2012-04-13 20:28:36 -0400] corp: had some crazy symlink thing happening
[2012-04-13 20:28:37 -0400] laurent\: corp: oh CHEF-2599 is for remote_dir, you're talking about directory
[2012-04-13 20:29:09 -0400] laurent\: ohoh there're some issues to handle with symlinks  ! :)
[2012-04-13 21:00:58 -0400] z: chip-: Overall something like LDAP is a net benefit, I tend to find, though it comes with the "What do you do when LDAP has a problem?". Answer to that is IMO to do as suggested, and implement a local account with SSH key for "emergency usage only" and audit any times that account is used.
[2012-04-13 21:01:51 -0400] z: chip-: patches exist to OpenSSH which let you put the SSH public key into the directory, and IME those are quite stable, though larger infrastructures where passwordless access is 'handy' across the board tend to go down the Kerberos route
[2012-04-13 21:07:34 -0400] chip-: z: We are in vehement agreement!
[2012-04-13 21:58:49 -0400] dbgster: when setting the roles path, it will pickup all files that define the roles right? (any .rb file)
[2012-04-13 21:58:58 -0400] dbgster: i.e: role_path "#{base_dir}/roles"
[2012-04-13 22:29:41 -0400] issackel_: do attributes override data bags?
[2012-04-13 22:29:55 -0400] issackel_: or are they totally separate?
[2012-04-13 22:35:13 -0400] jtimberman: totally separate
[2012-04-13 22:35:21 -0400] jtimberman: attributes are data about the node object.
[2012-04-13 22:35:31 -0400] jtimberman: data bags are arbitrary data that you can use in recipes.
[2012-04-13 22:35:35 -0400] jtimberman: or not.
[2012-04-13 22:36:47 -0400] issackel_: jtimberman it seems (to me) like things like mysql root passwords may belong in a recipe, or may belong in a node config
[2012-04-13 22:37:28 -0400] issackel_: jtimberman: sorry, my questions are to get an understanding of the chef way of doing things. I don't have a point to make or anything
[2012-04-13 22:39:20 -0400] Brad_K: issackel_: well, TIMTOWTDI.  there are various considerations to keep in mind, but at the end of the day the basket of eggs is yours, and you get to handle it however you want.  and if there is any breakage, you get to keep all the parts, and you're welcome to try to put them back together again.
[2012-04-13 22:41:01 -0400] issackel_: Brad_K: obviously. that's why I'm trying to be careful right now and make sure I understand the *proper* way things are organized
[2012-04-13 22:41:59 -0400] Brad_K: issackel_: experience has taught me that i want to put passwords to things like a database server into an encrypted data bag, so that i can minimize where that information is being exposed.  but that's my preference.
[2012-04-13 22:57:08 -0400] jtimberman: Brad_K: thats certainly a primary use case for the encrypted data bag feature
[2012-04-13 22:58:53 -0400] Brad_K: hmm.  has anyone ever noticed that you never seem to see pat and jesse in the room at the same time?  ;-)
