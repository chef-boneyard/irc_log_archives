[2012-04-17 00:00:00 -0400] hoover_damn: benjoldersma, i'm sure there are tools that do it.
[2012-04-17 00:00:15 -0400] benjoldersma: hoover_damn: totally, thanks!
[2012-04-17 00:00:18 -0400] jtimberman: https://github.com/opscode/omnibus/blob/master/source/install.sh
[2012-04-17 00:00:26 -0400] jtimberman: matschaffer: thats okay :)
[2012-04-17 00:01:26 -0400] hoover_damn: benjoldersma, https://github.com/jclulow/jsondiff
[2012-04-17 00:01:29 -0400] hoover_damn: for example
[2012-04-17 00:01:49 -0400] benjoldersma: yep, found that. perfect
[2012-04-17 00:01:57 -0400] hoover_damn: benjoldersma, everything in chef is in json.  You structure everything in chef-repo and you should be able to diff / understand yin and yang
[2012-04-17 00:02:18 -0400] hoover_damn: benjoldersma, you define your infrastructure ... not let it define you
[2012-04-17 00:02:58 -0400] benjoldersma: hoover_damn: that is so profound, both messages. i'm working on integrating that into my core being.
[2012-04-17 00:03:16 -0400] erikh: ommmmm
[2012-04-17 00:03:21 -0400] bemu: My sarcasm meter is going off.
[2012-04-17 00:03:21 -0400] benjoldersma: okay, two more (related) questions: do people have any idea if A/B testing and rollbacks can be done with chef? any pointers?
[2012-04-17 00:03:48 -0400] erikh: look at the deploy resources
[2012-04-17 00:03:55 -0400] hoover_damn: benjoldersma, there was a conversation you missed in ##infra-talk about how rollbacks are more like 'rolling forward'
[2012-04-17 00:03:58 -0400] hoover_damn: :)
[2012-04-17 00:04:03 -0400] hoover_damn: benjoldersma, unless you are referring to the deploy resource
[2012-04-17 00:04:06 -0400] bemu: benjoldersma: Chef definitely makes A/B testing easier. Rollbacks should be rolling forward.
[2012-04-17 00:04:12 -0400] benjoldersma: right, i saw the discussion notes on that
[2012-04-17 00:04:36 -0400] bemu: You can use environments, roles, tags, etc to do A/B testing.
[2012-04-17 00:04:36 -0400] bemu: a
[2012-04-17 00:04:46 -0400] benjoldersma: bemu: what are tags?
[2012-04-17 00:04:55 -0400] benjoldersma: i haven't seen those, you mean vcs tags?
[2012-04-17 00:04:56 -0400] hoover_damn: there's nothing wrong with automated testing with Chef.  Push up to Github, it fires a CI task to fire up a instance and run your tests
[2012-04-17 00:05:07 -0400] bemu: http://wiki.opscode.com/display/chef/Recipes#Recipes-Tags
[2012-04-17 00:05:26 -0400] erikh: you could also do it with node meta
[2012-04-17 00:05:35 -0400] bemu: What Chef won't do is give you metrics on the A/B testing. Obviously. But it makes it easier for you to get these mtrics.
[2012-04-17 00:05:37 -0400] erikh: (roles would work here too, but the point is the same)
[2012-04-17 00:06:00 -0400] bemu: note, I have never actually used tags.
[2012-04-17 00:06:05 -0400] bemu: I use empty roles for the same purpose.
[2012-04-17 00:06:13 -0400] erikh: neither have I which is why I'm suggesting an alternative that i have used :)
[2012-04-17 00:06:24 -0400] hoover_damn: i've used tags
[2012-04-17 00:06:26 -0400] benjoldersma: that's okay, i wouldn't expect chef to provide that, it's responsibilty is configuration
[2012-04-17 00:06:34 -0400] hoover_damn: gosh you guys make me feel old
[2012-04-17 00:06:40 -0400] bemu: halog is really nice, though the documentation is scant.
[2012-04-17 00:06:43 -0400] benjoldersma: bemu: using empty roles occurred to me, just for the purpose of setting attributes
[2012-04-17 00:06:52 -0400] jtimberman: "empty"
[2012-04-17 00:06:57 -0400] bemu: benjoldersma: You can use it for that too. But then, yeah
[2012-04-17 00:07:01 -0400] bemu: It's not an empty role. :P
[2012-04-17 00:07:06 -0400] bemu: Maybe a role without a run_list.
[2012-04-17 00:07:07 -0400] benjoldersma: bemu: oh
[2012-04-17 00:07:08 -0400] benjoldersma: hehe
[2012-04-17 00:07:09 -0400] jtimberman: roles with empty run lists
[2012-04-17 00:07:12 -0400] benjoldersma: that's what i meant
[2012-04-17 00:07:16 -0400] hoover_damn: benjoldersma, come back in 6months and tell us what you actually end up with.
[2012-04-17 00:07:19 -0400] hoover_damn: :)
[2012-04-17 00:07:31 -0400] bemu: Or better yet, let us help, and share your progress as you go :D
[2012-04-17 00:07:37 -0400] benjoldersma: hoover_damn: i definitely will, esp. since i was just laid off, and only have 6 months in the job!
[2012-04-17 00:07:50 -0400] hoover_damn: benjoldersma, ouch :(
[2012-04-17 00:07:52 -0400] benjoldersma: bemu: absolutely, will keep you up to date
[2012-04-17 00:07:59 -0400] bemu: well, there is no shortage of work in the Chef world.
[2012-04-17 00:08:07 -0400] benjoldersma: hoover_damn: it's okay :) the market is strong
[2012-04-17 00:08:11 -0400] benjoldersma: bemu: is that so?
[2012-04-17 00:08:13 -0400] bemu: There are dozens of companies looking for full-time employees.
[2012-04-17 00:08:19 -0400] benjoldersma: that's great to hear.
[2012-04-17 00:08:21 -0400] bemu: desperately.
[2012-04-17 00:08:24 -0400] hoover_damn: benjoldersma, coming from a systems enineer who has worked before configuration management
[2012-04-17 00:08:27 -0400] hoover_damn: and after
[2012-04-17 00:08:31 -0400] bemu: (ours being one of them)
[2012-04-17 00:08:35 -0400] hoover_damn: I can tell you it was a whole new learning process
[2012-04-17 00:08:55 -0400] hoover_damn: it redfined a lot of my core duties and how I did my day to day tasks
[2012-04-17 00:09:00 -0400] hoover_damn: a lot less pressing enter
[2012-04-17 00:09:13 -0400] benjoldersma: we used it at my last company
[2012-04-17 00:09:28 -0400] benjoldersma: but i was only tangentally involved, but i witnessed a similar transformation take place
[2012-04-17 00:10:44 -0400] benjoldersma: guys, thanks for some very helpful Q&A.
[2012-04-17 00:10:50 -0400] erikh: enjoy
[2012-04-17 00:35:05 -0400] issackelly: I'd like to use the latest stable nginx, and I thought that this roledef would do it: https://gist.github.com/4a04a96be18f0666309a  but I get this error: Net::HTTPServerException: remote_file[http://nginx.org/download/nginx-.tar.gz] (nginx::source line 40) had an error: Net::HTTPServerException: 404 "Not Found" --- which makes it look like my nginx -> version is broken
[2012-04-17 00:35:30 -0400] issackelly: my question is if my attributes are being formatted properly
[2012-04-17 00:36:48 -0400] issackelly: I guess a second question is how attributes bubble up/down from node/role/recpie and where override_attributes vs default_attributes for a role fit in that stack
[2012-04-17 00:42:32 -0400] issackelly: ooh found it: http://wiki.opscode.com/display/chef/Setting+Attributes+%28Examples%29
[2012-04-17 01:43:11 -0400] bemu: miah: Thanks a lot for the pointer on halog. So awesome. :D
[2012-04-17 02:03:39 -0400] hoover_damn: it's like a new girlfriend that gives him what he wants and more
[2012-04-17 02:03:42 -0400] hoover_damn: LOL
[2012-04-17 02:03:57 -0400] hoover_damn: and truthfully, knowing how bad haproxy logs were in my head, if halog makes it awesome
[2012-04-17 02:04:04 -0400] hoover_damn: that sounds just about right
[2012-04-17 02:15:07 -0400] bemu: I wouldn't go that far :)
[2012-04-17 02:25:03 -0400] z: halog <3
[2012-04-17 02:26:29 -0400] miah: bemu: =) great
[2012-04-17 02:26:32 -0400] z: building something more awesome than HAproxy *would* be quite tricky too
[2012-04-17 02:28:00 -0400] z: i challenge all who disagree to a "Build me another option to do 20Gbps+ with a cheap 1U server" game
[2012-04-17 02:29:58 -0400] hoover_damn: z, I know a few that have done that.
[2012-04-17 02:30:05 -0400] hoover_damn: z, bust custom solutions rarely qualify
[2012-04-17 02:30:19 -0400] hoover_damn: and now they all work for heroku
[2012-04-17 02:30:19 -0400] hoover_damn: heh
[2012-04-17 02:31:50 -0400] z: hoover_damn: In a previous life I got HAproxy on a ProLiant DL360 up to 18.9Gbps using fairly 'bog standard' interface cards, some kernel tuning, and I think a 4-line patch which may no longer be required
[2012-04-17 02:32:20 -0400] hoover_damn: mmm DL360's
[2012-04-17 02:32:24 -0400] hoover_damn: I don't miss the cciss cards
[2012-04-17 02:32:33 -0400] z: cciss driver is deprecated now
[2012-04-17 02:32:39 -0400] jtimberman: ffffffffffffuuuuuuuuuuuuuuuuuuuuuuuuuu cciss
[2012-04-17 02:32:43 -0400] z: everything "modern" uses the hpsa driver
[2012-04-17 02:32:51 -0400] z: which is somewhat better, though hpacucli could still use a little work
[2012-04-17 02:33:03 -0400] hoover_damn: cciss saved my life once
[2012-04-17 02:33:06 -0400] hoover_damn: so I won't curse it
[2012-04-17 02:33:19 -0400] z: for avoidance of doubt, hpsa actually makes stuff appear as /dev/sdX rather than /dev/cciss/cXdY
[2012-04-17 02:33:22 -0400] hoover_damn: only raid card I know that will enable a raid-5 array with 3 out of 5 disks dead
[2012-04-17 02:33:25 -0400] hoover_damn: and still have your data
[2012-04-17 02:33:35 -0400] hoover_damn: and it will still let you enable read write mode
[2012-04-17 02:33:36 -0400] hoover_damn: of that array
[2012-04-17 02:33:40 -0400] hoover_damn: so you can run that way for months more
[2012-04-17 02:33:46 -0400] hoover_damn: seriously
[2012-04-17 02:33:48 -0400] z: Er so 60% of drives dead in a RAID-5 set and you still had data.
[2012-04-17 02:33:53 -0400] z: How much of your data?
[2012-04-17 02:34:13 -0400] hoover_damn: z, disks were less then 10%
[2012-04-17 02:34:20 -0400] hoover_damn: z, remember cciss isn't really raid
[2012-04-17 02:34:23 -0400] hoover_damn: z, it's just a ZCR
[2012-04-17 02:34:33 -0400] hoover_damn: that's the key
[2012-04-17 02:34:43 -0400] z: I have forgotten more about CCISS than I would ever care to have known in the first place.. :/
[2012-04-17 02:34:49 -0400] z: But that is still *incredibly* lucky.
[2012-04-17 02:34:54 -0400] hoover_damn: Adaptec ZCR's?
[2012-04-17 02:35:00 -0400] hoover_damn: i2o block driver
[2012-04-17 02:35:29 -0400] hoover_damn: Fedora core 4 and 5 would give a pretty screen when you tried to install it
[2012-04-17 02:35:39 -0400] hoover_damn: not sure what was up with the kernel driver but it really blew
[2012-04-17 02:35:49 -0400] hoover_damn: so I grabbed Gentoo and quickly had them up and running and performing better
[2012-04-17 02:35:52 -0400] hoover_damn: seriously
[2012-04-17 02:36:05 -0400] hoover_damn: running a vanilla driver from the kernel without an issue
[2012-04-17 02:36:11 -0400] hoover_damn: just really /really/ old drivers
[2012-04-17 02:38:04 -0400] z: define 'quickly' since without using a binpkg mirror, your "up and running" would have been 6-12 hours minimum :P
[2012-04-17 02:40:29 -0400] hoover_damn: z, welcome to 2002.
[2012-04-17 02:40:44 -0400] hoover_damn: z, you have now just repeated the same lame troll that everyone else has from 2002 and it's purely unfounded
[2012-04-17 02:40:53 -0400] hoover_damn: and completely out of date, and unfounded
[2012-04-17 02:41:00 -0400] hoover_damn: z, thank you for continuing to troll gentoo
[2012-04-17 02:41:26 -0400] hoover_damn: Gentoo even has their own binary package mirror available for end-users to use
[2012-04-17 02:41:35 -0400] jtimberman: mkay
[2012-04-17 02:42:00 -0400] hoover_damn: that's like sitting there and saying let's install freebsd and make world
[2012-04-17 02:42:03 -0400] hoover_damn: and wait 6-12hours
[2012-04-17 02:42:12 -0400] hoover_damn: and oh let's do make install all
[2012-04-17 02:42:13 -0400] hoover_damn: and time it
[2012-04-17 02:43:24 -0400] hoover_damn: and if i can emerge -e system in less then 4 hours on a m1.small on ec2
[2012-04-17 02:46:58 -0400] hoover_damn: z, it will likely not be popular however
[2012-04-17 02:47:05 -0400] hoover_damn: or the in thing again
[2012-04-17 02:47:17 -0400] hoover_damn: z, and almost all the distributions have a lot of work to make configuration management easier
[2012-04-17 02:47:23 -0400] hoover_damn: and less cumbersome
[2012-04-17 02:47:53 -0400] hoover_damn: you don't need to customize postgresql it autoscales right? like mongodb?
[2012-04-17 02:47:55 -0400] hoover_damn: :)
[2012-04-17 02:49:55 -0400] jtimberman: no
[2012-04-17 02:51:23 -0400] hoover_damn: i'm just not entirely sure how to fix the stack size being too small with perl starting postgres
[2012-04-17 02:51:35 -0400] jtimberman: there's a cookbook for that
[2012-04-17 02:52:04 -0400] hoover_damn: pg_controlcluster 9.1 main run
[2012-04-17 02:52:05 -0400] hoover_damn: :)
[2012-04-17 02:52:22 -0400] hoover_damn: it's made me seriously think Debian has lost it's marbles
[2012-04-17 02:52:43 -0400] hoover_damn: that and moving all the configs to /etc
[2012-04-17 02:52:54 -0400] hoover_damn: poor postgres dba's will have a doubletake
[2012-04-17 02:53:37 -0400] hoover_damn: story of life sometimes
[2012-04-17 02:53:44 -0400] jtimberman: "right" or "customized to your specific use case"?
[2012-04-17 02:53:50 -0400] hoover_damn: no fix
[2012-04-17 02:53:50 -0400] jtimberman: there's a big disparity there sir
[2012-04-17 02:54:00 -0400] jtimberman: if something is truly broken
[2012-04-17 02:54:02 -0400] hoover_damn: once I threw the 9.1 ppa on top, everything broke all over
[2012-04-17 02:54:05 -0400] jtimberman: file tickets. you know the drill :)
[2012-04-17 02:54:23 -0400] z: jtimberman: schedule for ChefConf is shaping up
[2012-04-17 02:54:24 -0400] jtimberman: sounds like customized to your use case :D
[2012-04-17 02:54:30 -0400] jtimberman: z: yeah :)
[2012-04-17 02:54:32 -0400] hoover_damn: nah
[2012-04-17 02:54:44 -0400] jtimberman: i like the extra cirricular activity for tues night
[2012-04-17 02:54:45 -0400] hoover_damn: so far all it does is provide a idempotent cookbook that drops in 9.1 and nothing more
[2012-04-17 02:54:53 -0400] hoover_damn: just like your cookbook should be doing
[2012-04-17 02:55:07 -0400] hoover_damn: 9.1 shouldn't have changed that much imo
[2012-04-17 02:55:27 -0400] z: jtimberman: I will need to be in bed for a decent hour, someone handily scheduled me for "early" on Wednesday
[2012-04-17 02:55:55 -0400] z: jtimberman: But I will definitely be at the Diablo 3 event. How're the logistics looking for that?
[2012-04-17 02:57:38 -0400] z: jtimberman: although I suppose being in GMT-8 for a change, anything after 7am would be "late"
[2012-04-17 02:58:08 -0400] jtimberman: looks like postgresql::server installs some postgresql and drops off pg_hba.conf.
[2012-04-17 02:58:29 -0400] jtimberman: z: dunno, but i hope the internets are fast enough to download the game
[2012-04-17 02:58:33 -0400] jtimberman: since that is the same day as release.
[2012-04-17 02:58:35 -0400] jtimberman: iirc.
[2012-04-17 02:58:44 -0400] z: thats not good...
[2012-04-17 02:59:10 -0400] z: hope they opted for the 'premium' event Internet then
[2012-04-17 02:59:23 -0400] z: since N people downloading an ~8GB game could be fun
[2012-04-17 02:59:29 -0400] z: transparent Squid FTW?
[2012-04-17 03:02:50 -0400] z: Offline install should be possible using the authN key which will be at http://eu.battle.net/static/mediakey/d3-authenticationcode-enGB.txt rather like the Starcraft one is http://eu.battle.net/static/mediakey/sc2-authenticationcode-enGB.txt
[2012-04-17 03:07:58 -0400] jtimberman: we'll see. i will go to a store and buy it if i have to.
[2012-04-17 04:35:24 -0400] pcn: Isn't the blizzard downloader just a torrent client these days/
[2012-04-17 04:38:31 -0400] hoover_damn: pcn, bittorrent that's got more logging then you want to know
[2012-04-17 04:38:40 -0400] hoover_damn: dtrace the installer I bet it's fun
[2012-04-17 04:41:54 -0400] pcn: Hmm... could do on the mac I guess
[2012-04-17 05:17:51 -0400] BryanWB: ohai chefs!
[2012-04-17 05:33:00 -0400] BryanWB: where is andreacampi when u need him :(
[2012-04-17 05:36:59 -0400] coderanger: BryanWB: Probably not on IRC at 7AM :P
[2012-04-17 05:37:46 -0400] BryanWB: worth a try ;)
[2012-04-17 05:38:18 -0400] null_route: Good morning BryanWB !
[2012-04-17 05:38:53 -0400] BryanWB: null_route: good morngin!
[2012-04-17 05:40:32 -0400] null_route: Need to come up with a Hack-a-thon idea
[2012-04-17 05:40:43 -0400] null_route: for 2 systems guys and 2 QA guys
[2012-04-17 07:25:51 -0400] BryanWB: anybody know a good way to use chef to manage filesystem mounts ? like remote nfs mounts
[2012-04-17 07:26:03 -0400] coderanger: The mount resource?
[2012-04-17 07:26:03 -0400] BryanWB: i am a bit wary of templating /etc/fstab
[2012-04-17 07:26:16 -0400] coderanger: http://wiki.opscode.com/display/chef/Resources#Resources-Mount
[2012-04-17 07:27:04 -0400] BryanWB: coderanger: tks
[2012-04-17 08:27:29 -0400] BryanWB: does the graylog2 cookbook support the newest version of graylog2 w/ elasticsearch?
[2012-04-17 08:31:08 -0400] null_route: Hi Guys -
[2012-04-17 08:31:31 -0400] null_route: Do I need to do any magic in order for a Chf Definition to see the "node" array ?
[2012-04-17 08:31:36 -0400] null_route: any *ruby* magic
[2012-04-17 08:37:49 -0400] BryanWB: null_route: nope
[2012-04-17 08:38:01 -0400] BryanWB: null_route: u mean the node Mash correct?
[2012-04-17 08:38:15 -0400] BryanWB: Mash is a special hash
[2012-04-17 08:39:35 -0400] coderanger: Node isn't a mash, it is its own class anyway :P
[2012-04-17 08:42:05 -0400] null_route: yeah
[2012-04-17 08:46:56 -0400] BryanWB: coderanger: ah, i am mistaken
[2012-04-17 11:09:53 -0400] tolland: quite often i want to install, enable and start a service. but if the user over rides that with "service stop" or "chkconfig xxx off" i would like to respect that. is there a idiom for that?
[2012-04-17 11:15:30 -0400] tolland: ok i see a runonce article
[2012-04-17 11:15:32 -0400] tolland: thnx
[2012-04-17 11:17:55 -0400] BryanWB: tolland: what is runonce? sounds interesting
[2012-04-17 11:18:34 -0400] BryanWB: found it, interesting
[2012-04-17 13:07:26 -0400] dyer: Hey guys
[2012-04-17 13:07:37 -0400] dyer: anyone used a Proxy before when bootstrapping a client ?
[2012-04-17 13:08:30 -0400] dyer: We have a pretty ridiculous firewall policy on this one host I am trying to bootstrap and I have gotten a socks proxy setup on the perspective node but "knife bootstrap.. --bootstrap-proxy 127.0.0.1:8080" doesn't seem to be working
[2012-04-17 13:09:36 -0400] dyer: I can curl thru the proxy on the node ( https://gist.github.com/f22bf9f8e3fb6b028fb6 ) so I know that the proxy is functional
[2012-04-17 13:11:45 -0400] afallows: Quick question - when during a chef run does the ohai information get collected?
[2012-04-17 13:12:18 -0400] workmad3: afallows: right at the start, I believe
[2012-04-17 13:13:24 -0400] yfeldblum: afallows, at the beginning of the run, before loading any cookbooks
[2012-04-17 13:13:40 -0400] afallows: So then if I want to install an ohai plugin, I probably ought to install it at bootstrap (instead of in a recipe), or it won't have any effect on the first run.
[2012-04-17 13:14:22 -0400] workmad3: afallows: yeah, or you allow eventual consistency (so your node will be fine after the second run rather than the first :) )
[2012-04-17 13:15:21 -0400] afallows: I'm debating whether that's okay for my use case. IT probably is, but it can't be hard to add the creation of a small file to my bootstrap script, so it might be worth it.
[2012-04-17 13:15:38 -0400] yfeldblum: afallows, you can either do the self-bootstrapping, eventually-consistent approach, or you can bootstrap each node with the gems and ohai plugins which chef will need (and rebootstrap each node if the gem/plugin requirements change)
[2012-04-17 13:18:56 -0400] afallows: While I'm on the topic of doing things at bootstrap vs at chef-client run, what's the cleanest way to install chef-client as a service? Right now I've got an execute block in my recipe that does 'chef-client -i 3600 -s 600 &' if it isn't already on the process list, but that feels hacky.
[2012-04-17 13:23:07 -0400] dyer: Does ChefClient not support a socks5 proxy?
[2012-04-17 13:30:58 -0400] yfeldblum: dyer, for outbound or inbound connections?
[2012-04-17 13:31:05 -0400] dyer: yfeldblum, outbound
[2012-04-17 13:31:14 -0400] dbgster: so do most cookbooks use runit to manage services/processes?
[2012-04-17 13:31:51 -0400] dyer: yfeldblum, the node I am trying to bootstrap has the heinous firewall which I am trying to circumvent w/ the proxy
[2012-04-17 13:31:54 -0400] yfeldblum: afallows, look at opscode's chef-client::service recipe (https://github.com/opscode-cookbooks/chef-client/blob/1.1.4/recipes/service.rb)
[2012-04-17 13:32:40 -0400] yfeldblum: dbgster, runit is easy; most cookbooks use whatever the author of the cookbook thinks is a good service/process manager, or sometimes are built to support multiple service/process managers
[2012-04-17 13:34:40 -0400] dbgster: yfeldblum: got it, i've never used runit before, and I can see that the nginx cookbook depends on it, yet looking at the source I don't see any references to it so farjust want an example.
[2012-04-17 13:35:31 -0400] yfeldblum: dyer, so you have knife bootstrap working (installing ruby, rubygems, ohai, chef, and dropping configs) up to where the chef-client it launches needs to register a client with the chef-server?
[2012-04-17 13:36:26 -0400] dyer: yfeldblum, no, I have not even gotten that far
[2012-04-17 13:37:06 -0400] yfeldblum: dyer, hmm, i guess i misunderstood the question
[2012-04-17 13:37:30 -0400] dyer: https://gist.github.com/c2063b0b9d8eaa7faf4f
[2012-04-17 13:38:07 -0400] yfeldblum: dbgster, looks like a mistake
[2012-04-17 13:39:17 -0400] yfeldblum: dyer, the proxy is running on the node that you're trying to bootstrap? so that local connections originating from the node can go through the proxy?
[2012-04-17 13:46:18 -0400] dyer: yfeldblum, Its a sock5 proxy (SSH) running on the node
[2012-04-17 13:57:18 -0400] hoover_damn: dyer, so port 8080 is listening on the node?
[2012-04-17 13:57:20 -0400] hoover_damn: or locally?
[2012-04-17 13:57:39 -0400] dyer: hoover_damn, ty, it is running on the node
[2012-04-17 13:57:56 -0400] hoover_damn: dyer, +1 just making sure so that sounds good
[2012-04-17 13:58:13 -0400] hoover_damn: dyer, but remember socks5 isn't a straight up http proxy, you generally need an inbetween
[2012-04-17 13:58:27 -0400] hoover_damn: dyer, unless your using the http mode and then your setup for 1 http request at a time I think
[2012-04-17 13:58:35 -0400] hoover_damn: dyer, but outside of that fairly straight forward
[2012-04-17 13:59:05 -0400] hoover_damn: it might explain the no data
[2012-04-17 14:00:12 -0400] dyer: Yea, its been a decade since I have done a sock5 proxy
[2012-04-17 14:00:33 -0400] dyer: I was hoping it would work here
[2012-04-17 14:00:36 -0400] dyer: FML
[2012-04-17 14:02:42 -0400] yfeldblum: why's the node blocked from making outgoing connections?
[2012-04-17 14:08:39 -0400] hoover_damn: dyer, -R
[2012-04-17 14:08:47 -0400] hoover_damn: dyer, setup squid locally and ssh reverse tunnel proxy
[2012-04-17 14:09:05 -0400] BryanWB: atomic-penguin: sup' homez
[2012-04-17 14:09:05 -0400] hoover_damn: dyer, basically you want to run squid locally and have ssh create a reverse tunnel so the node can connect to your local squid
[2012-04-17 14:09:27 -0400] hoover_damn: dyer, http://www.howtoforge.com/reverse-ssh-tunneling
[2012-04-17 14:09:30 -0400] atomic-penguin: nothing much, working on some chef-fundamentals training to present tomorrow at work
[2012-04-17 14:09:34 -0400] BryanWB: atomic-penguin: workin' on the nfs cookbook, appears that portmap service been renamed to rpcbind on RHEL 6
[2012-04-17 14:10:01 -0400] BryanWB: atomic-penguin: not sure about centos6
[2012-04-17 14:10:23 -0400] hoover_damn: isn't el6 el6? or did they ruin that?
[2012-04-17 14:10:35 -0400] BryanWB: hoover_damn: they can still fuck it up
[2012-04-17 14:10:38 -0400] atomic-penguin: I always assume RHEL/CentOS are functionally equivalent for the same version
[2012-04-17 14:10:51 -0400] hoover_damn: ditto to what atomic-penguin said
[2012-04-17 14:11:04 -0400] dyer: hoover_damn, I have setup an instance on EC2 which the company has granted outbound ssh access to on port 22
[2012-04-17 14:11:10 -0400] BryanWB: atomic-penguin: have u used ur cookbook on a centos6 server?
[2012-04-17 14:11:10 -0400] dyer: so you are saying I should setup squid there?
[2012-04-17 14:11:14 -0400] atomic-penguin: The whole point of CentOS is not to pay an entitlement
[2012-04-17 14:11:33 -0400] BryanWB: hoover_damn: functionally-equivalent generally yes, but names can be different
[2012-04-17 14:11:37 -0400] BryanWB: esp. package name
[2012-04-17 14:11:41 -0400] atomic-penguin: I'm not sure I have tested it on any EL 6 variant.  It was cooked up in one afternoon
[2012-04-17 14:11:55 -0400] BryanWB: atomic-penguin: ok, coming to chefconf?
[2012-04-17 14:12:02 -0400] atomic-penguin: I am, are you?
[2012-04-17 14:12:17 -0400] BryanWB: atomic-penguin: yup, awesome! it will be gr8 to meet u in person
[2012-04-17 14:13:46 -0400] atomic-penguin: ditto
[2012-04-17 14:14:49 -0400] rshade98: most of the time the package names are the same the only difference is the .version.rpm
[2012-04-17 14:15:14 -0400] atomic-penguin: I only run NFS on one or two servers
[2012-04-17 14:15:23 -0400] rshade98: CentOS uses the RHEL srpms and recompiles
[2012-04-17 14:15:44 -0400] rshade98: btw anyone have a link to the blank cookbooks tar?
[2012-04-17 14:15:48 -0400] atomic-penguin: Yeah, as I understand it, they only patch out the trademarked RedHat artwork
[2012-04-17 14:16:05 -0400] rshade98: it used to be on the opscode front page, I can't find it anymore
[2012-04-17 14:16:18 -0400] rshade98: Atomic-Penguin, and the EULA changes
[2012-04-17 14:16:59 -0400] atomic-penguin: I typically don't read EULAs unless I'm forced
[2012-04-17 14:17:24 -0400] rshade98: haha I don't think anyone does
[2012-04-17 14:18:03 -0400] rshade98: I am not reading 40 pages of law jibberish that really just means "we own everything, be happy we let you use it"
[2012-04-17 14:31:12 -0400] hoover_damn: dyer, correct
[2012-04-17 14:35:44 -0400] hoover_damn: dyer, fwiw as far as dmz policies, I actually find it easier to reproduce the internet on the intranet
[2012-04-17 14:36:33 -0400] hoover_damn: dyer, for the popular tools such as rubygems.  I guess you could just use squid to do it but basically something that has the cache of rubygems.org and whatnot so your programs can act like they're on the web... but they're not
[2012-04-17 14:36:48 -0400] hoover_damn: otherwise you end up tailoring everything to your proxy setup
[2012-04-17 14:37:12 -0400] hoover_damn: I prefer to host mirrors anyway and just use the mirrors as depending on upstream's bandwidth is a bad recipe
[2012-04-17 14:37:35 -0400] hoover_damn: if you absolutely depend on the package write a package or host a mirror
[2012-04-17 14:37:50 -0400] hoover_damn: because anything can be down tomorrow including a apt mirror
[2012-04-17 14:37:51 -0400] hoover_damn: :(
[2012-04-17 15:00:05 -0400] BryanWB: atomic-penguin: in case u r interested, here is my patched version https://github.com/bryanwb/nfs
[2012-04-17 15:06:19 -0400] CharlieSu: Is there a good way to do 'update-alternatives' for Ubuntu?  I'm trying to automate the following.  http://www.veebsbraindump.com/2010/08/supporting-multiple-ruby-versions-on-ubuntu-10-04-lucid/
[2012-04-17 15:06:55 -0400] sampikesley: RVM, yo
[2012-04-17 15:07:28 -0400] atomic-penguin: BryanWB, I think I'll add an attribute for service(s) should be simpler
[2012-04-17 15:07:45 -0400] CharlieSu: sampikesley: I want to deploy an app with Passenger.  I played w/ RVM but it seemed like a hassle..
[2012-04-17 15:08:31 -0400] BryanWB: atomic-penguin: probably right to move to attributes/default.rb
[2012-04-17 15:08:50 -0400] sampikesley: rvm is awesome, though
[2012-04-17 15:09:20 -0400] CharlieSu: sampikesley: do you have any cookbooks that use RVM and Passenger together?
[2012-04-17 15:09:33 -0400] yfeldblum: sampikesley, what do you need multiple versions of ruby for?
[2012-04-17 15:09:43 -0400] sampikesley: well
[2012-04-17 15:09:45 -0400] sampikesley: http://www.amee.com/blog/2011/12/22/ruby-1-9-2-rails-3-x-and-passenger-with-chef/
[2012-04-17 15:09:47 -0400] CharlieSu: I don't need multiple versions..  just not 1.8..
[2012-04-17 15:09:59 -0400] sampikesley: but that contains REALLY REALLY BAD CHEF
[2012-04-17 15:10:15 -0400] sampikesley: I knew wnot what I was doing then
[2012-04-17 15:10:24 -0400] CharlieSu: sampikesley: what contains bad chef?
[2012-04-17 15:10:40 -0400] sampikesley: the cookbooks linked from my blogpost
[2012-04-17 15:10:58 -0400] yfeldblum: sampikesley, let me rephrase; what is the thing running on your server that requires a version of ruby that is not 1.8?
[2012-04-17 15:11:38 -0400] sampikesley: most of our apps are 1.9.2 now
[2012-04-17 15:12:13 -0400] sampikesley: CharlieSu: so just install RVM and 1.9.2 for the user that your app will run as
[2012-04-17 15:12:22 -0400] yfeldblum: sampikesley, what i do is i run chef with the system ruby (debian package for 1.8.7, but rubygems installed from source), but i install rvm and set up apps to run with a rvm ruby
[2012-04-17 15:12:47 -0400] sampikesley: yeah
[2012-04-17 15:12:57 -0400] sampikesley: that's how we roll over here
[2012-04-17 15:13:07 -0400] yfeldblum: sampikesley, i just make sure to write the script that boots the app to first load rvm and use the right rvm-installed ruby, and then boot the app
[2012-04-17 15:13:43 -0400] sampikesley: but we have one user per app
[2012-04-17 15:14:02 -0400] sampikesley: so I can set that user to have rvm 1.9.2 --default or however that works
[2012-04-17 15:14:14 -0400] sampikesley: and then some other user for some other app to have ree
[2012-04-17 15:14:18 -0400] yfeldblum: source /etc/profile.d/rvm.sh ; rvm use abcdef ; cd /path/to/app ; bundle exec script/rails server thin -p 5678
[2012-04-17 15:14:34 -0400] sampikesley: feels nice and clean our way
[2012-04-17 15:15:34 -0400] sampikesley: then in the upstart scripts 'sudo su - <some_user> -c "do_something"'
[2012-04-17 15:17:52 -0400] yfeldblum: i am eyeing, however, moving away toward LXCs: sticking the ruby the app needs in an LXC, sticking the app in an LXC, and pressing play
[2012-04-17 15:19:53 -0400] atomic-penguin: BryanWB, is that the only thing you noticed that changed portmap->rpcbind
[2012-04-17 15:20:37 -0400] BryanWB: atomic-penguin: so far
[2012-04-17 15:20:51 -0400] BryanWB: working nicey now
[2012-04-17 15:30:14 -0400] hoover_damn: why would anyone with a modern version of rails use Passenger? you don't want streaming support?
[2012-04-17 15:30:14 -0400] yfeldblum: sampikesley, lightweight virtualization for linux
[2012-04-17 15:31:27 -0400] yfeldblum: hoover_damn, to take it farther, is there some specific reason that we would need apache/nginx in order to run a modern rails app?
[2012-04-17 15:31:50 -0400] hoover_damn: yfeldblum, you don't have to run apache/nginx
[2012-04-17 15:31:57 -0400] hoover_damn: yfeldblum, you can run just the application server
[2012-04-17 15:32:15 -0400] hoover_damn: yfeldblum, the basic reason why people put nginx in front or apache is to serve assets
[2012-04-17 15:32:21 -0400] yfeldblum: hoover_damn, quite aware; is there some specific thing that apache/nginx give us that we can't get without them?
[2012-04-17 15:32:34 -0400] hoover_damn: yfeldblum, serving files out of ruby is generally a dumb idea
[2012-04-17 15:32:38 -0400] hoover_damn: and frought with bloatage
[2012-04-17 15:32:56 -0400] hoover_damn: yfeldblum, send a 100k file it loads it into memory and then sends it.
[2012-04-17 15:33:43 -0400] yfeldblum: hoover_damn, even with proper streaming?
[2012-04-17 15:34:15 -0400] hoover_damn: yfeldblum, streaming should be loading chunks into memory
[2012-04-17 15:34:19 -0400] hoover_damn: and then freeing them when they are not in use
[2012-04-17 15:34:27 -0400] sampikesley: nginx + thin is working well for us
[2012-04-17 15:34:37 -0400] sampikesley: also unicorn
[2012-04-17 15:34:41 -0400] hoover_damn: likely because you have bad code that benefits from the EM
[2012-04-17 15:34:47 -0400] hoover_damn: most ruby/rails users do
[2012-04-17 15:34:51 -0400] hoover_damn: so don't be offended
[2012-04-17 15:35:05 -0400] hoover_damn: regular threading vs event pool has it's benefits
[2012-04-17 15:35:42 -0400] yfeldblum: hoover_damn, right, e.g, a ruby file server that allocates a fixed-size buffer to read blocks from disk and serve them?
[2012-04-17 15:36:04 -0400] hoover_damn: yfeldblum, right but ruby doesn't do this well... ruby handles uploads and downloads badly
[2012-04-17 15:36:16 -0400] hoover_damn: yfeldblum, which is why there are so many hacky work arounds to provide upload functionality
[2012-04-17 15:36:34 -0400] hoover_damn: http://www.grid.net.ru/nginx/upload.en.html
[2012-04-17 15:36:49 -0400] hoover_damn: if you handle uploads in nginx... take a look at that bad boy
[2012-04-17 15:47:54 -0400] cgibbons: tada
[2012-04-17 15:52:03 -0400] jtimberman: more of the chefconf schedule is up :D
[2012-04-17 15:55:00 -0400] BryanWB: awe-some!
[2012-04-17 15:56:14 -0400] atomic-penguin: BryanWB, looks like the same portmap/rpcbind edge case on ubuntu 11.10 and newer
[2012-04-17 16:01:08 -0400] BryanWB: ah, so it isn't quite such an edge case after all
[2012-04-17 16:01:20 -0400] mparadise: '
[2012-04-17 16:03:11 -0400] atomic-penguin: I have no idea how Ubuntu versions map to Debian versions, and vice-versa
[2012-04-17 16:07:47 -0400] jtimberman: atomic-penguin: "they don't (really anymore)" sort of.
[2012-04-17 16:08:04 -0400] jtimberman: atomic-penguin: Ubuntu pulls packages from whatever the Debian testing repository is at.
[2012-04-17 16:08:15 -0400] jtimberman: up until they have a "DebianImportFreeze" during the release cycle.
[2012-04-17 16:08:19 -0400] atomic-penguin: jtimberman, not that I really care deeply, but without someone to test a cookbook on
[2012-04-17 16:08:31 -0400] atomic-penguin: ...both, shit is gonna break *probably
[2012-04-17 16:09:26 -0400] atomic-penguin: jtimberman, So what is the standard procedure there in handling that?
[2012-04-17 16:10:49 -0400] jtimberman: atomic-penguin: i generally correlate the current Debian Stable with the "older" Ubuntu LTS (10.04 now), and the current two supported Ubuntu releases (11.10, 11.04) with Debian Testing.
[2012-04-17 16:10:56 -0400] jtimberman: thats the most general case and its totally flaws.
[2012-04-17 16:10:58 -0400] jtimberman: flawed
[2012-04-17 16:11:46 -0400] atomic-penguin: not to mention someone could totally have a frankenstein system with apt repos out the wazoo
[2012-04-17 16:12:41 -0400] atomic-penguin: case node.platform == 'this might be debian'
[2012-04-17 16:14:44 -0400] jtimberman: frankenstein systems are on their own :)
[2012-04-17 16:20:36 -0400] TheBeast: can a node have multiple roles?
[2012-04-17 16:20:50 -0400] |shad0w|: TheBeast, yes
[2012-04-17 16:21:01 -0400] TheBeast: awesomeness
[2012-04-17 16:21:09 -0400] ndvivedi: we are seeing the following error while attempting to launch many ec2 servers via knife ec2 (around 25), anyone have any advice?
[2012-04-17 16:21:12 -0400] ndvivedi: ERROR: Fog::Service::Error: RequestLimitExceeded => Request limit exceeded.
[2012-04-17 16:21:13 -0400] atomic-penguin: TheBeast, yes, thats the typical way to configure a node, is by stacking roles
[2012-04-17 16:21:29 -0400] thehar: I"m having a hell of a time overriding attributes
[2012-04-17 16:21:40 -0400] TheBeast: atomic-penguin your comment describes what's I'm currently dealing with
[2012-04-17 16:21:42 -0400] ndvivedi: or any advice in general for trying to script the spin up of a large number of nodes in parallel
[2012-04-17 16:22:00 -0400] TheBeast: nodes with roles assigned to them on top of which I'm going to assign other roles once I create them
[2012-04-17 16:22:15 -0400] thehar: I have a node in a separate environment than _default. The node has 3 roles. The 2nd role has the overrides in it and the 3rd role holds the recipe with the attributes. They aren't getting overriden.
[2012-04-17 16:22:27 -0400] TheBeast: ndvivedi: you can use knife bootstrap, it seems really easy
[2012-04-17 16:22:36 -0400] TheBeast: and a for loop :p
[2012-04-17 16:23:12 -0400] ndvivedi: TheBeast: that is basically what i am doing :) kicking off around 20 knife ec2 server create processes in parallel
[2012-04-17 16:25:13 -0400] sampikesley: Isn't that just amazon throttling you?
[2012-04-17 16:30:58 -0400] hoover_damn: RequestLimitExceeded means you have too many servers
[2012-04-17 16:31:00 -0400] hoover_damn: welcome to Amazon
[2012-04-17 16:31:04 -0400] cgibbons: doh
[2012-04-17 16:31:13 -0400] hoover_damn: you have limits to how many EBS volumes you can have, Elastic IP's and instances
[2012-04-17 16:31:16 -0400] jperry: anyone using cucumber chef?
[2012-04-17 16:31:18 -0400] hoover_damn: these limits are per zone
[2012-04-17 16:31:30 -0400] hoover_damn: http://aws.amazon.com/contact-us/ec2-request/
[2012-04-17 16:31:38 -0400] hoover_damn: or contact your account rep
[2012-04-17 16:31:47 -0400] ndvivedi: thanks hoover_damn i will look into the limits
[2012-04-17 16:33:11 -0400] ggolin_: hey guys, on chef-0.10.8 - trying to run chef-client with a -c ./client.rb - chef-client says it cannot find the config file
[2012-04-17 16:33:21 -0400] ggolin_: tried abs path as well
[2012-04-17 16:33:29 -0400] ndvivedi: so it isn't really a limit of calls to the API but limits on number of servers/ebs volumes etc
[2012-04-17 16:33:57 -0400] hoover_damn: ndvivedi, there is a limit to api calls.. but they don't explain that
[2012-04-17 16:34:18 -0400] hoover_damn: ndvivedi, the actual api rate throttling that Amazon can do is roughly 600 api requests a hour is your throttle
[2012-04-17 16:34:36 -0400] hoover_damn: ndvivedi, and if you exceed > they will throttle your api requests for another hour slowing you down
[2012-04-17 16:35:00 -0400] hoover_damn: ndvivedi, basic summary is don't use excessive api calls... meaning create 600+ instances in an hour
[2012-04-17 16:35:08 -0400] ndvivedi: is the request limit per hour across all zones?
[2012-04-17 16:35:14 -0400] hoover_damn: unsure
[2012-04-17 16:35:44 -0400] hoover_damn: I would imagine it's per zone dependent as each zone has it's own api endpoint
[2012-04-17 16:37:14 -0400] ndvivedi: thanks hoover_damn
[2012-04-17 16:37:52 -0400] cgibbons: limits are for each region, not for each zone within a region
[2012-04-17 16:40:21 -0400] thehar: urggg attributes
[2012-04-17 16:41:17 -0400] jtimberman: ndvivedi: you can request a higher instance limit w/ amazon support.
[2012-04-17 16:42:41 -0400] ndvivedi: is it fair to say that if i start/kill 30 servers in the run of a script im making 60 calls to the api?
[2012-04-17 16:42:57 -0400] ndvivedi: this is using knife-ec2 server create and server delete
[2012-04-17 16:45:31 -0400] sascha_d: anyone around who can speak with experience on the windows reboot handler?
[2012-04-17 16:55:25 -0400] thehar: do the attribute overrides need to exist in the role of the recipe you are attempting to override?
[2012-04-17 16:55:39 -0400] thehar: or can it exist in any part of the chef run
[2012-04-17 17:05:24 -0400] miah: moin
[2012-04-17 17:08:10 -0400] dbgster: if a service is managed by upstart, it won't be listed in /etc/init.d right?
[2012-04-17 17:09:49 -0400] hoover_damn: yes it will
[2012-04-17 17:10:03 -0400] hoover_damn: dbgster, it's typically a symlink to the upstart helper though
[2012-04-17 17:10:12 -0400] hoover_damn: dbgster, check /etc/init if you want to see if there's an upstart file
[2012-04-17 17:10:15 -0400] dbgster: hoover_damn: actually I see my redis.conf in /etc/init/
[2012-04-17 17:10:59 -0400] dbgster: hoover_damn: no its pulling from source
[2012-04-17 17:11:12 -0400] dbgster: 2.4.8
[2012-04-17 17:15:10 -0400] hoover_damn: dbgster, ahh... and you use upstart? ironfan cookbook?
[2012-04-17 17:16:24 -0400] dbgster: hoover_damn: https://github.com/gchef/redis-cookbook
[2012-04-17 17:17:35 -0400] hoover_damn: s/ironfan/infochimps
[2012-04-17 17:19:24 -0400] dbgster: hoover_damn: thanks, benj black, oh ok, maybe I should use it :)
[2012-04-17 17:20:39 -0400] hoover_damn: dbgster, you are free to do whatever you want.  But if you have any problems
[2012-04-17 17:22:42 -0400] dbgster: hoover_damn: I wasn't being sarcastic, I like the info chimps repo thanks.
[2012-04-17 17:23:00 -0400] dbgster: hoover_damn: btw, have you seen any chef repo that configures ubuntu, like sets maxfile handlers etc.
[2012-04-17 17:23:20 -0400] atomic-penguin: BryanWB_, https://github.com/atomic-penguin/cookbook-nfs
[2012-04-17 17:23:21 -0400] dbgster: and sets up login to ssh only, no root logins...
[2012-04-17 17:23:25 -0400] hoover_damn: dbgster, honestly that should come from ubuntu
[2012-04-17 17:23:34 -0400] hoover_damn: dbgster, your ami should have limits.conf setup right from bootup
[2012-04-17 17:23:38 -0400] atomic-penguin: BryanWB_, test it and let me know before I push it to community site
[2012-04-17 17:23:50 -0400] hoover_damn: dbgster, sure you can set sysctl knobs to increase nofiles and whatnot
[2012-04-17 17:24:02 -0400] hoover_damn: dbgster, but you gotta start from the beginning and then work in the rest
[2012-04-17 17:25:01 -0400] dbgster: hoover_damn: wish there was a way to download all the info chimps cookbooks in one go
[2012-04-17 17:25:39 -0400] hoover_damn: that is really the disadvantage of the new one cookbook per repo thing
[2012-04-17 17:25:50 -0400] timsmith: they all have dependencies so you usually end up getting 1/2 of them when you pull anything
[2012-04-17 17:25:55 -0400] hoover_damn: you gotta create a loop to git clone all the opscode repos
[2012-04-17 17:25:56 -0400] hoover_damn: lol
[2012-04-17 17:27:00 -0400] cwj: thats what librarian is for
[2012-04-17 17:27:12 -0400] jtimberman: which is why we encourage people use the community site with the knife cookbook site commands.
[2012-04-17 17:27:16 -0400] jtimberman: or, use librarian :)
[2012-04-17 17:29:37 -0400] dbgster: cwj will check that out, guessing it pulls in dependancies?
[2012-04-17 17:30:39 -0400] cwj: dbgster: yes, it conceptually similar to bundler if you've used that for managing ruby gems
[2012-04-17 17:30:47 -0400] cwj: i think yfeldblum is the author
[2012-04-17 17:31:37 -0400] dbgster: https://github.com/applicationsonline/librarian
[2012-04-17 17:31:41 -0400] cwj: thats the one
[2012-04-17 17:32:45 -0400] dbgster: cwj: so what happens if I have opscode repo and info chimps, how will it know I want the red is from info chimps instead of opscode?
[2012-04-17 17:33:13 -0400] cwj: dbgster: in the Cheffile you say cookbook 'foo', :git => 'repo url goes here'
[2012-04-17 17:33:31 -0400] cwj: and it will pull foo from the git repository instead of looking at the community site
[2012-04-17 17:34:21 -0400] cwj: you can also say :path => '/home/luser/chef/foo' instead of :git => 'repo' and get cookbooks from a local copy that you are hacking on
[2012-04-17 17:36:00 -0400] cwj: jtimberman: any idea why i would get NameError: uninitialized constant Opscode::Aws::Ec2::RightAws when trying to use a LWRP from the aws cookbook?
[2012-04-17 17:36:10 -0400] dbgster: nice, thanks.
[2012-04-17 17:36:22 -0400] cwj: i added an resource_tag LWRP to the opscode aws cookbook, and it worked fine in my initial testing. now i'm using the LWRP in another one of my cookbooks and i get two different errors on the two nodes running the cookbook. one of them returns that error
[2012-04-17 17:36:59 -0400] cwj: the other one shows a 'not authorized' response from AWS, which is a separate issue
[2012-04-17 17:37:26 -0400] cwj: i dont understand why they wouldn't both throw the uninitialized constant error
[2012-04-17 17:38:00 -0400] dbgster: hoover_damn: ok, so the redis.conf is in /etc/init, where can I see how it is symbolic linked?
[2012-04-17 17:38:38 -0400] hoover_damn: dbgster, is there /etc/init.d/redis*?
[2012-04-17 17:39:23 -0400] dbgster: hoover_damn: i did a ls -la in /etc/init.d/ and don't see anything
[2012-04-17 17:40:12 -0400] Mithrandir: if there's a /etc/init/redis.conf, that's the upstart job
[2012-04-17 17:41:02 -0400] dbgster: Mithrandir: yes there is, so once that file is placed there, doesn't it have to be symbolic linked to folder(s)?
[2012-04-17 17:41:31 -0400] hoover_damn: dbgster, hrm.. at one point I saw something there symlinked so you could run one to hit the upstart job
[2012-04-17 17:41:35 -0400] hoover_damn: guess not
[2012-04-17 17:42:43 -0400] dbgster: ok I this is easy enough, create a upstart.conf.erb file whatever, and use the upstart provider Chef::Provider::Service::Upstart  i'll research what it does, curious.
[2012-04-17 17:43:06 -0400] Mithrandir: dbgster: no, it has "start on runlevel 2" or similar in it
[2012-04-17 17:45:13 -0400] dbgster: Mithrandir: yes, but how do you hook into upstart, just having the file in /etc/init is enough?
[2012-04-17 17:45:20 -0400] cwj: i guess my problem is that rightaws is not installed on the systems in question
[2012-04-17 17:45:36 -0400] afallows: For the Opscode chef-client::service recipe, when I run it on a Mac it says "You will need to set up your rc.local file." Is this as simple as creating one?
[2012-04-17 17:46:11 -0400] Mithrandir: dbgster: yes
[2012-04-17 17:47:06 -0400] jtimberman: afallows: uh maybe.
[2012-04-17 17:47:28 -0400] jtimberman: afallows: if setting up an rc.local is an appropriate thing to do for your mac.
[2012-04-17 17:47:48 -0400] jtimberman: that recipe should have it set up a mac specific service
[2012-04-17 17:47:50 -0400] jtimberman: with launchctl
[2012-04-17 17:48:53 -0400] afallows: jtimberman: I ran the recipe with defaults and got that result. What should I do to specify launchctl, I didn't notice that in the readme
[2012-04-17 17:51:07 -0400] geekbri: dbgster: just so you know, I also wrote a redis cookbook after having all sorts of issues with the infochimps one
[2012-04-17 17:51:24 -0400] jtimberman: afallows: its not supported at this time, so you'd have to write that.
[2012-04-17 17:51:37 -0400] jtimberman: afallows: by not supported i mean we don't have it in the recipe
[2012-04-17 17:52:43 -0400] afallows: jtimberman: Fair enough. I'm a complete Mac newb (only using one because my department didn't give me a choice).
[2012-04-17 17:55:33 -0400] jtimberman: fwiw, i don't run chef-client as a daemon on my macs
[2012-04-17 17:55:44 -0400] jtimberman: i just run it when i want to change config :)
[2012-04-17 17:57:29 -0400] afallows: jtimberman: I have one recipe that I want run periodically from an admin client. Currently my MBP is the only admin client.
[2012-04-17 17:57:41 -0400] NIckS: Hi there whant to share link to Jetbrains RubyMine tracker http://devnet.jetbrains.net/thread/434220 it will be first IDE with chef support, pelase vote
[2012-04-17 17:58:23 -0400] dbgster: geekbri: really? what issues? is yours public?
[2012-04-17 17:58:27 -0400] afallows: For my purposes, though, I might as well jsut use cron.
[2012-04-17 17:59:23 -0400] geekbri: dbgster: yes its public and on the community site, I couldn't do all the things I wanted to with it.  My cookbook only installs from source however and doens't provide any facility for installing from OS package.  If you want to do that then maybe you should stick with theirs.  I just figured if anybody was installing from OS package, they could just use the package resource and setup a configuration template.
[2012-04-17 17:59:41 -0400] geekbri: dbgster: its called "redisio", if you end up trying it and have any questions im on frequently you can just ask me directly
[2012-04-17 18:01:34 -0400] geekbri: dbgster: the formatting for the readme.md was updated to look better, but I didn't push that to the community site yet as there was not functionality change.  If you go to the github site though its a bit easier on the eyes now.
[2012-04-17 18:03:34 -0400] dbgster: geekbri: cool, maybe i'll check it out
[2012-04-17 18:03:39 -0400] geekbri: dbgster: :)
[2012-04-17 18:18:23 -0400] rgsteele: When using 'knife node edit' with the '--no-editor' flag, do you just pass in the chunk of json that you want modified?  Or do you have to provide the whole enchilada?
[2012-04-17 18:19:28 -0400] rgsteele: E.g., can I just use: "normal": { "tags": [tag1,tag2] }
[2012-04-17 18:21:57 -0400] rgsteele: Or do I need to provide everything: { "chef_environment": "_default", "normal": { "tags": [tag1,tag2] }, "name": "myhost.example.com", "run_list": [role[foo],role[bar]] }
[2012-04-17 18:27:20 -0400] rgsteele: As a related aside, I'd be happy to know if there's a better way to set node-level attributes without using knife to modify the couchdb directly, since 'knife node edit' changes don't lend themselves very readily to things like pull requests/code reviews.
[2012-04-17 18:28:36 -0400] Brad_K: on the code review side, you can always dump the JSON for the node back to disk, and then do a diff against the previous JSON for that node.  that still doesn't help you with regard to pull requests, however.
[2012-04-17 18:29:43 -0400] Brad_K: we generally don't do any interactive setting of node-level attributes.  we might do that on rare occasion to fix some problem where the node information got borked, but otherwise we do all that stuff through roles, cookbooks, and recipes.
[2012-04-17 18:30:29 -0400] Brad_K: doing that kind of thing with knife seems to be a definite anti-pattern, at least if it's something that is done frequently.
[2012-04-17 18:32:59 -0400] rgsteele: In my case, this is to set network interface configurations that are unique per-node (e.g., static IP's).  You can't set things like that at the role/cookbook level without creating some unwieldy data structure with configs for every node.  Unfortunately, 'knife node edit' is inconvenient for automatic deployments.  I have an automated installer (FAI) installing the base operating system,...
[2012-04-17 18:33:01 -0400] rgsteele: ...and that issues an API request to a continuous integration tool (jenkins), where a job exists to bootstrap the node with Knife.
[2012-04-17 18:36:57 -0400] rgsteele: But, creating node-specific configs in FAI/Jenkins doesn't really scale, and *that* definitely feels like an anti-pattern, I agree.  That's why I'd like a better way to set apply the node-specific network interface settings without requiring an external tool to issue a knife command, but I'm not sure such a facility exists within Chef.
[2012-04-17 18:39:50 -0400] dyer: Anyone know why ohai would be not be reporting any interfaces  ?
[2012-04-17 18:44:46 -0400] hoover_damn: you don't have iproute2 installed
[2012-04-17 18:44:56 -0400] hoover_damn: it should fallback to ifconfig afaik
[2012-04-17 18:52:45 -0400] laurent\: dyer: what version of ohai ? i'd be interested by the results of "ip a", and "ip r l" if using 0.6.12
[2012-04-17 18:54:15 -0400] laurent\: (if also using linux ;-))
[2012-04-17 18:56:29 -0400] dyer: laurent\ -> https://gist.github.com/506f24516836bea91613
[2012-04-17 18:56:43 -0400] dyer: and yes, 0.6.12
[2012-04-17 19:05:28 -0400] issackelly: env_run_list is not in addition to the default run list for a role, it's instead of. It's tough to guess which set theory to apply to some of this stuff...
[2012-04-17 19:07:12 -0400] atomic-penguin: miah, all my cookbooks are branch filtered now, *sighs*
[2012-04-17 19:07:25 -0400] miah: atomic-penguin: awesome =)
[2012-04-17 19:07:31 -0400] miah: did you hate doing it?
[2012-04-17 19:07:51 -0400] atomic-penguin: I struggled with it
[2012-04-17 19:07:58 -0400] miah: ya?
[2012-04-17 19:08:21 -0400] cwj: i for one thank you for doing it, and might contribute back a patch on your certificates cookbook
[2012-04-17 19:08:52 -0400] laurent\: dyer: so if you run "ohai network" it's nearly empty, is that it ?
[2012-04-17 19:08:56 -0400] atomic-penguin: Cause even if you script the whole thing, which I didn't.  Still have to go and update the URL on the community site
[2012-04-17 19:18:09 -0400] geekbri: I got my first pull request from somebody using one of my cookbooks off the community site and it made my weekend.
[2012-04-17 19:18:17 -0400] geekbri: So somehow it ends up being worth all the pain :)
[2012-04-17 19:19:30 -0400] dyer: laurent\, not entirely empty but pretty much https://gist.github.com/b05632d18eb066749eb8
[2012-04-17 19:29:06 -0400] mgalkiewicz: hi guys I have a problem with search in chef https://gist.github.com/2408448
[2012-04-17 19:30:45 -0400] mgalkiewicz: it happened after upgrade ruby to 1.9.3
[2012-04-17 19:31:16 -0400] mbaxa: so why is the java recipe still broken?
[2012-04-17 19:31:34 -0400] mbaxa: cause wgetting this url works just fine
[2012-04-17 19:31:36 -0400] mbaxa: http://javadl.sun.com/webapps/download/AutoDL?BundleId=59623
[2012-04-17 19:32:07 -0400] mbaxa: thats jre-6u31-linux-x64.bin
[2012-04-17 19:32:15 -0400] laurent\: dyer: sorry, i'm a bit busy, i'm in charged of half of the cooking :)
[2012-04-17 19:33:33 -0400] laurent\: dyer: is there any network related error when running ohai with -l debug ?
[2012-04-17 19:34:04 -0400] atomic-penguin: mbaxa, maybe they changed it back after I complained
[2012-04-17 19:35:29 -0400] dyer: laurent\, a few -> https://gist.github.com/683ff2be81f5bdd314af
[2012-04-17 19:37:03 -0400] laurent\: dyer: ok perfect, thanks
[2012-04-17 19:37:15 -0400] kernel_panik: hi guys! how to show all methods to use when I want create a cookbook?
[2012-04-17 19:38:58 -0400] laurent\: dyer: i'll try to provide a patch. it's the tun device, ohai doesn't like it for not having a mac address :)
[2012-04-17 19:39:27 -0400] laurent\: dyer: can you fill a ticket for it please ?
[2012-04-17 19:42:41 -0400] Urocyon: I'm get an error when attempting to ssh to an ec2 node with knife.   It looks like this is because it expects the node name to be it's FQDN, and instead it's just the ec2 node  "i-hexnumbers" name.
[2012-04-17 19:42:56 -0400] Urocyon: e.g. Failed to connect to node[i-961776f1] -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2012-04-17 19:43:14 -0400] kernel_panik: Urocyon : you can ping the host?
[2012-04-17 19:43:32 -0400] dyer: laurent\, sure
[2012-04-17 19:43:34 -0400] Urocyon: sure, and I can ssh to it using it's fqdn.
[2012-04-17 19:44:56 -0400] afallows: Urocyn: is what you see when you "knife node show" the node in question correct, as far as FQDN and IP?
[2012-04-17 19:45:09 -0400] Urocyon: I might have found a solution: http://tickets.opscode.com/browse/CHEF-1554
[2012-04-17 19:45:51 -0400] eherot: Is there a way that I can share the results of data_bag_item('name', 'item') with many cookbooks so I don't have chef-client doing a separate solr query for every single recipe?
[2012-04-17 19:46:30 -0400] Urocyon: and no, the FQDN has been assigned the internal name, domU-...compute-1.internal
[2012-04-17 19:47:57 -0400] Urocyon: And it's IP is its interal IP.
[2012-04-17 19:48:37 -0400] Urocyon: alas.  Something wonky about how ohai interacts with ec2, I guess.
[2012-04-17 19:49:19 -0400] eherot: Urocyon: doesn't ohai use the results of hostname -f ?
[2012-04-17 19:49:47 -0400] Urocyon: probably.
[2012-04-17 19:49:47 -0400] erikh: probably Socket.gethostname
[2012-04-17 19:50:04 -0400] eherot: on most ec2 machines it will get the internal fqdn as long as you're using the default amazon dns
[2012-04-17 19:51:25 -0400] Urocyon: I haven't set up anything special for them... so I'm just using amazon dns.
[2012-04-17 19:52:18 -0400] eherot: there are of course a bunch of other ways to get the "real" fqdn but not the one Ohai uses afaik
[2012-04-17 19:54:00 -0400] Urocyon: Another post on the problem: http://help.opscode.com/discussions/problems/796-knife-ec2-points-amazon-internal-dns-to-fqdn-attribute
[2012-04-17 19:54:27 -0400] dyer: laurent\ -> http://tickets.opscode.com/browse/OHAI-362
[2012-04-17 19:55:01 -0400] eherot: it's not going to be an easy problem to solve without writing some amazon-specific methods
[2012-04-17 19:57:25 -0400] eherot: e.g. curl http://169.254.169.254/2011-05-01/meta-data/public-hostname
[2012-04-17 19:59:37 -0400] Urocyon: Looks like most people have just worked around it by passing along -a ec2.public_hostname.
[2012-04-17 20:01:35 -0400] Brad_K: Urocyon: you get a similar issue with Rackspace  the FQDN is not properly set, and you can't get to it from the outside world.  that's why we wrote our own cookbook to put that information into the public DNS that we own at another provider, and then we fix the FQDN attribute to point where we want.
[2012-04-17 20:02:27 -0400] eherot: Brad_K: We did almost exactly the same thing.  We set up an internal DNS at Amazon and we update it whenever we renew a DHCP lease.
[2012-04-17 20:03:02 -0400] Urocyon: omoshiroi
[2012-04-17 20:03:53 -0400] eherot: it's handy though because now our ec2 machines can use friendly names to refer to one another.
[2012-04-17 20:03:53 -0400] Urocyon: Would make for a good article maybe.
[2012-04-17 20:07:22 -0400] Urocyon: I'm just now starting to tackle naming, and how I want to handle that in a cloud deploy.
[2012-04-17 20:07:52 -0400] Urocyon: Moving from a static number of physical servers to a dynamic set of servers means my old tricks don't work as well.
[2012-04-17 20:08:29 -0400] eherot: this trick was working pretty well until we got acquired by a bigger company that wanted to use IP-based firewall rules for everything
[2012-04-17 20:08:55 -0400] eherot: and also the fact that haproxy only refreshes its name to IP maps once per restart
[2012-04-17 20:09:55 -0400] Brad_K: i'm finding a lot of things that haproxy doesn't handle so well.  with luck, we'll be rolling out nginx as a replacement for haproxy here in the near future.
[2012-04-17 20:10:16 -0400] gale_: Hi, I have a chunk of ruby code that goes through some files (which are restored from backup or already restored from backup)
[2012-04-17 20:10:35 -0400] Brad_K: about the only thing that haproxy does well that nginx doesn't (that i've found so far) is the reporting it provides on the current status of the the different defined back-end services, etc....
[2012-04-17 20:10:51 -0400] gale_: I want the chunk of code to wait for the restore to complete or just carry on if it has been completed previously
[2012-04-17 20:10:58 -0400] gale_: any pointers?
[2012-04-17 20:11:22 -0400] gale_: currently the ruby code just executes before the restore is complete so doesn't work
[2012-04-17 20:11:28 -0400] Brad_K: gale_: how do you know when the restore is complete?  what is the restore mechanism?
[2012-04-17 20:11:29 -0400] eherot: I'll warn you about one thing in advance though: We tried to set it up so that our friendly names pointed to amazon CNAMEs instead of IPs, but it turns out that sometimes if Amazons' internal DNS can't resolve the CNAME's A record, it goes hunting for the results on the Internet, thus returning (and caching) an external IP.  Oops.
[2012-04-17 20:11:57 -0400] gale_: Brad_K: it's done via an exectue to a script
[2012-04-17 20:12:34 -0400] gale_: (using the execute resource)
[2012-04-17 20:12:42 -0400] Brad_K: and that script doesn't wait until the process is complete?
[2012-04-17 20:13:07 -0400] miah: eherot: strange. i havent seen that issue myself.
[2012-04-17 20:13:13 -0400] miah: as im doing the same
[2012-04-17 20:13:21 -0400] eherot: miah: It only happens every few million requests
[2012-04-17 20:13:50 -0400] eherot: miah: but because the incorrect records tend to stick around it wrecked havoc on some busy production systems
[2012-04-17 20:14:19 -0400] gale_: Brad_K: I believe it should but it's never occured to me that it wouldn't
[2012-04-17 20:15:48 -0400] bdha: https://raw.github.com/gist/2408646/ebac96514e2a709759bbcf67fe09718f44487e25/smartos_chef_boom.txt # argh, wat.
[2012-04-17 20:15:56 -0400] Brad_K: gale_: if that script waits until the restore is complete & verified, then you shouldn't have a problem.  otherwise, you're going to have to build your own "wait & verify" process that will run after the script kicks off, and which can be called as the next step from your recipe after the execute resource that fires off the restore.
[2012-04-17 20:16:18 -0400] eherot: bdha: null pointer exception
[2012-04-17 20:17:12 -0400] gale_: Brad_K: it would seem that Dir.glob("#{code_path}/Littoralis/**/*").each do |file| does happens once the script is complete but Find.find(src) do |file| doesn't
[2012-04-17 20:18:40 -0400] Brad_K: gale_: the only thing I can think of is that maybe your path between those two commands is not the same, which is why they give different results.  otherwise, you're trying to debug problems in Ruby procedure calls, and that's not really a Chef problem per se.
[2012-04-17 20:19:48 -0400] Brad_K: bdha: sometimes i'd like to poke ohai in the eye, with a stick.  but i guess that would make it "oha" instead of "ohai", because it would no longer have the one eye.  ;-)
[2012-04-17 20:20:20 -0400] bdha: oof
[2012-04-17 20:20:54 -0400] renchap: :win 45
[2012-04-17 20:21:12 -0400] gale_: Brad_K: okay thanks - basically it should wait and if it doesn't it's probably something silly I'm doing? :)
[2012-04-17 20:21:32 -0400] gale_: that's probably more likely!
[2012-04-17 20:22:07 -0400] eherot: gale_: Chef running background tasksthat's a scary thought :-)
[2012-04-17 20:22:13 -0400] Brad_K: gale_: i would think that it should wait, and if it doesn't then it sounds to me like there may be something silly going on, but whatever that silly thing is might or might not be your fault.  you'd need to look into that in more depth, before claiming ownership of whatever that silly thing is.
[2012-04-17 20:23:24 -0400] Brad_K: holoway: so, i guess this is what "ohai" looks like?  http://littlewolfblog.files.wordpress.com/2010/12/cyclops.jpg
[2012-04-17 20:24:10 -0400] Brad_K: holoway: or would you prefer this one?  http://profile.ak.fbcdn.net/hprofile-ak-snc4/50552_301440800947_556598_n.jpg
[2012-04-17 20:24:29 -0400] gale_: eherot: ypu indeed
[2012-04-17 20:24:39 -0400] geekbri: Sometimes having a chat client that show imagines inline can have unexpected results.
[2012-04-17 20:24:40 -0400] gale_: Brad_K: haha yes you're quite right
[2012-04-17 20:25:07 -0400] eherot: Brad_K: Great.  Now I'm going to think of that every time I use this thing.
[2012-04-17 20:25:13 -0400] Brad_K: heheheh
[2012-04-17 20:25:57 -0400] Brad_K: or how about this one?  http://blogs.discovery.com/.a/6a00d8341bf67c53ef014e8c558fd0970d-640wi
[2012-04-17 20:26:32 -0400] kernel_panik: what is the method value_for_platform  ?
[2012-04-17 20:30:36 -0400] eherot: http://wiki.opscode.com/display/chef/Recipes#Recipes-valueforplatform ?
[2012-04-17 20:34:04 -0400] newb: is it possible to overridde a node's "network" (sub) attributes from a recipe or would it require writing a ohai plugin since it's an automatic attribute?
[2012-04-17 20:37:44 -0400] kernel_panik: thanks eherot!
[2012-04-17 20:37:56 -0400] eherot: kernel_panik: np!
[2012-04-17 20:38:18 -0400] kernel_panik: and for thesting my cookbooks? how to execute the cookbook only for debug?
[2012-04-17 20:38:56 -0400] eherot: Well, not being a chef developer I don't know if mine is really the "right" way but I usually use shef
[2012-04-17 20:39:02 -0400] Brad_K: kernel_panik: shef is the cli interactive shell for chef, and would be good to use while doing development.
[2012-04-17 20:39:09 -0400] eherot: it's like a ruby console but with all of your shef data available to you
[2012-04-17 20:39:12 -0400] eherot: *chef data
[2012-04-17 20:40:00 -0400] Brad_K: kernel_panik: in addition, you can implement some tests with Rspec and minitest, as part of a continuous integration deployment of your cookbooks with a tool like Jenkins.
[2012-04-17 20:40:18 -0400] Brad_K: shef is to chef, what irb is to Ruby,
[2012-04-17 20:40:42 -0400] eherot: Brad_K: indispensable tool imho
[2012-04-17 20:41:35 -0400] newb: How do I go about "debugging" a cookbook using shef?
[2012-04-17 20:41:44 -0400] Brad_K: i don't actually use shef myself, in part because it has no way (that i know of) to save the stuff that you have put together.  once you quit that shef session, all that ephemeral state, etc is gone.
[2012-04-17 20:42:17 -0400] newb: For example, I would like to inspect what an attribute is in a certain routine in a recipe: how do I do that
[2012-04-17 20:42:33 -0400] kernel_panik: perfect!
[2012-04-17 20:42:33 -0400] Brad_K: i'll leave the rest of the shef conversation to eherot and others.
[2012-04-17 20:43:21 -0400] eherot: newb: In theory you could just paste the entire recipe right into the shef session, although if you have any external functions, attributes, libraries, etc. in the cookbook you'd have to make sure to paste them first
[2012-04-17 20:43:41 -0400] eherot: but if it's just a single section you want to evaluate you can paste it right into the shef console
[2012-04-17 20:43:56 -0400] newb: oh,  that means literally "shef is to chef, what irb is to Ruby"
[2012-04-17 20:44:01 -0400] eherot: literally.
[2012-04-17 20:44:17 -0400] eherot: what I don't know is if there's a way to say "chef, run just this cookbook" although that would be handy
[2012-04-17 20:44:44 -0400] newb: thanks eherot. It would have been awesome if I could have "snooped in" or watched on a few attributes in various cookbooks without going the "log" way
[2012-04-17 20:44:55 -0400] eherot: heh, true
[2012-04-17 20:45:03 -0400] newb: is it possible to overridde a node's "network" (sub) attributes from a recipe or would it require writing a ohai plugin since it's an automatic attribute?
[2012-04-17 20:45:14 -0400] eherot: Although the log way is definitely the most reliable since cookbooks can definitely change one anothers' values
[2012-04-17 20:45:22 -0400] Brad_K: eherot: the problem with "run just this cookbook" is that you'd have to follow all the dependencies, and if your development environment isn't identical to your operational environment, different choices might be made at different times, and you might get different versions of various plugins or tools, etc.
[2012-04-17 20:45:59 -0400] eherot: Brad_K: Yeah, you'd really need something more like a full debugger, where you could say "do a normal chef run but stop when you get *here*"
[2012-04-17 20:46:40 -0400] eherot: Several of our cookbooks wouldn't work if you ran them out of orderor they'd do something very strange.
[2012-04-17 20:46:42 -0400] newb: Brad_K, eherot: I vaguely recall something called pyr or pyre or similar that could achieve that
[2012-04-17 20:46:55 -0400] newb: inspect rubyt objects
[2012-04-17 20:47:38 -0400] eherot: hmm, not sure I know that one
[2012-04-17 20:47:47 -0400] eherot: about the node attribute thing by the way
[2012-04-17 20:47:55 -0400] eherot: I'm inclined to ask why you'd want to do that...
[2012-04-17 20:48:10 -0400] eherot: I suspect you can override it since ruby generally permits things like that but it will be reset when ohai runs
[2012-04-17 20:48:30 -0400] newb: sure, ec2 had public and private ip's and infochips cookbooks use that
[2012-04-17 20:48:42 -0400] Brad_K: newb: DrX, maybe?
[2012-04-17 20:48:50 -0400] Brad_K: see http://www.rubyinside.com/drx-visually-inspect-ruby-objects-3233.html
[2012-04-17 20:48:57 -0400] newb: however, in my campus inhouse cloud, we don't have those attributes set
[2012-04-17 20:49:14 -0400] geekbri: Sometimes its overkill to have to even check the internal or external IP as amazons split horizon DNS will return the internal IP if you query it from inside AWS and the external IP if you query it from outside
[2012-04-17 20:49:26 -0400] newb: this means I need to "do something" to set those attributes
[2012-04-17 20:49:56 -0400] eherot: if they're not set already I'd just set them in an attribute
[2012-04-17 20:50:16 -0400] eherot: ohai shouldn't mess with them unless you're re-defining something that's already defined.
[2012-04-17 20:50:28 -0400] eherot: At least.I don't think it would ;-)
[2012-04-17 20:50:58 -0400] newb: the infochips cookbooks fall back to the node's 'ipaddress' if ec2 public and private ip's are missing
[2012-04-17 20:51:18 -0400] eherot: and you want it to fall back to something else I take it
[2012-04-17 20:51:23 -0400] newb: yes
[2012-04-17 20:51:43 -0400] eherot: that sounds like a frightening hack :-)
[2012-04-17 20:52:00 -0400] newb: the node's 'ipaddress' as detected by ohai is not the one I want and I don't know how to set route ordering correctly
[2012-04-17 20:52:19 -0400] newb: essentially campus clouds have 3 interfaces and the last one is bridged and rest are NAT
[2012-04-17 20:52:55 -0400] newb: I want 'ipaddress' to be the that of the bridged interface but right now it's picking up the NAT one
[2012-04-17 20:52:55 -0400] eherot: Can you not edit the cookbook?  Or are you just looking to avoid that?
[2012-04-17 20:53:26 -0400] jtimberman: newb: ohai sets 'ipaddress' to the value of the interface that has the default route.
[2012-04-17 20:53:38 -0400] newb: editing the cookbook would not have the same enjoyment as knowing how all this works ;-)
[2012-04-17 20:53:53 -0400] eherot: ahhh
[2012-04-17 20:53:55 -0400] eherot: gotcha ;-)
[2012-04-17 20:54:28 -0400] newb: and I take it 'ipaddress' is an automatic attribute that cannot be overrides from a recipe?
[2012-04-17 20:54:30 -0400] eherot: that's weird that it would use the ec2 public and private values because there is another key in there called "cloud" that is much more generic.
[2012-04-17 20:55:00 -0400] newb: eherot, correct! :cloud
[2012-04-17 20:55:05 -0400] eherot: I'd say it's more that it's generally not overridden.  You could do it but you might make other things not work as expected
[2012-04-17 20:55:20 -0400] eherot: what does cloud come up with on your system?
[2012-04-17 20:56:30 -0400] newb: good question. I don't see that attribute in the node's attribute list when I click on the node in the chef GUI
[2012-04-17 20:57:07 -0400] newb: would running ohai on any of the nodes and doing a 'ohai | grep 'cloud'' be sufficient?
[2012-04-17 20:57:43 -0400] eherot: not surethis is one of those things that I usually use shef for actually
[2012-04-17 20:57:49 -0400] eherot: shef -z -c /etc/chef/client.rb
[2012-04-17 20:57:56 -0400] eherot: (assuming that's where your config lives)
[2012-04-17 20:59:05 -0400] newb: awesome: once I run this, I can just type in node[:cloud] and node[:network][:default_interface] to inspect the values?
[2012-04-17 20:59:14 -0400] eherot: exactly
[2012-04-17 20:59:27 -0400] eherot: (you'll wonder how you lived without it ;-))
[2012-04-17 21:00:05 -0400] newb: I won't actually, I have been meaning to use shef for a while now but never knew what to do with it!
[2012-04-17 21:00:16 -0400] newb: thanks eherot :-D
[2012-04-17 21:00:26 -0400] newb: my first use case
[2012-04-17 21:00:32 -0400] eherot: same.  I saw a note about it when I first started using chef and shrugged it off.  Now I regret doing that
[2012-04-17 21:00:50 -0400] newb: tell me about it. I also need a way to monitor chef runs
[2012-04-17 21:01:12 -0400] newb: I recentlly read about report handlers so I need to search that way
[2012-04-17 21:01:31 -0400] eherot: we have ours set to send alert exceptions to our team via email
[2012-04-17 21:01:57 -0400] newb: I want chef to tell me "hey, these nodes failed and I have emailed you the stack trace and ip address of the failed nodes"
[2012-04-17 21:01:59 -0400] eherot: mess up one cookbook that's on every serverrender your email client useless
[2012-04-17 21:02:04 -0400] newb: lol!
[2012-04-17 21:02:21 -0400] eherot: it's nice that they also go to my boss, heh.
[2012-04-17 21:02:24 -0400] HansCz: Quick question: Is it possible to write my own resources and providers for chef-solo?
[2012-04-17 21:02:46 -0400] jtimberman: HansCz: sure
[2012-04-17 21:03:02 -0400] newb: eherot, are there some report handlers that I can look at, esp. ones that email a report?
[2012-04-17 21:03:29 -0400] jtimberman: HansCz: i wrote all the code used in this section from our fundamentals training using chef-solo (because I was on a plane :)) - https://github.com/opscode/chef-fundamentals/blob/lwrp-section/slides/lwrp-introduction/01_slide.md
[2012-04-17 21:03:50 -0400] jtimberman: newb: there's an email report handler example on the wiki page
[2012-04-17 21:04:15 -0400] HansCz: hmmm... I think I'm doing it right, but I get a nomethoderror when trying to invoke my resource...I'd like to show you my code... putting it up on gist.github.com
[2012-04-17 21:04:35 -0400] eherot: newb: yeah I think we just borrowed the one from the wiki with a few minor tweaks.
[2012-04-17 21:08:24 -0400] newb: thanks @jtimberman: I read some from your blog too.
[2012-04-17 21:09:25 -0400] newb: anyways, if node[:cloud] or node[:network][:default_interface] does not have the right values, could I write a recipe to override them?
[2012-04-17 21:14:01 -0400] eherot: If I were doing this I'd probably just add new ones specific to your own site
[2012-04-17 21:14:12 -0400] eherot: and then reference those from the cookbook
[2012-04-17 21:14:21 -0400] eherot: I think that would be the "right" way if there is one
[2012-04-17 21:14:38 -0400] eherot: the correct value is almost certainly in ohai somewhere
[2012-04-17 21:14:50 -0400] eherot: so it's unlikely you'll have to write a plugin to pick them up
[2012-04-17 21:14:57 -0400] gale_: Brad_K: can you point me in the direction of an example to wait for the script to execute as you describe?
[2012-04-17 21:16:30 -0400] newb: ohai *does* have the correct values I want the recipe to use, just that the the recipe uses different (more general/universal/sane) attributes
[2012-04-17 21:16:48 -0400] Brad_K: gale_: a great deal depends on what language the restore script is written in, and what language you would want to write another script in.  then there's the issue of how you might want to monitor whether or not the process is done yet.
[2012-04-17 21:17:14 -0400] newb: for example, node[:network][:default_interface] is 'eth1' whereas I would have wanted it to be eth4 :-D
[2012-04-17 21:17:19 -0400] Brad_K: gale_: i don't know of any particular examples, but i imagine you could write a stupid-simple script of this sort in something like 5-10 lines.
[2012-04-17 21:17:32 -0400] newb: unfortunately I don't know how to make that happen
[2012-04-17 21:17:42 -0400] eherot: newb: yeah but "default_interface" has a specific definition because it's where the default route is
[2012-04-17 21:18:02 -0400] eherot: that might not be what you want in that cookbook but there may be other cookbooks that will not work correctly if you re-define that default.
[2012-04-17 21:18:18 -0400] StormSilver: newb: I would not attempt to overwrite those values
[2012-04-17 21:18:29 -0400] StormSilver: newb: If you know that eth4 is what you want, then just grab eth4 and use it
[2012-04-17 21:18:32 -0400] eherot: I think it's generally better programming practice to create a second definition that says something to the effect of "default for this situation"
[2012-04-17 21:18:41 -0400] Brad_K: newb: what you might be able to do is to change the network routing configuration on your machine so that eth4 comes up as the "default route" on boot, and then ohai should auto-discover that on the next boot.  From there, you should be good to go.
[2012-04-17 21:18:43 -0400] StormSilver: eherot: Completely agree.
[2012-04-17 21:18:55 -0400] newb: exactly, the @jtimberman said this already, but I am not sure if having multiple copies of the same cookbook per infrastucture is a good idea
[2012-04-17 21:19:11 -0400] eherot: newb: that's what roles are for :-)
[2012-04-17 21:19:46 -0400] Brad_K: multiple copies of the same cookbook would be an anti-pattern.  the cookbook should be flexible enough to handle all the various different things required of it, when you layer on the appropriate attributes and roles.
[2012-04-17 21:19:57 -0400] newb: yes! however, in this case I can't figure out what I could sue the roe for so that the node[:network] values are "right"
[2012-04-17 21:20:05 -0400] eherot: but the thing is if you can make it so that this new attribute always has the right IP regardless, you should really only need one cookbook
[2012-04-17 21:20:11 -0400] newb: EXACLTY
[2012-04-17 21:20:16 -0400] eherot: is it always eth4
[2012-04-17 21:20:16 -0400] eherot: ?
[2012-04-17 21:20:16 -0400] newb: That's what I want to do
[2012-04-17 21:20:27 -0400] eherot: is it always on a particular subnet?
[2012-04-17 21:20:42 -0400] newb: the cloud I am using uses VirtualBox and a KVM mix
[2012-04-17 21:21:23 -0400] newb: so depending on the VM it's on, the bridges interface can be eth4 or eth3 and sometimes VirtualBox assigns the bridge interface as eth1 as well
[2012-04-17 21:21:39 -0400] newb: particular subnet: I guess I could make that ahppen
[2012-04-17 21:22:16 -0400] eherot: In a pinch I guess you could say "if you can reach this host on this interface, it's the right one" but I'd be wary on making a cookbook so directly dependent on connectivity to another host.
[2012-04-17 21:23:03 -0400] newb: I know, I have been thinking about this and the only "good" answer I came up with is exactly what you said "if you can make it so that this new attribute always has the right IP regardless, you should really only need one cookbook"
[2012-04-17 21:23:38 -0400] newb: and the new attribute happens to be node[:cloud] attribute tree
[2012-04-17 21:23:45 -0400] laurent\: newb: i haven't read everything from the backlog, have you thought of writting an ohai plugin that set an automatic attribute to the "correct" ip
[2012-04-17 21:24:12 -0400] laurent\: i don't know either why ohai gives you the wrong ip :)
[2012-04-17 21:24:18 -0400] newb: yes I have and I have the plugin ready that overrides node['ipaddress']
[2012-04-17 21:24:25 -0400] laurent\: oh ok
[2012-04-17 21:25:16 -0400] newb: but I am not sure how to manage the distribution of that plugin (it would require modding the chef client config as well) and the plugin would have to be CI's too
[2012-04-17 21:25:49 -0400] laurent\: no, just use the ohai cookbook :)
[2012-04-17 21:26:01 -0400] HansCz: @jtimberman - as I said before: hmmm... I think I'm doing it right, but I get a nomethoderror when trying to invoke my resource... code: https://gist.github.com/2409139
[2012-04-17 21:26:08 -0400] eherot: laurent\, newb: I'd think as long as it's already picked up by ohai you should be able to avoid having to deal with that.
[2012-04-17 21:26:27 -0400] newb: BTW, laurent\, you are one of the key persons I came across in my research for this topic! Would you know where I can find the whole log for this: https://gist.github.com/639581
[2012-04-17 21:26:29 -0400] eherot: and make it so the cookbook you need always only ever uses that other value
[2012-04-17 21:28:49 -0400] eherot: as it happens we hardly ever use node[:ipaddress] in our shop because we haven't found that the default route is a great guide to figuring out which IP we want,
[2012-04-17 21:29:05 -0400] newb: tell me more!
[2012-04-17 21:29:09 -0400] eherot: if a cookbook hard coded the use of that attribute I'd probably just change it
[2012-04-17 21:29:21 -0400] eherot: I use the cloud attribute a lot
[2012-04-17 21:29:39 -0400] newb: laurent\, even if I use the ohai cookbook, won't I need to add the ohai plugin path to the chef client config?
[2012-04-17 21:30:10 -0400] laurent\: newb: i don't know, it comes from btm's irc logs, i don't know why he initially did the grep thing, maybe to show somebody some examples on how to use the node[:network][:interfaces] attribute
[2012-04-17 21:30:29 -0400] newb: eherot, the cloud attribute is the node[:cloud] attribute tree right?
[2012-04-17 21:30:59 -0400] laurent\: i obviously meant 'how EASY it is to use the node[:network][:interfaces] attribute" 0;-)
[2012-04-17 21:33:28 -0400] laurent\: newb: have you looked at http://wiki.opscode.com/display/chef/Distributing+Ohai+Plugins ?
[2012-04-17 21:33:36 -0400] newb: laurent\, node[:network] is an automatic attribute for which I cannot have a recipe to override them?
[2012-04-17 21:33:45 -0400] HansCz: I'm trying to make LWRP work with chef-solo and failing... I wonder why. Maybe you could take a look? https://gist.github.com/2409139
[2012-04-17 21:33:50 -0400] yfeldblum: don't override automatic attributes ... bad idea ...
[2012-04-17 21:35:48 -0400] eherot: newb: Yep
[2012-04-17 21:35:54 -0400] jtimberman: thats difficult to do for a reason.
[2012-04-17 21:35:56 -0400] jtimberman: :)
[2012-04-17 21:36:53 -0400] newb: @jtimberman, was that meant for me? :-)
[2012-04-17 21:37:02 -0400] eherot: node[:cloud][:private_ips] (it's an array)
[2012-04-17 21:37:24 -0400] newb: @jtimberman, you answer tells me it's possible to override automatic attributes from a recipe?
[2012-04-17 21:37:48 -0400] newb: eherot, correct. infochimps uses the first ip in the list
[2012-04-17 21:37:51 -0400] laurent\: eherot: default route might not always be the best choice, you could always maintain a ipaddress_from_fqdn attribute with an ohai plugin
[2012-04-17 21:38:23 -0400] laurent\: ipaddress_from_fqdn Socket::gethostbyname(fqdn)[3].unpack("CCCC").join('.')
[2012-04-17 21:38:53 -0400] jtimberman: its general statement.
[2012-04-17 21:39:04 -0400] jtimberman: its not really possible, no.
[2012-04-17 21:39:23 -0400] jtimberman: like, you *can* because its ruby, so you can do anything really.
[2012-04-17 21:39:33 -0400] laurent\: :-)
[2012-04-17 21:39:44 -0400] jtimberman: but its not a trivial bit of code to override an automatic attribute.
[2012-04-17 21:40:02 -0400] newb: laurent\, is writing and deploying a ohai plugin as simple as forking the ohai coookbook, adding my .rb, uploading it to chef server and adding recipe['Ohai'] to the node I want to pllugin to work on?
[2012-04-17 21:40:03 -0400] jtimberman: i wouldn't tell you how if i knew off hand because you really, really shouldn't do that :).
[2012-04-17 21:40:11 -0400] eherot: laurent\: Yep.  Or you could just do correct_ip=Resolv.getaddress("fqdn.domain.com")
[2012-04-17 21:40:14 -0400] jtimberman: newb: yes
[2012-04-17 21:40:19 -0400] eherot: right in the cookbook that is
[2012-04-17 21:40:28 -0400] jtimberman: newb: you stick your .rb file in the ohai cookbook's files dir
[2012-04-17 21:40:30 -0400] newb: I agree @jtimberman. I have ohai plugin to do what I want anyways :-D
[2012-04-17 21:40:34 -0400] jtimberman: there ya go
[2012-04-17 21:40:39 -0400] jtimberman: that is the right approach :)
[2012-04-17 21:41:31 -0400] yfeldblum: jtimberman, "nontrivial" means >= 3 lines?
[2012-04-17 21:41:37 -0400] newb: but what if I wanted to stuff in the 'correct' ip into node[:cloud][:private_ips]? that could be chnaged from a recipe, no?
[2012-04-17 21:41:48 -0400] jtimberman: yfeldblum: its not the number of lines.
[2012-04-17 21:42:12 -0400] jtimberman: yfeldblum: finding the proper sequence of methods on the right objects and alll that jazz :)
[2012-04-17 21:42:13 -0400] Brad_K: newb: what you would be putting into the ohai cookbook would be a recipe.  ;-)
[2012-04-17 21:42:41 -0400] eherot: newb: does node[:cloud][:public_ips] contain the IP you want?
[2012-04-17 21:42:50 -0400] eherot: and if not that, does it show up anywhere in the node object?
[2012-04-17 21:43:30 -0400] yfeldblum: jtimberman, however, the issue discussed is a real issue that affects a lot of people (by "a lot of people", i mean "principally me, and probably others as well")
[2012-04-17 21:43:44 -0400] newb: eherot, no there is no node[:cloud] to begin with it seems, but the "right" ip shows up in node[:network]
[2012-04-17 21:44:12 -0400] yfeldblum: jtimberman, node["ipaddress"] is often NOT the ipaddress a given server should listen on, but a lot of cookbooks, including a lot of cookbooks from opscode, assume it is
[2012-04-17 21:44:33 -0400] newb: yfeldblum, correct
[2012-04-17 21:44:35 -0400] jtimberman: its a "sane default"
[2012-04-17 21:44:42 -0400] laurent\: newb: btw, why is it the right ip ? :)
[2012-04-17 21:44:44 -0400] jtimberman: thats the point.
[2012-04-17 21:44:47 -0400] jtimberman: :)
[2012-04-17 21:44:57 -0400] Brad_K: newb: how do you know it's the right ip?
[2012-04-17 21:45:11 -0400] newb: laurent\: awesome question! do you have a blog/website?
[2012-04-17 21:45:53 -0400] yfeldblum: jtimberman, however, we often cannot reuse the cookbook, even with "dynamic patching" (reaching in from a subsequent recipe and altering resources declared in the original recipe)
[2012-04-17 21:45:57 -0400] laurent\: newb: myself, no, never had :) i wouldn't know what to publish on it :)
[2012-04-17 21:46:24 -0400] newb: laurent\, to answer your question: its the right ip because bridged interfaces can be accessed from outside the VM network and I want to set up a heteregenous cluster cosisting of inhouse VMs and EC2
[2012-04-17 21:46:25 -0400] yfeldblum: jtimberman, and many of the cookbooks are just fine, except for that one item, and it would be a shame to have to fork all these cookbooks just for the one issue
[2012-04-17 21:46:53 -0400] newb: yfeldblum, exactly
[2012-04-17 21:47:38 -0400] laurent\: those cookbooks need patching then ! 0:-)
[2012-04-17 21:47:41 -0400] yfeldblum: jtimberman, this one issue is very common, and it is usually the only issue i face with third-party cookbooks
[2012-04-17 21:48:17 -0400] Brad_K: newb: how can you tell that particular interface is bridged, while the others are NAT'ed?  are they on different subnets?
[2012-04-17 21:48:20 -0400] laurent\: default[:cookbook][:ipaddress] = node[:ipaddress] would that be ok ?
[2012-04-17 21:48:38 -0400] Urocyon: my saga of trying to use infochimp cookbooks continues.  Installing elasticsearch::server I've run into an undefined method error in the included volumes cookbook.
[2012-04-17 21:48:47 -0400] Urocyon: Anyone have success using this?
[2012-04-17 21:49:05 -0400] Brad_K: i'm sure that mrflip has had some success with it.  ;-)
[2012-04-17 21:51:16 -0400] Urocyon: one would hope.
[2012-04-17 21:51:34 -0400] eherot: i.e. if you were to do knife node show -l NODE | grep IP would it show up?  And if so, where?
[2012-04-17 21:52:37 -0400] laurent\: newb: i have a lot of VM with like 3/4 ifaces each, i use iproute and routing tables so i can have the main default route for internal traffic/admin/monitoring/chef/... and another default route in another table with source routing (public/external traffic)
[2012-04-17 21:53:32 -0400] laurent\: ohai doesn't know how to deal with iproute tables and ip rules yet :-)
[2012-04-17 21:53:36 -0400] newb: Brad_K, different subnets yes
[2012-04-17 21:55:38 -0400] Brad_K: newb: okay, so if they're on different subnets, is there one subnet that you could always choose above any other?  and if so, can you set up the networking configuration on each box so that when it boots up, that becomes the "default" interface?  if you can do that, then all the ohai problems just fall away  you detect in an appropriate cookbook/recipe what the current default IP address is and whether or not it is on the specified network, and if no
[2012-04-17 21:55:53 -0400] Brad_K: newb: this is exactly what we do in our "hostname" cookbook.  we
[2012-04-17 21:56:20 -0400] Brad_K: newb: we're on Rackspace and not EC2, so we have slightly different problems, but this is the method we use.
[2012-04-17 21:56:56 -0400] jtimberman: yfeldblum left :/
[2012-04-17 22:03:42 -0400] eherot: newb: btw if you do decide to go the subnet route
[2012-04-17 22:03:46 -0400] eherot: check out the ipaddress gem
[2012-04-17 22:03:48 -0400] eherot: very handy
[2012-04-17 22:09:58 -0400] tolland: :q
[2012-04-17 22:36:46 -0400] Brad_K: ttyl!
[2012-04-17 22:39:34 -0400] wassy121: Hi, question might be not-quite-chef, but I'm trying to use: https://github.com/xdissent/chef-hatch-repo , and I can't get "librarian-chef install" to work right.  It give me this error: http://pastebin.ca/2137355
[2012-04-17 22:40:12 -0400] wassy121: It looks like some missing temp/cache files; like they didn't get created when they should have?  I don't see a channel around this specific tool, so figured #chef might have some idea
[2012-04-17 22:41:17 -0400] jtimberman: yfeldblum: you're back :)
[2012-04-17 22:41:56 -0400] jtimberman: yfeldblum: i agree that it sucks to have to modify cookbooks to change which attribute is used
[2012-04-17 22:42:51 -0400] tarrant: yfeldblum: I fail with github. Apologies if I spammed your inbox.
[2012-04-17 22:45:21 -0400] miah: there is no fail, only learn from mistake.
[2012-04-17 22:45:38 -0400] bemu: Urocyon: I used this one: https://github.com/harlanbarnes/elasticsearch-cookbook
[2012-04-17 22:45:44 -0400] bemu: and modified it a bit.
[2012-04-17 22:45:54 -0400] bemu: I don't recall why I ruled out the infochimps one.
[2012-04-17 22:46:07 -0400] miah: probably because of ironfan requirements
[2012-04-17 23:00:58 -0400] yfeldblum: jtimberman, hola
[2012-04-17 23:01:05 -0400] hoover_damn: i'm going to enjoy it
[2012-04-17 23:01:10 -0400] hoover_damn: I wrote one previously, was quite happy with it
[2012-04-17 23:01:17 -0400] hoover_damn: I figure my next iteration should be fantastic
[2012-04-17 23:01:41 -0400] yfeldblum: jtimberman, and i agree that node["ipaddress"] is the sensible default (although node["fqdn"] is better)
[2012-04-17 23:01:53 -0400] laurent\: who hasn't written his own ES cookbook yet ? :)
[2012-04-17 23:02:06 -0400] hoover_damn: lots
[2012-04-17 23:02:22 -0400] hoover_damn: and actually one that is worth sharing is hard
[2012-04-17 23:05:46 -0400] laurent\: hey i wrote one ! :-)
[2012-04-17 23:06:23 -0400] hoover_damn: so did I
[2012-04-17 23:06:29 -0400] hoover_damn: I wrote one fora PaaS though
[2012-04-17 23:06:43 -0400] hoover_damn: so it holds little value without modification
[2012-04-17 23:07:04 -0400] hoover_damn: laurent\, I kept meaning to get deeper into S3 logging
[2012-04-17 23:07:05 -0400] hoover_damn: but didn't
[2012-04-17 23:13:05 -0400] jtimberman: yfeldblum: the problem with node['fqdn'] is of course that not everyone has DNS set up properly :)
[2012-04-17 23:13:17 -0400] jtimberman: and then the conflated problem of cloud providers and which one is accessible.
[2012-04-17 23:13:36 -0400] jtimberman: laurent\: s/ES/redis/, too :)
[2012-04-17 23:13:55 -0400] miah: lol. ya. we've all written redis cookbooks.
[2012-04-17 23:14:09 -0400] tarrant: Ours make me want to cry ;)
[2012-04-17 23:18:41 -0400] laurent\: node['fqdn'] would at least require correct defaults for nsswitch and /etc/hosts :)
[2012-04-17 23:22:29 -0400] miah: tarrant: ours is straight forward https://github.com/cxinc/chef-redis
[2012-04-17 23:26:47 -0400] ashr: newb Question - WHen I last used Chef, I was restriced to using Ruby 1.9.2 and that was a lot of work monkey patching different templates and recipes to make it work, if I recall I even had to add RVM into the Mix.
[2012-04-17 23:27:15 -0400] ashr: While I am excited to play with Chef again, I wonder if there isn't by now a standard solution for getting Ruby 1.9.3 up and running on a typical linux instance.
[2012-04-17 23:27:33 -0400] ashr: I have NO preferences for any particular setup other than the fact that I am using EC2, and want Ruby 1.9.3p0 or greater.
[2012-04-17 23:27:48 -0400] yfeldblum: ashr, to run chef with or to run apps with?
[2012-04-17 23:27:58 -0400] ashr: I've done  bit of googleing and stackoverflowing and no common solution seems to crop up
[2012-04-17 23:28:03 -0400] ashr: that doesn't feel kludged
[2012-04-17 23:28:11 -0400] ashr: so thought I'd jump into the IRC and see what's the consensus
[2012-04-17 23:28:23 -0400] ashr: yfeldblum:  To run the app
[2012-04-17 23:28:34 -0400] ashr: My dev machine is Mac OSx Lion, and Chef works fine.
[2012-04-17 23:28:43 -0400] yfeldblum: ashr, i'm currently using rvm via https://github.com/fnichol/chef-rvm
[2012-04-17 23:28:52 -0400] ashr: But I want to be able to launch instances with my app, which runs on ruby 1.9.3p0 or greater
[2012-04-17 23:29:22 -0400] ashr: and I really really really don't want to have to compile ruby every time I launch,
[2012-04-17 23:29:36 -0400] ashr: Hey yfeldblum, I think we've chatted before.
[2012-04-17 23:29:46 -0400] ashr: So you're happy with RVM on a production environment?
[2012-04-17 23:30:00 -0400] ashr: and the fnichol gem is still the best way to go huh?
[2012-04-17 23:30:07 -0400] miah: im using rvm in production and its fine
[2012-04-17 23:30:10 -0400] ashr: That's what I did back in Feb or Jan or whenever we spoke last.
[2012-04-17 23:30:29 -0400] ashr: Is it still only with Natty?
[2012-04-17 23:30:42 -0400] ashr: or does it work on 11.10 Ubuntu?
[2012-04-17 23:30:44 -0400] ashr: anyone know?
[2012-04-17 23:30:54 -0400] miah: does shat work on 11.10? rvm should, as does chef.
[2012-04-17 23:30:57 -0400] Xylo: @yfeldblum: Do you know how to install thin with chef-rvm? On the console it's just "gem install thin" and "rvmsudo thin install" but I don't know how to execute this with chef
[2012-04-17 23:31:00 -0400] miah: s/shat/what
[2012-04-17 23:31:17 -0400] ashr: The 'setup'
[2012-04-17 23:31:18 -0400] yfeldblum: ashr fnichol's cookbook, not gem
[2012-04-17 23:31:24 -0400] ashr: right
[2012-04-17 23:31:25 -0400] ashr: sorry
[2012-04-17 23:31:25 -0400] jtimberman: ashr: if you don't want to compile it on every system, then build a package and ship that.
[2012-04-17 23:31:32 -0400] ashr: terminolgy /context switch.
[2012-04-17 23:31:34 -0400] jtimberman: install w/ a cookbook
[2012-04-17 23:31:35 -0400] ashr: Brain #fail
[2012-04-17 23:31:57 -0400] ashr: @jtimberman, I was pretty sure you were going to suggest that.
[2012-04-17 23:32:10 -0400] jtimberman: :)
[2012-04-17 23:32:23 -0400] ashr: I might do that....but I think for expediancy, I might go with fnichols cookbook
[2012-04-17 23:32:25 -0400] ashr: first
[2012-04-17 23:32:30 -0400] jtimberman: sure
[2012-04-17 23:32:36 -0400] jtimberman: timtowtdi
[2012-04-17 23:33:09 -0400] ashr: okay you young'uns have lost me with that last acronym.  "timtowdi"  ?
[2012-04-17 23:33:23 -0400] yfeldblum: Xylo, i require every application to have a Gemfile & Gemfile.lock, and every application to have a run command, and usually that run command starts with "bundle exec", and if the application wants to use thin, then the application's start script has to be e.g. "bundle exec script/rails server thin -p $PORT"
[2012-04-17 23:34:36 -0400] ashr: got it.  I jfgi and so yes, timtowdi.   Memory lock  thanks guys.
[2012-04-17 23:37:02 -0400] Xylo: @yfeldblum: I understand... but how do you start the application then? "rvmsudo thin install" would create init.d-startup scripts for thin which then would start the configured servers.
[2012-04-17 23:38:18 -0400] yfeldblum: Xylo, maybe i'm confused, but what does `rvmsudo thin install` do?
[2012-04-17 23:39:29 -0400] Xylo: @yfeldblum: it creates startup-skripts in /etc/init.d so that the webserver thin will start up on system boot. like apache starts with /etc/init.d/apache2, thin will startup with /etc/init.d/thin, which has to be created
[2012-04-17 23:39:46 -0400] Xylo: but now that you ask... I could simply create that file myself with chef
[2012-04-17 23:40:59 -0400] yfeldblum: Xylo, yes you could, and you probably should, and should certainly not use `thin install` if you didn't install `thin` into the system rubygems (which you don't if you're using RVM)
[2012-04-17 23:42:27 -0400] Xylo: @yfeldblum: I did install it into the global_gems (attribute of chef-rvm)
[2012-04-17 23:42:45 -0400] HarvesterOfBeer: hello. I've got a question on setting up a chef workstation
[2012-04-17 23:42:53 -0400] HarvesterOfBeer: looking at http://wiki.opscode.com/display/chef/Workstation+Setup+for+Mac+OS+X
[2012-04-17 23:43:05 -0400] yfeldblum: Xylo, it's also not going to work if you're trying to run an application that uses bundler
[2012-04-17 23:43:16 -0400] HarvesterOfBeer: it wants me to create the .chef directory inside the checked out chef repo?
[2012-04-17 23:43:29 -0400] yfeldblum: Xylo, which i would recommend mandating, and enforcing with an iron fist
[2012-04-17 23:43:33 -0400] HarvesterOfBeer: isn't the .chef dir where my personal configs are stored?
[2012-04-17 23:44:28 -0400] Xylo: @yfeldblum what do you mean by that? use bundle to install thin?
[2012-04-17 23:44:46 -0400] yfeldblum: HarvesterOfBeer, no, not personal configs - configs pertaining to the local copy of that repo
[2012-04-17 23:45:31 -0400] Xylo: @yfeldblum: The init.d-Skript executes /usr/local/rvm/gems/ruby-1.9.3-p0@global/bin/thin
[2012-04-17 23:45:39 -0400] HarvesterOfBeer: yfeldblum: ahhh. thanks
[2012-04-17 23:46:41 -0400] yfeldblum: Xylo, here's how i do it: every application must have a Gemfile and Gemfile.lock; to deploy the application, start off by running `bundle install --deployment --clean --without development:test` (determined by the application); to run the application, run `bundle exec ...` (determined by the application)
[2012-04-17 23:47:17 -0400] Xylo: @yfeldblum: when the server reboots, how is the application started?
[2012-04-17 23:48:59 -0400] yfeldblum: Xylo, a runit script that loads rvm, switches to the application's target ruby, and runs `bundle exec script/rails server thin` (determined by the application)
[2012-04-17 23:50:09 -0400] Xylo: @yfeldblum: that sound's perfect, do you have an example of this type of script?
[2012-04-17 23:52:23 -0400] yfeldblum: Xylo, `source /etc/profile.d/rvm.sh ; rvm use <%= @app_ruby %> ; cd <%= @app_path %> ; sudo -u <%= @app_user %> ; exec <%= @app_run_script %>`
[2012-04-17 23:52:36 -0400] hoover_damn: hosting rvm... lol
[2012-04-17 23:52:40 -0400] hoover_damn: wow
[2012-04-17 23:54:13 -0400] Xylo: @yfeldblum: thank you, I think it's exactly what I was looking for!
[2012-04-17 23:54:31 -0400] hoover_damn: if your going to host rvm you should a) ensure your bash logs in... b) use rvm script's... to create bin-scripts that are alias'd to the right version
[2012-04-17 23:54:44 -0400] hoover_damn: it will save you a lot of hassle
[2012-04-17 23:55:35 -0400] yfeldblum: hoover_damn, not sure what hassle you're seeing in the example i just showed?
[2012-04-17 23:58:44 -0400] hoover_damn: yfeldblum, you should use rvm-sudo for one
[2012-04-17 23:58:47 -0400] hoover_damn: not sudo
