[2012-04-26 00:10:09 -0400] z: daaaan: what type of history?
[2012-04-26 00:12:31 -0400] dangerdave: What's the best way to get chef client installed on Ubuntu 12.04? How about chef server?
[2012-04-26 00:12:59 -0400] z: ? fast start
[2012-04-26 00:13:19 -0400] z: dangerdave: http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-04-26 00:13:52 -0400] dangerdave: z: installing from packages on 12.04 == doom. everything from ohai segfaulting to various of the chef server processes not starting up successfully.
[2012-04-26 00:14:23 -0400] z: has worked in the past for me, but.....
[2012-04-26 00:14:24 -0400] z: http://blog.milford.io/2012/03/the-joy-of-the-opscode-chef-omnibus-installer/
[2012-04-26 00:14:29 -0400] z: ^ Omnibus is equally awesome.
[2012-04-26 00:15:46 -0400] dangerdave: z: interesting, thanks.
[2012-04-26 00:16:06 -0400] z: if you can wait then I hear 0.10.10 will ship with 12.04 via Omnibus in a "properly supported" manner
[2012-04-26 00:16:14 -0400] xmltok: has anyone seen a good writeup on managing recipes in git and following through with pushing those changes through environments?
[2012-04-26 00:16:29 -0400] dangerdave: z: ha, "proper support" sounds delightful
[2012-04-26 00:16:38 -0400] z: "proper support" = someone tested it
[2012-04-26 00:39:16 -0400] joemiller: xmltok: this might help. it was written with an org using puppet in mind, but could work for chef: https://github.com/joemiller/git-flux
[2012-04-26 00:46:32 -0400] josephholsten: anyone tried running knife bootstrap from chef 0.10.10 within ruby 1.9.x or 2.x?
[2012-04-26 00:50:19 -0400] hoover_damn: what's the issue?
[2012-04-26 01:00:07 -0400] dangerdave: Hah! The suggested omnibus installer uses http://, not https://; the https server redirects to http. Fun times. (Best answer: use https://s3.amazonaws.com/opscode-full-stack/install.sh as the URL)
[2012-04-26 01:01:05 -0400] dangerdave: plus side: the omnibus installer actually works on 12.04 ;-)
[2012-04-26 01:02:35 -0400] dangerdave: unfortunately, the omnibus script downloads a bunch of other stuff via HTTP, not HTTPS.
[2012-04-26 01:02:39 -0400] dangerdave: so hard to trust the whole thing
[2012-04-26 01:07:21 -0400] UForgotten: anyone have time to help me with a sysctl cookbook problem?
[2012-04-26 01:07:37 -0400] josephholsten: UForgotten: probably not, but shoot
[2012-04-26 01:08:27 -0400] UForgotten: josephholsten: I'm using spheromak's sysctl cookbook. It is generating the output wrong and I can't figure out how to properly do a callback to an execute statement
[2012-04-26 01:09:40 -0400] UForgotten: hoover_damn: hello again :)
[2012-04-26 01:14:25 -0400] UForgotten: I might have figured it out, trying now
[2012-04-26 01:15:33 -0400] UForgotten: wtf?
[2012-04-26 01:15:33 -0400] bawt: wtf is that about..
[2012-04-26 01:29:22 -0400] UForgotten: nope still broken
[2012-04-26 01:29:28 -0400] UForgotten: damn that was a hell of a netsplit or something
[2012-04-26 02:29:01 -0400] hcastro: is it possible to override node attributes from a role to nil when its default value is non-nil?
[2012-04-26 02:37:28 -0400] miah: why wouldn't it be possible to override with nil?
[2012-04-26 02:39:29 -0400] hcastro: miah: because when i try to override with nil the default value is showing up -- the override to nil is being bypassed
[2012-04-26 02:40:30 -0400] miah: are you setting a override_attribute, or a normal_attribute?
[2012-04-26 02:40:51 -0400] hcastro: override_attribute
[2012-04-26 02:41:20 -0400] miah: are you certain that attribute has been updated in the role? (i honestly haven't tried this, but i dont see why it wouldnt work)
[2012-04-26 02:45:25 -0400] hcastro: yeah, i made sure i updated the role
[2012-04-26 02:46:02 -0400] hcastro: looking at the code, i think overriding to nil acts similarly to not being present at all
[2012-04-26 02:46:06 -0400] miah: hrm
[2012-04-26 02:49:22 -0400] miah: false vs nil ?
[2012-04-26 03:04:37 -0400] spheromak: prob a but in deep merge
[2012-04-26 03:04:42 -0400] spheromak: *bug/feature
[2012-04-26 03:21:15 -0400] miah: spheromak: its your fault
[2012-04-26 03:21:30 -0400] miah: spheromak: are you coming to chefconf?
[2012-04-26 03:34:06 -0400] kreedy_: ruby just makes at lot more sense to me after 9pm for some reason
[2012-04-26 03:59:01 -0400] spheromak: miah: dunno still if i will be in the states or in South Africa around that time
[2012-04-26 04:03:44 -0400] leed0: is there any way to use the -A ssh option with `knife ssh` ?
[2012-04-26 04:04:13 -0400] leed0: (ssh-agent forwarding)
[2012-04-26 04:04:31 -0400] spheromak: hcastro: you have the example attribute and override in a gist or pastie ?
[2012-04-26 04:50:58 -0400] BryanWB: ohai chefs!
[2012-04-26 04:51:23 -0400] miah: hi BryanWB
[2012-04-26 04:51:34 -0400] miah: spheromak: ah awesome =) enjoy your travels.
[2012-04-26 04:53:28 -0400] |shad0w|: just catching up on foodfight BryanWB
[2012-04-26 04:54:01 -0400] BryanWB: |shad0w|: kewl, u can tell me how much audio hasn't improved ;)
[2012-04-26 04:54:05 -0400] |shad0w|: much
[2012-04-26 04:54:18 -0400] |shad0w|: | | < that much
[2012-04-26 04:54:22 -0400] |shad0w|: meh, space strips
[2012-04-26 04:55:56 -0400] miah: oh i still need to listen to new episode
[2012-04-26 04:57:51 -0400] BryanWB: |shad0w|: ?? space strips?
[2012-04-26 04:58:02 -0400] spheromak: strip!
[2012-04-26 04:59:11 -0400] |shad0w|: |................................................................| that much :P
[2012-04-26 05:00:45 -0400] BryanWB: |shad0w|: gr8 to heare
[2012-04-26 05:01:21 -0400] miah: guh. i am tired.
[2012-04-26 05:04:09 -0400] BryanWB: miah: have any ideas for chef hackday on Tuesday afternoon ahead of chefconf?
[2012-04-26 05:06:02 -0400] miah: ideas like?
[2012-04-26 05:06:12 -0400] miah: shall we tackle certain issuse?
[2012-04-26 05:06:45 -0400] miah: i was thinking we could unconf, but tell people to primarily hax0r on chef related things
[2012-04-26 05:07:11 -0400] miah: it would be cool to see people break up into groups and make awesome cookbooks, fix issues, or just educate
[2012-04-26 05:17:32 -0400] miah: BryanWB: i feel like this episode of foodfight is extra lulzy
[2012-04-26 05:18:04 -0400] |shad0w|: ditto :)
[2012-04-26 05:38:15 -0400] BryanWB: miah:  yeah, whether to be focused on something specific or keep it loose
[2012-04-26 05:38:42 -0400] BryanWB: |shad0w|: , miah: :( my internet-speak is weak, what does lulzy mean?
[2012-04-26 05:43:13 -0400] miah: oh. its like lol
[2012-04-26 05:43:22 -0400] miah: i guess its silly / lol i dunno
[2012-04-26 05:43:29 -0400] miah: i only speak internet and regular english is weird
[2012-04-26 05:43:54 -0400] erikh: heh
[2012-04-26 05:43:58 -0400] miah: http://ohinternet.com/Lulz
[2012-04-26 05:43:59 -0400] miah: here you are
[2012-04-26 05:44:01 -0400] miah: the official definitions
[2012-04-26 05:45:08 -0400] BryanWB: miah: tks, i m enlightened now ;)
[2012-04-26 05:45:25 -0400] miah: sures
[2012-04-26 05:45:50 -0400] miah: guhs. i dont know why i am so tired.
[2012-04-26 05:45:56 -0400] |shad0w|: hmm, think they'll let me submit the foodfight discount for chefconf even if i'm already registered?
[2012-04-26 05:46:00 -0400] |shad0w|: didn't see it until today
[2012-04-26 05:46:22 -0400] BryanWB: |shad0w|: don't know, maybe
[2012-04-26 06:26:45 -0400] miah: BryanWB: overall, good episode =)
[2012-04-26 07:00:26 -0400] BryanWB: miah: tks, what could be improved?
[2012-04-26 07:07:38 -0400] eugenmayer: is there now way to add own report_handler using the chef-client cookbook?
[2012-04-26 07:08:32 -0400] eugenmayer: looking at https://github.com/opscode/cookbooks/blob/master/chef-client/templates/default/client.rb.erb
[2012-04-26 07:08:48 -0400] eugenmayer: and the readme ( which obv outdated ), i cant see a way
[2012-04-26 07:39:11 -0400] jordandm: Does someone have a link to the Omnibus installer page? I don't have it any longer and I can't find it via Goodle.
[2012-04-26 08:03:31 -0400] zts: eugenmayer: you want the chef_handler cookbook and LWRP
[2012-04-26 08:04:10 -0400] zts: http://community.opscode.com/cookbooks/chef_handler
[2012-04-26 08:08:34 -0400] eugenmayer: zts: hmm, how do they get included?
[2012-04-26 08:08:44 -0400] eugenmayer: the config-file is "controled" by the "chef-client" reciepe
[2012-04-26 08:09:56 -0400] eugenmayer: zts: not sure, but it looks like this is rather only deployment, but not included in the client.rb then?
[2012-04-26 08:10:41 -0400] eugenmayer: or are all handlers in the handler-path automatically included by chef?
[2012-04-26 08:11:04 -0400] eugenmayer: what iam doing is using an nsca handler to report back to icinga, when a run fails
[2012-04-26 08:11:12 -0400] eugenmayer: Babar: do you already do something like that?
[2012-04-26 08:12:19 -0400] jannel: does anyone know how to get notifications from an inner resource used in a lwrp provider? I want my resource to make a notification when remote_file resource has changed. new_resource.updated_by_last_action(remote_file_resource.updated_by_last_action?) does not seem to work
[2012-04-26 08:13:02 -0400] jannel: so I want to propagate the notification from another resource
[2012-04-26 09:29:23 -0400] mosez: http://pastebin.com/Ts4a7HQP why the hell did i get a "due to only_if ruby block" here?
[2012-04-26 09:38:36 -0400] alclonky: is there a way to do templates per Role? i want to do iptables with chef and whould need rules defindet per role
[2012-04-26 09:39:42 -0400] eugenmayer: alclonky: maybe look at https://github.com/EugenMayer/shorewall
[2012-04-26 09:40:10 -0400] eugenmayer: its not iptables, but its a file-base chef controlled iptables "layer" based on shorewall
[2012-04-26 09:41:09 -0400] alclonky: but i whould have to put the rules into the role attributes
[2012-04-26 09:41:14 -0400] eugenmayer: you can reused exisiting rules ( include ) using enabled_rules or create rules for nodes /roles on the fly using new_rule{"ssh.net":"ACCEPT net fw TCP 22","ssl.net":"ACCEPT net fw TCP 443"}
[2012-04-26 09:41:16 -0400] alclonky: i whould like to have templates
[2012-04-26 09:41:26 -0400] eugenmayer: then write recipes
[2012-04-26 09:41:41 -0400] eugenmayer: there is a shorewall LWRP based cookbook
[2012-04-26 09:41:58 -0400] eugenmayer: you can, using my shorewall cookbook, deployed tempaltes into
[2012-04-26 09:42:11 -0400] eugenmayer:  /etc/shorewall/enabled-rules-custom/
[2012-04-26 09:42:19 -0400] eugenmayer: those get included then
[2012-04-26 09:42:38 -0400] alclonky: but i cant' to cookbook/templates/<rolename> subfolders
[2012-04-26 09:43:30 -0400] eugenmayer: oO
[2012-04-26 09:43:45 -0400] eugenmayer: never seen that.
[2012-04-26 09:44:11 -0400] alclonky: can i get a list of roles from the node
[2012-04-26 09:44:11 -0400] alclonky: node.roles or so
[2012-04-26 09:44:12 -0400] alclonky: ?
[2012-04-26 09:44:18 -0400] eugenmayer: looks like you want to hack a "deploy that firewall template" on a client, which can be done by a generic recipe
[2012-04-26 09:44:25 -0400] eugenmayer: search
[2012-04-26 09:44:27 -0400] alclonky: or do i have to get them from the runlist
[2012-04-26 09:45:19 -0400] eugenmayer: search?
[2012-04-26 09:45:20 -0400] bawt: search is http://wiki.opscode.com/display/chef/Search
[2012-04-26 09:47:53 -0400] eugenmayer: (maybe there is a shortcut, i dont know) Google will help
[2012-04-26 09:47:55 -0400] alclonky: ok i could search for nodes with that role and look if i am in there
[2012-04-26 09:48:12 -0400] alclonky: i hoped to get the roles from the node
[2012-04-26 09:49:12 -0400] eugenmayer: iam a chef-beginner, so dont take make statements for granted :)
[2012-04-26 09:51:09 -0400] alclonky: but i think the search way will work for me
[2012-04-26 09:51:12 -0400] alclonky: thanks
[2012-04-26 10:11:42 -0400] sampikesley: hmm
[2012-04-26 10:11:49 -0400] sampikesley: trying to do
[2012-04-26 10:12:01 -0400] sampikesley: trying to install git
[2012-04-26 10:12:06 -0400] sampikesley: with the package resource
[2012-04-26 10:12:12 -0400] sampikesley: it's trying to install a specific version
[2012-04-26 10:12:16 -0400] sampikesley: which doesn't exist
[2012-04-26 10:12:42 -0400] sampikesley: how can I say "get whatever the hell version you can find"?
[2012-04-26 10:43:46 -0400] mosez: man... these old rubygems versions on debian sucks :(
[2012-04-26 10:46:12 -0400] gale: why everyone moves to ubuntu eventually!
[2012-04-26 10:46:19 -0400] gale: not that i have yet
[2012-04-26 10:46:54 -0400] eugenmayer: mosez: use RVM.
[2012-04-26 10:47:13 -0400] eugenmayer: i cant see any sense in really using apt for maintaining ruby / gems under debian.
[2012-04-26 10:47:33 -0400] mosez: eugenmayer: for projects yes. but systemwide default?
[2012-04-26 10:47:51 -0400] mosez: then chef makes more trouble i think
[2012-04-26 10:47:53 -0400] eugenmayer: mosez: well, for my taste
[2012-04-26 10:48:16 -0400] eugenmayer: every single ruby app should be "bundler", or if not, it should be "encapsulated" into a user
[2012-04-26 10:48:21 -0400] eugenmayer: providing this gems
[2012-04-26 10:48:47 -0400] mosez: how could i overwrite the gem_package behavior that every gem_package gets installed with my rvm version? have i got to write everywhere the gem binary path?
[2012-04-26 10:51:42 -0400] mosez: eugenmayer: i dont want to define on every gem_package call the gem binary manually :(
[2012-04-26 10:52:45 -0400] eugenmayer: iam running squeeze
[2012-04-26 10:52:53 -0400] eugenmayer: and i dont run into any kind of ruby issues
[2012-04-26 10:53:39 -0400] mosez: eugenmayer: and how did you install gems with gem_package on the rvm default version?
[2012-04-26 10:53:48 -0400] eugenmayer: bootstrap
[2012-04-26 10:54:14 -0400] eugenmayer: on 99% the clients. On the one i have chef ( with rvm + bundler ) i installed using bootstrap and then symlinked the binaray
[2012-04-26 10:55:08 -0400] mosez: eugenmayer: so you dont use gem_package...
[2012-04-26 10:55:24 -0400] eugenmayer: no, i use chef bootstrap.
[2012-04-26 11:34:04 -0400] Joey_: good day all
[2012-04-26 11:34:07 -0400] Joey_: quick question
[2012-04-26 11:34:55 -0400] Joey_: Was looking for it, but couldn't find it: is there an overview diagram, like a class diagram of how all different concepts (cookbooks, recips, run lists and so on) relate to each other?
[2012-04-26 11:36:07 -0400] BryanWB: Joey_: there may be one on the wiki somewhere, but i know there awesome ones in here http://learnchef.getharvest.com/introduction.html#mapping
[2012-04-26 11:36:35 -0400] BryanWB: Joey_: but by class, do u mean in terms ruby classes and modules?
[2012-04-26 11:36:54 -0400] Joey_: couldn't find it in the wiki (you would expect that) but the getharvest.com is great. Thanks!
[2012-04-26 11:37:08 -0400] Joey_: And with class I meant something to model the concepts, not necessarily the implementaiton classes
[2012-04-26 11:37:31 -0400] BryanWB: Joey_: there's more good stuff on that site, just use left and right arrows to see more
[2012-04-26 11:47:14 -0400] oponder: Hello friendly chefs, i got a question about chef and the solr index, and particularly about rebuilding the index
[2012-04-26 11:49:19 -0400] oponder: basically after a server restart, some things were not wokring too great... all chef-client runs failed, I had to purge all cookbooks and reupload to get that working again.
[2012-04-26 11:49:28 -0400] oponder: now some searches arent working, and i figured reindexing might help
[2012-04-26 11:49:34 -0400] oponder: but reindexing is also not possible
[2012-04-26 11:49:49 -0400] oponder: I get this kinda vague error when i try knife index rebuild: http://pastebin.com/YF3VH5Ny
[2012-04-26 11:54:55 -0400] laurent\: oponder: and what about server logs ? pretty it's less vague over there :)
[2012-04-26 11:55:12 -0400] oponder: ooh ok
[2012-04-26 11:55:22 -0400] oponder: could you hint me at what log I should peak in?
[2012-04-26 11:56:02 -0400] ashb: /var/log/chef/chef-server.log and chef-solr.log i think
[2012-04-26 11:57:38 -0400] oponder: ah great!, i have found a new lead
[2012-04-26 11:58:13 -0400] oponder: Chef::Exceptions::Solr Connection Error   .. will try to investigate a bit. As far as I can tell though solr is running
[2012-04-26 12:28:26 -0400] geekbri: Who do I gotta give a big sloppy hug to, to get the opscode community site to render .md files like github does?
[2012-04-26 12:31:47 -0400] BryanWB: geekbri: coderanger
[2012-04-26 12:32:06 -0400] geekbri: consider it done.
[2012-04-26 12:43:03 -0400] proffalken: If I include something in atrributes (node['foo'] = 'bar') I can then search on that right?
[2012-04-26 12:58:05 -0400] BryanWB: is it possible to source a block of text from another file in an erb template?
[2012-04-26 13:00:20 -0400] yfeldblum: BryanWB, not as far as i know, but the Embedd RuBy in one ERB template can certainly invoke the ERB engine to render another ERB template file
[2012-04-26 13:01:54 -0400] BryanWB: yfeldblum: yeah, that's what I want to do
[2012-04-26 13:01:59 -0400] BryanWB: yfeldblum: good morning btw ;)
[2012-04-26 13:02:23 -0400] yfeldblum: BryanWB, good morning!
[2012-04-26 13:03:10 -0400] yfeldblum: BryanWB, trouble is, the Chef::Provider::Template doesn't really help with that ... it may require a little ruby black magic
[2012-04-26 13:05:23 -0400] BryanWB: yfeldblum: don't worry about it, i investigate,  tks!
[2012-04-26 13:06:06 -0400] yfeldblum: BryanWB, no probs
[2012-04-26 13:22:03 -0400] jck_berlin: Hi all, I  is this the right place to pose a question regarding the  deploy resource?
[2012-04-26 13:22:33 -0400] yfeldblum: jck_berlin, as good as any
[2012-04-26 13:24:11 -0400] jck_berlin: ok thanks. There is a environment hash. Is this passed as shell environment variables to the migration_command?
[2012-04-26 13:25:43 -0400] jck_berlin: when i use an "printenv > enf.log" or "set > env.log" as migration_command I cant see the variables I defined there.
[2012-04-26 13:30:35 -0400] yfeldblum: jck_berlin, seems like a bug: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/deploy.rb#L161-175
[2012-04-26 13:33:58 -0400] yfeldblum: jck_berlin, it should work that way, but the code doesn't seem to do that
[2012-04-26 13:34:17 -0400] yfeldblum: jck_berlin, feel free to open a ticket at tickets.opscode.com
[2012-04-26 13:34:44 -0400] jck_berlin: @yfeldblum thanks, I was just reading the code.
[2012-04-26 13:34:47 -0400] yfeldblum: jck_berlin, for now, you can construct a migration command based on the original migration command, but setting up the env vars yourself in the command string
[2012-04-26 13:36:07 -0400] jck_berlin: #{env_info} is also empty as there is no value for it showing up in the chef log.
[2012-04-26 13:37:02 -0400] jck_berlin: thank you very much, knowing that this is a bug and I have to work arround it for now brings me a huge step forward.
[2012-04-26 13:38:11 -0400] yfeldblum: jck_berlin, np
[2012-04-26 13:48:34 -0400] helllen: helllo
[2012-04-26 13:48:43 -0400] geekbri: helllen: well hello
[2012-04-26 13:48:49 -0400] helllen: I would like to get an specific attribute for on of my nodes
[2012-04-26 13:48:57 -0400] helllen: how could I do it with chef ?
[2012-04-26 13:49:09 -0400] helllen: with knife I mean?
[2012-04-26 13:49:17 -0400] helllen: for example ipaddress
[2012-04-26 13:49:26 -0400] BryanWB: helllen: use knife exec
[2012-04-26 13:49:47 -0400] BryanWB: helllen: or shef
[2012-04-26 13:50:20 -0400] helllen: could you write an example?
[2012-04-26 13:50:28 -0400] helllen: for example node name is 'helllen'
[2012-04-26 13:50:34 -0400] helllen: how could I get ipaddress
[2012-04-26 13:50:39 -0400] helllen: attribute
[2012-04-26 13:51:41 -0400] gale: I'm probably going to regret this but I want to allow people to edit databags etc to create virtual hosts and stuff like that. Any nice interfaces around for this kind of thing before I roll my own?
[2012-04-26 13:51:43 -0400] jtimberman: helllen: in a recipe?
[2012-04-26 13:51:49 -0400] helllen: no
[2012-04-26 13:51:54 -0400] jtimberman: from the chef server?
[2012-04-26 13:51:54 -0400] helllen: this is a node attribute
[2012-04-26 13:51:55 -0400] geekbri: gale: knife ?
[2012-04-26 13:52:06 -0400] BryanWB: node[:ipaddress]
[2012-04-26 13:52:07 -0400] helllen: with knife
[2012-04-26 13:52:10 -0400] BryanWB: helllen: ^^
[2012-04-26 13:52:15 -0400] jtimberman: knife node show NODENAME -a ipaddress
[2012-04-26 13:52:31 -0400] gale: geekbri: yes - that's not the most friendly interface in the world though - I was hoping for a a web based thing
[2012-04-26 13:52:34 -0400] jtimberman: see, knife node show --help for all the options available for showing nodes.
[2012-04-26 13:52:54 -0400] BryanWB: jtimberman: sweet, i had not idea that option existed ;)
[2012-04-26 13:53:09 -0400] jtimberman: orly
[2012-04-26 13:53:20 -0400] geekbri: gale: well the chef server web UI has an editor for data_bags
[2012-04-26 13:53:34 -0400] geekbri: i dont know if thats only hosted chef though.  I don't run my own chef server, i pay them for it :)
[2012-04-26 13:53:45 -0400] jtimberman: its not a very good editor though. easier to just use a text editor with a good javascript/json plugin.
[2012-04-26 13:54:08 -0400] gale: geekbri: no you get that interface if you run your own but it's not the greatest
[2012-04-26 13:54:14 -0400] geekbri: it certainly isn't :)
[2012-04-26 13:54:19 -0400] geekbri: I prefer vim :-P
[2012-04-26 13:54:27 -0400] gale: so do I - thinking I might have to just knock something up
[2012-04-26 13:54:28 -0400] helllen: <jtimberman>, thanks
[2012-04-26 13:54:33 -0400] helllen: with the ip addres it is ok
[2012-04-26 13:55:09 -0400] helllen: I would like to get an specific attribute now for example iterface statistic how could I do it?
[2012-04-26 13:55:43 -0400] gale: suppose I need a cookbook that someone's already combined with a web interface
[2012-04-26 13:56:33 -0400] lflux: ohai chefs.
[2012-04-26 13:56:44 -0400] lflux: How do people handle bootstrapping of nodes from nothing to working VM
[2012-04-26 13:57:08 -0400] proffalken: lflux: inside or outside of cloud?
[2012-04-26 13:57:13 -0400] lflux: like, defining hostnames and IPs - do that in a databag, let DHCP and DNS pick it up from the databag and then create the VM
[2012-04-26 13:57:26 -0400] proffalken: oh, ok, entirely from chef...
[2012-04-26 13:57:33 -0400] lflux: proffalken: my situation is a VMware cluster
[2012-04-26 13:57:48 -0400] lflux: but I'll be using knife to create the VMs
[2012-04-26 13:58:46 -0400] lflux: or can I create the node with 'knife node create', let DHCP and DNS pick it up there and then continue by deploying the VM and running 'knife bootstrap'
[2012-04-26 14:00:04 -0400] lflux: it's the IP<->hostname mapping I need since I currently use DHCP to hand out IP addresses based on hostname
[2012-04-26 14:02:01 -0400] proffalken: lflux: I usually create the VMS etc outside of the config-management stuff and then let it take over..
[2012-04-26 14:02:24 -0400] proffalken: AWS/HPCloud/Cobbler to base install + Chef, chef takes over from there
[2012-04-26 14:02:50 -0400] laurent\: how do you guys manage permissions and stuff with opensource chef-server ? let's say i have a dev team and sysadm team, i don't want the dev guys to mess with the sysadm stuff for example
[2012-04-26 14:02:52 -0400] lflux: I have 'knife vsphere' now which can deploy a VM for me :)
[2012-04-26 14:03:06 -0400] proffalken: DNS etc. managed either manually (although I'm working on something to automate it from AWS/HPCloud)
[2012-04-26 14:03:07 -0400] ashb: laurent\: you basically can't I don't think
[2012-04-26 14:03:16 -0400] lflux: laurent\: nerf bat.
[2012-04-26 14:03:23 -0400] proffalken: lflux: +1
[2012-04-26 14:03:52 -0400] laurent\: ashb: just wondering what workarounds people are using
[2012-04-26 14:04:17 -0400] ashb: you might be able to do something via HTTP password limiting most POST requests etc
[2012-04-26 14:04:45 -0400] ashb: might have to limit the API similarly
[2012-04-26 14:05:01 -0400] ashb: but that would then interfer with the chef-clients
[2012-04-26 14:06:19 -0400] jtimberman: lflux: generally, we consider what you describe as "provisioning" and handle it outside the purview of Chef, although you can use Chef to inform the provisioning system, or to configure services that will be required such as dhcp, pxe, kickstart/preseed, etc.
[2012-04-26 14:06:47 -0400] jtimberman: laurent\: primary workaround i know of is to run separate chef servers.
[2012-04-26 14:07:02 -0400] jtimberman: since open source chef server doesn't have the ACL / RBAC system of Hosted/Private chef.
[2012-04-26 14:07:20 -0400] laurent\: ashb, yep that's what i was thinking of, just simple acl system that would prevent uploading of certains cookbooks/databags/roles
[2012-04-26 14:07:30 -0400] proffalken: laurent\: fit one of these http://www.youtube.com/watch?v=UW3098Ou7gk with a GPS and give it a map of who sits where in your office... ;)
[2012-04-26 14:07:47 -0400] lflux: jtimberman: yeah, in my case I can use knife to provision the VM, so spiceweasel seems very attractive to do the provisioning. Clicking around in vmware and editing DNS and DHCP configs isn't that fun.
[2012-04-26 14:08:11 -0400] laurent\: proffalken: :)
[2012-04-26 14:09:46 -0400] laurent\: jtimberman: yep, i've just discoverd the knife block plugin and i was also thinking about the multiple server workaround
[2012-04-26 14:13:33 -0400] mosez: when will we get resources with login shell for specific users? :(
[2012-04-26 14:24:14 -0400] laurent\: well done i'm still watching arduino robots on utube ! :)
[2012-04-26 14:36:51 -0400] yfeldblum: gale, think of data bags as tables in mysql ... and knife w.r.t. data bags as the mysql shell ... for your use case, of course you'll want to build a clean, consistent, validating interface of your own ...
[2012-04-26 14:38:39 -0400] gale: yfeldblum: I get that - I was just hoping someone might have solved a similar problem and open sourced it to save me the effort :)
[2012-04-26 14:39:50 -0400] yfeldblum: gale, wrote & open-sourced a highly business-dependent solution to a highly business-specific problem? not as likely as one might hope :P
[2012-04-26 14:40:39 -0400] lflux: gale: My route will probably be to make a script that generates the correct JSON for the databag for the virtual hosts
[2012-04-26 14:40:47 -0400] yfeldblum: laurent\, why have only one chef-server? every dev who works on an app has his/her own local copy of the db for that app
[2012-04-26 14:40:58 -0400] lflux: and then scripts to load databag and kick the relevant nodes
[2012-04-26 14:41:45 -0400] yfeldblum: laurent\, chef-server is not necessarily a single global thing across your organization - only the production chef-server is global, but you may have any number of additional chef-servers
[2012-04-26 14:47:52 -0400] rayrod2030: what's the best practice for accessing a private github or bitbucket repository from within the application recipe?
[2012-04-26 14:50:41 -0400] yfeldblum: rayrod2030, deploy keys (for github)
[2012-04-26 14:51:12 -0400] rayrod2030: great thanks!
[2012-04-26 14:51:32 -0400] yfeldblum: rayrod2030, deploy keys are keys with readonly privs, are not users' keys, and are permitted to work only for one repo (can't have one deploy key for two repos)
[2012-04-26 14:52:33 -0400] yfeldblum: jtimberman, any plans to add it? any plans to add an API for it?
[2012-04-26 14:53:02 -0400] cwj: rayrod2030: i wrote a definition for setting up deploy keys and ssh wrappers, might be of interest to you if you are accessing a private repo via the deploy or deploy_revision resource
[2012-04-26 14:53:49 -0400] jolt_: anyone have had problem with non us-ascii in a dpkg package which causes the chef run to fail?
[2012-04-26 14:55:39 -0400] rayrod2030: cwj: I would be interested in that since that's exactly what I'm trying to do.
[2012-04-26 14:56:10 -0400] cwj: you can get it from https://github.com/cwjohnston/chef-deploy_wrapper
[2012-04-26 14:56:18 -0400] cwj: i havent put it on the community site yet
[2012-04-26 14:56:47 -0400] cwj: let me know if you have any questions
[2012-04-26 14:59:47 -0400] laurent\: yfeldblum: sure, but when it's about pushing to prod i'd rather have grained control
[2012-04-26 15:00:22 -0400] gale: yfeldblum: lflux: yep that what I'm thinking
[2012-04-26 15:00:45 -0400] gale: with lots of validation involved obviously
[2012-04-26 15:04:17 -0400] yfeldblum: laurent\, if you want control over the manual pushing-to-prod steps, don't let devs do that ... don't give them client keys with admin privs on the production chef-server (or maybe not client keys at all, depending on exactly what the admin bit controls) ...
[2012-04-26 15:09:52 -0400] atomic-penguin: BryanWB, how do you handle the pain in the ass that is the Java keytool, with regards to chef
[2012-04-26 15:10:16 -0400] sampikesley: I wanna store my SSL certs and keys in encrypted data bags
[2012-04-26 15:10:25 -0400] laurent\: yfeldblum: yep, that's one way, i guess i can workaround some git hooks to achieve that
[2012-04-26 15:10:27 -0400] sampikesley: they do not make good JSON
[2012-04-26 15:10:31 -0400] sampikesley: any ideas?
[2012-04-26 15:13:52 -0400] yfeldblum: sampikesley, not sure what the problem is, specifically, that you're facing
[2012-04-26 15:14:26 -0400] jtimberman: yfeldblum: add what, acl/rbac?
[2012-04-26 15:14:38 -0400] yfeldblum: jtimberman, ya
[2012-04-26 15:14:43 -0400] atomic-penguin: sampikesley, thats how i do it with http://ckbk.it/certificates
[2012-04-26 15:14:45 -0400] jtimberman: yfeldblum: i don't know of any plans to do so, maybe? coderanger made a post on the mailnig list yesterday about it
[2012-04-26 15:14:59 -0400] atomic-penguin: whoops, http://ckbk.it/certificate
[2012-04-26 15:16:01 -0400] sampikesley: databag looks liek this
[2012-04-26 15:16:02 -0400] sampikesley: {
[2012-04-26 15:16:02 -0400] sampikesley:   "id": "certs",
[2012-04-26 15:16:03 -0400] sampikesley:   "amee_com_crt": "-----BEGIN CERTIFICATE-----
[2012-04-26 15:16:03 -0400] sampikesley: MIIE0DCCA7igAwIBAgIRAKu8sZJ1xc60lxdlH437qjAwDQYJKoZIhvcNAQEF
[2012-04-26 15:16:03 -0400] sampikesley: BQAwQTELMAkGA1UEBhMCRlIxEjAQBgNVBAoTCUdBTkRJIFNBUzEeMBwGA1UE
[2012-04-26 15:16:04 -0400] sampikesley: AxMVR2FuZGkgU3RhbmRhcmQgU1NMIENBMB4XDTEyMDIyMjAwMDAwMFoXDTEz
[2012-04-26 15:16:05 -0400] sampikesley: snip
[2012-04-26 15:16:26 -0400] sampikesley: try to upload
[2012-04-26 15:16:27 -0400] sampikesley: ERROR: JSON::ParserError: 743: unexpected token at '{
[2012-04-26 15:16:27 -0400] sampikesley:   "id": "certs",
[2012-04-26 15:17:13 -0400] sampikesley: I'll give your cookcook a go
[2012-04-26 15:17:17 -0400] rayrod2030: cwj: awesome recipe.  Thanks!
[2012-04-26 15:17:41 -0400] yfeldblum: sampikesley, you need to encode the newlines for JSON
[2012-04-26 15:17:56 -0400] yfeldblum: sampikesley, http://json.org/
[2012-04-26 15:18:10 -0400] yfeldblum: replace newlines with the sequence \n
[2012-04-26 15:19:29 -0400] sampikesley: ah
[2012-04-26 15:19:32 -0400] sampikesley: schweet
[2012-04-26 15:19:39 -0400] sampikesley: thought it must be somehting like that
[2012-04-26 15:19:50 -0400] sampikesley: I tried putting '\'s on the ebd
[2012-04-26 15:21:14 -0400] yfeldblum: the newline is not a legal character within literal string expressions in JSON - must be encoded using the JSON encoding rules
[2012-04-26 15:24:00 -0400] sampikesley: OK, thay uploaded!
[2012-04-26 15:24:03 -0400] sampikesley: thanks
[2012-04-26 15:24:22 -0400] sampikesley: now let's see how they come out the other end...
[2012-04-26 15:48:21 -0400] sampikesley: OK, now git-core *and* mysql-client are trying to install specific versions
[2012-04-26 15:48:32 -0400] sampikesley: that can't be found
[2012-04-26 15:48:39 -0400] sampikesley: nad the run is crapping out
[2012-04-26 15:48:42 -0400] sampikesley: WTF?
[2012-04-26 15:48:42 -0400] bawt: WTF is that about..
[2012-04-26 15:49:03 -0400] hoover_damn: bawt, forget WTF
[2012-04-26 15:49:04 -0400] bawt: okay
[2012-04-26 15:49:52 -0400] sampikesley: yesh
[2012-04-26 15:49:56 -0400] sampikesley: on ec2 and a vagrant node
[2012-04-26 15:49:59 -0400] sampikesley: same this
[2012-04-26 15:50:01 -0400] sampikesley: thing
[2012-04-26 15:50:16 -0400] sampikesley: FATAL: Chef::Exceptions::Exec: package[ git-core ] (amee_fundamentals::default line 23) had an error: apt-get -q -y install  git-core =1:1.7.0.4-1ubuntu0.2 returned 100, expected 0
[2012-04-26 15:50:22 -0400] sampikesley: I never requested that version
[2012-04-26 15:50:26 -0400] sampikesley: or any version
[2012-04-26 15:50:35 -0400] sampikesley: just install the damn package
[2012-04-26 15:51:20 -0400] hoover_damn: your getting error 100...
[2012-04-26 15:51:31 -0400] hoover_damn: you should run apt-get -f install and see what apt is complaining about
[2012-04-26 15:51:59 -0400] hoover_damn: I've seen that with apt-get over UCF items... but basically gotta see what ubuntu is yapping about
[2012-04-26 15:52:30 -0400] helllen: back again
[2012-04-26 15:52:42 -0400] helllen: sorry I do need to get an attribute for one node
[2012-04-26 15:52:47 -0400] helllen: someone could help me?
[2012-04-26 15:52:48 -0400] sampikesley: this
[2012-04-26 15:52:48 -0400] sampikesley: apt-get -q -y -f -s install git-core
[2012-04-26 15:52:52 -0400] sampikesley: coems back fine
[2012-04-26 15:53:09 -0400] icoffey_: sampikesley: fwiw ive seen that when an apt-get update is needed
[2012-04-26 15:53:14 -0400] sampikesley: chef is appending that specific version request
[2012-04-26 15:53:29 -0400] sampikesley: apt-get updated 'til I'm blue in the face
[2012-04-26 15:53:57 -0400] sampikesley: oh
[2012-04-26 15:54:01 -0400] sampikesley: this is weird
[2012-04-26 15:54:08 -0400] sampikesley: apt-get -q -y -f -s install git-core
[2012-04-26 15:54:23 -0400] sampikesley: shows Inst git-core (1:1.7.0.4-1ubuntu0.2
[2012-04-26 15:54:33 -0400] sampikesley: which *is* the version its requesting
[2012-04-26 15:54:50 -0400] sampikesley: din't like that space before the '=' though
[2012-04-26 15:55:09 -0400] sampikesley: yeah, the space is berakinf it
[2012-04-26 15:55:16 -0400] sampikesley: breaking
[2012-04-26 15:55:32 -0400] hoover_damn: what version of ubuntu?
[2012-04-26 15:56:01 -0400] sampikesley: ignore me
[2012-04-26 15:56:06 -0400] sampikesley: I was being an utter prawn
[2012-04-26 15:56:23 -0400] sampikesley: the difference between %{ git-core }.each do and %w{ git-core }.each do
[2012-04-26 15:56:45 -0400] sampikesley: thank you for letting me rubberduck my idiocy
[2012-04-26 15:57:19 -0400] helllen: I know:     knife node show node_name -a attribute_name
[2012-04-26 15:57:43 -0400] helllen: but what happens if I want to get memory[:active]  ?
[2012-04-26 15:58:59 -0400] zts: helllen: try "-a memory.active"
[2012-04-26 16:00:22 -0400] helllen: sure!!!!
[2012-04-26 16:00:24 -0400] helllen: thanks a lot
[2012-04-26 16:02:28 -0400] miah: moin
[2012-04-26 16:19:59 -0400] RJ2: Any advice on how to debug this chef-client error? ArgumentError: comparison of Chef::Node with Hash failed - http://pastebin.com/7MWPwAyy
[2012-04-26 16:21:03 -0400] RJ2: chef 0.10.8 and ubuntu 11.10
[2012-04-26 16:26:25 -0400] zts: RJ2: I haven't seen that error before.  What does your cookbooks/munin/recipes/server.rb have at line 36?
[2012-04-26 16:27:10 -0400] RJ2: munin_servers.sort! { |a,b| a[:fqdn] <=> b[:fqdn] }
[2012-04-26 16:27:19 -0400] miah: zts: https://github.com/opscode-cookbooks/munin/blob/master/recipes/server.rb#L36
[2012-04-26 16:27:19 -0400] RJ2: oh one member of that list is missing :fqdn, doh
[2012-04-26 16:27:20 -0400] miah: ?
[2012-04-26 16:27:20 -0400] miah: =)
[2012-04-26 16:27:30 -0400] miah: oh you have your own?
[2012-04-26 16:27:49 -0400] RJ2: just remembered i am poking a fake node into that list to monitor a non-cheffed box
[2012-04-26 16:27:58 -0400] zts: RJ2: aha
[2012-04-26 16:28:07 -0400] miah: well there you go
[2012-04-26 16:34:46 -0400] ashb: i've had fqdn issues when /etc/hosts wasn't set up right so the box couldn't find tis own hostname
[2012-04-26 16:42:43 -0400] Brad_K: ashb: yup.  typical problem with many cloud providers  they don't set the value of the output from `hostname -f` to a useful value.  that's why you use the hostname cookbook to help fix that problem.
[2012-04-26 16:45:56 -0400] hoover_damn: hostname -f should be useful upon startup... what cloud provider odesn't do this?
[2012-04-26 16:46:06 -0400] hoover_damn: doesn't*? other then your own
[2012-04-26 16:46:25 -0400] hoover_damn: hostname -f working should be a darn good thing to begin with
[2012-04-26 16:46:33 -0400] cwj: i am only now beginning to configure exception and report handlers for my nodes. is it possible to use multiple handlers? like have the default json handler catch exceptions and reports, but also have jtimberman's simple report handler run?
[2012-04-26 16:46:42 -0400] cwj: i guess thats what report_handlers << does huh
[2012-04-26 16:46:57 -0400] Brad_K: hoover_damn: neither AWS nor Rackspace provide a useful value for `hostname -f` on the initial boot, and if you don't explicitly fix that problem inside the hostname cookbook, then that issue will persist.
[2012-04-26 16:47:07 -0400] miah: i should clean up my chef-hostname cookbook. i see too many people asking about that in here =)
[2012-04-26 16:49:00 -0400] cwj: i have been using spheromak's hosts LWRP
[2012-04-26 16:49:04 -0400] cwj: https://github.com/spheromak/cookbooks/tree/master/hosts
[2012-04-26 16:50:43 -0400] miah: ah. thats nice. i didn't write a lwrp to update /etc/hosts. but i did write a cookbook that sets the hostname according to some rules, sets up /etc/hosts, /etc/hostname, sets the hostname of the server, and registers it in dns
[2012-04-26 16:51:00 -0400] thehar: you use /etc/hosts!
[2012-04-26 16:51:01 -0400] thehar: ew
[2012-04-26 16:51:13 -0400] thehar: ;]
[2012-04-26 16:51:45 -0400] miah: hosts.txt is useful if you have something built to manage it, and want to protect yourself from dns foulups
[2012-04-26 16:53:06 -0400] miah: i only add my chef and monitoring hosts to my my /etc/hosts
[2012-04-26 16:53:24 -0400] cwj: thehar: hell yeah i resolve names
[2012-04-26 16:53:27 -0400] thehar: lol
[2012-04-26 16:53:31 -0400] cwj: cant rabbitmq without it
[2012-04-26 16:55:08 -0400] miah: ah ya. rabbitmq is fun with hostnames =)
[2012-04-26 16:56:59 -0400] hoover_damn: Brad_K, i've never changed a ec2 hostname
[2012-04-26 16:57:09 -0400] hoover_damn: Brad_K, main reason is dhcp should reset the hostname eventually
[2012-04-26 16:57:24 -0400] hoover_damn: Brad_K, not sure all ami's are curated to not set the hostname via dhcp...
[2012-04-26 16:57:50 -0400] hoover_damn: I pretend to use their hostname... and use the proper cloud/ec2 object
[2012-04-26 16:57:51 -0400] hoover_damn: instead
[2012-04-26 16:59:20 -0400] Brad_K: in this case, /etc/hosts is really only needed to make sure that the machine picks up the correct information for itself, based on the hostname.  If you're using DHCP to get IP addresses for your servers, then /etc/hosts wouldn't be that useful but then I'd also worry about the IP addresses of my nodes mysteriously changing out from under me.
[2012-04-26 17:00:49 -0400] Brad_K: Rackspace statically allocates IP addresses at the time the node is created, and those addresses never change over the life of the node.  And they're recorded in the /etc/hosts file as well, to help ensure that the correct IP addresses are assigned when the machine boots  and without dependence on DHCP.
[2012-04-26 17:01:48 -0400] hoover_damn: Brad_K, hrm... doesn't dhcp write to /etc/hosts?
[2012-04-26 17:01:50 -0400] hoover_damn: or dhclient?
[2012-04-26 17:01:57 -0400] hoover_damn: Brad_K, to populate the dhcp information in /etc/hosts?
[2012-04-26 17:02:21 -0400] hoover_damn: Brad_K, right Rackspace's scheduler sets up the ip for the instance during the provisioning process
[2012-04-26 17:02:27 -0400] hoover_damn: Brad_K, Amazon does the same.
[2012-04-26 17:02:42 -0400] hoover_damn: Brad_K, i'm not referring to your ip changing and your lease breaking and you going down
[2012-04-26 17:03:25 -0400] hoover_damn: Brad_K, rackspace hostname -f should work upon bootup, so does amazon's by default.  Generally when I think of people alternating hosts it's when they want to change it to "production-web1"
[2012-04-26 17:03:34 -0400] yfeldblum: rackspace cloud servers doesn't do dhcp - every instance is assigned ip addresses and that's that
[2012-04-26 17:05:47 -0400] hoover_damn: yfeldblum, neat
[2012-04-26 17:05:51 -0400] hoover_damn: yfeldblum, didn't realize they lacked dhcp
[2012-04-26 17:36:56 -0400] leed0: with 'knife ssh' is there any way to query based on role, where the role isn't explicitly in the run_list? but is part of another role that is in the run_list
[2012-04-26 17:37:08 -0400] cwj: leed0: use roles: as the key
[2012-04-26 17:37:30 -0400] cwj: when chef runs it expands the run list and populates 'roles' and 'recipes'
[2012-04-26 17:37:48 -0400] leed0: cwj: right, but we have a role 'webserver', and that is in another role 'phpbb''s run list
[2012-04-26 17:37:53 -0400] cwj: right
[2012-04-26 17:38:29 -0400] geekbri: In my experience it will not expand the roles.  With knife search you can get it to search nested roles, but Im not sure about knife ssh
[2012-04-26 17:38:39 -0400] cwj: once a node with role webserver has run once and successfully saved its updated state to the chef server, the node object's 'roles' key should contain phpbb
[2012-04-26 17:39:00 -0400] yfeldblum: `knife ssh` relies on search to find the nodes to ssh into
[2012-04-26 17:39:10 -0400] geekbri: well then theres your answer.  If i remember correctly
[2012-04-26 17:39:14 -0400] geekbri: hold on I have notes on shit.
[2012-04-26 17:40:24 -0400] geekbri: i meant this. hah
[2012-04-26 17:42:37 -0400] leed0: cwj: the thing is the node doesn't have webserver in it's run list, it has phpbb
[2012-04-26 17:42:41 -0400] leed0: which in turn has webserver
[2012-04-26 17:42:45 -0400] leed0: so we can't query on webserver
[2012-04-26 17:43:00 -0400] leed0: anyways sounds like it is not supposed to work
[2012-04-26 17:43:09 -0400] cwj: ok, then i got the direction backward
[2012-04-26 17:43:17 -0400] cwj: either way, they will both be in roles
[2012-04-26 17:43:47 -0400] geekbri: ok, so it looks like when you do a search the s character makes a difference.  IE searching for role: vs search for roles:
[2012-04-26 17:43:52 -0400] cwj: right
[2012-04-26 17:44:01 -0400] cwj: totally matters
[2012-04-26 17:44:07 -0400] geekbri: right so isn't that all leed0 needs?
[2012-04-26 17:44:10 -0400] cwj: yes
[2012-04-26 17:44:17 -0400] geekbri: http://wiki.opscode.com/display/chef/Search   the heading "Find Nodes with a Role in the Run List"
[2012-04-26 17:44:27 -0400] leed0: ohhh
[2012-04-26 17:44:29 -0400] cwj: either he isnt explaining the problem or he isnt understanding my explanation
[2012-04-26 17:44:31 -0400] leed0: yay, thanks
[2012-04-26 17:44:47 -0400] leed0: i didn't see role vs roles
[2012-04-26 17:45:00 -0400] geekbri: yeah it matters, its the difference between a top level search, or a recursive search
[2012-04-26 17:45:25 -0400] cwj: i think leed0 just cut off my irc for being lippy
[2012-04-26 17:45:47 -0400] yfeldblum: remember that the Run List is specifically the thing that you list for the node - the Run List is *not* "expanded" because you didn't expand it
[2012-04-26 17:46:58 -0400] yfeldblum: the "expanded run list" is saved when the node is saved, based on the roles as they existed at the time the node was saved, so that might be stale information
[2012-04-26 17:47:35 -0400] BryanWB__: whoah, i never realized that there was difference b/w role and roles
[2012-04-26 17:47:42 -0400] cwj: big difference
[2012-04-26 17:47:42 -0400] geekbri: learn something new every day
[2012-04-26 17:47:45 -0400] leed0: makes sense, thanks for explaining
[2012-04-26 17:47:53 -0400] BryanWB__: double-whoah! same applies to recipes!
[2012-04-26 17:47:57 -0400] cwj: 420 learn every 420 seconds
[2012-04-26 17:48:56 -0400] geekbri: yessssss sir
[2012-04-26 17:52:12 -0400] rohrer: so i've been playing with chef and vagrant/VirtualBox on my laptop and would like to start using it with a vps. i've seen http://wiki.opscode.com/display/chef/Launch+Cloud+Instances+with+Knife which looks great for amz/rackspace etc, but what are the options if i just have a cheap bare-bones ubuntu vps? login and manually install chef and run it?
[2012-04-26 17:57:05 -0400] jhulten: roher: checkout the knife bootstrap command http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-04-26 17:58:04 -0400] rohrer: jhulten: thanks!
[2012-04-26 18:05:08 -0400] caspyin: I have a cookbook that uses a template to create a conf file. I would like to append some content to the file file. Ideas on how I can do that?
[2012-04-26 18:08:12 -0400] yfeldblum: caspyin, this cookbook, is it your own or did you get it from somewhere else?
[2012-04-26 18:08:33 -0400] caspyin: its the wordpress cookbook
[2012-04-26 18:10:31 -0400] cobragoat: what is the best approach to deploy a rails app using chef? does it sufficiently replace capistrano?
[2012-04-26 18:10:50 -0400] yfeldblum: caspyin, option 1: you can fork the cookbook and customize it to suit; option 2: if you make your own new cookbook with a recipe that does `include_recipe "wordpress::default"`, then in your recipe you can also reach in, find the template resource, and set it to use a template file located in your cookbook
[2012-04-26 18:11:46 -0400] cobragoat: deploy from github*
[2012-04-26 18:11:48 -0400] yfeldblum: cobragoat, no, it's a different strategy, not a replacement ... some people prefer deploying apps with chef, others prefer deploying apps with capistrano even if the base systems are managed with chef
[2012-04-26 18:12:19 -0400] yfeldblum: cobragoat, they're different ways of working, useful for different types of people/orgs
[2012-04-26 18:13:28 -0400] caspyin: yfeldblum: I like option 2. Where can I find out more about that?
[2012-04-26 18:14:48 -0400] cobragoat: ok. for a small app. is it common to use chef to configure an instance then just keep the latest code deployed.. I have just been using cap:deploy after a git push etc..
[2012-04-26 18:14:53 -0400] yfeldblum: caspyin, not sure - it's a strategy i like to use, basically works like monkey-patching in ruby
[2012-04-26 18:15:15 -0400] daaaan: we use chef to create the directory structure and place teh config files, but capistrano actually deploys the code
[2012-04-26 18:15:20 -0400] caspyin: cool thanks
[2012-04-26 18:15:41 -0400] yfeldblum: cobragoat, some people do, some people don't - i'd recommend trying both
[2012-04-26 18:23:03 -0400] AntonZ: Hello, does anyone if i can mount the same S3 bucket accross multiple instances ?
[2012-04-26 18:23:45 -0400] daaaan: i tried using chef to deploy the code every time, but we push too often so a 10 minute chef run was too much
[2012-04-26 18:23:52 -0400] daaaan: considering i got capistrano down to like 35 seconds
[2012-04-26 18:24:12 -0400] itwasntandy: why on earth does your chef run take 10 minutes?
[2012-04-26 18:24:29 -0400] miah: compiles, downloads?
[2012-04-26 18:24:41 -0400] miah: doing things inefficiently?
[2012-04-26 18:24:42 -0400] itwasntandy: ours are ~80 seconds on new build, and about ~30 seconds on subsequent runs
[2012-04-26 18:24:53 -0400] miah: ya. mine are "long" at ~24 seconds
[2012-04-26 18:25:16 -0400] itwasntandy: new build is installation of tomcat, jdk, grabbing of war files, and setting up configuration
[2012-04-26 18:26:04 -0400] daaaan: i dont know, it installed a ton of packages, maybe just slow repositories?
[2012-04-26 18:26:20 -0400] daaaan: this was like a year ago though at my old job
[2012-04-26 18:26:33 -0400] miah: probably
[2012-04-26 18:26:45 -0400] daaaan: though that included precompiling assets and such for a rails app
[2012-04-26 18:27:14 -0400] daaaan: what im working on now is like 18 seconds for subsequent runs
[2012-04-26 18:27:35 -0400] miah: if its info from a year ago, you shouldn't base current opinions on it.
[2012-04-26 18:28:12 -0400] miah: 18 seconds is good
[2012-04-26 18:28:39 -0400] miah: i tend to use chef to manage application installation, dependancy management, and system configuration. deploy rails with other stuff.
[2012-04-26 18:29:58 -0400] AntonZ: guys, i need a shared storage between multiple instances, i was thiking about using this cookbook, would it be a good place to start ? http://community.opscode.com/cookbooks/s3fs
[2012-04-26 18:31:23 -0400] miah: i think s3 is not the filesystem to use for shared storage
[2012-04-26 18:31:29 -0400] miah: in the sense of 's3fs' that is
[2012-04-26 18:31:40 -0400] cwj: i found s3fs to be rather flaky
[2012-04-26 18:31:48 -0400] miah: yup
[2012-04-26 18:31:57 -0400] miah: also, its not intended to be used as a filesystem
[2012-04-26 18:32:14 -0400] geekbri: I also found s3fs to be flakey
[2012-04-26 18:32:14 -0400] miah: trying to make things something they're not doesn't always work well
[2012-04-26 18:32:17 -0400] AntonZ: any suggestions? i will need to mount it accross multiple instances, the same user/dedicated user will read/write to that share
[2012-04-26 18:33:00 -0400] geekbri: NFS ?
[2012-04-26 18:33:00 -0400] bawt: NFS is more full of fail.
[2012-04-26 18:33:08 -0400] cwj: bawt disagrees
[2012-04-26 18:33:12 -0400] cwj: :D
[2012-04-26 18:33:22 -0400] thehar: oh god nfs
[2012-04-26 18:33:24 -0400] geekbri: Perhaps, but I couldn't think of a good DFS  :)
[2012-04-26 18:33:42 -0400] geekbri: my old company used to use MogileFS
[2012-04-26 18:33:43 -0400] geekbri: i was never a fan
[2012-04-26 18:33:49 -0400] AntonZ: in the house we use netapp with nfs exports, works really nice, i need similar implementation in the cloud
[2012-04-26 18:34:13 -0400] AntonZ: i was thiking about NFS server with big ebs mount
[2012-04-26 18:34:17 -0400] AntonZ: but
[2012-04-26 18:34:26 -0400] Brad_K: i don't think any of the S3-based filesystems are good choices for shared usage.  s3ql is probably the most advanced s3-based filesystem, and it most certainly insists on being single-system only.
[2012-04-26 18:34:29 -0400] geekbri: i sure would make sure that you do some sort of raid with EBS
[2012-04-26 18:35:11 -0400] AntonZ: yes, redandancy is in order, i just need to decide on tehcnology to use
[2012-04-26 18:35:38 -0400] Brad_K: there's not really a good solution for distributed network filesystems for cloud servers.  not that i know of.
[2012-04-26 18:36:11 -0400] geekbri: yes, i agree.  Thats sort of why i said NFS.  I mean if you are using AWS, your choice for DFS is fairly limited.
[2012-04-26 18:36:20 -0400] geekbri: if you dont use NFS for the purpose, what else would you use?
[2012-04-26 18:36:26 -0400] Brad_K: NFS is okay when you've got the right type of server/service behind it (like NetApp), but that really only works for the LAN.  Even that sucks when it comes to the WAN, and that's the best solution available.
[2012-04-26 18:36:36 -0400] Brad_K: and everything in the cloud is, by definition, on the WAN.
[2012-04-26 18:37:04 -0400] AntonZ: okay, so sounds like NFS is my best bet at this time
[2012-04-26 18:37:23 -0400] crucially: NFS is your best bet?
[2012-04-26 18:37:24 -0400] geekbri: i hear a lot of murmurs about glusterFS, but i dontk now enough about it to really say much to you
[2012-04-26 18:37:31 -0400] geekbri: other than, maybe look into if glusterFS suits your needs?
[2012-04-26 18:37:33 -0400] Brad_K: IMO, trying to do NFS on top of EBS would be like throwing bad money after worst.
[2012-04-26 18:37:35 -0400] crucially: AFS!
[2012-04-26 18:37:56 -0400] Brad_K: there's always someone who has to come up with AFS.  yikes.
[2012-04-26 18:38:24 -0400] yfeldblum: don't use grenades as pillows; likewise, don't use S3 as a filesystem
[2012-04-26 18:38:56 -0400] geekbri: Im not even sure what happens if multiple people try to write the same s3 item at the same time when its being used through s3fs
[2012-04-26 18:39:04 -0400] geekbri: my guess would be, something bad (tm)
[2012-04-26 18:40:47 -0400] geekbri: I heard a lot of NFS is crummy but I didn't hear any other suggestions so I guess unless you find something better, youre going with nfs :-P
[2012-04-26 18:40:58 -0400] yfeldblum: geekbri, i expect nothing bad happens: S3 writes are PUTs of the complete document all-at-once, and in such systems usually it's last-write-wins
[2012-04-26 18:41:17 -0400] geekbri: yfeldblum: yes, that does make sense I suppose.
[2012-04-26 18:44:39 -0400] Brad_K: multiple different "puts" collide on the same meta-data update structures?  corrupted filesystem anyone?
[2012-04-26 18:45:01 -0400] geekbri: i think yfeldblum is right though, i think the puts are basically atomic
[2012-04-26 18:45:04 -0400] geekbri: so they can't really collide
[2012-04-26 18:45:55 -0400] yfeldblum: S3 puts are atomic; if you're treating S3 objects as blocks, however, and running a filesystem atop s3-objects-as-blocks, now you've gota problem with concurrent updtes
[2012-04-26 18:46:06 -0400] Brad_K: individual puts might be atomic, but unless you can guarantee that each and every filesystem+meta-data transaction can be executed as a single atomic put, you've still got filesystem corruption.
[2012-04-26 18:46:23 -0400] geekbri: yes that is true, if each put is only a portion of a larger file
[2012-04-26 18:46:25 -0400] geekbri: you could be in some trouble
[2012-04-26 18:46:41 -0400] geekbri: I hope that is not what s3fs does. that would be bad.
[2012-04-26 18:47:02 -0400] Brad_K: i believe that all of the various s3fs-related projects do that.
[2012-04-26 18:47:08 -0400] geekbri: ouch.
[2012-04-26 18:47:20 -0400] geekbri: Yes I certainly would not mount that in multiple places.
[2012-04-26 18:47:34 -0400] yfeldblum: i wouldn't mount that at all ...
[2012-04-26 18:47:40 -0400] Brad_K: i know that s3ql does that, and it's the most advanced of all the s3fs implementations out there, with de-dupe, compression, and everything else you could otherwise want.
[2012-04-26 18:47:51 -0400] yfeldblum: unless it's entirely CoW-based
[2012-04-26 18:49:09 -0400] Blah1: hey all.   when i standup a new chef-server and i have a chef-repo with 100's of cookbooks in it,  is there a bulk uploader that'll automatically sync up all the cookbooks to the server?   Or do i have to upload each individually in a for loop?
[2012-04-26 18:49:27 -0400] yfeldblum: knife cookbook upload --all
[2012-04-26 18:56:12 -0400] Brad_K: yfeldblum: the only thing i can think of that would work entirely CoW-based would be to implement something akin to the filesystem used on WORM drives, with the added benefit that once some block/object was marked as no longer referenced anywhere then you could go in and garbage-collect it.  And I'd want a modern updated version that included cross-checks like SHA-512 hashes calculated for every block/object, to try to ensure that there aren't any unexp
[2012-04-26 18:56:34 -0400] Blah1: yfeldblum, thanks!
[2012-04-26 18:57:03 -0400] Brad_K: but that CoW-nature would require that the meta-data be handled in a CoW fashion, too.
[2012-04-26 18:59:20 -0400] yfeldblum: Brad_K, exactly - anything else is asking for either distributed locks or distributed trouble
[2012-04-26 19:02:05 -0400] Brad_K: and, of course, you could never cache any of the meta-data, and the data & meta-data writes would have to be handled in an ACID compliant manner with two-phase commit or something comparable.  and boy, would performance suck like a hard vacuum in space.
[2012-04-26 19:03:22 -0400] Brad_K: i can't think of anything off the top of my head that could possibly be slower, with regards to something that is supposed to be both useful but also failsafe.
[2012-04-26 19:03:47 -0400] hippiehacker: If I want to make sure a gem is installed for use in a library (libraries are loaded first, before providers, resources, definitions, attributes, recpies etc etc), how would I go about that?
[2012-04-26 19:04:21 -0400] cwj: man, librarian put me into a headless state and now i have some commits floating around in my index
[2012-04-26 19:04:29 -0400] geekbri: if I have a bash block that I only want to run when the deploy resource actually does a deploy, is there a way to handle that situation.  Can you use notify to tell a bash block to run?
[2012-04-26 19:04:53 -0400] damienj: good morning :)
[2012-04-26 19:04:55 -0400] cwj: geekbri: yes set the bash block action to nothing and have the deploy notify it to run
[2012-04-26 19:05:17 -0400] geekbri: cwj: and i would notify it with the name thats given to the bash block ?
[2012-04-26 19:05:23 -0400] cwj: yes
[2012-04-26 19:05:45 -0400] cwj: notifies :run, resources("bash[foo bar baz]"), :immediate
[2012-04-26 19:05:54 -0400] damienj: bjolders and I are wondering how to set / insert / change  an environment default attribute  from command line with knife, any ideas anyone?
[2012-04-26 19:06:24 -0400] geekbri: immm excellent, thank you cwj.  I though that was the case.
[2012-04-26 19:06:25 -0400] damienj: we can use 'knife env show...' to grep and work with values, but how to set?
[2012-04-26 19:06:43 -0400] cwj: geekbri: np
[2012-04-26 19:07:12 -0400] cwj: damienj: you could write a script that would run under knife exec
[2012-04-26 19:07:13 -0400] cwj: http://wiki.opscode.com/display/chef/Knife+Exec
[2012-04-26 19:07:26 -0400] cwj: i think that would work for editing an environment, but im not sure?
[2012-04-26 19:07:41 -0400] cwj: i keep my environments under revision control so i havent really tried that
[2012-04-26 19:07:41 -0400] bjolders: what we're trying to do, is associate the last successful build key from our CI pipe, which we need to be able to access on subsequent runs
[2012-04-26 19:08:18 -0400] bjolders: if there's a different place we can put it, we're open to suggestions, but the default attributes seems logical to us
[2012-04-26 19:08:25 -0400] damienj: cwj, thx never realized what knife exec was for, looks pretty powerful
[2012-04-26 19:08:27 -0400] cwj: maybe you store it in a data bag
[2012-04-26 19:08:43 -0400] bjolders: can you add / set attribtues in data bags using knife/
[2012-04-26 19:08:43 -0400] damienj: cwj, are data bags associated with environments too?
[2012-04-26 19:08:44 -0400] bjolders: ?
[2012-04-26 19:08:45 -0400] damienj: or can they be/
[2012-04-26 19:08:46 -0400] cwj: so that meatbags can modify the environment without losing the correct key
[2012-04-26 19:09:04 -0400] cwj: bjolders: yes but your client needs to be set as an admin i think
[2012-04-26 19:09:43 -0400] cwj: damienj: you could have a data bag per environment, or put a key value pair for each environment in one data bag
[2012-04-26 19:10:20 -0400] damienj: cwj, awesome - ok then perhaps data bag is the right choice, that was originally where i was heading, but didn't realize how it would work with environemnts
[2012-04-26 19:10:27 -0400] damienj: or that it could
[2012-04-26 19:11:45 -0400] bjolders: still doesn't seem like you can get/set a specific key/value pair.
[2012-04-26 19:12:05 -0400] cwj: nope, you would have to read/write the whole bag
[2012-04-26 19:12:45 -0400] cwj: but i think that would be the case with the environment as well, which, at least the way i use environments, is a potential Big Deal
[2012-04-26 19:12:47 -0400] bjolders: looks like it's up to knife exec to me
[2012-04-26 19:12:59 -0400] bjolders: yep. i think data bags seems like a good place to go
[2012-04-26 19:13:00 -0400] cwj: yes either way i would use knife exec
[2012-04-26 19:13:10 -0400] damienj: looks like data bags are not nescessarily associated with an env? if I create one in one env, I can still see from other...
[2012-04-26 19:13:15 -0400] cwj: yeah
[2012-04-26 19:13:18 -0400] bjolders: damienj: i think they are global
[2012-04-26 19:13:22 -0400] cwj: they are
[2012-04-26 19:13:25 -0400] damienj: k
[2012-04-26 19:13:26 -0400] cwj: but think about like
[2012-04-26 19:13:38 -0400] bjolders: but you can create a databag for an environment
[2012-04-26 19:13:43 -0400] damienj: so we could explicitly say like "Test_Databag" or "Prod_databag"
[2012-04-26 19:13:49 -0400] bjolders: yep exactly
[2012-04-26 19:14:01 -0400] damienj: and we could put our tag in there
[2012-04-26 19:14:08 -0400] cwj: { "id": "my_ci_keys", "staging": "0xdedbeef", "production": "foobarbaz", "development": "deeznuts" }
[2012-04-26 19:14:21 -0400] damienj: cwj, oh nice
[2012-04-26 19:14:23 -0400] cwj: that would be a way to do it with a single data bag
[2012-04-26 19:14:29 -0400] damienj: cwj, very spiff
[2012-04-26 19:14:38 -0400] cwj: and then in your logic you use node.chef_environment to get the key you want
[2012-04-26 19:14:52 -0400] damienj: oh even better!
[2012-04-26 19:15:13 -0400] cwj: :D
[2012-04-26 19:16:19 -0400] cwj: does anyone have an example of using the chef_handler LWRP to install jtimberman's updated_resources handler?
[2012-04-26 19:16:26 -0400] cwj: i am having problems
[2012-04-26 19:18:11 -0400] jtimberman: cwj: there "isn't one" :)
[2012-04-26 19:18:22 -0400] jtimberman: cwj: the chef_handler recipe should be updated to allow installign handlers from gems.
[2012-04-26 19:19:56 -0400] cwj: initially i tried installing it by just dropping the file into /var/chef/handlers and then calling the chef_handler for it
[2012-04-26 19:20:00 -0400] cwj: but that gave problems too
[2012-04-26 19:20:06 -0400] cwj: that should work right?
[2012-04-26 19:23:43 -0400] cwj: making ein gist
[2012-04-26 19:26:07 -0400] cwj: jtimberman: https://gist.github.com/185211dae0cf6b1a14bf
[2012-04-26 19:26:40 -0400] rayrod2030: I'm having some trouble with my application cookbook finding my apps data bag.
[2012-04-26 19:27:16 -0400] rayrod2030: if I am not mistaken all I have to do is upload my properly formatted data bag within apps and then set the role on the node that's named the same as the data bag.
[2012-04-26 19:27:21 -0400] rayrod2030: and run the application recipe?
[2012-04-26 19:28:31 -0400] cwj: im not a user of the application cookbook, but im sure someone else here is
[2012-04-26 19:28:50 -0400] rayrod2030: when application runs and does search(:apps) I don't think it's finding anything.
[2012-04-26 19:30:03 -0400] cwj: ok, have you ever tried the shef interactive shell?
[2012-04-26 19:30:21 -0400] rayrod2030: I have not.  that is intended to be run on the node correct?
[2012-04-26 19:30:34 -0400] cwj: yeah or you can run it locally
[2012-04-26 19:30:39 -0400] cwj: try shef -z
[2012-04-26 19:30:55 -0400] mattray: rayrod2030: run it from your workstation, use it to test your recipe searches
[2012-04-26 19:30:58 -0400] cwj: if you already have knife configured i think you can connect
[2012-04-26 19:31:02 -0400] cwj: yeah
[2012-04-26 19:31:16 -0400] cwj: run the same search in shef and see what you get
[2012-04-26 19:31:57 -0400] TheBeast: I read a discussion on this channel about a week ago descripting a cloud orchestration framework built on top of chef. it looked like a turnkey solution. it had 'elephant' in its name
[2012-04-26 19:32:09 -0400] TheBeast: does anyone recall the company name or the product name?
[2012-04-26 19:32:23 -0400] rayrod2030: cwj: shef is exactly what I needed to debug this.  Thanks.
[2012-04-26 19:32:40 -0400] mattray: TheBeast: elephant? InfoChimps?
[2012-04-26 19:33:57 -0400] TheBeast: thanks Matt, that's it.
[2012-04-26 19:34:23 -0400] mattray: IronFan is their cluster orchestration framework
[2012-04-26 19:39:49 -0400] TheBeast: yeh, looks interesting
[2012-04-26 19:51:35 -0400] pcn: ohai
[2012-04-26 19:52:21 -0400] pcn: Does anyone know if it's possible to specify a retry+backoff to the remote_file resource?  I'm running into an irritating situation where s3 is giving me a 404 notfound for a file... once in a while
[2012-04-26 20:05:50 -0400] mikeg: I'm running a command with a bash resource that works fine when I run it via the command line but when using bash resource it doesn't do what it's supposed to do.  Is there some way to get chef to leave behind the /tmp/chef-script### file it creates so I can see what it's running?  Or some other super-cool way to troubleshoot this
[2012-04-26 20:06:21 -0400] geekbri: mikeg: well what IS it doing?
[2012-04-26 20:06:31 -0400] geekbri: or, what is it not doing that it normally does
[2012-04-26 20:07:23 -0400] cwj: mikeg: i believe chef-client -l debug will show you the script being run
[2012-04-26 20:07:23 -0400] mikeg: it's not appending a word to the end of a line.  I'm using sed to append the nagios group to the end of the AllowedGroups line in sshd_config.  here's the command it's supposed to execute:
[2012-04-26 20:07:38 -0400] mikeg: sed -i 's/\(^AllowGroups.*\)/\1 nagios/' /etc/ssh/sshd_config
[2012-04-26 20:07:50 -0400] mikeg: I thought so to but it didn't
[2012-04-26 20:07:52 -0400] geekbri: are you sure its not just a case of you not escaping all the necessary /'s
[2012-04-26 20:08:03 -0400] geekbri: rather \'s
[2012-04-26 20:08:14 -0400] AntonZ: i had a similar issue with sed
[2012-04-26 20:08:20 -0400] mikeg: well, copied and pasted like that into the command  line it works.  do I have to do somehting different with escapes withing bash resource?
[2012-04-26 20:08:33 -0400] AntonZ: ruby sisnt intepreting it correctly
[2012-04-26 20:08:34 -0400] mikeg: I am using code <<-EOH btw.
[2012-04-26 20:08:44 -0400] geekbri: can you gist the bash resource ?
[2012-04-26 20:08:50 -0400] mikeg: because I issue a service sshd restart after the change.
[2012-04-26 20:08:53 -0400] mikeg: sure.  1 sec
[2012-04-26 20:09:35 -0400] mikeg: https://gist.github.com/2502714
[2012-04-26 20:11:08 -0400] geekbri: mikeg: can you try the changes i made to the gist and let me know if that works?
[2012-04-26 20:11:30 -0400] geekbri: oh strange, it only shows the proper changes when you click edit.
[2012-04-26 20:12:05 -0400] mikeg: geekbri: ok good.  I wasn't able to see the difference
[2012-04-26 20:12:15 -0400] geekbri: mikeg: https://gist.github.com/2502724
[2012-04-26 20:12:16 -0400] geekbri: try that
[2012-04-26 20:12:27 -0400] geekbri: let me know if it works
[2012-04-26 20:12:50 -0400] mikeg: Ok.  will do.  takes a few for everything to run.  brb
[2012-04-26 20:16:03 -0400] mikeg: geekbri: yep.  that did it.  thx
[2012-04-26 20:17:03 -0400] geekbri: mikeg: np.  Just remember when you call BASH like that , the bash you are writing are treated as ruby strings, thats why you can use things like #{variable_name}.  That means with a sed command you have to properly escape the \'s by doing \\
[2012-04-26 20:18:53 -0400] mikeg: another question about "best practices". as you can see I'm restarting sshd after doing that.  There is a service resource for sshd defined in another cookbook that is part of the runlist.  could I just call the service resource from the sshd cookbook from the recipe in another cookbook?  Or is it better to create another service resource for sshd in the other cookbook with nothing but 'action :restart'.  or is it just better to do it as I did
[2012-04-26 20:18:54 -0400] mikeg: (using bash) since It's just another line in the bash resource
[2012-04-26 20:20:13 -0400] geekbri: mikeg: i would call the LWRP if its available.
[2012-04-26 20:20:28 -0400] geekbri: mikeg: you could create a definition, which is basically like a passthrough to an LWRP
[2012-04-26 20:21:25 -0400] mikeg: Ok.  over my head but not for long.  I'm just digging into lwrp because my coworker created one and I'm curious about what we can do with it.  but from what I do know about it you answer sounds spot on.  thanks again
[2012-04-26 20:27:30 -0400] echiu: anyone running chef on windows?
[2012-04-26 20:39:14 -0400] hippiehacker: If I want to make sure a gem is installed for use in a library during a chef-clien run (libraries are loaded first, before providers, resources, definitions, attributes, recpies etc etc), how would I go about that?
[2012-04-26 20:39:51 -0400] hippiehacker: echiu: there are a few, but many cookbooks are posix only
[2012-04-26 20:40:47 -0400] echiu: running into issues even with the knife bootstrap during ruby install
[2012-04-26 20:41:29 -0400] echiu: trying to manage Windows 2008 nodes on EC2
[2012-04-26 20:41:43 -0400] hippiehacker: R1 or R2?
[2012-04-26 20:42:52 -0400] echiu: @hippiehacker: windows 2008 sp2 32-bit AMI
[2012-04-26 20:42:58 -0400] spyvrsspy: Hi, I am writting my first recipe to reboot a machine
[2012-04-26 20:43:40 -0400] spyvrsspy: https://gist.github.com/2503000
[2012-04-26 20:43:45 -0400] spyvrsspy: Im not sure what I am doing wrong
[2012-04-26 20:43:48 -0400] hippiehacker: create a gist of your knife bootstrap command and it's output with -l debug
[2012-04-26 20:45:25 -0400] hippiehacker: spyvrsspy: http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-04-26 20:46:35 -0400] hippiehacker: spyvrsspy: take a close look at the examples in http://wiki.opscode.com/display/chef/Resources#Resources-Script
[2012-04-26 20:46:36 -0400] echiu: @hippiehacker: ok, will get output and IM you later
[2012-04-26 20:47:03 -0400] hippiehacker: specifically the bash "installing_samething" resource
[2012-04-26 20:47:21 -0400] hippiehacker: you should have a code attribute
[2012-04-26 20:47:42 -0400] hippiehacker: echiu: if you post a gist to the channel, you have a much better chance for quick response
[2012-04-26 20:50:42 -0400] laurent\: hippiehacker: i've proposed another patch to fix OHAI-322, would you have time to confirm it fixes it please ? :)
[2012-04-26 20:51:06 -0400] hippiehacker: laurent\: I'll take a look today
[2012-04-26 20:52:34 -0400] laurent\: ok
[2012-04-26 20:53:21 -0400] hippiehacker: laurent\: the logic on line 77 is off
[2012-04-26 20:53:35 -0400] hippiehacker: it's a regex that looks for anything
[2012-04-26 20:54:07 -0400] hippiehacker: you should change line 77 to look for an actual '.' or ':' to include both
[2012-04-26 20:54:10 -0400] laurent\: yep it's useless
[2012-04-26 20:54:46 -0400] hippiehacker: though I like that you are actually saving back ipv6 and ivp4
[2012-04-26 20:54:55 -0400] hippiehacker: my patch just looked for ivp4 and dropped ivp6
[2012-04-26 20:55:07 -0400] hippiehacker: I'll combine the two approaches
[2012-04-26 20:56:02 -0400] laurent\: ok
[2012-04-26 20:56:52 -0400] laurent\: just have to remove line 77 and its correspond end
[2012-04-26 20:57:17 -0400] laurent\: (i don't have the entire src file in front of me tho)
[2012-04-26 20:57:34 -0400] yfeldblum: hippiehacker, you can either ensure the gem is only required from within a function or install the gem in a bootstrap script
[2012-04-26 20:58:16 -0400] hippiehacker: yfeldblum: I went for the function approach, makes sense in the bootstrap as well
[2012-04-26 21:01:33 -0400] kreedy_: for deploy resource symlinks, is there a best practice way of making the directories exist in 'shared/' folder first? `create_dirs_before_symlink` sounds like it creates the directories in the release folder. or is directory('/home/repo/shared/dir_name') what should be done?
[2012-04-26 21:03:06 -0400] spyvrsspy: hippiehacker, cool, thanks!
[2012-04-26 21:03:09 -0400] spyvrsspy: got it to work
[2012-04-26 21:04:40 -0400] AntonZ: folks, there is a cookbook called http://community.opscode.com/cookbooks/s3_file
[2012-04-26 21:04:56 -0400] AntonZ: but it's really a single file and not a cookbook, what do i do with it if i wnat to use it ?
[2012-04-26 21:08:22 -0400] AntonZ: it says it's pure ruby, thats fine, how do i plug into a run list ?
[2012-04-26 21:08:28 -0400] AntonZ: its not a cookbook per say
[2012-04-26 21:09:04 -0400] miah: is it a cookbook or a tarball?
[2012-04-26 21:09:26 -0400] AntonZ: oh, shoot, it's multi-archive or something, nevermind, i had to dig deeper... tricky, tricky
[2012-04-26 21:09:37 -0400] cwj: AntonZ: include_recipe 's3_file'
[2012-04-26 21:09:45 -0400] cwj: and gain access to its LWRP
[2012-04-26 21:10:22 -0400] miah: its recipe is empty, but it has a provider which gives you access to the lwrp
[2012-04-26 21:10:43 -0400] AntonZ: cheers
[2012-04-26 21:11:19 -0400] daaaan: any suggestions for rolling out a cookbook to a specific set of nodes? i can't break it up by environment or role
[2012-04-26 21:11:29 -0400] daaaan: like i want the cookbook installed on 20% of our production webapp servers
[2012-04-26 21:12:49 -0400] miah: chef-solo?
[2012-04-26 21:12:49 -0400] bawt: chef-solo is such a time saver
[2012-04-26 21:12:57 -0400] miah: bawt, sometimes you make me sad
[2012-04-26 21:13:25 -0400] miah: if you're not using chef roles / environments. i'd think deploying a certain cookbook to 20% of your servers would fall into your deployment strategy
[2012-04-26 21:14:25 -0400] daaaan: we use roles and environments
[2012-04-26 21:14:37 -0400] AntonZ: what is PaxHeader ?
[2012-04-26 21:14:45 -0400] AntonZ: S3_file cookbook has this folder
[2012-04-26 21:14:52 -0400] daaaan: i only want this pushed out to 20% (or whatever) of "role:webapp and chef_environment:production"
[2012-04-26 21:15:05 -0400] miah: use tags
[2012-04-26 21:15:12 -0400] miah: and tag 20% of your servers
[2012-04-26 21:15:32 -0400] daaaan: h nice
[2012-04-26 21:15:35 -0400] daaaan: ah nice*
[2012-04-26 21:15:38 -0400] miah: (role:webapp AND tags:20percent) AND chef_environment:production
[2012-04-26 21:25:13 -0400] aslan: are there any bash scripts that can get a dump of each role and save it as json?
[2012-04-26 21:26:07 -0400] AntonZ: okay, that s3_file cookbook - i dont understand who uploaded to opscode, but it's not very user friednly... i dont even understand how to approach it, weird
[2012-04-26 21:26:16 -0400] miah: knife role show <role> -Fj
[2012-04-26 21:26:19 -0400] aslan: It should iterate the output of knife role list and on the out put knife role shoe $role -F json > $role.json? something like that
[2012-04-26 21:26:52 -0400] miah: for i in $(knife role list) do knife role show $i -Fj >> roles.json done
[2012-04-26 21:26:55 -0400] aslan: miah: yeah i wanted to automate this for all of the roles and not run it one role at a time
[2012-04-26 21:27:35 -0400] aslan: miah: doesn't knife role list return a json? can bash read the output ?
[2012-04-26 21:27:39 -0400] miah: no
[2012-04-26 21:27:47 -0400] miah: it returns text unless you tell it to output json
[2012-04-26 21:28:48 -0400] aslan: ok let me try that
[2012-04-26 21:36:45 -0400] josephholsten: is anyone else having segfaults using chef-0.10.10 in ruby-1.9 or ruby-2.0?
[2012-04-26 21:39:18 -0400] aslan: miah: i am getting a json output
[2012-04-26 21:42:23 -0400] miah: make sure you don't have it aliased
[2012-04-26 21:42:35 -0400] miah: or set the default output to json in a config or something
[2012-04-26 21:42:43 -0400] miah: knife role list by itself just lists roles
[2012-04-26 21:43:57 -0400] dhawth: is there a way to insert metadata for a node into chef using knife that I can do in an automated way *not* using an ohai plugin?
[2012-04-26 21:44:18 -0400] aslan: i dont have any aliases this is the format i have always seen from knife role list https://gist.github.com/2503427
[2012-04-26 21:46:33 -0400] cwj: dhawth: knife exec
[2012-04-26 21:46:45 -0400] cwj: http://wiki.opscode.com/display/chef/Knife+Exec
[2012-04-26 21:46:46 -0400] aslan: miah: bash can't handle all the extra strings
[2012-04-26 21:48:15 -0400] miah: extra strings?
[2012-04-26 21:48:27 -0400] miah: the json stuff? well of course. but like i said. default output isn't json
[2012-04-26 21:48:44 -0400] cwj: dhawth: here's a knife exec script i wrote for setting the value of particular node attributes https://gist.github.com/2293568
[2012-04-26 21:48:49 -0400] aslan: miah: this is what i am getting https://gist.github.com/2503427 isn't this json?
[2012-04-26 21:49:19 -0400] aslan: miah: and i dont have any thing configured for knife other than what you get out of the box
[2012-04-26 21:49:27 -0400] miah: aslan: http://wiki.opscode.com/display/chef/Knife#Knife-ConfiguringYourSystemForKnife
[2012-04-26 21:50:04 -0400] miah: are you on chef 0.9 or older?
[2012-04-26 21:50:31 -0400] aslan: i am on 0.9
[2012-04-26 21:50:48 -0400] miah: ah. well. theres your problem.
[2012-04-26 21:50:51 -0400] miah: upgrade already =)
[2012-04-26 21:51:15 -0400] miah: or set format = summary in you knife.rb
[2012-04-26 21:51:19 -0400] miah: if that works in 0.9
[2012-04-26 21:51:25 -0400] dhawth: knife exec looks perfect, thanks
[2012-04-26 21:51:58 -0400] aslan: miah: knife role list -F text is giving me the same output
[2012-04-26 21:52:11 -0400] aslan: i mean same format
[2012-04-26 21:52:34 -0400] miah: s/text/summary
[2012-04-26 21:54:25 -0400] aslan: miah: didn't work :/
[2012-04-26 21:54:39 -0400] aslan: never mind i will parse the output in bash
[2012-04-26 21:57:10 -0400] hoover_damn: aslan, so one of your roles is being interperted as a role?
[2012-04-26 21:57:20 -0400] hoover_damn: err array?
[2012-04-26 21:57:54 -0400] aslan: hoover_damn: this is what i get when i run knife role list https://gist.github.com/2503427
[2012-04-26 21:58:35 -0400] workmad3: aslan: looks right
[2012-04-26 21:59:07 -0400] hoover_damn: aslan, and that's it?
[2012-04-26 21:59:19 -0400] aslan: workmad3: i know... i was actually looking for a bash script that parses that and runs knife role show $role > $role.json on it
[2012-04-26 22:00:07 -0400] workmad3: aslan: looking for an automated way to pull your roles into json files? :)
[2012-04-26 22:00:20 -0400] aslan: workmad3: yes :)
[2012-04-26 22:00:31 -0400] josephholsten: Anyone using the chef beta in ruby 1.9+? I'd like to check a bug is reproducible
[2012-04-26 22:00:48 -0400] hoover_damn: sup?
[2012-04-26 22:01:05 -0400] hoover_damn: josephholsten, hope it's not a windows bug
[2012-04-26 22:01:29 -0400] workmad3: aslan: I normally go the other way around tbh... I start with the json (or more recently, the .rb) file and then load it with knife role from file :)
[2012-04-26 22:01:51 -0400] miah: ditto
[2012-04-26 22:02:05 -0400] josephholsten: hoover_damn: not windows today, thankfully
[2012-04-26 22:02:13 -0400] aslan: workmad3: i didn't do that and now i need to backup everything before upgrading chef
[2012-04-26 22:02:44 -0400] workmad3: aslan: I assume you actually have more than just those 2 roles?
[2012-04-26 22:02:50 -0400] josephholsten: hoover_damn: I'm getting segfaults when I do a knife bootstrap
[2012-04-26 22:03:07 -0400] workmad3: aslan: otherwise... just do the two roles manually, it will be a lot quicker than writing a script :)
[2012-04-26 22:03:08 -0400] aslan: workmad3: yeah... its roles and then everything else. data bags etc
[2012-04-26 22:03:17 -0400] hoover_damn: josephholsten, hrm, what command?
[2012-04-26 22:03:42 -0400] josephholsten: doesn't appear in 1.8.7, having trouble winnowing it to the relevant bit of net-ssh/openssh code
[2012-04-26 22:04:31 -0400] josephholsten: hoover_damn:  essentially knife bootstrap 10.100.1.150 --run-list 'role[ubuntu],role[base],role[sea]' --ssh-user god --ssh-password 's3kr3t' --sudo --environment production
[2012-04-26 22:04:56 -0400] hoover_damn: lol
[2012-04-26 22:04:59 -0400] hoover_damn: yeah no biggie
[2012-04-26 22:05:12 -0400] hoover_damn: can you knife ssh?
[2012-04-26 22:05:31 -0400] hoover_damn: and pasting any backtrace is helpful
[2012-04-26 22:05:34 -0400] hoover_damn: gists
[2012-04-26 22:06:01 -0400] josephholsten: and whoa no way on the knife ssh
[2012-04-26 22:06:12 -0400] josephholsten: pastie?
[2012-04-26 22:06:13 -0400] bawt: pastie is your friend.
[2012-04-26 22:06:46 -0400] hoover_damn: gist.github.com or pastie.org
[2012-04-26 22:06:49 -0400] hoover_damn: or whatever your preference is
[2012-04-26 22:06:50 -0400] josephholsten: pastie is not my friend, bawt. it is down.
[2012-04-26 22:06:58 -0400] josephholsten: bad bawt.
[2012-04-26 22:07:00 -0400] hoover_damn: bawt, forget pastie
[2012-04-26 22:07:01 -0400] bawt: fine
[2012-04-26 22:07:47 -0400] hoover_damn: knife ec2 server create seems to bitch heavily if you omit a zone
[2012-04-26 22:08:03 -0400] hoover_damn: give me about 10more seconds
[2012-04-26 22:08:09 -0400] hoover_damn: my ami takes about 30seconds to boot
[2012-04-26 22:08:17 -0400] hoover_damn: should be better when I move to systemd
[2012-04-26 22:08:50 -0400] hoover_damn: Please collect the output of this command with the `-VV` option before filing a bug report.
[2012-04-26 22:08:51 -0400] miah: aslan: i <3 ugly bash. knife role list -Fj|cut -f2 -d\"|egrep -v '\[|\]'
[2012-04-26 22:08:53 -0400] hoover_damn: Exception: NoMethodError: undefined method `strip' for nil:NilClass
[2012-04-26 22:08:55 -0400] hoover_damn: ?
[2012-04-26 22:08:58 -0400] hoover_damn: something similar to that?
[2012-04-26 22:09:38 -0400] miah: can clean that up
[2012-04-26 22:10:10 -0400] hoover_damn: do you have knife[:ssh_attribute] defined?
[2012-04-26 22:10:11 -0400] josephholsten: https://gist.github.com/2503582
[2012-04-26 22:10:12 -0400] aslan: miah: it works ;)
[2012-04-26 22:10:16 -0400] aslan: thanks
[2012-04-26 22:10:24 -0400] josephholsten: log. so much log.
[2012-04-26 22:10:25 -0400] miah: enjoy
[2012-04-26 22:10:30 -0400] josephholsten: hoover_damn: ^^
[2012-04-26 22:11:46 -0400] hoover_damn: josephholsten, rvm?
[2012-04-26 22:12:01 -0400] hoover_damn: ahh rbenv
[2012-04-26 22:12:08 -0400] hoover_damn: trypppy i'm 100% brew here
[2012-04-26 22:12:10 -0400] hoover_damn: no issue
[2012-04-26 22:12:21 -0400] josephholsten: hmm, that's a totally different CFUNC than the one from knife bootstrap
[2012-04-26 22:12:43 -0400] josephholsten: but they're both from openssh
[2012-04-26 22:13:22 -0400] hoover_damn: well i'm getting an openssh backtrace
[2012-04-26 22:13:40 -0400] josephholsten: but to confirm, is it working or not working for you?
[2012-04-26 22:13:43 -0400] hoover_damn: but i just fixed it by reading the docs
[2012-04-26 22:13:47 -0400] hoover_damn: so it's working
[2012-04-26 22:13:59 -0400] hoover_damn: knife[:ssh_attribute] = "ec2.public_hostname"
[2012-04-26 22:14:08 -0400] hoover_damn: you likely want knife[:ssh_attribute] = "ipaddress"
[2012-04-26 22:14:26 -0400] josephholsten: in my knife.rb?
[2012-04-26 22:14:28 -0400] hoover_damn: yep
[2012-04-26 22:16:38 -0400] josephholsten: no dice. gonna try rebuilding openssh and ruby
[2012-04-26 22:16:49 -0400] hoover_damn: you have a custom openssh?
[2012-04-26 22:17:27 -0400] josephholsten: dunno, but I'll be checking
[2012-04-26 22:17:49 -0400] josephholsten: hmm, there's one from macports, I'll try ripping it out
[2012-04-26 22:18:21 -0400] hoover_damn: because really a beta version of chef shouldn't cause stuff like that
[2012-04-26 22:20:10 -0400] josephholsten: agreed, especially with the rc almost out
[2012-04-26 22:21:47 -0400] aethier: Anyone can help me with knife ssh?  knife search node name:yum-server-01 returns a node (the one I want) but knife ssh "node:yum-server-01"  or knife ssh "name:yum-server-01"  returns FATAL: No nodes returned from search!  Any ideas?   Anyone has a sample knife ssh command that would allow me to knife ssh a single node by it's name? - thanks
[2012-04-26 22:22:58 -0400] hippiehacker: laurent\: https://github.com/opscode/ohai/pull/70  # this works, ipv4 and ivp6 detected
[2012-04-26 22:26:16 -0400] hippiehacker: laurent\: anything I can do to help OHAI-357 get through let me know, I work around it by using a recipe to delete extra ohai data at the node, but it still increases the chef-client run times and node data generation by an order of magnitude in a normal use cases
[2012-04-26 22:26:30 -0400] hippiehacker: laurent\: I'm just not sure of the approach that should be used
[2012-04-26 22:28:49 -0400] josephholsten: hippiehacker: thank you!
[2012-04-26 22:31:44 -0400] jhowarth: I've created a client on https://manage.opscode.com/clients and updated my .pem locally, but for some reason I'm getting authentication errors.  Here's my knife.rb and error: https://gist.github.com/2503753
[2012-04-26 22:32:02 -0400] jhowarth: Any ideas on what I might be doing wrong?
[2012-04-26 22:40:25 -0400] jhowarth: Figured it out.
[2012-04-26 22:47:07 -0400] laurent\: hippiehacker: your pull request includes a lot of things I think you don't want included :)
[2012-04-26 22:48:52 -0400] laurent\: hippiehacker: about OHAI-357, you should talk to sascha_d about it ! :) he's trying to split the windows kernel plugin in two so he can disable the second piece
[2012-04-26 22:52:59 -0400] sascha_d: hi wat?
[2012-04-26 22:53:57 -0400] sascha_d: I did actually do some work to split the plugin
[2012-04-26 22:54:12 -0400] sascha_d: I ran into some issues testing and haven't been able to get back to it
[2012-04-26 22:54:59 -0400] laurent\: sascha_d: it looks like hippiehacker he trying to do the same thing : http://tickets.opscode.com/browse/OHAI-357
[2012-04-26 22:55:01 -0400] sascha_d: I also need to test  what will happen if a require statement conflicts with a plugin disable
[2012-04-26 22:55:54 -0400] sascha_d: I'm actually working on the windows/kernel plugin
[2012-04-26 22:56:16 -0400] laurent\: i let guys talk about it, i'm not really a windows user and i'm off to bed anyway ! :-)
[2012-04-26 22:56:27 -0400] sascha_d: oh yup, I see that's in the ticket - I was looking at the pull request
[2012-04-26 22:58:18 -0400] thehar: Ticket purchased to Chefcon
[2012-04-26 23:00:49 -0400] thehar: woooo
[2012-04-26 23:01:11 -0400] miah: awesome
[2012-04-26 23:02:19 -0400] thehar: ohnoes
[2012-04-26 23:03:01 -0400] sascha_d: @hippiehacker I can try to look at it again tonight or this weekend.  My thought was to create a second plugin for the windows/kernel_drivers and require it in the main kernel plugin with the windows/kernel - then see if the disable statement trumps the require
[2012-04-26 23:27:37 -0400] leed0: does anyone have any idea why this would be happening when I try to run chef-server after upgrading to 12.04? https://gist.github.com/0c1b7e1989af17bd0dab
[2012-04-26 23:35:42 -0400] leed0: nm, fixed by updating some modules
