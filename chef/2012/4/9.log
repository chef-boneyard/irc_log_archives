[2012-04-09 01:02:59 -0400] AduKen: Hi
[2012-04-09 01:04:14 -0400] coderanger: Haldo
[2012-04-09 01:04:45 -0400] AduKen: I know chefs from very little time ... Could I ask someone for help? thanks
[2012-04-09 01:06:39 -0400] coderanger: Don't ask to ask, just go ahead
[2012-04-09 01:11:42 -0400] AduKen: ok sorry :)
[2012-04-09 01:13:37 -0400] AduKen: I would need a link or guide that shows step by step how to configure something on a client chef .. for example: ip addresses or users ..
[2012-04-09 01:13:55 -0400] AduKen: something very simple
[2012-04-09 01:16:04 -0400] coderanger: Try the quick start guides on the wiki
[2012-04-09 01:17:07 -0400] AduKen: ok, I will try
[2012-04-09 01:17:10 -0400] AduKen: Thanks
[2012-04-09 03:28:17 -0400] miah: hi
[2012-04-09 06:54:12 -0400] jtoft: I have an internal gem repository; but when I bootstrap a client with chef and I try to do a gem sources -r http://rubygems.org/; gem sources -c; and then gem_package "my gem" I receive a full_name nil error.
[2012-04-09 06:54:22 -0400] jtoft: Is there any sane way of forcing a Gem Sources list on chef runs?
[2012-04-09 07:01:39 -0400] jtoft: ah never mind. You can specify the source in the gem_package
[2012-04-09 08:40:10 -0400] AduKen: Hello,  I created a cookbooks.. how to execute on the client machine?
[2012-04-09 08:43:38 -0400] luisico: AduKen, chef-solo or chef-client?
[2012-04-09 08:54:22 -0400] Aduken2: luisico, che-client
[2012-04-09 08:54:29 -0400] Aduken2: chef-client
[2012-04-09 08:55:09 -0400] luisico: so, upload your cookbook to your chef server and create a run list for the node you want to run that cookbook in
[2012-04-09 08:55:15 -0400] luisico: and then execute chef-client
[2012-04-09 08:55:23 -0400] Aduken2: but
[2012-04-09 08:55:44 -0400] Aduken2: why i have not knife cookbook site install  ?
[2012-04-09 08:55:56 -0400] Aduken2: there isn't "install"
[2012-04-09 08:59:25 -0400] luisico: Aduken2, notice that cookbook and coookbook site subcommands are for different purposes
[2012-04-09 08:59:44 -0400] luisico: you have a knife cookbook site install
[2012-04-09 09:00:11 -0400] luisico: but you used it to interact with the community cookbook site
[2012-04-09 09:00:18 -0400] luisico: not for adding your cookbook to your chef server
[2012-04-09 09:00:56 -0400] luisico: from chef wiki:
[2012-04-09 09:00:57 -0400] luisico: install
[2012-04-09 09:00:57 -0400] luisico: Installs a cookbook from the community site to your local repository using the git version control system.
[2012-04-09 09:01:15 -0400] luisico: is that what you want?
[2012-04-09 09:02:15 -0400] Aduken2: yes
[2012-04-09 09:02:29 -0400] Aduken2: i want install "getting-started"
[2012-04-09 09:14:28 -0400] luisico: AduKen, the fast start guide is pretty straightforward
[2012-04-09 09:14:29 -0400] luisico: http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-04-09 09:14:49 -0400] luisico: steps 6 and 7
[2012-04-09 09:15:10 -0400] luisico: in step 6 you install the community cookbook to your repo
[2012-04-09 09:15:23 -0400] luisico: and in step 7 you upload it to your chef server
[2012-04-09 09:23:46 -0400] Bricka: uok
[2012-04-09 09:24:08 -0400] Bricka: I'm a cat
[2012-04-09 09:24:09 -0400] Bricka: wsup den
[2012-04-09 10:09:23 -0400] eugenmayer1: it possible to tell the chef-server to use an alias to connect to a host or at least specify port / ip ?
[2012-04-09 10:10:08 -0400] eugenmayer1: z if you are arrounnd, jsut tested ohai.get_interface_ip .. but that method seems not to exist on the node, also node.chef.attribute is not valid
[2012-04-09 10:10:24 -0400] eugenmayer1: iam missing any "imports" or what iam doing wrong?
[2012-04-09 10:19:40 -0400] zts: eugenmayer1: the chef server doesn't connect out to your nodes - what is it you're trying to do, exactly?
[2012-04-09 10:20:15 -0400] eugenmayer1: zts well i tried to update the client. I actually now gone to the client and run chef-client. Having issues with the cookbook now
[2012-04-09 10:20:56 -0400] eugenmayer1: but actually, before you guys get annoyed, iam reading some cookbooks / code docs to really have the basics and maybe ask some detailed questions later
[2012-04-09 10:22:28 -0400] zts: Folks in here are generally pretty patient, particularly if you're happy to go off and read things that get pointed out
[2012-04-09 10:22:55 -0400] zts: there's a fair learning curve when you're first getting started, so don't be shy about asking questions if things are confusing
[2012-04-09 10:23:42 -0400] zts: If you're running into errors, it's usually best to put them on a pastebin and share the link in here
[2012-04-09 10:24:17 -0400] zts: but if things just aren't working the way you expect (but aren't obviously failing either), talking through what you're trying to do is totally fine
[2012-04-09 10:27:13 -0400] eugenmayer1: zts: thank you!
[2012-04-09 10:27:19 -0400] null_route: hi Guys!  I'm using the git SCM resource and I want to pass GIT a public key through a data bag
[2012-04-09 10:27:28 -0400] null_route: There is a hint at http://wiki.opscode.com/display/chef/Deploy+Resource (right side-bar
[2012-04-09 10:27:51 -0400] null_route: but it's not clear how to implement it
[2012-04-09 10:28:23 -0400] null_route: How do I get the git resource to find the key once I put it in the databag?
[2012-04-09 10:30:18 -0400] null_route: Hmmmm
[2012-04-09 10:30:25 -0400] ashb: null_route: http://wiki.opscode.com/display/chef/Deploy+Resource?focusedCommentId=23429504#comment-23429504
[2012-04-09 10:30:36 -0400] null_route: jtimberman: You mentioned something about this in http://help.opscode.com/discussions/problems/594-how-to-set-up-ssh-key-for-deploying-application-from-private-git-repo
[2012-04-09 10:30:54 -0400] ashb: the app cookbook does it by creating an ssh_wrapper for git to use that specifies the keyfile
[2012-04-09 10:32:22 -0400] null_route: Thanks, ashb , but I would much rather manage the file in a databag and not with a file
[2012-04-09 10:32:44 -0400] null_route: ...if at all possible
[2012-04-09 10:36:19 -0400] eugenmayer1: guys, the docs are _awesome_
[2012-04-09 10:39:19 -0400] ashb: null_route: the application cookbook creates it based on the value in the databag
[2012-04-09 10:39:24 -0400] ashb: see how it does it
[2012-04-09 10:39:50 -0400] kostyasha: i have zombie  - chef-expander, is it ok?
[2012-04-09 10:40:47 -0400] null_route: ashb: sorry for the dumb questions - but _what_ application cookbook?
[2012-04-09 10:41:04 -0400] null_route: I'm using teh SCM resource in a recipe I'm writing
[2012-04-09 10:41:23 -0400] kostyasha: hmm.. continious ps aufx shows different pid..
[2012-04-09 10:42:47 -0400] null_route: ashb: OK - I'll go read up on Application
[2012-04-09 10:44:48 -0400] eugenmayer1: zs
[2012-04-09 10:45:31 -0400] eugenmayer1: zts: well, its too easy to get all this working. Iam absolutely amazed how intuitive the docs / code isstill, iam failing to get the ip of an clients interface using ohai:
[2012-04-09 10:45:32 -0400] eugenmayer1: [Mon, 09 Apr 2012 12:44:39 +0200] FATAL: NoMethodError: undefined method `get_interface_ip' for nil:NilClass
[2012-04-09 10:45:41 -0400] eugenmayer1: using : external_ip = @ohai.get_interface_ip("maintainbr0")
[2012-04-09 10:46:10 -0400] ashb: null_route: https://github.com/opscode-cookbooks/application/blob/master/recipes/rails.rb#L78-101
[2012-04-09 10:46:44 -0400] null_route: ashb: Thanks! That clears things up!
[2012-04-09 10:46:47 -0400] ashb: though why it uses a ruby block there and not a file resource with content instead I don't know
[2012-04-09 10:46:57 -0400] eugenmayer1: it seems like its not yet in? https://github.com/opscode/ohai/pull/34
[2012-04-09 10:48:29 -0400] eugenmayer1: well yeah.http://tickets.opscode.com/browse/OHAI-88
[2012-04-09 10:49:58 -0400] eugenmayer1: hmm trying that code, host seem to be undefined.
[2012-04-09 10:54:34 -0400] kostyasha: how monitor that all recipes applied ok on nodes?
[2012-04-09 11:18:39 -0400] kostyasha: where is getting-started sources are located on github ?
[2012-04-09 12:26:29 -0400] eugenmayer1: how you deploy a debian package ( a custom one ) and "predefine" debconf vars?
[2012-04-09 12:28:33 -0400] Babar: eugenmayer1? THE EugenMayer?
[2012-04-09 12:28:46 -0400] eugenmayer1: Hi Olivier :)
[2012-04-09 12:28:49 -0400] Babar: eugenmayer1: check the java_sun recipe, it does just that
[2012-04-09 12:28:55 -0400] eugenmayer1: Babar: thanks
[2012-04-09 12:29:37 -0400] eugenmayer1: How are you Olivier?
[2012-04-09 12:29:48 -0400] Babar: eugenmayer1: https://github.com/Babar/foswiki-vagrant/blob/master/cookbooks/java_sun/recipes/default.rb#L54   for example
[2012-04-09 12:29:49 -0400] eugenmayer1: Still at CERN?
[2012-04-09 12:29:56 -0400] Babar: yes, still. I'm good, thanks.
[2012-04-09 12:29:59 -0400] Babar: long time no see :)
[2012-04-09 12:30:09 -0400] eugenmayer1: Great to here
[2012-04-09 12:31:06 -0400] eugenmayer1: *hear
[2012-04-09 12:38:53 -0400] eugenmayer1: Babar: not sure about https://github.com/Babar/foswiki-vagrant/blob/master/cookbooks/java_sun/files/default/java.seed
[2012-04-09 12:39:24 -0400] Babar: eugenmayer1: what do you mean? it's the debconf entries. You know how to make a seed file?
[2012-04-09 12:39:55 -0400] eugenmayer1: Well, googling. I wasnt aware of what a "seed file" is at all. Will check this. Thank you!
[2012-04-09 12:42:17 -0400] Babar: basically, usually, you install the package, and configure it using debconf the way you want, and then you use debconf-get-selections to create the pre-seed file
[2012-04-09 12:46:02 -0400] eugenmayer1: Babar: i think, i have to go the debconf configuration way, because my debconf vars depend on node-attribtues
[2012-04-09 12:47:12 -0400] eugenmayer1: Babar: preseeding would be rather static. Also interesting for some packages of course, but in this particular case, i rather need to configure.
[2012-04-09 12:47:21 -0400] eugenmayer1: what i just dont see is, were you run debconf-set-selections in the package
[2012-04-09 12:47:28 -0400] eugenmayer1: (in the reciepe i mean)
[2012-04-09 12:48:02 -0400] eugenmayer1: ah. i see http://serverfault.com/questions/330456/how-do-i-provide-dpkg-configuration-parameters-to-aptitude-or-apt-get
[2012-04-09 12:48:30 -0400] eugenmayer1: very similar here with "response file". Just, for me, unusual to name it that way. But well, guess i have to learn those
[2012-04-09 12:49:02 -0400] eugenmayer1: i guess, i create an template for /var/cache/debconf/mypackage.seed then, deleting it afterwards
[2012-04-09 12:56:01 -0400] Babar: eugenmayer1: the response_file can be a template
[2012-04-09 12:57:46 -0400] Babar: which is funny, because the documentation doesn't mention it, but CHEF:294 has been merged, so...
[2012-04-09 12:58:53 -0400] eugenmayer1: Babar: http://pastie.org/3755399
[2012-04-09 12:58:59 -0400] eugenmayer1: so this is, then, kinda wrong?
[2012-04-09 12:59:39 -0400] Babar: yes. response_file uses templates or files, not something local on the disk
[2012-04-09 12:59:48 -0400] eugenmayer1: ok
[2012-04-09 13:00:07 -0400] Babar: it should work without it though
[2012-04-09 13:00:08 -0400] eugenmayer1: just in case, how to call template then at all? ( without deploying it localy?)
[2012-04-09 13:01:45 -0400] Babar: http://pastie.org/3755418
[2012-04-09 13:01:52 -0400] Babar: the code should call it, as per:
[2012-04-09 13:02:02 -0400] Babar: https://github.com/Reverand221/chef/commit/819703b10c94dec78a9c2103e352a25ba3abdb1a
[2012-04-09 13:02:13 -0400] Babar: which has been merged, as per http://tickets.opscode.com/browse/CHEF-294
[2012-04-09 13:02:59 -0400] eugenmayer1: Babar++
[2012-04-09 13:03:02 -0400] eugenmayer1: Thank you.
[2012-04-09 13:03:44 -0400] Babar: (not tested :))
[2012-04-09 13:23:00 -0400] eugenmayer1: Babar: having a files/defaul/repokey.pub .. how would i nicely deploy it with "response_file" ?
[2012-04-09 13:23:51 -0400] Babar: a response_file is for pre-seed files. Why would you want to deploy an ssh public key with it?!
[2012-04-09 13:23:53 -0400] eugenmayer1: ( i mean apt-key add )
[2012-04-09 13:24:42 -0400] eugenmayer1: Babar: no, then i misunderstood it. Lets rephrase, what is the most convinient way to deploy a apt-repo key?
[2012-04-09 13:24:52 -0400] eugenmayer1: command?
[2012-04-09 13:24:52 -0400] bawt: command is mount
[2012-04-09 13:25:18 -0400] eugenmayer1: "is mount?"
[2012-04-09 13:25:34 -0400] Babar: bawt: forget command
[2012-04-09 13:25:34 -0400] bawt: okies!
[2012-04-09 13:26:43 -0400] Babar: eugenmayer1: https://github.com/opscode-cookbooks/apt
[2012-04-09 13:27:06 -0400] Babar: the 4th example is exactly what you want
[2012-04-09 13:28:25 -0400] eugenmayer1: You are a hero.
[2012-04-09 13:28:38 -0400] eugenmayer1: i simply did not know about that apt-api
[2012-04-09 13:28:39 -0400] Babar: you knew that already
[2012-04-09 13:29:09 -0400] eugenmayer1: include_reciepe apt
[2012-04-09 13:29:32 -0400] geekbri: Can you not upload cookbooks to the community site with a metadata.rb instead of metadata.json??
[2012-04-09 13:30:24 -0400] jtimberman: you can, we do for all ours.
[2012-04-09 13:30:38 -0400] geekbri: I tried and it fired off a message telling me I need a metadata.json, i have a metadata.rb
[2012-04-09 13:31:35 -0400] jtimberman: can you gist knife cookbook site share -VV output?
[2012-04-09 13:32:01 -0400] geekbri: jtimberman: I was doing it through the website interface.
[2012-04-09 13:33:33 -0400] geekbri: jtimberman: i used knife instead and it worked fine
[2012-04-09 13:36:26 -0400] geekbri: perhaps the web interface requires a .json instead of an .rb ?
[2012-04-09 13:39:20 -0400] eugenmayer1: how to check, if the node already includes ( has executed ) a specific reciepe?
[2012-04-09 13:41:37 -0400] afallows: eugenmayer1: Are you trying to see if a recipe is in a node's run list, or whether or not the instructions have actually been carried out?
[2012-04-09 13:42:21 -0400] eugenmayer1: afallows: good point. I think, iam interested in both generally. In this particular case, rather if it has been carried out once
[2012-04-09 13:42:55 -0400] jtimberman: geekbri: oh, the form on the sitem ight require it, the knife command will convert it when it creates the tarball for you
[2012-04-09 13:43:17 -0400] afallows: eugenmayer1: Well, for the first case it is pretty easy, because if you are using knife you can type "knife node show NODE_NAME" and it will give you a lot of information, including everything in the run list. For the second case, it is a little trickier.
[2012-04-09 13:43:28 -0400] geekbri: jtimberman: fantastic.  That is what I ended up doing.  That is actually how I prefer to do it anyway, I just thought maybe for first time creation I had to login to the site.  Silly me :)
[2012-04-09 13:43:46 -0400] eugenmayer1: afallows: well, iam in a reciepe
[2012-04-09 13:44:08 -0400] jtimberman: geekbri: nope it will use your user key from the site (as long as your knife config points at that one
[2012-04-09 13:44:11 -0400] jtimberman: )
[2012-04-09 13:44:26 -0400] eugenmayer1: lets assume, a recipe requires a other reciepe at least to be in the run list ( or run before )
[2012-04-09 13:45:10 -0400] afallows: Ah. So in Recipe B, you want to only do something if Recipe A already ran?
[2012-04-09 13:45:36 -0400] eugenmayer1: exactly
[2012-04-09 13:45:39 -0400] jtimberman: eugenmayer1: so you put them in the order you want Chef to configure them.
[2012-04-09 13:46:10 -0400] eugenmayer1: jtimberman: that is a manual step an requieres the chef-admin to know exactly, what the deps are
[2012-04-09 13:47:05 -0400] doki_pen: I just updated a cron resource in recipe, but it didn't update the cron job the the client
[2012-04-09 13:47:13 -0400] doki_pen: is that a known issue?
[2012-04-09 13:47:13 -0400] jtimberman: eugenmayer1: why wouldn't you know what the dependencies are?
[2012-04-09 13:47:24 -0400] afallows: You may already know, but chef-client executes the run list in order, so if you have "recipe[do_this], recipe[do_that]" as your run list, do_this will always run before do_that.
[2012-04-09 13:47:44 -0400] eugenmayer1: afallows: yes, that was already known
[2012-04-09 13:47:58 -0400] jtimberman: if its a package manager installation thing, chef uses the underlying package management system to perform the installation, and the OS should "Do The Right Thing"(tm) according to its dependency resolver.
[2012-04-09 13:48:25 -0400] afallows: As far as I know, though, there isn't any meta-information about the chef-client run that you can use in recipes. I have to defer to more experienced people on that one.
[2012-04-09 13:49:19 -0400] jtimberman: there will always be some manual step(s) involved somewhere in the process. we don't have self aware systems yet (behold: Skynet!) :)
[2012-04-09 13:51:31 -0400] afallows: Sometimes you have to just trust that chef did what you told it to do. :)
[2012-04-09 13:52:03 -0400] jtimberman: btw, chef 0.10.10.beta.1 is available if you do "gem install --pre chef" and want to help out testing before we get a release candidate.
[2012-04-09 13:52:24 -0400] eugenmayer1: ok.
[2012-04-09 13:52:51 -0400] jtimberman: one of the cool new features is "chef_gem" which installs a gem automatically for use by chef in the current run, and install in the ruby that chef is using (e.g. the full stack installer)
[2012-04-09 13:53:13 -0400] jtimberman: </end_public_service_announcement>
[2012-04-09 13:53:23 -0400] afallows: <applause />
[2012-04-09 13:53:27 -0400] eugenmayer1: jtimberman: upgrading :)
[2012-04-09 13:53:46 -0400] eugenmayer1: is there a reciepe to run the chef-client periodicly?
[2012-04-09 13:54:29 -0400] jtimberman: eugenmayer1: the upgrade message wasn't specific for you, but you're welcome to upgrade and try it out :)
[2012-04-09 13:54:51 -0400] jtimberman: eugenmayer1: yes, opscode has 'chef-client' cookbook that will run chef-client as a service or cron job.
[2012-04-09 13:54:56 -0400] eugenmayer1: iam not running a huge production installation, so iam glad to help testing
[2012-04-09 13:55:00 -0400] jtimberman: http://ckbk.it/chef-client
[2012-04-09 13:55:03 -0400] jtimberman: Cheers :D
[2012-04-09 13:55:04 -0400] eugenmayer1: perfect
[2012-04-09 13:56:11 -0400] afallows: eugenmayer1: You can also call chef-client with the -i flag, which sets the interval (in seconds) that you want it to run at.
[2012-04-09 13:56:12 -0400] jtimberman: issues fixed in 0.10.10 are here: http://tickets.opscode.com/browse/CHEF/fixforversion/10702 "issues" on the left side
[2012-04-09 13:56:26 -0400] jtimberman: the closed issues are included.
[2012-04-09 13:56:41 -0400] eugenmayer1: knife cookbook download http://ckbk.it/chef-client
[2012-04-09 13:56:50 -0400] eugenmayer1: hmm, iam doing something wrong i guess
[2012-04-09 13:56:53 -0400] jtimberman: eugenmayer1: knife cookbook site download chef-client
[2012-04-09 13:57:02 -0400] eugenmayer1: ah
[2012-04-09 13:57:20 -0400] eugenmayer1: jtimberman++
[2012-04-09 13:57:28 -0400] eugenmayer1: Thank you .
[2012-04-09 13:57:45 -0400] jtimberman: i'd really like if we had 'knife community site' instead of 'knife cookbook site'
[2012-04-09 13:58:00 -0400] jtimberman: before it was community.opscode.com, it was cookbooks.opscode.com, hence the name of the knife command.
[2012-04-09 13:59:32 -0400] eugenmayer1: hm, as its a tgz, knife cookbook upload chef-client*.tgz seems not to work. Do i need to extract first and the upload ?
[2012-04-09 14:00:21 -0400] eugenmayer1: (iam just asking to go with the best-practice approach ASAP)
[2012-04-09 14:00:34 -0400] eugenmayer1: cookbooks?
[2012-04-09 14:00:35 -0400] bawt: cookbooks are packages for Chef recipes. Find cookbooks published by the community (including by Opscode) at http://community.opscode.com/cookbooks, and information about writing your own at http://wiki.opscode.com/display/chef/Cookbooks
[2012-04-09 14:01:03 -0400] eugenmayer1: ok. Solved.
[2012-04-09 14:03:00 -0400] eugenmayer1: root@monitoring /var # knife cookbook site install chef-client
[2012-04-09 14:03:00 -0400] eugenmayer1: Installing chef-client to /var/chef/cookbooks
[2012-04-09 14:03:22 -0400] eugenmayer1: ok, i guess i somehow have broken my installation with the upgrade jtimberman, or?
[2012-04-09 14:03:39 -0400] eugenmayer1: i used to have them in /var/lib/chef/
[2012-04-09 14:04:30 -0400] eugenmayer1: Version 0.10.8  Copyright  2009-2012 Opscode
[2012-04-09 14:04:35 -0400] eugenmayer1: the gui runs the old version
[2012-04-09 14:04:38 -0400] jtimberman: eugenmayer1: you install cookbooks in your "chef repository"
[2012-04-09 14:04:56 -0400] jtimberman: then from there you upload them to the chef server through the api with 'knife cookbook upload NAME'
[2012-04-09 14:05:23 -0400] jtimberman: the "cookbook site install" command will perform some automatic git branching and tagging for you
[2012-04-09 14:05:54 -0400] eugenmayer1: got that, but it looks like the folder is missing
[2012-04-09 14:07:39 -0400] eugenmayer1: args. I wasnt the person installed the chef server. It has been installed using debian packages..
[2012-04-09 14:45:07 -0400] eugenmayer1: is there an easy way to chose out of "available" attributes in the node-json browser ( or something similar ) or is it the chef-way to always read those file manually and create all those vars / objects manually? Feels like a lot work for something which could be so easy
[2012-04-09 14:50:05 -0400] afallows: What's the cleanest way to customize what appears in a node's client.rb file when I bootstrap a node?
[2012-04-09 14:52:11 -0400] hcastro: afallows: i think it may be writing a custom bootstrap template
[2012-04-09 14:53:09 -0400] afallows: hcastro: I think I may have found it, and I think you're right. I'm already using a custom bootstrap script, and I found where it manages the client.rb file. I think I can just add what I need in there.
[2012-04-09 14:53:23 -0400] afallows: (I didn't write the bootstrap script I'm using)
[2012-04-09 14:53:44 -0400] hcastro: afallows: above and below <%= config_content %>
[2012-04-09 14:54:59 -0400] afallows: hcastro: This should work, yeah? https://gist.github.com/2344030
[2012-04-09 14:55:36 -0400] hcastro: yeah, but i'm pretty sure adding ohai plugins is handled by the ohai cookbook
[2012-04-09 14:56:23 -0400] afallows: I haven't looked at that, I have a really simple, small plugin that I manage myself in a recipe. It just doesn't get loaded if there's no plugin path in client.rb
[2012-04-09 14:57:20 -0400] hcastro: afallows: http://wiki.opscode.com/display/chef/Distributing+Ohai+Plugins
[2012-04-09 15:17:15 -0400] eugenmayer1: Babar: Olivier you are still arround? After some work, http://pastie.org/3756090 seems not to quiet work. The seed file gets deployed and has the correct format. When i run that reciepe, the values do not get applied though. When i purge the module on the client and keep the seed, that running the command debconf-set-selections /var/cache/debconf/aegircl.seed before installing the module with apt-get install aegircl  it works perfe
[2012-04-09 15:17:22 -0400] eugenmayer1: any suggestions what iam doing wrong?
[2012-04-09 15:20:31 -0400] pwelch: good morning everyone. Has anyone ever seen this error" "denied: Permission denied - /var/run/chef/solr.pid" when trying to start chef-solr?
[2012-04-09 15:23:10 -0400] eugenmayer1: pwelch: some bets, the pid is owned by root, because you started the service using this user. Now you maybe run under chef and cannot remove that pid using this user
[2012-04-09 15:23:42 -0400] afallows: pwelch: Can you check whether chef-solr is already running?
[2012-04-09 15:23:53 -0400] pwelch: it is not currently running
[2012-04-09 15:24:31 -0400] pwelch: tried to start it while tailing the /var/log/chef/solr.log
[2012-04-09 15:25:22 -0400] pwelch: tail log output: http://pastebin.com/26YgMTHu
[2012-04-09 15:26:17 -0400] afallows: That certainly looks like a user privilege issue, although I haven't seen that with solr, specifically. Try starting it as root/with sudo?
[2012-04-09 15:27:00 -0400] pwelch: i did. ubuntu 10.04 `sudo /etc/init.d/chef-solr start`
[2012-04-09 15:27:35 -0400] pwelch: this is a fresh open-source chef-server install
[2012-04-09 15:27:40 -0400] pwelch: was working friday
[2012-04-09 15:27:49 -0400] pwelch: now search is broken this morning :/
[2012-04-09 15:48:57 -0400] eugenmayer1: hmm cant find a bacula-fd recipe. Really none there yet?
[2012-04-09 15:50:00 -0400] jtimberman: eugenmayer1: backups are often quite customized, so I imagine that those who have written a bacula cookbook are keeping it to themselves because it is really site specific.
[2012-04-09 15:50:23 -0400] eugenmayer1: well, no issues. Writing one myself. Wont be that much :)
[2012-04-09 15:50:43 -0400] eugenmayer1: iam really falling in love with chef!
[2012-04-09 15:51:07 -0400] eugenmayer1: Iam still though, not sure, how concurrent debconf / postinst and chef are. When you write the deb packages yourself
[2012-04-09 15:51:26 -0400] eugenmayer1: you really ask yourself wheather to use debconf + postinst or chef + attributes
[2012-04-09 15:51:50 -0400] eugenmayer1: sure, you can use debconf + postinst + chef-preseed but that kind of the double effort
[2012-04-09 15:51:59 -0400] hoover_damm: honestly, gem install backup
[2012-04-09 15:52:04 -0400] hoover_damm: people really under-value the backup gem
[2012-04-09 15:52:18 -0400] jtimberman: eugenmayer1: yes, you ask exactly that :)
[2012-04-09 15:52:19 -0400] hoover_damm: https://github.com/meskyanichi/backup
[2012-04-09 15:52:22 -0400] hoover_damm: take a look over the README
[2012-04-09 15:52:32 -0400] hoover_damm: you will find it very helpful, and it's just a crontab away
[2012-04-09 15:52:35 -0400] hoover_damm: more or less
[2012-04-09 15:52:42 -0400] hoover_damm: gem install, write the config file, cron it
[2012-04-09 15:52:43 -0400] hoover_damm: win
[2012-04-09 15:52:45 -0400] jtimberman: eugenmayer1: i prefer to define what i want the system to be in my chef recipe.
[2012-04-09 15:52:55 -0400] eugenmayer1: hoover_damm: wait, that is for? Replaceing bacula? No thanks.
[2012-04-09 15:53:18 -0400] hoover_damm: it's a backup solution absolutely.
[2012-04-09 15:53:24 -0400] hoover_damm: it can replace bacula likely with a little work
[2012-04-09 15:53:31 -0400] eugenmayer1: No.
[2012-04-09 15:54:14 -0400] hoover_damm: :) Your choice, the backup gem is a fantastic and easy way to backup databases, files, etc
[2012-04-09 15:54:34 -0400] eugenmayer1: iam not starting with bacula,it runs for 4 years now here
[2012-04-09 15:54:44 -0400] eugenmayer1: replacing it - never will. Its woderful.
[2012-04-09 15:54:46 -0400] hoover_damm: understood
[2012-04-09 15:54:55 -0400] eugenmayer1: but i guess, its taste :)
[2012-04-09 15:54:56 -0400] hoover_damm: I've been in situations where I can rsnapshot for 2+years
[2012-04-09 15:55:00 -0400] hoover_damm: and to move away would be hard
[2012-04-09 15:55:18 -0400] eugenmayer1: rsnapshot /drewish and bacula are really very different :)
[2012-04-09 15:55:27 -0400] hoover_damm: don't forget the dedupes
[2012-04-09 15:55:34 -0400] hoover_damm: fwiw, tarsnap is fantastic
[2012-04-09 15:55:37 -0400] eugenmayer1: Your backup solution is as good as the restore-time
[2012-04-09 15:55:56 -0400] hoover_damm: so is the backup time
[2012-04-09 15:56:00 -0400] eugenmayer1: e.g. being able to browser your catalog, mark some file and only restore them - awesome
[2012-04-09 15:56:09 -0400] hoover_damm: I've seen admins not monitor their backups enough
[2012-04-09 15:56:16 -0400] hoover_damm: and you find your systems backing up from 7-days ago
[2012-04-09 15:56:43 -0400] eugenmayer1: Cant happen with bacula actually :) You have monitors, status emails and all this.
[2012-04-09 15:57:02 -0400] jtimberman: paint the bikeshed green.
[2012-04-09 15:57:04 -0400] jtimberman: :)
[2012-04-09 15:57:25 -0400] hoover_damm: eugenmayer1, that only works when people pay attention to that
[2012-04-09 15:57:29 -0400] hoover_damm: :)
[2012-04-09 15:57:58 -0400] hoover_damm: jtimberman, I prefer a off puke bananana yellow
[2012-04-09 15:58:00 -0400] hoover_damm: lol
[2012-04-09 15:59:22 -0400] abstrusenick: i used ufw, but it seems port 80 is locally blocked
[2012-04-09 16:00:09 -0400] geekbri: I've know sys admins who take backups but never actually TEST them... ever.
[2012-04-09 16:05:04 -0400] hoover_damm: geekbri, i used to work in a company that did that every 2 weeks
[2012-04-09 16:05:12 -0400] hoover_damm: geekbri, we generated over 48tb's of backups every month
[2012-04-09 16:05:39 -0400] hoover_damm: never tested the backups, just presumed xfsdump did the job
[2012-04-09 16:06:18 -0400] hoover_damm: laziness is an issue
[2012-04-09 16:07:06 -0400] geekbri: thats a pretty bad idea, especially given how frequently XFS has always seemed to just... .lose data...
[2012-04-09 16:07:08 -0400] geekbri: at least for me.
[2012-04-09 16:07:55 -0400] hoover_damm: I don't think they really cared about the backups
[2012-04-09 16:08:40 -0400] hoover_damm: it's the only thing I can honestly come up with because how can you dump 48tb of data and not test a single tape to restore?
[2012-04-09 16:08:51 -0400] pwelch: does anyone have any suggestions on what to research for solr issues? It works when installed but left alone for a weekend and search stops working.
[2012-04-09 16:09:00 -0400] hoover_damm: might as well throw your data at the wall and hopes it 'backs up' via osmosis
[2012-04-09 16:10:40 -0400] geekbri: pwelch: have you scoured the logs?
[2012-04-09 16:11:05 -0400] geekbri: pwelch: might i recommend #solr, or their mailing list?
[2012-04-09 16:11:42 -0400] pwelch: geekbri: affirmative. restarted my server and now it says solr is started but I still can't do a knife search. checked the logs and nothing is yelling error
[2012-04-09 16:12:20 -0400] geekbri: pwelch: unfortunately i'm far from a solr expert so I can't be much help, hence my recommendations :-P
[2012-04-09 16:13:22 -0400] pwelch: geekbri: no worries. thanks anyway. reinstalled last week. was working friday and when I come the same issue happens. just really frustrated with chef right now
[2012-04-09 16:13:39 -0400] asterisk: anybody know how to get the deb-src keyword to work in the apt cookbook
[2012-04-09 16:16:40 -0400] Brad_K: geekbri & hoover_damm  quote from W. Curtis Preston (a friend of mine, and author of some O'Reilly books, see http://www.oreillynet.com/pub/au/701 )  "Backups are useless.  Restores are priceless." and "It's not backed up until it's verified."
[2012-04-09 16:16:58 -0400] geekbri: that last bit are words to live by
[2012-04-09 16:17:03 -0400] erratic: deb_src: whether or not to add the repository as a source repo as well
[2012-04-09 16:17:36 -0400] erratic: what does that mean
[2012-04-09 16:22:04 -0400] erratic: +apt_repository "php5.4.0" do
[2012-04-09 16:22:05 -0400] erratic: +  uri "http://ppa.launchpad.net/ondrej/php5/ubuntu"
[2012-04-09 16:22:05 -0400] erratic: +  components ["lucid", "main"]
[2012-04-09 16:22:05 -0400] erratic: +  keyserver "keyserver.ubuntu.com"
[2012-04-09 16:22:05 -0400] erratic: +  key "E5267A6C"
[2012-04-09 16:22:06 -0400] erratic: +  deb_src
[2012-04-09 16:22:06 -0400] erratic: +end
[2012-04-09 16:22:15 -0400] erratic: is there an argument that needs to go to deb_src
[2012-04-09 16:22:34 -0400] jtimberman: erratic: there might!
[2012-04-09 16:22:52 -0400] erratic: well there aint! no documentation for it
[2012-04-09 16:22:58 -0400] erratic: it makes me sad
[2012-04-09 16:23:08 -0400] erratic: and I'm already sad from the chantix
[2012-04-09 16:23:08 -0400] jtimberman: i'm sorry
[2012-04-09 16:23:12 -0400] jtimberman: deb_src true
[2012-04-09 16:23:15 -0400] jtimberman: is what you'll want
[2012-04-09 16:23:16 -0400] erratic: lol
[2012-04-09 16:23:20 -0400] erratic: thanks
[2012-04-09 16:23:38 -0400] jtimberman: where did you see that example?
[2012-04-09 16:23:47 -0400] erratic: there isnt one
[2012-04-09 16:23:54 -0400] erratic: the doc just talks about it on the git page
[2012-04-09 16:23:59 -0400] erratic: https://github.com/opscode-cookbooks/apt
[2012-04-09 16:24:05 -0400] erratic: deb_src: whether or not to add the repository as a source repo as well
[2012-04-09 16:24:09 -0400] erratic: thats all the info for it
[2012-04-09 16:24:30 -0400] jtimberman: ooh
[2012-04-09 16:25:39 -0400] erratic: god I feel like shit
[2012-04-09 16:28:16 -0400] geekbri: only $162 to get divorced. deal of the century
[2012-04-09 16:30:05 -0400] chip-: Compared to what mine cost it is
[2012-04-09 16:30:34 -0400] erratic: chip- they're not getting anything from me
[2012-04-09 16:30:48 -0400] erratic: I'll gladly do jail time and make it so not worth their while
[2012-04-09 16:31:23 -0400] erratic: notice I'm not using any pronouns they don't deserve to be called the pronoun they prefer and since this is kind of a professional channel I'm not going to be much more hateful than that about it
[2012-04-09 16:31:58 -0400] erratic: I need to find some friends who aren't fucking crazy
[2012-04-09 16:32:02 -0400] chip-: erratic: Before we get too o/t, I'll share with you the best advice I've ever gotten, which was given to me when I reached that point:
[2012-04-09 16:32:07 -0400] erratic: like all of my friends have problems
[2012-04-09 16:32:12 -0400] erratic: I dont want to deal with them anymore
[2012-04-09 16:33:04 -0400] chip-: erratic: Change hurts, a lot, which is why people tend not to change very much. But there is a limit to how much a person can hurt emotionally, and if you're at this point in your life, then you're probably already there.
[2012-04-09 16:33:30 -0400] chip-: erratic: What this means for you is: FREE CHANGE. You have a unique opportunity to make yourself more like the person you want to be at zero cost, because you probably can't hurt any worse than you already do.
[2012-04-09 16:33:34 -0400] chip-: So
[2012-04-09 16:33:37 -0400] chip-: I'm sorry you're there.
[2012-04-09 16:33:39 -0400] chip-: that's it.
[2012-04-09 16:33:46 -0400] chip-: That helped me a lot, maybe it'll help you too.
[2012-04-09 16:33:47 -0400] chip-: </offtopic>
[2012-04-09 16:34:09 -0400] erratic: chip- nah its just to the point where I dont want to know any of my friends anymore, I have one staying at my place Im helping her out but I really dont wanna she's into drugs and she'll never change and I dont want to ask her to
[2012-04-09 16:35:22 -0400] chip-: Ah, my mistake, I thought you were saying you're getting divorced.
[2012-04-09 16:35:32 -0400] erratic: I am
[2012-04-09 16:35:34 -0400] chip-: OH.
[2012-04-09 16:35:39 -0400] chip-: So, compounded problems.
[2012-04-09 16:35:49 -0400] erratic: yep!
[2012-04-09 16:35:54 -0400] chip-: I hope this part of your life passes soon.
[2012-04-09 16:36:28 -0400] erratic: if nothing else I have work
[2012-04-09 16:36:42 -0400] erratic: about the only thing in my life I care about anymore
[2012-04-09 16:37:20 -0400] chip-: Good time to learn a new tool, like Chef!
[2012-04-09 16:37:52 -0400] hoover_damm: Chef will change your universe
[2012-04-09 16:38:02 -0400] hoover_damm: but it won't make find_a_spouse "whoisnice" do
[2012-04-09 16:38:04 -0400] hoover_damm: action :marryme
[2012-04-09 16:38:05 -0400] hoover_damm: end
[2012-04-09 16:38:06 -0400] hoover_damm: any easier
[2012-04-09 16:38:37 -0400] hoover_damm: but it should be able to help you organize your Infrastructure enough so that your personal life is more yours
[2012-04-09 16:38:45 -0400] hoover_damm: which can change a lot
[2012-04-09 16:46:29 -0400] erratic: thank god for chef and an overwhelming workload
[2012-04-09 16:46:35 -0400] erratic: its not so overwelming to me really
[2012-04-09 16:47:09 -0400] erratic: but I can remember a time when I wouldn't have appreciated this much responsibility and planning and documenting and coding and learning new stuff
[2012-04-09 16:47:51 -0400] erratic: I have to document like crazy for these folks theres no way they'll find someone for the salary they're paying me to do the kind of work Im doing.
[2012-04-09 16:48:15 -0400] erratic: they're pretty well aware of this
[2012-04-09 16:48:31 -0400] erratic: hopefully it'll pay off in the end
[2012-04-09 16:48:47 -0400] erratic: hopefully I'll own the house I want near the arboretum before I'm 30
[2012-04-09 17:00:41 -0400] eugenmayer1: looking at some bacula-fd examples
[2012-04-09 17:00:42 -0400] eugenmayer1: set_unless[:bacula][:fd][:password] =
[2012-04-09 17:00:42 -0400] eugenmayer1: secure_password
[2012-04-09 17:01:00 -0400] eugenmayer1: trying to use this, but getting secure_password undefined. Is that not an internal method?
[2012-04-09 17:01:06 -0400] hoover_damm: erratic, totally to be able to define your infra in a org-mode file for me is :)
[2012-04-09 17:01:31 -0400] hoover_damm: too many years of off off commands that are not duplicated always
[2012-04-09 17:01:42 -0400] hoover_damm: and trying to match 2 systems without all the deets, is hard
[2012-04-09 17:03:00 -0400] jtimberman: eugenmayer1: its in the openssl cookbook
[2012-04-09 17:03:18 -0400] eugenmayer1: so i need to install it + include it?
[2012-04-09 17:03:45 -0400] jtimberman: eugenmayer1: it merely uses openssl's random generator to create a password, rather than the more predictable built in random number generator in ruby itself.
[2012-04-09 17:04:08 -0400] jtimberman: eugenmayer1: yeah, grab the openssl cookbook, declare a dependency on it in your cookbook's metadata
[2012-04-09 17:04:19 -0400] eugenmayer1: ah, how to declare deps?
[2012-04-09 17:04:25 -0400] eugenmayer1: did see that for now
[2012-04-09 17:04:28 -0400] eugenmayer1: metadata?
[2012-04-09 17:04:28 -0400] bawt: metadata is http://wiki.opscode.com/display/chef/Metadata or used to declare dependencies if you want to use anything from one cookbook in another.
[2012-04-09 17:04:40 -0400] eugenmayer1: sovled :)
[2012-04-09 17:05:29 -0400] eugenmayer1: jtimberman: thank you, once again.
[2012-04-09 17:13:53 -0400] miah: moin
[2012-04-09 17:14:43 -0400] holoway: miah: morning
[2012-04-09 17:32:28 -0400] Knightorc: Just wondering if anyone else has this issue on Windows with 0.10.8   I use a lot of templates to populate configuration files. In particular one to populate our Tomcat6 tomcat-users.xml file. On a change I have it notifying the Tomcat6 service to restart. Every pass of the chef-client trigers a restart, regardless if the resulting file from the template changes.  I've opened http://tickets.opscode.com/browse/CHEF-3024
[2012-04-09 17:33:42 -0400] hoover_damm: Knightorc, it's likely an issue with your erb template
[2012-04-09 17:33:55 -0400] hoover_damm: Knightorc, gisting your recipe and the template that's always running might help
[2012-04-09 17:34:10 -0400] erratic: well I managed to push a custom php 5.4 install with memcached support down our chef pipeline
[2012-04-09 17:34:10 -0400] erratic: that seemed to work ... what a pain in the ass
[2012-04-09 17:34:10 -0400] erratic: but then again
[2012-04-09 17:34:11 -0400] erratic: most people wouldn't do php 5.4 right now despite it being stable
[2012-04-09 17:34:21 -0400] hoover_damm: Knightorc, because how templates work is it generates the new template, then compares it to the old... and if they are different, it installs it
[2012-04-09 17:34:34 -0400] hoover_damm: Knightorc, so it's quite possible that you are writing something that always changes... like a file time
[2012-04-09 17:35:25 -0400] hoover_damm: or the equiv for Year.now
[2012-04-09 17:35:40 -0400] erratic: chip- btw the 160 is just for some company to put all the paperwork together for me
[2012-04-09 17:35:51 -0400] erratic: pretty sure its still like a 400$ filing fee
[2012-04-09 17:36:08 -0400] Knightorc: hoover_damm, I'll review my template to ensure I've done nothing silly
[2012-04-09 17:37:36 -0400] chip-: Prepare to drown in tech marketing buzzwords, but here's a press release about my work with Opscode over the last year-and-a-half: http://finance.yahoo.com/news/solutionset-takes-marketing-services-cloud-100000408.html
[2012-04-09 17:38:17 -0400] miah: awesome
[2012-04-09 17:38:52 -0400] hoover_damm: cool
[2012-04-09 17:42:13 -0400] Knightorc: hoover_damm,  think I figured it out. Thanks for making me relook.  my template resource has mode 0644 defined, which must have been touching the file everytime, rather than the expected mode'ing when it doesn't match
[2012-04-09 17:42:58 -0400] hoover_damm: doh
[2012-04-09 17:50:33 -0400] dambalah: i'm just getting started with Chef and I can't find out where to download my knife.rb file from
[2012-04-09 17:50:57 -0400] dambalah: could anyone point me to it please?
[2012-04-09 17:52:11 -0400] btm: dambalah: Are you using Hosted Chef or your own Open Source Chef Server?
[2012-04-09 17:52:17 -0400] dambalah: Hosted Chef
[2012-04-09 17:53:22 -0400] jperry: running integration tests that use the report handlers
[2012-04-09 17:53:40 -0400] jperry: when tests fail a non-zero code is not returned
[2012-04-09 17:53:47 -0400] jtimberman: chip-: oh! :D
[2012-04-09 17:53:48 -0400] jperry: is there any way to enforce this?
[2012-04-09 17:54:06 -0400] btm: dambalah: log in to https://manage.opscode.com, click organizations in the uper right. You'll see 'generated knife config' next to your organization in the middle.
[2012-04-09 17:54:40 -0400] dambalah: btm: thanks. found it.
[2012-04-09 17:55:08 -0400] z: btm: someone is really gonna throw you on the OHC vs OSCS response the other day. they'll respond OPC and you'll drop a nasty stack all over the room, or something ;)
[2012-04-09 17:56:19 -0400] z: jtimberman: chip-: Nice bit of PR going on there.
[2012-04-09 17:56:22 -0400] jperry: @btm - Is there a way to get to know tests fail other than viewing the output for the minitest-handler-cookbook?
[2012-04-09 17:57:13 -0400] btm: z: yeah; that most of our OPC customers are huge/still secretive for various reasons makes that question easier. Success makes you type more.
[2012-04-09 17:57:14 -0400] chip-: jtimberman: Just didn't have me connected with that?
[2012-04-09 17:57:19 -0400] jtimberman: chip-: Indeed.
[2012-04-09 17:57:19 -0400] geekbri: For some reason, in one particular chef environment I have, knife search never returns any results.
[2012-04-09 17:57:27 -0400] btm: jperry: not off the top of my head.
[2012-04-09 17:57:28 -0400] jtimberman: chip-: I forgot who in here works where all the time.
[2012-04-09 17:57:42 -0400] hoover_damm: jtimberman, op them?
[2012-04-09 17:58:02 -0400] hoover_damm: jtimberman, I realize ops is such a silly thing, but that's generally the easiest way to know who is official and who is not
[2012-04-09 17:58:06 -0400] jtoft: geekbri: I know it may sound silly, but what version of rabbitmq are you running?
[2012-04-09 17:58:13 -0400] z: btm: "This ain't Vegas, gambler, although I will concede that thems are /reeee-markably/ good odds"
[2012-04-09 17:58:17 -0400] geekbri: jtoft: im using hosted chef.
[2012-04-09 17:58:18 -0400] chip-: jtimberman: That's a good sign of an expanding community. :)
[2012-04-09 17:58:30 -0400] jtoft: geekbri: ah well never mind then :P
[2012-04-09 17:58:37 -0400] jtimberman: :D
[2012-04-09 17:59:05 -0400] jtimberman: geekbri: whats your query?
[2012-04-09 17:59:13 -0400] z: Did ya'll over in the US get either Friday or Monday off?  Was a 4-day weekend for us colonials in the UK :-)
[2012-04-09 17:59:28 -0400] geekbri: jtimberman: knife search node "role:hadoop_namenode"
[2012-04-09 17:59:47 -0400] btm: my dog killed a wild rabbit for easter. that was about all the holiday I got.
[2012-04-09 17:59:49 -0400] jtimberman: geekbri: and its just not returning results of nodes in a particular enviornment?
[2012-04-09 18:00:09 -0400] z: btm: Skin it. Boil it. Save a few bucks on dog food for a couple days?
[2012-04-09 18:00:10 -0400] jtoft: When running chef-solo, how can you force a different file_cache_path? my solo.rb has file_cache_path "/Users/jtoft/example/cache" and it is definitely writeable, however it's still throwing errors with ACCES: Permission Denied - /var/chef
[2012-04-09 18:00:12 -0400] geekbri: jtimberman: yup, it returns results, but it leaves out a node I have in my "test" environment which has the role[hadoop_namenode] in its run list
[2012-04-09 18:00:24 -0400] jtimberman: geekbri: O.o!
[2012-04-09 18:00:34 -0400] jtimberman: geekbri: can you open a ticket at help.opscode.com?
[2012-04-09 18:00:37 -0400] jtimberman: (or email support@opscode.com)
[2012-04-09 18:00:43 -0400] jtoft: Am I perhaps using the wrong configuration variable?
[2012-04-09 18:00:57 -0400] btm: z: All I got out of it was the meatless remains of the hindquarters.
[2012-04-09 18:01:00 -0400] jtimberman: jtoft: there's a couple.
[2012-04-09 18:01:21 -0400] geekbri: jtimberman: will do.  Maybe i setup the environment wrong.... although that its pretty simple
[2012-04-09 18:01:34 -0400] jtimberman: jtoft: you'll want to configure checksum_path and file_backup_path too
[2012-04-09 18:01:45 -0400] jtoft: jtimberman: cool, I'll set that up now then. Appreciate it.
[2012-04-09 18:01:46 -0400] z: btm: Damn. Not sure my pooch would just eat it raw. It'd be "accidental death" through playing with her food, and she'd leave me to slice/dice for her I guess.
[2012-04-09 18:10:38 -0400] geekbri: jtimberman: I discovered the issue.  It seems the search command does not search recursively.  If you had a role included in the run list inside of a role file, it does not search that
[2012-04-09 18:11:36 -0400] hoover_damm: geekbri, the search page has a darn good lineup on how to search
[2012-04-09 18:11:48 -0400] hoover_damm: geekbri, inside the expanded runlist for example
[2012-04-09 18:12:10 -0400] geekbri: hoover_damm: im there now, i shall digest whats here :)
[2012-04-09 18:14:28 -0400] jtoft: jtimberman: was looking at what you had put together for chef-solo, I ended up doing something more akin to brew/rvm http://joshtoft.com/kindness/
[2012-04-09 18:15:01 -0400] motiejus: hi all. I can't figure out what first parameter of :notifies does
[2012-04-09 18:16:11 -0400] motiejus: and what are the consequences of :action in the block itself which is notified
[2012-04-09 18:16:38 -0400] motiejus: I found only examples in the documentation, no reference
[2012-04-09 18:17:17 -0400] jtoft: motiejus: it goes like the following: notifies #{action}, #{reference}, #{:delayed, :immediately}
[2012-04-09 18:17:48 -0400] jtoft: action is what it would be passing to the LWRP // Resource Provider
[2012-04-09 18:18:42 -0400] motiejus: mhm reading reading
[2012-04-09 18:19:19 -0400] motiejus: goal! jtoft: thanks. this is what I was looking for: specifies that the list of allowed actions for this resource should  include foo and bar and ultimately corresponds to the implementing  Provider's "action_foo" and "action_bar" methods.
[2012-04-09 18:20:40 -0400] eugenmayer1: in which order are the recipes applied. ascending or descending?
[2012-04-09 18:21:25 -0400] motiejus: jtoft: so if I make a LWRP like this: execute "my action" do ... end, it doesn't really matter which #{action} I pass when I notify "my action"?
[2012-04-09 18:21:57 -0400] motiejus: eugenmayer: IIRC top to bottom (so probably you mean ascending)
[2012-04-09 18:21:58 -0400] spyvsspy: hi, I when I click status on the webui, it hangs
[2012-04-09 18:22:07 -0400] eugenmayer1: motiejus: thanks. Yes
[2012-04-09 18:22:13 -0400] spyvsspy: I cna use knife to view the status though, and hwne I run chef-expander, I get an error: RROR: Detected extra consumers (2 total) on queue vnode-1021
[2012-04-09 18:22:25 -0400] spyvsspy: I am having little luck with the googles
[2012-04-09 18:28:08 -0400] btm: spyvsspy: why are you running chef-expander? It should run as a daemon in the background. Is it?
[2012-04-09 18:33:24 -0400] motiejus: command in chef recipe: command "passwd -d #{u['id']}". How do I escape it from commas, semicolons and other non-ascii chars easily?
[2012-04-09 18:33:44 -0400] geekbri: I dont know if anybody has tried to use the redis cookbooks out there, but i recently added one to the community that I think is a bit better than the ones that were there before.
[2012-04-09 18:33:48 -0400] motiejus: I could write ruby s/[^W]//g, but is there a better way to do it?
[2012-04-09 18:34:28 -0400] jperry: @btm - are the minitest results recorded anywhere other than stdout?
[2012-04-09 18:34:39 -0400] jperry: this way I can parse the output for failures
[2012-04-09 18:39:58 -0400] miah: jperry: minitest-handler
[2012-04-09 18:40:32 -0400] eugenmayer1: guys, how you keep track of variables you need to set for a node? This seems completyl strange to me
[2012-04-09 18:40:34 -0400] jperry: @miah - I am trying to get those results after a chef run
[2012-04-09 18:40:54 -0400] jperry: @miah - what would be the best way
[2012-04-09 18:40:58 -0400] miah: use other chef handlers to notify on error
[2012-04-09 18:41:08 -0400] eugenmayer1: lets say i add a new node, add it to a group. Now i need to look into every single reciepe and check what attrbutes needs to be set? That sounds like an horror to me
[2012-04-09 18:41:31 -0400] spyvsspy: btm, I just ran a restart of chef-expander, per a google post
[2012-04-09 18:41:35 -0400] spyvsspy: to see what was going on
[2012-04-09 18:41:35 -0400] chip-: eugenmayer1: You're thinking too granular.
[2012-04-09 18:41:42 -0400] chip-: eugenmayer1: Set your attributes at the role or at the environment.
[2012-04-09 18:41:58 -0400] eugenmayer1: chip-: but the node needs to override them
[2012-04-09 18:42:13 -0400] jperry: @miah - so if I am using the minitest-chef-handler cookbook that is a report handler, if I write another report handler that reports on failure of minitest-handler I can have it error out?
[2012-04-09 18:42:20 -0400] eugenmayer1: chip-: always. Did not make sense to set them in the role then, does int?
[2012-04-09 18:42:30 -0400] miah: there are already other handlers that do things like notify to campfire or nagios
[2012-04-09 18:42:33 -0400] miah: just use them
[2012-04-09 18:42:37 -0400] afallows: eugenmayer1: What is it that you're doing which requires each role to have a unique/overridden value?
[2012-04-09 18:42:44 -0400] miah: or, just use minitest-handler on your test environment
[2012-04-09 18:42:55 -0400] chip-: eugenmayer1: Then make a new role. Don't build beautiful, unique snowflakes.
[2012-04-09 18:43:02 -0400] miah: if your testing in vagrant, you're likely to catch the errors anyways.
[2012-04-09 18:43:16 -0400] eugenmayer1: chip-: a role for what? Every node? Are you kidding?
[2012-04-09 18:43:52 -0400] eugenmayer1: afallows: every node needs to provide an app-identifier, a user/password for the VPN connection ( actually for 2), a fqdn
[2012-04-09 18:43:58 -0400] jperry: @miah - yes I am using vagrant but vagrant doesn't return with a non-zero if the tests fail
[2012-04-09 18:43:59 -0400] chip-: eugenmayer1: You're being quite vague about your use case, so it's very hard to say, but per-node attributes can be generated to be unique per-host by roles (such as generated passwords)
[2012-04-09 18:44:06 -0400] miah: oh
[2012-04-09 18:44:26 -0400] afallows: eugenmayer1: You can probably write a recipe that sets these attributes when chef-client runs on the nodes.
[2012-04-09 18:44:36 -0400] chip-: eugenmayer1: So a recipe can programmatically generate per-node metadata and save it back to the node. Check out how the mysql cookbook handles passwords for a good example.
[2012-04-09 18:44:41 -0400] eugenmayer1: chip-: yes, i know. Yet the vpn-servers are not attached to chef, so i cant generate the password automatically this way
[2012-04-09 18:44:49 -0400] chip-: er, metadata's the wrong word. Attributes.
[2012-04-09 18:44:58 -0400] afallows: Some of those may already get set by ohai. For example, fqdn is probably already set.
[2012-04-09 18:45:18 -0400] eugenmayer1: chip-: using this already, so e.g. set_unless[] = secure_password ( for bacula-fd )
[2012-04-09 18:45:18 -0400] chip-: Yeah, if hostname -f doesn't resolve, Chef won't even run.
[2012-04-09 18:46:53 -0400] eugenmayer1: lets rephrase. Is there any mechanism in reciepes to expose "needs to be set" attributes to a node / role whatever
[2012-04-09 18:47:00 -0400] eugenmayer1: which will the show up in the json-editor
[2012-04-09 18:47:11 -0400] tortoise_: Is there a way to specify mailto to mailto="" so that emails aren't delivered? everytime i leave it blank, it will autofill with my default email if i try and put mailto as empty
[2012-04-09 18:48:08 -0400] chip-: eugenmayer1: http://wiki.opscode.com/display/chef/Attributes#Attributes-NodeAttributes
[2012-04-09 18:49:29 -0400] eugenmayer1: chip-: still, that needs me to exactly know how this json file will look like, or other words, what settings in what namespaces
[2012-04-09 18:51:20 -0400] chip-: eugenmayer1: As opposed to?
[2012-04-09 18:52:11 -0400] eugenmayer1: chip-: reciepes defining attributes which need to be set. This attributes then are shown in the json editor
[2012-04-09 18:52:31 -0400] afallows: eugenmayer1: The important thing about node-level attributes is that you can set them programmatically instead of hard-coding them. You can write a recipe that pulls information from the machine and saves it as chef attributes.
[2012-04-09 18:52:54 -0400] chip-: What afallows said.
[2012-04-09 18:52:54 -0400] aslan: hi guys... I am having a problem with chef-server ... Its the second time in a row that my solr server is crashing. This is braking chef runs and consequently the auto scaling process. basically a site failure in general.  The heap size on solr is 512 and after i restart the chef-colr and kill the merb processes everything starts to work fine. This server is handling about 60 servers but sometimes it goes up to 100. Is the solution to go with a higher memory alloc
[2012-04-09 18:52:54 -0400] aslan: for solr or there is something else i can do to prevent this?
[2012-04-09 18:52:58 -0400] eugenmayer1: afallows: i undestand, did that. e.g. with ohai or with hostname
[2012-04-09 18:53:10 -0400] |shad0w|: I don't like doing that with node level attribs. If it is programattic why isn't it being set as a default
[2012-04-09 18:53:20 -0400] |shad0w|: once you set a node level attrib it is there until you delete it
[2012-04-09 18:53:24 -0400] eugenmayer1: afallows: but not all those attributes can be auto-generated. E.g. if i initialy deploy something.
[2012-04-09 18:56:53 -0400] afallows: eugenmayer1: I suppose I am still unclear on your specific case. There's a wealth of information about the machine that you can collect through Chef, especially since you can embed 'regular' Ruby code in a recipe.
[2012-04-09 18:57:30 -0400] eugenmayer1: afallows: simple: You cannot get infos from the machine you are about to deploy..
[2012-04-09 18:58:24 -0400] afallows: That's true. But once you've deployed it, you can have it relay information about itself back to the server.
[2012-04-09 18:59:40 -0400] eugenmayer1: yes, but in this case, i first deploy, have default values, go back to the node, change them to real values, done. Thats sounds stupid to me
[2012-04-09 19:00:25 -0400] eugenmayer1: (and redeploy)
[2012-04-09 19:00:43 -0400] chip-: eugenmayer1: Put them in a first-run.json file in ~/chef and read them in at bootstrap, then.
[2012-04-09 19:00:51 -0400] chip-: er sorry, ~chef
[2012-04-09 19:01:29 -0400] eugenmayer1: chip-: and i can only repeat: This needs me to know what should be in this json file.
[2012-04-09 19:04:56 -0400] eugenmayer1: i guess, this will outline the flaw:what iam doing now is, basicall yusing set_unless on anything int the reciepies which needs to be set and of course, auto-generate passwords and all things i can really get.
[2012-04-09 19:05:07 -0400] eugenmayer1: Then i deploy this to the machine, then i go back and edit the node
[2012-04-09 19:05:25 -0400] eugenmayer1: now the json array is exposed, i edit all the wrong values, save and redeploy
[2012-04-09 19:05:46 -0400] eugenmayer1: (this makes little sense to me)
[2012-04-09 19:06:20 -0400] chip-: As opposed to which workflow? The one where Chef just knows what your values should be before you do?
[2012-04-09 19:06:39 -0400] chip-: That's what we're not understanding.
[2012-04-09 19:06:39 -0400] holoway: eugenmayer1: I don't understand - if you don't know how to compute the value in your head, how can you write a chef recipe to fix it?
[2012-04-09 19:11:32 -0400] eugenmayer1: AFAICs there is no way to pass an additional argument for service like .e.g needed for openvpn
[2012-04-09 19:11:44 -0400] eugenmayer1:  /etc/init.d/openvpn start <name>
[2012-04-09 19:11:56 -0400] aslan: hi guys... I am having a problem with chef-server ... Its the second time in a row that my solr server is crashing. This is braking chef runs and consequently the auto scaling process. basically a site failure in general.  The heap size on solr is 512 and after i restart the chef-colr and kill the merb processes everything starts to work fine. This server is handling about 60 servers but sometimes it goes up to 100. Is the solution to go with a higher memory alloc
[2012-04-09 19:11:56 -0400] aslan: for solr or there is something else i can do to prevent this?
[2012-04-09 19:12:19 -0400] holoway: aslan: it depends on how much you are using search
[2012-04-09 19:12:48 -0400] aslan: holoway: manually searching or in the recipe search?
[2012-04-09 19:13:07 -0400] holoway: aslan: in recipes
[2012-04-09 19:13:09 -0400] aslan: holoway: because this happened in the middle of night
[2012-04-09 19:13:29 -0400] holoway: 512 feels reasonable, but it all depends
[2012-04-09 19:13:47 -0400] aslan: holoway: i do get a lot of data from my data bags ... could that be it?
[2012-04-09 19:14:04 -0400] holoway: aslan: if you are searching for the data bag items, sure
[2012-04-09 19:14:12 -0400] holoway: aslan: you can also just load them directly if you know the key
[2012-04-09 19:14:20 -0400] holoway: (which is a better way)
[2012-04-09 19:14:35 -0400] holoway: aslan: what is in the solr logs?
[2012-04-09 19:15:22 -0400] aslan: holoway: i have a lot of svmaster = data_bag_item('svnetwork-db','master')
[2012-04-09 19:15:25 -0400] eugenmayer1: holoway: are you using openjdk?
[2012-04-09 19:15:40 -0400] eugenmayer1: err, aslan ^^
[2012-04-09 19:15:52 -0400] holoway: aslan: cool - that's fine, and not using search under the hood
[2012-04-09 19:16:07 -0400] aslan: holoway: in that case no i can't say i am doing a lot of search
[2012-04-09 19:16:12 -0400] holoway: aslan: what is the error message you are seeing in solr?
[2012-04-09 19:16:27 -0400] aslan: holoway: 2012-04-09_17:01:23.71588 Exception in thread "Lucene Merge Thread #0" org.apache.lucene.index.MergePolicy$MergeException: java.lang.OutOfMemoryError: GC overhead limit exceeded
[2012-04-09 19:16:27 -0400] aslan: 2012-04-09_17:01:23.71639       at org.apache.lucene.index.ConcurrentMergeScheduler.handleMergeException(ConcurrentMergeScheduler.java:351)
[2012-04-09 19:16:27 -0400] aslan: 2012-04-09_17:01:23.71646       at org.apache.lucene.index.ConcurrentMergeScheduler$MergeThread.run(ConcurrentMergeScheduler.java:315)
[2012-04-09 19:16:28 -0400] aslan: 2012-04-09_17:01:23.71653 Caused by: java.lang.OutOfMemoryError: GC overhead limit exceeded
[2012-04-09 19:16:38 -0400] holoway: gotcha
[2012-04-09 19:16:43 -0400] holoway: yeah, you just need more space
[2012-04-09 19:16:59 -0400] aslan: holoway: i actually went to my indexer first
[2012-04-09 19:17:02 -0400] holoway: more -Xmx/-Xms
[2012-04-09 19:17:06 -0400] aslan: i notice a lot of time outs
[2012-04-09 19:17:11 -0400] eugenmayer1: aslan: if you are using openJDK, swtich to oracle.
[2012-04-09 19:17:12 -0400] aslan: and finally it just failed
[2012-04-09 19:17:37 -0400] aslan: eugenmayer1: what is the reason for that?
[2012-04-09 19:18:12 -0400] holoway: aslan: you'll find out that it's not linear
[2012-04-09 19:18:13 -0400] eugenmayer1: aslan: solr will do exactly that, it will freak out, OOM and do a lot of other things under openJDK. Why? I dont know.
[2012-04-09 19:18:49 -0400] holoway: aslan: but that merge thread will consume more ram than most other operations, iirc
[2012-04-09 19:18:50 -0400] aslan: holoway: what is the next size for java heap?
[2012-04-09 19:19:01 -0400] holoway: aslan: how much ram do you have available? :)
[2012-04-09 19:19:07 -0400] aslan: 7+ G
[2012-04-09 19:19:14 -0400] holoway: aslan: kick it up to 1G
[2012-04-09 19:19:22 -0400] aslan: ok
[2012-04-09 19:19:36 -0400] aslan: holoway: i was wondering if there is an issue with GC
[2012-04-09 19:19:42 -0400] aslan: because after the restart everything is fine
[2012-04-09 19:20:05 -0400] holoway: aslan: well, solr has things it only does periodically
[2012-04-09 19:20:08 -0400] holoway: aslan: like optimize the i ndex
[2012-04-09 19:20:23 -0400] holoway: aslan: so it may be fine for a while, and then not fine later, when it finally gets around to those tasks
[2012-04-09 19:20:42 -0400] |shad0w|: eugenmayer, re service args. You'd have to write your own provider or monkey patch the service resource
[2012-04-09 19:20:56 -0400] eugenmayer1: Did so already. Thanks
[2012-04-09 19:20:58 -0400] aslan: holoway: ok... by the way i am using chef 0.9 is there any built in improvements in 0.10?
[2012-04-09 19:21:34 -0400] miah: i feel like staying on 0.9 is like choosing to use subversion
[2012-04-09 19:21:38 -0400] holoway: yeah, a few - newer solr, totally different indexer
[2012-04-09 19:21:50 -0400] holoway: lots of other improvements
[2012-04-09 19:22:04 -0400] holoway: aslan: but it probably won't just fix it like a magic pill
[2012-04-09 19:22:23 -0400] aslan: holoway: ok chef upgrade is on my road map. thanks for the help
[2012-04-09 19:22:38 -0400] holoway: aslan: my pleasure - sorry for your troubles
[2012-04-09 19:23:10 -0400] holoway: ls
[2012-04-09 19:24:46 -0400] afallows: miah: And not using chef is like using RCS.
[2012-04-09 19:26:31 -0400] geekbri: if the chef run failing a sign that you failed to set an important attribute you were supposed to :)
[2012-04-09 19:26:45 -0400] geekbri: thats what readmes are for.
[2012-04-09 19:27:16 -0400] eugenmayer1: geekbri: was that for me?
[2012-04-09 19:27:43 -0400] geekbri: possibly.  I had my buffer scrolled up and didnt realize it, so I was replying to some pretty old conversation :)
[2012-04-09 19:29:42 -0400] geekbri: eugenmayer1: I have a cookbook I wrote for code deployment that requires the version you need to deploy, but it doesn't have a default because it doesnt' really make sense for it to have some arbitrary version of the code it deploys.
[2012-04-09 19:30:26 -0400] geekbri: eugenmayer1: I put the attribute in the attribute defaults.rb but I set it equal to nil.  Readme instructs how to use the cookbook and required attributes in your role file.  If somebody here tries to use it with out that attribute it just throws a chef log entry and blows up
[2012-04-09 19:31:03 -0400] eugenmayer1: geekbri: sorry, thats not a workflow. Thats plain hell.
[2012-04-09 19:31:12 -0400] geekbri: how is that not a workflow?
[2012-04-09 19:31:35 -0400] geekbri: we have a role file for each set of servers, QA, production, staging, and each one defines in their role files which version of the code they should be running
[2012-04-09 19:31:44 -0400] eugenmayer1: Lets dont start the discussion once again. I will have to pick up some more exp. with chef and see, what ways to fiddle arround
[2012-04-09 19:32:22 -0400] eugenmayer1: and if that writing a small tiny clever json-ng editor which is able to load defaults or at least autocomplete possible values /trees
[2012-04-09 19:33:14 -0400] terryjfundak: This is a slightly off topic comment. The iPhone app IRC "Mobile Colloquy" does not work on the Sprint network but does on WiFi. The iPhone IRC app "Mango Lite" does work. Been troubleshooting this too many hours to keep it to myself. Hope some other chefs will benefit knowing this.
[2012-04-09 19:33:46 -0400] terry_j_fundak: mango lite seems to work
[2012-04-09 19:35:31 -0400] geekbri: I just use limechat ;X
[2012-04-09 19:36:01 -0400] Iugin: Hi.. I'm on Shef, how to describe an object? for example.. I have "nodes.list {|n| puts "#{n.name}:"..  How to know all proprieties and method of "n" ?
[2012-04-09 19:37:01 -0400] terryjfundak: geekbri: Thanx for the recommendation...
[2012-04-09 19:37:24 -0400] geekbri: terryjfundak: its not free though.  I use it both on my mac and ipad.  I enjoy it.  Its free for mac just not for ios
[2012-04-09 19:38:28 -0400] terryjfundak: geekbri: $5 is not going to kill anyone..but bad tech support and wasting time might..
[2012-04-09 19:38:37 -0400] geekbri: i agree
[2012-04-09 19:39:19 -0400] afallows: terryjfundak: If someone does get killed, I hope it's the bad tech support.
[2012-04-09 19:56:17 -0400] terryjfundak: afallows: Since we are an agile community, I do hope it is not just the bad tech support ( agent - singular ) but the full team or the full company..;-)
[2012-04-09 19:58:52 -0400] terryjfundak: afallows: Though I guess that is projecting agile onto a perhaps unwilling partner ( for there own good ).
[2012-04-09 20:00:30 -0400] terryjfundak: geelbri: You on an iPhone on Sprint and can confirm it works withOUT WiFi, right?
[2012-04-09 20:01:03 -0400] geekbri: terryjfundak: ergh, verizon not sprint, sorry.
[2012-04-09 20:01:33 -0400] miah: phone irc always felt awkward to me
[2012-04-09 20:01:54 -0400] terryjfundak: geekbrit: thanx
[2012-04-09 20:04:01 -0400] terryjfundak: miah: True - just checking out the connection possibilities in my "new" community of chefs . sometimes I need to use the handy "phone" for a quick checkin.
[2012-04-09 20:05:37 -0400] motiejus_: how do I correctly hold state in a cookbook? For example, I have a create user block, which creates user, and I want to execute some code if the user doesn't exist beforehand
[2012-04-09 20:06:27 -0400] motiejus_: http://pastebin.ubuntu.com/922390/ this is what I am doing now (19 lines of code)
[2012-04-09 20:07:00 -0400] motiejus_: but it seems like command "passwd -d #{u['id']}" is not executed, no matter the new_user variable
[2012-04-09 20:10:52 -0400] terryjfundak: how do you pronounce Ohai?
[2012-04-09 20:11:48 -0400] afallows: I assume it's like the english phrase "Oh, hi."
[2012-04-09 20:11:50 -0400] crucially: oooooooo hi
[2012-04-09 20:11:54 -0400] Brad_K: Ohai == Oh, hi
[2012-04-09 20:12:20 -0400] Brad_K: terryjfundak: you called it a "handy".  are you german, or in germany?
[2012-04-09 20:13:11 -0400] hcastro: motiejus_: your code outside of the execute and user blocks is getting evaluated at a different stage of the chef run
[2012-04-09 20:13:50 -0400] motiejus_: Yes, I am aware of it (compile time vs run time) ... but how do I assign it to a variable on compile time that remains at run time?
[2012-04-09 20:13:56 -0400] motiejus_: or, alternatively, run that conditional at runtime
[2012-04-09 20:14:17 -0400] terryjfundak: Brad_K: Same as the city Ojai - http://en.wikipedia.org/wiki/Ojai,_California
[2012-04-09 20:14:39 -0400] hcastro: motiejus_: try putting it in one of these: http://wiki.opscode.com/display/chef/Resources#Resources-RubyBlock
[2012-04-09 20:15:17 -0400] Brad_K: terryjfundak: http://www.youtube.com/watch?v=8WIscxut_ak
[2012-04-09 20:15:29 -0400] hcastro: motiejus_: oh wait, put your code within the only_if { }
[2012-04-09 20:15:30 -0400] terryjfundak: Brad_K: Not german - though I do say some
[2012-04-09 20:15:54 -0400] motiejus_: hcastro: it woun't work, because I need to run the conditional _before_ the user is created
[2012-04-09 20:15:59 -0400] terryjfundak: ;-) funny.
[2012-04-09 20:16:22 -0400] motiejus_: same problem with ruby_block. I could do that, but where do I assign the conditional variable?
[2012-04-09 20:16:39 -0400] motiejus_: hcastro: is there a global instance where I could bind the variable?
[2012-04-09 20:16:43 -0400] Brad_K: motiejus_: if grep user in $password do  end
[2012-04-09 20:18:00 -0400] motiejus_: Brad_K: you are suggesting a stateless solution. The actions are: 1) I check if the user doesn't exist 2) create user 3) if the user didn't exist, run the command
[2012-04-09 20:18:03 -0400] Brad_K: sorry, in your case it would probably be something like "not_if grep $user in /etc/passwd"
[2012-04-09 20:18:30 -0400] motiejus_: Brad_K or am I missing something?
[2012-04-09 20:18:33 -0400] Brad_K: chef is supposed to be idempotent.  doing the action stateless is a good step towards idempotency.
[2012-04-09 20:18:56 -0400] motiejus_: Brad_K: but you know, I wouldn't like to remove user's password if he already exists
[2012-04-09 20:19:41 -0400] Brad_K: the code in the block won't run if the "not_if" guard is true.
[2012-04-09 20:19:42 -0400] motiejus_: I agree with you, but just don't know how to get around it. I would gladly make everything stateless
[2012-04-09 20:20:35 -0400] geekbri: motiejus_: Im not really following the conversation but it seems like youre trying to store stuff in node.run_state maybe?
[2012-04-09 20:20:45 -0400] geekbri: That is probably not how I'd do what I think youre trying to accomplish though.
[2012-04-09 20:21:11 -0400] motiejus_: geekbri: I suppose you are right, but I would really love to hear another way to do it
[2012-04-09 20:21:19 -0400] afallows: motiejus_: Looking at your paste, might you be able to just move the `grep ...`.empty? into the only_if clause?
[2012-04-09 20:21:20 -0400] yfeldblum: motiejus_, why do you need to run code only if the user didn't exist before?
[2012-04-09 20:21:46 -0400] motiejus_: yfeldblum: that's right.
[2012-04-09 20:21:48 -0400] yfeldblum: motiejus_, because that way lies lots of problems (what happens if the run was interrupted after the user was created but before your post-create-the-user code ran?)
[2012-04-09 20:21:59 -0400] Brad_K: motiejus_: https://gist.github.com/4dbda038ce4c48520cca
[2012-04-09 20:22:02 -0400] motiejus_: afallows: I can't, because the conditional will be evaluated after the user is created
[2012-04-09 20:22:25 -0400] Brad_K: that's an example of a not_if guard preventing the code from executing if the software is already installed.
[2012-04-09 20:23:08 -0400] afallows: Backtick commands in chef recipes are evaluated at compile time.
[2012-04-09 20:23:20 -0400] afallows: I found that out the hard way.
[2012-04-09 20:24:19 -0400] motiejus_: yfeldblum:  you are right, there are race conditions.. I will try to find a way to check if user password is disabled
[2012-04-09 20:24:40 -0400] motiejus_: Brad_K: thanks for the example, but it doesn't fit, because of the reason mentioned above
[2012-04-09 20:24:49 -0400] motiejus_: (so there will be no state)
[2012-04-09 20:25:25 -0400] yfeldblum: motiejus_, right so what do you actually want to do? specify that, always, the user's password shall be disabled?
[2012-04-09 20:25:45 -0400] yfeldblum: motiejus_, or just disabled initially?
[2012-04-09 20:25:50 -0400] motiejus_: when creating a new account, disable the password
[2012-04-09 20:25:53 -0400] motiejus_: yfeldblum: initially
[2012-04-09 20:26:06 -0400] motiejus_: found it... passwd -S
[2012-04-09 20:26:06 -0400] motiejus_: :)
[2012-04-09 20:26:12 -0400] motiejus_: (query status of the password)
[2012-04-09 20:26:14 -0400] yfeldblum: motiejus_, why not always?
[2012-04-09 20:26:37 -0400] motiejus_: yfeldblum: because the user can log in and set his password
[2012-04-09 20:26:59 -0400] motiejus_: initial login is only using a private key
[2012-04-09 20:27:09 -0400] motiejus_: and user sets his password when he first logs in
[2012-04-09 20:28:26 -0400] motiejus_: I am implementing this thing now: http://serverfault.com/questions/350064/new-user-with-authorized-keys-how-to-not-ask-for-the-old-password-when-setting
[2012-04-09 20:30:05 -0400] chip-: Bootstrapping centos6: is stevendanna's bootstrap script still the best option?
[2012-04-09 20:30:27 -0400] motiejus_: I will use passwd -S to check if password is locked, and, if so, I will remove it
[2012-04-09 20:31:44 -0400] spyvsspy: man, my chef server has been acting screwy, at least the webui
[2012-04-09 20:32:02 -0400] spyvsspy: I can use knife etc to manage things, but hte web hangs forever, and sometimes doesnt work at all
[2012-04-09 20:32:09 -0400] spyvsspy: where should I begin to look
[2012-04-09 20:32:18 -0400] spyvsspy: this is out of nowhere, and nothing has been done to the server
[2012-04-09 20:32:28 -0400] afallows: spyvsspy: Is it the whole webui that hangs, or only certain functions?
[2012-04-09 20:32:41 -0400] spyvsspy: at frist it was only certain functions mainly status
[2012-04-09 20:32:46 -0400] spyvsspy: now it seems to be everything
[2012-04-09 20:33:07 -0400] afallows: spyvsspy: I had a similar issue and it turned out to be solr causing the problem. I would start there.
[2012-04-09 20:33:43 -0400] afallows: In my particular case, Java had not installed properly, so solr wasn't running, search and status didn't work at all.
[2012-04-09 20:35:58 -0400] spyvsspy: seems to be running
[2012-04-09 20:35:58 -0400] spyvsspy: https://gist.github.com/2346417
[2012-04-09 20:36:12 -0400] spyvsspy: and it has been functioning correctly for about a month
[2012-04-09 20:37:10 -0400] afallows: Then perhaps that's not the root of your issue. You could try restarting it and see if any of the symptoms change, but other than that I'm out of suggestions. :)
[2012-04-09 20:37:30 -0400] spyvsspy: ya, Ive rebooted the server a couple times
[2012-04-09 20:38:46 -0400] afallows: I assume you've also checked server stats to see whether the issues are reflected in CPU/memory usage?
[2012-04-09 20:39:00 -0400] spyvsspy: ya, everything looks good
[2012-04-09 20:45:44 -0400] newb: how do I setup a role such that using that it will cause the chef-clients to use '-l debug' when they run on those nodes assigned that role?
[2012-04-09 20:55:02 -0400] jtgiri_: Can somebody please look at my code and tell me why the 'host_name' outputting empty ? http://pastebin.com/SS0AQWNu
[2012-04-09 20:56:49 -0400] yfeldblum: jtgiri_, on the first run or on subsequent runs (specifically, after a prior run has succeeded)?
[2012-04-09 20:57:20 -0400] jtgiri_: first run and subsequent runs
[2012-04-09 20:59:18 -0400] AntonZ: hey guys, has anyone used/tested oracle cookbook from opscode site ?
[2012-04-09 20:59:28 -0400] yfeldblum: jtgiri_, for all nodes or only for the current node (the node retrieved from the search that is supposed to represent the node that the chef-client is being run on)?
[2012-04-09 21:02:01 -0400] jtgiri_: this is on nagios::server node, it should generate hosts.cfg with the IP address for all the hosts, Ip address works, just node name doesn't display for some reason
[2012-04-09 21:08:23 -0400] AntonZ: really quiet here today
[2012-04-09 21:08:59 -0400] newb: AntonZ, jdk?
[2012-04-09 21:09:37 -0400] AntonZ: i just downloaded the cookbook, didnt run it, but google shows people had issues
[2012-04-09 21:09:51 -0400] AntonZ: so i wanted to be preapred before i launch it :)
[2012-04-09 21:09:54 -0400] newb: running infochimps flume cookbook to setup a master and getting:
[2012-04-09 21:10:09 -0400] newb: "DEBUG: Sending HTTP Request via GET to 192.168.33.10:4000/search/node INFO: HTTP Request Returned 400 Bad Request: invalid search query: 'announces:-flume-master' Parse error at offset: 9 Reason: Expected one of AND, OR, NOT, ?, \, ", (, [, { at line 1, column 11 (byte 11) after : WARN: No node announced for '-flume-master' "
[2012-04-09 21:10:34 -0400] newb: AntonZ, are you asking about the oracle jdk?
[2012-04-09 21:12:43 -0400] AntonZ: oh no, oracle cookbook that installs prerequasites for oracle DB server
[2012-04-09 21:19:01 -0400] newb: @laurent: would you have any insights into this
[2012-04-09 21:19:01 -0400] newb: "DEBUG: Sending HTTP Request via GET to 192.168.33.10:4000/search/node INFO: HTTP Request Returned 400 Bad Request: invalid search query: 'announces:-flume-master' Parse error at offset: 9 Reason: Expected one of AND, OR, NOT, ?, \, ", (, [, { at line 1, column 11 (byte 11) after : WARN: No node announced for '-flume-master' "
[2012-04-09 21:31:26 -0400] tortoise_: Is there a runListItem.match equivilant for evaluating Roles?
[2012-04-09 22:09:35 -0400] eherot: Does anyone know if there is an easy way to get a key=>value array of a single property from ALL of the nodes within your chef installation from within a chef recipe?
[2012-04-09 22:10:22 -0400] eherot: currently I am doing search("node", "*:*") and then iterating through that result to get only the data I need but as you can probably imagine it results in a huge amount of unnecessary data transfer.
[2012-04-09 22:11:58 -0400] jtoft: eherot: search("node", "#{key.sub_key.sub_key.sub_key}:#{value}")
[2012-04-09 22:12:15 -0400] |shad0w|: that still returns the entire node
[2012-04-09 22:12:27 -0400] eherot: |shad0w|: ue[
[2012-04-09 22:12:30 -0400] eherot: *I mean yep
[2012-04-09 22:13:14 -0400] eherot: I need all the keys but only one part of the node value
[2012-04-09 22:13:34 -0400] eherot: well, all the nodes, not all the keys, really
[2012-04-09 22:14:16 -0400] eherot: I can make a view that gives me this on CouchDB but afaik there's not really any way to get access to that from within Chef
[2012-04-09 22:14:32 -0400] |shad0w|: well, search is coming from solr
[2012-04-09 22:14:48 -0400] |shad0w|: you can limit results in solr but doing that via the search method in chef may not be possible
[2012-04-09 22:15:38 -0400] |shad0w|: in the server side of 0.9.x the limited the args passed in from search requests, might not be the same case in 0.10.x so you might be able to fiddle with what is being passed from client searches
[2012-04-09 22:16:21 -0400] eherot: from search/query.rb in 0.10.8:
[2012-04-09 22:16:21 -0400] eherot: response = @rest.get_rest("search/#{type}?q=#{escape(query)}&sort=#{escape(sort)}&start=#{escape(start)}&rows=#{escape(rows)}")
[2012-04-09 22:16:37 -0400] eherot: if there is a way I don't think it's through that, unless there are tricks you can do with solr here that I'm not aware of
[2012-04-09 22:16:52 -0400] |shad0w|: yeah, you could try to monkey patch it, but I'm not sure if the server side is still filtering args from the rest request
[2012-04-09 22:17:01 -0400] eherot: aye
[2012-04-09 22:17:25 -0400] eherot: maybe there's a better way to do what I'm trying to do: basically to build a global known_hosts file on each server with all of the other servers' host keys in it
[2012-04-09 22:18:00 -0400] eherot: thus avoiding having to "ok" the key every time someone connects from one server to another for the first time.
[2012-04-09 22:18:24 -0400] |shad0w|: http://wiki.apache.org/solr/CommonQueryParameters
[2012-04-09 22:18:31 -0400] |shad0w|: fl is what you want i think
[2012-04-09 22:18:43 -0400] eherot: |shad0w|: thx I'll take a look at that
[2012-04-09 22:18:59 -0400] eherot: if my monkey patch ends up working I'll be sure to submit a pull request ;-)
[2012-04-09 22:21:06 -0400] |shad0w|: well, last I looked at doing some foo with it calls to search from recipes wasn't parametized, so adding a field could have unexpected consequences
[2012-04-09 22:21:11 -0400] gchristensen: is the wiki down?
[2012-04-09 22:24:09 -0400] jtimberman: gchristensen: it just loaded for me, http://www.downforeveryoneorjustme.com/wiki.opscode.com says its down O.o
[2012-04-09 22:24:22 -0400] jtimberman: now it says its up
[2012-04-09 22:24:32 -0400] gchristensen: it just came back up for too. hiccup I suppose :)
[2012-04-09 22:26:47 -0400] subsume: this don't work
[2012-04-09 22:27:22 -0400] subsume: http://dpaste.com/729259/ <--
[2012-04-09 22:27:31 -0400] subsume: getting FileNotFound
[2012-04-09 22:27:59 -0400] subsume: I also tried cookbook_file
[2012-04-09 22:28:15 -0400] subsume: i get a lie message that says 'files' dir does not contain blah
[2012-04-09 22:28:36 -0400] subsume: i'm on windows
[2012-04-09 22:28:40 -0400] subsume: do i need to do something special there
[2012-04-09 22:28:47 -0400] miah: blah.txt needs to be in your templates directory of your cookbook
[2012-04-09 22:29:02 -0400] subsume: i tried that
[2012-04-09 22:29:10 -0400] subsume: cookbooks/default/templates/blah.txt
[2012-04-09 22:29:34 -0400] miah: templates/ has subdirectories under it. there is a templates/default to use on _all_ systems, but also others.
[2012-04-09 22:29:40 -0400] miah: templates?
[2012-04-09 22:29:40 -0400] bawt: templates is http://wiki.opscode.com/display/chef/Templates
[2012-04-09 22:30:06 -0400] miah: look at Template Location Specificity on that page
[2012-04-09 22:30:16 -0400] subsume: I only tried Templates after cookbook_file failed
[2012-04-09 22:30:27 -0400] subsume: I saw location specificity....
[2012-04-09 22:30:59 -0400] miah: template resource looks for files under templates directory. if you are trying to transfer a plain file then it should be in the files directory (again, under the correct sub-directory)
[2012-04-09 22:31:23 -0400] subsume: the sub-directory in thise case is default? the error message says nothing about default
[2012-04-09 22:32:15 -0400] miah: like i said, its based on platform. so that section that i mentioned before about Template Location Specificy -> go read that again
[2012-04-09 22:32:22 -0400] miah: it also applies to cookbooks
[2012-04-09 22:32:31 -0400] miah: er, cookbook_file
[2012-04-09 22:32:35 -0400] subsume: right
[2012-04-09 22:32:42 -0400] subsume: okay so putting it in files/default/blah.txt worked
[2012-04-09 22:33:02 -0400] subsume: error msg could have actually output the location it was attempting
[2012-04-09 22:33:04 -0400] miah: right. but you should next understand _why_
[2012-04-09 22:33:43 -0400] subsume: i think i got it now, needs to be in default if its for all systems otherwise a hostname is necc.
[2012-04-09 22:34:02 -0400] miah: not hostname
[2012-04-09 22:34:06 -0400] miah: platform name
[2012-04-09 22:34:22 -0400] subsume: ahh okay
[2012-04-09 22:34:24 -0400] miah: hostname is acceptable.. but not going to scale very well
[2012-04-09 22:34:58 -0400] subsume: cool
[2012-04-09 22:53:34 -0400] newb: what is the role of ':default' under an attribute in the metadata.rb of any cookbook? Is it possible to make Chef use those values automatically if that attribute is not overriden?
[2012-04-09 23:11:51 -0400] hippiehacker: newb: http://wiki.opscode.com/display/chef/Attributes
[2012-04-09 23:12:23 -0400] hippiehacker: specifically http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-04-09 23:13:40 -0400] newb: hippiehacker, I meant to ask is there a way to use metadata.rb directly? Or is a metadata.rb just to instruct a human, but not a machine, what sane defaults ould be like?
[2012-04-09 23:13:52 -0400] hippiehacker: Usually recipes have their attributes set in ./attributes/default.rb I'm not sure why there would be a :default in metadata.rb
[2012-04-09 23:15:23 -0400] hippiehacker: newb: huh, never seen that before
[2012-04-09 23:16:01 -0400] hippiehacker: newb: it must be something in the works, I haven't used or seen any attributes in metadata.rb yet
[2012-04-09 23:16:34 -0400] newb: thanks
[2012-04-09 23:17:37 -0400] newb: if I wanted to set 'node[:cluster_name] = "hai"', could I just type in {"cluster_name" : "hai"} into the role json?
[2012-04-09 23:18:37 -0400] hippiehacker: yes
[2012-04-09 23:26:48 -0400] hoover_damm: and baibai
[2012-04-09 23:26:49 -0400] hoover_damm: as well
[2012-04-09 23:28:33 -0400] yfeldblum: the attributes in metadata.rb are documentation only, and are not read by the chef-client when evaluating cookbooks
[2012-04-09 23:28:54 -0400] eugenmayer: hello. what is the difference ( in chef-client cookbook ) between chef-client:service and chef-client:cron?
[2012-04-09 23:38:59 -0400] paige: what a horrible day
[2012-04-09 23:39:08 -0400] paige: work was good though
[2012-04-09 23:39:37 -0400] paige: anyway
[2012-04-09 23:42:37 -0400] eugenmayer: jtimberman: i install chef-client:service  but the server_url does not get applied in /etc/chef/client.rb .. any ideas?
