[2012-04-24 00:08:09 -0400] mhalligan: is it possible to use chef without solr?
[2012-04-24 00:10:11 -0400] mhalligan: or at least is it possible to get something to give me an error when chef-client runs and fails to write anything to solr?
[2012-04-24 00:10:31 -0400] coderanger: mhalligan: Yes, with a small monkey patch in your config
[2012-04-24 00:10:32 -0400] mhalligan: my cookbooks all "apply" but all of the searches fail, no error is thrown, just nothing  is populated anymore
[2012-04-24 00:10:44 -0400] coderanger: though obviously search won't work
[2012-04-24 00:11:13 -0400] coderanger: mhalligan: Check if stuff is backed up in rabbitmq
[2012-04-24 00:12:44 -0400] coderanger: (rabbitmqctl report | less will give you most of the diag data)
[2012-04-24 00:13:13 -0400] miah: fun stuff if your rabbitmq node name changes
[2012-04-24 00:14:10 -0400] mhalligan: honestly I'd be happy to delete everything and start fresh
[2012-04-24 00:14:12 -0400] mhalligan: which is what I tried to do
[2012-04-24 00:14:23 -0400] coderanger: How did you do that?
[2012-04-24 00:15:00 -0400] coderanger: Chef-server will, indeed, error out if it is unable to write to rabbit when an object updates
[2012-04-24 00:15:11 -0400] coderanger: but there is nothing that watches the queue depth by default
[2012-04-24 00:15:17 -0400] mhalligan: dpkg --force-depends -P chef-solr && apt=get install -f
[2012-04-24 00:15:31 -0400] coderanger: That wouldn't remove any data files
[2012-04-24 00:15:40 -0400] mhalligan: there were no data files
[2012-04-24 00:15:42 -0400] mhalligan: they all randomly disappeared
[2012-04-24 00:16:07 -0400] coderanger: check that expander is processing correctly and run knife reindex
[2012-04-24 00:16:08 -0400] hoover_damn: hrm... now to add a random array of replicas
[2012-04-24 00:16:13 -0400] hoover_damn: seems silly but neat
[2012-04-24 00:16:44 -0400] mhalligan: how do I check to see if the expander is processing correctly?
[2012-04-24 00:16:53 -0400] mhalligan: knife reindex? you mean knife index rebuild or is there a different command?
[2012-04-24 00:17:59 -0400] coderanger: Thats the one
[2012-04-24 00:18:12 -0400] coderanger: as for expander, the way to check is first to see if rabbit backed up ^^
[2012-04-24 00:18:17 -0400] mhalligan: yeah I've run that it doesn't give me any errors but it also doesn't do anything
[2012-04-24 00:20:24 -0400] mhalligan: I don't know how to read the rabbitmq output
[2012-04-24 00:20:35 -0400] mhalligan: but it gives me a ton of crap
[2012-04-24 00:20:41 -0400] mhalligan: is there a way to force clear a queue from the commandline?
[2012-04-24 00:21:35 -0400] coderanger: That wouldn't answer your question as to if it is working
[2012-04-24 00:23:18 -0400] macros: Someday chef-client will start getting dev attention again and I won't have to couch my chef recommendations with "but.."
[2012-04-24 00:23:36 -0400] macros: Like the 3GB of mem it uses while geneating stack traces sometimes
[2012-04-24 00:23:43 -0400] mhalligan: is there a magic command that says "delete all data and start from scratch?
[2012-04-24 00:23:47 -0400] coderanger: macros: Quite a few chef client features have gone in lately, what are you looking at in lparticular
[2012-04-24 00:23:47 -0400] mhalligan: or should I just build a new server?
[2012-04-24 00:23:49 -0400] coderanger: mhalligan: No
[2012-04-24 00:23:49 -0400] macros: And the average 500MB runs due to using search
[2012-04-24 00:24:04 -0400] coderanger: mhalligan: You can go wipe the couch and solr DBs manually
[2012-04-24 00:24:07 -0400] macros: coderanger: Mostly looking for performance and memory work
[2012-04-24 00:24:13 -0400] hoover_damn: macros, 500meg? pishaw what are you loading buddy
[2012-04-24 00:24:20 -0400] hoover_damn: macros, not that i'm disbelieving you
[2012-04-24 00:24:47 -0400] macros: search "*:*" over a few hudred nodes will do it easily
[2012-04-24 00:24:49 -0400] coderanger: mhalligan: Have you confirmed expander is working?
[2012-04-24 00:24:56 -0400] mhalligan: coderanger: I have no idea how to do that so no
[2012-04-24 00:25:01 -0400] hoover_damn: macros, 25
[2012-04-24 00:25:04 -0400] coderanger: mhalligan: Unless you are sure of that, I'm not sure how wiping the data will help
[2012-04-24 00:25:11 -0400] mhalligan: I'm going to build a new server and load my cookbooks and see what happens
[2012-04-24 00:25:12 -0400] hoover_damn: macros, now you know why it's this bad right?
[2012-04-24 00:25:14 -0400] hoover_damn: macros, ;)
[2012-04-24 00:25:18 -0400] macros: I use a rule of thumb of 2MB per client node for each search result
[2012-04-24 00:25:19 -0400] hoover_damn: or should we move this to ##infra-talk?
[2012-04-24 00:25:28 -0400] macros: Becuase I can't say just give me this attribute
[2012-04-24 00:26:33 -0400] macros: I can't trust chef-client to be run automatically anymore
[2012-04-24 00:26:50 -0400] hoover_damn: stop using the nagios cookbook?
[2012-04-24 00:27:19 -0400] macros: Many many of our cookbooks use search
[2012-04-24 00:28:05 -0400] mhalligan: feeling like all of these problems have to do with ruby19
[2012-04-24 00:28:13 -0400] mhalligan: everything worked fine before i upgraded
[2012-04-24 00:28:18 -0400] mhalligan: I've been fighting problem after problem since
[2012-04-24 00:28:24 -0400] hoover_damn: macros, GC.start?
[2012-04-24 00:28:46 -0400] hoover_damn: macros, you arn't the first person I know that has complained about it... last person I knew did GC.start in cookbooks
[2012-04-24 00:28:52 -0400] hoover_damn: macros, that they knew to be bad
[2012-04-24 00:29:19 -0400] macros: The problem isn't GC, it is 2MB in memory node objects
[2012-04-24 00:30:03 -0400] hoover_damn: storing a lot of attributes
[2012-04-24 00:30:13 -0400] macros: 99% of are un-needed
[2012-04-24 00:30:16 -0400] hoover_damn: macros, off hand your on 1.9.3 or still old?
[2012-04-24 00:30:26 -0400] macros: 1.8.7 still
[2012-04-24 00:31:04 -0400] macros: Tried with the omnibus and it was bad, how you can serialize json and not be able to read able to read it in another version of ruby is baffling to me
[2012-04-24 00:31:07 -0400] Brad_K: macros: if most of that data is not needed, then there are ways to trim down what information you're actually storing for each node.
[2012-04-24 00:31:07 -0400] hoover_damn: unless your running REE
[2012-04-24 00:31:13 -0400] hoover_damn: I should prolly shutup
[2012-04-24 00:31:19 -0400] hoover_damn: because i'll only end up badmouthing the wrong person
[2012-04-24 00:31:20 -0400] macros: Brad_K: But I want all the data
[2012-04-24 00:31:24 -0400] macros: I want tons more
[2012-04-24 00:31:34 -0400] hoover_damn: basically if you use 1.8.7 and JSON... you should be using REE
[2012-04-24 00:31:39 -0400] macros: I've not been writing more ohai plugins because it sucks so bad already
[2012-04-24 00:31:46 -0400] hoover_damn: immensely insane otherwise trying to actually run
[2012-04-24 00:31:49 -0400] Brad_K: macros: you say that 99% is not needed.  why can't you trim that not needed part?
[2012-04-24 00:31:52 -0400] macros: knife search is wonderful
[2012-04-24 00:32:07 -0400] macros: Brad_K: Becuase I use it frequently in contexts outside of a chef run
[2012-04-24 00:32:24 -0400] macros: I've been asking for years for a way to specify a limited set of attributes in a query
[2012-04-24 00:32:44 -0400] coderanger: mhalligan: rabbitmqctl list_queues -q -p /chef | awk '{print $2}' | paste -sd+ - | bc
[2012-04-24 00:32:59 -0400] coderanger: mhalligan: Thats a simple script to check the depth on a given queue name
[2012-04-24 00:33:08 -0400] mhalligan: so it returns 6
[2012-04-24 00:33:09 -0400] Brad_K: macros: in what way is that information used outside of a chef run?  is there maybe a different way that information could be stored that wouldn't cause your chef-client runs to balloon memory-wise?
[2012-04-24 00:33:10 -0400] mhalligan: is that a lot?
[2012-04-24 00:33:14 -0400] coderanger: It should be 0
[2012-04-24 00:33:23 -0400] hoover_damn: macros, yeah -l is too much, -m isn't enough... -s is too short
[2012-04-24 00:33:29 -0400] mhalligan: ok how do I flush the queue?
[2012-04-24 00:33:32 -0400] coderanger: You don't
[2012-04-24 00:33:38 -0400] coderanger: You get expander working again
[2012-04-24 00:33:44 -0400] coderanger: Otherwise no data will ever get into solr
[2012-04-24 00:33:51 -0400] coderanger: Check the chef-expander log file
[2012-04-24 00:33:58 -0400] macros: Brad_K: Things like every sysctl value
[2012-04-24 00:34:01 -0400] coderanger: see if there is any reason it isn't processing
[2012-04-24 00:34:14 -0400] macros: I find it very useful to query waht the current value is on machines
[2012-04-24 00:34:20 -0400] mhalligan: empty log
[2012-04-24 00:34:31 -0400] josephholsten: anyone know if chef 0.10.10 is going to support json > 1.6.1?
[2012-04-24 00:34:35 -0400] coderanger: mhalligan: Is expander running?
[2012-04-24 00:34:41 -0400] Brad_K: macros: holy crap.  okay, well  if you're going to aim a nuclear warhead at your own feet, then you shouldn't be complaining about the consequences.
[2012-04-24 00:34:53 -0400] mhalligan: no it wasn't
[2012-04-24 00:34:55 -0400] coderanger: josephholsten: Aren't we using yajl for everything now?
[2012-04-24 00:35:06 -0400] coderanger: mhalligan: That would be a good starting point :0
[2012-04-24 00:35:07 -0400] coderanger: :)
[2012-04-24 00:35:15 -0400] mhalligan: I guess there aren't dependencies in the init scripts
[2012-04-24 00:35:24 -0400] mhalligan: hrm and it wasn't set to startup on boot
[2012-04-24 00:35:42 -0400] josephholsten: let me rephrase, have we dropped the json (>= 1.4.4, <= 1.6.1) constraint?
[2012-04-24 00:35:46 -0400] coderanger: That would explain why you see no data in solr :)
[2012-04-24 00:36:10 -0400] mhalligan: thanks
[2012-04-24 00:36:26 -0400] coderanger: josephholsten: Looks like no https://github.com/opscode/chef/blob/0.10.10.beta.1/chef/chef.gemspec#L25
[2012-04-24 00:36:41 -0400] mhalligan: I'm going to go cry and rebuild a bicycle hub now. ttyl.
[2012-04-24 00:37:33 -0400] bemu: lol.
[2012-04-24 00:37:49 -0400] macros: Brad_K: A node object in memory is 10x the size of the raw json
[2012-04-24 00:38:55 -0400] Brad_K: macros: which is why you want to minimize the amount of data that you store about each object.
[2012-04-24 00:38:56 -0400] josephholsten: good lord we've got a lot of unresolved tickets with json in them
[2012-04-24 00:40:03 -0400] macros: Brad_K: But you're going the wrong way there, forcing an optimization that limits the usefulness of the tool
[2012-04-24 00:40:08 -0400] josephholsten: looks like it's an arbitrary constraint: https://github.com/opscode/chef/commit/a50b54a223400074ee879b07b066fd805064d7e9
[2012-04-24 00:40:11 -0400] Brad_K: macros: either that, or give the machine(s) enough RAM that there is no amount of memory that chef-client could possibly consume that could possibly result in someone complaining about being low on memory.  i don't see any other alternative to those two choices.
[2012-04-24 00:40:59 -0400] hoover_damn: jnials, btw just pushed up a commit to my postgresql recipe in regards to defining replicas
[2012-04-24 00:41:01 -0400] Brad_K: i.e., shove everything into the database whole-hog and make sure that you can handle the consequences, or be a lot more careful about what you try to cram in.
[2012-04-24 00:41:13 -0400] jnials: Cool.  I'll grab that.
[2012-04-24 00:41:15 -0400] macros: Brad_K: The problem is I can't express what subset I want
[2012-04-24 00:41:20 -0400] hoover_damn: jnials, basically allows you to define the replicas off of a role, and then customize it...
[2012-04-24 00:41:36 -0400] hoover_damn: jnials, I didn't add any replication stuff so this is just a horrible way to allow it likely
[2012-04-24 00:41:39 -0400] hoover_damn: but it works
[2012-04-24 00:41:46 -0400] jnials: kk.
[2012-04-24 00:41:49 -0400] macros: Paying the penalty on the host node object is ok and acceptable
[2012-04-24 00:42:09 -0400] macros: Paying it on search when I can tell you exactly what I need is sad
[2012-04-24 00:43:03 -0400] macros: I've written hacks to generate views as databags
[2012-04-24 00:45:39 -0400] macros: I bought into the idea of chef as CMDB, the run-time environment is trying hard to disabuse me of that notion
[2012-04-24 00:46:29 -0400] coderanger: macros: Returning the full object is, indeed, a bug
[2012-04-24 00:46:41 -0400] coderanger: It is on the list, just under other chef-client tasks right now
[2012-04-24 00:46:56 -0400] macros: coderanger: Yeah, just bitching yet again to raise awareness
[2012-04-24 00:47:01 -0400] coderanger: most client dev time right now is being spent on streamlining install of the client itself
[2012-04-24 00:47:15 -0400] coderanger: (read: omnibus)
[2012-04-24 00:47:57 -0400] macros: I understand the priorities, just selfish :)
[2012-04-24 00:48:09 -0400] coderanger: macros: We each have our client ponies, mine is client run lockfiles :D
[2012-04-24 00:48:29 -0400] macros: coderanger: Yeah, that one is annoying too, fixed by always running chef by hand ;)
[2012-04-24 00:48:38 -0400] Brad_K: macros: chef != CMDB
[2012-04-24 00:49:10 -0400] macros: Brad_K: But it is, or at least has aspirations to be
[2012-04-24 00:49:34 -0400] coderanger: macros: Recipe testing and the new app cookbook are also in the works
[2012-04-24 00:49:52 -0400] coderanger: (just to be clear that there is a lot of stuff happening re: chef-client)
[2012-04-24 00:50:04 -0400] Brad_K: in chef, the nodes themselves are the one Source of Truth with regards to whatever data relates to them.  everything else is just a cached copy that has a certain probability of already being out of date, regardless of how recently it was created from the One True Source.
[2012-04-24 00:50:36 -0400] z: Brad_K: I think a number of people would disagree with you on 'Chef != CMDB'.
[2012-04-24 00:50:46 -0400] macros: Brad_K: Right, which is good enough most of the time
[2012-04-24 00:50:48 -0400] josephholsten: Brad_K: you're saying there is no such thing as CMDB?
[2012-04-24 00:51:25 -0400] coderanger: Brad_K is using CMDB in the way ZK uses the term
[2012-04-24 00:51:41 -0400] coderanger: which isn't wrong, but isn't the way the term is used in general discussion
[2012-04-24 00:51:44 -0400] Brad_K: josephholsten: i think there are tools that pitch themselves as a CMDB, but i'm not convinced that they can truly be considered authoritative on that.  if something changes on the node right after the CMDB information is changed, who is wrong?
[2012-04-24 00:52:15 -0400] josephholsten: ok, so this is practically a rest vs message-passing dichotomy
[2012-04-24 00:52:15 -0400] z: Brad_K: almost every CMDB implementation is eventually consistent. To have it any other way would be *extremely* tricky.
[2012-04-24 00:52:29 -0400] Brad_K: sorry, i should have said "if something on the node changes right after the CMDB information is updated."
[2012-04-24 00:52:38 -0400] coderanger: Chef just has a much longer "eventually" than zookeeper and similar tools
[2012-04-24 00:52:46 -0400] coderanger: Which is usually fine
[2012-04-24 00:53:43 -0400] josephholsten: I tend to manage that with something like ossec, but it's a neat perspective to consider
[2012-04-24 00:54:23 -0400] coderanger: CAP, it isn't just a suggestion, it's the law :D
[2012-04-24 00:54:31 -0400] Brad_K: certainly, everything i recall having heard in this context is that chef does not try to be a CMDB, and if you're trying to use it as a CMDB, that may be a "sub-optimal" use of the tool.
[2012-04-24 00:55:07 -0400] coderanger: Brad_K: You are just using the word "CMDB" differently than everyone else in this discussion
[2012-04-24 00:55:25 -0400] coderanger: if you have harder realtime requirements for confg propagation, then yes, don't use Chef
[2012-04-24 00:55:43 -0400] coderanger: Chef has no intention of supplanting ZK, Doozer, etc
[2012-04-24 00:55:50 -0400] coderanger: but it is a database that stores configuration information
[2012-04-24 00:55:54 -0400] coderanger: and thus is a CMDB
[2012-04-24 00:55:57 -0400] Brad_K: coderanger: i'm willing to consider that possibility.  can you enlighten me as to the differences between the uses?
[2012-04-24 00:56:34 -0400] coderanger: Sure, think about a load balancer querying chef for roles:appserver
[2012-04-24 00:56:46 -0400] coderanger: that can update slowly, if it takes a minute for changes to be recognized, no problem
[2012-04-24 00:56:56 -0400] z: coderanger: I have pondered putting a 'dirty' bit on each attribute which chef-client updates, and outside of the chef-client interval using a tool hooked into inotify which watches for changes and pushes a message via AMQP saying "node.attr.dirty TRUE" (for complex data) or just "node.attr.data = newdata" so that whilst the data may *not* be up-to-date (in the former example) at least you have better understanding of what is waiting for another convergence to populat
[2012-04-24 00:57:09 -0400] coderanger: vs. a webapp looking for its database server, that might have harder realtime requirements
[2012-04-24 00:57:15 -0400] coderanger: since that data _must_ be correct
[2012-04-24 00:57:30 -0400] Brad_K: i would call that a "configuration management collection agent", not a "configuration management database".  The DB aspect implies to me that this is a push-based mechanism from the DB out to the nodes, whereas in the case of chef we are collecting the information and then storing a cached copy of that into a central database.
[2012-04-24 00:57:35 -0400] coderanger: (granted we use chef for that, with the establishment of Truth done by keepalived)
[2012-04-24 00:58:50 -0400] coderanger: Brad_K: I can see that as an argument in general, but I don't think I've ever heard the term "CMDB" limited to push systems
[2012-04-24 00:59:13 -0400] coderanger: But yes, they are different
[2012-04-24 00:59:43 -0400] jtimberman: CMDB has a specific definition in the ITIL sense of the word.
[2012-04-24 00:59:59 -0400] Brad_K: i have certainly heard of the term "database" being used mostly in an authoritative context  i.e., the database is authoritative, and everything else is not.  if a database is typically authoritative, then that would imply a push-based mechanism in this regard.
[2012-04-24 01:00:01 -0400] jtimberman: One thing that ITIL is good about is defining a common standard for terminology
[2012-04-24 01:00:34 -0400] coderanger: Brad_K: Chef-server _is_ authoritative on stuff like what roles are assigned where
[2012-04-24 01:00:38 -0400] Brad_K: i would agree that standard terminology is a good thing.
[2012-04-24 01:00:51 -0400] coderanger: And re: ohai data being delayed, as z mentioned all such systems are only eventually consistent
[2012-04-24 01:01:15 -0400] coderanger: Push vs. pull is just a matter of how long "eventually" usually is
[2012-04-24 01:01:35 -0400] coderanger: in chef it would be ~2x your client interval
[2012-04-24 01:01:41 -0400] coderanger: in ZK it might be a few hundred ms
[2012-04-24 01:01:42 -0400] Brad_K: coderanger: right, but chef is not authoritative on the exact precise settings of all of the up-to-the moment current sysctl values on all the nodes.  right?
[2012-04-24 01:01:53 -0400] coderanger: Neither is anything else
[2012-04-24 01:01:54 -0400] jtimberman: i'd argue that source control is your origin of authority.
[2012-04-24 01:02:07 -0400] coderanger: If you want a SPOT for that, chef chef _set_ those values
[2012-04-24 01:02:17 -0400] jtimberman: specifically, source control branch that has been vetted and approved through peer review to be deployed to the chef server :)
[2012-04-24 01:02:19 -0400] coderanger: then it is authoritative, qed
[2012-04-24 01:02:47 -0400] Brad_K: coderanger: as you know, there are plenty of sysctl values that are read-only.  there is no way you can possibly set them to anything.
[2012-04-24 01:02:52 -0400] jtimberman: coderanger: not if someone edits the data in the webui.
[2012-04-24 01:02:54 -0400] jtimberman: :)
[2012-04-24 01:03:05 -0400] coderanger: Brad_K: You know what I mean, chef isn't magic, and neither is ZK
[2012-04-24 01:03:16 -0400] coderanger: There is a propagation delay for data to flow though the system
[2012-04-24 01:03:25 -0400] coderanger: chef's delay is bigger, but the principle is the same
[2012-04-24 01:03:38 -0400] jtimberman: the main delay is in search indexes updating though.
[2012-04-24 01:03:45 -0400] jtimberman: (and cookbook upload)
[2012-04-24 01:03:59 -0400] coderanger: Yes, which is a big, variable, unpredictable threshold
[2012-04-24 01:04:15 -0400] coderanger: which is why saying chef and ZK are interchangeable is crazy
[2012-04-24 01:05:04 -0400] Brad_K: i'm confused.  did anyone say that chef and ZK are interchangeable?  if so, then i missed that part.
[2012-04-24 01:05:26 -0400] hoover_damn: I think Noah is a working case of Chef and ZK idea working
[2012-04-24 01:05:47 -0400] coderanger: "ITIL defines a CMDB as a database used to store Configuration Records throughout their Lifecycle"
[2012-04-24 01:06:21 -0400] coderanger: hoover_damn: Arg, took me forever to parse that :P
[2012-04-24 01:06:52 -0400] Brad_K: okay, i'm still not grokking.  can you recap for me?
[2012-04-24 01:07:03 -0400] coderanger: Brad_K: Chef is a CMDB because it is a database that stores configuration
[2012-04-24 01:07:38 -0400] coderanger: There is no such thing as a single authoritative datastore for a network, so excluding chef on that basis is unhelful
[2012-04-24 01:09:11 -0400] z: Brad_K: generally speaking sysctl values do not magically change, especially not read-only ones. Even those which are read-only could/probably got punted into CouchDB last convergence.
[2012-04-24 01:09:52 -0400] Brad_K: it's only a snapshot-in-time combination of the way things are supposed to be plus a copy of the way things were discovered to be at some point in the relatively recent past, but in terms of real-world implementation of storing configuration information regarding nodes, i can see that.
[2012-04-24 01:09:57 -0400] z: Brad_K: Now if you were referring more generally to the contents of /proc that is another matter. Obviously there are things in the wider /proc sense which fluctuate potentially many times per second depending on what the system is doing.
[2012-04-24 01:10:45 -0400] jperry: anyone use minitest-reporters in combination with minintest-chef-handler?
[2012-04-24 01:11:12 -0400] z: Brad_K: but statistical stuff like /proc/mem may not need to be promoted to a supersystem, and even you do want that, the System of Record may well be your monitoring tool
[2012-04-24 01:11:37 -0400] z: blah /proc/meminfo :)
[2012-04-24 01:12:26 -0400] z: so per coderanger ^^^^ then Chef *is* a CMDB by the ITIL definition, and "lifecycle" can be stated based on how often you hoover up CouchDB
[2012-04-24 01:12:43 -0400] z: if you want the data from birth to death than that could be a *lot* of data :)
[2012-04-24 01:13:29 -0400] z: 0213 = z goes for zZzZZzZZZZZs
[2012-04-24 01:15:49 -0400] Brad_K: yeah, i gotta go, too.  g'nite!
[2012-04-24 01:16:03 -0400] bemu: Does anyone know how to remove a data_source from ganglia? Removing from gmetad.conf and the rrd folder does not accomplish this.
[2012-04-24 01:16:41 -0400] miah: sacrafice a small chicken and restart the daemons?
[2012-04-24 01:17:16 -0400] bemu: I only have large chickens :(
[2012-04-24 01:17:21 -0400] miah: oh. well then you're out of luck.
[2012-04-24 02:23:50 -0400] josephholsten: wow,  I missed a thread, eh?
[2012-04-24 02:32:49 -0400] hippiehacker: if I wanted to remove some of the automatic attributes (say kernel.pnp_drivers and kernel.modules, as they are huge on windows), what would be the equivalent of a node.kernel.delete 'pnp_drivers'?
[2012-04-24 02:34:40 -0400] jtimberman: hippiehacker: Ohai::Config[:disabled_plugins] ?
[2012-04-24 02:36:37 -0400] hippiehacker: jtimberman: http://tickets.opscode.com/browse/OHAI-357 take a look at the comment (I did try that approach 8)
[2012-04-24 02:38:19 -0400] hippiehacker: search(:node, "*:*") takes 30-40 seconds with less than 40 nodes
[2012-04-24 02:39:16 -0400] hippiehacker: mainly because of the amount of data returned, and maybe to a lesser extent because of all the added search indexes under kernel.pnp_drivers/modules on windows
[2012-04-24 02:51:41 -0400] hippiehacker: https://gist.github.com/2475733 can demonstrate it (you need some windows nodes)
[2012-04-24 02:57:57 -0400] dstanek1: is there a good example somewhere of using a deploy key for github in a data bag?
[2012-04-24 03:15:56 -0400] hoover_damn: hippiehacker, time and time again people ask for the node attributes to be less heavy...
[2012-04-24 03:16:10 -0400] hoover_damn: hippiehacker, I gotta wonder if there's just a simple way we can ignore them on the expander?
[2012-04-24 03:16:23 -0400] hippiehacker: hoover_damn: I think I found a clean way to just not load them at all, via a recipe
[2012-04-24 03:16:31 -0400] hippiehacker: well, they get loaded via ohai
[2012-04-24 03:16:34 -0400] hoover_damn: right
[2012-04-24 03:16:35 -0400] hippiehacker: but we delete them before the save
[2012-04-24 03:17:01 -0400] hippiehacker: http://tickets.opscode.com/browse/OHAI-357?focusedCommentId=23573
[2012-04-24 03:17:14 -0400] hippiehacker: node.automatic['kernel'].delete 'pnp_drivers'
[2012-04-24 03:17:34 -0400] hoover_damn: nice
[2012-04-24 03:18:18 -0400] hoover_damn: hippiehacker, http://wiki.opscode.com/display/chef/Disabling+Ohai+Plugins
[2012-04-24 03:18:20 -0400] hoover_damn: should work too no?
[2012-04-24 03:18:27 -0400] hippiehacker: hoover_damn: not for this
[2012-04-24 03:18:42 -0400] hoover_damn: disable the plugin for pnp and junk?
[2012-04-24 03:18:45 -0400] hippiehacker: http://tickets.opscode.com/browse/OHAI-357?focusedCommentId=23235
[2012-04-24 03:19:04 -0400] hippiehacker: sure, I did a bunch of that, but for windows to work, you have to have the kernel plugin
[2012-04-24 03:19:10 -0400] hoover_damn: gosh alot of em disabled
[2012-04-24 03:19:14 -0400] hippiehacker: 8)
[2012-04-24 03:19:14 -0400] hoover_damn: haha
[2012-04-24 03:19:22 -0400] hoover_damn: well that shouldn't be in kernel
[2012-04-24 03:19:28 -0400] hippiehacker: hoover_damn: agreed!
[2012-04-24 03:19:38 -0400] hippiehacker: maybe kernel_modules
[2012-04-24 03:19:50 -0400] hoover_damn: kernel_modules_pnp
[2012-04-24 03:19:53 -0400] hoover_damn: kernel_modules_pci
[2012-04-24 03:21:22 -0400] jtgiri_: Is there an option to ignore hoskeymismatch errors ?  I am getting error on bootstrap `process_cache_miss': fingerprint c0:54:16:b8:e9:07:a3:ec:f7:11:b9:e6:44:7b:ae:75 does not match for "216.121.72.211" (Net::SSH::HostKeyMismatch)
[2012-04-24 03:23:14 -0400] hoover_damn: jtgiri_, you end up adding it to .ssh/config
[2012-04-24 03:23:23 -0400] jtgiri_: okay
[2012-04-24 03:23:25 -0400] jtgiri_: Thanks
[2012-04-24 03:23:32 -0400] hoover_damn: jtgiri_, do they give you domains to use?
[2012-04-24 03:23:43 -0400] jtgiri_: no these are go grid servers
[2012-04-24 03:23:58 -0400] hoover_damn: they don't give you reverse to begin with?
[2012-04-24 03:24:18 -0400] hoover_damn: Host *.amazonaws.com
[2012-04-24 03:24:19 -0400] hoover_damn: StrictHostKeyChecking=no
[2012-04-24 03:24:21 -0400] hoover_damn: is what I do for EC2
[2012-04-24 03:24:29 -0400] jtgiri_: Okay
[2012-04-24 03:24:32 -0400] hoover_damn: perhaps with knowledge of their netblock you can make the correct Host statement
[2012-04-24 03:24:33 -0400] hoover_damn: to work for you
[2012-04-24 03:24:54 -0400] hoover_damn: otherwise you have to edit .ssh/known_hosts and find the line matching for 216.121.72.211
[2012-04-24 03:24:57 -0400] hoover_damn: and delete it
[2012-04-24 03:25:01 -0400] hoover_damn: then bootstrap the instance
[2012-04-24 03:46:59 -0400] monvillalon: Hey there, I'm learning with chef to move our infrastructure to Rackspace Cloud. After I create the server using knife I have now way to log in to the server unless I change it via the management console. If bootstrap copies my personal .pem shouldn't it be a way for me to log in using that, or do I have to manually change the password via a recipe or something like that
[2012-04-24 03:48:15 -0400] monvillalon: anybody uses rackpace cloud with chef?
[2012-04-24 03:49:20 -0400] coderanger: monvillalon: You have to wait for the email with the root password right now
[2012-04-24 03:49:52 -0400] coderanger: monvillalon: Rackspace is working on it, matt ray has a branch of the rackspace plugin that adds key-based logins a la EC2 (and everyone else)
[2012-04-24 03:49:54 -0400] monvillalon: coderanger: something, happened I didn't get it
[2012-04-24 03:50:01 -0400] flaccid: yeah unless you have something to change ssh config
[2012-04-24 03:51:14 -0400] coderanger: monvillalon: Your best bet is to have a cookbook setup a real user with SSH key auth
[2012-04-24 03:51:21 -0400] coderanger: and hope chef client doens't fail :)
[2012-04-24 03:51:24 -0400] monvillalon: coderanger: So what are you doing to manage the server passwords
[2012-04-24 03:51:52 -0400] flaccid: personally i use rightscale which adds my public key to authorized_keys
[2012-04-24 03:51:55 -0400] monvillalon: ok.. will attempt to do that
[2012-04-24 03:52:01 -0400] coderanger: On rackspace? when I used it I had my base role create my real user and wipe the root password (and disable root ssh to boot)
[2012-04-24 03:53:06 -0400] monvillalon: ok, Im getting the hang of this, I'm a programmer and love the code aspect but some things just dazzle me it takes a while for everything to click
[2012-04-24 03:53:41 -0400] coderanger: yeah, rackspace's whole "email the root password" thing kind of doesn't sit well with the modern cloud world
[2012-04-24 03:53:46 -0400] coderanger: Fortunately it is going away :)
[2012-04-24 03:54:12 -0400] monvillalon: Ok, thanks a lot
[2012-04-24 03:56:19 -0400] monvillalon: Hey I'm on a real tight budget and I'm planning to host my own chef server and scalr , is this madness, any words of advice? Right now I'm just on the process to chefize the deployment of our application
[2012-04-24 03:56:53 -0400] coderanger: Unless you do colo, there is a 0% chance that running chef-server yourself is cheaper than hosted
[2012-04-24 03:58:14 -0400] monvillalon: Got the emails, just took a while...
[2012-04-24 03:58:20 -0400] coderanger: How many servers do you have?
[2012-04-24 03:58:37 -0400] z: monvillalon: It helps if you provide ballpark figures on the number of nodes you expect to manage, chef-client interval and a 'complexity' (1-10) of your recipes and in particular how much you use Search
[2012-04-24 03:58:58 -0400] coderanger: Yeah, what he said :)
[2012-04-24 03:59:13 -0400] monvillalon: Im planning around 10 to start but then have the ability to grow on demand
[2012-04-24 03:59:13 -0400] coderanger: z is a good person to ask on that question, he has massive spreadsheets on the topic :D
[2012-04-24 03:59:36 -0400] monvillalon: its hard to predict traffic, specially since I suck at operations :)
[2012-04-24 03:59:46 -0400] z: monvillalon: But I think in general, coderanger is correct, the pricing for OHC is good value when you look at the resources required to run OSCS and factor in "Do you need it to be highly available?" plus the cost of your input/time
[2012-04-24 04:01:10 -0400] monvillalon: Z, for 10 nodes a 1gb rackspace cloud server should be enough thats 70/month how much is it hosted?
[2012-04-24 04:01:22 -0400] coderanger: Yeah, if you are doing even just simple two-server replication/failover with 1GB of RAM (which is tight for even a small chef server, woo java) thats $90/mo just to run the server
[2012-04-24 04:01:40 -0400] monvillalon: just checked, 120. but of course no redundancy or high availability
[2012-04-24 04:01:51 -0400] coderanger: monvillalon: Hosted?
[2012-04-24 04:01:52 -0400] z: monvillalon: so for even ~10 nodes you're likely looking at wanting 1GB RAM (and preferably 2GB RAM) and with RAX that would be $44 ($87)
[2012-04-24 04:01:59 -0400] coderanger: Is definitely HA and redundant :)
[2012-04-24 04:02:07 -0400] z: monvillalon: if you want HA then double that, so $88 or $174
[2012-04-24 04:02:23 -0400] z: monvillalon: and er, making OSCS actually work in an HA manner is "somewhat complex". Speaking from experience.
[2012-04-24 04:03:26 -0400] z: monvillalon: It seems to involve molesting CouchDB in unnatural ways potentially involving either Gluster/Ceph or DRBD, and don't even get me started about Solr... :(
[2012-04-24 04:03:43 -0400] coderanger: Running your own chef server ends up being more $ because it is basically RAM-bounded and the price for that scales sub-linear
[2012-04-24 04:04:12 -0400] z: I have RAM coming out of every bodily orifice and I still prefer to spend my time elsewhere :)
[2012-04-24 04:04:24 -0400] coderanger: Well yeah, you are also a special case :P
[2012-04-24 04:04:39 -0400] coderanger: (on many levels)
[2012-04-24 04:04:48 -0400] monvillalon: Hear ya, I certainly see the benefit of not hosting chef myself. The problem its that my server bill is taken by our parent company and they are not going to pay for the chef service, I know its insane, I'm going to try to fight for it :0
[2012-04-24 04:05:08 -0400] z: monvillalon: git and chef-solo for you then ;)
[2012-04-24 04:06:13 -0400] monvillalon: z: And how about scalr, anybody has had experience with it. Is it worth the trouble?
[2012-04-24 04:07:48 -0400] z: monvillalon: http://scalr.net/pricing/
[2012-04-24 04:07:52 -0400] monvillalon: It seems unfinished =) Bur rightscale price its pretty steep
[2012-04-24 04:08:06 -0400] z: monvillalon: note the 'Chef Support' horizontal on there, and the associated price at the top
[2012-04-24 04:08:19 -0400] crucially: why would you ever use scalr?
[2012-04-24 04:08:50 -0400] coderanger: I don't really grok what scalr does
[2012-04-24 04:08:57 -0400] monvillalon: well, because Im the programmer + it department and I need something to monitor and restart instances while I open my eyes
[2012-04-24 04:09:06 -0400] coderanger: Just the equivalent of auto-scale groups?
[2012-04-24 04:09:13 -0400] coderanger: (which is free)
[2012-04-24 04:09:59 -0400] coderanger: monvillalon: Do you expect your servers to die that frquently?
[2012-04-24 04:10:10 -0400] monvillalon: Im not sure what auto-scale groups are, are you taking about an aws service?
[2012-04-24 04:10:19 -0400] coderanger: I mean it is something to plan for, for with 10 servers you can probably worry about that another day
[2012-04-24 04:10:24 -0400] z: the RightScale guys seem to have the right ideas, but I am biased on this topic.
[2012-04-24 04:10:43 -0400] monvillalon: coderander: lol, no . I just can't predict anything so I'm trying to cover all my bases.
[2012-04-24 04:11:38 -0400] coderanger: monvillalon: What kind of app is this? 10 servers is a pretty beefy backend for a basic webapp
[2012-04-24 04:12:23 -0400] monvillalon: I have a set of small classifieds site that have moderate traffic combined, I just got bought by the local newspaper and Im going to be on their frontpage, the traffic I'm going to get its anybody guess.
[2012-04-24 04:13:30 -0400] coderanger: For an example, the backend of hosted chef is ~16 servers total
[2012-04-24 04:13:44 -0400] z: o.O
[2012-04-24 04:13:53 -0400] coderanger: And that is running more web traffic than you are likely to see in a long while
[2012-04-24 04:13:57 -0400] monvillalon: Really? I think i need help then
[2012-04-24 04:14:25 -0400] monvillalon: I need nginx + php-fpm + memcache + solr + mysql
[2012-04-24 04:14:27 -0400] coderanger: monvillalon: No, I'm saying don't worry about auto-scaling and such, just setup your 10 servers and they will be fine with whatever load you throw at them
[2012-04-24 04:15:03 -0400] monvillalon: I was just planning to have two servers of everything, moderate servers at that.
[2012-04-24 04:15:19 -0400] z: If it ain't broke, don't fix it.
[2012-04-24 04:15:30 -0400] monvillalon: for example SOLR and MYSQL 8GB ram
[2012-04-24 04:16:03 -0400] coderanger: monvillalon: I think you might be overbuilding things a tad :)
[2012-04-24 04:16:13 -0400] coderanger: Mirrored pairs of stuff is good, yes
[2012-04-24 04:16:44 -0400] coderanger: But for example when you start off you can have the master solr server run the mysql slave
[2012-04-24 04:16:47 -0400] coderanger: and vice versa
[2012-04-24 04:17:16 -0400] coderanger: As long as it is all chef'd, it is trivial to spawn them on their own servers is load increases
[2012-04-24 04:17:26 -0400] coderanger: but you can still start small
[2012-04-24 04:17:39 -0400] monvillalon: thats the thing that I need steetssmarts about, but wouldn't solr + mysql be competing for RAM,
[2012-04-24 04:17:40 -0400] z: monvillalon: Are you expecting to get lots of hits viewing these classifieds, or lots of *new* entries?
[2012-04-24 04:18:09 -0400] monvillalon: Its more read intensive, of course I'm caching.
[2012-04-24 04:18:31 -0400] coderanger: Yeah, I would expect you wouldn't need to actually load-balance solr or mysql
[2012-04-24 04:18:32 -0400] z: monvillalon: For read-intensive stuff, IME, just deploy Varnish in front of the stack and walk the fsck away.
[2012-04-24 04:18:44 -0400] coderanger: so the inactive side of each pair can be pretty RAM-light
[2012-04-24 04:19:02 -0400] coderanger: If one fails over, yes, there will be contention, but you will keep running while you fix it
[2012-04-24 04:19:10 -0400] monvillalon: I guess my real plan is this, start HUMUNGOUS. Then monitor my servers, find any bottlenecks and start downsizing
[2012-04-24 04:19:28 -0400] monvillalon: z: :)
[2012-04-24 04:19:43 -0400] z: If you get to the point where you need to horizontally scale Varnish then its time to hire someone to help you, because I know folks who IPO-ed for $lots who didn't need to scale Varnish at all. Fairly 'commodity' colo hardware does >20Gbps with it.
[2012-04-24 04:20:36 -0400] coderanger: z: If you need to scale varnish, you give crucially a check and go back to sipping your cocktail on the beach
[2012-04-24 04:20:57 -0400] coderanger: probably on your private island
[2012-04-24 04:21:14 -0400] monvillalon: thanks this has been really helpfull.
[2012-04-24 04:21:26 -0400] z: monvillalon: I think my #1 piece of advice would be "Worry less" :)
[2012-04-24 04:21:35 -0400] coderanger: monvillalon: No problem feel free to ask questions here or the infra-talk channel
[2012-04-24 04:21:41 -0400] coderanger: (which I need to go back to lurking in)
[2012-04-24 04:21:42 -0400] z: monvillalon: sounds like you're doing just fine. Deploy small, monitor well, scale as you need and ask advice frequently.
[2012-04-24 04:22:05 -0400] monvillalon: I wasn't thinking about varnish, because I was moving to nginx and I don't have a real clear idea of how to invalidate the varnish cache
[2012-04-24 04:22:19 -0400] z: monvillalon: no point boiling the ocean and designing an IT architecture which can do a trillion hits a day, if you only get one guy on your blog ;)
[2012-04-24 04:22:26 -0400] z: paraphrased example but you get the idea.
[2012-04-24 04:22:43 -0400] crucially: coderanger: that is correct
[2012-04-24 04:22:58 -0400] monvillalon: lol , you are right..
[2012-04-24 04:23:00 -0400] z: which show is coderanger in? :)
[2012-04-24 04:23:31 -0400] monvillalon: coderanger: LOL, THE IT CROWD, loved you in it :)
[2012-04-24 04:23:51 -0400] crucially: z: if you need to distribute varnish around the world, you talk to us
[2012-04-24 04:24:00 -0400] crucially: or you need 400 million objects per server cached
[2012-04-24 04:24:30 -0400] bemu: monvillalon: I didn't read your whole conversation, but it's often idea to make your system resilient to failure, rather than depending on an external service to monitor/repair failure.
[2012-04-24 04:24:32 -0400] z: crucially: unless someone snuck Varnish in recently, to the best of my knowledge, I don't have it in the stack at the moment ;)
[2012-04-24 04:24:33 -0400] monvillalon: crucially: In reality my traffic its going to be 90% local
[2012-04-24 04:24:34 -0400] coderanger: Or if you just can't be assed to scale SSL handshakes
[2012-04-24 04:25:47 -0400] monvillalon: SSL its a problem for another day, I don't know how to go about it, stunnel or at the nginx level, then how do I load balance?
[2012-04-24 04:26:10 -0400] z: nginx can support multiple backends
[2012-04-24 04:26:11 -0400] monvillalon: I have to go to sleep before my wife leaves me=)
[2012-04-24 04:26:13 -0400] crucially: you can't use nginx for ssl
[2012-04-24 04:26:23 -0400] monvillalon: bemu: you are right
[2012-04-24 04:26:46 -0400] coderanger: crucially: Your idea of "can't" is usually several orders of magnitude different from the rest of us :D
[2012-04-24 04:26:47 -0400] monvillalon: crucialy: http://wiki.nginx.org/HttpSslModule
[2012-04-24 04:27:02 -0400] crucially: sure, ti does it, it doesn't work
[2012-04-24 04:27:05 -0400] coderanger: monvillalon: He means it scales terribly because nginx is bad at SSL
[2012-04-24 04:27:13 -0400] z: http://matt.io/entry/uq
[2012-04-24 04:27:13 -0400] coderanger: but this isn't a problem unless you are crazy
[2012-04-24 04:27:15 -0400] bemu: What is good at SSL?
[2012-04-24 04:27:19 -0400] z: initial benchmark results reaction
[2012-04-24 04:27:20 -0400] z: what. the. fuck.
[2012-04-24 04:27:24 -0400] z: ^ see above link :)
[2012-04-24 04:27:27 -0400] coderanger: bemu: fastly is good at SSL
[2012-04-24 04:27:34 -0400] monvillalon: And you people telling me not to worry and I have to do this with no money in a month :)
[2012-04-24 04:27:56 -0400] z: you have a month?!
[2012-04-24 04:28:00 -0400] z: why didn't you tell us earlier
[2012-04-24 04:28:09 -0400] z: we'd have left you pondering for at least another 2 weeks...
[2012-04-24 04:28:27 -0400] bemu: I intend on using fastly asap :D
[2012-04-24 04:28:42 -0400] bemu: lol
[2012-04-24 04:28:50 -0400] crucially: bemu: you should ;)
[2012-04-24 04:29:15 -0400] monvillalon: z: thats nice of you, the month also has scheduled in it lots of features to the code
[2012-04-24 04:29:17 -0400] bemu: I will, we've moved 90% of our infrastructure off of GAE, the last part will involve fastly.
[2012-04-24 04:30:08 -0400] monvillalon: Thanks for mentioning fastly, Ill read about it
[2012-04-24 04:30:50 -0400] coderanger: monvillalon: For reference, crucially is the CEO (?) and is awesome about answering questions on all things CDN or speed related
[2012-04-24 04:30:59 -0400] z: AHA
[2012-04-24 04:31:03 -0400] crucially: i am
[2012-04-24 04:31:06 -0400] z: it was macros who I ran into at the Chef Summit
[2012-04-24 04:31:13 -0400] crucially: z: sounds correct
[2012-04-24 04:31:42 -0400] bemu: monvillalon: There are a few competitors out there, but fastly has some really smart dudes as founders, and a very interesting / superior product. Plus, macros has answered a mind-numbing number of questions for .. probably all of us. :D
[2012-04-24 04:31:45 -0400] z: crucially: for a moment I was associating him with you. All resolved courtesy of mugshots on http://www.fastly.com/about
[2012-04-24 04:31:59 -0400] monvillalon: Seems awesome,
[2012-04-24 04:32:14 -0400] bemu: z: I did the same thing for a while, hahah.
[2012-04-24 04:32:25 -0400] crucially: z: he looks like a norse god, i just look like a viking
[2012-04-24 04:34:06 -0400] bemu: monvillalon: I think a lot of people would steer you away from Rackspace also, depending on what you're doing.
[2012-04-24 04:34:15 -0400] monvillalon: Well thanks a lot to everyone, I swear to give back soon
[2012-04-24 04:34:31 -0400] z: crucially: do you actually use http://www.reconinstruments.com/products/mod?
[2012-04-24 04:34:33 -0400] monvillalon: bemu: Its been chosen for me
[2012-04-24 04:34:43 -0400] crucially: z: sure, but they need to release the API
[2012-04-24 04:34:55 -0400] bemu: ah, kk.
[2012-04-24 04:35:09 -0400] crucially: z: I use them all the time when hitting the slopes
[2012-04-24 04:35:09 -0400] z: crucially: been 5 years since I last went on the slopes. technology has really moved on.
[2012-04-24 04:35:48 -0400] z: i'm taking 2-3 weeks out this winter to go someplace tho
[2012-04-24 04:36:05 -0400] crucially: z: fastly customers are welcome to the fastly ski house ;)
[2012-04-24 04:36:09 -0400] z: its long overdue payback on a promise to not work myself to death :D
[2012-04-24 04:36:23 -0400] crucially: generally, non fastly customers are welcome too
[2012-04-24 04:37:07 -0400] z: physically?
[2012-04-24 04:37:07 -0400] coderanger: z: Fly out to Seattle, the Opscode HQ crowd will gladly take you :)
[2012-04-24 04:37:17 -0400] crucially: no, partner list where
[2012-04-24 04:37:20 -0400] z: crucially: http://hpcloud.com/partner-list?page=1
[2012-04-24 04:37:50 -0400] z: coderanger: I normally ski the Alps but I *do* want to visit Whistler at some point in my life. I hear that's just up the road.
[2012-04-24 04:38:26 -0400] z: crucially: sorry that may be slightly obtuse, try http://twitter.com/#!/nixgeek
[2012-04-24 05:42:33 -0400] BryanWB: miah: had a hell of a time rewriting urls yesterday w/ haproxy
[2012-04-24 05:42:49 -0400] BryanWB: miah: also took me some time to figure out how to log to rsyslog
[2012-04-24 05:43:07 -0400] BryanWB: miah: is there an easier way to handle logging?
[2012-04-24 05:44:21 -0400] coderanger: bemu: Did you have any patches for pychef? Going to cut a release shortly
[2012-04-24 05:45:35 -0400] Mithrandir: pychef?
[2012-04-24 05:45:35 -0400] bawt: pychef is https://github.com/coderanger/pychef or http://pychef.readthedocs.org/
[2012-04-24 05:46:12 -0400] Mithrandir: ok, so just the client side of the API.  Still looks useful.
[2012-04-24 05:46:14 -0400] coderanger: Python API blindings for Chef :)
[2012-04-24 05:46:18 -0400] Mithrandir: nod
[2012-04-24 05:46:26 -0400] coderanger: Yeah, I also have a server impl too
[2012-04-24 05:46:29 -0400] coderanger: commis?
[2012-04-24 05:46:30 -0400] bawt: commis is an apprentice line chef
[2012-04-24 05:46:36 -0400] coderanger: drat
[2012-04-24 05:46:46 -0400] coderanger: well, you can find it, github.com/coderanger/commis
[2012-04-24 05:47:12 -0400] Mithrandir: yup
[2012-04-24 05:48:42 -0400] miah: BryanWB: use runit, make runit handle your logs.
[2012-04-24 05:48:52 -0400] BryanWB: miah: on rhel 6 :(
[2012-04-24 05:48:56 -0400] BryanWB: no runit
[2012-04-24 05:49:03 -0400] miah: no reason you can't put it there
[2012-04-24 05:49:06 -0400] miah: :P
[2012-04-24 05:49:44 -0400] BryanWB: miah: that would really throw my colleagues for a loop, they barely grok chef. I agree in principle but i can't take that step right now
[2012-04-24 05:49:53 -0400] miah: ya
[2012-04-24 05:50:09 -0400] BryanWB: miah: tks again for your help, working on peering today
[2012-04-24 05:50:13 -0400] miah: sure
[2012-04-24 05:50:50 -0400] miah: i should write something up on the acl stuff i've done. maybe it would be helpful to somebody. i still have lots to learn there though.
[2012-04-24 05:51:42 -0400] BryanWB: miah, imho it is more straightforward than apache config, just the url rewriting is tough
[2012-04-24 05:52:15 -0400] miah: yah
[2012-04-24 05:57:43 -0400] jtimberman: bawt: forget commis
[2012-04-24 05:57:43 -0400] bawt: okay then :)
[2012-04-24 05:58:12 -0400] jtimberman: bawt: commis is a Chef Server implementation in Python, https://github.com/coderanger/commis
[2012-04-24 05:58:18 -0400] jtimberman: coderanger: there ya go :)
[2012-04-24 05:58:33 -0400] coderanger: jtimberman: I really need to go and make it work with 0.10
[2012-04-24 05:58:40 -0400] jtimberman: coderanger: yeah!
[2012-04-24 05:58:41 -0400] coderanger: I think I've figured out a decent way to do it
[2012-04-24 05:58:52 -0400] jtimberman: depselector?
[2012-04-24 05:58:56 -0400] coderanger: If I only support == version qualifiers in envs it works nicely
[2012-04-24 05:59:04 -0400] jtimberman: oh ho
[2012-04-24 05:59:05 -0400] coderanger: No, I want to keep it pure python
[2012-04-24 05:59:11 -0400] jtimberman: well
[2012-04-24 05:59:19 -0400] jtimberman: i mean, the gecode dependency solver stuff.
[2012-04-24 05:59:36 -0400] jtimberman: so translating dep_selector to the python equivalent.
[2012-04-24 06:01:28 -0400] coderanger: Right, I don't think thats very doable
[2012-04-24 06:01:37 -0400] coderanger: gecode is hefty C
[2012-04-24 06:01:45 -0400] BryanWB: jtimberman:  why are tthere attributes in https://github.com/bryanwb/rsyslog/blob/master/metadata.rb ?
[2012-04-24 06:02:13 -0400] BryanWB: jtimberman: doesn't that duplicate the settings in attributes/default.rb?
[2012-04-24 06:02:17 -0400] coderanger: BryanWB: In theory so stuff like the webui or community site can display pretty inline docs
[2012-04-24 06:02:25 -0400] BryanWB: coderanger: ah!
[2012-04-24 06:02:29 -0400] jtimberman: BryanWB: metadata as documentation
[2012-04-24 06:02:43 -0400] coderanger: Same reason the the individual recipes are declared
[2012-04-24 06:02:52 -0400] jtimberman: next question: when will the community site support such a thing, coderanger?
[2012-04-24 06:03:01 -0400] jtimberman: hehehehe
[2012-04-24 06:03:21 -0400] coderanger: jtimberman: I think adding to the community site todo list at this point requires a thunderdome battle with Tim and Barry
[2012-04-24 06:03:32 -0400] BryanWB: jtimberman: am adding centos support to rsyslog, do i have to put additional conditionals in metadata.rb?
[2012-04-24 06:03:37 -0400] jtimberman: coderanger: (LOL)
[2012-04-24 06:03:58 -0400] jtimberman: BryanWB: what conditionals?
[2012-04-24 06:04:22 -0400] BryanWB: jtimberman: directory locations different for some of those attrs in centos
[2012-04-24 06:05:58 -0400] jtimberman: BryanWB: oh - so, updating the metadata isn't required.
[2012-04-24 06:06:08 -0400] jtimberman: like, i won't refuse a pull request based on lack of metadata.
[2012-04-24 06:07:17 -0400] coderanger: Also the metadata doesn't include the attr values
[2012-04-24 06:07:25 -0400] jtimberman: only thing i ask is that when adding new hard dependencies (like the 'yum' cookbook for yum_repository or recipe[yum::epel]), is a depends on that cookbook if its required for "default (non-optional) behviour"
[2012-04-24 06:07:29 -0400] jtimberman: coderanger: it can
[2012-04-24 06:07:44 -0400] coderanger: jtimberman: Yeah, but those don't :)
[2012-04-24 06:09:36 -0400] jtimberman: BryanWB: i also ask that additional recipes get a "recipes" line in the metadata, and that if adding new platforms, drop a "supports" in there. bonus points for a successful convergence of the node on that platform so I know its tested in some capacity :)
[2012-04-24 06:15:43 -0400] BryanWB: jtimberman: of course, btw toft is awesome for quick testing _but_ only works on natty
[2012-04-24 06:16:41 -0400] BryanWB: jtimberman: this worked yesterday, https://github.com/bryanwb/chef-ark/blob/master/Toftfile
[2012-04-24 06:20:36 -0400] miah: toft?
[2012-04-24 06:24:55 -0400] jtimberman: cool, i haven't looked into it yet.
[2012-04-24 06:25:00 -0400] jtimberman: why doesn't it run on oneiric or precise?
[2012-04-24 06:25:08 -0400] BryanWB: miah: toft rocks, quick integration testing on linux, but only really works on natty https://github.com/exceedhl/toft
[2012-04-24 06:25:16 -0400] miah: ya
[2012-04-24 06:25:18 -0400] miah: i found it
[2012-04-24 06:25:22 -0400] miah: looks like it also needs lxc
[2012-04-24 06:25:29 -0400] BryanWB: miah: yup
[2012-04-24 06:26:01 -0400] miah: i'll have to take a look. for now i think im going to continue trying chefspec/rspec-chef and the minitest stuff
[2012-04-24 06:30:18 -0400] BryanWB: miah: is used minitest stuff w/ toft, seen andrew crump's latest work? really awesome and time-saving
[2012-04-24 06:30:46 -0400] miah: i havent
[2012-04-24 06:30:58 -0400] miah: i saw he was doing a bunch with minitest
[2012-04-24 06:31:09 -0400] miah: but i havent been following too closely. i'm technically on vacation ;)
[2012-04-24 06:31:21 -0400] BryanWB: miah: enjoy!
[2012-04-24 06:31:27 -0400] jtimberman: miah: happy vacation! :D
[2012-04-24 06:32:17 -0400] jtimberman: bedtime here
[2012-04-24 06:38:23 -0400] miah: ah thanks
[2012-04-24 06:38:37 -0400] miah: i've been on vacation since last wednesday (not that yall have been able to tell) :P
[2012-04-24 07:07:34 -0400] coderanger: miah: "vacation" :P
[2012-04-24 07:10:07 -0400] miah: well. im not working on work. i'm scratching my other programming itches though
[2012-04-24 07:11:53 -0400] coderanger: Woo redis cookbook awesomeness!
[2012-04-24 07:15:11 -0400] coderanger: Oy, every time I do it I remember how painful editing nodes via the webui is
[2012-04-24 07:16:05 -0400] miah: ya. haproxy hasnt been getting as much love, but hopefully i'll dig back into that tomorrow
[2012-04-24 07:16:16 -0400] miah: for now i'm trying to clean up the redis cookbook
[2012-04-24 07:20:32 -0400] miah: gnites
[2012-04-24 07:22:24 -0400] BryanWB: miah: laterz
[2012-04-24 07:39:58 -0400] coderanger: huzzah, sweet env support in fabric!
[2012-04-24 07:40:10 -0400] coderanger: Now to write docs and pass out
[2012-04-24 08:29:26 -0400] coderanger: http://pychef.readthedocs.org/en/latest/fabric.html#chef.fabric.chef_environment if anyone uses Fabric along with chef envs, check it out
[2012-04-24 11:04:05 -0400] ftpmget: hi all
[2012-04-24 11:04:41 -0400] ftpmget: pls, i need a custom json script which will copy some dirs from dirA to network dirB
[2012-04-24 11:05:17 -0400] ftpmget: the ms win server can ping the chef srv
[2012-04-24 11:09:12 -0400] ftpmget: the channel is very alive
[2012-04-24 12:08:49 -0400] linuxboy: I have a problem where a template is changing from chef-client run to the next. I'm not uploading anything between runs. Any ideas where I can start looking?
[2012-04-24 12:43:54 -0400] asg: linuxboy: is the template being populated by looping through a hash? If so, the order will likely change on each run. Also, check that another cookbook isn't trying to work with the same file.
[2012-04-24 12:45:35 -0400] BryanWB: asg: good point for me to think about as well
[2012-04-24 12:47:10 -0400] thom: linuxboy: also, check for timestamps or similar in the template (obvious, but happens surprisingly often)
[2012-04-24 12:47:32 -0400] linuxboy: asg: it is looping
[2012-04-24 12:47:50 -0400] linuxboy: asg: I'm including 3 cookbooks that ultimatly call this one
[2012-04-24 12:47:59 -0400] linuxboy: asg: all have attributes that are 'default'
[2012-04-24 12:48:09 -0400] linuxboy: asg: but the template sometimes includes them and sometimes doesn't
[2012-04-24 12:48:21 -0400] linuxboy: asg: I have 'normal' attributes in the node definition which are the ones that I want there
[2012-04-24 12:51:18 -0400] BryanWB: asg: is it possible to use an ordered hash to avoid triggering a service restart on every run? this is likely a problem for me as well
[2012-04-24 13:23:16 -0400] geekbri: You can call node.environment within a template without issue right?
[2012-04-24 13:24:30 -0400] sampikesley: isn't is node.chef_environment ?
[2012-04-24 13:24:49 -0400] geekbri: yup it sure is. its early, and I haven't had coffee yet :)
[2012-04-24 13:36:39 -0400] sampikesley: knife-dwim is frickin' awesome
[2012-04-24 13:38:55 -0400] sampikesley: vi <some_chef_file>
[2012-04-24 13:38:59 -0400] sampikesley: knife dwim !$
[2012-04-24 13:39:00 -0400] sampikesley: ...
[2012-04-24 13:39:02 -0400] sampikesley: profit
[2012-04-24 13:39:26 -0400] gale_: just does the right thing? amazing!
[2012-04-24 13:40:39 -0400] sampikesley: really
[2012-04-24 13:40:49 -0400] sampikesley: works out what data bag you're in
[2012-04-24 13:40:54 -0400] sampikesley: works out if it's a role
[2012-04-24 13:40:55 -0400] sampikesley: whatevere
[2012-04-24 13:40:58 -0400] sampikesley: magic
[2012-04-24 13:41:23 -0400] jtimberman: sampikesley: yeah, i really like it.
[2012-04-24 13:41:34 -0400] jtimberman: great plugin
[2012-04-24 13:42:27 -0400] sampikesley: I was editing the default recipe inside a cookbook
[2012-04-24 13:42:32 -0400] sampikesley: and knife dwim's it
[2012-04-24 13:42:36 -0400] sampikesley: and it worked ou the cookbook
[2012-04-24 13:43:09 -0400] sampikesley: round of applause to whoever's responsible for this
[2012-04-24 13:43:58 -0400] gale_: that does take away the pain
[2012-04-24 13:44:13 -0400] gale_: remember the many options
[2012-04-24 13:44:17 -0400] gale_: +ing
[2012-04-24 13:44:47 -0400] sampikesley: yurp
[2012-04-24 13:45:01 -0400] sampikesley: I'm sure we should all be using rake
[2012-04-24 13:45:04 -0400] sampikesley: but rake scares me
[2012-04-24 13:45:15 -0400] yfeldblum: mpasternaki?
[2012-04-24 13:47:24 -0400] afallows: The best thing about knife-dwim's excellence is that the main driver is only 70 lines of code.
[2012-04-24 13:48:38 -0400] sampikesley: ha! really?
[2012-04-24 13:50:52 -0400] afallows: Yep. It looks like it's really just interpreting the path to the file and drawing some conclusions based on that. I.e. if the path includes a 'roles' folder, treat it like a role.
[2012-04-24 13:54:55 -0400] jtimberman: sampikesley: maciej pasternacki https://github.com/mpasternacki
[2012-04-24 13:55:04 -0400] jtimberman: He also has a start on a chef-mode for emacs.
[2012-04-24 13:57:14 -0400] geekbri: sampikesley: what happens if you try to use dwim from inside of vim with ! ?
[2012-04-24 13:58:34 -0400] sampikesley: try it...
[2012-04-24 13:58:39 -0400] BryanWB: sampikesley: u should checkout mpasternacki's emacs dwim mode for chef!
[2012-04-24 13:58:45 -0400] geekbri: I will when I get around to isntalling the plugin.
[2012-04-24 13:58:58 -0400] sampikesley: I think I made clear my feelings on emacs last week...
[2012-04-24 14:00:31 -0400] jtimberman: lol
[2012-04-24 14:01:56 -0400] geekbri: I missed it. Were you feelings of love?  Did you express your feelings for emacs in lisp?
[2012-04-24 14:02:04 -0400] geekbri: ( <3 emacs sampikesley )
[2012-04-24 14:21:57 -0400] yfeldblum: jtimberman, that you will acknowledge it exists, but that's as far as you'll go?
[2012-04-24 14:24:17 -0400] ultimoo: hi, how do I access the node mash inside of a LWRP provider?
[2012-04-24 14:24:39 -0400] yfeldblum: ultimoo, probably should not access the node from inside a provider ...
[2012-04-24 14:25:22 -0400] ultimoo: yfeldblum, i am trying to store some data on the node that will later on be picked up by a report handler.
[2012-04-24 14:25:25 -0400] ultimoo: any other way to do this?
[2012-04-24 14:25:46 -0400] yfeldblum: ultimoo, the node sounds like the wrong place to store it
[2012-04-24 14:26:01 -0400] yfeldblum: ultimoo, what type of data?
[2012-04-24 14:27:05 -0400] ultimoo: yfeldblum, it is an LWRP that creates OS containers, so I want to gather that data and make it available for a report handler
[2012-04-24 14:27:43 -0400] ultimoo: yfeldblum, so you are saying it is better to store it somewhere on the FS from the LWRP and then the report handler could pick it up? that is cumbersome, but doable
[2012-04-24 14:29:45 -0400] ultimoo: yfeldblum, or any other thoughts?
[2012-04-24 14:35:18 -0400] yfeldblum: ultimoo, the report handler has access to the entire resource collection from the chef run, so you can loop over it, pull out the resources you're interested in, and inspect their attributes
[2012-04-24 14:35:48 -0400] sampikesley: yfeldblum: you're the dude I was just listening to on FoodFight talking about Librarian?
[2012-04-24 14:35:58 -0400] jtimberman: yfeldblum: hmm?
[2012-04-24 14:36:08 -0400] geekbri: I suspect he might be the author of librarian ;)
[2012-04-24 14:36:11 -0400] yfeldblum: sampikesley, yes
[2012-04-24 14:36:12 -0400] jtimberman: he is!
[2012-04-24 14:36:12 -0400] sampikesley: that too
[2012-04-24 14:36:15 -0400] yfeldblum: geekbri, yes
[2012-04-24 14:36:21 -0400] jtimberman: \o/
[2012-04-24 14:36:28 -0400] sampikesley: sounds very interesting
[2012-04-24 14:36:31 -0400] jtimberman: it is!
[2012-04-24 14:36:34 -0400] sampikesley: gotta check that out some time...
[2012-04-24 14:36:36 -0400] jtimberman: really neat tool
[2012-04-24 14:36:38 -0400] yfeldblum: sampikesley, thanks
[2012-04-24 14:36:41 -0400] geekbri: yfeldblum: computer lords bless your soul
[2012-04-24 14:36:51 -0400] jtimberman: i love the "i want stuff from the community site, github and that git repo over there" aspect.
[2012-04-24 14:37:05 -0400] ultimoo: yfeldblum, thanks man, i'll give it a shot
[2012-04-24 14:37:31 -0400] geekbri: yes, using librarian is awesome, it also lets you use in development version of the official cookbooks from github instead of the community site
[2012-04-24 14:37:37 -0400] geekbri: it makes it easy if you need to fork stuff
[2012-04-24 14:37:39 -0400] geekbri: its just wonderful.
[2012-04-24 14:37:48 -0400] sampikesley: yeah, seems lik this is the Right Way Forward
[2012-04-24 14:38:15 -0400] yfeldblum: librarian-chef is not for everyone, and it's probably not the right way forward for everyone
[2012-04-24 14:38:30 -0400] geekbri: all i know is, its the right way forward for me :)
[2012-04-24 14:38:33 -0400] sampikesley: but one-repo-per-cookbook has got to be the right thing
[2012-04-24 14:38:48 -0400] sampikesley: "I want to fork that one thing"
[2012-04-24 14:39:10 -0400] geekbri: well it just makes it easier for people to send changes upstream
[2012-04-24 14:39:14 -0400] jtimberman: sampikesley: it makes it so much better for maintainers bcause you don't have to deal with merge conflicts across three other cookbooks than the one you're working on.
[2012-04-24 14:39:20 -0400] jtimberman: when things like readme and metadata changed.
[2012-04-24 14:39:34 -0400] geekbri: thats a good thing (tm)
[2012-04-24 14:39:42 -0400] yfeldblum: it adds some restrictions on you; make sure you're ok with them first :P
[2012-04-24 14:39:42 -0400] jtimberman: its a bit more hassle for maintainers in that there's a lot more repositories to manage of course.
[2012-04-24 14:40:38 -0400] yfeldblum: there were a lot of similar objections when rails decided to start using bundler by default - things like "but the sysadmin can't update gems that have security updates"
[2012-04-24 14:40:57 -0400] sampikesley: my devs LOVE bundler
[2012-04-24 14:41:05 -0400] yfeldblum: jtimberman, write a tool for that :P
[2012-04-24 14:41:24 -0400] yfeldblum: sampikesley, that's right, it adds constraints but it also liberates through the constraints
[2012-04-24 14:41:49 -0400] yfeldblum: everything's a tradeoff, and you should always look at both sides
[2012-04-24 14:41:49 -0400] jtimberman: yfeldblum: i have a few :)
[2012-04-24 14:41:55 -0400] jtimberman: bad shell scripts.
[2012-04-24 14:42:23 -0400] geekbri: usually the bad shell scripts are the only ones i actually use.
[2012-04-24 14:42:31 -0400] geekbri: I suppose thats a damning admission.
[2012-04-24 14:42:37 -0400] sampikesley: and non-trivial shell script is bad
[2012-04-24 14:42:40 -0400] yfeldblum: heh, my shell scripts always to begin with #!/usr/bin/env ruby
[2012-04-24 14:42:51 -0400] sampikesley: s/and/any/
[2012-04-24 14:43:21 -0400] sampikesley: the road to Hell is paved with the intention to write elegant bash
[2012-04-24 14:45:36 -0400] yfeldblum: jtimberman, your feeling w.r.t. emacs; that you will acknowledge its existence, but will not go any farther?
[2012-04-24 14:53:20 -0400] organicveggie: I'm doing a trial run of upgrading from Chef 0.9.14 to 0.10.8. After restarting everything, tried to rebuild the index... Got an error: "Address family not supported by protocol - socket(2)". Any suggestions?
[2012-04-24 14:59:19 -0400] UForgotten: organicveggie: do you have iproute2 installed?
[2012-04-24 14:59:49 -0400] UForgotten: organicveggie: its probably trying to use a new network stack library you don't have.
[2012-04-24 15:00:34 -0400] UForgotten: I'm trying to get a cookbook to edit sysctl values - the opscode one doesn't make any sense - has anyone reinvented this wheel better?
[2012-04-24 15:03:33 -0400] jtimberman: yfeldblum: oh - i use emacs
[2012-04-24 15:03:50 -0400] jtimberman: UForgotten: i don't think we have a sysctl cookbook.
[2012-04-24 15:04:24 -0400] UForgotten: jtimberman: there are 3 in the community site, they all appear to suck :(  that blows my mind, its basic functinality and anyone using config management should need it.
[2012-04-24 15:06:05 -0400] organicveggie: Is iproute2 a Ruby library? Or a system library?
[2012-04-24 15:06:13 -0400] UForgotten: system package
[2012-04-24 15:06:53 -0400] organicveggie: UForgotten: yes, iproute v2.6.32 is installed
[2012-04-24 15:07:23 -0400] jtimberman: UForgotten: it might be more constructive to rephrase "appear to suck" as "don't fit my use case" :)
[2012-04-24 15:07:42 -0400] organicveggie: actually, it looks like chef-server isn't running. which explains the problem. :)
[2012-04-24 15:07:56 -0400] jtimberman: and, cookbooks on the site are not necessarily used or reviewed by Opscode, its like RubyGems - anyone can post one.
[2012-04-24 15:08:35 -0400] UForgotten: jtimberman: fair enough.  It is just frustrating that many cookbooks don't fit my use case, but it is a use case everyone should have IMHO.
[2012-04-24 15:08:36 -0400] sampikesley: unlike rubygems, however, cookbooks usually have sensible names ;)
[2012-04-24 15:08:56 -0400] UForgotten: which is obviously an argument to submit my own, if I had the time to do so
[2012-04-24 15:09:08 -0400] UForgotten: however why reinvent the wheel when this wheel should have been on the road years ago
[2012-04-24 15:09:40 -0400] jtimberman: UForgotten: perhaps if you explain your use case and why it is "unique" compared to the implementations that exist?
[2012-04-24 15:09:40 -0400] UForgotten: but such is the way of open source. build new wheel when others won't share theirs :)
[2012-04-24 15:10:03 -0400] jtimberman: Is the difference subtle and could be incorporated in an existing cookbook? Perhaps collaborating with the author to improve?
[2012-04-24 15:10:59 -0400] UForgotten: jtimberman: arguably, yes. when I have completed hacking what is there I may be able to contribute it back.
[2012-04-24 15:11:21 -0400] UForgotten: the problem I have is that we use chef-solo so most things are flat-file oriented, and not node or databag oriented
[2012-04-24 15:11:32 -0400] UForgotten: so anyone using those is practically useless to me.
[2012-04-24 15:15:39 -0400] yfeldblum: UForgotten, it is expected that you will run into many situations where a cookbook doesn't meet your needs; it is expected that you will be writing your own cookbooks and forking others; that is the price of using chef for significant projects
[2012-04-24 15:15:42 -0400] organicveggie: Still doing a trial run of upgrading from Chef 0.9.14 to 0.10.8. chef-server doesn't seem to be starting. No log output. What's the best way to debug this?
[2012-04-24 15:21:49 -0400] UForgotten: yfeldblum: that is understood.  I'm just surprised for something as ubiquitous as sysctl that it wouldn't be a standard system cookbook.  That was my point. I dont have a problem writing another one, just sad that it hasn't been done before.
[2012-04-24 15:24:05 -0400] yfeldblum: UForgotten, what capabilities would you need in a sysctl cookbook?
[2012-04-24 15:27:27 -0400] UForgotten: yfeldblum: ability to generate /etc/sysctl.conf and notify call a service to restart sysctl -p
[2012-04-24 15:34:51 -0400] yfeldblum: UForgotten, in the simple case, that sounds rather straightforward, just a file resource and an execute resource and a loop over a node's attributes ... probably don't even need a full cookbook for it if you have a "base" cookbook to aggregate bits and pieces like that
[2012-04-24 15:36:25 -0400] miah: im awake
[2012-04-24 15:37:37 -0400] cwj: congrats
[2012-04-24 15:37:38 -0400] cwj: :D
[2012-04-24 15:39:04 -0400] yfeldblum: miah, is this an everyday event, or is this an achievement?
[2012-04-24 15:40:59 -0400] juanje: UForgotten: there are a few sysctl cookbooks out there: http://community.opscode.com/cookbooks/sysctl , http://community.opscode.com/cookbooks/el-sysctl , https://github.com/spheromak/cookbooks/tree/master/sysctl  Non of them fit your needs?
[2012-04-24 15:45:47 -0400] organicveggie: Error launching Chef 0.10.8: "Address family not supported by protocol - socket(2) (Errno::EAFNOSUPPORT)"
[2012-04-24 15:45:49 -0400] organicveggie: http://paste2.org/p/1993039
[2012-04-24 15:46:00 -0400] organicveggie: Since I have iproute 2 installed, any suggestions?
[2012-04-24 15:47:17 -0400] kallistec: organicveggie: did you configure your couchdb url to something weird?
[2012-04-24 15:47:33 -0400] kallistec: that error is occurring attempting to talk to couch
[2012-04-24 15:48:10 -0400] organicveggie: kallistec: Okay. That's progress!
[2012-04-24 15:48:22 -0400] organicveggie: kallistec: Couch is running, but errors in the logfile. :(
[2012-04-24 15:50:26 -0400] organicveggie: Okay. Couchdb failed to start properly after upgrade: http://paste2.org/p/1993045
[2012-04-24 15:51:15 -0400] kallistec: organicveggie: permissions problem on some file or dir
[2012-04-24 15:51:31 -0400] kallistec: {error,
[2012-04-24 15:51:32 -0400] kallistec:                                                                     eacces}
[2012-04-24 15:51:41 -0400] organicveggie: kallistec: bingo!
[2012-04-24 15:52:06 -0400] organicveggie: that's what i get for copying my couchdb data files from one EBS volume to another. :)
[2012-04-24 15:52:22 -0400] organicveggie: kallistec: Thanks!
[2012-04-24 15:52:33 -0400] kallistec: organicveggie: is your chef-server happy now?
[2012-04-24 15:53:05 -0400] kallistec: seems like it was having a different error, like it was configured for couchdb on a multicast addr or something
[2012-04-24 15:53:06 -0400] sampikesley: Some people, when confronted with a problem, think "I know, I'll use EBS". Now their shit is broken... ;)
[2012-04-24 15:53:26 -0400] organicveggie: sampikesley: ha!
[2012-04-24 15:53:44 -0400] organicveggie: kallistec: yessir, chef-server is much happier now. "Successfully bound to port 4000"
[2012-04-24 15:54:09 -0400] kallistec: okay, dunno how it got that unsupported protocol error then
[2012-04-24 15:54:17 -0400] kallistec: weird
[2012-04-24 16:03:47 -0400] miah: derp
[2012-04-24 16:14:12 -0400] BryanWB: hey pry users, how can I step through my code using pry? can't figure out how to do "next"
[2012-04-24 16:16:59 -0400] organicveggie: Alright. Not quite out of the woods yet. Now I'm getting the "Address family not supported by protocol" error from chef-client (separate machine). :)
[2012-04-24 16:17:09 -0400] organicveggie: http://paste2.org/p/1993105
[2012-04-24 16:28:02 -0400] qhartman: All of a sudden this morning chef is breaking on any recipe that tries to install a package using yum with "error: undefined method `to_sym' for nil:NilClass"
[2012-04-24 16:28:19 -0400] qhartman: full stacktrace at: http://pastebin.ca/2139806
[2012-04-24 16:28:52 -0400] qhartman: any insight would be appreciated, I'm not fluent in ruby
[2012-04-24 16:29:27 -0400] till__: maybe you want to paste ntp/recipes/default.rb
[2012-04-24 16:29:32 -0400] till__: specifically look at line 27
[2012-04-24 16:29:38 -0400] till__: it seems that is where the error comes from
[2012-04-24 16:30:44 -0400] qhartman: I don't think that's the real root of the problem, it's a simple 'package "ntp" do action :install end' block
[2012-04-24 16:31:34 -0400] qhartman: and if I comment that out it dies the same way it has do do anything involving packages on that same line in tum.rb
[2012-04-24 16:31:44 -0400] qhartman: yum.rb rather
[2012-04-24 16:32:48 -0400] jtimberman: qhartman: is 'ntp' a valid package name on your platform?
[2012-04-24 16:32:49 -0400] qhartman: the ntp recipe just happens to be the first place that chef gets asked to do a package installation
[2012-04-24 16:33:34 -0400] qhartman: jtimberman, yes, this is Centos 6.2, and this constellation of recipes has been working fine for weeks. The ntp cookbook is from opscode, and is unmodified
[2012-04-24 16:35:31 -0400] qhartman: I've tried clearing out the chef cache so it has to pull everything fresh from the server. This feels like something got broken in core chef, but I don't know how that could have happened.
[2012-04-24 16:35:57 -0400] qhartman: Could an environment file that passes json validation cause this kind of breakage some how?
[2012-04-24 16:39:48 -0400] qhartman: near the line things break at in yum.rb (around line 67), it looks like it's pulling in an external "helper" from yum-dump.py . Can anyone look at that and explain what it's doing there? I'm wondering if something changed with yum-dump.py if that might be the root of the problem.
[2012-04-24 16:41:04 -0400] till__: jtimberman: would ShellOut automatically only run during the execution phase?
[2012-04-24 16:43:50 -0400] qhartman: aha, look like it's a problem with the epel repo
[2012-04-24 16:44:11 -0400] qhartman: it's causing yum-dump.py to output "Could not parse metalink https://mirrors.fedoraproject.org/metalink?repo=epel-6&arch=x86_64 error was
[2012-04-24 16:44:12 -0400] qhartman: No repomd file" as it's first line
[2012-04-24 16:44:21 -0400] qhartman: which is making chef choke
[2012-04-24 16:44:42 -0400] till__: those are the best errors
[2012-04-24 17:01:45 -0400] miah: i don't mind RH-likes. I just hate rpm.
[2012-04-24 17:02:29 -0400] afallows: aptitude is ~30% of the reason I use Ubuntu.
[2012-04-24 17:08:16 -0400] hoover_damn: miah, cuddle up with redhat more often?
[2012-04-24 17:09:19 -0400] hoover_damn: i really don't know how people live with binary distributions so well... other then ignorance
[2012-04-24 17:09:40 -0400] hoover_damn: but i've been doing linux since 1990 so perhaps i'm just overthinking it
[2012-04-24 17:09:46 -0400] hoover_damn: s/linux/unix
[2012-04-24 17:12:23 -0400] miah: i built a distribution based on Redhat 6.2, 10 years ago. i know redhat/rpm well enough.
[2012-04-24 17:12:47 -0400] hoover_damn: interesting version you picked
[2012-04-24 17:12:58 -0400] miah: yup
[2012-04-24 17:13:09 -0400] hoover_damn: yeah I consider myself a jack of all trades... i've done suse, solaris, debian, redhat, gentoo, netbsd, freebsd
[2012-04-24 17:13:14 -0400] miah: same
[2012-04-24 17:13:21 -0400] hoover_damn: I would rather just say i'm awesome with a posix like OS
[2012-04-24 17:13:25 -0400] hoover_damn: but that really doesn't work always
[2012-04-24 17:13:51 -0400] miah: i started out learning linux, went on to admining netware, sco unix, and bsdi. experimented with bsd's, brought linux into the company
[2012-04-24 17:14:13 -0400] miah: it was fun replacing SCO Advanced File and Print Services with Samba
[2012-04-24 17:15:01 -0400] hoover_damn: rofl
[2012-04-24 17:15:25 -0400] hoover_damn:  miah working on those testerone shots to grow a good beard huh?
[2012-04-24 17:15:26 -0400] hoover_damn: cool
[2012-04-24 17:15:48 -0400] miah: i based my distro on RH 6.2 because that was the primary desktop when i worked at Penguin Computing =)
[2012-04-24 17:16:26 -0400] miah: it basically grew out of a set of patches i was maintaining
[2012-04-24 17:16:40 -0400] miah: that vastly improved security settings
[2012-04-24 17:17:11 -0400] hoover_damn: miah, oh i bet
[2012-04-24 17:17:54 -0400] miah: also, i had just turned down a job with redhat to move to san francisco and work for turbolinux instead. so i was very 'rh-like' in those years
[2012-04-24 17:18:01 -0400] till__: hoover_damn: i like to be able to use whatever i need, e.g. compile some, use pkg for others. offering both is the highroad IMO.
[2012-04-24 17:18:22 -0400] miah: at this point i've used most linux distros, and posix os's
[2012-04-24 17:18:36 -0400] hoover_damn: till__, people want to get to the point where there is no compiler on the edge
[2012-04-24 17:18:50 -0400] miah: i'm a fan of not having dev tools on servers
[2012-04-24 17:19:08 -0400] miah: i need to investigate fpm a bit more =)
[2012-04-24 17:23:13 -0400] till__: hoover_damn: i get that if you bootstrap an env. you want it fast - so e.g. distributing ready-made images or binary packages sometimes make sense.
[2012-04-24 17:24:30 -0400] miah: till__: indeed. the problem is some package managers make it difficult to maintain packages easily
[2012-04-24 17:24:41 -0400] miah: rpm spec files == lower level of hell
[2012-04-24 17:24:47 -0400] yfeldblum: the furthest end of that line of thinking is probably netflix's bakery: build complete machine images, run only those images
[2012-04-24 17:24:52 -0400] till__: yeah, i agree
[2012-04-24 17:24:56 -0400] miah: don't even get me started on sysv packages
[2012-04-24 17:25:11 -0400] till__: i mean, deb seems easier than rpm, but it's not exactly straight forward either
[2012-04-24 17:25:15 -0400] miah: yfeldblum: it makes a lot of sense
[2012-04-24 17:25:24 -0400] till__: all these conventions about linebreaks and spaces and tabs
[2012-04-24 17:25:28 -0400] yfeldblum: if no dev tools, how do you install gems with c extensions?
[2012-04-24 17:25:40 -0400] miah: indeed. its tricky these days
[2012-04-24 17:26:01 -0400] miah: i havent really gone looking for a solution to that problem yet
[2012-04-24 17:26:13 -0400] holoway: miah: omnibus all the things
[2012-04-24 17:26:30 -0400] till__: we maintain various vbox images for vagrant
[2012-04-24 17:26:34 -0400] till__: depending on the role
[2012-04-24 17:26:38 -0400] till__: but it's painful
[2012-04-24 17:26:43 -0400] till__: keeping it all up to date
[2012-04-24 17:26:46 -0400] miah: yup
[2012-04-24 17:26:50 -0400] miah: thats the problem with it
[2012-04-24 17:27:13 -0400] till__: and if you don't update and push all configuration into chef, then you just wait there for forever
[2012-04-24 17:27:54 -0400] miah: pxe all the things
[2012-04-24 17:28:05 -0400] miah: then you deal with other fun problems
[2012-04-24 17:28:20 -0400] miah: every solution has its own sewage to wade through
[2012-04-24 17:28:28 -0400] miah: sadly..
[2012-04-24 17:28:45 -0400] miah: but i'd much rather admin servers now, than 10 years ago.
[2012-04-24 17:29:30 -0400] yfeldblum: bake apps in containers with build tools; run apps in containers without build tools?
[2012-04-24 17:29:42 -0400] yfeldblum: build apps, rather
[2012-04-24 17:30:13 -0400] yfeldblum: for ruby, that build step includes a `bundle --deployment`
[2012-04-24 17:34:52 -0400] UForgotten: spheromak's sysctl cookbook may work, it looks like it still needs a sysctl -p. I will look into writing one.
[2012-04-24 17:35:23 -0400] kovyrin: bug fixed in route provider - http://tickets.opscode.com/browse/CHEF-3054, any chance it will make it to 0.10.10?
[2012-04-24 17:37:50 -0400] cap10morgan: When you have an execute resource whose only purpose in life is to trigger 2 others, can you do "command :nothing" or something like that?
[2012-04-24 17:38:08 -0400] btm: kovyrin: will try.
[2012-04-24 17:38:41 -0400] afallows: cap10morgan: Put action :nothing in the execute block
[2012-04-24 17:39:16 -0400] afallows: You might also be able to do command "", although I havent' tried it so it might not work.
[2012-04-24 17:39:38 -0400] cap10morgan: afallows: I have "action :nothing", that's a separate issue.
[2012-04-24 17:42:59 -0400] yfeldblum: cap10morgan, you can use a ruby_block resource for that purpose: ruby_block("triggers-others) { block { } ; action :nothing ; noties :run, "execute[abcd"], :immediately }
[2012-04-24 17:43:36 -0400] cap10morgan: yfeldblum: ok, good idea. thanks.
[2012-04-24 17:43:41 -0400] yfeldblum: cap10morgan, you can also use an execute resource with a command of "true"
[2012-04-24 17:43:56 -0400] cap10morgan: yfeldblum: ok, cool
[2012-04-24 17:44:02 -0400] yfeldblum: cap10morgan, since that is the one command which is guaranteed to do nothing and also return an exit code of 0
[2012-04-24 17:44:09 -0400] yfeldblum: cap10morgan, at least on NI
[2012-04-24 17:44:10 -0400] yfeldblum: NIX
[2012-04-24 17:46:18 -0400] cap10morgan: would be nice if chef had a "do that *before* you do this" notification type?
[2012-04-24 17:47:57 -0400] yfeldblum: cap10morgan, that's the as-yet-unimplemented `notifies :run, "execute[asdf]", :really_really_immediately` call
[2012-04-24 17:48:14 -0400] cap10morgan: yfeldblum: haha, yeah exactly. :)
[2012-04-24 17:48:51 -0400] cap10morgan: in this case it's for an apt-get upgrade -y command. I want to run apt-get update first, but not every run of apt-get update should trigger the upgrade resource.
[2012-04-24 17:49:25 -0400] cap10morgan: so it would be nice if I could just say, in the apt-get upgrade execute block, "notify the apt-get update execute resource to run first"
[2012-04-24 17:57:24 -0400] afallows: cap10morgan: Maybe I'm not understanding what you'd like to do, but couldn't you just put "apt-get update; apt-get upgrade" in the execute command string?
[2012-04-24 17:58:53 -0400] cap10morgan: afallows: yeah, that would work, but there is already an apt-get update execute resource that I wanted to re-use.
[2012-04-24 17:59:49 -0400] holoway: cap10morgan: you could get that with a ruby-block that just calls run action on the apt-get update resource
[2012-04-24 17:59:55 -0400] holoway: it's a little janky
[2012-04-24 18:00:14 -0400] cap10morgan: holoway: yeah, yfeldblum recommended that.
[2012-04-24 18:00:46 -0400] afallows: You can save a resource block into a variable and call run on it later, right? Can you call run on it more than once?
[2012-04-24 18:01:17 -0400] cap10morgan: afallows: hmm, that's an interesting idea. I may have to try that.
[2012-04-24 18:01:57 -0400] afallows: I haven't used it myself, so I'm unsure of the exact format, but it's worth investigating.
[2012-04-24 18:02:08 -0400] cap10morgan: afallows: yep, for sure.
[2012-04-24 18:03:35 -0400] jackr: can I use Chef to manage hierarchical installations?
[2012-04-24 18:05:09 -0400] coderanger: jackr: Define that term
[2012-04-24 18:05:32 -0400] jackr: yeah, sorry
[2012-04-24 18:06:01 -0400] jackr: (1) layer one installs all the stuff to run subversion. (2) layer 2 sets up individual repositories
[2012-04-24 18:06:22 -0400] jackr: layer one happens once, ideally; layer two happens again and again as each new repository is needed
[2012-04-24 18:06:43 -0400] Blah1: is there a way to download cookbooks from community.opscode.com using curl?
[2012-04-24 18:06:47 -0400] coderanger: Sure, those would be different resources
[2012-04-24 18:06:56 -0400] coderanger: or probably different recipes, but same difference
[2012-04-24 18:07:11 -0400] coderanger: jackr: Chef is idempotent, it only does what is needed to make the node match the config
[2012-04-24 18:07:13 -0400] Blah1: i know it sounds like should be straightforward but the 'download' button on the page cannot be used via curl
[2012-04-24 18:07:23 -0400] coderanger: Blah1: It can't?
[2012-04-24 18:07:32 -0400] Blah1: for example :   curl -l http://community.opscode.com/cookbooks/apt/versions/1_4_2/downloads
[2012-04-24 18:07:39 -0400] Blah1: produces javascript output
[2012-04-24 18:07:59 -0400] jackr: so you're saying that (a) a resource can depend upon / require the reinstallation of some base resource, and (b) either a resource can be parameterized to build multiple instances, or the recipe edited for that
[2012-04-24 18:08:02 -0400] Blah1: -L i mean
[2012-04-24 18:08:18 -0400] coderanger: Blah1: Ahh, looks like I need to exempt that from logins
[2012-04-24 18:08:21 -0400] coderanger: Blah1: Checking now
[2012-04-24 18:08:44 -0400] coderanger: jackr: I think you are describing LWRPs, so yes
[2012-04-24 18:09:21 -0400] jackr: what I'm really doing is fishing for search keywords, i guess, so thanks. LWRP == Light  Weight Resource  Potatoes?
[2012-04-24 18:09:36 -0400] coderanger: &providers
[2012-04-24 18:10:39 -0400] yfeldblum: jackr, why do you want to use chef to set up individual repositories?
[2012-04-24 18:11:09 -0400] jackr: well, I'm open to counter suggestions. but my thought was pretty naive  "chef is so coooool an stuff" ;-)
[2012-04-24 18:12:12 -0400] coderanger: jackr: What you are describing overall is just the subversion cookbook + a bunch of deploy resources
[2012-04-24 18:12:15 -0400] yfeldblum: jackr, that's right, but chef is a tool which takes a computer and a declarative final-state specification, and brings the computer into compliance with the final-state specification ... are these individual repositories part of the final state specification for the server?
[2012-04-24 18:12:23 -0400] coderanger: jackr: Also check out the new application cookbook
[2012-04-24 18:13:46 -0400] jackr: bigger picture: I want my users to be able to click one web button, and my automation (perhaps using chef) do all the set-up. not just subversion by any means, many recipes.
[2012-04-24 18:14:08 -0400] coderanger: jackr: So you are trying to do a white-label IaaS?
[2012-04-24 18:14:25 -0400] coderanger: Yes, chef can power that, security and isolation may be an issue though
[2012-04-24 18:14:28 -0400] jackr: yfeldblum: your "declarative final-state" language is handy, but I'd say "the desired final state evolves"
[2012-04-24 18:15:16 -0400] jackr: coderanger: "white-label IaaS" is getting close. maybe higher level, approaching PaaS. But then, maybe these terms aren't standardly enough defined to be worth quibbling over
[2012-04-24 18:15:33 -0400] coderanger: Sure, the difference between those two is minimal anyway
[2012-04-24 18:15:43 -0400] jackr: security and isolation are always issues, of course, but all part of my meat and potatoes anyway
[2012-04-24 18:16:06 -0400] coderanger: The biggest problem with using Chef like that is you will need to use one org (or chef server) per customer otherwise they can all see each other
[2012-04-24 18:16:55 -0400] yfeldblum: coderanger, not true if he's providing a layer over chef rather than exposing chef
[2012-04-24 18:17:06 -0400] jackr: I won't be letting them see Chef, only my web button, and I write all the recipes (yeah, what yfeldblum said)
[2012-04-24 18:17:10 -0400] coderanger: yfeldblum: If chef-client is running on the client server ...
[2012-04-24 18:18:00 -0400] yfeldblum: coderanger, also if he's providing subversion repositories, rather than servers + root passwords
[2012-04-24 18:18:10 -0400] mattray: jackr: Opscode's hosted chef can give you the isolation between orgs and let you administer them centrally
[2012-04-24 18:18:27 -0400] jackr: I control all servers, or each individual customer controls all servers
[2012-04-24 18:18:33 -0400] mattray: either way
[2012-04-24 18:18:56 -0400] mattray: there are exceedingly fine-grained access controls in Hosted Chef
[2012-04-24 18:19:02 -0400] z: ohai mattray lives!
[2012-04-24 18:19:05 -0400] jackr: I'm presently waving off eager demands for mixed deployment (some my servers, some customer)
[2012-04-24 18:19:22 -0400] mattray: and there are already IaaS folks using Chef behind the scenes doing what you're describing
[2012-04-24 18:19:26 -0400] afallows: From reading this discussion, I'm inclined to think the primary thrust of Chef is not aimed at what jackr is trying to do. THat's not to say it can't be done with Chef, but it may impose some challenges.
[2012-04-24 18:19:32 -0400] jackr: "Hosted Chef" means OpsCode hosted?
[2012-04-24 18:19:35 -0400] mattray: yeah
[2012-04-24 18:19:40 -0400] mattray: or Private Chef
[2012-04-24 18:20:09 -0400] jtimberman: fwiw, Opscode - the 'c' is small.
[2012-04-24 18:20:20 -0400] mattray: the only feature differences between the open source chef server and Opscode's Hosted & Private Chef are multi-tenancy and role-based access controls
[2012-04-24 18:20:32 -0400] jackr: afallows: I think you're right, but it seems closer than anything else I can find
[2012-04-24 18:20:39 -0400] jtimberman: there's other differences but those are the most obvious user-facing differences.
[2012-04-24 18:20:54 -0400] mattray: you also get support from nags like jtimberman
[2012-04-24 18:21:11 -0400] mattray: :)
[2012-04-24 18:21:53 -0400] mattray: you could get a similar effect deploying silo'd open source chef servers for each of your customers
[2012-04-24 18:22:03 -0400] geekbri: I use hosted chef.  Its nice to not have to worry about scaling your chef server.
[2012-04-24 18:22:05 -0400] mattray: managed centrally from another chef server
[2012-04-24 18:22:21 -0400] z: mattray: he may also not require too much Search which could make a chef-solo and rsync/git mashup work
[2012-04-24 18:22:48 -0400] mattray: z: why use chef-solo when you can easily deploy lots of chef-servers ;)
[2012-04-24 18:22:54 -0400] jtimberman: mattray: or training from the likes of you, sir ;)
[2012-04-24 18:22:58 -0400] mattray: bah
[2012-04-24 18:23:31 -0400] mattray: jackr: so you can get the isolation you want, it just becomes a little more mechanical on your end
[2012-04-24 18:23:54 -0400] organicveggie: Part 2 of my upgrade from 0.9.14 to 0.10.8 test. chef-client is failing. "Address family not supported by protocol - socket(2)". Any suggestions? http://paste2.org/p/1993105
[2012-04-24 18:25:33 -0400] z: organicveggie: ruby -v would be helpful
[2012-04-24 18:26:46 -0400] z: organicveggie: would also be helpful to see your client configuration, sans any sensitive hostnames I guess :)
[2012-04-24 18:27:39 -0400] z: organicveggie: Last time I saw that it was /etc/hosts being mangled and 'localhost' not resolving, weirdly enough, but YMMV
[2012-04-24 18:29:20 -0400] organicveggie: z: interesting. /etc/hosts does *not* look right. missing something. lemme check that. jas.
[2012-04-24 18:29:41 -0400] organicveggie: z: strike that. false alarm.
[2012-04-24 18:29:55 -0400] organicveggie: z: centos 6.2, ruby 1.8.7 (2011-06-30 patchlevel 352) [i386-linux]
[2012-04-24 18:30:21 -0400] bemu: organicveggie: Where did you get that ruby install?
[2012-04-24 18:30:37 -0400] bemu: I haven't seen a working 352 RPM yet, but I haven't been actively watching either.
[2012-04-24 18:31:06 -0400] organicveggie: bemu: been a while. can't remember. i'll do a little digging. been working fine with chef 0.9.14 since whenever we started upgrading to CentOS 6.2.
[2012-04-24 18:31:21 -0400] coderanger: Blah1: Thanks for the report, fix should go out later today
[2012-04-24 18:32:05 -0400] z: coderanger: "later today". Tsk tsk. Isn't it a 'git commit && git push' and then magical fscking fairies test/deploy it instantly? :P
[2012-04-24 18:32:07 -0400] organicveggie: z: Standard initial client config from "knife configure client" http://paste2.org/p/1993270
[2012-04-24 18:32:21 -0400] coderanger: z: No, and I have other fixes to make first
[2012-04-24 18:32:35 -0400] z: coderanger: I jest. Honest. ;)
[2012-04-24 18:32:36 -0400] organicveggie: bemu: Came stock from CentOS 6.2 updates channel.
[2012-04-24 18:33:26 -0400] Blah1: coderanger, you're welcome my pleasure and thx for fixing
[2012-04-24 18:49:39 -0400] wamcvey: I'm having what appears to be a ruby 1.8.7 (chef installed via apt repo on Ubuntu) vs ruby 1.9.2 (chef installed via the new loader... forgot what it's called). The problem is basically with the to_a method of a string. Details are at: https://gist.github.com/2482558  Anyone have any suggestions for changes to the recipe (generic-users) to make it general enough to be able to be run under both ruby 1.8 and 1.9?
[2012-04-24 19:03:16 -0400] caspyin: I'm using fnichol's user recipe to create users based on the node attributes. For example `node['users'] = ['deployer']`. what is the best practice regarding where to put customized attributes? In the recipe? specify on the command line? In the role?
[2012-04-24 19:11:05 -0400] hoover_damn: roles
[2012-04-24 19:11:08 -0400] hoover_damn: or environments
[2012-04-24 19:11:37 -0400] hoover_damn: caspyin, generally I set the passwords in the environment... users are set in the role, so environments can be password specific
[2012-04-24 19:11:37 -0400] coderanger: wamcvey: x.is_a? Array ? x : [x]
[2012-04-24 19:11:40 -0400] hoover_damn: or ssh key specific
[2012-04-24 19:14:08 -0400] wamcvey: coderanger: sorry, I'm kind of a ruby noob and am not clear on what you're suggesting. The original source file is: active_groups = (node[:users][:active_groups] || node[:active_groups]).to_a | node[:users][:supergroup].to_a    is there an elegant way to make that both ruby 1.8 and ruby 1.9 compatible?
[2012-04-24 19:14:47 -0400] caspyin: hoover_damn: so the user cookbook uses data bags for the user config stuff (home dir, ssh key, password) but it does need me to specify a list of users to match data bags. You're saying you would just specify that info in the role, correct?
[2012-04-24 19:15:21 -0400] caspyin: by "that info" i mean `node["users'] = ['deployer']
[2012-04-24 19:15:37 -0400] coderanger: wamcvey: def force_list(x) x.is_a?(Array) ? x : [x] end; active_groups = force_list(node[:users][:active_groups] || node[:active_groups] || node[:users][:supergroup])
[2012-04-24 19:17:04 -0400] wamcvey: coderanger: Thanks a ton
[2012-04-24 19:22:49 -0400] organicveggie: any other suggetions for my chef-client error?
[2012-04-24 19:31:32 -0400] bemu: Did anyone else see a rolling network outage in AWS US-East around 6am this morning?
[2012-04-24 19:32:59 -0400] cwj: i did not
[2012-04-24 19:33:15 -0400] afallows: bemu: My servers don't appear to have been affected.
[2012-04-24 19:33:29 -0400] bemu: 6:15am-6:45am PST.
[2012-04-24 19:33:33 -0400] bemu: So weird.
[2012-04-24 19:34:19 -0400] bemu: ELBs started returning 'unknown', and network connectivity was lost intermittantly for maybe 1/3rd of my servers, so maybe a single AZ?
[2012-04-24 19:35:44 -0400] miah: elb is the poops
[2012-04-24 19:36:06 -0400] miah: we used to see similar issues around that time window
[2012-04-24 19:36:16 -0400] miah: but i stopped giving elb my packets and took them elsewhere
[2012-04-24 19:39:12 -0400] bemu: ah, yeah, it was US-East-1a.
[2012-04-24 19:39:32 -0400] bemu: Working on dropping ELB now.
[2012-04-24 19:39:37 -0400] bemu: We used it as bandaid, basically.
[2012-04-24 19:40:03 -0400] yfeldblum: i thought AZ names that customers saw were customer-specific? your 1a might be his 1b and her 1c?
[2012-04-24 19:41:57 -0400] UForgotten: spheromak: u there?  I'm curious how your sysctl works when its adding ' around the values, linux doesn't like that
[2012-04-24 19:42:21 -0400] UForgotten: bemu: aws has network glitches all the time.
[2012-04-24 19:42:35 -0400] bemu: yfeldblum: Did not know that.
[2012-04-24 19:43:07 -0400] bemu: UForgotten: Yes, but not typically for this long, and didn't realize ELB would be completely useless during a small-scale network outage.
[2012-04-24 19:51:14 -0400] yfeldblum: meanwhile, 1a might be amazon's "under jeff's desk" and 1b might be amazon's "over by the window"
[2012-04-24 19:52:03 -0400] UForgotten: heh
[2012-04-24 19:52:12 -0400] UForgotten: its sad but true.
[2012-04-24 19:53:41 -0400] bemu: I don't think I would have had issues at all if I hadn't been using ELB.
[2012-04-24 19:53:46 -0400] bemu: Everything else is very resilient.
[2012-04-24 19:55:18 -0400] yfeldblum: does ELB do synchronously mirrored writes over the network?
[2012-04-24 19:57:49 -0400] bemu: What do you mean?
[2012-04-24 19:57:53 -0400] bemu: (be back in a bit)
[2012-04-24 20:09:08 -0400] pcn: yfeldblum do you mean EBS - the disks?  Or the load-balancer?
[2012-04-24 20:10:55 -0400] yfeldblum: pcn, yeah ...
[2012-04-24 20:19:09 -0400] pcn: yfeldblum I believe you have to mirror yourself.  You can see ideeli's presentation at one of the percona events to see what is involved (answer: lots and lots of disks in carefully planned regions)
[2012-04-24 20:21:35 -0400] cgibbons: hey folks... i'm running chef-server on an ec2 instance, and we found after a reboot when a new EC2 internal IP address was assigned that things aren't working right. it seems like rabbitmq isn't reachable by the other components.
[2012-04-24 20:21:47 -0400] cgibbons: we're using an elastic IP for the public ip address, so only the internal ip address changed
[2012-04-24 20:21:58 -0400] cgibbons: that sound like somethign that would break or totally a red herring?
[2012-04-24 20:35:06 -0400] yfeldblum: pcn, they were talking about the load-balancers; i thought they were talking about the block storage because amazon's had some problems with that
[2012-04-24 20:37:56 -0400] hcastro: yfeldblum: my understanding was that each AZ is a separate data center with different cooling and power sources
[2012-04-24 20:38:39 -0400] hoover_damn: hcastro, not 100% correct according to rusty memory... but Amazon can only really answer this.
[2012-04-24 20:39:05 -0400] hoover_damn: hcastro, if I recall one of the first zones it was not as redundant as it could have been... later zones and other regions were built out like what you said.
[2012-04-24 20:39:07 -0400] hcastro: i don't remember where or was told that either
[2012-04-24 20:39:18 -0400] hoover_damn: 1a and 1b
[2012-04-24 20:39:36 -0400] hoover_damn: but they could have fixed that by now
[2012-04-24 20:39:40 -0400] hoover_damn: so I could be spewing crud
[2012-04-24 20:39:54 -0400] apolishch: I've been persistently having an issue installing chef-server. I've tried Ubuntu 10.04, 11.10, and most recently Debian 6(all Virtualbox VMs). When following instructions here: http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages.
[2012-04-24 20:39:56 -0400] hcastro: i think i was told that by amazon engineers that came in for a workshop
[2012-04-24 20:40:18 -0400] hcastro: hoover_damn: but it's possible that it's only true for the more recent AZs
[2012-04-24 20:40:32 -0400] apolishch: It runs sudo apt-get chef chef-server. chef-solr, chef-client, and chef-server all fail to start, and then sudo chef-server triggers: FATAL: Connection to rabbitmq refused. Check your rabbitmq configuration and chef's amqp* settings /usr/lib/ruby/1.8/bunny/client08.rb:196:in `open_connection': Connection failed - user: chef (Bunny::ProtocolError)
[2012-04-24 20:40:53 -0400] hoover_damn: well 1e is likely this way, and I bet 1d and 1c were either retro/or fixed
[2012-04-24 20:41:02 -0400] hoover_damn: I say that because those were always my favorite... they screwed me the least
[2012-04-24 20:41:06 -0400] apolishch: Any and all help would be greatly appreciated. (Yes I know chef-solo is the alternate install path, I'ma go try and take that path now after a clean reformat)
[2012-04-24 20:41:14 -0400] hoover_damn: obviously my 1c/1d is not yours... so that's pretty much flipping coins
[2012-04-24 20:41:20 -0400] cgibbons: hey that's exactly what i'm seeing after a reboot, apolishch
[2012-04-24 20:41:41 -0400] cgibbons: (except chef-server runs, but doing a chef-client run later gets that)
[2012-04-24 20:42:11 -0400] apolishch: cgibbons: well its nice to know i'm not alone ^_^
[2012-04-24 20:42:35 -0400] apolishch: I actually thought it was an Ubuntu 11.10 issue to begin with. But like I said 11.04, and Debian 6 suffer the same fate
[2012-04-24 20:42:40 -0400] apolishch: Maybe a Virtualbox thing?
[2012-04-24 20:46:02 -0400] apolishch: me chef-solo it is. Maybe switch centOs while I'm at it
[2012-04-24 20:46:06 -0400] apolishch: *meh
[2012-04-24 20:46:16 -0400] apolishch: *CentOS
[2012-04-24 20:48:12 -0400] apolishch: no I won't don't really like CentOS
[2012-04-24 20:48:17 -0400] apolishch: or rather, don't really like yum
[2012-04-24 20:50:16 -0400] hoover_damn: sounds like rabbitmq wasn't configured, the bootstrap normally does this
[2012-04-24 20:50:26 -0400] hoover_damn: and your instructions seem to be lacking documentation on bootstrapping
[2012-04-24 20:50:42 -0400] cgibbons: ours had been running great for months and then pouf
[2012-04-24 20:52:09 -0400] apolishch: nah
[2012-04-24 20:52:24 -0400] apolishch: the bootstrap did set up the rabbitmq server, it was in the bootstrap logs
[2012-04-24 20:52:27 -0400] apolishch: in either case
[2012-04-24 20:52:44 -0400] apolishch: rabbitmqctl add_vhost /chef
[2012-04-24 20:52:51 -0400] apolishch: rabbitmqctl add_user chef
[2012-04-24 20:53:11 -0400] hoover_damn: and yet connection failed for the user chef
[2012-04-24 20:53:24 -0400] apolishch: rabbitmqctl set_permissions -p /chef chef ".*" ".*" ".*"
[2012-04-24 20:53:27 -0400] apolishch: were run
[2012-04-24 20:53:32 -0400] apolishch: manually tehreafter
[2012-04-24 20:53:44 -0400] apolishch: so unless there is some other missing rabbitmq config (Which is entirely possible)
[2012-04-24 20:55:03 -0400] apolishch: I don't know
[2012-04-24 20:55:23 -0400] apolishch: I'm going to try chef- solo, and then try the manual install
[2012-04-24 20:56:29 -0400] hoover_damn: solo would work because it doesn't require the server.
[2012-04-24 20:56:39 -0400] josephholsten: anyone know the contact info for the maintainer of http://community.opscode.com/cookbooks/networking_basic ?
[2012-04-24 20:56:42 -0400] hoover_damn: but it sounds like the server isn't working for some reason, have you thought about using hosted?
[2012-04-24 20:57:05 -0400] hoover_damn: it'll give you 5 nodes for free
[2012-04-24 20:57:08 -0400] josephholsten: it've got a couple straightforward bugs
[2012-04-24 20:57:11 -0400] hoover_damn: which if your looking for something small might be worth it
[2012-04-24 20:57:25 -0400] hoover_damn: josephholsten, says the maintainer is fred
[2012-04-24 20:57:31 -0400] josephholsten: hoover_damn: +1
[2012-04-24 21:01:35 -0400] cgibbons: well snap
[2012-04-24 21:01:47 -0400] cgibbons: so ours is working again. ihad to reconfigure rabbitmq.
[2012-04-24 21:01:54 -0400] cgibbons: i wonder if when the ip address changed if the rabbitmq configuration got lost?
[2012-04-24 21:02:54 -0400] coderanger: cgibbons: Did the hostname also change?
[2012-04-24 21:03:05 -0400] coderanger: Rabbit gets angry when hostnames change
[2012-04-24 21:05:12 -0400] cgibbons: since it's an ec2 instance yeah
[2012-04-24 21:05:27 -0400] cgibbons: bad rabbit
[2012-04-24 21:05:39 -0400] apolishch: what did you have to do to rabbit?
[2012-04-24 21:06:43 -0400] EricLyleKlein: can I ask a noob question here about debugging an erb template?
[2012-04-24 21:06:44 -0400] apolishch: also: I was talking about using solo to install server
[2012-04-24 21:08:40 -0400] cgibbons: i ad to do the add_vhost, add_user, and set_permission commands again, apolishch
[2012-04-24 21:08:47 -0400] apolishch: yeah did that
[2012-04-24 21:08:50 -0400] apolishch: :(
[2012-04-24 21:08:57 -0400] apolishch: but thank you
[2012-04-24 21:09:11 -0400] EricLyleKlein: when I use <%= debug variable_name %>, I get the error: FATAL: Chef::Mixin::Template::TemplateError: undefined method `debug'.  Is there another way to dump a var within an erb template?
[2012-04-24 21:10:04 -0400] kallistec: EricLyleKlein: where do you want the output to go?
[2012-04-24 21:10:14 -0400] kallistec: in the file, or to your screen?
[2012-04-24 21:10:23 -0400] EricLyleKlein: anywhere.  I was assuming just in the log
[2012-04-24 21:11:00 -0400] kallistec: Chef::Log.debug(my_var.inspect); my_var
[2012-04-24 21:11:04 -0400] kallistec: ought to work
[2012-04-24 21:11:31 -0400] kallistec: if not, use a newline instead of the semicolon
[2012-04-24 21:12:53 -0400] yfeldblum: that'll work
[2012-04-24 21:12:55 -0400] EricLyleKlein: cool.  Thanks!
[2012-04-24 21:20:17 -0400] gsymons-di: quick knife cookbook site question...
[2012-04-24 21:20:36 -0400] apolishch: well that was weird
[2012-04-24 21:20:58 -0400] apolishch: delete_vhost, delete_user, clear_permissions, add_vhost, add_user, set_permissions worked a charm
[2012-04-24 21:21:03 -0400] gsymons-di: When upgrading a cookbook, is it generally good practice to do 'knife cookbook site install' again? If not, what's the right way to do it?
[2012-04-24 21:21:18 -0400] apolishch: so thank you hoover_damn; cgibbons
[2012-04-24 21:23:53 -0400] mattray: gsymons-di: http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks#WorkingwithGitandCookbooks-DownloadCookbook
[2012-04-24 21:24:15 -0400] mattray: gsymons-di: once you've done a cookbook site install you've created a feature branch
[2012-04-24 21:24:20 -0400] mattray: err, vendor branch
[2012-04-24 21:24:38 -0400] mattray: so you can track the upstream and merge from it into your branches as necessary
[2012-04-24 21:24:40 -0400] jtimberman: gsymons-di: Yes.
[2012-04-24 21:24:50 -0400] jtimberman: because of what matt said :)
[2012-04-24 21:25:32 -0400] yfeldblum: gsymons-di, i think so - i think `knife cookbook site install` is designed to both newly-install and update an existing install
[2012-04-24 21:25:55 -0400] mattray: in the vendor-branch
[2012-04-24 21:27:59 -0400] pcn: ohai chefs.  Anyone here know how to get ec2 to give me a c1.medium that has 3.7gb instead of 1.7 via knife?
[2012-04-24 21:37:29 -0400] qhartman: pcn, c1.medium does have 3.75 GB of RAM.... ? Are you meaning you want a medium instead of a small?
[2012-04-24 21:38:31 -0400] hoover_damn: c1.medium is 1.7gb of ram
[2012-04-24 21:38:36 -0400] hoover_damn: m1.medium is 4gb of ram
[2012-04-24 21:38:43 -0400] hoover_damn: just to be technical
[2012-04-24 21:38:44 -0400] qhartman: ah yeah, my mistake
[2012-04-24 21:38:52 -0400] hoover_damn: sry
[2012-04-24 21:39:50 -0400] qhartman: pcn, regardless though, yo uare limited to the configs that AWS offers and have to pick from those: http://aws.amazon.com/ec2/instance-types/
[2012-04-24 21:40:09 -0400] miah: http://www.meetup.com/The-Bay-Area-Chef-User-Group/events/55580102/ looks awesome =)
[2012-04-24 21:41:13 -0400] senthilr: miah: fan of ironchef ?
[2012-04-24 21:41:26 -0400] miah: i am a fan, but i haven't used it.
[2012-04-24 21:41:41 -0400] miah: its a brillant stack of code to learn from
[2012-04-24 21:44:55 -0400] qhartman: anyone have any luck installing chef-server on Ubuntu precise from the opscode apt repo? It seems to work at first, but when I get to the initial client creation when I'm setting up knife it fails.
[2012-04-24 21:51:53 -0400] organicveggie: Trying to upgrade from 0.9.14 to 0.10.8. Copied couchdb to new server. Installed chef 0.10.8 on new server. Got chef-server/etc. running. Unable to configure initial command line client.
[2012-04-24 21:52:09 -0400] organicveggie: ERROR: Failed to authenticate to http://localhost:4000 as chef-webui with key /home/sean/.chef/webui.pem
[2012-04-24 21:52:47 -0400] organicveggie: Any suggestions?
[2012-04-24 21:53:08 -0400] pcn: hoover_damn that's where I was getting confused.  m1.medium sprang into existence recentlym, and I wasn't catching it.  Tahnks.
[2012-04-24 22:11:11 -0400] mattray: qhartman: ping btm on that
[2012-04-24 22:11:19 -0400] mattray: qhartman: or the mailing list
[2012-04-24 22:11:51 -0400] qhartman: mattray, thx
[2012-04-24 22:13:55 -0400] kolektiv: evening all
[2012-04-24 22:14:15 -0400] kolektiv: does anyone know if it's possible to have two roles on a node, which both use the same recipe?
[2012-04-24 22:14:29 -0400] kolektiv: (they have different attributes)
[2012-04-24 22:14:36 -0400] kolektiv: it doesn't seem to be working for me...
[2012-04-24 22:14:41 -0400] qhartman: the different attributes makes it tough
[2012-04-24 22:14:56 -0400] qhartman: you can generally only have a particular attribute set to one value per environemnt
[2012-04-24 22:15:15 -0400] qhartman: on a given node
[2012-04-24 22:15:53 -0400] mattray: kolektiv: yes, the recipes will get applied in order they appear in the run list and get de-duplicated
[2012-04-24 22:16:12 -0400] mattray: the attributes are last-applied wins I believe
[2012-04-24 22:16:34 -0400] mattray: of course, precedence rules override that
[2012-04-24 22:17:03 -0400] mattray: so as qhartman said, if you are applying attributes at the environment level, those will override
[2012-04-24 22:17:21 -0400] kolektiv: mmmm. they should only be at the role level... will fiddle!
[2012-04-24 22:17:31 -0400] mattray: (if you're using override) http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-04-24 22:17:44 -0400] mattray: kolektiv: then last-applied should win
[2012-04-24 22:20:46 -0400] kolektiv: doesn't seem to work. the run list shows two roles which use the same recipe...
[2012-04-24 22:20:59 -0400] kolektiv: ...but looking at recipes, fully expanded, that recipe appears only once
[2012-04-24 22:21:07 -0400] qhartman: yeah, that's how it will happen
[2012-04-24 22:21:14 -0400] qhartman: they get de-duped
[2012-04-24 22:21:31 -0400] kolektiv: hmmmm.
[2012-04-24 22:21:45 -0400] kolektiv: this time it appears to have worked on the next client run! will have to keep an eye on that
[2012-04-24 22:21:46 -0400] qhartman: if you want the same recipe to run twice with different attributes, you'll need to rename one of the recipes and then apply the attributes to that
[2012-04-24 22:21:51 -0400] qhartman: weird
[2012-04-24 22:22:54 -0400] bemu: I handle a similar problem by keying role attributes to data_bags.
[2012-04-24 22:23:02 -0400] qhartman: It would probably be easier to modify your existing recipe to handle the different cases implied by the different roles and work from a different set of attributes.
[2012-04-24 22:23:50 -0400] qhartman: bemu, how does that benefit?
[2012-04-24 22:23:51 -0400] kolektiv: qhartman: sadly there's not a known finite set of cases for that recipe
[2012-04-24 22:24:00 -0400] bemu: but my issue was more environment and role differences, rather than role to role.
[2012-04-24 22:24:06 -0400] bemu: Well, I don't know his specific use case.
[2012-04-24 22:24:11 -0400] kolektiv: qhartman: but per role attributes should work in the real world case anyway
[2012-04-24 22:24:14 -0400] kolektiv: i hope :0
[2012-04-24 22:24:16 -0400] kolektiv: :)
[2012-04-24 22:24:50 -0400] qhartman: kolektiv, I'm not sure you can guarantee which set of attributes will win if they are both present in a role
[2012-04-24 22:25:05 -0400] kolektiv: well, they're separate roles
[2012-04-24 22:25:09 -0400] qhartman: and both roles are present on a node
[2012-04-24 22:25:14 -0400] bemu: But for me, I have a single scribe recipe which handles both clients and servers (roles), and the value of configurations differs based on environment. So I have a role attribute that acts as a key to the environment. I have done a similar thing for data bags.
[2012-04-24 22:25:16 -0400] kolektiv: but they both include the same recipe
[2012-04-24 22:25:23 -0400] kolektiv: it seems to work...
[2012-04-24 22:25:29 -0400] bemu: kolektiv: I really wouldn't take that approach. At best, it's hacky.
[2012-04-24 22:25:44 -0400] kolektiv: bemu: really? what would be the alternative?
[2012-04-24 22:26:01 -0400] kolektiv: (my case is: we have multiple apps all of which are deployed in the same way
[2012-04-24 22:26:06 -0400] qhartman: so long as you don't have a node with both roles it should work, but once you have one node with both I think it will get weird on you
[2012-04-24 22:26:09 -0400] bemu: I don't know your use case, and I don't have time right now to examine it. But I would urge you to keep looking.
[2012-04-24 22:26:13 -0400] kolektiv: ... node, an upstart service, etc.)
[2012-04-24 22:26:18 -0400] bemu: eh, keep going
[2012-04-24 22:26:23 -0400] bemu: I'll try to give you input.
[2012-04-24 22:26:52 -0400] kolektiv: so the recipe deploys the app (deploy_version) and installs/starts an upstart service
[2012-04-24 22:26:58 -0400] bemu: Okay.
[2012-04-24 22:27:09 -0400] bemu: I'm not seeing yet why you're using the approach you are.
[2012-04-24 22:27:10 -0400] kolektiv: the only things that vary are the app name (which changes the deploy path) and the repo name
[2012-04-24 22:27:19 -0400] bemu: Okie, you're getting to it :)
[2012-04-24 22:27:32 -0400] kolektiv: so, one role is, let's say - web server
[2012-04-24 22:27:35 -0400] bemu: Yes.
[2012-04-24 22:27:51 -0400] kolektiv: uses node-server recipe, with attributes name: web, repo: web app repo
[2012-04-24 22:27:58 -0400] kolektiv: another might be an api server
[2012-04-24 22:28:11 -0400] kolektiv: different role, same recipe, different role attributes
[2012-04-24 22:28:21 -0400] kolektiv: seems like a way of keeping duplication down?
[2012-04-24 22:28:22 -0400] bemu: and you want to have two apps on the same server.
[2012-04-24 22:28:26 -0400] bemu: Yes, which is good.
[2012-04-24 22:28:36 -0400] kolektiv: yup (and potentially several apps)
[2012-04-24 22:28:45 -0400] bemu: Okay, so this has been solved, more than once.
[2012-04-24 22:29:03 -0400] bemu: The model I use is based on the (old/existing) application cookbook.
[2012-04-24 22:29:14 -0400] bemu: I believe the new application cookbook uses a different approach, but I haven't dug more deeply.
[2012-04-24 22:29:35 -0400] bemu: The application cookbook uses a combination of role, search, and data_bags.
[2012-04-24 22:30:04 -0400] bemu: The one I use has the same concepts, just modified for my environment (tornado, python, etc)
[2012-04-24 22:30:36 -0400] bemu: I believe the new approach is not based on data_bags, but I don't know more than that. Either would likely work for you.
[2012-04-24 22:31:12 -0400] kolektiv: hmmm. yes, i see.
[2012-04-24 22:31:49 -0400] bemu: Hope that helps, please include my nick in any future comments as I'm turning away from IRC. :)
[2012-04-24 22:32:12 -0400] kolektiv: heh, i'll be leaving it for tonight i think - time to get some non ops code written!
[2012-04-24 22:32:16 -0400] kolektiv: thanks for the help :)_
[2012-04-24 22:32:27 -0400] bemu: Just a warning, the logic behind the app cookbook is a bit complicated.
[2012-04-24 22:32:54 -0400] bemu: It's a lot for young chefs to grok, and was a huge tutorial for me in learning Chef. :)
[2012-04-24 22:32:56 -0400] kolektiv: bemu: yup, scanning it now
[2012-04-24 22:33:02 -0400] qhartman: the way we handle this is that we have a roles for each service that include attributes for each service, as well as a "services" container, containing the service name
[2012-04-24 22:33:11 -0400] kolektiv: will probably refactor to it at a later stage!
[2012-04-24 22:33:20 -0400] bemu: That's actually a really good point.
[2012-04-24 22:33:21 -0400] qhartman: as the roles get added to a node those service names get compiled into a list
[2012-04-24 22:33:31 -0400] bemu: You can essentially namespace your attributes, if you want.
[2012-04-24 22:33:31 -0400] qhartman: and then our deployment script iterates over that list
[2012-04-24 22:33:41 -0400] kolektiv: the multiple role thing is currently working, and it'll have to do for a week or two!
[2012-04-24 22:33:52 -0400] bemu: kk, I'm really surprised that it's working.
[2012-04-24 22:34:00 -0400] kolektiv: looking at it, so am i
[2012-04-24 22:34:03 -0400] bemu: :)
[2012-04-24 22:36:47 -0400] kolektiv: bemu: yeah, looking at that applications cookbook, i can certainly be cleverer about this long term
[2012-04-24 22:36:58 -0400] bemu: more clever? :P
[2012-04-24 22:37:07 -0400] kolektiv: but for now, i've just spun up for nearly identical roles, which actually work
[2012-04-24 22:37:09 -0400] bemu: wow, you're right.
[2012-04-24 22:37:14 -0400] bemu: cleverer is a word, that's awesome.
[2012-04-24 22:37:28 -0400] kolektiv: bemu: yup, it is indeed
[2012-04-24 22:37:29 -0400] bemu: I love learning new words. :D
[2012-04-24 22:37:39 -0400] kolektiv: bemu: :)
[2012-04-24 22:37:52 -0400] miah: hooked on phonics worked for me!
[2012-04-24 22:38:21 -0400] bemu: I just read a lot of fantasy novels when I was younger. School was lame.
[2012-04-24 22:40:13 -0400] miah: until i got into computers i only read about outdoors survival, camping, wilderness stuff
[2012-04-24 22:40:34 -0400] miah: (michigan is cool for camping)
[2012-04-24 22:40:37 -0400] mhalligan: miah: you were better off back then!
[2012-04-24 22:40:43 -0400] mhalligan: miah: where are you from in mi?
[2012-04-24 22:41:15 -0400] miah: small farm town near grand rapids
[2012-04-24 22:41:44 -0400] mhalligan: :) GR is pretty awesome (for michigan)
[2012-04-24 22:42:24 -0400] miah: coderanger: ditto. i helped my mom with her computer homework when i was around 5. learned basic in computer class on commodore64's.
[2012-04-24 22:42:46 -0400] miah: then i moved and progressed in computer classes and sadly the new teacher was teaching us logo
[2012-04-24 22:43:10 -0400] mhalligan: logo wasn't so bad
[2012-04-24 22:43:18 -0400] mhalligan: that was the language of the lego dacta technics
[2012-04-24 22:43:27 -0400] bemu: I started writing code at age 10, but I didn't understand it. We were just copying basic from computer magazines to play games. We had no floppy disks, so we re-entered them every time we wanted to play. Fortunately, there were four of us.
[2012-04-24 22:43:49 -0400] coderanger: I got as far as implement Conway's Life in logo and then lost interest
[2012-04-24 22:43:58 -0400] miah: awesome. i didnt actually own a computer until i was ~13
[2012-04-24 22:44:21 -0400] kolektiv: got my first computer when i was 16. was a great day :)
[2012-04-24 22:44:22 -0400] miah: before that it was whatever was available at school. but computer class wasn't a big thing then.
[2012-04-24 22:44:26 -0400] bemu: Then around age 11 or so we got our first computer, and I started to poke at BASIC and HTML. I was 15 before I started to learn to program for real, C and PHP3. Then Perl and C++, then Ruby and Python.
[2012-04-24 22:44:58 -0400] miah: awesome
[2012-04-24 22:45:09 -0400] miah: the first compiled language i dabbled with was pascal
[2012-04-24 22:46:03 -0400] miah: i haven't really concentrated on learning programming in my career though. i've dabbled in several languages but i haven't really mastered any.
[2012-04-24 22:46:24 -0400] miah: the last year has really changed that though
[2012-04-24 22:49:00 -0400] bemu: Same here, Miah.
[2012-04-24 22:49:16 -0400] kolektiv: this year's been a pretty diverse one for me on languages
[2012-04-24 23:38:16 -0400] UForgotten: is anyone out there using a 'working' sysctl cookbook in chef-solo?  The 3 that are out there don't really do the right thing.
[2012-04-24 23:42:07 -0400] hoover_damn: define right thing?
[2012-04-24 23:42:12 -0400] hoover_damn: I have a really old lame one
[2012-04-24 23:42:25 -0400] hoover_damn: it's whole purpose is to write it to sysctl.conf and then sysctl -p
[2012-04-24 23:42:52 -0400] UForgotten: hoover_damn: thats all I really friggin need
[2012-04-24 23:43:01 -0400] hoover_damn: UForgotten, https://github.com/damm/sysctl/blob/master/definitions/sysctl.rb
[2012-04-24 23:43:09 -0400] hoover_damn: all the dependencies are in that repo
[2012-04-24 23:43:19 -0400] hoover_damn: UForgotten, need an example?
[2012-04-24 23:43:51 -0400] hoover_damn: UForgotten, https://github.com/damm/postgresql/blob/master/recipes/server_debian.rb#L176-L178
[2012-04-24 23:43:54 -0400] hoover_damn: in case you do
[2012-04-24 23:44:00 -0400] UForgotten: hmm
[2012-04-24 23:44:17 -0400] hoover_damn: kinda older then dirt
[2012-04-24 23:44:19 -0400] UForgotten: if I fired a ton of calls to that, would it call sysctl -p each time?
[2012-04-24 23:44:24 -0400] hoover_damn: yes it does
[2012-04-24 23:44:40 -0400] hoover_damn: it wouldn't be hard to make it only call that once
[2012-04-24 23:44:44 -0400] UForgotten: thats what it looks like. what I'm aiming for is the ability to notify the sysctl -p when called so it only has to do it once
[2012-04-24 23:44:54 -0400] UForgotten: but I'm not good enough with chef dsl yet to accomplish it
[2012-04-24 23:45:05 -0400] hoover_damn: well that's all I have :)
[2012-04-24 23:45:14 -0400] hoover_damn: No clue if that's better or worse then the others
[2012-04-24 23:46:01 -0400] UForgotten: one example for calling sysctl would be helpful.
[2012-04-24 23:46:29 -0400] UForgotten: as far as creating the file this method is better imho, just need to get the sysctl -p as a delayed service execution and not an every time execution
[2012-04-24 23:46:55 -0400] hoover_damn: UForgotten, see the 2nd link I gave
[2012-04-24 23:47:20 -0400] hoover_damn: UForgotten, template/cookbook_file /etc/sysctl.conf and then have a execute resource subscribe to it
[2012-04-24 23:47:20 -0400] UForgotten: sorry, missed it the first time, got it now.
[2012-04-24 23:47:48 -0400] UForgotten: thats the part I'm haing trouble with. making an execute resource subscribable.
[2012-04-24 23:47:48 -0400] hoover_damn: execute "sysctl -p" do
[2012-04-24 23:48:09 -0400] UForgotten: dont know where the frack to put it. I tried doing that in a default.rb and chef complains it cant find it.
[2012-04-24 23:48:18 -0400] hoover_damn:   subscribes :run, resources(:template => "/etc/sysctl.conf"), :immediately
[2012-04-24 23:48:26 -0400] hoover_damn: action :nothing
[2012-04-24 23:48:26 -0400] hoover_damn: end
[2012-04-24 23:48:31 -0400] hoover_damn: then you just need
[2012-04-24 23:48:35 -0400] hoover_damn: template "/etc/sysctl.conf" do
[2012-04-24 23:48:41 -0400] hoover_damn: source "somefile.erb"
[2012-04-24 23:48:41 -0400] hoover_damn: end
[2012-04-24 23:49:11 -0400] UForgotten: that seems like a hack
[2012-04-24 23:49:28 -0400] hoover_damn: why?
[2012-04-24 23:50:13 -0400] UForgotten: should just be able to set up an execute "restart-sysctl" and then notifies "restart-sysctl"
[2012-04-24 23:50:47 -0400] hoover_damn: I actually prefer the subscribes
[2012-04-24 23:50:49 -0400] hoover_damn: it's a newer syntax
[2012-04-24 23:50:57 -0400] UForgotten: I need to get my head wrapped around these symbols.
[2012-04-24 23:51:01 -0400] hoover_damn: having to notify every resource was annoying
[2012-04-24 23:51:26 -0400] hoover_damn: I won't even talk about how many notifications I wrote between the year 2010 and 2011
[2012-04-24 23:51:37 -0400] hoover_damn: now it's q2 of 2012... nope, time for subscribes
[2012-04-24 23:51:41 -0400] UForgotten: heh.  I'd rather say hey go do this than trust someone to poll for doing something
[2012-04-24 23:51:53 -0400] UForgotten: while vs until I suppose
[2012-04-24 23:52:21 -0400] hoover_damn: Look, I've been writing chef since 0.6 came out.  You don't have to trust what i say.  But be more polite in the future if you don't like it.
[2012-04-24 23:52:24 -0400] hoover_damn: help is help
[2012-04-24 23:52:42 -0400] hoover_damn: I'm not new, I may have a different way of doing things
[2012-04-24 23:53:11 -0400] UForgotten: Sorry, my apologies, was not meaning to sound ungrateful.  Im new here so I'm struggling with TMTOWTDI
[2012-04-24 23:53:13 -0400] hoover_damn: i've given you 2 different valid suggestions that will work, please try them
[2012-04-24 23:53:16 -0400] hoover_damn: Oh I know
[2012-04-24 23:53:22 -0400] hoover_damn: you'll struggle forever if your not careful
[2012-04-24 23:53:38 -0400] hoover_damn: I'm king of TIMTOWTDIT
[2012-04-24 23:54:02 -0400] hoover_damn: but that's why I like subscribes :) it's a simpler method of describing the chain
[2012-04-24 23:54:23 -0400] hoover_damn: feels more direct to me at least
[2012-04-24 23:54:28 -0400] hoover_damn: notifies always felt backwards
[2012-04-24 23:57:24 -0400] UForgotten: hmm
[2012-04-24 23:57:38 -0400] UForgotten: looks like the wiki is getting a lot more content lately. that is a good thing.
