[2012-04-16 00:00:17 -0400] dbgster: with the mysql recipe, what is the root's password? its randomly generated via opensslso I have to change it then?
[2012-04-16 00:01:15 -0400] hoover_damn: you either set it, or let the random password be generated
[2012-04-16 00:01:20 -0400] hoover_damn: override != set
[2012-04-16 00:02:16 -0400] dbgster: with cookbook recipepe attributes, can I set them outside of the actual cookbook code? or do I have to modify things there?
[2012-04-16 00:06:36 -0400] dbgster: sudo service mysql stop doesn't work eitherguess it isn't hooked that way
[2012-04-16 00:10:34 -0400] dbgster: ah, i only installed the client :(
[2012-04-16 00:16:17 -0400] hoover_damn: lol
[2012-04-16 00:16:27 -0400] hoover_damn: dbgster, set the attribute on the role, or environment
[2012-04-16 00:16:53 -0400] hoover_damn: default_attributes(
[2012-04-16 00:16:56 -0400] hoover_damn: "mysql" => {
[2012-04-16 00:17:03 -0400] hoover_damn: "server_root_password" => "bob"
[2012-04-16 00:17:06 -0400] hoover_damn: })
[2012-04-16 00:17:25 -0400] hoover_damn: using the cookbooks mysql server, mysql client, and database
[2012-04-16 00:19:19 -0400] hoover_damn: dbgster, i haven't seen any database setup stuff in the cookbooks in application but i really don't use the application cookbook
[2012-04-16 00:24:20 -0400] df11: hey chefs, any idea why a notifies in a cookbook_file would be executing if the file isn't changing?
[2012-04-16 00:25:27 -0400] |shad0w|: code sample?
[2012-04-16 00:26:31 -0400] df11: http://pastebin.com/WVuwcVxL
[2012-04-16 00:27:06 -0400] |shad0w|: and the output from a run?
[2012-04-16 00:27:45 -0400] df11: http://pastebin.com/vVesVjaf
[2012-04-16 00:28:04 -0400] |shad0w|: the full run
[2012-04-16 00:29:11 -0400] hoover_damn: the file didn't change, or the notify isn't setup right?
[2012-04-16 00:29:34 -0400] df11: the file didn't change, i can run chef-client over and over and it keeps kicking apache
[2012-04-16 00:29:35 -0400] |shad0w|: hmm, that file is being changed twice
[2012-04-16 00:30:44 -0400] df11: ah, you guys got it, thanks- the apache2 recipe is changing it, and then i am changing it.  thanks.
[2012-04-16 01:09:23 -0400] silk: My understanding of Ruby hashes is that when enumerated, present the keys in the order that they were stored, so should that not be the case with attributes that are a part of a hash?
[2012-04-16 04:37:38 -0400] bendrix415: i am trying to use deploy_resource  with git to deploy my app; works fine when the directory doesn't exist but if it does, i get a "checkout directory already exists or is a non-empty directory"
[2012-04-16 04:38:13 -0400] bendrix415: do i need to wipe the directory before doing a deploy
[2012-04-16 04:56:45 -0400] philwo: i'm trying to use an environment to override attributes, but it seems like they get totally ignored. any idea why that may happen?
[2012-04-16 05:00:44 -0400] BryanWB: ohai chefs!!
[2012-04-16 05:01:33 -0400] BryanWB: pkondzior: ark is stable again, check it out
[2012-04-16 05:08:44 -0400] juanje: BryanWB: Ohai ark master chef! ;-)
[2012-04-16 05:09:58 -0400] philwo: ohai
[2012-04-16 05:10:03 -0400] BryanWB: juanje: hola maestro de cocina ;)
[2012-04-16 05:10:11 -0400] juanje: :-)
[2012-04-16 05:11:44 -0400] BryanWB: porque no todavia duermes? esta tempranissimo
[2012-04-16 05:12:36 -0400] silk: philwo, there is no overriding attribute sset on teh node?
[2012-04-16 05:13:25 -0400] philwo: silk, i freshly bootstrapped the node. if i "knife node show stacktest2 -fj", there are no attributes listed, that i override in the environment or role
[2012-04-16 05:13:41 -0400] philwo: btw, it doesn't even work, when i just use a role to set attributes
[2012-04-16 05:13:57 -0400] juanje: BryanWB: No, _esta vez_ s he dormido, me acabo de despertar.
[2012-04-16 05:14:34 -0400] silk: Can you dump the knife output into a gist? Does shef -z show the same issue?
[2012-04-16 05:15:10 -0400] juanje: BryanWB: It's quite early in Italy as well by the way...
[2012-04-16 05:15:30 -0400] BryanWB: juanje: ho molto lavoro da fare!
[2012-04-16 05:17:24 -0400] juanje: BryanWB: I though so. Good luck my friend :-)
[2012-04-16 05:17:28 -0400] philwo: silk, basically, the situation is like this: https://gist.github.com/2396442
[2012-04-16 05:45:45 -0400] askatz: hi
[2012-04-16 05:45:51 -0400] askatz: how does one report an issue?
[2012-04-16 05:46:06 -0400] askatz: with a public cookbook under opsocde-cookbooks on github?
[2012-04-16 05:46:48 -0400] null_route: HI Guys!
[2012-04-16 05:47:03 -0400] null_route: How can I check from a recipe whether another recipe axists?
[2012-04-16 05:47:08 -0400] null_route: exists*
[2012-04-16 05:49:44 -0400] BryanWB: null_route: in run_list?
[2012-04-16 05:49:56 -0400] BryanWB: null_route:   node[:recipes].include? "some_recipe"
[2012-04-16 05:50:22 -0400] null_route: BryanWB: not always
[2012-04-16 05:51:06 -0400] BryanWB: umm, u mean exists on the chef-server not necessarily in run_list?
[2012-04-16 05:51:14 -0400] null_route: yeah - sorry
[2012-04-16 05:51:17 -0400] null_route: Basically
[2012-04-16 05:51:27 -0400] BryanWB: argh, no idea, null_route sorry
[2012-04-16 05:51:29 -0400] null_route: I have a node tagged "javaapp"
[2012-04-16 05:52:03 -0400] null_route: I want a recipe to include recipe["javaapp"} if it exists
[2012-04-16 05:52:46 -0400] null_route: BryanWB: thanks anyway!
[2012-04-16 05:53:01 -0400] null_route: I can always create an attribute in each cookbook
[2012-04-16 05:53:18 -0400] null_route: and if the attribute exists, then call the recipe with the same name
[2012-04-16 05:53:23 -0400] null_route: but that's ass-backwards.
[2012-04-16 05:56:12 -0400] amagee: Hey I'm using "knife solo" to run on a remote server a recipe that restarts a service on that server, with a recipe that just says: bash "restart_wowza" do code "/etc/init.d/WowzaMediaServer restart" end
[2012-04-16 05:56:45 -0400] amagee: and this does in fact restart the server correctly, but somehow the server is stopped as soon as the chef script finishes
[2012-04-16 05:56:56 -0400] amagee: does anyone have any hints on debugging this?
[2012-04-16 06:00:33 -0400] philwo: amagee: if you run "/etc/init.d/WowzaMediaServer" from the shell, does it return after some seconds and the server keeps running?
[2012-04-16 06:00:53 -0400] amagee: philwo: yes, if i run /etc/init.d/WowzaMediaServer from the shell, everything works fine
[2012-04-16 06:01:13 -0400] amagee: actually it returns instantly, before the server is actually fully started
[2012-04-16 06:02:13 -0400] amagee: but if i run it from a shell, then exit the shell, the server keeps running
[2012-04-16 06:03:20 -0400] juanje: askatz: If the cookbook is from opscode: http://tickets.opscode.com/secure/CreateIssue.jspa?pid=10010&issuetype=1
[2012-04-16 06:03:20 -0400] juanje: askatz: if not, just file a issue at the github repo
[2012-04-16 06:03:32 -0400] amagee: actually what i said might not be true
[2012-04-16 06:04:22 -0400] juanje: askatz: more info here: http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-04-16 06:04:43 -0400] amagee: ok it definitely is true
[2012-04-16 06:05:09 -0400] philwo: amagee: so, if you ssh to your server, run the command, exit your ssh shell, the server keeps running?
[2012-04-16 06:05:13 -0400] amagee: yes
[2012-04-16 06:06:18 -0400] philwo: amagee: does the server log anything when it quits? that sounds really strange. i don't immediately have an idea what may cause this..
[2012-04-16 06:07:18 -0400] amagee: i'll check (yes, it is really strange)
[2012-04-16 06:10:14 -0400] amagee: yes the server logs itself as being shut down
[2012-04-16 08:14:14 -0400] gadolin: hey, is it a good practice to use same environment in few chef servers (organizations)? E.g. I have a test environment which I could use within few servers. However in envionment I store monitoring server ip, how would you overwrite it for each server?
[2012-04-16 09:07:27 -0400] BryanWB: top
[2012-04-16 09:10:35 -0400] proffalken:  1887 bryanwb  20   0 2483m 1.9g  37m S    8 16.4  75:17.89 wrongwindow
[2012-04-16 09:10:39 -0400] proffalken: :P
[2012-04-16 09:11:02 -0400] BryanWB: :)
[2012-04-16 09:15:02 -0400] BryanWB: ssh-rsa 0087lasdfas098
[2012-04-16 09:15:05 -0400] BryanWB: just kidding ;)
[2012-04-16 09:16:49 -0400] sampikesley: hah
[2012-04-16 09:18:11 -0400] sampikesley: this is the wrong channel, but some of you might have seen this before: I have a cookbook that installs libcurl3-dev (which is a metapackage for libcurl4-ssl or something). Works like a charm on my AWS nodes. Craps out on Vagrant with "had an error: apt does not have a version of package libcurl3-dev"
[2012-04-16 09:18:30 -0400] sampikesley: any clues?
[2012-04-16 09:32:48 -0400] pcn: sampikesley check /etc/apt/sources.list* and see if you've got a different set of repos between the vagrant and your ec2 instances
[2012-04-16 10:08:21 -0400] proffalken: is it possible to check if an attribute is *not* there?
[2012-04-16 10:08:56 -0400] proffalken: meh, scrap that, I've just realised that I'm "DOING IT WRONG"
[2012-04-16 10:08:57 -0400] proffalken: :)
[2012-04-16 10:20:59 -0400] sampikesley: pcn: well yeah, but I have the EC2 repos in there :/
[2012-04-16 11:19:21 -0400] null_route: Question - I'm the apache2 cookbook from OpsCode
[2012-04-16 11:19:40 -0400] null_route: The cookbook keeps restarting Apache
[2012-04-16 11:22:42 -0400] null_route: Hmmm
[2012-04-16 11:22:44 -0400] null_route: my bad.
[2012-04-16 11:22:48 -0400] null_route: Chef
[2012-04-16 11:22:50 -0400] null_route: was right
[2012-04-16 11:22:52 -0400] null_route: :-D
[2012-04-16 12:28:35 -0400] specialsauce: Anyone graphing any Chef metrics in Graphite by any chance?
[2012-04-16 12:40:11 -0400] upayavira: My chef server has just died, giving be an end of file reached (EOFError)
[2012-04-16 12:40:18 -0400] upayavira: See: http://pastebin.com/eZTGJDRd
[2012-04-16 12:41:16 -0400] upayavira: Any one have any ideas what's up? It now won't restart. It's a pretty new install on Ubuntu 12.04, of Chef 0.10.8
[2012-04-16 12:43:23 -0400] BryanWB: specialsauce: i get someone is, but you're best served by e-mailing the ml for that one
[2012-04-16 12:44:01 -0400] specialsauce: BryanWB: ok, fair enough, just wondering before I dived in, will mail the list, thanks
[2012-04-16 12:45:21 -0400] zts: upayavira: my wild guess is that there's something wrong with your couchdb, so I'd check that that is running and healthy
[2012-04-16 12:45:26 -0400] BryanWB: specialsauce: u may get a response quite quickly
[2012-04-16 12:46:09 -0400] specialsauce: upayavira: have you tried re-importing your data in couch? does sound like something is corrupt/not in a clean state, i'd try re-importing via knife or whatever your workflow is
[2012-04-16 12:49:47 -0400] cjs226: I'm wanting to query the chef server from a soon-to-be client to determine what the client's hostname should be by seeing what clients with the same role are already registered (www-001, 002, 003, etc.).  if the client has the correct validation.pem, is this possible?
[2012-04-16 12:53:14 -0400] jbz: Nope.  validation.pem will only let you register, not perform any other ops, AFAIK.
[2012-04-16 12:53:47 -0400] cjs226: jbz: bummer.  thx
[2012-04-16 12:54:43 -0400] jbz: cjs226: Note that the node name does not need to be the hostname.  You could register with another identifier, and then (based on the result of that search once you're registered) set the hostname.
[2012-04-16 12:55:14 -0400] jbz: As an example, we use EC2 instance IDs to register our nodes with the Opscode platform.
[2012-04-16 12:56:35 -0400] cjs226: jbz: thx.  I've been using instance ids as well but i don't like how that affects my graphite server when storing graphs, it's too wasteful.  so, i was hoping to use the role+increment
[2012-04-16 12:57:54 -0400] cjs226: specialsauce: I'm moving from pnp4nagios to graphite for not only nagios perf data but $kitchen_sync
[2012-04-16 12:58:07 -0400] upayavira: specialsauce: Thx. Restarted Couch, no difference. Knife is broken - won't upload. So, can I clear out couch and re-upload everything?
[2012-04-16 12:58:14 -0400] specialsauce: cjs226: PM sent :-)
[2012-04-16 12:58:58 -0400] specialsauce: upayavira: yep, as long as you have all your PEM files as well as your ruby files, and are using chef server, i've done that before
[2012-04-16 12:59:04 -0400] specialsauce: of course, rule number 1 applies
[2012-04-16 12:59:13 -0400] specialsauce: Back everything under the sun up first
[2012-04-16 12:59:15 -0400] specialsauce: and rule 2
[2012-04-16 12:59:23 -0400] specialsauce: don't take the word of anyone off IRC...
[2012-04-16 12:59:38 -0400] upayavira: lol. Rule 1: Keep backups. Rule 2: don't blame me if it goes wrong
[2012-04-16 13:00:14 -0400] specialsauce: but seriously, I did this last week on chef server without incident. we keep everything including PEMs in a git repo so it made it very easy
[2012-04-16 13:05:19 -0400] upayavira: specialsauce: any pointers on how to start again with couch? So far Couch looks fine to me
[2012-04-16 13:06:50 -0400] upayavira: okay, so couch isn't happy (found /var/log/couchdb/couch.log
[2012-04-16 13:09:42 -0400] specialsauce: upayavira: pastebin?
[2012-04-16 13:18:27 -0400] proffalken: hi all, is there any way to search from within a template?
[2012-04-16 13:18:47 -0400] sampikesley: proffalken
[2012-04-16 13:18:49 -0400] sampikesley: I don't think so
[2012-04-16 13:18:54 -0400] proffalken: I'm working on sopme backup stuff and part of the template should only be written if the current node has a given role
[2012-04-16 13:19:04 -0400] proffalken: however the nodes are passed as a single array to the template
[2012-04-16 13:19:07 -0400] proffalken: :(
[2012-04-16 13:19:27 -0400] sampikesley: can't you set values in the recipe tat calles the template?
[2012-04-16 13:20:24 -0400] sampikesley: then in the tmpl <% if @param.foo -%> do_stuff <% end -%>
[2012-04-16 13:20:27 -0400] sampikesley: or similar
[2012-04-16 13:21:10 -0400] proffalken: possibly, but at the moment I get a list of the filesets, then for each of the filesets I find all the nodes that match it and then I flatten both sets of data into an array
[2012-04-16 13:21:22 -0400] proffalken: bugger, which means I've already got the information I need...
[2012-04-16 13:21:29 -0400] proffalken: that's twice today I've done that in here...
[2012-04-16 13:21:30 -0400] proffalken: L(
[2012-04-16 13:21:33 -0400] proffalken: ffs
[2012-04-16 13:21:40 -0400] proffalken: sampikesley: thanks for being a sounding board... :D
[2012-04-16 13:21:55 -0400] sampikesley: hah
[2012-04-16 13:22:03 -0400] sampikesley: rubber ducking is always awesome
[2012-04-16 13:23:18 -0400] upayavira: specialsauce: I'm seeing this sort of thing in /var/log/couchdb/couch.log, but can't reproduce it: http://pastebin.com/gFNQsamF
[2012-04-16 13:41:19 -0400] specialsauce: upayavira, that looks like a checksum error on the couchcd as suspected I think? Are you saying it is now working? Or that its still failing to start but with no new error output?
[2012-04-16 13:48:15 -0400] spyvsspy: my webui install broke again today
[2012-04-16 13:48:22 -0400] spyvsspy: it seems to randomly crap out after X days
[2012-04-16 13:48:36 -0400] spyvsspy: http://makerbreaker.com/blog/2012/04/10/chef-server-webui/
[2012-04-16 13:48:47 -0400] spyvsspy: thats how I have been fixing it, any suggestions on how to get to the root?
[2012-04-16 13:52:37 -0400] upayavira: specialsauce: the latter
[2012-04-16 13:55:13 -0400] specialsauce: upayavira: I'm still thinking couchdb corruption. I *believe* i'm right in saying to you that its safe to just shut down chef and couchdb, move your couchdb to .OLD and then start it up again to create a fresh DB you can import into. I'm pretty certain this is what I did last week. The only issue you will have is that on the fresh startup it generates a new set of validation PEMs whereas you will want to re-use your existing ones. I think after
[2012-04-16 13:55:14 -0400] specialsauce:  that tho it was plain sailing for me just to knife import everything again
[2012-04-16 13:58:58 -0400] ryan-roemer: Hi.  I have a default attribute (an array) like: default[:nodejs][:versions] = [ "0.6.15" ] that another cookbook attribute overrides with: override[:nodejs][:versions] = [ "0.6.15" ].  However, when I run chef, I get "NoMethodError: undefined method `+@' for ["0.6.15"]:Array"  Is there something I'm missing about how Chef deep attribute merge works?  Thanks!
[2012-04-16 14:00:14 -0400] specialsauce: ryan-roemer, why are you quoting the version string in squre brackets?
[2012-04-16 14:00:33 -0400] ryan-roemer: It's an array (just one item for now).
[2012-04-16 14:00:54 -0400] ryan-roemer: But, I'll have multiple entries in the future.
[2012-04-16 14:00:56 -0400] specialsauce: ok
[2012-04-16 14:01:56 -0400] specialsauce: what version of chef?
[2012-04-16 14:02:13 -0400] ryan-roemer:  Chef 0.10.8
[2012-04-16 14:02:38 -0400] specialsauce: huh, ok. no idea then :-P
[2012-04-16 14:03:00 -0400] ryan-roemer: Yeah. Seems like should work :)
[2012-04-16 14:04:23 -0400] specialsauce: it didnt used to, but i think it shuld in 0.10.8
[2012-04-16 14:05:28 -0400] jtimberman: ryan-roemer: can you gist the stacktrace from chef?
[2012-04-16 14:05:38 -0400] ryan-roemer: Sure!
[2012-04-16 14:06:40 -0400] ryan-roemer: https://gist.github.com/2399041
[2012-04-16 14:07:43 -0400] ryan-roemer: Actually  hold on a moment I'm getting the exception without the override too.  Might be a case of operator error ;)
[2012-04-16 14:08:00 -0400] jtimberman: :)
[2012-04-16 14:08:04 -0400] jtimberman: /var/cache/chef/cookbooks/nodejs/attributes/default.rb:20:in `from_file'
[2012-04-16 14:23:38 -0400] dbgster: simple question, but when modifying a cookbook, do you guys actually modify the attributes files or is it possible to make changes elsewhere so as to keep the actual cookbook files unmodified?
[2012-04-16 14:23:48 -0400] dbgster: (modifying an attribute)
[2012-04-16 14:24:26 -0400] sampikesley: https://github.com/pikesley/learn-yourself-some-chef/wiki/Understanding-attributes
[2012-04-16 14:25:23 -0400] dbgster: thanks
[2012-04-16 14:25:44 -0400] sampikesley: so yeah, leave the cookbook untouched it you can
[2012-04-16 14:31:17 -0400] specialsauce: dbgster: i do everything in an environment file. i map vars in the templates etc to attributes that I have defaults for but then override at the env level
[2012-04-16 14:31:23 -0400] specialsauce: that seems to work pretty well
[2012-04-16 14:31:52 -0400] dbgster: i'm using chef-solo in case that effects things.
[2012-04-16 14:32:14 -0400] specialsauce: not sure, i'm using chef server
[2012-04-16 14:32:40 -0400] sampikesley: same difference
[2012-04-16 14:32:43 -0400] spyvsspy: sampikeesley, thanks for that link
[2012-04-16 14:32:50 -0400] spyvsspy: was looking for something just like that
[2012-04-16 14:32:53 -0400] sampikesley: avoid mailing things into cookbooks
[2012-04-16 14:33:01 -0400] sampikesley: *nailing
[2012-04-16 14:34:00 -0400] specialsauce: the exception to that rule i've found so far is search, which doesn't work in an env context
[2012-04-16 14:34:32 -0400] sampikesley: no, but it's cool to drive that from a recipe
[2012-04-16 14:34:38 -0400] dbgster: confused, with chef-solo, is there a way to pass it environments?  do I set a path in my config file similar to the path for roles?
[2012-04-16 14:35:00 -0400] upayavira: specialsauce: Upayavira wanders quietly into a corner
[2012-04-16 14:35:20 -0400] upayavira: Finally found a log file that said
[2012-04-16 14:35:30 -0400] upayavira: "out of disk space"!!
[2012-04-16 14:36:08 -0400] upayavira: Moved some stuff, restarted (a few times) and knife is now back as I would want it
[2012-04-16 14:36:14 -0400] specialsauce: dbgster: with chef server at least, you just set the environment in the node file, i'd check the man page for if it works the same with chef solo but assume so
[2012-04-16 14:36:21 -0400] specialsauce: upayavira: result :-)
[2012-04-16 14:36:23 -0400] upayavira: specialsauce: so thanks for your help!
[2012-04-16 14:36:26 -0400] upayavira: exactly
[2012-04-16 14:37:38 -0400] dbgster: ok their is an 'environment' that I can set similar to file_cach_path etc.: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings#ChefConfigurationSettings-environment
[2012-04-16 14:38:00 -0400] specialsauce: that's the one
[2012-04-16 14:38:19 -0400] specialsauce: then you just need an environment/[environmentname].rb file with your attrs etc
[2012-04-16 14:38:26 -0400] dbgster: so basically the idea is, set my attributes their for all my recipes, and it has high precedence right?
[2012-04-16 14:38:45 -0400] specialsauce: there's 10 levels of precedence but env is pretty high and overrides recipe defaults yes
[2012-04-16 14:38:54 -0400] sampikesley: role, then env generally
[2012-04-16 14:39:51 -0400] specialsauce: this is where i'm a heretic i think, i've not found a use yet for role attrs :-P
[2012-04-16 14:40:06 -0400] BryanWB: specialsauce: wait 10 minutes ;)
[2012-04-16 14:40:28 -0400] specialsauce: heh
[2012-04-16 14:44:02 -0400] sampikesley: the data bag shall be considered the repository of truth
[2012-04-16 14:44:58 -0400] dbgster: strange, I added the environment in my solo.rb, now I'm getting: Chef::Exceptions::PrivateKeyMissing: I cannot read /etc/chef/client.pem, which you told me to use to sign requests!
[2012-04-16 14:45:11 -0400] dbgster: maybe enviornemtns don't work with chef-solo
[2012-04-16 14:47:38 -0400] jtimberman: dbgster: they don't. environments are a way to enforce cookbook version constraints for clients.
[2012-04-16 14:48:06 -0400] jtimberman: dbgster: with solo, you distribute all the cookbooks to the node yourself
[2012-04-16 14:48:16 -0400] dbgster: jtimberman: k got it.  btw, I think the apt cookbook is broken, at least in chef-solo
[2012-04-16 14:48:27 -0400] jtimberman: how so?
[2012-04-16 14:48:43 -0400] dbgster: when I add it, w/o even referencing it, i get this constant Apt type error.
[2012-04-16 14:49:06 -0400] jtimberman: to your earlier query about modifying attributes from a cookbook's attributes file, you could do that in solo w/ a role.
[2012-04-16 14:49:11 -0400] dbgster: i thought I needed it for the mongodb cookbook, as it says it depends on it, but it actually works w/o it (at least for the default mongo).
[2012-04-16 14:49:26 -0400] sampikesley: mongo adds its own repo, doesn't it?
[2012-04-16 14:49:29 -0400] dbgster: jtimberman: ah ok, i'll do that.
[2012-04-16 14:49:44 -0400] dbgster: let me download the apt again and post the error I get.
[2012-04-16 14:50:13 -0400] jtimberman: the apt cookbook is used in the mongodb cookbook for the apt_repository LWRP in the 10gen_repo recipe
[2012-04-16 14:51:16 -0400] dbgster: so downloaded apt, shipped the updated chef repo to my server, ran chef-solo again and now I geT: [Mon, 16 Apr 2012 14:50:50 +0000] FATAL: NameError: wrong constant name Apt.Repository
[2012-04-16 14:51:49 -0400] dbgster: http://pastebin.com/A2D6CJ9V
[2012-04-16 15:01:59 -0400] jtimberman: what is your run list?
[2012-04-16 15:02:13 -0400] jtimberman: and what version of the apt cookbook do you have?
[2012-04-16 15:07:34 -0400] dbgster: jtimberman: just downloaded, so the latest. my run list worked w/o apt.
[2012-04-16 15:07:48 -0400] dbgster: i just added it to give you the error I was seeing.
[2012-04-16 15:08:25 -0400] dbgster: so to me it seems like the error is in the cookbook, not a cookbook requiring apt.  unless a cookbook has an alternative execution path if it detects apt wasn't sintalled
[2012-04-16 15:08:47 -0400] dbgster: "recipe[build-essential]", "recipe[ohai]", "recipe[runit]", "recipe[openssl]", "recipe[git]" and "recipe[nginx]" , "recipe[redis]", "recipe[mysql::server]", "recipe[mysql::client]", "recipe[mongodb]"
[2012-04-16 15:14:06 -0400] BryanWB: can the logrotate_app definition handle file globs?
[2012-04-16 15:16:45 -0400] jtimberman: dbgster: With that run list, and the cookbooks downloaded from the community site, it seems to be working for me.
[2012-04-16 15:17:53 -0400] dbgster: jtimberman: hmm I'm on ubunto 10.10 ruby 1,8.7
[2012-04-16 15:18:10 -0400] dbgster: fresh ec2 instance
[2012-04-16 15:19:33 -0400] dbgster: jtimberman: when I delete the apt folder in my cookbooks dir, it works fine.
[2012-04-16 15:22:53 -0400] jtimberman: dbgster: when you said "downloaded" - how did you download?
[2012-04-16 15:23:31 -0400] dbgster: i went to http://community.opscode.com/cookbooks/apt, clicked on download, extracted to my cookbooks
[2012-04-16 15:24:10 -0400] jtimberman: ok :)
[2012-04-16 15:24:26 -0400] jtimberman: I do not know why you're getting that error.
[2012-04-16 15:27:35 -0400] dbgster: jtimberman: k, i even killed the vm and started a new one, and still get it.
[2012-04-16 15:27:56 -0400] rgsteele: Is it possible to get 'knife bootstrap' to perform a chroot prior to installing all the gems and doing the other prep-work for chef-client?
[2012-04-16 15:32:48 -0400] dwhsix: hey chefians  if I'm already using a data bag, but want to use an encrypted data bag for credentials, am I better off making the existing one encrypted or adding a second one just for encrypted items?
[2012-04-16 15:33:16 -0400] sampikesley: enctypting it all might make things tidier
[2012-04-16 15:34:06 -0400] jbz: dwhsix: Less upfront work adding a separate data bag, but as sampikesley says, probably tidier if it's all in one bag.  However, if you do a lot of searching around in your existing data bag, encrypting it makes that a PITA.
[2012-04-16 15:34:26 -0400] dwhsix: sampikesley: except now that I think about it I think sep'te might be better having to deal with EVERY value being encrypted sounds like a serious PITA
[2012-04-16 15:34:34 -0400] dwhsix: like jbz sez...
[2012-04-16 15:40:33 -0400] rgsteele: I have FAI (Debian-based automated system installer) installing the bare bones stuff (e.g., the operating system), and then Chef doing the rest.  But, the wait FAI works, the client PXE boots & mounts a configuration space, and the actual target system is in a chroot at /target.  So, if you SSH to the node during the install process, you end up in the config space, not the target system.
[2012-04-16 15:42:18 -0400] rgsteele: The only stumbling block is the bootstrap command, as I don't see any way of specifying a chroot, unlike the 'knife ssh' bit where you're providing a chef-client command that can be prefixed with 'chroot /target ...'
[2012-04-16 15:42:55 -0400] jbz: rgsteele:  The bootstrap command relies on scripts, which can be found here:  https://github.com/opscode/chef/tree/master/chef/lib/chef/knife/bootstrap
[2012-04-16 15:43:07 -0400] jbz: I don't know if they're amenable to chrooting, though.
[2012-04-16 15:43:49 -0400] Urocyon: argh! trying to make use of some infochimp cookbooks, and running into problems where the cookbook requires ruby 1.9 to run.
[2012-04-16 15:43:55 -0400] Urocyon: :[(
[2012-04-16 15:44:35 -0400] rgsteele: Yeah, I saw that - I just didn't want to go down the path of modifying knife locally, and don't have time on my current project to make commits upstream.  Perhaps in my free time (if I ever get some; I hear it's nice).
[2012-04-16 15:45:37 -0400] jbz: rgsteele:  you could just write a chroot script and see if that works, if it does, you just have to add the file.
[2012-04-16 15:46:07 -0400] jbz: But, yes, free time, mythical beast.
[2012-04-16 15:48:47 -0400] rgsteele: Unfortunately, I'm not familiar enough with Chef's bootstrapping process to just write a script and know what it needs in 10 minutes.  It doesn't look difficult, but I don't know what kind of rabbit hole it could turn in to.  Guess I'll have to do the hacky rc.local approach for now :-/
[2012-04-16 16:12:44 -0400] Urocyon: So, is there an official way to make knife bootstrap servers with ruby 1.9 instead of 1.8?
[2012-04-16 16:13:27 -0400] issackelly: env_run_lists "prod" => ["recipe[apache2]"], "staging" => ["recipe[apache2::staging]"]
[2012-04-16 16:13:42 -0400] issackelly: So that is a hash right? I'm trying to figure out the syntax rules for variables, hashes, and whitespace and I'm not entirely sure what that does (the context is the chef DSL)
[2012-04-16 16:14:03 -0400] issackelly: and I'm not sure if there is a difference between the ruby language and the chef DSL
[2012-04-16 16:18:44 -0400] jtimberman: Urocyon: as in an "Official Opscode Recommended Way"?
[2012-04-16 16:19:13 -0400] Urocyon: I'd just settle for a recommended way.
[2012-04-16 16:19:15 -0400] jtimberman: Urocyon: "Use the full stack installer; the bootstrap template is available in the source and will be available in the next release of chef (0.10.10)"
[2012-04-16 16:19:18 -0400] jtimberman: :)
[2012-04-16 16:19:44 -0400] jtimberman: the full stack installation has ruby 1.9 included, but it is there for *chef* use, not general application use.
[2012-04-16 16:19:45 -0400] Urocyon: I'm using knife to bootstrap ec2 instances.
[2012-04-16 16:20:15 -0400] Urocyon: But I have a couple of infochimp cookbooks I'm trying out that have 1.9 only syntax in them.
[2012-04-16 16:20:29 -0400] jtimberman: the full stack installer bootstrap template is here: https://github.com/opscode/chef/tree/master/chef/lib/chef/knife/bootstrap/chef-full.erb
[2012-04-16 16:20:49 -0400] jtimberman: you can download that to .chef/bootstrap
[2012-04-16 16:20:58 -0400] jtimberman: then use -d chef-full
[2012-04-16 16:23:05 -0400] Urocyon: I'm giving it a try now, jtimberman.
[2012-04-16 16:33:02 -0400] ssd7: Ohai Chefs!
[2012-04-16 16:34:53 -0400] BryanWB_: ssd7, ohai!
[2012-04-16 16:36:10 -0400] afallows: { "to" : "ssd7", "message" : "ohai" }
[2012-04-16 16:41:06 -0400] ssd7: :)  Heya BryanWB_ and afallows
[2012-04-16 16:43:03 -0400] qhartman: How can I test if a node has a particular role in a recipe?
[2012-04-16 16:45:42 -0400] jbz: qhartman: You can access the current runlist with node.run_list
[2012-04-16 16:45:51 -0400] jbz: and check to see if the role is in there.
[2012-04-16 16:46:01 -0400] jbz: (that should be an array of runlist items I think)
[2012-04-16 16:46:17 -0400] jbz: Note that that's not an attribute
[2012-04-16 16:46:34 -0400] |shad0w|: node.roles should have just roles
[2012-04-16 16:46:41 -0400] jbz: |shad0w| for the win!
[2012-04-16 16:47:47 -0400] sampikesley: More DRY every day...
[2012-04-16 16:48:09 -0400] |shad0w|: hmm, could be wrong on that
[2012-04-16 16:48:33 -0400] |shad0w|: nope, appears to be there
[2012-04-16 16:48:39 -0400] |shad0w|: knife was being silly
[2012-04-16 16:50:07 -0400] |shad0w|: run_list will only be what is configured in the run list, won't include other included roles or recpes
[2012-04-16 16:53:43 -0400] qhartman: so, should ' if node[:roles][:role_name]? then ... end' work to execute code if only the role "role_name" is included on the node? (<- is a ruby noob)
[2012-04-16 17:21:05 -0400] Brad_K: hmm.  ruby noob == rooby?  nuby?  i wonder.
[2012-04-16 17:21:47 -0400] Brad_K: or maybe roob?  that would lend new meaning to the term "roob goldberg" design.
[2012-04-16 17:25:53 -0400] dwhsix: except it's "rube goldberg" ;-) http://en.wikipedia.org/wiki/Rube_goldberg
[2012-04-16 17:26:10 -0400] sampikesley: Or Heath-Robinson
[2012-04-16 17:27:03 -0400] rgsteele: Can you bootstrap in a 'pull' direction, as opposed to 'push'?
[2012-04-16 17:32:49 -0400] blah1: hey all.  i've been trying to install chef-server using the bootstrap method on your wiki but I get the following error when I run the chef-solo cmd:
[2012-04-16 17:32:49 -0400] blah1: ~# chef-solo -c /etc/chef/solo.rb -j /root/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
[2012-04-16 17:32:50 -0400] blah1: [Mon, 16 Apr 2012 17:32:41 +0000] INFO: Starting Chef Solo Run
[2012-04-16 17:32:50 -0400] blah1: [Mon, 16 Apr 2012 17:32:42 +0000] INFO: Replacing the run_list with ["recipe[chef-server::rubygems-install]"] from JSON
[2012-04-16 17:32:51 -0400] blah1: /usr/lib/ruby/1.8/chef/mixin/language_include_attribute.rb:45:in `include_attribute': undefined method `[]' for nil:NilClass (NoMethodErro
[2012-04-16 17:36:57 -0400] miah: moin
[2012-04-16 17:37:56 -0400] afallows: Has anyone else run into an issue where role[role_name] gets converted to recipe[roles] somewhere down the chain? I just bootstrapped an EC2 instance and when it got to the chef run it said "INFO: Run List is [recipe[roles]]"
[2012-04-16 17:38:05 -0400] dbgster: jtimberman: seems like someone else had the same Apt.Repository issue (moses): http://logs.likens.us/2012/%23chef.02-04.12.log
[2012-04-16 17:38:13 -0400] afallows: But I invoked it with -r role[role_name]
[2012-04-16 17:38:45 -0400] blah1: dbgster, is that related to my prob?
[2012-04-16 17:39:23 -0400] dbgster: blah1: no it is related to mine
[2012-04-16 17:42:13 -0400] UDay: Hello Everyone..I am new to Chef..and have a quick question
[2012-04-16 17:42:33 -0400] |shad0w|: preheat to 375
[2012-04-16 17:43:58 -0400] UDay: Even though no changes to cookbook..chef-client on my web server restarts web server every time it checks for cookbook updates
[2012-04-16 17:44:22 -0400] UDay: Can anyone help how to avoid that..and restart web server only when there is a change in cookbook?
[2012-04-16 17:44:29 -0400] |shad0w|: pastebin a run?
[2012-04-16 17:45:08 -0400] UDay: Is this the right forum to ask these questions?
[2012-04-16 17:45:46 -0400] afallows: UDay: You're in the right place. :)
[2012-04-16 17:45:53 -0400] |shad0w|: can you pastebin the output of a chef-client run?
[2012-04-16 17:47:21 -0400] UDay: Ishad0Wl...is that question for me? do you want my chef-client output?
[2012-04-16 17:47:50 -0400] |shad0w|: yes
[2012-04-16 17:51:38 -0400] UDay: Sun, 15 Apr 2012 23:18:27 -0500] INFO: *** Chef 0.10.8 ***
[2012-04-16 17:51:39 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Run List is [role[ApacheWebServer]]
[2012-04-16 17:51:42 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Run List expands to [apache2, apache2::mod_ssl, apache2::mod_expires, apache2::mod_alias, apache2::mod_deflate, apache2::mod_proxy_balancer]
[2012-04-16 17:51:43 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Starting Chef Run for xyz
[2012-04-16 17:51:44 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Running start handlers
[2012-04-16 17:51:46 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Start handlers complete.
[2012-04-16 17:51:48 -0400] UDay: [Sun, 15 Apr 2012 23:18:28 -0500] INFO: Loading cookbooks [apache2]
[2012-04-16 17:51:48 -0400] jaimef:  /exec -o yes
[2012-04-16 17:51:49 -0400] |shad0w|: pastebin it
[2012-04-16 17:51:49 -0400] UDay: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: Processing package[apache2] action install (apache2::default line 20)
[2012-04-16 17:51:51 -0400] UDay: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: Processing service[apache2] action enable (apache2::default line 25)
[2012-04-16 17:51:53 -0400] UDay: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: Processing directory[/etc/apache2/ssl] action create (apache2::default line 134)
[2012-04-16 17:51:54 -0400] UDay: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: Processing directory[/etc/apache2/conf.d] action create (apache2::default line 141)
[2012-04-16 17:51:56 -0400] |shad0w|: pastebin?
[2012-04-16 17:51:56 -0400] bawt: pastebin is weird, but: http://pastebin.com/diff.php?i=26sbZeEr
[2012-04-16 17:52:01 -0400] |shad0w|: meh
[2012-04-16 17:52:10 -0400] |shad0w|: bawt forget pastebin
[2012-04-16 17:52:10 -0400] bawt: okay then :)
[2012-04-16 17:52:25 -0400] |shad0w|: bawt pastebin is https://gist.github.com/
[2012-04-16 17:54:27 -0400] afallows: UDay: Copy your chef-client run into a gist at gist.github.com and post the link here. It's much easier to manage that way.
[2012-04-16 17:54:32 -0400] qhartman: ok, so for my testing for the presence of a role question earlier, one of my local Ruby nerds answered it for me: 'if !node.roles.include?("role_name") ...' will do it
[2012-04-16 17:55:22 -0400] UDay: k
[2012-04-16 17:55:24 -0400] UDay: git@gist.github.com:883eb564b7e48197ae54.git
[2012-04-16 17:55:54 -0400] |shad0w|: i think we'd rather have the http link to it UDay
[2012-04-16 17:55:55 -0400] UDay: Just did that
[2012-04-16 17:56:07 -0400] afallows: https://gist.github.com/883eb564b7e48197ae54
[2012-04-16 17:56:21 -0400] UDay: https://gist.github.com/883eb564b7e48197ae54
[2012-04-16 17:56:25 -0400] |shad0w|: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: execute[a2enmod cgi] sending restart action to service[apache2] (delayed)
[2012-04-16 17:56:34 -0400] |shad0w|: that command resource is doing it
[2012-04-16 17:58:26 -0400] UDay: Restart should happen only if there is a change in cookbook..but looks like it is doing every time it runs to check updates
[2012-04-16 17:58:48 -0400] |shad0w|: that resource has a notify in it, and it is executing
[2012-04-16 17:59:00 -0400] |shad0w|: if you don't want it to you should do an only if or not if in the resource
[2012-04-16 17:59:15 -0400] |shad0w|: only_if?
[2012-04-16 17:59:15 -0400] bawt: only_if is http://wiki.opscode.com/display/chef/Resources#Resources-Meta
[2012-04-16 18:00:02 -0400] |shad0w|: idempotent?
[2012-04-16 18:01:42 -0400] |shad0w|: bawt idempotent is http://wiki.opscode.com/display/chef/Glossary#Glossary-Idempotent
[2012-04-16 18:01:44 -0400] |shad0w|: idempotent?
[2012-04-16 18:01:44 -0400] bawt: idempotent is http://wiki.opscode.com/display/chef/Glossary#Glossary-Idempotent
[2012-04-16 18:02:39 -0400] tomoj: apache_module already includes a not_if, it must not be working properly on your system?
[2012-04-16 18:02:45 -0400] pcn: If I want to notify a service setup with runit_service, what do I send the notify to?  E.g. notifies :restart, services["tinydns"]?  or is there some other namespace for runit services?
[2012-04-16 18:03:31 -0400] tomoj: mine checks that mods-enabled/module.load is a symlink, that mods-available/module.conf exists, and that mods-enabled/module.conf is a symlink
[2012-04-16 18:21:46 -0400] flagg0204: anyone here using ubuntu juju with chef? i.e. charms which use chef cookbooks?
[2012-04-16 18:22:16 -0400] pcn: Ah, got it.  "service[tinydns]" works, but I always forget the quotes in the second arg to notifies
[2012-04-16 18:25:00 -0400] BryanWB_: flagg0204, i m not aware of anyone doing so but i guess it's possilbe
[2012-04-16 18:25:34 -0400] BryanWB_: flagg0204, what interests you about juju? i am not trolling but genuinely curious
[2012-04-16 18:25:37 -0400] miah: wow late night BryanWB_ ?
[2012-04-16 18:25:45 -0400] BryanWB_: miah, a little bit ;)
[2012-04-16 18:27:00 -0400] flagg0204: BryanWB_: its the orchestration part that interests me the most.
[2012-04-16 18:27:21 -0400] BryanWB_: flagg0204, i will have to look at that
[2012-04-16 18:27:39 -0400] miah: i haven't really taken a serious look at juju yet
[2012-04-16 18:29:30 -0400] flagg0204: miah: it looks promising, but im having a hard time figuring out how you would seperate juju charms and chef cookbooks.  most examples handle installing and configuring an application.   I like the orchestration and relastionships part.
[2012-04-16 18:30:10 -0400] BryanWB_: flagg0204, hmm, i guess i dont' see what juju does that ironfan or really skilled use of knife don't
[2012-04-16 18:30:22 -0400] BryanWB_: but again i haven't looked at it that closely
[2012-04-16 18:30:26 -0400] flagg0204: BryanWB_: huh not familiar with ironfan
[2012-04-16 18:30:27 -0400] TheBeast: anyone using the firewall+ufw cookbooks on ubuntu?
[2012-04-16 18:30:42 -0400] terryjfundak: flagg0204: Have you prototypes anything yet or are you just getting started?
[2012-04-16 18:30:46 -0400] BryanWB_: flagg0204, ironfan is the best shit evar, just not well documented
[2012-04-16 18:30:53 -0400] flagg0204: terryjfundak: just getting started
[2012-04-16 18:31:19 -0400] BryanWB_: flagg0204, https://github.com/infochimps-labs
[2012-04-16 18:31:45 -0400] flagg0204: BryanWB_: hmm ill take a look at that too
[2012-04-16 18:32:54 -0400] hoover_damn: hope you work for em
[2012-04-16 18:32:54 -0400] hoover_damn: heh
[2012-04-16 18:33:26 -0400] BryanWB_: hoover_damn, infochimps? nope, that would require moving
[2012-04-16 18:33:44 -0400] BryanWB_: who should i bring on a testing show for foodfight?
[2012-04-16 18:37:11 -0400] flagg0204: BryanWB_: regarding ironfan, they say things like "Service discovery" and "anoucement" is that using something like zookeepr on the backend, or is it all chef-server
[2012-04-16 18:37:23 -0400] BryanWB_: flagg0204, nothing but chef-server
[2012-04-16 18:37:30 -0400] flagg0204: i like that part
[2012-04-16 18:37:34 -0400] BryanWB_: flagg0204, and it works well for them
[2012-04-16 18:38:20 -0400] BryanWB_: i think zookeeper is a very interest technology but it will take a fair amount of work to really adapt it to the problem of service orchestration
[2012-04-16 18:39:25 -0400] BryanWB_: flagg0204, there is github.com/lusis/noah but I don't know how much time the maintainer puts into it or how many people use it
[2012-04-16 18:40:51 -0400] miah: lusis is going to be speaking about it at chefconf
[2012-04-16 18:41:03 -0400] miah: people do use zookeeper for orchestration now
[2012-04-16 18:42:50 -0400] BryanWB_: miah, talking aobut noah?  i feared that he had shifted his focus to logstash
[2012-04-16 18:44:50 -0400] UDay: what condition should only_if or no_if check for...as I am looking for a way to know if anything in cookbook changed...any help for the condition to check..?
[2012-04-16 18:46:29 -0400] BryanWB_: UDay, if a file exists, if a user exists, if a process is in the process table
[2012-04-16 18:46:59 -0400] |shad0w|: UDay, it depends on what your resource is doing and how you want to determine idempotency
[2012-04-16 18:48:09 -0400] UDay: My situation is simple...Chef-Client to process a change in cookbook process it and restart the server..if no change in cookbook don't restart the server
[2012-04-16 18:48:50 -0400] |shad0w|: change in the cookbook has no bearing on change/execution of a resource
[2012-04-16 18:49:01 -0400] BryanWB_: UDay, u want to look at notifies and subscribes
[2012-04-16 18:49:40 -0400] |shad0w|: BryanWB, he has an execute resource with a notify that is triggering every time and restarting his service
[2012-04-16 18:49:45 -0400] UDay: My issue..is how to determine if Chef-client has processed change which requires server to restart
[2012-04-16 18:49:56 -0400] |shad0w|: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: execute[a2enmod cgi] sending restart action to service[apache2] (delayed)
[2012-04-16 18:49:57 -0400] jtimberman: UDay: [Sun, 15 Apr 2012 23:18:29 -0500] INFO: execute[a2enmod cgi] sending restart action to service[apache2] (delayed)
[2012-04-16 18:49:59 -0400] hoover_damn: BryanWB_, why does working for someone require moving?
[2012-04-16 18:50:01 -0400] |shad0w|: go look at that execute resource
[2012-04-16 18:50:09 -0400] hoover_damn: BryanWB_, I guess i'm silly but I find the brain to be useful
[2012-04-16 18:50:11 -0400] jtimberman: that execute resource is in the apache_module definition.
[2012-04-16 18:50:11 -0400] |shad0w|: and make it idempotent in whatever way makes sense for it
[2012-04-16 18:50:14 -0400] hoover_damn: the body rarely does anything significant
[2012-04-16 18:50:19 -0400] jtimberman: does that execute get run every time chef-client runs?
[2012-04-16 18:50:30 -0400] |shad0w|: jtimberman, it would appear so
[2012-04-16 18:50:35 -0400] BryanWB_: hoover_damn, +1 also not a fan of meatspace
[2012-04-16 18:50:38 -0400] hoover_damn: BryanWB_, just like an NDA can break your ability to work, so can having to relocate
[2012-04-16 18:50:58 -0400] hoover_damn: BryanWB_, no employer can hire all the talent they want in a central location anymore anyway
[2012-04-16 18:51:08 -0400] hoover_damn: BryanWB_, so if an employer is not willing to telecommunicate
[2012-04-16 18:51:13 -0400] hoover_damn: then they are not worth my time
[2012-04-16 18:51:25 -0400] BryanWB_: hoover_damn, but companies w/out any remote workers often won't do well w/ everyone local and 1 person remote
[2012-04-16 18:51:34 -0400] BryanWB_: hoover_damn, and i agree w/ u 100%
[2012-04-16 18:52:15 -0400] hoover_damn: BryanWB_, I disagree
[2012-04-16 18:53:12 -0400] hoover_damn: BryanWB_, 1 person remote shouldn't make a difference really provided the communication is good
[2012-04-16 18:53:22 -0400] hoover_damn: BryanWB_, if the 1 person remote causes issues, then there isn't good communication
[2012-04-16 18:53:41 -0400] hoover_damn: BryanWB_, most of the excuses for an employee 'has to be in the office' are not worth the paper they were printed on... (if they were printed)
[2012-04-16 18:54:01 -0400] hoover_damn: care about what they do, how they do it and how they don't screw up... and not how pretty they are
[2012-04-16 19:02:16 -0400] hoover_damn: it's hard enough finding talent, let alone good talent... so if you have to sacrifice the office do it
[2012-04-16 19:05:29 -0400] rgsteele: jbz: Hooray, got it working with the custom knife bootstrap script :)
[2012-04-16 19:08:51 -0400] jtimberman: UDay: looks like its because mpm is threaded: Your MPM seems to be threaded. Selecting cgid instead of cgi.
[2012-04-16 19:08:57 -0400] jtimberman: when i run a2enmod cgi
[2012-04-16 19:12:15 -0400] Urocyon: jtimberman: bootstrapping with ruby1.9 seems to be working with the chef-full script.  But now I'm chasing down other problems.  Like the users cookbook no longer being able to find ruby-shadow.
[2012-04-16 19:12:39 -0400] Urocyon: Any tips on configuring systems when using chef-full?
[2012-04-16 19:13:49 -0400] jtimberman: ruby-shadow is only used when user passwords are managed i thought
[2012-04-16 19:14:01 -0400] Urocyon: in this case, I am managing them.
[2012-04-16 19:14:19 -0400] Urocyon: Users installs libshadow, but chef doesn't seem to be picking it up.
[2012-04-16 19:15:18 -0400] |shad0w|: Urocyon, sure it didn't install it to a location other than the chef fullstack location?
[2012-04-16 19:15:56 -0400] Urocyon: users installs the ubuntu libshadow package... so I'm pretty sure it  doesn't install it to the chef fullstack location.
[2012-04-16 19:16:11 -0400] hoover_damn: likely not
[2012-04-16 19:16:27 -0400] hoover_damn: defaults to gem install, which if you have ruby already installed can be the system ruby vs omnibus
[2012-04-16 19:17:31 -0400] Urocyon: hoover_damn: would that mean adding it to the bootstrap chef-full template?
[2012-04-16 19:18:08 -0400] hoover_damn: Urocyon, no I actually build my own omnibus... newer ruby, newer rubygems
[2012-04-16 19:19:09 -0400] Urocyon: hoover_damn: oh, maybe more than I want to manage at ths time.
[2012-04-16 19:19:44 -0400] jtimberman: Urocyon: yeah you should use gem_package to install the ruby-shadow gem.
[2012-04-16 19:20:32 -0400] Urocyon: so, gem_package will install to chef's ruby?
[2012-04-16 19:20:34 -0400] hoover_damn: gem_package with gem_binary as /opt/opscode/embeedded ...
[2012-04-16 19:20:43 -0400] Urocyon: What if I want to install a gem to the system ruby?
[2012-04-16 19:20:47 -0400] Urocyon: ah
[2012-04-16 19:21:13 -0400] jtimberman: https://gist.github.com/2400881
[2012-04-16 19:21:27 -0400] jtimberman: if you want to use the system ruby, then you would use gem_binary
[2012-04-16 19:22:00 -0400] hoover_damn: and blows crap up
[2012-04-16 19:22:47 -0400] hoover_damn: or have knife ssh roles:bob "source /etc/profile && run-this"
[2012-04-16 19:22:48 -0400] hoover_damn: :|
[2012-04-16 19:23:07 -0400] hoover_damn: damn annoying
[2012-04-16 19:47:38 -0400] Urocyon: Argh: FATAL: Gem::Installer::ExtensionBuildError: gem_package[ruby-shadow] (chefruby::users line 11) had an error: Gem::Installer::ExtensionBuildError: ERROR: Failed to build gem native extension.
[2012-04-16 19:48:09 -0400] Urocyon: guess I need that libshadow package in there first.
[2012-04-16 19:49:24 -0400] Urocyon: or maybe my build essentials isn't getting run first....
[2012-04-16 19:49:53 -0400] jtimberman: Urocyon: ah - that recipe i posted does the install during the compile phase, so the build-essentials pakcges would need to exist first.
[2012-04-16 19:49:58 -0400] josephholsten: chefruby::users?
[2012-04-16 19:49:59 -0400] jtimberman: this is a definite chicken/egg problem.
[2012-04-16 19:50:08 -0400] Urocyon: qq
[2012-04-16 19:50:28 -0400] Urocyon: sad urocyon is sad.
[2012-04-16 19:50:32 -0400] SplasPood: 'lo all.   Got an interesting question (I think! ;)) ... I have a number of recipes for distinct things.  Each one of these things requires one or more NFS exports to be setup.   I'm looking for a way to have each one of my custom recipes add stuff to the exports list.   I'm using the nfs cookbook so I can populate stuff in node[:nfs][:mounts] = {} ... but adding a node.set[snip..] = node[:nfs][:mounts].merge( { 'mynew' => 'entry' } ) doesn't seem to be merging my
[2012-04-16 19:55:49 -0400] flagg0204: anyone here using the "Private chef"
[2012-04-16 19:56:03 -0400] SplasPood: flagg0204: yea
[2012-04-16 19:56:06 -0400] jaimef: flagg0204: url?
[2012-04-16 19:56:30 -0400] jtimberman: opscode.com/private-chef
[2012-04-16 19:56:41 -0400] flagg0204: SplasPood: im curious, how many nodes do you have? We are thinking about buying it, but we aremt sure on pricing.
[2012-04-16 19:56:51 -0400] josephholsten: SplasPood: reminds me of the djbdns cookbook's technique of notifying a build-tinydns-data resource
[2012-04-16 19:57:12 -0400] SplasPood: flagg0204: hrm.. not sure of the exact count offhand... couple hundred plus I figure
[2012-04-16 19:57:23 -0400] SplasPood: flagg0204: I let my finance dept figure out $$
[2012-04-16 19:57:26 -0400] |shad0w|: SplasPood, why set it on the node? Just use node.default
[2012-04-16 19:57:27 -0400] Urocyon: SplasPood: the shorewall cookbook does something like this with node.override[:shorewall[:rules] << { additional rule }
[2012-04-16 19:57:34 -0400] SplasPood: |shad0w|: eh?
[2012-04-16 19:57:45 -0400] SplasPood: Urocyon: hrm, override...
[2012-04-16 19:58:03 -0400] Urocyon: SplasPood: can't guarantee that, just no it works with shorewall.
[2012-04-16 19:58:24 -0400] Urocyon: Kind of blows up your defaults though, and I think it has to be done in recipes.
[2012-04-16 19:58:24 -0400] SplasPood: Urocyon: I'll give that a whirl
[2012-04-16 19:58:36 -0400] SplasPood: Urocyon: well default is always going to be an empty set, so that works for me
[2012-04-16 19:59:21 -0400] |shad0w|: if you are are computing something during the run why would you use node.set? it won't go away if you change your logic for computing the value
[2012-04-16 19:59:42 -0400] |shad0w|: then you have trouble setting things in roles and recipes
[2012-04-16 20:00:24 -0400] SplasPood: |shad0w|: Cuz I wanted to set the value on the node?    The node.set call takes the existing attribute value, merges in my additions, and then sets it..
[2012-04-16 20:00:58 -0400] |shad0w|: you'd have to reload the node every time you do that though iirc
[2012-04-16 20:01:03 -0400] Urocyon: Yeah, I couldn't figure out how to add rules in a role and have them accumulate.   I would prefer to put firewall rules.
[2012-04-16 20:01:06 -0400] |shad0w|: ir you want them to be seen at execute time
[2012-04-16 20:01:12 -0400] Urocyon: In roles.
[2012-04-16 20:02:59 -0400] SplasPood: |shad0w|: would they be seen on a 2nd run?
[2012-04-16 20:03:02 -0400] Urocyon: josephholsten: I wanted to have a place to put in bits of code I might need to use to change the embedded version of ruby, so chefruby.
[2012-04-16 20:04:29 -0400] cduv: Hi Chefs, I'm evaluating to use Chef for install my rails stacks. Can you recommend me where I can find a good recipe that uses ruby 1.9.2/3, unicorn, nginx?
[2012-04-16 20:05:11 -0400] |shad0w|: Urocyon, should be. I might not be entirely correct on how node.set works.
[2012-04-16 20:06:08 -0400] afallows: cduv, the community site probably has perfectly suitable individual recipes for each of those, and it would be pretty trivial to put them together with a role or a recipe. http://community.opscode.com/ is a good jumping off point
[2012-04-16 20:06:14 -0400] |shad0w|: but in any event, personally I find it rare that things need to be set directly on the node, defaults and overrides work much better when being "set" for every client running the recipe/role
[2012-04-16 20:07:10 -0400] cduv: thanks afallows, I will take a look again and try to make a good recipe or role
[2012-04-16 20:07:58 -0400] afallows: All you would need in this case is role[server] with run_list: recipe[ruby193],recipe[unicorn],recipe[nginx] - or whatever the exact recipe names are.
[2012-04-16 20:08:22 -0400] afallows: Will get more complicated if you need to tweak the config, but if all you need is to install, that's most of what you'll need.
[2012-04-16 20:08:40 -0400] cduv: ok, thanks again afallows
[2012-04-16 20:24:19 -0400] SplasPood: Urocyon: that worked for me, thanks a bunch!
[2012-04-16 20:44:54 -0400] upayavira: Regular core dumps on /usr/lib/ruby/gems/1.8/gems/chef-0.10.8/bin/../lib/chef/mixin/command/unix.rb:171: [BUG] Segmentation fault
[2012-04-16 20:47:23 -0400] mosiac: is there a listing of error codes for chef somewhere?
[2012-04-16 20:50:47 -0400] jessicab: mosiac - theres this - http://wiki.opscode.com/display/chef/Common+Errors
[2012-04-16 21:00:14 -0400] mosiac: mine is not there its -500
[2012-04-16 21:00:25 -0400] mosiac: but thanks
[2012-04-16 21:00:31 -0400] mosiac: i'm going to continue this tomorrow
[2012-04-16 21:01:51 -0400] Urocyon: Is there a fix yet for the oracle java problem?
[2012-04-16 21:02:02 -0400] jtimberman: Urocyon: what do you mean?
[2012-04-16 21:02:13 -0400] jtimberman: Urocyon: that you can't "wget" the JDK from their site, and have to use a browser?
[2012-04-16 21:02:25 -0400] Urocyon: yep, that.
[2012-04-16 21:02:28 -0400] cduv: Hi Chefs, How can you make to install opscode version the worker version instead of the prefork of Apache?
[2012-04-16 21:02:31 -0400] jtimberman: Nope. Not till Oracle changes their site.
[2012-04-16 21:03:34 -0400] Urocyon: sad.
[2012-04-16 21:03:49 -0400] StormSilver: Isn't the solution to download the JDK, then stick it in your cookbook and have your cookbook fetch the file?
[2012-04-16 21:04:34 -0400] pcn: eah
[2012-04-16 21:04:37 -0400] pcn: Yeah
[2012-04-16 21:05:13 -0400] Urocyon: ah, I see there is a note added to the java cookbook on what to do.
[2012-04-16 21:07:01 -0400] miah: you can get it if you hack around it
[2012-04-16 21:09:54 -0400] matschaffer: so about the omnibus installer. I put in in knife-solo, but one of the folks there had a good point that you can't be sure what version you're going to get https://github.com/matschaffer/knife-solo/pull/40#issuecomment-5160721. Anyone have any thoughts on that? Should folks worried about consistency use their own bootstrap script? And if so how much value is the omnibus installer?
[2012-04-16 21:11:28 -0400] jtimberman: matschaffer: you can download a specific version of the installation package.
[2012-04-16 21:11:57 -0400] jtimberman: matschaffer: all the install.sh script does is determine what the system platform is so it can go pick the package for that platform, based on the version of the script.
[2012-04-16 21:14:18 -0400] jtimberman: matschaffer: the install.sh script can be invoked with "-v VERSION" to specify the version of the package to download.
[2012-04-16 21:14:22 -0400] jtimberman: e.g., install.sh -v 0.10.8-2
[2012-04-16 21:14:44 -0400] jtimberman: or install.sh -v 0.10.6-1
[2012-04-16 21:47:18 -0400] issackelly: a VM that was fine on friday is now giving 401 Unauthorized messages when I run `chef-client` today
[2012-04-16 21:47:38 -0400] issackelly: as far as I know nothing changed
[2012-04-16 21:47:46 -0400] jtimberman: issackelly: did you suspend it and resume it?
[2012-04-16 21:47:53 -0400] |shad0w|: check the time/date on it
[2012-04-16 21:47:55 -0400] jtimberman: issackelly: likely a time synchronization issue if so.
[2012-04-16 21:47:56 -0400] issackelly: yes
[2012-04-16 21:48:01 -0400] jtimberman: sudo ntpdate -u time
[2012-04-16 21:48:01 -0400] issackelly: hm
[2012-04-16 21:48:13 -0400] jtimberman: or ntp.pool.org if you don't have a "time.yourdomain" :)
[2012-04-16 21:48:20 -0400] issackelly: yup! thanks
[2012-04-16 21:48:21 -0400] jtimberman: er, pool.ntp.org.
[2012-04-16 21:50:24 -0400] ssd7: I quit typing sometime in 2009.
[2012-04-16 21:52:36 -0400] StormSilver: jtimberman: Eh, it's almost 4:00... that's good enough.
[2012-04-16 22:03:16 -0400] terryjfundak: issackelly: What is your virtualization platform and what was the guess VM? I hear that jtimberman fixed the issue.... but for future reference.... I have had issues with suspend/resume on servers that are kerberos based....
[2012-04-16 22:04:05 -0400] issackelly: terryjfundak Mac->Parallels->Ubuntu Server 11.10  ::: Supposedly I can install guest tools that will keep it in sync
[2012-04-16 22:04:16 -0400] issackelly: (trying now, but chef-client is working again by updating the date)
[2012-04-16 22:05:00 -0400] laurent\: yep kerberos also needs clocks in sync
[2012-04-16 22:05:47 -0400] terryjfundak: issackelly: That's what I wondered.....Parallels Desktop does not do a good job with timeserver update on restart. I dropped Parallels completely because of that after months of talking to their engineers who couldn't/wouldn't fix it....
[2012-04-16 22:06:23 -0400] terryjfundak: I don't know if the newest version of Parallels fixes this but VMWare Fusion does not have this problem.
[2012-04-16 22:06:35 -0400] issackelly: terryjfundak -- cool, thanks for the heads up, I'd be happy enough to move to virtual box but I already had Parallels installed
[2012-04-16 22:06:41 -0400] issackelly: I'll keep an eye on it
[2012-04-16 22:07:22 -0400] ggolin: oh wait, mac.
[2012-04-16 22:07:45 -0400] issackelly: ggolin I'd be pretty interested in a working kvm on osx :) for a plethora of reasons
[2012-04-16 22:07:57 -0400] issackelly: well.. .ok at least a couple, plethora is a hyperbole
[2012-04-16 22:08:41 -0400] ggolin: i hear ya
[2012-04-16 22:08:47 -0400] |shad0w|: terryjfundak, I don't have issue it Desktop on any of the linux vms I have running with the parallels tools installed, my bsd vm is another story though
[2012-04-16 22:09:03 -0400] terryjfundak: issackelly: The price of Fusion is really trivial .... particularly if you do run into issue. VMWare does very good in the tech support realm. Better than Apple and .....
[2012-04-16 22:09:54 -0400] terryjfundak: My issue with time was Mac Server on Mac Server.... that I used for development.....
[2012-04-16 22:10:44 -0400] terryjfundak: That is a less than 1% case for Parallels..... higher but still small for VMWare Fusion
[2012-04-16 22:14:18 -0400] issackelly: terryjfundak thanks
[2012-04-16 22:17:27 -0400] terryjfundak: issackelly: Just in case.... 10% off till 18 April.... http://store.vmware.com/store/vmware/en_US/DisplayProductDetailsPage/productID.165310200/?SRC=EM_Q2_2012_FUSION4_SPRING_BUY_NOW&resid=sZ0C7goBAlYAACZHxx4AAAAt&rests=1334614570864 and no I don't work for them...
[2012-04-16 22:18:34 -0400] terryjfundak: Oops.....did I break a irc protocol rule..... sorry....
[2012-04-16 22:29:19 -0400] cwj: a whole 10%!
[2012-04-16 22:29:40 -0400] cwj: i am still sore at them for not offering an upgrade price from 3 to 4
[2012-04-16 22:31:30 -0400] terryjfundak: cwj: I understand but a solid product and at less than a hours wage..... well .... and solid tech support in 2012.... great deal.....my opinion.....
[2012-04-16 22:31:47 -0400] cwj: sure
[2012-04-16 22:32:00 -0400] cwj: i just reserve the right to be sore about it
[2012-04-16 22:32:08 -0400] cwj: i also havent found a compelling reason to upgrade
[2012-04-16 22:32:08 -0400] terryjfundak: :-)
[2012-04-16 22:32:17 -0400] cwj: so i guess that says something about fusion 3
[2012-04-16 22:32:44 -0400] terryjfundak: fusion 3 is solid.... on Lion..... fusion 4 is better
[2012-04-16 22:36:07 -0400] jtimberman: if you use vmware fusion, you might be interested in the fission gem.
[2012-04-16 22:36:38 -0400] jtimberman: http://jtimberman.housepub.org/blog/2012/02/15/testing-with-fission/
[2012-04-16 22:37:07 -0400] terryjfundak: +1
[2012-04-16 22:37:30 -0400] terryjfundak: jtimberman: Thanx for that.....
[2012-04-16 22:39:06 -0400] jtimberman: you're welcome :)
[2012-04-16 23:12:22 -0400] aslan: hey guys ... if i am able to successfully save something to the data bag but when i try to show it its not there what could be the reason?
[2012-04-16 23:20:33 -0400] aslan: anyone?
[2012-04-16 23:23:13 -0400] aslan: :/
[2012-04-16 23:25:05 -0400] hoover_damn: aslan, solr is bust?
[2012-04-16 23:25:13 -0400] aslan: rats
[2012-04-16 23:25:23 -0400] aslan: i just saw that
[2012-04-16 23:25:26 -0400] hoover_damn: aslan, when you update a data bag or node... chef-expander typically will get a message in rabbitmq from chef-server-api saying please update the index
[2012-04-16 23:25:29 -0400] aslan: thanks
[2012-04-16 23:25:54 -0400] aslan: hoover_damn: and when solr is not working properly it fails to save those
[2012-04-16 23:25:59 -0400] aslan: i guess
[2012-04-16 23:26:16 -0400] aslan: index i mean
[2012-04-16 23:26:33 -0400] hoover_damn: right you can save them to couchdb
[2012-04-16 23:26:36 -0400] hoover_damn: but when you search
[2012-04-16 23:26:39 -0400] hoover_damn: it's different
[2012-04-16 23:27:13 -0400] aslan: thanks... i guess i have to go restart solr and maybe reindex
[2012-04-16 23:28:26 -0400] hoover_damn: restart the expander
[2012-04-16 23:45:22 -0400] ben__927: ohai!
[2012-04-16 23:46:07 -0400] benjoldersma: is it possible to view the computed node attributes (from environment, role, recipe, etc.)?
[2012-04-16 23:47:06 -0400] ggolin: benjoldersma, what are you trying to achieve?
[2012-04-16 23:48:07 -0400] benjoldersma: our SEO staff would like to be able to view the diffs between two environments, as a way of preparing to deploy from say, staging to prod.
[2012-04-16 23:48:41 -0400] benjoldersma: so they want to (relatively) easily see the fully computed configuration of a given environment
[2012-04-16 23:48:51 -0400] hoover_damn: jsondiff?
[2012-04-16 23:49:01 -0400] benjoldersma: ggolin, also, fyi, we aren't using chef at the moment, we're evaluating
[2012-04-16 23:49:12 -0400] benjoldersma: hoover_damn: is that a chef feature?
[2012-04-16 23:49:26 -0400] hoover_damn: nevermind I said anything
[2012-04-16 23:50:51 -0400] ggolin: benjoldersma, your search engine optimization team wants to view the diff between two environments as a way of deployment preparation.
[2012-04-16 23:51:00 -0400] bemu: benjoldersma: You'll need to define more specifically what you're looking for. What 'diffs'?
[2012-04-16 23:51:18 -0400] benjoldersma: sorry, SEO is service engineering and operations.
[2012-04-16 23:51:20 -0400] benjoldersma: well
[2012-04-16 23:51:23 -0400] ggolin: ah, better
[2012-04-16 23:51:36 -0400] benjoldersma: :)
[2012-04-16 23:51:50 -0400] ggolin: well they could, for example, look at the role definitions or at the enironment definitions
[2012-04-16 23:52:11 -0400] ggolin: benjoldersma, what do your engineers wish to learn about the environment?
[2012-04-16 23:52:16 -0400] benjoldersma: bemu: an example is a new application key is required, and sometimes it's hard to figure out that there is a new configuration value that needs to be defiend for an env
[2012-04-16 23:52:32 -0400] benjoldersma: right, they could do version control diffs of the environment or role files
[2012-04-16 23:53:14 -0400] benjoldersma: but, if there was a way to view the computed node json, that chef-client generates, they could conceivably diff those files
[2012-04-16 23:53:21 -0400] ggolin: in terms of 'whats on the node right now' you can ask knife node edit or knife node show, etc
[2012-04-16 23:53:35 -0400] benjoldersma: not necessarily with a machine diff, if the JSON format is variable, but at least a good old manual diff
[2012-04-16 23:53:36 -0400] bemu: Yes, you could do that.
[2012-04-16 23:53:43 -0400] benjoldersma: ggolin: that sounds perfect
[2012-04-16 23:54:13 -0400] ggolin: benjoldersma, this of course assuming you have the chef-client running periodically and nobody is changing anything by hand
[2012-04-16 23:54:39 -0400] benjoldersma: ggolin: of course, that can be safely assumed.
[2012-04-16 23:54:46 -0400] ggolin: one would think
[2012-04-16 23:54:52 -0400] ggolin: :)
[2012-04-16 23:54:54 -0400] bemu: The tools you likely need are there, but will require some additional work to get the output you're looking for, probably.
[2012-04-16 23:55:04 -0400] benjoldersma: so i just ran knife node show on a node in my test setup, but i dont see the computed attributes.
[2012-04-16 23:55:18 -0400] benjoldersma: bemu: okay, that's cool. i'll mark it as such in my doc
[2012-04-16 23:55:18 -0400] bemu: It's a prettied version.
[2012-04-16 23:55:22 -0400] ggolin: what exactly do you want to see?
[2012-04-16 23:55:46 -0400] bemu: You can pass params to change the output
[2012-04-16 23:56:15 -0400] benjoldersma: i think they would like to see a JSON block like you see in the console, for environments or roles, but just see the fully computed node values, after all environment, role, recipe precedence rules have been applied
[2012-04-16 23:56:24 -0400] benjoldersma: bemu: of knife show?
[2012-04-16 23:56:30 -0400] ggolin: benjoldersma, knife node show -a ipaddress node.fqdn
[2012-04-16 23:56:32 -0400] ggolin: try that
[2012-04-16 23:56:50 -0400] ggolin: benjoldersma, also, knife node show <enter>
[2012-04-16 23:56:57 -0400] benjoldersma: oh
[2012-04-16 23:56:59 -0400] benjoldersma: i thknk i fou dit
[2012-04-16 23:57:12 -0400] benjoldersma: yep or -l for lal attributes it looks like
[2012-04-16 23:57:17 -0400] benjoldersma: that's pretty cool!
[2012-04-16 23:57:26 -0400] ggolin: that it is.
[2012-04-16 23:58:09 -0400] benjoldersma: wow - lots of data! but that looks like it could work!
[2012-04-16 23:58:11 -0400] bemu: knife node-F json
[2012-04-16 23:58:15 -0400] bemu: er
[2012-04-16 23:58:19 -0400] bemu: knife node show blah -F json
[2012-04-16 23:58:21 -0400] matschaffer: jtimberman: thanks! does install.sh live on github anywhere?
[2012-04-16 23:58:49 -0400] hoover_damn: and yes jsondiff works
[2012-04-16 23:59:01 -0400] benjoldersma: hoover_damn: is that a knife command?
[2012-04-16 23:59:14 -0400] matschaffer: jtimberman: or more directly, where should I send people if they have questions about it?
[2012-04-16 23:59:29 -0400] jtimberman: matschaffer: its in the omnibus project, i believe.
[2012-04-16 23:59:54 -0400] matschaffer: jtimberman: ah! thanks. Sorry I didn't think to google "opscode omnibus"
