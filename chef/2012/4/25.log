[2012-04-25 00:00:50 -0400] UForgotten: hoover_damn: can I run something by you?  I've been toying with the idea of throwing a list of ip blocks in an attribute for later replay into an iptables template
[2012-04-25 00:01:49 -0400] UForgotten: hoover_damn: but I can't seem to get the syntax correct for getting the attribute array into the template to be able to do an each loop on them.
[2012-04-25 00:05:24 -0400] hoover_damn: UForgotten, hrm... something like
[2012-04-25 00:05:29 -0400] hoover_damn: sec
[2012-04-25 00:05:40 -0400] yfeldblum: gist what you've got?
[2012-04-25 00:05:43 -0400] hoover_damn: basically
[2012-04-25 00:07:20 -0400] yfeldblum: templates("/etc/asdf.conf") { variables(:attrs => node["MY_COOKBOOK"]["asdf"] }  ...  <% @attrs.each do |a| %><%= a %><% end %>
[2012-04-25 00:07:37 -0400] UForgotten: yes similar to that
[2012-04-25 00:08:58 -0400] hoover_damn: UForgotten, https://gist.github.com/10527f7c8f61c172984b
[2012-04-25 00:09:02 -0400] UForgotten: the catch being I'm doing it in a template that's inside a definition
[2012-04-25 00:09:12 -0400] hoover_damn: prolly a bit of the silly way
[2012-04-25 00:09:42 -0400] hoover_damn: but i was aiming for simplicity
[2012-04-25 00:10:06 -0400] UForgotten: hoover_damn: thats very close to what I tried
[2012-04-25 00:10:16 -0400] UForgotten: th problem I'm having is scope related I'm sure of it
[2012-04-25 00:10:24 -0400] hoover_damn: scope is always fun
[2012-04-25 00:10:32 -0400] UForgotten: I use a definition called iptables_rule "rulename"
[2012-04-25 00:10:37 -0400] hoover_damn: you said your trying to do a definition, so as yfeldblum said... gist what you have
[2012-04-25 00:10:40 -0400] UForgotten: which then calls a template based on that rulename
[2012-04-25 00:10:54 -0400] hoover_damn: yeah i've seen various atrocities to the iptables style cookbook
[2012-04-25 00:11:01 -0400] hoover_damn: someday i'll write my own
[2012-04-25 00:11:04 -0400] UForgotten: heh
[2012-04-25 00:11:06 -0400] hoover_damn: i'm sure it will suck just as badly
[2012-04-25 00:11:19 -0400] mhalligan: anyidea why knife data bag show users nagiosadmin will show my nagiosadmin users in the sysadmin group, but knife search users "*:*" (or "groups:sysadmin") returns 0 entries?
[2012-04-25 00:11:22 -0400] UForgotten: yes this is using the iptables cookbook. for simple templates it works fine, getting fancy is scary
[2012-04-25 00:12:05 -0400] UForgotten: let me try it one more time and then I'll try to share pastebins
[2012-04-25 00:12:28 -0400] UForgotten: what youve shown me proves my syntax would likely work, if I wasnt using this definition
[2012-04-25 00:14:47 -0400] hoover_damn: UForgotten, yeah one setup I've seen is a sub-recipe per 'role'
[2012-04-25 00:15:07 -0400] hoover_damn: UForgotten, which heh basically i'm going to rewrite it into something that will determine what to open based on the recipes applied
[2012-04-25 00:15:43 -0400] hoover_damn: UForgotten, as I believe the recipe should be just a run... and it would get what it needs from roles, attributes, whatever.
[2012-04-25 00:16:00 -0400] UForgotten: yes, ideally a firewall should be built in pieces
[2012-04-25 00:16:10 -0400] UForgotten: which is what I've had to do by building chains
[2012-04-25 00:16:45 -0400] UForgotten: it works except for not having the right sysctl tunings, and I'd like to be able to just make lists of machines in attributes and then load them into chains - that would be my firewall.
[2012-04-25 00:16:48 -0400] hoover_damn: I was thinking of just a iptables cookbook that you ran default and it would assemble the list, and if you needed to add more to it
[2012-04-25 00:16:52 -0400] hoover_damn: you'd toss it in the attributes first
[2012-04-25 00:17:01 -0400] hoover_damn: if your having to unblock something new... then it would require cookinb
[2012-04-25 00:17:04 -0400] hoover_damn: cooking*
[2012-04-25 00:17:14 -0400] hoover_damn: but like modifying your ssh allows should be attribute level
[2012-04-25 00:17:19 -0400] hoover_damn: or data bag
[2012-04-25 00:17:39 -0400] hoover_damn: although I go for attributes still because i'm an old chef-solo user who doesn't use data bags enough
[2012-04-25 00:17:52 -0400] hoover_damn: mhalligan, expander running?
[2012-04-25 00:19:26 -0400] mhalligan: hoover_damn: aye, and empty queue
[2012-04-25 00:19:30 -0400] UForgotten: hoover_damn: thank goodness, I thought I was the only chef-solo holdout lol
[2012-04-25 00:19:48 -0400] UForgotten: hoover_damn: I find it very hard to work without search and save functions that so many people have put in their cookbooks.
[2012-04-25 00:27:16 -0400] hoover_damn: UForgotten, I gaveup on solo
[2012-04-25 00:27:29 -0400] hoover_damn: UForgotten, well actually I left that job
[2012-04-25 00:28:34 -0400] hoover_damn: UForgotten, I can honestly do it in solo if i wanted to.  But I'd write a sinatra server as a end point for the json and eventually i'd have to ask myself.. . have I produced chef-server yet?
[2012-04-25 00:29:00 -0400] hoover_damn: UForgotten, I asked myself that question and I realized i'd be inventing chef-server quite fast... and just went to the Hosted Platform
[2012-04-25 00:29:39 -0400] hoover_damn: UForgotten, I was Engine Yard's Chef Maintainer and Release manager for about a year maintaining their solo product
[2012-04-25 00:29:55 -0400] hoover_damn: UForgotten, to me chef-solo is a little too much like clojure with lennigan
[2012-04-25 00:30:00 -0400] UForgotten: heh
[2012-04-25 00:30:15 -0400] hoover_damn: https://github.com/technomancy/leiningen
[2012-04-25 00:30:17 -0400] hoover_damn: for the full reference
[2012-04-25 00:30:52 -0400] hoover_damn: chef-solo beat me
[2012-04-25 00:37:03 -0400] Blah1: on my chef-server is there a way to automate 'knife configure -i' ?
[2012-04-25 00:37:19 -0400] Blah1: if i know all the values, can i put it in a seed file?
[2012-04-25 00:38:00 -0400] Blah1: other than using expect
[2012-04-25 00:50:57 -0400] mhalligan: hrm when I try to load my data bag from file I get INFO: HTTP Request Returned 404 Not Found: Cannot load Databag Item nagiosadmin
[2012-04-25 00:51:02 -0400] mhalligan: but it still seems to create the data bag
[2012-04-25 00:51:59 -0400] darjeeling: how can I set shell enviroment when chef execute shell command?
[2012-04-25 00:53:52 -0400] bemu: mhalligan: Pretty sure that's an old ugliness.
[2012-04-25 00:55:21 -0400] mhalligan: bemu: do you think it might be related to why my databags aren't searchable via knife search?
[2012-04-25 00:56:11 -0400] bemu: I don't know, I doubt it though. If I remember correctly, it was because that databag item hadn't been created yet, and it was created following the 404. I could be wrong, this was a while ago
[2012-04-25 01:00:40 -0400] till__: anyone have some pointers for ohai plugins? i am just playing around with it, but i can't seem to be able to add anything to what 'ohai' reports
[2012-04-25 01:01:05 -0400] till__: my plugin is loaded though, etc. - i see that when i run chef-solo
[2012-04-25 01:05:40 -0400] UForgotten: FATAL: TypeError: can't convert Symbol into Integer
[2012-04-25 01:08:29 -0400] mhalligan: ok so solr feels permanently hosed
[2012-04-25 01:08:48 -0400] mhalligan: solr is running, rabbitmq is running, rabbitmqctl list_queues -q -p /chef | awk '{print $2}' | paste -sd+ - | bc returns 0
[2012-04-25 01:08:56 -0400] mhalligan: any other tips for debugging this?
[2012-04-25 01:09:00 -0400] till__: yeah
[2012-04-25 01:09:06 -0400] till__: try without the 'awk' ;)
[2012-04-25 01:09:08 -0400] till__: step by step
[2012-04-25 01:10:01 -0400] erratic: i had to use curl to troubleshoot my solr
[2012-04-25 01:10:37 -0400] erratic: that includes sending xml data from a @file
[2012-04-25 01:10:54 -0400] erratic: and cuatomising the request headers i think
[2012-04-25 01:10:55 -0400] mhalligan: till_: why?
[2012-04-25 01:10:56 -0400] till__: hehe
[2012-04-25 01:11:02 -0400] mhalligan: all of the queues show 0
[2012-04-25 01:18:34 -0400] mhalligan: is there a magic way to make chef actually spew out errors or tell me what it's doing when I run chef-client/rake install and see where it's fialing to write to solr? nothing fails, and I see no relevant (or legible) logs to ppoint me in the right direction.
[2012-04-25 01:20:02 -0400] mhalligan: nothing actually gets written to expander.log even after running chef-expanderctl log-level debug
[2012-04-25 01:25:49 -0400] mhalligan: hrm knife index rbeuild -V -y got me somwhere, showing /var/cache/chef/solr/data/index doesn't exist
[2012-04-25 01:25:57 -0400] mhalligan: why that doesn't return an error without -V is beyond me?
[2012-04-25 01:32:37 -0400] UForgotten: ah. so somewhere along the line I'm not getting my attributes passed into the template variable.
[2012-04-25 01:32:53 -0400] UForgotten: when I set a local variable and pass it, works perfectly.
[2012-04-25 01:37:05 -0400] hoover_damn: mhalligan, how'd you install chef-server? apt or rubygems?
[2012-04-25 01:39:37 -0400] mhalligan: hoover_damn apt
[2012-04-25 01:39:40 -0400] mhalligan: It looks like reinstalling solr, deleting /varlcache/solr/data/index, restartung solr and chef, then having knife rebuild the index fixed it.
[2012-04-25 01:40:08 -0400] UForgotten: hoover_damn: what is the correct way to take an array in attributes and load it into template variables?  It's not working for me.
[2012-04-25 01:40:10 -0400] hoover_damn: mhalligan, I honestly haven't instaleld a apt based install in eons
[2012-04-25 01:40:22 -0400] mhalligan: hoover_damn: I followed Opscode's guide.
[2012-04-25 01:40:28 -0400] hoover_damn: UForgotten, in a recipe setup the array... then variables(:array => array)
[2012-04-25 01:40:52 -0400] hoover_damn: sounds like the apt guide needs some love... i keep seeing more people talk about it
[2012-04-25 01:40:54 -0400] UForgotten: hoover_damn: I wanted to use attributes.
[2012-04-25 01:40:55 -0400] hoover_damn: and having issues with it
[2012-04-25 01:41:28 -0400] hoover_damn: UForgotten, then basically you are going to access variables( :bob => node[:bob][:array])
[2012-04-25 01:41:43 -0400] hoover_damn: UForgotten, remember with Ruby everything is an object
[2012-04-25 01:41:47 -0400] UForgotten: for example in my default_attributes I have "awsips": ["72.44.32.0/19","67.202.0.0/18","75.101.128.0/17","74.129.0.0/16" ]
[2012-04-25 01:41:49 -0400] mhalligan: the installation process is quite a few manual from what I recall. lots of room for screwup on the user's part
[2012-04-25 01:41:53 -0400] hoover_damn: UForgotten, the class or the type of the object matters
[2012-04-25 01:42:12 -0400] UForgotten: hoover_damn: so how do I cast an attribute as an array of strings?
[2012-04-25 01:42:15 -0400] hoover_damn: right
[2012-04-25 01:42:23 -0400] hoover_damn: so ["1","2"] is an rray
[2012-04-25 01:42:46 -0400] hoover_damn: irb(main):001:0> ["72.44.32.0/19","67.202.0.0/18","75.101.128.0/17","74.129.0.0/16" ].class
[2012-04-25 01:42:49 -0400] hoover_damn: => Array
[2012-04-25 01:42:50 -0400] hoover_damn: so far you have an array
[2012-04-25 01:43:11 -0400] hoover_damn: so is this default[:awsips]=this?
[2012-04-25 01:43:32 -0400] UForgotten: ok, so if I try to pass variables :ipblocklist => [:node][:awsips] it says FATAL: TypeError: can't convert Symbol into Integer
[2012-04-25 01:43:54 -0400] UForgotten: ah, maybe thats my problem, I'm not understanding what the attributes are being called
[2012-04-25 01:44:02 -0400] hoover_damn: variables :ipblocklist => node[:awsips]
[2012-04-25 01:44:10 -0400] hoover_damn: your getting confused on the symbols
[2012-04-25 01:44:11 -0400] erratic: yaaaaaaaaaaaay
[2012-04-25 01:44:18 -0400] UForgotten: yes, I am.
[2012-04-25 01:44:23 -0400] erratic: @opscode
[2012-04-25 01:44:31 -0400] hoover_damn: UForgotten, wanna know a secret... you don't have to use symbols
[2012-04-25 01:44:41 -0400] hoover_damn: UForgotten, node['awsips'] or node["awsips"]
[2012-04-25 01:44:42 -0400] hoover_damn: works as well
[2012-04-25 01:45:05 -0400] hoover_damn: completely interchangeable (for the most part..)
[2012-04-25 01:45:12 -0400] UForgotten: interesting.  but I need to use the default object instead of node maybe?  I'm not clear on how it does role scope
[2012-04-25 01:45:17 -0400] hoover_damn: I think there's a few spots where it isn't perfectly interchangeable but not off the top
[2012-04-25 01:45:29 -0400] hoover_damn: default will set the attribute if it's not already set
[2012-04-25 01:45:35 -0400] hoover_damn: set will set the attribute nomatter what
[2012-04-25 01:45:44 -0400] hoover_damn: unless will set the attribute unless it's set
[2012-04-25 01:45:55 -0400] hoover_damn: so when you type default[:awsips]
[2012-04-25 01:46:02 -0400] hoover_damn: that actually ends up as node['awsips']
[2012-04-25 01:46:11 -0400] josephholsten: opscode devops meet up time!
[2012-04-25 01:46:35 -0400] UForgotten: hoover_damn: ok, I'll rtfm some more and lurk for the meetup.  Thanks! :)
[2012-04-25 01:46:45 -0400] hoover_damn: heh too bad i'm not going to the meetup tonight
[2012-04-25 01:46:57 -0400] hoover_damn: it is tuesday
[2012-04-25 01:47:01 -0400] hoover_damn: last tuesday of the month
[2012-04-25 01:47:01 -0400] UForgotten: its not in here?
[2012-04-25 01:47:30 -0400] UForgotten: hoover_damn: not using the symbol worked btw.
[2012-04-25 01:47:36 -0400] UForgotten: which makes no damn sense.
[2012-04-25 01:48:14 -0400] hoover_damn: :D
[2012-04-25 01:48:34 -0400] hoover_damn: UForgotten, I hope I haven't given you too big of a brain fart
[2012-04-25 01:48:51 -0400] UForgotten: no, you're healing the migraine slowly
[2012-04-25 01:49:07 -0400] UForgotten: everything I read seems to be very symbol-happy
[2012-04-25 01:49:33 -0400] UForgotten: but going back to more associative-array notation is much more natural for me.
[2012-04-25 01:49:42 -0400] UForgotten: my background is mostly shell and php.  ruby is still very much japanese to me.
[2012-04-25 01:50:58 -0400] hoover_damn: usually i'm the one having the migrane
[2012-04-25 01:51:57 -0400] hoover_damn: UForgotten, I don't have a lot of cookbooks up anymore but if you want to read over examples you can find some bad examples on github.com/damm
[2012-04-25 01:52:13 -0400] hoover_damn: UForgotten, my preference is to use attributes and variables on everything... it's my preference, has been since 2010
[2012-04-25 01:52:31 -0400] hoover_damn: UForgotten, so you'll find most of my cookbooks to be fairly search agnostic unless they have to have it
[2012-04-25 01:53:06 -0400] hoover_damn: it's not because I use solo still, because I don't... it's actually because I find attributes can be hammered in a hundred different ways
[2012-04-25 01:53:11 -0400] hoover_damn: environment merge, role merge, node merge
[2012-04-25 01:53:48 -0400] hoover_damn: which usually tends to be just about as flexible
[2012-04-25 01:53:52 -0400] UForgotten: did you ever find a solution to getting lists of categorized nodes other than just sticking them in attributes?
[2012-04-25 01:54:07 -0400] UForgotten: because everyone else likes using node search - doesnt work in solo
[2012-04-25 01:54:43 -0400] hoover_damn: solo is an interesting idea, but it becomes a hangnail that you just can't cut right
[2012-04-25 01:55:44 -0400] hoover_damn: bootstrapping to solo and having it fully functional will require about 1/3 more work then regular chef will likely
[2012-04-25 01:55:50 -0400] UForgotten: indeed. I need to get enough ammo to plead the case for chef server.  The pushback I'm hearing is the inability to use it for vagrant vm's offline
[2012-04-25 01:55:58 -0400] hoover_damn: but it always depends on your requirements
[2012-04-25 01:56:16 -0400] UForgotten: I'm curious if other people have some sort of hybrid solo and server model going
[2012-04-25 01:56:36 -0400] UForgotten: but the recipes that we make that depend on chef server functionality would not work offline.
[2012-04-25 01:56:38 -0400] hoover_damn: why vagrant offline?
[2012-04-25 01:56:52 -0400] UForgotten: if you're working on a laptop with no internet access and want to be able to reprovision your vm
[2012-04-25 01:57:05 -0400] hoover_damn: ahh, what if the recipes pull packages from the web?
[2012-04-25 01:57:13 -0400] hoover_damn: is everything your doing contained to the point where you can be disconnected?
[2012-04-25 01:57:27 -0400] hoover_damn: that's a pretty huge requirement
[2012-04-25 01:57:29 -0400] UForgotten: good point.
[2012-04-25 01:57:43 -0400] UForgotten: no, there are still pieces that get pulled from other places. lol
[2012-04-25 01:57:52 -0400] hoover_damn: sounds like steam
[2012-04-25 01:58:03 -0400] UForgotten: I just have to pose a logical argument to enact change.
[2012-04-25 01:58:23 -0400] UForgotten: also gotta convince them to send me to chefconf
[2012-04-25 01:58:25 -0400] hoover_damn: good luck... I wasn't able to do that change in my last job
[2012-04-25 01:58:52 -0400] hoover_damn: actually feels great to be back with chef-server again after not using it for almost a year
[2012-04-25 01:59:08 -0400] hoover_damn: supporting chef 0.6 for the past 2 years was hard enough
[2012-04-25 01:59:13 -0400] UForgotten: heh
[2012-04-25 01:59:13 -0400] bemu: Do most HTTP clients wait for an ack on each POST body packets before sending the next?
[2012-04-25 01:59:17 -0400] UForgotten: welcome to the modern era
[2012-04-25 01:59:30 -0400] bemu: I know web browsers are a mixed bag.
[2012-04-25 01:59:31 -0400] UForgotten: bemu: depends on if they are in pipelined request mode or not
[2012-04-25 01:59:42 -0400] UForgotten: bemu: HTTP 1.0 spec does not do pipeline requests IIRC
[2012-04-25 02:00:03 -0400] UForgotten: bemu: pipelined requests do not wait for acks, its firehosed
[2012-04-25 02:00:15 -0400] bemu: Thanks!
[2012-04-25 02:00:16 -0400] UForgotten: bemu: so it will depend on the user agent's capabilities
[2012-04-25 02:00:47 -0400] UForgotten: bemu: check the specs and the client specifically tho - cos I could be wrong :)
[2012-04-25 02:00:57 -0400] bemu: Of course. Digging in.
[2012-04-25 02:01:23 -0400] coderanger: bemu: Did you end up with any patches for pychef from that hack day?
[2012-04-25 02:01:25 -0400] hoover_damn: it feels good to be on a modern version of chef and being able to open source my work
[2012-04-25 02:01:57 -0400] bemu: Just the one that needs to be made more generic. Everything else we're doing outside of fabric/pychef integration, so not necessary yet.
[2012-04-25 02:02:11 -0400] UForgotten: hoover_damn: definitely.  At some point I will give back any of the crap I do at my work.  Thanks to your help I've already got an iptables chain builder using attributes going.
[2012-04-25 02:02:34 -0400] UForgotten: still boggles the mind why node["awsips"] worked and [:node][:awsips] did not
[2012-04-25 02:02:46 -0400] UForgotten: guess I fail at symbols lol
[2012-04-25 02:02:51 -0400] hoover_damn: wrong syntax
[2012-04-25 02:02:54 -0400] hoover_damn: node[:awsips] would work
[2012-04-25 02:03:00 -0400] hoover_damn: or node["awsips"] or node['awsips']
[2012-04-25 02:03:16 -0400] coderanger: bemu: Okay, /me -> docs
[2012-04-25 02:03:17 -0400] hoover_damn: but variables :bob => [:node
[2012-04-25 02:03:19 -0400] hoover_damn: is a different object
[2012-04-25 02:03:41 -0400] bemu: Hm?
[2012-04-25 02:03:44 -0400] hoover_damn: your almost creating a aray UForgotten
[2012-04-25 02:03:49 -0400] hoover_damn: UForgotten, array* of your own
[2012-04-25 02:04:33 -0400] hoover_damn: UForgotten, I'm glad that I was able to help your head and hopefully you can spend some time to relax tonight and figure out what you missed tomorrow
[2012-04-25 02:04:46 -0400] UForgotten: nope. no relaxing until sysctl works
[2012-04-25 02:04:54 -0400] UForgotten: then I can actually deploy this damned firewall :)
[2012-04-25 02:05:05 -0400] UForgotten: but yes, I greatly appreciate your help and patience
[2012-04-25 02:05:14 -0400] UForgotten: sorry if I'm a stubborn pita
[2012-04-25 02:18:12 -0400] paigeat: HEY LOOK AT ME!!!!!!!!!!! IM IRCING FROM OPSCODES NETWORK!
[2012-04-25 02:19:31 -0400] z: is "OMGLOLZ" the expected response?
[2012-04-25 02:19:54 -0400] z: possibly with a !!!!!!111!!!!11! on the end :)
[2012-04-25 02:22:23 -0400] hoover_damn: UForgotten, most ops people are a pita in one way or another
[2012-04-25 02:22:57 -0400] hoover_damn: not a deal to me
[2012-04-25 02:44:02 -0400] erratic: jeeeeeeeez. talking about work stuff after work xD
[2012-04-25 02:44:34 -0400] UForgotten: erratic: IT never sleeps
[2012-04-25 02:46:10 -0400] UForgotten: hoover_damn: I see you had a redmine cookbook.  I have tried in several places to get them to use redmine but they end up going with something else.  Like the Atlassian suite, which is spiffy but expensive
[2012-04-25 03:31:22 -0400] hoover_damn: I did? wow
[2012-04-25 03:31:31 -0400] hoover_damn: doubt it works
[2012-04-25 03:58:54 -0400] Axsuul: Is there any way to read the file within the "files" folder of a cookbook?
[2012-04-25 03:59:10 -0400] Axsuul: from within a recipe
[2012-04-25 04:01:27 -0400] |shad0w|: what is the end goal
[2012-04-25 04:04:46 -0400] coderanger: Axsuul: Use a cookbook_file or remote_directory resource
[2012-04-25 04:04:59 -0400] coderanger: That will download them whereever you want
[2012-04-25 04:06:40 -0400] Axsuul: I need to read the contents of the file into a string
[2012-04-25 04:06:45 -0400] Axsuul: and use it in one of my recipes
[2012-04-25 04:07:01 -0400] coderanger: So use a cookbook_file and then read it in using a ruby_block
[2012-04-25 04:07:02 -0400] Axsuul: not necessarily transfer it
[2012-04-25 04:07:17 -0400] coderanger: That sounds like you don't want to be using a cookbook file
[2012-04-25 04:07:27 -0400] coderanger: Probably better to put the data in a data bag
[2012-04-25 04:09:19 -0400] Axsuul: coderanger: its a really long SSH key, is that still fine to put it in a data bag?
[2012-04-25 04:09:34 -0400] coderanger: Sure, its just JSON
[2012-04-25 04:12:06 -0400] miah: Axsuul: https://github.com/atomic-penguin/cookbook-certificate
[2012-04-25 04:13:57 -0400] Axsuul: thanks guys
[2012-04-25 04:24:55 -0400] ska: Why does chef require 600mb of code to run?
[2012-04-25 04:25:24 -0400] coderanger: ska: Usually large blocks of search results
[2012-04-25 04:25:52 -0400] ska: Can I run chef w/o the server, using git or something?
[2012-04-25 04:26:07 -0400] coderanger: Each node object is 1-2MB of data, with usually at least 50% overhead because of Ruby
[2012-04-25 04:26:08 -0400] ska: I can't afford to run that much on this server.
[2012-04-25 04:26:12 -0400] coderanger: Sure, solo is thing
[2012-04-25 04:26:34 -0400] coderanger: You lose out on search() though, and you have to handle stuff like data persistence and management yourself
[2012-04-25 04:26:35 -0400] ska: coderanger: I mean all the required software,, db, qt, etc..
[2012-04-25 04:26:48 -0400] coderanger: qt?
[2012-04-25 04:26:51 -0400] ska: couchdb etc..
[2012-04-25 04:26:57 -0400] coderanger: As far as I know, we don't use Qt anywhere
[2012-04-25 04:27:07 -0400] ska: http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages
[2012-04-25 04:27:20 -0400] coderanger: In theory you can run chef-server without rabbit+solr+expander
[2012-04-25 04:27:30 -0400] coderanger: but its a hack and clearly unsupported
[2012-04-25 04:27:33 -0400] ska: When I do "aptitude install chef chef-server" it wants to install 600MB of software.
[2012-04-25 04:27:35 -0400] coderanger: and obviously search won't work
[2012-04-25 04:27:46 -0400] coderanger: ska: Disk space you mean?
[2012-04-25 04:27:50 -0400] ska: yea.
[2012-04-25 04:28:02 -0400] coderanger: I don't think they have made server HDDs smaller than 200GB in years
[2012-04-25 04:28:08 -0400] coderanger: We stopped caring about that long ago :P
[2012-04-25 04:28:12 -0400] coderanger: RAM is the expensive resource
[2012-04-25 04:28:28 -0400] coderanger: Where are you trying to run a chef server that 600MB of disk space is a no-go?
[2012-04-25 04:28:47 -0400] ska: coderanger: its a red flag for me, becuase if i see all that software, I know it will use a lot of memory too.. only 512Mb of mem on this vps.
[2012-04-25 04:28:48 -0400] coderanger: chef-server needs a pretty beefy machine, 1GB of RAM would be cutting it close usually
[2012-04-25 04:28:59 -0400] ska: so this is a no-go for me.
[2012-04-25 04:29:11 -0400] coderanger: Yeah, running chef-server on any kind of virtualized server that you don't own is going to cost more than hosted chef
[2012-04-25 04:29:14 -0400] coderanger: just use hosted
[2012-04-25 04:29:48 -0400] coderanger: How many nodes do you have?
[2012-04-25 04:30:14 -0400] ska: coderanger: I'm a newbie, just trying it out to see how it works.
[2012-04-25 04:30:24 -0400] coderanger: ska: Use the free trial of Hosted Chef
[2012-04-25 04:30:30 -0400] ska: coderanger: so I have zero nodes right now.
[2012-04-25 04:30:30 -0400] coderanger: free for up to five servers forever
[2012-04-25 04:30:38 -0400] ska: ok.. ty.
[2012-04-25 04:30:40 -0400] coderanger: opscode.com/hosted-chef/
[2012-04-25 04:30:49 -0400] coderanger: If you want to switch to the FOSS server later, you can just copy the data
[2012-04-25 04:36:18 -0400] miah: guh
[2012-04-25 04:53:23 -0400] Axsuul: How would I write a string to a file?
[2012-04-25 04:53:51 -0400] Axsuul: nm
[2012-04-25 04:53:54 -0400] Axsuul: Im stupid
[2012-04-25 04:57:51 -0400] coderanger: file resource
[2012-04-25 04:58:08 -0400] thehar: derp
[2012-04-25 06:50:17 -0400] BryanWB: ohai chefs!
[2012-04-25 06:50:34 -0400] miah: hi BryanWB
[2012-04-25 06:51:29 -0400] BryanWB: miah: ciao
[2012-04-25 06:55:31 -0400] andoriyu_: ok, i setup chef-server
[2012-04-25 06:55:46 -0400] andoriyu_: uploaded some cookbooks, bootstrap my first node
[2012-04-25 06:56:17 -0400] andoriyu_: added recepies to run list for that node.
[2012-04-25 06:56:30 -0400] andoriyu_: last check in: > 2 hours ago
[2012-04-25 06:56:39 -0400] andoriyu_: what's wrong?
[2012-04-25 07:29:36 -0400] vdvluc: andoriyu_: did you check the logs on the client?
[2012-04-25 07:47:45 -0400] andoriyu_: vdvluc, not yet
[2012-04-25 07:49:04 -0400] andoriyu_: i see
[2012-04-25 07:50:02 -0400] vdvluc: andoriyu_: the logs have always been great in assisting me with finding problems ;)
[2012-04-25 07:54:20 -0400] andoriyu_: i just thought i was doing something wrong (e.g. there is secret button to apply changes)
[2012-04-25 07:56:28 -0400] coderanger: Any python folks around want to tell me if http://pychef.readthedocs.org/en/latest/index.html is simple enough to follow?
[2012-04-25 07:57:26 -0400] Axsuul: How do I output messages to the console for debugging?
[2012-04-25 07:58:27 -0400] coderanger: Axsuul: log resource
[2012-04-25 07:58:35 -0400] coderanger: Or use the logger directly in your code
[2012-04-25 08:01:31 -0400] Axsuul: coderanger: thanks
[2012-04-25 08:01:47 -0400] Axsuul: coderanger: also, how come I'm not allowed to use attributes like.. node[:app]?
[2012-04-25 08:01:55 -0400] coderanger: Hmm?
[2012-04-25 08:01:56 -0400] bawt: Hmm is there a flags option or similar for execute resource like in script resource? if the command exits non-zero i need it to fail
[2012-04-25 08:02:04 -0400] coderanger: bawt: forget hmm
[2012-04-25 08:02:05 -0400] bawt: okay
[2012-04-25 08:02:11 -0400] coderanger: Axsuul: That should work fine
[2012-04-25 08:02:19 -0400] coderanger: though "app" is a tad generic
[2012-04-25 08:14:50 -0400] BryanWB: why can't I assign a value to a node attribute inside a recipe?  node['foo'] = 'bar'   won't actually change the value of node['foo']
[2012-04-25 08:15:50 -0400] Axsuul: coderanger: Hmm ok thanks, I'm setting an attribute in default_attributes within one of my base roles, which one of my nodes is using, but node["app"] is nil
[2012-04-25 08:16:09 -0400] coderanger: Axsuul: Pastebin the role and node data
[2012-04-25 08:16:20 -0400] coderanger: BryanWB: Sure you can, works fine
[2012-04-25 08:16:43 -0400] coderanger: BryanWB: It will even be persisted to the server if the run succeeds (or if you call node.save)
[2012-04-25 08:17:08 -0400] coderanger: BryanWB: That only sets "normal" level attrs though, so it can't punch through overrides or automatics
[2012-04-25 08:17:22 -0400] BryanWB: coderanger: hmm, perhaps that's it
[2012-04-25 08:17:46 -0400] BryanWB: can it punch through values set by default['foo'] ?
[2012-04-25 08:17:57 -0400] coderanger: Yes, it should
[2012-04-25 08:18:13 -0400] coderanger: default < normal < override < automatic
[2012-04-25 08:18:29 -0400] coderanger: Okay, gotta pass out
[2012-04-25 08:18:31 -0400] coderanger: brain is fading
[2012-04-25 08:18:40 -0400] BryanWB: tks coderanger, gnite
[2012-04-25 08:37:10 -0400] sampikesley: anybody know any London-based RoR devs looking to come work for my awesome company?
[2012-04-25 08:43:22 -0400] gerco: morning all, I am running into a problem when bootstrapping chef server via chef solo using the aws cloudformation template. Is this the place to ask a question about that?
[2012-04-25 08:48:23 -0400] gerco: anything happening here?
[2012-04-25 08:54:22 -0400] gale: gerco: it's much more lively once the Americans have woken up - suggest asking again later
[2012-04-25 08:54:53 -0400] gerco: I see, thanks, will try again later then.
[2012-04-25 08:55:05 -0400] erikh: probably about 6-8 hours from now
[2012-04-25 08:55:18 -0400] erikh: for the west coast (where opscode primarily is)
[2012-04-25 08:55:59 -0400] gale: they're all tucked up in bed bless 'em
[2012-04-25 08:58:04 -0400] yatesy: no harm in just asking of course :)
[2012-04-25 08:58:50 -0400] gerco: ok, will give it a shot then :-)
[2012-04-25 08:59:37 -0400] proffalken: gerco: I'd just ask the question, if it's chef-related then yes, this is the right place
[2012-04-25 08:59:51 -0400] gerco: I am boostrapping a chef-server using an AWS cloudformation template on Ubuntu (see http://aws.amazon.com/cloudformation/aws-cloudformation-templates/)
[2012-04-25 09:00:00 -0400] proffalken: but if you don't get a response, then wait for the US and ask again... ;)
[2012-04-25 09:00:15 -0400] gerco: Basically it uses chef-solo to configure a chef server
[2012-04-25 09:00:35 -0400] gerco: When running the the chef-solo command it fails with the following error
[2012-04-25 09:00:51 -0400] gerco: FATAL: Errno::ENOENT: execute[chef-solr-installer] (chef-server::rubygems-install line 155) had an error: Errno::ENOENT: No such file or directory - chef-solr-installer -c /etc/chef/solr.rb -u chef -g root
[2012-04-25 09:01:22 -0400] gerco: I had a look at this rubygems-install cookbook but that doesn't bring me any further
[2012-04-25 09:01:54 -0400] gerco: Unless I am very mistaken, I run the very same template about a month ago and then it worked fine.
[2012-04-25 09:02:18 -0400] gerco: any clues?
[2012-04-25 09:02:50 -0400] proffalken: apart from the obvious "chef-solr-installer" is missing from where it expects it to be? not at the moment... :(
[2012-04-25 09:04:25 -0400] proffalken: gerco: what's in /home/ubuntu/chef-repo?
[2012-04-25 09:04:40 -0400] proffalken: can you run a find and look for the installer?
[2012-04-25 09:04:49 -0400] gerco: yep, will do
[2012-04-25 09:05:23 -0400] gerco: chef-solr-installer is there
[2012-04-25 09:05:45 -0400] proffalken: hmmm
[2012-04-25 09:05:58 -0400] gerco: actually when I run the installer it seems to work fine
[2012-04-25 09:06:23 -0400] proffalken: ok, I'd check the cookbook/recipe and make sure it's pointing to the same path
[2012-04-25 09:06:41 -0400] proffalken: I've not used Chef-Solo, but it sounds like a path issue to me...
[2012-04-25 09:07:04 -0400] gerco: ok, will do. Btw the chef-repo directory seems initialised, contains quite a few files/directories
[2012-04-25 09:08:56 -0400] gerco: I think that indeed seems to be the case
[2012-04-25 09:09:02 -0400] gerco: The recipe is stating the following
[2012-04-25 09:09:24 -0400] gerco: command  "chef-solr-installer -c /etc/chef/solr.rb -u chef -g #{root_group}"
[2012-04-25 09:09:35 -0400] gerco:  path %w{ /usr/local/sbin /usr/local/bin /usr/sbin /usr/bin /sbin /bin }
[2012-04-25 09:10:08 -0400] sampikesley: which chef-solr-installer
[2012-04-25 09:10:09 -0400] sampikesley: ?
[2012-04-25 09:10:39 -0400] gerco: while the chef-solr-installer resides in both /var/lib/gems/1.8/bin and /var/lib/gems/1.8/chef-solr-0.10.8/bin
[2012-04-25 09:10:57 -0400] gerco: @sampikeslye: you mean which version?
[2012-04-25 09:11:22 -0400] sampikesley: no
[2012-04-25 09:11:26 -0400] sampikesley: I mean type that
[2012-04-25 09:12:16 -0400] gerco: nothing, not in path apparently
[2012-04-25 09:12:59 -0400] sampikesley: so maybe this is why it no worky
[2012-04-25 09:13:30 -0400] gerco: lol
[2012-04-25 09:13:43 -0400] gerco: ok, seems to me a path thing indeed
[2012-04-25 09:13:52 -0400] gerco: now the question is: what is the best way to resolve this
[2012-04-25 09:14:06 -0400] gerco: I can obviously fix it myself but I guess I won't be the only one running into this.
[2012-04-25 09:14:31 -0400] sampikesley: give it the full path just to see if this the actual problem and not a red herring?
[2012-04-25 09:14:46 -0400] gerco: It seems to me that the chef-solr-installer should be copied to one of the bin folders, which hasn't take place
[2012-04-25 09:18:42 -0400] gerco: When I run the chef-solr-installer with full path, then the entire process completes successfully
[2012-04-25 09:21:46 -0400] workmad3: gerco: sounds like your rubygems isn't set up properly... the gem bin path should be on your PATH ideally
[2012-04-25 09:26:09 -0400] gerco: That could indeed be the case, but I would expect the Cloudformation template and/or chef-recipes to take care of that.
[2012-04-25 09:26:30 -0400] gerco: Anyway, I'll have a better look at it now I know what stops me. Don't like that it seemed to work a few weeks ago.
[2012-04-25 09:26:42 -0400] gerco: Thanks for your help guys
[2012-04-25 09:31:57 -0400] ashb: ah ruby gems on ubuntu is an abomination
[2012-04-25 09:33:09 -0400] gerco: ashb: does that also mean that Chef Server on ubuntu is an abomination?
[2012-04-25 09:34:22 -0400] sampikesley: chef-server on ubuntu is fine if you do it right
[2012-04-25 09:36:06 -0400] ashb: gerco: no i ran it fine before I moved to the platform
[2012-04-25 09:36:14 -0400] ashb: Don't think I ever tried the gem install though
[2012-04-25 09:36:23 -0400] ashb: i always just used the opscode apt repo
[2012-04-25 10:09:32 -0400] linuxboy: hey guys
[2012-04-25 10:09:41 -0400] linuxboy: I have a cookbook that gets imported by other cookbooks
[2012-04-25 10:09:51 -0400] linuxboy: this cookbook has some attributes that are set as "default"
[2012-04-25 10:10:05 -0400] linuxboy: the other cookbooks also have attributes set as "default"
[2012-04-25 10:10:22 -0400] linuxboy: and finally I have a node that overrides them all as "normal"
[2012-04-25 10:10:37 -0400] linuxboy: however, from after each chef-client run my file changes
[2012-04-25 10:10:47 -0400] linuxboy: looks like sometimes its being overridden and other times not
[2012-04-25 10:10:50 -0400] sampikesley: https://github.com/pikesley/learn-yourself-some-chef/wiki/Understanding-attributes
[2012-04-25 10:11:28 -0400] linuxboy: am I doing it wrong?
[2012-04-25 10:22:02 -0400] linuxboy: sampikesley: that doesn't help me. My default attributes don't show up in knife node show, only the normal attributes that I set on the node
[2012-04-25 10:24:35 -0400] linuxboy: sampikesley: Oh, I'm wrong. They do show up, but only under 'default'
[2012-04-25 10:26:01 -0400] drrk: on this page on the wiki: http://wiki.opscode.com/display/chef/Fast+Start+Guide
[2012-04-25 10:26:45 -0400] drrk: the documentation includes an apt-get install of rubygems, yet also says to install rubygems from source on Ubuntu
[2012-04-25 10:26:53 -0400] drrk: which is the right thing to do?
[2012-04-25 10:27:48 -0400] jannel: does anyone know how to make http_request resource print request headers somewhere, e.g. log?
[2012-04-25 10:28:19 -0400] drrk: ah seems this: http://wiki.opscode.com/display/chef/Workstation+Setup+for+Debian+and+Ubuntu is the correct docs
[2012-04-25 10:28:27 -0400] jannel: I'm successfully making the same request with curl manually, but using http_request results in an error
[2012-04-25 10:28:30 -0400] drrk: the fast start guide probally needs fixing
[2012-04-25 10:28:46 -0400] drrk: (byy someone that actually knows the correct procedure)
[2012-04-25 10:29:09 -0400] jannel: tcpdump does not work because I'm doing the request over https
[2012-04-25 10:38:11 -0400] linuxboy: anyone else got ideas for my attributes problem?
[2012-04-25 10:39:18 -0400] jannel: ah, that's because Chef puts an Accept-header to the request that says "Accept: application/json".. doh!
[2012-04-25 12:22:57 -0400] till__: so i wrote a plugin for ohai to avoid all these shell calls in my recipes. it seems to work that it pushes stuff into languages[:php][:foo] - but now it bails during compilation phase as well because i'm using stuff from node[] which is not yet available (only after another recipe ran). can anyone give me a pointer how to fix this?
[2012-04-25 12:48:30 -0400] till__: i ended up with an if not node[:languages][:php].empty? - but that it doesn't look pretty
[2012-04-25 12:50:38 -0400] BryanWB: till__: use unless instead of ifnot
[2012-04-25 12:56:39 -0400] till__: i don't like unless, tbh
[2012-04-25 12:57:00 -0400] till__: everytime i go back to a recipe with unless, i have to stare at the line for a couple minutes to get it ;)
[2012-04-25 13:01:15 -0400] yfeldblum: practice :P
[2012-04-25 13:01:51 -0400] BryanWB: yfeldblum: u should get the Golden Spatula, for Chef Tool of the Year
[2012-04-25 13:02:37 -0400] yfeldblum: heh ... only if Chef already won Chef Tool of the Year last year
[2012-04-25 13:03:34 -0400] till__: i am just wondering - is the only solution to avoiding these 'race conditions' during compile phase an if-statement?
[2012-04-25 13:04:45 -0400] yfeldblum: till__, which race conditions?
[2012-04-25 13:05:28 -0400] yfeldblum: till__, and ohai runs before anything else, how are you getting a race condition between a recipe and an ohai plugin?
[2012-04-25 13:07:36 -0400] till__: yfeldblum: my ohai plugin is populate with info when another recipe installed software
[2012-04-25 13:07:48 -0400] till__: so essentially during compilation phase - all this info is not yet available
[2012-04-25 13:13:12 -0400] dpetzel: Can anyone tell me the advantage to documenting every single attribute in the README file as opposed to placing proper inline documentation into attributes.rb? If feels like a tremendous amount of redundancy to list the attributes in both location, but its very possible I'm missing something as I am fairly new to chef
[2012-04-25 13:14:05 -0400] ashb: dpetzel: the README is displayed on the community site, inline code comments aren't
[2012-04-25 13:14:57 -0400] dpetzel: ashb: I get that, but it still seems anti-dry. I would think that with proper inline documentation, you could "generate" that section of the documentation without repeating yourself?
[2012-04-25 13:15:11 -0400] yfeldblum: dpetzel, by that logic, why not just write clear code? - because when someone wants a synopsis of your cookbook, they will want to read a readme
[2012-04-25 13:15:52 -0400] yfeldblum: dpetzel, feel free to autogenerate pieces of your readme - just make sure to re-autogenerate it whenever you commit changes to the attributes file
[2012-04-25 13:15:53 -0400] dpetzel: yfeldblum: Providingan over and examples is a little different than what Im talking about. Attributes from what I have seen seem to literally be copy/paste from attributes to readme
[2012-04-25 13:16:26 -0400] dpetzel: yfeldblum: I should clarify, I don't pretend to have a *better* solution, just trying to understand why it is the way it is (again Im very green)
[2012-04-25 13:16:47 -0400] yfeldblum: dpetzel, it's the way it is because it's extremely simple and it works
[2012-04-25 13:17:04 -0400] yfeldblum: dpetzel, any other solution requires a lot of work to build, and will likely miss very many important cases
[2012-04-25 13:17:08 -0400] dpetzel: yfeldblum: A fair and honest answer :
[2012-04-25 13:17:11 -0400] dpetzel: :)
[2012-04-25 13:17:20 -0400] till__: yfeldblum: so, no idea?
[2012-04-25 13:17:25 -0400] sagar_nikam: Hi, I am trying the hadoop cookbook http://community.opscode.com/cookbooks/hadoop
[2012-04-25 13:18:24 -0400] sagar_nikam: i have created a role hadoop and provided the default attributes for hadoop[:mirror_url] , hadoop[:version] and hadoop[:uid]
[2012-04-25 13:18:51 -0400] yfeldblum: till__, you should write your recipes to be tolerant of failures and tolerant of retrying from the beginning
[2012-04-25 13:19:10 -0400] sagar_nikam: on executing the command knife ssh 'name:server-89413.localdomain' -a node.ipaddress 'sudo chef-client' -i keyfile
[2012-04-25 13:19:17 -0400] sagar_nikam: i am getting the following error
[2012-04-25 13:19:34 -0400] till__: yfeldblum: but what exactly does that mean? wrap everything in if blocks?
[2012-04-25 13:19:47 -0400] sagar_nikam: 10.6.55.159 /usr/lib/ruby/gems/1.8/gems/chef-0.10.8/bin/chef-client:26 10.6.55.159 /usr/bin/chef-client:19:in `load' 10.6.55.159 /usr/bin/chef-client:19 10.6.55.159 [Wed, 25 Apr 2012 13:15:35 +0000] ERROR: Running exception handlers 10.6.55.159 [Wed, 25 Apr 2012 13:15:35 +0000] FATAL: Saving node information to /var/chef/cache/failed-run-data.json 10.6.55.159 [Wed, 25 Apr 2012 13:15:35 +0000] ERROR: Exception handlers complete 10
[2012-04-25 13:20:12 -0400] yfeldblum: till__, you can also cause ohai to be re-run in the middle of a run: http://wiki.opscode.com/display/chef/Resources#Resources-Ohai
[2012-04-25 13:20:40 -0400] till__: well, the error happens only in compilation phase
[2012-04-25 13:20:43 -0400] sagar_nikam: : package[hadoop] (hadoop::default line 37) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for hadoop
[2012-04-25 13:20:55 -0400] till__: i reload my plugin, but there is nothing to gather in compilation phase
[2012-04-25 13:21:22 -0400] sagar_nikam: i have specified the version in default attribute for role hadoop
[2012-04-25 13:22:07 -0400] yfeldblum: till__, then fail the run and start a new run?
[2012-04-25 13:24:14 -0400] oponder: Greetings chefs
[2012-04-25 13:24:18 -0400] till__: well, when i get to compilation phase it works
[2012-04-25 13:24:19 -0400] till__: no idea
[2012-04-25 13:25:51 -0400] till__: sorry, execution phase
[2012-04-25 13:26:06 -0400] till__: i wrapped it in an if block and that fixes that
[2012-04-25 13:26:50 -0400] sagar_nikam: Hi, can somebody help me pls
[2012-04-25 13:26:53 -0400] yfeldblum: till__, it's ok for a chef-client run to fail in the middle; that's the point of "convergence"
[2012-04-25 13:27:25 -0400] oponder: I was wondering if anyone familiar with the nagios cookbook could tell me a little bit about the way they define a service that monitors the availability of an web application.   My apps are also chef cookbooks in some way or another, so I'd like to keep service definitions related to that cookbook somehow, how do ya'll do it?
[2012-04-25 13:27:28 -0400] yfeldblum: till__, the idea is that the chef-client run makes progress, and then the next chef-client run will make further progress, until finally the node is fully converged
[2012-04-25 13:27:51 -0400] till__: yeah, but if stuff fails during 'compilation phase' there is _never_ progress
[2012-04-25 13:27:58 -0400] till__: it just keeps failing
[2012-04-25 13:28:37 -0400] yfeldblum: till__, so the first chef-client run should install the ohai plugin and then later on fail; the next chef-client run should load ohai data early on and then make further progress
[2012-04-25 13:29:24 -0400] till__: so i have to adjust the runlist constantly?
[2012-04-25 13:29:29 -0400] yfeldblum: heh i really don't like the phrases "compilation" and "execution" - i much prefer "execution" and "convergence"
[2012-04-25 13:29:38 -0400] yfeldblum: till__, no, a static run-list
[2012-04-25 13:29:48 -0400] till__: is convergence what i called 'compilation'?
[2012-04-25 13:30:04 -0400] yfeldblum: till__, no, the comment was not to you, it was general
[2012-04-25 13:30:30 -0400] till__: so basically, i have this in my runlist:
[2012-04-25 13:30:37 -0400] till__: ohai and my plugins
[2012-04-25 13:30:40 -0400] till__: php recipe
[2012-04-25 13:30:45 -0400] till__: phplib recipe
[2012-04-25 13:31:00 -0400] till__: when php recipe is installed, my ohai plugin is reloaded
[2012-04-25 13:31:02 -0400] yfeldblum: "the ruby code in your recipes is executed (and a list of resources and their respective actions is compiled); subsequently, the node is converged (by means of executing the given resources' listed actions)"
[2012-04-25 13:31:12 -0400] till__: and populates node with info about the php setup on the node
[2012-04-25 13:31:19 -0400] till__: the phplib recipe relies on it
[2012-04-25 13:31:32 -0400] till__: so unless i wrap my phplib recipe in an if-block, there is never progress
[2012-04-25 13:31:40 -0400] till__: just executing chef-solo in vagrant here
[2012-04-25 13:31:45 -0400] till__: it just fails and fails, and fails
[2012-04-25 13:33:29 -0400] yfeldblum: till__, gotcha ... another approach is to add the ohai plugin to your bootstrap template and also ssh into all the boxes that are already bootstrapped and install it
[2012-04-25 13:37:33 -0400] oponder: schisamo, jtimberman: if you guys are around and available, could I get a hint on how you set up your nagios installation, particularly concerning where to define the other services (like http) that you'd like to monitor per node. Is it all defined in the nagios_services databag by hand?
[2012-04-25 13:41:18 -0400] sagar_nikam: Hi, anybody has tried the hadoop cookbook http://community.opscode.com/cookbooks/hadoop
[2012-04-25 13:41:24 -0400] sagar_nikam: i need some help
[2012-04-25 13:48:06 -0400] oponder: sagar_nikam: whats going on? i havent messed with the hadoop cookbook, but maybe i can help
[2012-04-25 13:48:14 -0400] geekbri: I find it horribly frustrating when somebody gives a low star rating on your cookbook but doens't provide a comment at all on it
[2012-04-25 13:48:21 -0400] geekbri: how can i possibly know what they didnt like about it, or what issues they had?
[2012-04-25 13:48:35 -0400] geekbri: incredibly frustrating experience.
[2012-04-25 13:49:23 -0400] sagar_nikam: oponder:i have created a role hadoop and provided the default attributes for hadoop[:mirror_url] , hadoop[:version] and hadoop[:uid]
[2012-04-25 13:49:52 -0400] sagar_nikam: on executing the command knife ssh 'name:server-89413.localdomain' -a node.ipaddress 'sudo chef-client' -i keyfile
[2012-04-25 13:50:00 -0400] sagar_nikam: i am getting this error
[2012-04-25 13:50:31 -0400] sagar_nikam: package[hadoop] (hadoop::default line 37) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for hadoop
[2012-04-25 13:53:31 -0400] BryanWB: sagar_nikam: must need to add apt repository
[2012-04-25 13:53:50 -0400] BryanWB: that has that package, what happens if u run  $ sudo apt-get install hadoop ?
[2012-04-25 13:54:26 -0400] sagar_nikam: BryanWB: how do i do it
[2012-04-25 13:54:50 -0400] sagar_nikam: ok trying
[2012-04-25 13:55:00 -0400] BryanWB: check the hadoop cookbook readme and look at the apt cookbook, i haven't used it myself
[2012-04-25 13:56:19 -0400] geekbri: I think the community site should just do away with stars, or at least disallow stars without a comment associated with them
[2012-04-25 13:59:26 -0400] sagar_nikam: BryanWB: i am using this cookbook http://community.opscode.com/cookbooks/hadoop
[2012-04-25 13:59:40 -0400] sagar_nikam: no apt cookbook available
[2012-04-25 14:02:38 -0400] BryanWB: apt-repo? aptrepo perhaps?
[2012-04-25 14:04:34 -0400] sagar_nikam: BryanWB: No. i have specified the hadoop download URL as a attribute
[2012-04-25 14:05:06 -0400] sagar_nikam: hence i think apt cookbook is not required
[2012-04-25 14:32:34 -0400] sagar_nikam: BryabWB: Should i assign a role to a node ?
[2012-04-25 14:38:56 -0400] geekbri: Is there a way within a resource definition to specify that kind_of should be TrueClass OR FaleClass ?
[2012-04-25 14:40:43 -0400] geekbri: oh well answered my own question.  The answer is yes, it looks like this        :kind_of => [ TrueClass, FalseClass ]
[2012-04-25 14:42:12 -0400] sampikesley: yeah, that sucks donkey bals
[2012-04-25 14:42:39 -0400] sampikesley: I gt kicked because I assumed I could use kind_of: Boolean
[2012-04-25 14:42:47 -0400] sampikesley: But no
[2012-04-25 14:45:04 -0400] geekbri: Yeah, thats just a ruby thing.  I had a feeling it would the case
[2012-04-25 14:49:25 -0400] geekbri: and by weird feeling I mean, I knew i couldn't use Boolean, but I was hoping I tried it anyway because sometimes miracles happen
[2012-04-25 14:55:12 -0400] pwelch__: hey everyone
[2012-04-25 14:55:30 -0400] pwelch__: has anyone ever done bind DNS server with chef?
[2012-04-25 15:00:59 -0400] sampikesley: thought it might be a good exercise in writing some LWRPs
[2012-04-25 15:28:41 -0400] rgsteele: Can data bags be used in attributes files?  E.g.: node[:foo][:bar] = data_bag_item('foo', 'bar')
[2012-04-25 15:30:14 -0400] yfeldblum: rgsteele, please don't do that ...
[2012-04-25 15:32:37 -0400] rgsteele: yfeldblum: I don't think it's supported, anyways.  But out of curiosity, what's inherently evil about that approach?
[2012-04-25 15:32:42 -0400] yfeldblum: rgsteele, attributes files in recipes should set up sensible defaults only, possibly platform-specific defaults or possibly ohai-dependent defaults, but should never need to go to disk, go to the network, etc
[2012-04-25 15:34:04 -0400] yfeldblum: also, everything in the attributes files should typically be set at the default level, not normal (should be reserved for sysadmins and highly specific cases in recipes) or override level (should be reserved for roles & environments)
[2012-04-25 15:34:28 -0400] rgsteele: <= sysadmin
[2012-04-25 15:35:28 -0400] yfeldblum: normal-level attributes should be reserved for `knife node edit NAME`, and should not be used in cookbooks' attributes files and should very sparingly and very cautiously be used in cookbooks' recipes
[2012-04-25 15:38:24 -0400] rgsteele: Yeah, that's how I'm using them.  I just wasn't sure if there was something more than semantics that lead to them being advertised for use in recipes only.
[2012-04-25 15:38:59 -0400] yfeldblum: also, data bags are like mysql tables and data bag items are like single records in mysql - you would never have a webapp that does this: def show ; @post = Post.find(3) end
[2012-04-25 15:39:53 -0400] yfeldblum: you always have: def show ; @post = Post.find(params["id"]) ; check_if_allowed_to_view(@post) ; end
[2012-04-25 15:39:56 -0400] rgsteele: Eh, as a SA I'm not writing webapps.  System/service config files, primarily.
[2012-04-25 15:41:22 -0400] rgsteele: I'm still not sure what's evil about it, but if it's not recommended then that's fine, there are plenty of ways to skin a cat.
[2012-04-25 15:41:33 -0400] rgsteele: Thanks.
[2012-04-25 15:42:08 -0400] yfeldblum: alright, well, when you have a database with tables and records, you typically don't hardcode record id's (like record #34) right into your code - you typically discover the record id some other way e.g. via envvar, stdin, etc
[2012-04-25 15:42:31 -0400] yfeldblum: or in chef, via roles, via search, via normal-level node attributes, etc
[2012-04-25 15:46:00 -0400] yfeldblum: cookbooks should typically not know about individual data bags (tables) and should typically have the name of the data bag (table) be configured via attribute (but may have a sensible default name configured in an attributes file); but should absolutely for sure definitely not know about individual data bag items (records) by name
[2012-04-25 15:50:28 -0400] matthewvermaak: !lockstaging
[2012-04-25 15:50:38 -0400] matthewvermaak: well, that wouldnt be helpful to you guys
[2012-04-25 15:55:01 -0400] jtimberman: rgsteele: do calculation and external data retrieval for attributes in recipes.
[2012-04-25 15:55:21 -0400] jtimberman: i'd just as soon attributes/* be json :)
[2012-04-25 15:55:25 -0400] rgsteele: Heh
[2012-04-25 15:55:38 -0400] jtimberman: (it has been suggested, but i don't even know if there's a ticket for it)
[2012-04-25 15:55:45 -0400] hoover_damn: please don't make attributes json
[2012-04-25 15:55:53 -0400] jtimberman: i'm not going to
[2012-04-25 15:55:59 -0400] hoover_damn: :)
[2012-04-25 15:56:01 -0400] yfeldblum: jtimberman, no, attributes/* needs e.g. value_for_platform etc
[2012-04-25 15:56:21 -0400] hoover_damn: everything needs value_for_yin_and_yang
[2012-04-25 15:56:25 -0400] yfeldblum: jtimberman, as well as everything that ohai gives
[2012-04-25 15:56:26 -0400] jtimberman: yfeldblum: case node['platform']?
[2012-04-25 15:56:34 -0400] yfeldblum: jtimberman, can't do that in json
[2012-04-25 15:56:35 -0400] jtimberman: yfeldblum: yeah thats why it never went anywhere.
[2012-04-25 15:56:37 -0400] jtimberman: so rather
[2012-04-25 15:57:01 -0400] jtimberman: "i'd just as soon treat attributes/* _like_ json" <-- better? :D
[2012-04-25 15:57:26 -0400] yfeldblum: also, *defaults are not data* - they often *must* be computed (from other defaults or from the equivalent of global variables)
[2012-04-25 15:58:27 -0400] jtimberman: default['webserver']['workers'] = cpu['total'] * 2
[2012-04-25 16:01:04 -0400] organicveggie: Working on upgrading from 0.9.14 to 0.10.8.  Having problems with chef-client. CentOS 6.2 on EC2. Error is "Address family not supported by protocol - socket(2)". Any suggestions?
[2012-04-25 16:01:29 -0400] sampikesley: is your couchdb still borked?
[2012-04-25 16:01:41 -0400] organicveggie: nope. chef-server is fine now. :)
[2012-04-25 16:01:48 -0400] organicveggie: this is on a separate node.
[2012-04-25 16:02:05 -0400] organicveggie: I can telnet from the other node to the chef server on port 4000 just fine. :(
[2012-04-25 16:02:11 -0400] rgsteele: I do have one other question regarding databags - what's the best way to load the entire thing locally as a hash?  I saw the search(:mybagid, "*:*") example on the wiki, but that seems to emphasize assigning each top-level key as a variable.
[2012-04-25 16:02:36 -0400] rgsteele: I'd prefer to just assign the entire hash to a variable, and deal with it from there as I would any other Ruby hash.
[2012-04-25 16:04:46 -0400] organicveggie: Just realized I am still having *one* issue with the chef-server.  May be related.
[2012-04-25 16:05:07 -0400] organicveggie: Trying to create my initial client: "Failed to authenticate to http://localhost:4000 as chef-webui with key /etc/chef/webui.pem"
[2012-04-25 16:05:21 -0400] organicveggie: This is as root, so it does have access to /etc/chef/webui.pem.
[2012-04-25 16:10:20 -0400] yfeldblum: jtimberman, exactly
[2012-04-25 16:11:56 -0400] yfeldblum: record = data_bag_item("my-data-bag-name", "my-data-bag-item-name")
[2012-04-25 16:11:56 -0400] sagar_nikam: @jtimberman: i am trying the hadoop cookbook http://community.opscode.com/cookbooks/hadoop
[2012-04-25 16:12:14 -0400] sagar_nikam: i have set the roles and default attributes
[2012-04-25 16:12:42 -0400] sagar_nikam: on executing the command knife ssh 'name:server-89413.localdomain' -a node.ipaddress 'sudo chef-client' -i keyfile
[2012-04-25 16:12:57 -0400] rshade98: is there a way to restart with runit_service or should I use execute "srv -r service_name"
[2012-04-25 16:13:24 -0400] sagar_nikam: i am getting the following error
[2012-04-25 16:13:25 -0400] sagar_nikam: : package[hadoop] (hadoop::default line 37) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for hadoop
[2012-04-25 16:13:49 -0400] rshade98: sagar, what os?
[2012-04-25 16:14:23 -0400] btm: rshade98: after you create the service with runit service, you can restart it with the service resource and action :restart
[2012-04-25 16:15:25 -0400] sagar_nikam: ubuntu
[2012-04-25 16:16:12 -0400] rshade98: @btm how does it know whether its runit or init
[2012-04-25 16:16:16 -0400] rshade98: I am running both
[2012-04-25 16:18:03 -0400] rshade98: do I need to specify a provider like Chef::Provider::Service::runit?
[2012-04-25 16:18:21 -0400] rshade98: sagar what happens when you apt-get install hadoop
[2012-04-25 16:19:05 -0400] yfeldblum: rshade98, https://github.com/opscode-cookbooks/runit/blob/master/definitions/runit_service.rb#L147-162
[2012-04-25 16:19:19 -0400] yfeldblum: runit_service is a definition, not a provider
[2012-04-25 16:19:37 -0400] yfeldblum: (currently)
[2012-04-25 16:22:38 -0400] ssd7: Ohai Chefs
[2012-04-25 16:24:22 -0400] sagar_nikam: rshade98: i need to run this on the node ?
[2012-04-25 16:25:21 -0400] rshade98: yeah, you will want to see if the repo is enabled and the underlying system can install hadoop
[2012-04-25 16:25:44 -0400] sagar_nikam: ok trying that now
[2012-04-25 16:26:59 -0400] sagar_nikam: rshade98: this is the error --- E: Unable to locate package hadoop
[2012-04-25 16:29:26 -0400] rshade98: sagar ok, check apt-get update and see if cloudera is in the list or if there is an error
[2012-04-25 16:31:00 -0400] sagar_nikam: rshade98: W: Failed to fetch http://archive.cloudera.com/debian/dists/oneiric/contrib/source/Sources  404  Not Found  W: Failed to fetch http://archive.cloudera.com/debian/dists/oneiric/contrib/binary-amd64/Packages  404  Not Found  W: Failed to fetch http://archive.cloudera.com/debian/dists/oneiric/contrib/binary-i386/Packages  404  Not Found
[2012-04-25 16:31:27 -0400] geekbri: Am I right in noticing that the only way to install a specific gem version with gem_package is to pass in the --version paramter with options() inside the resource ?
[2012-04-25 16:32:22 -0400] rshade98: sagar, so you will need to update templates/default/cloudera.list.erb with the right location
[2012-04-25 16:32:40 -0400] rshade98: there might not be an oneiric hadoop package yet
[2012-04-25 16:33:30 -0400] rshade98: geekbri, that is probably the best way, unless you want to download the specific gem, then install it manually
[2012-04-25 16:33:30 -0400] sagar_nikam: rshade98: thanks
[2012-04-25 16:33:52 -0400] geekbri: I do not :_
[2012-04-25 16:33:53 -0400] geekbri: :)
[2012-04-25 16:41:04 -0400] sagar_nikam: rshade98:does this set the ubuntu version -  <%= @node[:lsb][:codename] %>
[2012-04-25 16:49:47 -0400] rshade98: rshade98 it sets the name version, not the number version
[2012-04-25 16:51:51 -0400] sagar_nikam: rshade98 - i changed the cloudera.list.erb to have this
[2012-04-25 16:52:12 -0400] sagar_nikam: deb http://archive.cloudera.com/debian <%= @node[:lsb][:codename] %>-cdh3 contrib
[2012-04-25 16:52:40 -0400] sagar_nikam: after running the command knife ssh 'name:server-89413.localdomain' -a node.ipaddress 'sudo chef-client' -i
[2012-04-25 16:52:47 -0400] sagar_nikam: i am getting a new error now
[2012-04-25 16:53:12 -0400] sagar_nikam: 10.6.55.159 [Wed, 25 Apr 2012 16:49:34 +0000] ERROR: Exception handlers complete 10.6.55.159 [Wed, 25 Apr 2012 16:49:34 +0000] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out 10.6.55.159 [Wed, 25 Apr 2012 16:49:34 +0000] FATAL: ArgumentError: Attribute hadoop is not defined!
[2012-04-25 16:56:07 -0400] rshade98: sagar I don't see oneiric-cdh3 here: http://archive.cloudera.com/debian/dists/
[2012-04-25 16:58:42 -0400] sagar_nikam: rshade98: correct just saw that
[2012-04-25 16:58:51 -0400] sagar_nikam: so next step for me would be ....
[2012-04-25 16:58:52 -0400] hoover_damn: i don't see natty either
[2012-04-25 16:58:58 -0400] hoover_damn: cloudera getting old?
[2012-04-25 16:59:03 -0400] sagar_nikam: do i use any other cookbook ?
[2012-04-25 16:59:58 -0400] sagar_nikam: i need to quickly setup a hadoop cluster. to start with single node is also fine
[2012-04-25 17:00:10 -0400] hoover_damn: https://ccp.cloudera.com/display/CDHDOC/Before+You+Install+CDH3+on+a+Cluster#BeforeYouInstallCDH3onaCluster-SupportedOperatingSystemsforCDH3
[2012-04-25 17:00:16 -0400] sagar_nikam: rshade98: what's the best way to do it
[2012-04-25 17:00:21 -0400] hoover_damn: sagar_nikam, the supported distributions are in that link
[2012-04-25 17:01:47 -0400] sagar_nikam: i can use maverick. should i try that
[2012-04-25 17:02:06 -0400] sagar_nikam: or do i use some other cookbook
[2012-04-25 17:02:12 -0400] sagar_nikam: if it is available
[2012-04-25 17:02:43 -0400] hoover_damn: if you want to use Cloudera, that's what you use.
[2012-04-25 17:02:59 -0400] hoover_damn: now what cookbook are you using? sorry i'm not scrolling up
[2012-04-25 17:04:40 -0400] sagar_nikam: hoover_damn: i am using the cookbook http://community.opscode.com/cookbooks/hadoop
[2012-04-25 17:04:52 -0400] rshade98: sagar I would say use maverick
[2012-04-25 17:05:30 -0400] sagar_nikam: rshade98: ok, will do that
[2012-04-25 17:05:31 -0400] rshade98: there is definitely a maverick-cdh3
[2012-04-25 17:05:32 -0400] geekbri: Im running a fairly large hadoop cluster on ubuntu 10.10 without too much issue.
[2012-04-25 17:06:03 -0400] sagar_nikam: also where do i define attributes. i have done it in roles and added the default attribute
[2012-04-25 17:06:33 -0400] sagar_nikam: geekbri: which cookbook are you using ?
[2012-04-25 17:06:55 -0400] geekbri: sagar_nikam: We forked that hadoop cookbook and made pretty massive changes to it
[2012-04-25 17:07:20 -0400] hoover_damn: sagar_nikam, hrm well infochimps had one... but i can't seem to find it
[2012-04-25 17:07:30 -0400] geekbri: That info chimps one, for me, was a disaster
[2012-04-25 17:07:34 -0400] geekbri: but i believe its called "hadoop_cluster
[2012-04-25 17:07:34 -0400] geekbri: "
[2012-04-25 17:07:37 -0400] geekbri: or something like that.
[2012-04-25 17:07:51 -0400] sagar_nikam: hoover_damn: i think infochimps is now ironfan
[2012-04-25 17:08:12 -0400] sagar_nikam: i would first like to try out a single node cluster
[2012-04-25 17:09:03 -0400] sagar_nikam: geekbri: the cookbook which you made changes . the modified one. is it available on github ?
[2012-04-25 17:09:36 -0400] hoover_damn: https://github.com/infochimps-labs/ironfan-pantry/tree/master/cookbooks/hadoop_cluster
[2012-04-25 17:09:44 -0400] hoover_damn: yeah it looks like you want what's in the pantry now sagar_nikam
[2012-04-25 17:11:57 -0400] geekbri: sagar_nikam: unfortunately it is not yet.  We have some very us specific stuff in it.  Someday when we have time we will yank that stuff out and make it public but unfortunately we dont have time for that right now
[2012-04-25 17:12:44 -0400] organicveggie: Trying to setup a new 0.10.8 chef server on CentOS 6.2 (EC2). Running knife configure says that my client key is invalid. I see the same error in the chef server log. What's the easiest way to recreate the webui.pem?
[2012-04-25 17:12:50 -0400] sagar_nikam: so what next step for me. try out maverick
[2012-04-25 17:13:12 -0400] sagar_nikam: i was doing some googling and found abt dell crowbar
[2012-04-25 17:13:18 -0400] sagar_nikam: which is on chef
[2012-04-25 17:13:23 -0400] rshade98: sagar I would say maverick is the easiest
[2012-04-25 17:13:24 -0400] sagar_nikam: anybody has used it ?
[2012-04-25 17:13:32 -0400] rshade98: and its a long term release
[2012-04-25 17:13:58 -0400] geekbri: yes thats what i was saying, I am succesfully using ubuntu 10.10 (maverick) with a fairly large hadoop setup
[2012-04-25 17:14:09 -0400] geekbri: ~ 40 nodes, with a NN, JT and SNN
[2012-04-25 17:14:28 -0400] geekbri: I did however find that I needed to modify the existing hadoop cookbooks for my needs
[2012-04-25 17:14:40 -0400] geekbri: chances are you will too
[2012-04-25 17:14:50 -0400] rgsteele: yfeldblum: Were you talking to me when you said "record = data_bag_item("my-data-bag-name", "my-data-bag-item-name")" ?
[2012-04-25 17:14:54 -0400] rgsteele: I had walked away for lunch
[2012-04-25 17:15:03 -0400] yfeldblum: rgsteele, yes
[2012-04-25 17:15:54 -0400] rgsteele: Cool, so that'll stuff the entire databag with id 'my-data-bag-name' into a variable?
[2012-04-25 17:15:56 -0400] rgsteele: Interesting
[2012-04-25 17:16:29 -0400] rgsteele: yfeldblum: Thanks.
[2012-04-25 17:17:26 -0400] yfeldblum: rgsteele, yes, possibly something like a Chef::DataBagItem instance (sort of like Chef::Node) but you can get at the data in it much like a Hash
[2012-04-25 17:18:27 -0400] rgsteele: yfeldblum: Is this behavior documented anywhere?
[2012-04-25 17:20:13 -0400] yfeldblum: rgsteele, http://wiki.opscode.com/display/chef/Data+Bags#DataBags-UsingDataBagsinRecipes
[2012-04-25 17:21:29 -0400] rgsteele: I don't see any example of it loading the entire bag into a data structure.
[2012-04-25 17:21:48 -0400] rgsteele: I see examples of of loading the keys into a variable
[2012-04-25 17:24:13 -0400] yfeldblum: rgsteele, hmm it may just give you a Hash
[2012-04-25 17:24:22 -0400] sagar_nikam: rshade98: will try maverick and let you know how it goes tomorrow
[2012-04-25 17:24:56 -0400] yfeldblum: data_bag_item('admins', 'charlie')
[2012-04-25 17:24:57 -0400] yfeldblum: # => {"comment"=>"Crazy Charlie", "gid"=>1005, "id"=>"charlie", "uid"=>1005, "shell"=>"/bin/zsh"}
[2012-04-25 17:26:02 -0400] afallows: Has anyone here used chef to maintain a clone of a Git repo on a machine? I'm interested in best practices for things like when to pull, how often to check, what to do if there are local changes, etc.
[2012-04-25 17:26:31 -0400] rgsteele: yfeldblum: Right, but that's only loading the value of the key 'charlie'
[2012-04-25 17:26:40 -0400] rgsteele: I want the entire structure - all the keys.
[2012-04-25 17:28:01 -0400] yfeldblum: rgsteele, a data bag is like a table in a database, and a data bag item is like a record in that table ... you NEVER load the entire table into memory in an application; you always select one or a few records from that table that you will actually use and just load those
[2012-04-25 17:29:34 -0400] newb: the MAC hardcoded with the box: where would that be stored by vagrant?
[2012-04-25 17:30:42 -0400] rgsteele: In this case, it was a pretty small databag, and I was trying to minimize the number of API calls to the server.  http://wiki.opscode.com/display/chef/Data+Bags#DataBags-LoadingDataBagsthroughtheSearchInterface mentions that search can be used to "load all of the items in the data bag", but the example seems to indicate that search(:bag, "*:*") returns the keys, which the example iterates over.
[2012-04-25 17:33:59 -0400] rgsteele: But, I can work with search.  I was just wondering if it was possible to leverage Chef::Databag::to_hash via the DSL.
[2012-04-25 17:34:04 -0400] newb: @Blah1, purse bash script heredocs will do what you want
[2012-04-25 17:34:13 -0400] newb: s/purse/pure
[2012-04-25 17:35:57 -0400] qhartman: Yesterday when the EPEL repo was down, it totally crippled my chef installation because anything that referenced package management and loaded yum.rb killed chef. We're running chef 0.10.0. I know a bunch of yum-related fixes have gone in since then. Does anyone know if this particular case has been covered?
[2012-04-25 17:40:38 -0400] mattray: qhartman: when 0.10.10 is finalized, you should get on the full stack chef client, that'll make Chef a little less dependent on EPEL
[2012-04-25 17:41:00 -0400] mattray: at least the chef-client won't have any distro dependencies
[2012-04-25 17:41:56 -0400] newb: when would 0.10.10 be finalized (aprrox)?
[2012-04-25 17:41:59 -0400] qhartman: mattray, well, in this case it was caused by the output of yum-dump.py handing an error message to yum.rb that it didn't know how to parse. So it wasn't really a dependency issue per se.
[2012-04-25 17:42:07 -0400] qhartman: That will be super nice though
[2012-04-25 17:42:43 -0400] qhartman: We don't use RH-likes internally, we just support them for our clients and it seems like we get bit by distro-specific stuff everytime we touch them.
[2012-04-25 17:43:05 -0400] mattray: yeah, full stack client is exactly what you want. Same Chef experience on every distro and platform
[2012-04-25 17:43:34 -0400] qhartman: nice
[2012-04-25 17:43:46 -0400] qhartman: is there an eta on that?
[2012-04-25 17:44:00 -0400] mattray: ML has a thread about it, I think beta 1 is now-ish
[2012-04-25 17:44:15 -0400] mattray: but I've been using the full stack on RHEL since January
[2012-04-25 17:44:23 -0400] mattray: it's a godsend
[2012-04-25 17:45:00 -0400] qhartman: cool. I have a task on my plate to build a production-only automation stack, so I probably won't be getting in on that in the near future, but it's nice to know it's coming
[2012-04-25 17:45:11 -0400] jtimberman: newb: there'll be another post to the mailing list this afternoon after our code review meeting
[2012-04-25 17:45:16 -0400] hoover_damn: mattray, lol is that because rhel sucks for ruby?
[2012-04-25 17:45:17 -0400] mattray: qhartman: all you need is this bootstrap template to start using it today
[2012-04-25 17:45:18 -0400] mattray: https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/chef-full.erb
[2012-04-25 17:45:21 -0400] riddopic: Hello, I was trying to see if I could find a copy of the Chef-Server Omnibus installer, even a beta copy will do.
[2012-04-25 17:45:21 -0400] jtimberman: newb: will probably have a blurb about 0.10.10 release candidate.
[2012-04-25 17:45:31 -0400] qhartman: sweet, I'll definitely be checking that out
[2012-04-25 17:45:49 -0400] mattray: riddopic: source for the installer builder is up, I don't think there are any server builds out yet
[2012-04-25 17:46:06 -0400] yfeldblum: rgsteele, data_bag("admins") returns the names (ids) of the data bag items; search("admins", "*:*") returns an array of all of the data bag items in the "admins" data bag
[2012-04-25 17:46:45 -0400] riddopic: Thanks mattray. Do you know if it's possible for me to build the RPMs myself for the chef-server?
[2012-04-25 17:47:19 -0400] riddopic: I thought I could by git cloning the omnibus repo but all I seem to get is a simple tar ball?
[2012-04-25 17:47:51 -0400] mattray: riddopic: look through http://rpm.aegisco.com or http://rbel.frameos.org for details
[2012-04-25 17:48:12 -0400] mattray: riddopic: we don't make RPMs ourselves except for client full stack so far
[2012-04-25 17:48:34 -0400] newb: @jtimberman, After 0.10.10, Would there still be a need to have someone write a complete set of scripts + recipes that employ veewee + vagrant and setup you privtae chef server from scratch (you need to provide only the OS iso, but veewee even fetches that for you if you don't have it) ?
[2012-04-25 17:48:38 -0400] riddopic: Ah so there are no RPMs for chef server then.
[2012-04-25 17:48:54 -0400] mattray: riddopic: not from Opscode, but those 2 urls have some
[2012-04-25 17:49:27 -0400] riddopic: OK, thanks. I was hoping for the Ruby 1.9 omnibus coolness all together for the server too. Thanks for you help
[2012-04-25 17:49:31 -0400] mattray: someday
[2012-04-25 17:49:36 -0400] mattray: riddopic: someday :)
[2012-04-25 17:50:01 -0400] mattray: we're building Private Chef Server for RHEL with the same bits we open sourced, so it's coming
[2012-04-25 17:50:27 -0400] mattray: but no solid ETAs :(
[2012-04-25 17:53:08 -0400] hoover_damn: mattray, you poor thing
[2012-04-25 17:53:30 -0400] mattray: hoover_damn: ?
[2012-04-25 17:53:36 -0400] hoover_damn: I haven't had to run chef server on rhel in awhile
[2012-04-25 17:53:47 -0400] hoover_damn: and to get all the bits open sourced so it's easy out of the box
[2012-04-25 17:53:56 -0400] hoover_damn: meh you might as well make a rhel image with chef-server baked on it by default
[2012-04-25 17:54:17 -0400] mattray: yeah, RHEL is not my first choice for operating systems
[2012-04-25 17:54:20 -0400] hoover_damn: mattray, are we still rocking mine/imeyer's runit rpms?
[2012-04-25 17:54:43 -0400] c_t: I always read RHEL to myself as "R-hell"
[2012-04-25 17:54:49 -0400] mattray: hoover_damn: no idea, I'm not in the loop, I'm just a consumer
[2012-04-25 17:55:00 -0400] mattray: "take these RPMs and go install"
[2012-04-25 17:55:17 -0400] hoover_damn: mattray, poor thing
[2012-04-25 17:55:26 -0400] hoover_damn: c_t, it pretty much is
[2012-04-25 17:55:56 -0400] mattray: luckily I have automation to help me get past the things I dislike, like the OS
[2012-04-25 17:55:58 -0400] hoover_damn: c_t, rotted distros become a bit of a bore/snore to maintain
[2012-04-25 17:55:59 -0400] c_t: sure, debian has its own Fun Stuff
[2012-04-25 17:56:09 -0400] hoover_damn: debian has it's own pain
[2012-04-25 17:56:41 -0400] hoover_damn: the problem is I find more people and myself dealing with distro pains... then solving them
[2012-04-25 17:56:56 -0400] hoover_damn: which means I must over care, or ..
[2012-04-25 17:57:02 -0400] hoover_damn: possibly a little of a and b
[2012-04-25 17:57:35 -0400] c_t: at least stuff usually seems to ship in RHEL/etc. and Debian/Ubuntu/etc. forms these days
[2012-04-25 17:57:49 -0400] c_t: as opposed to when it was disturbingly common for just RPMs
[2012-04-25 18:33:43 -0400] geekbri: I love debian but creating .debs is not even slightly fun
[2012-04-25 18:33:46 -0400] geekbri: Its a total pain
[2012-04-25 18:34:32 -0400] heph: miah: looks like i'm going to chefconf. it's weird to work at a company that actually lets you spend money on things ;]
[2012-04-25 18:36:58 -0400] aslan: is there one knife command that can get a dump of all of the roles and their run lists ?
[2012-04-25 18:37:53 -0400] jtimberman: geekbri: have you tried fpm?
[2012-04-25 18:38:12 -0400] jtimberman: https://github.com/jordansissel/fpm
[2012-04-25 18:38:14 -0400] heph: geekbri: to the contrary, i've found creating debs to be remarkably easy, once you already know how to do it. the problem is in the documentation. never did find a good cliff's notes version of how to build a deb =]
[2012-04-25 18:38:15 -0400] jtimberman: its fantastic.
[2012-04-25 18:38:24 -0400] heph: also, fpm is pretty fantastic
[2012-04-25 18:38:26 -0400] jtimberman: cliff's notes in that gem.
[2012-04-25 18:39:19 -0400] geekbri: looks like fpm might be the solution to my problem
[2012-04-25 18:39:28 -0400] geekbri: but that says something about the .deb creation process now doesnt it:)
[2012-04-25 18:39:47 -0400] geekbri: heph: that was my issue.  I have yet to find good documentation that explains how to create a deb in a clear readable and understandable fashion
[2012-04-25 18:40:08 -0400] geekbri: ive used checkinstall a bunch of times to just generate .debs from make make install stuff but, thats not a very robust solution
[2012-04-25 18:43:38 -0400] shadoi: geekbri: https://github.com/devstructure/debra
[2012-04-25 18:44:22 -0400] shadoi: we've had quite a few problems with fpm > 0.4 lately.
[2012-04-25 18:44:27 -0400] shadoi: probably moving to that.
[2012-04-25 18:45:02 -0400] geekbri: right, i guess the difference being fpm lets you build rpms as well
[2012-04-25 18:47:36 -0400] afallows: Could someone help me understand custom bootstrap scripts a little better? I'm trying to bootstrap an EC2 node using an AMI that already has chef installed (as a gem through RVM). My bootstrap script makes a symlink between the RVM bin for chef and /usr/bin, but when I run knife to create an instance, I get the error: /etc/bin/chef-client: No such file or directory.
[2012-04-25 18:48:34 -0400] afallows: It's also a little confusing because the error says it's on line 74 and my script isn't 74 lines long.
[2012-04-25 18:49:36 -0400] newb: what does 'which chef-client' on the clients return?
[2012-04-25 18:49:56 -0400] newb: login with the same user as the bootstrap
[2012-04-25 18:50:58 -0400] afallows: It returns /usr/local/rvm/.../bin/chef-client
[2012-04-25 18:51:32 -0400] afallows: So I have "ln -nfs $(which chef-client) /usr/bin/chef-client" as a line in the script.
[2012-04-25 18:53:11 -0400] newb: afallows, would that solve your problem?
[2012-04-25 18:53:28 -0400] afallows: newb: I certainly expected it to, but I'm still getting the error.
[2012-04-25 18:53:48 -0400] newb: exactly, you are messing around with RVM
[2012-04-25 18:54:01 -0400] afallows: I may have to gist up my script and link it to see if someone can catch what I'm missing.
[2012-04-25 18:54:06 -0400] newb: sure
[2012-04-25 18:54:38 -0400] hoover_damn: afallows, until 0.10.10 chef hardcodes the location of the chef-client binary to /usr/bin
[2012-04-25 18:54:38 -0400] newb: afallows, is there a reason why you would like to rvm your ruby on your managed nodes?
[2012-04-25 18:55:34 -0400] afallows: newb: The nodes in question are production instances for my dev team's projects. They use RVM, and while I wouldn't, I'm an intern who doesn't have the say-so to scrap it.
[2012-04-25 18:55:50 -0400] newb: hoover_damn, let's see the reason why afallows wants to rvm; however, why would hardcoding the location of the chef-client binary to /usr/bin be a good idea?
[2012-04-25 18:56:12 -0400] hoover_damn: newb, I don't value any reason to use RVM... I find all reasons to be copouts
[2012-04-25 18:56:24 -0400] hoover_damn: and I understand it's not his choice, it's his pain
[2012-04-25 18:57:31 -0400] newb: afallows, even as an intern you have a say in good architecture. tell your supervisor that they should host a node per ruby version
[2012-04-25 18:57:49 -0400] hoover_damn: rvm is great for development... for production it's never been a sane thought
[2012-04-25 18:57:59 -0400] newb: hoover_damn, why would hardcoding the location of the chef-client binary to /usr/bin be a good idea? why not have it as a node attrib?
[2012-04-25 18:58:00 -0400] hoover_damn: and even wayne agreed with me at one point
[2012-04-25 18:58:09 -0400] hoover_damn: no clue if he would today, and don't care
[2012-04-25 18:58:24 -0400] hoover_damn: newb, it's a knife.rb attribute now as of 0.10.10 :)
[2012-04-25 18:58:37 -0400] hoover_damn: newb, it was a assumption that gems were in /usr/bin
[2012-04-25 18:59:04 -0400] newb: ah yes! I have been having issues as I make install into /opt/site/ruby
[2012-04-25 18:59:12 -0400] hoover_damn: yup
[2012-04-25 18:59:26 -0400] afallows: I also have the joy of managing RVM in multi-user mode.
[2012-04-25 18:59:32 -0400] hoover_damn: I ended up hacking my chef gem locally to do `which chef-client`
[2012-04-25 19:00:01 -0400] hoover_damn: ideally it should be using ohai to know where to find it
[2012-04-25 19:00:29 -0400] afallows: https://gist.github.com/2492295
[2012-04-25 19:00:57 -0400] hoover_damn: but even the ohai idea could be wrong at times
[2012-04-25 19:01:03 -0400] hoover_damn: hohum
[2012-04-25 19:01:13 -0400] afallows: I think it's bailing somwhere in lines 25-28, but no idea why
[2012-04-25 19:04:14 -0400] newb: hoover_damn, you did mention "until 0.10.10 chef hardcodes the location of the chef-client binary to /usr/bin": that confused me
[2012-04-25 19:04:43 -0400] afallows: I read it as "Every version before 0.10.10 hardcodes it"
[2012-04-25 19:04:45 -0400] newb: current chef has a 'gem_dir', 'ruby_bin' attribs but does not seem to honour it
[2012-04-25 19:05:12 -0400] newb: oh, you mean "until 0.10.10, chef hardcodes the location of the chef-client binary to /usr/bin"?
[2012-04-25 19:05:19 -0400] newb: my nlp is weak
[2012-04-25 19:07:17 -0400] hoover_damn: afallows, right
[2012-04-25 19:07:56 -0400] afallows: This is really frustrating, especially since I've been using a different bootstrap script which uses the exact same process to link chef-client to the RVM binary and that script hasn't failed. But I also didn't write it.
[2012-04-25 19:07:56 -0400] hoover_damn: afallows, https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/core/bootstrap_context.rb#L85 wil hit in 0.10.10
[2012-04-25 19:08:38 -0400] hoover_damn: afallows, but until then bootstrap_context is actually https://github.com/opscode/chef/blob/da56fb5e89d531661061742bada3c32a72257e13/chef/lib/chef/knife/core/bootstrap_context.rb#L83
[2012-04-25 19:08:48 -0400] newb: awesome. until then, is there a way to "get around" it? as I said, I exected 'gem_dir', 'ruby_bin' attribs to be honoured, but apparently not?
[2012-04-25 19:08:52 -0400] hoover_damn: which means you end up symlinking or doing other stupid actions to get it in /usr/bin
[2012-04-25 19:09:02 -0400] hoover_damn: pre-release gem of 0.10.10 is out
[2012-04-25 19:09:08 -0400] hoover_damn: so you are free to make use of said knob now
[2012-04-25 19:09:13 -0400] hoover_damn: just bootstrap with prerelease
[2012-04-25 19:15:47 -0400] afallows: Thanks for the info on 0.10.10, hoover_damn.
[2012-04-25 19:17:27 -0400] afallows: I was able to fix it, but not in a pretty way. I replaced $(which chef-client) with a hardcoded path (fighting fire with fire, I guess) and it worked.
[2012-04-25 19:57:35 -0400] gsat: is this a bug in knife ? with chef 10.8 , i get WARNING: Failed to connect to node[XXXXXXXX] -- SocketError: getaddrinfo: Name or service not known
[2012-04-25 19:58:32 -0400] afallows: gsat: What command resulted in that warning?
[2012-04-25 19:58:47 -0400] gsat: knife ssh
[2012-04-25 19:59:36 -0400] gsat: afallows:knife ssh "hostname:XXXXXXX" "chef-client"
[2012-04-25 20:00:44 -0400] afallows: gsat: Unfortunately, I haven't used knife ssh at all before, so I doubt I'll be much help.
[2012-04-25 20:00:45 -0400] hoover_damn: try using -a and telling it how to find the ipaddress
[2012-04-25 20:00:59 -0400] hoover_damn: knife ssh "host:bob" "foo" -a ipaddress
[2012-04-25 20:01:02 -0400] hoover_damn: or ec2_..
[2012-04-25 20:07:45 -0400] Axsuul: What is the right way to run a command and get the return value? Using the backticks?
[2012-04-25 20:08:12 -0400] afallows: Axsuul: Speaking strictly in terms of ruby, you can use backticks or wrap the command in %X[]
[2012-04-25 20:08:14 -0400] gsat: hoover_damn: this is a local host (not ec2) , and -a ipaddress works, so is this  a bug ? default should work , correct?
[2012-04-25 20:08:20 -0400] afallows: s/X/x/
[2012-04-25 20:16:43 -0400] hoover_damn: gsat, -a ipaddress is correct behavior
[2012-04-25 20:17:03 -0400] hoover_damn: gsat, if you want to use chef to build a .ssh/config for example so you can ssh around easier... I would suggest a plugin
[2012-04-25 20:18:33 -0400] Axsuul: Is there any way to get a user's id through chef? I tried using the User resource such as... foo = user "root"; foo.uid
[2012-04-25 20:21:26 -0400] Axsuul: afallows: also, thanks earlier
[2012-04-25 20:21:56 -0400] Axsuul: Also, I'm getting the current UID with.. id -u USERNAME, but is there any way to do it through Chef?
[2012-04-25 20:25:40 -0400] jhowarth: Is there a way to print out the resources a recipe knows about?
[2012-04-25 20:25:47 -0400] jhowarth: Possibly during a recipe run.
[2012-04-25 20:31:37 -0400] gsat: hoover_damn: thanks for the info, bu ti did not get "if you want to use chef to build a .ssh/config for example so you can ssh around easier... I would suggest a plugin" , can you pl explain pl ,
[2012-04-25 20:33:08 -0400] gsat: hoover_damn: can you pl provide pointer to ssh plugin pl!
[2012-04-25 20:39:14 -0400] hoover_damn: gsat, http://likens.us
[2012-04-25 20:40:23 -0400] hoover_damn: gsat, first link
[2012-04-25 20:41:09 -0400] afallows: hoover_damn: Someone uses Solarized.
[2012-04-25 20:41:36 -0400] hoover_damn: someone uses octopress
[2012-04-25 20:42:18 -0400] afallows: Aha. Did not know about Octopress.
[2012-04-25 20:42:40 -0400] hoover_damn: I run an old install of it
[2012-04-25 20:43:07 -0400] afallows: Well, they brag right on their home page that they use Solarized, so I was still right, just at an extra layer of abstraction.
[2012-04-25 20:43:44 -0400] hoover_damn: it's just jekyll
[2012-04-25 20:43:49 -0400] hoover_damn: with a crapton of plugins
[2012-04-25 20:44:41 -0400] chson: Is it possible to have two different versions of chef server use the same data bag source?
[2012-04-25 20:47:35 -0400] mattray: chson: what are you trying to do?
[2012-04-25 20:48:41 -0400] chson: mattray: ease into upgrading our chef infrastructure by having the new and old running concurrently
[2012-04-25 20:49:23 -0400] chson: mattray: so having one data bag source would be nice
[2012-04-25 20:50:02 -0400] mattray: chson: well your data bag is managed in source control, so just point knife at one server and upload it, then change out your config and point to the other server
[2012-04-25 20:50:11 -0400] mattray: and upload it
[2012-04-25 20:51:04 -0400] chson: mattray: well our data bags are in couchdb
[2012-04-25 20:51:18 -0400] mattray: knife data bag show blah -fj
[2012-04-25 20:51:24 -0400] mattray: that'll get you the json
[2012-04-25 20:52:20 -0400] mattray: or, knife data bag show blah item -fj
[2012-04-25 20:52:42 -0400] chson: mattray: right but the values in the data bag change often so doing the dumps routinely probably wouldn't suffice
[2012-04-25 20:53:31 -0400] mattray: right
[2012-04-25 20:55:28 -0400] zts: chson: that sounds like adding an awful lot of work and complexity to your upgrade... what versions are you moving between?
[2012-04-25 20:55:57 -0400] chson: 0.8.16 to 0.10.8
[2012-04-25 20:56:09 -0400] chson: ^ zts
[2012-04-25 20:56:17 -0400] organicveggie: Still stumped by chef-client error "Address family not supported by protocol ". chef 0.10.8 on CentOS 6.2. Ruby 1.8.7p352. Any bright ideas?
[2012-04-25 20:56:24 -0400] zts: :) then I can understand why you would want to be cautious
[2012-04-25 20:57:24 -0400] zts: do you have lots of different clients updating your databags, or a few clients making a lot of updates?
[2012-04-25 20:57:59 -0400] chson: zts: well it's not chef-clients it's users in operations/devs/etc
[2012-04-25 21:00:57 -0400] zts: understood.  I don't have a suggestion to achieve what you were asking for, unfortunately
[2012-04-25 21:01:36 -0400] zts: we have some internal tools which manage data bags, and we've got them pushing updates to multiple chef servers - but that's not very useful if the updates are being made by knife
[2012-04-25 21:02:26 -0400] zts: (and I imagine you've already got plenty of "Plan B's" that you're hoping to avoid)
[2012-04-25 21:06:40 -0400] chson: zts: well it's comforting to know that there isn't some data bag config I missed.
[2012-04-25 21:10:36 -0400] gsat: opensource chef server, any pointers to good/proven DR plan? how to backup/restore  chef  server, solr and couchDB etc.
[2012-04-25 21:11:26 -0400] gsat: hoover_damn: thanks fo rthe pointer to ssh config generation,
[2012-04-25 21:15:36 -0400] LinuxHorn: hey all
[2012-04-25 21:16:31 -0400] LinuxHorn: if i wanted to in a recipe search for all nodenames and primary ip addresses for the nodenames that have a specific role "buildslave" in their run_list, how would i do that?
[2012-04-25 21:16:42 -0400] LinuxHorn: (very new to chef, going through training in two weeks)
[2012-04-25 21:18:04 -0400] LinuxHorn: figured out the knife command :  knife search node "role:buildslave"
[2012-04-25 21:18:19 -0400] mattray: LinuxHorn: something like "knife search node role:buildslave"
[2012-04-25 21:18:23 -0400] mattray: :)
[2012-04-25 21:18:30 -0400] LinuxHorn: lol
[2012-04-25 21:18:39 -0400] mattray: add -a attribute to see a specific attribute
[2012-04-25 21:18:44 -0400] LinuxHorn: now i need to get just the eth0 to return
[2012-04-25 21:19:48 -0400] mattray: knife search node role:base -a network
[2012-04-25 21:19:54 -0400] mattray: err, role:buildslave
[2012-04-25 21:20:23 -0400] mattray: knife search node role:base -a network.interfaces.eth0
[2012-04-25 22:04:47 -0400] hippiehacker: http://tickets.opscode.com/browse/OHAI-357 # could I get some feedback on this ticket? Just a comment or two as too if we (me at this point) are going down the right track?
[2012-04-25 22:05:50 -0400] hippiehacker: and if my workaround of deleting automatic ohai data on the node via node.automatic['kernel'].delet 'pnp_drivers' is a decent work around?
[2012-04-25 22:06:48 -0400] hippiehacker: (basically between the generation of the ohai data [which is currently extremely verbose, and can't be disabled with Ohai::Config[[:disabled_plugins] without breaking chef], and the saving of the node data to the chef server)
[2012-04-25 22:07:46 -0400] ryker: hi folks.  I could have sworn I saw links on the community site for the omnibus chef-client installer not too long ago, but I can't find it.  I thought I would give it a try.  Anyone know where I can find it?
[2012-04-25 22:09:55 -0400] miketheman: http://www.opscode.com/chef/install/
[2012-04-25 22:18:41 -0400] miketheman: jtimberman: any idea on next version of apache2 cookbook release? the mod_logio problem just hit me
[2012-04-25 22:22:17 -0400] ryker: miketheman: lol.  thank you.  i guess i just kept going to the community site instead of the main site.
[2012-04-25 22:22:54 -0400] miketheman: ryker: no problem. It's pretty much a bookmark by now
[2012-04-25 22:27:00 -0400] miah: moin
[2012-04-25 22:27:48 -0400] ryker: miketheman: do you know if the installer is supposed to create a link to ruby?  It didn't create one and is expecting ruby to be at /usr/local/bin/ruby.
[2012-04-25 22:31:43 -0400] miketheman: ryker: that's odd. It's supposed to be self-contained, and not link or require anything outside /opt/opscode
[2012-04-25 22:31:57 -0400] miketheman: can you show my what you're seeing, via gist/pastebin?
[2012-04-25 22:35:18 -0400] ryker: miketheman: ah, i see the problem.  it was a file left over from a previous chef-client gem install.  I thought I had cleaned everything out, but apparently not
[2012-04-25 22:35:30 -0400] ryker: miketheman: sorry to bother you. thanks again
[2012-04-25 22:49:20 -0400] joemiller: got a strange issue i'm trying to figure out with this erlang cookbook, 'https://github.com/opscode-cookbooks/erlang'. On a fresh centos-5 vm, on the first chef-solo run (vagrant), it will try to pull down erlang R12B instead of R14B from the EPELerlang.repo. on the next run, it will correctly pull down R14B. the ordering looks fine, the EPELErlang.repo is put into place before `yum install` is called, but it's explicitly calling for versio
[2012-04-25 22:50:02 -0400] joemiller: trying to figure out why it's guessing R12B instead of R14b as the candidate_version. i think maybe `yum info erlang` is used by chef to get a candidate, but that should be returning r14b too.
[2012-04-25 22:50:33 -0400] |shad0w|: joemiller, hitting different mirrors each time maybe?
[2012-04-25 22:50:46 -0400] joemiller: i don't think so, i can reproduce this very reliably
[2012-04-25 22:51:05 -0400] heph: hey, looking for a knife plugin that might help keep git and chef in sync, any suggestions?
[2012-04-25 22:51:07 -0400] |shad0w|: nm, looks like it isn't using mirrorlist and the hostname only resolves to one ip
[2012-04-25 22:52:16 -0400] joemiller: |shad0w|: i'm suspecting some kind of ordering issue, or yum caching issue. but i can't quite recreate it by hand. eg: if i do a `vagrant up --no-provision`, then ssh into the vm, lay down the epel.repo and EPELerlang.repo files, run `yum makecache` (as chef appears to do), then run an install or info, i get R14B as expected not r12b
[2012-04-25 22:52:58 -0400] |shad0w|: I don't see any version specific stuff anywhere either
[2012-04-25 22:53:09 -0400] |shad0w|: maybe another cookbook or recipe in your runlist is doing something?
[2012-04-25 22:53:29 -0400] joemiller: possible. such as?
[2012-04-25 22:53:37 -0400] |shad0w|: no clue
[2012-04-25 22:53:41 -0400] |shad0w|: what does the runlist look like?
[2012-04-25 22:53:54 -0400] |shad0w|: and an initial run and subsequent run?
[2012-04-25 22:54:13 -0400] joemiller: the erlang book is called by portertech's rabbit fork, https://github.com/portertech/rabbitmq
[2012-04-25 22:55:00 -0400] joemiller: |shad0w|: good question. i suspect they're same, but i'll check
[2012-04-25 22:55:13 -0400] hoover_damn: joemiller, how new is your yum?
[2012-04-25 22:55:20 -0400] hoover_damn: yum cookbook
[2012-04-25 22:55:28 -0400] hoover_damn: joemiller, i had a similar situation with the apt cookbook and erlang
[2012-04-25 22:55:38 -0400] hoover_damn: joemiller, turned out to that updating the apt cookbook fixed it...
[2012-04-25 22:55:52 -0400] joemiller: 0.5.2
[2012-04-25 22:56:32 -0400] joemiller: latest
[2012-04-25 22:56:34 -0400] hoover_damn: yeah
[2012-04-25 22:56:44 -0400] hoover_damn: and looking at that cookbook very straight forward
[2012-04-25 22:57:05 -0400] hoover_damn: if redhat/centos/etc add epel, then grab erlang package
[2012-04-25 22:57:10 -0400] hoover_damn: if debian/ubuntu do it this way
[2012-04-25 22:57:15 -0400] hoover_damn: else, ehh f i try
[2012-04-25 22:57:16 -0400] hoover_damn: :)
[2012-04-25 22:57:41 -0400] joemiller: yeah, pretty simple
[2012-04-25 22:58:20 -0400] joemiller: easy to recreate if you have vagrant btw =) clone: https://github.com/joemiller/sensu-tests , `vagrant up centos_5_32` (or _64, same behavior)
[2012-04-25 23:00:22 -0400] joemiller: so the erlang cookbook installs 2 yum repos, epel and EPELerlang.  i believe epel is where r12b lives and EPELErlang is where r14b resides. so maybe some kind of ordering issue where the ver in epel is detected instead of EPELErlang
[2012-04-25 23:00:27 -0400] joemiller: not sure why/how that would occur tho
[2012-04-25 23:03:08 -0400] |shad0w|: it probalby already has a package cache before the epelerlang repo is configured
[2012-04-25 23:03:34 -0400] |shad0w|: You might be able to force the cache as stale
[2012-04-25 23:03:48 -0400] |shad0w|: what version of chef are you using?
[2012-04-25 23:05:55 -0400] joemiller: 0.10.8
[2012-04-25 23:06:22 -0400] |shad0w|: yeah, take a look at the cache logic in provider/package/yum.rb
[2012-04-25 23:07:05 -0400] |shad0w|: if the repo isn't there before the first yum package is called in the run list it won't be in the cache and I'm not sure if the yum cookbook forces a refresh when it adds repos
[2012-04-25 23:09:43 -0400] joemiller: nice. sounds plausible
[2012-04-25 23:09:50 -0400] joemiller: any suggestions on fix?
[2012-04-25 23:10:25 -0400] |shad0w|: flush the cache, but I'm not sure what the best way to do that from a recipe would be
[2012-04-25 23:11:23 -0400] |shad0w|: looks like the package resource responds to flush_cache after 10.4
[2012-04-25 23:11:31 -0400] |shad0w|: >= 10.4
[2012-04-25 23:12:03 -0400] |shad0w|: although it sounds like the yum cookbook should try to flush any cache any time a repo resource is added/removed
[2012-04-25 23:13:04 -0400] |shad0w|: http://wiki.opscode.com/display/chef/Yum+Package+Resource
[2012-04-25 23:14:46 -0400] |shad0w|: looks like when the resource loads it calls @yum.reload
[2012-04-25 23:15:13 -0400] joemiller: at very bottom of that page, there's an interesting 'reload-internal-yum-cache' ruby_block
[2012-04-25 23:15:16 -0400] |shad0w|: adding a Chef::Provider::Package::Yum.reload might do it
[2012-04-25 23:16:09 -0400] |shad0w|: or that
[2012-04-25 23:17:22 -0400] |shad0w|: looks like the yum cookbook does notifies :run, resources(:execute => "yum -q makecache"), :immediately on add
[2012-04-25 23:17:27 -0400] |shad0w|: but it isn't clearing the internal cache
[2012-04-25 23:17:30 -0400] joemiller: aye
[2012-04-25 23:17:32 -0400] |shad0w|: https://github.com/opscode-cookbooks/yum/blob/master/providers/repository.rb
[2012-04-25 23:17:46 -0400] joemiller: i'm going to try to modify the yum cookbook and send a PR if it works.
[2012-04-25 23:17:59 -0400] joemiller: if that doesn't work, i'll try the Yum.reload in the erlang cookbook
[2012-04-25 23:18:32 -0400] |shad0w|: the yum -q makecache might become redundant if you try to do a reload in the yum cookbook provider
[2012-04-25 23:18:50 -0400] |shad0w|: just fyi as it could add quite a bit of time
[2012-04-25 23:18:51 -0400] joemiller: the example on the wiki does both
[2012-04-25 23:19:38 -0400] |shad0w|: not sure if that helps because I think the yum-dump.py script runs with no cache anyway
[2012-04-25 23:20:27 -0400] |shad0w|: I could be wrong though I haven't really looked at yum-dump since 0.9
[2012-04-25 23:23:27 -0400] jtimberman: miketheman: just released 1.1.8 w/ that fix :)
[2012-04-25 23:23:51 -0400] jtimberman: like, 10114  2012-04-25 17:08  1:01  knife cookbook site share apache2 'Web Servers'
[2012-04-25 23:23:54 -0400] miketheman: aw, shucks. I already wnet and depoyed w/o it.
[2012-04-25 23:24:00 -0400] miketheman: hahahah
[2012-04-25 23:24:11 -0400] jtimberman: i meant to do that this morning, but got sidetracked :)
[2012-04-25 23:24:12 -0400] miketheman: 17:08 west coast?
[2012-04-25 23:24:18 -0400] jtimberman: mountain
[2012-04-25 23:24:25 -0400] jtimberman: so, 15 minutes ago
[2012-04-25 23:24:28 -0400] joemiller: |shad0w|: fixed. nice
[2012-04-25 23:24:44 -0400] |shad0w|: cool
[2012-04-25 23:24:53 -0400] joemiller: |shad0w|: gracias
[2012-04-25 23:25:02 -0400] |shad0w|: where did you fix it?
[2012-04-25 23:25:17 -0400] joemiller: yum cookbook.
[2012-04-25 23:25:23 -0400] jtimberman: joemiller: is there an issue in the erlang cookbook that needs to be fixed?
[2012-04-25 23:25:27 -0400] miketheman: jtimberman: awesome, will be uploading momentarily
[2012-04-25 23:25:28 -0400] |shad0w|: that might get ugly if you are adding a lot of repos
[2012-04-25 23:25:33 -0400] jtimberman: or, if its in the yum cookbook?
[2012-04-25 23:25:35 -0400] joemiller: jtimberman: i think the better fix is in the yum cookbook
[2012-04-25 23:25:41 -0400] joemiller: potentially
[2012-04-25 23:25:49 -0400] jtimberman: joemiller: can you open a COOK ticket about that?
[2012-04-25 23:25:54 -0400] jtimberman: miketheman: :D
[2012-04-25 23:26:02 -0400] |shad0w|: it should probalby try to handle all of the yum repos early in the run and only make cache once
[2012-04-25 23:26:20 -0400] joemiller: jtimberman: yeah. how about a github PR on the cookbook too?
[2012-04-25 23:26:28 -0400] jtimberman: contributing?
[2012-04-25 23:26:29 -0400] bawt: contributing is http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-04-25 23:26:33 -0400] jtimberman: don't forget to see there :)
[2012-04-25 23:26:42 -0400] jtimberman: but a pull request is always awesome.
[2012-04-25 23:27:58 -0400] josephholsten: sonofa. knife's net-ssh-2.2.2 is not playing nice with ruby-1.9/2.0 OpenSSL stuff.
[2012-04-25 23:28:48 -0400] jtimberman: josephholsten: set it on fire
[2012-04-25 23:28:50 -0400] jtimberman: :)
[2012-04-25 23:29:00 -0400] josephholsten: in a delightfully, I don't want you to reduce my reproduction steps sort of way
[2012-04-25 23:29:27 -0400] josephholsten: I've not enough fire to do any damage
[2012-04-25 23:30:07 -0400] josephholsten: this is my second time to dig uncomfortably deep into ruby openssl today. so much not fun.
[2012-04-25 23:36:26 -0400] daaaan: any of you guys have a good workflow documented for multiple cookbook developers sharing a repository/chef server?
[2012-04-25 23:37:07 -0400] |shad0w|: daaaan, I'm working on getting our workflow into our developers workflow. Mostly altissian products
[2012-04-25 23:38:05 -0400] |shad0w|: atlassian even
[2012-04-25 23:38:42 -0400] daaaan: i wish there were a way to do callbacks when you push to hosted chef
[2012-04-25 23:39:40 -0400] jtimberman: huh. neat. this just DWIM: knife node run list add centos58.localdomain 'role[base],role[webserver]'
[2012-04-25 23:43:37 -0400] miketheman: curious: how will the upgrade of chef-full stack go?
[2012-04-25 23:45:41 -0400] joemiller: jtimberman: cook-1227. tnx
[2012-04-25 23:46:59 -0400] jtimberman: cheers
[2012-04-25 23:47:17 -0400] daaaan: is there any way to see a list of activity/history in the opscode platform?
