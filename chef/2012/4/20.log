[2012-04-20 00:05:49 -0400] dangerdave: is this a common experience for chef users? when I run chef-client as a daemon via `service`, it seems to often fail to fully install new cookbooks. On the other hand, if I run chef-client from the command line on the same machine, it works fine...
[2012-04-20 00:08:19 -0400] z: https://fbcdn-sphotos-a.akamaihd.net/hphotos-ak-ash4/299336_574795501147_6879375_n.jpg
[2012-04-20 00:08:24 -0400] z: I didn't realise ohai was a game :'(
[2012-04-20 00:09:56 -0400] hoover_damn: http://images.icanhascheezburger.com/completestore/2009/3/27/128826300235201134.jpg
[2012-04-20 00:10:26 -0400] hoover_damn: totally
[2012-04-20 00:10:29 -0400] hoover_damn: cats play it all the time
[2012-04-20 00:10:41 -0400] hoover_damn: clearly the opscode employee's love their felines
[2012-04-20 00:31:49 -0400] coderanger: bemu: Did a pre-chefconf hackathon get planned or did I hallucinate that?
[2012-04-20 00:32:22 -0400] bemu: Just deciding whether to have it in SF or Burlingame.
[2012-04-20 00:34:06 -0400] akraut: What is the general wisdom for deploying custom built software? ie: do you drop the tarball into the files directory within the cookbook or do you stick it somewhere web accessible for the recipe to grab?
[2012-04-20 00:35:16 -0400] z: akraut: Package it up as appropriate and put it somewhere web accessible, is my preferred approach
[2012-04-20 00:37:39 -0400] jordandm: jtimberman: Two questions: Where is a good example of using the rabbitmq cookbook to setup a cluster and second, do you know of an example of someone setting up an active-active mirroring setup for HA using Chef (and that cookbook in particular)?
[2012-04-20 00:39:34 -0400] aethier: Anyone can help me with making a request to hosted chef REST api with curl? I'm following the exemple found at : http://wiki.opscode.com/display/chef/Making+Authenticated+API+Requests but I can't get it to work.  The same creds works with knife so I know this part is fine.  I'm not sure how to resolve this.  Anyone has a curl working exemple?
[2012-04-20 00:39:36 -0400] aethier: thanks
[2012-04-20 00:41:39 -0400] kgraham:  configuration = deploy_resource.instance_variable_get("@configuration")  ; that was it, working
[2012-04-20 00:41:42 -0400] kgraham: thanks
[2012-04-20 01:21:27 -0400] bemu: knife ec2 server create ami-e016ca89 -x ubuntu --sudo --distro ubuntu11.04-omnibus -N pgtest5 --flavor m2.4xlarge --environment production -S chef
[2012-04-20 01:21:32 -0400] bemu: uh
[2012-04-20 01:21:33 -0400] bemu: woops
[2012-04-20 01:24:15 -0400] senthilr: password:
[2012-04-20 01:24:16 -0400] bemu: The worst part about that is that I had syntax issues :B
[2012-04-20 01:32:33 -0400] UForgotten: hmm
[2012-04-20 01:32:54 -0400] UForgotten: I'm having a hell of a time getting template variables to work - it wont even compile, something with the syntax of how I am setting the variables it doesn't like.
[2012-04-20 01:33:17 -0400] z: jordandm: you can do the API active-active if you have a load balancer, or want to do DNS RR, but I've certainly found that Solr and CouchDB either don't support active-active or you are simply strongly inadvised to try/do it
[2012-04-20 01:35:45 -0400] Urocyon: DoopliCo: did you figure it out?
[2012-04-20 01:36:05 -0400] UForgotten: anyone have working examples of setting template variables in the template recipe call?
[2012-04-20 01:37:01 -0400] UForgotten: http://wiki.opscode.com/display/chef/Templates was no help
[2012-04-20 01:37:54 -0400] knuckolls_: uforgotten: i'll get you an example, one sec
[2012-04-20 01:38:34 -0400] UForgotten: just need to literally pass a string in one variable and a number in another.
[2012-04-20 01:38:47 -0400] knuckolls_: https://gist.github.com/2425227
[2012-04-20 01:39:16 -0400] knuckolls_: default.rb is in recipes/ and hostname.erb is in templates/default/
[2012-04-20 01:39:33 -0400] UForgotten: I guess whats throwing me is the braces that are referenced in the docs
[2012-04-20 01:39:52 -0400] knuckolls_: hmm i haven't looked at the docs in awhile. this has always worked for me
[2012-04-20 01:40:09 -0400] knuckolls_: if you want to pass in multiple variables just put a comma after the :hostname => node.name
[2012-04-20 01:40:42 -0400] UForgotten: nope
[2012-04-20 01:40:44 -0400] UForgotten: does not work
[2012-04-20 01:40:50 -0400] knuckolls_: i pulled that out of production
[2012-04-20 01:40:52 -0400] UForgotten: [Fri, 20 Apr 2012 01:40:57 -0400] FATAL: NoMethodError: undefined method `' for Chef::Resource::Template
[2012-04-20 01:40:59 -0400] knuckolls_: gist your code
[2012-04-20 01:41:14 -0400] knuckolls_: also what version of chef are you on?
[2012-04-20 01:41:34 -0400] knuckolls_: i'm on 10.8
[2012-04-20 01:41:39 -0400] Urocyon: chef uses erubis, so a good source of information on template syntax is the erubis documentation.
[2012-04-20 01:42:03 -0400] UForgotten: 0.10.4 here
[2012-04-20 01:42:27 -0400] UForgotten: this is BASIC functionality. :(
[2012-04-20 01:42:33 -0400] UForgotten: dont know if I can gist but I can pastebun
[2012-04-20 01:42:58 -0400] knuckolls_: just upgrade your gem to 10.8 real quick to see if it's that
[2012-04-20 01:43:05 -0400] knuckolls_: you can downgrade back to your version real easy
[2012-04-20 01:43:07 -0400] knuckolls_: pastebin is fine
[2012-04-20 01:43:36 -0400] knuckolls_: i've gotta go in about 5 minutes so i'll help while i can ;)
[2012-04-20 01:43:49 -0400] svanzoest: you may need to throw a () around the list.
[2012-04-20 01:44:15 -0400] svanzoest: variables ( :hostname => node.name, :other => "foo")
[2012-04-20 01:44:27 -0400] UForgotten: http://pastebin.com/LjxVmVgM
[2012-04-20 01:44:27 -0400] svanzoest: similar to resources
[2012-04-20 01:44:32 -0400] UForgotten: svanzoest: I tried that, no dice
[2012-04-20 01:44:58 -0400] UForgotten: will try again
[2012-04-20 01:45:25 -0400] knuckolls_: yeah that's strange, i've never encountered that
[2012-04-20 01:45:52 -0400] knuckolls_: it's reasonably simple to upgrade your gem for a test and downgrade back to 10.4 just to see if it's a version difference
[2012-04-20 01:46:06 -0400] knuckolls_: although i'd be really surprised if syntax changed between those versions
[2012-04-20 01:46:15 -0400] UForgotten: It hsouldnt
[2012-04-20 01:46:21 -0400] UForgotten: this hsould be very basic functionality
[2012-04-20 01:46:23 -0400] UForgotten: ffs
[2012-04-20 01:46:32 -0400] knuckolls_: indeed.
[2012-04-20 01:46:34 -0400] UForgotten: the error changes when I add braces
[2012-04-20 01:47:15 -0400] UForgotten: http://pastebin.com/pLrbKcB8
[2012-04-20 01:47:59 -0400] UForgotten: maybe its too retarded to accept strings
[2012-04-20 01:48:02 -0400] knuckolls_: it's likely that parens are just a syntax error
[2012-04-20 01:48:07 -0400] UForgotten: maybe I have to pass it a symbol to something else
[2012-04-20 01:48:11 -0400] UForgotten: but it should not be that dumb
[2012-04-20 01:48:24 -0400] knuckolls_: uforgotten: it's more likely a bug, your syntax is correct
[2012-04-20 01:48:41 -0400] knuckolls_: in the original example
[2012-04-20 01:48:51 -0400] knuckolls_: anyway i've gotta go. good luck. try the version
[2012-04-20 01:49:18 -0400] mhalligan: Has anyone played around with the knife-rackspace-load-balancer subcommand?
[2012-04-20 01:50:25 -0400] UForgotten: nope
[2012-04-20 01:50:29 -0400] UForgotten: 0.10.8 has same problem
[2012-04-20 01:50:51 -0400] mhalligan: I'm running into a weird probelm where knife is complaining that an attribute named "rackspace" is missing: https://gist.github.com/95153d3a676f69a3416c
[2012-04-20 01:51:06 -0400] mhalligan: is that a missing ohai attribute?
[2012-04-20 01:51:58 -0400] svanzoest: uforgotten: your pastebin is basically what I have in my recipe.
[2012-04-20 01:52:15 -0400] UForgotten: the second one?
[2012-04-20 01:52:15 -0400] bawt: the second one is worked around by that patch I fisted
[2012-04-20 01:52:45 -0400] svanzoest: uforgotten: yes, however no space.. as in variables()
[2012-04-20 01:53:10 -0400] svanzoest: instance might be a keyword
[2012-04-20 01:53:30 -0400] svanzoest: try renaming that to something else
[2012-04-20 01:54:08 -0400] UForgotten: its not bitching about instance
[2012-04-20 01:54:14 -0400] UForgotten: its bitching about the spaces after =>
[2012-04-20 01:55:55 -0400] svanzoest: well.. earlier it complained about NoSuchMethod, so I figured it might be colliding with a an instance() method
[2012-04-20 01:56:14 -0400] UForgotten: yeah thats what happens when I remove the space
[2012-04-20 01:56:29 -0400] UForgotten: that would be dumb luck
[2012-04-20 01:56:30 -0400] svanzoest: it seems like the parenthesis are optional. I have recipes with and without
[2012-04-20 01:57:54 -0400] Urocyon: UForgotten I thought it bitching about the =>
[2012-04-20 01:57:58 -0400] Urocyon: was
[2012-04-20 01:58:04 -0400] UForgotten: it is.
[2012-04-20 01:58:17 -0400] Urocyon: isn't that a tASSOC
[2012-04-20 01:58:18 -0400] UForgotten: or it appears to be. unless the stack trace parse is retarded too.
[2012-04-20 01:58:35 -0400] UForgotten: I dont know. I'm not a programmer. I just want to set two scalar variables, one string and one number
[2012-04-20 01:58:45 -0400] UForgotten: thats it. not a hash, not an array.
[2012-04-20 01:59:04 -0400] UForgotten: ruby has made this more difficult than necessary.
[2012-04-20 01:59:17 -0400] bemu: I don't think ruby is the problem...
[2012-04-20 02:00:01 -0400] UForgotten: bemu: my lack of understanding of ruby. and growing disdain at this point
[2012-04-20 02:00:24 -0400] bemu: Much more fair. :)
[2012-04-20 02:00:36 -0400] bemu: But you shouldn't disdain something because you don't understand it. Sounds like a bigot.
[2012-04-20 02:01:04 -0400] UForgotten: I understand that I tried examples in documentation, and they didnt work
[2012-04-20 02:01:11 -0400] UForgotten: thats damned frustrating for someone just learning something.
[2012-04-20 02:02:11 -0400] Urocyon: So is this an error that coughs up when you run chef-client?
[2012-04-20 02:02:20 -0400] UForgotten: chef-solo.
[2012-04-20 02:02:23 -0400] bemu: variables(:port => 6379, :instance => "production") should work
[2012-04-20 02:02:57 -0400] UForgotten: bemu: I agree, it should, but apparently does not.
[2012-04-20 02:03:06 -0400] svanzoest: mhalligan: you may need to install knife-rackspace
[2012-04-20 02:03:42 -0400] hoover_damn: mhalligan, uhm one of my clients wrote a knife rackspace plugin
[2012-04-20 02:03:46 -0400] hoover_damn: mhalligan, it works
[2012-04-20 02:03:48 -0400] DoopliCo: Urocyon: Yes, once I knew (the horrid) convention of the commands on the page, it was easy
[2012-04-20 02:04:09 -0400] UForgotten: I'll try removing the spaces and rename instance for superstition
[2012-04-20 02:04:17 -0400] hoover_damn: https://github.com/howaboutwe/knife-rackspace-load-balancer
[2012-04-20 02:04:23 -0400] hoover_damn: automate your load balancer :)
[2012-04-20 02:04:33 -0400] bemu: UForgotten: That's worth a shot.
[2012-04-20 02:04:48 -0400] bemu: UForgotten: Instance might be a reserved word.
[2012-04-20 02:05:35 -0400] DoopliCo: I wonder if those load balancers support websockets
[2012-04-20 02:08:09 -0400] UForgotten: nope
[2012-04-20 02:08:12 -0400] jtimberman: mhalligan: OHAI-267 addresses various issues w/ rackspace and cloud plugins not returning network info.
[2012-04-20 02:08:24 -0400] Urocyon: UForgotten the syntax is similar to what you would get in irb if you just typed in (:port => 6379, :instance => "production")
[2012-04-20 02:08:47 -0400] Urocyon: UForgotten really a hash should be {:port => 6379, :instance => "production"}
[2012-04-20 02:08:51 -0400] jtimberman: problem is that all the various cloud providers don't provide a consistent way to determine that you're running on a specific one and then how to determine the cloud metadata.
[2012-04-20 02:09:05 -0400] Urocyon: But I thought that template took what you gave it and turned that into a hash.
[2012-04-20 02:09:13 -0400] UForgotten: Urocyon: which is why the example says to use ({ whatever => val })
[2012-04-20 02:09:18 -0400] Urocyon: I mean variables
[2012-04-20 02:09:23 -0400] jtimberman: UForgotten: have you gisted/pasted your template contents?
[2012-04-20 02:09:28 -0400] bemu: Nope.
[2012-04-20 02:09:50 -0400] UForgotten: jtimberman: template contents no, but its complaining about the template recipe call not the template itself
[2012-04-20 02:09:58 -0400] mhalligan: svanzoest: nope not sure that's the right problem
[2012-04-20 02:10:03 -0400] mhalligan: hoover_damn: did they release it? :)
[2012-04-20 02:10:11 -0400] mhalligan: oh I see
[2012-04-20 02:10:11 -0400] hoover_damn: yup
[2012-04-20 02:10:18 -0400] mhalligan: oh that's the one I'm trying
[2012-04-20 02:10:19 -0400] mhalligan: it's pretty jacked
[2012-04-20 02:10:21 -0400] z: UForgotten: I suspect you'd get a much quicker break/fix answer if you gisted/pasted both then.
[2012-04-20 02:10:30 -0400] jtimberman: UForgotten: the error in the paste here isn't enough context: http://pastebin.com/LjxVmVgM
[2012-04-20 02:10:33 -0400] hoover_damn: open an issue?
[2012-04-20 02:10:41 -0400] mhalligan: I'm just going to write my own
[2012-04-20 02:10:43 -0400] Urocyon: UForgotten: that had me thinking that maybe the syntax error is higher up... something which makes it not process that resource correctly.
[2012-04-20 02:10:49 -0400] mhalligan: no time to wait for someone else to fix it :(
[2012-04-20 02:11:09 -0400] hoover_damn: mhalligan, i use it with 1.9.3
[2012-04-20 02:11:12 -0400] hoover_damn: so how it it jacked?
[2012-04-20 02:11:18 -0400] mhalligan: I think the real problem is it's relying on the rackspace attributes to exist
[2012-04-20 02:11:20 -0400] mhalligan: and they don't often exist
[2012-04-20 02:11:23 -0400] mhalligan: in fact they often don't exist
[2012-04-20 02:11:47 -0400] mhalligan: following the documentation verbatim I get errors like this: `<=>': undefined method `<=>' for :algorithm:Symbol (NoMethodError)
[2012-04-20 02:11:50 -0400] hoover_damn: right they don't often exist
[2012-04-20 02:11:54 -0400] UForgotten: jtimberman: I'm not sure what else would be useful.  did you see http://pastebin.com/pLrbKcB8
[2012-04-20 02:12:07 -0400] jtimberman: UForgotten: ah i missed that
[2012-04-20 02:12:10 -0400] mhalligan: (and that's after modifying the source to use jtimberman's network plugin and avoid the rackspace bs)
[2012-04-20 02:12:11 -0400] hoover_damn: what ruby mhalligan ?
[2012-04-20 02:12:19 -0400] mhalligan: 187
[2012-04-20 02:12:21 -0400] jtimberman: UForgotten: don't put spaces before ()'s
[2012-04-20 02:12:23 -0400] hoover_damn: yeah that's why
[2012-04-20 02:12:25 -0400] hoover_damn: it requires 1.9.x
[2012-04-20 02:12:31 -0400] mhalligan: sigh
[2012-04-20 02:12:36 -0400] mhalligan: really?
[2012-04-20 02:12:39 -0400] UForgotten: jtimberman: I took all the spaces out, it reverts back to the first error
[2012-04-20 02:12:39 -0400] hoover_damn: people are not writing code for 1.8.x anymore
[2012-04-20 02:12:39 -0400] jtimberman: variables(:port => 6379, :instance => "production")
[2012-04-20 02:12:41 -0400] mhalligan: why doesn't it jtell me that
[2012-04-20 02:12:53 -0400] hoover_damn: he might not have intended it to not work on 1.8.7
[2012-04-20 02:12:59 -0400] UForgotten: jtimberman: then it does the first thing again, [Fri, 20 Apr 2012 02:08:56 -0400] FATAL: NoMethodError: undefined method `' for Chef::Resource::Template
[2012-04-20 02:13:00 -0400] bemu: UForgotten: That's a different error. Gist the full traceback plz
[2012-04-20 02:13:03 -0400] mhalligan: a quick check of the ruby version would have saved me 6 hours
[2012-04-20 02:13:06 -0400] hoover_damn: but when you use 1.9.3 by default
[2012-04-20 02:13:10 -0400] jtimberman: hoover_damn: mhalligan which code is written for 1.9?
[2012-04-20 02:13:12 -0400] bemu: and your template
[2012-04-20 02:13:14 -0400] mhalligan: ruby's versioning makes me want to kill
[2012-04-20 02:13:26 -0400] mhalligan: jtimberman: knife-rackspace-load-balancer
[2012-04-20 02:13:32 -0400] jtimberman: mhalligan: oh - i haven't used that one.
[2012-04-20 02:13:49 -0400] bemu: mhalligan: It's not any worse than python..
[2012-04-20 02:13:54 -0400] mhalligan: yeah writing my own will be less work than trying to get 19 installed and working without breaking everything
[2012-04-20 02:14:10 -0400] bemu: You want to go to 1.9 anyway.
[2012-04-20 02:14:19 -0400] bemu: It shouldn't be that difficult, unless you depend on a lot of old gems
[2012-04-20 02:14:20 -0400] mhalligan: no freaking way
[2012-04-20 02:14:23 -0400] UForgotten: http://pastebin.com/fYXBYpRn
[2012-04-20 02:14:24 -0400] hoover_damn: mhalligan, does list even work?
[2012-04-20 02:14:27 -0400] mhalligan: the last time I did that everything broke
[2012-04-20 02:14:35 -0400] hoover_damn: it totally works for me
[2012-04-20 02:14:46 -0400] mhalligan: nothing's worse than finding out every gem on your system is broken or changed because you updated to 19
[2012-04-20 02:14:47 -0400] hoover_damn: then your going to be sad mhalligan 1.8.x is dead
[2012-04-20 02:14:51 -0400] hoover_damn: REE is EOL
[2012-04-20 02:14:59 -0400] bemu: UForgotten: Now the template
[2012-04-20 02:15:01 -0400] hoover_damn: Ruby 1.8.x is not going to have any major release except security
[2012-04-20 02:15:14 -0400] hoover_damn: ruby 1.8.6 has one release left according to kirk
[2012-04-20 02:15:18 -0400] hoover_damn: the maintainer
[2012-04-20 02:15:22 -0400] hoover_damn: it's mainly the hashdos fix likely
[2012-04-20 02:15:30 -0400] mhalligan: upgrading to ruby19 today isn't an option
[2012-04-20 02:15:43 -0400] bemu: mhalligan: Do you need to run it on all of your servers?
[2012-04-20 02:15:43 -0400] hoover_damn: I totally understand that if your in a 1.8 world going to 1.9 is a pain
[2012-04-20 02:15:44 -0400] jtimberman: mhalligan: its cool, upgrade tomorrow ;)
[2012-04-20 02:15:47 -0400] bemu: Maybe upgrade one? :)
[2012-04-20 02:15:49 -0400] mhalligan: that's like saying "our production systems suck let's upgrade them all to the latest stable release of ubuntu this afternoon it'll fix all of our problems" to your sysadmins then saying have a nice day :)
[2012-04-20 02:15:56 -0400] svanzoest: there are a bunch of /usr/bin/ruby1.8's floating around in scripts that are going to be a pain to find and update.
[2012-04-20 02:15:58 -0400] hoover_damn: i dare say install rbenv
[2012-04-20 02:16:05 -0400] mhalligan: bemu: hah the only server I have right now is the server I'm doing all of my work from to get chef going
[2012-04-20 02:16:20 -0400] bemu: ah, that seems like an easy upgrade then :)
[2012-04-20 02:16:23 -0400] mhalligan: rvm / rbenv / bundler are all incredibly nightmares
[2012-04-20 02:16:24 -0400] hoover_damn: yep
[2012-04-20 02:16:43 -0400] hoover_damn: sounds like you don't cope well with the rails development lifestyle
[2012-04-20 02:16:43 -0400] bemu: bundler is good, rvm is not necessary for a production environment where we have virtualization anyway, imo
[2012-04-20 02:16:45 -0400] mhalligan: I wonder what will happen on ubuntu if I install ruby19 if it'll keep everything seperate or if it will just screw me
[2012-04-20 02:16:47 -0400] hoover_damn: what do you prefer?
[2012-04-20 02:16:50 -0400] mhalligan: hoover_damn: no I like stability
[2012-04-20 02:17:02 -0400] mhalligan: the rails community doesn't care about stabilitiy
[2012-04-20 02:17:02 -0400] bemu: mhalligan: Personally, I use omnibus and ruby in /opt
[2012-04-20 02:17:02 -0400] jtimberman: UForgotten: can you add the content of your template?
[2012-04-20 02:17:03 -0400] hoover_damn: mhalligan, well if you want to use ruby 1.9.3 on oneric... i'd suggest you to use my ppa
[2012-04-20 02:17:12 -0400] hoover_damn: mhalligan, as I wrote a ruby 1.9.3p125 ppa without all the stupid debian patches
[2012-04-20 02:17:23 -0400] UForgotten: jtimberman: it is a huge pain in the butt but I will try
[2012-04-20 02:17:28 -0400] hoover_damn: https://launchpad.net/~scott-likens/+archive/ppa
[2012-04-20 02:17:36 -0400] mhalligan: that becomes apparent every time I upgrade a gem and all of a sudden I get a few thousand deprecation warnigns when I run a previously perfect program
[2012-04-20 02:17:43 -0400] UForgotten: there's more than one template btw
[2012-04-20 02:17:52 -0400] hoover_damn: that's rubygems
[2012-04-20 02:17:55 -0400] hoover_damn: and it's /damn/ annoying
[2012-04-20 02:17:58 -0400] mhalligan: hoover: hah you're the other scott likens!
[2012-04-20 02:18:12 -0400] hoover_damn: other?
[2012-04-20 02:18:13 -0400] bawt: other is ---
[2012-04-20 02:18:22 -0400] mhalligan: other is Scott M Likens a sysadmin from seattle
[2012-04-20 02:18:34 -0400] hoover_damn: thats me likely
[2012-04-20 02:18:35 -0400] jtimberman: UForgotten: just need the first one
[2012-04-20 02:18:41 -0400] mhalligan: oh ok then you're the scott likens not the other one
[2012-04-20 02:18:43 -0400] bemu: UForgotten: The one on line 8, probably.
[2012-04-20 02:19:08 -0400] hoover_damn: I have no notion of other people with my last name and don't know any that share my name
[2012-04-20 02:19:16 -0400] hoover_damn: they might exist
[2012-04-20 02:19:23 -0400] hoover_damn: there is over 6 billion on this planet
[2012-04-20 02:19:23 -0400] bemu: I didn't tell you that I changed my name to Scott Likens?
[2012-04-20 02:19:37 -0400] hoover_damn: bemu, ahhh
[2012-04-20 02:19:57 -0400] mhalligan: hmm I wonder if apt-get has an equivalent of a no-op mode
[2012-04-20 02:20:21 -0400] UForgotten: ah
[2012-04-20 02:20:26 -0400] z: http://blog.brightbox.co.uk/posts/next-generation-ruby-packages-for-ubuntu
[2012-04-20 02:20:34 -0400] z: ^ those Ruby packages are also very well respected and tested
[2012-04-20 02:20:43 -0400] UForgotten: http://pastebin.com/g0w0LeTc
[2012-04-20 02:21:09 -0400] hoover_damn: z, are you saying my packages suck?
[2012-04-20 02:21:34 -0400] z: the Brightbox guys specialise in Rails hosting (http://www.brightbox.co.uk/rails-hosting-pricing) and have been providing Ruby packages for 3-4 years now. they get tested by a whole bunch of people including a large number of BB customers.
[2012-04-20 02:21:42 -0400] mhalligan: I'm saddened I can't just get this from my os vendor
[2012-04-20 02:21:43 -0400] bemu: UForgotten: Why are you calling it @theinstance?
[2012-04-20 02:21:48 -0400] mhalligan: package management sucks
[2012-04-20 02:21:54 -0400] UForgotten: bemu: we said to change it
[2012-04-20 02:22:02 -0400] UForgotten: in case instance is a reserved keyword
[2012-04-20 02:22:04 -0400] bemu: oh, okay, as long as it's consistent.
[2012-04-20 02:22:04 -0400] hoover_damn: z, thanks... I know how to package ruby up from Debian and properly test it just as well as BB
[2012-04-20 02:22:12 -0400] UForgotten: yes its @theinstance on all now
[2012-04-20 02:22:17 -0400] mhalligan: *takes a snapshot and gets ready for dependency hell*
[2012-04-20 02:22:17 -0400] hoover_damn: that was my job
[2012-04-20 02:22:45 -0400] bemu: Are you sure that's the one on line 8 in the recipe
[2012-04-20 02:22:46 -0400] bemu: ?
[2012-04-20 02:22:49 -0400] bemu: That looks fine.
[2012-04-20 02:22:53 -0400] z: hoover_damn: Cool your jets. Options exist other than your PPA, and frankly, I'll take something tested with 2000+ customers including some very high-profile sites over a random PPA almost any day of the week for production infrastructure
[2012-04-20 02:23:01 -0400] UForgotten: it is line 8. I'll paste the other one
[2012-04-20 02:23:23 -0400] hoover_damn: z, I just find that rude to say
[2012-04-20 02:23:25 -0400] UForgotten: http://pastebin.com/As404yPB
[2012-04-20 02:23:38 -0400] hoover_damn: z, and your response is still ... tacky
[2012-04-20 02:23:51 -0400] z: hoover_damn: welcome to the Internet, where opinions are freely stated, and you don't have to listen to them :-)
[2012-04-20 02:24:02 -0400] hoover_damn: z, if you didn't say it was better then mine... and start that, I wouldn't have said anything
[2012-04-20 02:24:10 -0400] hoover_damn: z, but you should learn to behave better
[2012-04-20 02:24:17 -0400] UForgotten: the cholby level in this channel is unusually high
[2012-04-20 02:24:18 -0400] hoover_damn: z, I know i'm horrible at times... but really
[2012-04-20 02:24:31 -0400] hoover_damn: z, you truly take the cake at night
[2012-04-20 02:24:59 -0400] z: I fail to see anything offensive in the above. I am stating my professional opinion.
[2012-04-20 02:25:05 -0400] bemu: UForgotten: I don't see anything off-hand. Why don't you try commenting out one template, and test, then the other.
[2012-04-20 02:25:16 -0400] UForgotten: bemu: sure
[2012-04-20 02:25:50 -0400] UForgotten: oh.
[2012-04-20 02:25:52 -0400] hoover_damn: z, I don't think you can understand how wrong you are and I don't think most people would get it.
[2012-04-20 02:26:10 -0400] UForgotten: will it lose its mind if I'm calling the same recipe twice on the same node?
[2012-04-20 02:26:16 -0400] hoover_damn: z, but I can tell you as someone who has written packages for over a decade ... most package managers would not be kind
[2012-04-20 02:26:18 -0400] z: hoover_damn: we can agree to disagree, in that case :-)
[2012-04-20 02:26:22 -0400] hoover_damn: z, and that's the best I can really say.
[2012-04-20 02:26:22 -0400] mhalligan: man sorry I spawned such a disagreement :/
[2012-04-20 02:26:46 -0400] bemu: UForgotten: No idea on that.
[2012-04-20 02:26:47 -0400] z: mhalligan: don't worry about it dude. Take all opinions with a pinch of salt, and do what you feel is best.
[2012-04-20 02:26:49 -0400] hoover_damn: mhalligan, it's not you.  I just felt disrespected when there wasn't any required
[2012-04-20 02:27:09 -0400] hoover_damn: and his selfish attitude pretty much shows his lack of understanding
[2012-04-20 02:27:18 -0400] svanzoest: based on this feedback. I think we should all just stick with ruby 1.8 :D
[2012-04-20 02:27:34 -0400] Urocyon: UForgotten I believe it only counts once, so shouldn't be a problem.
[2012-04-20 02:27:59 -0400] UForgotten: thats not what I mean. sorry I'm not being clear, I'm on low sleep
[2012-04-20 02:28:31 -0400] UForgotten: I have two recipes, a production.rb and a staging.rb.  the port and theinstance variables are different in each one, but I have a node that will run both recipes
[2012-04-20 02:29:41 -0400] Urocyon: Interesting.  I would guess one of those will overwrite the other then.
[2012-04-20 02:30:09 -0400] mhalligan: hoover_damn: so you worked @ zonar right?
[2012-04-20 02:30:14 -0400] UForgotten: they shouldn't - they each have a different destination target file
[2012-04-20 02:30:27 -0400] Urocyon: oh... ok, then that's different.
[2012-04-20 02:30:29 -0400] UForgotten: or at least that's the idea. its definitely the template recipes that are broken
[2012-04-20 02:30:41 -0400] UForgotten: commenting them out, all parse errors go away
[2012-04-20 02:31:27 -0400] UForgotten: hmm.
[2012-04-20 02:31:27 -0400] Urocyon: The name of the resource is going to be what comes after "template"  as long as the names differ all should be good.
[2012-04-20 02:31:45 -0400] UForgotten: the template with only one variable did not have a parse error
[2012-04-20 02:31:53 -0400] bemu: UForgotten: Which variable?
[2012-04-20 02:31:58 -0400] UForgotten: I'll see if it actually completes and works as intended
[2012-04-20 02:32:02 -0400] UForgotten: theinstance
[2012-04-20 02:34:14 -0400] jtimberman: UForgotten: the second time the recipe of the same name is included, chef ignores it, it only will incldue a recipe once.
[2012-04-20 02:34:53 -0400] UForgotten: it should not be the same name though, I would hope.  different .rb
[2012-04-20 02:35:00 -0400] UForgotten: and different destination file
[2012-04-20 02:35:03 -0400] bemu: jtimberman: He's not doing that, he's using the same template in two different recipes.
[2012-04-20 02:35:12 -0400] UForgotten: correct.
[2012-04-20 02:35:31 -0400] bemu: with two different variables.
[2012-04-20 02:35:43 -0400] bemu: UForgotten: So you have it narrowed down to the template -- but I don't see anything wrong in that template.
[2012-04-20 02:36:01 -0400] bemu: Try passing in just theinstance, and changing to put to a literal for testing
[2012-04-20 02:36:02 -0400] hoover_damn: mhalligan, correct
[2012-04-20 02:36:02 -0400] jtimberman: oh
[2012-04-20 02:36:19 -0400] mhalligan: hoover_damn: hah then it is a small world I haver your resume somewhere in my filesystem from 2007
[2012-04-20 02:36:31 -0400] jtimberman: webops is a really small world :)
[2012-04-20 02:36:37 -0400] bemu: I'll give you $10 for a copy of that :D
[2012-04-20 02:36:40 -0400] hoover_damn: mhalligan, it really is a small world
[2012-04-20 02:36:49 -0400] mhalligan: hoover_damn: I did a bunch of datacenter work with Jesse in 2008
[2012-04-20 02:37:00 -0400] hoover_damn: poor thing
[2012-04-20 02:37:08 -0400] mhalligan: hah zonar was a shitshow but jesse's a nice guy
[2012-04-20 02:37:17 -0400] hoover_damn: that's why I said poor thing
[2012-04-20 02:37:27 -0400] mhalligan: yeah and man the dude who drove the blue corvette
[2012-04-20 02:37:27 -0400] hoover_damn: he was a decent guy, he was always afraid of the backlash
[2012-04-20 02:37:32 -0400] mhalligan: what kind of dbag drives a blue corvette?
[2012-04-20 02:37:42 -0400] hoover_damn: I do
[2012-04-20 02:37:51 -0400] kyd: UForgotten: what about line 46 in your template: logfile /var/log/redis<%= @theinstance %>/redis.log" %>
[2012-04-20 02:37:51 -0400] mhalligan: dbag
[2012-04-20 02:37:52 -0400] hoover_damn: I know what kind... disgusting young men
[2012-04-20 02:37:54 -0400] hoover_damn: or old
[2012-04-20 02:37:55 -0400] UForgotten: same kind of dbag who drives a black corvette.  a corvette driver.
[2012-04-20 02:38:01 -0400] mhalligan: ;)
[2012-04-20 02:38:09 -0400] mhalligan: I know 2 guys in the seattle tech scene who both drive blue corvettes
[2012-04-20 02:38:14 -0400] hoover_damn: zonar is built on ex nuclear power guys
[2012-04-20 02:38:16 -0400] mhalligan: really it's you? I thought it was the ceo?
[2012-04-20 02:38:33 -0400] Urocyon: What was the version of chef this is running on?
[2012-04-20 02:38:44 -0400] Urocyon: UForgotten: ^^
[2012-04-20 02:38:51 -0400] bemu: Nice.
[2012-04-20 02:38:54 -0400] UForgotten: Urocyon: 0.10.4 and 0.10.8, same problem
[2012-04-20 02:38:56 -0400] bemu: kyd got it.
[2012-04-20 02:38:56 -0400] hoover_damn: sometimes I mention brief bits of stupidity of zonar in ##infra-talk
[2012-04-20 02:38:58 -0400] hoover_damn: or other random channels
[2012-04-20 02:39:12 -0400] bemu: UForgotten: Remove the superfluous %>
[2012-04-20 02:39:15 -0400] UForgotten: kyd: nice catch, thats *an* issue but perhaps not *the* issue
[2012-04-20 02:39:37 -0400] mhalligan: hoover_damn: I'd probably be violating an NDA but man a certain protocol you guys had made me cry
[2012-04-20 02:39:55 -0400] Urocyon: rats... I was hoping it might be on tickets.opscode.com
[2012-04-20 02:40:18 -0400] hoover_damn: mhalligan, nda's only last a year if even that.
[2012-04-20 02:40:24 -0400] hoover_damn: mhalligan, and for the most part they are not enforceable
[2012-04-20 02:40:38 -0400] hoover_damn: mhalligan, zonar wouldn't know how to write an enforceable nda if they were hiring a good lawyer
[2012-04-20 02:41:14 -0400] mhalligan: hoover_damn: yeah I won't sign ndas anymore I'm tired of having to argue over ridiculous line items that do things like broad applications that apply to my entire family or talk about crap like "mask works" whatever that is
[2012-04-20 02:41:15 -0400] UForgotten: nope
[2012-04-20 02:41:17 -0400] hoover_damn: mhalligan, mike was an interesting chap
[2012-04-20 02:41:21 -0400] UForgotten: nice find, kyd but same problem persists
[2012-04-20 02:41:23 -0400] hoover_damn: mhalligan, he did lots of crazy stpuid things
[2012-04-20 02:41:27 -0400] mhalligan: he's not around anymore?
[2012-04-20 02:41:37 -0400] Urocyon: UForgotten: Is there more to that recipe than those two template resources?
[2012-04-20 02:41:52 -0400] UForgotten: Urocyon: yes but its all commented out.
[2012-04-20 02:41:58 -0400] hoover_damn: i'm suprised they paid him out
[2012-04-20 02:41:58 -0400] mhalligan: he was one of those "you do something right and I think you're a genius then you do something wrong and I fire you" types, not my favorite customer
[2012-04-20 02:42:09 -0400] UForgotten: if I only leave the bottom template uncommented, the one with one variable, it works great.
[2012-04-20 02:42:17 -0400] UForgotten: if I try to enable the top one, with two variables, it dies.
[2012-04-20 02:42:28 -0400] hoover_damn: mhalligan, did you meet their system architect?
[2012-04-20 02:42:37 -0400] Urocyon: ok, so narrowing in.
[2012-04-20 02:42:38 -0400] hoover_damn: i forget his name now
[2012-04-20 02:43:20 -0400] mhalligan: hoover: yeah I think we had a long discussion with him where we went over the protocols and the stupid postgres stuff
[2012-04-20 02:43:31 -0400] mhalligan: (if ever there were a GOOD reason to use a key/value store it was instead of using postgis)
[2012-04-20 02:43:39 -0400] hoover_damn: mhalligan, mike hired him a stripper off of 99
[2012-04-20 02:43:43 -0400] kyd: uforgotten: i think i missed the pastebin link to the recipe text (i just have the template .erb itself). would you please link again?
[2012-04-20 02:43:46 -0400] hoover_damn: mhalligan, brought him into the office and kicked everyone out
[2012-04-20 02:43:59 -0400] hoover_damn: seriously
[2012-04-20 02:44:16 -0400] UForgotten: kyd: let me repost the latest
[2012-04-20 02:44:21 -0400] mhalligan: ugh
[2012-04-20 02:44:27 -0400] hoover_damn: mhalligan, also mike was known for various offenses to women that would get zonar sued heavily
[2012-04-20 02:44:27 -0400] hoover_damn: if i mentioned
[2012-04-20 02:44:30 -0400] mhalligan: that's one of the reasons I hate the tech industry
[2012-04-20 02:44:35 -0400] hoover_damn: totally
[2012-04-20 02:44:49 -0400] mhalligan: at HostingCon last summer some douchebag from linode decided to start stalking my office manager
[2012-04-20 02:45:12 -0400] hoover_damn: that doesn't shock me
[2012-04-20 02:45:18 -0400] mhalligan: I researched the guy and found him on forums defending the jerkoff from twitter who tried to rape that girl at apacheconf
[2012-04-20 02:45:37 -0400] miah: :/
[2012-04-20 02:45:40 -0400] hoover_damn: :/
[2012-04-20 02:45:42 -0400] UForgotten: kyd: http://pastebin.com/E6gF6VLJ
[2012-04-20 02:45:52 -0400] hoover_damn: sorry I'd kick the dude who tried to rape the girl
[2012-04-20 02:46:02 -0400] hoover_damn: you don't disrespect the woman
[2012-04-20 02:46:10 -0400] mhalligan: with my temper it was either walk away or kill the guy
[2012-04-20 02:46:18 -0400] hoover_damn: lol
[2012-04-20 02:46:19 -0400] mhalligan: so I walked to his boss and told him what was happening (he got  fired)
[2012-04-20 02:46:29 -0400] mhalligan: then I mostly left the tech industry and now I ride bikes
[2012-04-20 02:46:44 -0400] mhalligan: ok
[2012-04-20 02:46:46 -0400] jtimberman: so, can this conversation move to say, ##infra-talk? :)
[2012-04-20 02:46:55 -0400] mhalligan: when you install ruby 19 and then install gems where exactly do those gems go?
[2012-04-20 02:47:09 -0400] hoover_damn: mhalligan, by default they land in /var/gems
[2012-04-20 02:47:21 -0400] hoover_damn: mhalligan, my ppa drops them in /usr/bin... but they are suffixed with 1.9 by default
[2012-04-20 02:47:31 -0400] hoover_damn: if there is another ruby interperter installed
[2012-04-20 02:47:42 -0400] hoover_damn: this is also the default behavior of ubuntu
[2012-04-20 02:47:45 -0400] hoover_damn: and debian
[2012-04-20 02:47:55 -0400] jtimberman: no
[2012-04-20 02:47:58 -0400] hoover_damn: if you have 2 rubies are installed you need to tell it which to activate via alternatives :)
[2012-04-20 02:48:01 -0400] hoover_damn: really?
[2012-04-20 02:48:01 -0400] jtimberman: they don't go in /var/gems
[2012-04-20 02:48:07 -0400] mhalligan: yep lost in dependency and versioning hell, oh well, in 30 minutes I'm going to go sandblast and powdercoat 2 bike frames
[2012-04-20 02:48:20 -0400] hoover_damn: gems on ubuntu go in /var/gems unless you are hacking rubygems jtimberman
[2012-04-20 02:48:32 -0400] hoover_damn: hacking rubygems == installing over debians
[2012-04-20 02:48:33 -0400] jtimberman: newer versions of ruby1.9.1 on debian wheezy (testing) and ubuntu (11.04, i believe, might be 11.10) drop them in /usr/local
[2012-04-20 02:48:43 -0400] hoover_damn: nope
[2012-04-20 02:48:44 -0400] jtimberman: hoover_damn: /var/lib/ruby
[2012-04-20 02:48:45 -0400] Urocyon: UForgotten: If it will only take one setting a workaround might be variables( settings => {:port => 6379, :theinstance => "production"} ) then changing the template appropriately.
[2012-04-20 02:48:47 -0400] hoover_damn: that's what my ppa is built from jtimberman
[2012-04-20 02:48:51 -0400] mhalligan: you have to do it with alternatives? you can't just do it with an environment variable?
[2012-04-20 02:48:52 -0400] hoover_damn: I know what i'm talking about
[2012-04-20 02:48:55 -0400] hoover_damn: :D
[2012-04-20 02:49:03 -0400] hoover_damn: when in doubt, use upstream.
[2012-04-20 02:49:11 -0400] hoover_damn: remove patches you dislike, backport
[2012-04-20 02:50:25 -0400] jtimberman: mhalligan: you can find out where its going to install gems with "gem env"
[2012-04-20 02:50:28 -0400] hoover_damn: http://packages.qa.debian.org/r/ruby1.9.1.html ... currently drops things again in /var/gems
[2012-04-20 02:50:33 -0400] Urocyon: UForgotten: I haven't had to try this yet because I usually set the variables on my node, rather than passing them in like this... which could be another workaround for you.
[2012-04-20 02:50:38 -0400] jtimberman: mhalligan: or, "sudo gem env" to find where root will install them.
[2012-04-20 02:50:42 -0400] hoover_damn: just so you know jtimberman  ;)
[2012-04-20 02:50:56 -0400] jtimberman: e.g.: INSTALLATION DIRECTORY: /var/lib/gems/1.9.1
[2012-04-20 02:51:11 -0400] jtimberman: okay dude.
[2012-04-20 02:51:16 -0400] jtimberman: except no
[2012-04-20 02:51:42 -0400] jtimberman: /var/gems is not a fhs compliant location, and would not be the location where a debian policy compliant package (like the one in *debian*) will put anything.
[2012-04-20 02:51:43 -0400] hoover_damn: and just because your bootstraps overwrite debians rubygems
[2012-04-20 02:51:46 -0400] hoover_damn: doesn't make it right
[2012-04-20 02:51:50 -0400] mhalligan: ok so with ruby 19 and knife pointing at ruby 19 I still get all the same errors :/
[2012-04-20 02:52:12 -0400] hoover_damn: mhalligan, knife.rb has the dc in it?
[2012-04-20 02:52:16 -0400] mhalligan: aye
[2012-04-20 02:52:17 -0400] mhalligan: list works
[2012-04-20 02:52:28 -0400] hoover_damn: what's broken?
[2012-04-20 02:52:51 -0400] hoover_damn: jtimberman, ahh /var/lib/gems
[2012-04-20 02:52:52 -0400] mhalligan: oh wait I'm lost in version-hell it's my fault
[2012-04-20 02:52:56 -0400] hoover_damn: jtimberman, still ugly
[2012-04-20 02:53:12 -0400] hoover_damn: knife1.9
[2012-04-20 02:53:13 -0400] hoover_damn: ?
[2012-04-20 02:53:19 -0400] UForgotten: Urocyon: that syntax does not work either, same error.
[2012-04-20 02:53:31 -0400] jtimberman: i don't think it will install a knife1.9
[2012-04-20 02:53:32 -0400] Urocyon: wow.... tenacious
[2012-04-20 02:53:50 -0400] UForgotten: yeah
[2012-04-20 02:53:53 -0400] UForgotten: its been a long day :(
[2012-04-20 02:54:12 -0400] kyd: passing variables like uforgotten is doing should work just fine, i think that is a red herring
[2012-04-20 02:54:24 -0400] kyd: variables(:var1 => "blah", :var2 => "blah")
[2012-04-20 02:54:35 -0400] UForgotten: except that doesn't work.
[2012-04-20 02:54:38 -0400] kyd: the error is still undefined method on `'?
[2012-04-20 02:54:41 -0400] UForgotten: yeah
[2012-04-20 02:54:45 -0400] Urocyon: UForgotten, while I haven't written my own recipes using that sytax, I have used others that do, and the sytax looks just like what you have done, so I'm stumped.
[2012-04-20 02:54:48 -0400] UForgotten: I'm going to try adding a second variable ot the working template
[2012-04-20 02:54:50 -0400] kyd: right, but you're evaluating two different .erb's
[2012-04-20 02:55:18 -0400] kyd: redis.conf.erb doesn't work, redis-start-script.erb does. i think it's still something in the template but i don't see it.
[2012-04-20 02:55:31 -0400] kyd: (am i right on which one works and which one doesn't?)
[2012-04-20 02:55:32 -0400] UForgotten: aha.
[2012-04-20 02:55:55 -0400] UForgotten: yes. redis.conf.erb is the problem somewhere.
[2012-04-20 02:56:07 -0400] kyd: and that is this paste?
[2012-04-20 02:56:07 -0400] kyd: http://pastebin.com/As404yPB
[2012-04-20 02:56:10 -0400] UForgotten: because I can pass two vars to the init one just fine
[2012-04-20 02:56:31 -0400] UForgotten: yes, and we already fixed the extra %> on line 46.
[2012-04-20 02:56:33 -0400] Urocyon: ooooh
[2012-04-20 02:56:34 -0400] kyd: and you've definitely fixed line 46 and uploaded to your chef server, blah blah
[2012-04-20 02:56:44 -0400] UForgotten: dont aste your time on it, let me look at it again
[2012-04-20 02:56:54 -0400] UForgotten: I have a vi template that is too smart sometimes
[2012-04-20 02:56:59 -0400] Urocyon: UForgotten what if you only pass one varable to each?
[2012-04-20 02:57:01 -0400] UForgotten: it probably added more unneeded %>'s
[2012-04-20 02:57:08 -0400] bemu: UForgotten: This is unrelated, but you're missing a " in the logfile line
[2012-04-20 02:57:14 -0400] Urocyon: UForgotten does it still error on the second template?
[2012-04-20 02:57:24 -0400] kyd: yea and i think the undef method on `' is then the (confusing) behavior for unmatched macro tags in ERB
[2012-04-20 02:57:30 -0400] UForgotten: Urocyon: no, the second template will take another variable without complaining.
[2012-04-20 02:58:05 -0400] kyd: a stray %> seems to be acting like <%= %>
[2012-04-20 02:58:12 -0400] mhalligan: oh crap it worked all I had to do was install ruby19 and fork the project to make it not use the non-existance rackspace variables then rebuild the gem install it and convert from atheism back to catholicism
[2012-04-20 02:58:23 -0400] UForgotten: kyd: yep makes sense
[2012-04-20 02:58:30 -0400] hoover_damn: mhalligan, excellent
[2012-04-20 02:58:39 -0400] mhalligan: now I have Nagios launching nodes based on overall memory usages
[2012-04-20 02:58:41 -0400] mhalligan: what could go wrong?
[2012-04-20 02:58:43 -0400] hoover_damn: jtimberman, it will
[2012-04-20 02:58:46 -0400] hoover_damn: jtimberman, :)
[2012-04-20 02:58:53 -0400] hoover_damn: jtimberman, someday you'll be a believer.
[2012-04-20 02:58:57 -0400] bemu: mhalligan: LOL :D
[2012-04-20 02:59:16 -0400] hoover_damn: but if your running REE your running an EOL Ruby... so *eyeroll*
[2012-04-20 02:59:31 -0400] jtimberman: is this legal in erb? <%= @port || 6379 %>
[2012-04-20 02:59:41 -0400] kyd: i would think so
[2012-04-20 02:59:48 -0400] bemu: I think so, but was wondering the same thing.
[2012-04-20 02:59:50 -0400] kyd: but worth trying on its own
[2012-04-20 02:59:54 -0400] bemu: You could be sure by putting "6379"
[2012-04-20 02:59:57 -0400] jtimberman: stylistically i'd evaluate that in the recipe and pass in the port.
[2012-04-20 03:00:05 -0400] bemu: Same here.
[2012-04-20 03:00:09 -0400] kyd: or <%= (@port || 6379) %>
[2012-04-20 03:00:16 -0400] jtimberman: mhalligan: seems legit.
[2012-04-20 03:00:17 -0400] UForgotten: dude
[2012-04-20 03:00:19 -0400] UForgotten: if that is the problem
[2012-04-20 03:00:25 -0400] UForgotten: I'm going to give my developer endless shit for that
[2012-04-20 03:00:25 -0400] jtimberman: i'm not saying its the problem :)
[2012-04-20 03:00:37 -0400] kyd: my bet is that's not it
[2012-04-20 03:00:48 -0400] bemu: I'd bet that it is not as well.
[2012-04-20 03:01:16 -0400] Urocyon: UForgotten: so using http://pastebin.com/E6gF6VLJ as a reference.  The first template fails, whether passed one or two variables, and the second template always succeeds whether using one or two variables?
[2012-04-20 03:01:34 -0400] bemu: Urocyon: We've eliminated the number of variables as a problem.
[2012-04-20 03:01:58 -0400] UForgotten: yeah its a template parse error of some sort
[2012-04-20 03:02:02 -0400] Urocyon: What about the template name?
[2012-04-20 03:02:19 -0400] bemu: I don't think that's it either.
[2012-04-20 03:02:25 -0400] bemu: UForgotten: Can you paste a fresh version of the template?
[2012-04-20 03:02:26 -0400] Urocyon: If you named the template redis-nonproduction and redis-production would it work?
[2012-04-20 03:02:40 -0400] bemu: oh, I see what you're saying.
[2012-04-20 03:03:11 -0400] UForgotten: Urocyon: ithats the destination file not the template file. the template file is the same
[2012-04-20 03:03:20 -0400] UForgotten: there are two templates in play though.
[2012-04-20 03:03:29 -0400] UForgotten: and we have narrowed it to one, the redis.conf.erb
[2012-04-20 03:03:35 -0400] UForgotten: and its not the port
[2012-04-20 03:03:55 -0400] UForgotten: just removed the ||
[2012-04-20 03:04:15 -0400] bemu: gist a fresh copy.
[2012-04-20 03:04:19 -0400] kyd: UForgotten: fresh version of the template so we can take another look?
[2012-04-20 03:04:47 -0400] UForgotten: sure - latest version http://pastebin.com/2gycWep5
[2012-04-20 03:04:50 -0400] kyd: and a stack trace if you have it, too
[2012-04-20 03:05:46 -0400] bemu: note that you're still missing a " here: logfile /var/log/redis<%= @theinstance %>/redis.log"
[2012-04-20 03:05:49 -0400] bemu: but that isn't your problem.
[2012-04-20 03:06:01 -0400] UForgotten: stack trace http://pastebin.com/nRSvdd6f
[2012-04-20 03:06:50 -0400] bemu: I cannot imagine this would be the issue, but you do have extra spaces after your @theinstance variables in a few places.
[2012-04-20 03:07:19 -0400] bemu: aside from those minor things, I don't see it
[2012-04-20 03:07:31 -0400] UForgotten: spaces are supposed to be innocuous but I'm willing to trim them out... for science
[2012-04-20 03:08:01 -0400] kyd: i noticed that too, and was starting to think 'stray hard tab'? but i still don't see how that would have this effect..
[2012-04-20 03:08:16 -0400] bemu: Yeah, this is baffling.
[2012-04-20 03:08:29 -0400] bemu: When I run into issues like this, I'll brute force it.
[2012-04-20 03:08:36 -0400] bemu: I would literally cut the template in half, test.
[2012-04-20 03:08:41 -0400] bemu: If it works, test the other half.
[2012-04-20 03:09:58 -0400] UForgotten: I'm at the point where I will do that, I can't lose another day to this hehe
[2012-04-20 03:10:10 -0400] mhalligan: nagiosbpi almost doesn't suck I think I'll post my cookbook for it once I get my providers working
[2012-04-20 03:11:44 -0400] bemu: When you get it narrowed down more, make another pastebin, and I'll take another look
[2012-04-20 03:12:20 -0400] UForgotten: ergh
[2012-04-20 03:12:25 -0400] bemu: Sup?
[2012-04-20 03:12:26 -0400] UForgotten: I took out every substituion
[2012-04-20 03:12:28 -0400] UForgotten: it still fails
[2012-04-20 03:13:37 -0400] UForgotten: http://www.youtube.com/watch?v=0ICpoWtFFzc
[2012-04-20 03:14:49 -0400] bemu: ahhh
[2012-04-20 03:14:55 -0400] jtimberman: bemu: find it?
[2012-04-20 03:15:00 -0400] bemu: Maybe.
[2012-04-20 03:15:07 -0400] bemu: Try removing the % in this line: # that's more or less between 60 and 80% of your free RAM.
[2012-04-20 03:15:21 -0400] bemu: % is also a control character in ERB
[2012-04-20 03:15:31 -0400] jtimberman: because with the redis.conf.erb pasted earlier, and the resource in the earlier paste, chef-solo converged for me.
[2012-04-20 03:17:04 -0400] Urocyon: UForgotten: I still wonder if its something other than the template.  If you just swap out the template you are using for one you know works... like the one you use in the second recipe, do you still get the error?
[2012-04-20 03:18:41 -0400] fudnuckle_: greetings
[2012-04-20 03:19:23 -0400] bemu: Salutations.
[2012-04-20 03:20:36 -0400] UForgotten: meh. none of htat works.
[2012-04-20 03:20:53 -0400] UForgotten: I'm going to step away from this for a bit.  I appreciate all the assistance.
[2012-04-20 03:21:08 -0400] bemu: UForgotten: What version of ruby?
[2012-04-20 03:21:13 -0400] bemu: nvm
[2012-04-20 03:21:14 -0400] UForgotten: 1.9.2-180
[2012-04-20 03:21:15 -0400] bemu: You posted that.
[2012-04-20 03:21:41 -0400] bemu: Good luck.
[2012-04-20 03:21:42 -0400] UForgotten: keep in mind its chef-solo inside vagrant as well. should not be any different in terms of a template process tho I would hope
[2012-04-20 03:22:13 -0400] Urocyon: If the known good template doesn't work, then I would say it's not the template.
[2012-04-20 03:22:50 -0400] fudnuckle_: im having troubles with vagrant and veewee hoping for some help
[2012-04-20 03:34:37 -0400] cwj: fudnuckle_: sorry, ive never used either
[2012-04-20 03:34:54 -0400] cwj: i probably should get in the habit though
[2012-04-20 03:38:13 -0400] fudnuckle_: dang i just started today not much luck so far other than installing
[2012-04-20 03:38:20 -0400] UForgotten: yeah if I point the template recipe to the working template file it still does not work
[2012-04-20 03:38:24 -0400] UForgotten: that makes absolutely no sense
[2012-04-20 03:41:05 -0400] jtimberman: UForgotten: for fun, can you remove the variables line entirely, just comment it out?
[2012-04-20 03:41:14 -0400] jtimberman: see if it blows up on the undefined @port or @theinstance
[2012-04-20 03:41:34 -0400] UForgotten: that is not it
[2012-04-20 03:41:41 -0400] UForgotten: it may be something in the recipe
[2012-04-20 03:41:57 -0400] UForgotten: because I changed the template file to the other working one and it still breaks
[2012-04-20 03:43:06 -0400] hippiehacker: I heard mention that opscode/cookbooks/application was being updated soon, has that happened?
[2012-04-20 03:44:17 -0400] jtimberman: hippiehacker: in progress.
[2012-04-20 03:44:33 -0400] jtimberman: hippiehacker: andrea campi is probably going to post something to the list this week.
[2012-04-20 03:45:39 -0400] hippiehacker: jtimberman: awesome, I was going to start working on something based on it, but I'll hold of a bit
[2012-04-20 03:46:00 -0400] jtimberman: hippiehacker: yeah. like, the code is actively being worked on.
[2012-04-20 03:46:45 -0400] Urocyon: UForgotten: I'd give commenting out the varables line a try.. see if it passes without it.  Should generate an error when the template tries to access the non existent variables.
[2012-04-20 03:46:47 -0400] UForgotten: o. m. f. g.
[2012-04-20 03:46:50 -0400] UForgotten: nope
[2012-04-20 03:46:55 -0400] UForgotten: it was spacing
[2012-04-20 03:47:00 -0400] UForgotten: fml
[2012-04-20 03:47:11 -0400] UForgotten: extra spaces?  wtf I thought ruby didn't care.
[2012-04-20 03:47:20 -0400] Urocyon: really really?  where?
[2012-04-20 03:48:02 -0400] bemu: I was right :D
[2012-04-20 03:48:20 -0400] bemu: Urocyon: It was like this: <%= @variable   %>
[2012-04-20 03:48:28 -0400] UForgotten: no
[2012-04-20 03:48:30 -0400] UForgotten: not that spacing
[2012-04-20 03:48:32 -0400] bemu: oh.
[2012-04-20 03:48:34 -0400] bemu: curses.
[2012-04-20 03:48:35 -0400] bemu: :B
[2012-04-20 03:48:38 -0400] UForgotten: the template recipe spacing
[2012-04-20 03:48:49 -0400] bemu: huh?
[2012-04-20 03:49:16 -0400] UForgotten: There was two spaces between the attributes such as owner   "root" instead of owner "root"
[2012-04-20 03:49:25 -0400] bemu: LOL
[2012-04-20 03:49:33 -0400] UForgotten: it should not care
[2012-04-20 03:49:33 -0400] bemu: Nice, did not know about that.
[2012-04-20 03:49:46 -0400] bemu: I didn't even notice that.
[2012-04-20 03:49:52 -0400] bemu: Nor did I think it would care.
[2012-04-20 03:50:01 -0400] jtimberman: http://cdn.shopify.com/s/files/1/0070/7032/files/wat_grande.jpg
[2012-04-20 03:50:09 -0400] jtimberman: uhm.
[2012-04-20 03:50:59 -0400] jtimberman: this recipe converged for me
[2012-04-20 03:51:00 -0400] jtimberman: https://gist.github.com/193a0a2ecd246451954d
[2012-04-20 03:51:03 -0400] Urocyon: well that is whack.
[2012-04-20 03:51:14 -0400] jtimberman: other than the file names, thats the one from one of your pastes
[2012-04-20 03:54:38 -0400] UForgotten: this is retarded. [Fri, 20 Apr 2012 03:57:36 -0400] FATAL: NoMethodError: undefined method `source' for Chef::Resource::Template
[2012-04-20 03:54:54 -0400] UForgotten: spaces really do matter apparently.
[2012-04-20 03:57:25 -0400] coderanger: UForgotten: How did you get a space in there?
[2012-04-20 03:57:38 -0400] UForgotten: coderanger: mad skills apparently. lol
[2012-04-20 03:57:49 -0400] UForgotten: Its probably the vi macros I'm using
[2012-04-20 03:57:52 -0400] UForgotten: I'll try textpad instead
[2012-04-20 03:58:00 -0400] coderanger: More likely that is something like a unicode nbsp or something
[2012-04-20 03:58:06 -0400] coderanger: which ruby doesn't consider whitespace
[2012-04-20 03:59:16 -0400] coderanger: Otherwise you would have had to do something like send(:" source", ...)
[2012-04-20 04:01:09 -0400] UForgotten: at first I thought it was a tab or something but I dont see it in a cat -ve
[2012-04-20 04:01:13 -0400] UForgotten: so I have no idea.
[2012-04-20 04:01:23 -0400] UForgotten: but re-spacing it fixed it.  what a pain.
[2012-04-20 04:01:46 -0400] Urocyon: very strange.
[2012-04-20 04:01:50 -0400] UForgotten: that was a pricey lesson to learn. but now I know if I see the ' ' errors
[2012-04-20 04:04:31 -0400] Urocyon: When I copy a paste the raw from your earlier pastebins into Textmate the special characters shw up for me.
[2012-04-20 04:04:44 -0400] Urocyon: I hadn't thought to check that earlier.
[2012-04-20 04:04:47 -0400] coderanger: UForgotten: If it is a mac, might have hit alt+space or something
[2012-04-20 04:05:06 -0400] jtimberman: vim :set paste was fine
[2012-04-20 04:06:52 -0400] UForgotten: meh. well thanks for glaring at empty spaces all night :( sorry for the fire drill.  time for bed.
[2012-04-20 04:12:31 -0400] jtimberman: UForgotten: no worries, glad its fixed :)
[2012-04-20 04:18:21 -0400] Urocyon: Checked with od, the broken character was a utf-8 nbsp.
[2012-04-20 04:19:04 -0400] Urocyon: 302 240
[2012-04-20 04:19:29 -0400] coderanger: That'l do it
[2012-04-20 04:19:38 -0400] coderanger: Ruby hates unicode whitespace
[2012-04-20 04:19:47 -0400] coderanger: Regexp too
[2012-04-20 04:20:09 -0400] miah: also donkeys
[2012-04-20 04:20:17 -0400] Urocyon: wat?
[2012-04-20 04:20:19 -0400] miah: just absolutely hates donkeys
[2012-04-20 04:21:58 -0400] jtimberman: http://cdn.shopify.com/s/files/1/0070/7032/files/wat_grande.jpg
[2012-04-20 04:22:05 -0400] jtimberman: That image never gets old.
[2012-04-20 04:22:22 -0400] jtimberman: also, relevant to whitespace wtfs and donkeys.
[2012-04-20 04:23:03 -0400] miah: ruby likes monkey patching, but NO NO donkey patching
[2012-04-20 04:23:24 -0400] Urocyon: well that mystery solved.  Maybe I'll tackle my infochimps elasticsearch recipe problem again tomorrow.
[2012-04-20 04:26:38 -0400] UForgotten:  I'd have found it sooner too if it weren't for those pesky kids and their damn horse head carrying a cat
[2012-04-20 04:32:52 -0400] miah: those pesky kids and their van full of pot smoke..
[2012-04-20 04:33:18 -0400] UForgotten: it just so happens to be 4/20. the odds are against us.
[2012-04-20 04:33:21 -0400] miah: yup
[2012-04-20 04:44:45 -0400] cwj: in the words of rands, perhaps bonghits will fix my makefile
[2012-04-20 04:44:57 -0400] miah: hghaguaglahagahg
[2012-04-20 04:45:03 -0400] cwj: :D
[2012-04-20 04:45:36 -0400] miah: <3 jerkcity forever
[2012-04-20 04:45:57 -0400] cwj: that is correct
[2012-04-20 04:49:38 -0400] miah: how is devopsdays already sold out
[2012-04-20 04:49:46 -0400] miah: GONNA CRASH THAT SHIT
[2012-04-20 04:50:51 -0400] Urocyon: I got to go last year when I attended velocity.  It was great.
[2012-04-20 04:51:28 -0400] Urocyon: I missed out on the second day, the open spaces though.  I was told that was really good.
[2012-04-20 04:52:18 -0400] Urocyon: I kind of regret not going to Austin.
[2012-04-20 04:52:34 -0400] Urocyon: I plan on going to Surge though.
[2012-04-20 04:52:43 -0400] Urocyon: not that anyone cares....
[2012-04-20 04:53:10 -0400] Urocyon: I just like to type stuff sometimes.
[2012-04-20 04:53:12 -0400] jtimberman: Urocyon: I'll be at Velocity and *probably* Surge this year.
[2012-04-20 04:54:57 -0400] Urocyon: I really liked velocity.  Always good to go to an O'Reilly event.   I used to work for them and am a coauthor of Linux in a Nutshell, so it's an extra treat for me.
[2012-04-20 04:55:45 -0400] miah: im just gonna be like. y0. im miah. let me in!
[2012-04-20 04:56:46 -0400] Urocyon: so, kind of late for debugging, but if anyone has insight..... I'm trying to use some infochimps cookbooks.  I was giving their elasticsearch cookbook a try, but it blows up when it tries to define a couple of volume_dirs.    https://gist.github.com/98f52689acd474e10bde
[2012-04-20 04:57:03 -0400] jtimberman: Urocyon: which co-author are you?
[2012-04-20 04:57:18 -0400] Urocyon: jtimberman: Stephen Figgins
[2012-04-20 04:57:43 -0400] Urocyon: I usually handle the admin and network commands, and a few other chapters.
[2012-04-20 04:59:09 -0400] jtimberman: :D
[2012-04-20 04:59:11 -0400] jtimberman: Cheers!
[2012-04-20 04:59:39 -0400] Urocyon: So, any suggestions on how to track down the problem in volumes?  I've looked at volume_dirs.rb line 76, and I don't know why it would be tossing out that error.
[2012-04-20 05:00:11 -0400] Urocyon: I'm somewhat new to ruby, so chasing down these errors can throw me.
[2012-04-20 05:00:41 -0400] jtimberman: have a link to the recipe?
[2012-04-20 05:01:03 -0400] jtimberman: there's a bug in definitions
[2012-04-20 05:01:06 -0400] jtimberman: iirc
[2012-04-20 05:01:11 -0400] Urocyon: was just pulling one up.
[2012-04-20 05:01:13 -0400] jtimberman: in the line that is reported is not the right line
[2012-04-20 05:02:00 -0400] Urocyon: https://github.com/infochimps-cookbooks/volumes/blob/master/definitions/volume_dirs.rb
[2012-04-20 05:02:37 -0400] Urocyon: https://github.com/infochimps-cookbooks/elasticsearch/blob/master/recipes/server.rb
[2012-04-20 05:05:53 -0400] jtimberman: Urocyon: there's quite a bit of indirection and a lot of various code bits in there
[2012-04-20 05:06:10 -0400] jtimberman: Urocyon: so in other words, I'm not sure off hand.
[2012-04-20 05:06:39 -0400] Urocyon: I'm not seeing it either.  Guess I'll take a closer look tomorrow.... or see if I can get Mr. Flip to give me a hand.
[2012-04-20 05:09:44 -0400] Urocyon: good night
[2012-04-20 06:20:40 -0400] BryanWB: ohai chefs!
[2012-04-20 06:22:54 -0400] jonlives: morning :)
[2012-04-20 06:27:40 -0400] BryanWB: jonlives: coming to chefconf?
[2012-04-20 06:28:07 -0400] jonlives: unfortunately not...patrick one of my colleagues is speaking tho!
[2012-04-20 06:28:28 -0400] BryanWB: jonlives: shame was looking forward to meeting u
[2012-04-20 06:28:30 -0400] jonlives: my overseas conf this year is velocity
[2012-04-20 06:28:35 -0400] jonlives: you gonna be there?
[2012-04-20 06:33:19 -0400] miah: herps
[2012-04-20 06:33:25 -0400] miah: whats up
[2012-04-20 06:35:45 -0400] BryanWB: miah: supsup
[2012-04-20 06:42:31 -0400] eblack: hmm, the -E switch on knife search doesn't seem to be filtering
[2012-04-20 06:42:35 -0400] eblack: maybe I'm misunderstanding it
[2012-04-20 06:42:55 -0400] eblack: knife search node "role:my_base" -E "my-env"
[2012-04-20 06:43:02 -0400] eblack: returns everything regardless the environment
[2012-04-20 06:45:08 -0400] coderanger: eblack: The -E flag mostly applies to stuff like node commands
[2012-04-20 06:45:27 -0400] coderanger: eblack: Searches aren't automatically scoped to the current env
[2012-04-20 06:47:01 -0400] eblack: coderanger: ahh, so you can't filter via environment for search, or ssh?
[2012-04-20 06:47:08 -0400] coderanger: Just put it in the search
[2012-04-20 06:47:25 -0400] coderanger: knife search node "role:my_base AND chef_environment:my-env"
[2012-04-20 06:47:33 -0400] eblack: oh
[2012-04-20 06:48:03 -0400] eblack: coderanger: I was originally using environement, not chef_environment
[2012-04-20 06:48:20 -0400] coderanger: Ahh :)
[2012-04-20 06:48:33 -0400] eblack: I also recall having this issue before when looking by IP; I do not remember where I discovered I was doing it wrong though heh
[2012-04-20 06:48:51 -0400] coderanger: In the old days before envs were a core feature lots of people used node attrs like "environment" and "app_environment"
[2012-04-20 06:48:58 -0400] coderanger: So we picked something non-overlapping
[2012-04-20 06:49:04 -0400] eblack: the output of `knife node show my_node` for IP and such aren't what you need to filter for
[2012-04-20 06:49:13 -0400] eblack: Ahh, I see
[2012-04-20 06:49:16 -0400] eblack: that makes sense
[2012-04-20 06:50:00 -0400] eblack: coderanger: thanks man
[2012-04-20 06:50:22 -0400] coderanger: No problem
[2012-04-20 07:11:58 -0400] BryanWB: andreacampi: will probably get your pull tomorrow, I have to run my tests before I merge it
[2012-04-20 07:12:07 -0400] BryanWB: andreacampi: tks for it!
[2012-04-20 07:14:55 -0400] andreacampi: hey
[2012-04-20 07:15:02 -0400] andreacampi: easier here :)
[2012-04-20 07:15:20 -0400] andreacampi: for the other discussion too :)
[2012-04-20 07:15:39 -0400] andreacampi: I agree re has_binaries vs append_env_path
[2012-04-20 07:15:52 -0400] BryanWB: andreacampi: should i add the fatal! call?
[2012-04-20 07:15:53 -0400] andreacampi: but then each cookbook (say, maven in this case) would have to know
[2012-04-20 07:16:07 -0400] andreacampi: probably yes, but I'd turn it around
[2012-04-20 07:16:15 -0400] BryanWB: andreacampi: ouch, good point
[2012-04-20 07:16:33 -0400] andreacampi: you probably need the fatal! on FreeBSD too
[2012-04-20 07:16:35 -0400] andreacampi: argh
[2012-04-20 07:16:39 -0400] andreacampi: Debian too, I mean
[2012-04-20 07:16:50 -0400] BryanWB: but i think debian has /etc/profile.d
[2012-04-20 07:17:11 -0400] andreacampi: does it? I don't have one right now, but a google search seemed to indicate it doesn't
[2012-04-20 07:17:25 -0400] andreacampi: we should find it out :)
[2012-04-20 07:17:28 -0400] Mithrandir: (it does)
[2012-04-20 07:17:42 -0400] andreacampi: Mithrandir thanks :)
[2012-04-20 07:17:57 -0400] andreacampi: ok then, I'm cool with special-casing FreeBSD
[2012-04-20 07:18:24 -0400] BryanWB: andreacampi: need better fall back than fatal!  for freebsd
[2012-04-20 07:18:39 -0400] andreacampi: then we should change the maven cookbook to use has_binaries on FreeBSD and not sure append_env_path, yes?
[2012-04-20 07:19:04 -0400] andreacampi: yeah my suggestion would be to just Chef::Log.warning "xxx was not installed but not added to the PATH"
[2012-04-20 07:19:10 -0400] andreacampi: s/warning/warn"
[2012-04-20 07:19:20 -0400] andreacampi: and let the user figure it out :)
[2012-04-20 07:19:50 -0400] BryanWB: but has_binaries needs input, needs to be told which binaries to symlink
[2012-04-20 07:20:10 -0400] BryanWB: warning and doing nothing is better solution
[2012-04-20 07:20:17 -0400] andreacampi: yeah well, that's up to whoever uses the ark LWRP right? in this case, the maven maintainer ;)
[2012-04-20 07:20:44 -0400] andreacampi: I can test this solution and send a pull request
[2012-04-20 07:20:51 -0400] BryanWB: andreacampi: can u create ticket? i have 4 people trying to get my attention right now :(
[2012-04-20 07:21:22 -0400] andreacampi: yeah. no worries mate, I'm working on Chef stuff all day today, I'll figure it out and create ticket / pull request
[2012-04-20 07:21:35 -0400] andreacampi: thanks
[2012-04-20 07:21:53 -0400] BryanWB: andreacampi: pls run tests, checkout my minitest-handler-cookbook
[2012-04-20 07:22:01 -0400] andreacampi: ok
[2012-04-20 07:22:12 -0400] BryanWB: andreacampi: and add my ark::test to run_list , pretty crude but it works
[2012-04-20 07:22:33 -0400] andreacampi: will do
[2012-04-20 07:22:45 -0400] BryanWB: tks
[2012-04-20 07:42:01 -0400] BryanWB: anyone know a good markdown tutorial?
[2012-04-20 08:01:12 -0400] fiona: how this tool works?
[2012-04-20 08:01:26 -0400] fiona: OK,I think I got it
[2012-04-20 08:03:07 -0400] coderanger: fiona: Bit of a generic question
[2012-04-20 10:03:04 -0400] specialsauce: hi, is there some sort of undocumented prerequisite for getting custom hef handlers to work? I've added the require path in full in the client.rb file as in the wiki guide, but the chef-client run warns "WARN: no such file to load -- /var/chef/handler-graphite". That file does exist so it must be unhappy about some syntax error orm issing dependency? but the file parses as valid ruby with no errors
[2012-04-20 11:09:55 -0400] eugenmayer: anybody using http://community.opscode.com/cookbooks/sudo ?
[2012-04-20 11:11:04 -0400] andreacampi: I am
[2012-04-20 11:11:44 -0400] eugenmayer: andreacampi: just a question for the LWRP
[2012-04-20 11:12:02 -0400] andreacampi: ok
[2012-04-20 11:13:08 -0400] eugenmayer: i need to e.g. allow some specific commands to be excuted form user X in the name of user Y. it seems to be possible with LWRP, but not in the "node context"i admin, i currently only know to use LWRP containers as "global for all nodes"never seen them used with a "node context"
[2012-04-20 11:14:16 -0400] eugenmayer: can i simply execute sudo "tomcat" do whatever in a recipe and all nodes including this recipes will have a "this node has this sudo line" in the global LWRP (for only this node? )
[2012-04-20 11:16:25 -0400] andreacampi: only those nodes execute that recipe, so yes, only those will get those shudders entries
[2012-04-20 11:19:13 -0400] eugenmayer: well, iam not sure i got you
[2012-04-20 11:19:41 -0400] eugenmayer: all entries in that LWRP, do they have a pk of "<node,rule>" or just "<rule>"
[2012-04-20 11:19:51 -0400] eugenmayer: so can i deploy sudo-entries for one node specfic ONLY ?
[2012-04-20 11:20:08 -0400] eugenmayer: (sorry if iam stating stupid questions)
[2012-04-20 11:21:34 -0400] andreacampi: oh, I see
[2012-04-20 11:22:46 -0400] andreacampi: so in your example, you want sudo "tomcat" on a bunch of nodes
[2012-04-20 11:22:59 -0400] andreacampi: but then on some of them, you want slightly different rules?
[2012-04-20 11:23:34 -0400] andreacampi: or you're just being paranoid :) (with paranoia being a good thing, when security is involved)
[2012-04-20 11:29:20 -0400] andreacampi: either way, in default mode you can pass a host attribute
[2012-04-20 11:29:32 -0400] andreacampi: with the nodes you want to apply that rule to
[2012-04-20 11:30:33 -0400] eugenmayer: hmmi rather would like to configure node by node, using roles
[2012-04-20 11:30:40 -0400] eugenmayer: that kind of "counterfires" roles
[2012-04-20 11:31:11 -0400] eugenmayer: andreacampi: looks like the "node" attribute i can really e.g. provide all meta data like "which command"
[2012-04-20 11:58:32 -0400] andreacampi: yeah, you do get a lot of control
[2012-04-20 12:15:37 -0400] jannel: is it still true for cookbooks that you cannot use a template from an included cookbook, although you can use a definition from the cookbook?
[2012-04-20 12:16:36 -0400] Mithrandir: still true?  You can use included cookbook templates just fine
[2012-04-20 12:16:43 -0400] Mithrandir: you just need to reference them properly.
[2012-04-20 12:16:51 -0400] andreacampi: templates are not looked up automatically there, but the template resource has a cookbook attribute
[2012-04-20 12:17:05 -0400] andreacampi: template "foo" { cookbook "bar" }
[2012-04-20 12:18:48 -0400] jannel: Mithrandir: I understood that was the case from here: http://tickets.opscode.com/browse/CHEF-1490
[2012-04-20 12:20:32 -0400] jannel: andreacampi: ah, ok. so if I want to explicitly specify in a definition that I want to use the original cookbook, I can specify cookbook "original"?
[2012-04-20 12:20:43 -0400] andreacampi: yes
[2012-04-20 12:23:04 -0400] jannel: thanks :)
[2012-04-20 12:33:13 -0400] eugenmayer: andreacampi: iam still not sure, whether i can use that sudo-cookbook to deploy sudo-directives on individuell nodes or groups
[2012-04-20 12:34:12 -0400] eugenmayer: andreacampi: AFAICS i can use the LWRP in recipes - thats great. But still, it seems those rules are enforced on all nodes including the sudo-recipe then, right? I would create a recipe "A", which will be included in Role A. and a recipe B for roles b
[2012-04-20 12:34:33 -0400] andreacampi: nope
[2012-04-20 12:34:40 -0400] eugenmayer: now i want all sude-directives for A only deployed for nodes in Role A, and all in B for b
[2012-04-20 12:34:52 -0400] eugenmayer: andreacampi: nope -> note possible, right?
[2012-04-20 12:34:57 -0400] andreacampi: if you use the resource on a node, it doesn't affect other nodes
[2012-04-20 12:35:07 -0400] andreacampi: there's no magical communication via the sudo LWRP
[2012-04-20 12:35:54 -0400] andreacampi: nope -> But still, it seems those rules are enforced on all nodes including the sudo-recipe then, right?
[2012-04-20 12:36:10 -0400] andreacampi: everything else you wrote, is exactly the way it works out of the box
[2012-04-20 12:36:24 -0400] andreacampi: nodes with role A will get what you defined in recipe A
[2012-04-20 12:36:37 -0400] andreacampi: the other nodes will have no idea
[2012-04-20 12:37:06 -0400] andreacampi: does that make sense?
[2012-04-20 12:37:36 -0400] andreacampi: try it if it still doesn't work, paste it in a gist and post that link
[2012-04-20 13:08:45 -0400] eugenmayer: andreacampi: thank you!
[2012-04-20 13:09:03 -0400] eugenmayer: i will just try it-maybe i just dont have the right POV on LWRP
[2012-04-20 13:09:08 -0400] eugenmayer: andreacampi++
[2012-04-20 13:09:17 -0400] andreacampi: anytime :)
[2012-04-20 13:29:52 -0400] sagar_nikam: Hi I want to down the following cookbook --- http://community.opscode.com/cookbooks/hadoop
[2012-04-20 13:29:56 -0400] sagar_nikam: how do i do it
[2012-04-20 13:30:30 -0400] sagar_nikam: executing this command gives a error knife cookbook site install hadoop
[2012-04-20 13:31:32 -0400] knuckolls_: sagar_nikham: take a look at librarian: https://github.com/applicationsonline/librarian
[2012-04-20 13:31:43 -0400] knuckolls_: it's basically bundler for third party cookbooks
[2012-04-20 13:33:01 -0400] sagar_nikam: ok
[2012-04-20 13:38:53 -0400] sagar_nikam: knuckolls: can i git clone to the repo and download the required cookbook and then upload
[2012-04-20 13:39:00 -0400] sagar_nikam: will it work
[2012-04-20 13:40:38 -0400] knuckolls_: sagar_nikham: i'm not sure what you mean. do you just want to download the community hadoop cookbook to your cookbooks folder?
[2012-04-20 13:41:38 -0400] sagar_nikam: yes - will that work ?
[2012-04-20 13:42:09 -0400] knuckolls_: yeah as long as you get the files in your cookbook folder you can work with the cookbook. git clone it and copy it, use knife cookbook site install, or librarian
[2012-04-20 13:42:24 -0400] knuckolls_: i've found that librarian is the simplest
[2012-04-20 13:42:55 -0400] sagar_nikam: i am new to chef, so still learning
[2012-04-20 13:43:13 -0400] sagar_nikam: how to use it
[2012-04-20 13:43:20 -0400] sagar_nikam: i mean librarian
[2012-04-20 13:44:12 -0400] knuckolls_: sagar_nikham: yeah no problem. the simplest path to execution would be to make a Gemfile, add librarian to it, run bundle install, create a Cheffile, add hadoop to it, and then run librarian-chef install
[2012-04-20 13:44:43 -0400] knuckolls_: sagar_nikham: anyway i've got to head in to work. best of luck
[2012-04-20 13:45:05 -0400] sagar_nikam: ok thanks
[2012-04-20 13:46:32 -0400] tylermd: Hi, I've got a newbie very basic question
[2012-04-20 13:46:59 -0400] tylermd: I just added some roles to a node. How can I make the node run  them?
[2012-04-20 13:48:17 -0400] knuckolls_: tylermd: headed out the door, but here are some links that might clear some things up. a node will have a run_list, running chef-client on the node should execute the chef_run. http://wiki.opscode.com/display/chef/Knife+Bootstrap  http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-04-20 13:49:15 -0400] tylermd: Ialready run chef bootstrap on the node before adding the roles to it
[2012-04-20 13:49:47 -0400] tylermd: just by assigning those roles to the node should have triggered the recipes?
[2012-04-20 13:50:01 -0400] vdvluc: yes
[2012-04-20 13:50:17 -0400] knuckolls_: tylermd: only if chef-client is set up on the node as a daemon checking in with the server periodically
[2012-04-20 13:50:26 -0400] knuckolls_: tylermd: if not, you should run chef-client by hand
[2012-04-20 13:50:36 -0400] tylermd: good point I'll check the daemon
[2012-04-20 13:51:09 -0400] tylermd: ps aux show me this: root      6238  0.0  3.3 115404 33900 ?        S    Apr18   0:54 /usr/bin/ruby1.8 /usr/bin/chef-client -d -P /var/run/chef/client.pid -L /var/log/chef/client.log -c /etc/chef/client.rb -i 1800 -s 20
[2012-04-20 13:51:32 -0400] knuckolls_: use knife node show to make sure you altered the run_list correctly
[2012-04-20 13:51:47 -0400] knuckolls_: anyway this time for real. i'm out the door, good luck :)
[2012-04-20 13:52:26 -0400] sime: How can I install the mysql gem with chef? As the database cookbook depends on it
[2012-04-20 13:53:41 -0400] tylermd: looks fine
[2012-04-20 13:53:43 -0400] tylermd: Run List:    role[base], role[radiant_database_master], role[radiant], role[radiant_run_migrations], recipe[radiant::db_bootstrap], role[radiant_load_balancer]
[2012-04-20 13:54:29 -0400] afallows: tylermd: When you add roles or recipes to a node, those roles/recipes will be run the next time the node runs chef-client. It looks like your node is set up to run every 30 minutes (that '-i 1800' means on an interval of 1800 seconds), so it should run again within half an hour, and run its current run list.
[2012-04-20 13:54:50 -0400] afallows: You can also manually run chef-client on the node again.
[2012-04-20 13:55:13 -0400] tylermd: roles have been there for more than an hour
[2012-04-20 13:55:19 -0400] tylermd: somehting must have gone wrong
[2012-04-20 13:55:29 -0400] tylermd: where can I see that?
[2012-04-20 13:55:34 -0400] tylermd: where are the logs?
[2012-04-20 13:56:06 -0400] vdvluc: /var/chef/cache contains a stackstrace if something went wrong
[2012-04-20 13:56:38 -0400] afallows: You can also look for /var/log/chef, which will probably contain client.log
[2012-04-20 13:57:03 -0400] tylermd: ahhhh I can see errors there
[2012-04-20 13:57:14 -0400] tylermd: Generated at Thu Apr 19 16:54:53 +0100 2012 Net::HTTPServerException: 412 "Precondition Failed" /usr/lib/ruby/1.8/net/http.rb:2105:in `error!'
[2012-04-20 13:57:45 -0400] tylermd: on /var/log/chef-client.log I can see this
[2012-04-20 13:58:02 -0400] afallows: Try running chef-client manually on the node and see if you get errors. IF you do, then there might be something wrong in one of rthe recipes you're trying to run.
[2012-04-20 13:58:03 -0400] tylermd: [Fri, 20 Apr 2012 14:45:24 +0100] INFO: HTTP Request Returned 412 Precondition Failed: {"non_existent_cookbooks":["zsh","users","sudo","application"],"cookbooks_with_no_versions":[],"message":"Run list contains invalid items: no such cookbooks zsh, users, sudo, application."} [Fri, 20 Apr 2012 14:45:24 +0100] ERROR: Running exception handlers [Fri, 20 Apr 2012 14:45:24 +0100] FATAL: Saving node information to /var/cache/chef/failed-run
[2012-04-20 13:58:39 -0400] tylermd: Maybe adding those missing cookbooks will fix it
[2012-04-20 13:58:42 -0400] tylermd: ["zsh","users","sudo","application"]
[2012-04-20 13:58:46 -0400] afallows: It should.
[2012-04-20 14:03:27 -0400] sime: I think the chef why to install a gem is gem_package("mysql")
[2012-04-20 14:05:46 -0400] dwhsix: sorta off-topic, but probably a knowledgable group for this:
[2012-04-20 14:05:55 -0400] dwhsix:  if you have a workload which is gradually cyclical throughout the day (e.g. not spiky), what max CPU utilization do you tend to target?  50%?  70%?
[2012-04-20 14:06:10 -0400] dwhsix: (I know, this is greatly simplifying things, but still...)
[2012-04-20 14:06:46 -0400] sagar_nikam: i am trying Fast Start Guide. On executing this command ---------- knife cookbook site install getting-started
[2012-04-20 14:06:53 -0400] sagar_nikam: i am getting this error
[2012-04-20 14:06:56 -0400] sagar_nikam: Installing getting-started to /home/ubuntu/chef-repo/.chef/../cookbooks ERROR: The cookbook repo path /home/ubuntu/chef-repo/.chef/../cookbooks does not exist or is not a directory
[2012-04-20 14:07:04 -0400] jtimberman: tylermd: did you upload those cookbooks?
[2012-04-20 14:07:22 -0400] tylermd: I'm on it right now
[2012-04-20 14:07:32 -0400] dwhsix: e.g. https://skitch.com/dwhsix/8wwms/aws-management-console
[2012-04-20 14:10:47 -0400] tylermd: great! chef-client doing many things now
[2012-04-20 14:11:16 -0400] vdvluc: :)
[2012-04-20 14:11:36 -0400] tylermd: thank you very much jtimberman, afallows and knuckolls_
[2012-04-20 14:12:08 -0400] tylermd: vdvluc too!
[2012-04-20 14:12:54 -0400] jtimberman: :D
[2012-04-20 14:19:52 -0400] afallows: So, I've got all my nodes installing chef-client as daemon, but I'm getting errors when they run automatically. It looks, from the errors, like the environment preserved by sudo -E is not being preserved when the client is daemonized by the chef-client::service recipe.
[2012-04-20 14:21:36 -0400] afallows: Is there an easy way I could modify the chef-client::service recipe to invoke the client with sudo -E?
[2012-04-20 14:29:41 -0400] hcastro: is there an easy way to determine chef environment from an ohai plugin -- also, is that even a good idea?
[2012-04-20 14:30:11 -0400] knuckolls: node.chef_environment is what you can use in a recipe
[2012-04-20 14:31:34 -0400] hcastro: right, i don't believe that "node" is available within the context of an ohai plugin
[2012-04-20 14:34:32 -0400] jtimberman: hcastro: best to do that logic in a recipe
[2012-04-20 14:35:27 -0400] hcastro: jtimberman: context https://github.com/hectcastro/ohai-plugins/blob/master/README.md
[2012-04-20 14:42:50 -0400] DoopliCo: I've already done a basic server setup, how do I run the ssl proxy recipe?
[2012-04-20 14:51:30 -0400] rshade98: can you use subscribes on external cookbooks
[2012-04-20 14:51:36 -0400] eugenmayer: can someone give me a hint how to include https://github.com/opscode-cookbooks/sudo/blob/master/README.md
[2012-04-20 14:51:48 -0400] eugenmayer: include_recipe "sudo" does not work
[2012-04-20 14:54:14 -0400] ryanwatts: i'm trying to start neo4j with chef and it seems that neo4j keeps getting killed when the chef recipe is done executing
[2012-04-20 14:54:33 -0400] ryanwatts: i've described the problem in more detail here: https://groups.google.com/forum/#!topic/neo4j/hk5cvXlmfCE
[2012-04-20 14:56:03 -0400] hcastro: rshade98: by external you mean cookbooks outside of the one you're using subscribes in?
[2012-04-20 14:57:39 -0400] afallows: ryanwatts: If the result is exactly the same when you run neo4j manually on the node, I'm going to wager that chef isn't the culprit.
[2012-04-20 14:58:00 -0400] ryanwatts: afallows: it works when i run neo4j manually
[2012-04-20 14:59:35 -0400] afallows: Oh, I must have misunderstood one of your comments in the google groups thread. You're saying you tried invoking /etc/init.d/neo4j through a recipe, and it shuts down when the run ends?
[2012-04-20 14:59:43 -0400] ryanwatts: yes
[2012-04-20 14:59:50 -0400] ryanwatts: looking at the log files i see: 4/20/12 2:17:15 PM org.neo4j.server.NeoServerWithEmbeddedWebServer INFO: Server started on [http://localhost:7474/]
[2012-04-20 14:59:50 -0400] ryanwatts: 4/20/12 2:18:08 PM org.neo4j.server.NeoServerBootstrapper INFO: Neo4j Server shutdown initiated by kill signal
[2012-04-20 14:59:50 -0400] ryanwatts: 4/20/12 2:18:08 PM org.neo4j.server.statistic.StatisticStartupListener INFO: stopping filter
[2012-04-20 15:00:11 -0400] ryanwatts: that shutdown timing is one second after the chef recipe finishes executing
[2012-04-20 15:00:40 -0400] ryanwatts: so i'm guessing that the chef shell exiting is what's causing the kill signal to get sent
[2012-04-20 15:01:12 -0400] afallows: How is chef-client getting called?
[2012-04-20 15:01:42 -0400] ryanwatts: knife ec2
[2012-04-20 15:02:57 -0400] afallows: That's strange behavior. I've used knife ec2 to bootstrap nodes that start daemon processes without any issues - the processes are still running when the server create is done.
[2012-04-20 15:04:24 -0400] ryanwatts: so have i, which initially lead me to believe it was some issue with neo4j, but given that it works when started manually i figure it's got to have something to do with chef
[2012-04-20 15:10:25 -0400] zts: ryanwatts: so if you start it by hand, and then log out, it continues running?
[2012-04-20 15:13:19 -0400] ryanwatts: zts: that is correct
[2012-04-20 15:13:57 -0400] Urocyon: eugenmayer I have sudo in my base server role, and it works fine.
[2012-04-20 15:14:15 -0400] eugenmayer: Urocyon: was all my bad .. forgot to add the cookbook to sudo
[2012-04-20 15:14:37 -0400] Urocyon: ah, cool.
[2012-04-20 15:16:27 -0400] eugenmayer: Urocyon: one issue i see - it does not get cleanup
[2012-04-20 15:16:47 -0400] eugenmayer: so if you ever created a sudo rule it never gets deleted
[2012-04-20 15:16:54 -0400] eugenmayer: eventhough the recipe will not include
[2012-04-20 15:24:52 -0400] Urocyon: eugenmayer: yeah not a lot of recipes clean up after themselves.
[2012-04-20 15:25:20 -0400] eugenmayer: that is one of the big flaws against "files" and "templates" again "debian packages" + preseed
[2012-04-20 15:26:03 -0400] eugenmayer: currently in my recipes, iam doing things like https://github.com/EugenMayer/shorewall/blob/master/recipes/default.rb#L25
[2012-04-20 15:35:19 -0400] Babbelaar: sorry got disconnected there for a bit
[2012-04-20 15:35:52 -0400] rwatts: anybody have any suggestions i missed?
[2012-04-20 15:58:00 -0400] miah: moin
[2012-04-20 15:59:49 -0400] holoway: miah: hola
[2012-04-20 16:00:11 -0400] holoway: miah: you are everywhere, btw - I was looking for the mechanism to include oracle's cookie to download the jvm, and viola - you had the answer on the intertrons
[2012-04-20 16:00:18 -0400] miah: =)
[2012-04-20 16:00:22 -0400] holoway: so thank :)
[2012-04-20 16:00:26 -0400] miah: your welcome
[2012-04-20 16:00:27 -0400] holoway: s/thank/thanks/
[2012-04-20 16:00:54 -0400] miah: its amazing what some time with wireshark will tell you
[2012-04-20 16:01:19 -0400] holoway: totally - I was really hoping I wouldn't need to go that far
[2012-04-20 16:01:38 -0400] miah: ya. i had hoped so too. but honestly, it was the quicker way to solve the problem.
[2012-04-20 16:02:52 -0400] miah: but i worked in the security industry for a while, so wireshark and tcpdump and i are old friends.
[2012-04-20 16:03:54 -0400] jtimberman: holoway: miah: is there a fix for that then?
[2012-04-20 16:04:09 -0400] jtimberman: holoway: and if so, is it something we should add to the java::oracle recipe?
[2012-04-20 16:04:15 -0400] miah: ah yes
[2012-04-20 16:04:25 -0400] miah: you have to pass a cookie
[2012-04-20 16:04:28 -0400] miah: and it workies
[2012-04-20 16:05:19 -0400] holoway: you would need to put some more ceremony around it
[2012-04-20 16:05:26 -0400] holoway: if you wanted to put it into the java::oracle recipe
[2012-04-20 16:05:34 -0400] miah: jtimberman: https://github.com/flexiondotorg/oab-java6/issues/18
[2012-04-20 16:05:47 -0400] holoway: like notification that by including/using the recipe you are accepting the terms of the Java binary license agreement
[2012-04-20 16:05:47 -0400] miah: holoway: true
[2012-04-20 16:06:01 -0400] holoway: you aren't violating the license by doing it that way
[2012-04-20 16:06:05 -0400] miah: ya
[2012-04-20 16:06:09 -0400] holoway: (and you wouldn't be if you didn't have hte notice)
[2012-04-20 16:06:11 -0400] miah: use log resource or something
[2012-04-20 16:06:13 -0400] holoway: but it's more in the spirit
[2012-04-20 16:06:17 -0400] holoway: of their intention
[2012-04-20 16:06:41 -0400] holoway: it's a strange license - I read it top to bottom for like the 10th time when I started that adventure
[2012-04-20 16:06:56 -0400] holoway: we can include the JRE in the omnibus builds, but I can't include the JRE in the thing that builds the build
[2012-04-20 16:06:59 -0400] holoway: good times
[2012-04-20 16:06:59 -0400] holoway: :)
[2012-04-20 16:07:06 -0400] miah: i didnt read the license
[2012-04-20 16:07:22 -0400] miah: i feel like it absolves me more. like blackbox coding =)
[2012-04-20 16:07:48 -0400] jtimberman: o.o
[2012-04-20 16:07:57 -0400] holoway: miah: I think that's a reasonable point of view - plenty of evidence that knowing/talking about potential license violations is worse than just violating it in ignorance
[2012-04-20 16:08:05 -0400] miah: yup
[2012-04-20 16:08:07 -0400] TheBeast: I'm using https://github.com/opscode-cookbooks/ufw/blob/master/recipes/default.rb to apply some basic iptables rules via ufw on a couple of ubuntu boxes and everything works great. Thing is, I have different servers with different firewall requirements and I'm not sure how I'm supposed to manage this.
[2012-04-20 16:08:15 -0400] TheBeast: can someone shed some light?
[2012-04-20 16:08:17 -0400] holoway: miah: I kind of wanted to roll my brain back to before the time that I became an OSS licensing geek
[2012-04-20 16:08:23 -0400] holoway: miah: so that I wouldn't have to worry about it
[2012-04-20 16:08:30 -0400] holoway: and could jjust do the wrong thing ignorantly
[2012-04-20 16:08:31 -0400] holoway: :)
[2012-04-20 16:08:36 -0400] miah: i can see the value in that
[2012-04-20 16:09:01 -0400] miah: i have perfected deadpan so i wonder how ignorant i really am
[2012-04-20 16:11:06 -0400] Mithrandir: holoway: what about if you require omnibus to build omnibus, can you then put it in the thing that builds the build?
[2012-04-20 16:11:20 -0400] miah: omnibus inception?
[2012-04-20 16:11:23 -0400] holoway: Mithrandir: whats funny is, if it was the clojure omnibus
[2012-04-20 16:11:28 -0400] holoway: Mithrandir: we could totally bundle the JRE
[2012-04-20 16:12:00 -0400] Mithrandir: holoway: clearly, the easiest way to get around this is to use openjdk to build the omnibus and then put the oracle jdk into the omnibus
[2012-04-20 16:12:03 -0400] Mithrandir: or something.
[2012-04-20 16:12:12 -0400] Mithrandir: just what you need: MOAR JAVA.  and MOAR SDK.
[2012-04-20 16:12:13 -0400] holoway: but.. since we don't need the JRE to run the application (the omnibus builder in ruby)
[2012-04-20 16:12:20 -0400] holoway: it's cool
[2012-04-20 16:12:27 -0400] holoway: what it's doing now works fine, and doesn't violate their license terms
[2012-04-20 16:12:44 -0400] holoway: or even their intent by making you make with the clicky and only download it from oracle
[2012-04-20 16:13:03 -0400] miah: i have a feeling that oracle is going to continue to not know how to manage java and openjdk is going to mature quickly
[2012-04-20 16:13:35 -0400] Mithrandir: miah: aiui, the official jdk is openjdk + some proprietary bits in a blessed build.
[2012-04-20 16:13:35 -0400] miah: look what happened with solaris
[2012-04-20 16:13:43 -0400] jtimberman: Mithrandir: oh geez, that reminds me of an install tool for some java app i once used. the install tool used the sun jre and bundled it (OS one wouldn't work for some reason O.o), and the app it installed included the IBM JRE.
[2012-04-20 16:13:46 -0400] Mithrandir: and those proprietary bits are slowly becoming open.
[2012-04-20 16:13:52 -0400] miah: ya
[2012-04-20 16:14:01 -0400] miah: there are things that clearly
[2012-04-20 16:14:02 -0400] Mithrandir: jtimberman: at that point, the only thing to do is to drink.
[2012-04-20 16:14:06 -0400] miah: 'dont work' on openjdk though
[2012-04-20 16:14:10 -0400] jtimberman: Mithrandir: oh, i did.
[2012-04-20 16:14:19 -0400] Mithrandir: miah: sure.  Those are getting fewer and fewer, though.
[2012-04-20 16:14:43 -0400] miah: indeed
[2012-04-20 16:15:09 -0400] miah: jtimberman: that is lulz
[2012-04-20 16:15:30 -0400] Mithrandir: even more so because i* doesn't do java, and people Must Support i* Or There Will Be Yelling.
[2012-04-20 16:15:40 -0400] jtimberman: miah: the best part: the installer was a *gui only* java thing, and we had to install that shit over ssh from california :)
[2012-04-20 16:15:54 -0400] miah: ouch
[2012-04-20 16:16:32 -0400] miah: i think the craziest thing i did was kickstart hosts in bolivia that i only had ssh access to
[2012-04-20 16:17:04 -0400] miah: i would make somebody else deal with that gui problem =)
[2012-04-20 16:19:21 -0400] miah: i think i need to write down all my crazy ponzi scheme stories
[2012-04-20 16:19:21 -0400] geekbri: java is the pits
[2012-04-20 16:19:40 -0400] wilton: Hey guys, Trying to use the database cookbook. Getting the following error when it tries to save a data bag item. It seems a client is not able to save to the data bag. The client has to be an admin to save to a dag bag?
[2012-04-20 16:19:42 -0400] wilton: _volid] (database::ebs_volume line 77) had an error: Net::HTTPServerException: 403 "Forbidden"
[2012-04-20 16:20:01 -0400] miah: yes
[2012-04-20 16:20:21 -0400] miah: which chef are you using? open source?
[2012-04-20 16:20:36 -0400] miah: if so, then there is no acl's in chef and only admin can change databags
[2012-04-20 16:21:19 -0400] miah: totaly unrelated.. but i am teaching my friend chef and we are going to add in mysql slave replication stuffs to the database cookbook (he's a wicked crazy mysql nerd)
[2012-04-20 16:21:42 -0400] miah: so many things to learn
[2012-04-20 16:21:50 -0400] miah: i dont have enough hours in the day though
[2012-04-20 16:22:26 -0400] geekbri: yeah we forked the mysql CB to add slave replication stuff.  We just haven't had a chance to clean it up yet and try to send it upstream
[2012-04-20 16:22:36 -0400] geekbri: So if you do it, we might very well go ahead and use yours instead :)
[2012-04-20 16:23:37 -0400] jtimberman: wilton: you have to change the node's API client to admin.
[2012-04-20 16:24:13 -0400] jtimberman: there may be a security concern there :)
[2012-04-20 16:24:22 -0400] jtimberman: in that you'd have a non-administrative API client with administrative access.
[2012-04-20 16:29:31 -0400] jperry: @btm - you there?
[2012-04-20 16:29:57 -0400] jperry: having issues with minitest-handler-cookbook 0.0.5 where I need to run chef-client twice in order for tests to report
[2012-04-20 16:30:09 -0400] jperry: I posted an issue on your github repo
[2012-04-20 16:33:25 -0400] jperry: anyone else run into this issue?
[2012-04-20 16:33:33 -0400] jperry: https://github.com/btm/minitest-handler-cookbook/issues/6
[2012-04-20 16:36:14 -0400] miah: geekbri: awesome
[2012-04-20 16:36:34 -0400] miah: we already have code to do the replication automated. but we have to move it into the database cookbook
[2012-04-20 16:50:15 -0400] hoover_damn: I know how I did it previously
[2012-04-20 16:50:29 -0400] hoover_damn: I was lucky... want to see what crazyness you guys get
[2012-04-20 16:50:39 -0400] hoover_damn: my postgresql cookbook I made I didn't bother with replication automation
[2012-04-20 16:50:55 -0400] hoover_damn: due to the suggestion you should be using at least 2 volumes if not more... and raiding isn't bad
[2012-04-20 16:51:01 -0400] hoover_damn: so you end up pg_dump / pg_restore :)
[2012-04-20 16:54:28 -0400] tolland: i have a few chef-client instances that are stopped
[2012-04-20 16:54:38 -0400] tolland: when i check the client.log there is just FATAL: SIGTERM received, stopping
[2012-04-20 16:54:46 -0400] miah: hoover_damn: we're specifically dealing with the mysql side of replication
[2012-04-20 16:55:18 -0400] hoover_damn: miah, snapshots or mysqldump/restore?
[2012-04-20 16:55:29 -0400] miah: xtradbbackup
[2012-04-20 16:55:37 -0400] miah: it has magic sauce
[2012-04-20 16:55:54 -0400] miah: http://www.percona.com/software/percona-xtrabackup/
[2012-04-20 16:56:41 -0400] hoover_damn: eh? what magic is this?
[2012-04-20 16:56:46 -0400] hoover_damn: I know xtrabackup works differently
[2012-04-20 16:57:02 -0400] miah: it includes all the details you need to spin up replicas easily
[2012-04-20 16:57:03 -0400] hoover_damn: is this the one that reads the innodb log files and data files directly and spins up a mysql server and then dumps it?
[2012-04-20 16:57:12 -0400] miah: no
[2012-04-20 16:57:18 -0400] hoover_damn: right so does mysqldump --master-data
[2012-04-20 16:57:42 -0400] hoover_damn: so it sounds like mysqldump :)
[2012-04-20 16:58:39 -0400] miah: Percona XtraBackup is a combination of the xtrabackup C program, and the innobackupex Perl script. The xtrabackup program copies and manipulates InnoDB and XtraDB data files, and the Perl script enables enhanced functionality, such as interacting with a running MySQL server and backing up MyISAM tables.
[2012-04-20 16:59:13 -0400] hoover_damn: sounds like the same thing
[2012-04-20 16:59:15 -0400] tolland: only downside, if you have a bunch of myisam tables the xtrabackup dumps are big
[2012-04-20 16:59:36 -0400] tolland: xtrabackup is good for quick consistent backups
[2012-04-20 16:59:40 -0400] miah: hoover_damn: except it works really well
[2012-04-20 16:59:41 -0400] hoover_damn: I tried innodb backup around 2008
[2012-04-20 16:59:44 -0400] tolland: mysqldump will lock your tables for 10 minuites
[2012-04-20 16:59:45 -0400] miah: tolland: yup
[2012-04-20 16:59:55 -0400] hoover_damn: it reads the innodb data files, and spins up a new mysql server
[2012-04-20 16:59:59 -0400] hoover_damn: and dumps the data in another location
[2012-04-20 17:00:05 -0400] hoover_damn: without performing a read lock
[2012-04-20 17:00:24 -0400] hoover_damn: they were charging 500$ per system for this piece of software
[2012-04-20 17:00:27 -0400] miah: i dont think it spins up a mysql server
[2012-04-20 17:00:31 -0400] hoover_damn: so to have someone reinvent that into a free option
[2012-04-20 17:00:36 -0400] hoover_damn: doesn't shock me
[2012-04-20 17:00:38 -0400] miah: at least xtrabackup doesnt
[2012-04-20 17:00:45 -0400] hoover_damn: you might not see it
[2012-04-20 17:00:48 -0400] hoover_damn: it might start one in perl
[2012-04-20 17:01:08 -0400] hoover_damn: if your reading and manipulating the db files... it seems likely that you want mysql server doing it
[2012-04-20 17:01:11 -0400] hoover_damn: not some random script
[2012-04-20 17:01:28 -0400] hoover_damn: if they did it this way in the past, it's likely they are doing it similar... if not the same
[2012-04-20 17:01:37 -0400] hoover_damn: they just made it less ugly :)
[2012-04-20 17:02:18 -0400] tolland: miah: it has to make the innodb consistent so they do this things called "preparing" the backup
[2012-04-20 17:02:18 -0400] miah: http://www.percona.com/doc/percona-xtrabackup/innobackupex/innobackupex_script.html
[2012-04-20 17:02:29 -0400] miah: ah
[2012-04-20 17:02:30 -0400] tolland: which is applying the log to the dump
[2012-04-20 17:02:49 -0400] tolland: that problably involves spinngin up a mysql process
[2012-04-20 17:03:29 -0400] hoover_damn: miah, yep looks like it spins up mysql
[2012-04-20 17:03:38 -0400] miah: http://www.percona.com/doc/percona-xtrabackup/innobackupex/how_innobackupex_works.html
[2012-04-20 17:03:41 -0400] tolland: percona is my number 1 favourite software of the month
[2012-04-20 17:03:54 -0400] hoover_damn: i'll stick to my postgresql
[2012-04-20 17:04:21 -0400] tolland: if mysql wasn't crap, then they wouldnt have to make cool tools to fix it
[2012-04-20 17:04:51 -0400] hoover_damn: i'm not sure if mysql is crap... it's just what I like
[2012-04-20 17:05:04 -0400] hoover_damn: vacuum might not make sense to some
[2012-04-20 17:05:05 -0400] hoover_damn: does to me
[2012-04-20 17:05:10 -0400] tolland: no, i used postgresql on a couple of projects. mysql is crap
[2012-04-20 17:05:40 -0400] miah: During the prepare operation, xtrabackup boots up a kind of modified InnoDB thats embedded inside it (the libraries it was linked against). The modifications are necessary to disable InnoDBs standard safety checks, such as complaining that the log file isnt the right size, which arent appropriate for working with backups. These modifications are only for the xtrabackup binary; you dont need a modified InnoDB to use xtrabackup for your b
[2012-04-20 17:05:50 -0400] hoover_damn: I actually spent the past few days writing a postgresql 9.1 cookbook that's optimized for hosting
[2012-04-20 17:06:18 -0400] hoover_damn: one of my clients wanted to have postgres... it'll eventulaly replace mongodb
[2012-04-20 17:06:36 -0400] c_t: someone should write a cookbook for mSQL
[2012-04-20 17:06:37 -0400] tolland: go and check and see what mysql does when it rolls over the top value of an auto_increment counter...
[2012-04-20 17:06:37 -0400] hoover_damn: I was pulling off of an m1.xlarge over 3500 TPS
[2012-04-20 17:06:40 -0400] miah: so it doesn't spin up a mysql server =)
[2012-04-20 17:06:52 -0400] c_t: hell, a whole set of cookbooks for chef -- 1998 edition would be awesome
[2012-04-20 17:06:56 -0400] hoover_damn: and that was only a benchmark really :) so i'll just have to see
[2012-04-20 17:07:05 -0400] miah: its a embedded db just for running crash recovery and what not
[2012-04-20 17:07:15 -0400] hoover_damn: I've gotten better results in pgbench then I did with basho_bench
[2012-04-20 17:07:22 -0400] hoover_damn: so :)
[2012-04-20 17:07:46 -0400] miah: mSQL? microsoft sql? i suppose as more windows users come into the chef world we'll see that stuff
[2012-04-20 17:08:02 -0400] miah: i think the ratio of unix:ms chef users is still pretty insane
[2012-04-20 17:08:05 -0400] c_t: miah: no, mSQL
[2012-04-20 17:08:12 -0400] miah: i dont know msql then
[2012-04-20 17:08:12 -0400] tolland: i said process, im pretty sure it does start a mysql process.
[2012-04-20 17:08:16 -0400] c_t: http://en.wikipedia.org/wiki/MSQL
[2012-04-20 17:08:31 -0400] c_t: holy shit, a new version of it came out last February
[2012-04-20 17:08:37 -0400] miah: oh
[2012-04-20 17:09:34 -0400] miah: interesting. i dont know database/sql history that well. my friend could talk your ear off about it though (he's one of those crazy nosql people)
[2012-04-20 17:13:45 -0400] hoover_damn: http://www.hughes.com.au/purchase/
[2012-04-20 17:13:52 -0400] hoover_damn: pickup your license today
[2012-04-20 17:13:53 -0400] hoover_damn: lol
[2012-04-20 17:14:10 -0400] hoover_damn: the fact that he sells .x and 3.x versions
[2012-04-20 17:14:11 -0400] hoover_damn: LOL
[2012-04-20 17:47:25 -0400] eugenmayer: after deleting a node in the gui
[2012-04-20 17:47:40 -0400] eugenmayer: it does not show up in knife node list
[2012-04-20 17:47:51 -0400] eugenmayer: but still i cannot reinstall / boostrap a new client with that name
[2012-04-20 17:51:11 -0400] jessicab: eugenmayer - did you try deleting the client too?
[2012-04-20 17:51:19 -0400] eugenmayer: jessicab: arg!
[2012-04-20 17:51:24 -0400] miah: client / node are two distinct items
[2012-04-20 17:51:33 -0400] eugenmayer: Sorry guys :/
[2012-04-20 17:51:39 -0400] miah: is ok =)
[2012-04-20 18:02:08 -0400] z: looks like some of the Relational Database as a Service stuff is using the Percona MySQL builds (http://www.percona.tv/percona-live/plmce-2012-keynote-the-new-mysql-cloud-ecosystem)
[2012-04-20 18:05:27 -0400] TheBeast: pwd
[2012-04-20 18:05:29 -0400] TheBeast: woops
[2012-04-20 18:23:25 -0400] timsmith: if you do a search and return a set of nodes into a variable, servers, can you say servers.fqdn.each do |x| ?
[2012-04-20 18:30:32 -0400] UForgotten: Urocyon: I figured out where the bullshit spaces came from too.  I had copied it from a skype window which had the extraneous nbsp chars.
[2012-04-20 18:35:16 -0400] mikeg: I have to lay down a file from a template and the resulting line in the file should look like this after the chef run:  <%= response.sendRedirect("/afm304/"): %>.   so you can see my issue.  The "304" part of that is the variable.  I tried using the ERB standard for escaping those characters so I had this in my template:  <%%= response.sendRedirect("/afm<%= @poolid %>/"); %>.  but that didn't work.  resulted in the following after the chef run:  <%= response
[2012-04-20 18:35:16 -0400] mikeg: .sendRedirect("/afm<%= @poolid %>/"); %>
[2012-04-20 18:35:52 -0400] mikeg: so does anyone know how to escape the <%= and %> in an erb so they aren't interpreted
[2012-04-20 18:36:57 -0400] holoway: mikeg: http://lmgtfy.com/?q=erb+escape
[2012-04-20 18:37:37 -0400] mikeg: holoway: as you can see from my message that's what I tried.  didn't work
[2012-04-20 18:38:37 -0400] holoway: mikeg: I think that's because the escaping is for the entire block
[2012-04-20 18:38:58 -0400] holoway: (ie: everything inside is treated as a literal, including the erb statement itself)
[2012-04-20 18:39:36 -0400] holoway: since erb is still parsing the top level erb escape
[2012-04-20 18:39:46 -0400] mikeg: so are you saying to try it like this in the template:  <%= response.sendRedirect("/afm<%%= @poolid %>/"); %>   instead of:  <%%= response.sendRedirect("/afm<%= @poolid %>/"); %>
[2012-04-20 18:40:38 -0400] ashb: something like: <% concat %q{<%= response.sendRedirect("/afm#{@poolid}/") %> }
[2012-04-20 18:40:39 -0400] holoway: nope, I think that'll not do what you want (since you'll try and call response.sendRedirect when chef renders the template
[2012-04-20 18:40:40 -0400] ashb: might work
[2012-04-20 18:40:45 -0400] holoway: right
[2012-04-20 18:41:07 -0400] holoway: what ashb said ^^ :)
[2012-04-20 18:41:09 -0400] mikeg: no.  not trying to call response.sendRedirect.  that's javascript that needs to end up in the file after the chef run
[2012-04-20 18:41:26 -0400] ashb: then why doyou want <%= in the output?
[2012-04-20 18:41:38 -0400] mikeg: so, after chef is done, the file on the filesystem should contain:    <%= response.sendRedirect("/afm304/"): %>
[2012-04-20 18:41:40 -0400] ashb: is: response.sendRedirect("/afm<%= @poolid %>/"); not all you are after?
[2012-04-20 18:42:10 -0400] mikeg: poolid is the variable I'm passing into the template to get it to render the string i put in my last message
[2012-04-20 18:42:34 -0400] ashb: just to be clear. you are using chef to output another ERB file?
[2012-04-20 18:42:47 -0400] mikeg: no.  chef to output a jsp file
[2012-04-20 18:42:53 -0400] mikeg: that contains that string
[2012-04-20 18:43:09 -0400] ashb: right then why are oyu having the the double <% etc?
[2012-04-20 18:43:15 -0400] ashb: response.sendRedirect("/afm<%= @poolid %>/");
[2012-04-20 18:43:19 -0400] ashb: job done. no?
[2012-04-20 18:43:33 -0400] mikeg: no.  need the <%= and %> to wrap those
[2012-04-20 18:43:36 -0400] mikeg: err, that
[2012-04-20 18:43:37 -0400] ashb: why?
[2012-04-20 18:43:47 -0400] ashb: can you pastie some of the template?
[2012-04-20 18:44:03 -0400] mikeg: that's the entire template.  it's a 1 line jsp file
[2012-04-20 18:44:22 -0400] mikeg: that redirects if people don't include the uri of /afm304/
[2012-04-20 18:44:57 -0400] ashb: then the entire contents of your template in chef is: response.sendRedirect("/afm<%= @poolid %>/");
[2012-04-20 18:45:41 -0400] mikeg: but I need the line in the file, after the chef run, to look like this:    <%= response.sendRedirect("/afm304/"): %>
[2012-04-20 18:46:00 -0400] ashb: jsp tags are also <%= %> ?
[2012-04-20 18:46:24 -0400] mikeg: I guess.  I'm not a javascript guy
[2012-04-20 18:46:45 -0400] ashb: JSP isn't javascript
[2012-04-20 18:47:03 -0400] mikeg: It's not my call.  I work for a big company. devs want that file there, that's what I automate
[2012-04-20 18:47:04 -0400] ashb: but yes it looks like <% opens jsp
[2012-04-20 18:48:04 -0400] mikeg: I suppose I could set the variable within the recipe to be that entire string and then pass that in.  then have my template just look like <%= @string %>.  let me try that
[2012-04-20 18:48:32 -0400] ashb: mikeg: that's a bit of a hack, and if you'r doing that I'd suggest using the file resource with the 'content' attr
[2012-04-20 18:48:57 -0400] mikeg: oh.  hey.  I read about that and wanted to try it.  thx.  I'll try that instead
[2012-04-20 18:49:29 -0400] ashb: its probably the easiest for a small snippet like this
[2012-04-20 18:49:30 -0400] yfeldblum: https://github.com/ruby/ruby/blob/trunk/lib/erb.rb#L47
[2012-04-20 18:50:40 -0400] cap10morgan: Is there a cookbook out there for installing Ruby 1.9.3 from source that folks like?
[2012-04-20 18:50:40 -0400] ashb: yfeldblum: he tried that. it seems to treat everything in <%%= as a literal
[2012-04-20 18:50:41 -0400] yfeldblum: also why is that script not part of the application as the devs ship it?
[2012-04-20 18:51:23 -0400] yfeldblum: there's always: <%="<%="%>response.sendRedirect...
[2012-04-20 18:52:06 -0400] yfeldblum: but this sounds like the wrong person automating this ... shouldn't the devs should automate building this template in a build step that they ship with the app?
[2012-04-20 18:52:13 -0400] mikeg: becuase we have 10 pools of this app in prod.  6 in qa.  need to be able to parameterize the "304" part which is a pool id.  all pools contain the same code except for pool specific tweaks
[2012-04-20 18:52:40 -0400] mikeg: our devs don't do chef work. most probably don't know ruby.  sysadmins do all our automation
[2012-04-20 18:53:20 -0400] mikeg: just separation of duties.  are most chef guys sysadmins/devops guys?  that what I figured
[2012-04-20 18:54:06 -0400] jtimberman: mikeg: we've worked with people who have a wide variety of backgrounds.
[2012-04-20 18:54:07 -0400] ashb: couldn't say. The most visible members seems to be devops though
[2012-04-20 18:54:55 -0400] yfeldblum: why not require the devs to ship a Makefile which [invokes a build script that] looks for an environment variable with the "304" value and writes out the expected file?
[2012-04-20 18:55:13 -0400] jtimberman: mikeg: for example, one company we worked with had an operations team that did most of the chef-related coding, then i trained their developers in chef, and they started writing their deploy cookboooks instead of the ops guys
[2012-04-20 18:55:20 -0400] mikeg: in this company our devs strictly work on their code.  we develop about 200 custom apps internally and there are probably 50 dev teams.  don't want all of them touching deployment automation.  we set standards so they'll fit in automation and they follow
[2012-04-20 18:55:23 -0400] ashb: Makefile doesn't seem like a very java-y approach :)
[2012-04-20 18:55:58 -0400] mikeg: jtimberman: well, that would certainly take a lot off the automation teams plate here.  wouldn't be good for my job security though :)
[2012-04-20 18:56:16 -0400] yfeldblum: ashb, or parameterize the build-step command, so for one app it can be "make build", and for another it can be "some-java-command"
[2012-04-20 18:56:19 -0400] z: IME a "sling it over the wall" (we don't touch automation) is kinda clunky even when you have standards
[2012-04-20 18:57:17 -0400] yfeldblum: this sounds like such highly application-specific, custom work that it really belongs in the application itself
[2012-04-20 18:57:34 -0400] yfeldblum: either as a static file or as a template/generator that a build step uses to generate the file
[2012-04-20 18:57:49 -0400] mikeg: I supposed.  but it works great.  they stick to what they do best, creating wars and web pages.  we stick to what we do best, deploying code to apps.  but we automated all of CI.  so they check in code and it's running on new servers in the cloud in their dev environment 20 mins later.  has improved productivity greatly
[2012-04-20 18:58:42 -0400] mikeg: oh.  and htis particular app is a 1-off custom job.  98% is standardized JVM deployments (tomcat, jboss, resin, etc.)
[2012-04-20 18:58:56 -0400] jdeamattson: jtimberman: Just submitted some minor changes to the erlang and rabbitmq cookbooks.
[2012-04-20 18:59:27 -0400] jtimberman: jdeamattson: do they have COOK tickets in resolve state?
[2012-04-20 19:00:09 -0400] jdeamattson: Yep. Followed the process: http://tickets.opscode.com/browse/COOK-1215, http://tickets.opscode.com/browse/COOK-1216, and http://tickets.opscode.com/browse/COOK-1217.
[2012-04-20 19:00:18 -0400] yfeldblum: mikeg, just don't let it snowball into 50% of applications need custom deployment steps and need the ops crew to build the steps ...
[2012-04-20 19:00:34 -0400] jdeamattson: jtimberman: They are still assigned to me. Should they be assigned to someone else?
[2012-04-20 19:00:39 -0400] jtimberman: jdeamattson: cool
[2012-04-20 19:00:41 -0400] jtimberman: jdeamattson: no thats fine
[2012-04-20 19:00:45 -0400] jdeamattson: jtimberman: That is not specified in the process.
[2012-04-20 19:00:52 -0400] jtimberman: yeah its not required
[2012-04-20 19:01:07 -0400] mikeg: yfeldblum: for sure
[2012-04-20 19:01:34 -0400] jdeamattson: jtimberman: In part these are tied to my ongoing process of building out Amazon Linux support :-)
[2012-04-20 19:02:26 -0400] jdeamattson: jtimberman: But I also added the ability to specify the version of RabbitMQ to be installed when you are on "redhat", "centos", "amazon", etc.
[2012-04-20 19:08:22 -0400] jdeamattson: jtimberman: Is there an example of the use of the attribute [:rabbitmq][:cluster_disk_nodes] when clustering?
[2012-04-20 19:08:42 -0400] jtimberman: jdeamattson: if its not in the readme then i don't know offhand
[2012-04-20 19:12:08 -0400] geekbri: How long does it take between signing the contributor agreement and your jira account getting the proper privileges to resolve a ticket?
[2012-04-20 19:12:19 -0400] jdeamattson: jtimberman: Thanks. Please give me any feedback on improving the submissions I made; this is my first time contributing...
[2012-04-20 19:12:28 -0400] jdeamattson: geekbri: It was about 23 hours for me.
[2012-04-20 19:14:30 -0400] geekbri: Ok thanks.
[2012-04-20 19:38:27 -0400] yfeldblum: jdeamattson, i need more decimal places; "23 hours" is too vague
[2012-04-20 19:38:57 -0400] jdeamattson: yfeldblum: 23hours 10 minutes 5seconds
[2012-04-20 19:39:06 -0400] yfeldblum: jdeamattson, thanks
[2012-04-20 19:39:45 -0400] jdeamattson: yfeldblum: You are welcome. Reminds me of an instructor who once said, "This movie is approximately 23 minutes and 12 seconds in length"....
[2012-04-20 19:47:00 -0400] sivy: gday folks
[2012-04-20 19:48:18 -0400] sivy: i'm installing nagios from the nagios::server_source recipe, and it doesn't seem to be updating the templates after modifying a template in the cookbook and re-uploading to hosted chef
[2012-04-20 19:51:19 -0400] KarlHungus: anyone have a good zfs cookbook?
[2012-04-20 19:51:31 -0400] cwj: jdeamattson: pretty sure node[:rabbitmq][:cluster_disk_nodes] is expected to be an array like [ "rabbit@somehostname", "rabbit@someotherhostname" ]
[2012-04-20 19:52:12 -0400] cwj: i need to submit a pull request for that cookbook, i patched it to use search for finding other members of a cluster
[2012-04-20 19:52:30 -0400] jdeamattson: cwj: That is what I thought, but it is always great to see an example of it being used. That is one of the big missing pieces in chef documenation.
[2012-04-20 19:52:45 -0400] jdeamattson: cwj: That would be a change I would greatly appreciate. Would be a big help to me.
[2012-04-20 19:53:24 -0400] jdeamattson: cwj: We need more examples of cookbooks being used, to see how to use them ourselves.
[2012-04-20 19:53:26 -0400] cwj: jdeamattson: wanna test it? https://github.com/needle/chef-opscode-rabbitmq/tree/COOK-1163
[2012-04-20 19:54:01 -0400] cwj: i havent updated the read me in my branch, let me work on that
[2012-04-20 19:54:20 -0400] jdeamattson: cwj: Yes, I would be willing to take that an merge it into my instance.
[2012-04-20 19:54:50 -0400] jdeamattson: I am working to bring up an active-active mirrored cluster, so if I might bend your ear on things, that would be great.
[2012-04-20 19:54:59 -0400] cwj: yeah let me know
[2012-04-20 19:55:30 -0400] cwj: i feel like i had to manually jiggle the handle on the cluster i configured, even though the conf file was being generated
[2012-04-20 19:56:32 -0400] cwj: the current version of the cookbook wants you to set node[:rabbitmq][:cluster] = true or false, my branch will take a string value for that attribute and use that as the cluster name when searching out other members
[2012-04-20 19:58:57 -0400] jperry: anyone have to run minitest-handler-cookbook twice in order for tests to run?
[2012-04-20 19:59:20 -0400] jdeamattson: cwj: I will take a look at some of your other projects. I have been working in these areas as well.
[2012-04-20 19:59:47 -0400] cwj: jdeamattson: cool man, go nuts
[2012-04-20 20:00:25 -0400] miketheman: anyone using the apache2 cookbook?
[2012-04-20 20:00:52 -0400] miketheman: have you ever had cause to change the mpm from prefork to worker? how did you do it?
[2012-04-20 20:02:58 -0400] sivy: anyone know why a cookbook won't regenerate a file (from a template) that's been removed?
[2012-04-20 20:03:17 -0400] cwj: miketheman: i haven't messed with that myself, but from what i can tell it looks like you would use the apache_module definition to ensure that prefork module is disabled and worker module is enabled
[2012-04-20 20:03:18 -0400] sivy: i removed a conf file expecting the next chef run to rebuild it
[2012-04-20 20:03:22 -0400] sivy: but it won't
[2012-04-20 20:03:42 -0400] cwj: because the apache2.conf template includes configurations for both, which can be tuned via node attributes
[2012-04-20 20:04:44 -0400] miketheman: cwj: on centos, this is controlled by a setting in /etc/sysconfig/httpd
[2012-04-20 20:05:11 -0400] miketheman: cwj: diff. binaries are provided with the support compiled in.
[2012-04-20 20:05:43 -0400] |shad0w|: sivy, what does the template resource look like?
[2012-04-20 20:05:54 -0400] sivy: |shad0w|: hm, let's see
[2012-04-20 20:06:54 -0400] cwj: miketheman: i could be wrong but i dont think the cookbook is set up to handle that
[2012-04-20 20:07:06 -0400] sivy: |shad0w|: https://gist.github.com/ac10ec3aa0ed4598a942
[2012-04-20 20:07:58 -0400] |shad0w|: sivy, no conditionals around that block either?
[2012-04-20 20:08:03 -0400] sivy: nope
[2012-04-20 20:08:24 -0400] |shad0w|: and the file doesn't currently exist?
[2012-04-20 20:08:34 -0400] sivy: |shad0w|: no, i removed it thinking it would be recreated
[2012-04-20 20:08:45 -0400] |shad0w|: what does the run look like?
[2012-04-20 20:08:56 -0400] sivy: but instead the run exploeds b/c it's trying to run the script
[2012-04-20 20:09:02 -0400] |shad0w|: ahh
[2012-04-20 20:09:15 -0400] |shad0w|: you need your template further up in the run list probably
[2012-04-20 20:09:22 -0400] jdeamattson: Is there an easy way to get the list of environments defined?
[2012-04-20 20:09:29 -0400] sivy: |shad0w|: i'll check
[2012-04-20 20:09:30 -0400] |shad0w|: knife environment list
[2012-04-20 20:09:34 -0400] sivy: thx
[2012-04-20 20:09:48 -0400] jdeamattson: In recipe?
[2012-04-20 20:10:02 -0400] |shad0w|: sivy, is the service resource for it above the template?
[2012-04-20 20:10:17 -0400] |shad0w|: or anything that calls the service with a notify?
[2012-04-20 20:10:44 -0400] jdeamattson: |shad0w|: I want to get the list of environments in a recipe and then use it to take an action (specifically, create a RabbitMQ ghost for each and every environment I have).
[2012-04-20 20:10:58 -0400] |shad0w|: search should return them
[2012-04-20 20:11:05 -0400] jdeamattson: s/vhost/ghost/
[2012-04-20 20:11:37 -0400] sivy: |shad0w|: oh, i see: the template only gets created in the _source version of the recipe, and i'm using the package version
[2012-04-20 20:11:40 -0400] |shad0w|: search(:environments, "*:*") or some such
[2012-04-20 20:12:02 -0400] sivy: so it's not running the package again since the package is installed
[2012-04-20 20:12:13 -0400] sivy: need to switch to the _source recipe
[2012-04-20 20:15:03 -0400] jdeamattson: Ok, here it is: Chef::Environment.list
[2012-04-20 20:15:21 -0400] jdeamattson: |shad0w|: THanks for the idea to go and see how knife was doing it.
[2012-04-20 20:17:25 -0400] |shad0w|: https://gist.github.com/2431530
[2012-04-20 20:17:30 -0400] |shad0w|: for you jdeamattson
[2012-04-20 20:17:51 -0400] jdeamattson: |shad0w|: Thanks
[2012-04-20 20:17:54 -0400] |shad0w|: or set it to a var and iterate as needed throughout your recipe
[2012-04-20 20:17:56 -0400] |shad0w|: np
[2012-04-20 20:18:18 -0400] jdeamattson: Yes.
[2012-04-20 20:18:36 -0400] jdeamattson: Also looks like you can get it directly from Chef::Environment.
[2012-04-20 20:19:08 -0400] |shad0w|: that would be the nodes env though
[2012-04-20 20:19:11 -0400] |shad0w|: I think
[2012-04-20 20:20:39 -0400] jdeamattson: I looked at how knife gets its list of environments and it calls, Chef::Environment.list
[2012-04-20 20:21:47 -0400] sivy: |shad0w|: still not working. :/ i'm using the nagios community cookbook, and I can't figure out how to get it to regenerate this damn file
[2012-04-20 20:22:12 -0400] |shad0w|: well, if it came from the package force a reinstall of the package
[2012-04-20 20:22:19 -0400] sivy: |shad0w|: https://github.com/opscode/cookbooks/tree/master/nagios
[2012-04-20 20:22:26 -0400] |shad0w|: if you want to template it out, make a new recipe outside of the nagios ckbook to do it
[2012-04-20 20:22:41 -0400] sivy: i've switched to the source install of both server and client
[2012-04-20 20:23:18 -0400] sivy: it's templated in the client_source recipe, triggered by [nagios][client][install_method] in the node
[2012-04-20 20:24:53 -0400] sivy: ugh
[2012-04-20 20:24:55 -0400] sivy: override, not default
[2012-04-20 20:32:54 -0400] hoover_damn: lol
[2012-04-20 20:34:50 -0400] sivy: what does a bash resource look for to determine if it should run or not?
[2012-04-20 20:35:10 -0400] sivy: (it has a "creates" attribute)
[2012-04-20 20:36:12 -0400] sivy: oh, not idempotent
[2012-04-20 20:39:12 -0400] yfeldblum: sivy, either the content of the bash resource should be idempotent, or you should guard the resource with a set of only_if/not_if guards
[2012-04-20 20:42:04 -0400] knuckolls: to work around the problem i had the other day with ohai 0.6.12 i was hoping to put a step in my chef run to just uninstall ohai 0.6.12 and install 0.6.10 but the next time the daemon runs chef-client i get an exception when ohai is supposed to run
[2012-04-20 20:42:26 -0400] knuckolls: is there any way to have the chef-client daemon reload it's dependencies?
[2012-04-20 20:43:54 -0400] cap10morgan: anyone else seeing this issue: http://tickets.opscode.com/browse/CHEF-3046 ?
[2012-04-20 20:45:42 -0400] sivy: yfeldblum: it's not important - i actually want it to run
[2012-04-20 20:46:21 -0400] dbgster: Hi, so with the rvm cookbook, I want to set my server to 1.9.3, will it set the base ruby to 1.9.3 or I have to be in a specific vm to get that?  I want it to any and all usages will be ruby 1.9.3 by default.
[2012-04-20 20:46:45 -0400] |shad0w|: sivy, make it idempotent with only_if or not_if
[2012-04-20 20:53:23 -0400] tarrant: Does calling chef-client from the command line call a different ohai then calling ohai from the command line?
[2012-04-20 20:53:48 -0400] tarrant: If I call ohai directly everthing works but if I call chef-client with the ohai recipe I hit http://tickets.opscode.com/browse/OHAI-196
[2012-04-20 21:04:39 -0400] |shad0w|: jdeamattson, it looks like Chef::Environment returns the name and url for each env
[2012-04-20 21:04:48 -0400] |shad0w|: probably still better off doing search in your recipe though
[2012-04-20 21:05:07 -0400] cwj: is there a ruby 1.8.7 compatible way to diff two hashes?
[2012-04-20 21:05:15 -0400] jdeamattson: Yes, Discovered that |shad0w|
[2012-04-20 21:05:18 -0400] |shad0w|: https://gist.github.com/2431530
[2012-04-20 21:05:36 -0400] jdeamattson: Ended up going with your gist |shad0w| Thanks for the help.
[2012-04-20 21:06:01 -0400] jdeamattson: And it is working, I am able to create a RabbitMQ vhost for each environment I have.
[2012-04-20 21:08:16 -0400] bemu: cwj: http://stackoverflow.com/questions/1766741/comparing-ruby-hashes/1766796#1766796 http://stackoverflow.com/questions/4928789/how-do-i-compare-two-hashes
[2012-04-20 21:09:08 -0400] cwj: bemu: thanks, i was just looking at that one
[2012-04-20 21:09:16 -0400] cwj: wasn't sure if that was the cleanest way
[2012-04-20 21:09:27 -0400] bemu: I'm not sure off the top of my head.
[2012-04-20 21:14:03 -0400] |shad0w|: hash == other_hash doesn't work?
[2012-04-20 21:14:30 -0400] |shad0w|: docs for 1.8.7 and 1.9.3 seem to be the same for this method. http://www.ruby-doc.org/core-1.8.7/Hash.html http://www.ruby-doc.org/core-1.9.3/Hash.html
[2012-04-20 21:14:57 -0400] |shad0w|: doh, you said diff
[2012-04-20 21:19:16 -0400] hoover_damn: cwj, https://gist.github.com/146844
[2012-04-20 21:26:01 -0400] cwj: thanks fellas
[2012-04-20 21:26:32 -0400] cwj: next question: anyone on hosted chef seeing node save at the end of a run fail?
[2012-04-20 21:28:18 -0400] cwj: https://gist.github.com/2432006
[2012-04-20 21:29:37 -0400] cwj: getting a 400 at node.save
[2012-04-20 21:31:10 -0400] cwj: but i havent had any problems editing nodes via knife
[2012-04-20 22:33:16 -0400] hoover_damn: cwj, there maybe a line or two higher that should show more
[2012-04-20 22:37:13 -0400] cwj: pages and pages of deep_merge.rb check_for_circular_references
[2012-04-20 22:38:20 -0400] cwj: the event immediately preceeding the save request is sending restart to a service
[2012-04-20 22:38:31 -0400] cwj: [Fri, 20 Apr 2012 21:21:39 +0000] INFO: service[celeryd] restarted
[2012-04-20 22:48:29 -0400] hoover_damn: hrm
[2012-04-20 22:48:40 -0400] hoover_damn: yeah with what I saw I couldn't say
[2012-04-20 23:11:23 -0400] heph: hey, is it possible to reference an arbitrary string from all cookbooks for inclusion by a template in another cookbook?
[2012-04-20 23:11:53 -0400] heph: i'm trying to set things up such that each recipe defines its own nagios checkcommand, then a nagios cookbook reads them all and defines service checks appropriately
[2012-04-20 23:15:03 -0400] miah: yes
[2012-04-20 23:15:08 -0400] heph: or, is it possible to define a resource from one node which is applied to a different node? the other way of doing this would be to have each recipe define a nagios_service resource, and then the nagios cookbook would then dump every nagios_service into a services.cfg
[2012-04-20 23:15:14 -0400] miah: you should make that arbitrary string an atribute
[2012-04-20 23:15:24 -0400] miah: and then you can reference that attribute from other cookbooks on that node
[2012-04-20 23:15:38 -0400] hoover_damn: attributes are loaded before cookbooks are processed
[2012-04-20 23:15:48 -0400] hoover_damn: so there is no reason why your cookbook cannot reference attributes set by other cookbooks
[2012-04-20 23:16:03 -0400] miah: also, there is a databag tie in to the nagios cookbook so you can build your services.cfg dynamically based on that
[2012-04-20 23:16:04 -0400] hoover_damn: variables( :foobar => node[:apache2][:listen_ports] )
[2012-04-20 23:16:06 -0400] hoover_damn: in nginx
[2012-04-20 23:16:35 -0400] heph: ah, that'd work
[2012-04-20 23:16:51 -0400] miah: attributes?
[2012-04-20 23:16:52 -0400] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-04-20 23:16:56 -0400] miah: read up =)
[2012-04-20 23:17:05 -0400] miah: its pretty helpful/powerful
[2012-04-20 23:17:06 -0400] heph: miah: i have been
[2012-04-20 23:17:19 -0400] miah: heph: are you going to join us at chefconf?
[2012-04-20 23:17:34 -0400] heph: i guess i'm getting a little hung up on the node vs role searching
[2012-04-20 23:17:58 -0400] heph: miah: depends on if new $dayjob pays for it. guess i should ask =]
[2012-04-20 23:18:05 -0400] miah: you should
[2012-04-20 23:18:22 -0400] miah: also. you should come over for bbq tomorrow. and bring my dremel tool :P
[2012-04-20 23:18:57 -0400] heph: you already have your damn dremel
[2012-04-20 23:19:01 -0400] heph: =P
[2012-04-20 23:19:04 -0400] heph: oh, wait, no you don't
[2012-04-20 23:19:17 -0400] miah: heph: also. a node can belong to multiple roles.
[2012-04-20 23:20:11 -0400] hoover_damn: that usually confuses people
[2012-04-20 23:20:23 -0400] hoover_damn: and then it delights them
[2012-04-20 23:20:26 -0400] heph: exactly, which is why i'd rather this be defined by chef's list of registered cookbooks
[2012-04-20 23:20:44 -0400] hoover_damn: it's only confusing at first glance
[2012-04-20 23:20:46 -0400] heph: so that each cookbook defines a set of nagios services
[2012-04-20 23:20:55 -0400] miah: eg, i have a 'base' role that i apply to all nodes. and then i have more role specific roles, eg 'lb' or 'memcached'
[2012-04-20 23:23:19 -0400] heph: is there an easy way to dump the data structures of these resources at the command line? knife search is returning things too far different than search()
[2012-04-20 23:23:20 -0400] miah: heph: if you want, i can also give you like a hour 'walkthrough' of my chef environment
[2012-04-20 23:24:17 -0400] tarrant: heph: knife search -Fj
[2012-04-20 23:24:22 -0400] tarrant: ?
[2012-04-20 23:25:24 -0400] miah: search returns a hash (or maybe mash)
[2012-04-20 23:25:31 -0400] miah: while knife returns json
[2012-04-20 23:25:38 -0400] miah: which could be confusing i supposes
[2012-04-20 23:26:04 -0400] heph: tarrant: thanks, that helps =]
[2012-04-20 23:26:22 -0400] miah: i use attributes extensively: https://github.com/CXInc/chef-redis/blob/master/recipes/_server_config.rb
[2012-04-20 23:27:06 -0400] miah: maybe that helps?
[2012-04-20 23:53:43 -0400] mhalligan: I'm having a dumb moment. what attribute shows the current node's role?
[2012-04-20 23:53:48 -0400] mhalligan: or do I need to search chef to get thaT?
[2012-04-20 23:55:49 -0400] mhalligan:  I guess I can pass it an attribute from the role
[2012-04-20 23:58:41 -0400] hoover_damn: node.roles?
