[2012-04-27 00:12:39 -0400] andoriyu: how can i ermove chef-client from machine?
[2012-04-27 00:13:02 -0400] hoover_damn: gem uninstall chef
[2012-04-27 00:32:18 -0400] hippiehacker: laurent\: I'll try and clean it up 8)
[2012-04-27 00:45:26 -0400] andoriyu: it's ok to install chef-client on the same machine as chef-server? or it might break something?
[2012-04-27 00:47:18 -0400] josephholsten: andoriyu: it's normal to do that. check the chef-server and chef-client cookbooks
[2012-04-27 00:48:24 -0400] andoriyu: i did not get how to use cookbooks from community city. I mean i downloaded, but what next?
[2012-04-27 00:49:31 -0400] hippiehacker: laurent\: https://github.com/opscode/ohai/pull/77 has just the changes we want
[2012-04-27 00:55:02 -0400] josephholsten: anyone running the chef-server on two servers at the same time?
[2012-04-27 01:20:38 -0400] echiu: while creating ec2 instance with knife, getting ERROR: You did not provided a valid 'AWS SSH Key Id' value.
[2012-04-27 01:21:00 -0400] echiu: where is this value set, and where do I find it in AWS?
[2012-04-27 01:23:47 -0400] echiu: knife ec2 server create -r "role[webserver]" -I ami-2d4aa444 --flavor t1.micro -G www,default -x ubuntu -N server01
[2012-04-27 01:25:46 -0400] major_majors: echiu: pass the -S option to that command after generating or importing an SSH key
[2012-04-27 01:26:11 -0400] major_majors: i should say, the -S option along with the name of the key
[2012-04-27 01:26:34 -0400] echiu: any ssh key would do? or do I need to use AWS console?
[2012-04-27 01:27:05 -0400] major_majors: echiu: you can either use the AWS console to generate a new keypair or import an existing public key
[2012-04-27 01:27:08 -0400] echiu: I can't find it in the AWS docs
[2012-04-27 01:27:29 -0400] echiu: I see, same as keypair
[2012-04-27 01:27:49 -0400] major_majors: yeah
[2012-04-27 01:42:27 -0400] echiu: knife ec2 server create -r "role[webserver]" -I ami-e565ba8c --flavor t1.micro -G default -x linux -N server01 -S pk-APKAJAHWO3TTIKBQCNHQ.pem
[2012-04-27 01:42:28 -0400] echiu: ERROR: Fog::Service::NotFound: The key pair 'pk-APKAJAHWO3TTIKBQCNHQ.pem' does not exist
[2012-04-27 01:43:18 -0400] echiu: any idea why it's not finding .pem in the path? I tried both relative/absolute path.
[2012-04-27 01:53:26 -0400] major_majors: echiu: so, what you pass to -S should be the name you gave the key in the AWS console, pass the path to the private key to the -i option
[2012-04-27 02:01:25 -0400] echiu: @major_majors: that seems to work, thanks for your help!
[2012-04-27 02:02:10 -0400] echiu: those parameters you suggested was missing from the opsware docs http://wiki.opscode.com/display/chef/Launch+Cloud+Instances+with+Knife
[2012-04-27 02:06:09 -0400] andoriyu: [Fri, 27 Apr 2012 05:51:00 +0400] WARN: Failed to read the private key /etc/chef/validation.pem: #<Errno::ENOENT: No such file or directory - /etc/chef/validation.pem>
[2012-04-27 02:06:23 -0400] andoriyu: /etc/chef/validation.pem: regular file
[2012-04-27 02:07:37 -0400] andoriyu: permitions...
[2012-04-27 02:26:23 -0400] yfeldblum: josephholsten, what do you mean by "on two servers"?
[2012-04-27 02:27:41 -0400] josephholsten: yfeldblum: I'm wanting to move off an old machine. wondering what bits of state they need to share, &c
[2012-04-27 02:28:32 -0400] yfeldblum: josephholsten, why not do it all at once? rather than having it running on both the old and new machines at the same time?
[2012-04-27 02:29:08 -0400] josephholsten: I don't like downtime?
[2012-04-27 02:29:29 -0400] josephholsten: I also like practicing failover procedures
[2012-04-27 02:29:51 -0400] yfeldblum: josephholsten, but chef-clients are tolerant of chef-server downtime
[2012-04-27 02:30:09 -0400] josephholsten: yes
[2012-04-27 02:30:54 -0400] josephholsten: I'm not deeply attached to the idea. I'm just wondering if it's a well documented process, &c
[2012-04-27 02:31:03 -0400] josephholsten: (outside private chef)
[2012-04-27 02:31:31 -0400] yfeldblum: josephholsten, not really - there are a lot of moving parts and there's not much documentation about the parts
[2012-04-27 02:32:27 -0400] yfeldblum: josephholsten, i expect you'll need to backup & restore the couchdb database, maybe the checksum directory (unless that's been changed), and after you set up all the components and restore the database, trigger a reindex
[2012-04-27 02:33:17 -0400] josephholsten: are all the public keys and cookbook assets stored in couch?
[2012-04-27 02:40:27 -0400] echiu: what's a typical bootstrap time for EC2?
[2012-04-27 02:41:21 -0400] major_majors: echiu: it depends on what all you're bootstrapping onto it. most of the time, my instances don't take more than 5-10 minutes. is it getting stuck somewhere?
[2012-04-27 02:42:26 -0400] andoriyu: wierd, i put chef-api and webui behind nginx. knife client list works fine, uploading cookbooks doesn't
[2012-04-27 02:42:36 -0400] echiu: the EC2 instance is up, I see it on AWS console, but it's "waiting for sshd" for last 40min
[2012-04-27 02:42:58 -0400] echiu: no errors
[2012-04-27 02:44:00 -0400] hoover_damn: likely you have not authorized yourself in the security group
[2012-04-27 02:44:09 -0400] hoover_damn: so you cannot communicate with the instance on port 22
[2012-04-27 02:44:45 -0400] echiu: thanks for reminding me, I should do ssh-add
[2012-04-27 02:47:43 -0400] major_majors: yeah, i think the default security group does not allow port 22
[2012-04-27 02:49:24 -0400] jhowarth: How are you supposed to escape :: in searches when using Chef::Search::Query.new.search
[2012-04-27 02:50:02 -0400] hoover_damn: nope and you shouldn't open it to the world
[2012-04-27 02:50:14 -0400] hoover_damn: as there's enough script kiddies out there trying to ssh scan you and hack in anyway they can
[2012-04-27 02:50:22 -0400] hoover_damn: that you shouldn't make yourself a more enticing target
[2012-04-27 03:00:11 -0400] andoriyu: okay, I found a problem  knife repository isn't configured. How to fix that?
[2012-04-27 03:01:08 -0400] andoriyu: knife for some reason trying to upload cookbooks to a wrong site.
[2012-04-27 03:13:00 -0400] yfeldblum: josephholsten, i believe pubkeys are stored in couch, as string values in client documents
[2012-04-27 03:16:50 -0400] cobragoat: chef-solo keeps failing to find my config file even when I directly specify it.. common mistake?
[2012-04-27 03:18:15 -0400] yfeldblum: josephholsten, hmm it appears you still have to backup the checksums dir as well & restore it
[2012-04-27 03:25:08 -0400] flaccid: python/pip cookbookon ubuntu 12.04 not good
[2012-04-27 03:25:08 -0400] flaccid: root@ip-10-160-22-120:~# pip freeze | grep -i virtualenv==
[2012-04-27 03:25:09 -0400] flaccid: Warning: cannot find svn location for distribute==0.6.24dev-r0
[2012-04-27 04:07:33 -0400] hoover_damn: svn? huh?
[2012-04-27 05:56:36 -0400] BryanWB: yo chefs!
[2012-04-27 05:59:46 -0400] c_t: yo dawg
[2012-04-27 06:27:43 -0400] BryanWB: how can i  include a ruby module in a recipe?
[2012-04-27 06:30:37 -0400] BryanWB: include 'Chef::Application::foo' fails
[2012-04-27 06:30:51 -0400] BryanWB: even though Chef::Application::foo is a valid ruby module
[2012-04-27 06:31:35 -0400] erikh: no quotes
[2012-04-27 06:31:45 -0400] erikh: include Chef::Application::foo
[2012-04-27 06:31:47 -0400] BryanWB: erikh: sorry, it fails w/out quotes
[2012-04-27 06:31:51 -0400] erikh: hrm
[2012-04-27 06:31:54 -0400] erikh: did you require the right files?
[2012-04-27 06:31:57 -0400] erikh: is it a module?
[2012-04-27 06:32:10 -0400] BryanWB: yeah, anyways gtg
[2012-04-27 06:43:28 -0400] jtimberman: you need
[2012-04-27 06:43:29 -0400] jtimberman: magic
[2012-04-27 06:44:07 -0400] jtimberman: ::Chef::Recipe.send(:include, Chef::Application::Foo)
[2012-04-27 06:44:19 -0400] jtimberman: though i'd probably namespace it elsewhere than Chef::Application
[2012-04-27 06:46:24 -0400] BryanWB: jtimberman: tks
[2012-04-27 07:07:26 -0400] miah: herp
[2012-04-27 07:24:01 -0400] miah: i has a tired
[2012-04-27 07:56:55 -0400] Yogesh: Need help urgent
[2012-04-27 07:56:58 -0400] Yogesh:             kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: *** Chef 0.10.2 *** kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Run List is [recipe[nagios::server]] kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Run List expands to [nagios::server] kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Starting Chef Run for kkhostim
[2012-04-27 07:57:49 -0400] Guest10557: kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Run List is [recipe[nagios::server]] kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Run List expands to [nagios::server] kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: Starting Chef Run for kkhostimport1.syslab.adam.qa.hp.com kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: 
[2012-04-27 07:58:33 -0400] Guest10557: INFO: Missing gem 'mysql' kkhostimport1.syslab.adam.qa.hp.com [Fri, 27 Apr 2012 01:53:22 -0600] INFO: HTTP Request Returned 404 Not Found: I don't know how to search for users data objects
[2012-04-27 07:59:30 -0400] Guest10557: I see this error often not able to proceed with chef Nagios cookbook installation
[2012-04-27 08:17:38 -0400] zts: Guest10557: please paste to a pastebin and share the link here, rather than pasting into the channel
[2012-04-27 08:17:55 -0400] zts: Guest10557: but that error suggests that you don't have a databag called "users", which the recipe is trying to search
[2012-04-27 09:04:39 -0400] Kwanasolis: \o
[2012-04-27 09:49:45 -0400] miah: im still technically awake
[2012-04-27 09:55:27 -0400] zykes-_: Hi, someone here that can update the packaging for Ubuntu Precise ?
[2012-04-27 09:58:50 -0400] zykes-_: the current packaging requires libreadline5-dev which basically breaks the whole thing
[2012-04-27 10:18:14 -0400] laurent\: what do you use to connect to your windows host ? ssh ? (using cygwin or the non-free ssh implementation ?) or is there a winrm client for linux ?
[2012-04-27 10:18:39 -0400] laurent\: knife winrm interactive can't really replace ssh windows_host
[2012-04-27 10:22:23 -0400] andoriyu_: wow
[2012-04-27 10:45:13 -0400] BryanWB: t oo muchh too doo
[2012-04-27 11:53:53 -0400] geekyogi: How can I create a user databag for mysql cookbook
[2012-04-27 11:54:18 -0400] Tensibai: Hi
[2012-04-27 11:54:43 -0400] geekyogi: @Tensibai, Hi
[2012-04-27 11:56:41 -0400] Tensibai: Looking for something quite specific to vmware and ubuntu: making symlinks for linux-headers files
[2012-04-27 11:57:22 -0400] geekyogi: I've an error while running a cookboo, it says "INFO: missing gem 'mysql' , INFO HTTP Request returned 404 Not Found
[2012-04-27 11:57:47 -0400] geekyogi: "I don't know how to search for users data objects"
[2012-04-27 11:58:00 -0400] Tensibai: in brief (as much as I can): for each file in /usr/src/linux-headers-<kernelrelease>/include/generated do a link inside /usr/src/linux-headers-<kernelrelease>/include/linux
[2012-04-27 12:04:11 -0400] yfeldblum: BryanWB, good morning
[2012-04-27 12:05:42 -0400] BryanWB: yfeldblum: morning!
[2012-04-27 12:07:40 -0400] Tensibai: Could someone point me toward an exemple perhaps ?
[2012-04-27 12:11:07 -0400] yfeldblum: fewer executes, more ruby_blocks ... that is the new way
[2012-04-27 12:17:55 -0400] zykes-_: Hi, someone here that can update the packaging for Ubuntu Precise ?
[2012-04-27 12:19:36 -0400] Mithrandir: zykes-_: the one on apt.opscode.com should work for precise
[2012-04-27 12:39:39 -0400] specialsauce: quick question: when the "knife" commands (eg "knife cookbook upload" / "knife role from file") are executed, do they update existing objects in couch+solr? or Delete existing objcets and recreate? Because I'm seeing some odd behaviour on re-importing updated cookbooks etc, where nodes are aparently losing all their attributes until there next chef-client run...
[2012-04-27 12:45:20 -0400] zts: specialsauce: neither "knife cookbook" nor "knife role" should touch your nodes in any way...
[2012-04-27 12:46:38 -0400] zts: but I don't know the exact answer to your question
[2012-04-27 12:46:55 -0400] specialsauce: it seems like the solr index is getting reset by one of the knife actions, because node attributes are not seemingly available via search after ive updated some recipes via knife
[2012-04-27 12:49:53 -0400] yfeldblum: anyone want librarian-chef to be faster? upvote http://community.opscode.com/ideas/18
[2012-04-27 13:03:43 -0400] rweng: m
[2012-04-27 13:04:34 -0400] rweng: is there a way in deploy_revision to use a before_migrate block AND file? I want the block to be executed in any case, but the file only if one exists
[2012-04-27 13:15:10 -0400] yfeldblum: rweng, write the block to do its thing and also execute the file ...
[2012-04-27 13:18:27 -0400] rweng: yfeldblum: with executing it you mean requiring it?
[2012-04-27 13:18:46 -0400] yfeldblum: rweng, no, do not require it
[2012-04-27 13:19:23 -0400] yfeldblum: i mean, follow the example here: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/deploy.rb#L161-175
[2012-04-27 13:19:58 -0400] yfeldblum: sorry, https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/deploy.rb#L142-159
[2012-04-27 13:21:51 -0400] rweng: yfeldblum: nice, thank you!
[2012-04-27 13:42:44 -0400] jtimberman: zykes-_: if something is broken with the packaging, would you please open a ticket at tickets.opscode.com, use the "CHEF" project and the "packaging" component, and include any relevant error messages in your bug report's description?
[2012-04-27 13:43:01 -0400] zykes-_: sure
[2012-04-27 13:43:08 -0400] jtimberman: thanks
[2012-04-27 13:43:14 -0400] zykes-_: http://paste.ubuntu.com/949666/ < think that is related to chef or the app ?
[2012-04-27 13:44:00 -0400] jtimberman: oh
[2012-04-27 13:44:09 -0400] jtimberman: that's not chef or the packaging then.
[2012-04-27 13:44:48 -0400] jtimberman: is your apt cache updated?
[2012-04-27 13:44:49 -0400] jannel: has anyone used aws_elastic_lb from aws cookbook?
[2012-04-27 13:45:01 -0400] jtimberman: you can use opscode's apt cookbook's default recipe to ensure it is before packages are installed.
[2012-04-27 13:45:16 -0400] jannel: it doesn't seem to find my load balancer
[2012-04-27 13:45:38 -0400] zykes-_: yeh, I think it's something regarding the app then
[2012-04-27 13:46:09 -0400] jannel: also, I can only attach ec2 type EIPs with aws_elastic_ip, not vpc ones
[2012-04-27 13:47:02 -0400] jtimberman: jannel: that lwrp is not in the released cookbook, but the one in the development repository, so it hasn't been fully teasted for release yet.
[2012-04-27 13:48:11 -0400] jannel: jtimberman: ok. I noticed that it is not in the released cookbook. do you know whether vpc type elastic ips are supported?
[2012-04-27 13:48:31 -0400] jtimberman: probably not, i think vpc was available after that code was written.
[2012-04-27 13:48:39 -0400] jtimberman: i don't use vpc so i haven't checked.
[2012-04-27 13:49:37 -0400] jannel: hm, looking at the code it seems that the problem is with the right_aws-gem
[2012-04-27 13:51:21 -0400] jtimberman: there's a ticket to convert that cookbook to use the fog gem :)
[2012-04-27 13:51:49 -0400] jannel: is somebody working on it? :)
[2012-04-27 13:52:40 -0400] carcher: i've run in to a problem while creating a new node having to do with environments; this may be by design but I'm not sure what the workaround is.  I'm passing "-E dev" on the knife command line but during the bootstrap on the client it's seeing node.chef_environment = '_default'.  It appears that the environment passed to knife is not considered in the BootstrapContext bootstrap_environment method (bootstrap_context.rb, line 46).   Any id
[2012-04-27 13:52:42 -0400] carcher: eas?
[2012-04-27 13:54:29 -0400] jannel: carcher: works for me. have you remembered to upload the environment? also, try -E "dev"
[2012-04-27 13:55:27 -0400] carcher: jannel: yes, I just double checked and my "dev" environment is showing up on the web console; I'll try your -E "dev" suggestion
[2012-04-27 14:03:26 -0400] sagar_nikam: Hi, what should be the order in run_list - recipe followed by role or the role followed by recipe
[2012-04-27 14:04:28 -0400] jannel: sagar_nikam: afaik role is expanded to its run list. so it does not matter.
[2012-04-27 14:05:24 -0400] carcher: @jannel: it seems that my recipe got a bit further with -E "dev" and hit a different issue (my code); thanks not sure why that matters but it seems to have changed something
[2012-04-27 14:06:55 -0400] jannel: carcher: lazy command line argument parsing, I guess. :)
[2012-04-27 14:07:11 -0400] sagar_nikam: jannel: i am trying the hadoop cookbook  http://community.opscode.com/cookbooks/hadoop
[2012-04-27 14:08:16 -0400] sagar_nikam: i have define the attributes hadoop[:mirror_url], hadoop[:version] and hadoop[:uid] by adding a role and its attributes
[2012-04-27 14:08:58 -0400] sagar_nikam: jannel: now when i run knife ssh 'name:server---32012-04-27-132624-0000.novalocal' -a node.ipaddress 'sudo chef-client' -i keyfile
[2012-04-27 14:09:05 -0400] sagar_nikam: i am getting this error
[2012-04-27 14:09:26 -0400] sagar_nikam: jannel:10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] ERROR: Exception handlers complete 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] FATAL: ArgumentError: Attribute hadoop is not defined!
[2012-04-27 14:12:08 -0400] jannel: I have no experience using that cookbook
[2012-04-27 14:13:02 -0400] sagar_nikam: @jtimberman: can you help me
[2012-04-27 14:13:16 -0400] sagar_nikam: on this issue
[2012-04-27 14:14:16 -0400] spyvsspy: I want a node to check a remote server for file changes, and if there is, download the directory
[2012-04-27 14:14:32 -0400] spyvsspy: should I use the remote directory resource
[2012-04-27 14:14:44 -0400] spyvsspy: (kind of like rsync, but I cant use rsync, has to be over 443)
[2012-04-27 14:15:27 -0400] yfeldblum: sagar_nikam, your node's run_list should typically a single role only; a role's run_list should typically be roles followed by extra recipes (but that's just my convention)
[2012-04-27 14:16:25 -0400] sagar_nikam: yfeldblum: i did that, role followed by recipes
[2012-04-27 14:16:49 -0400] sagar_nikam: yfeldblum: i am getting this error when i run the hadoop cookbook
[2012-04-27 14:17:18 -0400] sagar_nikam: 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] ERROR: Running exception handlers 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] FATAL: Saving node information to /var/chef/cache/failed-run-data.json 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] ERROR: Exception handlers complete 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out 10.6.87.160 [Fri, 27 Apr 2012 14:05:16 +0000]
[2012-04-27 14:18:23 -0400] yfeldblum: sagar_nikam, that's the standard log message when chef-client encounters any error at any time: look in /var/chef/cache/chef-stacktrace.out to find out what happened, or re-run the chef-client with "-l info" or "-l debug"
[2012-04-27 14:19:13 -0400] sagar_nikam: <yfeldblum: ok, checking
[2012-04-27 14:34:01 -0400] sagar_nikam: yfeldblum: i need to define the attribute hadoop
[2012-04-27 14:34:13 -0400] sagar_nikam: what should the value be ?
[2012-04-27 14:37:22 -0400] yfeldblum: sagar_nikam, i don't know anything about the cookbook; perhaps check its documentation?
[2012-04-27 14:40:21 -0400] spyvsspy: is there anything wrong with this: https://gist.github.com/2509793
[2012-04-27 14:40:35 -0400] spyvsspy: and how would i find the value of {node[:program][:version]}
[2012-04-27 14:42:29 -0400] Tensibai: spyvsspy: should be a node attribute program with 2 values: version and checksum
[2012-04-27 14:42:49 -0400] Tensibai: and it looks ok for me (newbie level)
[2012-04-27 14:43:09 -0400] spyvsspy: there should be a diffferent program?
[2012-04-27 14:44:06 -0400] Tensibai: as I do is: in a role: include the cookbook, and set attributes needed
[2012-04-27 14:44:09 -0400] spyvsspy: (also a newb_
[2012-04-27 14:44:11 -0400] Tensibai: then apply role to nodes
[2012-04-27 14:45:00 -0400] spyvsspy: i cant just assign that recipe to the node?
[2012-04-27 14:45:33 -0400] Tensibai: so in the role attributes you should have an object with two properties=> version as string definiting the program version
[2012-04-27 14:45:41 -0400] Tensibai: and checksum wich is the sha256-sum of the program-version.tar.gz file
[2012-04-27 14:45:55 -0400] Tensibai: spyvsspy: you can, and in this case you have to set the attributes on the node
[2012-04-27 14:46:45 -0400] Tensibai: or in env or role in fact, as long as once "compiled" the node has a program attribute which have version and cheksum
[2012-04-27 14:47:25 -0400] spyvsspy: hrm, maybe this is better done in bash
[2012-04-27 14:47:31 -0400] paulmooring: spyvsspy: I would do something like this
[2012-04-27 14:47:33 -0400] spyvsspy: i basically just want to look for a file name change
[2012-04-27 14:47:40 -0400] spyvsspy: and then if it has changed, download the new file
[2012-04-27 14:47:54 -0400] paulmooring: version = node['program']['version']
[2012-04-27 14:47:59 -0400] paulmooring: before the bash block
[2012-04-27 14:48:09 -0400] paulmooring: then drop the () around the cd line
[2012-04-27 14:48:23 -0400] paulmooring: and just use #{version}
[2012-04-27 14:49:01 -0400] paulmooring: it doesn't really matter if the attribute is in the default attributes in the cookbook, assigned to the node, or assigned to a role
[2012-04-27 14:49:18 -0400] paulmooring: just make sure you understand precedence if you have it in multiple locations
[2012-04-27 14:50:36 -0400] spyvsspy: ok, i simplified it down
[2012-04-27 14:50:37 -0400] spyvsspy: https://gist.github.com/2509878
[2012-04-27 14:51:03 -0400] paulmooring: also is actino :nothing intentional?
[2012-04-27 14:51:21 -0400] spyvsspy: if the version hasnt changed, I dotn want it to do anything
[2012-04-27 14:52:05 -0400] Tensibai: I've a doubt about that, not sure nothing is a valid action on script ressource
[2012-04-27 14:52:21 -0400] spyvsspy: basically my server will update the file it servers randomly, the chef-client runs at the top of the hour, if the content on th e server has changed, I want it to download and deploy the new content
[2012-04-27 14:52:47 -0400] spyvsspy: http://stackoverflow.com/questions/8530593/chef-install-and-update-programs-from-source
[2012-04-27 14:52:58 -0400] paulmooring: 1 second I think that's likely your problem, let me find something in the wiki
[2012-04-27 14:53:52 -0400] |shad0w|: http://wiki.opscode.com/display/chef/Resources#Resources-CommonActions
[2012-04-27 14:53:57 -0400] Tensibai: spyvsspy: in this case a remotefile whithout checksum is more the way I think
[2012-04-27 14:53:57 -0400] |shad0w|: yes it is
[2012-04-27 14:54:06 -0400] paulmooring: actually that should be right
[2012-04-27 14:54:22 -0400] Tensibai: Thanks |shad0w|
[2012-04-27 14:54:57 -0400] spyvsspy: i dont know how to set #{node[:version]} though
[2012-04-27 14:55:04 -0400] spyvsspy: https://gist.github.com/2509878 (new gist)
[2012-04-27 14:56:25 -0400] Tensibai: spyvsspy: through webui or knife, or the rest api
[2012-04-27 14:56:38 -0400] spyvsspy: ok, through the webui
[2012-04-27 14:57:02 -0400] spyvsspy: node -> edit -> atributes?
[2012-04-27 14:57:50 -0400] paulmooring: spyvsspy: I would start by editing the attributes/default.rb file in the cookbook
[2012-04-27 14:58:15 -0400] paulmooring: then use knife node edit or knife role edit to add it to a node or role
[2012-04-27 14:58:43 -0400] paulmooring: that is assuming you actually want a default value
[2012-04-27 14:59:12 -0400] spyvsspy: well, I need to keep track of the value somehow
[2012-04-27 14:59:51 -0400] spyvsspy: because everytime the new file downloads, I need to grab that hash, and set it as the new value, so Im not downloading files when they arent changing
[2012-04-27 15:02:01 -0400] paulmooring: I don't think that's going to help anyway
[2012-04-27 15:02:22 -0400] paulmooring: Chef can't verify a checksum until it's downloaded the file to make the checksum
[2012-04-27 15:04:14 -0400] paulmooring: or are you wanting to update the checksum out of the recipe?
[2012-04-27 15:04:59 -0400] Tensibai: paulmooring: If I understood correctly what he want is: check is the file on source depot has changed, if yes download it and run bash script
[2012-04-27 15:05:15 -0400] Tensibai: s/check is/check if/
[2012-04-27 15:06:09 -0400] paulmooring: That sounds right, except for the recipe as it's written compares the local file that was already downloaded against a static checksum
[2012-04-27 15:06:36 -0400] paulmooring: that means it never gets updated until something changes that checksum, the node['checksum'] attribute in this case
[2012-04-27 15:06:37 -0400] Tensibai: yep
[2012-04-27 15:07:01 -0400] Tensibai: the checksum part should be ommited for this case I think
[2012-04-27 15:08:03 -0400] paulmooring: or a hardcoded checksum per version
[2012-04-27 15:08:32 -0400] paulmooring: node['myapp']['version']['checksum']
[2012-04-27 15:09:36 -0400] yfeldblum: you'd think that would be the point of ETag
[2012-04-27 15:09:56 -0400] paulmooring: ETag?
[2012-04-27 15:09:56 -0400] bawt: ETag is interesting
[2012-04-27 15:10:29 -0400] yfeldblum: jtimberman, remote_file needs ETag (If-None-Match) and Date (If-Modified-Since) support
[2012-04-27 15:13:19 -0400] |shad0w|: if has if modified since already iirc
[2012-04-27 15:13:26 -0400] |shad0w|: s/if/it
[2012-04-27 15:13:43 -0400] paulmooring: yfeldblum: based on my quick wikipedia reading it looks like using etag would require the server and the client to both be set up for it
[2012-04-27 15:14:53 -0400] |shad0w|: http://tickets.opscode.com/browse/CHEF-1577
[2012-04-27 15:15:19 -0400] |shad0w|: nm, that is in http_request
[2012-04-27 15:17:26 -0400] yfeldblum: paulmooring, that's right, it's opt-in by both server and client (server can provide the ETag if it likes, and client can ask for the resource If-None-Match if it likes and if the server has given it an ETag)
[2012-04-27 15:23:12 -0400] jtimberman: yfeldblum: i think there was a ticket for that opened by schisamo some time ago
[2012-04-27 15:24:18 -0400] jtimberman: yup, here: http://tickets.opscode.com/browse/CHEF-2506
[2012-04-27 15:24:21 -0400] jtimberman: yfeldblum: ^
[2012-04-27 15:27:14 -0400] yfeldblum: jtimberman, does remote_file do Date & If-Modified-Since?
[2012-04-27 15:35:31 -0400] afallows: I'm currently trying to bootstrap a chef node on EC2 using an AMI which has RVM installed as a single user. When the instance loads, the bootstrap crashes because it cannot find the chef gem. Has anyone encountered this before?
[2012-04-27 15:36:39 -0400] afallows: My bootstrap script ends with <%= start_chef %>, I tried replacing it with a manual call to chef-client and that didn't have an effect.
[2012-04-27 15:44:29 -0400] jtimberman: yfeldblum: i don't think so
[2012-04-27 15:44:46 -0400] yfeldblum: jtimberman, i added a suggestion to the ticket :P
[2012-04-27 15:47:02 -0400] jtimberman: yfeldblum: thanks!
[2012-04-27 15:47:22 -0400] flashmanbahadur: anyone have a working monkey patch for the new Ubuntu 12.04 AWS AMI?
[2012-04-27 15:48:15 -0400] spyvsspy: i can use node['FQDN'] ?
[2012-04-27 15:50:43 -0400] spyvsspy: wrong window sry
[2012-04-27 16:03:15 -0400] hoover_damn: flashmanbahadur, what needs patched?
[2012-04-27 16:03:26 -0400] hoover_damn: and what's broken to be specific?
[2012-04-27 16:04:13 -0400] hoover_damn: there was someone on the mailing list that said that the chef-server recipe needed to be tweeked
[2012-04-27 16:04:20 -0400] hoover_damn: but no example
[2012-04-27 16:04:21 -0400] yfeldblum: jtimberman, what do you think, should data bag items be checked into source control?
[2012-04-27 16:04:23 -0400] cobragoat: chef-solo keeps failing to find my config file even when I directly specify it.. common mistake?
[2012-04-27 16:04:27 -0400] jtimberman: yfeldblum: yes
[2012-04-27 16:04:42 -0400] jtimberman: yfeldblum: *unless* there's an external process that modifies them.
[2012-04-27 16:04:52 -0400] jtimberman: like, if you have a recipe or an application that updates the data bag.
[2012-04-27 16:05:03 -0400] jtimberman: then putting that in source control is going to be pain
[2012-04-27 16:05:21 -0400] jtimberman: that will generally be a known thing though
[2012-04-27 16:05:25 -0400] yfeldblum: jtimberman, why checked in vs backed up?
[2012-04-27 16:07:06 -0400] jtimberman: hm?
[2012-04-27 16:14:17 -0400] cwj: flashmanbahadur: i am using this modified template file for bootstrapping precise instances https://gist.github.com/2493780
[2012-04-27 16:14:22 -0400] cwj: if that answers your question
[2012-04-27 16:15:17 -0400] hoover_damn: cwj, hrm... still 1.8?
[2012-04-27 16:15:18 -0400] hoover_damn: why?
[2012-04-27 16:16:01 -0400] hoover_damn: sigh rackspace... really?
[2012-04-27 16:16:08 -0400] cwj: i just tweaked the lucid template only as much as needed to get it working
[2012-04-27 16:16:08 -0400] hoover_damn: fresh instance is closing ssh connections
[2012-04-27 16:16:12 -0400] hoover_damn: ahh
[2012-04-27 16:16:49 -0400] hoover_damn: cwj, https://gist.github.com/a24b4aa1e4b88b9a725a
[2012-04-27 16:16:56 -0400] hoover_damn: that's what I use
[2012-04-27 16:17:16 -0400] cwj: cool, thanks
[2012-04-27 16:18:28 -0400] hoover_damn: that should bring in 1.9.3 in precise
[2012-04-27 16:18:28 -0400] hoover_damn: afaik
[2012-04-27 16:20:56 -0400] hoover_damn: cwj, we both should be using rubygems self hosted
[2012-04-27 16:21:04 -0400] hoover_damn: at least you use production.cf
[2012-04-27 16:21:05 -0400] hoover_damn: :)
[2012-04-27 16:21:23 -0400] jtimberman: the distribution provided ruby1.9.1 will install ruby 1.9.3 on precise as well.
[2012-04-27 16:22:02 -0400] jtimberman: and it uses the alternatives system to make it the default 'ruby' interpreter
[2012-04-27 16:23:01 -0400] hoover_damn: yep
[2012-04-27 16:23:10 -0400] hoover_damn: that gives me 192p125 on Oneric
[2012-04-27 16:23:19 -0400] hoover_damn: err whatever the latest 192 is
[2012-04-27 16:23:23 -0400] jtimberman: sudo do-release-upgrade
[2012-04-27 16:23:26 -0400] hoover_damn: and on precise it'll give you the next :)
[2012-04-27 16:23:32 -0400] hoover_damn: I'm not upgrading to 12.04
[2012-04-27 16:24:15 -0400] hoover_damn: and Rackspace doesn't list it yet
[2012-04-27 16:24:17 -0400] hoover_damn: good reason
[2012-04-27 16:25:28 -0400] yfeldblum: jtimberman, what about one-repo-one-server vs one-repo-many-servers?
[2012-04-27 16:25:39 -0400] jtimberman: yfeldblum: ?
[2012-04-27 16:25:39 -0400] bawt: yfeldblum: is there a way to get it to work with our existing cookbooks?  Seems like a hassle to have to have a seperate git repository just to use librarian
[2012-04-27 16:25:46 -0400] jtimberman: hahahaha
[2012-04-27 16:25:47 -0400] jtimberman: !botsnack
[2012-04-27 16:25:48 -0400] bawt: jtimberman: schweet!
[2012-04-27 16:25:54 -0400] jtimberman: bawt: forget yfeldblum:
[2012-04-27 16:25:55 -0400] bawt: can do!
[2012-04-27 16:26:02 -0400] yfeldblum: hey now!
[2012-04-27 16:26:11 -0400] jtimberman: hahahahaha
[2012-04-27 16:26:19 -0400] jtimberman: yfeldblum?
[2012-04-27 16:26:19 -0400] bawt: yfeldblum is right
[2012-04-27 16:26:29 -0400] jtimberman: hehehehe
[2012-04-27 16:27:10 -0400] yfeldblum: jtimberman, maybe want to have bawt parse thinks like "bawt set WORD is ..."
[2012-04-27 16:27:34 -0400] jtimberman: yfelblum?
[2012-04-27 16:27:39 -0400] jtimberman: bah!
[2012-04-27 16:27:41 -0400] jtimberman: yfeldblum?
[2012-04-27 16:27:41 -0400] bawt: yfeldblum is the author of librarian-chef, a "bundler" for cookbooks
[2012-04-27 16:28:12 -0400] hoover_damn: lol
[2012-04-27 16:29:15 -0400] carcher: still having some trouble with environments; knife environment show dev shows that my 'dev' environment is present; knife ec2 server create -E "dev" -f m1.small -I ami-4bad7422 -G default -x ubuntu -N clark-test provisions a node and echoes "Environment: dev" at the end of the run.  However, knife search node "name:clark-test" reports the node's environment as "_default".  I have also added the environment to my knife.rb but get the same
[2012-04-27 16:29:17 -0400] carcher: results
[2012-04-27 16:29:25 -0400] yfeldblum: jtimberman, anyway, one infra repo ... i like to pair that with any number of concrete chef-servers (one in vagrant, oss ones for dev & testing etc., hosted for production nodes, etc.) ... but that seems to preclude putting data bag items in source control ... anybody else out there doing it that way?
[2012-04-27 16:30:00 -0400] carcher: I *can* successfully move the node into the "dev" environment using knife exec after the node has been provisioned.
[2012-04-27 16:30:06 -0400] carcher: Really at a loss here.
[2012-04-27 16:39:07 -0400] jtimberman: carcher: what does "knife node show NODENAME -E" show
[2012-04-27 16:39:16 -0400] jtimberman: carcher: has the node successfully completed a chef run?
[2012-04-27 16:39:56 -0400] flashmanbahadur: thanks cwj I got an old ruby 1.9.1 monkey patch to work
[2012-04-27 16:41:33 -0400] afallows: Is it possible to get knife-ec2 to invoke chef-cient with sudo -E when it bootstraps a node?
[2012-04-27 16:41:39 -0400] carcher: jtimberman: knife node show clark-test -E  reports chef_environment: _default
[2012-04-27 16:42:27 -0400] carcher: jtimberman: the node has been provisioned but with an empty run list as I was trying to distill this down as much as possible
[2012-04-27 16:55:55 -0400] sivy: good morn, allll
[2012-04-27 17:00:40 -0400] jtimberman: carcher: what version of chef and knife-ec2 do you have?
[2012-04-27 17:01:13 -0400] jtimberman: carcher: i used that *exact* command and the node was in the 'dev' environment.
[2012-04-27 17:01:24 -0400] jtimberman: with knife node show
[2012-04-27 17:10:59 -0400] afallows: How would I pin down where/why "ERROR: TypeError: can't convert false into String" is coming from in a knife ec2 server create call?
[2012-04-27 17:14:04 -0400] ashb: afallows: try -l debug in the command line
[2012-04-27 17:14:48 -0400] afallows: ashb: Thanks for the tip, I'll try that.
[2012-04-27 17:29:43 -0400] echiu: I'm getting a "waiting for sshd" while creating ec2 during bootstrap
[2012-04-27 17:30:20 -0400] cwj: hoover_damn: i launched an instance with that template you provided and the run list is expanding to empty? i am confuse
[2012-04-27 17:30:41 -0400] afallows: echiu: That's normal unless it's hanging for longer than 15-30 seconds?
[2012-04-27 17:30:42 -0400] cwj: same run list expands properly on a precise instance with ruby 1.8.7
[2012-04-27 17:33:50 -0400] flashmanbahadur: hoover_damn: sorry, missed your earlier comment.  The default chef client startup fails on 12.04 because the extra ruby libraries don't exist in the package lists anymore (libruby-dev etc).  Using a monkey patch to get ruby 1.9 worked for me. Not sure if you can get the ruby 1.8.7 equivalents because I prefer to not use 1.8.7 due to segfault issues with popen that will be fixed in 0.10.10
[2012-04-27 17:33:56 -0400] cwj: ah wrong environment
[2012-04-27 17:34:50 -0400] hoover_damn: cwj, shrug
[2012-04-27 17:34:58 -0400] hoover_damn: template should work just fine on ubuntu
[2012-04-27 17:35:31 -0400] cwj: hoover_damn: something went wrong and the environment didnt get set, nm me :)
[2012-04-27 17:37:28 -0400] echiu: it hangs for 30+ min during bootstrap of ec2
[2012-04-27 17:37:48 -0400] echiu: what do I need to enable ssh to ec2?
[2012-04-27 17:40:08 -0400] mikeg: Hey.  Sorry to be the n00b in the room but what does "BoF" mean?  Going to chefconf and there's a pre-event hackday and a Diablo3 lan party that both say "Type: BoF"
[2012-04-27 17:40:36 -0400] cwj: mikeg i think it stands for Birds of a Feather
[2012-04-27 17:41:06 -0400] mikeg: Well, that's just clear as mud then :)
[2012-04-27 17:41:26 -0400] jtimberman: flashmanbahadur: you can create a custom bootstrap template and use that
[2012-04-27 17:41:27 -0400] jtimberman: bootstrap?
[2012-04-27 17:41:27 -0400] bawt: bootstrap is setting up your system to use Chef. You can 'bootstrap' a Chef RubyGems installation to install a Chef server, or use the knife bootstrap subcommand on new clients.
[2012-04-27 17:41:30 -0400] jtimberman: knife bootstrap?
[2012-04-27 17:41:31 -0400] bawt: knife bootstrap is http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-04-27 17:41:31 -0400] cwj: i think it is meant to indicate that people can self-select to participate in the activity if it interests them
[2012-04-27 17:41:40 -0400] jtimberman: flashmanbahadur: that wiki link has instructions
[2012-04-27 17:41:57 -0400] mikeg: cwj: ok.  that would make sense.  cool.  thanks
[2012-04-27 17:42:14 -0400] jtimberman: mikeg: precisely what cwj said. if you are interested in playing Diablo 3 with other folks at the conference, show up with a copy of D3 installed :)
[2012-04-27 17:42:31 -0400] mikeg: i thought it comes out that day
[2012-04-27 17:42:56 -0400] jtimberman: it does!
[2012-04-27 17:43:00 -0400] cwj: i will be playing virtual d3, where in one walks around clicking at real objects with a disconnected mouse
[2012-04-27 17:43:02 -0400] jtimberman: so... that'll be interesting :D
[2012-04-27 17:43:08 -0400] jtimberman: cwj: ha!
[2012-04-27 17:43:18 -0400] jtimberman: i have the client installed from the open beta last weekend
[2012-04-27 17:43:26 -0400] jtimberman: so hopefully when release comes its just a patch.
[2012-04-27 17:43:52 -0400] mikeg: Oh.  lucky you.  is it going to be released on linux?  my corporate overlords have blocked access to all the google results for system requirements
[2012-04-27 17:44:00 -0400] afallows: jtimberman: I hope you're planning on leading a panel discussion and leveling a Demon Hunter at the same time.
[2012-04-27 17:44:43 -0400] mikeg: well, wikipedia says no.  macos and winders only
[2012-04-27 17:44:56 -0400] mikeg: I'll come anyway and lurk
[2012-04-27 17:45:10 -0400] mikeg: be jealous and all that
[2012-04-27 17:45:14 -0400] afallows: mikeg: There's always Wine.
[2012-04-27 17:45:26 -0400] mikeg: yeah.  and I'll drink lots of wine.  good idea
[2012-04-27 17:45:29 -0400] afallows: Haha
[2012-04-27 17:45:29 -0400] mikeg: :)
[2012-04-27 17:45:33 -0400] afallows: Well played.
[2012-04-27 17:45:36 -0400] mikeg: think it'll run on wine?
[2012-04-27 17:46:09 -0400] afallows: I have no idea. I've gotten some pretty demanding games to run on wine but I've got a Win7 gaming machine so I haven't fussed with Wine as much as others surely have.
[2012-04-27 17:46:30 -0400] afallows: My crowning achievement with Wine was getting WoW to run.
[2012-04-27 17:47:06 -0400] jtimberman: have a cookbook for that? ;)
[2012-04-27 17:52:20 -0400] flashmanbahadur: Opscode reports 0 revenue after discovering and perfecting the Wine WoW cookbook
[2012-04-27 17:53:03 -0400] flashmanbahadur: thanks for the help jtimberman I will convert my monkey patch to a bootstrap templating because, well, monkey patching is a sin
[2012-04-27 17:54:52 -0400] yfeldblum: afallows, i demand more details!
[2012-04-27 17:55:43 -0400] afallows: yfeldblum: About what now?
[2012-04-27 17:56:27 -0400] yfeldblum: getting WoW to run with Wine
[2012-04-27 17:57:17 -0400] afallows: Ah, well. I don't think I could help much, I did it a few years ago, and I don't still have the machine. I was able to get things working with 75% Google and 25% prior knowledge, though, so I'm sure Google resources are still out there.
[2012-04-27 17:57:50 -0400] afallows: The main thing I remember is that I couldn't get the install to work, but I was on a dual boot so I mounted the windows drive and just used the existing installed version with some linking.
[2012-04-27 18:00:14 -0400] yfeldblum: ah
[2012-04-27 18:00:22 -0400] afallows: On an unrelated note: Sometimes when I run knife ec2 server create or knife node run_list add, a role[role_name] element will get mashed into recipe[roles] and then the chef-client run (predictably) fails. Has anyone seen this before?
[2012-04-27 18:02:26 -0400] cobragoat: any ideas why chef-solo would claim it cannot find config.rb when I am giving it the complete path?
[2012-04-27 18:04:40 -0400] echiu: still hanging on ec2 bootstrap "waiting for sshd"
[2012-04-27 18:06:00 -0400] jessicab: echiu - did you setup the security group with ssh access?
[2012-04-27 18:06:10 -0400] cobragoat: err solo.rb
[2012-04-27 18:06:32 -0400] echiu: no, where is docs for security group setup?
[2012-04-27 18:06:54 -0400] jessicab: cobragoat - i opened this bug yesterday for that happening on windows, perhaps your issues related http://tickets.opscode.com/browse/CHEF-3064
[2012-04-27 18:07:28 -0400] afallows: echiu: That's normal managed through AWS tools. It's easy to set up through the console at aws.amazon.com, I don't know if knife-ec2 can manage it.
[2012-04-27 18:07:37 -0400] afallows: I'm guessing it can't.
[2012-04-27 18:07:38 -0400] cobragoat: jessicab: interesting. I am on os x tho.
[2012-04-27 18:07:45 -0400] jessicab: echiu - the wiki talks about setting it up here http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step2%3AConfigureAWSsettingsandtheknife.rbfile
[2012-04-27 18:07:51 -0400] cobragoat: but seems similar
[2012-04-27 18:08:34 -0400] cobragoat: jessicab: I was thinking I was making a common mistake as I am new to chef-solo.. but I am pretty familiar with using hosted chef/knife etc
[2012-04-27 18:10:44 -0400] jessicab: cobragoat - yea, i havent used chef-solo a ton, but thats the only issue ive seen that sounds similar with client at least
[2012-04-27 18:13:21 -0400] echiu: jessicab - thanks - that's what I'm looking for
[2012-04-27 18:16:33 -0400] carcher: jannel, jtimberban: thanks for the help; turns out it was a customized template another developer on our team had added for ubuntu11.10; moving that out of the way allowed the node environment to function properly using the default ubuntu10.04-gems.erb template; great info also found at http://help.opscode.com/discussions/problems/1227-how-do-i-go-about-making-knife-ec2-honor-the-environment-argument
[2012-04-27 18:30:37 -0400] hoover_damn: heh
[2012-04-27 18:30:45 -0400] hoover_damn: yeah a lot of people had custom bootstraps pre-environments
[2012-04-27 18:30:48 -0400] hoover_damn: that didn't work post environment
[2012-04-27 18:30:59 -0400] hoover_damn: realizing that was fun
[2012-04-27 18:31:49 -0400] carcher: barrels of laughs
[2012-04-27 18:34:11 -0400] wamitchell: so i spent a while getting the mysql cookbook to put the database's data directory in an alternate place, and ended up with a small, separate add-on recipe. i'm wondering what the appropriate channel is to share that code with others.
[2012-04-27 18:37:04 -0400] wamitchell: i can fork on github and send a pull request, but wondering if there's a FAQ or best practice
[2012-04-27 18:37:39 -0400] echiu: what's the expected bootstrap time for ec2?
[2012-04-27 18:39:38 -0400] echiu: added ssh to security group per docs
[2012-04-27 18:39:59 -0400] echiu: still hanging...
[2012-04-27 18:41:36 -0400] jessicab: echiu -id say it takes about 3-5 minutes or so for that step.. depends, sometimes it just takes awhile.. did you follow the steps to setup your ssh key too?
[2012-04-27 18:41:59 -0400] echiu: how do I get more debug output?
[2012-04-27 18:42:17 -0400] afallows: echiu: Add -VV to your knife call.
[2012-04-27 18:42:17 -0400] echiu: yes, have setup ssh key
[2012-04-27 18:42:25 -0400] afallows: (That's two V's, not a W)
[2012-04-27 18:56:14 -0400] echiu: -W does not work for knife
[2012-04-27 18:56:28 -0400] echiu: what's the debug flag for knife?
[2012-04-27 18:59:01 -0400] echiu: how do I start ssh-agent on MacOS?
[2012-04-27 18:59:34 -0400] echiu: exec ssh-agent /usr/bin/bash hangs my terminal
[2012-04-27 19:01:04 -0400] Kwanasolis: jtimberman: you there?
[2012-04-27 19:02:10 -0400] brandoma: ssh-agent is probably running already
[2012-04-27 19:02:49 -0400] Kwanasolis: I'm not a mac guy, but . . . try 'exec ssh-agent' or if you need it in a bash shell 'exec /usr/bin/bash ssh-agent'
[2012-04-27 19:02:53 -0400] Kwanasolis: but likely the first one will work
[2012-04-27 19:03:48 -0400] erikh: usually it's started by launchd
[2012-04-27 19:04:12 -0400] Kwanasolis: well there ya go
[2012-04-27 19:04:17 -0400] Kwanasolis: ps aux |grep ssh-agent
[2012-04-27 19:04:22 -0400] erikh: yep
[2012-04-27 19:05:02 -0400] echiu: I need to have ssh-agent running on the knife workstation, right? that's why it's waiting for sshd?
[2012-04-27 19:05:44 -0400] erikh: echiu: ssh-add -l -- what does that say?
[2012-04-27 19:06:00 -0400] erikh: the short answer is it could be a number of things
[2012-04-27 19:08:37 -0400] echiu: ssh-add -l: The agent has no identities.
[2012-04-27 19:10:50 -0400] Urocyon: I'm planning on manipulating /etc/hosts entries.  I've found spheromak's LWRP.   Are there other implementations I should look at?
[2012-04-27 19:11:00 -0400] Urocyon: https://github.com/spheromak/cookbooks/tree/master/hosts
[2012-04-27 19:13:40 -0400] echiu: ok, started ssh-agent and added key using ssh-add
[2012-04-27 19:18:51 -0400] yfeldblum: why don't custom bootstraps work post-environments?
[2012-04-27 19:25:34 -0400] organicveggie: Still struggling with an upgrade from 0.9.14 to 0.10.8. chef-client returns "Errno::EAFNOSUPPORT: Address family not supported by protocol". http://paste2.org/p/1997907
[2012-04-27 19:25:39 -0400] organicveggie: Any ideas?
[2012-04-27 19:32:31 -0400] echiu: waiting for sshd
[2012-04-27 19:32:40 -0400] echiu: how to debug?
[2012-04-27 19:35:16 -0400] echiu: just hangs during ec2 bootstrap
[2012-04-27 19:35:38 -0400] echiu: ssh-agent is up, key is added
[2012-04-27 19:35:44 -0400] daaaan: try and ssh manually
[2012-04-27 19:35:53 -0400] echiu: security group has ssh access
[2012-04-27 19:37:42 -0400] echiu: manual ssh to ec2 hangs
[2012-04-27 19:38:15 -0400] daaaan: look at the connectivity checks in the console
[2012-04-27 19:38:19 -0400] daaaan: do both pass?
[2012-04-27 19:38:54 -0400] echiu: ?
[2012-04-27 19:39:04 -0400] echiu: which console?
[2012-04-27 19:39:10 -0400] daaaan: aws
[2012-04-27 19:39:31 -0400] jtimberman: kwayeah
[2012-04-27 19:39:34 -0400] daaaan: like, log into aws.amazon.com and click on the instance. there'sa  field that says if amazon detects any issues
[2012-04-27 19:39:34 -0400] jtimberman: bah
[2012-04-27 19:39:39 -0400] jtimberman: he left
[2012-04-27 19:40:14 -0400] echiu: status checks on AWS console passed
[2012-04-27 19:40:32 -0400] daaaan: are you sure your security group stuff is right? what's the security group called?
[2012-04-27 19:40:50 -0400] daaaan: ec2-authorize {groupname} -s `curl ifconfig.me`/32 -p22
[2012-04-27 19:41:33 -0400] nect: how can I have a if/else case in the only_if condition?
[2012-04-27 19:42:07 -0400] nect: if I return from within the if/else case, it gives me a LocalJumpError: break from proc-closure error
[2012-04-27 19:45:30 -0400] organicveggie: no suggestions for the chef-client error? kinda dead in the water with no paddle. :)
[2012-04-27 19:45:50 -0400] Brad_K: organicveggie: sorry, just came back from lunch.  what was the error?
[2012-04-27 19:46:00 -0400] organicveggie: struggling with an upgrade from 0.9.14 to 0.10.8. chef-client returns "Errno::EAFNOSUPPORT: Address family not supported by protocol". http://paste2.org/p/1997907
[2012-04-27 19:46:11 -0400] organicveggie: centos 6.2 on EC2. rubygems installed from source.
[2012-04-27 19:47:19 -0400] Brad_K: organicveggie: so, this is on a node that already had chef-client 0.9.14 installed on a CentOS 6.2 VM?
[2012-04-27 19:47:26 -0400] organicveggie: yes.
[2012-04-27 19:47:48 -0400] organicveggie: The chef server is a new instance with a copy of the couchdb from the old instance.
[2012-04-27 19:47:58 -0400] organicveggie: Replaced validation pem on the client, removed client pem, etc.
[2012-04-27 19:48:03 -0400] organicveggie: upgraded chef gem.
[2012-04-27 19:48:27 -0400] Brad_K: okay, well.  several potential issues i see here.  obviously, chef 0.9.14 is pretty old.  and CentOS 6.2 is pretty new, with lots of changes.  more than a few of those changes are "non-trivial".
[2012-04-27 19:49:01 -0400] organicveggie: i have chef 0.9.14 running very well on 100+ machines... :)
[2012-04-27 19:49:10 -0400] organicveggie: all of which are running CentOS 6.2.
[2012-04-27 19:49:37 -0400] Brad_K: do you know which version of Ruby and rubygems that you're running with?  more recent versions of chef require Ruby 1.8.7+, which is not clear that you have installed  i see ruby 1.8, not 1.8.7.
[2012-04-27 19:49:56 -0400] organicveggie: ruby 1.8.7p352
[2012-04-27 19:50:27 -0400] organicveggie: how do i check rubygems version?
[2012-04-27 19:50:59 -0400] Brad_K: one way to get around a lot of the issues with various different versions of ruby, etc is to do the "full stack installer" version of chef-client that comes from the "omnibus" build system.  that brings along their own embedded version of ruby, rubygems, etc.  it requires more disk space, but in the end it tends to be a lot easier to install and manage.
[2012-04-27 19:50:59 -0400] organicveggie: if gem -v works, i'm running 1.8.10
[2012-04-27 19:51:02 -0400] yfeldblum: `knife bootstrap` uses ssh's into the instance from your workstation, just as if you were sshing in directly
[2012-04-27 19:51:57 -0400] organicveggie: Brad_K: i'm willing to give that shot. Certainly can't hurt. :)
[2012-04-27 19:52:37 -0400] organicveggie: Brad_K: you don't happen to have a link to the omnibus handy? :)
[2012-04-27 19:52:43 -0400] Brad_K: looking now.
[2012-04-27 19:53:31 -0400] daaaan: http://www.opscode.com/chef/install/
[2012-04-27 19:53:43 -0400] organicveggie: daaan: awesome! thanks.
[2012-04-27 19:54:02 -0400] daaaan: that page needs some seo help, i can only ever find it because it's referenced in a tweet that shows up on google #3
[2012-04-27 19:54:09 -0400] Brad_K: thanks, daaaan.  i wasn't able to find that with quick searches in the wiki.  ;-(
[2012-04-27 19:55:10 -0400] Brad_K: but i guess they're not really referring to it in those terms any more.  it's now just "install chef".  ;-(
[2012-04-27 19:55:45 -0400] jtimberman: daaaan: That is not "officially" released and is still "beta". It will be "officially released" with Chef 0.10.10.
[2012-04-27 19:56:04 -0400] amishgeek: i ran a google search for ubuntu12.04 bootstrap scripts  any recommendations on which one is going to be included in chef?
[2012-04-27 20:00:31 -0400] eherot: Does anyone know if there is a way to save the contents of a data bag locally during a chef run so that more than one recipe can access it?  It seems wasteful to have to download this (fairly large) data bag from the chef server for every recipe that references it (most of them)...
[2012-04-27 20:01:32 -0400] echiu: Waiting for sshd..............................done
[2012-04-27 20:01:33 -0400] echiu: Failed to authenticate linux - trying password auth
[2012-04-27 20:01:33 -0400] echiu: Bootstrapping Chef on ec2.compute-1.amazonaws.com
[2012-04-27 20:01:49 -0400] daaaan: are you sure you're using the right keypair?
[2012-04-27 20:02:02 -0400] echiu: how to get default password for ec2 - don't see it in AWS console
[2012-04-27 20:02:02 -0400] daaaan: you need to make sure it's using the one you downloaded from amazon
[2012-04-27 20:02:11 -0400] echiu: same key pair
[2012-04-27 20:02:16 -0400] Brad_K: eherot: the databag should only be downloaded once.  all other references to it should use the cached downloaded version.
[2012-04-27 20:02:25 -0400] daaaan: you don't use a password, everything should use keys
[2012-04-27 20:03:10 -0400] eherot: definitely seeing a lot of these in the debug logs
[2012-04-27 20:03:10 -0400] eherot: [Fri, 27 Apr 2012 19:40:19 +0000] DEBUG: Sending HTTP Request via GET to chef.where.com:4000/data/locations/aws
[2012-04-27 20:03:15 -0400] daaaan: you can either specify it on the call to knife with -i, or edit ~/.ssh/config to specify IdentityFile for ec2-*.compute-1.amazonaws.com
[2012-04-27 20:03:33 -0400] eherot: those calls are not actualy happening?
[2012-04-27 20:05:18 -0400] echiu: how to get default password for ec2?
[2012-04-27 20:05:53 -0400] jessicab: echiu - are you sure the username youre passing it with -x is correct? that can also cause that error btw
[2012-04-27 20:06:04 -0400] eherot: echiu: there isn't one.  You have to log in using the private key for the public key that you selected for your machine
[2012-04-27 20:06:46 -0400] eherot: also, a lot of the ubuntu images make you use the "ubuntu" or "ec2-user" user (although they will tell you as much if you try to log in as root).
[2012-04-27 20:06:51 -0400] spyvsspy: how do you guys get chef to start in deamon mode upon boot?
[2012-04-27 20:06:56 -0400] spyvsspy: just a line in rc.local?
[2012-04-27 20:07:46 -0400] flashmanbahadur: spyvsspy: there is a recipe you can use
[2012-04-27 20:08:04 -0400] flashmanbahadur: "recipe[chef-client::config]", "recipe[chef-client::service]"
[2012-04-27 20:08:08 -0400] daaaan: what ami are you using?
[2012-04-27 20:08:16 -0400] flashmanbahadur: i have these tacked on to my roles spyvsspy
[2012-04-27 20:08:21 -0400] spyvsspy: ami?
[2012-04-27 20:08:41 -0400] daaaan: that was for echiu
[2012-04-27 20:09:30 -0400] spyvsspy: ah chef-client::Service recipe
[2012-04-27 20:09:38 -0400] spyvsspy: ty
[2012-04-27 20:10:15 -0400] eherot: Brad_K: Are these "Sending HTTP Request via GET" entries in my debug output just "fake?" so to speak?
[2012-04-27 20:11:01 -0400] Brad_K: eherot: i'm doing some research to try to confirm that.
[2012-04-27 20:11:54 -0400] eherot: Brad_K: thx
[2012-04-27 20:12:44 -0400] hoover_damn: doubt it's fake
[2012-04-27 20:13:00 -0400] echiu: jessicab: what is the username for the -x parameter?
[2012-04-27 20:13:09 -0400] organicveggie: Brad_K: thanks for the omnibus suggestion. that cleared up the Address family not supported problem. Now I have a new problem, but that's a huge step forward. :)
[2012-04-27 20:13:21 -0400] echiu: I'm using -x linux
[2012-04-27 20:13:32 -0400] jessicab: echiu - depends on the ami you are using, there are some amis listed on that wiki page you can use for testing, and they list the usernames they need
[2012-04-27 20:13:39 -0400] Brad_K: organicveggie: glad to be able to help.
[2012-04-27 20:14:07 -0400] jessicab: echiu - theres a whole list of them here too - http://wiki.opscode.com/display/chef/AMI+List+for+Developers
[2012-04-27 20:15:25 -0400] jessicab: echiu - thats also probably why daaaan was asking which ami you used, you might be able to find the username with a google search or something
[2012-04-27 20:18:24 -0400] Brad_K: eherot: re-reading the page at https://wiki.opscode.com/display/chef/Data+Bags it seems that data bags are stored on the chef server and accessed remotely, but you don't pull down the whole data bag each time  you just pull down the parts you need for the specific object you're accessing.
[2012-04-27 20:19:36 -0400] eherot: Brad_K: Yeah, you pull down the individual "item" ("aws" in this case, from the "locations" data bag), but even that item is quite large in this case so I'm looking for a way to cache it locally so that I only need to grab it once per chef run per server, rather than once for each recipe
[2012-04-27 20:19:41 -0400] Brad_K: chef-solo will download the whole data bag, but otherwise if you need to cache the data then you'd need to come up with your own way to do that  maybe by setting variables equal to the data bag contents and make sure that data is stored in a way that it doesn't get saved back to the node at the end of the run, so that on the next run you get fresh data from the data bag.
[2012-04-27 20:20:16 -0400] echiu: jessicab: thanks - found the username  - bootstrap successful
[2012-04-27 20:20:40 -0400] echiu: it's always so hard to find step by step instructions in chef docs?
[2012-04-27 20:21:05 -0400] echiu: it's sprinkled across different web/wiki pages
[2012-04-27 20:22:47 -0400] Brad_K: eherot: i recall seeing a discussion recently on how you could add things to the node in a way that the data would not be saved at the end of the chef run, but i don't remember off the top of my head what that was.  maybe hoover_damn might.
[2012-04-27 20:23:12 -0400] eherot: Brad_K: kind of like a chef global variable
[2012-04-27 20:23:21 -0400] eherot: or attribute
[2012-04-27 20:23:22 -0400] Brad_K: eherot: exactly.
[2012-04-27 20:23:44 -0400] Brad_K: ahh, i think you're looking for Node.run_state
[2012-04-27 20:24:16 -0400] yfeldblum: Brad_K, data-bag = a whole mysql table ; data bag item = a single record in a mysql table
[2012-04-27 20:24:37 -0400] Brad_K: eherot: see http://help.opscode.com/discussions/questions/196-ruby-code-within-template
[2012-04-27 20:25:04 -0400] jessicab: echiu - nice, this guide should be about as step by step as ec2 gets.. theres just a lot of steps to ec2, it gets easier now that the security group and stuff are setup though http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide
[2012-04-27 20:25:07 -0400] echiu: ec2 is running, but I don't see it in my hosted chef
[2012-04-27 20:25:14 -0400] yfeldblum: it would be useful to cache data-bag-item fetches and search results; however, since recipes are permitted to WRITE data bag items (don't do it! but you can), automatic caching would prevent later recipes from seeing results saved by earlier recipes
[2012-04-27 20:25:52 -0400] eherot: Brad_K: actually this might work quite nicely, thanks
[2012-04-27 20:25:53 -0400] echiu: 'knife ec2 server list' shows the server, 'knife node list' does not
[2012-04-27 20:26:01 -0400] jessicab: echiu - probably means that the chef-client run didnt finish convergence, should see why in your logs
[2012-04-27 20:26:46 -0400] eherot: echiu: means it never registered with chef, which could be any number of things including but not limited to a recipe error.
[2012-04-27 20:27:21 -0400] eherot: echiu: actually, no,  recipe errors usually result in nodes with blank run lists...
[2012-04-27 20:29:00 -0400] echiu: ERROR:  Error installing chef:
[2012-04-27 20:29:00 -0400] echiu: ERROR: Failed to build gem native extension.
[2012-04-27 20:29:02 -0400] echiu: mkmf.rb can't find header files for ruby at /usr/lib/ruby/ruby.h
[2012-04-27 20:29:19 -0400] echiu: bootstrap failed...
[2012-04-27 20:29:43 -0400] eherot: .is ruby installed?
[2012-04-27 20:30:06 -0400] echiu: using default bootstrap, not my own recipes
[2012-04-27 20:30:56 -0400] jessicab: echiu - could be an ami issue, you might want to try one of those test amis with a similar os and see if the issue happens there too
[2012-04-27 20:31:24 -0400] echiu: what is /usr/lib64/ruby/gems/1.8/gems/yajl-ruby-1.1.0/yajl-ruby.gemspec
[2012-04-27 20:31:36 -0400] echiu: and why it is failing here?
[2012-04-27 20:31:56 -0400] cwj: sounds like you are missing a package that includes some ruby header files
[2012-04-27 20:32:21 -0400] echiu: ok, I'll try another AMI - is there an approved list?
[2012-04-27 20:33:31 -0400] jessicab: echiu - we use this list for testing, but its not supported by opscode http://wiki.opscode.com/display/chef/AMI+List+for+Developers
[2012-04-27 20:33:33 -0400] cwj: i use ubuntu, sounds like you are on something like redhat
[2012-04-27 20:36:29 -0400] echiu: I'm using the standard Amazon linux AMI ami-e565ba8c
[2012-04-27 20:37:39 -0400] eherot: echiu: that one is pretty bare bones on its own
[2012-04-27 20:38:15 -0400] Brad_K: that's a US-East/N.Va EBS-Backed 64-bit AMI (according to https://aws.amazon.com/amazon-linux-ami/), but i'm not sure what that's based on.
[2012-04-27 20:38:49 -0400] Brad_K: they talk about Amazon yum repositories, so i would assume that's something redhat/centos-ish.
[2012-04-27 20:39:28 -0400] eherot: Brad_K/echiu: they're based on redhat but they are very bare bones out of the box.
[2012-04-27 20:39:39 -0400] eherot: Not even sure they have most of the libs required to run most ruby apps
[2012-04-27 20:40:02 -0400] Brad_K: which explains why it is "supported" on a t1.micro instance.
[2012-04-27 20:40:16 -0400] Brad_K: i think my watch is more powerful than a t1.micro.
[2012-04-27 20:40:16 -0400] eherot: heh yep
[2012-04-27 20:40:40 -0400] echiu: ok, I'm switching to ami-4b814f22, the last one on your wiki page
[2012-04-27 20:41:07 -0400] jessicab: echiu - most the amis ive seen with amazon linux use ec2-user
[2012-04-27 20:41:27 -0400] echiu: there should some caveat in the docs that default bootstrap doesn't work in most AMIs
[2012-04-27 20:41:38 -0400] Brad_K: note that is instance store and not EBS.
[2012-04-27 20:42:13 -0400] Brad_K: if you want EBS on a redhat/centos-ish install, you'll need one of the RHEL-based images.
[2012-04-27 20:42:18 -0400] echiu: I'm just aiming to get a success bootstrap at this point
[2012-04-27 20:42:24 -0400] Brad_K: at least, according to the page at https://wiki.opscode.com/display/chef/AMI+List+for+Developers
[2012-04-27 20:42:47 -0400] echiu: bootstrap still failed same error
[2012-04-27 20:43:34 -0400] Brad_K: ami-4b814f22 is no longer one of the officially supported images, according to the current page at https://aws.amazon.com/amazon-linux-ami/
[2012-04-27 20:43:38 -0400] echiu: do you have a AMI which will work for default bootstrap?
[2012-04-27 20:43:41 -0400] flashmanbahadur: Brad_K: my phone has more storage, RAM and cores than a t1.micro =D
[2012-04-27 20:43:47 -0400] paige: is the webui extensible ?
[2012-04-27 20:43:54 -0400] eherot: flashmanbahadur: takes longer to start up, too ;-)
[2012-04-27 20:43:54 -0400] paige: or is it meant to me
[2012-04-27 20:43:56 -0400] paige: err *be
[2012-04-27 20:44:06 -0400] Brad_K: yeah, my phone has 64GB of storage.  i had a laptop a few years ago that had a smaller hard drive.
[2012-04-27 20:44:36 -0400] paige: back then hoes didn't want me
[2012-04-27 20:46:36 -0400] echiu: hello, which AMIs would work with default bootstrap?
[2012-04-27 20:47:39 -0400] Brad_K: echiu: you may need to do some work to build a bootstrap script that will take a base AMI from the list at <https://aws.amazon.com/amazon-linux-ami/>, then do a "yum install " in order to get all the base packages you need, before you can then proceed with a regular chef install.  unfortunately, as Amazon makes changes to their images, it may take a little while for some of the bootstrap scripts to keep up with what all needs to be installed before y
[2012-04-27 20:49:49 -0400] Brad_K: that is, if you're using the official Amazon Linux AMIs.  if you want one of the other AMIs with CentOS, Red Hat, or Ubuntu, the existing bootstrap scripts for EC2 may be sufficient to get you something that will work.  but Amazon controls their own distribution and what is pre-installed there, and we don't have a lot of influence with them, so the best we can do is try to make appropriate updates as soon as we find out that they have broken something e
[2012-04-27 20:50:40 -0400] eherot: echiu: Try this EBS+Ubuntu Oneiric one: http://aws.amazon.com/marketplace/pp/ref=csl_ql_prd?sku=aoc93bxhoebt5prt1wu7qepj
[2012-04-27 20:50:50 -0400] jessicab: echiu - the default is ubuntugems, so anything on that list that says ubuntu gems should work.. amazon linux needs -d fedora13-gems usually, but even that might not work and you might have to build a bootstrap script like brads suggesting
[2012-04-27 20:50:55 -0400] eherot: oops, that would be ami-a4dc0ecd
[2012-04-27 20:51:09 -0400] eherot: pretty sure this is what I based our vanilla image (from which we bootstrap chef) on.
[2012-04-27 20:51:57 -0400] hoover_damn: usage of chef-full makes your life a lot easier
[2012-04-27 20:52:02 -0400] hoover_damn: a/k/a omnibus
[2012-04-27 20:52:58 -0400] echiu: ok, I'll try with the ubuntu image
[2012-04-27 20:53:15 -0400] hoover_damn: ubuntu with the chef-full is always the easiest
[2012-04-27 20:53:45 -0400] paige: what is ctennis
[2012-04-27 20:54:13 -0400] ctennis: male, more than anything I guess
[2012-04-27 20:54:22 -0400] hoover_damn: a person?
[2012-04-27 21:00:14 -0400] echiu: I think the default bootstrap is successful using ubuntu image
[2012-04-27 21:00:26 -0400] echiu: able to see it in 'knife node list'
[2012-04-27 21:02:02 -0400] jstump: Is there a way to make execute inherit the environment of the user it's running as? (Yes, I know about the environment option.)
[2012-04-27 21:08:41 -0400] echiu: thank you all for your help!
[2012-04-27 21:09:06 -0400] eherot: welcome :-)
[2012-04-27 21:13:54 -0400] echiu: when I delete server 'knife ec2 server delete <server>' removes it from AWS, but not the node in hosted chef
[2012-04-27 21:15:25 -0400] eherot: knife node delete <server>
[2012-04-27 21:15:33 -0400] eherot: and then knife client delete <server>
[2012-04-27 21:16:30 -0400] jstump: eherot: So you need to run all three commands?
[2012-04-27 21:16:50 -0400] jstump: (I only ask because I'm going to add this to my init 0 scripts to automatically clean up terminated nodes.)
[2012-04-27 21:16:55 -0400] eherot: if there's a shortcut to that i don't know it
[2012-04-27 21:17:00 -0400] eherot: but they're all kind of separate things
[2012-04-27 21:17:03 -0400] yfeldblum: jstump, try `su --login`
[2012-04-27 21:17:13 -0400] echiu: good question - I was going to script this as well
[2012-04-27 21:17:21 -0400] jstump: yfeldblum: Oh, shit, before the command eh? Sneaky.
[2012-04-27 21:17:34 -0400] jstump: e.g. `su --login -e {command}` (I think it's -e?)
[2012-04-27 21:17:42 -0400] echiu: shouldn't chef auto clean up nodes/client?
[2012-04-27 21:17:57 -0400] yfeldblum: jstump, right, something like that, may also have to pass the user to su
[2012-04-27 21:18:24 -0400] jstump: yfeldblum: Right. I'd assume that it'd run as root if you set user "root", but we'll see.
[2012-04-27 21:20:08 -0400] eherot: echiu: Thing is, there are potentially cases where the node may be off or deleted but where you don't necessarily want to invalidate the client key or the node's settings
[2012-04-27 21:21:04 -0400] mattray: jstump: eherot: http://tickets.opscode.com/browse/KNIFE_EC2-37
[2012-04-27 21:21:15 -0400] mattray: I believe that'll be fixed in the next knife-ec2 release
[2012-04-27 21:21:37 -0400] jstump: eherot: Oh, got it now. 1. Nuke the server from AWS, 2. Nuke the node from Chef (as you may want to bring up a replica if you just did #1), 3. Nuke the client certs so nobody can pretend to be them somehow.
[2012-04-27 21:21:43 -0400] jstump: mattray: Awesome.
[2012-04-27 21:22:10 -0400] eherot: mattray: yeah it would be very if the knife ec2 command at least had an option to kill everything
[2012-04-27 21:22:20 -0400] eherot: We have tons and tons of orphaned nodes
[2012-04-27 21:22:26 -0400] mattray: yeah, me too
[2012-04-27 21:22:36 -0400] mattray: well, tons of orphaned clients
[2012-04-27 21:22:44 -0400] eherot: also cool would be a way to see if a client cert hadn't been used in forever
[2012-04-27 21:22:46 -0400] mattray: knife node bulk delete i-.*
[2012-04-27 21:22:52 -0400] mattray: knife status
[2012-04-27 21:23:23 -0400] jstump: mattray, eherot I'm +1 on both.
[2012-04-27 21:24:03 -0400] eherot: also, deleting a node should probably delete its associated client unless an override is specified
[2012-04-27 21:24:57 -0400] mattray: eherot: I agree, but we might not want to change default behavior without easing people into it
[2012-04-27 21:25:11 -0400] mattray: in case people aren't expecting that behavior
[2012-04-27 21:26:02 -0400] echiu: you guys are thinking same way I'm thinking  [:)
[2012-04-27 21:26:38 -0400] yfeldblum: should either unify nodes & clients or keep them separate; don't have separate nodes & clients but then some operations affect both
[2012-04-27 21:27:51 -0400] echiu: for now I'm using a bash wrapper to call knife ec2 delete, invokes delete on node/client as well
[2012-04-27 21:31:56 -0400] echiu: is there a way to bypass user prompt for delete? I'm scripting it in bash so it ask three time whether I want to delete server/node/client
[2012-04-27 21:32:29 -0400] mattray: yfeldblum: well they're not unified
[2012-04-27 21:32:48 -0400] mattray: nodes have clients, but so do workstations and other consumers of the API
[2012-04-27 21:33:25 -0400] mattray: but I think if we make purge an option and see how people use it, maybe we make that the default behavior in the next next release once we have feedback
[2012-04-27 21:33:48 -0400] mattray: I mean, I know I'll default to using purge
[2012-04-27 21:34:07 -0400] mattray: echiu: add "-y"
[2012-04-27 21:34:35 -0400] echiu: this works for all three delete commands?
[2012-04-27 21:34:50 -0400] mattray: it should
[2012-04-27 21:39:28 -0400] eherot: mattray: perhaps make it so deleting a node deletes a client but not the other way around (since admin clients are not usually nodes)
[2012-04-27 21:40:34 -0400] mattray: eherot: definitely, it would be nodes deleting their clients, the other way is a less common scenario
[2012-04-27 21:40:52 -0400] eherot: yah, and I agree with requiring purge to do it.
[2012-04-27 21:41:05 -0400] mattray: gotta run, later all
[2012-04-27 21:41:11 -0400] eherot: later
[2012-04-27 21:42:57 -0400] echiu: thanks, -y turns off the user prompt
[2012-04-27 21:43:42 -0400] echiu: I'm working on an use case building/tear down thousands of nodes, so if it's not automated it doesn't work
[2012-04-27 21:43:52 -0400] sivy: hm... what's the right way to get the return value of an execute resource (or just running a shell comd) and using it in a recipe?
[2012-04-27 21:44:08 -0400] sivy: foo = `some dm --opts` ?
[2012-04-27 21:44:20 -0400] echiu: thanks again!
[2012-04-27 21:45:02 -0400] carcher: yfeldblum: ours didn't work because the code that dealt with environments was cut out of the ubuntu10.04-gems.erb template (copy)
[2012-04-27 21:59:15 -0400] chson: is the default pw for rabbitmq "testing"?
[2012-04-27 22:01:13 -0400] eherot: chson: not sure but you can change it with rabbitmqctl
[2012-04-27 22:02:31 -0400] chson: eherot: in solr.rb it is "testing", which is the pw I set the chef user to, but it's still failing to connect
[2012-04-27 22:04:10 -0400] chson: motherfucker I should've never changed the fqdn of this server
[2012-04-27 22:04:11 -0400] echiu: knife ssh name:NODENAME -x ubuntu "sudo chef-client"
[2012-04-27 22:04:13 -0400] echiu: FATAL: No nodes returned from search!
[2012-04-27 22:04:26 -0400] echiu: but I see the node when 'knife node list'
[2012-04-27 22:04:43 -0400] eherot: chson: Does it also have permissions on the /chef vhost?
[2012-04-27 22:04:43 -0400] eherot: rabbitmqctl list_permissions -p /chef
[2012-04-27 22:05:23 -0400] chson: [root@chef1 ~]# rabbitmqctl list_permissions -p /chef
[2012-04-27 22:05:23 -0400] chson: Listing permissions in vhost "/chef" ...
[2012-04-27 22:05:23 -0400] chson: ...done.
[2012-04-27 22:05:32 -0400] eherot: yeah that's not right
[2012-04-27 22:05:56 -0400] chson: eherot: ok that's good to know
[2012-04-27 22:05:59 -0400] eherot: rabbitmqctl set_permissions -p /chef chef ".*" ".*" ".*"
[2012-04-27 22:06:23 -0400] eherot: dunno if it actually requires configure access but that's how ours is set up
[2012-04-27 22:07:06 -0400] chson: eherot: that actually worked.  thanks!
[2012-04-27 22:07:39 -0400] eherot: chson: welcome :-)
[2012-04-27 22:08:11 -0400] chson: eherot: the sad thing is I actually tried setting the perms before but must've fucked it up
[2012-04-27 22:08:49 -0400] chson: yesss now I finally have a new validation.pem
[2012-04-27 22:08:52 -0400] eherot: chson: Thankfully my last few weeks of unrelated rabbitmq setup hacking has finally paid off, heh
[2012-04-27 22:09:58 -0400] echiu: any ideas about sudo chef-client fails?
[2012-04-27 22:10:35 -0400] chson: echiu: try chef-client with verbose flags
[2012-04-27 22:10:41 -0400] eherot: echiu: can you paste the whole output (if it's not tooooo long)?
[2012-04-27 22:12:13 -0400] echiu: CDL-00005:chef-repo eric$ knife node list
[2012-04-27 22:12:14 -0400] echiu: cheftest1
[2012-04-27 22:12:15 -0400] echiu: CDL-00005:chef-repo eric$ knife ssh name:cheftest1 -x ubuntu "sudo chef-client"
[2012-04-27 22:12:16 -0400] echiu: FATAL: No nodes returned from search!
[2012-04-27 22:15:46 -0400] chson: no idea I never use knife ssh
[2012-04-27 22:16:13 -0400] erikh: hm
[2012-04-27 22:16:32 -0400] erikh: echiu: what does knife node show cheftest1 | grep name say?
[2012-04-27 22:16:39 -0400] erikh: shouldn't be different, but i'm curious
[2012-04-27 22:16:46 -0400] luckymike: try added node
[2012-04-27 22:16:49 -0400] luckymike: adding
[2012-04-27 22:16:55 -0400] luckymike: knife ssh node "name:...
[2012-04-27 22:17:57 -0400] luckymike: err no
[2012-04-27 22:18:06 -0400] luckymike: knife ssh "name:cheftest1"
[2012-04-27 22:18:51 -0400] erikh: right, but that's failing for him.
[2012-04-27 22:19:47 -0400] echiu: ok, I'm bypassing this issue for now by directing ssh to the box
[2012-04-27 22:20:23 -0400] erikh: for a single node that makes the most sense.
[2012-04-27 22:20:27 -0400] echiu: running 'sudo chef-client' seems to work
[2012-04-27 22:20:49 -0400] erikh: right.
[2012-04-27 22:21:00 -0400] erikh: ssh $host 'sudo chef-client' should get you where you need to be
[2012-04-27 22:21:09 -0400] echiu: but I need to get it to work from knife, since I prefer to script it that way
[2012-04-27 22:21:24 -0400] erikh: right. can you try that command I threw at you earlier/
[2012-04-27 22:21:26 -0400] echiu: I see
[2012-04-27 22:22:05 -0400] echiu: knife ssh "name:cheftest1"
[2012-04-27 22:22:06 -0400] echiu: WARNING: Failed to connect to node[cheftest1] -- SocketError: getaddrinfo: nodename nor servname provided, or not known
[2012-04-27 22:22:23 -0400] erikh: ok, that's different
[2012-04-27 22:22:35 -0400] hoover_damn: echiu, before usage of 0.10.10.rc you have to specify -a and then tell it what attribute to use for the ip
[2012-04-27 22:22:41 -0400] hoover_damn: echiu, such as -a ipaddress
[2012-04-27 22:22:53 -0400] erikh: unless fqdn is set properly
[2012-04-27 22:23:00 -0400] hoover_damn: or ec2.public_hostname
[2012-04-27 22:23:09 -0400] hoover_damn: erikh, i'm assuming fqdn is not set properly
[2012-04-27 22:23:18 -0400] hoover_damn: erikh, as that is a constant
[2012-04-27 22:23:19 -0400] erikh: yeah, me too, but he could always recipe that up
[2012-04-27 22:23:24 -0400] erikh: we did.
[2012-04-27 22:23:40 -0400] hoover_damn: I haven't
[2012-04-27 22:23:41 -0400] eherot: echiu: On the node
[2012-04-27 22:23:47 -0400] eherot: shef -z -c /etc/chef/client.rb
[2012-04-27 22:23:53 -0400] eherot: then node[:fqdn] and see what it sayas
[2012-04-27 22:23:54 -0400] eherot: *says
[2012-04-27 22:24:02 -0400] hoover_damn: this box here is split brain... fqdn is not it's ptr
[2012-04-27 22:24:02 -0400] eherot: and/or node[:ipaddress]
[2012-04-27 22:24:17 -0400] erikh: or you could just knife node show | grep -E 'fqdn|ipaddress'
[2012-04-27 22:24:20 -0400] hoover_damn: so that's my fault
[2012-04-27 22:24:21 -0400] hoover_damn: hehe
[2012-04-27 22:24:35 -0400] erikh: you don't need to run shef or be on the box at all to get at that info.
[2012-04-27 22:24:42 -0400] eherot: erikh: oh yeah or that ;-)
[2012-04-27 22:25:17 -0400] erikh: anyhow, an incorrect fqdn is the source of the problem, almost definitely. how you deal with it, well you've seen a variety of options.
[2012-04-27 22:30:45 -0400] timsmith: is there any longterm roadmap to get hardware detection into Ohai
[2012-04-27 22:30:58 -0400] timsmith: like vendor and/or model detection
[2012-04-27 22:31:34 -0400] hoover_damn: timsmith, RE OHAI-267?
[2012-04-27 22:32:19 -0400] hoover_damn: timsmith, I'd love to hear it myself as I kind of care passionately about this problem
[2012-04-27 22:32:49 -0400] hoover_damn: I just had to uninstall ohai master as ohai-267's fix.. well ohai's just throwing nulls
[2012-04-27 22:59:04 -0400] nect: is there a node variable that outputs the chef environment?
[2012-04-27 22:59:58 -0400] miah: node.chef_environment
[2012-04-27 23:04:50 -0400] paige: is there any documentation on how I might use curl to do searches against chef-solr ?
[2012-04-27 23:05:13 -0400] paige: like if I have a php script for example and I want to search out all of my mysql servers by role
[2012-04-27 23:05:42 -0400] paige: so that php script can just go through the list of servers managed by chef and connect to the mysql instance
[2012-04-27 23:10:15 -0400] nect: thx miah
[2012-04-27 23:31:07 -0400] yfeldblum: paige, you can read through the source code https://github.com/opscode/chef/tree/master/chef, but be aware that there's tricky authentication & signing to deal with
[2012-04-27 23:52:57 -0400] echiu: when I update recipes in my chef-repo, it is not showing up when I sudo chef-client
