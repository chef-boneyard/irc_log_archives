[2012-07-27 00:00:29 -0400] coderanger: Hah, this is exactly the use case for the LWRPs :-)
[2012-07-27 00:00:42 -0400] coderanger: If you want to get fancy, you could even use the aws gem to fill in the DB info I bet!
[2012-07-27 00:01:07 -0400] chrisstreeter: yeah, i was thinking about that
[2012-07-27 00:01:33 -0400] coderanger: That would be pretty sexy, would be happy to help when I'm done yelling at JS :)
[2012-07-27 00:01:54 -0400] tolland: slantview: centos here
[2012-07-27 00:02:05 -0400] coderanger: afk for a few
[2012-07-27 00:02:26 -0400] ampledata: chrisstreeter: i just finished rolling out a django app with the application_python cookbook, there's been a bunch of fixes that have gone in this week
[2012-07-27 00:03:05 -0400] chrisstreeter: cool. i just downloaded the latest version from the opscode-cookbooks repo. that should have them in it?
[2012-07-27 00:03:09 -0400] tolland: i want to set a node attribute locally on that node from a bash prompt
[2012-07-27 00:03:13 -0400] tolland: im doing something like;
[2012-07-27 00:03:14 -0400] tolland: knife exec -E "nodes.find(:name => '$(hostname)') {|n| n.set['cookbook']['someval'] = '1' ; n.save }"
[2012-07-27 00:03:38 -0400] tolland: is there something like well... simpler
[2012-07-27 00:04:16 -0400] ampledata: chrisstreeter: latest is here: https://github.com/opscode-cookbooks/application_python
[2012-07-27 00:04:33 -0400] chrisstreeter: ampledata: yeah, thats the one I just pulled from
[2012-07-27 00:04:38 -0400] ampledata: good2go
[2012-07-27 00:05:56 -0400] chrisstreeter: whats the best way to make sure that my cookbooks are getting bug fixes? should I add the recipes as submodules of my cookbooks repo?
[2012-07-27 00:06:11 -0400] ampledata: i've been using librarian for that
[2012-07-27 00:06:26 -0400] ampledata: you can specify a cookbook source as the community site or a github repo
[2012-07-27 00:06:36 -0400] ampledata: https://github.com/applicationsonline/librarian
[2012-07-27 00:09:54 -0400] chrisstreeter: ampledata or coderanger, for a new django app, should I create a recipe inside the application_python cookbook, and then configure it like https://github.com/opscode-cookbooks/application_python/blob/master/examples/recipes-packaginator.rb ?
[2012-07-27 00:10:05 -0400] ampledata: create a new cookbook
[2012-07-27 00:10:08 -0400] chrisstreeter: ok
[2012-07-27 00:10:20 -0400] ampledata: i think that's covered in the 'application' cookbook readme
[2012-07-27 00:10:37 -0400] chrisstreeter: so you just create an "appname" cookbook that has a default recipe that looks like the example i just linked to
[2012-07-27 00:10:48 -0400] ampledata: https://github.com/opscode-cookbooks/application
[2012-07-27 00:11:03 -0400] chrisstreeter: ah, got it
[2012-07-27 00:11:06 -0400] chrisstreeter: cool, thanks
[2012-07-27 00:11:10 -0400] ampledata: https://github.com/opscode-cookbooks/application#usage
[2012-07-27 00:11:11 -0400] ampledata: usage --^
[2012-07-27 00:12:20 -0400] aslan: hi chefs ...
[2012-07-27 00:12:47 -0400] aslan: when upgrading to chef 0.10 is it better to use the gem method or apt-get method?
[2012-07-27 00:15:57 -0400] ampledata: i used the apt-get method because I'd previously installed from apt
[2012-07-27 00:16:22 -0400] ampledata: ensure you've got the opscode 10 apt repo added as a source
[2012-07-27 00:16:42 -0400] aslan: ampledata: i used gem before... so i am wondering if using the apt is right way to go
[2012-07-27 00:16:45 -0400] ampledata: as opposed to the older pre-10 repos
[2012-07-27 00:16:53 -0400] ampledata: ah ok
[2012-07-27 00:17:36 -0400] ampledata: http://wiki.opscode.com/display/chef/Upgrading+Chef+0.9.x+to+Chef+10.x
[2012-07-27 00:17:56 -0400] aslan: ampledata: doesn't say anything about that
[2012-07-27 00:18:01 -0400] ampledata: true
[2012-07-27 00:18:01 -0400] hoover_damm: aslan, finally updating? huzzah!
[2012-07-27 00:18:20 -0400] aslan: hoover_damm: lol... i might be the last user to upgrade :P
[2012-07-27 00:18:45 -0400] aslan: i just did upgrade a test environment using apt and i am seeing strange stuff
[2012-07-27 00:18:50 -0400] aslan: knife status is not showing anything
[2012-07-27 00:18:55 -0400] aslan: but knife nodes shows the list
[2012-07-27 00:19:13 -0400] aslan: my /etc/chef/server.rb and client.rb are empty
[2012-07-27 00:19:39 -0400] aslan: and when i do a knife cookbook show list i get a long list of cookbooks that i am sure i did not install . so i am not sure what is going on
[2012-07-27 00:22:23 -0400] qhartman: I have need to set private and public keys on various nodes to allow automated SSH shenanigans between them. The trick is that I want every pair of servers to use a unique keypair  to prevent accidental connections to the wrong server.
[2012-07-27 00:22:46 -0400] qhartman: Right now my solution is the have the "master" node generate a keypair and then save the public key into an attirbute.
[2012-07-27 00:23:03 -0400] qhartman: The slave then copies that key down into it's authorized_keys file.
[2012-07-27 00:23:22 -0400] qhartman: it works, but it's clunky and requires multiple chef runs in a particular order to get going
[2012-07-27 00:23:28 -0400] qhartman: Anyone have a better idea?
[2012-07-27 00:23:37 -0400] aslan: qhartman: i dont know if its worth it now but i used poolparty . which creates a new keypair for every role
[2012-07-27 00:24:03 -0400] anthroprose: qhart: some of the user cookbooks do the same thing you are refering to (keygen, pass through attributes to clients/slaves)
[2012-07-27 00:24:17 -0400] aslan: the problem is its an old gem that has no recent commits . but does this one thing really well
[2012-07-27 00:24:44 -0400] qhartman: aslan, I really need each pair of servers to be unique, and I will have multiple pairs using the same roles, so I don't think that will work. Thanks for the suggestion though.
[2012-07-27 00:25:17 -0400] anthroprose: thanks for yetanotherframework for deploying
[2012-07-27 00:26:03 -0400] anthroprose: I hope mine never gets big enough to warrant releasing it to others heh
[2012-07-27 00:26:03 -0400] qhartman: anthroprose, so it sounds like I may have already hit the best answer at this point?
[2012-07-27 00:26:16 -0400] anthroprose: qhart: well its the easiest to implement
[2012-07-27 00:26:49 -0400] anthroprose: im trying to wrap my brain around how else to do it... but admittidly my chef usage is less than midlevel
[2012-07-27 00:26:54 -0400] qhartman: anthroprose, what would be a better solution, even if it's harder
[2012-07-27 00:27:33 -0400] anthroprose: you could add your own provider, that hands out keypairs
[2012-07-27 00:27:43 -0400] qhartman: anthroprose, yeah, I've been chewing on this for weeks and I haven't been able to come up with anything that doesn't require either human intervention or a "chef-client shuffle" of at least two runs.
[2012-07-27 00:28:14 -0400] anthroprose: I am just not starting to use triggers & such to make things more event based
[2012-07-27 00:28:18 -0400] anthroprose: not=now
[2012-07-27 00:28:55 -0400] qhartman: Interesting idea.... How would it hand out pair halves to different servers? How would the servers know which pair to get?... It seems it would store them in a databag... hmm, I don't think it would really buy anything
[2012-07-27 00:29:13 -0400] qhartman: It becomes a race condition
[2012-07-27 00:29:48 -0400] anthroprose: you would still have to do your original master -> slave keypair... and use it to dump all of the pair'd offerings to the client/server
[2012-07-27 00:30:19 -0400] anthroprose: but yeah, both would have to exist at that point
[2012-07-27 00:30:39 -0400] qhartman: right
[2012-07-27 00:30:47 -0400] anthroprose: statemachine outside of chef.... or use the update triggers...
[2012-07-27 00:31:10 -0400] anthroprose: which is essentially one of the things alot of these frameworks are trying to solve
[2012-07-27 00:31:13 -0400] anthroprose: holding state outside of chef
[2012-07-27 00:31:26 -0400] anthroprose: at least thats the only reason ive had to write code
[2012-07-27 00:31:50 -0400] qhartman: even if we were able to do that, how would each node know which half of the key it should be getting?
[2012-07-27 00:32:02 -0400] qhartman: What's the need driving the desire to hold state outside of chef?
[2012-07-27 00:32:07 -0400] anthroprose: thats what the provider would do... you feed it 2 node names
[2012-07-27 00:32:21 -0400] anthroprose: and it would make two pairs and hand out the private+other public
[2012-07-27 00:33:03 -0400] anthroprose: assuming both nodes are active.. but since your using attributes... it may only need to have begun exisiting.. not actually be 100% provisioned..
[2012-07-27 00:33:21 -0400] qhartman: ah, right. so it would essentially be replacing one of my chef runs with a "priming" step of building the keypair.
[2012-07-27 00:33:59 -0400] anthroprose: I'm facing similar things with mysql replication
[2012-07-27 00:34:06 -0400] anthroprose: the slave *always* finishes first
[2012-07-27 00:34:35 -0400] anthroprose: its a solved problem... but im trying to figure it out so I learn
[2012-07-27 00:34:37 -0400] qhartman: heh, yeah, I'm doing this for postgres replication and pgpool fail over
[2012-07-27 00:35:06 -0400] anthroprose: so check out the mysql rep cookbooks... cause they use update tricks to let the other nodes know stuff has happened
[2012-07-27 00:35:21 -0400] qhartman: I have it working, but it feels clunky, c-c the master, c-c the slave, c-c the master again, start postgres on the slave
[2012-07-27 00:35:24 -0400] qhartman: it's janky
[2012-07-27 00:35:38 -0400] anthroprose: wait till you throw a reboot into the process
[2012-07-27 00:35:38 -0400] anthroprose: heh
[2012-07-27 00:35:45 -0400] qhartman: will do
[2012-07-27 00:36:22 -0400] anthroprose: business hours is way more active in here... CST usually
[2012-07-27 00:36:30 -0400] qhartman: yeah
[2012-07-27 00:36:37 -0400] qhartman: I'm in here all day more often than not
[2012-07-27 00:37:00 -0400] qhartman: lurking for useful snippets
[2012-07-27 00:37:09 -0400] anthroprose: I've saved DAYS of work
[2012-07-27 00:37:16 -0400] qhartman: helping where I can, asking when needed
[2012-07-27 00:37:18 -0400] qhartman: likewise
[2012-07-27 00:37:30 -0400] anthroprose: yeah... I try not to spew too much because I know I *may* be wrong..
[2012-07-27 00:37:32 -0400] qhartman: especially since I came to chef w/o any ruby background I've had a lot to absorb
[2012-07-27 00:37:44 -0400] anthroprose: same... I'm a php guy coming from perl
[2012-07-27 00:37:48 -0400] qhartman: yeah I pretty much keep my mouth shut unless I'm damn near positive I'm right
[2012-07-27 00:38:20 -0400] qhartman: Python and Bash mostly here, though I'm definitely mostly an "ops" rather than a "dev".
[2012-07-27 00:40:45 -0400] anthroprose: so I'm assuming your wanting a notifies/subscribes setup.. but I personally havn't fully implemented one yet
[2012-07-27 00:41:06 -0400] anthroprose: but I dont know if you can do it across nodes, not just within the same cookbook...
[2012-07-27 00:41:20 -0400] qhartman: Yeah, I'm pretty sure that doesn't work across nodes
[2012-07-27 00:41:31 -0400] qhartman: would be pimp if it did though
[2012-07-27 00:41:40 -0400] anthroprose: one of the first things I would want to use it for
[2012-07-27 00:41:40 -0400] anthroprose: heh
[2012-07-27 00:42:02 -0400] anthroprose: but I'm also 100% VPC... which is janky supported unless you have direct routes to the machines
[2012-07-27 00:42:10 -0400] anthroprose: also why I've had to write code
[2012-07-27 00:42:16 -0400] qhartman: have one chef run just wait until the key has been published, then sets it up, meanwhile the other server is waiting for it to be in place to start the copy....
[2012-07-27 00:42:34 -0400] qhartman: Yeah, we've been talking about doing some VPC stuff, but haven't taken the plunge yet
[2012-07-27 00:42:45 -0400] anthroprose: I would generate the pairs outside of chef, and have a pile of them sitting in a queue of some sort that it just plucks off
[2012-07-27 00:42:45 -0400] qhartman: We're still just standard AWS
[2012-07-27 00:42:56 -0400] anthroprose: VPC is the shit
[2012-07-27 00:43:01 -0400] anthroprose: but you loose disposable micros
[2012-07-27 00:43:16 -0400] qhartman: Yeah, I get nervous about stuff liek that, I don't like having private keys just hanging around
[2012-07-27 00:43:19 -0400] anthroprose: but you can run multicast safely among other things...
[2012-07-27 00:43:28 -0400] qhartman: yeah, I think that would be a fair trade
[2012-07-27 00:43:49 -0400] anthroprose: if you do this inside a VPC... it can all be firewalled
[2012-07-27 00:43:53 -0400] qhartman: and have a reasonable way to setup HA heartbeats and whatnot w/o relying AWS API to reassign EIPs and whatnot
[2012-07-27 00:43:59 -0400] anthroprose: not that condones priv key stores in redis
[2012-07-27 00:43:59 -0400] anthroprose: heh
[2012-07-27 00:44:16 -0400] qhartman: yeah, I'm paranoid though, I still wouldn't want to approach it that way
[2012-07-27 00:44:39 -0400] ttilley: there's a cookbook out there that abuses the shit out of data bags as a synchronization primitive to do rolling restarts. if it can be used for one task, why not another? hacky as hell though. https://github.com/websterclay/chef-dominodes
[2012-07-27 00:44:52 -0400] anthroprose: heyO there we go
[2012-07-27 00:45:06 -0400] anthroprose: cute name
[2012-07-27 00:45:29 -0400] anthroprose: at least I was right about the provider route
[2012-07-27 00:45:44 -0400] qhartman: hah, that's awesome
[2012-07-27 00:45:50 -0400] qhartman: I'm going to have to dig into that
[2012-07-27 00:46:11 -0400] anthroprose: all you have to do is preference the order of the domino somehow
[2012-07-27 00:46:17 -0400] anthroprose: and then you get linear master slave stuff
[2012-07-27 00:46:19 -0400] qhartman: right
[2012-07-27 00:46:25 -0400] qhartman: >_>
[2012-07-27 00:46:27 -0400] qhartman: <_<
[2012-07-27 00:46:35 -0400] qhartman: looks promising
[2012-07-27 00:46:55 -0400] anthroprose: and you can use encrypted databags now
[2012-07-27 00:47:01 -0400] anthroprose: so with some luck, it may work
[2012-07-27 00:49:39 -0400] qhartman: indeed
[2012-07-27 02:04:06 -0400] hoover_damm: anyone deal with numa? know a lame way to detect if your box has numa
[2012-07-27 02:04:12 -0400] hoover_damm: short of checking the mobo
[2012-07-27 02:08:14 -0400] hoover_damm: nm, File.exists?("/sys/devices/system/node/node1/")
[2012-07-27 02:08:25 -0400] hoover_damm: would be neat if ohai knew this
[2012-07-27 02:08:39 -0400] hoover_damm: but i can't blame it because short of grepping /proc/meminfo
[2012-07-27 02:54:47 -0400] masterkorp: hello, anyone with some time for a tricky problem ?
[2012-07-27 02:55:19 -0400] masterkorp: http://pastie.org/4340287
[2012-07-27 02:55:25 -0400] masterkorp: here is the problem
[2012-07-27 02:56:57 -0400] masterkorp: http://pastie.org/4340293
[2012-07-27 02:57:05 -0400] masterkorp: here is the relevant data
[2012-07-27 02:57:20 -0400] masterkorp: aparently i can not use require inside a ruby block ?
[2012-07-27 02:58:48 -0400] cwj: maybe it needs to be collected during the compilation phase of the chef run
[2012-07-27 02:59:03 -0400] cwj: so it would need to be outside a resource
[2012-07-27 02:59:06 -0400] masterkorp: why it is nor ?
[2012-07-27 02:59:29 -0400] cwj: it being the require statement
[2012-07-27 02:59:34 -0400] cwj: just a guess
[2012-07-27 03:00:12 -0400] cwj: then again
[2012-07-27 03:00:21 -0400] cwj: is your paste correct?
[2012-07-27 03:00:26 -0400] masterkorp: yes
[2012-07-27 03:00:31 -0400] cwj: the last line shows many spaces in the method name
[2012-07-27 03:00:38 -0400] cwj: `    require'
[2012-07-27 03:00:46 -0400] cwj: that would usually be `require`
[2012-07-27 03:00:53 -0400] masterkorp: yeah, but there is not white space
[2012-07-27 03:01:28 -0400] cwj: gonna have to show us your homework
[2012-07-27 03:02:28 -0400] masterkorp: ok, my boos just decided to remove it
[2012-07-27 03:02:38 -0400] masterkorp: gona study later
[2012-07-27 03:06:01 -0400] jberanek: You can put the require statement outside of the resource, and it should work. I have an example I built a few days ago where I required the csv library at the top of a recipe, then called via a ruby_block
[2012-07-27 05:14:31 -0400] siezer: wii kallistec
[2012-07-27 06:19:10 -0400] BryanWB_: ohai chefs!
[2012-07-27 09:01:25 -0400] maruq: morning chefers
[2012-07-27 09:01:32 -0400] maruq: happy sysadmin day
[2012-07-27 09:02:42 -0400] lflux: happy sysadmin day to you too
[2012-07-27 09:03:09 -0400] lflux: my colleagues unexpectedly gave me a present for today
[2012-07-27 09:05:12 -0400] maruq: lflux: nice! mine were like "wtf is sysadmin day?"
[2012-07-27 09:05:17 -0400] maruq: next year ;)
[2012-07-27 09:05:39 -0400] lflux: I totally forgot about it and when I came to my desk this morning there was a limited edition 10% ale on it
[2012-07-27 09:06:01 -0400] cpasmoi: happy sysadmin day
[2012-07-27 09:06:10 -0400] erikh: happy happt
[2012-07-27 09:06:13 -0400] erikh: happy too
[2012-07-27 09:06:14 -0400] cpasmoi: :p
[2012-07-27 09:06:46 -0400] maruq: lflux: nice!
[2012-07-27 09:08:29 -0400] cpasmoi: damn, it's too hot in here, i want a beer
[2012-07-27 09:13:37 -0400] cpasmoi: have you tested apache2 chef cookbook on RHEL/CentOS ?
[2012-07-27 09:14:33 -0400] cpasmoi: I need to install Wordpress with an existing chef server, but it uses its own "apache" cookbook, written by the former sysadmin, without apache_site and web_app function
[2012-07-27 11:04:58 -0400] sampikesley: I think I might be doing something dumb
[2012-07-27 11:04:59 -0400] sampikesley: But
[2012-07-27 11:05:02 -0400] sampikesley: FATAL: Errno::ENOENT: No such file or directory - file not found '/tmp/encrypted_data_bag_secret'
[2012-07-27 11:05:14 -0400] sampikesley: I don't understand why it's looking there
[2012-07-27 11:09:38 -0400] cnf: lhmm
[2012-07-27 11:09:46 -0400] cnf: installing -server on centos is a drag :P
[2012-07-27 11:28:54 -0400] cnf: hmz
[2012-07-27 11:28:57 -0400] cnf: :(
[2012-07-27 11:29:35 -0400] sampikesley: do you have the option to use something debian-ish?
[2012-07-27 11:30:35 -0400] cnf: no, company uses centos
[2012-07-27 11:35:28 -0400] thom: cnf: use omnibus
[2012-07-27 11:36:19 -0400] cnf: thom: should i uninstall everything i have installed first?
[2012-07-27 11:38:54 -0400] cnf: mz
[2012-07-27 11:39:08 -0400] cnf: thom: also, how do you start it when installing it with the omnibus?
[2012-07-27 11:39:44 -0400] cnf: wait, hmm
[2012-07-27 11:39:51 -0400] cnf: maybe i'm using the wrong package
[2012-07-27 11:40:33 -0400] cnf: thom: where is this omnibus?
[2012-07-27 11:41:02 -0400] thom: i might have lead you up the garden path, sorry. can't now find the chef server omnibus pacakges
[2012-07-27 11:41:20 -0400] cnf: hmz
[2012-07-27 11:43:19 -0400] cnf: i find the install docs not all that clea
[2012-07-27 11:43:21 -0400] cnf: r
[2012-07-27 11:44:21 -0400] cnf: trying to follow http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually
[2012-07-27 11:47:53 -0400] cnf: hmz :/ wt
[2012-07-27 11:48:29 -0400] cnf: are there any init scripts, at all?
[2012-07-27 11:50:20 -0400] cnf: ok, this isn't working
[2012-07-27 11:53:28 -0400] cnf: grr
[2012-07-27 11:58:44 -0400] cnf: ok, i think i got something working...
[2012-07-27 12:50:32 -0400] draiken: I am very new to chef, I just created a role and assigned to a node, how do I make it actually run the recipes from that role?
[2012-07-27 12:51:27 -0400] cnf: draiken: did you include the recipe in the role?
[2012-07-27 12:51:43 -0400] draiken: yes, I did
[2012-07-27 12:52:01 -0400] cnf: then if your node has the role assigned, the recipe should run
[2012-07-27 12:53:01 -0400] draiken: should I see any output of that when I assign the role to the node?
[2012-07-27 12:53:57 -0400] cnf: your explanation is a bit light on details for me
[2012-07-27 12:54:14 -0400] cnf: draiken: are you using chef solo, or -hosted?
[2012-07-27 12:54:17 -0400] draiken: k, I'm creating a little gist to show what I have
[2012-07-27 12:54:34 -0400] ssd7: draiken: Note that Chef isn't a "Push" system, so you need to run chef-client on your node for anything to happen.
[2012-07-27 12:55:00 -0400] cnf: indeed ^^;
[2012-07-27 12:55:07 -0400] draiken: ssd7: I must connect to it and run chef-client?
[2012-07-27 12:55:55 -0400] draiken: nice, that was it
[2012-07-27 12:56:27 -0400] draiken: so, I can't trigger the chef-client from knife?
[2012-07-27 12:57:31 -0400] ssd7: draiken: Well, the exact command will depend on your setup, but `knife ssh` allows you to execute commands accross groups of your nodes easily
[2012-07-27 12:57:58 -0400] ssd7: So, something like knife ssh 'role:appservers' 'sudo chef-client' would run it on all your appservers
[2012-07-27 12:58:05 -0400] draiken: ssd7: I see, thank you I am reading through the docs but the information is very scattered
[2012-07-27 13:00:27 -0400] cnf: it is
[2012-07-27 13:00:56 -0400] cnf: though i seem to have managed to get chef-server running on centos
[2012-07-27 13:01:05 -0400] cnf: now i need some sort of init scripts ^^;
[2012-07-27 13:02:19 -0400] ssd7: No problem, you might find the graph here helpful http://wiki.opscode.com/display/chef/Architecture+Introduction we know the documentation can be hard to consume.  We've recently been able to dedicate more resources to the problem, but as you might imagine it might be a while until we reap any rewards from their effors
[2012-07-27 13:03:35 -0400] cnf: or not working...
[2012-07-27 13:04:25 -0400] cnf: hmm, wt?
[2012-07-27 13:04:49 -0400] cnf:  can do a cookbook list
[2012-07-27 13:05:05 -0400] cnf: but a cookbook upload gives me a connection refused
[2012-07-27 13:06:23 -0400] ssd7: cnf: Might use debug logging to see what call you're getting connection refused on.
[2012-07-27 13:07:20 -0400] cnf: right, if i can find how to turn on debug again ^^;
[2012-07-27 13:08:48 -0400] cnf: 'm confused
[2012-07-27 13:08:48 -0400] cnf: https://gist.github.com/3187832
[2012-07-27 13:09:01 -0400] cnf: that sais it's trying to upload to localhost
[2012-07-27 13:09:21 -0400] cnf: but i don't have localhost in my knife.rb, and my server see requests ( i think)
[2012-07-27 13:09:54 -0400] ssd7: Hrm, I /think/ this is probably some config on your server actually.
[2012-07-27 13:10:11 -0400] cnf: ok...
[2012-07-27 13:10:29 -0400] cnf: i'm using nginx to proxy http to localhost:4000
[2012-07-27 13:10:35 -0400] cnf: https*
[2012-07-27 13:10:47 -0400] ssd7: When you upload, you first make a call with all the checksums in your local repo, we then send back a list of the ones that we actually want with the location to upload them to
[2012-07-27 13:11:11 -0400] cnf: hmm
[2012-07-27 13:11:20 -0400] cnf: and it uses chef_server_url to see where it needs to send?
[2012-07-27 13:13:44 -0400] cnf: hmm, i changed chef_server_url, it's still doing it
[2012-07-27 13:14:43 -0400] cnf: ssd7: i just followed the docs at http://wiki.opscode.com/display/chef/Installing+Chef+Server+Manually
[2012-07-27 13:15:04 -0400] ssd7: cnf: If you're refering to chef_server_url on the client (knife) side, that's expected.  The location to upload it to is being created on the server-side using merb's absolute_path function.  Trying to see what knob you have to turn to get that to generate the right link.
[2012-07-27 13:15:19 -0400] cnf: no, i set it in /etc/chef/server.rb
[2012-07-27 13:16:19 -0400] ssd7: Did you restart the services?
[2012-07-27 13:18:21 -0400] cnf: well, i have no init scripts yet, but yes, i killed it, and restarted chef-server
[2012-07-27 13:22:14 -0400] ssd7: cnf: And you're still getting localhost in the urls used for uploading?
[2012-07-27 13:22:18 -0400] cnf: yep
[2012-07-27 13:27:40 -0400] bencaron: is there a clean quick-way to modify a file content?
[2012-07-27 13:27:47 -0400] bencaron: i'm adapting a recipes for windows
[2012-07-27 13:28:07 -0400] bencaron: and the executable i used on linux is not there...
[2012-07-27 13:28:14 -0400] bencaron: so I have to do it fully in ruby
[2012-07-27 13:28:48 -0400] bencaron: I guess it's simpler to use File and co., open the file, gsub it, etc.
[2012-07-27 13:29:03 -0400] bencaron: the file resource only manage the whole of the content, right?
[2012-07-27 13:30:02 -0400] bencaron: fabric has contrib.files.sed: any equivalent?
[2012-07-27 13:30:29 -0400] cnf: ssd7: haha, are you as baffled as I am? ^^;
[2012-07-27 13:30:51 -0400] ashb: bencaron: template or file resources
[2012-07-27 13:30:54 -0400] ashb: or do you mean modify in place?
[2012-07-27 13:31:01 -0400] bencaron: yep, i need to modify it in place
[2012-07-27 13:31:17 -0400] bencaron: because the file may have been modified by something else
[2012-07-27 13:31:26 -0400] bencaron: it's a zend server config file
[2012-07-27 13:31:39 -0400] bencaron: so the management gui may have changed something else
[2012-07-27 13:31:43 -0400] Bittarman: RUN!
[2012-07-27 13:31:52 -0400] Bittarman: stop using zend server :P
[2012-07-27 13:31:58 -0400] bencaron: i just need to make sure the license and eula and al is ok
[2012-07-27 13:31:59 -0400] Bittarman: its just apache + php + mysql...
[2012-07-27 13:32:01 -0400] bencaron: well, not my call.. :D
[2012-07-27 13:32:26 -0400] bencaron: it does have the nice effect of making sure we do have the same php accross platforms
[2012-07-27 13:32:42 -0400] Bittarman: as long as you all keep updating it :)
[2012-07-27 13:32:54 -0400] bencaron: hep, as you guess, that the problem now.. :)
[2012-07-27 13:33:00 -0400] bencaron: hence the chef configuration.. :)
[2012-07-27 13:33:23 -0400] Bittarman: well, since you're solving it with chef, just install apache + php + mysql for people instead.
[2012-07-27 13:33:35 -0400] Bittarman: less problems to solve then.
[2012-07-27 13:33:43 -0400] Bittarman: simple system = less to go wrong :)
[2012-07-27 13:33:54 -0400] bencaron: on windows, it is actually simpler with zend
[2012-07-27 13:34:00 -0400] bencaron: just one fat binary to run
[2012-07-27 13:34:07 -0400] bencaron: and everything is set
[2012-07-27 13:34:14 -0400] ssd7: cnf: A bit, what do your proxy settings look like?
[2012-07-27 13:34:46 -0400] Bittarman: zend server throws in an extra lighttpd daemon to the mix, and a bunch of non-standard config paths, a dodgy debugger, and a zend extension manager which won't really work with any extensions that are not shipped with zend server.
[2012-07-27 13:34:55 -0400] Bittarman: so good luck using anything from pecl that you might need
[2012-07-27 13:35:06 -0400] bencaron: i was just surprised to see that the little utilities used for eula and license are not there on windows only
[2012-07-27 13:35:13 -0400] bencaron: but yes
[2012-07-27 13:35:22 -0400] bencaron: you'r right
[2012-07-27 13:35:23 -0400] Bittarman: oh, and it turns on that java bridge by default... which eats performance.
[2012-07-27 13:35:32 -0400] Bittarman: and chances are, you're not using it.
[2012-07-27 13:35:43 -0400] bencaron: I have it configured with apache at least
[2012-07-27 13:35:54 -0400] bencaron: java bridge is off :)
[2012-07-27 13:36:05 -0400] Bittarman: only thing its good for.. making someone else fix stuff. use their support for everything :)
[2012-07-27 13:36:06 -0400] bencaron: but pecl is a problem too
[2012-07-27 13:36:16 -0400] bencaron: well, even then
[2012-07-27 13:36:23 -0400] Bittarman: no, the lighttpd daemon is for the web control panel.
[2012-07-27 13:36:44 -0400] bencaron: when you just crash weirdly, they can't do that much neither
[2012-07-27 13:39:17 -0400] cnf: ssd7: https://gist.github.com/3188091
[2012-07-27 13:39:42 -0400] cnf: ssd7: mind, that domain name doesn't exist to the outside world
[2012-07-27 13:39:51 -0400] cnf: ell, the sub domain doesn't
[2012-07-27 13:41:06 -0400] ssd7: cnf: So my guess is that merb is going to spit back at us whatever we hit it on.  So if we say "localhost" it is going to give us back localhost
[2012-07-27 13:42:59 -0400] cnf: o,O
[2012-07-27 13:43:13 -0400] cnf: ssd7: ok... so how do you proxy it?
[2012-07-27 13:43:24 -0400] cnf: and with "you" i mean opscode ^^;
[2012-07-27 13:44:55 -0400] cnf: ssd7: because this is what the docs say
[2012-07-27 13:46:32 -0400] cnf: ssd7: http://wiki.opscode.com/display/chef/How+to+Proxy+Chef+Server+with+Apache
[2012-07-27 13:46:46 -0400] cnf: that's apache, but i guess the same mechanics apply
[2012-07-27 13:49:29 -0400] cnf: hmz, weird things
[2012-07-27 13:49:33 -0400] cnf: now the webui crashed ^^;
[2012-07-27 13:50:56 -0400] cnf: nm, webui is working again
[2012-07-27 13:52:05 -0400] ssd7: cnf: On its face, your config looks right to me as well. Let me take another look and see if I'm just missing something obvious.
[2012-07-27 13:53:21 -0400] cpasmoi: I have a kinda complete Wordpress.json, which have a run list (including role[Basics] and some recipe) ; I want to put a Wordpress-prod.json file/role which "includes" the Wordpress.json.
[2012-07-27 13:53:50 -0400] cpasmoi: Will there be any problem if I only put role[Wordpress] on its runlist ?
[2012-07-27 13:54:17 -0400] cpasmoi: On the webui I'll assign the Wordpress-prod to my node
[2012-07-27 13:58:15 -0400] cnf: ssd7: it seems your idea was right
[2012-07-27 13:58:34 -0400] cnf: ssd7: it uses whatever string i use in my nginx config
[2012-07-27 13:58:51 -0400] cnf: but if it does that, i don't know how to tell it that that is wrong
[2012-07-27 14:02:48 -0400] cnf: ssd7: fixed
[2012-07-27 14:03:18 -0400] cnf: ssd7: http://tickets.opscode.com/browse/CHEF-2589
[2012-07-27 14:04:16 -0400] chiel: with chef, is there an easy way to install something from source? (something being ruby, in this case)
[2012-07-27 14:04:39 -0400] mattray: chiel: there are definitely cookbooks that build things from source
[2012-07-27 14:04:48 -0400] mattray: chiel: build-essentials cookbook
[2012-07-27 14:05:00 -0400] cnf: the php cookbook has a recipe that installs from source, if you want an example
[2012-07-27 14:05:13 -0400] cnf: right
[2012-07-27 14:05:27 -0400] chiel: ah ok, thanks. :)
[2012-07-27 14:05:28 -0400] ssd7: cnf: Ahhh. yeah. sigh. sorry about that, a bit slow this morning I guess.
[2012-07-27 14:05:41 -0400] cnf: now, does anyone have a set of example init scripts for chef-server on centos?
[2012-07-27 14:05:41 -0400] chiel: debian squeeze is just kinda annoying sometimes with it's outdated packages, you see...
[2012-07-27 14:05:50 -0400] cnf: ssd7: haha, no worries, we found it :P
[2012-07-27 14:05:59 -0400] cnf: and you did have the right idea off the bat
[2012-07-27 14:07:05 -0400] ssd7: :) Well, glad it is sorted.  Got to head out for a bit.  Cheers
[2012-07-27 14:07:20 -0400] cnf: \o
[2012-07-27 14:07:32 -0400] cnf: ssd7: i'm gonna try and get some init script going now, thanks
[2012-07-27 14:19:52 -0400] chiel: since i don't have access to a chef server, would you recommend combining recipes from the opscode cookbook repo, along with local recipes or so?
[2012-07-27 14:20:41 -0400] cnf: you have access to a chef server
[2012-07-27 14:20:44 -0400] chiel: i want to be able to build ruby from source, as well
[2012-07-27 14:20:58 -0400] cnf: http://www.opscode.com/hosted-chef/
[2012-07-27 14:21:17 -0400] chiel: yeah, but it's just for my opensource project
[2012-07-27 14:21:37 -0400] cnf: so?
[2012-07-27 14:21:37 -0400] bawt: so is this appstore everyone's talking about
[2012-07-27 14:21:41 -0400] chiel: I just want to combine it with vagrant, so people can be up and running with it quickly
[2012-07-27 14:21:44 -0400] cnf: it's free up to 5 nodes
[2012-07-27 14:23:05 -0400] Mithrandir: bawt: forget so
[2012-07-27 14:23:06 -0400] bawt: aight
[2012-07-27 14:23:07 -0400] cnf: boss is kicking us out
[2012-07-27 14:23:15 -0400] cnf: chiel: i'll be back online in half an hour or so
[2012-07-27 14:23:20 -0400] chiel: ah alright
[2012-07-27 14:23:56 -0400] cnf: he wants to go do drinkes, it's hot out
[2012-07-27 14:24:16 -0400] chiel: haha nice :)
[2012-07-27 14:39:38 -0400] behemphi: Is there a cookbook around for ngx_openresty?
[2012-07-27 14:39:52 -0400] behemphi: any thoughts/comments on this setup?
[2012-07-27 14:46:17 -0400] draiken: I have a node that had it's ip address changed, but when I run 'node show' it still shows the old one how can I update that ip?
[2012-07-27 14:47:41 -0400] sampikesley: knife node edit <your_node> -a ?
[2012-07-27 14:48:20 -0400] ashb: run chef-client on that node
[2012-07-27 14:48:29 -0400] ashb: and it should update when it finishes converging
[2012-07-27 14:49:02 -0400] draiken: I see, it has 2 network interfaces, it's picking up the wrong one
[2012-07-27 14:49:13 -0400] draiken: how do I tell chef to use a specific one?
[2012-07-27 14:59:21 -0400] mattray: draiken: you have access to the network attribute, take a look at "knife node show BLAH -a network" to find what you need
[2012-07-27 15:00:28 -0400] draiken: mattray:  I found out the problem, the 'knife ssh' used fqdn attribute by default, I changed it to ipaddress and it worked.
[2012-07-27 15:00:42 -0400] draiken: thanks anyway :)
[2012-07-27 15:00:46 -0400] mattray: yeah, you can pass -a ipaddress to knife ssh
[2012-07-27 15:06:05 -0400] zombor: hello, is there a way for a recipe to be run before another recipe? for example, if one needs build essentials installed before it runs
[2012-07-27 15:06:11 -0400] zombor: im using chef-solo
[2012-07-27 15:06:21 -0400] mattray: zombor: I think build-essentials just got that added
[2012-07-27 15:06:47 -0400] zombor: i just cloned down the build-essentials two days ago
[2012-07-27 15:06:56 -0400] zombor: but i need it to run before my postgres
[2012-07-27 15:07:16 -0400] zombor: (i'm using vagrant too)
[2012-07-27 15:07:58 -0400] mattray: zombor: the README has how to use node['build_essential']['compiletime']
[2012-07-27 15:08:37 -0400] cbloss: Does anyone know where the lastest bootstrap installer for chef-server on centos6 is? It seems the links on the website are broken and -latest doesn't work. (missing epel, i think apache gem is out of date according to another post)
[2012-07-27 15:09:04 -0400] zombor: mattray: thanks. looks like i'll have to get my hands dirty with roles now :(
[2012-07-27 15:09:58 -0400] mattray: cbloss: have you tried the new omnibus install? works great for Cent6
[2012-07-27 15:10:09 -0400] mattray: cbloss: doh, chef-server
[2012-07-27 15:10:13 -0400] mattray: cbloss: nm
[2012-07-27 15:14:49 -0400] cbloss: is omnibus only for client?
[2012-07-27 15:16:59 -0400] cbloss: yep, looks like it.
[2012-07-27 15:21:27 -0400] sampikesley: cbloss: this is obviously for debian-ish servers, but the steps might help: https://github.com/pikesley/catering-college/blob/master/install-chef-server
[2012-07-27 15:22:36 -0400] cbloss: okay i'll take a look, thanks
[2012-07-27 15:23:19 -0400] cbloss: another issue i'm working through is i'm trying to use chef with rvm, if anyone has experience with that i'd be happy for some tips
[2012-07-27 15:25:14 -0400] ashb: i'd favour rbenv of RVM for use on servers
[2012-07-27 15:25:22 -0400] ashb: RVM does too much shell fuckery for my tastes
[2012-07-27 15:26:28 -0400] cbloss: mmm, i'll look into it
[2012-07-27 15:26:42 -0400] mattray: cbloss: it's just for client now, there will be a server probably with the Chef 11 release
[2012-07-27 15:30:10 -0400] sampikesley: rvm is nice
[2012-07-27 15:30:14 -0400] Jay_Levitt: Some of my run_list refers to a cookbook name ('git') and some explicitly to a recipe ('recipe[postgresql::server]'). Is the 'git' syntax just an implicit version of 'recipe[git::default]'? Is that in the docs somewhere?
[2012-07-27 15:31:22 -0400] geekbri: Jay_Levitt: recipe[git] == recipe[git::default]
[2012-07-27 15:32:09 -0400] Jay_Levitt: geek: ok, but what about just 'git'?
[2012-07-27 15:32:24 -0400] geekbri: Sounds like maybe somebody made a bad entry? :)
[2012-07-27 15:32:53 -0400] Jay_Levitt: well, that somebody would be me.. but it seems to work..?
[2012-07-27 15:33:17 -0400] geekbri: You are viewing the runlist with knife show? or through the webui?  I'd be curious to see what knife node edit shows in the run_list
[2012-07-27 15:33:38 -0400] Jay_Levitt: This is in my role.rb. let's see..
[2012-07-27 15:34:10 -0400] Jay_Levitt: ah, interesting.. 'git' seems to be expanded to 'recipe[git]'
[2012-07-27 15:34:26 -0400] Jay_Levitt: Sounds like that's not a common idiom tho. I should change them to explicit recipe calls.
[2012-07-27 15:34:40 -0400] geekbri: Yeah, I've never actually tried to call something in a run list without defining what it is.
[2012-07-27 15:34:47 -0400] sampikesley: sounds like a bad idea
[2012-07-27 15:35:13 -0400] Jay_Levitt: yep.
[2012-07-27 15:36:53 -0400] geekbri: Just another to thing to have to remember how it works without it being clearly evident:)  .  That is interesting to know, I think I would almost prefer if it complained about that instead of having a default.
[2012-07-27 15:42:08 -0400] cpasmoi: Is there a PHP cookbook maintainer around ? I have a issue regarding the package CentOS 6 name
[2012-07-27 15:42:28 -0400] cpasmoi: Packages name are php* instead of php53
[2012-07-27 15:43:17 -0400] cpasmoi: ( "ERROR: package[php53] (/var/cache/chef/cookbooks/php/recipes/package.rb:32:in `from_file') had an error: No version specified, and no candidate version available for php53" error with chef-client)
[2012-07-27 15:46:01 -0400] spox: cpasmoi: github repo of the cookbook has updated package names applied
[2012-07-27 15:47:39 -0400] cpasmoi: damned
[2012-07-27 15:47:49 -0400] cpasmoi: i'm using the tarball one
[2012-07-27 15:48:16 -0400] cpasmoi: (my chef repo is based on svn...)
[2012-07-27 15:54:00 -0400] newb: oh, omnibus only for client? no chef erver love?
[2012-07-27 15:54:17 -0400] cheeseplus: not yet
[2012-07-27 15:55:15 -0400] newb: so we can't bootstrap a chef server using knife bootstrap?
[2012-07-27 15:55:31 -0400] newb: I mean from the availabl templates?
[2012-07-27 15:55:39 -0400] newb: (unless I make one myself)
[2012-07-27 15:56:35 -0400] cheeseplus: newb: well you can currently bootstrap a chef server with knife but that isn't omnibus (official)
[2012-07-27 15:56:56 -0400] kallistec: siezer: ohai!
[2012-07-27 15:57:31 -0400] newb: cheeseplus, yes, but I think I saw something (not knife-server) that bootstraps a chef server with knife - any ideas what that was (I should start using emacs todo)
[2012-07-27 15:58:12 -0400] cheeseplus: nope, I've seen a few but knife-server bubbles up to the top
[2012-07-27 16:02:36 -0400] newb: cheeseplus, me too, I recall knife-server as I remember it doing all the right stuff. but many people have tried
[2012-07-27 16:17:39 -0400] mattray: there's a chef-server cookbook
[2012-07-27 16:17:59 -0400] mattray: https://github.com/opscode-cookbooks/chef-server
[2012-07-27 16:18:13 -0400] mattray: I've used Hosted Chef to deploy the open source chef server with it
[2012-07-27 16:30:27 -0400] paulmooring: mattray: Have you used chef-solo to deploy Private Chef to deploy Chef server?
[2012-07-27 16:30:51 -0400] mattray: chef-solo is what we use to deploy private chef
[2012-07-27 16:30:57 -0400] paulmooring: I bet you could get pretty meta with Chef if you tried
[2012-07-27 16:31:17 -0400] mattray: wrapped in private-chef-ctl, which will be part of the omnibus open source server
[2012-07-27 16:31:28 -0400] mattray: we talked about it at Chefconf
[2012-07-27 16:31:41 -0400] mattray: s/private-chef-ctl/chef-server-ctl/ of course
[2012-07-27 16:31:44 -0400] paulmooring: I wasn't at ChefConf :(
[2012-07-27 16:32:00 -0400] mattray: videos are here: https://www.youtube.com/user/Opscode
[2012-07-27 16:32:30 -0400] mattray: don't remember which State of the Union it was, Adam's or CB's
[2012-07-27 16:42:48 -0400] newb: @mattray, https://github.com/opscode-cookbooks/chef-server/blob/master/recipes/rabbitmq.rb#L43. This will install the system repo rabbit which is old on ubuntu lucid. How do I make it install 2.4.8?
[2012-07-27 16:42:56 -0400] newb: from rabbit repo?
[2012-07-27 16:43:07 -0400] newb: I see the rabbit rcp's there but it's not called
[2012-07-27 16:43:44 -0400] mattray: it probably needs to be updated to use the rabbitmq cookbook, which is on the latest afaik
[2012-07-27 16:44:44 -0400] mattray: https://github.com/opscode-cookbooks/rabbitmq/blob/master/recipes/default.rb
[2012-07-27 16:45:30 -0400] mattray: replace everything before line #54 with include_recipe "rabbitmq"
[2012-07-27 16:45:46 -0400] mattray: that would of course, require some thorough testing
[2012-07-27 16:45:51 -0400] mattray: but they look redundant to me
[2012-07-27 16:46:46 -0400] mattray: that's line #54 of https://github.com/opscode-cookbooks/chef-server/blob/master/recipes/rabbitmq.rb#L54b
[2012-07-27 16:57:37 -0400] cnf: ok, so not quite half an hour
[2012-07-27 17:10:48 -0400] chrisstreeter: hey all, i've got a question. i'm implementing my own application cookbook, to use the application_python cookbook
[2012-07-27 17:11:07 -0400] chrisstreeter: however, when I run it now, I'm getting an exception that says Re-raising exception: NameError - Cannot find a resource for depends on ubuntu version 11.10
[2012-07-27 17:11:25 -0400] chrisstreeter: I can generate a stack trace if that would help
[2012-07-27 17:11:28 -0400] chrisstreeter: any ideas?
[2012-07-27 17:12:24 -0400] chrisstreeter: actually, here's a stacktrace: http://pastie.org/4343708
[2012-07-27 17:16:16 -0400] ssd7: chrisstreeter: probably best if you can post the www recipe
[2012-07-27 17:16:40 -0400] ssd7: looks like you problem is on line 1 of that recipe
[2012-07-27 17:18:10 -0400] chrisstreeter: ssd7, yeah let me post it here in a sec
[2012-07-27 17:21:19 -0400] chrisstreeter: alright, i figured out the error. the first line was a 'depends "application"'
[2012-07-27 17:21:46 -0400] chrisstreeter: and apparently it should have been "include_recipe "application""
[2012-07-27 17:22:35 -0400] ssd7: yeah, depends will go in the metadata.rb file
[2012-07-27 17:27:03 -0400] chrisstreeter: if i'm on ec2, and want to get the current instance instance_id, how do I do that in the recipe file with chef-solo ?
[2012-07-27 17:33:09 -0400] EJC: hello again room - still not seeing files that are part of cookbooks getting transferred over.
[2012-07-27 17:33:22 -0400] EJC: even with a recipe that was working not too long ago (all on ubuntu)
[2012-07-27 17:33:33 -0400] EJC: I'm curious - is there a firewall setting that would prevent this?
[2012-07-27 17:33:59 -0400] EJC: I've run ufw disable and verified it's off/down/disabled, but still no files come over....
[2012-07-27 17:37:09 -0400] mattray: EJC: files in the cookbook? they're only downloaded as used in recipes
[2012-07-27 17:37:32 -0400] EJC: so I have a cookbook that all of our cookbooks will use.
[2012-07-27 17:37:52 -0400] EJC: in there, there's a databag key and the default recipe for that cookbook simply moves that key into /etc/chef
[2012-07-27 17:38:21 -0400] EJC: for some reason, that's not executing and when I look at the cache folder (/var/chef/cache/cookbook/<cookbookname>
[2012-07-27 17:38:25 -0400] EJC: I can see it's not in there
[2012-07-27 17:41:14 -0400] Zenigor: I'm creating a gem that includes and extends knife-rackspace, however I am unable to even require 'knife-rackspace' from irb when the knife-rackspace gem is clearly installed and shown in gem list
[2012-07-27 17:41:23 -0400] mattray: EJC: and that's in the cookbook directory files/default/?
[2012-07-27 17:42:09 -0400] EJC: yessir
[2012-07-27 17:42:22 -0400] EJC: I have <cookbookname>/files/default/<directoryname>/file
[2012-07-27 17:42:26 -0400] EJC: "file" is not moved
[2012-07-27 17:43:13 -0400] EJC: cookbook_file "/etc/chef/file" do
[2012-07-27 17:43:15 -0400] EJC:   source "directory/file" # this is the value that would be inferred from the path parameter
[2012-07-27 17:43:17 -0400] EJC:   mode "0644"
[2012-07-27 17:43:19 -0400] EJC: end
[2012-07-27 17:45:52 -0400] rbattula: can ruby functions be defined and set as values in chef environments?
[2012-07-27 17:46:29 -0400] EJC: is there anything more I can provide?
[2012-07-27 17:59:25 -0400] mattray: EJC: source "directory/file"?
[2012-07-27 17:59:32 -0400] mattray: what is directory?
[2012-07-27 17:59:41 -0400] EJC: sorry - trying to keep things vague
[2012-07-27 17:59:51 -0400] mattray: it should just be
[2012-07-27 17:59:54 -0400] mattray: source "file"
[2012-07-27 18:00:02 -0400] EJC: so from the cookbook root, we have "files/default/directory/file"
[2012-07-27 18:00:14 -0400] EJC: so I can't have directories within the "default" folder?
[2012-07-27 18:00:24 -0400] EJC: in the recipe, I've specified that directory
[2012-07-27 18:00:26 -0400] mattray: I don't think directory is supported yet, I think there's a ticket somewhere
[2012-07-27 18:01:16 -0400] mattray: http://wiki.opscode.com/display/chef/File+Distribution
[2012-07-27 18:01:22 -0400] EJC: so all the files need to be in a flat structure?
[2012-07-27 18:01:27 -0400] mattray: yeah
[2012-07-27 18:01:33 -0400] mattray: or nested into platform or hosts
[2012-07-27 18:02:12 -0400] EJC: gotcha - lemmie try a flat structure - dood - THANK YOU
[2012-07-27 18:02:22 -0400] EJC: I need to run to a standup so this may take a sec...
[2012-07-27 18:04:14 -0400] mattray: good luck
[2012-07-27 18:13:01 -0400] EJC: shouldn't the files be there in the /var/chef/cache/cookbook/<cookbook> directory?
[2012-07-27 18:13:26 -0400] jasond: is there a way i can know if the previous step in a recipe succeeded?
[2012-07-27 18:13:44 -0400] mattray: EJC: files and templates only get cached once they're requested in the recipe, so there's not extraneous downloads
[2012-07-27 18:14:08 -0400] mattray: jasond: example?
[2012-07-27 18:14:21 -0400] EJC: so it's the first recipe that gets called that will try and move that file into place :-/
[2012-07-27 18:16:00 -0400] jasond: mattray: i need to make a report about specifically what succeeded/failed in a recipe.  "report handlers" doesn't seem to provide that level of granularity
[2012-07-27 18:17:23 -0400] EJC: mattray: I moved the file into <cookbook>/files/default still no-bueno :-/
[2012-07-27 18:17:45 -0400] mattray: jasond: https://jtimberman.posterous.com/a-simple-report-handler like this?
[2012-07-27 18:18:00 -0400] mattray: EJC: knife cookbook upload the new one?
[2012-07-27 18:20:21 -0400] EJC: mattray:  I have - I also have deleted the client out of the chef server and rm -rf'd the /etc/chef and /var/chef directories on the targeted machine
[2012-07-27 18:20:35 -0400] EJC: I can even knife download the cookbook and see the file is in the correct place
[2012-07-27 18:20:52 -0400] mattray: run the chef-client with -l debug
[2012-07-27 18:21:10 -0400] mattray: and gist the cookbook_file part of the recipe
[2012-07-27 18:21:24 -0400] jasond: mattray: not really.  i was looking for something kind of like $? in bash.  maybe chefspec is what i'm looking for
[2012-07-27 18:22:19 -0400] mattray: jasond: so the report/exception handler has the run_status.updated_resources list, you can do whatever you want with that
[2012-07-27 18:22:31 -0400] mattray: jasond: you can also access the run_status from a recipe if you need
[2012-07-27 18:22:55 -0400] EJC: mattray: So the file in quesiton here is a databag key.
[2012-07-27 18:23:04 -0400] EJC: I swear, a few weeks ago, this worked perfectly
[2012-07-27 18:23:18 -0400] mattray: EJC: version?
[2012-07-27 18:23:26 -0400] EJC: this cookbook moved it into /etc/chef and the next recipe in the run list properly leveraged it
[2012-07-27 18:23:46 -0400] EJC: version of which now - chef or you think my version of the cookbook is off (ie - I'm pointing at an old one)?
[2012-07-27 18:23:52 -0400] mattray: EJC: I remember some sort of bug with remote_file and notifications
[2012-07-27 18:24:00 -0400] mattray: chef version
[2012-07-27 18:24:08 -0400] jasond: mattray: i didn't know i could access run_status from the recipe.  i'll try that.  thanks
[2012-07-27 18:24:11 -0400] EJC: I'm using "cookbook_file"
[2012-07-27 18:24:13 -0400] mattray: are you keying off of notifications?
[2012-07-27 18:24:29 -0400] EJC: 10.12.0
[2012-07-27 18:24:36 -0400] EJC: me?
[2012-07-27 18:24:39 -0400] EJC:  no
[2012-07-27 18:24:50 -0400] mattray: EJC: PM me a gist of the recipe
[2012-07-27 18:25:22 -0400] EJC: cookbook_file "/etc/chef/nexus_databag_key" do
[2012-07-27 18:25:24 -0400] EJC:   source "nexus_databag_key"
[2012-07-27 18:25:27 -0400] EJC:   mode "0644"
[2012-07-27 18:25:28 -0400] EJC: end
[2012-07-27 18:25:30 -0400] EJC: its just that simple
[2012-07-27 18:25:58 -0400] mattray: and chef-client -l debug for that resource?
[2012-07-27 18:27:33 -0400] mattray: EJC: no stack trace, just silently ignored?
[2012-07-27 18:29:08 -0400] EJC: mattray:mmmmmm  - wait
[2012-07-27 18:29:21 -0400] EJC: up on the machine I'm targeting with the bootstrap -yes
[2012-07-27 18:29:34 -0400] EJC: it seems like the run list of recipes is skipped or taken out of order...
[2012-07-27 18:29:54 -0400] david415: hey i keep getting these confusing problem where librarian-chef won't install the cookbooks
[2012-07-27 18:29:58 -0400] david415: Cheffile and Cheffile.lock are out of sync!
[2012-07-27 18:30:22 -0400] david415: i remove the lock file but that doesn't fix it...
[2012-07-27 18:31:26 -0400] jasond: from reading the docs on "Report Handlers", there seems to be this idea about a Chef run either succeeding or failing, but never partially succeeding.  am i missing something fundamental about how Chef works?
[2012-07-27 18:32:07 -0400] jasond: does partial success equal failure?
[2012-07-27 18:34:24 -0400] gmcinnes: Anyone know if there is a cross platform cookbook or lwrp for sysctl?  Anyone had any success with anything that's out there?
[2012-07-27 18:34:30 -0400] EJC: mattray: I've defined the recipes/runlist in the role I'm using to bootstrap with
[2012-07-27 18:34:40 -0400] EJC: it's like it ignores the first one in that list.....'
[2012-07-27 18:36:07 -0400] mattray: and that role has been uploaded?
[2012-07-27 18:37:32 -0400] miah: yfeldblum: around?
[2012-07-27 18:38:26 -0400] EJC: if I can do a knife role show <rolename> and it displays, wouldn't that mean it's working?
[2012-07-27 18:39:08 -0400] mattray: yeah
[2012-07-27 18:39:08 -0400] EJC: actually - looking at the chef server, I can see it has the right thing
[2012-07-27 18:40:34 -0400] EJC: @mattray - for giggles, I've removed everything after my "base" cookbook (the one responsible for moving the file into place)
[2012-07-27 18:40:44 -0400] EJC: it really feels like the role isn't being respected
[2012-07-27 18:40:53 -0400] EJC: and that the cookbooks/recpies are getting run out of order...
[2012-07-27 18:41:09 -0400] EJC: annnnnd that worked
[2012-07-27 18:41:13 -0400] EJC: hmmmmm
[2012-07-27 18:41:30 -0400] EJC: ok, so there must be sometihng weird with the subsequent cookbook then?
[2012-07-27 18:43:10 -0400] mattray: dunno, seems like something was out of sync
[2012-07-27 18:45:04 -0400] EJC: yeah, this is getting silly
[2012-07-27 18:45:28 -0400] EJC: so when I have a runlist that has base::default, other::default, the first one isn't run properly
[2012-07-27 18:47:09 -0400] EJC: how are the cookbooks/recipes evaluated?  I mean - does chef read in every recipe and evaluate all the possible files it should resolve prior to executing them?
[2012-07-27 18:47:55 -0400] EJC: so what we have is a cookbook responsible for putting down several encrypted databag keys as our "base" cookbook, then another one which installs a webapp and relies on that key being there for those encrypted databag values...
[2012-07-27 18:48:16 -0400] EJC: it's like the key isn't written (recipe not run) prior to the second cookbook's attempt to decrypt the databag values....
[2012-07-27 18:49:07 -0400] mattray: EJC: knife node show FOO, what's the run_list look like? And when the chef-client runs, that shows up at the beginning of the run?
[2012-07-27 18:50:02 -0400] EJC: mattray:  Run List:    role[nexus]
[2012-07-27 18:50:04 -0400] EJC: Roles:       nexus
[2012-07-27 18:50:25 -0400] mattray: and when the chef-client runs that expands?
[2012-07-27 18:50:45 -0400] mattray: Run List expands to [base::default, other::default]
[2012-07-27 18:51:01 -0400] EJC: [2012-07-27T11:43:55-07:00] INFO: Setting the run_list to ["role[nexus]"] from JSON
[2012-07-27 18:51:03 -0400] EJC: [2012-07-27T11:43:55-07:00] INFO: Run List is [role[nexus]]
[2012-07-27 18:51:05 -0400] EJC: [2012-07-27T11:43:55-07:00] INFO: Run List expands to [rapid7-base::default, nexus::default]
[2012-07-27 18:51:21 -0400] EJC: so the ordering is correct :-/
[2012-07-27 18:51:29 -0400] mattray: and that fails?
[2012-07-27 18:52:27 -0400] mattray: are you bootstrapping with "-r nexus"?
[2012-07-27 18:52:41 -0400] EJC: -r 'role[nexus]'
[2012-07-27 18:52:46 -0400] EJC: yes, that fails
[2012-07-27 18:52:57 -0400] mattray: crazy
[2012-07-27 18:53:19 -0400] mattray: when you bootstrap it doesn't expand the run list?
[2012-07-27 18:53:41 -0400] EJC: I pasted in above the exact message I got
[2012-07-27 18:53:46 -0400] EJC: you can see how it expands it
[2012-07-27 18:53:52 -0400] EJC: seems to be doing the right thing
[2012-07-27 18:54:04 -0400] EJC: but again, that first "default" recipe?  that puts down the databag key for the next one
[2012-07-27 18:54:25 -0400] EJC: seems like chef evaluates all recipes prior to running them
[2012-07-27 18:54:43 -0400] EJC: which feels different than how it worked about a week ago when this was working flawlessly
[2012-07-27 18:54:46 -0400] mattray: it runs all the ruby first, then the resources
[2012-07-27 18:55:06 -0400] siezer: EJC it compiles a resource collection by running the ruby
[2012-07-27 18:55:32 -0400] siezer: so you should take care not to put ruby in a recipe that can affect the system
[2012-07-27 18:55:47 -0400] EJC: I have no ruby coded directly
[2012-07-27 18:56:00 -0400] EJC: seriously that first recipe is just a file_resource copy
[2012-07-27 18:56:22 -0400] EJC: erm - cookbook_file recource:
[2012-07-27 18:56:32 -0400] EJC: cookbook_file "/etc/chef/nexus_databag_key" do
[2012-07-27 18:56:34 -0400] EJC:   source "nexus_databag_key"
[2012-07-27 18:56:35 -0400] EJC:   mode "0644"
[2012-07-27 18:56:37 -0400] EJC: end
[2012-07-27 18:57:02 -0400] EJC: and the next recipe that runs needs that key in place as it loads it as the cookbook secret file
[2012-07-27 18:57:06 -0400] EJC: does this make sense?
[2012-07-27 18:57:08 -0400] siezer: aha
[2012-07-27 18:57:11 -0400] siezer: try
[2012-07-27 18:57:46 -0400] siezer: cookbook_file "name" do stuff end.run_action(:create)
[2012-07-27 18:58:23 -0400] siezer: that'll cause the resource to file in the compilation phase so your secret will be available to the rest of the things down the collection
[2012-07-27 18:59:23 -0400] siezer: but really, your databag secrets should be installed out of band from chef (in the bootstrap), or else it kind of defeats the purpose ;)
[2012-07-27 19:00:06 -0400] EJC: I don't understand the out of band part
[2012-07-27 19:00:43 -0400] david415: librarian-chef why you no make sense
[2012-07-27 19:00:43 -0400] david415: librarian-chef install
[2012-07-27 19:00:43 -0400] david415: /Library/Ruby/Gems/1.8/gems/librarian-0.0.23/lib/librarian/dependency.rb:65:in `cache_manifests!': undefined method `manifests' for nil:NilClass (NoMethodError) from /Library/Ruby/Gems/1.8/gems/librarian-0.0.23/lib/librarian/dependency.rb:61:in `manifests'
[2012-07-27 19:01:18 -0400] chrisstreeter: i'm completely stuck on trying to figure out why i'm getting an error NoMethodError: undefined method `push' for nil:NilClass when trying to use the application_python cookbook
[2012-07-27 19:01:31 -0400] EJC: @siezer - ok really - end.run_action(:create) or was that a period and a newline?
[2012-07-27 19:01:50 -0400] chrisstreeter: I've made custom www recipe in a custom cookbook, which is here: http://pastie.org/4344263
[2012-07-27 19:02:08 -0400] chrisstreeter: and the stack trace is here: http://pastie.org/4344267
[2012-07-27 19:02:22 -0400] chrisstreeter: can anyone give me any help? cc/ coderanger
[2012-07-27 19:03:20 -0400] siezer: chef is a tool designed to configure your system(s) top to bottom... recipes are the "pattern", driven by data (data bags, attributes, other sources). you're trying to encrypt that data on chef-server by using an encrypted data bag, so that your chef-server administrator cannot access it. to decrypt it, you need a key on the system under management. putting that key in a cookbook_file means that the admin can decrypt the data
[2012-07-27 19:03:37 -0400] siezer: so you'll want to install it with a custom boostrap script, or via kickstart/whaveter
[2012-07-27 19:03:50 -0400] siezer: end.run_action(:create)
[2012-07-27 19:03:56 -0400] hippiehacker: I've forked dell-recovery to create a usb, which when booted, offers to create a restore partition. The restore partition creates a local OEM install of ubuntu that includes chef. During the Out of Box Experience, chef-client automatically registers the new node and allows the new user to edit/apply roles/recipes to the freshly installed computer.....
[2012-07-27 19:03:59 -0400] siezer: end dot r
[2012-07-27 19:04:24 -0400] siezer: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-07-27 19:04:48 -0400] hippiehacker: If you want to restore, start from scratch, you just boot to the restore partiton and start over, it recreates the OEM / OOBE. If you want to share, you just create a new usb stick or cdrom.
[2012-07-27 19:05:14 -0400] hippiehacker: The usb sticks / cdroms include your client.rb/authorization.pem for new node creation. It's part of a project I'm working on called :ii (Instant Infrastructure)
[2012-07-27 19:07:24 -0400] EJC: @siezer  -  cool - that worked!
[2012-07-27 19:07:31 -0400] hippiehacker: http://www.hippiehacker.org/2012/07/ii-instant-infrastructure-and-sputnik.html # I recently got it working on MacBooks and other EFI machines in addition to standard pc-bios machines.  Originally I was doing PXE network based replication, but the usb sticks / cdroms / restore partions seems to be easier to work with.
[2012-07-27 19:07:46 -0400] mattray: hippiehacker: nice!
[2012-07-27 19:07:49 -0400] hoover_damm: really?
[2012-07-27 19:07:52 -0400] siezer: EJC sweet!
[2012-07-27 19:07:52 -0400] hoover_damm: easier then pxe?
[2012-07-27 19:07:53 -0400] hoover_damm: :(
[2012-07-27 19:07:56 -0400] EJC: for the record - all we want to do is have a place to store some data that should remain protected/encrypted
[2012-07-27 19:08:12 -0400] EJC: and ideally, we'd use chef across the board for this purpose
[2012-07-27 19:08:28 -0400] EJC: I must have run several of these recipes out of band or something in order to get it all working before
[2012-07-27 19:08:35 -0400] EJC: I never had end.run_action(:create)
[2012-07-27 19:08:38 -0400] EJC: ever
[2012-07-27 19:08:52 -0400] hoover_damm: hippiehacker, that's neat
[2012-07-27 19:09:22 -0400] EJC: so the chef admin can see/know about these things, BUT, the rest of the world (who may break their way into chef), we want to make their lives a bit more difficult :-/
[2012-07-27 19:09:36 -0400] EJC: this may all be just an invisible barrier (fake obstacle).
[2012-07-27 19:09:45 -0400] coderanger: chrisstreeter: Whats up
[2012-07-27 19:09:45 -0400] siezer: right
[2012-07-27 19:10:12 -0400] mattray: EJC: have you looked at the Gazzang stuff?
[2012-07-27 19:10:22 -0400] EJC: nope - wassat?
[2012-07-27 19:10:53 -0400] mattray: EJC: http://gazzang.com/products/zncrypt
[2012-07-27 19:10:57 -0400] mattray: encryptfs
[2012-07-27 19:11:03 -0400] mattray: they've got cookbooks for that stuff
[2012-07-27 19:11:25 -0400] mattray: and a new service, zTrustee for managing keys
[2012-07-27 19:11:52 -0400] chrisstreeter: hey coderanger , i'm working on a custom cookbook that uses the application_python cookbook
[2012-07-27 19:11:53 -0400] EJC: seems like a cloud specific paid-for service to me - am I missing stuff?
[2012-07-27 19:12:12 -0400] chrisstreeter: so this is what my recipe looks like: http://pastie.org/4344263
[2012-07-27 19:12:20 -0400] mattray: EJC: yeah, zTrustee is currently a SaaS
[2012-07-27 19:12:37 -0400] chrisstreeter: and i'm getting this crazy error here: http://pastie.org/4344267
[2012-07-27 19:12:42 -0400] EJC: FWIW - I'm pretty happy to see what I've got going now
[2012-07-27 19:12:43 -0400] chrisstreeter: any thoughts?
[2012-07-27 19:12:46 -0400] EJC: :-/
[2012-07-27 19:12:47 -0400] mattray: EJC: but if you need encrypted filesystems
[2012-07-27 19:13:04 -0400] mattray: EJC: encryptfs is free
[2012-07-27 19:13:07 -0400] EJC: no no - the files we have encrypted are just internal certs/key files
[2012-07-27 19:13:13 -0400] EJC: and internally signed
[2012-07-27 19:13:23 -0400] EJC: so they're not perfect to begin with :-)
[2012-07-27 19:13:28 -0400] mattray: gotcha, zTrustee is for managing access to that stuff
[2012-07-27 19:13:55 -0400] mattray: restrict who, when and how many times keys can be accessed
[2012-07-27 19:13:58 -0400] EJC: wish we could hop on skype or something - so much faster/easer to chat :-)
[2012-07-27 19:14:05 -0400] EJC: we don't need that
[2012-07-27 19:14:07 -0400] mattray: no worries, I'm done plugging ;)
[2012-07-27 19:14:26 -0400] EJC: :-))))
[2012-07-27 19:14:31 -0400] mattray: I just saw they had cookbooks and wanted to see if anyone found them useful
[2012-07-27 19:17:41 -0400] otterley: hi Chefs!
[2012-07-27 19:17:54 -0400] hippiehacker: hoover_damm: getting apple hardware to pxe is a pita
[2012-07-27 19:17:56 -0400] otterley: quick question: is there a way to tell Chef not to deep-merge elements in an array?
[2012-07-27 19:18:13 -0400] coderanger: chrisstreeter: its a bug in the gunicorn cokkbook
[2012-07-27 19:18:25 -0400] hoover_damm: hippiehacker, oh apple hardware... :(
[2012-07-27 19:18:26 -0400] coderanger: chrisstreeter: ampledata submitted a patch, let me see if it is in
[2012-07-27 19:18:28 -0400] hoover_damm: yeah
[2012-07-27 19:18:43 -0400] hippiehacker: I'm trying to make it crazy easy to use for non-technical folks
[2012-07-27 19:18:54 -0400] hoover_damm: no efi is best done with cd/usb
[2012-07-27 19:19:04 -0400] hoover_damm: until more distros are ready for it
[2012-07-27 19:19:10 -0400] hoover_damm: i've had enough fights with efi lately
[2012-07-27 19:19:13 -0400] otterley: e.g. if I have in a role default_attributes(:resolvers => ["1.2.3.4"]) and in my cookbook I have default[:resolvers] = ["5.6.7.8"], I really don't want the end result to be ("1.2.3.4", "5.6.7.8")
[2012-07-27 19:19:14 -0400] hoover_damm: we have some UEFI servers
[2012-07-27 19:19:20 -0400] hoover_damm: so i've had to start caring
[2012-07-27 19:19:22 -0400] chrisstreeter: coderanger ok, thanks
[2012-07-27 19:19:25 -0400] coderanger: chrisstreeter: https://github.com/opscode-cookbooks/gunicorn/pull/4
[2012-07-27 19:20:27 -0400] chrisstreeter: ah, ok thanks
[2012-07-27 19:26:39 -0400] qhartman: Is there a way to set an attribute on another node within a chef-client run?
[2012-07-27 19:27:24 -0400] mattray: qhartman: no, nodes don't have permission to modify each other
[2012-07-27 19:27:30 -0400] qhartman: bummer
[2012-07-27 19:27:32 -0400] qhartman: ok, thx
[2012-07-27 19:27:58 -0400] mattray: typically you use a data bag or something shared for that
[2012-07-27 19:28:09 -0400] otterley: what's the use case?
[2012-07-27 19:28:55 -0400] qhartman: I am working on figuring out methods for sharing SSH pub keys in particular ways among a few different servers for setting up Postgres replication and PGPool configuration and failover support.
[2012-07-27 19:29:10 -0400] otterley: yeah, that's a tricky problem
[2012-07-27 19:29:15 -0400] qhartman: I want the PG slaves to gut the master's pubkey for initial sync
[2012-07-27 19:29:34 -0400] qhartman: then all the pg hosts to get the pgpool's pubkey for creating failover trigger files
[2012-07-27 19:29:52 -0400] otterley: we store public keys in cookbook files and dist them out where they need to be
[2012-07-27 19:30:12 -0400] otterley: disting private keys is a headache unto itself
[2012-07-27 19:30:13 -0400] qhartman: yeah, I have these generated on the fly because I want each set to have a different
[2012-07-27 19:30:31 -0400] qhartman: don't want one cluster to accidentally hammer the data on another cluster because someone mis-keyed a hostname or IP or something
[2012-07-27 19:31:20 -0400] otterley: assuming the number of clusters you have is bounded to some reasonable number, you can probably still store them statically
[2012-07-27 19:31:35 -0400] qhartman: I'll just have the pgpool host store it on one of it's own attribs and then have the pg servers get it from there. IF I could have put it on the PG master it would have just saved some  code.
[2012-07-27 19:31:38 -0400] qhartman: \no biggie
[2012-07-27 19:32:07 -0400] rsimmons_: should this work: knife search node 'role:somerole AND (NOT chef_environment:local)'
[2012-07-27 19:32:28 -0400] rsimmons_: Assuming of course I have that role and environment...
[2012-07-27 19:33:44 -0400] qhartman: I think you can pull out the and and the perens and it will work
[2012-07-27 19:34:19 -0400] qhartman: you also need perens around the whole search string though I know
[2012-07-27 19:34:35 -0400] qhartman: oops, no not true
[2012-07-27 19:34:36 -0400] rsimmons_: Your first answer does work.  Very nice.
[2012-07-27 19:35:00 -0400] qhartman: yay!
[2012-07-27 19:35:01 -0400] rsimmons_: I couldn't seem to arrive at that from the docs.
[2012-07-27 19:35:06 -0400] rsimmons_: Thanks very much.
[2012-07-27 19:35:09 -0400] qhartman: sure thing
[2012-07-27 19:35:13 -0400] qhartman: glad to help
[2012-07-27 19:39:14 -0400] EJC: @mattray and @siezer - you two rule - I owe you beer
[2012-07-27 19:39:38 -0400] mattray: EJC: careful, aren't you based out of Austin?
[2012-07-27 19:41:20 -0400] EJC: no sir....
[2012-07-27 19:41:29 -0400] EJC: you'll have to travel a bit further to claim your beer
[2012-07-27 19:41:31 -0400] mattray: looks like you guys have offices all over.
[2012-07-27 19:41:32 -0400] EJC: but it's cold and free
[2012-07-27 19:41:36 -0400] mattray: :)
[2012-07-27 19:41:40 -0400] EJC: yeah, I faked that up a bit
[2012-07-27 19:42:04 -0400] EJC: ok, punching out - bbl - thanks again you two
[2012-07-27 20:04:18 -0400] martinisoft: Question for anyone about, I'm running chef-client 0.10.8 on a system that I installed via Omnibus, do I run the omnibus script again to bump it to the latest version?
[2012-07-27 20:13:52 -0400] qhartman: martinisoft, I'm sure, I don't use onmibus myself, but if I were a guessing man I'd say yes. Also a google for "omnibus chef opscode upgrade" would probably give a hit.
[2012-07-27 20:15:39 -0400] spox: martinisoft: http://community.opscode.com/cookbooks/omnibus_updater lets you do upgrades based on attribute value
[2012-07-27 20:17:41 -0400] martinisoft: ah cool
[2012-07-27 20:17:47 -0400] martinisoft: I was poking around to find that
[2012-07-27 20:18:09 -0400] martinisoft: all I initially found was a bug ticket open from someone who attempted to run the omnibus installer and things got messy
[2012-07-27 20:26:14 -0400] martinisoft: thanks spox and qhartman
[2012-07-27 20:27:13 -0400] qhartman: sure thing
[2012-07-27 20:36:49 -0400] stephenl: is there a way to delete an organization on hosted chef?
[2012-07-27 20:37:03 -0400] stephenl: also, i'm getting a weird error today on one org
[2012-07-27 20:38:46 -0400] stephenl: chef run is trying to connect to S3 and throwing this error getaddrinfo: node name or service name not known
[2012-07-27 20:38:58 -0400] stephenl: only happens on one of our orgs
[2012-07-27 20:39:06 -0400] stephenl: everything works fine on a different org
[2012-07-27 20:40:59 -0400] jessicab: stephenl: you can get it deleted by just opening a support ticket
[2012-07-27 20:41:28 -0400] stephenl: ok thank you
[2012-07-27 20:42:18 -0400] jessicab: stephenl: and that error makes it sound like youre not connecting to a public ip or fqdn perhaps? ive seen that on ec2 when people need to specify a different attribute to connect with using knife ssh
[2012-07-27 20:43:10 -0400] stephenl: this only happens on one organization, all the are working fine
[2012-07-27 20:44:48 -0400] jessicab: this has more info on what im talking about.. perhaps you might want to compare what each org has for the internal fqdn since thats what it uses by default http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step6%3ARunchefclientonthenewclientnode
[2012-07-27 20:44:58 -0400] jessicab: not sure ive ever seen that with s3 though, just ec2
[2012-07-27 20:58:42 -0400] hoover_damm: stephenl, s3 buckets are actual domain names
[2012-07-27 20:59:04 -0400] hoover_damm: stephenl, so if your getting an error getaddrinfo() on a s3 bucket it means it cannot look up the hostname for the bucket your trying to connect to.
[2012-07-27 20:59:25 -0400] stephenl: i found the error, nameserver ips were not being set on the node
[2012-07-27 20:59:29 -0400] hoover_damm: ouch
[2012-07-27 20:59:33 -0400] stephenl: thanks though :)
[2012-07-27 20:59:35 -0400] stephenl: haha
[2012-07-27 20:59:35 -0400] hoover_damm: dns-servers not set in /etc/network/interfaces?
[2012-07-27 20:59:47 -0400] hoover_damm: with resolvconf installed?
[2012-07-27 20:59:49 -0400] hoover_damm: ;)
[2012-07-27 20:59:57 -0400] stephenl: yeah, resolv recipe needed default ips
[2012-07-27 21:00:04 -0400] stephenl: and had changed env without adding them in
[2012-07-27 21:00:05 -0400] stephenl: my bad
[2012-07-27 21:00:17 -0400] hoover_damm: ahh
[2012-07-27 21:03:54 -0400] xmltok: what is the preferred method for handling nodes which reuse a client name? for examlpe, if i have testnode001 and i rebuild it over and over again, i need to manually go into the interface and remove the old client for it to be allowed to use the validation.pem to register
[2012-07-27 21:04:29 -0400] mattray: xmltok: knife node delete testnode001 -y; knife client delete testnode001 -y
[2012-07-27 21:04:51 -0400] xmltok: but that won't work without the client.pem, right?
[2012-07-27 21:05:09 -0400] mattray: do that before you bootstrap the replacement
[2012-07-27 21:06:04 -0400] xmltok: there is no way to do it as part of the provisioning process on the replacement? i am dealing with thousands of machines and several times that of virtual machines
[2012-07-27 21:07:45 -0400] mattray: so it's a VM that comes up with the same name everytime?
[2012-07-27 21:08:19 -0400] xmltok: yeah, it will happen as we scale servers up and down
[2012-07-27 21:08:38 -0400] mattray: then just call the client/node delete before you bootstrap. Something's calling knife bootstrap automatically?
[2012-07-27 21:08:43 -0400] xmltok: could i provision nodes using a hash as a client name and after they have registered in chef, delete the old client name and rename the client?
[2012-07-27 21:09:05 -0400] xmltok: also happens when we pxeboot/preseed new servers, id like the same solution for both
[2012-07-27 21:09:31 -0400] mattray: yeah, I have that issue when pxebooting too, I haven't automated it away yet
[2012-07-27 21:10:25 -0400] mattray: somewhere there's a patch that allows nodes to reuse names
[2012-07-27 21:11:09 -0400] mattray: xmltok: if you don't care about the names, use -N and pass something unique
[2012-07-27 21:11:18 -0400] xmltok: i think what i will do is provision nodes and register with a random hash client name, then after chef is configured, knife delete the final name, and basically follow this thruogh http://tech.superhappykittymeow.com/?p=292
[2012-07-27 21:11:35 -0400] xmltok: im not sure i care about names but i dont want my chef databases to fill up with client naems over time either
[2012-07-27 21:12:12 -0400] mattray: yeah, that looks like it should work
[2012-07-27 21:15:34 -0400] yevgenko: hi there
[2012-07-27 21:16:02 -0400] heydrick1: does ruby code in an lwrp execute before the regular resources in the lwrp?
[2012-07-27 21:18:03 -0400] yevgenko: How to check in a recipe if it running by chef-solo?
[2012-07-27 21:21:30 -0400] barefoot: yevgenko: if Chef::Config[:solo] ?
[2012-07-27 21:23:38 -0400] cakehero: anyone here using resque?
[2012-07-27 21:23:55 -0400] cakehero: I don't' want to restart it with each run and I don't have a service wrapper, looking for a service wrapper or some advice
[2012-07-27 21:25:42 -0400] grantr: cakehero, probably best to restart it as part of your deploy process, whatever that is
[2012-07-27 21:26:02 -0400] cakehero: I would prefer not to restart it unless it changed
[2012-07-27 21:26:15 -0400] cakehero: because we have many other components that would likely change before our app using rescue
[2012-07-27 21:28:08 -0400] jkyle: I'm getting the following error: DEBUG: Sending HTTP Request via POST to api.opscode.com:443/organizations/myorganization/environments/the-environment/cookbook_versions -----> 403 Forbidden
[2012-07-27 21:30:14 -0400] jkyle: I'm reading under "common errors" on the opscode wiki for 403. Per the recommendation there, I've gone to hosted chef, environments, and found the troublesome. It says to enable CREATE permissions if theproblem was a POST...but no CREATE permission exists
[2012-07-27 21:32:36 -0400] xmltok: mattray: I think that is even more complicated than it needs to be, since I need to have knife configured to do the delete, I should be able to configure knife when I configure chef-client and just run the knife delete commands before I start chef-client for the first time
[2012-07-27 21:32:43 -0400] xmltok: I'm trying it now, the hash trick also worked in testing
[2012-07-27 21:33:37 -0400] jkyle: in fact, I've given the node every permission available and still get a 403
[2012-07-27 21:46:01 -0400] anthroprose: jkyle: check perms of the group the node is a member of
[2012-07-27 21:46:15 -0400] anthroprose: I've had it happen where the node has full perms, but the group it is a member of does not
[2012-07-27 21:46:19 -0400] anthroprose: hosted chef no likey
[2012-07-27 21:46:44 -0400] karsten: When creating a new cookbook with knife, can you do so from anywhere within a repo, or *only* from the ./cookbooks/ subdir?  Docs suggest the latter: http://wiki.opscode.com/display/chef/Cookbook+Fast+Start+Guide#CookbookFastStartGuide-CreatingyourownCookbooks
[2012-07-27 21:51:06 -0400] knuckolls: karsten: i often create cookbooks by copy pasting other cookbooks and cleaning them up or making the folders and files by hand
[2012-07-27 21:51:27 -0400] knuckolls: cookbooks are folders that can live anywhere. usually in ./cookbooks or ./site-cookbooks
[2012-07-27 21:51:34 -0400] knuckolls: knife just needs to know where to search for them
[2012-07-27 21:51:36 -0400] knuckolls: in the knife.rb
[2012-07-27 21:52:00 -0400] knuckolls: mine is in <chef-repo>/.chef/knife.rb so the directive looks like this
[2012-07-27 21:52:02 -0400] knuckolls: cookbook_path            ["#{current_dir}/../cookbooks","#{current_dir}/../site-cookbooks"]
[2012-07-27 21:58:31 -0400] yevgenko: barefoot: thanks, works like a charm!
[2012-07-27 22:00:50 -0400] Majost: Does anyone have an example of using a data bag within a role?
[2012-07-27 22:05:20 -0400] tarnfeld: Hey
[2012-07-27 22:05:37 -0400] tarnfeld: I can't work out how to use the --ssh-gateway option with knife bootstrap, nor can I find any documentation
[2012-07-27 22:05:53 -0400] tarnfeld: Should I just specify the host, not sure where I can specify login credentials for the gateway
[2012-07-27 22:06:53 -0400] knuckolls: tarnfeld: haven't used it but you can use your .ssh/config file in your local home directory to handle all that
[2012-07-27 22:07:00 -0400] knuckolls: defaults for your gateway
[2012-07-27 22:08:43 -0400] tarnfeld: Hrmm I see
[2012-07-27 22:12:52 -0400] Majost: Perhaps I should rephrase my question; does anyone have a json role example in which an attribute is to the value data bag item?
[2012-07-27 22:16:18 -0400] mattray: Majost: no
[2012-07-27 22:16:27 -0400] mattray: Majost: roles don't have access to data bags
[2012-07-27 22:16:33 -0400] Majost: ah
[2012-07-27 22:16:48 -0400] mattray: you'd access the data bag in a recipe, then push it onto the node as an attribute if that's what you wanted
[2012-07-27 22:19:01 -0400] Majost: mattray: What I am really trying to do is a default_unless for a db password; where it would generate a password unless a value is already set/obtained from an encrypted data bag
[2012-07-27 22:19:17 -0400] Majost: but it sounds like this may be a limitation at the moment
[2012-07-27 22:19:53 -0400] mattray: Majost: yeah, just have a recipe that looks for the data bag and sets the password if it's unset
[2012-07-27 22:30:22 -0400] jackery: Anyone ever run into an error like this:
[2012-07-27 22:30:24 -0400] jackery: [Fri, 27 Jul 2012 15:28:16 -0700] FATAL: Chef::Exceptions::Package: package[ntp] (ntp::default line 20) had an error: Chef::Exceptions::Package: Yum failed - #<Process::Status: pid 10705 exit 1> - returns: ["This system is not registered with RHN.\n", "RHN support will be disabled.\n", "Traceback (most recent call last):\n", "  File \"/opt/chef/embedded/lib/ruby/gems/1.9.1/gems/chef-10.12.0/lib/chef/provider/package/yum-dump.py\", line 279, in ?\n", "    statu
[2012-07-27 22:30:45 -0400] jackery: Package installs fine with yum normally
[2012-07-27 22:32:43 -0400] cheeseplus: jackery: I'd run it with "-l debug" since that message *should* just be a warning
[2012-07-27 22:32:50 -0400] cheeseplus: it being chef-client
[2012-07-27 22:32:55 -0400] jackery: cheeseplus: Thanks for the tip!
[2012-07-27 22:33:02 -0400] nobdraisentone: Try to play with chef-solo. Chef::Exceptions::CannotDetermineNodeName: Unable to determine node name: configure node_name or configure the system's hostname and fqdn . I set :node_name = "", but nothing changes
[2012-07-27 22:33:26 -0400] cheeseplus: the cookbook may just not be handling the return properly
[2012-07-27 22:34:22 -0400] Knife: Is there a simple knife command that will download everything from the chef server.
[2012-07-27 22:34:22 -0400] Majost: Is there any functional difference between these two:
[2012-07-27 22:34:23 -0400] Majost: node[:attribute]
[2012-07-27 22:34:23 -0400] Majost: node['attribute']
[2012-07-27 22:35:17 -0400] cheeseplus: Majost: functional, no
[2012-07-27 22:35:27 -0400] macros: Sad that the cookbook and environemtn apis don't expose the upload time
[2012-07-27 22:35:28 -0400] nobdraisentone: Majost: it's about strings and symbols
[2012-07-27 22:35:37 -0400] countdigi: nobdraisentone: i put this line in my chef-solo.conf:
[2012-07-27 22:35:41 -0400] cheeseplus: we actually updated our cookbook from the former, to the latter for the purposes of foodcritic
[2012-07-27 22:35:50 -0400] countdigi: node_name        %x{ uname -n }.chomp
[2012-07-27 22:36:09 -0400] cheeseplus: Majost: http://acrmp.github.com/foodcritic/#FC001
[2012-07-27 22:36:26 -0400] nobdraisentone: countdigi: ok
[2012-07-27 22:36:28 -0400] cheeseplus: Majost: also https://github.com/acrmp/foodcritic/issues/1
[2012-07-27 22:36:31 -0400] countdigi: just a hack though
[2012-07-27 22:36:47 -0400] countdigi: im fairly new so there may be a better way
[2012-07-27 22:36:57 -0400] Majost: huh
[2012-07-27 22:36:58 -0400] Majost: thanks
[2012-07-27 22:36:59 -0400] Majost: =)
[2012-07-27 22:37:20 -0400] cheeseplus: heh, thank jtimberman for enlightening us all
[2012-07-27 22:38:01 -0400] macros: With timestamps I could write a plugin comparing last run times for nodes with cookbooks/roles/env to get an idea of what hasn't made it out
[2012-07-27 22:38:02 -0400] Knife: How does one download all data bags from the chef-server
[2012-07-27 22:38:37 -0400] ashb: macros: seen `knife status` command?
[2012-07-27 22:38:55 -0400] macros: Yes, of course, but that doesn't give me what I want
[2012-07-27 22:39:07 -0400] ashb: can't you just query the same timestamps?
[2012-07-27 22:39:14 -0400] macros: I can guess the timelines for cookbooks/env/roles based on git commits
[2012-07-27 22:39:31 -0400] ashb: oh cookbook mod times
[2012-07-27 22:39:46 -0400] macros: Yeah, the api doesn't expose timestamps on anything but node objects
[2012-07-27 22:40:04 -0400] ashb: doesn't expose but stores? could you query rabbitmq directly then?
[2012-07-27 22:40:17 -0400] macros: Hosted, needs to come out of the api
[2012-07-27 22:40:20 -0400] ashb: ah
[2012-07-27 22:40:37 -0400] hoover_damm: macros, there's so much to index... so little time
[2012-07-27 22:40:37 -0400] cheeseplus: was going to answer Knife's question... :(
[2012-07-27 22:40:40 -0400] ashb: you could hack around it with a custom data bag and a knife plugin I think
[2012-07-27 22:40:43 -0400] ashb: its a bit dirty though
[2012-07-27 22:41:12 -0400] hoover_damm: macros, you could always use graphite to graph that though
[2012-07-27 22:41:32 -0400] hoover_damm: https://github.com/jonlives/knife-spork
[2012-07-27 22:41:37 -0400] macros: Wouldn't be hard to make a knife plugin to capture, but that assumes I could get everyone to use it everywhere
[2012-07-27 22:41:53 -0400] macros: I'm saying this seems like a hole in the api to me
[2012-07-27 22:41:57 -0400] macros: And offering up a use case
[2012-07-27 22:42:03 -0400] ashb: macros: that sounds like and easier problem than getting the change made to the API
[2012-07-27 22:42:13 -0400] ashb: or at least quicker short term solution
[2012-07-27 22:42:33 -0400] macros: I don't have a pressing need, just something I thought of the other night
[2012-07-27 22:42:41 -0400] ashb: if you have a .chef/knife.rb in your git repo doesn't that force the plugin on everyone? (I don't actually know how you install them)
[2012-07-27 22:42:51 -0400] macros: That doesn't cover knife plugins
[2012-07-27 22:43:12 -0400] hoover_damm: i shove my knife plugins in .chef/plugins
[2012-07-27 22:43:16 -0400] hoover_damm: in our chef-repo
[2012-07-27 22:43:31 -0400] hoover_damm: and they just clone the chef-repo and manup and run the knife plugin
[2012-07-27 22:43:31 -0400] hoover_damm: :)
[2012-07-27 22:43:39 -0400] macros: :)
[2012-07-27 22:44:02 -0400] hoover_damm: I should put knife-essentials in our chef-repo that way
[2012-07-27 22:44:11 -0400] hoover_damm: so we don't have to install the gem anymore
[2012-07-27 22:44:56 -0400] hoover_damm: doing that with knife-spork I think would be the proper thing to do too... that way end-user is used to as their every day pattern and they can't throw it away so easily
[2012-07-27 22:45:02 -0400] hoover_damm: and if you do... fire them appropriately
[2012-07-27 22:45:03 -0400] hoover_damm: :)
[2012-07-27 22:45:08 -0400] hoover_damm: s/you/they
[2012-07-27 22:47:48 -0400] nobdraisentone: How can I run some bash command in recipe and raise an exeption if exit_code in !=0
[2012-07-27 22:47:52 -0400] nobdraisentone: ?
[2012-07-27 22:49:47 -0400] juliancdunn: nobdraisentone: if you use the "execute" resource you can specify acceptable return codes
[2012-07-27 22:50:08 -0400] nobdraisentone: Where can I found some specs about it?
[2012-07-27 22:50:09 -0400] papertigers: I have a .each |num| going over some values (1,2,3).  Inside of the .each I am doing an execute and using the numbers in a way such that dir1 dir2 dir3 get created.  The problem is I have a not_if "test -d dir#{num}".  The not_if seems to ignore the number changing.  However execute will create 1 2 and 3 without the not_if
[2012-07-27 22:50:19 -0400] cheeseplus: nobdraisentone: http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-07-27 22:50:28 -0400] nobdraisentone: cheeseplus: thanks
[2012-07-27 22:50:38 -0400] cheeseplus: return is what you are looking for
[2012-07-27 22:51:57 -0400] countdigi: papertigers: is entire resource def within the .each ?
[2012-07-27 22:52:31 -0400] papertigers: countdigi: yeah its the .each execute block end
[2012-07-27 22:52:53 -0400] papertigers: hmm maybe I can use creates
[2012-07-27 22:55:03 -0400] papertigers: creates has the intended output, ill just use that
[2012-07-27 22:55:33 -0400] countdigi: im playing w/ it interested cause it sounds like it should work the way u described
[2012-07-27 22:56:41 -0400] papertigers: countdigi: it seems like the not_if gets populated only once so that it keeps test -d dir1 and it causes it to ignore dir2 and dir3's creation
[2012-07-27 22:57:25 -0400] papertigers: I really hate writing cookbooks for packages that come in a tar (aka splunk)
[2012-07-27 22:57:28 -0400] countdigi: right but whats getting me is each resource should be discrete.. normal ruby executes and generates 3 resources which should be separate when the converge step happens
[2012-07-27 23:08:55 -0400] countdigi: papertigers: i seem to be geting the same behavior is this what u have basically? https://gist.github.com/3190941
[2012-07-27 23:09:50 -0400] papertigers: countdigi: exactly
[2012-07-27 23:10:21 -0400] papertigers: using creates fixes it
[2012-07-27 23:10:54 -0400] countdigi: im fairly new so i am more interested in the why - although i understand ya gotta get it working
[2012-07-27 23:11:38 -0400] countdigi: you could even do something like "[ -d #{dir} ] || mkdir -p #{dir}" in a pinch :-)
[2012-07-27 23:13:19 -0400] papertigers: countdigi: thanks, I just need to have multiple splunk indexers and to do that I have to untar the tar and create three uniqe paths
[2012-07-27 23:13:23 -0400] papertigers: grr
[2012-07-27 23:13:27 -0400] nobdraisentone: http://pastebin.com/ZBPdwJ5Z what does it mean? Chef it creating template and what is `/var/chef` about?
[2012-07-27 23:14:39 -0400] chrisstreeter: does anyone know how to pass the settings hash to the application blocks in the application_{python,} cookbooks?
[2012-07-27 23:15:05 -0400] chrisstreeter: for example, in the application_python cookbook, there is a way to pass arbitrary settings to the django local_settings.py file
[2012-07-27 23:15:05 -0400] countdigi: nobdraisentone: what user are you running chef as?
[2012-07-27 23:15:13 -0400] chrisstreeter: what does that setting look like?
[2012-07-27 23:15:22 -0400] nobdraisentone: countdigi: user user
[2012-07-27 23:15:32 -0400] countdigi: whats ls -al /var/chef show
[2012-07-27 23:15:42 -0400] nobdraisentone: countdigi: no such dir
[2012-07-27 23:15:49 -0400] countdigi: or ls -ald /var/chef
[2012-07-27 23:16:04 -0400] nobdraisentone: Actually it's chef-solo
[2012-07-27 23:16:20 -0400] countdigi: think it still uses /var/chef
[2012-07-27 23:16:36 -0400] nobdraisentone: What for?
[2012-07-27 23:16:40 -0400] countdigi: permissions
[2012-07-27 23:16:44 -0400] countdigi: ls -ld /var/chef
[2012-07-27 23:17:00 -0400] countdigi: ah
[2012-07-27 23:17:18 -0400] countdigi: you need to set your chef root i think
[2012-07-27 23:17:28 -0400] nobdraisentone: How?
[2012-07-27 23:17:29 -0400] bawt: How is it possible to specify architecture for yum package install? E.g. from command line I would do "yum install glibc.i686", how can I do it in Chef package resource? It seams that currently I cannot do package "glibc.i686" { action :install }
[2012-07-27 23:17:37 -0400] countdigi: i set mine to the root of the chef-solo directory in chef-solo.conf like this:
[2012-07-27 23:17:43 -0400] countdigi: chef_root = File.dirname(File.expand_path(__FILE__)) + "/.."
[2012-07-27 23:17:44 -0400] chrisstreeter: nevermind to my question, I figured it out :)
[2012-07-27 23:19:14 -0400] countdigi: or u can hard code it
[2012-07-27 23:19:42 -0400] nobdraisentone: countdigi: I use chef-sole -c ./solo.rb. I add that string to it and nothing happens
[2012-07-27 23:20:26 -0400] countdigi: i am assuming your solo.rb is in config so thats why the "/.."
[2012-07-27 23:20:33 -0400] countdigi: just take off the + "/.."
[2012-07-27 23:20:48 -0400] nobdraisentone: No, it's still loking for /var/chef
[2012-07-27 23:20:55 -0400] nobdraisentone: looking*
[2012-07-27 23:21:27 -0400] nobdraisentone: solo.rb is a config, it's not in config
[2012-07-27 23:21:34 -0400] countdigi: understand
[2012-07-27 23:21:53 -0400] countdigi: what is the directory that solo.rb is in and do you have a cookbooks file in the same dir?
[2012-07-27 23:21:58 -0400] countdigi: cookbooks dir that is
[2012-07-27 23:22:38 -0400] nobdraisentone: $> ls
[2012-07-27 23:22:39 -0400] nobdraisentone: chef-solo-run.sh  config.json  cookbooks  roles  solo.rb
[2012-07-27 23:23:10 -0400] nobdraisentone: chef-solo-run is `chef-solo -c solo.rb -j config.json`
[2012-07-27 23:23:24 -0400] countdigi: can u pastebin your solo.rb?
[2012-07-27 23:24:29 -0400] nobdraisentone: countdigi: http://pastebin.com/bwyaJ30X
[2012-07-27 23:24:52 -0400] countdigi: ill show you mine - but the chef_root should be different: https://gist.github.com/3191008
[2012-07-27 23:25:39 -0400] countdigi: so your chef_root should be File.dirname(__FILE__)
[2012-07-27 23:25:46 -0400] countdigi: dont worry about the expand_path for now
[2012-07-27 23:41:41 -0400] nobdraisentone: Can someone help with that? https://gist.github.com/f52d0bee92128037537c
