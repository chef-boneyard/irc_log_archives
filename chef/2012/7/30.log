[2012-07-30 00:16:13 -0400] johnny123: If I use bootsrap to install chef server and chef client, do I still need to keep solo? Do I have to keep it?
[2012-07-30 00:17:53 -0400] ssd7: johnny123: chef-solo is shipped in the same package as chef-client, so it will still be on your system, but you won't need to use it anymore. :)
[2012-07-30 00:18:54 -0400] johnny123: ssd7 thanks for response. i don't quite know how to use irc so i dont know how to respose to you direct. can i turn that off?
[2012-07-30 00:20:12 -0400] ssd7: No worries, I'm a bit confused about what you want to turn off.
[2012-07-30 00:21:19 -0400] johnny123: I want to turn off solo if i dont need it anymore. is it possible?
[2012-07-30 00:22:31 -0400] erikh: if you run chef-client you will not run chef-solo
[2012-07-30 00:22:34 -0400] erikh: they're different commands.
[2012-07-30 00:23:58 -0400] ssd7: johnny123: chef-solo can't do anything if it isn't running.  If you started it as a daemon (with the -d flag) you can simply stop the process.  If you are on a unix-like system, you can see if it is running by doing something like: sudo ps auxww|grep '[c]hef-solo'
[2012-07-30 00:24:41 -0400] erikh: wow, TIL chef-solo can daemonize
[2012-07-30 00:25:50 -0400] ssd7: erikh: Me too :)
[2012-07-30 00:26:39 -0400] tigris_: ha! me too :)
[2012-07-30 00:26:44 -0400] johnny123: great. i got you, ssd7 thanks! if i have more questions i will ask more :)
[2012-07-30 00:30:01 -0400] tigris_: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings says chef-solo can't daemon, but chef-solo --help says it can
[2012-07-30 00:32:43 -0400] ssd7: Looks like it was added here: https://github.com/opscode/chef/commit/9b077b5d46fedfbb44c60f2837f119036d2ac141
[2012-07-30 00:33:54 -0400] ssd7: tigris_: Wiki page looks right to me ;)
[2012-07-30 00:34:18 -0400] tigris_: i'm stracing my daemon now, will wait 1800 seconds to see what happens i guess... i suspect it will just run with the same commands i gave on the CLI when i daemoned it... 3 minutes is a weird interval default
[2012-07-30 00:34:40 -0400] tigris_: ssd7: haha, well done!
[2012-07-30 00:35:54 -0400] ssd7: Off to try a new Mexican resturaunt in my neighborhood.  Cheers all!
[2012-07-30 00:37:37 -0400] tigris_: disfruten!
[2012-07-30 00:42:55 -0400] lilydenver: To use knife command, I must first gem install chef right? does knife:server command also boostrap install a new chef client (not chef server)? Thanks!
[2012-07-30 01:15:24 -0400] g-rider: hey now... chef newbie I'm trying to install the mysql cookbook and it's complaining about a windows cookbook not existing. this is on ubuntu 11.04
[2012-07-30 01:15:48 -0400] g-rider: this is via a hosted chef trial
[2012-07-30 01:17:22 -0400] lastobelus: currently the mysql cookbook depends on windows
[2012-07-30 01:17:27 -0400] lastobelus: cookbook
[2012-07-30 01:17:31 -0400] lastobelus: a bug has been filed
[2012-07-30 01:17:51 -0400] paulmooring: Hi g-rider probably the cookbook you're using supports windows and has `depends 'windows'` in the metadata file
[2012-07-30 01:18:15 -0400] paulmooring: you can safely remove the windows dependency if you're not running windows
[2012-07-30 01:18:35 -0400] paulmooring: and as lastobelus said there's a bug filed to fix this in the future
[2012-07-30 01:19:30 -0400] lastobelus: http://tickets.opscode.com/browse/COOK-1237?focusedCommentId=25216&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel
[2012-07-30 01:20:21 -0400] lastobelus: does anyone know how/why a node's attributes can be out of sync with the node def'n on the chef server?
[2012-07-30 01:20:37 -0400] lastobelus: this is happening in shef:
[2012-07-30 01:21:06 -0400] paulmooring: lastobelus: it depends on a few things, but the short answer is a node is saved/indexed at the end of a Chef run
[2012-07-30 01:21:29 -0400] paulmooring: so if Chef hasn't run in a while or if indexing is busted then the server won't always be accurate
[2012-07-30 01:22:05 -0400] lastobelus: hmm, this is at startup. the node doesn't seem to get its override attributes for a role
[2012-07-30 01:22:08 -0400] lastobelus: chef > search(:node, "name:bob").first['haproxy'] => #<Chef::Node::Attribute ... @current_override={"app_server_role"=>"app_server"}, ...>
[2012-07-30 01:22:08 -0400] lastobelus: chef > node  => <Chef::Node:0x1544ab0 @name="bob"> chef >
[2012-07-30 01:22:09 -0400] lastobelus: chef > node['haproxy'] => #<Chef::Node::Attribute... @current_automatic=nil, ...>
[2012-07-30 01:23:42 -0400] paulmooring: so I think this might be related to confusion about how over ride attributes work
[2012-07-30 01:24:13 -0400] paulmooring: There's a lot of detail here if you want the details: http://wiki.opscode.com/display/chef/Attributes
[2012-07-30 01:25:08 -0400] paulmooring: but basically node is an object built off several things (ohai, attributes on the server, and default/override/automatic attributes)
[2012-07-30 01:25:37 -0400] paulmooring: so the search should not match the current node object in terms of override attribtues
[2012-07-30 01:26:53 -0400] lastobelus: interesting. the odd thing is that this is using ironfan, and when I launch the cluster it works, and haproxy has the right app_server_role set, but when my coworker launches the same cluster the above happens
[2012-07-30 01:26:55 -0400] paulmooring: and when I say should not, there might be cases where it does, but in the context of a chef-client run override attributes are reset every run
[2012-07-30 01:27:06 -0400] ssd7: Also, beware of testing role/environment attributes in shef,  it has bugs that directly affect the proper handling of attributes.
[2012-07-30 01:27:57 -0400] lastobelus: the override attributes are being set in a role, that SHOULD be applied to the node.
[2012-07-30 01:28:13 -0400] lastobelus: and the role is in the bad node's runlist
[2012-07-30 01:28:16 -0400] lastobelus: so I'm lost
[2012-07-30 01:29:52 -0400] paulmooring: lastobelus: let me make sure I understand the question.  You have some override attributes set, these attributes don't match the values being returned from search
[2012-07-30 01:30:09 -0400] lastobelus: it's the other way around
[2012-07-30 01:30:22 -0400] lastobelus: the override attributes are set by a role (haproxy role)
[2012-07-30 01:30:27 -0400] lastobelus: chef server says they are set
[2012-07-30 01:30:34 -0400] lastobelus: shed on the node says they aren't
[2012-07-30 01:30:39 -0400] lastobelus: shef
[2012-07-30 01:30:50 -0400] ssd7: lastobelus: paulmooring Yes, I think that is a bug in shef.  One second and I can find the ticket
[2012-07-30 01:31:02 -0400] lastobelus: the whole process of bootstrapping the node is automated -- via ironfan
[2012-07-30 01:31:22 -0400] paulmooring: lastobelus: in that case ignore everything I said, I'm sure ssd7 is on the right track
[2012-07-30 01:31:29 -0400] lastobelus: ok
[2012-07-30 01:31:30 -0400] paulmooring: sorry for the misunderstanding
[2012-07-30 01:31:30 -0400] lastobelus: thx
[2012-07-30 01:31:48 -0400] ssd7: http://tickets.opscode.com/browse/CHEF-2467
[2012-07-30 01:31:56 -0400] g-rider: paulmooring: how do I remove the windows dependency/
[2012-07-30 01:31:57 -0400] g-rider: ?
[2012-07-30 01:32:07 -0400] ssd7: So, that is what would cause them to be wrong in shef.  Are you seeing them wrong in other places as well?
[2012-07-30 01:32:20 -0400] paulmooring: g-rider: you can just edit the metadata file and re-upload it
[2012-07-30 01:32:55 -0400] paulmooring: I happen to know this has already been fixed for the next release, so future upgrades shouldn't bite you
[2012-07-30 01:33:04 -0400] g-rider: oh can you point me to an article in hosted chef
[2012-07-30 01:33:12 -0400] g-rider: I used git to clone the package in my chef-repo dir
[2012-07-30 01:33:16 -0400] g-rider: so that's probably step 1
[2012-07-30 01:33:24 -0400] lastobelus: ssd7: yeah, the node is missing the ['haproxy']['app_server_role'] when chef-client runs, so it can't find any appservers
[2012-07-30 01:33:24 -0400] ssd7: Sigh, I should really just put a patch in with that fix I mention since it is still biting people and no one has gotten around to auditing the rest of the Shef initialization code.
[2012-07-30 01:33:58 -0400] paulmooring: g-rider: so you likely have a cookbooks folder in your chef-repo
[2012-07-30 01:34:00 -0400] lastobelus: so perhaps the bug explains why it seems to be correct when I use shef
[2012-07-30 01:34:16 -0400] paulmooring: so there should be a cookbooks/mysql/metadata.rb file
[2012-07-30 01:34:20 -0400] g-rider: right so I see it has suggest windows
[2012-07-30 01:34:24 -0400] g-rider: I just commented that out with #
[2012-07-30 01:34:25 -0400] ssd7: lastobelus: Hrmmm. So can you post a gist of where it is failing in your recipe?
[2012-07-30 01:34:36 -0400] lastobelus: sure
[2012-07-30 01:34:43 -0400] paulmooring: in a text editor, open the file and look for 'depends
[2012-07-30 01:34:46 -0400] paulmooring: "windows"
[2012-07-30 01:34:54 -0400] ssd7: Override and Default attributes are wiped out at the beginning fo the run and then rebuilt
[2012-07-30 01:35:06 -0400] lastobelus: actually, then haproxy recipe doesn't fail it just doesn't find any appservers
[2012-07-30 01:35:08 -0400] paulmooring: just delete that line, then re-upload (`knife cookbook upload mysql`)
[2012-07-30 01:35:14 -0400] g-rider: paul: yeah it's listed as suggested
[2012-07-30 01:35:41 -0400] g-rider: hmm so I still get the same error
[2012-07-30 01:35:48 -0400] ssd7: lastobelus: OK.  So knife node show NODENAME shows the attribute on the nodes but it doesn't show up in a search against that attribute?
[2012-07-30 01:35:54 -0400] g-rider: running  knife cookbook upload mysql
[2012-07-30 01:35:58 -0400] paulmooring: g-rider: suggested shouldn't throw that error
[2012-07-30 01:36:07 -0400] g-rider: as though it's  not looking at the mysql in chef-repo
[2012-07-30 01:36:35 -0400] paulmooring: so you get the error when trying to upload it, or when trying to use it?
[2012-07-30 01:36:42 -0400] g-rider: when I upload
[2012-07-30 01:37:08 -0400] lastobelus: ssd7: correct
[2012-07-30 01:37:13 -0400] lastobelus: from dev machine:
[2012-07-30 01:37:16 -0400] paulmooring: and the exact command you're running is 'knife cookbook upload mysql'
[2012-07-30 01:37:27 -0400] g-rider: ~/chef-repo# knife cookbook upload mysql
[2012-07-30 01:37:44 -0400] ssd7: lastobelus: So that is probably unrelated to the bug I mentioned above unfortunately.
[2012-07-30 01:37:48 -0400] g-rider: and in chef-repo/mysql I changed the metadata.rb
[2012-07-30 01:37:55 -0400] lastobelus: from dev machine knife show node bob -ahaproxy  has the app_server_role set
[2012-07-30 01:38:01 -0400] lastobelus: ok
[2012-07-30 01:38:05 -0400] lastobelus: so still a mystery
[2012-07-30 01:38:10 -0400] paulmooring: g-rider: what's the exact error you get?
[2012-07-30 01:38:17 -0400] lastobelus: any idea how to kick the node to get it in sync?
[2012-07-30 01:38:23 -0400] g-rider: ~/chef-repo# knife cookbook upload mysql
[2012-07-30 01:38:23 -0400] g-rider: Uploading mysql             [1.2.6]
[2012-07-30 01:38:24 -0400] g-rider: ERROR: Cookbook mysql depends on cookbook windows version >= 0.0.0,
[2012-07-30 01:38:24 -0400] g-rider: ERROR: which is not currently being uploaded and cannot be found on the server.
[2012-07-30 01:38:36 -0400] g-rider: do I need to do the install again?
[2012-07-30 01:38:46 -0400] paulmooring: no you shouldn't
[2012-07-30 01:39:10 -0400] g-rider: can I get more debug from knife to point me to my next steps in debugging? or do I strace?
[2012-07-30 01:39:27 -0400] paulmooring: yeah knife $cmd -VV
[2012-07-30 01:39:32 -0400] ssd7: lastobelus: Can you post the output of knife node show NODENAME -a haproxy and a knife search node with the relvant search?
[2012-07-30 01:39:36 -0400] paulmooring: is always verbose for knife commands
[2012-07-30 01:39:49 -0400] ssd7: lastobelus: To something like gist.github.com?
[2012-07-30 01:40:11 -0400] g-rider: okay so I see it goes to my hosted chef
[2012-07-30 01:40:13 -0400] paulmooring: so you can run `knife cookbook upload mysql -VV` and if you want to throw it in a gist I can take a look
[2012-07-30 01:40:22 -0400] lastobelus: ssd7: sure
[2012-07-30 01:40:29 -0400] g-rider: dumb questions whats a gist?
[2012-07-30 01:40:56 -0400] martinisoft: g-rider: https://gist.github.com
[2012-07-30 01:41:01 -0400] g-rider: yeah I see it going to the hosted chef api server to get the cookbook as though it's ignoring what's local under chef-repo (or that's what it looks like to my eyes
[2012-07-30 01:41:02 -0400] paulmooring: like paste bin, it's an easy way to share text
[2012-07-30 01:42:18 -0400] g-rider: https://gist.github.com/3203220
[2012-07-30 01:42:26 -0400] g-rider: dude thats dope thanks for telling me about that
[2012-07-30 01:42:31 -0400] lastobelus: ssd7: https://gist.github.com/3203222
[2012-07-30 01:43:24 -0400] paulmooring: g-rider: fwiw I just re-downloaded the current mysql cookbook, and it definitely has depends "windows"
[2012-07-30 01:43:37 -0400] paulmooring: any chance you were editing the wrong cookbook?
[2012-07-30 01:44:12 -0400] g-rider: weird
[2012-07-30 01:44:14 -0400] g-rider: possible
[2012-07-30 01:44:17 -0400] g-rider: let me nuke the dir
[2012-07-30 01:44:21 -0400] g-rider: and git clone again
[2012-07-30 01:44:27 -0400] g-rider: what target did you use
[2012-07-30 01:44:28 -0400] martinisoft: curious Chef question: Is there an automated way to run security updates via Chef?
[2012-07-30 01:44:54 -0400] paulmooring: g-rider: I was using `knife cookbook site download mysql`
[2012-07-30 01:45:14 -0400] g-rider: okay what do you do with the tar
[2012-07-30 01:45:20 -0400] g-rider: un tar in chef repo?
[2012-07-30 01:45:21 -0400] ssd7: lastobelus: So everything you've posted there is what I would expect given the bug I posed above regarding shef
[2012-07-30 01:45:25 -0400] paulmooring: using knife should get the latest release, github is not guaranteed stable
[2012-07-30 01:45:37 -0400] paulmooring: g-rider: you untag it to cookbooks
[2012-07-30 01:45:41 -0400] g-rider: tar zxvf the file?
[2012-07-30 01:45:55 -0400] ssd7: Does knife search node 'haproxy_app_server_role:app_server' return the expected nodes?
[2012-07-30 01:46:12 -0400] paulmooring: alternatively you can use `knife cookbook site install mysql` and download it straight to the cookbooks dir with dependencies
[2012-07-30 01:46:25 -0400] paulmooring: it also sets up a git branch for you
[2012-07-30 01:46:55 -0400] paulmooring: I personally prefer to you install over download all the time
[2012-07-30 01:47:05 -0400] g-rider: oh dude paul this was an operator error
[2012-07-30 01:47:06 -0400] ssd7: Someone should write something to de-interleve conversations in IRC.
[2012-07-30 01:47:09 -0400] g-rider: I did a git clone in chef-repo
[2012-07-30 01:47:15 -0400] g-rider: I didn't realize they had a cookbooks dir
[2012-07-30 01:47:40 -0400] paulmooring: ssd7: to be fair this a lot more Chef debugging than I would expect on a Sunday night :)
[2012-07-30 01:47:47 -0400] g-rider: does anyone have a apache j2ee mysql cookbook?
[2012-07-30 01:48:09 -0400] g-rider: because i'm doing all of these independently but if they had that ready to go like the lamp or j2ee/mysql quickstart that would be awesome
[2012-07-30 01:48:34 -0400] lastobelus: ssd7: it returns the load balancer node
[2012-07-30 01:48:45 -0400] lastobelus: ssd7: i.e. the node in question
[2012-07-30 01:49:04 -0400] ssd7: lastobelus: OK.  But your search in the recipe does not?
[2012-07-30 01:49:19 -0400] paulmooring: g-rider: there's an application_java cookbook
[2012-07-30 01:49:27 -0400] paulmooring: I have no experience with it though
[2012-07-30 01:49:38 -0400] lastobelus: as far as I can tell, since it adds no servers to the haproxy.cfg (though I have not actually logged the results of the search yet)
[2012-07-30 01:50:02 -0400] lastobelus: I wonder if it is a chicken egg problem
[2012-07-30 01:50:23 -0400] lastobelus: because the node has never yet successfully run chef-client, so it is still using first-boot.json
[2012-07-30 01:50:38 -0400] lastobelus: which contains no attributes
[2012-07-30 01:50:39 -0400] g-rider: ahh interesting
[2012-07-30 01:50:44 -0400] lastobelus: other than node name tec.
[2012-07-30 01:50:48 -0400] lastobelus: ec.
[2012-07-30 01:50:59 -0400] paulmooring: g-rider: I'm out of here for the night, feel free to bother me in here tomorrow if you're still playing with this stuff
[2012-07-30 01:50:59 -0400] ssd7: lastobelus: I think I am a bit confused on your structure.  A node cannot be searched on until it has been saved.
[2012-07-30 01:51:11 -0400] ssd7: That is, it won't show up in search until it is saved.
[2012-07-30 01:51:25 -0400] g-rider: paul -- thanks feel free to hit me up on network stuff
[2012-07-30 01:51:31 -0400] g-rider: thats what i'm an expert on and thanks for the help
[2012-07-30 01:51:40 -0400] paulmooring: np have a good night
[2012-07-30 01:51:48 -0400] lastobelus: ssd7: not sure on the mechanics, because this happens via ironfan
[2012-07-30 01:52:01 -0400] g-rider: you too thakns
[2012-07-30 01:52:08 -0400] ssd7: Depending on the exact use case, I sometimes get around issues like that by doing the search and then explicitly adding the current node to the result list.
[2012-07-30 01:52:59 -0400] ssd7: lastobelus: Yeah, so everything you've shown so far is behavior that I would expect (except for the Shef results, but that is a known bug and should affect your chef-client runs)
[2012-07-30 01:53:15 -0400] ssd7: I think to dig deeper I would need to know a bit more about what is going one
[2012-07-30 01:53:18 -0400] ssd7: s/one/on/
[2012-07-30 01:54:11 -0400] lastobelus: ssd7: ironfan is trying to bring up loadbalancer & app servers in parallel, so maybe it is a timing issue that just never affected me when I was launching the cluster. I'll get my coworker to bootstrap the app servers first and then bootstrap the load balancer and see if that changes anything
[2012-07-30 01:55:28 -0400] ssd7: In completely off-topic news, this is how I am going to react from now on everytime I figure something out at work: http://deadspin.com/5929962/this-italian-fencers-celebration-after-winning-a-semifinal-is-fantastic
[2012-07-30 01:57:52 -0400] lastobelus: man this issue seems like it could suck enormous amounts of time to track down what exactly is going on
[2012-07-30 01:59:57 -0400] ssd7: lastobelus: Your theory sounds about right
[2012-07-30 02:00:07 -0400] ssd7: you can't depend on nodes coming up concurrently being in search
[2012-07-30 02:01:31 -0400] hoover_damm: lastobelus, or you can make your cookbook more resillient to the search of lack of servers
[2012-07-30 02:02:17 -0400] ssd7: You're options in these situations tend to be (1) structure your cookbooks to not not only depend on search (perhaps use a databag), (2) ensure that the cookbook can handle not getting nodes back and that on the next chef-client run you will get pulled closer to properly configured, (3) implement some sort of lock.
[2012-07-30 02:02:31 -0400] ssd7: I don't really like (3), but lots of people do it.
[2012-07-30 02:02:57 -0400] lastobelus: ironfan actually has an announce/discover mechanism which sounds like it may solve this problem
[2012-07-30 02:02:57 -0400] hoover_damm: lastobelus, basically throw your search into a variable, and then you can do an if variable.length > 1
[2012-07-30 02:03:16 -0400] hoover_damm: Noah would solve this better
[2012-07-30 02:03:26 -0400] hoover_damm: you could then block/wait for the application servers to be ready/available
[2012-07-30 02:03:28 -0400] lastobelus: but I was just using the opscode haproxy cookbook at the moment. I need to look at adapting it to the announce/discovery setup
[2012-07-30 02:03:30 -0400] hoover_damm: before proceeding
[2012-07-30 02:05:52 -0400] lastobelus: cool, thx for the ideas
[2012-07-30 02:06:29 -0400] hoover_damm: lastobelus, orchestration is something that opscode I believe is going to handle a little bit more on their end soon
[2012-07-30 02:06:43 -0400] lastobelus: that would be awesome
[2012-07-30 02:06:50 -0400] hoover_damm: lastobelus, but for the time being you'll find many different ways and just try to avoid cutting yourself too much :/
[2012-07-30 02:06:59 -0400] hoover_damm: indeed
[2012-07-30 02:07:11 -0400] lastobelus: I'm hoping to get to spend some time to look in to ironfan's  announce/discover mechanism this week
[2012-07-30 02:09:06 -0400] lastobelus: not sure how it works behind the scenes but it seems to somehow accomplish push instead of pull, so as each  app_server announces itself, the load_balancer will re-run the resource that creates the haproxy template
[2012-07-30 02:16:26 -0400] martinisoft: anyone here have experience with the apt/ubuntu cookbooks from opscode?
[2012-07-30 02:17:01 -0400] ssd7: Some, what is up?
[2012-07-30 02:19:32 -0400] martinisoft: looking into how i can automate security updates via Chef
[2012-07-30 02:20:02 -0400] hoover_damm: martinisoft, there's a package for that in ubuntu... not really the same thing
[2012-07-30 02:20:07 -0400] martinisoft: reading up on a few methods, but I'm not sure if there is something I missed in the Wiki about running security updates via cookbooks, etc
[2012-07-30 02:20:41 -0400] hoover_damm: martinisoft, https://help.ubuntu.com/community/AutomaticSecurityUpdates/
[2012-07-30 02:20:45 -0400] martinisoft: reason I ask about the apt/ubuntu cookbooks is if there was a way to do that
[2012-07-30 02:21:02 -0400] hoover_damm: martinisoft, it seems best to automate what ubuntu suggests
[2012-07-30 02:21:05 -0400] g-rider: what's a good resource for understanding the architectural considerations for chef
[2012-07-30 02:21:06 -0400] martinisoft: yeah, would cron-apt be a decent method of doing that?
[2012-07-30 02:21:21 -0400] g-rider: to really understand how it's organized how it differs from puppet etc
[2012-07-30 02:21:42 -0400] g-rider: where data is organized how to manage application builds vs config files etc
[2012-07-30 02:21:53 -0400] hoover_damm: martinisoft, works for Ubuntu people :)
[2012-07-30 02:22:00 -0400] hoover_damm: and actually I enable that by default in our preseed
[2012-07-30 02:22:03 -0400] martinisoft: cool :)
[2012-07-30 02:22:10 -0400] hoover_damm: just because it's annoying to have to deal with that
[2012-07-30 02:22:16 -0400] martinisoft: ah
[2012-07-30 02:22:27 -0400] martinisoft: I was just wondering aloud if this is a solved problem in the Chef world
[2012-07-30 02:22:36 -0400] martinisoft: and I missed a magical cookbook somewhere :D
[2012-07-30 02:24:18 -0400] hoover_damm: not that i have seen
[2012-07-30 02:28:31 -0400] ssd7: It would be cool if someone packaged up the recommendations on that page into a recipe though.  Could easily see that in the ubuntu cookbook. :)
[2012-07-30 02:41:06 -0400] g-rider: dude having an issue with python on chef... hosted chef python pip virtual environment error
[2012-07-30 02:41:22 -0400] g-rider: I checked the net and they have a patch... I applied the patch and i'm still getting the same error
[2012-07-30 02:43:40 -0400] hoover_damm: rescue on the pip provider?
[2012-07-30 02:44:04 -0400] hoover_damm: how nice of him
[2012-07-30 02:44:06 -0400] hoover_damm:  :)
[2012-07-30 02:44:14 -0400] g-rider: https://github.com/lastobelus/python/commit/4c2e7d734c3c184f875d6afaa2d8e89f2b0fe440
[2012-07-30 02:44:16 -0400] g-rider: that was the fix
[2012-07-30 02:44:37 -0400] g-rider: heh
[2012-07-30 02:44:39 -0400] g-rider: yeah on pip
[2012-07-30 02:45:31 -0400] hoover_damm: hrm slightly new one for me
[2012-07-30 02:45:32 -0400] hoover_damm: doh
[2012-07-30 02:46:38 -0400] g-rider: yeah this is odd
[2012-07-30 02:46:52 -0400] g-rider: I did the patch as it suggested but now I just get a different error
[2012-07-30 02:53:03 -0400] g-rider: yeah trying to hack around this issue
[2012-07-30 02:58:54 -0400] lily: i ran knife server standalone on a new ubuntu 10.04
[2012-07-30 02:58:58 -0400] lily: and i got this ERROR: Errno::EACCES: Permission denied - /etc/chef/validation.pem
[2012-07-30 02:59:22 -0400] lily: there are many other errors. like /var/rabbitmq direct is not created, etc during installation
[2012-07-30 02:59:27 -0400] lily: any idea whats the problem?
[2012-07-30 03:00:17 -0400] lily: my target machine starts with only openssh besides the stuff built into the server edition. just openssh.
[2012-07-30 03:01:05 -0400] lily: knife server standalone --host <ip>  --node-name <hostname i filled in during installation> --ssh-user <the admin acc i created during installation>
[2012-07-30 03:01:17 -0400] lily: thats the command i issued.
[2012-07-30 03:01:45 -0400] lily: knife server bootstrap my bad
[2012-07-30 03:07:35 -0400] ssd7: I haven't looked at that plugin too much, but looks like a permission issue to me
[2012-07-30 03:07:43 -0400] g-rider: hmm
[2012-07-30 03:07:47 -0400] g-rider: anyone on my pip problem?
[2012-07-30 03:07:49 -0400] ssd7: Are you running as sudo?
[2012-07-30 03:07:53 -0400] lily: yeah i see another ticket on github 13 days ago
[2012-07-30 03:08:02 -0400] lily: u mean i need to issue the command as sudo?
[2012-07-30 03:08:18 -0400] lily: i can try that.
[2012-07-30 03:08:56 -0400] ssd7: lily: One sec, I'll take a quick look at the plugin
[2012-07-30 03:09:07 -0400] ssd7: g-rider: Probably best to post a gist of the error message you are getting
[2012-07-30 03:09:09 -0400] lily: thanks ssd7
[2012-07-30 03:10:02 -0400] g-rider: https://gist.github.com/3203884
[2012-07-30 03:11:38 -0400] ssd7: lily: On its face it looks like is it soidn the right thing: https://github.com/fnichol/knife-server/blob/master/lib/chef/knife/server_bootstrap_standalone.rb#L63
[2012-07-30 03:12:21 -0400] lily: @ssd7 yeah i just tried that. sudo makes it work. weird setting.
[2012-07-30 03:13:13 -0400] g-rider: here is the -l debug output
[2012-07-30 03:13:13 -0400] g-rider: https://gist.github.com/3203914
[2012-07-30 03:13:33 -0400] ssd7: g-rider: and you said you already applied the patch here:
[2012-07-30 03:13:45 -0400] ssd7: https://github.com/lastobelus/python/commit/4c2e7d734c3c184f875d6afaa2d8e89f2b0fe440
[2012-07-30 03:14:15 -0400] g-rider: I did that
[2012-07-30 03:14:21 -0400] g-rider: and then I did git add that file
[2012-07-30 03:14:25 -0400] g-rider: and re-ran chef client
[2012-07-30 03:14:29 -0400] g-rider: did I miss a step?
[2012-07-30 03:15:44 -0400] ssd7: g-rider: Unsure, so you are saying that you cloned the chef repository and then applied that fix?
[2012-07-30 03:15:59 -0400] ssd7: If so, then you will also need to build a new gem for yourself and install it on your node
[2012-07-30 03:16:17 -0400] lily: after reboot the machine, i see chef-solr failed to start. jetty doesn't start either so db failed. more googling now! thanks.
[2012-07-30 03:16:24 -0400] ssd7: g-rider: Ignore that
[2012-07-30 03:16:35 -0400] ssd7: got my wires crossed
[2012-07-30 03:16:48 -0400] g-rider: well in my cookbooks I found that python/providers/pip.rb
[2012-07-30 03:16:51 -0400] g-rider: I edited that file
[2012-07-30 03:17:01 -0400] g-rider: with the new content
[2012-07-30 03:17:03 -0400] ssd7: g-rider: Right, so did you also upload the patched cookbook?
[2012-07-30 03:17:07 -0400] g-rider: and re-ran chef-client
[2012-07-30 03:17:11 -0400] g-rider: oh I have to run upload again?
[2012-07-30 03:17:17 -0400] ssd7: knife cookbook upload python
[2012-07-30 03:17:19 -0400] g-rider: shit
[2012-07-30 03:17:27 -0400] g-rider: why is that what do these commands really do
[2012-07-30 03:17:33 -0400] g-rider: I'm operating chef in a dangerous way ;)
[2012-07-30 03:18:04 -0400] g-rider: yes that fixed it
[2012-07-30 03:18:20 -0400] g-rider: i really need a good primer on architecturally what's going on instead of just hammering away hacking through
[2012-07-30 03:20:17 -0400] ssd7: g-rider: You might want to start here: http://wiki.opscode.com/display/chef/Chef+Basics
[2012-07-30 03:20:43 -0400] g-rider: perfect
[2012-07-30 03:35:59 -0400] lily: okay  i cant really solve the problem. but i need to get my stuff setup ASAP, but i am gonna back to manual installation....
[2012-07-30 03:39:32 -0400] flaccid: hosted chef works :)
[2012-07-30 04:00:32 -0400] g-rider: oh what
[2012-07-30 04:00:39 -0400] g-rider: no mod_jk on apache2 cookbook
[2012-07-30 04:06:48 -0400] addisonj: hey, just new to chef and trying to figure out best practices for configuring my app. Mostly node.js apps that look for environment variables to point to DB, connect to other services, etc. Whats the best way to configure this on per stack, per environment level?
[2012-07-30 04:12:31 -0400] sascha_d: g-riderthat shouldn't too tough to add if it's not there
[2012-07-30 04:12:45 -0400] sascha_d: a module setup and then a template
[2012-07-30 04:14:33 -0400] coderanger: sascha_d: ::smack:: back to work :P
[2012-07-30 04:14:54 -0400] sascha_d: IKR? I'd rather help someone else figure out their problems than work on my own
[2012-07-30 04:15:27 -0400] sascha_d: aren't you supposed to be in New Zealand or something?
[2012-07-30 04:17:50 -0400] coderanger: Next month :)
[2012-07-30 04:18:09 -0400] sascha_d: o
[2012-07-30 04:22:43 -0400] lily: quick question about chef-solo
[2012-07-30 04:23:12 -0400] lily: do i need to install chef on my laptop if i want to use the boostrap method to install chef server and chef client?
[2012-07-30 04:23:26 -0400] lily: if i am not wrong, knife comes with chef, right?
[2012-07-30 04:26:48 -0400] coderanger: Yes, you generally install the chef gem on your dev machine
[2012-07-30 04:33:22 -0400] tigris_: i dev on vagrant, vagrant have chef provisioning built in
[2012-07-30 05:01:38 -0400] lily: thank you @coderanger!
[2012-07-30 05:04:26 -0400] lily: knife bootstrap IP_ADDR -d ubuntu10.04-apt --sudo will tell me
[2012-07-30 05:05:54 -0400] lily: ERROR: /etc/chref/validation.pem does not exist
[2012-07-30 05:06:02 -0400] lily: i thought knife bootstrap supposes to generate one
[2012-07-30 05:16:53 -0400] coderanger: lily: No, its a part of the chef-server setup, you need to use a modified bootstrap setup if you are just doing solo
[2012-07-30 05:19:36 -0400] lily: but the documentation said to setup chef server using boostrap first install chef-solo, and u can install that through bootstrap. that was kinda confusing. i googled a bit and found in an old irc log you said this pem has to grab from my local machine hmmm
[2012-07-30 05:20:49 -0400] coderanger: lily: Ahh getting the server setup the first time can be a bit dicey
[2012-07-30 05:20:57 -0400] coderanger: Are the omnibus server builds out yet?
[2012-07-30 05:21:00 -0400] coderanger: I've lost track of those
[2012-07-30 05:22:05 -0400] lily: ahaha thanks coderanger. i think i'd do it manually for now. like apt-get method but i have a few basica questions to ask again.... sorry for being a noob. the doc is just vast!
[2012-07-30 05:23:41 -0400] lily: if i need to upload a cookbook from a development machine, like my laptop, or my work pc, what do i do? do i need those pem? what exactly is needed?
[2012-07-30 05:34:18 -0400] BryanWB_: ohai chefs!
[2012-07-30 05:44:26 -0400] ssd7: Ohai!
[2012-07-30 05:45:35 -0400] BryanWB_: ohai!
[2012-07-30 07:00:34 -0400] tolland: is there a short way to disable/auto login the admin user to the webui
[2012-07-30 07:01:01 -0400] tolland: I have it protected by a portal page, the double login is unneccesary
[2012-07-30 08:54:10 -0400] Guest96021: hey guys, is there a way to use "search" in a template file?
[2012-07-30 08:58:32 -0400] Guest96021: hey guys, is there a way to use "search" in a template file?
[2012-07-30 09:06:02 -0400] Guest96021: hey guys, is there a way to use "search" in a template file?
[2012-07-30 09:10:22 -0400] matti: Guest96021: Relax, and calm down on repeating the question :)
[2012-07-30 09:10:47 -0400] matti: Guest96021: If you need to keep a track / get answer quicker, then try Google groups / mailing list.
[2012-07-30 09:10:54 -0400] Guest96021: :D i only repeat it, if some1 joined the channel
[2012-07-30 09:11:04 -0400] matti: ;p
[2012-07-30 09:11:32 -0400] matti: You inpatient you ;p
[2012-07-30 09:12:13 -0400] Guest96021: hmm, do you know the answer? :D
[2012-07-30 09:14:06 -0400] _rc: it's most likely possible, but in my book not a good idea.
[2012-07-30 09:14:26 -0400] _rc: our house style is you do the processing in the recipe, and templates are for dumb layout
[2012-07-30 09:17:10 -0400] BryanWB_: Guest96021: u can
[2012-07-30 09:17:37 -0400] BryanWB_: Guest96021: but probably cleaner to do it in ur recipe and pass results as a variable to the template
[2012-07-30 09:17:56 -0400] BryanWB_: will avoid typing lots of unneeded <%  ...  -%>
[2012-07-30 10:40:59 -0400] corp: anyone using openstack with chef?
[2012-07-30 10:42:37 -0400] cpasmoi: (nope)
[2012-07-30 10:43:26 -0400] cpasmoi: ok, I've messed up something in mysql::server and now I just don't know what is the mysql root's password. Is there a log with every shell command executed by chef ?
[2012-07-30 10:43:37 -0400] cpasmoi: or at least a chef log ?
[2012-07-30 10:44:18 -0400] cpasmoi: (don't see anything in /var/log/ or /var/cache)
[2012-07-30 10:44:19 -0400] corp: you wont see the password in the log
[2012-07-30 10:44:38 -0400] corp: if you didnt specify a log file in /etc/chef/client.rb, then the log would have gone to stdout
[2012-07-30 10:45:08 -0400] cpasmoi: I see things in stdout, but it isn't much...
[2012-07-30 10:45:47 -0400] corp: you can specify '-l debug' to get more detailed output
[2012-07-30 10:45:48 -0400] cpasmoi: ok, log level info
[2012-07-30 10:45:52 -0400] corp: on the command line
[2012-07-30 11:01:28 -0400] cpasmoi: thank you corp
[2012-07-30 11:25:51 -0400] Liku: Hi everyone!Can someone please tell me how to use attributes with gid and uid options from user resource?All variants I used gave me an error like:  FATAL: Chef::Exceptions::ValidationFailed: Option gid must be a kind of [Integer]!  You passed "602"
[2012-07-30 11:26:58 -0400] sampikesley: "602".to_i ?
[2012-07-30 11:27:08 -0400] tzn: what did you put there Liku?
[2012-07-30 11:27:44 -0400] Liku: at attributs file default['deploy']['user_gid'] = '602'    and at recipe gid node[:deploy][:user_gid]
[2012-07-30 11:28:04 -0400] Liku: attributes*
[2012-07-30 11:28:58 -0400] tzn: tried to remove ticks?
[2012-07-30 11:29:37 -0400] tzn: sampikesley tip might also work
[2012-07-30 11:31:10 -0400] Liku: sampikesley? what is it?( yes, without ticks same erro
[2012-07-30 11:34:14 -0400] Liku: just tried sampi
[2012-07-30 11:34:26 -0400] Liku:  tip, seems work :)
[2012-07-30 11:35:30 -0400] Liku: sampikesley, thank a lot it works!
[2012-07-30 11:36:09 -0400] sampikesley: I would expect default['deploy']['user_gid'] = 602 also to work
[2012-07-30 11:36:32 -0400] sampikesley: but whatever
[2012-07-30 12:45:16 -0400] masterkorp: Guys any cookbooks to show stuff in the MOTD related to the node ?
[2012-07-30 12:48:46 -0400] _rc: masterkorp: https://github.com/opscode-cookbooks/motd-tail
[2012-07-30 12:49:03 -0400] masterkorp: Yeah i got that one, but thanks :)
[2012-07-30 12:49:40 -0400] masterkorp: _rc: for the effort of helping a stranger http://i31.tinypic.com/aa7kv8.jpg
[2012-07-30 13:09:18 -0400] wonko_be: hi, is there a way to force a certain version of a recipe/cookbook in a role (run_list: "recipe[apache]-version-1.2.3" ...)
[2012-07-30 13:09:34 -0400] jwitrick: wonko_be: try to use environments
[2012-07-30 13:10:05 -0400] geekbri: You guys should really load your jquery plugin via the HTTPS site instead of HTTP on your secure pages
[2012-07-30 13:10:15 -0400] wonko_be: no way around it without environments?
[2012-07-30 13:11:18 -0400] wonko_be: (not that i'm not willing to use them, I already do, I just want a "old-apache-style" role, using an older version of my cookbooks)
[2012-07-30 13:11:24 -0400] jwitrick: {"run_list":["recipe[nginx@1.2.3]"]}
[2012-07-30 13:11:32 -0400] jwitrick: try that.http://wiki.opscode.com/display/chef/Version+Constraints
[2012-07-30 13:12:01 -0400] wonko_be: yes - thats what I was looking for
[2012-07-30 13:12:04 -0400] wonko_be: thanks a lot
[2012-07-30 13:32:52 -0400] stormerider: is there a quick tutorial for how to use the users cookbook anywhere? the rdoc info is a little too sparse for me.
[2012-07-30 14:07:44 -0400] Zenigor: What would be the best way to call a new rackspace server creation in a gem using the knife-rackspace gem api? I'm having a hard time getting it to work correctly
[2012-07-30 14:10:43 -0400] ssd7: Ohai Chefs
[2012-07-30 14:11:36 -0400] masterkorp: hello
[2012-07-30 14:15:47 -0400] geekbri: yarrrr
[2012-07-30 14:19:20 -0400] obazoud: BryanWB_, I have some time to talk about tomcat and jmxtrans recipes
[2012-07-30 14:19:55 -0400] BryanWB_: obazoud: hey dude
[2012-07-30 14:19:59 -0400] BryanWB_: kewl
[2012-07-30 14:20:20 -0400] BryanWB_: obazoud: have u had a chance to look at the new way i template the main json file?
[2012-07-30 14:20:44 -0400] BryanWB_: obazoud: https://github.com/bryanwb/chef-jmxtrans/blob/master/templates/default/set1.json.erb
[2012-07-30 14:22:49 -0400] cnf: where is knife cookbook create name supposed to make the new cookbook?
[2012-07-30 14:24:23 -0400] sampikesley: default is in your knife.rb
[2012-07-30 14:24:32 -0400] sampikesley: you can specify with -o, though
[2012-07-30 14:25:00 -0400] cnf: sampikesley: under what name?
[2012-07-30 14:25:03 -0400] cnf: in my knife.rb
[2012-07-30 14:25:24 -0400] sampikesley: cookbook_path           [
[2012-07-30 14:25:25 -0400] sampikesley:                           "#{current_dir}/../chef-repo/cookbooks/",
[2012-07-30 14:25:25 -0400] cnf: it is saying it creates them
[2012-07-30 14:25:26 -0400] sampikesley: ]
[2012-07-30 14:25:34 -0400] cnf: but i can't find it
[2012-07-30 14:25:48 -0400] sampikesley: it probably defaults to /var/chef/something
[2012-07-30 14:25:51 -0400] sampikesley: but use -o
[2012-07-30 14:27:35 -0400] cnf: eird
[2012-07-30 14:28:31 -0400] sampikesley: locate will tell you where it went
[2012-07-30 14:29:03 -0400] cnf: no it won't :P
[2012-07-30 14:29:05 -0400] cnf: and nowhere
[2012-07-30 14:29:29 -0400] sampikesley: sudo updatedb
[2012-07-30 14:29:52 -0400] cnf: not configured
[2012-07-30 14:30:11 -0400] sampikesley: ?
[2012-07-30 14:30:24 -0400] cnf: i'm not on linux
[2012-07-30 14:30:30 -0400] sampikesley: find / -name your_cookbook
[2012-07-30 14:30:32 -0400] sampikesley: Oh
[2012-07-30 14:30:36 -0400] sampikesley: OK
[2012-07-30 14:30:59 -0400] BryanWB_: find  the beez kneez
[2012-07-30 14:31:07 -0400] sampikesley: results are undefined, then
[2012-07-30 14:31:55 -0400] cnf: but neither find nor mdfind show me my cookbook
[2012-07-30 14:32:00 -0400] cnf: like i said, it's not making it
[2012-07-30 14:32:10 -0400] sampikesley: so use -o
[2012-07-30 14:35:45 -0400] obazoud: BryanWB_, i like the new version :)
[2012-07-30 14:36:09 -0400] obazoud: BryanWB_, datasource should be optional i think
[2012-07-30 14:36:51 -0400] BryanWB_: obazoud: what mean by datasource? u mean whether to write to Graphite or ganglia?
[2012-07-30 14:37:31 -0400] obazoud: BryanWB_, NumActive/NumIdle in tomcat jmx query
[2012-07-30 14:38:16 -0400] BryanWB_: obazoud: ah i c
[2012-07-30 14:39:17 -0400] obazoud: BryanWB_, I have some applications with no tomcat datasource because I use NoSQL database
[2012-07-30 14:39:18 -0400] BryanWB_: i think in that case better to override  "tomcat" array altogether
[2012-07-30 14:39:27 -0400] BryanWB_: y i do too
[2012-07-30 14:40:08 -0400] BryanWB_: obazoud: well, the default should meet the needs of 70% of users, if less than 70% need those datasources then i should take it out
[2012-07-30 14:40:23 -0400] BryanWB_: do u think 70% of users will need that?
[2012-07-30 14:40:27 -0400] obazoud: BryanWB_, could you add an attribute for numQueryThreads ?
[2012-07-30 14:40:34 -0400] BryanWB_: gr8!
[2012-07-30 14:40:49 -0400] BryanWB_: totally, i don't know shit about jmx, more queries would be great
[2012-07-30 14:41:05 -0400] BryanWB_: numQueryThreads for DataSources?
[2012-07-30 14:41:17 -0400] yfeldblum: BryanWB_, every default should have a (simple!) way to override or to opt out
[2012-07-30 14:41:40 -0400] yfeldblum: BryanWB_, even if the default works for 95%
[2012-07-30 14:41:52 -0400] BryanWB_: yfeldblum: yeah, there is a simple way to override this
[2012-07-30 14:42:05 -0400] BryanWB_: as it is an attribute
[2012-07-30 14:42:35 -0400] yfeldblum: BryanWB_, ah ok, the question implied the attribute was required
[2012-07-30 14:42:43 -0400] BryanWB_: nope
[2012-07-30 14:43:49 -0400] BryanWB_: obazoud: any other queries or attributes I should add to the defaults?
[2012-07-30 14:45:49 -0400] obazoud: BryanWB_, I will push some additional queries if you like
[2012-07-30 14:45:58 -0400] BryanWB_: that would be awesome
[2012-07-30 14:46:07 -0400] BryanWB_: obazoud: what other functionality is missing?
[2012-07-30 14:46:49 -0400] obazoud: BryanWB_, is there a way to create a json file per sever ?
[2012-07-30 14:47:44 -0400] BryanWB_: obazoud: i honestly don't know, probably,
[2012-07-30 14:47:50 -0400] BryanWB_: that would be cleaner
[2012-07-30 14:48:15 -0400] BryanWB_: then i don't have to worry about commas
[2012-07-30 14:51:18 -0400] BryanWB_: hmm, maybe not
[2012-07-30 14:55:27 -0400] BryanWB_: seems to work, tho u have to wrap each server w/   { servers: [   ] } afaict
[2012-07-30 14:57:28 -0400] masterkorp: Can I force chef client to no update the cache ?
[2012-07-30 15:20:20 -0400] jforest: so... I'm just starting out with chef, feel free to say RTFM but... If I am having a config file notify a service to restart, can I have it notify 2 services to restart?
[2012-07-30 15:20:45 -0400] cwj: yes you can
[2012-07-30 15:21:36 -0400] jforest: just put it in an array? notfies [(:restart, "service[apache2]"), (:restart, "service[tomcat]")]
[2012-07-30 15:21:39 -0400] jforest: something like that?
[2012-07-30 15:21:50 -0400] jforest: can I just do 2 lines of "notifies"
[2012-07-30 15:22:10 -0400] cwj: i have just put multiple notification lines myself
[2012-07-30 15:23:31 -0400] mattray: jforest: you can also have the services use subscribe
[2012-07-30 15:23:41 -0400] mattray: strictly your preference
[2012-07-30 15:23:59 -0400] jforest: mattray: I've used puppet before, and I'm sort of used to doing it in classes
[2012-07-30 15:24:14 -0400] jforest: so, I'd have a class for config, that notifies the class for the service
[2012-07-30 15:24:21 -0400] mattray: jforest: sure
[2012-07-30 15:24:50 -0400] mbaxa: is there an environment variable to override where chef looks for a client.pem?
[2012-07-30 15:25:02 -0400] mbaxa: or do I *have* to have it in /etc/chef/
[2012-07-30 15:25:54 -0400] cwj: mbaxa: specify the path in your client.rb
[2012-07-30 15:26:36 -0400] cwj: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings
[2012-07-30 15:26:59 -0400] mbaxa: I was afraid of that
[2012-07-30 15:27:48 -0400] cwj: you can also specify it at the command line with the -k flag
[2012-07-30 15:27:51 -0400] cwj: chef-client --help
[2012-07-30 15:30:31 -0400] mbaxa: that isn't available for shef
[2012-07-30 15:31:35 -0400] chrisr244: Hi guys - a bit of a high level question from a Chef newbie. Right now we're using Jenkins for automatic deployment, and would like to integrate Chef into the process. Jenkins builds a .zip file for deployment with a specific version string. What'd be the best practice for "telling" Chef what version of the application it should be deploying?  (Sorry, probably a pretty basic question)
[2012-07-30 15:33:16 -0400] mattray: mbaxa: sounds like a legit ticket
[2012-07-30 15:34:11 -0400] mattray: chrisr244: frequently you keep that in a data bag, and have jenkins update that json file to push out a new version
[2012-07-30 15:34:12 -0400] sascha_d: chrisr244a dev team I worked with put the version in a data bag and then used search to set a variable in a recipe; You could also set up an attribute and then set an override attribute in the role or environment, if you are using environments
[2012-07-30 15:43:33 -0400] jforest: more stupid questions
[2012-07-30 15:43:46 -0400] jforest: if I want to use a variable name from ohai in an erb
[2012-07-30 15:44:03 -0400] jforest: say:     "local_ipv4": "10.255.126.107",
[2012-07-30 15:44:34 -0400] jforest: is it just <%= local_ipv4 %>
[2012-07-30 15:44:42 -0400] jforest: or do I have to call it in some other way?
[2012-07-30 15:44:58 -0400] jb____: node[:local_ipv4] probably
[2012-07-30 15:45:23 -0400] jforest: ok, so in the json it looks like it came from [cloud]
[2012-07-30 15:45:38 -0400] jforest: so node[cloud][:local_ipv4] ?
[2012-07-30 15:45:49 -0400] jb____: :cloud
[2012-07-30 15:46:01 -0400] jforest: ok
[2012-07-30 15:46:04 -0400] jforest: I shall try that :)
[2012-07-30 15:46:06 -0400] jforest: thanks
[2012-07-30 16:01:02 -0400] jforest: hrmm
[2012-07-30 16:01:09 -0400] jforest: I need variables from 2 differnet nodes I guess
[2012-07-30 16:01:22 -0400] jforest: that are assigned by ec2
[2012-07-30 16:01:39 -0400] jforest: any way ot do that?
[2012-07-30 16:05:35 -0400] jb____: jforest: databags
[2012-07-30 16:06:07 -0400] jforest: you can have node a add to databag, and node b to databag, then pull data out?
[2012-07-30 16:07:44 -0400] jforest: I shall explore
[2012-07-30 16:07:45 -0400] jforest: thanks gusy
[2012-07-30 16:10:20 -0400] jtimberman: fyi chefs, if you're interested in Chef managing OSX, I wrote an updated post here: http://bit.ly/osxchef
[2012-07-30 16:14:45 -0400] Jay_Levitt: I added a cookbook that uses apache2's web_app recipe. When I converge, I get an error that it can't find the web_app.conf.erb file - I think it's looking in my own cookbook.  Old chat log said to add "depends 'apache2'" to my metadata.rb, but that didn't seem to help..? my metadata.rb is otherwise empty.
[2012-07-30 16:15:51 -0400] juliancdunn: quick question about gem_package: I see "end.run_action(:install)" at the end of these clauses a lot. what does that mean?
[2012-07-30 16:23:13 -0400] ssd7: juliancdunn: That is used to get a resource to run at "compile time" such that it happens before the standard convergence phase of the chef-client run
[2012-07-30 16:23:34 -0400] ssd7: You see it on gem_package a lot becuase often the "convergence" phase requires the gem to be installed to run properly
[2012-07-30 16:23:50 -0400] ssd7: The new chef_gem resource handles the most common cases of that for you.
[2012-07-30 16:25:19 -0400] juliancdunn: oh perfect, thanks
[2012-07-30 16:25:32 -0400] juliancdunn: I'll use chef_gem instead since it does Gem.clear_paths too
[2012-07-30 16:25:37 -0400] ssd7: Yup!
[2012-07-30 16:28:34 -0400] dwhsix: jtimberman: nice write-up, looks interesting & useful
[2012-07-30 16:30:22 -0400] jforest: so, I'm trying to figure out, how do I add my ip to a databag when the node comes up?
[2012-07-30 16:38:09 -0400] upayavira: are there any issues with using svn post-commit hook to update chef-server?
[2012-07-30 17:26:59 -0400] jforest: hrmm
[2012-07-30 17:27:03 -0400] jforest: Altering data bags from the node when using the Open Source chef-server requires giving the node's API client admin privileges. In most cases, this is not advisable.
[2012-07-30 17:27:23 -0400] jforest: so... yah.
[2012-07-30 17:27:40 -0400] jforest: that sorta puts a damper on my idea.
[2012-07-30 17:32:30 -0400] jforest: so, if I need to set an IP from node a, and an IP from node b, in a config file on BOTH node a and node b... what is the best way to do this?
[2012-07-30 17:33:26 -0400] jforest: this is ec2... so I won't know the ip's before building the machines up
[2012-07-30 17:41:22 -0400] anthroprose: so I've got an instance where I'm bootstrapping new instances and it seems like the info from the LAUNCHING node is getting passed to the LAUNCHED node *instead* of the -N and other CLI options being passed...
[2012-07-30 17:42:41 -0400] anthroprose: Running: knife bootstrap x.x.x.x -y -c /etc/chef/client.rb -x ec2-user -i /xx/xx/xx.pem -r 'role[role1],recipe[recipe2]' -E 'Development' -N 'TEST-10-46-X-X' --sudo
[2012-07-30 17:43:19 -0400] anthroprose: Gets: [107] => x.x.x.x [Mon, 30 Jul 2012 17:39:23 +0000] INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate as
[2012-07-30 17:43:20 -0400] anthroprose: adminmachine. Ensure that your node_name and client key are correct.
[2012-07-30 17:43:42 -0400] anthroprose: this is usually because adminmachine already exists... which it does... but I told the node to be: TEST-10-46-X-X
[2012-07-30 17:43:55 -0400] anthroprose: this works *just* fine from other machines, so im assuming its some sort of file permission issue
[2012-07-30 17:46:51 -0400] miah: moin
[2012-07-30 17:50:07 -0400] yfeldblum: jforest, re "I'm trying to figure out, how do I add my ip to a databag when the node comes up?" - data bags aren't designed for this case; they're designed for *admins* to write to data bags and for admins and chef-clients to read from data bags; in chef, chef-clients typically write only to their own node objects, not to roles, environments, cookbooks, or data bags
[2012-07-30 17:50:28 -0400] yfeldblum: jforest, for your case, you might like to use search
[2012-07-30 17:50:41 -0400] withnale: Hi. I have a library that is used both by a chef recipe and standalone. Is there a way I can pass the Chef::Log object into my library so I can log via the normal chef logging when running via a cookbook?
[2012-07-30 17:51:17 -0400] jforest: yfeldblum: how so? I can query information about the nodes... so I can get the ips?
[2012-07-30 17:53:23 -0400] geekbri: moin!
[2012-07-30 17:53:31 -0400] yfeldblum: other_node_ips = search(:node, "tags:cluster-1a").map{|n| n["publicip"]} - node["publicip"]
[2012-07-30 17:53:50 -0400] yfeldblum: withnale, the normal chef logging is to use `Chef::Log.info("some text")`
[2012-07-30 17:54:29 -0400] yfeldblum: all_node_ips = other_node_ips + node["publicip"]
[2012-07-30 17:58:27 -0400] jb____: whats the preferred way to fire a apt-get update before any package-installation on debian/ubuntu?
[2012-07-30 17:58:47 -0400] jb____: dont want to make the update every run if its not necessary
[2012-07-30 18:02:42 -0400] spox: jb____: keep the default recipe of the apt cookbook at the start of your run list
[2012-07-30 18:03:25 -0400] jb____: spox: thanks
[2012-07-30 18:15:41 -0400] jforest: yfeldblum: so the only stuff I can search on is what is listed when I do "knife node show <nodename> -Fj
[2012-07-30 18:15:52 -0400] jforest: the problem is the private IP is not included in that
[2012-07-30 18:17:58 -0400] karsten: Is there a better/more reliable lint-type tool than food-critic?
[2012-07-30 18:20:10 -0400] jforest: ah
[2012-07-30 18:20:12 -0400] jforest: -l
[2012-07-30 18:20:12 -0400] jforest: LONG
[2012-07-30 18:36:49 -0400] chip-: I'm trying to imagine a world where there are way better things than foodcritic
[2012-07-30 18:36:54 -0400] chip-: I want to live in such a place
[2012-07-30 18:44:25 -0400] miah: foodcritic + tailor = happy miah
[2012-07-30 18:44:43 -0400] renchap: tailor ?
[2012-07-30 18:45:03 -0400] miah: https://github.com/turboladen/tailor
[2012-07-30 18:47:14 -0400] yfeldblum: jforest, remember, you can also store anything you like in the node's attributes - whether as a sysadmin setting an individual node's attributes, from a role, or from a recipe - and then you can also search on that
[2012-07-30 18:47:38 -0400] miah: though, modifying individual nodes is highly frowned upon
[2012-07-30 18:48:00 -0400] miah: because its harder to keep track of node attribute changes
[2012-07-30 18:48:14 -0400] hoover_damm: miah, lint happy huh?
[2012-07-30 18:49:25 -0400] yfeldblum: miah, i don't frown upon it :P
[2012-07-30 18:50:30 -0400] yfeldblum: miah, i'd suggest that approach as a viable and competitive option perhaps as part of a more comprehensive automation system which uses chef as the underlying system, but which presents the sysadmin with a higher-level interface than that provided by chef
[2012-07-30 18:53:25 -0400] yfeldblum: miah, or so long as the set of sysadmin-configured options are well-known (documented, and everybody on the team reads that documentation, and you've modified `knife node show` to note this special attribute too)
[2012-07-30 18:57:06 -0400] miah: ya. but i dont think many people are that comprehensive
[2012-07-30 18:58:44 -0400] CharlieSu: Anyone using the RabbitMQ cookbook in clustered mode?  If so how has it worked out for you?
[2012-07-30 19:00:07 -0400] dacali: Is there a way to mount a Windows share with a username and password (on Windows)?
[2012-07-30 19:01:56 -0400] miah: im trying to rewrite the search stuff the nagios cookbook uses into a more... sane rubyish way.. i suck at ruby still :/
[2012-07-30 19:02:21 -0400] ampledata: gist it
[2012-07-30 19:02:32 -0400] ampledata: feedback early :)
[2012-07-30 19:06:03 -0400] miah: my codes is here: https://github.com/miah/nagios/tree/refactor but most of the stuff i'm working on in server.rb is still local..
[2012-07-30 19:07:21 -0400] miah: (i just pushed but there is still tons local)
[2012-07-30 19:08:05 -0400] miah: time for lunch..
[2012-07-30 19:14:58 -0400] geekbri: miah: I really enjoy the ruby book from oreilly by flannigan and matsumoto
[2012-07-30 19:18:26 -0400] yfeldblum: miah, i actually prefer getting/setting node data using [] and []= notations to make clear that node data is data - not objects, not behavior, not methods, just data ...
[2012-07-30 19:26:55 -0400] jforest: ok, yfeldblum thank you, that solved my issues
[2012-07-30 19:27:02 -0400] bram_: how can i install a gem from another gem source? I tried gem_package with source "http://gem.mirror" but that doesn't work
[2012-07-30 19:27:24 -0400] bram_: i'm using chef 0.10.4
[2012-07-30 19:31:10 -0400] jforest: chefs search stuff is powerful, I didn't realize that from the puppet world
[2012-07-30 19:32:03 -0400] miah: geekbri: i have no shortage ~.
[2012-07-30 19:32:14 -0400] miah: geekbri: i have no shortage of ruby books (including that one)
[2012-07-30 19:32:23 -0400] miah: i just need more actual practice
[2012-07-30 19:32:29 -0400] miah: writing proper ruby code outside of chef
[2012-07-30 19:33:22 -0400] geekbri: miah: ahh yeah.  You know what i've been doing?  I've been going through one of my design pattern books and implementing the patterns in ruby.  It's good practice... sometimes depending on the pattern.. dull :)
[2012-07-30 19:34:09 -0400] yfeldblum: miah, write knife plugins to wrap up common operations, even throwaway plugins
[2012-07-30 19:34:59 -0400] yfeldblum: miah, that's one way to get practice with normal ruby code
[2012-07-30 19:35:27 -0400] miah: ya. i'm reading Design Patterns in Ruby, and Eloquent Ruby
[2012-07-30 19:35:30 -0400] miah: i've also read a few other books
[2012-07-30 19:35:41 -0400] yfeldblum: miah, another way is: write providers without relying on sub-resources within the provider actions
[2012-07-30 19:35:44 -0400] miah: ya
[2012-07-30 19:35:55 -0400] miah: so, i think im going to turn this nagios stuff into a proper provider
[2012-07-30 19:36:04 -0400] paulmooring: miah: Eloquent Ruby is excellent I suggest that to everyone who will listen to me
[2012-07-30 19:36:09 -0400] yfeldblum: miah, those are some things i do (granted, i'm a programmer primarily)
[2012-07-30 19:36:42 -0400] miah: paulmooring: yup
[2012-07-30 19:37:10 -0400] rabidpraxis: is there a way to do environment overrides in a role?
[2012-07-30 19:37:56 -0400] miah: rabidpraxis: attribute overrides based on environments? just store them in the environment?
[2012-07-30 19:38:06 -0400] miah: you can define different run_lists based on environments in roles
[2012-07-30 19:38:35 -0400] ampledata: env_run_list
[2012-07-30 19:38:49 -0400] miah: i only ever use env_run_list honestly.. i never define run_list
[2012-07-30 19:39:02 -0400] miah: i just always define _default in env_run_list
[2012-07-30 19:39:24 -0400] miah: (its generally empty)
[2012-07-30 19:39:44 -0400] rabidpraxis: these overrides are specific to a project(role) though, and I am using env_run_list, I want to alter my data
[2012-07-30 19:40:27 -0400] miah: guh my brain no work today
[2012-07-30 19:41:06 -0400] rabidpraxis: I could databag it, I was just wondering if there was another way to do role environment specific data
[2012-07-30 19:41:29 -0400] yfeldblum: rabidpraxis, what are you trying to accomplish?
[2012-07-30 19:42:24 -0400] rabidpraxis: I have some specific settings that I want to only be enacted in production of one project
[2012-07-30 19:43:10 -0400] yfeldblum: rabidpraxis, you can add a role for the one project for production
[2012-07-30 19:43:35 -0400] yfeldblum: roles/my-app-name-production.(json|rb), if you're keeping them in your chef-repo
[2012-07-30 19:44:29 -0400] rabidpraxis: ah, yeah, ok.
[2012-07-30 19:47:26 -0400] tubbo: hi guys i think i have a problem
[2012-07-30 19:47:34 -0400] tubbo: every time i provision a new box, i run sudo chef-client on it
[2012-07-30 19:47:39 -0400] tubbo: which errors out, saying that my environment is empty
[2012-07-30 19:47:44 -0400] tubbo: so i reupload my environment, and it all works
[2012-07-30 19:48:14 -0400] tubbo: why do i have to do this every time? i'm using knife to create an EC2 instance, and setting it up with the proper node, which should include the proper env
[2012-07-30 19:48:23 -0400] tubbo: it's very tedious
[2012-07-30 19:48:45 -0400] tubbo: also...chef doesn't tell me when i try to provision a box with a node that doesn't exist. it just waits until i run `sudo chef-client`, which is after the box is *already up*, to tell me
[2012-07-30 19:48:52 -0400] tubbo: is that normal?
[2012-07-30 19:49:16 -0400] miah: it sounds to me like you aren't registering nodes/clients when you create a new ec2 instance
[2012-07-30 19:49:19 -0400] miah: you should read about
[2012-07-30 19:49:20 -0400] miah: bootstrapping?
[2012-07-30 19:49:21 -0400] bawt: bootstrapping is really easy with capistrano
[2012-07-30 19:49:25 -0400] miah: bawt..
[2012-07-30 19:49:27 -0400] miah: bootstrap?
[2012-07-30 19:49:28 -0400] bawt: bootstrap is http://wiki.opscode.com/display/chef/Custom+Knife+Bootstrap+Script
[2012-07-30 19:49:36 -0400] miah: knife bootstrap/
[2012-07-30 19:49:38 -0400] miah: knife bootstrap?
[2012-07-30 19:49:39 -0400] bawt: knife bootstrap is http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-07-30 19:49:40 -0400] miah: =)
[2012-07-30 19:50:45 -0400] miah: bawt forget bootstrapping
[2012-07-30 19:50:45 -0400] bawt: fine
[2012-07-30 19:50:48 -0400] miah: THANKS
[2012-07-30 19:52:48 -0400] miah: i really think http://wiki.opscode.com/display/chef/Libraries needs a rewrite.. guh.
[2012-07-30 19:53:33 -0400] CharlieSu: Anyone know when chef-client will move to Ruby 1.9.3?  I'm noticing the client takes much longer to start now that i'm using 1.9.2 w/ omnibus
[2012-07-30 19:54:27 -0400] moos3: the chef client will automatically pull down recipe changes right
[2012-07-30 19:55:18 -0400] paulmooring: moos3: that's kind of a loaded question, chef-client will pull down the latest version of the cookbook allowed by it's version constraints
[2012-07-30 19:55:43 -0400] paulmooring: so if a cookbook is already downloaded, and you make a change and re-upload it without changing the version, then no
[2012-07-30 19:56:01 -0400] tubbo: miah: here's what i'm using to create the instance https://gist.github.com/3209607
[2012-07-30 19:56:03 -0400] paulmooring: but if you increment the version and don't have a version constraint in the way then yes
[2012-07-30 19:56:22 -0400] paulmooring: also you can delete the cookbook from the cache to force it to be re-downloaded
[2012-07-30 19:56:23 -0400] moos3: so as long as I increase the versioning it will pull the latest down and update any files
[2012-07-30 19:57:05 -0400] moos3: paulmooring basically what I wanto do is make a single change to a single file, then push the change to 1000+ nodes
[2012-07-30 19:57:12 -0400] paulmooring: moos3: correct unless you have some restrictions, for example if the environment doesn't allow versions greater than 1.2.0 and you incremented to 1.2.1
[2012-07-30 19:57:23 -0400] paulmooring: moos3: increment the version
[2012-07-30 19:57:40 -0400] moos3: k cool
[2012-07-30 19:57:46 -0400] miah: actually, even if the version doesn't change, but the cookbook contents do change then it will update the local cache on client run
[2012-07-30 19:58:08 -0400] miah: unless you freeze the cookbooks at a specific version
[2012-07-30 19:58:26 -0400] miah: but please.. increment the cookbook version when you update things
[2012-07-30 19:58:51 -0400] moos3: yea
[2012-07-30 19:59:27 -0400] moos3: i'm getting ready to deplay chef on 400 pre-existing servers and need to make sure if we change something it will automatically push the updates
[2012-07-30 20:04:49 -0400] miah: it will. if you do it right =)
[2012-07-30 20:05:06 -0400] miah: also.. test on a few servers or a virtual before rolling it out just to be sure
[2012-07-30 20:07:24 -0400] moos3: yea
[2012-07-30 20:12:55 -0400] jforest: miah: so what do you do to have chef-client run every x minutes? just throw a cronjbo on every machine?
[2012-07-30 20:13:58 -0400] miah: chef-client runs as a daemon
[2012-07-30 20:14:09 -0400] miah: default checkin time is 30 minutes iirc
[2012-07-30 20:14:10 -0400] jforest: oh? by default?
[2012-07-30 20:14:21 -0400] miah: yes
[2012-07-30 20:15:21 -0400] erikh: well to be exact it does when you use the -d flag, and the chef recipes that configure chef-client do that.
[2012-07-30 20:15:27 -0400] erikh: you can run chef-client one-shot
[2012-07-30 20:15:37 -0400] erikh: sorry to aspie it up
[2012-07-30 20:15:59 -0400] jforest: well, I'm just thinking, when I install, and it bootstraps, does it run -d?
[2012-07-30 20:16:18 -0400] jforest: fwiw I'm doing knife ec2 server creat blah blah blah -r "role[blah]"
[2012-07-30 20:16:20 -0400] JasonF: I know that the bootstrap script we use has to explictly disable start-on-boot and stop the daemon
[2012-07-30 20:16:28 -0400] JasonF: because the package in ubuntu runs as a daemon, enabled by default
[2012-07-30 20:16:46 -0400] erikh: jforest: not by default. if you use the chef-client recipe it will.
[2012-07-30 20:16:52 -0400] erikh: oh
[2012-07-30 20:16:53 -0400] erikh: packages
[2012-07-30 20:16:56 -0400] erikh: nevermind then
[2012-07-30 20:17:21 -0400] jforest: erikh: I'm just using chef/knife to  build it all
[2012-07-30 20:18:23 -0400] erikh: yeah, I don't use the default bootstrap templates so I forget about the packages.
[2012-07-30 20:20:46 -0400] jforest: I don't see any interesting
[2012-07-30 20:21:20 -0400] jforest: err any interesting process running
[2012-07-30 20:23:31 -0400] tylerw_: i have questions about doing things with the sample chef-repo
[2012-07-30 20:23:53 -0400] rabidpraxis: anyone here do rolling deployments with knife?
[2012-07-30 20:24:22 -0400] tylerw_: when i installed chef-server, i cloned it down on chef-server machine. then i prepared knife on my work pc.  i cloned that repo from my chef machine, and i push the changes back, then i hit git error that i can't
[2012-07-30 20:24:37 -0400] tylerw_: i am very used to hg. but i want to make sure i am doing the right thing...
[2012-07-30 20:26:15 -0400] tylerw_: am i supposed to create a new branch or something? my ideal was like:  clone down to workstation, do development, commit, test the repo, okay then push to master, and update client
[2012-07-30 20:26:44 -0400] yfeldblum: tylerw_, the sample chef-repo is only for use by the sysadmin working on his workstation; you the sysadmin uses knife, not git, to interact with the chef-server
[2012-07-30 20:27:24 -0400] yfeldblum: tylerw_, so you can edit a cookbook, for example, and then as a sysadmin run `knife cookbook upload ASDF` to upload the cookbook to the chef-server
[2012-07-30 20:28:36 -0400] tylerw_: but when we prepare the chef-server, knife-configure will ask for repo location. are we supposed to it blank or was it intended for remote repo?
[2012-07-30 20:29:00 -0400] yfeldblum: tylerw_, knife-configure is only for use by the sysadmin on his workstation
[2012-07-30 20:29:18 -0400] yfeldblum: tylerw_, knife, and every knife subcommand and plugin, are for use by the sysadmin, from the sysadmin's workstation
[2012-07-30 20:29:44 -0400] yfeldblum: tylerw_, they are the CLI that ships with chef for interacting with the chef-server (by the sysadmin, from his workstation)
[2012-07-30 20:30:24 -0400] tylerw_: okay that part is clear. if i ever want to do stuff with coobook, use the knife CLI on my workstation. okay.
[2012-07-30 20:30:31 -0400] tylerw_: but in the doc:  On your Chef Server, run knife configure -i to interactively configure your knife client and create an admin account on the server. You can accept the default responses shown in brackets by pressing <enter>.
[2012-07-30 20:30:57 -0400] tylerw_: and it will prompt for repo location. thats where got me confused. should i supplied the github repo url?
[2012-07-30 20:31:08 -0400] tylerw_: i can leave that blank and i should fill that in, right?
[2012-07-30 20:31:26 -0400] yfeldblum: tylerw_, that sounds old
[2012-07-30 20:31:50 -0400] tylerw_: outdated or odd lol  http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages
[2012-07-30 20:32:04 -0400] tylerw_: "Once you've verified that all of Chef's components are working, it's time to configure the knife command line tool. On your Chef Server, run knife configure"
[2012-07-30 20:35:26 -0400] yfeldblum: tylerw_, the purpose of that section is to guide you through creating an api-client account for yourself as a sysadmin with admin-level privileges; you can also do these steps on your local workstation, after copying the webui.pem key and using that to authorize the creation of your own api-client account
[2012-07-30 20:35:45 -0400] yfeldblum: tylerw_, or you can do that on the chef-server machine itself
[2012-07-30 20:36:16 -0400] tylerw_: yfeldblum: thanks. so basically, if i dont want to always log into chef-server machine, i will setup knife client on my workstation. do stuff there, and upload to client.
[2012-07-30 20:36:37 -0400] tylerw_: yfeldblum: the chef-server machine does not need that piece of information, right? unless i ever want to do it there directly.
[2012-07-30 20:36:40 -0400] yfeldblum: tylerw_, in that case, leave the "chef-repo" question blank
[2012-07-30 20:37:13 -0400] tylerw_: yfeldblum: cool. that part confused the hack out of me hahaha. thanks.
[2012-07-30 20:37:26 -0400] yfeldblum: tylerw_, in order to create an api-client account with admin privs, you must do so while logged into another api-client account with admin privs ... and the webui api-client has admin privs and is precreated
[2012-07-30 20:38:08 -0400] yfeldblum: tylerw_, once you create the first api-client account with admin privs using the webui key (and possibly from a shell session in your chef-server machine), you can thereafter create new api-clients with admin privs using your own api-client account
[2012-07-30 20:39:23 -0400] bencaron: is there a way to read the configuration from client.rb into a recipe?
[2012-07-30 20:40:11 -0400] tylerw_: yfeldblum: sorry i am a bit loss, for being quite  a noob. which one is my first knife client?
[2012-07-30 20:40:19 -0400] bencaron: Or I need to do Kernel::load(configfile?)
[2012-07-30 20:41:36 -0400] yfeldblum: tylerw_, you want to create for yourself an api-client, so that you can use knife from your workstation; in order to make that first api-client with admin privs for yourself, you can follow the instructions in the wiki page; after you do that, you can use your api-client to create another api-client for another sysadmin, and a third api-client for a third sysadmin, directly (without having to follow those instructions)
[2012-07-30 20:41:55 -0400] yfeldblum: bencaron, why would you want to do that?
[2012-07-30 20:42:10 -0400] yfeldblum: bencaron, everything's available in Chef::Config
[2012-07-30 20:42:12 -0400] bencaron: I want to read there the http-proxy setting
[2012-07-30 20:42:34 -0400] yfeldblum: bencaron, eg Chef::Config[:http_proxy] if your client.rb defines `http_proxy "http://asdf"`
[2012-07-30 20:42:56 -0400] yfeldblum: bencaron, or Chef::Config.http_proxy if you prefer that syntax
[2012-07-30 20:42:56 -0400] bencaron: ok, perfect !
[2012-07-30 20:43:19 -0400] bencaron: My googling was just not good enought to find what was the name of the object that would expose that
[2012-07-30 20:45:02 -0400] yfeldblum: bencaron, sometimes you just have to read the source :P
[2012-07-30 20:45:16 -0400] bencaron: I was about to start just that :)
[2012-07-30 20:45:19 -0400] tylerw_: yfeldblum: okay so if i need to create a third client, like a new node, i can basically go on my workstation, bootstrap the new machine to run chef-client?
[2012-07-30 20:45:47 -0400] yfeldblum: tylerw_, i was just talking about api-clients for human sysadmins
[2012-07-30 20:46:24 -0400] yfeldblum: tylerw_, for bootstrapping a node by hand, chef-client knows how to register itself including creating the api-client and the node data objects in the chef-server
[2012-07-30 20:46:38 -0400] yfeldblum: tylerw_, so you don't have to create an api-client user when bootstrapping a node
[2012-07-30 20:47:29 -0400] yfeldblum: tylerw_, however, that process in chef-client relies on you having copied the validation key onto the server where chef-client is running, when chef-client runs for the first time, because the chef-client's registration process relies on the validation key
[2012-07-30 20:51:30 -0400] tylerw_: yfeldblum: thanks. got it.
[2012-07-30 20:51:42 -0400] tylerw_: yfeldblum: if any more questions, i will ask again on irc or mailinglist
[2012-07-30 21:15:24 -0400] PRK_nz: I've had something strange happen. Two windows nodes, both running Ohai 0.6.10, but one now can't find any network interfaces, and hence doesn't have the ipaddress attribute.
[2012-07-30 21:22:44 -0400] rob_san: anybody here familiar with ngix setup and a "400 Bad Request"  error when trying to the API?
[2012-07-30 21:30:21 -0400] ttilley: i'm not sure how many people here are aware of this, but bootstrapping chef on an ubuntu box in EC2 is as simple as setting some YAML as your user-data attribute
[2012-07-30 21:31:57 -0400] mattray: ttilley: which version of chef?
[2012-07-30 21:32:03 -0400] ttilley: http://pastie.org/4361502
[2012-07-30 21:32:35 -0400] mattray: neat
[2012-07-30 21:32:35 -0400] ttilley: mattray: you can specify. it's using ubuntu cloud-init to bootstrap and run various bits of code as part of your initial setup
[2012-07-30 21:32:50 -0400] ttilley: like... extending the normal firstboot process however you see fit
[2012-07-30 21:33:08 -0400] mattray: knife ec2 server create's got you covered
[2012-07-30 21:34:19 -0400] ttilley: https://help.ubuntu.com/community/CloudInit
[2012-07-30 21:34:22 -0400] Strav-: Trying to use the ruby DSL to define roles.  rake install and knife role from file both create the role with everything defined EXCEPT the run list.  Any ideas on why? (Running on our own chef server, not hosted)
[2012-07-30 21:34:49 -0400] Strav-: Run list is defined as:  run_list("recipe[foo]", "recipe[bar]")
[2012-07-30 21:36:19 -0400] ttilley: Strav-: looks good to me. you don't need the parens btw, the argument list is unambiguous
[2012-07-30 21:36:37 -0400] Strav-: yeah, tried w/o them initially, didn't work, so threw em in just in case
[2012-07-30 21:36:40 -0400] Strav-: this is baffling
[2012-07-30 21:37:54 -0400] ttilley: Strav-: completely random example of a simple role using the ruby DSL - http://pastie.org/4361531
[2012-07-30 21:38:19 -0400] ttilley: Strav-: out of curiosity have you been playing with using both ruby and json? perhaps leave behind a stray json version?
[2012-07-30 21:38:29 -0400] Strav-: unless it's caching the json somewhere
[2012-07-30 21:38:33 -0400] ttilley: Strav-: just grasping at straws since that syntax looks correct
[2012-07-30 21:38:36 -0400] Strav-: Trying to stick with ruby for this
[2012-07-30 21:39:43 -0400] ttilley: Strav-: when you hit your personal chef server and look for roles, do you see it? if so, when you go to the JSON snippet are you missing things from the tree?
[2012-07-30 21:39:52 -0400] Strav-: just the run list
[2012-07-30 21:39:58 -0400] Strav-: everything else looks right
[2012-07-30 21:41:10 -0400] ttilley: wait, i'm retarded. the run list isn't in the json when you edit it anyways. it's in the UI in the top right (just looked at my local chef server)
[2012-07-30 21:41:28 -0400] PRK_nz: I just want to confirm that a chef run won't update any gems on the node would it? You would have to manually update them.
[2012-07-30 21:41:36 -0400] Strav-: knife role show <role> -Fj doesn't show anything in the runlist
[2012-07-30 21:42:00 -0400] ttilley: weird-ass.
[2012-07-30 21:42:09 -0400] Strav-: ttilley, here's the whole file:  http://pastie.org/4361557
[2012-07-30 21:43:59 -0400] ttilley: Strav-: you have environment run lists. are you looking at it in the UI with the environment set to something other than _default and sandbox?
[2012-07-30 21:49:14 -0400] mattray: miah: anything new on the dhcp cookbook stuff? I actually need to get dhcp running on another box finally
[2012-07-30 21:49:47 -0400] ivey: is it just me, or can chef/knife exec not manipulate environments?
[2012-07-30 22:02:38 -0400] Strav-: ttilley, sorry, stepped away for a few minutes.  I've checked in all of the environments I have defined.
[2012-07-30 22:03:52 -0400] Strav-: though, interestingly enough, if I pull out the env specific run list everything works nicely
[2012-07-30 22:04:06 -0400] Strav-: so there must be a syntax issue there
[2012-07-30 22:04:07 -0400] _pol: if I have some node json, can I just spew that back into a node? Like knife node edit nodename < node.json
[2012-07-30 22:04:24 -0400] _pol: (and I want to clobber, not merge)
[2012-07-30 22:06:17 -0400] mattray: _pol: I think that works
[2012-07-30 22:06:53 -0400] _pol: mattray: nope.  Though you can do a knife node from file FILE (though it crashed. :P )
[2012-07-30 22:07:17 -0400] mattray: _pol: maybe that's what I've seen done
[2012-07-30 22:07:49 -0400] _pol: Yeah, I encountered an honest to gosh bug.  "Undefined method #save for Hash"
[2012-07-30 22:07:55 -0400] _pol: I'll copy/paste for now
[2012-07-30 22:21:50 -0400] _pol: I am running 10.8 everywhere, is it safe to upgrade to 10.12 or are there sharp pointy bits that need to be taken care of?
[2012-07-30 22:33:06 -0400] cakehero: Do I need to change the order of my recipes around to accommodate resources being declared before/after subscribes/notifies?
[2012-07-30 22:35:57 -0400] jessicab: _pol: i cant really think of many big new bugs that came up in 10.12.. but keep in mind that if youre bootstrapping the default in 10.12 is the omnibus install, and you might want to test your cookbooks with it before changing your systems to it. but regular gem installs wouldnt be effected by that, only bootstrapping.
[2012-07-30 22:42:46 -0400] heydrick1: in an lwrp is plain ruby executed during the compile phase or the converge?
[2012-07-30 22:46:06 -0400] cakehero: whats the difference between enabling a service and starting a service?
[2012-07-30 22:46:58 -0400] hoover_damm: cakehero, enable means it'll come up on bootup/default runtime... start just starts it
[2012-07-30 22:47:34 -0400] evilantnie: Is there an easy way to run ad-hoc run lists on nodes?  i.e. a one-time restore db from backup?  or is that out of scope for chef?
[2012-07-30 22:47:57 -0400] cakehero: hoover_damm ok cool
[2012-07-30 22:50:17 -0400] whitley: evilantnie: You can use a variant of this gist: https://gist.github.com/242526
[2012-07-30 22:50:57 -0400] cakehero: I'm defining templates in before_migrate of the application resource and they aren't able to notify services
[2012-07-30 22:51:13 -0400] cakehero: Perhaps I'm not designing this intelligently - is it a bad idea to have templates in before migrate?
[2012-07-30 22:52:58 -0400] evilantnie: @whitley that's interesting, if I'm going to do that I might just add these tasks to my capistrano setup.  I'm actually deploying a php app, not a rails app so no rakefiles to work with
[2012-07-30 22:56:34 -0400] josephholsten: anyone noticed build-essential cb being broken?
[2012-07-30 22:56:59 -0400] erikh: no
[2012-07-30 22:57:05 -0400] erikh: but I'm not running the latest, either.
[2012-07-30 22:57:35 -0400] josephholsten: undefined method `each' for nil:NilClass at build-essential/recipes/default.rb:47
[2012-07-30 22:58:32 -0400] josephholsten: ah, it assumes node['platform_family'] exists
[2012-07-30 22:59:39 -0400] whitley: I'm having an odd problem with a provider.  Actions specified ala "actions [:install, :start]" at definition wor, but notifications for said actions don't. Chef appears to call the action, but contained ruby_block is never invoked.  cf. Tomcat provider here: https://github.com/bryanwb/tomcat/blob/master/providers/default.rb
[2012-07-30 23:01:00 -0400] karsten: OT question: any reason Opscode/Ruby tends _not_ to use 80 char linewrap on text/readme files?
[2012-07-30 23:01:17 -0400] whitley: evilantnie: That should work fin. The only vital part of the gist is the "chef_solo ..." invocation and the dna.json file. If you have a static run_list, then you can just hardcode dna.json
[2012-07-30 23:02:05 -0400] julienphalip: Hello there. I had a question about Vagrant and Chef. I need to have Chef version 0.10.8 installed on my vagrant VM. However, the version 0.10.10 is currently installed on the base box. How can I force 0.10.8 to get installed and run by default? Do you know any trick or recipe to do that?
[2012-07-30 23:02:48 -0400] josephholsten: whitley: have you run food critic on the cookbook? I remember it having a warning for that kind of issue
[2012-07-30 23:03:15 -0400] karsten: And checking style guides to the extent I can find them: http://www.caliban.org/ruby/rubyguide.shtml#linelen https://github.com/styleguide/ruby
[2012-07-30 23:03:19 -0400] josephholsten: ah: http://acrmp.github.com/foodcritic/#FC017
[2012-07-30 23:03:33 -0400] josephholsten:   new_resource.updated_by_last_action(true)
[2012-07-30 23:04:06 -0400] whitley: josephholsten: you rock. Thanks, esp. for the tip on foodcritic.
[2012-07-30 23:05:07 -0400] josephholsten: julienphalip: gem uninstall chef; gem install chef -v 0.10.8;
[2012-07-30 23:05:25 -0400] josephholsten: you'll probably want to export your base box after that
[2012-07-30 23:05:44 -0400] julienphalip: Can't that be done automatically for any base box?
[2012-07-30 23:05:57 -0400] julienphalip: Let me paste the code I've written so far
[2012-07-30 23:07:22 -0400] julienphalip: josephholsten: http://dpaste.com/778274/
[2012-07-30 23:07:45 -0400] julienphalip: This doesn't work though, I'm guessing because you can't make Chef uninstall itself
[2012-07-30 23:08:51 -0400] julienphalip: josephholsten: Maybe I should try to do the same thing with the shell provisioner instead
[2012-07-30 23:09:01 -0400] josephholsten: have you considered building your own base box?
[2012-07-30 23:09:38 -0400] josephholsten: because while I respect your desire to replace your engines while still in the air, I can't exactly recommend it.
[2012-07-30 23:10:15 -0400] withnale: I'm trying to pass the Chef::Log object to a ruby class I'm referencing so that I can use the same logging object in my code, but I'm having trouble getting it to recognise it. Is there anything more I need to do other than classinstance.attribute = Chef::Log   ?
[2012-07-30 23:10:52 -0400] julienphalip: josephholsten: I wouldn't be in the air if I could reproduce this with a different provisioner maybe :)
[2012-07-30 23:11:37 -0400] julienphalip: I'd like to avoid creating my own base box if possible, so that it's easier for anyone to run my recipes using the default vagrant boxes
[2012-07-30 23:38:28 -0400] javawidget: So...
[2012-07-30 23:38:43 -0400] whitley: josephholsten: sadly, no dice w/ FC017. Problem is that action :restart { ... } doesn't execute ruby_block it defines when a notification invokes that action, not that notification isn't sent as a result of the restart action.
[2012-07-30 23:39:09 -0400] syphon: Has anyone ever used to the Group resource to manage Administrators on a Windows box?
[2012-07-30 23:39:13 -0400] javawidget: How do I reference an attribute in a recipe ?
[2012-07-30 23:39:21 -0400] javawidget: (syntactically)
[2012-07-30 23:40:24 -0400] javawidget: users = data_bag_item("users", node[:users_data_bag] )
[2012-07-30 23:40:33 -0400] javawidget: Does that work?
[2012-07-30 23:41:04 -0400] PRK_nz: I have an Chef architectural question: Why does it use a pull mechanism and not a push mechanism?
[2012-07-30 23:41:52 -0400] javawidget: pull mechanism from the client is more scalable.
[2012-07-30 23:42:43 -0400] javawidget: having to push configuration to N+1 hosts would take t+n amount of time.
[2012-07-30 23:42:57 -0400] PRK_nz: A bit of background: I work somewhere where we only use Chef on the very top the app stack to basically unzip and stop/start services/IIS and I get a lot of shit from other sys admins about how they think Chef has it all backwards.
[2012-07-30 23:43:00 -0400] javawidget: sorry... t*n
[2012-07-30 23:43:24 -0400] doomviking: isn't that one reason why this channel isn't called #puppet
[2012-07-30 23:43:39 -0400] javawidget: If you're getting grief from Windows admins then that's probably to be expected ;-)
[2012-07-30 23:43:58 -0400] PRK_nz: Yea, a total pain in the arse
[2012-07-30 23:44:07 -0400] javawidget: tell them that psexec isn't scalable.
[2012-07-30 23:44:30 -0400] aslan: hey guys ... when you install chef 10 with apt-get does that update the gems too?
[2012-07-30 23:46:01 -0400] PRK_nz: I'm trained in Windows (2000) and I know it's a pain but they think it's worth defending apparently
[2012-07-30 23:46:06 -0400] javawidget: PRK - the analogy I like to use is: What is faster, everyone in class turning in their paper when they've completed their test, or the teacher coming around and picking up the completed test, one student at a time.
[2012-07-30 23:46:41 -0400] PRK_nz: javawidget: thanks for that one, it's pretty good
[2012-07-30 23:46:59 -0400] javawidget: From a problem perspective...
[2012-07-30 23:47:18 -0400] javawidget: Think about the inefficiencies in the latter...
[2012-07-30 23:47:53 -0400] PRK_nz: The major problem we have I think is that we only use it on the top of the stack, on existing, old servers that have been set up for ages
[2012-07-30 23:47:55 -0400] javawidget: First... for each student, the teacher has to wait until it's complete to move on to the next student..
[2012-07-30 23:48:07 -0400] PRK_nz: rather than the new nodes, on the fly
[2012-07-30 23:48:13 -0400] javawidget: Nah... shouldn't matter...
[2012-07-30 23:48:23 -0400] javawidget: At the end of the day...
[2012-07-30 23:48:39 -0400] javawidget: If you've deployed chef on win2k...
[2012-07-30 23:48:47 -0400] javawidget: and you have working recipes.
[2012-07-30 23:49:12 -0400] javawidget: You should be good to go.
[2012-07-30 23:49:13 -0400] PRK_nz: no no, I trained in Windows back when 2000 was current ;)
[2012-07-30 23:49:19 -0400] javawidget: AH.
[2012-07-30 23:49:50 -0400] javawidget: I'm slight ahead of you on that one... I started with NT, quickly transitioning to 2000.
[2012-07-30 23:50:21 -0400] PRK_nz: ;)
[2012-07-30 23:50:38 -0400] javawidget: I was working with chef and windows not too long ago.
[2012-07-30 23:50:43 -0400] PRK_nz: It'd just be nice if we could define the whole node in code, then just deploy it, even to our private cloud
[2012-07-30 23:50:51 -0400] javawidget: Yessir.
[2012-07-30 23:50:56 -0400] javawidget: You're on the right track.
[2012-07-30 23:51:02 -0400] javawidget: Check out Rightscale.
[2012-07-30 23:51:10 -0400] javawidget: http://www.rightscale.com
[2012-07-30 23:51:31 -0400] javawidget: They've got some great Windows automation... even some chef integration.
[2012-07-30 23:51:39 -0400] javawidget: Public and Private cloud.
[2012-07-30 23:53:06 -0400] PRK_nz: Unfortunately paid services don't really fly around here
[2012-07-30 23:53:26 -0400] javawidget: Gotcha..
[2012-07-30 23:53:28 -0400] javawidget: Well..
[2012-07-30 23:53:39 -0400] javawidget: Chef on Windows is becoming more and more supported...
[2012-07-30 23:54:01 -0400] javawidget: (in the chef community)
[2012-07-30 23:54:14 -0400] PRK_nz: I'd like something like openstack on our own hardware and fully deploying via chef
[2012-07-30 23:54:25 -0400] javawidget: the problem is overcoming the objects of the more traditional windows sysadmins
[2012-07-30 23:54:26 -0400] cheeseplus: paid services don't fly but they are using windows - I am so sorry
[2012-07-30 23:54:35 -0400] javawidget: lol
[2012-07-30 23:54:36 -0400] PRK_nz: Yea I know right
[2012-07-30 23:54:40 -0400] PRK_nz: don't get me started
[2012-07-30 23:54:41 -0400] javawidget: chz+
[2012-07-30 23:54:48 -0400] javawidget: true story.
[2012-07-30 23:55:39 -0400] javawidget: You just have to make it work and demonstrate the value.
[2012-07-30 23:56:01 -0400] rfe: hey guys. i notice that i always get this error:  Not creating home directory `/usr/share/jetty'.  * Not starting jetty - edit /etc/default/jetty and change NO_START to be 0 (or comment it out).
[2012-07-30 23:56:03 -0400] PRK_nz: Yea, problem is I'm a chef n00b and the main guy who started it here has left
[2012-07-30 23:56:17 -0400] cheeseplus: PRK_nz: I do feel your pain though, worked in game dev for more than a bit
[2012-07-30 23:56:17 -0400] javawidget: So what? :)
[2012-07-30 23:56:22 -0400] rfe: does it that really matter?
[2012-07-30 23:56:24 -0400] javawidget: You'll figure it out.
[2012-07-30 23:56:36 -0400] cheeseplus: the reluctance of windows sysadmins to go forward with anything is terrifying
[2012-07-30 23:56:52 -0400] cheeseplus: I honestly think the whole DevOps movement was in response to that crowd
[2012-07-30 23:57:01 -0400] javawidget: It's not difficult once you understand some of the basic paradigms...
[2012-07-30 23:57:13 -0400] javawidget: agreed, cheese.
[2012-07-30 23:57:15 -0400] PRK_nz: Yea, they just can't accept a new way of doing things
[2012-07-30 23:57:32 -0400] cheeseplus: it's endemic of that house as it were
[2012-07-30 23:57:44 -0400] cheeseplus: says the guy who started off with an MCP O_o
[2012-07-30 23:57:47 -0400] PRK_nz: The last thing I want to do is rdp into a windows node to try fix it
[2012-07-30 23:58:08 -0400] PRK_nz: lol, I'm MCSE
[2012-07-30 23:58:09 -0400] aslan: hey guys ... when you install chef 10 with apt-get does that update the gems too?
[2012-07-30 23:58:13 -0400] cheeseplus: PRK_nz: or devs who want the same RDP session constantly to look at a console instead of just logging ;)
[2012-07-30 23:58:43 -0400] PRK_nz: oh, this is quickly turning into a rant session >_<
[2012-07-30 23:58:53 -0400] rfe: you should perform apt-get update and upgrade
[2012-07-30 23:58:56 -0400] cheeseplus: PRK_nz: we used Electric Commander to get around the mess
[2012-07-30 23:59:23 -0400] cheeseplus: it let us use Powershell to do most thing but any language could be utilized
[2012-07-30 23:59:41 -0400] cheeseplus: granted it was all Win7 and Server 2K8
[2012-07-30 23:59:46 -0400] chip-: anybody here great with Librarian? I'm trying to get Baby's First Cheffile set up, but I'm having some trouble.
