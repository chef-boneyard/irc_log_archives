[2012-07-20 00:00:09 -0400] jtimberman: Majost: for now, testing is, essentially, "vagrant up" or "knife ec2 server create"
[2012-07-20 00:00:15 -0400] jtimberman: on the platforms for that particular cookbook
[2012-07-20 00:00:17 -0400] Majost: ah
[2012-07-20 00:00:26 -0400] Majost: jenkins +1 ;)
[2012-07-20 00:01:17 -0400] jtimberman: remember that the community site is analogous to rubygems.org or cpan.
[2012-07-20 00:02:03 -0400] hoover_damm: no one uses cpan anymore
[2012-07-20 00:02:04 -0400] hoover_damm: j/k
[2012-07-20 00:02:17 -0400] hoover_damm: I don't think that day will ever come
[2012-07-20 00:03:36 -0400] Majost: jtimberman: If I may make a request -- while you guys are setting it up, it would be awesome if that same bits of code could be used by the community for continuous integration/deployment in our own CI environments.. Just my two cents though.
[2012-07-20 00:04:50 -0400] jtimberman: Majost: we're going to open source the projects we're using.
[2012-07-20 00:04:57 -0400] Majost: sweet!
[2012-07-20 00:04:58 -0400] Majost: =)
[2012-07-20 00:06:57 -0400] dyer: hoover_damm, yea thats where i am at right now
[2012-07-20 00:07:06 -0400] dyer: jtimberman, any suggestions ?
[2012-07-20 00:09:34 -0400] Majost: What is the best way to manage cookbooks using github instead of site? I've tried the knife-github-cookbooksgem... but its buggy and doesn't always behave
[2012-07-20 00:10:03 -0400] flaccid: this may seem weird, but is there a way to debug/print out the node object in a chef run like at the start so i can see the node.json being used? or should i just make a little recipe that does puts node.to_json ? for some reason a ref to a node attribute is returning nil method
[2012-07-20 00:14:03 -0400] dyer: I am sure the name attribute in the metadata is supposed to do something I just can't seem to figure it out :)
[2012-07-20 00:14:10 -0400] dyer: Sounds like I am not the only one.. :)
[2012-07-20 00:17:28 -0400] jtimberman: dyer: i do'nt know if that does anything, i don't usei t
[2012-07-20 00:18:01 -0400] dyer: I'll open a ticket, at the very least it should be removed if it doesn't actually do anything :)
[2012-07-20 00:18:08 -0400] dyer: but I sure wish it did was I thought it did
[2012-07-20 00:25:07 -0400] dyer: Ticket opened ( CHEF-3307 )
[2012-07-20 00:51:21 -0400] flaccid: so this is kind of insane, http://dpaste.org/W2Xb3/  DEBUG: Re-raising exception: NoMethodError - undefined method `[]' for nil:NilClass for https://github.com/flaccid/cookbooks/blob/master/cookbooks/mediawiki_application/recipes/application.rb#L35 and yet the node attribute is set. is this a bug or something?
[2012-07-20 01:02:29 -0400] Majost: Is there a debug variable/bit which gets set on the chef-client when you use '-V' with knife?
[2012-07-20 01:03:35 -0400] Majost: eg: Chef::Log.debug
[2012-07-20 01:04:42 -0400] Majost: oh
[2012-07-20 01:04:51 -0400] Majost: it is actually Log.debug
[2012-07-20 01:04:52 -0400] Majost: nm
[2012-07-20 01:04:53 -0400] Majost: hah
[2012-07-20 01:19:43 -0400] flaccid: should  node['cloud']['provider'] always be set or should i be checking for that if not in a cloud ?
[2012-07-20 01:21:42 -0400] jperry2: hey guys
[2012-07-20 01:21:57 -0400] jperry2: can you read a databag from a template?
[2012-07-20 01:22:08 -0400] jperry2: or its better to pass the variables to it
[2012-07-20 01:25:37 -0400] pedahzur: So, I'm trying to override attributes in the MySQL recipe, namely default['mysql']['bind_address'].  In my role file, I've put override_attributes "config" => {:mysql => {:bind_address => '127.0.0.1'}} but that isn't working.  I've also tried override_attrigutes "mysql" => { 'bind_address' => "127.0.0.1"}  What (simple) thing am I missing?
[2012-07-20 01:28:41 -0400] pedahzur: Ah, figured it out.
[2012-07-20 01:55:46 -0400] Majost: hrmm... I have an interesting problem. So I have a random generated password in an encrypted data bag; and a template file in which the password gets completed. However, when the recipe runs and the template gets filled out the password gets chopped off in various places, presumably due to the template processor seeing specific characters and trying to do stuff with them.
[2012-07-20 01:56:20 -0400] Majost: So my question is, how should I go about ensuring the value gets into the file correctly?
[2012-07-20 01:56:43 -0400] Majost: I tried this: <%= "#{@db_data_bag["passwd"]}" %>
[2012-07-20 01:56:52 -0400] Majost: but that didn't seem to do the trick
[2012-07-20 01:59:58 -0400] Majost: it seems to be doing a substitution of "%3C" to "<" and various other substitutions where "%" appears in the string.
[2012-07-20 02:04:44 -0400] coderanger: Majost hmm, don think it should be munging in erb, erb doesn't care what the data is
[2012-07-20 02:04:58 -0400] coderanger: Double check it got uploaded corectly
[2012-07-20 02:05:07 -0400] coderanger: The item, that is
[2012-07-20 02:05:26 -0400] Majost: sure, one sec.
[2012-07-20 02:09:52 -0400] Majost: coderanger: no differences between the local copy and the one on the chef server -- give me another minute to diff the one on the node
[2012-07-20 02:11:12 -0400] coderanger: Are you checking the encrypted version or the decrypted output from the server?
[2012-07-20 02:11:20 -0400] Majost: decrypted
[2012-07-20 02:11:26 -0400] flaccid: heya coderanger hope you are well. just wondering if you have any refs to your latest recommend django stack? wondering what you are going for these days in terms of servering wsgi or unicorn etc..
[2012-07-20 02:11:45 -0400] coderanger: You could just use a log resource to see what it looks like in mem after decryption in the client
[2012-07-20 02:13:09 -0400] coderanger: Gunicorn, celery, supervisor, postgres, all pretty standard
[2012-07-20 02:13:30 -0400] Majost: coderanger: I'll try that really fast too.
[2012-07-20 02:13:48 -0400] coderanger: Flaccid on my phone right now so typing is slow, bug me in a few hours when I get home or send me an email :)
[2012-07-20 02:14:56 -0400] flaccid: coderanger: sure no problem. i've been a uwsgi fan for ages, just wondering how gunicorn is better. thanks y0
[2012-07-20 02:16:00 -0400] hoover_damm: flaccid, http://wiki.python.org/moin/WebServers
[2012-07-20 02:17:06 -0400] flaccid: hoover_damm: fails to mention uwsgi
[2012-07-20 02:17:17 -0400] flaccid: nginx + uwsgi on locket unix socket is awesome
[2012-07-20 02:17:23 -0400] flaccid: *local
[2012-07-20 02:17:52 -0400] hoover_damm: why do people think unix socket is the best way to host stuff?
[2012-07-20 02:17:58 -0400] hoover_damm: do they not do their research?
[2012-07-20 02:18:10 -0400] hoover_damm: I'm tired of educating people the cons of unix sockets
[2012-07-20 02:18:58 -0400] hoover_damm: unless you run something that works with small content that doesn't get much larger then 4kb or 8kb unix sockets are not your best friend without tuning
[2012-07-20 02:19:48 -0400] flaccid: well i benchmarked it and it got a lot more throughput
[2012-07-20 02:20:03 -0400] flaccid: than say mod_wsgi or fastcgi
[2012-07-20 02:20:30 -0400] hoover_damm: then your benchmarking was flawed on multiple levels
[2012-07-20 02:20:52 -0400] hoover_damm: because you were both benchmarking differences in the application server and the tcp/unix socket
[2012-07-20 02:21:03 -0400] hoover_damm: not just tcp to unix
[2012-07-20 02:21:16 -0400] flaccid: i tested tcp socket instead of unix stock and unix socket still did better
[2012-07-20 02:21:31 -0400] flaccid: still did thousands more requests
[2012-07-20 02:21:32 -0400] hoover_damm: then either you run less then 4kb or your testing was flawed
[2012-07-20 02:21:46 -0400] flaccid: a decent size web page was served
[2012-07-20 02:21:46 -0400] hoover_damm: Read up on unix sockets and the buffering and you'll see the point
[2012-07-20 02:22:35 -0400] hoover_damm: Sorry to burst your bubble ... i've burst it for many
[2012-07-20 02:22:36 -0400] Majost: coderanger: ahhh -- found the issue... its external to chef.
[2012-07-20 02:22:57 -0400] flaccid: doesn't explain my results. i was testing serving real shiz larger than 4kb.
[2012-07-20 02:23:03 -0400] flaccid: sorry to burst that for you..
[2012-07-20 02:23:17 -0400] hoover_damm: as I said your results were flawed on multiple levels
[2012-07-20 02:23:31 -0400] hoover_damm: don't feel angry, go read up
[2012-07-20 02:23:45 -0400] hoover_damm: no need to defend anything because this is something a lot of people just don't understand properly
[2012-07-20 02:25:01 -0400] flaccid: i'm not angry
[2012-07-20 02:25:23 -0400] hoover_damm: basically tcp sockets window size autoscales
[2012-07-20 02:25:29 -0400] hoover_damm: unix socket is by default 4kb
[2012-07-20 02:25:40 -0400] hoover_damm: which means unix sockets do work but can cause a lot of buffering
[2012-07-20 02:25:50 -0400] hoover_damm: in a properly tuned tcp environment tcp is faster
[2012-07-20 02:25:54 -0400] flaccid: i just don't see how my results were flawed, i was testing a real website. but hey they must be flawed.
[2012-07-20 02:25:56 -0400] hoover_damm: in a inproperly tuned environment
[2012-07-20 02:25:58 -0400] hoover_damm: totally bad
[2012-07-20 02:26:49 -0400] hoover_damm: when your trying to benchmark tcp vs unix sockets you don't benchmark a 'site' you benchmark the issue at hand
[2012-07-20 02:26:59 -0400] flaccid: i didn't have an issue.
[2012-07-20 02:27:03 -0400] hoover_damm: otherwise you add too many variables that can polute and taint
[2012-07-20 02:27:05 -0400] hoover_damm: your results
[2012-07-20 03:08:09 -0400] jeremyolliver: I'm having some trouble with self-hosted chef. Suddenly my client keys and webui key isn't valid anymore, and the chef-server process won't boot :(
[2012-07-20 03:09:15 -0400] jeremyolliver: does anyone know how I can regenerate a new webui.pem?
[2012-07-20 03:09:29 -0400] jeremyolliver: without a running chef-server
[2012-07-20 03:11:51 -0400] bdha: jeremyolliver: Are you sure your CouchDB server isn't hosed?
[2012-07-20 03:12:43 -0400] jeremyolliver: bdha: something happened to it. It's running currently, but there is a recent crash in it's log, and I suspect that may have been related to disk space running on on the file volume
[2012-07-20 03:13:19 -0400] bdha: jeremyolliver: Yeah, that'd make it sad. Make sure you can get to the CouchDB admin console, and poke around to make sure it's returning data.
[2012-07-20 03:13:55 -0400] bdha: If you weren't running maint on CouchDB, that's a good way for it to be sad as well.
[2012-07-20 03:14:24 -0400] jeremyolliver: bdha: Okay, that sounds a good start. I know nothing about running a couchdb so uh, yeah no maint
[2012-07-20 03:14:50 -0400] bdha: jeremyolliver: You periodically need to compress and expunge data/views, or it just grows forever.
[2012-07-20 03:15:17 -0400] lastobelus: does anyone know a reason why a recipe added to a node's run list would be ignored when running chef-client on the node?
[2012-07-20 03:15:18 -0400] bdha: http://wiki.opscode.com/display/chef/CouchDB+Administration+for+Chef+Server
[2012-07-20 03:15:21 -0400] hoover_damm: sadly this is why Chef is moving to *SQL ...
[2012-07-20 03:15:31 -0400] hoover_damm: no one knows how to maintain couchdb
[2012-07-20 03:15:31 -0400] bdha: Heh, that isn't sad. Eff CouchDB.
[2012-07-20 03:15:42 -0400] bdha: I have it working just fine now, but meh.
[2012-07-20 03:15:51 -0400] hoover_damm: hey I learned how to manage and scale couchdb from chef
[2012-07-20 03:15:56 -0400] hoover_damm: and love it
[2012-07-20 03:16:06 -0400] bdha: Let me know when the meds wear off, mate. ;)
[2012-07-20 03:16:13 -0400] hoover_damm: No meds :)
[2012-07-20 03:16:16 -0400] bdha: I have neough datastores in my infra.
[2012-07-20 03:16:21 -0400] bdha: One less would make me very happy.
[2012-07-20 03:16:27 -0400] hoover_damm: just dealt with enough crappy datastores to make me grumpy
[2012-07-20 03:16:29 -0400] jeremyolliver: bdha: well gee, I guess I'd better do that. But a datastore that doesn't require hand-holding would be nice :(
[2012-07-20 03:16:38 -0400] hoover_damm: couchdb once you get it working right and cron the compaction
[2012-07-20 03:16:46 -0400] hoover_damm: it should be a pretty non-issue life
[2012-07-20 03:16:50 -0400] bdha: jeremyolliver: Hosted Chef has already moved to MySQL. Reckon free will get there as well eventually.
[2012-07-20 03:16:56 -0400] bdha: hoover_damm: Yup.
[2012-07-20 03:17:01 -0400] bdha: hoover_damm: Assuming you're using the right version with Chef. ;-)
[2012-07-20 03:17:08 -0400] hoover_damm: true
[2012-07-20 03:17:09 -0400] jeremyolliver: cool
[2012-07-20 03:17:38 -0400] jeremyolliver: turns out, after restarting couchdb things are working. Guess I shouldn't have trusted it reporting as 'running'
[2012-07-20 03:17:59 -0400] jeremyolliver: cheers for the help, will look at putting those couchdb maintenance things into cron
[2012-07-20 03:18:22 -0400] bdha: +1
[2012-07-20 03:24:37 -0400] lastobelus: i think the answer is that the first run did not complete, so chef-client runs use first-boot.json and ignore the node's currently set run list.
[2012-07-20 03:29:10 -0400] flaccid: i updated https://github.com/flaccid/cookbooks/blob/master/cookbooks/mediawiki_application/recipes/application.rb to use 'db' instead of 'database' in the key. it works. so some kind of chef bug not wanting me to use a key named database
[2012-07-20 03:31:22 -0400] hoover_damm: seems unlikely that 'database' would be a reserved attribute name
[2012-07-20 03:32:04 -0400] jeremyolliver: I would guess it's more likely an existing 'normal' attribute or the attribute getting set to something else, than database being a reserved word
[2012-07-20 03:32:13 -0400] jeremyolliver: of course, those can be really annoying/hard to track down
[2012-07-20 03:35:07 -0400] flaccid: hoover_damm: sure, but i change it to db and it works and doesn't return nilclass. *sigh*
[2012-07-20 03:37:03 -0400] flaccid: i am doubting that all the dep cookbooks what of set an attribute node['mediawiki_application']['database']['schema']
[2012-07-20 03:37:11 -0400] flaccid: *would of
[2012-07-20 03:37:37 -0400] jtimberman: hoover_damm: maintenance of couchdb is not why we're moving to sql for the chef server.
[2012-07-20 03:38:03 -0400] jtimberman: hoover_damm: we picked mysql for hosted chef because we've people with extensive experience maintaining it.
[2012-07-20 03:38:49 -0400] jtimberman: hoover_damm: as seth falcon pointed out in his talk about the switch, performance issues with the kinds of data we're storing, the number of databases we have, and the use case, couch wasn't a great fit.
[2012-07-20 03:40:39 -0400] hoover_damm: jtimberman, I think performance issues with databases wether it's sql or nosql are pretty hard story.  People far too often gloss over how their application or data overflows their datastore
[2012-07-20 03:41:29 -0400] jtimberman: hoover_damm: the graphs of before/after don't lie
[2012-07-20 03:41:31 -0400] hoover_damm: jtimberman, I admit I will weep a little once you guys push those changes into master to drop couchdb for good
[2012-07-20 03:42:17 -0400] hoover_damm: I would say it makes sense for hosted, not so much for open source
[2012-07-20 03:42:23 -0400] hoover_damm: your dataset totally must overflow on hosted
[2012-07-20 03:42:41 -0400] jtimberman: people already know how to scale, backup and make HA mysql
[2012-07-20 03:42:43 -0400] hoover_damm: but it doesn't really matter
[2012-07-20 03:42:47 -0400] jtimberman: far more than know how with couchdb
[2012-07-20 03:42:47 -0400] hoover_damm: rofl
[2012-07-20 03:42:54 -0400] hoover_damm: that's a horrible reason
[2012-07-20 03:42:59 -0400] hoover_damm: it's true
[2012-07-20 03:43:02 -0400] jtimberman: its not black and white
[2012-07-20 03:43:06 -0400] hoover_damm: but still
[2012-07-20 03:43:41 -0400] bdha: How is it a horrible reason? It's a perfect business and technical reason to use something you already have deep familiarity with.
[2012-07-20 03:44:05 -0400] bdha: Performance boost is kind of a nice side effect as well.
[2012-07-20 03:44:34 -0400] jtimberman: unrelated, pro tip: ls roles/*.rb | xargs knife role from file
[2012-07-20 03:44:38 -0400] hoover_damm: bdha, I prefer to learn something i'm unfamiliar with
[2012-07-20 03:44:51 -0400] jtimberman: or, s/xargs/parallel/ if thats your bag.
[2012-07-20 03:46:30 -0400] bdha: hoover_damm: Shiny object syndrome is how I ended up with MySQL, Membase, Mongo, Riak and memcached for the service I have to support.
[2012-07-20 03:46:36 -0400] bdha: Crap like that makes me want to punch a dev.
[2012-07-20 03:46:55 -0400] jtimberman: bdha: thats a lot of keys and values sir.
[2012-07-20 03:46:57 -0400] hoover_damm: huh
[2012-07-20 03:47:00 -0400] bdha: No joke.
[2012-07-20 03:47:01 -0400] hoover_damm: why do you have membase and memcached?
[2012-07-20 03:47:07 -0400] jtimberman: no redis?
[2012-07-20 03:47:14 -0400] hoover_damm: lol
[2012-07-20 03:47:21 -0400] bdha: memcached because that's what we started with. Membase because they decided they wanted persistant memcached.
[2012-07-20 03:47:22 -0400] hoover_damm: riak CS?
[2012-07-20 03:47:25 -0400] bdha: But weirdly, Membase also sort of sucks.
[2012-07-20 03:47:31 -0400] hoover_damm: really?
[2012-07-20 03:47:39 -0400] bdha: Membase made my life a living hell for a full month.
[2012-07-20 03:47:41 -0400] hoover_damm: I had enough customers want it at EY
[2012-07-20 03:47:44 -0400] hoover_damm: that I dunno
[2012-07-20 03:47:48 -0400] hoover_damm: shiny
[2012-07-20 03:47:49 -0400] hoover_damm: i guess
[2012-07-20 03:47:57 -0400] bdha: It's been fine since they fixed their memory alloc.
[2012-07-20 03:48:08 -0400] bdha: Before that, it would crash every 5 hours. Replication was broken.
[2012-07-20 03:48:22 -0400] bdha: We're getting rid of it as part of my current project.
[2012-07-20 03:48:33 -0400] bdha: I'd like Riak CS, actually, but don't have the backing infra to replace our usage of S3 yet.
[2012-07-20 03:49:42 -0400] hoover_damm: eh just pickup a nas?
[2012-07-20 03:49:54 -0400] hoover_damm: or 3
[2012-07-20 03:49:55 -0400] hoover_damm: j/k
[2012-07-20 03:49:58 -0400] bdha: Heh.
[2012-07-20 03:50:02 -0400] hoover_damm: I'd love to replace S3 ourselves
[2012-07-20 03:50:10 -0400] jtimberman: distributed k/v store. what.
[2012-07-20 03:50:12 -0400] hoover_damm: but as we store a crapton of logs on there
[2012-07-20 03:50:16 -0400] bdha: We use a fair amount of S3 and they don't want to rewrite the code.
[2012-07-20 03:50:25 -0400] bdha: Yeah, we have 15TB or so in S3 now.
[2012-07-20 03:50:27 -0400] jtimberman: anyway, this vagrant system isn't going to configure itself!
[2012-07-20 03:50:33 -0400] jtimberman: ... oh wait, it is. all four of em.
[2012-07-20 03:50:37 -0400] bdha: lul
[2012-07-20 03:50:54 -0400] jtimberman: bdha: storage bucket ain't one of your problems
[2012-07-20 03:51:06 -0400] bdha: S3 actually works. :)
[2012-07-20 03:51:11 -0400] erikh: if you got storage problems I feel bad for ya son..
[2012-07-20 03:51:38 -0400] erikh: cloudfront on the other hand is a colossal pile of toilet paper
[2012-07-20 03:52:06 -0400] bdha: Word up.
[2012-07-20 03:53:04 -0400] erikh: ha
[2012-07-20 03:53:06 -0400] erikh: awesome.
[2012-07-20 03:53:24 -0400] erikh: we're scaling and load testing rails today
[2012-07-20 03:53:31 -0400] erikh: it has.... not been a pleasant experience.
[2012-07-20 03:54:23 -0400] jeremyolliver: * reads up and pats bdha on the back
[2012-07-20 03:54:47 -0400] jeremyolliver: we've got postgres, redis, elasticsearch, and soon riak as well all for one project
[2012-07-20 03:55:21 -0400] bdha: I want to replace it all with postgres and hstore.
[2012-07-20 03:55:22 -0400] hoover_damm: people don't like tsearch in postgres?
[2012-07-20 03:55:37 -0400] erikh: ES is pretty damned awesome
[2012-07-20 03:55:42 -0400] jeremyolliver: not all of our data is from postgres
[2012-07-20 03:55:52 -0400] hoover_damm: erikh, that wasn't my point
[2012-07-20 03:55:56 -0400] jeremyolliver: and yeah, ES kicks but even compared to Solr or other similar solutions
[2012-07-20 03:56:05 -0400] erikh: yeah, we're using solr now
[2012-07-20 03:56:15 -0400] erikh: trying to convince the devs to get on ES
[2012-07-20 03:56:15 -0400] hoover_damm: tsearch if your postgres only can be quite fulfilling compared to having to run es/solr
[2012-07-20 03:56:25 -0400] hoover_damm: but if you have multiple datastores
[2012-07-20 03:56:34 -0400] hoover_damm: you end up having to post-commit drop it to es or solr
[2012-07-20 03:56:57 -0400] jeremyolliver: yeah, also got a JSON rest service to search on + a legacy mainframe system
[2012-07-20 03:58:12 -0400] jtimberman: jeremyolliver: IMS on the mainframe? or do you at least get DB2?
[2012-07-20 03:58:49 -0400] jeremyolliver: nah, it's not really what you'd call a 'datastore' this legacy mainframe system
[2012-07-20 03:58:59 -0400] hoover_damm: erikh, it's fun trying to get more people onto the ES bandwagon
[2012-07-20 03:59:01 -0400] jeremyolliver: but we have to pull data out of it all the same
[2012-07-20 03:59:12 -0400] hoover_damm: erikh, gotten a few people to use it as a datastore as well
[2012-07-20 03:59:15 -0400] hoover_damm: lol
[2012-07-20 03:59:16 -0400] erikh: oh there's just no compelling reason to switch atm
[2012-07-20 03:59:22 -0400] erikh: I use it for a irc bot.
[2012-07-20 03:59:27 -0400] jeremyolliver: I totally vouch for ElasticSearch, it's been one of the easiest things to use out of our whole stack
[2012-07-20 03:59:30 -0400] erikh: it holds all the irc bot's data.
[2012-07-20 03:59:34 -0400] erikh: it's a very obnoxious bot.
[2012-07-20 03:59:44 -0400] jeremyolliver: (that I didn't already know how to use when I started at least)
[2012-07-20 04:41:25 -0400] flaccid: hmm DEBUG: Platform ubuntu not found, using all defaults. (Unsupported platform?)
[2012-07-20 04:42:46 -0400] flaccid: http://tickets.opscode.com/browse/CHEF-3099 i guess
[2012-07-20 05:38:34 -0400] josephholsten: mysql::server notifies :restart on any my.cnf change. when is this *ever* the right decision?
[2012-07-20 06:14:36 -0400] hoover_damm: in production? 0
[2012-07-20 06:14:52 -0400] hoover_damm: unfortunately business decisions don't always translate that easily
[2012-07-20 06:15:05 -0400] hoover_damm: I consider that a business decision
[2012-07-20 06:15:49 -0400] BryanWB_: yo chefs!
[2012-07-20 06:31:47 -0400] kernelPanik: hey guys! an advanced guide for writing cookbooks?
[2012-07-20 06:33:53 -0400] BryanWB_: kernelPanik: see realityforge blog
[2012-07-20 06:33:59 -0400] williamherry: can I see chef-client's log on chef server?
[2012-07-20 06:34:11 -0400] BryanWB_: and listen to the foodfightshow or just read the show notes
[2012-07-20 07:54:18 -0400] coderanger: Hmm, drbd is part of the main kernel now, right?
[2012-07-20 07:59:09 -0400] coderanger: wtfmate
[2012-07-20 08:04:08 -0400] chron0: do you guys run your chef-clients periodically or as a daemon in a prod env?
[2012-07-20 08:08:33 -0400] cnf: hmz
[2012-07-20 08:08:39 -0400] cnf: now i'm crashing knife ^^;
[2012-07-20 08:11:28 -0400] coderanger: Oh bugger all
[2012-07-20 08:11:45 -0400] coderanger: The answer, ubuntu _doesn't_ package drbd in the main kernel after oneric
[2012-07-20 08:11:56 -0400] coderanger: you need a -extra pkg
[2012-07-20 08:13:24 -0400] coderanger: totally works
[2012-07-20 08:14:06 -0400] thom: chron0: we switched to running from cron
[2012-07-20 08:14:42 -0400] retr0h: thom: +1
[2012-07-20 08:15:47 -0400] Mithrandir: coderanger: oh, thanks for finding that out for me, given I'm looking at upgrading to precise on my ganeti cluster soonish. :-)
[2012-07-20 08:16:14 -0400] Mithrandir: also, yeah, just switched to running from cron.  There's not really any advantage for me to have it hang around.
[2012-07-20 08:16:15 -0400] coderanger: Mithrandir: linux-image-extra-virtual
[2012-07-20 08:16:28 -0400] Mithrandir: -server in my case, I suspect.
[2012-07-20 08:16:41 -0400] coderanger: Not sure what the situation is in the non virt kernels
[2012-07-20 08:17:05 -0400] retr0h: Mithrandir: ganeti cluster eh?  Thats awesome.  I'm actually a big fan of ganeti.
[2012-07-20 08:17:28 -0400] Mithrandir: retr0h: I'm happy with it.  Seems solid, works fine
[2012-07-20 08:18:27 -0400] coderanger: Thats what I'm working on right now actually
[2012-07-20 08:18:29 -0400] coderanger: just as a guest
[2012-07-20 08:18:35 -0400] retr0h: Mithrandir: Yah, I liked it quite a bit when I was evaluating it.  I actually wrote ruby bindings to the ganeti rapi long ago (https://bitbucket.org/retr0h/rubineti)
[2012-07-20 08:18:38 -0400] coderanger: PSF private cloud is chef on ganeti
[2012-07-20 08:19:28 -0400] Mithrandir: haven't really had the need to do anything with it outside of the command line tools
[2012-07-20 08:19:35 -0400] chron0: thom, retr0h: thanks for the feedback, with what intervalls did you come down as reasonable?
[2012-07-20 08:19:51 -0400] coderanger: Mithrandir: Check out ganeti-web-admin from the OSL team
[2012-07-20 08:19:56 -0400] coderanger: its pretty cool
[2012-07-20 08:20:09 -0400] thom: every 20 minutes or so
[2012-07-20 08:20:17 -0400] Mithrandir: coderanger: I know, it's shiny, but it doesn't solve a problem I have. :-)
[2012-07-20 08:20:18 -0400] chron0: and how do you prevent the "running-herd" problem when having many machines?
[2012-07-20 08:20:31 -0400] retr0h: coderanger: We have a 5 zone OpenStack deployment, but I really like ganeti, it's solid and wouldn't mind getting it in there somewhere...
[2012-07-20 08:20:34 -0400] Mithrandir: 0 * * * * sleep $(( $$ \% 30 )) ; chef-client -c /etc/chef/client.rb -L /var/log/chef/client.log
[2012-07-20 08:20:37 -0400] Mithrandir: is what I do
[2012-07-20 08:20:53 -0400] Mithrandir: hmm, that 30 should probably be something like 300
[2012-07-20 08:21:16 -0400] chron0: Mithrandir: cheers, I'll give that a try
[2012-07-20 08:21:52 -0400] retr0h: chron0: yah I just do the simple 0,30 * * * * /bin/sleep `/usr/bin/expr $RANDOM \% 90`; /usr/bin/chef-client...
[2012-07-20 08:22:17 -0400] retr0h: give it some random splay
[2012-07-20 08:22:41 -0400] thom: chron0: http://www.stdlib.net/~colmmacc/2009/09/14/period-pain/ :)
[2012-07-20 08:22:45 -0400] BryanWB_: chron0 i think there is chef-client::cron recipe that does exaclty that
[2012-07-20 08:22:49 -0400] retr0h: Pretty sure the chef-client cookbooks cron section does this by defaut
[2012-07-20 08:22:55 -0400] thom: might be more information that you want :)
[2012-07-20 08:24:37 -0400] retr0h: thom: nice link
[2012-07-20 08:25:01 -0400] CrazyHorse18: hey guys.. i wanted to know if i was on the right path.  I've only just now deployed a server using knife and i've just created and used one cookbook so i'm still very hazy on how this stuff works.   http://pastie.org/private/1x10izml1c0dartx8rx04g  << this is essentailly what I want to achieve.  basically get that configuration at the top and then run the list of commands below.   Now would each of these things
[2012-07-20 08:25:50 -0400] chron0: thanks @all :)
[2012-07-20 08:25:56 -0400] chron0: no such thing as too much :)
[2012-07-20 08:30:14 -0400] CrazyHorse18: anyone/
[2012-07-20 08:30:16 -0400] CrazyHorse18: ?
[2012-07-20 08:39:17 -0400] zoubi: what is the correct syntax of knife ssh, to connect to a particular node? it keeps telling me that "No nodes returned from search" :(
[2012-07-20 08:42:32 -0400] CrazyHorse18: knife ssh nodename wasn't it?
[2012-07-20 08:42:50 -0400] CrazyHorse18: with a databag.. can i have all the configuration for a databag in one file
[2012-07-20 08:42:55 -0400] CrazyHorse18: rather than splitting it per  record?
[2012-07-20 09:27:11 -0400] zts: zoubi: if you want to connect to a specific node, why not just use ssh (instead of 'knife ssh')?
[2012-07-20 09:28:08 -0400] zoubi: zts: because the nodes are on EC2, and I hoped this would avoid me to look for the public DNS of the node, and then knife ssh would directly connect to the node
[2012-07-20 09:28:20 -0400] zts: aha, makes sense
[2012-07-20 09:28:31 -0400] zts: well you want something like: knife ssh "node:NODENAME"
[2012-07-20 09:28:56 -0400] zts: though I guess with ec2 you'd need to add "-a public_ip" (or whatever the appropriate attribute is)
[2012-07-20 09:29:22 -0400] zts: gah, knife ssh "name:NODENAME"
[2012-07-20 09:29:23 -0400] zoubi: so I still need to know the public IP
[2012-07-20 09:29:24 -0400] zts: sorry
[2012-07-20 09:29:31 -0400] zts: no, just the name of the attribute where it's stored
[2012-07-20 09:29:38 -0400] zts: I don't have any hosts on ec2 so I can't check
[2012-07-20 09:29:55 -0400] zts: but by default (see --help), "knife ssh" will connect to the fqdn of the nodes returned by search
[2012-07-20 09:30:05 -0400] zts: if you want it to connect to something other than the fqdn, you need to tell it the attribute to use instead
[2012-07-20 09:30:30 -0400] zoubi: mmm I have a new error message
[2012-07-20 09:30:50 -0400] zoubi: WARNING: Failed to connect to node[creatures_socorro_collector] -- SocketError: getaddrinfo: No such host is known.
[2012-07-20 09:34:08 -0400] zts: could you try putting "-V -V" on the end of your commandline, and then sharing the whole output via gist/pastebin?
[2012-07-20 09:34:53 -0400] zoubi: mmm I get it
[2012-07-20 09:35:12 -0400] zoubi: the chef server sends back to knife the internal DNS, not the public one
[2012-07-20 09:45:31 -0400] zts: the chef server should be sending back everything, you have to tell knife which attribute to look at
[2012-07-20 09:46:45 -0400] zts: if you're not sure which attribute you need, I'd suggest looking through all of the node's data to see what it's called (use "knife node show <nodename> -l")
[2012-07-20 09:47:16 -0400] zts: I seem to recall that the attribute you want is called something like public_ip or cloud.public_ip, but I don't have any cloud instances to look at to confirm that
[2012-07-20 09:49:56 -0400] zts: The way that "knife ssh" works is to first do a node search (exactly the same as "knife search node"), and then try to ssh to each node that is returned
[2012-07-20 09:56:28 -0400] zoubi: zts: indeed, it's cloud.public_hostname
[2012-07-20 09:57:07 -0400] zoubi: and how I write my knife ssh ( or ssh only ) command to use this info?
[2012-07-20 10:01:55 -0400] zoubi: zts: found it. -a cloud.public_hostname
[2012-07-20 10:02:01 -0400] zoubi: thanks for your help
[2012-07-20 10:11:40 -0400] m1lth14d3s: I'm trying to creato svn repo with chef with execute resource 'command "svnadmin create #{node[:fk][:home]}repo/fk"' I always get this error svnadmin: Can't open file '/root/.subversion/servers': Permission denied.
[2012-07-20 10:12:04 -0400] m1lth14d3s: but if I run this command from shell it works without problems
[2012-07-20 10:12:47 -0400] m1lth14d3s: any idea what do I wrong?
[2012-07-20 10:27:57 -0400] specialsauce: I've been seeing Chef server dieing the last few nights on chef 10.6. Are there any known bugs on 10.6 relating to this?
[2012-07-20 11:17:45 -0400] magec1: Hi!, Im having problems with the --json-attributes flag in the first run of chef-client. When I try to mix attributes with run_list it does not not work, any ideas?
[2012-07-20 11:57:48 -0400] Jay_Levitt: I added this to my role.rb, more to see if I knew what I was doing than anything else, but chef_client is still running every 1800 secs, not 300: default_attributes(
[2012-07-20 11:57:48 -0400] Jay_Levitt:   chef_client:
[2012-07-20 11:57:48 -0400] Jay_Levitt:     {interval: "300"}
[2012-07-20 11:57:49 -0400] Jay_Levitt: )
[2012-07-20 12:11:55 -0400] ashb: Jay_Levitt: did you restart chef client?
[2012-07-20 12:12:17 -0400] Jay_Levitt: ashb: No, I guess I assumed that recipes knew how to restart themselves when attributes changed.  No, huh?
[2012-07-20 12:12:27 -0400] ashb: chef-client is a speical case
[2012-07-20 12:12:42 -0400] ashb: last I heard it couldn't restart it self
[2012-07-20 12:12:47 -0400] Jay_Levitt: ah hah
[2012-07-20 12:12:49 -0400] ashb: cos that stops the run completing
[2012-07-20 12:14:24 -0400] Jay_Levitt: So what's the chefonic way of restarting chef-client?
[2012-07-20 12:21:52 -0400] digitallogic: is there a list anywhere of node attributes populated by ohai that are accessable in recipes?
[2012-07-20 12:22:00 -0400] digitallogic: my google-fu is failing me atm
[2012-07-20 12:22:37 -0400] ashb: digitallogic: you can run `ohai` on a node to see
[2012-07-20 12:22:48 -0400] ashb: but what is there depends on the plugins you have and what's installed etc.
[2012-07-20 12:25:08 -0400] digitallogic: ashb: thanks
[2012-07-20 12:26:56 -0400] digitallogic: oh sweet, there's a butt ton more info in there than I realized
[2012-07-20 12:38:55 -0400] Jay_Levitt: What's a good starting point for setting up my users/keys on a new node?
[2012-07-20 12:41:21 -0400] Jay_Levitt: (bonus points if it will teach knife ssh to use those credentials)
[2012-07-20 13:14:52 -0400] xerxas: Hi all !
[2012-07-20 13:14:56 -0400] xerxas: any hint for this :
[2012-07-20 13:14:56 -0400] xerxas: FATAL: Chef::Exceptions::ResourceNotFound: Cannot find a resource matching execute[apt-get update] (did you define it first?)
[2012-07-20 13:15:14 -0400] xerxas: i've updated the apt cookbook today, because I added rabbitmq cookbook
[2012-07-20 13:15:59 -0400] xerxas: if I add recipe[rabbitmq] in my run list, as soon as chef-client start, in expands the run_list to run apt, and stopping at apt , this execute exists in the cookbook
[2012-07-20 13:21:43 -0400] kamabe: xerxas: the comments here might explain it https://github.com/opscode-cookbooks/rabbitmq/commit/9bab2c64ed154cfb4e9bf88f0b8eb0b699dea8e9#-P0
[2012-07-20 13:22:55 -0400] xerxas: kamabe:  thanks, I don't understand ;)
[2012-07-20 13:23:53 -0400] kamabe: xerxas: you could probably just take out the apt-get-update. i know for us it was needed because it wasn't pulling the correct rabbitmq version. but that was a couple months ago
[2012-07-20 13:24:17 -0400] xerxas: yeah, I won't the one in the apt source ...
[2012-07-20 13:24:23 -0400] xerxas: not the ubuntu one
[2012-07-20 13:24:44 -0400] xerxas: the one with this apt source has at least the management plugin with the nice web interface ;)
[2012-07-20 13:25:45 -0400] xerxas: kamabe:  I commented it , and I'll see how it works ...
[2012-07-20 13:26:14 -0400] kamabe: hope it works for you
[2012-07-20 13:26:23 -0400] xerxas: kamabe:  anyway, thanks !
[2012-07-20 13:26:23 -0400] xerxas: ;)
[2012-07-20 13:26:27 -0400] xerxas: seems to work
[2012-07-20 13:26:30 -0400] xerxas: with an update
[2012-07-20 13:26:38 -0400] kamabe: that's great
[2012-07-20 13:26:52 -0400] xerxas:  still don't understand the bug,  anyway ...
[2012-07-20 13:26:57 -0400] kamabe: yeah me either
[2012-07-20 13:27:02 -0400] xerxas: don't need to understand , it works ;)
[2012-07-20 13:27:17 -0400] xerxas: kamabe: ah , ok , you didn't understood neither, so I'm not that stupid ;)
[2012-07-20 13:27:44 -0400] kamabe: well i could be stupid too haha
[2012-07-20 13:29:21 -0400] xerxas: ;)
[2012-07-20 13:29:25 -0400] xerxas: at least I'm not alone ;)
[2012-07-20 13:33:59 -0400] lflux: ohai chefs
[2012-07-20 13:34:18 -0400] lflux: is it possible to pass a URL to a package resource and have yum install it from the URL?
[2012-07-20 13:35:04 -0400] xerxas: chef yum will do what yum know to do
[2012-07-20 13:35:20 -0400] xerxas: I don't know yum very well , but I tend to think it does not install packages from an url
[2012-07-20 13:35:30 -0400] lflux: I'll rephrase that: it isn't from the chef resource
[2012-07-20 13:35:50 -0400] lflux: but on the command line you can pass a URL to both yum and rpm
[2012-07-20 13:36:23 -0400] xerxas: you can "yum install http://somehost/some.rpm" ?
[2012-07-20 13:36:36 -0400] lflux: yep
[2012-07-20 13:36:38 -0400] xerxas: if so , chef should be able to do it
[2012-07-20 13:36:49 -0400] xerxas: maybe needs some little work , never used yum cookbok
[2012-07-20 13:36:51 -0400] xerxas: cookook
[2012-07-20 13:36:54 -0400] xerxas: cookbook
[2012-07-20 13:37:03 -0400] lflux: DEBUG: Chef::Exceptions::Package: package[rpmforge-release] (blocket-fixit::default line 47) had an error: Chef::Exceptions::Package: Package rpmforge-release not found: http://pkgs.repoforge.org/rpmforge-release/rpmforge-release-0.5.2-2.el6.rf.x86_64.rpm
[2012-07-20 13:37:21 -0400] xerxas: lflux: sorry, can't help more
[2012-07-20 13:37:58 -0400] lflux: Specified package "rpmforge-release" with the URL as source
[2012-07-20 13:41:02 -0400] lflux: oh yum provider is trying to be clever, and treating source as a file
[2012-07-20 13:45:01 -0400] lflux: ... and so does RPM.
[2012-07-20 13:45:31 -0400] lflux: this seems stupid, why do I need to upload a cookbook_file instead of letting it use HTTP as the tools usually do?
[2012-07-20 13:48:26 -0400] geekbri: lflux: you can us the remote_file resource to fetch files instead of cookbook_file in your cookbooks.
[2012-07-20 13:49:32 -0400] lflux: geekbri: still a horrible workaround
[2012-07-20 13:49:41 -0400] geekbri: lflux: if you are talking about the package resource itself, you could always put a remote file in a repository and add that to your repositories
[2012-07-20 13:49:44 -0400] lflux: or I could just preseed the VMs with that installed
[2012-07-20 13:50:18 -0400] geekbri: lflux: so you could have your own repo (or the repo where it is hosted) in your apt-get sources or yum repositories list.  Then you should be able to install it fairly easily :)
[2012-07-20 13:50:23 -0400] geekbri: Just a couple suggestions.
[2012-07-20 13:50:49 -0400] lflux: geekbri: the package in question installs a repository
[2012-07-20 13:51:03 -0400] lflux: it also installs the GPG keys for the repo
[2012-07-20 13:52:09 -0400] geekbri: There must be a cookbook that lets you install repositories already.
[2012-07-20 13:52:21 -0400] geekbri: (for yum)
[2012-07-20 13:52:32 -0400] Jay_Levitt: hoover_damm: btw, to unspread some FUD: fnichols/chef_rvm works fine. I apparently didn't log out and back in after installing it, so naturally RVM wasn't in my $PATH.
[2012-07-20 13:52:44 -0400] geekbri: it looks like the Yum cookbook lets you add GPG keys and repositories, why not use that?
[2012-07-20 13:52:44 -0400] lflux: yes or I could just use distribution RPM package like all other repos do
[2012-07-20 13:53:38 -0400] lflux: preseeding the VM is easier tbh, plus I think it's broken behaviour that i can't specify a URL since both rpm and yum support URLs on the command line
[2012-07-20 13:53:45 -0400] geekbri: Well sounds like you've got chicken and an egg scenario here, you want to install more yum repos from a new yum repo.
[2012-07-20 13:54:19 -0400] geekbri: lflux: possibly.  I don't manage many RHEL compat servers anymore.  Perhaps you could fork and patch, then submit a pull request for that!
[2012-07-20 13:54:24 -0400] geekbri: or at least file a ticket
[2012-07-20 13:54:48 -0400] lflux: i'm trawling through JIRA right now to see if anyone has encoutered this
[2012-07-20 13:55:24 -0400] lflux: because using a remote_file first is kinda backwards, especially if you have proxy configurations for yum you need to use
[2012-07-20 14:12:33 -0400] zomGreg: I'm reading from data bags using chef-solo. Can I create data bags in a chef-solo environment? How about updating them?
[2012-07-20 14:13:58 -0400] geekbri: zomGreg: Databags with chef solo are just read from directories.  So if you have json file entries in a subdirectory of your data bag directory, those are the "rows" in your data bag, where the databag is the name of the subdir
[2012-07-20 14:14:24 -0400] geekbri: E.G.  /data_bag_path/my_data_bag/my_data_bag_entry.json
[2012-07-20 14:14:47 -0400] zomGreg: yep, got that part. so are they read only in a solo environ?
[2012-07-20 14:15:57 -0400] geekbri: zomGreg: I don't recall off hand, why not give it a try?
[2012-07-20 14:16:27 -0400] zomGreg: I have, it errors. But that doesn't mean it's not because I messed it up.
[2012-07-20 14:16:36 -0400] geekbri: zomGreg: gist the code and the error?
[2012-07-20 14:16:49 -0400] zomGreg: k, in a few.
[2012-07-20 14:17:39 -0400] nobdraisentone: `bash .. do' is a definition or what?
[2012-07-20 14:18:54 -0400] geekbri: nobdraisentone: it is a resource, that is why it can use guards and notifications.
[2012-07-20 14:19:35 -0400] geekbri: nobdraisentone: it is a resource that inherits from the Chef::Resource::Script resource
[2012-07-20 14:21:25 -0400] geekbri: Really all it does is set the interpreter resource parameter to "bash" heh, its a pretty thin wrapper :)
[2012-07-20 14:23:19 -0400] geekbri: Did I clear anything up with that :)
[2012-07-20 14:23:53 -0400] nobdraisentone: geekbri: https://github.com/opscode/chef/blob/master/chef/lib/chef/resource/bash.rb ?
[2012-07-20 14:24:18 -0400] geekbri: nobdraisentone: that is indeed the resource :
[2012-07-20 14:24:19 -0400] geekbri: :)
[2012-07-20 14:24:46 -0400] nobdraisentone: Actually I'm not familiar with `resources' yet
[2012-07-20 14:25:00 -0400] geekbri: nobdraisentone: ahhh ok, well have you written any chef recipes?  You use them all the time if you ahve.
[2012-07-20 14:25:19 -0400] nobdraisentone: Yes I didi
[2012-07-20 14:25:21 -0400] nobdraisentone: did*
[2012-07-20 14:25:27 -0400] Jay_Levitt: Anyone have opinions about fnichol/chef-user vs. opscode/cookbooks/users?
[2012-07-20 14:26:02 -0400] geekbri: nobdraisentone: directory, template, file, bash, script these are all resources.  They are like build blocks :).  Think of them as a way to describe a piece of system state, and how you want it to be.
[2012-07-20 14:26:18 -0400] Jay_Levitt: (for that matter, looks like opscode/cookbooks hasn't been touched in four months.. are we moving away from that in general?) </noob>
[2012-07-20 14:26:28 -0400] nobdraisentone: geekbri: ok
[2012-07-20 14:26:53 -0400] geekbri: Jay_Levitt: We created our own user management cookbooks because we couldn't find anything out there that did what we wanted.  I was pretty disappointed with the state of most of them.
[2012-07-20 14:27:09 -0400] Jay_Levitt: geekbri: tell me more, tell me more
[2012-07-20 14:27:36 -0400] geekbri: Jay_Levitt: Well I do hope we will get to open source it soon.  The author has been a little reluctant because he keeps saying "It's not where I want it to be yet for public consumption"
[2012-07-20 14:27:46 -0400] Jay_Levitt: heh, I know that feeling
[2012-07-20 14:27:53 -0400] Jay_Levitt: "Github is the new resume, and this is so unpolished"
[2012-07-20 14:27:59 -0400] zomGreg: https://gist.github.com/3151010
[2012-07-20 14:27:59 -0400] geekbri: exactly.
[2012-07-20 14:28:19 -0400] geekbri: I have no such reservations. :) If people can't understand that some things on github are WIP or tech demo I dont want to work for them anyway
[2012-07-20 14:28:39 -0400] Jay_Levitt: yeah.  I try to fill up Google with examples of me being even MORE unpolished.  Moving the overton window, all that.
[2012-07-20 14:29:22 -0400] geekbri: I just try not to worry about it too much :)
[2012-07-20 14:30:07 -0400] geekbri: zomGreg: What is the error you are getting?
[2012-07-20 14:30:25 -0400] zomGreg: https://gist.github.com/3151030
[2012-07-20 14:30:27 -0400] zomGreg: that one
[2012-07-20 14:31:11 -0400] geekbri: ah yes, you might need to use the chef solo search cookbook
[2012-07-20 14:32:11 -0400] zomGreg: yeah, the docs only mention accessing data bag data from chef-solo, but I can't find explicitly where it says I *can't* create/updated data bags in chef-solo.
[2012-07-20 14:32:27 -0400] zomGreg: where can I read more about these: data_bag() and data_bag_item()
[2012-07-20 14:35:03 -0400] geekbri: zomGreg: https://github.com/opscode/chef/blob/4c3b8b58218e7f08b3294b934b9ad51e5c565fc8/chef/lib/chef/data_bag_item.rb
[2012-07-20 14:35:17 -0400] geekbri: I mean there may be other sources for reading about it, but that right there may or may not be helpful :)_
[2012-07-20 14:36:31 -0400] geekbri: dur, sorry wrong link
[2012-07-20 14:37:09 -0400] zomGreg: I'm a bit of a chef noob, so I was happily reading.
[2012-07-20 14:39:02 -0400] Jay_Levitt: geekbri: do you remember what your pain points were with the existing cookbooks, just so I don't bang my head against the wall assuming it's my fault?
[2012-07-20 14:39:43 -0400] geekbri: Jay_Levitt: we wanted a better way to manage things like SSH authorized keys for users, 'enabling' and 'disabling' users through databags
[2012-07-20 14:39:58 -0400] geekbri: we wanted to be able to easily modify the groups that users are members of
[2012-07-20 14:40:12 -0400] geekbri: a lot of different things that werent easily provided by what was out there
[2012-07-20 14:40:22 -0400] geekbri: at least not without making a huge mess :)
[2012-07-20 14:40:52 -0400] zomGreg: I only see methods in there for creating data bags via RESTful API, so yeah, looks like read only.
[2012-07-20 14:45:00 -0400] geekbri: zomGreg: Yeah I'm prowling around in Chef::DataBag to see what I can figure out
[2012-07-20 14:45:52 -0400] geekbri: zomGreg: I see that load() provides a way to handle the situation where there is no CouchDB and it pulls from the :data_bag_path but I see no such thing for save
[2012-07-20 14:48:05 -0400] zomGreg: Ok, just wanted to make sure I wasn't trying to do something that's impossible right now.
[2012-07-20 14:49:10 -0400] geekbri: zomGreg: Me too!  I've never tried that before, I just haven't had a use case for it.  Good to know.
[2012-07-20 14:49:31 -0400] geekbri: zomGreg: I mean it LOOKS to me like there is no mechanism for that, but... I've been wrong before.
[2012-07-20 14:49:55 -0400] zomGreg: yeah, clearly this is a chef-solo only problem, but in my task I'm limiting myself to using chef-solo for a reason.
[2012-07-20 14:50:50 -0400] yfeldblum: geekbri, IMO data bag items should typically be treated as read-only in chef-client and chef-solo runs
[2012-07-20 14:51:04 -0400] zomGreg: is there a technical reason for that?
[2012-07-20 14:51:17 -0400] zomGreg: seems like it's just a file action, read from write to.
[2012-07-20 14:51:26 -0400] asimaslam: Hey. Trying to change an attribute during the chef run inside a ruby_block to then be read by other resources but it doesn't work. Any better ways of doing that?
[2012-07-20 14:51:44 -0400] geekbri: Seems like maybe something that is ephemeral like that hsould be a node attribute not a data bag item.
[2012-07-20 14:51:55 -0400] yfeldblum: zomGreg, read and write all the files you like; but data bag items are an interface, not an implementation, so far as recipes are or ought to be concerned
[2012-07-20 14:52:48 -0400] yfeldblum: zomGreg, File.open("/path/to/file", "w") is of course always available to you
[2012-07-20 14:53:23 -0400] asimaslam: Any ideaS?
[2012-07-20 14:53:39 -0400] yfeldblum: asimaslam, why are you trying to do that?
[2012-07-20 14:54:04 -0400] zomGreg: yeah, I was trying to be chefonic about it and use databags. And the interface of data bags in chef-solo is to a file so I was just trying to understand.
[2012-07-20 14:54:06 -0400] asimaslam: I have some information in a file, but that file is only created during the run as its extracted from a tarball
[2012-07-20 14:54:39 -0400] yfeldblum: zomGreg, nothing specifically chefonic about avoiding File.open :P
[2012-07-20 14:55:24 -0400] asimaslam: I may have to execute the entire thing in a bash block if I cant get resources to see the attribute change.
[2012-07-20 14:55:26 -0400] yfeldblum: zomGreg, the interface of data bag items in chef-solo isn't "to a file"; that's sort of the implementation detail; the interface is `DataBagItem.load` (or `data_bag_item`)
[2012-07-20 14:55:28 -0400] zomGreg: k, thanks for looking into it guys
[2012-07-20 14:55:51 -0400] yfeldblum: asimaslam, is it possible for you to predict what the value will be?
[2012-07-20 14:56:00 -0400] asimaslam: haha no
[2012-07-20 14:56:21 -0400] asimaslam: It has to be read from the file
[2012-07-20 14:56:48 -0400] yfeldblum: asimaslam, what do you need to do with the value?
[2012-07-20 14:57:14 -0400] asimaslam: Its used to unpack another file with that string in the name, then create directories and so on
[2012-07-20 14:58:45 -0400] asimaslam: I could define a method called foo and call that everytime I want the value which will read the file :p
[2012-07-20 14:58:58 -0400] yfeldblum: asimaslam, wouldn't work :P
[2012-07-20 14:59:03 -0400] asimaslam: what?!
[2012-07-20 14:59:25 -0400] asimaslam: Cant I define reusable methods or code?
[2012-07-20 14:59:31 -0400] yfeldblum: asimaslam, you sure can
[2012-07-20 15:00:03 -0400] asimaslam: so def foo; File.read("file"); end
[2012-07-20 15:00:13 -0400] asimaslam: Wouldn't that work?
[2012-07-20 15:00:23 -0400] yfeldblum: asimaslam, i'm just not sure how you plan to call foo after the first file is unpacked but before declaring the attributes of the other directories
[2012-07-20 15:01:03 -0400] yfeldblum: asimaslam, that method will work, of course; it's just ruby after all
[2012-07-20 15:01:32 -0400] asimaslam: Will it though? Or will chef run the method at compile time?
[2012-07-20 15:01:38 -0400] asimaslam: ruby_block's are run during execution
[2012-07-20 15:02:08 -0400] yfeldblum: asimaslam, that's right
[2012-07-20 15:02:20 -0400] asimaslam: Can I have a named ruby_block that I can call?
[2012-07-20 15:02:39 -0400] yfeldblum: asimaslam, but you would have to be calling that method during compilation time in order to declare the directory resource, right?
[2012-07-20 15:03:08 -0400] yfeldblum: asimaslam, not sure what you mean by "call"
[2012-07-20 15:03:35 -0400] yfeldblum: asimaslam, one good bet is to do the whole thing all within a single bash script, or perhaps all within a single ruby_block
[2012-07-20 15:03:44 -0400] asimaslam: yea sounds like it
[2012-07-20 15:03:45 -0400] asimaslam: oh well
[2012-07-20 15:03:59 -0400] asimaslam: thanks anyway
[2012-07-20 15:04:47 -0400] yfeldblum: asimaslam, keep in mind the chef model, where you tell the server up-front all the details about what it should be like; it's not a back-and-forth Q&A session
[2012-07-20 15:05:12 -0400] asimaslam: yea i know but its like a release procedure and I'm not updated chef attributes everytime a release occurs
[2012-07-20 15:05:32 -0400] asimaslam: Or everytime versioning changes or something.
[2012-07-20 15:05:42 -0400] yfeldblum: asimaslam, of course not
[2012-07-20 15:06:47 -0400] yfeldblum: asimaslam, i just mentioned that because if you keep that principle in mind, it helps in trying to figure out how to use chef effectively
[2012-07-20 15:06:48 -0400] afterglow: is anyone familiar with chef-jenkins? I am getting an error 'Unknown error processing config file'
[2012-07-20 15:07:46 -0400] yfeldblum: asimaslam, but the "details" are the resources and their attributes, so feel free to make the resources you are declaring as overarching or as granular as you like
[2012-07-20 15:08:02 -0400] asimaslam: yea I know, this is the only place where I've had this issue. its very hackerish. THe problem is I have to be able to bootstrap vm's as they are created, which means pull rather than push and a more automated system. The vm's do not have access to the release system but they do have access to a chef repo full of tarballs. So I thought, package the release in a .stable file and get it up there. But we manage directories by version numbers so it complicates 
[2012-07-20 15:09:02 -0400] yfeldblum: asimaslam, e.g. `execute("my-cookbook-deploy-the-app"){command "/deploy/the/app"}` is a single resource
[2012-07-20 15:09:34 -0400] asimaslam: I liked small compact resources, doing it all in a single bash resource sucks
[2012-07-20 15:09:56 -0400] yfeldblum: asimaslam, resources come in the small and they come in the large
[2012-07-20 15:10:09 -0400] asimaslam: large resources are less reusable
[2012-07-20 15:10:18 -0400] asimaslam: I have to scatter if statements everywhere to stop things from rerunning
[2012-07-20 15:10:36 -0400] yfeldblum: asimaslam, i'm not a fan of bash resources, but more because i'd prefer to write resources & providers in ruby when it makes sense
[2012-07-20 15:11:04 -0400] yfeldblum: asimaslam, providers are indeed complex, and rightly so - take a look at some of opscode's provider classes: https://github.com/opscode/chef/tree/master/chef/lib/chef/provider
[2012-07-20 15:11:26 -0400] asimaslam: yea I've looked at it before, not always pretty
[2012-07-20 15:11:41 -0400] yfeldblum: asimaslam, but that is exactly what it means to be a provider, and that's as it should be
[2012-07-20 15:12:08 -0400] yfeldblum: asimaslam, the  reusability lies in the interface, not in the implementation
[2012-07-20 15:12:32 -0400] yfeldblum: asimaslam, so long as you write generic resources and providers that match the resources, they are reusable
[2012-07-20 15:13:36 -0400] asimaslam: yea true
[2012-07-20 15:13:43 -0400] yfeldblum: asimaslam, long code isn't really a problem to me; part of what it means to write code is to check for error conditions, edge cases, what the current state is, etc
[2012-07-20 15:14:09 -0400] asimaslam: I prefer compact code as its prone to less errors and more easily reusable
[2012-07-20 15:14:10 -0400] yfeldblum: asimaslam, a lot of the code i write is long, but the interface to it is small
[2012-07-20 15:15:00 -0400] yfeldblum: asimaslam, lots of checks on the arguments, verification of the current state, etc., plus many test cases that put the code through its paces
[2012-07-20 15:33:54 -0400] jerem`: I get an FATAL: Net::HTTPServerException: 401 when I run chef-client
[2012-07-20 15:34:11 -0400] jerem`: after a simple reboot
[2012-07-20 15:42:53 -0400] jerem`: please could you guide me about the 401 error when I run the chef-client command on my node
[2012-07-20 15:43:25 -0400] behemphi: jerem`  Could you do this on the machine:
[2012-07-20 15:43:40 -0400] behemphi: cat /var/cache/chef/chef-stacktrace.out
[2012-07-20 15:43:46 -0400] behemphi: and make a gist
[2012-07-20 15:46:14 -0400] jerem`: behemphi: here http://ziirish.info/y/Xhpue , thanks
[2012-07-20 15:46:46 -0400] jtimberman: jerem`: check your system time
[2012-07-20 15:47:03 -0400] jerem`: jtimberman: it's ok !
[2012-07-20 15:47:41 -0400] behemphi: @jerem` I am no expert, but (LOL) I would say to first check that your system time is consistent then check the client is still in place
[2012-07-20 15:49:00 -0400] yfeldblum: jtimberman, maybe hosted chef should change its system time to match my node?
[2012-07-20 15:49:04 -0400] yfeldblum: jtimberman, ever think of that?
[2012-07-20 15:49:35 -0400] anthroprose: yfeld: WHat if you have nodes in different timezones?
[2012-07-20 15:49:42 -0400] anthroprose: mine are all over the place
[2012-07-20 15:50:52 -0400] behemphi: jtimberman, I would love a quick explain about why that check is necessary
[2012-07-20 15:51:01 -0400] behemphi: i.e. what does it "prove"
[2012-07-20 15:59:23 -0400] jerem`: problem solved thanks you
[2012-07-20 16:00:57 -0400] yfeldblum: anthroprose, then hosted chef should be quick about it
[2012-07-20 16:01:29 -0400] yfeldblum: behemphi, it's used to give a very short expiration window to the connection's authentication
[2012-07-20 16:01:40 -0400] yfeldblum: behemphi, to prevent delayed playback
[2012-07-20 16:01:45 -0400] yfeldblum: behemphi, and other attacks
[2012-07-20 16:02:17 -0400] behemphi: not familiar with that sort of thing, but I will look it up
[2012-07-20 16:02:23 -0400] behemphi: thx!  yfeldblum
[2012-07-20 16:04:27 -0400] jtimberman: yfeldblum: ha
[2012-07-20 16:04:53 -0400] jtimberman: yfeldblum: and thanks for explaining :0
[2012-07-20 16:04:56 -0400] jtimberman: :)
[2012-07-20 16:05:16 -0400] yfeldblum: jtimberman, no probs
[2012-07-20 16:11:53 -0400] ssd7_: Ohai Chefs!
[2012-07-20 16:20:04 -0400] cpasmoi: :)
[2012-07-20 16:45:42 -0400] maek: so I had to recover an oss chef server and didnt have /var/cache/chef backed up. so no cookbook files. I have since re uploaded my cookbooks but a few node still give errors like worker (port 4014) ~ File with checksum bdc002b25ae36cd48cb2a357750ad0a1 not found in the repository (this should not happen) - (Merb::ControllerExceptions::InternalServerError) - is it possible to just flush what ever it thinks should be there?
[2012-07-20 17:04:39 -0400] ggolin: hey guys
[2012-07-20 17:05:54 -0400] ggolin: one of my servers shows node[:chef_environment] to be empty even though knife node edit nodename shows chef_environment is set up. what am i missing? chef 10.12.0 on ubuntu precise.
[2012-07-20 17:07:21 -0400] yfeldblum: chef_environment isn't an attribute - it's a method
[2012-07-20 17:07:24 -0400] yfeldblum: node.chef_environment
[2012-07-20 17:07:44 -0400] ggolin: ehm
[2012-07-20 17:08:35 -0400] specialsauce: this confused me at first too :-P
[2012-07-20 17:09:01 -0400] ggolin: a-ha!
[2012-07-20 17:09:07 -0400] ggolin: ok thanks! that solved it.
[2012-07-20 17:28:09 -0400] simonjj: will including a recipe also bring in any variables defined therein ?
[2012-07-20 17:28:43 -0400] JasonF: Well, it'll include whatever attributes are in attributes.rb; but make you you read and understand the override order of attributes
[2012-07-20 17:29:35 -0400] simonjj: which this http://wiki.opscode.com/display/chef/Attributes#Attributes-SettingAttributes is a very good reference for
[2012-07-20 17:44:31 -0400] newb_: hey chefs
[2012-07-20 17:44:50 -0400] newb_: getting started with Spiceweasel
[2012-07-20 17:45:15 -0400] newb_: I am storing my cookbooks at a location, and would like to specify the path like I do when using "-o" in knife
[2012-07-20 17:45:39 -0400] newb_: how do I pass that option to Spiceweasel so it passes that in turn to knife?
[2012-07-20 17:47:39 -0400] Litex: Dear Whoever Named the Shef Tool:   *grabs your shirt collar and shakes violently*  WHY?!?@$?!@?$    WHY?!@$?
[2012-07-20 17:47:56 -0400] newb: hey chefs
[2012-07-20 17:48:08 -0400] newb: getting started with Spiceweasel.
[2012-07-20 17:48:19 -0400] newb:  I am storing my cookbooks at a location, and would like to specify the path like I do when using "-o" in knife: how do I pass that option value to Spiceweasel so it passes that in turn to knife?
[2012-07-20 17:52:29 -0400] Litex: And when you run 'shef', the prompt is 'chef >'
[2012-07-20 17:52:40 -0400] Litex: How to troll an entire community.
[2012-07-20 17:54:03 -0400] josh_k_: what's the recommended way to capture the output of some bash hotness to use as a variable in a recipe?
[2012-07-20 17:54:28 -0400] josh_k_: I have a little 5 line bash that gives me some data I'd like to use elsewhere with higher-level chef operations
[2012-07-20 18:00:25 -0400] jperry2: any good utility for switching back and forth between knife.rb files?
[2012-07-20 18:01:01 -0400] jperry2: We are going to use a local chef server for local development so the user should be able to interact with it with ease
[2012-07-20 18:01:14 -0400] jperry2: then also have the ability to talk to the main chef server
[2012-07-20 18:02:15 -0400] jperry2: looks like this plugin does this
[2012-07-20 18:02:16 -0400] jperry2: https://github.com/greenandsecure/knife-block
[2012-07-20 18:08:36 -0400] cheeseplus: jperry2: knife-block or spork
[2012-07-20 18:11:50 -0400] spokrandt: every new client I setup i'm getting
[2012-07-20 18:11:52 -0400] spokrandt: [Fri, 20 Jul 2012 09:27:53 -0700] INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate. Ensure that your client key is valid.
[2012-07-20 18:11:54 -0400] spokrandt: [Fri, 20 Jul 2012 09:27:53 -0700] ERROR: Net::HTTPServerException: 401 "Unauthorized"
[2012-07-20 18:11:56 -0400] spokrandt: [Fri, 20 Jul 2012 09:27:53 -0700] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out
[2012-07-20 18:11:58 -0400] spokrandt: I'm putting the clinet.pem file in /etc/chef/  and have the master vaildation.pem.   any ideas on whats wrong?
[2012-07-20 18:14:44 -0400] jessicab: spokrandt: normally client.pem is generated automatically by chef-client when it created the node
[2012-07-20 18:18:26 -0400] miah: moinmoin
[2012-07-20 18:23:43 -0400] cheeseplus: miah: dokudouku
[2012-07-20 18:25:50 -0400] geekbri: tiddlywikitiddlywiki
[2012-07-20 18:31:33 -0400] miah: moin is actually a word though
[2012-07-20 18:31:41 -0400] miah: http://en.wikipedia.org/wiki/Moin
[2012-07-20 18:34:26 -0400] geekbri: Oh I see! :)
[2012-07-20 18:34:37 -0400] spokrandt: Hmmm after the package add I have only a client.rb..  following the wiki  http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+Ubuntu+or+Debian
[2012-07-20 19:07:00 -0400] newb: does Spiceweasel only print knife commands  instead of executing them?
[2012-07-20 19:08:13 -0400] yfeldblum: newb, i believe so
[2012-07-20 19:09:29 -0400] newb: damn
[2012-07-20 19:10:00 -0400] newb: I was so excited it would save me typing
[2012-07-20 19:11:49 -0400] yfeldblum: pipe it to bash?
[2012-07-20 19:22:04 -0400] newb: spiceweasel ohthis.yml | bash is ok but does not handle error checking you see
[2012-07-20 19:24:27 -0400] lawrenceseattle: if you're removing a package, how do you ensure that the service is stopped beforehand?
[2012-07-20 19:27:56 -0400] yfeldblum: lawrenceseattle, `service "service-name" do ; action [:stop, :disable] ; end`
[2012-07-20 19:28:31 -0400] lawrenceseattle: yfeldblum: thanks.  You have to have this specified before the package resource in the recipe?
[2012-07-20 19:28:48 -0400] lawrenceseattle: or is there a way to say always stop the service before uninstalling?
[2012-07-20 19:29:32 -0400] yfeldblum: lawrenceseattle, the first one
[2012-07-20 19:29:51 -0400] yfeldblum: lawrenceseattle, packages often include, in their uninstall scripts, to stop the service first
[2012-07-20 19:30:18 -0400] lawrenceseattle: yea, I've considered doing that too
[2012-07-20 19:30:36 -0400] lawrenceseattle: might be cleaner
[2012-07-20 19:31:28 -0400] anthroprose: that is the path I just took.... fix the damn init.d script instead of hacking chef code to check for idempotent 'start' commands... same concept
[2012-07-20 19:32:10 -0400] anthroprose: leverage the system processes already in place, don't add more..
[2012-07-20 19:32:19 -0400] yfeldblum: there's no reason to do everything in chef; doing the top-level stuff in chef and making sure your packages have good uninstall scripts works too
[2012-07-20 19:32:45 -0400] yfeldblum: chef helps with system integration; do system integration with chef, rather than bit-twiddling
[2012-07-20 19:33:05 -0400] anthroprose: agreed... I see people re-writing rpm with recipes...
[2012-07-20 19:33:05 -0400] anthroprose: heh
[2012-07-20 19:33:32 -0400] yfeldblum: it is somewhat odd to me
[2012-07-20 19:33:59 -0400] yfeldblum: i can understand it if you can thereby avoid having to write your own packages and distribute them
[2012-07-20 19:34:23 -0400] yfeldblum: at some point of course it becomes more convenient to do the latter, so that's the point where you should start switching over
[2012-07-20 19:35:00 -0400] anthroprose: I just spun up a local repository to do all of my package aggregation.... *just* so I didn't have to do it all in chef
[2012-07-20 19:35:16 -0400] anthroprose: f'n rhel
[2012-07-20 19:35:31 -0400] yfeldblum: anthroprose, and, depending on your circumstances, that's a damn fine choice
[2012-07-20 19:35:48 -0400] anthroprose: why dont they have a package for one of the major projects they support(rabbitmq)? I have no clue...
[2012-07-20 19:36:30 -0400] anthroprose: my circumstances are that I've been horribly spoiled by ubuntu/deb for a couple years, and now I'm back on rpm systems
[2012-07-20 19:36:41 -0400] anthroprose: very confusing why I can't just install stuff :)
[2012-07-20 19:48:13 -0400] newb: how do I find out which knife.rb knife is using? is there a flag to knife that gives that info?
[2012-07-20 19:52:40 -0400] anthroprose: newb: I've had to strace that before
[2012-07-20 19:52:52 -0400] anthroprose: it does a heiarchical look for defaults if you dont specify
[2012-07-20 19:53:05 -0400] rndm: hey guys. is it possible to access the node variable from within a lib?
[2012-07-20 20:04:44 -0400] briley: Is there anything that needs to be done to recreate a validation key besides deleting the existing one on a chef server? The wiki led me to believe this was the case, but it seems my chef server will not come back up again without the validation key there.
[2012-07-20 20:08:49 -0400] cwj: rndm: i feel like i recently saw a way to do it without passing the node object as an argument, but i cant remember how
[2012-07-20 20:12:09 -0400] cwj: maybe if i have another cup of coffee it will come to me
[2012-07-20 20:13:08 -0400] rndm: cwj, do you think including Chef::Recipe in the lib's module would do it?
[2012-07-20 20:16:20 -0400] geekbri: Can't you just create a new
[2012-07-20 20:16:28 -0400] geekbri: Chef::Node object and then call .load on it?
[2012-07-20 20:17:19 -0400] rndm: ah, i saw an example like Chef::Node.new(FQDN). but didn't know the FQDN apriori
[2012-07-20 20:17:24 -0400] rndm: maybe that does it
[2012-07-20 20:17:43 -0400] geekbri: yeah I mean, or perhaps you could use Chef::Search::Query and then just return a node object from that
[2012-07-20 20:18:41 -0400] yfeldblum: geekbri, that would be inefficient
[2012-07-20 20:19:04 -0400] yfeldblum: rndm, prefer to pass the node instance into the methods
[2012-07-20 20:19:20 -0400] yfeldblum: rndm, libraries are about normal ruby programming
[2012-07-20 20:19:27 -0400] yfeldblum: rndm, not this fancy recipe dsl
[2012-07-20 20:19:40 -0400] yfeldblum: rndm, in normal ruby programming, if you want a method to know about something, you pass it in
[2012-07-20 20:19:53 -0400] rndm: well i've probably done horrible horrible things =)
[2012-07-20 20:20:27 -0400] yfeldblum: 1000dd
[2012-07-20 20:20:35 -0400] yfeldblum: that should fix it right up
[2012-07-20 20:21:07 -0400] rndm: =). i have a class which encapsulates all of the metadata of a given app. it provides accessor methods for things like app.path(:home), and app.developer_key
[2012-07-20 20:21:24 -0400] rndm: it mainly exists as a state holder which gets passed to several custom definitons
[2012-07-20 20:21:47 -0400] yfeldblum: rndm, well done
[2012-07-20 20:23:33 -0400] geekbri: Hah yeah, passing the node in would certainly be the easier way to handle it as you don't have to hit the server with an API request
[2012-07-20 20:23:49 -0400] geekbri: I thought maybe this was a situation where the library was loading information about a node that wasn't itself.
[2012-07-20 20:23:59 -0400] geekbri: or at least, not from the node that was calling the library
[2012-07-20 20:24:23 -0400] yfeldblum: rndm, so obviously you'd do `app = MyCookbookLibAppClass.new(node, "app-name")`
[2012-07-20 20:24:52 -0400] geekbri: Although I suppose in the case I state you would do that as well but instead of passing in node you would pass in Chef::Node.new().load(blah)
[2012-07-20 20:25:15 -0400] rndm: yeah, that's what it is now. except it's always that so it'd be nice to supress the node parameter as it's unnecessary
[2012-07-20 20:25:35 -0400] erratic: I get access to a 30 gb of memory server today
[2012-07-20 20:36:06 -0400] spokrandt: reinstalling clients now and get
[2012-07-20 20:36:08 -0400] spokrandt: HTTP Request Returned 409 Conflict: Client already exists
[2012-07-20 20:36:20 -0400] spokrandt: but they are not listed in the gui under clients.
[2012-07-20 20:40:31 -0400] masterkorp: http://i.minus.com/ibyx7Oo4wprfkf.gif
[2012-07-20 20:40:35 -0400] masterkorp: sorry
[2012-07-20 20:40:40 -0400] evilantnie: Is there any easy way to prevent the mysql_database_user resource from logging the entire SQL grant statement in the client.log?  aside from setting the client log level
[2012-07-20 20:41:09 -0400] evilantnie: I'd like to keep the log level at :info if possible
[2012-07-20 20:42:05 -0400] erratic: masterkorp awesome
[2012-07-20 20:43:27 -0400] erratic: masterkorp did that really happen
[2012-07-20 20:55:04 -0400] james1234: question.  (I'm totally new to chef).  I just got my environment up and running on a test box.  Decided to throw it on my first DEV box, and I'm getting 'ERROR: Net::HTTPServerException: 413 "Request Entity Too Large"'
[2012-07-20 20:55:24 -0400] james1234: The only thing I could find on google was in repeat to the node data size.
[2012-07-20 20:55:40 -0400] james1234: I see that all my LDAP information is in the node data, and it look pretty big.
[2012-07-20 20:55:50 -0400] james1234: how can I reduce the size of my node data?
[2012-07-20 21:00:43 -0400] cwj: masterkorp: 100%
[2012-07-20 21:02:42 -0400] riddopic: Hello, does someone know how to get the nodes environment in a recipe?
[2012-07-20 21:03:05 -0400] riddopic: I looked for node[:environment], etc. but I don't see it?
[2012-07-20 21:03:44 -0400] evilantnie: I think it's just node.chef_environment
[2012-07-20 21:07:28 -0400] yfeldblum: chef_environment is a method, and is not a node-attribute
[2012-07-20 21:08:40 -0400] riddopic: Is there a node attribute for the nodes environment?
[2012-07-20 21:10:54 -0400] evilantnie: there's a note explaining that on the environments doc page I think
[2012-07-20 21:11:05 -0400] evilantnie: " It also cannot be accessed via the typical attribute syntax node[:attribute_name] but rather must be accessed by calling the chef_environment method on the node: node.chef_environment."
[2012-07-20 21:28:08 -0400] evilantnie: quick question on best practices related to encrypted databags, does everyone manually copy their secret key to their nodes? i'd like to see if I can wrap it all up in the bootstrap so I don't have any manual steps for booting up new nodes
[2012-07-20 21:29:24 -0400] rndm: evilantnie: knife will copy it
[2012-07-20 21:29:53 -0400] rndm: evilantnie: set encrypted_data_bag_secret in knfie.rb
[2012-07-20 21:31:00 -0400] james1234: I've got a test environment on opscode, and I'm getting 413 "Request Entity Too Large" for my first dev host. I'm assuming it's because of the LDAP user information of the host.  Any way to reduce the size of the node data?
[2012-07-20 21:31:46 -0400] Bonkers: how can I set node.chef_environment when using chef-solo?
[2012-07-20 21:32:12 -0400] yfeldblum: Bonkers, set in the attributes json file
[2012-07-20 21:35:22 -0400] evilantnie: rndm: I had a problem with the chef-client cookbook overwriting my initial bootstrap settings... but I guess I can modify that cookbook to grab the file once it's copied
[2012-07-20 21:36:02 -0400] rndm: hmm... that doesn't happen for me
[2012-07-20 21:36:43 -0400] anthroprose: evil: I have a similar issue where the bootstrap's attributes are not persisted
[2012-07-20 21:36:57 -0400] evilantnie: anthroprose: exactly
[2012-07-20 21:36:58 -0400] anthroprose: havnt figured out whether it was me being newb or chef
[2012-07-20 21:37:04 -0400] evilantnie: haha same here
[2012-07-20 21:37:06 -0400] anthroprose: I can reproduce...
[2012-07-20 21:37:56 -0400] anthroprose: I'm running a single recipe with a single attribute.. so it shouldnt be hard to debug
[2012-07-20 21:40:20 -0400] evilantnie: I think I know why, it's because there is not bootstrap template for Ubuntu 12.04 yet
[2012-07-20 21:41:15 -0400] evilantnie: no, actually there is... hmm
[2012-07-20 21:41:40 -0400] anthroprose: this is happening to me with amazon linux
[2012-07-20 21:43:59 -0400] karsten: Is there a doc somewhere covering role json files and what goes in them specific to a given cookbook?  Basic stuff, but I'm not grokking the file structure as a lowly sysadmin with very modest Ruby-fu.
[2012-07-20 21:44:31 -0400] miah: knife role show <role> -Fj
[2012-07-20 21:45:09 -0400] miah: that will display a role in the json format.. so you can convert your existing roles and learn the json structure.
[2012-07-20 21:45:33 -0400] miah: and by convert, i mean the local copies of your roles that you should have in your repo
[2012-07-20 21:45:34 -0400] karsten: miah: Um.  The role *is* in json format.
[2012-07-20 21:45:49 -0400] miah: then im confused about your question
[2012-07-20 21:45:51 -0400] karsten: miah: I'm trying to figure out what I need to do to add a cookbook to it and where that goes.
[2012-07-20 21:46:19 -0400] karsten: Specifically, simple case, add "hostname" cookbook with a default rule of naming the node after its Chef nodename.
[2012-07-20 21:46:30 -0400] miah: it goes in the run_list section
[2012-07-20 21:48:02 -0400] miah: karsten: https://gist.github.com/3153477
[2012-07-20 21:48:06 -0400] yfeldblum: {"run_list": ["recipe[cookbook-name::recipe-name]", "recipe[other-cookbook-name::other-recipe-name]"]}
[2012-07-20 21:59:39 -0400] yfeldblum: miah, howdy
[2012-07-20 22:05:10 -0400] miah: hi yfeldblum
[2012-07-20 22:09:54 -0400] evilantnie: So, my initial bootstrap call only seems to move the client.pem over, but doesn't copy any other configuration files.
[2012-07-20 22:11:04 -0400] evilantnie: the initial run works, but that box can't run chef-client... I worked around that by creating a base role that run the chef-client cookbook, which is fine, but it doesn't incluce the encrypted_data_bag_secret option in the it's template
[2012-07-20 22:15:03 -0400] Bonkers: yfeldblum, I've tried a top-level chef_environment and environment, but neither seem to work, is it called something else (setting chef-solo's environment)?
[2012-07-20 22:15:41 -0400] evilantnie: does chef-solo even work with environments?
[2012-07-20 22:16:29 -0400] Bonkers: no, but I'd still like to set a value
[2012-07-20 22:16:35 -0400] joemiller: any recommendations for how to:  need to run `git tag` to get a git ref, then run the `git` resource with that ref. i tried to use mixlib/shellout but that runs during compile phase, and i need to run the shell cmd during execution
[2012-07-20 22:17:30 -0400] evilantnie: Bonkers: I don't think you can, that's a method, not an attribute
[2012-07-20 22:17:47 -0400] evilantnie: I think it's meant to be read only
[2012-07-20 22:19:14 -0400] Bonkers: evilantnie, that's what I was afraid of, but do I really have to set up a chef-server just to test my stuff in vagrant?
[2012-07-20 22:19:42 -0400] evilantnie: Bonkers: you might be able to set the environment in the Vagrantfile
[2012-07-20 22:20:21 -0400] Bonkers: I've looked, only supported for chef-client
[2012-07-20 22:20:35 -0400] Bonkers: the only other way to pass options is thorugh the json config, but having trouble there
[2012-07-20 22:23:28 -0400] evilantnie: Bonkers: looks like it's supported https://github.com/mitchellh/vagrant/pull/358
[2012-07-20 22:24:53 -0400] Bonkers: that's for chef-client/chef-server setups :-/
[2012-07-20 22:26:10 -0400] evilantnie: ahh
[2012-07-20 22:31:22 -0400] allan_wind: I have a cookbook that updates a template and notifies a service to reload, however reload is not called
[2012-07-20 22:31:45 -0400] allan_wind:  ** [out :: s2.leadkarma.com] [Fri, 20 Jul 2012 22:24:00 +0000] INFO: template[/etc/logfmon.conf] sending reload action to service[logfmon] (delayed)
[2012-07-20 22:31:45 -0400] allan_wind:  ** [out :: s2.leadkarma.com] [Fri, 20 Jul 2012 22:24:00 +0000] INFO: Processing service[logfmon] action reload (logfmon::default line 61)
[2012-07-20 22:31:45 -0400] allan_wind:  ** [out :: s2.leadkarma.com] [Fri, 20 Jul 2012 22:24:00 +0000] DEBUG: service[logfmon] supports status, running
[2012-07-20 22:31:48 -0400] allan_wind: any ideas?
[2012-07-20 22:41:48 -0400] Bonkers: evilantnie, just confirmed by reading source that this is not possible without modifying vagrant, too bad
[2012-07-20 22:44:01 -0400] allan_wind: any ideas on why reload fails?
[2012-07-20 22:45:04 -0400] evilantnie: what's your recipe look like?
[2012-07-20 22:45:43 -0400] evilantnie: also, I think the clue may be in your debug statement
[2012-07-20 22:45:55 -0400] evilantnie: it looks like the chef provider for that service only supposed "status" and "running"
[2012-07-20 22:46:01 -0400] evilantnie: supports
[2012-07-20 22:46:05 -0400] allan_wind: http://pastebin.com/5MEAsqaB
[2012-07-20 22:46:27 -0400] allan_wind: doesn't support status but still called, and supports does list reload
[2012-07-20 22:46:41 -0400] allan_wind: and supports reload
[2012-07-20 22:47:59 -0400] allan_wind: Isn't this how you specify supports? supports :reload => true, :status => false
[2012-07-20 22:49:36 -0400] allan_wind: I recently changed the notification from restart to reload, and restart was working fine
[2012-07-20 23:20:51 -0400] erratic: I want to be remembered as a crazy person when I'm gone
[2012-07-20 23:20:59 -0400] erratic: that'll be cool
[2012-07-20 23:21:00 -0400] erratic: lol
[2012-07-20 23:24:04 -0400] yfeldblum: your handle leaves that impression
[2012-07-20 23:24:50 -0400] evilantnie: yes, very fitting
[2012-07-20 23:25:49 -0400] erratic: ty
[2012-07-20 23:31:42 -0400] tolland: I find crazy people are fairly consistent
[2012-07-20 23:32:15 -0400] flaccid: i resemble that
[2012-07-20 23:34:00 -0400] tolland: Although I dont have a large sample of data to draw on
[2012-07-20 23:34:43 -0400] tolland: today I was explaining chef to a collegue, who appears perfectly sane.
[2012-07-20 23:35:45 -0400] tolland: and he said, why do you have all these empty folders in a repository, and all the cookbooks like that. Wouldn't it be easier to make each cookbook a repo.
[2012-07-20 23:35:51 -0400] tolland: I was at a loss to reply.
[2012-07-20 23:37:32 -0400] flaccid: sometimes a cookbook is in its own repo, but the why he asked that is the why
[2012-07-20 23:38:33 -0400] erratic: tolland librarian comes to mind
[2012-07-20 23:38:49 -0400] erratic: https://github.com/applicationsonline/librarian
[2012-07-20 23:38:51 -0400] erratic: that thing
[2012-07-20 23:39:04 -0400] tolland: yep, however he is new to chef, git, ruby.
[2012-07-20 23:39:21 -0400] tolland: ill add librarian on to that list.
[2012-07-20 23:39:27 -0400] flaccid: i was going to make something called 'reheat' but now i'm thinking that librarian can do most of it
[2012-07-20 23:40:12 -0400] flaccid: http://blog.base2.io/2012/05/01/vagrants-and-chefs-and-librarians-oh-my/#.T_8XkW-p32l
[2012-07-20 23:42:17 -0400] Majost: is there an expect-like way to automatically answer command line prompts?
[2012-07-20 23:44:33 -0400] erratic: are you trying to do something via knife ssh
