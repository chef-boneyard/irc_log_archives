[2012-07-26 00:04:58 -0400] dwhsix: using application_ruby cookbook (+ passenger), suddenly on a new deploy my log files are owned by root but app seems to running as nobody, so can't write
[2012-07-26 00:05:06 -0400] dwhsix: this ring any bells for anyone?
[2012-07-26 00:06:16 -0400] dwhsix: I think I'll just deploy as root for now to get around this don't have time to fix it properly
[2012-07-26 00:32:05 -0400] karsten: dwhsix: Is it the whooshing noise they make as they fly past?
[2012-07-26 00:43:50 -0400] Majost: I am using the opscode rabbitmq cookbook in conjunction with my own cookbook...
[2012-07-26 00:44:30 -0400] Majost: If I use rabbitmq_user  to delete the guest user
[2012-07-26 00:44:42 -0400] Majost: should /etc/rabbitmq/rabbitmq.config still contain the guest user?
[2012-07-26 00:44:54 -0400] Majost: and moreover, if I add a user, should the file add a new user as well?
[2012-07-26 00:48:42 -0400] dwhsix: karsten: ha
[2012-07-26 00:48:45 -0400] dwhsix: ;-)
[2012-07-26 02:00:31 -0400] erratic: needs more dongs
[2012-07-26 02:00:48 -0400] erratic: haulghaulghaulguhu
[2012-07-26 02:13:00 -0400] erratic: https://lh6.googleusercontent.com/-s-TJcxk9k74/UASPQW-UneI/AAAAAAAACcM/WnY6luYgtUI/w497-h373/goodnight.gif
[2012-07-26 02:41:15 -0400] ssd7: Ohai Chefs
[2012-07-26 04:03:04 -0400] miah: hi
[2012-07-26 04:05:48 -0400] paulmooring: hi
[2012-07-26 04:37:31 -0400] JoeGaudet: Has anyone used the openvpn cookbook ?
[2012-07-26 05:23:29 -0400] jennD: good evening
[2012-07-26 05:36:19 -0400] jennD: I'm having some trouble with apache2 and one of my own recipes.  I'm trying to overwrite apache2:mod_proxy with my own template config, but httpd is continually being restarted, even with 'notifies' in the recipe:  http://pastebin.com/vN84nbwJ
[2012-07-26 06:54:14 -0400] jensnorr: Is there any documentation on how to migrate existing clients to omnibus?
[2012-07-26 07:16:09 -0400] WilliamHerry: I am think if it is ok to download a cookbook from opscode, change some like maintain name to me, and upload it to github
[2012-07-26 07:16:54 -0400] flaccid_: why would you do that
[2012-07-26 07:17:47 -0400] WilliamHerry: I will change that to suit our environment
[2012-07-26 07:18:02 -0400] WilliamHerry: so silly thought
[2012-07-26 07:18:16 -0400] WilliamHerry: Ok, I will leave that unchanged
[2012-07-26 07:18:19 -0400] flaccid_: you need to abide by the license. and you should fork the github repos
[2012-07-26 07:18:43 -0400] flaccid_: do enhancements via pull requests
[2012-07-26 07:18:54 -0400] flaccid_: there is a doc on the wiki about contributing
[2012-07-26 07:20:50 -0400] WilliamHerry: flaccid, Ok, thanks
[2012-07-26 07:37:10 -0400] ezotrank: Good day. I change some recipie on cookbook, how I can immediately execute this recipe on client. I just do knife cookbook upload --all then restart client
[2012-07-26 07:42:02 -0400] Guest86417: Do you know where to find some guide about how to wirte a cookbook?
[2012-07-26 07:42:08 -0400] Guest86417: Exclude the wiki
[2012-07-26 07:56:19 -0400] specialsauce: hi, does anyone know what the working directory for Chef is when its templating from erb files in a client run?
[2012-07-26 08:57:37 -0400] kesor: how can I search for nodes that have a certain attribute even if it was deep merged from role attributes?
[2012-07-26 09:35:32 -0400] ezotrank: I try execute knife search node 'role:server' -VV and all good, it's found my node, but when I execute knife ssh 'role:server' 'ls' -VV I don't find it
[2012-07-26 09:52:39 -0400] ezotrank: http://pastebin.com/WypBDSbc my solr log, first I user search, second ssh
[2012-07-26 09:52:50 -0400] railsraider: question about role usage, I have a role that has other roles inside it, but i need to assign ssh keys for instance on a general role, not the within roles say staging include an app and mysql roles but i need to query the staging role
[2012-07-26 09:53:20 -0400] railsraider: do i need to assign the role to the node with node.set[role ?
[2012-07-26 09:56:18 -0400] railsraider: i guess a simple search works
[2012-07-26 09:58:36 -0400] railsraider: arrrrghhh this returns all the nodes if i do  knife search node  "role:staging"
[2012-07-26 09:58:57 -0400] railsraider: i want to check if the node has a role staging
[2012-07-26 10:01:14 -0400] railsraider: never mind
[2012-07-26 10:56:06 -0400] masterkorp: Chef::Exceptions::Package: package[binutils-doc] (build-essential::default line 23) had an error: Chef::Exceptions::Package: binutils-doc has no candidate in the apt-cache
[2012-07-26 11:00:50 -0400] sampikesley: try a different mirror?
[2012-07-26 11:10:42 -0400] yevgenko: Hi there, does anyone (specifically cookbook maintainers) receiving comments notifications on the cookbooks? Just noticed few old comments...
[2012-07-26 11:28:12 -0400] cnf: anyone know how i can set verbose_logging in vagrant for chef?
[2012-07-26 11:56:22 -0400] maruq: hi guys
[2012-07-26 11:56:48 -0400] maruq: what's the best way to conditionally restart something on deploy?
[2012-07-26 11:57:24 -0400] maruq: eg. if deploy block checks out new code, and this server is a worker, it should restart the worker process
[2012-07-26 11:58:06 -0400] maruq: only_if do  end is more for getting a true/false from the block correct?
[2012-07-26 11:58:28 -0400] maruq: rather than if x, then y
[2012-07-26 11:58:56 -0400] maruq: can notifies be converted to a block?
[2012-07-26 12:07:03 -0400] maruq: nevermind. got the worker to subscribe to the deploy resource ;)
[2012-07-26 12:40:43 -0400] cnf: jtimberman: ima reading your blog :P
[2012-07-26 12:53:59 -0400] cnf: btw, does ruby have a styleguide? something like pythons PEP8?
[2012-07-26 12:55:34 -0400] Afterglow: i'm trying to render a variable inside angle brackets in a template like <blah> but every time I add the leading < chef-client fails to complete is there some reason I don't know about with chef templates? the erb seems valid
[2012-07-26 12:55:35 -0400] Doc_X: not really. ruby subscribes more to the 'there's more than one way to do it' philosophy
[2012-07-26 12:55:42 -0400] cnf: bah :P
[2012-07-26 13:05:22 -0400] yfeldblum: Afterglow, gist it?
[2012-07-26 13:06:29 -0400] yfeldblum: cnf, yes, some rules include using parentheses around the conditional expression of `if` and dedenting the cases in a case expression one level further to the left than the `case` keyword
[2012-07-26 13:07:42 -0400] cnf: yfeldblum: mkay.. anything structured / official / written down maybe?
[2012-07-26 13:08:44 -0400] yfeldblum: cnf, different companies have published their own style guides
[2012-07-26 13:08:58 -0400] cnf: hmm
[2012-07-26 13:09:23 -0400] cnf: is 2 spaces the defacto indent depths in the ruby world
[2012-07-26 13:09:24 -0400] cnf: ?
[2012-07-26 13:09:40 -0400] yfeldblum: cnf, you can take a look at https://github.com/bbatsov/ruby-style-guide
[2012-07-26 13:09:52 -0400] yfeldblum: cnf, for whatever that's worth
[2012-07-26 13:09:59 -0400] yfeldblum: cnf, yes, 2 spaces
[2012-07-26 13:10:10 -0400] cnf: hmm, not a big fan of that ^^;
[2012-07-26 13:10:18 -0400] cnf: but i guess my editor will do that for me
[2012-07-26 13:10:26 -0400] yfeldblum: cnf, when in rome, demand 4 spaces
[2012-07-26 13:10:35 -0400] cnf: indeed
[2012-07-26 13:10:46 -0400] cnf: and the romans seem ok with that
[2012-07-26 13:10:58 -0400] cnf: not sure about the rubies though :P
[2012-07-26 13:13:45 -0400] cnf: 2 spaces just looks wrong to me :P
[2012-07-26 13:14:35 -0400] yfeldblum: cnf, it looked wrong to me too
[2012-07-26 13:15:07 -0400] yfeldblum: cnf, coming from C, C++, Java, C#, and HTML
[2012-07-26 13:15:14 -0400] cnf: ^^;
[2012-07-26 13:15:20 -0400] cnf: i'm mostly a python guy
[2012-07-26 13:15:40 -0400] yfeldblum: cnf, banished!
[2012-07-26 13:15:43 -0400] yfeldblum: cnf, :P
[2012-07-26 13:15:44 -0400] cnf: :P
[2012-07-26 13:16:09 -0400] cnf: hey, i like the structure and clear path in python
[2012-07-26 13:16:14 -0400] yfeldblum: cnf, but i've acclimated, and now anything but 2 spaces for ruby code seems wrong
[2012-07-26 13:16:16 -0400] cnf: even if it sometimes is quite opinionated
[2012-07-26 13:16:33 -0400] cnf: yfeldblum: don't you find it hard to see your blocks?
[2012-07-26 13:16:48 -0400] yfeldblum: cnf, not really
[2012-07-26 13:17:34 -0400] cnf: must be just me then :P
[2012-07-26 13:17:56 -0400] Doc_X: 4 spaces takes up too much horizontal space, IMO
[2012-07-26 13:18:09 -0400] Doc_X: but that may just be me :-)
[2012-07-26 13:18:25 -0400] yfeldblum: cnf, i'm looking at a screen with rspec test cases and the screen has 9 blocks ... looks just fine to me
[2012-07-26 13:18:33 -0400] cnf: o,O
[2012-07-26 13:18:52 -0400] yfeldblum: cnf, 9 blocks with do ... end multiline, and 6 blocks with { } single-line
[2012-07-26 13:19:08 -0400] cnf: yeah, the end every where throws me off, as well :P
[2012-07-26 13:19:18 -0400] yfeldblum: cnf, heh
[2012-07-26 13:19:45 -0400] cnf: especially as my editor shows me matching {} and () etc
[2012-07-26 13:19:56 -0400] cnf: but not matching end whatever in ruby
[2012-07-26 13:19:59 -0400] Doc_X: yeah, i imagine having a human-readable semantic tag to indicate the end of a block must be a pseudo-foreign idea to python folks ;-)
[2012-07-26 13:20:49 -0400] yfeldblum: cnf, configure your editor to match class/module/def/do/case/if/unless/while/until to their matching end?
[2012-07-26 13:20:50 -0400] cnf: Doc_X: especially with embedded blocks...
[2012-07-26 13:21:47 -0400] cnf: yfeldblum: i might try that
[2012-07-26 13:22:00 -0400] yfeldblum: context("the model") { subject(:result) { Model.new{|m| m.attr1 = val1} } ; it { should be_valid } }
[2012-07-26 13:22:11 -0400] cnf: o,O
[2012-07-26 13:22:56 -0400] yfeldblum: cnf, unfortunately, pasting the do...end multiline version of that into irc is bad form
[2012-07-26 13:23:21 -0400] cnf: either way, i find ruby hard to parse ^^;
[2012-07-26 13:23:27 -0400] geekbri: I have yet to find a good way to match do/end begin/end if/end in Vim
[2012-07-26 13:23:32 -0400] geekbri: I miss using %
[2012-07-26 13:23:35 -0400] cnf: geekbri: indeed
[2012-07-26 13:27:31 -0400] masterkorp: Is the recipe run fails does chef delete all the templates that recipe places ?
[2012-07-26 13:27:48 -0400] masterkorp: (its failing after some templates)
[2012-07-26 13:27:51 -0400] giulianob: hey guys
[2012-07-26 13:28:19 -0400] giulianob: I'm looking for some video that shows end to end how to create and deploy some cookbook w/ attributes, etc...
[2012-07-26 13:28:29 -0400] giulianob: the wiki is kinda all over the place
[2012-07-26 13:29:05 -0400] masterkorp: giulianob: yeah chef is still missing a documentation that teaches all the concepts
[2012-07-26 13:29:19 -0400] giulianob: are there any decent videos that will give you a good walkthrough the whole process?
[2012-07-26 13:29:40 -0400] masterkorp: (i read a puppet book and apllied the knowledge to chef)
[2012-07-26 13:29:58 -0400] masterkorp: there is also the book "Test driven development with chef"
[2012-07-26 13:31:09 -0400] giulianob: The reviews on that book said it doesnt actually cover very much
[2012-07-26 13:31:41 -0400] yevgenko: Is there a command to pull dependencies for 3rd parties cookbooks? i.e. local or forked via github
[2012-07-26 13:31:52 -0400] yevgenko: or at least validate chef repo for broken deps?
[2012-07-26 13:33:24 -0400] masterkorp: giulianob: no, only more the test driven pat
[2012-07-26 13:33:28 -0400] masterkorp: and only some
[2012-07-26 13:33:44 -0400] masterkorp: yevgenko: you can use git submodules
[2012-07-26 13:34:29 -0400] giulianob: what would you recommend to get going quickly ? I've read the wiki pretty well and understand the different concepts but don't quite understand the order of doing things when creating cookbooks, new nodes, etc..
[2012-07-26 13:34:35 -0400] giulianob: any blog posts that are good?
[2012-07-26 13:35:03 -0400] yevgenko: masterkorp: yes, but what if such cookbook also has dependencies?
[2012-07-26 13:35:31 -0400] masterkorp: yevgenko: like other cookbooks
[2012-07-26 13:35:39 -0400] masterkorp: you add oter submodule
[2012-07-26 13:35:52 -0400] masterkorp: we keep opscode cookbooks on submodules
[2012-07-26 13:38:32 -0400] yevgenko: masterkorp: I'd prefer to have development as submodules, but the rest to be downloaded from community site
[2012-07-26 13:39:00 -0400] yevgenko: so, there is no command to validate chef repo for missed dependencies?
[2012-07-26 13:39:21 -0400] masterkorp: since its ruby you can check the metada depends block
[2012-07-26 13:40:25 -0400] yevgenko: yeah, rake rocks! :)
[2012-07-26 13:41:02 -0400] masterkorp: i dont like it
[2012-07-26 13:41:32 -0400] masterkorp: one thing i dont like about ruby its that complety tried to reinvent the wheel
[2012-07-26 13:41:52 -0400] masterkorp: adding their own dependencies management system and all that
[2012-07-26 13:43:24 -0400] geekbri: Do you mean bundler?
[2012-07-26 13:45:23 -0400] geekbri: Or do you mean Gems in general?  Because that's just about every language now a days.  npm, pip, cpan, gem, jar, etc etc
[2012-07-26 13:45:33 -0400] masterkorp: gems in general
[2012-07-26 13:45:40 -0400] masterkorp: bundler is even worse
[2012-07-26 13:46:06 -0400] masterkorp: that's typical invention from people that use OS without package managment
[2012-07-26 13:46:11 -0400] yevgenko: IMHO it would be nice to distribute cookbooks thru the gems
[2012-07-26 13:46:14 -0400] masterkorp: wich is lol nowadays
[2012-07-26 13:46:25 -0400] masterkorp: but offtopic
[2012-07-26 13:47:32 -0400] geekbri: I try to stay out of the argument of "should package management like that be handled by the OS or the languages packaging mechanisms"
[2012-07-26 13:48:02 -0400] geekbri: I do think that that is not a problem exclusive to ruby though.  Almost every language today suffers from that affliction.
[2012-07-26 13:48:35 -0400] specialsauce: god i hate schemes like cpana nd gems
[2012-07-26 13:51:03 -0400] cpasmoi: I have a running chef server with its own home made cookbooks. Here, I call recipe[mysql::native] in a Json file but it seems like attributes set in mysql/attributes/default are not setted, how come ?
[2012-07-26 13:51:08 -0400] yfeldblum: specialsauce, why?
[2012-07-26 13:51:30 -0400] cpasmoi: I also have a recipe/default.rb but don't want to execute this one
[2012-07-26 13:52:49 -0400] yfeldblum: geekbri, affliction?
[2012-07-26 13:53:04 -0400] geekbri: yfeldblum: strong word.  feel free to sub with a less offensive one
[2012-07-26 13:53:27 -0400] yfeldblum: geekbri, Almost every language today shares the same approach
[2012-07-26 13:53:40 -0400] masterkorp: geekbri: its basic KISS philosophy
[2012-07-26 13:53:43 -0400] geekbri: yfeldblum:  I don't have an issue with gems/pips/modules/whatever the next language will call them
[2012-07-26 13:54:48 -0400] yfeldblum: geekbri, indeed my question would be: does it not tell us something that every language out there has its own module and module-distribution systems?
[2012-07-26 13:55:04 -0400] geekbri: yfeldblum: Oh yes, It tells us something indeed.  IT tells us many things :)
[2012-07-26 13:55:29 -0400] geekbri: Not the least of which is that sometimes people want a unified package structure across multiple different platforms
[2012-07-26 13:55:48 -0400] yfeldblum: geekbri, but not any of the people who write software in any of these languages ;P
[2012-07-26 13:56:19 -0400] geekbri: All I know is, building .debs is a pain in the butt for real.  Thank god for fpm.
[2012-07-26 13:56:25 -0400] lysander: My chef-client daemon has taken 4GB of memory and now every run it says it is out of memory.
[2012-07-26 13:56:28 -0400] lysander: ruby 1.8 (:
[2012-07-26 13:56:30 -0400] geekbri: I wil exist the conversation about this at this point ;)
[2012-07-26 13:57:03 -0400] cpasmoi: In fact, my problem is on the above line : "template node[:mysql][:path_conf] + 'my.cnf' do" which creates an exception "native.rb:45:in `from_file': undefined method `+' for nil:NilClass (NoMethodError)"
[2012-07-26 13:57:26 -0400] geekbri: cpasmoi: seems to me that the attribute isn't set. :)
[2012-07-26 13:57:32 -0400] cpasmoi: that's why I think the mysql path_conf is not well setted
[2012-07-26 13:57:38 -0400] cpasmoi: indeed :)
[2012-07-26 13:58:08 -0400] cpasmoi: so I'm wondering why, in fact, as it is setted on mysql/attributes/default.rb
[2012-07-26 13:58:33 -0400] cpasmoi: I don't know how to explicitly ask to "source" this file in my json Role
[2012-07-26 13:58:50 -0400] cpasmoi: (which has de recipe[mysql::native]as I said)
[2012-07-26 13:59:02 -0400] cpasmoi: I thougt it would be "sourced" by default
[2012-07-26 13:59:55 -0400] cpasmoi: I kown chef for about a week and I'm reading the wiki but I don't see... any idea ?
[2012-07-26 14:04:19 -0400] yfeldblum: cpasmoi, how are you setting the default attributes?
[2012-07-26 14:07:39 -0400] specialsauce: yfeldblum, i don't like system like gems because it means effectively that every single system has to support package installation via 10 or more methods rather than 1
[2012-07-26 14:08:06 -0400] cpasmoi: yfeldblum, in the mysql (home made) cookbook, directory attributes, file default.rb ; case platform when "centos" oh, wait...
[2012-07-26 14:08:24 -0400] specialsauce: In a corporate environment where you often don't have internet access on hosts, this means you have to maintain 10 different language repositories in an ops team locally
[2012-07-26 14:08:31 -0400] cpasmoi: I've just seen a if platform_version[0,1] == "6" without the set path...
[2012-07-26 14:08:44 -0400] specialsauce: and put unnecessary tooling on each host to support it
[2012-07-26 14:13:34 -0400] cpasmoi: ok, sorry for that, the autor of default.rb has forgotten some conditionnal stuff :p
[2012-07-26 14:15:00 -0400] cpasmoi: seems like i've experienced the rubber duck debugging method \o/
[2012-07-26 14:19:43 -0400] cnf: specialsauce: that is what proxies are for
[2012-07-26 14:20:49 -0400] specialsauce: cnf: that still overhead and doesn't cover the overhead and implications of having to have tooling on every host to support 1000 different language package management tools. its horrible.
[2012-07-26 14:21:02 -0400] freerobby: yfeldblum: Can I ask you one more best practice question if you have a moment? I'm writing an open source cookbook that will need different java_options configs for staging vs production. I like your databag-to-cookbook method of configuring things because it allows the roles to be the same in production and staging. However, this will be an open source cookbook, and the Chef convention seems to be to specify all config attributes like t
[2012-07-26 14:21:10 -0400] cnf: specialsauce: so only use things in C
[2012-07-26 14:21:16 -0400] cnf: specialsauce: which chef isn't
[2012-07-26 14:23:22 -0400] cnf: specialsauce: with that attitude, you can't use a single interpreted language
[2012-07-26 14:23:45 -0400] ishtanzar: hi everyone
[2012-07-26 14:23:47 -0400] geekbri: Overhead is why they pay me! :)
[2012-07-26 14:23:52 -0400] cnf: geekbri: :P
[2012-07-26 14:24:24 -0400] specialsauce: cnf: what are you talking about, there's a difference between having to install the interpreter or whatever and having to install a pacakge management system on top of that which makes a load of assumptions and requirements of the system
[2012-07-26 14:24:51 -0400] specialsauce: i don't even think there should continue to be multiple OS level package management systems, let alone one per language
[2012-07-26 14:24:53 -0400] cnf: euhm, most languages come with their package management systems included
[2012-07-26 14:25:08 -0400] cnf: and if you are installing the interpreter, you can just as easy install its package manager
[2012-07-26 14:26:02 -0400] cnf: and you can always forgo the gem/pip/... stuff, and just bundle your packages
[2012-07-26 14:26:10 -0400] yfeldblum: specialsauce, from your perspective, that may be understandable; but it seems that most people who write programming languages or who write software in programming languages may not agree with you (judging by the prevalence of language-specific package systems)
[2012-07-26 14:26:13 -0400] cnf: virtual envs ftw!
[2012-07-26 14:26:20 -0400] ishtanzar: do you think it is possible for a chef server with a static IP to handle chef nodes with dynamic IPs without using the hostname ? like if the nodes were declaring themselves to the server ?
[2012-07-26 14:26:41 -0400] specialsauce: yfeldblum, that's kind of my point, this is throwing things over the fence
[2012-07-26 14:26:43 -0400] cnf: i hate system package managers that get involved with my ruby/python deps
[2012-07-26 14:26:49 -0400] specialsauce: per-language package mgmt suits devs, not ops
[2012-07-26 14:26:54 -0400] specialsauce: fine, but doesn't mean i have to like it
[2012-07-26 14:26:58 -0400] cnf: specialsauce: bull, i'm an op
[2012-07-26 14:27:29 -0400] specialsauce: cnf: what are you arguing here exactly? Are you saying you know better than me which i find more irritating?
[2012-07-26 14:28:00 -0400] yfeldblum: freerobby, two good approaches: 1) the recipe looks at node attributes (prefixed of course with the cookbook and possibly recipe names!)
[2012-07-26 14:28:13 -0400] cnf: no, i'm saying just because you find it irritating, doesn't mean it's what everyone else wants
[2012-07-26 14:28:22 -0400] cnf: be irritated all you want :P
[2012-07-26 14:28:38 -0400] yfeldblum: freerobby, 2) there is no recipe, only a definition or a resource/provider pair, which may be invoked by another cookbook, which is responsible for setting the options
[2012-07-26 14:29:31 -0400] freerobby: yfeldblum: If I go with approach 1, is there any convenient way to have different values for staging/production without making them separate roles?
[2012-07-26 14:29:32 -0400] yfeldblum: specialsauce, i dare say that without them, you wouldn't have to deploy software, because no-one could have written the software to be deployed
[2012-07-26 14:29:52 -0400] freerobby: yfeldblum: I would love to get to case 2 some day, but would require a major refactoring and this cookbook is already a behemoth
[2012-07-26 14:30:25 -0400] yfeldblum: freerobby, you typically do not want to do "staging" and "production" in cookbooks; you typically want multiple independent options, and it's up to the person using it to set those options according to whether they want staging, production, or some strange mix
[2012-07-26 14:30:53 -0400] specialsauce: 1996: you built software from source, or converted the source to OS pkg mgmt if you wanted to put it in a repo. 2012: you have to deal with hundreds of different pkg mgmt systems to build one host. I find it a step backwards in my personal experience. Lets leave it at that.
[2012-07-26 14:32:14 -0400] yfeldblum: freerobby, you may elect to have defaults that are ideal for production use-cases, but also to have the flexibility for the person using your cookbook to adjust X Y and Z as they see fit
[2012-07-26 14:32:16 -0400] cnf: so build your own rpms or pkgs
[2012-07-26 14:32:29 -0400] freerobby: yfeldblum: Right, that's what I mean. I'd like to be clever about setting different options for staging/production, but I'd like it to not be in the roles or cookbooks.
[2012-07-26 14:32:49 -0400] freerobby: yfeldblum: For instance, if we run staging on small  instances, we need to reduce our memory configs when we start the JVM.
[2012-07-26 14:33:04 -0400] cnf: specialsauce: or distribute your apps with all modules included (in an rpm or dpkg if you want)
[2012-07-26 14:33:39 -0400] cnf: freerobby: http://wiki.opscode.com/display/chef/Environments ?
[2012-07-26 14:33:39 -0400] freerobby: yfeldblum: My question on some level might boil down to when one would use a role to configure a cookbook vs when they should use a databag.
[2012-07-26 14:34:09 -0400] freerobby: cnf: Yeah, thanks. I've unfortunately found the Chef environments implementation not suitable for proper isolation.
[2012-07-26 14:34:44 -0400] freerobby: obviously encrypted data bags fit a separate use case, but it's not always clear to me where the line is for non-encrypted stuff.
[2012-07-26 14:34:54 -0400] yfeldblum: freerobby, looking at data-bag items requires a lot of machinery to get it right; looking at node attributes is simpler (which can have defaults and which can easily be adjusted by the user's own top-level cookbook or role)
[2012-07-26 14:35:36 -0400] freerobby: yfeldblum: So would you say "use roles unless there's a need for data bags" is a good philosophy?
[2012-07-26 14:35:36 -0400] yfeldblum: freerobby, data-bag items are for any data that is in fact data (not code) and that is not about a particular node
[2012-07-26 14:36:18 -0400] cnf: yeah, i lack a somewhat more private data storage system in chef :P
[2012-07-26 14:36:29 -0400] yfeldblum: freerobby, i would say, "use roles when roles are appropriate; use data-bags when data-bags are appropriate; use your best judgment always and seek advice whenever you need more insight"
[2012-07-26 14:38:08 -0400] cnf: freerobby: if i may, what was it about envs that didn't work for you?
[2012-07-26 14:38:23 -0400] yfeldblum: cnf, set up your own mongo/cassandra/riak/couchdb/swift/postgres cluster for additional CM data?
[2012-07-26 14:38:30 -0400] geekbri: The limitation with encrypted data bag stuff is that the key for it has to exist on the server that wants to be able to read the entries.
[2012-07-26 14:38:33 -0400] freerobby: yfeldblum: It seems like the most DRY approach would be for roles to have access to data bags at time of upload to set node attributes. Otherwise it feels like I'd be creating the same data bag over and over for each cookbook that requires the same data.
[2012-07-26 14:38:53 -0400] cnf: geekbri: indeed
[2012-07-26 14:38:56 -0400] yfeldblum: freerobby, that's seems tome like the wrong approach
[2012-07-26 14:39:01 -0400] cnf: yfeldblum: meh, that doesn't solve a lot
[2012-07-26 14:39:39 -0400] cnf: freerobby: you can access any databag from any cookbook, on any node?
[2012-07-26 14:39:41 -0400] freerobby: cnf: My biggest concern was that Chef environments are not isolated at the server level. So if for example a cookbook executes a bad search in one environment, it could return nodes in another.
[2012-07-26 14:39:52 -0400] geekbri: Honestly what you are willing to put in an encrypted data bag really depends on what you are trying to protect that information against :)
[2012-07-26 14:40:04 -0400] cnf: freerobby: a bad search?
[2012-07-26 14:40:24 -0400] yfeldblum: freerobby, a data-bag item can, e.g., have {"id": "some-riak-cluster", "search": {"role": "riak-cluster-a1"}}
[2012-07-26 14:40:30 -0400] cnf: geekbri: i find encrypted database not so secret
[2012-07-26 14:40:31 -0400] freerobby: cnf: Yes, but it encourages specialized vs general case cookbooks.
[2012-07-26 14:40:42 -0400] cnf: geekbri: because your key is spread out all over, anyway, and one key unlocks everything
[2012-07-26 14:41:07 -0400] cnf: freerobby: you can just do if env dev, use databag foo dev_port
[2012-07-26 14:41:09 -0400] cnf: for example
[2012-07-26 14:41:11 -0400] freerobby: cnf: Imagine this cookbook https://github.com/opscode-cookbooks/haproxy/blob/master/recipes/app_lb.rb left out the "AND chef_environment" clause.
[2012-07-26 14:41:17 -0400] yfeldblum: freerobby, the role "riak-cluster-a1" can have a run-list for the "riak" cookbook, which searches for any data-bag items of the right type where the search conditions listed in the data-bag item match the current node
[2012-07-26 14:41:35 -0400] geekbri: cnf: they are secret in the sense that, that key is protected by unix permissions :)
[2012-07-26 14:41:40 -0400] cnf: freerobby: well, imagine a recipe that says rm -rf /
[2012-07-26 14:41:51 -0400] freerobby: yfeldblum: Yeah, that's a good workaround.
[2012-07-26 14:41:57 -0400] yfeldblum: freerobby, search("services", "search_role:'riak-cluster-a1'")
[2012-07-26 14:42:03 -0400] cnf: geekbri: but a compromise on any machine results in ALL "secret" data leaking
[2012-07-26 14:42:08 -0400] yfeldblum: freerobby, it's not a workaround
[2012-07-26 14:42:10 -0400] freerobby: cnf: Right, but if you are careful and only run it in staging first, rm -rf / wouldn't do any damage to production.
[2012-07-26 14:42:13 -0400] geekbri: cnf: correct.
[2012-07-26 14:42:45 -0400] geekbri: cnf: in my experience it seems the encryption is more for protecting your data from say... opscode if you are using hosted chef :)
[2012-07-26 14:42:50 -0400] yfeldblum: freerobby, it's one way to structure software that relies on data in a database
[2012-07-26 14:42:56 -0400] cnf: freerobby: so only use envs to override stuff?
[2012-07-26 14:43:01 -0400] freerobby: cnf: I also find the version-bumping and freezing to be a very heavyhanded approach towards development. I just find it easier to develop and test against separate organizations/chef servers
[2012-07-26 14:43:05 -0400] cnf: geekbri: yeah, hence the meh :P
[2012-07-26 14:43:27 -0400] cnf: freerobby: right. that's a valid way of doing it :P
[2012-07-26 14:44:09 -0400] freerobby: yfeldblum: I'm looking for a simpler example I can show you to get at the heart of the ambiguity I see.
[2012-07-26 14:44:10 -0400] yfeldblum: cnf, chef environments work in a certain way, mostly as "metaroles" that are allowed to have extra constraints, but not as isolation units
[2012-07-26 14:44:13 -0400] cnf: geekbri: really, though, what is secret on your hosts? generally just passwords
[2012-07-26 14:44:22 -0400] cnf: yfeldblum: uhu
[2012-07-26 14:44:50 -0400] freerobby: cnf: Here we go. For our load balancer cookbook, we have an option called "lock_apps" which will enforce http basic auth before our app servers get hit.
[2012-07-26 14:45:01 -0400] freerobby: I made it a data bag item like this:
[2012-07-26 14:45:02 -0400] freerobby: {
[2012-07-26 14:45:03 -0400] freerobby:   "id": "options",
[2012-07-26 14:45:03 -0400] freerobby:   "lock_apps": false
[2012-07-26 14:45:03 -0400] freerobby: }
[2012-07-26 14:45:08 -0400] freerobby: err yfeldblum not cnf
[2012-07-26 14:45:16 -0400] cnf: geekbri: i'm thinking of just pre-hashing those
[2012-07-26 14:45:28 -0400] freerobby: I did that so that we could just have different data bags for our staging and production organization
[2012-07-26 14:45:29 -0400] cnf: geekbri: well, where possible, of course
[2012-07-26 14:45:38 -0400] freerobby: But if not for that need, I probably would have made it a role attribute instead.
[2012-07-26 14:45:44 -0400] freerobby: Is that a poor design decision on my part?
[2012-07-26 14:46:05 -0400] cnf: freerobby: you know roles can include other roles?
[2012-07-26 14:46:38 -0400] freerobby: cnf: Yeah, the other solution I thought of was to have every staging box have a staging role and every production box have a production role
[2012-07-26 14:46:56 -0400] cnf: freerobby: so you can have a role["balancer'] and a role["dev-balancer"] that sets  "lock_apps": false and uses role["balancer"]
[2012-07-26 14:46:56 -0400] geekbri: freerobby: we have base roles per environment
[2012-07-26 14:47:03 -0400] yfeldblum: freerobby, if staging and production are cross-cutting, they may be useful as environments
[2012-07-26 14:47:13 -0400] geekbri: freerobby: we have a "base" roll that all servers get, then we also have base_production, base_qa, base_staging, etc etc
[2012-07-26 14:47:14 -0400] freerobby: cnf: geekbri: interesting.
[2012-07-26 14:47:30 -0400] geekbri: freerobby: I'm not going to sit here and preach about how it is something everybody should do, but it certainly has served us pretty well
[2012-07-26 14:47:43 -0400] geekbri: I'm not sure even we should be doing it, but so far so good
[2012-07-26 14:47:50 -0400] freerobby: geekbri: Didn't take it as preaching, I'm genuinely curious about the patterns available. That's helpful.
[2012-07-26 14:48:01 -0400] cnf: also, environments can have attributes as well
[2012-07-26 14:48:30 -0400] geekbri: yar
[2012-07-26 14:48:39 -0400] geekbri: 'tis true
[2012-07-26 14:48:47 -0400] freerobby: So maybe the right answer for us is to use environments, but also run them on separate organizations to be safe.
[2012-07-26 14:48:52 -0400] cnf: freerobby: i generally think as staging and dev "be as much as live, just define the few exceptions"
[2012-07-26 14:49:12 -0400] freerobby: I just love the comfort of being able to run a new coookbook without vetting it first, and knowing that I can mess around and have no possibility of touching a production box.
[2012-07-26 14:49:53 -0400] geekbri: the reason we use roles for the environments as well is incase we want to specify something that should be happening on all servers in an environment that you can't do in the environments themselves (like say another role).  Although you could just combine knife search and knife node run_list to do that.
[2012-07-26 14:49:55 -0400] cnf: freerobby: yeah, for developing cookbooks, it might be a good idea to use a different organisation
[2012-07-26 14:50:18 -0400] geekbri: Vagrant is nice for that as well
[2012-07-26 14:50:24 -0400] cnf: freerobby: for developing the rest, i'd just use the same one
[2012-07-26 14:50:25 -0400] cnf: geekbri: indeed
[2012-07-26 14:51:13 -0400] cnf: freerobby: but yeah, cookbook dev > different org, and vagrant
[2012-07-26 14:51:31 -0400] xerxas: Hi all
[2012-07-26 14:52:36 -0400] freerobby: cnf: Yeah, I'm a big vagrant fan. Unfortunately a lot of my development these days involves circumnavigating EC2 oddities, which is difficult to virtualize
[2012-07-26 14:52:43 -0400] freerobby: Well, impossible not to virtualize really, but you know what i mean.
[2012-07-26 14:52:56 -0400] xerxas: is opscode merging PRs on opscode-cookbooks ?
[2012-07-26 14:53:04 -0400] cnf: well, you can launch ec2 instances just as easy as vagrant ones, no?
[2012-07-26 14:53:12 -0400] xerxas: is it worth to create my PR on varnish cookbook ? will it be merged if it's ok ?
[2012-07-26 14:53:58 -0400] knuckolls: xerxas: many of my pull requests for rabbitmq got merged
[2012-07-26 14:54:05 -0400] knuckolls: but it was awhile before it caught opscode's attention
[2012-07-26 14:54:35 -0400] knuckolls: you will need to go through the contributor agreement and make a jira ticket for your change to fit into their process
[2012-07-26 14:54:53 -0400] cnf: uhu
[2012-07-26 14:54:58 -0400] cnf: i signed it already
[2012-07-26 14:55:01 -0400] cnf: get it done :P
[2012-07-26 14:55:22 -0400] knuckolls: my opinion is send the pull requests regardless because i want to see what you fixed in varnish because i'm about to start using it ;)
[2012-07-26 15:03:43 -0400] xerxas: knuckolls:  I'm already a contributor
[2012-07-26 15:04:13 -0400] paulmooring: xerxas: In that case just open a Jira ticket and send the pull request
[2012-07-26 15:04:21 -0400] xerxas: knuckolls: so will do the PR, and will open a jira ticket
[2012-07-26 15:04:28 -0400] xerxas: paulmooring, knuckolls  : thx
[2012-07-26 15:04:42 -0400] geekbri: You have to resolve your jira ticket not just create it :)
[2012-07-26 15:04:43 -0400] paulmooring: xerxas: Thank you for contributing
[2012-07-26 15:04:54 -0400] xerxas: paulmooring: you're welcome ;)
[2012-07-26 15:04:57 -0400] geekbri: I mean, that is assuming you actually resolved it, then link to the pull request (and link from the pull request to the ticket as well)
[2012-07-26 15:05:00 -0400] geekbri: or at least I always do both.
[2012-07-26 15:05:03 -0400] xerxas: not to big things, and I need them ;)
[2012-07-26 15:05:06 -0400] xerxas: too
[2012-07-26 15:08:34 -0400] tubbo: hey guys i'm getting this strange error: "[2012-07-26T15:07:59+00:00] FATAL: Chef::Exceptions::Package: package[git] (system::default line 9) had an error: Chef::Exceptions::Package: git has no candidate in the apt-cache"
[2012-07-26 15:08:48 -0400] tubbo: however, git is installed...and i see it in apt-get
[2012-07-26 15:11:43 -0400] paulmooring: tubbo: what distro?
[2012-07-26 15:14:06 -0400] tubbo: paulmooring: Ubuntu 10.04.2 LTS
[2012-07-26 15:14:47 -0400] paulmooring: the pkg name on Ubuntu looks to be git-core
[2012-07-26 15:15:16 -0400] paulmooring: you can run `dpkg -l|grep "git"` to see the name of the install package
[2012-07-26 15:15:44 -0400] cnf: hey the seagate 3x10^12 disks are reasonably priced!
[2012-07-26 15:17:40 -0400] tubbo: paulmooring: ok
[2012-07-26 15:20:02 -0400] tubbo: paulmooring: lol that fixed it...thanks buddy!
[2012-07-26 15:20:09 -0400] paulmooring: np
[2012-07-26 15:20:13 -0400] tubbo: i'm sure i'll have more stupid questions for you guys. chef rules!
[2012-07-26 15:39:04 -0400] jtimberman: knuckolls: its not that we weren't aware, we just weren't caught up :)
[2012-07-26 15:42:09 -0400] valachi: Hi guys. First time using chef, i need some help from you :) i've written my own rvm install cookbook - https://gist.github.com/3182789. But i have troubles setting default ruby and installing rubygems - https://gist.github.com/3182771 . Any help would be appreciated =)
[2012-07-26 15:50:04 -0400] hikeit: hey all you awesome chefs, i'm having a couch problem
[2012-07-26 15:50:26 -0400] hikeit: this is probably the wrong place, someone should tell me to a) go to #couchsucks or b) buy hosted chef
[2012-07-26 15:50:28 -0400] anthroprose: val: Ruby is already installed for chef to run
[2012-07-26 15:50:29 -0400] hikeit: but...
[2012-07-26 15:50:39 -0400] anthroprose: hik: hosted chef yes
[2012-07-26 15:50:41 -0400] anthroprose: hehe
[2012-07-26 15:50:45 -0400] anthroprose: or wait for the new version
[2012-07-26 15:50:48 -0400] hikeit: couchdb is falling over with no errors in the middle of the day with no errors or warnings
[2012-07-26 15:50:52 -0400] anthroprose: mysql instead of couch...
[2012-07-26 15:51:47 -0400] valachi: Could anyone help me? Hi guys. First time using chef, i need some help from you :) i've written my own rvm install cookbook - https://gist.github.com/3182789. But i have troubles setting  the default ruby and installing rubygems - https://gist.github.com/3182771 . Any help would be appreciated =)
[2012-07-26 15:52:01 -0400] anthroprose: valachi: essentially your swapping out the software running chef, while chef is running....
[2012-07-26 15:53:26 -0400] anthroprose: (but then again I've never messed with gems itself from inside a recipe... just adding packaged gems..)
[2012-07-26 15:54:23 -0400] anthroprose: If I do something like 'package('rubygems')' I get MAD glibc errors
[2012-07-26 15:54:46 -0400] valachi: so u suggest not to install rubygems like that?
[2012-07-26 15:55:22 -0400] anthroprose: valachi: in my limited empirical experience, it has caused problems...
[2012-07-26 15:55:24 -0400] behemphi: All, if I issue knife ssh "role:magnet-host" 'uptime' it _should_ return 43 results.  But, instead I am getting a network timeout error for all machines.   Any idea why this would be the case.  The problem seems to occur for sets of machines above 10 in size or so
[2012-07-26 15:55:37 -0400] behemphi: I has been happening for about a month or so.
[2012-07-26 15:55:42 -0400] hikeit: anthroprose: have you seen this sort of thing (couchdb falling over) before (or seen people complain about it before)?
[2012-07-26 15:55:58 -0400] anthroprose: hikeit: personally never seen it, just hear people complain
[2012-07-26 15:56:07 -0400] anthroprose: I no nothing of couchDB admin :(
[2012-07-26 15:56:22 -0400] valachi: sure i can just run rvm rubygems current, but what i need chef for then? and the same issue with rvm --default use 1.9.3
[2012-07-26 15:56:34 -0400] valachi: sorry if my english is not well enough
[2012-07-26 15:56:57 -0400] geekbri: valachi: have you tried fnichols rvm cookbook, its pretty good
[2012-07-26 15:57:25 -0400] anthroprose: geekbri: i was about to suggest looking for something else
[2012-07-26 15:57:30 -0400] anthroprose: I figure its an order of operations thing..
[2012-07-26 15:57:50 -0400] geekbri: valachi, anthroprose: https://github.com/fnichol/chef-rvm
[2012-07-26 15:58:10 -0400] anthroprose: I ran into it and didnt have time to solve.... so I just went around it with a bash cmd instead of using builtin chef functions :(
[2012-07-26 15:58:13 -0400] geekbri: I suggest using a tagger version instead of HEAD :)
[2012-07-26 15:58:56 -0400] anthroprose: valachi: notice he uses chef's builtin package management to do the rvm install
[2012-07-26 15:59:02 -0400] anthroprose: instead of chef -> bash -> chef
[2012-07-26 15:59:10 -0400] anthroprose: usually things like that dont work out so well
[2012-07-26 15:59:37 -0400] anthroprose: gem_package 'rvm' do action :nothing end.run_action(:install) ....
[2012-07-26 16:01:40 -0400] marcos: hi
[2012-07-26 16:02:07 -0400] valachi: yes, i know about fnichol rvm cookbooks, i just wanted to learn chef writting my own cookbook :)
[2012-07-26 16:02:19 -0400] geekbri: Ahhhh, sorry :) My mistake.  In that case write away.
[2012-07-26 16:04:32 -0400] valachi: so i have to look at how fnichol manage his installation and try ti understand it... cause that `gem_package 'rvm' do action :nothing end.run_action(:install)` look weird =) thanks, guys =)
[2012-07-26 16:17:27 -0400] j|: Is there a decent cookbook for "dumb" package installation(s). Basically just search a data bag for a list of packages and then install them. No File(s), Templates or attribute setting(s) needed. ?
[2012-07-26 16:17:56 -0400] j|: I could just list the resources, but databag search seems cleaner.
[2012-07-26 16:18:10 -0400] j|: if not, guess I'll just write it, but thought I'd ask.
[2012-07-26 16:18:43 -0400] qhartman: not that I'm aware of. It seems it would be simple enough to write something that just has your package list as an array and then iterate over it with the package resource
[2012-07-26 16:19:05 -0400] j|: Yea, I don't want an array. I'd rather have a databag
[2012-07-26 16:19:09 -0400] qhartman: about a 5 line recipe
[2012-07-26 16:19:14 -0400] qhartman: if you like
[2012-07-26 16:19:16 -0400] j|: I want to be able to search it w/ knife later.
[2012-07-26 16:20:10 -0400] j|: yea, it sounds simple enough, but I just thought I'd ask before running off and doing it that way when someone else has already done something way better somehow.
[2012-07-26 16:20:29 -0400] qhartman: but yeah, either way, I'm not aware of anything like that that exists. If a search of the opsode cookbook repo didn't turn up anything, it's probably not out there in any meaningful way
[2012-07-26 16:20:47 -0400] sampikesley: sounds like a bloody good idea, though
[2012-07-26 16:38:22 -0400] erratic: morning chefs
[2012-07-26 16:38:38 -0400] miah: moin
[2012-07-26 16:47:17 -0400] Insane: hello all, I have a n00b question
[2012-07-26 16:47:43 -0400] Insane: is there a guide/walkthrough/screencast for using Chef to deploy OpenStack Essex with the opscode cookbooks?  https://github.com/opscode/openstack-chef-repo/tree/essex
[2012-07-26 16:49:17 -0400] EJC: hi all - I'm having a slight issue with chef not transferring over file resources as part of a cookbook - the only error message I'm seeing is that the missing file is not found :-/
[2012-07-26 16:51:41 -0400] EJC: are there any known issues with chef 10.12.0 having problems xferring file artifacts?
[2012-07-26 16:52:26 -0400] anthroprose: EJC: hows that going for you? I stuck everything in a repo instead of passing them around...
[2012-07-26 16:53:17 -0400] EJC: prior to this error, just fine - I'm really confused as to why this is happening - on another machine - same version of ubuntu, this works just fine :-/
[2012-07-26 16:53:49 -0400] anthroprose: hosted or private chef?
[2012-07-26 16:54:00 -0400] EJC: private
[2012-07-26 16:54:00 -0400] anthroprose: I've had random permissions issues before related to client/group settings
[2012-07-26 16:54:15 -0400] anthroprose: that causes HTTP deny/errors
[2012-07-26 16:54:28 -0400] anthroprose: which may be why it works on one client but not the other..
[2012-07-26 16:55:13 -0400] EJC: hello thar cheeseplus... ;-)
[2012-07-26 16:55:49 -0400] EJC: hmmmmmm  - where did you see the deny errors - I'm running in max verbose and it's xferring over the recipe files, just not the actual file artifacts....
[2012-07-26 16:56:48 -0400] anthroprose: EJC: Saw it directly in output... although I had debug turned on
[2012-07-26 16:56:52 -0400] anthroprose: as well as verbose_logging
[2012-07-26 16:57:44 -0400] EJC: I think I may see my problem.....
[2012-07-26 16:57:45 -0400] anthroprose: log_level :debug\nlog_location STDOUT\nverbose_logging true
[2012-07-26 17:00:38 -0400] EJC: I'm using knife to bootstrap this particular machine - where are you thinking I'd add that - knife.rb?
[2012-07-26 17:02:38 -0400] anthroprose: EJC: it has to go in the client config :(
[2012-07-26 17:02:55 -0400] anthroprose: at least I havn't figured out how to do 'remote' debug from the knife client
[2012-07-26 17:25:55 -0400] John518: If you use knife-server, does the knife-server command require apache running on my ubuntu server that will become the chef server?
[2012-07-26 17:26:02 -0400] John518: requires*
[2012-07-26 17:30:31 -0400] John518: because I already have nginx running, but it looks like, based on source code, it needs apache2 to do SSL traffic.
[2012-07-26 17:30:39 -0400] John518: ## Configure Apache2 to proxy SSL traffic, using chef-solo
[2012-07-26 17:36:11 -0400] John518: anyone?
[2012-07-26 17:38:06 -0400] Insane: John518, not sure what knife-server is, but I think you're talking about using a reverse proxy for chef-server
[2012-07-26 17:38:47 -0400] j|: you talking about Knife::Server knife plugin?
[2012-07-26 17:38:54 -0400] John518: Thanks Insane. This is knife-server that I was talking about. I thought people recommend using this: https://github.com/fnichol/knife-server
[2012-07-26 17:40:30 -0400] John518: I was on the mailinglistand someone asked "the quickest way to deploy a chef server" is using knife-server. maybe i am wrong
[2012-07-26 17:46:50 -0400] John518: I believe by default chef-solo uses apache.
[2012-07-26 17:49:27 -0400] Zenigor: Whenever I try to spin up a new rackspace server, I am getting the following error in my logs when it gets to running chef-client: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
[2012-07-26 17:51:12 -0400] barefoot: what about the errors before+after? what does the stracktrace say?
[2012-07-26 17:54:03 -0400] Zenigor: crap, going to have to spin up a new server to get the stacktrace. counterpart destroyed the VM while I was on lunch
[2012-07-26 18:03:55 -0400] dpetzel: Im trying for the first time to use vagrant and the chef_client provisioner. When it goes to register I the new client I get FATAL: Chef::Exceptions::CannotWritePrivateKey: The response from the server did not include a private key!. Debug logging shows  DEBUG: Registration response: {"MY-validator"=>"https://my.madeupserver.nil/organizations/MY/clients/MY-validator"}. Anyone know where I should look next
[2012-07-26 18:11:21 -0400] jackery: I want to bind my base role to an uneditable environment like _default. Anyone know how to hack this in? Is there a better way to accomplish what attempting?
[2012-07-26 18:13:51 -0400] Insane: mattray: on Tuesday you mentioned an openstack quickstart that might work for 3 people.  Do you have an ETA or a link?
[2012-07-26 18:14:16 -0400] mattray: Insane: hopefully in the next 2 weeks
[2012-07-26 18:14:22 -0400] mattray: Insane: working on it now
[2012-07-26 18:14:29 -0400] mattray: well, on the cookbooks that would use it
[2012-07-26 18:14:56 -0400] Insane: Awesome!
[2012-07-26 18:21:12 -0400] Zenigor: barefoot: here is the stacktrace https://gist.github.com/3183625
[2012-07-26 18:22:16 -0400] barefoot: Zenigor: in the actual output, does it say anything useful above or below the error? like client.pem missing?
[2012-07-26 18:23:05 -0400] Zenigor: barefoot: [2012-07-26T13:19:18-05:00] INFO: Client key /etc/chef/client.pem is not present - registering then it goes into the run list and expanding it. finally starts chef run then gives the merb error
[2012-07-26 18:24:32 -0400] rabidpraxis: If I use the execute resource with and include some environment variables, it seems to set the user and group to root, even if the user and group are set in the resource.
[2012-07-26 18:29:56 -0400] barefoot: Zenigor: does debug give you any further info?
[2012-07-26 18:48:09 -0400] tolland: i have a cookbook that I am going to have to do quite a lot of change/upload/test
[2012-07-26 18:48:14 -0400] tolland: on one recipe
[2012-07-26 18:48:23 -0400] tolland: whats the quickest way to do that cycle?
[2012-07-26 18:48:54 -0400] tolland: in shef, and cause it to pull the new cookbook,
[2012-07-26 18:49:12 -0400] tolland: or maybe in situ on some instance (so I don't need to upload it?)
[2012-07-26 18:49:23 -0400] tolland: it includes searches, so I need to run it in client context
[2012-07-26 18:56:26 -0400] ackz: quick question.. if I set a user, group, and environment in deploy_revision, will those be applied to, say, an execute resource under before_restart?
[2012-07-26 18:56:57 -0400] ackz: trying to dry my deploy recipe out a bit
[2012-07-26 19:07:17 -0400] Zenigor: barefoot: sorry to get back to you so late, its something to do with my chef environment
[2012-07-26 19:09:39 -0400] freerobby: Does anybody know if the java cookbook is supposed to be responsible for creating the /usr/lib/jvm/default-java directory? I'm running into an issue on ubuntu12, but the conditional logic in the cookbook makes it unclear to me what the OS expectation is regarding the existence of that symlink.
[2012-07-26 19:10:28 -0400] freerobby: The if-block at line 45 seems to imply that ubuntu automatically generates it https://github.com/opscode-cookbooks/java/blob/master/recipes/openjdk.rb  but my experience shows otherwise.
[2012-07-26 19:14:15 -0400] ackz: freerobby: I think I ran into an issue with than on ubuntu 12, too
[2012-07-26 19:15:02 -0400] freerobby: ackz: What's strange is it did not used to happen, and I'm trying to figure out what's changed.
[2012-07-26 19:16:19 -0400] ackz: freeformz: I ended up just overriding the java_home attribute to point to the jvm directory I want like :java_home => "/usr/lib/jvm/java-7-openjdk-amd64"
[2012-07-26 19:16:40 -0400] ackz: woops, freerobby, rather
[2012-07-26 19:17:31 -0400] freerobby: ackz: Yeah, that's what I have going right now but I'm hoping to open source the cookbook so I was hoping to find a less hacky solution (e.g. I don't want to have to have the cookbook run its own java install just so it knows where it is)
[2012-07-26 19:19:28 -0400] EJC: hi again I turned up the debugging as suggested earlier - but it didn't highlight anything spectacular.  I can see the specificity should still be pulling across my file objects but it's not (they're stored in the 'default' area)
[2012-07-26 19:27:37 -0400] freerobby: If anybody has thoughts on how I could troubleshoot this further, I'd greatly appreciate it: http://tickets.opscode.com/browse/COOK-1497
[2012-07-26 19:28:38 -0400] erratic: trololol
[2012-07-26 19:28:43 -0400] erratic: is me
[2012-07-26 19:40:29 -0400] rossdm: gragh this getting started documentation
[2012-07-26 20:13:46 -0400] cnf: moo
[2012-07-26 20:22:29 -0400] zuhaib: I got a cookbook question, using the cookbook site install is great for cookbooks from opscode but whats the best way to add cookbooks from other git repos and keep them in sync for upgrades.  I am playing with git submodles but they can be a bit of a PITA
[2012-07-26 20:24:48 -0400] fooforge: zuhaib: I'm using librarian-chef to solve this: https://github.com/applicationsonline/librarian
[2012-07-26 20:27:06 -0400] geekbri: zuhaib: I also use librarian-chef for it, there is also something called berkshelf
[2012-07-26 20:29:57 -0400] zuhaib: Thanks fooforge and geekbri, librarian-chef looks good, i might give it a test drive
[2012-07-26 20:32:12 -0400] erratic: I have a weird issue where my validation.pem file is being deleted even though I'm absolutely sure that chef-client::delete_validation isn't in the run_list for my chef server
[2012-07-26 20:32:15 -0400] erratic: so
[2012-07-26 20:32:40 -0400] erratic: in the chef-server::default I added a file touch that sets the permissions to 0440 and root:root and I'm hoping that fixes it?
[2012-07-26 20:32:57 -0400] erratic: any ideas why else if not delete_validation why that would happen though?
[2012-07-26 20:33:15 -0400] jbz: erratic:  And it's not in any attributes.json brought in during service start?
[2012-07-26 20:33:28 -0400] erratic: jbz thats a good question let me check
[2012-07-26 20:33:39 -0400] erratic: wait you mean chef-client start or chef-server start?
[2012-07-26 20:33:50 -0400] jbz: chef-client start
[2012-07-26 20:34:07 -0400] erratic: because restarting chef-server in -l debug seems to like to create a validation.pem if its nonexistent thankfully ..
[2012-07-26 20:34:11 -0400] erratic: let me check real quick
[2012-07-26 20:34:54 -0400] erratic: how would I find it
[2012-07-26 20:35:10 -0400] jbz: see if there's a file in /etc/chef/attributes.json
[2012-07-26 20:35:11 -0400] erratic: in /var/cache?
[2012-07-26 20:35:15 -0400] erratic: oh ok 1 sec
[2012-07-26 20:35:31 -0400] erratic: there's nto
[2012-07-26 20:35:35 -0400] erratic: not*
[2012-07-26 20:35:38 -0400] jbz: ok
[2012-07-26 20:36:29 -0400] jbz: 1 sec
[2012-07-26 20:38:42 -0400] jbz: OK, unsure then, sorry.
[2012-07-26 20:39:02 -0400] jbz: Reason I ask is that in our setup
[2012-07-26 20:39:19 -0400] jbz: the delete-validation recipe has a bit where it removes itself from the runlist immediately after it runs
[2012-07-26 20:39:27 -0400] jbz: so that it only runs the first time the service comes up
[2012-07-26 20:40:00 -0400] jbz: (and when the runlist is saved to the server, it's not there)
[2012-07-26 20:43:32 -0400] erratic: someone should make an nis cookbook
[2012-07-26 20:43:32 -0400] erratic: lol
[2012-07-26 20:44:30 -0400] asg: one that just contains Chef::Log.info("Lulz")
[2012-07-26 20:58:25 -0400] j|: yea, weird that no results when searching the cookbooks for a cf-engine cookbook.
[2012-07-26 21:17:02 -0400] erratic: https://gist.github.com/3184569 anybody seen this before?
[2012-07-26 21:17:59 -0400] erratic: Im guesing its because Im using an old ruby but I'm just curious
[2012-07-26 21:18:24 -0400] btm: erratic: what version of chef?
[2012-07-26 21:20:16 -0400] btm: erratic: it's probably this: http://tickets.opscode.com/browse/CHEF-2916
[2012-07-26 21:22:08 -0400] erratic: btm haha I like your repro :)
[2012-07-26 21:41:21 -0400] jackery: Is there a chef-client command that can add items to a runlist? I see -o and -j, but they seem to overwrite the run_list
[2012-07-26 21:43:36 -0400] btm: jackery: not really, that is sort of an anti-pattern. that functionality is 'knife node run list add'
[2012-07-26 21:44:11 -0400] jackery: I need to configure my hosts to do two things:
[2012-07-26 21:44:14 -0400] btm: jackery: because the run list is stored on the server, not on the client, there aren't interfaces to manage much of the client in the client itself.
[2012-07-26 21:44:20 -0400] jackery: 1) Load a base role on a new image
[2012-07-26 21:44:25 -0400] jackery: 2) Preserve its run_list for reimage
[2012-07-26 21:44:33 -0400] jackery: I can't find a way to accomplish this yet, though.
[2012-07-26 21:44:57 -0400] jackery: I'd like to avoid making a call back to a central server to wrap around a knife command.
[2012-07-26 21:45:26 -0400] mattray: yfeldblum: looking at librarian, if I want to work with a local cookbook not yet pushed to github, how do you do that?
[2012-07-26 21:45:35 -0400] btm: jackery: for a base role you'd create /etc/chef/first-boot.json, then have the system run "chef-client -j /etc/chef/first-boot.json" on first startup.
[2012-07-26 21:45:54 -0400] jackery: btm: That overwrites my run_list when I reimage a host.
[2012-07-26 21:45:59 -0400] mattray: yfeldblum: I've got a mix of community, github and locally modified cookbooks
[2012-07-26 21:46:14 -0400] yfeldblum: mattray, cookbook "asdf", path: "wip-cookbooks/asdf"
[2012-07-26 21:46:16 -0400] jackery: btm: But we were doing that for a while.
[2012-07-26 21:46:38 -0400] jackery: I could store the run_list in our asset repository and dynamically build a first-run JSON blob on image
[2012-07-26 21:46:41 -0400] jackery: but that seems like a hack
[2012-07-26 21:46:57 -0400] btm: jackery: are you reusing node objects when you reimage the system?
[2012-07-26 21:46:57 -0400] mattray: yfeldblum: ok, I see that now
[2012-07-26 21:47:04 -0400] jackery: btm: Yes.
[2012-07-26 21:47:12 -0400] mattray: yfeldblum: thinking about moving the openstack-chef-repo to using that
[2012-07-26 21:47:18 -0400] yfeldblum: mattray, as it is presently implemented, if you're using the knife integration, that should be it, but if not, you'll need to re-run `librarian-chef install` to re-copy the asdf cookbook into your cookbooks dir
[2012-07-26 21:47:27 -0400] jackery: btm: Our software deletes the client registration and preserves node.
[2012-07-26 21:47:31 -0400] upgrayedd: am i missing something about the mount resource with nfs type?  it fails when the path is already mounted for me
[2012-07-26 21:47:42 -0400] mattray: yfeldblum: the re-copy is what I wanted to avoid I think
[2012-07-26 21:47:43 -0400] yfeldblum: mattray, alternatively, if it's a cookbook that nothing within the Cheffile depends on, you don't even need to add it to your Cheffile
[2012-07-26 21:48:05 -0400] mattray: yfeldblum: no, these will be definitely depended on
[2012-07-26 21:48:26 -0400] mattray: yfeldblum: I guess you just run librarian-chef install when you reset
[2012-07-26 21:48:44 -0400] btm: jackery: write a recipe that takes the run_list and stores it in a node attribute if the run_list is not the default run_list, such as node['last_run_list']. then have the recipe remove /etc/chef/first-boot.json and copy the saved run list to the actual run list.
[2012-07-26 21:49:32 -0400] btm: jackery: have whatever calls 'chef-client -j /etc/chef/first-boot.json' do so with a conditional that first-boot.json exists, otherwise have it just run chef-client.
[2012-07-26 21:50:12 -0400] jackery: btm: That's a neat idea.
[2012-07-26 21:50:13 -0400] yfeldblum: mattray, yeah, since the implementation of `install` right now involves just copying the cookbook into the cookbooks dir
[2012-07-26 21:50:16 -0400] jackery: I'll run it by the team.
[2012-07-26 21:51:04 -0400] mattray: yfeldblum: I'll have to reconcile that to my development style, but maybe I'll have a better grasp on it after I use it for awhile
[2012-07-26 21:51:18 -0400] manish: I'm trying figure out how to deploy updated code to a chef node i've previously setup..its an existing backspace cloud server that i got up and running earlier, now i want to update code from a private repo and restart some processes. Can someone help?
[2012-07-26 21:52:05 -0400] yfeldblum: mattray, yeah
[2012-07-26 21:52:32 -0400] yfeldblum: mattray, i personally use the knife integration so working on repo-local cookbooks is a little easier for me
[2012-07-26 21:53:09 -0400] yfeldblum: mattray, but that is indeed an issue i've been considering, and which riot has been considering too
[2012-07-26 21:53:09 -0400] mattray: yfeldblum: yeah, after I sort it out I'll get spiceweasel to use it too
[2012-07-26 21:53:16 -0400] yfeldblum: mattray, cool
[2012-07-26 21:57:35 -0400] upgrayedd: when i set the loglevel to debug on the chef-client, why can't i see log messages emitted with Chef::Log.debug within providers?
[2012-07-26 21:59:04 -0400] mattray: upgrayedd: you should with -l debug
[2012-07-26 21:59:09 -0400] upgrayedd: i did
[2012-07-26 21:59:16 -0400] mattray: weird, I know I've used that
[2012-07-26 21:59:22 -0400] mattray: upgrayedd: version?
[2012-07-26 21:59:35 -0400] upgrayedd: 10.12
[2012-07-26 21:59:37 -0400] upgrayedd: .0
[2012-07-26 22:00:33 -0400] upgrayedd: i'm looking for messages from the built-in mount provider
[2012-07-26 22:00:40 -0400] upgrayedd: Chef::Log.debug("Special device #{device_logstring} mounted as #{@new_resource.mount_point}")
[2012-07-26 22:00:42 -0400] upgrayedd: but it doesn't appear
[2012-07-26 22:01:18 -0400] upgrayedd: oh ... it only doesn't appear when i do it this way :
[2012-07-26 22:01:18 -0400] upgrayedd: chef-client -E staging-cloud -l debug 2>&1 | tee /root/chef.log.`date +%s`
[2012-07-26 22:01:44 -0400] newb__: zuhaib, berkshelf
[2012-07-26 22:03:00 -0400] erratic: upgrayedd goin find u
[2012-07-26 22:03:13 -0400] upgrayedd: lol
[2012-07-26 22:03:51 -0400] upgrayedd: so, these messages must be coming out on some other file descriptor?
[2012-07-26 22:04:07 -0400] upgrayedd: besides 1 or 2 o_O
[2012-07-26 22:11:22 -0400] cakehero: can I use not_if and only_if in the same block?
[2012-07-26 22:14:13 -0400] cwj: yes you can
[2012-07-26 22:14:32 -0400] cwj: at least i'm pretty sure ive done it before :)
[2012-07-26 22:16:57 -0400] schism: If i kick a chef-client restart in the middle of a chef run, what happens to pending delayed_notifications?
[2012-07-26 22:20:02 -0400] btm: schism: they're lost.
[2012-07-26 22:20:15 -0400] schism: that makes me sad
[2012-07-26 22:20:19 -0400] btm: schism: chef-client currently exists when you ask it too.
[2012-07-26 22:20:39 -0400] btm: schism: yeah, we'd like to change that so a TERM finishes up a run. That'd be nice.
[2012-07-26 22:21:03 -0400] masterkorp: http://i.imgur.com/Jry0K.jpg
[2012-07-26 22:21:04 -0400] schism: btm: or so it puts back things it didnt complete.
[2012-07-26 22:22:36 -0400] masterkorp: but yeah its nice
[2012-07-26 22:22:36 -0400] schism: idempotentcy right out the window if you lose notifications
[2012-07-26 22:24:28 -0400] yfeldblum: cakehero, you can have multiple not_if's and multiple only_if's on the same resource, and the resource will only be acted on if all of the guards (only_if's and not_if's) pass
[2012-07-26 22:24:40 -0400] cakehero: awesome
[2012-07-26 22:24:44 -0400] cakehero: thanks yfeldblum
[2012-07-26 22:26:53 -0400] btm: schism: "puts back things it didn't complete" isn't going to happen. Chef can't model all of the sideaffects of its actions.
[2012-07-26 22:26:59 -0400] upgrayedd: it seems like it would be nice to have a notifies for pre-actions
[2012-07-26 22:27:34 -0400] btm: schism: yes, if an exception is raised chef stops immediately.
[2012-07-26 22:30:24 -0400] upgrayedd: does anybody understand how stdout and stderr from commands chef-client runs works?
[2012-07-26 22:30:36 -0400] upgrayedd: i can't capture it with file descriptor redirects
[2012-07-26 22:31:07 -0400] schism: btm: hmm, thanks
[2012-07-26 22:35:13 -0400] schism: btm: we're installing ldap, and then recipes that depend on that ldap. Even with ldap :immediate and ohia reload we're seeing ruby or chef hold onto group info from before ldap was avail
[2012-07-26 22:35:55 -0400] schism: btm: second run works fine. trying to find a way to get those recipes to work on the first run
[2012-07-26 22:40:37 -0400] btm: schism: I'd probably modify the recipe to execute a test command in a loop until it returns the auth info you want, and use that to debug if you just have to wait (you can do that using a similar technique) or if you have to reload something.
[2012-07-26 22:43:25 -0400] ampledata: From within a Recipe can I get a list of other Recipes included in the same Cookbook? e.g.: node['someattr'].each{|r| puts "i haz an #{r}"}
[2012-07-26 22:46:26 -0400] schism: btm: no matter how long we wait, the outdated group info still held onto by the ruby process, can't seem to get Etc.endgrent to clear it
[2012-07-26 22:48:25 -0400] btm: schism: I'm out the door over here, but the last thought off the top my head is something like https://github.com/opscode/cookbooks/commit/bf33af7b0d296e9176620a6317e940505b8ba9ac#L3R33
[2012-07-26 22:49:37 -0400] schism: btm: thanks
[2012-07-26 22:53:43 -0400] slantview: who is maintaining the oc-yum repo on gh?
[2012-07-26 22:53:51 -0400] slantview: i have an issue and a pull request submitted
[2012-07-26 22:58:14 -0400] cheeseplus: given that I've hacked the openldap cookbook up, I may as well put in a PR for supporting libnss/libpam-ldapd
[2012-07-26 23:02:35 -0400] ampledata: slantview: likely to be jtimberman
[2012-07-26 23:03:07 -0400] ampledata: don't forget to file a ticket at tickets.opscode.com
[2012-07-26 23:04:28 -0400] slantview: ampledata: ah ok, thanks!
[2012-07-26 23:26:02 -0400] tolland: how should i deal with reload existing in some packages and not others, when I want to notify?
[2012-07-26 23:26:44 -0400] tolland: is there any example of a cookbook that has to check whether reload exists?
[2012-07-26 23:36:06 -0400] jtimberman: slantview: we're still catching up on the backlog of resolved tickets.
[2012-07-26 23:36:30 -0400] slantview: jtimberman: ok, np.  opened ticket on tickets.opscode.com for it
[2012-07-26 23:36:37 -0400] jtimberman: slantview: we won't get to reviewing pull requests that don't have a corresponding ticket until then. the best way to get your pull request seen is through the documented contribution process. :)
[2012-07-26 23:36:44 -0400] jtimberman: cheers
[2012-07-26 23:36:47 -0400] jtimberman: thank you :D
[2012-07-26 23:37:01 -0400] slantview: jtimberman: scratch your own itch kind of thing, and i needed it to work :D
[2012-07-26 23:37:32 -0400] slantview: jtimberman: ticket is COOK-1498 FYI
[2012-07-26 23:37:52 -0400] slantview: jtimberman: i don't think a lot of people are using centos/rhel with chef it would seem.
[2012-07-26 23:38:25 -0400] jtimberman: slantview: the ticket should be in the resolved state, which you can do once you've been added to the jira-developers group when signing the CLA.
[2012-07-26 23:38:31 -0400] jtimberman: there's lots of people using chef with centos/rhel.
[2012-07-26 23:38:40 -0400] jtimberman: http://wiki.opscode.com/display/chef/How+to+Contribute - also explains the purpose of the cla
[2012-07-26 23:38:45 -0400] jtimberman: gotta run, cheers
[2012-07-26 23:38:51 -0400] slantview: jtimberman: perfect, on it.  thanks for the help
[2012-07-26 23:39:04 -0400] ampledata: can u use 'ignore_failure' with LWRPs?
[2012-07-26 23:39:31 -0400] jtimberman: ampledata: yes
[2012-07-26 23:41:31 -0400] ampledata: do i need to explicitly handle it within the lwrp
[2012-07-26 23:41:43 -0400] ampledata: or does chef do that for for resources in general?
[2012-07-26 23:45:42 -0400] cheeseplus: slantview: there are definitely lots of people using centos/rhel but that said, the cookbook support is skewed to debian/ubuntu
[2012-07-26 23:47:36 -0400] slantview: cheeseplus: understandable, it's too bad most of my clients use rhel ):
[2012-07-26 23:47:56 -0400] cheeseplus: all the more reason to drop PRs and tickets :)
[2012-07-26 23:47:57 -0400] newb__: how did I check the ulimit values of a user created bya chef rcp
[2012-07-26 23:48:17 -0400] newb__: for example, if chef creates the user' hadoop', how do I run 'ulimit -a' as hadoop?
[2012-07-26 23:48:22 -0400] newb__: it's a non interactive user
[2012-07-26 23:50:03 -0400] jordane: newb__: the execute resource has a 'user' attribute that it changes to before running the command
[2012-07-26 23:50:36 -0400] newb__: right jordane, how do I ssh into the machine and check if the ulimit was set correctly?
[2012-07-26 23:50:49 -0400] newb__: su -u does not work for a non interactive user
[2012-07-26 23:51:00 -0400] jordane: newb__: su - -s /bin/bash $user
[2012-07-26 23:54:16 -0400] newb__: jordane, using user=hadoop, it asks for a password, which does not exist for hadoop as it's a non interactive user
[2012-07-26 23:57:05 -0400] chrisstreeter: hey coderanger, you there?
[2012-07-26 23:57:12 -0400] coderanger: Yep, whats up
[2012-07-26 23:57:46 -0400] chrisstreeter: i was setting up a django app with chef, and wanted to see if there was a good documentation page on doing so with the application_python cookbook?
[2012-07-26 23:58:35 -0400] coderanger: https://github.com/opscode-cookbooks/application_python/blob/master/examples/recipes-packaginator.rb
[2012-07-26 23:58:37 -0400] coderanger: :)
[2012-07-26 23:58:48 -0400] coderanger: also the readme
[2012-07-26 23:58:49 -0400] chrisstreeter: ha, ok. i was afraid of that
[2012-07-26 23:59:16 -0400] coderanger: Its pretty straightforward
[2012-07-26 23:59:28 -0400] chrisstreeter: yeah, it isn't too bad i suppose
[2012-07-26 23:59:29 -0400] coderanger: The complex bits are usually setting up your DB of choice
[2012-07-26 23:59:44 -0400] chrisstreeter: yeah, i'm just using rds, so it should be easy i suppose
