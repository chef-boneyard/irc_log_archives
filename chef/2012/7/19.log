[2012-07-19 00:06:45 -0400] flagg0204: this might be a silly request. we are a hosted chef customer, and sometimes the response times on the platform can be really slow. are there best practives (or is it even recommended) to cache calls to the chef platform?  using squid or something
[2012-07-19 00:12:18 -0400] miah: flagg0204: you should open a ticket with support
[2012-07-19 00:12:44 -0400] miah: as a paying customer you do get that option
[2012-07-19 00:13:19 -0400] miah: i dont think caching is a valid solution
[2012-07-19 00:25:25 -0400] dodizzle: attributes question
[2012-07-19 00:25:55 -0400] dodizzle: an attribute set in a role should show up in the node correct?
[2012-07-19 00:26:15 -0400] dodizzle: I'm setting an attribute at the role level which I'
[2012-07-19 00:26:33 -0400] dodizzle: ve done many times before but its not showing up on the node
[2012-07-19 00:27:37 -0400] dodizzle: does the key have to already exist on the node in order for it to be over written by the role attribute?
[2012-07-19 00:28:34 -0400] jameson_: dodizzle: attributes set in roles should show up in the node
[2012-07-19 00:28:37 -0400] jameson_: no
[2012-07-19 00:28:44 -0400] jameson_: if it doesn't exist it will write it
[2012-07-19 00:29:01 -0400] dodizzle: thats what I thought
[2012-07-19 00:29:16 -0400] dodizzle: its an attribute that doesn't exist on the node
[2012-07-19 00:29:42 -0400] dodizzle: I applied it to the role and then assigned the role to the node
[2012-07-19 00:30:00 -0400] dodizzle: I see the role is applied but not the attribute
[2012-07-19 00:30:41 -0400] dodizzle: is it possible something on solr etc.. is stuck?
[2012-07-19 00:33:13 -0400] dodizzle: Ah Ha!
[2012-07-19 00:35:45 -0400] newb: dodizzle,. are you using shef to inspect the values?
[2012-07-19 00:36:11 -0400] dodizzle: I was using knife node list -l
[2012-07-19 00:36:16 -0400] dodizzle: its working now
[2012-07-19 00:36:23 -0400] newb: what was wrong?
[2012-07-19 00:36:56 -0400] dodizzle: the attribute set in the role wasn't showing up on the node when running knife show node -l
[2012-07-19 00:40:18 -0400] doomviking: but then it magically did?
[2012-07-19 00:40:49 -0400] knuckolls_: dodizzle: kamabe and i had that exact problem the other day. i'm not sure what she did to resolve it, it may have been resolved with time.
[2012-07-19 00:40:57 -0400] knuckolls_: dodizzle, using hosted chef?
[2012-07-19 00:44:14 -0400] dodizzle: knuckolls_ running my own instance
[2012-07-19 00:44:42 -0400] dodizzle: maybe solr or what ever process is involved in search
[2012-07-19 00:44:51 -0400] dodizzle: or some caching layer....if there is one
[2012-07-19 01:00:05 -0400] jameson_: rake roles...?
[2012-07-19 01:00:13 -0400] jameson_: i've not had that happen to me yet :X
[2012-07-19 02:03:44 -0400] victorg: hola
[2012-07-19 02:08:56 -0400] victorg: sups s1_
[2012-07-19 02:09:01 -0400] s1_: sup?
[2012-07-19 02:09:13 -0400] s1: chillin
[2012-07-19 02:09:23 -0400] victorg: chillin too. new to the channel. was looking for someone I heard hangs here. old friend.
[2012-07-19 02:09:23 -0400] hoover_damm: !chat
[2012-07-19 02:09:24 -0400] bawt: they get a solution Chef::EncryptedDatabagItem.load_alt_key http://lists.opscode.com/sympa/arc/chef/2011-11/msg00022.html
[2012-07-19 02:15:42 -0400] victorg: anyone know a jmiller?
[2012-07-19 02:22:48 -0400] hoover_damm: joe miller?
[2012-07-19 02:22:56 -0400] victorg: josh
[2012-07-19 02:23:09 -0400] victorg: heyas hoover_damm, btw.
[2012-07-19 02:25:25 -0400] hoover_damm: hrm, not off hand
[2012-07-19 02:25:32 -0400] hoover_damm: sorry
[2012-07-19 02:25:35 -0400] victorg: no worries.
[2012-07-19 02:25:37 -0400] victorg: thanks, though.
[2012-07-19 02:25:59 -0400] hoover_damm: if you know their nickname in irc i can check my irclogs for you
[2012-07-19 02:28:17 -0400] victorg: eh, no worries. I have some guesses. Just chucked the guesses into /notify and will see if he pops up.  I hear he is active with chef and in here, so I figure I'll run into him eventually.  We used to work together.
[2012-07-19 02:54:05 -0400] hoover_damm: victorg, /notify jassinpain
[2012-07-19 02:54:25 -0400] hoover_damm: wild guess
[2012-07-19 02:56:57 -0400] victorg: haha - exactly who I was looking for ;)
[2012-07-19 02:57:34 -0400] victorg: that's the email i saw him posting to the mailing lists with so that was my guess as well.
[2012-07-19 02:57:50 -0400] jtimberman: victorg: where did you work with Joshua?
[2012-07-19 02:58:45 -0400] victorg: heyas jtimberman
[2012-07-19 02:58:50 -0400] victorg: back in the day at Taos
[2012-07-19 02:59:00 -0400] victorg: I kinda misphrased it before as well.
[2012-07-19 02:59:17 -0400] jtimberman: ah
[2012-07-19 02:59:23 -0400] victorg: We never actually "worked" together, just both worked for Taos and hung around the same social circles.
[2012-07-19 02:59:49 -0400] victorg: A guy I worked closely with at Taos is practically his neighbor, so we used to all hang out sometimes.
[2012-07-19 03:00:18 -0400] victorg: Good guy, have not talked to him in a while, so just wanted to pop in and say hi.
[2012-07-19 03:31:42 -0400] ssd7_: Ohai Chefs!
[2012-07-19 03:45:10 -0400] jtimberman: ssd7_: ohai!
[2012-07-19 03:45:24 -0400] cwj: oheeeey
[2012-07-19 03:48:50 -0400] cwj: i am working on a cookbook with definitions that set up celery(d|beat|mon|cam) processes managed by supervisord and it feels like inception
[2012-07-19 03:48:55 -0400] cwj: http://ryanpitts.com/projects/inceptionator/
[2012-07-19 03:49:36 -0400] hoover_damm: celery huh? I guess I expected to see that
[2012-07-19 03:50:08 -0400] cwj: how do you mean
[2012-07-19 03:50:53 -0400] hoover_damm: observation and knowing someone will want to use it
[2012-07-19 03:50:57 -0400] hoover_damm: because it's worth it
[2012-07-19 03:51:29 -0400] hoover_damm: that and I was wanting to use celery for other awesome chef stuff ... but time
[2012-07-19 03:51:30 -0400] cwj: it works pretty well for us
[2012-07-19 03:52:00 -0400] hoover_damm: :)
[2012-07-19 04:31:04 -0400] stevage: hi all, I'm having a ruby path problem with the Postgresql cookbook. in irb, require 'pg' works, but in shef it doesn't.
[2012-07-19 04:31:39 -0400] stevage: I'm not a ruby developer at all, so not sure what to do next. This is running shef --client on Ubuntu 12
[2012-07-19 04:34:02 -0400] stevage: (sorry, to clarify: require 'pg' works after the preceding `require rubygems` and `Gem.clear_paths` steps)
[2012-07-19 04:37:12 -0400] Ry4an: stevage: I ran into exactly this problem earlier
[2012-07-19 04:37:57 -0400] stevage: and solved it? :)
[2012-07-19 04:38:02 -0400] victorg: :)
[2012-07-19 04:38:10 -0400] Ry4an: got help. lemme see if I can dig it up from backscroll
[2012-07-19 04:38:32 -0400] stevage: the first error is actually that `require 'rubygems'` fails in shef.
[2012-07-19 04:38:54 -0400] Ry4an: https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/client.rb#L39  <-- from btm
[2012-07-19 04:39:22 -0400] Ry4an: the gist being you have to get postgres installed "at compile time" so that it's already there at "run time"
[2012-07-19 04:40:21 -0400] Ry4an: I was doing it w/ myself, and i found I had to early-install (using the trick found there) mysql-client, mysqllib-dev, and make, and _then_ early-install the mysql gem, so that I could use the 'database' cookbook w/o it exploding on "require 'mysql'"
[2012-07-19 04:40:30 -0400] stevage: actually I already have that version
[2012-07-19 04:40:47 -0400] stevage: and it appears to have installed correctly - but something is wrong with the ruby paths/environment so it can't even find gems?
[2012-07-19 04:41:28 -0400] stevage: and yeah, I had a very similar problem with needing to early-install build-essential in order to build the postgres client. (it's like an arms race, each thing needing to be installed earlier than the next)
[2012-07-19 04:41:36 -0400] Ry4an: are you using chef_gem or gem_package ?
[2012-07-19 04:42:18 -0400] stevage: uw
[2012-07-19 04:42:19 -0400] stevage: um
[2012-07-19 04:42:31 -0400] stevage: I don't know - how do I tell?
[2012-07-19 04:43:19 -0400] Ry4an: I guess look for where you're installing the pg gem.  Or early-install the gem w/ chef_gem (which puts it in chef's gem path as opposed to the system wide one)
[2012-07-19 04:43:52 -0400] stevage: ah, gem_package - it's the same version as what you pasted before
[2012-07-19 04:44:29 -0400] Ry4an: change that to chef_gem as a test.  That's what I found I had to do earlier today anyway.
[2012-07-19 04:44:34 -0400] stevage: but again, the issue seems to be deeper than just pg - shef can't find rubygems itself
[2012-07-19 04:45:18 -0400] Ry4an: 'fraid we've plumbed the depths of my highly limited knowledge. :) Best of luck, though.
[2012-07-19 04:45:27 -0400] stevage: :)
[2012-07-19 05:02:13 -0400] flaccid: anyone used the mod_php_apache2 sub resource with application cookbook? for some reason if i go to use options it errors
[2012-07-19 05:02:32 -0400] flaccid: Chef::Exceptions::ValidationFailed: Option cookbook must be a kind of String!  You passed :mediawiki_application.
[2012-07-19 05:05:18 -0400] flaccid: for options such as webapp_template "web_app_basic.conf.erb"
[2012-07-19 05:07:09 -0400] BryanWB_: ohai chefs!
[2012-07-19 05:10:26 -0400] cap10morgan: how do you install chef_gems w/ native extensions under omnibus? I need build-essential to be installed before the chef_gem, I guess, but how do you specify that?
[2012-07-19 05:15:40 -0400] cwj: ohai BryanWB_
[2012-07-19 05:16:11 -0400] BryanWB_: cwj: hey Mr. mustache!
[2012-07-19 05:16:16 -0400] cwj: :D
[2012-07-19 05:16:24 -0400] cwj: whats up
[2012-07-19 05:16:36 -0400] BryanWB_: graphin', graphin'
[2012-07-19 05:17:10 -0400] cwj: moar graphs
[2012-07-19 05:20:14 -0400] timsmith: you get your collectd to graphite setup up Bryan?
[2012-07-19 05:24:30 -0400] BryanWB_: timsmith: i did
[2012-07-19 05:24:58 -0400] BryanWB_: timsmith: c here https://github.com/bryanwb/chef-collectd
[2012-07-19 05:25:11 -0400] BryanWB_: installing from source cuz the centos package is ancient
[2012-07-19 05:25:41 -0400] timsmith: that it is
[2012-07-19 05:25:58 -0400] timsmith: I think I'll use that basic plugins recipe concept
[2012-07-19 05:26:13 -0400] timsmith: I ended up creating a similar recipe in a different cookbook elsewhere
[2012-07-19 05:26:27 -0400] BryanWB_: timsmith: do u have any nontypical plugins that u recommend?
[2012-07-19 05:27:58 -0400] timsmith: a lot of what we've done is use the json plugin to read other sources like couchdb output
[2012-07-19 05:29:24 -0400] stevage: ok, found it: http://stackoverflow.com/questions/2945228/i-see-gem-in-gem-list-but-have-no-such-file-to-load
[2012-07-19 05:29:47 -0400] stevage: tl;dr: there's an extra path showing in 'gem env' which needs to be exposed as GEM_HOME
[2012-07-19 05:30:07 -0400] timsmith: apache and nginx plugins are handy too
[2012-07-19 05:32:17 -0400] retr0h: stevage: my guess is you are using a gem that wasn't installed by apt-get install ruby1.9.1
[2012-07-19 05:32:37 -0400] retr0h: stevage: err gem binary that is
[2012-07-19 05:32:38 -0400] stevage: it was installed using gem_package
[2012-07-19 05:32:56 -0400] retr0h: right but how was rubygems installed
[2012-07-19 05:32:58 -0400] stevage: this way: https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/client.rb#L39
[2012-07-19 05:33:18 -0400] stevage: um...let me check
[2012-07-19 05:33:32 -0400] retr0h: on 12.04 apt-get install ruby 1.9.1 installs /usr/bin/gem as well
[2012-07-19 05:34:06 -0400] stevage: maybe through `package "ruby-dev"`?
[2012-07-19 05:34:49 -0400] retr0h: if you didn't install it separately then it prob built in
[2012-07-19 05:34:57 -0400] retr0h: i haven't had any problems like taht with my rubygems
[2012-07-19 05:35:05 -0400] stevage: ok, so what does that mean? (I'm not a ruby dev - just trying to diagnose and fix a problem in postgres recipe)
[2012-07-19 05:35:23 -0400] retr0h: other than it's super lame installing gems with binaries on ubuntu since they all get stuck under /var/lib/gems/...
[2012-07-19 05:35:47 -0400] stevage: this cookbook worked as a whole on ubuntu 10.04 using chef solo - but now I'm trying to deploy it through hosted chef on 12.04
[2012-07-19 05:36:07 -0400] retr0h: well ruby is quite a bit diff on 12.04
[2012-07-19 05:36:30 -0400] retr0h: 12.04 is nice and uses alternatives
[2012-07-19 05:36:36 -0400] stevage: yeah that's what's weird: Gem.path points to the right place, with the pg gem - but `require pg` fails
[2012-07-19 05:36:51 -0400] stevage: yet if I add /var/lib/gems to GEM_HOME, then `require pg` can find it
[2012-07-19 05:37:08 -0400] flaccid: omnibus? sandboxed env..
[2012-07-19 05:37:11 -0400] retr0h: what does which ruby and which gem say?
[2012-07-19 05:37:13 -0400] flaccid: GEM_PATH is not systems
[2012-07-19 05:37:23 -0400] stevage: err, omnibus - just worked through the fast start
[2012-07-19 05:37:41 -0400] stevage: flaccid: both point to /usr/bin/
[2012-07-19 05:37:53 -0400] flaccid: gem env
[2012-07-19 05:38:06 -0400] stevage:   - GEM PATHS:      - /var/lib/gems/1.8      - /home/ubuntu/.gem/ruby/1.8
[2012-07-19 05:38:08 -0400] flaccid: or sorry gem environment
[2012-07-19 05:38:20 -0400] flaccid: so thats what it should use
[2012-07-19 05:38:23 -0400] stevage:   - RUBYGEMS VERSION: 1.8.15   - RUBY VERSION: 1.8.7 (2011-06-30 patchlevel 352) [x86_64-linux]   - INSTALLATION DIRECTORY: /var/lib/gems/1.8   - RUBY EXECUTABLE: /usr/bin/ruby1.8   - EXECUTABLE DIRECTORY: /usr/local/bin
[2012-07-19 05:38:34 -0400] flaccid: looks pretty normal
[2012-07-19 05:39:02 -0400] retr0h: stevage: I thought you were ruby 1.9.1 for some reason
[2012-07-19 05:39:09 -0400] stevage: but in shef (if I don't set GEM_HOME), then 'Gem.path' is /opt/chef/embedded/lib/ruby/gems/1.9.1
[2012-07-19 05:39:31 -0400] retr0h: stevage: do you have /usr/bin/ruby and /usr/bin/ruby1.9.1?
[2012-07-19 05:39:35 -0400] flaccid: shef script can change the GEM_ envs
[2012-07-19 05:40:01 -0400] flaccid: looks right for omnibus
[2012-07-19 05:40:02 -0400] stevage: retr0h: no, ruby and ruby1.8
[2012-07-19 05:40:07 -0400] flaccid: which shef ..
[2012-07-19 05:40:29 -0400] stevage: 10.12.0
[2012-07-19 05:40:47 -0400] flaccid: `which shef`
[2012-07-19 05:41:03 -0400] stevage: heh, sorry. /usr/bin/shef
[2012-07-19 05:41:12 -0400] flaccid: file /usr/bin/shef
[2012-07-19 05:41:21 -0400] flaccid: then also look in the shef script to see if it sets GEM_
[2012-07-19 05:41:22 -0400] retr0h: stevage: ls -l /usr/bin/gem
[2012-07-19 05:41:26 -0400] stevage: symlink to /opt/chef/bin/shef
[2012-07-19 05:41:29 -0400] flaccid: but i have never used omnibus
[2012-07-19 05:41:33 -0400] flaccid: still sounds right
[2012-07-19 05:41:39 -0400] stevage: retr0h: lrwxrwxrwx 1 root root 18 Jul 19 01:48 /usr/bin/shef -> /opt/chef/bin/shef
[2012-07-19 05:41:47 -0400] flaccid: the env for the shell or sh user will be diff to what omnibus uses
[2012-07-19 05:41:55 -0400] stevage: sorry, lrwxrwxrwx 1 root root 21 Jul 18 09:05 /usr/bin/gem -> /etc/alternatives/gem
[2012-07-19 05:41:57 -0400] flaccid: yep ..
[2012-07-19 05:42:05 -0400] retr0h: stevage: ok and ls -l /etc/alternatives/gem/
[2012-07-19 05:42:07 -0400] retr0h: err
[2012-07-19 05:42:10 -0400] flaccid: looks to be working as designed
[2012-07-19 05:42:12 -0400] retr0h: ls -l /etc/alternatives/gem
[2012-07-19 05:42:25 -0400] stevage: retr0h: /usr/bin/gem1.8
[2012-07-19 05:42:35 -0400] retr0h: ok ver weird
[2012-07-19 05:42:45 -0400] retr0h: well what i would suggest is this
[2012-07-19 05:43:02 -0400] stevage: so Chef installs its own version of Ruby and gems? and that's not playing nicely with the version installed by apt-get?
[2012-07-19 05:43:16 -0400] flaccid: yeah, which is what omnibus is
[2012-07-19 05:43:20 -0400] retr0h: apt-get remove all the ruby 1.8 stuff and apt-get install rugy1.9.1 which is ruby 1.9.3 in debian naming
[2012-07-19 05:43:24 -0400] flaccid: i havnt used it before though
[2012-07-19 05:43:37 -0400] retr0h: if ur on 12.04 no real reason to be on 1.8 ruby anyways
[2012-07-19 05:44:07 -0400] flaccid: its the default in 12.04 though and 12.04 has ruby1.9.3 pkg
[2012-07-19 05:44:08 -0400] retr0h: in my environemtn which has many hundreds of nodes
[2012-07-19 05:44:15 -0400] retr0h: i run 12.04 with 1.9.1 ruby
[2012-07-19 05:44:21 -0400] retr0h: and chef installed as a gem
[2012-07-19 05:44:43 -0400] stevage: is there a way to make omnibus install a newer version?
[2012-07-19 05:45:09 -0400] retr0h: and gem env reports
[2012-07-19 05:45:09 -0400] retr0h:   - GEM PATHS:
[2012-07-19 05:45:10 -0400] retr0h:      - /var/lib/gems/1.9.1
[2012-07-19 05:45:12 -0400] ssd7_: I'm not completely caught up on backscroll but if someone gives me a summary I might be able to help.
[2012-07-19 05:45:59 -0400] stevage: ssd7: postgres cookbook failed on Ubuntu 12.04 because the Gems path is /opt/chef/embedded... whereas the pg gem got installed to /var/lib/...
[2012-07-19 05:46:30 -0400] stevage: ssd7: a viable workaround seems to be setting GEM_HOME=/var/lib/... in ~ubuntu/.profile
[2012-07-19 05:46:35 -0400] flaccid: that sounds right
[2012-07-19 05:46:58 -0400] flaccid: the ruby api will use the ruby active
[2012-07-19 05:47:07 -0400] flaccid: so the cookbook needs to chef_gem what it needs
[2012-07-19 05:47:21 -0400] retr0h: stevage: pretty sure if you uninstall ruby 1.8 and apt-get install ruby1.9.1 and ruby1.9.1-dev you should be fine your gem path should be correct with /var/lib/gems/1.9.1
[2012-07-19 05:47:42 -0400] jessicab: sounds like this bug - http://tickets.opscode.com/browse/COOK-1406
[2012-07-19 05:48:05 -0400] stevage: retr0h: um, yes...but then I need to work out how to make that change in my cookbooks. (I'm still learning chef here)
[2012-07-19 05:48:25 -0400] flaccid: because it will use the omnibus ruby env, if you need the gems on the system, the recipe has to use gem_binary with the gem_package resource !
[2012-07-19 05:50:14 -0400] stevage: (ok, that workaround *didn't* work)
[2012-07-19 05:50:52 -0400] stevage: jessicab: yeah, could be. the actual error I'm getting manifests itself like this: http://lists.opscode.com/sympa/arc/chef/2012-06/msg00303.html
[2012-07-19 05:51:07 -0400] stevage: (although the cause is apparently different, since I'm already using that version of the cookbook)
[2012-07-19 05:51:30 -0400] jessicab: ah weird, havent seen that error.. theres a workaround in the bug that might work for you though
[2012-07-19 05:51:46 -0400] ssd7: Sorry, network hiccup.
[2012-07-19 05:51:50 -0400] stevage: flaccid: I don't quite understand - are you suggesting replacing the `gem_package "pg"` line with a gem_binary?
[2012-07-19 05:52:14 -0400] flaccid: stevage: gem_binary is an option of the gem_package resource e.g. gem_binary '/usr/bin'
[2012-07-19 05:52:31 -0400] flaccid: 00ps gem_binary '/usr/bin/gem'
[2012-07-19 05:52:41 -0400] ssd7: stevage: If you use the new chef_gem resource, it should install the gem such that you can use it inside chef
[2012-07-19 05:52:54 -0400] flaccid: inside chef will be omnibus in this case yes
[2012-07-19 05:53:25 -0400] stevage: currently just using gem_package
[2012-07-19 05:53:38 -0400] stevage: as per here: https://github.com/opscode-cookbooks/postgresql/blob/master/recipes/client.rb#L39
[2012-07-19 05:53:42 -0400] retr0h: so i must be stupid... wtf is omnibus... that a ruby installer?
[2012-07-19 05:53:53 -0400] stevage: new multi-platform chef client installer
[2012-07-19 05:54:08 -0400] retr0h: ahhhhhh
[2012-07-19 05:54:19 -0400] ssd7: stevage: Yeah, so in that recipe, if you change line 42-44 to: chef_gem "pg"
[2012-07-19 05:54:54 -0400] stevage: hmm, so two alternative changes: either change to chef_gem, or add gem_binary?
[2012-07-19 05:55:07 -0400] ssd7: stevage: Those are close to the same thing.
[2012-07-19 05:55:07 -0400] flaccid: gem_package will install it into the current ruby env, but too late for you
[2012-07-19 05:55:46 -0400] flaccid: gem_binary only if you want to change it to install into system ruby, otherwise chef_gem like we advised from start..
[2012-07-19 05:55:47 -0400] retr0h: whats so hard about the original bootstrap scripts or apt-get install ruby1.9.1 && gem install chef?
[2012-07-19 05:56:37 -0400] jessicab: a third option too is always just not using omnibus.. thats the workaround i was referencing thats explained in that bug
[2012-07-19 05:57:38 -0400] retr0h: yah I must be doing it the non-kewl way I am not using omnibus on my 12.04 systems... :/
[2012-07-19 05:58:08 -0400] ssd7: retr0h: Getting a sane ruby+rubygems one old RHEL or Solaris or Windows can be difficult.
[2012-07-19 05:58:18 -0400] stevage: I might actually try that - reinstall without omnbius
[2012-07-19 05:59:01 -0400] flaccid: its a change and one that hasn't been recognized much. we dealt with it at rightscale because we did sandboxed chef way before opscode
[2012-07-19 05:59:28 -0400] retr0h: ssd7: yah I'm not concerned with those..... just have to worry bout linux
[2012-07-19 05:59:34 -0400] retr0h: ssd7: well debian
[2012-07-19 06:00:18 -0400] flaccid: if_paid_commercial_os it_is_harder
[2012-07-19 06:01:31 -0400] retr0h: lol
[2012-07-19 06:02:29 -0400] retr0h: i always find i'm doing it a way that works (seems clean) then come to find out the community has a better way to do it .. and I'm doing it the old way heh
[2012-07-19 06:02:32 -0400] ssd7: Not using omnibus is one path and if you don't need to worry about sandboxing ruby and aren't running on platforms where dependency management is hard, you won't run into these issues.  Most of these issues should get cleared up as we get updates out to the various cookbooks the depend on gems.  Gems that need to be natively compiled also pose a problem that will require some cookbook updates
[2012-07-19 06:03:05 -0400] retr0h: thats my story with all my openstack cookbooks... the ones I worked on are pimp but now the community ones are kick ass so its time to start using those...  heh
[2012-07-19 06:03:47 -0400] stevage: mostly what I'm trying to achieve here is learning chef - I'm not actually building a production system (yet)
[2012-07-19 06:04:22 -0400] retr0h: stevage: well we glad u learning chef... it's awesome :)
[2012-07-19 06:04:35 -0400] stevage: I wish someone had told me about it a year ago
[2012-07-19 06:04:47 -0400] stevage: I've wasted far too much time managing systems manually
[2012-07-19 06:06:11 -0400] flaccid: i'm going to jump out the window in a sec if i can't get mod_php_apache2 options to work
[2012-07-19 06:06:17 -0400] stevage: btw are the old pre-omnibus bootstrap scripts still available?
[2012-07-19 06:06:47 -0400] retr0h: i been using it since late 2008 early 2009 (i think) but i'm no ninja
[2012-07-19 06:07:32 -0400] flaccid: ssd7: if i go to use options with mod_php_apache2 https://github.com/opscode-cookbooks/application_php such as  webapp_template i get Chef::Exceptions::ValidationFailed: Option cookbook must be a kind of String!  You passed :mediawiki_application. got any ideas?
[2012-07-19 06:07:54 -0400] jessicab: stevage - yep, they are.. just chef-full uses omnibus, in that bug.. the very last comment i list off all of them.. theyre also on the knife bootstrap wiki page though
[2012-07-19 06:08:05 -0400] flaccid: i'll try putting it in the php sub resource i guess
[2012-07-19 06:08:12 -0400] flaccid: which makes sense but not how its documented
[2012-07-19 06:08:13 -0400] cwj: https://github.com/opscode/chef/tree/master/chef/lib/chef/knife/bootstrap
[2012-07-19 06:10:02 -0400] flaccid: does anyone see a problem with http://dpaste.org/CuiI5/ ? it returns ad an error: Chef::Exceptions::ValidationFailed: Option cookbook must be a kind of String!  You passed :mediawiki_application.
[2012-07-19 06:10:03 -0400] ssd7: flaccid: looks like you probably passed :mediawiki_application rather than "mediawiki_application".
[2012-07-19 06:10:19 -0400] ssd7: hmm
[2012-07-19 06:10:27 -0400] stevage: jessicab: awesome, so knife bootstrap .... -d ubuntu12.04-gems
[2012-07-19 06:10:29 -0400] ssd7: nvm, typed before I saw your update with the paste.
[2012-07-19 06:10:31 -0400] flaccid: let me push how it should be ssd7 so you can see
[2012-07-19 06:10:53 -0400] jessicab: stevage - yep, exactly.. that will do a gem install instead
[2012-07-19 06:12:42 -0400] stevage: ok, I'm rolling the dice now
[2012-07-19 06:13:29 -0400] flaccid: ssd7: here it is https://github.com/flaccid/cookbooks/blob/master/cookbooks/mediawiki_application/recipes/application.rb#L41
[2012-07-19 06:13:39 -0400] flaccid: from what i can see this is inline with the README.md
[2012-07-19 06:13:46 -0400] ssd7: flaccid: So, can you post the stack trace that you are getting with that error if you run with -l debug
[2012-07-19 06:14:24 -0400] flaccid: ok let me re-do with vagrant. i just don't know how to up log_level with vagrant :(
[2012-07-19 06:14:28 -0400] flaccid: but i can get the stack trace
[2012-07-19 06:15:18 -0400] ssd7: I think this may be a bug but I'm still looking.
[2012-07-19 06:17:40 -0400] ssd7: My guess is that it is actually failing here: https://github.com/opscode-cookbooks/application_php/blob/master/providers/mod_php_apache2.rb#L53
[2012-07-19 06:19:34 -0400] ssd7: flaccid: Out of curiosity, if you change new_resource.cookbook_name to new_resource.cookbook_name.to_s on that line I posted, does it work?
[2012-07-19 06:21:09 -0400] flaccid: ssd7: i think you may be right, let me paste this stack trace then try the to_s
[2012-07-19 06:21:35 -0400] stevage: flaccid: add this to your Vagrantfile:      chef.log_level = :debug
[2012-07-19 06:21:55 -0400] flaccid: stevage: oh sweet thanks. i never saw that in the vagrant docs!
[2012-07-19 06:22:54 -0400] stevage: there's  also an env variable, like VAGRANT_LOG=debug
[2012-07-19 06:22:57 -0400] stevage: http://vagrantup.com/v1/docs/debugging.html
[2012-07-19 06:22:59 -0400] flaccid: ssd7: stack trace http://dpaste.org/CwMS3/
[2012-07-19 06:23:16 -0400] flaccid: stevage: yeah but that doesn't indicate that it changes chef-solo's log_level option.
[2012-07-19 06:26:49 -0400] flaccid: ok doing a new vagrant up with the debug options and the to_s change
[2012-07-19 06:33:50 -0400] flaccid: i'm using https://github.com/flaccid/cookbooks/blob/master/cookbooks/mediawiki_application/contrib/vagrant/precise64/Vagrantfile
[2012-07-19 06:34:53 -0400] CrazyHorse18: i keep getting 'ERROR: Fog::Compute::AWS::NotFound: The key pair whatever is not found" it's in my ~/.ssh directory
[2012-07-19 06:34:57 -0400] CrazyHorse18: with the correct permissions
[2012-07-19 06:34:58 -0400] CrazyHorse18: now what?
[2012-07-19 06:35:30 -0400] flaccid: CrazyHorse18: we don't know what you are using..
[2012-07-19 06:36:00 -0400] ssd7: CrazyHorse18: Is the public key of that keypair uploaded to AWS?
[2012-07-19 06:36:25 -0400] CrazyHorse18: hmm yeah
[2012-07-19 06:36:34 -0400] CrazyHorse18: downloaded from AWS
[2012-07-19 06:36:55 -0400] CrazyHorse18: but it says the keypair does not exist
[2012-07-19 06:36:58 -0400] CrazyHorse18: now i can run ssh and it work
[2012-07-19 06:37:00 -0400] CrazyHorse18: works
[2012-07-19 06:37:21 -0400] CrazyHorse18: ssh-add whatever.pem that is
[2012-07-19 06:37:24 -0400] CrazyHorse18: and it adds
[2012-07-19 06:37:32 -0400] ssd7: CrazyHorse18: What region is it uploaded to?
[2012-07-19 06:37:39 -0400] flaccid: ssh works out of box for good images that fetch the instance's ec2 public ssh key
[2012-07-19 06:38:12 -0400] CrazyHorse18: ap-northeast-1
[2012-07-19 06:38:41 -0400] flaccid: are you using the fog cookbook to do something or just having trouble's loggin in with ssh ?
[2012-07-19 06:39:06 -0400] CrazyHorse18: i'm running  knife ec2 server create -I ami-dc8230dd -N testserver01  -x ubuntu --region 'ap-northeast-1'
[2012-07-19 06:39:50 -0400] ssd7: CrazyHorse18: Hrmm. That should work then.  you might want to try settign the availability zone too for good measure.
[2012-07-19 06:39:58 -0400] CrazyHorse18: i go into ap-northest-1 and in the keypairs i can see AlexKnife
[2012-07-19 06:39:58 -0400] ssd7: Oh,
[2012-07-19 06:39:59 -0400] ssd7: wait
[2012-07-19 06:40:07 -0400] ssd7: You need to also pass -S AlexKnife
[2012-07-19 06:40:23 -0400] flaccid: yes or it uses default iirc?
[2012-07-19 06:40:35 -0400] CrazyHorse18: knife ec2 server create -I ami-dc8230dd -N testserver01  -x ubuntu --region 'ap-northeast-1' -s AlexKnife
[2012-07-19 06:40:36 -0400] CrazyHorse18: ERROR: Fog::Compute::AWS::NotFound: The subnet ID 'AlexKnife' does not exist
[2012-07-19 06:40:54 -0400] CrazyHorse18: whoops
[2012-07-19 06:40:56 -0400] flaccid: not -s
[2012-07-19 06:40:56 -0400] CrazyHorse18: small case
[2012-07-19 06:41:04 -0400] CrazyHorse18: knife ec2 server create -I ami-dc8230dd -N testserver01  -x ubuntu --region 'ap-northeast-1' -S AlexKnife
[2012-07-19 06:41:04 -0400] CrazyHorse18: ERROR: Fog::Compute::AWS::NotFound: The key pair 'AlexKnife.pem' does not exist
[2012-07-19 06:41:29 -0400] CrazyHorse18: ls -al ~/.ssh/Ale*
[2012-07-19 06:41:35 -0400] CrazyHorse18: -rw-------@ 1 alexmoore  staff  1696 17 Jul 09:27 .ssh/AlexKnife.pem
[2012-07-19 06:41:51 -0400] CrazyHorse18: so ssh key is definitly there
[2012-07-19 06:41:59 -0400] CrazyHorse18: and ssh-add works with it
[2012-07-19 06:42:06 -0400] CrazyHorse18: it looks like knife can't find it
[2012-07-19 06:42:14 -0400] CrazyHorse18: i.e. i think the issue is on the local machine
[2012-07-19 06:42:44 -0400] ssd7: CrazyHorse18: That error is from fog, so it is more likely just the result of the API response they are getting back from AWS
[2012-07-19 06:43:00 -0400] CrazyHorse18: interesting ok.. hopefully it's got a verbose option
[2012-07-19 06:44:20 -0400] ssd7: It does but I don't think fog gives us that much more info.  Have you tried adding the availability zone as well with --availability-zone?
[2012-07-19 06:44:44 -0400] CrazyHorse18: yeah i'm setting that
[2012-07-19 06:46:37 -0400] CrazyHorse18: knife ec2 server create -I ami-dc8230dd -N testserver01  -x ubuntu --region 'ap-northeast-1' -S AlexKnife --verbose -Z 'ap-northeast-1b'
[2012-07-19 06:46:38 -0400] CrazyHorse18: ERROR: Fog::Compute::AWS::NotFound: The key pair 'AlexKnife.pem' does not exis
[2012-07-19 06:46:46 -0400] CrazyHorse18: it's got to be an ssh issue
[2012-07-19 06:46:53 -0400] CrazyHorse18: ssh key issue
[2012-07-19 06:49:49 -0400] CrazyHorse18: holy crap
[2012-07-19 06:49:51 -0400] CrazyHorse18: it just worked
[2012-07-19 06:49:52 -0400] CrazyHorse18: :)
[2012-07-19 06:49:54 -0400] CrazyHorse18: :/
[2012-07-19 06:49:56 -0400] CrazyHorse18: don't know why
[2012-07-19 06:50:27 -0400] ssd7: Yeah, I'm pretty familiar with the ec2 plugin so I would have been surprised if it was a problem with the key.
[2012-07-19 06:50:33 -0400] CrazyHorse18: but thankyou one of those magic combinations kicked it in
[2012-07-19 06:50:57 -0400] ssd7: Lots of things on EC2 are 'eventually consistent' so perhaps you also just hit a transient problem with AWS
[2012-07-19 06:52:40 -0400] ssd7: flaccid: any luck with .to_s?
[2012-07-19 06:55:30 -0400] flaccid: ssd7: on slow setup atm, its just about there sorry
[2012-07-19 06:56:24 -0400] ssd7: oh no problem. Sitting around playing with Haskell at the moment so I'm not in a rush. :)
[2012-07-19 06:57:20 -0400] flaccid: ah coolio
[2012-07-19 07:01:16 -0400] stevage: ok, installing chef client on Ubuntu with this worked: -d ubuntu12.04-gems
[2012-07-19 07:01:21 -0400] stevage: woot.
[2012-07-19 07:03:24 -0400] jessicab: nice
[2012-07-19 07:07:58 -0400] flaccid: ssd7: i think that was it as it succeeded. i still get Call to undefined function mysql_error() in /var/www/releases/5dc1a63f204c3167cc9d497d02aca4e517ca5288/includes/db/DatabaseMysql.php on line 312 though
[2012-07-19 07:08:10 -0400] flaccid: wondering if i need to do more to setup php/mysql
[2012-07-19 07:09:06 -0400] flaccid: libapache2-mod-auth-mysql php5-mysql are both not installed so i'll check the doc on what i should do
[2012-07-19 07:10:36 -0400] flaccid: ssd7: yeah its unclear with these cookbooks what should be doing the php/mysql support
[2012-07-19 07:20:42 -0400] flaccid: i think thats all enough to get me there though, thatnks ssd7 and also stevage for the vagrant tip
[2012-07-19 07:24:51 -0400] ssd7: flaccid: glad you got it sorted.  My guess is you will need some mysql packages and such; although the dependencies for the cookbook /should/ pull them in unless this is another "needs to be updated for omnibus" situation
[2012-07-19 07:26:04 -0400] flaccid: the cookbook deps are sorted its just that php/mysql doesn't seem to be covered
[2012-07-19 08:03:36 -0400] tolland: for multiple users to the same chef-server do you use the chef-server as the shared repo, or some other hosted repo like github?
[2012-07-19 08:12:44 -0400] specialsauce: tolland, we use a gitolite install on a remove host to host the code with open source chef server
[2012-07-19 08:19:32 -0400] chron0: heyho fellow chefs :)
[2012-07-19 08:19:38 -0400] tolland: ohai
[2012-07-19 08:20:26 -0400] chron0: I am trying to give chef a go instead of puppet and ran into some problem bootstrapping a client ( I am still just testing and learning :))
[2012-07-19 08:21:11 -0400] chron0: when I try to bootstrap a naked host I get /usr/lib/ruby/1.8/net/ssh.rb:155:in `start': invalid option(s): keys_only (ArgumentError)
[2012-07-19 08:21:20 -0400] chron0: I've already seen that someone else had the problem
[2012-07-19 08:21:30 -0400] chron0: http://community.opscode.com/chat/chef/2012-07-11
[2012-07-19 08:21:38 -0400] chron0: but I don't see a solution in there
[2012-07-19 08:22:29 -0400] chron0: I just run: knife bootstrap hostname -x root -i someawskey.pem -VV
[2012-07-19 08:22:59 -0400] chron0: however simply sshing into the box with the key file works just fine, key permissions are oky, no host verification foo etc..
[2012-07-19 08:23:04 -0400] chron0: anyone any ideas?
[2012-07-19 08:24:18 -0400] cpasmoi: "without -i it runs without any issues"
[2012-07-19 08:24:26 -0400] cpasmoi: (hi btw)
[2012-07-19 08:24:37 -0400] cpasmoi: that's what i read in that log
[2012-07-19 08:24:54 -0400] chron0: cpasmoi: hey :) but how in the hell is it going to know which keyfile it has to use? it's not the default id_rsa private key :)
[2012-07-19 08:25:19 -0400] chron0: this is one of those amazonaws keys you get from amazon to get onto the box
[2012-07-19 08:25:36 -0400] cpasmoi: what version are you using ?
[2012-07-19 08:25:41 -0400] chron0: 0.10.12
[2012-07-19 08:26:04 -0400] cpasmoi: well, at 15:45 in the log you got an answer I guess
[2012-07-19 08:26:18 -0400] cpasmoi: I'm new at chef, sorry :)
[2012-07-19 08:26:47 -0400] cpasmoi: My first week in this job, with a valid chef running, and I'm trying to understand it
[2012-07-19 08:28:10 -0400] chron0: yeah, I've seen that but what does it mean? is -i the wrong option or do I have to remove my default key and replace it with the amaonkey to make it work ( which would be hilarious) :)
[2012-07-19 08:28:38 -0400] chron0: cpasmoi: no sweat, I am grateful for any hint, maybe I'm just blind :) - and while we are new to all of this we learn the most anyways :)
[2012-07-19 08:28:44 -0400] cpasmoi: to what I understood, -i is the old option
[2012-07-19 08:28:56 -0400] cpasmoi: there would be another on chef 10... I guess
[2012-07-19 08:29:14 -0400] cpasmoi: which command are you using ?
[2012-07-19 08:29:25 -0400] cpasmoi: Try to --help it, perhaps
[2012-07-19 08:29:27 -0400] chron0: well knife bootstrap -h returns: -i IDENTITY_FILE                 The SSH identity file used for authentication
[2012-07-19 08:29:35 -0400] cpasmoi: mheh
[2012-07-19 08:29:46 -0400] cpasmoi: oh, wait
[2012-07-19 08:30:03 -0400] cpasmoi: do you have another option after ?
[2012-07-19 08:30:34 -0400] chron0: I was following: http://wiki.opscode.com/display/chef/Client+Bootstrap+Fast+Start+Guide
[2012-07-19 08:30:43 -0400] chron0: I tried the --sudo and without
[2012-07-19 08:30:58 -0400] ssd7: It's a bit late here so I can't stick around to debug, but -i should work as an option
[2012-07-19 08:31:39 -0400] chron0: ssd7: thanks for the thumbs up and good night anyways :)
[2012-07-19 08:31:54 -0400] ssd7: Quick question Do you have any custom settings in your local ssh config?
[2012-07-19 08:32:25 -0400] chron0: ssd7: not that I have made any, maybe it's some amazonaws configfoo, lemme check
[2012-07-19 08:33:58 -0400] chron0: looks pretty much default and again, using the same users env to just ssh into the box with the -i option and the keyfile works just fine
[2012-07-19 08:34:29 -0400] chron0: i don't need to be root (as user who is using the knife), do I?
[2012-07-19 08:35:23 -0400] ssd7: Shouldn't unless your user doesn't have permission to read the key on your local disk, but that would be a different error I think
[2012-07-19 08:36:28 -0400] ssd7: chron0: So i've seen at least one bug with the ruby library we use for ssh parsing the local config wrong.  You might try temporarily commenting out your .ssh/config to rule that out.
[2012-07-19 08:36:59 -0400] ssd7: If you can't get it sorted, feel free to file a but at tickets.opscode.com or open a support ticket (support@opscode.com).
[2012-07-19 08:37:02 -0400] ssd7: g'luck
[2012-07-19 08:44:12 -0400] ssd7: chron0: Looks like this might be a recent bug: http://tickets.opscode.com/browse/CHEF-2971
[2012-07-19 08:44:52 -0400] ssd7: A work around would potentially be to add it to an ssh-agent (ssh-add /path/to/key)
[2012-07-19 08:46:12 -0400] chron0: ssd7: thanks dude, I will try
[2012-07-19 08:50:07 -0400] cpasmoi: and don't forget to sleep
[2012-07-19 08:50:52 -0400] chron0: ssd7: ok, I can verify this bug, once i safed my id_rsa and moved my amazonkey to id_rsa it seem to work (when not supplying -i that is)
[2012-07-19 08:50:58 -0400] chron0: however that's really a showkiller :)
[2012-07-19 08:52:11 -0400] chron0: ah, now I already see the new machine in the client list, that is really nice :)
[2012-07-19 08:52:25 -0400] ssd7: chron0: Yeah, if I have some free time I'll try to dig into it tomorrow.  I'll file a full bug in the morning regarding the regression.
[2012-07-19 08:52:28 -0400] ssd7: cheers
[2012-07-19 08:56:10 -0400] ssd7: chron0: Actually, one last thing, if you could get a stack trace by adding -VV to the failing knife command, that would help.  If you post the link here I can grab it from the logs later or feel free to open a ticket.
[2012-07-19 08:59:59 -0400] chron0: ssd7: yeah sure, I'll just generate it, but there es nothing new to it, looks like the other two
[2012-07-19 09:02:50 -0400] chron0: ssd7: http://pastebin.com/GZV6jHjn
[2012-07-19 09:10:52 -0400] jacobat: It seems that cookbook dependency management is somewhat weak with chef, is that correct? For instance the statsd recipe assumes version 0.0.1 but it fetches version 0.0.3?
[2012-07-19 09:11:02 -0400] jacobat: Or am I doing something wrong?
[2012-07-19 09:18:44 -0400] cpasmoi: I'm new at chef and have a chef serveur on production (installed by another sysadmin). When I change a recipe inside a cookbook, I don't understand why chef-client doesn't change the file.
[2012-07-19 09:20:08 -0400] workmad3: cpasmoi: you've uploaded the changed cookbook or you're editing it through the webui?
[2012-07-19 09:20:13 -0400] cpasmoi: I use Eclipse / svn, change the cookbook/apache/templates/default/module/httpd.conf.erb
[2012-07-19 09:20:32 -0400] cpasmoi: I have uploaded the cookbook with Eclipse
[2012-07-19 09:20:38 -0400] maruq: cpasmoi: it sort of depends how you're running chef-client - if demonised, it'll grab on next run. if not, you need to run chef-client again on the client
[2012-07-19 09:20:49 -0400] cpasmoi: And I have noticed the repo has been changed in the chef server
[2012-07-19 09:21:01 -0400] cpasmoi: nope, I run chef-client
[2012-07-19 09:21:02 -0400] workmad3: cpasmoi: do you mean you've commited the change to svn?
[2012-07-19 09:21:10 -0400] cpasmoi: workmad3, yes
[2012-07-19 09:21:45 -0400] maruq: cpasmoi: ah, the chef-server doesn't know about svn. you need to "knife cookbook upload <cookbook_name>" from your workstation
[2012-07-19 09:21:49 -0400] cpasmoi: I think but not sure the chef server has also done a svn update
[2012-07-19 09:21:49 -0400] workmad3: cpasmoi: do you know if the other sysadmin set up postcommit hooks to push changes directly to the chef server? if they haven't you need to do that step yourself
[2012-07-19 09:22:03 -0400] workmad3: cpasmoi: the chef server doesn't integrate with svn like that
[2012-07-19 09:22:10 -0400] cpasmoi: humpf
[2012-07-19 09:22:55 -0400] cpasmoi: ok I'll see the external tool "upload cookbook" I use in Eclipse
[2012-07-19 09:23:00 -0400] cpasmoi: it's a ruby script
[2012-07-19 09:23:13 -0400] workmad3: cpasmoi: by not integrating, it means you can put whatever integration you actually need on the repo side (such as svn postcommit hooks, or running a CI build server that tests and pushes)
[2012-07-19 09:23:25 -0400] maruq: cpasmoi: it's a little annoying having to upload to server & source control, but as workmad3 mentioned, you could setup post-receive hooks to upload from svn to chef-serv er
[2012-07-19 09:23:36 -0400] workmad3: cpasmoi: that's probably worthwhile... don't know what that script will contain :)
[2012-07-19 09:24:26 -0400] cpasmoi: a commit is done to the svn repo ; then an svn update is done and a "rake upload_cookbook"
[2012-07-19 09:24:46 -0400] workmad3: cpasmoi: any idea if that rake task actually succeeded?
[2012-07-19 09:24:52 -0400] cpasmoi: ssh #{server} 'svn update /opt/chef_repo/site-cookbooks/#{cookbook};cd /opt/chef_repo;rake upload_cookbook[#{cookbook}] 2>/dev/null
[2012-07-19 09:25:00 -0400] cpasmoi: nope, guess i'll have to find out
[2012-07-19 09:25:04 -0400] maruq: cpasmoi: sounds about right, although if you're doing from cli, I'd say go through knife rather than rake
[2012-07-19 09:25:14 -0400] cpasmoi: oh
[2012-07-19 09:25:34 -0400] workmad3: maruq: the rake task in the default chef repo is a little bit more cookbook-path aware, iirc
[2012-07-19 09:25:44 -0400] workmad3: but yes, I tend to prefer to use knife myself :)
[2012-07-19 09:26:14 -0400] maruq: workmad3: I used to use the rake stuff in 0.8/0.9, but knife is so much better in 10.x
[2012-07-19 09:26:37 -0400] cpasmoi: all the information I get afet svn update and rake are good
[2012-07-19 09:26:43 -0400] maruq: I think it calls rake under the hood, but knife integrates well with oh-my-zsh, so it's easier to use
[2012-07-19 09:26:46 -0400] cpasmoi: INFO: Syntax OK
[2012-07-19 09:26:51 -0400] workmad3: maruq: I never really used earlier than 0.10 :)
[2012-07-19 09:26:57 -0400] cpasmoi: INFO: Upload complete!, for instance
[2012-07-19 09:27:03 -0400] workmad3: maruq: and actually I think the rake task calls knife, not the other way around ;)
[2012-07-19 09:27:14 -0400] maruq: cpasmoi: looks good
[2012-07-19 09:27:22 -0400] maruq: workmad3: hmm interesting
[2012-07-19 09:27:28 -0400] cpasmoi: I also tried to edit the module version on the node, on the web interface of chef server
[2012-07-19 09:27:39 -0400] workmad3: maruq: or, probably more accurately, the rake task uses the same libraries as knife...
[2012-07-19 09:27:40 -0400] cpasmoi: to "force" chef-client
[2012-07-19 09:28:12 -0400] cpasmoi: but if I indeed get other stuff (static tar gz and so one) my httpd.conf will not update
[2012-07-19 09:28:17 -0400] workmad3: cpasmoi: did you increment the version of the cookbook for your change?
[2012-07-19 09:28:39 -0400] workmad3: cpasmoi: and if so, you should check that the environment the node is in isn't specifying the previous version
[2012-07-19 09:28:48 -0400] maruq: cpasmoi: I know that used to be a pain in 0.9.x, you had to bump the version number for the client to pull it down
[2012-07-19 09:29:09 -0400] maruq: I believe 10.x does a hash & checks against the cache I could be wrong though
[2012-07-19 09:29:18 -0400] maruq: I just don't see the issue under 10.x
[2012-07-19 09:29:20 -0400] cpasmoi: btw, newbie question, how do I check the chef server version ?
[2012-07-19 09:30:00 -0400] workmad3: cpasmoi: you have chef webui, yeah?
[2012-07-19 09:30:12 -0400] workmad3: cpasmoi: look at the footer bar ;)
[2012-07-19 09:30:28 -0400] cpasmoi: haha :D
[2012-07-19 09:30:31 -0400] cpasmoi: 0.9
[2012-07-19 09:30:36 -0400] cpasmoi: 0.9.12
[2012-07-19 09:30:57 -0400] workmad3: aha, I've not had experience with 0.9 foibles... I'd take maruq's advice and bump the patch version of the recipe
[2012-07-19 09:31:11 -0400] cpasmoi: What I see when chef-client is invoqued, after having changed the module version :  |-- Found module [wsic]: actual_version - '3.00.0-SNAPSHOT', target_version - '3.12.0-SNAPSHOT'
[2012-07-19 09:31:33 -0400] maruq: cpasmoi: Yeah, I think they fixed the version/cache thing late 0.9, but can't remember. try bumping the version slightly though
[2012-07-19 09:32:25 -0400] cpasmoi: ok, I'll update chef server after having understood everything... It manages about 100 server with half in production
[2012-07-19 09:32:41 -0400] workmad3: cpasmoi: no, not update the chef server
[2012-07-19 09:32:47 -0400] workmad3: cpasmoi: update your cookbook's version
[2012-07-19 09:32:55 -0400] cpasmoi: mheh, sorry
[2012-07-19 09:33:19 -0400] workmad3: cpasmoi: in your cookbook's metadata, it specifies the version... just bump the patch number and re-upload :)
[2012-07-19 09:33:20 -0400] maruq: cpasmoi, workmad3: yeah, updating the cookbook version is a lot easier ;)
[2012-07-19 09:33:32 -0400] cpasmoi: ^^
[2012-07-19 09:33:38 -0400] maruq: 0.0.1 -> 0.0.2 should fix things
[2012-07-19 09:33:57 -0400] workmad3: yes... I've had 'issues' with upgrading chef server versions in the past :)
[2012-07-19 09:34:32 -0400] workmad3: it made me glad I'd invested the time to keep my node info in my chef repo too, and that chef server setup from scratch is pretty easy :)
[2012-07-19 09:35:09 -0400] cpasmoi: oh, damnit. On the web gui I get "undefined method `fdiv' for 0:Fixnum" on my apache cookbook page
[2012-07-19 09:35:26 -0400] cpasmoi: workmad3, noted :-)
[2012-07-19 09:38:31 -0400] maruq: cpasmoi: Not seen that one before, google says it's a ruby error with parsing something to decimal
[2012-07-19 09:38:41 -0400] maruq: perhaps set the version number wrong
[2012-07-19 09:38:42 -0400] maruq: ?
[2012-07-19 09:41:57 -0400] cpasmoi: hum, is the cookbook's version need to be changed with the web gui or with knife ?
[2012-07-19 09:42:34 -0400] cpasmoi: sorry if it sounds like newbie, I'm dealing with chef for three day (and have 4 tabs of opscode wiki opened)
[2012-07-19 09:44:29 -0400] Adz: change it in metadata.rb
[2012-07-19 09:46:50 -0400] maruq: cpasmoi: well, it's good that you found the irc on day 3. took me a little while longer ;)
[2012-07-19 09:47:02 -0400] cpasmoi: I'm always on irc :D
[2012-07-19 09:47:20 -0400] maruq: chef was one of the main reasons I joined IRC really
[2012-07-19 09:47:34 -0400] cpasmoi: As i'm new in this compagny, took me one day to install my workstation
[2012-07-19 09:47:56 -0400] cpasmoi: oh ! version "0.1"
[2012-07-19 09:48:11 -0400] cpasmoi: it is perhaps the seed of the ruby error
[2012-07-19 09:48:44 -0400] maruq: I'd try 0.1.0 and see if that fixes
[2012-07-19 09:49:50 -0400] cpasmoi: still have the undefined method
[2012-07-19 09:49:58 -0400] cpasmoi: trying a chef client
[2012-07-19 09:50:06 -0400] workmad3: cpasmoi: one day to set up a workstation isn't too bad in my experience :)
[2012-07-19 09:50:47 -0400] cpasmoi: had some workarounds with debian, and i then upgraded from stable to sid
[2012-07-19 09:55:15 -0400] cpasmoi: after a chef-client : "INFO: Storing updated cookbooks/apache/metadata.rb in the cache."
[2012-07-19 09:55:24 -0400] cpasmoi: still, my conf file isn't updated
[2012-07-19 09:59:33 -0400] cpasmoi: nevermind for the moment, I just changed myself the httpd.conf and reloaded apache :)
[2012-07-19 09:59:47 -0400] cpasmoi: I'll check this "ussue" when i'll be more efficient
[2012-07-19 10:00:56 -0400] stevage: I have a really dopey question: how do I specify different attributes that should apply for a particular node?
[2012-07-19 10:01:35 -0400] stevage: I've been all over the doco, but it's not very explicit - I see there are different kinds of precedence etc, but there's no example that shows how to define attributes that override the default
[2012-07-19 10:01:50 -0400] stevage: do they go in a different file in /attributes/?
[2012-07-19 10:02:06 -0400] stevage: or do I use logic in attributes/default.rb, like: if node["hostname"] ...
[2012-07-19 10:02:14 -0400] stevage: or do I need to use environments or roles?
[2012-07-19 10:04:52 -0400] workmad3: stevage: set the attributes on the node
[2012-07-19 10:05:08 -0400] stevage: sure - how?
[2012-07-19 10:05:18 -0400] workmad3: stevage: you can do it either from the knife command line or by editing the node in the chef web ui
[2012-07-19 10:05:39 -0400] stevage: not by editing a file?
[2012-07-19 10:07:47 -0400] workmad3: stevage: you can store node info in json files and upload them, yes
[2012-07-19 10:08:06 -0400] workmad3: stevage: or you can open the editor directly with knife for a node, or you can use the web ui
[2012-07-19 10:08:32 -0400] stevage: well, I'd like to end up with all the configuration stored in text files
[2012-07-19 10:08:40 -0400] stevage: sort of the point of chef, no?
[2012-07-19 10:08:45 -0400] RoboticCheese: y
[2012-07-19 10:08:57 -0400] RoboticCheese: Whoa, that was the wrong window.
[2012-07-19 10:09:11 -0400] _rc: if you do it that way you lose some of the more useful dynamic features
[2012-07-19 10:09:13 -0400] workmad3: stevage: yes, however nodes occupy a slightly peculiar role in that picture
[2012-07-19 10:09:32 -0400] workmad3: stevage: namely that chef helps remove the individuality of nodes
[2012-07-19 10:09:49 -0400] maruq: stevage: you can also set attributes in roles (if it's more role based data than individual node data)
[2012-07-19 10:10:22 -0400] stevage: well, at the moment I'm still experimenting, so I'm not sure
[2012-07-19 10:10:46 -0400] maruq: stevage: are you ever going to have multiple nodes that will need this data?
[2012-07-19 10:10:59 -0400] stevage: I'm deploying a system I've tested locally, onto an openstack server - and it needs a few different properties to reflect the fact it's not on my laptop
[2012-07-19 10:11:00 -0400] maruq: e.g. more than one of this server type?
[2012-07-19 10:11:07 -0400] workmad3: stevage: yeah, I personally store node specific info in json files in my chef repo... but I'm aware that I'm keeping some node individuality with that approach still :)
[2012-07-19 10:11:24 -0400] stevage: maruq: well, it's a learning experience, so I'll want to know how to do it eitherway
[2012-07-19 10:11:34 -0400] workmad3: stevage: oh, you can also provide host-specific config files in cookbooks (almost forgot about that)
[2012-07-19 10:11:47 -0400] stevage: yeah, maybe that's what I'm looking for.
[2012-07-19 10:12:04 -0400] stevage: I could have sworn I once saw a naming convention like platform_host_something.rb
[2012-07-19 10:12:07 -0400] stevage: but I can't find it anywhere
[2012-07-19 10:12:17 -0400] workmad3: stevage: http://wiki.opscode.com/display/chef/Templates <-- template location specificity section
[2012-07-19 10:12:20 -0400] maruq: stevage: personally, I'd start with 2 roles (dev & server) and set the things different for each
[2012-07-19 10:12:30 -0400] workmad3: but yeah, ^^ is another option
[2012-07-19 10:12:43 -0400] maruq: then when ready, you could refactor some of that into the cookbook if you need to
[2012-07-19 10:12:55 -0400] workmad3: although thinking about it, if you're playing with a new chef, I'd probably suggest starting out with environments rather than roles for that
[2012-07-19 10:12:59 -0400] maruq: eg. if running in env x, do foo, else do bar
[2012-07-19 10:13:03 -0400] workmad3: development and production env
[2012-07-19 10:13:24 -0400] workmad3: there's lots of axes you can go along for determining the exact config for a node, basically
[2012-07-19 10:13:41 -0400] workmad3: and the option of last resort is to set node-specific attributes :)
[2012-07-19 10:14:50 -0400] stevage: yeah, thanks
[2012-07-19 10:15:02 -0400] stevage: Templates must be what I was remembering - not useful for me right now I think though
[2012-07-19 10:15:28 -0400] stevage: are templates the only things that use names to work out which file is used?
[2012-07-19 10:15:38 -0400] stevage: can you do the same thing with recipes?
[2012-07-19 10:36:21 -0400] workmad3: stevage: if you want a different recipe, you should write a second recipe in the cookbook (maybe called server) and apply that recipe to the node
[2012-07-19 11:32:17 -0400] railsraider: hi have apt cookbook first in my run list , and it's being skipped in chef-run any one knows how to force it?
[2012-07-19 11:44:06 -0400] yfeldblum: railsraider, how do you know it's being skipped?
[2012-07-19 11:45:42 -0400] justin-io: hi guys, how can I add and then execute a file to a recipe ?
[2012-07-19 11:45:43 -0400] railsraider: yfeldblum: cause if i have apt in a single recipe i see the apt-get update runs, but when its in a role => Run List expands to [apt, hosts, sshd, users::admin, bashrc, sudo, vim, locate, arno-iptables-firewall, htop, screen, ssmtp, rkhunter] the next line is INFO: Processing package[libxslt-dev] action install (hosts::default line 2)
[2012-07-19 11:48:30 -0400] yfeldblum: is some other recipe asking for package[libxslt-dev] to be converged during the recipe compilation phase?
[2012-07-19 12:02:14 -0400] railsraider: yfeldblum: only rvm but it's not on the basic-setup role
[2012-07-19 12:03:46 -0400] yfeldblum: railsraider, does one recipe include another that converges this resource as compile time?
[2012-07-19 12:04:27 -0400] railsraider: yfeldblum: you mean the apt resource?
[2012-07-19 12:05:08 -0400] yfeldblum: railsraider, no, package[libxslt-dev]
[2012-07-19 12:05:12 -0400] railsraider: no
[2012-07-19 12:05:27 -0400] railsraider: i made a search on the entire repo, its only in hosts
[2012-07-19 12:07:35 -0400] workmad3: railsraider: is the hosts recipe maybe forcing the package install to happen at compile time rather than runtime?
[2012-07-19 12:08:04 -0400] railsraider: yes, i need it to install in run time,  workmad3
[2012-07-19 12:08:26 -0400] railsraider: but why does it skip apt cookbook
[2012-07-19 12:08:45 -0400] workmad3: railsraider: no, I'm asking is the install happening at compile time of the chef run, rather than run time?
[2012-07-19 12:09:11 -0400] workmad3: railsraider: so if you're doing something like 'pkg = package "libxslt-dev"; pkg.run(:install)'
[2012-07-19 12:09:36 -0400] railsraider: workmad3: http://pastie.org/4283478
[2012-07-19 12:09:49 -0400] workmad3: railsraider: right, so yes
[2012-07-19 12:10:35 -0400] workmad3: railsraider: that means your installs for those packages will happen as soon as the recipe is being parsed, rather than waiting for all the recipes to be parsed (the compile phase)
[2012-07-19 12:10:36 -0400] railsraider: workmad3:  sorry didn't get you,
[2012-07-19 12:11:03 -0400] railsraider: ok, so if i need apt-get update before that?
[2012-07-19 12:11:04 -0400] workmad3: railsraider: a chef has a 2-phase
[2012-07-19 12:11:13 -0400] workmad3: *a chef-client run has 2 phases
[2012-07-19 12:11:32 -0400] workmad3: railsraider: you'd need to force the apt-get update to run in the same way
[2012-07-19 12:11:51 -0400] workmad3: railsraider: or don't do that with those packages, let them get processed normally (is there a reason you need them installed like that?
[2012-07-19 12:11:54 -0400] workmad3: )
[2012-07-19 12:12:28 -0400] railsraider: i need them to be available for fog gem so i can pull a hosts list from backspace and makeup a host file
[2012-07-19 12:12:40 -0400] railsraider: all within hosts cookbook
[2012-07-19 12:13:36 -0400] workmad3: railsraider: ah, so you're using the cookbook itself to install a gem that gets used to provide logic within the cookbook
[2012-07-19 12:13:51 -0400] railsraider: yes correct
[2012-07-19 12:14:07 -0400] railsraider: the gem is installed in  run time and clear gem path is used
[2012-07-19 12:14:15 -0400] railsraider: it works well
[2012-07-19 12:14:34 -0400] workmad3: railsraider: the gem is installed during the compile phase, not the run phase ;)
[2012-07-19 12:15:02 -0400] workmad3: railsraider: and yeah, I've done it before... never happy with it, because it does basically mean things are running out of phase and causes issues like this
[2012-07-19 12:15:24 -0400] railsraider: I'm confused, if i am is staling something in run phase and i have the pat cookbook before the run list why does it skip it?
[2012-07-19 12:15:26 -0400] workmad3: railsraider: you basically need to do the same thing with an apt-get update as you do with the packages
[2012-07-19 12:15:36 -0400] workmad3: railsraider: it isn't skipping it...
[2012-07-19 12:16:00 -0400] workmad3: railsraider: you're installing packages in the *compile* phase, and the apt-get update will get executed in the *run* phase
[2012-07-19 12:18:02 -0400] workmad3: railsraider: basically, by doing that .run(:install) you're deliberatly doing package installs out of order
[2012-07-19 12:19:15 -0400] workmad3: railsraider: the consequence of which is that your ordering is violated... which is why I don't like that style of doing things, but accept it is sometimes necessary
[2012-07-19 12:23:05 -0400] railsraider: workmad3: so if i understand you correctly, on chef-run chef will first run all the recipes that have a run phase action then it will go over the recipes that are comiled?
[2012-07-19 12:23:16 -0400] workmad3: railsraider: no
[2012-07-19 12:23:41 -0400] railsraider: I'm my run list have apt, hosts so apt is first
[2012-07-19 12:23:55 -0400] workmad3: railsraider: on a chef-client run, first the chef-client does a compile phase, which is the process of loading all the recipes, syntax checking them and collecting up all the resource declarations
[2012-07-19 12:24:16 -0400] workmad3: railsraider: and then it performs the run phase, which is the process of executing all your resource declarations in order
[2012-07-19 12:24:28 -0400] workmad3: railsraider: what you have is a package installation that is occuring in the compile phase
[2012-07-19 12:25:00 -0400] workmad3: railsraider: and so it occurs before the execution of any resource declarations in the run phase (including your apt-get update)
[2012-07-19 12:25:33 -0400] railsraider: workmad3: thank you so much for the clarification
[2012-07-19 12:26:41 -0400] workmad3: railsraider: np... it's something that doesn't normally cause you any issues, until you start using tricks like pkg = package("something"); pkg.run(:install); but when you do, it can cause quite a few headaches until you realise about the 2 phase approach and the implications :)
[2012-07-19 12:27:47 -0400] railsraider: workmad3: what;s the right way to do that, do i need to put these libxslt and fog into a separate cookbooks before the hosts?
[2012-07-19 12:28:12 -0400] workmad3: railsraider: unfortunately, there isn't a 'right' way
[2012-07-19 12:28:34 -0400] railsraider: i mean best practice
[2012-07-19 12:28:45 -0400] workmad3: railsraider: you've bypassed the ordering that chef provides, so if you need something run before those actions, you need to do it manually
[2012-07-19 12:29:32 -0400] workmad3: railsraider: which, in your case, probably means something like 'update = execute("apt-get update"); update.run(:run)' (or whatever the action is to run an execute)
[2012-07-19 12:38:08 -0400] chron0: where/how do you add other repos (yum for example in /etc/yum.repo.d/name.repo) to a node before you start actions that would fail without the repos?
[2012-07-19 12:38:21 -0400] railsraider: workmad3:  thanks a lot you really helped me understand
[2012-07-19 12:41:06 -0400] maddoc: chron0: You do it at compile time.
[2012-07-19 12:41:13 -0400] maddoc: chron0: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-07-19 12:42:39 -0400] chron0: so, for example if I wanted to install chrony, but I need a different repo for it I woudl define it in the chrony cookbook as a dep?
[2012-07-19 12:43:54 -0400] maddoc: chron0: It's pretty much the same thing that railsraider and workmad3 discussed.
[2012-07-19 12:44:41 -0400] maddoc: chron0: I created a recipe for adding the repo and then made sure it's done at compile time, then included that recipe.
[2012-07-19 12:44:56 -0400] chron0: maddoc: yeah I figured while I followed, two stage apporach etc.
[2012-07-19 12:45:26 -0400] chron0: maddoc: I see, that seems to make it a bit clearer to me to create  a 2nd recipe within that cookbook
[2012-07-19 12:46:03 -0400] maddoc: chron0: Yeah. I actually have another cookbook for the repos (so it can be reused for other things), but either works.
[2012-07-19 12:46:36 -0400] railsraider: chron0: here you go http://pastie.org/4283599
[2012-07-19 12:46:49 -0400] chron0: maddoc: that is the thing, something as abstract as this is quite overwhelming at first when there are so many ways you can take to go somewhere and you're kinda lost which one to choose :)
[2012-07-19 12:47:35 -0400] maddoc: chron0: Yeah. Good thing is that you can always just incrementally improve things too. :-)
[2012-07-19 12:47:53 -0400] chron0: railsraider: marvellous, thanks a lot I'll play with that and see how far I get
[2012-07-19 12:48:05 -0400] railsraider: chron0:  np
[2012-07-19 12:48:55 -0400] chron0: maddoc: since I have two separate machines for test-server and test-client i cannot mess up too much, but I don't want to learn it the wrong way, because you know how hard bad habits are to break once you've grokked them :)
[2012-07-19 12:49:43 -0400] maddoc: I had to use the "end.run-action(:create)" trick to add the file to /etc/yum.repos.d anyway.
[2012-07-19 12:49:45 -0400] workmad3: chron0: the other option would be to write a definition or lwrp for adding a new repo and running the yum update, which you can then use in other recipes
[2012-07-19 12:50:05 -0400] maddoc: chron0: Very true.
[2012-07-19 12:50:10 -0400] zts: note that the apt_repository LWRP will call apt-get update itself
[2012-07-19 12:50:27 -0400] zts: you shouldn't need to do that from the resource you define
[2012-07-19 12:50:29 -0400] workmad3: chron0: or look for an already existing one :)
[2012-07-19 12:50:43 -0400] zts: same for yum_repository and "yum makecache"
[2012-07-19 12:53:37 -0400] maddoc: Hmm. Can you/how do you append to an attribute that is an array? E.g., I have a role "foo" where I set node[foo] = [ "foo" ], and then I want to be able to add "bar" to node[foo] in the node definition (so when chef runs it becomes node[foo] = [ "foo", "bar" ]).
[2012-07-19 13:00:18 -0400] railsraider: anyone has experience with ubuntu12.04 ? weird that embedded ruby in chef i can't get gem install
[2012-07-19 13:00:52 -0400] railsraider: Gem files will remain installed in /opt/chef/embedded/lib/ruby/gems/1.9.1/gems/nokogiri-1.5.5 for inspection. there's no Ruby or Gem installed
[2012-07-19 13:01:25 -0400] chron0: hmm
[2012-07-19 13:01:27 -0400] chron0: http://pastebin.com/mtApdNLB
[2012-07-19 13:01:55 -0400] chron0: how can I debug this further? the trace file doesn't show anything more
[2012-07-19 13:03:03 -0400] cheeseplus: chron0: run it with "-l debug"
[2012-07-19 13:03:18 -0400] chron0: cheeseplus: thnx
[2012-07-19 13:03:30 -0400] cheeseplus: seems like the package install is probably dying on something
[2012-07-19 13:04:48 -0400] cheeseplus: railsraider: I've got a bit, are you wanting to install a gem into embedded chef?
[2012-07-19 13:06:03 -0400] railsraider: cheeseplus: looks like i need a case node['platform-version'] b/c i get package configuration for libxslt is not found
[2012-07-19 13:06:59 -0400] railsraider: libxslt1-dev is already the newest version.
[2012-07-19 13:07:11 -0400] cheeseplus: ahh
[2012-07-19 13:07:28 -0400] pluesch0r: hi everybody. i've recently changed the interface-configuration on one of my hosts. however, network[:interfaces] still contains information about the old setup. is there a way to tell ohai to override everything that's listed in network[:interfaces] rather than just append information?
[2012-07-19 13:07:58 -0400] cheeseplus: railsraider: I have some casing for stuff like libssl0.9.8 that is required in > 11.10
[2012-07-19 13:08:21 -0400] chron0: cheeseplus: yeah, with -l debug the culprit is quickly identified: GPG key retrieval failed: [Errno 14] Could not open/read file:///etc/pki/rpm-gpg/RPM-GPG-KEY-EPEL-6
[2012-07-19 13:08:49 -0400] cheeseplus: chron0: nice, that has saved me a few times
[2012-07-19 13:15:22 -0400] cheeseplus: pluesch0r: ideally you wouldn't want to override anything in ohai since it's _supposed_ to reflect the state of the system
[2012-07-19 13:15:32 -0400] cheeseplus: a chef-client run should update the ohai attributes though
[2012-07-19 13:15:40 -0400] pluesch0r: cheeseplus: that's why i'm asking. it is not reflecting the state of the system.
[2012-07-19 13:15:48 -0400] pluesch0r: interface names have changed and the old interfaces are still listed.
[2012-07-19 13:16:13 -0400] cheeseplus: and chef-client has run at least once?
[2012-07-19 13:16:17 -0400] cheeseplus: post-change
[2012-07-19 13:16:23 -0400] pluesch0r: of course.
[2012-07-19 13:16:27 -0400] pluesch0r: the new interfaces are there.
[2012-07-19 13:16:43 -0400] pluesch0r: but the old ones aren't pruned.
[2012-07-19 13:17:13 -0400] pluesch0r: also, the old interfaces are NOT listed in the ohai output if i run ohai on that specific host.
[2012-07-19 13:17:34 -0400] pluesch0r: which leads me to think that ohai input is simply added to host attributes instead of replacing those attributes.
[2012-07-19 13:18:05 -0400] pluesch0r: hence my question if it's possible to set some leaf (i.e. host[:network]) to be overwritten by ohai data.
[2012-07-19 13:18:23 -0400] chron0: cool, thanks @ll, now my first test installation via chef is done :)
[2012-07-19 13:20:00 -0400] cheeseplus: pluesch0r: you could definitely override it in the recipe, I'd be more curious why it's not getting pruned - wondering if a knife index rebuild would help
[2012-07-19 13:20:38 -0400] pluesch0r: cheeseplus: but doesn't index rebuild simply hook into solr?
[2012-07-19 13:21:01 -0400] cheeseplus: pluesch0r: yea, it seems like the server is caching the bad/old data
[2012-07-19 13:21:03 -0400] pluesch0r: i mean .. the data is also there when i do a knife node edit
[2012-07-19 13:21:45 -0400] pluesch0r: right. so what do i do to get that crap sorted out? those bogus interfaces are trashing my carefully crafted recipes. ;)
[2012-07-19 13:22:38 -0400] cheeseplus: I mean I get what exactly is wrong now but I honestly haven't had bad data cached like that
[2012-07-19 13:23:25 -0400] pluesch0r: i'm guessing it's because node[:network] doesn't get overwritten but merely merged with new ohai data.
[2012-07-19 13:23:36 -0400] pluesch0r: since the old interfaces don't exist in the new ohai data they don't get removed.
[2012-07-19 13:24:06 -0400] pluesch0r: man. what a pita.
[2012-07-19 13:24:17 -0400] cheeseplus: yea, I don't see why it wouldn't prune them
[2012-07-19 13:25:03 -0400] cheeseplus: I am curious if you nuked the node and brought it back if it would fix, granted that is a nuclear option
[2012-07-19 13:26:51 -0400] pluesch0r: no can do.
[2012-07-19 13:27:15 -0400] pluesch0r: that box is a vital cog in the machine.
[2012-07-19 13:30:19 -0400] cheeseplus: pluesch0r: I figured that was the case, I also just mean doing a knife node delete (not actually rebuilding the machine)
[2012-07-19 13:30:39 -0400] cheeseplus: still could be problematic though and may not solve anything
[2012-07-19 13:30:53 -0400] pluesch0r: well .. it's the same on all boxes.
[2012-07-19 13:32:50 -0400] pluesch0r: i guess i'm just stuck with deleting those keys. sigh.
[2012-07-19 13:35:49 -0400] cheeseplus: pluesch0r: my understanding is that Ohai data is read in last, and if it (ohai) is accurate on the node it should sort itself out
[2012-07-19 13:35:57 -0400] cheeseplus: that is where I am puzzled
[2012-07-19 13:36:04 -0400] pluesch0r: cheeseplus: really? imho ohai data is read in first.
[2012-07-19 13:36:22 -0400] cheeseplus: pluesch0r: http://wiki.opscode.com/display/chef/Attributes
[2012-07-19 13:36:35 -0400] cheeseplus: "default attributes applied in an attributes file have the lowest priority and automatic attributes generated by Ohai have the highest priority."
[2012-07-19 13:36:58 -0400] pluesch0r: yeah well.
[2012-07-19 13:37:03 -0400] pluesch0r: what's more interesting is:
[2012-07-19 13:37:05 -0400] pluesch0r: "saved previously and merge in attributes based"
[2012-07-19 13:37:18 -0400] pluesch0r: so attributes get merged. and that's exactly my problem.
[2012-07-19 13:37:41 -0400] maruq: hi guys. I seem to be getting NullPointerExceptions in my solr / jetty :(
[2012-07-19 13:38:16 -0400] railsraider: seems like bootstrap on 12.04 (chef 10.12) is skipping the build-essentials when bootstrapping
[2012-07-19 13:38:28 -0400] railsraider: yep!
[2012-07-19 13:38:37 -0400] railsraider: it did not install ruby correctly
[2012-07-19 13:39:03 -0400] cheeseplus: pluesch0r: definitely the case, just not finding anything more useful on how to get you out of that bind :(
[2012-07-19 13:42:49 -0400] jwitrick: Question about mysql and centos. I have been trying to use the community mysql cookbook to create a mysql database. The issue is that the root pwd I specify is never set because the only_if condition fails.
[2012-07-19 13:43:49 -0400] alph|work: if I create a user with a recipe and specify the home directory, do I need to create the home directory as well?
[2012-07-19 13:46:53 -0400] railsraider: alph|work: no if you're using the opscode users cookbook
[2012-07-19 13:48:29 -0400] alph|work: hmm, wonder why it's not working then. This is what I'm doing: http://pastie.org/4283887
[2012-07-19 13:48:50 -0400] alph|work: it made the user but the home folder doesn't exist
[2012-07-19 13:49:17 -0400] pluesch0r: cheeseplus: quick question. this whole environment was upgraded to 0.10.* some time ago, we've been using chef since 0.8
[2012-07-19 13:49:28 -0400] pluesch0r: as those normal etc. environments were introduced ..
[2012-07-19 13:49:36 -0400] pluesch0r: after 0.8 ..
[2012-07-19 13:50:15 -0400] pluesch0r: what i'm thinking is .. maybe this whole stale data is from way back when 0.8 clients used to write into what's now the 'normal' context.
[2012-07-19 13:50:23 -0400] pluesch0r: maybe i need to clean my node data or something?
[2012-07-19 13:50:39 -0400] cheeseplus: I can't seem to find anything on cleaning out node data
[2012-07-19 13:51:00 -0400] cheeseplus: I've also not used anything prior to .9 so while curious, I have no idea
[2012-07-19 13:51:22 -0400] pluesch0r: 'cause i also see old lsb data and so on.
[2012-07-19 13:51:30 -0400] pluesch0r: but only when i open the node data with knife node edit.
[2012-07-19 13:52:16 -0400] cheeseplus: I'd love a "knife node clean"
[2012-07-19 13:53:01 -0400] maruq: found my Java NullPointerException issue I'm doing a search based on a node's attribute. forgot to set the attribute. filed under PEBCAK
[2012-07-19 13:57:04 -0400] cheeseplus: pluesch0r: I think you might be right about that data getting written to the normal context causing an issue, I just don't know how to determine if that is 1) the actual case here and 2) how to reset/clean the node data based on what Ohai is actually reporting
[2012-07-19 13:57:41 -0400] pluesch0r: cheeseplus: i think i'll just write a cookbook that unsets all keys that are returned in normal ohai output.
[2012-07-19 13:58:31 -0400] cheeseplus: well that is one way, just seems like it'd be useful to have some kind of normalize/reset action for knife
[2012-07-19 13:58:41 -0400] pluesch0r: sure.
[2012-07-19 14:15:00 -0400] zomGreg: is it possible to create subdirectories under templates/default like templates/default/app1 templates/default/app2 ?
[2012-07-19 14:16:19 -0400] railsraider: zomGreg: use recursive :true
[2012-07-19 14:17:16 -0400] zomGreg: not sure I follow, do you have a link where I can see an example of this?
[2012-07-19 14:24:28 -0400] pluesch0r: for the record: exactly that old data was my problem.
[2012-07-19 14:56:02 -0400] jerem`: how to create a role into a recipe ?
[2012-07-19 14:57:51 -0400] zomGreg: same question for files. can I create subdirectories under files/default and if so how do I access them from recipes?
[2012-07-19 15:00:22 -0400] bdemers_: Can someone point me at a wiki page or something, that shows how to use an encrypted data bag with chef-solo
[2012-07-19 15:01:44 -0400] barefoot: zomGreg: http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-07-19 15:01:50 -0400] geekbri: bdemers_: http://wiki.opscode.com/display/chef/Encrypted+Data+Bags
[2012-07-19 15:03:18 -0400] bdemers_: geekbri: thanks, but how does this work with chef-solo ?
[2012-07-19 15:03:27 -0400] barefoot: http://wiki.opscode.com/display/chef/Data+Bags#DataBags-UsingDataBagswithChefSolo
[2012-07-19 15:03:32 -0400] geekbri: bdemers_: there is a gem I think that will let you use databags with chef solo
[2012-07-19 15:03:42 -0400] geekbri: Or maybe im thinking of search
[2012-07-19 15:03:58 -0400] geekbri: ah there you go, databags can be file loactions, it was search I was thinking about that needs a gem
[2012-07-19 15:04:16 -0400] geekbri: err cookbook
[2012-07-19 15:06:44 -0400] bdemers_: barefoot: I've seen this too, but how does this apply to encrypted data bags ?
[2012-07-19 15:07:04 -0400] pluesch0r: cheeseplus: the cookbook works.
[2012-07-19 15:07:04 -0400] bdemers_: do i configure chef-solo to use a key some how ?
[2012-07-19 15:07:30 -0400] cheeseplus: pluesch0r: for resetting all the attrs?
[2012-07-19 15:07:30 -0400] pluesch0r: cheeseplus: plus, i remembered that we started using chef at 0.7 .. so there was a shitload of legacy attribute stuff ..
[2012-07-19 15:07:34 -0400] pluesch0r: cheeseplus: yeah.
[2012-07-19 15:07:45 -0400] cheeseplus: nice, happen to have a gist?
[2012-07-19 15:07:56 -0400] cheeseplus: seems like something I should file away for a rainy day ;)
[2012-07-19 15:08:37 -0400] pluesch0r: cheeseplus: https://gist.github.com/3144572
[2012-07-19 15:09:19 -0400] pluesch0r: i'm aware it could be written differently but as that type of action is rather delicate i opted for not iterating over a %w(ipaddress os ..) ;)
[2012-07-19 15:10:52 -0400] cheeseplus: yea, I like running a smaller scope if most of it is good
[2012-07-19 15:12:00 -0400] barefoot: bdemers_: ah sorry not sure if you can
[2012-07-19 15:12:40 -0400] bdemers_: it seems that way.  If some else has any ideas let me know
[2012-07-19 15:15:40 -0400] barefoot: bdemers_: might be able to just decrypt on the fly via script blocks or something? not sure what you are trying for
[2012-07-19 15:16:55 -0400] bdemers_: ultimately what i'm trying to do is test a few cookbooks with vagrant and chef-solo, before deploying to our server
[2012-07-19 15:17:28 -0400] bdemers_: i have seen release notes that says this should work, but nothing that shows how to configure it
[2012-07-19 15:19:01 -0400] barefoot: bdemers_: https://github.com/mitchellh/vagrant/pull/816
[2012-07-19 15:21:12 -0400] bdemers_: barefoot: thanks, I've seen that too, I just don't understand how to tie it all together
[2012-07-19 15:27:37 -0400] zomGreg: barefoot: I'm not sure cookbook_file is the way to go with a directory like cookbook_name/files/default/directory. I've been using remote_directory for that.
[2012-07-19 15:27:38 -0400] chron0: when you configure your ntp servers AND use more than one ntp server in you ntpd.conf, how do you declare them? In databags? If so, how do you use more than one? All examples in the wiki always show just one value
[2012-07-19 15:36:55 -0400] jperry2: ohai chefs
[2012-07-19 15:46:15 -0400] behemphi: chron0 I am pretty sure this line of code (23 from the default attrib file) is the one you are looking for
[2012-07-19 15:46:17 -0400] behemphi: default['ntp']['servers']   = %w{ 0.pool.ntp.org 1.pool.ntp.org 2.pool.ntp.org 3.pool.ntp.org }
[2012-07-19 15:46:24 -0400] behemphi: https://github.com/opscode-cookbooks/ntp/blob/master/attributes/default.rb
[2012-07-19 15:54:54 -0400] chron0: behemphi: cheers - I'll have a look into it, new to ruby, new to chef, it's kinda hard to figure out heads and tails :)
[2012-07-19 15:55:34 -0400] behemphi: I was there a year ago and still pretty rough on the edges
[2012-07-19 15:55:54 -0400] behemphi: the %w{} construct is Ruby shortcut for an array of strings
[2012-07-19 15:56:06 -0400] behemphi: they are space delimited
[2012-07-19 15:56:38 -0400] chron0: I see, since I don't use ntp but chrony I had to write a new cookbook any try to use the exercise to see how strings and arrays are going to get inserted into the real configuration :)
[2012-07-19 15:56:43 -0400] behemphi: I am an IDE fan, and it helped me to use RubyMine (by JetBrains) for the 30 day trial to learn my way around ruby
[2012-07-19 15:57:56 -0400] behemphi: my general workflow there is create an attribute for anything I might want to override in attributes/default.rb
[2012-07-19 15:58:07 -0400] chron0: ack
[2012-07-19 15:58:14 -0400] behemphi: then override it in a recipe if, by logic, I need to
[2012-07-19 15:58:22 -0400] jtimberman: behemphi: good idea :D
[2012-07-19 15:58:28 -0400] jtimberman: behemphi: or override via a role.
[2012-07-19 15:58:34 -0400] behemphi: but there are guys in here that can likely give you a better idea
[2012-07-19 15:58:36 -0400] jtimberman: general advise, use "default" most of the time
[2012-07-19 15:58:45 -0400] jtimberman: s/advise/advice/
[2012-07-19 15:58:56 -0400] behemphi: @jtimberman: I need to get more sophisticated with the use of a role for sure!  Thanks for the reminder
[2012-07-19 15:59:14 -0400] jtimberman: behemphi: you're on the right track though
[2012-07-19 15:59:18 -0400] behemphi: mmm   more coffee  mmm
[2012-07-19 15:59:31 -0400] jtimberman: any value you have in a configuration file, for example, that you might want to change from the default should probably be an attribute.
[2012-07-19 15:59:45 -0400] jtimberman: like, the port to listen on, number of workers/threads, amounts of memory (can be calculated)
[2012-07-19 16:08:01 -0400] barefoot: zomGreg: read past "subdirectories" my bad :)
[2012-07-19 17:18:44 -0400] zomGreg: yep, np. I fat fingered my file name anyway so it was quite messed up from the beginning.
[2012-07-19 17:18:53 -0400] zomGreg: I have lusis as my typing coach now. ;)
[2012-07-19 17:19:28 -0400] lusis: if zomGreg could type, he'd never call me.
[2012-07-19 17:19:31 -0400] lusis: and I'd be lonely
[2012-07-19 17:19:32 -0400] lusis: and sad
[2012-07-19 17:44:30 -0400] erratic: anybody had problems with the community mysql cookbook (site cook book? )
[2012-07-19 17:45:00 -0400] heydrick: are search results sorted in any way?
[2012-07-19 17:45:54 -0400] heydrick: will I get different order in different runs?
[2012-07-19 17:47:53 -0400] lusis: possibly. Not sure if they're ordered server side or not
[2012-07-19 17:48:48 -0400] jwitrick: erratic: yes have also been having issues on a centos box.
[2012-07-19 17:49:15 -0400] erratic: jwitrick Im thinking about just making my own
[2012-07-19 17:49:24 -0400] erratic: it works fine for the most part but its way too bloated I think
[2012-07-19 17:49:30 -0400] erratic: what I need is pretty simple
[2012-07-19 17:49:48 -0400] jwitrick: so i used to make my own but now i realize that using the community ones are much better in the long run.
[2012-07-19 17:50:11 -0400] erratic: its like the only one Ive ever had problems with and initally I had problem with percona cookbooks conflicting with the mysql cookbook but I fixed that
[2012-07-19 17:50:12 -0400] jwitrick: the only issue i have been having with the community cookbook is that on centos it never sets the root pwd.
[2012-07-19 17:50:34 -0400] jwitrick: so that keeps the rest of what im doing from working.
[2012-07-19 17:50:36 -0400] erratic: well yeah
[2012-07-19 17:51:02 -0400] erratic: thats my problem too and sometimes it *does* actually set the password and sometimes it gets changed and sometimes it doesn't work right on 12.04 but does on 11.10
[2012-07-19 17:51:04 -0400] erratic: its weird
[2012-07-19 17:51:34 -0400] erratic: ideally I would have this cookbook stop mysql and start it with --skip-grant-tables in safe mode and change the root password if it can't connect with the root password that is set in chef overrides.
[2012-07-19 17:52:10 -0400] jwitrick: Ya that is how i have been doing it manually. but it seems to have issues doing that also.
[2012-07-19 17:52:12 -0400] erratic: I need the root password to be the same on all of my servers
[2012-07-19 17:52:41 -0400] jwitrick: i have sent an email to the mailing list. so hopefully someone in the community (or opscode) will respond with a solution
[2012-07-19 18:27:16 -0400] freerobby1: I have a question about the timestamped_deploy cookbook. The "migration_command" seems to execute before the current directory is symlinked and from one directory level above the actual release folder. If my migrate command is something like "rake db:migrate", how can I get it to execute from the newly-deployed folder?
[2012-07-19 18:41:35 -0400] yfeldblum: this channel needs more FUD
[2012-07-19 18:42:00 -0400] yfeldblum: it needs a FUD Fight
[2012-07-19 18:42:00 -0400] hoover_damm: I will not stand for an America where 24-hour news networks and oil cartels can make a mockery of our American workforce.
[2012-07-19 18:42:10 -0400] hoover_damm: When I'm elected, I'll make sure al-Qaeda insurgents and Taliban militants cannot take away our hard-working teachers.
[2012-07-19 18:42:23 -0400] yfeldblum: hoover_damm, i disagree with everything you say
[2012-07-19 18:42:28 -0400] hoover_damm: My opponent is conspiring with Wall Street insiders, pot smokers and violent criminals.
[2012-07-19 18:42:39 -0400] StormSilver: yfeldblum: I disagree with everything YOU say.
[2012-07-19 18:42:48 -0400] StormSilver: And with everything hoover_damm says. :)
[2012-07-19 18:42:59 -0400] hoover_damm: We will steadfastly and unceasingly procure XML-compliant knowledge bases for today's data-driven corporations.
[2012-07-19 18:43:00 -0400] ivey: I heard Microsoft was buying Opscode
[2012-07-19 18:43:16 -0400] hoover_damm: ivey, that's good FUD
[2012-07-19 18:43:23 -0400] freerobby1: Is there any reason/advantage to doing migration/restart/symlink blocks within the timestamped_deploy action and not immediately after it?
[2012-07-19 18:43:24 -0400] ivey: thanks. heavy on the F
[2012-07-19 18:43:25 -0400] StormSilver: hoover_damm: That just made me twitch.
[2012-07-19 18:43:36 -0400] freerobby1: it seems like a complete mess trying to figure out what paths are what in the middle of the timestamped_deploy actions
[2012-07-19 18:44:30 -0400] freerobby1: migration_command's default working directory is neither the past nor the new app directory, for instance. release_path is available to migration_command but not before_restart
[2012-07-19 18:44:35 -0400] StormSilver: freerobby1: the timestamped_deploy provider gives you some methods with resolve those paths for you.
[2012-07-19 18:44:35 -0400] geekbri: hoover_damm, yfeldblum: I disagree with both of you
[2012-07-19 18:44:38 -0400] hoover_damm: StormSilver, http://phrasegenerator.com/
[2012-07-19 18:44:54 -0400] geekbri: I heard oracle linux is going to replace ubuntu as the OS of choice for cloud computing.
[2012-07-19 18:44:58 -0400] hoover_damm: I apologize for my spam
[2012-07-19 18:45:47 -0400] freerobby1: StormSilver: Thanks, I see there is release_path; do you feel there's an advantage to doing all of this in the middle of the deploy LWRP?
[2012-07-19 18:47:02 -0400] StormSilver: freerobby1: Well, it's handy if you need to do things at those points in the deployment lifecycle. Otherwise your app is live and serving traffic before you've migrated, or generated assets, or whatever.
[2012-07-19 18:47:31 -0400] erratic: wow bash.org is so slow
[2012-07-19 18:47:57 -0400] freerobby1: StormSilver: I see. We're on jruby, using the timestamped_deploy lwrp to basically stage the next release, so I guess we have it easy since our official deploy comes later.
[2012-07-19 18:48:02 -0400] yfeldblum: XML and XSLT are the future
[2012-07-19 18:48:03 -0400] cwj: slow quotes
[2012-07-19 18:48:27 -0400] yfeldblum: every future programming language and configuration file format will be written in an XML dialect by 2015
[2012-07-19 18:48:28 -0400] erratic: cwj ya
[2012-07-19 18:49:02 -0400] erratic: yfeldblum a little part of me just died
[2012-07-19 18:49:12 -0400] behemphi: B/c I am curious I will "out" myself.  I love XML and think it is an awesome technology.  Why the hate?
[2012-07-19 18:50:18 -0400] yfeldblum: <sentence><clause><subject>I</subject><verb>do not hate</verb><direct-object>XML</direct-object></clause>.</sentence>
[2012-07-19 18:50:18 -0400] erratic: why the <extra></extra><unecesarry></unecesarry><tags /><and />< stuff />
[2012-07-19 18:50:19 -0400] hoover_damm: behemphi, most people hate on XML...
[2012-07-19 18:50:23 -0400] geekbri: yfeldblum: Borland c++ builder will be the IDE of the future
[2012-07-19 18:50:29 -0400] hoover_damm: behemphi, it's the unfortunate problem of not wanting to 'describe'
[2012-07-19 18:50:42 -0400] yfeldblum: geekbri, fine by me; i'm OK with not using IDEs
[2012-07-19 18:50:43 -0400] hoover_damm: behemphi, you tell most sysadmins to describe their infra and they will grunt and
[2012-07-19 18:50:47 -0400] hoover_damm: behemphi, likely walk away
[2012-07-19 18:50:49 -0400] erratic: I kinda like xml too but its not necesarry for everything
[2012-07-19 18:50:55 -0400] erratic: and its not always done right
[2012-07-19 18:51:05 -0400] erratic: and its not always accompanied by an xsd which makes it awesome
[2012-07-19 18:51:09 -0400] behemphi: That is the key for me.  Well designed XML is self describing
[2012-07-19 18:51:22 -0400] hoover_damm: behemphi, indeed
[2012-07-19 18:51:24 -0400] geekbri: well designed XML can stll make your eyes bleed and joints hurt.
[2012-07-19 18:51:35 -0400] hoover_damm: behemphi, basically there are haters on xml and they are wrong
[2012-07-19 18:51:45 -0400] hoover_damm: behemphi, they care too much
[2012-07-19 18:51:47 -0400] erratic: geekbri yaml
[2012-07-19 18:52:11 -0400] Majost: geekbri: "well designed xml" -- is that an oxymoron?
[2012-07-19 18:52:12 -0400] behemphi: Well to jump on another trolling  post as sec ago, a good IDE can keep ones eyes from bleeding (though granted they will still get red)
[2012-07-19 18:52:15 -0400] erratic: and json
[2012-07-19 18:52:18 -0400] erratic: json is ok
[2012-07-19 18:52:20 -0400] yfeldblum: behemphi, i have a few problems with using XML myself, and they generally have to do with there being various mismatches between data as described in XML and data as we typically deal with it in programs
[2012-07-19 18:52:23 -0400] erratic: Id rather used yaml for some things
[2012-07-19 18:52:25 -0400] geekbri: Nokia's mobile market share is too great, no cell phone maker will ever be able to dethrone them.
[2012-07-19 18:52:46 -0400] cwj: heheh
[2012-07-19 18:52:46 -0400] Majost: yaml is better suited for streaming... which isn't really the case here.
[2012-07-19 18:53:03 -0400] hoover_damm: behemphi, i edit my xml in emacs
[2012-07-19 18:53:05 -0400] hoover_damm: my eyes don't go red
[2012-07-19 18:53:07 -0400] behemphi: yfeldblum:  can you be more specific
[2012-07-19 18:53:22 -0400] hoover_damm: behemphi, i have had to deal with infrastructures described in xml
[2012-07-19 18:53:26 -0400] hoover_damm: read by ruby
[2012-07-19 18:53:28 -0400] behemphi: When I was running eXist as an XML DB, I sued XMLspy
[2012-07-19 18:53:29 -0400] geekbri: Isn't editing XML in emacs a sign of the apocalypse coming ?
[2012-07-19 18:53:29 -0400] hoover_damm: 100% worked
[2012-07-19 18:53:46 -0400] hoover_damm: geekbri, was that really required?
[2012-07-19 18:54:03 -0400] yfeldblum: behemphi, JSON matches one-to-one with the simplest data types and structures which we commonly use when writing programs
[2012-07-19 18:54:07 -0400] hoover_damm: I really find the people digging and trolling on emacs to be really tiresome
[2012-07-19 18:54:11 -0400] behemphi: So to join the club:  Emacs will supplant Vi as the default editor of Unix :-)
[2012-07-19 18:54:14 -0400] hoover_damm: there are etter things to care about
[2012-07-19 18:54:23 -0400] hoover_damm: better*
[2012-07-19 18:54:24 -0400] yfeldblum: behemphi, XML is a lot more complicated than that
[2012-07-19 18:54:53 -0400] yfeldblum: behemphi, maybe it's better for serializing objects
[2012-07-19 18:55:13 -0400] knuckolls: yfeldblum: strongly typed objects
[2012-07-19 18:55:33 -0400] erratic: Im a bigger troll than anybody here :(
[2012-07-19 18:55:56 -0400] knuckolls: in dynamic languages, just slapping data in and out of json or yaml is just simpler and easier to parse. xml gets overly laden with class and type information in my experience.
[2012-07-19 18:56:03 -0400] behemphi: yfeldum:  I agree but to try and do a config with it is difficult at best (i.e. no way to even include comments in the code) and if trying to use as a data store reading the raw format means having a very intimate knowledge of the data or having to read code that could be expressing the relationships incorrectly (if working on someone elses mess)
[2012-07-19 18:56:17 -0400] yfeldblum: knuckolls, strongly-typed objects in particular, but also weakly-typed objects too to some extent
[2012-07-19 18:56:21 -0400] behemphi: I am on board with the idea of simplicity
[2012-07-19 18:56:30 -0400] behemphi: esp for data transport on the web.
[2012-07-19 18:56:58 -0400] behemphi: but for a config file that _must_ be right and _must_ be well understood, XML seems to be a better choice (Tomcat not withstanding!)
[2012-07-19 18:57:06 -0400] yfeldblum: behemphi, oh absolutely, i prefer alternatives for specific use-cases: specifically, serializing data
[2012-07-19 18:57:12 -0400] dwhsix: wow so many religious arguments we could be having right now emacs vi xml ;-)
[2012-07-19 18:57:16 -0400] erratic: I like the idea of things just working one way and not having multiple configuration options and just working out of the box
[2012-07-19 18:57:25 -0400] erratic: you're welcome
[2012-07-19 18:57:31 -0400] Jay_Levitt: zsh!
[2012-07-19 18:57:41 -0400] yfeldblum: behemphi, because it's really easy to roundtrip data to and from JSON in exactly one way
[2012-07-19 18:57:43 -0400] dwhsix: at least we all agree on ORCL MSFT *ducks*
[2012-07-19 18:57:49 -0400] hoover_damm: behemphi, apache markup is nice
[2012-07-19 18:58:41 -0400] yfeldblum: behemphi, XML is alright for config files, but it feels rather verbose in general to me so i would prefer, when hand-writing config files or config file templates, if they could be shorter
[2012-07-19 18:59:01 -0400] yfeldblum: behemphi, if i've got a DSL for generating the XML, though, then i don't much care
[2012-07-19 18:59:12 -0400] Majost: In the context of chef, I would like the json or whatever backend to be completely transparent. The JSON throws a learning curve in when you look at readme.md and other docs which give ruby usage examples which need to be converted by the user to working JSON for roles and whatnot.
[2012-07-19 18:59:34 -0400] behemphi: So let me come at my question from another angle as well.  To my knowledge there is nothing for Json like RelaxNG
[2012-07-19 19:00:00 -0400] behemphi: so there is no stand technology out there to insure my data structure is consistent
[2012-07-19 19:00:15 -0400] erratic: Majost do you use the web ui at all?
[2012-07-19 19:00:17 -0400] geekbri: It is clear to me that by the conclusion of this conversation we will all have agreed on one single markup language as superior to all the others.  That will be the only one we all use from this point forward.
[2012-07-19 19:00:21 -0400] Majost: erratic: nope
[2012-07-19 19:00:32 -0400] StormSilver: geekbri: Haha, yes!
[2012-07-19 19:00:35 -0400] hoover_damm: geekbri, stop trolling
[2012-07-19 19:00:37 -0400] Majost: erratic: but I can start
[2012-07-19 19:00:43 -0400] yfeldblum: behemphi, something like that does need to be built for json, sure
[2012-07-19 19:01:00 -0400] hoover_damm: geekbri, besides murphy says the moment everyone agrees ona markup language... microsoft will push another one on us with force
[2012-07-19 19:01:07 -0400] yfeldblum: behemphi, but i'm not saying json for config files is ideal for me either
[2012-07-19 19:01:08 -0400] hoover_damm: so becareful what you wish for
[2012-07-19 19:01:26 -0400] dwhsix: <proposal land="en-us">all further discussions in channel must be marked up</proposal>
[2012-07-19 19:01:28 -0400] doomviking: lets go back to xml
[2012-07-19 19:01:31 -0400] dwhsix: gah
[2012-07-19 19:01:32 -0400] behemphi: I suppose I should say I am not "promoting" XML, just wondering at all the hate
[2012-07-19 19:01:33 -0400] dwhsix: *lang
[2012-07-19 19:01:43 -0400] geekbri: I plan on writing my will in XML
[2012-07-19 19:01:44 -0400] hoover_damm: behemphi, overcare
[2012-07-19 19:01:47 -0400] hoover_damm: behemphi, that's all it is
[2012-07-19 19:01:58 -0400] dwhsix: geekbri: I once maintained my resume in XML
[2012-07-19 19:02:06 -0400] behemphi: lol
[2012-07-19 19:02:10 -0400] dwhsix: use XSLT to generate other formats
[2012-07-19 19:02:15 -0400] behemphi: OK, back on topic for me :-)
[2012-07-19 19:02:22 -0400] dwhsix: I was so cutting edge
[2012-07-19 19:02:24 -0400] dwhsix: ok, ok
[2012-07-19 19:03:46 -0400] yfeldblum: behemphi, my hate? it's verbose: writing it by hand is annoying
[2012-07-19 19:05:26 -0400] yfeldblum: behemphi, and for data: its structure is too complex; if it were simpler, then data-in-memory <--> data-serialized mappings would be simple and automatic
[2012-07-19 19:05:42 -0400] yfeldblum: behemphi, for other cases, or for cases where it's machine-generated? *shrug*
[2012-07-19 19:06:11 -0400] geekbri: XML is like the ford taurus, It was very influentel when it was created, its been reliable and is good at what it was made for.  However sometimes it can be pretty unpleasant to look at, and is certainly not sexy.
[2012-07-19 19:06:26 -0400] cheeseplus: geekbri: bravo
[2012-07-19 19:07:07 -0400] geekbri: Now its losing some of its market share to the Honda civics and Volkswagen jettas of the world (json, yml)
[2012-07-19 19:07:17 -0400] dwhsix: geekbri: well said
[2012-07-19 19:07:51 -0400] anthroprose: how dare you call json a civic!
[2012-07-19 19:07:55 -0400] geekbri: hehe
[2012-07-19 19:08:07 -0400] geekbri: feel free to swap those at your leisure.
[2012-07-19 19:08:41 -0400] yfeldblum: one thing i wonder about is the blizzard / wow website was at one point done in XML + XSLT
[2012-07-19 19:08:55 -0400] yfeldblum: i wonder why they chose that? what were the pros and what were the cons?
[2012-07-19 19:09:13 -0400] cheeseplus: yfeldblum: blizzard does some crazy things for no other reason than to do them
[2012-07-19 19:09:20 -0400] anthroprose: their content probably drove the web, and documentation
[2012-07-19 19:09:23 -0400] geekbri: I exclusively serialize all of my data in WDDX
[2012-07-19 19:09:26 -0400] anthroprose: marketing etc...
[2012-07-19 19:10:27 -0400] anthroprose: Just protobuf everything into k:v stores for fun
[2012-07-19 19:10:45 -0400] cheeseplus: anthroprose: hell yes
[2012-07-19 19:11:01 -0400] behemphi: XML + XSLT is pretty common for speed
[2012-07-19 19:11:16 -0400] behemphi: and it makes re-styling a site (think marketing making tweeks) much easier
[2012-07-19 19:11:16 -0400] anthroprose: haha... thats been my answer to all the new dynamo/riak type stuff... "Well just put your key into protobuf!"
[2012-07-19 19:11:19 -0400] anthroprose: i hope people dont listen
[2012-07-19 19:11:31 -0400] paigeat: geekbri does that mean yaml is like a daewoo
[2012-07-19 19:11:38 -0400] anthroprose: or a Subaru
[2012-07-19 19:11:41 -0400] geekbri: paigeat: if thats what you want it to be!
[2012-07-19 19:11:46 -0400] paigeat: lol
[2012-07-19 19:12:07 -0400] geekbri: As long as you leave the ford taurus part of my analogy alone, i wont complain too much
[2012-07-19 19:12:20 -0400] geekbri: I suppose CSV's are like the Ford Model T's
[2012-07-19 19:12:32 -0400] anthroprose: FIXED COLUMN
[2012-07-19 19:13:37 -0400] paigeat: sqlite is like a saturn
[2012-07-19 19:14:04 -0400] cheeseplus: anthroprose: as someone in the riak camp, totally put in protobuffs :P
[2012-07-19 19:14:28 -0400] anthroprose: cheese: so this is viable eh? I havn't gotten that far yet.... just everyone around town complaining about their mongo setups falling over
[2012-07-19 19:14:34 -0400] anthroprose: and needing something without global write locking
[2012-07-19 19:15:07 -0400] geekbri: i like protocol buffers.  I however do not use Riak because I hate that I can't just use the whole damn thing for free :)
[2012-07-19 19:15:08 -0400] doomviking: hadoop = SUV?
[2012-07-19 19:15:15 -0400] maek: anyone have any thoughts on restoring a chef .9 couch db into a chef 10 install?
[2012-07-19 19:15:33 -0400] anthroprose: gotta make your living somewheres :)
[2012-07-19 19:15:39 -0400] cwj: is someone making computer/car analogies in here? i suddenly have a headache
[2012-07-19 19:15:41 -0400] yfeldblum: does cassandra have an object store available over rest?
[2012-07-19 19:15:48 -0400] cheeseplus: anthroprose: lots of people come to riak once mongo starts failiing
[2012-07-19 19:15:52 -0400] cheeseplus: failing*
[2012-07-19 19:15:59 -0400] knuckolls: anthroprose: i feel like most people that use mongodb are really just looking for elasticsearch
[2012-07-19 19:16:07 -0400] yfeldblum: knuckolls, why?
[2012-07-19 19:16:08 -0400] knuckolls: but riak, cassandra fit the bill too
[2012-07-19 19:16:27 -0400] anthroprose: knuckools: 75% of my usecases I would agree... although Geospacial is becoming a big component
[2012-07-19 19:16:40 -0400] yfeldblum: knuckolls, can elasticsearch query like mongodb?
[2012-07-19 19:16:58 -0400] cheeseplus: anthroprose: I should note that I am in the employ of Basho so I am totally biased
[2012-07-19 19:17:16 -0400] knuckolls: yfeldblum: just a json keyvalue store with nice seach. covers a fair amount of the usecases and has much more sensible replication/clustering/sharding.
[2012-07-19 19:17:18 -0400] yfeldblum: knuckolls, queries e.g., find all documents s.t. 6 conditions hold, 3 of them involving elements of triply-nested arrays?
[2012-07-19 19:17:20 -0400] anthroprose: cheeseplus: I'd hope you would be! thanks for the disclaimer tho
[2012-07-19 19:18:23 -0400] cheeseplus: anthroprose: yea I don't actually develop it or use it for things other than testing :)
[2012-07-19 19:18:31 -0400] yfeldblum: knuckolls, hmm, is a key-json-store really all that most mongodb users are looking for?
[2012-07-19 19:18:40 -0400] yfeldblum: (with lucene search)
[2012-07-19 19:18:47 -0400] knuckolls: yfeldblum: the mongo query language is hard to beat, i suppose i meant that with a little data modeling it's a cleaner solution in production that gets the job done.
[2012-07-19 19:19:12 -0400] knuckolls: unsure, i get the feeling that yeah a good bit of the use cases will be covered
[2012-07-19 19:19:21 -0400] yfeldblum: knuckolls, yeah um mongodb needs to not have 3 process types ...
[2012-07-19 19:19:40 -0400] knuckolls: i have both in production
[2012-07-19 19:19:48 -0400] paigeat: hadoop is a fleet of tanks
[2012-07-19 19:19:49 -0400] knuckolls: i'd like to swap my use case for mongo out with cassandra
[2012-07-19 19:19:55 -0400] knuckolls: and i will not too long from now
[2012-07-19 19:20:08 -0400] paigeat: and then mapr is a fleet of tanks with a @(*#&$ jet
[2012-07-19 19:20:33 -0400] paigeat: a very expensive jet
[2012-07-19 19:20:37 -0400] geekbri: the biggest complaint I have with mongo is that by the time you go about getting your data resiliency setup, it isn't all that much faster than most other solutions :)  I also wish it had collection level locking
[2012-07-19 19:21:29 -0400] yfeldblum: knuckolls, cassandra seems to have a nicer ops story for setups large enough to need sharding
[2012-07-19 19:22:08 -0400] yfeldblum: knuckolls, with just the one process type
[2012-07-19 19:22:23 -0400] knuckolls: tunable consistency is nice
[2012-07-19 19:22:25 -0400] knuckolls: as well
[2012-07-19 19:22:52 -0400] yfeldblum: knuckolls, indeed, LOCAL_QUORUM is neat
[2012-07-19 19:24:02 -0400] knuckolls: for me another thing is just that rbranson used to work with me and he worked at datastax and has been in deep with cassandra and can help me avoid the pitfalls. nothing like experience an aim message away
[2012-07-19 19:24:15 -0400] cheeseplus: knuckolls: that always helps
[2012-07-19 19:24:18 -0400] rbranson: wat
[2012-07-19 19:24:21 -0400] knuckolls: haha hi
[2012-07-19 19:25:08 -0400] geekbri: Thats cheating ;)
[2012-07-19 19:25:13 -0400] rbranson: I was the one that cursed him with Mongo, soooo
[2012-07-19 19:25:17 -0400] geekbri: We used to use cassandra, but in about a month it shall be gone.
[2012-07-19 19:25:27 -0400] yfeldblum: geekbri, y?
[2012-07-19 19:25:29 -0400] knuckolls: yeah i was wondering which of us were going to let that cat out of the bag.
[2012-07-19 19:25:42 -0400] knuckolls: mongo has served us well in it's time, but it's time to go.
[2012-07-19 19:26:22 -0400] geekbri: yfeldblum: HDFS is a better fit for us.
[2012-07-19 19:26:29 -0400] yfeldblum: geekbri, cool
[2012-07-19 19:27:31 -0400] geekbri: rbranson: youre website is beautiful.
[2012-07-19 19:27:39 -0400] geekbri: your*
[2012-07-19 19:27:45 -0400] knuckolls: geekbri: it's got great sound too
[2012-07-19 19:27:49 -0400] knuckolls: if you've never heard it
[2012-07-19 19:27:55 -0400] geekbri: Oh i'll have to put my headphones in for this one
[2012-07-19 19:28:12 -0400] erratic: geekbri I sat in for a mapr presentation once at amazon
[2012-07-19 19:28:30 -0400] erratic: and it sounds like the performance vs hdfs is a lot better
[2012-07-19 19:28:32 -0400] erratic: but
[2012-07-19 19:28:42 -0400] erratic: its like really expensive
[2012-07-19 19:28:47 -0400] geekbri: knuckolls: Awwww yyeyeeaaahhhh lion king
[2012-07-19 19:28:54 -0400] rbranson: geekbri: i'm srs about my personal brand
[2012-07-19 19:29:02 -0400] knuckolls: super srs
[2012-07-19 19:29:19 -0400] geekbri: Hired.
[2012-07-19 19:29:26 -0400] cheeseplus: hrm, curious if we've done any hdfs vs riakCS comparisons
[2012-07-19 19:30:15 -0400] geekbri: rbranson: I feel like this is you http://pbfcomics.com/81/
[2012-07-19 19:30:52 -0400] rbranson: p much
[2012-07-19 19:31:17 -0400] knuckolls: that's exactly how my interview went
[2012-07-19 19:31:26 -0400] erratic: heh
[2012-07-19 19:32:23 -0400] rbranson: knuckolls: hopefully the last one you'll ever have to wear a suit to :)
[2012-07-19 19:32:43 -0400] knuckolls: yep that deal is sealed
[2012-07-19 19:35:48 -0400] geekbri: Suits to interviews?!
[2012-07-19 19:35:57 -0400] geekbri: I wear to my interview what I want to wear to work.
[2012-07-19 19:38:25 -0400] jperry2: hey guys
[2012-07-19 19:38:30 -0400] jperry2: when are node attributes removed
[2012-07-19 19:38:35 -0400] jperry2: do they live forever?
[2012-07-19 19:38:39 -0400] coderanger: Removed?
[2012-07-19 19:38:46 -0400] jperry2: meaning if I am not setting it anymore
[2012-07-19 19:38:55 -0400] jperry2: I assume they have to be removed manually
[2012-07-19 19:39:07 -0400] jperry2: meaning deleted
[2012-07-19 19:39:09 -0400] knuckolls: as far as i understand it what's written to the node stays until the node is deleted. i feel like i saw that in the docs yesterday.
[2012-07-19 19:39:16 -0400] jperry2: ah okay
[2012-07-19 19:39:21 -0400] jperry2: that sounds about right
[2012-07-19 19:39:29 -0400] jperry2: just wanted to make sure I wasn't seeing some abnormal behavior
[2012-07-19 19:39:30 -0400] yfeldblum: jperry2, normal-level node attributes stay until you explicitly remove them; default-, override-, and automatic-level attributes are reset on each chef-client run
[2012-07-19 19:39:41 -0400] jperry2: ah okay
[2012-07-19 19:39:42 -0400] jperry2: cool
[2012-07-19 19:39:48 -0400] jperry2: thx
[2012-07-19 19:43:37 -0400] tolland: ive got a quicky bash function to switch between knife settings, but I am planning to setup a team member with the same tomorrow
[2012-07-19 19:44:00 -0400] tolland: is there any benefits to doing it some other way?
[2012-07-19 19:44:00 -0400] zuhaib: Hey I got an odd problem, I am in the process of moving a chef-server to a new box and I have moved all the couchdb information and etc but now everytime I try to view a cookbook from the webui I get a connection time out, i am suspecting the cookbook_index is not setup because the box I am moving from was an old chef box that had chef-server install pre 0.9 but was upgraded to 10.10
[2012-07-19 19:44:39 -0400] cheeseplus: tolland: have you looked at spork?
[2012-07-19 19:44:45 -0400] zuhaib: this is what I have in the server logs, http://pastebin.com/CmJ7Ltpk
[2012-07-19 19:45:10 -0400] freerobby1: If you have a provider that calls a second provider, is there any way in chef to access attributes from the top level (first) provider?
[2012-07-19 19:45:13 -0400] knuckolls: tolland: i second spork
[2012-07-19 19:45:21 -0400] cheeseplus: tolland: https://github.com/jonlives/knife-spork
[2012-07-19 19:46:28 -0400] qhartman: We're currently managing our environments as JSON, and it's getting a bit out of hand. It seems like if we switched over to doing that with the Ruby DSL, we'd be able have a master environment file that would be included in other environments for storing our global configs, which could then be overridden by values set there. Am I reading that right? Are there any documented best practices for managing large and complex sets
[2012-07-19 19:46:28 -0400] qhartman:  of environments, each with similar but not identical attribute sets?
[2012-07-19 19:49:08 -0400] geekbri: +1 on spork as well.  Not using it yet but plan to when I have the time to set things up
[2012-07-19 19:49:32 -0400] yfeldblum: qhartman, you could ... seems a little odd though
[2012-07-19 19:49:40 -0400] yfeldblum: qhartman, why so many environments?
[2012-07-19 19:51:48 -0400] tolland: sorry was away, will check out spork. Thanks!
[2012-07-19 19:53:40 -0400] knuckolls: tolland: another thing that might help when working with chef as a team. I wrote knife-santoku to keep multiple team members on the same page about what's going on and to add a level of policy control to knife. as in "don't use the knife edit commands", or "don't promote a cookbook to production with uncomitted changes in your git repo". really whatever process rules you want to wrap around chef.
[2012-07-19 19:53:43 -0400] knuckolls: https://github.com/knuckolls/knife-santoku
[2012-07-19 19:53:56 -0400] dyer: Hey guys, anyone here using the ohai cookbook ? I can't seem to get it to work w/o manually adding "Ohai::Config[:plugin_path] << '/etc/chef/ohai_plugins'" to my client.rb
[2012-07-19 19:53:56 -0400] karsten: In chrome (19) / Ubuntu, I'm getting an SL cert errror when attempting to connect to our Che server. "Invalid Server Certificat" ... "In this case, the server certificate or an intermediate CA certificate presented to your browser is invalid."  Cert is CN opensource.opscode.com/emailAddress=opensource-cert@opscode.com, SHA-1 Fingerprint: 75 0E CE 85 74 A8 56 DE EE 7B 55 BB 42 2A 59 A7
[2012-07-19 19:54:00 -0400] dyer: not sure if thats expected
[2012-07-19 19:54:03 -0400] karsten: 0F 89 7B 4E
[2012-07-19 19:54:27 -0400] karsten: There's some similar issues reported for chrome and SSL, but I can't resolve this one.
[2012-07-19 19:55:06 -0400] qhartman: yfeldblum, Essentially we have four projects, each with a Dev, QA, Stage, and Production environment. So, we essentially have 16 environments to deal with
[2012-07-19 19:55:12 -0400] karsten: Anyone seeing similar?
[2012-07-19 19:56:08 -0400] qhartman: yfeldblum, each project is based on a branch of the same codebase, so they all have similar requirements, but with each one having it's own twist
[2012-07-19 19:57:09 -0400] qhartman: yfeldblum, then each production level has it's own set of hostnames and whatnot that need to be defined
[2012-07-19 19:59:44 -0400] Bonkers: karsten, why would you expect otherwise? it's a self-signed cert
[2012-07-19 20:00:27 -0400] yfeldblum: qhartman, the projects - are they infrastructures? or applications?
[2012-07-19 20:00:47 -0400] chip-: Question: If I have a node that may or may not have the jetty role assigned to it, and thus node['jetty']['group'] may or may not be set
[2012-07-19 20:00:54 -0400] chip-: but if it IS set, I need that value to be used
[2012-07-19 20:00:55 -0400] yfeldblum: qhartman, are they all for your group? for separate customers?
[2012-07-19 20:01:00 -0400] chip-: and if it is not set, then I need to assign 'root' to it
[2012-07-19 20:01:05 -0400] chip-: What's the best way to do that?
[2012-07-19 20:01:13 -0400] chip-: (From a recipe)
[2012-07-19 20:01:23 -0400] chip-: node['jetty']['group'] ||= 'root' doesn't seem to work
[2012-07-19 20:01:46 -0400] qhartman: yfeldblum, applications, different customers, with the application config being driven by the chef environment templating out hte config files at deploy time.
[2012-07-19 20:01:58 -0400] Bonkers: chip-, set a default fault instead default[...]
[2012-07-19 20:02:10 -0400] chip-: Bonkers: ??
[2012-07-19 20:02:22 -0400] qhartman: yfeldblum, we have a chef cookbook that deploys and configures the app based on the environment file settings
[2012-07-19 20:03:05 -0400] Bonkers: chip-, http://wiki.opscode.com/display/chef/Attributes read about default attributes
[2012-07-19 20:03:29 -0400] chip-: Bonkers: Right, but I may not have the jetty role assigned to this node. If it's not assigned, need to use root. If it is assigned, need to use whatever the default attribute is in the jetty cookbook.
[2012-07-19 20:04:31 -0400] chip-: Might not even be a jetty attribute space on the node
[2012-07-19 20:04:43 -0400] Bonkers: so set the default attribute in the role?
[2012-07-19 20:05:08 -0400] Bonkers: look at the attribute precedence order
[2012-07-19 20:05:16 -0400] qhartman: yfeldblum, short of going to ruby, we've also talked about breaking up the namespace some more by nesting the attributes and making it more readable. That seems like a step in the right direction, but it also seems like using the Ruby DSL and some inheritance would make the management a lot simpler
[2012-07-19 20:06:01 -0400] yfeldblum: qhartman, hmmm ... on the whole it seems weird to me
[2012-07-19 20:06:51 -0400] chip-: Yes. I have a default attribute set in this role in another namespace. I'd rather not create a whole other role just to manage one attribute override.
[2012-07-19 20:07:21 -0400] chip-: Oh hey
[2012-07-19 20:07:21 -0400] chip-: http://wiki.opscode.com/display/chef/Attributes#Attributes-SettingaValueOnlyIftheAttributeHasNoValue
[2012-07-19 20:08:35 -0400] yfeldblum: qhartman, why not have a single way to deploy any supported type of application, indeed multiple instances of that application at different SHAs, on a single production infrastructure, driven by roles, a set of data bags, and/or tags?
[2012-07-19 20:10:21 -0400] chip-: There it is.
[2012-07-19 20:11:05 -0400] erratic: scratch
[2012-07-19 20:20:20 -0400] mhalligan: is there a way to force Group to create a group with members if those members don't exist? or to make User add a user even if it's group doesn't exist?
[2012-07-19 20:23:52 -0400] j|: mhalligan: I think the providers just use the underlying OS tools. So, on linux you'd be subject to the constraints of 'useradd' and 'groupadd' I'd guess.
[2012-07-19 20:23:57 -0400] jackery: Anyone know if it's possible to create a cookbook that is dependent on a role in such a way that execution of the cookbook ensures execution of the role's cookbooks occur beforehand?
[2012-07-19 20:24:49 -0400] mhalligan: j|: hrm I must be doing something dumb then (thanks)
[2012-07-19 20:25:27 -0400] knuckolls: jackery: create a new role that has a run list of "role[other-role],recipe[my-recipe]"
[2012-07-19 20:25:30 -0400] knuckolls: would that work?
[2012-07-19 20:25:59 -0400] miah: mhalligan: i think you have to 'manage' the groups
[2012-07-19 20:26:15 -0400] miah: http://wiki.opscode.com/display/chef/Resources#Resources-Group
[2012-07-19 20:26:28 -0400] miah: just define both the :create and :manage actions
[2012-07-19 20:28:47 -0400] jackery: knuckolls: Thanks for the suggestion. While that will technically work, it won't fit into our processes. We have a role managed by one team at the company that configures our OS (nameservers, repos, authentication, etc). Other teams manage cookbooks that depend on these configurations.
[2012-07-19 20:30:36 -0400] knuckolls: jackery: i'm still not sure i understand. most places have a "base" role that configures stuff like that. when you fire up a node you just set the run_list like this "role[base],<the rest of the recipes and roles i want on this node>" they'll run after that base role.
[2012-07-19 20:31:37 -0400] jackery: knuckolls: That's how we're doing it. Unfortunately, it's hard to enforce and communicate that order.
[2012-07-19 20:31:42 -0400] j|: jackery: first thing that comes to mind would be to have the role's run list contain some code that leaves evidence (like a file) that it ran and you can test against that.
[2012-07-19 20:32:09 -0400] jackery: I should probably attack this problem organizationally rather than technically.
[2012-07-19 20:32:10 -0400] j|: I don't particularly think that's very clean, but I'm not sure what you're trying to do either.
[2012-07-19 20:32:18 -0400] jackery: These are interesting solutions, though.
[2012-07-19 20:32:41 -0400] knuckolls: jackery: use knife-satoku as a replacement for knife and write a before callback that checks to see if the run_list matches the policy you want and System.exit if it doesnt?
[2012-07-19 20:33:04 -0400] knuckolls: https://github.com/knuckolls/knife-santoku
[2012-07-19 20:33:09 -0400] j|: knuckolls: that's cool.
[2012-07-19 20:33:14 -0400] knuckolls: but yeah i agree, seems like an organizational thing
[2012-07-19 20:33:40 -0400] knuckolls: i use santoku for all sorts of notifications and policy enforcement. keeps us on the same page.
[2012-07-19 20:33:45 -0400] qhartman: yfeldblum, I think it's just historical that all this is stuffed into the environment and it has grown over time. I'm not sure what breaking it out into roles would buy us, other than having less config in one place.
[2012-07-19 20:33:56 -0400] qhartman: yfeldblum, it's something worth chewing on though
[2012-07-19 20:34:13 -0400] jackery: knuckolls: Thanks for the link!
[2012-07-19 20:34:26 -0400] knuckolls: not like someone can't get around it, but it's just a gentle reminder
[2012-07-19 20:34:40 -0400] jackery: We have an internal framework and we're planning to write a wrapper that abstracted privileges in Chef.
[2012-07-19 20:35:05 -0400] jackery: It's an easy plug in to our framework, but this santoku may be a more-gentle fix to the problem.
[2012-07-19 20:40:25 -0400] tolland: is any opscode project maintaining a amazon linux bootstrap script?
[2012-07-19 20:42:03 -0400] knuckolls: tolland: from what i understand the "chef-full" bootstrap template for omnibus should work on amazon linux.
[2012-07-19 20:43:17 -0400] thedeeno: I'm attempting to install a custom sudoers file from a template. In the template block I have 'mode 0440' however, after copying it the mode appears to be 0670, causing problems. Thoughts?
[2012-07-19 20:45:30 -0400] _rc: thedeeno: use the string "0440" not the number
[2012-07-19 20:46:11 -0400] thedeeno: it's a number
[2012-07-19 20:46:23 -0400] thedeeno: in the file anyways, no quotes around it
[2012-07-19 20:47:14 -0400] _rc: yes, put quotes round it
[2012-07-19 20:49:00 -0400] thedeeno: ohh, neat! trying...
[2012-07-19 20:51:20 -0400] tolland: knuckolls: ah, i see
[2012-07-19 20:51:44 -0400] tolland: so it seemed a bit much to maintain a whole set of per distro scripts bootstrap
[2012-07-19 20:52:58 -0400] tolland: but now, i see that the omni installer will get the client on i must read on to find out the ending to the story, and how the client actually gets bootstrapped
[2012-07-19 20:53:08 -0400] Jay_Levitt: should "knife delete node" also delete its client? Put another way, is it desired behavior that "knife delete node name1" and then "knife rackspace create server -n name1" results in a "Client already exists" error?
[2012-07-19 20:53:50 -0400] thedeeno: Jay_Levitt: I've hit that before. Apparently it's intended. You need to delete both the node and client individually
[2012-07-19 20:54:48 -0400] thedeeno: _rc: thanks! I don't know how I read your first response completely backwards. Using the string works.
[2012-07-19 20:54:58 -0400] dwhsix: Jay_Levitt: fwiw, the knife ec2 subcommand recently added purge to delete, which also delets the node and client
[2012-07-19 20:55:10 -0400] dwhsix: dunno if knife rackspace has aame
[2012-07-19 20:55:11 -0400] dwhsix: *same
[2012-07-19 20:55:19 -0400] Jay_Levitt: dwhsix: ah, nice. I'm moving to ec2 anyway so that works for me :)
[2012-07-19 20:55:28 -0400] thedeeno: moving from rackspace to ec2?
[2012-07-19 20:55:33 -0400] Jay_Levitt: yep
[2012-07-19 20:55:49 -0400] thedeeno: I'm just starting a deploy with rackspace. I'm curious. Why?
[2012-07-19 20:56:00 -0400] thedeeno: maybe you'll save me a headache :)
[2012-07-19 20:56:58 -0400] Jay_Levitt: :) Well, put it this way: I haven't used rackspace cloud much, but I can't find a single advantage of using it, and I see many disadvantages - price (EC2 is cheaper), flexibility (choose your own CPU/mem/disk/network config), power (the whole AWS ecosystem)
[2012-07-19 20:57:23 -0400] doomviking: lets not forget the security model
[2012-07-19 20:57:33 -0400] behemphi: I am exclusively on the Rackspace Cloud
[2012-07-19 20:57:40 -0400] Jay_Levitt: oh yes.. the fact that ALL rackspace cloud instances share a single network
[2012-07-19 20:57:50 -0400] Jay_Levitt: Rackspace's recommendation for securing your server is "use iptables"
[2012-07-19 20:57:55 -0400] behemphi: Jay speaks truth
[2012-07-19 20:58:10 -0400] behemphi: that said, it is dead easy to get started (not so AWS)
[2012-07-19 20:58:14 -0400] mhalligan: behemphi: my condolensces
[2012-07-19 20:58:31 -0400] behemphi: and you can get a person on chat at any time (only availabe with AWS about $10k a month or so)
[2012-07-19 20:58:34 -0400] mhalligan: rackspace's api makes continental shift seem speedy
[2012-07-19 20:58:48 -0400] behemphi: mhaliligan also speaks truth
[2012-07-19 20:58:49 -0400] knuckolls: whack: i've had a passing interest in making the agent monitorable. were you thinking about just putting that stuff in the watchdog thread? exposing data via jmx? out an output? using coda's metrics?
[2012-07-19 20:58:50 -0400] Jay_Levitt: Yes, rackspace has an advantage with support
[2012-07-19 20:58:57 -0400] knuckolls: bah wrong room
[2012-07-19 20:59:05 -0400] s1: rackspace has similar support to any other hosting provider
[2012-07-19 20:59:12 -0400] behemphi: Also I would challenge the cost equation
[2012-07-19 20:59:14 -0400] s1: AWS is the anomaly, self-service
[2012-07-19 20:59:18 -0400] behemphi: esp for smaller instances
[2012-07-19 20:59:18 -0400] s1: product vs. service approach
[2012-07-19 20:59:32 -0400] thedeeno: interesting
[2012-07-19 20:59:35 -0400] behemphi: and their prices are set to go down about $5 per machine per month
[2012-07-19 20:59:42 -0400] Jay_Levitt: behemphi: http://huanliu.wordpress.com/2011/01/25/rackspace-cost-comparison-with-amazon-ec2/
[2012-07-19 21:00:27 -0400] Jay_Levitt: Rackspace is only cheaper (vs on-demand instances) if you're getting significant CPU gains from bursting, and if CPU is what you need more of.
[2012-07-19 21:00:54 -0400] Jay_Levitt: He doesn't cover reserved-instance cost, but it can be 5x cheaper than on-demand, so at that point rackspace just loses, period
[2012-07-19 21:01:46 -0400] s1: I don't see any justifiable reason to go AWS over Rackspace, cloud-to-cloud
[2012-07-19 21:01:57 -0400] s1: bare metal > cloud .. there are a lot of compelling advantages from both a price and performance standpoint
[2012-07-19 21:02:10 -0400] s1: it is surprising more folks (CPU, latency, or IO bound) don't consider this approach
[2012-07-19 21:02:33 -0400] behemphi: I did my cost analysis about 14 months ago.  However I cannot see how the EC2 compareisons for 256mb and 512mb instances are arrived at since EC2 does not have a comparable offering
[2012-07-19 21:02:41 -0400] behemphi: it all ends up being "prorated"
[2012-07-19 21:02:46 -0400] Jay_Levitt: To be clear, we're currently on metal.. I am trying out Rackspace Cloud since we already have some rackspace physical servers and wanted to use rack connect
[2012-07-19 21:03:22 -0400] Jay_Levitt: behemphi: click through to the "ec2 cost breakdown" article - he figured out what amazon really charges for ram, cpu and disk space
[2012-07-19 21:03:38 -0400] behemphi: Sure, but again there is no 256mb offering
[2012-07-19 21:03:49 -0400] behemphi: I cannot buy it, therefore it has no value
[2012-07-19 21:03:58 -0400] Jay_Levitt: ah, so the cheapest rackspace instance < the cheapest amazon instance
[2012-07-19 21:04:06 -0400] mhalligan: in the dedicatedworld ram tends to be the way servers are pricedfor comparison, is it the same in the cloud?
[2012-07-19 21:04:20 -0400] coderanger: mhalligan: Also IOPs
[2012-07-19 21:04:45 -0400] behemphi: mhalligan, I see disk config as a big $ issue in the dedicated too
[2012-07-19 21:05:08 -0400] behemphi: e.g. I want a DB machine with raid 0+1 and very fast scsi
[2012-07-19 21:05:23 -0400] behemphi: much more expensive than a raid 5 with serial ata drives
[2012-07-19 21:05:43 -0400] Jay_Levitt: Whereas in the cloud, they don't charge a penny extra if you ask for fast SCSI SSDs!
[2012-07-19 21:05:50 -0400] Jay_Levitt: ...they just laugh...
[2012-07-19 21:05:50 -0400] behemphi: But I shoudl clarify that we made extremely good used of the 256mb machine which is very hard to do
[2012-07-19 21:06:05 -0400] thedeeno: Jay_Levitt: haha
[2012-07-19 21:06:19 -0400] Jay_Levitt: behemphi: yeah, that requires a custom kernel, no doubt?
[2012-07-19 21:06:45 -0400] behemphi: whereas is the cloud I have not experienced the option to specify storage beyond the magic of EBS
[2012-07-19 21:06:50 -0400] mhalligan: didn't aws just release ssd-based images?
[2012-07-19 21:07:00 -0400] Jay_Levitt: actually, yes, today
[2012-07-19 21:07:04 -0400] Jay_Levitt: ephemeral only, though
[2012-07-19 21:07:13 -0400] behemphi: so again way the prices move is _very_ different is my point
[2012-07-19 21:07:43 -0400] behemphi: mahalligan  holy crap . PG runs faster with caching turned off on those!  RAM gets in the way!
[2012-07-19 21:07:48 -0400] behemphi: amazing stuff
[2012-07-19 21:07:51 -0400] Jay_Levitt: whoa.
[2012-07-19 21:08:21 -0400] Jay_Levitt: we're going to combine a physical postgres server with cloud app servers (for auditability reasons, though we'll happily take the improved performance)
[2012-07-19 21:08:32 -0400] behemphi: In any event, Jay, if you can bring up a large number of 1GB web servers to support your effort (as an example) then Rack Connect _might_ make sense
[2012-07-19 21:08:54 -0400] Jay_Levitt: We run Rails!  We've never heard of a 256MB server.
[2012-07-19 21:09:04 -0400] HarvesterOfBeer: lol
[2012-07-19 21:09:06 -0400] behemphi: The benchmark I am referencing I got at PG day in Austin in March
[2012-07-19 21:09:28 -0400] behemphi: Y, those machines, for us are running some tiny little python servers that grab social content
[2012-07-19 21:09:44 -0400] behemphi: so it is all grab,munge,pump
[2012-07-19 21:10:12 -0400] behemphi: But without knowing your case, simply saying EC2 is better/cheaper is too broad a statement
[2012-07-19 21:10:18 -0400] Jay_Levitt: true, I was oversimplifying
[2012-07-19 21:10:37 -0400] behemphi: I am _not_ defending rackspace, rather simply say "right tool for the right job" while attempting to avoid being a tool :-)
[2012-07-19 21:10:45 -0400] behemphi: (think I might have failed the latter)
[2012-07-19 21:10:50 -0400] Jay_Levitt: not at all
[2012-07-19 21:10:54 -0400] Jay_Levitt: worthy counterpoint, all that
[2012-07-19 21:11:24 -0400] maek: anyone know where the cookbooks are stored when they are uploaded?
[2012-07-19 21:11:24 -0400] behemphi: FWIW, I am looking into Linode to lower my TCO for some things and spread my risk
[2012-07-19 21:11:27 -0400] Jay_Levitt: I've been trying to keep an open mind WRT rackspace.. but that fell shut when I heard about the network
[2012-07-19 21:11:35 -0400] behemphi: that single network thing is a worry for sure!
[2012-07-19 21:11:43 -0400] behemphi: jynx!
[2012-07-19 21:11:48 -0400] Jay_Levitt: :)
[2012-07-19 21:11:49 -0400] anthroprose: bhemphi: linode would be good for your workers potentially...
[2012-07-19 21:12:04 -0400] mhalligan: does anyone have any suggestions for deploying django apps?
[2012-07-19 21:12:09 -0400] behemphi: I need to bring the worker back on to the web app box then yes
[2012-07-19 21:12:15 -0400] mhalligan: application_python feels hsed
[2012-07-19 21:12:21 -0400] behemphi: the magic of chef recipes and role should help!
[2012-07-19 21:12:22 -0400] doomviking: then there is this
[2012-07-19 21:12:24 -0400] doomviking: http://aws.typepad.com/aws/2012/07/new-high-io-ec2-instance-type-hi14xlarge.html
[2012-07-19 21:12:31 -0400] HarvesterOfBeer: behemphi: I've been using linode for a personal box for several years. Top notch. No experience with large coprporate deploys, but I'd expect excellence
[2012-07-19 21:12:37 -0400] mhalligan: I noticed the django_cms cookbooks in the django-quick-start
[2012-07-19 21:12:55 -0400] anthroprose: doom: you figure out how to access sdb & sdc yet?
[2012-07-19 21:13:03 -0400] anthroprose: I can't find the damn SSDs
[2012-07-19 21:13:13 -0400] doomviking: I haven't played with those
[2012-07-19 21:13:15 -0400] doomviking: yet
[2012-07-19 21:13:18 -0400] anthroprose: ah
[2012-07-19 21:13:31 -0400] anthroprose: first thing I did this morning... wooo change the instance type & see how much faster it is
[2012-07-19 21:13:43 -0400] behemphi: Linode got a big plug with me from the founder of WPEngine here in Austin
[2012-07-19 21:13:46 -0400] doomviking: they dont just come up as block devices huh
[2012-07-19 21:13:47 -0400] anthroprose: blocked on the storage tho...
[2012-07-19 21:13:49 -0400] behemphi: that is what put me on the trail
[2012-07-19 21:14:03 -0400] knuckolls: anthroprose: /dev/sdb isn't there?
[2012-07-19 21:14:08 -0400] behemphi: "see" you all tomorrow
[2012-07-19 21:14:11 -0400] anthroprose: linode: most of my friends that do small business hosting startied using linode for stuff like that
[2012-07-19 21:14:15 -0400] anthroprose: knuckolls: nope
[2012-07-19 21:14:25 -0400] anthroprose: they are not formatted or automounted
[2012-07-19 21:14:30 -0400] anthroprose: but they also do not exist in /dev
[2012-07-19 21:14:35 -0400] anthroprose: nor do their xdv counterparts
[2012-07-19 21:14:37 -0400] doomviking: dmesg doesnt show them?
[2012-07-19 21:14:40 -0400] knuckolls: all the ephemerals don't usually
[2012-07-19 21:14:45 -0400] knuckolls: what does /proc have tosay?
[2012-07-19 21:14:48 -0400] mhalligan: but the django_cms cookbook isn't in https://github.com/opscode/cookbooks so it feels like this was just there as a demo?
[2012-07-19 21:14:52 -0400] knuckolls: or the ec2 metadata service
[2012-07-19 21:15:02 -0400] anthroprose: well lets have a look see & find out
[2012-07-19 21:15:32 -0400] karsten: Bonkers: it's a self-signed cert, but Google Chrome gives you *no* way to view the site or (AFAICT) add the cert.
[2012-07-19 21:15:59 -0400] Bonkers: karsten, sure it does
[2012-07-19 21:16:05 -0400] anthroprose: the metadaservice def did not list them, I checked that last time
[2012-07-19 21:16:08 -0400] anthroprose: about to hit proc
[2012-07-19 21:17:03 -0400] anthroprose: [ec2-user@ip-10-46-128-111 ~]$ dmesg|grep sdb
[2012-07-19 21:17:03 -0400] anthroprose: [ec2-user@ip-10-46-128-111 ~]$ dmesg|grep sdc
[2012-07-19 21:17:16 -0400] knuckolls: well it is day 1 out of beta
[2012-07-19 21:17:20 -0400] knuckolls: maybe you got a bad instance
[2012-07-19 21:17:29 -0400] anthroprose: this is like #6 or #8
[2012-07-19 21:17:46 -0400] anthroprose: fresh launch just a sec ago
[2012-07-19 21:17:46 -0400] knuckolls: i had an ebs-only micro start up with an ephemeral ami one time
[2012-07-19 21:17:51 -0400] doomviking: sounds like its time to open a ticket
[2012-07-19 21:18:36 -0400] knuckolls: yeah surely amazon actually wants to sell their new shiny toy
[2012-07-19 21:18:56 -0400] anthroprose: it worked for netflix :( *snif*
[2012-07-19 21:19:00 -0400] Jay_Levitt: just go call tech suppOH, THAT'S RIGHT
[2012-07-19 21:19:26 -0400] knuckolls: they were in the beta and the server id has changed since the beta as far as i know
[2012-07-19 21:19:34 -0400] knuckolls: you're using the hi1?
[2012-07-19 21:19:41 -0400] anthroprose: ahhh, that makes sense...
[2012-07-19 21:19:46 -0400] anthroprose: hi1.4xlarge
[2012-07-19 21:19:49 -0400] knuckolls: yeah
[2012-07-19 21:19:56 -0400] knuckolls: should work!
[2012-07-19 21:19:58 -0400] anthroprose: us-east-1c
[2012-07-19 21:20:01 -0400] knuckolls: i haven't fired one up yet
[2012-07-19 21:20:10 -0400] anthroprose: I've only cursorly played with it...
[2012-07-19 21:20:16 -0400] anthroprose: $3.10/hr keeps me from having too much fun
[2012-07-19 21:20:40 -0400] knuckolls: yeah no kidding
[2012-07-19 21:21:39 -0400] karsten: Bonkers: Where?
[2012-07-19 21:22:21 -0400] karsten: Bonkers: Not on the error page, and not AFAICT in the settigns / adanced configs.
[2012-07-19 21:22:23 -0400] Bonkers: karsten, I can't find a site with self-signed cert right now, but I'm pretty sure there's a + box at the bottom that expands with some links or buttons
[2012-07-19 21:22:27 -0400] karsten: s/adanced/advanced
[2012-07-19 21:22:59 -0400] karsten: Bonkers: "Back" button and "Help me understand".  Busted lock icon doesn't have any "add cert" option.
[2012-07-19 21:23:18 -0400] Bonkers: perhaps under help me understand
[2012-07-19 21:23:21 -0400] Bonkers: trust me, it's there, keep clicking
[2012-07-19 21:23:24 -0400] Bonkers: it's not under the lock
[2012-07-19 21:23:47 -0400] Jay_Levitt: karsten: did you ever send strict-transport-security headers for the site?
[2012-07-19 21:24:09 -0400] karsten: Jay_Levitt: is that a server-side or client-side config?
[2012-07-19 21:24:14 -0400] Jay_Levitt: server-side
[2012-07-19 21:24:28 -0400] karsten: Checking
[2012-07-19 21:24:58 -0400] Jay_Levitt: I only just read about it a few minutes ago; it's sort of "HTTPS pinning", and tells the browser not to allow HTTP-only connections for n seconds - also eliminates the "add exception" button
[2012-07-19 21:27:31 -0400] karsten: Jay_Levitt: Yeah, looking through apache configs.
[2012-07-19 21:27:35 -0400] karsten: apache2.
[2012-07-19 21:38:25 -0400] karsten: Jay_Levitt: Hrm:  I thnk we need to set up our own cert (we've got a few to choose from) when we turn on our chef servers).
[2012-07-19 21:53:33 -0400] tolland: due to lack of foresight, i created my hosted chef free user with the same name as the organisation
[2012-07-19 21:53:44 -0400] tolland: is that changeable without much pain?
[2012-07-19 21:55:51 -0400] knuckolls: tolland: i think you can just create a new user, add it to the organization and promote it to billing admin
[2012-07-19 21:57:26 -0400] tolland: the email is used
[2012-07-19 22:02:07 -0400] qhartman: Ok, I have a snippet that driving me nuts. When I test it in shef it does exactly what I expect. In the real world, it fails if the host attribute I'm testing is nil. https://gist.github.com/3147170
[2012-07-19 22:02:10 -0400] qhartman: Any ideas?
[2012-07-19 22:04:06 -0400] Jay_Levitt: tolland: I did this recently; just change the email on the previous user
[2012-07-19 22:04:31 -0400] qhartman: my best guess is that for some reason variable assignment with the sub_attribute is still being evaluated even if host[:attribute] is nil, and then that is raising a nilclass error
[2012-07-19 22:04:54 -0400] paulmooring: qhartman: what error do you get if it's nil?
[2012-07-19 22:05:30 -0400] paulmooring: also it's actually nil and not just uninitialized right?
[2012-07-19 22:05:30 -0400] paulmooring: ]
[2012-07-19 22:05:44 -0400] qhartman: paulmooring, "NoMethodError: undefined method `[]' for nil:NilClass" on line 2
[2012-07-19 22:06:05 -0400] qhartman: paulmooring, which I don't get in shef
[2012-07-19 22:06:25 -0400] paulmooring: oh so it's not host[:attribute] that's nil, but host itself right?
[2012-07-19 22:07:01 -0400] qhartman: I'm testing for nil-ness of the attribute
[2012-07-19 22:07:20 -0400] qhartman: I suppose it's possible that the host is ending up nil, but it shouldn't be. Worst case it should be empty
[2012-07-19 22:07:35 -0400] qhartman: but that search should always return a node
[2012-07-19 22:07:58 -0400] paulmooring: so that error looks like host is nil rather than the attribute, you could try making that `unless host.nil?` to test that theory
[2012-07-19 22:08:36 -0400] paulmooring: but I would guess you're bug is elsewhere and host is inadvertently getting set to nil rather than host[:attribute]
[2012-07-19 22:09:18 -0400] mhalligan: has anybody ever succesffully gotten application_python::django to work?
[2012-07-19 22:09:35 -0400] mhalligan: and should I assume that the django quickstart is broken and ignore it?
[2012-07-19 22:09:38 -0400] qhartman: I'm setting the contents of hostwith a search immediately before the test, and even if the search doesn't turn up anything, it returns [], so it should still pass the nil test
[2012-07-19 22:10:11 -0400] qhartman: but I'll try some stuff along that line and see what it turns up
[2012-07-19 22:10:53 -0400] paulmooring: qhartman: perhaps it should be unless host[:attribute][:sub_attribute].nil?
[2012-07-19 22:11:11 -0400] paulmooring: or are you sure it's the unless line rather than the v = lines throwing the error?
[2012-07-19 22:11:41 -0400] qhartman: I'm not sure, that was going to be my next avenue of checking
[2012-07-19 22:12:01 -0400] linux2000in: Hi
[2012-07-19 22:12:02 -0400] paulmooring: either way you might throw some puts host.class and puts host[:attributes].class statements in there to be sure which is actually nil
[2012-07-19 22:12:05 -0400] paulmooring: hi linux2000in
[2012-07-19 22:12:12 -0400] linux2000in: hi paulmooring
[2012-07-19 22:12:19 -0400] linux2000in: i have question if any one can help
[2012-07-19 22:12:41 -0400] knuckolls: just ask :)
[2012-07-19 22:13:13 -0400] qhartman: paulmooring, thanks for the back and forth
[2012-07-19 22:13:27 -0400] paulmooring: np, let me know if you need more help
[2012-07-19 22:13:27 -0400] linux2000in: i have role called test and it has couple of recipes , it applies to all the nodes by default but for one node i want to exclude one of recipe .
[2012-07-19 22:13:56 -0400] knuckolls: linux2000in: make two roles
[2012-07-19 22:14:04 -0400] knuckolls: or call one role from the other
[2012-07-19 22:14:11 -0400] knuckolls: with the subset that is common
[2012-07-19 22:14:41 -0400] linux2000in: hmm.
[2012-07-19 22:14:55 -0400] linux2000in: Can  i exclude  recipe in runlist ?
[2012-07-19 22:14:58 -0400] mhalligan: anybody at all?
[2012-07-19 22:15:06 -0400] mhalligan: or are there just no django sites using chef?
[2012-07-19 22:15:17 -0400] qhartman: paulmooring, oh, that was why I didn't explore the v stuff already. In the case that the attribute isn't nil, and v gets set, this works fine in the real world. It's only if the attribute I'm testing on line 2 is nil that it dies.
[2012-07-19 22:15:23 -0400] knuckolls: linux2000in: i don't believe so. roles just contain run_lists.
[2012-07-19 22:15:34 -0400] linux2000in: oh
[2012-07-19 22:15:35 -0400] knuckolls: you can compose what you want to run from multiple roles
[2012-07-19 22:16:29 -0400] paulmooring: qhartman: so more than likely the problem is when host[:attribute][:sub_attribute] is nil but host[:attribute] is not
[2012-07-19 22:16:49 -0400] paulmooring: unless I'm missing something you're unless should be against the sub_attribute
[2012-07-19 22:27:46 -0400] dnszero: Hey guys, easy question: How do I access reporting features in chef? E.g., I'm using hosted chef and I want to know what changes were made to a node and when.
[2012-07-19 22:28:28 -0400] dnszero: I must be overlooking the answer, but the docs make it seem like I need to write my own reporting from scratch...
[2012-07-19 22:29:05 -0400] Jay_Levitt: Hmm.. just added "cookbook 'rvm', git: 'https://github.com/fnichol/chef-rvm'" to Cheffile, and 'recipe[rvm::system]' to my role's run_list. But I get an exception 'no versions specified, and no candidate version available for git-core': https://gist.github.com/b8460d8d2516cfe55958
[2012-07-19 22:30:19 -0400] dnszero: @Jay_Levitt I seem to recall running into that issue beforehmm maybe on a debian or centos box...
[2012-07-19 22:30:35 -0400] Jay_Levitt: @dnszero I'm on Ubuntu 12.04..
[2012-07-19 22:32:51 -0400] Jay_Levitt: (is hosted chef running super-slow for everyone right now? taking 10-15 seconds to upload each cookbook.)
[2012-07-19 22:33:40 -0400] Jay_Levitt: Hmm, I tried adding 'git' to the Cheffile and run_list, no improvement.
[2012-07-19 22:34:03 -0400] dnszero: same error?
[2012-07-19 22:34:22 -0400] Jay_Levitt: yep
[2012-07-19 22:34:32 -0400] Jay_Levitt: oh! no, I lied
[2012-07-19 22:34:37 -0400] dnszero: lol
[2012-07-19 22:34:45 -0400] erikh: you need to upload the cookbook still.
[2012-07-19 22:34:53 -0400] Jay_Levitt:  FATAL: Chef::Exceptions::Package: package[git-core] (git::default line 21) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for git-core
[2012-07-19 22:35:03 -0400] Jay_Levitt: No, I did "knife upload cookbook --all"
[2012-07-19 22:35:04 -0400] dnszero: when i hit that error before, it was because git-core wasn't an available package for me. Maybe try installing git-core from the cli as a test
[2012-07-19 22:35:11 -0400] erikh: ah ok
[2012-07-19 22:35:43 -0400] Jay_Levitt: dnszero: yes, you are right.. apt-get install git-core says it's unable to locate the package
[2012-07-19 22:36:33 -0400] dnszero: hmm, i just checked on my 12.04 box and it's available when I do apt-cache search git-core
[2012-07-19 22:36:46 -0400] dnszero: but it says "(obsolete)"
[2012-07-19 22:37:04 -0400] dnszero: i have no idea what that means (beside the obvious)
[2012-07-19 22:37:26 -0400] Jay_Levitt: I wonder if this is something like "rackspace's image needs apt-get update done first"
[2012-07-19 22:37:51 -0400] Jay_Levitt: yes, that's exactly what it was.  ok, so what's the right way to have chef do that?
[2012-07-19 22:39:04 -0400] dnszero: hmm, good question
[2012-07-19 22:40:57 -0400] dnszero: here's an example i found of running apt-get update from a recipe
[2012-07-19 22:40:57 -0400] dnszero: https://github.com/opscode/cookbooks/blob/master/rsyslog/recipes/default.rb#L28
[2012-07-19 22:41:45 -0400] Jay_Levitt: hmm.. but I just saw another discussion implying that the apt provider should already be running updates
[2012-07-19 22:43:15 -0400] Jay_Levitt: then again, I'm not explicitly calling the apt recipe anywhere either.  Do I generally need to manually resolve dependencies like this?
[2012-07-19 22:43:27 -0400] Jay_Levitt: I kinda thought it would All Just Work
[2012-07-19 22:48:22 -0400] cwj: if you include the default recipe from the apt cookbook early on in your chef run list, it will ensure that an apt-get update has happened at least once
[2012-07-19 22:48:49 -0400] cwj: https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb#L22
[2012-07-19 22:49:01 -0400] Jay_Levitt: ok, I'll do that.. just looked through the default apt provider and it doesn't seem to do apt updates, so I'll have to use the apt recipe
[2012-07-19 23:00:40 -0400] cwj: ok i finally "get" berkshelf and it is cool
[2012-07-19 23:05:25 -0400] Bonkers: I'm using chef-solo to test out my chef stuff in vagrant, how can I see the node's attribute list like I would if I went to the node in the chef server web ui?
[2012-07-19 23:10:42 -0400] javawidget: any good examples of installing a certificate + key on nginx ?
[2012-07-19 23:11:14 -0400] javawidget: for example... where is the best place to store the key and crt?
[2012-07-19 23:15:22 -0400] qhartman: javawidget, you almost certainly want to store that in a data bag
[2012-07-19 23:15:57 -0400] qhartman: but if you are feeling lazy you could store it in a cookbook file, or justa remote file you can grab, but those options have negative security implications
[2012-07-19 23:16:26 -0400] javawidget: looking at this: https://github.com/coroutine/chef-nginx_ssl_proxy/blob/master/recipes/default.rb
[2012-07-19 23:16:37 -0400] javawidget: seems he is using an encrypted databag
[2012-07-19 23:16:43 -0400] qhartman: yup
[2012-07-19 23:16:48 -0400] qhartman: that would be The Right Way
[2012-07-19 23:16:53 -0400] javawidget: :-)
[2012-07-19 23:17:10 -0400] javawidget: Haven't figured out the encrypted data bags yet...
[2012-07-19 23:17:18 -0400] javawidget: Guess that's next on my list..
[2012-07-19 23:17:33 -0400] qhartman: yeah, I still struggle with them a bit, I don't use them enough to be really comfortable
[2012-07-19 23:17:51 -0400] qhartman: http://wiki.opscode.com/display/chef/Encrypted+Data+Bags
[2012-07-19 23:17:58 -0400] javawidget: Oh cool.. thanks..
[2012-07-19 23:17:59 -0400] qhartman: That's the starting point
[2012-07-19 23:18:26 -0400] Jay_Levitt: anyone using chef_rvm with "system rvm" on Ubuntu?  rvm adds itself to the end of the path, which would be great if apt-get didn't have a helpful wrapper around it..
[2012-07-19 23:18:58 -0400] javawidget: thanks qh
[2012-07-19 23:19:06 -0400] qhartman: sure thing
[2012-07-19 23:21:12 -0400] Jay_Levitt: :)
[2012-07-19 23:21:40 -0400] Jay_Levitt: I refuse to learn more than 17 new first-class concepts in a given month, so Chef's kinda taken up all the slots for July
[2012-07-19 23:22:52 -0400] hoover_damm: Jay_Levitt, I will just let you know that deploying Ruby is a lot harder then it should be.
[2012-07-19 23:23:11 -0400] hoover_damm: Jay_Levitt, the best way to deploy Ruby and avoid the rvm/rbenv trap is to package up your own ruby and win or use brightbox and win
[2012-07-19 23:23:42 -0400] hoover_damm: rvm and rbenv work great in development but in production it seems to be a nightmare that is repeated over and over
[2012-07-19 23:23:48 -0400] hoover_damm: at least from observation in #chef
[2012-07-19 23:23:54 -0400] qhartman: seconded
[2012-07-19 23:23:54 -0400] erratic: damn
[2012-07-19 23:24:02 -0400] Jay_Levitt: that's kinda disappointing
[2012-07-19 23:24:12 -0400] hoover_damm: it's very disappointing
[2012-07-19 23:24:14 -0400] pbuckley_: heh
[2012-07-19 23:24:16 -0400] erratic: hate just hate?
[2012-07-19 23:24:36 -0400] Jay_Levitt: the whole point of Chef is to avoid nightmares that are repeated over and over!
[2012-07-19 23:24:54 -0400] erratic: subjective
[2012-07-19 23:24:56 -0400] javawidget: or.. create nightmares that will be repeated over and over
[2012-07-19 23:25:02 -0400] javawidget: :-)
[2012-07-19 23:25:06 -0400] qhartman: That's said, I'm heavily on the ops side of the dev-ops spectrum so I'm sure I'm just missing all the awesome stuff it does on the dev side.
[2012-07-19 23:25:19 -0400] hoover_damm: one suggestion was https://github.com/iain/roundsman
[2012-07-19 23:25:21 -0400] Jay_Levitt: nooo, my naivete, where's it going
[2012-07-19 23:25:25 -0400] Bonkers: rbenv is definitely the way to go
[2012-07-19 23:25:26 -0400] doomviking: nightmares should be idempotent
[2012-07-19 23:25:36 -0400] Jay_Levitt: +1
[2012-07-19 23:25:42 -0400] qhartman: hah
[2012-07-19 23:26:05 -0400] doomviking: something not quite right with that statement.
[2012-07-19 23:26:09 -0400] Bonkers: just create a user, install rbenv for that user, set up .bashrc with rbenv stuff, and then run everything with a '/usr/bin/env bash -i -c fooblah'
[2012-07-19 23:26:13 -0400] hoover_damm: Jay_Levitt, then I would suggest follow fnichols chef-rvm cookbook and read the readme and follow it
[2012-07-19 23:26:16 -0400] hoover_damm: and good luck
[2012-07-19 23:26:41 -0400] hoover_damm: rvm is subject to change because wayne is wayne
[2012-07-19 23:27:05 -0400] bbhoss: Anyone know how to format knife ssh to search by recipe? I have it working with knife search node, but using the same query on knife ssh doesn't work
[2012-07-19 23:27:07 -0400] Bonkers: rvm is awesome for development, not deployment
[2012-07-19 23:27:48 -0400] bbhoss: this is my attempt: knife ssh 'recipes:application' 'sudo chef-client'  -a "cloud[local_ipv4]"
[2012-07-19 23:28:10 -0400] Jay_Levitt: qhartman: on the dev side... "How do I build a version of ruby with these railsexpress patches?" "rvm install -f railsexpress"
[2012-07-19 23:28:52 -0400] hoover_damm: bbhoss, ouch :(
[2012-07-19 23:29:04 -0400] bbhoss: hoover_damm: what?
[2012-07-19 23:29:08 -0400] hoover_damm: that command line
[2012-07-19 23:29:18 -0400] hoover_damm: bbhoss, that is exactly why I use fabric
[2012-07-19 23:29:18 -0400] bbhoss: oh, if it worked it'd be fine :)
[2012-07-19 23:29:28 -0400] hoover_damm: so I never have to make a knife ssh again
[2012-07-19 23:29:58 -0400] hoover_damm: I should also note when I run chef-client on a role... it can be upwards of 300nodes at a time
[2012-07-19 23:30:01 -0400] erratic: I like knife ssh
[2012-07-19 23:30:04 -0400] erratic: its useful
[2012-07-19 23:30:13 -0400] bbhoss: i suspect i'm gonna have a bad time with the attribute too, but I'm solving one thing at a time
[2012-07-19 23:30:21 -0400] bbhoss: hoover_damm: this is a very small env
[2012-07-19 23:30:24 -0400] hoover_damm: basically I would suggest if your going to use Chef to use Fabric and tie it up with pychef
[2012-07-19 23:30:27 -0400] erratic: but I'll check out fabric
[2012-07-19 23:30:31 -0400] hoover_damm: because you can take your repative tasks
[2012-07-19 23:30:35 -0400] hoover_damm: and chuck em in your fabfile
[2012-07-19 23:30:36 -0400] dnszero: How do I get a report of what(&when) chef did to each node?
[2012-07-19 23:30:38 -0400] hoover_damm: and just win
[2012-07-19 23:31:20 -0400] dnszero: I'm using hosted chef, btw
[2012-07-19 23:31:27 -0400] qhartman: dnszero, I don't think there is a good way to track that unless you tee your chef-client runs to some sort of logfile
[2012-07-19 23:33:04 -0400] bbhoss: qhartman: doesn't it dump a log file on each run somewhere?
[2012-07-19 23:33:14 -0400] qhartman: dnszero, you can check the ohai time on the node
[2012-07-19 23:33:24 -0400] doomviking: I have log_location     "/var/log/chef-client.log" in my client.rb
[2012-07-19 23:33:34 -0400] qhartman: bbhoss, not that I've seen, I could easily be wrong
[2012-07-19 23:33:58 -0400] bbhoss: you could probably just store the log in a databag or maybe in the node stuff, not sure exactly where it should go
[2012-07-19 23:33:58 -0400] doomviking: log_level :info
[2012-07-19 23:34:32 -0400] dnszero: ahh cool re: /var/log/chef....
[2012-07-19 23:34:34 -0400] qhartman: doomviking, I have no such log file , and my log_location is STDOUT
[2012-07-19 23:34:52 -0400] doomviking: ok
[2012-07-19 23:34:52 -0400] qhartman: looks like it can be configured to log runs
[2012-07-19 23:35:00 -0400] dyer: Hey guys, questions  What exactly does the config parameter in the metadata.rb do ?  I had thought it would allow me to override the cookbook name when referenced, e.g. when I reference a cookbook from a role ( thing vs thing-chef ), but that does not seem to be the case
[2012-07-19 23:35:01 -0400] qhartman: awesome
[2012-07-19 23:35:06 -0400] qhartman: learning++
[2012-07-19 23:35:27 -0400] doomviking: sharing++
[2012-07-19 23:35:47 -0400] Majost: I seem to found a discrepancy between the README.md for the python cookbook and the actual code
[2012-07-19 23:35:50 -0400] erratic: eating+eating*2
[2012-07-19 23:35:55 -0400] Majost: FATAL: NoMethodError: undefined method `options' for Chef::Resource::PythonVirtualenv
[2012-07-19 23:36:01 -0400] doomviking: beer/sleep
[2012-07-19 23:36:15 -0400] erratic: seconded
[2012-07-19 23:36:49 -0400] Majost: The readme.md says there is an attribute parameter for python_virutalenv called "options" which will allow you to pass options to virtualenv
[2012-07-19 23:37:19 -0400] Majost: but I get that error as a result of it not being handled.
[2012-07-19 23:37:52 -0400] qhartman: Is it trying to do a pip install of the virtualenv stuff?
[2012-07-19 23:38:04 -0400] Majost: is there a cookbook source upstream to the opscode where it is implemented?
[2012-07-19 23:38:33 -0400] Majost: qhartman: one moment, I will make a pastey
[2012-07-19 23:39:39 -0400] Majost: http://pastie.org/4286949
[2012-07-19 23:39:46 -0400] Majost: That is what I am doing
[2012-07-19 23:42:00 -0400] qhartman: Majost, Ah, sorry that's not something I've dug into. There was a bug around the python cookbook and installing virtualenv awhile ago, so I thought it might be related to that, but it looks like you're doing something different
[2012-07-19 23:42:48 -0400] Majost: qhartman: It works fine without the "options" parameter
[2012-07-19 23:45:26 -0400] dyer: I guess I can rephrase my question So I have a cookbook dir called prism, which I renamed to prism-chef.  We did this to help namesake things in our SCM.   However I had thought I could use the name attribute in the metadata.rb file to keep the cookbook named prism, but this doesn't seem to be working
[2012-07-19 23:45:31 -0400] dyer: has anyone used this method?
[2012-07-19 23:45:55 -0400] qhartman: Majost, I think you're right, that looks like a documentation bug. I'm looking at the code for that provider, and I'm not seeing anything for handling options so unless it's inheriting that from somewhere else it doesn't do it. But, my grasp of ruby isn't as good as it should be
[2012-07-19 23:45:56 -0400] Majost: ah -- figured it out
[2012-07-19 23:46:01 -0400] Majost: its not
[2012-07-19 23:46:11 -0400] Majost: its in the virutalenv.rb resource
[2012-07-19 23:46:29 -0400] Majost: but my chef server doesn't seem to have the version where it is defined
[2012-07-19 23:46:36 -0400] qhartman: ah
[2012-07-19 23:46:39 -0400] Majost: it looks like they added it without bumping the version
[2012-07-19 23:49:43 -0400] qhartman: dyer, I have not used it
[2012-07-19 23:50:20 -0400] hoover_damm: dyer, I've not used that method... ran into that same trap
[2012-07-19 23:50:25 -0400] hoover_damm: dyer, I just renamed the cookbook
[2012-07-19 23:50:31 -0400] hoover_damm: :(
[2012-07-19 23:54:55 -0400] Majost: Does the site command pull from git or somewhere else?
[2012-07-19 23:56:36 -0400] Majost: Huh... so it looks like opscode only updates the site packages when the version has been bumped
[2012-07-19 23:56:49 -0400] miah: the site command pulls down tarballs
[2012-07-19 23:58:02 -0400] Majost: is there a reason why the tarballs/packages aren't updated upon check-in or merge?
[2012-07-19 23:58:12 -0400] miah: Majost: you're talking about cookbook site right?
[2012-07-19 23:58:22 -0400] Majost: miah: correct
[2012-07-19 23:58:53 -0400] miah: Majost: im not sure what opscode internal deployment procedure is for their cookbooks -> community site.. but ya. if they missed a version bump. file a ticket.
[2012-07-19 23:59:22 -0400] jtimberman: Majost: yeah
[2012-07-19 23:59:28 -0400] jtimberman: Majost: the reason is because we need to test things
[2012-07-19 23:59:42 -0400] jtimberman: Majost: and we're working on CI for testing
