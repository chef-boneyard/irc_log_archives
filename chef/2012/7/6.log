[2012-07-06 00:02:54 -0400] Majost: hoover_damm: hey... so I figured out how to get the ruby-pg stuff working, and thus the full postgresql cookbook
[2012-07-06 00:03:18 -0400] Majost: rather, opscode support did -- and I followed their suggestion. heh
[2012-07-06 00:05:19 -0400] hoover_damm: Majost, cool anything I can drop in the README to sum it up for others?
[2012-07-06 00:05:21 -0400] hoover_damm: or help you fix it?
[2012-07-06 00:06:54 -0400] jameson_zzz: anypone have a
[2012-07-06 00:06:57 -0400] jameson_zzz: anyone hav
[2012-07-06 00:07:11 -0400] jameson: anyone have a one-line with knife that can get all the ec2 instances and their names?
[2012-07-06 00:07:59 -0400] Majost: hoover_damm: For ubuntu users; when using bootstrap you need to specify '-d ubuntu12.04-gems'
[2012-07-06 00:08:49 -0400] hoover_damm: Majost, in otherwords it's the bootstrap
[2012-07-06 00:08:50 -0400] Majost: hoover_damm: otherwise it uses chef-full which pulls down the isolated chef installation package that uses its own library set
[2012-07-06 00:08:54 -0400] Majost: yep
[2012-07-06 00:08:56 -0400] hoover_damm: using omnibus breaks the ssl version
[2012-07-06 00:09:00 -0400] Majost: yeah
[2012-07-06 00:09:01 -0400] hoover_damm: thus the lameness
[2012-07-06 00:09:04 -0400] hoover_damm: suck
[2012-07-06 00:09:25 -0400] Majost: heh
[2012-07-06 00:09:34 -0400] hoover_damm: I was hoping for a 'fix' not a work around :( but I expected that to be the answer
[2012-07-06 00:09:41 -0400] Majost: ah
[2012-07-06 00:09:49 -0400] hoover_damm: short of shipping all the openssl versions required for each ubuntu/debian in omnibus
[2012-07-06 00:09:55 -0400] Majost: yeah, I wish I could provide that
[2012-07-06 00:10:04 -0400] hoover_damm: basically the next easiest thing to do is rebuild omnibus with libpq
[2012-07-06 00:10:10 -0400] Majost: yep
[2012-07-06 00:10:25 -0400] hoover_damm: so it links against omnibus's ssl and then ...
[2012-07-06 00:10:27 -0400] hoover_damm: slapshot
[2012-07-06 00:10:42 -0400] hoover_damm: Majost, that's a excellent ticket if you wanna file it?
[2012-07-06 00:11:00 -0400] hoover_damm: Majost, then omnibus can have pg installed by default :) and postgres users will just smile a little more
[2012-07-06 00:11:14 -0400] Majost: COOK-1406
[2012-07-06 00:11:24 -0400] hoover_damm: cool
[2012-07-06 00:12:19 -0400] Majost: and there is movement on it since this morning. =)
[2012-07-06 00:14:19 -0400] hoover_damm: yeah i'll add a comement
[2012-07-06 00:26:02 -0400] dvc1: hi. getting  a "Chef::Exceptions::CookbookNotFound" when using chef-solo. the same setup runs on another machine. any way to trackdown whats causing the failure?
[2012-07-06 00:26:56 -0400] dvc1: this is w/ chef 10.8
[2012-07-06 00:32:08 -0400] cheesepl_: dvc1: what is in your solo.rb and do have you run with "-l debug"
[2012-07-06 00:32:09 -0400] cheesepl_: ?
[2012-07-06 00:32:59 -0400] dvc1: yes run w/ -l debug not much there
[2012-07-06 00:33:03 -0400] dvc1: file_cache_path "/var/chef-solo"
[2012-07-06 00:33:04 -0400] dvc1: cookbook_path ["#{ENV['PWD']}/cookbooks"]
[2012-07-06 00:33:04 -0400] dvc1: role_path "#{ENV['PWD']}/roles"
[2012-07-06 00:33:13 -0400] dvc1: thats the solo.rb
[2012-07-06 00:34:02 -0400] cheesepl_: dvc1: have you tried using the absolute path yet?
[2012-07-06 00:34:16 -0400] dvc1: let me try that
[2012-07-06 00:34:53 -0400] cheesepl_: also what recipes are you trying to run? i.e. recipes.json?
[2012-07-06 00:35:45 -0400] dvc1: crap. looks like absolute path fixes it.
[2012-07-06 00:35:47 -0400] dvc1: but unclear why
[2012-07-06 00:36:17 -0400] cheesepl_: you can use the interactive shell (shef) to see what that value is returning
[2012-07-06 00:37:55 -0400] dvc1: how do i check what the vars are set to?
[2012-07-06 00:38:07 -0400] dvc1: (btw had not used shef before, looks cool)
[2012-07-06 00:39:07 -0400] cheesepl_: should just be able to paste them in and have it evaluate
[2012-07-06 00:40:08 -0400] cheesepl_: ENV['PWD']
[2012-07-06 00:40:25 -0400] dvc1: yea thats wack: chef > ENV['PWD']
[2012-07-06 00:40:26 -0400] dvc1:  => nil
[2012-07-06 00:40:31 -0400] dvc1: cool that isolates the issue
[2012-07-06 00:40:42 -0400] dvc1: i think it has to do because im running the command w/ sudo
[2012-07-06 00:40:46 -0400] cheesepl_: permisisons?
[2012-07-06 00:40:48 -0400] cheesepl_: ah yea
[2012-07-06 00:40:52 -0400] cheesepl_: that'll do it
[2012-07-06 00:41:27 -0400] dvc1: hm wonder why it works else where
[2012-07-06 00:42:01 -0400] dvc1: regardless. awesome. help is much appreciated
[2012-07-06 00:42:27 -0400] cheesepl_: glad to help
[2012-07-06 00:46:40 -0400] Majost: Anyone know if the firewall cookbook is going to supersede (all) others? eg: iptables -- the readme for iptables suggests it might, but I can't find the roadmap referenced to be sure.
[2012-07-06 00:52:28 -0400] williamherry: I suddenly can use knife node list, it says Failed to authenticate, I try to create new one, also failed, does pem key has a exceed time?
[2012-07-06 00:53:58 -0400] jessicab: williamherry: the orgs pem key doesnt expire after a certain amount of time.. but there are two different 401 errors, this page has some tips on resolving them - http://wiki.opscode.com/display/chef/Common+Errors
[2012-07-06 00:57:31 -0400] williamherry: jessicab, I try to create new one with new name, still fail, it even says /etc/chef/webui.pem is not valid
[2012-07-06 00:57:47 -0400] williamherry: I can't use knife now
[2012-07-06 01:00:57 -0400] jessicab: im not that familiar with chef server, but i think according to those directions chef-server might need to be restarted when you regenerate the webui key? if you create a new client youll need to make sure to edit your knife.rb with the new name and location too
[2012-07-06 01:02:42 -0400] hoover_damm: williamherry, no the keys do not expire
[2012-07-06 01:02:51 -0400] hoover_damm: afaik
[2012-07-06 01:03:11 -0400] timsmith: how would you go about making an if statement using node to check if an item is in a runlist?
[2012-07-06 01:03:14 -0400] hoover_damm: williamherry, when you make a new client make sure it's an admin client
[2012-07-06 01:03:21 -0400] timsmith: does node.attribute() cover that?
[2012-07-06 01:03:37 -0400] hoover_damm: if node.runlist.includes?("somethingnasty")
[2012-07-06 01:03:45 -0400] timsmith: thanks
[2012-07-06 01:03:58 -0400] hoover_damm: recipe[item] usually is how it rolls
[2012-07-06 01:04:06 -0400] hoover_damm: check out node.run_list to ensure
[2012-07-06 01:04:20 -0400] hoover_damm: btw it's run_list not runlist
[2012-07-06 01:04:21 -0400] williamherry: now chef-server can't boot up, it trying to connection to 5984 and fail, what program provide 5984?
[2012-07-06 01:04:32 -0400] hoover_damm: 5984 is couchdb
[2012-07-06 01:08:47 -0400] williamherry: thanks all, now it works, but I can't find why this problem happened
[2012-07-06 01:11:34 -0400] hoover_damm: couchdb going away
[2012-07-06 01:11:36 -0400] hoover_damm: could be all of it
[2012-07-06 01:11:53 -0400] hoover_damm: and as couchdb is erlang based... it doesn't like to crash really
[2012-07-06 01:11:58 -0400] hoover_damm: so it could have recovered on it's own
[2012-07-06 01:12:13 -0400] williamherry: hoover_damm, yes, I am checking the log
[2012-07-06 01:13:14 -0400] cheesepl_: it's hard to kill the erlang sometimes
[2012-07-06 01:13:25 -0400] erikh: killall the erlangs
[2012-07-06 01:13:51 -0400] cheesepl_: it sometimes gets crafty and keeps on going regardless
[2012-07-06 01:14:01 -0400] cheesepl_: it's like whackamole
[2012-07-06 01:15:01 -0400] williamherry: I recall something, I use a vmware guest, ans last night, I shut my compute without shutdown vmware, is this the source of problem may be?
[2012-07-06 01:15:38 -0400] williamherry: and this morning the guest's time is not correct
[2012-07-06 01:18:53 -0400] hoover_damm: time is important
[2012-07-06 01:18:59 -0400] hoover_damm: having the wrong clock time can be all it is
[2012-07-06 01:19:02 -0400] hoover_damm: 5minutes is all it takes
[2012-07-06 01:19:22 -0400] hoover_damm: erikh, let's replace opscode's secret erlang sauce with ruby sauce... and see if they notice
[2012-07-06 01:19:25 -0400] hoover_damm: j/k
[2012-07-06 01:20:16 -0400] cheesepl_: even a little drift can throw everything for a loop
[2012-07-06 01:20:54 -0400] hoover_damm: most people don't know about all the TSC bugs that used to plague the kernel
[2012-07-06 01:21:05 -0400] hoover_damm: god a lovely thing time is
[2012-07-06 01:40:12 -0400] jameson: is there a way to have chef-client kill itself?
[2012-07-06 01:40:33 -0400] jameson: i'm using the aws cookbook, but if you do elastic_ip LWRP you end up with the connection just hanging ~_~
[2012-07-06 03:28:05 -0400] williamherry: upload cookbook stuck
[2012-07-06 03:29:47 -0400] hoover_damm: knowing your problem earlier williamherry I wouldn't be shocked
[2012-07-06 03:30:00 -0400] hoover_damm: williamherry, ever find out if it was couchdb crashing?
[2012-07-06 03:30:25 -0400] williamherry: couchdb not crash this time
[2012-07-06 03:31:08 -0400] williamherry: chef server's log flash very fast
[2012-07-06 03:31:34 -0400] williamherry: action is upload_checksum, looks like a dead loop
[2012-07-06 03:35:43 -0400] hoover_damm: well uploading uploads to couchdb
[2012-07-06 03:35:54 -0400] hoover_damm: so if you ^C and you can delete the cookbook and reupload it
[2012-07-06 03:35:55 -0400] hoover_damm: and it works
[2012-07-06 03:36:03 -0400] hoover_damm: you need to dig into couchdb
[2012-07-06 03:37:45 -0400] williamherry: hoover_damm, thank you
[2012-07-06 03:39:38 -0400] hoover_damm: williamherry, you should have the chef-server cookbook running on your server and make sure it compacts your couchdb database regularly
[2012-07-06 03:40:49 -0400] hoover_damm: williamherry, http://wiki.opscode.com/display/chef/Backing+Up+Chef+Server
[2012-07-06 03:58:43 -0400] l1x: hey
[2012-07-06 03:58:45 -0400] l1x: https://github.com/opscode-cookbooks/mysql
[2012-07-06 03:58:59 -0400] l1x: where should i configure these tunable values?
[2012-07-06 06:39:04 -0400] BryanWB_: ohai chefs!
[2012-07-06 06:44:59 -0400] specialsauce: o/
[2012-07-06 06:46:48 -0400] BryanWB_: \o
[2012-07-06 06:57:52 -0400] kiesia: hi, is there any reason why I couldn't set a default attribute (in a role) on an included recipe?
[2012-07-06 06:58:12 -0400] kiesia: I'm using rvm_passenger, which includes nginx::soure
[2012-07-06 06:58:46 -0400] kiesia: but I can't seem to set the default ['nginx']['version'] in my role
[2012-07-06 06:59:13 -0400] kiesia: though I can change other attributes, like worker_processes
[2012-07-06 07:50:02 -0400] cnf: paulmooring: are you here?
[2012-07-06 08:22:12 -0400] williamherry: what if the client is not in the same time location with the server?
[2012-07-06 08:24:12 -0400] kiesia: oh, to answer my own question, there is a bug in the nginx cookbook: https://github.com/opscode-cookbooks/nginx/pull/13/files
[2012-07-06 08:29:04 -0400] BryanWB_: is http://download.fedoraproject.org down for everyone? it is killing my `knife bootstrap`
[2012-07-06 08:32:47 -0400] fooforge: Yip, it's gone.
[2012-07-06 08:38:31 -0400] zoubi: hi
[2012-07-06 08:39:14 -0400] zoubi: anyone would know why, using this cookbook, https://github.com/coroutine/chef-postgresql, and specifying the override_attributes in the role (to use 9.1), it still tries to install postgresql 8.4?
[2012-07-06 08:43:17 -0400] jacobat: Hi all. My rabbitmq server has gone down and it won't start - here's the content of /var/log/rabbitmq/startup_log: http://pastie.org/4209047 - any ideas?
[2012-07-06 09:31:37 -0400] mhalligan: can somebody point me at an easy way to run "ad-hoc" recipes from the command-line? I have a bootstrapping scenario where I'd like to have a script run a chef user block before I've actually run chef-client
[2012-07-06 09:32:27 -0400] mhalligan: duh chef-solo
[2012-07-06 09:32:28 -0400] msf: man chef-solo ?
[2012-07-06 09:33:04 -0400] laurent\: hmm, run chef-solo as a pre-script to chef-client ? :)
[2012-07-06 09:34:21 -0400] laurent\: that would be a weird idea, but i don't know what you really want to achieve
[2012-07-06 09:34:51 -0400] laurent\: ah sorry, i misses the bootstrap word in your sentence
[2012-07-06 09:35:13 -0400] laurent\: missed
[2012-07-06 09:35:18 -0400] laurent\: not my day
[2012-07-06 09:35:41 -0400] fooforge: jacobat: You probably have a corrupt mnesia database. Backup and then delete the database at /var/lib/mnesia (Debian). RabbitMQ regenerates it then. At least that's what bugged me most of the time with older versions of rabbitmq. 1.7.2 is rather outdated, 2 1/2 years old. You might wanna upgrade to 2.6.1 or so. Have a look a the changelog: http://www.rabbitmq.com/changelog.html
[2012-07-06 09:36:25 -0400] jacobat: fooforge: Yes, indeed it turned out to be a corrupt database, thanks :)
[2012-07-06 09:37:00 -0400] fooforge: Welcome.
[2012-07-06 10:12:25 -0400] jerem`: how to specify the cookbook_path with the "knife configure" command ?
[2012-07-06 10:12:34 -0400] jerem`: :go 2
[2012-07-06 10:12:36 -0400] jerem`: oups
[2012-07-06 10:20:21 -0400] jerem`: With the -r option it works fine !
[2012-07-06 10:23:09 -0400] zoubi_: I have a role which has a single recipe in its run_list. This recipe depends on several other cookbooks, like apt, build-essential and postgresql (in this order)
[2012-07-06 10:23:52 -0400] zoubi_: when I run chef-client, specifying this role, it tries to install postgresql BEFORE installing build-essential, causing it to fail when installing the gem 'pg' package
[2012-07-06 10:24:09 -0400] zoubi_: I have this log when I run chef-client http://pastebin.com/dF5Q06kH
[2012-07-06 10:24:16 -0400] zoubi_: I don't know what's causing this
[2012-07-06 10:24:24 -0400] zoubi_: any idea would be welcomed
[2012-07-06 10:25:53 -0400] ashb: zoubi_: what cookbooks are you using?
[2012-07-06 10:26:17 -0400] ashb: zoubi_: depending on the build essential doesn't run the cookbook, it just makes it available on the server
[2012-07-06 10:26:36 -0400] ashb: you either need to put it in the runlist before your DB one, or include_receipe in your DB receipe
[2012-07-06 10:27:09 -0400] zoubi_: here is the beginning of my DB cookbook http://pastebin.com/m4bdyWrw
[2012-07-06 10:27:20 -0400] zoubi_: and here is my node file
[2012-07-06 10:27:31 -0400] zoubi_: run_list "recipe[creatures::database]"
[2012-07-06 10:28:17 -0400] zoubi_: and my creatures metadata http://pastebin.com/95QEr5fE
[2012-07-06 10:29:19 -0400] ashb: zoubi_: and the role?
[2012-07-06 10:29:43 -0400] zoubi_: the role only contains the name and description properties, and the run_list I gave before
[2012-07-06 10:30:03 -0400] ashb: have you duoble checked that the uploaded version on the server matches?
[2012-07-06 10:31:12 -0400] zoubi_: I've deleted all the cookbooks and roles from the server (using knife) and uploaded them again
[2012-07-06 10:36:13 -0400] zoubi_: ashb, what's weird, is that if I comment include_recipe "postgresql::server" from the database recipe, it installs build-essential...
[2012-07-06 10:38:05 -0400] ashb: what does running chef-client with -l debug show?
[2012-07-06 10:38:55 -0400] intinig: hello all. I have a recipe (rvm_passenger::nginx) that fails the first time I run it because it tries to access a nil value (node[nginx][foo], node[nginx] is nil). When I run it the second time it works. Any idea on why that might happen?
[2012-07-06 10:39:19 -0400] ashb: something created node['nginx']
[2012-07-06 10:39:39 -0400] ashb: or its not idempotent and isn't retrying everything the same
[2012-07-06 10:40:17 -0400] intinig: ashb: in either case it's a fault of the recipe, so I should try and look into that. correct? :)
[2012-07-06 10:42:15 -0400] intinig: hmm the problem is actually in opscode's nginx::source recipe
[2012-07-06 10:42:17 -0400] intinig: https://github.com/cookbooks/nginx/blob/master/recipes/source.rb
[2012-07-06 10:42:59 -0400] ashb: intinig: oh?
[2012-07-06 10:43:26 -0400] intinig: this line
[2012-07-06 10:43:26 -0400] intinig: node.automatic_attrs['nginx']
[2012-07-06 10:43:33 -0400] intinig: causes the problem
[2012-07-06 10:43:40 -0400] intinig: where can I get info about automatic_attrs?
[2012-07-06 10:43:43 -0400] ashb: i don't see that in the file you linked
[2012-07-06 10:44:13 -0400] intinig: yep it's in the recipe I got on my drive, I got it via knife ec2 cookbook
[2012-07-06 10:44:28 -0400] zoubi_: ashb here is the full log http://pastebin.com/x9cxaR8m
[2012-07-06 10:44:47 -0400] intinig:     nginx (0.101.6)
[2012-07-06 10:44:52 -0400] intinig: taken from community.opscode.com
[2012-07-06 10:45:50 -0400] ashb: zoubi_: not sure
[2012-07-06 10:45:52 -0400] intinig: this is the full snippet of non-working code https://gist.github.com/3059465
[2012-07-06 10:46:45 -0400] zoubi_: ashb those lines are interesting http://pastebin.com/vHmyMMff
[2012-07-06 10:47:04 -0400] zoubi_: why do I have these? Platform ubuntu not found, using all defaults. (Unsupported platform?)
[2012-07-06 10:47:34 -0400] zoubi_: I'm running chef-client from a vagrant machine with a precise32 box
[2012-07-06 10:50:41 -0400] PapaSierra: i have a fresh ubuntu12 vm. i'm using cookbooks from opscode and one from percona (mysql). my runlist is simply "apt" followed by "percona::server". I'm getting this http://dpaste.com/767993/ and i think it's something to do with apt and packages for percona. i don't know what to do next
[2012-07-06 11:05:50 -0400] zoubi_: ashb this pull rtequest seems to work https://github.com/opscode-cookbooks/postgresql/pull/2
[2012-07-06 11:14:54 -0400] ashb: zoubi_: that means you can't also use the database resources to create a DB that run
[2012-07-06 11:14:57 -0400] ashb: or create users etc
[2012-07-06 11:16:52 -0400] ashb: zoubi_: try to compare what oyu have with what is here: https://github.com/historymesh/historymesh-chef
[2012-07-06 11:17:01 -0400] ashb: that installs Pg and build-essentials fine for me
[2012-07-06 11:17:04 -0400] PapaSierra: is anyone able to commit on my paste above? ^
[2012-07-06 11:18:06 -0400] ashb: PapaSierra: looks like something isn't adding the apt repo right
[2012-07-06 11:19:07 -0400] PapaSierra: ashb right, i'm using this to set up chef with a few requirements like ruby and git, etc. then i'm running the percona-chef recipe. https://gist.github.com/2974764
[2012-07-06 11:20:25 -0400] PapaSierra: am i to assume that something here is broken? i wouldn't have thought so, but equally i'm on a very bare ubuntu12 vm so i can't see what could be wrong with my environment https://github.com/phlipper/chef-percona
[2012-07-06 11:20:28 -0400] ashb: PapaSierra: how does the percona::server receipe add the apt repo?
[2012-07-06 11:20:40 -0400] PapaSierra: um let me see...
[2012-07-06 11:21:11 -0400] ashb: its possible there isn't a 12.04 percona package yet?
[2012-07-06 11:21:23 -0400] PapaSierra: https://github.com/phlipper/chef-percona/blob/master/recipes/default.rb
[2012-07-06 11:23:06 -0400] PapaSierra: ashb that could be possible. how can i know for sure? since moving to linux i'm finding this is a chronic problem, it seems like we should always use a slightly older version of linux?
[2012-07-06 11:24:10 -0400] ashb: PapaSierra: ask google?
[2012-07-06 11:24:27 -0400] PapaSierra: i'm new to the idea of apt so i'm not sure what to ask!
[2012-07-06 11:24:40 -0400] PapaSierra: i saw this, useful? http://www.ubuntuupdates.org/ppa/percona_server_with_xtradb?dist=oneiric
[2012-07-06 11:24:54 -0400] ashb: 'percona 12.04 ubuntu package'
[2012-07-06 11:25:15 -0400] PapaSierra: here's the 12 version http://www.ubuntuupdates.org/ppa/percona_server_with_xtradb?dist=precise
[2012-07-06 11:25:43 -0400] ashb: okay, run an apt-get update on your box and see if it hits the percona server
[2012-07-06 11:25:55 -0400] PapaSierra: it does
[2012-07-06 11:26:23 -0400] PapaSierra: for instance: http://dpaste.com/768005/
[2012-07-06 11:28:08 -0400] ashb: $ apt-cache policy percona-server-server
[2012-07-06 11:28:38 -0400] PapaSierra: ok, in the mean time i did apt-get update followed by running chef again and it looks like its done it!
[2012-07-06 11:29:00 -0400] PapaSierra: http://dpaste.com/768008/
[2012-07-06 11:30:11 -0400] PapaSierra: ok, it's installed, very nice, but who should be responsible for calling apt-get update?
[2012-07-06 11:30:28 -0400] ashb: i thought that the thing that adds the repo does it
[2012-07-06 11:30:46 -0400] PapaSierra: yeah:   notifies :run, "execute[apt-get update]", :immediately
[2012-07-06 11:31:12 -0400] PapaSierra: does it look right to you? https://github.com/phlipper/chef-percona/blob/master/recipes/default.rb
[2012-07-06 11:32:06 -0400] cnf: PapaSierra: the apt package does an update, btw
[2012-07-06 11:32:06 -0400] ashb: not quite sure why there's a --force-yes, but possibly
[2012-07-06 11:32:19 -0400] intinig: I have done some more tests
[2012-07-06 11:32:20 -0400] cnf: the apt cookbook, even
[2012-07-06 11:32:25 -0400] intinig: and I can confirm it's the nginx cookbook
[2012-07-06 11:32:35 -0400] intinig: I am going to open a ticket and pray :)
[2012-07-06 11:32:52 -0400] ashb: https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb#L68-97
[2012-07-06 11:33:25 -0400] PapaSierra: cnf, if you look at https://gist.github.com/2974764 line 14, i do an apt-get update there. then in my runlist is "apt" and "percona::server", so i'm not sure what's wrong
[2012-07-06 11:34:23 -0400] cnf: PapaSierra: i just got in, what is the problem?
[2012-07-06 11:36:14 -0400] PapaSierra: ashb helped me realise what was wrong, but i don't know how to fix it. problem = my run list is apt and percona::server. percona adds to the source list and then should do an apt-get update. then it tries to install. in fact what's happening is that the install fails because apt-get update doesn't run. so once it fails i then apt-get update and then run chef again and it works the second time around.
[2012-07-06 11:36:40 -0400] PapaSierra: however, https://github.com/phlipper/chef-percona/blob/master/recipes/default.rb#L17 suggests that apt-get update should be run, no?
[2012-07-06 11:37:11 -0400] ashb: PapaSierra: this is where the debug logs are your friend
[2012-07-06 11:37:13 -0400] ashb: did it run or not?
[2012-07-06 11:37:13 -0400] PapaSierra: i'm not sure how the notifier works, but since apt cookbook is run first, i imagine it sets up listeners
[2012-07-06 11:38:04 -0400] PapaSierra: are you asking if apt-get update ran or not?
[2012-07-06 11:38:24 -0400] ashb: asking if it ran after the key and repo were added.
[2012-07-06 11:38:41 -0400] PapaSierra: ok, i'll have to wipe my server and rerun chef to find out, right?
[2012-07-06 11:39:48 -0400] ashb: its the easiest way if oyu can, yes
[2012-07-06 11:40:45 -0400] PapaSierra: so solo.rb should have log_level debug, right?
[2012-07-06 11:41:06 -0400] ashb: no clue
[2012-07-06 11:41:30 -0400] PapaSierra: well you said debug logs
[2012-07-06 11:41:52 -0400] PapaSierra: what did you mean? other than seeing screeds of logging on the terminal from chef solo?
[2012-07-06 11:42:03 -0400] cnf: hmm
[2012-07-06 11:42:17 -0400] cnf: PapaSierra: yes...
[2012-07-06 11:42:36 -0400] ashb: PapaSierra: sorry - i meant I have no clue how to set it for chef-solo
[2012-07-06 11:43:16 -0400] PapaSierra: oh ok, yeah got it, i'm just waiting for the fresh server
[2012-07-06 11:43:37 -0400] PapaSierra: while i wait, if the debug shows it runs or doesn't, so what? what can i do about it?
[2012-07-06 11:47:46 -0400] PapaSierra: ashb cnf this is the full extent of what i can capture during the chef-solo run http://dpaste.com/768014/
[2012-07-06 11:48:41 -0400] ashb: PapaSierra: how up to date is your apt cookbook?
[2012-07-06 11:48:46 -0400] cnf: seems to run the update
[2012-07-06 11:49:12 -0400] ashb: oh i wonder if the problem is the fact that 'execute[apt-get update]' has already run once in that chef run...
[2012-07-06 11:49:32 -0400] ashb: cnf: not after the key is added on line 98
[2012-07-06 11:49:38 -0400] PapaSierra: i added opscode/apt repo as a submodule last night, so it's 100% up to date.
[2012-07-06 11:49:46 -0400] ashb: (at least there is no output for it)
[2012-07-06 11:50:02 -0400] PapaSierra: and yes, i feel the same, that apt feels it's already run so doesn't do it the same
[2012-07-06 11:50:10 -0400] PapaSierra: again
[2012-07-06 11:50:15 -0400] cnf: right
[2012-07-06 11:50:31 -0400] cnf: it checks a file
[2012-07-06 11:50:35 -0400] cnf: to see if it has already run
[2012-07-06 11:51:32 -0400] PapaSierra: did they not anticipate this? or have i don't something wrong?
[2012-07-06 11:51:59 -0400] ashb: no idea - suggest trying the mailing list
[2012-07-06 11:52:04 -0400] cnf: PapaSierra: no, this sort of thing is my general experience with chef cookbooks so far
[2012-07-06 11:52:55 -0400] PapaSierra: so what are we expected to do? run chef then manually apt-get udpate and then run chef again?
[2012-07-06 11:53:51 -0400] ashb: ask on the mailing list what to do. it should never be required to run chef twice to get something to work
[2012-07-06 11:53:53 -0400] PapaSierra: or, if apt-get update runs again in the second round then we just run chef twice?
[2012-07-06 11:53:55 -0400] cnf: https://github.com/opscode-cookbooks/apt/blob/master/providers/repository.rb#L78
[2012-07-06 11:54:12 -0400] PapaSierra: ok ashb, where is the mailing list?
[2012-07-06 11:54:16 -0400] ashb: mailing list?
[2012-07-06 11:54:17 -0400] ashb: list?
[2012-07-06 11:54:18 -0400] bawt_: list is at lists.opscode.com
[2012-07-06 11:54:55 -0400] ashb: PapaSierra: you can try editing you copy of that file that cnf just linked to and try making the notifies on line 95 be immediate
[2012-07-06 11:58:46 -0400] PapaSierra: ashb so i'd have to create a fork?
[2012-07-06 11:58:52 -0400] PapaSierra: of apt?
[2012-07-06 11:59:29 -0400] ashb: just edit your local version
[2012-07-06 11:59:44 -0400] PapaSierra: i'm using git submodules
[2012-07-06 12:00:03 -0400] ashb: oh right. um I don't use that - i just use the knife cookbook site vneodr apt type thing
[2012-07-06 12:02:31 -0400] PapaSierra: ashb https://github.com/opscode-cookbooks/apt/pull/8
[2012-07-06 12:08:36 -0400] PapaSierra: cnf ashb i like what this fork has done: https://github.com/hectcastro/apt/commit/f778a22e6832ff8ee71ebb33b0ef9b3baa011857 though i'm using a solo.json file to specify attributes, what would the syntax be for setting his "immediate_cache_rebuild" to TRUE?
[2012-07-06 12:24:43 -0400] zoubi_: is there a specific requirement about ruby to run knife on windows?
[2012-07-06 12:25:17 -0400] zoubi_: I got this : http://pastebin.com/MAa7cCUQ
[2012-07-06 12:33:04 -0400] sascha_d: zoubi_ did you follow the directions to create a management workstation?
[2012-07-06 12:33:29 -0400] zoubi_: sascha_d, yes. The only difference if that I have ruby 1.9.3 instead of 1.8.7
[2012-07-06 12:34:30 -0400] sascha_d: well, I haven't used windows to manage Chef so I can't help with issues there.  I just knew there was a page: http://wiki.opscode.com/display/chef/Workstation+Setup+for+Windows
[2012-07-06 12:39:20 -0400] sascha_d: zoubi_ here's the source code for what you're using: https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/cookbook_site_install.rb
[2012-07-06 12:40:25 -0400] sascha_d: @install_path = File.expand_path(config[:cookbook_path].first) is the line
[2012-07-06 12:40:26 -0400] zoubi_: sascha_d, this line in particlar https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/cookbook_site_install.rb#L77
[2012-07-06 12:40:30 -0400] zoubi_: yes
[2012-07-06 12:40:37 -0400] sascha_d: Does your knife.rb have a cookbook_path?
[2012-07-06 12:40:50 -0400] zoubi_: yes$
[2012-07-06 12:41:13 -0400] zoubi_: http://pastebin.com/BK0ZNErW
[2012-07-06 12:42:52 -0400] sascha_d: put bracketsyeah ok
[2012-07-06 12:42:57 -0400] sascha_d: put brackets around your path
[2012-07-06 12:43:12 -0400] sascha_d: I just reproduced on my mac and it's because that setting is an array
[2012-07-06 12:43:28 -0400] sascha_d: it can't call .first on a string
[2012-07-06 12:44:05 -0400] zoubi_: oh yeah
[2012-07-06 12:44:07 -0400] zoubi_: thanks
[2012-07-06 12:47:17 -0400] PapaSierra: ashb that :immediately worked
[2012-07-06 12:47:29 -0400] cnf: \o/
[2012-07-06 12:47:40 -0400] PapaSierra: thanks cnf!
[2012-07-06 12:47:51 -0400] cnf: i didn't do much ^^;
[2012-07-06 12:48:48 -0400] PapaSierra: that was very helpful! though, something is strange about all this. these guys are far smarted than me and i'm taking baby steps with chef, so how is it that the pros haven't run into these issues? that just confuses me
[2012-07-06 12:49:17 -0400] PapaSierra: this is by no means a corner case or me overstretching the limits of chef. flipping weird
[2012-07-06 12:49:29 -0400] zoubi_: sascha_d, new problem :)
[2012-07-06 12:49:45 -0400] sascha_d: windows is insidious like that
[2012-07-06 12:49:56 -0400] ashb: PapaSierra: if you haven't already please mention this on the list and say 'this fixed it for me- is this right?'
[2012-07-06 12:50:08 -0400] zoubi_: it can't untar the file, because it converts p:/chef-workstation/cookbooks/postgresqltar.gz into p\:/chef-workstation/cookbooks/postgresqltar.gz
[2012-07-06 12:50:19 -0400] zoubi_: I don't get why it puts an extra \ after the drive letter
[2012-07-06 12:50:21 -0400] PapaSierra: ashb ok, doing so now...
[2012-07-06 12:56:32 -0400] PapaSierra: in order to install php of a newer version than what is present in the ubuntu repos, i'll have to build from source right?
[2012-07-06 12:56:54 -0400] jatan: or you can find somebody who has done that and provided their work in a repo?
[2012-07-06 12:57:16 -0400] cnf: PapaSierra: like i said, stuff like this has been my general experience with cookbooks
[2012-07-06 12:57:29 -0400] cnf: PapaSierra: most of the ones i have used have little issues like that
[2012-07-06 12:57:59 -0400] sascha_d: zoubi_ I can't answer that. I've never used windows to manage Chef, just deployed windows cookbooks onto servers
[2012-07-06 12:58:03 -0400] PapaSierra: well it looks like the opscode php repo allows for building php from source.
[2012-07-06 12:58:12 -0400] sascha_d: zoubi_ it could be a bug
[2012-07-06 12:58:55 -0400] PapaSierra: obviously i'd be a little more comfortable with a package, but since ubuntu seems to only go up to php 5.3.10 and i want 5.4.x i believe i need to install from source
[2012-07-06 12:59:52 -0400] zoubi_: sascha_d, I think it is... but I don't know ruby at all
[2012-07-06 13:01:58 -0400] cnf: PapaSierra: did you not get that working?
[2012-07-06 13:03:00 -0400] PapaSierra: not yet
[2012-07-06 13:08:32 -0400] PapaSierra: ashb i tried to send to the list but i'm getting Authorization denied
[2012-07-06 13:09:56 -0400] ashb: you'll probably have to subscribe first
[2012-07-06 13:10:06 -0400] PapaSierra: yeah, i thought i had.
[2012-07-06 13:11:07 -0400] PapaSierra: ah ok, now i'm subscribed
[2012-07-06 13:32:50 -0400] maruq: hi guys
[2012-07-06 13:33:13 -0400] maruq: just a quick question on the search stuff - is it possible to use it in a role file?
[2012-07-06 13:33:40 -0400] maruq: I know it can be called in the recipe, or from knife, but not sure at what point things connect up
[2012-07-06 13:34:23 -0400] maruq: eg. for the 2nd "Role File Examples" on https://github.com/brianbianco/redisio/, could I drop in a search?
[2012-07-06 13:37:15 -0400] yfeldblum: maruq, no
[2012-07-06 13:37:27 -0400] yfeldblum: maruq, roles are simply, purely, and only static JSON data
[2012-07-06 13:37:40 -0400] maruq: yfeldblum: bugger
[2012-07-06 13:38:38 -0400] maruq: yfeldblum: but roles are defined as ruby files, no? could I just whack a couple of lines, grab what I need, then pass to the attributes as a var?
[2012-07-06 13:38:45 -0400] yfeldblum: maruq, you may, at your convenience, write them in ruby - but that ruby is only run when you want to upload the role and you run `knife role from file ROLE.rb` and knife runs it before uploading it so that when the chef-server or any chef-clients get it, it's already been compiled down into pure, simple, static JSON data
[2012-07-06 13:39:32 -0400] maruq: yfeldblum: hmm so if I write it in ruby, and it compiles to clean JSON, it'd work?
[2012-07-06 13:39:47 -0400] maruq: yfeldbum: although, I guess then it's not dynamic :(
[2012-07-06 13:40:31 -0400] yfeldblum: maruq, that's right, it will only be run at the time you do `knife role from file ROLE.rb`
[2012-07-06 13:41:19 -0400] yfeldblum: maruq, search ought typically be conducted in recipes or, possibly, definitions/libraries (which are in cookbooks)
[2012-07-06 13:41:44 -0400] maruq: yfeldblum: okay cool, that makes sense. it just makes my task a lot harder
[2012-07-06 13:43:53 -0400] yfeldblum: maruq, from my perspective, it actually makes your task a lot easier; perhaps you just need to learn and practice some of the typical patterns for writing recipes?
[2012-07-06 13:44:50 -0400] maruq: yfeldblum: quite possibly. I was just hoping to throw a few vars in role & be good to go
[2012-07-06 13:58:43 -0400] myusuf3: what is a LWRP?
[2012-07-06 13:58:58 -0400] jameson: anyone using supervisord?
[2012-07-06 13:59:08 -0400] jameson: myusuf3: functions provided by other cookbooks
[2012-07-06 13:59:14 -0400] jameson: in a really really simple sense :|
[2012-07-06 13:59:19 -0400] zoubi_: you guys have any problem installing apache2::mod_php5 on precise pangolin?
[2012-07-06 13:59:31 -0400] jameson: zoubi_: nope, I do that with the nagios::server
[2012-07-06 13:59:31 -0400] zoubi_: [Fri, 06 Jul 2012 13:52:28 +0000] FATAL: Chef::Exceptions::Exec: package[libapache2-mod-php5] (apache2::mod_php5 line 22) had an error: Chef::Exceptions::Exec: apt-get -q -y install libapache2-mod-php5=5.3.10-1ubuntu3.1 returned 100, expected 0
[2012-07-06 13:59:38 -0400] myusuf3: jameson I have used it in the past
[2012-07-06 13:59:42 -0400] myusuf3: whats up?
[2012-07-06 13:59:50 -0400] jameson: 09:58 < myusuf3> what is a LWRP?
[2012-07-06 13:59:55 -0400] jameson: oh
[2012-07-06 14:00:00 -0400] jameson: do you use the cookbook?
[2012-07-06 14:00:06 -0400] zoubi_: jameson, me?
[2012-07-06 14:00:11 -0400] myusuf3: jameson haha I was talking about supervisord
[2012-07-06 14:00:22 -0400] jameson: myusuf3: you use the cookbook for supervisord?
[2012-07-06 14:00:41 -0400] myusuf3: no; i haven't I switched to upstart once I started using cookbooks; i want to switch to runit after yesterday though
[2012-07-06 14:00:43 -0400] jameson: zoubi_: I don't remember that error. let me check my log, I just deployed a nagios::server with apache + modphp
[2012-07-06 14:00:58 -0400] jameson: myusuf3: any reason for those switches?
[2012-07-06 14:02:44 -0400] myusuf3: supervisord would sometimes just fail restarting things
[2012-07-06 14:03:20 -0400] myusuf3: and apprently upstart is hated and the restart doesn't work properly form a people in here
[2012-07-06 14:03:32 -0400] myusuf3: the consensus seems to be runit is the best for that type of thing.
[2012-07-06 14:03:40 -0400] myusuf3: but I am still using upstart
[2012-07-06 14:03:49 -0400] myusuf3: for now till becomes an issue.
[2012-07-06 14:05:43 -0400] jameson: mm
[2012-07-06 14:06:03 -0400] myusuf3: there are also a couple of others
[2012-07-06 14:06:05 -0400] myusuf3: called circus
[2012-07-06 14:06:14 -0400] myusuf3: my mozilla I was looking at yesterday
[2012-07-06 14:06:26 -0400] myusuf3: so quick question about LWRPs
[2012-07-06 14:06:44 -0400] myusuf3: so I have the cookbook installed can I use the LWRPs in recipes in other cookbooks?
[2012-07-06 14:06:49 -0400] jameson: yes
[2012-07-06 14:06:52 -0400] jameson: if you do
[2012-07-06 14:06:56 -0400] jameson: include_recipe
[2012-07-06 14:07:01 -0400] myusuf3: do I need to do require or something
[2012-07-06 14:07:03 -0400] jameson: at the top of the recipe that you use that in
[2012-07-06 14:07:10 -0400] jameson: include_recipe is like require
[2012-07-06 14:07:14 -0400] myusuf3: kk
[2012-07-06 14:07:29 -0400] jameson: also recommend that you do ` depends "somecookbook" `
[2012-07-06 14:07:32 -0400] jameson: in your metadata.rb
[2012-07-06 14:07:54 -0400] myusuf3: and include_recipe ????
[2012-07-06 14:07:58 -0400] jameson: metadata.rb will pull it when you install, include_recipe will guarantee that the recipe is processed before the current one
[2012-07-06 14:08:03 -0400] myusuf3: is that ??? cookbook name?
[2012-07-06 14:08:11 -0400] jameson: include_recipe would go into like recipes/default.rb (of your cookbook that uses)
[2012-07-06 14:08:15 -0400] jameson: yes
[2012-07-06 14:08:24 -0400] jameson: if you use python's pip or virtualenv
[2012-07-06 14:08:25 -0400] jameson: you would do
[2012-07-06 14:08:36 -0400] myusuf3: those being cookbooks
[2012-07-06 14:08:37 -0400] jameson: include_recipe "python" at the top of your recipe
[2012-07-06 14:08:44 -0400] jameson: and then you can do
[2012-07-06 14:08:47 -0400] myusuf3: or the cookbook would be pyton
[2012-07-06 14:08:50 -0400] myusuf3: python
[2012-07-06 14:08:53 -0400] jameson: python_pip "somepackage" do ...
[2012-07-06 14:09:13 -0400] myusuf3: haha
[2012-07-06 14:09:14 -0400] myusuf3: okay
[2012-07-06 14:09:22 -0400] myusuf3: so lets say I have package called rabbitmq
[2012-07-06 14:09:36 -0400] myusuf3: include_recipe rabbitmq?
[2012-07-06 14:09:47 -0400] myusuf3: or so i need to look at the recipe that define the LWRPs?
[2012-07-06 14:10:40 -0400] jameson: you just need the include_recipe "rabbitmq"
[2012-07-06 14:10:52 -0400] jameson: and then inside the recipe you can call rabbitmq's LWRPs
[2012-07-06 14:11:01 -0400] myusuf3: kk then I am able to call thier lwrps
[2012-07-06 14:11:03 -0400] myusuf3: awesome
[2012-07-06 14:11:09 -0400] myusuf3: now going back to metadata.rb
[2012-07-06 14:11:11 -0400] _rc: you just need a depends to be able to call them
[2012-07-06 14:11:30 -0400] myusuf3: _rc, and the depends looks like/
[2012-07-06 14:11:41 -0400] jameson: _rc: I was told depends doesn't guarantee  they will be processed before during convergence
[2012-07-06 14:12:04 -0400] _rc: myusuf3: http://wiki.opscode.com/display/chef/Metadata#Metadata-depends
[2012-07-06 14:12:51 -0400] _rc: jameson: depends will make the LWRP available.  you might need the default recipe to be included for the LWRP to be able to do it's thing, but that's not a 100% of the time thing
[2012-07-06 14:13:13 -0400] jameson: _rc: uh... that says
[2012-07-06 14:13:22 -0400] jameson: you have to do include_recipe
[2012-07-06 14:13:22 -0400] yfeldblum: myusuf3, (lightweight) resources and providers may be defined in cookbooks, but they re not defined in recipes
[2012-07-06 14:13:50 -0400] _rc: eg for the rabbitmq one, you can'e really use rabbitmq_user inless you have recipe[rabbitmq::default] to start the rabbitmq
[2012-07-06 14:13:53 -0400] _rc: jameson: no it doesn't
[2012-07-06 14:14:12 -0400] _rc: jameson: it says that it allows you to include_recipe
[2012-07-06 14:14:14 -0400] pehlert: Hey folks, I have just setup a fresh chef-server (using the chef-server cookbook, although that one is a bit broken or rather the current gems are) but when I try to bootstrap new nodes, all I get is this: http://pastie.org/4210344 .. I have already checked the validation.pem key on my server and my local client and they do match
[2012-07-06 14:14:19 -0400] yfeldblum: myusuf3, if you want access to a (lightweight) resource or provider defined in some other cookbook, to declare an instance of it in your recipe for example, your cookbook must depend on the other cookbook, and these dependencies are specified in the cookbook metadata
[2012-07-06 14:14:35 -0400] jameson: _rc: is it?
[2012-07-06 14:15:04 -0400] _rc: jameson: yes
[2012-07-06 14:15:19 -0400] nd__: Aloha
[2012-07-06 14:15:33 -0400] zoubi_: jameson: I figured out what the problem is: apt-get update was never called
[2012-07-06 14:15:36 -0400] _rc: if you include_recipe without the depends you may not have the cookbook available to include from,. that's the connection.
[2012-07-06 14:15:38 -0400] myusuf3: yfeldblum, I want to use a lwrp in reciepe in another cookbook
[2012-07-06 14:15:43 -0400] jameson: so depends makes it available, and include_recipe makes it usable(?)
[2012-07-06 14:15:44 -0400] myusuf3: is that okay/possible?
[2012-07-06 14:15:54 -0400] _rc: myusuf3: just add depends to your metedata and go to town
[2012-07-06 14:16:03 -0400] jameson: zoubi_: sounds about right, I think I got around that by always include apt in my base role :3
[2012-07-06 14:16:16 -0400] _rc: jameson: that's the patr that is dependent on the implementation of the LWRP
[2012-07-06 14:16:21 -0400] zoubi_: jameson, yeah, I'll need to do this too
[2012-07-06 14:16:25 -0400] nd__: Is there a simple way to manage skel files (or preferably only github references) for users?
[2012-07-06 14:16:45 -0400] jameson: @_@
[2012-07-06 14:16:58 -0400] _rc: jameson: as I said, with rabbitmq as an example, you can't add users with the rabbitmq_user LWRP unless rabbit is running, so you need to include that recipe to ensure it's running
[2012-07-06 14:17:12 -0400] _rc: jameson: but that's not going to be true 100% of the time
[2012-07-06 14:17:42 -0400] myusuf3: yeah so in my run_list
[2012-07-06 14:17:47 -0400] myusuf3: I would install rabbitmq
[2012-07-06 14:18:08 -0400] jameson: _rc: ah
[2012-07-06 14:19:43 -0400] jameson: myusuf3: yes
[2012-07-06 14:19:55 -0400] jameson: that only make sure it get installed eventually.
[2012-07-06 14:25:03 -0400] Mydalon: Hi, I want to look up certain nested attributes with knife search node "*:*" -a .....   But I don't know how to specify the nested attribute
[2012-07-06 14:25:10 -0400] jameson: depends makes it install before, include_recipe makes it run
[2012-07-06 14:25:43 -0400] _rc: jameson: no, depends ensures the cookbook is downloaded so you can use the LWRP/recipes from it
[2012-07-06 14:25:58 -0400] _rc: it doesn't make anything run
[2012-07-06 14:27:46 -0400] jameson: _rc: include_recipe makes it run(?)
[2012-07-06 14:27:57 -0400] jameson: Mydalon: you mean the part after -a?
[2012-07-06 14:28:23 -0400] yfeldblum: Mydalon, why?
[2012-07-06 14:28:57 -0400] _rc: jameson: yes
[2012-07-06 14:32:34 -0400] jameson: Mydalon: I believe the nested attributes are the ones you can access via shef
[2012-07-06 14:32:53 -0400] jameson: like -a cloud.public_hostname
[2012-07-06 14:33:03 -0400] jameson: :| that's how I'm using it anyhow
[2012-07-06 14:33:30 -0400] jperry2: is there any recommendation for how much memory would be good for a locally running chef server?
[2012-07-06 14:33:35 -0400] jperry2: on my own workstation
[2012-07-06 14:33:36 -0400] jperry2: j
[2012-07-06 14:33:41 -0400] Mydalon: Yeas, I have some dell boxes
[2012-07-06 14:33:41 -0400] jperry2: just for testing
[2012-07-06 14:33:54 -0400] jperry2: and then shut it down
[2012-07-06 14:34:05 -0400] Mydalon: And they have infos in dell[remote_access][ipv4_address] that I would like to see
[2012-07-06 14:34:15 -0400] jameson: try
[2012-07-06 14:34:22 -0400] jameson: dell.remote_access.ipv4_address
[2012-07-06 14:34:42 -0400] Mydalon: THX
[2012-07-06 14:34:45 -0400] Mydalon: that works!
[2012-07-06 14:35:17 -0400] Mydalon: I tried dell[remote_access] and dell_remote_access (like in search) but not the . notation
[2012-07-06 14:35:18 -0400] Mydalon: thx
[2012-07-06 14:35:33 -0400] jameson: np
[2012-07-06 14:36:41 -0400] jan0232: hi. having a little trouble with the "application" cookbook. seems to be working until it executes /etc/init.d/appname hup ...
[2012-07-06 14:36:55 -0400] jan0232: STDOUT: warning: appname: unable to open supervise/ok: access denied
[2012-07-06 14:37:03 -0400] jan0232: any ideas?
[2012-07-06 14:40:35 -0400] jameson: :| check the permission on the directories?
[2012-07-06 14:54:21 -0400] royh: is the yum provider supposed to do 50 000 x calls to version_parse?
[2012-07-06 14:56:32 -0400] jan0232: jameson: permissions on what..where my app is? everything seems fine except my current directory is empty..also the releases directory is empty :(
[2012-07-06 15:00:36 -0400] jan0232: ok the log shows that because /etc/init.d/app hup fails.thats why the current deploy code gets deleted again
[2012-07-06 15:00:44 -0400] jameson: jan0232: check /etc/init.d/appname ?
[2012-07-06 15:01:13 -0400] leifmadsen: when using chef_gem, it performs an installation of the gem before convergence. The wiki seems to imply, but doesn't specify, that gem_package seems to install at/after convergence?
[2012-07-06 15:01:37 -0400] jan0232: jameson: 's a link to /usr/bin/sv and: lrwxrwxrwx 1 root root
[2012-07-06 15:01:38 -0400] leifmadsen: e.g. gem_package installs a gem inline, and not prior to convergence?
[2012-07-06 15:04:46 -0400] jameson: does
[2012-07-06 15:04:53 -0400] jameson: jan0232: does that file exist?
[2012-07-06 15:05:23 -0400] jameson: then after that it would be options passed
[2012-07-06 15:05:44 -0400] jan0232: jameson: yep. i'm not quite sure what the application cookbook does here. my guess is this is using runit to somehow register the app as a service?
[2012-07-06 15:06:14 -0400] jameson: that is what it is doing
[2012-07-06 15:06:39 -0400] jperry2: anyone know how to check the version of the chef server?
[2012-07-06 15:07:01 -0400] jameson: :|
[2012-07-06 15:07:48 -0400] jperry2: looks like you can get it from the webui
[2012-07-06 15:08:33 -0400] jperry2: I wonder if you get that info from knife
[2012-07-06 15:16:13 -0400] pehlert: Hum, has anyone ever tried to manage their chef server via chef as well? i.e. add it as a node? That should work, no?
[2012-07-06 15:17:03 -0400] jameson: in a round-about way
[2012-07-06 16:16:36 -0400] jerem`: how to get a particular role in my template file ?
[2012-07-06 16:16:57 -0400] jerem`: my role is named "monitoring"
[2012-07-06 16:17:25 -0400] jerem`: I've only one node in this role
[2012-07-06 16:17:46 -0400] jerem`: and I would like get the IP of this node
[2012-07-06 16:17:52 -0400] ashb: search
[2012-07-06 16:17:56 -0400] ashb: search?
[2012-07-06 16:17:56 -0400] bawt_: search is http://wiki.opscode.com/display/chef/Search
[2012-07-06 16:18:30 -0400] cnf: jerem`: you shouldn't search for your role in your template, i don't think
[2012-07-06 16:18:31 -0400] ashb: searhc(:node, 'role:monitoring')[0]['ipaddress']
[2012-07-06 16:18:32 -0400] ashb: give or take
[2012-07-06 16:18:43 -0400] ashb: and yeah, don't search in the template, search in the receipe and pass the info in
[2012-07-06 16:18:48 -0400] cnf: rather search for attributes, which you can set in your role
[2012-07-06 16:19:31 -0400] cnf: jerem` so make a role, which has an attribute monitoring => { ip => 1.2.3.4 }
[2012-07-06 16:19:44 -0400] cnf: and search for that
[2012-07-06 16:20:28 -0400] cnf: jerem`: keeps your recepies  reusable
[2012-07-06 16:27:05 -0400] jerem`: thanks guys
[2012-07-06 16:28:17 -0400] leifmadsen: hmmm, I'm getting a Bad Request 400 back from my chef server when using 'knife ssh', although it wasn't doing that this morning... any suggestions on where to start looking?
[2012-07-06 16:28:34 -0400] leifmadsen: a 'knife node list' returns fine, so it's not an id:nil error like I've had before
[2012-07-06 16:30:05 -0400] yfeldblum: leifmadsen, more details might help
[2012-07-06 16:30:51 -0400] leifmadsen: ya, I'm not really sure why to provide to be honest... on the console I get:  ERROR: Server returned error for http://my_chef_server:4000/search/node?q=name:ProvServ.....
[2012-07-06 16:31:19 -0400] leifmadsen: seems to be an error returned via HTTP REquest Returned 500 Internal Server Error: Connection refused - connect(2)
[2012-07-06 16:31:37 -0400] leifmadsen: validation.pem and all the authentication stuff should be fine, especially as other commands to query the server work fine
[2012-07-06 16:32:38 -0400] leifmadsen: clicking the erroring out link seems to return a page from merb with a Bad Request 400, Mixlib::Authentication::MissingAuthenticationHeader
[2012-07-06 16:33:54 -0400] yfeldblum: leifmadsen, that's an API endpoint, and all requests to the API endpoints must be signed; when you attempt to navigate to an API endpoint in the browser, the requests will not be signed; the errors you see when browsing therefore have got zero to do with the errors that knife is seeing
[2012-07-06 16:34:11 -0400] yfeldblum: leifmadsen, do all searches fail? including those exact searches which worked yesterday?
[2012-07-06 16:35:54 -0400] leifmadsen: yfeldblum: ya something had to have changed here locally I suppose since this was working this morning... not sure what exactly changed. I'll keep looking, thanks.
[2012-07-06 16:36:12 -0400] leifmadsen: probably a typo in a configuration file I made somewhere locally
[2012-07-06 16:36:57 -0400] leifmadsen: i suspect something to do with the hostname update I had to make
[2012-07-06 16:37:46 -0400] yfeldblum: leifmadsen, if all searches fail, you may want to check if solr is up
[2012-07-06 16:37:58 -0400] leifmadsen: ah good call
[2012-07-06 16:38:00 -0400] leifmadsen: thanks
[2012-07-06 16:39:47 -0400] jan0232: this is weirdwhat permissions does a user need to have to run a runit service? i want to use the application cookbook. i created a group app with user app
[2012-07-06 16:40:06 -0400] jan0232: i get "unable to open supervise/ok: access denied"
[2012-07-06 16:41:39 -0400] jan0232: if i pass owner "root" and group "root" to the application blockit works...
[2012-07-06 16:41:40 -0400] leifmadsen: yfeldblum: aha yep that was it.  Is there a way to force solr to update the database for the searches? Seems my recently added systems are not searchable
[2012-07-06 16:41:49 -0400] jan0232: but i don't want the app to run as root
[2012-07-06 16:44:27 -0400] yfeldblum: leifmadsen, i believe you can ask the chef-server to kick off a reindex
[2012-07-06 16:44:57 -0400] yfeldblum: leifmadsen, possibly `knife index rebuild`, but you may prefer to lookup the docs or manpage first
[2012-07-06 16:45:18 -0400] Mithrandir: (iirc, it's knife index rebuild, yes)
[2012-07-06 16:46:09 -0400] yfeldblum: jan0232, only root can run runit, of course; in your runit script, you may elect to change the uid (and other variables) of the current process before execing your app
[2012-07-06 16:47:16 -0400] jan0232: yfeldblum: ok yes. however, the application recipe won't work unless i specify owner as root it fails at "/etc/init.d/appname hup"
[2012-07-06 16:48:37 -0400] yfeldblum: jan0232, why do you have an init script if you're using runit?
[2012-07-06 16:49:15 -0400] jan0232: yfeldblum: i have no idea ;)  it's what opscode's application cookbook does behind the scenes
[2012-07-06 16:51:50 -0400] jan0232: maybe i should not use it and roll my own...
[2012-07-06 16:54:08 -0400] yfeldblum: jan0232, you may elect to use the application_ruby cookbook instead, rather than the application::unicorn recipe from the application cookbook
[2012-07-06 16:54:23 -0400] jan0232: yfeldblum: i'm sorry, that's what i'm using
[2012-07-06 16:54:36 -0400] yfeldblum: jan0232, then i'm looking at this line: https://github.com/opscode-cookbooks/application_ruby/blob/master/providers/unicorn.rb#L34
[2012-07-06 16:54:45 -0400] yfeldblum: jan0232, it tells me you need to provide your own restart command
[2012-07-06 16:55:16 -0400] jan0232: oohh
[2012-07-06 17:02:30 -0400] cnf: http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks now that was an interesting read for me :P
[2012-07-06 17:03:33 -0400] paulmooring: cnf: are you new to git?
[2012-07-06 17:03:43 -0400] cnf: paulmooring: no, i am new to chef
[2012-07-06 17:04:38 -0400] cnf: paulmooring: i still haven't quite figured out how to put modified cookbooks in version control, but at least that did help a bit
[2012-07-06 17:05:44 -0400] cnf: paulmooring: btw, where do i report issues with your support desk software? ^^;
[2012-07-06 17:06:52 -0400] paulmooring: You can either e-mail support@opscode.com, submit a ticket at opscode.com/support or bother support people in here
[2012-07-06 17:07:14 -0400] paulmooring: support people being myself, ssd7,  jessicab, and hones
[2012-07-06 17:07:27 -0400] cnf: paulmooring: i thought i was doing the latter already? :P
[2012-07-06 17:07:51 -0400] paulmooring: What's the issue? I can make a ticket for you
[2012-07-06 17:08:01 -0400] cnf: paulmooring: well, 2 fold
[2012-07-06 17:08:18 -0400] cnf: mailing support@opscode.com a mail with unicode chars seems to make the system error
[2012-07-06 17:08:29 -0400] cnf: you just get a mail back saying FAIL!
[2012-07-06 17:09:00 -0400] cnf: paulmooring: 2nd opscode.com/support doesn't like unicode either, and also for me strips away all formatting.
[2012-07-06 17:09:09 -0400] cnf: which makes things hard to read sometimes :P
[2012-07-06 17:10:52 -0400] paulmooring: cnf: We have a ticket open for that, but tickets regarding our support system are on our internal ticket tracker (not public), if you want updates on it you can e-mail support about it and we'll keep you up to date
[2012-07-06 17:11:29 -0400] cnf: yeah, i think steven (ssd7?) made one for the unicode one
[2012-07-06 17:11:34 -0400] cnf: did he also make one for the formatting?
[2012-07-06 17:11:41 -0400] paulmooring: Yeah
[2012-07-06 17:12:22 -0400] cnf: ah, cool
[2012-07-06 17:12:23 -0400] paulmooring: also we appreciate being told about bugs even if there's a ticket, it helps us prioritize
[2012-07-06 17:12:32 -0400] cnf: paulmooring: then i'm good :P
[2012-07-06 17:13:02 -0400] cnf: now back to my issue, i see ssd7 updated it again :P
[2012-07-06 17:15:15 -0400] cnf: hmz, weird centos
[2012-07-06 17:17:35 -0400] jan0232: yfeldblum: the read me says nothing about a restard_commandbuti guess you're right, it expects one. no idea what i need to do there
[2012-07-06 17:20:34 -0400] cnf: paulmooring: ha, i just nodiced
[2012-07-06 17:20:50 -0400] cnf: paulmooring: the support system puts a "Opscode Staff" under my name
[2012-07-06 17:20:54 -0400] cnf: and not under Stevens
[2012-07-06 17:21:06 -0400] paulmooring: I'll add that one too
[2012-07-06 17:21:10 -0400] cnf: cool
[2012-07-06 17:21:21 -0400] cnf: if you want screenshots of certain things, just let me know
[2012-07-06 17:23:40 -0400] yfeldblum: jan0232, don't really know either; i'm not currently using that cookbook
[2012-07-06 17:23:43 -0400] Mydalon: Is there a way to set default permissions for all cookbook_files ?
[2012-07-06 17:23:48 -0400] cnf: ssd7: aparently, centos does A and AAAA lookups over the same connection. so you don't get the A entry before the AAAA lookup times out
[2012-07-06 17:38:03 -0400] AmishGeek: i'm a bit rusty with my ruby/chef   is there a resource that is the equivalent of grep? IE check if a config file contains a line of text, else modify it?
[2012-07-06 17:39:01 -0400] AmishGeek: i need to make sure sendmail on all my ec2 instances is configured to smart_host relay to my mail relay server, and I don't want to be rebuilding the sendmail.cf every time chef runs by default (only if the smart host line isn't already there)
[2012-07-06 17:39:50 -0400] cnf: AmishGeek: why do you care if the file gets rebuild?
[2012-07-06 17:40:38 -0400] AmishGeek: it seems kind of silly to restart sendmail every time chef is run
[2012-07-06 17:40:46 -0400] AmishGeek: which is currently every 5 minutes
[2012-07-06 17:41:20 -0400] nattyd: AmishGeek: you can use not_if on all resources, if you give it a string (like "grep -q 'something' /etc/file").  probably better to just put your sendmail.cf in a template and restart only if it's updated though
[2012-07-06 17:41:43 -0400] cnf: also, i would think chef has a way to do this build in
[2012-07-06 17:42:25 -0400] AmishGeek: yeah, i'm going through the resources list, there is a way to check if a file exists, but short of running a bash stanza to manually grep the file nothing to check the contents of a file
[2012-07-06 17:43:15 -0400] cnf: actually, afaik chef doesn't rebuild a file that it already did last time
[2012-07-06 17:44:05 -0400] paulmooring: AmishGeek: Right now a file either is completely managed by Chef or not all all.  You would have to write a custom lwrp for something like that
[2012-07-06 17:44:30 -0400] cnf: paulmooring: does chef rebuild a file it created last run, and wasn't touched since then?
[2012-07-06 17:44:51 -0400] cnf: actually, my tests say it doesn't
[2012-07-06 17:44:53 -0400] AmishGeek: yeah, but with sendmail, chef manages the sendmail.mc config file, and would then run the commands to rebuild the sendmail.cf file (not manage the cf file directly)
[2012-07-06 17:45:20 -0400] cnf: AmishGeek: either manage a file, or don't
[2012-07-06 17:45:21 -0400] paulmooring: cnf: no it will not
[2012-07-06 17:45:25 -0400] AmishGeek: so i want to have it only run the rebuild commands if and only if the smart host line is not present in the sendmail.cf
[2012-07-06 17:45:34 -0400] cnf: paulmooring: right, makes sense :P
[2012-07-06 17:45:52 -0400] cnf: AmishGeek: that doesn't make any sense
[2012-07-06 17:47:00 -0400] AmishGeek: the "proper" way to manage sendmail is to modify the sendmail.mc file, and then run the compile commands which process and output the sendmail.cf file and restart sendmail
[2012-07-06 17:47:08 -0400] cnf: AmishGeek: so let chef do that
[2012-07-06 17:47:13 -0400] cnf: don't touch the .cf file
[2012-07-06 17:47:47 -0400] AmishGeek: so the ultimate goal is to have chef manage sendmail.mc, but ONLY run the compile/restart commands if the sendmail.mc file changes
[2012-07-06 17:47:53 -0400] cnf: AmishGeek: chef knows when it rebuilds the .mc file
[2012-07-06 17:48:05 -0400] cnf: AmishGeek: it does NOT rebuild it every run
[2012-07-06 17:49:58 -0400] AmishGeek: ok, so in my template resource, how do i trigger the rebuild/restart only on changes?   I'm used to doing a template resource, and then a followup bash resource to run the commands (which are then run every chef run)
[2012-07-06 17:53:47 -0400] cnf: i know you can make a service reload inside a template definition
[2012-07-06 17:54:06 -0400] cnf: also, why are you writing bash things? ^^;
[2012-07-06 17:54:26 -0400] AmishGeek: bad habits
[2012-07-06 17:54:43 -0400] cnf: yeah :P
[2012-07-06 17:55:22 -0400] cnf: also, sendmail? :P
[2012-07-06 17:55:24 -0400] AmishGeek: also, some of the things i'm configuring/building with chef aren't part of any package systems, so it's a bunch of extracting tarballs, running special compile/install commands
[2012-07-06 17:56:46 -0400] AmishGeek: my ec2 web server pool is all running stock ubuntu AMI's with chef deploying our app on top of it.  in an effort to keep things lightweight, i just want to update the stock ubuntu sendmail config to relay to our singular smtp relay server so email can actually be sent from the servers (things like purchase receipts)
[2012-07-06 17:57:12 -0400] cnf: AmishGeek: but chef can do that
[2012-07-06 17:57:31 -0400] AmishGeek: so adding a single line to the sendmail config seems easier than writing a cookbook to install/configure/manage postfix or another mta
[2012-07-06 17:57:38 -0400] syphon: has anyone used remote_file to grab a file over a file:// URI instead of http?
[2012-07-06 17:57:58 -0400] cnf: AmishGeek: it isn't...
[2012-07-06 17:58:11 -0400] cnf: AmishGeek: also, if that is what you use chef for, don't use chef? ^^;
[2012-07-06 17:58:47 -0400] cnf: AmishGeek: also, https://github.com/opscode-cookbooks/postfix :P
[2012-07-06 17:58:57 -0400] uncommitted: Wondering if someone here could help me with a data bag loop, can't seem to get all of the pieces together
[2012-07-06 17:59:30 -0400] cnf: anyway, shower time
[2012-07-06 17:59:34 -0400] cnf: bbiab
[2012-07-06 17:59:59 -0400] BTGeekboy: stupid question that i can't seem to figure out: `knife search node "name:*"` returns my test node. `knife ssh "name:*" chef-client` errors with no nodes returned from search. same with "*:*" - what am I doing wrong, or is there a better way to be doing this?
[2012-07-06 18:01:23 -0400] yfeldblum: AmishGeek, notifications/subscriptions?
[2012-07-06 18:05:37 -0400] uncommitted: Here's a pastebin of the loop i'm attempting to write? (without success) http://pastebin.com/NJFSwLef
[2012-07-06 18:16:39 -0400] cnf: damnit, googleing for chef stuff often makes me hungry, but doesn't get me closer to resolving things :P
[2012-07-06 18:16:54 -0400] barefoot: hehe
[2012-07-06 18:17:19 -0400] syphon: anyone know if remote_file can work with file:// URIs instead of http://?
[2012-07-06 18:17:25 -0400] cnf: yfeldblum: got a link for subscriptions?
[2012-07-06 18:17:54 -0400] yfeldblum: cnf, http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-07-06 18:18:22 -0400] cnf: aha
[2012-07-06 18:18:30 -0400] pehlert: syphon: Why don't you check the source code? If it uses open (from open-uri) it probably can
[2012-07-06 18:19:00 -0400] nilsga: I have a role which have the apt and build-essential recipe. It works fine on an EC2 Ubuntu image, but on Rackspace it fails. On rackspace the build-essential package is not available until "apt-get update" is run. How can I get my role to run "apt-get update"?
[2012-07-06 18:19:31 -0400] yfeldblum: pehlert, it's very unlikely to use #open from open-uri
[2012-07-06 18:19:33 -0400] cnf: AmishGeek: what yfeldblum just posted
[2012-07-06 18:19:55 -0400] syphon: pehlert: I'm not even sure where to look in the source code for the remote_file resource
[2012-07-06 18:20:00 -0400] cnf: nilsga: use the apt cookbook
[2012-07-06 18:20:20 -0400] yfeldblum: syphon, lib/chef/provider
[2012-07-06 18:20:23 -0400] nilsga: chf: Yes, it's the first item in the runlist for the role
[2012-07-06 18:20:37 -0400] nilsga: but it doesnt appear to run apt-get update
[2012-07-06 18:20:57 -0400] syphon: thanks
[2012-07-06 18:26:07 -0400] syphon: hmm, remote_file seems to use ruby's 'URI' package, and the 'absolute?' method doesn't like the file URI I'm giving it
[2012-07-06 18:26:09 -0400] linTest: question about keys and authentication
[2012-07-06 18:26:28 -0400] nilsga: Here's the role: http://pastebin.com/pJQddHzb
[2012-07-06 18:27:04 -0400] nilsga: it fails at the build-essential recipe
[2012-07-06 18:27:18 -0400] erratic: nom nom nom
[2012-07-06 18:27:20 -0400] erratic: almonds
[2012-07-06 18:27:28 -0400] linTest: When I run chef-client on my local node, it appears to use my client authentication, but when I run knife cookbook upload -a it appear to be looking at the node authentication. What am I missing?
[2012-07-06 18:30:17 -0400] mhalligan: has anyone run into a problem using the mysql cookbook + ubuntu 12.04lts where for some reason everything destined for /var/run/mysqld ends up in /run/mysqld ?
[2012-07-06 18:30:41 -0400] erratic: mhalligan: Ive had issues with the mysql cookbook on 12.10
[2012-07-06 18:30:43 -0400] erratic: similar to that
[2012-07-06 18:31:12 -0400] mhalligan: testing now to see if it's the cookbook or the pacakges
[2012-07-06 18:31:14 -0400] mhalligan: packages
[2012-07-06 18:33:24 -0400] erratic: Ive got this guy on my team that always says derpy things
[2012-07-06 18:33:33 -0400] erratic: he's not dumb he's just got no social skills
[2012-07-06 18:33:38 -0400] jessicab: lintest - when you run chef-client it either uses that nodes client key, or the org key to create the nodes client key.. knife cookbook upload -a it should be using your client key to authenticate, or the org key if you changed your knife.rb. org key = server key though for open source
[2012-07-06 18:33:44 -0400] erratic: Im thinking I should take a shot everytiume he says something derpy
[2012-07-06 18:34:51 -0400] yfeldblum: syphon, it's likely http-only
[2012-07-06 18:35:03 -0400] linTest: jessicab - thx; so are the node keys used for anything?
[2012-07-06 18:35:15 -0400] mhalligan: erratc: hrm definitely cookbooks, installing manually cleared it up
[2012-07-06 18:35:28 -0400] miah: moin
[2012-07-06 18:35:36 -0400] yfeldblum: sup miah
[2012-07-06 18:35:57 -0400] jessicab: lintest - nodes dont really have keys exactly, theres just a client they use with the same name.. i was referring to it as the nodes client key above, theres only one per node
[2012-07-06 18:36:03 -0400] miah: trying to get my brain in order
[2012-07-06 18:36:07 -0400] miah: lots of stuffs to work on
[2012-07-06 18:36:14 -0400] erratic: miah: drink a shot
[2012-07-06 18:36:18 -0400] erratic: since you're at work
[2012-07-06 18:36:23 -0400] miah: i dont drink
[2012-07-06 18:36:31 -0400] erratic: thats a shame
[2012-07-06 18:37:04 -0400] miah: my coworker and i are hacking on the percona cookbook and a config cookbook that we're writing..
[2012-07-06 18:37:12 -0400] jessicab: lintest - this page also has some good info about authentication - http://wiki.opscode.com/display/chef/Authentication+and+Authorization
[2012-07-06 18:37:27 -0400] erratic: miah: figured out my xtrabackup and whatsit cookbook the cloudfuse
[2012-07-06 18:37:34 -0400] erratic: Im thinking about releasing the cloudfuse cookbook
[2012-07-06 18:37:54 -0400] erratic: along with the binary that I compiled.. that was a bitch
[2012-07-06 18:38:07 -0400] erratic: I had to actually work on C code to fix that one
[2012-07-06 18:38:15 -0400] linTest: jessicab - thx, the chef-server web interface shows a key for the nodes but now I see that it's the same key as the client key. I'll read the link you provided.
[2012-07-06 18:38:25 -0400] erratic: now I'm trying to fix munin
[2012-07-06 18:38:40 -0400] erratic: its only showing memory graphs for one of my vms
[2012-07-06 18:38:50 -0400] erratic: donno why
[2012-07-06 18:39:29 -0400] miah: i had to write some code that used a cartesian set to sort out the munin configs.. still hate munin.
[2012-07-06 18:40:07 -0400] erratic: I like that its not nagios
[2012-07-06 18:40:14 -0400] javawidget: I wacked munin from this environment I inherited..
[2012-07-06 18:40:22 -0400] javawidget: I use zenoss :)
[2012-07-06 18:40:25 -0400] erratic: other than that I could care less about graphing rrd data collected from server statistics
[2012-07-06 18:40:31 -0400] erratic: actually
[2012-07-06 18:40:45 -0400] erratic: I wouldn't mind making some js highcharts out of the rrd data
[2012-07-06 18:40:47 -0400] heph: anybody using chef-rundeck? I'm running into a NoSuchMethod `unpack' error and am having trouble tracking it down
[2012-07-06 18:40:49 -0400] erratic: that'd be fun
[2012-07-06 18:41:07 -0400] heph: or is there a better solution for accessing chef node information from rundeck?
[2012-07-06 18:41:33 -0400] cnf: drinks, soon!
[2012-07-06 18:42:30 -0400] erratic: http://www.youtube.com/watch?v=0-F9G7BoO40
[2012-07-06 18:54:52 -0400] justNeph: ArgumentError: Unable to create Chef::RunList::RunListItem from String:"role[base],role[prod_base],role[mysql],role[mysql_slave]": must be recipe[] or role[]. I'm doing this programmatically by setting a new Chef::Knife::Bootstrap attribute like this : kb.config[:run_list]        = options[:roles]
[2012-07-06 18:55:26 -0400] justNeph: Any ideas? Where I might be going wrong?
[2012-07-06 19:06:02 -0400] hoover_damm: if your trying to set a run_list that has multiple items
[2012-07-06 19:06:08 -0400] hoover_damm: make sure you craft it like an array
[2012-07-06 19:06:19 -0400] hoover_damm: ["role[bob]","recipe[bill]"]
[2012-07-06 19:06:42 -0400] hoover_damm: at least that's true in the actual node entry.  I often find myself just using 1 role so I think that's how it should work
[2012-07-06 19:07:10 -0400] hoover_damm: knife bootstrap -r "["recipe["bill"],"role[bob]"]" hostname -x root
[2012-07-06 19:38:24 -0400] synx: welp
[2012-07-06 19:39:59 -0400] rbarrero: Hi there
[2012-07-06 19:40:19 -0400] rbarrero: how can I view the list of nodes that belong to a role?
[2012-07-06 19:41:40 -0400] uncommitted: knife search node role:ROLE -i
[2012-07-06 19:43:27 -0400] rbarrero: cool, thanks
[2012-07-06 19:46:54 -0400] hoover_damm: or roles
[2012-07-06 19:47:04 -0400] hoover_damm: if you want to search for node's that have that role in it's runlist
[2012-07-06 19:50:02 -0400] yfeldblum: miah, what's a cartesian set?
[2012-07-06 19:54:42 -0400] erratic: a kitteh set
[2012-07-06 19:54:46 -0400] erratic: a set of 2 kittehs
[2012-07-06 19:55:08 -0400] erratic: that mew alot
[2012-07-06 19:55:52 -0400] barefoot: yfeldblum: http://en.wikipedia.org/wiki/Cartesian_product
[2012-07-06 19:57:02 -0400] yfeldblum: barefoot, that's the page for cartesian product; i haven't heard the name cartesian set before though
[2012-07-06 19:58:20 -0400] barefoot: yfeldblum: right, guess its just part of two descriptions? "Cartesian product (or product set)"
[2012-07-06 19:58:44 -0400] miah: yfeldblum: http://en.wikipedia.org/wiki/Cartesian_product
[2012-07-06 19:59:03 -0400] hoover_damm: miah, i'm shocked people still use it
[2012-07-06 19:59:09 -0400] yfeldblum: k
[2012-07-06 19:59:16 -0400] yfeldblum: hoover_damm, munin, or cartesian products?
[2012-07-06 19:59:17 -0400] hoover_damm: munin that is
[2012-07-06 19:59:29 -0400] barefoot: hehe was curious also
[2012-07-06 19:59:30 -0400] hoover_damm: I can see munin writiing to graphite i suppose
[2012-07-06 19:59:45 -0400] hoover_damm: but for the most part I hope the RRD format isn't going to be sticking around for much longer
[2012-07-06 20:00:12 -0400] Mithrandir: munin's not particularly tied to rrd, really.  Nearly all the value lies in the client-server protocol
[2012-07-06 20:00:14 -0400] miah: my biggest problem with munin is that the plugins are all garbage
[2012-07-06 20:00:44 -0400] hoover_damm: miah, that's everywhere
[2012-07-06 20:00:50 -0400] hoover_damm: miah, that's why Diamond is appeals to some
[2012-07-06 20:01:01 -0400] Mithrandir: software sucks.  That's just how it is. :-)
[2012-07-06 20:01:24 -0400] hoover_damm: https://github.com/BrightcoveOS/Diamond
[2012-07-06 20:01:36 -0400] hoover_damm: then you can write your plugins in simple python
[2012-07-06 20:01:39 -0400] hoover_damm: that is if you like python
[2012-07-06 20:01:45 -0400] hoover_damm: otherwise this suggestion would be nasty lol
[2012-07-06 20:02:26 -0400] hoover_damm: https://github.com/heavywater/echelon
[2012-07-06 20:02:28 -0400] hoover_damm: don't forget that
[2012-07-06 20:05:42 -0400] lflux: hoover_damm: I started one as well, for Centos 6
[2012-07-06 20:07:46 -0400] hoover_damm: lflux, I host > 1million metrics recieved at times
[2012-07-06 20:08:03 -0400] hoover_damm: lflux, i'm not writing a common graphite cookbook.  I'm writing a lwrp that can scale beyond 1million metrics
[2012-07-06 20:08:12 -0400] hoover_damm: lflux, slightly different goals
[2012-07-06 20:08:19 -0400] lflux: 1mm metrics per what
[2012-07-06 20:08:33 -0400] hoover_damm: 10s/60s
[2012-07-06 20:08:43 -0400] lflux: damn
[2012-07-06 20:08:56 -0400] mosez: man... got to take a deeper look at metrics... and statsd/batsd... and graphite...
[2012-07-06 20:09:09 -0400] hoover_damm: basically servers are on voxel using real ssd
[2012-07-06 20:09:20 -0400] lflux: I'd love to graph ALL THE THINGS but my SAN hates me when I do it.
[2012-07-06 20:09:25 -0400] hoover_damm: a lot of tuning
[2012-07-06 20:09:34 -0400] hoover_damm: and learning to make graphite do this
[2012-07-06 20:09:35 -0400] lflux: got to figure out my infrastructure for that before I do that amount of stats
[2012-07-06 20:09:47 -0400] hoover_damm: and unfortunately the docs for graphite don't exactly make my setup easy to do
[2012-07-06 20:10:03 -0400] hoover_damm: so I'm just gonna write the carbon cookbook to support relay, then drop in carbon-cache in the same cookbook
[2012-07-06 20:10:24 -0400] hoover_damm: then make a graphite cookbook that supports the database crud that's required as well as depending on cookbooks to setup mysql/postgresql
[2012-07-06 20:10:37 -0400] hoover_damm: because sqlite3 does not scale beyond a few clients with graphite
[2012-07-06 20:10:40 -0400] hoover_damm: (web clients)
[2012-07-06 20:11:16 -0400] hoover_damm: i've been dealing with honking aws stuff way too much
[2012-07-06 20:11:17 -0400] hoover_damm: to get to it
[2012-07-06 20:12:01 -0400] lflux: I've just been testing graphite, haven\t gotten past installing it really
[2012-07-06 20:12:55 -0400] hoover_damm: basically I wrote my own cookbook on graphite out of a whim wanting in virtualenv instead of the system
[2012-07-06 20:13:08 -0400] hoover_damm: and then had to learn alot to make my stuff work
[2012-07-06 20:13:23 -0400] hoover_damm: it's been a lot of fun to say the least
[2012-07-06 20:13:35 -0400] hoover_damm: lflux, btw damaestro wrote some rpms for fedora core (afaik)
[2012-07-06 20:13:39 -0400] hoover_damm: they should be backportable to centos
[2012-07-06 20:13:51 -0400] hoover_damm: daMaestro that is
[2012-07-06 20:14:14 -0400] lflux: rpms wasn't the problem really, it was first getting all the packages to work (didn't in 5, had to use 6) and then virtualenv stuff
[2012-07-06 20:14:22 -0400] lflux: since the community cookbook didn't do virtualenv
[2012-07-06 20:14:28 -0400] lflux: so more or less what you started out doing
[2012-07-06 20:17:02 -0400] hoover_damm: github.com/damm/graphite
[2012-07-06 20:17:20 -0400] hoover_damm: it's designed for Ubuntu but should more or less work with centos
[2012-07-06 20:17:30 -0400] hoover_damm: pretty straight forward
[2012-07-06 20:17:43 -0400] hoover_damm: https://github.com/damm/graphite/blob/master/attributes/default.rb
[2012-07-06 20:17:49 -0400] hoover_damm: might wanna crank that up to 0.9.10
[2012-07-06 20:18:09 -0400] lflux: thanks, i'll check it out
[2012-07-06 20:29:39 -0400] linTest: would this be a normal workflow? modify cookbooks on my local workstation; push changes to git repository; then run knife command to upload to chef-server?
[2012-07-06 20:29:59 -0400] bdha: Yes.
[2012-07-06 21:13:34 -0400] vagrant_newb: Does anyone know if there's a way to use librarian-chef through a proxy server?
[2012-07-06 21:18:18 -0400] yfeldblum: vagrant_newb, why do you need that?
[2012-07-06 21:21:11 -0400] vagrant_newb: yfeldblum: because I work for a company that uses a Microsoft proxy server, so I've got cntlm set up locally to allow gem and yum and everything else to get through it, but I haven't found a way to do `librarian chef install`
[2012-07-06 21:22:05 -0400] vagrant_newb: I know it seems lame, but there's nothing I can do about the proxy server
[2012-07-06 21:22:10 -0400] vagrant_newb: :/
[2012-07-06 21:22:50 -0400] yfeldblum: vagrant_newb, not terribly familiar with that, but librarian-chef talks HTTP/S using Ruby's Net::HTTP (net/http) standard library for cookbook-site fetches and shells out to git for git fetches
[2012-07-06 21:23:46 -0400] vagrant_newb: yfeldblum: I've got environment variables HTTP_PROXY and http_proxy set
[2012-07-06 21:23:58 -0400] vagrant_newb: is there any way to get Librarian to honor those?
[2012-07-06 21:24:28 -0400] vagrant_newb: I know curl can, and I'm pretty sure Git can...
[2012-07-06 21:24:39 -0400] vagrant_newb: RubyGems does
[2012-07-06 21:25:01 -0400] vagrant_newb: yum requires something in /etc/yum.conf
[2012-07-06 21:28:27 -0400] vagrant_newb: yfeldblum: assuming there's nothing now handling that, if I patched Librarian to use a proxy, would you accept the patch?  (assuming it's cleanly written, etc.)
[2012-07-06 21:29:02 -0400] vagrant_newb: s/patch/pull request/
[2012-07-06 21:29:47 -0400] yfeldblum: vagrant_newb, https://github.com/applicationsonline/librarian/issues/92 and yes
[2012-07-06 21:30:42 -0400] vagrant_newb: yfeldblum: :)
[2012-07-06 21:30:46 -0400] vagrant_newb: thanks
[2012-07-06 21:31:12 -0400] yfeldblum: vagrant_newb, the issue's a placeholder which i may get to eventually, but which i'm hoping you can beat me to :P
[2012-07-06 21:31:24 -0400] vagrant_newb: yes me too...
[2012-07-06 21:31:34 -0400] vagrant_newb: I'm not promising but I'll try to find time
[2012-07-06 21:32:16 -0400] jkyle: Is there a way to tell when the last time a chef-client ran successfully for a particular node is? e.g. "how many nodes have failed to check in"
[2012-07-06 21:33:02 -0400] yfeldblum: vagrant_newb, that's fine
[2012-07-06 21:34:08 -0400] vagrant_newb: yfeldblum: I don't think the code should be very hard to write, but I'm thinking that Rspec tests might be really tricky.  at least off the top of my head...
[2012-07-06 21:34:56 -0400] uncommitted: receiving an errror: FATAL: NoMethodError: undefined method `[]' for nil:NilClass
[2012-07-06 21:35:14 -0400] uncommitted: can someone check out this data bag and recipe snippet?
[2012-07-06 21:35:15 -0400] uncommitted: http://pastebin.com/ZXtW9A1S
[2012-07-06 21:35:25 -0400] uncommitted: don't see why it's not working
[2012-07-06 21:36:15 -0400] yfeldblum: vagrant_newb, https://github.com/applicationsonline/librarian/blob/v0.0.24/lib/librarian/source/git/repository.rb#L169-177 and https://github.com/applicationsonline/librarian/blob/v0.0.24/spec/functional/chef/source/site_spec.rb#L60-73
[2012-07-06 21:36:18 -0400] uncommitted: i'm finding that data bags are kind of a pain in the ass :)
[2012-07-06 21:36:43 -0400] vagrant_newb: yfeldblum: hmmm you're using something other than Rspec I'll just model any specs I write after yours, or maybe ask you if you can write them ;)
[2012-07-06 21:37:04 -0400] yfeldblum: vagrant_newb, using rspec ... some specs are better than others ...
[2012-07-06 21:41:23 -0400] yfeldblum: uncommitted, you can always use: Chef::Log.info("\n#{JSON.pretty_generate(ws)}")
[2012-07-06 21:47:06 -0400] uncommitted: thank you yfeldblum, that seems like it's spitting out the right data
[2012-07-06 21:47:51 -0400] yfeldblum: vagrant_newb, using rspec
[2012-07-06 21:48:32 -0400] yfeldblum: vagrant_newb, i prefer using lots of `let` and i prefer also having only one assertion per `it`, but some specs do this better than others
[2012-07-06 21:48:33 -0400] uncommitted: yes, the error persists :|
[2012-07-06 21:49:33 -0400] vagrant_newb: yfeldblum: okay: it just looked different from what I'm used to so I assumed it was an alternate spec project that I've never used. my bad
[2012-07-06 21:50:34 -0400] yfeldblum: uncommitted, hmm i think i see it: you have a block argument named `node`, and Hash#each passes the string key and `node` inside the block takes on a string value, but later on inside the loop block you do node[:cacti][:cacti] because you're trying to refer to the current Chef::Node instance
[2012-07-06 21:51:48 -0400] yfeldblum: uncommitted, i also see a separate problem which is that you have a single resources "execute[add_hosts]" where you think you have 4 separate resources, one for each host ... the problem here is that resources are distinguished by their combination of type and name, and if you try to declare two resources with the same types and names, chef will think you're actually just re-opening the first one and updating its attributes
[2012-07-06 21:52:08 -0400] yfeldblum: vagrant_newb, what are you used to?
[2012-07-06 21:54:33 -0400] vagrant_newb: just Rspec and cucumber
[2012-07-06 21:54:45 -0400] vagrant_newb: never used any other things
[2012-07-06 21:54:55 -0400] vagrant_newb: ThoughtBot has one whose name I can't recall
[2012-07-06 21:55:14 -0400] vagrant_newb: and various other people have written alternatives...
[2012-07-06 21:55:29 -0400] vagrant_newb: of course I'm not saying I use Rspec as often as I *should* ;)
[2012-07-06 21:55:34 -0400] hoover_damm: it was basically unit/test
[2012-07-06 21:56:12 -0400] yfeldblum: vagrant_newb, i'm just curious, though, why you thought the librarian specs looked different from rspec? consider it academic curiosity
[2012-07-06 21:56:15 -0400] hoover_damm: I think i'd rather write a more integration test of all my cookbooks and if my application can deploy
[2012-07-06 21:56:18 -0400] hoover_damm: and work properly
[2012-07-06 21:56:33 -0400] hoover_damm: testing the nuances of each cookbook can be useful on a per cookbook OCD level
[2012-07-06 21:56:34 -0400] vagrant_newb: don't take it as a criticism of you specs!
[2012-07-06 21:57:12 -0400] hoover_damm: it's just over time i've grown to the point on testing where I don't want to be arsed to write menial tests to ensure redis can configure, make, install, remove
[2012-07-06 21:57:34 -0400] hoover_damm: i'd rather just ensure that the end deal works
[2012-07-06 21:57:41 -0400] jan0232: yfeldblum: i know it's long ago. but remember my problem with /etc/init.d/app hup and the application_ruby cookbook? well, there already was a bug report and here is a fix, just so you know ;) https://github.com/redbeard/application_ruby/commit/fb2bb0ff45616fd2c91fdde381a5b6a5864ef52e
[2012-07-06 21:57:41 -0400] yfeldblum: hoover_damm, cool, although this case is a pure-ruby simple CLI application without a framework, rather than a chef cookbook or any other operations/sysadmin functionality :P
[2012-07-06 21:58:03 -0400] hoover_damm: yfeldblum, yep
[2012-07-06 21:58:05 -0400] yfeldblum: vagrant_newb, of course not
[2012-07-06 21:58:19 -0400] hoover_damm: yfeldblum, testing becomes personal after awhile :)
[2012-07-06 21:58:58 -0400] yfeldblum: hoover_damm, it turns that, in many cases (it of course depends on the case) all these little itty bitty tests are tremendously useful
[2012-07-06 21:59:39 -0400] yfeldblum: hoover_damm, and i've still got to make up my mind what a good way to test cookbooks is, and obviously this very much depends on the structure and patterns of writing cookbooks in the first place
[2012-07-06 21:59:51 -0400] yfeldblum: hoover_damm, it's still a very much open question to me
[2012-07-06 21:59:56 -0400] yfeldblum: jan0232, cool
[2012-07-06 22:00:28 -0400] jan0232: yfeldblum: seems the application_ruby and application cookbook is fairy new!??? seems like there is still room for improvement
[2012-07-06 22:00:45 -0400] yfeldblum: jan0232, sorry i couldn't offer you any better advice - i don't use that cookbook myself, so i don't know its ins and outs
[2012-07-06 22:01:03 -0400] jan0232: yfeldblum: no problem you already helped SO MUCH. thx :)
[2012-07-06 22:01:04 -0400] yfeldblum: jan0232, it has recently undergone a radical transformation
[2012-07-06 22:01:49 -0400] yfeldblum: jan0232, "complete rewrite" seems not to convey the magnitude of it sufficiently
[2012-07-06 22:01:52 -0400] jan0232: i even wonder if it is worth checking out right now or if i should rather build my own stuffbut i think those cookbooks will get more and more support and thats good
[2012-07-06 22:02:27 -0400] hoover_damm: yfeldblum, very heavy problem as some things really cannot be fully tested
[2012-07-06 22:02:38 -0400] yfeldblum: jan0232, certainly try it out, if you like the deployment strategies it uses
[2012-07-06 22:02:54 -0400] hoover_damm: yfeldblum, you can have haproxy start up with no backends but your really can't curl it to test it.  So then you end up testing socket admin or something else... not really testing haproxy
[2012-07-06 22:03:20 -0400] hoover_damm: yfeldblum, end result you end up having to spinup a fake backend and having haproxy use that to test it... which should invalidate the test sort of
[2012-07-06 22:03:48 -0400] jan0232: yfeldblum: still not sure how it really works. are you deploying any ruby related web apps? i'm just starting with chef and while being at it i might like the idea of chef also doing deployments or maybe use capistrano for that?  well, i guess i will have to see for myself
[2012-07-06 22:04:11 -0400] cnf: sigh
[2012-07-06 22:04:19 -0400] cnf: getting tired of cookbooks crashing...
[2012-07-06 22:04:20 -0400] yfeldblum: hoover_damm, there are all sorts of strategies :P
[2012-07-06 22:04:31 -0400] yfeldblum: cnf, so write your own - that's what's expected, anyway
[2012-07-06 22:04:32 -0400] hoover_damm: yfeldblum, right and picking them is part of learning
[2012-07-06 22:04:49 -0400] yfeldblum: hoover_damm, i might go with "inventing them is part of learning"
[2012-07-06 22:04:55 -0400] cnf: yfeldblum: you know, that's a lot of BS
[2012-07-06 22:05:26 -0400] yfeldblum: jan0232, yes i am, presently using chef-client triggered when i want to deploy, but i hope to move away from that strategy soon for app deployment
[2012-07-06 22:05:50 -0400] jan0232: yfeldblum: away to what other strategy then?
[2012-07-06 22:06:08 -0400] cnf: yfeldblum: also a very counter productive attitude, imo
[2012-07-06 22:06:42 -0400] yfeldblum: cnf, if you wait 5-10 years, the whole ecosystem will mature, and you will be more likely to find parts that just snap together and work everywhere ... but as it is, chef is barely 3 years old and most cookbooks 1-2 years ...
[2012-07-06 22:07:32 -0400] jan0232: yfeldblum: just out of interest. what ruby/rails related cookbooks are you using? or a lot of custom baked stuff? am i starting in the right direction with the new application and application_ruby cookbooks??
[2012-07-06 22:07:59 -0400] yfeldblum: jan0232, a simple approach is for chef to drop a script on the filesystem which, when executed, runs the deploy (but which is not executed as part of a chef-client run)
[2012-07-06 22:08:26 -0400] cnf: yfeldblum: maybe, but saying that it's to be excepted that most cookbooks fail is just silly
[2012-07-06 22:08:35 -0400] cnf: yfeldblum: and doesn't help said ecosystem
[2012-07-06 22:08:39 -0400] yfeldblum: jan0232, they cookbooks are proprietary, but i'm happy to talk ideas
[2012-07-06 22:09:50 -0400] hoover_damm: I think there will a lot of crusty sysadmins trying to fight for their job and rage against the configuration management machine.
[2012-07-06 22:09:54 -0400] yfeldblum: cnf, you don't have to like the state of the world as i assessed it, but calling the assessment "just silly" hurts only you, not me
[2012-07-06 22:10:17 -0400] hoover_damm: Mostly it's because you have to 'describe' your infrastructure.  You say that to some sysadmins and they go meh? wuh?
[2012-07-06 22:10:25 -0400] hoover_damm: just fire them and hire some devops kid
[2012-07-06 22:10:27 -0400] cnf: oh, and there is that nice elitist attitude again
[2012-07-06 22:10:51 -0400] jan0232: yfeldblum: ah ok. the script that does the deploy..because a chef-client run might be too heavy for just a deployment? i like the idea that chef does deployments because that way unlike with capistrano there is no infrastructure configuration happening in my application source code ;)
[2012-07-06 22:10:54 -0400] yfeldblum: hoover_damm, so said the buggy-makers in the age of Henry Ford
[2012-07-06 22:10:54 -0400] hoover_damm: sometimes the infrastructure is so old and filled with too many stories that the people that could describe it... are wrapped up in their own emo to just describe it cleanly
[2012-07-06 22:11:16 -0400] hoover_damm: so replace them with someone who can review it, rebuild it and describe it and automate it
[2012-07-06 22:11:29 -0400] jan0232: yfeldblum: i don't get why a deploy.rb inside the app should know anything about servers, ip addresses or whatever :)
[2012-07-06 22:11:30 -0400] hoover_damm: it's only rocketscience if you let it be
[2012-07-06 22:11:40 -0400] yfeldblum: jan0232, right there with you
[2012-07-06 22:13:16 -0400] jameson: it's really just a bunch of monkeys with wrenches and hammers
[2012-07-06 22:13:19 -0400] jameson: some with phds,
[2012-07-06 22:13:25 -0400] jameson: so who likes to fling poos
[2012-07-06 22:13:29 -0400] vagrant_newb: yfeldblum: I think cnf is just frustrated that Chef is not *painlessly* living up to its promises / hype
[2012-07-06 22:13:35 -0400] yfeldblum: jan0232, app ops != infra ops ... chef is great for a certain strategy of infra ops focusing on long-running mutable machines, and for some people it's good for app ops too, but for other people it's not
[2012-07-06 22:13:42 -0400] vagrant_newb: I can attest to it: there's definitely some pain points
[2012-07-06 22:14:28 -0400] cnf: vagrant_newb: i'm frustrated by the attitude of a lot of people around a lot of issues
[2012-07-06 22:14:39 -0400] yfeldblum: vagrant_newb, i have felt months of that pain myself; i have the advantage of being a software developer primarily and of having learned ruby well in advance of trying to learn chef
[2012-07-06 22:15:49 -0400] mLewisLogic: Any way to access the Ruby built-in File class from within a provider? It keeps trying to use the Chef File class
[2012-07-06 22:16:11 -0400] mLewisLogic: As in:    File.readlink("/dev/md/#{raid_name}")
[2012-07-06 22:16:41 -0400] _rc: refer to it as ::File
[2012-07-06 22:17:00 -0400] yfeldblum: mLewisLogic, as _rc says, do this: `::File.readlink("/dev/md/#{raid_name}")`
[2012-07-06 22:17:28 -0400] mLewisLogic: _rc yfeldblum: thank you! worked perfectly
[2012-07-06 22:18:08 -0400] jan0232: yfeldblum: so your goal would be to have chef setup everything, also the app..but then have chef also setup some script so you could easily fire a deployment without using an entire chef-client run!?
[2012-07-06 22:20:12 -0400] yfeldblum: cnf, one of my thoughts is for for chef to drop off some kind of app-deployment infrastructure, but not actually deploy apps (neither initial deploy nor re-deploy) ... the app-deployment infrastructure can of course take many forms: a single script, a set of scripts, a daemon listening to https on 443, a daemon listening to rabbitmq, etc
[2012-07-06 22:20:21 -0400] yfeldblum: sorry, that's for jan0232
[2012-07-06 22:20:30 -0400] jan0232: thats what i thought :)
[2012-07-06 22:20:41 -0400] vagrant_newb: cnf: are you using red hat or centos by any chance?
[2012-07-06 22:20:50 -0400] cnf: vagrant_newb: centos
[2012-07-06 22:20:55 -0400] cnf: not my choice :P
[2012-07-06 22:20:58 -0400] vagrant_newb: yes, me too
[2012-07-06 22:21:01 -0400] vagrant_newb: nor mine
[2012-07-06 22:21:08 -0400] vagrant_newb: but I think that's where the pain is mostly coming from
[2012-07-06 22:21:28 -0400] vagrant_newb: (almost) anyone who can choose for themself will choose Ubuntu
[2012-07-06 22:21:29 -0400] hoover_damm: if you don't like the distro your company runs... quit your job
[2012-07-06 22:21:34 -0400] hoover_damm: do your company a favor
[2012-07-06 22:21:48 -0400] cnf: hoover_damm: now that is just an infantile attitude
[2012-07-06 22:22:03 -0400] vagrant_newb: hoover_damm: there are other things more important than which distro they pick
[2012-07-06 22:22:16 -0400] vagrant_newb: I have yet to find a perfect place to work
[2012-07-06 22:22:22 -0400] hoover_damm: vagrant_newb, exactly.
[2012-07-06 22:22:22 -0400] vagrant_newb: there are trade offs you have to make
[2012-07-06 22:22:29 -0400] hoover_damm: vagrant_newb, and caring about such thing ... you should just /quit
[2012-07-06 22:22:44 -0400] vagrant_newb: hoover_damm: I don't follow your point
[2012-07-06 22:23:21 -0400] cnf: he's just grumpy
[2012-07-06 22:23:26 -0400] vagrant_newb: i guess
[2012-07-06 22:23:34 -0400] vagrant_newb: I think he assumed I was just bitching about it
[2012-07-06 22:23:44 -0400] vagrant_newb: but I was merely stating the fact that the use CentOS
[2012-07-06 22:24:03 -0400] vagrant_newb: and anyone who has used both has undoubtedly encountered differences, which can create confusion
[2012-07-06 22:24:33 -0400] vagrant_newb: it also seems to be the case that MOST recipes are written for Ubuntu
[2012-07-06 22:24:53 -0400] vagrant_newb: so using Chef with CentOS (or RedHat, etc.) seems to be the source of pain
[2012-07-06 22:25:51 -0400] cnf: it seems to be true often
[2012-07-06 22:26:08 -0400] cnf: though i have had plenty of cookbooks fail on ubuntu as well ^^;
[2012-07-06 22:26:28 -0400] vagrant_newb: oh, I guess that's mildly comforting ;)
[2012-07-06 22:27:27 -0400] cnf: hehe
[2012-07-06 22:27:57 -0400] cnf: but really, having cookbooks that are stable enough so you can learn and get to know chef should not be too much to ask
[2012-07-06 22:28:31 -0400] vagrant_newb: it would certainly be nice
[2012-07-06 22:29:14 -0400] vagrant_newb: I think if you color inside the lines things are pretty stable at least that's how it appears to me
[2012-07-06 22:30:37 -0400] cnf: vagrant_newb: not my experience
[2012-07-06 22:30:38 -0400] yfeldblum: most cookbooks are written with a very large set of assumptions, most of which fail at some point in one edge case or another
[2012-07-06 22:31:06 -0400] yfeldblum: centos is an edge case at the moment, as are various network configurations, and plenty of other types of cases
[2012-07-06 22:31:35 -0400] vagrant_newb: yfeldblum:  yeah, I think that's what we've learned the hard way
[2012-07-06 22:31:44 -0400] yfeldblum: in my experience, you use the cookbooks that work for you, fork the cookbooks that mostly work for you, and roll your own cookbooks where you can't find any in the above two cases
[2012-07-06 22:32:00 -0400] vagrant_newb: it's kind of a let down when you're led to believe otherwise
[2012-07-06 22:32:07 -0400] vagrant_newb: yup
[2012-07-06 22:32:09 -0400] vagrant_newb: true
[2012-07-06 22:32:23 -0400] yfeldblum: chef by itself is pretty stable - this is just various public cookbooks i'm talking about
[2012-07-06 22:32:23 -0400] vagrant_newb: but that's nowhere stated up front
[2012-07-06 22:32:28 -0400] vagrant_newb: yes
[2012-07-06 22:32:31 -0400] vagrant_newb: agreed
[2012-07-06 22:33:00 -0400] Majost: What is the best way of running the chef-client (cookbook invoked) -- init script, bluepill, other?
[2012-07-06 22:33:11 -0400] yfeldblum: that chef is pretty stable and that most of the public cookbooks serve as, at the least, examples is, ultimately, sufficient for me
[2012-07-06 22:33:50 -0400] yfeldblum: Majost, up to you - pick your favorite ... or pick the method that works well given the particulars of your infrastructure as well as the particulars of your organization
[2012-07-06 22:34:10 -0400] vagrant_newb: yfeldblum: I think it's all a matter of expectations.  everything you've described seems pretty reasonable, but if you come in with different expectations, then it can be like a baseball bat in the face
[2012-07-06 22:34:37 -0400] yfeldblum: vagrant_newb, yeah, it hit me too
[2012-07-06 22:34:39 -0400] Majost: I haven't a favorite -- so perhaps the question should be this: What is the most reliable means of running chef-client?
[2012-07-06 22:35:11 -0400] yfeldblum: Majost, test them all and find out :P
[2012-07-06 22:35:15 -0400] vagrant_newb: I think that's just what cnf is getting hit with I have some sympathy for him, though in the end I think everything you're saying is true
[2012-07-06 22:35:16 -0400] Majost: heh
[2012-07-06 22:36:42 -0400] Majost: yfeldblum: I will -- but I was hoping for a community consensus based on experience.
[2012-07-06 22:37:11 -0400] Majost: eg: Will the chef-client auto restart itself if for some odd reason it dies?
[2012-07-06 22:37:12 -0400] yfeldblum: Majost, heh, well, "test them all" is my community consensus based on experience :P
[2012-07-06 22:41:29 -0400] uncommitted: yfeldblum, thank you for your comments earlier? had to run.
[2012-07-06 22:41:51 -0400] yfeldblum: uncommitted, sure - did it help you at all?
[2012-07-06 22:47:11 -0400] PapaSierra10: morning
[2012-07-06 22:47:41 -0400] PapaSierra10: https://github.com/opscode-cookbooks/php/blob/master/attributes/default.rb#L46 i want to use php 5.4.4, from where do i obtain the checksum?
[2012-07-06 22:47:50 -0400] uncommitted: not yet. more data bag examples on the internet would be awesome for the less dev-types of us out there. :-)
[2012-07-06 22:50:05 -0400] KarlHungus: is there a clean pattern for using LWRPs to manage a single template resouce yet?
[2012-07-06 22:50:44 -0400] KarlHungus: one that doesn't require updated_by_last_action hackery? ;)
[2012-07-06 22:54:09 -0400] erratic: [Sat, 07 Jul 2012 00:19:25 -0700] ERROR: Connection refused connecting to localhost:5984 for /_all_dbs, retry 1/5
[2012-07-06 22:54:15 -0400] erratic: is that rabbitmq breaking
[2012-07-06 22:54:17 -0400] yfeldblum: uncommitted, link it again?
[2012-07-06 22:54:56 -0400] erratic: what listens on 5984
[2012-07-06 22:55:20 -0400] yfeldblum: KarlHungus, provider actions with internal run-contexts is rather new
[2012-07-06 22:55:48 -0400] uncommitted: one sec, let me link the currentt version
[2012-07-06 22:55:49 -0400] JasonF: KarlHungus: I'm doing something like that with definitions, but not LWRP.
[2012-07-06 22:56:18 -0400] JasonF: KarlHungus: mine is based mostly on the examples in defintions re: doing email aliases.
[2012-07-06 22:56:31 -0400] jan0232: yfeldblum: what do you think of this https://github.com/cramerdev/capistrano-chef ?
[2012-07-06 22:58:19 -0400] kallistec: erratic: it's couchdb
[2012-07-06 22:58:44 -0400] erratic: oh right
[2012-07-06 22:58:47 -0400] erratic: dude fuck me
[2012-07-06 22:58:50 -0400] uncommitted: yfeldblum.. here's the current state http://pastebin.com/iQen7xej
[2012-07-06 22:58:53 -0400] erratic: my brain is not working right today
[2012-07-06 22:58:59 -0400] erratic: blame mdma, mdma
[2012-07-06 22:59:14 -0400] kallistec: erratic: btw, ports are listed with the components: http://wiki.opscode.com/display/chef/Chef+Server
[2012-07-06 22:59:26 -0400] erratic: I prob wont remember that url
[2012-07-06 22:59:31 -0400] erratic: but I'll sure bookmark it
[2012-07-06 22:59:49 -0400] kallistec: yeah, it's the 3rd result for "ports" if you search the wiki ;)
[2012-07-06 22:59:59 -0400] erratic: ha you know what
[2012-07-06 23:00:04 -0400] yfeldblum: uncommitted, this bit here: `node[:cacti][:tmpdir]`
[2012-07-06 23:00:05 -0400] erratic: you sound like me
[2012-07-06 23:00:07 -0400] yfeldblum: uncommitted, that will fail
[2012-07-06 23:00:10 -0400] erratic: go google it and here I am
[2012-07-06 23:00:11 -0400] erratic: asking you anyway
[2012-07-06 23:00:31 -0400] uncommitted: it's an attribute, should be fine? I can hard code it to be sure
[2012-07-06 23:00:38 -0400] erratic: it wouldnt be the first time I googled to find port numbers for something either
[2012-07-06 23:01:08 -0400] kallistec: eh, I don't tell ppl lmgtfy on principle, but I could be at the bar or something the next time you need help ;)
[2012-07-06 23:01:33 -0400] erratic: kallistec: hahahahah
[2012-07-06 23:01:37 -0400] yfeldblum: jan0232, not a fan of cap in general
[2012-07-06 23:01:38 -0400] erratic: do I know you
[2012-07-06 23:01:53 -0400] kallistec: maybe? I was at Chef Conf
[2012-07-06 23:01:55 -0400] yfeldblum: jan0232, it's a good tool and i know many people like it, but it's not the way i would prefer to work
[2012-07-06 23:01:59 -0400] erratic: nah
[2012-07-06 23:02:00 -0400] uncommitted: yfeldblum? you nailed it
[2012-07-06 23:02:09 -0400] erratic: unless you're a seattlite I prob donno you
[2012-07-06 23:02:17 -0400] kallistec: well, I am that also
[2012-07-06 23:02:27 -0400] kallistec: At the opscode mothership
[2012-07-06 23:02:32 -0400] yfeldblum: uncommitted, i see a second problem too, this bit: execute "add_hosts" do
[2012-07-06 23:02:34 -0400] erratic: https://lh6.googleusercontent.com/-FVoNdC6ZCrs/AAAAAAAAAAI/AAAAAAAAFqU/4Q4RULQ-Sts/s250-c-k/photo.jpg
[2012-07-06 23:02:40 -0400] erratic: have you seen me at meetups
[2012-07-06 23:02:46 -0400] erratic: or at the devops meetup
[2012-07-06 23:03:02 -0400] kallistec: you look familiar
[2012-07-06 23:03:17 -0400] uncommitted: yfeldblum it seems to have been the attribute, works when it's hardcoded.
[2012-07-06 23:03:18 -0400] erratic: we've probably met at one I go to dozens of meetups lol
[2012-07-06 23:03:26 -0400] yfeldblum: uncommitted, first of all, just so you're aware, that just sets up a resource of type "execute" and name "add_hosts", and the resoure will be converged (the command will be executed) much later and not immediately
[2012-07-06 23:03:58 -0400] kallistec: erratic: my pic on the twitter: https://twitter.com/kallistec
[2012-07-06 23:04:07 -0400] kallistec: or https://si0.twimg.com/profile_images/204504888/myface.jpg
[2012-07-06 23:04:29 -0400] erratic: ruby meetups?
[2012-07-06 23:04:40 -0400] erratic: I used to go to the racer cafe sometimes
[2012-07-06 23:04:40 -0400] yfeldblum: uncommitted, second of all, the first time you declare a resource of type "execute" and name "add_hosts", chef creates a new resource instance and adds it to the list of resources; the second time you declare a resource with that type and name, chef will actually not make a new resource instance - instead, chef will pull out the old resource instance with that type and name, and simply change its attributes
[2012-07-06 23:04:55 -0400] kallistec: I've been remiss on attending the seattle.rb
[2012-07-06 23:05:20 -0400] kallistec: mostly b/c I have to get home to feed my dog before I can go out
[2012-07-06 23:05:34 -0400] pehlert: Folks, is there a way to use the users cookbook without hardcoding the gid? I don't feel like changing it on all my machines at this point
[2012-07-06 23:05:55 -0400] yfeldblum: uncommitted, so by the time chef gets around to converging all the resources that you added to the resources list in your recipes, there will be only one resource of type "execute" and name "add_hosts", and its "command" attribute (the command that chef will try running) will be set based on the data for host s_208_02 (which is the last host)
[2012-07-06 23:06:59 -0400] yfeldblum: uncommitted, what you should do is make sure that each resource you declare has a completely unique name; in the case of execute resources, you can put the host name somewhere into the resource's name like so: execute "my_recipe - add_hosts for node #{node}"
[2012-07-06 23:07:33 -0400] erratic: kallistec: I'll see you around
[2012-07-06 23:07:50 -0400] kallistec: erratic: yeah, I'm sure we'll bump into each other
[2012-07-06 23:07:57 -0400] erratic: Im here all the time
[2012-07-06 23:07:58 -0400] yfeldblum: uncommitted, finally, it's preferable to take lines like this: `hostname = node_data['hostname']` and pull them up outside of the resource declaration (move them before the line `execute "name-of-execute-resource"`
[2012-07-06 23:08:17 -0400] erratic: and I've seen you here so I'll remember your name
[2012-07-06 23:08:35 -0400] erratic: I assume you're cool enough to meet for a drink I dont think hoover_damm will ever come hang out
[2012-07-06 23:08:40 -0400] erratic: Ive tried to get him to a bunch
[2012-07-06 23:08:44 -0400] erratic: I just want to meet ppl
[2012-07-06 23:08:49 -0400] erratic: need more friends
[2012-07-06 23:09:11 -0400] erratic: who are computer geeks somehow I lost touch with a lot of people
[2012-07-06 23:09:39 -0400] erratic: everyones always busy too
[2012-07-06 23:09:40 -0400] erratic: so am I
[2012-07-06 23:09:44 -0400] erratic: I dont get off for another hour
[2012-07-06 23:10:20 -0400] kallistec: yeah, I'm pretty busy nowadays, down to get a beer sometime. ping me on here or dan AT opscode
[2012-07-06 23:10:32 -0400] kallistec: gotta roll out now
[2012-07-06 23:13:23 -0400] uncommitted: yfeldblum, I was having the issue of chef running the last item previously, I've somehow managed to get out of that pickle! I've moved the variable declarations outside of the execute. So all of my hosts are running now, but now there's the issue of using the [:cacti][:tmpdir] attribute. I can probably muddle throuhg that though. Thank you so much for getting me on the right track!
[2012-07-06 23:14:25 -0400] yfeldblum: uncommitted, before the loop, just set a local variable: `cacti_tmpdir = node[:cacti][:tmpdir]`; then in the loop, instead of using `node[:cacti][:tmpdir]`, substitute that with `cacti_tmpdir`
[2012-07-06 23:16:51 -0400] uncommitted: exactly what I would have attempted first. thank you again!
[2012-07-06 23:22:06 -0400] yfeldblum: uncommitted, or, of course, choose another name for the first block argument: instead of `each do |node, node_data|` select a different name: `each do |host, host_data|` or something like that
[2012-07-06 23:31:11 -0400] syphon: So back to a question I asked earlier, can anyone think of any clever ways to make remote_file work with file:// URIs? It seems like it starts to work, but then just returns "target machine actively refused it"
[2012-07-06 23:33:20 -0400] yfeldblum: syphon, how about FileUtils.cp ?
[2012-07-06 23:33:31 -0400] syphon: specifically, I want this cookbook to be able to work the same if the .war payload is on a remote file share, or on the local system (as is the case in dev workstations)
[2012-07-06 23:34:51 -0400] erratic: dont be a jack ass like me, kids.
[2012-07-06 23:35:25 -0400] syphon: that was my thought, but if feels hacky. It'd basically say... <pseudo code>  if source.include?('http://') { #use remote file } else { use cp }</pseudo code>
[2012-07-06 23:36:45 -0400] c_t: syphon: I believe that's what it does already, actually
[2012-07-06 23:37:11 -0400] c_t: in remote file, it should use the local file stuff if it's not actually a URL
[2012-07-06 23:37:27 -0400] c_t: (perhaps strip off file://?)
[2012-07-06 23:37:32 -0400] syphon: hmm
[2012-07-06 23:37:55 -0400] syphon: I currently do this: remote_file "file:///c:/folder/file.war" and it tells me the target server refused the connection
[2012-07-06 23:38:03 -0400] syphon: (yes, this is Windows)
[2012-07-06 23:39:18 -0400] patcon: anyone have any thought on why the behavior of the php_pear resource might change (and start failing) when going from chef 0.10.8 to 0.10.10?
[2012-07-06 23:39:33 -0400] patcon: currently stuck on 0.10.8 until I can figure out why... it's wierd
[2012-07-06 23:39:35 -0400] syphon: same error if I strip off the "file:///"
[2012-07-06 23:40:24 -0400] c_t: try stripping just file:// maybe
[2012-07-06 23:40:45 -0400] c_t: I haven't used Chef with Windows, but it might need to be /c:/...
[2012-07-06 23:40:50 -0400] syphon: ok, now I'm getting a 'file not found' and Chef started looking around inside the cookbook for the file
[2012-07-06 23:40:58 -0400] c_t: progress?
[2012-07-06 23:40:59 -0400] bawt_: progress is progress
[2012-07-06 23:41:00 -0400] syphon: so maybe I'm getting closer (or further?)
[2012-07-06 23:41:39 -0400] syphon: hmm the problem is that the .war file payload will not be inside the cookbook. It could be anywhere in the file system (and ideally, the developer would point to it with an attribute override)
[2012-07-06 23:44:10 -0400] PapaSierra11: how do i fix this? http://dpaste.com/768184/ thanks
[2012-07-06 23:45:09 -0400] c_t: hmm
[2012-07-06 23:45:23 -0400] c_t: so you always expect the war file to be local?
[2012-07-06 23:45:50 -0400] syphon: no, the DEFAULT is that it will be over http
[2012-07-06 23:46:10 -0400] syphon: but I want the cookbook to support developers installing a locally-built war file too
[2012-07-06 23:46:17 -0400] c_t: hmm, should work then
[2012-07-06 23:46:24 -0400] c_t: have you run chef-client -l debug?
[2012-07-06 23:46:39 -0400] syphon: my hope was that they could just override an attribute from "http://network.com/folder/file.war" to "file:///c:/workspace/file.war" and have it work
[2012-07-06 23:47:19 -0400] c_t: PapaSierra11: check your apt sources
[2012-07-06 23:47:35 -0400] c_t: looks like that version of libxml2-dev isn't being found
[2012-07-06 23:48:38 -0400] PapaSierra11: c_t, ok, i am using the apt cookbook, shouldn't there be a way to add sources?
[2012-07-06 23:48:50 -0400] c_t: there is, in fact
[2012-07-06 23:48:58 -0400] c_t: hold on, lemme dig up an example
[2012-07-06 23:49:58 -0400] syphon: c_t: I'm checking the debug but it doesn't really throw anything useful, as far as I can tell. Either it says "target refused connection" or or says it can't find the file in the cookbook
[2012-07-06 23:50:15 -0400] syphon: I'm not sure which way is *closer* to getting things working, so I don't know which one to focus on :)
[2012-07-06 23:50:29 -0400] c_t: PapaSierra11: I have a recipe like this: https://gist.github.com/3063448
[2012-07-06 23:50:30 -0400] PapaSierra11: plus i'm using chef solo, not sure if that's an important fact
[2012-07-06 23:51:25 -0400] PapaSierra11: c_t thanks for the gist. so you have your own custom cookbook with that recipe?
[2012-07-06 23:51:52 -0400] c_t: syphon: Hmm. Should work that way then, but as I said earlier I've never used chef w/ Windows, so there's a possibility it may not behave right there
[2012-07-06 23:51:58 -0400] c_t: PapaSierra11: yurp
[2012-07-06 23:57:03 -0400] erratic: Im out
[2012-07-06 23:57:31 -0400] PapaSierra11: c_t i believe this is the package in question. https://launchpad.net/ubuntu/+source/libxml2/2.7.8.dfsg-5.1ubuntu4.1 however,being new to apt-get, i'm not sure what to add to the sources
[2012-07-06 23:57:31 -0400] jan0232: somebody have an idea why my assets:precompile task could abort like that? http://nopaste.info/0b4bdffe0b.html
[2012-07-06 23:58:31 -0400] jan0232: the bundle installed successfully in vendor/bundle  if i fire the commands manually it works only chef struggles :(
