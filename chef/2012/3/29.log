[2012-03-29 00:02:07 -0400] jkyle: when you write a plugin, how do you access the data in a recipe? e.g. if it: provides "network", should I be able to get at that data in node["network"]?
[2012-03-29 00:03:36 -0400] erratic: tight
[2012-03-29 00:03:38 -0400] erratic: it works
[2012-03-29 00:04:21 -0400] erratic: hellz yeah
[2012-03-29 00:04:32 -0400] erratic: now to do the rsync stuff.
[2012-03-29 00:05:23 -0400] erratic: I really really like that the chef-repo is git
[2012-03-29 00:05:32 -0400] erratic: and wants me to commit before it does a pull
[2012-03-29 00:05:49 -0400] erratic: so you can have a local commit log for tracking revisions and stuff
[2012-03-29 00:05:52 -0400] erratic: thats pretty sweet
[2012-03-29 00:06:27 -0400] erratic: I really agree with chef alot this is cool
[2012-03-29 00:10:25 -0400] erratic: one thing I really don't understand, is that the chef-client runs like every 1800 seconds or whatever, does it pull all of this data from the chef server everytime or just everytime since I have uploaded data, because I want to say it would be sensible to add something that restarts apache to the recipe but obviously I don't want it restarting apache every single time
[2012-03-29 00:12:25 -0400] paulmooring: erratic: the whole run_list runs every time chef_client runs
[2012-03-29 00:13:20 -0400] paulmooring: the idea of idempotence is pretty core to Chef, so in your case you would want to check if apache needs to be restarted in the cookbook
[2012-03-29 00:17:58 -0400] paulmooring: erratic: Check out notifications in the wiki for a better idea of how to do it http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-03-29 00:25:50 -0400] erratic: cool thank you
[2012-03-29 00:29:07 -0400] erratic: dude thats awesome
[2012-03-29 00:30:29 -0400] paulmooring: erratic: no problem, and for your earlier question, attributes can use symbols or strings interchangeably so node['php']['conf_dir'] is the same as node[:php][:conf_dir]
[2012-03-29 00:31:15 -0400] paulmooring: but for reasons you probably don't want to worry about right now use stings (node['php']['conf_dir'])
[2012-03-29 00:55:43 -0400] vju: is it possible to start executing a node's run list via the hosted chef interface?
[2012-03-29 00:56:23 -0400] paulmooring: vju: no, the server can't run anything on the clients
[2012-03-29 00:56:52 -0400] vju: ah ok, thanks
[2012-03-29 02:15:09 -0400] frop: feeling dumb here (as usual)
[2012-03-29 02:15:21 -0400] frop: how do I create a client so someone else can use knife?
[2012-03-29 02:20:04 -0400] matschaffer: frop: `knife client create` might want -a for admin and -u for user name. Run it with no options for help.
[2012-03-29 02:20:44 -0400] frop: matschaffer: thanks
[2012-03-29 02:20:48 -0400] matschaffer: np
[2012-03-29 02:22:45 -0400] frop: so all they need to use knife is the private key and ~/chef/knife.rb pointing to the chef server?
[2012-03-29 02:27:19 -0400] erikh: correct
[2012-03-29 02:27:36 -0400] erikh: the validation key will be required to create new clients.
[2012-03-29 03:27:21 -0400] jberanek: Is there some form of restriction on using knife to modify data bags when not using a chef server (only working in chef solo)?
[2012-03-29 03:34:35 -0400] hoover_damm: why would you use knife with chef solo?
[2012-03-29 03:34:54 -0400] hoover_damm: perhaps to download cookbooks but outside of that it has very little value
[2012-03-29 03:35:26 -0400] holoway: jberanek: just use an editor
[2012-03-29 03:35:32 -0400] holoway: jberanek: knife does nothing for you at all
[2012-03-29 03:35:35 -0400] holoway: if it's all local
[2012-03-29 03:35:47 -0400] hoover_damm: he put it in a much better manner
[2012-03-29 03:36:57 -0400] jberanek: I'm using vagrant and chef-solo to play around with some recipes, and wanted to use encrypted-databags (though I don't even know if that's supported with chef-solo). I can't see a way to use encrypted databags without knife commands.
[2012-03-29 03:37:38 -0400] jberanek: Otherwise, I would go ahead and just use an editor
[2012-03-29 03:40:06 -0400] newb: facing issue with :q
[2012-03-29 03:40:27 -0400] newb: facing issue with a knife cookbook upload
[2012-03-29 03:40:38 -0400] newb: FATAL: Cookbook file libraries/attr_struct.rb has a ruby syntax error: FATAL: .chef/repository/cookbooks/metachef/libraries/attr_struct.rb:21: syntax error, unexpected '=', expecting '|' FATAL:         define_method(name) do |val=nil| FATAL:                                     ^ FATAL: .chef/repository/cookbooks/metachef/libraries/attr_struct.rb:160: syntax error, unexpected kEND, expecting $end
[2012-03-29 03:40:47 -0400] newb: Some Googling lead to this pre-existing paste: http://pastebin.ca/2130164  $ ruby --version ruby 1.8.7 (2012-02-08 patchlevel 358) [x86_64-linux]  $ chef-client --version Chef: 0.10.8  uname -a Linux C2 2.6.32-38-server #83-Ubuntu SMP Wed Jan 4 11:26:59 UTC 2012 x86_64 GNU/Linux
[2012-03-29 03:41:14 -0400] bemu: newb: It's because you're using ruby 1.8, and that code requires ruby 1.9
[2012-03-29 03:41:21 -0400] newb: damn
[2012-03-29 03:41:37 -0400] newb: will all of stock chef run fine if I use ruby 1.9?
[2012-03-29 03:42:41 -0400] hoover_damm: no, the world is not ready for ruby 1.9
[2012-03-29 03:42:43 -0400] hoover_damm: go back to ruby 1.6
[2012-03-29 03:42:44 -0400] hoover_damm: j/k
[2012-03-29 03:42:52 -0400] hoover_damm: yes enjoy ruby 1.9.3 seriously
[2012-03-29 03:43:03 -0400] hoover_damm: no reason why you'd wanna run 1.8.7
[2012-03-29 03:43:14 -0400] newb: hoover_damm, I thought ruby 1.9.3 was like python 3
[2012-03-29 03:43:22 -0400] newb: hence did not install it
[2012-03-29 03:43:36 -0400] newb: is there a way I could rvm my way out of this?
[2012-03-29 03:43:37 -0400] hoover_damm: newb, ruby is ruby
[2012-03-29 03:43:47 -0400] josephholsten: does python 3 work awesome? because 1.9.3 is great
[2012-03-29 03:43:59 -0400] hoover_damm: there was syntax changes, but 1.9.3 is awesome
[2012-03-29 03:44:01 -0400] hoover_damm: and so is python 3
[2012-03-29 03:44:06 -0400] hoover_damm: i installed python 3.2 recently
[2012-03-29 03:44:25 -0400] hoover_damm: damm@desolation> /usr/bin/python3.2 --version                                                                                                                                                                                                                                                                               ~
[2012-03-29 03:44:30 -0400] hoover_damm: :)
[2012-03-29 03:44:43 -0400] hoover_damm: Python 3.2.2
[2012-03-29 03:44:46 -0400] hoover_damm: doh
[2012-03-29 03:44:47 -0400] hoover_damm: heh
[2012-03-29 03:44:59 -0400] hoover_damm: gosh this is an old gentoo box
[2012-03-29 03:45:06 -0400] newb: is there a way I could rvm my way out of this or something similar without removing 1.8 and reinstallting everything?
[2012-03-29 03:45:16 -0400] hoover_damm: 2.4, 2.5, 2.6, 2.7, 3.0, 3.1, 3.2
[2012-03-29 03:45:39 -0400] hoover_damm: wish ruby was that easy
[2012-03-29 03:51:03 -0400] bemu: newb: You probably could if you wanted to, you could also use the omnibus installer.
[2012-03-29 03:52:08 -0400] newb: why is it better than a rvm way?
[2012-03-29 03:52:43 -0400] josephholsten: mostly because rvm is designed for development, not production
[2012-03-29 03:52:49 -0400] bemu: ^
[2012-03-29 03:53:10 -0400] bemu: I use omnibus ruby for my system ruby now.
[2012-03-29 03:53:27 -0400] holoway: bemu: careful! :)
[2012-03-29 03:54:02 -0400] bemu: Let me disclaim that I don't do anything with ruby these days except chef and a few nagios/collectd plugins.
[2012-03-29 03:54:18 -0400] holoway: bemu: awesome - go on with your bad self then :)
[2012-03-29 03:54:50 -0400] bemu: What do we need to be careful out, though? Just to make sure I didn't miss anything. :)
[2012-03-29 03:59:56 -0400] coderanger: bemu: collectd_python ftw dude
[2012-03-29 04:01:02 -0400] bemu: That's the python plugin for collectd?
[2012-03-29 04:01:14 -0400] bemu: Using that currently, but had a lot of trouble getting it to work in interactive mode. Ended up giving up.
[2012-03-29 04:01:47 -0400] coderanger: Heh, haven't tried that
[2012-03-29 04:02:03 -0400] bemu: What did you mean then?
[2012-03-29 04:02:42 -0400] coderanger: I mean I use collectd_python, I just haven't ever used its interactive mode
[2012-03-29 04:07:08 -0400] bemu: ah, word. Thanks!
[2012-03-29 04:08:26 -0400] bemu: pychef is a core part of a system handling thousands of requests per second. :D
[2012-03-29 04:09:57 -0400] coderanger: :)
[2012-03-29 04:10:10 -0400] bemu: It's a pretty simple role, but it makes everything work.
[2012-03-29 04:10:11 -0400] coderanger: I need to go cut a new release soonish with the 0.10 fixes
[2012-03-29 04:10:35 -0400] coderanger: So if you have patches for the next version, send 'em soon ;-)
[2012-03-29 04:10:36 -0400] bemu: We're basically just doing a few searches and storing IPs in redis.
[2012-03-29 04:10:42 -0400] bemu: We haven't modified at all.
[2012-03-29 04:11:30 -0400] coderanger: Coolness :)
[2012-03-29 04:44:35 -0400] miah: hi
[2012-03-29 04:45:27 -0400] bemu: HELLO!
[2012-03-29 04:45:48 -0400] miah: whats up bemu
[2012-03-29 04:46:35 -0400] jtimberman: OH HAI
[2012-03-29 04:46:43 -0400] jtimberman: CAPITAL LETTERS TODAY AMIRITE?
[2012-03-29 04:46:52 -0400] miah: yessir
[2012-03-29 04:48:14 -0400] bemu: Yessir
[2012-03-29 04:49:34 -0400] miah: i am not a fan of the shift key
[2012-03-29 04:49:41 -0400] |shad0w|: W00T
[2012-03-29 04:50:32 -0400] coderanger: miah: capslock is still there!
[2012-03-29 04:51:00 -0400] |shad0w|: CAPSLOCKS MAKE THIS EASY, THANKS!!!
[2012-03-29 04:51:02 -0400] miah: no. its remapped to control
[2012-03-29 04:52:00 -0400] |shad0w|: http://bash.org/?835030
[2012-03-29 04:53:37 -0400] coderanger: Somewhere I have a copy of Chris Forsythe from Adium/Growl explaining how he things capslock is much better than shift
[2012-03-29 04:53:44 -0400] coderanger: and how he hates the chromebook
[2012-03-29 04:58:15 -0400] jtimberman: my caps lock is bound to control. as it should be.
[2012-03-29 05:19:34 -0400] BryanWB: miah: gotta sec? how do u load balance b/w your load balancers? do u use some whacky networking like a virtual ip or ECMP?
[2012-03-29 05:21:24 -0400] coderanger: BryanWB: Do you mean balance the LBs themselves or downstream traffic?
[2012-03-29 05:21:40 -0400] BryanWB: coderanger: b/w the lbs themselves, specifically haproxy
[2012-03-29 05:22:00 -0400] BryanWB: this is my first foray into lbs so am pretty ignorant
[2012-03-29 05:22:11 -0400] coderanger: Speaking for us, only one of the balancers is active at any given time, they all share a floating virtual ip via heartbeat
[2012-03-29 05:23:16 -0400] coderanger: Really the only server-intensive thing the LBs are doing, in general, is SSL termination
[2012-03-29 05:23:22 -0400] BryanWB: coderanger: interesting, iirc miah has an interesting setup w/ 4 lbs, not sure if she has a floating ip or someo other setup
[2012-03-29 05:23:33 -0400] BryanWB: coderanger: u don't offload to stunnel or stud?
[2012-03-29 05:23:50 -0400] coderanger: we are using nginx as the LB, which handles it just fine
[2012-03-29 05:24:19 -0400] bemu: bryanwb: I know that she's been checking out 1.5's peering, so that may be it.
[2012-03-29 05:24:37 -0400] bemu: We actually put haproxy behind ELB to not have to deal with the problem, but it's a temporary bandaid.
[2012-03-29 05:25:15 -0400] BryanWB: bemu: yeah she uses `peers` and 1.5 but i am haven't yet learned what `peers` are
[2012-03-29 05:25:46 -0400] bemu: They're haproxies which communicate with eachother.
[2012-03-29 05:26:23 -0400] bemu: http://haproxy.1wt.eu/download/1.5/doc/configuration.txt
[2012-03-29 05:26:28 -0400] bemu: Search for "Peers"
[2012-03-29 05:27:04 -0400] BryanWB: bemu: i know, i should rtfw but it is so easy just to ask miah as she is so darn smart, time to rtfw, tks
[2012-03-29 05:32:30 -0400] bemu: Same.
[2012-03-29 05:33:28 -0400] coderanger: The peers stuff looks like it is aimed at distributing the sitcky routing table, not actually trunking the distinct LBs
[2012-03-29 05:34:04 -0400] coderanger: so if you have a failover, you are still routed to the right backend
[2012-03-29 05:34:54 -0400] BryanWB: i thought the consistent hashing took care of that, as consistent hashes were consistent  regardless of which LB services your request, thus no need to replicate sticky routing table
[2012-03-29 05:35:20 -0400] coderanger: BryanWB: haproxy lets you declare rules for routing, so it has to store the outcome somewhere
[2012-03-29 05:35:58 -0400] coderanger: I guess it doesn't have to, but it would be annoying slow to not do so :)
[2012-03-29 05:36:22 -0400] BryanWB: ah, so it makes routing decision once and then caches the decision?
[2012-03-29 05:36:32 -0400] coderanger: I think so, if I'm reading all this correctly
[2012-03-29 05:36:49 -0400] coderanger: and with the peers stuff it stores in some kind of DHT-ish thing
[2012-03-29 05:41:34 -0400] learnchef: I tried to follow "http://jonathanotto.com/blog/chef-tutorial-in-minutes.html" to get a hello world running, but I got the following error msg...
[2012-03-29 05:42:01 -0400] learnchef: sean@sean-VirtualBox:~$ chef-solo -c /home/sean/my_cookbooks/chefsoloconfig.rb -j /home/sean/my_cookbooks/roles/ottobib.json -ldebug Invalid gemspec in [/var/lib/gems/1.8/specifications/json-1.6.1.gemspec]: invalid date format in specification: "2011-09-18 00:00:00.000000000Z" Invalid gemspec in [/var/lib/gems/1.8/specifications/mime-types-1.18.gemspec]: invalid date format in specification: "2012-03-21 00:00:00.000000000Z" /usr/lib/ru
[2012-03-29 05:42:33 -0400] coderanger: learnchef: You are using the freenode webchat, yay! was the link suitably easy to find?
[2012-03-29 05:42:51 -0400] coderanger: learnchef: Also, IRC generally frowns on large pastes, try something like pastebin.com
[2012-03-29 05:43:46 -0400] coderanger: Anyways, what version of rubygems do you have? `gem --version`
[2012-03-29 05:44:53 -0400] learnchef: thanks for helping out :-) I guess it's 1.7.2?
[2012-03-29 05:45:18 -0400] learnchef: gem --version also returned my an error msg
[2012-03-29 05:45:38 -0400] coderanger: Vaguely recent at least
[2012-03-29 05:45:47 -0400] learnchef: "Invalid gemspec in [/var/lib/gems/1.8/specifications/json-1.6.1.gemspec]...... 1.7.2"
[2012-03-29 05:46:21 -0400] learnchef: invalid date format in specification: "2011-09-18 00:00:00.000000000Z"
[2012-03-29 05:47:21 -0400] coderanger: Upgrading gems will probably fix it
[2012-03-29 05:47:38 -0400] coderanger: or, if you feeling lazy and hackish just open the files mentioned and change the date strings ;-)
[2012-03-29 05:50:27 -0400] learnchef: thanks, coderanger. I am a newbie both in ruby and chef :-(
[2012-03-29 05:50:35 -0400] learnchef: where should i get started?
[2012-03-29 05:50:59 -0400] coderanger: Try this: sudo gem update --system
[2012-03-29 05:51:37 -0400] coderanger: If you installed from apt or yum, it might refuse though
[2012-03-29 05:52:01 -0400] coderanger: in which case, I would recommend just ignoring the warnings :)
[2012-03-29 05:52:46 -0400] learnchef: "sudo gem update --system"      ERROR:  gem update --system is disabled on Debian
[2012-03-29 05:52:50 -0400] learnchef: I am using ubuntu
[2012-03-29 05:53:49 -0400] coderanger: Try: gem install rubygems-update && update_rubygems
[2012-03-29 05:53:56 -0400] coderanger: Not sure if that works with system ruby on debian
[2012-03-29 05:54:15 -0400] coderanger: (yes, the state of ruby packaging is kind of a mess >_<)
[2012-03-29 05:54:27 -0400] coderanger: s/ruby/all recent langs/
[2012-03-29 05:55:24 -0400] jtimberman: s/recent langs/the things/
[2012-03-29 05:55:30 -0400] jtimberman: packaging: not a solved problem.
[2012-03-29 05:56:00 -0400] coderanger: At least I can apt-get install apache2 and get something not totally b0rked
[2012-03-29 05:56:47 -0400] |shad0w|: tar everything and rsync right
[2012-03-29 06:00:23 -0400] learnchef: coderanger: can you take a look at http://pastebin.com/9PRHFMpT?
[2012-03-29 06:02:06 -0400] coderanger: Oh right, you can't ignore it if you need one of those gems
[2012-03-29 06:03:30 -0400] coderanger: jtimberman: Whats The Right Way to upgrade gems on ubuntu?
[2012-03-29 06:07:56 -0400] jtimberman: coderanger: hm?
[2012-03-29 06:08:25 -0400] coderanger: learnchef is having issues with gems rejecting some spec files, which I seem to remember is fixed in rubygems 1.8.mumble
[2012-03-29 06:08:53 -0400] jtimberman: oh
[2012-03-29 06:08:56 -0400] jtimberman: like, to upgrade rubygems itself?
[2012-03-29 06:09:22 -0400] jtimberman: if rubygems was installed as a package, on newer versions of ubuntu i think there's an environment variable you can export in your shell to tell it you know what you're doing and to upgrade system gems.
[2012-03-29 06:09:33 -0400] jtimberman: if its installed from source, gem update --system iirc
[2012-03-29 06:09:55 -0400] coderanger: installed from apt
[2012-03-29 06:11:20 -0400] coderanger: probably want to get it from source, thats how we do it :)
[2012-03-29 06:11:50 -0400] learnchef: yeah, i installed it from apt-get install rubygems
[2012-03-29 06:12:35 -0400] coderanger: Probably just want to grab the latest tarball (looks like that is 1.8.21) and just run setup.rb
[2012-03-29 06:13:42 -0400] jtimberman: uninstall the rubygems package first
[2012-03-29 06:13:47 -0400] jtimberman: if you're going to do that
[2012-03-29 06:19:24 -0400] jtimberman: apparently the env variable is REALLY_GEM_UPDATE_SYSTEM
[2012-03-29 06:19:32 -0400] jtimberman: to do gem update --system on newer ubuntus
[2012-03-29 06:19:38 -0400] jtimberman: (oneiric in my case0
[2012-03-29 06:25:03 -0400] geekyogi: Hi.. how can I check the chef version installed on my ubuntu box ?
[2012-03-29 06:26:35 -0400] coderanger: chef-client --version
[2012-03-29 06:30:49 -0400] Babar: or dpkg -l chef
[2012-03-29 06:46:26 -0400] geekyogi: thanks babar, coderanger
[2012-03-29 06:56:30 -0400] bendrix415: im looking for away for chef-solo to deploy my app
[2012-03-29 06:57:01 -0400] bendrix415: i can see how to do it in git but what if i just had a tar file of the data and code
[2012-03-29 06:57:12 -0400] bendrix415: what would be the best way to do it
[2012-03-29 06:58:09 -0400] coderanger: bendrix415: How would you do it by hand?
[2012-03-29 06:58:27 -0400] coderanger: Copy that into a bash resource, and you are all set :)
[2012-03-29 06:59:38 -0400] bendrix415: hmm, ok
[2012-03-29 07:00:18 -0400] bendrix415: right now i would grab the tar and extact to directory, are you saying i can use a bash resource to do the same
[2012-03-29 07:01:02 -0400] coderanger: Yep, use a remote_file resource or something to download the right tarball
[2012-03-29 07:01:20 -0400] coderanger: and then an execute or bash resource to run whatever commands you want to use
[2012-03-29 07:01:31 -0400] bendrix415: and the remote_file resource will have the ability to not redownload the entire tar again
[2012-03-29 07:02:15 -0400] coderanger: bendrix415: Use action :create_if_missing
[2012-03-29 07:02:32 -0400] coderanger: or fill in the checksum argument
[2012-03-29 07:03:08 -0400] bendrix415: sweet, so if i untar the directory, chef-solo can keep up with the last run of the tar?
[2012-03-29 07:03:45 -0400] coderanger: Not sure what you mean, it will run whatever commands you tell it to
[2012-03-29 07:04:24 -0400] bendrix415: im just thinking of when the tar file gets updated on the server
[2012-03-29 07:04:38 -0400] bendrix415: the checksum would be different
[2012-03-29 07:05:07 -0400] bendrix415: how does chef-solo keep up with the new tar vs the old
[2012-03-29 07:05:34 -0400] coderanger: You would have to update the checksum in the recipe, and probably the URL too
[2012-03-29 07:05:48 -0400] coderanger: (well, or put it in a role or in the node data)
[2012-03-29 07:06:08 -0400] bendrix415: ok, thanks
[2012-03-29 07:08:43 -0400] bendrix415: speaking of roles, I am using them but they seem to have to exist in cookbooks.tar.gz and can't be specified in json file
[2012-03-29 07:14:20 -0400] renchap: :act
[2012-03-29 07:25:24 -0400] geekyogi: can a single chef-client work with two different versions of chef-server
[2012-03-29 07:34:57 -0400] coderanger: bendrix415: In what JSON file?
[2012-03-29 07:35:19 -0400] coderanger: geekyogi: Yes, the servers are backwards compatible, the client is not
[2012-03-29 07:35:34 -0400] coderanger: 0.9 client on 0.10 server works, 0.10 client on 0.9 server will not
[2012-03-29 07:35:39 -0400] geekyogi: thanks @coderanger
[2012-03-29 07:43:09 -0400] Anand: knife ec2 server create --image ami-XXXX --run-list 'recipe[mongodb::10ge
[2012-03-29 07:43:10 -0400] Anand: n_repo]' -x ubuntu -d ubuntu10.04-gems -f m1.small -i ~/.ssh/key --re
[2012-03-29 07:43:10 -0400] Anand: gion eu-west-1 -Z eu-west-1a
[2012-03-29 07:43:26 -0400] coderanger: pastebin ftw
[2012-03-29 07:47:06 -0400] coderanger: Anand: Mispaste?
[2012-03-29 07:48:07 -0400] Anand: yes...ok..http://pastie.org/3690301
[2012-03-29 07:48:25 -0400] Anand: my problem is why this is asking for password??
[2012-03-29 07:48:32 -0400] Anand: and what password should i enter
[2012-03-29 07:48:33 -0400] Anand: ??
[2012-03-29 07:49:01 -0400] Anand: password is asking after creation of instance
[2012-03-29 07:49:12 -0400] Anand: i.e. at bootstarp process
[2012-03-29 07:53:50 -0400] Kwanasolis: Anand: did you strip the password line off the bootstrap?
[2012-03-29 07:54:02 -0400] Kwanasolis: oh you have an identity file, does ssh work?
[2012-03-29 07:54:09 -0400] Kwanasolis: that looks like an ssh error, not a chef one
[2012-03-29 07:54:35 -0400] coderanger: Anand: I don't see a -S in there
[2012-03-29 07:54:52 -0400] coderanger: You need to give EC2 the right key ID
[2012-03-29 07:55:02 -0400] Kwanasolis: well, there ya go
[2012-03-29 07:56:04 -0400] coderanger: You can cut down on the number of arguments a lot if you stick the important bits in your knife.rb :)
[2012-03-29 07:56:40 -0400] Anand: knife bootstrap xx.xx.xx.xx -i ~/.ssh/ec2_chef_keypair.pem -x ubuntu --sudo
[2012-03-29 07:56:43 -0400] Anand: this works well
[2012-03-29 07:56:51 -0400] coderanger: http://paste.pocoo.org/show/572921/
[2012-03-29 07:57:34 -0400] coderanger: annoyingly you can't give the ssh_username in a config file though, I should really go fix that one day
[2012-03-29 07:59:22 -0400] Anand: what should i do to fix this??
[2012-03-29 08:01:31 -0400] coderanger: Anand: You should be specifying the ssh key group ID
[2012-03-29 08:08:34 -0400] Anand: i.e. --ssh-key parameter right??
[2012-03-29 08:08:58 -0400] coderanger: Yeah
[2012-03-29 08:09:13 -0400] Anand: should i append .pem after file name
[2012-03-29 08:09:14 -0400] Anand: ??
[2012-03-29 08:09:16 -0400] coderanger: That should be the ID name that matches the key you give for -i
[2012-03-29 08:09:27 -0400] coderanger: No, it should just be the name from the EC2 control panel
[2012-03-29 08:10:08 -0400] Anand: still asking..
[2012-03-29 08:10:38 -0400] Anand: i have give id in knife.rb like : knife[:aws_ssh_key_id] = "key"
[2012-03-29 08:10:42 -0400] coderanger: Are you using an unusual AMI that doesn't pull its key in from instancedata or something?
[2012-03-29 08:11:16 -0400] Anand: the image is from example given on internet...
[2012-03-29 08:11:30 -0400] Anand: is the image problem??
[2012-03-29 08:12:09 -0400] coderanger: Sorry, I'm falling asleep, 1AM over here, gotta crash
[2012-03-29 08:13:35 -0400] Anand: no problem
[2012-03-29 08:13:39 -0400] Anand: u take a sleep
[2012-03-29 08:13:41 -0400] Anand: good night
[2012-03-29 09:09:21 -0400] Anand: [Thu, 29 Mar 2012 14:38:22 +0530] FATAL: ArgumentError: Cannot find a version fo
[2012-03-29 09:09:21 -0400] Anand: r node[mynode]
[2012-03-29 09:10:04 -0400] Anand: [Thu, 29 Mar 2012 14:38:22 +0530] FATAL: ArgumentError: Cannot find a version for node[tricklenet]
[2012-03-29 09:39:02 -0400] ashb: anyone got a redis cookbook that they use?
[2012-03-29 09:41:32 -0400] BryanWB: i have heard many use the infochimps-labs redis cookbook
[2012-03-29 09:42:01 -0400] ashb: ta - i'll take a look at it
[2012-03-29 09:43:31 -0400] matti: Hi ashb
[2012-03-29 09:58:16 -0400] Anand: m on windows 7...and registering the client by chef-client -c client.rb
[2012-03-29 09:58:31 -0400] Anand: its give me 401 error
[2012-03-29 09:58:54 -0400] Anand: i want to ask that is it necessary to give node name in client.rb file??
[2012-03-29 10:02:35 -0400] sampikesley: aren't you better off with 'knife client reregister my_borked_node' on your chef workstation?
[2012-03-29 10:02:45 -0400] sampikesley: gives you a new private key
[2012-03-29 10:06:35 -0400] Anand: where do i put this key?
[2012-03-29 10:08:41 -0400] sampikesley: paste it into /etc/chef/client.pem on the client
[2012-03-29 10:08:57 -0400] sampikesley: or wherever the f'ck that goes in wondows
[2012-03-29 10:16:54 -0400] ashb: BryanWB: bah runit. What's wrong with upstart or init.d scripts :(
[2012-03-29 10:19:03 -0400] withnale: using chef-server is there a way for a node to classify itself, and state which roles it should apply?
[2012-03-29 10:20:49 -0400] ashb: withnale: sort of. you can make API calls to change the roles etc, or include a cookbook/role that discovers and changes the roles
[2012-03-29 10:20:52 -0400] withnale: Working with a lot of short lifetime VMs I don't want to have to add each and every one via knife node
[2012-03-29 10:20:52 -0400] ashb: but its not typically done
[2012-03-29 10:21:22 -0400] ashb: ah - you can create some stuff in /etc/chef/first_boot.json (or whatever the right file is)
[2012-03-29 10:21:27 -0400] ashb: which might get you what you want
[2012-03-29 10:21:45 -0400] withnale: so can I point more than one server to the same node, and then modify the roles associated with it using the hostname regex matching, for instance?
[2012-03-29 10:21:56 -0400] ashb: 'point more than one server to the same node' ?
[2012-03-29 10:22:27 -0400] withnale: 'chef-client -N default ' for example...
[2012-03-29 10:23:12 -0400] ashb: i don't know what that argument does :)
[2012-03-29 10:23:24 -0400] withnale: ok... --node-name then :)D
[2012-03-29 10:25:32 -0400] ashb: oh right. I wouldn't have that change. IT sounds like the best thing is to have a role that is first in the run list and then adds other roles based on your rules
[2012-03-29 10:28:15 -0400] ashb: BryanWB: no good. it depends on metachef which looks super cool but aparently is ruby 1.9 only (and my chefs are all using system ruby which is 1.8)
[2012-03-29 10:28:26 -0400] ashb: I can probably use most of it anyway though. thanks
[2012-03-29 10:42:21 -0400] Anand: the organization key file i.e. org-validator.pem is changed to _register_key. Is chag is updating features??
[2012-03-29 10:42:36 -0400] Anand: chef*
[2012-03-29 10:46:49 -0400] BryanWB: ashb: ouch
[2012-03-29 11:30:54 -0400] viraptor: hi all, it seems that chef 0.10.x cannot support cookbooks with versions >= 10.0.0
[2012-03-29 11:31:46 -0400] viraptor: did anyone run into that one before? I couldn't find any bug raised - basically all downloads for that cookbook end with 404
[2012-03-29 11:54:18 -0400] null_route: Anyone wanna help me brainstorm? I'm trying to put together a recipe for deploying an app which has been pushed into GIT. Where I'm stuck is the part where I trigger the Clients to run the relavent recipes. I don't want the clients to do a full chef run (users, java, etc) - I just want the client to run the deploy recipes (for example, the git resources, etc)
[2012-03-29 11:54:48 -0400] null_route: What's a good way to get the clients to run a specific role or recipe?
[2012-03-29 11:59:44 -0400] BryanWB: null_route: i don't think that's possible w/out reducing the run_list to just that role or recipe, are the other roles and recipes really that time consuming?
[2012-03-29 12:00:15 -0400] null_route: well
[2012-03-29 12:00:18 -0400] null_route: they do lost of stuff
[2012-03-29 12:00:28 -0400] null_route: like install java, tomcat
[2012-03-29 12:00:38 -0400] null_route: lots of config
[2012-03-29 12:00:53 -0400] Anand: i have created an instance using knife...and boot strap it..so it is register in hosted-chef server. now m stopping the instance and then start the instance, the ip is change of that instance...
[2012-03-29 12:00:55 -0400] Babar: you could run chef-client with a JSON setting its run_list to just that
[2012-03-29 12:01:22 -0400] Anand: now m trying to boot strap the instance but its giving an error of unauthorized
[2012-03-29 12:01:29 -0400] BryanWB: null_route: but if those resource already setup, chef-client doesn't have to do much
[2012-03-29 12:01:31 -0400] null_route: Babar: please explain
[2012-03-29 12:01:36 -0400] BryanWB: it sees they are already set up
[2012-03-29 12:02:06 -0400] null_route: BryanWB: agreed -
[2012-03-29 12:03:03 -0400] null_route: ...but I would like to limit the amount of changes during an applicatino deploy -
[2012-03-29 12:03:19 -0400] null_route: If there _IS_ a way to run specific recipes, that would better
[2012-03-29 12:03:20 -0400] null_route: ...
[2012-03-29 12:03:58 -0400] Babar: null_route: http://wiki.opscode.com/display/chef/Setting+the+run_list+in+JSON+during+run+time
[2012-03-29 12:04:34 -0400] null_route: Babar, you rock!
[2012-03-29 12:04:48 -0400] null_route: BryanWB: you too :-)
[2012-03-29 12:31:32 -0400] sampikesley: Anand: you gotta delete that node and client
[2012-03-29 12:31:39 -0400] proffalken: OHAI!
[2012-03-29 12:32:15 -0400] proffalken: Does anyone in here have a link to the bug regarding cookbook versions being > 9.9.9?
[2012-03-29 12:33:02 -0400] proffalken: I could do with a solution if one exists?
[2012-03-29 12:33:37 -0400] nico: don't have version numbers that big
[2012-03-29 12:33:46 -0400] nico: biggest is 0.0.57 :)
[2012-03-29 12:34:13 -0400] Anand: simpikesley: hmm...have deleted...thanks...but should allow to bootstrap
[2012-03-29 12:34:35 -0400] proffalken: nico: I saw something about this the other day and now I've lost the link, my concern is that the "solution" is to keep cookbook versions < 10.0.0
[2012-03-29 12:39:45 -0400] BryanWB: null_route: r u using my java and tomcat recipes or the opscode ones?
[2012-03-29 12:40:50 -0400] BryanWB: do i really need haproxy -> apache/nginx -> tomcat  or can i just have haproxy -> tomcat(s) ?
[2012-03-29 12:41:06 -0400] null_route: hmmm
[2012-03-29 12:42:04 -0400] null_route: Author:: Seth Chisamore (<schisamo@opscode.com>)  Copyright:: 2008-2011, Opscode, Inc
[2012-03-29 12:42:18 -0400] null_route: I have it install JAVA from an RPM
[2012-03-29 12:42:28 -0400] null_route: it goes through YUM what-provides each time
[2012-03-29 12:42:31 -0400] BryanWB: ah, openjdk
[2012-03-29 12:42:40 -0400] null_route: I gave it a SUN java RPM
[2012-03-29 12:42:55 -0400] null_route: but the yum whatprovides is actually the longest item on the runlist
[2012-03-29 12:43:14 -0400] null_route: that is, I assume that it doesn't recognize what versino I have
[2012-03-29 12:43:29 -0400] null_route: it then calls yum, which knows the rpm is already isntalled
[2012-03-29 12:43:34 -0400] null_route: I'm sure I can make it better
[2012-03-29 12:43:43 -0400] BryanWB: null_route: u can use my java recipe which is actually merged into opscode-cookbooks, but u have to host the tarball on your own http server
[2012-03-29 12:44:08 -0400] BryanWB: https://github.com/bryanwb/java
[2012-03-29 12:44:51 -0400] null_route: currently, I have the file in a cookbook_file
[2012-03-29 12:44:59 -0400] null_route: RPM*
[2012-03-29 12:45:07 -0400] BryanWB: the rpm is crap
[2012-03-29 12:45:26 -0400] BryanWB: oracle did a lousy job w/ it
[2012-03-29 12:45:38 -0400] null_route: ...but jpackage relies on the OpsCode java recipe - right?
[2012-03-29 12:45:49 -0400] null_route: the jpackage cookbook, that is
[2012-03-29 12:45:54 -0400] BryanWB: jpackage is crap too
[2012-03-29 12:46:02 -0400] BryanWB: considered harmful
[2012-03-29 12:46:37 -0400] null_route: BryanWB - so, the opscode java package is crap. The jpackage is crap
[2012-03-29 12:47:06 -0400] null_route: ...and I'm supposed to have Chef manage my Tomcat production environments why?
[2012-03-29 12:47:22 -0400] null_route: oy.
[2012-03-29 12:47:33 -0400] BryanWB: cuz it's better than relying on jpackage or handmade shell script
[2012-03-29 12:47:57 -0400] null_route: sorry - got a bit dossolusioned there for a moment...
[2012-03-29 12:48:11 -0400] null_route: disillusioned
[2012-03-29 12:48:55 -0400] BryanWB: null_route: that's ok, java support has been quite limited in the past, but u r no better using plain rpms or .debs on _any_ distro, actually far worse off
[2012-03-29 12:49:36 -0400] BryanWB: https://github.com/bryanwb/cookbooks/tree/master/tomcat, see maven too https://github.com/bryanwb/maven
[2012-03-29 12:50:10 -0400] null_route: cool
[2012-03-29 12:50:12 -0400] null_route: thanks
[2012-03-29 12:50:15 -0400] BryanWB: i have a big blog post coming out next week how i manage jboss deployments w/ chef, but need to follow up w/ post on tomcat
[2012-03-29 12:50:28 -0400] BryanWB: i couldn't do that shit w/ bash, i know cuz i tried earlier and failed
[2012-03-29 12:51:08 -0400] BryanWB: null_route: all my cookbooks are held together w/ the ark resource http://devopsanywhere.blogspot.it/2012/03/managing-archives-with-ark-resource.html
[2012-03-29 13:11:13 -0400] MarcMorata: Hi
[2012-03-29 13:11:49 -0400] MarcMorata: using the last version of community chef, (0.10.8) I'm having problems installing the openssl recipe
[2012-03-29 13:13:03 -0400] MarcMorata: FATAL: EOFError: end of file reached
[2012-03-29 13:13:41 -0400] sampikesley: installing on a client?
[2012-03-29 13:13:47 -0400] MarcMorata: yes
[2012-03-29 13:13:50 -0400] MarcMorata: but on the gui
[2012-03-29 13:13:53 -0400] MarcMorata: I see the same error
[2012-03-29 13:14:03 -0400] MarcMorata: I tried on 0.10.6 and 0.10.4
[2012-03-29 13:14:17 -0400] MarcMorata: I saw a bug related to taht
[2012-03-29 13:14:23 -0400] MarcMorata: but should be fixed on .8
[2012-03-29 13:31:53 -0400] MarcMorata: samography, any idea?
[2012-03-29 13:58:27 -0400] sampikesley: it works fine for me
[2012-03-29 13:58:30 -0400] sampikesley: is all I can tell you
[2012-03-29 14:17:40 -0400] hoover_damm: anyone know of any simple cookbooks that just search and dump the results to .ssh/config?
[2012-03-29 14:17:59 -0400] spyvsspy: i have 3 servers up and running fine, i just tried to launch another, and copied over my /etc/chef/validation.pem
[2012-03-29 14:18:07 -0400] spyvsspy: but I keep getting this when I run chef-clieng
[2012-03-29 14:18:07 -0400] spyvsspy: read_status_line': wrong status line: "<html>" (Net::HTTPBadResponse)
[2012-03-29 14:19:21 -0400] miketheman: hoover_damm: see this blog bost, might help http://warwickp.com/2011/09/knife-plugin-for-openssh-config
[2012-03-29 14:19:53 -0400] hoover_damm: ahh excellent
[2012-03-29 14:19:55 -0400] hoover_damm: different way to get there
[2012-03-29 14:19:59 -0400] hoover_damm: but same idea
[2012-03-29 14:20:44 -0400] spyvsspy: is this a ruby issue?
[2012-03-29 14:21:11 -0400] spyvsspy: I installed v 1.9.3, but it seems to be running 1.8 from the error
[2012-03-29 14:30:13 -0400] ryan-eme: spy, I'm probably doing it wrong, but...
[2012-03-29 14:30:25 -0400] ryan-eme: when I encounter that I usually rm -rf /etc/chef and re-bootstrap
[2012-03-29 14:38:05 -0400] spyvsspy: ryna-eme, I figured that out
[2012-03-29 14:38:15 -0400] spyvsspy: I had the wrong URL
[2012-03-29 14:38:31 -0400] spyvsspy: needed the http:// or else an exception is thrown, I can check in, but now I am getting a different error
[2012-03-29 14:38:57 -0400] spyvsspy: it actually creates my node, but then I get https://gist.github.com/2238041
[2012-03-29 14:42:40 -0400] spyvsspy: forgot to update my sources list
[2012-03-29 14:42:44 -0400] spyvsspy: had an old version of chef
[2012-03-29 14:42:45 -0400] spyvsspy: works
[2012-03-29 14:43:00 -0400] ryan-eme: haha good
[2012-03-29 14:43:03 -0400] ryan-eme: I was out of ideas
[2012-03-29 14:46:17 -0400] hoover_damm: miketheman, hrm darn it doesn't do exactly what I want... i'll have to fix it up :)
[2012-03-29 14:46:20 -0400] hoover_damm: but sitll thanks
[2012-03-29 15:00:30 -0400] miketheman: is it me, or is `knife status` against hosted chef taking a long time today?
[2012-03-29 15:01:10 -0400] miketheman: for about ~20 nodes total
[2012-03-29 15:01:32 -0400] itwasntandy: took 9 seconds for 91 nodes here.
[2012-03-29 15:01:40 -0400] miketheman: just took me 36 seconds
[2012-03-29 15:01:45 -0400] hoover_damm: knife status can be lengthy
[2012-03-29 15:02:07 -0400] hoover_damm: but 4s here for 300+nodes
[2012-03-29 15:02:23 -0400] itwasntandy: I don't trust some of the things it tells me
[2012-03-29 15:02:25 -0400] itwasntandy: 370287 hours ago, esinchm001.
[2012-03-29 15:02:37 -0400] miketheman: I'm getting consistently around the 35 second mark
[2012-03-29 15:02:49 -0400] vegardx: 2,3 sec for 30 nodes here
[2012-03-29 15:03:21 -0400] ryan-eme: mine was pretty fast too dunno
[2012-03-29 15:03:29 -0400] LeanReox: Hi all having a weird issue on a hosted chef server
[2012-03-29 15:03:53 -0400] LeanReox: suddenly im seeing Unauthorized on the client.log and the server.log on the chef-server
[2012-03-29 15:04:03 -0400] LeanReox: and chefserver and server-webui are not starting
[2012-03-29 15:04:07 -0400] LeanReox: working fine till today
[2012-03-29 15:04:10 -0400] LeanReox: any thoughts ?
[2012-03-29 15:04:21 -0400] LeanReox: we didnt change the validation.pem
[2012-03-29 15:04:25 -0400] LeanReox: and any config file
[2012-03-29 15:04:27 -0400] LeanReox: at all
[2012-03-29 15:04:56 -0400] hoover_damm: miketheman, they must have some code that says if (customer_name == 'miketheman' && sleep 30)
[2012-03-29 15:05:51 -0400] miketheman: hoover_damm: quite possible, yet improbably. Maybe they are giving QoS to higher paying customers? ;)
[2012-03-29 15:08:19 -0400] paulmooring: miketheman: you could run 'knife status -VV' and see where it's slow
[2012-03-29 15:09:16 -0400] miketheman: paulmooring: yeah. It's slow on the very first "Sending HTTP Request via GET to api."
[2012-03-29 15:09:37 -0400] yfeldblum_: miketheman, do you have enough free memory & cpu?
[2012-03-29 15:09:42 -0400] miketheman: there's not much debugging info from that
[2012-03-29 15:10:14 -0400] miketheman: yfeldblum: don't know how much free one would need - but is 2gb enough?
[2012-03-29 15:10:35 -0400] paulmooring: miketheman: do you mind if I ask your organization name?
[2012-03-29 15:13:27 -0400] afallows: Speaking of 'knife status', I'm running Open Source Chef and I'm getting 500 Connection refused errors when I do knife status. Where should I look to fix that?
[2012-03-29 15:18:51 -0400] zefer_: I am trying to configure a Jenkins server with RVM installed, using 'knife ec2 server create...'. I'm hitting this issue and would really appreciate any help: https://gist.github.com/baa7efa5e76d3fff317a
[2012-03-29 15:19:21 -0400] zefer_: I want it to configure RVM for both the 'ubuntu' and 'jenkins' users.
[2012-03-29 15:20:37 -0400] yfeldblum_: afallows, check that the chef-server-api is running?
[2012-03-29 15:22:02 -0400] hoover_damm: solr
[2012-03-29 15:22:04 -0400] hoover_damm: actually
[2012-03-29 15:22:21 -0400] hoover_damm: well both
[2012-03-29 15:22:28 -0400] hoover_damm: solr without the chef-server-api is meaningless
[2012-03-29 15:24:25 -0400] ssd7_: miketheman: Maybe DNS issue?
[2012-03-29 15:27:38 -0400] jws: has anyone had node[:ipaddress] start showing up as 'null'? Ohai reports the address correctly on the node, but the server continues to show/report null for the attribute
[2012-03-29 15:28:23 -0400] afallows: It would appear that chef-server-api is not running, but solr is. How do I start it? I haven't dealt with that before.
[2012-03-29 15:28:27 -0400] miketheman: ssd7: naw, since I'm testing from the same system, same connection to another hosted org, and that's much faster
[2012-03-29 15:29:28 -0400] miketheman: whereas the other org is running at8-10s
[2012-03-29 15:31:07 -0400] cwj: afallows: you probably have init scripts for each of those components, e.g. /etc/init.d/chef-server
[2012-03-29 15:32:51 -0400] afallows: cwj: I don't seem to have one called chef-server-api
[2012-03-29 15:33:23 -0400] sampikesley: service chef-server start or something
[2012-03-29 15:33:31 -0400] jonlives: afallows: chef-server is what starts the api workers, ps -ef | grep merb should show you if any are running
[2012-03-29 15:33:37 -0400] jws: afallows: /etc/init.d/chef-server *is* the chef-server-api
[2012-03-29 15:33:43 -0400] afallows: Ah, alright.
[2012-03-29 15:34:00 -0400] sampikesley: s /etc/init/chef-*
[2012-03-29 15:34:07 -0400] sampikesley: s/s/ls/
[2012-03-29 15:34:19 -0400] afallows: Well, that -is- running, as is solr. knife status still giving me Error 500
[2012-03-29 15:35:36 -0400] cgibbons: hmm
[2012-03-29 15:37:06 -0400] sampikesley: something is being logged somewhere
[2012-03-29 15:37:29 -0400] sampikesley: tail -f /var/log/chef/*log
[2012-03-29 15:37:32 -0400] sampikesley: or similar
[2012-03-29 15:37:37 -0400] sampikesley: turn up the debugging
[2012-03-29 15:44:28 -0400] afallows: I appear to be getting a 'No such file or directory' error when solr tries to execute its start.jar
[2012-03-29 15:56:33 -0400] sampikesley: /var/chef/solr-jetty/start.jar ?
[2012-03-29 15:57:09 -0400] afallows: Yeah.
[2012-03-29 15:57:30 -0400] sampikesley: you have that?
[2012-03-29 15:57:58 -0400] afallows: It's there, yeah.
[2012-03-29 16:00:30 -0400] sampikesley: you installed with a modified version of my voodoo script?
[2012-03-29 16:00:40 -0400] afallows: Yessir
[2012-03-29 16:00:59 -0400] afallows: I didn't change anything that I would have expected to pertain to this.
[2012-03-29 16:03:07 -0400] HasanB: Hi folks!
[2012-03-29 16:03:37 -0400] HasanB: I'm trying learn Chef and Ruby at the same time, and would appreciate a pointer.
[2012-03-29 16:03:46 -0400] afallows: smapikesley: https://gist.github.com/2238977
[2012-03-29 16:04:07 -0400] afallows: sampikesley, even.
[2012-03-29 16:04:25 -0400] afallows: That's the tail of my solr.log
[2012-03-29 16:04:37 -0400] HasanB: I'm trying to understand the functionality of a file that begins with these three lines:
[2012-03-29 16:04:46 -0400] HasanB: Class Chef
[2012-03-29 16:04:55 -0400] HasanB:      Class Util
[2012-03-29 16:05:09 -0400] HasanB:           Class FileEdit
[2012-03-29 16:05:28 -0400] ashb: class Chef::Util::FileEdit
[2012-03-29 16:05:31 -0400] ashb: i.e. create a nested class
[2012-03-29 16:06:07 -0400] HasanB: The rest of it seems to trivial to be complete.  Is it a subclass of something else?  Where do I find the documentation (or source code) for Chef:Util  ??
[2012-03-29 16:06:31 -0400] ashb: its not a subclass. it just lives inside it
[2012-03-29 16:06:49 -0400] HasanB: Ah!
[2012-03-29 16:07:26 -0400] HasanB: It refers to a variable  @contents   So that's elsewhere in the same pkg?
[2012-03-29 16:07:44 -0400] ashb: no, that would be in the same class
[2012-03-29 16:07:46 -0400] sampikesley: afallows: 1.9.3 caused me way too much pain when I was putting that together
[2012-03-29 16:07:47 -0400] sampikesley: srsly
[2012-03-29 16:07:52 -0400] sampikesley: drop back to 1.9.2
[2012-03-29 16:08:45 -0400] sampikesley: rvm install 1.9.2
[2012-03-29 16:08:50 -0400] sampikesley: go make a cup of tea
[2012-03-29 16:08:57 -0400] sampikesley: come back, all is better (maybe)
[2012-03-29 16:09:02 -0400] ashb: what changed from .2 to .3?
[2012-03-29 16:10:04 -0400] HasanB: ashb:   Thanks for your help!    Can you tell me, where do I find the documentation (or source code) for Chef::Util  ?
[2012-03-29 16:10:36 -0400] ashb: HasanB: either the other files in the same dir, or in util.rb the directory above
[2012-03-29 16:10:44 -0400] ashb: its possible that there is nothing in Chef::Util but other classes
[2012-03-29 16:13:30 -0400] HasanB: ashb:  so Chef::Util is NOT a pkg created by the Chef developers?
[2012-03-29 16:13:56 -0400] ashb: HasanB: its more like a namespace than a package
[2012-03-29 16:14:18 -0400] HasanB: (I'm from a Java background, so this is a bit mysterious.)
[2012-03-29 16:14:52 -0400] HasanB: is   @contents   some sort of reserved word?
[2012-03-29 16:15:06 -0400] ashb: there is no distinction between a class or a namespace in ruby. its just a container that contains other classes
[2012-03-29 16:15:26 -0400] HasanB: sorry to ask such rudimentary questions,
[2012-03-29 16:16:15 -0400] HasanB: it looks like I should mess with a few more Ruby tutorials.
[2012-03-29 16:16:24 -0400] HasanB: thanks for your time.
[2012-03-29 16:16:44 -0400] ashb: no worries
[2012-03-29 16:35:55 -0400] HasanB: ashb:  I just noticed a line   ==   require  'chef/util/file_edit'     When chef-client executes a recipe, where would it go to pick up that dependency?
[2012-03-29 16:36:15 -0400] ashb: that will be required waaay before chef starts executing a receipt
[2012-03-29 16:36:17 -0400] ashb: e
[2012-03-29 16:38:27 -0400] HasanB: I'd like to see the code, but I do not know where to look for it.
[2012-03-29 16:38:50 -0400] bakins: installed via gems?
[2012-03-29 16:40:03 -0400] ashb: github.com/opscopde/chef/
[2012-03-29 16:40:37 -0400] HasanB: nothing like a global search when all else fails :
[2012-03-29 16:40:47 -0400] HasanB: "/usr/lib/ruby/vendor_ruby/chef/util/file_edit.rb"
[2012-03-29 16:42:21 -0400] HasanB: "github.com/opscopde/chef/"   I tried there.  Couldn't find it.
[2012-03-29 16:42:43 -0400] HasanB: but I think I'm back on the trail of what I need.
[2012-03-29 16:42:48 -0400] HasanB: thank you!
[2012-03-29 16:46:02 -0400] ashb: HasanB: https://github.com/opscode/chef/tree/master/chef/lib/chef
[2012-03-29 16:53:26 -0400] josephholsten: someday we're going to need a policy for changing maintainers of cookbooks in community.opscode.com
[2012-03-29 16:53:56 -0400] miketheman: josephholsten: democratically?
[2012-03-29 16:53:56 -0400] jtimberman: josephholsten: how so
[2012-03-29 16:57:17 -0400] josephholsten: we already have abandoned packages
[2012-03-29 16:58:16 -0400] josephholsten: for example, hudson
[2012-03-29 16:59:19 -0400] josephholsten: miketheman: or autocratically, so long as there is a way
[2012-03-29 17:02:50 -0400] pserraxforty: Can anyone direct me to where I can learn to setup my knife.rb config? I'm having trouble understanding where things go.
[2012-03-29 17:07:11 -0400] zts: josephholsten: miketheman: CPAN's policy/process for that seems to work well enough
[2012-03-29 17:07:45 -0400] zts: http://www.cpan.org/misc/cpan-faq.html#How_adopt_module
[2012-03-29 17:08:28 -0400] zts: but that issue is rooted in having a flat namespace for cookbooks
[2012-03-29 17:09:20 -0400] josephholsten: sounds good. it's either that or a debian-like system that's more curated.
[2012-03-29 17:12:51 -0400] aslan: hi guys ... This is one of my oldest bugs. The recipe sets up a rails app using passenger and apache. For some reason around 50% of the time at the first run the apache fails but on the next run it starts fine. So every time I start a server its kinda expected the server is not going to be ready for the next 30 min (my chef client intervals). As you can see at line 3793 there is a successful restart, then again at 3810 there is a successful reload and again at 383
[2012-03-29 17:12:52 -0400] aslan: there is a successful restart until it fails at the last restart which is 3846. The recipe is not fully broken because it works fine a lot of times. But on the other hand it also fails a lot of times. Any help is appreciated. https://gist.github.com/2231317
[2012-03-29 17:14:08 -0400] afallows: sampikesley: I wish I could just roll back to 1.9.2, but all of my employer's code is built to 1.9.3. I could try setting something up so that chef uses 1.9.2 and another user uses 1.9.2, but I would rather avoid that if possible.
[2012-03-29 17:36:05 -0400] vhyza: Hello, we just experienced issue http://tickets.opscode.com/browse/CHEF-3011 Please, is there some workaround for it?
[2012-03-29 17:37:25 -0400] ashb: wait. so you can do a delayed notifies, but not a delayed subscribes?
[2012-03-29 17:37:58 -0400] ashb: :(
[2012-03-29 17:49:39 -0400] hoover_damm: :(
[2012-03-29 17:49:40 -0400] hoover_damm: indeed
[2012-03-29 17:50:34 -0400] flu-: Is it possible to manually run the template engine on a *.erb template? Say for testing a particularly complex template file?
[2012-03-29 17:50:48 -0400] flu-: I suspect that maybe shef would be able to do that
[2012-03-29 17:51:30 -0400] flu-: I'm partially away, please prefix responses with my nick. Thanks! :)
[2012-03-29 17:59:56 -0400] flu-: Ah, I see chef is using Erubis under the hood. I could probably just fire that up
[2012-03-29 18:20:37 -0400] AntonZ: Hey folks, is there a good way to backup EBS volumes, manage backups/restores? perhaps with a web interface something ?>
[2012-03-29 18:24:07 -0400] miketheman: AntonZ: that seems a bit beyond the scope of chef, and rather something for the AWS Web console.
[2012-03-29 18:24:41 -0400] hoover_damm: erb -x | ruby -c template
[2012-03-29 18:24:48 -0400] hoover_damm: from that you can use your imagination
[2012-03-29 18:25:07 -0400] hoover_damm: ^^ flu-
[2012-03-29 18:25:49 -0400] AntonZ: i searched for opscode cookbooks and there are some backup solutions, but nothing really i hoped for... do people not backup their data :) ?
[2012-03-29 18:26:36 -0400] miah: all of my data is in a database. everything else is in git.
[2012-03-29 18:26:51 -0400] miah: the other bits (logs and what not) are certainly not getting written to tape
[2012-03-29 18:28:25 -0400] AntonZ: and database is on RDS ?
[2012-03-29 18:28:41 -0400] miah: fuckno. multiple replication slaves
[2012-03-29 18:28:57 -0400] aslan: hi guys ... This is one of my oldest bugs. The recipe sets up a rails app using passenger and apache. For some reason around 50% of the time at the first run the apache fails but on the next run it starts fine. So every time I start a server its kinda expected the server is not going to be ready for the next 30 min (my chef client intervals). As you can see at line 3793 there is a successful restart, then again at 3810 there is a successful reload and again at 383
[2012-03-29 18:28:58 -0400] aslan: there is a successful restart until it fails at the last restart which is 3846. The recipe is not fully broken because it works fine a lot of times. But on the other hand it also fails a lot of times. Any help is appreciated. https://gist.github.com/2231317
[2012-03-29 18:29:24 -0400] doomviking: why would "knife cookbook show $cookbook" have versions, but chef-client on the node complain that $cookbook has no versions
[2012-03-29 18:29:42 -0400] miah: doomviking: environment version pinning?
[2012-03-29 18:30:07 -0400] doomviking: miah: nothing in the role file to indicate that
[2012-03-29 18:30:17 -0400] miah: i didnt say role, i said environment
[2012-03-29 18:30:49 -0400] doomviking: miah: ah. right. precisely. thank you.
[2012-03-29 18:30:54 -0400] doomviking: that is it.
[2012-03-29 18:30:59 -0400] miah: yay =)
[2012-03-29 18:32:02 -0400] geekbri: How would one check to see if you were a certain role inside of a recipe?
[2012-03-29 18:33:34 -0400] miah: node['roles'].include?("myroleisawesome")
[2012-03-29 18:33:53 -0400] geekbri: miah: thanks, exactly what I was looking for
[2012-03-29 18:35:56 -0400] geekbri: miah: any clue if you can pass multiple arguments? EG node['roles'].include?("myroleisawesome","myotherroleisnotsoawesome")
[2012-03-29 18:36:18 -0400] miah: i think there is a better way to do this
[2012-03-29 18:36:26 -0400] miah: i can't recall at the moment and my brain is elsewhere
[2012-03-29 18:37:21 -0400] afallows: Worst case, ["role_one","role_two"].each do |role| node['roles'].include?(role) end
[2012-03-29 18:38:18 -0400] afallows: Obviously you'd need to add more to make it actually do something about the result of each.
[2012-03-29 18:38:22 -0400] geekbri: yeah thats what I was doing.  Was just checking to see if I could shorten it
[2012-03-29 18:38:48 -0400] miah: node[:roles].each do |i|
[2012-03-29 18:39:33 -0400] miah: then follow up with a case statement maybe?
[2012-03-29 18:39:38 -0400] miah: i'm still a newb programmer :P
[2012-03-29 18:39:45 -0400] geekbri: im actually doing an assignment so  cluster_node = node['roles'].include?("role1") || node['roles'].include?("role2")
[2012-03-29 18:39:59 -0400] jws: has anyone had their chef-clients start sending null ipaddress attributes back to chef-server?
[2012-03-29 18:49:07 -0400] paulmooring: jws: is this on Windows?
[2012-03-29 19:10:55 -0400] aslan: coderanger: holoway kallistec : hi guys ... This is one of my oldest bugs. The recipe sets up a rails app using passenger and apache. For some reason around 50% of the time at the first run the apache fails but on the next run it starts fine. So every time I start a server its kinda expected the server is not going to be ready for the next 30 min (my chef client intervals). As you can see at line 3793 there is a successful restart, then again at 3810 there is a
[2012-03-29 19:10:55 -0400] aslan: successful reload and again at 3832 there is a successful restart until it fails at the last restart which is 3846. The recipe is not fully broken because it works fine a lot of times. But on the other hand it also fails a lot of times. Any help is appreciated. https://gist.github.com/2231317 ... it almost looks like a bug
[2012-03-29 19:12:25 -0400] coderanger: aslan: Just make your init script wait longer when restarting it
[2012-03-29 19:12:41 -0400] aslan: coderanger: how do i do that?
[2012-03-29 19:12:47 -0400] Mithrandir: init scripts shouldn't return until the service is ready.
[2012-03-29 19:13:19 -0400] coderanger: In this case, it shouldn't start it again until the old copy is fully shut down and hte ports are available again
[2012-03-29 19:15:23 -0400] aslan: coderanger: Mithrandir can you guys elaborate a little bit
[2012-03-29 19:15:50 -0400] coderanger: aslan: Grab the init script, copy it into your apache cookbook as a cookbook_file, add a sleep 5 or something between the stop and start
[2012-03-29 19:15:53 -0400] coderanger: Nothing too fancy
[2012-03-29 19:15:57 -0400] coderanger: Or, if you don't want to do that
[2012-03-29 19:16:11 -0400] coderanger: look at the service definition for apache in your cookbook
[2012-03-29 19:16:23 -0400] aslan: my thinking was that when we use the default setting :delayed in case of a restart or reload it should combine the similar ones into one so we dont keep restarting apache over and over again
[2012-03-29 19:16:31 -0400] coderanger: and change the start command to something like "service apache2 stop && sleep 10 && service apache2 start"
[2012-03-29 19:16:49 -0400] coderanger: aslan: The problem isn't related to chef that I can see
[2012-03-29 19:16:53 -0400] coderanger: just a normal Unix-ism
[2012-03-29 19:17:29 -0400] aslan: coderanger: so  why 3 restarts go successfully but sometimes it brakes at the forth one
[2012-03-29 19:17:35 -0400] coderanger: if you stop and start a service in rapid succession (particularly if it is busy starting up from a recent reload or restart) it will sometimes try to bind ports still held by the shutting down instance
[2012-03-29 19:17:50 -0400] coderanger: which is exactly what the error says
[2012-03-29 19:17:59 -0400] aslan: coderanger: ah... that makes sense
[2012-03-29 19:18:24 -0400] aslan: coderanger: what is directive :delayed jobs here?
[2012-03-29 19:18:39 -0400] coderanger: That is just about scheduling notifications within the chef run
[2012-03-29 19:18:48 -0400] coderanger: delayed notifications are debounced and run all at the end of the convergence
[2012-03-29 19:19:19 -0400] aslan: coderanger: is there a way to combine all the apache restarts into one ?
[2012-03-29 19:19:29 -0400] coderanger: That is what "debounced" means :)
[2012-03-29 19:19:51 -0400] aslan: coderanger: but then if thats the case why i end up with 4 apache restart calls ?
[2012-03-29 19:20:06 -0400] aslan: coderanger: shouldn't there be only one?
[2012-03-29 19:20:28 -0400] miah: does it actually restart it 4 times, or do you just see 4 delayed apache restarts in your logs?
[2012-03-29 19:21:03 -0400] aslan: miah: coderanger look at the log at lines i indicated earlier : "you can see at line 3793 there is a successful restart, then again at 3810 there is a successful reload and again at 3832 there is a successful restart until it fails at the last restart which is 3846"
[2012-03-29 19:21:42 -0400] aslan: miah: coderanger : this is the log : https://gist.github.com/2231317
[2012-03-29 19:22:46 -0400] coderanger: reload != restart
[2012-03-29 19:23:21 -0400] coderanger: reload is a HUP to apache, reloads the config file without shutting down the master proc or the mpm
[2012-03-29 19:23:40 -0400] coderanger: downside is there are a few things it can't change on the fly, I think ports is one of them
[2012-03-29 19:24:11 -0400] miah: [Tue, 06 Mar 2012 17:16:23 -0800] DEBUG: STDERR: [Tue Mar 06 17:16:09 2012] [warn] NameVirtualHost *:443 has no VirtualHosts
[2012-03-29 19:24:15 -0400] miah: ^- fix that?
[2012-03-29 19:24:19 -0400] aslan: coderanger: there is one reload but the rest are restarts
[2012-03-29 19:24:46 -0400] miah: also. you should do check-config before sending it to reload/restart
[2012-03-29 19:25:10 -0400] miah: 'httpd -t' iirc
[2012-03-29 19:25:26 -0400] aslan: miah: i am going to fix the 443 issue too... i just wanted to get the main issue fixed first
[2012-03-29 19:26:05 -0400] aslan: miah: good idea... I will add the check-config . thanks
[2012-03-29 19:26:06 -0400] miah: well, i suspect if your config is bad, the first restart will fail to restart. then because its not actually running it kinda falls into this loop of doom
[2012-03-29 19:26:45 -0400] miah: i usually build a simple execute resource that does the config verification and have it notify the service to restart/relod
[2012-03-29 19:26:59 -0400] aslan: miah: its not broken. it fails about 40-50% of the times on the first run. on the subsequent runs its always successful
[2012-03-29 19:27:09 -0400] miah: sounds like you are not idempotent
[2012-03-29 19:27:55 -0400] miah: if it takes a second run then something is missing from your cookbook
[2012-03-29 19:28:16 -0400] aslan: miah: not all the time. a lot times the first run is successful
[2012-03-29 19:28:47 -0400] miah: what i said still applies. unless its 100% then you've got something wrong
[2012-03-29 19:28:57 -0400] |shad0w|: reload != graceful in apachectl
[2012-03-29 19:29:07 -0400] |shad0w|: it will kill children without letting them finish
[2012-03-29 19:29:21 -0400] aslan: miah: i think coderanger was right : coderanger: if you stop and start a service in rapid succession (particularly if it is busy starting up from a recent reload or restart) it will sometimes try to bind ports still held by the shutting down instanc
[2012-03-29 19:29:59 -0400] miah: why would you be restarting it multiple times though, if its all debounced
[2012-03-29 19:30:09 -0400] miah: somewhere in your cookbook there is a bad logics
[2012-03-29 19:30:30 -0400] coderanger: Or a bug in Chef, never rule that out :)
[2012-03-29 19:31:10 -0400] aslan: i remember that two of them have to do with adding apache mods ... the recipe i got from opscode i think has that in its logic
[2012-03-29 19:31:22 -0400] aslan: so every time a new mod is enabled it sends a restart to apache service
[2012-03-29 19:31:30 -0400] miah: sure it could be a bug
[2012-03-29 19:31:56 -0400] aslan: one of them should have to do with installation and i think the reload has to do with the actual rails app
[2012-03-29 19:31:56 -0400] miah: does it send it immediately or delayed? i'd assume its delayed
[2012-03-29 19:32:10 -0400] aslan: miah: they are all delayed
[2012-03-29 19:32:17 -0400] miah: then that shouldn't be a issue
[2012-03-29 19:32:59 -0400] aslan: miah: i thought that is the default .. no place in my recipe i use :immediately
[2012-03-29 19:33:12 -0400] coderanger: That is the default for notifications
[2012-03-29 19:33:34 -0400] miah: i feel like this is telling too
[2012-03-29 19:33:34 -0400] miah: [Tue, 06 Mar 2012 17:16:09 -0800] DEBUG: service[apache2]: falling back to process table inspection
[2012-03-29 19:33:49 -0400] aslan: coderanger: so should i add the :delayed ?
[2012-03-29 19:33:56 -0400] miah: is your initscript mangling your pid file?
[2012-03-29 19:34:20 -0400] aslan: i am using the apache out of the box init script
[2012-03-29 19:34:25 -0400] aslan: i assume it should
[2012-03-29 19:34:35 -0400] miah: you know what they say about assumptions
[2012-03-29 19:34:48 -0400] miah: read code, know what it does =)
[2012-03-29 19:35:38 -0400] miah: so first, fix that namevirtualserver issue
[2012-03-29 19:35:41 -0400] aslan: i will do that. what worries me is at then i am still getting couple of restarts and reloads and they are not debounced as they should be
[2012-03-29 19:35:42 -0400] miah: and lets see the logs after that
[2012-03-29 19:36:11 -0400] miah: i suspect restart / reload don't debounce. probaby still end up with a restart and a reload but i could be wrong.
[2012-03-29 19:36:33 -0400] miah: everything fails _after_ [Tue, 06 Mar 2012 17:16:09 -0800] DEBUG: STDERR: [Tue Mar 06 17:16:09 2012] [warn] NameVirtualHost *:443 has no VirtualHosts
[2012-03-29 19:36:40 -0400] miah: so fix that first, lets see the logs afterwards
[2012-03-29 19:36:54 -0400] aslan: miah: coderanger sugested a 5s sleep... i think i will go with the for a quick fix and then start debugging more in depth
[2012-03-29 19:37:11 -0400] miah: using a sleep is like using puts to debug code =)
[2012-03-29 19:37:36 -0400] matthewvermaak: hey, i like using puts / raise to debug :0)
[2012-03-29 19:38:03 -0400] miah: i personally would fix the obvious errors and then resume debugging rather than implementing a workaround that leaves known issues
[2012-03-29 19:41:14 -0400] karmi: btm: Do you think the Amazon Linux segmentation issues will be solved (http://tickets.opscode.com/browse/CHEF-3011)?
[2012-03-29 19:45:50 -0400] paulmooring: @karmi if that's the same as the segfaults in CentOS then it can usually be prevented by using the full stack Chef installer
[2012-03-29 19:46:31 -0400] karmi: paulmooring: what's "full stack Chef installer"?
[2012-03-29 19:46:38 -0400] miah: chef-omnibus!
[2012-03-29 19:46:45 -0400] paulmooring: ^
[2012-03-29 19:46:53 -0400] paulmooring: http://www.opscode.com/chef/install
[2012-03-29 19:47:21 -0400] paulmooring: it installs it's own ruby and friends along with Chef under /opt
[2012-03-29 19:49:48 -0400] karmi: paulmooring: dunno, http://s3.amazonaws.com/opscode-full-stack/install.sh? we have a simple bootstrap script, we can't change the basic bootstrapping process right now..
[2012-03-29 19:50:36 -0400] paulmooring: karmi: is it doing some special stuff or would any bootstrap work?
[2012-03-29 19:51:18 -0400] karmi: paulmooring: nothing special, just installing the gem, content for client.rb, etc
[2012-03-29 19:52:54 -0400] karmi: paulmooring: but yeah, I need some knife configs in `client.rb` and we have lots of other problems then to fiddle with changing the process :/ it's something broken with Ruby at Amazon Linux it seems.
[2012-03-29 19:53:44 -0400] paulmooring: karmi: https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/chef-full.erb there's a bootstrap script for omnibus Chef
[2012-03-29 19:54:08 -0400] karmi: paulmooring: yes, that's what we based our bootstrap on
[2012-03-29 19:54:17 -0400] paulmooring: ah gotcha
[2012-03-29 19:55:58 -0400] paulmooring: I would hope Amazon would get it fixed soon anyway, but for now the best we can do is recommend the omnibus installer or install Ruby/RubyGems from some other source
[2012-03-29 19:57:36 -0400] karmi: paulmooring: thanks...
[2012-03-29 20:05:08 -0400] hoover_damm: amazon linux is a beta, and be sure to file a ticket with amazon
[2012-03-29 20:05:18 -0400] hoover_damm: not sure how well they support it
[2012-03-29 20:28:33 -0400] erikh: anyone interested in commenting on something I"m working on that aggregates chef failures/resource runs? http://home.hollensbe.org
[2012-03-29 20:28:51 -0400] erikh: it's just working with seed data atm, but the publish endpoint works as well
[2012-03-29 20:29:58 -0400] flu-: How does the templating engine (Erubis) know about the 'node' variable?
[2012-03-29 20:30:13 -0400] flu-: I'm looking at the code that invokes it, and it seems a bit mysterious to me that node is in scope, yet not an instance var
[2012-03-29 20:31:58 -0400] wamcvey: flu: I'm fairly new to chef, but in all my recipes, I explicitly pass the variables to be expanded in the template from the recipe (which has access to node)
[2012-03-29 20:33:08 -0400] flu-: wamcvey: That is a best practices I'm codifing today, but we certainly have a lot of legacy templates that dig into node explicitly
[2012-03-29 20:33:32 -0400] flu-: which makes testing the templates in Erubis on their own difficult
[2012-03-29 20:34:24 -0400] flu-: looks like 'bindings' can make the context passed in turn into local variables, but chef isn't using bindings :/
[2012-03-29 20:40:07 -0400] pcn: flu- the node data is in scope because I believe it's just global to the running ruby environment
[2012-03-29 20:40:25 -0400] pcn: Or are you asking specifically how that's done?
[2012-03-29 20:46:28 -0400] flu-: pcn: Well, it's not $node, so I'm not sure how it's global :/
[2012-03-29 20:46:59 -0400] corp: flu, i beliee it is passed in context
[2012-03-29 20:47:36 -0400] flu-: corp: In Erubis, things passed in to the context are all referred to with instance var notation (i.e., @foo)
[2012-03-29 20:48:07 -0400] flu-: the point of this questioning is to figure out how I can build a context that will work with a template that uses the node[:something][:somethingElse] notation
[2012-03-29 20:48:22 -0400] corp: flu-: if you call node, it just returns @node
[2012-03-29 20:48:26 -0400] flu-: I agree that the real solution is to not dig into node directly in templates, but I have a lot of legacy stuff that does that
[2012-03-29 20:48:32 -0400] corp: flu-: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/template.rb#L95
[2012-03-29 20:48:46 -0400] flu-: nice!
[2012-03-29 20:48:54 -0400] flu-: corp: good find, thanks :)
[2012-03-29 20:50:16 -0400] corp: flu-: https://github.com/opscode/chef/blob/master/chef/lib/chef/mixin/template.rb#L27
[2012-03-29 20:51:03 -0400] corp: i dont think it's bad to use node directly in templates
[2012-03-29 20:51:13 -0400] flu-: perfect. Now I can continue to deny the existence of magic
[2012-03-29 20:57:52 -0400] holoway: corp: me neither - I do it all the time
[2012-03-29 20:58:00 -0400] holoway: corp: feels like a lot of ceremony to shadow everything
[2012-03-29 20:58:29 -0400] corp: i only pass stuff in when using ruby enumerators to generate more than one template
[2012-03-29 20:59:15 -0400] holoway: erikh: I think it looks neat
[2012-03-29 20:59:56 -0400] erikh: thanks!
[2012-03-29 21:02:48 -0400] btm: karmi: I've rarely seen upstream distributions fix issues in their Ruby. The only time I have is when I identified the segfault cause, found a patch from upstream Ruby, and worked up the patch in a debian format and handed it to canonical.
[2012-03-29 21:03:24 -0400] btm: karmi: You really want to find a better source for Ruby. As recommended, our Omnibus install of Chef comes with a stable Ruby built into it.
[2012-03-29 21:05:49 -0400] karmi: btm: thanks.. we've been happy with Amazon Linux, since it came with 1.8 already there, we'll installing 1.9 for our app via rbenv. 1.8 was the "default" for Chef...
[2012-03-29 21:11:03 -0400] btm: karmi: I don't mean that you should switch from Amazon Linux, but that you should find a newer Ruby for it, or at least for Chef.
[2012-03-29 21:13:12 -0400] karmi: btm: but what are the options, building Ruby from scratch on the machine is crazy, will look into the omnibus installer then...
[2012-03-29 21:13:50 -0400] jinnko: fwiw i have successfully run chef on clients within rbenv
[2012-03-29 21:14:07 -0400] erratic: just out of curiousity has anybody worked on like an advanced interface webui as a replacement to the one that comes with chef?
[2012-03-29 21:14:13 -0400] jinnko: i have a bootstrap script for centos, but should be easily adaptable
[2012-03-29 21:15:33 -0400] spyvsspy: erratic, I am
[2012-03-29 21:15:41 -0400] spyvsspy: (currently working on one)
[2012-03-29 21:16:30 -0400] spyvsspy: I am also creating a SaaS, to setup the appropos recipes/databags for a server
[2012-03-29 21:16:39 -0400] btm: karmi: RBEL + Aegis Repos have other RPMs http://wiki.opscode.com/display/chef/Installing+Ruby+and+dependencies+on+CentOS+and+Others
[2012-03-29 21:16:45 -0400] btm: karmi: there may be other RPM resources.
[2012-03-29 21:16:57 -0400] btm: karmi: but using the Omnibus installer for Chef is /easy/ and /works/
[2012-03-29 21:16:59 -0400] spyvsspy: ie "Click a button to setup a new server"....walks you through entering the ip/hostname/et al information
[2012-03-29 21:17:13 -0400] spyvsspy: nad based on the host name etc, it will setup the machine upon first checkin
[2012-03-29 21:18:46 -0400] karmi: btm: Yes, I see what you mean. We have some additional configs for `client.rb` in bootstrap script, but these can go easily go to recipe.
[2012-03-29 21:19:35 -0400] pcn: karmi build your own AMI.  I can provide you with the scripts I use to get it done.  Some of the stuff is specific to ubuntu, but it's the way to go
[2012-03-29 21:21:45 -0400] karmi: pcn: We've been staying away from building custom images...
[2012-03-29 21:24:42 -0400] schuckles: Hi
[2012-03-29 21:25:19 -0400] schuckles: I'm wondering if there's an easy way that i can review a dependency after a failed chef run?
[2012-03-29 21:29:33 -0400] jinnko: karmi, btm: here's the bootstrap incase it'll be of any use http://jinntech.blogspot.co.uk/2012/03/opscode-chef-client-within-rbenv.html
[2012-03-29 21:31:27 -0400] karmi: jinnko: Thanks!, however, building Ruby from scratch on node bootstrap is something I'd like to skip Takes very long time.
[2012-03-29 21:31:40 -0400] btm: yeah, I'd generally recommend against mainitaining a custom image like an AMI. You should be able to everything you need with Chef in most cases.
[2012-03-29 21:31:51 -0400] miah: jinnko: nice. =)
[2012-03-29 21:31:55 -0400] btm: karmi: you can certainly download the chef-full bootstrap, merge your custom stuff into it and rename it.
[2012-03-29 21:31:56 -0400] pcn: karmi we were too, but it's actually a huge benefit.
[2012-03-29 21:32:13 -0400] pcn: it's the speed
[2012-03-29 21:32:31 -0400] jinnko: karmi: true, but it was the most reliable approach at the time, and tends to take under 10 mins
[2012-03-29 21:32:59 -0400] karmi: btm: Exactly our thinking. We can switch to another distro just by "flipping a switch". Vanilla OS with SSH should be enough.
[2012-03-29 21:33:30 -0400] karmi: btm: yes, probably will use the full bootstrap, and put the custom configs in recipe
[2012-03-29 21:33:50 -0400] karmi: btm: we based it on the bootstrap script, but I remember it was a bit shorter :)
[2012-03-29 21:37:10 -0400] cwj: anyone else having problems creating repositories on github today? i click 'create repository' and nothing happens
[2012-03-29 21:39:04 -0400] karmi: btm: The problem is, I wrote a tutorial http://www.elasticsearch.org/tutorials/2012/03/21/deploying-elasticsearch-with-chef-solo.html *days*ago, specifically using Amazon Linux since it has everything (Ruby, Java), and now it's broken, and people write "halp
[2012-03-29 21:39:15 -0400] karmi: segfaults!" :)
[2012-03-29 21:40:22 -0400] senthilr: karmi: nice doc though
[2012-03-29 21:40:25 -0400] senthilr: very detailed
[2012-03-29 21:40:55 -0400] karmi: senthilr: thanks, yes, it took some time :)
[2012-03-29 21:41:15 -0400] senthilr: Install elasticsearch is in my todo list
[2012-03-29 21:41:18 -0400] senthilr: thanks for your link
[2012-03-29 21:41:51 -0400] spyvsspy: cwj, I am
[2012-03-29 21:41:54 -0400] spyvsspy: "Repository under migration.
[2012-03-29 21:41:54 -0400] spyvsspy: The route for your user could not be found. Usually this means that your repositories are being migrated to a new storage server to better serve you. Your repository should be available again very soon"
[2012-03-29 21:42:06 -0400] cwj: spyvsspy: weird i dont even get that message
[2012-03-29 21:42:40 -0400] cwj: the button dims like it is taking action but i never get taken to a new screen
[2012-03-29 21:42:48 -0400] cwj: and the repo isn't added
[2012-03-29 21:44:22 -0400] spyvsspy: huh weird
[2012-03-29 22:35:34 -0400] sivy: hello all; is there a way to loop over the files in a particular cookbook's /files directory and call cookbook_file for each one?
[2012-03-29 22:35:48 -0400] sivy: (or a subset based on directory)
[2012-03-29 22:37:16 -0400] paulmooring: sivy: there's a directory resource that might be what you're looking for
[2012-03-29 22:37:24 -0400] paulmooring: http://wiki.opscode.com/display/chef/Resources#Resources-Directory
[2012-03-29 22:38:12 -0400] sivy: paulmooring: not really; I need a way to refer to the cookbooks' files dir in a .feach loop
[2012-03-29 22:38:27 -0400] sivy: i mean a [].each loop
[2012-03-29 22:38:28 -0400] bdha: https://gist.github.com/2244449 # Is what I do.
[2012-03-29 22:38:38 -0400] bdha: sivy: ^--
[2012-03-29 22:38:47 -0400] sivy: bdha: yeah, that's what i started with
[2012-03-29 22:38:56 -0400] bdha: I don't know if there's anything better.
[2012-03-29 22:38:57 -0400] sivy: amd ay still end up there
[2012-03-29 22:38:58 -0400] sivy: ok
[2012-03-29 22:41:25 -0400] paulmooring: sivy: Be warned the File resource is not intended for uses moving large numbers of files, using git/rsync/some other alternative is usually better
[2012-03-29 22:41:42 -0400] sivy: paulmooring: thanks: this is only 10 files
[2012-03-29 22:42:05 -0400] sivy: not incredible efficient, but not too bad
[2012-03-29 22:42:21 -0400] paulmooring: for 10 files you're probably fine
[2012-03-29 22:42:43 -0400] paulmooring: but if you're looking at GBs of data it gets frustrating
[2012-03-29 22:42:48 -0400] sivy: sure
[2012-03-29 22:53:50 -0400] bendrix415: question regarding remote_file over http, does it automatically do a checksum before downloading the file
[2012-03-29 23:06:06 -0400] paulmooring: bendrix415: remote_file is deprecated you should use cookbook_file instead
[2012-03-29 23:06:09 -0400] paulmooring: and yes it does
[2012-03-29 23:09:37 -0400] sivy: bdha: hm. i think i've messed up my cookbook_file resource, I'm getting weird errors about files/ubuntu/<path> not existing...
[2012-03-29 23:09:38 -0400] sivy: https://gist.github.com/2244764
[2012-03-29 23:09:51 -0400] bendrix415: i thought remote_file was deprecated but only for certain things
[2012-03-29 23:10:35 -0400] paulmooring: bendrix415: that's correct it's deprecated for transfering files in a recipe from the server to the node
[2012-03-29 23:10:42 -0400] paulmooring: is that not what you were asking about?
[2012-03-29 23:11:02 -0400] bendrix415: no, im downloaded a file from a http server for deployment
[2012-03-29 23:11:14 -0400] bendrix415: can't use scm for this
[2012-03-29 23:11:30 -0400] paulmooring: oh, and you have a checksum for the file or no?
[2012-03-29 23:11:43 -0400] bendrix415: no
[2012-03-29 23:12:02 -0400] bendrix415: but looking at the debug messages  it seems it does download first
[2012-03-29 23:12:30 -0400] paulmooring: it doesn't download to the Chef server at all
[2012-03-29 23:12:37 -0400] berngp: bendrix415: you have to provide the checksum
[2012-03-29 23:12:39 -0400] berngp: https://github.com/ign/chef-cookbooks/blob/master/ign-tomcat/definitions/default_resolver.rb
[2012-03-29 23:12:39 -0400] bendrix415: no this is chef-solo
[2012-03-29 23:12:44 -0400] paulmooring: so unless you provide a checksum it won't
[2012-03-29 23:13:02 -0400] paulmooring: a checksum wouldn't be of any benefit on only 1 side
[2012-03-29 23:13:26 -0400] berngp: the thing is that you need to have the checksum prior downloading the file
[2012-03-29 23:14:28 -0400] berngp: i.e. I haven't figured out how to get the checksum from variable which value is unknown until i run the recipe
[2012-03-29 23:15:51 -0400] jodell_: this might be a silly question but what is the 'right way' to initiate an explicit chef-client run on all nodes? (a la from a jenkins job)
[2012-03-29 23:16:03 -0400] bendrix415: im trying to prevent a chef-solo run from downloading the entire file from scratch again as it could be big
[2012-03-29 23:16:31 -0400] berngp: it wont
[2012-03-29 23:16:41 -0400] berngp: if it already did it won't download it again
[2012-03-29 23:17:27 -0400] paulmooring: bendrix415: if the server doesn't already know the checksum it has nothing to compare it to but use the action :create_if_missing to only d/l once
[2012-03-29 23:17:51 -0400] paulmooring: obviously that means you can't get updates if the server changes, unless you delete the file
[2012-03-29 23:17:54 -0400] bendrix415: right
[2012-03-29 23:18:13 -0400] berngp: ( exactly what i need to figure out too :) )
[2012-03-29 23:18:15 -0400] bendrix415: DEBUG: Sending HTTP Request via GET to 192.168.122.1:80/chef-repo/myapp-1.tar.gz
[2012-03-29 23:18:17 -0400] bendrix415: DEBUG: Streaming download from http://192.168.122.1/chef-repo/myapp-1.tar.gz to tempfile /tmp/chef-rest20120329-7219-1afq765-0
[2012-03-29 23:18:18 -0400] bendrix415: DEBUG: remote_file[/var/chef/releases/myapp-1.tar.gz] checking for file existence of /var/chef/releases/myapp-1.tar.gz
[2012-03-29 23:18:20 -0400] bendrix415: DEBUG: remote_file[/var/chef/releases/myapp-1.tar.gz] file exists at /var/chef/releases/myapp-1.tar.gz
[2012-03-29 23:18:21 -0400] bendrix415: DEBUG: remote_file[/var/chef/releases/myapp-1.tar.gz] target checksum: 40f397c4e18c7cf2fc474e40a3bb70350d0538df1a3449228bbafb89784ecdd0
[2012-03-29 23:18:23 -0400] bendrix415: DEBUG: remote_file[/var/chef/releases/myapp-1.tar.gz] source checksum: 40f397c4e18c7cf2fc474e40a3bb70350d0538df1a3449228bbafb89784ecdd0
[2012-03-29 23:18:24 -0400] bendrix415: DEBUG: remote_file[/var/chef/releases/myapp-1.tar.gz] target and source checksums are the same - not updating
[2012-03-29 23:18:46 -0400] berngp: use action  :create_if_missing
[2012-03-29 23:18:56 -0400] paulmooring: bendrix415: please use a pastebin service for multi-line copy and pasting
[2012-03-29 23:19:18 -0400] bendrix415: roger
[2012-03-29 23:19:33 -0400] berngp: then you will have to do a HTTP HEAD on the file to see when it was last updated and compare with the FS date
[2012-03-29 23:20:29 -0400] paulmooring: the default behavior is 'action :create' which always downloads the file to a temp dir, then does a checksum to see if it matches the version on disk
[2012-03-29 23:20:45 -0400] paulmooring: does that answer your question?
[2012-03-29 23:21:44 -0400] bendrix415: but if the file changes but has the same name how would the create_if_missing work
[2012-03-29 23:22:20 -0400] paulmooring: create_if_missing checks if a file with that name exists already, if it does nothing is downloaded
[2012-03-29 23:22:42 -0400] paulmooring: so no updates ever for create_if_missing
[2012-03-29 23:23:38 -0400] bendrix415: hmm, so then I would have to download the file each time to tell iff there is any difference using the builtin checksum with create
[2012-03-29 23:24:02 -0400] paulmooring: yeah, it's not really intended for transfer large amounts of data
[2012-03-29 23:24:26 -0400] paulmooring: we recommend either rsync or a dpeloy resource for something more intelligent
[2012-03-29 23:24:57 -0400] berngp: you can also store the date value given by http_request HEAD
[2012-03-29 23:25:25 -0400] bendrix415: thats what im affraid of but the rsync command would work in a bash resource i guess
[2012-03-29 23:28:16 -0400] paulmooring: bendrix415: right, there's an execute resource, if you have ssh for rsync than you might also consider git
[2012-03-29 23:30:28 -0400] bendrix415: yes, espcailly for 300 servers
[2012-03-29 23:40:45 -0400] bendrix415: thanks paul, i will have to rethink the approach
[2012-03-29 23:45:24 -0400] LawrenceSeattle: how do you coordinate cross machine config changes?  I want to open up a firewall hole for a new host
