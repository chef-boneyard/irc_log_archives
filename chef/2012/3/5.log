[2012-03-05 08:00:00 -0500] BryanWB: hmm, community.opscode.com not accessible either
[2012-03-05 08:00:00 -0500] silk: Do you split dns or is it all external to AWS?
[2012-03-05 08:00:00 -0500] silk: (ie do you eat Jeff's dogfood)
[2012-03-05 08:00:00 -0500] coderanger: All production systems are on our hardware
[2012-03-05 08:01:00 -0500] fujin: coderanger: thanks for responding. anything I can do to help?
[2012-03-05 08:01:00 -0500] silk: ok, so then Im guessing ther eis a routing issue
[2012-03-05 08:01:00 -0500] coderanger: We have some monitoring and staging stuffs in EC2, but nothing "real"
[2012-03-05 08:01:00 -0500] BryanWB: yup community.opscode.com not responding
[2012-03-05 08:01:00 -0500] fujin: community.opscode.com working from my adsl2/ipv6 tunnel here.
[2012-03-05 08:01:00 -0500] BryanWB: i am in europe, not sure if that is relevant
[2012-03-05 08:01:00 -0500] coderanger: Yeah, working for me
[2012-03-05 08:02:00 -0500] hmalphettes: silk, coderanger: can't reach the website and the wiki either from my office in singapore either.
[2012-03-05 08:02:00 -0500] fujin: Who watches the BGP sessions? =)
[2012-03-05 08:02:00 -0500] silk: coderanger, your studd is hosted @rackspace?
[2012-03-05 08:02:00 -0500] silk: stuff
[2012-03-05 08:02:00 -0500] BryanWB: coderanger: well, anyways, since I can't check at the moment, is there an rss feed for latest cookbook additions?
[2012-03-05 08:02:00 -0500] coderanger: silk: Yeah, rackspace colo
[2012-03-05 08:02:00 -0500] fujin: silk: yes, rackspace
[2012-03-05 08:02:00 -0500] silk: ok...
[2012-03-05 08:02:00 -0500] coderanger: BryanWB: Not that I know of, there is email notification though
[2012-03-05 08:02:00 -0500] silk: 10  xe-3-0-0.cr1.dca2.us.above.net (64.125.26.237)  2.360 ms  2.297 ms  2.233 ms
[2012-03-05 08:02:00 -0500] silk: 11  xe-2-2-0.cr1.lga5.us.above.net (64.125.26.98)  6.317 ms  6.183 ms  6.385 ms
[2012-03-05 08:02:00 -0500] silk: 12  xe-3-2-0.cr1.ord2.us.above.net (64.125.24.34)  32.125 ms  32.087 ms  32.064 ms
[2012-03-05 08:02:00 -0500] silk: 13  xe-1-1-0.er1.ord7.us.above.net (64.125.26.250)  31.614 ms  31.545 ms  31.563 ms
[2012-03-05 08:02:00 -0500] silk: 14  64.124.65.218.allocated.above.net (64.124.65.218)  25.482 ms  25.361 ms  25.405 ms
[2012-03-05 08:02:00 -0500] silk: 15  * * *
[2012-03-05 08:02:00 -0500] silk: 16  * * *
[2012-03-05 08:02:00 -0500] silk: 17  * * *
[2012-03-05 08:02:00 -0500] fujin: use gist
[2012-03-05 08:03:00 -0500] BryanWB: we are starting cookbook news segment for foodfightshow, rss feed would be very helpful
[2012-03-05 08:03:00 -0500] fujin: I have the report/5count from mtr incoming to a gist from my adsl2/ipv6 conn
[2012-03-05 08:03:00 -0500] BryanWB: coderanger: is the e-mail for any new cookbook that is added?
[2012-03-05 08:03:00 -0500] fujin: BryanWB: I know they are working on that, or had heard it was in the pipes
[2012-03-05 08:04:00 -0500] coderanger: BryanWB: Not technically, but follow opscode and jtimberman and you get 90% of them :)
[2012-03-05 08:04:00 -0500] fujin: Here's the report from my (working) connection to api.opscode.com: please confirm/compare: https://gist.github.com/66e3050e90864a7c29b1
[2012-03-05 08:04:00 -0500] fujin: note minor packet loss consistent with 10,000 km of travel =_=
[2012-03-05 08:04:00 -0500] silk: https://gist.github.com/1977373
[2012-03-05 08:04:00 -0500] coderanger: http://internetpulse.com/
[2012-03-05 08:04:00 -0500] fujin: ooh, thats' hawt
[2012-03-05 08:04:00 -0500] coderanger: Level3 to Cogent is fluttering it looks like
[2012-03-05 08:05:00 -0500] fujin: heh
[2012-03-05 08:05:00 -0500] fujin: coderanger: I go via layer3 :)
[2012-03-05 08:05:00 -0500] fujin: err level3
[2012-03-05 08:05:00 -0500] fujin: maybe not. misread
[2012-03-05 08:05:00 -0500] coderanger: Heh, I have no idea what that matters to our backbone providers at rackspace, but its a thing
[2012-03-05 08:05:00 -0500] BryanWB: ranjibd: here is cleaned up jira https://github.com/bryanwb/cookbooks/blob/master/jira/recipes/default.rb   , and remove tomcat's isntall of redhat-lsb
[2012-03-05 08:06:00 -0500] erikh: yeah, cloudkick is flipping out here
[2012-03-05 08:06:00 -0500] fujin: heh
[2012-03-05 08:06:00 -0500] erikh: somethign like 120 servers just paged me.
[2012-03-05 08:07:00 -0500] fujin: my machines on ec2 are paging like wild
[2012-03-05 08:07:00 -0500] fujin: temporarily silenced a bunch of sensu-servers
[2012-03-05 08:07:00 -0500] fujin: gist inc for MTR from AWS system
[2012-03-05 08:07:00 -0500] fujin: 100% packet loss
[2012-03-05 08:08:00 -0500] erikh: I'm getting a good link to linode
[2012-03-05 08:08:00 -0500] fujin: https://gist.github.com/1522a2a302c28bf526dc
[2012-03-05 08:08:00 -0500] erikh: so it's definitely not aws
[2012-03-05 08:08:00 -0500] fujin: looks like this aws system (it's VPC?) is going via above.net
[2012-03-05 08:08:00 -0500] fujin: and definitely going into la-la land
[2012-03-05 08:09:00 -0500] erikh: yeah. this is gonna make our standup tomorrow interesting
[2012-03-05 08:09:00 -0500] erikh: "how do we get rid of cloudkick"
[2012-03-05 08:09:00 -0500] fujin: heh
[2012-03-05 08:14:00 -0500] silk: appears back from here
[2012-03-05 08:14:00 -0500] fujin: oh?
[2012-03-05 08:15:00 -0500] fujin: indeed
[2012-03-05 08:15:00 -0500] fujin: AWS upstream routes have picked an alternate path
[2012-03-05 08:15:00 -0500] fujin: ah, isn't the Autonomous System neat?
[2012-03-05 08:15:00 -0500] fujin: BGP is soooo fucking cool when it works.
[2012-03-05 08:15:00 -0500] fujin: coderanger: ^^
[2012-03-05 08:15:00 -0500] erikh: \o/
[2012-03-05 08:15:00 -0500] silk: fujin, tell telstra that ;)
[2012-03-05 08:16:00 -0500] fujin: LOLOL
[2012-03-05 08:16:00 -0500] fujin: you're going via Telstra?
[2012-03-05 08:16:00 -0500] fujin: around the world 'n' back =_=
[2012-03-05 08:16:00 -0500] fujin: the peer between my Telstra session to reach.com is like, between 5-10% packet loss
[2012-03-05 08:16:00 -0500] silk: no, just makign reference to telstra and their BGP issue from last week
[2012-03-05 08:16:00 -0500] fujin: ahh, it's dropping now
[2012-03-05 08:16:00 -0500] fujin: ah, see "when it works" :)
[2012-03-05 08:17:00 -0500] silk: when Dodo reinjected their full route table back into telstra
[2012-03-05 08:17:00 -0500] silk: and their were apparently no filters
[2012-03-05 08:17:00 -0500] fujin: oh
[2012-03-05 08:17:00 -0500] fujin: i was actually affected by that
[2012-03-05 08:17:00 -0500] fujin: tubes were down
[2012-03-05 08:17:00 -0500] fujin: i cycled all of my CPE aggressively for 15min or so, made coffee
[2012-03-05 08:17:00 -0500] fujin: (in .nz)
[2012-03-05 08:18:00 -0500] fujin: I have nominal packet loss via telstra/nlayer.net/rackspace to api.opscode.com now
[2012-03-05 08:18:00 -0500] silk: yeah, i see it as being good
[2012-03-05 08:18:00 -0500] silk: anyway, my wife is getting narky, dinner awaits
[2012-03-05 08:19:00 -0500] fujin: fucking tell me about it
[2012-03-05 08:23:00 -0500] fujin: word i'm out
[2012-03-05 08:42:00 -0500] chaos: what is the proper way of uploading binary file through chef?
[2012-03-05 08:42:00 -0500] chaos: cookbook file resoure creates empty file
[2012-03-05 09:26:00 -0500] BryanWB: ranjibd: do java recipe + tomcat lwrp look like they meet your needs?
[2012-03-05 09:29:00 -0500] ranjibd: yes man , they do
[2012-03-05 09:35:00 -0500] BryanWB: ranjibd: kewl yaar, there is on piece of ugliness in there, https://github.com/bryanwb/cookbooks/blob/master/jira/recipes/default.rb#L138
[2012-03-05 09:36:00 -0500] nico: ohai chefs
[2012-03-05 09:36:00 -0500] BryanWB: ranjibd: i use a ruby_block to send the restart action to the tomcat lwrp and I don't have a nice wayy to subscribe the tomcat svc to additional config files
[2012-03-05 09:36:00 -0500] BryanWB: ciao nico
[2012-03-05 09:37:00 -0500] BryanWB: i may make the tomcat_svc a separate lwrp
[2012-03-05 09:37:00 -0500] BryanWB: but i was hoping smart people like ssd7 or nico could show me how to reopen a resource at run-time
[2012-03-05 09:39:00 -0500] nico: ?
[2012-03-05 09:39:00 -0500] nico: what do you want to do ?
[2012-03-05 09:40:00 -0500] nico: BryanWB: reopen a resource ?
[2012-03-05 09:41:00 -0500] BryanWB: nico: i use lwrp to set up tomcat instance in beginning of recipe, then after templatiing a bunch of config files, I want to run an action on an lwrp during run-time (! compile-time) and andd subscribes stuff
[2012-03-05 09:41:00 -0500] BryanWB: nico: yeah, change its attributes or add additional ones, this for an lwrp.  since you can re-open a class or module at any time, why not a resource?
[2012-03-05 10:18:00 -0500] fujin: BryanWB: it's standard ruby
[2012-03-05 10:18:00 -0500] fujin: class TheClassImOverriding < Chef::Provider::TheRealClass
[2012-03-05 10:18:00 -0500] fujin: whack methods.
[2012-03-05 10:19:00 -0500] fujin: you can call 'super' to run the parent class method body
[2012-03-05 10:19:00 -0500] fujin: inside of a method ?
[2012-03-05 10:19:00 -0500] fujin: there is surely a good book on this
[2012-03-05 10:19:00 -0500] fujin: pragprog
[2012-03-05 10:19:00 -0500] fujin: ruby pickaxe
[2012-03-05 10:19:00 -0500] fujin: I ususally chuck most of my logic into modules, then override classes and include modules (or extend modules) wherever  I need to.
[2012-03-05 10:20:00 -0500] fujin: creating specially named classes for a specific purpose is sometimes useful as well. ^_^
[2012-03-05 10:20:00 -0500] nico: metaprogramming ruby is good too
[2012-03-05 10:24:00 -0500] BryanWB: fujin: nico: it is not particularly clear to me how to do this due to my ignorance
[2012-03-05 10:24:00 -0500] BryanWB: i have read pickaxe and should read it again
[2012-03-05 10:27:00 -0500] fujin: https://gist.github.com/e88b762f7098a4c8cbeb
[2012-03-05 10:27:00 -0500] fujin: BryanWB:
[2012-03-05 10:32:00 -0500] fujin: you can basically tune any behavior of chef with monkeypatch in a library (fortunately/unfortunately)
[2012-03-05 10:32:00 -0500] fujin: due to the very nature of ruby <3
[2012-03-05 10:32:00 -0500] fujin: In the past, I've used this to deploy pre-release patches to clients experiencing particular bugs.
[2012-03-05 10:32:00 -0500] fujin: We generally try to avoid overriding core behaviors
[2012-03-05 10:33:00 -0500] fujin: where possible, a module should be developed, a new class superclassed from the class you desire to override, and the module included in the new class
[2012-03-05 10:33:00 -0500] fujin: reference your new class by name then the intent is clear, it is obviously modified
[2012-03-05 10:34:00 -0500] nico: black magic chef
[2012-03-05 10:35:00 -0500] fujin: the prevalence of a suitable testing framework would lessen my concern for overriding or supplanting behavior
[2012-03-05 10:35:00 -0500] fujin: I believe we're almost to that state
[2012-03-05 10:35:00 -0500] fujin: provided of course that adoption rates are nominal
[2012-03-05 10:35:00 -0500] BryanWB: fujin: i am not monkey patching a built-in resource but my own lwrp, but modifying attributes of my own lwrp
[2012-03-05 10:35:00 -0500] fujin: that sounds problematic, as lwrps are evaluated dynamically
[2012-03-05 10:36:00 -0500] BryanWB: fujin: exactly
[2012-03-05 10:36:00 -0500] fujin: ruby stuff happens under the hood to make them into real classes
[2012-03-05 10:36:00 -0500] fujin: can you not put the behavior you mention into a module and include it in the actions, or something ?
[2012-03-05 10:36:00 -0500] BryanWB: fujin: i did, which means, i have to use a ruby_block to call that action
[2012-03-05 10:36:00 -0500] BryanWB: which is fugly
[2012-03-05 10:37:00 -0500] fujin: I can't imagine why that would be
[2012-03-05 10:37:00 -0500] fujin: care to show code
[2012-03-05 10:37:00 -0500] BryanWB: fujin: yes, https://github.com/bryanwb/cookbooks/blob/master/jira/recipes/default.rb#L138
[2012-03-05 10:38:00 -0500] BryanWB: i create the tomcat resource at beginning of recipe, then put a bunch of config files in place, finally, start the tomcat instance
[2012-03-05 10:38:00 -0500] fujin: that seems awfully complicated
[2012-03-05 10:38:00 -0500] fujin: why not create the directory structure, render the configuration then instantiate the servlet container ?
[2012-03-05 10:38:00 -0500] fujin: the steps to deploy a tomcat application are minimal at best
[2012-03-05 10:39:00 -0500] fujin: you can of course ensure the permissions and such all line up -- you are the configurator
[2012-03-05 10:39:00 -0500] fujin: why, the entire structure could be created with a known uid/gid *then* the user added
[2012-03-05 10:39:00 -0500] fujin: only referenced by name
[2012-03-05 10:39:00 -0500] fujin: as I mentioned, this is definitely simpler than you are solving for
[2012-03-05 10:40:00 -0500] fujin: -_-
[2012-03-05 10:42:00 -0500] BryanWB: i think your solution will work, but i think it will be less readable, probably best to create separate lwrp for tomcat_svc and put it at end of cookbook
[2012-03-05 10:43:00 -0500] BryanWB: my devs expect to see the tomcat file hierarchy look a certain way and tweaking my recipe logic will be easier than teaching them a new convention
[2012-03-05 10:46:00 -0500] fujin: you can do all of what I describe in an lwrp
[2012-03-05 10:46:00 -0500] fujin: single resource in a cookbook to deploy whatever.
[2012-03-05 10:46:00 -0500] fujin: but of course
[2012-03-05 10:46:00 -0500] fujin: break it up into smaller parts if you are repeating stuff
[2012-03-05 10:46:00 -0500] fujin: it seems to me it could be made simpler
[2012-03-05 10:46:00 -0500] fujin: are there no other good tomcat cookbook resources? I admit, it has been some time
[2012-03-05 10:47:00 -0500] BryanWB: fujin: nope
[2012-03-05 10:48:00 -0500] fujin: are there more popular servlet containers these days?
[2012-03-05 10:48:00 -0500] fujin: popular/stable/maintained ??
[2012-03-05 10:48:00 -0500] fujin: seems strange that no public cookboook exists
[2012-03-05 10:48:00 -0500] BryanWB: no other tomcat besides the ancient one in opscode/cookbooks which uses jpackage to pull in an ancient rpm
[2012-03-05 10:48:00 -0500] BryanWB: from the 1980s
[2012-03-05 10:49:00 -0500] BryanWB: tomcat is still the most popular and it is my shop uses, for better or worse
[2012-03-05 10:49:00 -0500] fujin: damn
[2012-03-05 10:50:00 -0500] fujin: i cannot compute your requirements effectively
[2012-03-05 10:50:00 -0500] fujin: consult me another time
[2012-03-05 10:50:00 -0500] BryanWB: ok, tks for trying
[2012-03-05 10:50:00 -0500] fujin: It's late.
[2012-03-05 10:50:00 -0500] fujin: (drinking, weekend, <3)
[2012-03-05 10:51:00 -0500] fujin: very late actually, I'm out
[2012-03-05 10:51:00 -0500] fujin: gl!
[2012-03-05 11:00:00 -0500] lflux: ohai chefs
[2012-03-05 11:00:00 -0500] lflux: how do I get knife to load a plugin from the directory i'm in (or any arbitrary directory) instead of from a gem
[2012-03-05 11:01:00 -0500] lflux: I'm using the knife-vsphere plugin but I want to hack on it in my local dir
[2012-03-05 11:22:00 -0500] nico: lflux: put it in .chef/plugins/knife/
[2012-03-05 11:29:00 -0500] probst: good morning all! I am trying to use the Bluepill recipe from the opscode cookbooks repo. When running it I get: "FATAL: NameError: wrong constant name Bluepill.Service". Any ideas?
[2012-03-05 11:31:00 -0500] probst: and just for completeness: I have included the bluepill cookbook in my run list as: "recipe[bluepill]", and I am subsequently using the "bluepill_service "server_name" do  end" in one of my own recipes, like the README suggests.
[2012-03-05 11:48:00 -0500] matti: jtimberman: I quite like this echo-sign thing when signing up for a contributor access :)
[2012-03-05 12:27:00 -0500] lflux: nico: thanks
[2012-03-05 12:44:00 -0500] BryanWB: ranjibd: if u have any thoughts on how to make my fugly jira recipe prettier, would to hear them
[2012-03-05 13:03:00 -0500] lflux: Are ruby questions OK? How do I format a number to human readable file size?
[2012-03-05 13:06:00 -0500] iafonov: if you're with rails you can use number_to_human_size if not you'll have to do it yourself
[2012-03-05 13:06:00 -0500] iafonov: https://github.com/rails/rails/blob/c70135807ed786e6c9e18a35cc83ac6007450ca2/actionpack/lib/action_view/helpers/number_helper.rb#L363
[2012-03-05 13:06:00 -0500] lflux: Not in rails :(
[2012-03-05 13:15:00 -0500] proffalken: Does chef have an equivalent to "requires" in puppet? I'm having issues finding it in the docs...
[2012-03-05 13:15:00 -0500] proffalken: I have a execute command that requires a file to be in place before it is executed
[2012-03-05 13:20:00 -0500] lflux: notifies will take care of that
[2012-03-05 13:20:00 -0500] lflux: have the file notify the execute command
[2012-03-05 13:21:00 -0500] proffalken: lflux: so I set the "action" of the command to ":nothing" and then "notify" the exec?
[2012-03-05 13:21:00 -0500] lflux: yes
[2012-03-05 13:21:00 -0500] proffalken: cool, thanks.
[2012-03-05 13:21:00 -0500] lflux: it can also be done the other way around with subscribes
[2012-03-05 14:02:00 -0500] fearoffish: remind me, how do I access attributes from a role file?
[2012-03-05 14:02:00 -0500] fearoffish: i.e. I have a role file 'webserver.rb', and I want to access attributes set in another
[2012-03-05 14:02:00 -0500] fearoffish: or from a cookbooks attribute file
[2012-03-05 14:04:00 -0500] fearoffish: default doesn't exist, nor does node (of course), I can't remember if there *was* a way, or if it wasn't possible
[2012-03-05 14:07:00 -0500] `brendan: morning folks
[2012-03-05 14:08:00 -0500] fearoffish: mornin'
[2012-03-05 14:13:00 -0500] fearoffish: okay, looks like I'll ahve to use data bags for what I need
[2012-03-05 14:21:00 -0500] dwhsix: anyone here using the bluepill cookbook?
[2012-03-05 14:21:00 -0500] dwhsix: I'm having trouble figuring out what the service name is
[2012-03-05 14:21:00 -0500] dwhsix: to do a notifies :restart, resources(:service => '...
[2012-03-05 14:28:00 -0500] Squarism: is there a way to list all nodes that has a certain recipie using command line?
[2012-03-05 14:32:00 -0500] asg: Squarism: knife search node recipe:<recipe name>
[2012-03-05 14:33:00 -0500] asg: Squarism: more info and examples here: http://wiki.opscode.com/display/chef/Search
[2012-03-05 14:48:00 -0500] jtimberman: dwhsix: notifies :restart, "bluepill_service[name-of-your-thing]"
[2012-03-05 14:49:00 -0500] geekbri: Has anybody else experienced all sorts of issues trying to use the mysql cookbook to use a different data_dir than the default one on ubuntu?
[2012-03-05 14:49:00 -0500] jtimberman: dwhsix: presuming you're using the bluepill_service LWRP
[2012-03-05 14:49:00 -0500] dwhsix: jtimberman: ah, thx that's the one permutation I didn't try
[2012-03-05 14:49:00 -0500] dwhsix: I believe so
[2012-03-05 14:49:00 -0500] jtimberman: geekbri: should be set for ubuntu properly in attributes/default.rb
[2012-03-05 14:50:00 -0500] jtimberman: er, mysql/attributes/server.rb :)
[2012-03-05 14:50:00 -0500] jtimberman: ubuntu will be caught under the 'else' in the platform case statement
[2012-03-05 14:50:00 -0500] jtimberman:   default['mysql']['data_dir']                = "/var/lib/mysql"
[2012-03-05 14:51:00 -0500] haakon_: How could I in a recipe find all roles for the current node?
[2012-03-05 14:51:00 -0500] geekbri: jtimberman: yeah, I was trying to change that to /mnt/mysql but it blows up with errors about /var/lib/mysql not existing, and then also when mysql tries to respawn app armor stops it from starting because thats not in its profile.
[2012-03-05 14:52:00 -0500] geekbri: jtimberman: I tried using both regular mysql::server and mysql::server_ec2.  Seemed to be the same result.  I disabled app_armor temporarily, installed mysql, then switched the data_dir myself, and edited the app armor profile and it seems to be 'ok' now
[2012-03-05 14:52:00 -0500] jtimberman: haakon_: node['roles']
[2012-03-05 14:53:00 -0500] jtimberman: haakon_: that is an automatically created attribute chef gets from expanding the node's run list for all the roles, and the roles the roles have in their run list
[2012-03-05 14:53:00 -0500] haakon_: jtimberman: Thanks, would case node[:roles] when "apache-server" <do something> when "mysql-server" <do something else> work?
[2012-03-05 14:54:00 -0500] haakon_: Is it legal to specify several options within a case while iterating through the node list?
[2012-03-05 14:54:00 -0500] jtimberman: haakon_: presuming you have those roles :)
[2012-03-05 14:54:00 -0500] geekbri: jtimberman: just checked and my node['platform'] is set to 'ubuntu
[2012-03-05 15:00:00 -0500] jtimberman: geekbri: fire up shef on the node
[2012-03-05 15:00:00 -0500] jtimberman: geekbri: sudo shef -z
[2012-03-05 15:01:00 -0500] jtimberman: then do
[2012-03-05 15:01:00 -0500] jtimberman: node.run_list.expand(node.chef_environment).recipes.each {|r| include_recipe r}
[2012-03-05 15:01:00 -0500] jtimberman: and check the mysql attributes
[2012-03-05 15:01:00 -0500] jtimberman: node['mysql']['data_dir']
[2012-03-05 15:04:00 -0500] geekbri: jtimberman: k uno momento
[2012-03-05 15:06:00 -0500] haakon_: jtimberman: so this should have worked? http://pastie.org/private/lhhvvcvzp1tnjx3apoxvza
[2012-03-05 15:06:00 -0500] haakon_: knife search role "name:apache-server"
[2012-03-05 15:06:00 -0500] haakon_: 1 items found
[2012-03-05 15:06:00 -0500] haakon_: And so on (the roles do exist)
[2012-03-05 15:07:00 -0500] geekbri: jtimberman: Looks like I removed the mysql recipe because it was causing issues.
[2012-03-05 15:07:00 -0500] jtimberman: haakon_: well the role would need to be applied to the node's run list
[2012-03-05 15:08:00 -0500] geekbri: jtimberman: (sorry this was on thursday I had this issue and needed to get the server up).  This was pretty much a blank server that I was trying to use mysql::server_ec2 on... It had a properly mounted /mnt/mysql dir and it blew up first because /var/lib/mysql didn't exist (it claimed) and second due to app armor
[2012-03-05 15:08:00 -0500] jtimberman: haakon_: but i think a better approach would be to have a recipe included by those particular roles that integrates in with munin
[2012-03-05 15:09:00 -0500] haakon_: jtimberman: can confirm that the role(s) is/are applied to the relevant nodes run list. ah, thanks for your input
[2012-03-05 15:10:00 -0500] haakon_: jtimberman: so i could eg. create a recipe for each role
[2012-03-05 15:14:00 -0500] dwhsix: jtimberman: so if my recipe has:
[2012-03-05 15:14:00 -0500] dwhsix: bluepill_service "monitoring" do
[2012-03-05 15:14:00 -0500] dwhsix: then the service name would be bluepill_servicemonitoring?
[2012-03-05 15:14:00 -0500] geekbri: jtimberman: I will probably have to setup another mysql server in the upcoming month, so maybe I can reconnect with you then when I'm able to duplicate the issue.
[2012-03-05 15:14:00 -0500] dwhsix: trying to see where that is determined in the cookbook
[2012-03-05 15:24:00 -0500] haakon_: jtimberman: including a special recipe for the relevant roles worked like a charm, thanks for pointing me in that direction.
[2012-03-05 15:24:00 -0500] jtimberman: haakon_: yeah, i'd put a recipe like "monitoring_all_the_things.rb" in each cookbook :)
[2012-03-05 15:24:00 -0500] jtimberman: there ya go :D
[2012-03-05 15:38:00 -0500] mattray: jtimberman: it would be interesting to take the time to think about applying the MetaChef concepts to all the cookbooks
[2012-03-05 15:38:00 -0500] fish_: re
[2012-03-05 15:38:00 -0500] mattray: so there would be "monitoring all the things" available across the board
[2012-03-05 15:38:00 -0500] mattray: and "log all the things" etc.
[2012-03-05 15:39:00 -0500] mattray: yes
[2012-03-05 15:39:00 -0500] mattray: a big project for sure
[2012-03-05 15:39:00 -0500] jtimberman: mattray: is that stuff from ironfan?
[2012-03-05 15:45:00 -0500] jtimberman: geekbri: you should have this if you're using the server_ec2 recipe: /mnt/mysql on /var/lib/mysql type none (rw,bind)
[2012-03-05 15:48:00 -0500] geekbri: jtimberman: It was blowing up before that step.  When I went to install it the chef run would explode with an error about /var/lib/mysql not existing (this was on first run)
[2012-03-05 15:48:00 -0500] geekbri: jtimberman: I noticed you were basically binding /var/lib/mysql to /mnt/mysql so you woudln't even need to update the app armor profile, but I couldn't get it work
[2012-03-05 15:52:00 -0500] jtimberman: geekbri: do you have mysql::server before mysql::server_ec2?
[2012-03-05 15:53:00 -0500] geekbri: jtimberman: Well i've removed them both currently :(  That very well could have been the issue (I thought server_ec2 was a standalone).  I'm going to be spinning up a new server next week.  I will make SURE that they are both in the role and in that order.
[2012-03-05 15:57:00 -0500] BryanWB: maven , ivy  garrhhhh!
[2012-03-05 15:57:00 -0500] BryanWB: pain!!!
[2012-03-05 16:05:00 -0500] jtimberman: geekbri: yeah, sorry.. i don't remember why mysql::server is not included in mysql::server_ec2.
[2012-03-05 16:05:00 -0500] jtimberman: BryanWB: show us in the XML where the tag touched you
[2012-03-05 16:07:00 -0500] BryanWB: jtimberman: lol
[2012-03-05 16:08:00 -0500] thom: jtimberman: yeah, that (mysql) is a little irritating
[2012-03-05 16:09:00 -0500] geekbri: jtimberman: Well now that I know its not a big deal ;)  It def. should probably be included.
[2012-03-05 16:09:00 -0500] geekbri: jtimberman: btw, thanks for all your hard work on the plethora of cookbooks you work on :-P
[2012-03-05 16:09:00 -0500] jtimberman: geekbri: sure thing :D
[2012-03-05 16:28:00 -0500] sivy_afk:         hey jtimberman
[2012-03-05 16:28:00 -0500] sivy: thinking about the pip+requirements.txt thing (COOK-1083)
[2012-03-05 16:29:00 -0500] sivy: what would you say to being able to do: python_pip "/path/to/requirements.txt" do { action :install; virtualenv "/path/virtualenv" }
[2012-03-05 16:30:00 -0500] sivy: it would mean some processing on the provider's name attribute
[2012-03-05 16:30:00 -0500] sivy: but not overly much
[2012-03-05 16:30:00 -0500] sivy: perhaps passing an attribute is_requirements :True
[2012-03-05 16:32:00 -0500] monkeymike: is there way in chef to update a single file without having to do the whole chef-client run?
[2012-03-05 16:33:00 -0500] BryanWB: monkeymike: not afaik
[2012-03-05 16:33:00 -0500] monkeymike: :(
[2012-03-05 16:33:00 -0500] Brad_K: monkeymike: if your recipes are written correctly, then they should be able to very quickly determine that there is nothing to do (for almost all of them), and therefore the chef-client run should be short  maybe just a few seconds.
[2012-03-05 16:34:00 -0500] monkeymike: ya
[2012-03-05 16:35:00 -0500] Brad_K: generally speaking, you wouldn't want a way to update a single file without a chef-client run, because that would mean that the file in question is not version-controlled and part of your automated "infrastructure as code".
[2012-03-05 16:35:00 -0500] geekbri: does the bash directive run at compile time or execution time? if I use it after a ruby_block lexically will it actually run after it?
[2012-03-05 16:35:00 -0500] monkeymike: i figured i'd ask if there's a quicker way. these recipes weren't really "written correctly" so running chef-client can do updates that are not wanted yet. we'll have to redo a bunch of stuff
[2012-03-05 16:36:00 -0500] Brad_K: you could always just scp a file.
[2012-03-05 16:36:00 -0500] Brad_K: or do a "knife ssh" that triggers a download from the other side.
[2012-03-05 16:36:00 -0500] monkeymike: sometimes there are attributes that pertain to the hostname, or availability zone it's in
[2012-03-05 16:37:00 -0500] monkeymike: but we have done curl's before
[2012-03-05 16:37:00 -0500] monkeymike: curl -l URL > /path/to/config.file
[2012-03-05 16:37:00 -0500] Brad_K: there are use cases I can think of where you want to be able to update a resource in a real-time manner, much faster than you could possibly do with continual chef-client runs.  in those cases, you have to design that infrastructure to explicitlly function outside of chef.
[2012-03-05 16:37:00 -0500] monkeymike: but just wondering if chef has a way
[2012-03-05 16:38:00 -0500] geekbri: Is there a knife scp plugin? that would be awesome.
[2012-03-05 16:38:00 -0500] Brad_K: i'm not aware of a knife scp plugin.
[2012-03-05 16:38:00 -0500] geekbri: I may consider writing one then, at least I think it would be cool
[2012-03-05 16:38:00 -0500] monkeymike: definitely
[2012-03-05 16:47:00 -0500] flashmanbahadur: seeing a weird issue where a recipe can't see a LWRP of mine during a template action.
[2012-03-05 16:47:00 -0500] flashmanbahadur: However, right before it, I have a block for that same LWRP
[2012-03-05 16:47:00 -0500] flashmanbahadur: no issues
[2012-03-05 16:47:00 -0500] flashmanbahadur: didnt have this problem a week ago
[2012-03-05 16:47:00 -0500] flashmanbahadur: https://gist.github.com/4f6c1ffe5fd308e68c3e
[2012-03-05 16:47:00 -0500] flashmanbahadur: Fails on the template block, with or without the supervisor block
[2012-03-05 16:48:00 -0500] flashmanbahadur: keeps stating it cannot find it in the resource collection
[2012-03-05 16:49:00 -0500] flashmanbahadur: but it has no issues finding it elsewhere in other cookbooks
[2012-03-05 16:49:00 -0500] flashmanbahadur: during the same run
[2012-03-05 16:50:00 -0500] flashmanbahadur: weird
[2012-03-05 16:50:00 -0500] flashmanbahadur: looks like a scoping issue
[2012-03-05 16:51:00 -0500] flashmanbahadur: i have to explicitly redefine another version of of the LWRP
[2012-03-05 16:51:00 -0500] flashmanbahadur: even though it should have one available from earlier
[2012-03-05 17:08:00 -0500] mconigliaro: jtimberman: "Opscode is no longer maintaining Vagrant boxes as we do not widely use Vagrant internally."
[2012-03-05 17:09:00 -0500] mconigliaro: thats what ben and i are talking about
[2012-03-05 17:09:00 -0500] mconigliaro: i was curious what this was all about
[2012-03-05 17:09:00 -0500] mconigliaro: it made me wonder if there was some fancy new way of testing i wasn't aware of
[2012-03-05 17:10:00 -0500] mconigliaro: oh, that quote is here: http://wiki.opscode.com/display/chef/Vagrant
[2012-03-05 17:11:00 -0500] jslatts: does anyone know if http://tickets.opscode.com/browse/COOK-985 is scheduled to be fixed? I tried using the latest proposed pull by @miah, but node.recipes.include was bombing out
[2012-03-05 17:17:00 -0500] sivy: anyone know off-hand how to specify a boolean as an attribute kind_of for a resource?
[2012-03-05 17:17:00 -0500] sivy: can I do :kind_of =>Boolean
[2012-03-05 17:21:00 -0500] sivy: (i found it)
[2012-03-05 17:53:00 -0500] JasonBox: hrm, can one compromise a chef server and modify recipes for nefarious purposes?
[2012-03-05 17:54:00 -0500] JasonBox: Or are cookbooks signed or something like RPMs?
[2012-03-05 17:54:00 -0500] flashmanbahadur: JasonBox: not sure how the internals work, but if they have access to chef server, couldnt they just download existing recipies, modify them as a user and upload them?  No need to change them in place on the server necessarily
[2012-03-05 17:55:00 -0500] JasonBox: hrm, indeed
[2012-03-05 18:01:00 -0500] jtimberman: mconigliaro: hey
[2012-03-05 18:01:00 -0500] mconigliaro: hi
[2012-03-05 18:01:00 -0500] jtimberman: mconigliaro: that statement on the wiki is inaccurate now.
[2012-03-05 18:01:00 -0500] mconigliaro: ah, ok
[2012-03-05 18:01:00 -0500] mconigliaro: it confused me =)
[2012-03-05 18:02:00 -0500] jtimberman: we use a lot of things to test cookbooks
[2012-03-05 18:02:00 -0500] jtimberman: *I* use vagrant.
[2012-03-05 18:02:00 -0500] mconigliaro: vagrant is the best thing i've found
[2012-03-05 18:02:00 -0500] jtimberman: the dev teams are using vagrant for testing private/hosted chef codes
[2012-03-05 18:02:00 -0500] mconigliaro: but when i saw that on the wiki, it made me think there was some new way
[2012-03-05 18:03:00 -0500] jtimberman: but in neither case are the default base boxes sufficient, nor are we going to maintain public base boxes going forward, especially since things like veewee make it *so* easy to create a new basebox.
[2012-03-05 18:03:00 -0500] mconigliaro: sure, that makes sense
[2012-03-05 18:03:00 -0500] mconigliaro: id use veewee anyway
[2012-03-05 18:03:00 -0500] jtimberman: eh, "new" ways: vmware fusion, ec2, rackspace, openstack...
[2012-03-05 18:06:00 -0500] Brad_K: veewee?
[2012-03-05 18:08:00 -0500] mconigliaro: Brad_K: https://github.com/jedi4ever/veewee
[2012-03-05 18:08:00 -0500] Brad_K: 'k
[2012-03-05 18:11:00 -0500] Brad_K: cool!
[2012-03-05 18:12:00 -0500] Brad_K: we don't use any of that stuff, at least not yet.  but at least now i have a chance of some success if/when we do go down that road.
[2012-03-05 18:13:00 -0500] Brad_K: Everything I've learned about #nginx so far (see http://tmblr.co/ZV73zvHWNCxX )  Can I get some comments & feedback?  Thanks!
[2012-03-05 18:14:00 -0500] jtimberman: mconigliaro: updated the page :)
[2012-03-05 18:14:00 -0500] jtimberman: Brad_K: we use nginx for internal and external load balancers
[2012-03-05 18:14:00 -0500] jtimberman: its awesome.
[2012-03-05 18:15:00 -0500] Brad_K: indeed.  i'm just coming up to speed on it, and i wanted to write down in a single place everything i had learned so far.
[2012-03-05 18:15:00 -0500] mconigliaro: jtimberman: cool, thanks
[2012-03-05 18:24:00 -0500] gsat: Hi, I have a quick question on chef server,
[2012-03-05 18:25:00 -0500] gsat: Can server initiate a client run on a node?
[2012-03-05 18:26:00 -0500] Brad_K: gsat: that's now how chef normally works, no.
[2012-03-05 18:26:00 -0500] Brad_K: of course, you could always set up some sort of non-standard way to do things, but then that would be  non-standard.
[2012-03-05 18:27:00 -0500] gsat: Basically i want to do a server intiated push
[2012-03-05 18:27:00 -0500] gsat: of changes
[2012-03-05 18:27:00 -0500] Brad_K: the chef model is client pull, not server push.  if you want to go against the grain, you're going to have a struggle on your hands.
[2012-03-05 18:28:00 -0500] Brad_K: this is not to say that it can't be done, just that it would be more difficult, and you'd always be the guy out in left field who is facing the wrong way.
[2012-03-05 18:29:00 -0500] gsat: Brad_K , i need to get ohai data on demand from a client how can i do that
[2012-03-05 18:29:00 -0500] Brad_K: the ohai data from clients should be stored by default in the chef database, and indexed by solr.
[2012-03-05 18:30:00 -0500] Brad_K: so you would always have the information available from the most recent chef run, and the kind of data that ohai is discovering about nodes doesn't tend to change quickly or often.
[2012-03-05 18:32:00 -0500] gsat: So no way of running the Ohai on demand from server on a node, "knief exec" is on any use? can i run a "command " on client on demand
[2012-03-05 18:33:00 -0500] Brad_K: you could always ssh in and run chef-client over that ssh connection, or maybe you don't need to run chef-client every time, maybe you just re-run ohai via ssh.  but that's still counter to the chef model.
[2012-03-05 18:33:00 -0500] Brad_K: whether that's done as a "knife ssh" from the server, or handled via some other means, it would be something custom to your site and you could do that however you wanted.
[2012-03-05 18:34:00 -0500] Brad_K: gsat: tell us what you're actually trying to achieve, and we can tell you if there is a better chef-native way to solve that problem.
[2012-03-05 18:37:00 -0500] gsat: Brad_k: Yes i can setup ssh to do that, i am trying to get application releted data from the client on demand and possibly keep it in the data bags if possible for searching.
[2012-03-05 18:38:00 -0500] Brad_K: how is ohai going to detect application-related data?  moreover, if this data really is changing so quickly and so often that waiting for the next chef run is not going to work, then how do you expect that putting it into a data bag would be helpful?
[2012-03-05 18:38:00 -0500] Brad_K: don'
[2012-03-05 18:39:00 -0500] Brad_K: don't ask me how to get from step 23 to step 24.  tell me what the goal is, and maybe i can tell you if there is a better way to get there.
[2012-03-05 18:43:00 -0500] Brad_K: be right back.
[2012-03-05 18:52:00 -0500] flashmanbahadur: is it feasible to create a ruby_block which can be notified?
[2012-03-05 18:53:00 -0500] ashb: flashmanbahadur: yes, ruby_block is a resource and all resources can be notified/subscribe to notifications
[2012-03-05 18:53:00 -0500] flashmanbahadur: ok
[2012-03-05 19:02:00 -0500] gsat: Brad_K, In this case ,  When ever there is a code change for my application, i need to push it to the client , Client may not know when to  pull changes, If we are not running chef-client in sheduled mode repeatedly, How can client know when
[2012-03-05 19:02:00 -0500] gsat: to update itself?
[2012-03-05 19:05:00 -0500] Brad_K: gsat: depending on the timing issue (i.e., how soon after the new version of the code is available that it needs to be available on the client), this may be something that needs to be handled outside the purview of chef.  If you need a matter of seconds between the new version being available and the new version actually being put into production, then chef really isn't the right kind of tool for managing application deployment on those kinds of timesca
[2012-03-05 19:05:00 -0500] Brad_K: if waiting ten or thirty minutes is acceptable, then chef could easily be part of the solution.
[2012-03-05 19:06:00 -0500] Brad_K: of course, application deployment is not something that chef itself does natively.  you either need one or more cookbooks to help you do that, or you need another tool like rundeck or capistrano to do that.
[2012-03-05 19:07:00 -0500] Brad_K: what we do with our applications is we build binary packages from them using Jenkins, and then we have Jenkins push out the new versions of the packages to our rpm repo.  from there, we let chef & yum handle the update process.
[2012-03-05 19:08:00 -0500] Brad_K: we also lock down our production environment so that even if there is a new version of a particular rpm available from the yum repo, it still doesn't get deployed to the production systems until we update the production environment to specifically reference the cookbook that deploys that particular version of that particular rpm.
[2012-03-05 19:09:00 -0500] Brad_K: so, the devs can push new rpms all day long, and nothing actually gets put into our production until i make the changes to our production environment.
[2012-03-05 19:09:00 -0500] Brad_K: of course, that model might not work for you.
[2012-03-05 19:10:00 -0500] gsat: Our deployment solution tool chain includes rundeck and jenkins, we build code and try to push the changes using a rundeck job on to client,
[2012-03-05 19:10:00 -0500] gchristensen: our deployment steps here are highly dependent on database migrations being executed while the applications are disable, so its extremely time sensitive and we use capistrano for that instead of chef, because of that
[2012-03-05 19:11:00 -0500] Brad_K: right  different models work for different sites.
[2012-03-05 19:12:00 -0500] gsat: We are in sync , but our requirement is to push that changes to the client when ever we have a new pkg/tar/zip file, that i am trying to do with chef native way if possible.
[2012-03-05 19:12:00 -0500] Brad_K: gsat: if you're already using rundeck and jenkins, it sounds like you're already well ahead of the game.  let those tools do what they do best, and let chef do what it does best.
[2012-03-05 19:13:00 -0500] Brad_K: you could have jenkins or rundeck fire off a run of chef-client once they are done with their part of the work.  of course, having that happen across a wide array of machines will greatly increase the load on your chef-server, because it will have a bunch of chef-client machines all hammering it at once.
[2012-03-05 19:14:00 -0500] gsat: correct, How can rundeck start a chef-client run? using ssh?
[2012-03-05 19:15:00 -0500] stuntmachine: I've set the mysql root password using the following construct in the attributes/default.rb of a cookbook I've developing:     default['mysql']['server_root_password'] = "rootpassword"
[2012-03-05 19:15:00 -0500] Brad_K: that's a rundeck question and we don't use rundeck, so i am afraid i can't help you there.  i would assume that it could do some sort of "ssh to the appropriate remote host" type of function, but that's based on total ignorance.
[2012-03-05 19:16:00 -0500] gsat: that was my question about doing a "server initiated client run?
[2012-03-05 19:16:00 -0500] stuntmachine: Yet when I upload it and run chef-client on my test VM, it doesn't seem to work because I still cannot access the mysql monitor using      mysql -u root -p
[2012-03-05 19:16:00 -0500] stuntmachine: and that password
[2012-03-05 19:38:00 -0500] hoover_damm: stuntmachine, heh yep
[2012-03-05 19:39:00 -0500] hoover_damm: stuntmachine, I just am sitting at that same moment myself
[2012-03-05 19:39:00 -0500] hoover_damm: I set the password in a role, I see it explicitly set in the role
[2012-03-05 19:39:00 -0500] hoover_damm: and yet.
[2012-03-05 19:39:00 -0500] hoover_damm: then again i'm completely using this cookbook wrong
[2012-03-05 19:39:00 -0500] hoover_damm: so it could be me
[2012-03-05 19:40:00 -0500] hoover_damm: stuntmachine, fwiw if you use the database cookbook and use the master recipe like described... and use the apps databag
[2012-03-05 19:40:00 -0500] hoover_damm: stuntmachine, it will just all work right
[2012-03-05 19:48:00 -0500] AntonZ: Hello, chef is throwing an error for some reason such as Volume with id vol-bla123 exists but is attached to instance i-bla456 - i thought the same volume can be attached multiple time to different instances ?
[2012-03-05 19:51:00 -0500] AntonZ: here is the gist https://gist.github.com/1895560
[2012-03-05 19:51:00 -0500] AntonZ: anyone can give me a clew ?
[2012-03-05 19:51:00 -0500] AntonZ: clue
[2012-03-05 19:52:00 -0500] holoway: AntonZ: no, you can't attach the same volume to different instances
[2012-03-05 19:53:00 -0500] AntonZ: i swear the god i saw somehwere on aws docs that you can.. shoot..
[2012-03-05 19:55:00 -0500] holoway: AntonZ: the god lied to you
[2012-03-05 19:55:00 -0500] holoway: :)
[2012-03-05 19:57:00 -0500] AntonZ: sigh :)
[2012-03-05 19:58:00 -0500] AntonZ: is there a cookbook to attache S3 bucket to an instance and use it as filesystem, im curious if i can use S3 bucket let's say as a shared slice of filesystem across multiple instances
[2012-03-05 19:59:00 -0500] Brad_K: AntonZ: check out s3ql at https://code.google.com/p/s3ql/
[2012-03-05 20:00:00 -0500] AntonZ: sweet! thank you!
[2012-03-05 20:01:00 -0500] Brad_K: i wish they had better support for Rackspace Cloud Files, but if you're on S3, it is by far the best solution i've found so far.  at least, from the perspective of someone who hasn't actually used it.
[2012-03-05 20:02:00 -0500] fujin: please dont' attach s3 and use it as a filesystem
[2012-03-05 20:02:00 -0500] fujin: it is not a filesystem
[2012-03-05 20:02:00 -0500] fujin: you will more than likely fuck yourself doing something dumb assuming it is a filesystem
[2012-03-05 20:03:00 -0500] fujin: don't raid up terabytes and terabytes of EBS and then share it with GlusterFS or NFS either.
[2012-03-05 20:03:00 -0500] Brad_K: ahh, i see.  you should use ZFS instead, then.  ;-)
[2012-03-05 20:04:00 -0500] fujin: i would really avoid, by all means, sharing a high-latency, low-IOPS disk storage across a shared network resource
[2012-03-05 20:05:00 -0500] Brad_K: but we needs our petabytes!  ;-)
[2012-03-05 20:05:00 -0500] fujin: object storage i sthere for a reason lol
[2012-03-05 20:05:00 -0500] Brad_K: if only there were decent tools to actually make real-world use of object storage.  ;-(
[2012-03-05 20:06:00 -0500] fujin: you mean like the s3 object storage api ?
[2012-03-05 20:06:00 -0500] Brad_K: i'd be happy to get rid of the "treat everything as a filesystem" solution, if you could present me with an alternative that actually worked with standard tools.
[2012-03-05 20:07:00 -0500] fujin: stop architecting your freaking spaghetti infrastructure around a giant shared disk lol
[2012-03-05 20:07:00 -0500] Brad_K: right.  how many standard tools have been re-written to use the S3 storage API?
[2012-03-05 20:07:00 -0500] fujin: I am not saying use standard tools
[2012-03-05 20:07:00 -0500] fujin: I am saying use the tooling on the infrastructure you are deploying your app to
[2012-03-05 20:07:00 -0500] fujin: If you need to store petabytes of data, put it in object storage
[2012-03-05 20:07:00 -0500] AntonZ: im looking to have a volume that can be shared across instances, for example a /home
[2012-03-05 20:07:00 -0500] fujin: brilliant idea.
[2012-03-05 20:09:00 -0500] fujin: Brad_K: a common pattern is to employ a service encapsulating the standard tool and the infrastructure specific storage, e.g. spooling to and from S3
[2012-03-05 20:09:00 -0500] Brad_K: my use case is online backups.  we have a certain amount of our infrastructure that we can relatively easily re-create (with chef), but we have other parts of our infrastructure where re-creating is too painful and too time-consuming.  we need a way to back that data up in a binary format, quickly.
[2012-03-05 20:10:00 -0500] fujin: I am currently aware of between one and ten S3 based backup services
[2012-03-05 20:11:00 -0500] Brad_K: doing binary backups quickly and efficiently is a problem that has, more or less, been solved at the level of individual local machines writing to other local devices.  but things rapidly start getting really complicated when you try to do that across the network, and even more so when you try to go to the cloud.
[2012-03-05 20:11:00 -0500] Brad_K: right, but we don't use S3.  period.  no amazon accounts here.  period.
[2012-03-05 20:11:00 -0500] Brad_K: moreover, S3 would be dead-dog slow and damn bloody expensive, if we were trying to back up to it from Rackspace.
[2012-03-05 20:12:00 -0500] fujin: lol
[2012-03-05 20:12:00 -0500] fujin: ok, cool story bro
[2012-03-05 20:12:00 -0500] fujin: good luck
[2012-03-05 20:14:00 -0500] Brad_K: for the moment, however, let's say that S3 was a viable option.  how many of those S3 backup services do you know of that work for servers running Linux, as opposed to Windows boxes?  how many of those S3 backup services let me do all the coordination and orchestration from my end, so that i can do all the various necessary tricks to put my MongoDB service into a suitable state so that i can actually take binary backups of it?
[2012-03-05 20:14:00 -0500] fujin: lololol
[2012-03-05 20:14:00 -0500] fujin: sorry man I am done
[2012-03-05 20:15:00 -0500] Brad_K: every single cloud backup solution i know of requires a pull-based method from their end.  they need to control and spread their load, among other things.  and almost none of them support Linux.
[2012-03-05 20:16:00 -0500] Brad_K: So, we fall back to the solutions where we can use standard tools like rsync, tar, dump, etc to what appears to be a "normal" filesystem that is mounted remotely.  and s3ql is the best solution that i have found so far in that space.
[2012-03-05 20:17:00 -0500] AntonZ: im curious why amazon does not allow to mount the same volume across instances
[2012-03-05 20:17:00 -0500] holoway: AntonZ: because it would corrupt the dat
[2012-03-05 20:17:00 -0500] holoway: er data
[2012-03-05 20:18:00 -0500] holoway: in the vast majority of cases
[2012-03-05 20:18:00 -0500] holoway: it's a raw disk
[2012-03-05 20:18:00 -0500] holoway: it's not like an NFS mount
[2012-03-05 20:18:00 -0500] AntonZ: you read my mind about nfs mount.. would be so nice if they let do that
[2012-03-05 20:20:00 -0500] Brad_K: the one commercial solution i've found so far that does support Linux is from JungleDisk, which was bought by Rackspace.  Only problem is, it is still server pull initiated, and intended for Linux workstations, not Linux servers.  trust me, we've gone over this time after time with the Rackspace guys, and they just don't get the fact that their backup solutions don't actually work for us.
[2012-03-05 20:23:00 -0500] Viral1: Q: Are `ruby_block`'s evaluated with the same context as the recipe (are local vars available?)
[2012-03-05 20:28:00 -0500] flagg0204: when dealing with libraries in chef. are all the attributes automagically brought into the libararies namespace
[2012-03-05 20:28:00 -0500] flagg0204: ?
[2012-03-05 20:29:00 -0500] fujin: no
[2012-03-05 20:43:00 -0500] flagg0204: fuji so if i wanted to reference node['fqdn'] in a library how would i got about that
[2012-03-05 20:47:00 -0500] Viral1: @flagg0204: pass in the fqdn via the resource?
[2012-03-05 21:12:00 -0500] savant: is there a way to suppress errors from an Execute resource?
[2012-03-05 21:13:00 -0500] savant: I have ignore_failure => true, but that does not suppress the warnings that occur in these commands
[2012-03-05 21:15:00 -0500] Viral1: @savant like what kind of error? ignore_failure should do that
[2012-03-05 21:15:00 -0500] trotter: Anyone know why the mysql cookbook isn't accessible via the /v1/ api? http://community.opscode.com/api/v1/cookbooks/msyql
[2012-03-05 21:15:00 -0500] trotter: Other cookbooks, such as `rbenv` are accessible so it seems the api is up
[2012-03-05 21:15:00 -0500] savant: Viral1: https://gist.github.com/ec3fa1c2334fc2948d83
[2012-03-05 21:16:00 -0500] dwhsix: speaking of execute is there any way to get stdout?  seems like it's swallowed...
[2012-03-05 21:16:00 -0500] dwhsix: I'm having a devil of a time debugging the bluepill lwrp
[2012-03-05 21:17:00 -0500] dwhsix: seems like the execute's aren't if I switch to shelling out some other way, the commands are executing
[2012-03-05 21:17:00 -0500] Viral1: @dwhsix: i wish, try using not_if "command"
[2012-03-05 21:18:00 -0500] Viral1: @savant weird, i'm not sure, maybe it's inside a provider resource that doesnt have ignore_failure set, sorry
[2012-03-05 21:18:00 -0500] savant: I created a definition
[2012-03-05 21:19:00 -0500] savant: which calls execute
[2012-03-05 21:19:00 -0500] savant: the execute command has ignore_failure set
[2012-03-05 21:19:00 -0500] dwhsix: Viral1: hmm that seems very hacky ;-)
[2012-03-05 21:19:00 -0500] savant: and that execute command is wrapped in a begin/rescue block
[2012-03-05 21:20:00 -0500] Viral1: @savant sorry, i'm not sure then
[2012-03-05 21:21:00 -0500] savant: oks
[2012-03-05 21:21:00 -0500] Viral1: @dwhsix: kind of but i'm not sure of a wait to get the stdout otherwise, you could try a ruby_block,
[2012-03-05 21:21:00 -0500] savant: no problem
[2012-03-05 21:26:00 -0500] dwhsix: okay, now something is *very* weird I put a non-existent command in the execute() inside the bluepill lwrp's :restart action, and it doesn't complain at all
[2012-03-05 22:14:00 -0500] sivy: man, i'm not groking notifications, or at least, not seeing my recipe behave in the way I expect
[2012-03-05 22:15:00 -0500] sivy: i've got 4 resources in a recipe, "chained" with notifcations
[2012-03-05 22:15:00 -0500] sivy: and while the first one fires, the rest do not
[2012-03-05 22:15:00 -0500] sivy: https://gist.github.com/1981532
[2012-03-05 22:15:00 -0500] sivy: (i mean, the "triggering" directory resource)
[2012-03-05 22:19:00 -0500] savant: <3 chef roles
[2012-03-05 22:19:00 -0500] savant: { "box_name": "bee-ec2-04", "recipes": [ "role[bee]" ] }
[2012-03-05 22:19:00 -0500] savant: linning
[2012-03-05 22:25:00 -0500] caryp: Has anyone ever published any Chef design patterns?
[2012-03-05 22:32:00 -0500] Viral1: @caryp : there are none
[2012-03-05 22:32:00 -0500] sivy: caryp: there is no spoon
[2012-03-05 22:32:00 -0500] Viral1: @caryp: grab code, punch it till it works, repeat
[2012-03-05 22:32:00 -0500] sivy: Viral1: ha!
[2012-03-05 22:33:00 -0500] caryp: hahaha
[2012-03-05 22:33:00 -0500] caryp: thx
[2012-03-05 22:44:00 -0500] fujin: I keep my DP locked down, that's cash money shit
[2012-03-05 22:45:00 -0500] fujin: you might be able to guess what some of them look like with the goodies i release ^_^
[2012-03-05 22:46:00 -0500] sivy: fujin: :)
[2012-03-05 22:47:00 -0500] sivy: fujin: do you see anything wack in that gist above? https://gist.github.com/1981532 my notifications don't seem to be firing
[2012-03-05 22:48:00 -0500] Viral1: does anyone here auto-scale?
[2012-03-05 22:48:00 -0500] asg: FSVO auto
[2012-03-05 22:49:00 -0500] Viral1: @asg hmm, so you do?
[2012-03-05 22:49:00 -0500] asg: sivy: if the directory resource runs but no other, I'd suspect the 'only_if { deploy_key }' line.
[2012-03-05 22:50:00 -0500] fujin: me too, but the not_if shouldn't be affected on the notification from the directory
[2012-03-05 22:50:00 -0500] fujin: err, the notified action shouldn't be affected by the not_if, I mean
[2012-03-05 22:50:00 -0500] fujin: sivy:  I have seen some trouble with that style of notifications ("foo[bar]") instead of resources(:foo => "bar") with immediate notifications
[2012-03-05 22:51:00 -0500] fujin: I guess habits are hard to break, I always use the original style
[2012-03-05 22:51:00 -0500] asg: fujin: there you go with those DPs again :)
[2012-03-05 22:51:00 -0500] fujin: someone has gotta do it ^_^
[2012-03-05 22:52:00 -0500] fujin: I mean, the rest of it :)
[2012-03-05 22:52:00 -0500] asg: Viral1: What I meant to say was 'In what context are you referring to auto-scaling'?
[2012-03-05 22:52:00 -0500] fujin: sivy: kinda looks like the log from the directory resource is missing, too
[2012-03-05 22:52:00 -0500] fujin: sivy: can you post the full debug output, not just info ?
[2012-03-05 22:52:00 -0500] fujin: oh, that is debug
[2012-03-05 22:55:00 -0500] Viral1: @asg: something like having a daemon that provision new nodes when needed
[2012-03-05 22:58:00 -0500] Viral1: @asg: I've have that done for the most part. I'm interested how resources are applied to those nodes afterwords
[2012-03-05 23:01:00 -0500] asg: Viral1: generally, roles are used to config resources. For example, you have a base image that needs to be a cache server. You bring up the base image and then use some 'cache_server' role. Depending on how dynamic your traffic is, you might just use chef to configure image snapshots and then just instantiate them as needed.
[2012-03-05 23:02:00 -0500] sivy: fujin: yeah, once sec
[2012-03-05 23:02:00 -0500] sivy: fujin: i switched to the old-style notification, and rerunning now
[2012-03-05 23:02:00 -0500] sivy: will post output
[2012-03-05 23:03:00 -0500] sivy: fujin: here it comes
[2012-03-05 23:03:00 -0500] sivy: https://gist.github.com/307419238f5a4d6e2a91 <- the whole enchilada
[2012-03-05 23:04:00 -0500] Viral1: @asg thanks
[2012-03-05 23:04:00 -0500] asg: Viral1: also, you may need to mediate config changes on other nodes to let them know about new nodes; some use chef for that, some use Zookeeper or Noah
[2012-03-05 23:04:00 -0500] sivy: and the new recipe bits:
[2012-03-05 23:04:00 -0500] sivy: https://gist.github.com/074eb707fc11cd42cb4a
[2012-03-05 23:04:00 -0500] Viral1: @asg: yah i was looking itno zookeeper
[2012-03-05 23:08:00 -0500] sivy: fujin: thoughts?
[2012-03-05 23:08:00 -0500] fujin: lookin
[2012-03-05 23:09:00 -0500] sivy: much thanks
[2012-03-05 23:09:00 -0500] sivy: my rain hurts
[2012-03-05 23:09:00 -0500] sivy: also, my brain
[2012-03-05 23:09:00 -0500] fujin: sivy: definitely looks like that git resource is blocking the checkout action from being notified on it
[2012-03-05 23:09:00 -0500] fujin: can you try w/o the not_if ? I don't know why that would be happening, seems broken
[2012-03-05 23:09:00 -0500] fujin: trying to reproduce in minimal case
[2012-03-05 23:10:00 -0500] sivy: fujin: you mean the only_if?
[2012-03-05 23:11:00 -0500] sivy: fujin: here's the whole recipe:
[2012-03-05 23:11:00 -0500] sivy: https://gist.github.com/7bf46d4f59ea9b2054b8
[2012-03-05 23:12:00 -0500] fujin: sivy: https://gist.github.com/19f28868838bebc0c38f
[2012-03-05 23:13:00 -0500] sivy: fujin: yeah, that's what I expected to happen :)
[2012-03-05 23:14:00 -0500] sivy: will try without the only_if
[2012-03-05 23:14:00 -0500] fujin: i will put together a smaller case that uses git as well
[2012-03-05 23:16:00 -0500] halfamind-desk: Hi #chef. What's the suggested method for displaying output during a chef-solo run?
[2012-03-05 23:16:00 -0500] sivy: fujin: yeah, it's weird i took out the only if and still, nothing. i also don't see the "sending <action> action" after the firecotry resource runs
[2012-03-05 23:16:00 -0500] fujin: sivy: right, I would definitely expect to see that log line (per my shef gist)
[2012-03-05 23:16:00 -0500] sivy: i would expect to at least see one "sending :checkout action..."
[2012-03-05 23:17:00 -0500] sivy: firecotry? wtf sivy
[2012-03-05 23:17:00 -0500] asg: sivy: may be a silly question but does the directory exist already?
[2012-03-05 23:17:00 -0500] sivy: asg: yeah atm it does
[2012-03-05 23:18:00 -0500] fujin: sivy: does the directory exist or something like that, per chance, and that is causing the notification not to fire?
[2012-03-05 23:18:00 -0500] fujin: note that :create won't trigger an update if the dir already exists, etc
[2012-03-05 23:18:00 -0500] sivy: yeah, it probably does now
[2012-03-05 23:18:00 -0500] sivy: ooooh shit
[2012-03-05 23:18:00 -0500] asg: sivy: remove, rinse and repeat?
[2012-03-05 23:18:00 -0500] fujin: just bad idempotency wiring :)
[2012-03-05 23:18:00 -0500] asg: or chmod it to something that isn't 777
[2012-03-05 23:19:00 -0500] fujin: that too
[2012-03-05 23:19:00 -0500] fujin: a mode change will trigger the notif
[2012-03-05 23:19:00 -0500] fujin: the cookbook should probably work if the directory exists, though, right ?
[2012-03-05 23:19:00 -0500] sivy: yeah, it should :-)
[2012-03-05 23:20:00 -0500] sivy: i got into all this notification junk b/c for some reason it was trying to run the pip code before the directory even got created, or the codebase checked out
[2012-03-05 23:20:00 -0500] sivy: (FYI- deleting the dir triggered everything)
[2012-03-05 23:21:00 -0500] sivy: [Mon, 05 Mar 2012 15:21:57 -0800] INFO: directory[/var/pushcode/pushcode] sending checkout action to git[/var/pushcode/pushcode] (immediate)
[2012-03-05 23:21:00 -0500] sivy: [Mon, 05 Mar 2012 15:22:18 -0800] INFO: git[/var/pushcode/pushcode] sending create action to python_virtualenv[/var/pushcode/pushcode/virtual] (immediate)
[2012-03-05 23:21:00 -0500] sivy: [Mon, 05 Mar 2012 15:22:18 -0800] INFO: python_virtualenv[/var/pushcode/pushcode/virtual] sending install action to python_pip[/var/pushcode/pushcode/deploy_requirements.txt] (immediate)
[2012-03-05 23:21:00 -0500] fujin: shananan!
[2012-03-05 23:22:00 -0500] fujin: there ya go. neato
[2012-03-05 23:22:00 -0500] sivy: fujin: so, what's a better way to chain those notifications without it having to run fresh each time
[2012-03-05 23:22:00 -0500] fujin: probably chain the notifications off the git :sync action
[2012-03-05 23:22:00 -0500] fujin: which'll trigger whenever it deploys a ref to the local repo
[2012-03-05 23:23:00 -0500] fujin: the damn directory can't exist if you don't clone into it, so it makes sense to me :)
[2012-03-05 23:25:00 -0500] sivy: huh, kinda forgot about that (clone creates the directory)
[2012-03-05 23:26:00 -0500] asg: problem solved, sivy wins ... It's Miller Time!
[2012-03-05 23:26:00 -0500] sivy: fujin: so, if i'm finally understanding this right, can I have :clone and :sync in the same git resource?
[2012-03-05 23:26:00 -0500] fujin: of course, :sync implies :clone
[2012-03-05 23:26:00 -0500] sivy: so that it clones if it doesn't exist, and yncs if it does
[2012-03-05 23:26:00 -0500] sivy: oh
[2012-03-05 23:27:00 -0500] sivy: TIL
[2012-03-05 23:27:00 -0500] sivy: i'm only about 3 weeks into chef, pradon my ignorance)
[2012-03-05 23:27:00 -0500] sivy: pardon (and my typing)
[2012-03-05 23:27:00 -0500] sivy: pheh
[2012-03-05 23:27:00 -0500] sivy: :)
[2012-03-05 23:27:00 -0500] fujin: haha, no worries. it's pretty specific knowledge
[2012-03-05 23:27:00 -0500] fujin: deploy?
[2012-03-05 23:27:00 -0500] bawt: deploy is http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-03-05 23:27:00 -0500] fujin: syncUpdate the source to the specified revision, or get a new clone/checkout
[2012-03-05 23:27:00 -0500] sivy: fujin: i'm familiar with it
[2012-03-05 23:28:00 -0500] sivy: technically I'm going to be using fabric on an ongoing basis, so this is *mostly* a first-time build thing
[2012-03-05 23:28:00 -0500] fujin: ah, gross
[2012-03-05 23:28:00 -0500] sivy: though i want it to work if i need to update existing nodes
[2012-03-05 23:28:00 -0500] sivy: he, be nice
[2012-03-05 23:29:00 -0500] fujin: lol~
[2012-03-05 23:29:00 -0500] fujin: definitely new here eh- fujin, nice? :)
[2012-03-05 23:29:00 -0500] fujin: so you're going to use fabric to manage deploys and ad-hoc stuff once chef has shipped it?
[2012-03-05 23:29:00 -0500] fujin: how do you maintain state between fabric and chef ?
[2012-03-05 23:29:00 -0500] fujin: felt very much like python crapistrano
[2012-03-05 23:30:00 -0500] aslan: hi guys... i am having an issue with delayed tasks in here https://gist.github.com/abbccd7b1ca8190790f1 i have 3 changes to the apache configuration that each requires a restart and they are all delayed. in the logs it seems that there are 3 restarts and chef didn't wrap them all into one restart
[2012-03-05 23:30:00 -0500] sivy: fujin: it's a bit like capistrano, though a little less ambitious IMO
[2012-03-05 23:31:00 -0500] sivy: fujin: and right now it's what i know. I'm a one-man-band here, so spending months tweaking chef costs me $$
[2012-03-05 23:31:00 -0500] fujin: got ya
[2012-03-05 23:31:00 -0500] fujin: that's fair I suppose ;)
[2012-03-05 23:31:00 -0500] sivy: you're too ind :)
[2012-03-05 23:31:00 -0500] fujin: aslan: the first one is a reload, not sure about the other ones
[2012-03-05 23:32:00 -0500] fujin: sivy: to be fair, I don't really have a solution that I'm happy with for managing ad-hoc deploys of code (orchestration)
[2012-03-05 23:32:00 -0500] asg: at least with fabric, you can convincingly code a 'fab five' command
[2012-03-05 23:32:00 -0500] sivy: lulz
[2012-03-05 23:32:00 -0500] fujin: my general line of thinking is to build binary assets of the stuff I'm deploying, and make that available over a relatively fast channel
[2012-03-05 23:32:00 -0500] fujin: I have some other stuff in the pipe that builds around that, but mostly speculative/for/fun/hacking
[2012-03-05 23:32:00 -0500] sivy: fujin: sure, and if you're dealing with a rack of (virtual) servers that's smart
[2012-03-05 23:33:00 -0500] sivy: I don't have a lot of instance sto manage right now
[2012-03-05 23:33:00 -0500] fujin: got ya
[2012-03-05 23:33:00 -0500] fujin: so why not just chef then ?
[2012-03-05 23:34:00 -0500] sivy: fujin: my worksflow is: write feature, test locally, checkin, then "fab push stage deploy", test on stage, then "fab prod deploy"
[2012-03-05 23:35:00 -0500] sivy: and it takes care of pushing the code, restarting services, etc
[2012-03-05 23:35:00 -0500] fujin: right but you could manage all the code and the services where you actually manage your infrastructure, in chef, and have it tracking particular branches or whatever.
[2012-03-05 23:35:00 -0500] fujin: it's not much work to signal chef to run, and you get all the benefits of resources that you are already managing
[2012-03-05 23:35:00 -0500] sivy: i could see doind that in chef but i've got a few hundred lines of python already doing this stuff, so don't want o swtich right now
[2012-03-05 23:35:00 -0500] aslan: fujin: i added the part that trigers those actions : https://gist.github.com/abbccd7b1ca8190790f1
[2012-03-05 23:35:00 -0500] fujin: plus you don't have two origins of truth
[2012-03-05 23:36:00 -0500] fujin: aslan: cool, now put the whole log with -l DEBUG so it's actually useful
[2012-03-05 23:36:00 -0500] fujin: instead of bits you think are relevant
[2012-03-05 23:38:00 -0500] aslan: fujin: this is from a AMI i made that starts chef without debug flag. and it only happens one time. next time i run chef everything is fixed
[2012-03-05 23:38:00 -0500] fujin: cool
[2012-03-05 23:38:00 -0500] fujin: i'm out
[2012-03-05 23:38:00 -0500] fujin: gl
[2012-03-05 23:38:00 -0500] sivy: later fujin - thx
[2012-03-05 23:38:00 -0500] aslan: fujin: so my problem is that my servers (40% of the time) dont come up on the first chef run but they become available on the second run
[2012-03-05 23:40:00 -0500] scottbessler: aslan, i'd make the ami with debug on :)
[2012-03-05 23:40:00 -0500] asg: aslan: so, you could build and AMI with debug so we can see what's going on or just build your AMIs to run chef twice (former is preferrable.)
[2012-03-05 23:41:00 -0500] aslan: asg: what do you mean have chef run twice?
[2012-03-05 23:42:00 -0500] sivy: when passing true or false to a resource in an attribute, does it need :? (:true or true) # noob rubyist
[2012-03-05 23:44:00 -0500] asg: aslan: node starts, runs chef-client (I assume). Then you have it run chef-client again.
[2012-03-05 23:45:00 -0500] aslan: asg: i use sv to kick start my chef client
[2012-03-05 23:45:00 -0500] aslan: asg: it runs every 30 min
[2012-03-05 23:45:00 -0500] asg: aslan: the real solution is to setup an AMI with debug so we can help get to the bottom of the issue
[2012-03-05 23:45:00 -0500] aslan: asg: alright i think i need to do that
[2012-03-05 23:47:00 -0500] laurent\: sivy: if it's supposed to be the boolean thing => true / false
[2012-03-05 23:49:00 -0500] sivy: laurent\: thanks sir
[2012-03-05 23:52:00 -0500] laurent\: sivy: you use irb or shef to experiment, for instance you could try something like: puts "ok" if :false
[2012-03-05 23:54:00 -0500] laurent\: or :false.class or false.to_s.to_sym :)
[2012-03-05 23:57:00 -0500] sivy: heh
[2012-03-05 23:59:00 -0500] jtimberman: false and nil are not true.
[2012-03-05 23:59:00 -0500] jtimberman: everything else is true.
