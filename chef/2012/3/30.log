[2012-03-30 00:00:03 -0400] ryan-eme: LawrenceSeattle: I'm trying to do something similar
[2012-03-30 00:00:28 -0400] LawrenceSeattle: ryan-eme: any luck? I don't see a good mechanism
[2012-03-30 00:00:55 -0400] ryan-eme: I haven't gotten very far yet
[2012-03-30 00:01:39 -0400] ryan-eme: but the plan is to have deployinator initiate a chef run via knife
[2012-03-30 00:02:03 -0400] ryan-eme: and then have the same deployinator stack add it to my load balancer
[2012-03-30 00:13:48 -0400] jmontross: does chef have built in git ?
[2012-03-30 00:13:59 -0400] paulmooring: jmontross: no
[2012-03-30 00:14:06 -0400] jmontross: I'd like to not use backticks in my recipe for doing git stuff
[2012-03-30 00:14:08 -0400] paulmooring: it has a git resource tupe
[2012-03-30 00:14:55 -0400] paulmooring: jmontross: you can download from a git server uses built in resources
[2012-03-30 00:15:33 -0400] paulmooring: http://wiki.opscode.com/display/chef/Deploy+Resource#DeployResource-DeployResource
[2012-03-30 00:15:46 -0400] paulmooring: That has some examples since I can't type correctly today
[2012-03-30 00:16:49 -0400] jmontross: what i'm trying to do is update if the tags are not up to date with current tagged release
[2012-03-30 00:17:02 -0400] jmontross: I see the git blocks.. thanks
[2012-03-30 00:17:16 -0400] jmontross: looks like revision "HEAD" might tell me some stuff
[2012-03-30 00:47:05 -0400] tolland: are there any ideas for adding a /test folder under a bookbook?
[2012-03-30 01:03:48 -0400] bendrix415: ?
[2012-03-30 01:13:59 -0400] sivy: evenin
[2012-03-30 01:16:12 -0400] sivy: i've seen some references to this error online, but I still don't understand how cookbook_file is supposed to work: https://gist.github.com/2244764 (chef complains that it's not finding the files in files/ubuntu10.04, files/ubuntu, or files/default, even though the files are in files/default in the cookbook)
[2012-03-30 01:16:31 -0400] sivy: any tips would be appreciated
[2012-03-30 01:33:01 -0400] hippiehacker: if I want to use a gem in mycookbook/library/, how do I get it installed before chef-client tries to automagically load (and fail) a gem that includes it?
[2012-03-30 01:36:11 -0400] hoover_damm: hippiehacker, aws cookbook has a pattern you can follow
[2012-03-30 01:36:15 -0400] hoover_damm: you might not like it, but it works
[2012-03-30 01:36:23 -0400] hippiehacker: hoover_damm: I'll take a look
[2012-03-30 01:37:12 -0400] hoover_damm: hippiehacker, https://github.com/opscode-cookbooks/aws/blob/master/recipes/default.rb
[2012-03-30 01:37:15 -0400] hoover_damm: old trick
[2012-03-30 01:39:44 -0400] hippiehacker: hoover: I already do that, the problem is that recipes are run until after libaries are loaded
[2012-03-30 01:40:11 -0400] hippiehacker: and if the library tries to load it and fails, you never get to the recipe
[2012-03-30 01:40:47 -0400] hippiehacker: i meant: recipes are not run until _after_ libraries are loaded
[2012-03-30 01:41:57 -0400] hoover_damm: https://github.com/opscode-cookbooks/aws/blob/master/libraries/ec2.rb
[2012-03-30 01:41:58 -0400] hoover_damm: right
[2012-03-30 01:42:02 -0400] hoover_damm: and they rescue the loaderror
[2012-03-30 01:42:34 -0400] hippiehacker: ahh got it
[2012-03-30 01:42:40 -0400] hoover_damm: and since each provider includes that
[2012-03-30 01:42:45 -0400] hoover_damm: it must reinitalize that a lot?
[2012-03-30 01:43:04 -0400] hoover_damm: hth
[2012-03-30 02:19:04 -0400] reset: I'm working on a cookbook to install OSX GCC on 10.7 or 10.6 - it makes sense that this would become part of build-essential instead. Any opinions?
[2012-03-30 02:24:57 -0400] edibrac: does chef already talk to vmware esx4i or esx5i or even esx4?
[2012-03-30 02:27:44 -0400] miah: guh. did oracle break the java cookbook already?
[2012-03-30 05:14:13 -0400] Anand: when i delete the instance, the hosted chef server doesnt update the node list...i.e. it should delete it from the node list which is not happening right now. should i execute the additional command for that??
[2012-03-30 05:20:00 -0400] BryanWB: ohai chefs!
[2012-03-30 05:20:05 -0400] BryanWB: miah: yes
[2012-03-30 05:20:24 -0400] BryanWB: u have to host your own tarball for the jdk
[2012-03-30 05:20:46 -0400] BryanWB: and override the url attribute for the java cookbook
[2012-03-30 05:26:27 -0400] BryanWB: edibrac: there are knife plugins for esx
[2012-03-30 05:28:59 -0400] edibrac: ooo neeto. from googling it, looks like it does esxi also
[2012-03-30 05:30:21 -0400] BryanWB: edibrac: there are several, make sure u take a look at rubiojr's plugins for esx
[2012-03-30 06:07:48 -0400] rahul: hi
[2012-03-30 06:08:00 -0400] rahul: i am new to chef
[2012-03-30 06:08:20 -0400] miah: hrm
[2012-03-30 06:08:23 -0400] rahul: i am having a problem with creating windows server thru chef knife on rackspace
[2012-03-30 06:08:41 -0400] miah: ya. i've been wiresharking for a bit. looking at how oracle is making me cry
[2012-03-30 06:09:26 -0400] erikh: sorry, you'll need to consult the manual for more information on ORA-WAAAH
[2012-03-30 06:09:32 -0400] erikh: :P
[2012-03-30 06:09:45 -0400] rahul: after creating server the knife plugin keeps on waiting for ssh demon.. its not able to bootstrap windows mahchine
[2012-03-30 06:09:53 -0400] rahul: can any on help me on this?
[2012-03-30 06:10:02 -0400] BryanWB: miah: when u have a few mins, i would love to ask u some qs about haproxy
[2012-03-30 06:11:18 -0400] miah: k
[2012-03-30 06:11:38 -0400] miah: pm or im me
[2012-03-30 06:11:43 -0400] BryanWB: miah: how do u lb b/w your haproxy instances? are they active/active or active/passive
[2012-03-30 06:11:56 -0400] miah: all active
[2012-03-30 06:12:22 -0400] BryanWB: how do u do that? need special networking config on switches in front of haproxy?
[2012-03-30 06:13:28 -0400] miah: im all on ec2
[2012-03-30 06:13:45 -0400] miah: so its weighted roundrobin dns.. possibly not the best way
[2012-03-30 06:13:51 -0400] miah: but it seems to work
[2012-03-30 06:13:56 -0400] BryanWB: ah, that explains it
[2012-03-30 06:14:24 -0400] BryanWB: b/w haproxy and ur jetty do u have apache/nginx? or just haproxy -> jetty?
[2012-03-30 06:15:22 -0400] miah: haproxy -> jetty
[2012-03-30 06:15:39 -0400] BryanWB: sweet, and u don't miss any url rewriting features?
[2012-03-30 06:15:57 -0400] miah: well, i deal mostly with a resful api
[2012-03-30 06:16:05 -0400] miah: so its not much rewriting as it is routing
[2012-03-30 06:16:13 -0400] BryanWB: hmm, we have some bloody SOAP
[2012-03-30 06:16:26 -0400] miah: soap always tastes bad
[2012-03-30 06:16:30 -0400] BryanWB: it does, gross
[2012-03-30 06:16:41 -0400] miah: i wonder how oracle generates this AuthParam
[2012-03-30 06:16:44 -0400] BryanWB: i start w/ haproxy, then add apache later if i need it
[2012-03-30 06:16:47 -0400] BryanWB: javascript!
[2012-03-30 06:17:07 -0400] BryanWB: but it would be neat if u could fake it
[2012-03-30 06:17:23 -0400] miah: ya i can't find the javascript that generates the code
[2012-03-30 06:17:38 -0400] miah: no need to fake it if we can see how its generated
[2012-03-30 06:20:06 -0400] BryanWB: hideAgreementDiv(doc, part);
[2012-03-30 06:20:06 -0400] BryanWB: writeSessionCookie( 'oraclelicense' + part, 'accept-securebackup-cookie' );
[2012-03-30 06:20:36 -0400] BryanWB: the acceptAgreement function is in the html body
[2012-03-30 06:21:52 -0400] miah: ya, but there is more
[2012-03-30 06:22:05 -0400] miah: a full url looks like this
[2012-03-30 06:22:06 -0400] miah: /otn-pub/java/jdk/6u31-b04/jdk-6u31-linux-x64.bin?AuthParam=1333087617_f3342cfc4f8648911c89aba4798457ad
[2012-03-30 06:22:26 -0400] miah: so, AuthParam is being generated somewhere, and its being used as a validation on the request
[2012-03-30 06:30:55 -0400] BryanWB: tks a ton for advice on haproxy it should save me a bunch of time
[2012-03-30 06:30:58 -0400] BryanWB: miah: ^^
[2012-03-30 06:31:43 -0400] miah: sure
[2012-03-30 06:31:49 -0400] miah: feel free to bug me any time
[2012-03-30 07:17:13 -0400] karmi: btm: Just for info, the AegisCo repos are out of date, probably, fails for me with>
[2012-03-30 07:17:13 -0400] karmi: http://rpm.aegisco.com/aegisco/rhel/latest/x86_64/repodata/repomd.xml: [Errno 14] PYCURL ERROR 22 - "The requested URL returned error: 404"
[2012-03-30 07:36:53 -0400] karmi: btm: Also, the problem is either fixed or depends on weather  just succesfully installed chef via the https://gist.github.com/2050769#file_bootstrap.sh script, and also have build a fully provisioned application node with our own regular scripts/recipes/etc.
[2012-03-30 09:09:49 -0400] karmi: btm & all: seems like the segmentation faults on Amazon Linux have been fixed by an update, https://forums.aws.amazon.com/thread.jspa?threadID=90714#jive-message-332311
[2012-03-30 10:54:30 -0400] sampikesley: OMG encrypted data bags are awesome
[2012-03-30 11:11:17 -0400] BryanWB: definitely
[2012-03-30 11:16:37 -0400] Anand: can we gove role in knife bootstrap --run_list command??
[2012-03-30 11:19:01 -0400] vdvluc: Anand: yes
[2012-03-30 11:36:12 -0400] jodell_: this might be a silly question but what is the 'right way' to initiate an explicit chef-client run on all nodes? (a la from a jenkins job)
[2012-03-30 11:39:56 -0400] BryanWB: knife ssh "*" chef-client -x root -i _private_key_
[2012-03-30 11:42:18 -0400] workmad3: jodell_: it's whether you want to initiate an explicit run from jenkins, or set up a chef-client service on your nodes to pick up changes
[2012-03-30 11:42:35 -0400] roidrage: i'm curious about that too. my chef-client runs as a service already
[2012-03-30 11:43:33 -0400] ajardan_: can anyone help me with this -> http://pastebin.com/nLzh3G7J stackstrace
[2012-03-30 11:44:06 -0400] ajardan_: I guess
[2012-03-30 11:44:13 -0400] ajardan_: in this file -> /usr/lib64/ruby/gems/1.8/gems/chef-0.10.4/bin/../lib/chef/mixin/template.rb
[2012-03-30 11:44:32 -0400] ajardan_: contextual_lines = lines[beginning_line, source_size] gets an empty result
[2012-03-30 11:44:34 -0400] ajardan_: but why ?
[2012-03-30 11:44:34 -0400] bawt: but why are you using ebs
[2012-03-30 11:45:14 -0400] ajardan_: ebs ?
[2012-03-30 11:45:14 -0400] bawt: ebs is just a wrapper over s3, basically :)
[2012-03-30 11:45:31 -0400] workmad3: ajardan_: that's a stacktrace in the middle of a template... I wouldn't trust what the stacktrace is telling you is the error, but instead 'cookbooks/backup/providers/files.rb line 7'
[2012-03-30 11:45:31 -0400] ajardan_: or I guess that's not for me
[2012-03-30 11:45:52 -0400] ajardan_: workmad3, there is the start of the template
[2012-03-30 11:46:01 -0400] ajardan_: a normal template resource
[2012-03-30 11:46:07 -0400] ajardan_: with variables, etc
[2012-03-30 11:46:24 -0400] workmad3: ajardan_: right, the error is likely in that template then ;)
[2012-03-30 11:46:45 -0400] workmad3: ajardan_: specifically, you're calling 'each_with_index' on something that in reality is 'nil' (probably something you expected to be an array)
[2012-03-30 11:47:11 -0400] ajardan_: not me, each_with_index is called by the script I pated above, in the
[2012-03-30 11:47:27 -0400] ajardan_: source_listing method
[2012-03-30 11:47:32 -0400] ajardan_: line 80
[2012-03-30 11:47:52 -0400] ajardan_: it assigns contextual_lines = lines[beginning_line, source_size]
[2012-03-30 11:48:00 -0400] ajardan_: and then makes contextual_lines.each_with_index do |line, index|
[2012-03-30 11:48:01 -0400] workmad3: ajardan_: no, that's just where the error has been re-raised from
[2012-03-30 11:48:06 -0400] ajardan_: where this error happens
[2012-03-30 11:49:05 -0400] ajardan_: I verified the template and etc, tried to make an error in it
[2012-03-30 11:49:09 -0400] ajardan_: receiving same thing
[2012-03-30 11:49:24 -0400] ajardan_: was thinking it can't find the source of the template, but it is in place
[2012-03-30 11:51:55 -0400] ajardan_: here is what starts in the line 7
[2012-03-30 11:51:56 -0400] ajardan_: http://pastebin.com/rDGHEfdq
[2012-03-30 11:57:23 -0400] ajardan_: hmm, with an empty template it works
[2012-03-30 11:57:38 -0400] ajardan_: so it looks I have an error in the template, but where...
[2012-03-30 12:04:58 -0400] ajardan_: omg I fixed it
[2012-03-30 12:05:12 -0400] ajardan_: nobody will ever know where the error was
[2012-03-30 12:53:29 -0400] BryanWB: roidrage: can u tell upstart _not_ to start at any runlevel w/out deleting the file in /etc/init ?
[2012-03-30 12:58:10 -0400] arussel: Hi, I'm getting started with chef and try to do something basic but keep running into problem.
[2012-03-30 12:58:13 -0400] sampikesley: isn't it just 'stop on runlevel [234]' or so?
[2012-03-30 12:58:34 -0400] arussel: My goal is to have oracle java 7 installed on the server
[2012-03-30 12:58:45 -0400] roidrage: BryanWB: yeah, if you don't specify any start on condition or simply an event that's unlikely to come up, it won't be started by default and can only be started manually
[2012-03-30 12:59:05 -0400] arussel: I found stuff aobut ark, java, ark_java, tried them all but still can't get oracle's java 7 on my server :(
[2012-03-30 12:59:21 -0400] arussel: where could I find some doc on it ?
[2012-03-30 13:00:38 -0400] BryanWB: roidrage: so u have to pick a real;ly obscure event
[2012-03-30 13:00:43 -0400] BryanWB: arussel: blame oracle
[2012-03-30 13:00:55 -0400] roidrage: BryanWB: or you don't have to pick any event
[2012-03-30 13:01:07 -0400] roidrage: if you leave out the start condition entirely it'll simply not start it automatically
[2012-03-30 13:01:14 -0400] BryanWB: arussel: i wrote that recipe, u have to download the tarball and put it on a http server u can download from
[2012-03-30 13:01:41 -0400] arussel: BryanWB: which recipe ? I'm not sure wich one to use.
[2012-03-30 13:02:20 -0400] BryanWB: java::oracle  is the one u use for oracle
[2012-03-30 13:02:43 -0400] BryanWB: arussel: i updated the readme here https://github.com/bryanwb/java
[2012-03-30 13:05:03 -0400] arussel: I'm still very new to all this. java is the name of the cookbook I'm using, java_ark is the command and java::oracle is bryan trying to confuse me with a new nomenclature ?
[2012-03-30 13:07:23 -0400] afallows: I don't know the details of the java cookbook you're using, but if it has a recipe called oracle you would run it with recipe[java::oracle] in the run_list
[2012-03-30 13:08:02 -0400] roidrage: shame upstart doesn't have alerts :/
[2012-03-30 13:08:38 -0400] arussel: I just need to re-read the doc again :-)
[2012-03-30 13:08:52 -0400] afallows: arussel: http://wiki.opscode.com/display/chef/Recipes#Recipes-UsingRecipes should be the most relevant thing
[2012-03-30 13:09:06 -0400] arussel: afallows: thanks
[2012-03-30 13:10:07 -0400] Anand: I am following this application : http://wiki.opscode.com/display/chef/Build+A+Java+Web+Stack
[2012-03-30 13:10:44 -0400] Anand: my question how the web app can know where is the database resides?? and where to connect??
[2012-03-30 13:11:35 -0400] Anand: where is that configuration?
[2012-03-30 13:16:36 -0400] Xajin: Is there any good articles/white papers on why chef went with ruby for a language?  Still trying to decide what I want to be when I grow up and looking at different languages.  Love Linux, Love Automation, looking at Chef, Puppet, CFengine.
[2012-03-30 13:17:15 -0400] BryanWB: Xajin: http://www.foodfightshow.org/2012/02/episode-3-usrbinruby-for-sysadmins-with.html
[2012-03-30 13:17:44 -0400] Xajin: BryanWB Thank you for that response.
[2012-03-30 13:17:52 -0400] atomic-penguin: BryanWB, did you find a suitable benchmark for your NFS server?
[2012-03-30 13:18:45 -0400] BryanWB: atomic-penguin: no, i should probably tyr to get my devs to explain their use case better, if they can
[2012-03-30 13:21:22 -0400] BryanWB: the only fs benchmarking tool i have ever used is bonnie++
[2012-03-30 13:22:45 -0400] atomic-penguin: I'm usually testing, does this path failover or not
[2012-03-30 13:24:19 -0400] atomic-penguin: As long as the numbers aren't insanely low for something, I usually don't care.
[2012-03-30 13:27:26 -0400] atomic-penguin: Oracle's database load simulator I couldn't even figure out if it was doing anything, zero feedback.
[2012-03-30 13:27:49 -0400] atomic-penguin: Haven't really found a good DB I/O simulator for benching/testing
[2012-03-30 13:29:11 -0400] jodell_: workmad3: an explicit run. chef-client is already daemonized but i want a complete git push -> jenkins synchronize chef-server + chef-client run feedback loop (like traditional CI)
[2012-03-30 13:29:55 -0400] arussel: BryanWB: I don't see where I can give the credentials to fetch the tar ball.
[2012-03-30 13:30:49 -0400] BryanWB: arussel: u can't
[2012-03-30 13:31:09 -0400] BryanWB: arussel: u have to download it manually and it put it on an http server under your control
[2012-03-30 13:31:20 -0400] atomic-penguin: dbench comes with an NFS load file by the way, BryanWB
[2012-03-30 13:31:42 -0400] BryanWB: atomic-penguin: tks, i m so ignorant about FS-level stuff
[2012-03-30 13:31:42 -0400] arussel: BryanWB: I did, the server is uner our control but not on our private network.
[2012-03-30 13:31:51 -0400] arussel: we don't have a private network
[2012-03-30 13:32:09 -0400] BryanWB: arussel: put it on s3 then
[2012-03-30 13:33:07 -0400] arussel: or find a recipe that can fetch a file using login/password
[2012-03-30 13:33:35 -0400] BryanWB: arussel: u need javascript to access the oracle download, to accept the legal agreement
[2012-03-30 13:34:01 -0400] BryanWB: which means installing firefox, watir-webdriver, and at very least Xvfb
[2012-03-30 13:34:01 -0400] atomic-penguin: is the Java recipe broke again, then?
[2012-03-30 13:34:10 -0400] BryanWB: atomic-penguin: yup, fuckin' oracle
[2012-03-30 13:35:02 -0400] arussel: BryanWB: no, I did what you said, I got the tar.gz and put on our server, but I still need to give credential to access it.
[2012-03-30 13:35:34 -0400] arussel: (the node needs the credential to be precise)
[2012-03-30 13:35:41 -0400] BryanWB: my recipe doesn't handle basic http authentication
[2012-03-30 13:35:43 -0400] BryanWB: sorry
[2012-03-30 13:36:00 -0400] arussel: no worries :-) , I'm sure I can find a wget recipe.
[2012-03-30 13:36:16 -0400] BryanWB: u can also substiute a local file path if the file is already on your server
[2012-03-30 13:36:31 -0400] BryanWB: but u have to use HEAD from my master on github for that
[2012-03-30 13:37:15 -0400] arussel: with the last release version I can't substritue 'http://foo/bar' with 'file://foo/bar' ?
[2012-03-30 13:37:56 -0400] BryanWB: i just added it to my master last night, put '/tmp/foo/jdk....tar.gz'
[2012-03-30 13:38:01 -0400] BryanWB: not file://
[2012-03-30 13:38:08 -0400] BryanWB: but that's a good idea ;)
[2012-03-30 13:38:44 -0400] arussel: I don't know much about ruby but in java, it would be the exact same code, using a URL object.
[2012-03-30 13:39:10 -0400] BryanWB: that's not ruby-specifice, that's bryanwb-specific
[2012-03-30 13:39:17 -0400] BryanWB: just how i chose to write the recipe
[2012-03-30 13:46:17 -0400] atomic-penguin: Well the "url" variable is being passed to the remote_file resource as a source attribute.  arussel, see http://wiki.opscode.com/display/chef/Resources#Resources-RemoteFile.  "Remote File" resource probably does not support file:/// syntax, doesn't really make sense to fetch a remote file that way.
[2012-03-30 13:47:36 -0400] BryanWB: atomic-penguin: makes sense if u r trying to tell remote_file the file isn't remote
[2012-03-30 13:47:47 -0400] BryanWB: but then better to not use remote_file
[2012-03-30 13:47:55 -0400] atomic-penguin: http://www.ruby-doc.org/stdlib-1.9.3/libdoc/net/http/rdoc/Net/HTTP.html
[2012-03-30 13:48:01 -0400] atomic-penguin: Search for Basic Authentication
[2012-03-30 13:48:05 -0400] BryanWB: i plan to add additional attribute to use for local files
[2012-03-30 13:48:12 -0400] atomic-penguin: That is probably going to be the only way to get it from Oracle now
[2012-03-30 13:48:35 -0400] BryanWB: atomic-penguin: if u have logon, u don't have to accept legal agreement?
[2012-03-30 13:48:38 -0400] atomic-penguin: Or patch the Remote File resource to support authentication
[2012-03-30 13:48:55 -0400] blackjid: Hi, Should I use roles to create per project roles?
[2012-03-30 13:48:59 -0400] BryanWB: i mean if u have logon to oracle website
[2012-03-30 13:49:10 -0400] atomic-penguin: I need to examine it closer
[2012-03-30 13:49:19 -0400] BryanWB: probably not worth the time
[2012-03-30 13:49:34 -0400] BryanWB: i won't invest more time in trying to download from their site
[2012-03-30 13:49:40 -0400] arussel: atomic-penguin: you put me on the right direction, http_request does get a remote file with authorization :-)
[2012-03-30 13:49:43 -0400] arussel: thanks
[2012-03-30 13:49:49 -0400] atomic-penguin: They'll just change it again to spite you, BryanWB
[2012-03-30 13:49:58 -0400] BryanWB: probably1
[2012-03-30 13:51:10 -0400] afallows: blackjid: The cool thing about roles is that you can have other roles in the run list of a role, so you can break projects down in a tree-like fashion. Roles are really good for breaking out levels of behavior.
[2012-03-30 13:56:33 -0400] blackjid: afallows: so you can use roles for project1, project2, project3, but also for webserver, db, etc.. and combine them...? something like that?
[2012-03-30 13:57:39 -0400] sampikesley: roles are amazingly flexible
[2012-03-30 13:58:08 -0400] sampikesley: afallows is right, make small ones and then pull them together for a particular node
[2012-03-30 14:00:02 -0400] blackjid: for example can I use a role only to setup attributes for a specific project and then run roles for provisioning different applications to the node?
[2012-03-30 14:01:57 -0400] afallows: Sure. You could have role[project-name] and role[software-package], and include the software packeg role in the project role.
[2012-03-30 14:02:09 -0400] afallows: package, even
[2012-03-30 14:02:30 -0400] sampikesley: you don't have to think heirarchically
[2012-03-30 14:02:35 -0400] sampikesley: sp?
[2012-03-30 14:02:48 -0400] blackjid: sp?
[2012-03-30 14:02:53 -0400] blackjid: sorry
[2012-03-30 14:02:53 -0400] sampikesley: spelling
[2012-03-30 14:03:09 -0400] blackjid: :)
[2012-03-30 14:03:13 -0400] sampikesley: think of N-Dimensional Role Space
[2012-03-30 14:03:16 -0400] afallows: hierarchically* ;)
[2012-03-30 14:04:13 -0400] sampikesley: be flexible
[2012-03-30 14:04:25 -0400] sampikesley: don't assume that you're going to get it right today
[2012-03-30 14:04:53 -0400] blackjid: I like that....
[2012-03-30 14:05:17 -0400] blackjid: when you try to do it right rightaway you get stuck....
[2012-03-30 14:05:29 -0400] blackjid: attributes defined in one role have effect in other roles? or they will be overrided when the next role is runned?
[2012-03-30 14:05:57 -0400] afallows: The thing is, roles are hierachical, but not -strictly-. Roles can be composed, but Role A can be a child of Role B and a child of Role C, and even if it's a child of both, it can be used on its own. I tend to think of roles as functional blocks ("This is a role to manage this software package", "This is a role to set up this type of server", etc).
[2012-03-30 14:06:16 -0400] afallows: And the cool thing is that those functional blocks can be at just about any level of abstraction.
[2012-03-30 14:07:36 -0400] afallows: More experienced cooks can tell me whether I'm right, but I think a good rule of thumb is "If it's likely that you're going to need it in more than one situation, it's work breaking out into its own role."
[2012-03-30 14:08:09 -0400] BryanWB: afallows: +1
[2012-03-30 14:08:25 -0400] BryanWB: and edit it as file under git control
[2012-03-30 14:08:26 -0400] sampikesley: ^ that
[2012-03-30 14:08:37 -0400] sampikesley: GIT ALL THE THINGS
[2012-03-30 14:08:39 -0400] sampikesley: always
[2012-03-30 14:09:17 -0400] afallows: work = worth - my fingers are betraying me today, it must be Friday.
[2012-03-30 14:10:24 -0400] blackjid: how do I git my roles?  I have a repo for cookbooks, but roles are in chef-server.....
[2012-03-30 14:11:07 -0400] |shad0w|: I try not to edit anything on the server
[2012-03-30 14:11:12 -0400] |shad0w|: knife x from file ...
[2012-03-30 14:11:27 -0400] |shad0w|: envs, roles, data bags, etc etc
[2012-03-30 14:11:42 -0400] sampikesley: http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks
[2012-03-30 14:12:00 -0400] sampikesley: it's possiblt a little counter-intuitive to start with
[2012-03-30 14:13:41 -0400] blackjid: ok, I do that for cookbooks, but for roles that lives outside the cookboos?
[2012-03-30 14:14:07 -0400] |shad0w|: put roles in chef-repo/roles
[2012-03-30 14:14:24 -0400] |shad0w|: knife role from file path/to/roles/role.rb
[2012-03-30 14:14:44 -0400] |shad0w|: there are also rake tasks in the default chef-repo repo
[2012-03-30 14:14:50 -0400] Anand: can anybody give me answer on this Q ? http://stackoverflow.com/questions/9944057/scale-out-the-ec2-instances-using-opscode-chef
[2012-03-30 14:15:27 -0400] blackjid: thanks |shad0w|
[2012-03-30 14:15:59 -0400] blackjid: thanks afallows and sampikesly... everything was very usefull..
[2012-03-30 14:17:24 -0400] afallows: blackjid: I've gotten a lot of help from this channel, don't hesitate to keep asking questions here.
[2012-03-30 14:23:46 -0400] blackjid: anyone is using vagrant with chef ?
[2012-03-30 14:23:50 -0400] btm: karmi: thanks. I've noted that on http://tickets.opscode.com/browse/CHEF-3011
[2012-03-30 14:24:28 -0400] karmi: btm: Ah, sorry, I forgot to update the ticket there
[2012-03-30 14:24:32 -0400] sampikesley: blackjid: yes
[2012-03-30 14:24:37 -0400] sampikesley: Vagrant changes everything
[2012-03-30 14:26:55 -0400] blackjid: it is normal that whenever I create a new VM in chef server is created a new node and a new client.  I understand the new node, and that ok.  but a new client? I thought that I sould have one client per developer not per vm....
[2012-03-30 14:30:23 -0400] sampikesley: it will create a new client, too
[2012-03-30 14:30:27 -0400] sampikesley: this is expected
[2012-03-30 14:30:49 -0400] sampikesley: you have to go delete the client and the node when you destroy the vagrant vm
[2012-03-30 14:31:06 -0400] sampikesley: this is probably a good candidate for a Rake task
[2012-03-30 14:32:47 -0400] blackjid: fine and the only whay to control the name of the node and client is via  config.vm.hostname in the vagrantfile, right?
[2012-03-30 14:33:17 -0400] afallows: To be honest, I am still a little fuzzy on the distinction between node and client in Chef-ese.
[2012-03-30 14:35:01 -0400] blackjid: that's ok.. ;-) it's not a big deal..
[2012-03-30 14:35:19 -0400] sampikesley: every node contains a client
[2012-03-30 14:35:28 -0400] sampikesley: but not every client requires a node
[2012-03-30 14:35:35 -0400] sampikesley: e.g. your laptop has a client, right?
[2012-03-30 14:35:40 -0400] sampikesley: but it's not a chef node
[2012-03-30 14:36:43 -0400] sampikesley: there are more subtle things at play here
[2012-03-30 14:36:49 -0400] sampikesley: which I don't fully understand yet
[2012-03-30 14:38:16 -0400] afallows: It seems like for 90% of cases the distinction isn't critical.
[2012-03-30 14:38:47 -0400] sampikesley: having effectively 'anonymous' Chef clients and nodes for Vagrant would be awesome
[2012-03-30 14:48:37 -0400] afallows: I would offer someone quite a lot of money to find a way to make installing Ruby from source take < 1 minute.
[2012-03-30 14:48:59 -0400] Kiall: afallows, why on earth would you do that? ;)
[2012-03-30 14:50:23 -0400] afallows: Kiall: I'm currently testing scripts that bootstrap chef servers and clients in an environment that uses multi-user RVM and different Ruby versions for two users. Every run of the script takes ~30 minutes, and more than half of that is the compiling step of the rvm install.
[2012-03-30 14:50:52 -0400] sampikesley: wow
[2012-03-30 14:51:04 -0400] sampikesley: Today's awesome find: encrypted data bags
[2012-03-30 14:51:10 -0400] sampikesley: this is fully magical
[2012-03-30 14:56:07 -0400] Kiall: afallows, sounds very wrong to me ;) But.. May I suggest doing the `./configure && make` once, zip it up, distribute that, then just do the `make install` step on the servers?
[2012-03-30 14:56:32 -0400] Kiall: Still "wrong" IMO though (I refuse to install anything that's not in a .deb/.rpm on anything I manage..)
[2012-03-30 14:57:12 -0400] Kiall: Not sure how you would do that with RVM.. But I assume you can do something along those lines
[2012-03-30 14:58:08 -0400] afallows: Kiall: If I weren't using rvm to manage ruby versions (a requirement imposed by my employer, or I might have scrapped it), I'd be doing just that. I'm sure it's possible to get RVM to play nicely with existing installs/versions, but I haven't looked into that at all.
[2012-03-30 14:58:09 -0400] sampikesley: if you can make an effective package of RVM, you may also be able to turn base metals into gold
[2012-03-30 14:58:20 -0400] afallows: ^
[2012-03-30 14:58:28 -0400] blackjid: can I use attributes to set override attributes?  for example  "override_attribute": { "rvm_passenger": { "rvm_ruby":  "rvm":{ "default_rvm" } } }
[2012-03-30 14:58:50 -0400] Kiall: afallows, if I'm not mistaken, RVM just builds and installs into a specific folder, and does some .profile magic to enable it..
[2012-03-30 14:59:07 -0400] Kiall: Maybe you can just distribute the folder it manages and reproduce the .profile magic..
[2012-03-30 15:00:18 -0400] afallows: Kiall: Probably true. I'm only one or two steps away from a fully working script, though, I'm afraid to muck with my process too much.
[2012-03-30 15:00:39 -0400] Kiall: right.. but surely 30mins to run is a blocker ;)
[2012-03-30 15:01:57 -0400] rshade98: is there a key in node[:ec2] that lets you know you are on a vpc?
[2012-03-30 15:11:59 -0400] pcn: Ohai
[2012-03-30 15:12:12 -0400] pcn: miah oracle completely screwed the poch.
[2012-03-30 15:12:33 -0400] miah: pcn: yup
[2012-03-30 15:13:02 -0400] miah: it'd be one thing if they had a valid reason for it. but this is clearly a decision made by some dipshit manager.
[2012-03-30 15:13:37 -0400] pcn: I suspect it's someone who talks to Larry on a regular basis.  He's a micro-manager in some ways AFAIK
[2012-03-30 15:14:47 -0400] pcn: Chefs, has anyone here successfully used the dynect cookbook with CNAME records?  I'm finding that when I call down through the dynect_rest gem, I get what appears to be a couple of incorrect cases.
[2012-03-30 15:15:06 -0400] pcn: I'm going to open a case with opscode if I can't get any further, but I wanted a reality check here.
[2012-03-30 15:15:49 -0400] miah: open a case, i dont know if the dynect issues are all resolved. i know people in the past few weeks have said there are problems in it. i don't use it myself though.
[2012-03-30 15:16:27 -0400] pcn: If no-one pops up with a happier story in a few minutes....
[2012-03-30 15:23:44 -0400] hoover_damm: pcn, afaik holoway has one in github.com/adamhjk
[2012-03-30 15:24:32 -0400] miah: curl -OvvL -b "oraclelicensejdk-6u31-oth-JPR=accept-securebackup-cookie;gpw_e24=http://edelivery.oracle.com" 'http://download.oracle.com/otn-pub/java/jdk/6u31-b04/jdk-6u31-linux-x64.bin'
[2012-03-30 15:24:36 -0400] miah: muahaha
[2012-03-30 15:24:47 -0400] BryanWB: miah: wow!
[2012-03-30 15:25:11 -0400] BryanWB: but if we all start doing it they will probably lock us back down :9
[2012-03-30 15:25:30 -0400] miah: maybe
[2012-03-30 15:26:12 -0400] hoover_damm: miah, I still say remote_file it from s3
[2012-03-30 15:26:15 -0400] hoover_damm: if you use ec2, s3 is free
[2012-03-30 15:26:29 -0400] miah: ya
[2012-03-30 15:26:33 -0400] hoover_damm: miah, trying to deal with the shennigans of oracle will just drive you spare
[2012-03-30 15:26:38 -0400] miah: i know
[2012-03-30 15:26:46 -0400] miah: my brain just really loves solving problems
[2012-03-30 15:26:50 -0400] miah: =)
[2012-03-30 15:27:03 -0400] BryanWB: miah:  i think your prodigious intelligence is probably best spent elsewhere ;)
[2012-03-30 15:28:09 -0400] hoover_damm: raising children
[2012-03-30 15:28:19 -0400] hoover_damm: and mowing the lawn, making corn
[2012-03-30 15:28:23 -0400] hoover_damm: and sheep
[2012-03-30 15:28:27 -0400] hoover_damm: the good old days
[2012-03-30 15:28:30 -0400] BryanWB: or on web proxies ;)
[2012-03-30 15:28:41 -0400] hoover_damm: it's harder to give birth to a web proxy
[2012-03-30 15:28:44 -0400] hoover_damm: have you ever pushed that out?
[2012-03-30 15:29:10 -0400] BryanWB: good night all, nice hack miah
[2012-03-30 15:29:24 -0400] sampikesley: you know you can do this, right? https://github.com/flexiondotorg/oab-java6
[2012-03-30 15:29:32 -0400] sampikesley: or does that only work for java 6?
[2012-03-30 15:29:49 -0400] miah: BryanWB: g'nite
[2012-03-30 15:30:03 -0400] miah: sampikesley: does oab work? https://github.com/flexiondotorg/oab-java6/issues/18
[2012-03-30 15:30:04 -0400] miah: =)
[2012-03-30 15:33:20 -0400] sampikesley: Oh
[2012-03-30 15:33:23 -0400] sampikesley: They broke it
[2012-03-30 15:33:36 -0400] sampikesley: Dreadful people
[2012-03-30 15:35:07 -0400] miah: yes
[2012-03-30 15:37:40 -0400] hoover_damm: of course they broke it
[2012-03-30 15:38:02 -0400] hoover_damm: just imagine how much bandwidth oracle looses per day to repeated downloads
[2012-03-30 15:38:42 -0400] johnwards: I have a cookbook with a method "apt_repository" however it is erroring that it is undefined
[2012-03-30 15:38:59 -0400] johnwards: I'm a bit lost at how to figure out where it should be defined
[2012-03-30 15:39:16 -0400] johnwards: i'm guessing some magic needs to happen, I need to enable something etc
[2012-03-30 15:39:22 -0400] johnwards: but no idea where to start debugging
[2012-03-30 15:39:33 -0400] paulmooring: johnwards: are you trying to make a resource that you can use in other cookbooks?
[2012-03-30 15:39:41 -0400] hoover_damm: jonlives, depends "apt"
[2012-03-30 15:39:44 -0400] hoover_damm: jonlives, in metadata.rb
[2012-03-30 15:39:53 -0400] johnwards: paulmooring: i'm trying to use an existing cookbook
[2012-03-30 15:40:10 -0400] hoover_damm: jonlives, basically chef uses metadata to determine what cookbooks to ship
[2012-03-30 15:40:15 -0400] johnwards: https://github.com/edelight/chef-cookbooks/blob/master/mongodb/recipes/10gen_repo.rb
[2012-03-30 15:40:21 -0400] johnwards: line 32
[2012-03-30 15:40:26 -0400] hoover_damm: jonlives, so you have to add the dependency of the cookbook in order for it to find it
[2012-03-30 15:40:31 -0400] johnwards: this is also in other cookbooks i've sen
[2012-03-30 15:40:49 -0400] hoover_damm: jonlives, https://github.com/edelight/chef-cookbooks/blob/master/mongodb/metadata.rb#L14
[2012-03-30 15:41:02 -0400] hoover_damm: that should be loading the apt cookbook
[2012-03-30 15:41:08 -0400] hoover_damm: you should ensure your apt cookbook is up to date
[2012-03-30 15:41:13 -0400] paulmooring: johnwards: hoover_damm is correct to use it in other cookbooks depend on it in the metadata
[2012-03-30 15:41:32 -0400] jonlives: hoover_damm: tabcomplete: you're doing it wrong :p
[2012-03-30 15:41:44 -0400] paulmooring: if it's a resource you want to add you need a resource and a provider look up lwrp in the wiki
[2012-03-30 15:41:55 -0400] paulmooring: if it's just a code snippet put it in a library
[2012-03-30 15:42:04 -0400] paulmooring: http://wiki.opscode.com/display/chef/Libraries
[2012-03-30 15:42:23 -0400] paulmooring: http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29
[2012-03-30 15:42:52 -0400] johnwards: I'm pretty sure I've got the latest apt cookbook from opscode :(
[2012-03-30 15:43:04 -0400] johnwards: and it's in my main recipe first
[2012-03-30 15:43:46 -0400] johnwards: where would i check to see if I have the latest apt cookbook with that method in it?
[2012-03-30 15:44:25 -0400] paulmooring: johnwards: check the README of the apt cookbook you have already
[2012-03-30 15:45:00 -0400] miah: knife cookbook show apt
[2012-03-30 15:45:12 -0400] miah: then verify you haven't version pinned it to a lower version cookbook in your environment
[2012-03-30 15:45:42 -0400] hoover_damm: jonlives, yes lazy tabcomplete sorry
[2012-03-30 15:46:29 -0400] johnwards: hmm seems that I'm running 1.4.0 and it's readme mentions apt_repository
[2012-03-30 15:46:47 -0400] johnwards: also I'm in a Vagrant env so not using knife (or if I am I'm not in control :))
[2012-03-30 15:54:11 -0400] johnwards: oh dear. Seems that apt must have been cached or something, as I've now destroyed the box and it's now working this time
[2012-03-30 15:54:24 -0400] johnwards: that's an 30 minutes wasted :(
[2012-03-30 15:54:55 -0400] Oct: hello there
[2012-03-30 15:55:17 -0400] Oct: is there a way to _remove_ some env variables in Execute/Script commands ?
[2012-03-30 15:59:08 -0400] Oct: set them to nil
[2012-03-30 15:59:09 -0400] Oct: ok
[2012-03-30 16:00:16 -0400] paulmooring: like in a bash script?
[2012-03-30 16:00:57 -0400] paulmooring: PATH="" ls # this won't work
[2012-03-30 16:01:03 -0400] paulmooring: for an example
[2012-03-30 16:07:37 -0400] |shad0w|: paulmooring, call unset in your script?
[2012-03-30 16:07:44 -0400] |shad0w|: eg unset PATH
[2012-03-30 16:10:22 -0400] paulmooring: |shad0w|: that to I was thinking an execute resource
[2012-03-30 16:12:35 -0400] hoover_damm: this all goes back to ^^ Oct though
[2012-03-30 16:17:38 -0400] jodell: FWIW, knife ssh "*:*" whoami -x root <-- "*:*" is the correct Solr wildcard
[2012-03-30 16:26:25 -0400] Hush: @jodell don't have to wrap it in quotes but yea that works, also I'd use quotes around the command
[2012-03-30 16:34:18 -0400] statix: I'm trying to use the Opscode php cookbook to install the Gearman module through PECL. Other PECL modules have no problems, but I'm trying to install a specific release/version using the php_pear resource options, but everytime I get this: pear.php.net/gearman" - package pecl/gearman can be installed with "pecl install gearman"  Any ideas?
[2012-03-30 16:55:47 -0400] unni_agile: Hi .......I have setup an open source chef server ..... and I start to create an instance from the chef workstation the new node is not getting registered.....it shows the following errs.......[Fri, 30 Mar 2012 16:46:36 +0000] INFO: *** Chef 0.10.8 ***
[2012-03-30 16:55:48 -0400] unni_agile: [Fri, 30 Mar 2012 16:46:38 +0000] INFO: Client key /etc/chef/client.pem is not present - registering
[2012-03-30 16:55:48 -0400] unni_agile: [Fri, 30 Mar 2012 16:46:38 +0000] INFO: HTTP Request Returned 401 Unauthorized: Failed to authenticate. Ensure that your client key is valid.
[2012-03-30 16:55:48 -0400] unni_agile: [Fri, 30 Mar 2012 16:46:38 +0000] FATAL: Stacktrace dumped to /var/chef/cache/chef-stacktrace.out
[2012-03-30 16:55:48 -0400] unni_agile: [Fri, 30 Mar 2012 16:46:38 +0000] FATAL: Net::HTTPServerException: 401 "Unauthorized"
[2012-03-30 16:55:48 -0400] unni_agile: ............could anyone help me with this????????
[2012-03-30 17:01:04 -0400] cwj: unni_agile: http://wiki.opscode.com/display/chef/Authentication+and+Authorization
[2012-03-30 17:01:38 -0400] cwj: it sounds like your client does not have a client.pem and, if there is a validation.pem certificate present, it is invalid
[2012-03-30 17:02:14 -0400] cwj: so you need to get a copy of the current validation certificate (validation.pem). most likely it should be put in /etc/chef/
[2012-03-30 17:19:47 -0400] cwj: unni_agile: that help at all?
[2012-03-30 17:32:47 -0400] cgibbons: has anyone ever stored data into an encrypted data bag from within a recipe?
[2012-03-30 17:32:54 -0400] cgibbons: not fetched, but stored
[2012-03-30 17:35:59 -0400] stphung: is it possible to update the ohai data stored in chef server without running chef-client? i.e. the particular role i have assigned to this node is not idempotent
[2012-03-30 18:10:44 -0400] pcn: cgibbons I think the same methods are available on the encrypted data bag as on the normal data bag.  You should be able to do that.
[2012-03-30 18:12:16 -0400] hoover_damm: provided all the keys are on the client to encrypt it no?
[2012-03-30 18:13:14 -0400] pcn: Same key for decryption as encryption
[2012-03-30 18:13:34 -0400] pcn: client permissions are needed.  Is that what you meant?
[2012-03-30 18:14:32 -0400] cgibbons: hrm
[2012-03-30 18:16:13 -0400] hoover_damm: that bothers me then
[2012-03-30 18:16:28 -0400] hoover_damm: but as i've been out of the loop andhaven't really used encrypted databags *flips hair*
[2012-03-30 18:16:31 -0400] hoover_damm: whatever
[2012-03-30 18:23:04 -0400] geekbri: is it valid to use not_if and only_if with the "service" resource?
[2012-03-30 18:29:20 -0400] atomic-penguin: geekbri, are you asking if you can have two conditions?
[2012-03-30 18:30:04 -0400] geekbri: atomic-penguin: I'm asking if its valid to use "only_if"inside of a service resource so that it only gets setup under certain circumstances.
[2012-03-30 18:30:41 -0400] jmontross: only_if {CAN I USE GIT:PROVIDER and figure out things like tags matching?)
[2012-03-30 18:31:13 -0400] jmontross: you can have only_if and not_if we use that.. seems to work
[2012-03-30 18:31:24 -0400] jmontross: i wonder if it allowed though
[2012-03-30 18:31:30 -0400] jmontross: havent tested
[2012-03-30 18:31:35 -0400] atomic-penguin: geekbri, I don't see why it wouldn't work.  You can stack the conditions with || or &&
[2012-03-30 18:31:49 -0400] jmontross: i just have them on two lines
[2012-03-30 18:31:55 -0400] jmontross: only_if {some condition}
[2012-03-30 18:32:06 -0400] jmontross: not_if {  }
[2012-03-30 18:32:18 -0400] atomic-penguin: only_if { something && ! something_else }
[2012-03-30 18:33:23 -0400] geekbri: Yeah i know how only_if works, I just didn't know if it would be functional within a service resource
[2012-03-30 18:34:33 -0400] atomic-penguin: Its not a resource specific condition, as far as I know, despite the documentation leaning heavily towards the execute example
[2012-03-30 18:36:24 -0400] atomic-penguin: geekbri, for some reason I read that as can I use two conditions an only_if AND a not_if.  long week
[2012-03-30 18:36:33 -0400] geekbri: atomic-penguin: I know the feeling :)
[2012-03-30 18:37:05 -0400] atomic-penguin: yes, you can use only_if or not_if with any resource
[2012-03-30 18:40:11 -0400] geekbri: atomic-penguin: I went and tested it so I just figured it out that way ;)
[2012-03-30 18:42:56 -0400] jodell: i'm trying to get `knife ec2 server create` to work with chef-solo given a remote_url and role, am I mistaken in thinking this should work?
[2012-03-30 18:47:08 -0400] paulmooring: jodell: knife is made for managing a server, so I'm not sure knife works at all without one
[2012-03-30 18:53:50 -0400] cwj: well, i think the main problem with using 'knife ec2 server create' for instances where you plan to run chef-solo is that its going to try to copy validation.pem and set up a client.rb for you
[2012-03-30 18:54:20 -0400] pcn: cwj can that be skipped in the template?
[2012-03-30 18:54:34 -0400] paulmooring: jodell: cwj is correct, I can run knife ec2 server create, and it creates a server successfully
[2012-03-30 18:54:43 -0400] cwj: pcn: i think you can write your own bootstrap template
[2012-03-30 18:54:49 -0400] paulmooring: and bootstrap scripts are really just shell script templates
[2012-03-30 18:54:53 -0400] cwj: well i mean, i know you can actually
[2012-03-30 18:55:08 -0400] cwj: and thats where the certificate copying happens
[2012-03-30 18:55:12 -0400] pcn: Yeah, I'm saying that IIRC that work is done in the bootstrap template, so it can be cut out for a particular boot
[2012-03-30 18:57:17 -0400] pcn: Does anyone know if it's possible to install a gem_package in a cookbook directly from github?
[2012-03-30 18:57:32 -0400] pcn: It looks like the dynect cookbook is FUBAR until https://github.com/adamhjk/dynect_rest/pull/11 is merged
[2012-03-30 18:58:53 -0400] paulmooring: pcn: you can install from disk, so I suppose you could use the git resource to download it from github
[2012-03-30 18:59:13 -0400] paulmooring: then use gem_package and specify the source
[2012-03-30 18:59:47 -0400] pcn: OK, I was hoping to cut a step out of that
[2012-03-30 19:04:00 -0400] jodell: so it sounds like i need to modify a bootstrap template and append chef-solo steps to it
[2012-03-30 19:30:01 -0400] statix: Has anyone else had trouble installing specific versions of PECL modules using the Opscode PHP cookbook?
[2012-03-30 19:41:43 -0400] statix: Oh well, an "if package is a pecl module, use pecl command instead of pear" works at least
[2012-03-30 20:02:40 -0400] geekbri: jtimberman: I think your mysql::server_ec2 recipe has a pretty major flaw.  I binds the /mnt/mysql to /var/lib/mysql on creation.... but on a reboot since there is no fstab entry...... its not bound so mysql wont start
[2012-03-30 20:04:45 -0400] hoover_damm: geekbri, mount :enable
[2012-03-30 20:05:00 -0400] hoover_damm: geekbri, basically add the same resource that is set to create, to enable, or [:create, :enable] should work
[2012-03-30 20:05:10 -0400] hoover_damm: geekbri, please file a ticket and create a pull request on this btw
[2012-03-30 20:05:14 -0400] bawt: contributing is http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-03-30 20:05:14 -0400] hoover_damm: bawt, contributing?
[2012-03-30 20:05:25 -0400] hoover_damm: geekbri, ^^ has the details on what is required to contribute
[2012-03-30 20:05:33 -0400] jkyle: I've noticed that knife queiries don't work on inherited roles. e.g. role2 inherits role1, so knife search node 'role:role1' will not turn up any results.
[2012-03-30 20:05:43 -0400] jkyle: any idea on a strategy to get at the same information?
[2012-03-30 20:05:47 -0400] geekbri: Yeah, once I have time to fix it, i'll do so and do a pull request but im under the gun at the moment
[2012-03-30 20:05:51 -0400] geekbri: so it will have to wait :)
[2012-03-30 20:05:52 -0400] hoover_damm: btw that's a pretty common flaw in most chef recipes i've seen geekbri
[2012-03-30 20:06:03 -0400] hoover_damm: a lot of people really don't test their setup on reboot
[2012-03-30 20:06:05 -0400] hoover_damm: and what it does
[2012-03-30 20:06:24 -0400] geekbri: hoover_damm: the problem is that there is logic in the recipe to only do the mount upon creation of the directory /mnt/mysql.
[2012-03-30 20:06:30 -0400] hoover_damm: some excuses not to are 'well I might want to look at the instance'... but meh
[2012-03-30 20:06:44 -0400] hoover_damm: geekbri, right... you only need to do it there
[2012-03-30 20:07:52 -0400] geekbri: hoover_damm: well except for that when you reboot /var/lib/mysql is no longer bound to /mnt/mysql where all your databases are :)
[2012-03-30 20:08:04 -0400] geekbri: hoover_damm: so its not the only place you need the bind!
[2012-03-30 20:08:30 -0400] hoover_damm: geekbri, https://github.com/damm/mysql/blob/3606a6640b7ae0a86e9726b34e80c34c1da597e4/recipes/server_ec2.rb
[2012-03-30 20:08:36 -0400] hoover_damm: that's how you fix it
[2012-03-30 20:09:43 -0400] hoover_damm: although personally I would rather store my mysql data on an EBS disk then put it on Ephemeral
[2012-03-30 20:09:48 -0400] hoover_damm: but that's just /me/
[2012-03-30 20:10:14 -0400] hoover_damm: no matter how you bake it, gotta have the :enable if you do a bind mount
[2012-03-30 20:10:18 -0400] geekbri: hoover_damm: right but, you can change the default data directory, so if you say... create an EBS raid and attach it, then install that and tell it to use /mnt/mysql and it happens to be where your raid is mounted :)
[2012-03-30 20:10:22 -0400] hoover_damm: otherwise it won't be there on reboot
[2012-03-30 20:10:43 -0400] hoover_damm: geekbri, weird
[2012-03-30 20:10:51 -0400] geekbri: hoover_damm: how so?
[2012-03-30 20:10:52 -0400] hoover_damm: I admit I like the /db /data pattern
[2012-03-30 20:11:01 -0400] hoover_damm: putting ebs on /mnt feels weird
[2012-03-30 20:11:02 -0400] geekbri: hoover_damm: but they are mounted drives! :)
[2012-03-30 20:11:21 -0400] hoover_damm: ... /mnt is temporary
[2012-03-30 20:11:39 -0400] afallows: Oh golly, today is a good day: I got a chef-server installation script (which uses RVM and other non-standard fun) working and have a bootstrapped chef client connected to that server.
[2012-03-30 20:11:42 -0400] geekbri: hoover_damm: mmmmmm. well I can remove my EBS volumes and mount them to another instance :)
[2012-03-30 20:11:43 -0400] hoover_damm: and not to be a real dick but
[2012-03-30 20:11:45 -0400] hoover_damm: http://www.pathname.com/fhs/pub/fhs-2.3.html#MNTMOUNTPOINTFORATEMPORARILYMOUNT
[2012-03-30 20:11:54 -0400] geekbri: good ole FHS
[2012-03-30 20:12:28 -0400] hoover_damm:  and /data and /db are not registered in FHS
[2012-03-30 20:12:39 -0400] geekbri: well shouldn't it be mounted somewhere in /var :-P
[2012-03-30 20:12:44 -0400] bdha: People still give a shit about the FHS?
[2012-03-30 20:12:50 -0400] hoover_damm: yes
[2012-03-30 20:12:53 -0400] bdha: Who knew.
[2012-03-30 20:12:56 -0400] hoover_damm: unless you work in a noops org
[2012-03-30 20:12:59 -0400] hoover_damm: then you don't give a shit about shit
[2012-03-30 20:13:04 -0400] geekbri: I mean if youre following FHS and all, id assume youd mount your data dir to /var ;)
[2012-03-30 20:13:25 -0400] hoover_damm: or a non-registered pattern
[2012-03-30 20:13:32 -0400] bdha: know an /srv
[2012-03-30 20:13:37 -0400] hoover_damm: you know the crutch
[2012-03-30 20:13:44 -0400] hoover_damm: use it when you like it, throw it away when you don't
[2012-03-30 20:15:55 -0400] geekbri: Well either way, the correct thing to do with the EBS raided volume is probably to mount it directory to /var/lib/mysql if its purpose is to be the MYSQL data directory
[2012-03-30 20:16:13 -0400] geekbri: I'll fix that recipe, test it, and do a pull request
[2012-03-30 20:23:34 -0400] hoover_damm: yup
[2012-03-30 20:23:35 -0400] hoover_damm: have fun
[2012-03-30 20:24:10 -0400] geekbri: yeah sure... fun :)
[2012-03-30 20:24:12 -0400] geekbri: jira is always fun
[2012-03-30 20:31:20 -0400] hoover_damm: org-jira
[2012-03-30 20:32:00 -0400] geekbri: The way I feel about jira is the way I feel about prostate exams.  Necessary sometimes, but entirely unpleasant
[2012-03-30 20:33:11 -0400] hoover_damm: I actually use org-jira to create tickets now
[2012-03-30 20:33:26 -0400] hoover_damm: the more I can wrap into emacs
[2012-03-30 20:33:28 -0400] hoover_damm: the better
[2012-03-30 20:33:48 -0400] geekbri: Although maybe I shouldn't reveal this to you, I am a vim user :)
[2012-03-30 20:34:05 -0400] c_t: vi over all.
[2012-03-30 20:34:30 -0400] c_t: geekbri: http://www.cs.bgu.ac.il/~orlovm/code/emacs/viman.gif
[2012-03-30 20:34:48 -0400] geekbri: amazing.
[2012-03-30 20:35:42 -0400] geekbri: too bad its a .gif not a png!
[2012-03-30 20:35:58 -0400] c_t: that cartoon's been around so long, it might predate pngs
[2012-03-30 20:37:55 -0400] hoover_damm: matz uses emacs
[2012-03-30 20:37:57 -0400] hoover_damm: you can too
[2012-03-30 20:38:12 -0400] hoover_damm: http://www.slideshare.net/yukihiro_matz/how-emacs-changed-my-life
[2012-03-30 20:38:25 -0400] geekbri: I used to use emacs, but i'm a changed man.
[2012-03-30 20:38:42 -0400] c_t: I don't want to get carpal tunnel
[2012-03-30 20:39:44 -0400] jkyle: am I reading the docs correctly that, by default, chef doesn't do any logging?
[2012-03-30 20:39:51 -0400] hoover_damm: c_t, we've already discussed your sadistic tendancies
[2012-03-30 20:39:54 -0400] jkyle:  /var/log/chef/ is empty
[2012-03-30 20:40:18 -0400] geekbri: If i remember correctly chef runs will be logged when they aren't run interactively ?
[2012-03-30 20:40:54 -0400] hoover_damm: logging is configured to stdout by default and if you use runit with the chef-client cookbooks
[2012-03-30 20:40:54 -0400] jkyle: I have a cookbook that's exploding servers. brings them down completely, can't even connect via vnc port on the bare metal (vm's)
[2012-03-30 20:40:57 -0400] hoover_damm: you can find the logs in runit
[2012-03-30 20:41:14 -0400] hoover_damm: jkyle, if your hardware is locking up like your saying
[2012-03-30 20:41:18 -0400] jkyle: so, I'm pretty much screwed on finding info on that?
[2012-03-30 20:41:26 -0400] hoover_damm: you could be fighting a hardware issue and trying to use chef to find it
[2012-03-30 20:41:34 -0400] jkyle: hoover_damm: well, it's hard to tell...without logs ;)
[2012-03-30 20:41:50 -0400] hoover_damm: so then run it with logging enabled, have it lockup
[2012-03-30 20:41:51 -0400] hoover_damm: reboot it
[2012-03-30 20:41:52 -0400] jkyle: hoover_damm: maybe, but it _only_ happens with this cookbook and it's happened on multiple physicial compute nodes
[2012-03-30 20:41:53 -0400] hoover_damm: view logs
[2012-03-30 20:42:17 -0400] hoover_damm: jkyle, i've been watching you in irc... no need to explain
[2012-03-30 20:42:24 -0400] jkyle: also, not sure it's locking up the server...might be doing something funky with the interface
[2012-03-30 20:42:31 -0400] jkyle: which would have the same behavior
[2012-03-30 20:42:33 -0400] berngp: gentlemen I spent  3 hours last night trying to figure out why a recipe was not working on nodes running ruby 1.9.3* but it was working on my nodes using 1.9.2*.. It boiled down to commas and newlines in a nutshell you can look at the diff here. https://gist.github.com/2254843   I hope no one else looses sleep over this one.
[2012-03-30 20:42:41 -0400] hoover_damm: bonding perhaps?
[2012-03-30 20:43:07 -0400] hoover_damm: if your doing interface bonding sometimes that can be perciular when modules get load
[2012-03-30 20:43:08 -0400] jkyle: not sure, it's the boundary monitoring cookbook...shouldn't be bonding
[2012-03-30 20:43:12 -0400] hoover_damm: had that drop the interface without any reason
[2012-03-30 20:43:16 -0400] hoover_damm: no i meant you
[2012-03-30 20:43:17 -0400] hoover_damm: not boundary
[2012-03-30 20:43:18 -0400] jkyle: honestly, it shouldn't be touching the interface
[2012-03-30 20:43:26 -0400] hoover_damm: duh it should
[2012-03-30 20:43:28 -0400] hoover_damm: it's boundary
[2012-03-30 20:43:28 -0400] jkyle: virt layer doesn't have bonding
[2012-03-30 20:43:37 -0400] hoover_damm: has to see something
[2012-03-30 20:43:53 -0400] hoover_damm: anywho that is for #boundary on how their service works
[2012-03-30 20:44:03 -0400] hoover_damm: I assume it samples your interface to some degree
[2012-03-30 20:44:52 -0400] jkyle: I figure it uses the interface, would have to for libpcap
[2012-03-30 21:03:39 -0400] paige_: hi hoover
[2012-03-30 21:05:31 -0400] hoover_damm: hi paige
[2012-03-30 21:40:55 -0400] paige_: getting comfy in my chair isnt easy
[2012-03-30 21:41:00 -0400] paige_: I need a new chair
[2012-03-30 21:42:45 -0400] paige_: I should buy my own chair for work, something completely crazy so people can try to steal it, then I can justifiably bring a nerf gun to work too
[2012-03-30 21:46:49 -0400] mgalkiewicz: Hello guys I have a problem with chef-client. When I log in to my machine through ssh and execute chef-client it does generate output to STDOUT, STDERR and to specified log file. However if I execute it like this: "ssh user@host chef-client" all I can see is STDERR. There is no output on STDOUT.  My configuration https://gist.github.com/2174039. Chef version 0.10.8. It worked fine on chef 0.9.16 with option "-V" which is now removed.
[2012-03-30 21:47:08 -0400] paige_: weird
[2012-03-30 21:48:25 -0400] mgalkiewicz: paige_: do you have any idea what might the problem?
[2012-03-30 21:49:26 -0400] paulmooring: mgalkiewicz: What OS is it?
[2012-03-30 21:49:35 -0400] paige_: nfc, sorry, Im just thinking about why that might happen and I dont
[2012-03-30 21:49:56 -0400] mgalkiewicz: paulmooring: I have tried debian wheezy and squeeze with some packages from wheezy
[2012-03-30 21:50:14 -0400] paige_: if you find out, lemme know because that sounds like it would piss me off and I'd rather know why now than find out later like you're having to do
[2012-03-30 21:50:22 -0400] paulmooring: and does the logfile contain stdout and stderr after running via ssh?
[2012-03-30 21:50:47 -0400] paige_: oh you're trying to redirect
[2012-03-30 21:50:49 -0400] mgalkiewicz: logfile always looks fine
[2012-03-30 21:51:11 -0400] mgalkiewicz: but i will check once again
[2012-03-30 21:52:40 -0400] paige_: http://linuxconfig.org/executing-commands-remotely-with-ssh-and-output-redirection
[2012-03-30 21:54:28 -0400] mgalkiewicz: paige_: output redirection is performed on localhost it does not change anything in this situation
[2012-03-30 21:55:54 -0400] mgalkiewicz: paulmooring: only STDOUT went to logfile
[2012-03-30 21:56:19 -0400] mgalkiewicz: stderr is visible in terminal where I run chef-client
[2012-03-30 21:57:02 -0400] paige_: redirecting locally is what you're trying to accomplish or avoid?
[2012-03-30 21:58:22 -0400] mgalkiewicz: avoid I just want to run chef-client through ssh and see everything from stdout so I would like to avoid local redirection
[2012-03-30 21:59:08 -0400] paige_: join #oneiric
[2012-03-30 21:59:12 -0400] paige_: sorry
[2012-03-30 21:59:20 -0400] paige_: not intended
[2012-03-30 21:59:32 -0400] mgalkiewicz: paulmooring: any ideas?
[2012-03-30 21:59:32 -0400] paulmooring: mgalkiewicz: in that case you probably could just tee to the log file
[2012-03-30 21:59:52 -0400] mgalkiewicz: yep but this is an ugly workaround
[2012-03-30 22:00:23 -0400] mgalkiewicz: I think that chef-client has a bug and devs might be interested in patching it
[2012-03-30 22:00:52 -0400] paulmooring: mgalkiewicz: set verbose_logging in client.rb
[2012-03-30 22:01:37 -0400] mgalkiewicz: did not help
[2012-03-30 22:02:16 -0400] paulmooring: you already put 'verbose_logging true' in there?
[2012-03-30 22:02:39 -0400] mgalkiewicz: yes
[2012-03-30 22:03:20 -0400] paulmooring: this is an interesting problem
[2012-03-30 22:03:21 -0400] mgalkiewicz: I have just been checking it
[2012-03-30 22:04:08 -0400] mgalkiewicz: I thought that maybe ssh brokes sth
[2012-03-30 22:05:04 -0400] mgalkiewicz: but on older version (from debian squeeze) it works fine only with chef < 0.10.x
[2012-03-30 22:08:09 -0400] erratic: http://media-cache2.pinterest.com/upload/75505731222818645_fxgSnKfD_c.jpg
[2012-03-30 22:09:13 -0400] mgalkiewicz: paulmooring: any more suggestions or shall I report a bug?
[2012-03-30 22:09:54 -0400] paulmooring: mgalkiewicz: I'm gonna try and recreate this on my end, so go a head and report a bug, if I find something I'll put it there
[2012-03-30 22:11:23 -0400] mgalkiewicz: paulmooring: I can provide you access to clean virtual machine within minutes with chef-solo which behaves the same. Would you like that? Are you going to investigate it know?
[2012-03-30 22:11:56 -0400] paulmooring: mgalkiewicz: I've got a pretty good test bed here but thanks for the offer
[2012-03-30 22:12:07 -0400] paulmooring: and yes I'm looking into now
[2012-03-30 22:12:12 -0400] mgalkiewicz: paulmooring: ok
[2012-03-30 22:17:32 -0400] paulmooring: mgalkiewicz: How did you install chef, debs, gem install, or the install script?
[2012-03-30 22:20:14 -0400] mgalkiewicz: gem install
[2012-03-30 22:23:19 -0400] ssd7: Ohai Chefs!
[2012-03-30 22:23:56 -0400] paulmooring: ssd7: You caught up on mgalkiewicz's problem?
[2012-03-30 22:24:14 -0400] ssd7: paulmooring: just reading through some backscroll now
[2012-03-30 22:25:32 -0400] erratic: somebody jacked my jump to conclusions mat
[2012-03-30 22:27:21 -0400] ssd7: paulmooring: mgalkiewicz does the situation with ssh change if you give ssh the -t or -T option?
[2012-03-30 22:27:31 -0400] mgalkiewicz: ssd7: w8 a sec
[2012-03-30 22:29:12 -0400] mgalkiewicz: ssd7: it works with -t and not with -T
[2012-03-30 22:29:51 -0400] ssd7: It has to do with allocating a psuedo-tty
[2012-03-30 22:30:01 -0400] ssd7: which is what -t does
[2012-03-30 22:30:32 -0400] ssd7: I don't remember all the details, but Chef does various tests about whether STDOUT it a tty or not
[2012-03-30 22:31:53 -0400] erratic: google+ is really distracting
[2012-03-30 22:32:10 -0400] erratic: somebody just posted a pic of a miller highlife, a porno mag, and a cigarette.
[2012-03-30 22:32:42 -0400] ssd7: mgalkiewicz: paulmooring https://github.com/opscode/chef/blob/master/chef/lib/chef/application.rb#L100-114
[2012-03-30 22:33:23 -0400] mgalkiewicz: ssd7: so you are saying that with -t it should always works and you still need to fix it in chef or chef behaviour is not going to change and I have always use -t?
[2012-03-30 22:34:32 -0400] ssd7: I don't think this is a bug in Chef.  It is a choice about behavior for sure and maybe if enough people wanted a different behavior it could change.  There may be something you can put in your ssh config so you don't have to specify -t everytime
[2012-03-30 22:34:53 -0400] ssd7: also, knife ssh allocates a pty by default I believe, so you could alternatively use knife ssh
[2012-03-30 22:35:03 -0400] mgalkiewicz: ok
[2012-03-30 22:36:06 -0400] mgalkiewicz: thx for help this hack with ssh can be nicely implemented in my situation and does everything I wanted
[2012-03-30 22:36:30 -0400] erratic: does anybody have any experience with the iptables cookbook?
[2012-03-30 22:36:36 -0400] mgalkiewicz: I really appreciate your help guys:)!
[2012-03-30 22:36:51 -0400] erratic: I had imagined this working like I could create a recipe for each machine and a template for each machine
[2012-03-30 22:36:58 -0400] ssd7: mgalkiewicz: glad to help. :)
[2012-03-30 22:37:09 -0400] erratic: and that ideally is about as much work as I think needs to go into this tbqh
[2012-03-30 22:38:05 -0400] erratic: iptables_rule "chefadmin"
[2012-03-30 22:38:10 -0400] erratic: is this like a function call or something
[2012-03-30 22:41:33 -0400] ssd7: iptables_rule is a resource defined by the iptables cookbook.  It provides an abstration for creating iptable rules, just like the package resource provides an abstraction for installing packages.
[2012-03-30 22:42:10 -0400] erratic: it basically indicates which template to use right
[2012-03-30 22:42:56 -0400] ssd7: erratic: yes, it is basically just a wrapper to a template resource
[2012-03-30 22:42:58 -0400] erratic: [Fri, 30 Mar 2012 22:33:54 +0000] FATAL: Chef::Exceptions::FileNotFound: template[/etc/network/if-pre-up.d/iptables_load] (iptables::chefadmin line 40) had an error: Chef::Exceptions::FileNotFound: Cookbook 'iptables' (0.10.0) does
[2012-03-30 22:43:03 -0400] erratic: root@admin:~/chef-repo/cookbooks/iptables/templates/default# ls -lah chefadmin.erb
[2012-03-30 22:43:03 -0400] erratic: -rw-r--r-- 1 root root 242 2012-03-30 21:32 chefadmin.erb
[2012-03-30 22:43:04 -0400] erratic: root@admin:~/chef-repo/cookbooks/iptables/templates/default#
[2012-03-30 22:46:32 -0400] erratic: ....
[2012-03-30 22:46:33 -0400] erratic: [Fri, 30 Mar 2012 22:33:54 +0000] FATAL: Chef::Exceptions::FileNotFound: template[/etc/network/if-pre-up.d/iptables_load] (iptables::chefadmin line 40) had an error: Chef::Exceptions::FileNotFound: Cookbook 'iptables' (0.10.0) does not contain a file at any of these locations:
[2012-03-30 22:46:33 -0400] erratic:   templates/ubuntu-11.10/iptables_load.erb
[2012-03-30 22:46:34 -0400] erratic:   templates/ubuntu/iptables_load.erb
[2012-03-30 22:46:34 -0400] erratic:   templates/default/iptables_load.erb
[2012-03-30 22:46:57 -0400] erratic: does it really mean to refer to these as directories?
[2012-03-30 22:48:07 -0400] ssd7: erratic: Those are the places chef looked for templates.  It looks in directories under templates/ and chooses which directories to look in bast on your hostname and platform.  One sec, link incoming
[2012-03-30 22:48:46 -0400] ssd7: erratic: See the "File Specificity" section here: http://wiki.opscode.com/display/chef/File+Distribution
[2012-03-30 22:54:12 -0400] erratic: OH I see what its saying
[2012-03-30 22:54:13 -0400] erratic: nevermind
[2012-03-30 22:54:23 -0400] erratic: I thought it was saying the file chefadmin.erb doesn't exist.
[2012-03-30 22:54:31 -0400] erratic: its talking about the iptables_load file
[2012-03-30 22:55:09 -0400] erratic: because I deleted it, recreated it and got the name wrong and called it iptables.load instead of iptables_load
[2012-03-30 22:55:24 -0400] erratic: sorry that was idiotic
[2012-03-30 22:55:30 -0400] erratic: I'm a ruby n00b
[2012-03-30 23:00:01 -0400] AntonZ: what can this mean ? - raise ArgumentError, "You must supply a name when declaring a #{method_name} resource" unless args.size > 0
[2012-03-30 23:04:22 -0400] erratic: my roommate just texted me to say that you can tell the dishes in our house have never been washed and put away at the same time, the cabinet fell off the wall a few hours ago
[2012-03-30 23:04:27 -0400] erratic: *facepalm*
[2012-03-30 23:10:38 -0400] ssd7: AntonZ: When calling a resource you typically do something like some_resource "a name"
[2012-03-30 23:10:45 -0400] ssd7: with an optional block afterwards
[2012-03-30 23:11:16 -0400] ssd7: if you don't supply that "a name" argument, and you don't include name "a name" in the optional block passed to the resource, then we give an error
[2012-03-30 23:13:38 -0400] ssd7: well, actually, sorry, basically if you don't pass an argument you get that error, regardless of what the block contains.
[2012-03-30 23:26:57 -0400] nect: when I try and run chef-client on a new machine, I get an "illegal instruction". I'm running chef 10.8 on Centos 6. I read there is some bugs with libc for debian on google, but nothing about this on CentOS
