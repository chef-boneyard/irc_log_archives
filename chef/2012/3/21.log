[2012-03-21 07:16:00 -0400] Anand: getting this error -- Net::SSH::AuthenticationFailed: ubuntu@ec2-46-51-155-29.eu-west-1.compute.am
[2012-03-21 07:16:00 -0400] Anand: azonaws.com
[2012-03-21 07:34:00 -0400] maus: hi, can anyone explain, what's the meaning of cookbook_collection provider attribute and why node.cookbook_collection is empty on the execution phase?
[2012-03-21 08:52:00 -0400] BryanWB: http://devopsanywhere.blogspot.it/2012/03/managing-archives-with-ark-resource.html
[2012-03-21 09:07:00 -0400] BryanWB: erikh: ^^
[2012-03-21 09:07:00 -0400] erikh: cool
[2012-03-21 09:37:00 -0400] nico: hi chefs
[2012-03-21 09:37:00 -0400] BryanWB: nico: bonjour!
[2012-03-21 09:48:00 -0400] proffalken: morning :)
[2012-03-21 09:50:00 -0400] nico: do you guys have a way to programmatically bump a cookbook version in an environment ?
[2012-03-21 10:01:00 -0400] BryanWB: nico: there is a knife bump plugin but i haven't used it
[2012-03-21 10:02:00 -0400] nico: url ? because I just wrote one :)
[2012-03-21 10:04:00 -0400] BryanWB: https://github.com/Atalanta/knife-cookbook-bump
[2012-03-21 10:04:00 -0400] BryanWB: hmm, but that is just for cookbooks
[2012-03-21 10:06:00 -0400] nico: found https://github.com/jonlives/knife-spork
[2012-03-21 10:07:00 -0400] proffalken: dammit! I was going to call my plugin that... :(
[2012-03-21 10:10:00 -0400] proffalken: Is there a knife plugin for switching between Chef servers? I'm using a bash script at the moment and I'm seriously considering writing a plugin for it
[2012-03-21 10:29:00 -0400] alclonky: is it possible to template a file in a .war/zip file?
[2012-03-21 10:29:00 -0400] alclonky: i have the need to deploy a tomcat webapp (war file) which changes from time to time, but to have  a web.xml config File in the .war File
[2012-03-21 10:29:00 -0400] alclonky: so die need whould be to rebuild the war file if the web.xml or the .war itself changes
[2012-03-21 10:30:00 -0400] BryanWB: alclonky: no
[2012-03-21 10:30:00 -0400] BryanWB: i template the web.xml after expanding the .war and then i start the tomcat service, not before
[2012-03-21 10:31:00 -0400] alclonky: so you dont deploy a war file
[2012-03-21 10:31:00 -0400] BryanWB: nope
[2012-03-21 10:31:00 -0400] alclonky: and what if the webapp changes?
[2012-03-21 10:31:00 -0400] BryanWB: this is for my jira install
[2012-03-21 10:31:00 -0400] BryanWB: and it doesn't change often
[2012-03-21 10:31:00 -0400] BryanWB: alclonky: u need to get your devs to put the config stuff into web.xml
[2012-03-21 10:32:00 -0400] alclonky: ithe config stuff is in the web.xml
[2012-03-21 10:32:00 -0400] BryanWB: they can query the chef-server for any info needed, like data_bag using spice tool
[2012-03-21 10:32:00 -0400] alclonky: but the app gets a new version often
[2012-03-21 10:32:00 -0400] alclonky: so i have to change web.xml and the other things in da war
[2012-03-21 10:32:00 -0400] BryanWB: alclonky: what do u need to put into the web.xml?
[2012-03-21 10:32:00 -0400] alclonky: i get a .war without web.xml from the devs and deploy my config
[2012-03-21 10:33:00 -0400] alclonky: ldap and db connections, servlet definitions with validips etc.
[2012-03-21 10:33:00 -0400] BryanWB: why can't the devs put the web.xml in there ?
[2012-03-21 10:33:00 -0400] BryanWB: put that stuff in an data_bag
[2012-03-21 10:33:00 -0400] alclonky: the dont' know the production settings and passswords
[2012-03-21 10:33:00 -0400] BryanWB: fuck
[2012-03-21 10:33:00 -0400] alclonky: the generation of the web.xml with chef is easy
[2012-03-21 10:33:00 -0400] BryanWB: ok, that's a tough one
[2012-03-21 10:34:00 -0400] BryanWB: i wouldn't deploy w/ a war file
[2012-03-21 10:34:00 -0400] alclonky: but how to tell chef to deploy a new .war
[2012-03-21 10:34:00 -0400] BryanWB: alclonky: is it in a maven repo?
[2012-03-21 10:34:00 -0400] BryanWB: the war file
[2012-03-21 10:34:00 -0400] alclonky: no
[2012-03-21 10:35:00 -0400] alclonky: self generated with makefile
[2012-03-21 10:35:00 -0400] alclonky: if i whould have a logic to know if the war file changed i could deploy a new one with unzip , web.xml template and zip
[2012-03-21 10:36:00 -0400] alclonky: but how to know
[2012-03-21 10:36:00 -0400] BryanWB: if u deploy a new .war file, maybe also create a my.war.dodeploy,
[2012-03-21 10:37:00 -0400] BryanWB: chef checks if that file exists then does the deploy
[2012-03-21 10:37:00 -0400] BryanWB: when completed, removes the my.war.dodeploy
[2012-03-21 10:37:00 -0400] BryanWB: that my.war.dedeploy is just an empty file in webapps/
[2012-03-21 10:37:00 -0400] alclonky: then i would deploy with each chef run
[2012-03-21 10:37:00 -0400] alclonky: maybe keep the md5 from web.xml and the war on the server to see a change
[2012-03-21 10:38:00 -0400] BryanWB: no, not if you remove the  my.war.dodeploy after completing a deploy
[2012-03-21 10:38:00 -0400] BryanWB: that is how jboss handles war deploys
[2012-03-21 10:39:00 -0400] alclonky: and how to know if i have to do a redeploy or not?
[2012-03-21 10:40:00 -0400] BryanWB: create a my.war.dodeploy   as part of your Makefile targe
[2012-03-21 10:40:00 -0400] BryanWB: s/targe/target
[2012-03-21 10:41:00 -0400] alclonky: the make process is another infrastructure i just get a new war File
[2012-03-21 10:41:00 -0400] alclonky: and the xml can change too
[2012-03-21 10:41:00 -0400] BryanWB: however u place the .war file there, put a .dodeploy there as well
[2012-03-21 10:42:00 -0400] BryanWB: you could write a knife script to do it w/ knife exec
[2012-03-21 10:42:00 -0400] alclonky: i whould have the war file in the cookbook
[2012-03-21 10:43:00 -0400] BryanWB: hmm, i wouldn't put it there, i would put it on an apache server, just my $0.02
[2012-03-21 10:43:00 -0400] BryanWB: maybe put a checksum in webapps/my.war.md5 , chef checks if its new war matches the checksum, if not, do deploy
[2012-03-21 10:44:00 -0400] BryanWB: and write new checksum to webapps/my.war.md5
[2012-03-21 10:46:00 -0400] alclonky: maybe i put the web.xml and the unchanged war to /tmp/ with template and cookbook_file.
[2012-03-21 10:46:00 -0400] alclonky: and this notifies the merge and deploy
[2012-03-21 10:46:00 -0400] alclonky: so a can use the chef check if the files changed
[2012-03-21 10:47:00 -0400] BryanWB: u need to checksum the war cuz the code can change independently of the config in web.xlm
[2012-03-21 10:48:00 -0400] alclonky: chef whould do it if i have cookkbook_file "/tmp/mywar" and template "/tmp/web.xml"
[2012-03-21 10:48:00 -0400] alclonky: chef whould copy a new one if changed
[2012-03-21 10:49:00 -0400] alclonky: and both whould notify the copy war to tomcat and copy xml into war
[2012-03-21 10:51:00 -0400] nacer_: alclonky :i explode my  war in git repo for deployement
[2012-03-21 10:51:00 -0400] nacer_: alclonky: don't put them in cookbook
[2012-03-21 10:52:00 -0400] alclonky: why not?
[2012-03-21 10:54:00 -0400] nacer_: alclonky: because .war can be big
[2012-03-21 10:55:00 -0400] nacer_: alclonky: last time i checked pushing big file into cookbook was pain
[2012-03-21 10:55:00 -0400] alclonky: i have just the one, its small
[2012-03-21 10:55:00 -0400] nacer_: alclonky: does this war change a lot ?
[2012-03-21 10:56:00 -0400] alclonky: yes
[2012-03-21 10:56:00 -0400] alclonky: 1-2 Times a Month
[2012-03-21 10:56:00 -0400] nacer_: alclonky: ok that's not a lot :)
[2012-03-21 10:56:00 -0400] nacer_: alclonky: push my .war 4 or 5 times day
[2012-03-21 10:56:00 -0400] nacer_: i
[2012-03-21 10:57:00 -0400] alclonky: its just a small webapp in tomcat the rest is native with apache
[2012-03-21 10:58:00 -0400] nacer_: alclonky: so i guess you can do it that way
[2012-03-21 11:00:00 -0400] alclonky: i will for now
[2012-03-21 11:00:00 -0400] alclonky: what whould really be nice is a template resource which takes multiple source, war and xml or so
[2012-03-21 11:03:00 -0400] gurrie: Hi, I have a question about how chef executes provider actions. I have written 2 LWRP providers, one to install an application and another to unzip files. The first provider calls the second provider to unzip the application zip file and then performs some other actions (setting paths etc). However it appears that the unzip provider is being executed in a separate thread? Is this correct?
[2012-03-21 11:10:00 -0400] nico: http://pastie.org/3640805 \o/
[2012-03-21 11:35:00 -0400] BryanWB: nacx: http://devopsanywhere.blogspot.it/2012/03/managing-archives-with-ark-resource.html your thoughts would be very helpful
[2012-03-21 11:35:00 -0400] BryanWB: nico: nice!
[2012-03-21 11:35:00 -0400] gurrie: Anyone/
[2012-03-21 11:35:00 -0400] gurrie: ?
[2012-03-21 11:36:00 -0400] BryanWB: gurrie: chef is single-threaded
[2012-03-21 11:36:00 -0400] gurrie: Ok, thats very wierd as I can clearly see in the logs that the step to move the unzipped file is being executed before the unzip is completed?
[2012-03-21 11:37:00 -0400] BryanWB: ruby code executes before any resources unless u put it in a ruby_block
[2012-03-21 11:37:00 -0400] gurrie: ah ok, that could be it!
[2012-03-21 11:37:00 -0400] nico: BryanWB: I'll push it to github later
[2012-03-21 11:44:00 -0400] gurrie: sorry i'm a little confused, the code in question is all in a provider. does that mean that all methods in the provider outside of the action should be in a ruby_block?
[2012-03-21 11:45:00 -0400] BryanWB: gurrie: if they are inside an action all ruby code inside the action will be called before the the resources inside the action
[2012-03-21 11:52:00 -0400] Anand: how can we do scale in and scale out in hosted chef server
[2012-03-21 11:52:00 -0400] Anand: ??
[2012-03-21 11:52:00 -0400] `brendan: morning folks
[2012-03-21 11:52:00 -0400] Anand: what kind of configuration I should follow?
[2012-03-21 11:52:00 -0400] gurrie: thanks for your help
[2012-03-21 12:00:00 -0400] Anand: is there any apache-tomcat cookbook available??
[2012-03-21 12:08:00 -0400] BryanWB: Anand: it is so old u don't want to use it
[2012-03-21 12:08:00 -0400] BryanWB: i recommend mine
[2012-03-21 12:08:00 -0400] BryanWB: github.com/bryanwb/cookbooks/
[2012-03-21 12:08:00 -0400] BryanWB: i need to get around to submitting a pull request
[2012-03-21 13:09:00 -0400] nico: BryanWB: https://github.com/Fotolia/knife-align/ if you're interested
[2012-03-21 13:10:00 -0400] proffalken: hey all, beyond "write it then try it out", is there an "approved" way of testing knife plugins?
[2012-03-21 13:11:00 -0400] BryanWB: I have seen some people use rspec, which i am not familiar w/
[2012-03-21 13:11:00 -0400] BryanWB: look at the knife-bump gem, bet it has tests
[2012-03-21 13:12:00 -0400] BryanWB: from atalanta
[2012-03-21 13:12:00 -0400] BryanWB: that stephen nelson-smith is a smart guy
[2012-03-21 13:12:00 -0400] nico: sure
[2012-03-21 13:13:00 -0400] BryanWB: nico: looks neat
[2012-03-21 13:17:00 -0400] nico: BryanWB: will help here to avoid errors
[2012-03-21 13:17:00 -0400] nico: I hate to be mistaken on version numbers
[2012-03-21 13:24:00 -0400] Anand: can anybody tell me that how can i increate my instance as per the request load?
[2012-03-21 13:24:00 -0400] BryanWB: no fucking idea, but i would love to know the same
[2012-03-21 13:25:00 -0400] BryanWB: would need something like noah or variant of zookeeper
[2012-03-21 13:25:00 -0400] BryanWB: i think
[2012-03-21 13:27:00 -0400] Anand: brayanWB: cant understand what u r talking abt..
[2012-03-21 13:28:00 -0400] BryanWB: Anand: u need something that watches your resources and sends notifications accordingly, look up noah on github
[2012-03-21 13:29:00 -0400] zoubi: hi guys
[2012-03-21 13:30:00 -0400] zoubi: I've created a cookbook, with a recipe which contains "include_recipe "postgresql::server"
[2012-03-21 13:30:00 -0400] atomic-penguin: https://github.com/lusis/noah
[2012-03-21 13:30:00 -0400] zoubi: when I update my node, I got this error: FATAL: NoMethodError: undefined method `platform_version' for Chef::Resource::Service
[2012-03-21 13:30:00 -0400] zoubi: any idea what the problem is?
[2012-03-21 13:31:00 -0400] zoubi: It is because I need to create an attribute named platform_version?
[2012-03-21 13:32:00 -0400] BryanWB: atomic-penguin:  good morning ;)
[2012-03-21 13:32:00 -0400] atomic-penguin: good morning
[2012-03-21 13:38:00 -0400] proffalken: Right! My first knife plugin is online and ready to be torn apart... :)
[2012-03-21 13:38:00 -0400] proffalken: https://github.com/greenandsecure/knife-plugins
[2012-03-21 13:38:00 -0400] BryanWB: proffalken: nice!
[2012-03-21 13:38:00 -0400] proffalken: (also the first bit of code I've released as a limited company :D )
[2012-03-21 13:39:00 -0400] proffalken: I'm a contractor so I need to be able to switch between multiple knife.rb files depending on whom I'm working for
[2012-03-21 13:39:00 -0400] proffalken: I was using a bash script, but knifeblock allows you to store multiple knives...
[2012-03-21 13:39:00 -0400] proffalken: :D
[2012-03-21 13:44:00 -0400] tolland: proffalken: yes, i have that problem
[2012-03-21 13:44:00 -0400] tolland: will check it out
[2012-03-21 13:46:00 -0400] proffalken: I'd be interested in your experience
[2012-03-21 13:46:00 -0400] proffalken: tolland: let me know what you think - I've only teted it locally as I'm not too sure how to test plugins yet
[2012-03-21 13:47:00 -0400] tolland: proffalken: how are you dealing with multiple clients on a single chef-server? ie separating the roles, environments, node visibilty, or you not have that problem?
[2012-03-21 13:47:00 -0400] zoubi: is platform_version an attribute recognized by default, or should I do anything?
[2012-03-21 13:47:00 -0400] zoubi: the error I get with the postgresql server recipe is on line 44 of this file : https://github.com/opscode/cookbooks/blob/master/postgresql/recipes/server_debian.rb
[2012-03-21 13:48:00 -0400] nico: proffalken: nice one
[2012-03-21 13:51:00 -0400] proffalken: tolland: not hit that issue (yet)
[2012-03-21 13:52:00 -0400] proffalken: nico: thanks
[2012-03-21 13:56:00 -0400] proffalken: tolland: feel feel to fork and contribute back if it scratches an itch... :)
[2012-03-21 13:58:00 -0400] proffalken: zoubi: run ohai | grep platform_version on the affected server and see what it returns
[2012-03-21 13:59:00 -0400] zoubi: root@ip-10-48-57-129:~# ohai | grep platform_version
[2012-03-21 13:59:00 -0400] zoubi:   "platform_version": "6.0.2",
[2012-03-21 13:59:00 -0400] proffalken: ok, so now check the recipe and see if it is expecting a platform version that matches that format
[2012-03-21 13:59:00 -0400] proffalken: zoubi: but to answer your question, it looks like platform_version is recognised by default
[2012-03-21 14:00:00 -0400] zoubi: in the recipe https://github.com/opscode/cookbooks/blob/master/postgresql/recipes/server_debian.rb, you can see at linbes 42 to 50 the check for the versions
[2012-03-21 14:01:00 -0400] zoubi: the catch-all is : when platform_version =~ /squeeze/
[2012-03-21 14:01:00 -0400] proffalken: zoubi: sounds like it's looking for an ubuntu version of debian, not "true" debian
[2012-03-21 14:02:00 -0400] zoubi: mm ok
[2012-03-21 14:03:00 -0400] zoubi: I'll try to update the file, and force the service_name attribute, and check if it's working
[2012-03-21 14:03:00 -0400] proffalken: The opscode guys should be online soon, it's worth pinging one of them and asking
[2012-03-21 14:06:00 -0400] zoubi: it's my first time on this chan. Who are they? They have a prefix on their nick?
[2012-03-21 14:06:00 -0400] atomic-penguin: zoubi, what does the debian_release file say
[2012-03-21 14:07:00 -0400] atomic-penguin: */etc/debian_version
[2012-03-21 14:07:00 -0400] zoubi: 6.0.2
[2012-03-21 14:09:00 -0400] proffalken: zoubi: looking at that code it should fall straight through to the final else statement
[2012-03-21 14:09:00 -0400] atomic-penguin: Yes
[2012-03-21 14:09:00 -0400] atomic-penguin: The squeeze regex is there, likely because of a problem detecting the platform_version on inconsistent debian_version files
[2012-03-21 14:10:00 -0400] atomic-penguin: The else on Line 48 would be where it executes the selection for 6.0.2
[2012-03-21 14:10:00 -0400] zoubi: yeah, but the error occurs on line 44
[2012-03-21 14:11:00 -0400] zoubi: with this message : FATAL: NoMethodError: undefined method `platform_version' for Chef::Resource::Service
[2012-03-21 14:14:00 -0400] proffalken: hmmm.
[2012-03-21 14:15:00 -0400] atomic-penguin: That case switching is an awful mess, just to select a service name
[2012-03-21 14:18:00 -0400] zoubi: at the moment, I've commented out the lines 44 to 48, and 50, so service_name is "hardcoded" to "postgresql", and had to do the same in https://github.com/opscode/cookbooks/blob/master/postgresql/attributes/default.rb on lines 23 to 27, and this works
[2012-03-21 14:20:00 -0400] atomic-penguin: 23..27 should probably have a node.<whatever> for attributes
[2012-03-21 14:21:00 -0400] atomic-penguin: Also, no else case
[2012-03-21 14:23:00 -0400] proffalken: heh, just found (and fixed) and issue with my own code... :)
[2012-03-21 14:26:00 -0400] zoubi: atomic-penguin: instead of default[:postgresql][:version] = "8.3", this should be node.default[:postgresql][:version] = "8.3" ?
[2012-03-21 14:29:00 -0400] atomic-penguin: Well no
[2012-03-21 14:29:00 -0400] zoubi: indeed, no, it's the same, according to http://wiki.opscode.com/display/chef/Attributes :p
[2012-03-21 14:30:00 -0400] atomic-penguin: Like "case platform", ought to be "case node['platform']" or "case node.platform"
[2012-03-21 14:30:00 -0400] atomic-penguin: Its just really inconsistent throughout the recipe
[2012-03-21 14:34:00 -0400] zoubi: atomic-penguin: to you have a cookbook which is correctly written to recommand to me, so I can change this recipe accordingly?
[2012-03-21 14:39:00 -0400] nacer: zoubi: try the app foodcritic , it help
[2012-03-21 14:45:00 -0400] zoubi: nacer: thanks, I'll have a look at that
[2012-03-21 14:45:00 -0400] bkocik: foodcritic is way cool.
[2012-03-21 14:49:00 -0400] atomic-penguin: foodcritic gem will help some
[2012-03-21 14:52:00 -0400] atomic-penguin: zoubi, I refactored snmp recently to demonstrate such an example.  http://ckbk.it/snmp
[2012-03-21 15:03:00 -0400] Glacee: is there a distro template for ubuntu Precise?
[2012-03-21 15:05:00 -0400] nico: foodcritic . | wc -l
[2012-03-21 15:05:00 -0400] nico: 566
[2012-03-21 15:05:00 -0400] nico: there might be some sed to do
[2012-03-21 15:06:00 -0400] nico: (only 192 when not checking FC001)
[2012-03-21 15:07:00 -0400] mattray: Glacee: the full stack may work https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/chef-full.erb
[2012-03-21 15:08:00 -0400] mattray: nope, no 12.04 .deb yet. The 11.10 one reportedly works fine s3.amazonaws.com/opscode-full-stack/
[2012-03-21 15:09:00 -0400] Glacee: mattray: ok cool thanks.. actually I got it to work with ubuntu10.04-apt .. do you see any drawback doing this?
[2012-03-21 15:10:00 -0400] mattray: probably not.
[2012-03-21 15:11:00 -0400] Glacee: ok thank you
[2012-03-21 15:11:00 -0400] mattray: full stack will be the "preferred" way to install with Chef 0.10.10, but there will be distro-debs for 12.04 when it comes out
[2012-03-21 15:12:00 -0400] Glacee: ok cool! thanks
[2012-03-21 15:15:00 -0400] nico: mattray: is full stack some sort of 'static stuff' ?
[2012-03-21 15:16:00 -0400] mattray: it's all the requirements for Chef, installed in /opt/opscode
[2012-03-21 15:16:00 -0400] mattray: ruby, chef, supporting libraries
[2012-03-21 15:16:00 -0400] nico: ok
[2012-03-21 15:16:00 -0400] mattray: so you get the same chef experience on every platform (Linux, Unix, Windows)
[2012-03-21 15:16:00 -0400] mattray: and don't have to deal with OS dependencies
[2012-03-21 15:17:00 -0400] proffalken: mattray: completely self contained with no risk of leaking into the resot of the OS? ;)
[2012-03-21 15:17:00 -0400] mattray: proffalken: that's the goal
[2012-03-21 15:17:00 -0400] nico: mattray: we're running our chef server on freebsd, that may improve the fun
[2012-03-21 15:18:00 -0400] mattray: eventually there will be a full-stack chef server too
[2012-03-21 15:18:00 -0400] mattray: and it'll all be open source of course, so it may make FreeBSD a bit easier
[2012-03-21 15:18:00 -0400] mattray: and any other platform you want
[2012-03-21 15:19:00 -0400] mattray: it's by far and away the easiest way for RHEL right now
[2012-03-21 15:19:00 -0400] proffalken: meh, fscking RHEL
[2012-03-21 15:20:00 -0400] proffalken: s/hacing/hacking
[2012-03-21 15:20:00 -0400] BryanWB: but nothing newer than 10 years old is stable!
[2012-03-21 15:20:00 -0400] mattray: hence the need to just package up our own stuff
[2012-03-21 15:21:00 -0400] atomic-penguin: You can gem install chef-server on omnibus, just saying
[2012-03-21 15:22:00 -0400] mattray: interesting. There are omnibus/full stacks for a lot of platforms
[2012-03-21 15:22:00 -0400] proffalken: mattray: yeah, I understand.  Would be nice to see a "This is the approved installation route (gem install...).  If you're into S&M or run RHEL, you can install the full-stack as follows..."
[2012-03-21 15:22:00 -0400] proffalken: :P
[2012-03-21 15:32:00 -0400] corp: Anyone have this issue with chef server seeing a client that doesn't exist? https://gist.github.com/2148491
[2012-03-21 15:32:00 -0400] corp: eh, nevermind
[2012-03-21 15:40:00 -0400] alclonky: sauspiel
[2012-03-21 15:40:00 -0400] alclonky: nice *g*
[2012-03-21 15:40:00 -0400] proffalken: mattray: any reason y'all went with JSON and not YAML? I mean, obviously it's better than XML and everything, but knife data bag edit is a PITA when you get the syntax wrong... </troll>
[2012-03-21 15:41:00 -0400] mattray: proffalken: dunno, easier for APIs?
[2012-03-21 15:41:00 -0400] mattray: all communications between the clients and server is JSON
[2012-03-21 15:42:00 -0400] proffalken: mattray: s'ok, I'm just having issues with editing JSON today, apparently my brain can't parse it properly... :)
[2012-03-21 15:43:00 -0400] mattray: json-mode for emacs :)
[2012-03-21 15:44:00 -0400] mattray: yeah, json can be picky
[2012-03-21 15:45:00 -0400] mattray: I went with yaml for spiceweasel, someone submitted a patch for json almost immediately
[2012-03-21 15:45:00 -0400] proffalken: yeah, I've installed JSON lint, I just need to work out how to hack knife to run jsonlint and dump me back into VIM if it fails...
[2012-03-21 15:46:00 -0400] paulmooring: proffalken: vim can get syntax highlighting for json
[2012-03-21 15:46:00 -0400] cwj: proffalken: this might be relevant to your interests http://code.google.com/p/vimingwithbuttar/source/browse/plugin/jsonlint.vim
[2012-03-21 15:46:00 -0400] mattray: knife takes -fj as an option and returns stuff in json
[2012-03-21 15:46:00 -0400] paulmooring: and as an added bonus it's not emacs :)
[2012-03-21 15:50:00 -0400] proffalken: paulmooring, cwj: thanks, I'll take a look
[2012-03-21 16:01:00 -0400] jtimberman: proffalken: javascript
[2012-03-21 16:01:00 -0400] corp: hey jtimberman
[2012-03-21 16:02:00 -0400] proffalken: oh look, jtimberman turned up and he's brought a troll with him... :P
[2012-03-21 16:03:00 -0400] brett_h: how do I go about debugging a cookbook_file that is choosing the <default> dir over <hostname> dir? the hostname dir matches the hostname --fqdn
[2012-03-21 16:03:00 -0400] asg: brett_h: did you name the dir 'host-<fqdn>'?
[2012-03-21 16:03:00 -0400] brett_h: asg: ah, nope, thanks
[2012-03-21 16:04:00 -0400] brett_h: literally "host-..." ?
[2012-03-21 16:04:00 -0400] asg: yes
[2012-03-21 16:04:00 -0400] brett_h: asg: that did it, thanks :)
[2012-03-21 16:04:00 -0400] asg: brett_h: you're welcome
[2012-03-21 16:12:00 -0400] tduffield: I'm running in an issue where cookbooks with versions like YYYY.MM.xx are causing a "FATAL: Net::HTTPServerException: 404 "Not Found"" on a chef-client run. Any ideas?
[2012-03-21 16:18:00 -0400] timsmith: tduffield:  It's a bug
[2012-03-21 16:18:00 -0400] timsmith: tduffield:  If you have a version number for a cookbook with the first place is a double digit it will result in that exact error
[2012-03-21 16:20:00 -0400] tduffield: timsmith: Is there a bug report number, or an estimated resolution date?
[2012-03-21 16:20:00 -0400] atomic-penguin: *its a feature
[2012-03-21 16:20:00 -0400] atomic-penguin: since 0.10
[2012-03-21 16:21:00 -0400] asg: atomic-penguin: the measure twice, cut once feature to prevent version creep?
[2012-03-21 16:21:00 -0400] tduffield: "<atomic-penguin> *its a feature" I disagree
[2012-03-21 16:21:00 -0400] atomic-penguin: oh, maybe not if its yyyy.mm.xx
[2012-03-21 16:21:00 -0400] atomic-penguin: I was thinking of versions like "0.1" instead of "0.1.0"
[2012-03-21 16:23:00 -0400] timsmith: I tried to sync my cookbook versions with our product and attempted to use 10.3.0
[2012-03-21 16:24:00 -0400] timsmith: that failed
[2012-03-21 16:24:00 -0400] timsmith: I ended up going with 0.10.3
[2012-03-21 16:24:00 -0400] timsmith: works fine
[2012-03-21 16:24:00 -0400] timsmith: very lame though
[2012-03-21 16:33:00 -0400] proffalken: can Knife read the environment from a bash ENV[] var?
[2012-03-21 16:33:00 -0400] proffalken: s/bash/shell
[2012-03-21 16:33:00 -0400] BryanWB: sure
[2012-03-21 16:33:00 -0400] BryanWB: any ruby script can
[2012-03-21 16:34:00 -0400] proffalken: I'm thinking about adding some of the stuff that ntolland was talking about earlier to knife-block
[2012-03-21 16:34:00 -0400] proffalken: specifically the ability to use a given server/env in the same command
[2012-03-21 16:34:00 -0400] proffalken: i.e. knife block use <server> <env>
[2012-03-21 16:35:00 -0400] proffalken: I'm just wondering what the most sensible way to approach it would be
[2012-03-21 16:35:00 -0400] proffalken: BryanWB: I mean can it read the "chef environment" from a "shell environment"
[2012-03-21 16:35:00 -0400] proffalken: i.e. export CHEF_ENV="_default"
[2012-03-21 16:36:00 -0400] proffalken: and then read that back in
[2012-03-21 16:36:00 -0400] BryanWB: sure
[2012-03-21 16:36:00 -0400] BryanWB: in the ENV object
[2012-03-21 16:36:00 -0400] BryanWB: puts ENV['CHEF_ENV']
[2012-03-21 16:37:00 -0400] proffalken: right, but will Knife read that automatically (as if I had passed "-E") when the next command is run (knife node list for example)?
[2012-03-21 16:38:00 -0400] proffalken: so I run "knife block opscode-hosted staging" and all subsequent commands run against the Opscode Hosted Chef server in the "staging" environment
[2012-03-21 16:41:00 -0400] tduffield: what types of commands are you looking to run against the environment?
[2012-03-21 16:44:00 -0400] proffalken: tduffield: knife node list and all the usual ones really
[2012-03-21 16:45:00 -0400] proffalken: tduffield: I wrote knife-block earlier today to help me switch between chef servers
[2012-03-21 16:45:00 -0400] proffalken: I thought it might be nice to be able to change the environments at the same time (or at least have the ability to do so)
[2012-03-21 16:46:00 -0400] BryanWB: proffalken: dont' think so
[2012-03-21 16:47:00 -0400] proffalken: ah well, never mind... :)
[2012-03-21 17:02:00 -0400] jtimberman: proffalken: i meant "javascript" by, "when editing json in vim, use a javascript filetype plugin"
[2012-03-21 17:02:00 -0400] jtimberman: :)
[2012-03-21 17:02:00 -0400] jtimberman: corp: ohai :)
[2012-03-21 17:02:00 -0400] proffalken: jtimberman: heh, fair enough, troll allegation recinded...
[2012-03-21 17:04:00 -0400] corp: jtimberman: how is the world of chef?
[2012-03-21 17:04:00 -0400] corp: is anyone using Librarian?
[2012-03-21 17:07:00 -0400] pauldale: Hi everyone, I've been searching for a good solution to make sure that starting up a node with a particular role reattaches to the same EBS volume.
[2012-03-21 17:07:00 -0400] pauldale: Has anyone solved that problem?
[2012-03-21 17:19:00 -0400] cwj: pauldale: store the ebs volume id as an attribute in the role and have the role include a recipe that uses the aws cookbook's ebs_volume provider to attach the volume
[2012-03-21 17:19:00 -0400] cwj: ta da?
[2012-03-21 17:21:00 -0400] cwj: unless you are talking about using the ebs volume as your root volume
[2012-03-21 17:22:00 -0400] pauldale: @cwj That would assume pre-creating the volumes then ...
[2012-03-21 17:23:00 -0400] cwj: you can use the provider to create the volume and then save the volume id to a data bag instead of using a role attribute to store it
[2012-03-21 17:23:00 -0400] ank: pauldale: you can specify a snapshot-id in the attribute instead
[2012-03-21 17:23:00 -0400] ank: then save it like cwj mentioned
[2012-03-21 17:24:00 -0400] cwj: yes you can also use a snapshot when creating the volume
[2012-03-21 17:24:00 -0400] cwj: lots of options
[2012-03-21 17:25:00 -0400] pauldale: Ok, thanks. I was heading towards that sort of idea, but wanted to see if there was a more general solution existing.
[2012-03-21 17:29:00 -0400] ank: the centos bootstrap is failling on 'Cipher is not a module'. Only workaround I found is to compile ruby from source with openssl support. Is anyone else seeing that or is it cruft on my centos images?
[2012-03-21 17:30:00 -0400] fractaloop: If I specify a FQDN for a node, does it need need to resolve both directions?
[2012-03-21 17:36:00 -0400] mjreed: In FOSS chef-server, is there a way to look at the history of uploads for a given cookbook?  At least get a timestamp?
[2012-03-21 17:49:00 -0400] joshkraemer: Every time I run action :enable for a service on Debian 6.0 machine, it enables the service through update-rc.d. Debian >= 6.0 uses insserv for dependency-based booting. So if I want to use insserv to launch a service at boot (in Debian 6), I have to add a workaround in the recipe, rather than simply using action :enable for the service provider. Is this a known bug?
[2012-03-21 17:51:00 -0400] joshkraemer: I saw this ticket that might be related to the above issue - http://tickets.opscode.com/browse/CHEF-2034
[2012-03-21 17:56:00 -0400] fractaloop: How do I specify a node's IP in their node.rb file? `ip '173.12.34.56'` doesn't seem to work...
[2012-03-21 18:19:00 -0400] cwj: the attribute is 'ipaddress', but it will be overwritten by ohai the first time chef is run on the system, fwiw
[2012-03-21 18:22:00 -0400] chip-: Any good example cookbooks of doing booleans in templates based on attributes?
[2012-03-21 18:22:00 -0400] chip-: If attribute set print this in the rendered template, else don't.
[2012-03-21 18:22:00 -0400] chip-: that sort of thing
[2012-03-21 18:26:00 -0400] cwj: chip-: i usually do <%= node['foo'] ? 'everybody wang chung tonight' : 'nobody wang chung tonight' %>
[2012-03-21 18:28:00 -0400] cwj: or you could just do <% if node[foo] -%>everybody wang chung tonight<% end -%>
[2012-03-21 18:31:00 -0400] chip-: cwj: Fair enough. I've been doing "If node['foo'] == yes" so the attributes are a little clearer, but I hate using strings to represent booleans.
[2012-03-21 18:31:00 -0400] chip-: But people have proven themselves consistently unable to figure out that unset attribute means no
[2012-03-21 18:32:00 -0400] cwj: people are amazing. they are capable of being both great and terrible all at the same time
[2012-03-21 18:33:00 -0400] thehar: lulz
[2012-03-21 19:05:00 -0400] fractaloop: cwj: Thx
[2012-03-21 19:22:00 -0400] David_Miller: what is the most elegant way to set up users, root password, etc as soon as nodes register?
[2012-03-21 19:22:00 -0400] David_Miller: maybe put something in _default role?
[2012-03-21 19:23:00 -0400] David_Miller: envirnoment i mean
[2012-03-21 19:24:00 -0400] mattray: David_Miller: here's a repo I put together in a training session: https://github.com/mattray/ravel-repo
[2012-03-21 19:24:00 -0400] miah: moin
[2012-03-21 19:25:00 -0400] mattray: David_Miller: base role sets up chef-client, sudoers, ntp
[2012-03-21 19:25:00 -0400] mattray: and users
[2012-03-21 19:26:00 -0400] chip-: David_Miller: My base role covers a lot, but roughly: Add yum/apt support as appropriate, download chef-client config, start chef-client service, delete validation key, set up sudoers, install users, set up resolver, set up ntp, set up postfix, install screen, install zip, set up nrpe, install svn, install git, set up iptables.
[2012-03-21 19:28:00 -0400] David_Miller: mattray: why are there no cookbooks in your repo?
[2012-03-21 19:28:00 -0400] mattray: David_Miller: I use spiceweasel to download them from the community site
[2012-03-21 19:28:00 -0400] David_Miller: where can I see how that works inside your repo?
[2012-03-21 19:29:00 -0400] mattray: 1 sec
[2012-03-21 19:30:00 -0400] mattray: https://gist.github.com/2151736
[2012-03-21 19:30:00 -0400] mattray: it's a starter repo
[2012-03-21 19:31:00 -0400] mattray: after you run that, you'll have everything up on the server
[2012-03-21 19:32:00 -0400] David_Miller: Ill have to do more learning, I have never used the community cookbooks, or data bags for that matter
[2012-03-21 19:33:00 -0400] pcn: You really get a lot from the community cookbooks.  Really, from everything on github.
[2012-03-21 19:34:00 -0400] pcn: I think I've learned the most from infochimps, heavywater and some others
[2012-03-21 19:34:00 -0400] David_Miller: well let me see if I am "getting" the broad overview,  You are creating a role called base, filling it with alot of community cookbooks, which are configured by data bags
[2012-03-21 19:35:00 -0400] David_Miller: is that a correct description of what's going on?
[2012-03-21 19:35:00 -0400] mattray: David_Miller: yes
[2012-03-21 19:35:00 -0400] mattray: all off the shelf stuff
[2012-03-21 19:35:00 -0400] David_Miller: ok so I am not totally lost :)
[2012-03-21 19:35:00 -0400] mattray: the mray.json is there as an example
[2012-03-21 19:36:00 -0400] mattray: you could use your own users, but feel free to give me logins to all your boxes :)
[2012-03-21 19:38:00 -0400] David_Miller: thanks everyone who chimed in, i will figure this out
[2012-03-21 19:44:00 -0400] David_Miller: ok here's a problem
[2012-03-21 19:45:00 -0400] David_Miller: I use the webui to configure envirnoments, roles, overrrides, etc
[2012-03-21 19:45:00 -0400] David_Miller: when I try to edit the _default enviornment I get a white screen
[2012-03-21 19:47:00 -0400] jvoorhis: hello
[2012-03-21 19:47:00 -0400] mattray: David_Miller: sounds like a bug, but you can't edit the _default environment
[2012-03-21 19:48:00 -0400] mattray: if you want to start using environments, move stuff out of '_default'
[2012-03-21 19:48:00 -0400] mattray: it's there for people not explicitly using them
[2012-03-21 19:49:00 -0400] David_Miller: ahh ok.  How do I get my base role to be run on nodes the first time they connect
[2012-03-21 19:50:00 -0400] mattray: you have a number of options, depending on how you're getting your nodes
[2012-03-21 19:51:00 -0400] mattray: if you're using knife ec2/rackspace/etc. just pass -r "role[base]" with your arguments
[2012-03-21 19:51:00 -0400] mattray: same with knife bootstrap
[2012-03-21 19:51:00 -0400] David_Miller: nodes come up with chef-client already installed (no knife bootstrapping)
[2012-03-21 19:51:00 -0400] asfallows: Hey all - I have what I suspect is a pretty basic error. I'm running chef-client on OS X and although I have a custom /etc/chef/client.rb file, the program still tries to run with defaults (localhost as server url). How do I get the client to look in the right place?
[2012-03-21 19:51:00 -0400] mattray: magical nodes fully formed with Chef on them? I like it.
[2012-03-21 19:52:00 -0400] mattray: you can just do knife node run list add NODENAME "role[base]"
[2012-03-21 19:52:00 -0400] mattray: and next time the chef-client runs it'll pick that up
[2012-03-21 19:52:00 -0400] chip-: You should use environments. They're great fences, and an under-appreciated feature.
[2012-03-21 19:52:00 -0400] David_Miller: Yeah thats what I do, but I want to trigger a chef run immediatly after, but I can't because the root password is randomized on rackspace
[2012-03-21 19:52:00 -0400] bencaron: asfallows: you should be able to add -c /etc/chef/client.rb
[2012-03-21 19:52:00 -0400] mattray: you could also have whoever is creating these nodes add it to the first-boot.json for the nodes
[2012-03-21 19:52:00 -0400] bencaron: but it feels wrong having to force it
[2012-03-21 19:53:00 -0400] josephholsten: David_Miller: `echo '{"run_list:["role[base]"]}" > first-run.json && chef-client -j first-run.json`
[2012-03-21 19:53:00 -0400] mattray: David_Miller: so you don't have root on the boxes?
[2012-03-21 19:55:00 -0400] David_Miller: I do have root, but everytime a node is instantiated rackspace changes the root pw,  otherwise I would to the knife node run list add  .....; knife ssh ... 'chef-client'
[2012-03-21 19:55:00 -0400] asfallows: bencaron: So, I'm probably misunderstanding the purpose of something. I did the "Chef Hello World" tutorial which uses chef-solo, and inferred that the -c flag was a recipe/cookbook specifc config in addition to the base config. Is that not the case?
[2012-03-21 19:56:00 -0400] David_Miller: josephholsten: yeah I will probably use first-run
[2012-03-21 19:56:00 -0400] David_Miller: thanks
[2012-03-21 19:56:00 -0400] David_Miller: /to/do
[2012-03-21 19:56:00 -0400] dyer: Hey guys, I have a question about the ohai cookbook, it references chef::config recipe but I am not seeing that in the chef cookbook, am I missing something?
[2012-03-21 19:56:00 -0400] josephholsten: anyone got a reason I should prefer using opscode's cookbook for pdns vs djbdns vs maradns?
[2012-03-21 19:56:00 -0400] bencaron: asfallows: hum, i'v not used much chef-solo, not sure what's the implication with a chef-client run afterward
[2012-03-21 19:57:00 -0400] bencaron: but things is, normally /etc/chef/client.rb will be looked up by default by chef-client
[2012-03-21 19:57:00 -0400] mattray: dyer: where's that?
[2012-03-21 19:57:00 -0400] bencaron: so no idea why you would need to force it. the install method perhaps?
[2012-03-21 19:58:00 -0400] dyer: http://community.opscode.com/cookbooks/ohai  "  Set the Ohai plugin path with the config setting "Ohai::Config[:plugin_path]" in the Chef config file (the chef::config recipe does this automatically for you!).  "
[2012-03-21 19:58:00 -0400] David_Miller: josephholsten: i like all djb's stuff
[2012-03-21 19:58:00 -0400] bencaron: asfallows: is this for a windows server? the hello world I googled  is http://support.rightscale.com/12-Guides/Windows_User_Guide/Windows_Tutorials/Chef-Tutorial-Windows
[2012-03-21 19:58:00 -0400] asfallows: bencaron: the chef-solo invocation had worked on the server machine, so I was trying chef-client with identical arguments on a separate machine as a test, which included a -c flag. I just tried dropping the -c flag and it seems to have worked, so I guess I misunderstood the purpose of the flag.
[2012-03-21 19:59:00 -0400] josephholsten: dyer: that's a bug. I think that's chef-client::default now
[2012-03-21 19:59:00 -0400] asfallows: bencaron: I used this one: http://www.morethanseven.net/2010/10/30/Chef-hello-world.html
[2012-03-21 19:59:00 -0400] asfallows: Server is Ubuntu, client is OS X
[2012-03-21 20:00:00 -0400] bencaron: ok, at first glance, the article seems to imply running solo all the time? anyway, if it works :)
[2012-03-21 20:01:00 -0400] bencaron: the typical setup would go chef-solo to install chef server, then you point to this server for your nodes
[2012-03-21 20:01:00 -0400] asfallows: Yep. I ran into other errors, but as we all know, new errors means progress.
[2012-03-21 20:02:00 -0400] mattray: asfallows: it's possible that article may be a little dated
[2012-03-21 20:02:00 -0400] josephholsten: dyer: actually it's chef-client::config, referencing chef-client's template for config.rb
[2012-03-21 20:02:00 -0400] bencaron: asfallows: i agree with mattray: maybe outdate. start with the wiki?
[2012-03-21 20:03:00 -0400] bencaron: http://wiki.opscode.com/display/chef/Guides has lots of things
[2012-03-21 20:03:00 -0400] bencaron: wish they would have been available when I started ;)
[2012-03-21 20:03:00 -0400] josephholsten: +1
[2012-03-21 20:04:00 -0400] mattray: and don't forget it's a wiki, so if something is wrong, please fix it :)
[2012-03-21 20:04:00 -0400] asfallows: bencaron: Yeah, I realize now that the issue I'd been trying to resolve was actually a case of misunderstanding a step in the tutorial. Ah well.
[2012-03-21 20:06:00 -0400] bencaron: asfallows: I'm sure there is a nice Zen quotes that would go with that :)
[2012-03-21 20:06:00 -0400] jtimberman: josephholsten: my djbdns cookbook is awesome you should use it :D
[2012-03-21 20:07:00 -0400] jtimberman: josephholsten: also thank you for your ticket gardening recently.
[2012-03-21 20:07:00 -0400] josephholsten: any reason over the maradns and pdns ones?
[2012-03-21 20:07:00 -0400] bencaron: but keep going, it's so good when you finally have everything together
[2012-03-21 20:07:00 -0400] josephholsten: I enjoy a good bonsai session
[2012-03-21 20:08:00 -0400] jtimberman: dyer: do you mean line 37, !(::IO.read(Chef::Config[:config_file]) =~ /Ohai::Config\[:plugin_path\]\s*<<\s*["']#{node['ohai']['plugin_path']}["']/)
[2012-03-21 20:08:00 -0400] jtimberman: dyer: Chef::Config is the configuration object in Chef, not a cookbook/recipe
[2012-03-21 20:08:00 -0400] jtimberman: josephholsten: depends on which you want to use for your DNS server?
[2012-03-21 20:08:00 -0400] jtimberman: josephholsten: there's a bit more capability out of the djbdns cookbook.
[2012-03-21 20:09:00 -0400] josephholsten: I don't have enough experience to weigh options
[2012-03-21 20:09:00 -0400] jtimberman: josephholsten: i was going to make the pdns cookbook better but wound up not using it.
[2012-03-21 20:09:00 -0400] jtimberman: anything is better than bind though :)
[2012-03-21 20:09:00 -0400] blackjid: HI! it's by design that in my wokrstation I have to connect to the nodes to run de runlists? or i'm doing something wrong? can I tell the server... to run some run_list on specific nodes?
[2012-03-21 20:09:00 -0400] jtimberman: dyer: also, the "chef" cookbook is deprecated and replaced by chef-cilent and chef-server cookbooks respectively.
[2012-03-21 20:09:00 -0400] asfallows: bencaron: Thanks for the help!
[2012-03-21 20:10:00 -0400] bencaron: asfallows: good luck!
[2012-03-21 20:10:00 -0400] josephholsten: jtimberman, dyer: he's referring to Attributes2 inhttps://github.com/opscode-cookbooks/ohai/blob/master/README.md
[2012-03-21 20:11:00 -0400] dyer: ty
[2012-03-21 20:12:00 -0400] jtimberman: oh wow
[2012-03-21 20:12:00 -0400] jtimberman: thatso ld :)
[2012-03-21 20:12:00 -0400] blackjid: I'm trying to run the application cookbook in opscode in order to install rails app. But it keeps telling me that chef_environment if not defined. Any idea?
[2012-03-21 20:12:00 -0400] jtimberman: sorry
[2012-03-21 20:13:00 -0400] jtimberman: blackjid: what version of chef are you using, and are you using a chef server?
[2012-03-21 20:13:00 -0400] josephholsten: and go: http://tickets.opscode.com/browse/COOK-1128
[2012-03-21 20:15:00 -0400] josephholsten: blackjid: what version of chef is on your node?
[2012-03-21 20:15:00 -0400] josephholsten: blackjid: it needs to be >=0.10.0
[2012-03-21 20:18:00 -0400] blackjid: sorry, i'm checking..
[2012-03-21 20:18:00 -0400] hoover_damm: quite old, the chef cookbook was deprecated around 0.8.x no?
[2012-03-21 20:18:00 -0400] hoover_damm: heh
[2012-03-21 20:20:00 -0400] blackjid: ok, chef-server is 0.10.8   and the chef-client on the node is 0.9.14
[2012-03-21 20:20:00 -0400] josephholsten: you need the client to be running >=0.10.0 to support the version of the application cookbook you're using
[2012-03-21 20:21:00 -0400] hones: Has anyone else run into a need for doing notifications of resources at compile-time? If so, any examples for me to grok, if not, your chosen path to avoid the need?
[2012-03-21 20:21:00 -0400] blackjid: ok, i'm going to try updating it..
[2012-03-21 20:24:00 -0400] spicyWith: what's the best way to remove a cookbook from a chef-repo? I think my repo has gotten out of shape
[2012-03-21 20:27:00 -0400] erikh: git rm
[2012-03-21 20:27:00 -0400] josephholsten: spicyWith: the git repo or the chef-server?
[2012-03-21 20:27:00 -0400] hippiehacker: is there a reason the opscode powershell forces version 2.0. 2008R1 comes with 1.0 as a feature (no reboot required), and applying version 2.0 requires a reboot
[2012-03-21 20:28:00 -0400] josephholsten: hippiehacker: if find out, please let me know
[2012-03-21 20:32:00 -0400] spicyWith: erikh: no knife command necessary? because even though I did that, I tried installing another cookbook (for mongodb) with the same name and it put it under cookbooks/s/mongodb instead of cookbooks/mongodb
[2012-03-21 20:34:00 -0400] erikh: ah I don't use knife to import cookbooks
[2012-03-21 20:41:00 -0400] spicyWith: erikh: how would you import a cookbook from github in that case? as a submodule?
[2012-03-21 20:43:00 -0400] erikh: I never have a need to
[2012-03-21 20:43:00 -0400] erikh: dunno
[2012-03-21 20:43:00 -0400] erikh: probably just download a tarball.
[2012-03-21 20:45:00 -0400] dajia: Hello, all.
[2012-03-21 20:45:00 -0400] dajia: Can someone tell me how to specify an alternate path for cookbook_file sources?  i.e. instead of files/default/foo, I would like to use files/foo/foo
[2012-03-21 20:46:00 -0400] josephholsten: with knife or chef-client or chef-solo?
[2012-03-21 20:47:00 -0400] bemu: Anyone using a dynect cookbook? If so, which?
[2012-03-21 20:47:00 -0400] hcastro: spicyWith: i'd use one of these two tools: https://github.com/applicationsonline/librarian https://github.com/websterclay/knife-github-cookbooks
[2012-03-21 20:47:00 -0400] spicyWith: hcastro: trying to use the latter
[2012-03-21 20:48:00 -0400] miah: bemu: iirc, fujin was saying that the dynect cookbook seemed broken
[2012-03-21 20:49:00 -0400] bemu: Thanks.
[2012-03-21 20:49:00 -0400] corp: is there a way to scope role attributes to a specific environment?
[2012-03-21 20:50:00 -0400] miah: add the attributes in a environment
[2012-03-21 20:51:00 -0400] miah: attributes?
[2012-03-21 20:51:00 -0400] bawt_: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-03-21 20:51:00 -0400] spicyWith: anyone know what the current state of the art mongodb cookbook is?
[2012-03-21 20:51:00 -0400] corp: miah: that's not much fun
[2012-03-21 20:51:00 -0400] miah: why not?
[2012-03-21 20:51:00 -0400] fujin: nyeh
[2012-03-21 20:52:00 -0400] fujin: i rewrote the cookbook laxt night to use fog dynect provider
[2012-03-21 20:52:00 -0400] corp: miah: because the attributes are for the role and the environment. i want them to be visible in the role
[2012-03-21 20:52:00 -0400] corp: roles allow you to scope run lists, for example
[2012-03-21 20:52:00 -0400] corp: per-environment
[2012-03-21 20:52:00 -0400] miah: right
[2012-03-21 20:52:00 -0400] corp: now i just use a role per-environment. just wondering if there's a reason to change
[2012-03-21 20:53:00 -0400] miah: ah. that feature is probably on the same request as 'versioned environments and roles'
[2012-03-21 20:53:00 -0400] corp: well. i'm just wondering what the real use of environments is
[2012-03-21 20:53:00 -0400] corp: when you can just have a role per-environment
[2012-03-21 20:53:00 -0400] miah: to override attributes on a specific group of aservers
[2012-03-21 20:53:00 -0400] bemu: fujin: Link? Pauzed is working on the implementing for us.
[2012-03-21 20:53:00 -0400] corp: you can search on that role, and set attributes like always
[2012-03-21 20:53:00 -0400] miah: and that group of servers may contain multiple roles
[2012-03-21 20:54:00 -0400] fujin: bemu: i literally wrote it last night, not released it
[2012-03-21 20:54:00 -0400] bemu: spicyWith: They're all pretty shit. It's just a question of what you're looking for.
[2012-03-21 20:54:00 -0400] dyer: Is there anyway in chef to remove any downloaded artifacts if a chef run fails?
[2012-03-21 20:54:00 -0400] bemu: ah, okay, I can wait.
[2012-03-21 20:54:00 -0400] miah: eg, i use my environments to set attributes for domains. eg, stage gets specific attributes set in urls and domains
[2012-03-21 20:54:00 -0400] corp: miah: sure. but is there really a big difference between specifying  environment 'dev' and role[dev]?
[2012-03-21 20:54:00 -0400] fujin: i don't really want to fork the dynect cookbook but that dynect_rest was busted and not updated for ages
[2012-03-21 20:54:00 -0400] miah: yes. less code to manage
[2012-03-21 20:55:00 -0400] miah: if you have multiple roles that are extremely similar then you fail dry
[2012-03-21 20:55:00 -0400] corp: miah: how so? i only have one dev role
[2012-03-21 20:55:00 -0400] miah: environments can also version pin cookbooks
[2012-03-21 20:56:00 -0400] corp: essentially an environment is just a place to dump attributes. like a role
[2012-03-21 20:56:00 -0400] bemu: You can also key environment variables by role.
[2012-03-21 20:56:00 -0400] miah: there are similarities, but different features
[2012-03-21 20:56:00 -0400] corp: so the version pin thing is the only unique feature it has currently?
[2012-03-21 20:56:00 -0400] miah: look at the code, i don't think its the only unique thing
[2012-03-21 20:58:00 -0400] bemu: For instance, I have a role called scribe, which has an attribute which is the key to the environment variable. I guess that doesn't make a lot of sense.
[2012-03-21 20:58:00 -0400] bemu: But if you use the same recipe across multiple roles and environments, it is helpful.
[2012-03-21 21:02:00 -0400] segv: can you have conditional attributes?
[2012-03-21 21:02:00 -0400] josephholsten: segv: only within cookbooks
[2012-03-21 21:03:00 -0400] segv: josephholsten: yeah like custom attributes file, there can be conditionals within that right?
[2012-03-21 21:03:00 -0400] josephholsten: yep
[2012-03-21 21:03:00 -0400] segv: sweeet
[2012-03-21 21:03:00 -0400] segv: Saved me a lot of work, heh.
[2012-03-21 21:04:00 -0400] josephholsten: esp `case platform; when 'windows' , when 'ubuntu' ; else ; end`
[2012-03-21 21:05:00 -0400] segv: josephholsten: yeah
[2012-03-21 21:05:00 -0400] segv: i was going to do it for OS attributes
[2012-03-21 21:05:00 -0400] corp: miah: yep, i am looking. so far i only see the cookbook version pin, and attributes just like roles
[2012-03-21 21:05:00 -0400] jtimberman: segv: have a look at http://ckbk.it/apache2 source, the attributes there has a load of examples.
[2012-03-21 21:06:00 -0400] corp: i'm not complaining. just want to know the direction and intended usage
[2012-03-21 21:06:00 -0400] segv: jtimberman: thanks, i'll take a gander
[2012-03-21 21:07:00 -0400] miah: corp: indeed. i use it for version pinning and overriding role based attributes that i want set in that environment
[2012-03-21 21:07:00 -0400] spicyWith: bemu: ideally I'd want something to set up a raid array, provision mongo, and go as far as configuring a replicaset and shard
[2012-03-21 21:07:00 -0400] corp: i dont version my cookbooks. maybe a good time to do that
[2012-03-21 21:09:00 -0400] blackjid: josephholsten: thanks!, it did run.
[2012-03-21 21:10:00 -0400] blackjid: now it doesn't show any error, rails doesn't get installed... any idea?
[2012-03-21 21:11:00 -0400] bemu: spicyWith: The edelight cookbook will do that, with a few bug fixes. Not the raid array though.
[2012-03-21 21:11:00 -0400] josephholsten: blackjid: are you using gem bundler?
[2012-03-21 21:31:00 -0400] blackjid:  josephholsten: I don't really know, but it worked, it was my fault, I was calling  chef.add_recipe(application) instead of chef.add_role(my_app)
[2012-03-21 21:39:00 -0400] miah: what cookbook are people using to manage redis? the ironfan stuff looks good but also a huge undertaking.
[2012-03-21 21:40:00 -0400] senthilr: is anyone using ironfan in production
[2012-03-21 21:40:00 -0400] senthilr: would like to hear their inputs
[2012-03-21 21:40:00 -0400] miah: im sure
[2012-03-21 21:43:00 -0400] flashmanbahadur: miah: I just rolled my own
[2012-03-21 21:43:00 -0400] miah: ya?
[2012-03-21 21:43:00 -0400] miah: i'd consider that, but super busy
[2012-03-21 21:43:00 -0400] miah: is it on github? =)
[2012-03-21 21:44:00 -0400] flashmanbahadur: miah: not yet, but nothing really special
[2012-03-21 21:44:00 -0400] flashmanbahadur: basically a templated config file
[2012-03-21 21:44:00 -0400] flashmanbahadur: health checks (nagios style) are implemented via a provider from another cookbook
[2012-03-21 21:45:00 -0400] flashmanbahadur: underlying disk raid created/managed using yet another provider from another one of my cookbooks
[2012-03-21 21:46:00 -0400] flashmanbahadur: but the redis setup itself is config template, using an ubuntu ppa for package updating, and checking it's role for slave/master status and searching nodes to find it's master
[2012-03-21 21:46:00 -0400] flashmanbahadur: tbh wasn't that bad at all
[2012-03-21 21:47:00 -0400] flashmanbahadur: redis is dead simple to set up
[2012-03-21 21:47:00 -0400] bemu: miah: There are some pretty significant updates to Redis in the most recent versions, including actually tracking misses in a real way.
[2012-03-21 21:48:00 -0400] bemu: I started with Benjamin Blacks Redis cookbook, 3.0.5
[2012-03-21 21:49:00 -0400] bemu: I'm sorry, rather, that's the one we moved to.
[2012-03-21 21:49:00 -0400] bemu: and it started at 3.0.4
[2012-03-21 21:50:00 -0400] bemu: Using the install_from_release recipe along with server. It works.
[2012-03-21 21:51:00 -0400] miah: bemu: link?
[2012-03-21 21:52:00 -0400] bemu: So, to answer your question specifically, we use the infochimps cookbook, but don't use their stuff outside of this cookbook.
[2012-03-21 21:52:00 -0400] bemu: https://github.com/infochimps-cookbooks/redis
[2012-03-21 21:52:00 -0400] miah: ok
[2012-03-21 21:52:00 -0400] miah: so, im trying to use that. not quite working yet. must be doing _something_ wrong =)
[2012-03-21 21:52:00 -0400] bemu: What's the error?
[2012-03-21 21:53:00 -0400] cb219_: hello all, i'm writing an exception handler and I'd like to know if there is anyway to get the currently executing recipe from the state available to this handler?
[2012-03-21 21:53:00 -0400] bemu: The only problem I had was it not having a depends line on sysctl
[2012-03-21 21:53:00 -0400] bemu: and not having all of the required cookbooks initially.
[2012-03-21 21:53:00 -0400] cb219_: I suppose i could parse exception it seems to contain the string but i'd like to know if there is any more structured approach. Thanks
[2012-03-21 21:53:00 -0400] miah: https://gist.github.com/d6e22e3dbaa9b371a812
[2012-03-21 21:53:00 -0400] bemu: If you're using collectd, we have a rudimentary recipe to do metrics on redis also
[2012-03-21 21:54:00 -0400] bemu: What version of the metachef cookbook?
[2012-03-21 21:54:00 -0400] miah: we aren't currently using collectd, but i'm likely going to set it up again soon with grpahite
[2012-03-21 21:54:00 -0400] bemu: We're on 3.0.4
[2012-03-21 21:54:00 -0400] miah: ya, 3.0.4 for both
[2012-03-21 21:55:00 -0400] bemu: Ruby version?
[2012-03-21 21:55:00 -0400] bawt_: Ruby version is ruby 1.8.7 (2009-06-12 patchlevel 174) [x86_64-linux]
[2012-03-21 21:55:00 -0400] bemu: bawrt_: Forget ruby version?
[2012-03-21 21:55:00 -0400] bemu: bawt_: Forget ruby version?
[2012-03-21 21:55:00 -0400] bawt_: couldn't find keyword ruby version?
[2012-03-21 21:55:00 -0400] miah: hah
[2012-03-21 21:55:00 -0400] bemu: bawrt_: Forget ruby version
[2012-03-21 21:55:00 -0400] bemu: jeeez
[2012-03-21 21:55:00 -0400] bemu: bawt_: Forget ruby version
[2012-03-21 21:55:00 -0400] bawt_: okay then :)
[2012-03-21 21:55:00 -0400] miah: ya. default ubuntu.. ruby 1.8.7 (2010-08-16 patchlevel 302) [x86_64-linux]
[2012-03-21 21:55:00 -0400] bemu: Thanks.
[2012-03-21 21:55:00 -0400] bemu: Check to see if that syntax is proper for 1.8?
[2012-03-21 21:57:00 -0400] miah: yar. extra work :/
[2012-03-21 21:58:00 -0400] bemu: I did it for you.
[2012-03-21 21:58:00 -0400] bemu: Upgrade to 1.9 ;)
[2012-03-21 21:59:00 -0400] bemu: miah: ^
[2012-03-21 21:59:00 -0400] Zeelot: hey guys, I have this in an 'execute' section but it's simply being ignored: environment ({"KOHANA_ENV" => node[:site][:environment]})
[2012-03-21 21:59:00 -0400] Zeelot: anyone know why?
[2012-03-21 22:00:00 -0400] Zeelot: I use that attribute somewhere else and it works so it's definitely simply not working in this command
[2012-03-21 22:06:00 -0400] miah: bemu: ya. its the unfortunate thing about my rollout. my chef clients run on ubuntu's default ruby 1.8
[2012-03-21 22:06:00 -0400] bemu: How well, though?
[2012-03-21 22:06:00 -0400] miah: its something i need to fix, but haven't spent much time on searching for the best solution
[2012-03-21 22:06:00 -0400] bemu: I was having segfaults on the stock ruby package on 11.04
[2012-03-21 22:07:00 -0400] bemu: We've been using omnibus in production for a few weeks, very pleased.
[2012-03-21 22:07:00 -0400] Zeelot: can't seem to figure this out :( can't even temporarily put the environment variable at the beginning of the command
[2012-03-21 22:07:00 -0400] miah: nice
[2012-03-21 22:07:00 -0400] bemu: I have't bootstrapped an existing node, though, so not sure how that would go. Have only been creating new ones that way.
[2012-03-21 22:08:00 -0400] bemu: I'm not 100% sure omnibus comes with 1.9 by default.
[2012-03-21 22:09:00 -0400] miah: i havent really run into any ruby 1.8 / 1.9 issues with chef
[2012-03-21 22:09:00 -0400] blackjid: blackjid
[2012-03-21 23:14:00 -0400] ryan-eme: anyone used utf8 for erb templates in chef before?
[2012-03-21 23:17:00 -0400] ryan-eme: more specifically utf8 with a bom
[2012-03-21 23:19:00 -0400] josephholsten: definitely haven't, you having exciting bom times?
[2012-03-21 23:21:00 -0400] ryan-eme: so exciting
[2012-03-21 23:22:00 -0400] josephholsten: then I hope you also get to enjoy the experience of surrogate pairs!
[2012-03-21 23:26:00 -0400] ryan-eme: gosh I hope not
[2012-03-21 23:28:00 -0400] josephholsten: metadata.json
[2012-03-21 23:29:00 -0400] josephholsten: ergh
