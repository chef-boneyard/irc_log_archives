[2012-03-14 07:01:00 -0400] juanje: BryanWB: morning! :-)
[2012-03-14 07:01:00 -0400] BryanWB: juanje:  buenos dias!
[2012-03-14 07:02:00 -0400] BryanWB: ssd7_: back to your hack for returning vars from lwrps, i now think it is better to hang values off node object
[2012-03-14 07:02:00 -0400] BryanWB: ssd7_: have a moment to discuss this?
[2012-03-14 07:03:00 -0400] BryanWB: this is about my tomcat lwrp from a couple weeks ago
[2012-03-14 07:07:00 -0400] BryanWB: jtimberman: think u can do foodfight next week?
[2012-03-14 09:24:00 -0400] lflux: ohai
[2012-03-14 10:12:00 -0400] ProfFalken: ohai! Yesterday someone posted a good link to debugging with shef but I've promptly gone and lost it...
[2012-03-14 10:12:00 -0400] ProfFalken: any chance someone could report?
[2012-03-14 10:12:00 -0400] ProfFalken: s/report/repost
[2012-03-14 10:12:00 -0400] ProfFalken: thanks :)
[2012-03-14 10:12:00 -0400] BryanWB: ProfFalken: it is on ssd7_ 's blog
[2012-03-14 10:12:00 -0400] BryanWB: http://stevendanna.github.com/
[2012-03-14 10:13:00 -0400] ProfFalken: BryanWB: thanks, just found it via the FoodFight show notes... :)
[2012-03-14 10:47:00 -0400] Axsuul: What do you guys recommend for setting up an email server?
[2012-03-14 10:48:00 -0400] BryanWB: posfix
[2012-03-14 10:49:00 -0400] Axsuul: thanks bryanl
[2012-03-14 10:49:00 -0400] Axsuul: BryanWB
[2012-03-14 10:52:00 -0400] ProfFalken: ummm, so I fixed the issues I was having yesterday with search(:node, "roles:foo....")
[2012-03-14 10:54:00 -0400] ProfFalken: it *was* http://tickets.opscode.com/browse/CHEF-2346
[2012-03-14 10:55:00 -0400] BryanWB: ouch
[2012-03-14 10:56:00 -0400] ProfFalken: apparently those limits have already been lifted in production... :D
[2012-03-14 10:56:00 -0400] tolland: so i noticed now that now i cant make any changes to my my.cnf template, even if they are non changing, or i can take notify[service] etc from the recipe
[2012-03-14 10:57:00 -0400] tolland: then i have to apply some further logic , are there any cookbooks with more sophisticated recipes for handling mysql restarts across test/prod
[2012-03-14 11:15:00 -0400] ptrb: Hi! I applied a Role to a Node, but it failed. Somehow. I don't know anything more. Where can I look for more info?
[2012-03-14 13:22:00 -0400] bkocik: Can anyone see why Chef is trying to interpret a string variable as a file in this scenario? https://gist.github.com/2036412
[2012-03-14 13:23:00 -0400] bkocik: Line 70 in sysadmins.rb (from the error) is line 3 of sysadmins.rb in the gist. I didn't paste the entire recipe nor all the data, just the relevant parts.
[2012-03-14 13:31:00 -0400] asg: bkocik: can you gist your template .erb file as well
[2012-03-14 13:32:00 -0400] bkocik: asg: It's just this: <%= @public_key %>
[2012-03-14 13:32:00 -0400] bkocik: I just ran chef-client with debug and discovered that for some reason it's trying to call the string for my public_key var as an sh script.
[2012-03-14 13:33:00 -0400] bkocik: DEBUG: sh(ssh-rsa AAAAB3NzaC1yc2EAAAADA.
[2012-03-14 13:34:00 -0400] bkocik: I wonder if it's my "only_if" line that's doing it
[2012-03-14 13:35:00 -0400] asg: the only diff between what I use and what you are using is 'variables(:key => peep['sshkey'])' instead of 'variables :foo => u['bar']'. Shouldn't matter but it might be worth trying.
[2012-03-14 13:37:00 -0400] ryan-roemer: Hi.  I have a libraries/foo.rb file, that has a method that I want to use in an attributes file.  How do I include this?
[2012-03-14 13:37:00 -0400] bkocik: ryan-roemer: You can't. Attributes files are converted to JSON, they're never executed in a Ruby interpreter.
[2012-03-14 13:37:00 -0400] bkocik: ryan-roemer: You can use it in a recipe, though.
[2012-03-14 13:38:00 -0400] ryan-roemer: @bkocik  The existing code populates the default values from a databag.  How does that work, if no execution happens?
[2012-03-14 13:38:00 -0400] BryanWB: ryan-roemer: u can include it
[2012-03-14 13:38:00 -0400] ryan-roemer: @bkocik  and thanks!  I'm very new to Ruby and just getting started with Chef...
[2012-03-14 13:39:00 -0400] ryan-roemer: @BryanWB  so a straight "include MyModule" at the top?
[2012-03-14 13:39:00 -0400] bkocik: ryan-roemer: Oh, I might be flat wrong - sorry, BryanWB will give you better information than I can. Ignore me. Sorry.
[2012-03-14 13:39:00 -0400] BryanWB: bkocik: sorry, thought he meant in recipe code
[2012-03-14 13:39:00 -0400] bkocik: Or not. :)
[2012-03-14 13:39:00 -0400] bkocik: ryan-roemer: I'm not sure how all the magic of getting data bag stuff into attributes and recipes works, but I do know that attribute files are only declarative, they can't have behavior. I ran into that a week or two ago (I'm new to Chef, too)
[2012-03-14 13:40:00 -0400] cwj: In my experince bkockik is correct, can't put ruby code in attributes
[2012-03-14 13:40:00 -0400] BryanWB: bkocik: r u sure attributes files are converted to json? i knew that was true of roles but i didn't think true of attributes files
[2012-03-14 13:41:00 -0400] bkocik: BryanWB: Woops, you're right. I am thinking of roles.
[2012-03-14 13:41:00 -0400] ryan-roemer: More specifically, here's my old code in the attributes file:
[2012-03-14 13:41:00 -0400] cwj: you can do some variable interpolation with other attributes but that's about it
[2012-03-14 13:41:00 -0400] bkocik: I should just shut the hell up before I really screw someone up.
[2012-03-14 13:41:00 -0400] ryan-roemer: def edb_item()
[2012-03-14 13:41:00 -0400] ryan-roemer:   edb_key = "secrets_#{node.chef_environment}"
[2012-03-14 13:41:00 -0400] ryan-roemer:   Chef::EncryptedDataBagItem.load(edb_key, "elasticsearch")
[2012-03-14 13:41:00 -0400] ryan-roemer: end
[2012-03-14 13:41:00 -0400] ryan-roemer: # (SD) Cloud secrets.
[2012-03-14 13:41:00 -0400] ryan-roemer: cloud = ( edb_item()["cloud"] rescue {} )
[2012-03-14 13:41:00 -0400] ryan-roemer: And I'm trying to just wrap that method up in a library as I'm using it all over the place...
[2012-03-14 13:42:00 -0400] BryanWB: ryan-roemer: u can use them in attributes files according to http://wiki.opscode.com/display/chef/Libraries
[2012-03-14 13:42:00 -0400] ryan-roemer: Yep  read that. I just can't figure out the syntax  the methods aren't showing up...
[2012-03-14 13:42:00 -0400] BryanWB: ryan-roemer: nice use btw, i should do something like that myself
[2012-03-14 13:43:00 -0400] bkocik: Hrm. I'm missing where that says they can be used in attributes. I wanted to do a similar thing last week with a function I wrote to spit out the IP address of the eth1 interface in a Rackspace Cloud host and couldn't seem to get there.
[2012-03-14 13:44:00 -0400] bkocik: Oh, right there at the top - it does say it.
[2012-03-14 13:44:00 -0400] ryan-roemer: I've tried monkeypatching Chef::EncryptedDataBagItem in the libraries/foo.rb file too, and that doesn't seem to quite do it either...
[2012-03-14 13:44:00 -0400] ryan-roemer: (Of course, I have barely any idea what I'm doing with Ruby ;) ).
[2012-03-14 13:44:00 -0400] BryanWB: maybe include_recipe ?
[2012-03-14 13:44:00 -0400] bkocik: See, I thought they were supposed to be auto-included, but I had to add a "depends" line to my recipes that wound up using the function because I kept getting "WTF are you talking about?" errors.
[2012-03-14 13:45:00 -0400] bkocik: Obviously I did something wrong.
[2012-03-14 13:45:00 -0400] bkocik: Oh, I bet it means within the recipes/attributes/etc of the same cookbook in which the library function is defined.
[2012-03-14 13:48:00 -0400] bkocik: asg: It turns out it was "only_if u['public_key']" that was doing it to me. I just meant to see if the variable was defined, but I guess Chef thought I meant for it to run that as a command and look at the return value.
[2012-03-14 13:50:00 -0400] asg: bkocik: ah, that makes sense. Glad you got it working.
[2012-03-14 13:50:00 -0400] bkocik: which I would have known had I read the documentation on only_if, which clearly states: "Only apply this resource if the given string (shell command) or block (ruby code) results in return code 0 or is true." I think today is gonna be one of those days for me.
[2012-03-14 14:39:00 -0400] ryan-roemer: bkocik, BryanWB: I finally figured it out  needed to include (/send) the method/mod to Chef::Node for the attributes file (instead of Chef::Recipe for the other stuff)
[2012-03-14 14:39:00 -0400] ryan-roemer: module SpanishDict
[2012-03-14 14:39:00 -0400] ryan-roemer:   module Common
[2012-03-14 14:39:00 -0400] ryan-roemer:     module Databag
[2012-03-14 14:39:00 -0400] ryan-roemer:       # Retrieve EDB item using convention databag.
[2012-03-14 14:39:00 -0400] ryan-roemer:       def edb_load(item)
[2012-03-14 14:39:00 -0400] ryan-roemer:         edb_key = "secrets_#{node.chef_environment}"
[2012-03-14 14:39:00 -0400] ryan-roemer:         Chef::EncryptedDataBagItem.load(edb_key, item)
[2012-03-14 14:39:00 -0400] ryan-roemer:       end
[2012-03-14 14:39:00 -0400] ryan-roemer:     end
[2012-03-14 14:39:00 -0400] ryan-roemer:   end
[2012-03-14 14:39:00 -0400] ryan-roemer: end
[2012-03-14 14:39:00 -0400] ryan-roemer: Chef::Recipe.send(:include, SpanishDict::Common::Databag)
[2012-03-14 14:39:00 -0400] ryan-roemer: Chef::Node.send(:include, SpanishDict::Common::Databag)
[2012-03-14 14:40:00 -0400] bkocik: ryan-roemer: Nice. You're doing better than I would have.
[2012-03-14 14:42:00 -0400] BryanWB: ryan-roemer: kewl, i wouldn't have thought of that
[2012-03-14 14:42:00 -0400] BryanWB: ryan-roemer: i recommend using github gist for snippets like that in the future
[2012-03-14 14:43:00 -0400] BryanWB: esp. cuz u can reference them later
[2012-03-14 14:44:00 -0400] ryan-roemer: BryanWB: Good point! (I'm also totally new to IRC too, so still picking up the conventions)
[2012-03-14 14:51:00 -0400] sivy: gooood morning
[2012-03-14 14:52:00 -0400] sivy: anyone running redis on ubuntu?
[2012-03-14 14:57:00 -0400] BryanWB: plus there is a nice emacs mode for gists ;)
[2012-03-14 15:04:00 -0400] bkocik: sivy: I might be. In that I have a recipe for installing it, and I think it worked. :)
[2012-03-14 15:05:00 -0400] bkocik: So, are JSON arrays in data bags not converted to Ruby arrays on execution?
[2012-03-14 15:05:00 -0400] sivy: bkocik: I have a recipe that ought to be working, but originally it was installing from apt, and it installed 1.2
[2012-03-14 15:05:00 -0400] sivy: so i switched to using the source recipe
[2012-03-14 15:05:00 -0400] sivy: which installs 2.4.8
[2012-03-14 15:05:00 -0400] sivy: but i still have 1.2 running smewhere
[2012-03-14 15:06:00 -0400] bkocik: Mine uses apt, too. I'm not sure how to ask what version it installed.
[2012-03-14 15:06:00 -0400] sivy: % redis-server -v reports 2.4.8, but redis-cli reports 1.2 when you run INFO
[2012-03-14 15:06:00 -0400] sivy: run redis-cli
[2012-03-14 15:06:00 -0400] sivy: then type INFO
[2012-03-14 15:06:00 -0400] sivy: one of the lines will be the server version
[2012-03-14 15:07:00 -0400] bkocik: redis_version:2.2.11
[2012-03-14 15:07:00 -0400] sivy: interesting
[2012-03-14 15:07:00 -0400] sivy: can you share your recipe?
[2012-03-14 15:07:00 -0400] bkocik: Sure. Actually I think I got it from Opscode
[2012-03-14 15:07:00 -0400] bkocik: Lemme see...
[2012-03-14 15:08:00 -0400] hoover_damm: sivy, I use mrflip's
[2012-03-14 15:08:00 -0400] hoover_damm: https://github.com/infochimps-cookbooks
[2012-03-14 15:08:00 -0400] hoover_damm: just 'redis'
[2012-03-14 15:08:00 -0400] sivy: i've been using ctrabold's
[2012-03-14 15:08:00 -0400] hoover_damm: you'll want to set the sysctl knob to vm.overcommit_memory=1
[2012-03-14 15:09:00 -0400] hoover_damm: as if you don't set that and you actually depend on redis's bgsaves
[2012-03-14 15:09:00 -0400] hoover_damm: you'll fail
[2012-03-14 15:09:00 -0400] hoover_damm: afaik no recipe does this
[2012-03-14 15:09:00 -0400] hoover_damm: (except one I provided for a client)
[2012-03-14 15:09:00 -0400] hoover_damm: but it's the clients so I can't share that.
[2012-03-14 15:09:00 -0400] hoover_damm: just a modification of the redis cookbook in there to enable that knob, several sysctl cookbooks to pick from
[2012-03-14 15:10:00 -0400] bkocik: sivy: I no longer remember where I got mine, but I'll throw it up in bitbucket and you can decide if you want it.
[2012-03-14 15:10:00 -0400] hoover_damm: but infochimps will compile from source
[2012-03-14 15:10:00 -0400] sivy: hoover_damm: can you share the node attributes you use with mrflip's
[2012-03-14 15:10:00 -0400] hoover_damm: which means you can always get the latest version
[2012-03-14 15:10:00 -0400] bkocik: (But mrflip's looks like a better one)
[2012-03-14 15:10:00 -0400] sivy: hoover_damm: thats the "install_from_release" recipe?
[2012-03-14 15:11:00 -0400] hoover_damm: sivy, yep
[2012-03-14 15:11:00 -0400] BryanWB: install_from_release is da best
[2012-03-14 15:11:00 -0400] hoover_damm: we don't really modify the attributes as they are fine by default
[2012-03-14 15:11:00 -0400] hoover_damm: redis::install_from_release and redis::server
[2012-03-14 15:11:00 -0400] BryanWB: though i like using the shorter name 'ark' for it
[2012-03-14 15:12:00 -0400] hoover_damm: short of writing your own source compile recipe
[2012-03-14 15:12:00 -0400] hoover_damm: you won't find better
[2012-03-14 15:12:00 -0400] sivy: hoover_damm: i'll give it a shot, thanks
[2012-03-14 15:13:00 -0400] hoover_damm: and yes this is one of those recipes I was able to take as is... and toss vm.overcommit_memory in another cookbook
[2012-03-14 15:13:00 -0400] hoover_damm: and win
[2012-03-14 15:13:00 -0400] sivy: hoover_damm: ok, newb q: how do i install this from github into my chef repo
[2012-03-14 15:13:00 -0400] geekbri: sivy: you'll find a nice explanation of th eneed for vm.overcommit_memory on the redis.io/topics/faq page btw
[2012-03-14 15:13:00 -0400] sivy: just clone into my cookbooks dir?
[2012-03-14 15:14:00 -0400] hoover_damm: sivy, i've been using librarian
[2012-03-14 15:14:00 -0400] sivy: hoover_damm: ah
[2012-03-14 15:14:00 -0400] geekbri: sivy: I personally suggest using librarian-chef, but you could in theory just pull it down and overwrite the CB in your cookboks dir
[2012-03-14 15:14:00 -0400] hoover_damm: sivy, so I just added it to my cheffile and told librarian to install and then uploaded
[2012-03-14 15:14:00 -0400] hoover_damm: sivy, I find my patterns with librarian not 100% great, but I find it does make the simple stuff
[2012-03-14 15:14:00 -0400] hoover_damm: much simpler
[2012-03-14 15:15:00 -0400] hoover_damm: and it's a great way to knock the idiot who uses librarian without properly forking a cookbook if they want to modify it
[2012-03-14 15:15:00 -0400] hoover_damm: you update librarian... and you look at your pairing partner and thunk em upside the head and say bad boy
[2012-03-14 15:15:00 -0400] hoover_damm: and move on
[2012-03-14 15:15:00 -0400] sivy: heh
[2012-03-14 15:15:00 -0400] hoover_damm: let them keep their self esteem
[2012-03-14 15:15:00 -0400] geekbri: i say let it all burrnnnnn
[2012-03-14 15:18:00 -0400] hoover_damm: geekbri, not my personal pref
[2012-03-14 15:20:00 -0400] bkocik: Ugh. I hate it when something that should be simple is difficult.
[2012-03-14 15:20:00 -0400] geekbri: bkocik: welcome to everything simple ever :)
[2012-03-14 15:20:00 -0400] bkocik: heh
[2012-03-14 15:20:00 -0400] cwj: is there a good writeup on librarian-chef use patterns? i find the documentation somewhat lacking
[2012-03-14 15:20:00 -0400] sivy: ooh, man, i remember now
[2012-03-14 15:20:00 -0400] sivy: i tried to use this and metachef was horking out on me
[2012-03-14 15:21:00 -0400] geekbri: cwj: I just followed a pattern that on their wiki and it works well for me.
[2012-03-14 15:21:00 -0400] sivy: will try again I guess
[2012-03-14 15:21:00 -0400] bkocik: Riddle me this - if I have a data bag containing "something": ["thing1", "thing2"] and an ERB that contains <%= @something %>, then in the file I get the string "[thing1, thing2]"
[2012-03-14 15:21:00 -0400] bkocik: But if in the ERB I do <%= something.join("\n") %> then in the file output I get nothing. WT(actual)F?
[2012-03-14 15:22:00 -0400] bkocik: Or rather, @something.join (the missing @ isn't the problem)
[2012-03-14 15:22:00 -0400] sivy: @something.join() ?
[2012-03-14 15:22:00 -0400] sivy: heh
[2012-03-14 15:22:00 -0400] bkocik: :)
[2012-03-14 15:23:00 -0400] bkocik: If I view the data bag in the chef server UI, it's clearly an array.
[2012-03-14 15:25:00 -0400] BryanWB: eclipse sucks!!!
[2012-03-14 15:25:00 -0400] cwj: geekbri: are you referring to https://github.com/applicationsonline/librarian/wiki/FAQ ? thats the only page i see linked on the github wiki
[2012-03-14 15:25:00 -0400] geekbri: cwj: yeah, thats the page I used. I agree it wasn't very clear.
[2012-03-14 15:27:00 -0400] geekbri: cwj: I just added a directory called site-cookbooks to my knife path, and created a Cheffile with a list of cookbooks I was using from the community site and github
[2012-03-14 15:29:00 -0400] cwj: so you are developing all your private cookbooks in the main repository? and what do you do about patching cookbooks from the community site or github?
[2012-03-14 15:30:00 -0400] bkocik: BryanWB: Yep. I use NetBeans or TextMate.
[2012-03-14 15:30:00 -0400] geekbri: cwj: all my private cookbooks live in my site-cookbooks directory (and are all stored on github)
[2012-03-14 15:31:00 -0400] geekbri: cwj: So in my librarian file they are listed as such with the github source.  For books I am forking from the main repo, I generally create my own github repo for just that one cookbook (as currently the way they have the cookbooks all as one giant repo is really unfriendly).  Then if the changes can be set upstream, I deal with that... its not fun.
[2012-03-14 15:31:00 -0400] geekbri: cwj: I haven't found a great way to send changes upstream yet.  Usually what I do is I create a fork of their main repo, insert my changes, then can pull request.  Not really ideal but what can ya do
[2012-03-14 15:33:00 -0400] bkocik: geekbri, cwj: The thing that gets me is that you can't have your chef-repo as part of an existing repository; it has to be a repository of its own or some command (I forget which one) refuses to run, complaining that it isn't a git repo.
[2012-03-14 15:34:00 -0400] geekbri: yeah I mean its not perfect, but it is better than not having librarian :)
[2012-03-14 15:34:00 -0400] geekbri: Once they split all of the cookbooks into their own repositories it will become much more clean.
[2012-03-14 15:34:00 -0400] bkocik: I didn't know about librarian until 5 minutes ago. I wonder if it's too late for me.
[2012-03-14 15:34:00 -0400] cwj: well given the perceived effort for me to switch to librarian, i am still skittish about making the change
[2012-03-14 15:35:00 -0400] bkocik: Maybe it's time for one of us to write a new, up to date "getting started with Chef" tutorial that mentions things like librarian. (Not it!)
[2012-03-14 15:35:00 -0400] geekbri: cwj: I am pretty happy I switched.  How do you handle your personal change? you just fork the whole repository and make youre changes and then merge theirs into your repo time to time?
[2012-03-14 15:37:00 -0400] cwj: geekbri: i am usually making changes that are specific to my environment, so i have a branch per cookbook and upstream branch when the cookbook is from community site or github
[2012-03-14 15:39:00 -0400] geekbri: cwj: oof
[2012-03-14 15:39:00 -0400] geekbri: that sounds like a nightmare trying to keep track of whats currently on your server vs whats on your one of many branches.
[2012-03-14 15:39:00 -0400] BryanWB: geekbri: it is a nightmare
[2012-03-14 15:39:00 -0400] BryanWB: i do the same thing
[2012-03-14 15:39:00 -0400] cwj: yes, that is one of the many things about it that i dont like
[2012-03-14 15:40:00 -0400] cwj: always trying to remember to merge to master and upload to chef server from there
[2012-03-14 15:40:00 -0400] geekbri: I think I prefer my way of doing it with librarian :).  Its a pain in the butt to send changes upstream but I deal with that.
[2012-03-14 15:40:00 -0400] geekbri: Id rather deal with the difficulty of figuring out how to send things upstream, then how to keep my chef server in sync with my cookbooks
[2012-03-14 15:41:00 -0400] geekbri: but I guess this is certainly a "pick your poison" type situation.
[2012-03-14 15:41:00 -0400] pcn: What's the benefit of librarian?  There seem to be a bunch of models to keep cookbooks available to knife: site-cookbooks, librarian (no notion of how it does it's thang), infochimps' homebase model (symlinks to sub-repos or to infochimps or opscode or customer maintained) or what I do with is a ruby blob in knife.rb that finds all cookbook directories under a particular path
[2012-03-14 15:48:00 -0400] Brad_K: filter?  what?  something on irc is filtered?!?  CALL THE ACLU!!!  ;-)
[2012-03-14 15:48:00 -0400] yfeldblum: geekbri, that is indeed a pain-point ... but i think the problem ultimately is around the fact that we still need to figure out a good way to test cookbooks in isolation from your main chef-repo
[2012-03-14 15:49:00 -0400] geekbri: yfeldblum: yeah, I mean, I've found work arounds as I'm sure many people have at this point, but once there is a canonical way to do it.... there will be many frowns erased.
[2012-03-14 15:49:00 -0400] yfeldblum: geekbri, if testing cookbooks were as easy as testing gems, i don't think it would be as big a problem
[2012-03-14 15:49:00 -0400] geekbri: yfeldblum: if only :)
[2012-03-14 15:51:00 -0400] bkocik: Oof. Anyone know how to get shef to send search requests to my chef-server instead of localhost?
[2012-03-14 15:51:00 -0400] yfeldblum: geekbri, librarian-chef is built around the same assumptions as bundler and for the same purpose (just in a different field of work) ... bundler assumes that gems can be built & tested in isolation and indeed most gems that people use are built & tested in isolation ... e.g. librarian is built & tested in isolation :P
[2012-03-14 15:51:00 -0400] cwj: bkocik: are you using -z (client mode) when invoking shef?
[2012-03-14 15:51:00 -0400] bkocik: No - that's probably it
[2012-03-14 15:52:00 -0400] yfeldblum: geekbri, beyond that, i'm open to suggestions for making it easier in the interim
[2012-03-14 15:52:00 -0400] geekbri: yfeldblum: I like librarian :)
[2012-03-14 15:52:00 -0400] Brad_K: yfeldblum: i realize that may be the desire, but given the architecture of chef, i'm not sure that it will be possible to remove an individual cookbook from the context of the chef repo.
[2012-03-14 15:52:00 -0400] yfeldblum: geekbri, thanks
[2012-03-14 15:52:00 -0400] bkocik: cwj: That was it. Thanks.
[2012-03-14 15:52:00 -0400] geekbri: yfeldblum: I dont think the issue lies with libarian itself.  One of the pain points is that the chef cookbooks are one giant repository which it probably shouldn't be... but I know they are working on fixing that.
[2012-03-14 15:52:00 -0400] Brad_K: yfeldblum: i think Toft might be able to help somewhat with regards to testing cookbooks before actually deploying them.
[2012-03-14 15:53:00 -0400] geekbri: yfeldblum: as for testing cookbooks before deploying... so far vagrant seems to be the best solution for that.
[2012-03-14 15:53:00 -0400] Brad_K: Toft can work on top of Vagrant.
[2012-03-14 15:53:00 -0400] cwj: whats a toft precious
[2012-03-14 15:54:00 -0400] bkocik: Alright, in shed I can see my var is an array, too, and .join("\n") works. I don't get why it doesn't work in erb.
[2012-03-14 15:54:00 -0400] Brad_K: project on github.  recently mentioned on the foodfight podcast.
[2012-03-14 15:54:00 -0400] bkocik: Err, shef.
[2012-03-14 15:54:00 -0400] yfeldblum: Brad_K, some cookbooks, the ones that are built for publishing and sharing ... i think a tool that works on top of lxc would be the best all-around ...
[2012-03-14 15:54:00 -0400] yfeldblum: Brad_K, i have looked at the toft code, but haven't tried it yet
[2012-03-14 15:54:00 -0400] cwj: bkocik: gist the erb?
[2012-03-14 15:54:00 -0400] Brad_K: yfeldblum: That's exactly how Toft works  with lxc.
[2012-03-14 15:55:00 -0400] Brad_K: see https://github.com/exceedhl/toft
[2012-03-14 15:55:00 -0400] bkocik: cwj: It's dirt simple - <%= @ssh_keys.join("\n") %>
[2012-03-14 15:55:00 -0400] geekbri: anybody here knowledgable in the ways of spiceweasel?
[2012-03-14 15:55:00 -0400] Brad_K: mattray might be around.
[2012-03-14 15:55:00 -0400] Brad_K: you don't get any more authoritative on spiceweasel than that.
[2012-03-14 15:56:00 -0400] yfeldblum: Brad_K, right i've checked toft out ... i'm more interested in something that works with lxc via libvirt because then you can do manual testing too with knife-libvirt
[2012-03-14 15:56:00 -0400] Brad_K: but there are those of us who have used spiceweasel, and are somewhat familiar with it.
[2012-03-14 15:56:00 -0400] bkocik: cwj: If I don't call join I get a string that looks like an array in my file: ["ssh-rsa blahbityblah", "ssh-rsa foobar"]
[2012-03-14 15:56:00 -0400] bkocik: cwj: But when I use .join, I get nothing.
[2012-03-14 15:58:00 -0400] yfeldblum: Brad_K, but i think toft has the right approach - local testing with lightweight virtualization - and hopefully that's something that expands and matures
[2012-03-14 15:59:00 -0400] geekbri: It seems to me you cannot launch an instance with spiceweasel if the role file is on the server but not on disk.  additionally, there seems to be no way to reference a role file that is nested in a sub directory of the roles directory IE roles/env/my_role_file_for_this_env.rb
[2012-03-14 16:00:00 -0400] Brad_K: geekbri: yeah, spiceweasel does make some assumptions about where you put your files and that all files are on disk.  it doesn't interact with the chef server via knife to see what the current environment is, for example.
[2012-03-14 16:00:00 -0400] cwj: bkocik: weird. do you get a different result if you use a different delimiter?
[2012-03-14 16:00:00 -0400] bkocik: Good question, I haven't tried that. What I'm about to try is using a loop on the array.
[2012-03-14 16:00:00 -0400] Brad_K: geekbri: roles are supposed to be stored in .../chefrepo/roles/ and nowhere else.
[2012-03-14 16:00:00 -0400] geekbri: Brad_K: yeah, I wouldn't mind so much, but I have my role files nested in sub directories to keep them organized (IE roles that apply to only certain environments live in a roles/environment/rolefile.rb) and it seems like spice weasel has no way to support anything but a flat laying in the roles directory
[2012-03-14 16:01:00 -0400] Brad_K: roles are really orthogonal to environments, so a flat structure is appropriate.
[2012-03-14 16:01:00 -0400] bkocik: cwj: Weird - the loop works. I don't get it.
[2012-03-14 16:02:00 -0400] geekbri: Brad_K: i find having sub directories in the roles directory really helps keep things organized... otherwise the roles directory grows to be very........ large.
[2012-03-14 16:02:00 -0400] Brad_K: if your roles aren't orthogonal, then i think you're working too hard and may be doing something  in an unnecessarily difficult way.
[2012-03-14 16:02:00 -0400] Brad_K: depends on how many roles you have.
[2012-03-14 16:03:00 -0400] Brad_K: we have no more than 42 roles, most of which are sub-roles that are included in other higher-level roles, or various different versions of roles (e.g., haproxy role vs. nginx_proxy role).
[2012-03-14 16:03:00 -0400] geekbri: Brad_K: well a good example is we have some roles that are only applied to EC2 servers because of their ephemeral drives, ands ome that apply to other cloud providers, so we have those in directories like ec2/ rackspace/ inside the roles directory....
[2012-03-14 16:04:00 -0400] BryanWB: yfeldblum: hey buddy!
[2012-03-14 16:04:00 -0400] geekbri: Brad_K: so basically to get spiceweasel to support nested roles like that I should write a patch and hit mattray with a pull request :)
[2012-03-14 16:04:00 -0400] Brad_K: geekbri: hmm.  well, to me, a webserver is a webserver, and a proxy is a proxy, regardless of where they are hosted.  what would be your examples?
[2012-03-14 16:05:00 -0400] Brad_K: geekbri: yeah, that would probably be the most effective way.  pull requests generally work.  ;-)
[2012-03-14 16:05:00 -0400] geekbri: Brad_K: we have roles for the difference types of ec2 servers, IE m1_xlarge and m1_large have different drive lay outs based on their different amount of ephemeral drives
[2012-03-14 16:07:00 -0400] geekbri: Brad_K: so when a server is brought up we have a set of cookbooks that raid drives based on their ephemeral drive lay outs, they are LWRP and you just set the attributes in the role file and shazam magic.
[2012-03-14 16:07:00 -0400] Brad_K: geekbri: okay, that makes sense.  are these kinds of things broken out into sub-roles that handle just the disk drive layouts so that you can then include those roles in higher level roles, based on the VM type that is intended to be used?
[2012-03-14 16:07:00 -0400] StormSilver: Is anyone using the opscode application cookbook with an encrypted data bag?
[2012-03-14 16:07:00 -0400] geekbri: Brad_K: exactly.
[2012-03-14 16:08:00 -0400] Brad_K: geekbri: okay, then  i'll shut up.  you're at least a step or three ahead of me, and i'm not really qualified to give you advice on this subject.  ;-)
[2012-03-14 16:09:00 -0400] yfeldblum: sup BryanWB
[2012-03-14 16:09:00 -0400] geekbri: Brad_K: hehe :).  I might just hack up a quick script to handle the fact that it expects the roles to be in their subdirs.
[2012-03-14 16:10:00 -0400] Brad_K: geekbri: i'm not a developer, but it seems to me that it would be a relatively simple modification to have the code do a recursive parse of the .../chefrepo/roles/ directory structure.  but maybe that's just my inexperience talking.
[2012-03-14 16:11:00 -0400] geekbri: Brad_K: I dont think it would be that difficult.  Its just if I have the time to read through the spice weasel code base when I could easily just hack together some bash script to do the same thing
[2012-03-14 16:11:00 -0400] BryanWB: Brad_K: tks for auido advice
[2012-03-14 16:12:00 -0400] yfeldblum: hmm ... anyone familiar with running a local dnsmasq and also using libvirt locally?
[2012-03-14 16:12:00 -0400] Brad_K: yfeldblum: friends don't let friends run djb code.  ;-)
[2012-03-14 16:14:00 -0400] lflux: ^^
[2012-03-14 16:14:00 -0400] yfeldblum: Brad_K, open to alternatives for (a) resolving *.domain.name locally to 127.0.0.1 (yes, every subdomain and sub-subdomain etc) and (b) libvirt :P
[2012-03-14 16:15:00 -0400] yfeldblum: libvirt uses dnsmasq internally to provide various networking services to guests
[2012-03-14 16:15:00 -0400] Brad_K: a local caching recursive nameserver that is set up to be authoritative for *.example.com is easy enough to do.  my preference would be for the most recent release of BIND, but i'm sure there are alternatives  that is, alternatives that do not involve djb code.
[2012-03-14 16:20:00 -0400] yfeldblum: Brad_K, ok so that was the wrong question ... real question is "running a local dns resolver (any) and also using libvirt locally"?
[2012-03-14 16:21:00 -0400] Brad_K: not just a resolver, you also have to have a local nameserver that is set up to be authoritative for *.example.com, so that it serves out your local custom version of that zone.
[2012-03-14 16:22:00 -0400] geekbri: Brad_K: theres always djbdns ;)
[2012-03-14 16:22:00 -0400] Brad_K: here's one of my reasons why i don't like djb code  there is no djb-approved way to handle IPv6.  he considers IPv6 to be an abomination and refuses to support it in any way, shape, or form in his code.  there are unsupported third-party patches, but that's all they are.
[2012-03-14 16:23:00 -0400] Brad_K: and that's just the first point of a whole laundry list that i have.
[2012-03-14 16:23:00 -0400] yfeldblum: hmm ... http://www.thekelleys.org.uk/dnsmasq/doc.html says "Dnsmasq was written by Simon Kelley."
[2012-03-14 16:24:00 -0400] Brad_K: that might be a fork.
[2012-03-14 16:25:00 -0400] Brad_K: or a re-implementation.
[2012-03-14 16:28:00 -0400] yfeldblum: hmm ... i see djbdns/tinydns are by djb, but google isn't showing me anything about dnsmasq and djb
[2012-03-14 16:30:00 -0400] geekbri: not supporting ipv6 is probably a mistake :)
[2012-03-14 16:30:00 -0400] ProfFalken: Brad_K: fairly sure that dnsmasq isn't djb - for a start I use dnsmasq and I refuse to use djb code... ;)
[2012-03-14 16:30:00 -0400] atomic-penguin: What doesn't support ipv6?
[2012-03-14 16:31:00 -0400] ProfFalken: geekbri: nah, the internet is wrong, djb is correct, there is no spoon...
[2012-03-14 16:31:00 -0400] ProfFalken: atomic-penguin: djbdns apparently...
[2012-03-14 16:31:00 -0400] c_t: I just got the mental image of someone along the lines of Ian Paisley ranting about the evils of ipv6
[2012-03-14 16:31:00 -0400] atomic-penguin: NO way
[2012-03-14 16:31:00 -0400] JasonBox: Oh?
[2012-03-14 16:32:00 -0400] atomic-penguin: Huh, did not know that
[2012-03-14 16:33:00 -0400] ProfFalken: atomic-penguin: http://www.fefe.de/dns/
[2012-03-14 16:34:00 -0400] atomic-penguin: He is right about dnssec, and the problems inherent, and choosing not to support it.  I don't think those issues have ever been addressed in dnssec.  Not supporting ipv6, I just don't get that though.
[2012-03-14 16:34:00 -0400] Brad_K: those are third-party patches.
[2012-03-14 16:34:00 -0400] lflux: i want to see a dan kaminsky vs djb cage fight
[2012-03-14 16:34:00 -0400] Brad_K: there have been issues with both DNSSEC and IPv6.  his page on IPv6 is at http://cr.yp.to/djbdns/ipv6mess.html
[2012-03-14 16:34:00 -0400] Brad_K: but the point is that these problems are being worked out by the community.
[2012-03-14 16:35:00 -0400] Brad_K: the critical problem with DNSSEC now is getting the root zone and all TLDs signed.  once we can establish that chain of trust from the root, we go a very long way to resolving the problems that DNSSEC is supposed to fix.
[2012-03-14 16:37:00 -0400] atomic-penguin: ipv6mess TL;DR: Not everyone supports IPV6, therefore I won't support IPV6
[2012-03-14 16:37:00 -0400] ProfFalken: Brad_K: most TLDs are now signed as is . the main issue with DNSSEC is that very few of the major DNS providers offer it as a service yet
[2012-03-14 16:38:00 -0400] Brad_K: most ccTLDs might be signed, but that is far from "most TLDs".
[2012-03-14 16:38:00 -0400] lflux: re ipv6: see http://www.youtube.com/watch?v=c7hq2q4jQYw
[2012-03-14 16:38:00 -0400] lflux: (titled [27C3] (en) Recent advances in IPv6 insecurities)
[2012-03-14 16:38:00 -0400] atomic-penguin: http://cr.yp.to/talks/2009.08.10/slides.pdf
[2012-03-14 16:39:00 -0400] guyrt: hey everyone, quick chef-solo question
[2012-03-14 16:39:00 -0400] ProfFalken: Brad_K: .net, .com, .org are all signed, is there a specific TLD that you need that's not in that list + ccTLDs?
[2012-03-14 16:40:00 -0400] miah: moin
[2012-03-14 16:40:00 -0400] guyrt: In my solo.rb file, I define file_cache_path and the location of some custom cookbooks. when I run chef-solo, I get a few files downloaded to the file_cache_path location
[2012-03-14 16:40:00 -0400] guyrt: is there any way to move those files?
[2012-03-14 16:41:00 -0400] guyrt: the download location, I mean
[2012-03-14 16:41:00 -0400] Brad_K: ProfFalken: i've been doing DNS since the very early 90s, when i set up the very first caching recursive nameserver inside the Defense Communications Agency office space at the Pentagon, back when they were responsible for administering the one and only NIC on the entire ArpaNet.  i don't really need any particular zone to be signed.  that was over twenty years ago, and no longer really part of my life.
[2012-03-14 16:42:00 -0400] Brad_K: btw, if anyone is looking for alternatives to BIND and dnsmasq, try out NSD and Unbound, both from NLNet Labs.  I know the guys there  they are top notch programmers.
[2012-03-14 16:42:00 -0400] ProfFalken: Brad_K: fair enough, it was an innocent question, I was genuinely interested in whether there were specific TLDs that you had in mind that were holding up DNSSEC adoption
[2012-03-14 16:43:00 -0400] Brad_K: ProfFalken: not for me.  any discussions i get into on the subject are far more of a theoretical nature these days.
[2012-03-14 16:43:00 -0400] ProfFalken: heh :)
[2012-03-14 16:44:00 -0400] paulmooring: guyrt: I think you're looking for the cookbook_path setting: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings#ChefConfigurationSettings-cookbookpath
[2012-03-14 16:44:00 -0400] Brad_K: sorry, didn't mean to Bogart the channel.
[2012-03-14 16:46:00 -0400] guyrt: paulmooring: Thanks for the reply. I'm setting cookbook_path to point to my cookbooks (a subdir of file_cache_path). The cookbooks are running, but some of them download temporary files like source tarballs. These files download to the file_cache_path location. Can I change that download location?
[2012-03-14 16:48:00 -0400] paulmooring: guyrt: sorry I missed understood, I'm pretty sure they always download to file_cache_path, is there some reason you don't want to just change that value?
[2012-03-14 16:49:00 -0400] guyrt: paulmooring: The main reason is that cookbook_path has to be a subdirectory. I could cp my cookbooks to a new location, but I wanted to see if there was a more canonical solution
[2012-03-14 16:56:00 -0400] ssd7_: Ohai Chefs
[2012-03-14 16:56:00 -0400] StormSilver: ohai2u ssd7_
[2012-03-14 17:03:00 -0400] yfeldblum: well that was stupid, dnsmasq was bound to all interfaces, fixing that...
[2012-03-14 17:05:00 -0400] HasanB: Would anyone here be willing to help me with a  --- recipe_definition_dsl_core.rb:56:in `method_missing'" -- error?
[2012-03-14 17:06:00 -0400] HasanB: I'm a bit of a newbie with Chef.  The failure happens in someone else's cookbook.
[2012-03-14 17:11:00 -0400] Brad_K: HasanB: that's actually an error in one of the internal libraries for Chef.
[2012-03-14 17:11:00 -0400] HasanB: Hi  Brad_K.
[2012-03-14 17:12:00 -0400] HasanB: Thanks. That sounds ugly.
[2012-03-14 17:12:00 -0400] HasanB: So far I have seen it only with one cookbook.
[2012-03-14 17:13:00 -0400] HasanB: The line in the cookbook causing the hiccup is   /cookbooks/openerp/recipes/database.rb:30:in `from_file'",
[2012-03-14 17:14:00 -0400] Brad_K: openerp?  i've never heard of that one.
[2012-03-14 17:14:00 -0400] Brad_K: are you using an old version of chef?
[2012-03-14 17:14:00 -0400] HasanB: Brad_K:  It's a very serious ERP.  Competes feature for feature with SAP/R3.
[2012-03-14 17:15:00 -0400] Brad_K: where did you get the cookbook from?
[2012-03-14 17:15:00 -0400] sivy: guh
[2012-03-14 17:15:00 -0400] sivy: oh yes, metachef requires ruby 1.9
[2012-03-14 17:15:00 -0400] sivy: fer crying out oud
[2012-03-14 17:15:00 -0400] HasanB: Brad_K: are you using an old version of chef?  Don't think so.  Only just got started with it a few days ago.
[2012-03-14 17:16:00 -0400] HasanB: OpenERP cookbook is from ...
[2012-03-14 17:16:00 -0400] Brad_K: HasanB: what version of chef are you using?  and where did you get the openerp cookbook?
[2012-03-14 17:17:00 -0400] HasanB: .........     http://community.opscode.com/cookbooks/openerp
[2012-03-14 17:18:00 -0400] Brad_K: okay, well that's an old cookbook.  the upstream cookbook it references (https://github.com/atriso/chef-openerp) no longer exists.
[2012-03-14 17:18:00 -0400] Brad_K: so, this sounds like you might have a cookbook problem, but to resolve the issue you might need to talk to the cookbook maintainer  but they're not maintaining that cookbook any more.
[2012-03-14 17:18:00 -0400] HasanB: Brad_K:    Oh Yuk!    So I'm dead?
[2012-03-14 17:19:00 -0400] Brad_K: not necessarily.  there might be a different cookbook you can use.
[2012-03-14 17:20:00 -0400] HasanB: Please excuse the dumb question, but "How did you figure all that out so fast?"
[2012-03-14 17:20:00 -0400] Brad_K: ahh, looks like atriso might have moved the cookbook to a different repo.  check out https://github.com/atriso/chef-openerp-cookbook
[2012-03-14 17:21:00 -0400] Brad_K: just doing searching at the opscode community site, and cross-referencing that with the stuff on github that it mentioned.
[2012-03-14 17:21:00 -0400] Brad_K: if you read the description at https://github.com/atriso/chef-openerp-cookbook it makes a direct reference to the cookbook at https://github.com/atriso/chef-openerp as being the upstream cookbook.  but that upstream cookbook no longer exists.
[2012-03-14 17:21:00 -0400] HasanB: Brad_K:  Ah!  Now I see where that appears in the documentation. !!  Great!  Thank you.
[2012-03-14 17:22:00 -0400] Brad_K: so, do a bit of searching around on github, and check to see if the user atriso has any other cookbooks that might be relevant, and you land up at https://github.com/atriso/chef-openerp-cookbook
[2012-03-14 17:23:00 -0400] Brad_K: that still looks a little old (nothing changed in 9 months), but at least that gives you info on the github repo in question and who the maintainer of that cookbook is.
[2012-03-14 17:25:00 -0400] Brad_K: HasanB: and looking at their only open issue right now (see https://github.com/atriso/chef-openerp-cookbook/issues/1 ), it seems that someone else might have run into the same problem about ten days ago.
[2012-03-14 17:25:00 -0400] HasanB: I was going to intrude myself onto the maintainer (Ringo de Smet) only after I had confirmed I wasn't simply guilty of a neophyte error using Chef for the first time.
[2012-03-14 17:26:00 -0400] HasanB: Brad_K: Are you with Opscode support?
[2012-03-14 17:26:00 -0400] Brad_K: well, it might still be a simple problem.
[2012-03-14 17:26:00 -0400] Brad_K: but at least you have a better idea of one place where you may be able to talk to someone who knows more about the cookbook.
[2012-03-14 17:26:00 -0400] Brad_K: no, i'm just a guy on the channel.
[2012-03-14 17:27:00 -0400] Brad_K: they do have some opscode support folks who listen here, but this is not an official support channel for them.
[2012-03-14 17:28:00 -0400] HasanB: Brad_K:  Well it's awfully good of you to help out in such detail.  Thanks!!
[2012-03-14 17:29:00 -0400] Brad_K: as for myself, i'm just procrastinating, when i should be working on my slides for the chef tutorial i'm going to be doing in Edinburgh in a few days.  ;-)
[2012-03-14 17:29:00 -0400] Brad_K: you're welcome!
[2012-03-14 17:29:00 -0400] HasanB: Tut Tut !
[2012-03-14 17:30:00 -0400] HasanB: I have a friend in Edinburgh!   name is Chris Cook!   Hah! Hah!
[2012-03-14 17:30:00 -0400] HasanB: (seriously)
[2012-03-14 17:31:00 -0400] Brad_K: well, if chris is interested, he can stop by the FLOSSUK 2012 conference  see http://www.flossuk.org/Events/Spring2012
[2012-03-14 17:31:00 -0400] HasanB: he's an economist.
[2012-03-14 17:32:00 -0400] Brad_K: ahh, so then he would not be interested in FLOSSing. ;-)
[2012-03-14 17:33:00 -0400] HasanB: My aunt lives in Peebles, but she's 94.  :-(
[2012-03-14 17:33:00 -0400] Brad_K: she's less than fifty years older than i am!
[2012-03-14 17:34:00 -0400] HasanB: The thing I don't get about this cookbook bug is that I can't find any place where the missing method actually gets called!
[2012-03-14 17:35:00 -0400] Brad_K: try using pastebin or a gist, so that we can see the whole error.
[2012-03-14 17:35:00 -0400] HasanB: A recursive grep shows exactly one line with    postgresql_role node[:openerp][:user] do
[2012-03-14 17:36:00 -0400] HasanB: Brad_K:  "pastebin or a gist"    ok!  gimme a sec.
[2012-03-14 17:37:00 -0400] yfeldblum: https://github.com/atriso/chef-openerp-cookbook/blob/master/recipes/database.rb#L30
[2012-03-14 17:37:00 -0400] yfeldblum: calls the method `postgresql_role` ... what cookbook defines a resource named "postgresql_role"?
[2012-03-14 17:40:00 -0400] Brad_K: bbiab
[2012-03-14 17:41:00 -0400] yfeldblum: atriso's postgresql cookbook is apparently at: https://github.com/atriso/chef-repo-pas/tree/master/cookbooks/postgresql
[2012-03-14 17:42:00 -0400] yfeldblum: there's a postgresql_role resource defined here: https://github.com/atriso/chef-repo-pas/blob/master/cookbooks/postgresql/resources/role.rb
[2012-03-14 17:42:00 -0400] yfeldblum: HasanB, perhaps that's the missing cookbook you need?
[2012-03-14 17:43:00 -0400] HasanB: Here's the gist ... https://gist.github.com/2038153
[2012-03-14 17:44:00 -0400] HasanB: yfeldblum:  Hey!
[2012-03-14 17:45:00 -0400] HasanB: yfeldblum:  So line thirty is not *declaring  "postgresql_role" it is *calling*  it???
[2012-03-14 17:46:00 -0400] NewToChef: Hello. I need to be able to download a package from an apt repository. So I can use the package resource, how should I setup the repository? Will anyone be able to share an example of how to setup an apt repo?
[2012-03-14 17:47:00 -0400] HasanB: yfeldblum: Looking at those links, (brb).
[2012-03-14 17:47:00 -0400] yfeldblum: HasanB, line 30 is calling the method `postgresql_role`, passing in a first argument (the name) and a block (the code between do and end)
[2012-03-14 17:48:00 -0400] yfeldblum: HasanB, that constructs a resource of type `postgresql_role` and adds it to the list of resources to be acted upon later
[2012-03-14 17:49:00 -0400] HasanB: yfeldblum: I get you.
[2012-03-14 17:52:00 -0400] statix: When launching/bootstrapping new ec2 instances, I'm repeatedly getting "FATAL: IOError: Cannot open or read /var/cache/chef/cookbooks/php/providers/pear.rb!" on the first chef run. Sometimes it happens, sometimes it doesn't, but I can see that it is always getting stored beforehand. Does anyone have any idea what's happening?
[2012-03-14 17:53:00 -0400] statix: These are different instances each time, and it keeps failing on the same file
[2012-03-14 17:53:00 -0400] HasanB: yfeldblum: the "official" Postgres cookbook  has no such role, and the OpenERP cookbook doesn't make the distinction between the official one and their variant when mentioning requirements.  Grrrr.
[2012-03-14 17:54:00 -0400] yfeldblum: HasanB, that is correct - my best guess is that this is atriso's fork of Opscode's postgresql cookbook
[2012-03-14 17:57:00 -0400] HasanB: yfeldblum: I'll have to compare the two andd see how far diverged they are.  But, you have definitely set me on the correct path.  Much obliged!!   How did you find atriso's postgres fork.  It did not occur to me even to look for that.
[2012-03-14 17:58:00 -0400] yfeldblum: HasanB, actually, i searched all ruby projects on github for the phrase "postgresql_role", hoping to get lucky
[2012-03-14 17:58:00 -0400] HasanB: Brilliant!
[2012-03-14 18:04:00 -0400] statix: Just modified the file, reuploaded the cookbook, and it did it again
[2012-03-14 18:08:00 -0400] statix: Looks like a lot of the cookbook files are not actually getting stored on the filesystem
[2012-03-14 18:13:00 -0400] statix: .. I see what's happening. The bootstrap script is installing chef, and the chef client is getting started right then with an empty runlist. So it sees the cached cookbook files, and is deleting them as unneeded
[2012-03-14 18:13:00 -0400] gondoi: i'm confused about site-cookbooks
[2012-03-14 18:13:00 -0400] gondoi: i created a duplicate location to have site-cookbooks and tweaked the apache2 as the wiki describes
[2012-03-14 18:14:00 -0400] gondoi: but i'm getting this error on a rake install
[2012-03-14 18:14:00 -0400] gondoi: IMPORTANT: In a future version of Chef, this behavior will be removed and you will no longer
[2012-03-14 18:14:00 -0400] gondoi: be able to have the same version of a cookbook in multiple places in your cookbook_path.
[2012-03-14 18:17:00 -0400] statix: I duplicated this as a debian bootstrap almost verbatim, and it's the apt-get install -y chef that's causing the problem: https://github.com/opscode/chef/blob/master/chef/lib/chef/knife/bootstrap/ubuntu10.04-apt.erb
[2012-03-14 18:22:00 -0400] cwj: anyone have experience with automating AWS RDS via Fog? I am trying to figure out how I can wait for an RDS instance to be deleted before proceeding. seems like the instance state stays at 'deleting' after it has been succesfuly deleted.
[2012-03-14 18:25:00 -0400] ssd7_: gondoi: Being able to have multiple locations in your cookbook_path won't go away.  What is deprecated is changing individual files via site-cookbooks
[2012-03-14 18:40:00 -0400] StormSilver: How are people doing their Rails asset pipeline with chef?
[2012-03-14 18:41:00 -0400] StormSilver: precompile on your dev box and check in to source control, or add something to your chef deployment that runs the precompile?
[2012-03-14 18:41:00 -0400] StormSilver: or <other-more-awesome-method>?
[2012-03-14 18:42:00 -0400] chson: If I use puts in the recipes for debugging purposes, do they show up in the log files?
[2012-03-14 18:43:00 -0400] StormSilver: chson: http://wiki.opscode.com/display/chef/Resources#Resources-Log
[2012-03-14 18:44:00 -0400] StormSilver: chson: Use that for debugging, or invoke Chef::Log.debug directly
[2012-03-14 18:44:00 -0400] chson: StormSilver: thanks!  even though I was reading that page I completely overlooked Log.
[2012-03-14 18:44:00 -0400] StormSilver: chson: It's easy to do. :)
[2012-03-14 18:48:00 -0400] Brad_K: StormSilver: so far as i know, most people are tending to create build artifiacts, either using CI tools like Jenkins or building them some other way, and then referencing those build artifacts with chef to deploy them.
[2012-03-14 18:49:00 -0400] Brad_K: in our case, we build RPMs which we then push out with chef.
[2012-03-14 18:49:00 -0400] StormSilver: Brad_K: Wow, that's an interesting approach.
[2012-03-14 18:51:00 -0400] Brad_K: we actually use Jenkins to create the build artifacts and then another script inside of Jenkins turns them into RPMs which then get pushed.
[2012-03-14 18:51:00 -0400] pbuckley: thats pretty close to what we do.. except jenkins pushes it to git and tags it
[2012-03-14 18:51:00 -0400] bwong: Hi everyone.
[2012-03-14 18:51:00 -0400] pbuckley: then we pull it out of git on the host
[2012-03-14 18:51:00 -0400] bwong: Is anyone farmiliar with chef bootstrap?
[2012-03-14 18:52:00 -0400] Brad_K: bwong: to a degree, yes.  what's the problem you're having?
[2012-03-14 18:54:00 -0400] jdeamattson: Two part question here:
[2012-03-14 18:54:00 -0400] bwong_: Brad_K: Hey thanks for rsponding, I was wondering if there is a way to reverse install with bootstrap. So instead of installing form the server the machine connects to the server to install the client on to its-self
[2012-03-14 18:55:00 -0400] pbuckley: in ec2 you can use right_aws and ec2_userdata
[2012-03-14 18:55:00 -0400] Brad_K: bwong_: no, that's not how chef works.
[2012-03-14 18:56:00 -0400] pbuckley: Brad_K: he couldnt have his image have a curl call that grabs the chef client off a web server somewhere then execute an install of the client?
[2012-03-14 18:56:00 -0400] pbuckley: seems feasible to me
[2012-03-14 18:58:00 -0400] Brad_K: pbuckley: that's basically what the Full Stack Installer does.
[2012-03-14 18:58:00 -0400] Brad_K: but that's not how i interpreted what he was asking for.
[2012-03-14 18:58:00 -0400] pbuckley: im still new to chef so yeh its probably already done
[2012-03-14 18:58:00 -0400] pbuckley: (but thats what i did for puppet)
[2012-03-14 18:59:00 -0400] bwong_: Wher does chef-clients hold their logs?
[2012-03-14 18:59:00 -0400] Brad_K: pbuckley: the build system is called "omnibus", and some people still call it "omnibus" instead of Full Stack Installer.
[2012-03-14 18:59:00 -0400] pbuckley: ah
[2012-03-14 19:00:00 -0400] Brad_K: bwong_: /var/log/chef/
[2012-03-14 19:00:00 -0400] pbuckley: thats makes more sense
[2012-03-14 19:00:00 -0400] pbuckley: i was like what is this omnibus thing
[2012-03-14 19:00:00 -0400] yfeldblum: bwong_, bootstrap is basically you SSHing into the box and prepping by installing ruby, ohai, chef, and setting up the chef config file, and finally kicking off that first chef-client run
[2012-03-14 19:00:00 -0400] pbuckley: replace you with a shell script ;)
[2012-03-14 19:00:00 -0400] yfeldblum: somebody has to SSH into the box and install ruby, ohai, chef, and set up the chef config files ... and that somebody is you ... that's bootstrapping
[2012-03-14 19:01:00 -0400] pbuckley: somebody doesnt have to.. you can automate that
[2012-03-14 19:01:00 -0400] pbuckley: well
[2012-03-14 19:01:00 -0400] yfeldblum: `knife bootstrap` or `knife CLOUD server create` can help automate that bit, but it's still you doing it
[2012-03-14 19:01:00 -0400] pbuckley: i hope chef can do it
[2012-03-14 19:01:00 -0400] pbuckley: because if i cant get that working
[2012-03-14 19:01:00 -0400] pbuckley: ill have to stick with puppet
[2012-03-14 19:02:00 -0400] Brad_K: pbuckley: that's why the FSI was created.
[2012-03-14 19:02:00 -0400] pbuckley: \o/
[2012-03-14 19:09:00 -0400] kreedy: anyone using chef to do 1-time tasks like "restart apache on all machines with role x"? or would something like fabric (using pychef to get machines per role) be better suited?
[2012-03-14 19:10:00 -0400] StormSilver: kreedy: Isn't that what knife ssh is for?
[2012-03-14 19:11:00 -0400] StormSilver: kreedy: Something like `knife ssh role:x /etc/init.d/apache2 restart`
[2012-03-14 19:11:00 -0400] StormSilver: You know, quoted correctly. :)
[2012-03-14 19:11:00 -0400] kreedy: that's exactly what i'm looking for
[2012-03-14 19:11:00 -0400] kreedy: thanks StormSilver
[2012-03-14 19:27:00 -0400] JasonBox: hrm, how would one include a 'template' into an existing template?
[2012-03-14 19:27:00 -0400] JasonBox: I lost track of the last cookbook I saw that did something like that
[2012-03-14 19:27:00 -0400] JasonBox: Although I think it was done by just loading that file into a variable and passing it in via :variables
[2012-03-14 19:38:00 -0400] geekbri: Does anybody know of any good open source alternatives to spiceweasel
[2012-03-14 19:38:00 -0400] geekbri: ?"
[2012-03-14 19:50:00 -0400] geekbri: guess not :)
[2012-03-14 19:57:00 -0400] jdeamattson: Is anyone aware of a cookbook for setting the max files and max processes on a Linux instances?
[2012-03-14 20:01:00 -0400] chip-: jdeamattson: If you're on a debian variant, you might want to set that per-app in /etc/default/appname
[2012-03-14 20:01:00 -0400] jdeamattson: Unfortunately, am on Centos.
[2012-03-14 20:01:00 -0400] chip-: Sucks.
[2012-03-14 20:02:00 -0400] chip-: But I don't know of any cookbook right now for managing /etc/security/limits.conf
[2012-03-14 20:02:00 -0400] chip-: Be easy enough to write one, it's just one file.
[2012-03-14 20:02:00 -0400] jdeamattson: Yeah, that is what I am thinking. Do you know if that is referenced at start-up? Or is it referenced at process runtime?
[2012-03-14 20:04:00 -0400] chip-: Pretty sure pam reads it in when creating a session.
[2012-03-14 20:04:00 -0400] chip-: (If you have the line in pam.d to read it in, of course)
[2012-03-14 20:06:00 -0400] tolland: jdeamattson: i generally slap a ulimit in the /etc/sysconfig/whatever file, as that gets sourced into the init
[2012-03-14 20:07:00 -0400] jdeamattson: For the future, that is the way to do it, but I am dealing with some legacy code here which currently does not use init.d for startup.
[2012-03-14 20:07:00 -0400] tolland: i was looking into this the other day, because elasticsearch was opening loads of files
[2012-03-14 20:08:00 -0400] jdeamattson: tolland: your approach makes a lot of sense. Will have to deal with this in a less than perfect way for now :-)
[2012-03-14 20:09:00 -0400] geekbri: after bootstrapping, I dont need to run the chef-client cookbook default recipe to be able to run other cookbooks right?  I mean I am running it, but I want to run a cookbook before it... that should work without issue correct?
[2012-03-14 20:10:00 -0400] geekbri: yes it must be fine... otherwise how would the chef-client cookbook itself run, ok answered my own question!
[2012-03-14 20:10:00 -0400] tolland: geekbri: my experience is that you need to make one complete run of the chef-client in order to register the values with the server, and have useful state
[2012-03-14 20:11:00 -0400] tolland: oh, sorry i see
[2012-03-14 20:11:00 -0400] geekbri: tolland: right but that happens in the bootstrap, so when you create a server with knife ec2 create, it bootstraps, then it runs the roles you listed (which call cookbooks).  So the chef-client cookbook should just be configuring the service to run on the regular, but all the cookbooks before it will fire off properly.  I believe at least :)
[2012-03-14 20:16:00 -0400] tolland: geekbri: yeah, my deployed chef-client is out of date to the current release but the default recipe just calles the chef-client::service recipe
[2012-03-14 20:23:00 -0400] iamsmrtk: Hey all, I'm having some issues with chef/couchdb. I'm getting EOFErrors when I try to check in a client and I can see the file that it's erroring on but I'm not sure where to go from here. I'm trying to take a look at my couchdb to see if there are any problems there but couchdb's a little frustrating. I'm running chef 0.10.8 and couchdb 1.0.2.
[2012-03-14 20:27:00 -0400] tolland: iamsmrtk: try chef-client -l debug
[2012-03-14 20:29:00 -0400] tolland: if that doesnt help, try starting the server from the command line and view the output
[2012-03-14 20:30:00 -0400] iamsmrtk: yup, i've run it in debug mode. here's the request and the output http://pastebin.com/wUUeaF37.
[2012-03-14 20:31:00 -0400] iamsmrtk: the checksum it's referring to is a recipe that's in the cookbook, i was trying to verify that the couchdb entry for that file was correct
[2012-03-14 20:31:00 -0400] iamsmrtk: i gotta go, i'll be back later
[2012-03-14 20:36:00 -0400] HwyMan: Is there a way I can sync my local chef repo with what's on the hosted server?
[2012-03-14 20:41:00 -0400] hoover_damm: you can download all the cookbooks and then download all the roles and environments
[2012-03-14 20:41:00 -0400] gondoi: ssd7_: ahh okay.. so if I want to make changes I need to copy the entire cookbook over, not specific recipes/templates/etc?
[2012-03-14 20:41:00 -0400] hoover_damm: into a chef-repo repository
[2012-03-14 20:42:00 -0400] HwyMan: how do I download all the roles/enviornments etc, into a local copy?
[2012-03-14 20:47:00 -0400] dwhsix: hiya all  in a recipe, how do I get the node's role(s)?
[2012-03-14 20:47:00 -0400] asg: HwyMan: https://github.com/jtimberman/knife-scripts/blob/master/chef_server_backup.rb
[2012-03-14 20:48:00 -0400] asg: HwyMan: not sure if he's added support for environments yet but it's something you can start with.
[2012-03-14 20:50:00 -0400] dwhsix: aha  probably node.roles
[2012-03-14 21:22:00 -0400] flashmanbahadur1: there wouldnt happen to be an ETA for chef 0.10.10 would there?
[2012-03-14 21:46:00 -0400] flashmanbahadur1: having an issue with a LWRP
[2012-03-14 21:46:00 -0400] flashmanbahadur1: the action is getting called
[2012-03-14 21:46:00 -0400] flashmanbahadur1: but its not running the execute block inside
[2012-03-14 21:51:00 -0400] vegardx: I have issues with knife. On two different machines (one being linux and one osx). When I do knife node edit NODE I only get whats in normal, not override and such. Any ideas?
[2012-03-14 21:51:00 -0400] vegardx: So, on the other machine I get the full attributes output
[2012-03-14 21:54:00 -0400] chip-: vegardx: check .chef/knife.rb
[2012-03-14 21:54:00 -0400] j-v-e: hey guys, quick question: Can I do a search() inside a template ?
[2012-03-14 21:54:00 -0400] vegardx: Identical, distribued via git
[2012-03-14 21:55:00 -0400] vegardx: Also, I cant see anything in the docs that could alter the output of knife?
[2012-03-14 21:58:00 -0400] cwj: vegardx: sounds like you are seeing the difference between 'knife node edit foo' and 'knife node edit foo -a'
[2012-03-14 21:59:00 -0400] vegardx: cwj: I'll be damned!
[2012-03-14 22:00:00 -0400] cwj: wondering if one of your machines has an older version of knife which returns the whole node by default
[2012-03-14 22:00:00 -0400] vegardx: Second thing so far that knife differs on on different platforms
[2012-03-14 22:00:00 -0400] vegardx: hm, they should be using the same version, but i'll check that
[2012-03-14 22:00:00 -0400] cwj: not sure thats really a platform difference tbqh
[2012-03-14 22:00:00 -0400] vegardx: knife status output is different in OSXoand Linux
[2012-03-14 22:00:00 -0400] vegardx: (maede a maess with some scripts)
[2012-03-14 22:01:00 -0400] ssd7_: vegardx: Different How?
[2012-03-14 22:02:00 -0400] vegardx: output is in different order
[2012-03-14 22:02:00 -0400] ssd7_: what is the version of ruby on each machine?
[2012-03-14 22:03:00 -0400] vegardx: I don't have the other right here, but it was the first thing we checked, so unless we were temporarily blind it should be the same
[2012-03-14 22:04:00 -0400] vegardx: but all is well now, finally get proper output from knife :)
[2012-03-14 22:08:00 -0400] iamsmrtk: Hey all, I'm having some problems with chef and couchdb and my client checking in. When putting the GET request for a specific recipe, it says that the file is 0 length (http://pastebin.com/byAPtsjG). I'm thinking it's a couchdb issue but I'm not sure where to go from here
[2012-03-14 22:14:00 -0400] iamsmrtk: One thing I'm noticing is that when I try to access my cookbook via the webui I'm getting a similar error: end of file reached
[2012-03-14 22:17:00 -0400] flashmanbahadur1: Solved my previous issue, if you have a custom provider and you instantiate it with a local name the same as the provider name, ex.  supervisor "supervisor" do  end, when notified of actions (Ex: notify :update, "supervisor[supervisor]", :immediately) the provider will receive them but not run whatever is inside the action block on the provider
[2012-03-14 22:18:00 -0400] flashmanbahadur1: changing the local name to something different (Ex: supervisor "my supervisor" do .. end) fixes the problem
[2012-03-14 22:30:00 -0400] j-v-e: Is there a "right way" to load attributes from a data bag and merge that with the attributes from a role ?
[2012-03-14 22:31:00 -0400] jdeamattson: Like chef_environment, I seem to remember something special about access the role attribute of a node. Am I mis-remembering? If so, are their other special access attributes?
[2012-03-14 22:39:00 -0400] jdeamattson: How do you access the role attribute of a node. I can't find this anywhere in my searches.
[2012-03-14 22:46:00 -0400] jdeamattson: Ok, found it. It is node['roles'] which returns the run list.
[2012-03-14 22:46:00 -0400] jdeamattson: But another question: Is the role in the 0 position the last role applied in the run list?
[2012-03-14 22:57:00 -0400] jdeamattson: Hmmmok, so it seems the order of roles in the run list is arbitrary (unless I am missing something).
[2012-03-14 22:59:00 -0400] jdeamattson: BUt in the Opscode management UI it displays the RUn List and says that a role is in Position 0 (and in fact that is all it lists), but if I go and get node['roles'] for that run list, it does not show the role from the UI in the 0 position.
[2012-03-14 22:59:00 -0400] jdeamattson: Any thoughts?
[2012-03-14 23:12:00 -0400] grantr: hey everybody
[2012-03-14 23:12:00 -0400] grantr: has anyone come up with a good way to bootstrap with one run list and then run the chef-client service with another run list?
[2012-03-14 23:12:00 -0400] grantr: it bugs me that the chef-client service comes up immediately and runs concurrently with the bootstrap run
[2012-03-14 23:13:00 -0400] grantr: i wonder if there's a way to have the chef-client::service recipe end the run immediately if it detects that it's the first-run
[2012-03-14 23:16:00 -0400] grantr: or alternatively give the initial run a different run list than the one that was passed in and have it set the run list
[2012-03-14 23:24:00 -0400] Brad_K: grantr:  see https://github.com/mattray/mattray-cookbooks/tree/master/one-shot
[2012-03-14 23:25:00 -0400] Brad_K: however, there is a caveat  in most cases, if you think you need a one-shot cookbook like this, you're probably doing something wrong.  this cookbook actually has very limited uses in a properly developed and maintained chef environment.
[2012-03-14 23:25:00 -0400] grantr: Brad_K, sort of but not exactly. I want to execute one recipe first run then execute different recipes every run after. one-shot is for things that would normally be chef-solo jobs but benefit from being run in a chef-client context
[2012-03-14 23:26:00 -0400] Brad_K: matt wrote this cookbook for those very few cases where you do actually need a one-shot cookbook.
[2012-03-14 23:26:00 -0400] grantr: Brad_K, the purpose of the one-shot cookbook is to do scheduled things like backups or whatever with chef
[2012-03-14 23:26:00 -0400] Brad_K: grantr: i'm not understanding the distinction that you're making.
[2012-03-14 23:26:00 -0400] grantr: chef-solo would normally be the tool of choice but sometimes you need the client
[2012-03-14 23:28:00 -0400] grantr: Brad_K, one-shot lets you run a recipe once and never again. it still executes all the other recipes in the run list
[2012-03-14 23:28:00 -0400] Brad_K: right.  and how is that different from what you want?
[2012-03-14 23:28:00 -0400] grantr: what i want is something that executes one recipe (chef-client service bootstrap) the first run, then executes all the other recipes every run after that
[2012-03-14 23:29:00 -0400] grantr: essentially i want a bootstrap run list that is used once, and a normal run list every time after
[2012-03-14 23:29:00 -0400] grantr: pretty sure i can do it with custom bootstrap templates
[2012-03-14 23:29:00 -0400] Brad_K: okay, that sounds like a bootstrap file, which is typically stored on the chef workstation and where one-shot type things used to have to be done, back before matt created this cookbook.
[2012-03-14 23:30:00 -0400] grantr: you still need those bootstrap files even with one-shot
[2012-03-14 23:30:00 -0400] grantr: don't you?
[2012-03-14 23:30:00 -0400] grantr: is there a new recommendation for bootstrapping nodes that i don't know about?
[2012-03-14 23:31:00 -0400] dalekurt: Question: What's wrong with this and why won't it work? - http://pastebin.com/hSZAf4Ls
[2012-03-14 23:32:00 -0400] Brad_K: grantr: you'll need those bootstrap files no matter what.  the idea is that they can now be made more general and less complex, by pushing some stuff off into a one-shot cookbook.
[2012-03-14 23:33:00 -0400] Brad_K: and more recent versions of chef come with newer versions of the bootstrap files, including the Full Stack Installer.
[2012-03-14 23:34:00 -0400] grantr: Brad_K, i may be missing something but that doesn't solve the problem. you still have two chef-client runs going on at once when you bootstrap
[2012-03-14 23:34:00 -0400] Brad_K: dalekurt: what's wrong with doing a simple:
[2012-03-14 23:34:00 -0400] Brad_K: cookbook_file "/tmp/#{node[:name]}" do
[2012-03-14 23:36:00 -0400] Brad_K: grantr: the bootstrap file is a shell script.  it is not a chef-client run.  the shell script is doing all the things that need to be done so that  you can get chef-client installed, after which it hands over execution to the chef-client program.
[2012-03-14 23:36:00 -0400] grantr: i dont know what you could move from the default bootstrap files into a one-shot recipe, really. all they do is make it possible for chef-client to run
[2012-03-14 23:36:00 -0400] grantr: right, definitely
[2012-03-14 23:36:00 -0400] dalekurt: Brad_K I'm trying to figure out why that is wrong and yes a simple way of doing it.
[2012-03-14 23:37:00 -0400] Brad_K: grantr: the point was that there are sometimes things that people want to do only once, and if you don't have something like a one-shot cookbook, then you may feel like you don't have a choice but to put that stuff in the shell script.
[2012-03-14 23:37:00 -0400] grantr: oh definitely
[2012-03-14 23:37:00 -0400] Brad_K: but shell script != cookbook
[2012-03-14 23:37:00 -0400] grantr: i think i'm being confusing when i say bootstrap
[2012-03-14 23:37:00 -0400] grantr: i'm talking about the initial chef run that is kicked off by the bootstrap script
[2012-03-14 23:38:00 -0400] Brad_K: that's the first-run.
[2012-03-14 23:38:00 -0400] Brad_K: that's not the bootstrap.
[2012-03-14 23:38:00 -0400] jdeamattson: ohai_time is the time at which the instance, the client, or ohai started running?
[2012-03-14 23:38:00 -0400] grantr: ok, so its the first-run
[2012-03-14 23:39:00 -0400] grantr: that first-run usually sets up a chef-client service and starts it immediately, then goes on to execute the rest of the run_list
[2012-03-14 23:39:00 -0400] jdeamattson: Oh, it appears to be the time of the last check-in. Ok.
[2012-03-14 23:41:00 -0400] grantr: i want the first-run to stop immediately after the client service is started and let the client-service handle everything else
[2012-03-14 23:42:00 -0400] Brad_K: the first-run is a json file that is passed to the chef-client program before chef-client knows anything about what to do.  See http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-03-14 23:43:00 -0400] Brad_K: at the end of the bootstrap, knife will kick off a chef-client run with "chef-client -j /etc/chef/first-boot.json".
[2012-03-14 23:44:00 -0400] grantr: right, i think i'll just modify the json so it puts the given run list in an attribute and have the first-run set the node.run_list from that attribute
[2012-03-14 23:44:00 -0400] grantr: then it can use whatever first-run runlist it wants
[2012-03-14 23:45:00 -0400] Brad_K: that first-boot.json should connect to the chef server, download the runlist and all the other initial dependencies, and start executing.  one of the first things in that runlist is to create a chef-client service, based on the chef-client cookbook, and it is the point of that chef-client service to be running periodically in the background.
[2012-03-14 23:45:00 -0400] Brad_K: but you don't have to include the chef-client cookbook, which would prevent the creation of the chef-client service.
[2012-03-14 23:47:00 -0400] grantr: Brad_K, i dont think we're communicating
[2012-03-14 23:47:00 -0400] grantr: no worries
[2012-03-14 23:47:00 -0400] Brad_K: matt's one-shot cookbook would presumably also be in that runlist, and after it is done executing on that first-run, it would delete itself from the runlist.
[2012-03-14 23:47:00 -0400] grantr: i think i've got a solution anyway
[2012-03-14 23:48:00 -0400] Brad_K: i'm trying to understand the exact point at which changes would need to be made.
[2012-03-14 23:48:00 -0400] Brad_K: and more importantly, why the changes need to be made.  most of the things i hear about people wanting to do something like a one-shot cookbook, they're actually doing it wrong.
[2012-03-14 23:49:00 -0400] grantr: <grantr> essentially i want a bootstrap run list that is used once, and a normal run list every time after
[2012-03-14 23:50:00 -0400] grantr: maybe what i didn't get across before is that bootstrap run list is NOT the one given to knife bootstrap
[2012-03-14 23:50:00 -0400] grantr: so you do knife bootstrap -r "role[awesome_app]"
[2012-03-14 23:51:00 -0400] grantr: but what really gets executed during the first run is "recipe[chef-client::bootstrap_service]"
[2012-03-14 23:51:00 -0400] jtimberman: ohai grantr :D
[2012-03-14 23:51:00 -0400] grantr: jtimberman, ohai!
[2012-03-14 23:51:00 -0400] jtimberman: Brad_K: grantr is probably still using an older way of bootstrapping :)
[2012-03-14 23:51:00 -0400] grantr: Brad_K, and every run after that (eg every run that the service runs), the run list is "role[awesome_app]"
[2012-03-14 23:51:00 -0400] grantr: jtimberman, what is this new way of bootstrapping?
[2012-03-14 23:52:00 -0400] jtimberman: grantr: i don't know if you switched over from the stuff we set up originally.
[2012-03-14 23:52:00 -0400] grantr: the ec2 stuff? where we needed special amis?
[2012-03-14 23:52:00 -0400] jtimberman: grantr: knife ec2 server create w/ knife bootstrap.
[2012-03-14 23:52:00 -0400] jtimberman: using a vanilla plain ami
[2012-03-14 23:52:00 -0400] grantr: oh yeah thats what i'm talking bout
[2012-03-14 23:52:00 -0400] grantr: we stopped using the special amis years ago
[2012-03-14 23:53:00 -0400] Brad_K: okay, i will bow out of this conversation, seeing as i obviously don't know any of the back history and how things have changed over time.
[2012-03-14 23:53:00 -0400] jtimberman: ah good :)
[2012-03-14 23:53:00 -0400] grantr: dont worry Brad_K, thanks for the help!
[2012-03-14 23:53:00 -0400] jtimberman: Brad_K: thank you sir :)
[2012-03-14 23:53:00 -0400] jtimberman: I'm not going to stick around long though, I can smell the pizza downstairs...
[2012-03-14 23:53:00 -0400] grantr: and i need to get back to bootstrapping
[2012-03-14 23:53:00 -0400] Brad_K: jtimberman: btw, i did finally get the showoff issues resolved that i was having.
[2012-03-14 23:54:00 -0400] jtimberman: Brad_K: oh good. sorry i didn't respond.
[2012-03-14 23:54:00 -0400] jtimberman: there's a few little annoying things about showoff
[2012-03-14 23:54:00 -0400] jtimberman: grantr: did you get your question resolved, or is it something a bit bigger?
[2012-03-14 23:56:00 -0400] grantr: jtimberman, i did
[2012-03-14 23:57:00 -0400] grantr: it transpired that while i was having the conversation a solution occurred to me :)
[2012-03-14 23:58:00 -0400] jtimberman: grantr: Ahh ok :)
