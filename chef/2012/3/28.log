[2012-03-28 00:00:35 -0400] erratic: well if nothing else
[2012-03-28 00:00:36 -0400] bemu: however, it's even more easily argued in situations like that, that your time is valuable.
[2012-03-28 00:00:52 -0400] bemu: Good luck!
[2012-03-28 00:00:57 -0400] erratic: I understand this stuff a lot better than I did, and if I had to spend an evening doing it again or a weekend I wouldn't care
[2012-03-28 00:01:00 -0400] bemu: Managing a chef server isn't very much fun, imo.
[2012-03-28 00:01:17 -0400] bemu: I'd rather be producing things, creating real value for the company.
[2012-03-28 00:01:24 -0400] erratic: bemu indeef
[2012-03-28 00:01:27 -0400] erratic: indeed*
[2012-03-28 00:01:42 -0400] erratic: we're about to release a beta
[2012-03-28 00:02:01 -0400] bemu: What're you guys working on?
[2012-03-28 00:02:17 -0400] miah: i run my own chef server =)
[2012-03-28 00:02:23 -0400] miah: what better way to learn chef
[2012-03-28 00:02:34 -0400] bemu: It depends on what part of Chef you want to learn ;)
[2012-03-28 00:02:49 -0400] erratic: miah its not that bad I just had to actually do work to figure out why mine wasn't working
[2012-03-28 00:02:56 -0400] erratic: I'm out of here for the day
[2012-03-28 00:02:58 -0400] miah: well, i dont really see it as parts. knowing how all of it works is just going to make me more effective at solving problems with it
[2012-03-28 00:03:04 -0400] erratic: bemu I'll hop on irc from my phone in a sec and let you know
[2012-03-28 00:20:59 -0400] mhalligan: the 37signals cookbooks are weird. are they worth using?
[2012-03-28 00:21:24 -0400] mhalligan: thery seem to have a bunch of dependencies that duplicate existing cookbooks like "build" which is pretty much identical to "build-essentials"
[2012-03-28 00:31:03 -0400] fujin: anyone seen a knife plugin for mass manipulating environment versions for coookbook enforcements?
[2012-03-28 00:31:23 -0400] fujin: mhalligan: I don't know that the 37signals cookbooks are in under active maint
[2012-03-28 00:31:32 -0400] fujin: mhalligan: I would avoid using them and use the ones on the cookbook site
[2012-03-28 00:32:05 -0400] fujin: they were super handy in earlier versions of chef before a lot of functionality was bought under well supported opscode cookbooks
[2012-03-28 00:32:10 -0400] miah: and never feel bad about forking :P
[2012-03-28 00:32:32 -0400] miah: ouch
[2012-03-28 00:32:52 -0400] erratic: where'd that dude go
[2012-03-28 00:32:59 -0400] fujin: knife cookbook upload pennyworth java jenkins postfix build-essential reprepro leiningen ant gpg jpackage <- lol
[2012-03-28 00:33:02 -0400] fujin: SOO MANY COOKBOOKZZZ
[2012-03-28 00:33:35 -0400] fujin: erratic: which?
[2012-03-28 00:33:36 -0400] fujin: !seen bemu
[2012-03-28 00:33:36 -0400] bawt_: bemu was last seen 31 minutes and 2 seconds ago, saying "It depends on what part of Chef you want to learn ;)"
[2012-03-28 00:34:00 -0400] bemu: lol.
[2012-03-28 00:34:18 -0400] miah: maybe add the upload functionality to Librarian? =)
[2012-03-28 00:34:25 -0400] hoover_damm: fab cookbook_upload host:all
[2012-03-28 00:34:37 -0400] hoover_damm: is uploading really that hard?
[2012-03-28 00:34:39 -0400] bemu: Does anyone have experience with Cisco APs? :(
[2012-03-28 00:34:54 -0400] bemu: I haven't put on my wireless networking hat in ages.
[2012-03-28 00:35:08 -0400] hoover_damm: put em online and let's hack em to life
[2012-03-28 00:35:09 -0400] hoover_damm: :)
[2012-03-28 00:35:11 -0400] bemu: :)
[2012-03-28 00:36:11 -0400] fujin: use the puppet network device =)
[2012-03-28 00:36:56 -0400] fujin: bawt has been running for like 5 years
[2012-03-28 00:37:08 -0400] fujin: can't keep this damn hubot @ Heroku online for the life of me though.
[2012-03-28 00:37:11 -0400] mhalligan: any suggestions on how to get a list of current attributes during a run? I'm really struggling with this djbdns module trying to figure out why it's not getting any of these attributes for parsing.
[2012-03-28 00:37:12 -0400] fujin: fucking node crapbag
[2012-03-28 00:37:29 -0400] fujin: mhalligan: you can use 'shef -z' to diagnose a client run (kinda)
[2012-03-28 00:37:41 -0400] fujin: mhalligan: or knife node show <node> -a attribute.foo.bar.baz
[2012-03-28 00:37:59 -0400] fujin: mhalligan: or.. obviously, use the 'log' resource or Chef::Log to spit something out
[2012-03-28 00:38:41 -0400] hoover_damm: fujin, good idea
[2012-03-28 00:38:53 -0400] hoover_damm: fujin, I was disappointed they didn't make it a little more flexible
[2012-03-28 00:38:56 -0400] hoover_damm: on a serious note
[2012-03-28 00:38:59 -0400] fujin: which?
[2012-03-28 00:39:01 -0400] hoover_damm: but still a damn cool thing
[2012-03-28 00:39:05 -0400] mhalligan: fujin: thanks I'll goof around with those
[2012-03-28 00:39:08 -0400] hoover_damm: puppet network device configuration
[2012-03-28 00:39:11 -0400] fujin: o9h
[2012-03-28 00:39:18 -0400] fujin: I haven't looked at it, always imagined we would get there one day though
[2012-03-28 00:39:26 -0400] fujin: automate that layer of crappy network engineers out of there
[2012-03-28 00:40:10 -0400] hoover_damm: well I was talking to someone awhile back about a job like that
[2012-03-28 00:40:16 -0400] hoover_damm: was kinda hoping to automate everything with chef
[2012-03-28 00:40:22 -0400] hoover_damm: :) should be real fun
[2012-03-28 00:40:56 -0400] hoover_damm: it's just time to crank it up to the level where chef automates everything you can make it automate
[2012-03-28 00:41:14 -0400] hoover_damm: if you can automate breakfast with chef... then make_breakfast "toast" do action :lightly_burned end
[2012-03-28 00:41:47 -0400] hoover_damm: cluster chef for multiple toaster toasting action
[2012-03-28 00:42:17 -0400] hoover_damm: fujin, you sure it's not campfire crashing?
[2012-03-28 00:43:02 -0400] hoover_damm: fujin, campfire was pretty bad 2 months ago about randomly loosing connections (our node bots would have to be restarted 4-6x a day)
[2012-03-28 00:43:05 -0400] hoover_damm: easily
[2012-03-28 00:49:33 -0400] bemu: The 3500e's are about $800 + antenna, and we can put 5 of them on the 2504 WLC without an additional license. The 2504 is about $1,500.
[2012-03-28 00:50:15 -0400] bemu: oops, miss-paste. lol.
[2012-03-28 00:50:32 -0400] bemu: But yeah, that's what I'm scoping for gear.
[2012-03-28 00:50:46 -0400] bemu: The major thing is we're in SoMA/SF so concerned about interference/contention.
[2012-03-28 00:54:21 -0400] fujin: hoover_damm: no the bot is connecting to irc
[2012-03-28 00:54:36 -0400] fujin: hoover_damm: could be the hubot-irc code, the irc lib itself, or anything. I dunno
[2012-03-28 00:54:39 -0400] fujin: not looked into it
[2012-03-28 00:54:59 -0400] fujin: bemu: have you done a wireless signal survey?
[2012-03-28 00:55:15 -0400] jkyle: is there a reference of all the default ohai data?
[2012-03-28 00:55:20 -0400] bemu: No, I haven't even been to the new office yet, but we're scheduled to move in on Friday.
[2012-03-28 00:58:20 -0400] jkyle: trying to access teh ohai data for loaded kernel modules
[2012-03-28 01:38:23 -0400] bradhe: I want to manage environment variables with Chef. Is there an easy way to do this without directly writing to, say, .bash_profile?
[2012-03-28 01:40:20 -0400] hoover_damm: fujin, hrm, irc should be fine except it is ec2... and connectivity is meh sometimes
[2012-03-28 01:40:30 -0400] hoover_damm: but still shouldn't be that bad
[2012-03-28 01:42:47 -0400] |shad0w|: bradhe, do you want them system wide or on a per user basis?
[2012-03-28 01:44:20 -0400] bradhe: |shad0w|: either works, relaly
[2012-03-28 01:44:33 -0400] |shad0w|: what os?
[2012-03-28 01:44:42 -0400] bradhe: linux (ubuntu)
[2012-03-28 01:44:48 -0400] hoover_damm: well there, ubuntu 1.9.3 ppa
[2012-03-28 01:44:57 -0400] hoover_damm: took you forever launchpad
[2012-03-28 01:45:08 -0400] |shad0w|: should probably be able to drop files in /etc/profile.d
[2012-03-28 01:45:19 -0400] bradhe: |shad0w|: wicked
[2012-03-28 01:45:24 -0400] bradhe: |shad0w|: i'll try it
[2012-03-28 01:46:09 -0400] |shad0w|: although thats only for interactive shells
[2012-03-28 01:46:15 -0400] |shad0w|: not sure what your use case is
[2012-03-28 01:51:16 -0400] HasanB: Could one of you give a newbie a quick leg up with something, please?
[2012-03-28 01:52:06 -0400] HasanB: I want to run chef-client -j attribs.json  so as to set  a password at runtime.
[2012-03-28 01:53:46 -0400] HasanB: Unfortunately I haven't seen how to prepare that file in a way that gets my password attribute recognized and applied.
[2012-03-28 01:54:08 -0400] HasanB: where can I see an example?
[2012-03-28 01:58:46 -0400] miah: HasanB: look at the users cookbook
[2012-03-28 01:59:00 -0400] miah: https://github.com/opscode-cookbooks/users
[2012-03-28 02:39:37 -0400] HasanB: miah: thanks, I'll have a look.
[2012-03-28 03:27:19 -0400] jberanek: When building a LWRP using in-line resources in the provider definition, do template resources behave the same as in definitions? (i.e., template resources look for source files in the calling cookbook, rather than the cookbook defining the LWRP?)
[2012-03-28 04:34:09 -0400] mhalligan: why would knife search node "*:*" work, but search(:node, "*:*") in a recipe fails?
[2012-03-28 04:42:43 -0400] miah: it works
[2012-03-28 04:43:15 -0400] mhalligan: not in my situation
[2012-03-28 04:43:27 -0400] miah: try out shef
[2012-03-28 04:43:43 -0400] miah: it makes debugging your code a little easier
[2012-03-28 04:43:55 -0400] mhalligan: when I run it in shef it seems to spit out the output of ohai
[2012-03-28 04:44:31 -0400] miah: yes, it spits out the data returned by the search as an array
[2012-03-28 04:44:47 -0400] mhalligan: but it doesn't return out the same data that knife returns
[2012-03-28 04:45:12 -0400] mhalligan: knife returns 3 entries each with 5 bits of data. that search returns 1 entry for the local host, and hundreds of variables
[2012-03-28 04:45:26 -0400] miah: it does
[2012-03-28 04:45:59 -0400] mhalligan: this isn't even code I wrote, just the 37signals djbdns module i've been struggling with
[2012-03-28 04:46:13 -0400] miah: so, the difference here is that by default a knife search only returns a few different attributes, try 'knife search node "*:*" -l'
[2012-03-28 04:46:17 -0400] miah: you'll see that it matches
[2012-03-28 04:46:39 -0400] miah: the 37signals stuff is oldschool and likely not going to work with chef 0.10, a lot of it is written for the older 0.9 way of things
[2012-03-28 04:48:03 -0400] mhalligan: :(3
[2012-03-28 04:49:21 -0400] miah: you can pull out specific attributes in your search
[2012-03-28 04:49:58 -0400] miah: take a look at the nagios cookbook, there is lots of search going on
[2012-03-28 04:50:15 -0400] mhalligan: so I should dump all the 37s shit?
[2012-03-28 04:50:25 -0400] miah: unless you want to refactor codes
[2012-03-28 04:50:35 -0400] miah: its probably not the best place to start from
[2012-03-28 04:50:47 -0400] mhalligan: all this work to manage tthe dns server that always annoyed me the most.
[2012-03-28 04:51:09 -0400] miah: why djbdns? =)
[2012-03-28 04:51:34 -0400] mhalligan: because my customer is an idiot and won't use an external dns server
[2012-03-28 04:51:53 -0400] mhalligan: and djbdns seems to be the only dns server anyone has written a cookbook for
[2012-03-28 04:51:59 -0400] miah: ah
[2012-03-28 04:52:23 -0400] mhalligan: (and my customer is an idiot and insisted I do this in Chef when I know Puppet like the back of my hand)
[2012-03-28 04:52:24 -0400] miah: there are powerdns, bind, maradns cookbooks on the community site
[2012-03-28 04:52:49 -0400] miah: you might be able to glean some details from them and fix up your djbdns cookbook
[2012-03-28 04:52:59 -0400] mhalligan: I'm digging through the nagios stuff now
[2012-03-28 04:53:10 -0400] miah: cool
[2012-03-28 04:53:21 -0400] mhalligan: but thanks for the advice on the 37s bs, I would have wasted another couple of days chasing this
[2012-03-28 04:53:27 -0400] miah: ya
[2012-03-28 04:53:55 -0400] miah: ive written several cookbooks at this point, if you have questions let me know
[2012-03-28 04:54:44 -0400] mhalligan: thanks, I might pick your brain.
[2012-03-28 04:55:08 -0400] miah: ok. just not my nose please.
[2012-03-28 05:14:33 -0400] learningchef: how can chef clients find out the IP address of chef server? (i.e., how does the bootstrap process happen?)
[2012-03-28 05:46:48 -0400] tolland: learningchef: as the clients need a validation.pem from the server, its usually convenient to prime the server ip to the client at the same time
[2012-03-28 05:47:54 -0400] tolland: but an obvious strategy, if you decide not is to add a record in your local dns for chef
[2012-03-28 05:48:43 -0400] tolland: the validation pem also might containing the signing server details...
[2012-03-28 05:53:18 -0400] mhalligan: any idea how ohai assembled the fqdn?
[2012-03-28 05:56:21 -0400] learningchef: tolland, if i run a chef server on ec2 (and ip may be changed), how can I make my  chef clients recognize their master? should I use an elastic IP for the chef server?
[2012-03-28 05:58:02 -0400] mhalligan: ah. hostname -f.
[2012-03-28 06:00:04 -0400] learningchef: tolland: if i run a chef server on ec2 (and ip may be changed), how can I make my  chef clients recognize their master?
[2012-03-28 06:13:45 -0400] miah: pki + dns
[2012-03-28 06:14:21 -0400] miah: as long as everything resolves correctly it should be fine
[2012-03-28 06:16:31 -0400] mhalligan: miah: any suggestions as to the best way to set a domain name and create /etc/hosts properly when bootstrapping? I'm in a bit of a chicken & the egg problem right now where fqdn can't be generated because bootstrapped nodes' /etc/hosts doesn't have ip: hostname.domain : hostname (node['fqdn'] is set by hostname -f)
[2012-03-28 06:17:44 -0400] miah: mhalligan: did you take a look at my gist from earlier?
[2012-03-28 06:18:53 -0400] mhalligan: miah: err I don't seem to have that much scroll-back
[2012-03-28 06:23:42 -0400] mhalligan: ah there we go, a custom bootstrap script in my .chef dir
[2012-03-28 06:24:04 -0400] miah: mhalligan: https://gist.github.com/2221571
[2012-03-28 06:27:28 -0400] nacer: ho
[2012-03-28 06:27:30 -0400] nacer: hi
[2012-03-28 06:28:08 -0400] mhalligan:  that hurts my brain
[2012-03-28 06:28:14 -0400] miah: hah
[2012-03-28 06:28:19 -0400] miah: its 00gly codes for sure
[2012-03-28 06:28:37 -0400] miah: but its pretty straight forward
[2012-03-28 06:28:47 -0400] mhalligan: I think I need to do a step ahead
[2012-03-28 06:28:59 -0400] mhalligan: and make the "right thing" happen in knife's bootstrap script
[2012-03-28 06:29:20 -0400] mhalligan: because then I'd have the right node['fqdn'] to work with.
[2012-03-28 06:32:10 -0400] mhalligan: hrm. what's the difference between server-name and node-name?
[2012-03-28 06:36:34 -0400] mhalligan: I guess the djbdns stuff would have worked fine if fqdn had been set
[2012-03-28 06:39:12 -0400] erikh: we overwrite the fqdn during our base role converge
[2012-03-28 06:39:23 -0400] erikh: calculate it from environment + node name
[2012-03-28 06:39:38 -0400] erikh: not sure if that helps you much, but it works well for us.
[2012-03-28 06:42:46 -0400] miah: what sets your node name?
[2012-03-28 06:47:35 -0400] Kwanasolis: \o
[2012-03-28 07:15:31 -0400] edibrac: does chef have a common set of modules that everyone uses "by default" ?
[2012-03-28 07:16:13 -0400] edibrac: i.e. for apache, mysql .. stuff that's really popular? I mean, for puppet there's  a bunch of versions. You'd think by now there would be something everyone swears by
[2012-03-28 07:16:26 -0400] edibrac: i.e. like how DBI is with perl, in terms of community adoption
[2012-03-28 07:16:51 -0400] Kwanasolis: edibrac: ?
[2012-03-28 07:17:11 -0400] Kwanasolis: edibrac: chef has a lot of stuff lots of people use, but its not really like that because of the niche it fits and it hasn't been around as long as puppet or some of the others
[2012-03-28 07:17:17 -0400] BryanWB: edibrac: probably the lower level stuff like resolver, java, stuff like that
[2012-03-28 07:17:19 -0400] Kwanasolis: edibrac: so there isn't a ton of duplicated effort, but there is some
[2012-03-28 07:18:22 -0400] edibrac: has there been talk about getting a common set going, in the chef world?
[2012-03-28 07:20:18 -0400] Mithrandir: there is a set of shared cookbooks, mostly managed by opscode
[2012-03-28 07:20:40 -0400] Mithrandir: personally, I don't use it, since I started out writing my own stuff
[2012-03-28 07:25:07 -0400] BryanWB: i use the opscode cookbooks pretty heavily, i also modify them, and have pushed back a lot of changes
[2012-03-28 07:25:50 -0400] miah: same
[2012-03-28 07:26:07 -0400] Kwanasolis: I've pushed back a few little ones, nothing major, trying to work my private stuff into the shape I can release it
[2012-03-28 07:26:20 -0400] Kwanasolis: edibrac: I think tbh, chef is a little young still, so like I said, doesn't have a lot of overlap
[2012-03-28 07:31:30 -0400] BryanWB: pushing shit back to opscode is an easy way to get a free code review from jtimberman
[2012-03-28 07:31:36 -0400] Kwanasolis: LOL
[2012-03-28 07:31:43 -0400] BryanWB: pretty invaluable actually
[2012-03-28 07:31:47 -0400] Kwanasolis: I'm sure he appreciates that immensely :)
[2012-03-28 07:32:05 -0400] BryanWB: Kwanasolis: i am sure he appreciates good cookbooks he doesn't have to write ;)
[2012-03-28 07:32:18 -0400] Kwanasolis: fair point
[2012-03-28 07:32:22 -0400] nico: same as Mithrandir, fully home made
[2012-03-28 07:32:47 -0400] miah: i like writing cookbooks
[2012-03-28 07:34:51 -0400] Mithrandir: sharing cookbooks means you have to clean them up more and parameterise more.  While this usually increases quality, it also means more work.
[2012-03-28 07:35:36 -0400] BryanWB: i got bug fixes from cookbooks i have pushed to opscode, those saved me a lot of time
[2012-03-28 07:36:02 -0400] ssd7_: Ohai Chefs
[2012-03-28 07:38:44 -0400] Kwanasolis: I've got a bunch I haven't shared, mostly for what Mithrandir said
[2012-03-28 07:38:55 -0400] Kwanasolis: they work in my infrastructure and I haven't had time to generalize them
[2012-03-28 07:59:16 -0400] jtimberman: :P
[2012-03-28 08:03:28 -0400] BryanWB: jtimberman: tks for great work on opscode-cookbooks, i just pushed to maven w/ an lwrp for downloading artifacts
[2012-03-28 08:04:07 -0400] BryanWB: jtimberman: there is an important caveat to it, as it depends on the ark cookbook
[2012-03-28 08:05:17 -0400] jtimberman: BryanWB: maven ><
[2012-03-28 08:06:01 -0400] jtimberman: BryanWB: hey re: the java download thing, I'm on the same page as Adam on that.
[2012-03-28 08:06:20 -0400] jtimberman: "download it and stick it in a local repo/fileserver thing"
[2012-03-28 08:06:37 -0400] BryanWB: jtimberman: agreed
[2012-03-28 08:06:56 -0400] BryanWB: the watir-webdriver thing is crazy, but fun to figure out
[2012-03-28 08:06:58 -0400] jtimberman: but if you got it to work by driving through firefox, thats kind of awesome.
[2012-03-28 08:07:07 -0400] jtimberman: that would make an amusing blog post :)
[2012-03-28 08:08:21 -0400] BryanWB: jtimberman: the maven lwrp is very useful for deploying an application's .war file from a corporate repository like artifactory
[2012-03-28 08:14:09 -0400] reset: BryanWB: what maven LWRP? I didn't think the opscode maven cookbook had one
[2012-03-28 08:14:46 -0400] BryanWB: reset: it doesn't, i added one
[2012-03-28 08:14:56 -0400] reset: oh awesome, do you have a link to the fork /branch?
[2012-03-28 08:15:17 -0400] BryanWB: reset: https://github.com/bryanwb/maven
[2012-03-28 08:15:55 -0400] BryanWB: maven "postgresql" do  groupId "postgresql"   version "9.0.1-jdbc4"    dest  "/usr/local/tomcat/lib"    end
[2012-03-28 08:16:11 -0400] reset: looks good man
[2012-03-28 08:16:13 -0400] miah: hot
[2012-03-28 08:40:18 -0400] jtimberman: BryanWB: is there a ticket for it?
[2012-03-28 08:41:57 -0400] roidrage: jtimberman is The Night Owl.
[2012-03-28 08:44:06 -0400] BryanWB: jtimberman: yup, http://tickets.opscode.com/browse/COOK-1145
[2012-03-28 08:46:05 -0400] nacer: BryanWB: i'am making my own java repo i don't want to scrape oracle website
[2012-03-28 08:58:53 -0400] ajardan_: hello
[2012-03-28 08:58:54 -0400] jtimberman: roidrage: i was sick earlier, slept a few hours, now wide awake :/
[2012-03-28 08:59:00 -0400] roidrage: :(
[2012-03-28 08:59:09 -0400] ajardan_: can I use standard chef providers in a new provider I'm writing ?
[2012-03-28 08:59:18 -0400] jtimberman: ajardan_: sure
[2012-03-28 08:59:41 -0400] jtimberman: BryanWB: cool, thanks.
[2012-03-28 08:59:45 -0400] jtimberman: BryanWB: will poke next week.
[2012-03-28 09:00:10 -0400] ajardan_: so I can create a provider like backup_files, which will inside generate a template using template resource ?
[2012-03-28 09:01:25 -0400] BryanWB: ajardan_: yes
[2012-03-28 09:01:35 -0400] ajardan_: gr8
[2012-03-28 09:01:42 -0400] ajardan_: thanks a lot :)
[2012-03-28 09:02:09 -0400] miah: i am tireds. but has more to do.
[2012-03-28 09:14:49 -0400] Kwanasolis: is there a way to make ohai[] objects return as hashes?
[2012-03-28 09:35:10 -0400] nacer: BryanWB: are you here ?
[2012-03-28 09:36:32 -0400] nacer: BryanWB: are you sure the checksum work on your java::oracle.rb because this should not append a think : https://gist.github.com/0ae02f8f6a3dbb84c087
[2012-03-28 09:37:21 -0400] miah: you could download the file and verify your checksum
[2012-03-28 09:38:39 -0400] dle: hi, I want create users with post_rest, but  I have a error "HTTP Request Returned 500 Internal Server Error: undefined method `name' for nil:NilClass" :-( Do you have a solution ?
[2012-03-28 09:42:03 -0400] BryanWB: nacer: append a "think" ?
[2012-03-28 09:43:58 -0400] nacer: BryanWB: i think
[2012-03-28 09:44:21 -0400] BryanWB: nacer: append what?
[2012-03-28 09:44:53 -0400] nacer: BryanWB: he try to run a html page :)
[2012-03-28 09:45:13 -0400] nacer: BryanWB: run/extract
[2012-03-28 09:45:44 -0400] BryanWB: nacer: that recipe is broken cuz of fucking oracle
[2012-03-28 09:45:44 -0400] nacer: BryanWB: the recipe should fail before that , on the checksum check ?
[2012-03-28 09:45:52 -0400] nacer: BryanWB: yup i know
[2012-03-28 09:46:09 -0400] BryanWB: nacer: no it will download every time cuz checksum doesn't match
[2012-03-28 09:46:37 -0400] BryanWB: nacer: to fix, override default['java']['jdk']['6']['x86_64']['url']  pointing to a local url
[2012-03-28 09:46:51 -0400] BryanWB: where u have the tarball
[2012-03-28 09:47:01 -0400] nacer: BryanWB: no it don't retry, he try to extract the html page
[2012-03-28 09:48:11 -0400] BryanWB: nacer: the checksum only applies after the file is in the chef cache
[2012-03-28 09:49:12 -0400] nacer: BryanWB: ok
[2012-03-28 09:49:51 -0400] Kwanasolis: BryanWB: heh, arch's approach: source=("http://uni-smr.ac.ru/archive/dev/java/JRE/oracle/7/jre-$pkgver-linux-i586.tar.gz"
[2012-03-28 09:49:57 -0400] Kwanasolis: cause oracle broke them too
[2012-03-28 09:50:18 -0400] nacer: BryanWB: it run this command on a corrupt file bash ./#{tarball_name} -noregister
[2012-03-28 09:50:56 -0400] BryanWB: Kwanasolis: nice ;)
[2012-03-28 09:51:09 -0400] Kwanasolis: well in arch you cannot override the md5sum check
[2012-03-28 09:51:19 -0400] Kwanasolis: it just won't work, so I got to thinking about it, and wanted to see what they did
[2012-03-28 09:52:16 -0400] BryanWB: that link is broken too
[2012-03-28 09:52:28 -0400] BryanWB: no it works
[2012-03-28 09:52:35 -0400] Kwanasolis: if you fix pkgver it will
[2012-03-28 09:52:50 -0400] Kwanasolis: that's pulled from the PKGBUILD
[2012-03-28 09:52:54 -0400] Kwanasolis: 7ub4?
[2012-03-28 09:53:12 -0400] Kwanasolis: 7u3
[2012-03-28 10:18:17 -0400] Kwanasolis: so I'm working on a provider that depends on a system package (s3fs), where is the sane place to stick the package 's3fs' request?
[2012-03-28 10:18:32 -0400] Kwanasolis: is it best to depend on this in a recipe? or can I wrap this into the resource/provider itself?
[2012-03-28 10:39:34 -0400] mart: Hi, can anyone tell me whether chef has this problem? https://groups.google.com/group/puppet-users/browse_thread/thread/8ee940ba3695b159/94a9c269a0af8ed7
[2012-03-28 10:40:20 -0400] mart: tl;dr: Using third-party modules/cookbooks is difficult because you get an error if two depend on the same package.
[2012-03-28 10:44:18 -0400] Mithrandir: it doesn't
[2012-03-28 10:44:50 -0400] mart: Mithrandir: so, if I have package("git-core") in two cookbooks, everything is cool?
[2012-03-28 10:44:59 -0400] Mithrandir: sure
[2012-03-28 10:45:17 -0400] Mithrandir: chef doesn't try to do the topological sort puppet does, so it's just fine
[2012-03-28 10:45:24 -0400] mart: OK, so what happens if one cookbook says that a service should be running, and one says it should not?
[2012-03-28 10:45:31 -0400] mart: Last takes precendence?
[2012-03-28 10:46:58 -0400] Mithrandir: unsure, try?
[2012-03-28 10:47:05 -0400] mart: I really like the idea of puppet, but modules that don't compose seems crazy. So I'm wondering how chef deals with overlapping (and possibly conflicting) cookbooks.
[2012-03-28 10:47:51 -0400] mart: Mithrandir: I've not used chef. Just trying to get an idea of whether I should invest that time.
[2012-03-28 10:48:19 -0400] luisico: mart, the right way it would be having a cookbook for git with a recipe installing git-core package and put a include_recipe "git" in the second cookbook instead of having a repeated package "git-core"
[2012-03-28 10:49:12 -0400] mart: luisico: sure, but you're assuming I want to write all my own modules, and I know a priori all the possible sets of cookbooks that might be used on a machine.
[2012-03-28 10:49:47 -0400] luisico: right
[2012-03-28 10:51:38 -0400] mart: luisico: so, given that's the 'right' way, I'm wondering whether it'll work if I do in a less elegant way (albeit with better reusability).
[2012-03-28 10:52:54 -0400] luisico: mart, yeah, as Mithrandir said, you can have "duplicated" package definitions
[2012-03-28 10:52:56 -0400] luisico: no problem
[2012-03-28 10:53:37 -0400] mart: luisico: do you know about what happens in the case where two cookbooks define conflicting states for a service: one says running, and the other says stopped?
[2012-03-28 10:53:54 -0400] zts: mart: whatever the last one says will be used
[2012-03-28 10:54:20 -0400] mart: I must admit, I expected both chef and puppet would work more like package resolvers: merge the requirements, and report any conflicts. So I was wrong twice.
[2012-03-28 10:54:37 -0400] zts: mart: there's an additional note to make on this one...
[2012-03-28 10:54:54 -0400] zts: Chef intentionally allows you to "reopen" resources to change/append to the data that's being passed in
[2012-03-28 10:55:09 -0400] zts: the common use is for templates, where you may want to add additional variables into the template from various cookbooks
[2012-03-28 10:55:39 -0400] mart: If you weren't happy with default settings in the cookbook, say?
[2012-03-28 10:55:40 -0400] zts: the downside to this is surprise, as you may accidentally reopen a resource when you would prefer an error
[2012-03-28 10:55:58 -0400] zts: yeah that too, although you'd more typically deal with that by modifying attributes on the node or in a role
[2012-03-28 10:56:09 -0400] Mithrandir: mart: settings usually live in attributes, which are set on the node or the role.
[2012-03-28 10:56:23 -0400] zts: anyway, there was a little bit of discussion on this subject the other day.  It would be nice if the default was that resources wouldn't be re-opened, and instead threw an error
[2012-03-28 10:56:37 -0400] zts: but that if you wanted a particular resource to be re-openable, you could set an attribute to enable it
[2012-03-28 10:56:40 -0400] HasanB: Good morning everyone.
[2012-03-28 10:57:05 -0400] Mithrandir: I think they should be reopened, but some should report errors, such as services changing the action incompatibly.
[2012-03-28 10:57:41 -0400] mart: Mithrandir: that sounds like what I'd expect.
[2012-03-28 10:58:25 -0400] zts: Mithrandir: yeah, that's fair.  I guess the debate then goes to "consistent behaviour across all resources" vs "each resource defaults to behaviour that makes the most sense for that resource type"
[2012-03-28 10:58:27 -0400] Mithrandir: so you can add/change attributes for a template, but not have action [:start, :stop]
[2012-03-28 10:58:50 -0400] Mithrandir: zts: I think the latter makes sense, but I see how reasonable people can disagree about what the default should be
[2012-03-28 10:58:55 -0400] zts: agreed
[2012-03-28 10:59:11 -0400] zts: eg, note that you might be surprised by a template being re-opened too
[2012-03-28 10:59:47 -0400] zts: (if two different cookbooks are trying to manage the same file, and you weren't aware)
[2012-03-28 11:00:11 -0400] Mithrandir: sure
[2012-03-28 11:00:30 -0400] mart: Mithrandir: luisico: zts: thanks for your help.
[2012-03-28 11:02:01 -0400] HasanB: I just hit an obscure problem.
[2012-03-28 11:02:18 -0400] HasanB: Perhaps it is familiar to someone here.
[2012-03-28 11:02:50 -0400] HasanB: Error message (from chef-client) is ::   FATAL: Chef::Exceptions::CannotDetermineNodeName: Unable to determine node name: configure node_name or configure the system's hostname and fqdn
[2012-03-28 11:03:07 -0400] HasanB: The node was working fine last night.
[2012-03-28 11:03:36 -0400] HasanB: First sign of trouble was Ruby unable to allocate memory, so I rebooted.
[2012-03-28 11:04:14 -0400] HasanB: I can no longer run chef-client without hitting that FATAL
[2012-03-28 11:04:23 -0400] luisico: what ohai hostname returns?
[2012-03-28 11:04:29 -0400] luisico: or
[2012-03-28 11:04:31 -0400] luisico: ohai fqdn
[2012-03-28 11:04:38 -0400] HasanB: I'm running Ubu 11.04 on an OpenVZ VPS
[2012-03-28 11:05:18 -0400] luisico: HasanB, does ohai return the right hostname or fqdn?
[2012-03-28 11:05:52 -0400] HasanB: ohai fqdn [   "meta" ]
[2012-03-28 11:06:06 -0400] HasanB: ohai hostname [   "meta" ]
[2012-03-28 11:06:28 -0400] HasanB: those are the names I used to configure the node.
[2012-03-28 11:07:25 -0400] luisico: chef and ohai version?
[2012-03-28 11:07:41 -0400] HasanB: (btw that is my first use of ohai.  I'm learning still)
[2012-03-28 11:08:14 -0400] HasanB: INFO: *** Chef 0.10.8 ***
[2012-03-28 11:08:34 -0400] HasanB: ohai -version ==> Ohai: 0.6.12
[2012-03-28 11:10:14 -0400] luisico: did you run ohai with the same user as chef-client?
[2012-03-28 11:10:38 -0400] HasanB: yes
[2012-03-28 11:10:57 -0400] luisico: do you have node_name in your client.rb conf?
[2012-03-28 11:11:35 -0400] luisico: or are you passing the node_name to chef-client via -N param?
[2012-03-28 11:13:11 -0400] HasanB: I'm not sure.   Where would I look to see that.  client or workstation?
[2012-03-28 11:13:49 -0400] HasanB: I prepare my nodes from a RunDeck job I created, not with knife bootstrap.
[2012-03-28 11:13:55 -0400] luisico: the client.rb of the server where you are running chef-client
[2012-03-28 11:14:07 -0400] luisico: and it's showing throwing that exception
[2012-03-28 11:14:11 -0400] HasanB: ok, 1 sec.
[2012-03-28 11:19:47 -0400] luisico: and it's showing throwing that exception
[2012-03-28 11:20:38 -0400] HasanB: I've got six different  client.rb files  !
[2012-03-28 11:21:12 -0400] HasanB: "/etc/chef/client.rb"
[2012-03-28 11:21:23 -0400] HasanB: "/usr/share/chef/client.rb"
[2012-03-28 11:21:45 -0400] HasanB: and four more under "/usr/lib/ruby/"
[2012-03-28 11:23:52 -0400] luisico: the last ones are part of the chef core
[2012-03-28 11:24:02 -0400] HasanB: this one "/usr/share/chef/client.rb"  is the only one that referes to my  validation client name and key.  but it has no node_name attribute defined
[2012-03-28 11:24:06 -0400] luisico: are your chef client using the one in /etc/chef/client.rb?
[2012-03-28 11:24:24 -0400] luisico: and what are you using?
[2012-03-28 11:24:53 -0400] luisico: which one, I mean
[2012-03-28 11:25:23 -0400] HasanB: I don't know how to determine that.
[2012-03-28 11:26:33 -0400] HasanB: I just added     node_name  "meta"         to /etc/chef/client.rb  and reran   chef-client.
[2012-03-28 11:26:59 -0400] HasanB: I get       /usr/lib/ruby/1.8/systemu.rb:30:in `system': Cannot allocate memory (Errno::ENOMEM)        again.
[2012-03-28 11:30:45 -0400] HasanB: Rebooted, and the     FATAL: Chef::Exceptions::CannotDetermineNodeName    problem has gone away.  So adding      node_name  "meta"         to /etc/chef/client.rb      was evidently the right answer.
[2012-03-28 11:31:15 -0400] HasanB: luisico:   much obliged!    thank you.
[2012-03-28 11:39:44 -0400] Mithrandir: HasanB: fixing /etc/hosts is probably even better
[2012-03-28 11:39:50 -0400] Mithrandir: so the machine can resolve its host name
[2012-03-28 11:41:34 -0400] HasanB: Ok.  I'll look at why that is not hapenning as it should.  The mystery though is why it has worked fine for several weeks.
[2012-03-28 11:46:37 -0400] luisico: I would say that you have a memory problem because of the obvious message
[2012-03-28 11:46:58 -0400] luisico: ohai shouldn't have a memory problem trying to get any attribute
[2012-03-28 11:47:55 -0400] luisico: neither chef-client with the node_name
[2012-03-28 11:50:35 -0400] tzn: hi there, I'm having troubles withh all commands involving ssh connections. Cannot bootstrap, cannot bootstrap during instance creation
[2012-03-28 11:50:46 -0400] tzn: while I can login with the key just fine
[2012-03-28 11:55:36 -0400] tzn: any ideas?
[2012-03-28 12:22:02 -0400] fearoffish: tzn: Let me get our my magic crystal ball and see!   Alternatively you could post more information, like the command you ran.
[2012-03-28 12:23:03 -0400] tzn: http://pastebin.com/8Ls7GmbW
[2012-03-28 12:23:10 -0400] tzn: here you have ;)
[2012-03-28 12:25:33 -0400] fearoffish: show me the ssh line that works too
[2012-03-28 12:25:48 -0400] fearoffish: and are you using a custom ssh config stanza?
[2012-03-28 12:25:55 -0400] tzn: no, plain ssh
[2012-03-28 12:27:42 -0400] tzn: zen@XXX:~ $ ssh -i .ssh/key-prod.pem XXX -lroot
[2012-03-28 12:27:47 -0400] tzn: key is also added to ssh-agent
[2012-03-28 12:32:20 -0400] tzn: i suspect something trivial
[2012-03-28 12:43:20 -0400] HasanB: luisico:  I'm sure you are correct.  I'm questioning the advisability of using OpenVZ in a hosting environment outside my control.  Theoretically I have 1Gb of RAM.    Open-jdk, tomcat, ruby and chef-client should not eat all that up.
[2012-03-28 12:43:55 -0400] tzn: just form experience, chef client could eat u to 300MiB
[2012-03-28 12:47:47 -0400] HasanB: Ow.
[2012-03-28 12:48:00 -0400] tzn: fearoffish: any ideas?
[2012-03-28 12:50:12 -0400] fearoffish: friend just bobbed rond, I'll help when I can (or someone else might)
[2012-03-28 12:50:29 -0400] fearoffish: tzn: but quickly.try -x root as well
[2012-03-28 12:50:32 -0400] fearoffish: to set the user
[2012-03-28 12:51:05 -0400] tzn: tried that as well, no avail :/
[2012-03-28 13:01:40 -0400] tzn: ok solved it
[2012-03-28 13:01:51 -0400] tzn: system ssh_config was edited
[2012-03-28 13:50:48 -0400] afallows: My chef server seems to hang indefinitely on incoming requests. When I restart the server, it behaves just fine, but after a few minutes a request will stall out and it seems to be locked up until I restart it again. Is this a common problem?
[2012-03-28 14:04:40 -0400] BryanWB: afallows: i haven't heard of it before
[2012-03-28 14:06:50 -0400] cgibbons: hmmm
[2012-03-28 14:17:03 -0400] afallows: Interestingly, it seems like every time it hangs, the last thing it was doing (e.g. form submission on the webui, cookbook upload, etc), goes through without errors, but then the server doesn't feed tne next thing back to the client.
[2012-03-28 14:43:03 -0400] BryanWB: miah: around?
[2012-03-28 14:43:34 -0400] sampikesley: afallows: are you proxying it through nginx or something?
[2012-03-28 14:45:58 -0400] afallows: sampikesley: I'm not.
[2012-03-28 14:46:56 -0400] sampikesley: meh
[2012-03-28 14:47:00 -0400] sampikesley: anything logged?
[2012-03-28 14:48:04 -0400] afallows: Nothing that points to this. The only errors I saw in the log pertain to knife commands I mistyped.
[2012-03-28 14:54:46 -0400] hoover_damm: afallows, using passenger?
[2012-03-28 14:54:57 -0400] hoover_damm: generally there should be something in a log somewhere to say what's up
[2012-03-28 14:55:28 -0400] hoover_damm: good idea to check disk space
[2012-03-28 14:55:40 -0400] hoover_damm: if your running out of disk space you'll fail to accept cookbook uploads
[2012-03-28 14:56:25 -0400] afallows: Disk is more than half free.
[2012-03-28 14:56:48 -0400] afallows: Other than /var/log/chef, is there a place worth looking for a relevant logfile?
[2012-03-28 14:59:05 -0400] hoover_damm: if you run passenger you can find some bits in the nginx error logs (or apache)
[2012-03-28 14:59:58 -0400] sampikesley: but if it's broken, bypass any proxying if you can while you fix it
[2012-03-28 15:00:33 -0400] afallows: I don't have any proxying configured, unless there's some proxying set up by default in the install process.
[2012-03-28 15:01:30 -0400] sampikesley: nope
[2012-03-28 15:01:35 -0400] sampikesley: so you're hitting port 4000?
[2012-03-28 15:01:39 -0400] afallows: Yessir
[2012-03-28 15:02:40 -0400] sampikesley: so it's running via chef-server -e production -p 4000 -L /var/log/chef/server.log or similar?
[2012-03-28 15:03:00 -0400] afallows: I -am- hitting it through a dynamic DNS, but if that were the breakpoint I'd be baffled as to why restarting chef-server fixed it.
[2012-03-28 15:03:11 -0400] afallows: Yes indeed
[2012-03-28 15:04:32 -0400] sampikesley: anf that log shows nothing?
[2012-03-28 15:04:47 -0400] afallows: I don't see anything relevant, no.
[2012-03-28 15:05:24 -0400] |shad0w|: is the ip on the server changing?
[2012-03-28 15:06:02 -0400] sampikesley: afallows: stop it, run it with '-l debug'
[2012-03-28 15:06:07 -0400] afallows: |shad0w|: No, it shouldn't be.
[2012-03-28 15:06:24 -0400] afallows: I'll give that a try.
[2012-03-28 15:23:02 -0400] afallows: Well, that's interesting. I restarting the server with debug log level, and everything was working fine until I attempted to create a new role. Last message from the server is "override_attributes\":{}}">
[2012-03-28 15:23:17 -0400] afallows: Ack, sorry, pasted badly.
[2012-03-28 15:23:19 -0400] brett_h: I get a "404: I don't know how to search for users data objects." when trying to run the opscode nagios;server recipe... thoughts?
[2012-03-28 15:23:41 -0400] afallows: "DEBUG: Pushing item to index for addition:"
[2012-03-28 15:23:47 -0400] eyeyen: hi guys, how do i make a recipe such that it runs "sudo apt-get install archmage" ?
[2012-03-28 15:23:54 -0400] afallows: No error messages, it's just hanging on that.
[2012-03-28 15:24:38 -0400] afallows: eyeyen: Check out the 'package' resource. http://wiki.opscode.com/display/chef/Resources#Resources-Package
[2012-03-28 15:25:34 -0400] eyeyen: afallows: thanks, i'll check it out
[2012-03-28 15:26:39 -0400] erratic: anybody found a good way for creating a lamp role so that my php.ini on all of my apache servers can be consistent across all of them?
[2012-03-28 15:27:40 -0400] sampikesley: erratic: stick it in a data bag
[2012-03-28 15:28:29 -0400] sampikesley: afallows: sure your role is kosher?
[2012-03-28 15:28:47 -0400] afallows: Yeah, I created it empty
[2012-03-28 15:28:50 -0400] erratic: databags are for json arent they?
[2012-03-28 15:29:14 -0400] sampikesley: erratic: well they're written in json, yes
[2012-03-28 15:29:28 -0400] sampikesley: hmm, is this file *exactly the same* across your nodes?
[2012-03-28 15:50:52 -0400] geekbri: anybody have a good resource for writing your own LWRPs ?
[2012-03-28 15:51:19 -0400] afallows: Well, now I'm even more confused: I rebooted the server, tried creating a new, unedited role again. Knife spit back "ERROR: Server returned error for http://server-url:4000/roles/rolename, retrying 1/5 in 3s" -- but the role still got created.
[2012-03-28 15:54:26 -0400] geekbri: anybody have a good resource for writing your own LWRPs ? perhaps a tutorial
[2012-03-28 15:59:17 -0400] sampikesley: geekbri: I learned by rewriting a goodly portion of the opscode users cookbook
[2012-03-28 15:59:59 -0400] sampikesley: If you understand what an interface or an abstract class is in OO, you're good to go
[2012-03-28 16:00:20 -0400] geekbri: sampikesley: I do indeed understand those things!  Not sure how to tie them together with providers though.
[2012-03-28 16:03:05 -0400] erratic: sampikesley I just want to make a chef role that puts a php.ini file that tells apache2 mod_php to use memcache instead of files for session
[2012-03-28 16:03:22 -0400] sampikesley: geekbri: read this? http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29
[2012-03-28 16:03:27 -0400] erratic: someone suggested a databag for the ini file?
[2012-03-28 16:03:35 -0400] sampikesley: that was me
[2012-03-28 16:03:44 -0400] sampikesley: but I was posssibly being a ballbag
[2012-03-28 16:03:45 -0400] geekbri: sampikesley: mmm yeah im on the page now.. ill give it another readthrough mayb ei'll have a moment of clarity
[2012-03-28 16:03:56 -0400] erratic: heh
[2012-03-28 16:04:11 -0400] sampikesley: erratic: you ptrolly want this: http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-03-28 16:04:22 -0400] sampikesley: is very easy that way
[2012-03-28 16:04:35 -0400] erratic: checking
[2012-03-28 16:05:39 -0400] erratic: I would imagine the cookbooks for apache and php and the likes would have attributes that you can set in your profiles to do what I want to do ...
[2012-03-28 16:05:56 -0400] erratic: like in the role
[2012-03-28 16:06:05 -0400] erratic: then apply the role to the machine that I want that on
[2012-03-28 16:22:41 -0400] erratic: yaawn
[2012-03-28 16:22:43 -0400] erratic: you know
[2012-03-28 16:22:50 -0400] erratic: I should just setup my servers by hand
[2012-03-28 16:22:52 -0400] erratic: for now
[2012-03-28 16:23:00 -0400] erratic: and deal with making roles and cookbooks later
[2012-03-28 16:23:10 -0400] erratic: I only have a few servers at this point
[2012-03-28 16:23:39 -0400] erratic: I'd like to spend more time figuring out databags and roles and all the ways I could theoretically do this so that it gets done right
[2012-03-28 16:26:13 -0400] erratic: it's gonna be pretty complicated, I have to create the following roles, lamp_server_master(rsyncd, mysql master) lamp_server_slave(...), all of the lamp servers need to have a custom php.ini that tells them to use memcache instead of files for session because they're behind a load balancer
[2012-03-28 16:26:46 -0400] erratic: the role for the sharded mysql configuration is pretty easy
[2012-03-28 16:29:53 -0400] erratic: hmmmm
[2012-03-28 16:30:23 -0400] erratic: sampikesley so you think I should modify a recipe and use a databag for all of my php.ini key/values
[2012-03-28 16:30:38 -0400] erratic: and just modify the recipe to do the php.ini
[2012-03-28 16:33:09 -0400] erratic: https://github.com/opscode/php-quick-start/blob/master/README.md
[2012-03-28 16:33:23 -0400] btm: erratic: it's easiest to write the recipes if you build the servers using Chef as you write them, as if you were running the commands.
[2012-03-28 16:34:33 -0400] sampikesley: yes, do that
[2012-03-28 16:34:38 -0400] sampikesley: you might find it takes a long time
[2012-03-28 16:34:42 -0400] sampikesley: but the payoff is immense
[2012-03-28 16:35:15 -0400] erratic: thats a little ambiguous to me but I think I understand what you mean
[2012-03-28 16:35:36 -0400] sampikesley: a little piece at a time
[2012-03-28 16:35:38 -0400] sampikesley: test it
[2012-03-28 16:35:43 -0400] sampikesley: move on
[2012-03-28 16:35:45 -0400] erratic: ah yes
[2012-03-28 16:35:45 -0400] sampikesley: then
[2012-03-28 16:35:53 -0400] sampikesley: do it with vagrant
[2012-03-28 16:36:01 -0400] sampikesley: tear it down occassionally and start agin
[2012-03-28 16:36:09 -0400] sampikesley: make sure it all still flows
[2012-03-28 16:36:13 -0400] erratic: I saw something about vagrant, I'll check it out
[2012-03-28 16:36:18 -0400] sampikesley: it's awesome
[2012-03-28 16:38:45 -0400] erratic: huh cool
[2012-03-28 16:38:53 -0400] erratic: yeah I kinda dig this
[2012-03-28 16:39:26 -0400] erratic: yesterday I figured out the UFW recipe
[2012-03-28 16:39:35 -0400] erratic: well someone helped quite a bit
[2012-03-28 16:41:09 -0400] sampikesley: practice practice practice
[2012-03-28 16:41:21 -0400] hoover_damm: yep
[2012-03-28 16:41:23 -0400] hoover_damm: the more you do it
[2012-03-28 16:41:25 -0400] hoover_damm: the more you remember
[2012-03-28 16:41:27 -0400] hoover_damm: the more you learn
[2012-03-28 16:41:28 -0400] hoover_damm: the more you break
[2012-03-28 16:41:31 -0400] hoover_damm: the more you have fun
[2012-03-28 16:41:50 -0400] afallows: +1 'the more you break'
[2012-03-28 16:42:03 -0400] hoover_damm: well you also have to be willing to throw away your code
[2012-03-28 16:42:04 -0400] jchome: move fast and break things.
[2012-03-28 16:42:15 -0400] jchome: wait, s/fast//
[2012-03-28 16:42:17 -0400] hoover_damm: if your struggling on a cookbook and you finally get it to work, throw away your changes
[2012-03-28 16:42:18 -0400] btm: erratic: if you, or your howto, believe the next step is to run "apt-get install apache2" then put package "apache2" in the recipe and run it. Repeat until it works. Then kill the system and do run it from scratch. Then you've won.
[2012-03-28 16:42:20 -0400] hoover_damm: try again
[2012-03-28 16:42:37 -0400] hoover_damm: you'll find the 2nd approach to be a bit more refreshing sometimes
[2012-03-28 16:42:41 -0400] hoover_damm: and less painful
[2012-03-28 16:42:44 -0400] hoover_damm: you'll use what you learned
[2012-03-28 16:42:50 -0400] hoover_damm: (or you should)
[2012-03-28 16:43:56 -0400] sampikesley: eventually you'll realise that the answer is often 'stick it inna data bag'
[2012-03-28 16:46:56 -0400] sampikesley: and realise that idempotency is the most Zen thing in the world
[2012-03-28 16:50:30 -0400] erratic: btm :)
[2012-03-28 16:52:44 -0400] hoover_damm: sampikesley, I don't know if it's the most Zen thing in the world
[2012-03-28 16:52:49 -0400] btm: erratic: like all things where you only build a couple of small servers, there's probably ultimately more gained from the exercise than from the product.
[2012-03-28 16:52:51 -0400] hoover_damm: sampikesley, but pretty darn close, and pretty darn important
[2012-03-28 16:53:05 -0400] hoover_damm: sampikesley, every cookbook I write idempotency is one of the first things in mind
[2012-03-28 16:53:19 -0400] hoover_damm: setting it the first time is great, but that's only part of the job
[2012-03-28 16:53:39 -0400] hoover_damm: being able to run again and making sure it's up right, and not restarting it in error, etc etc
[2012-03-28 17:00:13 -0400] Anand: anand74.pem is that a valid name in chef??
[2012-03-28 17:08:02 -0400] dhruvbansal: Having trouble cloning a repo from github which itself has submodules which are also private.  Got advice here yesterday to just jam all the necessary keys into my invocation of 'ssh' in the script I name with the GIT_SSH env variable but I'm seeing weird behavior with this approach: multiple '-i' arguments to 'ssh' cause the Repository to not be found!
[2012-03-28 17:08:43 -0400] AntonZ: hey guys, can someone please have a look and possibly give me a tip why this portition of the code does not do what i want it to do, if i run the sequence commands manually, they work and do what i need them to do, chef run completes sucesfully, unfortunately, at the end i dont get what i want for whatever reason - https://gist.github.com/1895560
[2012-03-28 17:14:58 -0400] btm: AntonZ: it really isn't clear what you're asking with that gist. there's an offline conversation going on in the comments.
[2012-03-28 17:15:54 -0400] mconigliaro: jtimberman: any idea why some of my machines have init scripts and others have upstart scripts? this is the same version of chef on both
[2012-03-28 17:16:04 -0400] mconigliaro: ubuntu packages
[2012-03-28 17:16:59 -0400] AntonZ: dont look at the comments, those were for other issue, i reused the gist :)
[2012-03-28 17:17:32 -0400] AntonZ: for some reason when checf run finishes, i cna see that export command wasnt ran/or set, sed -e "s*JENKINS_HOME=\"/var/lib/jenkins\"*JENKINS_HOME=\"/srv/jenkins\"*g" -i /etc/sysconfig/jenkins - wasnt ran or sat
[2012-03-28 17:17:55 -0400] AntonZ: however chef reports that it sucessfully rna the script
[2012-03-28 17:19:27 -0400] AntonZ: here is new gist with no comments https://gist.github.com/2228374 :)
[2012-03-28 17:20:58 -0400] AntonZ: how can i get more info/logging from the script portion of the code?
[2012-03-28 17:21:04 -0400] AntonZ: chef reports only success or failure
[2012-03-28 17:21:06 -0400] btm: mconigliaro: installed from the same versions of a debian package or a gem?
[2012-03-28 17:21:23 -0400] mconigliaro: i dont think i ever installed from gems
[2012-03-28 17:30:05 -0400] mconigliaro: btm: weird. reinstalling fixed it
[2012-03-28 17:30:47 -0400] mconigliaro: oh wait, no it didnt...
[2012-03-28 17:32:53 -0400] Rorgo: Does anyone know if 'knife ec2' is compatible with VPC?
[2012-03-28 17:34:01 -0400] SteeleNivenson: node[:fqdn] is the output of `hostname --fqdn` right?
[2012-03-28 17:34:31 -0400] brett_h: does chef not 'notice' when you change the recipe list of a role that's nested among a node roles?  nodeA -> role foo. foo contains role bar, I changed bar and it's not applying the changes on nodeA when I run chef-client
[2012-03-28 17:35:43 -0400] btm: SteeleNivenson: Yes, on linux.
[2012-03-28 17:36:03 -0400] SteeleNivenson: thanks.
[2012-03-28 17:47:14 -0400] jbz: ohai chefs
[2012-03-28 17:48:08 -0400] jbz: Long shot related topic question.  Does anyone have any knowledge of/experience with a monitoring system that can be handed cucumber tests to test remote websites?
[2012-03-28 17:52:20 -0400] AntonZ: does anyone see anything wrongwith this code: https://gist.github.com/2228374 - for some reason chef says it ran it OK, hwoever, i dont see expected effect
[2012-03-28 17:54:17 -0400] AntonZ: can i not have more than one bash command within that block ?
[2012-03-28 17:54:35 -0400] |shad0w|: your *'s might be getting eval'd
[2012-03-28 17:54:42 -0400] |shad0w|: use # for your sed seperators
[2012-03-28 17:55:41 -0400] AntonZ: mind showing how do you mean ?
[2012-03-28 17:56:07 -0400] |shad0w|: change your s*foo*bar*g to s#foo#bar#g
[2012-03-28 17:56:15 -0400] |shad0w|: quoting might be an issue too
[2012-03-28 17:56:16 -0400] AntonZ: let me try
[2012-03-28 17:56:28 -0400] |shad0w|: what if you run chef-client with -l debug and see what command it is actually sending
[2012-03-28 17:57:12 -0400] AntonZ: we use hosted chef solution (not by opscode), i cant do that... or not tried yet at elast
[2012-03-28 17:57:29 -0400] AntonZ: i know if i ran my sed command manually it worked just fine
[2012-03-28 17:59:21 -0400] AntonZ: i thought chef doesnt care about what's within bash code
[2012-03-28 18:00:44 -0400] jtimberman: mconigliaro: what do you mean init vs upstart scripts?
[2012-03-28 18:00:53 -0400] jtimberman: for chef services?
[2012-03-28 18:01:00 -0400] mconigliaro: well, reinstalling fixed it, but that was weird
[2012-03-28 18:01:02 -0400] mconigliaro: yeah
[2012-03-28 18:01:26 -0400] mconigliaro: one machine had an upstart script, the rest had an init script
[2012-03-28 18:01:30 -0400] mconigliaro: not sure what that was all about
[2012-03-28 18:03:56 -0400] Hush: anyone got a minute to answer a quick question?  I'm trying to add a role to multiple new nodes, with a command like:   knife exec -E 'n=search(:node, "name:foobar").first; n.run_list = Chef::RunList.new("role[base]"); n.save'
[2012-03-28 18:04:21 -0400] Hush: unfortunately as the command implies its only getting the first node it finds
[2012-03-28 18:04:37 -0400] Hush: instead of say all of them
[2012-03-28 18:05:55 -0400] Hush: I've tried changing "name=*" but it only grabs the first one
[2012-03-28 18:06:25 -0400] |shad0w|: .first is limiting it to the first result in the array
[2012-03-28 18:06:46 -0400] Hush: right, I've tried .all .last etc
[2012-03-28 18:07:00 -0400] Hush: can't figure out what should go there or find any documentation referencing it
[2012-03-28 18:07:46 -0400] |shad0w|: you want a .each do loop
[2012-03-28 18:12:29 -0400] |shad0w|: Hush, keep it in chan
[2012-03-28 18:12:30 -0400] |shad0w|: knife exec -E 'search(:node, "name:*").each do |node|; puts node.name;end'
[2012-03-28 18:13:26 -0400] |shad0w|: since search() is returning an array of nodes we can call .each and assign it to node with |node|, then act on it in a block
[2012-03-28 18:13:58 -0400] |shad0w|: btw, I don't think you are adding that role, you are replacing the entire runlist with that role
[2012-03-28 18:14:04 -0400] |shad0w|: could be wrong though
[2012-03-28 18:14:12 -0400] |shad0w|: not sure how RunList.new operates
[2012-03-28 18:15:08 -0400] Hush: great I'll play with it and see what I come up with
[2012-03-28 18:15:24 -0400] Hush: thanks!
[2012-03-28 18:15:41 -0400] |shad0w|: np
[2012-03-28 18:22:39 -0400] AntonZ: is there an alternative to sed command, for some reason it doesnt work for me... chef run just fails on it
[2012-03-28 18:23:31 -0400] |shad0w|: try sed -i -e 's#JENKINS_HOME="/var/lib/jenkins"#JENKINS_HOME="/srv/jenkins"#g' /etc/sysconfig/jenkins
[2012-03-28 18:24:30 -0400] AntonZ: let me try that, the fact that when i run it manually it works, and when chef runs it - it just not run, or who knows what happens
[2012-03-28 18:24:43 -0400] |shad0w|: it was likely the quoting
[2012-03-28 18:25:03 -0400] |shad0w|: you really might want
[2012-03-28 18:25:13 -0400] |shad0w|: try sed -i -e 's#JENKINS_HOME=.*#JENKINS_HOME="/srv/jenkins"#g' /etc/sysconfig/jenkins
[2012-03-28 18:27:10 -0400] AntonZ: so should i try your firt verison or second :) ?
[2012-03-28 18:27:30 -0400] AntonZ: im going to try sed -i -e 's#JENKINS_HOME=.*#JENKINS_HOME="/srv/jenkins"#g' /etc/sysconfig/jenkins
[2012-03-28 18:30:35 -0400] vju: newb question: how often does chef client run on a node? is it just once or does it run periodically?
[2012-03-28 18:31:06 -0400] afallows: vju: by default, it should only run when you run it. You can easily make it run automatically with cron or other tricks
[2012-03-28 18:31:07 -0400] |shad0w|: that depends on if you start it as a daemon or not
[2012-03-28 18:31:11 -0400] afallows: ^
[2012-03-28 18:31:13 -0400] |shad0w|: and the interval is configurable
[2012-03-28 18:32:21 -0400] vju: so for example lets say I have a mysql recipe for a node, and I run chef client multiple times. the first run will install it but does the second time just ignore the fact that it is already installed?
[2012-03-28 18:32:36 -0400] miah: ywa
[2012-03-28 18:32:41 -0400] miah: yes, the second time would do nothing
[2012-03-28 18:33:00 -0400] miah: if its running as a daemon, it runs every 30 minutes by default
[2012-03-28 18:33:06 -0400] vju: ah ok
[2012-03-28 18:33:17 -0400] miah: but if your cookbooks are properly idempotent, then it can execute multiple times without worry
[2012-03-28 18:34:22 -0400] vju: so is verifying it already ran handled in the recipe or does chef track that and just not run it again?
[2012-03-28 18:36:57 -0400] AntonZ: shadow - your sed suggestion worked! - Thank you much!
[2012-03-28 18:36:59 -0400] miah: convergence?
[2012-03-28 18:37:00 -0400] bawt: convergence is http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-03-28 18:37:04 -0400] miah: ^- vju
[2012-03-28 18:37:07 -0400] |shad0w|: np AntonZ
[2012-03-28 18:37:37 -0400] vju: yeah I just read over that, perhaps I missed something
[2012-03-28 18:43:27 -0400] newb: I am trying out chef on VirtualBox VMs and currently allocating 2GB RAM to each VM. Considering I won't work with more than 4 - 5 nodes at a time, how much (minimum) virtual RAM could I get away with to each VM, and the VM hosting the chef server?
[2012-03-28 18:43:34 -0400] newb: For example, if I shrunk the virtual RAM allocated to the chef server from 2GB (currently) to 512MB, would it start behaving in an undefined manner? Or could I expect it to handle the sudden loss of RAM in a graceful manner and continue to operate properly (provision 4 - 5 nodes at a time with full search functionality)
[2012-03-28 19:10:58 -0400] geekbri: Can you access node attributes from inside of a LWRP?
[2012-03-28 19:18:20 -0400] withnale: hello. how do I create my certificates when setting up my own chef server?
[2012-03-28 19:22:04 -0400] miah: i usually run my node vm's with around 512mb of ram and use chef-solo
[2012-03-28 19:24:01 -0400] newb: thanks miah, could I then assume that it's safe to allocate 512mb of ram to chef nodes that will behave like chef clients? (I am worried about searches from the clients returning node objects from a chef server that's 300MB+ in size)
[2012-03-28 19:24:24 -0400] miah: its possible
[2012-03-28 19:24:45 -0400] miah: like i said, i use chef-solo for dev. and then move things into my testing environment
[2012-03-28 19:24:56 -0400] miketheman: anyone using the `deploy_revision` resource with a git_ssh_wrapper that might be able to walk me through something?
[2012-03-28 19:25:02 -0400] newb: any ideas how low a chef server's RAM could go to?
[2012-03-28 19:25:12 -0400] cwj: miketheman: whats up
[2012-03-28 19:25:37 -0400] miketheman: cwj: when using the `deploy` aka timestamped method, git_ssh_wrapper seems to work just fine.
[2012-03-28 19:25:53 -0400] miketheman: cwj: when using deploy_revision, I don't know if it's actually using the git_ssh_wrapper
[2012-03-28 19:26:00 -0400] miketheman: and fails.
[2012-03-28 19:26:51 -0400] afallows: I want to write a recipe which, among other things, modifies git's global config. I don't see anything about config in the wiki things about git - what would be the best chef-y way to do this?
[2012-03-28 19:27:17 -0400] cwj: miketheman: have you tried running chef-client/solo with '-l debug' so you can see whether or not its trying to execute your wrapper script?
[2012-03-28 19:27:30 -0400] afallows: (By 'chef-y' I mean that I know I can use an execute block, but want to know if there's a cleaner way)
[2012-03-28 19:27:39 -0400] cwj: it will produce an incredible volume of output, but you will see everything chef is doing
[2012-03-28 19:27:49 -0400] miketheman: Aha.
[2012-03-28 19:28:40 -0400] miketheman: well, I don't see it creating a GIT_SSH variable before the execution
[2012-03-28 19:28:52 -0400] |shad0w|: afallows, template the file out?
[2012-03-28 19:30:18 -0400] jordan_c: Is it possible modify values in an existing config file without using a template?
[2012-03-28 19:30:33 -0400] cwj: miketheman: if you gist your deploy_resource, i will take a look. maybe something you've overlooked
[2012-03-28 19:30:45 -0400] miketheman: ok, will do
[2012-03-28 19:31:11 -0400] cwj: jordan_c: you could use an execute resource to run some sed/awk horror against a file
[2012-03-28 19:31:22 -0400] cwj: but using a template is probably a lot cleaner
[2012-03-28 19:31:50 -0400] jordan_c: I was afraid that was it - I was just mildly concerned about existing values that may be different on different nodes
[2012-03-28 19:31:51 -0400] cwj: i think someone published a lwrp that makes it possible to insert lines into files but i don't remember who
[2012-03-28 19:32:04 -0400] afallows: |shad0w|: Well, I should have thought of that. I've used 'git config' commands a lot lately, somehow forgot that I could just manipulate the file.
[2012-03-28 19:32:17 -0400] cwj: jordan_c: you can guard a template resource with a not_if { File.exists?('/foo/bar') }
[2012-03-28 19:32:28 -0400] cwj: so it won't template over the existing file
[2012-03-28 19:32:42 -0400] cwj: but new nodes will get one built from the template
[2012-03-28 19:32:49 -0400] miketheman: cwj: http://pastebin.com/JtbBFCnX
[2012-03-28 19:33:32 -0400] jordan_c: hmm, the issue now comes from when I would have to replace an old value with a new value but retain other lines in the config, thus bringing me back to sed/awk horror...
[2012-03-28 19:35:12 -0400] miketheman: cwj: using deploy vs deploy_revision seems to "just work"
[2012-03-28 19:35:42 -0400] miketheman: from the debug lines that are being executed, everything looks the same
[2012-03-28 19:35:58 -0400] cwj: miketheman: i am looking through the relevant provider code right now, i dont think that it is different between 'deploy_revision' and 'deploy'
[2012-03-28 19:38:17 -0400] cwj: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/git.rb
[2012-03-28 19:39:01 -0400] cwj: is it possible your chef-client(?) isn't running the version of the recipe you think it is running?
[2012-03-28 19:39:33 -0400] miketheman: well, it's chef-solo on a vm, so there's not much other possibiles
[2012-03-28 19:40:13 -0400] cwj: ok
[2012-03-28 19:44:59 -0400] cwj: your working deploy resource is using the same paths? something about deploy_revision "#{node['myapp']['dir']}" do and   ssh_wrapper "#{node['myapp']['dir']}/shared/mydeployuser-deploy-ssh-wrapper"
[2012-03-28 19:45:00 -0400] cwj:  doesn't seem quite right to me
[2012-03-28 19:45:17 -0400] cwj: i guess it should work
[2012-03-28 19:45:41 -0400] miketheman: yeah, all I'm changing is removing the "_revision" and rerunning, it all works
[2012-03-28 19:49:13 -0400] afallows: What might cause a node to timeout attempting to register a new client.pem? I just registered my workstation on a new server without any issues, but when I tried to do the same with another machine, it hung and timed out.
[2012-03-28 19:49:16 -0400] cwj: weird. i am using timestamped deploy, but from what i can tell looking over the underlying code, there shouldn't be a difference
[2012-03-28 19:49:50 -0400] miketheman: cwj: does your chef-client run on an interval?
[2012-03-28 19:50:51 -0400] mhalligan: can you nest a role into a run_list definition inside of a different role?
[2012-03-28 19:51:23 -0400] cwj: miketheman: no i use knife to kick off chef runs as needed
[2012-03-28 19:51:28 -0400] cwj: mhalligan: yes
[2012-03-28 19:52:00 -0400] miketheman: cwj: aha, that's why the timestamped would work well for you. in my scenario, I'd be redeploying the same exact code and restarting the app every 30 minutes.
[2012-03-28 19:52:36 -0400] cwj: miketheman: well i also use a not_if { File.exists?('/foo/bar.lock') } to block deploys
[2012-03-28 19:52:50 -0400] cwj: wrote a script to handle deleting lock files and kicking off chef
[2012-03-28 19:52:59 -0400] miketheman: cwj: ahahahah. nice
[2012-03-28 19:53:16 -0400] mhalligan: cwj: hrm thanks I must have something else going on that's dumb then
[2012-03-28 19:53:21 -0400] mhalligan: (as usual)
[2012-03-28 19:53:31 -0400] cwj: as there are different parts of the system i might want to deploy separately from one another (e.g. assets from a repo need to update, code needs to stay the same)
[2012-03-28 19:55:30 -0400] erratic: I have a question
[2012-03-28 19:55:50 -0400] erratic: https://github.com/cookbooks/php/blob/master/templates/ubuntu/php.ini.erb
[2012-03-28 19:55:57 -0400] erratic: wait maybe I should google some more
[2012-03-28 19:59:10 -0400] erratic: erb is neat
[2012-03-28 20:02:30 -0400] mhalligan: how would I  begin to chase down the  cause of a chef client to no longer be able to authenticate on a client key which had previously been working?
[2012-03-28 20:03:03 -0400] jbz: mhalligan: Is this a node client?
[2012-03-28 20:03:03 -0400] erratic: are you sure its the key because I noticed one of my lamp servers stopped sync'ing this morning and I donno why
[2012-03-28 20:03:19 -0400] mhalligan: I guess I could read the debugging  auth problems
[2012-03-28 20:03:32 -0400] mhalligan: jbz: I'm not quite sure what you mean by a "node client" ?
[2012-03-28 20:03:58 -0400] jbz: mhalligan: Is this a client created by a node registering, or is it a human user client?
[2012-03-28 20:04:14 -0400] mhalligan: jbz: ah it's a node client
[2012-03-28 20:04:30 -0400] jbz: OK, is there any reason you can't nuke the node and client and have the node reregister?
[2012-03-28 20:04:44 -0400] jbz: (nuke the node and client on the Chef server, that is)
[2012-03-28 20:04:57 -0400] mhalligan: well the client is the chef-server
[2012-03-28 20:05:10 -0400] jbz: ah hahaha that would be an issue, yes.
[2012-03-28 20:05:24 -0400] mhalligan: :) I have half the problem figured out
[2012-03-28 20:05:53 -0400] mhalligan: if I run chef-client -N hostname it works
[2012-03-28 20:06:23 -0400] btm: mhalligan: using your user client and knife, you can still delete the client and node objects of the chef server, then delete /etc/chef/client.pem on the chef server; provided /etc/chef/validation.pem is still correct another chef-client run will create a new client and node object.
[2012-03-28 20:06:23 -0400] atomic-penguin: check the output of 'hostname -f', and ensure it matches the node name
[2012-03-28 20:07:03 -0400] mhalligan: ah it doesn't because I fixed /etc/hosts (rackspace's ubuntu images for some reason provision /etc/hosts with ipaddr hostname instead of ipaddr fqdn hostname
[2012-03-28 20:07:29 -0400] btm: mhalligan: you can set 'node_name "hostname"' in /etc/chef/client.rb
[2012-03-28 20:07:46 -0400] btm: mhalligan: replace hostname with whatever works. ;)
[2012-03-28 20:07:58 -0400] mhalligan: :) thanks
[2012-03-28 20:08:23 -0400] mhalligan: but how to make that change in client.rb permanent?
[2012-03-28 20:08:57 -0400] mhalligan: is client.rb generated during chef-client runs?
[2012-03-28 20:09:40 -0400] btm: mhalligan: it is a fixed configuration file. it won't change on you (unless you change it on yourself...)
[2012-03-28 20:09:59 -0400] mhalligan: btm: but I might want to deploy a new chef server at some point
[2012-03-28 20:10:25 -0400] mhalligan: realizing that there were a metric butt-load of manual steps to get the chef-server going
[2012-03-28 20:10:25 -0400] erratic: mhalligan paigeat@paigeat.info if you need help with that I don't mind
[2012-03-28 20:11:08 -0400] btm: mhalligan: depending on how you build your new server, there might be a step where you replace /etc/chef/client.rb but a chef-client run doesn't have any magic that changes that file.
[2012-03-28 20:11:54 -0400] jkyle: how can I use shef to set a breakpoint within a cookbook's recipe, then run the client's run_list...breaking at that line? This isn't clear to me from the wiki
[2012-03-28 20:12:37 -0400] mhalligan: btm: ah ok well I'll just start working on a cookbook to bootstrap chef-server
[2012-03-28 20:12:45 -0400] mhalligan: erratic: thanks!
[2012-03-28 20:12:55 -0400] btm: mhalligan: http://ckbk.it/chef-server
[2012-03-28 20:13:08 -0400] mhalligan: thanks!
[2012-03-28 20:19:38 -0400] jkyle: my problem is I do an include_recipe "foo:default" which I assume should run the default script at the insertion point, but it doesn't seem to do so.
[2012-03-28 20:20:04 -0400] jkyle: I'd like to step through the code to see what it is, in fact, doing
[2012-03-28 20:30:07 -0400] miketheman: cwj: seems like I had a permissions problem on my private key. this seems to be wrong, since the two methods _should_ act the same
[2012-03-28 20:31:00 -0400] cwj: oh weird
[2012-03-28 20:34:01 -0400] geekbri: Is there a generic Chef::Exceptions:: I can raise?
[2012-03-28 20:38:49 -0400] withnale: how can I set up chef to learn the config of a load balancer dynamically from chef runs on apache servers?
[2012-03-28 20:39:30 -0400] withnale: is there any mechanism for one chef run to leave some breadcrumbs for another chef run?
[2012-03-28 20:39:37 -0400] withnale: (on a different machine)
[2012-03-28 20:39:37 -0400] CharlieSu: Whenever I run the chef-client w/ the -j option manually on the command line it looks like it replaces the runlist.  Is that the intended behavior?  What I mean is that the next time I run chef-client it doesn't have the original runlist.  It has the one in the json file...
[2012-03-28 20:40:38 -0400] jdeamattson: This AM, a recipe that was running without issue previously started crashing with a Segmentation fault in yum.rb:
[2012-03-28 20:40:44 -0400] jdeamattson: ec2-50-16-89-107.compute-1.amazonaws.com /usr/lib64/ruby/gems/1.8/gems/chef-0.10.8/bin/../lib/chef/provider/package/yum.rb:412: [BUG] Segmentation fault
[2012-03-28 20:40:44 -0400] jdeamattson: ec2-50-16-89-107.compute-1.amazonaws.com ruby 1.8.7 (2011-12-28 patchlevel 357) [x86_64-linux]
[2012-03-28 20:40:55 -0400] cwj: withnale: i would recommend that you look at data bags. you can have nodes write information to a data bag and let other nodes read that information out in a subsequent run
[2012-03-28 20:41:02 -0400] shadoi1: CharlieSu: yes, intended.
[2012-03-28 20:41:13 -0400] jdeamattson: Any thoughts on how to narrow this down? The chef failed run is not being generated...
[2012-03-28 20:41:28 -0400] withnale: cwj: I thought it wasn't recommended for nodes to write to data bags?
[2012-03-28 20:41:29 -0400] CharlieSu: shadoi1: how can i run a seperate run_list in a one-off then?
[2012-03-28 20:42:03 -0400] shadoi1: CharlieSu: make the json be dynamically generated by your webapp, or script.
[2012-03-28 20:42:14 -0400] CharlieSu: humm?
[2012-03-28 20:42:56 -0400] cwj: withnale: i think the reasoning behind that is that at this time chef server only allows admin clients to modify data bags, but, assuming that you cant accomplish what you need using search, thats probably as close as you are going to get to 'breadcrumbs'
[2012-03-28 20:43:56 -0400] withnale: so it no longer requires admin?
[2012-03-28 20:45:30 -0400] withnale: one other question and I'll shut up again... q. is it possible to get a list of a nodes attributes at the cli with knife?
[2012-03-28 20:45:34 -0400] shadoi: CharlieSu: ruby -r json -e 'h = JSON.parse(open("file.json").read); h["run_list"] = "role[blah]"; File.new("newfile.json","w+").write h.to_json'
[2012-03-28 20:45:43 -0400] cwj: withnale: no, as far as i know that is still a limitation
[2012-03-28 20:45:57 -0400] cwj: knife node show foo -a
[2012-03-28 20:46:01 -0400] cwj: will show all the attributes of a node
[2012-03-28 20:46:11 -0400] cwj: -Fj if you want them in json
[2012-03-28 20:48:15 -0400] withnale: so to get all I put '-a .' ?
[2012-03-28 20:52:00 -0400] erratic: I have a question
[2012-03-28 20:52:07 -0400] erratic: when  a chef-client stops sync'ing
[2012-03-28 20:52:13 -0400] erratic: how should I treat it
[2012-03-28 20:57:51 -0400] withnale: can you specify a default node, or must they all be specified upfront?
[2012-03-28 21:00:54 -0400] CharlieSu: shadoi: thanks bud..  good idea!
[2012-03-28 21:01:26 -0400] cwj: withnale: with 'knife node show' you need to specify the node
[2012-03-28 21:01:47 -0400] shadoi: CharlieSu: I dunno about good, but it works.  :)
[2012-03-28 21:02:16 -0400] cwj: with 'knife search node' you provide a search query and -a attributename will show you the value(s) for attributename on all matching nodes
[2012-03-28 21:02:36 -0400] withnale: cwj: different question. I was asking whether you could specify a default node to match against, rather than have to use knife node create first.
[2012-03-28 21:07:00 -0400] miketheman: @opscode community wiki source code viewer: when double-clicking to copy/paste, you instert all sorts of weird chars in whitespace.
[2012-03-28 21:07:17 -0400] miketheman: don't do that.
[2012-03-28 21:08:06 -0400] erratic: I have a question, whats up with this validation.pem file allowing clients to register as nodes
[2012-03-28 21:08:26 -0400] erratic: what if a node got hacked and some dickhead decided to post a bunch of random nodes with a script or something
[2012-03-28 21:08:32 -0400] erratic: to try and dos my chef server
[2012-03-28 21:09:36 -0400] miketheman: https://github.com/opscode-cookbooks/chef-client/blob/master/recipes/delete_validation.rb
[2012-03-28 21:09:44 -0400] miketheman: erratic: that's for you.
[2012-03-28 21:11:15 -0400] erratic: ahah
[2012-03-28 21:11:18 -0400] erratic: thank you
[2012-03-28 21:15:47 -0400] erratic: btw I figured out a way to push the php.ini config that I want to all of my lamp servers, I just edited the erb template in the php cookbook and uploaded it and assigned it the runlist of my root lamp role
[2012-03-28 21:17:13 -0400] hoover_damm: do folks in here use an iptables cookbook that is built off of a databag or node attributes? and if so where?
[2012-03-28 21:17:17 -0400] hoover_damm: thanks
[2012-03-28 21:17:31 -0400] erratic: hoover_damm ooo
[2012-03-28 21:17:39 -0400] erratic: I don't know but that sounds nice
[2012-03-28 21:17:52 -0400] erratic: wait are you the one that helped me with the ufw one yesterday?
[2012-03-28 21:19:22 -0400] hoover_damm: nope
[2012-03-28 21:19:29 -0400] hoover_damm: I was looking at the firewall cookbook and groaning
[2012-03-28 21:19:52 -0400] hoover_damm: currently we use the iptables cookbook and well they have a bad pattern i'd rather not utter.
[2012-03-28 21:20:02 -0400] hoover_damm: not that it's really bad at all
[2012-03-28 21:20:17 -0400] hoover_damm: it's just I think itshould be stored in on the node, or have a node attribute point to a databag
[2012-03-28 21:20:35 -0400] hoover_damm: so that way you can just load the recipe, set the configuration in node attribute / data_bag...
[2012-03-28 21:35:09 -0400] LawrenceSeattle: after I launch an ec2, how do I query for the instance ID by name so I can shut it down?
[2012-03-28 21:42:39 -0400] pcn: If chef ran, then you can look at the chef server's attributes for the node.  Otherwise, you should be able to use the standard ec2 utils, e.g. ec2-describe-instances and ec2-terminate-instances
[2012-03-28 21:42:41 -0400] pcn: Or the console
[2012-03-28 21:47:52 -0400] jkyle: ok, tried to start a debugger ina  recipe to test it. require "debug", but it looks like the chef environment doesn't work with the debugger, when I try to print lines like: list 15-25 # print lines 15-25, I get No sourcefile available for /etc/chef/ohai_plugins/ipmi.rb
[2012-03-28 21:48:12 -0400] jkyle: but, the file does in fact exist
[2012-03-28 21:49:45 -0400] rayrod2030: Greetings
[2012-03-28 21:51:17 -0400] rayrod2030: At my job we have a relatively big ecommerce client who we put on rightscale early one as a right scale partner with the low introductory pricing.  We know know that righscale is going to change their pricing to match usage uptime much like ec2.  This cost has caused sticker shock to our client and they want alternatives to right scale.  What are some recommended ways to do right scale light type of things using chef and ec2?
[2012-03-28 21:51:35 -0400] rayrod2030: basically what's an easy way to mimic the autoscaling features of right scale without the hight cost?
[2012-03-28 21:56:29 -0400] erratic: god I wish I learned ruby instead of python...
[2012-03-28 21:57:18 -0400] jkyle: erratic: why's that? learn both.
[2012-03-28 21:58:54 -0400] jkyle: ruby's a better fit in some areas, but python's better in others
[2012-03-28 21:59:29 -0400] LawrenceSeattle: pcn: thanks... got it working
[2012-03-28 21:59:42 -0400] withnale: is it possible to add a role from inside a recipe?
[2012-03-28 21:59:44 -0400] LawrenceSeattle: python is a good language
[2012-03-28 22:00:17 -0400] erratic: I wanna modify this recipe in apache to copy a file to a client's directory..
[2012-03-28 22:00:22 -0400] erratic: pure and simple and I can't figure it out
[2012-03-28 22:00:25 -0400] erratic: lol
[2012-03-28 22:00:30 -0400] jkyle: I learned ruby first, than python. I personal prefer python, but ruby's alright
[2012-03-28 22:01:51 -0400] erratic: I never need to use python for anything
[2012-03-28 22:02:26 -0400] mjreed: OK, I'm trying to install a file with cookbook_file; if I download the cookbook, it's there and intact, but when I run the recipe, I only get part of the file downloaded.  ideas?
[2012-03-28 22:17:25 -0400] gmcinnes: guys, is it possible to get any insight as to why a newly bootstrapped node won't validate?  It's generating a client.pem file but gets 401 Unauthorized when it tries to register
[2012-03-28 22:22:10 -0400] gmcinnes: strangely, it creates the client no problem, then fails on the next step
[2012-03-28 22:28:50 -0400] LawrenceSeattle: when I tear down a host, the chef server likes to keep the metadata around.  And then I try to boot it again under the same name and it fails. (This is EC2) Is there a purge command that will clean out the client/node or am I just doing this wrong?  I'm using -p on ec2 delete server already
[2012-03-28 22:30:40 -0400] ErraticSeattle: la la la
[2012-03-28 22:31:19 -0400] ErraticSeattle: when you're tearing down the host, you mean you're just throwing away the chef client and not actually delete the node data with knife or the webui?
[2012-03-28 22:32:56 -0400] ErraticSeattle: I can't decide if I want to go to a bookstore today and sit around and read books about chef (are there any)
[2012-03-28 22:32:59 -0400] Aengus: LawrenceSeattle:  you need to delete the client and node info. knife client delete <foog>
[2012-03-28 22:33:08 -0400] ErraticSeattle: or go to the hadoop meetup in slu @ amazon
[2012-03-28 22:33:23 -0400] LawrenceSeattle: I'm killing the ec2 instance with ec2 server delete
[2012-03-28 22:33:31 -0400] ErraticSeattle: ah yeah, what Aengus said
[2012-03-28 22:33:33 -0400] ssd7: gmcinnes: Is this hosted chef?
[2012-03-28 22:33:35 -0400] LawrenceSeattle: Aengus: thanks
[2012-03-28 22:33:40 -0400] Aengus: LawrenceSeattle: Sure, but you still need to purge that information.
[2012-03-28 22:33:41 -0400] gmcinnes: ssd7:  yes
[2012-03-28 22:33:58 -0400] ssd7: gmcinnes: What is the node's name? (PM if you want)
[2012-03-28 22:34:19 -0400] ssd7: Or more specifically, what is the API client name it is trying to send requests as
[2012-03-28 22:34:28 -0400] ErraticSeattle: LawrenceSeattle maybe what you thought was that if a node doesn't check in for a certain amount of time that the metadata expires and is expunged ?
[2012-03-28 22:34:38 -0400] ErraticSeattle: maybe that's an option?
[2012-03-28 22:34:47 -0400] ErraticSeattle: doesn't seem like one I would want
[2012-03-28 22:35:05 -0400] LawrenceSeattle: Well I hoped the -p on ec2 delete would do the purge too... obviously not
[2012-03-28 22:35:13 -0400] Aengus: Nope, do no want ;)
[2012-03-28 22:36:21 -0400] gmcinnes: ssd7: its called: geoff
[2012-03-28 22:37:22 -0400] ssd7: LawrenceSeattle: A --purge option will be in the next version of knife-ec2
[2012-03-28 22:38:15 -0400] gmcinnes: ssd7: https://gist.github.com/b0861cc74f09edaeb98c
[2012-03-28 22:38:55 -0400] ssd7: gmcinnes: Unforunately, I think you have hit a rather annoying bug: http://tickets.opscode.com/browse/CHEF-2240
[2012-03-28 22:38:57 -0400] gmcinnes: The client gets created ok. I get the client.pem, and then the next stage should be to create the node based on that client, but it fails with that output
[2012-03-28 22:39:44 -0400] gmcinnes: ssd7: ah. bugger.
[2012-03-28 22:39:51 -0400] gmcinnes: I always forget to look at the tickets.
[2012-03-28 22:43:38 -0400] gmcinnes: ssd7: yeah. that's it. Thanks.
[2012-03-28 22:44:03 -0400] jkyle: ErraticSeattle: there aren't any that I know of...chef is pretty new
[2012-03-28 22:50:24 -0400] ErraticSeattle: there's like one test driven infrastructure with chef
[2012-03-28 22:50:36 -0400] ErraticSeattle: sounds kind of dumb
[2012-03-28 22:50:46 -0400] ErraticSeattle: I haven't really looked at it
[2012-03-28 22:51:15 -0400] ErraticSeattle: june 2011
[2012-03-28 22:51:37 -0400] ErraticSeattle: doesn't look like it talks about writing recipes or making cookbooks or any of that
[2012-03-28 22:51:43 -0400] ErraticSeattle: I suppose all of thats online though
[2012-03-28 22:51:57 -0400] ErraticSeattle: I don't know jack shit about ruby though I'm in the ruby channel trying to figure out the syntax
[2012-03-28 22:52:13 -0400] ErraticSeattle: I don't quite understand the :name construct yet or why its useful or how to use it
[2012-03-28 22:53:03 -0400] ErraticSeattle: symbol literal
[2012-03-28 22:53:48 -0400] ErraticSeattle: I feel like writing recipes and the likes requires some knowledge of what these things are and how to use them
[2012-03-28 22:56:27 -0400] ErraticSeattle: too bad its not monday I could go to the ruby meetup
[2012-03-28 22:56:45 -0400] ErraticSeattle: oh man that would've been perfect
[2012-03-28 22:57:55 -0400] ErraticSeattle: http://wiki.opscode.com/display/chef/Recipes
[2012-03-28 23:01:12 -0400] aslan: hi guys... This is one of my oldest bugs. The recipe sets up a rails app using passenger and apache. For some reason around 50% of the time at the first run the apache fails but on the next run it starts fine. So every time I start a server its kinda expected the server is not going to be ready for the next 30 min (my chef client intervals) this is the gist of the logs https://gist.github.com/2231317 any help is appricated
[2012-03-28 23:02:13 -0400] samkottler: aslan: the issue is that Apache is already running when Chef is trying to start the apache2 service
[2012-03-28 23:02:30 -0400] samkottler: (98)Address already in use: make_sock: could not bind to address 0.0.0.0:80 is the key line
[2012-03-28 23:02:46 -0400] ErraticSeattle: what he wants is restart or reload?
[2012-03-28 23:02:57 -0400] ErraticSeattle: I think there's actually a difference i cant remember
[2012-03-28 23:03:22 -0400] samkottler: aslan, ErraticSeattle: use restart, not reload
[2012-03-28 23:03:50 -0400] ErraticSeattle: reload just reloads the vhosts if they aren't problems doesn't it ?
[2012-03-28 23:03:51 -0400] aslan: samkottler: why should chef start the server so early. shouldn't all restarts be postponed and combined into one?
[2012-03-28 23:04:21 -0400] samkottler: aslan: the apache installation process starts the daemon, but chef doesn't know that
[2012-03-28 23:04:57 -0400] samkottler: aslan: so it issues a start instead of a restart
[2012-03-28 23:05:43 -0400] aslan: samkottler: if you look at line 3889 it says restart
[2012-03-28 23:06:37 -0400] samkottler: aslan: then something else is bound to port 80
[2012-03-28 23:06:44 -0400] samkottler: aslan: do you run apache and nginx on the same box?
[2012-03-28 23:07:04 -0400] aslan: samkottler: no i dont even load the nginx cookbook for this role
[2012-03-28 23:07:44 -0400] samkottler: I would recommend removing the apache cookbook from the runlist and then looking at what is bound to port 80
[2012-03-28 23:07:59 -0400] aslan: samkottler: i have learned that the recipe issues a restart every time a new apache mod is enabled/loaded
[2012-03-28 23:08:19 -0400] aslan: samkottler: could that be the issue
[2012-03-28 23:09:13 -0400] samkottler: aslan: yeah - it's really hard to debug the exact issue via IRC, but that's the trail I would chase
[2012-03-28 23:11:17 -0400] aslan: samkottler: is :delayed suppose to combine all of the restarts into one command?
[2012-03-28 23:21:31 -0400] j-v-e: Hello all
[2012-03-28 23:21:38 -0400] j-v-e: I'm trying to use a sorted hash in a template
[2012-03-28 23:21:45 -0400] j-v-e: something like that node[:ossec][:rules].keys.sort.each do |id,params|
[2012-03-28 23:22:18 -0400] j-v-e: but this doesn't work because using .keys only returns the value of the hash
[2012-03-28 23:22:24 -0400] j-v-e: s/value/key/
[2012-03-28 23:24:15 -0400] erratic: is package.rb like a special name for a recipe?
[2012-03-28 23:24:17 -0400] LawrenceSeattle: great the java::oracle recipe is broken
[2012-03-28 23:26:10 -0400] erratic: like does package.rb get run when your node subscribes to the base php recipe for example?
[2012-03-28 23:26:21 -0400] erratic: is it a magical file name or no?
[2012-03-28 23:28:04 -0400] aslan: erratic: i dont think so. the only file there is usually default.rb
[2012-03-28 23:28:51 -0400] aslan: erratic: but on the other hand i am still using chef 0.9 so maybe they added something special to 0.10
[2012-03-28 23:33:18 -0400] erratic: here's something kind of fun that just occured to me
[2012-03-28 23:33:31 -0400] erratic: I probably don't even need rsync to sync htdocs between my apache servers
[2012-03-28 23:33:38 -0400] erratic: I can probably do this with chef
[2012-03-28 23:33:43 -0400] erratic: though I wonder if thats a good idea
[2012-03-28 23:35:58 -0400] j-v-e: got it ! node[:ossec][:rules].sort_by{|k,v| k.to_i}.each do |id,params|
[2012-03-28 23:36:12 -0400] erratic: I thought about just using an nfs server but really there's seriously like maybe 41MB of htdocs.
[2012-03-28 23:37:12 -0400] erratic: also it's better for scalability this way
[2012-03-28 23:38:20 -0400] erratic: I definitely don't want to make all of my htdocs into templates,
[2012-03-28 23:38:40 -0400] erratic: like php erb lolz
[2012-03-28 23:39:14 -0400] erratic: though I wonder if anybody deploys rails or merb projects with some sort of erb templating in chef
[2012-03-28 23:39:22 -0400] aslan: erratic: i would make a cronjob to handle the sync
[2012-03-28 23:39:37 -0400] erratic: thats the current plan,
[2012-03-28 23:40:03 -0400] erratic: speaking of which
[2012-03-28 23:40:10 -0400] aslan: if it works dont touch it :D
[2012-03-28 23:40:35 -0400] erratic: https://github.com/emiddleton/cron-cookbook
[2012-03-28 23:43:02 -0400] aslan: erratic: http://wiki.opscode.com/display/chef/Resources#Resources-Cron
[2012-03-28 23:43:46 -0400] erratic: cool
[2012-03-28 23:51:46 -0400] erratic: I want to add something like this : http://pastie.org/private/qfgztgz1z79vfjfjnqxmba to this https://github.com/opscode-cookbooks/apache2/blob/master/recipes/mod_php5.rb
[2012-03-28 23:52:37 -0400] erratic: and like I really don't understand the variation beween like
[2012-03-28 23:52:42 -0400] erratic: #{node[:apache][:dir]
[2012-03-28 23:52:43 -0400] erratic: and
[2012-03-28 23:52:50 -0400] erratic: #{node['php']['conf_dir']
[2012-03-28 23:57:34 -0400] erratic: http://pastie.org/3688724
[2012-03-28 23:57:39 -0400] erratic: I'm guessing this will work.
