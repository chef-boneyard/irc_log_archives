[2012-03-08 08:11:00 -0500] segv: i always eff up my arrays/hashes
[2012-03-08 08:12:00 -0500] segv: say I want to save an address as the key in a data bag "ip": {blah1 => "blah1data", blah2 => "blah2data"}
[2012-03-08 08:12:00 -0500] segv: how do I construct that
[2012-03-08 08:13:00 -0500] maek: wow you can make data_bag_items in a recipe!
[2012-03-08 08:13:00 -0500] segv: i do db = data_bag_item("blah", "blah") then blah[n.network.blaheth0]['blah1'] = blah1data?
[2012-03-08 08:14:00 -0500] segv: ?
[2012-03-08 08:14:00 -0500] maek: sorry not helping, just didnt realize that. have only used them to read
[2012-03-08 08:15:00 -0500] segv: ah yeah
[2012-03-08 08:15:00 -0500] segv: just not sure how to construct the hash within the data bag
[2012-03-08 08:15:00 -0500] sjang1: Are people running chef on ruby 1.9.3?
[2012-03-08 08:15:00 -0500] sjang1: Any experience?
[2012-03-08 08:21:00 -0500] segv: sweet figured it out
[2012-03-08 08:22:00 -0500] maek: segv: what was the fix?
[2012-03-08 08:23:00 -0500] segv: use raw_data
[2012-03-08 08:23:00 -0500] segv: so constrcut the hash outside of the blah data bah
[2012-03-08 08:23:00 -0500] segv: bag*
[2012-03-08 08:23:00 -0500] segv: then blah.raw_data = blahhash
[2012-03-08 08:23:00 -0500] segv: then blah.save
[2012-03-08 08:28:00 -0500] alclonky: i there an easy way to edit some lines in a file without having the whole file as template?
[2012-03-08 08:32:00 -0500] maek: alclonky: ive used execute resource with sed but it was for 1 line and always felt hacky
[2012-03-08 08:32:00 -0500] maek: never was an actual problem, i think it just looked bad on paper
[2012-03-08 08:50:00 -0500] alclonky: but isn't it a common use case to add a line somewhere and to ensure it is there? don't really like the execute sed only_if grep combination
[2012-03-08 08:50:00 -0500] nico: alclonky: using something like augeas
[2012-03-08 08:50:00 -0500] nico: with the lens concept
[2012-03-08 08:50:00 -0500] nico: puppet uses this, but I personnaly don't like it
[2012-03-08 08:53:00 -0500] alclonky: it's just that i have a dirty feeling everytime i use a execute or bash script in chef
[2012-03-08 08:57:00 -0500] erikh: usually that's what ends up happening in the providers you use
[2012-03-08 08:58:00 -0500] erikh: I mean, there's great ways to over use any idiom, but use the right tool for the job, etc, etc
[2012-03-08 09:05:00 -0500] maek: nico: you have augeas working?
[2012-03-08 09:05:00 -0500] nico: maek: nope, never tried with chef btw
[2012-03-08 09:06:00 -0500] nico: must be easy to create a LWRP for it I think
[2012-03-08 10:20:00 -0500] matti: Hi workmad3
[2012-03-08 10:36:00 -0500] renchap: does knife search use only info from solr ?
[2012-03-08 10:53:00 -0500] renchap: Roles:       Basic, Postgresql_database
[2012-03-08 10:53:00 -0500] renchap: but the node does not appear in knife search node role:Postgresql_database
[2012-03-08 10:53:00 -0500] renchap: any ideas ?
[2012-03-08 10:53:00 -0500] renchap: solr indexation is running fine
[2012-03-08 10:54:00 -0500] superbaloo: there is sometimes a lag
[2012-03-08 10:55:00 -0500] renchap: no lag here
[2012-03-08 10:55:00 -0500] renchap: i changed other attributes, and can search them fine
[2012-03-08 10:56:00 -0500] superbaloo: search is case sensitive
[2012-03-08 10:56:00 -0500] superbaloo: are the role capitalized ?
[2012-03-08 10:57:00 -0500] renchap: yes
[2012-03-08 10:57:00 -0500] superbaloo: or is it a knife "look better" artefact ?
[2012-03-08 10:57:00 -0500] renchap: sooo
[2012-03-08 10:57:00 -0500] renchap: role:Postgresql_database does return 1 recipe
[2012-03-08 10:57:00 -0500] renchap: *1 node
[2012-03-08 10:57:00 -0500] renchap: roles:Postgresql_database all 3 nodes
[2012-03-08 10:58:00 -0500] renchap: but runlists are the same on all 3 nodes
[2012-03-08 10:58:00 -0500] renchap: and the doc says : "To find a node that includes a role in the top level of its run list, use a search of the form role:ROLE_NAME."
[2012-03-08 10:58:00 -0500] renchap: why do I only get one ? :/
[2012-03-08 10:58:00 -0500] laurent\: role vs roles
[2012-03-08 10:58:00 -0500] laurent\: oh nevermind
[2012-03-08 10:59:00 -0500] laurent\: weird ! :)
[2012-03-08 10:59:00 -0500] laurent\: a full moon thing i'd say
[2012-03-08 10:59:00 -0500] renchap: Run List:    role[Basic], role[Postgresql_database], recipe[sysctl::final]
[2012-03-08 10:59:00 -0500] renchap: on the one that appear in role:
[2012-03-08 10:59:00 -0500] renchap: and Run List:    role[Basic], role[Postgresql_database], recipe[sysctl::final] on the other
[2012-03-08 10:59:00 -0500] renchap: that... the same
[2012-03-08 11:02:00 -0500] superbaloo: renchap: have you tried re-run chef-client on the non-working nodes ?
[2012-03-08 11:02:00 -0500] renchap: yes
[2012-03-08 11:02:00 -0500] renchap: also reindexing
[2012-03-08 11:02:00 -0500] superbaloo: nothing in chef expander logs ?
[2012-03-08 11:02:00 -0500] renchap: nope
[2012-03-08 11:03:00 -0500] renchap: i think that indexation is fine
[2012-03-08 11:05:00 -0500] superbaloo: try put chef-server in debug mode
[2012-03-08 11:06:00 -0500] superbaloo: you should see  a "Pushing item to index queue for addition:" when pushing to rabbitmq
[2012-03-08 11:09:00 -0500] renchap: indexation is fine
[2012-03-08 11:09:00 -0500] renchap: is it a way to check what is stored inside solr ?
[2012-03-08 11:09:00 -0500] renchap: like, the value of all the fields
[2012-03-08 11:17:00 -0500] laurent\: renchap: have you checked in couchdb first ?
[2012-03-08 11:21:00 -0500] renchap: dope
[2012-03-08 11:22:00 -0500] renchap: i only see a "roles" attribute
[2012-03-08 11:22:00 -0500] renchap: no "role"
[2012-03-08 11:30:00 -0500] bluenemo: hi guys, i'm currently using plain usernames for like creating a directory. are there any examples how to use user id's instead?
[2012-03-08 11:41:00 -0500] zts: bluenemo: I'd have expected that to work if you just put a userid where you're currently putting a username.
[2012-03-08 11:41:00 -0500] zts: bluenemo: can you pastebin an example of what you're trying that isn't working?
[2012-03-08 11:42:00 -0500] bluenemo: well i'm just using the examples from the wiki for lets say directory "/foo/bar" do  and so on, where one line is user "foobar"  which i would like to have like user "1000" or so
[2012-03-08 11:42:00 -0500] bluenemo: however i tried that -> no user named 1000
[2012-03-08 11:43:00 -0500] zts: don't quote the number
[2012-03-08 11:43:00 -0500] zts: "user 1000"
[2012-03-08 11:43:00 -0500] zts: sorry, I think I confused matters there
[2012-03-08 11:43:00 -0500] zts: right:   user 1000
[2012-03-08 11:43:00 -0500] zts: wrong:  user "1000"
[2012-03-08 11:44:00 -0500] zts: in the latter case, it thinks your username is "1000" (which may or may not have a userid of 1000
[2012-03-08 11:46:00 -0500] laurent\: renchap: afaik there's no real node attribute, it's in the run_list, roles and recipes attributes are expanded and managed by the client
[2012-03-08 11:46:00 -0500] laurent\: s/node/role/
[2012-03-08 11:46:00 -0500] renchap: "roles" attribute is set by the chef-client
[2012-03-08 11:46:00 -0500] renchap: for sure
[2012-03-08 11:47:00 -0500] renchap: i dont know about role:
[2012-03-08 11:49:00 -0500] zts: renchap: when that has confused me in the past, it has been that I've had a deeper, nested attribute called "role" with the value I was searching for
[2012-03-08 11:49:00 -0500] zts: renchap: I think the application cookbook might do that, and some similar things (where you're saving the name of a role to search for within some recipe)
[2012-03-08 11:50:00 -0500] zts: There's probably a better way to track it down, but I usually end up with: knife node show $nodename -Fj | grep -C5 'role'
[2012-03-08 11:50:00 -0500] zts: and inspecting the output
[2012-03-08 12:07:00 -0500] bluenemo: zts ah ok cool i get it thank you!
[2012-03-08 12:12:00 -0500] zts: bluenemo: no problem :)
[2012-03-08 13:42:00 -0500] plu: is there some way to say: cookbook a, b, c, d, e, f depend on cookbook x, plus cookbook x *must* be executed, but ideally only once per chef-run?
[2012-03-08 13:45:00 -0500] bluenemo: hm, those dependencies can be configured in those metadata.rb files (or so)
[2012-03-08 13:45:00 -0500] zts: plu: two things - 1) cookbooks don't get run, recipes do.  2) a recipe will only be run once in a chef-run, the first time it's required
[2012-03-08 13:45:00 -0500] bluenemo: then you cant knife cookbook upload if the dependencies arent satisfied
[2012-03-08 13:48:00 -0500] plu: zts: so doing require_recipe 'x::something' n times will execute it only once?
[2012-03-08 13:48:00 -0500] zts: plu: correct.  When the run_list is expanded, the recipe will be there the first time it was include_recipe'd
[2012-03-08 13:49:00 -0500] zts: bluenemo's comment is also correct, and the extra piece there is that a dependency on a cookbook (in metadata.rb) ensures that the cookbook is loaded on the node, and that its libraries, definitions, and LWRPs are available for use in other cookbooks
[2012-03-08 13:50:00 -0500] zts: so if you need some functionality provided by another cookbook, but don't actually need to add its recipe to the run list, you might only need to update metadata.rb
[2012-03-08 13:51:00 -0500] zts: What sort of of things do you have in mind to put in your cookbook x, that the others will need?
[2012-03-08 13:55:00 -0500] plu: for instance an apt cookbook which adds something to sources.list or sources.list.d
[2012-03-08 13:57:00 -0500] zts: Okay - yeah, if you want an explicit dependency from each of your other recipes on that, then include_recipe "cookbookX::addsources" is the way to go
[2012-03-08 13:58:00 -0500] zts: however, you might want to consider whether explicit dependencies make sense for that.  We've ended up including our "manage repo sources" recipe in a role which is applied to the node early in the run list, and other recipes assume that the repos are setup correctly
[2012-03-08 13:59:00 -0500] zts: the reason we do that is so that the same recipe can be used in any environment (or outside our company) without being tied to the recipes we use to manage local repos/mirrors/etc
[2012-03-08 13:59:00 -0500] zts: (the down side is that if you fail to ensure that the repos are setup correctly, your recipe is going to fail when it can't find a package)
[2012-03-08 14:06:00 -0500] plu: ok
[2012-03-08 14:07:00 -0500] plu: mh, makes sense :)
[2012-03-08 14:08:00 -0500] plu: it's a tough decision though. But you're right, something like "apt needs to be up2date" is some essential thing
[2012-03-08 14:08:00 -0500] zuzur: hey guys, i'm having troubles with the mongodb cookbook not finding a replica set node right after it has been configured. I think it boils down to the following code: https://gist.github.com/2001122
[2012-03-08 14:09:00 -0500] zuzur: so whatever i try, i can't seem to find a way to retrieve the node i've just updated in the search
[2012-03-08 14:10:00 -0500] zuzur: is there a way to make absolutely sure the index is updated before running the search ?
[2012-03-08 14:20:00 -0500] geekbri: Is anybody here using fnichols rvm cookbook?  I'm having a hell of a time getting it to install a specific patch level version of ruby 1.9.2.
[2012-03-08 14:23:00 -0500] lflux_: how do I update a cookbook I pulled into my repo with 'knife cookbook site install'
[2012-03-08 14:23:00 -0500] lflux_: git is hard :/
[2012-03-08 14:25:00 -0500] geekbri: lflux_: Well if you update it inside the directory it was pulled into, when you try to git pull again if it has been updated in the officialk repository you will get a merge conflict
[2012-03-08 14:25:00 -0500] geekbri: lflux_: I personally use librarian-chef which is an awesome tool for when you want to pull cookbooks from different sources
[2012-03-08 14:26:00 -0500] geekbri: lflux_: in which case you could put the cookbook into your own git repository and have it pull that particularly cookbook from there while you send your changes upstream and wait for them to be accepted (or never send them if they aren't relevant)
[2012-03-08 14:26:00 -0500] geekbri: lflux_: https://github.com/applicationsonline/librarian
[2012-03-08 14:27:00 -0500] lflux_: yeah, I tend to edit the community cookbooks
[2012-03-08 14:27:00 -0500] dwhsix: geekbri: using rvm cookbook but just letting it default
[2012-03-08 14:28:00 -0500] dwhsix: my issue with it is that "sudo ruby" still uses system default (1.8)
[2012-03-08 14:28:00 -0500] lflux_: i'll take a look at librarian. in the meantime, how do I update the cookbooks I got via site install?
[2012-03-08 14:28:00 -0500] dwhsix: not a showstopper but worrisome
[2012-03-08 14:30:00 -0500] geekbri: lflux_: you can try just going into the cookbooks directory and doing a git pull, that will likely error if you have made changes though
[2012-03-08 14:31:00 -0500] geekbri: lflux_: how about knife cookbook site install <cookbook name> ?
[2012-03-08 14:33:00 -0500] lflux_: hmm, seems that the only remote I have configured is the remote for my git repo
[2012-03-08 14:33:00 -0500] geekbri: lflux_: id probably be more help if I hadn't switched to librarian a while ago :-P
[2012-03-08 14:34:00 -0500] lflux_: thanks anyway :)
[2012-03-08 14:36:00 -0500] lflux_: yeah knife cookbook site install updates.
[2012-03-08 14:37:00 -0500] geekbri: lflux_: won't that overwrite any changes you made?
[2012-03-08 14:37:00 -0500] lflux_: my changes were on master, not the vendor branch
[2012-03-08 15:02:00 -0500] proffalken: is there a quick and easy way to findout which environment I'm in as part of a recipe?
[2012-03-08 15:02:00 -0500] thom: node.chef_environment
[2012-03-08 15:03:00 -0500] proffalken: thom: Doh!
[2012-03-08 15:03:00 -0500] proffalken: thanks :)
[2012-03-08 15:03:00 -0500] hoover_damm: happy new cloud instances day!
[2012-03-08 15:03:00 -0500] hoover_damm: 64-bit c1.medium and m1.large's and m1.medium's 
[2012-03-08 15:06:00 -0500] hoover_damm: I just wish I read the last announcement right
[2012-03-08 15:06:00 -0500] proffalken: hoover_damm: ?
[2012-03-08 15:08:00 -0500] hoover_damm: proffalken, they said 'you don't need software now to connect to the console'
[2012-03-08 15:08:00 -0500] hoover_damm: I read that as you can connect to the console now without any additional software required... e.g. I was thinking real console
[2012-03-08 15:08:00 -0500] hoover_damm: nope nope, just some Java SSH Client to make life easier
[2012-03-08 15:09:00 -0500] bdha: bleh.
[2012-03-08 15:09:00 -0500] bdha: Worthless.
[2012-03-08 15:09:00 -0500] hoover_damm: exactly
[2012-03-08 15:09:00 -0500] bdha: "need software"
[2012-03-08 15:09:00 -0500] bdha: Like ssh?
[2012-03-08 15:09:00 -0500] hoover_damm: ssh isn't preinstalled? wth?
[2012-03-08 15:09:00 -0500] hoover_damm: I mean this isn't the dark ages
[2012-03-08 15:10:00 -0500] bdha: The lack of actual console on EC2 makes me nuts.
[2012-03-08 15:10:00 -0500] bdha: I wonder if it's a philosophical decision.
[2012-03-08 15:10:00 -0500] bdha: Like calling them "instances."
[2012-03-08 15:10:00 -0500] proffalken: hoover_damm: heh, that's ow I read it as well, I assumed it was some kind of Java-console connective over a tty
[2012-03-08 15:10:00 -0500] bdha: If you bung fstab or something, serial console is pretty damn handy.
[2012-03-08 15:11:00 -0500] Glacee: lol this is just a marketinb bullet point (the console thing)
[2012-03-08 15:11:00 -0500] bdha: (thanks, systemd, for taking one of the most annoying behaviors from ZFS...)
[2012-03-08 15:11:00 -0500] proffalken: bdha: +1 - an iLO console has saved my arse many times... :)
[2012-03-08 15:11:00 -0500] bdha: Aye.
[2012-03-08 15:12:00 -0500] proffalken: I'm still learning chef - is there a way of getting a list of all availble environments from a recipe?
[2012-03-08 15:12:00 -0500] proffalken: I can't find anything in the docs that indicates you can
[2012-03-08 15:12:00 -0500] proffalken: but I can't find anything that says you can't either ;)
[2012-03-08 15:15:00 -0500] proffalken: nm, found it, Chef::Environment.list
[2012-03-08 15:17:00 -0500] ssd7: proffalken: You could probably also use search: search('environment', '*:*')
[2012-03-08 15:18:00 -0500] proffalken: ssd7: ok, I'll try that too
[2012-03-08 15:18:00 -0500] proffalken: we don't use "_default", so I'm writing a "sanitycheck
[2012-03-08 15:19:00 -0500] proffalken: " cookbook to error and print a nice message if the node is assigned to _defafult
[2012-03-08 15:19:00 -0500] proffalken: wow, so many errors I don't know where to begin with s/ on that... :)
[2012-03-08 15:21:00 -0500] ssd7: If you just want to check if that node is assigned to _default, just use node.chef_environment
[2012-03-08 15:22:00 -0500] jtimberman: http://aws.typepad.com/aws/2012/03/ec2-updates-new-instance-64-bit-bit-ubiquity-ssh-client.html
[2012-03-08 15:22:00 -0500] proffalken: ssd7: bit more complicated than that - I'm checking to see if the node is assinged to "_default" and if it is, I'm displaying a list of all available environments and then quitting out of the run before any damage is done
[2012-03-08 15:22:00 -0500] jtimberman: bdha: don't bung ftsab!
[2012-03-08 15:22:00 -0500] jtimberman: duh :D
[2012-03-08 15:23:00 -0500] proffalken: it's not bullet-proof, but it will work for this purpose
[2012-03-08 15:23:00 -0500] jtimberman: proffalken: so essentially you want to make sure that no systems come up in the "_default" environment
[2012-03-08 15:24:00 -0500] proffalken: jtimberman: pretty much, yes - our provisioning software *should* take care of that for us, but if a node has been built by hand for what ever reason, this will say
[2012-03-08 15:25:00 -0500] proffalken: "Hey, you screwed up! Why not try one of these envs instead?"
[2012-03-08 15:25:00 -0500] proffalken: its working, I just need to get to to stop the chef-client now...
[2012-03-08 15:26:00 -0500] proffalken: I guess I just raise an error?
[2012-03-08 15:26:00 -0500] BryanWB: proffalken: preferred way is
[2012-03-08 15:26:00 -0500] BryanWB: Chef::Application.fatal!
[2012-03-08 15:27:00 -0500] proffalken: BryanWB: cool, thanks
[2012-03-08 15:27:00 -0500] BryanWB: proffalken: but check syntax, that's off top of my head
[2012-03-08 15:28:00 -0500] jtimberman: That is correct
[2012-03-08 15:28:00 -0500] jtimberman: it takes a parameter of the log message to bleat at you
[2012-03-08 15:29:00 -0500] jtimberman: Chef::Application.fatal! "ZOMG! WRONG ERROR"
[2012-03-08 15:31:00 -0500] jtimberman: ssd7: from Chef, or other software?
[2012-03-08 15:31:00 -0500] ssd7: other software :)
[2012-03-08 15:33:00 -0500] proffalken: ssd7: ORacle used to have "ERROR: This error message does not exist"... </sigh>
[2012-03-08 15:33:00 -0500] bluenemo: how can i view the variables of a node again after a chef run (just installed mysql via chef and looking for the pw's)?
[2012-03-08 15:41:00 -0500] ssd7: bluenemo: try knife node show NODENAME -a mysql
[2012-03-08 15:42:00 -0500] bkocik: Is there some way, via knife or something else, to get a look at a node's attribute so I can figure out how to use it in a recipe without resorting to trial-and-error? For example, I'd like to see what "node[:network][:interfaces][:eth1][:addresses]" would yield.
[2012-03-08 15:43:00 -0500] Brad_K: bkocik: you want this before doing a chef run?
[2012-03-08 15:43:00 -0500] BryanWB: bkocik: shef
[2012-03-08 15:47:00 -0500] bkocik: So this is me discovering that all of my nodes were bootstrapped without readline. Ugh.
[2012-03-08 15:48:00 -0500] bkocik: dwhsix: It should on the next execution of chef-client
[2012-03-08 15:48:00 -0500] dwhsix: oh, ok
[2012-03-08 15:48:00 -0500] dwhsix: thx
[2012-03-08 15:49:00 -0500] ssd7: BryanWB: fwiw, I have a fix the the "role attrs in shef are wrong" thing, just havn't put together a commit yet since I'd prefer to do a more thorough check of Shef's startup.  If you need it though: https://github.com/stevendanna/knife-hacks/blob/master/shef/client_session_fix.rb
[2012-03-08 15:49:00 -0500] BryanWB: ssd7: awesome! don't need it urgently but tks
[2012-03-08 15:50:00 -0500] dwhsix: hmm only cookbooks may be versioned?
[2012-03-08 15:51:00 -0500] bluenemo: perfect ssd7 thank you :)
[2012-03-08 15:57:00 -0500] bkocik: dwhsix: As far as I know, but I'm no expert.
[2012-03-08 15:57:00 -0500] dwhsix: bkocik: thx seems like it.  not an issue, just trying to get some stuff straight
[2012-03-08 16:03:00 -0500] bkocik: Booyah! Figuring out that I wanted "node[:network][:interfaces][:eth1][:addresses].select{|key,val| val[:family] == 'inet'}.flatten[0]" took about 30 seconds with shef. Would have been half a day trial-and-error. Thanks, BryanWB.
[2012-03-08 16:03:00 -0500] bkocik: and Brad_K
[2012-03-08 16:04:00 -0500] proffalken: meh, so that code doesn't quite work...
[2012-03-08 16:04:00 -0500] BryanWB: bkocik: np
[2012-03-08 16:05:00 -0500] proffalken: we're triggering an NSCA check at the end of our chef-client run and the Chef::Application.fatal! completely destroys the NSCA command
[2012-03-08 16:05:00 -0500] proffalken: is there a way to exit chef and output a "pretty" error message instead of a stack trace?
[2012-03-08 16:05:00 -0500] Brad_K: bkocik: glad to be able to help!
[2012-03-08 16:07:00 -0500] bkocik: I wonder if there's some way to stuff that in some global definition and then access it in recipes.
[2012-03-08 16:12:00 -0500] nico: proffalken: monkey patch Chef::Application.fatal!
[2012-03-08 16:14:00 -0500] zts: proffalken: how are you doing the NSCA bit?
[2012-03-08 16:14:00 -0500] proffalken: nico: I've just had a look, it's our NSCA code it takes the last few lines of the backtrace...
[2012-03-08 16:15:00 -0500] proffalken: zts: not 100% sure at the momoent, only been working here 3 weeks :)
[2012-03-08 16:15:00 -0500] proffalken: I've found the issue, just need to work out how we're using it! :)
[2012-03-08 16:17:00 -0500] nico: proffalken: why not using a repirt handler ? you'll have the backtrace nd will be able to do your reporting properly
[2012-03-08 16:19:00 -0500] nico: here we send backtrace of failed run by mail
[2012-03-08 16:20:00 -0500] bkocik: Does anyone else find it incredibly limiting that you cannot read attributes in a role file? Maybe my thinking is wrong...
[2012-03-08 16:20:00 -0500] proffalken: nico, zts: looks like it is a report handler (only just discovered you can do that!) but the data I'm generating is causing the handler to fail
[2012-03-08 16:20:00 -0500] proffalken: just debuggng no
[2012-03-08 16:20:00 -0500] proffalken: s/no/now
[2012-03-08 16:21:00 -0500] nico: ok
[2012-03-08 16:21:00 -0500] laurent\: nico: still working on your hmm what was its name report handler + ES ?
[2012-03-08 16:21:00 -0500] laurent\: since i now have a running ES cluster, i might be interested in trying it
[2012-03-08 16:22:00 -0500] nico: laurent\: it works here :)
[2012-03-08 16:22:00 -0500] laurent\: ok :)
[2012-03-08 16:22:00 -0500] laurent\: i'll give it a try then
[2012-03-08 16:22:00 -0500] nico: I have found a bug in reporting earlier this week. It would need some improvements btw
[2012-03-08 16:23:00 -0500] nico: (not consuming the queue to ES directly, for example)
[2012-03-08 16:24:00 -0500] laurent\: using amq ? i guess i could also log the reports to syslog and let logstash send the data to ES
[2012-03-08 16:25:00 -0500] nico: sure
[2012-03-08 16:25:00 -0500] nico: I use stomp for the messaging part
[2012-03-08 16:26:00 -0500] nico: I was more thinking of consuming it to a database, because it can be required to reindex data
[2012-03-08 16:26:00 -0500] nico: (schema changes for eg)
[2012-03-08 16:26:00 -0500] zts: bkocik: how do you mean?
[2012-03-08 16:27:00 -0500] nico: we have an ES guru here, his wise advices are definitely great
[2012-03-08 16:27:00 -0500] laurent\: ok
[2012-03-08 16:28:00 -0500] nico: the nice stuff in this is the report handler pushing the list of changes + diffs
[2012-03-08 16:28:00 -0500] jtimberman: bkocik: what do you mean, in shef?
[2012-03-08 16:28:00 -0500] jtimberman: bkocik: or in an actual chef-client run?
[2012-03-08 16:28:00 -0500] bkocik: zts: Well, it's probably my inexperience at fault - but for example, I have a firewall recipe that allows me to set attributes like this: :firewall => {:allowed_ports => {"redis" => {:port => 6982, :interface => 'eth1'}}}
[2012-03-08 16:29:00 -0500] laurent\: nico: i have to go, i'll give it another look this evening@home
[2012-03-08 16:29:00 -0500] bkocik: Redis is installed with the Redis recipe. Rather than hard code that port and interface, I'd like to be able to read the Redis port number (which is an attribute).
[2012-03-08 16:29:00 -0500] nico: laurent\: I'll try to find some time to improve cuisine : bugfix, better consumer, schemas upgrades, improved search, statistics
[2012-03-08 16:29:00 -0500] nico: metrics porn
[2012-03-08 16:30:00 -0500] renchap: better UI
[2012-03-08 16:30:00 -0500] renchap: i might patch this one.
[2012-03-08 16:30:00 -0500] bkocik: so if I change the Redis port, I don't have to then remember to also change the firewall attributes in the role.
[2012-03-08 16:30:00 -0500] nico: I suck at UIs
[2012-03-08 16:30:00 -0500] bkocik: That I find this difficult tells me I'm probably doing it wrong. :)
[2012-03-08 16:44:00 -0500] bkocik: I guess what I should be doing is setting those attributes within the recipe(s) rather than the role. I just don't like to alter "stock" recipes if I can avoid it.
[2012-03-08 16:46:00 -0500] cgibbons: hmmmmm the basho riak recipe doesn't seem to work well with ubuntu 11.10
[2012-03-08 16:46:00 -0500] zts: bkocik: it sounds like the issue is not where the attributes are being set, but that the firewall recipe and the redis recipe need to be told separately about the same thing?
[2012-03-08 16:47:00 -0500] bkocik: zts: Yeah, the port number would be the thing they both need knowledge of.
[2012-03-08 16:48:00 -0500] bkocik: I think the correct solution is to set up the :firewall attributes from within the Redis recipe's default.rb attributes, which could read the port number. I like it to be in the role, but it doesn't have to be.
[2012-03-08 16:49:00 -0500] zts: bkocik: I think you're right to be annoyed by the duplication, but I don't have a good, generally-useful answer for you :)
[2012-03-08 16:49:00 -0500] zts: bkocik: for some similar functions, where I work, we use LWRPs and definitions to drive configuration of one cookbook from another
[2012-03-08 16:50:00 -0500] zts: bkocik: that translates into various recipes putting stuff into the node's run_state, that another cookbook picks up and uses
[2012-03-08 16:50:00 -0500] bkocik: Interesting. Maybe a definition is what I need.
[2012-03-08 16:51:00 -0500] zts: bkocik: I believe that "metachef" (or whatever it's called this week) tries to solve the same problem in a more generic way, but I haven't spent the time to wrap my head around it yet
[2012-03-08 16:51:00 -0500] bkocik: I'll look at that when and if I become confident with Chef itself. :)
[2012-03-08 16:51:00 -0500] bkocik: I'm new enough to Chef that I figure if something seems weird to me, it almost certainly means I have an incomplete understanding somewhere. I'm still learning.
[2012-03-08 16:53:00 -0500] zts: bkocik: yeah, I don't recommend rushing it.  The good thing about managing infrastructure in this way, is that it's relatively easy to improve on things as you learn new and better ways of doing them
[2012-03-08 16:53:00 -0500] AntonZ: good morning, can someone please, tell me why psosible this chef run would commplain about file not existing, if the file is there, here is the error i get https://gist.github.com/1895560
[2012-03-08 16:54:00 -0500] Brad_K: bkocik: we like to set both port lists in the role attributes.  yes, it has to be listed once for the application and once for the firewall, but at least it's all in one place.
[2012-03-08 16:55:00 -0500] Brad_K: of course, we also set default attributes within the cookbook, but those get replaced with the attributes set at the role.
[2012-03-08 16:55:00 -0500] Brad_K: frequently, we'll use the same numbers in both places, but at least in the cookbook it's only a default attribute and therefore it's easily over-ridden.
[2012-03-08 16:56:00 -0500] bkocik: Brad_K: I guess there are a lot of ways to skin cats with Chef. Often this leads to confusion for me, because I don't know which is the "right" way for my situation. I'll get there.
[2012-03-08 16:56:00 -0500] Brad_K: TIMTOWTDI == Tim Toady.
[2012-03-08 16:56:00 -0500] bkocik: jtimberman: If you didn't see me say it the other day, thank you for fixing the passenger_apache2 cookbook. That was a big blocker for me.
[2012-03-08 16:56:00 -0500] Brad_K: it's great for people who are already experienced with the software, but Tim Toady is not your friend if you're just trying to learn.
[2012-03-08 16:57:00 -0500] Brad_K: and yes, that is something you will hear me harp about quite frequently.
[2012-03-08 16:59:00 -0500] AntonZ: please, anyone? https://gist.github.com/1895560 - i think thats the only thing that stops me to finally building my jira :D
[2012-03-08 17:01:00 -0500] AntonZ: recipe reads:
[2012-03-08 17:01:00 -0500] AntonZ: template "/tmp/response.varfile" do
[2012-03-08 17:01:00 -0500] AntonZ:   source "response.varfile.erb"
[2012-03-08 17:01:00 -0500] AntonZ:   mode 0755
[2012-03-08 17:01:00 -0500] AntonZ: end
[2012-03-08 17:01:00 -0500] AntonZ: amnd the file is there, why chef complains ?
[2012-03-08 17:02:00 -0500] bkocik: AntonZ: I think you need to add "action :create" to your recipe.
[2012-03-08 17:02:00 -0500] bkocik: Oh, maybe not. Sorry - disregard that.
[2012-03-08 17:03:00 -0500] bkocik: Is the erb file in your templates directory for the recipe?
[2012-03-08 17:03:00 -0500] bkocik: err, cookbook?
[2012-03-08 17:04:00 -0500] AntonZ: yes jira>tempaltes>filename
[2012-03-08 17:04:00 -0500] AntonZ: i dont understand if it's the code or something else at fault
[2012-03-08 17:07:00 -0500] AntonZ: is there a specific format for .erb files that chef expects?
[2012-03-08 17:07:00 -0500] AntonZ: ofr chef doenst care
[2012-03-08 17:07:00 -0500] bkocik: Oh - does it need to be in the templates/default directory? (I'm looking at recipes on my system)
[2012-03-08 17:07:00 -0500] proffalken: AntonZ: it needs to be in jira>templates/default/
[2012-03-08 17:07:00 -0500] proffalken: bkocik: :)
[2012-03-08 17:07:00 -0500] bkocik: Yeah, what proffalken said. :)
[2012-03-08 17:08:00 -0500] AntonZ: it actually was in tempaltes/default and i got the error saying that chef is looking for the file in jira->templates
[2012-03-08 17:08:00 -0500] AntonZ: thats why i moved it to templates from default
[2012-03-08 17:08:00 -0500] hoover_damm: anyone know of a graphite cookbook off hand that uses virtualenv? 
[2012-03-08 17:08:00 -0500] Brad_K: it should be in .../jira/templates/default/
[2012-03-08 17:09:00 -0500] hoover_damm: checked out the community site
[2012-03-08 17:09:00 -0500] AntonZ: okay, moved it back to default, let me re-run this
[2012-03-08 17:09:00 -0500] hoover_damm: and didn't think I was going to be writing a new cookbook for graphite today
[2012-03-08 17:09:00 -0500] hoover_damm: but it looks like it
[2012-03-08 17:10:00 -0500] Brad_K: hoover_damm: which cookbooks have you looked at so far?
[2012-03-08 17:19:00 -0500] AntonZ: so here is the erro i get with the file being in jira->templates->default->file name
[2012-03-08 17:19:00 -0500] AntonZ: https://gist.github.com/1895560
[2012-03-08 17:22:00 -0500] AntonZ: perhaps it doesnt like extra dot inthe file name ?
[2012-03-08 17:23:00 -0500] AntonZ: ill take any other guesses as well
[2012-03-08 17:26:00 -0500] |shad0w|: AntonZ, why not take the error at it's word. Are you sure the copy of the cookbook on the server actually has your template file?
[2012-03-08 17:28:00 -0500] hoover_damm: Brad_K, Heavywater and infochimps
[2012-03-08 17:28:00 -0500] AntonZ: i did check and the file was there... i modified filename to remove the dot so now it's varfile.erb; going to re-run it and check again to see if all the components are actually there...
[2012-03-08 17:28:00 -0500] |shad0w|: where in the templates directory did you put it?
[2012-03-08 17:28:00 -0500] Brad_K: hoover_damm: well, those are the ones i would have told you to look at, so you're already a step or three ahead of me.
[2012-03-08 17:28:00 -0500] hoover_damm: yep, those don't follow a pattern I like
[2012-03-08 17:28:00 -0500] hoover_damm: which is virtualenv
[2012-03-08 17:28:00 -0500] AntonZ: jira\templates\default\varfile.erb
[2012-03-08 17:28:00 -0500] |shad0w|: the error message might be a bit misleading, you probably want it templates/default
[2012-03-08 17:28:00 -0500] AntonZ: thats where the file is..
[2012-03-08 17:29:00 -0500] Brad_K: AntonZ: wait  are we talking about backslashes or forward slashes?  what OS are you running on?  are you on Windows?
[2012-03-08 17:29:00 -0500] AntonZ: im on windows
[2012-03-08 17:30:00 -0500] AntonZ: so cope pasted the path :)
[2012-03-08 17:30:00 -0500] Brad_K: yeah, so the underlying filesystems have some differences there, and i don't think that Windows like files that begin with a dot.
[2012-03-08 17:31:00 -0500] AntonZ: i feel like this is such a silly error to get or issue to have.. chef cant the file.. sigh.. re-running this now, stay tuned
[2012-03-08 17:31:00 -0500] Brad_K: and i'm not sure how the template resources might be different on Windows.  they don't have the same kind of ownership & permissions settings, for example.
[2012-03-08 17:32:00 -0500] AntonZ: i upload my cookbooks to git repo first, always have
[2012-03-08 17:32:00 -0500] AntonZ: dont think thats where the issue is
[2012-03-08 17:32:00 -0500] |shad0w|: AntonZ, bump the cb version?
[2012-03-08 17:33:00 -0500] AntonZ: cookbook version ?
[2012-03-08 17:33:00 -0500] bawt: cookbook version is not indicative of the chef version.
[2012-03-08 17:33:00 -0500] Brad_K: AntonZ: as a filesystem issue, this wouldn't have anything to do with the git repo.
[2012-03-08 17:33:00 -0500] AntonZ: chef version is 0.9
[2012-03-08 17:33:00 -0500] Brad_K: ooh.  ouch.
[2012-03-08 17:34:00 -0500] Brad_K: that's pretty old.
[2012-03-08 17:34:00 -0500] AntonZ: tahts RightScale version...
[2012-03-08 17:34:00 -0500] AntonZ: i think full version is 0.9.14 or something
[2012-03-08 17:34:00 -0500] Brad_K: oh, crap.  that's right.  so, you're dealing with both Windows and RightScale?  yipe!
[2012-03-08 17:34:00 -0500] AntonZ: haha... yea
[2012-03-08 17:35:00 -0500] |shad0w|: AntonZ, hosted or running your own chef-server?
[2012-03-08 17:35:00 -0500] AntonZ: its hosted
[2012-03-08 17:35:00 -0500] Brad_K: man, if i were in that position i think i'd feel like i had shot both feet before even trying to start the race.
[2012-03-08 17:36:00 -0500] AntonZ: no choice here... i almost stopped sleeping with this cooking :)
[2012-03-08 17:36:00 -0500] AntonZ: but thats beyond of this error message im getting :D
[2012-03-08 17:36:00 -0500] |shad0w|: might want to try killing metadata.json and uploading again so it rebuilds the cookbook metadata
[2012-03-08 17:36:00 -0500] Brad_K: the miracle is not that the dog has perfect enunciation and a wide vocabulary, the miracle is that the dog can talk at all.
[2012-03-08 17:37:00 -0500] AntonZ: hmm, ill try that shadow!
[2012-03-08 17:37:00 -0500] |shad0w|: and bump the version if you haven't already
[2012-03-08 17:38:00 -0500] AntonZ: Starting Chef Run (Version 0.9.14.4)
[2012-03-08 17:38:00 -0500] AntonZ: so thats exact version
[2012-03-08 17:39:00 -0500] AntonZ: cookbook jira does not contain file templates/varfile.erb
[2012-03-08 17:39:00 -0500] AntonZ: so period it doesnt see the file...
[2012-03-08 17:39:00 -0500] AntonZ: im curious about just rec-reating the file or something... and reuplaoding json file
[2012-03-08 17:39:00 -0500] gmcinnes: hi chefs
[2012-03-08 17:40:00 -0500] AntonZ: ji , im not a chef, but im cooking :D
[2012-03-08 17:41:00 -0500] gmcinnes: bit like myself. more of a short order cook than a chef :)
[2012-03-08 18:00:00 -0500] AntonZ: could be RightScale fault - doesnt seem like they download entire cookbook, templates folder is missing
[2012-03-08 18:00:00 -0500] AntonZ: smething is fishy
[2012-03-08 18:14:00 -0500] maek: is there a 'way' to manage chef-client ? in terms of the client.rb and upgrades etc? i assume some fancy cookbook?
[2012-03-08 18:31:00 -0500] maek: sorry for the flood of stupid questions. https://gist.github.com/2002536 Im installing hadoop package and it makes the hdfs group but my next directory resource that trys to use it fails. If I re run chef-client it works fine.
[2012-03-08 18:33:00 -0500] chip-: Hey question: If I'm using knife on Windows, where do I drop private keys for "knife ssh?"
[2012-03-08 18:34:00 -0500] Brad_K: maek  there is a chef-client cookbook, yes.
[2012-03-08 18:34:00 -0500] maek: Brad_K: thanks
[2012-03-08 18:34:00 -0500] jtimberman: bkocik: you're welcome (passenger_apache2 cookbook). Sorry that was a hassle for you!
[2012-03-08 18:34:00 -0500] Brad_K: your other problem might be related to actions that take place at compile time versus those that take place at execution time.  let me see if i can dig up a reference that will show you how you can work around that.
[2012-03-08 18:35:00 -0500] maek: chip-: we install cygwin
[2012-03-08 18:35:00 -0500] chip-: maek: That is... sub-optimal.
[2012-03-08 18:36:00 -0500] maek: chip-: miss read. though you were asking about knife ssh to the windows box
[2012-03-08 18:36:00 -0500] maek: you're saying knife from a windows box, my bad
[2012-03-08 18:37:00 -0500] Brad_K: maek: try doing something like shown at http://lists.opscode.com/sympa/arc/chef/2012-03/msg00129.html
[2012-03-08 18:37:00 -0500] Brad_K: using the assignment + run_action trick is a way to force the action to occur at compile time instead of execution time.
[2012-03-08 18:38:00 -0500] maek: Brad_K: so there is more to this then just put it in the right order. I mean the group is there.
[2012-03-08 18:38:00 -0500] maek: Brad_K: is it possible the directory is being made before the package installs?
[2012-03-08 18:44:00 -0500] Brad_K: maek: you could always make the directory yourself, if the package install isn't doing it for you.  my point was that some actions happen during compile time and execute before other actions that occur later, even though the order might be different in the recipe.
[2012-03-08 18:44:00 -0500] Brad_K: so, you can do the assigment + run_action trick to force a particular action to occur during the compile phase as opposed to having it wait until the execution phase.
[2012-03-08 18:45:00 -0500] maek: Brad_K: I am making the dir, the rpm is making the group
[2012-03-08 18:46:00 -0500] maek: Brad_K: any way to figure out what phase they occur in?
[2012-03-08 18:46:00 -0500] Brad_K: in that case, it is entirely possible that the problem you have is that the directory is being created before the rpm is being installed.  If you create the group itself, then you can control when that happens.  Otherwise, you might want to try to force the rpm to be installed during the compile phase.
[2012-03-08 18:48:00 -0500] Brad_K: i'm still not 100% certain as to what happens in which phase.  i do know that if you're having a problem with things being done in the wrong order, you can force one or the other action to happen earlier either by controlling the order in which they appear in the file (if they're done during the same phase), or by using the assignment + run_action trick if one part is being done at execution time and the other part is being done at compile time.  those 
[2012-03-08 18:49:00 -0500] maek: Brad_K: that seems very sloppy.
[2012-03-08 18:49:00 -0500] Brad_K: chef wasn't designed to do orchestration, and that's basically what this is.
[2012-03-08 18:50:00 -0500] maek: I was under the impression order mattered? if I put the package first expecting it to have laid the foundation for for user/group creation
[2012-03-08 18:50:00 -0500] maek: oh
[2012-03-08 18:50:00 -0500] maek: so I should be relying on multiple runs
[2012-03-08 18:50:00 -0500] maek: to get to the state I want
[2012-03-08 18:50:00 -0500] maek: maybe my world view is off
[2012-03-08 18:51:00 -0500] maek: Im coming at this thinking a single chef-client run should be enough
[2012-03-08 18:51:00 -0500] maek: should I instead expect to run a few and have it converge ?
[2012-03-08 18:51:00 -0500] maek: i think the thing thats tricking me here is I have this same pattern in many recipes and it just works 
[2012-03-08 18:52:00 -0500] geekbri: maek: order does matter, but there is a difference between compile time and execution time
[2012-03-08 18:54:00 -0500] maek: geekbri: and I assume this isnt just random as to when a resources gets ran.
[2012-03-08 18:55:00 -0500] maek: thanks both. more to chew on
[2012-03-08 18:55:00 -0500] geekbri: maek: yeah, I actually ran into a lot of issues like you are speaking of very recently
[2012-03-08 18:55:00 -0500] geekbri: maek: I had an issue with bash blocks and the time in which they ran relative to pure ruby written in a recipe and vs ruby written in a ruby_block
[2012-03-08 18:59:00 -0500] jtimberman: Chef can help facilitate building an orchestration around it using robust, featureful API to information about your infrastructure, often through search.
[2012-03-08 19:09:00 -0500] Brad_K: maek: yeah, most of the time, what you want will "just work".  but then there are the odd cases where that doesn't happen.  i've run into that a couple of times, over to 50+ cookbooks we use, and the > 53k lines of "infrastructure as code" that we have.  so, overall i would say that the batting average is quite high.
[2012-03-08 19:10:00 -0500] maek: Brad_K: yeah indeed. I still <3 chef, it just feels a bit strange especially cause im doing the exact same thing in another recipe and it works how I expect
[2012-03-08 19:11:00 -0500] holoway: maek: a single run should be enough
[2012-03-08 19:11:00 -0500] holoway: maek: is the issue that the group assignment fails?
[2012-03-08 19:12:00 -0500] maek: holoway correct
[2012-03-08 19:12:00 -0500] holoway: maek: you probably have an issue with stuff being cached
[2012-03-08 19:12:00 -0500] maek: so the rpm gets installed and it makes the group, I then try and use the group option for a dir resource and the dir resources says no group found
[2012-03-08 19:12:00 -0500] maek: after the fail I then check /etc/groups and the hdfs group is there.
[2012-03-08 19:13:00 -0500] maek: so I blew away /var/chef/cache - Im guessing you mean something more complicated then that for caching
[2012-03-08 19:13:00 -0500] holoway: yeah, I mean at the operating system level or inside ruby
[2012-03-08 19:14:00 -0500] maek: so the idea of many runs is a bit incorrect? we use that currently for search driven things but as you said when you boot strap a node its nice for the chef-client run to complete and be able to pick how you handle missing search data
[2012-03-08 19:15:00 -0500] maek: you didnt say that but "a single run should be enough" let me infer that
[2012-03-08 19:15:00 -0500] geekbri: maek: it seems to me like the rpm install action happens after the directory resourse.  How are you installing the rpm?  with the package resource?
[2012-03-08 19:15:00 -0500] maek: geekbri: correct
[2012-03-08 19:15:00 -0500] holoway: maek: I would hope you can get it done in a single pass, yeah - but there are circumstances where that's hard
[2012-03-08 19:15:00 -0500] holoway: maek: there is no shame in more than one pass
[2012-03-08 19:16:00 -0500] holoway: maek: are you using nscd?
[2012-03-08 19:16:00 -0500] geekbri: maek: its possible that the package resource runs after the directory resource.  I'm probably not the person to ask about that.
[2012-03-08 19:16:00 -0500] maek: holoway: but those are self created circumstances, you know searching for boxes that arent checked in yet, etc. this seems like something that shouldnt take 2 runs
[2012-03-08 19:17:00 -0500] holoway: maek: yeah, there is an interaction here we just need to flush out
[2012-03-08 19:17:00 -0500] maek: holoway: I love it, no shame. I assume because I dont know what nscd is I would say no
[2012-03-08 19:17:00 -0500] maek: re nscd, let me look into that
[2012-03-08 19:19:00 -0500] Twirrim: nscd = pain in the arse ;)
[2012-03-08 19:19:00 -0500] Twirrim: neat idea, but prone to failure.
[2012-03-08 19:20:00 -0500] holoway: maek: what version of chef?
[2012-03-08 19:22:00 -0500] holoway: maek: sudo nscd -g
[2012-03-08 19:22:00 -0500] holoway: maek: will tell you
[2012-03-08 19:22:00 -0500] maek: holoway:  0.10.8 client and server
[2012-03-08 19:23:00 -0500] maek: nscd command not found, no rpm installed. so id guess no
[2012-03-08 19:25:00 -0500] jordan_c: is there an "expect" like mechanism in chef?
[2012-03-08 19:27:00 -0500] pbuckley: net::ssh?
[2012-03-08 19:28:00 -0500] ajsrn: Hey all
[2012-03-08 19:28:00 -0500] ajsrn: I had a quick question about ruby_block and scoping
[2012-03-08 19:29:00 -0500] ajsrn: http://pastie.org/3550472
[2012-03-08 19:30:00 -0500] eydaimon: How can I get recepies to work without running as root? I'm always promoted for the sudo password
[2012-03-08 19:30:00 -0500] ajsrn: In that snippet, the node["app"]["build_time"] in the bash block shows up correctly
[2012-03-08 19:30:00 -0500] ajsrn: But the node["app"]["version"] doesn't
[2012-03-08 19:30:00 -0500] ajsrn: I've been totally unable to pass that parsed out property forward
[2012-03-08 19:31:00 -0500] holoway: ajsrn: right - the value for the code argument to the bash resource is evaluated at compile time
[2012-03-08 19:31:00 -0500] ajsrn: And I can't just add the ruby code in the ruby_block to the outside of my script, as it depends on an earlier block to put the properties file there
[2012-03-08 19:31:00 -0500] ajsrn: Gotcha
[2012-03-08 19:31:00 -0500] ajsrn: What'd be the right way to do this, as I figure I've probably gone and made a pig's ear of it :)
[2012-03-08 19:32:00 -0500] holoway: hard to say without the rest of the context - can you paste the whole of the recipe?
[2012-03-08 19:32:00 -0500] ajsrn: At the moment, that's pretty much it
[2012-03-08 19:32:00 -0500] josephholsten: Is there any veewee/basebox project for windows vm clients?
[2012-03-08 19:33:00 -0500] ajsrn: trying to create a recipe that'll create an SVN branch in a particular way, based off of our internal app version
[2012-03-08 19:33:00 -0500] holoway: ajsrn: the "dpeends on an earlier block to put the properites file there" part maybe matters
[2012-03-08 19:33:00 -0500] ajsrn: gotcha
[2012-03-08 19:33:00 -0500] eydaimon: holoway: any idea?
[2012-03-08 19:34:00 -0500] holoway: eydaimon: if you never do anything that requires root access, things run fine as a regular user
[2012-03-08 19:34:00 -0500] maek: holoway: https://gist.github.com/2002881 as much info as I get from chef-client, recipe etc.
[2012-03-08 19:34:00 -0500] holoway: eydaimon: putting "sudo" in recipes is an anti-pattern, and will cause you this sort of pain (getting prompted for a passwrod)
[2012-03-08 19:34:00 -0500] eydaimon: holoway: it seems to switch to root user when I run the remote_file command
[2012-03-08 19:34:00 -0500] holoway: eydaimon: nope
[2012-03-08 19:35:00 -0500] ajsrn: holoway: I've updated the pastie with everything I've got minus my logging cruft :)
[2012-03-08 19:35:00 -0500] eydaimon: hm, maybe it's when I run the pkg command then
[2012-03-08 19:35:00 -0500] eydaimon: er, package
[2012-03-08 19:35:00 -0500] holoway: eydaimon: maybe, but even then, we're not putting a "sudo" in there
[2012-03-08 19:35:00 -0500] holoway: you are, someplace
[2012-03-08 19:35:00 -0500] holoway: :)
[2012-03-08 19:36:00 -0500] ajsrn: should still be http://pastie.org/3550472 I think :)
[2012-03-08 19:36:00 -0500] eydaimon: grep -ri sudo  * # yields nothing :/
[2012-03-08 19:36:00 -0500] pbuckley: there are other ways to elevate a process to uid 0
[2012-03-08 19:36:00 -0500] pbuckley: :P
[2012-03-08 19:36:00 -0500] eydaimon: holoway: running the grep in the "kitchen" dir
[2012-03-08 19:37:00 -0500] maek: what happens when you run the package command that chef would be running as that user?
[2012-03-08 19:37:00 -0500] maek: I know on some ubuntu boxes apt-get will prompt for sudo if you arent root already
[2012-03-08 19:37:00 -0500] eydaimon: holoway: any suspects if I can't find any reference to sudo nor root?
[2012-03-08 19:37:00 -0500] josephholsten: aww, no windows jeos magik?
[2012-03-08 19:37:00 -0500] eydaimon: holoway: running (knife cook hostname)
[2012-03-08 19:38:00 -0500] holoway: ajsrn: make your bash block smarter, and have it pull out the version for you
[2012-03-08 19:38:00 -0500] holoway: eydaimon: I got nothin for ya, but I can tell you for certain that chef isn't doing that on your behalf
[2012-03-08 19:39:00 -0500] ajsrn: holoway: Sounds good - I have another recipe which actually does my build that also needs that version though
[2012-03-08 19:39:00 -0500] ajsrn: And it actually includes the version in a file created using the template resource
[2012-03-08 19:39:00 -0500] ajsrn: I figure I'll run into the same problem then
[2012-03-08 19:39:00 -0500] holoway: ajsrn: re-think where the version data comes from
[2012-03-08 19:39:00 -0500] ajsrn: lol
[2012-03-08 19:39:00 -0500] ajsrn: I was worried you'd say that
[2012-03-08 19:40:00 -0500] holoway: ajsrn: or, if you know it will work at compile time, do it at compile time
[2012-03-08 19:40:00 -0500] ajsrn: Unfortunately I'm trying to write the chef recipe for an existing app, so I'm stuck with where the versioning comes from
[2012-03-08 19:40:00 -0500] ajsrn: But I can take a look at doing it at compile time
[2012-03-08 19:40:00 -0500] holoway: ajsrn: if you know the svn export will always work
[2012-03-08 19:41:00 -0500] holoway: ajsrn: put it in an attribute file
[2012-03-08 19:41:00 -0500] holoway: and do it there
[2012-03-08 19:41:00 -0500] holoway: (assumes svn is baked into the core image)
[2012-03-08 19:42:00 -0500] ajsrn: holoway: that will work. at least for this script
[2012-03-08 19:42:00 -0500] jmoody: Anyone here familiar with the knife-cloudstack gem?
[2012-03-08 19:42:00 -0500] ajsrn: In the second (template) script, the properties file source is variable based on the json data passed in
[2012-03-08 19:42:00 -0500] ajsrn: Is that available at compile time?
[2012-03-08 19:43:00 -0500] eydaimon: holoway: does this give any clues? http://pastie.org/private/k6de1xcphb9ftc3wyqtg  it starts before it's executing the run list
[2012-03-08 19:44:00 -0500] holoway: ajsrn: yep
[2012-03-08 19:45:00 -0500] holoway: eydaimon: I have no idea what "knife cook" is
[2012-03-08 19:45:00 -0500] holoway: eydaimon: but that looks like an ssh password it prompts you for
[2012-03-08 19:45:00 -0500] ajsrn: holoway: awesome - thanks :)
[2012-03-08 19:45:00 -0500] ajsrn: holoway: I'll give it a shot!
[2012-03-08 19:45:00 -0500] ajsrn: much appreciate the help
[2012-03-08 19:45:00 -0500] holoway: np
[2012-03-08 19:46:00 -0500] eydaimon: holoway: thanks
[2012-03-08 19:47:00 -0500] eydaimon: holoway: what's weird is that it does everything as root after looking in for that user anyway
[2012-03-08 19:48:00 -0500] eydaimon: er, logging in
[2012-03-08 19:51:00 -0500] eydaimon: and it copies all files before prompting me
[2012-03-08 20:01:00 -0500] holoway: eydaimon: talk to the guys who wrote that knife plugin
[2012-03-08 20:04:00 -0500] eydaimon: holoway: yeah, found it. it's in the plugin
[2012-03-08 20:10:00 -0500] kallen: i'd like to be able to tab-complete my many knife commands. is there anything out there that provides tab-completion?
[2012-03-08 20:12:00 -0500] jdeamattson: jtimberman: Are you officially support Ruby 1.9.3 yet? Or is it still 1.9.2? I ask, because it appears FoodCritic (which I love) is using Ruby 1.9.3
[2012-03-08 20:12:00 -0500] kallen: at a glance at googling, i see possible solutions if i use zsh. i wonder if there are solutions for bash
[2012-03-08 20:12:00 -0500] ssd7: kallen: I wrote a very simple one (isn't dynamic since I use 1.8 a lot for testing and don't want to call ruby more than I have to for tab completion.  It will hit the server for node/client names, which is slow)
[2012-03-08 20:12:00 -0500] ssd7: kallen: one sec, have link
[2012-03-08 20:12:00 -0500] kallen: cool
[2012-03-08 20:13:00 -0500] ssd7: https://github.com/stevendanna/knife-hacks/blob/master/shell/knife_completion.sh
[2012-03-08 20:13:00 -0500] kallen: thanks ssd7
[2012-03-08 20:13:00 -0500] ssd7: np,  If I get some time I think I have a good way to make it dynamically get the available plugins without being slow every time you hit tab
[2012-03-08 20:14:00 -0500] ssd7: basically doing the same "store results in shell variable" tricks that the git command completion does
[2012-03-08 20:19:00 -0500] maek: holoway: https://gist.github.com/2002881 thats all the info I have re the group assignment failing even thought the group exists. ty for the help.
[2012-03-08 20:40:00 -0500] jdeamattson: What is the recommended way to mv/rename a directory?
[2012-03-08 20:44:00 -0500] bkocik: That's an excellent question. I wish I could find some guide to the chef DSL
[2012-03-08 20:45:00 -0500] jdeamattson: bkocik: We need a good solid guide to the DSL, reference to the resources and LWRPs, and - if you will pardon me - a Cookbook with common operations and how to perform them.
[2012-03-08 20:46:00 -0500] jdeamattson: bkocik: I am starting some work on it. WIll hit jtimberman up about a place to host it in the future.
[2012-03-08 20:46:00 -0500] bkocik: jdeamattson: Yeah. I'd settle for a list of available functions/commands. :)
[2012-03-08 20:46:00 -0500] jdeamattson: bkocik: Hey, if I am going to set a goal, I will make it a high bar :-)
[2012-03-08 20:46:00 -0500] jdeamattson: bkocik: But I agree.
[2012-03-08 20:47:00 -0500] wilton: Guys, is ohai data available for a node for recipes being applied to that node on the first run? Or do I have to force an ohai run ?
[2012-03-08 20:47:00 -0500] fujin: whaddya mean available functions/commands
[2012-03-08 20:47:00 -0500] fujin: the dsl has resources, the rest is just ruby
[2012-03-08 20:47:00 -0500] fujin: the only dsl suger literally turns a resource specification into a resource class object
[2012-03-08 20:47:00 -0500] bkocik: Okay, then a list of resources. I wasn't being precise in my terminology.
[2012-03-08 20:47:00 -0500] fujin: you guys talking about the language methods like include_recipe ?
[2012-03-08 20:47:00 -0500] fujin: resources?
[2012-03-08 20:47:00 -0500] bawt: resources is http://wiki.opscode.com/display/chef/Resources
[2012-03-08 20:48:00 -0500] fujin: please to
[2012-03-08 20:48:00 -0500] fujin: do the needful
[2012-03-08 20:48:00 -0500] bkocik: fujin: I mean, like, the fact that there is a "directory" function/resource/what-have you. That it exists. I only know this because I see it in recipes. Is it documented somewhere?
[2012-03-08 20:48:00 -0500] fujin: yes, the link I just sent from bawt
[2012-03-08 20:48:00 -0500] fujin: the Resources link contains documentation for each resources and all parameters and what each of the actions do and blah blah blah
[2012-03-08 20:48:00 -0500] fujin: usually covers multiple provider
[2012-03-08 20:49:00 -0500] fujin: wiki is probably really worth going over, the getting started section must get you to the Resources page eventually
[2012-03-08 20:49:00 -0500] bkocik: ooh - thank you
[2012-03-08 20:49:00 -0500] fujin: getting_started?
[2012-03-08 20:49:00 -0500] fujin: maybe not
[2012-03-08 20:49:00 -0500] fujin: lol
[2012-03-08 20:49:00 -0500] fujin: gettingstarted?
[2012-03-08 20:49:00 -0500] bawt: gettingstarted is http://wiki.opscode.com/display/chef/Getting+Started
[2012-03-08 20:49:00 -0500] fujin: try that one too.
[2012-03-08 20:49:00 -0500] jdeamattson: fujin: It doesn't. I stumbled onto it :-)
[2012-03-08 20:49:00 -0500] fujin: other ones that are imperative to your learning:
[2012-03-08 20:49:00 -0500] fujin: roles?
[2012-03-08 20:49:00 -0500] bkocik: I've been all over the wiki. I've probably seen the resources page multiple times, have just forgotten about it. There's a lot of information there. :)
[2012-03-08 20:49:00 -0500] bawt: roles is http://wiki.opscode.com/display/chef/Roles
[2012-03-08 20:49:00 -0500] fujin: attributes?
[2012-03-08 20:49:00 -0500] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-03-08 20:50:00 -0500] fujin: environments?
[2012-03-08 20:50:00 -0500] bawt: environments is a feature of the Chef Server allowing you to constrain cookbooks to specific versions, set environment specific run lists for roles and set up environment specific attributes for nodes. Documentation: http://wiki.opscode.com/display/chef/Environments
[2012-03-08 20:50:00 -0500] jdeamattson: Unless they updated it recently.
[2012-03-08 20:50:00 -0500] fujin: strange that it doesn't lead there
[2012-03-08 20:50:00 -0500] fujin: I guess it's more of a concept once you understand that chef has resources most naturally respond by querying for a list of resources
[2012-03-08 20:50:00 -0500] jdeamattson: When working my way through Chef, sometimes I feel like I am playing Zork :-)
[2012-03-08 20:50:00 -0500] fujin: haha
[2012-03-08 20:53:00 -0500] bkocik: What I encounter frequently is that there's more than one way to do most things, and I don't find out that I've chosen the wrong one until it bites me at some much later date, by which I've forgotten how I did it or why I did it that way.
[2012-03-08 20:53:00 -0500] bkocik: But that's the sort of thing that becomes less frequent with experience.
[2012-03-08 20:53:00 -0500] jdeamattson: bkocik: Have you found FoodCritic?
[2012-03-08 20:53:00 -0500] fujin: for sure, familiarity is key there
[2012-03-08 20:53:00 -0500] bkocik: No, but I was just reading up on spiceweasel for the first time, which looks pretty cool (not to mention it has a killer name)
[2012-03-08 20:54:00 -0500] jdeamattson: fujin: The question is how we can help people climb that curve faster.
[2012-03-08 20:54:00 -0500] bkocik: Oh, lint for chef cookbooks. Let's see how bad of a person I am...
[2012-03-08 20:54:00 -0500] jdeamattson: bkocik: I used food critic this AM to help clean up some of my early code.
[2012-03-08 20:55:00 -0500] jdeamattson: bkocik: Take any chance you have to read fujin 's work. You will learn a lot.
[2012-03-08 20:55:00 -0500] fujin: +_+
[2012-03-08 20:55:00 -0500] bkocik: jdeamattson: Where would I bump into it?
[2012-03-08 20:55:00 -0500] jdeamattson: Go to github.
[2012-03-08 20:56:00 -0500] jdeamattson: Check him out. Also, anything by jtimberman
[2012-03-08 20:56:00 -0500] fujin: my personal stuff is https://github.com/fujin my consultancy org is https://github.com/heavywater
[2012-03-08 20:56:00 -0500] bkocik: Cool. Thanks.
[2012-03-08 20:56:00 -0500] fujin: http://junglist.gen.nz blog
[2012-03-08 20:56:00 -0500] corp: is the metadata.rb stuff used in chef yet for anything?
[2012-03-08 20:56:00 -0500] fujin: nah just depends
[2012-03-08 20:57:00 -0500] jdeamattson: fujin: Where are you in NZ?
[2012-03-08 20:57:00 -0500] fujin: corp: I know the infochimps guy made a documentation generator that works off metadata.rb, check it out
[2012-03-08 20:57:00 -0500] fujin: jdeamattson: Rotorua
[2012-03-08 20:57:00 -0500] corp: seems like it would be useful to just rip it out if nobody uses it
[2012-03-08 20:57:00 -0500] jdeamattson: I have great friends down there and visit frequently.
[2012-03-08 20:57:00 -0500] jdeamattson: Love Rotorua!
[2012-03-08 20:57:00 -0500] fujin: haha, awesome. I've lived here all my life
[2012-03-08 20:58:00 -0500] fujin: corp: I know there is a bunch of reporting stuff due to drop, maybe ping the list and see if they have anything planned for metadata.rb
[2012-03-08 20:58:00 -0500] fujin: i really need conditional dependencies
[2012-03-08 20:58:00 -0500] fujin: or like a value for platform dependency
[2012-03-08 20:59:00 -0500] jdeamattson: Both would be nice.
[2012-03-08 21:04:00 -0500] bkocik: Hey, foodcritic didn't mock me. I'm pleasantly surprised.
[2012-03-08 21:15:00 -0500] fujin: It's a nice tool but really shines when you add more rules
[2012-03-08 21:21:00 -0500] bkocik: So it appears to not be possible to access a library function from within an attributes file?
[2012-03-08 21:22:00 -0500] bkocik: I have a utils recipe that is class "class Chef::Recipe::Utilities" and which defines a "self.private_ip" method. But it doesn't look like I can reach it from within an attribute (default.rb) file
[2012-03-08 21:26:00 -0500] bkocik: Trying to get the Redis recipe to write out a config file that gets Redis to bind to the IP of the private (eth1) interface. Seems like I should be able to do this on a per-node basis, but it looks like the only way to pull it off is to change either the recipe or the erb template, which is gonna turn out to be pretty global.
[2012-03-08 21:32:00 -0500] akraut: Hi folks, what's the best way within a recipe to check if another recipe is installed?
[2012-03-08 21:33:00 -0500] akraut: ie: within openssh, I want to check if iptables is installed, and if so, call the iptables_rule
[2012-03-08 21:36:00 -0500] fujin: akraut: the node holds a few variables containing information about recipes and roles in the expanded run list
[2012-03-08 21:36:00 -0500] fujin: node.roles node.recipes node.run_list
[2012-03-08 21:37:00 -0500] fujin: node.recipes.include? "iptables"
[2012-03-08 21:37:00 -0500] fujin: maybe iptables::default
[2012-03-08 21:37:00 -0500] akraut: Ah, that's simple enough.
[2012-03-08 21:37:00 -0500] fujin: I usually just have a separate recipe, called firewall, in the cookbook
[2012-03-08 21:37:00 -0500] fujin: then just use iptables_rule in there. and add it to the role if you need a firewall on the box
[2012-03-08 21:37:00 -0500] fujin: would really like a more integrated solution, like register a service on a port with some restrctions and it can set the rest up
[2012-03-08 21:38:00 -0500] fujin: maybe like resources can provide ports, and the ports are all collected and mapped into firewall config or something
[2012-03-08 21:38:00 -0500] jdeamattson: fujin: Is there a standard way to move a file or directory? I am not seeing anything.
[2012-03-08 21:38:00 -0500] akraut: Yeah, it looks like that's the way the "firewall" cookbook is going, but it seems a ways off.
[2012-03-08 21:39:00 -0500] fujin: move? I don't think so, we don't have primitives for move or copy
[2012-03-08 21:39:00 -0500] jdeamattson: Drop down to FileUtils to do it?
[2012-03-08 21:39:00 -0500] fujin: you can use an execute with mv, or a ruby_block
[2012-03-08 21:39:00 -0500] jdeamattson: That was what I was thinking.
[2012-03-08 21:40:00 -0500] fujin: ruby block with a not if is easy enough; if you do it all the time maybe consider patching in a :move action to the File provider.
[2012-03-08 21:45:00 -0500] bkocik: I can't access it from an erb template, either. This is frustrating.
[2012-03-08 21:46:00 -0500] jdeamattson: fujin: That was what I was thinking. Glad to bounce it off of someone else.
[2012-03-08 21:47:00 -0500] viridari: hello... is there something I can do to make knife-esx accept self-signed SSL certs from an ESX host?
[2012-03-08 21:47:00 -0500] fujin: bkocik: you're saying you don't have access to your library in attributes or templates?
[2012-03-08 21:47:00 -0500] bkocik: Yeah. Probably because I don't know what I'm doing. I'm not even sure if having defined the private_ip function in a recipe was the right way to go,
[2012-03-08 21:48:00 -0500] bkocik: Err, cookbook library. Not a recipe.
[2012-03-08 21:48:00 -0500] bkocik: Maybe I have to source in the cookbook or something...
[2012-03-08 21:49:00 -0500] viridari: I try to "knife esx vm list" and get back an error: "ERROR: OpenSSL::SSL::SSLError: SSL_connect SYSCALL returned=5 errno=0 state=unknown state"
[2012-03-08 21:50:00 -0500] fujin: bkocik: you can just make your own module or class and should have access to it. you don't have to source it..
[2012-03-08 21:50:00 -0500] fujin: put your library and attributes and shit on a gist
[2012-03-08 21:53:00 -0500] Dink: Hello, Is there a way to within a recipe to distinguish different roles ?
[2012-03-08 21:54:00 -0500] Dink: So the recipe would act different based on the role.
[2012-03-08 21:59:00 -0500] Dink: Going to try  " case node['roles'] " or something. New to chef / ruby :p
[2012-03-08 21:59:00 -0500] bkocik: fujin: https://gist.github.com/2003716 Gist re-ordered my files, making my comments a little weird, but there you have it.
[2012-03-08 22:00:00 -0500] paulmooring: Dink: node['roles'] or else node.role? "myrtle" would be best
[2012-03-08 22:00:00 -0500] Dink: Wanted to do a yum cookbook that will setup specific yum repos based on roles
[2012-03-08 22:00:00 -0500] Dink: paulmooring: cool thanks yeah just saw that in the doc.
[2012-03-08 22:05:00 -0500] hippiehacker: Anyone using chef-client on windows having trouble with the amount of ohai data coming in. I've got 41 windows chef-clients, and it's beating a 4CPU 2.7Ghz Xeon quite up. (it's just a default gem-based chef-install). Is there a guide for using multiple chef-server instances to utilize more cores or cutting down on the amount of data pulled in via ohai?
[2012-03-08 22:05:00 -0500] bkocik: Now I've gone and made a mess of my gist.
[2012-03-08 22:06:00 -0500] hippiehacker: I forgot to turn on compaction and I had 16gb of data in just 24 hours
[2012-03-08 22:07:00 -0500] fujin: bkocik: you might want ::Utilities there?
[2012-03-08 22:07:00 -0500] fujin: (try it, not sure; could be affected by being in the context of the node on attribute)
[2012-03-08 22:07:00 -0500] bkocik: That's one thing I didn't try, but in the ERB I did try ::Chef::Recipe::Utilities
[2012-03-08 22:07:00 -0500] fujin: ahhh
[2012-03-08 22:07:00 -0500] fujin: okay so
[2012-03-08 22:07:00 -0500] fujin: when I usually set attributes like that, I calculate and set them in a recipe
[2012-03-08 22:08:00 -0500] fujin: e.g. node.default.foo.bar.baz = Utilities.foo
[2012-03-08 22:08:00 -0500] fujin: it'll get caught in the node.save at end of convergence
[2012-03-08 22:08:00 -0500] fujin: I think for some reason historically you can't do that in an attribute file
[2012-03-08 22:08:00 -0500] fujin: don't recall why
[2012-03-08 22:09:00 -0500] bkocik: Yeah, that's where I'm headed next (::Utilities didn't work). I really didn't want to have to hack on the recipe itself when it seemed like there should be a way to do this at a higher level. But I'll cope.
[2012-03-08 22:13:00 -0500] akraut: Ok, another weird question.
[2012-03-08 22:14:00 -0500] tarrant: I have a chef library that requires a couple of gems. Is there a good way to install those gems before the library is loaded?
[2012-03-08 22:14:00 -0500] akraut: tarrant: the package resource can install gems if you specify the rubygems provider
[2012-03-08 22:15:00 -0500] akraut: Though, upon rereading your question, that might not suffice...
[2012-03-08 22:15:00 -0500] tarrant: The library is required before gem is installed.
[2012-03-08 22:15:00 -0500] tarrant: Think I found the answer: http://help.opscode.com/discussions/problems/839-library-that-requires-a-gem
[2012-03-08 22:16:00 -0500] erikh: hey folks, we're seeing some odd use of the --source argument for gem install for gem_package
[2012-03-08 22:16:00 -0500] erikh: let me gist
[2012-03-08 22:18:00 -0500] erikh: https://gist.github.com/93593b8391367bacccbb
[2012-03-08 22:18:00 -0500] bkocik: fujin: So, adding "node.default.redis.bind = Utilities.private_ip" to the red is default.rb recipe gives me "NameError: uninitialized constant Chef::Recipe::Utilities" I have no idea why it can't see it.
[2012-03-08 22:18:00 -0500] erikh: anyone got an idea why it's passing a filename to --source?
[2012-03-08 22:18:00 -0500] erikh: (it shouldn't.)
[2012-03-08 22:18:00 -0500] bkocik: Ugh. s/red is/redis/ (stop correcting me, Colloquy)
[2012-03-08 22:19:00 -0500] erikh: we're porting to chef 0.10.8 from 0.9.18 -- this was a working recipe
[2012-03-08 22:21:00 -0500] akraut: Ok, weird question... I'm generating a config file that's yaml, so I was just doing file "config" do content config_vars.to_yaml done. Though the order of things change periodically, so chef triggers a service restart every run.
[2012-03-08 22:22:00 -0500] akraut: There's gotta be a better way to do that.
[2012-03-08 22:23:00 -0500] corp: akraut, you could try using an ordereed hash
[2012-03-08 22:26:00 -0500] corp: not sure that wil work though. i used to use yaml OMap
[2012-03-08 22:26:00 -0500] corp: to go the other way
[2012-03-08 22:34:00 -0500] wilton: Guys, is ohai data available for a node for recipes being applied to that node on the first run? Or do I have to force an ohai run ?
[2012-03-08 22:42:00 -0500] akraut: corp: how do I specify that a hash is ordered?
[2012-03-08 22:49:00 -0500] corp: akraut: this may work better http://snippets.dzone.com/posts/show/5811
[2012-03-08 22:52:00 -0500] tolland: hi all
[2012-03-08 22:53:00 -0500] miah: hrm.. tags.. best practices?
[2012-03-08 22:53:00 -0500] miah: or is the best practice "use roles"
[2012-03-08 22:54:00 -0500] tolland: i am having some issues with sub modules in git, and my local repo is totally screwed. is there a tutorual on how to manage my sub modules, particularlyy with regard to publishing to git
[2012-03-08 22:58:00 -0500] tolland: for almost anything non trival you are going to need to set attributes per role, and i think tags are going to be just really basic stuff
[2012-03-08 22:59:00 -0500] miah: i dont want to set attributes though, i'm pretty sure a tag is what i want
[2012-03-08 22:59:00 -0500] miah: just looking for gotcha's or things to keep in mind.. ya know.. best practices.
[2012-03-08 23:01:00 -0500] tolland: miah: well if you find out any bst practices for distributing and maintining cookbooks as sub modules, do let me know
[2012-03-08 23:01:00 -0500] miah: sub modules?
[2012-03-08 23:02:00 -0500] miah: i dont deal with git submodules at all. i just use librarian to manage my ~/chef-repo/cookbooks
[2012-03-08 23:03:00 -0500] sako: hey guys whats a good place to get started with chef? official docs good enough to get rolling?
[2012-03-08 23:03:00 -0500] sako: i am coming from puppet btw so there will be much unlearning :)
[2012-03-08 23:06:00 -0500] jbz: sako:  wiki.opscode.com has some 'get started' resources
[2012-03-08 23:06:00 -0500] sako: nice thanks!
[2012-03-08 23:06:00 -0500] jbz: sako:  Best thing (IMO) is to pick a medium-sized task and then do it
[2012-03-08 23:06:00 -0500] sako: we have a bunch of different servers i need to automate
[2012-03-08 23:07:00 -0500] sako: well no i take that back
[2012-03-08 23:07:00 -0500] sako: most important right now is our webservers
[2012-03-08 23:07:00 -0500] jbz: One thing that trips people up is that the chef community doesn't really have a 'standard' on patterns
[2012-03-08 23:07:00 -0500] sako: and we luckily have some nice build logs that show exactly what was done to provition it
[2012-03-08 23:07:00 -0500] jbz: that's good
[2012-03-08 23:07:00 -0500] jbz: what I would recommend (although I'm not an authority) is that you try to do as much as you can using community cookbooks
[2012-03-08 23:07:00 -0500] sako: jbz: that was my next question is there a nice repo of what a complete project should look like
[2012-03-08 23:07:00 -0500] sako: so i guess the answer is no :)
[2012-03-08 23:08:00 -0500] sako: ya i agree, and fix bugs in those cookbooks
[2012-03-08 23:08:00 -0500] sako: def like that approach :)
[2012-03-08 23:08:00 -0500] jbz: You will pretty much *always* need to tweak things, but I strongly recommend that you should always try to first tweak them using roles/environments
[2012-03-08 23:08:00 -0500] jbz: I guess DRY is the word
[2012-03-08 23:08:00 -0500] sako: right
[2012-03-08 23:08:00 -0500] jbz: don't hardcode specific fixes into cookbooks
[2012-03-08 23:08:00 -0500] jbz: <- speaks from painful experience 'just trying to get something running'
[2012-03-08 23:08:00 -0500] jbz: <- refactors a lot now
[2012-03-08 23:08:00 -0500] miah: ya. i have that experience with my haproxy cookbook
[2012-03-08 23:08:00 -0500] miah: but i'm working on fixing it =)
[2012-03-08 23:09:00 -0500] jbz: :-)
[2012-03-08 23:09:00 -0500] jbz: sako: Last bit of advice:
[2012-03-08 23:09:00 -0500] jbz: before you start working with chef
[2012-03-08 23:09:00 -0500] jbz: write down somewhere *exactly* what task you're trying to accomplish
[2012-03-08 23:09:00 -0500] jbz: otherwise, the mission creep will kill you.
[2012-03-08 23:09:00 -0500] jbz: Once you've finished that task, *then* write out next tasks.
[2012-03-08 23:10:00 -0500] Twirrim: but mission creep is fun :D
[2012-03-08 23:10:00 -0500] jbz: "Automate the deployment of web servers" is a good task
[2012-03-08 23:10:00 -0500] jbz: :-)
[2012-03-08 23:10:00 -0500] jbz: But write down exactly what that means.  "Bring up new webservers from the following vanilla install to configured and running," for example.
[2012-03-08 23:12:00 -0500] sako: ya
[2012-03-08 23:13:00 -0500] sako: thanks for the advice jbz :)
[2012-03-08 23:13:00 -0500] sako: i gotta make small incremental goals
[2012-03-08 23:13:00 -0500] sako: was the same issue that puppet had too, its just configuration management in general i think
[2012-03-08 23:16:00 -0500] jbz: yep
[2012-03-08 23:17:00 -0500] tolland: dont do stupid stuff like give your ubuntu distro specific dependencies.... ;-)
[2012-03-08 23:17:00 -0500] jbz: hahaha indeed.
[2012-03-08 23:21:00 -0500] Twirrim: I'm writing to CentOS as that's what everything should (fingers crossed) become.
[2012-03-08 23:23:00 -0500] hoover_damm: jbz, what did you take my old job?
[2012-03-08 23:23:00 -0500] hoover_damm: lol
[2012-03-08 23:23:00 -0500] hoover_damm: j/k
[2012-03-08 23:23:00 -0500] hoover_damm: but i feel sorry for the sucker who does
[2012-03-08 23:23:00 -0500] hoover_damm: because they'll feel worse then that
[2012-03-08 23:32:00 -0500] jassinpain: hello all, quick question.  Had a running node, knife node deleted it, rebuilt with clean image, reinstalled, but I still see info on old mounts in the node data
[2012-03-08 23:32:00 -0500] jassinpain: I know the delete worked as the recipe list was reset
[2012-03-08 23:32:00 -0500] jassinpain: thoughts?
[2012-03-08 23:43:00 -0500] jassinpain: user error would be the correct thougth as usual
[2012-03-08 23:45:00 -0500] jassinpain: just for more info, scripts where doing a client delete and a run_list reset not a node delete
[2012-03-08 23:51:00 -0500] ssd7: jassinpain: :)  I was very confused as I was pondering your question before I read your follow up.
[2012-03-08 23:52:00 -0500] jassinpain: automation hides things sometimes
