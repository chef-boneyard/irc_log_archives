[2012-03-27 00:54:28 -0400] trkemist: I am interested in using Chef... more and more. Whats the best way to learn how to setup a Chef-Server?
[2012-03-27 00:58:13 -0400] miah: read the wiki
[2012-03-27 00:58:26 -0400] miah: experiment
[2012-03-27 01:10:58 -0400] cmceldowney: Allâ€” n00b question, but it's hanging me up for some reason.  running directory "/nfs" doâ€¦. in my recipe and getting directory[/nfs] (nfs::client-config line 15) had an error: Errno::EINVAL: Invalid argument - /nfs
[2012-03-27 01:16:29 -0400] mhalligan: is there an API to knife or a guide to using it's various methods?
[2012-03-27 01:17:11 -0400] miah: knife?
[2012-03-27 01:17:11 -0400] bawt_: knife is a command-line interface between a human and the Chef Server API, and is documented at http://help.opscode.com/faqs/chefbasics/knife or on the Chef Wiki with examples at http://wiki.opscode.com/display/chef/Knife or that kind of client, it talks directly to the api server
[2012-03-27 01:19:15 -0400] mhalligan: yeah, I've spent a good hour or so digging through the docs, havent' found much yet. Are people just calling the CLI when they want to programmatically provision cloud nodes using knife's cloud plugins?
[2012-03-27 01:20:21 -0400] miah: you can use knife exec
[2012-03-27 01:20:46 -0400] coderanger: mhalligan: Correct answer is "don't use knife for that"
[2012-03-27 01:20:56 -0400] coderanger: knife is a terrible provisioning system :)
[2012-03-27 01:21:05 -0400] mhalligan: not for someone coming from Puppet
[2012-03-27 01:21:06 -0400] cmceldowney: mhalligan: it's very useful for uploading cookbooks, as well as triggering actions on node(s), such as knife ssh "roles:webserver" sudo do_something_awesome
[2012-03-27 01:21:11 -0400] coderanger: And the cloud stuff is basically just a simple wrapper for Fog
[2012-03-27 01:21:22 -0400] coderanger: So just use the Fog library directly
[2012-03-27 01:21:38 -0400] coderanger: maybe reference the knife code if you have questions, but overall Fog is pretty awesome
[2012-03-27 01:21:52 -0400] mhalligan: that seems suboptimal
[2012-03-27 01:22:04 -0400] coderanger: Why?
[2012-03-27 01:22:04 -0400] bawt_: Why is "/" escaped in /bin/bash here.
[2012-03-27 01:22:12 -0400] coderanger: bawt_: Forget why
[2012-03-27 01:22:12 -0400] bawt_: lemme take care of that for you
[2012-03-27 01:22:14 -0400] mhalligan: because then I have to code against both Fog and Chef
[2012-03-27 01:22:27 -0400] coderanger: mhalligan: Not sure what you mean, against both APIs?
[2012-03-27 01:22:49 -0400] mhalligan: well Fog won't get me any of the knife functionality of interacting with Chef for assigning roles, creating clients, editing run_lists, etc
[2012-03-27 01:23:08 -0400] coderanger: Sure, but we have a very nice API with clients in Ruby and Python (and PHP sorta) for that
[2012-03-27 01:23:21 -0400] coderanger: Oh, and Java, I think jclouds has a Chef thang now
[2012-03-27 01:23:41 -0400] coderanger: knife is just poking that API, no magic
[2012-03-27 01:23:42 -0400] cmceldowney: anyone on the directory resource typeâ€” could really use a half-second of smart on why trying to create a directory in my recipe is failing
[2012-03-27 01:23:51 -0400] miah: interesting
[2012-03-27 01:24:02 -0400] miah: cmceldowney: sure. gist?
[2012-03-27 01:24:53 -0400] cmceldowney: miah: here's the declaration: #Create the nfs mount point directory
[2012-03-27 01:24:53 -0400] cmceldowney: directory "/nfs" do
[2012-03-27 01:24:53 -0400] cmceldowney:   owner "root"
[2012-03-27 01:24:53 -0400] cmceldowney:   group "root"
[2012-03-27 01:24:54 -0400] cmceldowney:   mode "0777"
[2012-03-27 01:24:54 -0400] cmceldowney:   action :create
[2012-03-27 01:24:54 -0400] cmceldowney: end
[2012-03-27 01:25:05 -0400] coderanger: cmceldowney: Please don't do that
[2012-03-27 01:25:06 -0400] cmceldowney: miah: error: (nfs::client-config line 15) had an error: Errno::EINVAL: Invalid argument - /nfs
[2012-03-27 01:26:01 -0400] mhalligan: coderanger: but with the added benefit that Knife has already abstracted and combined the two bits of functionality, trhe chef interaction, and the cloud integration, which I feel is the only real advantage over Puppet (at least in my use cases)
[2012-03-27 01:26:10 -0400] coderanger: cmceldowney: Does a plain "mkdir /nfs" work?
[2012-03-27 01:26:24 -0400] cmceldowney: yes. if I create it manually on the box itself, it works fine
[2012-03-27 01:26:25 -0400] coderanger: mhalligan: I think you overestimate how complex that is
[2012-03-27 01:27:01 -0400] coderanger: mhalligan: Fog provides a simple bootstraping system, starting a new node doesn't actually touch the Chef API
[2012-03-27 01:27:52 -0400] coderanger: Just checkout out bootstrap template you are using, you just boot the cloud server, gem install chef, drop a JSON and PEM file off, and start chef-client
[2012-03-27 01:28:00 -0400] mhalligan: OK, I guess I'll go spend a few days messing with Fog
[2012-03-27 01:28:01 -0400] mhalligan: meh
[2012-03-27 01:32:14 -0400] mhalligan: thanks for the help, btw
[2012-03-27 01:36:58 -0400] amccloud: What would cause FATAL: LoadError: no such file to load -- win32/open3
[2012-03-27 01:40:33 -0400] matti: andrewle: Lack of gem?
[2012-03-27 01:40:39 -0400] matti: Oh.
[2012-03-27 01:40:41 -0400] matti: He quit.
[2012-03-27 01:40:49 -0400] matti: He's bacl
[2012-03-27 01:40:51 -0400] matti: ;p
[2012-03-27 01:40:56 -0400] matti: andrewle:
[2012-03-27 01:40:59 -0400] matti: Oh, tab fail.
[2012-03-27 01:41:02 -0400] matti: amccloud:
[2012-03-27 01:41:04 -0400] matti: [03:36:58] < amccloud> What would cause FATAL: LoadError: no such file to load -- win32/open3
[2012-03-27 01:41:07 -0400] matti: [03:40:32] < matti> andrewle: Lack of gem?
[2012-03-27 01:41:24 -0400] amccloud: sorry
[2012-03-27 01:41:28 -0400] matti: ;d
[2012-03-27 01:41:28 -0400] amccloud: oh
[2012-03-27 01:42:44 -0400] amccloud: Is that a problem with my bootstrap script or the cookbook?
[2012-03-27 01:42:58 -0400] amccloud: i'm using knife rackspace
[2012-03-27 01:43:06 -0400] matti: No idea :)
[2012-03-27 01:43:29 -0400] matti: krzysztof@samsung:~$ gem search --remote 'win32' | grep -i open3
[2012-03-27 01:43:29 -0400] matti: win32-open3 (0.3.2, 0.2.5)
[2012-03-27 01:43:30 -0400] matti: win32-open3-19 (0.0.1)
[2012-03-27 01:43:38 -0400] matti: I wonder which one is required.
[2012-03-27 01:44:12 -0400] matti: amccloud: http://stackoverflow.com/questions/8027310/chef-error-loaderror-no-such-file-to-load-win32-open3
[2012-03-27 01:44:35 -0400] matti: amccloud: http://www.opscode.com/blog/2011/05/24/chef-hearts-windows/
[2012-03-27 01:46:19 -0400] amccloud: matti: Saw those. I did not clone the whole cookbook repo. I only picked which ones I needed. Then when trying to upload to manage.opscode.com it complained about dependency cookbooks missing - so I added those too. One of which was "windows" which was a dependency of a dependency if irc.
[2012-03-27 01:47:20 -0400] matti: amccloud: And you might be missing win32 too.
[2012-03-27 01:48:59 -0400] matti: amccloud: I need to go to sleep ;]
[2012-03-27 01:49:06 -0400] matti: amccloud: Good luck with this ;]
[2012-03-27 01:49:09 -0400] amccloud: okay thanks for your help :)
[2012-03-27 01:49:21 -0400] matti: GO team amccloud GO
[2012-03-27 01:55:00 -0400] amccloud: Uploading database [1.1.4] ERROR: Chef::Exceptions::CookbookNotFoundInRepo: Cannot find a cookbook named xfs; did you forget to add metadata to a cookbook? (http://wiki.opscode.com/display/chef/Metadata)
[2012-03-27 01:55:57 -0400] amccloud: can i have it ignore decencies I don't use?
[2012-03-27 02:04:05 -0400] shadoi: decencies.  *snort*
[2012-03-27 02:06:42 -0400] cmceldowney: coderanger: if you have a spare braincell, you were about to help me with this directory resource issue.. should I pass a pastebin?
[2012-03-27 02:10:04 -0400] cmceldowney: All. Issue with a directory resource declaration. Getting Errno::EINVAL: Invalid argument - /path/to/dir â€” details at http://pastebin.com/4WkCjrj1 .. All help appreciated
[2012-03-27 02:15:00 -0400] |shad0w|: if /nfs a local directory or a mount from a remote nfs server?
[2012-03-27 02:15:16 -0400] |shad0w|: s/^if/is
[2012-03-27 02:16:06 -0400] cmceldowney: |shad0w| it is a local directory that is the mount point for a remote NFS directory. Directory is there, works fine, the directory itself actually gets created. appears to have a problem when trying to run the chown command
[2012-03-27 02:23:05 -0400] |shad0w|: so /nfs is a remote nfs mount
[2012-03-27 02:23:32 -0400] |shad0w|: are you doing no_root_squash on it?
[2012-03-27 02:24:11 -0400] cmceldowney: |shad0w| Yes, no_root_squash is part of my exports file.
[2012-03-27 02:24:34 -0400] amccloud: how do I disable --upload-dependencies on knife cookbook upload
[2012-03-27 02:24:43 -0400] |shad0w|: can you chown it to root from cmd line?
[2012-03-27 02:25:04 -0400] cmceldowney: |shad0w| I think I found the issue, although I don't get why it's an issue unless it's an NFS-thingâ€¦ I removed the owner/group from the directory definition for the subdirectory I was trying to create within my recipe. since chef-client is executing under root, that seems to work ok
[2012-03-27 02:26:06 -0400] cmceldowney: |shad0w| you're totally right. So it was an issue that I was trying to chown on an nfs mount, which appears to be a no-go.
[2012-03-27 02:44:44 -0400] hoover_damm: you cannot chown
[2012-03-27 02:44:47 -0400] hoover_damm: you can chown on the nfs server
[2012-03-27 02:44:51 -0400] hoover_damm: but the clients really don't chown
[2012-03-27 02:44:54 -0400] hoover_damm: it's more a noop
[2012-03-27 02:45:06 -0400] hoover_damm: well lemme rephrase because that's not entirely correct
[2012-03-27 02:45:14 -0400] hoover_damm: if you have squash uid/gid enabled chown is a nooop
[2012-03-27 03:29:41 -0400] amccloud: Almost got things working. Just this " LoadError: no such file to load -- win32/open3" which is from the nginx cookbook's bluepill requirement. Anyone else run into this issue?
[2012-03-27 04:27:04 -0400] amccloud: Anyone?
[2012-03-27 04:29:53 -0400] coderanger: amccloud: Guessing you are trying to use Chef on Windows?
[2012-03-27 04:29:59 -0400] coderanger: How did you do the install?
[2012-03-27 04:30:00 -0400] amccloud: no
[2012-03-27 04:30:11 -0400] amccloud: subversion cookbook
[2012-03-27 04:30:33 -0400] coderanger: No? You mean that bluepill just won't install?
[2012-03-27 04:30:59 -0400] amccloud: i think the issue comes from subversion cookbook requiring the windows cookbook
[2012-03-27 04:32:34 -0400] amccloud: my os is ubuntu 10.04
[2012-03-27 04:33:13 -0400] coderanger: amccloud: You just need the cookbook on your chef server, you shouldn't be running any recipes in it
[2012-03-27 04:34:55 -0400] amccloud: coderanger: under chef solo everything worked fine. as soon as I switched to chef server I had to add the dependency cookbooks it was looking for, this error came from one of those dependencies.
[2012-03-27 04:34:58 -0400] BryanWB_: yo chefs
[2012-03-27 04:35:11 -0400] coderanger: amccloud: Where, specifically, is the error coming from
[2012-03-27 04:37:18 -0400] amccloud: coderanger: https://gist.github.com/b2e98835181877b0c4b8
[2012-03-27 04:38:09 -0400] coderanger: amccloud: Can you pastebin the stacktrace too?
[2012-03-27 04:39:02 -0400] amccloud: one sec
[2012-03-27 04:41:05 -0400] amccloud: have to rebuild the vm again to get to the stacktrace
[2012-03-27 04:43:06 -0400] BryanWB_: miah, u r using haproxy 1.5 cuz of the ssl support?
[2012-03-27 04:43:48 -0400] amccloud: coderanger: https://gist.github.com/4ada4273879f48d37112
[2012-03-27 04:44:45 -0400] coderanger: amccloud: Derp, yeah thats no good. Can you file a ticket on Jira?
[2012-03-27 04:45:06 -0400] coderanger: amccloud: In the meantime you can just comment out the "depends windows" line and it should JFW
[2012-03-27 04:45:09 -0400] amccloud: ? Also I wouldn't know what to attribute.
[2012-03-27 04:46:08 -0400] coderanger: http://tickets.opscode.com/secure/CreateIssue.jspa?pid=10010&issuetype=1&Create=Create
[2012-03-27 04:46:13 -0400] coderanger: :-)
[2012-03-27 04:51:06 -0400] amccloud: coderanger: Okay trying now. If it fixes it i'll file that bug report :)
[2012-03-27 04:51:43 -0400] coderanger: amccloud: We really need to make sure that platform support cookbooks are no-ops on other platforms
[2012-03-27 04:51:55 -0400] coderanger: I know the apt and yum ones got a once-over, looks like we need to do the same for windows
[2012-03-27 04:53:06 -0400] amccloud: This  issue must have been introduced recently or everyone must have abandoned svn haha.
[2012-03-27 04:58:51 -0400] coderanger: amccloud:  I would wager it is definitely one of our less-used cookbooks ;-)
[2012-03-27 04:59:43 -0400] Kwanasolis: coderanger: can you explain that a bit? what do you mean needs a 'once over'?
[2012-03-27 05:00:01 -0400] Kwanasolis: I run on one of those 'less used' platforms (archlinux) and am curious if I should be keeping my eyes out for anything
[2012-03-27 05:00:30 -0400] coderanger: Kwanasolis: Just need someone to double check that anything in the attributes or library files is guarded to only happen on the platform where it applies
[2012-03-27 05:00:48 -0400] Kwanasolis: ah
[2012-03-27 05:00:50 -0400] coderanger: since those types of files are loaded for all cookbooks regardless of run-list
[2012-03-27 05:01:00 -0400] Kwanasolis: right, like why I've got yum installed on my arch boxes.
[2012-03-27 05:01:15 -0400] Kwanasolis: so if pacman got summoned up, it would be system safe
[2012-03-27 05:01:22 -0400] coderanger: for bonus points, all platform-specific recipes should start with something like "return unless node[:platform_family] == 'foo'"
[2012-03-27 05:01:51 -0400] coderanger: Yeah, having the apt cookbook on an arch box shouldn't do anything silly, for example
[2012-03-27 05:02:03 -0400] coderanger: or, in this case, the windows cookbook on an ubuntu box
[2012-03-27 05:02:22 -0400] Kwanasolis: gotcha
[2012-03-27 05:06:23 -0400] amccloud: @coderanger http://tickets.opscode.com/browse/COOK-1142
[2012-03-27 05:07:19 -0400] jtimberman: coderanger: i disagree
[2012-03-27 05:07:36 -0400] coderanger: jtimberman: Until we have better conditional dependency support ... :P
[2012-03-27 05:07:52 -0400] prometheus: I should hope that windows cookbook does nothing on my ubuntu box :S
[2012-03-27 05:07:53 -0400] jtimberman: coderanger: the "supports" in the metadata should honor the node's platform and not even download the cookbook, issuing a warning that the platform is unsupported by the cookbook.
[2012-03-27 05:08:12 -0400] jtimberman: coderanger: i don't plan to update every single cookbook's recipes to caveat the platforms it does/doesn't support. do you?
[2012-03-27 05:08:30 -0400] coderanger: No, but for a cookbook that exists for platform support, it is easy to do
[2012-03-27 05:08:32 -0400] jtimberman: it would be easier to build that into the metadata check.
[2012-03-27 05:08:38 -0400] coderanger: apt, yum, windows, etc
[2012-03-27 05:08:54 -0400] jtimberman: why are you adding those recipes to a node that is not of the appropriate platform?
[2012-03-27 05:08:56 -0400] coderanger: I presume there are pacman and portage cookbooks
[2012-03-27 05:09:03 -0400] jtimberman: there's a pacman cookbook.
[2012-03-27 05:09:08 -0400] coderanger: jtimberman: Recipes aren't the issue, it is a library file in this case
[2012-03-27 05:09:16 -0400] coderanger: and those always load, regardless of runlist ...
[2012-03-27 05:09:33 -0400] coderanger: hence why I said that guards on recipes are purely bonus points if it is easy :-)
[2012-03-27 05:10:03 -0400] jtimberman: the level of assumption that is required in either case becomes cumbersome to maintain.
[2012-03-27 05:10:31 -0400] coderanger: Right now if you do `knife cookbook site install subversion` it will not work on any platform but windows, thats a bug in my book
[2012-03-27 05:11:01 -0400] coderanger: Fixing the windows cookbook works now, changing the loader to consider additional metadata has to wait for chef 11
[2012-03-27 05:11:11 -0400] coderanger: Choose your weapon :)
[2012-03-27 05:13:28 -0400] jtimberman: open a ticket
[2012-03-27 05:13:31 -0400] jtimberman: :)
[2012-03-27 05:13:50 -0400] coderanger: amccloud did :-) ^^
[2012-03-27 05:13:57 -0400] coderanger: and I just edited it to make it a bit clearer
[2012-03-27 05:15:03 -0400] Kwanasolis: jtimberman: passenger was updated upstream, caused cook-1133 (I think, remembering off the top of my head), I want to mod it a bit so on arch it checks for (and always) installs the latest version, should I bother?
[2012-03-27 05:15:44 -0400] jtimberman: coderanger: the windows cookbook's library should be patched to begin/rescue.
[2012-03-27 05:15:58 -0400] coderanger: jtimberman: That would work fine too :-)
[2012-03-27 05:16:13 -0400] jtimberman: Kwanasolis: can you set the passenger version attribute for the version you want?
[2012-03-27 05:16:29 -0400] jtimberman: thats the proper solution other than the supports metadata doing the right thing.
[2012-03-27 05:16:42 -0400] jtimberman: not hacking "if platform" conditionals in recipes.
[2012-03-27 05:17:03 -0400] bookpage: honestly, which is faster to setup and start writing manifests/recipes? puppet or chef.
[2012-03-27 05:17:04 -0400] Kwanasolis: jtimberman: arch is always going to have this issue a bit, since it tends to take 12.2 seconds to update upstream, its bit me twice in 6 weeks
[2012-03-27 05:17:31 -0400] Kwanasolis: I'm thinking of dumping arch, do you guys have a distro that ships with 1.9.3 to recommend?
[2012-03-27 05:18:11 -0400] jtimberman: Kwanasolis: you can set the attribute value in a role.
[2012-03-27 05:18:18 -0400] jtimberman: you don't have to modify the cookbook's attributes file.
[2012-03-27 05:19:24 -0400] Kwanasolis: yeah, just means everytime I update the os for packages, or role out a new node, I have to watch out for it
[2012-03-27 05:19:31 -0400] jtimberman: Yes.
[2012-03-27 05:19:33 -0400] jtimberman: :)
[2012-03-27 05:19:35 -0400] Kwanasolis: bah
[2012-03-27 05:19:41 -0400] Kwanasolis: :)
[2012-03-27 05:19:52 -0400] Kwanasolis: how bout I build a 'newest' flag?
[2012-03-27 05:19:53 -0400] jtimberman: Otherwise we have to update the cookbok every time there's a new version.
[2012-03-27 05:20:16 -0400] Kwanasolis: leave it default 3.0.7, but for us edgecases, we can just set 'newest' and be done with it
[2012-03-27 05:20:29 -0400] Kwanasolis: its 11 now btw :)
[2012-03-27 05:21:08 -0400] Kwanasolis: jtimberman: honestly thouhg, I'm starting to think arch isn't the right solution, too much stuff like this is coming up and I'm wasting time just making arch + chef work
[2012-03-27 05:21:24 -0400] jtimberman: Kwanasolis: thats one of the reasons i stopped using arch for my personal systems.
[2012-03-27 05:21:29 -0400] jtimberman: :)
[2012-03-27 05:21:42 -0400] Kwanasolis: right, but what distro actually ships with ruby 1.9.3?
[2012-03-27 05:21:44 -0400] jtimberman: I don't know of a Linux distribution that ships with 1.9.3.
[2012-03-27 05:21:50 -0400] Kwanasolis: or is the only solution really rvm or some other awful hack?
[2012-03-27 05:21:59 -0400] jtimberman: they're all pretty antagonistic against Ruby
[2012-03-27 05:22:11 -0400] Kwanasolis: cept arch ;)
[2012-03-27 05:22:14 -0400] jtimberman: build a ruby package with fpm and host it in your infra?
[2012-03-27 05:22:30 -0400] Kwanasolis: *sigh* yeah
[2012-03-27 05:23:13 -0400] erikh: arch packages are pretty easy to build as well
[2012-03-27 05:23:21 -0400] Kwanasolis: oh I know, I maintain a few
[2012-03-27 05:23:33 -0400] Kwanasolis: my other option is to 'fix' arch packages when they drift out of sync
[2012-03-27 05:23:44 -0400] erikh: that path lies madness
[2012-03-27 05:23:44 -0400] jtimberman: on ubuntu oneiric, ruby1.9.1 is 1.9.2.290-2.
[2012-03-27 05:23:54 -0400] jtimberman: so its not 1.9.3, but better than 1.8.
[2012-03-27 05:24:15 -0400] Kwanasolis: jtimberman: last ub I used was 10.04, one oniric, is it just 1.9.1 or is it 1.8.7 + like this hacky 1.9.1?
[2012-03-27 05:24:24 -0400] Kwanasolis: well, 290-2 is the head
[2012-03-27 05:24:27 -0400] jtimberman: looks like precise will have 1.9.3.0-1ubuntu1
[2012-03-27 05:24:32 -0400] Kwanasolis: no, one removed
[2012-03-27 05:24:40 -0400] erikh: awesome
[2012-03-27 05:24:43 -0400] erikh: 1.9.3 is pretty great.
[2012-03-27 05:24:53 -0400] Kwanasolis: I have 1.9.3p125, and it really isn't a 1.9.3 req
[2012-03-27 05:24:54 -0400] jtimberman: on debian and ubuntu, "1.9.1" refers to the ABI version, which 1.9.2 and 1.9.3 are compatible.
[2012-03-27 05:24:58 -0400] Kwanasolis: I'm sure any of the 1.9.x tree would work
[2012-03-27 05:25:38 -0400] Kwanasolis: yeah, so I think its 10.04 that just sucks
[2012-03-27 05:25:53 -0400] Kwanasolis: cause that's when I ditched ubuntu, and the automated build packages typically still install it (since its lts)
[2012-03-27 05:26:17 -0400] erikh: does anyone know how I can extract the executed (vs. just processed) resources out of a chef run in a report handler?
[2012-03-27 05:30:02 -0400] jtimberman: Kwanasolis: you may find this helpful: http://jtimberman.housepub.org/blog/2011/04/02/debian-ubuntu-package-for-ruby-1-9-2-with-fpm/
[2012-03-27 05:30:14 -0400] jtimberman: erikh: http://rubygems.org/gems/chef-handler-updated-resources
[2012-03-27 05:30:15 -0400] Kwanasolis: what is fpm? I though that was a typo
[2012-03-27 05:30:23 -0400] jtimberman: Kwanasolis: effin' package management.
[2012-03-27 05:30:24 -0400] Kwanasolis: you gotta stop this, I have too many new things to learn cause of you ;)
[2012-03-27 05:30:37 -0400] jtimberman: Kwanasolis: its a ruby script that will build a package out of a directory.
[2012-03-27 05:30:48 -0400] Kwanasolis: gotcha, that's awesome
[2012-03-27 05:30:51 -0400] amccloud: coderanger: thanks again!
[2012-03-27 05:30:52 -0400] Kwanasolis: almost like slackeware
[2012-03-27 05:30:53 -0400] jtimberman: we use it for chef-full built packages from our omnibus project.
[2012-03-27 05:31:04 -0400] jtimberman: fpm builds rpms, debs and i think solaris packages.
[2012-03-27 05:31:09 -0400] jtimberman: (I haven't looked in a while.
[2012-03-27 05:31:10 -0400] jtimberman: )
[2012-03-27 05:31:23 -0400] erikh: jtimberman: not that it's anywhere near done, but I'mma use that to power this: https://skitch.com/erikhollensbe/8pm4f/chef-dashboard-version-0.0.1
[2012-03-27 05:32:35 -0400] jtimberman: erikh: cool
[2012-03-27 05:37:49 -0400] Anand: Hi there, I want to know that is there any in build facility provided on opscode chef to monitor aws instances???
[2012-03-27 05:38:32 -0400] jtimberman: Anand: no, nor is that chef's purview.
[2012-03-27 05:38:45 -0400] jtimberman: Anand: chef is a configuration management engine and framework, not a monitoring tool.
[2012-03-27 05:39:06 -0400] jtimberman: you'd use it, for example, to install and configure a monitoring system agent.
[2012-03-27 05:39:11 -0400] jtimberman: like nagios nrpe or similar.
[2012-03-27 05:39:44 -0400] Kwanasolis: does have cookbooks for zenoss as well
[2012-03-27 05:39:56 -0400] Kwanasolis: but I think those are community based
[2012-03-27 05:40:42 -0400] Anand: hmm...i am about to use sensu framework for this...but just strick an Q. and ask here..
[2012-03-27 05:41:06 -0400] Anand: so there is not monitoring using opscode chef...on has to use external tool for that
[2012-03-27 05:41:09 -0400] Anand: right??
[2012-03-27 05:44:39 -0400] jtimberman: Anand: Yes.
[2012-03-27 05:44:56 -0400] jtimberman: You can use the data stored by the chef server to feed into your monitoring system.
[2012-03-27 05:45:10 -0400] jtimberman: For example we use nagios, and our nagios cookbook will populate configuration based on search.
[2012-03-27 05:45:55 -0400] Anand: ok.
[2012-03-27 05:47:14 -0400] Anand: thanks @jtimberman and kwanaolis
[2012-03-27 06:12:55 -0400] bendrix415: can chef install and deploy software from zip instead of yum or apt
[2012-03-27 06:24:00 -0400] jtimberman: bendrix415: sure, use an execute resource to run the unzip command, or write a lightweight resource & provider to abstract that.
[2012-03-27 06:31:19 -0400] ranjibd: ark?
[2012-03-27 06:31:28 -0400] BryanWB: ark!
[2012-03-27 06:33:07 -0400] ranjibd: BryanWB, do we have any wikipage on ark?
[2012-03-27 06:33:30 -0400] BryanWB: ranjibd: u mean chef wiki? not yet, just my readme
[2012-03-27 06:34:45 -0400] BryanWB: prefer to keep the readme as the main doc until if an when i can get it merged into opscode/chef
[2012-03-27 06:36:16 -0400] BryanWB: ranjibd: having any problems?
[2012-03-27 06:40:03 -0400] ranjibd: no.. then we can train bawt for quick help
[2012-03-27 06:40:09 -0400] ranjibd: many folks ask
[2012-03-27 06:42:45 -0400] BryanWB: ranjibd: am so ignorant ;) didn't even know bawt could do that
[2012-03-27 06:43:18 -0400] BryanWB: file?
[2012-03-27 06:43:18 -0400] bawt_: file is 100% empty
[2012-03-27 06:43:31 -0400] BryanWB: template?
[2012-03-27 06:43:31 -0400] bawt_: template is in templates
[2012-03-27 06:43:45 -0400] BryanWB: ranjibd: can u point me to a good example?
[2012-03-27 06:43:46 -0400] ranjibd: templates?
[2012-03-27 06:43:46 -0400] bawt_: templates is http://wiki.opscode.com/display/chef/Templates
[2012-03-27 06:43:53 -0400] ranjibd: resources?
[2012-03-27 06:43:54 -0400] bawt_: resources is http://wiki.opscode.com/display/chef/Resources
[2012-03-27 06:44:05 -0400] ranjibd: BryanWB?
[2012-03-27 06:44:06 -0400] BryanWB: ranjibd: ok, i create wiki page
[2012-03-27 06:44:12 -0400] ranjibd: ranjibd?
[2012-03-27 06:44:13 -0400] bawt_: ranjibd is right. somehow the nodes are now reporting their FQDN incorrectly...
[2012-03-27 06:44:16 -0400] ranjibd: fujin?
[2012-03-27 06:44:17 -0400] bawt_: fujin is the resident git ninja and looks cute with a neck beard
[2012-03-27 06:44:17 -0400] ranjibd: :-)
[2012-03-27 06:44:21 -0400] BryanWB: lol
[2012-03-27 06:44:49 -0400] Kwanasolis: lol
[2012-03-27 06:47:14 -0400] BryanWB: ranjibd: pls let me know what u think of ark once u spend some time w/ it
[2012-03-27 06:56:10 -0400] bendrix415: thanks jtimberman
[2012-03-27 06:58:21 -0400] bendrix415: how would I deploy a zipped file to a node, remote_file is depr, can i use cookbook_file to transfer to from a url
[2012-03-27 07:02:02 -0400] miah: remote_file is depr?
[2012-03-27 07:02:22 -0400] miah: pretty sure its not.
[2012-03-27 07:03:19 -0400] Mithrandir: it is for files which are in the cookbook
[2012-03-27 07:03:31 -0400] Mithrandir: but not in general, no
[2012-03-27 07:03:34 -0400] bendrix415: not yet but will be http://wiki.opscode.com/display/chef/Resources#Resources-CookbookFile
[2012-03-27 07:04:05 -0400] miah: i think you're reading that wrong bendrix415
[2012-03-27 07:04:17 -0400] bendrix415: im trying to deploy jetty from a zipfile instead of a package
[2012-03-27 07:04:27 -0400] BryanWB: miah: what are the main benefits of using haproxy 1.5 over 1.4?
[2012-03-27 07:04:54 -0400] Mithrandir: "In Chef 0.8.x and earlier, Remote File is also used to fetch files from the files/ directory in a cookbook. This behavior is now provided by Cookbook File, and use of Remote File for this purpose is deprecated (though still valid) in Chef 0.9.0 and later."
[2012-03-27 07:05:12 -0400] bendrix415: miah, yes i see know
[2012-03-27 07:05:14 -0400] bendrix415: now
[2012-03-27 07:06:15 -0400] miah: BryanWB: apart from bug fixes you can share stick tables across haproxy peers
[2012-03-27 07:07:27 -0400] miah: also, PROXY Protocol support
[2012-03-27 07:07:33 -0400] miah: which we needed for stud
[2012-03-27 07:08:02 -0400] BryanWB: miah: ok, that sounds like a big win. and stud is significantly better than stunnel?
[2012-03-27 07:08:56 -0400] miah: yes
[2012-03-27 07:09:22 -0400] BryanWB: miah: tks!
[2012-03-27 07:09:26 -0400] miah: http://blog.exceliance.fr/2011/09/16/benchmarking_ssl_performance/
[2012-03-27 07:39:56 -0400] BryanWB: ark?
[2012-03-27 07:43:44 -0400] BryanWB: ark?
[2012-03-27 07:47:31 -0400] BryanWB: ark?
[2012-03-27 07:49:28 -0400] amccloud: am I SOL?
[2012-03-27 07:50:58 -0400] BryanWB: amccloud: to dump data bags to file   knife data bag show <db_name> -Fj
[2012-03-27 07:51:58 -0400] BryanWB: for cookbkooks don't know
[2012-03-27 07:52:08 -0400] BryanWB: but they are likely cached on your nodes
[2012-03-27 07:52:43 -0400] amccloud: BryanWB: It's not just data bags. Everything just ended up in an odd state. .chef directory is missing, some cookbooks are missing, data bags are missing, etc.
[2012-03-27 07:52:50 -0400] amccloud: I really have no clue what happened.
[2012-03-27 07:53:11 -0400] coderanger: All the data is there, not sure if there are scripts to pull the cookbooks back in the normal format though
[2012-03-27 07:54:14 -0400] amccloud: Well I still see everything on the chef server. Just talking about locally
[2012-03-27 07:54:24 -0400] amccloud: my working directory
[2012-03-27 07:58:25 -0400] amccloud: I was a few moments from actually deploying something with chef and then I shot myself in the foot :( I was trying to debug an issue with python_virtualenv resource and thought switching back to chef-solo would be fast.
[2012-03-27 07:58:38 -0400] Kwanasolis: ok, this is cool, require 'pry';binding.pry works inside of shef -z;recipe
[2012-03-27 08:00:46 -0400] lorewarden: Hello! Has anyone had issues with the java recipe recently? Seems Oracle now checks for a browser cookie when downloading the JDK, see https://edelivery.oracle.com/otn-pub/java/jdk/6u31-b04/jdk-6u31-linux-x64.bin
[2012-03-27 08:01:29 -0400] BryanWB: lorewarden: fuck
[2012-03-27 08:01:51 -0400] flaccid: i hate that stuff
[2012-03-27 08:01:55 -0400] coderanger: amccloud: I think you somehow managed to type a literal backspace character into your IRC client
[2012-03-27 08:01:56 -0400] lorewarden: the cookie is set when you accept the license
[2012-03-27 08:02:00 -0400] coderanger: impressive :)
[2012-03-27 08:02:14 -0400] BryanWB: lorewarden: those bastards
[2012-03-27 08:02:22 -0400] BryanWB: i put a lot of work into that recipe
[2012-03-27 08:02:36 -0400] lorewarden: it worked great, thanks
[2012-03-27 08:02:53 -0400] flaccid: prop stuff aint suited for the new world
[2012-03-27 08:08:15 -0400] amccloud: coderanger: Idk how but I managed to get things back with some git hackery
[2012-03-27 08:08:28 -0400] BryanWB: lorewarden: u can get around it by overriding the url
[2012-03-27 08:08:36 -0400] BryanWB: node[
[2012-03-27 08:09:10 -0400] BryanWB: node['java'][jdk']['7'][x86_64] = 'http://your_local_server/java_tarball.tar.gz'
[2012-03-27 08:09:33 -0400] lorewarden: BryanWB: thanks, I will do that
[2012-03-27 08:09:46 -0400] BryanWB: sorry, node['java'][jdk']['6']['x86_64']['url'] = 'http://your_local_server/java_tarball.tar.gz'
[2012-03-27 08:10:15 -0400] lorewarden: BryanWB: could it point to a local file instead of a URL?
[2012-03-27 08:11:24 -0400] BryanWB: lorewarden: don't know, i use remote_file to grab it, don't know if remote_file can handle local paths
[2012-03-27 08:11:51 -0400] lorewarden: BryanWB: no problem, I'll just host it somewhere
[2012-03-27 08:12:14 -0400] lorewarden: BryanWB: and thanks, much appreciated
[2012-03-27 08:12:15 -0400] BryanWB: don't think so
[2012-03-27 08:19:18 -0400] BryanWB: lorewarden: ur welcome
[2012-03-27 08:34:19 -0400] saykyo: hi everyone, I am trying to get my head around chef and I'm not able to find an answer for this simple question - is it possible to wake a chef-client when a cookbook on the server has been updated with new instructions, e.g. so that I don't have to wait until the default 30 minutes kick in ?
[2012-03-27 08:34:38 -0400] amccloud: coderanger: this is the issue I mentioned with python_virtualenv earlier. https://gist.github.com/b722d180850e246c8bc2
[2012-03-27 08:35:15 -0400] coderanger: amccloud: My brain is too tired to look right now, ping me tomorrow :-)
[2012-03-27 08:35:30 -0400] coderanger: (also I have a big pile of commits to review before I can sleep)
[2012-03-27 08:36:05 -0400] amccloud: ah okay no problem. will do.
[2012-03-27 08:45:24 -0400] zts: saykyo: not from within chef, no - the chef server doesn't push out instructions to the chef client
[2012-03-27 08:45:50 -0400] zts: saykyo: but you could use some other method to run chef on the client when it's required, instead of waiting
[2012-03-27 08:46:40 -0400] saykyo: zts: so basically, if I want to push the policy asynchronously, I have to loop all the servers and trigger it manually. Okay, thanks.
[2012-03-27 08:48:17 -0400] coderanger: knife ssh is an easy way to do that
[2012-03-27 08:48:35 -0400] coderanger: saykyo: fabric or RunDeck are more complex, but offer more control than knife ssh
[2012-03-27 08:48:47 -0400] zts: saykyo: depends on what you call "manual" I guess :)  We use mcollective to broadcast a message saying "run chef now", to the machines that we want to run immediately
[2012-03-27 08:49:37 -0400] saykyo: zts: manual, as in not-included-in-chef-by-default :-)
[2012-03-27 08:51:33 -0400] saykyo: I am testing chef out, so having to wait 30 minutes before I can see if my policy had been applied is a bit restrictive, and I am lazy to restart the client on the testing machines :)
[2012-03-27 08:52:19 -0400] saykyo: so I was hoping I can trigger a refresh using a built-in functionality in chef, no big deal
[2012-03-27 08:52:21 -0400] zts: as coderanger said, knife ssh is an easy way to do that (so long as you have SSH key auth setup for your machines)
[2012-03-27 08:52:30 -0400] coderanger: saykyo: Long-polling is on the list
[2012-03-27 08:52:34 -0400] coderanger: probably not for chef 11
[2012-03-27 08:52:46 -0400] coderanger: but in The Future (::spookymusic::)
[2012-03-27 08:52:52 -0400] saykyo: :-D
[2012-03-27 08:52:57 -0400] coderanger: Of course if you submit a patch, it would happen sooner ;-)
[2012-03-27 08:53:17 -0400] coderanger: Moving the backend to erlang makes it much easier though, HTTP long-polling on sinatra is ... unfortunate
[2012-03-27 08:54:00 -0400] coderanger: Part of the problem is given company firewalls and general security sanity, it still can't be an actual push system like mcollective or fabric
[2012-03-27 08:54:36 -0400] coderanger: So I think the plan is during the $INTERVAL wait it will sit on an HTTP long-poll connection so the server can send a wakeup package to run earlier
[2012-03-27 08:54:45 -0400] saykyo: coderanger: I'd love to contribute, but I fear my meddling wouldn't do much good, given my complete lack of ruby knowledge whatsoever
[2012-03-27 08:55:12 -0400] coderanger: saykyo: I barely know Ruby and it has never stopped me :-)
[2012-03-27 08:55:33 -0400] saykyo: coderanger: that's exactly how I hope it would work, since chef's API is restfull and all
[2012-03-27 08:56:24 -0400] coderanger: Heh, not sure thats really REST, but something like an HTTP implementation of IMAP's IDLE command
[2012-03-27 08:57:37 -0400] zts: coderanger: maybe it's semantics, but note that the only "pushing" in mcollective is from the server to the message broker it's attached to.  We're using it specifically because of its network footprint vs ssh-based transports
[2012-03-27 08:57:52 -0400] zts: coderanger: I'd love to see something built into Chef though :)
[2012-03-27 08:58:33 -0400] coderanger: zts: You get a company IT director to open the firewall for AMQP and I'll be the queen of england ;-)
[2012-03-27 08:59:07 -0400] zts: coderanger: oh hah.  Sorry, yeah, I was momentarily ignoring the existence of hosted chef :)
[2012-03-27 08:59:39 -0400] coderanger: communitysite4lyfe
[2012-03-27 08:59:46 -0400] zts: w0rd
[2012-03-27 09:00:00 -0400] coderanger: Oh, thats why I'm so loopy, its 2AM, wooooo
[2012-03-27 09:00:23 -0400] coderanger: 11 more commits to review, and even then inbox zero will escape me for another evening
[2012-03-27 09:06:26 -0400] saykyo: coderanger: some come over here, it's 11 AM where I'm at :-) No, really, good luck!
[2012-03-27 11:09:34 -0400] Axsuul: Is there any way to check if a user exists?
[2012-03-27 11:25:58 -0400] BryanWB: Axsuul: yes
[2012-03-27 11:26:34 -0400] BryanWB: there is a ruby module for checking entries in /etc/passwd
[2012-03-27 11:31:17 -0400] BryanWB: ark?
[2012-03-27 11:31:55 -0400] BryanWB: ranjibd: dude, anything special i have to do to train bawt? the wiki page is there http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:32:18 -0400] ranjibd: ark is http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:32:20 -0400] ranjibd: ark?
[2012-03-27 11:32:21 -0400] bawt_: ark is http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:32:23 -0400] ranjibd: :-)
[2012-03-27 11:32:35 -0400] BryanWB: ranjibd: ah, I have to teach it ;)
[2012-03-27 11:32:38 -0400] BryanWB: ranjibd: tks
[2012-03-27 11:32:40 -0400] BryanWB: ark?
[2012-03-27 11:32:40 -0400] bawt_: ark is http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:32:41 -0400] ranjibd: indeed
[2012-03-27 11:33:16 -0400] ranjibd: tarball?
[2012-03-27 11:33:16 -0400] bawt_: tarball is http://github.com/opscode/chef/tarball/master
[2012-03-27 11:33:23 -0400] ranjibd: tarball_install?
[2012-03-27 11:33:30 -0400] ranjibd: tarball_install is also ark
[2012-03-27 11:33:32 -0400] ranjibd: tarball_install?
[2012-03-27 11:33:32 -0400] bawt_: tarball_install is ark
[2012-03-27 11:34:08 -0400] BryanWB: hmm, i would have preferred to point to the github page
[2012-03-27 11:34:23 -0400] ranjibd: u can relearn bawt
[2012-03-27 11:34:47 -0400] BryanWB: ark is https://github.com/bryanwb/chef-ark
[2012-03-27 11:34:49 -0400] BryanWB: ark?
[2012-03-27 11:34:49 -0400] bawt_: ark is http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:34:56 -0400] BryanWB: ark?
[2012-03-27 11:34:56 -0400] bawt_: ark is http://wiki.opscode.com/display/chef/Ark
[2012-03-27 11:36:17 -0400] ranjibd: wait ... fujin had showed me how to do it,.. i need to recall
[2012-03-27 12:12:48 -0400] Guest94490: Hi, i'm using chef server 0.10.4. I'm using environment files to set attributes per-environment. One thing I've noticed is that a lot of URLs I'm defining create repetition/redundancy - ie i might define different attributes as "test4.mydomain", "ssl.test4.mydomain", "static.test4.mydomain". Is it possible to have nesting of attributes, in that I eg define "test4" as one attribute per env and then reference that from other attributes?
[2012-03-27 13:12:21 -0400] trkemist: Is there a quick way to learn Chef?
[2012-03-27 13:16:56 -0400] drrk: there are a anumber of fast start guides on the wiki
[2012-03-27 13:17:15 -0400] drrk: http://wiki.opscode.com/display/chef/Build+a+LAMP+Stack is a nice one that uses Amazon EC2
[2012-03-27 13:22:58 -0400] trkemist: drrk => Thanks!
[2012-03-27 13:25:39 -0400] johnnyg33: Anybody else having trouble with Rackspace? Ohai is not finding my server as a Rackspace nodeâ€¦ and I know why!
[2012-03-27 13:27:33 -0400] johnnyg33: Seems that the Rackspace plugin is looking for a certain set of MAC addresses, and unless your server has made an offsite query (yum, wget, curl, etc), the eth0 interface has no ARP queries in its history
[2012-03-27 13:27:55 -0400] johnnyg33: This causes ohai to decide that it's not a rackspace server
[2012-03-27 13:36:25 -0400] johnnyg33: Now, unfortunately, it looks like Rackspace may have added a new MAC address, so we'll need to add it to the list.
[2012-03-27 13:37:17 -0400] ajardan_: hello, anyone available and willing to help me with an LWRP resource :)?
[2012-03-27 13:42:02 -0400] ajardan_: so I will just say whan I'm trying to do and hope
[2012-03-27 13:42:28 -0400] ajardan_: I'm creating an LWRP resource which needs to get minutes, hour, day, week, etc, as the cron resource
[2012-03-27 13:42:51 -0400] ajardan_: so I need to validate that minutes attribute isn't greater than 60
[2012-03-27 13:43:19 -0400] ajardan_: attribute :minutes, :kind_of => Integer is kind of too big
[2012-03-27 13:43:34 -0400] ajardan_: using regexp is also weird
[2012-03-27 13:43:44 -0400] ajardan_: any other possibilities ?
[2012-03-27 13:44:00 -0400] atomic-penguin: ajardan_, so the existing Cron resource doesn't fit your use case? http://wiki.opscode.com/display/chef/resources#Resources-Cron
[2012-03-27 13:44:43 -0400] ajardan_: yes, it looks great, but I need to implement something else - not cron
[2012-03-27 13:50:03 -0400] yfeldblum_: ajardan_, look at the implementation for Chef::Resource::Cron: https://github.com/opscode/chef/blob/master/chef/lib/chef/resource/cron.rb
[2012-03-27 13:52:12 -0400] johnnyg33: The MAC address is only different in the last octet, would it be best to test up to the last 8 bits, or to add a whole new test?
[2012-03-27 13:55:01 -0400] ajardan_: yfeldblum_: of course I can use that one, but is there a way to make those checks in the lightweight version ?
[2012-03-27 13:55:11 -0400] ajardan_: and avoid all that ruby-ish stuff :)
[2012-03-27 13:55:47 -0400] johnnyg33: (::four-letter-worded::) Rackspace forced us to reboot all of our servers last weekend, causing no end of headaches and lost sleep, now their infrastructure is just slightly different. Just what I needed...
[2012-03-27 14:07:35 -0400] ssd7_: OHai Chefs
[2012-03-27 14:08:51 -0400] zts: ajardan_: you want the :callbacks type of attribute
[2012-03-27 14:08:57 -0400] zts: but that's still going to be ruby :)
[2012-03-27 14:10:07 -0400] ajardan_: zts, hmm, lemme take a look
[2012-03-27 14:10:40 -0400] zts: ajardan_: documented on http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+(LWRP) but sadly lacking an example
[2012-03-27 14:10:53 -0400] zts: ajardan_: ...at this point, I should note that I haven't used it, so don't shoot me if it doesn't work for you :)
[2012-03-27 14:11:20 -0400] ajardan_: :) lol
[2012-03-27 14:11:30 -0400] ajardan_: thanks anyway, that's better than nothing
[2012-03-27 14:12:01 -0400] specialsauce: Hi, i'm using chef server 0.10.4. I'm using environment files to set attributes per-environment. One thing I've noticed is that a lot of URLs I'm defining create repetition/redundancy - ie i might define different attributes as "test4.mydomain", "ssl.test4.mydomain", "static.test4.mydomain". Is it possible to have nesting of attributes, in that I eg define "test4" as one attribute per env and then reference that from other attributes?
[2012-03-27 14:12:59 -0400] johnnyg33: special_sauce: node[node[:attribute1]] ?
[2012-03-27 14:16:26 -0400] specialsauce: johnnyg33: woah, why would the attribute be available using that syntax??
[2012-03-27 14:18:25 -0400] ajardan_: zts, yeah, an example of that stuff would save me a lot of time huh, need to take a look at chef sources to understand what happens
[2012-03-27 14:21:09 -0400] zts: ajardan_: yeah, I've had a poke around to try to find it being used somewhere, but no dice.  If you figure it out, could you please comment on the LWRP wiki page with an example?  I'm sure I'll need it before long :)
[2012-03-27 14:25:19 -0400] yfeldblum_: ajardan_, just use the normal `def hour(arg=nil) ... end` format for normal ruby method definitions, which is what the lightweight DSL expands out into anyway, from right there in your LW resource file (you don't need to use the module/class keywords/scopes)
[2012-03-27 14:30:38 -0400] rshade98: if I include_recipe will that execute the recipe
[2012-03-27 14:31:25 -0400] rshade98: or do I need to execute "cookbook::recipe" also?
[2012-03-27 14:37:30 -0400] johnnyg33: special_sauce: I used to use that before they came out with the environments, now you'd use node[node.chef_environment][:url], or some suchâ€¦ if attr1 = 'url' or 'ssl_url' or 'test_url', you could use node[node.chef_environment][node[:attr1]]  â€” Environment would need staging => { :url => 'test4', :ssl_url => 'ssl_test4', :test_url => 'test_this' }    â€” of course, it's been a while since I did that, YMMV.
[2012-03-27 14:44:45 -0400] sampikesley: OK, I have a particularly directory tree I need to set up for a given app. Different apps have different trees. It's something like '/var/www/apps/myapp/shared/crypto, /var/www/apps/myapp/shared/pids, whatever'. I have a cookbook for creating these trees, which is fed by a hash per app. Where would you put these hashes? In the role? A data bag? I there any notion of Best Practice for this kind of stuff?
[2012-03-27 14:54:58 -0400] specialsauce: sampikesley, there seems to be a few ebst practices, but I believe data bags allow you to store this kind of stuff encrypted, which isn't an issue here but may be for some other values you will want to add, so that might be best? someone can probably correct if this isn't true
[2012-03-27 14:55:35 -0400] jordandm: sampikesley: If things vary by environment, I would use a data bag. If you want to be able to add apps without touching the cookbook source, I would use a data bag.
[2012-03-27 14:56:10 -0400] sampikesley: :)
[2012-03-27 14:56:46 -0400] jordandm: sampikesley: That is what this list exists to do...
[2012-03-27 15:05:25 -0400] sampikesley: I'm starting to think that data bags will become my default option unless I have a compelling reason to do otherwise
[2012-03-27 15:07:49 -0400] fearoffish: anyone here use the rbenv or rvm cookbooks and have recommendations/advice on which to use?
[2012-03-27 15:07:51 -0400] pwelch: @sampikesley I have been trying to use databags as much as possible. For reasons @jordandm pointed out.
[2012-03-27 15:08:29 -0400] pwelch: @fearoffish this is the rvm cookbook I use: https://github.com/fnichol/chef-rvm
[2012-03-27 15:08:35 -0400] jordandm: pwelch: If you are pushing for data driven designs, then data bags make a lot of sense.
[2012-03-27 15:08:57 -0400] fearoffish: I'm currently trying out the rbenv one, pwelch
[2012-03-27 15:09:15 -0400] jordandm: pwelch: I believe that data bags and environments are highly under used and under rated in Chef development.
[2012-03-27 15:09:21 -0400] fearoffish: having issues :-/
[2012-03-27 15:10:04 -0400] pwelch: @jordandm I like the idea of cookbooks being usable by others and then applying stuff specific for your environment with override_attributes and databags
[2012-03-27 15:10:12 -0400] jordandm: fearoffish: I wouldn't use rbenv, I would use rvm.
[2012-03-27 15:10:14 -0400] pwelch: i am redoing my nagios install based on the updated cookbook
[2012-03-27 15:10:19 -0400] fearoffish: jordandm: any reason?
[2012-03-27 15:10:42 -0400] pwelch: someone pushed a huge update which means you can put a lot of environment specifics in data bags. HUGE improvement
[2012-03-27 15:11:00 -0400] jordandm: My experience with rvm has been by and large positive and there is a large community of folks who use it I can ask for help if I run into problems.
[2012-03-27 15:11:12 -0400] pwelch: I had issues with several rvm recipes but I found fnichol's and he seems to have covered a lot of stuff i didn't even thing about
[2012-03-27 15:11:32 -0400] pwelch: agreed, rvm has a huge following right now. easier to look for answers
[2012-03-27 15:11:39 -0400] jordandm: pwelch: There is an updated Nagios cookbook? Will have to check it out. Have you looked at Sensu as an alternative?
[2012-03-27 15:11:41 -0400] fearoffish: tbh, I've tried both, and they both gave me issues, but I think the rvm one was because I didn't bootstrap under 1.9, and wanted to use the cookbook to move chef into it
[2012-03-27 15:11:54 -0400] pwelch: pwelch << still not good at environments =(
[2012-03-27 15:12:04 -0400] fearoffish: my issue with rbenv was the cookbook, and execute not running as the real rbenv user
[2012-03-27 15:12:10 -0400] pwelch: @jdordanm no i have not
[2012-03-27 15:12:12 -0400] fearoffish: it's something that might pop up under rvm
[2012-03-27 15:12:49 -0400] afallows: Quick question, real simple. On the wiki page for manual install, there is an instruction "sudo gem install chef-server chef-server-api chef-server -shef-solr" <-- is chef-server supposed to be repeated there? Should that be another gem name or is it just redundant?
[2012-03-27 15:12:53 -0400] jordandm: pwelch: I would strongly recommend it. You can easily use Nagios plugins, but it provides a much more dynamic way to work with things.
[2012-03-27 15:12:59 -0400] fearoffish: jordandm: so, you bootstrap under the ruby you wantâ€¦and install the rvm cookbook.  How do you use rvm as a user once it's done, is it a system-wide install so it just works for all rvm group users?
[2012-03-27 15:13:11 -0400] pwelch: @jordanm have you used plugins with the nagios cookbook at all?
[2012-03-27 15:13:20 -0400] jordandm: fearoffish: You can set up to use itâ€¦.
[2012-03-27 15:13:31 -0400] jordandm: pwelch: No. I haven't.
[2012-03-27 15:13:47 -0400] pwelch: @fearoffish, i know i seem to be pushing it a lot but fnichol's rvm cookbook allows you to list the users in an override_attribute
[2012-03-27 15:13:53 -0400] fearoffish: jordandm: and does the normal gem_package resource 'just work' after that?
[2012-03-27 15:13:54 -0400] pwelch: thats how I am using it in production
[2012-03-27 15:14:02 -0400] fish_: I need to tweek my hilighting :(
[2012-03-27 15:14:38 -0400] jordandm: fearoffish: Are you trying to use all of this as part of a cookbook, prior to it being installed?
[2012-03-27 15:15:10 -0400] jordandm: You may be run into issues with where you are in the chef lifecycle.
[2012-03-27 15:15:12 -0400] fearoffish: jordandm: no, my bootstrap will handle installing rvm, what I'm wanting to know is how to install gems etc. with chef after
[2012-03-27 15:15:14 -0400] pwelch: @jordandm I was trying to see the best approach to setting up plug-ins for monitoring with the cookbook. Look likes it an issue that hasn't been tackled yet
[2012-03-27 15:15:44 -0400] fearoffish: jordandm: I'm not going down the 'install chef, then chef installs ruby and then reinstalls chef' route
[2012-03-27 15:15:57 -0400] jordandm: jtimberman: Explained this to me in-depth - and I believe he has a write up on the web site - that helped me to understand many of the issues I was encountering. I would recommend digging it up fearoffish  and reading it.
[2012-03-27 15:16:09 -0400] fearoffish: got it, looking it up now, thanks
[2012-03-27 15:17:15 -0400] nacer: BryanWB:  how does it go ?
[2012-03-27 15:17:24 -0400] fearoffish: pwelch: is the resource 'patched' by rvm so gems install into the correct ruby?
[2012-03-27 15:17:45 -0400] BryanWB: nacer: u know ;)
[2012-03-27 15:17:51 -0400] pwelch: @fearoffish: that i am unsure sorry :(
[2012-03-27 15:18:02 -0400] BryanWB: did u see my fix in message to chef ml?
[2012-03-27 15:18:14 -0400] nacer: BryanWB: no, my bad i don't read the ml :)
[2012-03-27 15:18:20 -0400] BryanWB: can download it w/ watir and xvfb, but very extreme
[2012-03-27 15:19:02 -0400] jordandm: fearoffish: Yes, that is the "sideway install".
[2012-03-27 15:19:15 -0400] jordandm: fearoffish: Sorry, I was thinking of something else.
[2012-03-27 15:19:18 -0400] fearoffish: jordandm: the whaaaa?
[2012-03-27 15:19:53 -0400] nacer: BryanWB: ouch it's not looking good
[2012-03-27 15:20:21 -0400] jordandm: fearoffish: Ignore the man who just got up and is hitting IRC. A sideway install is when you want to be able to use a ruby gem in a recipe when you have just installed it.
[2012-03-27 15:20:23 -0400] hoover_damm: fearoffish, still not using 1.9?
[2012-03-27 15:20:24 -0400] nacer: BryanWB: i think we need a ruby lib for doing the stuff you do with firefox
[2012-03-27 15:20:41 -0400] BryanWB: there is ruby code there, take a look
[2012-03-27 15:20:47 -0400] jordandm: fearoffish: If you can move to 1.9, I would do it.
[2012-03-27 15:20:54 -0400] nacer: BryanWB: we do that a lot in my company but in java
[2012-03-27 15:20:55 -0400] fearoffish: hoover_damm: absolutely, my boottrap uses 1.9.3-rc1 ;-0
[2012-03-27 15:21:02 -0400] fearoffish: bootstrap*
[2012-03-27 15:21:08 -0400] fearoffish: all apps are 1.9.3
[2012-03-27 15:21:09 -0400] hoover_damm: fearoffish, I made a omnibus full installer with 1.9.3 p125
[2012-03-27 15:21:17 -0400] mvisich: Hello, I had a question on how to use enviroments. I am trying to run something like If you have a test env drop a certain config. If your production then drop a different config. My code looks like this. case node[:environment]  when "test","snapshot" ( do something) when "production" (do something else). Is it possible to use the node[:envirment] like that? or is there a different way?
[2012-03-27 15:21:22 -0400] fearoffish: I haven't dug into omnibus yet
[2012-03-27 15:21:28 -0400] jordandm: hoover_damm: Pointer to your Omnibus Installer?
[2012-03-27 15:21:30 -0400] hoover_damm: fearoffish, I haven't gotten off my butt to make a Ubuntu 1.9.3 PPA
[2012-03-27 15:21:33 -0400] nacer: BryanWB: yeah but can't use a other browser like w3m ?
[2012-03-27 15:21:33 -0400] fearoffish: it scared me and I don't know whyâ€¦.oh yeah, it is java
[2012-03-27 15:21:34 -0400] hoover_damm: but i'm about to
[2012-03-27 15:21:37 -0400] hoover_damm: jordandm, you can build your own
[2012-03-27 15:21:44 -0400] hoover_damm: jordandm, github.com/damm/omnibus
[2012-03-27 15:21:47 -0400] hoover_damm: jordandm, check out the branch in there
[2012-03-27 15:22:05 -0400] nacer: BryanWB: i look for stuff like and came back to you
[2012-03-27 15:22:14 -0400] hoover_damm: and you can nudge btm and ask them why omnibus isn't updated to 1.9.3 and why they closed my pull :|
[2012-03-27 15:22:57 -0400] jordandm: hoover_damm: I can do that as well :-)
[2012-03-27 15:23:42 -0400] hoover_damm: but yeah I gotta basically write a ruby 1.9.3 with libyaml
[2012-03-27 15:23:47 -0400] hoover_damm: I was debating just grabbing it from sid and rebuilding it
[2012-03-27 15:24:08 -0400] hoover_damm: ppa
[2012-03-27 15:24:18 -0400] fearoffish: okay, reading about omnibus now
[2012-03-27 15:24:27 -0400] fearoffish: any useful article links are welcome :)
[2012-03-27 15:24:36 -0400] fearoffish: like "how to get started for stupid people"
[2012-03-27 15:24:59 -0400] hoover_damm: if your clojure fobic/java fobic
[2012-03-27 15:25:02 -0400] hoover_damm: really the README is all yu need
[2012-03-27 15:25:17 -0400] hoover_damm: install java, install lennigan, lein deps, leiin run
[2012-03-27 15:25:30 -0400] hoover_damm:  sudo lein run --project-name "chef-full" --bucket-name FULL_STACK --s3-access-key "ACCESS_KEY" --s3-secret-key "SECRET_KEY"
[2012-03-27 15:25:36 -0400] hoover_damm: isall you need to run in order to build it
[2012-03-27 15:25:40 -0400] knuckolls: fearoffish: i learned chef about a year ago, but at the time i just ended up giving up and printing out the entire wiki and reading it cover to cover. it was tedious but worth it. so worth it.
[2012-03-27 15:25:47 -0400] hoover_damm: it'll build installer shell scripts, and a deb
[2012-03-27 15:25:54 -0400] hoover_damm: and upload those to the bucket for you
[2012-03-27 15:26:04 -0400] knuckolls: fearoffish: i wish i had done that first instead of trying to hobble together info from blog posts.
[2012-03-27 15:26:04 -0400] hoover_damm: then you just need to modify a bootstrap to use it
[2012-03-27 15:26:09 -0400] fearoffish: knuckolls: I know Chef, I'm talking about omnibus, but thatnk you :)
[2012-03-27 15:26:22 -0400] knuckolls: fearoffish: ah, that's what i get for popping into a conversation ;)
[2012-03-27 15:26:45 -0400] fearoffish: hoover_damm: ahh, that's funny
[2012-03-27 15:26:45 -0400] hoover_damm: my lame bootstrap
[2012-03-27 15:26:46 -0400] hoover_damm: https://gist.github.com/8db95cacc818ba2b882a
[2012-03-27 15:26:58 -0400] mvisich: Hello, I had a question on how to use enviroments. I am trying to run something like If you have a test env drop a certain config. If your production then drop a different config. My code looks like this. case node[:environment]  when "test","snapshot" ( do something) when "production" (do something else). Is it possible to use the node[:envirment] like that? or is there a different way?
[2012-03-27 15:27:00 -0400] fearoffish: I've basically been building a bootstrap with a similar idea
[2012-03-27 15:27:03 -0400] hoover_damm: then you can knife bootstrap --distro myfullbootstrap
[2012-03-27 15:27:14 -0400] fearoffish: hoover_damm: using s3 for tarred up version of things that take forever to install :)
[2012-03-27 15:27:15 -0400] hoover_damm: fearoffish, the nice part was it made moving to this super easy
[2012-03-27 15:27:19 -0400] hoover_damm: we basically re-bootstrapped the whole thing
[2012-03-27 15:27:22 -0400] fearoffish: reading the readme now
[2012-03-27 15:27:25 -0400] fearoffish: thanks
[2012-03-27 15:27:26 -0400] hoover_damm: god I bet
[2012-03-27 15:27:34 -0400] jordandm: Well, dropping off until I get to the office. Catch you all later.
[2012-03-27 15:27:37 -0400] hoover_damm: I've only done the deb
[2012-03-27 15:27:48 -0400] hoover_damm: I still run Gentoo though
[2012-03-27 15:27:49 -0400] hoover_damm: obviously
[2012-03-27 15:28:21 -0400] nacer: BryanWB: http://mechanize.rubyforge.org/EXAMPLES_rdoc.html
[2012-03-27 15:28:42 -0400] hoover_damm: fearoffish, omnibus reminds me of a super bloated resin
[2012-03-27 15:28:44 -0400] hoover_damm: LOL
[2012-03-27 15:28:56 -0400] fearoffish: haha
[2012-03-27 15:29:17 -0400] hoover_damm: https://github.com/damm/omnibus/tree/CHEF-2871/source
[2012-03-27 15:29:20 -0400] hoover_damm: it seriously compiled all that
[2012-03-27 15:29:51 -0400] knuckolls: what are the best practices for keeping cookbooks isolated and reusable? is librarian becoming reasonably standard within the chef community?
[2012-03-27 15:29:53 -0400] hoover_damm: jre, db, couchdb, erlang, automake, libiconv, libtool
[2012-03-27 15:29:55 -0400] hoover_damm: mini distro
[2012-03-27 15:29:56 -0400] nacer: BryanWB: i will try with that tonight (if my wife let me )
[2012-03-27 15:31:11 -0400] fearoffish: knuckolls: I quite like it
[2012-03-27 15:31:15 -0400] fearoffish: along with sprk
[2012-03-27 15:31:23 -0400] fearoffish: knife-spork*
[2012-03-27 15:31:32 -0400] knuckolls: fearoffish: first i've heard of spork
[2012-03-27 15:31:40 -0400] fearoffish: a plugin for team collaborating
[2012-03-27 15:31:51 -0400] knuckolls: fearoffish: oh something i need badly :D
[2012-03-27 15:32:54 -0400] hoover_damm: neat
[2012-03-27 15:33:15 -0400] knuckolls: fearoffish: does librarian have anything for dependency management? whereas one cookbook relies on others, etc
[2012-03-27 15:33:16 -0400] hoover_damm: knuckolls, Librarian is pretty much a standard with one of my clients
[2012-03-27 15:33:24 -0400] hoover_damm: yes
[2012-03-27 15:33:29 -0400] hoover_damm: it builds a whole dependency tree
[2012-03-27 15:33:34 -0400] afallows: Hi guys - I'm having trouble getting a server up and running. I've been following the Manual Install guide, and I'm up to starting the indexer (Chef 0.10.8). I'm getting a gem related error. http://pastebin.com/jPiF2JDW
[2012-03-27 15:33:41 -0400] hoover_damm: so if you specify cookbook 'redis' it will pull in the redis cookbook and all it's dependencies
[2012-03-27 15:33:49 -0400] knuckolls: as denoted in the metadata.rb?
[2012-03-27 15:33:52 -0400] hoover_damm: right
[2012-03-27 15:34:06 -0400] fearoffish: knuckolls: yes, it's basically bundler for Chef
[2012-03-27 15:34:38 -0400] knuckolls: my ignorance will show here, do the metadata.rb depencencies let me point to specific github repos?
[2012-03-27 15:34:38 -0400] fearoffish: it does :git (with refs, branches and tags), :path (for local path locations) and more
[2012-03-27 15:34:44 -0400] knuckolls: ah
[2012-03-27 15:35:11 -0400] fearoffish: knuckolls: if you need a specific dependency, put it in the Cheffile instead of relying on the dependency management
[2012-03-27 15:36:33 -0400] knuckolls: it's been a solid 6 months since i kept up with the tooling surrounding chef, are there any more little gems like librarian and spork i should be aware of?
[2012-03-27 15:36:56 -0400] fearoffish: check out the wiki page for community plugins, there are some useful ones
[2012-03-27 15:36:58 -0400] afallows: I'm getting 'could not find gem-name (>=0) amongst []'-type errors for all chef gems, apparently.
[2012-03-27 15:37:02 -0400] fearoffish: those are the only 2 I use right now
[2012-03-27 15:37:38 -0400] knuckolls: fearoffish: yeah this page is exactly what i was looking for. thanks.
[2012-03-27 15:37:40 -0400] sampikesley: afallows: http://www.amee.com/blog/2012/02/22/building-a-chef-server-from-scratch/
[2012-03-27 15:38:57 -0400] knuckolls: has a standard emerged for how people run the chef-client on a server to keep it converging? crontab? daemon? thus far i've only started servers up with an initial chef bootstrap
[2012-03-27 15:39:12 -0400] knuckolls: and run chef-client by hand if i want this machine to converge
[2012-03-27 15:39:16 -0400] knuckolls: but that's tedious
[2012-03-27 15:40:57 -0400] afallows: sampikesley: Thanks for the link, this looks pretty cool. Couple questions: 1) is rvm involved in the build that this script produces, 2) what version of ruby is installed?
[2012-03-27 15:41:37 -0400] pwelch:  @knuckrolls are you talking about the chef-client checking with the server?
[2012-03-27 15:41:42 -0400] sampikesley: afallows: yes, RVM FTW. We use 1.9.2 https://github.com/pikesley/catering-college/blob/master/install-chef-server#L91
[2012-03-27 15:41:47 -0400] knuckolls: pwelch: yes.
[2012-03-27 15:41:49 -0400] pwelch: it should do it automaticall
[2012-03-27 15:42:10 -0400] pwelch: if you check on status in your chef-server webui it will show the last time the nodes checked in
[2012-03-27 15:43:15 -0400] sampikesley: afallows: this script was used to build our production Chef server, and it works fine
[2012-03-27 15:43:44 -0400] knuckolls: pwelch: i think that's if you run the daemon. none of my nodes automatically phone home at the moment
[2012-03-27 15:44:14 -0400] afallows: smapikesley: Awesome. Looks like it won't be hard to tweak it, since I'd like to use ruby 1.9.3 on my system
[2012-03-27 15:44:31 -0400] afallows: Aaand I spelled your name wrong. But, you know, thanks.
[2012-03-27 15:44:32 -0400] pwelch: from my understanding when bootstrapping the chef-client is installed as a daemon that checks in
[2012-03-27 15:44:41 -0400] pwelch: can someone correct me if I'm wrong?
[2012-03-27 15:45:49 -0400] pwelch: @knuckolls run "ps aux | grep chef-client" on one of your nodes
[2012-03-27 15:46:03 -0400] knuckolls: pwelch: one step ahead of you ;) yeah the chef-client daemon isn't running on any of my machines.
[2012-03-27 15:46:10 -0400] knuckolls: pwelch: do you use a chef-client cookbook or something?
[2012-03-27 15:46:27 -0400] pwelch: in the ps aux it doesn't show "chef-client -d"?
[2012-03-27 15:46:34 -0400] knuckolls: correct
[2012-03-27 15:46:36 -0400] pwelch: yes, i use the chef-client cookbook
[2012-03-27 15:46:47 -0400] pwelch: the one from opscode
[2012-03-27 15:46:49 -0400] knuckolls: i don't. that is most likely what i need to adopt
[2012-03-27 15:47:03 -0400] knuckolls: unless others do it some otherway
[2012-03-27 15:47:04 -0400] pwelch: if you want to stick with yours then I would check out their source
[2012-03-27 15:47:39 -0400] pwelch: see what they did differently
[2012-03-27 15:48:17 -0400] knuckolls: pwelch: this helps. thanks for the starting point.
[2012-03-27 15:48:59 -0400] pwelch: np
[2012-03-27 15:49:57 -0400] pwelch: @knuckolls if it helps this the tutorial I go off of: http://wiki.opscode.com/display/chef/Knife+Bootstrap
[2012-03-27 15:50:16 -0400] pwelch: it supports ubuntu 10.04, fedora 13 cents5
[2012-03-27 15:51:15 -0400] knuckolls: pwelch: i think it's just that i don't use a chef-client cookbook at all. i've used knife bootstrap heavily and i think it just runs chef-client manually the first time. nothing is setting up the daemon to run after the initial run.
[2012-03-27 15:52:53 -0400] pwelch: @knuckolls: thats possible. never thought of that. I normally create a role called base with chef-client cookbook and nagios-client cookbook. then bootstrap with that.
[2012-03-27 15:53:07 -0400] pwelch: knife bootstrap 192.168.100.80 -r 'role[base]' -x administrator --sudo
[2012-03-27 15:53:45 -0400] pwelch: that would bootstrap a node with the user administrator and then add it to that role with the chef-client cookbook
[2012-03-27 16:01:22 -0400] ryan-eme: So besides rundeck and deployinator
[2012-03-27 16:01:37 -0400] ryan-eme: what else are people running for push button chef runs?
[2012-03-27 16:02:28 -0400] knuckolls: ryan-eme: i found azkaban to be really flexible as far as workflow push-button stuf is concerned. we don't currently use it for chef but we do use it for other things that have orderings and dependencies
[2012-03-27 16:02:43 -0400] knuckolls: the nice thing is that it's just a ui for stringing together unix commands, nothing more.
[2012-03-27 16:03:16 -0400] knuckolls: perhaps too low level
[2012-03-27 16:03:30 -0400] ryan-eme: that might be just what I'm looking for
[2012-03-27 16:03:59 -0400] knuckolls: it's one of the linked in sne team's open sourced tools
[2012-03-27 16:04:16 -0400] knuckolls: it's not very actively developed, but mostly because it just works for what it needs to do
[2012-03-27 16:04:23 -0400] statix: Is the ohai idletime attribute incorrect? I though I might be able to use that to check for servers that haven't checked-in recently
[2012-03-27 16:04:35 -0400] knuckolls: ryan-eme: i know it's used heavily at linkedin.
[2012-03-27 16:07:25 -0400] statix: Or is there a better way to tell which servers have not recently checked-in with the chef server?
[2012-03-27 16:07:34 -0400] fearoffish: statix: there is a plugin for that
[2012-03-27 16:07:49 -0400] fearoffish: there is knife status too
[2012-03-27 16:09:05 -0400] statix: I want to be able to do that in recipes, to exclude servers from templates and such. Don't think knife would suffice for that
[2012-03-27 16:13:56 -0400] ryan-eme: is that ohai_time?
[2012-03-27 16:15:10 -0400] statix: I guess I can use ohai_time to do it differently. But idletime and idletime_seconds either seem incorrect (all over the place) or they represent something unclear
[2012-03-27 16:19:07 -0400] statix: Well yeah, ohai_time works fine, thanks
[2012-03-27 16:57:58 -0400] erratic: hey does anyone here use the UFW cookbook for chef?
[2012-03-27 16:58:42 -0400] c_t: I have, yes
[2012-03-27 16:58:58 -0400] erratic: have you found a more extensive doc than the md ?
[2012-03-27 16:59:32 -0400] erratic: I added the ufw::recipes to my run list which at least gave me the firewall json
[2012-03-27 16:59:51 -0400] erratic: but I'd like to now allow my chef clients to connect from a private network on eth1
[2012-03-27 17:00:41 -0400] mfoo: hi, I'm trying to run a script as an alternate user. I've taken the first example here (http://wiki.opscode.com/display/chef/Resources#Resources-Script) and simply changed the user. The user exists on the box. The script still seems to run as the chef-client user. I see a similar issue here: http://tickets.opscode.com/browse/CHEF-1523. Am I doing something wrong?
[2012-03-27 17:00:49 -0400] erratic: c_t one sec
[2012-03-27 17:00:54 -0400] erratic: Im putting something together
[2012-03-27 17:01:13 -0400] c_t: hold on, lemme dig some stuff up
[2012-03-27 17:03:24 -0400] erratic: pastie isnt working this mornign
[2012-03-27 17:04:14 -0400] atomic-penguin: Going to ChefConf, yay!
[2012-03-27 17:04:21 -0400] erratic: yeah the way I thought this worked was, you can configure your firewall from the JSON attribute editor in node edit
[2012-03-27 17:05:21 -0400] erratic: but the MD is talking about stuff like editing the default.rb or something which seems kinda counter intuitive but the point is, I haven't easily been able to determine where to start though I found this which looks promising (modified) http://pastie.org/3679276
[2012-03-27 17:06:41 -0400] c_t: https://gist.github.com/2218008
[2012-03-27 17:06:54 -0400] c_t: ^ that's what I stuck in my roles to allow all traffic on an internal interface
[2012-03-27 17:07:28 -0400] erratic: you just put that in the default.rb
[2012-03-27 17:07:52 -0400] erratic: and then installed / uploaded it?
[2012-03-27 17:08:07 -0400] c_t: in the role
[2012-03-27 17:08:42 -0400] c_t: fwiw, I did have to backport the ubuntu ufw packages to debian as well
[2012-03-27 17:08:51 -0400] c_t: dunno if that applies to you or not
[2012-03-27 17:09:25 -0400] erratic: what i did is
[2012-03-27 17:09:36 -0400] erratic: edited my admin node
[2012-03-27 17:09:43 -0400] erratic: added ufw::recipes to the run list
[2012-03-27 17:09:53 -0400] erratic: and it immediately filtered everything but ssh and ICMP
[2012-03-27 17:10:01 -0400] erratic: which seems sensible
[2012-03-27 17:10:14 -0400] erratic: I didn't use a role
[2012-03-27 17:10:37 -0400] c_t: I added "recipe[firewall]" and "recipe[ufw]"
[2012-03-27 17:10:42 -0400] c_t: and used those override attributes
[2012-03-27 17:10:48 -0400] erratic: what I would like to do, and how I thought this worked is, you can edit the ['firewall']['rules']
[2012-03-27 17:11:11 -0400] c_t: that's what I did in that gist
[2012-03-27 17:11:33 -0400] erratic: oh in the gist I thought that was ruby code
[2012-03-27 17:11:40 -0400] erratic: because im not used to looking at json
[2012-03-27 17:11:46 -0400] bkocik1: Related: I wrote a library function that gets the IP of the eth1 interface. I use it in recipes to set up config files to make services listen on that interface only. I'll share itâ€¦un momento
[2012-03-27 17:11:47 -0400] c_t: it's ruby
[2012-03-27 17:11:58 -0400] c_t: but the sort of ruby you stick in a role.rb file
[2012-03-27 17:11:59 -0400] erratic: why would I use ruby code in json?
[2012-03-27 17:12:37 -0400] c_t: as I recall, the role.rb files get conveniently converted to json for you
[2012-03-27 17:12:45 -0400] c_t: the equivalent json would be similar
[2012-03-27 17:13:36 -0400] bkocik1: Simple, but it works: https://gist.github.com/2218078
[2012-03-27 17:14:02 -0400] erratic: ew
[2012-03-27 17:14:03 -0400] erratic: lol
[2012-03-27 17:15:06 -0400] erratic: ok so in the attribute editor this is what I have so far
[2012-03-27 17:15:07 -0400] erratic: {"firewall":{"state":"","rules":{}},"tags":[]}
[2012-03-27 17:15:27 -0400] erratic: and if it doesn't work this way, fi can't start putting some rules in "rules": {} i really dont want to use this
[2012-03-27 17:15:52 -0400] CharlieSu: Ohai Chefs!  I've got an interesting issue..  I'm  using the http_request resource to make a HEAD request on an object in S3 but it is erroring out on me.  It works fine other places I'm using it, but it isn't working at all here.  The object i'm doing the HEAD request on is a json file.  Couuld that be the problem?  https://gist.github.com/6b5cafe62bd2ff005f03
[2012-03-27 17:16:53 -0400] c_t: https://gist.github.com/2218099
[2012-03-27 17:16:59 -0400] c_t: erratic: the json ^
[2012-03-27 17:17:15 -0400] erratic: bkocik1 c_t after looking at your gist again I should be able to add "internal" : { "interface" : "eth1"
[2012-03-27 17:17:21 -0400] erratic: checking your link now
[2012-03-27 17:17:49 -0400] erratic: yep :D
[2012-03-27 17:17:54 -0400] erratic: thank you!
[2012-03-27 17:19:04 -0400] CharlieSu: What actually happens w/ the output of a http_request response?
[2012-03-27 17:27:05 -0400] erratic: c_t is this right? Path: json['firewall']['rules'][0]['internal']['interface']
[2012-03-27 17:27:29 -0400] erratic: that zeroth indice seems out of place
[2012-03-27 17:27:43 -0400] hoover_damm: .first?
[2012-03-27 17:29:23 -0400] hoover_damm: CharlieSu, log file should have it
[2012-03-27 17:29:31 -0400] hoover_damm: the log file for the client
[2012-03-27 17:29:31 -0400] hoover_damm: if set
[2012-03-27 17:39:34 -0400] CharlieSu: hoover_damm: everything is in the gist i sent...
[2012-03-27 17:39:44 -0400] CharlieSu: hoover_damm: it is trying to do a chomp on something.. but not sure why
[2012-03-27 17:42:08 -0400] hoover_damm: run chef in debug mode
[2012-03-27 17:42:13 -0400] hoover_damm: chef-client -l debug
[2012-03-27 17:42:23 -0400] hoover_damm: CharlieSu, as you are not seeing enough because you are in info mode
[2012-03-27 17:42:59 -0400] CharlieSu: hoover_damm: i'm in debug mode..
[2012-03-27 17:43:26 -0400] hoover_damm: :( was hoping to see more then
[2012-03-27 17:43:45 -0400] CharlieSu: yeah..  when i switched the filename from .json to .txt everything works..
[2012-03-27 17:44:14 -0400] hoover_damm: heh, good ole ruby
[2012-03-27 17:48:25 -0400] CharlieSu: all good..  i'll just deal w/ it
[2012-03-27 18:06:29 -0400] hoover_damm: prolly something in your content it didn't like
[2012-03-27 18:19:31 -0400] bkocik1: I've forgotten the correct way to check whether a node has a particular role in a recipeâ€¦anyone recall?
[2012-03-27 18:26:30 -0400] pwelch: bkocik1: knife node show <node fqdn>
[2012-03-27 18:26:35 -0400] pwelch: or look in the webui
[2012-03-27 18:27:10 -0400] pwelch: I think thats the correct way anyways...
[2012-03-27 18:27:17 -0400] bkocik1: pwelch: Thanks, but I was trying to figure out how to do it within a recipe. I ended up looking for an attribute instead, though.
[2012-03-27 18:29:06 -0400] pwelch: cool
[2012-03-27 18:42:08 -0400] pulsejc: I'm having trouble getting java to install using the java 1.4.2 cookbook
[2012-03-27 18:42:55 -0400] pulsejc: it seems that the url that it is using to download the oracle jdk requires accepting a license first
[2012-03-27 18:43:15 -0400] pulsejc: so all it is downloading is the html saying you need to accept a license
[2012-03-27 18:44:00 -0400] pulsejc: I can certainly download it manually and put it somewhere else
[2012-03-27 18:44:30 -0400] pulsejc: it just seemed odd that the cookbook wouldn't work out of the box
[2012-03-27 18:45:17 -0400] AntonZ: yea, oracle doenst let you download anything without accepting license
[2012-03-27 18:45:24 -0400] AntonZ: as well, i think you have o be logged in
[2012-03-27 18:48:40 -0400] pulsejc: I know the java 1.4.0 cookbook was working at some point downloading from oracle without having to login
[2012-03-27 18:48:55 -0400] pulsejc: so I wasn't sure if this was a change in oracle behavior or the cookbook
[2012-03-27 18:49:31 -0400] pulsejc: I would try 1.4.0, but that is for a different chef installation
[2012-03-27 18:50:09 -0400] jordan_c: is remote_file only deprecated for pulling in files from the files/ directory? Is it still valid for pulling files in from a url?
[2012-03-27 18:50:25 -0400] cwj: jordan_c: thats correct
[2012-03-27 18:50:26 -0400] kallistec: jordan_c: yes
[2012-03-27 18:50:30 -0400] jordan_c: ahh, ok
[2012-03-27 18:50:32 -0400] rrichardsr3: \quit
[2012-03-27 18:50:38 -0400] jordan_c: thanks
[2012-03-27 18:50:52 -0400] cwj: one should now use cookbook_file for the former case
[2012-03-27 18:51:12 -0400] jordan_c: I had been slightly mistaken and banging my head around trying to use a url as source for cookbook_file - time to work on reading comprehension
[2012-03-27 18:52:48 -0400] cwj: apply more caffiene
[2012-03-27 18:58:58 -0400] erikh: anyone know how I can copy a public key from one chef server to another?
[2012-03-27 18:59:10 -0400] erikh: client public key that is
[2012-03-27 19:00:48 -0400] afallows: erikh: What OS(es)?
[2012-03-27 19:04:58 -0400] tolland: ooh im installing the knife-hp plug-in im sooo excited is it going to work first time, or do i have to wrestle with it.
[2012-03-27 19:20:02 -0400] darrinholst: what would be a proper way of getting start, end, and failure callbacks into the deploy resource?
[2012-03-27 19:20:39 -0400] darrinholst: I tried sticking https://gist.github.com/2219405 into libraries which seems to work once, but after a while it gets into an endless on_start loop
[2012-03-27 19:24:33 -0400] jdeamattson: Is this a legitimate pattern for an upgrade recipe: 1) Add recipe to run list, 2) recipe executes, 3) as last step in upgrade recipe, it removes itself from the run list.
[2012-03-27 19:25:23 -0400] hoover_damm: jdeamattson, find a better way to test if the upgrade has taken place
[2012-03-27 19:25:49 -0400] hoover_damm: jdeamattson, such as a not_if that runs something to determine if it needs to upgrade or not
[2012-03-27 19:26:01 -0400] hoover_damm: or only_if
[2012-03-27 19:26:16 -0400] jdeamattson: hoover_damm: And then run or not run the recipe based on that one?
[2012-03-27 19:26:58 -0400] jdeamattson: hoover_damm: I was going to have a test at the end of the recipe, that would perform the check.
[2012-03-27 19:27:40 -0400] jdeamattson: hoover_damm: To do the upgrade, we have to run a number of scripts outside of Chef control that are not exactly idempotentâ€¦.I will be taking steps in Chef to guarantee idenmpotencyâ€¦.
[2012-03-27 19:28:01 -0400] jdeamattson: hoover_damm: If I could use the deploy resource, some of these issues would be moot, but I cannot currently use the deploy resource.
[2012-03-27 19:29:06 -0400] hoover_damm: why not?
[2012-03-27 19:29:17 -0400] pwelch: does anyone else use nagios, or a similar cookbook in a LAN environment? I would like to bounce an idea off of someone to see if I am going down the correct thought process
[2012-03-27 19:30:10 -0400] hoover_damm: jdeamattson, regardless of that usually I prefer to make my recipes idempotent based on things that are dynamic
[2012-03-27 19:30:27 -0400] hoover_damm: jdeamattson, except in source based recipes... those are always different
[2012-03-27 19:30:32 -0400] jdeamattson: hoover_damm: A good pattern t do soâ€¦.
[2012-03-27 19:30:58 -0400] hoover_damm: run collectd -V and check the version
[2012-03-27 19:30:59 -0400] jdeamattson: hoover_damm: in many ways, this is a source based recipeâ€¦.:-)
[2012-03-27 19:31:27 -0400] hoover_damm: one of my clients is a rails shop, so we have several source artifact cookbooks
[2012-03-27 19:31:46 -0400] hoover_damm: install_from kinda helped us in a way
[2012-03-27 19:31:57 -0400] hoover_damm: it made alot of our source compile recipes dry
[2012-03-27 19:41:48 -0400] erratic: so I've kinda gathered there aren't to many chef-server nerds here
[2012-03-27 19:42:08 -0400] erratic: I'm deterimined to figure this out it can't be too hard
[2012-03-27 19:42:34 -0400] hoover_damm: a lot of people do use the hosted chef
[2012-03-27 19:42:40 -0400] hoover_damm: but there are still some people who host chef
[2012-03-27 19:43:06 -0400] hoover_damm: but i'm only good at answering questions
[2012-03-27 19:43:18 -0400] erratic: cool
[2012-03-27 19:43:26 -0400] erratic: yeah I'll try to only ask on an as per needed basis
[2012-03-27 19:43:49 -0400] erratic: from what I determined yesterday from talking to people is that expander and solr are responsible for searching and indexing ?
[2012-03-27 19:44:34 -0400] hoover_damm: solr does the search, expander subscribes to /chef on rabbitmq
[2012-03-27 19:44:41 -0400] erratic: I see
[2012-03-27 19:44:44 -0400] hoover_damm: chef-server-api posts to /chef on rabbitmq
[2012-03-27 19:45:00 -0400] hoover_damm: so you are right on expander subscribing and then taking that data and pushing it into solr
[2012-03-27 19:45:55 -0400] erratic: I see
[2012-03-27 19:48:30 -0400] erratic: I know it has something to do with authentication because I had to go and change the password for my rabbitmq server because the password I used had funky characters in it
[2012-03-27 19:48:42 -0400] erratic: and I had to change it in at least two places
[2012-03-27 19:48:47 -0400] hoover_damm: fun
[2012-03-27 19:49:01 -0400] erratic: so I'll bet it has something to do with that, or maybe there was some initialization stuff that never took place
[2012-03-27 19:49:10 -0400] erratic: I wonder if I can just use dpkg to reconfigure chef-server
[2012-03-27 19:49:29 -0400] hoover_damm: don't know if opscode added all that into the debian packages or not
[2012-03-27 19:49:37 -0400] hoover_damm: I generally stick to what I know... Ruby and Rubygems
[2012-03-27 19:49:41 -0400] erratic: I don't want to overwrite my work though
[2012-03-27 19:49:46 -0400] hoover_damm: i'm in my own hell this morning with http://packages.qa.debian.org/r/ruby1.9.1.html
[2012-03-27 19:49:49 -0400] hoover_damm: :)
[2012-03-27 19:49:51 -0400] hoover_damm: making a 1.9.3 p125 package
[2012-03-27 19:50:05 -0400] erratic: this only affects my ability to view the status of things, clients still pull node configuration and I can apply roles and stuff and that stuff is working great
[2012-03-27 19:50:11 -0400] hoover_damm: it might show 1.9.3p0 in that page, but git has p125
[2012-03-27 19:50:11 -0400] hoover_damm: :)
[2012-03-27 19:50:24 -0400] hoover_damm: so even newer then testing! YAY!
[2012-03-27 19:50:50 -0400] hoover_damm: erratic, well all your work is hosted on couchdb
[2012-03-27 19:50:56 -0400] erratic: yeah I'm kind of a ruby noob I chose python years ago was a stupid choice simply because I never hear anything good about python
[2012-03-27 19:51:00 -0400] erratic: and nothing cool is written in python
[2012-03-27 19:51:06 -0400] erratic: except django thats kinda cool
[2012-03-27 19:51:12 -0400] hoover_damm: you should be using chef-repo
[2012-03-27 19:51:12 -0400] erratic: everyone still uses rails
[2012-03-27 19:51:21 -0400] hoover_damm: so you can implode your server and bring it back up fairly easily
[2012-03-27 19:51:21 -0400] erratic: I am for the cookbooks
[2012-03-27 19:51:31 -0400] hoover_damm: I do it for data_bags, cookbooks, roles, nodes occasionally
[2012-03-27 19:51:37 -0400] hoover_damm: environments
[2012-03-27 19:51:41 -0400] erratic: oh you know what
[2012-03-27 19:51:44 -0400] erratic: I just realized something
[2012-03-27 19:51:45 -0400] hoover_damm: describe everything
[2012-03-27 19:51:53 -0400] erratic: I noticed btm had forked chef on his github
[2012-03-27 19:52:02 -0400] erratic: I wonder if he pushes his configs and stuff or something
[2012-03-27 19:52:13 -0400] erratic: or like all of the role ruby files and stuff
[2012-03-27 19:52:29 -0400] jdeamattson: While running a script resource for bash, I got this: STDERR: /usr/lib64/ruby/gems/1.8/gems/chef-0.10.8/bin/../lib/chef/shell_out/unix.rb:73:in `uid=': Resource temporarily unavailable (Errno::EAGAIN)
[2012-03-27 19:52:33 -0400] jdeamattson: Ring any bells?
[2012-03-27 19:52:35 -0400] erratic: at first when somebody told me about the roles/ directory in chef-repo I was like are you @!#*$(& kidding me seriously
[2012-03-27 19:55:19 -0400] erratic: [Tue, 27 Mar 2012 19:55:12 +0000] ERROR: Failed to post to solr: node[8f080476-1c95-4f70-bf70-0515bbe7cf07] database[chef]
[2012-03-27 19:55:31 -0400] erratic: well thats a start
[2012-03-27 19:55:39 -0400] erratic: I started expander with -l debug
[2012-03-27 19:55:48 -0400] erratic: and then ran chef-client on one of my nodes
[2012-03-27 19:58:00 -0400] erratic: something else I'd like to know, does chef server use couch to store all of my node data and so on ?
[2012-03-27 19:58:49 -0400] erratic: so like if I wanted to keep all of the work I've done and everything I would just need to back up my git-repo/ directory and backup couchdb?
[2012-03-27 20:00:21 -0400] pcn: Anyone else seeing 403's from the ubuntu apt servers in ec2's us-east?
[2012-03-27 20:01:49 -0400] pcn: jdeamattson what directory service are you using?  LDAP?  Is your system able to perform a bind at that point of the run?
[2012-03-27 20:02:24 -0400] jdeamattson: Just using standard unix users. Lookup would be against the local host.
[2012-03-27 20:08:29 -0400] pcn: WWEird.  Any locks?
[2012-03-27 20:08:49 -0400] pcn: Sorry, terminal went out of whack
[2012-03-27 20:30:23 -0400] hoover_damm: erratic, you can also run the expander in debug mode which can help with debugging
[2012-03-27 20:51:24 -0400] jdeamattson: pcn: No locks of which I am aware. It just appears that it can't find the uid under some conditions.
[2012-03-27 20:52:00 -0400] pcn: EAGAIN... maybe actually try again?
[2012-03-27 20:57:08 -0400] ryan-eme: anyone here ever installed deployinator?
[2012-03-27 20:58:02 -0400] jdeamattson: pcn: Did that and it worked. This user is defined in the process of bringing the node up, so perhaps on an initial start, it doesn't exist?....
[2012-03-27 20:58:39 -0400] Rorgo: is there a way to append a line to a file in chef, if the line doesn't exist?
[2012-03-27 20:58:51 -0400] Rorgo: rather than pushing out a full template/cookbook_file of that file..
[2012-03-27 20:59:53 -0400] ryan-eme: you can open and seek in a ruby block
[2012-03-27 20:59:57 -0400] jdeamattson: Rorgo:  You have the power of Ruby at your disposal, so you can do just about anything. If you drop into a Ruby Block, just be careful you maintain idempotency...
[2012-03-27 20:59:59 -0400] ryan-eme: but cookbook_file is better
[2012-03-27 21:02:02 -0400] miah: editing lines in files is bad juju
[2012-03-27 21:02:40 -0400] Rorgo: yeah, I know. I'm just trying to lazily add a log line to syslog.conf without building a cookbook for it for the time being.
[2012-03-27 21:03:50 -0400] HasanB: miah: "editing lines in files is bad juju"   Hi!   Could you elaborate, please?
[2012-03-27 21:05:15 -0400] HasanB: I don't understand why you say that.
[2012-03-27 21:10:48 -0400] miah: lots can go wrong
[2012-03-27 21:11:03 -0400] miah: better to templatize
[2012-03-27 21:12:38 -0400] HasanB: well, I just wrote a block that does an XPATH search in a config, file and inserts some needed missing details, iff they are not found.  Is that the kind of thing you recommend against?
[2012-03-27 21:12:55 -0400] HasanB: well, I just wrote a block that does an XPATH search in a config file and inserts some needed missing details, iff they are not found.  Is that the kind of thing you recommend against?
[2012-03-27 21:16:29 -0400] miah: yes, i template all of my config files and just have programming logic in my cookbooks add bits if needed
[2012-03-27 21:16:46 -0400] miah: eg, if a host belongs to a specific role, then enable this additional configuration block
[2012-03-27 21:16:55 -0400] miah: you can do conditional ifs and such inside erb's
[2012-03-27 21:17:19 -0400] miah: so you can just check if a passed variable from the cookbook is set, and if yes, then add the lines of this condition
[2012-03-27 21:17:53 -0400] miah: templates are powerful, take advantage of them =)
[2012-03-27 21:18:37 -0400] sascha_d: if I ask a question about Chef on Windows, will I get empty air?
[2012-03-27 21:19:05 -0400] miah: there are a few windows users here
[2012-03-27 21:19:18 -0400] miah: though the ratio is still quite a bit skewed to unix
[2012-03-27 21:19:26 -0400] sascha_d: we are having a funky behavior with one executable in system32
[2012-03-27 21:19:46 -0400] sascha_d: all other executables are working fine with windows batch
[2012-03-27 21:20:06 -0400] sascha_d: but we are trying to use dcpromo and it fails to find or recognize the file
[2012-03-27 21:20:22 -0400] sascha_d: however, my sysadmin can copy the executable file out of the system32 folder and it executes
[2012-03-27 21:20:24 -0400] sascha_d: windows voodoo
[2012-03-27 21:20:34 -0400] Gearbox: Paths?
[2012-03-27 21:20:57 -0400] sascha_d: yeah I had him add a windows_path block, but it's system32 AND other executables in that dir do work
[2012-03-27 21:20:58 -0400] Gearbox: as in, does your shell have a different $PATH than your batch environment?
[2012-03-27 21:21:09 -0400] sascha_d: I mean other executables work in recipes
[2012-03-27 21:21:26 -0400] sascha_d: and we explicitly called it with a path
[2012-03-27 21:21:42 -0400] Gearbox: That's pretty weird.
[2012-03-27 21:22:45 -0400] HasanB: miah: " ... i template all of my config files ..." what if there is a risk that the config file has already been altered?   You will over-write the prior change.
[2012-03-27 21:23:38 -0400] josephholsten: bmt: what needs to be in a minimally acceptable aaa system for chef-server? (I ask because I stumbled across chef-541, ldap support, again)
[2012-03-27 21:23:39 -0400] miah: why would the configuration file be managed _outside_ of chef?
[2012-03-27 21:24:02 -0400] paulmooring: sascha_d: what flags are you passing dcpromo
[2012-03-27 21:24:52 -0400] miah: getting systems into chef initially that have been managed by hand can be risky, but it will also bring everything into unity
[2012-03-27 21:25:05 -0400] josephholsten: HasanB: you can prevent that by using something like ossec or tripwire
[2012-03-27 21:25:15 -0400] miah: tripwire...
[2012-03-27 21:25:21 -0400] miah: what a piece of shit
[2012-03-27 21:26:16 -0400] miah: manage configuration files, and software installation with chef, manage package integrity with built in tools (rpm will do checksum verifications, so will apt)
[2012-03-27 21:26:43 -0400] miah: s/apt/dpkg
[2012-03-27 21:27:53 -0400] miah: i've gotten into too much trouble with the cfengine 'lets edit lines in files' logic.
[2012-03-27 21:28:28 -0400] Rorgo: if nothing else, using templates gives you an easy view into revision history of files via git/svn
[2012-03-27 21:29:16 -0400] sascha_d: paulmooring : STDOUT: C:\>dcpromo.exe /answer:\\10.115.200.139\share\dcpromo.txt
[2012-03-27 21:29:29 -0400] HasanB: hmmm ... I'm not actually talking about manual alteration.  My cookbook installs a TomCat war file and tweaks a TomCat config file.   I can't assume that the TomCat file is cast in concrete, can I?
[2012-03-27 21:30:36 -0400] miah: Rorgo: exactly
[2012-03-27 21:31:07 -0400] miah: why not just install a tomcat config file that you've hand crafted and vetted, with the programming logic required to tweak it as needed?
[2012-03-27 21:31:11 -0400] HasanB: it's my first cookbook, so I'm as busy learning "best prectice" habits as Ruby coding and chef itself.
[2012-03-27 21:31:40 -0400] miah: ah yes
[2012-03-27 21:31:48 -0400] miah: well, take a look at the nagios cookbook
[2012-03-27 21:31:55 -0400] miah: its quite educational
[2012-03-27 21:32:01 -0400] miah: or even the haproxy cookbook
[2012-03-27 21:32:35 -0400] paulmooring: sascha_d: and Chef execute a batch file that calls dcpromo?
[2012-03-27 21:32:38 -0400] sascha_d: paulmooring: the sysadmin I'm working with says it works great if you move the dcpromo executable into the chef bin directory
[2012-03-27 21:33:06 -0400] sascha_d: paulmooring: yeah it's just a one line windows batch block
[2012-03-27 21:33:13 -0400] paulmooring: sascha_d: what user are you running Chef with, and are you using UAC?
[2012-03-27 21:33:33 -0400] HasanB: miah:  "install a tomcat config file that you've hand crafted and vetted"  How will I know the state of the TomCat file as chosen by some unknown future user of my cookbook.
[2012-03-27 21:33:45 -0400] sascha_d: Administrator and UAC is on
[2012-03-27 21:34:38 -0400] paulmooring: do you run 'chef-client' from an privileged cmd prompt?
[2012-03-27 21:34:42 -0400] HasanB: miah: "nagios cookbook ... its quite educational"   in a good sense or a bad sense?  :-)
[2012-03-27 21:35:33 -0400] sascha_d: paulmooring: not at the moment but he says he's tried this
[2012-03-27 21:35:48 -0400] sascha_d: I was on vacation two weeks ago and he apparently went 10 rounds with this on his own
[2012-03-27 21:39:21 -0400] paulmooring: sascha_d: it sounds to me like you've covered the obvious stuff, does this batch file do more than launch dcpromo, or could you easilty switch to just using execute?
[2012-03-27 21:39:39 -0400] sascha_d: totally switch
[2012-03-27 21:40:06 -0400] erratic: crap.
[2012-03-27 21:41:20 -0400] paulmooring: check out the wiki resource page for a good example
[2012-03-27 21:41:36 -0400] paulmooring: it at least would remove a layer to make debugging easier
[2012-03-27 21:41:37 -0400] erratic: ./timer
[2012-03-27 21:42:25 -0400] erratic: Ruby's DSLs
[2012-03-27 21:43:01 -0400] erratic: can I just install over all of these ubuntu packages or something or do I really have to reinstall the operating system and all that crap
[2012-03-27 21:44:14 -0400] erratic: I guess there's something wrong that can't be fixed with my chef-expander / chef-solr
[2012-03-27 21:44:28 -0400] erratic: http://lists.opscode.com/sympa/arc/chef/2012-03/msg00369.html
[2012-03-27 21:51:33 -0400] miah: HasanB: in a good sense
[2012-03-27 21:51:50 -0400] bemu: Anyone have experience with the Cisco Aironet 3500's?
[2012-03-27 21:51:54 -0400] miah: you should talk to BryanWB about tomcat cookbooks as well
[2012-03-27 21:52:04 -0400] miah: as i know he's done quite a bit of work on one
[2012-03-27 21:53:02 -0400] coderanger: miah: Goooo add your IRC nick to your community profile :P
[2012-03-27 21:53:56 -0400] miah: oh
[2012-03-27 21:54:29 -0400] miah: my irc nick is my name :P
[2012-03-27 21:54:59 -0400] miah: but also done
[2012-03-27 21:56:48 -0400] coderanger: :)
[2012-03-27 21:58:07 -0400] erratic: coderanger
[2012-03-27 22:13:22 -0400] maek: is there somewhere I can read the diff between admin client keys and non admin client keys. Having a hard time searching for it on the wiki. thanks
[2012-03-27 22:13:50 -0400] coderanger: maek: Open source server or Hosted?
[2012-03-27 22:14:28 -0400] maek: coderanger: oss
[2012-03-27 22:15:01 -0400] coderanger: a non-admin client can't edit/delete envs/roles/data bags and can only update the node that matches the exact name of the client
[2012-03-27 22:15:08 -0400] coderanger: admins can do anything
[2012-03-27 22:15:32 -0400] maek: so non admin CAN boot strap
[2012-03-27 22:15:41 -0400] maek: but can NOT modify the run list of a node?
[2012-03-27 22:16:09 -0400] coderanger: It can change anything at all on the node that matches the client
[2012-03-27 22:16:22 -0400] coderanger: security is only at the level of whole API calls
[2012-03-27 22:16:57 -0400] maek: ok this is a knife client key. same thing I assume since there is no matching node it cant make changes
[2012-03-27 22:17:24 -0400] coderanger: It could create a node with the same name
[2012-03-27 22:17:32 -0400] maek: yeah
[2012-03-27 22:17:35 -0400] maek: understood thanks.
[2012-03-27 22:17:45 -0400] maek: and bootstrap is ok if it has validation.pem
[2012-03-27 22:17:47 -0400] maek: ?
[2012-03-27 22:18:13 -0400] coderanger: Yeah, validator is a special non-admin client that is allowed to create new clients and nothing else
[2012-03-27 22:18:49 -0400] maek: great thank you for the super thorough info. Appreciate it :)
[2012-03-27 22:20:35 -0400] maek: coderanger: one last thing. Is it trivial to generate a new validation.pem?
[2012-03-27 22:21:07 -0400] coderanger: Yes, either rekey normally through the webui or knife, or delete the client from the database and restart the server
[2012-03-27 22:21:19 -0400] kallistec: maek: when you bootstrap, you make, using the validator identity (name+key), POST /clients which creates a client entry on the server and returns its private key. from then on, the api calls you make use the freshly created client's name+key
[2012-03-27 22:22:12 -0400] maek: kallistec: thanks
[2012-03-27 22:22:32 -0400] jaff: hi, I am trying to install chef-server using chef-solo first time on RHEL6, and following instructions here: http://wiki.opscode.com/display/chef/Installing+Chef+Server+using+Chef+Solo
[2012-03-27 22:22:32 -0400] jaff: I got an error after executing sudo chef-solo -c /etc/chef/solo.rb -j ~/chef.json -r http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz
[2012-03-27 22:22:32 -0400] jaff: [Tue, 27 Mar 2012 16:43:07 -0500] FATAL: Could not parse the provided JSON file (/home/mjaffe/chef.json)!: 743: unexpected token at '{
[2012-03-27 22:22:33 -0400] jaff:   "chef_server": {
[2012-03-27 22:22:33 -0400] jaff:     "url": "http://tul1csspup2.corporate.local:4000",
[2012-03-27 22:22:33 -0400] jaff:     "webui_enabled": true,
[2012-03-27 22:22:33 -0400] jaff: Â Â Â Â "init_style": "init"
[2012-03-27 22:22:34 -0400] jaff:   },
[2012-03-27 22:22:34 -0400] jaff:   "run_list": [ "recipe[chef-server::rubygems-install]" ]
[2012-03-27 22:22:35 -0400] jaff: }
[2012-03-27 22:22:35 -0400] jaff: '
[2012-03-27 22:22:37 -0400] maek: coderanger: ah so something in chef knows its the validator client. I dont have to do anythign special to to make it that key
[2012-03-27 22:22:38 -0400] coderanger: jaff: Stop
[2012-03-27 22:22:54 -0400] coderanger: jaff: Do not paste into IRC channels, please use a pastebin website
[2012-03-27 22:23:14 -0400] jaff: unknown reference
[2012-03-27 22:23:21 -0400] hoover_damm: gist.github.com
[2012-03-27 22:23:23 -0400] hoover_damm: pastebin.com
[2012-03-27 22:23:24 -0400] hoover_damm: pastie.org
[2012-03-27 22:23:29 -0400] hoover_damm: ^^ jaff
[2012-03-27 22:23:41 -0400] jaff: OK, looking into it
[2012-03-27 22:23:42 -0400] hoover_damm: for example
[2012-03-27 22:23:49 -0400] hoover_damm: would be nice if gist.el was fixed already
[2012-03-27 22:23:53 -0400] hoover_damm: comon defunkt
[2012-03-27 22:23:54 -0400] kallistec: maek: yeah, a lot of people think the validator does crazy digital signature stuff, but it's more like a specially crafted guest account
[2012-03-27 22:24:14 -0400] maek: kallistec: thanks!
[2012-03-27 22:24:19 -0400] kallistec: maybe the name could be more accurate
[2012-03-27 22:27:10 -0400] AntonZ: guys, can someone tell me why this piece of code fails on me
[2012-03-27 22:27:11 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: 274 if FileTest.exists?(/srv/jenkins)
[2012-03-27 22:27:11 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: 275 bash "starting jenkins" do
[2012-03-27 22:27:11 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: ***     code <<-EOH
[2012-03-27 22:27:11 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: 277       "service jenkins start"
[2012-03-27 22:27:12 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: 278 end
[2012-03-27 22:27:12 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: SEND b1 [push v15] (1,374 bytes) <26033756001:e20ad5dc93c95cf5203edf57cb385ee2> /auditor/update_entry, persistent
[2012-03-27 22:27:12 -0400] AntonZ: Mar 27 18:17:14 ip-10-0-1-11 RightLink[2512]: *ERROR> Chef process failure
[2012-03-27 22:27:27 -0400] AntonZ: gist is probably better
[2012-03-27 22:28:56 -0400] kallistec: jaff: anyway, your problem is malformed JSON, probably missing a comma somewhere before the part of your node.json that was quoted in the error message
[2012-03-27 22:30:29 -0400] jaff: So how could I debug that? I followed example, just added one line
[2012-03-27 22:31:00 -0400] wamcvey: jaff, there are jsonlint tools that can help you pinpoint your json syntax error.
[2012-03-27 22:31:27 -0400] jaff: thanks, I'll lookup
[2012-03-27 22:31:31 -0400] kallistec: jaff: there's a different library that has nicer error messages, too
[2012-03-27 22:31:54 -0400] kallistec: jaff: try `ruby -rubygems -ryajl -e 'Yajl::Parser.parse(IO.read("/etc/chef/node.json"))'` (or whatever your file is named)
[2012-03-27 22:33:35 -0400] jaff: Yeah, jsonlint.com just told me "Unexpected token" and did not show me where
[2012-03-27 22:42:44 -0400] jaff: kallistec: Any other suggestions for invoking above? I did gem install yajl-ruby and got this: ruby -rubygems -ryajl -e 'Yajl::Parser.parse(IO.read("./chef.json"))'
[2012-03-27 22:42:44 -0400] jaff: ruby: no such file to load -- yajl (LoadError)
[2012-03-27 22:43:28 -0400] kallistec: jaff: how'd you install chef?
[2012-03-27 22:45:31 -0400] AntonZ: can someone lease tell me why this is failing: https://gist.github.com/2221148
[2012-03-27 22:46:34 -0400] jaff: kallistec: in the process of installing
[2012-03-27 22:46:48 -0400] coderanger: AntonZ: You need to close the heredoc
[2012-03-27 22:46:53 -0400] kallistec: AntonZ: looks like you're not closing your heredoc? try running ruby -c FILE
[2012-03-27 22:47:37 -0400] AntonZ: hmm
[2012-03-27 22:47:41 -0400] jaff: kallistec: I was setting up to run the bootstrap
[2012-03-27 22:47:47 -0400] kallistec: jaff: but you got the client installed... did you use the install.sh magic, rpms, other?
[2012-03-27 22:50:16 -0400] jaff: rpms
[2012-03-27 22:51:18 -0400] jaff: chef.json got reformatted using http://zaach.github.com/jsonlint/ and it is working now
[2012-03-27 22:53:19 -0400] jaff: Original at  http://pastebin.com/nFnpK8Yt, replacement at http://pastebin.com/Rjgeb6W6
[2012-03-27 22:57:20 -0400] AntonZ: does this look right? https://gist.github.com/2221148
[2012-03-27 22:58:36 -0400] kallistec: AntonZ: that should work. what does it say if you run ruby -c on it?
[2012-03-27 22:59:37 -0400] AntonZ: oot@ip-10-0-1-11 tmp]# ruby -c test
[2012-03-27 22:59:37 -0400] AntonZ: test:1: unknown regexp options - jk
[2012-03-27 22:59:37 -0400] AntonZ: test:7: syntax error
[2012-03-27 22:59:37 -0400] AntonZ: [root@ip-10-0-1-11 tmp]#
[2012-03-27 23:01:39 -0400] kallistec: AntonZ: yeah, you need quotes around the /srv... path in line 1
[2012-03-27 23:02:14 -0400] AntonZ: retrying
[2012-03-27 23:02:55 -0400] AntonZ: [root@ip-10-0-1-11 tmp]# ruby -c test
[2012-03-27 23:02:55 -0400] AntonZ: test:6: syntax error
[2012-03-27 23:02:55 -0400] AntonZ: [root@ip-10-0-1-11 tmp]#
[2012-03-27 23:03:13 -0400] AntonZ: it doesnt like "end" >
[2012-03-27 23:03:13 -0400] AntonZ: ?
[2012-03-27 23:03:36 -0400] cwj: you need 'EOH' before end
[2012-03-27 23:04:04 -0400] AntonZ: i have it
[2012-03-27 23:04:28 -0400] AntonZ: https://gist.github.com/2221148
[2012-03-27 23:05:04 -0400] cwj: you start with <<-EOH and never end it with another EOH
[2012-03-27 23:05:39 -0400] AntonZ: oh oh
[2012-03-27 23:06:33 -0400] erratic: just wanted to let everyone know
[2012-03-27 23:06:41 -0400] erratic: I isolated my solr / expander problem to expander
[2012-03-27 23:06:41 -0400] erratic: http://lists.opscode.com/sympa/arc/chef/2012-03/msg00370.html
[2012-03-27 23:10:01 -0400] AntonZ: its still not happy  sigh https://gist.github.com/2221148
[2012-03-27 23:10:22 -0400] AntonZ: i think i closed all EOH
[2012-03-27 23:10:43 -0400] coderanger: AntonZ: You aren't ending you if and unless blocks
[2012-03-27 23:11:04 -0400] coderanger: I really need to post my "intro to ruby for Chef slides" somewhere
[2012-03-27 23:11:46 -0400] AntonZ: ah that was it, its happy now!
[2012-03-27 23:12:01 -0400] AntonZ: i'll have  a look at those slides!
[2012-03-27 23:12:05 -0400] AntonZ: if ypu post them
[2012-03-27 23:12:13 -0400] erratic: .POST /solar/update HTTP/1.1^M
[2012-03-27 23:12:25 -0400] jaff: bye, folks and thanks
[2012-03-27 23:12:47 -0400] coderanger: AntonZ: They are linked from http://pycon2012devops.herokuapp.com/, about 2/3s through the deck
[2012-03-27 23:14:20 -0400] AntonZ: why is it asking me for my aws account info :) ?
[2012-03-27 23:15:22 -0400] dhruvbansal: I can clone a private git repository (in a recipe) by setting the 'ssh_wrapper' variable in the 'git' resource.  Does anyone know how to clone a private git repo that itself has *private submodules*?
[2012-03-27 23:16:36 -0400] coderanger: AntonZ: Ignore the main page, it was part of the class I taught, slides and cheatsheet are on the nav bar
[2012-03-27 23:16:47 -0400] AntonZ: understood
[2012-03-27 23:17:12 -0400] coderanger: dhruvbansal: Should still work, the ssh wrapper is set via an env var so it should inherit to those too
[2012-03-27 23:17:25 -0400] erratic: I fixed it guys
[2012-03-27 23:17:26 -0400] erratic: it works now
[2012-03-27 23:17:30 -0400] erratic: I just sent a follow up email
[2012-03-27 23:17:46 -0400] dhruvbansal: coderanger: i'm in the sorry situtation where i have several submodules with different credentials
[2012-03-27 23:18:11 -0400] coderanger: dhruvbansal: Make sure the wrapper loads all the keys then :)
[2012-03-27 23:18:16 -0400] dhruvbansal: is the best option to just move the logic of handling which creds to use to the script I name with GIT_SSH ?
[2012-03-27 23:18:21 -0400] erratic: thank you all for your help!
[2012-03-27 23:18:29 -0400] AntonZ: great slides!
[2012-03-27 23:18:40 -0400] coderanger: AntonZ: Heh, thanks
[2012-03-27 23:18:52 -0400] coderanger: AntonZ: There is a video of the class on youtube somewhere
[2012-03-27 23:19:10 -0400] AntonZ: ill look it up later on
[2012-03-27 23:19:12 -0400] AntonZ: thanks!
[2012-03-27 23:19:16 -0400] coderanger: dhruvbansal: Just add -i for all the different keys, SSH will negotiate to figure out which to use for each repo
[2012-03-27 23:19:40 -0400] dhruvbansal: coderanger: got it, let ssh do the work.  thanks!
[2012-03-27 23:19:56 -0400] coderanger: erratic: That is just awesome, I feel your probably facepalm from here :)
[2012-03-27 23:20:02 -0400] coderanger: dhruvbansal: Exactly
[2012-03-27 23:20:14 -0400] erratic: :D
[2012-03-27 23:23:13 -0400] erratic: http://lists.opscode.com/sympa/arc/chef/2012-03/msg00371.html
[2012-03-27 23:40:59 -0400] mhalligan: any recommendations for a recipe to build dns entries from chef's list of current nodes?
[2012-03-27 23:43:49 -0400] miah: i wrote my own based on the route53 cookbook
[2012-03-27 23:47:53 -0400] miah: mhalligan: https://gist.github.com/2221571
[2012-03-27 23:48:40 -0400] miah: its code only a mother could love
[2012-03-27 23:48:45 -0400] miah: but, it gives you an idea
[2012-03-27 23:52:22 -0400] Rorgo: how do people generally handle running Chef in EC2? Spin up another chef server in that environment?
[2012-03-27 23:52:51 -0400] mhalligan: miah: thanks :)
[2012-03-27 23:53:17 -0400] erratic: whoever made the acronym solr and not solar is the bane of my existence
[2012-03-27 23:53:34 -0400] erratic: god Im glad I got that fixed
[2012-03-27 23:53:37 -0400] mhalligan: miah: right now I'm goofing around with the autozone recipe in 37singals' djbdns module, and am having a bunch of problems running their erb: https://gist.github.com/2221600
[2012-03-27 23:53:40 -0400] erratic: I was about to give up and just fuck it rsync it is
[2012-03-27 23:53:46 -0400] c_t: current version of sphinx for squeeze is... 0.9.9-6
[2012-03-27 23:53:56 -0400] mhalligan: i'm confused as to why it's failing on trying to use the each method?
[2012-03-27 23:54:12 -0400] bemu: Rorgo: I use the opscode hosted chef platform myself.
[2012-03-27 23:54:21 -0400] erratic: bemu dont blame you
[2012-03-27 23:54:27 -0400] bemu: But you can certainly set up your own server.
[2012-03-27 23:54:37 -0400] erratic: after what I went through today if I thought I could get away with getting my boss to fork out 1-300 a month
[2012-03-27 23:54:51 -0400] bemu: How much is your time worth?
[2012-03-27 23:55:08 -0400] c_t: that's why we don't run our own chef server, to be honest
[2012-03-27 23:55:09 -0400] bemu: Even if I spent a half day per month on chef server, it'd be more expensive than what we pay per month.
[2012-03-27 23:55:10 -0400] erratic: salary
[2012-03-27 23:55:12 -0400] erratic: but then again
[2012-03-27 23:55:30 -0400] erratic: success will be lucrative
[2012-03-27 23:55:42 -0400] bemu: It's opportunity cost for the business, not $ cost.
[2012-03-27 23:55:50 -0400] bemu: in terms of your salary/misuse of time.
[2012-03-27 23:56:02 -0400] mhalligan: does that error mean it's unable to apply .each since ptr_networks is nil?
[2012-03-27 23:56:18 -0400] bemu: mhalligan: Yes.
[2012-03-27 23:56:22 -0400] erratic: bemu excuse me?
[2012-03-27 23:56:37 -0400] bemu: erratic: Which part was confusing?
[2012-03-27 23:57:03 -0400] erratic: are you insinuating that was a waste of time?
[2012-03-27 23:57:05 -0400] bemu: I'm saying, if your boss chose to pay the $300/mo, it would allow you to use the time saved on more productive problems.
[2012-03-27 23:57:14 -0400] mhalligan: bemu: ah thanks!
[2012-03-27 23:57:20 -0400] bemu: Not at all, I'm arguing that it's likely you could have done better things with the time. :)
[2012-03-27 23:57:21 -0400] erratic: oh right
[2012-03-27 23:57:31 -0400] erratic: welllll
[2012-03-27 23:57:53 -0400] erratic: 300 a month vs like 400 for a days worth of work though?
[2012-03-27 23:58:01 -0400] bemu: It should be an easy sell, if you devote even a day per month to chef server.
[2012-03-27 23:58:13 -0400] Rorgo: I'm thinking I'm gonna have to find a way to replicate my chef server from my private environment into EC2
[2012-03-27 23:58:20 -0400] c_t: that chef server's unlikely to keep itself up and going without maintenance though
[2012-03-27 23:58:23 -0400] Rorgo: or get some EC2/VPC working I guess
[2012-03-27 23:58:44 -0400] bemu: erratic: How many of those days occur per month, is the question. And how many extended outages per year?
[2012-03-27 23:58:47 -0400] c_t: certainly if you want to run your own chef-server that's fine, it just might not be a money saver in the end is all
[2012-03-27 23:59:17 -0400] erratic: c_t we've evaluated what our scalability needs will be
[2012-03-27 23:59:22 -0400] erratic: and decided we'll need something
[2012-03-27 23:59:39 -0400] bemu: I suppose it may be a bit different in terms of economics for smaller, bootstrapped companies. The cost of chef server is like 1/200th of our total infrastructure spend. Maybe even less.
