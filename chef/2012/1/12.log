[2012-01-12 08:45:00 -0500] Babar: ok... why does chef think it's clever to create a deploy branch when it's doing anything with git???
[2012-01-12 08:45:00 -0500] Babar: is there a way to disable that?
[2012-01-12 08:46:00 -0500] Babar: "Keep in mind that if you use the command "git status" after running this recipe it will return the branch name as "deploy" regardless, as this is a default value." -- if it's a default value, it should be overwritable
[2012-01-12 09:45:00 -0500] lflux: ohai
[2012-01-12 09:51:00 -0500] lflux: One thing I don't like about chef: naming the recipe files default.rb. Can't tell them apart in my emacs when switching buffers...
[2012-01-12 09:53:00 -0500] BryanWB: lflux: do use ido-mode? it makes it easier
[2012-01-12 09:53:00 -0500] lflux: I use iswitchb
[2012-01-12 09:54:00 -0500] lflux: even in ido-mode they all show up as default<n>.rb, 2 < n < infty
[2012-01-12 10:00:00 -0500] BryanWB: lflux, hmm, doesn't show that way for me but i use the emacs-starter-kit, so i might have lots other stuff loaded
[2012-01-12 10:59:00 -0500] lflux: I get this nagging feeling that nobody really tested the postgresql resource provider...
[2012-01-12 11:33:00 -0500] BryanWB: lflux: fuck, that's my project for next week
[2012-01-12 11:34:00 -0500] BryanWB: and i have to add pgbounce support to it
[2012-01-12 11:41:00 -0500] russss: I still do my postgres servers manually because I'm paranoid (I don't even use the debian packages because there's some weird bits in them)
[2012-01-12 11:47:00 -0500] lflux: BryanWB: I have a couple pulls open for them and some other stuff I've done to it (like support for ROLEs(
[2012-01-12 11:49:00 -0500] BryanWB: lflux, kewl, i will have to look at your stuff, what is your github name
[2012-01-12 11:49:00 -0500] lflux: same as here
[2012-01-12 11:49:00 -0500] BryanWB: russss: do u know if there are any wird bits in the postgres rpms from pgrpms.com?
[2012-01-12 11:50:00 -0500] lflux: we use the PGDG rpms in production
[2012-01-12 11:51:00 -0500] lflux: i e from http://www.postgresql.org/ftp/binary/v8.4.6/linux/rpms/redhat/rhel-5-x86_64/
[2012-01-12 11:54:00 -0500] iroller: Hey. I have a questions about knife plugins. Knife don't see my plugin in my site-cookbooks/.chef/plugins/knife/plugin.rb if my current directory is not site-cookbooks. What am I doing wrong? I have correct cookbook_path variable in my knife.rb
[2012-01-12 11:57:00 -0500] iroller: So I can move .chef/plugins/knife anywhere, cd there and use knife my_plugin. But there is now word about CURRENT_DIR in Chef docs
[2012-01-12 12:26:00 -0500] yfeldblum: morning
[2012-01-12 12:26:00 -0500] BryanWB: yfeldblum: morning, gotten shot at yet? ;)
[2012-01-12 12:44:00 -0500] yfeldblum: not since we last spoke
[2012-01-12 12:44:00 -0500] yfeldblum: or ever
[2012-01-12 12:46:00 -0500] jonlives: iroller: that's not one of the standard places knife knows to look. look at the top of http://wiki.opscode.com/display/chef/Knife+Plugins
[2012-01-12 12:46:00 -0500] jonlives: iroller: if your .chef dir is in the root of your chef repo, it should work
[2012-01-12 12:47:00 -0500] iroller: quote: "Commands in a .chef/plugins/knife/ directory in your cookbook repo"
[2012-01-12 12:48:00 -0500] jonlives: iroller: it means the root of your chef repo :)
[2012-01-12 12:50:00 -0500] iroller: jonlives: then what do you mean under "chef repo"?
[2012-01-12 12:51:00 -0500] jonlives: iroller: the directory which contains cookbooks, roles, environments dirs
[2012-01-12 12:52:00 -0500] iroller: jonlives: ok and how does knife determine where is such directory?
[2012-01-12 12:56:00 -0500] jonlives: iroller: from the same wiki page: " If you share a chef repo with your team and would like to share the plugin, copy the file to CHEF_REPO/.chef/plugins/knife/."
[2012-01-12 12:56:00 -0500] jonlives: iroller: I never looked in to exactly how it worked :)
[2012-01-12 12:57:00 -0500] iroller: jonlives: as I understand CHEF_REPO == cookbook_path in your knife.rb
[2012-01-12 12:59:00 -0500] jonlives: iroller: I think you're mistaken. See http://wiki.opscode.com/display/chef/Configure+Management+Workstation+As+A+Chef-Client
[2012-01-12 13:00:00 -0500] jonlives: iroller: more specifically http://wiki.opscode.com/display/chef/Fast+Start+Guide#FastStartGuide-Step3%3AInstallChefandcreatethedirectoriesthatareneeded
[2012-01-12 13:02:00 -0500] yfeldblum: CHEF_REPO is the root of your git repository tree; cookbook_path is often an array including elements such as CHEF_REPO/cookbooks, CHEF_REPO/site-cookbooks, etc
[2012-01-12 13:08:00 -0500] iroller: yfeldblum: I have custom structure of my CHEF_REPO (it differs from opscode structure). So how can I point my knife to my CHEF_REPO?
[2012-01-12 13:10:00 -0500] iroller: I just want to find CHEF_REPO variable and change it :)
[2012-01-12 13:11:00 -0500] yfeldblum: CHEF_REPO is not a variable; we're just using it here as a convention to identify what the base path is that we're talking about
[2012-01-12 13:12:00 -0500] yfeldblum: knife starts off by looking in the current directory for a ./.chef/knife.rb and crawls up the directory tree looking a ./.chef/knife.rb in each parent directory; then it moves to looking for ~/.chef/knife.rb; the first one it finds is the one it uses
[2012-01-12 13:12:00 -0500] yfeldblum: after that, you can configure whatever you want in that knife.rb file
[2012-01-12 13:13:00 -0500] yfeldblum: and the directory containing ./.chef/knife.rb is the root of your chef-repo
[2012-01-12 13:13:00 -0500] `brendan: morning
[2012-01-12 13:14:00 -0500] iroller: yfeldblum: ok. I have knife repo in "/mykniferepo". My plugins are not working: "/myknife/.chef/knife/plugins" when my current directory is not "/myknife". What should I do?
[2012-01-12 13:14:00 -0500] yfeldblum: what do you mean you have a knife repo?
[2012-01-12 13:15:00 -0500] iroller: s/knife/chef/
[2012-01-12 13:15:00 -0500] iroller: repo with cookbooks, site-cookbooks and so on
[2012-01-12 13:16:00 -0500] yfeldblum: cd into that directory
[2012-01-12 13:17:00 -0500] iroller: so there is no way to have custom plugins work outside chef_repo directory?
[2012-01-12 13:18:00 -0500] iroller: I can upload my cookbooks being at any directory if my cookbook_path is correct. So why I can't use my custom plugins just like that?
[2012-01-12 13:34:00 -0500] iroller: I know I can create ~/.chef/knife/plugins/myplugin.rb and then I close my problem but I need to share my plugins to my team and so I need to keep them in chef-repo
[2012-01-12 13:45:00 -0500] lflux: Is there an easy way to cache information between recipes on a node?
[2012-01-12 13:46:00 -0500] lflux: In my data bag for configuring stuff I have only the name of other hosts, but in some templates I want to use the IP address.
[2012-01-12 13:46:00 -0500] lflux: But I don't want to look up or search the IP address in each recipe.
[2012-01-12 14:14:00 -0500] ranjibd: lflux, node.recipes
[2012-01-12 14:15:00 -0500] ranjibd: lflux, not cache , neither search but couch , Chef::Node.load(n.name).ipaddress
[2012-01-12 14:49:00 -0500] Dink: http://tinypaste.com/7630cc0e   Can someone take a quick look at that. Basically would like the last part to only run if the command was successful.
[2012-01-12 14:52:00 -0500] CharlieSu: If i have a RubyGem dependency that is required in a cookbook library, when does the gem need to be installed?  I'm currently running into issues with the AmazonEC2Tag cookbook and the aws-sdk gem
[2012-01-12 14:54:00 -0500] ssd7: Dink: Seems to me the thing to do would be to have the execute resource notify the final cookbook_file resource
[2012-01-12 14:54:00 -0500] ssd7: CharlieSu: Are you using omnibus?
[2012-01-12 14:55:00 -0500] Dink: ssd7: can you say that in plain english. Sorry very new to chef and still haven't learned the language.
[2012-01-12 14:57:00 -0500] ssd7: Dink: Apologies.  Still waking up here.  So, you have three resources.  A cookbook_file that places a temporary sudoers file, an execute resource that checks the temp file, and a cookbook_file that places the actual sudoers file.
[2012-01-12 14:57:00 -0500] CharlieSu: ssd7: yes i am
[2012-01-12 14:58:00 -0500] CharlieSu: ssd7: is that the issue?
[2012-01-12 14:58:00 -0500] ssd7: The problem with the way you have these right now.  Is that the temporary suoders file gets placed on the machine, the check gets skipped since the action is :nothing, and then you place the actual sudoers on disk
[2012-01-12 14:59:00 -0500] ssd7: then, the execute resource that checks file gets called
[2012-01-12 15:00:00 -0500] ssd7: But at that point, it is already on disk.  I think it would be safer to check the temporary file you put down and only place the actual file on disk when it is known to be good
[2012-01-12 15:00:00 -0500] CharlieSu: ssd7: What is the deal w/ using OnniBus ?
[2012-01-12 15:01:00 -0500] ssd7: CharlieSu: Since the ruby used for omnibus lives in its own little world, you need to take a bit more care about where gems get installed to if you want to use them in recipes vs using them on the system.
[2012-01-12 15:02:00 -0500] CharlieSu: ssd7: ok.  how would I install this gem differently?  And why would all of my other gems work correctly?   I'm not using this on the system.. only via recipe
[2012-01-12 15:03:00 -0500] ssd7: Dink: Example: https://gist.github.com/1c089ed685fac2daddac
[2012-01-12 15:04:00 -0500] ssd7: CharlieSu: By default gem_package will install it in a way such that you can use it in a chef library but not on the system.
[2012-01-12 15:04:00 -0500] CharlieSu: ssd7: well i'm doing just that but it isn't working..  I'm not doing anything on the system..
[2012-01-12 15:05:00 -0500] CharlieSu: ssd7: https://gist.github.com/4553c8055ec8a403360b
[2012-01-12 15:06:00 -0500] ssd7: CharlieSu: Hmm.  But it isn't found when you run chef?
[2012-01-12 15:06:00 -0500] CharlieSu: ssd7: correct
[2012-01-12 15:07:00 -0500] Dink: ssd7: so basically chef will run that recipe in order? Do the .tmp then the command and if it succeeds then the regular sudoers file ? If the command part fails will it still continue ?
[2012-01-12 15:08:00 -0500] ssd7: Dink: By default, if the command fails it will not continue.  You can put "ignore_failure true" in the resource if you would like to ignore failsures for that execute resource
[2012-01-12 15:09:00 -0500] Dink: ssd7: great thanks will give it a shot
[2012-01-12 15:10:00 -0500] CharlieSu: ssd7: https://gist.github.com/2a75cf23b15e18a095f3      That happens just when I add a dependency to this cookbook in the metadata of another one of my cookbooks.
[2012-01-12 15:16:00 -0500] CharlieSu: ssd7: any idea?
[2012-01-12 15:16:00 -0500] ssd7: CharlieSu: Sorry, I'm having trouble parsing that last bit.  So does the cookbook work alone or does it only pop up when you add this dependencies between cookbooks?
[2012-01-12 15:16:00 -0500] ssd7: If you boot up shef on that machine: shef -c /etc/chef/client.rb -z
[2012-01-12 15:17:00 -0500] ssd7: and require the library from inside shef, does it work?
[2012-01-12 15:20:00 -0500] CharlieSu: ssd7: the cookbook never works.  I'm not actually even using the cookbook.  I'm just including it in the metadata.rb file of another cookbook.
[2012-01-12 15:21:00 -0500] ssd7: Ok, that makes more sense at least (not that I have an idea based on that.)
[2012-01-12 15:22:00 -0500] CharlieSu: ssd7: i've looked at the gem installation in omnibus and it doesn't have the gem installed.  I just don't understand why that library needs the gem right now if it isn't even being used..
[2012-01-12 15:24:00 -0500] ssd7: CharlieSu: Well, when you include the cookbook as a dependency, it loads all the libraries.  When the library is loading there is really no good way to know whether it is being used later on or not.
[2012-01-12 15:24:00 -0500] CharlieSu: ssd7: well when the gem need to be installed?  before chef ever runs?  I don't get it.  Why doesn't this happen on my other cookbooks?
[2012-01-12 15:25:00 -0500] ssd7: CharlieSu: One sec, we have a good example of this.
[2012-01-12 15:27:00 -0500] ssd7: CharlieSu: So typically, to avoid the chicken and egg problem, we just allow the require to fail on the very first run of chef by resueing the error:
[2012-01-12 15:27:00 -0500] ssd7: https://github.com/opscode/cookbooks/blob/master/aws/libraries/ec2.rb
[2012-01-12 15:27:00 -0500] ssd7: and then install the gem in a recipe like this:
[2012-01-12 15:27:00 -0500] ssd7: https://github.com/opscode/cookbooks/blob/master/aws/recipes/default.rb
[2012-01-12 15:27:00 -0500] ssd7: That install will happen at "compile" time, so the gem should be around by the time you actually need it at run time.
[2012-01-12 15:28:00 -0500] CharlieSu: ssd7: nice.. i'll try that
[2012-01-12 15:30:00 -0500] ssd7: Dink: So, I'm not even sure if I would call this "advisable" but something that is "possible" with the features of chef & ruby is that you could also build the verification check right into the resource itself: https://gist.github.com/1278614
[2012-01-12 15:31:00 -0500] ssd7: It is a bit complicated and what you are doing will work just as well, just thought you might be interested in seeing it
[2012-01-12 15:31:00 -0500] Dink: ssd7: thanks will take a peek at it
[2012-01-12 15:32:00 -0500] BryanWB: jamie winsor around?
[2012-01-12 15:38:00 -0500] CharlieSu: ssd7: do you think the aws-sdk and aws-s3 gems may have any naming collisions?  'NameError: uninitialized constant AWS::S3::Base'   Not sure why i'm getting that now..  only thing I can think of is the new gem install
[2012-01-12 15:38:00 -0500] CharlieSu: ssd7: nothing else has changed
[2012-01-12 15:42:00 -0500] CharlieSu: ssd7: looks like there is some name collision between the aws-sdk and right_aws gem
[2012-01-12 15:43:00 -0500] ssd7: I'm unsure.  I'm not very familiar with those gems.
[2012-01-12 15:43:00 -0500] CharlieSu: or aws-s3.. not sure which one.. but when i removed the AmazonEC2Tag cookbook everything else started working agian
[2012-01-12 16:14:00 -0500] dyer: What is the url to teh universal bootstrap script ?
[2012-01-12 16:17:00 -0500] jtimberman: dyer: you mean the one used to install the chef-full package via the install script?
[2012-01-12 16:17:00 -0500] dyer: uh not sure to be quite frank, I am trying to use knife bootstrap
[2012-01-12 16:17:00 -0500] dyer: w/ a centos ami
[2012-01-12 16:17:00 -0500] jtimberman: mkdir -p ~/.chef/bootstrap; wget -O ~/.chef/bootstrap/chef-full.erb https://github.com/opscode/chef/tree/master/chef/lib/chef/knife/bootstrap/chef-full.erb
[2012-01-12 16:17:00 -0500] jtimberman: :)
[2012-01-12 16:17:00 -0500] dyer: tyvm
[2012-01-12 16:17:00 -0500] jtimberman: that will be available in the next release of Chef.
[2012-01-12 16:18:00 -0500] dyer: btw, the openvpn cookbook, you wrote that rigth?
[2012-01-12 16:19:00 -0500] statix: Pre-apology if this is a common question, but aside from manually reloading the client on all nodes, is there a way to "push" changes (updated cookbooks, roles, etc.) on the server to nodes, so all of the nodes update immediately?
[2012-01-12 16:19:00 -0500] dyer: Looks like it, according to the readme, just wanted to make suggestion.  First off its awesome, thanks!  only issue I had was that its not clear that you need to include the users recipe, this isn't mentioned anywhere int he readme
[2012-01-12 16:19:00 -0500] jtimberman: dyer: I did
[2012-01-12 16:19:00 -0500] btm: statix: knife ssh '*:*' sudo chef-client
[2012-01-12 16:19:00 -0500] jtimberman: dyer: Hm.
[2012-01-12 16:20:00 -0500] jtimberman: btm: probably want quotes around 'sudo chef-client' though
[2012-01-12 16:20:00 -0500] frank_: all
[2012-01-12 16:20:00 -0500] CharlieSu: jtimberman: Do you know if the aws-sdk and aws-s3 cookbooks may clash when naming constants? 'NameError: uninitialized constant AWS::S3::Base'   Not sure why I'm getting this now.  The only thing I'm doing differently is installing aws-sdk
[2012-01-12 16:20:00 -0500] frank_: is there a way to add something to a databag only for a certain role/host/...
[2012-01-12 16:20:00 -0500] dyer: something like "if you want to create users you need to include the users recipe, recipe[openvpn::users]" would have saved me a bit of time
[2012-01-12 16:20:00 -0500] statix: Thank you
[2012-01-12 16:20:00 -0500] frank_: i have a cookbook that autocreates users, based on databag "users"
[2012-01-12 16:21:00 -0500] jtimberman: CharlieSu: i'm not familiar with either of thse cookbooks
[2012-01-12 16:21:00 -0500] frank_: i'd need to add a user for a certain role
[2012-01-12 16:21:00 -0500] jtimberman: dyer: sorry about that
[2012-01-12 16:21:00 -0500] CharlieSu: jtimberman: do you know of any cookbook that tags ec2 instances?
[2012-01-12 16:21:00 -0500] jtimberman: CharlieSu: I do not.
[2012-01-12 16:21:00 -0500] btm: jtimberman: I've never quoted the command. but then, I'm a wild man.
[2012-01-12 16:22:00 -0500] dyer: Its cool, no worries, the time you saved me w/ the cookbook overall greatly out weighs that doc issue!!  Just making a suggestion so others don't run into the same thing
[2012-01-12 16:22:00 -0500] AmishGeek: can roles be versioned/have environments?
[2012-01-12 16:22:00 -0500] AmishGeek: or just create new roles?
[2012-01-12 16:22:00 -0500] dyer: Also, the link you gave me should be https://raw.github.com/opscode/chef/master/chef/lib/chef/knife/bootstrap/chef-full.erb
[2012-01-12 16:22:00 -0500] dyer: I think
[2012-01-12 16:23:00 -0500] jtimberman: btm: its the beard.
[2012-01-12 16:23:00 -0500] jtimberman: btm: i always quote it because i think in early versions it didn't do the name_args properly, and i never lost the habit
[2012-01-12 16:23:00 -0500] jtimberman: dyer: best thing to do is open a COOK ticket
[2012-01-12 16:24:00 -0500] dyer: Will do
[2012-01-12 16:24:00 -0500] jtimberman: dyer: because i'll forget this conversation happened by the time my irc client scrolls it off the screen :)
[2012-01-12 16:24:00 -0500] jtimberman: thanks :D
[2012-01-12 16:24:00 -0500] jtimberman: AmishGeek: roles can have environment specific run lists
[2012-01-12 16:24:00 -0500] dyer: Last question
[2012-01-12 16:25:00 -0500] jtimberman: AmishGeek: i saw something recently in the code about versioned run lists, but i can't remember what it was or how to use it. i don't think its documented :-|
[2012-01-12 16:25:00 -0500] dyer: How can I organize a devops / chef day in Atlanta?
[2012-01-12 16:25:00 -0500] lflux: jtimberman: has anyone really tested the postgresql parts of the database cookbook? I ran into some interesting errors with connections being kept open.
[2012-01-12 16:25:00 -0500] jtimberman: lflux: i think we're using that for some deployments, but i don't have the details. i have not personally used it for anything.
[2012-01-12 16:26:00 -0500] AmishGeek: ok, i'm not using environments yet, and i have to totally rewrite a couple recipes/roles, so its time to start using environments so i don't end up with cookbookabc1 and cookbookabc2
[2012-01-12 16:26:00 -0500] jtimberman: dyer: make a meetup and spread the word?
[2012-01-12 16:26:00 -0500] jtimberman: :)
[2012-01-12 16:26:00 -0500] lflux: jtimberman: I'll just file some more tickets then (when I get the patches ready)
[2012-01-12 16:26:00 -0500] jtimberman: dyer: there are chef users in atlanta that can probably assist in some way
[2012-01-12 16:26:00 -0500] jtimberman: lflux: k :)
[2012-01-12 16:26:00 -0500] dyer: yea, I mnow you guys have Seth in the area
[2012-01-12 16:26:00 -0500] dyer: plus a few guys from DTO, and Enstratus
[2012-01-12 16:27:00 -0500] jtimberman: i meant non-opscode people too :)
[2012-01-12 16:27:00 -0500] jtimberman: Yeah, John Vincent (lusis) and John Willis (botchagalupe) are both w/ Enstratus.
[2012-01-12 16:28:00 -0500] dyer: yep, met John on Tuesday at the Cloud Compute meeting
[2012-01-12 16:28:00 -0500] jtimberman: dyer: drop me an email and i'll get it along to the right folks here
[2012-01-12 16:28:00 -0500] dyer: will do
[2012-01-12 16:28:00 -0500] AmishGeek: oh, are chef peeps meeting up?
[2012-01-12 16:34:00 -0500] Brad_K: dyer: go to the page at http://devopsdays.org/contact/ and send e-mail to the address listed.  we're having another DevOps Day Austin here in April.
[2012-01-12 16:34:00 -0500] dyer: nice!
[2012-01-12 16:36:00 -0500] Brad_K: if you check the page at http://devopsdays.org/events/2012-austin/contact/ you may see at least one familiar name.  ;-)
[2012-01-12 16:42:00 -0500] lusis: oh hey
[2012-01-12 16:42:00 -0500] lusis: someone say my name?
[2012-01-12 16:43:00 -0500] jtimberman: lusis: NO
[2012-01-12 16:43:00 -0500] lusis: jtimberman: NO U
[2012-01-12 16:43:00 -0500] jtimberman: lusis: go back to your cave son
[2012-01-12 16:43:00 -0500] jtimberman: lusis: and put on some pants this time
[2012-01-12 16:43:00 -0500] lusis: according to my son, it's the batcave
[2012-01-12 16:43:00 -0500] jtimberman: lusis: i read your tweet as "petrified" not prettified"
[2012-01-12 16:43:00 -0500] lusis: hahaha
[2012-01-12 16:43:00 -0500] lusis: which is strangely apropos to putting on pants
[2012-01-12 16:44:00 -0500] lusis: though we're drifting into chef-hacking territory here
[2012-01-12 16:44:00 -0500] jtimberman: haha
[2012-01-12 16:44:00 -0500] jtimberman: i see nothing in these words about underground space robots or track stands.
[2012-01-12 16:45:00 -0500] lusis: okay gotta bail
[2012-01-12 16:45:00 -0500] BryanWB: jtimberman: i submitted a pull request for chef-server ckbk that adds an attribute webui_redirect_enabled  . It disables the 000-default vhost and creates a new one that redirects to chef-server-webui
[2012-01-12 16:45:00 -0500] BryanWB: jtimberman: i set it to false by default
[2012-01-12 16:46:00 -0500] BryanWB: jtimberman:  so  http://<hostname>/ redirects to :444   ,  but i kind of think it might be good from a usability point of view to set it to true by default. what u think?
[2012-01-12 16:50:00 -0500] jtimberman: BryanWB: i don't have a strong opinion about it right now.
[2012-01-12 16:52:00 -0500] gmcinnes: hey chefs. Is there a way to paramaterize roles by platform type? ie, I want to disable selinux in my baseline role, but only on centos nodes that use it.
[2012-01-12 16:52:00 -0500] Dink: What is wrong with this ?  ' FATAL: cookbook_file "/etc/sudoers.tmp" do '  ?
[2012-01-12 16:54:00 -0500] Dink:  syntax error, unexpected tSTRING_BEG, expecting $end
[2012-01-12 16:54:00 -0500] AmishGeek: do most people manage their environments via knife?
[2012-01-12 16:55:00 -0500] Dink: AmishGeek: I am starting off by doing it that way.
[2012-01-12 16:56:00 -0500] dodizzle: AmishGeek mostly but use the UI alot too
[2012-01-12 16:56:00 -0500] dodizzle: also keep my cookbooks in github
[2012-01-12 16:56:00 -0500] AmishGeek: and a node will always use the latest version of a cookbook unless otherwise specified in an environment...
[2012-01-12 16:56:00 -0500] dodizzle: yes
[2012-01-12 16:56:00 -0500] BryanWB: AmishGeek:  i edit everything  except nodes, by file, and then load it from file
[2012-01-12 16:57:00 -0500] AmishGeek: IE, if I create a production environment, i only need to list the cookbooks that must be locked to a version, and not every single cookbook, right?
[2012-01-12 16:57:00 -0500] gmcinnes: Dink: Pastie the whole error somewhere. Not in here.
[2012-01-12 16:58:00 -0500] Dink: gmcinnes: figured it out. There was a missing " in the package line. No where near that.
[2012-01-12 16:58:00 -0500] Dink: guess that was the first " after the missing "
[2012-01-12 17:00:00 -0500] gmcinnes: yeah. the ruby standard interpreter does not give great error messages. A lot of parsing errors on missing elements fall through to the end of the file
[2012-01-12 17:00:00 -0500] yfeldblum: use an editor with ruby syntax highlighting?
[2012-01-12 17:01:00 -0500] gmcinnes: yeah. that helps :)
[2012-01-12 17:02:00 -0500] gmcinnes: I should try cooking up my recipes under rubinius when I get a chance
[2012-01-12 17:03:00 -0500] gmcinnes: yfeldblum: what's the best way to have a recipe in a role run on only some platforms?
[2012-01-12 17:09:00 -0500] yfeldblum: gmcinnes, from 30,000 feet, that's usually a sign that you're doing it wrong :P
[2012-01-12 17:09:00 -0500] yfeldblum: gmcinnes, but more details plz?
[2012-01-12 17:09:00 -0500] yfeldblum: gmcinnes, what recipe, what platforms, and why?
[2012-01-12 17:11:00 -0500] gmcinnes: yfeldblum: you would think :)  I have a baseline role. All nodes get it. Some nodes are Ubuntu, some Centos.  I want to disable SELinux on the Centos ones.  I don't really want to have to manually find out if a node is CentOS and add an extra item to the run list
[2012-01-12 17:11:00 -0500] JasonBox: :(
[2012-01-12 17:12:00 -0500] gmcinnes: yfeldblum: It seems the ideal thing would be for the role to find out if it's running on CentOS and prepend the selinux::disable recipe to the runlist if it is
[2012-01-12 17:12:00 -0500] yfeldblum: gmcinnes, add your own cookbook & recipe, something like "recipe[gmcinnes::security]", and cookbook depends on the selinux cookbook (in metadata.rb) and, based on the platform, will either include_recipe "selinux" or not
[2012-01-12 17:12:00 -0500] yfeldblum: the recipe "gmcinnes::security" will, based on the platform, choose whether or not to `include_recipe "selinux"`
[2012-01-12 17:12:00 -0500] gmcinnes: yfeldblum: ah. ok. that's nicer.  thanks.
[2012-01-12 17:13:00 -0500] epsas: gmcines - you are talking about auditd, right?
[2012-01-12 17:13:00 -0500] yfeldblum: unfortunately, with this way, selinux will no longer show up in the expanded run-list at all for any nodes
[2012-01-12 17:13:00 -0500] yfeldblum: tradeoffs
[2012-01-12 17:13:00 -0500] gmcinnes: yfeldblum: yeah. that's a drawback, but it's not fatal.
[2012-01-12 17:14:00 -0500] JasonBox: Ah
[2012-01-12 17:14:00 -0500] gmcinnes: you know, this is the kinda stuff that should be in a chef book ;)  The wiki documentation is good, but where it's missing is on conventions like this for handling categories of problems.
[2012-01-12 17:15:00 -0500] yfeldblum: gmcinnes, don't know if it's a convention - if it is, i made it up independently for my own use
[2012-01-12 17:17:00 -0500] yfeldblum: :P
[2012-01-12 17:17:00 -0500] gmcinnes: Well, what I mean is there's often a variety of ways to achieve something, but its not always immediately clear what's the best or cleanest. Or what will be recognized easily by other maintainers.
[2012-01-12 17:18:00 -0500] yfeldblum: true
[2012-01-12 17:19:00 -0500] yfeldblum: well, if someone's writing a book on chef conventions, there was a freebie :P
[2012-01-12 17:20:00 -0500] gmcinnes: maybe I should start a chef cookbooks cookbook :)
[2012-01-12 17:21:00 -0500] gmcinnes: Anyway, thanks!
[2012-01-12 17:28:00 -0500] jtimberman: gmcinnes yfeldblum i still have on my to do list a cookbook style guide :)
[2012-01-12 17:30:00 -0500] gmcinnes: jtimberman: 'tis more than just cookbooks per se.  It's also about how the various parts interact.
[2012-01-12 17:31:00 -0500] lflux: Is there a cached way of finding facts about other hosts? Like say, IP addresses instead of calling Chef::Node.load(nodename).ipaddress which creates a load of HTTP traffic
[2012-01-12 17:31:00 -0500] gmcinnes: ie a problem like the one I just had could be solved in the role. It could be solved by hacking the selinux cookbook. It could be solved best by introducing another level of indirection, as yfeldblum says.
[2012-01-12 17:31:00 -0500] jtimberman: lflux: where are you doing Chef::Node.load(nodename).ipaddress?
[2012-01-12 17:32:00 -0500] jtimberman: lflux: generally, that is what 'search' is used for
[2012-01-12 17:32:00 -0500] jtimberman: gmcinnes: stop using selinux (trollface) :)
[2012-01-12 17:32:00 -0500] gmcinnes: That's what I'm trying to do :)  I don't want it.  Its another piece of blecherousness that comes with CentOS
[2012-01-12 17:33:00 -0500] lflux: jtimberman: I started out using search :) I configure a bunch of application environments, where I say stuff like 'dbhost':'qa-lab01', but I want to use the ipaddress of the node in my configuration file templates
[2012-01-12 17:33:00 -0500] gmcinnes: fscking Centos.
[2012-01-12 17:33:00 -0500] lflux: gmcinnes: that's the first thing you turn off in CentOS.
[2012-01-12 17:35:00 -0500] JasonBox: weird
[2012-01-12 17:35:00 -0500] JasonBox: At least setenforce 0
[2012-01-12 17:41:00 -0500] jtimberman: There are business or regulatory reasons why selinux needs to be enabled in some environments.
[2012-01-12 17:42:00 -0500] jtimberman: But (anecdotally) most people simply turn it off, makes me wonder why it's enabled by default.
[2012-01-12 17:42:00 -0500] gmcinnes: exactly.
[2012-01-12 17:42:00 -0500] gmcinnes: like most things in redhat land, it's the wrong default :)
[2012-01-12 17:45:00 -0500] zts: if it wasn't on by default, I wouldn't have any intention of figuring out what I need to do to keep it enabled
[2012-01-12 17:46:00 -0500] zts: at the same time, I've been disabling it for many years, and "learning it" has yet to reach the top of my todo list
[2012-01-12 17:48:00 -0500] zts: that'll probably change when someone adds support to Chef :)
[2012-01-12 17:54:00 -0500] JasonBox: I haven't studied it in depth and find a generous usage of setenforce 0, restorecon, and setcon are all I need
[2012-01-12 17:54:00 -0500] jhulten: I think its enabled with no policies...
[2012-01-12 17:54:00 -0500] atomic-penguin: Mostly because selinux is a pain in the neck, is why most people turn it off
[2012-01-12 17:55:00 -0500] jtimberman: I used it at a previous employer quite extensively
[2012-01-12 17:55:00 -0500] atomic-penguin: jtimberman, what regulation requires the use of selinux, just curious
[2012-01-12 17:55:00 -0500] jtimberman: my i have let all those parts of my brain deteriorate.
[2012-01-12 17:55:00 -0500] jtimberman: atomic-penguin: "regulatory"
[2012-01-12 17:55:00 -0500] jtimberman: perceived or actual is up to interpretation
[2012-01-12 17:56:00 -0500] jtimberman: I do not speak authoritatively.
[2012-01-12 17:56:00 -0500] jhulten: Or jtimberman can't talk about it cause he was working at the NSA.
[2012-01-12 17:56:00 -0500] jtimberman: also, my rhel-base role has "selinux::disabled"
[2012-01-12 17:57:00 -0500] jtimberman: (i don't have any production rhel systems, fwiw :))
[2012-01-12 17:57:00 -0500] atomic-penguin: I turn it off in kickstart
[2012-01-12 17:59:00 -0500] gmcinnes: yeah. in any case, its a PITA, even if you're forced to work with it.
[2012-01-12 17:59:00 -0500] gmcinnes: Also, personally I don't think it's that worthwhile.
[2012-01-12 18:00:00 -0500] gmcinnes: it's like apache: it introduces so much configuration complexity that it will inevitably be configured wrongly, leaving holes :)
[2012-01-12 18:01:00 -0500] atomic-penguin: Anybody spend several hours troubleshooting something simple, and come to find out later SELinux was turned on?  Or is it just me?
[2012-01-12 18:02:00 -0500] cwj: shave a yak? never
[2012-01-12 18:02:00 -0500] gmcinnes: Just you, and everyone else who's ever administered a RHEL based server ever :)
[2012-01-12 18:03:00 -0500] JasonBox: atomic-penguin: Yeah, sevearl times; My first debugging step is always setenforce 0 now
[2012-01-12 18:26:00 -0500] bkmontgomery: I've got a custom recipe that's trying to clone a public repo from github, though chef-client isn't actually cloning the repo.  Any thoughts?  http://dpaste.com/686697/
[2012-01-12 18:45:00 -0500] brent_: looking for a bit of help - I messed up a node definition, and now I can't delete, show, edit, etc it.  Tried via knife and the web console.  It quits with the error message "ERROR: ArgumentError: can't get const Chef::Resource::PythonVirtualenv: uninitialized constant Chef::Resource"  (I tried to stick a PythonVirtualenv into the node def)
[2012-01-12 18:45:00 -0500] brent_: just looking to get rid of the node somehow in chef
[2012-01-12 18:57:00 -0500] Dink: Hello with the following recipe http://tinypaste.com/252ea4ad I am getting this error http://tinypaste.com/ad0616b5 any help would be appreciated
[2012-01-12 19:00:00 -0500] mattray: Dink: the action for cookbook_file is :create not :run
[2012-01-12 19:00:00 -0500] mattray: Dink: line 15 of the recipe
[2012-01-12 19:06:00 -0500] Dink: mattray: sweet that did it
[2012-01-12 19:06:00 -0500] Dink: Thanks
[2012-01-12 19:06:00 -0500] mattray: np
[2012-01-12 19:06:00 -0500] KarlHungus: can i have additive attributes?
[2012-01-12 19:06:00 -0500] KarlHungus: such that role[b ase] pulls in a handful of base users and groups and specific roles can add to that attribute list?
[2012-01-12 19:08:00 -0500] lflux: ohai
[2012-01-12 19:08:00 -0500] jtimberman: KarlHungus: in a role, no.
[2012-01-12 19:08:00 -0500] jtimberman: KarlHungus: roles are purely declarative
[2012-01-12 19:08:00 -0500] jtimberman: KarlHungus: however, you can manipulate attributes in a recipe
[2012-01-12 19:08:00 -0500] jtimberman: as long as the attribute is an array, you can append to it like any other ruby array like:
[2012-01-12 19:08:00 -0500] jtimberman: foo = [1,2,3]
[2012-01-12 19:09:00 -0500] jtimberman: foo << 4
[2012-01-12 19:10:00 -0500] KarlHungus: hmm. got any references on good/best practices for managing users/groups?
[2012-01-12 19:10:00 -0500] jtimberman: KarlHungus: http://community.opscode.com/cookbooks/users
[2012-01-12 19:10:00 -0500] jtimberman: is how i manage users on my systems.
[2012-01-12 19:10:00 -0500] jtimberman: (and how we at Opscode manage users in production)
[2012-01-12 19:10:00 -0500] KarlHungus: yep. that works well
[2012-01-12 19:11:00 -0500] KarlHungus: but i dont want all users on all hosts
[2012-01-12 19:11:00 -0500] KarlHungus: so, if a server has a databs on it, i need to include the DBA group
[2012-01-12 19:11:00 -0500] KarlHungus: bah. database*
[2012-01-12 19:11:00 -0500] mattray: jtimberman: array and hash attributes are additive
[2012-01-12 19:12:00 -0500] jtimberman: mattray: Yes
[2012-01-12 19:12:00 -0500] jtimberman: may contain nitrates.
[2012-01-12 19:12:00 -0500] jtimberman: wrong kind of addititve?
[2012-01-12 19:13:00 -0500] KarlHungus: i've extended the users cookbook to allow me to set a groups array attribute, then the recipe will create those groups, walk the users databag and create the user resource for all groups that should be on the host
[2012-01-12 19:13:00 -0500] KarlHungus: this might be the Wrong Way
[2012-01-12 19:14:00 -0500] mattray: KarlHungus: sounds like a useful feature. Is it a separate recipe for the users cookbook?
[2012-01-12 19:15:00 -0500] KarlHungus: mattray: i can show you. one sec
[2012-01-12 19:16:00 -0500] KarlHungus: https://gist.github.com/eb589b8d4aded51cf689
[2012-01-12 19:16:00 -0500] KarlHungus: its pretty much the users cookbook with a twist
[2012-01-12 19:24:00 -0500] KarlHungus: mattray: i should modify it to fit in the users cookbook
[2012-01-12 19:24:00 -0500] KarlHungus: that should be simple enough
[2012-01-12 19:29:00 -0500] AmishGeek: can a role have a run_list in addition to env_run_list?
[2012-01-12 19:31:00 -0500] AmishGeek: ie:  run_list "role[base]"  ..  env_run_lists "prod" => ["recipe[myapp]"], "dev" => ["recipe[myapp]","recipe[logging]"]
[2012-01-12 19:32:00 -0500] AmishGeek: so both prod and dev environments would have the base role?
[2012-01-12 19:51:00 -0500] gmcinnes: anyone aware of a better firewall cookbook for CentOS?
[2012-01-12 19:52:00 -0500] mattray: patches welcome for additional providers for the firewall cookbook
[2012-01-12 19:52:00 -0500] gmcinnes: :)
[2012-01-12 19:52:00 -0500] mattray: I did ufw because that's what the customer wanted
[2012-01-12 19:53:00 -0500] mattray: iptables "should" be fairly straightforward
[2012-01-12 19:53:00 -0500] gmcinnes: I might have a go at it after I get a decent stack built out for these guys.
[2012-01-12 19:54:00 -0500] gmcinnes: Right now I'm blocking folks.
[2012-01-12 19:54:00 -0500] JasonBox: hrm, I keep wanting to try out ferm
[2012-01-12 20:06:00 -0500] bkmontgomery: I've got a data bag describing "staging" and "production"  apache configs, and web_app (from the apache2 cookbook) seems to always enable both, though I only want the "staging" enabled.  Any thoughts why?  Pertinent data bag and recipe bits are here:  http://dpaste.com/686724/   - Thanks in advance!
[2012-01-12 20:09:00 -0500] bemu: bkmontgomery: That's exactly the behavior you specified.
[2012-01-12 20:09:00 -0500] bemu: You're looping through them.
[2012-01-12 20:10:00 -0500] bemu: You'll want to either wrap the contents of the search block in an if statement and exclude the one you don't want to use (hacky, but least changes), or load the right databag, preferably using environment.
[2012-01-12 20:11:00 -0500] bkmontgomery: So, if I understand you, web_app is enabling both configs because "enable: true" was the last value it saw from the data bag?
[2012-01-12 20:12:00 -0500] bemu: oh, I'm sorry. I misread.
[2012-01-12 20:13:00 -0500] bemu: I don't know enough about the web_app provider. Sorry.
[2012-01-12 20:13:00 -0500] bkmontgomery: np
[2012-01-12 20:42:00 -0500] frank_: all: how do I change an attribute (specified in cookbook/attributes) for nodes with certain role?
[2012-01-12 20:46:00 -0500] mattray: frank_: you can set the attribute in the role (or do you mean something else?)
[2012-01-12 20:46:00 -0500] jtimberman: frank_: use 'default_attributes' or 'override_attributes' in the role
[2012-01-12 20:46:00 -0500] mattray: http://wiki.opscode.com/display/chef/Roles#Roles-defaultattributes
[2012-01-12 20:47:00 -0500] frank_: jtimberman: when to use default, when override?
[2012-01-12 20:47:00 -0500] jtimberman: attributes?
[2012-01-12 20:47:00 -0500] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-01-12 20:47:00 -0500] jtimberman: frank_: *usually* you'll use default_attributes.
[2012-01-12 20:47:00 -0500] frank_: ah
[2012-01-12 20:47:00 -0500] jtimberman: frank_: it depends on how those attributes may be used elsewhere in your code.
[2012-01-12 20:47:00 -0500] mattray: frank_: Precedence is doc'd here: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-01-12 20:48:00 -0500] frank_: i did this: http://pastie.org/private/jqe83h3o7pxxninlzpaa
[2012-01-12 20:48:00 -0500] frank_: but it doesn't seem to work
[2012-01-12 20:48:00 -0500] frank_: i have default[:apache][:mpm] ="somethingelse" in apache cookbook/attributes
[2012-01-12 20:49:00 -0500] mattray: frank_: I don't believe you need "normal"
[2012-01-12 20:50:00 -0500] jtimberman: mattray frank_: correct, remove the "normal" line, and the matching end-brace.
[2012-01-12 20:50:00 -0500] frank_: mattray: if I set default_attribute to A in the role, and to B in the cookbook that gets included, will it be A or B?
[2012-01-12 20:50:00 -0500] mattray: frank_: back to that precedence table, the role
[2012-01-12 20:51:00 -0500] jtimberman: frank_: if it is "default" in the cookbook's attributes file, then the role will win
[2012-01-12 20:51:00 -0500] frank_: jtimberman: aha, ok thanks
[2012-01-12 20:51:00 -0500] mattray: frank_: assuming that "in the cookbook" you mean an attributes file and not in a recipe
[2012-01-12 20:51:00 -0500] frank_: mattray: yes
[2012-01-12 20:51:00 -0500] mattray: cool
[2012-01-12 20:51:00 -0500] mattray: that precedence table comes in handy :)
[2012-01-12 20:51:00 -0500] frank_: so i'd put it default_attribute instead of override_attribute, and ditch the normal level
[2012-01-12 20:52:00 -0500] mattray: but you'll get the hang of it
[2012-01-12 20:52:00 -0500] jtimberman: frank_: fwiw, using override is fine, just be aware of the precedence levels if you want to override (or not) elsewhere :)
[2012-01-12 21:36:00 -0500] Boohbah: hey guys, opscode meetup coming up soon?
[2012-01-12 21:37:00 -0500] thehar: there's one at our offices end of the month
[2012-01-12 21:37:00 -0500] thehar: here in SF
[2012-01-12 21:41:00 -0500] mattray: Boohbah: yup
[2012-01-12 21:41:00 -0500] mattray: Boohbah: http://www.eventbrite.com/event/2311846796/eorg
[2012-01-12 21:42:00 -0500] mattray: Boohbah: I think there's one in Seattle too
[2012-01-12 21:42:00 -0500] thehar: come visit us :)
[2012-01-12 21:44:00 -0500] thehar: mattray: are you coming?
[2012-01-12 21:45:00 -0500] mattray: I'm not currently planning on it, since I'm in Austin
[2012-01-12 21:45:00 -0500] jtimberman: thehar: I'll be there for the preceding training, but unfortunately won't be able to make it to the hack day
[2012-01-12 21:45:00 -0500] thehar: aw sad faces
[2012-01-12 21:45:00 -0500] thehar: we have 4 kegerators the need abusing in our new office
[2012-01-12 21:45:00 -0500] thehar: heavy. abuse.
[2012-01-12 21:45:00 -0500] jtimberman: haha
[2012-01-12 21:46:00 -0500] thehar: homebrew?
[2012-01-12 21:46:00 -0500] bawt: homebrew is the only true way, applicable even to coffee :)
[2012-01-12 21:46:00 -0500] jtimberman: aye
[2012-01-12 21:46:00 -0500] jtimberman: lol
[2012-01-12 21:46:00 -0500] thehar: these are commercial brews from all over
[2012-01-12 21:46:00 -0500] jtimberman: bawt: forget homebrew
[2012-01-12 21:46:00 -0500] bawt: lemme take care of that for you
[2012-01-12 21:46:00 -0500] thehar: but still.
[2012-01-12 21:46:00 -0500] jtimberman: thehar: i've been brewing beer for ~12 years
[2012-01-12 21:47:00 -0500] thehar: started homebrew last year.. been fun
[2012-01-12 21:47:00 -0500] thehar: made a killer pseudo pils
[2012-01-12 21:48:00 -0500] thehar: welp. i invite all to come to the hack day
[2012-01-12 21:48:00 -0500] thehar: should be good times
[2012-01-12 21:53:00 -0500] bemu: thehar: I'm coming, and posted on the SF DevOps meetup!
[2012-01-12 21:54:00 -0500] thehar: wooooo
[2012-01-12 21:54:00 -0500] atomic-penguin: jtimberman, do you have a homebrew shop near, or do you order supplies over the internet?
[2012-01-12 21:55:00 -0500] thehar: bemu: we were discussing making our office a meetup for chef for SF
[2012-01-12 21:55:00 -0500] thehar: if this works out :)
[2012-01-12 21:56:00 -0500] bemu: thehar: Sounds good to me, there has only been one meetup for Chef User Group since I've been out here (8 months+). No Chef or interesting ones from SV DevOps, which leaves just my meetup (SF DevOps). I'd have more meetings if there were people who wanted to speak.
[2012-01-12 21:57:00 -0500] thehar: bemu: mind changint the location name on that posting?
[2012-01-12 21:57:00 -0500] bemu: Not at all.
[2012-01-12 21:57:00 -0500] thehar: Lookout Mobile Security
[2012-01-12 21:57:00 -0500] bemu: I just copied from the previous post.
[2012-01-12 21:57:00 -0500] thehar: hehe there was a miscommunication
[2012-01-12 21:57:00 -0500] thehar: tyvm
[2012-01-12 21:58:00 -0500] Boohbah: mattray: are you or any other ops in seattle?
[2012-01-12 21:59:00 -0500] Boohbah: ircops that is
[2012-01-12 21:59:00 -0500] bemu: Updated!
[2012-01-12 21:59:00 -0500] thehar: yay
[2012-01-12 21:59:00 -0500] jnh: Hi all. I have a machine that was previously working, but now when I run chef-client it says FATAL: Net::HTTPServerException: 401 "Unauthorized"
[2012-01-12 21:59:00 -0500] jtimberman: atomic-penguin: there's two homebrew supply stores within reasonable driving distance of my house. there are at least 3 others in the metro area that i know of that have good selection and prices.
[2012-01-12 21:59:00 -0500] jnh: ot
[2012-01-12 22:00:00 -0500] jnh: client is 0.10.0. server is opscode platform.
[2012-01-12 22:00:00 -0500] bemu: I'd be interested in having more "hack day" meetups though. Especially if I don't have to lead discussions. :P
[2012-01-12 22:00:00 -0500] mattray: Boohbah: kallistic is in Seattle
[2012-01-12 22:01:00 -0500] thehar: bemu: hehe
[2012-01-12 22:02:00 -0500] yfeldblum: jnh is that server's clock off?
[2012-01-12 22:03:00 -0500] yfeldblum: jnh and by "off", i mean has that server's clock drifted too far from what the rest of us think the time is?
[2012-01-12 22:05:00 -0500] jnh: yfeldblum: nope, doesn't appear to have. I've just stopped ntp, run ntpdate manually and then restarted ntp to make sure.
[2012-01-12 22:10:00 -0500] yfeldblum: jnh hmmm well i took a shot
[2012-01-12 22:15:00 -0500] thehar: of what?
[2012-01-12 22:32:00 -0500] jnh: yfeldblum: thanks anyway.
[2012-01-12 23:00:00 -0500] mib_mib: hi guys, when i do a knife client-list, it returns my node, but when i try to run the getting started recipe on the node using: knife ssh name:NODENAME -a NODE-IP -x ubuntu -i ~/.ec2/ec2key.pem "sudo chef-client" it says "No Nodes Returned from Search!" Can someone help me?
[2012-01-12 23:01:00 -0500] mattray: mib_mib: -a is which field you want to see from the returned search
[2012-01-12 23:01:00 -0500] mattray: s/field/attribute/
[2012-01-12 23:01:00 -0500] mattray: try leaving it off, or just using "-a ipaddress"
[2012-01-12 23:02:00 -0500] mattray: nevermind, I totally misread that
[2012-01-12 23:02:00 -0500] mattray: no, I read that rright
[2012-01-12 23:02:00 -0500] mattray: try "-a ipaddress"
[2012-01-12 23:02:00 -0500] mib_mib: no worrries - if i put the debug flag it has: Sending HTTP Request via GET to api.opscode.com:443/organizations/myorganization/search/node
[2012-01-12 23:02:00 -0500] miah: bemu: who says we have to have a speaker? why not just organized hack / support days?
[2012-01-12 23:03:00 -0500] mattray: mib_mib: or "-a ec2.public_hostname"
[2012-01-12 23:03:00 -0500] mib_mib: let me try that instead of the ip address
[2012-01-12 23:03:00 -0500] mattray: I've used both I believe
[2012-01-12 23:04:00 -0500] mib_mib: yeah that doesnt work either
[2012-01-12 23:05:00 -0500] mib_mib: i dont understand why it cant find the node
[2012-01-12 23:05:00 -0500] mattray: does knife search find it?
[2012-01-12 23:05:00 -0500] mib_mib: what is knife search?
[2012-01-12 23:06:00 -0500] mattray: http://wiki.opscode.com/display/chef/Search has examples
[2012-01-12 23:07:00 -0500] mib_mib: yea found the node... weird
[2012-01-12 23:08:00 -0500] mib_mib: even though its running the same search as knife ssh according to the debug output
[2012-01-12 23:08:00 -0500] mattray: post it with debug output somewhere?
[2012-01-12 23:12:00 -0500] mib_mib: http://pastebin.com/003scrUG
[2012-01-12 23:12:00 -0500] mib_mib: it has both commands with debug output - so weird
[2012-01-12 23:13:00 -0500] mib_mib: even though it 'appears' to be doing the same search
[2012-01-12 23:14:00 -0500] mattray: yeah, that's what I was saying on the knife ssh
[2012-01-12 23:14:00 -0500] mattray: try
[2012-01-12 23:14:00 -0500] mattray: knife ssh "name:*" -a ipaddress -x ubuntu -i ~/.ec2/ec2key.pem "sudo chef-client"
[2012-01-12 23:14:00 -0500] mattray: knife ssh is searching for a result, then pulling the -a field to pass into ssh to run the command
[2012-01-12 23:15:00 -0500] mib_mib: wait isnt that waht i just did?
[2012-01-12 23:15:00 -0500] mattray: no
[2012-01-12 23:15:00 -0500] mattray: don't use "-a ec2-XXX-XX-XXX-XX.compute-1.amazonaws.com"
[2012-01-12 23:15:00 -0500] bemu: miah: I'm not opposed, I just worry that people will get bored of that.
[2012-01-12 23:15:00 -0500] mattray: use "-a ipaddress"
[2012-01-12 23:16:00 -0500] bemu: I'm always up for hacking on Chef projects :D
[2012-01-12 23:16:00 -0500] mib_mib: okay - i tried just the ip address - same thing...
[2012-01-12 23:16:00 -0500] mib_mib: i can regular ssh fine into the box
[2012-01-12 23:16:00 -0500] itwasntandy: mattray: what do you have against ssh?
[2012-01-12 23:17:00 -0500] mib_mib: so chef has some weird shiz going on
[2012-01-12 23:17:00 -0500] itwasntandy: s/ssh/dns/
[2012-01-12 23:17:00 -0500] miah: bemu: cool. if you ever want to get together let me know
[2012-01-12 23:17:00 -0500] miah: i work alone all the time and i work from home
[2012-01-12 23:17:00 -0500] mattray: mib_mib: try "-a ec2.public_hostname" and pastebin that
[2012-01-12 23:17:00 -0500] mib_mib: ohhh
[2012-01-12 23:17:00 -0500] mattray: itwasntandy: whatever works
[2012-01-12 23:17:00 -0500] mib_mib: u mean put quotes around the "-a hostname"
[2012-01-12 23:17:00 -0500] mattray: itwasntandy: I've found -a ipaddress to work most places, so I stick with it
[2012-01-12 23:18:00 -0500] mib_mib: ?
[2012-01-12 23:18:00 -0500] mib_mib: the ec2 public hostname is what i put in the firstime int he pastebin
[2012-01-12 23:18:00 -0500] bemu: I've been going to a client site almost every day lately, and working crazy hours, so not right off. But I'm down to co-work in the future! After I eliminate GAE. Finally.
[2012-01-12 23:18:00 -0500] itwasntandy: I've found using dns works in most places. Where dns hasn't work, I've generally found there's a bigger problem to solve :)
[2012-01-12 23:19:00 -0500] mattray: mib_mib: I wonder if that search is wonky
[2012-01-12 23:19:00 -0500] mib_mib: yeah maybe it isnt searching the right thing
[2012-01-12 23:19:00 -0500] mib_mib: i tried putting just the node name in
[2012-01-12 23:19:00 -0500] mib_mib: that iddnt work
[2012-01-12 23:19:00 -0500] mattray: yeah, it won't
[2012-01-12 23:20:00 -0500] mib_mib: is there an index
[2012-01-12 23:20:00 -0500] mib_mib: that has to update on the chef server or something
[2012-01-12 23:20:00 -0500] mib_mib: that isn't up to date..?
[2012-01-12 23:20:00 -0500] mattray: no, I think there's something about that search with ssh
[2012-01-12 23:20:00 -0500] mattray: lemme fire up some ec2
[2012-01-12 23:20:00 -0500] mib_mib: kewl
[2012-01-12 23:21:00 -0500] mib_mib: could i use the -q option to specify the search query or something?
[2012-01-12 23:22:00 -0500] mattray: no, it's something about your query
[2012-01-12 23:22:00 -0500] mattray: Hosted Chef or your own?
[2012-01-12 23:23:00 -0500] mib_mib: hosted chef
[2012-01-12 23:23:00 -0500] mib_mib: http://tickets.opscode.com/browse/CHEF-2847 could this be related?
[2012-01-12 23:23:00 -0500] mib_mib: how do i know if the ssh attribute is nil
[2012-01-12 23:24:00 -0500] mattray: do a "knife node show NODENAME -a ipaddress"
[2012-01-12 23:24:00 -0500] mattray: where NODENAME is the ec2 box
[2012-01-12 23:24:00 -0500] mattray: ipaddress is not nil
[2012-01-12 23:25:00 -0500] mib_mib: ok what that does is say the ipaddress with a colon after it
[2012-01-12 23:25:00 -0500] mib_mib: i.e. 172.122.22.22:
[2012-01-12 23:27:00 -0500] bzrk: /server irc.freenode.net;
[2012-01-12 23:28:00 -0500] mib_mib: mattray: does it work for you?
[2012-01-12 23:29:00 -0500] mattray: testing
[2012-01-12 23:29:00 -0500] mib_mib: ok
[2012-01-12 23:30:00 -0500] mib_mib: the only things ive done are delete on old node using the opscode web-interface (not the one im using though) and i tried setting the 'list' permissions for the current node
[2012-01-12 23:31:00 -0500] mattray: https://gist.github.com/1603801
[2012-01-12 23:32:00 -0500] mattray: it works with either "name:*" or "*:*"
[2012-01-12 23:34:00 -0500] mib_mib: hmmm
[2012-01-12 23:34:00 -0500] mib_mib: so what is the problem here?
[2012-01-12 23:34:00 -0500] mib_mib: is it a permissions issue??
[2012-01-12 23:35:00 -0500] mattray: can you run that same command (with your .pem) and gist it?
[2012-01-12 23:35:00 -0500] mattray: or pastebin
[2012-01-12 23:36:00 -0500] mattray: that is your .pem and you used an ubuntu user?
[2012-01-12 23:36:00 -0500] miah: hrm. is the runit cookbook totally broken or just not working for me? =)
[2012-01-12 23:37:00 -0500] mib_mib: mattray: it says the exact same thing but i'll pastebin it anyway - yes, if i do ssh -i ~/.ec2/ec2key.pem ubuntu@myipaddress it works fine
[2012-01-12 23:38:00 -0500] mib_mib: oh wait
[2012-01-12 23:38:00 -0500] mib_mib: is this pem file
[2012-01-12 23:38:00 -0500] mib_mib: my pem to ssh into ec2
[2012-01-12 23:38:00 -0500] mib_mib: or for chef
[2012-01-12 23:39:00 -0500] mattray: ssh into ec2
[2012-01-12 23:39:00 -0500] mib_mib: ok just checking
[2012-01-12 23:39:00 -0500] mattray: whatever .pem you used when you did the "knife ec2 server create"
[2012-01-12 23:40:00 -0500] mib_mib: i just added a comment to ur gist
[2012-01-12 23:40:00 -0500] mattray: here was my server create
[2012-01-12 23:40:00 -0500] mattray: knife ec2 server create -S mray -i ~/.ssh/mray.pem -x ubuntu -G default -I ami-a7a97dce -f m1.small -d omnibus
[2012-01-12 23:40:00 -0500] mattray: see how I'm using "-a ec2.public_hostname"
[2012-01-12 23:40:00 -0500] mattray: you don't use "-a ec2-107-XX-XXX-XX.compute-1.amazonaws.com"
[2012-01-12 23:41:00 -0500] mattray: that is an exact copy and paste of what I did
[2012-01-12 23:41:00 -0500] mattray: paste this into your CLI
[2012-01-12 23:42:00 -0500] mattray: knife ssh "name:*" -a ec2.public_hostname -x ubuntu -i ~/.ec2/ec2key.pem "sudo chef-client" -VV
[2012-01-12 23:42:00 -0500] miah: doesn't seem to be creating the link in /etc/service (on ubuntu)
[2012-01-12 23:42:00 -0500] mib_mib: wow so literally 'ec2.public_hostname'
[2012-01-12 23:43:00 -0500] mattray: yes
[2012-01-12 23:43:00 -0500] mattray: "name:*" is a search for nodes
[2012-01-12 23:43:00 -0500] mib_mib: oh wow
[2012-01-12 23:43:00 -0500] mattray:  the -a is the field to pass into the ssh command
[2012-01-12 23:43:00 -0500] mattray: from that search
[2012-01-12 23:43:00 -0500] mib_mib: ah cool
[2012-01-12 23:43:00 -0500] mib_mib: so what does 'ec2.public_hostname' actually do
[2012-01-12 23:43:00 -0500] mattray: all the nodes that return from the search will have attributes
[2012-01-12 23:44:00 -0500] mattray: those that have node['ec2']['public_hostname'] will get passed to SSH
[2012-01-12 23:44:00 -0500] mattray: so you don't need to know anything about the nodes, you just search for ones that meet your needs
[2012-01-12 23:45:00 -0500] mattray: I gotta head home, so good luck
[2012-01-12 23:48:00 -0500] JasonBox: Interesting
[2012-01-12 23:58:00 -0500] mib_mib: thanks!
