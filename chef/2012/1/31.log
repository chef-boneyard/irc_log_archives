[2012-01-31 09:13:00 -0500] nacer: BryanWB: you there ?
[2012-01-31 09:13:00 -0500] nacer: yout here ?
[2012-01-31 09:13:00 -0500] nacer: grrr
[2012-01-31 09:13:00 -0500] nacer: your
[2012-01-31 09:13:00 -0500] BryanWB: hey dude
[2012-01-31 09:13:00 -0500] BryanWB: bon jour
[2012-01-31 09:13:00 -0500] nacer: ciao :)
[2012-01-31 09:13:00 -0500] nacer: i'am looking at your vmware-tools cookbook
[2012-01-31 09:14:00 -0500] nacer: are you sure about this stuff it look weird
[2012-01-31 09:14:00 -0500] BryanWB: i haven't updated that in a while
[2012-01-31 09:14:00 -0500] BryanWB: check the newer one
[2012-01-31 09:14:00 -0500] BryanWB: https://github.com/bryanwb/cookbooks/tree/master/vmware-tools
[2012-01-31 09:14:00 -0500] BryanWB: i use it everyday and it works for me
[2012-01-31 09:15:00 -0500] BryanWB: all the rm -rf    are pretty scary
[2012-01-31 09:15:00 -0500] BryanWB: but the perl script provided by vmware will fail if any of those files exist
[2012-01-31 09:16:00 -0500] nacer: BryanWB: yeah, you seam to clean a other installation method of vmware-tools
[2012-01-31 09:17:00 -0500] BryanWB: yes, because i had installed it earlier w/ rpms, but that cause problems
[2012-01-31 09:17:00 -0500] BryanWB: see the not_if, won't do those steps if rpms not installed
[2012-01-31 09:17:00 -0500] nacer: BryanWB: anyway i use ubuntu
[2012-01-31 09:18:00 -0500] nacer: BryanWB: i think you can make all this bash code in chef code
[2012-01-31 09:18:00 -0500] BryanWB: that definitely would be better
[2012-01-31 09:18:00 -0500] BryanWB: i wrote it under a lot of pressure
[2012-01-31 09:19:00 -0500] nacer: BryanWB: exept the cleaning part , your recipe seam usable on ubuntu
[2012-01-31 09:19:00 -0500] hippiehacker: |shad0w| how do you disable the plugin?
[2012-01-31 09:19:00 -0500] BryanWB: should be, i should test it there
[2012-01-31 09:19:00 -0500] hippiehacker: in client.rb ?
[2012-01-31 09:19:00 -0500] nacer: BryanWB: do you know if esxi have local http server that serve the guest-tools ?
[2012-01-31 09:20:00 -0500] BryanWB: it should
[2012-01-31 09:20:00 -0500] BryanWB: that's where I got it orriginally, but never found way to discover the address of the local http server
[2012-01-31 09:22:00 -0500] nacer: BryanWB: yeah auto discover will be difficult
[2012-01-31 09:22:00 -0500] BryanWB: so I just have a 'corporate' url for stashing that stuff
[2012-01-31 09:22:00 -0500] nacer: BryanWB: i will put them in my datastore, it seem we can access the datastore with https://192.168.1.9/folder?dcPath=ha-datacenter&dsName=datastore1
[2012-01-31 09:23:00 -0500] BryanWB: most of the important parts of that cookbook are in the attributes/default
[2012-01-31 09:23:00 -0500] BryanWB: datastore?
[2012-01-31 09:23:00 -0500] nacer: BryanWB: esxi storage
[2012-01-31 09:24:00 -0500] nacer: your attribute repo.corp.url is weird name
[2012-01-31 09:24:00 -0500] nacer: oh ok i understand you put all your corp file here
[2012-01-31 11:11:00 -0500] nacer: BryanWB: http://packages.vmware.com/tools/esx/index.html
[2012-01-31 11:36:00 -0500] BryanWB: there is a problem w/ using the prms
[2012-01-31 11:36:00 -0500] BryanWB: nacer: ^^
[2012-01-31 11:37:00 -0500] BryanWB: after I installed from rpms, vsphere shows the VM as running "unknown, 3rd party"
[2012-01-31 11:37:00 -0500] BryanWB: this can cause problems if u trying to upgrade the underlying esx host, or so I am told
[2012-01-31 11:47:00 -0500] BryanWB: nacer: i created that cookbook because my vmware-admin insisted i use the tarball that came w/ the esxhost
[2012-01-31 11:48:00 -0500] BryanWB: nacer: u may also want to look at the yumrepo::vmwaretools recipe
[2012-01-31 11:48:00 -0500] BryanWB: which uses the rpms
[2012-01-31 12:05:00 -0500] gyre007: I'm trying to authenticate against hosted chef but I'm failing with the following error statement: Failed to AUTHENTICATE. Synchronize your clock. what the heck :)
[2012-01-31 12:10:00 -0500] BryanWB: gyre007: anything w/ security will fail if your time is wrong
[2012-01-31 12:10:00 -0500] BryanWB: gyre007: is your ntp-client working properly?
[2012-01-31 12:12:00 -0500] gyre007: BryanWB, id assume so...but will double check...
[2012-01-31 12:13:00 -0500] BryanWB: gyre007: running it in a vm? vm's notoriously have time problems
[2012-01-31 12:16:00 -0500] gyre007: BryanWB, yeah VM
[2012-01-31 12:16:00 -0500] gyre007: it's showing up the time about 5 days back and some american time...cool
[2012-01-31 12:16:00 -0500] gyre007: is there any way how to fix that ? this is weird because /etc/sysconfig/clock is set up correctly
[2012-01-31 12:17:00 -0500] BryanWB: start ntpd
[2012-01-31 12:17:00 -0500] BryanWB: or ntp client
[2012-01-31 12:17:00 -0500] gyre007: BryanWB, I did...
[2012-01-31 12:17:00 -0500] BryanWB: try   $ ntpstat
[2012-01-31 12:17:00 -0500] gyre007: I think this might be related to SAVING the state of the VM...
[2012-01-31 12:17:00 -0500] gyre007: so the VM is keeping even the time
[2012-01-31 12:17:00 -0500] BryanWB: oh yeah
[2012-01-31 12:18:00 -0500] BryanWB: yup
[2012-01-31 12:18:00 -0500] gyre007: I might try to restart the bitch
[2012-01-31 12:18:00 -0500] BryanWB: u can sync ntp from cmd line, but if forget the cmd
[2012-01-31 12:18:00 -0500] gyre007: could be something like ntpdate
[2012-01-31 12:18:00 -0500] gyre007: or someting
[2012-01-31 12:22:00 -0500] BryanWB: i think ntpdate  time.foo.org
[2012-01-31 12:22:00 -0500] BryanWB:  but stop ntpd first
[2012-01-31 12:22:00 -0500] gyre007: BryanWB, I restarted the VM...and that damn it hasn't changed :D
[2012-01-31 12:23:00 -0500] gyre007: what the heck haha
[2012-01-31 12:24:00 -0500] BryanWB: what about your chef-server? hosted chef or your own? that time has to be correct o
[2012-01-31 12:24:00 -0500] BryanWB: s/o/too/
[2012-01-31 12:25:00 -0500] nico: hum
[2012-01-31 12:25:00 -0500] nico: is it possible to notify resource in other cookbooks ?
[2012-01-31 12:25:00 -0500] gyre007: BryanWB, hosted chef
[2012-01-31 12:25:00 -0500] gyre007: free account...
[2012-01-31 12:26:00 -0500] gyre007: just trying to learn how to use it
[2012-01-31 12:26:00 -0500] BryanWB: gyre007: then the issue is on your client
[2012-01-31 12:26:00 -0500] gyre007: BryanWB, I know that :D just need to figure out how to fix it
[2012-01-31 12:26:00 -0500] BryanWB: gyre007: stop ntpd  on your server, ntpdate  some.timeserver.org,
[2012-01-31 12:26:00 -0500] gyre007: will try
[2012-01-31 12:28:00 -0500] gyre007: BryanWB, I shut down the VM completely...and started it back on. All works as a charm. Cheers for help
[2012-01-31 12:29:00 -0500] BryanWB: np, make sure u fix the time issue otherwise it will soon stop working
[2012-01-31 12:29:00 -0500] BryanWB: in about 40 mins
[2012-01-31 12:29:00 -0500] gyre007: BryanWB, I have reconfigured ntp and chkconfigged it and started on as well...
[2012-01-31 12:31:00 -0500] nico: I have a recipe that puts stuff in /etc/rsyslog.d, notifying service rsyslog. This recipes comes after the syslog one that defines the rsyslog service but I still get the "... service[rsyslog] cannot be found in the resource collection ..." message
[2012-01-31 12:32:00 -0500] nico: any idea on how to solve this ?
[2012-01-31 12:37:00 -0500] BryanWB: nico: so u r notifying a service in different recipe?
[2012-01-31 12:38:00 -0500] nico: BryanWB: trying to :)
[2012-01-31 12:38:00 -0500] BryanWB: r u using  include_recipe "rsyslog::recipe_that_creates_rsyslog_service"  ?
[2012-01-31 12:38:00 -0500] nico: nope
[2012-01-31 12:39:00 -0500] nico: I just figured out I could notify a service whom recipe is before in the run_list
[2012-01-31 12:43:00 -0500] ranjibd: nico, you have the include_recipe in the dependent recipe?
[2012-01-31 12:44:00 -0500] nico: nope
[2012-01-31 12:44:00 -0500] BryanWB: nico: i don't think so, the service[...] won't be in your scope
[2012-01-31 12:44:00 -0500] BryanWB: unless u use include_recipe
[2012-01-31 12:45:00 -0500] BryanWB: otherwise your scope would be full  of crap ;)
[2012-01-31 12:45:00 -0500] nico: gonna test include_recipe
[2012-01-31 12:57:00 -0500] ranjibd: if you include the recipe.. you can notify   the includes recipe's  resources too
[2012-01-31 13:00:00 -0500] nico: http://pastie.org/3288662
[2012-01-31 13:00:00 -0500] nico: still fails
[2012-01-31 13:01:00 -0500] BryanWB: maybe u have to namespace it, service[syslog::rsyslog]
[2012-01-31 14:04:00 -0500] dort: The knife-ec2 gem seems to want me to put my aws_secret_access_key in knife.rb! Is there no way to tell it to use some provate key or something? Dont want to store my password in plaintext, either in knife.rb or a Bash env variable...
[2012-01-31 14:47:00 -0500] drrk: Don't suppose you fancy providing sparc architecture debian packages?
[2012-01-31 14:53:00 -0500] mattray: drrk: I don't think we'd object to hosting them
[2012-01-31 14:53:00 -0500] mattray: drrk: not sure we have access to hardware right now
[2012-01-31 14:53:00 -0500] drrk: hmm, that could potentially be arranged
[2012-01-31 14:54:00 -0500] drrk: there is only a very few packages that are binary isn't there?
[2012-01-31 14:54:00 -0500] drrk: most are 'all'
[2012-01-31 14:54:00 -0500] mattray: most
[2012-01-31 14:55:00 -0500] mattray: but there are a few binary bits
[2012-01-31 14:55:00 -0500] mattray: I had this discussion with an ARM vendor last week
[2012-01-31 14:55:00 -0500] Brad_K: i've got four UltraSPARC 10 clones sitting in storage, completely unused.  don't know if any of them are functional anymore, but i'd be happy to donate them to a good cause.
[2012-01-31 14:56:00 -0500] mattray: Brad_K: let me discuss it with btm and see how we want to handle getting and maintaining packages
[2012-01-31 14:56:00 -0500] mattray: for stuff we don't have direct access to
[2012-01-31 14:56:00 -0500] Brad_K: 'k
[2012-01-31 14:56:00 -0500] yfeldblum: mattray, i would suggest maintaining such packages via intuition
[2012-01-31 14:57:00 -0500] yfeldblum: and/or using other people's production as your integration test lab
[2012-01-31 14:57:00 -0500] mattray: yfeldblum: yeah, we're working towards that
[2012-01-31 14:58:00 -0500] drrk: in the mean time i'll have to compile my own set, I was just thinking about updates
[2012-01-31 14:59:00 -0500] BryanWB: yfeldblum: mattray  good morning
[2012-01-31 14:59:00 -0500] mattray: BryanWB: and good afternoon to you
[2012-01-31 15:00:00 -0500] mattray: drrk: the full stack client install may be easier
[2012-01-31 15:00:00 -0500] mattray: drrk: https://github.com/opscode/omnibus
[2012-01-31 15:00:00 -0500] drrk: I have to have it as debs, it's policy
[2012-01-31 15:00:00 -0500] mattray: yeah, it spits out debs
[2012-01-31 15:00:00 -0500] drrk: ah right
[2012-01-31 15:00:00 -0500] mattray: they just happen to include all the dependencies
[2012-01-31 15:00:00 -0500] mattray: and install to /opt/opscode
[2012-01-31 15:02:00 -0500] drrk: hmm, I think i'll build the debs! it seems an aful overkill
[2012-01-31 15:03:00 -0500] drrk: i'm sure chef deosn't depend on java
[2012-01-31 15:03:00 -0500] laurent\: solr does :)
[2012-01-31 15:05:00 -0500] laurent\: i also think it's a bit overkill for distribs with packages system, but in the end it's just a matter of launching an omnibus vm, building the package and making them available on a web server
[2012-01-31 15:05:00 -0500] drrk: except I can't easily have a debian sparc vm
[2012-01-31 15:06:00 -0500] yfeldblum: BryanWB, good afternoon
[2012-01-31 15:07:00 -0500] laurent\: let's hope it's still possible to build debian packages without omnibus
[2012-01-31 15:07:00 -0500] laurent\: (i'm still gem install'ing on my debian servers)
[2012-01-31 15:11:00 -0500] mattray: laurent\: absolutely. Omnibus just makes it easier for all those other platforms (Windows, Solaris, RHEL)
[2012-01-31 15:14:00 -0500] moos3: is there away to run a command once across all nodes with a given role
[2012-01-31 15:16:00 -0500] mattray: moos3: knife ssh "role:base" "yourcommand" -a ipaddress
[2012-01-31 15:17:00 -0500] mattray: put the name of the role in place of "base" and whatever you want as your command, ie. "chef-client"
[2012-01-31 15:18:00 -0500] moos3: basically I want to be do all nodes role[web] "cd /www/application;svn up"
[2012-01-31 15:18:00 -0500] KarlHungus: is cucumber-chef still active? are there other ways to test chef? any suggestions or simply good ideas on what direction i should be heading?
[2012-01-31 15:19:00 -0500] BryanWB: KarlHungus: last I tried  it, it had some serious bugs
[2012-01-31 15:20:00 -0500] mattray: moos3: knife ssh "role:web" "cd /www/application;svn up" -a ipaddress
[2012-01-31 15:20:00 -0500] BryanWB: KarlHungus: the maintainer is a really awesome guy, but has too busy over last serveral months to keep it up-to-date
[2012-01-31 15:20:00 -0500] BryanWB: s/has/has been/
[2012-01-31 15:20:00 -0500] moos3: mattray -a ipaddress i have 600 Webs, :D
[2012-01-31 15:20:00 -0500] BryanWB: it is a great project and it is just a few pull requests away from being really useful
[2012-01-31 15:20:00 -0500] moos3: and its ec2
[2012-01-31 15:21:00 -0500] moos3: is there a better way ?
[2012-01-31 15:21:00 -0500] KarlHungus: BryanWB: yeah. i'm noticing the low number of updates recently, but there seem to be some fairly active forks
[2012-01-31 15:21:00 -0500] mattray: moos3: I believe there's batching built into knife ssh
[2012-01-31 15:21:00 -0500] moos3: k
[2012-01-31 15:21:00 -0500] BryanWB: KarlHungus: i would check the forks
[2012-01-31 15:21:00 -0500] KarlHungus: BryanWB: what other tools are available to me?
[2012-01-31 15:21:00 -0500] BryanWB: foodcritic, chef-minitest
[2012-01-31 15:22:00 -0500] KarlHungus: i feel like i need to add some serious quality checks
[2012-01-31 15:22:00 -0500] BryanWB: fuck, mattray and i really need to do a show on this topic
[2012-01-31 15:22:00 -0500] mattray: BryanWB: look for LordCope and we can rope him in
[2012-01-31 15:27:00 -0500] KarlHungus: foodcritic is great
[2012-01-31 15:27:00 -0500] KarlHungus: i haven't seen minitest
[2012-01-31 15:27:00 -0500] KarlHungus: i was really enamoured with the cucumber-chef approach =)
[2012-01-31 15:28:00 -0500] thom: they're all pretty complementary
[2012-01-31 15:29:00 -0500] BryanWB: KarlHungus: there is another tool that the author of foodcritic is working on, can't remember name
[2012-01-31 15:31:00 -0500] gmcinnes: huh. foodcritic looks interesting.
[2012-01-31 15:32:00 -0500] gmcinnes: cool. I learn so much lurking here :)
[2012-01-31 15:33:00 -0500] BryanWB: gmcinnes: any progress on your postgres ckbk?
[2012-01-31 15:34:00 -0500] gmcinnes: BryanWB: Sorta. I'm still not happy with it, but I've kludged around the issues.  If you remember, I was trying to make sure the master came up first and then the slave came up, and was configured with log shipping.
[2012-01-31 15:35:00 -0500] BryanWB: gmcinnes: using streaming replication, right?
[2012-01-31 15:35:00 -0500] moos3: is possible to run a recipe once with out it being in the run list ?
[2012-01-31 15:35:00 -0500] gmcinnes: BryanWB: No. Log shipping.
[2012-01-31 15:35:00 -0500] BryanWB: gmcinnes: shit, i don't even know what that is :(
[2012-01-31 15:35:00 -0500] yfeldblum: gmcinnes, kludged how?
[2012-01-31 15:36:00 -0500] gmcinnes: BryanWB: It just rsyncs the logs between machines. Real streaming isn't available 'till Postgres 9. CentOS is still at Postgres 8.x
[2012-01-31 15:36:00 -0500] BryanWB: gmcinnes: did u also look at the database meta-cookbook?
[2012-01-31 15:37:00 -0500] BryanWB: gmcinnes: have u used  yum.postgresql.org ?
[2012-01-31 15:37:00 -0500] BryanWB: has rpms for 9
[2012-01-31 15:37:00 -0500] BryanWB: there is even a yumrepo::postgresql recipe to install the repo on your machine
[2012-01-31 15:37:00 -0500] gmcinnes: I kludged the timing by setting flags on the nodes like 'master_ready' = true. 'slave_ready' = true. Nasty, but it seems to work.
[2012-01-31 15:38:00 -0500] yfeldblum: gmcinnes, why not have the slave recipe connect to the master using the pg client tools or the pg gem and check if it's ready?
[2012-01-31 15:38:00 -0500] gmcinnes: BryanWB: For support contract reasons I have to stay on the official CentOS repo.  I don't need some joker telling me we've got an unsupported configuration :(
[2012-01-31 15:39:00 -0500] BryanWB: gmcinnes: fuck, i didn't even know the official centos repos were official :p
[2012-01-31 15:40:00 -0500] gmcinnes: BryanWB: I don't suppose they are, in some sense. But the app that runs on these machines has one or two "officially supported configurations".
[2012-01-31 15:41:00 -0500] gmcinnes: yfeldblum: I *think* I tried that and there was some kind of race condition that made it necessary to use those flags as locks.  But I can't remember now.
[2012-01-31 15:42:00 -0500] gmcinnes: I'll put it on my list to revisit tho. First get it working, then get it working right :)
[2012-01-31 15:43:00 -0500] gmcinnes: Speaking of which, Anyone who's around this morning have a nagios instance being alerted on failing chef runs?
[2012-01-31 15:44:00 -0500] thom: gmcinnes: Mithrandir has nagios alerting on chef stuff i believe (although i think it's time based (node x hasn't converged in two days))
[2012-01-31 15:46:00 -0500] gmcinnes: yeah, someone pointed out using knife's  ohno plugin to do that, which is doable, but is going to take me all day. I don't want to do that if someone's done it already.
[2012-01-31 15:50:00 -0500] nico: gmcinnes: yes, got this
[2012-01-31 15:51:00 -0500] gmcinnes: KarlHungus: It looks like the foodcritic guy has quite a bit of Chef testing stuff https://github.com/acrmp
[2012-01-31 15:52:00 -0500] matti: Oh, nico here too ;]
[2012-01-31 15:52:00 -0500] matti: \o/
[2012-01-31 15:52:00 -0500] gmcinnes: nico: awesome. would you be willing to share? Or point me in the right direction? How did you tackle it?
[2012-01-31 15:53:00 -0500] nico: http://pastie.org/private/3nfyixpzdpvupy4jrul1qg
[2012-01-31 15:53:00 -0500] KarlHungus: gmcinnes: ahh. thank you!
[2012-01-31 15:53:00 -0500] yfeldblum: gmcinnes, possibly have a chef-client handler that writes a file on failure and deletes the file on success, and a nagios check that checks for the existence of the file?
[2012-01-31 15:54:00 -0500] nico: we also check if chef server searches are fine
[2012-01-31 15:54:00 -0500] gmcinnes: BryanWB:  Sorry, I didn't mention. No, I didn't use the database meta cookbook.
[2012-01-31 15:55:00 -0500] nico: but this one would need some refinement before being published (we have a nagios gem/lib that we are using to ease checks development)
[2012-01-31 15:55:00 -0500] BryanWB: gmcinnes: why not?
[2012-01-31 15:56:00 -0500] nico: yfeldblum: this would require nrpe
[2012-01-31 15:57:00 -0500] yfeldblum: nico, yes it would
[2012-01-31 15:58:00 -0500] gmcinnes: BryanWB: I'm not a huge fan of it. I get the rationale behind it, but I've found that for setting up the replication stuff etc it just gets in the way.
[2012-01-31 15:58:00 -0500] gmcinnes: BryanWB: I may start using it when I'm actually pushing out app databases in deployments etc.
[2012-01-31 15:59:00 -0500] yfeldblum: gmcinnes, possibly have a chef-client handler that separately loads the node, writes an override-level "error" attribute on the node, and saves it, and a nagios check that searches the chef-server for nodes where that attribute exists
[2012-01-31 16:04:00 -0500] gmcinnes: yfeldblum: I don't really want to have to save to the node 'unnaturally'.
[2012-01-31 16:05:00 -0500] gmcinnes: yfeldblum: Just in case the client run fails in some undefined state and some weird stuff gets saved to the node.
[2012-01-31 16:09:00 -0500] gmcinnes: yfeldblum: If I guarantee that the saving doesn't happen until the end of the client run, then node 'check-in' time is a good proxy for whether the run happened or not. Make sense?
[2012-01-31 16:10:00 -0500] yfeldblum: gmcinnes, that relies on the nagios check knowing exactly how your chef-client runs are scheduled
[2012-01-31 16:12:00 -0500] gmcinnes: yfeldblum: It does. In the sense that I say if a client hasn't checked in in the last 6 hours, then send me an alert (for example)
[2012-01-31 16:13:00 -0500] yfeldblum: gmcinnes, absolutely, although that is now alerting based on time since last successful run, rather than alerting immediately based on failed runs
[2012-01-31 16:14:00 -0500] gmcinnes: true. I can live with that for now :)
[2012-01-31 16:24:00 -0500] jespada: awesome.. I was on my way to implement something like yfeldblum  mentioned about nagios check (the same way) but just read irc log and i think I will use nico's way, thank you both :)
[2012-01-31 16:25:00 -0500] BryanWB: good night folks
[2012-01-31 16:25:00 -0500] drrk: Brad_K: Jane has been trying to get hold of you...
[2012-01-31 16:26:00 -0500] Brad_K: drrk: got her e-mail last night, but we've been trying to push to production yet once again, and i've been so busy that i haven't even looked at it.  thanks for the reminder!
[2012-01-31 16:26:00 -0500] drrk: no problem - I am just wanting to know how much your expenses will be as i've been looking at the budget :)
[2012-01-31 16:28:00 -0500] Brad_K: you will be pleased to know that my wife has worked very hard to get the costs down.  the tickets themselves cost way less than the taxes+fees.  we're also staying at a less expensive place than the official hotels that had been listed.
[2012-01-31 16:29:00 -0500] drrk: fair enough, i'm also not stayign in an official hotel :)
[2012-01-31 16:29:00 -0500] drrk: i'm off to the states in July and the taxes etc are more than the flights
[2012-01-31 16:51:00 -0500] drrk: I ahe a new request regarding chef for sparc on debian, can you please upload the source package for the binary packages you have on apt.opscode.com please
[2012-01-31 16:52:00 -0500] drrk: eg there is source for chef_0.9.16+dfsg-1 but a binary for chef_0.9.18+dfsg-1
[2012-01-31 16:53:00 -0500] drrk: there seems the be soure and binary for chef_0.10 but I understand that is not backwardsly compatible?
[2012-01-31 16:53:00 -0500] laurent\: yep good idea, also i'd say omnibus should definatly provide these source packages when building the binary ones
[2012-01-31 16:55:00 -0500] drrk: i'm not keen on using omnibus as a) it seems over kill, and b) you said installs to /opt
[2012-01-31 16:56:00 -0500] drrk: am I right that chef 0.10 is not backwardsly compatible with chef 0.9.18 ?
[2012-01-31 16:56:00 -0500] drrk: or can I just upgrade?
[2012-01-31 16:58:00 -0500] ssd7: drrk: Are you running your own server or are you on Hosted Chef?
[2012-01-31 16:59:00 -0500] drrk: neither, jsut chef-solo
[2012-01-31 16:59:00 -0500] drrk: file distribution is handled seperatly
[2012-01-31 16:59:00 -0500] drrk: (for now)
[2012-01-31 17:00:00 -0500] dyer: Hey everyone!
[2012-01-31 17:00:00 -0500] ssd7: Ahh.  Hmmm.  I'm less familiar with what changed in the DSL from 0.9.18 to 0.10 unfortunately
[2012-01-31 17:00:00 -0500] ssd7: drrk: Would you mind opening a ticket on tickets.opscode.com about the source package issue you mentioned?
[2012-01-31 17:00:00 -0500] drrk: no problem
[2012-01-31 17:01:00 -0500] dyer: Question, is there anyway to override a template resource pulled in from an inhereted cookbook ?
[2012-01-31 17:01:00 -0500] drrk: also when I have built all these sparc binarys i'll put them somewhere they can be grabbed by others
[2012-01-31 17:03:00 -0500] jtimberman: ssd7: "not much" changed, as I understand the DSL remains the same.
[2012-01-31 17:05:00 -0500] ssd7: jtimberman: Yeah, that is my general sense too.  I have some memory of something about deploy vs deploy_revision
[2012-01-31 17:06:00 -0500] drrk: done, CHEF-2901
[2012-01-31 17:08:00 -0500] ssd7: drrk: Thanks :)
[2012-01-31 17:14:00 -0500] drrk: shall I bug report my ohai build error too?
[2012-01-31 17:35:00 -0500] jbz: Doh.
[2012-01-31 17:36:00 -0500] jbz: Fell off the server, in case anyone had responded to me. :-(
[2012-01-31 17:47:00 -0500] jbz: Hm, OK, related question.  Is there a way to get the 'start of run' time from inside a chef recipe?
[2012-01-31 17:47:00 -0500] jbz: So I can pull out the relevant log section?
[2012-01-31 17:55:00 -0500] ivey: anyone using knife-euca?
[2012-01-31 17:56:00 -0500] jbz: Hm, that's available in chef-handlers...
[2012-01-31 17:56:00 -0500] jbz: ok
[2012-01-31 17:56:00 -0500] ivey: having an issue w/ euca's replay detection
[2012-01-31 17:57:00 -0500] cap10morgan: where is provide_service defined? seems like it should be in the runit cookbook, but i can't find it.
[2012-01-31 17:58:00 -0500] jbz: Okay, *new* question.  How can I run a report-handler only if a particular resource fires during a run?
[2012-01-31 18:02:00 -0500] miah: cap10morgan: its defined in the definitions/runit_service.rb
[2012-01-31 18:03:00 -0500] cap10morgan: miah: i don't see it in there. at least, "provide_service" doesn't match anything in that file.
[2012-01-31 18:03:00 -0500] miah: line 142
[2012-01-31 18:04:00 -0500] spheromak: cd ..
[2012-01-31 18:04:00 -0500] spheromak: bleh
[2012-01-31 18:04:00 -0500] spheromak: hi miah!
[2012-01-31 18:04:00 -0500] spheromak: :P
[2012-01-31 18:04:00 -0500] miah: hihi spheromak
[2012-01-31 18:04:00 -0500] miah: ok. now to finish making haproxy use runit
[2012-01-31 18:05:00 -0500] cap10morgan: miah: i see a parameterized service definition there. how does a call to "provide_service" end up there? is there something built-in to chef to do that?
[2012-01-31 18:06:00 -0500] miah: ok, line 147 then =)
[2012-01-31 18:06:00 -0500] miah: what are you trying to do though?
[2012-01-31 18:06:00 -0500] cap10morgan: just trying to figure out what provide_service is doing.
[2012-01-31 18:07:00 -0500] cap10morgan: line 147 is "provider Chef::Provider::Service::Init"
[2012-01-31 18:07:00 -0500] miah: right
[2012-01-31 18:07:00 -0500] miah: so that sets the provider
[2012-01-31 18:41:00 -0500] dyer: Hrm
[2012-01-31 18:41:00 -0500] dyer: The application cookbook seems to be missing the example databag
[2012-01-31 18:42:00 -0500] dyer: "Below is a paste of the JSON, where the value is a description of the key. Use your own values, as required."
[2012-01-31 18:42:00 -0500] dyer: but there is nothing pasted below that
[2012-01-31 18:45:00 -0500] ssd7_: dyer: hmmm.  There are some examples in the git repo: https://github.com/opscode/cookbooks/tree/master/application/examples/data_bags/apps
[2012-01-31 18:46:00 -0500] dyer: ah, ok, cool
[2012-01-31 18:46:00 -0500] dyer: I didnt see those
[2012-01-31 18:46:00 -0500] ssd7_: I don't think they get pulled into the community site unfortnately
[2012-01-31 18:46:00 -0500] dyer: but still I think the readme should either be corrected, or an example should be put where its expected ;)
[2012-01-31 18:46:00 -0500] dyer: I opned a ticket in Jira for that
[2012-01-31 18:48:00 -0500] ssd7_: dyer: Thanks :)
[2012-01-31 18:48:00 -0500] dyer: np
[2012-01-31 18:49:00 -0500] jamescarr: What is the best practice for writing a cookbook for something like, say, weblogic?
[2012-01-31 18:49:00 -0500] jamescarr: I guess you host the installer locally somewhere and have the cookbook fetch it?
[2012-01-31 18:58:00 -0500] spheromak: jamescarr: i've packaged native packages for stuf like that
[2012-01-31 18:59:00 -0500] spheromak: jamescarr: then used chef to install that  (assuming you run a local mirror) or install it over http. don't want to include big binary blobs in your cook if you can help it.  Then use chef to do the customizations on config etc.
[2012-01-31 19:01:00 -0500] dyer: ssd7_, I went ahead and fixed it myself and sent a pull request
[2012-01-31 19:28:00 -0500] jslatts: I'm trying to use the opscode recipe for apt (1.2.2) and getting this "Chef::Exceptions::Exec: apt-get -q -y install update-notifier-common=0.117ubuntu3.1 returned 100, expected 0" when it tries to run
[2012-01-31 19:28:00 -0500] jslatts: the distro string _should_ be 0.117ubuntu3.2 i believe, but I can't figure out why its picking up the wrong one
[2012-01-31 19:48:00 -0500] jtimberman: dyer: did you create a ticket for the issue at tickets.opscode.com?
[2012-01-31 19:49:00 -0500] dyer: yep
[2012-01-31 19:49:00 -0500] dyer: COOK-1005
[2012-01-31 19:50:00 -0500] jtimberman: thanks :D
[2012-01-31 19:51:00 -0500] dyer: np
[2012-01-31 19:55:00 -0500] mattray: jslatts: try doing an apt-get update, then re-running the chef run
[2012-01-31 19:56:00 -0500] mattray: you may need to include the apt recipe
[2012-01-31 19:58:00 -0500] jslatts: mattray: I am using the apt recipe, it should be running the update altogether
[2012-01-31 19:58:00 -0500] mattray: odd
[2012-01-31 19:58:00 -0500] jslatts: err, automatically i mean
[2012-01-31 19:59:00 -0500] jslatts: hrm
[2012-01-31 19:59:00 -0500] jslatts: yeah, once i manually run apt-get update, it works
[2012-01-31 20:11:00 -0500] rfuentes: jslatts, maybe it need root previleges
[2012-01-31 20:11:00 -0500] jslatts: rfuentes: its got root
[2012-01-31 20:12:00 -0500] jslatts: its just getting the wrong distro string until after apt-get update
[2012-01-31 20:12:00 -0500] rfuentes: and what says the stacktrace of chef?
[2012-01-31 20:12:00 -0500] volker-: hi
[2012-01-31 20:12:00 -0500] rfuentes: wrong distro?  jslatts
[2012-01-31 20:12:00 -0500] rfuentes: can you be more verbose please?
[2012-01-31 20:13:00 -0500] jslatts: chef tries to run "apt-get -q -y install update-notifier-common=0.117ubuntu3.1" instead of "apt-get -q -y install update-notifier-common=0.117ubuntu3.2"
[2012-01-31 20:13:00 -0500] volker-: how can i set a node specific attribute? and how can i store this efficient (e.g. all nodes in a file with their specific attributes)
[2012-01-31 20:15:00 -0500] volker-: role won't work here, because every node has some specific attributes which need to be set individually
[2012-01-31 20:16:00 -0500] ssd7_: jslatts: The apt repo and an apt-get update resource that you can notify if you need to run it in the middle of a chef client run.
[2012-01-31 20:17:00 -0500] ssd7_: s/repo/cookbook
[2012-01-31 20:27:00 -0500] miketheman: when using the omnibus installer on ubuntu 11.10, making a "gem_package" call fails.
[2012-01-31 20:27:00 -0500] rismoney: trying to use windows cookbooks and the windows_feature and when I run chef-client it processes, but it doesn't perform the activity
[2012-01-31 20:28:00 -0500] jslatts: ssd7_: I must be missing something. I just have it doing recipe[apt]in its role
[2012-01-31 20:28:00 -0500] miketheman: seems like a dependency of adding gems to the embedded version of ruby is gcc?
[2012-01-31 20:28:00 -0500] jslatts: ssd7_: looks like the apt recipe tries to run an update
[2012-01-31 20:37:00 -0500] miketheman: reported here previously, and again now: http://tickets.opscode.com/browse/CHEF-2848?focusedCommentId=21600&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-21600
[2012-01-31 20:43:00 -0500] fujin: miketheman: have you got libshadow?
[2012-01-31 20:43:00 -0500] fujin: i would have anticipated the omnibus installer to include gcc
[2012-01-31 20:43:00 -0500] fujin: given that it has to build some gems..
[2012-01-31 20:47:00 -0500] miketheman: fujin: my code tried to determine which chef is installed - if distro's, then use libshadow, but since it's omnibus I have to gem_package instead
[2012-01-31 20:47:00 -0500] miketheman: and if build utils ain't there, it yells at me
[2012-01-31 20:48:00 -0500] fujin: so.. put the tools there and profit?
[2012-01-31 20:48:00 -0500] fujin: you neeed libshadow*-dev to build the gem
[2012-01-31 20:48:00 -0500] fujin: as well as compiler
[2012-01-31 20:48:00 -0500] miketheman: yeah, works fin after build-essential installed
[2012-01-31 20:48:00 -0500] fujin: (buildessential)
[2012-01-31 20:48:00 -0500] miketheman: now I have something I have to add to my boostrap
[2012-01-31 20:48:00 -0500] fujin: yeah, sucks
[2012-01-31 20:48:00 -0500] miketheman: but this is _bad_ since I'd never want a prod machine to have compilation tools on it
[2012-01-31 20:49:00 -0500] miketheman: not a selling factor for omnibus install
[2012-01-31 20:49:00 -0500] fujin: what was your expectation? that omnibus would include a compiler, or libshadow?
[2012-01-31 20:49:00 -0500] erikh: you're going to have trouble installing most gems, too
[2012-01-31 20:49:00 -0500] fujin: any gem with a c extension will hoark
[2012-01-31 20:49:00 -0500] erikh: like chef
[2012-01-31 20:49:00 -0500] erikh: well ohai specifically IIRC
[2012-01-31 20:49:00 -0500] volker-: how do I modify a specific node attribute from command line without "node edit"
[2012-01-31 20:49:00 -0500] fujin: this is why i build ruby apps out of band and packge them into .deb with all required deps
[2012-01-31 20:50:00 -0500] fujin: volker-: you can use 'knife exec' with a node transform
[2012-01-31 20:50:00 -0500] jbz: question re: report handlers - I notice as I work on one that once it has been registered on my node, new versions of the actual report handler don't get recognized until I restart the chef-client which is running in daemon mode - even thought he actual contents of the handler on disk *do* change.  Is this expected behavior?
[2012-01-31 20:50:00 -0500] erikh: I just don't buy into the folly that having a compiler on your machine leads to less secure servers
[2012-01-31 20:50:00 -0500] miketheman: fujin: yeah, I think we discussed that a like while back
[2012-01-31 20:50:00 -0500] jbz: And if so, how do I handle making changes to handlers once they're in production? Do I need to cycle my chef-client daemon on all nodes for this to work?
[2012-01-31 20:50:00 -0500] fujin: miketheman:  so like i said what was your expectation
[2012-01-31 20:51:00 -0500] miketheman: fujin: magic and unicorns?
[2012-01-31 20:51:00 -0500] fujin: no I mean
[2012-01-31 20:51:00 -0500] volker-: fujin: hmmm. looks like the whole unique node attribute settings isn't the best yet
[2012-01-31 20:51:00 -0500] fujin: volker-: what?
[2012-01-31 20:51:00 -0500] fujin: how did you even say that with a straight face
[2012-01-31 20:52:00 -0500] fujin: miketheman: omnub;
[2012-01-31 20:52:00 -0500] volker-: fujin: modifying an attribute that is unique for every seems not to be that well configureable
[2012-01-31 20:52:00 -0500] volker-: *for every node
[2012-01-31 20:52:00 -0500] fujin: miketheman--: I mean what were you expecting, omnibus to have a compiler?
[2012-01-31 20:53:00 -0500] fujin: a prebuilt version of libshadow?
[2012-01-31 20:53:00 -0500] fujin: volker-: that doesn't make sense
[2012-01-31 20:53:00 -0500] fujin: like your statement is illogical
[2012-01-31 20:54:00 -0500] fujin: volker-: perhaps show what kind of attribute you are trying to change that you are having trouble with
[2012-01-31 20:54:00 -0500] volker-: fujin: ok, you can say that a node should have role[x] really easy. but telling a node that its variable X=foo seems not too
[2012-01-31 20:54:00 -0500] volker-: fujin: an node dependend variable (similiar like node['name'], just self created)
[2012-01-31 20:55:00 -0500] fujin: so you want to set a value if the node doesn't already have one set or ?
[2012-01-31 20:56:00 -0500] fujin: tell me *exactly* what you want to achieve. what are you putting in that attribute?
[2012-01-31 20:56:00 -0500] volker-: fujin: correct. every node should get an attribute "myattribute": "my_uniq_key"
[2012-01-31 20:56:00 -0500] fujin: so why not use a cookbook attribute or environment attribute, or even a role attribute, of default precedence?
[2012-01-31 20:57:00 -0500] volker-: fujin: because this attribute should be used amoung multiple cookbooks
[2012-01-31 20:58:00 -0500] fujin: yeah, so?
[2012-01-31 20:58:00 -0500] bawt: yeah, so is hardy
[2012-01-31 20:58:00 -0500] fujin: nothing stopping you from using it among multiple cookbooks
[2012-01-31 20:58:00 -0500] miketheman--: fujin: I was expecting omnibus to be a little up front about "all you have to do is curl this install script" - but wait! to run your code, you also need a compiler!
[2012-01-31 20:58:00 -0500] jbz: Soanyone out there who can talk to me about handlers not being reloaded without a client daemon restart?
[2012-01-31 20:59:00 -0500] fujin: to run code that talks to the shadow library you have to have the shadow gem compiled against it
[2012-01-31 20:59:00 -0500] fujin: i don't get what is so hard to understand or where the expectation is failing to be met
[2012-01-31 20:59:00 -0500] fujin: it's a bundled chef installation
[2012-01-31 20:59:00 -0500] fujin: volker-: you could easily put that attribute in an Environment (default precedent, or override), or into a databag, then load it wherever you need it.
[2012-01-31 21:00:00 -0500] fujin: volker-: 'base' role, even, heh
[2012-01-31 21:00:00 -0500] fujin: if you put an attribute in a cookbook and ship the cookbook, you'll get those attributes on your node (even if you don't evaluate any recipes..)
[2012-01-31 21:00:00 -0500] volker-: fujin: As far as I understand, if i put it in a role, it is always the same for all clients of this role
[2012-01-31 21:00:00 -0500] fujin: heh
[2012-01-31 21:01:00 -0500] fujin: oh right, you wanted it unique per node
[2012-01-31 21:01:00 -0500] fujin: yeah so..
[2012-01-31 21:02:00 -0500] fujin: if I ever had to do that (which I never do, because it is preposterous), i would use a cookbook attribute
[2012-01-31 21:02:00 -0500] volker-: fujin: correct. i figured out how to set it with "knofe node edit NODE". but that isn't the nicest in my eyes
[2012-01-31 21:02:00 -0500] fujin: add a cookbook, add cookbook to base role, put attribute w/ calculated value
[2012-01-31 21:02:00 -0500] fujin: .. profit ?
[2012-01-31 21:03:00 -0500] miketheman: sorry, dropped connection
[2012-01-31 21:03:00 -0500] volker-: fujin: why preposterous? node1 has e.g. the values www1, www2, www3, and node2=www4,www5,www6
[2012-01-31 21:03:00 -0500] miketheman: fujin: point being that if my system package installs chef, then dependencies are resolved
[2012-01-31 21:03:00 -0500] volker-: fujin: so node1 configures the first 3 websites, and node2 the other 3
[2012-01-31 21:04:00 -0500] fujin: volker-: those aren't unique to nodes. those are unique to different types of web servers.
[2012-01-31 21:04:00 -0500] fujin: (as designated by *roles*)
[2012-01-31 21:04:00 -0500] fujin: miketheman: I would agree that omnibus should allow all base functionality of Chef on supported platforms, which probably should mean libshadow on debian/ubuntu
[2012-01-31 21:05:00 -0500] fujin: I don't use it however, so we'll have to see
[2012-01-31 21:05:00 -0500] miketheman: yep
[2012-01-31 21:05:00 -0500] miketheman: am giving it a shot, and exposing the problems
[2012-01-31 21:05:00 -0500] fujin: volker-: this is simply saying "these are unique to nodes" when really, they are not unique to nodes. you're just designing it wrong
[2012-01-31 21:06:00 -0500] fujin: you have at most of 10 permutations of webservers, each with a different set of 'wwwX' (I imagine, from your statements)
[2012-01-31 21:06:00 -0500] volker-: fujin: hmm. its not webserver, its a unique IP/hostname thats added to every /etc/hosts, interface, VPN etc
[2012-01-31 21:07:00 -0500] volker-: fujin: and separated from the /etc/hostname
[2012-01-31 21:07:00 -0500] fujin: and what is that used for?
[2012-01-31 21:07:00 -0500] volker-: fujin: configuration by multiple cookbooks
[2012-01-31 21:08:00 -0500] volker-: fujin: the structure is not looking different as the one from the default apache etc. cookbooks
[2012-01-31 21:08:00 -0500] fujin: configuration for what?
[2012-01-31 21:08:00 -0500] fujin: what IS IT USEDF FORRRRRRR
[2012-01-31 21:08:00 -0500] fujin: bind to this hostname?
[2012-01-31 21:08:00 -0500] fujin: serve this HTTP name?
[2012-01-31 21:08:00 -0500] fujin: only accept requests to this A record?
[2012-01-31 21:08:00 -0500] fujin: so humans can SSH to the box?
[2012-01-31 21:08:00 -0500] fujin: *what is it used for*
[2012-01-31 21:09:00 -0500] volker-: fujin: to configure vpn, www, nagios etc. on a box with multiple interfaces
[2012-01-31 21:09:00 -0500] Urocyon: hrmph, postgres cookbook seems pretty remedial.  :-(
[2012-01-31 21:10:00 -0500] Urocyon: I'm cribbing some from mysql for configuration tweaks.
[2012-01-31 21:10:00 -0500] miketheman: fujin: take a breath. ;)
[2012-01-31 21:10:00 -0500] fujin: I'm not short
[2012-01-31 21:10:00 -0500] miketheman: no, you're not, and I totally get the frustration
[2012-01-31 21:11:00 -0500] fujin: volker-: show me the structure of the attribute and what the usage of it looks like across multiple cookbooks and I will show you what it should look like.
[2012-01-31 21:11:00 -0500] Urocyon: is there any better database example I should look at for ideas on modifying the postgres cookbook?
[2012-01-31 21:11:00 -0500] fujin: and/or multiple ways to solve this with CHef
[2012-01-31 21:11:00 -0500] fujin: Urocyon: there are many postgres cookbooks available, I saw some nice ones mentioned on the mailing list with some cluster/replication stuff
[2012-01-31 21:11:00 -0500] Urocyon: guess I should follow the mailing list.
[2012-01-31 21:12:00 -0500] Brad_K: there's lots of overlap between the list and this irc chat room, but both are good places to monitor.
[2012-01-31 21:12:00 -0500] miketheman: Urocyon: also might want to take a look at the `database` cookbook - it's been extended for postgres
[2012-01-31 21:12:00 -0500] yfeldblum: Urocyon, in order to use Chef to configure postgresql, you must already know how to configure postgresql ... you can use Chef to help you automate the steps you already know how to do, and to help you document and write them down in an easy English-like but executable format
[2012-01-31 21:12:00 -0500] brett_h: Is there a way to set resource defaults in Chef (as in Puppet)? e.g. *all* declared cron resources default mailto = foo@example.com?
[2012-01-31 21:12:00 -0500] wdpro_kevin: is it me? or does the "recursive true" not work in the directory resource?
[2012-01-31 21:13:00 -0500] miketheman: wdpro_kevin: hat doesn't work?
[2012-01-31 21:13:00 -0500] miketheman: what*
[2012-01-31 21:13:00 -0500] yfeldblum: Urocyon, then just take what you were already doing by hand to configure postgres and write it down in the Chef language
[2012-01-31 21:13:00 -0500] miketheman: wdpro_kevin: and it might be you. ;)
[2012-01-31 21:14:00 -0500] wdpro_kevin: it just might be! :) that's why I set a disclaimer
[2012-01-31 21:14:00 -0500] Brad_K: wdpro_kevin: "recursive true" will work with regards to creating the directories if they need to be created.  but if the directory does already exist then "recursive true" it is not the equivalent of doing a recursive chmod or chown to ensure that everything has the ownership and permissions you want.
[2012-01-31 21:15:00 -0500] miketheman: wdpro_kevin: to extend Brad_K, the recursive true option currently does not apply the the permissions set in the statement recursively - so any parent directories will still be owned by root.
[2012-01-31 21:15:00 -0500] wdpro_kevin: Brad_K: ahh that is the case. Is there a recommended course?
[2012-01-31 21:16:00 -0500] Brad_K: wdpro_kevin: if you want to enforce ownership, permissions, etc even if the directories don't need to be re-created, then try using a recursive chmod or chown  i.e., exactly what you would do if you were logged into the box directly.
[2012-01-31 21:16:00 -0500] wdpro_kevin: with the bash resource?
[2012-01-31 21:16:00 -0500] Urocyon: miketheman: it's been extended some... covers user and database creation, but not replication.
[2012-01-31 21:17:00 -0500] miketheman: wdpro_kevin: I use a wordlist and loop. http://pastebin.com/KkAfbzKN
[2012-01-31 21:17:00 -0500] Brad_K: to compare: doing a "mkdir -p" doesn't set ownership and permissions as it goes.  "recursive true" is much more like "mkdir -p" than "chown -R" or "chmod -R".
[2012-01-31 21:17:00 -0500] Urocyon: miketheman: I think it still depends on the postgresql cookbook, which has no settings for customizing configurations other than listening port.
[2012-01-31 21:18:00 -0500] Urocyon: yfeldblum: that's pretty much what I'm doing, but I'm trying to generalize some too  - so I have something maybe I can contribute back.
[2012-01-31 21:19:00 -0500] Brad_K: wdpro_kevin: you should be able to use a bash resource or an execute command  they will result in basically the same thing being done and in the same way.  The bash resource would be a better option if you want to do multiple commands in sequence".
[2012-01-31 21:19:00 -0500] wdpro_kevin: cool miketheman. I've not seen that before I'll give it a shot
[2012-01-31 21:20:00 -0500] wdpro_kevin: thanks Brad_K
[2012-01-31 21:20:00 -0500] Brad_K: np
[2012-01-31 21:20:00 -0500] miketheman: wdpro_kevin: good luck!
[2012-01-31 21:21:00 -0500] rismoney: anyone using chef on windows?
[2012-01-31 21:21:00 -0500] yfeldblum: Urocyon, i would start off by replicating the actual steps first until you've got a working postgresql server that you're happy with, and generalizing afterward
[2012-01-31 21:23:00 -0500] Urocyon: yfeldblum: I've got that.  Just trying to move from my scriptish approach to something that integrates with the postgresql cookbook.
[2012-01-31 21:23:00 -0500] Urocyon: jtimberman: would some tunable setting entries and master/slave ha stuff interest you for the postgresql cookbook?  It would probably be pg9+ dependent.
[2012-01-31 21:24:00 -0500] yfeldblum: Urocyon, ah you're forking & updating the opscode postgresql cookbook?
[2012-01-31 21:25:00 -0500] Urocyon: yfeldblum: that's my thought.
[2012-01-31 21:25:00 -0500] Urocyon: yfeldblum: my first attempt to do something like that with an opscode cookbook.
[2012-01-31 21:35:00 -0500] miketheman: off-topic, fun: http://bit.ly/wpsd51 Ha!
[2012-01-31 21:36:00 -0500] fujin: heh
[2012-01-31 21:36:00 -0500] fujin: stupid chef language
[2012-01-31 21:37:00 -0500] mikeg: join #linux
[2012-01-31 21:37:00 -0500] miketheman: yep
[2012-01-31 21:37:00 -0500] mikeg: oops.  sorry :)
[2012-01-31 21:45:00 -0500] Urocyon: I wish templates had a supercedes attribute, in which you could specify the template you want to replace with this new template.
[2012-01-31 21:45:00 -0500] Urocyon: so you could put a template in cookbook b that replaces one in cookbook a, and whenver cookbook a looked for it's template, it would get yours instead.
[2012-01-31 21:45:00 -0500] fujin: Oh, you can do that.
[2012-01-31 21:46:00 -0500] fujin: (already)
[2012-01-31 21:46:00 -0500] Urocyon: enlighten me!
[2012-01-31 21:46:00 -0500] fujin: Just compile time magic.
[2012-01-31 21:46:00 -0500] miketheman: fujin: order of operations?
[2012-01-31 21:46:00 -0500] Urocyon: I thought using two resources of the same name was a recipe for trouble.
[2012-01-31 21:46:00 -0500] fujin: It certainly is but that is not what I was suggesting
[2012-01-31 21:47:00 -0500] miketheman: "recipe" - ha!
[2012-01-31 21:47:00 -0500] fujin: You can open a template (by a given name) and alter its parameters during compile phase
[2012-01-31 21:47:00 -0500] fujin: one sec
[2012-01-31 21:47:00 -0500] Urocyon: yeah, but can you alter the template?
[2012-01-31 21:49:00 -0500] fujin: https://gist.github.com/1713157
[2012-01-31 21:49:00 -0500] Urocyon: oh... just modify the source.
[2012-01-31 21:50:00 -0500] fujin: I believe the mysql or database cookbook(s) use this pattern to enable a user to supply the grants.sql template in their own cookbook
[2012-01-31 21:50:00 -0500] fujin: JI don't really use it often myself
[2012-01-31 21:50:00 -0500] miketheman: and yet having a default one
[2012-01-31 21:50:00 -0500] Urocyon: oh, nice.   Yeah, I was running into this problem with postgresql, where I wanted a different pg_hba or conf file.
[2012-01-31 21:52:00 -0500] bemu: That is really neat. Did not know.
[2012-01-31 21:52:00 -0500] Urocyon: well, this could be a good happy inbetween for me in putting together my pg changes.
[2012-01-31 21:52:00 -0500] fujin: =D
[2012-01-31 21:53:00 -0500] Urocyon: thanks, fujin!
[2012-01-31 21:54:00 -0500] Urocyon: I'm guessing this same trick could be used to change the variables as well.
[2012-01-31 21:55:00 -0500] fujin: of course
[2012-01-31 22:03:00 -0500] rismoney: noone uses chef on Windows?
[2012-01-31 22:08:00 -0500] miketheman: rismoney: I may be doing this soon, but not yet.
[2012-01-31 22:09:00 -0500] rismoney: yea, having issues where I think the chefclient runs the recipe, but it doesn't do anything.  I am looking for insight on how to troubleshoot
[2012-01-31 22:11:00 -0500] miketheman: can you execute the chef-client with the `-l debug` parameter?
[2012-01-31 22:13:00 -0500] rismoney: interesting - let me try it
[2012-01-31 22:21:00 -0500] jamescarr: so if I understand correctly, I can override cookbook attributes from another cookbook?
[2012-01-31 22:21:00 -0500] jamescarr: for example,  if I want my app cookbook to populate jndi resources for tomcat, I can just set those attributes in my app's cookbook with override?
[2012-01-31 22:25:00 -0500] Urocyon: fujin: that template resource modification worked like a champ!
[2012-01-31 22:27:00 -0500] Urocyon: jamescarr: order is important, but other than that, it shouldn't matter which cookbook/role or whatever sets those node attributes.
[2012-01-31 22:27:00 -0500] Urocyon: jamescarr: review here -> http://wiki.opscode.com/display/chef/Attributes
[2012-01-31 22:28:00 -0500] fujin: Urocyon: nice! :)
[2012-01-31 22:29:00 -0500] Urocyon: now, if only erb's worked like jinja.   Would love to have inheritance at my fingertips.
[2012-01-31 22:29:00 -0500] Urocyon: keep my ingredients cool and dry.
[2012-01-31 22:30:00 -0500] erikh: I hear gold bond medicated powder can help there
[2012-01-31 22:31:00 -0500] Urocyon: leaves a bit of an aftertaste though.
[2012-01-31 22:36:00 -0500] Urocyon: Any insight on setting master vs. slave in an HA db setup?  I know that the database cookbook used to do this by modifying a data bag, but that's supposed to be bad form, and it looks like the latest version backed away from it.
[2012-01-31 22:37:00 -0500] Urocyon: Role maybe or node attribute instead?
[2012-01-31 22:37:00 -0500] gmcinnes: What DBMS Urocyon?
[2012-01-31 22:37:00 -0500] Urocyon: postgres
[2012-01-31 22:37:00 -0500] gmcinnes: What type of master / slave replication strategy?
[2012-01-31 22:38:00 -0500] Urocyon: 9.1 hot standby.
[2012-01-31 22:38:00 -0500] Urocyon: well, warm
[2012-01-31 22:39:00 -0500] gmcinnes: Using log shipping, right? (vs streaming?)
[2012-01-31 22:40:00 -0500] Urocyon: wal shipping, yeah.
[2012-01-31 22:40:00 -0500] gmcinnes: I just did that, although for Postgres 8.
[2012-01-31 22:40:00 -0500] Urocyon: and, I guess it is actually hot standby.
[2012-01-31 22:41:00 -0500] Urocyon: http://www.postgresql.org/docs/9.1/static/hot-standby.html
[2012-01-31 22:41:00 -0500] gmcinnes: But its a bit fragile. I'm not entirely happy with it.
[2012-01-31 22:41:00 -0500] gmcinnes: Basically, have a master role, and a slave role.
[2012-01-31 22:42:00 -0500] Urocyon: cool, that's the direction I was headed.  Just wondered if there was something better.
[2012-01-31 22:42:00 -0500] Urocyon: I may eventually start using something like noah or doozerd to keep information like the current master at some point, but for now I'm trying to keep it in chef.
[2012-01-31 22:42:00 -0500] gmcinnes: the thing is there's a timing issue. Your slave server can't bring up postgres until the master server has brought it up and is ready to go.
[2012-01-31 22:42:00 -0500] wdpro_kevin: love being a noob any ideas why my directories aren't being deleted? https://gist.github.com/1713532
[2012-01-31 22:44:00 -0500] wdpro_kevin: it runs without error it even logs that the dir exists
[2012-01-31 22:44:00 -0500] gmcinnes: Urocyon: And you have to pass the slave info into the master's config file.
[2012-01-31 22:45:00 -0500] gmcinnes: Urocyon: So you need a data bag to relate the master to the slaves, and you need some sort of gaurd to make sure the slave doesn't come up before the master.
[2012-01-31 22:45:00 -0500] wdpro_kevin: (and props to miketheman for suggesting the wordlist loop)
[2012-01-31 22:46:00 -0500] gmcinnes: Urocyon: Also for setting up the slave initially you need to do an rsync from the master, while the db is locked.
[2012-01-31 22:46:00 -0500] gmcinnes: Urocyon: It's quite a dance. Basically I've used flags saved to the node configuration to note what state each master and slave are in.
[2012-01-31 22:46:00 -0500] miketheman: thanks
[2012-01-31 22:47:00 -0500] miketheman: wdpro_kevin: any user shells open in that directory?
[2012-01-31 22:47:00 -0500] gmcinnes: Urocyon: I can push the master & slave recipes up as a gist if you like.
[2012-01-31 22:48:00 -0500] wdpro_kevin: no and it's also not working on a file delete as well
[2012-01-31 22:49:00 -0500] wdpro_kevin: hold it I'm putting a comment in the place I should specify the path
[2012-01-31 22:49:00 -0500] miketheman: ah
[2012-01-31 22:49:00 -0500] miketheman: yes
[2012-01-31 22:50:00 -0500] miketheman: directory "#{dir}" do ...
[2012-01-31 22:50:00 -0500] wdpro_kevin: sorry I'll figure it out soon enough
[2012-01-31 22:50:00 -0500] wdpro_kevin: yep
[2012-01-31 22:54:00 -0500] gmcinnes: Urocyon: In case it's helpful: https://gist.github.com/1713599
[2012-01-31 22:54:00 -0500] gmcinnes: night all
[2012-01-31 22:55:00 -0500] Urocyon: ah, caught me afk.  I didn't get to say thank you.
[2012-01-31 23:02:00 -0500] Urocyon: fujin, are you #fujin on the twitter.
[2012-01-31 23:02:00 -0500] Urocyon: ?
[2012-01-31 23:02:00 -0500] fujin: naw ;(
[2012-01-31 23:02:00 -0500] fujin: https://twitter.com/#!/fujin_
[2012-01-31 23:02:00 -0500] fujin: underscore
[2012-01-31 23:02:00 -0500] miketheman: underscore for emphasis
[2012-01-31 23:03:00 -0500] fujin: got fujin on github, not on twitter
[2012-01-31 23:03:00 -0500] fujin: the guy didn't use it for years either then finally started using it recently. bastard
[2012-01-31 23:06:00 -0500] Urocyon: Just wanted to tweet that earlier gist and credit it properly.
[2012-01-31 23:07:00 -0500] miketheman: offer him about 100 lines of code for his acocunt
[2012-01-31 23:21:00 -0500] till__: anyone know how i can create a hash with preserved order (pre ruby 1.9) in chef?
[2012-01-31 23:22:00 -0500] ashb_: till__: you'll need to use a library or 3rd party code to do it
[2012-01-31 23:23:00 -0500] ashb_: till__: might be easier to have [ [key, val], [key, val] ]
[2012-01-31 23:23:00 -0500] ashb_: depending on what you need it for and how many keys you expect
[2012-01-31 23:24:00 -0500] till__: well, i want a simple k => v structure
[2012-01-31 23:24:00 -0500] till__: i'm a ruby n00b
[2012-01-31 23:24:00 -0500] till__: hehe
[2012-01-31 23:25:00 -0500] fujin: why do you want an ordered hash ?
[2012-01-31 23:25:00 -0500] fujin: there are a bunch of libraries that do it, which you could use, but yeh.. why?
[2012-01-31 23:25:00 -0500] till__: fujin: i am installing a bunch of packages and the order in which they are installed is important
[2012-01-31 23:26:00 -0500] grantr: till: ActiveSupport::OrderedHash will do it
[2012-01-31 23:26:00 -0500] till__: important so the broken package manager doesn't resolve dependencies :O
[2012-01-31 23:26:00 -0500] grantr: it emulates a hash with an associative array
[2012-01-31 23:27:00 -0500] till__: ok, i'll check that out
[2012-01-31 23:27:00 -0500] fujin: what package manager are you using?
[2012-01-31 23:27:00 -0500] grantr: actually it changed at some point to be a hash with a keys array (looking at the docs)
[2012-01-31 23:27:00 -0500] grantr: probably faster that way
