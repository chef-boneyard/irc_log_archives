[2012-01-10 09:02:00 -0500] maus: ssd7, looks like I got data bag caching work https://gist.github.com/1587957
[2012-01-10 09:54:00 -0500] BryanWB: first stab at an emacs mode for knife https://github.com/bryanwb/knife-mode
[2012-01-10 09:54:00 -0500] BryanWB: very alpha
[2012-01-10 09:54:00 -0500] laurent\: :)
[2012-01-10 10:11:00 -0500] iroller: @ssd7: hey, if you have some time to try to help me with chef search (talked to you tomorrow) that would be great
[2012-01-10 10:20:00 -0500] iroller: https://gist.github.com/1583983 will appreciate any help
[2012-01-10 10:56:00 -0500] tube: is there a way to check the environment within a recipe? what would be the syntax then?
[2012-01-10 10:57:00 -0500] macros: node['chef_environment']
[2012-01-10 10:57:00 -0500] tube: macros: thx
[2012-01-10 11:02:00 -0500] tolland: where does Chef::Log.debug on the server go? i have set log_level          :debug in server.rb and restarted chef-server but I am not seeing anythign in /var/log/chef/* or /varlog/messages
[2012-01-10 11:38:00 -0500] iroller: tolland: how do your run chef-server? If you run under unicorn - check it's log
[2012-01-10 11:40:00 -0500] cewald: is it possible to dynamically create and destroy server instances based on load with chef?
[2012-01-10 11:45:00 -0500] BryanWB: cewald: no
[2012-01-10 11:46:00 -0500] BryanWB: u need an orchestration tool like mcollective, rundeck, noah to do that
[2012-01-10 11:46:00 -0500] cewald: I see, any of these play nice with chef?
[2012-01-10 11:46:00 -0500] BryanWB: cewald: no idea,  unfortunately
[2012-01-10 11:47:00 -0500] cewald: BryanWB: thanks
[2012-01-10 11:47:00 -0500] BryanWB: mmm, actuially, i hear rundeck has nice integration w/ chef
[2012-01-10 11:56:00 -0500] lflux: Is there a way to express a resource depending on a previous inside a recipe?
[2012-01-10 11:57:00 -0500] lflux: say if I create a database user that depends on a database role being available
[2012-01-10 12:24:00 -0500] frank_: hi all. is there way to
[2012-01-10 12:25:00 -0500] frank_: have a host specify it's own runlist?
[2012-01-10 12:25:00 -0500] frank_: eg: want to prepare disk images, that (when cloned) register themselves in chef-server and set certain runlist
[2012-01-10 12:28:00 -0500] serjs: Hi guys, can someone help me, i have zabbix recipe and i want to create template for mysql.conf which containmysql password for future mysql checks, i create template with if ( node[:mysql] ) && ( node[:mysql][:users] ) && ( node[:mysql][:users][:root] ) then
[2012-01-10 12:28:00 -0500] serjs:   mysql_passwd=node[:mysql][:users][:root]
[2012-01-10 12:28:00 -0500] serjs: else
[2012-01-10 12:28:00 -0500] serjs:   mysql_passwd=""
[2012-01-10 12:28:00 -0500] serjs: fi
[2012-01-10 12:28:00 -0500] serjs: MYSQL_PASSWD="#{mysql_passwd}" but with running chef run it generate me same text, except mysql password my chef server/client 0.10.8 everywhere
[2012-01-10 12:28:00 -0500] serjs: oh code..
[2012-01-10 12:29:00 -0500] serjs: here is my template file http://pastebin.com/C86B6hYK
[2012-01-10 12:54:00 -0500] yfeldblum: different tools for different purposes; IMO only configure the current node with chef, not have one node try to configure other nodes or create/delete resources that the current node doesn't own
[2012-01-10 13:03:00 -0500] iroller: serjs, yo
[2012-01-10 13:03:00 -0500] serjs: iroller ya)
[2012-01-10 13:03:00 -0500] serjs: iroller already solved)
[2012-01-10 13:03:00 -0500] iroller: serjs, the first thing - don't keep ur passwords in attributes. Use encrypted databags
[2012-01-10 13:10:00 -0500] rweng: hi folks. Is there an easy way to reload the environment or adjust the PATH variable? I tried:   ENV['PATH'] = "/usr/local/rbenv/shims:/usr/local/rbenv/bin:#{ENV['PATH']}", but when running %x(which rbenv) thereafter, no rbenv is found
[2012-01-10 13:11:00 -0500] rweng: the bashrc is configured correctly, so a reload of everything would probably work, too
[2012-01-10 13:36:00 -0500] russss: I still have the situation where my nodes randomly put themselves back in the _default environment
[2012-01-10 13:36:00 -0500] russss: it seems to happen when chef runs on the machine
[2012-01-10 13:55:00 -0500] BryanWB: is the omnibus chef installer currently the preferred way to install chef-server or is it just planned to be so in the near future?
[2012-01-10 14:26:00 -0500] fish_: I'm trying to batch-change a node attribute on several hosts with knife exec like this: node.set.ganglia.mcast_address = "1.2.3.4". after that, I call node.save
[2012-01-10 14:26:00 -0500] fish_: then I output the attribute to verify
[2012-01-10 14:27:00 -0500] fish_: this looked good but after some time, the value falled back to the value before. this happend several times. maybe a bug or a hidden feature.. any ideas how to investigate that?
[2012-01-10 14:29:00 -0500] necromancer: hey i'm having an issue getting postgresql to work properly on my vagrant VM
[2012-01-10 14:29:00 -0500] necromancer: it's installed using Chef, and the init.d script isn't killing the postgres processes
[2012-01-10 14:29:00 -0500] yfeldblum: fish_, is there an override-level attribute overriding your nomal-level attribute?
[2012-01-10 14:31:00 -0500] fish_: yfeldblum: nope
[2012-01-10 14:33:00 -0500] fish_: yfeldblum: I know, it's probably very unlikely that it 'just turned back'. but maybe there is an issue with the node.save call
[2012-01-10 14:36:00 -0500] ssd7: Ohai Chefs
[2012-01-10 14:38:00 -0500] mattray: New BitTorrent cookbook and writeup: http://bit.ly/ywPgvl
[2012-01-10 14:41:00 -0500] fish_: I just iterated over a search for our base role which is applied on all these hosts and set the node attribute as described. now I have about 5% of all nodes with still the old value, although I verified that the value is correct right after I set it
[2012-01-10 14:41:00 -0500] fish_: so my theorie is that the node.save call silently failed but since the value is cached somehow, it was correct when I read it in the same knife exec run
[2012-01-10 14:42:00 -0500] fish_: .oO(guess this was bad timing for my explaination)
[2012-01-10 14:42:00 -0500] ssd7: fish_: Is it possible that the nodes in questions running chef-client in the meantime and having the values reset through some recipe?
[2012-01-10 14:44:00 -0500] fish_: ssd7: not really, the value get set as default in the cookbook's attributes - but since I set it in the set/normal level, this shouldn't matter
[2012-01-10 14:44:00 -0500] fish_: but maybe I got this wrong again :)
[2012-01-10 14:45:00 -0500] fish_: another theory: while chef is running, all changes to a nodes attributes get lost
[2012-01-10 14:45:00 -0500] ssd7: fish_: Yes.
[2012-01-10 14:45:00 -0500] ssd7: fish_: If the node is running chef-client, and your knife changes happen in the middle of the node's chef-client run
[2012-01-10 14:45:00 -0500] fish_: oh thx
[2012-01-10 14:46:00 -0500] ssd7: the node is going to save the old data at the end, wiping out your changes.
[2012-01-10 14:46:00 -0500] fish_: thats most likely the reason then..
[2012-01-10 14:46:00 -0500] fish_: but that's pretty odd..
[2012-01-10 14:48:00 -0500] fish_: ssd7: so there is no way around that? and what's with knife node edit? same behavior?
[2012-01-10 14:50:00 -0500] jonlives: fish_: why don't you set the attributes in the Base role, instead of iterating over it and applying them to the nodes individually?
[2012-01-10 14:52:00 -0500] ssd7: fish_: No way arround it currently unfortunately.  Edits via knife will be wiped out it done in the middle of a chef-client run.
[2012-01-10 14:54:00 -0500] jonlives: fish_: try something like https://gist.github.com/1589458
[2012-01-10 14:56:00 -0500] fish_: jonlives: this won't avoid the issues ssd7 explained
[2012-01-10 14:57:00 -0500] jonlives: fish_: there's no way to avoid it for nodes which are mid-run at the moment you upload your changes.
[2012-01-10 14:57:00 -0500] jonlives: but if you set it in the role, they'll pick it up on the next run as opposed to overwriting it if it's in node metadata.
[2012-01-10 14:57:00 -0500] fish_: yes, I agree - adding it via a role would solve it
[2012-01-10 14:58:00 -0500] jonlives: if you're iterating over the role anyway, it seems like it would be easier :p
[2012-01-10 14:59:00 -0500] fish_: jonlives: unfortunally we still running chef 0.9 and have no environments, so we have the same role on different chef servers
[2012-01-10 14:59:00 -0500] fish_: so the question is: split up the role, one for each environment/chef server or changing the one node attributes which differs between environments with knife
[2012-01-10 14:59:00 -0500] jonlives: fish_: if you need more that one ganglia multicast address, ie for different groups of servers, then just set it in different roles for each group
[2012-01-10 15:00:00 -0500] jonlives: oh different servers, right
[2012-01-10 15:00:00 -0500] fish_: but I agree, now that I'm aware of this issue, it's probably better to split up the roles and have one role per environment
[2012-01-10 15:00:00 -0500] jonlives: yeah :)
[2012-01-10 15:00:00 -0500] fish_: so thanks a lot :)
[2012-01-10 15:03:00 -0500] jonlives: np :)
[2012-01-10 15:30:00 -0500] dwhsix: in a recipe, can I use a method defined in the library of another cookbook?  I thouhgt so, but can't get it to work...
[2012-01-10 15:30:00 -0500] endzYme: fooBAR!@#
[2012-01-10 15:31:00 -0500] dwhsix: I'll put together a gist
[2012-01-10 15:32:00 -0500] ssd7: dwhsix: The exact details depend a bit on where the method is defined, but generally yes.
[2012-01-10 15:33:00 -0500] dwhsix: ssd7: that's what I thought will post gist link in a moment
[2012-01-10 15:37:00 -0500] dwhsix: https://gist.github.com/351dc953a332c4a56aa5
[2012-01-10 15:37:00 -0500] dwhsix: ssd7: ^^
[2012-01-10 15:40:00 -0500] dwhsix: ugh - I need to be offline for a bit, but I'll look for any responses...
[2012-01-10 15:42:00 -0500] ssd7: dwhsix: Ahh.  I think you are just running into a ruby Thing.  Try def self.short_env when constructing your method definitions
[2012-01-10 15:42:00 -0500] ardell: I'm running chef-solo as a non-root user and I'd like to use the standard "cookbook_file" resource to place a file in a directory owned by root using the "owner" and "group" methods.  I'd like for chef-solo to ask interactively for a password, but instead it's dying with an "Operation not permitted" error.  Is there any way to get chef-solo to ask for a password?
[2012-01-10 15:42:00 -0500] dwhsix: wondered if it might be something like that
[2012-01-10 15:42:00 -0500] dwhsix: will try, thx
[2012-01-10 15:47:00 -0500] Dink: Hello, I would like to incorporate "sudoers"  into chef. Currently have a complex sudoers file with several Cmnd_Alias along with using Netgroups, groups and regular users. Would like some guidance on how to implement this. BTW very very new to chef. In the past with *cough* puppet *cough* basically just had a shudders file that was pushed. Nothing fancy. Should use that same procedure ?
[2012-01-10 15:49:00 -0500] Dink: the module used a sudo tmp file and did a diff against it then moved the new file into place
[2012-01-10 15:50:00 -0500] ssd7: Dink: Well, one way would be to just use a template.  Much like this sudo cookbook does: http://community.opscode.com/cookbooks/sudo
[2012-01-10 15:51:00 -0500] ssd7: Another option would be to use something like BryanWB's new sudo LWRP: https://github.com/bryanwb/cookbooks/blob/master/sudo/README.md  However, that is a bit newer.  The template is probably a bit more straightforward.
[2012-01-10 16:14:00 -0500] BryanWB: Dink: try the template option my lwrp, it makes sure that the resulting template has the correct perms + it checks the rendered template before putting it into /etc/sudoers.d
[2012-01-10 16:14:00 -0500] Dink: @ssd7: thanks for the info
[2012-01-10 16:15:00 -0500] BryanWB: the lwrp runs "visudo -cf your_file" for a sanity check
[2012-01-10 16:16:00 -0500] Dink: BryanWB: Cool. That is what our puppet module did. I just need to figure out the different variables and what not due to the high number of cmd_alias, groups,users etc we use
[2012-01-10 16:16:00 -0500] BryanWB: Dink: u can put most of that logic in your template
[2012-01-10 16:16:00 -0500] BryanWB:  if not all
[2012-01-10 16:17:00 -0500] Dink: 92 entries in our current file
[2012-01-10 16:17:00 -0500] iroller: @ssd7: hey, do you have some time to try to help me with knife search(https://gist.github.com/1583983)?
[2012-01-10 16:18:00 -0500] ssd7: iroller: Yes, but I need to head into the office soon.  Is this on Hosted Chef?
[2012-01-10 16:18:00 -0500] iroller: @ssd7: nope
[2012-01-10 16:19:00 -0500] iroller: @ssd7: there is a lot of interfaces on my nodes(bonding) so probably that's the reason. But it's really odd
[2012-01-10 16:21:00 -0500] ssd7: Ahh ok. Hmm.  Have you tried knife index rebuild?
[2012-01-10 16:22:00 -0500] ssd7: iroller: My other idea is bumping solr's maxFieldLength option
[2012-01-10 16:22:00 -0500] ssd7: see http://tickets.opscode.com/browse/CHEF-2346
[2012-01-10 16:23:00 -0500] iroller: Yeah I saw that issue. I going to try it. Will tell you about the results
[2012-01-10 16:25:00 -0500] ssd7: Be sure to at least resave the node after bumping the maxFieldLength, otherwise you probably are still working off teh old data.
[2012-01-10 16:30:00 -0500] deedubs: Hey peeps, anyone remember that site that was going around about a month ago that was outlining a methodology for app development and deployment.  Went into things like using config management, git continuous deployment using ENV vars for confining applications :'(
[2012-01-10 16:50:00 -0500] static^: is chef compatible with 1.9.3 yet?
[2012-01-10 17:09:00 -0500] mconigliaro: static^: it works for me under rvm
[2012-01-10 17:14:00 -0500] CharlieSu: If I've started an EBS snapshot, can i start using the volume again without worrying that the snapshot will be inconsistent ?
[2012-01-10 17:33:00 -0500] yfeldblum: that's a question highly specific to the way AWS EBS works; perhaps this AWS EBS FAQ item can help: http://aws.amazon.com/ec2/faqs/#Do_volumes_need_to_be_un-mounted_in_order_to_take_a_snapshot_Does_the_snapshot_need_to_complete_before_the_volume_can_be_used_again
[2012-01-10 17:53:00 -0500] nati2: Hi folks. How can I update chef attribute from shell script?
[2012-01-10 17:54:00 -0500] nati2: I wanna set node attribute from Jenkins job ( shell script )
[2012-01-10 17:56:00 -0500] nati2: I tried to knife exec - E 'nodes.all {|n|  n[:attribute] = "bar"; n.save; }'  But it not works
[2012-01-10 17:57:00 -0500] BryanWB: how does this recipe work at all? https://github.com/opscode/cookbooks/blob/master/gecode/recipes/source.rb
[2012-01-10 17:57:00 -0500] BryanWB: ld.so.conf not update afaict
[2012-01-10 17:58:00 -0500] BryanWB: ciao ciao, good night
[2012-01-10 18:08:00 -0500] jhulten: CharlieSu: Once the snapshot command has started you are good to go. Most 'snapshots' have a brief window where I/O has to stop, but once it returns you can make changes to the original volume.
[2012-01-10 18:09:00 -0500] jhulten: CharlieSu: If you are running a database you will want to make sure your snapshot includes both data and the transaction logs so you can recover. Run a test to know for sure.
[2012-01-10 18:29:00 -0500] CharlieSu: jhulten: cool thanks
[2012-01-10 18:34:00 -0500] sniperd: Im installing chef 10.8 on RHEL 6.2 and its not installing the init.d or sysconfig scripts into /etc/, also it did not create its /var/log/ directory
[2012-01-10 18:38:00 -0500] bemu: sniperd: I can't help with that, but could you check a few things for me please?
[2012-01-10 18:38:00 -0500] sniperd: bemu: sure, it might be a non issue to begin with (my problem that is)
[2012-01-10 18:39:00 -0500] bemu: What version of ruby do you have installed?
[2012-01-10 18:39:00 -0500] bemu: ruby -v
[2012-01-10 18:39:00 -0500] sniperd: ruby 1.8.7 (2011-12-28 patchlevel 357) [i686-linux]
[2012-01-10 18:39:00 -0500] sniperd: its from source
[2012-01-10 18:39:00 -0500] bemu: ah, okay.
[2012-01-10 18:39:00 -0500] bemu: Doesn't RHEL6 have a package for 1.8.7?
[2012-01-10 18:39:00 -0500] bemu: .299 I think?
[2012-01-10 18:39:00 -0500] sniperd: The default one w/ the rpm packages doesnt have any of the development support added in
[2012-01-10 18:40:00 -0500] bemu: ah.
[2012-01-10 18:40:00 -0500] sniperd: yeah, but its missing the devel package, and you cannot get any of the gems working
[2012-01-10 18:40:00 -0500] bemu: There is no -devel package?
[2012-01-10 18:41:00 -0500] bemu: (sorry to be repetitious, just want to be clear)
[2012-01-10 18:41:00 -0500] sniperd: Right, there is no -devel package. This might be a different scenario then people with a stock RHEL setup as this is in ibm's smartcloud and they have their own repos mostly
[2012-01-10 18:41:00 -0500] bemu: Are you installing chef-client or server?
[2012-01-10 18:41:00 -0500] sniperd: client
[2012-01-10 18:42:00 -0500] sniperd: its missing the libopenssl-ruby packages as well
[2012-01-10 18:42:00 -0500] sniperd: And I just started in on it, so decided to compile from source to probably save headaches
[2012-01-10 18:44:00 -0500] bemu: How did you install? gem install chef?
[2012-01-10 18:45:00 -0500] bemu: If so, I'm pretty sure the gem install itself doesn't create init.d or log directories/files. That's left up to the bootstrap.
[2012-01-10 18:46:00 -0500] bemu: Most people will install chef client using a bootstrap script.
[2012-01-10 18:47:00 -0500] sniperd: bemu: yeah gem install chef
[2012-01-10 18:47:00 -0500] jtgiri_: Whats the best way to restart apache after installing php-mcrypt ? I see for template you can do notify I wonder how can you do the same for package ?
[2012-01-10 18:47:00 -0500] sniperd: bemu: gotcha, makes sense. That's the case on our ubuntu installs I just didnt realize thats what was happening
[2012-01-10 18:57:00 -0500] bakins: silly question/idea. using git for file backups on the nodes instead of just copying to a backup directory. anyone done this?
[2012-01-10 18:57:00 -0500] bakins: I guess some monkey patching of the file provider???
[2012-01-10 19:00:00 -0500] BryanWB: is there a way that this recipe can work w/out updating /etc/ld.so.conf ? https://github.com/opscode/cookbooks/blob/master/gecode/recipes/source.rb  perhaps freebsd looks in /usr/local/lib by default?
[2012-01-10 19:01:00 -0500] BryanWB: rberger, good evening ;)
[2012-01-10 19:27:00 -0500] littonj: ssd7_: you helped me with a bootstrap sudo issue last night. The problem was a leading newline in the migration file. I think a better behavior for this would be to upload the migration file and save it as a script and then run that script with sudo. Otherwise, there is the potential to run the first line with sudo and have the rest executed as the user
[2012-01-10 19:28:00 -0500] bitmonk: anyone have experimental debs for ubuntu precise? upstream still packages 0.8.16.
[2012-01-10 19:33:00 -0500] cwj: is there a way to lint erb files aside from trying to figure out the error when the template fails during a chef run? erubis is complaining about an unexpected } in one of my nginx config templates and it is driving me mad
[2012-01-10 19:38:00 -0500] ssd7_: littonj: Thanks for the feedback.  Just to be clear, the problem was with a newline in the migration file that occured before "bash -c ", correct?
[2012-01-10 19:47:00 -0500] mib_mib: hi guys, how do i have chef install ruby1.9.1 instead of the default ruby 1.8?
[2012-01-10 19:48:00 -0500] mib_mib: whe nrunning the command knife bootstrap IP_ADDRESS -i key
[2012-01-10 19:54:00 -0500] jhulten: mib_mib: I think you would have to write a custom knife bootstrap script, but I don't think chef supports 1.9 at this point. Unless that has changed since I checked last.
[2012-01-10 19:55:00 -0500] mib_mib: on the main page it says it supports ruby 1.9.1 and ruby 1.9.2
[2012-01-10 19:56:00 -0500] mib_mib: i see this article here, http://www.oneadam.net/?p=246 is this the wayt to do it?
[2012-01-10 19:56:00 -0500] jhulten: http://wiki.opscode.com/display/chef/Custom+Knife+Bootstrap+Script
[2012-01-10 19:56:00 -0500] BryanWB_: jhulten, chef-client or chef-server or just knife?
[2012-01-10 19:56:00 -0500] BryanWB_: i use 1.9.3 w/ knife and works fine
[2012-01-10 19:56:00 -0500] BryanWB_: but 1.87 on all my servers
[2012-01-10 19:57:00 -0500] jhulten: I guess it has changed.
[2012-01-10 19:57:00 -0500] jhulten: mib_mib: that looks like the right path.
[2012-01-10 19:58:00 -0500] mib_mib: i dont understand why it isn't simpler to specify ruby version
[2012-01-10 19:58:00 -0500] mib_mib: why its not just a param i can set
[2012-01-10 19:58:00 -0500] mib_mib: unncessarily complicated imo
[2012-01-10 19:59:00 -0500] jhulten: Patches are welcome.
[2012-01-10 20:00:00 -0500] mib_mib: i think i could contribute a lot, i've just never actually patched anything open source
[2012-01-10 20:00:00 -0500] BryanWB_: mib_mib, it is easier than u think, hell even i do it ;)
[2012-01-10 20:01:00 -0500] mib_mib: i guess the main thing is that I would obsess over changes - i would want to know how everything works before putting in patches
[2012-01-10 20:01:00 -0500] BryanWB_: mib_mib, the code is pretty modular
[2012-01-10 20:01:00 -0500] BryanWB_: i made a patch my first week w/out even knowing ruby
[2012-01-10 20:01:00 -0500] miah: hrm. chef-client::delete_validation should check if its being run on a server where chef-server is being run, and if so no-op. ya so i just discovered this the derp way.
[2012-01-10 20:02:00 -0500] BryanWB_: mib_mib, to contribute start here  http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-01-10 20:03:00 -0500] BryanWB_: mib_mib, the hardest part about contributing is getting the git workflow right, if u arent' already familiar w/ git
[2012-01-10 20:03:00 -0500] BryanWB_: http://wiki.opscode.com/display/chef/Working+with+Git
[2012-01-10 20:03:00 -0500] BryanWB_: take a look at those to start
[2012-01-10 20:04:00 -0500] jhulten: And learning Git workflow is full of win in the long run.
[2012-01-10 20:04:00 -0500] BryanWB_: ya, mega-win
[2012-01-10 20:05:00 -0500] mib_mib: ah cool thanks
[2012-01-10 20:05:00 -0500] mib_mib: i know svn pretty well
[2012-01-10 20:06:00 -0500] mib_mib: git is basically the same, except it seems like it has rebasing, and forking / merging is a little easier
[2012-01-10 20:06:00 -0500] atomic-penguin: http://www.youtube.com/watch?v=CDeG4S-mJts
[2012-01-10 20:07:00 -0500] BryanWB_: atomic-penguin, no! that will scare them off! but is hilarious ;)
[2012-01-10 20:08:00 -0500] atomic-penguin: BryanWB_, as much as I have learned about git, and now prefer it over svn.  Git still finds a way to frustrate me to death from time to time
[2012-01-10 20:09:00 -0500] BryanWB_: oh yeah, svn is horrible, as difficult as git is, it doesn't give u one giant point of fail
[2012-01-10 20:09:00 -0500] atomic-penguin: BryanWB_, I think its named git, because it has a tendency to make otherwise smart people feel stupid on occasion.
[2012-01-10 20:14:00 -0500] littonj: ssd7_: yes. it was a newline before the bash -c
[2012-01-10 20:16:00 -0500] yfeldblum: atomic-penguin, heh
[2012-01-10 20:16:00 -0500] gmcinnes: hi chefs. Sometimes when I bootstrap a machine the nodename the server gets is the fqdn.  Sometimes its just the simple hostname.  Any thoughts why?
[2012-01-10 20:16:00 -0500] yfeldblum: atomic-penguin, i've had to learn plenty of git the hard way ...
[2012-01-10 20:17:00 -0500] atomic-penguin: yfeldblum, is there an easy way?
[2012-01-10 20:18:00 -0500] yfeldblum: atomic-penguin, i'm just assuming that the hard way is the easiest of the ways ...
[2012-01-10 20:19:00 -0500] ssd7_: littonj: Thanks.  A simple alternative for now might be for us to also host that file somewhere so it can be downloaded rather than copy-and-pasted.
[2012-01-10 20:19:00 -0500] yfeldblum: atomic-penguin, i think i've gotten a decent handle on it now, though, since i use it all the time
[2012-01-10 20:23:00 -0500] yfeldblum: atomic-penguin, and that vid is fairly accurate
[2012-01-10 20:39:00 -0500] gmcinnes: I am having ze problems.  What would cause a machine not to pick up its fqdn when I bootstrap it?
[2012-01-10 20:42:00 -0500] ssd7_: gmcinnes: the fqdn is just populated by Ohai running: hostname --fqdn  (or hostname -f, on some platforms) on the machine
[2012-01-10 20:42:00 -0500] ssd7_: so, anything that would cause hostname to be wrong, would also bubble up to ohai
[2012-01-10 20:44:00 -0500] gmcinnes: duh. sorry. That was a dumb one.
[2012-01-10 20:44:00 -0500] gmcinnes: my helper misconfigured this machines /etc/hosts
[2012-01-10 20:45:00 -0500] gmcinnes: now I'll need a to figure out how to build a bootstrap task to set /etc/hosts and /etc/hostname
[2012-01-10 21:05:00 -0500] mjreed: OK, search syntax is killing me.
[2012-01-10 21:05:00 -0500] mjreed: 'attr1:val1 AND attr2:val2 NOT attr3:val3' works.  But I can't append anything else after the NOT.
[2012-01-10 21:05:00 -0500] mjreed: I tried AND NOT
[2012-01-10 21:05:00 -0500] mjreed: AND (NOT ...)
[2012-01-10 21:06:00 -0500] mjreed: AND -
[2012-01-10 21:07:00 -0500] necromancer: hey guys
[2012-01-10 21:08:00 -0500] necromancer: having a bit of an issue with the PostgreSQL Chef script...when i run it the first time (using Vagrant), it errors out trying to run the init.d/postgresql restart script. when i kill -9 all of the postgres processes and re-run the script (vagrant provision), it works
[2012-01-10 21:09:00 -0500] necromancer: the init.d error i get is  * Error: Port conflict: another instance is already running on /var/run/postgresql with port 5432
[2012-01-10 21:13:00 -0500] PatrickBatman: good afternoon! is there a best practice for adding a Launchpad PPA via Chef?
[2012-01-10 21:14:00 -0500] mib_mib: When i run the command knife bootstrap - what configuration file is this pointing to? Where can i see what versions of things its going to install?
[2012-01-10 21:37:00 -0500] necromancer: here's my pgsql on debian recipe: https://gist.github.com/692da3548b6de94d6b5c
[2012-01-10 21:37:00 -0500] necromancer: anyone got any ideas? :)
[2012-01-10 21:58:00 -0500] miah: mjreed: '(attr1:val1 AND attr2:val2) NOT attr3:val3'
[2012-01-10 22:02:00 -0500] mjreed: @miah: yeah, I just have a process that takes a query and appends "AND blah" to it, sight unseen.   Guess I need to convince the author to wrap parens around the original query first.
[2012-01-10 22:14:00 -0500] radim: hi, what's the status of knife tag command? feature propals page in confluence shows it has been declined.
[2012-01-10 22:26:00 -0500] yfeldblum: radim, it works; "tag" is just a normal-level key (defaults to an empty array) on the node data; `knife tag create NODE TAG` will append TAG to node["tags"]
[2012-01-10 22:31:00 -0500] radim: yfeldblum: yeah, I know; wondering if it's going to be there in 12 months :)
[2012-01-10 22:31:00 -0500] bugoff: :14
[2012-01-10 22:32:00 -0500] gmcinnes: ssd7: you about? Remember that issue I was having with attribute persistance (default, override and automatic attributes are reset at the beginning of each chef run)?
[2012-01-10 22:34:00 -0500] jtimberman: PatrickBatman: use the apt_repository LWRP, I think there's an example of a PPA in the README of our apt cookbook.
[2012-01-10 22:39:00 -0500] PatrickBatman: jtimberman: thanks.
[2012-01-10 22:39:00 -0500] tpot: i would be annoyed if tags went away
[2012-01-10 22:40:00 -0500] gmcinnes: man. trying to automate setting up mysql slave servers is *awful*.
[2012-01-10 22:46:00 -0500] jtimberman: gmcinnes: s/slave// - fixed that for you
[2012-01-10 22:47:00 -0500] gmcinnes: no kidding.
[2012-01-10 22:47:00 -0500] jtimberman: radim: tpot: I'm unaware of any plans to remove node tags.
[2012-01-10 22:48:00 -0500] gmcinnes: jtimberman: do you have any clues why attributes might not be persisting on a node.  Did you guys change anything there lately?
[2012-01-10 22:50:00 -0500] gmcinnes: jtimberman: basically each mysql server needs a unique "server-id" in its config, so I was hoping to initialize a server id and store it on the node iff there isn't one already.
[2012-01-10 22:50:00 -0500] gmcinnes: jtimberman: but its getting overwritten each time I do a chef run
[2012-01-10 22:51:00 -0500] jtimberman: how are you setting the attribute and which priority level?
[2012-01-10 22:51:00 -0500] jtimberman: attributes?
[2012-01-10 22:51:00 -0500] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-01-10 22:51:00 -0500] jtimberman: !botsnack
[2012-01-10 22:51:00 -0500] bawt: jtimberman: =D
[2012-01-10 22:51:00 -0500] gmcinnes: jtimberman: in the recipe, at priority level "normal"
[2012-01-10 22:52:00 -0500] gmcinnes: jtimberman:  http://pastie.org/3163127
[2012-01-10 22:54:00 -0500] jtimberman: gmcinnes: stick a Chef::Log.info("generated mysql server id is: #{node['mysql-server-id']}")
[2012-01-10 22:54:00 -0500] jtimberman: after the node.set line
[2012-01-10 22:54:00 -0500] jtimberman: to see if the attribute value is actually getting set as you expect.
[2012-01-10 22:54:00 -0500] radim: jtimberman: thanks for confirmation
[2012-01-10 22:54:00 -0500] jtimberman: also, if your chef-client run fails to complete successfully, the node data will not be saved
[2012-01-10 22:55:00 -0500] gmcinnes: jtimberman: Is there a better way to do this?
[2012-01-10 22:55:00 -0500] jtimberman: you can explicitly call node.save in the recipe and it will save the node, but just be aware that the saved node data may not reflect the truth if other recipes modify attributes.
[2012-01-10 22:55:00 -0500] gmcinnes: jtimberman: It's the second time I've run into this use case, where I need to initialize a per server value
[2012-01-10 22:56:00 -0500] jtimberman: i've seen a number of ways people attempt to solve this problem :)
[2012-01-10 22:56:00 -0500] workmad3: gmcinnes: I personally initialize my nodes from a json file that contains per-server attributes at the normal level
[2012-01-10 22:56:00 -0500] jtimberman: a clever one was to do something like node['ipaddress'].gsub(/\./, '')
[2012-01-10 22:57:00 -0500] jtimberman: and set that to a new attribute
[2012-01-10 22:57:00 -0500] workmad3: gmcinnes: I then store the files in my git repo so that I have them version controlled and recoverable (useful for rebuilding the entire chef server if necessary :) )
[2012-01-10 22:58:00 -0500] mib_mib: HI guys - question - I'm running knife boostrap --sudo, but it isnt running as SUDO on the node - what is up? do i need to add sudo before all the commands in the bootstrap template??
[2012-01-10 22:59:00 -0500] workmad3: mib_mib: you shouldn't need to... I always use --sudo and it starts by asking for the sudo password and runs the entire bootstrap script as sudo
[2012-01-10 22:59:00 -0500] erikh: is sudo installed?
[2012-01-10 23:00:00 -0500] erikh: we use search to determine the mysql server id
[2012-01-10 23:00:00 -0500] erikh: e.g., search/reduce to highest number, add one
[2012-01-10 23:01:00 -0500] workmad3: erikh: I take it you're not likely to bring up two new mysql servers at the same time? :)
[2012-01-10 23:03:00 -0500] imorg: can someone tell me what is the variable to read the role of a node?
[2012-01-10 23:03:00 -0500] erikh: workmad3: very unlikely
[2012-01-10 23:04:00 -0500] erikh: we have about ... 15 I think
[2012-01-10 23:04:00 -0500] rboyd: slightly off topic but, anyone use the application cookbook to deploy rails and ever seen bundler complain about a gemspec with utf-8 characters? https://gist.github.com/f8e93810914400a31603
[2012-01-10 23:04:00 -0500] erikh: it's a big deal when we create a new one
[2012-01-10 23:04:00 -0500] mib_mib: workmad3: for some reason it isn't running it as sudo thouh - why is this?
[2012-01-10 23:05:00 -0500] workmad3: mib_mib: you did knife bootstrap FQDN --sudo ?
[2012-01-10 23:05:00 -0500] workmad3: mib_mib: and you checked sudo is installed, as erikh suggested?
[2012-01-10 23:05:00 -0500] rboyd: maybe I need to set the default encoding for chef or something?
[2012-01-10 23:05:00 -0500] mib_mib: sudo knife bootstrap IP_ADDRESS -x ubuntu -i ~/.ec2/ec2key.pem --sudo --template-file ~/chef-repo/bootstrap/install_ruby_192.erb
[2012-01-10 23:08:00 -0500] mib_mib: any ideas?
[2012-01-10 23:09:00 -0500] workmad3: mib_mib: is sudo installed?
[2012-01-10 23:09:00 -0500] mib_mib: yes
[2012-01-10 23:09:00 -0500] mib_mib: if i type the commands manually it works
[2012-01-10 23:10:00 -0500] Brad_K: it might be a path problem.  that path might exist in your normal environment when you log in, but not in the enviroment when you use knife.  check your path.
[2012-01-10 23:10:00 -0500] workmad3: mib_mib: try using the full path to your template file too
[2012-01-10 23:10:00 -0500] mib_mib: here is my config file
[2012-01-10 23:10:00 -0500] mib_mib: http://pastebin.com/qPs9Pzhd
[2012-01-10 23:11:00 -0500] workmad3: mib_mib: and is there a reason you're running knife with sudo?
[2012-01-10 23:11:00 -0500] mib_mib: no reason,
[2012-01-10 23:11:00 -0500] mib_mib: Brad_K: u mean the path to sudo?
[2012-01-10 23:12:00 -0500] Brad_K: mib_mib: yeah, you need to make sure that the shell environment used in knife bootstrap can find the binary for sudo.  that's why you would want to use a full path to the binary.  same for anything else that is being executed which might potentially be in a location other than /bin.
[2012-01-10 23:13:00 -0500] mib_mib: here is the error messages though: http://pastebin.com/k1udKZBC
[2012-01-10 23:14:00 -0500] mib_mib: so it appears that sudo just isn't being used properly or something
[2012-01-10 23:14:00 -0500] workmad3: mib_mib: yeah, that's odd... never had that happen
[2012-01-10 23:14:00 -0500] mib_mib: is it something with my template file?
[2012-01-10 23:14:00 -0500] workmad3: mib_mib: can you gist the template file?
[2012-01-10 23:14:00 -0500] mib_mib: http://pastebin.com/qPs9Pzhd
[2012-01-10 23:15:00 -0500] Brad_K: mib_mib: have you tried running the same knife command without the "sudo" argument?
[2012-01-10 23:15:00 -0500] Brad_K: when a knife bootstrap is run, it should already be running as root on the machine being installed and therefore should not need to run under sudo.
[2012-01-10 23:16:00 -0500] mib_mib: basically the same error messages - except it doesnt have the 'sudo' error messages at the start
[2012-01-10 23:16:00 -0500] mib_mib: its the basic ubuntu 10.04 setup - i set a password on ubuntu - could that be it?
[2012-01-10 23:17:00 -0500] mib_mib: yet sudo works fine
[2012-01-10 23:17:00 -0500] mib_mib: just running sudo after logged in i mean
[2012-01-10 23:19:00 -0500] workmad3: mib_mib: weird... the only thing substantially different from my bootstrap template is that I use bash --login -c  to execute... but that's specifically because I install ruby using RVM initially and the --login ensures that rvm gets sourced properly for the command
[2012-01-10 23:19:00 -0500] mib_mib: my guess is somehow the template file is messed up...
[2012-01-10 23:19:00 -0500] Brad_K: i don't use the "knife bootstrap" command, so i think i'm at a dead end for being able to provide any further assistance.  when we create servers, we use things like "knife rackspace server create --image 114 --flavor 3 -d omnibus -r 'role[base]'", and I would have assumed that the "knife ec2 server create" command would work similarly.
[2012-01-10 23:20:00 -0500] mib_mib: ok...
[2012-01-10 23:20:00 -0500] mib_mib: i guess what i'll do
[2012-01-10 23:20:00 -0500] mib_mib: is just keep recreating the instances
[2012-01-10 23:20:00 -0500] mib_mib: and adding one line by one line
[2012-01-10 23:20:00 -0500] mib_mib: from the original bootstrap file, until it breaks
[2012-01-10 23:20:00 -0500] mib_mib: thx for help anyway
[2012-01-10 23:21:00 -0500] mib_mib: really this bootstrap file is hilarious - i cant believe it just a straight bash script, i would think they would have wrapped the different parts into methods i.e. 'download_rubygems' method, 'install_rubygems' etc
[2012-01-10 23:23:00 -0500] Brad_K: speaking only for myself, i'm a fan of the "KISS" and "If it ain't broke, don't fix it" principles.  as silly-simple as the bootstrap file looks like it is, i believe that it qualifies on both regards.
[2012-01-10 23:23:00 -0500] workmad3: I'm with Brad_K... no need to overcomplicate
[2012-01-10 23:24:00 -0500] mib_mib: true, one perspective =D
[2012-01-10 23:24:00 -0500] Brad_K: now, in this case, obviously something is broke.  however, we don't know what, and the answer doesn't seem to be obvious on inspection  at least, not for us.
[2012-01-10 23:24:00 -0500] Brad_K: so, clearly something does need to be fixed in this case.
[2012-01-10 23:24:00 -0500] workmad3: mib_mib: oh... one other thing that is different, thinking about it... my bash -c command is right at the start
[2012-01-10 23:25:00 -0500] workmad3: mib_mib: nothing before it in the file
[2012-01-10 23:25:00 -0500] workmad3: mib_mib: not even an empty line... maybe that's causing your issue?
[2012-01-10 23:29:00 -0500] yfeldblum: radim, tags and `knife tag create` work right now
[2012-01-10 23:29:00 -0500] jtimberman: mib_mib: the bootstrap template is rendered as a command to be executed on the remote system via SSH.
[2012-01-10 23:29:00 -0500] workmad3: jtimberman: ah, so the blank lines at the top will be the problem?
[2012-01-10 23:29:00 -0500] jtimberman: probably
[2012-01-10 23:29:00 -0500] yfeldblum: radim, and i am using tags, so it would certainly be very odd for me if they weren't implemented right now ...
[2012-01-10 23:29:00 -0500] jtimberman: first line should be the bash -c
[2012-01-10 23:30:00 -0500] jtimberman: other than the download/install of ruby/rubygems and the chef gem, it should execute pretty quickly and simply
[2012-01-10 23:30:00 -0500] workmad3: yeah... my normal bootstrap creates the .pem files and starts the first chef-client run
[2012-01-10 23:55:00 -0500] drudru: i have a chef internals question - i'm studying nosql databases and I know chef uses couch. How is that working and what is the 'schema' (loosely) like of chef on it?
