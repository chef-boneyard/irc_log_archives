[2012-01-17 08:53:00 -0500] nacer: ohai
[2012-01-17 09:37:00 -0500] ranjibd: nacer, ohai
[2012-01-17 09:40:00 -0500] BryanWB: nacer ohai1
[2012-01-17 09:49:00 -0500] caaakeeey: how do i set the contents of a file based on on whether another file exists?
[2012-01-17 09:54:00 -0500] fujin: put both files and move on.
[2012-01-17 09:54:00 -0500] fujin: def another_file_exists?; ... ; end; file("/some/file") { content "something"; only_if { another_file_exists? } }
[2012-01-17 09:54:00 -0500] matti: fujin: :)
[2012-01-17 09:54:00 -0500] fujin: you really want to not be in behavior like that, try to be more explicit about the desired state
[2012-01-17 09:57:00 -0500] caaakeeey: hmm 2 files with only~if and not_if could work... in puppet i copied over both files, then execd a line of bash deciding which file to use
[2012-01-17 10:07:00 -0500] fujin: why though
[2012-01-17 10:07:00 -0500] fujin: that sounds so broken
[2012-01-17 10:07:00 -0500] fujin: why not just decide what you want to do and do it
[2012-01-17 10:07:00 -0500] fujin: instead of doing magic flippy backwards behavior
[2012-01-17 10:07:00 -0500] fujin: have one recipe do one thing and another do something else
[2012-01-17 10:08:00 -0500] fujin: have one role include one recipe
[2012-01-17 10:08:00 -0500] fujin: have another role include the other recipe
[2012-01-17 10:08:00 -0500] fujin: two unique concepts in your infrastructure
[2012-01-17 10:10:00 -0500] caaakeeey: because it's a recipe to install and configure a piece of software, that software uses an install script, the options that get passed in to the configure script depend on whether this is the first run of the install/configure script or a subsequent run
[2012-01-17 10:14:00 -0500] caaakeeey: any ideas?
[2012-01-17 10:14:00 -0500] lflux: ohai chefs
[2012-01-17 10:42:00 -0500] BryanWB: does the install create any files or set particular values in specific files?
[2012-01-17 10:42:00 -0500] viraptor: hi all, I've got a strange problem with chef where solr loses attribute indexes randomly (actually looks like it does that after I upload a new cookbook) I'm trying a node search in form "some_node_attribute:value" where some.node.attribute is defined in the environment
[2012-01-17 10:42:00 -0500] BryanWB: then you could do  if File.exist?   # installed already  else  # not installed, do installation
[2012-01-17 10:43:00 -0500] viraptor: `knife index rebuild -y` doesn't fix this - does anyone know what could be the reason?
[2012-01-17 11:03:00 -0500] viraptor: my issue seems to be CHEF-2346, but it's never resolved it seems...
[2012-01-17 11:23:00 -0500] caaakeeey: BryanWB, and that gets run client side i guess?
[2012-01-17 11:34:00 -0500] BryanWB: caaakeeey: yes
[2012-01-17 13:03:00 -0500] iroller: Hi. Is there any way to restrict use of _default environment? For example I want to have all new nodes using "testing" environment.
[2012-01-17 13:04:00 -0500] BryanWB: iroller: fuck, i would like to know the same
[2012-01-17 13:20:00 -0500] yfeldblum: iroller, i bet you could do that in a custom knife plugin
[2012-01-17 13:21:00 -0500] BryanWB: yfeldblum: good morning
[2012-01-17 13:23:00 -0500] iroller: yfeldblum: it seems to me too complicated to write a knife plugin for such simple feature. I don't understand why it is not possible to rename '_default' env
[2012-01-17 13:24:00 -0500] yfeldblum: BryanWB, good morning to you, sir
[2012-01-17 13:26:00 -0500] yfeldblum: iroller, actually it's not terribly complicated once you get the hang of it - a knife plugin is simply and only a piece of code that knife will automatically load because it is the right place and/or has the right name for knife to find it
[2012-01-17 13:30:00 -0500] iroller: yfeldblum: yeah but I don't think writing a knife plugin is the best way to resolve this issue. Probably it's better to write a patch for chef-server adding an options 'set environment writable' and 'rename environment'. Of course if there are no serious reasons to keep read-only '_default' environment
[2012-01-17 13:32:00 -0500] nacx: hi,
[2012-01-17 13:32:00 -0500] nacx: when using hosted chef, is it possible to use knife to eprform operations logging as a client, instead of using the organization user ?
[2012-01-17 13:33:00 -0500] nacx: if I run knife client list, as a client i get an auth error, but I can do it using the org. user. is it right?
[2012-01-17 13:35:00 -0500] yfeldblum: latez
[2012-01-17 13:46:00 -0500] caaakeeey: im using hosted chef, do i have to create a new user for each node?
[2012-01-17 14:13:00 -0500] mrtazz: caaakeeey: you don't have to, you can allow any user to access any node
[2012-01-17 14:13:00 -0500] mrtazz: as far as I know
[2012-01-17 14:26:00 -0500] nacx: hi
[2012-01-17 14:26:00 -0500] nacx: is it possible that in hosted chef, when using the API to get the runlist of a node
[2012-01-17 14:26:00 -0500] nacx: you get something like: run_list":[{"version":null,"type":"recipe","name":"apache2"}]}
[2012-01-17 14:27:00 -0500] nacx: instead of: "run_list": [ "recipe[apache2]" ]
[2012-01-17 14:27:00 -0500] nacx: as usual?
[2012-01-17 14:29:00 -0500] viraptor: iroller: if you create your node on your own not automatically, you can set the editor to your own script which basically does `sed -i 's/_default/something_you_want/' $1`
[2012-01-17 14:30:00 -0500] iroller: viraptor: dirty hack :)
[2012-01-17 14:32:00 -0500] yfeldblum: ... or, make your own script that wraps `knife *** server create` or `knife bootstrap` and passes in `--environment testing`
[2012-01-17 14:39:00 -0500] ssd7: nacx: Yes
[2012-01-17 14:40:00 -0500] ssd7: One sec and I can explain where I have seen it before.
[2012-01-17 14:40:00 -0500] nacx: but in chef community it still returns "run_list": [ "recipe[apache2]" ]
[2012-01-17 14:40:00 -0500] nacx: it is not a matter of the chef server version, but a matter of being hosted or community?
[2012-01-17 14:41:00 -0500] ssd7: Hmmmm. So it is possible that the open source server cleans up the entry, but in the case I am thinking of, the problem is client side.
[2012-01-17 14:42:00 -0500] ssd7: Within your recipes are you requiring any gems?
[2012-01-17 14:42:00 -0500] nacx: no, i am jsut using the apache recipe
[2012-01-17 14:43:00 -0500] nacx: i am using the rest api to get the runlist of the nodes, using the same code to get it rom bhoth, open source and hosted chef
[2012-01-17 14:43:00 -0500] nacx: and jsut nboticed hosted implementation was broken
[2012-01-17 14:44:00 -0500] nacx: are both rest apis going to be unified, at least to return the same responses? (i am running open source 0.10 btw)
[2012-01-17 14:47:00 -0500] ssd7: nacx: So in the only case I've looked at with the before, the client was pushing the run list that looked like your first example becuase various "as_json" functions had been monkeypatched by the ActiveSupport gems, leading to the "wrong" JSON to pushed to the server.
[2012-01-17 14:48:00 -0500] nacx: if I understand wll, that is a chef-client or a knife issue.
[2012-01-17 14:48:00 -0500] nacx: but in my case, i am consuming directly the rest api
[2012-01-17 14:49:00 -0500] nacx: and the get request to /node/<node_name> seems to be returning the run_list attribute in a different format depending on the target chef server
[2012-01-17 14:49:00 -0500] nacx: just wanted to know if it is an issue,  or it is the expected behavior
[2012-01-17 14:52:00 -0500] ssd7: nacx:  Well, if the open source server response differently, I would consider it a bug in Hosted Chef since we generally aim at ensuring that the API remains consistent.
[2012-01-17 14:53:00 -0500] nacx: thx ssd7, i'll get both json responses to have all the info to report an issue
[2012-01-17 14:53:00 -0500] nacx: another thing I've seen is when trying
[2012-01-17 14:54:00 -0500] nacx: to list the clients in a hosted chef using knife
[2012-01-17 14:54:00 -0500] ssd7: That being said, it is also in some sense known, since, as I mentioned, I've seen one example of it.  I just didn't know that the open source server behaved differently in this regard, since I focused on finding where the errant JSON was being created client-side
[2012-01-17 14:54:00 -0500] nacx: if I list the clients and use the organization user credentials, there is no problem
[2012-01-17 14:54:00 -0500] nacx: but if I list the clients using an "admin client" and its certificate to log in, i always get an auth error
[2012-01-17 14:55:00 -0500] nacx: do you know if that is the expected behavior?
[2012-01-17 14:56:00 -0500] ssd7: That one is harder to say.  Hosted CHef has a more fine-grained permissions system than the Open source server. It is likely that the permissions of the client you are using are somehow misconfigured.
[2012-01-17 14:56:00 -0500] viraptor: did anyone noticed the issue / figure out a workaround for CHEF-2480 bug where some nested attributes are not indexed in solr? (index rebuild doesn't help)
[2012-01-17 14:56:00 -0500] nacx: ssd7, I just added the client to the admins group
[2012-01-17 14:56:00 -0500] nacx: but still getting that auth error
[2012-01-17 14:59:00 -0500] ssd7: nacx: Well, on Hosted Chef, the admin group is simply a group that happens to have a set of permissions, so it could still be the case that the permissions there are messed up.  On the following page, does the admin group have "LIST" permissions? https://manage.opscode.com/clients/_acl
[2012-01-17 15:01:00 -0500] ssd7: viraptor: Hmm.  Like mkent_ pointed out in the comments of that ticket, my guess would be that the problem is the maxFieldLength in solr: http://tickets.opscode.com/browse/CHEF-2346
[2012-01-17 15:01:00 -0500] viraptor: same as the original author commented on that ticket -> I have it set to an absurd large number
[2012-01-17 15:02:00 -0500] viraptor: did a rebuild after changing it and restarting too
[2012-01-17 15:03:00 -0500] nacx: eys, the group has the permissino .SD
[2012-01-17 15:03:00 -0500] nacx: :S
[2012-01-17 15:04:00 -0500] viraptor: ssd7: maybe I'm doing that in a wrong way though - do I need to kill the whole solr database after I change that parameter, or is `index rebuild -y` enough?
[2012-01-17 15:05:00 -0500] ssd7: viraptor: I think simply restarting solr and rebuiding the index should be enough.  Unfortunately off the top of my head I do not know of any other progress on that particular bug.
[2012-01-17 15:06:00 -0500] viraptor: hmm... I think I found something interesting... chef uses a different solr config, not the one in etc...
[2012-01-17 15:08:00 -0500] ssd7: nacx: Hmm. Well, if the group has the LIST permission and the client is in that group, then knife client list using those client credentials should work.  If you'd like, file a ticket at help.opscode.com and we can take a look.
[2012-01-17 15:08:00 -0500] nacx: i'll do. thx a los ssd7
[2012-01-17 15:54:00 -0500] mattray: http://itunes.apple.com/us/podcast/the-food-fight-show/id495577922
[2012-01-17 16:09:00 -0500] riccardotacconi: hi all
[2012-01-17 16:09:00 -0500] riccardotacconi: I have an error when running 'knife ec2' (first time / newbie user)
[2012-01-17 16:09:00 -0500] riccardotacconi: do you know the meaning of the -S option?
[2012-01-17 16:10:00 -0500] frank__: all, how do I use the run_list.expand function?
[2012-01-17 16:11:00 -0500] frank__: expand seems to need an argument
[2012-01-17 16:11:00 -0500] frank__: but can't find docs
[2012-01-17 16:21:00 -0500] jbz: frank__: Are you trying to get the expanded runlist, as in, 'show me all the recipes'?  If so, I use node.run_state[:seen_recipes]
[2012-01-17 16:21:00 -0500] jbz: That unpacks roles etc.
[2012-01-17 16:21:00 -0500] jbz: And also gives you recipes that were run via include
[2012-01-17 16:24:00 -0500] riccardotacconi: I am trying Build+a+LAMP+Stack.. any help?
[2012-01-17 16:25:00 -0500] rays: having an odd error with chef-client... any ideas? http://pastebin.com/SR8Le8X6
[2012-01-17 16:26:00 -0500] rays: its a 403 forbidden talking to opscode
[2012-01-17 16:26:00 -0500] frank__: jbz: what is diff with node.run_list.expand("production").recipes.include? "php::5-3-libapache"?
[2012-01-17 16:26:00 -0500] jtimberman: riccardotacconi: -S is the name of the SSH key pair that you have created in the AWS account for the region/AZ you're launching in the instance in.
[2012-01-17 16:27:00 -0500] frank__: (and should "production" be the string production?)
[2012-01-17 16:27:00 -0500] jtimberman: riccardotacconi: for example, we have separate SSH keys in our AWS testing account for each person, so mine is "jtimberman", I use "-S jtimberman"
[2012-01-17 16:28:00 -0500] frank__: jbz: run_state[:seen_recipes] gives me empty list in shef, is that normal?
[2012-01-17 16:28:00 -0500] jtimberman: frank__: that might be normal
[2012-01-17 16:28:00 -0500] jbz: frank__: Oh, I dunno if that :seen_recipes thing works in shef
[2012-01-17 16:28:00 -0500] frank__: jbz: does it show only the runlist in that run?
[2012-01-17 16:28:00 -0500] jbz: frank__: Yes.
[2012-01-17 16:28:00 -0500] jtimberman: frank__: node['recipes'] is an attribute that contains the recipes from the expanded list
[2012-01-17 16:28:00 -0500] frank__: jbz: ah, explains
[2012-01-17 16:28:00 -0500] jbz: frank__: If you're looking at run_state, then by def. you're only looking at data from that run.
[2012-01-17 16:29:00 -0500] jbz: jtimberman: node['recipes'] doesn't contain the include recipes though, correct?
[2012-01-17 16:29:00 -0500] frank__: jtimberman: ah, that easy?
[2012-01-17 16:29:00 -0500] jtimberman: jbz: Ah, no, it doesn't
[2012-01-17 16:30:00 -0500] jtimberman: only the recipes that were in the expanded run list
[2012-01-17 16:31:00 -0500] jbz: Ah, thank you, just checking for my own use; I suspect that's OK for frank__
[2012-01-17 16:31:00 -0500] jbz: riccardotacconi: Have you run into a particular problem?
[2012-01-17 16:32:00 -0500] riccardotacconi: member:jtimberman: tank you. I was using the wrong key pairs
[2012-01-17 16:32:00 -0500] riccardotacconi: last thing: does the -i option coresponds to -i option of ssh command?
[2012-01-17 16:35:00 -0500] rays: any ideas on my 403 error?
[2012-01-17 16:35:00 -0500] frank__: jtimberman: in the node.run_list.expand function, the first param is "environment". what should I pass? a sting, an environment object, an id, ...?
[2012-01-17 16:36:00 -0500] jbz: riccardotacconi: -i on knife?
[2012-01-17 16:37:00 -0500] brett_h: is there a way to get the node name you specify with "knife ec2 server create" inside of a recipe? it looks like node.name is just the current fqdn, I want to set the proper hostname in a recipe
[2012-01-17 16:37:00 -0500] brett_h: and I'm providing, say, -N foo1
[2012-01-17 16:37:00 -0500] riccardotacconi: yes on knife (ec2)
[2012-01-17 16:38:00 -0500] brett_h: riccardotacconi: to me? where can I access that?
[2012-01-17 16:38:00 -0500] riccardotacconi: srry no to jbz
[2012-01-17 16:38:00 -0500] jbz: riccardotacconi: Yes, it does.  Use "knife ec2 server create --help" to get a full options list.
[2012-01-17 16:39:00 -0500] jbz: rays: 403 from the platform *usually* means you're trying to access a resource that your ID doesn't have access to.
[2012-01-17 16:39:00 -0500] jbz: (Note I say "usually" :-P)
[2012-01-17 16:40:00 -0500] jbz: Does this happen with any transaction, or just this one?  And is it from a client run or from knife?
[2012-01-17 16:40:00 -0500] riccardotacconi: is SSH identity file global or binded to a zone i.e. us-east?
[2012-01-17 16:41:00 -0500] rays: jbz: from chef-client --once --log_level debug
[2012-01-17 16:41:00 -0500] jbz: riccardotacconi: In EC2, they're bound to a region like, yes, us-esat-1
[2012-01-17 16:41:00 -0500] jbz: er, us-east-1
[2012-01-17 16:41:00 -0500] jbz: All AWS entities are region-specific, which SUUUUUCKS
[2012-01-17 16:41:00 -0500] rays: jbz: I can send you the full trace if you want
[2012-01-17 16:42:00 -0500] jbz: rays:  please, pastebin it
[2012-01-17 16:42:00 -0500] jbz: I'll have a gander, no guarantees though, I'm just zis guy, you know?
[2012-01-17 16:42:00 -0500] rays: jbz: fresh eyes always helps, so thanks
[2012-01-17 16:43:00 -0500] riccardotacconi: jbz: thanks
[2012-01-17 16:44:00 -0500] jbz: riccardotacconi: you're welcome!
[2012-01-17 16:44:00 -0500] riccardotacconi: are key pairs used to access the instances or to access the EC2 API? I am a bit confused
[2012-01-17 16:45:00 -0500] rays: jbz: pm'ed you the log
[2012-01-17 16:45:00 -0500] jbz: yep, lookin'...
[2012-01-17 16:46:00 -0500] jbz: rays:  At first glance, it looks like this client doesn't have the privs to see these cookbooks (or maybe this environment).  Can you verify on the platform that the client is 'in' that environment?
[2012-01-17 16:54:00 -0500] riccardotacconi: I am confused between -S and -i options
[2012-01-17 16:55:00 -0500] rays: jbz: I dont see anything different with this one than the others, though I'm not sure I'm looking at the right place
[2012-01-17 17:00:00 -0500] jbz: riccardotacconi: -i specifies a local filename where the client should get the key it uses to authenticate to the server once the server is up.  -S tells AWS which keypair to install onto the server as it starts it.
[2012-01-17 17:00:00 -0500] jbz: (sorry, -i specifies where *knife* should find the key locally, for the bootstrap).
[2012-01-17 17:00:00 -0500] jbz: -S specifies an Amazon entity.  -i specifies a local path.
[2012-01-17 17:01:00 -0500] jbz: rays:  If you look at the management interface on the platform, look at 'Nodes' and select the environment in the dropdown, does the node you're working on show up in the list?
[2012-01-17 17:03:00 -0500] rays: jbz, I think we found it, the env was just out-right wrong
[2012-01-17 17:03:00 -0500] jbz: rays:  Ahh sweet.
[2012-01-17 17:04:00 -0500] riccardotacconi: ok so I have the key pair in ~/.ssh/us-east.pem so I use -S us-east -i ~/.ssh/us-east.pem
[2012-01-17 17:04:00 -0500] jbz: riccardotacconi: Uh...if your keypair is named us-east, then sure, although that sounds like it might get confusing. :-P
[2012-01-17 17:05:00 -0500] riccardotacconi: I launched an instance on EC2 us-east with
[2012-01-17 17:05:00 -0500] riccardotacconi: knife ec2 server create -G default -I ami-7000f019 -f m1.small \
[2012-01-17 17:05:00 -0500] riccardotacconi:       -S us-east -i ~/.ssh/us-east.pem -x ubuntu \
[2012-01-17 17:05:00 -0500] riccardotacconi:       -r 'role[base],role[mediawiki_database_master],role[mediawiki],recipe[mediawiki::db_bootstrap],role[mediawiki_load_balancer]'
[2012-01-17 17:05:00 -0500] riccardotacconi: but it hangs at: Winting for sshd...
[2012-01-17 17:05:00 -0500] jbz: are you sure it's hanging?  That's a delay that's built in
[2012-01-17 17:06:00 -0500] jbz: it waits so as to be sure that the node has actually come up, and that it has started up the sshd at boot
[2012-01-17 17:06:00 -0500] jbz: It might also keep retrying the connect, unsure.
[2012-01-17 17:06:00 -0500] jbz: But anyway, that's the point at which it has told AWS what kind of node it wants, now it just has to wait around until AWS/EC2 brings up the node and gets it ready to accept ssh.
[2012-01-17 17:07:00 -0500] riccardotacconi: I hope so on the management console (AWS) 'Status Checks' reports initializing
[2012-01-17 17:07:00 -0500] jbz: OK so it's working then.
[2012-01-17 17:07:00 -0500] riccardotacconi: thnks a milion :-)
[2012-01-17 17:07:00 -0500] jbz: Most welcome.
[2012-01-17 17:12:00 -0500] statix: Might there be a problem with cookbook names with hypens or something like that? I just uploaded a valid cookbook "percona-install" added to a node runlist, and now I get this: INFO: HTTP Request Returned 412 Precondition Failed: {"non_existent_cookbooks":["percona-server"],"cookbooks_with_no_versions":[],"message":"Run list contains invalid items: no such cookbook percona-server."}
[2012-01-17 17:12:00 -0500] statix: I can see the cookbook in the WebUI
[2012-01-17 17:12:00 -0500] statix: Wait, n/m, I'm an idiot
[2012-01-17 17:13:00 -0500] statix: "percona-server" != "percona-install"
[2012-01-17 17:13:00 -0500] statix: :|
[2012-01-17 17:39:00 -0500] groundup: I am slightly confused at this point of installation. I have a single server setup right now which hosts chef-server. I want to use cookbooks to configure and track configuration of this server as well as many others. I want to put all of my cookbooks in a git repository to track changes. So, what steps do I need to take with knife to make that happen?
[2012-01-17 17:42:00 -0500] jbz: groundup: You can put your cookbooks in a git repository, but you will need to use knife to upload them to the chef server.  The chef server won't 'watch' a git repo.
[2012-01-17 17:43:00 -0500] jbz: Generally there are three 'machines' involved in chef management - the user's workstation, the chef server, and the node being managed.
[2012-01-17 17:43:00 -0500] groundup: When the repo changes, do I upload again?
[2012-01-17 17:43:00 -0500] jbz: Yes.
[2012-01-17 17:44:00 -0500] jbz: There are likely add-ons out there that will do that automagically - for that matter, you could probably hack a git commit hook to do it.
[2012-01-17 17:44:00 -0500] groundup: Doing a quick search, I don't see any post-commit hooks but I will look further for that.
[2012-01-17 17:45:00 -0500] jbz: Bear in mind that in most cases you *don't* want the cookbooks to push on commit, because then whenever you commit 'mid-task' when working on the cookbooks, you'll break convergence on any server which uses that cookbook.
[2012-01-17 17:49:00 -0500] binbasti: hi. can someone recommend a good cookbook for backups (incl. encryption, rotation etc.) to either sftp or s3 or similar?
[2012-01-17 17:54:00 -0500] groundup: Trying to setup my client I get this: [root@localhost /]# knife client create jdickerson -n -a -f /tmp/jdickerson.pem ERROR: RuntimeError: Please set EDITOR environment variable
[2012-01-17 17:54:00 -0500] Matthaeus: groundup: export EDITOR=vim
[2012-01-17 17:54:00 -0500] groundup: I did
[2012-01-17 17:54:00 -0500] Matthaeus: So, anybody else's couchdb on ubuntu suddenly take the piss?
[2012-01-17 17:55:00 -0500] groundup: Woops, nm typo
[2012-01-17 17:57:00 -0500] Matthaeus: I'm getting os_process_error messages with couchdb on ubuntu 10.04.  Help?
[2012-01-17 18:07:00 -0500] bdha: Anyone using omnibus for non-Chef stacks?
[2012-01-17 18:09:00 -0500] riccardotacconi: I successfully booted a EC2 instance and installed a LAMP stack. Yes! Now I am trying to boot an instance in Europe, not in us-east but I get ERROR: You have not provided a valid image (AMI) value. The instance ID is ami-c00e3cb4. The instance is an official Ubuntu instance for Ec2... do I need any special instance for Chef/knife?
[2012-01-17 18:09:00 -0500] erikh: ami's are tied to regions
[2012-01-17 18:09:00 -0500] erikh: you need a different AMI for europe.
[2012-01-17 18:09:00 -0500] jbz: riccardotacconi: Make sure you're using hte right AMI, they're different.
[2012-01-17 18:10:00 -0500] mattray: uec-images.ubuntu.com
[2012-01-17 18:10:00 -0500] riccardotacconi: yes I already have an istance in Europe (stared manually) and I am using that AMI which is right
[2012-01-17 18:11:00 -0500] bdha: Are you sure the AMI still exists? (Search for it in the console or via API.)
[2012-01-17 18:13:00 -0500] kallistec: riccardotacconi: can you post your knife.rb? don't forget to obscure your keys
[2012-01-17 18:18:00 -0500] jtimberman: bdha: I think mitchellh just used it for building vagrant installers.
[2012-01-17 18:18:00 -0500] jtimberman: (omnibus)
[2012-01-17 18:18:00 -0500] jtimberman: riccardotacconi: specify --region eu-west-1 --availability-zone eu-west-1b (or your preferred region/AZ)
[2012-01-17 18:19:00 -0500] jtimberman: and the AMI for that region per the Ubuntu AMI list
[2012-01-17 18:20:00 -0500] riccardotacconi: member:jtimberman: YES!
[2012-01-17 18:20:00 -0500] Matthaeus: I'm sure this is a common question, but googling reveals little in the way of a cogent, usable answer: How can I troubleshoot a os_process_error,{exit_status,0} in my couch.log? I've been running chef on Ubuntu LTS 10.04.3.
[2012-01-17 18:21:00 -0500] jtimberman: riccardotacconi: you can also configure knife.rb to specify the region and availability zone by default
[2012-01-17 18:21:00 -0500] jtimberman: knife[:availability_zone] = ""
[2012-01-17 18:21:00 -0500] jtimberman: nife[:region] = ""
[2012-01-17 18:21:00 -0500] jtimberman: change "" to "eu-west-1" or whatever.
[2012-01-17 18:22:00 -0500] riccardotacconi: sweet
[2012-01-17 18:24:00 -0500] bdha: jtimberman: o rly!
[2012-01-17 18:25:00 -0500] jtimberman: bdha: thats what his twitter feed said.
[2012-01-17 18:25:00 -0500] bdha: Thanks. :)
[2012-01-17 18:26:00 -0500] jtimberman: https://twitter.com/#!/mitchellh/status/159069173115396096
[2012-01-17 18:26:00 -0500] jtimberman: I'm just going to make all kinds of assumptions :)
[2012-01-17 18:33:00 -0500] caaakeeey: is hosted chef down or something?
[2012-01-17 18:33:00 -0500] caaakeeey: seems to take forever to download
[2012-01-17 18:33:00 -0500] caaakeeey: can i be throttles?
[2012-01-17 18:33:00 -0500] caaakeeey: d
[2012-01-17 18:41:00 -0500] erikh: caaakeeey: it's been a little slow this morning for me too
[2012-01-17 18:43:00 -0500] caaakeeey: also this is just testing, but who uses hosted chef? it seems that handing over executable rights to your entire network to an external source, however reliable, is just a bad idea
[2012-01-17 18:43:00 -0500] caaakeeey: i guess its no real difference to aws or the like but still
[2012-01-17 18:43:00 -0500] jbz: We use hosted chef.
[2012-01-17 18:44:00 -0500] jbz: We're handling clinical data.
[2012-01-17 18:44:00 -0500] foo23: hi
[2012-01-17 18:44:00 -0500] jbz: But all our stuff is in the cloud, so we're not actually managing stuff inside our corp network using hosted chef.
[2012-01-17 18:45:00 -0500] foo23: If I don't want to use the default templates, but $cookbook/templates/myversion/, how do I do that?
[2012-01-17 18:50:00 -0500] mattray: foo23: http://wiki.opscode.com/display/chef/Templates read the Template Location Specificity
[2012-01-17 18:52:00 -0500] foo23: mattray: thanks. my problem with this is that its only fqdn and platform driven
[2012-01-17 18:53:00 -0500] foo23: mattray: I cant find how i say "server X, with role y uses templatefolder y"
[2012-01-17 18:53:00 -0500] mattray: foo23: using subdirectories under templates/default/myversion/ doesn't work?
[2012-01-17 18:53:00 -0500] mattray: and just pass myversion/blah.erb as the source?
[2012-01-17 18:55:00 -0500] foo23: mattray: hmm? Can't follow you. its more about using templates/$FOO/ and not templates/default/, where $FOO is not :fqdn or :platform driven but set by some "magic"
[2012-01-17 18:55:00 -0500] jbz: foo:  Have you tried templates/default/$FOO?
[2012-01-17 18:55:00 -0500] mattray: right, I'm saying if you need a subdirectory that's not fqdn or platform, why not put it under default?
[2012-01-17 18:56:00 -0500] mattray: what jbz said :)
[2012-01-17 18:56:00 -0500] jbz: :-)
[2012-01-17 18:56:00 -0500] foo23: mattray: how can i say "default/servergroup1" is used and not "default/default/"?
[2012-01-17 18:57:00 -0500] mattray: you can put logic within the template to use an if statement to determine the source
[2012-01-17 18:57:00 -0500] foo23: my idea is using default cookbooks and doing quick modification so that servergroup1 use templates/servergroup1/, servergroup2 uses templates/servergroup2/
[2012-01-17 18:58:00 -0500] foo23: and i can say something like runlist[cookbook][usetemplate=servergroupX]
[2012-01-17 18:59:00 -0500] mattray: yeah, put the path you want to use in a variable, evaluate what you want outside the template and pass it in
[2012-01-17 18:59:00 -0500] mattray: source sourcevariable
[2012-01-17 18:59:00 -0500] mattray: where you determined what you want outside the template
[2012-01-17 19:00:00 -0500] foo23: ok. so I have to do it myself in the cookbook code. Just thought there may be a resolution because I saw the the template options for platform and FQDN.
[2012-01-17 19:01:00 -0500] mattray: yeah, afaik there's nothing automatic like what you're trying to do
[2012-01-17 19:02:00 -0500] foo23: ok. would have been nice. my idea was to use an own folder in template with the idea in mind that I can easily stay in sync with the via git cloned version
[2012-01-17 19:03:00 -0500] foo23: I thought that chefs purpose was to keep things simple ;-)
[2012-01-17 19:11:00 -0500] behemphi: Hello all, I am getting this message:  FATAL: Net::HTTPServerException: 403 "Forbidden" when I try to create a new server with knife rackspace server create.  I cannot track down the issue.  No changes in Hosted Chef.  Any ideas?
[2012-01-17 19:12:00 -0500] ssd7_: behemphi: Do your rackspace creds otherwise work?
[2012-01-17 19:13:00 -0500] behemphi: I am not sure how to test this directly, but I can run the chef client on 58 of my 59 nodes
[2012-01-17 19:14:00 -0500] behemphi: well, wait, the server itself is created.   I can log in to it, so yes, the RS creds are solid
[2012-01-17 19:14:00 -0500] behemphi: the chef client is on the machine
[2012-01-17 19:14:00 -0500] behemphi: and the node exists in Hosted Chef
[2012-01-17 19:15:00 -0500] ssd7_: Ahh, so the 403 is from inside the chef-client run?
[2012-01-17 19:15:00 -0500] behemphi: yes, sorry I should have made that clear.
[2012-01-17 19:16:00 -0500] ssd7_: Hmm.  I'd use -l debug to see what API call is being rejected, that will give some indication of what permission the relevant client is missing
[2012-01-17 19:22:00 -0500] behemphi: ssd7_: I ran this and don't recognize anything useful.  This seems slightly more detailed, HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden
[2012-01-17 19:22:00 -0500] behemphi: But there is nothing like "missing CREATE permission" as I would expect.  Am I looking for the wrong thing?
[2012-01-17 19:23:00 -0500] ssd7_: behemphi: Yeah, it won't say anything that specific, but you should be able to see what URL it was trying to GET or PUT or POST to
[2012-01-17 19:23:00 -0500] behemphi: What is puzzling is that I have not changed any settings in Hosted Chef in quite awhile
[2012-01-17 19:24:00 -0500] behemphi: cookbook_versions
[2012-01-17 19:24:00 -0500] behemphi: specifically:  api.opscode.com:443/organizations/feedmagnet/environments/production/cookbook_versions
[2012-01-17 19:25:00 -0500] ssd7_: Hmm. Just as a sanity check, does the production environment exist?
[2012-01-17 19:26:00 -0500] behemphi: Alright Seth, you have helped me out of some sticky situations . but this is simply embarrassing .. production does _not_ exist, but "Production" does!
[2012-01-17 19:26:00 -0500] behemphi: ugh
[2012-01-17 19:26:00 -0500] ssd7_: hehe, no problem.  It's Steve btw :)
[2012-01-17 19:27:00 -0500] behemphi: sorry Steve
[2012-01-17 19:27:00 -0500] behemphi: and thanks
[2012-01-17 19:27:00 -0500] behemphi: I have another question if you would like more to snicker at later
[2012-01-17 19:28:00 -0500] behemphi: I have one client that has stopped connecting to Hosted Chef, thus I cannot run the chef-client
[2012-01-17 19:28:00 -0500] behemphi: all the articles on this suggest a fix that involves running my own chef-server
[2012-01-17 19:28:00 -0500] behemphi: or resetting my API Key which would seem to invalidate all my other 58 nodes
[2012-01-17 19:28:00 -0500] ssd7_: What do you mean by "stopped connecting to Hosted Chef"
[2012-01-17 19:29:00 -0500] behemphi: [Tue, 17 Jan 2012 19:29:30 +0000] FATAL: Net::HTTPServerException: 401 "Unauthorized"
[2012-01-17 19:29:00 -0500] behemphi: Three total lines of output with that the last
[2012-01-17 19:31:00 -0500] ssd7_: Hmm.  This page has the common causes of that: http://wiki.opscode.com/display/chef/Common+Errors
[2012-01-17 19:31:00 -0500] behemphi: yep, that is what I worked my way through and some googled stuff
[2012-01-17 19:32:00 -0500] behemphi: but given my last snafu, I think I will work thought it again and report back :-)
[2012-01-17 19:32:00 -0500] ssd7_: Sounds good.  Feel free to open a ticket on help.opscode.com as well
[2012-01-17 19:43:00 -0500] bitmonk: getting a 504 Gateway Time-out on http://tickets.opscode.com/login.jsp
[2012-01-17 19:43:00 -0500] ranjibd: holoway, jtimberman , u there?
[2012-01-17 19:43:00 -0500] bitmonk: hum seems ok now..
[2012-01-17 19:50:00 -0500] Matthaeus: I think I've run into the couchdb stack space error.  I'm running Ubuntu 10.04 LTS.  What is the preferred way to get around this?
[2012-01-17 19:53:00 -0500] ranjibd: Matthaeus, stack space? did you ran compactions
[2012-01-17 19:55:00 -0500] Matthaeus: ranjibd: every 30 minutes as part of the chef-client run on the server, yes.
[2012-01-17 20:03:00 -0500] Matthaeus: Anyone?
[2012-01-17 20:13:00 -0500] erikh: is there a way to check if a data bag item exists without data_bag_item ?
[2012-01-17 20:13:00 -0500] erikh: I'm doing some ugly stuff with rescue nil and it's rather spammy
[2012-01-17 20:14:00 -0500] foo23: whenever i try to remove my broken runlist of a node, its getting bigger
[2012-01-17 20:14:00 -0500] foo23: recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[recipe[receip[mysql]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]]
[2012-01-17 20:15:00 -0500] foo23: how can i delete this runlist?
[2012-01-17 20:15:00 -0500] ssd7_: foo23: Yeah, there is a bug on this somewhere, one sec and I can whip up some knife-exec code that will do it
[2012-01-17 20:15:00 -0500] foo23: ssd7_: thanks. regex didn't work for me
[2012-01-17 20:17:00 -0500] ssd7_: foo23: try something like this: knife exec -E 'require "chef/run_list"; n = nodes.show("NODENAME"); n.run_list = Chef::RunList.new(); n.save'
[2012-01-17 20:19:00 -0500] bdha: Anyone using systemd? Most recent chef dies trying to chkconfig on native systemd services.
[2012-01-17 20:19:00 -0500] bdha: (only sysv services show in chkconfig)
[2012-01-17 20:22:00 -0500] Mithrandir: I am, but not with chef
[2012-01-17 20:24:00 -0500] bdha: :enable is sadface.
[2012-01-17 20:24:00 -0500] bdha: The provider needs to figure out if it's a native systemd service, and if so, use "systemctl foo enable" instead.
[2012-01-17 20:24:00 -0500] bdha: Rather annoying that chkconfig doesn't do that.
[2012-01-17 20:24:00 -0500] bdha: (It bloody well should.)
[2012-01-17 20:32:00 -0500] rrichardsr3: whats a common solution for building a local ssh config file with all running hosts in the cloud (ec2 for example). I was thinking i could use knife to get node info and hack a file together. I have mutliple developers that dont like poking around for ip addresses.;)
[2012-01-17 20:33:00 -0500] bdha: rrichardsr3: http://community.opscode.com/cookbooks/ssh_known_hosts
[2012-01-17 20:33:00 -0500] bdha: (have not used it)
[2012-01-17 20:34:00 -0500] rrichardsr3: bdha: ah sounds promising thanks
[2012-01-17 20:38:00 -0500] ktheory: Hi there, I'm getting a weird error using the "nagios_nrpecheck" provider from the Opscode nagios cookbook. It tries to restart the 'nagios-nrpe-server' service, but that fails with:
[2012-01-17 20:38:00 -0500] ktheory: NoMethodError: undefined method `run_action' for "service[nagios-nrpe-server]":String
[2012-01-17 20:38:00 -0500] ktheory: But I can see the service being defined in my logs. Here's a log snippet: https://gist.github.com/1596165
[2012-01-17 20:38:00 -0500] ktheory: It happens on both chef 0.10.4 and 0.10.8 (those are the only versions I've tried). Any suggestions? I'd be happy to submit a patch, but I don't understand why the provider wouldn't be able to find the service.
[2012-01-17 20:39:00 -0500] Matthaeus: Is anyone willing to take a look at an excerpt from couch.log and tell me what's going on?
[2012-01-17 20:39:00 -0500] ktheory: Here's the relevant code for the provider: https://github.com/opscode/cookbooks/blob/master/nagios/providers/nrpecheck.rb#L35
[2012-01-17 20:39:00 -0500] ktheory: And here's where the service is defined and the provider is called: https://github.com/opscode/cookbooks/blob/master/nagios/recipes/client.rb#L63
[2012-01-17 20:40:00 -0500] KarlHungus: hrm. how would i go about creating a custom version of the freebsd package resource provider?
[2012-01-17 20:41:00 -0500] KarlHungus: the current provider in 10.8 is slightly flawed, and i'd like to verify my changes work acrosss multiple hosts before pushing the patch upstread
[2012-01-17 20:41:00 -0500] KarlHungus: upstream*
[2012-01-17 20:45:00 -0500] foo23: ssd7_: thanks. it worked :)
[2012-01-17 20:47:00 -0500] ssd7_: foo23: Glad to hear it :)
[2012-01-17 20:47:00 -0500] foo23: ssd7_: is this bug reported?
[2012-01-17 20:49:00 -0500] ssd7_: Yeah, this looks like it no? http://tickets.opscode.com/browse/CHEF-1398
[2012-01-17 20:49:00 -0500] erikh: sorry to ask twice, but does anyone know of a better way to detect the existence of a databag item other than (data_bag_item(foo, bar) rescue nil) ?
[2012-01-17 20:50:00 -0500] erikh: it's ... pretty hacky
[2012-01-17 20:51:00 -0500] ssd7_: You could use search and check if results come back or not..not sure if that is better
[2012-01-17 20:51:00 -0500] erikh: no actually that's a great idea
[2012-01-17 20:51:00 -0500] ssd7_: Probably a bit cleaner than the rescue
[2012-01-17 20:51:00 -0500] erikh: let me give that a shot
[2012-01-17 20:51:00 -0500] erikh: right
[2012-01-17 20:51:00 -0500] foo23: ssd7_: yes.
[2012-01-17 20:53:00 -0500] ktheory: Ah, I found a workaround for my nagios nrpe problem: it works if I use the old service syntax in the provider: notifies :restart, resources(:service => "nagios-nrpe-server"), :delayed
[2012-01-17 20:54:00 -0500] foo23: apropos nagios. why is there a difference between the nagios cookbook and the nagios quick start?
[2012-01-17 20:54:00 -0500] foo23: thats kinda confusing
[2012-01-17 20:59:00 -0500] Matthaeus: I have this showing up in my couch.log:  http://pastie.org/3203564  Can someone please point me in the right direction?
[2012-01-17 21:05:00 -0500] Matthaeus: I think I'm being very patient, but I've been asking about this problem for four hours.  Can someone who knows even a little about couchdb please take a look and let me know what my options are?
[2012-01-17 21:09:00 -0500] statix: Can the WebUI or API be used over HTTPS?
[2012-01-17 21:12:00 -0500] cwj: Matthaeus: sorry but I use hosted chef, so I haven't been using couchdb for over a year now. Have you tried one of the couchdb support venues?
[2012-01-17 21:13:00 -0500] kallen: statix: yes. i'm proxying my setup thru nginx. there's a chef wiki doc on how to set up apache proxy
[2012-01-17 21:14:00 -0500] Matthaeus: cwj:  yes, and they seem to agree that it's the stack size bug, which requires a recompile of couchdb.  I'm very interested in doing this in a way that (hopefully) allows me to keep using packages for updates and such.
[2012-01-17 21:19:00 -0500] statix: kallen: thanks for the info
[2012-01-17 21:19:00 -0500] kallen: sho nuff
[2012-01-17 21:19:00 -0500] erikh: search worked great, thanks ssd7
[2012-01-17 21:20:00 -0500] btm: Matthaeus: There may not be anyone active that is familiar with that couchdb error. You could try to send an email to the mailing list. http://lists.opscode.com/sympa/info/chef
[2012-01-17 21:21:00 -0500] Matthaeus: btm: Thank you.
[2012-01-17 21:22:00 -0500] Matthaeus: I found a ppa with couchdb 1.1.1 and installed it, that fixed the issue.
[2012-01-17 21:34:00 -0500] atomic-penguin: Is it necessary to export a PATH for Omnibus to work correctly?
[2012-01-17 21:35:00 -0500] fujin: I can't imagine so, if you use the full path to the binaries it installs..
[2012-01-17 21:36:00 -0500] fujin: I do not know either way
[2012-01-17 21:36:00 -0500] fujin: 100%
[2012-01-17 21:36:00 -0500] fujin: let's check
[2012-01-17 21:37:00 -0500] btm: atomic-penguin: no, because we symlink into /usr/bin
[2012-01-17 21:37:00 -0500] btm: atomic-penguin: except on windows, where yes, and we should be modifying the path in the installer.
[2012-01-17 21:40:00 -0500] dajia: Hello, all.  Would anyone care to tackle an ohai plugin question?
[2012-01-17 21:43:00 -0500] laurent\: dajia: go on ! :-)
[2012-01-17 21:46:00 -0500] hippiehacker: anyone using windows_zipfile?
[2012-01-17 21:46:00 -0500] hippiehacker: the resource is running, and takes the right amount of time for the zipfile, but I see nothing in the target dir
[2012-01-17 21:55:00 -0500] dajia: Okay, here's my situation:  I have a custom ohai plugin in /etc/ohai/plugins.  I have added Ohai::Config[:plugin_path] << '/etc/ohai/plugins' to my /etc/chef/client.rb.  HOWEVER, Ohai refuses to pick up the plugin during a run.
[2012-01-17 21:56:00 -0500] dajia: It won't even pick it up when I run ohai -d /etc/ohai/plugins
[2012-01-17 21:56:00 -0500] dajia: However, if I move the plugin into /opt/opscode/embedded/lib/ruby/gems/1.9.1/gems/ohai-0.6.10/lib/ohai/plugins/ it will be used.
[2012-01-17 21:56:00 -0500] dajia: I need this to work from my own plugins dir.
[2012-01-17 22:02:00 -0500] hbarnes: dajia - are you using the ohai cookbook to deploy your custom plugin?
[2012-01-17 22:05:00 -0500] dajia: Ultimately, yes, but right now I just put it on the node I'm testing it on.
[2012-01-17 22:06:00 -0500] hbarnes: I see. So I never tried to do it by hand. I just installed mine in the ohai plugin dir and ran the recipe and it worked. I think it even updates client.rb for you.
[2012-01-17 22:08:00 -0500] dajia: Hmm...according to the WIki page here: http://wiki.opscode.com/display/chef/Loading+Custom+Ohai+Plugins it should work...
[2012-01-17 22:09:00 -0500] dajia: ...and it doesn't.  I believe this chef node was bootstrapped using the omnibus package.
[2012-01-17 22:11:00 -0500] hbarnes: Hmm.
[2012-01-17 22:12:00 -0500] hbarnes: When you move it to to the gem lib path, and do ohai -d /path/foo do you see the output you are looking for?
[2012-01-17 22:12:00 -0500] hbarnes: (I only ask because I fought with one for days only to realize I had a bug in my plugin.)
[2012-01-17 22:13:00 -0500] dajia: When I move it to the gem directory, I see it with or without the -d /etc/ohai/plugins.
[2012-01-17 22:14:00 -0500] hbarnes: I got nothin'. Sorry. :-) Thought I might be able to help.
[2012-01-17 22:16:00 -0500] dajia: Ohai is a pain in the ass in this regard.  For the most part, I like chef, but I could've written 10 custom facts in Puppet in the time I've been fighting to get this one attribute to be picked up by ohai.
[2012-01-17 22:19:00 -0500] hbarnes: I eventually solved mine just by adding -l debug to ohai and seeing what was going on. Don't know why I didn't think about that sooner.
[2012-01-17 22:20:00 -0500] dajia: Did that.  Not seeing much helpful.  If the plugin is not in the gem dir, it just doesn't show up in the debug output.
[2012-01-17 22:27:00 -0500] btm: dajia: what does your plugin look like? got a pastebin or gist of it?
[2012-01-17 22:29:00 -0500] dajia: I'll whip up a gist
[2012-01-17 22:30:00 -0500] dajia: https://gist.github.com/1629418
[2012-01-17 22:43:00 -0500] hbarnes: dajia - in /etc/ohai/plugins ... what's the file name? jre_version.rb?
[2012-01-17 22:43:00 -0500] dajia: Yes.
[2012-01-17 22:43:00 -0500] btm: dajia: seemed to work for me on 0.10.6. https://gist.github.com/aea6aa9a9b9fdd9ddccb
[2012-01-17 22:44:00 -0500] hbarnes: yeah, I was about to say that it works for me too.
[2012-01-17 22:44:00 -0500] hbarnes: Not that it is much consolation.
[2012-01-17 22:44:00 -0500] hbarnes: Side note: I do NOT have the omnibus installed
[2012-01-17 22:45:00 -0500] dajia: Okay, so maybe it is an omnibus thing?
[2012-01-17 22:46:00 -0500] spicyWith: when working with chef and vagrant, how do you specify what type of node one is going to be? Do I have to create client keys for each VM I'm spinning up?
[2012-01-17 22:51:00 -0500] dajia: Okay, I"m going to go do some more work on this assuming it's an omnibus thing.  Thanks, everyone.
[2012-01-17 22:51:00 -0500] spicyWith: actually to refine the question a bit more, do I need to create one client per node, i.e. for every vagrant VM that I spin up? What's the difference between that and the validation key?
[2012-01-17 22:52:00 -0500] hbarnes: spicyWith - I think technically, you can have a client key represent more than one node, but I don't think it's common. The validation key is what allows the chef-client to auto-create a node/client for you on boot/provisioning.
[2012-01-17 22:52:00 -0500] jtimberman: spicyWith: you use the validation key to do that.
[2012-01-17 22:53:00 -0500] jtimberman: spicyWith: and configure where the file lives in your Vagrantfile
[2012-01-17 22:53:00 -0500] jtimberman: e.g., chef.validation_key_path = ".chef/validator.pem"
[2012-01-17 22:54:00 -0500] jtimberman: (asssuming your Vagrantfile is in the chef-repo where the .chef dir is)
[2012-01-17 22:55:00 -0500] hbarnes: spicyWith - Not sure if it will help, but here's my Vagrantfile: https://gist.github.com/1629602 I just let the provisioning process auto-create my node/client. (I do have to delete my node/client every time I do a boot of my instance, however)
[2012-01-17 22:56:00 -0500] spicyWith: hbarnes: thanks, lemme take a look at this
[2012-01-17 22:57:00 -0500] spicyWith: jtimberman: per these instructions I don't think I ever copied a validation.pem to my laptop. Should I have done that? http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages
[2012-01-17 22:59:00 -0500] jtimberman: yes
[2012-01-17 23:09:00 -0500] btm: dajia: worked fine for me using omnibus on ubuntu 10.10 and 11.10. https://gist.github.com/aea6aa9a9b9fdd9ddccb
[2012-01-17 23:09:00 -0500] btm: dajia: any chance you've got "/etc/chef/plugins" in the client.rb and the files are in /etc/ohai/plugins?
[2012-01-17 23:09:00 -0500] spicyWith: jtimberman: hbarnes: thanks. How would I do this for ec2 nodes?
[2012-01-17 23:10:00 -0500] jbz: spicyWith: If you use knife bootstrap, it will place the validation.pem on the nodes.
[2012-01-17 23:10:00 -0500] jbz: spicyWith: (or knife ec2 server create, which calls bootstrap).
[2012-01-17 23:10:00 -0500] jtimberman: spicyWith: knife will automatically select the validation key file from your chef-repo assuming it is all correctly configured.
[2012-01-17 23:10:00 -0500] jtimberman: configuration?
[2012-01-17 23:10:00 -0500] bawt: configuration is http://wiki.opscode.com/display/chef/Chef+Configuration+Settings
[2012-01-17 23:11:00 -0500] spicyWith: jbz: jtimberman thanks
[2012-01-17 23:11:00 -0500] btm: dajia: 'ohai -d' seems to work okay, but it appears to be annoying about a trailing slash: https://gist.github.com/aea6aa9a9b9fdd9ddccb#file_a_ohai
[2012-01-17 23:16:00 -0500] btm: dajia: looks like the 'ohai -d' trailing slash issue is a known bug: http://tickets.opscode.com/browse/OHAI-126
[2012-01-17 23:20:00 -0500] spicyWith: hbarnes: thanks for that Vagrantfile. How do you define more than one node, say you have a web1dev (web server) and db1dev that I want to create with vagrant. http://dpaste.com/689362/ - I'm noob to all of this :-/
[2012-01-17 23:21:00 -0500] spicyWith: <---- wrong face, btw
[2012-01-17 23:21:00 -0500] hbarnes: Well, you could change the node name to be an environment variable and just set the environment variable before you ran 'vagrant up'
[2012-01-17 23:22:00 -0500] hbarnes: Do you want both vagrant nodes to be running at the same time?
[2012-01-17 23:23:00 -0500] hbarnes: Oh, just looked at your pastebin. I didn't even realize you could do that. :-)
[2012-01-17 23:23:00 -0500] hbarnes: Multiple vms in the same vagrantfile that is.
[2012-01-17 23:24:00 -0500] spicyWith: hbarnes: yes, ideally I'd like to have several nodes running at the same time, to test a full working system. Is the config.vm.provision block something I can put inside config.vm.define block?
[2012-01-17 23:24:00 -0500] hbarnes: To be honest, I'm not sure. I've only ever done one at time. Might be a better question for #vagrant.
[2012-01-17 23:25:00 -0500] hbarnes: But if you can boot multiple ones from the same file, I'm sure there is a way to provision each with chef.
[2012-01-17 23:27:00 -0500] hbarnes: Oh, yeah, you definitely appear to be doing it right: http://vagrantup.com/docs/multivm.html
[2012-01-17 23:27:00 -0500] hbarnes: Now, I'm curious. Let me try this out.
[2012-01-17 23:29:00 -0500] spicyWith: hbarnes: :-)
[2012-01-17 23:33:00 -0500] spicyWith: hbarnes: I think you should be able to nest that chef loop inside the define for each vm. The question is how to define what the vm should be. I guess you could specify the node name and a run_list. I wonder if jtimberman has any thoughts on what's the best way to do this.
[2012-01-17 23:33:00 -0500] hbarnes: spicyWith: yeah, i agree. I'm testing that now.
[2012-01-17 23:34:00 -0500] hbarnes: spicyWith: let me show you what i'm testing https://gist.github.com/1629785
[2012-01-17 23:35:00 -0500] hbarnes: Note that I am using the same recipies on both .. but wouldn't in real life (those are just my test roles) ... and I modified the node name with -web and -db
[2012-01-17 23:37:00 -0500] spicyWith: hbarnes: that looks good. Is it working?
[2012-01-17 23:37:00 -0500] hbarnes: so far. :-)
[2012-01-17 23:38:00 -0500] hbarnes: laptop is a little old. SSD and more RAM on order. :-)
[2012-01-17 23:39:00 -0500] chip-: Question: How are people planning to solve the Ubuntu Java problem?
[2012-01-17 23:40:00 -0500] chip-: Just switch all your recipes to openjdk?
[2012-01-17 23:40:00 -0500] chip-: Has someone written a workaround to pull straight from Oracle instead?
[2012-01-17 23:40:00 -0500] chip-: Figured I'd ask before re-inventing a wheel.
[2012-01-17 23:42:00 -0500] spicyWith: hbarnes: how does the chef server determine what the client should run, via the run_list or client name?
[2012-01-17 23:42:00 -0500] hbarnes: spicyWith: the run list
[2012-01-17 23:42:00 -0500] hbarnes: spicyWith: it will execute them in order you put them in the list.
[2012-01-17 23:43:00 -0500] spicyWith: hbarnes: what if there is no run list, i.e. it seems repetitive to specify that there and as a node in the chef repo
[2012-01-17 23:44:00 -0500] hbarnes: spicyWith: no run_list means it won't do anything. Do you mean the node name should be tied to a run_list? I'm not sure the reasoning, exactly. But you can add/remove recipes at any time.
[2012-01-17 23:45:00 -0500] hbarnes: spicyWith: that last multi-vm vagrant file seems to work fine. both were booted and provisioned.
[2012-01-17 23:45:00 -0500] dajia: btm:  No, there is no chance I have the path wrong.
[2012-01-17 23:47:00 -0500] dajia: I do see the trailing slash thing, now.
[2012-01-17 23:48:00 -0500] dajia: I don't know why it's not working on this node.  If it's not an omnimus thing, I don't know what it is.  I'm on Oracle Enterprise Linux.
[2012-01-17 23:49:00 -0500] spicyWith: hbarnes: I haven't gotten far enough using chef, so perhaps I'm confused. I thought a node was defined by a series of roles and recipes that were installed in it, and that this was defined inside the chef-repo structure as a .rb file. Trying to look up the reference for this.
[2012-01-17 23:49:00 -0500] dajia: I have my providers for Packages and Services explicitly set to the Red Hat providers, and other than that, it works fine on that platform.  But not in this case.
[2012-01-17 23:52:00 -0500] hbarnes: spicyWith: I think from a logical sense a node is just a run_list and attributes. From a physical sense it is a running instance of the OS. I think it's basically just a basket that you drop cookbooks (through the run_list) or properties (through ohai and/or cookbook attributes)
[2012-01-17 23:52:00 -0500] dajia: btm:  Thanks for looking into that.  I have to run.  If you think of anything else, I'll try to be back online tomorrow.
[2012-01-17 23:56:00 -0500] spicyWith: hbarnes: I think I was confused since I had first started using little chef, where nodes are defined as .json files
[2012-01-17 23:57:00 -0500] hbarnes: spicyWith: ahh, gotcha. Yeah, in that sense, I could see how a node would all be "one thing".
[2012-01-17 23:57:00 -0500] hbarnes: spicyWith: Anyway. gotta run. Thanks for making me learn something new. :-)
[2012-01-17 23:57:00 -0500] spicyWith: hbarnes: pleasure
