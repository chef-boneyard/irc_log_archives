[2012-01-27 08:57:00 -0500] mattrobenolt: Would there be any reason why not all of the files in my files directory of a cookbook don't get uploaded?
[2012-01-27 08:57:00 -0500] mattrobenolt: Sorry, that sentence was really awkward. :(
[2012-01-27 08:57:00 -0500] nacer: ohai
[2012-01-27 08:57:00 -0500] nacer: mattrobenolt: yeah if the file too big
[2012-01-27 08:58:00 -0500] fujin: too mother fuckin big dawg
[2012-01-27 08:58:00 -0500] fujin: gotta cut that shit down a little bit
[2012-01-27 08:58:00 -0500] mattrobenolt: nacer: What would be "too big"?
[2012-01-27 08:58:00 -0500] nacer: mattrobenolt: or if the file already exist on your account
[2012-01-27 08:58:00 -0500] nacer: mattrobenolt: i think there is a limit a 15M
[2012-01-27 08:58:00 -0500] nacer: mattrobenolt: not sure
[2012-01-27 08:58:00 -0500] mattrobenolt: Oh, I'm nowhere near 15M.
[2012-01-27 08:59:00 -0500] nacer: mattrobenolt: run your knife cookbook upload on verbose
[2012-01-27 08:59:00 -0500] mattrobenolt: I'm writing a recipe for our Jenkins deployment, and I'm shoving all of our jobs and plugins and config files into /files/default/*
[2012-01-27 08:59:00 -0500] mattrobenolt: But like, some of the xml configs aren't getting added.
[2012-01-27 08:59:00 -0500] mattrobenolt: And random missing directories.
[2012-01-27 09:00:00 -0500] nacer: mattrobenolt: weird can you share your error
[2012-01-27 09:00:00 -0500] nacer: ?
[2012-01-27 09:00:00 -0500] mattrobenolt: There isn't any error.
[2012-01-27 09:00:00 -0500] mattrobenolt: Shit is just missing in the OpsCode panel, and when it moves them to the new provisioned box.
[2012-01-27 09:01:00 -0500] mattrobenolt: And also this is fucked: https://gist.github.com/1a78fde4996f20368910
[2012-01-27 09:01:00 -0500] mattrobenolt: For some reason, some directories, again, randomly, are owned by root:root
[2012-01-27 09:01:00 -0500] mattrobenolt: I'm having a bad night, haha
[2012-01-27 09:02:00 -0500] nacer: ok and all your #{dir} are in files/default ?
[2012-01-27 09:02:00 -0500] mattrobenolt: Yep.
[2012-01-27 09:02:00 -0500] nacer: mattrobenolt: what version of chef do you use ?
[2012-01-27 09:02:00 -0500] mattrobenolt: 0.10
[2012-01-27 09:03:00 -0500] nacer: 0.10.?
[2012-01-27 09:03:00 -0500] mattrobenolt: 0.10.8
[2012-01-27 09:03:00 -0500] nacer: ok
[2012-01-27 09:05:00 -0500] nacer: and finaly what do you have in /var/lib/jenkins ?
[2012-01-27 09:05:00 -0500] mattrobenolt: http://i.imgur.com/PkDAA.jpg
[2012-01-27 09:05:00 -0500] mattrobenolt: That's my file structure.
[2012-01-27 09:06:00 -0500] nacer: look good
[2012-01-27 09:06:00 -0500] mattrobenolt: https://gist.github.com/1f91c8197f689a346d39
[2012-01-27 09:07:00 -0500] mattrobenolt: Listing of /var/lib/jenkins
[2012-01-27 09:07:00 -0500] nacer: look good you have jobs and plugins
[2012-01-27 09:08:00 -0500] mattrobenolt: Right. One second.
[2012-01-27 09:08:00 -0500] nacer: you want all the xml file in files/default/* too ?
[2012-01-27 09:09:00 -0500] mattrobenolt: Yeah, but I have problems before that.
[2012-01-27 09:09:00 -0500] mattrobenolt: https://gist.github.com/1f91c8197f689a346d39
[2012-01-27 09:09:00 -0500] mattrobenolt: That's the listing inside ~/jobs
[2012-01-27 09:09:00 -0500] mattrobenolt: Some directories are owned by root:root
[2012-01-27 09:09:00 -0500] mattrobenolt: Why the fuck would that happen?
[2012-01-27 09:11:00 -0500] mattrobenolt: Ideally, I want everything inside files/default to mirror over into /var/lib/jenkins, all owned by jenkins:nobody
[2012-01-27 09:12:00 -0500] mattrobenolt: And inside those specific jobs folders, some of the subfolders are missing. Every job has a "builds" and "workspace" directory. Some are missing "builds" and others are missing "workspace".
[2012-01-27 09:13:00 -0500] mattrobenolt: Oh fuck, do you need a file inside a directory for it to be transferred? It doesn't look like it'll transfer over an empty directory.
[2012-01-27 09:13:00 -0500] fujin: dunno
[2012-01-27 09:13:00 -0500] fujin: let me read what you are actually saying
[2012-01-27 09:14:00 -0500] fujin: can you try to listen to this song
[2012-01-27 09:14:00 -0500] fujin: while I'm doin diagnostics? http://soundcloud.com/playmerecords/jantsen-dirt-monkey-ziggy-play
[2012-01-27 09:14:00 -0500] fujin: mattrobenolt: yo bro have you seen pennyworth?:
[2012-01-27 09:14:00 -0500] fujin: I built it. It's jenkins + gangster shit
[2012-01-27 09:15:00 -0500] fujin: pennyworth?
[2012-01-27 09:15:00 -0500] bawt: pennyworth is https://github.com/heavywater/pennyworth
[2012-01-27 09:15:00 -0500] fujin: data bags to kick your shit
[2012-01-27 09:15:00 -0500] fujin: all the rest drop and go
[2012-01-27 09:15:00 -0500] fujin: you don't gotta listen to that song if you check my shit
[2012-01-27 09:15:00 -0500] fujin: i spent months doing your job for you
[2012-01-27 09:16:00 -0500] fujin: it's good though, i promise
[2012-01-27 09:16:00 -0500] fujin: dirt monkey makes hella funky moombahton / moombahcore beats
[2012-01-27 09:16:00 -0500] fujin: when i listen to the song my brain turns off
[2012-01-27 09:16:00 -0500] fujin: and i just start dancing
[2012-01-27 09:16:00 -0500] mattrobenolt: I have not seen Pennyworth.
[2012-01-27 09:16:00 -0500] fujin: seen, rastaman; now you have
[2012-01-27 09:16:00 -0500] fujin: http://junglist.gen.nz/blog/2011/11/16/pennyworth-quick-start/
[2012-01-27 09:18:00 -0500] mattrobenolt: That looks interesting.
[2012-01-27 09:22:00 -0500] fujin: works aight for me
[2012-01-27 09:22:00 -0500] fujin: can you dig it?
[2012-01-27 09:23:00 -0500] fujin: I rather like the idea of alfred pennyworth
[2012-01-27 09:23:00 -0500] fujin: he's a splendid chap
[2012-01-27 09:23:00 -0500] fujin: always all "let me help you with that master"
[2012-01-27 09:24:00 -0500] mattrobenolt: Did it keep the right permissions for you?
[2012-01-27 09:24:00 -0500] fujin: where did you get this splendid polycarbonate body armor? no matter. here's a cup of tea
[2012-01-27 09:24:00 -0500] fujin: I built and designed pennyworth; I wrote the blog post you are reading. I alone am responsible for any bugs you may encounter, they are my responsibility alone.
[2012-01-27 09:25:00 -0500] fujin: many other seek to assist my cause by providing assistance through Github Issues and Pull Request systems
[2012-01-27 09:25:00 -0500] mattrobenolt: Well I'm not using Pennyworth.
[2012-01-27 09:25:00 -0500] fujin: Which jenkins cookbook are you using?
[2012-01-27 09:26:00 -0500] mattrobenolt: I rolled my own for the base of Jenkins. Just installing the Jenkins package.
[2012-01-27 09:26:00 -0500] mattrobenolt: Which is fine. I'm writing my own now to populate it with our project jobs and plugins.
[2012-01-27 09:26:00 -0500] BryanWB: mattrobenolt: rolled your own? how do u install the container? tomcat/jetty? and java?
[2012-01-27 09:26:00 -0500] mattrobenolt: Jenkins installs and gets up and running.
[2012-01-27 09:27:00 -0500] mattrobenolt: aptitude install jenkins get it all.
[2012-01-27 09:27:00 -0500] mattrobenolt: From their repo.
[2012-01-27 09:27:00 -0500] fujin: It' just a .war, really trivial to run.
[2012-01-27 09:27:00 -0500] fujin: Getting to to do anything useful is the kicker.
[2012-01-27 09:27:00 -0500] mattrobenolt: Yep.
[2012-01-27 09:27:00 -0500] fujin: And by kicker, I mean "I've already done your job for you!"
[2012-01-27 09:27:00 -0500] mattrobenolt: Well, we have the jobs written and set up, blah blah blah.
[2012-01-27 09:27:00 -0500] mattrobenolt: I just want Chef to transfer our jobs and plugins since Jenkins is self enclosed in /var/lib/jenkins. Nothing else.
[2012-01-27 09:28:00 -0500] fujin: splendid, isn't it? even the most boneheaded developers can be convinced to add a Makefile that runs tests and compiles the application.
[2012-01-27 09:28:00 -0500] mattrobenolt: BryanWB: http://pkg.jenkins-ci.org/debian/
[2012-01-27 09:28:00 -0500] mattrobenolt: Yep. And we have Jenkins auto deploying to our staging servers with every successful build, and we have a "promote" job to package up .deb files and push to production.
[2012-01-27 09:29:00 -0500] BryanWB: nice, sadly my shop is entirely centos
[2012-01-27 09:29:00 -0500] fujin: ka-nice
[2012-01-27 09:29:00 -0500] mattrobenolt: BryanWB: There's a package for that too.
[2012-01-27 09:29:00 -0500] fujin: the entire idea behind pennyworth is "make .deb, make it available to your nodes"
[2012-01-27 09:29:00 -0500] BryanWB: nice, they also provide rpms
[2012-01-27 09:29:00 -0500] mattrobenolt: http://pkg.jenkins-ci.org/redhat/
[2012-01-27 09:29:00 -0500] fujin: I'd hoped to eventually bolt it into my Pylon command&control substrate layer.
[2012-01-27 09:29:00 -0500] fujin: pylon?
[2012-01-27 09:29:00 -0500] mattrobenolt: fujin: That's basically what we're doing now.
[2012-01-27 09:29:00 -0500] bawt: pylon is Built With Vagrant
[2012-01-27 09:29:00 -0500] fujin: but, well, that's a while off
[2012-01-27 09:30:00 -0500] fujin: Nice. There aren't many open source solutions in the space.
[2012-01-27 09:30:00 -0500] fujin: I'd love to see what you/yourco produces
[2012-01-27 09:30:00 -0500] mattrobenolt: I'm just now digging into Jenkins and trying to figure out what's going on.
[2012-01-27 09:30:00 -0500] mattrobenolt: Do you know Chris Lea?
[2012-01-27 09:30:00 -0500] fujin: I do not.
[2012-01-27 09:31:00 -0500] mattrobenolt: He's got a bunch of shit on his LaunchPad that everyone uses and works at (mt).
[2012-01-27 09:31:00 -0500] fujin: I can't expess that I have any involvement in the Jenkins community, itself
[2012-01-27 09:31:00 -0500] mattrobenolt: He got us set up with this system, and now we're trying to figure out what's going on, haha
[2012-01-27 09:31:00 -0500] fujin: I built automation around a tool
[2012-01-27 09:31:00 -0500] mattrobenolt: Nah, he's not in the Jenkins community.
[2012-01-27 09:31:00 -0500] mattrobenolt: He just uses it and recommended it to us.
[2012-01-27 09:32:00 -0500] fujin: Many, many tools, have much less optimal interfaces than Jenkins
[2012-01-27 09:32:00 -0500] fujin: I've automated them just  the same
[2012-01-27 09:32:00 -0500] mattrobenolt: We're in the process of building our entire infrastructure into Chef and get deployed on AWS.
[2012-01-27 09:32:00 -0500] mattrobenolt: I like Jenkins so far.
[2012-01-27 09:32:00 -0500] fujin: I can highly recommend Jenkins for such an artifact-production case
[2012-01-27 09:32:00 -0500] fujin: although, I have chef itself deploy said artifacts
[2012-01-27 09:33:00 -0500] fujin: installed into a chef-deployed artifact repoistory (reprepro)
[2012-01-27 09:33:00 -0500] BryanWB: mattrobenolt: check out the java_ark lwrp https://github.com/bryanwb/cookbooks/tree/master/java  , it may be useful to u
[2012-01-27 09:33:00 -0500] mattrobenolt: BryanWB: In what regard?
[2012-01-27 09:34:00 -0500] BryanWB: use newer jdk
[2012-01-27 09:34:00 -0500] BryanWB: like update 30
[2012-01-27 09:34:00 -0500] BryanWB: or use oracle's jdk
[2012-01-27 09:34:00 -0500] mattrobenolt: ?
[2012-01-27 09:34:00 -0500] mattrobenolt: That has absolutely nothing to do with my problem, haha
[2012-01-27 09:35:00 -0500] BryanWB: yeah, nothing to do w/ your problem  but does have to do w/ running java application stack
[2012-01-27 09:35:00 -0500] mattrobenolt: I have 0 issues with that.
[2012-01-27 09:35:00 -0500] mattrobenolt: Jenkins just does all that and fires up on port 8080.
[2012-01-27 09:35:00 -0500] mattrobenolt: Slap nginx in front of it to act as a proxy for 80 and you're good to go.
[2012-01-27 09:35:00 -0500] mattrobenolt: It runs as a service and all.
[2012-01-27 09:39:00 -0500] mattrobenolt: Ok, so Chef definitely needs a file inside a directory for it to upload the directory.
[2012-01-27 09:39:00 -0500] fujin: true bro
[2012-01-27 09:39:00 -0500] fujin: i am too drunk to ead the backlog
[2012-01-27 09:39:00 -0500] mattrobenolt: That explains my missing directories.
[2012-01-27 09:39:00 -0500] fujin: give me a minute
[2012-01-27 09:39:00 -0500] mattrobenolt: Now why the fuck are my permissions wrong?
[2012-01-27 09:40:00 -0500] fujin: you are prob managin them wrong
[2012-01-27 09:40:00 -0500] fujin: still reading
[2012-01-27 09:40:00 -0500] fujin: WHERES THE ERRROR I CANT FIND IT
[2012-01-27 09:40:00 -0500] mattrobenolt: This is all I'm doing: https://gist.github.com/1a78fde4996f20368910
[2012-01-27 09:40:00 -0500] fujin: k
[2012-01-27 09:40:00 -0500] fujin: reading
[2012-01-27 09:41:00 -0500] mattrobenolt: And this is the permissions inside /var/lib/jenkins/plugins: https://gist.github.com/1f91c8197f689a346d39
[2012-01-27 09:41:00 -0500] mattrobenolt: Some are owned by root:root.
[2012-01-27 09:41:00 -0500] fujin: would ou possibly you mind posting the debug logs when the chef run fatally exits wiht an error?
[2012-01-27 09:41:00 -0500] mattrobenolt: It doesn't error out. Just the directories have the wrong permissions after it finishes.
[2012-01-27 09:42:00 -0500] fujin: says who
[2012-01-27 09:42:00 -0500] mattrobenolt: says `ls -la`
[2012-01-27 09:42:00 -0500] fujin: na
[2012-01-27 09:42:00 -0500] fujin: what chu talkin bout willis
[2012-01-27 09:42:00 -0500] fujin: you manage the file. you make them wrong
[2012-01-27 09:42:00 -0500] mattrobenolt: Those directories should all be owned by jenkins:nogroup
[2012-01-27 09:42:00 -0500] mattrobenolt: Not root:root
[2012-01-27 09:43:00 -0500] fujin: hmm
[2012-01-27 09:43:00 -0500] mattrobenolt: Then where am I fucking that up to cause some of them to be right, and some to be wrong?
[2012-01-27 09:43:00 -0500] fujin: perhaps those files are included with the package, or something dumb?
[2012-01-27 09:43:00 -0500] mattrobenolt: All of the sub directories inside those are correct.
[2012-01-27 09:43:00 -0500] fujin: I personally wouldn't chuck all of the direoctires in my cookbook
[2012-01-27 09:43:00 -0500] fujin: well, I could go into what *I* do but it don't really matter do it
[2012-01-27 09:43:00 -0500] mattrobenolt: Nope. The jobs directory is empty before uploading these.
[2012-01-27 09:43:00 -0500] mattrobenolt: What would you recommend?
[2012-01-27 09:44:00 -0500] fujin: i showed you my blog post and my repo
[2012-01-27 09:44:00 -0500] fujin: in that blog post i use the Jenkins cookbook
[2012-01-27 09:44:00 -0500] fujin: written by Dough McShananana from Vmware
[2012-01-27 09:44:00 -0500] fujin: Fletcher Nichol forked it.
[2012-01-27 09:44:00 -0500] fujin: I modded it so that apache fronted it with a htpasswd.
[2012-01-27 09:44:00 -0500] fujin: It just works.
[2012-01-27 09:44:00 -0500] fujin: jenkins_job("foo") { do some shit }
[2012-01-27 09:45:00 -0500] fujin: get money, whatever
[2012-01-27 09:45:00 -0500] mattrobenolt: Yeah, Jenkins is all up and fine and working. I just need to get our jobs into it.
[2012-01-27 09:45:00 -0500] mattrobenolt: So I have a cookbook just for adding our jobs.
[2012-01-27 09:45:00 -0500] fujin: use the jenkins_job lwrp
[2012-01-27 09:45:00 -0500] fujin: actually
[2012-01-27 09:45:00 -0500] fujin: i'm lyin right now
[2012-01-27 09:45:00 -0500] fujin: do whatever the fuck my shit does cause i know it works
[2012-01-27 09:46:00 -0500] fujin: to do a jenkins_job
[2012-01-27 09:46:00 -0500] fujin: yhou gotta drop atemplate
[2012-01-27 09:46:00 -0500] fujin: https://github.com/heavywater/chef-pennyworth/blob/develop/recipes/default.rb#L66-121
[2012-01-27 09:46:00 -0500] fujin: https://github.com/fnichol/chef-jenkins/blob/master/providers/job.rb
[2012-01-27 09:46:00 -0500] mattrobenolt: Yeah, I could do that.
[2012-01-27 09:46:00 -0500] fujin: that is the job provider i use
[2012-01-27 09:47:00 -0500] mattrobenolt: Ok, taht actually makes sense.
[2012-01-27 09:47:00 -0500] fujin: so lemme give you a proposition. a) you could test some shit someone else has already written and modify it b) you could keep bumbling along writing your own shit tryin to get a drunk guy to help you
[2012-01-27 09:47:00 -0500] fujin: its the evening, so its ok to do drugs
[2012-01-27 09:48:00 -0500] fujin: pick an option. lets do it
[2012-01-27 09:48:00 -0500] fujin: i will help you either way
[2012-01-27 09:48:00 -0500] fujin: whichever one you pick
[2012-01-27 09:48:00 -0500] fujin: for the rest of the night until i fall asleep
[2012-01-27 09:48:00 -0500] fujin: is your last name french?
[2012-01-27 09:48:00 -0500] mattrobenolt: Quickest way to get up and running with pennyworth. Go.
[2012-01-27 09:48:00 -0500] mattrobenolt: My last name is German.
[2012-01-27 09:50:00 -0500] fujin: https://github.com/heavywater/pennyworth/blob/develop/readme.org
[2012-01-27 09:50:00 -0500] fujin: if you want me to the copy paste the commands from the dang readme
[2012-01-27 09:50:00 -0500] fujin: well
[2012-01-27 09:50:00 -0500] fujin: i aint doin that
[2012-01-27 09:51:00 -0500] fujin: you can pay me to copy paste
[2012-01-27 09:51:00 -0500] fujin: you dig?
[2012-01-27 09:51:00 -0500] BryanWB: fujin, u r the devops pimp ;)
[2012-01-27 09:52:00 -0500] fujin: i am getting on a plane
[2012-01-27 09:52:00 -0500] fujin: can you imagine b.a.baracus
[2012-01-27 09:53:00 -0500] fujin: saying
[2012-01-27 09:53:00 -0500] fujin: i am getting on a plane?
[2012-01-27 09:53:00 -0500] fujin: with a polite accent
[2012-01-27 09:53:00 -0500] fujin: Oh, hello, I'm getting on a plane.
[2012-01-27 09:54:00 -0500] fujin: It's got bundler. It's got Librarian. I fielded pull requested from people sayin it was hard to kick it.
[2012-01-27 09:54:00 -0500] fujin: Bundle, Librariate, get it cracking
[2012-01-27 09:54:00 -0500] fujin: Read the damn code and run it in the intended fashion for all I give a fuck - honestly. Use it if you *can*
[2012-01-27 09:57:00 -0500] fujin: you know what?
[2012-01-27 09:58:00 -0500] fujin: I thought the fucking cool batman quote would get people to use it
[2012-01-27 09:58:00 -0500] fujin: but people just ignore it?
[2012-01-27 09:58:00 -0500] fujin: y'all never seen the mother fucking dark night, with morgan freeman?
[2012-01-27 09:58:00 -0500] fujin: that dude is all, yo man I will get you what you need
[2012-01-27 09:58:00 -0500] fujin: get some of this and that
[2012-01-27 09:58:00 -0500] fujin: jump a mother fucking jet car across a bridge
[2012-01-27 09:58:00 -0500] fujin: yadiddii
[2012-01-27 09:58:00 -0500] fujin: yadididaaa
[2012-01-27 09:59:00 -0500] fujin: get a sack of yurple while you cross the way
[2012-01-27 09:59:00 -0500] fujin: y'all don't even know what it is.
[2012-01-27 09:59:00 -0500] fujin: i'ma start kicking it in #puppet makin them feel insignificant
[2012-01-27 09:59:00 -0500] mattrobenolt: hahahaha
[2012-01-27 09:59:00 -0500] fujin: man i wish you could delete stuff on irc
[2012-01-27 09:59:00 -0500] fujin: that last one was no good
[2012-01-27 10:00:00 -0500] fujin: mattrobenolt: seriously though bro, if you use pennyworth and take a minute to file a fault with anything you encounter, i will fix it
[2012-01-27 10:00:00 -0500] mattrobenolt: fujin: Last question because I know nothing about Ruby, how can I just move everything in files/default to my directory? Instead of just those two filders.
[2012-01-27 10:00:00 -0500] fujin: man  a remote_directory should do it
[2012-01-27 10:01:00 -0500] fujin: if it don't, file a bug repoirt
[2012-01-27 10:01:00 -0500] fujin: cause I rely on that dang behavior you are describin
[2012-01-27 10:01:00 -0500] fujin: ship a whole motherfuckin grip of whatever to a dang place
[2012-01-27 10:01:00 -0500] fujin: get some of that shit in your config files
[2012-01-27 10:01:00 -0500] fujin: load up processes
[2012-01-27 10:01:00 -0500] fujin: see what is going on
[2012-01-27 10:01:00 -0500] fujin: you know what i am talkin about man?
[2012-01-27 10:01:00 -0500] mattrobenolt: https://gist.github.com/cf5e91de6af9ed487204
[2012-01-27 10:01:00 -0500] mattrobenolt: That did not get it.
[2012-01-27 10:02:00 -0500] mattrobenolt: I guess I don't know how to specify the source. I want everything.
[2012-01-27 10:02:00 -0500] fujin: would you possibly mind adding the chef-client -l debug output to that gist, in another file, for complete context
[2012-01-27 10:02:00 -0500] fujin: and/or remove the entire target directory, then run chef, with debug then post that to the gist too
[2012-01-27 10:02:00 -0500] fujin: and then file a ticket
[2012-01-27 10:02:00 -0500] fujin: tickets?
[2012-01-27 10:02:00 -0500] bawt: tickets is https://tickets.opscode.com/secure/Dashboard.jspa
[2012-01-27 10:02:00 -0500] fujin: contributing?
[2012-01-27 10:02:00 -0500] bawt: contributing is http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-01-27 10:03:00 -0500] mattrobenolt: Hold on, running the fucking Jenkins recipe takes like, 10 minutes to install all the fucking dependencies.
[2012-01-27 10:03:00 -0500] bawt: contributing = money
[2012-01-27 10:05:00 -0500] fujin: Without really seeing the exact error messages from Jenkins, I can only guess to the problems you are having
[2012-01-27 10:05:00 -0500] fujin: hey, I heard about this new continuous deployment framework called pennyworth where you basically just add data bags and then you are golden, have you heard of it?
[2012-01-27 10:06:00 -0500] mattrobenolt: I'm trying to learn Chef with this too. So either way, I know nothing about Chef at this point.
[2012-01-27 10:06:00 -0500] fujin: word, so
[2012-01-27 10:06:00 -0500] mattrobenolt: [default] [Fri, 27 Jan 2012 02:05:01 -0800] FATAL: Chef::Exceptions::FileNotFound: remote_directory[/var/lib/jenkins] (sprintly_jenkins::default line 19) had an error: cookbook sprintly_jenkins has no directory files/
[2012-01-27 10:06:00 -0500] fujin: if you don't show me the full debug strack traces (not just the fist line)
[2012-01-27 10:06:00 -0500] fujin: I can't really tell you waht is going on
[2012-01-27 10:07:00 -0500] fujin: I can't even c ompare that stack trace to a logical flow of code on a local copy.
[2012-01-27 10:07:00 -0500] fujin: soo.. basically
[2012-01-27 10:07:00 -0500] fujin: wow wait
[2012-01-27 10:07:00 -0500] fujin: you work at sprintly?
[2012-01-27 10:07:00 -0500] mattrobenolt: Yeah.
[2012-01-27 10:07:00 -0500] fujin: I have been evaluating the kanboard board services for one of our stealth projects. I really like the UX so far
[2012-01-27 10:08:00 -0500] fujin: You just gained my help.
[2012-01-27 10:08:00 -0500] mattrobenolt: hahaha
[2012-01-27 10:08:00 -0500] mattrobenolt: Thanks. ;)
[2012-01-27 10:08:00 -0500] fujin: Please, if you wouldn't mind, post the chef-solo or chef-client '-l debug' output
[2012-01-27 10:08:00 -0500] mattrobenolt: I added the entire stack trace: https://gist.github.com/cf5e91de6af9ed487204
[2012-01-27 10:08:00 -0500] fujin: to a Gist or equivalent service of your preference
[2012-01-27 10:08:00 -0500] fujin: Thanks! one sec.
[2012-01-27 10:08:00 -0500] mattrobenolt: How can I do the debug through vagrant?
[2012-01-27 10:08:00 -0500] fujin: Nay, the stack trace is below that, anyway, I don't think it will be much help
[2012-01-27 10:09:00 -0500] lflux_: what is sprintly i don't even
[2012-01-27 10:09:00 -0500] fujin: are you using the chef-client or chef-solo model for vagrant?
[2012-01-27 10:09:00 -0500] fujin: lflux_: try to keep up bro
[2012-01-27 10:09:00 -0500] mattrobenolt: Chef client. We have hosted chef.
[2012-01-27 10:09:00 -0500] fujin: http://sprint.ly
[2012-01-27 10:09:00 -0500] fujin: aight sec
[2012-01-27 10:10:00 -0500] fujin: mattrobenolt: so what you can do man is 'knife cookbook show sprintly_jenkins' to see all the available versions
[2012-01-27 10:10:00 -0500] lflux: I have to turn off my music to realize what that is aaaargh
[2012-01-27 10:10:00 -0500] lflux: :)
[2012-01-27 10:10:00 -0500] lflux: time to get cracking at some chef recipes I guess
[2012-01-27 10:10:00 -0500] fujin: then knife cookbook show sprintly_jenkions <most recent version> files/
[2012-01-27 10:10:00 -0500] fujin: oh. without the /
[2012-01-27 10:10:00 -0500] fujin: should show you all the file sin the cookbook
[2012-01-27 10:11:00 -0500] fujin: it kind alooks like you haven't uploaded your sprintly_jenkins cookbook recently.
[2012-01-27 10:11:00 -0500] fujin: I don't have a way to verify that without your user input and correlation, would you mind?
[2012-01-27 10:11:00 -0500] mattrobenolt: Nah, they're all in there.
[2012-01-27 10:11:00 -0500] fujin: So, you're suggesting the chef-client is reacting inapppropriately to the hosted-chef platform API response to cookbook files?
[2012-01-27 10:11:00 -0500] mattrobenolt: It just doesn't like me doing: source ""
[2012-01-27 10:12:00 -0500] fujin: oh
[2012-01-27 10:12:00 -0500] mattrobenolt: If I actually put a directory in there, it works fine.
[2012-01-27 10:12:00 -0500] mattrobenolt: I don't know how to specify everything in files/default
[2012-01-27 10:12:00 -0500] fujin: pray tell, what are you expecting to happen with a source of an empty string like that?
[2012-01-27 10:12:00 -0500] mattrobenolt: Shouldn't that be appended to the full path to files/default ?
[2012-01-27 10:13:00 -0500] mattrobenolt: If I use:  source "jobs", that's going to give me:  files/default/jobs
[2012-01-27 10:13:00 -0500] mattrobenolt: So I'm trying empty string to get the top level directory.
[2012-01-27 10:13:00 -0500] fujin: I'd say that is inappropriate behavior to assume as natural.
[2012-01-27 10:13:00 -0500] fujin: personally, if I tried an empty string, I would expect failure of sorts
[2012-01-27 10:13:00 -0500] mattrobenolt: Can I do * ?
[2012-01-27 10:13:00 -0500] fujin: I don't even know what that would do
[2012-01-27 10:13:00 -0500] fujin: I'd have to look at the code for remote_directory provider
[2012-01-27 10:14:00 -0500] fujin: IN any case, I digress
[2012-01-27 10:14:00 -0500] mattrobenolt: Then hwo do you recommend me putting everything inside files/default into /var/lib/jenkins?
[2012-01-27 10:14:00 -0500] fujin: Put the files you want to ship in a folder under files/<wahtever (maybe default, ..etc)>/<some_folder>
[2012-01-27 10:14:00 -0500] mattrobenolt: I guess I could move it into another subdirectory. It just seemed like a hack.
[2012-01-27 10:14:00 -0500] mattrobenolt: Yeah.
[2012-01-27 10:14:00 -0500] fujin: No, in this case, it is not a hack. It is desired behavior.
[2012-01-27 10:14:00 -0500] mattrobenolt: It just seemed like a workaround because I didn't know what I was doing.
[2012-01-27 10:14:00 -0500] fujin: A remote directory takes a source.
[2012-01-27 10:14:00 -0500] mattrobenolt: Gotcha.
[2012-01-27 10:15:00 -0500] fujin: It cannot take an empty string to imply the default folder or some-such.
[2012-01-27 10:15:00 -0500] mattrobenolt: Good to know.
[2012-01-27 10:15:00 -0500] fujin: Perhaps a ticket should be raised to clarify the behavior for an unfortunate programmer who has omitted to read the documentation
[2012-01-27 10:15:00 -0500] mattrobenolt: Us at Sprint.ly know nothing about Ruby, haha
[2012-01-27 10:15:00 -0500] mattrobenolt: We're Python dudes.
[2012-01-27 10:18:00 -0500] mattrobenolt: Did you say that you already have a sprint.ly account?
[2012-01-27 10:20:00 -0500] fujin: lol yeh
[2012-01-27 10:20:00 -0500] fujin: i got in a few weeks ago. not really touched it, been busy
[2012-01-27 10:20:00 -0500] fujin: so many projects these days.
[2012-01-27 10:20:00 -0500] mattrobenolt: I hear ya.
[2012-01-27 10:20:00 -0500] mattrobenolt: drund.com is my other startup.
[2012-01-27 10:21:00 -0500] mattrobenolt: It's not as fun as sprint.ly
[2012-01-27 10:22:00 -0500] fujin: we had like a planning call, added a bunch of stories (great!) then all got busy with other projects
[2012-01-27 10:22:00 -0500] fujin: may be more useful in the future
[2012-01-27 10:22:00 -0500] fujin: before the robots, or whatever
[2012-01-27 10:22:00 -0500] mattrobenolt: haha
[2012-01-27 10:22:00 -0500] nicholasr-bf: Hmm.  Just had a look at Pennyworth and it looks to me as though versions in the form "0.0.0" won't be sorted properly in the knife code.
[2012-01-27 10:23:00 -0500] fujin: what'd I release with 0.0.0 ?
[2012-01-27 10:23:00 -0500] fujin: wait, which knife code?
[2012-01-27 10:23:00 -0500] fujin: in the deploy plugin?
[2012-01-27 10:25:00 -0500] nicholasr-bf: yes.  You seem to just do a sort which won't sort things properly   sort { |a,b| Gem::Version.new(a) <-> Gem::Version.new(b) } would do the trick but introduce a Gem dependency
[2012-01-27 10:25:00 -0500] nicholasr-bf: or rather a dependency on rubygems
[2012-01-27 10:26:00 -0500] fujin: where?
[2012-01-27 10:26:00 -0500] nicholasr-bf: it was in the deploy plugin..   Just nosing around as interfacing Chef and Jenkins is going to be a large part of my job.
[2012-01-27 10:27:00 -0500] nicholasr-bf: def old_version# Oldest version deployed on any nodeversions = search( :node, query).map { |node| node[app][:version] }versions.sort.firstend
[2012-01-27 10:27:00 -0500] nicholasr-bf: actually mapping to Gem::Version.new(..) would work
[2012-01-27 10:29:00 -0500] fujin: There's a version contraint system in chef that I wrote ages ago that was adapted, used for cookbook metadata I think these days
[2012-01-27 10:29:00 -0500] fujin: nicholasr-bf: unfortunately, the deploy plugin part of that I'm not really versed in, Darrin wrote it, and it was included for public release without really much testing from my part
[2012-01-27 10:30:00 -0500] fujin: I know one of our clients use(d) it happyly
[2012-01-27 10:30:00 -0500] fujin: happily even lol dang
[2012-01-27 10:31:00 -0500] fujin: nicholasr-bf: please log an issue with your concerns. we play to release the 'deploy' plugin in some form as  gem, so you can do like, 'gem install knife-pennyworth-deploy' or some-such, in the future
[2012-01-27 10:32:00 -0500] fujin: so it would be great to iron this out before then
[2012-01-27 11:57:00 -0500] chaosdonkey: Hi, if I use the meta attribute "notifies" in a template resource, what happens if the template remains the same (i.e. the generated file is the same as the existing file)?
[2012-01-27 12:23:00 -0500] yatesy: how come CHEF-1827 is resolved yet the pull request hasn't been merged into chef?
[2012-01-27 12:44:00 -0500] yfeldblum: yatesy, from the tickets.opscode.com start page, "And critically, in order for any fixes to be found by the Opscode triage team, any tickets that include fixes should have the ticket status changed to resolved, with the resolution stating "fixed"."
[2012-01-27 12:49:00 -0500] yatesy: doh why didn't i pick on that, thanks yfeldblum
[2012-01-27 12:49:00 -0500] yatesy: s/pick/pick up/
[2012-01-27 13:12:00 -0500] `brendan: good morning guys & gals
[2012-01-27 13:41:00 -0500] thom: chaosdonkey: nothing is notified
[2012-01-27 13:42:00 -0500] trigren: has anyone seen chef-client on windows not pickup any configuration settings, even with -c supplied, and pointing to a good client.rb?
[2012-01-27 13:42:00 -0500] trigren: on Windows Server 2008 R2 running from the official chef-client msi installer....
[2012-01-27 13:53:00 -0500] chaosdonkey: thom, thanks
[2012-01-27 14:18:00 -0500] crftr: Yesterday I started experimenting with chef-solo.  For my first test, I'm attempting to install the opscode recipe for nginx.
[2012-01-27 14:18:00 -0500] crftr: is anyone around to take a peek at a quick gist?
[2012-01-27 14:19:00 -0500] crftr: I think I may be missing a simple attribute.
[2012-01-27 14:20:00 -0500] crftr: https://gist.github.com/1688966
[2012-01-27 14:22:00 -0500] trigren: has anyone tried running the latest chef-client on windows server 2008r2?
[2012-01-27 14:32:00 -0500] Andorbal: I just registered for the Chef training materials hoping that it would discuss application deployment strategies, but I just noticed that it explicitly says it doesn't.
[2012-01-27 14:34:00 -0500] Andorbal: Are there any recommended resources that do discuss app deployment strategies?
[2012-01-27 14:35:00 -0500] yfeldblum: Andorbal, IMHO app deployment is really a very different beast from host provisioning & configuration
[2012-01-27 14:36:00 -0500] KarlHungus: don;'t be humble. you're right.
[2012-01-27 14:37:00 -0500] Andorbal: But the two surely have to interact, right?
[2012-01-27 14:38:00 -0500] yfeldblum: Andorbal, a simple technique to do app-provisioning with chef is to use the deploy resource, to set up a runit process monitor for your app, and to set up nginx in front ... all three of these are illustrated in opscode's "application" cookbook
[2012-01-27 14:38:00 -0500] Andorbal: I'm reading about the application cookbook now.
[2012-01-27 14:38:00 -0500] KarlHungus: sure, but deployments require orchestration, which isn't something chef does (or should do)
[2012-01-27 14:39:00 -0500] yfeldblum: Andorbal, they may have to interact; however, it remains a perfectly viable strategy to use chef to deploy and configure hosts, and to use capistrano (without chef) to provision apps
[2012-01-27 14:41:00 -0500] Andorbal: So I'm guessing that infrastructure configuration should be kept outside of the application so that it doesn't have to be done each time the app is deployed?
[2012-01-27 14:42:00 -0500] Andorbal: I'm coming at this from a very non-ideal position:
[2012-01-27 14:42:00 -0500] Andorbal: I'm deploying ASP.NET apps that rely on web.config for everything...
[2012-01-27 14:43:00 -0500] Andorbal: And our current "deployment strategy" is to just overwrite the part of the web.config that are environment specific each time the app is deployed.
[2012-01-27 14:44:00 -0500] hcastro: fujin: re aws cookbook + snapshot entry on the mailing
[2012-01-27 14:45:00 -0500] hcastro: when i read your sentence about dragons i immediately though about this: http://www.youtube.com/watch?v=rAlpG7kODzg
[2012-01-27 14:45:00 -0500] geekbri: How does you upload databags to the chef server via knife?
[2012-01-27 14:47:00 -0500] hcastro: geekbri: http://wiki.opscode.com/display/chef/Managing+Data+Bags+With+Knife
[2012-01-27 14:47:00 -0500] geekbri: hcastro: thanks
[2012-01-27 14:50:00 -0500] yfeldblum: Andorbal, IMHO, applications should not know anything about the infrastructure - everything about the infrastructure that the applications should know about should be passed into them
[2012-01-27 14:51:00 -0500] yfeldblum: Andorbal, your infrastructure should demand that any application expose a very simple interface for configuring and running that application; likewise, any of your applications must expose that very simple interface for configuring and it and running it
[2012-01-27 14:52:00 -0500] yfeldblum: Andorbal, that way, your general infrastructure code need not know about the vagaries of any particular application, and your applications need not be tied so tightly to any given implementation of the infrastructure
[2012-01-27 14:52:00 -0500] lflux: can I set up a notify to execute a block of resources?
[2012-01-27 14:52:00 -0500] lflux: right now I have a notifier chain of a bunch of resources
[2012-01-27 14:53:00 -0500] lflux: so that database creation notifies execute A which notifies execute B et c.
[2012-01-27 14:53:00 -0500] Andorbal: That would imply that after each deployment, I would need to instruct the infrastructure to configure the application?
[2012-01-27 14:54:00 -0500] yatesy: lflux: i just have multiple notifies lines
[2012-01-27 14:54:00 -0500] Andorbal: The first concrete example that jumps to mind is a connection string in web.config.
[2012-01-27 14:54:00 -0500] lflux: yatesy: it sortof needs to be done in order
[2012-01-27 14:54:00 -0500] yatesy: i use immediately for that
[2012-01-27 14:54:00 -0500] lflux: Andorbal: my app has a config file with various IPs and locations it needs to know about, that Chef templates
[2012-01-27 14:54:00 -0500] yatesy: seems to work
[2012-01-27 14:55:00 -0500] Andorbal: I currently have that section already broken out so that each environment gets a specific version of it that points to the right servers, and then I copy the right one depending on the environment.
[2012-01-27 14:56:00 -0500] Andorbal: I'm thinking that ideally, I could store that section of the web.config outside of the application and Chef could create it using a template.
[2012-01-27 14:56:00 -0500] yfeldblum: Andorbal, yes, that's a viable strategy
[2012-01-27 14:57:00 -0500] lflux: no idea how a web.config works but that's how our config system works. Main configuration is stored in the VCS, and keys are overrided by a local config file for specific servers.
[2012-01-27 14:58:00 -0500] Andorbal: That way, the application and configuration are independant of one another.
[2012-01-27 14:58:00 -0500] Andorbal: Well that makes me feel better :)
[2012-01-27 15:00:00 -0500] yfeldblum: right
[2012-01-27 15:01:00 -0500] Andorbal: Thanks for the help... It's tough because I'm coming from a shop that not too long ago still managed and deployed everything manually.
[2012-01-27 15:01:00 -0500] yfeldblum: so long as it's simple, and so long as the one technique works the same way across multiple applications (because applications are required to be written to this interface)
[2012-01-27 15:04:00 -0500] Andorbal: Breaking out sections of a web.config is simple: just give it a path to where the section lives.  If the path is relative, I can guarantee that there will always be a section there, no matter the environment.
[2012-01-27 15:05:00 -0500] Andorbal: The MS solution to this problem is to do XML transforms for each environment, but I really don't like that idea as it needs to be done at the time the application is packaged, which means I'd need to know all the env info up front.
[2012-01-27 15:09:00 -0500] garrettux: hey guys, i need a little help - running my own chef server 0.10.8.  for some reason search isn't returning the expected results when searching for recipes in the expanded runlist.
[2012-01-27 15:11:00 -0500] garrettux: but the node shows up when I search for it by name, and the recipe i'm looking for shows u.
[2012-01-27 15:11:00 -0500] garrettux: [root@vchef02 chef-repo]# knife search node "name:vapp51" -a recipes
[2012-01-27 15:11:00 -0500] garrettux: 1 items found
[2012-01-27 15:11:00 -0500] garrettux: id:       vapp51
[2012-01-27 15:11:00 -0500] garrettux: recipes:
[2012-01-27 15:11:00 -0500] garrettux:     sudo
[2012-01-27 15:11:00 -0500] garrettux:     memcached
[2012-01-27 15:11:00 -0500] garrettux:     chef_handler
[2012-01-27 15:11:00 -0500] garrettux: [root@vchef02 chef-repo]# knife search node "name:vapp51 AND recipes:memcached"
[2012-01-27 15:11:00 -0500] garrettux: 0 items found
[2012-01-27 15:12:00 -0500] garrettux: tried rebuilding the index, didn't help.  expander logs show the node's id being indexed, no errors.
[2012-01-27 15:13:00 -0500] rshade98: Hey Guys, is there a special way to call the files folder in the cookbooks dir
[2012-01-27 15:15:00 -0500] yfeldblum: rshade98, not sure what you mean
[2012-01-27 15:17:00 -0500] rshade98: when you do a knife cookbook create, there is files/default/ folder in the cookbook dir
[2012-01-27 15:18:00 -0500] rshade98: can I call files[:default]/file.tar.gz
[2012-01-27 15:20:00 -0500] garrettux: if it's in files/default then cookbook_file "file.tar.gz" will find it.  no need to specify the path.
[2012-01-27 15:23:00 -0500] garrettux: or are you trying to refer to it in another resource after cookbook_file has already put it on the node's filesystem?
[2012-01-27 15:25:00 -0500] rshade98: just trying to untar it in a recipe
[2012-01-27 15:30:00 -0500] garrettux: use cookbook_file to put it on the filesystem, then use bash or execute to extract it, e.g.
[2012-01-27 15:30:00 -0500] garrettux: cookbook_file "/var/tmp/file.tar.gz" do
[2012-01-27 15:30:00 -0500] garrettux:   source "file.tar.gz"
[2012-01-27 15:30:00 -0500] garrettux:   action :create
[2012-01-27 15:30:00 -0500] garrettux: end
[2012-01-27 15:30:00 -0500] garrettux: execute "tar" do
[2012-01-27 15:30:00 -0500] garrettux:   command "tar xzvf /var/tmp/file.tar.gz"
[2012-01-27 15:30:00 -0500] garrettux: ...
[2012-01-27 15:30:00 -0500] garrettux: end
[2012-01-27 15:30:00 -0500] jamescarr: is there a cookbook for installing... weblogic? :)
[2012-01-27 15:42:00 -0500] flashmanbahadur: when using the execute resource, when it does the check for the 'creates' file does it use the cwd or do I need to be explicit?
[2012-01-27 15:44:00 -0500] yfeldblum: flashmanbahadur, not sure what you mean by "the check for the 'creates' file"
[2012-01-27 15:44:00 -0500] flashmanbahadur: the execute resource has a property creates
[2012-01-27 15:44:00 -0500] flashmanbahadur: creates
[2012-01-27 15:44:00 -0500] flashmanbahadur: A file this command creates - if the file exists, the command will not be run.
[2012-01-27 15:45:00 -0500] flashmanbahadur: i was specifying a relative path to that
[2012-01-27 15:45:00 -0500] flashmanbahadur: assuming the cwd I had set would be respected
[2012-01-27 15:45:00 -0500] flashmanbahadur: looks like it is not
[2012-01-27 15:46:00 -0500] yfeldblum: ah - no, i would expect that you have to give the absolute path to the file
[2012-01-27 15:46:00 -0500] flashmanbahadur: ok
[2012-01-27 15:46:00 -0500] flashmanbahadur: thanks for confirming
[2012-01-27 15:47:00 -0500] flashmanbahadur: untaring and doing a configure/make is kinda of a PITA
[2012-01-27 15:47:00 -0500] yfeldblum: but writing some code that untars and does configure/make for you, so that you don't have to do it, is less of a PITA in the end
[2012-01-27 15:49:00 -0500] flashmanbahadur: yeah thats what im on now
[2012-01-27 15:56:00 -0500] dajia: You can do the same thing with a script resource if you do a not_if "test -e <somefile>"
[2012-01-27 15:59:00 -0500] flashmanbahadur: yeah, i was trying to keep most of it in chef style
[2012-01-27 16:01:00 -0500] yfeldblum: flashmanbahadur, not necessarily any reason to have multiple `execute` resources when a single `script` resource would do
[2012-01-27 16:02:00 -0500] jslatts: chef templates are _supposed_ to overwrite their targets if the contents differ right?
[2012-01-27 16:02:00 -0500] yfeldblum: also please don't use `not_if` with a string value; you should use `not_if` with a ruby block which checks if the file exists
[2012-01-27 16:02:00 -0500] yfeldblum: a la `not_if { File.exist?("/path/to/some/file") }`
[2012-01-27 16:08:00 -0500] moos3: does anyone have a recipe that will create a ebs volume and mount on the fl y?
[2012-01-27 16:10:00 -0500] hcastro: moos3: https://github.com/opscode/cookbooks/tree/master/aws
[2012-01-27 16:15:00 -0500] moos3: hcastro you have a elasticsearch cookbook that doesn't require the gem right_aws
[2012-01-27 16:16:00 -0500] hcastro: moos3: i do not
[2012-01-27 16:16:00 -0500] moos3: :(
[2012-01-27 16:18:00 -0500] moos3: hcastro ideas on this http://pastie.org/3264134
[2012-01-27 16:19:00 -0500] hcastro: are you running this on an amazon linux instance?
[2012-01-27 16:19:00 -0500] moos3: nope a custom built ami
[2012-01-27 16:20:00 -0500] hcastro: based on amazon linux?  looks like your run is failing because there is no ec2-user
[2012-01-27 16:21:00 -0500] moos3: its a centos image
[2012-01-27 16:22:00 -0500] hcastro: are you running chef as root?
[2012-01-27 16:23:00 -0500] moos3: yup
[2012-01-27 16:28:00 -0500] moos3: hcastro looks like its making the user just is fliping out baout the making of the group
[2012-01-27 16:31:00 -0500] rogernolan: Hi, I'm having some weird errors trying to install nagios client nodes. The standard nagios::client recipe is causing chef-client to exit
[2012-01-27 16:31:00 -0500] rogernolan: ERROR: NoMethodError: undefined method `run_action' for "service[nagios-nrpe-server]":String
[2012-01-27 16:33:00 -0500] flashmanbahadur: shouldnt the run action be "recipe[]nagios-nrpe-server]" ?
[2012-01-27 16:35:00 -0500] rogernolan: nagios-nrpe-server is defined as a service in client.rb so I'm thinking that is constructed by chef It's also a ruby exception being thrown.
[2012-01-27 16:37:00 -0500] yfeldblum: flashmanbahadur, no
[2012-01-27 16:37:00 -0500] yfeldblum: rogernolan, github link?
[2012-01-27 16:37:00 -0500] flashmanbahadur: ok
[2012-01-27 16:38:00 -0500] rogernolan: no but give me a minute.
[2012-01-27 16:39:00 -0500] yfeldblum: flashmanbahadur, "recipe[nagios-nrpe-server]" is for adding that recipe to a node's or role's run-list; "service[nagios-nrpe-server]" is for finding a resource that has already been declared, or will be declared in the future, like so: `service "nagios-nrpe-server" do ; ... end`
[2012-01-27 16:40:00 -0500] rogernolan: exactly.
[2012-01-27 16:40:00 -0500] flashmanbahadur: oh i see
[2012-01-27 16:41:00 -0500] flashmanbahadur: misunderstood where the error was coming from, thanks for the clarification
[2012-01-27 16:42:00 -0500] yfeldblum: however, the string "service[nagios-nrpe-server]" is a string and not a resource; it is a string which coincidentally happens to contain a textual query, in some query language, for looking up a resource, but it remains a string; strings in ruby do not have the method #run_action
[2012-01-27 16:43:00 -0500] rogernolan: https://github.com/rogernolan/nagios--chef
[2012-01-27 16:43:00 -0500] yfeldblum: there is another method of querying for resources which returns resource instances, which the following example illustrates: `resources(:service => "nagios-nrpe-server").run_action(:restart)`
[2012-01-27 16:44:00 -0500] yfeldblum: rogernolan, file & line where the exception occurs?
[2012-01-27 16:45:00 -0500] rogernolan: recipe/client.rb:63
[2012-01-27 16:46:00 -0500] rogernolan: The exception occurs in runner.rb from the chef lib https://gist.github.com/52ea29934fcce6ff20d4
[2012-01-27 16:47:00 -0500] fish_: chef is pretty much TIMTOWTDI
[2012-01-27 16:47:00 -0500] yfeldblum: note that the textual query language for resources is introduced in chef-client 0.10 i believe, and is not available in chef-client 0.9
[2012-01-27 16:47:00 -0500] yfeldblum: what version of chef-client is your server running?
[2012-01-27 16:47:00 -0500] rogernolan: ubuntu@ip-10-251-9-101:/var/log/chef$ chef-client -v
[2012-01-27 16:47:00 -0500] rogernolan: Chef: 0.10.4
[2012-01-27 16:49:00 -0500] rogernolan: I tried changing the nagios_nrpecheck to use the "old style" notation like  supports :restart => true, :reload => true but it didn't help.
[2012-01-27 16:51:00 -0500] rogernolan: sorry cut and paste, I mean: like resources(:service =>
[2012-01-27 16:53:00 -0500] yfeldblum: rogernolan, it didn't work because #resources only finds resources that have previously been declared - but the template resource is declared first while the service resource is declared second
[2012-01-27 16:53:00 -0500] moos3: is there a way to make chef install a gem if not their ?
[2012-01-27 16:54:00 -0500] rogernolan: so I just need to move my template after the resource?
[2012-01-27 16:54:00 -0500] rogernolan: Is that a general rule for all recipies?
[2012-01-27 16:54:00 -0500] yfeldblum: rogernolan, no, because that will cause the attempt to start the service before you've written the template
[2012-01-27 16:54:00 -0500] JasonBox: I thought the 'new' style of notififies avoids that
[2012-01-27 16:55:00 -0500] rogernolan: ah
[2012-01-27 16:55:00 -0500] yfeldblum: rogernolan, no, you should declare the template first and then declare the service, and the template resource should notify the service resource using the string query form (rather than the #resource(:type > "name")) form
[2012-01-27 16:56:00 -0500] rogernolan: as in your example above: `resources(:service => "nagios-nrpe-server").run_action(:restart)`
[2012-01-27 17:03:00 -0500] rogernolan: yfeldblum - I don't understand 'template resource' in that instruction
[2012-01-27 17:04:00 -0500] yfeldblum: no, as in: `notifies :restart, "service[nagios-nrpe-server]"`
[2012-01-27 17:04:00 -0500] yfeldblum: rogernolan, when you write `template "/some/path" do ... end`, you are declaring a resource of type template, or a template resource for short
[2012-01-27 17:05:00 -0500] rogernolan: Ok, got that - but that is declared before my service. (and already include notifies : restart)
[2012-01-27 17:05:00 -0500] rogernolan: sorry if I'm being dim BTW :-( I'm about three days not chef...
[2012-01-27 17:07:00 -0500] yfeldblum: it's ok to use the form `notifies :restart, "service[nagios-nrpe-server]"` in a template resource which is declared before the service resource, because that is a delayed notification and the actual query will be executed after all of the resources have been declared and executed
[2012-01-27 17:13:00 -0500] rogernolan: Thanks very much.
[2012-01-27 17:14:00 -0500] yfeldblum: so, the code as-is should work; i don't know why it isn't ...
[2012-01-27 17:16:00 -0500] jschneiderhan: anyone have any tips on generating a unique numeric value from within a chef recipe?a
[2012-01-27 17:16:00 -0500] jschneiderhan: for example generating a unique server_id in a mysql config file
[2012-01-27 17:17:00 -0500] yfeldblum: jschneiderhan, http://rubydoc.info/stdlib/securerandom/1.8.7/SecureRandom
[2012-01-27 17:18:00 -0500] yfeldblum: jschneiderhan, `require "securerandom" ; SecureRandom.random_number(1_000_000)`
[2012-01-27 17:18:00 -0500] jschneiderhan: nice, thanks so much
[2012-01-27 17:20:00 -0500] Brad_K: hmm.  i know that you can freeze cookbook versions, and i know that you can lock down environments to specific cookbook versions.  but is there a way to freeze an entire environment with all the current cookbook versions used?  is there a way to at least show what all versions of what cookbooks are used in what environment?
[2012-01-27 18:11:00 -0500] jbz: Anyone in the mood to tackle a deploy_revision question?
[2012-01-27 18:11:00 -0500] jbz: I've run up against the ruby 1.9.2/bundler problem involving LANG - bundler is failing to install a gem with the following error:  "ArgumentError: invalid byte sequence in US-ASCII"
[2012-01-27 18:12:00 -0500] jbz: according to the net, bundler needs the LANG env set to en.UTF8 or some such
[2012-01-27 18:12:00 -0500] jbz: sorry, set:  LANG=en_US.UTF-
[2012-01-27 18:12:00 -0500] jbz: argh, UTF-8
[2012-01-27 18:12:00 -0500] jbz: ...anyway!
[2012-01-27 18:13:00 -0500] jbz: How would I do this inside the execute command I'm passing in the before_migrate block to do the bundler run?
[2012-01-27 18:13:00 -0500] jbz: If I put that before the bundle command, it breaks the execute saying it can't find the file LANG=en_US.UTF-8
[2012-01-27 18:13:00 -0500] jbz: (which makes sense)
[2012-01-27 18:13:00 -0500] jbz: but if I put it after, it seems to ignore it.
[2012-01-27 18:13:00 -0500] jbz: Is there a way to explicitly set the envs for that execute?
[2012-01-27 18:14:00 -0500] jbz: (I need to learn to ask these things more concisely and clearly)
[2012-01-27 18:17:00 -0500] jbz: Oh.  'execute' is a resource which has an env attribuet.  Herp Derp.  Pamcakes.
[2012-01-27 18:26:00 -0500] gmcinnes: hey, was someone saying the other day that they had nagios plugins for chef?
[2012-01-27 18:26:00 -0500] jbz: wow, OK, more confused.  So I tried adding the requisite LANG env attribute to my execute for bundler
[2012-01-27 18:26:00 -0500] jbz: but it still fails
[2012-01-27 18:26:00 -0500] jbz: but I note that if I go to the node, either as root *or* as my deploy user, that attribute is correctly set in my environment
[2012-01-27 18:27:00 -0500] jbz: so I don't understand how chef's execute environment is set to US_ASCII.
[2012-01-27 18:32:00 -0500] jbz: soany deploy resource whizzes want to take a crack at something  with/for me? :-)
[2012-01-27 18:34:00 -0500] jbz: Hmmm.this looks like a bigger issue...
[2012-01-27 18:38:00 -0500] jbz: Any opscode folks on?
[2012-01-27 18:42:00 -0500] arrowtoknee: jbz: what OS
[2012-01-27 18:42:00 -0500] jbz: arrowtoknee: Ubuntu 10.04
[2012-01-27 18:42:00 -0500] arrowtoknee: does it work if you run a 'sudo apt-get install language-pack-en-base'
[2012-01-27 18:42:00 -0500] jbz: I'm having a problem with how the execute resource (specifically called from inside deploy_revision) handles environment variables
[2012-01-27 18:42:00 -0500] jbz: well
[2012-01-27 18:42:00 -0500] jbz: see
[2012-01-27 18:43:00 -0500] jbz: if I do the bundle command from the deploy user shell *or* the root shell, everything works fine.
[2012-01-27 18:43:00 -0500] jbz: Those both have the env variable set properly
[2012-01-27 18:43:00 -0500] arrowtoknee: are you using rvm or rbenv?
[2012-01-27 18:43:00 -0500] jbz: but for some reason, the env in the execute resource called from deploy_revision appears to *not* have the same value set, and I can't get it to set.
[2012-01-27 18:43:00 -0500] jbz: No.
[2012-01-27 18:44:00 -0500] jbz: I can get the execute resource to accept an "export LANG=en_US.UTF-8; bundle ." command
[2012-01-27 18:44:00 -0500] jbz: and it claims it's executing that
[2012-01-27 18:44:00 -0500] jbz: but it still fails in a way which says that the child proc of the bundle install doesn't have that value set.
[2012-01-27 18:44:00 -0500] jbz: So I have two problems:
[2012-01-27 18:44:00 -0500] jbz: 1) Why isn't this set properly in the env?
[2012-01-27 18:44:00 -0500] jbz: 2) Why can't I set it using the environment attribute, OR
[2012-01-27 18:45:00 -0500] jbz: 2a) Why isn't it being inherited by the child procs of the bundle process I'm calling via execute?
[2012-01-27 18:46:00 -0500] arrowtoknee: what output do you get from running 'locale'
[2012-01-27 18:46:00 -0500] jbz: From the shell, or within the execute?
[2012-01-27 18:46:00 -0500] jbz: let me check
[2012-01-27 18:47:00 -0500] arrowtoknee: from teh shell
[2012-01-27 18:48:00 -0500] jbz: As both the deploy user *and* as root (which chef-client runs as) I get the proper answer that LANG=en_US.UTF-8
[2012-01-27 18:48:00 -0500] jbz: Here's the error I get:  https://gist.github.com/1690181
[2012-01-27 18:49:00 -0500] jbz: Note that in the error, it seems to be saying that that gem install is being run with LANG=US-ASCII
[2012-01-27 18:50:00 -0500] arrowtoknee: ok paste me out the locale output
[2012-01-27 18:50:00 -0500] jbz: 1 wec
[2012-01-27 18:52:00 -0500] jbz: arrowtoknee: OK added it to https://gist.github.com/1690181
[2012-01-27 18:52:00 -0500] jbz: 'medidata' is the deploy user, obv.
[2012-01-27 18:56:00 -0500] jbz: It's a kicker, ain't it?
[2012-01-27 18:56:00 -0500] arrowtoknee: hi can you try my edit
[2012-01-27 18:56:00 -0500] arrowtoknee: https://gist.github.com/1690315
[2012-01-27 18:56:00 -0500] arrowtoknee: deploy_revision before_migrate line 7
[2012-01-27 18:57:00 -0500] arrowtoknee: i believe the issue is a bug in the jquery gem and your missing LC_ALL value
[2012-01-27 18:57:00 -0500] arrowtoknee: but thats a guess
[2012-01-27 18:57:00 -0500] jbz: wilco, testing
[2012-01-27 18:58:00 -0500] arrowtoknee: also worth dropping in LANG=
[2012-01-27 18:58:00 -0500] arrowtoknee: and another &&
[2012-01-27 18:59:00 -0500] arrowtoknee: crap thats not right
[2012-01-27 18:59:00 -0500] arrowtoknee: there we go gist updated
[2012-01-27 19:00:00 -0500] jamescarr: hmmm...how many micro instances can you spin up for free on amazon?
[2012-01-27 19:00:00 -0500] jbz: GIVE THAT MAN A CEEEEGAR
[2012-01-27 19:00:00 -0500] jbz: heh
[2012-01-27 19:00:00 -0500] jbz: thank you kindly arrowtoknee!
[2012-01-27 19:00:00 -0500] jbz: So the issue was that the error message was lying, sorta.
[2012-01-27 19:01:00 -0500] jbz: Ooh, cool, that exposed a whole different error later on.  Fun fun fun.
[2012-01-27 19:02:00 -0500] arrowtoknee: i used to be a troubleshooter but then i got an arrow to the knee
[2012-01-27 19:03:00 -0500] jbz: hahaha
[2012-01-27 19:08:00 -0500] moos3: anyone have a example using aws cookbook to make a ebs volume and mount it ?
[2012-01-27 19:15:00 -0500] jschneiderhan: #moos3 the database cookbook as a ebs_volume recipe
[2012-01-27 19:16:00 -0500] jschneiderhan: https://github.com/opscode/cookbooks/blob/master/database/recipes/ebs_volume.rb
[2012-01-27 19:16:00 -0500] kshep: There's also https://github.com/opscode/cookbooks/tree/master/aws
[2012-01-27 19:17:00 -0500] moos3: my question is the volume_id, i'm going to know that before hand
[2012-01-27 19:17:00 -0500] kshep: ah... mounting an existing volume
[2012-01-27 19:17:00 -0500] kshep: ?
[2012-01-27 19:17:00 -0500] moos3: nope
[2012-01-27 19:18:00 -0500] moos3: making them on the fly but if the node is terminated it would be nice to remount the volume
[2012-01-27 19:18:00 -0500] moos3: i have this in my elasticsearch recipe http://pastie.org/3265101
[2012-01-27 19:19:00 -0500] moos3: so thats on the track then ?
[2012-01-27 19:32:00 -0500] judd7: tough!!love
[2012-01-27 19:33:00 -0500] thwop: anyone have a good resource for learning about deploying/managing rails applications?
[2012-01-27 19:34:00 -0500] thwop: i'm looking for best practice type stuff for user accounts, file permissions, groups, and file structure
[2012-01-27 19:34:00 -0500] thwop: (using nginx, passenger, capistrano if that changes things)
[2012-01-27 19:34:00 -0500] mstyne: heh
[2012-01-27 19:42:00 -0500] spheromak: anyone know of a decent bind cook anywhere ?  even 1/2 done. preferably with a provider :P  dont want to reinvent the wheel. Only thing i see is something in the dns barclamp.
[2012-01-27 19:43:00 -0500] spheromak: want to be able to add A/CNAME/PTR ad-hoc.
[2012-01-27 19:50:00 -0500] jtimberman: spheromak: i have powerdns (pdns), unbound, maradns and djbdns... no bind :P
[2012-01-27 19:54:00 -0500] jslatts: templates supposed to overwrite their targets if the file doesn't match right?
[2012-01-27 19:54:00 -0500] jslatts: doesn't match the cached template
[2012-01-27 19:59:00 -0500] cwj: jslatts: yes
[2012-01-27 20:09:00 -0500] spheromak: jtimberman: those doing zone file managent or just via API ?
[2012-01-27 20:14:00 -0500] jtimberman: spheromak: varies by cookbook.
[2012-01-27 20:15:00 -0500] Damm: spheromak, the problem I find with bind and automating zones in bind, is you have the right spirit... but too many people are not willing to do it.
[2012-01-27 20:16:00 -0500] spheromak: Damm: well im gonan do smthing thats not the way this crowbar util_line pars a file thing is working
[2012-01-27 20:16:00 -0500] Damm: spheromak, all it really should be is read a database for a type, and the record, and then the ttl, and whatever extra, write it to disk, have the serial # in the dbag
[2012-01-27 20:16:00 -0500] spheromak: just leverage inludes
[2012-01-27 20:16:00 -0500] spheromak: and create a zone, and includes for host records prob dunno
[2012-01-27 20:16:00 -0500] spheromak: will be ugly, but abstracted
[2012-01-27 20:16:00 -0500] Damm: ugly, refactor, clean up
[2012-01-27 20:16:00 -0500] spheromak: need it in bind due to the existing dhcpd->bind fu
[2012-01-27 20:17:00 -0500] Damm: getting it working is the the first part, making it pretty so the bitches don't hate... that's another day
[2012-01-27 20:17:00 -0500] spheromak: and i need to put a fair bit of info form chef into TXT records (yay). internal
[2012-01-27 20:17:00 -0500] spheromak: yea not worried about pretty
[2012-01-27 20:17:00 -0500] spheromak: people wont be editing the output direct
[2012-01-27 20:17:00 -0500] spheromak: just didn't want to reinvent the wheel
[2012-01-27 20:17:00 -0500] Damm: good because that would defeat the purpose
[2012-01-27 20:26:00 -0500] JasonBox: Damm: lol
[2012-01-27 20:26:00 -0500] Damm: jtimberman, and why no bind? no love for paul?
[2012-01-27 20:27:00 -0500] Damm: jtimberman, think of the children
[2012-01-27 20:27:00 -0500] JasonBox: Oh, oh
[2012-01-27 20:28:00 -0500] jtimberman:   ~.
[2012-01-27 20:29:00 -0500] JasonBox: What, knife cookbook site install failed?
[2012-01-27 20:29:00 -0500] Urocyon: what if I have two cookbooks that want to manage the same file.  Is there a way to say - use this cookbook for file x but that cookbook for file y?
[2012-01-27 20:30:00 -0500] Damm: have you tried using 2 resources with the same exact name?
[2012-01-27 20:30:00 -0500] Damm: do you know what happens?
[2012-01-27 20:30:00 -0500] Urocyon: haven't yet, no.
[2012-01-27 20:30:00 -0500] Damm: and if you know the answer... don't give him the answer.
[2012-01-27 20:30:00 -0500] JasonBox: Confuses me: http://pastie.org/3265478
[2012-01-27 20:30:00 -0500] Damm: it's fun to watch the brain explode
[2012-01-27 20:30:00 -0500] Urocyon: so mean
[2012-01-27 20:31:00 -0500] Damm: Urocyon, not meant to be... it's just the best way to explain that pain
[2012-01-27 20:31:00 -0500] Damm: and make it crystal clear
[2012-01-27 20:31:00 -0500] Damm: really it's best not to have 2 resources manage the content of the same file and filename
[2012-01-27 20:31:00 -0500] Damm: if you want 2 resources to change the file, perhaps a symlink before hand... so they are differently named resources
[2012-01-27 20:31:00 -0500] Damm: and it should work
[2012-01-27 20:32:00 -0500] Damm: as far as the other part of the logic, I was first referring to the conditions applied to the resources could get applied to a or b
[2012-01-27 20:32:00 -0500] Damm: which could mess up the whole process to begin with
[2012-01-27 20:34:00 -0500] JasonBox: Hooray, someone else had the same issue: https://gist.github.com/1174606
[2012-01-27 20:35:00 -0500] JasonBox: And another...
[2012-01-27 20:36:00 -0500] JasonBox: Not finding any solutions, though
[2012-01-27 20:41:00 -0500] arrowcircle: hi! what is the best way to run initial apt-get update && apt-get upgrade && apt-get dist-upgrade commands with chef? should i just run them as commands or there is a better way to make it chef-style?
[2012-01-27 20:42:00 -0500] JasonBox: The `pwd` is wrong
[2012-01-27 20:42:00 -0500] JasonBox: If I mkdir cookbooks inside cookbooks and ln -s ../apache2.tar.gz . inside it, it works fine
[2012-01-27 20:43:00 -0500] jtimberman: arrowcircle: I don't know that I'd put automatic upgrading into a recipe.
[2012-01-27 20:43:00 -0500] JasonBox: Which comes from an strace showing 8889  chdir("./cookbooks")
[2012-01-27 20:43:00 -0500] jtimberman: arrowcircle: I tend to do that kind of thing with knife ssh
[2012-01-27 20:43:00 -0500] JasonBox: Naturally execve("/bin/tar", ["tar", "zxvf", "./cookbooks/apache2.tar.gz"] will subsequently fail
[2012-01-27 20:43:00 -0500] JasonBox: knife cookbook site install blah works for everyone else?
[2012-01-27 20:43:00 -0500] jtimberman: arrowcircle: e.g., "knife ssh 'platform:ubuntu' 'sudo apt-get update && sudo apt-get upgrade'"
[2012-01-27 20:44:00 -0500] Urocyon: Damm I'm surprised chef doesn't report some kind of name conflict error.
[2012-01-27 20:45:00 -0500] arrowcircle: jtimberman, i thought its not the chef-way. ie i should run it with my hands?
[2012-01-27 20:49:00 -0500] moos3: is there away to find a ebs volume if theres a free one, if available attach if not then create one ?
[2012-01-27 21:10:00 -0500] Urocyon: moos3 I think the database cookbook has code that does that.
[2012-01-27 21:10:00 -0500] moos3: k cool
[2012-01-27 21:10:00 -0500] moos3: try now i'm trying to figure out why after creation its not attaching it
[2012-01-27 21:10:00 -0500] yfeldblum: arrowcircle, the chef way is to specify the *desired final state* of your nodes in a declarative way, in code, in source control
[2012-01-27 21:11:00 -0500] Urocyon: It uses teh aws and xfs  cookbooks.
[2012-01-27 21:11:00 -0500] moos3: Urocyon http://pastie.org/3265698
[2012-01-27 21:11:00 -0500] yfeldblum: arrowcircle, but there are many things you need to do in terms of day-to-day maintenance operations, in addition to writing down desired final states into ruby files
[2012-01-27 21:11:00 -0500] moos3: yeah i'm using aws and xfs
[2012-01-27 21:11:00 -0500] yfeldblum: arrowcircle, including updating packages
[2012-01-27 21:12:00 -0500] arrowcircle: yfeldblum, and whats the best way to describe final state for system update?
[2012-01-27 21:13:00 -0500] Urocyon: moos3 I'm not really familiar with it, just saw that database had code to do it.
[2012-01-27 21:13:00 -0500] moos3: yea
[2012-01-27 21:13:00 -0500] moos3: i'm looking at :D
[2012-01-27 21:13:00 -0500] moos3: thanks
[2012-01-27 21:13:00 -0500] Urocyon: I'm about to tackle it, but was thinking of doing it from cloudfront instead.
[2012-01-27 21:14:00 -0500] Urocyon: Keeping my provisioning separate from my configuration.
[2012-01-27 21:14:00 -0500] moos3: yea, 10G drive for elasticsearch isn't cool, so i need to make a 500G drive for it
[2012-01-27 21:15:00 -0500] Urocyon: Better might be several drives even, and raid them together.   Not sure how to go about pulling that off in chef though.
[2012-01-27 21:16:00 -0500] moos3: theres a raid ebs volume cookbook
[2012-01-27 21:16:00 -0500] Urocyon: ooh
[2012-01-27 21:16:00 -0500] moos3: i wish you should treat a ebs volume like a san volume and share it across many systems
[2012-01-27 21:17:00 -0500] Urocyon: yeah, but then what would you use to handle concurrent access?  Need some sort of networked file system for it.    That's going to be ugly.
[2012-01-27 21:18:00 -0500] moos3: yea
[2012-01-27 21:20:00 -0500] Urocyon: I have systems now that depend on nfs... and I'm trying to get rid of that.  too brittle.
[2012-01-27 21:20:00 -0500] moos3: and nfs doesn't scale
[2012-01-27 21:20:00 -0500] Urocyon: definitely.
[2012-01-27 21:20:00 -0500] moos3: we have a 600 server cluster, and we use gpfs as the cluster fs for the physical boxes
[2012-01-27 21:22:00 -0500] Urocyon: I'm only at a dozen clients right now.   So haven't hit many scaling problems.... but it just isn't how I want to handle things.
[2012-01-27 21:22:00 -0500] yfeldblum: arrowcircle, i don't know of a good one - i think that's why jtimberman said he tended to do `knife ssh QUERY 'sudo apt-get update && sudo apt-get upgrade'`
[2012-01-27 21:22:00 -0500] moos3: Urocyon yea being forced to scale causes poor choices in design
[2012-01-27 22:00:00 -0500] dchalloner: whats the best way to speed up subsequent chef runs, like for the build-essentials cookbook and gcc.
[2012-01-27 22:05:00 -0500] spheromak: dchalloner: simple answer ? dont use the cookbook ?
[2012-01-27 22:34:00 -0500] jtimberman: yfeldblum: that is precisely why i suggested taht :)
[2012-01-27 22:37:00 -0500] matti: Hi jtimberman
[2012-01-27 23:44:00 -0500] knightorc: is it possible to return output of a powershell execution to chef so that chef can ack on it? I've look through all the code examples I can locate and I've not found one example of this.
[2012-01-27 23:58:00 -0500] moos3_: can chef set the node name in aws's console ?
