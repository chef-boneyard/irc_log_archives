[2012-05-07 00:14:39 -0400] hoover_damn: remote_directory should work
[2012-05-07 00:15:05 -0400] hoover_damn: although that there should be cookbook_directory like cookbook_file
[2012-05-07 00:15:21 -0400] hoover_damn: :|
[2012-05-07 00:15:32 -0400] flaccid: does chef have something that supports operations for cloud strorage through one interface for different clouds e.g. cloud files, s3 etc.?
[2012-05-07 00:17:03 -0400] hoover_damn: flaccid, no specific code for s3
[2012-05-07 00:17:09 -0400] hoover_damn: that's all fog
[2012-05-07 00:17:35 -0400] hoover_damn: flaccid, well by default that is... and the problem with cloudfiles vs s3 is api
[2012-05-07 00:17:45 -0400] hoover_damn: flaccid, deltacloud looks promising
[2012-05-07 00:17:51 -0400] flaccid: fog does many different cloud storages?
[2012-05-07 00:17:56 -0400] hoover_damn: yes
[2012-05-07 00:18:03 -0400] flaccid: whats wrong with the apis?
[2012-05-07 00:18:18 -0400] hoover_damn: they're all different
[2012-05-07 00:18:26 -0400] hoover_damn: everyone keeps reinventing the wheel
[2012-05-07 00:18:30 -0400] hoover_damn: and forgetting about the customers
[2012-05-07 00:18:39 -0400] flaccid: well that is the point of an abstraction with one interface for it!
[2012-05-07 00:18:45 -0400] rabidpraxis7: does anyone know where Chef::Resource::ApplicationBase is located? It is being included in the application_ruby cookbook, but I don't know where it should be referenced from
[2012-05-07 00:19:02 -0400] hoover_damn: the only thing that's getting close to that imo is deltacloud
[2012-05-07 00:19:31 -0400] flaccid: thanks i'll check it out
[2012-05-07 00:20:30 -0400] hoover_damn: and I really don't consider it a chef specific issue
[2012-05-07 00:20:53 -0400] flaccid: its not an issue, i was seeing if there was something in chef
[2012-05-07 00:21:12 -0400] hoover_damn: well fetching should be easy, it's the putting
[2012-05-07 00:21:16 -0400] hoover_damn: and that should be all fog
[2012-05-07 00:21:46 -0400] flaccid: can't deltacloud do that?
[2012-05-07 00:22:02 -0400] hoover_damn: deltacloud is about providing 1 api for multiple clouds
[2012-05-07 00:22:21 -0400] hoover_damn: you have rhel-v and ec2 and some eucalytpus in your infra
[2012-05-07 00:22:25 -0400] flaccid: then why can it do a fetch and not a put of a cloud storage object?
[2012-05-07 00:22:27 -0400] hoover_damn: and you want to write 1 set of api calls
[2012-05-07 00:22:41 -0400] hoover_damn: fetching is net/http
[2012-05-07 00:22:42 -0400] hoover_damn: putting is fog
[2012-05-07 00:23:25 -0400] hoover_damn: cloudfiles should be getting a facelift beta soon
[2012-05-07 00:23:26 -0400] hoover_damn: i imagine
[2012-05-07 00:23:34 -0400] hoover_damn: if not more
[2012-05-07 00:23:57 -0400] flaccid: are you trying to say that deltacloud only does compute not cloud storage? i'm confused
[2012-05-07 00:24:05 -0400] hoover_damn: yep
[2012-05-07 00:24:09 -0400] hoover_damn: sorry for confusing you
[2012-05-07 00:24:18 -0400] hoover_damn: if you want to push, you want fog... if you want to recieve you want net/http
[2012-05-07 00:24:41 -0400] hoover_damn: or use fog if you want to retrieve private files
[2012-05-07 00:24:43 -0400] flaccid: afaik fog can recieve as well
[2012-05-07 00:24:54 -0400] hoover_damn: yeah but why would you unless it's private?
[2012-05-07 00:25:02 -0400] hoover_damn: that's the extra step that is not required
[2012-05-07 00:25:15 -0400] flaccid: actually, no deltacloud does it fine http://deltacloud.apache.org/drivers.html#h3_1
[2012-05-07 00:25:42 -0400] flaccid: to be generic
[2012-05-07 00:25:52 -0400] hoover_damn: ahh cool
[2012-05-07 00:25:58 -0400] hoover_damn: yeah last i heard it wasnt that finished
[2012-05-07 00:26:01 -0400] hoover_damn: so i didn't mention it
[2012-05-07 00:26:40 -0400] flaccid: so i would class fog,deltacloud and boto all as the same kind of tool
[2012-05-07 00:26:55 -0400] hoover_damn: then you'd be wrong
[2012-05-07 00:27:08 -0400] hoover_damn: fog and boto sure, but deltacloud is not in the same park
[2012-05-07 00:27:10 -0400] flaccid: please explain
[2012-05-07 00:27:18 -0400] flaccid: what park is it in?
[2012-05-07 00:27:21 -0400] hoover_damn: please read over what detacloud does
[2012-05-07 00:27:39 -0400] hoover_damn: it's an api endpoint
[2012-05-07 00:27:47 -0400] hoover_damn: fog is a gem, boto is a egg
[2012-05-07 00:28:16 -0400] flaccid: deltacloud is also a gem
[2012-05-07 00:28:38 -0400] hoover_damn: stop being that silly
[2012-05-07 00:28:52 -0400] hoover_damn: you don't install deltacloud on all your clients
[2012-05-07 00:29:00 -0400] flaccid: i guess you are saying deltacloud is the true one because it has the actual abstraction whereis in the others you still use classes specific to the cloud you are interfacing, right?
[2012-05-07 00:29:01 -0400] hoover_damn: you install deltacloud and point your clients to it
[2012-05-07 00:29:20 -0400] hoover_damn: use the detalcloud api in your scripts
[2012-05-07 00:29:35 -0400] flaccid: well it does say you can install it anywhere including your local machine :)
[2012-05-07 00:29:40 -0400] hoover_damn: it talks to deltacloud server and makes the calls for you with the driver
[2012-05-07 00:31:03 -0400] flaccid: i understand the different thanks, but from the client point of view all 3 satisfy support for many clouds via one interface
[2012-05-07 00:32:39 -0400] flaccid: so with that being said, i'll go and make a ServerTemplate now for DeltaCloud. is there a cookbook around yet?
[2012-05-07 00:35:15 -0400] upgrayedd: i'm writing a provider and i was wondering if there's a natural place to cache provider-specific data between runs
[2012-05-07 00:35:33 -0400] upgrayedd: i'm about to just write out a json file somewhere in /var/cache/ ...
[2012-05-07 00:36:44 -0400] flaccid: hoover_damn: we (RightScale) get a mention next to DeltaCloud here, http://robhirschfeld.com/tag/deltacloud/ :)
[2012-05-07 00:40:08 -0400] silk1: upgrayedd: you might like to try #{Chef::Config[:file_cache_path]}
[2012-05-07 01:05:08 -0400] izo: hi
[2012-05-07 01:07:35 -0400] valdezjoetl: help .... how do i copy all files in Files->Default on my /opt/MyDirectory/
[2012-05-07 01:11:51 -0400] |shad0w|: http://wiki.opscode.com/display/chef/Resources#Resources-RemoteDirectory
[2012-05-07 01:23:43 -0400] raz: um...
[2012-05-07 01:27:52 -0400] raz: it'd be funny if it wasn't so sad
[2012-05-07 01:29:28 -0400] raz: http://tickets.opscode.com/browse/CHEF-867
[2012-05-07 01:29:39 -0400] raz: perhaps someone can elevate that to priority brown paper bag
[2012-05-07 01:43:38 -0400] valdezjoetl: help .... how do i copy all files in Files->Default on my /opt/MyDirectory/
[2012-05-07 01:44:38 -0400] shuvo: valdezjoetl, http://wiki.opscode.com/display/chef/Resources#Resources-RemoteDirectory
[2012-05-07 02:39:18 -0400] valdezjoetl: Thanks <shuvo> I notice that even i set the mode to 755, when it has done transfering all files from source. the files were not in 755 mode
[2012-05-07 02:40:06 -0400] valdezjoetl: remote_directory "/opt/scripts/" do     source "/scripts"     mode 0755     owner "root"       group "root"
[2012-05-07 02:40:19 -0400] valdezjoetl: remote_directory "/opt/scripts/" do     source "/scripts"     mode 0755     owner "root"       group "root" end
[2012-05-07 03:19:36 -0400] shuvo: can you create a gist or like of the code snippet
[2012-05-07 04:08:16 -0400] hoover_damn: valdezjoetl, you need to use files_owner and files_group and files_mode
[2012-05-07 04:08:27 -0400] hoover_damn: if you want to specify the owner/group/mode of the files inside said directory
[2012-05-07 04:08:35 -0400] hoover_damn: like what shuvo linked
[2012-05-07 05:12:57 -0400] BryanWB: ohai chefs!
[2012-05-07 06:31:30 -0400] andreacampi: hey BryanWB :)
[2012-05-07 06:32:33 -0400] andreacampi: rabidpraxis7: it's in application/libraries
[2012-05-07 07:14:02 -0400] msf_: I don't suppose knife has access to ohai variables
[2012-05-07 10:04:05 -0400] a_a_g: newbie question: on which machine is the callback code executed?
[2012-05-07 10:07:43 -0400] andreacampi: which callback?
[2012-05-07 10:19:43 -0400] a_a_g: deployment callbacks
[2012-05-07 10:20:10 -0400] a_a_g: http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-05-07 10:20:10 -0400] andreacampi: so you're talking about the deploy resource?
[2012-05-07 10:20:16 -0400] a_a_g: yes
[2012-05-07 10:20:17 -0400] andreacampi: ok
[2012-05-07 10:20:36 -0400] andreacampi: you are using that in a recipe
[2012-05-07 10:20:47 -0400] andreacampi: and adding that recipe to a node's run list
[2012-05-07 10:20:51 -0400] andreacampi: so it would be on that node
[2012-05-07 10:21:01 -0400] a_a_g: yeah, thought so
[2012-05-07 10:21:49 -0400] a_a_g: hm, i want a way of signaling successful convergence of a node to an in-house jenkins (behind a firewall)
[2012-05-07 10:22:11 -0400] a_a_g: i guess i could update and poll a data bag
[2012-05-07 10:22:16 -0400] a_a_g: is there a better way?
[2012-05-07 10:23:11 -0400] tomoj: http://wiki.opscode.com/display/chef/Exception+and+Report+Handlers
[2012-05-07 10:23:14 -0400] flaccid: put a recipe at the end of the run_list or use a notification
[2012-05-07 10:24:07 -0400] a_a_g: will take a look, thanks
[2012-05-07 10:26:13 -0400] eugenmayer: is there a particular way to "wait" for some seconds in a reciepe?
[2012-05-07 10:26:22 -0400] eugenmayer: e.g. because an interface needs to get up
[2012-05-07 10:27:30 -0400] andreacampi: something that has been mentioned before is, you can abuse a resource's only_if block
[2012-05-07 10:28:09 -0400] flaccid: yeah if its in encapsulated in a loop
[2012-05-07 10:29:50 -0400] andreacampi: uhm, why the loop?
[2012-05-07 10:30:23 -0400] a_a_g: so a handlers and notifications are also run on the node. i need to run a 'handler' on a jenkins instance inside my firewall. i guess the only communication channel would be via a databag
[2012-05-07 10:30:30 -0400] flaccid: because there is no loop, only_if gets run once
[2012-05-07 10:30:36 -0400] a_a_g: unless i poke holes in the firewall
[2012-05-07 10:31:03 -0400] eugenmayer: (was this all for me?)
[2012-05-07 10:31:10 -0400] yfeldblum: a_a_g, no, your success/exception handler code can do whatever, including send messages to remote servers
[2012-05-07 10:31:20 -0400] andreacampi: eugenmayer: yes
[2012-05-07 10:31:44 -0400] eugenmayer: yfeldblum: jap, we are sending back "expections" or "success" of a chef run to icinga nsca
[2012-05-07 10:31:55 -0400] eugenmayer: so, we get notified, when a chef-client run fails on a client
[2012-05-07 10:32:48 -0400] a_a_g: yfeldblum: my nodes are in ec2. they wont be able to send anything directly to the jenkins box. i would have to use some sort of a async notification
[2012-05-07 10:34:19 -0400] yfeldblum: a_a_g, use whatever you like; i didn't say anything about sending anything directly to the jenkins box per se - you can certainly use middlemen or anything you like; however, data bags are not designed for this
[2012-05-07 10:36:02 -0400] eugenmayer: a_a_g: so you are deploying lets say with capistrano, test the app with jenkins and report back, all this with chef?
[2012-05-07 10:36:38 -0400] yfeldblum: eugenmayer, you can certainly have a ruby_block resource that, in a loop, sleeps for checks the interface and sleeps for 1s (be *sure* to have a max number of checks before ultimately raising an exception...) ... stick this ruby_block resource just before the resource that requires usage of the interface
[2012-05-07 10:37:02 -0400] a_a_g: i'm deploying with chef, want to wait for convergence, run tests via jenkins
[2012-05-07 10:37:16 -0400] eugenmayer: yfeldblum: interesting. Will try, thank you!
[2012-05-07 10:37:36 -0400] eugenmayer: a_a_g: yet, for me, chef is not very much suiteable for app-deployment
[2012-05-07 10:38:18 -0400] a_a_g: yeah well, thats not in my control unfortunately :)
[2012-05-07 10:38:20 -0400] eugenmayer: a_a_g: sure, if you "trigger" a deployement though capistratano, then test with jenkins, thats cool. But still, i think capistratano should work with jenkins, not chef, as you want to "rollback" on issues
[2012-05-07 10:38:50 -0400] andreacampi: eugenmayer: why do you want to use capistrano?
[2012-05-07 10:39:02 -0400] eugenmayer: andreacampi: for app deployement?
[2012-05-07 10:39:04 -0400] andreacampi: eugenmayer: chef can do everything capistrano can do, in a nicer way, and then some
[2012-05-07 10:39:10 -0400] eugenmayer: andreacampi: no it cant.
[2012-05-07 10:39:16 -0400] eugenmayer: and never ever nicer.
[2012-05-07 10:39:39 -0400] andreacampi: eugenmayer: tall claim, care to provide some example?
[2012-05-07 10:40:01 -0400] eugenmayer: chef and capistrano have there "intersections", but both serve a different field and have different focus. They fit perfectly together, thoigh
[2012-05-07 10:41:23 -0400] yfeldblum: convergence towards declared final state does not necessarily include push-based app-deployment
[2012-05-07 10:41:36 -0400] eugenmayer: andreacampi: well, lets say it that way: I bet "assemembler" is a as good as "capistrano" as you can actually code _anything_ capistratno does in assemembler and run it. In conclusion, that means, assembler is ( yes, its a language, but dont be to exact here) more powerful then capistrano, as it can even provide a webserver, a firewall and whatever.
[2012-05-07 10:41:49 -0400] andreacampi: eugenmayer: we used to use capistrano, we migrated to chef more than a year ago and I definitely don't miss it I really don't see what capistrano has that chef doesn't
[2012-05-07 10:42:25 -0400] renchap: andreacampi: ability to launch something instantly on a lot of servers
[2012-05-07 10:42:31 -0400] eugenmayer: andreacampi: to get back to chef, yes, if you write chef-reciepes with a ton of code and a lot of custom work, you can get "near" capistrano - beside you will then maintain and test your code yourself
[2012-05-07 10:42:38 -0400] raz: awesome. opscode own chef-client cookbook busted my chef-server :D
[2012-05-07 10:43:11 -0400] andreacampi: renchap: ah, yes, from the point of view of the control flow but you can always use mcollective to trigger a chef run
[2012-05-07 10:43:16 -0400] renchap: no
[2012-05-07 10:43:28 -0400] renchap: because you cant control the steps of a chef run
[2012-05-07 10:43:38 -0400] renchap: on capistrano, you can "wait" at some point
[2012-05-07 10:43:48 -0400] renchap: and continue when all servers have the correct state
[2012-05-07 10:43:50 -0400] eugenmayer: exactly, and you dont have that kind of a framework for ANY rolebocks in chef.
[2012-05-07 10:44:22 -0400] eugenmayer: and yes, you can grab those with exceptions and code it all the manual way, not using any framework for this, but this makes no sense
[2012-05-07 10:44:41 -0400] andreacampi: you do multi-server, multi-application orchestration in capistrano?
[2012-05-07 10:45:17 -0400] eugenmayer: sounds like clustering
[2012-05-07 10:45:46 -0400] andreacampi: that is something Chef doesn't do, granted but I don't see how you get that out of the box in capistrano either
[2012-05-07 10:46:35 -0400] andreacampi: anyway, if it works for you that's great, I'm not going to argue that any further :)
[2012-05-07 10:46:38 -0400] renchap: i have done at $job-1 1 app, multiserver
[2012-05-07 10:46:49 -0400] renchap: and multi app was handled by having multiple capfiles
[2012-05-07 10:47:00 -0400] renchap: and using different system accounts & all
[2012-05-07 10:47:19 -0400] andreacampi: and the capfile waited for the other apps to be at a certain state before proceeding?
[2012-05-07 10:47:35 -0400] eugenmayer: andreacampi: i just think, the topic "capistrano vs. chef" is pretty interesting
[2012-05-07 10:48:01 -0400] renchap: no, we only deployed 1 app at a time
[2012-05-07 10:48:06 -0400] eugenmayer: andreacampi: expecially to see how people handle the seperation, if any, and how they compare those two
[2012-05-07 10:48:11 -0400] renchap: for me, chef & capistrano does not achieve the same goal
[2012-05-07 10:48:23 -0400] eugenmayer: renchap: signed
[2012-05-07 10:48:24 -0400] renchap: and i would use both
[2012-05-07 10:48:37 -0400] renchap: capistrano to manage apps, chef to manage the server
[2012-05-07 10:48:48 -0400] andreacampi: fair enough. everybody has different tastes and different workflows
[2012-05-07 10:48:59 -0400] eugenmayer: That exactly covers my opinion. they are uncompareable and actually are perfect tools to use together
[2012-05-07 10:49:10 -0400] eugenmayer: andreacampi: true, true
[2012-05-07 10:50:29 -0400] eugenmayer: andreacampi: i think, you never can actually give it a "thats not possible" with chef and thats why capistrano is "better". Its more about, what is possible OOTB, what is the framework build for and handles best OOTB, what tools you have to save your time
[2012-05-07 10:51:00 -0400] andreacampi: eugenmayer: I guess we'll just have to agree to disagree. Chef gives you so much more out of the box
[2012-05-07 10:51:13 -0400] eugenmayer: Ok :)
[2012-05-07 10:51:17 -0400] andreacampi: eugenmayer: for deploying apps, I mean
[2012-05-07 10:51:39 -0400] eugenmayer: Well, yet - did not find anything. Could you, e.g. just give me an idea
[2012-05-07 10:51:55 -0400] eugenmayer: what chef gives your for automated app-roleback, staging and "live transfer"?
[2012-05-07 10:52:30 -0400] andreacampi: as a basic building block, http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-05-07 10:52:35 -0400] eugenmayer: i cant, yet, see any concepts at all touching this. Yes, i can deploy a app once with chef, for sure. But redploying, upgrading, changing and testing it sounds like pain
[2012-05-07 10:52:36 -0400] andreacampi: then you have https://github.com/opscode-cookbooks/application
[2012-05-07 10:53:03 -0400] andreacampi: for a more complex example, see https://github.com/coderanger/djangocon2011/blob/master/cookbooks/packaginator/recipes/default.rb
[2012-05-07 10:53:31 -0400] eugenmayer: andreacampi: just scimming through the app cookbook - i cant see any roleback coverewd
[2012-05-07 10:53:41 -0400] andreacampi: it orchestrates a multi-tier app, with an app server, reverse proxy lb and worker queue on separate nodes
[2012-05-07 10:53:51 -0400] andreacampi: tied together with roles
[2012-05-07 10:54:40 -0400] eugenmayer: sorry, all i see here https://github.com/opscode-cookbooks/application
[2012-05-07 10:54:44 -0400] andreacampi: that's in the deploy resource
[2012-05-07 10:54:47 -0400] eugenmayer: is trying to bend chef do do it.
[2012-05-07 10:54:50 -0400] andreacampi: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/deploy.rb#L73 and around
[2012-05-07 10:54:59 -0400] andreacampi: bend?
[2012-05-07 10:55:10 -0400] andreacampi: well, you could argue capistrano is bending ruby :D
[2012-05-07 10:55:18 -0400] eugenmayer: heh :)
[2012-05-07 10:55:29 -0400] andreacampi: all software is built by combining component blocks
[2012-05-07 10:55:30 -0400] eugenmayer: well andreacampi lets go it that way - i have to really look at "applications" ion chef
[2012-05-07 10:55:51 -0400] andreacampi: right :)
[2012-05-07 10:56:17 -0400] eugenmayer: and maybe the discuss on better ground - right now, you caught me uncovered :) I simply do not know anything about that cookbook but i surely will have a look when we move from the current system ( which is not capistrano ) to a realy deployment tool
[2012-05-07 10:56:23 -0400] andreacampi: no worries the reason I'm still "arguing" is that I'd really like to understand what other people expect for application deployment, and see if I can help
[2012-05-07 10:56:54 -0400] andreacampi: (and frankly, I do "bare" deployments less and less we mostly run on CloudFoundry these days)
[2012-05-07 10:57:03 -0400] eugenmayer: for now, we have a "bend" system to cover deployment. This tool has been build for deployment, its development stucks, its broken at so many points as its development is much less deidcated then capistrano / phing
[2012-05-07 10:57:11 -0400] tomoj: wow, application got rewritten ? :D
[2012-05-07 10:57:21 -0400] andreacampi: tomoj: yes :)
[2012-05-07 10:57:41 -0400] andreacampi: tomoj: hopefully we'll have a new release soon
[2012-05-07 11:03:24 -0400] eugenmayer: andreacampi: thanks for the discussion. Iam still very sceptical due to historical reasons for anything just "written ontop of something" for deployment, but i will have a look. For me, its just down to expectations and needs. Yes you can write a ERP using perl - but it will never fit extended needs and it will waste years of time. For me, app-deployment reaches a level of complexity, that it cannot be handled by "generic" systems like
[2012-05-07 11:04:19 -0400] eugenmayer: After 3 years with a "less dedicated" app-deployment tool, iam really living hell sometimes here and pretty much trying to go for the concept "use dedicated tools for complex and central tasks"
[2012-05-07 11:04:53 -0400] eugenmayer: (giving a example, you can for sure build "monitoring" with chefbut do you want this indstead of using monit / icinga?)
[2012-05-07 11:05:29 -0400] eugenmayer: I guess, it comes down to the needs / expectations. Sometimes, straight forward simple solutions can work out better, i admit
[2012-05-07 11:06:19 -0400] andreacampi: eugenmayer: yeah, I get your point
[2012-05-07 11:07:46 -0400] eugenmayer: dont get me wrong, iam not doubting your work on "application" .. i dont even know it yet. Iam just guessing, thats for sure
[2012-05-07 11:07:58 -0400] andreacampi: eugenmayer: it's just that I do think that app deployment is a good fit for Chef, whereas monitoring is quite clearly a different beast
[2012-05-07 11:08:27 -0400] eugenmayer: lets see, iam tensed. I dont doubt, chef is powerful.
[2012-05-07 11:08:37 -0400] andreacampi: eugenmayer: well, have a look and you'll let me know ;)
[2012-05-07 11:08:44 -0400] eugenmayer: Will do .)
[2012-05-07 11:09:57 -0400] andreacampi: eugenmayer: also don't get me wrong, I realize Chef and the application cookbook can't do everything for everybody. but maybe there are areas where we are 95% there and the 5% is easy to do ;)
[2012-05-07 11:10:14 -0400] eugenmayer: :)
[2012-05-07 11:15:00 -0400] tomoj: what's the 5%?
[2012-05-07 11:15:06 -0400] tomoj: synchronization stuff?
[2012-05-07 11:17:50 -0400] andreacampi: tomoj: I don't know, that's the point :)
[2012-05-07 11:18:07 -0400] andreacampi: tomoj: well, for Java apps there's plenty of work
[2012-05-07 11:18:27 -0400] andreacampi: tomoj: we should leverage bryanwb's work as much as possible
[2012-05-07 11:20:00 -0400] andreacampi: tomoj: also for other frameworks, there were requests to support apps that don't come out of a repo, e.g. installed via an OS-level package
[2012-05-07 11:20:30 -0400] andreacampi: tomoj: we would still need to manage every other aspect of the deployment, just not the checkout
[2012-05-07 11:20:54 -0400] andreacampi: tomoj: also from my point of view, deploying to PaaS providers is the next logical step
[2012-05-07 11:24:05 -0400] tomoj: I see, thanks
[2012-05-07 11:24:49 -0400] andreacampi: but again, that's just my point of view :)
[2012-05-07 11:26:47 -0400] railsraider: hi I have a script that runs from my computer using knife rackspace list server to generate hosts file,is there a way to run the command on my computer while doing knife cook ?
[2012-05-07 11:34:34 -0400] railsraider: is there a way to do this with knife exec?
[2012-05-07 11:48:29 -0400] Zoubi: hi guys
[2012-05-07 11:49:20 -0400] Zoubi: little question: I have setup a local Ubuntu package repository from which I'd like a virtual machine created using vagrant to install its packages from
[2012-05-07 11:49:57 -0400] Zoubi: the problem is that currently, the repository is not signed, and the apt-get install command fails, because of the -y flag (I suspect, not sure about that)
[2012-05-07 11:55:41 -0400] Zoubi: how can I use my local repository without signing it?
[2012-05-07 11:58:44 -0400] ttgb: Anyone know how to convert/create encrypted data bags when using chef-solo?
[2012-05-07 12:00:59 -0400] raz: are the chef ruby api docs hosted somewhere
[2012-05-07 12:03:19 -0400] BryanWB: raz: y http://rubydoc.info/gems/chef/0.10.8
[2012-05-07 12:03:25 -0400] raz: BryanWB: found it thx
[2012-05-07 12:03:32 -0400] raz: is that linked anywhere in the wiki?
[2012-05-07 12:03:55 -0400] raz: not that it matters, but it should be ;)
[2012-05-07 12:04:53 -0400] eugenmayer: Zoubi: sign it.
[2012-05-07 12:05:14 -0400] BryanWB: raz: fo sho
[2012-05-07 12:06:29 -0400] eugenmayer: Zoubi: otherwise, if you really want to waste your time, have a look at apt -o and the options
[2012-05-07 12:07:02 -0400] railsraider: is there a way to run knife locally to generate a template on my machine along with the knife cook command?'
[2012-05-07 12:08:32 -0400] Zoubi: eugenmayer: isn't it possible to configure ubuntu not to complain about not signed repo?
[2012-05-07 12:08:41 -0400] eugenmayer: #ubuntu
[2012-05-07 12:10:07 -0400] BryanWB: eugenmayer: dude, i ask basic linux questions here all the time
[2012-05-07 12:10:16 -0400] BryanWB: cuz there are so many smart people here ;)
[2012-05-07 12:10:26 -0400] eugenmayer: hehe, that does not make it any better! :)
[2012-05-07 12:11:34 -0400] BryanWB: Zoubi: ask away, would help u if I knew more about ubuntu
[2012-05-07 12:12:50 -0400] eugenmayer: BryanWB: you can ask whatever you want - but i suggest he gets (quicker) help over there
[2012-05-07 12:13:10 -0400] eugenmayer: especially with topics like "how to make this more unsecure" :)
[2012-05-07 12:14:29 -0400] atomic-penguin: eugenmayer, where here, or in #ubuntu?
[2012-05-07 12:14:37 -0400] eugenmayer: #ubuntu :)
[2012-05-07 12:15:51 -0400] raz: anyone know an example/doc how to programmatically fetch a cookbook/role/env in a knife plugin?
[2012-05-07 12:16:08 -0400] raz: looking at knife/cookbook_show it seems i'm about to subclass knife and use rest.get_rest
[2012-05-07 12:17:47 -0400] jnli: how can I configure chef-server to run in a certain context?
[2012-05-07 12:18:14 -0400] Zoubi: eugenmayer: it's for internal use, so the less secure is not such a big deal ;)-
[2012-05-07 12:18:24 -0400] jnli: I have chef-server running in port 4000 and I want to access it through apache proxy, like https://host.com/chef
[2012-05-07 12:19:14 -0400] jnli: It works, but all chef urls are wrong, they are referencing directly to root context instead of /chef -context.
[2012-05-07 12:22:25 -0400] BryanWB: atomic-penguin: hey buddy!
[2012-05-07 12:22:46 -0400] atomic-penguin: BryanWB, hi ho
[2012-05-07 12:23:17 -0400] atomic-penguin: One week 'til chefconf, hells yeah
[2012-05-07 12:24:10 -0400] m0s: hello guys
[2012-05-07 12:24:22 -0400] m0s: is anyone familar with fnichol/chef-rvm cookbook?
[2012-05-07 12:26:27 -0400] m0s: https://gist.github.com/50682b9701dbe993ce57
[2012-05-07 12:27:47 -0400] m0s: when i apply that recipe with that attributers i'm getting
[2012-05-07 12:27:49 -0400] m0s: https://gist.github.com/08872fa21eb9c937e780
[2012-05-07 12:28:36 -0400] m0s: can someone point me, what can be a reason?
[2012-05-07 12:31:49 -0400] m0s: here is a stacktrace https://gist.github.com/e6f447368e753a5df1ac
[2012-05-07 12:37:08 -0400] geekbri: For some strange reason my README.md no longer shows up on my cookbook on the community page.  Anybody have an idea why that might be happening?
[2012-05-07 12:37:13 -0400] geekbri: Its packaged inside the tarball
[2012-05-07 12:38:11 -0400] atomic-penguin: which ckbk?
[2012-05-07 12:40:01 -0400] geekbri: redisio
[2012-05-07 12:41:11 -0400] atomic-penguin: I don't see any reason it wouldn't work.  It does work on github, of course
[2012-05-07 12:41:19 -0400] geekbri: Yeah, thats why I am baffled.
[2012-05-07 12:41:35 -0400] geekbri: But there is no way for me to be able to direct people to the github page since the readme doesn't show up!
[2012-05-07 12:41:41 -0400] atomic-penguin: Probably a community site bug
[2012-05-07 12:42:00 -0400] atomic-penguin: Well, you can add the github link
[2012-05-07 12:42:46 -0400] atomic-penguin: If you go to "Edit cookbook" there is a "website" textbox, add your github link there
[2012-05-07 12:43:50 -0400] geekbri: The things that get displayed are based upon the long descdription right?
[2012-05-07 12:44:49 -0400] geekbri: atomic-penguin: Thanks I updated the website to be a link to github
[2012-05-07 12:45:01 -0400] geekbri: Im still a bit confused as to why the README.md wont display, but what can ya do
[2012-05-07 12:45:37 -0400] atomic-penguin: It probably uses the long description to detect the README, I would guess
[2012-05-07 12:46:02 -0400] geekbri: It does, thats what I am doing.  Whats even strange is that it used to work.
[2012-05-07 12:46:25 -0400] atomic-penguin: It'd be cool if I could drop the URL in the metadata.rb, and auto-link it when uploaded to the community site
[2012-05-07 12:46:42 -0400] geekbri: you might be able to.
[2012-05-07 12:47:31 -0400] geekbri: coderanger: any clue why my readme.md is no longer being displayed on the community.opscode.com site?  Everything seems to be in order:    http://community.opscode.com/cookbooks/redisio
[2012-05-07 12:48:42 -0400] geekbri: atomic-penguin: do you know if there is a way to include the website in the metadata, or will I have to re-edit it every time I upload it to add the website again
[2012-05-07 12:49:37 -0400] atomic-penguin: I don't think there is a way to include the URL in metadata
[2012-05-07 12:49:57 -0400] geekbri: oh well, no biggie
[2012-05-07 12:50:11 -0400] atomic-penguin: It shouldn't clear the URL every time you upload a new version though, either
[2012-05-07 12:50:44 -0400] geekbri: well then, problem solved I guess.  I am a bit sad that the readme doesn't show up, but hopefully people just click through to github.  The readme is displayed nicer there anyway.
[2012-05-07 12:50:58 -0400] atomic-penguin: ikr
[2012-05-07 13:05:51 -0400] railsraider: Hi i have a script that uses knife rackspace server list to generate host files, problem is that gem and backspace config lives on my dev machine and won't run remotely, is there any way i can get the command to run locally and generate the cookbook template for me?
[2012-05-07 13:09:53 -0400] railsraider: so far all i found is knife exec, but it fails to run from a recipe
[2012-05-07 13:11:32 -0400] railsraider:  knife exec -E get_servers.rb ERROR: knife encountered an unexpected error
[2012-05-07 13:11:36 -0400] railsraider: anyone?
[2012-05-07 13:12:20 -0400] geekbri: I missed the question unfortunately.  I haven't had much time to play with knife exec yet though so I fear I may not be overly helpful
[2012-05-07 13:13:20 -0400] railsraider: geekbri: is there a way to run a local script from my dev machine to generate the hosts file while doing knife cook
[2012-05-07 13:13:44 -0400] railsraider: my script basically takes knife rackspace server list and split the output to a host file
[2012-05-07 13:13:53 -0400] andreacampi: railsraider: did you try running it with -VV  ?
[2012-05-07 13:14:22 -0400] railsraider: but it relay on having knife.rb with the api key on the remote machine (and i don't wanna put it there)
[2012-05-07 13:15:29 -0400] railsraider: andreacampi: /Users/admin/chef/cookbooks/hosts/templates/default/get_servers.rb:0:in `run': undefined local variable or method `list' for #<Object:0x10f96f3
[2012-05-07 13:15:44 -0400] railsraider: knife rackspace server list
[2012-05-07 13:16:07 -0400] railsraider: that command works by itself
[2012-05-07 13:16:15 -0400] andreacampi: ?
[2012-05-07 13:16:18 -0400] railsraider: why knife exec doesn't run it
[2012-05-07 13:16:31 -0400] andreacampi: is that the content of your get_servers.rb ?
[2012-05-07 13:16:45 -0400] railsraider: i put that line knife rackspace server list into get_servers.rb
[2012-05-07 13:16:54 -0400] railsraider: doh
[2012-05-07 13:17:03 -0400] railsraider: missing back ticks am i?
[2012-05-07 13:17:25 -0400] andreacampi: I guess so :)
[2012-05-07 13:17:37 -0400] railsraider: haha the little things
[2012-05-07 13:17:53 -0400] andreacampi: yeah :) sometimes just asking the question helps find the answer ;)
[2012-05-07 13:20:11 -0400] railsraider: andreacampi: now i have this line in hosts.erb <% servers = `'knife exec get_servers.rb'` -%> but it complains that not found
[2012-05-07 13:20:21 -0400] railsraider: i think its still looking for knife on the remote sever
[2012-05-07 13:21:04 -0400] railsraider: andreacampi:  sorry again
[2012-05-07 13:21:15 -0400] railsraider: my fault missed a tick
[2012-05-07 13:24:51 -0400] railsraider: andreacampi: the file getservers.rb sits in the templates/default folder where i trigger knife exec but i get No such file or directory - /get_servers.rb
[2012-05-07 13:45:54 -0400] KernelPanik: hi guys!
[2012-05-07 13:47:20 -0400] KernelPanik: I have to add a line in context.xml (tomcat) with my cookbook... how I  do this?
[2012-05-07 13:49:42 -0400] makuk66: typically you'd make the context.xml a template. If you don't want to do that, use the script resource to check if the file has the new line in, and if not, add it, say with vi or perl
[2012-05-07 13:51:40 -0400] KernelPanik: thanks!
[2012-05-07 13:54:39 -0400] spyvsspy: is there anyway to do a boostrap w/o ssh?
[2012-05-07 13:55:29 -0400] withnale: does anyone know where the up-to-date change log is for chef? I've looked at the git repo and CHANGELOG is 2 years old and the newest reference is 0.8.10
[2012-05-07 13:55:31 -0400] spyvsspy: basically, I have techs out in the field, they have an ISO, that I am going to have them DD to the machine; Id like to be able to configure everything remotely, without having to write an install script
[2012-05-07 13:56:29 -0400] eugenmayer: spyvspy: preseed maybe
[2012-05-07 13:56:45 -0400] spyvsspy: well, Im not doing an install, they are just booting to a usb drive, and DD'ing
[2012-05-07 13:57:19 -0400] spyvsspy: i was thinking of having them just edit: /etc/chef/first-boot.json ?
[2012-05-07 13:57:44 -0400] eugenmayer: sorry - no idea. But i think, there is something about that, so it should be possible
[2012-05-07 14:01:14 -0400] jperry2: Does anyone know if chef server supports other db's such as mysql?
[2012-05-07 14:05:04 -0400] yfeldblum: jperry2, it does not; currently, the open-source chef-server is backed by couchdb/solr/rabbitmq, however, opscode is likely in the future to rewrite it to be backed by relationaldb/???/???
[2012-05-07 14:05:41 -0400] jperry2: will 0.10.10 have any of this?
[2012-05-07 14:05:47 -0400] jperry2: or probably something for a 1.0 release
[2012-05-07 14:06:41 -0400] jperry2: probably a question for @btm
[2012-05-07 14:07:03 -0400] jtimberman: jperry2: later this year
[2012-05-07 14:07:11 -0400] jtimberman: jperry2: and it won't be a 0.10.x release.
[2012-05-07 14:07:43 -0400] jperry2: jtimberman: thanks
[2012-05-07 14:07:54 -0400] railsraider: anyone has a cookbook to install mysql 5.5?
[2012-05-07 14:07:55 -0400] jtimberman: our awesome developers are working porting Opscode Hosted and Private Chef from Ruby API endpoints and CouchDB backend for said endpoints over to Erlang + "SQL"
[2012-05-07 14:08:10 -0400] jtimberman: railsraider: mysql cookbook should do so if the package manager has the packages available
[2012-05-07 14:08:12 -0400] geekbri: that sounds like a pretty big task
[2012-05-07 14:08:31 -0400] yfeldblum: geekbri, that's why they're getting paid to do it
[2012-05-07 14:08:32 -0400] jtimberman: jperry2: and "SQL" is going to be either mysql or postgresql, but i don't know the details of what will be in the open source server.
[2012-05-07 14:08:32 -0400] railsraider: the package is not in any repo for ubuntu 10
[2012-05-07 14:08:42 -0400] geekbri: wait, you people get paid by your employers?!?!
[2012-05-07 14:08:44 -0400] jperry2: got it
[2012-05-07 14:08:45 -0400] jperry2: thx
[2012-05-07 14:09:16 -0400] z: geekbri: I sure as sh!t don't scrub the oven for free. Fun tasks like making cocktails, sure!
[2012-05-07 14:09:17 -0400] jtimberman: jperry2: and, sorry that the changelog in the chef repo is not updated, we have "release notes" in the form of blog posts :-|
[2012-05-07 14:09:17 -0400] eugenmayer: geekbri: sure. thats how we make money?
[2012-05-07 14:09:46 -0400] eugenmayer: geekbri: btw. we are looking for employees right now, so if you are interested  -)
[2012-05-07 14:09:55 -0400] jperry2: jtimberman: thanks, do you have a link to them?
[2012-05-07 14:10:50 -0400] railsraider: jtimberman: i have the deb package is there a way to set it up with chef
[2012-05-07 14:11:49 -0400] geekbri: eugenmayer: :-P for now I am happy with my employer.. I'll have to bargain for payment in US currency as opposed to the pocket link and ham sandwiches I had been receiving.  Does though have a link to your open positions.
[2012-05-07 14:12:06 -0400] eugenmayer: Perfect.
[2012-05-07 14:12:34 -0400] eugenmayer: And dont worry about your collegues, just take them with you!
[2012-05-07 14:12:48 -0400] geekbri: Only the good ones right ;)
[2012-05-07 14:12:56 -0400] eugenmayer: no, doesnt matter
[2012-05-07 14:13:10 -0400] eugenmayer: Its basically all about the money, isnt it? ,-)
[2012-05-07 14:13:19 -0400] geekbri: apparently!
[2012-05-07 14:13:22 -0400] jtimberman: railsraider: if you have a deb, stick it on an internal apt repo, make sure that the sources.list/sources.list.d/you.repo is updated and chef will install it.
[2012-05-07 14:13:27 -0400] KernelPanik: ok, I load my context.xml with the cookbook.. but is only for test. In production tomcat is already installed...for modify context.xml I have to use script recource?
[2012-05-07 14:13:28 -0400] jtimberman: you can give it a version if you want to make sure
[2012-05-07 14:13:37 -0400] jtimberman: jperry2: they're on opscode.com/blog
[2012-05-07 14:14:16 -0400] eugenmayer: jtimberman: sounds like there is quiet some difference between the OS chef stack and the hosted / commercial one, right?
[2012-05-07 14:14:22 -0400] geekbri: jtimberman: any idea why a README.md would suddenly stop rendering in the long description of the community site?  Nothing changed in the way its included (copy pasted from the wiki), and it used to display fine.  Also it displays fine on github
[2012-05-07 14:14:28 -0400] jtimberman: http://www.opscode.com/blog/category/release/
[2012-05-07 14:14:39 -0400] jtimberman: jperry2: the release category might be a little better about narrowing them down
[2012-05-07 14:14:52 -0400] jtimberman: i have a folder with bookmarks to each release but its on another computer.
[2012-05-07 14:15:12 -0400] ssd7_: Ohai Chefs!
[2012-05-07 14:15:34 -0400] jperry2: jtimberman: thx
[2012-05-07 14:15:44 -0400] jtimberman: ssd7_: ohai!
[2012-05-07 14:15:55 -0400] jtimberman: ssd7_: appears that denver got seattle's rain from last week.
[2012-05-07 14:17:25 -0400] spyvsspy: what would you guys suggest as an install procedure for a remote server, w/ a tech onsite?
[2012-05-07 14:17:32 -0400] spyvsspy: I can ship a USB drive
[2012-05-07 14:17:56 -0400] ssd7_: jtimberman: Ahh.  Well, Georgia is hot and miserable as usual. :)
[2012-05-07 14:18:16 -0400] spyvsspy: I would like to automate it as much as possible, adn I dont have SSH in;  right now I have an ISO, and am going to have the tech do a dd from the USB to the HD, then I need to configure the machine somehow
[2012-05-07 14:19:16 -0400] yfeldblum: eugenmayer, there are some differences: hosted/private has ACLs; hosted has multitenancy; hosted/private are currently undergoing a rewrite; however, the API is the same
[2012-05-07 14:20:27 -0400] eugenmayer: yfeldblum: as iam a bit new to all this, so thats the concept for money-making (opscode) so code is shared / released from time to time, including the share of the reciepes and all this. Righht?
[2012-05-07 14:21:03 -0400] eugenmayer: (dont get me wrong, sure opscode needs to make money and profit, iam just asking what it is about. Sounds fair enaugh)
[2012-05-07 14:21:12 -0400] KernelPanik: who can help me? :)
[2012-05-07 14:21:44 -0400] ssd7_: KernelPanik: That depends on the question :)
[2012-05-07 14:22:49 -0400] KernelPanik: ssd7_: thanks! I have to modify context.xml.  I should use template resource ,ma tomcat is already installed in my target server
[2012-05-07 14:22:55 -0400] jtimberman: eugenmayer: The biggest difference between Opscode Hosted/Private Chef and Open Source Chef is that Opscode will provide direct support for OHC/OPC, but not open source Chef.
[2012-05-07 14:23:10 -0400] jtimberman: we provide "best effort" support for open source chef server here and on the mailing lists
[2012-05-07 14:24:07 -0400] eugenmayer: jtimberman: yeah, thats clear. I mean, perfectly reasonable. So basically its a support subsciprtion ( i was aware of that and ware, how valueable that will be ). I wasnt aware of the "feature" differences. But hey, you need to also sell your product - no doubt.
[2012-05-07 14:24:12 -0400] jtimberman: the RBAC/ACL system is also a differentiator.
[2012-05-07 14:24:28 -0400] jtimberman: Hosted Chef means you don't have to run anything at all, which is a key feature for a lot of people :)
[2012-05-07 14:24:41 -0400] geekbri: the best feature.
[2012-05-07 14:24:51 -0400] geekbri: When the stack upgrades, I dont have to think about it.  :)
[2012-05-07 14:24:53 -0400] jtimberman: We can build derivative services and features on top of the server seamlessly
[2012-05-07 14:25:20 -0400] afallows: Aw, you guys, but the week I spent spinning up new instances and watching my server install script fail was the best week of my life! Setting up a chef server is a party.
[2012-05-07 14:25:34 -0400] jtimberman: The API handles versioning, so you can upgrade your clients anytime and the API does the right thing.
[2012-05-07 14:25:39 -0400] eugenmayer: jtimberman: due to historicial reasons, iam always interested how the company behind a open-source projects makes money ( the stratigy ). Its clear, that compony needs profit and to be a healthy "constalation" with the OS-Version / Community, i guess it needs some "balance". Always interesting how this happens
[2012-05-07 14:25:41 -0400] jtimberman: like you can use 0.9 and 0.10 clients against Hosted Chef
[2012-05-07 14:26:16 -0400] eugenmayer: jtimberman: for now, there are a lot of projects splitting away from their "commercial" roots. For me, that new "freedome" sometimes also means doom.
[2012-05-07 14:27:21 -0400] geekbri: Certainly, being able to run my own chef server if it came to it, is very important to me... as since its managing my infrastructure, if opscode decided to stop hosting or folded.. i would be boned.  But the hosting they provide is worthwhile.
[2012-05-07 14:27:24 -0400] eugenmayer: i guess, e.g. meineerde from chiliproject has some thoughts on that, but also Babar from Foswiki and there are a lot more projects with those issues in the past jtimberman.
[2012-05-07 14:27:59 -0400] ssd7_: KernelPanik: Seems like a template resource would make sense there
[2012-05-07 14:28:25 -0400] eugenmayer: geekbri: yeah, very reasonable. I think a lot of us are going to pay for good services and need "possible idependence" in cases of a exit-strategy
[2012-05-07 14:29:21 -0400] yfeldblum: wonder if the strategy isn't: (1) sell open-source chef to engineers at large enterprises (2) engineers sell hosted/private chef to their managers at large enterprises; (3) profit
[2012-05-07 14:29:54 -0400] spyvsspy: that strategy wouldnt work, because of 2
[2012-05-07 14:29:55 -0400] spyvsspy: lol
[2012-05-07 14:30:33 -0400] geekbri: I think the plan is. 1) make a good product with a good community  2) Generate profit
[2012-05-07 14:30:34 -0400] spyvsspy: but, thats basically what happened at my work;  I was sold on open-source chef, in the process of implementing it;  know that there is no way in hell they would pay for hosted version unfortunately
[2012-05-07 14:30:34 -0400] geekbri: :-P
[2012-05-07 14:30:56 -0400] afallows: Hey, could anyone point me to examples of using the Chef Server REST API in a Ruby app?
[2012-05-07 14:31:01 -0400] jtimberman: geekbri: ;)
[2012-05-07 14:31:15 -0400] hoover_damn: afallows, knife?
[2012-05-07 14:31:17 -0400] jtimberman: afallows: you might be interested in danryan's spice
[2012-05-07 14:31:30 -0400] railsraider: anyone had luck installing arno-iptables-firewall with chef?
[2012-05-07 14:31:45 -0400] railsraider: it has an annoying wizard that breaks installation
[2012-05-07 14:31:46 -0400] afallows: hoover_damn, jtimberman: Thanks, I'll go exploring.
[2012-05-07 14:32:36 -0400] spyvsspy: afallows, what are you trying to do?
[2012-05-07 14:33:21 -0400] geekbri: railsraider: are you using ubuntu/debian?  Usually you can use debconf to avoid interactive installers
[2012-05-07 14:33:32 -0400] spyvsspy: I am in the process of developing a rails app, that will allow people to "configure a machine" (IP, hostname etc), and have the machine set itself up
[2012-05-07 14:33:33 -0400] railsraider: yes ubuntu
[2012-05-07 14:33:45 -0400] afallows: spyvspy: I'm developing a web app which is going to integrate data from the Chef Server and my team's AWS instances to put an interface on top of our deployment process.
[2012-05-07 14:34:04 -0400] railsraider: geekbri: do you know how?
[2012-05-07 14:34:15 -0400] spyvsspy: cool, basically doing the same thing then
[2012-05-07 14:34:20 -0400] afallows: My team lead wants a Big Red Button (TM) to deploy things instead of using knife.
[2012-05-07 14:34:41 -0400] geekbri: railsraider: look into debconf-set-selections
[2012-05-07 14:34:51 -0400] spyvsspy: right, I dont have the luxury of using AWS, it has been kind of a struggle
[2012-05-07 14:34:57 -0400] railsraider: geekbri: thank you!
[2012-05-07 14:34:59 -0400] geekbri: railsraider: np
[2012-05-07 14:35:31 -0400] spyvsspy: I cant figure out how to take the webapp output, and get it installed onto the server
[2012-05-07 14:35:51 -0400] afallows: It's nice using AWS on someone else's dime. I was disappointed when I did the math and confirmed that they don't really have an inexpensive option for personal use.
[2012-05-07 14:35:58 -0400] spyvsspy: other than writing a first run recipe, but then you have to prorammatically write that every time
[2012-05-07 14:36:10 -0400] geekbri: Hrm, does anybody know if its possible to log if you are in compile time or execution time from a cookbook ?
[2012-05-07 14:37:52 -0400] yfeldblum: geekbri, what's the use-case?
[2012-05-07 14:38:26 -0400] geekbri: yfeldblum: my coworker asked me if I knew how and I said "nope!" and thought it sounded like an interesting questin
[2012-05-07 14:41:36 -0400] LinuxHorn: ...
[2012-05-07 14:43:46 -0400] geekbri: I can imagine the use case would be, if you think you are doing something during one phase, but you suspect or it seems it is happening during another
[2012-05-07 14:43:47 -0400] yfeldblum: geekbri, a sub-recipe-scope can be in execution time when its containing recipe-scope is in compile time
[2012-05-07 14:44:23 -0400] geekbri: oh hrm, i see.
[2012-05-07 14:44:39 -0400] geekbri: Yes that makes sense to me.
[2012-05-07 14:46:55 -0400] yfeldblum: geekbri, however, this to me smells of a confusion w.r.t. how chef works ...
[2012-05-07 14:47:41 -0400] geekbri: Perhaps, I didn't really have time to look at what he was working on.  He's pretty competent on the workflow usually.
[2012-05-07 14:47:53 -0400] geekbri: I just thought to myself, it might be interesting to be able to report what phase something was in.
[2012-05-07 14:49:35 -0400] railsraider: if i do cookbook_file "mysql-5.5.23-debian6.0-x86_64.deb"  does it look under files/default for this cookbook for the file?
[2012-05-07 14:51:31 -0400] yfeldblum: railsraider, usually
[2012-05-07 14:52:29 -0400] LinuxHorn_: in chef training with mattray while on the #chef channel on irc...  my mind is officially blown
[2012-05-07 14:52:53 -0400] railsraider: yfeldblum:  I'm trying this http://pastebin.com/ZRMA3Mb2 and get error: Chef::Exceptions::Exec: dpkg -i mysql-5.5.23-debian6.0-x86_64.deb returned 1, expected 0
[2012-05-07 14:53:06 -0400] railsraider: the file is in files/default
[2012-05-07 14:53:11 -0400] railsraider: of that cookbook
[2012-05-07 14:56:07 -0400] jtimberman: LinuxHorn_: :D
[2012-05-07 14:59:09 -0400] yfeldblum: railsraider, the cookbook_file resource is named wrong (should be the full filesystem path where the file should be copied to); the package resource is named wrong (should be the name of the package), and the package resource's source attribute is wrong (probably should be the full filesystem path where the .deb is copied to)
[2012-05-07 15:00:27 -0400] geekbri: Oh #chefconf is on isn't it.
[2012-05-07 15:00:30 -0400] geekbri: sad I could not go.
[2012-05-07 15:01:05 -0400] railsraider: k thanks yfeldblum
[2012-05-07 15:01:19 -0400] siezer: geekbri that's next week
[2012-05-07 15:01:49 -0400] geekbri: oh, I was close :)
[2012-05-07 15:02:31 -0400] afallows: jtimberman: Thanks for the pointer to Spice, it's about exactly what I needed. It seems to not like my SSH key file, though. Have you run into an issue there?
[2012-05-07 15:06:54 -0400] jtimberman: afallows: i've not actually used spice
[2012-05-07 15:40:50 -0400] TheBeast: is it possible to create a hash from a Chef::DataBagItem type?
[2012-05-07 15:42:05 -0400] TheBeast: ex. mynodes = Chef::DataBagItem.load('mydatabag', each [:hostname]) returns n nodes
[2012-05-07 15:47:01 -0400] hoover_damn: TheBeast, data bags are json
[2012-05-07 15:47:10 -0400] hoover_damn: store them approrpiately and they will inflate correctly
[2012-05-07 15:47:16 -0400] hoover_damn: or 'load'
[2012-05-07 15:48:55 -0400] Frear: hey, before I go rewriting the ubuntu bootstrap script, is there a branch that's setup to work with ubuntu 12.04?
[2012-05-07 15:49:03 -0400] TheBeast: hoover_damn what I'm doing is to search for nodes with a specific role and then fetch some info from my databag pertinent to those two nodes
[2012-05-07 15:49:28 -0400] flashmanbahadur: Frear: someone submitted a pull request for a 12.04 bootstrap
[2012-05-07 15:49:41 -0400] TheBeast: the thing is I need to correlate the info returned from the databag with some attributes
[2012-05-07 15:49:55 -0400] TheBeast: then take each pair of data and populate a template with it
[2012-05-07 15:49:55 -0400] hoover_damn: TheBeast, Chef::DataBagItem.load("bag",item['hash'])
[2012-05-07 15:50:12 -0400] Frear: I'll see if I can find it, thanks flash
[2012-05-07 15:50:17 -0400] TheBeast: hmm, I'll give it a try
[2012-05-07 17:02:08 -0400] flashmanbahadur: anyone else have issues with the "enable" action on ubuntu 12.04?
[2012-05-07 17:02:22 -0400] flashmanbahadur: I am seeing some weirdness with chkconfig failing
[2012-05-07 17:02:36 -0400] flashmanbahadur: throws this error: /sbin/insserv: No such file or directory
[2012-05-07 17:02:58 -0400] flashmanbahadur: guessing its related to my services not working with the [:enable] action
[2012-05-07 17:10:04 -0400] Brad_K: flashmanbahadur: when was 12.04 shipped?  isn't that pretty new?
[2012-05-07 17:10:16 -0400] flashmanbahadur: 27th of april
[2012-05-07 17:11:23 -0400] Brad_K: about a week-and-a-half old?  yeah, i would not be surprised at all if there were a variety of minor issues with it and any other code out there  including Chef, Ruby, Ruby gems, etc...
[2012-05-07 17:12:01 -0400] yfeldblum: Brad_K, nvidia drivers ...
[2012-05-07 17:12:02 -0400] Brad_K: it takes a while to iron out these kinds of things with any new release of an OS.
[2012-05-07 17:12:19 -0400] flashmanbahadur: i figured
[2012-05-07 17:12:29 -0400] flashmanbahadur: trying to see how I can force service startup again
[2012-05-07 17:12:35 -0400] flashmanbahadur: looks like upstart is the new hotness
[2012-05-07 17:13:08 -0400] yfeldblum: hoover_damn, TheBeast, should probably use the `data_bag` and `data_bag_item` recipe dsl methods for fetching data bags and data bag items by name
[2012-05-07 17:13:09 -0400] Brad_K: that's not to say that you shouldn't try it, just that if you want to be on the bleeding edge, well, you can expect to do a little more bleeding than might otherwise be normal.  ;-)
[2012-05-07 17:13:21 -0400] flashmanbahadur: haha
[2012-05-07 17:13:36 -0400] hoover_damn: yfeldblum, conversation is with TheBeast... not me
[2012-05-07 17:13:39 -0400] hoover_damn: thanks though
[2012-05-07 17:14:08 -0400] hoover_damn: TheBeast, then Chef:DataBagItem.load('myitem',node.roles.first)?
[2012-05-07 17:17:52 -0400] flashmanbahadur: so much weirdness, works for nginx installed via apt-get
[2012-05-07 17:18:08 -0400] flashmanbahadur: but not for a program with a custom init.d script
[2012-05-07 17:18:38 -0400] flashmanbahadur: nevermind
[2012-05-07 17:18:57 -0400] flashmanbahadur: it always fails when it has to attempt to change the state of a service
[2012-05-07 17:19:04 -0400] flashmanbahadur: on, off, setting the runlevels etc
[2012-05-07 17:20:21 -0400] Brad_K: for my part, if the new default is upstart, then i would work to make all of my startup scripts compliant with the new standard.  and yes, that would probably mean massive changes to a lot of the recipes & cookbooks.  ;-(
[2012-05-07 17:21:36 -0400] shuvo: ohai chef gurus!
[2012-05-07 17:21:37 -0400] shuvo: if I use the ohai plugin cookbook, will I be able to pass/override values to attributes in my ohai plugin just like I can do to my normal recipes? (i,e, treat my ohai plugin just like any other "normal recipe"?)
[2012-05-07 17:22:58 -0400] jessicab: flashmanbahadur - i havent tested enabling/disabling, but restarting services is working fine for me in 12.04
[2012-05-07 17:25:51 -0400] flashmanbahadur: jessicab: restarting works for me as well
[2012-05-07 17:25:52 -0400] miah: upstart is still awful though
[2012-05-07 17:26:00 -0400] miah: i always add support for runit to my cookbooks
[2012-05-07 17:26:19 -0400] flashmanbahadur: i think I can get away with just manually linking the script into the appropriate location
[2012-05-07 17:38:50 -0400] rabidpraxis7: I just made a comment on the site for the application cookbook, but it looks like the version that knife is pulling down does not include the LWRP stuffs. I had to pull the cookbook from github to get it to work with application_ruby
[2012-05-07 17:40:55 -0400] paulmooring: shuvo: Ohai would set a higher precedence than attributes, so you wouldn't want to use Ohai plugins if there's a chance you want to over ride those values later
[2012-05-07 17:41:52 -0400] paulmooring: Ohai should be used to gather data from the system that wouldn't really be dependent on anything in the cookbook (things like IP Address or FQDN shouldn't ever need an 'if')
[2012-05-07 17:42:56 -0400] mehlah: how often 'chef-client' runs on nodes ?
[2012-05-07 17:43:14 -0400] mehlah: I mean, automagically, by default
[2012-05-07 17:44:03 -0400] miah: 30 minutes, 5 splay
[2012-05-07 17:44:12 -0400] miah: iirc
[2012-05-07 17:44:34 -0400] mehlah: miah is there a setting somewhere for that ?
[2012-05-07 17:44:48 -0400] miah: automatic_attributes?
[2012-05-07 17:44:55 -0400] paulmooring: mehlah: -i for intercal -s for splay
[2012-05-07 17:45:01 -0400] paulmooring: interval that is
[2012-05-07 17:45:05 -0400] miah: http://wiki.opscode.com/display/chef/Automatic+Attributes
[2012-05-07 17:45:10 -0400] yfeldblum: rabidpraxis7, the refactored application cookbook is not yet released
[2012-05-07 17:45:15 -0400] miah: derp. not the right page
[2012-05-07 17:45:36 -0400] paulmooring: or just 'interval' and 'splay' in the client.rb config file
[2012-05-07 17:45:37 -0400] mehlah: thanks paulmooring miah
[2012-05-07 17:45:43 -0400] miah: http://wiki.opscode.com/display/chef/Chef+Configuration+Settings
[2012-05-07 17:45:45 -0400] miah: there you go
[2012-05-07 17:48:09 -0400] setient: miah: what was that installer for chef that included ruby?  unified or something?
[2012-05-07 17:48:21 -0400] rabidpraxis7: yfeldblum: ah, ok. I guess the deprecated note is only on the github version. Noted.
[2012-05-07 17:48:57 -0400] paulmooring: setient: The omnibus? http://www.opscode.com/chef/install
[2012-05-07 17:49:42 -0400] setient: thnx!
[2012-05-07 17:50:28 -0400] mehlah: Why when deleting a server with knife, the client list and node list arn't updated ? I remove manually the client and the node. I'm wrong ?
[2012-05-07 17:51:26 -0400] mehlah: knife node delete xxx shouldn't be triggered after a node client delete or server delete ?
[2012-05-07 17:51:52 -0400] Brad_K: mehlah: for now at least, those things are separate.
[2012-05-07 17:52:14 -0400] mehlah: Okay Brad_K ;)
[2012-05-07 17:52:30 -0400] mehlah: wasn't sure about what I'm doing
[2012-05-07 17:52:35 -0400] paulmooring: mehlah: I'm not entirely sure what you mean by server delete but 'knife node delete $name' and 'knife client delete $name' are the 2 commands to run and it should update the lists
[2012-05-07 17:53:21 -0400] Brad_K: paulmooring: yeah, but there's a third command that will depend on your infrastructure.  For us, it's "knife rackspace server delete "
[2012-05-07 17:53:29 -0400] Brad_K: and each of those three commands are separate.
[2012-05-07 17:54:18 -0400] Brad_K: it would be nice if there was a single "knife purge " command that could do all three at once.
[2012-05-07 17:54:27 -0400] paulmooring: Brad_K: Good point I was only thinking in terms of clearing out the Chef Server, not cleaning up potential vm instances
[2012-05-07 17:58:21 -0400] qhartman: I have an external command I would like to execute in a recipe to test the state of a service and make a decision in the recipe based on that state. It looks like the "execute" resource won't work for what I want to do because it raises an exception if the return value isn't what it expects. Do I need to use script, or is there a better resource for this sort of thing?
[2012-05-07 17:59:05 -0400] shuvo: qhartman, would it help if you had the ablity to change the runlist of the node based on some conditions?
[2012-05-07 17:59:40 -0400] miah: qhartman: you can do that
[2012-05-07 18:00:26 -0400] qhartman: shuvo, unfortunately not
[2012-05-07 18:00:38 -0400] shuvo: paulmooring, thanks: I would like to set the IP Address reported by ohai for a box for a specific interface that can change accross nodes. WIthout changing the default route, could I pass the interface name to my ohai plugin as an attribute?
[2012-05-07 18:01:15 -0400] qhartman: essentially, I want to set a variable in the recipe based upon whether or not this command succeeds.
[2012-05-07 18:01:32 -0400] akraut: miah: I let chef-expander run overnight with the debug log level and I've seen it process two messages from the queue. there are now 678 ready. :-/
[2012-05-07 18:01:58 -0400] miah: qhartman: https://gist.github.com/2629339
[2012-05-07 18:02:40 -0400] miah: if that execute fails for some reason. it won't execute that notify
[2012-05-07 18:03:26 -0400] qhartman: and it also will not raise an exception?
[2012-05-07 18:03:59 -0400] paulmooring: shuvo: So your nodes have multiple IPs and you just want to set which one shows up as node[:ipaddress]?
[2012-05-07 18:04:08 -0400] miah: akraut: you've consulted http://wiki.opscode.com/display/chef/Chef+Indexer ?
[2012-05-07 18:04:19 -0400] miah: qhartman: hrm? in which way?
[2012-05-07 18:04:34 -0400] shuvo: paulmooring, correct!
[2012-05-07 18:04:50 -0400] qhartman: if the execute fails it, will it raise an exception in chef?
[2012-05-07 18:04:53 -0400] ubercore: I'm running into a weird situation where chef seems to be keeping a connection to template1 open when creating multiple database -- subsequent database ops fail because template1 has open sessions
[2012-05-07 18:05:08 -0400] shuvo: AFAIK, node[:ipaddress] is an automatic attrib and cannot be overriden except by an ohai plugin
[2012-05-07 18:05:13 -0400] ubercore: question is, is there a way to tell chef to release its session between database creations?
[2012-05-07 18:06:39 -0400] hoover_damn: paulmooring, use node[:network]
[2012-05-07 18:06:40 -0400] hoover_damn: instead
[2012-05-07 18:06:41 -0400] miah: qhartman: you can pass it a expected return value
[2012-05-07 18:06:42 -0400] miah: http://wiki.opscode.com/display/chef/Resources#Resources-Execute
[2012-05-07 18:06:48 -0400] hoover_damn: paulmooring, ohai[:ipaddress] only lists the first
[2012-05-07 18:07:02 -0400] paulmooring: shuvo: what hoover_damn said
[2012-05-07 18:07:35 -0400] qhartman: miah, right, but I don't know the expected return value. If it returns "0" I want to set my variable to A, if it returns "1" I want to set it to B.
[2012-05-07 18:07:44 -0400] paulmooring: All the ipaddress are under network (I'll find the full path can't remember off hand) the ipaddress attribute is just a best guess about the primary IP
[2012-05-07 18:08:09 -0400] akraut: miah: At this point I'm not sure what I'm looking for. expanderctl node-status shows no processes running. queue-status hangs indefinitely.
[2012-05-07 18:08:11 -0400] shuvo: hoover_damn, give me a moment to check out a node attribute set, but I remember node[:network] to be a nested hash
[2012-05-07 18:08:35 -0400] shuvo: many infochips rcps use node[:ipaddress
[2012-05-07 18:08:52 -0400] miah:  doesn't mean they are right
[2012-05-07 18:09:22 -0400] paulmooring: something like node['network']['interfaces']['eth1']['addresses']
[2012-05-07 18:09:28 -0400] qhartman: miah, ah, looks like if I combine the :notifies with ignore_failure I can get it to do what I want. Thanks for hte pointers!
[2012-05-07 18:09:39 -0400] miah: qhartman: sure
[2012-05-07 18:09:51 -0400] ubercore: Is there some way to call the "close" method on the Postgresql Provider directly?
[2012-05-07 18:11:55 -0400] daaaan: can the git scm provider do a regular git checkout where the repository doesn't end up headless? basically just git clone then git checkout `existing-branch-name`
[2012-05-07 18:12:29 -0400] daaaan: i'm not seeing anywhere in the chef code base where it would end up like this
[2012-05-07 18:13:14 -0400] hoover_damn: paulmooring, ideally yep
[2012-05-07 18:13:25 -0400] daaaan: ends up with head at the last commit from master, but it's on the 'deploy' branch
[2012-05-07 18:14:18 -0400] ubercore: daaaan: not sure you can, but why is that an issue?
[2012-05-07 18:20:52 -0400] shuvo: paulmooring, hoover_damn, here's the question: if I write a ohai plugin that sets node[:ipaddress] = node['network']['interfaces'][YEP_THIS_ONE]['addresses']. Could I pass the value of YEP_THIS_ONE as an overriding attribute in the ohai plugin rcp?
[2012-05-07 18:21:25 -0400] shuvo: (and have the ohai plugin honour that assignment?)
[2012-05-07 18:21:28 -0400] ubercore: Ok, more general question. Is there a way to access the resource instance that was used in a recipe?
[2012-05-07 18:21:42 -0400] yfeldblum: shuvo, no, ohai runs before cookbooks get loaded
[2012-05-07 18:21:49 -0400] paulmooring: shuvo: I would do that as an attribute rather than an ohai plugin
[2012-05-07 18:22:36 -0400] paulmooring: or if you're looking for an IP on a particular subnet make an ohai plugin that provides node['myapp_ip'] or whatever you want to call it
[2012-05-07 18:22:47 -0400] paulmooring: then just search for the right subnet
[2012-05-07 18:23:15 -0400] yfeldblum: ubercore, yes, you can query the current run-context for resources via `resources("type[name]")` or `resources(:type => name)`
[2012-05-07 18:24:09 -0400] ubercore: Ahh, cool. Thanks. I'm going to try calling "close" between database creation steps on the resource directly. Seems hackish, but I can't think of any other way to avoid this error
[2012-05-07 18:24:17 -0400] yfeldblum: e.g. `resources("service[postgres]")` or `resources(:service => "postgres")`
[2012-05-07 18:24:38 -0400] yfeldblum: ubercore, what postgresql provider?
[2012-05-07 18:24:50 -0400] mvisich: Hello, Had a question about chef. IS there a way in the recipie to check if the file on the server is newer than the one that is currently on the client?
[2012-05-07 18:25:12 -0400] yfeldblum: mvisich, what's the use-case?
[2012-05-07 18:25:37 -0400] ubercore: yfeldblum: Chef::Provider::Database::Postgresql
[2012-05-07 18:25:40 -0400] mvisich: as in I dont want to restart a service unless I get a new config.
[2012-05-07 18:26:00 -0400] ubercore: It's holding on to connections to template1, which is preventing me from creating databases in a chef run
[2012-05-07 18:26:45 -0400] flashmanbahadur: mvisich:
[2012-05-07 18:26:50 -0400] flashmanbahadur: use the template block
[2012-05-07 18:26:54 -0400] flashmanbahadur: it does a hash of the file
[2012-05-07 18:27:00 -0400] flashmanbahadur: if it is different
[2012-05-07 18:27:10 -0400] flashmanbahadur: the one from the chef server is downloaded and put into place
[2012-05-07 18:27:11 -0400] flashmanbahadur: use
[2012-05-07 18:27:13 -0400] yfeldblum: ubercore, that doesn't sound like it's part of chef; is it from some cookbook?
[2012-05-07 18:27:36 -0400] ubercore: yfeldblum: it's from the database cookbook (https://github.com/opscode-cookbooks/database/blob/master/libraries/provider_database_postgresql.rb)
[2012-05-07 18:27:51 -0400] flashmanbahadur: notifies :restart, "service[your-service]"
[2012-05-07 18:28:06 -0400] ubercore: ahh, hah. there's an update fixing my exact problem
[2012-05-07 18:28:11 -0400] flashmanbahadur: then it will perform your notification any time it has to template the file
[2012-05-07 18:28:15 -0400] ubercore: nm, it's a problem with that cookbook I think
[2012-05-07 18:28:24 -0400] ubercore: thanks for asking the questions that forced me to figure that out :)
[2012-05-07 18:28:42 -0400] ubercore: https://github.com/opscode-cookbooks/database/commit/db7adba97b03123128cc5961767230132ed00ac2
[2012-05-07 18:28:47 -0400] mvisich: does it do the same thing with the file? section?
[2012-05-07 18:28:53 -0400] mvisich: but thanks for the help so far
[2012-05-07 18:29:34 -0400] mvisich: aka does it check the hash of the cookbook_file as well?
[2012-05-07 18:30:51 -0400] flashmanbahadur: mvisich: check out my redis prep script
[2012-05-07 18:30:52 -0400] flashmanbahadur: https://gist.github.com/2629495
[2012-05-07 18:30:58 -0400] flashmanbahadur: its not a perfect cookbook
[2012-05-07 18:31:07 -0400] flashmanbahadur: but itll give you a good example for templating a config can work
[2012-05-07 18:31:45 -0400] flashmanbahadur: "file" should work the same way, it just doesnt run Erubis against it
[2012-05-07 18:31:58 -0400] mvisich: got yah
[2012-05-07 18:32:15 -0400] mvisich: thanks for the help! I think i'll just change my file into a template
[2012-05-07 18:32:24 -0400] flashmanbahadur: careful with that
[2012-05-07 18:32:37 -0400] mvisich: ..which it should be to begin with...
[2012-05-07 18:32:39 -0400] flashmanbahadur: i have had issues with bash scripts and some other things being weird when run through Erubis
[2012-05-07 18:32:47 -0400] flashmanbahadur: but if it needs to be dynamically generated
[2012-05-07 18:32:49 -0400] flashmanbahadur: go for tempalte
[2012-05-07 18:32:51 -0400] flashmanbahadur: *template
[2012-05-07 18:33:05 -0400] mvisich: more of less just need that hash check
[2012-05-07 18:33:08 -0400] mvisich: or*
[2012-05-07 18:33:45 -0400] yfeldblum: ubercore, that provider looks like every action closes the connection
[2012-05-07 18:33:50 -0400] shuvo: paulmooring, hoover_damn, yfeldblum: thank you for the responses. Does this mean that an ohai plugin cannot be passed attributes during a chef run (i.e. I cannot have an ohai plugin change its behavior depending on the presence/absence of a role etc)?
[2012-05-07 18:34:07 -0400] ubercore: yfeldblum: it does at 1.2, but 1.1 (what I was running) leaves the connection open in some instances
[2012-05-07 18:34:08 -0400] yfeldblum: shuvo, that's correct
[2012-05-07 18:34:17 -0400] yfeldblum: ubercore, upgrade?
[2012-05-07 18:34:24 -0400] ubercore: yeah, doing that now
[2012-05-07 18:34:37 -0400] paulmooring: shuvo: That is correct ohai plugins are not meant to be used that way, but attributes are
[2012-05-07 18:35:00 -0400] yfeldblum: shuvo, what's the overall goal?
[2012-05-07 18:35:20 -0400] daaaan: 14:14 < ubercore> daaaan: not sure you can, but why is that an issue?
[2012-05-07 18:35:20 -0400] shuvo: yfeldblum, I had that feelign too as ohai runs *before* a chef run and hence roles are too late to affect it. That's why I did not want to waste time testing my idea out but bugged you guys on IRC
[2012-05-07 18:35:30 -0400] daaaan: i'm using it for deploying everything into a vagrant box for our developers
[2012-05-07 18:35:45 -0400] daaaan: so the branch state has to be consistent with what they'd have if they pulled it normally
[2012-05-07 18:35:50 -0400] daaaan: so they can push commits
[2012-05-07 18:36:14 -0400] shuvo: yfeldblum, the overall goal is to be able to set node[:ipaddress] = node['network']['interfaces'][YEP_THIS_ONE]['addresses']
[2012-05-07 18:36:14 -0400] ubercore: daaaan: you may have to just use execute then
[2012-05-07 18:36:23 -0400] daaaan: ah
[2012-05-07 18:36:32 -0400] ubercore: I think the git/scm provider will always to the checkout to a "deploy" branch
[2012-05-07 18:36:33 -0400] daaaan: you have any idea where this code is? i'm not seeing anything that modifies the cloned copy
[2012-05-07 18:37:28 -0400] ubercore: daaaan: chef/lib/chef/provider/git.rb
[2012-05-07 18:37:31 -0400] ubercore: check there
[2012-05-07 18:37:51 -0400] daaaan: ah ha
[2012-05-07 18:37:54 -0400] daaaan: i was looking at the resource
[2012-05-07 18:38:03 -0400] daaaan: adn then the deploy resource, haha
[2012-05-07 18:38:54 -0400] daaaan: oh wait, i saw this earlier
[2012-05-07 18:38:58 -0400] daaaan: just missed L131
[2012-05-07 18:39:00 -0400] daaaan: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/git.rb#L131
[2012-05-07 18:39:14 -0400] yfeldblum: shuvo, why?
[2012-05-07 18:40:31 -0400] yfeldblum: shuvo, the purpose of ohai is to gather universal facts about your node so that they can be made available for querying, as well as so that they can be made available to recipes ... your recipe can absolutely pick out its favorite interface, but why do you need to set `node[:ipaddress]`?
[2012-05-07 18:42:04 -0400] shuvo: yfeldblum, good question. that's because some cookbooks (not written by me) use node[:ipaddress], which might be incorrect for vagrant provisioned nodes and instead of forking those cookbooks, I would rather add a new plugin/rcp to "correct" node[:ipaddress]
[2012-05-07 18:42:57 -0400] yfeldblum: shuvo, why not change the vagrant provisioning?
[2012-05-07 18:43:08 -0400] shuvo: what do you mean?
[2012-05-07 18:43:39 -0400] yfeldblum: shuvo, why not tell vagrant to create the VM how you would like it created, i.e., with the right interfaces in the right positions?
[2012-05-07 18:44:37 -0400] daaaan: yeah, i haven't had to do that stuff
[2012-05-07 18:44:41 -0400] daaaan: eth0 is always the NAT adapter
[2012-05-07 18:44:53 -0400] daaaan: eth[1-9] is whatever else i've assigned
[2012-05-07 18:45:06 -0400] shuvo: yfeldblum, good suggestion: the answer being I don't know how to do that! At the very least it would require me to run a new script that would correct the default routes. eth0 on VirtualBox is usually a host only interface
[2012-05-07 18:45:20 -0400] daaaan: though if the mac address changes all the adapters will shift at least one, so you'll end up with eth2 and eth3 isntead of eth0 and eth1
[2012-05-07 18:45:41 -0400] shuvo: daaaan, exactly
[2012-05-07 18:45:54 -0400] daaaan: how many host only interfaces do you need?
[2012-05-07 18:46:12 -0400] daaaan: if you leave eth0 as your NAT/outbound interface you can do all this without any extra config
[2012-05-07 18:48:42 -0400] shuvo: daaaan, you are sure that would work on vagrant?
[2012-05-07 18:49:50 -0400] shuvo: my understanding is that eth0 on vagrant/VirtualBox is usually a host only interface and that assumption is made for things like 'vagrant ssh', 'vagrant provision' etc to work
[2012-05-07 18:51:01 -0400] shuvo: another question for you all: this discussion brings up another question for all you chef gurus: consider a popular cookbook(s) that's updated regularly that does not conform to your infrastructure. In this case which path would you take:
[2012-05-07 18:51:06 -0400] shuvo: 1. keep the cookbook as it is and add your own recipes around it so that the assumptions made by the stock cookbook remains correct
[2012-05-07 18:51:11 -0400] shuvo: 2. fork the cookbook and keep on merging the new changes and deal with hassle if the cookbooks are rewirtten/rearchitectured later (which might require you to undo your own changes)
[2012-05-07 18:52:31 -0400] yfeldblum: shuvo, depends on context - it's going to be a different decision each time because the surrounding context is going to be different each time
[2012-05-07 18:53:25 -0400] yfeldblum: however, this is why i prefer cookbooks which export definitions/libraries/resources/providers
[2012-05-07 18:54:48 -0400] stphung: q: is there a way to setup a machine such that it will self bootstrap into a chef server when started?
[2012-05-07 18:55:17 -0400] shuvo: stphung, depends where that machine is hosted. EC2 for you?
[2012-05-07 18:55:26 -0400] stphung: yea
[2012-05-07 18:55:34 -0400] shuvo: tried omnibus?
[2012-05-07 18:55:40 -0400] daaaan: shuvo: nope, eth0 is a NAT interface
[2012-05-07 18:55:41 -0400] stphung: I'm not aware of that
[2012-05-07 18:56:36 -0400] daaaan: which is why you have to forward ports to the vm (vagrant handles that for you)
[2012-05-07 18:57:17 -0400] shuvo: daaaan, ahh so eth0 on vagrant/VirtualBox is a NAT interface. that still does not help me as I would need a bridges interface (so it can be reached from other machines)
[2012-05-07 18:57:37 -0400] daaaan: what are you trying to do?
[2012-05-07 18:58:05 -0400] shuvo: daaaan, have my own cloud using vagrant basically
[2012-05-07 18:58:21 -0400] shuvo: I want to be able to do hadoop, flume, etc
[2012-05-07 18:58:42 -0400] shuvo: I already am doing chef and flume on my vagrant boxes
[2012-05-07 18:58:44 -0400] flashmanbahadur: on the issue of the :enable block not working, manually linking the files into place seems to be fine, ill keep investigating
[2012-05-07 18:58:52 -0400] shuvo: but it requred mne to modify the stock cookbooks a bit
[2012-05-07 18:58:57 -0400] daaaan: then why not add dhcp bridged interfaces?
[2012-05-07 18:59:50 -0400] shuvo: indeed, I *have* to add dhcp bridged interfaces to all my vagrant boxes for all of this to work but it requred me to modify the stock cookbooks a bit so that they used the bridged interface IP
[2012-05-07 19:00:01 -0400] daaaan: gotcha, so they're binding to eth0
[2012-05-07 19:00:33 -0400] daaaan: you could modify the vm config so eth0 is bridged and eth1 is the nat adapter
[2012-05-07 19:00:53 -0400] shuvo: daaaan, uhm not eth0, but node[:ipaddress], which turns out to be the eth0 ip
[2012-05-07 19:01:02 -0400] daaaan: ah
[2012-05-07 19:01:06 -0400] daaaan: so even that wouldn't fix it :/
[2012-05-07 19:01:20 -0400] shuvo: daaaan, that sounds lovely. where do I learn more about that?
[2012-05-07 19:01:33 -0400] shuvo: "you could modify the vm config so eth0 is bridged and eth1 is the nat adapter"
[2012-05-07 19:01:57 -0400] shuvo: lemme look at my Vagrantfile
[2012-05-07 19:04:44 -0400] shuvo: https://gist.github.com/f189d3aace65ce15e8eb
[2012-05-07 19:07:28 -0400] shuvo: updated https://gist.github.com/f189d3aace65ce15e8eb
[2012-05-07 19:07:39 -0400] shuvo: Vagrantfile + ifconfig -a output
[2012-05-07 19:08:38 -0400] shuvo: would *love* to swap eth0 for eth1
[2012-05-07 19:23:08 -0400] bean: Is there a best method of installing chef server on ubuntu 12.04
[2012-05-07 19:23:21 -0400] bean: and using knife to bootstrap clients
[2012-05-07 19:23:22 -0400] bean: ?
[2012-05-07 19:24:14 -0400] shuvo: bean, install wheer on EC2?
[2012-05-07 19:24:24 -0400] shuvo: bean, install where, on EC2?
[2012-05-07 19:24:53 -0400] bean: where doesn't matter. It's a base ubuntu 12.04 and I want to install chef server on it.
[2012-05-07 19:25:50 -0400] flashmanbahadur: seems that running the update-rc.d commands from the service provider do set up the system properly
[2012-05-07 19:25:57 -0400] flashmanbahadur: not sure why they arent getting run by chef
[2012-05-07 19:25:59 -0400] daaaan: shuvo: i'm not sure
[2012-05-07 19:26:03 -0400] shuvo: bean, if you are going to try it on vagrant, I have written a set of scripts that I need collaborators on. otherwise, I have read good things abuot omnibus
[2012-05-07 19:26:23 -0400] ashb: bean: or just use the debs from the opscode repo
[2012-05-07 19:26:28 -0400] shuvo: daaaan, np :-)
[2012-05-07 19:26:38 -0400] daaaan: might have to dig into the vagrant source
[2012-05-07 19:27:34 -0400] bean: ashb: okay. I'll try the opscode repo, knife bootstrap completely failed over ssh though on 12.04
[2012-05-07 19:27:39 -0400] shuvo: debs from the opscode repo need some patching, but I tried on 10.04. bean, if you get better results using 12.04, do share
[2012-05-07 19:28:07 -0400] shuvo: bean, can you gist the outptu of knife?
[2012-05-07 19:28:43 -0400] shuvo: daaaan, perhaps all I need to do is inject a 'up route add default gw <hostIP> dev eth1' into /etc/network/interfaces. hmm
[2012-05-07 19:29:17 -0400] ashb: i've used the vanila debs on 10.04 fine
[2012-05-07 19:29:54 -0400] shuvo: ashb, and your chef server continues to work after restarting the machine?
[2012-05-07 19:30:07 -0400] ashb: this was a long time ago, but yes
[2012-05-07 19:30:12 -0400] ashb: long time = 0.10.2 or so
[2012-05-07 19:30:19 -0400] ashb: (thats the chef version)
[2012-05-07 19:30:30 -0400] shuvo: ashb, hmm maybe the issues are with the latest debs then
[2012-05-07 19:31:22 -0400] bean: shuvo: https://gist.github.com/2629851
[2012-05-07 19:32:38 -0400] shuvo: bean, the deb scripts assume the bins are under /usr/sbin/chef-
[2012-05-07 19:33:00 -0400] shuvo: tell me what whichi ruby shows you
[2012-05-07 19:33:10 -0400] shuvo: `which ruby`
[2012-05-07 19:35:36 -0400] shuvo: ashb, the latest deb packages need some tuning: the load order of the chef init scripts need to be tweaked, the ruby and gem paths etc
[2012-05-07 19:36:28 -0400] shuvo: the ruby and gem paths issue should go away in the latest chef releases as I guess you can now pass them as an attribute
[2012-05-07 19:38:49 -0400] ashb: shuvo: have you reported a bug about this?
[2012-05-07 19:39:03 -0400] ashb: shuvo: debs have nothing to do with attributes
[2012-05-07 19:41:39 -0400] shuvo: ashb, I meant you can now pass the ruby and gem paths as an attribute to the chef client
[2012-05-07 19:41:58 -0400] ashb: i've never needed that on any version of chef-client
[2012-05-07 19:42:47 -0400] ashb: and it shouldn't be needed if the debs are working right. has this been reported as a bug?
[2012-05-07 19:43:22 -0400] shuvo: ashb, consider this shared by bean : https://gist.github.com/2629851 just now. The error's there probably because ruby is installed somewhere different from /usr/bin/
[2012-05-07 19:43:52 -0400] ashb: that doesn't look like its using the opscode debs
[2012-05-07 19:43:57 -0400] shuvo: an echo `which ruby` would confirm
[2012-05-07 19:44:44 -0400] ashb: Couldn't find any package by regex 'libruby1.8-extras' looks like ruby/apt on that box is in a funny state
[2012-05-07 19:47:00 -0400] kevmo: Has anyone installed chef-server on ubuntu 12.04 LTS?  Any issues, any install issues?
[2012-05-07 19:49:11 -0400] shuvo: kevmo, greap bean @http://community.opscode.com/chat/chef. It would be interesting if anyone could replicate https://gist.github.com/2629851
[2012-05-07 19:52:37 -0400] kevmo: Shuvo, thanks.  Will have a look.
[2012-05-07 19:54:26 -0400] geewiz: Hi! I'm in the process of migrating from our old 0.9 server to a new 0.10 server. When uploading a certain cookbook, it just keeps hanging. How can I find out what's causing the freeze?
[2012-05-07 19:54:45 -0400] flashmanbahadur: shuvo:
[2012-05-07 19:54:57 -0400] flashmanbahadur: in 12.04 chef-client installed to /usr/local/bin
[2012-05-07 19:55:11 -0400] flashmanbahadur: you will need to symlink it to the expected location
[2012-05-07 19:55:16 -0400] flashmanbahadur: of find some other workaround
[2012-05-07 19:55:26 -0400] flashmanbahadur: I just modified my bootstrap script to symlink it to the correct location
[2012-05-07 19:56:18 -0400] shuvo: flashmanbahadur, thanks. I am aware of the path issue and I symlink it myself as well :-)
[2012-05-07 19:57:52 -0400] shuvo: flashmanbahadur, is the the load order of the chef init scripts correct now?
[2012-05-07 19:58:17 -0400] flashmanbahadur: ?
[2012-05-07 19:58:22 -0400] flashmanbahadur: not quite sure what you mean
[2012-05-07 19:58:31 -0400] shuvo: the load order of the chef init scripts need to be tweaked. let ,e find a link for you
[2012-05-07 19:59:18 -0400] shuvo: http://lists.opscode.com/sympa/arc/chef/2011-09/msg00301.html
[2012-05-07 19:59:31 -0400] flashmanbahadur: oh for chef server
[2012-05-07 19:59:35 -0400] flashmanbahadur: dont have much experience with that
[2012-05-07 19:59:37 -0400] flashmanbahadur: just chef-client
[2012-05-07 19:59:55 -0400] shuvo: ah
[2012-05-07 20:00:23 -0400] shuvo: my bad, I assumed we were talking about chef server. chef-client was painless for me
[2012-05-07 20:01:05 -0400] shuvo: but thanks to you I now know in 12.04 chef-client installs to /usr/local/bin and needs to be symlinked
[2012-05-07 20:10:02 -0400] flashmanbahadur: shuvo: yeah I am using ruby 1.9, not sure all ruby on 12.04 is like that or just 1.9
[2012-05-07 20:10:40 -0400] flashmanbahadur: as for the 12.04 rc.d issues, explicitly running the commands that action :enable runs seems to cause the service to start
[2012-05-07 20:10:52 -0400] flashmanbahadur: not sure whats going on there that it is not running anymore
[2012-05-07 20:11:42 -0400] jtan325: hey guys, i'm using Hosted Chef, and am getting a "Connection reset by peer (Errno::ECONNRESET)" error when doing "knife cookbook upload foo"  this only started happening today, things worked fine last week. any ideas?
[2012-05-07 20:12:51 -0400] flashmanbahadur: jtan325: are you behind a proxy?
[2012-05-07 20:12:57 -0400] jtan325: not that i know of
[2012-05-07 20:13:11 -0400] flashmanbahadur: is it using the retry logic?
[2012-05-07 20:13:18 -0400] flashmanbahadur: connection failures should retry the APi up to 5 times
[2012-05-07 20:13:21 -0400] jtan325: how would i test that?
[2012-05-07 20:13:33 -0400] flashmanbahadur: it will tell you when it fails on upload
[2012-05-07 20:13:39 -0400] flashmanbahadur: if you dont see it then its not doing it
[2012-05-07 20:13:48 -0400] flashmanbahadur: but ive only seen it for connection failures
[2012-05-07 20:13:48 -0400] jtan325: i don't think i see it
[2012-05-07 20:13:52 -0400] flashmanbahadur: not Reset by peer
[2012-05-07 20:14:15 -0400] jtan325: i'm connecting from the same machine/network/etc. as i did last week, and last week "knife cookbook upload" worked through Friday with no problem
[2012-05-07 20:14:44 -0400] jtan325: hmm, it jut worked.
[2012-05-07 20:14:49 -0400] jtan325: network problems FTW
[2012-05-07 20:14:56 -0400] jtan325: * sigh *...
[2012-05-07 20:20:37 -0400] jschoolcraft: I'm trying to use the postgresql cookbook with vagrant, using postgresql::server and postgresql::client.  I'm using chef-solo and getting an error trying to set the postgres password.  Chef::Exceptions::ShellCommandFailed: bash[assign-postgres-password] (postgresql::server line 58) had an error: Expected process to exit 0, but it exited with 126.  Where would I start searching for how to fix this (no issues
[2012-05-07 20:20:37 -0400] jschoolcraft:  on GH repo)
[2012-05-07 20:28:17 -0400] miah: what is line 58 of postgresl::server
[2012-05-07 20:28:47 -0400] miah: read through that and figure out why its failing during your chef-solo run
[2012-05-07 20:38:55 -0400] geewiz: Hi guys, what could be the cause that "knife cookbook upload" just keeps hanging? All our cookbooks upload fine, only one keeps freezing.
[2012-05-07 20:39:26 -0400] miah: do you have large files stored in your cookbook?
[2012-05-07 20:39:53 -0400] flashmanbahadur: geewiz:  i know jtan325 was having those same issues a few minutes ago
[2012-05-07 20:39:58 -0400] geewiz: miah: Just wanted to write "It has two 20M files" :)
[2012-05-07 20:39:58 -0400] flashmanbahadur: may be Opscode endpoint issues
[2012-05-07 20:40:18 -0400] geewiz: flashmanbahadur: It's our own Chef server, freshly installed.
[2012-05-07 20:40:32 -0400] flashmanbahadur: 12.04?
[2012-05-07 20:41:11 -0400] geewiz: miah: But the verbose output doesn't stop at these .jar files.
[2012-05-07 20:41:31 -0400] geewiz: flashmanbahadur: Server is Ubuntu Lucid, client Mac OS.
[2012-05-07 20:41:41 -0400] flashmanbahadur: not sure then
[2012-05-07 20:44:00 -0400] geewiz: miah: Why did you ask about file sizes so promptly? It's certainly the main difference to almost all the other cookbooks.
[2012-05-07 20:45:46 -0400] geewiz: Yep, it's the only cookbook with files >500kB.
[2012-05-07 20:45:59 -0400] shuvo: miah, could largish file sizes comounded with network connectivity/throughput problems lead to "knife cookbook upload"  hanging?
[2012-05-07 20:46:45 -0400] cnf: i keep getting 'NameError: uninitialized constant Chef::Recipe::Opscode', what does that mean?
[2012-05-07 20:50:31 -0400] geewiz: I think I'll just have patience and keep the upload running for much longer than previously.
[2012-05-07 20:52:33 -0400] Brad_K: shuvo: knife cookbook upload can hang for a variety of reasons, but large file sizes can certainly make things more difficult.  as can network connectivity/throughput problems.
[2012-05-07 20:53:51 -0400] Brad_K: generally speaking, putting large files into a chef cookbook is not a good idea.  large files should go into some other type of file repo, and then be referenced by the chef cookbook.
[2012-05-07 20:54:11 -0400] shuvo: thanks Brad_K. would putting binary blobs in git be a good idea?
[2012-05-07 20:54:21 -0400] shuvo: 30MBish
[2012-05-07 20:54:29 -0400] flashmanbahadur: shuvo: git isnt great with binary blobs if they get revised often
[2012-05-07 20:54:47 -0400] flashmanbahadur: shuvo: if it is just for storage, its not the end of the world, it will just make everything slower
[2012-05-07 20:54:47 -0400] yfeldblum: shuvo, what  blobs?
[2012-05-07 20:54:54 -0400] geewiz: Brad_K: You're certainly right. I'll think of another way of getting them on the server.
[2012-05-07 20:55:01 -0400] shuvo: exactly flashmanbahadur. hmm, maybe have a http server for largish files
[2012-05-07 20:55:03 -0400] Brad_K: shuvo: to be honest, i'd set up my own local file/repo server, but so long as you're using a tool that works okay with large-ish blobs, it shouldn't make that much difference.
[2012-05-07 20:56:23 -0400] shuvo: Brad_K, what could be a Python HTTPServer like tool that can be used to serve files over HTTP with little effort adhoc?
[2012-05-07 20:56:25 -0400] Brad_K: but the general idea is that your meta-data should go into the cookbooks, and you can also include a moderate amount of small-ish files in the cookbooks without likelihood of causing too many problems.
[2012-05-07 20:56:44 -0400] Brad_K: but large numbers of files, or individual large-ish files should go somewhere else.
[2012-05-07 20:56:58 -0400] Brad_K: isn't sinatra a pythonic web server?
[2012-05-07 20:57:32 -0400] yfeldblum: sinatra is a rack server, written in ruby & requiring a ruby http server to host it
[2012-05-07 20:57:41 -0400] Brad_K: ahh, sorry.  my bad.
[2012-05-07 20:58:06 -0400] yfeldblum: i hear a normal httpd/nginx/etc is good for this though
[2012-05-07 20:58:11 -0400] Brad_K: let me suggest Google as a more reliable mechanism on this topic than me.
[2012-05-07 20:58:37 -0400] shuvo: ha ha
[2012-05-07 20:58:40 -0400] Brad_K: nginx is quite good as a web server.  lighttpd is okay.  i'm not a fan of apache/httpd.
[2012-05-07 20:58:51 -0400] geekbri: nginx + mod_passenger is common for a ruby setup
[2012-05-07 20:59:04 -0400] geekbri: I personally prefer nginx over lighttpd very much so.
[2012-05-07 20:59:14 -0400] shuvo: I need a a Python HTTPServer like tool: nothing that requires modifying config files, la nginx
[2012-05-07 20:59:47 -0400] geekbri: apache is like that old uncle you have who is always at parties and is good for 1 funny joke a party.  You like him, and he gets the job done, but hes boring the rest of the time and a bit long winded
[2012-05-07 20:59:49 -0400] shuvo: up and out on demand
[2012-05-07 20:59:56 -0400] shuvo: lol
[2012-05-07 20:59:57 -0400] yfeldblum: to serve large static files?
[2012-05-07 21:00:23 -0400] shuvo: large => 10 - 100MB to 4 -5 nodes, not necessarilt concurrently (but that would be nice)
[2012-05-07 21:00:42 -0400] GoofyGoober: hi guys,  a question... why my cookbook with user resource don't create home directory for new user?
[2012-05-07 21:00:50 -0400] Brad_K: shuvo: http://www.linuxjournal.com/content/tech-tip-really-simple-http-server-python
[2012-05-07 21:01:05 -0400] eherot: GoofyGoober: it won't if it's not the default for that platofmr
[2012-05-07 21:01:07 -0400] eherot: *platform
[2012-05-07 21:01:18 -0400] GoofyGoober: debian 6.0
[2012-05-07 21:01:37 -0400] yfeldblum: shuvo, why do you need a python-based http server to serve large files?
[2012-05-07 21:02:15 -0400] GoofyGoober: ah ok
[2012-05-07 21:02:17 -0400] eherot: not sure the default for that one
[2012-05-07 21:02:22 -0400] GoofyGoober: thanks
[2012-05-07 21:02:36 -0400] geewiz: Hm. Strange, after removing the files the cb uploaded fine. I thought I had tried that 2 hours ago...
[2012-05-07 21:02:40 -0400] eherot: but you'd need "supports :manage_home=>true" in the user block
[2012-05-07 21:02:49 -0400] shuvo: yfeldblum, no I meant I want a file server that's as easy to setup as "python -m SimpleHTTPServer" that can server 10 - 100MB files to 4-5 chef client nodes, not necessarily concurrently (but that would be nice)
[2012-05-07 21:03:23 -0400] Brad_K: shuvo: if the other example given above is not sufficient, then maybe try this one: http://www.tornadoweb.org/
[2012-05-07 21:03:24 -0400] eherot: asper http://wiki.opscode.com/display/chef/Resources#Resources-User
[2012-05-07 21:03:28 -0400] eherot: *as per, rather
[2012-05-07 21:04:11 -0400] GoofyGoober: uhm... but if I launch user add... by command line, the system create home directory
[2012-05-07 21:04:12 -0400] yfeldblum: shuvo, apache2 with a config file? nginx with a config file?
[2012-05-07 21:04:25 -0400] Brad_K: shuvo: the page at http://wiki.python.org/moin/WebFrameworks also mentions "web2py" as an alternative.
[2012-05-07 21:04:49 -0400] Brad_K: shuvo: specifcally, it says "web2py has no configuration files, requires no installation, can be run off a USB drive."
[2012-05-07 21:05:15 -0400] GoofyGoober: http://codepaste.net/pbfc3h
[2012-05-07 21:06:07 -0400] GoofyGoober: I find supports :manage_home => true
[2012-05-07 21:07:33 -0400] dangerdave: I use the Vagrant chef_client provisioner. I'd like to temporarily run via shef instead. Is there an easy way to do this?
[2012-05-07 21:07:46 -0400] Brad_K: GoofyGoober: How recent is debian 6?  is it on the official list of supported platforms/versions?
[2012-05-07 21:08:20 -0400] cnf: man, i don't get this chef/vagrant combination
[2012-05-07 21:08:23 -0400] shuvo: Brad_K, this looks good! thanks :-) http://www.tornadoweb.org/documentation/overview.html
[2012-05-07 21:08:59 -0400] Brad_K: shuvo: glad to be able to help.  oh, and btw  that link was returned by Google.  I told you they were smarter on this subject than I am.  ;-)
[2012-05-07 21:10:09 -0400] shuvo: is tornado the "other" framework/competitor of twisted?
[2012-05-07 21:10:29 -0400] GoofyGoober: Brad_K:  I don't know.. where I can look it ?
[2012-05-07 21:11:11 -0400] cnf: running the apt cookbook should update apt, right?
[2012-05-07 21:12:56 -0400] shuvo: dangerdave, AFAIK, you run shef manually as it's meant to be interactive
[2012-05-07 21:13:22 -0400] dangerdave: shuvo: yes, but I was hoping vagrant would kindly set up some basic configuration first.
[2012-05-07 21:13:55 -0400] cnf: i still have to log in manually, and run apt-get update by hand
[2012-05-07 21:14:02 -0400] cnf: even though i have the apt cookbook
[2012-05-07 21:14:04 -0400] shuvo: cnf, your apt cookbook needs to reside under a folder called 'apt' but you have a folder called 'apt-XXXX' instead since you are getting your files off github thath includes the identifier in it as well
[2012-05-07 21:14:09 -0400] bemu: shuvo: I haven't been reading the conversation, but we use Tornado.
[2012-05-07 21:14:17 -0400] cnf: shuvo: way, way past that
[2012-05-07 21:14:33 -0400] shuvo: ah, so yougot that working?
[2012-05-07 21:14:36 -0400] cnf: no
[2012-05-07 21:14:40 -0400] cnf: i do a manual checkout
[2012-05-07 21:14:46 -0400] shuvo: ah
[2012-05-07 21:15:04 -0400] cnf: but apt is not updating my apt database
[2012-05-07 21:15:09 -0400] cnf: i still need to do it manually
[2012-05-07 21:15:30 -0400] shuvo: bemu, how are you? isn't tornado the "other" framework/competitor of twisted? or was it something else like typhoon or something
[2012-05-07 21:15:39 -0400] Brad_K: GoofyGoober: the page in question is at http://wiki.opscode.com/display/chef/System+Requirements but it does show debian 6 as being one of the officially supported platforms/versions.  so, i'm at a loss to understand why you're having problems.
[2012-05-07 21:16:30 -0400] cnf: oh, ffs!
[2012-05-07 21:18:13 -0400] cnf: do i need to force the apt cookbook to update somehow?
[2012-05-07 21:19:07 -0400] shuvo: yes, there's a page that tells you how
[2012-05-07 21:19:28 -0400] cnf: ...
[2012-05-07 21:21:48 -0400] cnf: shuvo: where?
[2012-05-07 21:23:13 -0400] shuvo: perhaps this helps: http://stackoverflow.com/questions/9246786/how-can-i-get-chef-to-run-apt-get-update-before-running-other-recipes
[2012-05-07 21:23:35 -0400] ashb: the apt cookbook does that already
[2012-05-07 21:23:46 -0400] ashb: oh or is that a vagrant question and the title is misleading?
[2012-05-07 21:23:47 -0400] cnf: ashb: it doesn't that's my problem
[2012-05-07 21:23:58 -0400] ashb: cnf: are you using the latest version?
[2012-05-07 21:24:14 -0400] ashb: of the apt cookbook?
[2012-05-07 21:24:25 -0400] cnf: ashb: checked out 20 minutes ago
[2012-05-07 21:24:38 -0400] ashb: have you looked at the debug log when running chef-client to see what it's doing?>
[2012-05-07 21:24:43 -0400] ashb: is the cookbook in the runlist etc?
[2012-05-07 21:25:18 -0400] cnf: ashb: they all get added, apt-get update just isn't run
[2012-05-07 21:25:37 -0400] ashb: nopaste your debug log from `chef-client -l debug`
[2012-05-07 21:26:46 -0400] cnf: hmz
[2012-05-07 21:28:42 -0400] cnf: https://gist.github.com/gists ?
[2012-05-07 21:28:50 -0400] ashb: yeah a publist gist works too
[2012-05-07 21:28:53 -0400] cnf: bah
[2012-05-07 21:28:58 -0400] ashb: ;)
[2012-05-07 21:29:00 -0400] cnf: bad paste
[2012-05-07 21:29:10 -0400] rayrod2030: If a template runs that doesn't change anything in a file should the file show a recent timestamp?
[2012-05-07 21:29:11 -0400] bemu: shuvo: I have no idea, I haven't really evaluated other options. It was used here when I got here, and we haven't tested anything else.
[2012-05-07 21:29:19 -0400] cnf: https://gist.github.com/2630591
[2012-05-07 21:29:20 -0400] cnf: even
[2012-05-07 21:29:32 -0400] rayrod2030: I was under the impression that the template doesn't get reprocessed if no changes are present?
[2012-05-07 21:29:44 -0400] cnf: ashb: i have never run chef-client directly, btw
[2012-05-07 21:29:57 -0400] ashb: cnf: you normally run it via the deamon?
[2012-05-07 21:30:05 -0400] cnf: ashb: no, vagrant
[2012-05-07 21:30:08 -0400] ashb: ah k
[2012-05-07 21:30:32 -0400] ashb: cnf: I cannot read /etc/chef/validation.pem, which you told me to use to sign requests!
[2012-05-07 21:30:43 -0400] ashb: it has never got to the stage of trying to run the cookbook code
[2012-05-07 21:30:46 -0400] ashb: its bailing out before there
[2012-05-07 21:30:50 -0400] cnf: huh?
[2012-05-07 21:30:53 -0400] cnf: sign what?
[2012-05-07 21:30:59 -0400] ashb: requests to the server
[2012-05-07 21:31:05 -0400] cnf: i don't have a server
[2012-05-07 21:31:12 -0400] cnf: it's chef-solo
[2012-05-07 21:31:22 -0400] ashb: ahh. then chef-solo -l debug instead, sorry
[2012-05-07 21:31:27 -0400] shuvo: cnf, gist your vagrant file
[2012-05-07 21:33:21 -0400] cnf: https://gist.github.com/gists
[2012-05-07 21:33:23 -0400] cnf: bah!
[2012-05-07 21:33:38 -0400] Brad_K: second time is the charm?  ;-)
[2012-05-07 21:33:48 -0400] cnf: https://gist.github.com/2630610
[2012-05-07 21:33:55 -0400] cnf: yeah :P
[2012-05-07 21:38:03 -0400] cnf: hmz
[2012-05-07 21:38:11 -0400] cnf: ashb: nothing interesting there?
[2012-05-07 21:39:27 -0400] ashb: looking
[2012-05-07 21:39:58 -0400] ashb: Run List is []
[2012-05-07 21:40:05 -0400] ashb: it looks like vagrant isn't doing the right thing somewhere
[2012-05-07 21:40:20 -0400] ashb: I don't know how vagrant works (beyond a high level) or how to debug it i'm afraid
[2012-05-07 21:40:26 -0400] ashb: shuvo: might know some
[2012-05-07 21:40:56 -0400] cnf: ashb: it installs vim and postgres and ssl just fine
[2012-05-07 21:41:11 -0400] cnf: so it is registrating my recipies
[2012-05-07 21:41:13 -0400] ashb: cnf: it doesn't looke like it is doing anything at all anymore from that log
[2012-05-07 21:41:21 -0400] cnf: just not running apt-get update :/
[2012-05-07 21:44:17 -0400] cnf: ashb: https://gist.github.com/2630610
[2012-05-07 21:44:23 -0400] cnf: that's run from vagrant
[2012-05-07 21:45:00 -0400] shuvo: cnf, I think there was something about chef-solo cannot have empty runlist, ask mitchellh
[2012-05-07 21:45:11 -0400] cnf: shuvo: what?
[2012-05-07 21:45:21 -0400] cnf: shuvo: it doesn't have an empty runlist
[2012-05-07 21:47:19 -0400] shuvo: did you just update the gist? it seems like the issue is now with package[postgresql-client]?
[2012-05-07 21:47:43 -0400] ashb: cnf: hmm. curious. the latest version of the apt cookbook isn't how I remember it
[2012-05-07 21:48:15 -0400] cnf: ashb: heh ^^;
[2012-05-07 21:48:27 -0400] cnf: ashb: i'm getting well lost tbh...
[2012-05-07 21:48:40 -0400] ashb: it seems to only run an apt-get update every 86400s
[2012-05-07 21:49:21 -0400] cnf: ashb: but this is on a new, fresh install
[2012-05-07 21:49:26 -0400] cnf: well, a cloned VM box
[2012-05-07 21:49:28 -0400] cnf: but still
[2012-05-07 21:49:41 -0400] ashb: what's the timestamp on /var/lib/apt/periodic/update-success-stamp
[2012-05-07 21:50:03 -0400] cnf: vagrant@lucid32:~$ ls -lh /var/lib/apt/periodic/update-success-stamp
[2012-05-07 21:50:03 -0400] cnf: ls: cannot access /var/lib/apt/periodic/update-success-stamp: No such file or directory
[2012-05-07 21:50:14 -0400] cnf: because it's a fresh install
[2012-05-07 21:50:16 -0400] ashb: sudo?
[2012-05-07 21:50:16 -0400] bawt_: sudo is all thats wrong with unix
[2012-05-07 21:50:30 -0400] cnf: ashb: same, file isn't there
[2012-05-07 21:50:42 -0400] ashb: curiouser and curiouser
[2012-05-07 21:50:48 -0400] cnf: uuuuuhu
[2012-05-07 21:51:26 -0400] ashb: gist what's in /tmp/vagrant-chef-1/chef-solo-1/cookbooks/apt/recipes/default.rb
[2012-05-07 21:51:52 -0400] ashb: acutally. it seems to be running the cookbooks in reverse order...
[2012-05-07 21:51:56 -0400] cnf: ashb: that's right from github
[2012-05-07 21:52:22 -0400] ashb: cnf: just to confirm, this version https://github.com/opscode-cookbooks/apt/blob/master/recipes/default.rb ?
[2012-05-07 21:52:40 -0400] cnf: yeh
[2012-05-07 21:52:45 -0400] ashb: this is going to seem stupid, but try reversing the order of the chef.add_recipe lines in your vagrant file
[2012-05-07 21:52:47 -0400] cnf: unless that changed in the last hour :
[2012-05-07 21:53:12 -0400] cnf: ashb: sounds stupid indeed, but i was already doing it ^^;
[2012-05-07 21:53:42 -0400] cnf: ashb: and doesn't help
[2012-05-07 21:54:01 -0400] ashb: next up try just having just apt in the recipes list
[2012-05-07 21:54:03 -0400] cnf: it wants to do postgresql::client first
[2012-05-07 21:54:34 -0400] cnf: hmm, that is updating
[2012-05-07 21:54:38 -0400] ashb: cnf: but I'm running out of ideas - you might want to send that gist to the chef or vargrant mailing lists
[2012-05-07 21:54:57 -0400] cnf: ashb: so chef _should_ do them in order, right?
[2012-05-07 21:55:03 -0400] ashb: yeah it should
[2012-05-07 21:55:22 -0400] cnf: hmm
[2012-05-07 21:55:38 -0400] cnf: ashb: well, thanks for throwing me a line!
[2012-05-07 21:55:43 -0400] ashb: nps
[2012-05-07 21:55:50 -0400] cnf: it was getting abit forresty, with all dem trees :P
[2012-05-07 22:06:34 -0400] cnf: damnit, and of course the vagrant channel is all quiet >,<
[2012-05-07 22:07:09 -0400] shuvo: pm mitchellh directly. he helps
[2012-05-07 22:22:27 -0400] shuvo: see, he helps! :-D
[2012-05-07 22:23:03 -0400] cnf: ashb: still here? ^^;
[2012-05-07 22:26:49 -0400] mhalligan: if I require 'chef/knife' in a ruby script, will that also include knife plugins?
[2012-05-07 22:28:29 -0400] cnf: anyone around that can help me with the execution order of recipes?
[2012-05-07 22:29:14 -0400] paulmooring: cnf: what's your problem, in general you should't worry about the order of the run_list
[2012-05-07 22:29:15 -0400] c_t: they should go in the order you specify them in the run list
[2012-05-07 22:29:35 -0400] cnf: paulmooring: well i should, because it's not working
[2012-05-07 22:29:45 -0400] cnf: paulmooring: i need apt-get update to run before anything else
[2012-05-07 22:29:52 -0400] paulmooring: You can require a recipe from another recipe, it's recommended to do it that way
[2012-05-07 22:29:56 -0400] cnf: paulmooring: but postgres always runs first
[2012-05-07 22:30:27 -0400] cnf: paulmooring: i'd like to mess with the recipe i got from github as little as possible
[2012-05-07 22:30:45 -0400] cnf: c_t: and they do, but not postgres
[2012-05-07 22:31:19 -0400] paulmooring: cnf: what's the first recipe in your run_list?
[2012-05-07 22:31:25 -0400] cnf: paulmooring: apt
[2012-05-07 22:31:39 -0400] paulmooring: and postgres runs first anyway?
[2012-05-07 22:31:41 -0400] cnf: yep
[2012-05-07 22:31:56 -0400] cnf: which doesn't work, because it needs an apt-get update first
[2012-05-07 22:32:06 -0400] cnf: it's just a straight clone from https://github.com/opscode-cookbooks/postgresql
[2012-05-07 22:32:42 -0400] paulmooring: and this apt? https://github.com/opscode-cookbooks/apt
[2012-05-07 22:32:56 -0400] cnf: paulmooring: yep, all my recipes come from https://github.com/opscode-cookbooks/
[2012-05-07 22:34:15 -0400] paulmooring: cnf: probably not related, but is there a reason you're pulling these from github rather than 'knife cookbook site install $cookbook'?
[2012-05-07 22:34:33 -0400] cnf: paulmooring: chef-solo (in vagrant)
[2012-05-07 22:38:06 -0400] cnf: hmm
[2012-05-07 22:41:25 -0400] paulmooring: cnf: can you check the run_list order on the vagrant guest in /tmp/vagrant-chef/ and see if the json file shows postgres first?
[2012-05-07 22:41:54 -0400] cnf: paulmooring: did that, https://gist.github.com/2630914
[2012-05-07 22:41:58 -0400] Brad_K: cnf: my understanding is that chef-solo is supposed to include all of its own cookbooks (and all the other resources it needs).  Are you pulling in these cookbooks in order to create the chef-solo configuration to be installed, or are you pulling them as part of the chef-solo install?
[2012-05-07 22:42:04 -0400] cnf: paulmooring: that is what vagrant generates, and postgres is last
[2012-05-07 22:42:19 -0400] cnf: Brad_K: sorry, what?
[2012-05-07 22:43:17 -0400] Brad_K: cnf: you said you were pulling your cookbooks from github, and i'm trying to figure out if you're manually pulling them down and putting them into some sort of local repository that you can use to build your chef-solo config, or if you're trying to pull them down dynamically as part of the chef-solo install itself.
[2012-05-07 22:43:57 -0400] cnf: Brad_K: i tried using the urls, but that didn't work
[2012-05-07 22:44:01 -0400] cnf: so now i'm cloning manually
[2012-05-07 22:44:30 -0400] cnf: paulmooring: "run_list":["recipe[apt]","recipe[vim]","recipe[openssl]","recipe[postgresql::server]"
[2012-05-07 22:44:33 -0400] cnf: paulmooring: is the relevant bit
[2012-05-07 22:45:16 -0400] Brad_K: cnf: good, because those cookbooks were not meant to be used as-is.  they were meant to be a starting point for you to create something that would be applicable to your local environment, and you're supposed to make changes to your copies of those cookbooks as necessary to suit your environment.
[2012-05-07 22:45:31 -0400] paulmooring: cnf: what version of chef-solo are you using?
[2012-05-07 22:45:44 -0400] cnf: Brad_K: bah!
[2012-05-07 22:45:50 -0400] cnf: paulmooring: euhm, dno, let me check?
[2012-05-07 22:46:09 -0400] cnf: paulmooring: Chef 0.10.2, does that sound plausible?
[2012-05-07 22:46:29 -0400] cnf: yeah, vagrant@lucid32:~$ chef-solo --version
[2012-05-07 22:46:29 -0400] cnf: Chef: 0.10.2
[2012-05-07 22:46:30 -0400] paulmooring: yeah, older base box I assume?
[2012-05-07 22:46:40 -0400] hoover_damn: or deb
[2012-05-07 22:46:43 -0400] cnf: euhm, it is lucid32
[2012-05-07 22:46:54 -0400] cwj: that basebox comes with 0.10.2
[2012-05-07 22:47:02 -0400] cwj: which is too old for my purposes
[2012-05-07 22:47:10 -0400] cnf: paulmooring: should i poke mitchel to update it? ^^;
[2012-05-07 22:47:28 -0400] cnf: paulmooring: would a newer chef version fix it?
[2012-05-07 22:47:44 -0400] paulmooring: not necessarily, I'm looking though Chef bugs and wanted to know how wide a net to cast :)
[2012-05-07 22:47:45 -0400] cwj: 'gem install chef' on the vagrant vm and find out :
[2012-05-07 22:48:12 -0400] cnf: what is the latest version? lemme check
[2012-05-07 22:49:14 -0400] Brad_K: cnf: i think one problem you might be having is things being done in the postgresql cookbook during the earlier phases of a chef run, and the apt-get update being done much later, at compile time.  See http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-05-07 22:49:49 -0400] Brad_K: cnf: last i heard, the latest shipping version of chef is 0.10.8, with 0.10.10 in late beta.
[2012-05-07 22:50:23 -0400] paulmooring: Brad_K: that's right on both accounts, 0.10.10 should be out any day now
[2012-05-07 22:50:24 -0400] Brad_K: personally, i wouldn't try to install chef from the gem.  i'd use the omnibus installer instead.
[2012-05-07 22:50:40 -0400] paulmooring: http://www.opscode.com/chef/install
[2012-05-07 22:50:54 -0400] Brad_K: but then, i use chef-client and not chef-solo, so i don't know how omnibus would factor into that difference.
[2012-05-07 22:50:57 -0400] cnf: might i mention i started with chef a few hours ago, and that i am not very comfortable with ruby ^^;
[2012-05-07 22:51:33 -0400] Brad_K: it took me about three months to get sufficiently comfortable with Chef and the small amount of Ruby that i have learned so far.
[2012-05-07 22:51:36 -0400] paulmooring: cnf: if you can vagrant ssh into the machine and re-run chef-solo with the '-l debug' option, you'll be able to look through the log and see if apt does get run first but doesn't update until later
[2012-05-07 22:52:17 -0400] cnf: paulmooring: uhm, yeah... chef-solo -l debug uses different config files, i think
[2012-05-07 22:52:23 -0400] cnf: it doesn't do much if i run it directly
[2012-05-07 22:52:34 -0400] paulmooring: well whatever the full chef-solo command is...
[2012-05-07 22:52:52 -0400] cnf: paulmooring: also, 10.8 does the same thing
[2012-05-07 22:53:13 -0400] paulmooring: you'll likely need a -c solo.rb but I don't know where vagrant stores everything
[2012-05-07 22:54:11 -0400] cnf: i tried with precise32, that does the same thing, with chef 10.8
[2012-05-07 22:54:40 -0400] Urocyon: What was the error you got, cnf?
[2012-05-07 22:54:57 -0400] cnf: destroying the vm, and getting a clean one up, and then i'll try the chef-solo paulmooring
[2012-05-07 22:55:15 -0400] cnf: Urocyon: postgres runs before everything else, and it shouldn't
[2012-05-07 22:57:01 -0400] cnf: paulmooring: and vagrant puts everything in /tmp/vagrant-chef-1, a solo.rb and a dna.json
[2012-05-07 22:57:31 -0400] paulmooring: cnf: my guess is `sudo chef-solo -c /tmp/vagrant-chef-1/solo.rb -j /tmp/vagrant-chef-1/dna.json -l debug -L /tmp/chef-debug.txt` is the command you want
[2012-05-07 22:57:49 -0400] cnf: paulmooring: thanks, i'll try that in a minute
[2012-05-07 22:58:07 -0400] Urocyon: :q
[2012-05-07 22:58:10 -0400] Urocyon: oops
[2012-05-07 22:59:41 -0400] paulmooring: Urocyon: at least we know you're not the type to reach straight for :q! and lose unsaved work :)
[2012-05-07 23:00:36 -0400] Urocyon: cautious by nature.
[2012-05-07 23:00:49 -0400] cnf: paulmooring: https://gist.github.com/23eb4235627a95e29250
[2012-05-07 23:02:34 -0400] shuvo: looking at https://gist.github.com/23eb4235627a95e29250, the behavior will also exhibit so if "recipe[apt]", "recipe[vim]", "recipe[openssl]" have nothing to execute
[2012-05-07 23:02:48 -0400] cnf: but they do
[2012-05-07 23:02:49 -0400] shuvo: hence, "recipe[postgresql::server]" remains
[2012-05-07 23:03:13 -0400] cnf: if i remove postgresql::server, apt updates, vim installs, and openssl installs
[2012-05-07 23:03:22 -0400] shuvo: o.O
[2012-05-07 23:03:22 -0400] cnf: in the right order
[2012-05-07 23:03:33 -0400] shuvo: hmm
[2012-05-07 23:04:20 -0400] shuvo: Could you email this to the mailing list? it would be important to know why this kind of behaviour can happen. This concerns me : "if i remove postgresql::server, apt updates, vim installs, and openssl installs"
[2012-05-07 23:04:52 -0400] shuvo: could you email me your Vagrant file and .box definitions? I am at gmail as subhobroto
[2012-05-07 23:04:56 -0400] paulmooring: cnf: I think the :immediately in the server recipe might be your problem
[2012-05-07 23:05:15 -0400] shuvo: doh! there's an :immediately in postgresql::server?
[2012-05-07 23:05:21 -0400] cnf: o,O
[2012-05-07 23:05:25 -0400] cnf: why would anyone do that?
[2012-05-07 23:05:29 -0400] shuvo: ha ha
[2012-05-07 23:05:35 -0400] paulmooring: can you change it to :delayed and try again?
[2012-05-07 23:05:49 -0400] shuvo: grep :immediately will you and gist it ?
[2012-05-07 23:06:10 -0400] paulmooring: it actually makes sense, because most of the time you're installing postgres to use with an application, and you need the db running before using it
[2012-05-07 23:06:35 -0400] cnf: https://gist.github.com/dbf97df910eeb4efe9ee
[2012-05-07 23:06:50 -0400] shuvo: ho ho
[2012-05-07 23:06:59 -0400] paulmooring: If you look at that debug log, postgres loads last, but processes first
[2012-05-07 23:07:08 -0400] shuvo: cnf, what he said ^
[2012-05-07 23:07:16 -0400] shuvo: fix it and continue
[2012-05-07 23:07:40 -0400] cnf: bah, i wanted to run unmodified recipes as much as possible
[2012-05-07 23:08:04 -0400] shuvo: I meant fix the issues postgresql::server is throwing
[2012-05-07 23:08:11 -0400] shuvo: it's meant to be used so
[2012-05-07 23:08:14 -0400] cnf: also, how do i fix it?
[2012-05-07 23:08:30 -0400] paulmooring: change :immediately to delayed
[2012-05-07 23:08:30 -0400] shuvo: RELP
[2012-05-07 23:08:35 -0400] cnf: ok
[2012-05-07 23:08:36 -0400] cnf: lessee
[2012-05-07 23:09:11 -0400] shuvo: paulmooring, is the rcp was designed assuming :immediately, won't it break if :delayed?
[2012-05-07 23:09:22 -0400] shuvo: .
[2012-05-07 23:09:27 -0400] shuvo: s/is/if/
[2012-05-07 23:09:33 -0400] cnf: paulmooring: on the recipe, right?
[2012-05-07 23:09:33 -0400] akraut: Hey folks, I'm seeing "legacy setting for solr_url" warnings in the chef-expander log. Found the commit where that was put in. What's the new config format?
[2012-05-07 23:10:19 -0400] paulmooring: shuvo: in this case doesn't look like it should, it's just a reload
[2012-05-07 23:10:30 -0400] cnf: paulmooring: same thing
[2012-05-07 23:11:00 -0400] paulmooring: the proper fix is to actually require apt in that recipe though
[2012-05-07 23:11:20 -0400] paulmooring: so forget what I said about changing the :immediately portion, that's Monday brain
[2012-05-07 23:11:27 -0400] cnf: hehe
[2012-05-07 23:11:38 -0400] cnf: paulmooring: it doesn't change the order, though
[2012-05-07 23:11:53 -0400] cnf: and i'm kinda iffed i can't decide the order in which my recipes get run
[2012-05-07 23:12:43 -0400] paulmooring: cnf: It goes back to what I first said, if a recipe requires another recipe run first, you should put that requirement in the recipe itself, and not worry about run_list order
[2012-05-07 23:12:48 -0400] miah: ^
[2012-05-07 23:13:03 -0400] miah: if you write your cookbooks properly you don't really run into those issues.
[2012-05-07 23:13:15 -0400] josephholsten: ugh, writing this munin -> nagios -> pagerduty cookbookery requires at least 2 orders of abstraction more than my brain wants to hold today
[2012-05-07 23:13:28 -0400] cnf: miah: i'd rather write as little cookbooks as i can
[2012-05-07 23:13:34 -0400] paulmooring: really modifying cookbooks is a good thing, not something you should be worried about
[2012-05-07 23:13:51 -0400] cnf: it means i have to track stuff
[2012-05-07 23:13:55 -0400] miah: http://wiki.opscode.com/display/chef/Chef+Core+Principles
[2012-05-07 23:14:07 -0400] josephholsten: +1, just remember to fill out the cla and submit a pull request
[2012-05-07 23:14:37 -0400] cnf: so the consensus is "don't know why it does it"?
[2012-05-07 23:14:38 -0400] miah: i've modified many cookbooks at this point and i can't say its been bad or a waste of time
[2012-05-07 23:15:09 -0400] paulmooring: cnf: run_list specify load order not the order in which they process, the load order is working as advertised
[2012-05-07 23:15:15 -0400] cnf: miah: in your link "When you are configuring systems, order matters."
[2012-05-07 23:15:22 -0400] miah: yup
[2012-05-07 23:15:36 -0400] miah: remember: computer programs are only as smart as you make them
[2012-05-07 23:15:36 -0400] paulmooring: your problem is the postgres cookbook doesn't say I need apt first, so Chef is okay processing it first due to it's contents
[2012-05-07 23:15:45 -0400] cnf: which is why i'm not happy it's not doing it in the order i told it to :P
[2012-05-07 23:16:07 -0400] miah: sure it is. run list is just load order. the cookbooks still need to correctly declare dependancies
[2012-05-07 23:16:20 -0400] miah: if postgresql cookbook isnt doing that correctly then its a bug
[2012-05-07 23:16:21 -0400] cnf: paulmooring: but why is it deciding to change the run order?
[2012-05-07 23:16:34 -0400] cnf: because run order atm is not the same as load order
[2012-05-07 23:16:37 -0400] miah: because run order is determined based on dependancy resolution
[2012-05-07 23:16:59 -0400] paulmooring: It's a little complicated but the key is to understand the difference between the compile and execute phases
[2012-05-07 23:17:04 -0400] miah: cnf: i suggest you read; http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-05-07 23:17:35 -0400] paulmooring: it loads in the specify order like you tell it to, and if while loading the cookbooks there's no requirements on processing order, it tries to optimize
[2012-05-07 23:17:41 -0400] josephholsten: and to hope that you haven't got something executing a resource in the compile phase
[2012-05-07 23:17:55 -0400] miah: when you let programs make assumptions you just make yourself look like an ass
[2012-05-07 23:18:21 -0400] paulmooring: the tl;dr is 'Chef expects recipe requirements in the recipe not the run_list'
[2012-05-07 23:18:21 -0400] cnf: bah
[2012-05-07 23:18:39 -0400] miah: so by all means. please file a bug on postgresql
[2012-05-07 23:18:43 -0400] josephholsten: +1
[2012-05-07 23:18:48 -0400] Urocyon: +1
[2012-05-07 23:19:01 -0400] miah: thats the only way these cookbooks will do the right thing, so that users like you cna use them without modification
[2012-05-07 23:19:04 -0400] cnf: miah: i'd love to, if i could articulate the problem
[2012-05-07 23:19:26 -0400] cnf: but at the moment, i only partly understand what is going on
[2012-05-07 23:20:15 -0400] josephholsten: cnf: that's okay. do your best and we'll try do fill in the blanks.
[2012-05-07 23:20:18 -0400] miah: so bug reporting is simple. summary is 'i expected this and got that', then in your description 'i expected this, this happened, here are some logs and details about my system and the cookbooks im using'
[2012-05-07 23:20:23 -0400] hoover_damn: postgresql automation on ubuntu isn't easy
[2012-05-07 23:20:28 -0400] hoover_damn: I wrote my own cookbook for it
[2012-05-07 23:20:35 -0400] miah: be as specific as you can, its ok if things are missing
[2012-05-07 23:20:40 -0400] Urocyon: cnf: isn't it that postgresql should update packages in the package manager before installing postgresql, but ":immediately" causes it to install first?
[2012-05-07 23:20:53 -0400] hoover_damn: to be quite frank, most of the problems I had with Postgresql was with the damned ubuntu/debian package
[2012-05-07 23:21:00 -0400] hoover_damn: all related to that ..
[2012-05-07 23:21:06 -0400] cnf: Urocyon: :immediately isn't the culprit
[2012-05-07 23:21:25 -0400] josephholsten: hoover_damn: apparmor?
[2012-05-07 23:21:31 -0400] hoover_damn: josephholsten, nah
[2012-05-07 23:21:34 -0400] paulmooring: hoover_damn: I think this is as simple as postgres::server should require apt::default first but doesn't
[2012-05-07 23:21:37 -0400] hoover_damn: josephholsten, postgresql installs on package installation
[2012-05-07 23:21:38 -0400] cnf: miah: submit https://github.com/opscode-cookbooks/postgresql or https://github.com/opscode/cookbooks ?
[2012-05-07 23:21:46 -0400] hoover_damn: josephholsten, s/installs/starts
[2012-05-07 23:22:03 -0400] hoover_damn: josephholsten, which means you 0 ability to configure the configuration file or pg_hba or anything before hand
[2012-05-07 23:22:07 -0400] miah: cnf: the first link.
[2012-05-07 23:22:11 -0400] josephholsten: post install hooks on debs are just wrong
[2012-05-07 23:22:23 -0400] hoover_damn: josephholsten, so if your configuration change breaks your data-setup
[2012-05-07 23:22:32 -0400] miah: you should submit the bug here: http://tickets.opscode.com/browse/COOK
[2012-05-07 23:22:33 -0400] hoover_damn: you have to stop it, configure, reinit, start
[2012-05-07 23:22:45 -0400] cnf: uhm
[2012-05-07 23:22:56 -0400] cnf: miah: i think i'm blind, but i can find no issues tab on either...
[2012-05-07 23:22:59 -0400] hoover_damn: which is why I wrote github.com/damm/postgresql/
[2012-05-07 23:22:59 -0400] paulmooring: cnf: please submit bugs to the COOK project here: http://tickets.opscode.com
[2012-05-07 23:23:12 -0400] cnf: paulmooring: ah, ok
[2012-05-07 23:23:21 -0400] hoover_damn: also mine is geared towards users who actually want performance
[2012-05-07 23:23:26 -0400] hoover_damn: which you cannot do without reconfiguring
[2012-05-07 23:23:45 -0400] josephholsten: hoover_damn: I seriously need to add a config_test option to templates. so much accidental breakage would be avoided.
[2012-05-07 23:23:48 -0400] paulmooring: you can put issues on github if you want, but pull requests won't get accepted until there's a bug on that site
[2012-05-07 23:24:04 -0400] hoover_damn: josephholsten, totally
[2012-05-07 23:24:05 -0400] Urocyon: Looks like there is an issue there already:  http://tickets.opscode.com/browse/COOK-1011
[2012-05-07 23:24:07 -0400] cnf: paulmooring: issues are disabled on github
[2012-05-07 23:24:31 -0400] paulmooring: sorry I was think pull requests not issues
[2012-05-07 23:25:29 -0400] josephholsten: some kind angel should go through all the tickets with patches for the old cookbooks repo and rebase them into the new structure
[2012-05-07 23:26:20 -0400] cnf: miah: so uhm, should i make a dup, or +1 the one Urocyon posted, or what is the done thing here?
[2012-05-07 23:26:30 -0400] paulmooring: josephholsten: Is that a halo I see over your head? :)
[2012-05-07 23:26:31 -0400] josephholsten: +1 it
[2012-05-07 23:26:45 -0400] Urocyon: If you have something to add to COOK-1011, just add it in a comment.
[2012-05-07 23:26:46 -0400] yfeldblum: run-list is the list of recipes that get run; some cookbooks declare dependencies on other cookbooks; in such cases, the cookbooks that have no dependencies get loaded first into memory, but their recipes are NOT run; merely, their attributes/definitions/libraries/resources/providers/files/templates/recipes are *available* in case some other cookbook wants to call into it
[2012-05-07 23:27:13 -0400] cnf: oh, damnit, another account ^^;
[2012-05-07 23:27:41 -0400] josephholsten: paulmooring: did you hear mysql::server recipe got ported to windows? apparently I like painful hobbies.
[2012-05-07 23:27:52 -0400] jschoolcraft: jschoolcraft: I'm trying to use the postgresql cookbook with vagrant, using postgresql::server and postgresql::client.  I'm using chef-solo and getting an error trying to set the postgres password.  Chef::Exceptions::ShellCommandFailed: bash[assign-postgres-password] (postgresql::server line 58) had an error: Expected process to exit 0, but it exited with 126.
[2012-05-07 23:28:19 -0400] paulmooring: I applaud you for that, sounds like you already earned your wings
[2012-05-07 23:28:20 -0400] jschoolcraft: How do I go about solving this?  Search on obvious things is less than usable.
[2012-05-07 23:28:32 -0400] Urocyon: I'll take a look at it again.  I haven't run into any problems with postgresql failing on my installs, and I had chalked that up to my having the apt recipe in my run list.   But maybe not.
[2012-05-07 23:29:20 -0400] cnf: heh, and actually, jschoolcraft problem is also my next problem ^^;
[2012-05-07 23:29:29 -0400] hoover_damn: basically if you want to use postgresql 9.1.3, and have it work... i'd suggest https://github.com/damm/postgresql
[2012-05-07 23:29:34 -0400] hoover_damn: because mine actually does set the password
[2012-05-07 23:29:38 -0400] hoover_damn: and work ;)
[2012-05-07 23:29:43 -0400] hoover_damn: also supports hot standby replication
[2012-05-07 23:30:11 -0400] cnf: hoover_damn: what password does it set?
[2012-05-07 23:30:16 -0400] josephholsten: jschoolcraft: try running chef-solo again with the `--log_level debug` flag
[2012-05-07 23:30:27 -0400] hoover_damn: cnf, you get a choice... set it on the role, or it sets the password during initdb
[2012-05-07 23:30:38 -0400] jschoolcraft: can I set that in chef_json in vagrant?
[2012-05-07 23:30:43 -0400] hoover_damn: cnf, uses the openssl functionality... apt dependency is specified
[2012-05-07 23:30:45 -0400] josephholsten: jschoolcraft: it seems to be choking on an ALTER ROLE, but we'll need more info to see what went wrong
[2012-05-07 23:30:48 -0400] hoover_damn: as uhm I require the apt cookbook
[2012-05-07 23:30:58 -0400] cnf: yeah, the "official" one does that hoover_damn
[2012-05-07 23:31:00 -0400] josephholsten: jschoolcraft: it's a different flag actually, just a sec
[2012-05-07 23:31:09 -0400] jschoolcraft: josephholsten: cool, waiting.
[2012-05-07 23:31:09 -0400] hoover_damn: i also depend on the sysctl cookbook
[2012-05-07 23:31:13 -0400] hoover_damn: you can find that on github.com/damm/sysctl
[2012-05-07 23:31:17 -0400] cnf: hoover_damn: but i can't figure out what the password it generated actually is :P
[2012-05-07 23:31:23 -0400] hoover_damn: cnf, stored on the node
[2012-05-07 23:31:31 -0400] hoover_damn: cnf, knife node show dbserver -l
[2012-05-07 23:31:34 -0400] cnf: hoover_damn: hmm?
[2012-05-07 23:31:35 -0400] Urocyon: I'm attempting to update the postgresql cookbook with some tunable settings, COOK-1064.
[2012-05-07 23:31:36 -0400] Urocyon: http://tickets.opscode.com/browse/COOK-1064
[2012-05-07 23:31:37 -0400] cnf: hoover_damn: -solo...
[2012-05-07 23:31:42 -0400] hoover_damn: nowhere
[2012-05-07 23:31:44 -0400] josephholsten: jschoolcraft: chef.log_level = :debug
[2012-05-07 23:31:59 -0400] Urocyon: I'm thinking I should maybe compare a bit withy your version hoover_damn.
[2012-05-07 23:32:16 -0400] hoover_damn: basically with solo it doesn't save the password anywhere... it can't
[2012-05-07 23:32:31 -0400] cnf: hoover_damn: so in solo, you are locked out of your database?
[2012-05-07 23:32:33 -0400] hoover_damn: so set the password in the json
[2012-05-07 23:32:33 -0400] cnf: o,O
[2012-05-07 23:32:44 -0400] cnf: yeah, i was trying that
[2012-05-07 23:32:45 -0400] hoover_damn: not unless you nerded up your pg_hba
[2012-05-07 23:32:59 -0400] cnf: i'll be damned if i can figure out how to make vagrant do that ^6;
[2012-05-07 23:33:04 -0400] hoover_damn: modify the trust
[2012-05-07 23:33:11 -0400] hoover_damn: from md5
[2012-05-07 23:33:19 -0400] hoover_damn: my cookbook defaults to md5 because I think its' a good idea
[2012-05-07 23:33:22 -0400] hoover_damn: but you don't have to do auth
[2012-05-07 23:33:54 -0400] hoover_damn: host    all             all             127.0.0.1/32            trust
[2012-05-07 23:33:57 -0400] hoover_damn: in pg_hba.conf
[2012-05-07 23:34:29 -0400] cnf: oh, ffs! i don't get it
[2012-05-07 23:34:39 -0400] hoover_damn: cnf, psql -Upostgres
[2012-05-07 23:34:47 -0400] cnf: if i put depends "apt" in my metadata.rb
[2012-05-07 23:34:48 -0400] hoover_damn: cnf, does it prompt for a password?
[2012-05-07 23:34:51 -0400] cnf: should that not work?
[2012-05-07 23:35:29 -0400] hoover_damn: should be a good start
[2012-05-07 23:35:29 -0400] cnf: hoover_damn: i'll let you know once i can get the thing installed ^6;
[2012-05-07 23:35:41 -0400] cnf: which has been eluding me for hours >,<
[2012-05-07 23:35:49 -0400] hoover_damn: btw, I actually store the password in /etc/postgresql/9.1/.org_grok in my cookbook
[2012-05-07 23:36:03 -0400] hoover_damn: it actually was bad for me to keep the password on disk
[2012-05-07 23:36:09 -0400] hoover_damn: but I haven't cared to stop that
[2012-05-07 23:36:10 -0400] cnf: paulmooring: what am i missing, now?
[2012-05-07 23:37:16 -0400] cnf: damnit, this is frustrating >,<
[2012-05-07 23:37:27 -0400] paulmooring: depends in the metadata makes sure it gets installed, you also want 'include_recipe "apt::default"' in the recipe
[2012-05-07 23:37:39 -0400] paulmooring: or whatever recipe you want if it's not the default apt recipe
[2012-05-07 23:37:51 -0400] valdezjoelt: hi
[2012-05-07 23:38:19 -0400] cnf: right, i'm officially totally lost...
[2012-05-07 23:38:24 -0400] josephholsten: valdezjoelt: hello!
[2012-05-07 23:38:27 -0400] paulmooring: http://wiki.opscode.com/display/chef/Recipes#Recipes-IncludingRecipes
[2012-05-07 23:38:44 -0400] paulmooring: cnf: ^ read that link
[2012-05-07 23:39:32 -0400] cnf: paulmooring: but now, i can find NO reason, at ALL why postgres would insist on being run first...
[2012-05-07 23:40:23 -0400] valdezjoelt: From Packages how do I install a package to a specific repository I have created e.g. /etc/yum.repos.d/myrepo.repo
[2012-05-07 23:40:31 -0400] cnf: paulmooring: if i install postgresql::client, it only has include_recipe for itself, nothing else
[2012-05-07 23:40:49 -0400] cnf: paulmooring: and it STILL insists on running before anything else, including apt, which is in the depends list
[2012-05-07 23:41:01 -0400] cnf: wtf?
[2012-05-07 23:41:02 -0400] paulmooring: cnf: This can be a bit confusing at first but the specified order in the run_list applies to load attributes, libraries, ect. and does not determine the order resources execute in
[2012-05-07 23:41:53 -0400] cnf: i think the postgresql cookbook is just really, really crap
[2012-05-07 23:42:14 -0400] paulmooring: it's best not to try and predict the order resources will execute in (executing bash commands, starting and stopping services, ect.) just specify when one resource needs to be run first in the recipe
[2012-05-07 23:42:52 -0400] Urocyon: cnf: the fix mentioned by one poster on COOK-1011 was to remove a few lines from the postgresql:client recipe.  https://github.com/wil/cookbooks/commit/a470a4f68602ec3bf3374830f4990a7e19e9de81
[2012-05-07 23:43:09 -0400] cnf: WTF?
[2012-05-07 23:43:34 -0400] cnf: Urocyon: and why does that work?
[2012-05-07 23:44:33 -0400] cnf: paulmooring: adding include_recipe "apt" doesn't help, either
[2012-05-07 23:44:48 -0400] cnf: i so don't understand anything of what i'm doing anymore
[2012-05-07 23:46:14 -0400] cnf: paulmooring: so euhm, i don't understand why it insists on running first, AND i can't figure out how to tell the recipe it needs to run apt first
[2012-05-07 23:47:02 -0400] Urocyon: cnf: postgresql::client is changing the order of things.
[2012-05-07 23:47:09 -0400] Urocyon: cnf: description here: http://wiki.opscode.com/display/chef/Evaluate+and+Run+Resources+at+Compile+Time
[2012-05-07 23:47:39 -0400] cnf: Urocyon: honestly, i stopped understanding what any of that means quite a while back
[2012-05-07 23:47:49 -0400] Urocyon: This is telling chef to install those packages at compile time.... so it gets executed before anything else is done.
[2012-05-07 23:50:22 -0400] cnf: i'm in total overload atm
[2012-05-07 23:50:37 -0400] Urocyon: So chef goes through gathering all the resources it needs to handle first.... it goes through them in the order you gave them just fine... but then it hits these packages in postgresql::client, and that whole run_action thing tells it to install these packages right away...
[2012-05-07 23:51:18 -0400] Urocyon: cnf: but then chef has a problem... it hasn't executed the apt recipe yet, and so chokes when it's told to install the packages.
[2012-05-07 23:51:46 -0400] cnf: why would anyone do that?
[2012-05-07 23:51:59 -0400] cnf: it's ignoring its own "i need this" settings
[2012-05-07 23:52:02 -0400] Urocyon: Something to do with interaction with the database cookbook, I think.
[2012-05-07 23:52:17 -0400] Urocyon: It was done poorly.
[2012-05-07 23:52:34 -0400] cnf: i'm telling it,include_recipe "apt::default", and depends "apt"
[2012-05-07 23:52:41 -0400] cnf: and it still doesn't
[2012-05-07 23:53:16 -0400] cnf: right
[2012-05-07 23:53:34 -0400] cnf: i'm gonna make something to snack, delete the postgresql cookbook
[2012-05-07 23:53:38 -0400] cnf: and find another one
[2012-05-07 23:53:44 -0400] Urocyon: For now, I'd just pull out those couple of lines from the client recipe.
[2012-05-07 23:53:44 -0400] cnf: Urocyon: thanks for your patience ^^;
[2012-05-07 23:54:34 -0400] Urocyon: cnf: that will move those package installs to the execute phase.
[2012-05-07 23:54:34 -0400] paulmooring: cnf: did some research on that cookbook I think this bug is the key: https://github.com/wil/cookbooks/commit/a470a4f68602ec3bf3374830f4990a7e19e9de81
[2012-05-07 23:55:14 -0400] cnf: paulmooring: yeah, that's what Urocyon
[2012-05-07 23:55:27 -0400] paulmooring: It's not yet clear to me why, but before that patch, the code was workaround to force postgres to install during compile rather than execute
[2012-05-07 23:55:45 -0400] cnf: tbh, stuff like that scares me
[2012-05-07 23:57:17 -0400] paulmooring: it sounds scary than it is, the run_action(:install) just tells Chef, "don't worry about what order I said to do things in, just install this *right now*
[2012-05-07 23:57:22 -0400] Urocyon: git blame says Lamont Granquist added those lines.
[2012-05-07 23:58:11 -0400] cnf: paulmooring: it scares me because i hardly know any ruby, and stuff like that is things i would not find.
[2012-05-07 23:58:37 -0400] cnf: running into that in my first hour with chef is off-putting, because it makes me wonder what else i'll run into
[2012-05-07 23:59:42 -0400] Urocyon: nope... didn't add them, just edited them last.
[2012-05-07 23:59:47 -0400] paulmooring: This particular problem requires a deeper understanding of Chef than most problems you'll run into
