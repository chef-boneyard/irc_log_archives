[2012-05-02 00:01:17 -0400] major_majors: figuring out what the output of /etc/init.d/jetty might provide a little more insight
[2012-05-02 00:04:19 -0400] julienphalip: major_majors: If I ssh into the Vm with the 'vagrant' user, and the run '/etc/init.d/jetty restart' I get 'You need root privileges to run this script'. And if I run 'sudo /etc/init.d/jetty restart' then it works.
[2012-05-02 00:05:52 -0400] major_majors: julienphalip: if you stop jetty and then sudo chef-client does it start jetty back up successfully?
[2012-05-02 00:06:03 -0400] major_majors: or chef-solo i guess
[2012-05-02 00:06:23 -0400] major_majors: i'm not as familiar with the workflow for chef-solo unfortunately
[2012-05-02 00:06:39 -0400] major_majors: also, i've never used vagrant, so it's entirely possible i just won't be any help at all =P
[2012-05-02 00:16:37 -0400] josephholsten: major_majors: you seem on the money so far
[2012-05-02 00:20:17 -0400] julienphalip: major_majors: I've just tried and I'm getting the same error when running chef-solo directly, so the problem doesn't seem to be with vagrant
[2012-05-02 00:21:26 -0400] julienphalip: The error is: Chef::Exceptions::Exec: service[jetty] (jetty::default line 41) had an error: /etc/init.d/jetty restart returned 1, expected 0
[2012-05-02 00:21:57 -0400] julienphalip: Is there a way to force a service to be run with sudo?
[2012-05-02 00:23:37 -0400] flaccid: service should be designed with su/sudo
[2012-05-02 00:23:49 -0400] flaccid: (or similar)
[2012-05-02 00:27:00 -0400] julienphalip: flaccid: do you mean there's already a way to do that, or is that not supported yet?
[2012-05-02 00:27:34 -0400] flaccid: the service rc script should run processes under users as required, not something chef does
[2012-05-02 00:28:24 -0400] jtimberman: if the jetty service is unable to start, there might be an error in the script, the service itself or a related configuration file.
[2012-05-02 00:28:40 -0400] jtimberman: if you do sudo /etc/init.d/jetty restart, what happens?
[2012-05-02 00:29:18 -0400] jtimberman: vagrant runs chef-solo with sudo, as the vagrant user.
[2012-05-02 00:32:40 -0400] sivy_: something like this in an execute resource ought to work, yes? ...
[2012-05-02 00:32:41 -0400] sivy_: command "#{venv_path}/bin/activate && pip install -r #{pip_requirements}"
[2012-05-02 00:32:59 -0400] sivy_: i can ssh to the VM and run it, no prob
[2012-05-02 00:33:13 -0400] sivy_: (and the variables are being parsed properly)
[2012-05-02 00:33:25 -0400] sivy_: but i get a permission error when run via chef-client
[2012-05-02 00:33:53 -0400] sivy: (oddly this is also a agrant ques)
[2012-05-02 00:34:39 -0400] sivy: er, vagrant
[2012-05-02 00:38:23 -0400] flaccid: whats the usual way with apache2 cookbook or on top to provide SSL support, i.e. install the cert/conf ?
[2012-05-02 00:39:31 -0400] julienphalip: jtimberman: If I ssh into the Vm with the 'vagrant' user, and then run '/etc/init.d/jetty restart', I get 'You need root privileges to run this script'. And if I run 'sudo /etc/init.d/jetty restart' then it works.
[2012-05-02 00:46:34 -0400] jtimberman: Yes
[2012-05-02 00:47:04 -0400] jtimberman: So, 'sudo /etc/init.d/jetty restart' works ok? It doesn't have a return code 1?
[2012-05-02 00:49:43 -0400] echiu: is there a knife command to install vagrant?
[2012-05-02 00:50:09 -0400] julienphalip: jtimberman: Yes it word, the jetty server starts fine
[2012-05-02 00:50:17 -0400] julienphalip: s/word/works/
[2012-05-02 00:50:57 -0400] flaccid: hmm, so there is no de facto way to do ssl setup with apache? seems weird that its not done yet
[2012-05-02 00:53:34 -0400] aslan: hey guys i was looking at the postfix recipe ... it looks a little bit too complicated. All i need to take the defaults and finish the installation as i manually do. How can i make a simple recipe to do that?
[2012-05-02 01:08:33 -0400] flaccid: aslan: i'd recommend using it as is, otherwise i guess you may need to learn how to develop cookbooks/recipes via chef docs
[2012-05-02 01:08:51 -0400] aslan: flaccid: i do a lot of cookbook development
[2012-05-02 01:09:01 -0400] aslan: flaccid: this just looked like an overkill
[2012-05-02 01:09:39 -0400] aslan: all i need is like package do "posffix" end . and all the default options that you get on their gui
[2012-05-02 01:09:44 -0400] flaccid: its only overkill if it installs extra stuff which i don't think it does
[2012-05-02 01:09:58 -0400] flaccid: postfix has a gui?
[2012-05-02 01:10:22 -0400] aslan: flaccid: yeah on ubuntu you get a ascii popup
[2012-05-02 01:10:33 -0400] aslan: from command line
[2012-05-02 01:10:49 -0400] flaccid: what command?
[2012-05-02 01:10:51 -0400] aslan: thats what i usually do : apt-get install postfix
[2012-05-02 01:11:09 -0400] flaccid: command for the postfix gui
[2012-05-02 01:14:00 -0400] aslan: flaccid: that would pop up the command
[2012-05-02 01:14:16 -0400] aslan: not the command the gui
[2012-05-02 01:14:24 -0400] aslan: flaccid: try it once you would see
[2012-05-02 01:14:29 -0400] msf: is there any way to access the list of resources() from within a LWRP
[2012-05-02 01:14:38 -0400] msf: or can I only do this with definitions
[2012-05-02 01:14:58 -0400] flaccid: sorry i don't understand
[2012-05-02 01:15:06 -0400] flaccid: aslan: do you mean debconf?
[2012-05-02 01:15:30 -0400] flaccid: with chef, debian non interactive is used, so debconf is not initiated
[2012-05-02 01:15:39 -0400] flaccid: obviously chef is intended to be non interactive
[2012-05-02 01:19:13 -0400] aslan: flaccid: so there is no way to pick the default options suggested by postfix install script?
[2012-05-02 01:20:43 -0400] flaccid: this is what the templates are for in the cookbook
[2012-05-02 01:31:26 -0400] flaccid: sorry for the repeat again, but seriously no known chef way to setup ssl cert with apache2?
[2012-05-02 01:34:01 -0400] aslan: flaccid: do you want to create new certs?
[2012-05-02 01:34:18 -0400] flaccid: install/configure them via chef
[2012-05-02 01:35:42 -0400] macros: There isn't a good standard way, depends on how much a breach and loss of cert will cost you as to how you handle them
[2012-05-02 01:36:18 -0400] macros: If it matters the amount you can automate is severly limited
[2012-05-02 01:37:09 -0400] macros: I tend to use chef to distribute an encrypted file system with the keystore that is mounted with a manual prompt to unlock on daemon start
[2012-05-02 01:37:18 -0400] macros: Snake oil certs require far less caution
[2012-05-02 01:38:15 -0400] macros: If you are putting unecrypted certs in your repo to be handed out by chef you are probably doing it wrong
[2012-05-02 02:03:48 -0400] rberger: Anyone have a LWRP for managing EC2 Security Groups?
[2012-05-02 02:08:16 -0400] gp5st: hello.  I'm sorry if i'm missing something basic, but I have an ubuntu server, and installed chef from the apt repository.  after configuring knife, i do a knife cookbook site install munin and munin and apache2 are downloaded, but they don't show up in the webui
[2012-05-02 02:24:13 -0400] cwj: gp5st: using 'knife site install foo' will download the cookbooks to your local system, you need to run 'knife cookbook upload foo' or 'knife cookbook upload -a' to upload them from your local disk to the chef-server
[2012-05-02 02:26:19 -0400] LinuxHorn: gp5st: You need to do a knife cookbook upload on each of those cookbooks to send it to the chef server
[2012-05-02 02:26:51 -0400] gp5st: cwj LinuxHorn that makes too much sense (in retrospect:-p)
[2012-05-02 02:26:56 -0400] gp5st: giving it a shot
[2012-05-02 02:27:23 -0400] LinuxHorn: The install command brings it down to you local client, the upload sends it to chef
[2012-05-02 02:27:26 -0400] LinuxHorn: Np
[2012-05-02 02:27:45 -0400] LinuxHorn: I'm still new to chef, happy to actually be able to help
[2012-05-02 02:28:02 -0400] gp5st: i'm running both on the same machine, so i wasn't thinking along those lines
[2012-05-02 02:28:20 -0400] gp5st: :-D that worked
[2012-05-02 02:28:24 -0400] gp5st: thanks guys:)
[2012-05-02 02:29:30 -0400] cwj: you bet
[2012-05-02 02:31:53 -0400] LinuxHorn: Rock on
[2012-05-02 02:39:08 -0400] gp5st: why does the git cookbook depend on yum and runit?
[2012-05-02 02:39:34 -0400] hoover_damn: git server
[2012-05-02 02:39:38 -0400] hoover_damn: ?
[2012-05-02 02:39:49 -0400] jtgiri_: hey guys , is there way to make chef  not to deploy if there latest version is already there ?
[2012-05-02 02:40:05 -0400] hoover_damn: yeah that would be why
[2012-05-02 02:40:10 -0400] patcon: wtf?!? why don't we get one of these??? https://github.com/languages/Puppet
[2012-05-02 02:40:22 -0400] patcon: I would be all over that thing!
[2012-05-02 02:40:35 -0400] patcon: must. investigate.
[2012-05-02 02:40:41 -0400] miah: because chef is just Ruby?
[2012-05-02 02:40:52 -0400] miah: but still.. =)
[2012-05-02 02:41:43 -0400] flaccid: patcon: i agree. though puppet isn't language so hmm
[2012-05-02 02:41:45 -0400] miah: hrm. ost of these seem to be standard ruby and not regular puppet dsl so ya.. chef should have one.
[2012-05-02 02:42:02 -0400] flaccid: contact github
[2012-05-02 02:42:16 -0400] patcon: bah... so that's that's what we sold to the devil for an internal dsl...
[2012-05-02 02:42:26 -0400] miah: =)
[2012-05-02 02:42:37 -0400] yfeldblum: because chef is Ruby. and puppet has its own language, mostly for kicks (i.e., in the shins)
[2012-05-02 02:42:46 -0400] miah: lulz
[2012-05-02 02:42:48 -0400] patcon: yeah man, def gonna do it. i would 100% LOVE that page
[2012-05-02 02:43:02 -0400] patcon: flaccid: ^^
[2012-05-02 02:43:08 -0400] flaccid: i'd call it a pseudo language or meta language personally
[2012-05-02 02:43:17 -0400] yfeldblum: patcon, how would you tell a repository is a chef repo? by the overwhelming presence of ".rb" files?
[2012-05-02 02:43:31 -0400] flaccid: is there a puppet interpreter?
[2012-05-02 02:43:34 -0400] flaccid: or compiler?
[2012-05-02 02:44:37 -0400] yfeldblum: flaccid, yes, i believe the puppetmaster reads these puppet manifests and compiles them into a complete set of instructions and delivers that set of instructions to the puppets
[2012-05-02 02:45:44 -0400] flaccid: thats a pseudo language not a real interpreter
[2012-05-02 02:46:03 -0400] flaccid: manifest being the meta language
[2012-05-02 02:48:34 -0400] patcon: yfeldblum: true about the rb files, but there's def a pattern and it could be arranged that there be something definitive, I suppose...was just going to look through all the other languages and see if there might be a precedent to argue for it?
[2012-05-02 02:49:02 -0400] patcon: i suppose i'm not too keen on it being known as a language, i just really want that page :)
[2012-05-02 02:49:11 -0400] miah: its a dsl ( http://en.wikipedia.org/wiki/Domain_specific_language )
[2012-05-02 02:52:07 -0400] flaccid: yeah i don't class a dsl as a language, its a specification language
[2012-05-02 02:56:24 -0400] josephholsten: flaccid: you should take a foundations of computing class sometime. probably a principles of programming languages class too. it's amazing how many kinds of langs are out there.
[2012-05-02 02:57:13 -0400] flaccid: josephholsten: you should take a reality class on what a language is. i went to uni.
[2012-05-02 02:57:36 -0400] josephholsten: flaccid: I just thought you might enjoy it.
[2012-05-02 02:57:54 -0400] flaccid: already done it
[2012-05-02 02:57:58 -0400] flaccid: years ago
[2012-05-02 02:58:04 -0400] josephholsten: s/should/would get a kick out of/
[2012-05-02 02:58:21 -0400] flaccid: i just don't regard a spec lang as a real lang
[2012-05-02 02:58:33 -0400] flaccid: unless there is a real standalone interpreter which there doesn't seem to be for puppet
[2012-05-02 02:58:38 -0400] miah: agreed
[2012-05-02 02:58:50 -0400] flaccid: so whats the prob?
[2012-05-02 02:58:56 -0400] miah: no problem from me =)
[2012-05-02 02:59:14 -0400] josephholsten: does puppet even spec out a formal grammar? so we could separate it?
[2012-05-02 02:59:26 -0400] flaccid: then i'll ignore your schooling comment
[2012-05-02 02:59:33 -0400] miah: i didnt make the schooling comment
[2012-05-02 02:59:39 -0400] flaccid: oh shit
[2012-05-02 02:59:48 -0400] flaccid: sorry miah, i meant that for josephholsten
[2012-05-02 02:59:49 -0400] josephholsten: flaccid: if you wouldn't enjoy the classes, please pay me no mind
[2012-05-02 02:59:51 -0400] miah: its ok =)
[2012-05-02 02:59:52 -0400] tehrawr: rawr
[2012-05-02 02:59:57 -0400] flaccid: doing too much at once today
[2012-05-02 03:00:11 -0400] flaccid: pay you no mind?
[2012-05-02 03:00:22 -0400] josephholsten: ignore me
[2012-05-02 03:00:28 -0400] flaccid: sorry guys, i must have a chemical imbalance today
[2012-05-02 03:00:50 -0400] miah: i do every day
[2012-05-02 03:01:43 -0400] flaccid: when the input is scrambled before output stage, i'm already hosed
[2012-05-02 03:02:47 -0400] flaccid: to get slightly back on topic, i've never met someone who has properly evaluated chef and puppet and chosen chef as result
[2012-05-02 03:03:22 -0400] flaccid:  oh man that didn't come out right either. i mean to say they always conclude chef as the choice
[2012-05-02 03:03:25 -0400] flaccid: not puppet
[2012-05-02 03:04:10 -0400] miah: ya. i've used both, and ended up with chef for the right reasons.
[2012-05-02 03:04:22 -0400] josephholsten: I like ey's perspective: http://www.engineyard.com/blog/2011/why-puppet-should-manage-your-infrastructure/ http://www.engineyard.com/blog/2011/why-chef-should-manage-deploying-your-application/
[2012-05-02 03:04:24 -0400] miah: i think puppet is still fine though
[2012-05-02 03:05:44 -0400] josephholsten: when you're integrating internal bits of chef and your app, puppet seems like it adds a lot of mental overhead
[2012-05-02 03:05:58 -0400] flaccid: engineyard usually sux. the conclusion in the first link isn'st a conclusion and doesn't cite why other options can't do it
[2012-05-02 03:06:39 -0400] flaccid: anyone that choose a title,  "Why abc should do xyz" is a moron to begin with
[2012-05-02 03:06:40 -0400] patcon: > i've never met someone who has properly evaluated chef and puppet and chosen chef as result
[2012-05-02 03:06:40 -0400] patcon: > oh man that didn't come out right either.
[2012-05-02 03:06:45 -0400] patcon: bwahah oh dear
[2012-05-02 03:07:09 -0400] flaccid: yes chef=puppet for that text patcon
[2012-05-02 03:07:19 -0400] flaccid: aka the opposite
[2012-05-02 03:08:11 -0400] patcon: yep, got it. just a terribly executed "getting back on track" comment :)
[2012-05-02 03:09:04 -0400] flaccid: my cpu is busted
[2012-05-02 03:10:27 -0400] patcon: flaccid: so all-in-all, do you think i have a hope in hell of convincing anyone chef should get a language page? sending them a message basically just saying it's a huge boon to the puppet community, and drawing out that one project is essentially being penalized for internal vs external dsl
[2012-05-02 03:11:26 -0400] flaccid: patcon: not sure, can only try. its always ironic when native takes you out of the stats
[2012-05-02 03:13:24 -0400] patcon: for sure. might be grounds to plead that they lax up on how languages/domains are selected...
[2012-05-02 03:13:52 -0400] miah: just ping them, github is all good peoples =)
[2012-05-02 03:13:57 -0400] flaccid: yep semantics etc.
[2012-05-02 03:14:03 -0400] flaccid: yeah they are pretty cool
[2012-05-02 03:20:24 -0400] patcon: hm. https://github.com/blog/1037-highlighting-repository-languages
[2012-05-02 03:21:23 -0400] yfeldblum: patcon, chef isn't a language
[2012-05-02 03:21:57 -0400] yfeldblum: patcon, you might as well lobby for a language page for makefiles
[2012-05-02 03:22:19 -0400] flaccid: +1
[2012-05-02 03:22:22 -0400] patcon: i know... i wouldn't be appealing to that. i'd be appealing to the fact that they're offering something really wonderful to projects that start their own language, which other projects don't get :)
[2012-05-02 03:22:31 -0400] yfeldblum: patcon, ruby apps, ruby libs, & ruby infras are all written in ruby
[2012-05-02 03:22:49 -0400] flaccid: back in the 90s, php pseudo/spec languages would be listed here not puppet
[2012-05-02 03:24:12 -0400] yfeldblum: patcon, i'd prefer people to think of chef as a system that fully leverages this powerful language called ruby that many sysadmins are already using (because scripting in bash & perl is the dark ages)
[2012-05-02 03:24:35 -0400] yfeldblum: patcon, than for people to start thinking of chef as an isolated community that went off and started a new language that no sysadmin knows
[2012-05-02 03:25:08 -0400] yfeldblum: patcon, when you use chef, your infrastructure is written in Plain Old Ruby
[2012-05-02 03:25:59 -0400] miah: well said
[2012-05-02 03:26:31 -0400] patcon: yfeldblum: sorry maybe i should have brought it up related to languages at all, as i was only really jonesing was that page -- like chef-headquarters on github where you can see all the community activity in the most active arena of development, github
[2012-05-02 03:27:02 -0400] patcon: i'm in total agreement on what you've said, but at the end of the day, we're still short something that the other community benefits from, that all :)
[2012-05-02 03:28:30 -0400] patcon: yeah, we've got community.opscode.com, which is amazing. but it's still got a ways to go, and it's unfortunate for us that the puppet community is essentially getting it for free
[2012-05-02 03:28:53 -0400] flaccid: comes back to my original argument, chef isn't a language.
[2012-05-02 03:29:12 -0400] yfeldblum: also, it's not really a competition until the concept "infrastructure as code" has noticeable market share ...
[2012-05-02 03:29:48 -0400] flaccid: i kind of don't care about the other stuff. i feel its someones fault if they choose the wrong thing, i don't really care about marketing
[2012-05-02 03:31:05 -0400] patcon: i didn't really mean it's unfortunate in the competition sense.
[2012-05-02 03:31:06 -0400] yfeldblum: it's not about "chef is better than X" ... it's about "chef is relevant and useful because it does A"
[2012-05-02 03:31:09 -0400] patcon: just that i would use the jebus out of that page if we had it, and I don't think i'd be alone on that. but hey, maybe i'm wrong
[2012-05-02 03:32:04 -0400] miah: just follow people from the community
[2012-05-02 03:32:04 -0400] yfeldblum: patcon, no worries, just saying, i feel no need to worry about the puppet page on github
[2012-05-02 03:32:10 -0400] miah: then your feed becomes that =)
[2012-05-02 03:32:37 -0400] flaccid: patcon: sales?
[2012-05-02 03:32:50 -0400] patcon: flaccid: sales?
[2012-05-02 03:33:04 -0400] flaccid: [1:32pm]
[2012-05-02 03:33:13 -0400] flaccid: just that i would use the jebus out of that page if we had it, and I don't think i'd be alone on that. but hey, maybe i'm wrong
[2012-05-02 03:33:30 -0400] flaccid: bad paste, but its like you wanted the stat for sales or something
[2012-05-02 03:33:47 -0400] patcon: as in, am i in sales? sorry, maybe im being dense... i don't follow
[2012-05-02 03:34:06 -0400] flaccid: why do you need this stat?
[2012-05-02 03:34:15 -0400] miah: i think he's saying its basically free advertising to the puppet community and it would be great if there was a chef page so you could see all the activity in the chef community
[2012-05-02 03:34:44 -0400] patcon: aaahh... no no just that I'm interested in what's "trending" in terms of the community -- like most forks and most watched in a given week :)
[2012-05-02 03:35:04 -0400] flaccid: well github is accurate there
[2012-05-02 03:35:27 -0400] miah: you could use that bigdata feature with the github data =)
[2012-05-02 03:35:50 -0400] patcon: miah: oohhh.. really? that's a thing? neato
[2012-05-02 03:36:02 -0400] miah: https://github.com/blog/1112-data-at-github
[2012-05-02 03:36:10 -0400] patcon: zoinks!
[2012-05-02 03:51:31 -0400] jtgiri_: hey guys, for some reason, my migration command is failing : t line 10) had an error: Chef::Exceptions::Exec: drush sql-dump -r /var/www/sitter.test.com/current/public > /root/sitter.`date +%Y%m%d_%H%M`.bak.sql returned 1, expected 0 , but if i run this command from shell it works fine , any ideas ?
[2012-05-02 04:08:55 -0400] miah: escaping shellout is fun
[2012-05-02 07:43:15 -0400] Philipp_: I would like to modify the rsync methode in order to add an exlusion of certain data_bags which are not needed on all hosts
[2012-05-02 07:43:36 -0400] Philipp_: do you have any idea how to do that?
[2012-05-02 08:15:19 -0400] BryanWB: ohai chefs!
[2012-05-02 08:15:25 -0400] Kwanasolis: BryanWB: o/
[2012-05-02 08:15:42 -0400] BryanWB: Kwanasolis: \o
[2012-05-02 08:15:58 -0400] Kwanasolis: how goes?
[2012-05-02 08:18:53 -0400] BryanWB: Kwanasolis: busy as Hell
[2012-05-02 08:19:35 -0400] louallen: hello chefs! anyone familiar with recipe mercurial 0.8.0? I keep getting this error when I try to use it... FATAL: NoMethodError: undefined method `hg' for #<Chef::Recipe:0x7f653742a498>
[2012-05-02 08:21:43 -0400] erikh: is it in the metadata.rb of the recipe you're attempting to use that resource from?
[2012-05-02 08:21:50 -0400] erikh: err s/recipe/cookbook/
[2012-05-02 08:23:32 -0400] louallen: got it from opscode-community github
[2012-05-02 08:24:03 -0400] erikh: louallen: that's not what i'm asking. how are you using the mercurial resource
[2012-05-02 08:24:11 -0400] erikh: the 'hg' resource.
[2012-05-02 08:24:28 -0400] louallen: hg "/tmp" do
[2012-05-02 08:24:45 -0400] louallen: repository "ssh://default:default@10.11.5.210/vokka_web"
[2012-05-02 08:24:57 -0400] louallen: reference "tip"
[2012-05-02 08:25:03 -0400] louallen: action :clone
[2012-05-02 08:25:10 -0400] louallen: end
[2012-05-02 08:25:26 -0400] BryanWB: louallen:  put this in the recipe where u use `hg`      include_recipe  "mercurial"
[2012-05-02 08:26:18 -0400] erikh: he needs a depends in his metadata.rb
[2012-05-02 08:26:26 -0400] erikh: otherwise the lwrp won't get picked up
[2012-05-02 08:26:32 -0400] louallen: do I still need to do that if I already have "recipe[mercurial]" in the role im assigning to the node?
[2012-05-02 08:26:57 -0400] BryanWB: louallen: yes
[2012-05-02 08:27:37 -0400] louallen: @erikh, how do i do that? 'depends mercurial'?
[2012-05-02 08:27:54 -0400] erikh: depends "mercurial", in your cookbook's metadata.rb
[2012-05-02 08:28:00 -0400] erikh: then re-upload the cookbook.
[2012-05-02 08:28:20 -0400] louallen: i see, i'll try both suggestions. thanks!
[2012-05-02 08:29:10 -0400] BryanWB: erikh: does that really include all the lwrps from a cookbook? so u don't have to do 'depends' ?
[2012-05-02 08:29:32 -0400] erikh: the include_recipe only includes recipes
[2012-05-02 08:29:49 -0400] erikh: depending on a cookbook in metadata.rb pulls down the whole cookbook for the client run
[2012-05-02 08:29:57 -0400] erikh: (including the providers)
[2012-05-02 08:32:06 -0400] BryanWB: erikh: doesn't depends still require u to have the recipe in your run_list ?
[2012-05-02 08:32:12 -0400] erikh: nope
[2012-05-02 08:32:16 -0400] BryanWB: ah
[2012-05-02 08:32:22 -0400] BryanWB: erikh: will u b at chefconf?
[2012-05-02 08:32:32 -0400] erikh: unfortunately no, but I will be at devopsdays
[2012-05-02 08:32:39 -0400] BryanWB: too bad
[2012-05-02 08:32:43 -0400] erikh: I just landed a new job -- I could ask, but it might be inappropriate
[2012-05-02 08:32:50 -0400] BryanWB: makes sense
[2012-05-02 08:32:54 -0400] erikh: I'll talk to my boss next monday when I start
[2012-05-02 08:36:35 -0400] louallen: hmmm... I updated both my recipe/default.rb and metadata.rb but still gives the same error... I uploaded my cookbook as well...
[2012-05-02 08:37:31 -0400] louallen: should I increase my cookbook's version number? just to be sure?
[2012-05-02 08:39:10 -0400] erikh: louallen: probably won't matter, but feel free to
[2012-05-02 08:39:19 -0400] erikh: hrm
[2012-05-02 08:39:28 -0400] erikh: louallen: do you have your cookbook anywhere we can see it?
[2012-05-02 08:40:09 -0400] louallen: hmmm... ill try putting it in my dropbox if that's ok
[2012-05-02 08:40:32 -0400] erikh: sure.
[2012-05-02 08:40:46 -0400] erikh: I need to step away for 5-10 but I will look at it as soon as I am back (smoke time)
[2012-05-02 08:41:04 -0400] louallen: ok that'll give me time to move some files
[2012-05-02 08:54:01 -0400] erikh: louallen: looked at your stuff; so it looks like the mercurial cookbook doesn't provide a 'hg' provider
[2012-05-02 08:54:08 -0400] erikh: let's find out which cookbook does that
[2012-05-02 08:54:55 -0400] louallen: isnt that the one in mercurial/providers/default.rb?
[2012-05-02 08:55:51 -0400] erikh: is there a provider there? I don't see one in your dropbox
[2012-05-02 08:56:20 -0400] louallen: w8 let me double check might not have finished uploading
[2012-05-02 08:56:35 -0400] erikh: louallen: http://napes.co.uk/blog/chef-hg/
[2012-05-02 08:56:43 -0400] erikh: looks like it might be more along the lines of what you want.
[2012-05-02 08:56:51 -0400] erikh: (it was in the comments here: http://community.opscode.com/cookbooks/mercurial/comments)
[2012-05-02 08:58:38 -0400] louallen: yeah that was actually the one i was using but switched to the opscode-community version
[2012-05-02 08:58:45 -0400] louallen: both seems the same though
[2012-05-02 08:58:49 -0400] erikh: ah ok
[2012-05-02 08:58:56 -0400] erikh: so that makes a lot of sense :)
[2012-05-02 08:59:05 -0400] fish_: role a has role b in the runlist, role a sets default_attribute node[:foo] = 23 and role b sets node[:foo] = 42 - which one wins?
[2012-05-02 08:59:07 -0400] erikh: you still need the 'depends', but your 'hg' resource is now called 'mercurial'
[2012-05-02 08:59:20 -0400] fish_: "if more than one role attempts to set a default value for the same attribute, the last role applied will win."
[2012-05-02 08:59:23 -0400] erikh: so mercurial "repo" do...
[2012-05-02 08:59:24 -0400] erikh: etc
[2012-05-02 08:59:37 -0400] fish_: but when role a has role b in the runlist, which role is applied last?
[2012-05-02 08:59:58 -0400] erikh: test, but I'd expect whichever gets run last to win
[2012-05-02 09:00:04 -0400] erikh: err, first, since it's a default
[2012-05-02 09:00:20 -0400] erikh: the simpler suggestion is "don't do that"
[2012-05-02 09:00:46 -0400] louallen: @erikh, i try that but then there is another error... let me run it with mercurial "repo" do to see the error
[2012-05-02 09:00:57 -0400] erikh: ok, sounds great.
[2012-05-02 09:03:24 -0400] louallen: This is the error that I get
[2012-05-02 09:03:25 -0400] louallen: FATAL: NoMethodError: mercurial[/tmp] (vokkaweb::default line 22) had an error: NoMethodError: undefined method `command' for #<Chef::Provider::Mercurial:0x7fd9a519f9e8>
[2012-05-02 09:03:26 -0400] BryanWB: miah: still awake?
[2012-05-02 09:03:44 -0400] louallen: seems like it cant find the command method? which is weird
[2012-05-02 09:05:38 -0400] louallen: for reference here is the provider from opscode-community https://github.com/opscode-cookbooks/mercurial/blob/master/providers/default.rb
[2012-05-02 09:09:50 -0400] erikh: louallen: ok, that's probably because the provider is different
[2012-05-02 09:10:17 -0400] erikh: https://github.com/opscode-cookbooks/mercurial/blob/master/resources/default.rb
[2012-05-02 09:10:21 -0400] erikh: no command attribute
[2012-05-02 09:14:44 -0400] louallen: im not adding a command attribute though, its the one that's being called by the provider
[2012-05-02 09:14:58 -0400] louallen: via link I provided
[2012-05-02 09:16:41 -0400] louallen: https://github.com/opscode-cookbooks/mercurial/blob/master/providers/default.rb
[2012-05-02 09:21:10 -0400] erikh: that's the execute resource
[2012-05-02 09:21:11 -0400] erikh: odd.
[2012-05-02 09:21:16 -0400] erikh: louallen: yeah, I'm stumped there.
[2012-05-02 09:22:50 -0400] louallen: but I agree with using mercurial instead of hg... seems like the README needs some correction, but with my problem im stumped too... does the command method need a depends somewhere?
[2012-05-02 09:23:02 -0400] erikh: no
[2012-05-02 09:23:08 -0400] erikh: it shouldn't, that's a standard resource
[2012-05-02 09:23:17 -0400] erikh: the execute resource that is
[2012-05-02 09:23:41 -0400] louallen: maybe an error on how they are calling/using it?
[2012-05-02 09:23:44 -0400] erikh: you might want to see if you can get in touch with jtimberman around 9-10am PST
[2012-05-02 09:23:51 -0400] erikh: probably, but I'm not sure what could be wrong there.
[2012-05-02 09:28:32 -0400] louallen: thanks erikh! glad to know it's not entirely my fault that it's giving out the error... hahaha
[2012-05-02 09:29:26 -0400] erikh: yeah, I'm missing something important here, but it looks entirely like you can either edit the provider, or wait until someone fixes it -- it's not something you're doing at this point.
[2012-05-02 09:30:30 -0400] fish_: chef's node attributes are so confusing.. we set default attributes in cookbooks as defaults and overwrite them in roles for node specific purposes
[2012-05-02 09:31:48 -0400] fish_: and we have roles including other role to build a specific role for a group of servers. but now we ran into problems using default attributes for that. because a role a including role b isn't able to override default attributes from role b (although I would expect that, but we might disagree on that)
[2012-05-02 09:32:58 -0400] fish_: anyway: Now I'm asking myself what would be the proper way? chef is soo flexible that it has so many ways to do something and it's a hard time running down the deadly road and then try a different
[2012-05-02 09:39:30 -0400] zts: fish_: I may be misunderstanding your description, but one role's "override" attribute should trump another role's "default" attribute, no matter which includes which
[2012-05-02 09:39:40 -0400] zts: fish_: see http://wiki.opscode.com/display/chef/Attributes#Attributes-AttributeTypeandPrecedence
[2012-05-02 09:39:55 -0400] zts: fish_: sorry, I meant http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-05-02 09:41:03 -0400] fish_: zts: yes, but I like to use only default attributes. I could also use override attributes but then I wouldn't be able to override them
[2012-05-02 09:41:49 -0400] fish_: zts: what I'm trying to do is define very generic roles, for example a 'mysql' role where basic mysql nagios checks are defined, the cookbook installing the server is included and similar stuff
[2012-05-02 09:42:39 -0400] fish_: then I have a mysql-whateverdb-master, which includes 'mysql' and is more specific: beside everything it includes via the mysql role, it also defined a data base and master replica attributes
[2012-05-02 09:43:13 -0400] fish_: uhm, bad example: let say I have mysql-whateverdb-slave which accordentialy defined slave replica attributes and so on
[2012-05-02 09:44:23 -0400] fish_: then I have mysql-whateverdb-slave-clientgroup-a which includes mysql-whateverdb-slave but tunes the nagios alerts for example because, let's say, for the clientgroup it's expected that we will have some more slow queries here
[2012-05-02 09:45:00 -0400] fish_: zts: makes sense? that's what I though is a pretty clean and redundancy free way to use chef
[2012-05-02 09:45:58 -0400] fish_: but in a nagios check (=> just a ordinary node attribute) is alread set in mysql, I can't readjust it in mysql-whateverdb-slave
[2012-05-02 09:46:39 -0400] fish_: I could use override for that, but if I like to readjust (override) that attribute in mysql-whateverdb-slave-clientgroup-a now - I can't do that because there is no override-override ;)
[2012-05-02 09:47:44 -0400] zts: fish_: it sounds like you need to read up on Deep Merging: http://wiki.opscode.com/display/chef/Deep+Merge
[2012-05-02 09:48:08 -0400] zts: fish_: that governs how attributes are merged when multiple roles are setting things at the same precedence
[2012-05-02 09:48:12 -0400] fish_: it would be easy to do all that if attributes in role a (in the same precedence level) would override all attributes included from another role.
[2012-05-02 09:49:12 -0400] fish_: zts: thanks, but I think I got that. it's more a question on how to do it right..
[2012-05-02 09:50:33 -0400] zts: fish_: in that case, I guess I am confused, sorry.  It would probably be best to gist an example showing what you've tried, and how that differs from what you want to achieve
[2012-05-02 09:51:11 -0400] zts: (unless someone else in here jumps in with suggestions)
[2012-05-02 09:51:17 -0400] masterkorp: How can i see the full output of the commands ?
[2012-05-02 09:53:40 -0400] fish_: when I would try to code something like that in a object orientated language, I would start with a 'mysql' base class and inherit from it to more and more specific classes. that what I tried to do with roles
[2012-05-02 09:55:56 -0400] zts: fish_: I'd personally manage that via data bags, rather than loads of roles.  However, I don't believe that using roles for that is necessarily wrong - just not something that I do, so I don't really have good advice about it
[2012-05-02 10:00:01 -0400] louallen: erikh, you still there? found the error in the mercurial provider
[2012-05-02 10:11:36 -0400] fish_: I think all this comes down to: in role a I can inherit attributes from role b by including it into the run_list - but I can't change them. Isn't that a very limiting, counter intuitive design decision?
[2012-05-02 10:13:18 -0400] fish_: it probably makes sense: role a is in run_list on node Z, role a has role b in the run_list - that get's appended to node Z's run_list. so in fact node Z's run_list looks like this: role[a], role[b] - and the last role wins
[2012-05-02 10:14:12 -0400] fish_: but it breaks the idea of describing your infrastructure by using roles and inherit from global roles
[2012-05-02 10:17:41 -0400] zts: fish_: Role A can't inherit attributes - a node has attributes, a role merely influences them
[2012-05-02 10:18:41 -0400] fish_: yes, but a node with role a has also attributes from role b when role a adds role b to the run list
[2012-05-02 10:19:33 -0400] zts: fish_: correct.  But it's not an issue of inheritance - if you are trying to bring an OO model to how Chef works, things are definitely going to seem counter-intuitive and/or broken.
[2012-05-02 10:20:07 -0400] zts: (and I've been there, so I know where you're coming from)
[2012-05-02 10:20:24 -0400] fish_: yes, I realized that. now I'm wondering what's the right way to do that. I want to have defaults for all our mysql servers and more specific stuff for some of them
[2012-05-02 10:21:19 -0400] fish_: maybe I should just stop to include roles in roles. this should help
[2012-05-02 10:22:30 -0400] zts: As I said earlier, there is probably someone in this channel (apparently not awake right now!) who uses roles the way you are trying to do, so you might get some good advice later in the day when the USA has woken up
[2012-05-02 10:23:28 -0400] zts: but for me, a server's run list usually contains a base role + a role for the service it runs
[2012-05-02 10:24:11 -0400] zts: both of which will often have run_lists which include other roles
[2012-05-02 10:24:43 -0400] fish_: but it would make encoding the purposes of a role even more concise if you would inclode that base role in the server specific role. but yes, than you would run into that problem
[2012-05-02 10:25:36 -0400] zts: indeed, some people might recommend rolling everything up so that you have a single role in your node's run_list, and nothing else
[2012-05-02 10:28:25 -0400] zts: but note that it doesn't make any difference to attribute resolution whether the role is on the node's run_list directly, or included from another role that is
[2012-05-02 10:28:31 -0400] fish_: yes, and I would say: this isn't possible with chef
[2012-05-02 10:28:42 -0400] zts: Chef resolves the run list first, and then the attributes
[2012-05-02 10:28:49 -0400] fish_: it makes a difference
[2012-05-02 10:29:09 -0400] fish_: if you apply those roles directly to the node, you can order it like you want
[2012-05-02 10:29:23 -0400] fish_: if you include role b in role a, role b is always after role a
[2012-05-02 10:30:09 -0400] fish_: so you can't override a attribute in role a which was set in role b if you have to use the same precedence level
[2012-05-02 10:30:18 -0400] zts: right, it's the order of the expanded run list that matters, not how things got there
[2012-05-02 10:30:47 -0400] zts: you could, for your purpose, create a container role which sets no attributes, just lists the roles you care about in the order you want
[2012-05-02 10:30:51 -0400] zts: and then put that on your node's run_list
[2012-05-02 10:32:00 -0400] fish_: that really sounds like a good idea..
[2012-05-02 10:33:13 -0400] fish_: so we could say we have to kind of roles: roles defining attributes and including cookbooks and roles wrapping up other roles to build a specific role implementing a node/server
[2012-05-02 12:36:49 -0400] ProfFalken: BryanWB: just listened to the FF podcast - much better audio quality
[2012-05-02 12:37:01 -0400] ProfFalken: nice to know that so many are doing stuff with testing now
[2012-05-02 12:38:54 -0400] ProfFalken: a bit shameless I know, but I gave a talk to a load of developers on how to help sysadmins implement testing: http://vimeo.com/40922357
[2012-05-02 12:39:00 -0400] ProfFalken: might be of use to some here...
[2012-05-02 12:40:22 -0400] BryanWB: ProfFalken: tks
[2012-05-02 12:40:47 -0400] BryanWB: ProfFalken: i know i keep meaning to watch it, but i am terribly at watching presentations
[2012-05-02 12:41:05 -0400] BryanWB: wish there was audio version
[2012-05-02 12:48:14 -0400] yfeldblum: BryanWB, good morning
[2012-05-02 12:49:43 -0400] BryanWB: yfeldblum: morning homez
[2012-05-02 12:50:48 -0400] BryanWB: ProfFalken: i am watching a bit and it's really good, any way i can get the audio, too distracting to have going on while at work
[2012-05-02 12:51:42 -0400] ProfFalken: BryanWB: I'll see what I can do...
[2012-05-02 12:52:28 -0400] Jean: I am trying to modify an existing Chef Provider. Is it possible to have the reevaluate the state of the machine in the middle of an install process? It seems my code that does this runs BEFORE the actual changes are made and so they aren't picked up...
[2012-05-02 12:53:36 -0400] BryanWB: ProfFalken: tks
[2012-05-02 12:53:42 -0400] Jean: so I have an execute block, then an if/else statement which sets some variables and then another execute block, but the variables in the if/else aren't correct. Any thoughts?
[2012-05-02 12:53:59 -0400] BryanWB: ProfFalken: and i will happily include links to the vid and audio in next foodfight
[2012-05-02 12:54:26 -0400] BryanWB: Jean: the variables are populated at collection time, not run-time
[2012-05-02 12:55:24 -0400] Jean: BryanWB: I thought as much. Anything I can do about this? The idea is that during run-time, a volume gets mounted, I then need to run a command that returns all the volumes and get the correct one. Obviously I can't do this at collection time because the volume hasn't been mounted yet.
[2012-05-02 12:57:24 -0400] BryanWB: hmm
[2012-05-02 12:58:25 -0400] BryanWB: i recommend using a ruby_block instead of execute
[2012-05-02 12:59:13 -0400] BryanWB: that may fix your issue but i would have to look at your execute to be srue
[2012-05-02 13:00:33 -0400] yfeldblum: Jean, you're doing it wrong (is it just me, or do i say that quite frequently? :)
[2012-05-02 13:00:47 -0400] yfeldblum: Jean, your recipe *decrees* what shall be; it doesn't ask
[2012-05-02 13:01:37 -0400] Philipp_: how can I limit the data_bags files which are synced via knife cook? for example I do not want databag\shops\shop1.json on customer 2 node and shop2.json not on customer 1 either
[2012-05-02 13:01:42 -0400] yfeldblum: Jean, that's why you get the first step, where you can use normal ruby to figure out what you want to decree and to decree it, and the second step, where Chef obeys your orders and punishes the system exactly like you specified
[2012-05-02 13:03:43 -0400] Jean: yfeldblum: Hmm I see. But in that case, I'd have to mount the volume in the first step, do my checks on it which set the variables, and execute on it in the second step?
[2012-05-02 13:03:59 -0400] yfeldblum: Jean, what checks?
[2012-05-02 13:04:52 -0400] yfeldblum: Philipp_, you're doing it wrong; data bags are the "tables" in a globally-available database that all chef-clients can read; all nodes have REST and search access to all data bag items in all data bags
[2012-05-02 13:07:35 -0400] Jean: yfeldblum: See https://gist.github.com/2576419 for a small snippet. Basically 1. Mount image, 2. Determine volume name of the mounted image, 3. act on volume
[2012-05-02 13:09:15 -0400] yfeldblum: Jean, i would treat all of that as a *single* resource; the simple approach is to put all of that into a ruby_block's block attribute, and use Mixlib::ShellOut directly rather than the execute resource
[2012-05-02 13:09:53 -0400] yfeldblum: Jean, another approach is to do similar, but to write a lightweight resource & provider to contain that code
[2012-05-02 13:10:58 -0400] Philipp_: yfeldblum how would you recommend me to solve this issue?
[2012-05-02 13:11:01 -0400] Jean: yfeldblum: This is an existing lwrp from here: https://github.com/opscode-cookbooks/dmg, I am trying to modify it to learn chef and to use it on my system.
[2012-05-02 13:11:34 -0400] yfeldblum: Jean, also, no reason to use an execute resource just to run "cp -R"; you can use use FileUtils.cp_r, which is part of the ruby stdlib, from a ruby_block
[2012-05-02 13:13:25 -0400] Philipp_: yfeldblum where do you store customer specific information?
[2012-05-02 13:13:56 -0400] yfeldblum: Philipp_, you asked how to achieve a particular solution (which i said is doing it wrong) ... but what's the underlying issue?
[2012-05-02 13:14:51 -0400] Philipp_: the underlying issue is that I am looking for a solution to deploy webservers (apache, nginx and so on) to hundreds of servers
[2012-05-02 13:15:07 -0400] Philipp_: some servers belong to customer a, some to customer b...
[2012-05-02 13:15:38 -0400] Philipp_: I do not want to store customer a information on a customer b host
[2012-05-02 13:18:06 -0400] yfeldblum: Philipp_, why not?
[2012-05-02 13:19:16 -0400] Philipp_: imagine a hacker has access to a customer a host
[2012-05-02 13:19:31 -0400] Philipp_: he should not know things about customer b
[2012-05-02 13:20:24 -0400] yfeldblum: Philipp_, do customers have root on these hosts?
[2012-05-02 13:20:27 -0400] Philipp_: I am not speaking of 1-2 customers I mean having 500+ servers with 100+ customers...
[2012-05-02 13:21:07 -0400] BryanWB: Philipp_: use encrypted databags
[2012-05-02 13:21:40 -0400] BryanWB: and the only those hosts need access to databag X  have the key to access it
[2012-05-02 13:21:45 -0400] yfeldblum: BryanWB, that's 100 customer-specific keys to manage
[2012-05-02 13:22:01 -0400] BryanWB: Philipp_: but you have to distribute and manage those keys
[2012-05-02 13:22:09 -0400] BryanWB: as yfeldblum correctly points out
[2012-05-02 13:22:45 -0400] Philipp_: In case of an attack you would not want to have 100x databags of all other customers laying on a single server
[2012-05-02 13:23:12 -0400] Philipp_: nobody would want that encrypted or not
[2012-05-02 13:23:13 -0400] BryanWB: Philipp_: those databags live on the chefserver
[2012-05-02 13:23:22 -0400] BryanWB: not downloaded w/ cookbooks
[2012-05-02 13:24:10 -0400] yfeldblum: BryanWB, but they can be gotten to by anyone with root that can invoke shef, & if opscode implements proper data bag item caching with etags/last-modified/expires/cache-control, they may start living on the node
[2012-05-02 13:24:26 -0400] BryanWB: yfeldblum: true
[2012-05-02 13:24:42 -0400] Philipp_: so these datbags are pushed via rest? from chef server?
[2012-05-02 13:24:48 -0400] BryanWB: yup
[2012-05-02 13:25:18 -0400] BryanWB: so if u want to pay someone to implement a more secure solution, i am sure opscode consulting would be happy to assist u
[2012-05-02 13:25:40 -0400] Philipp_: at present I am using chef solo without chef server
[2012-05-02 13:26:52 -0400] Philipp_: what about encrypting databags, is it possible to have a databag folder like "shops" containing shop1.json, shop2.json each encrypted using a different key?
[2012-05-02 13:27:07 -0400] Philipp_: or do they have to use the same key within the same folder?
[2012-05-02 13:28:26 -0400] BryanWB: u can use different keys
[2012-05-02 13:30:07 -0400] yfeldblum: Philipp_, if you're using chef-solo, you can implement a build step for your repo
[2012-05-02 13:30:08 -0400] Jean: yfeldblum: Thank you for the help. I moved it all together in a single ruby_block and it works great. Thanks! Here is the script, in case you have any more insightful comments :) https://gist.github.com/2576419
[2012-05-02 13:30:58 -0400] yfeldblum: Philipp_, in this build step, you give the name of the customer, and the build step command creates a tarball of the whole repository except only including the data bag items pertaining to that customer
[2012-05-02 13:31:29 -0400] yfeldblum: Philipp_, you never clone the repo into the nodes; you always copy the tarball from a built copy of the repo, but built for that customer, onto a node
[2012-05-02 13:32:24 -0400] yfeldblum: Jean, np, that looks fine
[2012-05-02 13:33:23 -0400] yfeldblum: Jean, in the end, your recipes are Just Plain Old Ruby ... sometimes you can use the declarative resources that opscode provides, but sometimes you just need a ruby_block with ruby code :P
[2012-05-02 13:33:53 -0400] BryanWB: POROS FTW!
[2012-05-02 13:34:44 -0400] Jean: yfeldblum: I noticed yeah. Now that I understand the flow of the provider it's much easier to understand what is happening. I figured the code would be executed from top to bottom, with load_current_resource always being executed first. But it seems that all ruby code outside of a block is also run directly after load_current_resource, and before all the blocks in the provider, correct?
[2012-05-02 13:35:38 -0400] Philipp_: yfeldblum I already built a deploy script which does rsync with an include / exclude list
[2012-05-02 13:36:13 -0400] Philipp_: It would be great to integrate this into the knife solo cook command
[2012-05-02 13:38:11 -0400] Philipp_: but this could be the solution... my script just rsync everything to a tmp folder and calls knife cook from there reusolting in having onyl my content synced...
[2012-05-02 13:45:19 -0400] yfeldblum: Jean, lightweight providers are just a very thin syntax sugar over normal Chef::Provider subclasses like https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/remote_file.rb
[2012-05-02 13:47:57 -0400] yfeldblum: Philipp_, write your own knife plugin that monkey-patches knife-cook, particularly this method here: https://github.com/matschaffer/knife-solo/blob/master/lib/chef/knife/cook.rb#L87-89
[2012-05-02 13:56:35 -0400] Philipp_: can you give me a hint how to monkey-patch knife-cook?
[2012-05-02 13:56:59 -0400] Philipp_: I tried this but it doesn't work http://pastebin.com/KPrS6wnP
[2012-05-02 13:57:43 -0400] cjs226: is it possible to use uptime_seconds as a search criteria?  I've tried <knife search node "uptime_seconds:[0 TO 600]"> but it returns all nodes, not just those up for 10 minutes or less
[2012-05-02 14:01:38 -0400] tube: is it really neccessary to create an account in the ticket system to report a bug? i dont wanna get developer emails and the stuff
[2012-05-02 14:04:09 -0400] yfeldblum: Philipp_, undo that!
[2012-05-02 14:06:22 -0400] Philipp_: why? what's wrong?
[2012-05-02 14:06:37 -0400] yfeldblum: Philipp_, when you monkey-patch, you always do it in your own codebase (even when you're monkey-patching someone else's code) ... you don't open up their file and change it
[2012-05-02 14:07:15 -0400] Philipp_: I haven't modified the file I just copied it to knife.custom ...
[2012-05-02 14:07:16 -0400] yfeldblum: Philipp_, you can also fork the knife-cook repository on github, make your changes, gem install your forked copy, and submit a pull request to include your changes in the original
[2012-05-02 14:07:58 -0400] yfeldblum: Philipp_, ok, so rm it
[2012-05-02 14:18:33 -0400] Philipp_: thanks yfeldblum
[2012-05-02 14:18:39 -0400] Philipp_: have a nice day
[2012-05-02 14:20:25 -0400] ProfFalken: BryanWB: http://os.greenandsecure.co.uk/PagerWhatPager.mp3
[2012-05-02 14:20:38 -0400] BryanWB: ProfFalken: tks!
[2012-05-02 14:20:41 -0400] ProfFalken: (there's about 10 minutes of "dead sound" at the beginning, but it should be OK
[2012-05-02 14:20:44 -0400] ProfFalken: )
[2012-05-02 14:21:04 -0400] ProfFalken: BTW - Please don't link to that from outside this room - I can't afford the bandwidth! :)
[2012-05-02 14:27:04 -0400] flashmanbahadur: hehe this is nice
[2012-05-02 14:27:07 -0400] flashmanbahadur: who is speaking?
[2012-05-02 14:27:30 -0400] flashmanbahadur: ProfFalken:
[2012-05-02 14:27:49 -0400] BryanWB: ProfFalken: ouch so don't put in upcoming show notes?
[2012-05-02 14:28:12 -0400] BryanWB: uhoh, i think you've gone viral ;)
[2012-05-02 14:28:24 -0400] flashmanbahadur: haha
[2012-05-02 14:37:51 -0400] cjs226: how, from within a recipe or knife, can i search for nodes that have been up for less than 10 minutes?
[2012-05-02 14:46:51 -0400] eherot: cjs226: there is an uptime property in the node data
[2012-05-02 14:47:22 -0400] ProfFalken: BryanWB: not the audio, no - link to the video all you like... :)
[2012-05-02 14:47:23 -0400] eherot: you could presumably search for that although it would be pretty hard to get the search to narrow the results based on the time.  You would probably have to do further parsing on the data after you downloaded it in order to get that.
[2012-05-02 14:47:36 -0400] eherot: also uptime_seconds (probably easier to work with)
[2012-05-02 14:47:37 -0400] ProfFalken: flashmanbahadur: that's me speaking... :)
[2012-05-02 14:47:46 -0400] flashmanbahadur: ProfFalken: nice, its good
[2012-05-02 14:47:51 -0400] BryanWB: ProfFalken: done
[2012-05-02 14:47:52 -0400] ProfFalken: thanks.
[2012-05-02 14:47:52 -0400] cjs226: eherot: thx.  i've tried using uptime_seconds which is in the node data <knife search node "uptime_seconds:[0 TO 600]"> but it returns all nodes, not just those up for 10 minutes or less
[2012-05-02 14:48:05 -0400] flashmanbahadur: ProfFalken: you are describing most of my previous 2 years before switching companies
[2012-05-02 14:48:20 -0400] ProfFalken: flashmanbahadur: there's a video available as well at http://vimeo.com/40922357
[2012-05-02 14:48:30 -0400] hcastro: do chef node names span across chef environments?
[2012-05-02 14:48:36 -0400] ProfFalken: the video has lolcats...
[2012-05-02 14:48:39 -0400] eherot: cjs226: yeah as far as I know solr is not well designed in this case to limit results in that way
[2012-05-02 14:48:41 -0400] flashmanbahadur: rofl
[2012-05-02 14:48:58 -0400] eherot: cjs226: In places in my system where I've had to do that I've just ended up downloading all 14M of node data and parsing it.
[2012-05-02 14:49:32 -0400] cjs226: eherot: it's weird, knife search node "cpu_total:[2 TO 4]" works perfectly
[2012-05-02 14:52:05 -0400] eherot: looks like that trick works on uptime_seconds too
[2012-05-02 14:52:45 -0400] eherot: knife search node "uptime_seconds:[11527419 TO 11528420]" just returned 3 results for me
[2012-05-02 14:54:45 -0400] cjs226: eherot: it's erroneous for me.  see http://pastebin.com/aZjSArCg
[2012-05-02 14:59:16 -0400] yfeldblum: ProfFalken, coincidentally, all occasions when one might also hire a chef
[2012-05-02 14:59:40 -0400] ProfFalken: yfeldblum: good spotting, you win two internets....
[2012-05-02 15:00:27 -0400] eherot: cjs226: ahhhh, this search is definitely returning all of the "uptimes" that start with the numbers you specify
[2012-05-02 15:01:14 -0400] cjs226: eherot: ah, you're right.  not quite what i need :/
[2012-05-02 15:01:53 -0400] eherot: kind of a useless way to search for a range
[2012-05-02 15:02:29 -0400] eherot: and actually, when you read the description on the search by range feature on the opscode site, it seems just that useless :-) http://wiki.opscode.com/display/chef/Search#Search-RangeSearch
[2012-05-02 15:03:39 -0400] cjs226: bummer.  there must be a way to do this
[2012-05-02 15:09:59 -0400] eherot: http://wiki.apache.org/solr/SolrQuerySyntax
[2012-05-02 15:10:24 -0400] eherot: cjs226: although [* TO 600] definitely doesn't do what you want
[2012-05-02 15:10:44 -0400] eherot: I suspect this is not being thought of as a numeric value by this database which may make this challenging...
[2012-05-02 15:15:47 -0400] geekbri: So Im being a bit of a rube here, how would you knife ssh to a single node?
[2012-05-02 15:16:28 -0400] qhartman_: set your search to node.name ?
[2012-05-02 15:17:42 -0400] geekbri: well i tried knife ssh "node:my.node.name" but it didn't seem to like that
[2012-05-02 15:18:09 -0400] qhartman_: try "node.name:your-name" instead
[2012-05-02 15:18:48 -0400] qhartman_: I'm finding that node names don't seem to be stored the same way as other values and you need ot use the .name trick to refer to them
[2012-05-02 15:18:49 -0400] geekbri: doesnt seem to care for that.
[2012-05-02 15:18:51 -0400] qhartman_: hm
[2012-05-02 15:18:57 -0400] qhartman_: then I got nuthin. sorry.
[2012-05-02 15:19:08 -0400] geekbri: hrm
[2012-05-02 15:22:09 -0400] geekbri: qhartman_: I didn just name: and it seems to be working now
[2012-05-02 15:22:55 -0400] cjs226: eherot: yup, i went down that road too
[2012-05-02 15:23:24 -0400] eherot: cjs226: Great.  Now I'm going to spend the whole day wondering about this
[2012-05-02 15:23:40 -0400] cjs226: eherot: welcome to my world ;-)
[2012-05-02 15:25:51 -0400] Urocyon: solr search == path to madness!
[2012-05-02 15:28:05 -0400] cg1: Urocyon: so true!
[2012-05-02 15:28:13 -0400] eherot: cjs226: And this definitely adds to the trouble: "You cannot use a * or ? symbol as the first character of a search."
[2012-05-02 15:28:33 -0400] cjs226: eherot: agreed
[2012-05-02 15:31:19 -0400] yfeldblum: the name is not a node attribute
[2012-05-02 15:31:43 -0400] yfeldblum: you can use e.g. fqdn or hostname
[2012-05-02 15:32:32 -0400] spyvsspy: is ohai, what checks everything in by default?
[2012-05-02 15:32:43 -0400] spyvsspy: network/fqdn/etc etc
[2012-05-02 15:32:56 -0400] spyvsspy: or is that the chef-client?
[2012-05-02 15:33:12 -0400] tomoj: `knife search node name:node-name` seems to work for me
[2012-05-02 15:33:15 -0400] tomoj: maybe I misunderstood
[2012-05-02 15:33:38 -0400] eherot: cjs226: I wonder if it actually uses RangeQuery http://lucene.apache.org/core/old_versioned_docs/versions/2_9_0/api/all/org/apache/lucene/search/RangeQuery.html
[2012-05-02 15:33:49 -0400] eherot: which actually says "It is not intended for numerical ranges, use http://lucene.apache.org/core/old_versioned_docs/versions/2_9_0/api/all/org/apache/lucene/search/NumericRangeQuery.html instead."
[2012-05-02 15:35:11 -0400] tomoj: geekbri: so `knife ssh name:my.node.name`
[2012-05-02 15:35:48 -0400] cjs226: eherot: I'm thinking in need to try something elsewe're veering into a ditch
[2012-05-02 15:35:59 -0400] geekbri: tomoj: I was using knife ssh, knife ssh "name:my.node.name" 'command' -x blah working for me
[2012-05-02 15:36:00 -0400] eherot: cjs226: I think you're right.
[2012-05-02 15:36:26 -0400] cjs226: in a recipe i could query for uptime_seconds then use ruby from there.  not as clean, but it should work
[2012-05-02 15:36:29 -0400] eherot: cjs226: although if you could get it to return only servers with the right number of characters in the uptime string, that would get you a lot closer
[2012-05-02 15:36:54 -0400] cjs226: to a point, I'm wanting less than 10 minutes
[2012-05-02 15:37:33 -0400] eherot: cjs226: Right but at least if you could get back everything under 999 seconds, it would be a lot more practical to further limit the results using simple ruby code
[2012-05-02 15:37:41 -0400] eherot: at least the search would take about the same amount of time
[2012-05-02 15:38:02 -0400] cjs226: eherot: good point, thx
[2012-05-02 15:38:14 -0400] eherot: np
[2012-05-02 16:18:47 -0400] spyvsspy: http://wiki.opscode.com/display/chef/Writing+Ohai+Plugins  Im messing around with this trying to write custom plugins
[2012-05-02 16:19:10 -0400] spyvsspy: I keep getting => nil nad I have tried all variations of it when i call o.orly
[2012-05-02 16:19:24 -0400] spyvsspy: I cd to the directory that contains orly.rb, and used ./ as the path
[2012-05-02 16:19:29 -0400] spyvsspy: tried calling the whole path etc
[2012-05-02 16:31:01 -0400] bakins: chef_handlers consuming all the RAM on a box - known issue? I found one bug report
[2012-05-02 16:33:38 -0400] yfeldblum: bakins, what are the handlers doing?
[2012-05-02 16:33:50 -0400] bakins: just the built in json one, for example
[2012-05-02 16:34:07 -0400] bakins: was trying the gelf one out as well
[2012-05-02 16:34:29 -0400] bakins: CHEF-2694 was bug I found
[2012-05-02 16:36:54 -0400] bakins: it's not every node, but some run lists seem to cause it to go into a death spiral
[2012-05-02 16:38:22 -0400] spyvsspy: whats hte best way to track a serial number on the webui?
[2012-05-02 16:38:49 -0400] spyvsspy: I was thinkign about creating a file called /etc/serial upon install, and writing a ohai plugin to check that in when chef-client runs
[2012-05-02 16:38:54 -0400] spyvsspy: is there a better way to do this?
[2012-05-02 16:45:43 -0400] hoover_damn: spyvsspy, is the serial number in the bios?
[2012-05-02 16:45:52 -0400] spyvsspy: Im not sure
[2012-05-02 16:45:55 -0400] hoover_damn: spyvsspy, if it's queryable via dmidecode
[2012-05-02 16:45:58 -0400] hoover_damn: it's already in chef
[2012-05-02 16:46:27 -0400] spyvsspy: ah
[2012-05-02 16:46:29 -0400] spyvsspy: nice
[2012-05-02 16:47:08 -0400] hoover_damn: chef > node['dmi']['base_board'] => #<Chef::Node::Attribute @auto_vivifiy_on_read=false, @automatic={...}, @override={...}, @current_default=nil, @has_been_read=false, @current_nesting_level=["dmi", "base_board"], @normal={...}, @current_normal=nil, @set_type=nil, @current_automatic={"serial_number"=>"123456789000", "all_records"=>[{"record_id"=>"0x0003", "Serial Number"=>"123456789000", "size"=>"2", "Version"=>"1.XX    ", "application_identifier"=>"Base 
[2012-05-02 16:47:15 -0400] hoover_damn: chef > node['dmi']['base_board']['serial_number'] => "123456789000"
[2012-05-02 16:47:25 -0400] hoover_damn: it's already there for you
[2012-05-02 16:47:43 -0400] spyvsspy: what is that ?
[2012-05-02 16:47:44 -0400] spyvsspy: irb?
[2012-05-02 16:47:56 -0400] hoover_damn: shef
[2012-05-02 16:50:13 -0400] spyvsspy: thx
[2012-05-02 16:57:57 -0400] afallows: Hey chefs - I've gotten this error a number of times, intermittently, and I'm still fuzzy on the cause. Has anyone experienced it before? https://gist.github.com/2578204 (tl;dr - knife-ec2 doesn't parse the -r flag correctly)
[2012-05-02 17:00:10 -0400] hoover_damn: afallows, -r 'role[bob]'
[2012-05-02 17:00:27 -0400] hoover_damn: afallows, doing -r role[bob] is goign to make your shell act differently i'm afraid
[2012-05-02 17:00:44 -0400] afallows: hoover_damn: any idea why it would work sometimes and not work other times?
[2012-05-02 17:01:01 -0400] hoover_damn: afallows, what shell do you normally run?
[2012-05-02 17:01:31 -0400] hoover_damn: afallows, I totally agree it shouldn't matter but i've seen the same behavior and that simple single quote has saved me
[2012-05-02 17:01:46 -0400] afallows: hoover_damn: bash mostly.
[2012-05-02 17:02:19 -0400] hoover_damn: afallows, bash is a little more forgiving on usage of []'s but I do zsh and if i don't escape them
[2012-05-02 17:02:23 -0400] hoover_damn: i have to escape them otherways
[2012-05-02 17:02:31 -0400] hoover_damn: -r role\[bob\]
[2012-05-02 17:04:59 -0400] afallows: hoover_damn: Good point, I actually forgot somehow that [] are often syntactic in bash.
[2012-05-02 17:12:37 -0400] spyvsspy: any thing that provides the video card model?
[2012-05-02 17:14:04 -0400] hoover_damn: spyvsspy, hrm you could likely make an attribute run lspci
[2012-05-02 17:14:11 -0400] hoover_damn: spyvsspy, and then you can index the pci cards
[2012-05-02 17:14:16 -0400] hoover_damn: and search those
[2012-05-02 17:14:57 -0400] spyvsspy: make a new cookbook?
[2012-05-02 17:15:07 -0400] spyvsspy: im pretty new obv to chef
[2012-05-02 17:15:07 -0400] hoover_damn: yep
[2012-05-02 17:15:27 -0400] hoover_damn: spyvsspy, all attributes are indexed.  So you would just want something to run lspci and collect the output and store it as attributes
[2012-05-02 17:16:07 -0400] jtimberman: if you're using zsh you can use noglob knife
[2012-05-02 17:16:19 -0400] jtimberman: noglob knife ec2 server craete ... -r role[thing']
[2012-05-02 17:16:19 -0400] hoover_damn: https://github.com/opscode-cookbooks/aws/blob/master/attributes/default.rb
[2012-05-02 17:16:30 -0400] hoover_damn: default[:pci]=`lspci -vv`
[2012-05-02 17:16:33 -0400] jtimberman: stray quote
[2012-05-02 17:16:36 -0400] hoover_damn: doubt it would work that easy
[2012-05-02 17:16:36 -0400] hoover_damn: but
[2012-05-02 17:16:40 -0400] miah: QUICK GET IT
[2012-05-02 17:16:44 -0400] hoover_damn: KILL IT
[2012-05-02 17:17:25 -0400] afallows: '
[2012-05-02 17:18:14 -0400] miah: hey now. don't make us call the aspca (americas special punctuation correctness association)
[2012-05-02 17:19:51 -0400] flashmanbahadur: are there any suggestions to avoiding ld.so issues?
[2012-05-02 17:20:05 -0400] miah: compile everything statically
[2012-05-02 17:20:36 -0400] flashmanbahadur: mmm k, how does that relate to it popping up in a chef-client run?
[2012-05-02 17:20:42 -0400] spyvsspy: hoover_damn, did work that easy
[2012-05-02 17:20:42 -0400] miah: it doesnt
[2012-05-02 17:20:43 -0400] spyvsspy: lol
[2012-05-02 17:20:44 -0400] spyvsspy: thanks
[2012-05-02 17:20:57 -0400] afallows: So, I'm having a kind of wtf moment with chef right now: https://gist.github.com/2578403
[2012-05-02 17:20:57 -0400] miah: you shouldn't be hitting those issues unless you're using a fubar ruby
[2012-05-02 17:21:07 -0400] flashmanbahadur: 1.9.3 on Ubuntu 12.04
[2012-05-02 17:21:20 -0400] flashmanbahadur: only happens when I launch, the second run completes fine
[2012-05-02 17:21:38 -0400] miah: weird, i haven't tried 12.04 yet
[2012-05-02 17:21:50 -0400] flashmanbahadur: i have seen the issue before on 11.10 and 1.8.7
[2012-05-02 17:22:01 -0400] flashmanbahadur: im thinking there is something loaded by chef that I update somehow
[2012-05-02 17:22:12 -0400] flashmanbahadur: then when I try to use it in the recipe it breaks
[2012-05-02 17:22:46 -0400] flashmanbahadur: i call aws_ebs_volume from inside a provider
[2012-05-02 17:22:50 -0400] flashmanbahadur: then it fails
[2012-05-02 17:22:57 -0400] flashmanbahadur: maybe i can update my aws cookbook
[2012-05-02 17:23:28 -0400] miah: it seems like you are loading something that requires a library you don't have installed, or it was compiled against a library that doesn't exist on your system
[2012-05-02 17:23:38 -0400] flashmanbahadur: yeah it seems like that
[2012-05-02 17:23:41 -0400] flashmanbahadur: but if that was the case
[2012-05-02 17:23:49 -0400] flashmanbahadur: the follow up chef-client run shouldnt work either
[2012-05-02 17:24:04 -0400] miah: ya
[2012-05-02 17:24:23 -0400] miah: your recipes aren't idempotent enough =)
[2012-05-02 17:24:33 -0400] flashmanbahadur: its very annoying when I find issues like this
[2012-05-02 17:25:20 -0400] miah: welcome to the wonderful world of operations
[2012-05-02 17:27:29 -0400] hoover_damn: don't let the small things bother you so much
[2012-05-02 17:28:32 -0400] flashmanbahadur: it bothers me when I cant launch an instance properly
[2012-05-02 17:29:23 -0400] miah: thats why you have a dev environment
[2012-05-02 17:29:50 -0400] hoover_damn: I have been having issues with rackspace launching instances reliabily for 4 days now
[2012-05-02 17:30:04 -0400] flashmanbahadur: i am doing it in the dev env, still annoying getting C lib errors from an opscode cookbook
[2012-05-02 17:30:06 -0400] hoover_damn: click create, wait 10 minutes... still not up
[2012-05-02 17:30:21 -0400] miah: opscode cookbooks aren't perfect
[2012-05-02 17:30:29 -0400] hoover_damn: opscode cookbooks are a good starting point
[2012-05-02 17:30:34 -0400] miah: no cookbook is really. add to that you're using a newly released distribution
[2012-05-02 17:30:37 -0400] hoover_damn: but they are far from what you should consider A+
[2012-05-02 17:30:47 -0400] hoover_damn: some cookbooks are worth it, some are not
[2012-05-02 17:31:01 -0400] miah: the number of cookbook forks i have is many =)
[2012-05-02 17:31:02 -0400] hoover_damn: learning to review cookbooks and take or pass will be a skill you pick up
[2012-05-02 17:31:25 -0400] senthilr: are there good cookbooks to manage sudoers
[2012-05-02 17:31:55 -0400] flashmanbahadur: hoover_damn: ive used it in the past, their AWS EBS cookbook usually works fine, it was very solid
[2012-05-02 17:32:04 -0400] flashmanbahadur: now getting all kinds of crazyness
[2012-05-02 17:33:53 -0400] flashmanbahadur: i want to say its due to issues with side loading gems, let me try monkey patching in the gem install before chef does it's first run
[2012-05-02 17:35:03 -0400] flashmanbahadur: nm i already install it
[2012-05-02 17:37:19 -0400] hoover_damn: flashmanbahadur, I've had very little issues with the AWS cookbook... it's dated and needs to be updated
[2012-05-02 17:37:22 -0400] hoover_damn: but it owkrs
[2012-05-02 17:37:23 -0400] hoover_damn: works*
[2012-05-02 17:37:42 -0400] flashmanbahadur: yeah
[2012-05-02 17:37:46 -0400] flashmanbahadur: havent had issues until now
[2012-05-02 17:40:16 -0400] rberger: Anyone know of a cookbook that has an  LWRP for managing EC2 Security Groups?
[2012-05-02 17:45:45 -0400] geekbri: I find a lot of the time (but not all) you can tell if a cookbook is worthwhile by the care taken in the readme.
[2012-05-02 17:46:33 -0400] afallows: Has anyone else seen issues with the directory resource in Ubuntu 12.04 EC2 instances?
[2012-05-02 17:46:43 -0400] chiopen: What's the best way to create a new user and add them to multiple groups?
[2012-05-02 17:46:44 -0400] afallows: I know not everyone has played with 12.04 yet.
[2012-05-02 17:47:01 -0400] flashmanbahadur: afallows: nothing yet, but I dont use it a ton
[2012-05-02 17:47:16 -0400] chiopen: The standard users cookbook only adds users to a single group
[2012-05-02 17:48:15 -0400] geekbri: one of my coworkers created an excellent cookbook for user management.  He plans on adding it to the community, let me see if hes added it yet.
[2012-05-02 17:48:42 -0400] chiopen: awesome!
[2012-05-02 17:49:15 -0400] geekbri: Looks like he hasn't released it yet.  Apologies.  I'll talk to him when hes back from lunch and see if I can get him to push it out there
[2012-05-02 17:49:18 -0400] senthilr: that'll be awesome
[2012-05-02 17:49:55 -0400] geekbri: its a pretty extensive and impressive cookbook.  Not sure why he hasn't put it out there yet.  He may not have had time to polish it up like he wants.
[2012-05-02 17:50:00 -0400] chiopen: Nice, thanks!
[2012-05-02 17:50:28 -0400] chiopen: It sounds like it might be better than hacking the usual users cookbook
[2012-05-02 17:51:07 -0400] geekbri: oh he put a lot of work into it.  It even handles different potential user settings and keys per chef environment.
[2012-05-02 17:51:20 -0400] chiopen: sounds perfect
[2012-05-02 17:51:25 -0400] geekbri: Ill poke him.
[2012-05-02 17:58:22 -0400] jperry2: hi guys, I'm having issues where I have chef installing the "zip" package and it keeps hanging when executing "apt-get -q -y install zip=3.0-4"
[2012-05-02 17:58:33 -0400] jperry2: running the command directly works fine
[2012-05-02 17:58:52 -0400] jperry2: but when run through chef it hangs because it can't fetch it for some reason
[2012-05-02 17:59:05 -0400] jperry2: any thoughts on what else I can try
[2012-05-02 17:59:21 -0400] yfeldblum: try --force-yes?
[2012-05-02 17:59:59 -0400] jperry2: okay let me try that to see if that helps it out
[2012-05-02 18:10:27 -0400] geekbri: jperry2: could it be an issue where you just need to apt-get update?
[2012-05-02 18:11:39 -0400] jperry2: I'll try that too
[2012-05-02 18:11:51 -0400] jperry2: but why does it only happen in chef?
[2012-05-02 18:11:55 -0400] geekbri: jperry2: if you include the apt cookbook i think it runs apt-get update in its default recipe
[2012-05-02 18:18:05 -0400] jperry2: yfeldblum: the force-yes didn't work
[2012-05-02 18:22:22 -0400] jperry2: so l'm thinking it has something to do vagrant/virtualbox
[2012-05-02 18:22:34 -0400] jperry2: it has trouble pulling things from us.archive.ubuntu.com
[2012-05-02 18:22:50 -0400] jperry2: doesn't have issues getting version info from it but when it needs to fetch a package it just hangs
[2012-05-02 18:23:09 -0400] jperry2: the host that is running a vagrant box doesn't have any issues hitting us.archive.ubuntu.com
[2012-05-02 18:42:08 -0400] jperry2: changing the network for vagrant to :bridged fixed the issue
[2012-05-02 18:46:33 -0400] rgsteele: What's the proper way to call Ruby commands (e.g., basename) within your recipes?  I'm sure I missed something simple: https://gist.github.com/2579132
[2012-05-02 18:48:41 -0400] rgsteele: Oh, I guess maybe File.basename...
[2012-05-02 18:48:49 -0400] StormSilver: rgsteele: Yep
[2012-05-02 18:49:31 -0400] StormSilver: rgsteele: You might have to do ::File.basename to get it to look at the top level namespace
[2012-05-02 18:49:42 -0400] rgsteele: Ah, okay, makes sense.
[2012-05-02 18:51:17 -0400] flashmanbahadur: update on the ld.so issue.  Seems to be coupled to used the dpkg_package provider in another recipe earlier in the build
[2012-05-02 18:51:22 -0400] afallows: Has anyone seen an issue like this one when using directory blocks? https://gist.github.com/2578403
[2012-05-02 18:51:40 -0400] flashmanbahadur: trying moving the dpkg usage until after where the error occurs to see if it persists.
[2012-05-02 18:52:45 -0400] afallows: I was able to get my recipe to work by changing the directory blocks to an execute that calls mkdir, but obviously I would prefer to use directory for sanity.
[2012-05-02 18:53:57 -0400] flashmanbahadur: afallows: what happens when you try to use stat on the directory created my the provider
[2012-05-02 18:56:47 -0400] afallows: flashmanbahadur: I get what seems to be normal output. I can gist it if you want
[2012-05-02 18:57:11 -0400] flashmanbahadur: sure do ls and stat for both the parent dir and the nested dir
[2012-05-02 18:58:05 -0400] flashmanbahadur: also, trying putting the mode in quotes instead of as an int
[2012-05-02 18:59:32 -0400] afallows: https://gist.github.com/2578403 <-- added to the bottom of same gist
[2012-05-02 19:00:39 -0400] rhoons: ohai chefs!
[2012-05-02 19:01:15 -0400] rhoons: so... i see that not too many of the questions on the opscode questions site get answered so i thought i may try my luck here:
[2012-05-02 19:01:32 -0400] flashmanbahadur: for ld.so issue, moving dpkg call until after aws_ebs_volume prevented the error
[2012-05-02 19:02:02 -0400] rhoons: is there a way for a client to "deregister" itself when it terminates?
[2012-05-02 19:03:51 -0400] rhoons: or more precisely, how do people deal with automatically culling defunct clients/nodes, like when an ec2 server terminates...
[2012-05-02 19:04:20 -0400] flashmanbahadur: rhoons: i have a script that does the termination that also takes care of cleaning up the node/client references
[2012-05-02 19:05:13 -0400] rhoons: @flashmanbahadur: does that use knife to do that? i think you see what i'm trying to do
[2012-05-02 19:05:22 -0400] flashmanbahadur: it could
[2012-05-02 19:05:30 -0400] flashmanbahadur: or it could make the calls via ruby
[2012-05-02 19:05:33 -0400] flashmanbahadur: or python, etc
[2012-05-02 19:05:34 -0400] coderanger: rhoons: The master version of knife-ec2 has a --purge option for that
[2012-05-02 19:06:00 -0400] coderanger: Or you can use AWS's notification stuffs
[2012-05-02 19:06:23 -0400] coderanger: I would only bother with that if you create and destroy servers at a prodigious rate
[2012-05-02 19:07:04 -0400] rhoons: @coderanger so you just run the knife ec2 periodically from your workstation?
[2012-05-02 19:07:15 -0400] rhoons: or monitoring server?
[2012-05-02 19:07:35 -0400] coderanger: rhoons: Well in that case it would be if you are destroying the node with knife ec2 server destroy
[2012-05-02 19:07:58 -0400] coderanger: Whatever is downing the servers should have some kind of hook for cleanup scripts
[2012-05-02 19:08:31 -0400] rhoons: indeed, which we are not currently doing... we have been doing everything in rightscale up to this point, and there is a spot for termination scripts
[2012-05-02 19:08:47 -0400] rhoons: so my thought was to add a termination script which was called by the server itself as it terminates
[2012-05-02 19:09:07 -0400] flashmanbahadur: rhoons: how will you discern between stopping and termination?
[2012-05-02 19:09:46 -0400] rhoons: i hadn't really thought through that distinction...
[2012-05-02 19:09:46 -0400] coderanger: rhoons: Then yeah, use Spice/PyChef/whatever and make a tiny script to nuke the client and node from Chef
[2012-05-02 19:11:56 -0400] afallows: I have a script that just calls 'knife client delete -y' and knife node delete -y' on a list of arguments I pass it, and I identify the list manually from knife status. It wouldn't be too hard to turn something like that into a tool that also does the termination, then all you need is an id.
[2012-05-02 19:12:24 -0400] kylev: am I misunderstanding -E on knife commands?
[2012-05-02 19:12:30 -0400] kylev: knife status -E production
[2012-05-02 19:12:40 -0400] gp5st: is there any reason the apt package installs ruby 1.8 and not ruby 1.9?
[2012-05-02 19:12:54 -0400] kylev: returns all hosts, not just those in the production chef environemtn
[2012-05-02 19:13:28 -0400] flashmanbahadur: gp5st: its based on your distro
[2012-05-02 19:13:36 -0400] kylev: "knife status chef_env:production" does what I expect
[2012-05-02 19:14:02 -0400] gp5st: flashmanbahadur: wouldn't it be based on what the package asks for? ubuntu 12.04 btw
[2012-05-02 19:14:32 -0400] flashmanbahadur: gp5st: what is calling the apt package install?
[2012-05-02 19:14:49 -0400] afallows: gp5st: 'sudo apt-get install ruby' defaults to installing ruby 1.8. The core Ubuntu package set only includes 1.8 and 1.9.1, iirc. If you want to install a newer version, I recommend installing from source or through RVM/rbenv/etc
[2012-05-02 19:15:19 -0400] flashmanbahadur: 1.9.1 is an alias for 1.9.3 on ubuntu 12.04
[2012-05-02 19:15:27 -0400] coderanger: kylev: -E is only a think on node commands I think
[2012-05-02 19:15:42 -0400] afallows: Oh, so it is!
[2012-05-02 19:15:53 -0400] gp5st: yeah, i guess i'll just figure out how to upgrade it. last time i had huge probelms with both being on the same system
[2012-05-02 19:16:14 -0400] afallows: gp5st: Ignore most of what I just said. You should be able to do apt_package "ruby1.9.3" do action :install end
[2012-05-02 19:16:14 -0400] gp5st: flashmanbahadur: that's always annoyed me:-p I'd love to know why it's not just 1.9
[2012-05-02 19:16:33 -0400] flashmanbahadur: gp5st: yeah, we all have
[2012-05-02 19:16:37 -0400] flashmanbahadur: you can try using omnibus
[2012-05-02 19:16:44 -0400] kylev: coderanger: hrm.  it is listed in the knife status help
[2012-05-02 19:16:50 -0400] flashmanbahadur: easier to get a nice clean ruby install for chef like that
[2012-05-02 19:17:07 -0400] gp5st: is there anyway to make the ruby package install 1.9?
[2012-05-02 19:17:10 -0400] flashmanbahadur: i gave up on trying to get ruby 1.9 to work for chef when 1.8 was already installed
[2012-05-02 19:17:16 -0400] flashmanbahadur: apt-get isntall ruby1.9
[2012-05-02 19:17:31 -0400] gp5st: i mean apt-get install ruby would install 1.9.1, not 1.8
[2012-05-02 19:17:37 -0400] flashmanbahadur: dont believe so
[2012-05-02 19:17:42 -0400] flashmanbahadur: thats just how ubuntu denotes them
[2012-05-02 19:17:51 -0400] coderanger: kylev: Yeah, probably should be supported there too, check for/file a ticket?
[2012-05-02 19:18:07 -0400] flashmanbahadur: gp5st: my AWS 12.04 ubuntu has no ruby by default, so I just monkey patch in 1.9
[2012-05-02 19:18:31 -0400] flashmanbahadur: the default chef-client install actually fails for me if I dont monkey patch
[2012-05-02 19:19:19 -0400] rhoons: @flashmanbahadur: thanks for the help, we are not using EBSs so stopping is not a problem.
[2012-05-02 19:19:21 -0400] gp5st: flashmanbahadur: yeah, i was using the apt package for chef and it installs 1.8
[2012-05-02 19:19:29 -0400] gp5st: but knife-windows req 1.9
[2012-05-02 19:19:39 -0400] rhoons: @coderanger: thanks to you to.
[2012-05-02 19:20:02 -0400] coderanger: rhoons: No problem
[2012-05-02 19:21:06 -0400] flashmanbahadur: gp5st: i install chef via gem
[2012-05-02 19:21:13 -0400] flashmanbahadur: ill link my monkey patch in a sec
[2012-05-02 19:23:01 -0400] flashmanbahadur: gp5st: https://gist.github.com/2579487
[2012-05-02 19:23:05 -0400] flashmanbahadur: gives you an idea of the order
[2012-05-02 19:23:21 -0400] flashmanbahadur: although I would recommend using a bootstrap template or omnibus instead of monkey patching
[2012-05-02 19:23:39 -0400] flashmanbahadur: i just have not converted mine
[2012-05-02 19:23:40 -0400] kylev: coderanger: I'm reading code to understand it a bit better
[2012-05-02 19:23:45 -0400] kylev: will file
[2012-05-02 19:24:12 -0400] kylev: seems like -E should turn into a query restriction any time it is present
[2012-05-02 19:38:22 -0400] hoover_damn: perhaps --environment
[2012-05-02 19:38:34 -0400] hoover_damn: -e was edit at one point
[2012-05-02 19:38:39 -0400] hoover_damn: afaik
[2012-05-02 19:44:43 -0400] spyvsspy: is there a way to include a new line on an attribute out put?
[2012-05-02 19:45:10 -0400] spyvsspy: ie, if I have a shel script that parses a log, right now its all one big string when it shows up in the webui
[2012-05-02 19:48:32 -0400] hoover_damn: printf "bob\n"
[2012-05-02 19:48:35 -0400] hoover_damn: instead of using puts
[2012-05-02 19:48:52 -0400] hoover_damn: although puts should by default do a cr as well
[2012-05-02 19:56:21 -0400] spyvsspy: hoover_damn, it is a bash scrpt
[2012-05-02 19:56:40 -0400] spyvsspy: i have a script on the server, it runs, and i assign that output to an attribute
[2012-05-02 19:57:14 -0400] spyvsspy: can I do it in straight ruby in that attribute file?
[2012-05-02 20:06:58 -0400] dyer: Hey guys, can I ask u a question  What site do you think is the best bet for posting a job posting for devops / systems engineers ?   Personally I have used Dice in the past but there are so many options now I am wondering which one is the new "hotness" . Anyone have any thoughts ?
[2012-05-02 20:07:21 -0400] rhoons: careers2.0?
[2012-05-02 20:07:57 -0400] dyer: see...
[2012-05-02 20:08:00 -0400] dyer: another one I didn't know about
[2012-05-02 20:08:17 -0400] dyer: lol
[2012-05-02 20:09:09 -0400] setient: lol
[2012-05-02 20:09:28 -0400] setient: craigslist if in the bay area
[2012-05-02 20:10:22 -0400] dyer: Yea, we are looking for someone in the Atlanta area
[2012-05-02 20:13:02 -0400] senthilr: setient: srsly ? craigslist
[2012-05-02 20:16:32 -0400] spyvsspy: dyer, hackernews
[2012-05-02 20:16:37 -0400] spyvsspy: nm
[2012-05-02 20:23:23 -0400] masterkorp: Can i use a library like nokogiri( http://nokogiri.org/ ) directly in a chef recipe ?
[2012-05-02 20:23:40 -0400] Brad_K:  if you're looking for devops types, i wouldn't go through the normal channels.  hit the places where the kinds of people you want actually hang out.  so, if you want chef/devops people, this might be a good place  or the chef mailing list.  i'm sure that puppet has similar resources.  if you're after someone who is more of a generalist, then try to find places where you see other people of the sort you would want to hire, and ask there.
[2012-05-02 20:24:49 -0400] afallows: Get some people together and start a devops StackExchange, then troll it for talent.
[2012-05-02 20:24:52 -0400] cwj: masterkorp: yes
[2012-05-02 20:24:56 -0400] afallows: Clearly the best strategy.
[2012-05-02 20:25:34 -0400] masterkorp: cwj: can you point me to doc? i http://wiki.opscode.com/display/chef/Libraries read this, but can i just require the gem ?
[2012-05-02 20:26:04 -0400] the_loop: looking for a workaround to http://tickets.opscode.com/browse/COOK-1142 which makes the current subversion::client recipe fail on ubuntu.  Tried installing previous version via "knife cookbook site install subversion 0.8.3" but then got bit by http://tickets.opscode.com/browse/CHEF-2512 (site install with version specified fails).
[2012-05-02 20:26:41 -0400] cwj: masterkorp: yes you can require the gem, but you also want your recipe to install it if its not already available
[2012-05-02 20:27:50 -0400] cwj: the mysql cookbook used to be a good example of that, but that code has been moved into library functions
[2012-05-02 20:28:00 -0400] masterkorp: cwj: great can you point me to any example ?
[2012-05-02 20:29:03 -0400] cwj: http://community.opscode.com/cookbooks/route53/source default recipe shows how to install gems during the compilation phase of the chef_run
[2012-05-02 20:29:21 -0400] masterkorp: thanks
[2012-05-02 20:30:07 -0400] cwj: if you arent familiar, check out the mysql cookbook libraries to see how to rescue a require so things dont blow up when your gem isn't installed yet
[2012-05-02 20:38:22 -0400] ProfFalken_mobil: BryanWB: whats a devops delicacy?
[2012-05-02 20:45:18 -0400] spyvsspy: how do i assign the default roles to a node?
[2012-05-02 20:45:25 -0400] spyvsspy: can i do that upon first checkin?
[2012-05-02 20:46:41 -0400] afallows: spyvsspy: You can do that with a json file - use the -j flag when you run chef-client from the node.
[2012-05-02 20:47:54 -0400] jperry2: installing a gem via a git repo how do I tell rubygems to add 'require 'bundler/setup''
[2012-05-02 21:02:39 -0400] statix: Using the mount resource to unmount, can you use the options attribute to pass arguments to `umount`?
[2012-05-02 21:03:20 -0400] statix: eg. to pass -f -l to ensure an NFS mount is killed no matter what
[2012-05-02 21:15:57 -0400] kylev: coderanger: I opened a JIRA issue with a patch for the "knife status" behavior.
[2012-05-02 21:16:08 -0400] kylev: http://tickets.opscode.com/browse/CHEF-3079
[2012-05-02 21:16:13 -0400] coderanger: kylev: Perfect, have you submitted a CLA?
[2012-05-02 21:16:27 -0400] kylev: I'm not sure what a CLA is...
[2012-05-02 21:16:44 -0400] coderanger: contributing?
[2012-05-02 21:16:45 -0400] bawt_: contributing is http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-05-02 21:16:48 -0400] coderanger: :)
[2012-05-02 21:18:19 -0400] kylev: BAH
[2012-05-02 21:18:21 -0400] kylev: :)
[2012-05-02 21:23:03 -0400] kylev: coderanger: CLA done
[2012-05-02 21:23:42 -0400] coderanger: kylev: Excellente, I think we are in freeze for the 10.10 release, so probably will get merged for 10.12, but btm is better to ask on that
[2012-05-02 21:27:37 -0400] kylev: aw, but I want it now!
[2012-05-02 21:55:11 -0400] jperry2: any suggestions on telling a gem to require 'bundler/setup' when pointing my Gemfile at a gem in a github repo?
[2012-05-02 21:55:18 -0400] jperry2: for example "vagrant"
[2012-05-02 21:58:05 -0400] andreacampi: jperry2 what do you mean? in a cookbook?
[2012-05-02 21:58:56 -0400] jperry2: so I am using a Gemfile
[2012-05-02 21:59:20 -0400] jperry2: that has for example "gem "vagrant", :git => "url/to/repo"
[2012-05-02 21:59:28 -0400] jperry2: after running "bundle install"
[2012-05-02 21:59:38 -0400] jperry2: I run "vagrant"
[2012-05-02 21:59:51 -0400] jperry2: since vagrant is not part of the gem list it fails
[2012-05-02 21:59:56 -0400] andreacampi: right, so this has nothing to do with Chef
[2012-05-02 22:00:10 -0400] jperry2: sorry
[2012-05-02 22:00:17 -0400] jperry2: wrong channel :)
[2012-05-02 22:00:24 -0400] andreacampi: no worries :)
[2012-05-02 22:00:24 -0400] jperry2: I thought I was in the ruby channel
[2012-05-02 22:01:08 -0400] andreacampi: interesting q anyway "bundle exec vagrant" doesn't work?
[2012-05-02 22:04:08 -0400] jperry2: @adreacampi - yes that works
[2012-05-02 22:04:16 -0400] jperry2: but plain "vagrant" doesn't
[2012-05-02 22:04:54 -0400] andreacampi: yeah that happens a lot :)
[2012-05-02 22:05:38 -0400] jperry2: I see
[2012-05-02 22:05:51 -0400] jperry2: okay at least there is a workaround :)
[2012-05-02 22:07:51 -0400] jperry2: thx for the hlep
[2012-05-02 22:07:53 -0400] jperry2: help
[2012-05-02 22:08:31 -0400] coderanger: jperry2: Yeah, thats what bundle exec is for
[2012-05-02 22:08:41 -0400] coderanger: Welcome to ruby
[2012-05-02 22:08:54 -0400] coderanger: rvm foo exec bundle exec rake run
[2012-05-02 22:08:55 -0400] coderanger: ftw!
[2012-05-02 22:09:07 -0400] jperry2: yeah I have stuff running from rake
[2012-05-02 22:09:21 -0400] jperry2: but sometimes I like to use call vagrant directly but thats cool
[2012-05-02 22:09:30 -0400] jperry2: I can always setup an alias if it gets annoying
[2012-05-02 22:09:45 -0400] andreacampi: I think coderanger was being sarcastic :)
[2012-05-02 22:09:49 -0400] jperry2: ha
[2012-05-02 22:10:06 -0400] jperry2: yeah I figured that
[2012-05-02 22:10:31 -0400] andreacampi: coderanger: as a python n00b, virtualenv looks interesting does it work better?
[2012-05-02 22:11:29 -0400] coderanger: Yeah, it does strict isolation instead of bundlers virtual isolation
[2012-05-02 22:11:37 -0400] coderanger: more akin to rvm gemsets than bundler
[2012-05-02 22:12:13 -0400] coderanger: But bundler's version locking and such is better than anything python has
[2012-05-02 22:12:36 -0400] andreacampi: got it
[2012-05-02 22:12:50 -0400] andreacampi: so, tradeoffs as usual :)
[2012-05-02 22:13:32 -0400] coderanger: There is no free lunch in packaging
[2012-05-02 22:14:03 -0400] andreacampi: indeed
[2012-05-02 22:22:30 -0400] AntonZ: has anyone figured out a way to authenticate linux clients against google apps ?
[2012-05-02 22:26:39 -0400] coderanger: AntonZ: You mean use google passwords for sudo or something?
[2012-05-02 22:27:27 -0400] josephholsten: coderanger, andreacampi: bundler 1.1's --standalone flag is strict isolation. You don't even need rubygems.
[2012-05-02 22:27:44 -0400] AntonZ: google apps for business, google open id services, all of our users are in google DB, i want to be able to authenticate my linux boxes against google Db, sort of like windows Active directory
[2012-05-02 22:28:54 -0400] senthilr: you can go from local (ldap,ad) to google app
[2012-05-02 22:28:57 -0400] senthilr: not the other way
[2012-05-02 22:29:07 -0400] coderanger: AntonZ: You could try https://code.google.com/p/oauth-pam/downloads/list
[2012-05-02 22:29:22 -0400] AntonZ: right, i wanted to authenticate directly against google, not via AD/LDAP
[2012-05-02 22:29:47 -0400] AntonZ: yes, google has two way authenticator, we use that already, but that requires each user to install app on their smart phone
[2012-05-02 22:30:22 -0400] AntonZ: i want to install something on linux box that would connect to google and authenticate me on that box with google password :)
[2012-05-02 22:30:28 -0400] senthilr: oauth-pam is interesting
[2012-05-02 22:30:49 -0400] senthilr: is there any such thing similar for apache SSO
[2012-05-02 22:31:02 -0400] AntonZ: exactly, something like apache module
[2012-05-02 22:32:17 -0400] josephholsten: woo nagios server recipe is broken on ubuntu 12.04!
[2012-05-02 22:38:11 -0400] coderanger: AntonZ: I don't know of anything that would work well for this
[2012-05-02 22:38:29 -0400] coderanger: You could try and build a pam module for their xauth system, if that even still exists
[2012-05-02 22:38:39 -0400] coderanger: But most google auth systems are web-only
[2012-05-02 22:38:46 -0400] coderanger: oauth, openid, etc
[2012-05-02 22:38:52 -0400] AntonZ: i was thinking another option
[2012-05-02 22:39:35 -0400] coderanger: https://sites.google.com/site/oauthgoog/Home/oauthimap
[2012-05-02 22:39:38 -0400] AntonZ: Google Directory Sync -> LDAP (Windows for instance) -> clients, but sounds like google reads what i have in LDAP instead other way around :)
[2012-05-02 22:40:21 -0400] coderanger: Yeah, you can't export password from google
[2012-05-02 22:40:27 -0400] coderanger: or any other service, ever
[2012-05-02 22:40:42 -0400] coderanger: (and if you could, it would be an enormous security problem)
[2012-05-02 22:41:29 -0400] AntonZ: yea... im just tired maintaining local accounts, google accounts, etc
[2012-05-02 22:54:20 -0400] AntonZ: guys, are there an easy piece of code that i can stick to one of my cookbooks to download entire content of an S3 bucket and put it to specified folder? i cant seem to figure out how to download from S3, anyone can lend a hand ?
[2012-05-02 22:55:34 -0400] rhoons: i dunno about the whole bucket, but I've been using the s3_file.rb i found here:
[2012-05-02 22:55:35 -0400] rhoons: https://gist.github.com/470321
[2012-05-02 22:57:51 -0400] rhoons: i had a little trouble getting the correct s3 gem... i'm trying to find it here, but I ended up using the aws-s3 gem
[2012-05-02 22:58:30 -0400] AntonZ: let me see
[2012-05-02 22:58:40 -0400] AntonZ: did you get it to work for you, or still wrestling with it ?
[2012-05-02 22:58:49 -0400] rhoons: oh no i got it working.
[2012-05-02 22:59:15 -0400] rhoons: the aws-s3 gem is not from amazon, but it's the one you get if you go "gem install aws-s3"
[2012-05-02 22:59:35 -0400] rhoons: then just require 'aws/s3'
[2012-05-02 23:00:20 -0400] AntonZ: does it get a specified file for you from s3 ?
[2012-05-02 23:00:24 -0400] AntonZ: or folder ?
[2012-05-02 23:00:27 -0400] rhoons: others on github have forked that s3_file.rb to not use it, but i don't think the error handling is as robust
[2012-05-02 23:00:38 -0400] rhoons: yes, specific file.
[2012-05-02 23:01:11 -0400] AntonZ: im gonna need a folder or two... let me see what i can do with that, i guess i could archive the folder and then untar it on the box
[2012-05-02 23:01:42 -0400] rhoons: yea, beyond that i would dig more into the aws rubysdk
[2012-05-02 23:02:40 -0400] AntonZ: plenty of pwoershell scripts to get thigns from s3, not much for linux :)
[2012-05-02 23:49:18 -0400] coderanger: Woo, COOK-634 landed in opscode master :)
[2012-05-02 23:55:59 -0400] hoover_damn: nice
[2012-05-02 23:56:11 -0400] hoover_damn: I recently refactored the application cookbook out for a client
[2012-05-02 23:56:18 -0400] hoover_damn: not as dry as i'd like but it's pretty darn dry
[2012-05-02 23:56:32 -0400] hoover_damn: client didn't want the databag shennigans
[2012-05-02 23:56:34 -0400] hoover_damn: I agreed
[2012-05-02 23:57:50 -0400] hoover_damn: but still worth a once over
