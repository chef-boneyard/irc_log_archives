[2012-05-27 04:24:51 -0400] thedeeno: can I set a value for node.run_state[<attribute>] before a chef run? I want to force the opscode nginx::source recipe to recompile and from the source it looks like setting node.run_state['nginx_force_recompile'] to true would do it.
[2012-05-27 04:32:59 -0400] thedeeno: hmm, looking at the source a bit closer seems this wouldn't actually work if I could magically set this attribute before hand (it get's overwritten). Further, it seems run_state isn't supposed to be used that way
[2012-05-27 09:55:04 -0400] abstrusenick: why the default chef users cookbook uses NOPASSWD for sudo?
[2012-05-27 10:56:19 -0400] zts: abstrusenick: I don't think the "users" cookbook touches sudoers at all...
[2012-05-27 10:56:58 -0400] abstrusenick: sorry
[2012-05-27 10:56:59 -0400] zts: abstrusenick: but note that it doesn't set passwords either, which is why the readme suggests using NOPASSWD in the sudo template
[2012-05-27 10:57:14 -0400] abstrusenick: yes it does not set the password
[2012-05-27 10:57:23 -0400] abstrusenick: is it a good practice?
[2012-05-27 10:57:26 -0400] abstrusenick: why do that?
[2012-05-27 10:58:45 -0400] zts: I'm not sure, we've modified our local copy to manage passwords
[2012-05-27 10:59:21 -0400] abstrusenick: how do you keep the password config?
[2012-05-27 10:59:31 -0400] zts: If I had to guess, it's that you can't set passwords without the ruby-shadow gem installed, and maybe the author of the users cookbook didn't want to depend on that
[2012-05-27 11:00:00 -0400] zts: We store the hash in the users databag
[2012-05-27 11:04:52 -0400] zts: abstrusenick: http://tickets.opscode.com/browse/COOK-937 <- ticket requesting what you want, so maybe you can vote/comment to say that you'd like it too
[2012-05-27 11:05:29 -0400] abstrusenick: ok thanks
[2012-05-27 11:05:49 -0400] abstrusenick: some cookbooks use databags
[2012-05-27 11:05:54 -0400] abstrusenick: but I'm only using chef solo
[2012-05-27 11:06:54 -0400] zts: You can pass data bags to chef solo in recent versions: http://wiki.opscode.com/display/chef/Data+Bags#DataBags-UsingDataBagswithChefSolo
[2012-05-27 11:07:21 -0400] zts: that won't help you if the recipe uses search to find data bags though, as search still won't work
[2012-05-27 11:08:37 -0400] zts: It is pretty common to need to make changes to the cookbooks you're using, to suit your environment
[2012-05-27 11:10:25 -0400] zts: I imagine that the reason the 'users' cookbook is missing obvious features is that each person customises it to suit their needs, and then it's no good for anyone else
[2012-05-27 11:14:17 -0400] abstrusenick: i see
[2012-05-27 11:14:20 -0400] abstrusenick: thanks
[2012-05-27 11:22:51 -0400] zts: no problem
[2012-05-27 12:19:33 -0400] HasanB: Hi neighbours.  A newbie here with a little problem. :-(
[2012-05-27 12:20:57 -0400] HasanB: I'm trying install the jenkins recipe on ubuntu, but I get "FATAL: Chef::Exceptions::Package: package[jenkins] (jenkins::default line 161) had an error: Chef::Exceptions::Package: No version specified, and no candidate version available for jenkins"
[2012-05-27 12:22:49 -0400] HasanB: googling suggests the ERROR means  that  Chef::Exceptions::Package:    can't get at the repo.  But I do not know what to do about that.
[2012-05-27 12:25:53 -0400] HasanB: Is this a well known error with chef installation ?  One of those "Oh, looks like you skipped step xyz."  kinds of mistakes ??
[2012-05-27 12:34:58 -0400] HasanB: I checked the file /var/lib/apt/lists/pkg.jenkins-ci.org_debian_binary_Packages  and it definitely points to the latest version number
[2012-05-27 12:41:09 -0400] HasanB: Ha!  Well that sure is amusing --- it seems to have fixed itself.
[2012-05-27 12:49:11 -0400] HasanB: but I ran  ---  sudo aptitude update ---     !!!
[2012-05-27 12:50:40 -0400] HasanB: Did I skip a step that would have told the apt recipe to update its knowledge of its own repositories?
[2012-05-27 16:19:02 -0400] thedeeno: I'm confused by automatic_attrs. Can someone explain how chef is storing the attr ['nginx']['version'] for use in future runs here? https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L90
[2012-05-27 16:19:57 -0400] thedeeno: I suppose if it were part of the built in automatic attributes it'd make more sense to me, but I don't understand how this custom one is being stored
[2012-05-27 16:56:04 -0400] yfeldblum: thedeeno, node attributes come in four "levels" - default, normal, override, and automatic; a datum in the normal-level attributes overrides the corresponding datum in the default-level attributes, and so on
[2012-05-27 16:56:54 -0400] yfeldblum: thedeeno, automatic-level attributes are reserved for ohai: chef-solo & chef-client will run ohai fore running any recipes and store the results in the automatic-level attributes
[2012-05-27 16:57:42 -0400] thedeeno: so in order for ohai to detect the nginx version a plugin was written?
[2012-05-27 16:57:57 -0400] thedeeno: an ohai plugin*
[2012-05-27 16:59:42 -0400] yfeldblum: thedeeno, the opscode-cookbooks/nginx cookbook has an ohai plugin for nginx, which *sets* these attributes (again, at the automatic level) ... https://github.com/opscode-cookbooks/nginx/blob/master/templates/default/plugins/nginx.rb.erb#L20-21
[2012-05-27 17:00:12 -0400] yfeldblum: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/source.rb#L43
[2012-05-27 17:00:23 -0400] yfeldblum: https://github.com/opscode-cookbooks/nginx/blob/master/recipes/ohai_plugin.rb
[2012-05-27 17:01:02 -0400] yfeldblum: does that make any sense?
[2012-05-27 17:02:50 -0400] thedeeno: I think I understand the loading and definiton of the plugin, but I don't understand how 'provides' is doing it's magic here https://github.com/opscode-cookbooks/nginx/blob/master/templates/default/plugins/nginx.rb.erb#L20-21
[2012-05-27 17:03:35 -0400] yfeldblum: thedeeno, that's the ohai plugin API: #provides is a method provides by ohai for ohai plugins to call and provide data
[2012-05-27 17:03:49 -0400] thedeeno: ah, cool. I'll chec that out thent
[2012-05-27 17:03:49 -0400] yfeldblum: thedeeno, it's ohai internals
[2012-05-27 17:04:29 -0400] thedeeno: thanks yfeldblum, you helped me through this barrier :)
[2012-05-27 17:04:37 -0400] yfeldblum: thedeeno, no probs
[2012-05-27 17:04:38 -0400] thedeeno: we'll see what I come up with
[2012-05-27 17:05:02 -0400] yfeldblum: thedeeno, just curious, what overall are you trying to accomplish?
[2012-05-27 17:06:32 -0400] thedeeno: it's morphing as I learn more... Currently I'm trying to add a phusion-passenger config flag to the nginx::source recipe.
[2012-05-27 17:08:30 -0400] thedeeno: hasn't worked out well so far. I extending node.run_state['nginx_config_flags'] like this https://github.com/opscode-cookbooks/nginx/blob/master/recipes/http_ssl_module.rb but that didn't appear to work
[2012-05-27 17:08:56 -0400] thedeeno: and since I'm new to chef, I'm not sure if I just messed something simple up or I'm just doing it wrong
[2012-05-27 17:09:01 -0400] thedeeno: :/ learnig curve...
[2012-05-27 17:10:09 -0400] thedeeno: then I wanted to force a recompile, and after looking through the source I saw these auto attributes which knew the previously used config flags and version number to prevent reduntant compiles
[2012-05-27 17:10:12 -0400] thedeeno: and that's where I am
[2012-05-27 17:33:41 -0400] hoover_damm: heh
[2012-05-27 17:33:54 -0400] hoover_damm: I refactored the nginx cookbook to supporting passenger for a client
[2012-05-27 17:33:57 -0400] hoover_damm: gosh it was ugly
[2012-05-27 17:35:25 -0400] hoover_damm: thedeeno, https://gist.github.com/92a8d6bcbdf08d334e34
[2012-05-27 17:36:02 -0400] hoover_damm: thedeeno, fwiw request_start_variable.patch is actually from newrelic https://newrelic.com/docs/features/tracking-front-end-time
[2012-05-27 17:36:18 -0400] hoover_damm: beyond that usage of the same pattern of attributes and it should just work
[2012-05-27 17:36:45 -0400] hoover_damm: then proper usage of nginx app files is required
[2012-05-27 17:36:53 -0400] hoover_damm: if you need examples lmk
[2012-05-27 18:15:37 -0400] xiaotian: hi, I just discovered shef, but it doesn't seem to be work for me, I have a output here http://pastebin.com/K77h1q0y
[2012-05-27 18:15:50 -0400] xiaotian: I am trying to use recipe command
[2012-05-27 18:16:06 -0400] xiaotian: and include_recipe '<recipe>'
[2012-05-27 18:16:29 -0400] xiaotian: and it gives load_recipe of Nil class error.
[2012-05-27 18:21:04 -0400] xiaotian: ok, never mind, I forgot to pass -s (for chef-solo) option.
