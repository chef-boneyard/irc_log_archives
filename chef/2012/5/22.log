[2012-05-22 00:16:04 -0400] jessicab: oddityoverseer13 - what do you mean exactly by they wont merge? any node attributes should override cookbook attributes
[2012-05-22 00:18:01 -0400] jessicab: oddityoverseer13- this might be helpful: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-05-22 00:47:54 -0400] martinisoft: are there any good cookbooks out there for configuring openssh?
[2012-05-22 00:48:43 -0400] miah: i've wished for one
[2012-05-22 00:48:52 -0400] miah: i haven't gotten to it in my queue yet
[2012-05-22 00:49:07 -0400] martinisoft: https://github.com/opscode-cookbooks/openssh/pull/1
[2012-05-22 00:49:20 -0400] martinisoft: thats a stale pull request for an sshd_config template
[2012-05-22 00:49:57 -0400] JasonBox: Indeed
[2012-05-22 00:51:00 -0400] martinisoft: which references a closed ticket, that was reopened to this
[2012-05-22 00:51:02 -0400] martinisoft: http://tickets.opscode.com/browse/COOK-1014
[2012-05-22 00:55:34 -0400] miah: there are some issues with the attributes
[2012-05-22 00:55:57 -0400] miah: eg, subsystem sftp sets a default value that wouldn't work on ubuntu
[2012-05-22 00:57:29 -0400] imeyer: woof, to that ticket
[2012-05-22 00:57:53 -0400] martinisoft: looks very abandoned at this point
[2012-05-22 00:58:21 -0400] miah: yup
[2012-05-22 00:59:12 -0400] imeyer: are you looking for a whole-hog sshd configuration cookbook?
[2012-05-22 00:59:24 -0400] imeyer: (i'm assuming, yes)
[2012-05-22 00:59:51 -0400] miah: it wouldnt be hard to make one. go forth and build it =)
[2012-05-22 01:00:11 -0400] imeyer: i'm going to do shots instead
[2012-05-22 01:00:12 -0400] imeyer: :D
[2012-05-22 01:00:36 -0400] martinisoft: doesn't really have to be whole-hog
[2012-05-22 01:00:45 -0400] martinisoft: looking to tweak a few settings to lock down the nodes
[2012-05-22 01:01:07 -0400] martinisoft: like turning off root login, pubkeys only, turning off PAM, etc
[2012-05-22 01:01:28 -0400] imeyer: yeah.. that should be pretty simple.. odd there isn't one already.
[2012-05-22 01:01:41 -0400] martinisoft: yeah thats what surprised me
[2012-05-22 01:01:57 -0400] martinisoft: I'll fork the official repo and open a ticket
[2012-05-22 01:02:08 -0400] martinisoft: see if I can't get some newer attention to it
[2012-05-22 01:02:17 -0400] asg: martinisoft: I think most people have just implemented their own as an early exercise, I know I did.
[2012-05-22 01:02:24 -0400] martinisoft: I'm not an SSHD expert so I might call on some assistance
[2012-05-22 01:02:40 -0400] imeyer: yeah, i don't think i've ever used a community cookbook :/
[2012-05-22 01:02:46 -0400] martinisoft: ah, well I think it'll benefit the community so I'm gonna fork and pull request
[2012-05-22 01:03:08 -0400] martinisoft: so far I have gotten by on community cookbooks
[2012-05-22 01:03:30 -0400] martinisoft: first non community one was RVM, other than that this SSH thing
[2012-05-22 01:03:45 -0400] martinisoft: I think thats pretty awesome :)
[2012-05-22 01:06:25 -0400] imeyer: martinisoft: definitely. :) mostly gone are the days of argh, i need a cookbook for blah, but there isn't one!! *grumbles and writes own and never contributes because everything is too custom*
[2012-05-22 01:06:59 -0400] miah: martinisoft: please feel free to ask for help. i'll gladly take a look.
[2012-05-22 01:07:19 -0400] martinisoft: yeah, I'm totally not an ops guy but chef is making it all pretty accessible to me
[2012-05-22 01:07:32 -0400] miah: cool
[2012-05-22 01:07:41 -0400] martinisoft: and many of the cookbooks have been pretty good for me, gotten me started very quickly
[2012-05-22 01:09:01 -0400] miah: cool
[2012-05-22 01:22:58 -0400] mattray: Being trolled by Ruby 1.8.7. It's just making work for me now
[2012-05-22 01:24:31 -0400] miah: lol
[2012-05-22 01:24:32 -0400] UForgotten: in soviet russia, ruby 1.8.7 trolls you?
[2012-05-22 01:28:09 -0400] imeyer: mattray: you kinda deserve it ;)
[2012-05-22 01:28:27 -0400] mattray: imeyer: yeah, trying to give people nice things
[2012-05-22 01:28:27 -0400] imeyer: actually you don't, jtimberpond does
[2012-05-22 01:28:41 -0400] mattray: he's been downgraded from lake to pond?
[2012-05-22 01:29:54 -0400] imeyer: evaporation, man.
[2012-05-22 01:33:23 -0400] miah: lol
[2012-05-22 01:36:43 -0400] mattray: Spiceweasel 1.1, now with support for extracting knife/json/yaml infrastructure & Ruby 1.8 support bit.ly/JxWdyH
[2012-05-22 01:37:23 -0400] nathenharvey: mattray:  just as I'm writing up notes for What's Cookin', too.  well timed
[2012-05-22 01:37:31 -0400] mattray: yaml & json may sort randomly of course
[2012-05-22 01:37:36 -0400] mattray: with Ruby 1.8
[2012-05-22 01:37:45 -0400] mattray: nathenharvey: cool, now I don't have to send it to you ;)
[2012-05-22 01:59:02 -0400] imeyer: i am seriously being trolled by a pack of cigarettes that i can not get the cellophane off of.
[2012-05-22 01:59:06 -0400] imeyer: fml
[2012-05-22 02:03:33 -0400] atomic-penguin: nathenharvey, thanks for the beer
[2012-05-22 02:05:01 -0400] nathenharvey: atomic-penguin:  thanks for the awesome work on cookbooks.  and for the summary on progress on today's mailing list
[2012-05-22 02:05:31 -0400] atomic-penguin: Yeah, I don't really know what anyone thinks of it
[2012-05-22 02:05:39 -0400] nathenharvey: atomic-penguin:  we'll have to have you and fnichol on the foodfight or a devops delicacy to wrap up and discuss
[2012-05-22 02:06:32 -0400] atomic-penguin: I'd be up for that for sure
[2012-05-22 02:06:46 -0400] atomic-penguin: I'm indebted now that you bought us a round
[2012-05-22 02:42:40 -0400] chip-: Hi. Trying to use a chunk of ruby in my provider. "not_if do File.exist?(file) end," keep it from running if it doesn't need to
[2012-05-22 02:42:52 -0400] chip-: But it bombs out with NoMethodError: undefined method `exist?' for Chef::Provider::File:Class
[2012-05-22 02:43:38 -0400] sparc_: maybe exist? is an instance method or something, or it's called something else ...
[2012-05-22 02:43:47 -0400] hoover_damm: not_if { File.exists?(file) }
[2012-05-22 02:43:49 -0400] sparc_: i should be quiet when i don't know
[2012-05-22 02:43:59 -0400] hoover_damm: the fact that it's not surrounded with {}'s turns it into something else
[2012-05-22 02:44:00 -0400] chip-: Kinda stumped, there's even an example on the wiki that's similar, under the Cron provider: http://wiki.opscode.com/display/chef/Resources
[2012-05-22 02:44:07 -0400] chip-: Ahhhh
[2012-05-22 02:44:15 -0400] hoover_damm: it could be possible to use not_if do ::File.exists?(file) end
[2012-05-22 02:44:36 -0400] hoover_damm: but without the {}'s it's getting scoped in to Chef::Provider and since your working a file resource
[2012-05-22 02:44:39 -0400] hoover_damm: the File class :)
[2012-05-22 02:45:22 -0400] hoover_damm: just remember when you do { } in a not_if or an only_if block your doing seeking 'ruby truth'
[2012-05-22 02:45:36 -0400] hoover_damm: doing not_if { "ps aux | grep bob" } will always fire
[2012-05-22 02:45:52 -0400] chip-: not_if { File.exist?("file") } still bombs with NoMethodError: undefined method `exist?' for Chef::Provider::File:Class
[2012-05-22 02:46:05 -0400] chip-: right, because that command will execute.
[2012-05-22 02:46:12 -0400] chip-: so that'd be ruby true.
[2012-05-22 02:46:23 -0400] hoover_damm: right
[2012-05-22 02:46:35 -0400] hoover_damm: and as far as that, short of a typo that should work
[2012-05-22 02:46:38 -0400] hoover_damm: whta ruby and chef are we on?
[2012-05-22 02:46:42 -0400] hoover_damm: what*
[2012-05-22 02:46:53 -0400] chip-: ruby 1.8.7 / Chef 0.10.10.
[2012-05-22 02:46:58 -0400] hoover_damm: interesting, 0.10.10?
[2012-05-22 02:47:06 -0400] chip-: Have yet to Omnibus up yet
[2012-05-22 02:47:07 -0400] hoover_damm: you should file a bug on that chip-
[2012-05-22 02:47:17 -0400] bemu: chip-: Change exist to exists?
[2012-05-22 02:47:17 -0400] hoover_damm: you just found a awesome bug if you can reproduce
[2012-05-22 02:47:27 -0400] hoover_damm: that too bemu
[2012-05-22 02:48:21 -0400] hoover_damm: there's a release @ EngineYard's AppCloud product to prove it
[2012-05-22 02:48:23 -0400] hoover_damm: lol
[2012-05-22 02:49:14 -0400] chip-: I've tried with File.directory? too, since it's a dir
[2012-05-22 02:49:21 -0400] chip-: which is in the class according to http://ruby-doc.org/core-1.8.7/File.html
[2012-05-22 02:49:58 -0400] kallistec: chip-: you need to use ::File when you're "inside" a chef recipe
[2012-05-22 02:50:13 -0400] kallistec: the `::` is the ruby "scope operator"
[2012-05-22 02:50:33 -0400] kallistec: which means that you use it to move around through namespaces
[2012-05-22 02:50:52 -0400] kallistec: when you use it with nothing in front, you start at the top level
[2012-05-22 02:51:02 -0400] chip-: Awesome, that did it.
[2012-05-22 02:51:15 -0400] kallistec: which is how chef has a class named "File" which is different from ruby's "File"
[2012-05-22 02:51:42 -0400] chip-: Gotcha.
[2012-05-22 02:54:10 -0400] chip-: Thanks much for the help, all.
[2012-05-22 03:00:53 -0400] hoover_damm: ugh
[2012-05-22 03:00:55 -0400] hoover_damm: seriously?
[2012-05-22 03:01:04 -0400] hoover_damm: so we can't use File.exists? or File.directory?
[2012-05-22 03:01:13 -0400] hoover_damm: you should really fix that, you shouldn't be overwriting stdlib
[2012-05-22 03:02:27 -0400] hoover_damm: and if Opscode got the idea of doing class File ...someone should file a ticket so they fix that
[2012-05-22 03:02:31 -0400] hoover_damm: :-P
[2012-05-22 03:02:33 -0400] imeyer: ::File.exists?
[2012-05-22 03:02:46 -0400] hoover_damm: that's really not the point I have imeyer
[2012-05-22 03:02:53 -0400] imeyer: DAMM U
[2012-05-22 03:02:54 -0400] hoover_damm: File.exists? has always worked since 0.5.x
[2012-05-22 03:02:55 -0400] imeyer: :D
[2012-05-22 03:03:06 -0400] hoover_damm: to break it on 0.10.10 because of a new feature is flipping ... flipping
[2012-05-22 03:03:19 -0400] hoover_damm: crazy?
[2012-05-22 03:03:24 -0400] imeyer: kickflipping?
[2012-05-22 03:03:32 -0400] hoover_damm: kickflipping crazy
[2012-05-22 03:03:32 -0400] hoover_damm: yeah
[2012-05-22 03:03:35 -0400] imeyer: my beer is sweating everywhere
[2012-05-22 03:03:57 -0400] hoover_damm: tell him to take his jacket off
[2012-05-22 03:04:02 -0400] kallistec: hoover_damm: you've always needed the `::` in front, or at least as long as there's been a file resource
[2012-05-22 03:04:14 -0400] hoover_damm: kallistec, nah you haven't
[2012-05-22 03:04:33 -0400] hoover_damm: kallistec, File "/tmp/bob" do content "bill" not_if { File.exists?("/tmp/bob") } end
[2012-05-22 03:04:48 -0400] hoover_damm: kallistec, perhaps you might if you omit the { }
[2012-05-22 03:04:56 -0400] imeyer: i always did ::File.a;klbj just cause i am .. pedantic?
[2012-05-22 03:05:02 -0400] hoover_damm: imeyer, ocd
[2012-05-22 03:05:07 -0400] kallistec: hoover_damm: then how did we break it?
[2012-05-22 03:05:21 -0400] hoover_damm: kallistec, talk to chip- not me
[2012-05-22 03:05:50 -0400] hoover_damm: kallistec, as I said if you are overwriting stdlib it's a valid bug.  I'm not going to file any bug as no one has given me a reproduceable bit of code
[2012-05-22 03:06:12 -0400] hoover_damm: and if it's true, yes that's an issue and we should fix it
[2012-05-22 03:06:18 -0400] hoover_damm: if it's pebcak, then it's just pebcak
[2012-05-22 03:06:21 -0400] kallistec: https://gist.github.com/bbb6bcb6f9ce810c7561
[2012-05-22 03:06:46 -0400] kallistec: I'd prefer to fix it, and I think we probabl can at .11
[2012-05-22 03:06:48 -0400] imeyer: ocd works too
[2012-05-22 03:06:49 -0400] imeyer: :D
[2012-05-22 03:07:05 -0400] knuckolls: check out this cool trick guys. rabbit's on. chef_run ends. rabbit disappears. https://gist.github.com/a57aafcf83835a5cbabc
[2012-05-22 03:07:12 -0400] kallistec: but that's how ruby scoping works when instance evaling strings
[2012-05-22 03:07:19 -0400] knuckolls: i'm to banging head on table status
[2012-05-22 03:07:55 -0400] hoover_damm: kallistec, https://gist.github.com/e114caf5f6868577f260
[2012-05-22 03:07:59 -0400] hoover_damm: on 0.10.10
[2012-05-22 03:08:02 -0400] hoover_damm: so must be pebcak
[2012-05-22 03:08:28 -0400] kallistec: hoover_damm: or `ruby -v`
[2012-05-22 03:08:36 -0400] hoover_damm: 1.9.3
[2012-05-22 03:08:49 -0400] hoover_damm: does 1.8.7 to 1.9.3 really change the scope that much?
[2012-05-22 03:09:45 -0400] kallistec: hoover_damm: I think there was a bug about it in 1.9.2
[2012-05-22 03:10:32 -0400] hoover_damm: kallistec, phew don't run that :)
[2012-05-22 03:10:34 -0400] kallistec: knuckolls: any logs from rabbit itself?
[2012-05-22 03:10:41 -0400] JasonBox: hrm, is there some kind of log 'n raise method for a recipe?
[2012-05-22 03:10:50 -0400] knuckolls: i can paste those, but they basically say "i'm on"
[2012-05-22 03:11:07 -0400] kallistec: JasonBox: you can run a ruby_block that raises
[2012-05-22 03:11:23 -0400] kallistec: or just call raise directly if you know at compile time
[2012-05-22 03:11:34 -0400] JasonBox: hrm
[2012-05-22 03:13:50 -0400] knuckolls: kallistec: https://gist.github.com/8d79c4dcba3d7cf0f71f
[2012-05-22 03:14:24 -0400] kallistec: knuckolls: must not be properly daemonizing
[2012-05-22 03:14:49 -0400] knuckolls: if i log in and type the exact same command it daemonizes
[2012-05-22 03:14:51 -0400] kallistec: rabbit has always done dumb stuff when daemonizing
[2012-05-22 03:14:52 -0400] knuckolls: and works just fine
[2012-05-22 03:15:05 -0400] kallistec: knuckolls: can you log out and back in?
[2012-05-22 03:15:09 -0400] knuckolls: yeah
[2012-05-22 03:15:37 -0400] knuckolls: this starts it up /etc/init.d/rabbitmq-server start
[2012-05-22 03:15:54 -0400] knuckolls: which is what is in my recipe, and clearly shows it running during the chef run
[2012-05-22 03:16:00 -0400] kallistec: knuckolls: if you use an execute resource instead does it work?
[2012-05-22 03:16:01 -0400] knuckolls: it's strange
[2012-05-22 03:16:03 -0400] knuckolls: yes
[2012-05-22 03:16:05 -0400] knuckolls: no sorry
[2012-05-22 03:16:09 -0400] knuckolls: i've tried every permutation
[2012-05-22 03:16:19 -0400] knuckolls: execute, bash, service with custom start_command / stop_command
[2012-05-22 03:16:42 -0400] knuckolls: using /etc/init.d and trying service rabbitmq-server instead
[2012-05-22 03:17:02 -0400] knuckolls: this is working with the opscode rabbitmq cookbook
[2012-05-22 03:17:23 -0400] knuckolls: which had a bug where it wouldn't use the rabbitmq apt repo, it would instead install a really old version of rabbit from canonical's repos
[2012-05-22 03:17:33 -0400] knuckolls: because it wasn't doing an apt-get update after it added the custom repo
[2012-05-22 03:17:41 -0400] knuckolls: then after that this bug shows up.
[2012-05-22 03:18:04 -0400] knuckolls: the new rabbit package starts up rabbit when it installs, i have to turn it off to set the erlang cookie, and turn it back on
[2012-05-22 03:18:27 -0400] knuckolls: what's odd is that if i don't try to stop,start,restart or anything like that within the recipe
[2012-05-22 03:18:29 -0400] knuckolls: it's on and it works fine
[2012-05-22 03:18:35 -0400] knuckolls: from when it was installed by the package resource
[2012-05-22 03:19:08 -0400] kallistec: what's different in the init scripts between the 2 pkgs
[2012-05-22 03:19:26 -0400] knuckolls: see that's a good idea. it's why i decided to talk to someone about it
[2012-05-22 03:19:28 -0400] knuckolls: i'll look.
[2012-05-22 03:26:30 -0400] knuckolls: here they both are
[2012-05-22 03:26:30 -0400] knuckolls: https://gist.github.com/10941199fdbabbcd5148
[2012-05-22 03:26:59 -0400] knuckolls: the one from 1.7.2 works, 2.8.2 does not.
[2012-05-22 03:27:49 -0400] knuckolls: working one uses start_all and stop_all whereas the new one uses start-stop-daemon
[2012-05-22 03:27:59 -0400] kallistec: knuckolls: is rabbitmq-multi a script of some sort?
[2012-05-22 03:28:09 -0400] knuckolls: yeah i was about to check that, haven't seen that before
[2012-05-22 03:28:22 -0400] kallistec: I'm pretty sure it's some sort of setsid/session leader thing
[2012-05-22 03:28:30 -0400] knuckolls: not sure i follow
[2012-05-22 03:29:25 -0400] knuckolls: https://gist.github.com/f0bebd6e550a8adb6997
[2012-05-22 03:29:28 -0400] knuckolls: that's rabbitmq-multi
[2012-05-22 03:31:11 -0400] kallistec: knuckolls: http://en.wikipedia.org/wiki/Process_group for starters
[2012-05-22 03:33:10 -0400] knuckolls: this is at least what i thought was happening, but didn't have the vocabulary for
[2012-05-22 03:33:48 -0400] knuckolls: strange that start-stop-daemon would be having a problem like this though
[2012-05-22 03:38:49 -0400] knuckolls: kallistec: even though it does look like a process group problem i don't see much i can do here, possibly rip out start-stop-daemon but honesty that thing should work. it's used heavily
[2012-05-22 03:40:32 -0400] kallistec: knuckolls: you can try putting `fork { Process.setsid; exec "/etc/init.d/rabbitmq start"; }` in a ruby_block and see if it works or not
[2012-05-22 03:40:41 -0400] kallistec: that would at least tell you
[2012-05-22 03:40:58 -0400] knuckolls: deal. i'll try it
[2012-05-22 03:47:14 -0400] knuckolls: kallistec: hmm sh: fork: not found
[2012-05-22 03:47:28 -0400] knuckolls: followed by this /etc/init.d/rabbitmq start: not found
[2012-05-22 03:47:33 -0400] knuckolls: i'll test further in irb
[2012-05-22 03:47:35 -0400] kallistec: knuckolls: as a ruby_block?
[2012-05-22 03:47:42 -0400] knuckolls: yeah sec
[2012-05-22 03:47:45 -0400] kallistec: seems like that was executed by a shell
[2012-05-22 03:47:54 -0400] Randm: the file "/etc/init.d/rabbitmq start" probably doesn't exist
[2012-05-22 03:47:57 -0400] knuckolls: haha i've been doing this too long
[2012-05-22 03:47:59 -0400] Randm: which would make sense..
[2012-05-22 03:48:06 -0400] kallistec: also, you can try adding `-b` to the start-stop-daemon args
[2012-05-22 03:48:13 -0400] knuckolls: i will try that
[2012-05-22 03:48:23 -0400] knuckolls: that last problem was just my mistake. i'm on hour... 15 of this problem?
[2012-05-22 03:48:45 -0400] kallistec: knuckolls: you might also have a `setsid` command on your system or be able to install one
[2012-05-22 03:49:47 -0400] knuckolls: kallistec: yeah setsid is a command on the system
[2012-05-22 03:49:55 -0400] knuckolls: trying that ruby_block again properly formatted
[2012-05-22 03:52:31 -0400] knuckolls: k it's firing up a new machine with the properly formatted ruby_block, next i'll try the -b on the start-stop-daemon
[2012-05-22 03:53:15 -0400] kallistec: knuckolls: if that's indeed the issue, you might need to put some thought into the long-term solution
[2012-05-22 03:53:34 -0400] kallistec: the man page for start-stop-daemon is pretty stern about using the -b option
[2012-05-22 03:54:07 -0400] knuckolls: i'll read the whole thing
[2012-05-22 03:54:24 -0400] knuckolls: and if -b fixes it, i'll be sure to get with the rabbitmq package maintainers to get it fixed
[2012-05-22 03:55:11 -0400] knuckolls: yeah it is pretty stern about it
[2012-05-22 03:55:24 -0400] kallistec: knuckolls: also checkout the man page for ps, you can use `ps -o` to get specific info about processes
[2012-05-22 03:55:44 -0400] kallistec: eg, ps -o sid to see the session ids
[2012-05-22 03:55:49 -0400] knuckolls: i've used ps heavily, but never ps -o
[2012-05-22 03:55:59 -0400] kallistec: gotta run for now, good luck
[2012-05-22 03:57:08 -0400] knuckolls: hey many thanks. i wasn't aware of these process groups at all
[2012-05-22 03:59:31 -0400] knuckolls: ruby_block and the fork code didn't work.
[2012-05-22 03:59:38 -0400] knuckolls: attempting the start-stop-daemon -b solution
[2012-05-22 04:17:05 -0400] knuckolls: kallistec: it looks like running setsid /etc/init.d/rabbitmq-server {stop, start} actually worked
[2012-05-22 04:17:47 -0400] knuckolls: theoretically. i'm tired. running again for proof
[2012-05-22 04:22:42 -0400] knuckolls: ACHIEVEMENT UNLOCKED
[2012-05-22 04:22:53 -0400] knuckolls: it worked. thanks kallistec.
[2012-05-22 04:24:25 -0400] knuckolls: i'll be pushing out a pull request here pretty soon with all these fixes. for now -- sleep.
[2012-05-22 04:35:48 -0400] miah: yay
[2012-05-22 04:40:10 -0400] hoover_damm: next time don't hook up the inverter to the doohkey in the flyback transformer hooked up to the 1972 transam that zaphod rode in
[2012-05-22 05:04:59 -0400] BryanWB_: ohai chefs!
[2012-05-22 05:05:53 -0400] hippiehacker: BryanWB_: ohai!
[2012-05-22 05:06:10 -0400] BryanWB_: hippiehacker: hey man!
[2012-05-22 05:06:43 -0400] BryanWB_: sparc_: mos def!
[2012-05-22 05:07:47 -0400] hippiehacker: BryanWB_: https://github.com/caryp/toft/tree/node_base_class
[2012-05-22 05:07:56 -0400] hippiehacker: still need to fill in the details
[2012-05-22 05:08:09 -0400] hippiehacker: hoping to get a free moment or two soon 8)
[2012-05-22 05:10:56 -0400] BryanWB_: hippiehacker: nice!
[2012-05-22 05:22:43 -0400] yfeldblum: morning, BryanWB_
[2012-05-22 05:23:18 -0400] BryanWB_: yfeldblum: morning homez
[2012-05-22 05:23:24 -0400] yfeldblum: hippiehacker, is https://github.com/applicationsonline/librarian/issues/67 solved or still an issue?
[2012-05-22 05:24:35 -0400] ssd7: Ohai all
[2012-05-22 05:29:26 -0400] BryanWB_: sup ssd7
[2012-05-22 05:31:21 -0400] ssd7: nm
[2012-05-22 05:38:43 -0400] hippiehacker: yfeldblum: I'll test that tomorrow, I haven't checked yet. Going to bed
[2012-05-22 05:43:45 -0400] miah: hi
[2012-05-22 05:45:39 -0400] BryanWB_: miah: good evening
[2012-05-22 06:04:31 -0400] atomic-penguin: BryanWB_, I think I fixed the problem with the NFS LWRP finally.  Now its way past bedtime
[2012-05-22 06:04:39 -0400] BryanWB_: atomic-penguin: awesome
[2012-05-22 06:05:08 -0400] xiaotian: a question, when chef-solo starts, does it load all cookbooks? one of my recipes need to use a resource provided by apt cookbook, I am wondering if I need to specifically load apt cookbook or it should just work?
[2012-05-22 06:05:48 -0400] BryanWB_: xiaotian: i think it loads all cookbooks in your path
[2012-05-22 06:05:52 -0400] BryanWB_: but not sure
[2012-05-22 06:06:11 -0400] atomic-penguin: xiaotian, like a definition or lwrp?
[2012-05-22 06:06:23 -0400] atomic-penguin: xiaotian, then you need a depends in your metadata
[2012-05-22 06:06:32 -0400] xiaotian: I am getting Chef::Exceptions::ResourceNotFound: Cannot find a resource matching execute[apt-get-update] (did you define it first?)
[2012-05-22 06:06:59 -0400] xiaotian: it's apt cookbook.
[2012-05-22 06:07:40 -0400] atomic-penguin: you can't call that type of resource cross recipe
[2012-05-22 06:07:56 -0400] atomic-penguin: you would have to include the recipe to call that recipe
[2012-05-22 06:08:06 -0400] atomic-penguin: *to call that resource
[2012-05-22 06:08:53 -0400] xiaotian: this is where I found it:  https://gist.github.com/1793609
[2012-05-22 06:10:22 -0400] atomic-penguin: I've seen people try to do it before in other cookbooks.  I have never seen it work like that
[2012-05-22 06:11:51 -0400] xiaotian: atomic-penguin: are you suggesting to put include_recipe 'apt' in my recipe?
[2012-05-22 06:11:54 -0400] atomic-penguin: Within the same cookbook, yeah I might have seen that work.  But not cross cookbook
[2012-05-22 06:12:11 -0400] atomic-penguin: Exactly what I am suggesting
[2012-05-22 06:12:46 -0400] atomic-penguin: Or write your own apt execute resource and signal it within your own cookbook/recipe
[2012-05-22 06:13:21 -0400] atomic-penguin: Alright really, got to go to bed now, good luck.
[2012-05-22 06:13:27 -0400] xiaotian: thanks!
[2012-05-22 06:24:35 -0400] reset: xiaotian: what was your question to atomic-penguin?
[2012-05-22 06:24:44 -0400] reset: I only saw the end of it
[2012-05-22 10:24:36 -0400] tube: did the creation of a chef client change with knife 0.10.10? now an editor opens when running a 'knife client create $hostname -n -f /root/.chef-clients/$hostname.pem' so that no automatic creation is possible?
[2012-05-22 10:26:16 -0400] Mithrandir: setting editor to /bin/true might be a workaround.
[2012-05-22 10:42:26 -0400] tube: ah, option '-d' does the job. is it new in 0.10.10?
[2012-05-22 10:49:05 -0400] zts: ~.
[2012-05-22 11:42:23 -0400] BryanWB_: can i notify a resource in another cookbook?
[2012-05-22 11:54:34 -0400] yfeldblum: BryanWB_, yes
[2012-05-22 11:56:19 -0400] geekbri: ohai chefs!
[2012-05-22 12:17:25 -0400] BryanWB_: yfeldblum: tks
[2012-05-22 12:18:39 -0400] BryanWB_: i keep getting json errors when I try to put an ssl key in an encrypted databag, is there a trick to doing it?
[2012-05-22 12:20:07 -0400] BryanWB_: i think google has the answer to my question
[2012-05-22 12:20:25 -0400] atomic-penguin: BryanWB_, like ssl key/cert stuffs?
[2012-05-22 12:21:10 -0400] BryanWB_: atomic-penguin: y
[2012-05-22 12:21:26 -0400] BryanWB_: atomic-penguin: good morning my favorite water-borne fowl ;)
[2012-05-22 12:22:04 -0400] BryanWB_: atomic-penguin: think i just found your certificates cookbook
[2012-05-22 12:22:41 -0400] atomic-penguin: BryanWB_, you just now found it huh?  Or having problems once you discovered it?
[2012-05-22 12:23:25 -0400] BryanWB_: atomic-penguin: just found it, need to revise my thought process
[2012-05-22 12:24:01 -0400] BryanWB_: step 1) encounter problem   step 2) find solution in atomic-penguin 's cookbooks  step 3) implement   ;)
[2012-05-22 12:24:07 -0400] atomic-penguin: So you need to squash the keys/cert objects into one-lines with embedded '\n' characters.
[2012-05-22 12:24:12 -0400] yfeldblum: BryanWB_, are you encoding they key for json?
[2012-05-22 12:24:31 -0400] atomic-penguin: True story, I sit down by random stranger at #chefconf keynote.
[2012-05-22 12:24:53 -0400] atomic-penguin: ...look over and see he's playing with certs/keys.
[2012-05-22 12:25:10 -0400] atomic-penguin: me: Hey, are you using the certificates cb?
[2012-05-22 12:25:16 -0400] atomic-penguin: him: yeah, why?
[2012-05-22 12:25:42 -0400] atomic-penguin: me: I wrote that
[2012-05-22 12:26:02 -0400] atomic-penguin: both: high fives
[2012-05-22 12:26:14 -0400] BryanWB_: ::)
[2012-05-22 12:34:12 -0400] jespada: BryanWB_, this may help: https://gist.github.com/51437ce7edffeccaf44b
[2012-05-22 12:34:48 -0400] BryanWB_: jespada: tks
[2012-05-22 14:05:35 -0400] atomic-penguin: BryanWB_, you guys doing a foodfight today?
[2012-05-22 14:08:26 -0400] mattray: atomic-penguin: yeah
[2012-05-22 14:08:47 -0400] atomic-penguin: I'm catching up on 12 & 13 now
[2012-05-22 14:23:35 -0400] drrk: A bit of an odd question, but is knife available as an API I cen use in other apps?
[2012-05-22 14:24:00 -0400] drrk: or atleast the ability to bootstrap a new node
[2012-05-22 14:24:05 -0400] royh: drrk: knife - Chef Server API client utility
[2012-05-22 14:24:30 -0400] mattray: drrk: knife is just calling Fog
[2012-05-22 14:24:49 -0400] drrk: even for bootstrapping over ssh?
[2012-05-22 14:25:05 -0400] drrk: I thought fog was for creating cloud instances
[2012-05-22 14:25:06 -0400] ssd7: drrk: Check out http://wiki.opscode.com/display/chef/Knife+Plugins#KnifePlugins-UsingPluginswithinOtherPlugins  If you are in Ruby you should be able to use a similar method
[2012-05-22 14:25:36 -0400] drrk: ah cool, thanks :)
[2012-05-22 14:26:37 -0400] mattray: drrk: you are correct, fog creates the instance, Knife::Bootstrap does the rest
[2012-05-22 14:27:24 -0400] laurent\:  i'm watching "Opscode Chef State of the Union Part 2: Chef, the Future" OMG LOL
[2012-05-22 14:29:50 -0400] yfeldblum: knife is a CLI (and also a framework for writing code that will be exposed in the knife CLI)
[2012-05-22 14:30:01 -0400] drrk: thanks mattray, I can work with that then
[2012-05-22 14:30:44 -0400] yfeldblum: but you can definitely peek inside the knife source and see the APIs that knife actually uses
[2012-05-22 14:31:04 -0400] geekbri: You sure can!  I've done it much, its pretty easy to digest for the most part
[2012-05-22 14:31:07 -0400] drrk: Also, i'm wanting a backup chefserver, can that be doen with jsut installign it twice but pointing both at the same database (and then having a replica db) ?
[2012-05-22 14:31:08 -0400] geekbri: assuming you know ruby of course.
[2012-05-22 14:31:33 -0400] yfeldblum: for example, here's how knife-ec2 creates a new node: https://github.com/opscode/knife-ec2/blob/master/lib/chef/knife/ec2_server_create.rb
[2012-05-22 14:31:41 -0400] drrk: well, I am learnign ruby, but I know so many languages no adding one more is trivial
[2012-05-22 14:32:35 -0400] yfeldblum: drrk, not exactly, since there are many moving parts involved (solr, rabbit, chef-expander, and a shared/clustered/replicated filesystem)
[2012-05-22 14:32:41 -0400] yfeldblum: in addition to couchdb
[2012-05-22 14:33:06 -0400] drrk: right, I guess I need to look more at the internals of that then
[2012-05-22 14:33:11 -0400] withnale_: how do you version role and environment attributes?
[2012-05-22 14:35:41 -0400] drrk: ah found a server fault answer with the same info :)
[2012-05-22 14:38:11 -0400] kiall: Heya, I'm trying to use a cookbook that "recommends apt" in its metadata.rb, when I run chef-client, I get an error: Cookbook apt not found. If you're loading apt from another cookbook, make sure you configure the dependency in your metadata. Is there something special I need to do to trigger the use of a recommended cookbook?
[2012-05-22 14:41:22 -0400] oddityoverseer13: kiall: I think the 'apt' they are referring to is the apt package. You need to have that installed to use the cookbook that you are installing.
[2012-05-22 14:42:01 -0400] mattray: withnale: currently with your own version control
[2012-05-22 14:42:04 -0400] oddityoverseer13: kiall: oh, wait. nvm
[2012-05-22 14:42:05 -0400] kiall: oddityoverseer13, I dont think so.. According to the docs recommends "Adds a dependency on another cookbook that is not required (ie: we'll work without it) but is a good idea."
[2012-05-22 14:42:41 -0400] oddityoverseer13: kiall: Yea, I missed the "cookbook apt" part in your description. :P
[2012-05-22 14:42:53 -0400] kiall: Basically, I'm wondering if the only way to have the cookbook loaded is to apply a recipe from it.. Which seems wrong (since I dont want to use its recipes directly)
[2012-05-22 14:42:55 -0400] oddityoverseer13: kiall: I'm pretty new to chef, so idk.
[2012-05-22 14:44:08 -0400] oddityoverseer13: kiall: you could add it to the run list for the node.
[2012-05-22 14:45:04 -0400] oddityoverseer13: kiall: I think you can also include them from another cookbook, but I've never done that.
[2012-05-22 14:45:54 -0400] kiall: oddityoverseer13, I could add a recipe from it to the run list alright, but since I don't actually want its recipes.. It seems there should be a way to have "recommended" coookbooks downloaded when they are available
[2012-05-22 14:46:37 -0400] kiall: Another 3rd party cookbook wants to make use of its providers, .. Anyway.. Just trying to find the "right" way to have recommended cookbooks loaded, rather than jerry rigging it to work this time :)
[2012-05-22 14:48:12 -0400] acrocity: I upgraded to chef 0.10.10 and now my mysql service script will not start
[2012-05-22 14:48:15 -0400] oddityoverseer13: kiall: I understand. I'll leave it for someone else to answer your question, since I don't really know
[2012-05-22 14:48:20 -0400] acrocity: it works fine in 0.10.8
[2012-05-22 14:48:23 -0400] acrocity: but now I get Errno::ENOEXEC: Exec format error - /etc/init.d/mysql start
[2012-05-22 14:48:33 -0400] acrocity: anyone have an idea what's happening here?
[2012-05-22 14:48:49 -0400] drrk: is chef-solr different from apache-solr ?
[2012-05-22 14:50:07 -0400] oddityoverseer13: acrocity: perhaps there's a syntax error in your '/etc/init.d/mysql start' execute call?
[2012-05-22 14:50:37 -0400] hoover_damm: drrk, yep
[2012-05-22 14:50:51 -0400] hoover_damm: drrk, at least in the sense it has a schema pre-applied to it
[2012-05-22 14:51:01 -0400] hoover_damm: drrk, afaik it's stock solr just with a wrapper and a config file applied
[2012-05-22 14:51:07 -0400] oddityoverseer13: I am having some trouble with attributes I have a recipe that is using syntax like this: `node["iptables"]["rules"], which I define in the defaults.rb attributes file, then I want to merge those contents with the attribute definitions in /etc/chef/node.json. But I can't get them to merge. I must be missing something.
[2012-05-22 14:51:26 -0400] drrk: ah right, so any solr replication stratagies I can apply to it
[2012-05-22 14:51:43 -0400] hoover_damm: drrk, from what I understand the chef schema makes replication impossible
[2012-05-22 14:52:00 -0400] oddityoverseer13: Can anyone point me to a page on the wiki that shows how to define attributes in json (default, normal, and override)?
[2012-05-22 14:52:01 -0400] hoover_damm: that could be old information and it's pulled straight out of memory
[2012-05-22 14:53:24 -0400] acrocity: oddityoverseer13: well, the thing is I haven't changed anything in my recipes or scripts
[2012-05-22 14:53:36 -0400] hoover_damm: drrk, however the last post I see in the mailing list regarding it was to look into Solr Apache replication
[2012-05-22 14:53:38 -0400] acrocity: oddityoverseer13: just upgraded to 0.10.10 and now it throws out that error
[2012-05-22 14:53:47 -0400] hoover_damm: drrk, as the solr bundled in chef 0.10.x isn't as sane to replicate with
[2012-05-22 14:54:04 -0400] hoover_damm: drrk, so perhaps straight up Solr with the proper schema would replicate fairly easily.  Might be some issues with expander
[2012-05-22 14:54:29 -0400] drrk: could you have independant solr servers indexing the same couchdb
[2012-05-22 14:55:33 -0400] hoover_damm: you'd have seperate expanders
[2012-05-22 14:55:34 -0400] hoover_damm: but yer
[2012-05-22 14:55:39 -0400] hoover_damm: as in only 1 expander likely :)
[2012-05-22 14:55:56 -0400] hoover_damm: drrk, http://permalink.gmane.org/gmane.comp.sysutils.chef.user/3950
[2012-05-22 14:56:17 -0400] drrk: maybe I should just convince $EMPLOYER to pay for hosted chef
[2012-05-22 14:56:40 -0400] oddityoverseer13: acrocity: Maybe look through the change log for 0.10.10 and see if anything applies to what you're doing?
[2012-05-22 14:57:25 -0400] yfeldblum: drrk, there's hosted chef, and there's also the option for private chef if you're looking for a prebuilt HA chef-server
[2012-05-22 14:57:36 -0400] hoover_damm: that's a novel idea
[2012-05-22 14:57:39 -0400] oddityoverseer13: acrocity: http://www.opscode.com/blog/2012/05/11/chef-0-10-10-released/
[2012-05-22 14:57:49 -0400] drrk: yfeldblum: I'm guessing it doesn't come cheap though?
[2012-05-22 14:57:59 -0400] acrocity: oddityoverseer13: thx!
[2012-05-22 14:58:07 -0400] oddityoverseer13: acrocity: np
[2012-05-22 14:58:41 -0400] yfeldblum: drrk, don't know, haven't asked; i believe private-chef pricing is custom
[2012-05-22 14:59:07 -0400] mattray: kinda depends on how much you pay people to manage it internally
[2012-05-22 14:59:16 -0400] ssd7: drrk: 'Cheap' is relative.  It isn't inexpensive but we think that for what you get it is reasonably priced.
[2012-05-22 14:59:39 -0400] yfeldblum: ssd7, is that oracle for $10,000,000/node?
[2012-05-22 14:59:52 -0400] ssd7: That being said, if you are a smaller shop or just ramping up on Chef, Hosted Chef is probably best
[2012-05-22 14:59:53 -0400] hoover_damm: drrk, just explain to your boss that the price of Private Chef is worth it.  As in when a problem comes up you call Opscode
[2012-05-22 14:59:59 -0400] drrk: yeah, councils don't have much money though, and they are paying me regardless, so I suspect they woudl prefer me to jsut figure it out
[2012-05-22 15:00:08 -0400] ssd7: drrk: :)
[2012-05-22 15:00:10 -0400] hoover_damm: drrk, it's much more effecient then you having to manage the Chef Server
[2012-05-22 15:00:20 -0400] hoover_damm: drrk, think of disaster recovery / scaling / etc
[2012-05-22 15:00:46 -0400] hoover_damm: that is truly where the Hosted / Private chef comes in? had an issue setting up a chef server? had a problem scaling one? didn't want to learn how to set one up?
[2012-05-22 15:01:08 -0400] hoover_damm: and chef becomes your source of truth.
[2012-05-22 15:01:16 -0400] drrk: I suspect it's goign to be cheaper than hosted chef given we are talking 1000+ nodes
[2012-05-22 15:01:20 -0400] geekbri: Getting chef server installed isn't so bad, but the hosted chef alone is worth it to avoid the scaling / redundancy stuff
[2012-05-22 15:01:22 -0400] hoover_damm: learn to use that, expand chef's ability beyond
[2012-05-22 15:01:37 -0400] hoover_damm: geekbri, right
[2012-05-22 15:02:11 -0400] hoover_damm: drrk, basically I'd just contact opscode privately and have that discussion
[2012-05-22 15:02:22 -0400] oddityoverseer13: Can anyone point me to a page on the wiki that shows how to define attributes in the default.rb file, and merge them with attributes defined in json (using default, normal, and override)?
[2012-05-22 15:02:23 -0400] hoover_damm: if you need it you need it.
[2012-05-22 15:02:39 -0400] drrk: chef server is installed and working fine, but i'm concerned abtou if that server catches fire and I need a new one
[2012-05-22 15:02:50 -0400] drrk: hoover_damm: yeah I tihnk you may be right
[2012-05-22 15:02:57 -0400] hoover_damm: right what happens if couchdb crashes and you have to recover the data?
[2012-05-22 15:03:16 -0400] hoover_damm: this is a pretty common issue where couchdb screws up for some 'x' reason and you need to manually fix it
[2012-05-22 15:03:29 -0400] hoover_damm: unless your a couchdb pro who can just login to futon or fix it via curl
[2012-05-22 15:03:47 -0400] drrk: nope never heard of couchdb before chef :)
[2012-05-22 15:03:48 -0400] hoover_damm: honestly, Chef is where I learned my CouchDB skills.  It's too bad I've never been able to use them outside of Chef
[2012-05-22 15:04:07 -0400] hoover_damm: it's a great database that is often mocked and ignored because of misuse and misunderstanding
[2012-05-22 15:04:43 -0400] hoover_damm: hasn't gained enough adoption and and it's fun enough to upgrade / recover that it keeps the kids saying mongodb is better
[2012-05-22 15:04:48 -0400] hoover_damm: oh what they don't know
[2012-05-22 15:04:49 -0400] hoover_damm: lol
[2012-05-22 15:08:26 -0400] yfeldblum: drrk, so you only need disaster recovery with a couchdb backup & checksums dir backup probably, because you can just stand up a new chef-server, restore the db & checksums dir, and go
[2012-05-22 15:10:51 -0400] drrk: yeah, I can deal with a warm spare - there will already be a second machine running mysql slave for openstack
[2012-05-22 15:14:18 -0400] drrk: so backup /var/cache/chef, /var/lib/chef /etc/chef and couchdb and i shoudl be good?
[2012-05-22 15:14:27 -0400] cap10morgan: where is the "config" hash defined that exists inside a knife plugin?
[2012-05-22 15:17:08 -0400] ssd7: cap10morgan: It is created by mixlib-cli
[2012-05-22 15:17:25 -0400] cap10morgan: ssd7: ah ha, ok. thanks
[2012-05-22 15:18:54 -0400] drrk: I wonder if I can just drbd the relevant directories and swap the live system if itfails
[2012-05-22 15:24:16 -0400] hoover_damm: drrk, it's a bit more then that
[2012-05-22 15:24:24 -0400] hoover_damm: and drbd likely would be a better mechanism
[2012-05-22 15:24:43 -0400] hoover_damm: drrk, and have couchdb's datadir and the solr datadir on the drbd disk
[2012-05-22 15:24:55 -0400] hoover_damm: then just pacemaker/heartbeat to flip
[2012-05-22 15:25:05 -0400] imeyer: thom: <3
[2012-05-22 15:25:26 -0400] hoover_damm: but after awhile you also gotta evaluate saving your time
[2012-05-22 15:25:44 -0400] hoover_damm: and the Opscode Hosting Pattern is the best way to save your time and effort
[2012-05-22 15:26:33 -0400] oddityoverseer13: Can anyone point me to a page on the wiki (or a cookbook or something) that shows how to merge attributes via json (default, normal, and override)?
[2012-05-22 15:27:18 -0400] mattray: oddityoverseer13: wiki.opscode.com/display/chef/Attributes
[2012-05-22 15:27:59 -0400] mattray: drrk: docs for private chef, including the HA setup are here: private-chef-docs.opscode.com
[2012-05-22 15:32:16 -0400] drrk: mattray: I assue they won't work with opensource chef :)
[2012-05-22 15:32:48 -0400] juliancdunn: what file is knife-ec2 trying to read when I specify "knife[:aws_ssh_key_id]" in knife.rb?
[2012-05-22 15:33:05 -0400] hoover_damm: drrk, should
[2012-05-22 15:33:23 -0400] mattray: drrk: the setups are similar, if you really want to run your own open source server in HA it's a good starting place
[2012-05-22 15:34:06 -0400] drrk: mattray: cheers, I really want to give you lots of money, but I don't hold purse strings sadly :(
[2012-05-22 15:34:11 -0400] mattray: then I'd recommend taking a good whack at this: http://wiki.opscode.com/display/chef/Scalability+and+High+Availability
[2012-05-22 15:34:15 -0400] jessicab: juliancdunn - you just set the name there.. youll also want to add it to your ssh agent or use -S to specify the location
[2012-05-22 15:34:17 -0400] mattray: and documenting your findings
[2012-05-22 15:34:51 -0400] jessicab: juliancdunn - might be helpful - http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide#EC2BootstrapFastStartGuide-Step2%3AConfigureAWSsettingsandtheknife.rbfile
[2012-05-22 15:35:27 -0400] mattray: drrk: essentially it uses drbd with keepalived
[2012-05-22 15:35:37 -0400] juliancdunn: jessicab: ah, thanks! I forgot to add it to my ssh-agent
[2012-05-22 15:35:49 -0400] hoover_damm: drrk, yep you don't control the purse strings.  So don't feel bad
[2012-05-22 15:35:59 -0400] oddityoverseer13: mattray: so if I want to merge values in an array (one in the cookbook attributes and the other in node.json on the node), how would that look?
[2012-05-22 15:36:08 -0400] hoover_damm: all you can do is evaluate, leave the details and let them decide
[2012-05-22 15:36:26 -0400] drrk: quite
[2012-05-22 15:36:27 -0400] bean: So, lets say I have a staging server and a production server that the developers don't get access to. What is the best method for moving clients from one chef server to the other? Just rebootstrap them?
[2012-05-22 15:36:27 -0400] hoover_damm: and if you don't want to live with their decision you can always find a new job :)
[2012-05-22 15:36:40 -0400] hoover_damm: the joke lately in the rails world is if you want to upgrade rails quit your job
[2012-05-22 15:36:42 -0400] drrk: yeah, i'm trying :)
[2012-05-22 15:36:53 -0400] mattray: bean: Environments
[2012-05-22 15:37:06 -0400] bean: mattray: I can't use environments like that
[2012-05-22 15:37:12 -0400] mattray: oh wait, just reread that
[2012-05-22 15:37:14 -0400] drrk: north-west england is rather lacking on new jobs at the moment
[2012-05-22 15:37:29 -0400] mattray: oddityoverseer13: http://wiki.opscode.com/display/chef/Deep+Merge attributes of the same precedence in arrays get merged
[2012-05-22 15:37:45 -0400] drrk: although I suspect i've missed the boat on one I would have liked, but I was ill when it was announced
[2012-05-22 15:37:51 -0400] oddityoverseer13: mattray: I've tried that. I can't get it to work.
[2012-05-22 15:38:04 -0400] hoover_damm: I'd love to work in the office and do the full 8 hour thing again
[2012-05-22 15:38:09 -0400] mattray: oddityoverseer13: what json are you using?
[2012-05-22 15:38:11 -0400] hoover_damm: I just don't know how anymore
[2012-05-22 15:38:22 -0400] mattray: oddityoverseer13: you're mixing attributes in a cookbook with...
[2012-05-22 15:38:36 -0400] drrk: hoover_damm: it's overrated
[2012-05-22 15:38:51 -0400] oddityoverseer13: mattray: with attributes in /etc/chef/node.json on the node
[2012-05-22 15:38:57 -0400] drrk: I much prefer workign from home, noone comes up and bugs me all day :)
[2012-05-22 15:39:14 -0400] mattray: oddityoverseer13: why node.json?
[2012-05-22 15:39:44 -0400] drrk: on that note, i'm off home
[2012-05-22 15:39:50 -0400] mattray: oddityoverseer13: you just about never want to edit nodes directly
[2012-05-22 15:39:58 -0400] oddityoverseer13: mattray: What I'm doing is creating an iptables file, based on default rules, then if a node needs more added, I'd add them in the node.json
[2012-05-22 15:40:00 -0400] bean: so, mattray, rebootstrap is best option probably?
[2012-05-22 15:40:32 -0400] oddityoverseer13: mattray: I'm also planning on using roles, but some will need it specifically for one node
[2012-05-22 15:40:42 -0400] mattray: oddityoverseer13: really want to use iptables, or is ufw an option?
[2012-05-22 15:40:50 -0400] mattray: oddityoverseer13: because the ufw cookbook has solved that problem
[2012-05-22 15:41:01 -0400] mattray: oddityoverseer13: and the firewall cookbook could be updated to support iptables
[2012-05-22 15:41:31 -0400] oddityoverseer13: mattray: lemme take a look at ufw for a sec. I don't think I can use it
[2012-05-22 15:41:46 -0400] mattray: bean: I guess, I don't usually bounce nodes from one chef server to another. I prefer to know how my machines got configured
[2012-05-22 15:42:02 -0400] bean: mattray: normally I wouldn't either.
[2012-05-22 15:42:11 -0400] bean: Compliance likes devs to not have access unfortunatelu.
[2012-05-22 15:42:15 -0400] bean: unfortunately*
[2012-05-22 15:42:27 -0400] mattray: bean: so update the client.rb, replace the validator.pem and chef-client
[2012-05-22 15:43:07 -0400] mattray: bean: you could automate that using knife ssh
[2012-05-22 15:43:10 -0400] oddityoverseer13: mattray: no. we have iptables everywhere already. and we're using RHEL.
[2012-05-22 15:43:19 -0400] mattray: oddityoverseer13: I figured
[2012-05-22 15:43:49 -0400] mattray: oddityoverseer13: the firewall cookbook is meant to support multiple providers, just have to implement iptables the same way ufw is implemented
[2012-05-22 15:44:01 -0400] happycrappy: Hi all, I got a quick question, is it possible to have 2 independent versions of chef-solo installed on the same machine? my hosting provider has an ancient version installed (0.60) and I was wondering if I could install a newer version to manage my app related configuration without breaking anything
[2012-05-22 15:44:28 -0400] oddityoverseer13: ok, so yeah. I looked at the attributes file for ufw. That's what I'm trying to do. So how would you add a rule for a specific node?
[2012-05-22 15:44:55 -0400] mattray: oddityoverseer13: it supports a variety of techniques, but I prefer using roles
[2012-05-22 15:45:22 -0400] mattray: so apply the roles that contain your firewall rules and the cookbook will apply them
[2012-05-22 15:45:30 -0400] mattray: just attributes getting merged
[2012-05-22 15:45:44 -0400] oddityoverseer13: mattray: most of what I will need will be on the role level, but there will be a few instances that require rules on the node level
[2012-05-22 15:46:20 -0400] mattray: oddityoverseer13: then have a role that is only applied to 1 node. That way your rules are still in version control, nodes aren't
[2012-05-22 15:46:44 -0400] mattray: a little hacky, but nodes are ephemeral
[2012-05-22 15:46:44 -0400] oddityoverseer13: mattray: Ah. Hadn't thought of that. Lemme give that a shot.
[2012-05-22 15:46:57 -0400] oddityoverseer13: mattray: Thanks!
[2012-05-22 15:47:12 -0400] mattray: lemme know if you ever want to add iptables to firewall ;)
[2012-05-22 15:48:00 -0400] oddityoverseer13: mattray: hehe. I might. btw: is that the idea for how all attributes should work? most of the time, you don't really set anything with nodes?
[2012-05-22 15:48:30 -0400] mattray: oddityoverseer13: definitely. Editing nodes directly is an anti-pattern
[2012-05-22 15:49:17 -0400] mattray: so if your machine that has the 1 role assigned to it goes away, you can reapply that role to its replacement
[2012-05-22 15:56:50 -0400] oddityoverseer13: mattray: but if it's an antipattern, why have role-specific attributes be available at all?
[2012-05-22 15:56:58 -0400] gmcinnes: Anyone seen any reports of ruby-shadow segfaulting on ubuntu?
[2012-05-22 15:57:09 -0400] yfeldblum: bean, you have servers moving between groups?
[2012-05-22 15:57:32 -0400] bean: yfeldblum: basically, I have to separate access between the sysadmin team and the dev team
[2012-05-22 15:57:35 -0400] bean: for production
[2012-05-22 15:57:36 -0400] bean: for compliance.
[2012-05-22 16:02:09 -0400] mattray: oddityoverseer13: attributes in roles make sense, since roles are stored in files
[2012-05-22 16:02:19 -0400] mattray: oddityoverseer13: I assume you mean nodes?
[2012-05-22 16:02:28 -0400] oddityoverseer13: mattray: gah. meant node
[2012-05-22 16:02:30 -0400] oddityoverseer13: yes
[2012-05-22 16:03:39 -0400] mattray: oddityoverseer13: we try not to stop you from doing what you want, even if we don't think it's a great idea ;)
[2012-05-22 16:06:02 -0400] yfeldblum: bean, right, gotcha, but ... you have servers moving between groups?
[2012-05-22 16:12:26 -0400] oddityoverseer13: mattray: so just wondering. would this be the right syntax if I _did_ want to put it on the node? "default_attributes": {     "rules" : ["asdfasdfi12341234"]   }
[2012-05-22 16:24:20 -0400] oddityoverseer13: mattray: ?
[2012-05-22 16:24:20 -0400] bawt: mattray: are we going to move the "official" hp cloud knife plugin to github.com/opscode from /mray at some point? :)
[2012-05-22 16:24:34 -0400] mattray: oddityoverseer13: sorry, on a call
[2012-05-22 16:24:41 -0400] oddityoverseer13: mattray: ok, np
[2012-05-22 16:24:48 -0400] mattray: bawt: yes
[2012-05-22 16:24:51 -0400] mattray: ;)
[2012-05-22 16:36:01 -0400] BryanWB: yo chefs
[2012-05-22 16:37:01 -0400] atomic-penguin: yo yo
[2012-05-22 16:37:12 -0400] yfeldblum: yo
[2012-05-22 16:37:16 -0400] thehar: werd up
[2012-05-22 16:37:56 -0400] atomic-penguin: updog
[2012-05-22 16:38:59 -0400] c_t: A semi full of henweigh overturned on I-5 by the Tacoma Dome this morning
[2012-05-22 16:48:46 -0400] hoover_damm: c_t, I have had packetloss since 1am of around 40-50%
[2012-05-22 16:48:47 -0400] hoover_damm: steady
[2012-05-22 16:48:55 -0400] hoover_damm: c_t, TCP Re-transmission ftw
[2012-05-22 16:49:22 -0400] c_t: I'm waiting for someone to ask me what's a henweight
[2012-05-22 16:49:26 -0400] c_t: er, henweigh
[2012-05-22 16:50:04 -0400] hoover_damm: about 5 pounds
[2012-05-22 16:50:16 -0400] c_t: badumdum
[2012-05-22 16:50:18 -0400] c_t: thank you sir
[2012-05-22 16:52:10 -0400] happycrappy: anyone know if its possible to run multiple versions of chef-solo on the same server? my hosting provider uses an old version of chef (0.60) to bootstrap the server and I was hoping to use a newer version of chef-solo to take over after bootstrap
[2012-05-22 16:59:24 -0400] oddityoverseer13: happycrappy: I don't see a reason why you couldn't. You'd just need to install it in a different directory. But I'd ask one of the others in here as well.
[2012-05-22 17:22:27 -0400] nyaray: So... I've got this issue where nodes are showing up in the node list, but not in the status list.. Any pointers? I tried googling, but with no luck
[2012-05-22 17:28:19 -0400] hoover_damm: sigh, 10:30 and the packetloss still continues
[2012-05-22 17:28:21 -0400] hoover_damm: grumble
[2012-05-22 17:28:41 -0400] cheeseplus: packet loss makes me sad
[2012-05-22 17:29:04 -0400] hoover_damm: yesterday had enough rain that it clearly saturated the comcast wires again
[2012-05-22 17:29:22 -0400] hoover_damm: the wiring is waterlogged in my area of Seattle
[2012-05-22 17:29:47 -0400] hoover_damm: Qwest could never even provide residential service that stood up to the Public Utility Department's standards
[2012-05-22 17:30:21 -0400] hoover_damm: their new name isn't any different, tiz just the waterlogged wires that when they get wet... the water creeps up the wiring into the house
[2012-05-22 17:30:22 -0400] hoover_damm: utility companies claim the reverse
[2012-05-22 17:30:36 -0400] hoover_damm: but after I've seen the water wick up the comcast wires twice... I don't believe their fud
[2012-05-22 17:31:05 -0400] c_t: Intarweb providers kinda suck: Film at 11
[2012-05-22 17:31:22 -0400] JasonBox: heh
[2012-05-22 17:32:27 -0400] nyaray: US intarweb providers
[2012-05-22 17:32:44 -0400] nyaray: :P
[2012-05-22 17:41:00 -0400] iroller: Hey Chefs. Is it possible to execute a self-written plugin for knife using `knife exec -E ''`?
[2012-05-22 17:41:31 -0400] hoover_damm: iroller, most plugins really only need the require chef/rubygems stanza
[2012-05-22 17:41:40 -0400] hoover_damm: iroller, at least that's what my brain is thinking
[2012-05-22 17:42:15 -0400] maek: I have to many link in /var/cache/chef/sandboxes - can I just blow them away?
[2012-05-22 17:43:17 -0400] hoover_damm: iroller, for the plugin I have linked on likens.us (http) only requires 'chef' and 'chef/knife' and rubygems
[2012-05-22 17:43:26 -0400] hoover_damm: iroller, and then it can be ran iteractively
[2012-05-22 17:43:38 -0400] hoover_damm: without knife
[2012-05-22 17:45:08 -0400] iroller: hoover_damm: yeah, the whole idea is to use knife plugins both with knife and without knife(in external app)
[2012-05-22 17:45:50 -0400] hoover_damm: sounds fine
[2012-05-22 17:45:58 -0400] hoover_damm: chef / knife / etc all work in and out of chef
[2012-05-22 18:10:09 -0400] Javin: Question: What is the right way to do the following? As what I am doing does not work as intended.
[2012-05-22 18:10:10 -0400] Javin: dbnode = search(:node, "fqdn:db01.example.com")
[2012-05-22 18:10:11 -0400] Javin: print dbnode[:fqdn]
[2012-05-22 18:10:23 -0400] holoway: Javin: search returns an array
[2012-05-22 18:11:35 -0400] hoover_damm: Javin, http://wiki.opscode.com/display/chef/Search
[2012-05-22 18:12:05 -0400] hoover_damm: Javin, take a look at cookbooks that use search and see how they use it :) should fill in the blanks from the the documentation
[2012-05-22 18:12:26 -0400] hoover_damm: https://github.com/opscode-cookbooks/ssh_known_hosts/blob/master/recipes/default.rb
[2012-05-22 18:13:34 -0400] Javin: Ok, I'll take a look at the cookbook.
[2012-05-22 18:13:38 -0400] Javin: thanks
[2012-05-22 18:14:05 -0400] heph: does anyone have suggestions for managing encrypted data bag keys? my original plan was to store them in an encrypted data bag, using the validation pem to install role-specific keys on a system before deleting the validation.pem
[2012-05-22 18:16:16 -0400] heph: but i run into problems where the file resource fails because the decryption key is unavailable sometimes. I even set 'only_if "test -f /path/to/decryption.key"', but it still evaluates the encrypteddatabag code, which generates errors if the decryption key isn't found
[2012-05-22 18:18:17 -0400] heph: we're trying to get to a situation where we don't store any sensitive data on the chef server itself unencrypted, especially data bag keys
[2012-05-22 18:18:36 -0400] heph: but we still need a way to deploy role-specific keys to a host
[2012-05-22 18:19:05 -0400] Javin: so, to answer my own question, in the case above, this seems to do as intended: print dbnode[0]['fqdn']
[2012-05-22 18:20:24 -0400] holoway: heph: if you're really concerned about protecting the data from chef, you can't distribute them with chef
[2012-05-22 18:20:39 -0400] hoover_damm: Javin, dbnode.first['fqdn']
[2012-05-22 18:20:59 -0400] hoover_damm: Javin, http://www.ruby-doc.org/core-1.9.3/Array.html
[2012-05-22 18:21:16 -0400] hoover_damm: Javin, knowing how to handle the different object types helps :)
[2012-05-22 18:22:39 -0400] heph: holoway: we're concerned about the chef server, not about the client. the initial plan was to use a 'master' key which is installed by kickstart to decrypt a databag with keys to other data bags, then install the relevant keys on a system, then delete the master key. this would prevent anyone who doesn't have the master key from accessing any of the data on the chef server, and after the system has been provisioned by chef the first time, would prevent access t
[2012-05-22 18:23:56 -0400] heph: and that *should* be working, except that the Chef::EncryptedDataBagItem is failing when the decryption key isn't available, even if i specify "only_if key exists"
[2012-05-22 18:24:17 -0400] Javin: hoover_damm: I completely agree. As as ops guy by nature, and a programming guy by necessity, some of this stuff is just a bit less intuitive to me then most, and leaks out the brain as fast as it gets crammed in.But, I'm doing worlds better then 6 months ago with all of this.
[2012-05-22 18:30:18 -0400] darkonedd1: hello, i need help with knife it fails with error
[2012-05-22 18:30:22 -0400] darkonedd1: #> knife cookbook upload iptables -o cookbooks/
[2012-05-22 18:30:24 -0400] darkonedd1: Uploading iptables             [1.1.0]
[2012-05-22 18:30:26 -0400] darkonedd1: ERROR: TypeError: can't convert nil into String
[2012-05-22 18:30:30 -0400] darkonedd1: ruby -d /usr/bin/knife cookbook upload iptables -o cookbooks/
[2012-05-22 18:30:34 -0400] darkonedd1: Exception `TypeError' at /usr/lib/ruby/gems/1.8/gems/moneta-0.6.0/lib/moneta/basic_file.rb:28 - can't convert nil into String
[2012-05-22 18:30:36 -0400] darkonedd1: ruby -v && knife -v
[2012-05-22 18:30:38 -0400] darkonedd1: ruby 1.8.7 (2010-01-10 patchlevel 249) [x86_64-linux]
[2012-05-22 18:30:40 -0400] darkonedd1: Chef: 0.10.10
[2012-05-22 18:31:01 -0400] heph: darkonedd1: at some point you're attempting a to_s on an undefined object
[2012-05-22 18:31:40 -0400] darkonedd1: yeah i saw that, but how to fix that, i installed chef from gem
[2012-05-22 18:32:59 -0400] oddityoverseer13: mattray: you back on yet?
[2012-05-22 18:33:26 -0400] iroller: hoover_damm: any thoughts on how to execute knife plugin outside chef/knife/commandline without changing the plugin? But default all the knife plugins requires arguments to be passed to STDIN, but I want to pass it like Chef::Knife::MyPlugin.run(args)
[2012-05-22 18:39:48 -0400] rayrod2030: anybody able to get the opscode mysql cookbook working for ubuntu 12.04/mysql 5.5?
[2012-05-22 19:24:30 -0400] miah: moin
[2012-05-22 19:25:39 -0400] miah: heph: do you wrap the encrypteddatabag load in a block that checks for existence of key?
[2012-05-22 19:27:19 -0400] miah: rather than relying on only_if
[2012-05-22 19:28:32 -0400] hoover_damm: iroller, ahh if you want 'arguments' you end up into he how to get arguments from a ruby script on the command line
[2012-05-22 19:34:42 -0400] heph: miah: that's what my current plan is
[2012-05-22 20:09:50 -0400] bencaron: yum cookbook vs yumrepo cookbook : what significant differences between them?
[2012-05-22 20:10:36 -0400] bencaron: yum is a fork of yumrepo?
[2012-05-22 20:12:48 -0400] bencaron: it's a slow day here today. Must have missed an holiday or something ;)
[2012-05-22 20:13:44 -0400] heph: is it possible to define a resource with no action, overriding default? For example, I want a file resource with no action at all, so chef does absolutely nothing to that file unless i send a notify to it?
[2012-05-22 20:14:24 -0400] bencaron: heph: I think yes.
[2012-05-22 20:14:29 -0400] heph: in this case, i want to leave the file unmolested unless i send a notifies :delete, "file[/somefile", :delayed
[2012-05-22 20:14:36 -0400] bencaron: the apache service works a bit like this in the apache2 cookbook?
[2012-05-22 20:16:30 -0400] heph: looking at the file provider, it doesn't look like i can do that though =/
[2012-05-22 20:16:48 -0400] heph: maybe i should just make it an exec to 'rm' the file
[2012-05-22 20:21:27 -0400] rayrod2030: anyone get the mysql opscode cookbook working with mysql 5.5 (default) on precise?
[2012-05-22 20:22:07 -0400] rayrod2030: the ubuntu bits of that cookbook seem to only work with mysql 5.1
[2012-05-22 20:24:53 -0400] hoover_damm: rayrod2030, what bits are broken?
[2012-05-22 20:25:06 -0400] hoover_damm: I have access to a 5.5 cookbook that I can pull the template from if that helps
[2012-05-22 20:25:42 -0400] rayrod2030: hoover_damm, well it looks like an app armor issue but I see a pull request regarding that was just introduced.
[2012-05-22 20:26:04 -0400] hoover_damm: rayrod2030, ahh that dirty little spot
[2012-05-22 20:26:22 -0400] hoover_damm: I have no love for apparmor/selinux
[2012-05-22 20:26:25 -0400] rayrod2030: I didn't put much time into the issues I was seeing but I figured someone working with precise would run into it and I was on vacation all last week so didn't follow up.
[2012-05-22 20:27:07 -0400] hoover_damm: so I find the practice of apparmor/selinux to be harmful to the user
[2012-05-22 20:27:27 -0400] hoover_damm: Stack Smashing Protection in your gcc is a standard pretty much though
[2012-05-22 20:27:48 -0400] hoover_damm: I don't know when Ubuntu started including SSP but it's been awhile at least
[2012-05-22 20:27:48 -0400] geekbri: selinux would be great if it wasn't such a F'ing pain in the ass to figure out how to write a damn policy for it
[2012-05-22 20:28:04 -0400] hoover_damm: right
[2012-05-22 20:31:03 -0400] geekbri: hoover_damm: a long time ago, its been at least like... 5 years
[2012-05-22 20:31:16 -0400] hoover_damm: geekbri, it's not gotten any better
[2012-05-22 20:32:00 -0400] geekbri: My favorite part about selinux is repeatedly forgetting and rediscovering its the cause of my inability to get something to work in any RHEL based distro
[2012-05-22 20:33:57 -0400] makerbreaker: whats the best way to interact programmatically with a chef server, and store the data for access in a webapp
[2012-05-22 20:34:14 -0400] makerbreaker: is there a tutorial for rails out there?
[2012-05-22 20:37:18 -0400] [7hunderbird]: how would I use gem_package to uninstall rack and install a previous version?
[2012-05-22 20:37:40 -0400] excalq: So we're having a (probably) simple issue, where a recipe which uses github.com/opscode-cookbooks/application_ruby "Cannot find a resource for application". I suspect that we're missing a step in loading the application LWRP to be available to our recipes (we're building a rails server on 12.04 using 0.10.10)
[2012-05-22 20:38:01 -0400] [7hunderbird]: would action :remove do the trick?
[2012-05-22 20:38:03 -0400] hoover_damm: geekbri, I just rip it out
[2012-05-22 20:38:18 -0400] geekbri: hoover_damm: depends on what the server is doing, but usually i disable it as well.
[2012-05-22 20:38:23 -0400] hoover_damm: geekbri, last el5 shop I admin'd had selinux all gone everywhere
[2012-05-22 20:38:34 -0400] hoover_damm: when we went to Ubuntu the CTO raged about AppArmor
[2012-05-22 20:38:37 -0400] hoover_damm: and demanded that gone too
[2012-05-22 20:38:44 -0400] hoover_damm: overcaring is such a beautiful thing when it worked for you :)
[2012-05-22 20:39:08 -0400] geekbri: hoover_damm: my favorite time it bit me in the butt was when i was testing redis on a fedora install, and it kept failing to create the redis user i wanted.  Turned out their selinux policy on fedora disallows you to set a users home directory in the /var directory.
[2012-05-22 20:43:16 -0400] hoover_damm: ahh what an unfortunate time to realize I need to update emacs... in the middle of installing LXC
[2012-05-22 20:43:19 -0400] hoover_damm: LOL
[2012-05-22 20:53:13 -0400] oddover: Hi everyone. I'm creating a new chef infrastructure, and I was wondering if there's a current plan for making a HA chef-server?
[2012-05-22 20:54:08 -0400] oddover: ie: distributed redundancy
[2012-05-22 20:54:24 -0400] jtimberman: oddover: that can be done with open source chef server, though there aren't (m)any documented guides to do so.
[2012-05-22 20:54:46 -0400] oddover: jtimberman: how would you recommend doing it?
[2012-05-22 20:55:17 -0400] jtimberman: oddover: I work for Opscode, so my response is full of vendor bias. :)
[2012-05-22 20:55:24 -0400] oddover: lol
[2012-05-22 20:55:40 -0400] jtimberman: i know there's mailing list posts on the topic
[2012-05-22 20:55:54 -0400] oddover: are those open to the public?
[2012-05-22 20:56:28 -0400] coderanger: mailing list?
[2012-05-22 20:56:39 -0400] jtimberman: lists?
[2012-05-22 20:56:39 -0400] bawt: lists is http://lists.opscode.com
[2012-05-22 20:56:43 -0400] jtimberman: totally open
[2012-05-22 20:56:47 -0400] oddover: ah, okay
[2012-05-22 20:56:47 -0400] coderanger: there we go
[2012-05-22 20:56:49 -0400] jtimberman: not the most awesome search features.
[2012-05-22 20:56:52 -0400] oddover: gotcha
[2012-05-22 20:56:59 -0400] jtimberman: but, like, google site:lists.opscode.com :)
[2012-05-22 20:57:35 -0400] coderanger: oddover: Also the required plug: Opscode Hosted Chef and Opscode Private Chef are both HA :D
[2012-05-22 20:57:41 -0400] jtimberman: hehe
[2012-05-22 20:58:00 -0400] jtimberman: oddover: here's one thread with links to other threads that may be helpful: http://lists.opscode.com/sympa/arc/chef/2011-10/msg00071.html
[2012-05-22 20:58:06 -0400] jtimberman: looks like someone started a wiki page
[2012-05-22 20:59:38 -0400] bemu: oddover: I suggest using hosted chef. :D
[2012-05-22 21:00:18 -0400] oddover: heh. hosted chef isn't an option for us. We want to have all of our configurations in-house
[2012-05-22 21:02:37 -0400] oddover: in this one: http://lists.opscode.com/sympa/arc/chef/2011-08/msg00002.html they talk about api endpoints
[2012-05-22 21:02:40 -0400] oddover: what is that?
[2012-05-22 21:03:02 -0400] coderanger: oddover: The chef server is a collection of daemons
[2012-05-22 21:03:08 -0400] coderanger: one of which is chef-server-api
[2012-05-22 21:03:14 -0400] oddover: ok
[2012-05-22 21:03:21 -0400] coderanger: that handles the API communication with chef-client and knife
[2012-05-22 21:04:16 -0400] oddover: so can you expand that chef-server-api to multiple hosts? I don't understand
[2012-05-22 21:04:33 -0400] coderanger: It is just a webapp, so normal webapp scaling rules apply
[2012-05-22 21:04:40 -0400] coderanger: throw is behind an load balancer :)
[2012-05-22 21:05:56 -0400] behemphi: In my understanding and API endpoint is the thing you want to manipulate
[2012-05-22 21:06:05 -0400] behemphi: for instnace in the case of chef it would be a CHef Node
[2012-05-22 21:06:08 -0400] behemphi: or Client
[2012-05-22 21:06:26 -0400] coderanger: Not in that context
[2012-05-22 21:06:48 -0400] oddover: so you'd have multiple chef-server hosts, with a load balancer directing traffic to/from the nodes?
[2012-05-22 21:07:43 -0400] coderanger: That would be a starting point, depends on how far down the HA rabbit hole you are going
[2012-05-22 21:08:04 -0400] coderanger: Our usual small HA setup is 4 servers
[2012-05-22 21:08:25 -0400] coderanger: 2x running the api and webui servers, on a shared heartbeat/keepalive IP
[2012-05-22 21:08:35 -0400] coderanger: 2x running a couch/solr/rabbit cluster
[2012-05-22 21:09:13 -0400] coderanger: but setting up all that is ... not easy
[2012-05-22 21:09:37 -0400] oddover: ok. I guess that makes sense. Are there any tutorials or notes out there that discuss how to set it up?
[2012-05-22 21:10:07 -0400] coderanger: You just read 'em :D
[2012-05-22 21:10:11 -0400] oddover: lol
[2012-05-22 21:10:23 -0400] oddover: Hmm...okay, well that helps a bit
[2012-05-22 21:10:33 -0400] coderanger: Honestly though, Private Chef is exactly that, if you want it to be easy, you should really look into it
[2012-05-22 21:12:06 -0400] mattray: oddover: wiki.opscode.com/display/chef/Scalability+and+High+Availability
[2012-05-22 21:12:31 -0400] mattray: oddover: feel free to update that with
[2012-05-22 21:12:35 -0400] mattray: anything you find
[2012-05-22 21:12:44 -0400] oddover: yea, i saw that as well. I guess what I'm looking for is something that's fleshed out more, but there isn't anything
[2012-05-22 21:12:53 -0400] mattray: also, http://private-chef-docs.opscode.com/installation/ha.html
[2012-05-22 21:13:24 -0400] oddover: mattray: btw, I'm oddityoverseer13. Got logged out and changed my sn
[2012-05-22 21:13:28 -0400] mattray: hah
[2012-05-22 21:13:31 -0400] mattray: gotcha
[2012-05-22 21:13:42 -0400] mattray: marathon of calls just ended
[2012-05-22 21:13:46 -0400] oddover: haha
[2012-05-22 21:13:47 -0400] oddover: lol
[2012-05-22 21:14:02 -0400] mattray: ouch, 4 hours of calls over 5 hours
[2012-05-22 21:14:30 -0400] oddover: sounds like a busy day
[2012-05-22 21:14:54 -0400] oddover: Now I gtg for a bit lol
[2012-05-22 21:15:09 -0400] oddover: feel free to comment about my last question to you though.
[2012-05-22 21:15:44 -0400] mattray: oddover: please jog my memory, too many IRC conversations
[2012-05-22 21:23:02 -0400] makerbreaker: how can I interact with the API w/o using knife?
[2012-05-22 21:23:23 -0400] makerbreaker: or, alternatively can knife store data to a database
[2012-05-22 21:23:32 -0400] behemphi: here is where I got started
[2012-05-22 21:23:32 -0400] behemphi: http://wiki.opscode.com/display/chef/Server+API
[2012-05-22 21:23:43 -0400] behemphi: it is not complete but it got me going
[2012-05-22 21:24:03 -0400] mLewisLogic: Possibly obscure Q: How do I use chef to control multiple "versions" of the same service, on the same box. Ie, if I wanted to run multiple MongoDB instances, each with a different ports and service names. I've got no problem getting dirty in cookbooks, just not sure how this would work with attributes.
[2012-05-22 21:24:11 -0400] behemphi: @makerbreaker, what did you want to do exactly?
[2012-05-22 21:24:33 -0400] behemphi: do you want to put data in the DB on intial build (for instance)
[2012-05-22 21:25:24 -0400] makerbreaker: behemphi, I have my server setup workflow setup as I want.  I want to take a "snapshot" of the server state when it is racked
[2012-05-22 21:26:01 -0400] makerbreaker: and save it to a CMS, for our account team to use;  I also want to allow the account team to specify server settings (IP info, etc) in the CMS, and allow the server to set it self up
[2012-05-22 21:27:25 -0400] oddover: mattray: JSON attributes. I'm trying to do iptables via attributes, and I was wondering if you could tell me if this syntax would be correct for editing the attributes in the node.json file: "default_attributes": {     "rules" : ["asdfasdfi12341234"]   }
[2012-05-22 21:27:27 -0400] behemphi: So is the data you want to store the IP, etc listed above?
[2012-05-22 21:27:30 -0400] makerbreaker: behemphi, Im still trying to figure out the best way to do everything
[2012-05-22 21:27:45 -0400] behemphi: Me too makerbreaker me too!
[2012-05-22 21:28:07 -0400] behemphi: I am working on a bit of orchestration myself, thus knwo about about the API doc
[2012-05-22 21:28:10 -0400] makerbreaker: I am using the webui as an easy interface to keep track of the curernt server state;  now i need something seperate to keep track of what it "should be"
[2012-05-22 21:28:51 -0400] behemphi: What I will point out directly is this:  If you use knife, then your script is not very robust b/c you have to drop out of the language you are writing in and to the command line.  So in my case I decided to poke the API
[2012-05-22 21:29:01 -0400] mattray: makerbreaker: whatever's in version control is what "it should be" :)
[2012-05-22 21:29:12 -0400] mattray: makerbreaker: perhaps Spice or PyChef?
[2012-05-22 21:29:17 -0400] mattray: API libraries for Chef?
[2012-05-22 21:29:49 -0400] mattray: jclouds has stuff for Java I believe
[2012-05-22 21:30:19 -0400] mattray: oddover: I don't think editing the node.json is going to do anything after the first run
[2012-05-22 21:30:20 -0400] makerbreaker: ya, hehe...matttray but things change
[2012-05-22 21:30:26 -0400] behemphi: But Matt is spot on in that server state is what is in version contol (i.e. the server is the code)
[2012-05-22 21:30:28 -0400] mattray: makerbreaker: which language?
[2012-05-22 21:30:45 -0400] mattray: Spice is ruby
[2012-05-22 21:30:47 -0400] oddover: mattray: why? and I don't even see changes on the first run
[2012-05-22 21:30:48 -0400] makerbreaker: the problem is, what should have been deployed, isnt always whats deployed
[2012-05-22 21:30:57 -0400] behemphi: So makerbreaker, I went down the image path for a bit, but ended up simply building new instances of our product direclty from the recipes.
[2012-05-22 21:30:58 -0400] makerbreaker: planning on using a rails app
[2012-05-22 21:31:23 -0400] mattray: makerbreaker: https://github.com/danryan/spice
[2012-05-22 21:31:39 -0400] makerbreaker: behemphi, I eventually will be using recipes, but for now its an image
[2012-05-22 21:32:04 -0400] mattray: makerbreaker: that'll let you work with the Chef Server API from Rails
[2012-05-22 21:32:04 -0400] makerbreaker: ah, perfect thanks mattray
[2012-05-22 21:32:46 -0400] mattray: oddover: there's a firstrun.json that gets used on a bootstrap, perhaps a customized version of that?
[2012-05-22 21:33:08 -0400] mLewisLogic: So, I'm thinking that achieving different services will always require different cookbooks, even if they're largely identical (but with minor differentiating attributes)?
[2012-05-22 21:33:13 -0400] oddover: mattray: How do you change attributes on the node, then? (btw: I'm using chef solo atm)
[2012-05-22 21:33:31 -0400] mLewisLogic: Actually, any way to call a cookbook/recipe with specific attributes (rather than reconciled attributes)?
[2012-05-22 21:34:14 -0400] mattray: oddover: oh, chef-solo.
[2012-05-22 21:35:13 -0400] mattray: oddover: http://wiki.opscode.com/display/chef/Chef+Solo#ChefSolo-JSON%2CAttributesandRecipes
[2012-05-22 21:35:35 -0400] mattray: mLewisLogic: http://wiki.opscode.com/display/chef/Attributes#Attributes-Precedence
[2012-05-22 21:35:55 -0400] oddover: mattray: seen that. I can't get the attributes to merge with the ones in the cookbook data
[2012-05-22 21:35:59 -0400] mattray: mLewisLogic: ovverride as necessary
[2012-05-22 21:37:31 -0400] mattray: oddover: have you tried override_attributes?
[2012-05-22 21:37:46 -0400] mLewisLogic: @mattray thanks. Think that helped me sort my head
[2012-05-22 21:38:16 -0400] oddover: mattray: yes, but that overwrites the ones in there. I want to merge them.
[2012-05-22 21:38:51 -0400] makerbreaker: mattray, is there any good docs out there for spice?
[2012-05-22 21:39:54 -0400] mattray: makerbreaker: I don't know. I just know a number of folks use it
[2012-05-22 22:16:25 -0400] jtimberman: mattray: mine too!
[2012-05-22 22:16:33 -0400] jtimberman: (marathon of calls)
[2012-05-22 22:16:55 -0400] JasonBox: hrm, what should my init.d provide for chef's service resource?
[2012-05-22 22:23:23 -0400] miah: herp
[2012-05-22 22:39:44 -0400] dangerdave: I'd like to write some 'helper' ruby methods to be shared by a few of my cookbooks. Not definitions or LWRPs. Where do you tend to put these?
[2012-05-22 22:41:04 -0400] dangerdave: duh. libraries.
[2012-05-22 22:42:48 -0400] miah: =)
[2012-05-22 22:46:04 -0400] bip: Gaah, after having a minor (read major) dependency hell on debian which now is solved I've ended up with a chef-server-webui that gives a 500 and the log says: 401 "Unauthorized" - (Net::HTTPServerException). Seems to be missing something when doing rest request to the chef-server. Anyone know what I'm missing?
[2012-05-22 22:46:49 -0400] bip: funny enough I found someone who have a gist of the exact stacktrace: https://gist.github.com/1894477
[2012-05-22 22:47:29 -0400] miah: has anybody written a mkfs/swap provider?
[2012-05-22 22:54:29 -0400] bip: There's gotta be a pem file or something I'm missing. Any pointers where to look?
[2012-05-22 22:59:18 -0400] hoover_damm: miah, I have a crusty one
[2012-05-22 22:59:29 -0400] hoover_damm: it's horrible
[2012-05-22 23:00:18 -0400] miah: no crust!
[2012-05-22 23:00:28 -0400] miah: you wipe now!
[2012-05-22 23:01:24 -0400] hoover_damm: miah, see /query
[2012-05-22 23:01:33 -0400] hoover_damm: miah, basically crusty as heck and 100% ec2 specific
[2012-05-22 23:01:47 -0400] hoover_damm: but if you want a horrible pattern to use sfdisk, here you go
[2012-05-22 23:01:51 -0400] hoover_damm: use sfdisk and win
[2012-05-22 23:03:14 -0400] hoover_damm: crappy old chef 0.6 code usually is just that
[2012-05-22 23:04:19 -0400] miah: its definitely educational
[2012-05-22 23:36:33 -0400] miah: cough https://github.com/miah/chef-mkfs
[2012-05-22 23:37:38 -0400] setient: that is awesome miah!
[2012-05-22 23:37:46 -0400] miah: it doesnt do anything yet
[2012-05-22 23:38:09 -0400] miah: i feel like i have fleas because i'm scratching a few itches right now..
