[2012-05-03 00:00:12 -0400] hoover_damn: damn sexy though
[2012-05-03 00:10:05 -0400] dangerdave: does `knife upload cookbook ` follow symlinks in the cookbook? It would be useful for the layout of my source repos
[2012-05-03 00:10:18 -0400] dangerdave: (specifically, to have symlinks in the files.)
[2012-05-03 00:11:55 -0400] miah: hopefully you don't have crazy big files in your cookbook =)
[2012-05-03 00:11:56 -0400] coderanger: dangerdave: Probably, but why not just use multiple cookbook paths?
[2012-05-03 00:15:51 -0400] dangerdave: source code, huge module hierarchy, needs to be in multiple places on a dev machine. plausibly i can symlink the other direction, if knife doesn't like.
[2012-05-03 00:16:33 -0400] miah: can't just do a git checkout?
[2012-05-03 00:16:53 -0400] miah: personally, i do everything i can to keep cookbook size small
[2012-05-03 00:17:09 -0400] dangerdave: miah: no desire to give production servers access to git. there's lots of other stuff in there besides.
[2012-05-03 00:17:30 -0400] dangerdave: just the necessary source assets, y'know?
[2012-05-03 00:17:35 -0400] coderanger: dangerdave: You are shipping your source code as a remote_dir?
[2012-05-03 00:17:40 -0400] coderanger: That probably won't end well
[2012-05-03 00:17:43 -0400] dangerdave: coderanger: why not?
[2012-05-03 00:17:56 -0400] coderanger: Chef isn't a very good file transfer system :)
[2012-05-03 00:18:11 -0400] coderanger: Use tarballs and remote_file or something
[2012-05-03 00:18:19 -0400] coderanger: or better yet, fpm and make a dep/rpm repo
[2012-05-03 00:18:36 -0400] dangerdave: coderanger: what? it's slow? it corrupts your files? we just don't like the idea of big remote_dirs because of some unknown aesthetic criterion?
[2012-05-03 00:18:54 -0400] coderanger: It will be slow, both on transfer and it will make your chef runs slow
[2012-05-03 00:19:03 -0400] coderanger: since it will check every file every time
[2012-05-03 00:19:10 -0400] dangerdave: coderanger: ah
[2012-05-03 00:19:44 -0400] dangerdave: so you use some other technique to update your source assets?
[2012-05-03 00:20:02 -0400] dangerdave: it seems like this is exactly something chef should be good at. why have yet another way to move assets around?
[2012-05-03 00:20:08 -0400] coderanger: Either use git (which you said you can't) or build packages
[2012-05-03 00:20:21 -0400] coderanger: dangerdave: Chef isn't a file distribution system, it is a configuration system
[2012-05-03 00:20:30 -0400] dangerdave: and part of configuration is files.
[2012-05-03 00:20:31 -0400] coderanger: rsync is a great file distribution system
[2012-05-03 00:20:37 -0400] miah: it can distribute files inefficiently =)
[2012-05-03 00:20:38 -0400] dangerdave: potentially lots of files.
[2012-05-03 00:20:40 -0400] coderanger: Sure, small numbers of small text files
[2012-05-03 00:21:05 -0400] coderanger: Chef neither wants nor need to replace stuff like apt-get, rsync, scp, etc
[2012-05-03 00:21:14 -0400] miah: large files... wont be transfered very efficiently, will tie up resources, and other assorted fun
[2012-05-03 00:21:14 -0400] coderanger: Things that are actually good at moving bulk data around
[2012-05-03 00:23:09 -0400] dangerdave: bah. understood. that said, the philosophy seems bogus to me. chef is about reproducible machine states. this should include all the files on the machine. the only excuse for "it's too slow" is "we haven't gotten there yet" not "i don't believe in having overlapping tools". this is a natural place for chef to overlap with rsync et. al.
[2012-05-03 00:23:24 -0400] dangerdave: just one guy's opinion
[2012-05-03 00:23:45 -0400] miah: git is pretty good at replicating state too. thats why you can pull specific sha's
[2012-05-03 00:24:07 -0400] dangerdave: miah: understood
[2012-05-03 00:24:08 -0400] coderanger: dangerdave: Chef will, indeed, transfer all the files, it just isn't a good idea when there are better tools
[2012-05-03 00:24:29 -0400] coderanger: And no, we are never going to overlap with rsync
[2012-05-03 00:24:34 -0400] coderanger: I did that for three years :)
[2012-05-03 00:24:37 -0400] miah: rsync is hard
[2012-05-03 00:24:44 -0400] coderanger: No kidding
[2012-05-03 00:24:57 -0400] coderanger: File transfer optimization was, quite literally, my job for a long time
[2012-05-03 00:25:04 -0400] miah: ouch
[2012-05-03 00:25:35 -0400] miah: i haven't had that job.. mostly just 'put out the fires and solve all the problems' ;)
[2012-05-03 00:25:53 -0400] miah: i remember having this same discussion in #puppet years ago though
[2012-05-03 00:25:59 -0400] dangerdave: so the general idea for updating via git is: reference a know she in the cookbook, update that cookbook. yes?
[2012-05-03 00:25:59 -0400] miah: people always want to do this
[2012-05-03 00:26:21 -0400] miah: you can update an attribute without updating a cookbook
[2012-05-03 00:26:28 -0400] dangerdave: miah: right
[2012-05-03 00:26:37 -0400] dangerdave: miah: good point
[2012-05-03 00:26:41 -0400] miah: so just make that reference an attribute and update it in your role / environment
[2012-05-03 00:26:50 -0400] dangerdave: miah: got it.
[2012-05-03 00:28:58 -0400] dangerdave: thanks for setting me right, all
[2012-05-03 00:30:08 -0400] miah: if theres anything i <3 doing its telling people my opinion ;)
[2012-05-03 00:30:17 -0400] dangerdave: miah: haha, me too. that's why we're devs. ;-)
[2012-05-03 00:30:28 -0400] coderanger: miah: For whatever reason, game patchers are a land of dark voodoo
[2012-05-03 00:30:45 -0400] miah: oh im sure
[2012-05-03 00:30:50 -0400] miah: game stuff is always crazy
[2012-05-03 00:31:07 -0400] dangerdave: miah: FWIW: i suspect you've had this discussion before because it's natural. after conferring with my co-founders, they concur that it was their out-of-the-box expectation of chef too. we're all learning, so take this as beginner's mind. the "configuration is about small numbers of files" (where small numbers is left to the reader) -- well, seems a little bit like a leaky boundary to me.
[2012-05-03 00:31:29 -0400] miah: ya
[2012-05-03 00:31:36 -0400] coderanger: dangerdave: It is fuzzy and dependent entirely on your tolerance for slow chef runs :)
[2012-05-03 00:31:55 -0400] miah: right. if you are transfering lots of files and don't mind a chef execution taking minutes or possibly hours...
[2012-05-03 00:32:35 -0400] dangerdave: coderanger: haha. again, thanks -- i have a low tolerance so you've saved me pain. ;-)
[2012-05-03 00:33:02 -0400] miah: also. if you're using open source chef then cookbooks are in couchdb, so you're reliant on how well its going to send you those files
[2012-05-03 00:33:17 -0400] miah: iirc, databases suck as file stores
[2012-05-03 00:33:39 -0400] dangerdave: miah: that's a really good point.
[2012-05-03 00:33:46 -0400] coderanger: miah: No, in FOSS they are stored in the local FS
[2012-05-03 00:34:02 -0400] miah: oh?
[2012-05-03 00:34:02 -0400] bawt_: oh is that what that stupid message is
[2012-05-03 00:34:02 -0400] coderanger: metadata lives in Couch, but not actual file data
[2012-05-03 00:34:06 -0400] miah: ok
[2012-05-03 00:34:08 -0400] coderanger: bawt: forget oh
[2012-05-03 00:34:14 -0400] miah: lulz
[2012-05-03 00:34:18 -0400] miah: bawt_: i <3 you
[2012-05-03 00:34:25 -0400] coderanger: bawt_: forget oh
[2012-05-03 00:34:25 -0400] bawt_: can do!
[2012-05-03 00:34:32 -0400] coderanger: bawt_: botsnack
[2012-05-03 00:34:33 -0400] bawt_: coderanger: schweet!
[2012-05-03 00:35:03 -0400] dangerdave: coderanger: oh. okay, so files are not in couch. and we're FOSS server right now.
[2012-05-03 00:35:40 -0400] miah: well then, if you don't mind tieing up your chef server transferring tons of files have at it :P
[2012-05-03 00:36:40 -0400] coderanger: Yeah, thin might keel over
[2012-05-03 00:39:21 -0400] dangerdave: new, i'm taking sage advice and using git ;-)
[2012-05-03 00:41:18 -0400] dangerdave: thanks guys.
[2012-05-03 00:43:11 -0400] miah: sure sure
[2012-05-03 00:49:35 -0400] josephholsten: miah: any great thoughts on how the openldap cookbook might distribute certs in a sane way?
[2012-05-03 00:50:40 -0400] josephholsten: also chef_handler cb and every other thing with plugins?
[2012-05-03 00:52:37 -0400] miah: josephholsten: https://github.com/atomic-penguin/cookbook-certificate
[2012-05-03 00:53:33 -0400] miah: i'd have to look at the handler cookbook specifically. i'm not saying _dont_ transfer files via chef, but limit and be aware of what you are doing and how it could negatively impact your chef servers performance
[2012-05-03 00:53:43 -0400] josephholsten: storing "files" in data bags is so weird
[2012-05-03 00:53:54 -0400] miah: i agree
[2012-05-03 00:54:30 -0400] hoover_damn: only makes sense if you do hosted
[2012-05-03 00:54:33 -0400] hoover_damn: because then your on S3 at least
[2012-05-03 00:54:38 -0400] josephholsten: I don't care about transferring files via chef. I care about people having to push their own version of a cb just to add a plugin/cert/whathaveyou
[2012-05-03 00:54:58 -0400] miah: i am a fan of metacookbooks that wrap functionality of other cookbooks
[2012-05-03 00:55:19 -0400] miah: the problem i see with many cookbooks in use today is that they follow the same awful shell scripting procedural flow
[2012-05-03 00:55:41 -0400] hoover_damn: the problem with (keys|certificates|sensitive information) is everyone likes to operate with that data differently
[2012-05-03 00:55:44 -0400] josephholsten: I'd like most of that metacookbook stuff to get pushed into chef-client
[2012-05-03 00:55:53 -0400] miah: hoover_damn: indeed. key escrow is hard.
[2012-05-03 00:56:12 -0400] hoover_damn: and the problem truly is a lot of people that are caring... are caring about the wrong issues
[2012-05-03 00:56:29 -0400] miah: josephholsten: well the real answer is for people to write their cookbooks less poorly so that its easier to tack on functionality and fit cookbooks into random environments
[2012-05-03 00:56:32 -0400] josephholsten: I'll accept that. but distributing monitoring plugins sucks exactly the same way
[2012-05-03 00:56:51 -0400] miah: the procedural flow of most cookbooks makes too many assumptions
[2012-05-03 00:57:06 -0400] miah: i just include monitoring as part of my cookbooks
[2012-05-03 01:00:20 -0400] josephholsten: I envision a future where cbs either have just (lwrps, defns and libs) or recipes built on those. attrs templates and files make sense with both kinds.
[2012-05-03 01:01:17 -0400] josephholsten: and i dream of a day when there are no compile-time actions on resources
[2012-05-03 01:01:26 -0400] yfeldblum: dangerdave, if you want "reproducible machine states", bake and launch VM images
[2012-05-03 01:03:48 -0400] miah: thats fun in itself
[2012-05-03 01:07:44 -0400] cobragoat: so am I correct in understanding that the application cookbook has changed to the point that app data is no longer stored in data bags but now the LWRP is used?
[2012-05-03 01:13:36 -0400] yfeldblum: cobragoat, no; the cookbook no longer requires you to use a data bag for your applications per se; i think the intrinsic data bag support is deprecated and will be removed soon; however, *you can still use data bags* by making a very simple cookbook of your own that loops over the data bag items in the data bag and declares an application resource for each one
[2012-05-03 01:13:38 -0400] josephholsten: cobragoat: looks like the data bag way is still around, but deprecated
[2012-05-03 01:14:33 -0400] miah: yfeldblum: i wonder how long until somebody releases a cookbook to do exactly that
[2012-05-03 01:15:08 -0400] cobragoat: it just seems like there are two differing approaches at this point and that the approach where the data bag holds the app info is being deprecated..
[2012-05-03 01:15:17 -0400] cobragoat: try gin to get the hang of the LWRP approach
[2012-05-03 01:15:26 -0400] cobragoat: triying*
[2012-05-03 01:15:31 -0400] cobragoat: lol
[2012-05-03 01:15:36 -0400] cobragoat: TRYING*
[2012-05-03 01:16:04 -0400] josephholsten: miah: I'm holding myself back from writing that. because I would totally call the lwrps via send.
[2012-05-03 01:17:43 -0400] cobragoat: I just need to get a really good rails stack going with chef that can roll an app out as well.. from there not sure if I should use capistrano for subsequent deployments or not
[2012-05-03 01:17:52 -0400] coderanger: The recipes are around purely for backwards compat, probably will get removed Soon
[2012-05-03 01:18:43 -0400] miah: lots of different deployment tools, rundeck, capistrano, deployinator, etc..
[2012-05-03 01:19:20 -0400] cobragoat: i really don't mind cap
[2012-05-03 01:19:22 -0400] coderanger: cobragoat: heroku /troll
[2012-05-03 01:19:28 -0400] coderanger: (<3 heroku)
[2012-05-03 01:19:35 -0400] cobragoat: hehe
[2012-05-03 01:20:06 -0400] coderanger: Seriously though, try out the new LWRPs
[2012-05-03 01:20:07 -0400] cobragoat: ya.. i like having a little more access but ya it's pretty nice
[2012-05-03 01:21:00 -0400] cobragoat: and at work I need to use EC2...
[2012-05-03 01:22:56 -0400] josephholsten: coderanger: I'd love to get procfiles working with the application cb. I want my devs to have no idea their servers aren't heroku.
[2012-05-03 01:23:03 -0400] coderanger: cobragoat: https://github.com/andreacampi/application_ruby has examples in the readme
[2012-05-03 01:23:16 -0400] coderanger: josephholsten: Write a foreman subresource, done :)
[2012-05-03 01:23:30 -0400] coderanger: josephholsten: You can just throw it in a foreman cookbook even
[2012-05-03 01:23:57 -0400] josephholsten: do people actually run prod services in foreman? I know heroku doesn't.
[2012-05-03 01:24:14 -0400] yfeldblum: of course heroku doesn't
[2012-05-03 01:24:49 -0400] coderanger: josephholsten: You can have it spit out upstart scripts
[2012-05-03 01:24:50 -0400] yfeldblum: foreman provides a local 12factor application runner, compatible with heroku's distributed application runner
[2012-05-03 01:25:44 -0400] yfeldblum: they're interface-compatible, and that was the whole point
[2012-05-03 01:25:49 -0400] miah: coderanger: i hope thats sarcasm i smell
[2012-05-03 01:25:51 -0400] coderanger: (next question, does anyone use upstart in production)
[2012-05-03 01:26:00 -0400] miah: answer: HELL NO
[2012-05-03 01:26:03 -0400] coderanger: :-)
[2012-05-03 01:26:18 -0400] josephholsten: i used to ; )
[2012-05-03 01:26:25 -0400] miah: i did for about 5 minutes
[2012-05-03 01:26:55 -0400] josephholsten: I'll take runit + monit now
[2012-05-03 01:27:02 -0400] btm: I'm sure Ubuntu has caused upstart to land in production in many places.
[2012-05-03 01:27:47 -0400] josephholsten: the problem with foreman -> upstart/runit/whatever is that I can't spin up n procs that way
[2012-05-03 01:27:49 -0400] miah: btm: sadly
[2012-05-03 01:28:20 -0400] miah: josephholsten: howso?
[2012-05-03 01:28:21 -0400] josephholsten: well, without being terribly dumb.
[2012-05-03 01:28:39 -0400] miah: my battery is about to go. be online laters
[2012-05-03 01:29:31 -0400] josephholsten: wouldn't I have to have worker-1, worker-2, worker-3 scripts?
[2012-05-03 01:30:10 -0400] josephholsten: runit can't just spin up another proc from the same service dir, right?
[2012-05-03 01:32:43 -0400] hoover_damn: yfeldblum, your quite happy with foreman?
[2012-05-03 01:34:08 -0400] heph: i've set an attribute override of ['packagename']['version']='1.2.3' in my environment, but i can't figure out how to reference that from within my cookbook. i tried "v = default['packagename']['version']" to which I get the error: NameError: undefined local variable or method `default'
[2012-05-03 01:34:28 -0400] heph: am i completely misreading the docs?
[2012-05-03 01:34:39 -0400] josephholsten: heph: node['packagename']...
[2012-05-03 01:35:29 -0400] josephholsten: or less idiomatically node.packagename.version or node[:packagename][:version]
[2012-05-03 01:35:57 -0400] yfeldblum: hoover_damn, i don't use it
[2012-05-03 01:38:40 -0400] heph: josephholsten: i'm referencing packagename as a variable, array_of_packages.each do |packagename|. I'm guessing that means I can't do a node.packagename.version
[2012-05-03 01:38:43 -0400] heph: ?
[2012-05-03 01:44:28 -0400] heph: still not working. using: node.attribute?(pip) ? v = node[pip]["version"] : v = "latest". I have override_attributes of the pip: {'version': '1.2.3'} set but it always gets latest
[2012-05-03 01:46:02 -0400] josephholsten: v = node[pip_name]['version'] || 'latest'
[2012-05-03 01:46:08 -0400] josephholsten: hmm
[2012-05-03 01:46:21 -0400] josephholsten: have you played with shef yet?
[2012-05-03 01:47:11 -0400] heph: no, this looks helpful
[2012-05-03 01:49:46 -0400] heph: NoMethodError: undefined method `[]' for nil:NilClass
[2012-05-03 01:49:48 -0400] heph: =(
[2012-05-03 01:54:04 -0400] heph: the pip version i'm trying to override is for tornado. with shef -z, node["tornado"]["version"] returns the correct version
[2012-05-03 01:54:12 -0400] heph: i don't really understand what's going wrong here =/
[2012-05-03 01:54:18 -0400] heph: but shef is a good start
[2012-05-03 01:54:21 -0400] heph: thanks for the pointer
[2012-05-03 01:54:24 -0400] josephholsten: try printing node.to_h
[2012-05-03 01:58:49 -0400] heph: this is so weird... shef -z, the code works. chef-client, it doens't. rargh.
[2012-05-03 02:07:07 -0400] heph: woah. uh, maybe forget my complaining... added some debug output and the variables are being passed correctly
[2012-05-03 02:07:23 -0400] heph: but it's still installing the wrong version of the pip..
[2012-05-03 02:10:45 -0400] heph: so, pip install --upgrade something==version installs 'version' of 'something'. the python_pip chef resource action :upgrade version 'someversion' just seems to upgrade it to latest no matter what.
[2012-05-03 02:11:14 -0400] heph: *seems* to. haven't looked through the provider yet, but when i switched action :upgrade to action :install, it worked
[2012-05-03 02:18:13 -0400] bemu: heph: Are you sure you even have to pass the --upgrade option? Pretty sure that is default.
[2012-05-03 02:18:45 -0400] bemu: How many r/s are you pushing through tornado, btw?
[2012-05-03 02:18:53 -0400] bemu: I'd be interested in hearing about your experiences.
[2012-05-03 02:19:16 -0400] miah: hi
[2012-05-03 02:19:25 -0400] bemu: Hey!
[2012-05-03 02:19:32 -0400] miah: supsup bemu
[2012-05-03 02:20:21 -0400] miah: i am somewhere in seattle
[2012-05-03 02:21:06 -0400] bemu: Nice, bring back some Mighty O Donuts? :)
[2012-05-03 02:21:16 -0400] bemu: (vegan donuts)
[2012-05-03 02:21:33 -0400] josephholsten: aww, top pot is where it's at
[2012-05-03 02:21:40 -0400] miah: i guess we are in ravana<sp>
[2012-05-03 02:21:58 -0400] bemu: heph: This is the syntax I use: https://gist.github.com/ccb85f5872cdd763c4fc
[2012-05-03 02:22:14 -0400] bemu: app['python_packages'] is grabbed from a data_bag, akin to the application cookbook
[2012-05-03 02:22:44 -0400] miah: heph: i still want my dremel tool. lets meet up next week? =)
[2012-05-03 02:23:37 -0400] bemu: I'll give you $5 more than miah will for her dremel.
[2012-05-03 02:24:44 -0400] miah: im going to give him $0 since its already mine :P
[2012-05-03 02:26:01 -0400] heph: miah: yeah, when do you get back from seattle?
[2012-05-03 02:26:27 -0400] miah: sure
[2012-05-03 02:28:37 -0400] miah: setient: go entertain jessica
[2012-05-03 02:28:44 -0400] miah: ok. enough off topic
[2012-05-03 02:29:51 -0400] dangerdave: miah: ravenna -- my neighborhood. ;-)
[2012-05-03 02:30:43 -0400] miah: ah cool
[2012-05-03 02:31:01 -0400] miah: wtf is fog.io not accessible?
[2012-05-03 02:32:14 -0400] bemu: miah: works for me
[2012-05-03 02:32:30 -0400] miah: :/
[2012-05-03 02:46:29 -0400] Guest2021: I have a recipe that overrides the restart action using restart_command...the restart action is working fine on a couple servers and it isn't working on a couple others.  If I paste the actual restart command on the server, the service restarts fine.  Anyone have some ideas of what to look into?
[2012-05-03 03:43:29 -0400] sparc_: This social-coding setup on opscode.com is pretty neat
[2012-05-03 03:43:49 -0400] sparc_: Just need to find people to follow.  Already got a few coworkers registered.
[2012-05-03 04:03:49 -0400] Kwanasolis: o/
[2012-05-03 04:07:55 -0400] miah: sparc_: social-coding?
[2012-05-03 04:51:20 -0400] josephholsten: fujin: could you update the homepage of http://community.opscode.com/cookbooks/jenkins ?
[2012-05-03 05:01:16 -0400] fujin: josephholsten: done
[2012-05-03 05:01:25 -0400] fujin: josephholsten: sorry about that, meant to do it the other day but forgot
[2012-05-03 05:01:32 -0400] josephholsten: thanks!
[2012-05-03 05:15:43 -0400] BryanWB: ohai chefs!
[2012-05-03 05:21:22 -0400] Kwanasolis: o/ BryanWB
[2012-05-03 05:21:23 -0400] sparc_: 200 - OHAI
[2012-05-03 05:21:56 -0400] miah: hey BryanWB
[2012-05-03 05:21:59 -0400] miah: hows going
[2012-05-03 05:22:58 -0400] BryanWB: Kwanasolis: \o
[2012-05-03 05:23:05 -0400] BryanWB: miah: going fine, how's seattle?
[2012-05-03 05:23:26 -0400] BryanWB: miah: got some crazy qs for u on haproxy
[2012-05-03 05:23:32 -0400] miah: ok
[2012-05-03 05:23:40 -0400] miah: i am tired, and thus more derpy. but ask away =)
[2012-05-03 05:23:59 -0400] miah: seattle is alright. i have been sitting in the house we rented talking to coworkers about worky work things
[2012-05-03 05:25:13 -0400] BryanWB: here is a helper i wrote for haproxy  https://github.com/bryanwb/chef-haproxy/blob/master/libraries/haproxy.rb#L25
[2012-05-03 05:25:55 -0400] miah: nice
[2012-05-03 05:26:09 -0400] BryanWB: miah: use it like this https://gist.github.com/2583475
[2012-05-03 05:26:26 -0400] BryanWB: inside the app code, not actually for an haproxy recipe
[2012-05-03 05:26:41 -0400] miah: right
[2012-05-03 05:27:07 -0400] BryanWB: miah: then in vhost_lb.rb recipe uses this search search("node", "haproxy_backends_name:#{vhost['name']}  #{more_roles}"
[2012-05-03 05:27:28 -0400] BryanWB: so on my front-end haproxy, i find the front-ends that want to be foudn
[2012-05-03 05:27:47 -0400] BryanWB: probably a crude approximation of what ironfan does
[2012-05-03 05:29:49 -0400] miah: maybe. i've been looking at the silverware cookbook, which seems to handle much of this in ironfan. its interesting.
[2012-05-03 05:30:08 -0400] BryanWB: miah have u evar tried to use multiple config files w/ haproxy?  some mail thread seemed to say it is possible
[2012-05-03 05:30:28 -0400] BryanWB: by launching w/ 2 `-f config_file.cfg` clauses
[2012-05-03 05:30:52 -0400] miah: hrm. i haven't tried that
[2012-05-03 05:30:59 -0400] miah: but that would certainly make things easier
[2012-05-03 05:31:18 -0400] miah: managing one monolithic config file is messy
[2012-05-03 05:31:25 -0400] BryanWB: so `/usr/local/sbin/haproxy  -f /etc/haproxy/haproxy-main.cfg -f /etc/haproxy/haproxy-vhosts.cfg  -f /etc/haproxy/haproxy-db_lb.cfg `
[2012-05-03 05:31:35 -0400] miah: ya. that would be hot.
[2012-05-03 05:31:47 -0400] BryanWB: i will have to try it soon
[2012-05-03 05:32:09 -0400] miah: ya
[2012-05-03 05:33:52 -0400] BryanWB: then i will add an attribute to node['haproxy']['config_files'] = [ '/etc/haproxy/haproxy.cfg', '/etc/haproxy/haproxy-db_lb.cfg' . . . ]
[2012-05-03 05:34:54 -0400] BryanWB: miah: have managed url redirects w/ haproxy? and output to log in apache-like format? sorry am pestering u, know ur tired
[2012-05-03 05:35:57 -0400] Kwanasolis: seattle was awesome yesterday
[2012-05-03 05:36:01 -0400] Kwanasolis: protestors are dumb.
[2012-05-03 05:36:20 -0400] Kwanasolis: well, I should rephrase that, I actually agree with some of the stuff they did, but the ones who went all violent, whatever, really no point
[2012-05-03 05:37:08 -0400] Kwanasolis: can haproxy do a .d directory?
[2012-05-03 05:37:15 -0400] BryanWB: Kwanasolis: nope
[2012-05-03 05:37:27 -0400] Kwanasolis: I want partials in the template engine
[2012-05-03 05:37:32 -0400] BryanWB: +1
[2012-05-03 05:37:48 -0400] BryanWB: do frameworks like rails have partials?
[2012-05-03 05:37:53 -0400] Kwanasolis: rails does it in ten lines, I can sorta hack it into chef, but I haven't got it 100% to think about pushing
[2012-05-03 05:38:11 -0400] Kwanasolis: yeah, it's incredibly simple to do, you just have to pass a few extra values to erubis
[2012-05-03 05:42:53 -0400] miah: partials?
[2012-05-03 05:43:56 -0400] BryanWB: miah: include templates w/in your main template
[2012-05-03 05:44:08 -0400] miah: ah ok. thats waht i was thinking
[2012-05-03 05:44:42 -0400] BryanWB: miah: what u think of my proxy_me   block? good, crap, meh?
[2012-05-03 05:45:14 -0400] miah: it looks generally good
[2012-05-03 05:45:40 -0400] miah: i've been thinking about how to solve this problem for a few days but haven't started putting code where my thoughts are
[2012-05-03 05:46:06 -0400] jtimberman: BryanWB: you see the comment on the maven ticket you had
[2012-05-03 05:46:19 -0400] miah: i think the trickier part of haproxy is going to be specifying options
[2012-05-03 05:46:22 -0400] jtimberman: COOK-1197
[2012-05-03 05:46:38 -0400] BryanWB: jtimberman: umm about getting Scott Chisamore to change his name?
[2012-05-03 05:46:45 -0400] miah: lol
[2012-05-03 05:47:01 -0400] BryanWB: i have a frined named Scott Chisamore, thus my confusion w/ Seth
[2012-05-03 05:47:06 -0400] jtimberman: hahaha
[2012-05-03 05:47:12 -0400] jtimberman: thats rather amusing sir :)
[2012-05-03 05:47:18 -0400] jtimberman: its fine, we'll get it corrected.
[2012-05-03 05:47:25 -0400] jtimberman: i just made the 'ark' component
[2012-05-03 05:47:40 -0400] jtimberman: i'll ping you later today (when i've slept) about it.
[2012-05-03 05:48:16 -0400] jtimberman: cheers
[2012-05-03 05:48:32 -0400] miah: i can't imagine chisamore is a very common name
[2012-05-03 05:48:40 -0400] BryanWB: jtimberman: laterz
[2012-05-03 05:49:26 -0400] miah: BryanWB: overall these look like a good start =)
[2012-05-03 05:49:46 -0400] BryanWB: miah: kewl
[2012-05-03 05:49:54 -0400] BryanWB: tks
[2012-05-03 05:50:08 -0400] miah: you are hardcore sir
[2012-05-03 05:50:28 -0400] BryanWB: ?? hardcore? i am way soft
[2012-05-03 05:50:40 -0400] BryanWB: still trying to learn this ruby stuff
[2012-05-03 05:50:47 -0400] miah: ya
[2012-05-03 05:50:53 -0400] miah: same.
[2012-05-03 05:51:19 -0400] miah: i sometimes find taking that initial step of writing the code to be daunting. but once i start its easy.
[2012-05-03 05:51:24 -0400] miah: that initial step though.. guh.
[2012-05-03 06:00:36 -0400] josephholsten: oh poor openldap, you need so much love
[2012-05-03 06:03:05 -0400] Kwanasolis: jtimberman: what do you want for openssh defaults?
[2012-05-03 06:03:15 -0400] Kwanasolis: ahh shit he already left, damnit, I wanna close that.
[2012-05-03 06:16:48 -0400] iroller: hey chefs
[2012-05-03 06:17:09 -0400] miah: hi
[2012-05-03 06:18:20 -0400] iroller: knife exec -E 'require "benchmark"; p Benchmark.realtime { p nodes.all.size }' 132 208.9432818889618     # 132 nodes; 208 seconds. Any ideas how to investigate it? I don't see any problems with couchdb and there are no errors in chef server log
[2012-05-03 06:19:26 -0400] iroller: I'm not able to find the bottleneck
[2012-05-03 06:22:54 -0400] Kwanasolis: lroller there is a profiler gem that will profile each step
[2012-05-03 06:23:02 -0400] cobragoat: let's talk about deploy_resource
[2012-05-03 06:23:12 -0400] Kwanasolis: iroller: even.  It's a little more work to use but it might be what you need if uo really want to know
[2012-05-03 06:24:41 -0400] josephholsten: cobragoat: ?
[2012-05-03 06:25:49 -0400] iroller: hm... seeing lot of "Error: call nesting too deep!" with ltrace merb process
[2012-05-03 06:30:27 -0400] ProfFalken: BryanWB: What's a "DevOps Delicacy"? :)
[2012-05-03 06:30:30 -0400] ProfFalken: (morning btw)
[2012-05-03 06:31:04 -0400] BryanWB: ProfFalken: morning, its a catchy title ;)
[2012-05-03 06:31:14 -0400] BryanWB: ProfFalken: loved ur talk by the way
[2012-05-03 06:31:37 -0400] BryanWB: a short interview on a specific topic
[2012-05-03 06:31:53 -0400] BryanWB: my original title was "Tasty Tools" but that doesn't sound so good ;)
[2012-05-03 06:32:13 -0400] ProfFalken: BryanWB: lmao, sounds like an "Adult" feature to me... :P
[2012-05-03 06:32:26 -0400] ProfFalken: but yeah, sure I'd love to do an interview
[2012-05-03 06:32:43 -0400] BryanWB: ProfFalken: to record one?
[2012-05-03 06:32:49 -0400] BryanWB: pls that would be great
[2012-05-03 06:44:54 -0400] miah: why am i still awake?
[2012-05-03 06:45:16 -0400] ProfFalken: miah: because you haven't gone to bed yet?
[2012-05-03 06:45:17 -0400] ProfFalken: :P
[2012-05-03 06:46:02 -0400] jesserobbins: I'm still awake because I'm finishing the ChefConf schedule.
[2012-05-03 06:46:12 -0400] jesserobbins: So, you know, because I love you all.
[2012-05-03 06:46:53 -0400] miah: <3
[2012-05-03 06:47:00 -0400] BryanWB: <3 !
[2012-05-03 06:47:04 -0400] miah: ProfFalken: ya. mostly. but my coworkers are keeping me awake. its their fault!
[2012-05-03 06:47:15 -0400] ProfFalken: lol
[2012-05-03 06:47:18 -0400] miah: chefconf is going to be fun
[2012-05-03 06:47:23 -0400] jesserobbins: totally.
[2012-05-03 06:47:38 -0400] ProfFalken: America is a bit too far (esp. when you don't have a passport...)
[2012-05-03 06:47:48 -0400] jesserobbins: Ah can't help with that one.
[2012-05-03 06:48:08 -0400] ProfFalken: lol
[2012-05-03 06:48:22 -0400] miah: jesserobbins: MAKE THE WORLD SMALLER NOW PLEASE KTHXBAI
[2012-05-03 06:48:23 -0400] ProfFalken: 76 for a passport these days... Outrageous!
[2012-05-03 06:48:43 -0400] miah: i think my passport is a few hundred
[2012-05-03 06:48:43 -0400] ProfFalken: miah: good point, do we not have a knife plugin for that yet?
[2012-05-03 06:48:56 -0400] miah: hrm... maybe?
[2012-05-03 06:49:09 -0400] ProfFalken: knife world shrink
[2012-05-03 06:49:11 -0400] ProfFalken: :D
[2012-05-03 06:49:28 -0400] jesserobbins: ;-)
[2012-05-03 06:50:49 -0400] jesserobbins: BryanWB: Did Mindy get in touch with you yet about the room details?
[2012-05-03 06:51:51 -0400] BryanWB: jesserobbins: she got in touch w/ me but told me she still had to get the room info from u
[2012-05-03 06:52:09 -0400] BryanWB: i passed her my requirements
[2012-05-03 06:52:13 -0400] jesserobbins: I told her to give you whatever you aked for.  So, you know, ask for something within reason.
[2012-05-03 06:52:25 -0400] miah: presidential suite
[2012-05-03 06:52:32 -0400] BryanWB: jesserobbins: ok :) i tried too
[2012-05-03 06:52:53 -0400] jesserobbins: miah: ;-)
[2012-05-03 06:53:36 -0400] miah: you said within reason..
[2012-05-03 06:56:40 -0400] ProfFalken: biab
[2012-05-03 07:00:31 -0400] jesserobbins: miah: sadly the presidential suite at that hotel is not as awesome as the chairmans suite where we do velocity.
[2012-05-03 07:00:33 -0400] josephholsten: is there a way to check the logging level chef-client is being run in? I want my config-test to be super noisy if we're in debug mode
[2012-05-03 07:01:36 -0400] miah: doh
[2012-05-03 07:05:06 -0400] miah: i've helped run a small conference.. it was a pita and ya. you won't ever get that time back. =)
[2012-05-03 07:05:11 -0400] jesserobbins: the good news is that we basically own the whole hotel.  Which makes me happy.
[2012-05-03 07:05:15 -0400] miah: yay
[2012-05-03 07:05:30 -0400] jesserobbins: which conference?
[2012-05-03 07:06:55 -0400] miah: nobody here has ever heard of it =) it was a small conference in malden, ma. held at a bowling alley.
[2012-05-03 07:07:03 -0400] miah: MALEDENCON FTW
[2012-05-03 07:07:14 -0400] senthilr: male-dencon
[2012-05-03 07:07:35 -0400] miah: i misspelled. its maldencon
[2012-05-03 07:07:42 -0400] miah: but male-den-con might be fun too
[2012-05-03 07:07:44 -0400] jesserobbins: josephholsten: https://github.com/opscode/mixlib-log
[2012-05-03 07:09:44 -0400] josephholsten: compared to editing an ietf standard for a uri scheme, helping organize red dirt ruby conf was a blast
[2012-05-03 07:10:08 -0400] miah: lol
[2012-05-03 07:10:30 -0400] josephholsten: I'll gladly help with any conf so long as I never have to herd those cats again
[2012-05-03 07:10:55 -0400] miah: i love cats
[2012-05-03 07:11:12 -0400] jesserobbins: josephholsten: wow.
[2012-05-03 07:11:28 -0400] josephholsten: of course, I'm still on half the USA ruby meetup groups because I was in charge of marketing
[2012-05-03 07:11:45 -0400] jesserobbins: miah: are you from east coast?
[2012-05-03 07:11:51 -0400] miah: i am from michigan originally
[2012-05-03 07:11:59 -0400] miah: but i've lived in MA, FL, TX, and CA
[2012-05-03 07:12:28 -0400] miah: awesome
[2012-05-03 07:12:55 -0400] miah: my exwife is from everret, ma. so i ended up living there for some time. texas was a mistake but working for a ponzi scheme was interesting.
[2012-05-03 07:12:55 -0400] jesserobbins: well, probably originally from space.  But we don't talk about.
[2012-05-03 07:14:31 -0400] josephholsten: can you become a legal citizen of the internet yet?
[2012-05-03 07:14:40 -0400] miah: i wish
[2012-05-03 07:14:43 -0400] jesserobbins: Everett == Revere == Lynn IMHO.
[2012-05-03 07:15:03 -0400] miah: ya
[2012-05-03 07:15:40 -0400] jesserobbins: josephholsten: Sadly, it probably means having a facebook passport.
[2012-05-03 07:17:35 -0400] josephholsten: I imagine you'll eventually be forbidden dual citizenship of g+ and fb
[2012-05-03 07:18:17 -0400] josephholsten: oh good, I'll just use this: http://community.opscode.com/cookbooks/diaspora
[2012-05-03 07:19:39 -0400] miah: oh right i have one of those accounts
[2012-05-03 07:20:41 -0400] miah: i think diaspora is less of a ghosttown than g+. but i have absolutely no idea who any of these people are.. compared to g+
[2012-05-03 07:37:44 -0400] josephholsten: openldap cb is so broken
[2012-05-03 07:38:49 -0400] josephholsten: I can't wait to see the patch it takes to have it work out of the box
[2012-05-03 08:31:05 -0400] goolala: hi, i can use && in only_if? like "only_if { "test -f /etc/passwd" && "test -f /etc/group" }
[2012-05-03 08:36:06 -0400] andreacampi: yes, but not a block since it's a shell script you're running
[2012-05-03 08:36:20 -0400] andreacampi: only_if "test -f /etc/passwd -a -f /etc/group"
[2012-05-03 08:36:35 -0400] andreacampi: -a is more portable than &&, which is a bashism
[2012-05-03 08:36:52 -0400] goolala: oh ic, thanks
[2012-05-03 08:37:18 -0400] Mithrandir: andreacampi: uh, what?
[2012-05-03 08:37:28 -0400] Mithrandir: -a is an XSI-sm, && is POSIX sh
[2012-05-03 08:38:08 -0400] andreacampi: is it?
[2012-05-03 08:38:19 -0400] Mithrandir: && is just normal chaining of commands
[2012-05-03 08:39:35 -0400] andreacampi: oh, right
[2012-05-03 08:39:44 -0400] andreacampi: I meant in the context of /bin/test
[2012-05-03 08:39:54 -0400] Mithrandir: test(1) doesn't interpret &&
[2012-05-03 08:40:01 -0400] andreacampi: of course for normal chaining, && is kosher
[2012-05-03 08:40:33 -0400] Mithrandir: test -f /some/file && -f /some/other/file doesn't work, you'd need test -f /some/file && test -f /some/other/file
[2012-05-03 08:41:28 -0400] andreacampi: ok, I must be confused then :)
[2012-05-03 08:41:58 -0400] andreacampi: my point is, in this case test -f /etc/passwd -a -f /etc/group is best
[2012-05-03 08:42:18 -0400] goolala: only_if do
[2012-05-03 08:42:18 -0400] goolala: File.exists?("/etc/passwd") && File.exists?("/etc/group")
[2012-05-03 08:42:18 -0400] goolala: end
[2012-05-03 08:42:18 -0400] goolala: I think this should do it
[2012-05-03 08:42:51 -0400] andreacampi: goolala: totally. it's just a bit more verbose. up to you which style you prefer
[2012-05-03 08:44:39 -0400] andreacampi: oh now I remember! I was thinking of '=' vs '-eq' and so on!
[2012-05-03 08:44:55 -0400] andreacampi: *blush* :D
[2012-05-03 08:45:36 -0400] goolala: thanks
[2012-05-03 08:45:57 -0400] andreacampi: sure. sorry for the confusion :D
[2012-05-03 08:46:49 -0400] andreacampi: is there any way of forking a github repo with an empty master branch?
[2012-05-03 08:56:16 -0400] ranjibd: im getting ami not found under vpc
[2012-05-03 08:56:34 -0400] ranjibd: any one tried `knife ec2 server create ` with vpc?
[2012-05-03 09:22:23 -0400] RJ2: second time this has happened to me now, neither of my two chef nodes have valid keys anymore: "401 Unauthorized: Failed to authenticate. Ensure that your client key is valid."
[2012-05-03 09:22:45 -0400] RJ2: knife node show on the chefserver still knows about the nodes and their run lists, so presumably couchdb is still fine
[2012-05-03 09:23:12 -0400] RJ2: what can cause that?
[2012-05-03 09:27:23 -0400] sdog: Looking for speakers on Chef and Drupal ..
[2012-05-03 09:28:55 -0400] RJ2: i haven't changed node names, or messed with the certs, or anything, since i had the same issue (and fixed by recreating the keys and readding clients) on April-30
[2012-05-03 09:29:24 -0400] RJ2: in fact i've not ran a chef related command since then
[2012-05-03 09:36:18 -0400] zts: RJ2: to be thorough, "knife client list" also has the right things in it?
[2012-05-03 09:36:42 -0400] RJ2: zts: yes it still contails the two new client names i created on apr-30
[2012-05-03 09:37:05 -0400] zts: RJ2: what platform, and how was chef installed?  (packages/gems/etc)
[2012-05-03 09:37:23 -0400] RJ2: ubuntu 11.10, from packages, 0.10.8
[2012-05-03 09:39:09 -0400] RJ2: the /etc/chef/validation.pem has the lastmodified time of april-30, so that's still there
[2012-05-03 09:39:22 -0400] RJ2: what files are needed to auth the clients? i could check on them
[2012-05-03 09:39:50 -0400] RJ2: the client/server logs just show it used to work, then it started returning auth errors
[2012-05-03 09:40:05 -0400] RJ2: couch log looks sane too
[2012-05-03 09:40:08 -0400] zts: on the client, /etc/chef/client.pem typically has the private key - the public key is in the 'client' record in couchdb
[2012-05-03 09:40:37 -0400] zts: FWIW, validation.pem is only used during initial registration of the client
[2012-05-03 09:40:49 -0400] RJ2: client.pem last modified apr-12
[2012-05-03 09:41:52 -0400] zts: hm, that sounds odd if it was re-registered on apr 30?
[2012-05-03 09:42:16 -0400] zts: you might also check whether your /etc/chef/client.rb has client_key pointing to something else
[2012-05-03 09:42:55 -0400] zts: (/etc/chef/client.pem is just the default)
[2012-05-03 09:43:12 -0400] RJ2: hmm, my knife config points to a client key under my home dir, but the /etc/chef/client.rb doesnt specify
[2012-05-03 09:43:27 -0400] RJ2: so the knife key is correct, but chef-client uses the one made on apr-12?
[2012-05-03 09:43:41 -0400] iroller: `knife node search "*:*"` tooks only 5-6 seconds whe running on chef-server and about 90 seconds from my local machine, wtf :/ looks like 512Kbit/s channel is too slow for chef/knife to work fast
[2012-05-03 09:44:34 -0400] RJ2: ~/.chef/knife.rb has client_key to ~/.chef/<correct-clientname>.pem
[2012-05-03 09:44:56 -0400] zts: RJ2: a bit of explanation - you'll have a client key, which is used when you're hitting the chef server with knife.  The node itself will have its own client key, which it uses when hitting the chef server
[2012-05-03 09:44:56 -0400] RJ2: and since knife works, that presumably matches the public_key field in couch
[2012-05-03 09:45:26 -0400] zts: RJ2: typically, the node will have a client name matching its node name, and it will be a "regular" client.  Your key will be an "admin" client, which lets you manage databags and cookbooks and the like
[2012-05-03 09:45:46 -0400] zts: it's certainly interesting that some keys are still okay
[2012-05-03 09:46:16 -0400] zts: given that your validation.pem has the expected timestamp on it, I'd guess that you'll still be able to use that to register clients too
[2012-05-03 09:46:36 -0400] zts: could anything have happened to restore the /etc/chef/client.pem's from before they were re-registered on the 30th?
[2012-05-03 09:47:49 -0400] RJ2: hm, it's possible i didn't run chef-client on this machine after "fixing" my keys on the 30th, i thought that since knife worked, chef-client would doo
[2012-05-03 09:47:51 -0400] RJ2: *too
[2012-05-03 09:48:01 -0400] RJ2: but from your explanation, i know they are different keys now
[2012-05-03 09:49:43 -0400] zts: You'll be able to confirm exactly when things started/stopped working by looking at /var/log/chef/server.log on your Chef server - the 'Failed to authenticate' message gets logged there too
[2012-05-03 09:51:05 -0400] zts: RJ2: if you haven't seen it, this is worth a read - http://wiki.opscode.com/display/chef/Authentication+and+Authorization
[2012-05-03 09:52:21 -0400] RJ2: oh i hadn't seen that, very handy thanks. been digging around the wiki, but missed that so far
[2012-05-03 09:53:48 -0400] RJ2: zts: since validation.pem exists in /etc/chef, and was modified apr-30, if i delete the apr-12 client.pem, would a replacement be automatically regenerated from the validation.pem?
[2012-05-03 09:54:09 -0400] RJ2: that should fix it if i understand what's going on
[2012-05-03 09:55:52 -0400] RJ2: http://wiki.opscode.com/display/chef/Common+Errors seems to agree, i'll give that a try
[2012-05-03 09:56:19 -0400] zts: correct
[2012-05-03 09:56:39 -0400] zts: oh, actually you might need to delete the client - "knife client delete <nodename>"
[2012-05-03 09:56:55 -0400] zts: (but I can't remember for sure)
[2012-05-03 09:57:08 -0400] zts: note that you would just need to delete the client, not the node, so you won't lose your run list
[2012-05-03 10:01:56 -0400] RJ2: yep that did the trick, thanks - i understand what's going on better now
[2012-05-03 10:11:07 -0400] fish_: is there a way to make chef more verbose without changing the recipes and adding log statements? something like bash's set -x
[2012-05-03 10:13:30 -0400] fish_: would be cool if I could tell chef to log code/bash output
[2012-05-03 10:18:01 -0400] fish_: never mind, chef-client -l is what I looked for
[2012-05-03 10:25:08 -0400] agentgonzo: Hi all
[2012-05-03 10:25:30 -0400] agentgonzo: Anyone on here use ironfan for cluster management who can answer me a short question?
[2012-05-03 10:26:49 -0400] agentgonzo: Is it possible to have a facet using a different image/backing than the main cluster definition? I've tried adding 'image_name' and 'backing' to the facet definition but get "undefined method" errors for those lines
[2012-05-03 10:47:16 -0400] Jean: What's the best way to define a global variable which can be used in all chef recipes?
[2012-05-03 10:48:14 -0400] BryanWB: Jean: i do that in a roles/base.rb   that I apply to all my nodes
[2012-05-03 10:53:40 -0400] Jean: right, like here? http://wiki.opscode.com/display/chef/Chef+Solo#ChefSolo-Roles . But how would I access this in the recipe?
[2012-05-03 11:00:38 -0400] BryanWB: Jean     inside roles/base.rb,    default_attributes( :foo => 'bar' )
[2012-05-03 11:00:55 -0400] BryanWB: put it on nodes run_list, then access it via  node['foo']
[2012-05-03 11:01:37 -0400] BryanWB: Jean, here are my tips for getting started w/ chef http://devopsanywhere.blogspot.it/2011/10/month-with-chef.html
[2012-05-03 11:19:33 -0400] integer: could chef stop service on N nodes, to have update on node X?
[2012-05-03 11:20:11 -0400] integer: for example to have update of DB, tomcat should be stoped on tomcat servers
[2012-05-03 11:23:10 -0400] tomoj: that is beyond the scope of chef, you need some orchestration system that would update the necessary state (data bags or node attributes or whatever) and trigger chef runs at the appropriate times (if necessary)
[2012-05-03 11:33:26 -0400] integer: tomoj: it cause big delays
[2012-05-03 11:33:54 -0400] BryanWB: integer: u could do it w/ a knife script
[2012-05-03 11:34:05 -0400] tomoj: well, you don't have to trigger chef runs, you can interact with the coordination service inside the chef run too
[2012-05-03 11:34:24 -0400] BryanWB: integer: but it will not scale for 100s of nodes, that is beyond scope of chef
[2012-05-03 11:35:39 -0400] integer: so better got node addresses with knife and do db update with manual script?
[2012-05-03 11:36:04 -0400] integer: what stop services on nodes, do update and run again
[2012-05-03 11:40:51 -0400] rgsteele: Sometime over the last day or two, I've started getting this the first time I 'vagrant up' a host: ERROR: Chef::Exceptions::PrivateKeyMissing:I cannot read /etc/chef/validation.pem, which you told me to use to sign requests!
[2012-05-03 11:41:00 -0400] rgsteele: I can fix it by vagrant ssh'ing to the host and running chef-client again manually, but I never used to get this error & I'm wondering what could've changed.  Anybody run into this before and know of a cause/solution?
[2012-05-03 11:41:20 -0400] rgsteele: (This is not chef-solo, btw)
[2012-05-03 11:46:41 -0400] integer: BryanWB: scope, hm...
[2012-05-03 11:47:17 -0400] integer: so chef could do only single node configurations?
[2012-05-03 11:47:29 -0400] integer: without external rules
[2012-05-03 11:47:42 -0400] integer: looks like it's architecture
[2012-05-03 11:52:31 -0400] integer: :'(
[2012-05-03 11:53:56 -0400] BryanWB: integer: check out ironfan on github
[2012-05-03 11:54:01 -0400] Mithrandir: integer: you might want to look at noah or zookeeper which you can plug into chef
[2012-05-03 11:54:11 -0400] Mithrandir: that gives you inter-node synchronisation
[2012-05-03 11:57:54 -0400] integer: i do some reasearch to use or not chef, it can delete, install, configure the concrete software, but can't update the whole server (ie yum update)?
[2012-05-03 11:58:16 -0400] Mithrandir: it can run any command you want.
[2012-05-03 12:02:34 -0400] integer: does somebody is using chef for full system update on rpm based server?
[2012-05-03 12:02:41 -0400] integer: any sucess story :)
[2012-05-03 12:04:27 -0400] BryanWB: integer: e-mail the chef ml, i think u will get many responses there
[2012-05-03 12:05:06 -0400] integer: oh, yes, ml :)
[2012-05-03 12:05:12 -0400] integer: nice idea, thanks
[2012-05-03 12:14:02 -0400] BryanWB: integer: sorry, but ml is very active while irc not so much
[2012-05-03 12:14:30 -0400] integer: i understand
[2012-05-03 12:40:23 -0400] andreacampi: Mithrandir: bringing the more Chef-specific part of the discussion here :)
[2012-05-03 12:40:41 -0400] andreacampi: you know I'm working on the application cookbook right?
[2012-05-03 12:41:52 -0400] andreacampi: I would love to be able to declare with the new DSL that an app is fronted by Varnish
[2012-05-03 12:42:26 -0400] andreacampi: like we do for nginx here https://github.com/coderanger/djangocon2011/blob/master/cookbooks/packaginator/recipes/default.rb
[2012-05-03 12:43:00 -0400] Mithrandir: andreacampi: no, I didn't know.
[2012-05-03 12:43:05 -0400] Mithrandir: but let me look
[2012-05-03 12:43:55 -0400] Mithrandir: generating the vcl itself is really easy enough, just put "include '/some/file.vcl'" in there.
[2012-05-03 12:44:57 -0400] andreacampi: yeah, it's just that having to generate all the includes is unpleasant
[2012-05-03 12:45:35 -0400] Mithrandir: mhm.. might be easier to implement {! !} in fact.
[2012-05-03 12:45:46 -0400] andreacampi: include_dir /etc/varnish.d would be nice
[2012-05-03 12:46:19 -0400] andreacampi: implementing it in inline VCL wouldn't be hard per se, just verbose
[2012-05-03 12:46:56 -0400] andreacampi: include '/etc/varnish.d/*.vcl' would probably be better than include_dir, actually
[2012-05-03 12:47:03 -0400] Mithrandir: you can't do it in inline vcl.  Well, "can't", you'd need to do some very, very crazy stuff.
[2012-05-03 12:47:24 -0400] andreacampi: :)
[2012-05-03 12:47:34 -0400] andreacampi: vmod's can't do it either, right?
[2012-05-03 12:47:53 -0400] Mithrandir: no, you need something that's evaled at compile time.
[2012-05-03 12:48:10 -0400] Mithrandir: so I imagine you might be able to using some gcc-specific pragma or some shit, but ewwwwww
[2012-05-03 12:48:21 -0400] andreacampi: yeah
[2012-05-03 12:48:24 -0400] andreacampi: oh yeah :D
[2012-05-03 12:49:27 -0400] Mithrandir: we'd want to sort the list of includes when doing include *.vcl, then
[2012-05-03 12:49:51 -0400] andreacampi: sure
[2012-05-03 12:50:40 -0400] andreacampi: Apache is the benchmark I guess
[2012-05-03 12:50:56 -0400] andreacampi: and people are used to doing 000-first-virtual-host.vcl
[2012-05-03 12:50:59 -0400] andreacampi: :)
[2012-05-03 12:51:03 -0400] Mithrandir: yeah
[2012-05-03 12:51:47 -0400] andreacampi: the only limitation of this solution, overall, is that each of the includes will have to have their own conditionals
[2012-05-03 12:52:10 -0400] andreacampi: but that's ok I guess
[2012-05-03 12:52:14 -0400] BryanWB: andreacampi: here is my code for an app to tell the front-end webserver that it wants to be proxied https://gist.github.com/2583475
[2012-05-03 12:52:35 -0400] andreacampi: yeah, I saw that :)
[2012-05-03 12:52:44 -0400] BryanWB: andreacampi: what do u think?
[2012-05-03 12:53:00 -0400] BryanWB: then i use a databag to define the virtual host
[2012-05-03 12:53:33 -0400] andreacampi: not enough for what I need with Varnish, I will often need to further configure per-app
[2012-05-03 12:53:47 -0400] andreacampi: stuff like TTL per URL prefix and so on
[2012-05-03 12:53:56 -0400] BryanWB: sure, this is meant for haproxy, am sure varnish needs more
[2012-05-03 12:53:57 -0400] andreacampi: other than that, sure
[2012-05-03 12:54:10 -0400] andreacampi: pretty similar to application_nginx in fact
[2012-05-03 14:21:49 -0400] sagar: Hi, can we use chef to provision a OS on baremetal ?
[2012-05-03 14:27:07 -0400] ProfFalken: sagar: IME, provision the OS elsewhere (cobbler etc) and let Chef take over
[2012-05-03 14:27:35 -0400] ProfFalken: sagar: I believe it is possible, but I don't think it's recommended to use Chef to provision bare metal...
[2012-05-03 14:28:15 -0400] sagar: Proffalken: I was reading this http://wiki.opscode.com/pages/viewpage.action?pageId=7274862
[2012-05-03 14:28:36 -0400] sagar: here it is mentioned "In the case of bare-metal, Chef integrates with things like Kickstart for Linux, Jumpstart for Solaris or NIM for AIX."
[2012-05-03 14:28:49 -0400] Glace: Hi Guygs, I need to add something like this in my network interfaces:  post-up route add -net 172.16.11.0 netmask 255.255.255.0 gateway 10.150.1.1    .. is this possible with databags?
[2012-05-03 14:29:51 -0400] sagar: ProfFalken:Can you please let me know more about it
[2012-05-03 14:33:28 -0400] ProfFalken: sagar: sorry, was re-reading the page
[2012-05-03 14:33:44 -0400] sagar: ok
[2012-05-03 14:33:56 -0400] ProfFalken: so basically, you'd use something like Cobbler or another PXE-boot system to build the basic OS including Chef
[2012-05-03 14:34:05 -0400] ProfFalken: the node would then run chef and bring it up to speed
[2012-05-03 14:34:53 -0400] ProfFalken: I've not used chef with cobbler so I cna't give you an axample of how you would marry the two together, however I'm sure some of the opscode guys will have advice on it for you
[2012-05-03 14:35:02 -0400] ProfFalken: (and many others in this channel! :) )
[2012-05-03 14:36:45 -0400] sagar: ok, thanks
[2012-05-03 14:42:35 -0400] Glace: please.. anyone..? :) Can I add routing commands to databags? like post-up route add?
[2012-05-03 14:45:22 -0400] geekbri: I'm not sure I even understand the question Glace.  You can add anything to a data_bag. they are just holders for data.
[2012-05-03 14:48:28 -0400] yfeldblum: Glace, data bags are for data, not commands - commands go in cookbooks
[2012-05-03 14:49:13 -0400] Glace: yfeldblum: well thats actually a data in my /etc/network/interfaces
[2012-05-03 14:49:17 -0400] Glace: config file
[2012-05-03 14:49:49 -0400] yfeldblum: Glace, templates for config files are in cookbooks
[2012-05-03 14:51:17 -0400] Glace: I know this.. but my question was.. databags.. supports bonding.. gateways.. etc.. I just wanted to know if it supports post-up route
[2012-05-03 14:52:36 -0400] geekbri: A databag is just like a JSON hash with information in it.
[2012-05-03 14:52:46 -0400] Glace: geekbri: ok thanks
[2012-05-03 14:53:55 -0400] yfeldblum: data bag = mysql table; data bag item = one row in mysql table; stick anything you like in there
[2012-05-03 14:54:10 -0400] geekbri: there ya go, thats a good analogy
[2012-05-03 14:54:44 -0400] Glace: ok thanks a lot guys
[2012-05-03 14:56:06 -0400] lflux_: whatever the recipe does with the information in the data bag is up to it
[2012-05-03 15:08:55 -0400] andreacampi: anybody tried the 10.10 RC? with debug logging?
[2012-05-03 15:14:58 -0400] cg1: andreacampi: yes, i have
[2012-05-03 15:15:43 -0400] andreacampi: I'm getting a lot of "Platform ... not found, using all defaults. (Unsupported platform?)"
[2012-05-03 15:16:03 -0400] andreacampi: looking at code, it looks like it's totally expected
[2012-05-03 15:16:17 -0400] cg1: i'm seeing similar things
[2012-05-03 15:16:23 -0400] andreacampi: Chef::Resource::PlatformMap
[2012-05-03 15:17:03 -0400] andreacampi: ok, good
[2012-05-03 15:17:10 -0400] andreacampi: just wanted to check :)
[2012-05-03 15:17:18 -0400] cg1: that seems to be related to ohai changes
[2012-05-03 15:17:40 -0400] cg1: with its  new family feature?
[2012-05-03 15:19:19 -0400] andreacampi: looks more related to the Windows support
[2012-05-03 15:19:31 -0400] cg1: ah ok
[2012-05-03 15:27:18 -0400] geekbri: Is there a way to delete the client certificate from the chef server when you do a knife node delete?
[2012-05-03 15:28:39 -0400] flashmanbahadur: knife client delete
[2012-05-03 15:30:50 -0400] bkocik: Is there any way to append to an attribute across multiple roles? Like, roleA has attribute x => {:foo => :bar} and roleB adds to attribute x => {:biff => :baz} so that at the end x => {:foo => :bar, :biff => :baz}?
[2012-05-03 15:30:56 -0400] geekbri: thanks, thats pretty straightforward
[2012-05-03 15:31:04 -0400] bkocik: I've looked into the deep merge stuff and it doesn't really address this.
[2012-05-03 15:31:32 -0400] bkocik: Well, it does, but it looks like roleB can only overwrite attribute x, not add to it.
[2012-05-03 15:32:13 -0400] geekbri: if you use an array i think it will automatically append it to the array
[2012-05-03 15:34:08 -0400] bkocik: ooh - that would be cool. I'll test that.
[2012-05-03 15:34:10 -0400] bkocik: Thanks
[2012-05-03 15:38:57 -0400] aslan: hi all... i have the following block. https://gist.github.com/2586581 I was wondering if there is any way that i can add a bash "sleep 1" to it
[2012-05-03 15:39:13 -0400] flashmanbahadur: i have a hack for it
[2012-05-03 15:39:16 -0400] flashmanbahadur: add an only_if
[2012-05-03 15:39:28 -0400] flashmanbahadur: inside the only_if have "sleep 1"
[2012-05-03 15:39:33 -0400] flashmanbahadur: every time the command runs
[2012-05-03 15:39:39 -0400] flashmanbahadur: it will do the check first
[2012-05-03 15:39:42 -0400] flashmanbahadur: if it succeeds
[2012-05-03 15:39:44 -0400] flashmanbahadur: then it will run the block
[2012-05-03 15:40:16 -0400] aslan: in the only if should i use a script block or just have it evaluate sleep 1?
[2012-05-03 15:40:29 -0400] flashmanbahadur: by default the only_if "blah"
[2012-05-03 15:40:37 -0400] flashmanbahadur: blah will be evaluated as a shell command
[2012-05-03 15:40:57 -0400] flashmanbahadur: and it will check the return code for status
[2012-05-03 15:40:59 -0400] aslan: flashmanbahadur: thanks :) i will try that
[2012-05-03 15:41:11 -0400] flashmanbahadur: make sure you comment that
[2012-05-03 15:41:31 -0400] aslan: flashmanbahadur: can you edit the gist?
[2012-05-03 15:42:40 -0400] flashmanbahadur: https://gist.github.com/2586642
[2012-05-03 15:42:43 -0400] aslan: got it thanks
[2012-05-03 16:00:56 -0400] bkocik: Whoa - does Chef not allow an attribute to be an array (unlikely) or am I missing something obvious (likely)? I'm getting undefined method `keys' for #<Array:0x00000002a5f7b0> on line #7
[2012-05-03 16:01:33 -0400] bkocik: Line 7 is just doing this: <% @node[:monit][:processes].each do |process| %>  and @node[:monit][:processes] is an array (obviously; that's why it's erroring)
[2012-05-03 16:02:33 -0400] jtimberman: bkocik: Ruby array does not have a 'keys' method.
[2012-05-03 16:02:48 -0400] bkocik: I know - what I don't understand is why Chef is looking for one. I'm not calling it.
[2012-05-03 16:03:26 -0400] bkocik: I'm calling .each on an array in a template and for some reason this is causing Chef to tell me that there's no "keys" method.
[2012-05-03 16:07:50 -0400] bkocik: I guess I'm running into the same thing this guy did: http://lists.opscode.com/sympa/arc/chef/2010-12/msg00134.html
[2012-05-03 16:08:19 -0400] AntonZ: guys, how do i use a file resource ? for example i have this file resource https://gist.github.com/470321 - how do i stick it into a cookbook?
[2012-05-03 16:09:34 -0400] bkocik: AntonZ: http://wiki.opscode.com/display/chef/File+Distribution
[2012-05-03 16:09:50 -0400] bkocik: Not to say RTFM, just that I think that page explains it better than I could. :)
[2012-05-03 16:10:14 -0400] AntonZ: that totoally works! i'll start working on that, thank you!
[2012-05-03 16:12:25 -0400] AntonZ: well, the example you provided is to create a file, my file resource would have to be executed, as it's a ruby script that fetches a file from S3 bucket
[2012-05-03 16:14:20 -0400] miah: remote_file
[2012-05-03 16:14:22 -0400] miah: ftw.
[2012-05-03 16:15:20 -0400] bkocik: I don't think remote_file is enough if you need an S3 API key and auth info
[2012-05-03 16:15:41 -0400] AntonZ: yes, the buckwet isnt public, so id have to authenticate somehow
[2012-05-03 16:15:45 -0400] bkocik: AntonZ: It looks like that's defining a provider. This page describes how to do that in a cookbook/recipe: http://wiki.opscode.com/display/chef/Lightweight+Resources+and+Providers+%28LWRP%29#LightweightResourcesandProviders%28LWRP%29-Providers
[2012-05-03 16:16:48 -0400] jtimberman: i think someone wrote that already
[2012-05-03 16:17:07 -0400] AntonZ: someone wrote a cookbook that fetches file from s3 bucket :) ?
[2012-05-03 16:17:18 -0400] jtimberman: http://community.opscode.com/cookbooks/s3_file
[2012-05-03 16:17:27 -0400] jtimberman: to pull from a *private* bucket :)
[2012-05-03 16:17:41 -0400] jtimberman: looks pretty straightforward
[2012-05-03 16:17:46 -0400] cgriego: are there any conventions for dealing with an attribute value that you need to change based on both a node's role and environment?
[2012-05-03 16:19:16 -0400] AntonZ: well, when i download the cookbook, ihave a file inside called s3_file, if i rename it to s3_file.zip i can extract, then inside i see Pax_Header and s3_file fodlers, what is PaxHeader ?
[2012-05-03 16:22:07 -0400] bkocik: Let me try a different question: If I have an array as an attribute in a role file, is there a way within a recipe or template to get at that simple array instead of the Chef::Node::Attribute object that's wound around it?
[2012-05-03 16:25:45 -0400] erikh: so dep_selector is pretty much complete win
[2012-05-03 16:27:58 -0400] cgriego: I'm trying to figure out the best way to set an attribute which is a key to a monitoring service where we have different accounts per environment and different keys go with different classes of servers (roles). Because the accounts are different per environment, the key is unique by both role and environment.
[2012-05-03 16:32:58 -0400] AntonZ: guys, does anyone know about a good way to create amazon snapshots, for instance if i have a volume of 1TB it takes 2-3 hours to create via web interface, is there a programatic way to create snapshots of only changes lets say, and not entire volume ?
[2012-05-03 16:33:31 -0400] flashmanbahadur: AntonZ: the first snapshot will always take very long
[2012-05-03 16:33:38 -0400] flashmanbahadur: subsequent snapshots of the same volume are incremental
[2012-05-03 16:33:56 -0400] AntonZ: ah interesting, you mean the snapsho of the original volume or snapshot of a snapshot ?
[2012-05-03 16:34:07 -0400] flashmanbahadur: snapshots are always taken of a volume
[2012-05-03 16:34:13 -0400] flashmanbahadur: so
[2012-05-03 16:34:21 -0400] AntonZ: understandood :)
[2012-05-03 16:34:31 -0400] flashmanbahadur: if you make a new EBS volume from a snapshot
[2012-05-03 16:34:43 -0400] flashmanbahadur: i believe it will make a completely fresh snapshot chain, not 100% sure
[2012-05-03 16:37:47 -0400] AntonZ: very good info flash,ambahadur
[2012-05-03 16:37:53 -0400] AntonZ: thanks
[2012-05-03 16:38:14 -0400] flashmanbahadur: np
[2012-05-03 16:40:59 -0400] flashmanbahadur: AntonZ: if you need more help for AWS stuff hop over to ##aws on freenode
[2012-05-03 16:47:15 -0400] bkocik: As far as I can tell defining an attribute as an array in a role and then trying to iterate over it in a template simply doesn't work. This is frustrating.
[2012-05-03 16:53:59 -0400] bkocik: This is where I'm stuck, if anyone's dying of curiosity: https://gist.github.com/2587186
[2012-05-03 16:55:49 -0400] mostlygeek: hi, anybody familiar with the bootstrap files here? at the end of them there is a <%= start_chef %>, which is like /usr/bin/chef-client... where is that path defined?
[2012-05-03 17:22:57 -0400] masterkorp: http://pastie.org/private/c3o9idm2ygpmzckfw4uoa
[2012-05-03 17:23:09 -0400] masterkorp: Do you guys know where the extra end is ?
[2012-05-03 17:23:59 -0400] masterkorp: found it
[2012-05-03 17:38:49 -0400] Aaton: is there a way to use an encrypted data bag within default_attributes() in a role?
[2012-05-03 17:41:40 -0400] Aaton: default_attributes( :http_proxy => { :basic_auth_password => "get this from a data bag" })
[2012-05-03 17:48:17 -0400] yfeldblum: Aaton, the attributes files should never perform network requests to get data bag items
[2012-05-03 17:48:41 -0400] yfeldblum: Aaton, if you don't have a sane default for the value, don't set the default value
[2012-05-03 17:49:16 -0400] yfeldblum: Aaton, also, why would you want to save a value on the node instance in unencrypted format, which you got from an encrypted data bag - isn't the value supposed to be encrypted?
[2012-05-03 17:58:16 -0400] Aaton: yfeldblum: I'm working on a jenkins cookbook someone else wrote. The solution i have now is I just upload an alternative .htpasswd file over the one create by the jenkins cookbook
[2012-05-03 18:03:05 -0400] yfeldblum: Aaton, ok, but how does that affect attributes files & encrypted data bags?
[2012-05-03 18:13:17 -0400] terryjfundak: Hey Chefs.... Can someone help me understand how rundeck and chef are used together to there mutual benefit. In particular, there seems to be an overlap and I'm wonder what is the "right" approach when architecting IT as code with Chef being the center of the stack..... This is kinda a beginners question but an the architecture level which is not necessarily a beginner's 1,2,3 answer.... Pointer please.
[2012-05-03 18:15:12 -0400] Aaton: yfeldblum: I was just curious if it was possible, I now understand attributes should never perform network requests. thanks.
[2012-05-03 18:27:34 -0400] coderanger: terryjfundak: rundeck (or fabric, cap, etc) are orchestration tools
[2012-05-03 18:27:48 -0400] coderanger: They help coordinate chef runs and other actions on multiple servers
[2012-05-03 18:28:20 -0400] coderanger: A common example is rolling web server upgrades, so for each web server you pull it from all LBs, run chef-client to upgrade, wait for it to load, put it back in the LB, and move on
[2012-05-03 18:30:33 -0400] terryjfundak: coderange: Thanx for that..... So rundeck is pushing and pull chef and other things..... correct? Is there ever a case where chef or knife>>is driving rundeck?
[2012-05-03 18:31:00 -0400] coderanger: terryjfundak: Well they feed back into it, you would usually use your chef server to provide into to rundeck re: roles etc
[2012-05-03 18:31:08 -0400] coderanger: (or if you are using fabric, same thing)
[2012-05-03 18:32:06 -0400] terryjfundak: In the end I'm framing a picture in my head that is Cucumber driven "IT as code" with Chef being the principle constructor
[2012-05-03 18:32:39 -0400] coderanger: That is the usual goal, yes
[2012-05-03 18:33:27 -0400] terryjfundak: coderanger: Is fabric approximate equal to rundeck? You have a preference?
[2012-05-03 18:33:53 -0400] coderanger: fabric is more like capistrano, local tool instead of a service
[2012-05-03 18:35:08 -0400] coderanger: At heart they are all just scripted SSH clients though
[2012-05-03 18:36:21 -0400] terryjfundak: coderanger: Thanx.... yep scripted SSH automation tools ... more study
[2012-05-03 18:37:22 -0400] svanzoest: Hi All.. I am sure this has been asked before, but I can not find any reference. In the deploy resource, is there a way for the restart_command to trigger a service notify?
[2012-05-03 18:37:41 -0400] coderanger: svanzoest: Pass a block instead of a string
[2012-05-03 18:37:58 -0400] coderanger: You can run arbitrary code in there
[2012-05-03 18:38:19 -0400] coderanger: in your case do resources(:service => 'name').run_action(:restart) end
[2012-05-03 18:38:20 -0400] coderanger: probably
[2012-05-03 18:39:15 -0400] svanzoest: coderanger:  in the past I had tried to trigger a template, which seemed like it was not in scope for before_restart.. I will see if a service restart works. thanks
[2012-05-03 18:39:37 -0400] coderanger: svanzoest: Yeah, there are weird issues with the callbacks
[2012-05-03 18:39:50 -0400] coderanger: they run in an isolated run context, so they can't notify externally
[2012-05-03 18:39:56 -0400] coderanger: (unless you do silly things)
[2012-05-03 18:40:39 -0400] svanzoest: I ended up having duplicate code.. I was suggested to do an include_recipe and have the code in both, but include_recipe wasn't available in that context
[2012-05-03 18:41:39 -0400] svanzoest: for reference/use case: I was looking to do javascript minification in the before_restart step, before it does the current symlink swap.
[2012-05-03 18:41:49 -0400] coderanger: svanzoest: You need to pass a reference to the resource into the closure manually
[2012-05-03 18:42:32 -0400] coderanger: foo_res = resources(:type => 'name') \n before_restart do foo_res.run_action(:bar) end
[2012-05-03 18:43:07 -0400] svanzoest: hmm..okay.. I see.. I will give that a try
[2012-05-03 18:43:44 -0400] svanzoest: the foo_res would be in the deploy_revision block?
[2012-05-03 18:44:11 -0400] svanzoest: seems that way, but want to double check
[2012-05-03 18:45:31 -0400] coderanger: Sure, anywhere you can get a valid object reference
[2012-05-03 18:45:46 -0400] coderanger: The biggest problem there is the resource must be defined before the deploy resource
[2012-05-03 18:51:04 -0400] julienphalip: Hello there. I had a noob question. Is it possible to pass a shell command as the condition of an 'if' statement? If not, is it possible to save the result of a shell command into a variable so I can then do "if myvariable?" ?
[2012-05-03 18:51:29 -0400] Babar: julienphalip: you mean an only_if?
[2012-05-03 18:51:58 -0400] julienphalip: Babar: No, actually I mean a regular "if" statement, outside of a resource.
[2012-05-03 18:52:12 -0400] julienphalip: I'm trying to condition an entire block of resources together
[2012-05-03 18:53:09 -0400] Babar: then it's ruby. So of course you can do that. The time it gets evaluated is not in line with the rest, of course
[2012-05-03 18:53:43 -0400] julienphalip: Oh I see, that would be evaluated at compilation time...
[2012-05-03 18:54:05 -0400] julienphalip: Yeah, so I need to find another strategy
[2012-05-03 18:55:45 -0400] Babar: explain what you want to do... maybe just a shell resource with triggers is enough
[2012-05-03 18:55:49 -0400] julienphalip: Thanks for the tip. Ok, so in that case I had another question :)
[2012-05-03 18:55:49 -0400] Jean-: How come when I "sudo cp" a file straight from the shell it works, but if I use `execute 'sudo cp ...'` through Chef, the file never gets copied (but it doesn't error out either)?
[2012-05-03 18:56:14 -0400] julienphalip: Babar: is it possible to conditionally notify a resource from another resource
[2012-05-03 18:56:27 -0400] Babar: sudo cp? You're not running your chef-client as root?
[2012-05-03 18:57:16 -0400] Jean-: Well actually I'm using chef-solo to setup my OS X workstation, and I haven't run into any issues by not using sudo so far
[2012-05-03 18:57:25 -0400] Jean-: but no, I'm not running it as sudo
[2012-05-03 18:57:49 -0400] Babar: conditionally? No, I don't think so.
[2012-05-03 18:58:49 -0400] julienphalip: Babar: Does the notified resource systematically gets notified, even when the notifier doesn't get executed because of a not_if/only_if?
[2012-05-03 19:02:35 -0400] Jean-: Babar: Strange, seems like a ruby block with %x[sudo] works, but using a bash block with code 'sudo' doesnt
[2012-05-03 19:02:48 -0400] Babar: the resource only gets notified when the command is run, of course
[2012-05-03 19:03:10 -0400] Babar: the only_if is for the command to be run or not, it's not specific for the notify
[2012-05-03 19:06:13 -0400] flashmanbahadur: has anyone else had issues with running chef-client as a service with ubuntu 12.04?
[2012-05-03 19:06:31 -0400] flashmanbahadur: i include the include_recipe "chef-client::service"
[2012-05-03 19:06:47 -0400] flashmanbahadur: but it doesn't seem to actually work, despite claiming to have run
[2012-05-03 19:07:18 -0400] flashmanbahadur: there is a "chef-client" service registered
[2012-05-03 19:07:34 -0400] flashmanbahadur: but it does not do anything for start, restart, status etc
[2012-05-03 19:07:48 -0400] yfeldblum: julienphalip, no, one resource will only notify another resource on its notifications list if the first resource executes an action and the execution of that action marks the first resource as changed
[2012-05-03 19:08:54 -0400] flashmanbahadur: the exit code of "sudo service chef-client status/start" always comes back as 0 however
[2012-05-03 19:08:59 -0400] flashmanbahadur: so i think its an error in the init script
[2012-05-03 19:10:58 -0400] flashmanbahadur: the run levels seem to have been applied according to chkconfig
[2012-05-03 19:12:19 -0400] AntonZ: guys, i need to install xvfb, yum install xvbf does install it fine, however, if i want to do it via chef - if i do yum list xvfb it returns  No matching Packages to list, if yum cant find such package, will chef find it if i do "package xvfb" ?
[2012-05-03 19:12:33 -0400] flashmanbahadur: looks like the chef client init file is looking for chef client in /usr/bin/chef-client, if it doesn't exist there is exits with status 0 instead of 1
[2012-05-03 19:13:28 -0400] flashmanbahadur: the chef-client install location is different with ruby 1.9.3 on 12.04 it seems
[2012-05-03 19:17:34 -0400] flashmanbahadur: this line from the chef-client init script
[2012-05-03 19:17:35 -0400] flashmanbahadur: test -x $DAEMON || exit 0
[2012-05-03 19:17:39 -0400] flashmanbahadur: should probably be
[2012-05-03 19:17:40 -0400] flashmanbahadur: test -x $DAEMON || exit 1
[2012-05-03 19:21:16 -0400] geekbri: submit change, file ticket, submitp ull request!
[2012-05-03 19:21:34 -0400] AntonZ: how do i list known to system packages ? or rather known to chef packages
[2012-05-03 19:30:58 -0400] julienphalip: Babar: yfeldblum: That makes sense. Thanks for the help!
[2012-05-03 19:32:49 -0400] wilton: Hello, anyone here has experience with RVM chef bootstrap script? From my research I noticed that it needs to be a system-wide installed, but still running into issues.
[2012-05-03 19:33:23 -0400] yfeldblum: wilton, wouldn't recommend it
[2012-05-03 19:36:11 -0400] wilton: well, I want to use ruby 1.9.2 and also leverage the functionality of gemsets for my ruby project. Don't need anything conflicted with what chef is installing at bootstrap for chef-client.
[2012-05-03 19:36:29 -0400] wilton: figured RVM might be a solution to keep things clean on the server side
[2012-05-03 19:37:34 -0400] yfeldblum: wilton, you can certainly use RVM, but i wouldn't suggest using it for chef; chef can use the system ruby, and everything else can use RVM
[2012-05-03 19:39:20 -0400] wilton: yup, you are right.
[2012-05-03 19:41:16 -0400] wilton: Whish ubuntu had a 1.9.2 package for ruby. I guess I can compile ruby 1.9.2 at bootstrap and them use the chef-rvm cookbook to manage any project specific rubies. Let me give that a shot. Thanks yfeldblum.
[2012-05-03 19:41:44 -0400] yfeldblum: wilton, right
[2012-05-03 19:45:51 -0400] miah: or use the omnibus installer
[2012-05-03 19:46:41 -0400] miah: http://www.opscode.com/chef/install/
[2012-05-03 19:51:06 -0400] grantr: wilton, where i work we've been using rbenv to manage system ruby and it works nicely
[2012-05-03 19:51:29 -0400] grantr: we had to modify it a bit and package it up for debian plus package purpose-built ruby packages for it
[2012-05-03 19:51:38 -0400] grantr: but it works pretty seamlessly now
[2012-05-03 19:54:22 -0400] flashmanbahadur: wilton: ubuntu has a 1.9.3 package listed as ruby1.9
[2012-05-03 19:57:14 -0400] cobragoat: how would I go about deploying updated code from github after a server is up and the applications are configured etc.
[2012-05-03 19:57:22 -0400] cobragoat: (with chef)
[2012-05-03 19:58:24 -0400] major_majors: cobragoat: have you checked out the documentation for the deploy resource? http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-05-03 20:01:51 -0400] miah: or use a deployment tool, like rundeck, capistrano, deployinator..
[2012-05-03 20:03:38 -0400] bkocik: I'm really at my wit's end here. Is there seriously no way to iterate over an attribute that happens to be an array?
[2012-05-03 20:03:42 -0400] yfeldblum: if your chef model is PULL and your deploy model is PUSH and you're deploying with chef ... you're doing it wrong!
[2012-05-03 20:04:15 -0400] yfeldblum: bkocik, there certainly is; tell me your troubles
[2012-05-03 20:05:05 -0400] bkocik: yfeldblum: My troubles are condensed here: https://gist.github.com/2587186 :)
[2012-05-03 20:05:13 -0400] cobragoat: major_majors: yes Im trying to sort that out. Im a little new to chef.
[2012-05-03 20:05:45 -0400] bkocik: I'm actually now setting the [:monit][:processes] attribute within the recipe via a search of a data bag, but it's still an array and I still can't iterate over it.
[2012-05-03 20:06:18 -0400] hoover_damn: hrm, an array without .keys?
[2012-05-03 20:06:21 -0400] hoover_damn: how did you pull that off?
[2012-05-03 20:06:30 -0400] bkocik: Arrays don't have a keys method, only hashes do.
[2012-05-03 20:06:38 -0400] cobragoat: miah: I know the deploy resource is modeled after capistrano to some degree and I am trying to get familiar as I have used cap in the past
[2012-05-03 20:06:39 -0400] hoover_damn: right
[2012-05-03 20:06:46 -0400] hoover_damn: sounds like you have a mixture of hash/mash
[2012-05-03 20:06:53 -0400] hoover_damn: happens with node
[2012-05-03 20:06:58 -0400] hoover_damn: as node is a hash
[2012-05-03 20:07:02 -0400] yfeldblum: bkocik, ah, that's where the silly Chef::Node::Attribute implementation bites you in the ass
[2012-05-03 20:07:29 -0400] bkocik: yfeldblum: Yes - it insists on calling keys when you call .each. I haven't figured out how to get around this when what I have is an array
[2012-05-03 20:08:34 -0400] yfeldblum: bkocik, because it's not really an array; it's really a Chef::Node::Attribute, and its implementation is rather odd
[2012-05-03 20:09:09 -0400] hoover_damn: rather odd
[2012-05-03 20:09:12 -0400] hoover_damn: i love that description
[2012-05-03 20:09:34 -0400] bkocik: Yeah, I get the reasoning. I'm just not sure how to get around it. I have to be able to iterate over that array somehow...
[2012-05-03 20:09:45 -0400] bkocik: I understand the problem, I just can't find a solution. :)
[2012-05-03 20:10:03 -0400] hoover_damn: bkocik, generally when i run into attribute/mash hell
[2012-05-03 20:10:15 -0400] hoover_damn: bkocik, in the recipe i do temp_attribute=[]
[2012-05-03 20:10:21 -0400] hoover_damn: and then build the data in the recipe from th eattribute
[2012-05-03 20:10:30 -0400] hoover_damn: bkocik, then using variables( :something => something )
[2012-05-03 20:10:34 -0400] hoover_damn: to pass it to the erb template
[2012-05-03 20:10:49 -0400] hoover_damn: it's likely not the best solution
[2012-05-03 20:11:04 -0400] bkocik: Okay. In my case I'm doing node.set[:monit][:processes] = search(:resque, "groups:#{node[:monit][:resque_groups]}")
[2012-05-03 20:11:23 -0400] hoover_damn: so in the recipe you want do do the search instead
[2012-05-03 20:11:27 -0400] bkocik: What I can probably do is just stash it as a var and give it to the template.
[2012-05-03 20:11:39 -0400] hoover_damn: basically create a new array and use that
[2012-05-03 20:11:41 -0400] yfeldblum: bkocik, yeah, do that ... for everyone's sanity
[2012-05-03 20:11:42 -0400] bkocik: If it works, it's the best solution I have access to. ;)
[2012-05-03 20:11:43 -0400] hoover_damn: don't use node as the reference
[2012-05-03 20:12:06 -0400] hoover_damn: node is a mash, which is defined in chef... which can complicate your reality
[2012-05-03 20:12:13 -0400] hoover_damn: node.to_yaml for example produces tainted yaml
[2012-05-03 20:12:18 -0400] hoover_damn: that requires the chef gem to load
[2012-05-03 20:12:35 -0400] yfeldblum: hoover_damn, https://github.com/opscode/chef/blob/master/chef/lib/chef/node/attribute.rb
[2012-05-03 20:13:51 -0400] bkocik: Just so I have the syntax right, is this the way to pass the var? template "/etc/monit/monitrc", variables(:processes => processes) do....
[2012-05-03 20:14:10 -0400] bkocik: Or does that go inside the block?
[2012-05-03 20:15:01 -0400] flashmanbahadur: ok, init file issues are ticketed and pull request created for one
[2012-05-03 20:16:36 -0400] yfeldblum: bkocik, goes inside the block
[2012-05-03 20:17:06 -0400] yfeldblum: bkocik, http://wiki.opscode.com/display/chef/Resources#Resources-Template
[2012-05-03 20:17:37 -0400] bkocik: Ahh, thank you
[2012-05-03 20:29:17 -0400] bkocik: That so totally worked. Thank you, thank you, thank you!
[2012-05-03 20:54:19 -0400] m0s: hello guys
[2012-05-03 20:54:36 -0400] m0s: can someone help me a bit with refactoring?
[2012-05-03 20:57:04 -0400] m0s: i'm using rvm-chef and need to obtain some gem version from attributes
[2012-05-03 20:57:05 -0400] m0s: https://gist.github.com/84c4f9f0cf6db51d41e3
[2012-05-03 20:57:29 -0400] m0s: now i'm doing that in a silly way :)
[2012-05-03 20:57:37 -0400] m0s: how i can improve that?
[2012-05-03 21:08:38 -0400] yfeldblum: m0s, why attributes?
[2012-05-03 21:11:51 -0400] m0s: yfeldblum: because of lack knowledge and experience:) ?
[2012-05-03 21:12:01 -0400] m0s: *lack of
[2012-05-03 21:12:26 -0400] yfeldblum: m0s, overall, high-level, what are you trying to accomplish?
[2012-05-03 21:13:12 -0400] m0s: simple thing - rvm + apache2 + passenger + rails app running on that stack
[2012-05-03 21:14:08 -0400] m0s: and i'm trying to obtain data from attributes to put them to template of apache vhost (to set up propper path to passenger module, etc)
[2012-05-03 21:14:27 -0400] yfeldblum: why is this data in the node's attributes? any particular reason?
[2012-05-03 21:14:29 -0400] jcw9: Are backticks overloaded inside chef to run on the provisioning target?
[2012-05-03 21:14:32 -0400] yfeldblum: which rvm cookbook is this?
[2012-05-03 21:15:04 -0400] yfeldblum: jcw9, no, and also, what do you mean?
[2012-05-03 21:15:57 -0400] m0s: fletchers chef-rvm it is
[2012-05-03 21:16:07 -0400] m0s: this one https://github.com/fnichol/chef-rvm
[2012-05-03 21:16:42 -0400] jcw9: yfeldblum: So I'm guessing line 27 here is getting the local pear version info? https://github.com/msonnabaum/chef-phpunit/blob/master/recipes/default.rb lol bugs
[2012-05-03 21:18:12 -0400] yfeldblum: m0s, with that one, you should probably not use attributes; you should probably use the resources defined in that cookbook instead
[2012-05-03 21:19:05 -0400] m0s: yfeldblum: so you mean, write a recipe which set up such things using LWRP from cookbook?
[2012-05-03 21:19:55 -0400] yfeldblum: jcw9, that gets the local pear version info from whatever is running that cookbook, which is usually the server
[2012-05-03 21:20:33 -0400] yfeldblum: m0s, yes, write a recipe for hosting the app you're trying to host; in the recipe, start off by using the rvm_* resources from fnichol's rvm cookbook
[2012-05-03 21:21:10 -0400] m0s: yfeldblum: i just was trying to define default stuff in the role, to change it easily later, if needed.
[2012-05-03 21:21:41 -0400] jcw9: yfeldblum: ok so that isn't executed on my local machine provisioning a vm? The script is actually evaluated on the target machine.
[2012-05-03 21:23:14 -0400] yfeldblum: m0s, fine, give YOUR cookbook an API in terms of attributes it listens to (to choose which ruby to set up thru fnichol's rvm_* resources) that a role can modify later ... rather than having your role configure rvm directly
[2012-05-03 21:23:51 -0400] yfeldblum: jcw9, correct; ALL recipes code is executed on the VMs that chef is configuring
[2012-05-03 21:25:01 -0400] m0s: yfeldblum, then an obv question - why we have possibility to configure cookbook's attributes this way. and when it is a good idea to use cookbooks attributes, like i was trying to do
[2012-05-03 21:25:29 -0400] jcw9: yfeldblum: Cool, thanks.
[2012-05-03 21:26:03 -0400] yfeldblum: m0s, they're provided for convenience, for when the purpose of your using chef is to set up rvm (but your purpose in using chef is to set up an app that USES rvm)
[2012-05-03 21:26:07 -0400] bemu: Anyone have a suggestion on managed colo at Equinox for Direct Connect to AWS US-East?
[2012-05-03 21:26:54 -0400] flashmanbahadur: bemu: I think Voxel uses some space from Equinex and they do offer direct connect
[2012-05-03 21:27:11 -0400] flashmanbahadur: sorry, answered you in the wrong channel
[2012-05-03 21:28:05 -0400] yfeldblum: m0s, just like you normally use the cookbook_file, template, and service resources directly in your recipe code, rather than having to set up a role with all that configured as override_attributes data
[2012-05-03 21:28:23 -0400] bemu: No problem, I asked in three channels. :)
[2012-05-03 21:28:31 -0400] flashmanbahadur: what was the last one?
[2012-05-03 21:28:35 -0400] bemu: Thanks sir!
[2012-05-03 21:28:44 -0400] bemu: chef, aws, infra-talk
[2012-05-03 21:28:52 -0400] flashmanbahadur: what is this infra-talk you speak of
[2012-05-03 21:29:16 -0400] m0s: yfeldblum: thanks a lot, man. i know that my question is too kiddie, but you know, you avoided me from mistake, that is very useful.
[2012-05-03 21:29:16 -0400] flashmanbahadur: nice
[2012-05-03 21:29:27 -0400] yfeldblum: m0s, sure thing
[2012-05-03 21:36:36 -0400] AntonZ: what loadbalancers do people use here on amazon ?
[2012-05-03 21:36:56 -0400] bemu: haproxy and nginx
[2012-05-03 21:37:07 -0400] AntonZ: which one is more intuitive to configure ?
[2012-05-03 21:37:46 -0400] bemu: Neither? :P
[2012-05-03 21:38:04 -0400] bemu: They both have different features, you should pick based on your use case.
[2012-05-03 21:38:06 -0400] AntonZ: hahaha, we use F5 LB in-house, but it's not aviaa ble on amazon yet... so
[2012-05-03 21:38:17 -0400] bemu: I prefer haproxy, personally, for most use cases.
[2012-05-03 21:39:09 -0400] AntonZ: i need to be able to secure traffic between client and server and then between loadbalancer and web server internally...
[2012-05-03 21:39:23 -0400] AntonZ: i guess only way to find out is fire up a few load balancers :)
[2012-05-03 21:40:23 -0400] spyvsspy: i am trying to route everything over 443
[2012-05-03 21:40:24 -0400] jtimberman: bemu: the use cases taht don't require ssl? :)
[2012-05-03 21:40:25 -0400] spyvsspy: using this guine
[2012-05-03 21:40:26 -0400] spyvsspy: http://warwickp.com/2010/10/hosting-chef-server-behind-nginx-proxy
[2012-05-03 21:40:39 -0400] spyvsspy: and I keep getting 406 not acceptable when running chef client on a node
[2012-05-03 21:41:39 -0400] spyvsspy: does the server have to have SSL?
[2012-05-03 21:46:37 -0400] bemu: jtimberman: Precisely. :D
[2012-05-03 21:46:49 -0400] bemu: I'm currently using ELB to terminate SSL.
[2012-05-03 21:47:07 -0400] bemu: We just don't terminate SSL much at all, so it hasn't been an issue.
[2012-05-03 21:47:20 -0400] bemu: It's all forward facing stuff, which doesn't have the same uptime requirements that all of our APIs do.
[2012-05-03 21:47:57 -0400] miah: i use stud for ssl termination and its been working alright
[2012-05-03 21:48:07 -0400] bemu: AntonZ: I've done that with nginx previously.
[2012-05-03 21:48:12 -0400] miah: i know macros and crucially have different opinions on that though =)
[2012-05-03 21:51:02 -0400] AntonZ: are any of these LBs have web UI or require manual file editing ?
[2012-05-03 21:51:03 -0400] macros: We use apache, could be more efficient on the server side but has good client side characteristics
[2012-05-03 21:51:42 -0400] miah: webui? wtf is that?
[2012-05-03 21:51:56 -0400] miah: if i can't automate it i dont use it
[2012-05-03 21:51:57 -0400] AntonZ: look at F5 :)
[2012-05-03 21:52:04 -0400] bemu: Haha.
[2012-05-03 21:52:11 -0400] macros: We're able to handle about 60k ssl req/s through it, so perf isn't too horrid
[2012-05-03 21:52:33 -0400] macros: Burning 20% cpu in thread sync does make me a little sad
[2012-05-03 21:52:38 -0400] bemu: Macros: If/when SSL termination becomes something we need to look at, will be comparing nginx to apache, probably.
[2012-05-03 21:52:49 -0400] miah: nginx, apache, stud =)
[2012-05-03 21:52:52 -0400] bemu: The blog post someone made on nginx cipher config is encouraging, at least.
[2012-05-03 21:53:24 -0400] macros: events and ssl are kinda bad, ssl handshake is a long blocking operation that stalls the event loop
[2012-05-03 21:53:47 -0400] spyvsspy: do any of you guys route your API over 443?
[2012-05-03 21:53:53 -0400] macros: Multiple acceptors help
[2012-05-03 21:54:01 -0400] macros: Yes
[2012-05-03 21:54:20 -0400] spyvsspy: im having some trouble with doing that
[2012-05-03 21:54:45 -0400] spyvsspy: I have the client pointing to http://myapiserver.com:443
[2012-05-03 21:55:02 -0400] macros: https
[2012-05-03 21:55:03 -0400] spyvsspy: but keep getting a 406 error;  do I need SSL installed for this to function correctly?
[2012-05-03 21:55:06 -0400] macros: 443 is just a port
[2012-05-03 21:55:13 -0400] spyvsspy: nginx has ssl off
[2012-05-03 21:55:34 -0400] spyvsspy: im doing some testing, before i buy my cert
[2012-05-03 21:55:37 -0400] macros: You can just bind the server on 443 without ssl
[2012-05-03 21:55:46 -0400] macros: You can also self generate a cert
[2012-05-03 21:56:15 -0400] macros: There is also http://cert.startcom.org/
[2012-05-03 21:56:22 -0400] qhartman_: http://www.cacert.org/
[2012-05-03 21:56:29 -0400] spyvsspy: right now, Im using nginx as such:   http://warwickp.com/2010/10/hosting-chef-server-behind-nginx-proxy
[2012-05-03 21:56:48 -0400] spyvsspy: am i better off just binding the server running on 4000 to 443?
[2012-05-03 21:57:15 -0400] macros: I don't think chef will work at all without ssl on the server
[2012-05-03 21:57:28 -0400] spyvsspy: it currently works
[2012-05-03 21:57:37 -0400] spyvsspy: if I point my client to :4000
[2012-05-03 21:58:04 -0400] macros: For chef you can just do a self generated cert, it isn't going to auth the cert against a public chain
[2012-05-03 21:58:06 -0400] spyvsspy: http://myapiserver.com:4000 works fine
[2012-05-03 21:58:26 -0400] spyvsspy: is that why its breaking though, becuase ssl is off on nginx?
[2012-05-03 22:00:47 -0400] macros: 406 is something in the request getting rejected by nginx, check your logs
[2012-05-03 22:01:08 -0400] macros: I don't use nignx on a regular basis, can't offer up more than that
[2012-05-03 22:02:07 -0400] spyvsspy: https://gist.github.com/2589854
[2012-05-03 22:02:12 -0400] spyvsspy: throwing a bunch of weird stuff
[2012-05-03 22:03:02 -0400] miah: its throughing a bunch of stuff because its assuming a ssl connection
[2012-05-03 22:03:18 -0400] miah: likely, you connected to your host as "https://foo:443"
[2012-05-03 22:03:32 -0400] spyvsspy: no, the URL for client.rb is http://
[2012-05-03 22:03:40 -0400] spyvsspy: http://apiserver.com:443
[2012-05-03 22:03:48 -0400] miah: yes, but you tested it manually right?
[2012-05-03 22:04:26 -0400] spyvsspy: ya, if i go through a browser to http://apiserver.com:443 it is the REST API screen
[2012-05-03 22:04:30 -0400] miah: looks like you tested it with chrome
[2012-05-03 22:04:35 -0400] spyvsspy: ya
[2012-05-03 22:05:18 -0400] spyvsspy: would i need to regenerate my validation.pem or anything?
[2012-05-03 22:05:20 -0400] miah: the 400 errors are ssl issues
[2012-05-03 22:05:25 -0400] miah: no. you just need to install a cert
[2012-05-03 22:05:32 -0400] spyvsspy: ok
[2012-05-03 22:05:38 -0400] spyvsspy: thanks, will try that out in the AM
[2012-05-03 22:05:40 -0400] miah: just buy a ssl cert they are like $15
[2012-05-03 22:05:50 -0400] spyvsspy: righto thanks again
[2012-05-03 22:13:47 -0400] josephholsten: are there any CBs that actually include backup/restore processes? the only one I know of is mysql with ebs snapshots
[2012-05-03 22:23:38 -0400] miah: backup / restore processes tend to be very environment specific, so you wont see very many of them
[2012-05-03 22:57:42 -0400] chip-: Question about the link resource: If a symlink already exists and points to the wrong place, will the link resource recreate it correctly, or do I need to put in some logic to handle that situation?
[2012-05-03 22:58:03 -0400] laurent\: it will remove it and recreate
[2012-05-03 22:58:58 -0400] chip-: Excellent.
[2012-05-03 23:00:52 -0400] upgrayedd^: tomcat's init script in rhels6.2 is broken s.t. if you restart it twice in quick succession it will return an error code, i'd like advice about what the right way is to modify the recipe so this doesn't happen
[2012-05-03 23:02:08 -0400] upgrayedd^: the action [:start] at the end of the tomcat service combined with the notifies :restart in templates is causing it to try twice.  why doesn't it just queue and only restart once?
[2012-05-03 23:03:42 -0400] miah: sounds like the script doesn't create a pid or lock file so it has a race condition
[2012-05-03 23:04:02 -0400] upgrayedd^: it tries to do those things but there's a race
[2012-05-03 23:04:13 -0400] upgrayedd^: never noticed it manually restarting it, but chef reproduces every time
[2012-05-03 23:04:15 -0400] miah: so fix it
[2012-05-03 23:05:07 -0400] miah: =)
[2012-05-03 23:05:43 -0400] upgrayedd^: fair enough- but given my chef experience is 1.5 days long i wanted to take this opportunity to ask why it's starting the service twice in the first place?  notifies collapses to one restart, and i'm wondering why the action [:start] doesn't have the same behavior
[2012-05-03 23:06:17 -0400] |shad0w|: they are two different actions
[2012-05-03 23:06:51 -0400] |shad0w|: and personally the only action I put into a service definition is enable
[2012-05-03 23:07:19 -0400] upgrayedd^: ok- so say you only put enable in there.  how would you ensure it gets started no matter what?  just rely on the notifies restarts?
[2012-05-03 23:07:40 -0400] |shad0w|: yeah, I don't have many services that get installed that don't have a notify on a template
[2012-05-03 23:07:52 -0400] miah: i typically use runit, so enabling it is mostly all you need to do
[2012-05-03 23:08:19 -0400] upgrayedd^: i can live with all that. i had tried it that way and it works fine
[2012-05-03 23:08:31 -0400] upgrayedd^: alarm bells start ringing when something is unclean though
[2012-05-03 23:10:58 -0400] miah: and community cookbooks are far from perfect. so expect to fix things =)
[2012-05-03 23:11:56 -0400] upgrayedd^: s/community cookbooks/open source projects/
[2012-05-03 23:14:16 -0400] dangerdave: any good examples out there of using the deploy resource for django apps?
[2012-05-03 23:15:56 -0400] josephholsten: dangerdave: I'd start here: https://github.com/opscode-cookbooks/application_python
[2012-05-03 23:16:05 -0400] dangerdave: thanks.
[2012-05-03 23:16:41 -0400] josephholsten: anyone seen a CB for an rsync _server_? community rsync is just the client
[2012-05-03 23:18:07 -0400] josephholsten: or does everyone just use rsync over ssh?
[2012-05-03 23:22:07 -0400] senthilr: I use it over 873
[2012-05-03 23:22:12 -0400] senthilr: sometimes
[2012-05-03 23:22:47 -0400] josephholsten: :)
[2012-05-03 23:25:10 -0400] atomic-penguin: So I wrote this today, http://ckbk.it/el2centos
[2012-05-03 23:26:38 -0400] josephholsten: atomic-penguin: very nice! too bad my last client wanted centos2el
[2012-05-03 23:27:21 -0400] atomic-penguin: josephholsten, I would like to do an "undo" recipe.  Don't really know how it would be feasible to redistribute the redhat rpms though
[2012-05-03 23:28:09 -0400] atomic-penguin: Grab the srpms and rpmbuild them maybe
[2012-05-03 23:28:23 -0400] josephholsten: you'd probably have to do similar to windows and java::oracle cbs. explicit EULA agreement attributes and mirror urls
[2012-05-03 23:29:43 -0400] atomic-penguin: You can fetch the srpms from redhat no problem, its the binary rpms that are redhat property
[2012-05-03 23:29:53 -0400] josephholsten: you'd probably get a kick out of my automatic rhnet license mgmnt scripts. because the client didn't want to pay for more licenses than they were building out at once.
[2012-05-03 23:32:36 -0400] miah: atomic-penguin: thats awesome.
[2012-05-03 23:33:48 -0400] atomic-penguin: They are raising the self support costs on us, so we told our sales rep, we're cutting 10 entitlements a year in response
[2012-05-03 23:36:59 -0400] miah: only 10?
[2012-05-03 23:37:58 -0400] julienphalip: Hello there, is there a way to not have to systematically provide the configuration and node files to chef-solo as parameters, and have chef-solo automatically find those files in a default location? (i.e.  $ chef-solo instead of  $ chef-solo -c solo.rb -j node.json)
[2012-05-03 23:51:50 -0400] svanzoest: hmm.. that I must be missing something in a deploy callback I get the following
[2012-05-03 23:51:50 -0400] svanzoest: NoMethodError: deploy_revision[/srv/restapi] (or_restapi::default line 143) had an error: NoMethodError: undefined method `resources' for #<Chef::Provider::Deploy::Revision:0x7f858fc95808>
[2012-05-03 23:52:13 -0400] svanzoest: how do I get resources in the before_restart callback scope?
[2012-05-03 23:53:24 -0400] paulmooring: julienphalip: chef-solo looks for /etc/chef-solo.rb if you don't pass it the -c option
[2012-05-03 23:54:11 -0400] julienphalip: paulmooring: Oh, I see, thanks.
[2012-05-03 23:54:59 -0400] julienphalip: It'd be nice if it could also fallback to looking in the current folder's "chef" subfolder if it exists, or something like that.
[2012-05-03 23:55:37 -0400] julienphalip: That'd be useful for when the chef's configuration files are stored in a code repository
[2012-05-03 23:56:01 -0400] miah: julienphalip: submit a feature request in the issue tracker
[2012-05-03 23:56:29 -0400] julienphalip: miah: Yes, good idea. Maybe someone else has already reported that, too.
[2012-05-03 23:56:42 -0400] yfeldblum: julienphalip, unlike every other package that looks for its configuration file in /etc
[2012-05-03 23:56:44 -0400] paulmooring: julienphalip: and if you didn't already know you can always leave off the -j and specify json_attribs in the solo.rb
[2012-05-03 23:57:42 -0400] julienphalip: paulmooring: Nice tip, thanks
[2012-05-03 23:58:41 -0400] yfeldblum: terrible idea; the /etc/chef/solo.rb should typically be the same across all hosts, with the json attributes file differing between hosts
[2012-05-03 23:59:00 -0400] yfeldblum: code stays the same; data varies
[2012-05-03 23:59:04 -0400] julienphalip: yfeldblum: I might be doing things wrong, but right now I'm storing everything (cookbooks and config files) in my code repository, and then build a VM using vagrant. From inside the VM I can't access the host's /etc/ folder, that's why I was hoping Chef would also fallback to looking in the current folder for config files
