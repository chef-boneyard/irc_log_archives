[2012-05-16 00:00:55 -0400] yfeldblum: nstielau1, using resources in your providers will work, though
[2012-05-16 00:02:37 -0400] miah: https://gist.github.com/2705827
[2012-05-16 00:02:50 -0400] miah: * notes for our group.. hope it makes sense.
[2012-05-16 00:07:35 -0400] yfeldblum: miah, it sounds more like the postconditions from design-by-contract than example-based tests
[2012-05-16 00:11:04 -0400] miah: hrm
[2012-05-16 00:11:41 -0400] yfeldblum: miah, hmm i need to look at the tools again to see what they're doing
[2012-05-16 00:11:46 -0400] miah: ya
[2012-05-16 00:11:53 -0400] miah: i'm still learning the testing/ruby way.
[2012-05-16 00:12:25 -0400] yfeldblum: miah, actually nstielau1's cookbook is design-by-contract's postconditions rather than example-based tests
[2012-05-16 00:12:48 -0400] miah: yes
[2012-05-16 00:13:11 -0400] yfeldblum: postconditions are certainly important too; the question is only "i am important; what category am i in?"
[2012-05-16 00:14:37 -0400] fujin: i always really just used them as a weird ugly way to run arbitrary bits of code to execute integration style tests of different componetns
[2012-05-16 00:14:53 -0400] fujin: guess the examples in my old repo showed that but I nuked it :p
[2012-05-16 00:19:39 -0400] coderanger: For everyone at chefconf we have a #chefconf channel too
[2012-05-16 00:21:34 -0400] syphon: What's the recommended way of copying entire directories of files from remote file servers? remote_file only does single files, and remote_directory (despite its name) only seems to copy from within the cookbook
[2012-05-16 00:23:45 -0400] miah: rsync
[2012-05-16 00:28:05 -0400] fujin: syphon: rsync, git, make a package, put it on s3
[2012-05-16 00:28:12 -0400] fujin: nail it to a frisbee. toss it out window
[2012-05-16 00:29:27 -0400] miah: ooh frisbee!
[2012-05-16 00:29:35 -0400] syphon: That's not cross platform though. I was hoping for a native resource so I could avoid the whole "if $windows { robocopy { elsif $linux { rsync } else { whatever }" and any potential bugs
[2012-05-16 00:30:13 -0400] syphon: at first, remote_directory seemed exactly what I wanted, but it seems.... inconsistantly named. :)
[2012-05-16 00:32:16 -0400] miah: write one
[2012-05-16 00:32:23 -0400] miah: remote_directory is great for single files..
[2012-05-16 00:32:38 -0400] syphon: isn't that what remote_file is for?
[2012-05-16 00:32:46 -0400] hoover_damm: miah, huh?
[2012-05-16 00:32:50 -0400] hoover_damm: is that a slip?
[2012-05-16 00:32:56 -0400] yfeldblum: remote_file used to pull cookbook files, but that was moved to the new resource, cookbook_file
[2012-05-16 00:33:13 -0400] yfeldblum: remote_directory should probably be renamed to cookbook_directory or something for consistency
[2012-05-16 00:33:16 -0400] hoover_damm: remote_directory a way to drop a whole directory in files/default
[2012-05-16 00:33:18 -0400] yfeldblum: but that's the history for you
[2012-05-16 00:33:20 -0400] hoover_damm: and copy that directory to the server
[2012-05-16 00:33:31 -0400] syphon: I can write my own, I was just hoping someone had already solved something as basic as file copying multiple files :(
[2012-05-16 00:33:58 -0400] hoover_damm: remote_directory has nothing to do with a singular file
[2012-05-16 00:34:05 -0400] fujin: it does make one wonder
[2012-05-16 00:34:08 -0400] syphon: a common practice in my company seems to be to package up lots of libraries into a dir, and then deployments are usually a robocopy/rsync
[2012-05-16 00:34:10 -0400] fujin: why it would not have been written
[2012-05-16 00:34:14 -0400] miah: sorry, it was a slip yes.
[2012-05-16 00:34:25 -0400] miah: <- listening to people speak. while trying to sound smart on irc ;)
[2012-05-16 00:34:28 -0400] hoover_damm: syphon, and where do you store them?
[2012-05-16 00:34:37 -0400] hoover_damm: can you retrieve said files easily via http?
[2012-05-16 00:34:37 -0400] syphon: a centralized file server
[2012-05-16 00:34:51 -0400] hoover_damm: any reason you can't do cookbook_file from that centralized file server?
[2012-05-16 00:35:06 -0400] hoover_damm: to copy your file from there to the local instance, and then do what you want?
[2012-05-16 00:35:41 -0400] syphon: I thought cookbook_file only copied files *from* the cookbook itself (out of /files)
[2012-05-16 00:36:02 -0400] syphon: meaning, I'd have to add these library budles to each cookbook that uses them
[2012-05-16 00:37:09 -0400] hoover_damm: cookbook_file can only cookbook out of files/ right.  But remote_file can fetch from a http server
[2012-05-16 00:37:55 -0400] syphon: yeah, it seems like there is no built in way to copy entire directories in chef. I was just trying to make sure I didn't miss anything
[2012-05-16 00:38:09 -0400] yfeldblum: i'd say that remote_directory from anywhere except a cookbook's files/ isn't asking for trouble
[2012-05-16 00:38:27 -0400] yfeldblum: i'd say that remote_directory from anywhere except a cookbook's files/ is asking for trouble
[2012-05-16 00:38:49 -0400] yfeldblum: hard to generalize
[2012-05-16 00:39:16 -0400] yfeldblum: might make a sync_directory resource with a robocopy provider and a rsync provider
[2012-05-16 00:39:35 -0400] hoover_damm: yfeldblum, this is a multiple ways of handling it
[2012-05-16 00:39:35 -0400] syphon: yep that makes the most sense to me
[2012-05-16 00:40:01 -0400] hoover_damm: remote_directory is a pretty easy way to do it.  But it sounds like syphon needs to adopt new ways to share his code so he can make his life easier
[2012-05-16 00:40:54 -0400] yfeldblum: hoover_damm, i mean it basically assumes the source is going to be another directory on the LAN and that somehow the current server has the right connection & perms to get it
[2012-05-16 00:41:04 -0400] syphon: it wouldn't be a problem if all possible files were stored inside my chef repo. However, we're just starting to adopt Chef, so we have thousands of libraries (terabytes of data) on our central file server
[2012-05-16 00:41:43 -0400] miah: yfeldblum: that would be awesome.
[2012-05-16 00:41:44 -0400] yfeldblum: hoover_damm, whereas packaging, or just sticking a tarball in an apache wwwroot and configuring it for etags, makes fewer assumptions
[2012-05-16 00:42:04 -0400] yfeldblum: miah, not "i" ... was a suggestion to syphon ...
[2012-05-16 00:42:49 -0400] syphon: that would be wonderful except that we already have a massive investment in this architecture (the multiple files on a remote server)
[2012-05-16 00:43:09 -0400] syphon: re-structuring everything to be a tarball checked into the chef repo is just completely out of scope
[2012-05-16 00:44:00 -0400] yfeldblum: syphon, wouldn't suggest checking the tarball into the chef-repo ... but i did say sticking a tarball in an apache wwwroot (not in the chef-repo) is an approach with fewer assumptions and wider applicability
[2012-05-16 00:44:32 -0400] syphon: yeah that's another option I was considering, but that one seems massive too
[2012-05-16 00:44:56 -0400] syphon: (I mean, packaging each of these 'library bundles' into a single tar/zip file)
[2012-05-16 00:45:16 -0400] yfeldblum: syphon, the purpose of automation is to make it possible to change the architecture with far less risk and far greater speed, so in time with growing automation you should be able to transition
[2012-05-16 00:46:15 -0400] hoover_damm: in order to automate chaos you first assemble the chaos enough into a a cohesive pile of goo
[2012-05-16 00:46:19 -0400] hoover_damm: that you can work with it
[2012-05-16 00:46:55 -0400] hoover_damm: if you store files on fileserves the first thing you should do likely is try and improve the pattern of how you store files, fetching, retrieving
[2012-05-16 00:46:58 -0400] hoover_damm: and securely
[2012-05-16 00:47:10 -0400] mlei: syphon: where do you currently initiate the rsync
[2012-05-16 00:47:11 -0400] syphon: that assumes I'm the one that controls the files
[2012-05-16 00:47:19 -0400] hoover_damm: Chef can help shipping files but you don't want to ship large files
[2012-05-16 00:47:19 -0400] mlei: from the central server or from the receiving box
[2012-05-16 00:47:24 -0400] yfeldblum: hoover_damm, yep, step by step
[2012-05-16 00:47:33 -0400] hoover_damm: like a 250meg file in a cookbook
[2012-05-16 00:47:34 -0400] hoover_damm: would be bad
[2012-05-16 00:47:38 -0400] hoover_damm: but a 2meg, should be fine
[2012-05-16 00:47:53 -0400] syphon: in this case, I'm a consumer. Team X comes to me and says "my library is available on \\server\share\app\v1" and I have to consume it like that. Now multiply that by 25 teams over 10 years :)
[2012-05-16 00:48:25 -0400] hoover_damm: syphon, right you need to centralize this
[2012-05-16 00:48:27 -0400] yfeldblum: syphon, no, but you should be able to introduce a step in the middle where you take what's shipped to you and package it up and deploy it to be delivered to the servers via e.g. apache
[2012-05-16 00:48:30 -0400] syphon: in today's world, our in house app uses robocopy or rsync to copy those files from the share down locally
[2012-05-16 00:48:43 -0400] mlei: well, it has to be an incremental thing, yeah? syphon, i'd suggest that you might start with a script that knows how to mount that fileshare and rsync it, and have the cookbook place the script and run it. this sort of sucks, but it's a place to start.
[2012-05-16 00:48:43 -0400] hoover_damm: syphon, because if you let every team make their own pattern to set up their releases
[2012-05-16 00:49:04 -0400] mlei: in the future you might go to the zip of the files, using remote_file
[2012-05-16 00:49:11 -0400] hoover_damm: then you being the person trying to automate it, ends up having to automate pulling their releases into a central spot
[2012-05-16 00:49:12 -0400] mlei: that's the next suckiest... then eventually to rpms/debs
[2012-05-16 00:49:14 -0400] yfeldblum: syphon, so you would robocopy from where they delivered it and package it up and send it to a known place, and then get the package to the nodes with chef
[2012-05-16 00:49:48 -0400] hoover_damm: you can setup webdav syphon and have them push to webdav instead
[2012-05-16 00:50:00 -0400] hoover_damm: and you can mount the webdav server on their workstations so they can push there instead
[2012-05-16 00:50:08 -0400] hoover_damm: and then you can turn around and fetch the zip via http or whatever
[2012-05-16 00:50:35 -0400] syphon: well, it seems like i have some stuff to think about
[2012-05-16 00:50:38 -0400] syphon: thanks for the help guys
[2012-05-16 00:51:07 -0400] hoover_damm: I remember taking an organization who did everything by hitting enter to configuration management
[2012-05-16 00:51:11 -0400] hoover_damm: it was a clusterpoo
[2012-05-16 00:51:33 -0400] hoover_damm: custom apache version compiled by hand, custom apache modules compiled by hand... patches left and right
[2012-05-16 00:52:09 -0400] mlei: hoover_damm: i think we all have some stories like that
[2012-05-16 00:52:21 -0400] JSharp: yeah, \sometimes you have to raze the earth and start from scratch.. done that before.
[2012-05-16 00:52:41 -0400] mlei: most of the time they don't give you the budget to start from scratch
[2012-05-16 00:52:54 -0400] raz: just stuff everything into git, from there it's downhill
[2012-05-16 00:55:20 -0400] hoover_damm: mlei, what's worse is when you get the opportunity to have the company start from scratch
[2012-05-16 00:55:26 -0400] hoover_damm: and you don't get enough time to actually do anything
[2012-05-16 00:55:47 -0400] hoover_damm: mlei, when I worked for Adapp f/k/a Tattomedia I got the joy of starting over from scratch.
[2012-05-16 00:56:17 -0400] hoover_damm: once we finally moved everything into LA and got Tattomedia out of Washington state, we had 2 weeks to clean out the datacenter upgrade all the bios's and move from puppet to chef
[2012-05-16 00:56:36 -0400] mlei: 2 weeks? heh.
[2012-05-16 00:56:45 -0400] hoover_damm: yep
[2012-05-16 00:56:48 -0400] mlei: i just spent two weeks doing a POC
[2012-05-16 00:56:51 -0400] mlei: haha
[2012-05-16 00:57:06 -0400] mlei: putting a production system together in 2 weeks, now that's magic
[2012-05-16 00:57:18 -0400] hoover_damm: looking back I should have walked then
[2012-05-16 01:40:58 -0400] dangerdave: The latest python cookbook seems to be broken. Specifically, it fails to install virtualenv. This appears to happen in providers/pip.rb:127 -- the version check cmd is "pip freeze | grep -i '^virtualenv=='", which returns 1 (nothing found via grep) -- looks like the provider expects a return of 0. What's up?
[2012-05-16 01:42:48 -0400] dangerdave: There's a rescue here for Chef::Exceptions::ShellCommandFailed but it doesn't seem to be working? Think it should maybe rescue Mixlib::ShellOut::ShellCommandFailed instead?
[2012-05-16 01:43:31 -0400] idetik: hi, i'm using hosted chef and eucalyptus, upon trying to do  knife euca server create [...] i'm getting a 403 forbidden:
[2012-05-16 01:43:50 -0400] idetik: in the body of the http response from that is:  <Excon::Response:0x7f0da25bfa48 @body="Failure: 403  Forbidden\r\nMessage replay detected.  Same signature was used  within the last 5 minutes\r\n\r\n", @status=403,  @headers={"Content-Type"=>"text/plain; charset=UTF-8"}
[2012-05-16 01:44:55 -0400] idetik: it seems that eucalyptus is detecting a replay attack from hosted chef because it is sending requests too fast.  is this a known problem?  do i have to change something in eucalyptus 2.0.3 to support it?
[2012-05-16 01:45:27 -0400] dangerdave: yep, looks like rescuing Mixlib::ShellOut::ShellCommandFailed does the trick. I'll send a pull req.
[2012-05-16 01:48:57 -0400] dangerdave: ah, somebody beat me to it: https://github.com/opscode-cookbooks/python/pull/7
[2012-05-16 01:49:10 -0400] dangerdave: unclear whether this is a python cookbook issue or an issue with Mixlib in 0.10.10
[2012-05-16 01:54:58 -0400] yfeldblum: dangerdave, it has to do with ShellOut starting out as part of chef and then getting extracted into its own library
[2012-05-16 01:55:14 -0400] dangerdave: yfeldblum: interesting. did this happen in 0.10.10?
[2012-05-16 01:55:45 -0400] dangerdave: yfeldblum: should the python cookbook be rescuing Mixlib exceptions, or should it continue to expect Chef:: exceptions?
[2012-05-16 02:00:32 -0400] yfeldblum: dangerdave, i believe the extraction was between 0.10.8 and 0.10.10, yes
[2012-05-16 02:01:16 -0400] yfeldblum: dangerdave, going forward, ShellOut is Mixlib::ShellOut, and when it raises, it raises Mixlib::ShellOut::ShellCommandFailed or similarly-namespaced exceptions
[2012-05-16 02:01:35 -0400] dangerdave: cool, thanks yfeldblum. Looks like pullreq #7 on the python cookbook will fix it then.
[2012-05-16 02:02:36 -0400] dangerdave: seems like a surprising refactoring for a dot-dot release. although i don't really know what the versioning rules are in chef-land.
[2012-05-16 02:02:54 -0400] yfeldblum: dangerdave, versioning rules are "pre-1.0" :P
[2012-05-16 02:03:08 -0400] yfeldblum: dangerdave, semver applies to post-1.0
[2012-05-16 02:03:13 -0400] dangerdave: yfeldblum: Hah! ;-)
[2012-05-16 02:03:49 -0400] yfeldblum: dangerdave, that said, there is a great effort to maintain backcompat in most cases
[2012-05-16 02:04:31 -0400] dangerdave: yfeldblum: yep. this one is an easy search/replace over cookbooks regardless. probably worth going over all of 'em to see what exceptions they're looking for on shell_out
[2012-05-16 02:13:53 -0400] josephholsten: because semver only refers to a production ready release, and no one should be using chef in production yet...
[2012-05-16 02:14:27 -0400] josephholsten: ;-)
[2012-05-16 02:18:33 -0400] yfeldblum: latez
[2012-05-16 02:19:30 -0400] josephholsten: tata
[2012-05-16 02:19:37 -0400] hoover_damm: I think it's more rubygems and it pulling in dependencies
[2012-05-16 02:19:39 -0400] hoover_damm: then semver
[2012-05-16 02:20:14 -0400] hoover_damm: but the problem with Chef changing is trying to not break as much possible, but still grow
[2012-05-16 02:20:20 -0400] hoover_damm: without stuntint growth
[2012-05-16 02:20:27 -0400] hoover_damm: stunting*
[2012-05-16 02:20:49 -0400] josephholsten: semver needs a section on dependencies. they should not increase within a minor release cycle
[2012-05-16 02:21:11 -0400] josephholsten: agreed
[2012-05-16 02:22:00 -0400] dstufft: I think dependencies are out of the scope for semver, semver doesn't mention anything about internal code or internal api's or anything of the sort. It deals strictly with the contract for external API's
[2012-05-16 02:22:12 -0400] hoover_damm: yep
[2012-05-16 02:23:21 -0400] josephholsten: if you package those deps, fine. if you're assuming they will be handled by the environment, then they're an external api by another name
[2012-05-16 02:26:31 -0400] dangerdave: josephholsten: yeah, i wasn't gonna poke on "it's not semver, anything can break at any time" ;-)
[2012-05-16 02:27:35 -0400] hoover_damm: that's an acceptable poke to me.
[2012-05-16 02:27:35 -0400] josephholsten: things like bundler standalone and virtualenv can help for apps. but bumping a major version requirement on say the json gem, and calling that a patch release means that code that depends on me has to change its interface to json.
[2012-05-16 02:27:54 -0400] hoover_damm: I use omnibus / customized images to avoid the installation of chef
[2012-05-16 02:28:04 -0400] josephholsten: +1
[2012-05-16 02:28:20 -0400] hoover_damm: I am a person that considers it an error to depend on installing chef from rubygems for production
[2012-05-16 02:28:50 -0400] dangerdave: yep it's clear i need to lock my chef version down or else doom at any time...\
[2012-05-16 02:29:02 -0400] hoover_damm: it's great for a test environment.  But you should never depend on another service to build your production environment.  There will be a day someone will be down, and telling your boss that you can't build a server because apache's ftp site is down is UNACCEPTABLE
[2012-05-16 02:29:06 -0400] hoover_damm: ;)
[2012-05-16 02:29:25 -0400] hoover_damm: It's murphys law, don't depend on upstream if you do it will get ou.
[2012-05-16 02:29:26 -0400] hoover_damm: you*
[2012-05-16 02:29:44 -0400] mlei: in an ideal world, i'd have a local repo with the packages in it for my package manager. it can be gems underneath, but i don't want to actually run gem install
[2012-05-16 02:29:49 -0400] dangerdave: hoover_damm: absolutely agree
[2012-05-16 02:29:54 -0400] josephholsten: hoover_damm: chef_full distro is still pushing 0.10.8-3
[2012-05-16 02:30:04 -0400] hoover_damm: and the path to most of this is mostly squid (proxies)
[2012-05-16 02:30:10 -0400] hoover_damm: and or image / proper mirroring
[2012-05-16 02:30:29 -0400] mlei: it would have to be yum or apt-get/aptitude
[2012-05-16 02:30:32 -0400] hoover_damm: josephholsten, is that still on 1.9.2 as well?
[2012-05-16 02:30:58 -0400] hoover_damm: paludis can work with gems directly
[2012-05-16 02:31:03 -0400] hoover_damm: ;)
[2012-05-16 02:31:05 -0400] hoover_damm: so don't forget it.
[2012-05-16 02:31:16 -0400] josephholsten: I know windows used 1.9.3, but it didn't work out of the box today so I fell back to ubuntu10.04-gems
[2012-05-16 02:32:02 -0400] hoover_damm: https://github.com/opscode/omnibus/tree/master/source
[2012-05-16 02:32:03 -0400] hoover_damm: hrm
[2012-05-16 02:32:11 -0400] hoover_damm: wonder when they'll switch to the 'new system' they keep talking about?
[2012-05-16 02:33:05 -0400] josephholsten: m4 macros?
[2012-05-16 02:33:40 -0400] hoover_damm: nah a little cha-cha
[2012-05-16 02:33:47 -0400] hoover_damm: release it as clojure, then re-write in ruby
[2012-05-16 02:34:04 -0400] hoover_damm: and close any pull requests on the clojure one ;)
[2012-05-16 02:35:06 -0400] josephholsten: my engineers would vote to switch to maven
[2012-05-16 02:35:46 -0400] josephholsten: they worry me
[2012-05-16 02:35:52 -0400] hoover_damm: nah actually ruby makes sense
[2012-05-16 02:35:58 -0400] mlei: noooo not maven
[2012-05-16 02:36:01 -0400] hoover_damm: i've written what they wrote (in much cleaner ways)
[2012-05-16 02:36:21 -0400] hoover_damm: I really will be quiet on both clojure and ruby because there's clearly creeping featureitis in there
[2012-05-16 02:36:40 -0400] mlei: okay actually i like nexus, what i really hate is the cavalier attitude that people have about stuff being available in central
[2012-05-16 02:36:40 -0400] hoover_damm: both seem insanely bloated for the job.  Makes a RVM Gemset seem palletable which is chokeable
[2012-05-16 02:37:34 -0400] josephholsten: hoover_damm: check out bundler 1.1's --standalone flag. It's lovely
[2012-05-16 02:37:59 -0400] mlei: which goes back i suppose to the "nothing from an upstream internet service" thing we were talking about just now
[2012-05-16 02:38:23 -0400] josephholsten: unpacks all the gems into a single directory, then creates a single file to require, which then sets up the load path.
[2012-05-16 02:38:39 -0400] hoover_damm: josephholsten, may you use chef in bash... https://github.com/engineyard/sous_chef
[2012-05-16 02:38:46 -0400] hoover_damm: that is my curse to you
[2012-05-16 02:39:03 -0400] hoover_damm: yes that's part of what wrote my ruby tarballs
[2012-05-16 02:39:38 -0400] hoover_damm: really old code, still works.
[2012-05-16 02:40:23 -0400] josephholsten: um, I've already lived through sorcerer linux and wayne seguin's bdsm
[2012-05-16 02:40:47 -0400] hoover_damm: yeah he was my last boss when i worked for engine yard
[2012-05-16 02:41:04 -0400] hoover_damm: I still haven't gotten up the balls to look for a FT job really.
[2012-05-16 02:41:11 -0400] josephholsten: the entire point of bundler standalone is to release you from the tarball + yaml within a tarball
[2012-05-16 02:41:47 -0400] hoover_damm: sounds like a gem bundle packaged
[2012-05-16 02:41:51 -0400] hoover_damm: with a manifest
[2012-05-16 02:42:02 -0400] josephholsten: ooh, I should really go to seatle.rb tonight and poke at the rubygems maintainers
[2012-05-16 02:42:27 -0400] hoover_damm: btw it's sm now... not bdsm
[2012-05-16 02:42:34 -0400] hoover_damm: not sure it's going far
[2012-05-16 02:43:17 -0400] hoover_damm: and I don't love bash enough to do that anymore
[2012-05-16 02:44:00 -0400] josephholsten: it's similar to a gem bundle, but it unrolls all the gems and the manifest is actually a lovely script. no need to have either bundler or _rubygems_ at all on the box
[2012-05-16 02:44:37 -0400] hoover_damm: on simple items I imagine that's true.
[2012-05-16 02:44:45 -0400] hoover_damm: more complex rails monolithic poo apps
[2012-05-16 02:44:47 -0400] hoover_damm: i doubt that would work
[2012-05-16 02:45:14 -0400] hoover_damm: bad requires and other things
[2012-05-16 02:45:28 -0400] josephholsten: works fine. it's annoying for things with compiled extensions.
[2012-05-16 02:46:08 -0400] josephholsten: really, all ruby gems is doing underneath is modifying the load path. this just does it obviously and all in one place.
[2012-05-16 02:46:13 -0400] hoover_damm: I was thinking hardcoded monkeypatches
[2012-05-16 02:46:15 -0400] hoover_damm: and load path manipulation
[2012-05-16 02:47:03 -0400] hoover_damm: authlogic is a great gem to break bundler and other things
[2012-05-16 02:48:13 -0400] hoover_damm: https://github.com/binarylogic/authlogic/blob/master/lib/authlogic.rb#L62
[2012-05-16 02:49:50 -0400] josephholsten: at least they didn't `$:<< File.expand_path '../authlogic', __FILE__
[2012-05-16 02:50:52 -0400] josephholsten: I worked on a project with that kind of thing.
[2012-05-16 02:52:13 -0400] josephholsten: you'd have `require 'foo/bar'` here and `require 'boo'` there, and it would get loaded twice because it found it at two different places in the load path
[2012-05-16 02:59:39 -0400] hoover_damm: yup
[2012-05-16 02:59:51 -0400] hoover_damm: and require 'rubygems' everywhere
[2012-05-16 04:11:07 -0400] sparc_: is this Central for ChefConf?
[2012-05-16 04:11:20 -0400] sparc_: i saw the party started in the lobby already
[2012-05-16 04:14:47 -0400] dangerdave: I be hanging in Seattle instead
[2012-05-16 04:17:42 -0400] sparc_: word
[2012-05-16 04:18:15 -0400] sparc_: oh, like the city
[2012-05-16 04:18:16 -0400] sparc_: haha
[2012-05-16 04:19:29 -0400] sparc_: At the registration desk, I overheard someone from Opscode talking about Jesse Robin's reservations
[2012-05-16 04:19:48 -0400] sparc_: he gets the super-presidential suite!
[2012-05-16 04:20:01 -0400] sparc_: can i be a groupie?  i bring champagne
[2012-05-16 04:20:03 -0400] sparc_: hehe
[2012-05-16 04:23:01 -0400] sparc_: although i hear Patrick DuBois has a posse this year
[2012-05-16 04:23:19 -0400] sparc_: all right no more rambling from me,  you all can keep on-topic :p
[2012-05-16 07:04:18 -0400] alex88: morning everyone, i've added a role web server, that calls the nginx recipe, now with vagrant this is the output: http://pastebin.com/RbhrJ8TV
[2012-05-16 07:06:56 -0400] alex88: i can't see any reference to my own code
[2012-05-16 07:18:08 -0400] cwj: cant be sure but i might have drank too much
[2012-05-16 07:18:35 -0400] cwj: alex88: whats in /tmp/vagrant-chef-1/chef-stacktrace.out
[2012-05-16 07:19:41 -0400] alex88: cwj, nothing, btw, seems to be some error in my code, i reverted back to recipe nginx and it works, now trying to setup a web server role. how was the meeting?
[2012-05-16 07:22:47 -0400] alex88: cwj, http://pastebin.com/Hu0H3dx4 passing from recipe to role trigger that error
[2012-05-16 07:24:24 -0400] vdvluc: so it's not possible to use node attributes in an attributes file? I get:  NoMethodError: undefined method `[]' for nil:NilClass
[2012-05-16 07:26:39 -0400] specialsauce: no, that's not possible
[2012-05-16 07:26:52 -0400] vdvluc: ok
[2012-05-16 07:26:57 -0400] vdvluc: thanks
[2012-05-16 07:50:23 -0400] miah: so much haxing
[2012-05-16 08:53:38 -0400] KarlFreeman: I'm looking at configuring ufw on Ubuntu however see that there is both a ufw and firewall cookbook. Which one is the correct one to use?
[2012-05-16 09:11:37 -0400] gale: KarlFreeman: the firewall cookbook is the under development it's probably going to be the one to use going forward however it is under development so if the ufw is stable maybe that one for now
[2012-05-16 09:12:06 -0400] KarlFreeman: gale: thanks for that. Was kinda thinking that the ufw seemed more stable
[2012-05-16 09:12:41 -0400] gale: KarlFreeman: as ufw is looked after by opscode it's likely to be fairly stable so yes I'd go with that
[2012-05-16 09:39:52 -0400] bip: Gaah, can't seem to use the node name in my recipe: node[:nginx][:node.name][:services].each complains about: FATAL: NoMethodError: undefined method `name' for :node:Symbol
[2012-05-16 09:41:10 -0400] Leth`: I have my database and frontend on separate nodes. how do I share the frontend DB password between them?
[2012-05-16 09:41:40 -0400] Leth`: in order to set up the database permissions and the frontend config
[2012-05-16 09:41:57 -0400] Leth`: I can't work out if data bags are the right thing to use
[2012-05-16 09:42:10 -0400] Leth`: or if there's some way of accessing other node attributes
[2012-05-16 09:42:17 -0400] gale: use an encrypted database will work
[2012-05-16 09:42:35 -0400] gale: or putting the password in a role attribute and sharing the role between the boxes
[2012-05-16 09:42:46 -0400] gale: encrypted databg
[2012-05-16 09:43:17 -0400] Leth`: ok, thanks
[2012-05-16 09:43:44 -0400] gale: you can use an unencrypted databag as well if you're brave
[2012-05-16 09:44:08 -0400] gale: what you should do is try and set the password in the databag from one node and pick it up on the other
[2012-05-16 09:44:18 -0400] gale: my typing today
[2012-05-16 09:44:26 -0400] gale: what you shouldn't do
[2012-05-16 09:44:37 -0400] Leth`: aha I could use search in the recepie to find the frontend node
[2012-05-16 09:44:48 -0400] ukio: ohai chefs!
[2012-05-16 09:47:31 -0400] gale: I've saved the password back to the databag before when I ran out of ideas but it's not a good idea as you need to make the chef client the db server connects as an admin
[2012-05-16 09:48:00 -0400] bip: No one knows how to use the node name from within a recipe?
[2012-05-16 09:48:37 -0400] Leth`: bip: try node[:nginx][node.name][:services]
[2012-05-16 09:48:57 -0400] Leth`: slight typo
[2012-05-16 09:50:03 -0400] bip: NoMethodError: undefined method `[]' for nil:NilClass
[2012-05-16 09:53:45 -0400] ukio: dows anybody know how to install chef-server on ubuntu 12.04?
[2012-05-16 09:54:03 -0400] Leth`: ukio: just did it. what's the problem?
[2012-05-16 09:54:41 -0400] ukio: i can install chef 0.10.8 via apt-get, but chef 0.10.10 is not available yet in the apt.opscode.com repo
[2012-05-16 09:54:46 -0400] Leth`: bip: one of this is Nil (null): node[:nginx] or node[:nginx][node.name]
[2012-05-16 09:55:39 -0400] bip: Leth`: It's [node.name]
[2012-05-16 09:56:12 -0400] Leth`: ukio: ah I dunno about that. You can install the newer version of the gem via `gem` but that might not be what you want
[2012-05-16 09:57:46 -0400] ukio: Leth`: ok, thanks. I will use the 0.10.8 installation and try to update the gems for now...
[2012-05-16 09:58:12 -0400] ukio: or should I use the new omnibus installer instead? or is it only for installing client nodes?
[2012-05-16 09:58:18 -0400] bip: Leth`: Found it. I got bitten by the "rake install"-doesn't-update-environment problem
[2012-05-16 09:58:29 -0400] Leth`: ah
[2012-05-16 09:58:52 -0400] Leth`: ukio: to be honest I have no idea, i'm a a complete beginner
[2012-05-16 09:59:05 -0400] rrgeens: ukio: I've just installed it using the chef-solo method mentioned on the wiki
[2012-05-16 09:59:19 -0400] Leth`: i have more experience writing recipes than managing chef so far
[2012-05-16 10:01:57 -0400] ukio: rrgreens: ok, maybe i will try that as weel
[2012-05-16 10:03:14 -0400] ukio: rrgreens: and this installs 0.10.10 for sure? i'm wondering because i did the chef-solo install some time ago but then http://s3.amazonaws.com/chef-solo/bootstrap-latest.tar.gz was still pointing to an older release
[2012-05-16 10:05:36 -0400] rrgeens: ukio: it's reporting as 0.10.10 in the web ui
[2012-05-16 10:06:26 -0400] ukio: rrgreens: ok cool, thanks!
[2012-05-16 10:06:54 -0400] rrgeens: you're welcome :-)
[2012-05-16 10:35:01 -0400] KernelPanik: Hi guys! I have to do some tests in my machine.. Is is managed my chef, for temporarily disable chef-client.. Have I comment the entrie in crontab ?
[2012-05-16 10:36:54 -0400] specialsauce: KernelPanik, If you run it via cron then yes just comment out the lin in cron, or stop the chef-client daemon if yu are using it daemonised.  Alternatively you could stop the API service on the server if you want to stop any chef client from connecting.
[2012-05-16 10:58:22 -0400] louisg: private chef question: does the API expose a REST interface for organisations?
[2012-05-16 10:58:54 -0400] ashb: no - organisations are only on the opscode platform
[2012-05-16 11:01:41 -0400] louisg: ashb: they're also available on private chef - http://www.opscode.com/private-chef/ - which we're using
[2012-05-16 11:02:00 -0400] ashb: oh didn't realise that was a thing - sorry
[2012-05-16 11:03:50 -0400] Axsuul: What is a good way to check if a process is running? For example, I need to run /etc/init.d/elasticsearch start if it's not running
[2012-05-16 11:05:42 -0400] sampikesley: um, ps?
[2012-05-16 11:07:04 -0400] ashb: or /etc/init.d/elasticsearch status
[2012-05-16 13:03:00 -0400] geekbri: I seem to be unable to use the [] method to access the attributes of a Chef::Node object... anybody here happen to be knowledgable about how to extract an attribute from a Chef::Node object
[2012-05-16 13:07:27 -0400] geekbri: ok well, i ended up using construct_attributes instead to get a Chef::Node::Attribute object... I'll just use that.
[2012-05-16 13:11:11 -0400] yfeldblum: geekbri, what are you trying to do overall?
[2012-05-16 13:11:40 -0400] geekbri: yfeldblum: I have a Chef::Node object and I'm just trying to extract the ec2 attribute hash.  I can't seem to use the [] method though.  I tried my_node_object[:ec2] but it sure doesn't like that.
[2012-05-16 13:13:04 -0400] yfeldblum: geekbri, are you sure it exists? Chef::Log.info(node.to_hash.inspect)
[2012-05-16 13:13:50 -0400] geekbri: yfeldblum: "ec2"=>{"ami_id"=>"ami-99b179f0",   </snip>
[2012-05-16 13:18:23 -0400] geekbri: yfeldblum: I tried doing something to the effect of     blah = node.to_hash   then  blah['ec2'] but it comes back nil for some reason.
[2012-05-16 13:18:55 -0400] geekbri: yfeldblum: I can however iterate over the object with .each and print out the keys and values......
[2012-05-16 13:22:56 -0400] geekbri: whatever, ill figure it out, thanks for nudging me in a good direction.  I should have thought to use to_hash already.
[2012-05-16 13:39:45 -0400] ssd7: geekbri: WHat doesn't it like about the [] method?
[2012-05-16 13:41:05 -0400] geekbri: ssd7: I seem to have sorted it out and [] is working now.  I'm not sure exactly why it was barfing on it earlier
[2012-05-16 13:41:19 -0400] ssd7: geekbri: Ahh cool.
[2012-05-16 13:42:07 -0400] geekbri: ssd7: nodes[1]['ec2']['instance_id'] seems to be working now (where nodes happens to be an array of nodes)
[2012-05-16 13:42:59 -0400] geekbri: Now im just frustrated that other plugins use confirm(), which as far as I can tell there is no way to bypass with an automatic yes :-P
[2012-05-16 13:43:30 -0400] geekbri: unless of course, the plugin author explicity adds a --yes command line flag.
[2012-05-16 13:44:57 -0400] geekbri: since then you can just populate the config[] of that plugin.
[2012-05-16 13:45:25 -0400] ssd7: geekbri: Anything that uses confirm() should respect --yes since that option is available for every command
[2012-05-16 13:45:55 -0400] geekbri: ssd7: really? I must have missed that when digging through the source... you just saved me so much work... I owe you a cask of beer
[2012-05-16 13:46:16 -0400] geekbri: ssd7: do you happen to know if its config[] name is :yes ?
[2012-05-16 13:46:33 -0400] ssd7: geekbri: yup, it should just be :yes
[2012-05-16 13:46:42 -0400] geekbri: ssd7: excellent
[2012-05-16 13:48:25 -0400] UForgotten: if I wanted to copy all files in a directory, but want it to do it relative to a cookbook, is there a safe/easy way to do that?  i.e. copy all files in a cookbook to the local node without having to define them all?  Someone wrote a recipe that runs a script to do it but if the cookbook's physical location ever moves it breaks of course.  Would like to leverage chef properly to do this.
[2012-05-16 13:49:49 -0400] ssd7: UForgotten: Will the remote_directory resource do what you want? http://wiki.opscode.com/display/chef/Resources#Resources-RemoteDirectory
[2012-05-16 13:50:24 -0400] UForgotten: ssd7: possibly, will look at that! Thanks.
[2012-05-16 13:52:47 -0400] mosez: should my debian reboot cookbook interesting for somebody? =)
[2012-05-16 13:53:27 -0400] geekbri: mosez: what does it do?  I'm sure it will be interesting to somebody!
[2012-05-16 13:54:25 -0400] mosez: it defines a handler with the help of chef_handler cookbook and a provider to initialize a reboot aber successfull chef client run.
[2012-05-16 13:55:26 -0400] mosez: it also reboots automaticly if the file /var/run/reboot-required exists, if it is enabled.
[2012-05-16 13:56:09 -0400] mosez: geekbri: i need this cookbook to reboot my server into newly installed kernel like the one for openvz.
[2012-05-16 13:56:24 -0400] geekbri: Can't hurt to put it up, im sure somebody can use it.
[2012-05-16 13:57:16 -0400] mosez: ha... i think i've got to add something like a fact too, so that i can check for requested reboot within other recipes...
[2012-05-16 14:01:20 -0400] rh1n0: So im trying out knife-github-cookbooks and every time i use it my cookbooks dir gets deleted. I have the cookbooks dir set via the absolute path in knife.rb - any ideas?
[2012-05-16 14:03:18 -0400] rh1n0: https://gist.github.com/8c2facd2d60b54392f27
[2012-05-16 14:03:52 -0400] rh1n0: the cookbooks dir was present before i ran the command
[2012-05-16 14:21:47 -0400] makerbreaker_spy: every 2 weeks or so, I have to do this:  http://makerbreaker.com/blog/2012/04/10/chef-server-webui/
[2012-05-16 14:22:17 -0400] makerbreaker_spy: any idea what is going on, or how to trouble shoot this?  The webui -> status breaks
[2012-05-16 14:23:18 -0400] rh1n0: makerbreaker_spy: I havent seen this on ubuntu lucid. Perhaps its something with 11.10?
[2012-05-16 14:24:08 -0400] makerbreaker_spy: k, Im going to do a release upgrade, and see if this solves it
[2012-05-16 14:42:31 -0400] ukio: hey guys, is there an easy way to uprade chef server 0.10.8 (installed via apt on ubuntu precise) to 0.10.10?
[2012-05-16 14:46:10 -0400] ukio: it doesn't seem to be installed as a gem, so i don't know what to upgrade...
[2012-05-16 14:53:01 -0400] ukio: hmmm looks like chef-server is not installed as a gem, but rather unpacked to  "/usr/lib/ruby/vendor_ruby"
[2012-05-16 14:53:35 -0400] ukio: i have no idea how to update that for chef 0.10.10 :-/
[2012-05-16 14:59:33 -0400] flashmanbahadur: damnt
[2012-05-16 14:59:42 -0400] flashmanbahadur: its 60 pounds per year to register andrew.sh
[2012-05-16 15:02:47 -0400] geekbri: damn
[2012-05-16 15:20:31 -0400] makerbreaker_spy: man. the release upgrade broke chef
[2012-05-16 16:03:31 -0400] gale: so happy chefconf is being streamed
[2012-05-16 16:04:07 -0400] thehar:  #chefconf as well
[2012-05-16 16:09:28 -0400] geekbri: oh man the video and audio are out of sync for me... hate when that happens.
[2012-05-16 16:16:22 -0400] gp5st: hello, so chef-expander is running, but i'm still getting connection errors with solr when i do a knife command like knife winrm machine cmd
[2012-05-16 16:16:31 -0400] gp5st: and i'm realy not sure what i need to be doing
[2012-05-16 16:17:13 -0400] gp5st: http://pastebin.com/XNULbEVP is the expander processes running
[2012-05-16 16:17:48 -0400] gp5st: http://pastebin.com/5jTjQUGg is the error i'm getting
[2012-05-16 16:19:37 -0400] gp5st: there aren't any processes running on port 8983
[2012-05-16 16:21:45 -0400] alindeman: So, what should I cook for dinner? :P
[2012-05-16 16:21:56 -0400] thehar: pasta with bacon
[2012-05-16 16:21:56 -0400] geekbri: do you know how to cook?
[2012-05-16 16:22:10 -0400] alindeman: :)
[2012-05-16 16:22:12 -0400] yfeldblum: bacon with pasta
[2012-05-16 16:22:14 -0400] Blackavar: Vegetarian bacon?
[2012-05-16 16:22:17 -0400] thehar: sure!
[2012-05-16 16:22:18 -0400] yfeldblum: pasta made from bacon
[2012-05-16 16:22:23 -0400] thehar: oh god yes
[2012-05-16 16:22:28 -0400] lusis: carbonara
[2012-05-16 16:22:30 -0400] lusis: ;)
[2012-05-16 16:22:35 -0400] lusis: best thing evar
[2012-05-16 16:22:41 -0400] geekbri: I thought cotton was the fabric of our lives.
[2012-05-16 16:22:50 -0400] lusis: nope
[2012-05-16 16:22:50 -0400] Blackavar: Hmmmm?bacon in the dough?
[2012-05-16 16:22:51 -0400] lusis: bacon
[2012-05-16 16:22:59 -0400] thehar: the dough is bacon
[2012-05-16 16:24:21 -0400] hoover_damm: or is the dough the bacon?
[2012-05-16 16:24:31 -0400] Blackavar: Hard to get it through the pasta machine, likely.
[2012-05-16 16:24:52 -0400] Blackavar: Bacon/pork ravioli recipe, *ponder*
[2012-05-16 16:24:56 -0400] hoover_damm: nah
[2012-05-16 16:25:13 -0400] hoover_damm: crumble up the bacon, mix it with the pork
[2012-05-16 16:25:19 -0400] hoover_damm: turn it into a ravioli
[2012-05-16 16:25:36 -0400] Blackavar: That's what that is, basically.
[2012-05-16 16:26:34 -0400] hoover_damm: bacon and egg? man I was hungry
[2012-05-16 16:26:39 -0400] hoover_damm: not sure now
[2012-05-16 16:29:50 -0400] geekbri: I signed the CLA, I got a pull request merged.. I didn't get a packet of stickets!
[2012-05-16 16:29:54 -0400] geekbri: stickers!
[2012-05-16 16:30:55 -0400] hoover_damm: It's not about the stickers geekbri it's about the other random stuff you get
[2012-05-16 16:31:27 -0400] geekbri: I think its about the stickers.
[2012-05-16 16:32:14 -0400] gp5st: ok, well, now i've got it to solr/jetty giving me a 404...some progress at least
[2012-05-16 16:35:34 -0400] hoover_damm: geekbri, when you get something in the mail the first time that's not a sticker... smile
[2012-05-16 16:35:52 -0400] hoover_damm: stackoverflow just sent out a bunch of pretties
[2012-05-16 16:36:13 -0400] hoover_damm: Opscode sent out some awesome jack-of-all-trade knives
[2012-05-16 16:36:16 -0400] hoover_damm: awhile back
[2012-05-16 16:38:16 -0400] miah: tshirts just end up in my 'pile of bed shirts' or 'goodwill' =)
[2012-05-16 16:38:17 -0400] LinuxHorn: anyone have an example of how to set a user's password with the opscode users cookbook?  i've create a password hash to put in the users json file for the databag, but trying to figure out how to have chef set the password to what's in the hash
[2012-05-16 16:38:57 -0400] alindeman: LinuxHorn: Check out the user resource: http://wiki.opscode.com/display/chef/Resources#Resources-User
[2012-05-16 16:39:12 -0400] LinuxHorn: thx alindeman, looking now
[2012-05-16 16:41:06 -0400] LinuxHorn: hmmmm, so i see what you are pointing at alindeman, but new to chef/ruby, how do i call the password attribute from the users databag to actually set the password?
[2012-05-16 16:44:34 -0400] LinuxHorn: more specifically, does the users cookbook support setting a password for a user?
[2012-05-16 16:45:01 -0400] alindeman: Yep, with the password parameter
[2012-05-16 16:45:15 -0400] alindeman: See http://wiki.opscode.com/display/chef/Data+Bags for using a data bag in a recipe
[2012-05-16 16:45:32 -0400] cwj: Linuxhorn: the user resource supports it and there is a ticket open about adding password management to the users cookbook
[2012-05-16 16:45:33 -0400] alindeman: "A more complete example" should actually get you pretty close to what you want with users
[2012-05-16 16:45:53 -0400] paulmooring: LinuxHorn: The users resource supports passwords, but I don't believe it's in the cookbook right now
[2012-05-16 16:46:01 -0400] cwj: I have some code for the ticket which I have yet to submit, let me find it
[2012-05-16 16:47:09 -0400] alindeman: Oh, I got the users resource confused with the users cookbook. Didn't know that's what you were getting at LinuxHorn, sorry
[2012-05-16 16:47:32 -0400] LinuxHorn: right alindeman :)  want it to all happen within the users cookbook
[2012-05-16 16:47:37 -0400] cwj: https://github.com/needle/chef-opscode-users/tree/COOK-937
[2012-05-16 16:47:37 -0400] hoover_damm: LinuxHorn, it attempts to set the password with ruby-shadow
[2012-05-16 16:47:55 -0400] hoover_damm: LinuxHorn, generally I give that password to the user resource as the crypted string
[2012-05-16 16:48:00 -0400] hoover_damm: instead of telling it what password I want
[2012-05-16 16:49:10 -0400] LinuxHorn: hoover_damm: i just created the password hash from cli by hand, figured that was the most secure way for me to do it before putting it in the user's databag
[2012-05-16 16:49:31 -0400] hoover_damm: LinuxHorn, https://gist.github.com/ad3ccbbbe6627c3fae69
[2012-05-16 16:50:03 -0400] hoover_damm: that's what I do
[2012-05-16 16:50:22 -0400] ghatak: Hi, are there any recommended books for Chef? I am looking for something that can quickly get me up and running...
[2012-05-16 16:52:04 -0400] cwj: ghatak: not yet but I think there will be an oreilly book out in the next year
[2012-05-16 16:52:24 -0400] LinuxHorn: cwj: i think that'll do it for me (stealing the lines of code from that commit)
[2012-05-16 16:52:26 -0400] LinuxHorn: You must have ruby-shadow installed for password support!
[2012-05-16 16:52:34 -0400] LinuxHorn: gotta install ruby-shadow first evidently :)
[2012-05-16 16:52:35 -0400] LinuxHorn: brb
[2012-05-16 16:53:27 -0400] ghatak: cwj: Ok thanks. So for now what are the options in the absence of text material
[2012-05-16 16:55:17 -0400] cwj: Linuxhorn: let me know how it works out, lack of testing is what's prevented me from submitting a pull request for that change
[2012-05-16 16:55:46 -0400] paulmooring: ghatak: The wiki on wiki.opscode.com has been the best place
[2012-05-16 16:55:58 -0400] cwj: ghatak: OpsCode has open sourced their training materials
[2012-05-16 16:56:05 -0400] paulmooring: The training materials from Opscode led trainings are also here https://github.com/opscode/chef-fundamentals
[2012-05-16 16:56:24 -0400] cwj: There you go
[2012-05-16 16:56:34 -0400] hoover_damm: LinuxHorn, that's why I install ruby-shadow in the bootstrap
[2012-05-16 16:56:39 -0400] cwj: This channel is usually pretty helpful as well
[2012-05-16 16:56:57 -0400] paulmooring: ghatak: and keep IRC open and ask a lot of questions we're mostly friendly in here :)
[2012-05-16 16:57:31 -0400] ghatak: Thank you
[2012-05-16 16:57:33 -0400] ghatak: :)
[2012-05-16 16:58:11 -0400] gp5st: when i do knife index rebuild, i still can't search for nodes that i've previously created. :-\
[2012-05-16 16:59:43 -0400] paulmooring: gp5st: like `knife node list` doesn't show them, or as in `knife node show $nodename` doesn't have the data?
[2012-05-16 17:02:37 -0400] cooper: cwj: does your commit to users cookbook not install ruby-shadow if it's not there already, thus not having to put it in the bootstrap as hoover_damm mentions? looking at https://github.com/needle/chef-opscode-users/commit/e9f1418a9d7e96e423e963a2ceb2ec8f6286b4ce
[2012-05-16 17:03:01 -0400] cwj: Perhaps your chef-expander process isnt running?
[2012-05-16 17:03:22 -0400] cwj: Cooper: that's the idea yah
[2012-05-16 17:03:34 -0400] cwj: Some systems don't need the gem, they
[2012-05-16 17:03:55 -0400] cwj: Have it built into t
[2012-05-16 17:04:10 -0400] cwj: Too easy to hit enter today :)
[2012-05-16 17:04:16 -0400] cooper: cwj; lol
[2012-05-16 17:04:25 -0400] cooper: cwj: i was wodering ;)
[2012-05-16 17:04:42 -0400] cwj: I'm on my iPad so I'm a bit handicapped
[2012-05-16 17:05:03 -0400] UForgotten: so, I'm using spheromak sysctl cookbook. I want it to save backups of the sysctl files it overwrites. is there a chef system call that does the backups like when a template is written?
[2012-05-16 17:06:17 -0400] cwj: Chef does make backups by default, but I don't think ou can control where they are stored
[2012-05-16 17:06:34 -0400] hoover_damm: cooper, mine doesn't install it either.
[2012-05-16 17:06:43 -0400] hoover_damm: cooper, but I use omnibus / prebaked images that have it installed
[2012-05-16 17:07:01 -0400] hoover_damm: I got tired of failure
[2012-05-16 17:08:08 -0400] UForgotten: cwj: how would it know to create a backup unless it was coded to do so?
[2012-05-16 17:10:33 -0400] cwj: The providers for template and a few other resources are programmed to make backups of the files they replace
[2012-05-16 17:10:49 -0400] cooper: cwj: thanks for the info!
[2012-05-16 17:10:56 -0400] UForgotten: the way this provider works is that it creates a file object and then posts to the file.content method
[2012-05-16 17:11:06 -0400] cooper: hoover_damm: are you saying omnibus installs ruby-shadow?
[2012-05-16 17:11:10 -0400] UForgotten: but I dont see any backups when it replaces. I'll do some more experiments. with verbose up higher
[2012-05-16 17:11:42 -0400] cooper: i'm looking to do what LinuxHorn is doing re: adding users & passwords.
[2012-05-16 17:16:14 -0400] dunniganp: I'm new to chef  trying to use the nagios cookbook to set up a server. receiving the following error:
[2012-05-16 17:16:21 -0400] dunniganp: [Wed, 16 May 2012 16:59:34 +0000] ERROR: template[/etc/nagios3/conf.d/contacts.cfg] (/var/chef/cache/cookbooks/nagios/definitions/nagios_conf.rb:28:in `block in from_file') had an error:
[2012-05-16 17:16:21 -0400] dunniganp: Chef::Mixin::Template::TemplateError (undefined method `[]' for nil:NilClass) on line #29:
[2012-05-16 17:16:23 -0400] dunniganp:  27:   use          default-contact
[2012-05-16 17:16:24 -0400] dunniganp:  28:   contact_name <%= a['id'] %>
[2012-05-16 17:16:25 -0400] dunniganp:  29:   email        <%= a['nagios']['email'] %>
[2012-05-16 17:16:26 -0400] dunniganp:  30: }
[2012-05-16 17:16:27 -0400] dunniganp:  31:
[2012-05-16 17:16:33 -0400] UForgotten: dunniganp: use pastebin please
[2012-05-16 17:16:36 -0400] dunniganp: k
[2012-05-16 17:17:14 -0400] dunniganp: I've poked around and but not sure where I need to correct this.
[2012-05-16 17:17:16 -0400] LinuxHorn: cwj: it does seems like it should install ruby-shadow by default, but it's not
[2012-05-16 17:17:25 -0400] UForgotten: dunniganp: are you passing the variable a to your template?
[2012-05-16 17:17:28 -0400] hoover_damm: cooper, it can be patched to include it
[2012-05-16 17:17:36 -0400] hoover_damm: cooper, but it doesn't include it by default
[2012-05-16 17:17:50 -0400] mosez: got somebody an example how i can write custom facts? i need a global function to check if a reboot within my provider is requested
[2012-05-16 17:17:59 -0400] LinuxHorn: oh wait cwj, seems to be working now
[2012-05-16 17:18:46 -0400] dunniganp: UForgotten: hmm, no. I would assume that would be part of the ?databag?
[2012-05-16 17:18:54 -0400] dunniganp: but don't see that setting there.
[2012-05-16 17:20:42 -0400] cwj: LinuxHorn: did it take two chef runs to work or something?
[2012-05-16 17:20:54 -0400] LinuxHorn: yep
[2012-05-16 17:20:59 -0400] cwj: hrm
[2012-05-16 17:21:00 -0400] LinuxHorn: failed first time, worked second
[2012-05-16 17:21:34 -0400] setient: i really need to finish setting up my chef environment
[2012-05-16 17:21:54 -0400] cwj: i feel like i tested that it worked first time but obviously theres room for improvement there
[2012-05-16 17:23:05 -0400] LinuxHorn: trying it on a newly bootstrapped server now cwj
[2012-05-16 17:23:40 -0400] LinuxHorn: yep, took two tries
[2012-05-16 17:23:44 -0400] cwj: ok
[2012-05-16 17:23:52 -0400] LinuxHorn: lemme bootstrap once more, get you a debug output of chef-client
[2012-05-16 17:24:06 -0400] LinuxHorn: this is ubuntu 10.04
[2012-05-16 17:24:53 -0400] cwj: i think i know what the problem is, 1sec
[2012-05-16 17:25:54 -0400] LinuxHorn: k
[2012-05-16 17:28:09 -0400] cwj: LinuxHorn: https://github.com/needle/chef-opscode-users/commit/7bce91c2c2a540f751b81ab9bd74026a8e3b0eab
[2012-05-16 17:28:21 -0400] cwj: try that
[2012-05-16 17:29:26 -0400] UForgotten: dunniganp: I've not worked with databags, but if the template that is crashing doesn't have 'a' passed in as a variable that variable doesn't exist in context.
[2012-05-16 17:31:49 -0400] dunniganp: UForgotten: here's a link to the template: https://github.com/opscode/cookbooks/blob/master/nagios/templates/default/contacts.cfg.erb. it's the a comes from <% @admins.each do |a| -%>
[2012-05-16 17:32:17 -0400] LinuxHorn: cwj: kicking a new cloud server with fresh image to test for you
[2012-05-16 17:32:23 -0400] UForgotten: ok so are admins and members passed in?
[2012-05-16 17:34:36 -0400] UForgotten: if its not your cookbook you may have to ask the cookbook authors.  I'm still a noob myself, so I'm only going to be able to suggest the common mistakes I've already made myself :)
[2012-05-16 17:35:21 -0400] SplasPood: hrm, anyone know if the keynote slide deck for ChefConf will be posted?
[2012-05-16 17:35:37 -0400] dunniganp: that's I believe where the data_bags come in. this is where it's set  https://github.com/opscode/velocity2011-chef-repo/blob/master/data_bags/users/nagiosadmin.json
[2012-05-16 17:36:00 -0400] dunniganp: so, the question for me is  where is @admins set
[2012-05-16 17:36:12 -0400] coderanger: SplasPood: Probably after the conference ends and everyone has time to breathe again
[2012-05-16 17:36:14 -0400] coderanger: SplasPood: Watch the opscode account on slideshare
[2012-05-16 17:36:42 -0400] SplasPood: coderanger: will do, thanks
[2012-05-16 17:37:06 -0400] UForgotten: dunniganp: it should be passed as a variable to that template
[2012-05-16 17:37:22 -0400] UForgotten: so whatever recipe calls that template should have a variables line
[2012-05-16 17:43:50 -0400] geekbri: miah: most of the tshirts i get end up in my bedshirt pile as well.
[2012-05-16 17:44:05 -0400] geekbri: now stickers... those I make plenty of use of!
[2012-05-16 17:45:27 -0400] geekbri: ding!
[2012-05-16 17:45:36 -0400] geekbri: also its easier to ask for forgiveness than it is to ask for permission
[2012-05-16 17:45:52 -0400] matschaffer: also true
[2012-05-16 17:47:29 -0400] UForgotten: eherot: defends on the definition of decorate.
[2012-05-16 17:47:35 -0400] UForgotten: and if the macbook is company property
[2012-05-16 17:47:42 -0400] Wireless: in this job market, employers shouldn't be concerned with decorations on a laptop
[2012-05-16 17:47:42 -0400] UForgotten: defacing company property = bad
[2012-05-16 17:47:51 -0400] eherot: Stickers.  And yes.
[2012-05-16 17:48:01 -0400] eherot: It's even got a company sticker on the bottom
[2012-05-16 17:48:06 -0400] geekbri: if your company is going to make a big stink over a bunch of stickers on your laptop, youre probably in bad shape.
[2012-05-16 17:48:12 -0400] KarlHungus: getting fired for stickers on a laptop would be great
[2012-05-16 17:48:28 -0400] KarlHungus: because that means you should have quit a long time ago
[2012-05-16 17:48:31 -0400] eherot: geekbri: yeah I don't think they'd care, but I'm a sysop and it might set a bad example ;-)
[2012-05-16 17:48:41 -0400] geekbri: psh example schmaple.
[2012-05-16 17:48:46 -0400] geekbri: ;)
[2012-05-16 17:49:03 -0400] geekbri: I put stickers on everything
[2012-05-16 17:49:08 -0400] geekbri: fans, monitors, laptops, water bottles
[2012-05-16 17:49:09 -0400] Wireless: no need to work for companies with restrictive culture
[2012-05-16 17:49:14 -0400] eherot: heh, there are worse stickers i could put on there than the one for our config management system
[2012-05-16 17:49:30 -0400] UForgotten: which is chef presumably? ;)
[2012-05-16 17:49:39 -0400] eherot: maybe I could get a few and stick them to the kegerator.
[2012-05-16 17:49:51 -0400] LinuxHorn: i'm back cwj
[2012-05-16 17:50:01 -0400] KarlHungus: you can put them anywhere in my office as long as it isn't the surface of the ping pong table ;)
[2012-05-16 17:50:02 -0400] LinuxHorn: but that change didn't seem to help
[2012-05-16 17:50:24 -0400] cwj: can you gist me the failure?
[2012-05-16 17:50:34 -0400] eherot: KarlHungus: the viewing surface of the screen also isn't very popular.
[2012-05-16 17:50:51 -0400] KarlHungus: eherot: hey, thats your problem if you want stickers on your monitor =)
[2012-05-16 17:51:10 -0400] KarlHungus: i wont get upset unless your productivity drops
[2012-05-16 17:51:13 -0400] geekbri: haha, i meant on the base of the monitor
[2012-05-16 17:51:18 -0400] upgrayedd: LOL karl's name
[2012-05-16 17:51:20 -0400] geekbri: it would be pretty awesome to stick it right in the middle of the screen though
[2012-05-16 17:51:27 -0400] cwj: Logjammin'
[2012-05-16 17:51:42 -0400] upgrayedd: it's funny because i know where that's from but until now i never caught the inuendo
[2012-05-16 17:51:45 -0400] eherot: geekbri: on the inside surface of one of those iMac screens with the removable glass
[2012-05-16 17:51:46 -0400] LinuxHorn: cwj: https://gist.github.com/538dc0189c31d62caa1d
[2012-05-16 17:54:11 -0400] cwj: LinuxHorn: ok thanks, i'll look at it after this talk
[2012-05-16 17:56:04 -0400] gp5st: hello, why wouldn't chef add a node i create to the search index?
[2012-05-16 17:56:38 -0400] LinuxHorn: np cwj
[2012-05-16 17:59:26 -0400] makerbreaker_spy: by chefwebui is working intermintently, and chef-expander/solr seems to be running but is not functioning correctly
[2012-05-16 17:59:46 -0400] makerbreaker_spy: knife index rebuild -y
[2012-05-16 17:59:46 -0400] makerbreaker_spy: ERROR: Server returned error for
[2012-05-16 18:00:09 -0400] makerbreaker_spy: I dont see much in the logs, (expander.log is totally empty), the services all seem to be running
[2012-05-16 18:00:23 -0400] jtimberman: btw if you're at ChefConf, /join #chefconf
[2012-05-16 18:00:26 -0400] shuvo: ohai chefs, I want to sign the CLA too and get a bunch of tshirts, stickers and other stuff for free in return. cool?
[2012-05-16 18:02:06 -0400] geekbri: I desire these stickers.
[2012-05-16 18:03:24 -0400] LinuxHorn: stickers?
[2012-05-16 18:04:23 -0400] jespada_: ssd7, hi, any news regarding knife bootsrap (default) on chef 0.10.10 ?
[2012-05-16 18:05:58 -0400] ssd7: jespada_: Are you refering to the chef-full bootstrap still installing 0.10.8?
[2012-05-16 18:06:29 -0400] jespada_: ssd7, yes
[2012-05-16 18:07:53 -0400] ssd7: It is a known issue.  Basically we haven't been able to build the omnibus packages yet.
[2012-05-16 18:08:09 -0400] jespada_: ssd7, thanks :)
[2012-05-16 18:11:29 -0400] cwj: LinuxHorn: are these test systems running chef 0.10.10?
[2012-05-16 18:12:19 -0400] cwj: if so, i think you should try changing gem_package 'ruby-shadow' to chef_gem 'ruby-shadow'
[2012-05-16 18:12:30 -0400] LinuxHorn: cwj: hosted chef, shich i believe is 10.10
[2012-05-16 18:12:50 -0400] cwj: well in this case i am asking about the client version
[2012-05-16 18:13:14 -0400] LinuxHorn: checking
[2012-05-16 18:13:52 -0400] geekbri: re: gem_package vs chef_gem.   One installs to the system ruby the other installs to chef omnibus gems?
[2012-05-16 18:14:00 -0400] cwj: yeah
[2012-05-16 18:14:06 -0400] tarrant: Will there be recordings for chefconf? Looks like I might miss a few sessions tomorrow that I'm intrested in.
[2012-05-16 18:14:16 -0400] LinuxHorn: root@nagios:~# chef-client -v
[2012-05-16 18:14:16 -0400] LinuxHorn: Chef: 0.10.8
[2012-05-16 18:14:20 -0400] cwj: LinuxHorn: ok
[2012-05-16 18:14:24 -0400] sabooky: So I've run into this situation on a couple of occasions and I'm not 100% sure what the best way to solve it is.
[2012-05-16 18:14:34 -0400] cwj: tarrant: yeah they said all sessions will be recorded
[2012-05-16 18:14:43 -0400] sabooky: Say i have an array of hashes in my node hash
[2012-05-16 18:14:56 -0400] tarrant: cwj: awesome thanks.
[2012-05-16 18:15:23 -0400] sabooky: if i do node["lvm"]["lvms"].each do |lvm| do # stuff end
[2012-05-16 18:15:42 -0400] sabooky: if in my code I have conditionals "not_if" or "only_if" they don't seem to work because of variables being reused
[2012-05-16 18:15:54 -0400] shuvo: +1 tarrant
[2012-05-16 18:16:04 -0400] sabooky: seems that by the time the not_if/only_if is processed the variable can have a different value
[2012-05-16 18:16:21 -0400] sabooky: due to the loop, is there a good way to do this?
[2012-05-16 18:16:29 -0400] ssd7: sabooky: mind pasting the full block somewhere?
[2012-05-16 18:16:39 -0400] sabooky: sure, any good recommendations for pastebin?
[2012-05-16 18:16:54 -0400] ssd7: I like github's gists
[2012-05-16 18:17:10 -0400] ssd7: but whatever works for you
[2012-05-16 18:17:12 -0400] shuvo: sabooky, gist. however, you can have a counter in the resource name to make them uniq
[2012-05-16 18:18:34 -0400] sabooky: https://gist.github.com/ee5ce2ad85b7837be851
[2012-05-16 18:18:43 -0400] sabooky: line 47
[2012-05-16 18:18:54 -0400] flashmanbahadur: hey, does anyone have some best practices for using the aws cookbook to take snapshots of volumes
[2012-05-16 18:19:07 -0400] flashmanbahadur: I dont want it to snapshot every time chef-client runs
[2012-05-16 18:19:23 -0400] sabooky: That logic doesn't work, it creates a lost+found for elements that don't have it flagged as on.
[2012-05-16 18:19:28 -0400] flashmanbahadur: but I would like to leverage the aws cookbook :prune options instead of rewriting it in a cron job
[2012-05-16 18:19:41 -0400] sabooky: shuvo: could you give me an example of counter (example code or simple example)
[2012-05-16 18:21:41 -0400] yfeldblum: flashmanbahadur, are you saying you don't want the task to run during chef runs (you want to run it independently or have it cron'd or triggered externally or something), but you just like the syntax sugar that chef provides?
[2012-05-16 18:22:09 -0400] flashmanbahadur: yfeldblum: yes
[2012-05-16 18:22:12 -0400] flashmanbahadur: not really a great setup
[2012-05-16 18:22:19 -0400] flashmanbahadur: I have chef running every 30 minutes
[2012-05-16 18:22:27 -0400] flashmanbahadur: doesnt make sense to snapshot every 30 minutes obviously
[2012-05-16 18:22:52 -0400] flashmanbahadur: however chef already has the IAM creds to creating/snapshotting volumes and pruning old snapshots
[2012-05-16 18:23:01 -0400] flashmanbahadur: seems a waste to redo all of that, or move it out
[2012-05-16 18:23:14 -0400] flashmanbahadur: was wondering if I could set the cronjob to run something like
[2012-05-16 18:23:29 -0400] flashmanbahadur: chef-client once my_custom_attr="snapshot"
[2012-05-16 18:23:36 -0400] flashmanbahadur: so I can trigger a special block in chef
[2012-05-16 18:23:50 -0400] flashmanbahadur: I know its going against the chef way of things
[2012-05-16 18:24:02 -0400] flashmanbahadur: so I am curious how other people have solved the problem
[2012-05-16 18:24:22 -0400] sabooky: ssd7: Any idea why my code is failing, or how to best fix it?
[2012-05-16 18:24:49 -0400] yfeldblum: flashmanbahadur, forget the niceness of the syntax sugar and just drop a script with keys in it, perms set, and a cron job ...
[2012-05-16 18:24:56 -0400] macros: flashmanbahadur: I've been told a one-shot mode is coming
[2012-05-16 18:25:06 -0400] macros: There are hacks to make it work now
[2012-05-16 18:25:32 -0400] ssd7: sabooky: Yeah, looking at it now.  I can think of some hacky ways to make it work, but give me a few more minutes becuase the things I've though of so far are ugly
[2012-05-16 18:26:19 -0400] sabooky: ssd7: lol, ok fair enough. It seems like it would be a common situation, but wasn't abel to find much online
[2012-05-16 18:26:41 -0400] flashmanbahadur: fair enough, thanks
[2012-05-16 18:26:46 -0400] shuvo: @ssd7, I would be interested in your solution to sabooky's as well. I thought of turning each node[:osconfig][:lvs] into a resource and having a counter for the name to keep the conditionals "not_if" or "only_if" working as expected
[2012-05-16 18:27:27 -0400] shuvo: please let me know if my apporach is crappy as well :-D
[2012-05-16 18:31:24 -0400] sabooky: shuvo: I'm kind of a beginner when it comes to chef, when does one use resources vs just putting code out there?
[2012-05-16 18:31:45 -0400] sabooky: Is it a question of reusability?
[2012-05-16 18:33:11 -0400] shuvo: sabooky, I won't wing the answer as I'm kind of a beginner when it comes to chef myself. I share my thoughts on this channel and have the gurus take it apart. I wam waiting for @ssd7 and others to pick my latest proposal apart re your scenario :-D
[2012-05-16 18:33:34 -0400] shuvo: but your questions are good
[2012-05-16 18:34:07 -0400] paulmooring: sabooky: I think it's more conceptual, a resource is something you want to define state on
[2012-05-16 18:34:50 -0400] flashmanbahadur: hows chef-conf going?
[2012-05-16 18:34:54 -0400] paulmooring: it's better to make a resource that says "this file should exist" rather than raw code that checks and creates when needed
[2012-05-16 18:35:40 -0400] shuvo: flashmanbahadur, #chefconf :-)
[2012-05-16 18:35:48 -0400] flashmanbahadur: haha
[2012-05-16 18:36:19 -0400] sabooky: paulmooring: interesting.. if it's not too much effort.. could you point me at a good example of this usage (very much a learn by reading code type person)
[2012-05-16 18:36:33 -0400] shuvo: paulmooring, that's my understanding of resources as well and as you can see, sabooky wants to separate states per element in the list/dictionary (node[:osconfig][:lvs])
[2012-05-16 18:36:44 -0400] sabooky: paulmooring: I've yet to write a resource, so the concept is still new to me
[2012-05-16 18:37:04 -0400] shuvo: sabooky, http://wiki.opscode.com/display/chef/Resources
[2012-05-16 18:37:39 -0400] shuvo: sabooky, from there you look into https://github.com/opscode/chef/
[2012-05-16 18:40:02 -0400] sabooky: shuvo: so for your example, I'd need to create a resource and provider?
[2012-05-16 18:40:41 -0400] shuvo: sabooky, if you can try it out while others get back to you with their answers, yes
[2012-05-16 18:41:04 -0400] shuvo: your provider essentially does what the body of your loop does
[2012-05-16 18:42:00 -0400] shuvo: this can help: http://chrisadams.me.uk/2010/05/07/notes-on-chef-understanding-resources-and-providers/
[2012-05-16 18:42:03 -0400] sabooky: shuvo: I'll continue to do some reading, I remember last time I looked at it there was a thin layer of magic which was throwing me off (method names, etc..). Thanks forclarifying
[2012-05-16 18:43:09 -0400] ssd7: Ultimately writing a LWRP for this does seem like a good idea, but I'm not sure I completely see what is causing the problem actually.  Is :mountpoint unique?
[2012-05-16 18:43:53 -0400] tarrant: knife bootstrap is failing because http://s3.amazonaws.com/opscode-full-stack/ubuntu-9.10-x86_64/chef-full_0.10.8-3_amd64.deb is 404ing. Any thoughts other than the fact we are using an ancient ubuntu?
[2012-05-16 18:44:42 -0400] tarrant: oh heh that is the distro's repo not bootstrap.
[2012-05-16 18:44:45 -0400] Bullardo: ANyone know where I can go to get the presentation from the class yesterday/
[2012-05-16 18:44:54 -0400] tarrant: nevermind.
[2012-05-16 18:45:29 -0400] mrchrisadams: shuvo: hey hey! nice to see my blog serving some purpose!
[2012-05-16 18:46:21 -0400] sabooky: mrchrisadams, shuvo: thanks for the link
[2012-05-16 18:46:25 -0400] patcon: anyone know any reasons why role_path wouldn't be able to accept an array like cookbook_path in solo.rb?
[2012-05-16 18:46:58 -0400] patcon: or rather, i know it can't, but can anyone think of any reasons why it COULDN'T? :)
[2012-05-16 18:47:46 -0400] sabooky: wait a minute..
[2012-05-16 18:47:56 -0400] sabooky: sigh.. ok I'm a moron, never mind...
[2012-05-16 18:48:13 -0400] sabooky: set :lost_found => false on the wrong hash in the array
[2012-05-16 18:48:40 -0400] sabooky: Ah well, at least I learned a bit about resources in the process
[2012-05-16 18:49:29 -0400] shuvo: mrchrisadams, that is a good article. thanks for writing it :-)
[2012-05-16 18:49:31 -0400] paulmooring: sabooky: Just FYI but you always need a resource and provider, neither are useful without the other
[2012-05-16 18:49:52 -0400] sabooky: paulmooring: thanks, that's what I thought.. just wanted to be clear on it.
[2012-05-16 18:50:06 -0400] sabooky: As I understand it resources/providers are pretty much like "classes"
[2012-05-16 18:50:39 -0400] paulmooring: A resource defines what it can do, generically, a package can be installed, removed, purged, upgraded
[2012-05-16 18:50:40 -0400] shuvo: resources are the what and providers the how. they work with states
[2012-05-16 18:50:49 -0400] paulmooring: a provider says how to do it for a platform
[2012-05-16 18:51:08 -0400] sabooky: gotcha.
[2012-05-16 18:51:12 -0400] paulmooring: packages, might have a yum/rpm provider that says how to install a package using yum for instance
[2012-05-16 18:51:28 -0400] paulmooring: 1 resource can have many providers
[2012-05-16 18:51:41 -0400] paulmooring: yum, apt, emerge, ect. for packages
[2012-05-16 18:51:56 -0400] sabooky: A lot of this has been abstracted since we're using one platform at work.. but soon might be trying to run this on AIX or solaris (I'm sure providers are gonna be useful for this)
[2012-05-16 18:52:24 -0400] sabooky: Thanks again for all your help. :)
[2012-05-16 18:52:50 -0400] shuvo: AIX or solaris, hmm sounds some systems that's been up for a long time!
[2012-05-16 18:52:53 -0400] shuvo: :-)
[2012-05-16 18:53:58 -0400] elijah-mbp: sabooky: the solaris providers should be okay, should mostly Just Work for packages.  IPS at least has been there for a long time - pkgin stuff (e.g. to run in a zone at Joyent) is committed but needs another chef point release to happen IIRC.
[2012-05-16 18:55:47 -0400] sabooky: Ok, so now that I have a pretty good idea on what resources/providers are
[2012-05-16 18:56:24 -0400] sabooky: where do definitions come into the mix? For example, say I want to create this bit of code, that will extract a tarball.. do I want a resource or definition at this point?
[2012-05-16 18:57:37 -0400] paulmooring: You don't want a definition
[2012-05-16 18:58:24 -0400] sabooky: ok, how do I make a resource cross cookbook? Since exploading a tarball sounds like something that would be useful in many places
[2012-05-16 18:59:14 -0400] sabooky: Do I just define a common-lib cookbook that's notthing but resources/providers then include it when I need it?
[2012-05-16 18:59:38 -0400] shuvo: sabooky, what you propose is a very good way of writing cookbooks
[2012-05-16 18:59:57 -0400] paulmooring: yeah you should look at the windows cookbook for an example, but just put the LWRPs in a cookbook, then depend on that cookbook when you want to use it
[2012-05-16 19:00:11 -0400] sabooky: cool
[2012-05-16 19:00:14 -0400] gp5st: i'm getting this error when i try to connect to solr
[2012-05-16 19:00:15 -0400] gp5st: HTTP/1.1 500 Unable to find a javac compiler; com.sun.tools.javac.Main is not on the classpath. Perhaps JAVA_HOME does not point to the JDK. It is currently set to "/usr/lib/jvm/java-7-openjdk-amd64/jre"
[2012-05-16 19:00:20 -0400] gp5st: i'm not sure where to go to fix it
[2012-05-16 19:00:24 -0400] sabooky: Ok, then my remaining gap is definitions, when/how should they be used?
[2012-05-16 19:00:25 -0400] shuvo: sabooky, check this out: https://github.com/damm/redis/blob/master/recipes/install_from_upstream.rb
[2012-05-16 19:00:56 -0400] paulmooring: sabooky: imo, you never really need definitions you should use LWRPs and libraries almost all the time
[2012-05-16 19:01:47 -0400] yfeldblum: a resource is a in-the-recipe model/description/specification of what your system SHALL look like; a provider is code which inspects the current state of the underlying resource on the system and transforms that underlying resource to how the recipe declared it SHALL look like
[2012-05-16 19:02:28 -0400] StormSilver: sabooky: definitions are what we had before LWRP came along
[2012-05-16 19:02:44 -0400] StormSilver: sabooky: So definitions aren't really deprecated, but in a way LWRP replaced them.
[2012-05-16 19:02:49 -0400] sabooky: StormSilver: thanks, that's a great clarification
[2012-05-16 19:03:12 -0400] sabooky: That was really confusing me when I was reading into this stuff.. and reading through a bunch of in house cookbooks that use definitions
[2012-05-16 19:03:34 -0400] StormSilver: There's a good description somewhere on the wiki of when to use a definition and when to make it a LWRP
[2012-05-16 19:03:53 -0400] mconigliaro: is anyone else getting out of memory errors when using the yum provider?
[2012-05-16 19:03:58 -0400] mconigliaro: FATAL: Errno::ENOMEM: package[yum-priorities] (yum::default line 48) had an error: Errno::ENOMEM: Cannot allocate memory - fork(2)
[2012-05-16 19:04:07 -0400] mconigliaro: this is after upgrading to 0.10.10
[2012-05-16 19:04:09 -0400] StormSilver: definition?
[2012-05-16 19:04:10 -0400] bawt: definition is what I'm looking for.
[2012-05-16 19:04:12 -0400] StormSilver: definitions?
[2012-05-16 19:04:13 -0400] bawt: definitions is http://wiki.opscode.com/display/chef/Definitions
[2012-05-16 19:04:15 -0400] paulmooring: StormSilver: I think you're talking about this pay http://wiki.opscode.com/display/chef/Definitions
[2012-05-16 19:04:30 -0400] StormSilver: sabooky: ^ there's a grey box on the right that explains it
[2012-05-16 19:04:33 -0400] StormSilver: paulmooring: Yep :)
[2012-05-16 19:04:51 -0400] paulmooring: but seriously just don't use definitions
[2012-05-16 19:05:30 -0400] sabooky: StormSilver: that last bullet is interesting
[2012-05-16 19:05:50 -0400] sabooky: updating single file from multiple recipes
[2012-05-16 19:05:52 -0400] StormSilver: sabooky: Yeah, it really just means "you want your code to be DRY"
[2012-05-16 19:06:18 -0400] sabooky: Cool, thanks again for all the info
[2012-05-16 19:06:25 -0400] StormSilver: NP, s'what we're all here for :D
[2012-05-16 19:06:38 -0400] sabooky: shuvo: that link is pretty much how we're doing it now, thinking resource/provider will make it more reusable/flexible
[2012-05-16 19:07:04 -0400] sabooky: shuvo: I'll create a tar resource, or find one online
[2012-05-16 19:11:21 -0400] shuvo: sabooky, sure. whatever you do, I am interested in seeing the result. you can also email gmail for subhobroto
[2012-05-16 19:11:44 -0400] shuvo: best of luck!
[2012-05-16 19:18:44 -0400] yfeldblum: lightweight resources do not replace definitions; definitions are groups of resources that go together; your own custom lightweight resources are resources that serve as units of abstraction in their own right; each has its place
[2012-05-16 19:26:09 -0400] Urocyon: hoover_damm: was it you who had a postgresql cookbook on github?  I'm looking for it now.
[2012-05-16 19:26:25 -0400] hoover_damm: Urocyon, yep
[2012-05-16 19:26:36 -0400] hoover_damm: github.com/damm/postgresql
[2012-05-16 19:26:46 -0400] geekbri: I have made good use of definitions when wrapping a resource that I won't need to notify
[2012-05-16 19:27:37 -0400] hoover_damm: Urocyon, I suggest having 3 disks available for postgresql
[2012-05-16 19:27:56 -0400] hoover_damm: 1 can be your root filesystem if you want (temp), then one for wal, one for the data
[2012-05-16 19:28:20 -0400] hoover_damm: Urocyon, the pattern of putting the wal and the data on different spindles can gain upwards of an 80x boost
[2012-05-16 19:28:39 -0400] hoover_damm: personally I get 2.5K Transactions Per Second on a m1.xlarge
[2012-05-16 19:29:03 -0400] Urocyon: have you tried postgresql on ec2?
[2012-05-16 19:29:10 -0400] hoover_damm: ^^
[2012-05-16 19:29:21 -0400] Urocyon: ah
[2012-05-16 19:29:42 -0400] Urocyon: cool.  and are you generally just using a single ebs volume for each?  no funky raid thing?
[2012-05-16 19:30:42 -0400] hoover_damm: single ephemeral volume for temp, single volume for data, single for wal
[2012-05-16 19:31:00 -0400] hoover_damm: you can do the funky raid thing but it's not likely to give you the gains that it would in other databases
[2012-05-16 19:31:16 -0400] hoover_damm: I've tested it that way and without, the difference is negligible
[2012-05-16 19:31:30 -0400] LawrenceSeattle: where is the source for the centos5-gems bootstrap?  I'd like to modify it
[2012-05-16 19:31:59 -0400] Urocyon: Good to hear.  Had read a few articles on raiding volumes from a couple of years ago, but was wondering if that was overkill.
[2012-05-16 19:32:03 -0400] hoover_damm: Urocyon, basically raiding or not is your own choice.  100 i/ops average with postgresql and a different volume for wal data, and one for data...
[2012-05-16 19:32:16 -0400] hoover_damm: Urocyon, then use /mnt for your temporary tables... and snapshot regularly
[2012-05-16 19:32:52 -0400] hoover_damm: Urocyon, replication is easy with that cookbook.  Just spinup another server, and if it's in another region drop that ip an role to override
[2012-05-16 19:33:46 -0400] hoover_damm: shutdown postgresql on the replica you just booted, nuke the data and wal path, select pg_start_backup ... rsync it from the master, select pg_stop_backup... create recovery.conf, start postgresql
[2012-05-16 19:33:49 -0400] Urocyon: Have you been using it with Pangolin?
[2012-05-16 19:33:59 -0400] hoover_damm: and hot standby works
[2012-05-16 19:35:28 -0400] hoover_damm: security injection tool?
[2012-05-16 19:36:47 -0400] Urocyon: hoover_damm: nah ubuntu 12.04.  Precise Pangolin
[2012-05-16 19:37:13 -0400] hoover_damm: Urocyon, ahh it's using the PPA... so it's up to the PPA if that works
[2012-05-16 19:37:28 -0400] hoover_damm: should be roughly the same as Precise as it's the same maintainer
[2012-05-16 19:38:12 -0400] Urocyon: Yeah martin's backports are pretty much the same.
[2012-05-16 19:38:30 -0400] linTest: I'm setting up a Chef Server on a VM, using Ubuntu. Any recommendations on server specs or storage requirements?
[2012-05-16 19:38:32 -0400] hoover_damm: yep, you'll just need to remove using martins' backport to get 9.1
[2012-05-16 19:38:35 -0400] hoover_damm: not a big deal
[2012-05-16 19:38:43 -0400] hoover_damm: otherwise you'll get 9.2
[2012-05-16 19:39:29 -0400] hoover_damm: Urocyon, I debated making my own PPA but basically he's the maintainer of it for Debian.  I don't have a huge desire to unmuck the mess that Debian has made postgresql
[2012-05-16 19:39:54 -0400] hoover_damm: the debian package for postgresql really isn't that great as there is no way to preseed some basic options
[2012-05-16 19:40:44 -0400] hoover_damm: my cookbook goes outside of the normal box to configure postgresql very well for hosting... which is why I stop it, nuke the database, then re-init with new settings.
[2012-05-16 19:40:53 -0400] hoover_damm: :`(
[2012-05-16 19:41:22 -0400] Urocyon: yeah, was working on doing that in my own cookbook when I remembered yours.
[2012-05-16 19:42:01 -0400] Urocyon: Simple things like changing your data_dir become a pain.
[2012-05-16 19:42:05 -0400] hoover_damm: yep
[2012-05-16 19:42:27 -0400] hoover_damm: well I used to write and maintain cookbooks for EY, so my cookbooks are not a poor sampling usually
[2012-05-16 19:42:34 -0400] hoover_damm: and if they are I disclaim it in the readme/repo
[2012-05-16 19:42:48 -0400] hoover_damm: the whole desire is to host it actually
[2012-05-16 19:42:59 -0400] hoover_damm: anyone can write a cookbook to automate a slingshot
[2012-05-16 19:43:07 -0400] hoover_damm: but a slingshot that can actually survive a stampede
[2012-05-16 19:43:12 -0400] hoover_damm: is another story :)
[2012-05-16 19:43:46 -0400] hoover_damm: and that's just the care and attention to setting up the services so they can handle your load :)
[2012-05-16 19:45:22 -0400] hoover_damm: have a good day
[2012-05-16 19:46:04 -0400] Urocyon: thanks, hoover_damm!
[2012-05-16 19:55:01 -0400] linTest: I'm setting up a Chef Server on a VM, using Ubuntu. Any recommendations on server specs or storage requirements?
[2012-05-16 20:01:31 -0400] shuvo: linTest, I have one ready to go
[2012-05-16 20:01:38 -0400] shuvo: which VM tool?
[2012-05-16 20:02:34 -0400] shuvo: server specs: 2GB+, atleast 1GB but pain further down the line. storage requirements -> depends where you host your cookbooks and what file deps they have
[2012-05-16 20:05:15 -0400] codebeaker: yfeldblum: hey thanks for the exchanges on Github - appreciate the fast responses
[2012-05-16 20:06:00 -0400] codebeaker: I've called in here to ask anyone if they know how one is expected to use the opscode nginx cookbook to manage one's virtual hosts, I'm using chef-solo, and can't see anything obvious except for looking at the default site that it installs, and reading that "it creates a debian style conf.d directory"
[2012-05-16 20:08:58 -0400] miah: you use the nginx_site lwrp
[2012-05-16 20:09:22 -0400] codebeaker: miah what's the relationship btween lwrp's and json node configs ?
[2012-05-16 20:09:41 -0400] miah: er, i guess its still a definition.
[2012-05-16 20:09:45 -0400] yfeldblum: codebeaker, zero
[2012-05-16 20:09:48 -0400] codebeaker: from what I understand from a few hours messing with chef is that an lwrp is provided by a cookbook, normally for use from other Ruby code
[2012-05-16 20:10:02 -0400] miah: no. lwrps are for use from cookbooks
[2012-05-16 20:10:18 -0400] codebeaker: yes, but cookbooks (which are written in Ruby)
[2012-05-16 20:10:27 -0400] miah: well obviously
[2012-05-16 20:10:38 -0400] codebeaker: so if nginx's cookbook provides a nginx_site lwrp, somewhere there's a "virual host" cookbook, which can use the lwrp
[2012-05-16 20:10:43 -0400] codebeaker: would that be a sane assumption?
[2012-05-16 20:10:54 -0400] yfeldblum: codebeaker, LWRP's are Resources & Providers, just like the resources & providers that ship with chef-client/chef-solo, except you get a nicer DSL and you don't have to write some of the ruby class/attributes boilerplate code
[2012-05-16 20:11:01 -0400] miah: sure. but in this case. you just create your own cookbook that uses the lwrp to set up your site
[2012-05-16 20:11:14 -0400] miah: there is a application_nginx cookbook that i haven't looked at yet, but i assume it does all this for you.
[2012-05-16 20:11:47 -0400] codebeaker: miah: cool, thanks
[2012-05-16 20:12:13 -0400] codebeaker: yfeldblum: cool - so whem I'm reading that something provides an lwrp that's an invitation to write my own cookbook that's making use of it
[2012-05-16 20:12:28 -0400] codebeaker: and, in very common cases (application_nginx) - there's probably already one doing it
[2012-05-16 20:12:33 -0400] yfeldblum: codebeaker, yes, also, almost an expectation that you do so
[2012-05-16 20:13:15 -0400] codebeaker: ok, sure - I mean some things are so general, it doesn't make sense to package them up, if an lwrp for a vhost config gets you 80% of the way there, then the 20% ramaining would be so site specific, it wouldn't be sane to share it
[2012-05-16 20:13:27 -0400] codebeaker: (thanks again, I owe you today!)
[2012-05-16 20:14:10 -0400] yfeldblum: codebeaker, yep
[2012-05-16 20:14:52 -0400] fujin: :D
[2012-05-16 20:15:39 -0400] miah: :P
[2012-05-16 20:17:48 -0400] codebeaker: *phew* deep breaths, site-specific cookbooks :-D
[2012-05-16 20:18:01 -0400] codebeaker: at least this clarifies where I should start with config files/etc
[2012-05-16 20:18:40 -0400] gp5st: hello.  when i do gem install knife-windows, i get ERROR:  While executing gem ... (NoMethodError)     undefined method `call' for nil:NilClass
[2012-05-16 20:18:52 -0400] gp5st: where can i look for what's wrong?
[2012-05-16 20:19:16 -0400] codebeaker: yfeldblum, miah -- thanks again, & good night (Europe)
[2012-05-16 20:19:24 -0400] yfeldblum: codebeaker, cheers
[2012-05-16 20:19:25 -0400] miah: alright. good luck =)
[2012-05-16 20:19:29 -0400] codebeaker: :)
[2012-05-16 20:23:46 -0400] linTest: shuvo, I will be using VMware vSphere
[2012-05-16 20:26:09 -0400] shuvo: linTest, ok. I have a tested chef server that's tested on virtualbox, but I can export it as a OVF for you to use if you want
[2012-05-16 20:30:27 -0400] upgrayedd: vbox => vsphere with ovf is error prone IIRC
[2012-05-16 20:30:55 -0400] upgrayedd: vmware wrote the parser to obey the element ordering of some of the XML elements because that's what the spec said
[2012-05-16 20:31:21 -0400] upgrayedd: virtualbox writes it from a hash or something because the elements aren't in that order
[2012-05-16 20:32:16 -0400] upgrayedd: if all else fails just convert the disk and rebuild the vm metadata/vmx from scratch and attach the disk
[2012-05-16 20:32:41 -0400] linTest: shuvo, thanks. At this point I think I want to go through the whole install process to see any surprises (trial by fire!). I'm thinking that cookbooks will be hosted on same VM, is there a ballpark storage I should shoot for as I get started?
[2012-05-16 20:32:44 -0400] josephholsten: upgrayedd: vagrant thread on making this easier https://github.com/mitchellh/vagrant/issues/322
[2012-05-16 20:33:19 -0400] josephholsten: if you have can id bugs with the translation, I'll be glad to help
[2012-05-16 20:33:46 -0400] upgrayedd: just because it uses ovftool? i've still had ovfs i still had to manually tool afterwards.  and it wasn't worth it.
[2012-05-16 20:34:36 -0400] upgrayedd: most of the hardware, for example
[2012-05-16 20:35:34 -0400] upgrayedd: i dunno, i'm just saying don't go too far down that rabbithole if you don't have to
[2012-05-16 20:35:39 -0400] upgrayedd: imo
[2012-05-16 20:36:26 -0400] josephholsten: it only uses ovftool to make sure the zip is ordered correctly. the xml munging is entirely custom.
[2012-05-16 20:37:35 -0400] josephholsten: if you know of a ruby lib that will ensure files are written in order, I can cut out the ovftool dependency
[2012-05-16 20:37:46 -0400] upgrayedd: i wrote a python one
[2012-05-16 20:38:00 -0400] upgrayedd: don't know ruby well yet but i could probably port it
[2012-05-16 20:39:40 -0400] shuvo: upgrayedd, that python tools would be nice
[2012-05-16 20:39:48 -0400] shuvo: is it up somewhere?
[2012-05-16 20:39:51 -0400] upgrayedd: wait, to ensure that _files_ are in order?  not the rasd elements or whatever they were?
[2012-05-16 20:42:30 -0400] upgrayedd: the thing i did does xml munging too
[2012-05-16 20:42:50 -0400] upgrayedd: i don't know of the 'zip ordering' problem you found
[2012-05-16 20:44:37 -0400] josephholsten: upgrayedd: you have to have the xml and checksums as the first files in the zip. boring spec stuff.
[2012-05-16 20:44:59 -0400] josephholsten: ensures efficient access to metadata
[2012-05-16 20:45:42 -0400] upgrayedd: ah, cooky.  sorry got confused
[2012-05-16 20:46:11 -0400] rocket: I am trying to use chef-solo to install chef-server and I am running into this error.
[2012-05-16 20:46:14 -0400] upgrayedd: i don't see you reordering the rasd elements at all
[2012-05-16 20:46:14 -0400] rocket: checking for main() in -lgecodesearch... *** extconf.rb failed ***
[2012-05-16 20:46:20 -0400] rocket: is it a known issue?
[2012-05-16 20:46:23 -0400] upgrayedd: does it just not fail for you?
[2012-05-16 20:46:37 -0400] upgrayedd: maybe ovftool does it...
[2012-05-16 20:48:52 -0400] josephholsten: upgrayedd: it's entirely possible it's reordering internally
[2012-05-16 20:49:05 -0400] josephholsten: I'll gladly add that though
[2012-05-16 20:49:24 -0400] upgrayedd: if you ever go to remove ovftool dep don't be surprised if you have to do that too
[2012-05-16 20:49:25 -0400] upgrayedd: fwiw
[2012-05-16 20:49:46 -0400] upgrayedd: and people online have only discovered part of the ordering rules
[2012-05-16 20:50:24 -0400] patcoll: Hey all. Strange question -- there used to be an opscode "ruby" cookbook -- is there a new canonical way to install ruby (for actual app purposes, not for chef) using chef now?
[2012-05-16 20:51:48 -0400] josephholsten: patcoll: I'm pretty sure everyone uses either rbenv or rvm
[2012-05-16 20:52:13 -0400] paulmooring: josephholsten: I'm not sure that's true for production servers
[2012-05-16 20:52:14 -0400] josephholsten: I use these:
[2012-05-16 20:52:16 -0400] josephholsten: cookbook 'ruby_build', git: 'https://github.com/fnichol/chef-ruby_build', ref: 'v0.6.0'
[2012-05-16 20:52:17 -0400] josephholsten: cookbook 'rbenv', git: 'https://github.com/fnichol/chef-rbenv', ref: 'v0.6.4'
[2012-05-16 20:52:58 -0400] josephholsten: I use distro packages unless my devs require a specific version.
[2012-05-16 20:53:42 -0400] josephholsten: I strongly encourage using distro packs over rbenv or rvm
[2012-05-16 20:53:44 -0400] patcoll: I ask because I noticed there is no longer a "ruby" cookbook at all at either https://github.com/opscode/cookbooks nor https://github.com/opscode-cookbooks
[2012-05-16 20:53:57 -0400] patcoll: So I figured there was a new "chef way"
[2012-05-16 20:54:02 -0400] patcoll: Is that not true?
[2012-05-16 20:54:18 -0400] paulmooring: patcoll: Opscode/Chef is less opinionated now that we push the full stack installer
[2012-05-16 20:54:41 -0400] paulmooring: usually just distro packages, unless you need 1.9
[2012-05-16 20:54:56 -0400] josephholsten: the chef way is to isolate chef's ruby install from the system, allowing you to use whatever
[2012-05-16 20:55:49 -0400] patcoll: paulmooring: keeping opscode-cookbooks going seems to insinuate opscode is still opinionated though which is why I'm curious why the ruby cookbook got deleted...
[2012-05-16 20:56:25 -0400] josephholsten: because it's expected you'll use distro packages
[2012-05-16 20:56:42 -0400] bytheway: Insulated generally with the omnibus?
[2012-05-16 20:57:06 -0400] bytheway: Or are there other standard methods
[2012-05-16 20:57:28 -0400] paulmooring: patcoll: I meant opinionated on which Ruby you use
[2012-05-16 20:57:59 -0400] paulmooring: I believe the focus of the ruby cookbook was to get a less broken ruby/gems install for use with Chef
[2012-05-16 20:58:09 -0400] paulmooring: the omnibus installer makes that irrelevant
[2012-05-16 20:58:21 -0400] paulmooring: hence the Ruby cookbook is no longer needed
[2012-05-16 20:59:40 -0400] patcoll: fair enough I guess but isn't the point of writing cookbooks to have a generic way to install certain packages cross-distro or cross-OS? seems counter-intuitive to delete "ruby" -- better to keep it and re-focus it on maintaining that generic method of installing ruby for other purposes (kind of like the python cookbook does for python)
[2012-05-16 20:59:51 -0400] shuvo: upgrayedd, josephholsten: would the ovftool allow me to rework a virtualbox OVF so that it works with other tools like VMWare automagically?
[2012-05-16 21:00:14 -0400] josephholsten: shuvo: for certain values of automagically
[2012-05-16 21:00:21 -0400] yfeldblum: there's not really a point to opscode maintaining a cookbook with a single-line default recipe `package "ruby"` ...
[2012-05-16 21:00:55 -0400] paulmooring: patcoll: Usually they'll get left up as long as a cookbook works, but maintaining cookbooks that aren't used isn't a great use of manpower so that stuff gets taken down rather than fixed
[2012-05-16 21:00:56 -0400] patcoll: yfeldblum: ? the packages are named differently for each distro?
[2012-05-16 21:01:46 -0400] bytheway: Yeah package ruby in Rhel5 means you get 1.8.5
[2012-05-16 21:01:49 -0400] josephholsten: patcoll: if you want a cross-distro install, typically you'll just go with what the distro provides by its packaging. But you've already got it installed if chef is running.
[2012-05-16 21:02:04 -0400] paulmooring: It's probably also considered better form to put package "ruby" in a rails cookbooks rather than including a whole extra cookbook just to install 1 package
[2012-05-16 21:02:08 -0400] yfeldblum: patcoll, sure, but opscode doesn't need to the cookbook, and it should be real simple especially for a single-distro infrastructure, so there's not terribly must point
[2012-05-16 21:02:13 -0400] yfeldblum: much*
[2012-05-16 21:02:34 -0400] josephholsten: if the cookbook actually specified a way to custom compile the ruby, then we're getting into bike shed territory where no one will be happy with one solution
[2012-05-16 21:02:49 -0400] patcoll: josephholsten: but using the embedded ruby from omnibus for your custom applications goes against the whole reason omnibus was created in the first place, right? to separate chef's ruby from the system ruby?
[2012-05-16 21:03:23 -0400] josephholsten: ok, that's a decent point.
[2012-05-16 21:03:44 -0400] paulmooring: patcoll: You're definitely right there, you should not use the omnibus ruby as your systems ruby
[2012-05-16 21:03:50 -0400] josephholsten: and different platforms have different ideas of what a minimal ruby install is (no irb? c'mon)
[2012-05-16 21:04:13 -0400] yfeldblum: it's expected that you will be writing your own recipes to deploy your own infrastructure ... sometimes an opscode cookbook or other person's third party cookbook can help you out, but that's not expected to just be the case every time
[2012-05-16 21:04:17 -0400] patcoll: yfeldblum: I mean, "it should be real simple" describes a ton of the opscode-cookbooks that opscode maintains -- its just a simpler way of doing a ton of "if system == ubuntu" conditionals or whatever
[2012-05-16 21:04:34 -0400] iroller: Hey Opscode guys, are you going to rewrite chef-client in Erlang too?
[2012-05-16 21:04:55 -0400] yfeldblum: iroller, that would require them to reimplement ruby in erlang
[2012-05-16 21:05:00 -0400] josephholsten: iroller: I've heard not
[2012-05-16 21:05:02 -0400] paulmooring: iroller: no
[2012-05-16 21:05:15 -0400] iroller: :)
[2012-05-16 21:05:17 -0400] patcoll: obviously it gets more complicated than that for more complicated packages that need to install more stuff or establish a system service -- but that's the idea of chef -- to provide a DSL for configuring systems cross-platform
[2012-05-16 21:05:55 -0400] yfeldblum: patcoll, chef provides the building blocks, not the finished product: you write the finished product using the chef building blocks
[2012-05-16 21:06:23 -0400] paulmooring: patcoll: Some of those cookbooks exist because we need them internally, and we're likely to publish anything we can to the community site
[2012-05-16 21:06:24 -0400] josephholsten: patcoll: if you think it's important, http://community.opscode.com/cookbooks/ruby is maintained by jtimberman
[2012-05-16 21:06:24 -0400] yfeldblum: patcoll, chef provides the concepts of node, cookbook, recipe, role, resource, provider ... but you assemble them to built out your infrastructure
[2012-05-16 21:06:34 -0400] patcoll: josephholsten: exactly -- which is why I like using a ruby cookbook to establish which system ruby I need and then install the generic set of tools that I need irb, ri, rdoc whatever (although the first thing I do is usually put "gem: --no-rdoc --no-ri" in /etc/gemrc anyway)
[2012-05-16 21:06:40 -0400] josephholsten: who will certainly accept patches
[2012-05-16 21:06:52 -0400] hoover_damm: and do remember chef is a gem, you are free to create applications around the chef gem
[2012-05-16 21:06:59 -0400] hoover_damm: to build your world
[2012-05-16 21:07:27 -0400] hoover_damm: you are not locked to using chef-client, you can just use the chef gem and write the code to run a chef-client and have your world slightly differently
[2012-05-16 21:08:02 -0400] hoover_damm: iroller, to rewrite the client in erlang or another language would likely change the DSL
[2012-05-16 21:08:03 -0400] patcoll: josephholsten: but doesn't he pretty much maintain all the cookbooks anyway? it seems counter-intuitive to have a different method for maintaining one cookbook.
[2012-05-16 21:08:05 -0400] hoover_damm: which would suck
[2012-05-16 21:08:29 -0400] josephholsten: patcoll: I'm pretty sure he'd let you be the maintainer
[2012-05-16 21:08:37 -0400] patcoll: Github works so well for that
[2012-05-16 21:09:27 -0400] paulmooring: patcoll: cookbooks maintained by Opscode by jtimberman are officially supported and have tickets and releases at tickets.opscode.com
[2012-05-16 21:09:35 -0400] josephholsten: patcoll: do you use apt-get or yum? it's useful to have a single central default repo, even if there are a million additional ones you can also pull from
[2012-05-16 21:09:44 -0400] paulmooring: jtimberman also maintains some cookbooks that are not supported through that system
[2012-05-16 21:09:44 -0400] patcoll: I mean I'm down for that, whatever sure. I just assumed opscode has a vested interest in seeing ruby being installed on as many chef-controlled nodes as possible. It seems odd that deleting the "ruby" cookbook from opscode-cookbooks is opscode's MO
[2012-05-16 21:09:51 -0400] paulmooring: because he is a good guy :)
[2012-05-16 21:10:05 -0400] patcoll: yeah jtimberman is the shit -- not debating that.
[2012-05-16 21:11:34 -0400] patcoll: josephholsten: I use ubuntu so apt-get (aptitude really). not sure what you mean by a single default repo?
[2012-05-16 21:12:27 -0400] josephholsten: if you can run `apt-get install foo`, then you're enjoying the wonders of not having to dig through github every time you want to install a package
[2012-05-16 21:13:25 -0400] josephholsten: that's why I'd rather you help with the ruby cookbook in the community site, not just spin up your own cookbook
[2012-05-16 21:13:58 -0400] patcoll: yeah man but that defeats the purpose of chef, no? :) i always start out with my cookbooks being ubuntu-centric, but I branch out once I have the need. that's the beauty of it.
[2012-05-16 21:16:45 -0400] patcoll: I guess it comes down to what you need ruby for. For rails apps, etc people probably just use rvm, I get that. I guess some folks at opscode have just decided that installation of ruby should be a package-only exercise? Or just left as an exercise for the reader, or cookbook-writer as it were
[2012-05-16 21:17:44 -0400] miah: chef-rvm ftw. https://github.com/fnichol/chef-rvm
[2012-05-16 21:18:40 -0400] josephholsten: +1
[2012-05-16 21:19:01 -0400] josephholsten: great for dev though
[2012-05-16 21:19:12 -0400] StormSilver: hoover_damm: I think rvm can help with that ;)
[2012-05-16 21:19:41 -0400] hoover_damm: StormSilver, did you just tell me to map/reduce myself?
[2012-05-16 21:19:52 -0400] patcoll: man I gotta shake fnichol's hand, he's a prolific one
[2012-05-16 21:20:07 -0400] miah: yes
[2012-05-16 21:20:41 -0400] josephholsten: forgot he's doing both the rvm and rbenv stacks
[2012-05-16 21:22:09 -0400] hoover_damm: yfeldblum, https://github.com/applicationsonline/librarian/issues/71#issuecomment-5750497 is related to how chef runs things with LC_ALL="C" by default
[2012-05-16 21:22:35 -0400] patcoll: Ah I haven't seen Cheffiles yet either -- this is the bomb
[2012-05-16 21:23:05 -0400] patcoll: http://shoutpix.com/graphics/compliments/you-da-bomb.gif
[2012-05-16 21:26:02 -0400] yfeldblum: hoover_damm, does knife do that?
[2012-05-16 21:26:19 -0400] hoover_damm: yfeldblum, it inherits it from shellout
[2012-05-16 21:27:58 -0400] hoover_damm: yfeldblum, in order to deal with internationalization issues LC_ALL="C" is done all all commands by default
[2012-05-16 21:31:16 -0400] yfeldblum: hoover_damm, not sure how that would affect librarian-chef, since it's not calling out to anything in chef that would shell out
[2012-05-16 21:31:58 -0400] yfeldblum: hoover_damm, for compiling & inspecting the metadata.rb files, it uses the chef ruby API directly
[2012-05-16 21:33:15 -0400] hoover_damm: yfeldblum, right remember at that point knife is already running in LC_ALL="C" so if you try and hit utf-8 charecters
[2012-05-16 21:33:18 -0400] hoover_damm: you'll still have issues
[2012-05-16 21:33:36 -0400] yfeldblum: hoover_damm, not seeing it: knife exec --exec 'require "pp" ; pp ENV.to_hash'
[2012-05-16 21:34:50 -0400] hoover_damm: yfeldblum, it's not set at that point maybe? still is there
[2012-05-16 21:37:02 -0400] yfeldblum: hoover_damm, `librarian-chef install` does not shell out to knife, though
[2012-05-16 21:37:30 -0400] hoover_damm: yfeldblum, this is from chef
[2012-05-16 21:38:01 -0400] yfeldblum: hoover_damm, ah ok ...
[2012-05-16 21:38:28 -0400] yfeldblum: hoover_damm, but then maybe i'm not following how this relates to librarian-chef?
[2012-05-16 21:42:35 -0400] hoover_damm: you pull in chef?
[2012-05-16 21:48:55 -0400] cwj: LinuxHorn: wanna try something else? :)
[2012-05-16 21:49:27 -0400] cwj: two new commits here https://github.com/needle/chef-opscode-users/commits/COOK-937
[2012-05-16 21:55:39 -0400] yfeldblum: hoover_damm, https://github.com/applicationsonline/librarian/blob/v0.0.23/lib/librarian/chef/manifest_reader.rb#L25-33
[2012-05-16 22:04:06 -0400] mhalligan: is it possible to create definitions inside of shef?
[2012-05-16 22:19:35 -0400] LinuxHorn: cwj: Prob won't have chance tonight to try, but I'll take a look in morning
[2012-05-16 22:19:53 -0400] cwj: LinuxHorn: ok
[2012-05-16 22:20:17 -0400] cwj: its working for me on a system that starts out without the gem, but obv my testing wasn't any good in the first place sooo
[2012-05-16 22:28:05 -0400] dunniganp: anyone have any ideas on this  http://pastebin.com/1xAw7VJB
[2012-05-16 22:28:33 -0400] dunniganp: trying to get at least one of the "quick starts" working from the opscode wiki. All of them error.
[2012-05-16 22:29:51 -0400] dunniganp: this is on ubuntu 10.04, using the image recommended in the wiki
[2012-05-16 22:31:23 -0400] dunniganp: this is what I was following this attempt:
[2012-05-16 22:31:24 -0400] dunniganp: http://wiki.opscode.com/display/chef/Build+a+Django+Stack
[2012-05-16 22:38:02 -0400] jessicab: dunniganp - seems like some sort of issue with the cookbook not installing the mysql gem right on the ami. if youre just trying to get a node up on ec2 this guide is more generic and might be easier to use - http://wiki.opscode.com/display/chef/EC2+Bootstrap+Fast+Start+Guide
[2012-05-16 22:52:52 -0400] dunniganp: jessicab: I do see the following in the log earlier in the process: INFO: Missing gem 'mysql'
[2012-05-16 22:53:21 -0400] dunniganp: and WARN: Missing gem 'right_aws', which should be no big deal since not using RS
[2012-05-16 23:01:17 -0400] dunniganp: jessicab: I can get nodes up on ec2, no problem. what i want to do now is install an application stack. Any stack at the moment will do. However all the examples use mysql, and mysql doesn't install using the opscode provided cookbooks
[2012-05-16 23:02:23 -0400] jessicab: dunniganp - hm.. i tested the mysql cookbook itself real quick on ec2 and it compiled.. you could always just edit your recipes if you know the gem thats missing though too
[2012-05-16 23:02:47 -0400] dunniganp: which ami did you use?
[2012-05-16 23:03:08 -0400] jessicab: ami-6936fb00
[2012-05-16 23:03:15 -0400] jessicab: its from the ami list in the wiki, its 10.04 too
[2012-05-16 23:05:01 -0400] dunniganp: hmm let me try that ami
[2012-05-16 23:11:44 -0400] dunniganp: same deal: http://pastebin.com/fsZ1GLvS
[2012-05-16 23:12:44 -0400] dunniganp: it appears that mysql installs, it's erring when creating the application database.
[2012-05-16 23:12:45 -0400] jessicab: weird, is that just using the mysql::server recipe? or the django stuff from the quickstart too?
[2012-05-16 23:13:31 -0400] dunniganp: knife ec2 server create -G cheftest -I ami-6936fb00 -f m1.small  -S my_key -i ~/.ssh/my_key.pem -x ubuntu -r 'role[base],role[django_cms_database_master],role[django_cms],recipe[django_cms::db_bootstrap],role[django_cms_load_balancer]'
[2012-05-16 23:15:17 -0400] dunniganp: that was from git clone git://github.com/opscode/django-quick-start.git
[2012-05-16 23:21:09 -0400] hoover_damm: libmysql-ruby may not the same way as the 'mysql' rubygem
[2012-05-16 23:21:25 -0400] hoover_damm: although ideally it should be as that should install in the site folder
[2012-05-16 23:21:32 -0400] hoover_damm: and then be available with or without rubygems (ideally)
[2012-05-16 23:21:40 -0400] mhalligan: any suggestions for debugging chef? I'm trying to figure out if some variables are actually being populated
[2012-05-16 23:22:16 -0400] mhalligan: (trying to step out while figuring out why templates aren't being populated inside of a definition)
[2012-05-16 23:22:34 -0400] hoover_damm: mhalligan, log statements sadly are the best clue sometimes
[2012-05-16 23:22:46 -0400] hoover_damm: mhalligan, log "somevar: #{node[:somevar]}"
[2012-05-16 23:22:51 -0400] hoover_damm: mhalligan, horrible suggestion
[2012-05-16 23:23:14 -0400] jessicab: dunniganp - yea, honestly i dont think that guides been tested in a few months, ive been planning on retesting it and updating it for 12 04 though.. you might want to try out the community cookbooks and see if they do what you want, since theyre upkept more
[2012-05-16 23:23:16 -0400] hoover_damm: mhalligan, but sometimes that's easier then trying to read -l debug ... shef -z should help
[2012-05-16 23:23:19 -0400] hoover_damm: as well
[2012-05-16 23:23:59 -0400] mhalligan: hoover_damm: yeah I've given up on shef. I'll try logging I guess thanks
[2012-05-16 23:26:06 -0400] mhalligan: uhm where do the log messages go to?
[2012-05-16 23:27:35 -0400] hoover_damm: stdout
[2012-05-16 23:27:39 -0400] hoover_damm: log "bob bill"
[2012-05-16 23:27:46 -0400] hoover_damm: should show "bob bill" when you run chef-client -l info
[2012-05-16 23:57:05 -0400] mhalligan: hoover_damm: could you look at this definition and maybe give me an idea what I'm doing wrong? https://gist.github.com/2715005
[2012-05-16 23:57:34 -0400] mhalligan: for some reason when I try tyo use it, I get an error inside of that bpi_conf block stating FATAL: TypeError: can't convert Symbol into Integer
[2012-05-16 23:57:42 -0400] mhalligan: am I passing variables to the definition incorrectly?
[2012-05-16 23:59:27 -0400] miah: ah
