[2012-05-26 00:00:12 -0400] hoover_damm: they use a runner with a codename I won't talk about, that fires off a wrapper called ey-enzyme
[2012-05-26 00:00:32 -0400] hoover_damm: that fetches the customers dna from a rails app, and then runs chef-solo -j /etc/chef/dna.json -c /etc/chef/solo.rb
[2012-05-26 00:00:50 -0400] hoover_damm: and then the rest is tied together with good intentions and hard work and a little execute interaction
[2012-05-26 00:00:53 -0400] hoover_damm: to keep the dashboard up to date
[2012-05-26 00:01:18 -0400] hoover_damm: I had always wanted to take Engine Yard to he server aspect.  But they were always confused and thought that would invalide themselves
[2012-05-26 00:01:25 -0400] hoover_damm: invalidate*
[2012-05-26 00:01:32 -0400] hoover_damm: and I never properly rebuffed that argument
[2012-05-26 00:01:35 -0400] hoover_damm: I tried
[2012-05-26 00:02:05 -0400] hoover_damm: the CI system that they use to ensure their cookbooks are always 'good' is pretty neat, there's lots of aspects that were interesting
[2012-05-26 00:07:56 -0400] jkeiser: ok, knife-essentials now also works on Ruby 1.8.7
[2012-05-26 00:12:44 -0400] gchristensen: hoover_damm: how do they determine that they are "good"?
[2012-05-26 00:15:38 -0400] hoover_damm: gchristensen, Truthfully, I don't work for Engine Yard anymore and I have no desire to talk about their architecture.  They likely would rather me not
[2012-05-26 00:16:00 -0400] hoover_damm: prolly best to leave it here
[2012-05-26 00:16:20 -0400] gchristensen: okay, that isn't really the nugget of my question - I'll rephrase. I'm getting started on chef and would like to ensure quality of the cookbooks, but I don't even have a clue where to start on that.
[2012-05-26 00:17:37 -0400] hoover_damm: gchristensen, ahh that perhaps I can answer better on.
[2012-05-26 00:17:57 -0400] gchristensen: I don't mean to get specifics on XYZ company :)
[2012-05-26 00:18:11 -0400] hoover_damm: gchristensen, really what they were aiming for is to be able to test that their chef cookbooks run in various scenario's
[2012-05-26 00:18:25 -0400] hoover_damm: gchristensen, now with chef .10 you have minitest and other things to help out with this
[2012-05-26 00:18:47 -0400] gchristensen: okay
[2012-05-26 00:18:56 -0400] hoover_damm: gchristensen, but honestly having jenkins fire up an instance, and run chef on that instance and then check if it failed (exit code) and throw back the results
[2012-05-26 00:19:03 -0400] hoover_damm: is the best way of testing  your cookbooks
[2012-05-26 00:19:27 -0400] gchristensen: makes sense to me. what about best-practice testing?
[2012-05-26 00:19:28 -0400] hoover_damm: you work for mom and pop shop abz... you have web frontends, and db instances typically
[2012-05-26 00:19:51 -0400] hoover_damm: so you'll want to boot instances to match what production is... because you don't ever want to have production get a suprise
[2012-05-26 00:20:07 -0400] hoover_damm: my favorite pattern of testing is both on a fresh instance, and after it's completed
[2012-05-26 00:20:35 -0400] hoover_damm: because the failures that we deal with are typically one of two kinds, one that happens because we screwed up and always happens... or one that happens on a second run
[2012-05-26 00:20:46 -0400] gchristensen: right
[2012-05-26 00:21:17 -0400] hoover_damm: so as far as best practice testing, use CI... whenever you push to git it should test your cookbooks
[2012-05-26 00:21:35 -0400] hoover_damm: enable a way for you to boot a test instance so you can debug the test scenario as well
[2012-05-26 00:21:50 -0400] hoover_damm: so that way you can then fully become the test environment
[2012-05-26 00:21:54 -0400] gchristensen: not in terms of CI best practices (I'm looking into Chef because of how large my testing infrastructure is) but in terms of testing best practices within a cookbook
[2012-05-26 00:22:11 -0400] hoover_damm: oh that generally you want to test if a service starts
[2012-05-26 00:22:28 -0400] hoover_damm: test if it works
[2012-05-26 00:22:51 -0400] gchristensen: got it
[2012-05-26 00:23:06 -0400] hoover_damm: I wish there was some special phrase or word, other then repetition, spacial thinking
[2012-05-26 00:23:33 -0400] hoover_damm: I freely admit that I can close my eyes and vision the chef run and all it's dependencies in my head
[2012-05-26 00:23:50 -0400] hoover_damm: perhaps that is a sign of my nuts... they're good nuts
[2012-05-26 00:23:55 -0400] gchristensen: heh
[2012-05-26 00:24:13 -0400] hoover_damm: but the more you can stick it in your head and envision what your trying to do and change
[2012-05-26 00:24:24 -0400] hoover_damm: the easier those bits of code are to envision as just a cog to ensure that works
[2012-05-26 00:25:14 -0400] hoover_damm: and mostly, take your time... learn to throw away your code
[2012-05-26 00:25:26 -0400] hoover_damm: if you cannot throw away your code today, you cannot grow tomorrow
[2012-05-26 00:25:32 -0400] gchristensen: I've done a lot of that. :)
[2012-05-26 00:25:48 -0400] hoover_damm: I've noticed more people willing to toss code lately
[2012-05-26 00:25:50 -0400] hoover_damm: it's refreshing
[2012-05-26 00:26:02 -0400] hoover_damm: a year ago it felt the opposite
[2012-05-26 00:26:15 -0400] gchristensen: specifically regarding chef recipes?
[2012-05-26 00:26:19 -0400] hoover_damm: yep
[2012-05-26 00:26:48 -0400] hoover_damm: when I rewrote the nginx recipes for EY I made several 'drafts'
[2012-05-26 00:26:51 -0400] hoover_damm: threw away several drafts
[2012-05-26 00:27:04 -0400] hoover_damm: until I could find the most elegent and clean method to solve the problem
[2012-05-26 00:27:05 -0400] gchristensen: my guess is the users are learning more. my first recipe was hard-won. I wasn't letting that go anywhere.
[2012-05-26 00:27:27 -0400] hoover_damm: sometimes you try to solve the problem the wrong way because your looking at it wrong
[2012-05-26 00:27:48 -0400] hoover_damm: so when your halfway through the cookbook and you realize you took a left when you should have taken a right
[2012-05-26 00:28:05 -0400] hoover_damm: it's cutting your losses when  you hit that moment of 'oh this isn't doing what I really want'...
[2012-05-26 00:28:20 -0400] hoover_damm: and yeah cookbooks are hard won, it feels like a prize
[2012-05-26 00:28:35 -0400] hoover_damm: and the harder it is for you to write said cookbook, the bigger the prize is
[2012-05-26 00:29:31 -0400] hoover_damm: I'm just a independent contractor now
[2012-05-26 00:29:33 -0400] hoover_damm: lol
[2012-05-26 00:32:57 -0400] hoover_damm: gchristensen, and lastly, test test a lot... and don't depend on your test system to not screw you one day
[2012-05-26 00:33:02 -0400] hoover_damm: murphy says it will
[2012-05-26 00:33:06 -0400] hoover_damm: so it will
[2012-05-26 00:33:49 -0400] gchristensen: I've got a pretty good background on testing :)
[2012-05-26 03:19:21 -0400] miah: hullo
[2012-05-26 05:15:58 -0400] jayd3e__: is there any way that I could use the same ssh keys that are on my host machine for my guest machine?
[2012-05-26 05:17:13 -0400] jayd3e__: I'm running into issues with git not being able to check a repo out and I don't want to have to re-generate keys each time I create a new virtual machine obviously
[2012-05-26 05:56:11 -0400] atomic-penguin: jayd3e__, redistributing public keys is easy. simply save it to your node, then template it out to another node via search
[2012-05-26 05:57:18 -0400] atomic-penguin: jayd3e__, deploying private keys is a bit more tricky as you don't really want to save secure data out on your node, or anywhere else
[2012-05-26 05:58:12 -0400] jayd3e__: atomic-penguin: so just to be clear, I just have to generate a set of keys.  Add that public key to github.  Then just put ONLY the public key on each virtualbox, by using the RemoteFile resource or someting
[2012-05-26 05:58:16 -0400] jayd3e__: something*
[2012-05-26 06:06:02 -0400] atomic-penguin: jayd3e__, I've got an example of using the sshkey gem in my gitlab cookbook https://github.com/atomic-penguin/cookbook-gitlab/blob/master/recipes/default.rb
[2012-05-26 06:07:45 -0400] atomic-penguin: jayd3e__, I'd see if you could adapt that to your case to save the public key to a chef managed node.  Perhaps you can use that to template out your authorized_keys files on your other hosts
[2012-05-26 06:08:18 -0400] jayd3e__: ok cool thanks
[2012-05-26 06:08:32 -0400] jayd3e__: I think I can use that as a reference to get it working
[2012-05-26 06:09:43 -0400] atomic-penguin: jayd3e__, I would avoid saving private keys to a chef managed node object though, just for the security implications alone.
[2012-05-26 06:11:09 -0400] atomic-penguin: jayd3e__, that is, I think its acceptable to template out the private key on the managed server itself, it isn't probably a good idea to save the private key back to your chef-server, or the opscode platform.
[2012-05-26 06:18:38 -0400] atomic-penguin: Alrighty then, I'm off to bed
[2012-05-26 15:32:55 -0400] thedeeno: do clients and nodes have a one to one relationship? I'm not understanding the difference
[2012-05-26 15:36:46 -0400] hoover_damm: basically
[2012-05-26 15:37:08 -0400] hoover_damm: node stores the actual meta-data of the node, where the client is the RSA Key relationship
[2012-05-26 15:37:27 -0400] hoover_damm: perhaps that statement isn't too wrong
[2012-05-26 16:11:34 -0400] atomic-penguin: thedeeno, node is an object, client is a key pair
[2012-05-26 16:12:07 -0400] atomic-penguin: thedeeno, so the client keys could be either for a human or a node object.
[2012-05-26 16:12:45 -0400] atomic-penguin: ...or even client keys for a Chef dashboard/WebUI
[2012-05-26 16:13:45 -0400] atomic-penguin: A node is the unit your managing, whether it be a router/switch/server/workstation
[2012-05-26 16:44:25 -0400] thedeeno: atomic-penguin: so, in theory, I could make a single key for myself and tell chef-client to leverage it during a run?
[2012-05-26 16:45:20 -0400] thedeeno: hoover_damm: ^
[2012-05-26 16:45:43 -0400] thedeeno: a single key to use for all nodes, that is
[2012-05-26 16:48:11 -0400] hoover_damm: You could do that, but that's wrong
[2012-05-26 16:48:41 -0400] hoover_damm: If you need to use chef in a script, or outside of a chef run creating a client for said purpose is +1
[2012-05-26 16:48:57 -0400] hoover_damm: But a client key is tied to the node name, so the relationship is client name to node name
[2012-05-26 16:49:35 -0400] hoover_damm: so client key "bobby" (at least by default) will try and use the node "bobby".  It is possible to manipulate the client acl in the hosted version
[2012-05-26 16:49:58 -0400] hoover_damm: the only single key for all nodes really is the validation key
[2012-05-26 16:50:23 -0400] hoover_damm: it's a non-administrative key that allows the client to self-register a client and recieve the key for said client
[2012-05-26 16:50:40 -0400] hoover_damm: node entry is made, chef runs, node.save fills in the node entry
[2012-05-26 16:51:08 -0400] hoover_damm: thedeeno, now i've likely spilled enough wrong crap.  http://wiki.opscode.com/display/chef/Authentication+and+Authorization
[2012-05-26 16:51:51 -0400] hoover_damm: private / hosted chef has this following ACL http://wiki.opscode.com/display/chef/Hosted+Chef+Authorization
[2012-05-26 16:53:13 -0400] hoover_damm: thedeeno, the mailing list is also great for answers :) so if you are not getting what you need on IRC, please hit up the Mailing list.  http://lists.opscode.com/sympa
[2012-05-26 17:00:09 -0400] thedeeno: hoover_damm: great info, thanks! I've been pooring over the wiki, but the learning curve is not exactly shallow here :) I pretty much missed this whole section. Reading...
[2012-05-26 17:28:23 -0400] hoover_damm: thedeeno, learning curve is very steep.  Reading the source code is often the best way to learn.
[2012-05-26 17:53:40 -0400] thedeeno: hoover_damm: curious, is there a reason why the client key sticks around even if a node is deleted then?
[2012-05-26 17:53:49 -0400] thedeeno: My confusion stems from deleteing a node and bootstrapping another node with the same host name and chef complaining about the client already existing. I can delete the key, but is there a way to tell knife bootstrap to use the existing one?
[2012-05-26 17:54:01 -0400] thedeeno: I see the -k option, but I'm not sure how to pull down the existing key
[2012-05-26 17:54:19 -0400] hoover_damm: you don't
[2012-05-26 17:55:53 -0400] hoover_damm: when you delete a ec2 instance using the knife tool it doesn't delete the node object or the client object.  I think this errs on the idea of intentional so that if a node is deleted you can see where it was
[2012-05-26 17:56:26 -0400] hoover_damm: you can regenerate keys, but you cannot download a pre-existing key on the open source version
[2012-05-26 17:56:36 -0400] hoover_damm: the hosted version I think you can redownload the key, but I could be wrong
[2012-05-26 18:05:15 -0400] yfeldblum: hoover_damm, not as far as i'm aware
[2012-05-26 19:18:44 -0400] thedeeno: Anyone know why `knife ssh node name:staging` would give me "FATAL: No nodes returned from search" but `knif search node name:staging` would correctly return a result? Since 'search' works I suspect bug? Or am I missing something?
[2012-05-26 19:19:04 -0400] thedeeno: knife -v = 0.10.10
[2012-05-26 19:29:49 -0400] yfeldblum: thedeeno, invoke knife-ssh like this: `knife ssh 'name:staging' COMMAND`
[2012-05-26 19:30:06 -0400] yfeldblum: thedeeno, don't need the `node` argument in there, that's only for search not for ssh
[2012-05-26 19:33:12 -0400] thedeeno: yfeldblum: odd, `knife ssh name:staging COMMAND` returns the same error
[2012-05-26 19:33:22 -0400] thedeeno: if i wrap name:staging in quotes, same thing
[2012-05-26 19:35:26 -0400] thedeeno: wait, nvm, had a type
[2012-05-26 19:35:29 -0400] thedeeno: typo
[2012-05-26 19:35:30 -0400] thedeeno: thanks!
[2012-05-26 19:59:57 -0400] yfeldblum: thedeeno, no prob
[2012-05-26 20:02:34 -0400] kisoku: so I'm trying out hosted chef for the first time (even though having used open source chef for many years) and i can't seem to get knife working at all
[2012-05-26 20:02:40 -0400] kisoku: keep getting 401
[2012-05-26 20:03:03 -0400] kisoku: I've tried regenerating the API and my client key repeatedly with no luck
[2012-05-26 20:03:15 -0400] kisoku: and my clock is definitely in sync
[2012-05-26 20:16:12 -0400] yfeldblum: kisoku, yeah, weird when that happens ... might want to open a customer support ticket?
[2012-05-26 20:16:29 -0400] yfeldblum: kisoku, http://help.opscode.com/
[2012-05-26 20:17:00 -0400] yfeldblum: kisoku, that site is for people using hosted & private
[2012-05-26 21:28:41 -0400] miah: herp
[2012-05-26 23:14:24 -0400] hoover_damm: different audiance, but oh my gosh it's true.
[2012-05-26 23:14:38 -0400] yfeldblum: ?
[2012-05-26 23:14:57 -0400] hoover_damm: http://www.catb.org/~esr/faqs/smart-questions.html
[2012-05-26 23:16:40 -0400] hoover_damm: one of my best quotes to take from it is The first thing to understand is that hackers actually like hard problems and good, thought-provoking questions about them. If we didn't, we wouldn't be here. If you give us an interesting question to chew on we'll be grateful to you; good questions are a stimulus and a gift. Good questions help us develop our understanding, and often reveal problems we might not have noticed or thought about otherwise. Among hacke
[2012-05-26 23:36:31 -0400] xiaotian: hi, I just installed chef on 10.04 LTS, with system ruby, ruby-dev.  rubygems
[2012-05-26 23:36:43 -0400] xiaotian: after gem install chef ruby-shadow
[2012-05-26 23:37:23 -0400] xiaotian: I found chef binaries are installed under /var/lib/gems/1.8/bin
[2012-05-26 23:37:41 -0400] xiaotian: I install them as root user
[2012-05-26 23:37:53 -0400] xiaotian: am I doing something wrong?
[2012-05-26 23:42:33 -0400] vluther: can i have run chef-client and assign myself a role?
[2012-05-26 23:46:45 -0400] xiaotian: ok I found it, known issue with ubuntu. but looks like it's been fixed in 12.04LTS
