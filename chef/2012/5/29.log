[2012-05-29 00:28:58 -0400] yfeldblum: Ramblurr, if you're querying the system, why are you doing it inside the ruby_block?
[2012-05-29 00:30:06 -0400] Ramblurr: yfeldblum: because i have dependencies among resources
[2012-05-29 00:30:44 -0400] Ramblurr: some resource do some stuff (install firefox and create a profile in this case)
[2012-05-29 00:30:54 -0400] Ramblurr: then i need to check the results of that on disk (read the profile name)
[2012-05-29 00:32:44 -0400] yfeldblum: Ramblurr, why don't you specify what the profile name shall be, rather than leaving it up in the air and asking the system what it is?
[2012-05-29 00:52:50 -0400] SplasPood: Anyone using knife-lastrun?
[2012-05-29 01:00:53 -0400] hoover_damm: what's it different from knife status?
[2012-05-29 01:01:52 -0400] hoover_damm: neat, looks like it's just abusing what chef stores.
[2012-05-29 01:25:03 -0400] erikh: hey folks, is there any launchd sauce for chef-client?
[2012-05-29 02:27:08 -0400] yfeldblum: anyone else in here wishing librarian-chef would strip out .git directories from git-sourced cookbooks when it installs your cookbooks?
[2012-05-29 02:49:32 -0400] larrywright: I'm running chef on a rackspace cloud server (created with knife rackspace server create), but chef doesn't seem to know it's a Rackspace cloud server.
[2012-05-29 02:51:43 -0400] larrywright: noteably, things like 'node[:rackspace][:private_ip] don't work
[2012-05-29 02:52:40 -0400] larrywright: any idea how to convince chef that it's a Rackspace server?
[2012-05-29 02:57:30 -0400] flaccid_: does chef do like node[:cloud][:private_ip]
[2012-05-29 02:59:57 -0400] larrywright: I can check.
[2012-05-29 03:01:34 -0400] larrywright: Hmm
[2012-05-29 03:01:38 -0400] larrywright: That does seem to work
[2012-05-29 03:01:45 -0400] larrywright: sort of
[2012-05-29 03:02:02 -0400] larrywright: it's node[:cloud][:private_ips]
[2012-05-29 03:02:06 -0400] larrywright: which is an array
[2012-05-29 03:02:13 -0400] larrywright: of one element
[2012-05-29 03:04:07 -0400] larrywright: The weird thing is that I built another server on Rackspace last week, using the same version of Chef, and node[:rackspace][:private_ip] worked just fine
[2012-05-29 03:04:42 -0400] larrywright: But node[:cloud][:private_ips].first does seem to give me what I want
[2012-05-29 03:25:09 -0400] larrywright: Well
[2012-05-29 03:25:47 -0400] larrywright: Except not I have a server that doesn't have either [:cloud] or [:rackspace] populated
[2012-05-29 03:26:00 -0400] larrywright: This is frustrating
[2012-05-29 03:29:18 -0400] hoover_damm: larrywright, if you create /etc/chef/ohai/hints/rackspace.json it should indicate that you are on rackspace
[2012-05-29 03:29:29 -0400] hoover_damm: and then ohai cloud should be valid
[2012-05-29 03:29:43 -0400] hoover_damm: http://tickets.opscode.com/browse/KNIFE_RACKSPACE-32
[2012-05-29 03:30:09 -0400] hoover_damm: looks like knife should create this file now
[2012-05-29 03:30:32 -0400] hoover_damm: oor not
[2012-05-29 03:30:46 -0400] hoover_damm: looks like you'd need to use the knife-rackspace from master to have that behavior work right.
[2012-05-29 03:31:27 -0400] hoover_damm: so latest ohai (from rubygems)  + latest knife-rackspace (from master) looks like it should be a working combination
[2012-05-29 03:31:40 -0400] hoover_damm: hth
[2012-05-29 03:32:42 -0400] larrywright: hmm
[2012-05-29 03:33:00 -0400] larrywright: Not sure what version of knife-rackspace I'm running
[2012-05-29 03:34:11 -0400] larrywright: 0.5.12
[2012-05-29 03:34:20 -0400] larrywright: Latest looks to be 0.5.14
[2012-05-29 03:37:18 -0400] larrywright: So is there any way to force it to know that it's a Rackspace server?
[2012-05-29 04:22:58 -0400] zebers: in a recipe, am I able to create a variable from an execute resource then use that in another resource (like file, or another execute resource)
[2012-05-29 04:29:10 -0400] qurve: Should default_attributes defined in an environment override the defaults from a cookbook?
[2012-05-29 04:29:57 -0400] qurve: Trying to figure out why the mysql cookbook seems to be ignoring my 'mysql' => {'server_root_password' => '...'} default_attributes in an environment.
[2012-05-29 04:42:57 -0400] Twirrim: Hi.. seem to be having a bit of fun with Chef and CentOS 6.  It's deciding that an rpm is installed when it isn't.  Is there any way to get the subsystems to debug as well as chef-client?  I'd like to try and find out what it's actually doing to falsely figure this out.
[2012-05-29 04:45:54 -0400] Twirrim: http://pastebin.com/raw.php?i=fjJ4ByMt
[2012-05-29 04:46:04 -0400] Twirrim: you can see what it's doing there :)
[2012-05-29 04:54:52 -0400] silk: twirrum, looks like it is trying to parse the output from "rpm -qp --queryformat '%{NAME} %{VERSION}-%{RELEASE}\n' #{@new_resource.source}"
[2012-05-29 04:55:25 -0400] silk: What does the resource look like?
[2012-05-29 04:56:32 -0400] Twirrim: this is the standard yum cookbook from opscode (with the version number changed).  The file it downloads is a valid rpm archive that can be installed.
[2012-05-29 04:56:45 -0400] Twirrim: the epel version number changed, I should add.
[2012-05-29 04:58:13 -0400] flaccid_: http://wiki.opscode.com/display/chef/Installing+Chef+Client+on+Ubuntu+or+Debian#InstallingChefClientonUbuntuorDebian-PackageInstallation no precise/12.04?
[2012-05-29 04:58:51 -0400] flaccid_: i think doc needs update
[2012-05-29 05:09:54 -0400] silk: [Mon, 28 May 2012 23:39:46 -0400] DEBUG: rpm_package[epel-release] current version is epel-release << that line looks a little dodgey
[2012-05-29 05:10:51 -0400] qurve: chef-client crashed more often than not on ubuntu 11.10 or 12.04 in my testing today.
[2012-05-29 05:11:18 -0400] qurve: Granted today is my first day using chef, so I have no idea what could be wrong.
[2012-05-29 05:11:57 -0400] qurve: And now GitHub isn't accepting pushes. The universe conspires against me getting anything done today :)
[2012-05-29 05:12:07 -0400] silk: and i would gues it is something to do with the - in the regex, can you show me the output of "rpm -qp --queryformat '%{NAME} %{VERSION}-%{RELEASE}\n' epel-release"
[2012-05-29 05:12:55 -0400] BryanWB_: good morning chefs!
[2012-05-29 05:14:48 -0400] Twirrim: silk: http://pastebin.com/raw.php?i=JTwUvbr4
[2012-05-29 05:15:10 -0400] Twirrim: looks like it needs to be pointed at an RPM file to work (that's the file in the cache from chef in the second case)
[2012-05-29 05:19:44 -0400] Twirrim: silk: it's deciding "nothing" at line 32, this is the source recipe: https://github.com/opscode/cookbooks/blob/master/yum/recipes/epel.rb.  Not quite sure I'm following why.. guess I need to spend a bit more time learning Ruby / Chef :D
[2012-05-29 05:22:28 -0400] Twirrim: ahh I just found the rabit hole.. *dives in to /usr/lib/ruby/vendor_ruby/chef/resource/rpm_package.rb"
[2012-05-29 05:26:32 -0400] silk: yes :)
[2012-05-29 05:39:11 -0400] silk: actually, this may be the notify bug someone was talking about on the mailing list the other day, are you using 0.10.10 ?
[2012-05-29 05:41:13 -0400] silk: http://tickets.opscode.com/browse/CHEF-3135
[2012-05-29 05:41:18 -0400] Twirrim: yes
[2012-05-29 05:41:44 -0400] Twirrim: ahhh
[2012-05-29 05:41:45 -0400] geekyogi: I'm bootstrapping Windows 2008, and the client.pem file is not copied to C:\chef any suggestion..?
[2012-05-29 05:42:03 -0400] silk: have a look at the patch outlined in it and see if that fixes
[2012-05-29 05:45:31 -0400] geekyogi: any suggestions on who copies the client.rb file on windows
[2012-05-29 05:46:04 -0400] silk: Sorry, havent used windows for a while and never with chef
[2012-05-29 05:47:27 -0400] geekyogi: @silk thanks.. I'm using 0.10.6.. still investigating..
[2012-05-29 05:47:56 -0400] silk: Youi're following this: http://wiki.opscode.com/display/chef/Knife+Windows+Bootstrap ?
[2012-05-29 05:47:58 -0400] Twirrim: silk: that did fixed it
[2012-05-29 05:48:07 -0400] Twirrim: *that fixed it
[2012-05-29 05:48:28 -0400] silk: ok, cool
[2012-05-29 05:49:20 -0400] Twirrim: that's a little irritating, I guess I can make a temporary change in the yum cookbook to fix the file :D
[2012-05-29 05:49:33 -0400] silk: the thread is here: http://lists.opscode.com/sympa/arc/chef/2012-05/msg00233.html
[2012-05-29 05:51:40 -0400] geekyogi: @silk, how can we generate client.pem file on the chef server?
[2012-05-29 05:53:02 -0400] silk: How are ryou boostrapping the node?
[2012-05-29 05:53:09 -0400] silk: with the URL i pasted earlier?
[2012-05-29 05:54:32 -0400] geekyogi: I'm using the knife bootstrap windows ssh <hostname> -x username -P password --node-name <hostname> -y
[2012-05-29 05:57:03 -0400] geekyogi: I'm using internal Chef server
[2012-05-29 05:58:26 -0400] silk: so the client.rb shoujld be being populated via the bootstrap command based on your knife.rb
[2012-05-29 05:59:14 -0400] geekyogi: so does the client.pem file gets generated on every bootstrap ?
[2012-05-29 05:59:16 -0400] ares_cz: Hi, I've changed IP of one chef client, now it cannot connect to server resulting in 403 "Forbidden" error, how should I fix it?
[2012-05-29 05:59:56 -0400] silk: geekyogi, yes and used to register te client the first tiem chef-clietn is run
[2012-05-29 06:00:16 -0400] geekyogi: oh k coool..
[2012-05-29 06:00:18 -0400] geekyogi: will try out
[2012-05-29 06:01:22 -0400] silk: geekyogi, sorry
[2012-05-29 06:01:30 -0400] silk: i misread client.pem as client.rb
[2012-05-29 06:01:53 -0400] silk: ignore just about everything i said :)
[2012-05-29 06:06:39 -0400] ares_cz: forget my question, my fault, nginx blocked that IP
[2012-05-29 06:06:52 -0400] geekyogi: @silk, np..
[2012-05-29 06:07:42 -0400] geekyogi: @silk any suggestion on how to generate the client.pem file ?
[2012-05-29 06:07:48 -0400] silk: What is the output of the chef-client run?
[2012-05-29 06:09:38 -0400] geekyogi: [Tue, 29 May 2012 05:30:20 +0000] INFO: *** Chef 0.10.6 ***
[2012-05-29 06:09:38 -0400] geekyogi: [Tue, 29 May 2012 05:30:36 +0000] INFO: Client key c:/chef/client.pem is not pre
[2012-05-29 06:09:38 -0400] geekyogi: sent - registering
[2012-05-29 06:09:38 -0400] geekyogi: [Tue, 29 May 2012 05:30:40 +0000] INFO: HTTP Request Returned 401 Unauthorized:
[2012-05-29 06:09:38 -0400] geekyogi: Failed to authenticate. Please synchronize the clock on your client
[2012-05-29 06:09:39 -0400] geekyogi: [Tue, 29 May 2012 05:30:40 +0000] FATAL: Stacktrace dumped to c:/chef/cache/chef
[2012-05-29 06:09:39 -0400] geekyogi: -stacktrace.out
[2012-05-29 06:09:39 -0400] geekyogi: [Tue, 29 May 2012 05:30:40 +0000] FATAL: Net::HTTPServerException: 401 "Unauthor
[2012-05-29 06:09:40 -0400] geekyogi: ized"
[2012-05-29 06:09:58 -0400] c_t: Did you synchronize your clock?
[2012-05-29 06:10:28 -0400] geekyogi: @c_t yes the clock is synchronized to PDT on both Chef server and the windows
[2012-05-29 06:10:42 -0400] geekyogi: node
[2012-05-29 06:14:42 -0400] geekyogi: client.pem file is missing in /etc/chef/ directory
[2012-05-29 06:17:05 -0400] silk: well, its not there because you didnt successfully register
[2012-05-29 06:17:26 -0400] silk: somethign thinks that your client timestamp isnt in sync with the server
[2012-05-29 06:17:27 -0400] geekyogi: I mean on the chef server..
[2012-05-29 06:18:26 -0400] geekyogi: I've two chef servers, one working completely fine.. another is not..  the working chef server has the client.pem file in /etc/chef
[2012-05-29 06:34:31 -0400] vigith: i need to start a service, do some stuffs.. then stop it
[2012-05-29 06:35:24 -0400] vigith: can i use 'service' resource, start it.. then do some stuffs (bash script).. then use 'service' resource again and stop it
[2012-05-29 06:37:40 -0400] silk: i think it should be possible, but it seems pretty odd.
[2012-05-29 06:38:15 -0400] silk: im fairly sure i have defined the same resource twice by accident and been perpetually updating it
[2012-05-29 06:39:36 -0400] silk: you should be able to stop the resource as part of a notify on the script resource.
[2012-05-29 06:39:40 -0400] cwj: have your bash script send a notification to the service with action 'stop'
[2012-05-29 06:39:51 -0400] cwj: the bash script resource that is
[2012-05-29 06:40:50 -0400] vigith: ok.. thank you
[2012-05-29 06:41:30 -0400] cwj: http://wiki.opscode.com/display/chef/Resources#Resources-Notifications
[2012-05-29 06:42:43 -0400] vigith: thank you
[2012-05-29 06:50:06 -0400] geekyogi: I restarted my chef-server.. validation.pem file was created.. but client.pem file is not created.. any suggestions ?
[2012-05-29 06:51:32 -0400] lowg:  Hi All, anyone have a way to get around a TimeOut Exception on a long running Windows Install using windows_package
[2012-05-29 06:52:27 -0400] lowg: geekyogi, I had something similar where the time hadn't sync'ed yet.  But that's the extent of my insight into it
[2012-05-29 06:53:00 -0400] tomoj: chef-server isn't supposed to create client.pem, is it?
[2012-05-29 06:53:26 -0400] erikh: knife bootstrap -i
[2012-05-29 06:53:30 -0400] silk: lowg: http://wiki.opscode.com/display/chef/Resources :timeout ?
[2012-05-29 06:53:47 -0400] tomoj: client.pem gets created by the client using the validation key
[2012-05-29 06:54:31 -0400] tomoj: well, the server creates it I suppose, but by the client's request?
[2012-05-29 06:55:09 -0400] geekyogi: @tomoj, oh okay.. the timezones of the chef-server and the client are synced up using NTP.. Timezone shouldn't be the issue..
[2012-05-29 06:55:13 -0400] erikh: I'm pretty sure you want to knife bootstrap -i
[2012-05-29 06:55:23 -0400] erikh: if you're creating the client on the chef server itself
[2012-05-29 06:55:32 -0400] geekyogi: @erikh, let me try that
[2012-05-29 06:55:36 -0400] erikh: do it as root
[2012-05-29 06:55:39 -0400] geekyogi: okay
[2012-05-29 06:56:20 -0400] lowg: silk, I read that to only apply to the not_if
[2012-05-29 06:57:59 -0400] vigith: from the script resource, can i send both start and stop notification to a service?
[2012-05-29 06:58:47 -0400] erikh: anyhow, bedtime for me; geekyogi good luck
[2012-05-29 06:59:14 -0400] geekyogi: @erikh, thanks a lot.. have a nice sleep.. good night
[2012-05-29 07:00:06 -0400] erikh: oh derp it's knife configure -i
[2012-05-29 07:00:08 -0400] erikh: not bootstrap
[2012-05-29 07:00:15 -0400] erikh: very sorry
[2012-05-29 07:00:22 -0400] erikh: I've been playing with bootstrap templates all night.
[2012-05-29 07:00:22 -0400] geekyogi: oh okay..
[2012-05-29 07:00:26 -0400] geekyogi: :D
[2012-05-29 07:00:36 -0400] cwj: vigith: yes you can send as many notifications as you want, but if your flow is 1. start service 2. do stuff 3. stop service 4. have a pint, then i dont think you will want to send both start and stop notifications from the execute resource
[2012-05-29 07:00:41 -0400] cwj: er bash resource
[2012-05-29 07:00:42 -0400] erikh: ok bedtime for real now
[2012-05-29 07:02:05 -0400] vigith: but, when i tried .. i found it is sending notfication after executing the bash script
[2012-05-29 07:03:22 -0400] vigith: http://pastebin.ca/2155355
[2012-05-29 07:03:54 -0400] cwj: right, notifications are only sent when a resource completes its actions
[2012-05-29 07:04:07 -0400] vigith: so.. how do i do it?
[2012-05-29 07:04:55 -0400] geekyogi: @erikh, still there?
[2012-05-29 07:05:17 -0400] BryanWB_: cwj: hey mustache hero!
[2012-05-29 07:05:22 -0400] geekyogi: it says 'client root already exists'
[2012-05-29 07:05:26 -0400] cwj: BryanWB_: what up :D
[2012-05-29 07:05:38 -0400] silk: vigith, o would set the action in the service to :start and only have the stop notofy
[2012-05-29 07:05:47 -0400] silk: (asusming that there was no other way to get this done)
[2012-05-29 07:06:43 -0400] cwj: http://pastebin.ca/2155356
[2012-05-29 07:06:45 -0400] cwj: i guess
[2012-05-29 07:06:49 -0400] silk: additionally, you may be able to have the service notify the script to execute, but its going to start looking wiggy
[2012-05-29 07:06:58 -0400] vigith: thank you.. i was thinking i can reuse my service resource, if it does nothing by default
[2012-05-29 07:09:28 -0400] cwj: or maybe you have to have your service first if you want to subscribe to it
[2012-05-29 07:11:15 -0400] cwj: http://pastebin.ca/2155359
[2012-05-29 07:11:18 -0400] cwj: might work better
[2012-05-29 07:17:53 -0400] geekyogi: Guys.. I'd like to contribute to Chef.. I've no knowledge of Ruby though.. suggestions on where I should start ?
[2012-05-29 07:20:05 -0400] mohits: geekyogi, you can start with >> http://wiki.opscode.com/display/chef/Just+Enough+Ruby+for+Chef
[2012-05-29 07:20:22 -0400] mohits: geekyogi, also go through http://wiki.opscode.com
[2012-05-29 07:20:36 -0400] mohits: thats how i started :)
[2012-05-29 07:21:07 -0400] mohits: fyi /me is no opscode guy, just enthusiate
[2012-05-29 07:21:34 -0400] mohits: s/enthusiate/enthusiat
[2012-05-29 07:21:34 -0400] geekyogi: @mohits, yeah I know about it.. but the documentation is just too big.. and clumsy.. my perception.. any other resource ?
[2012-05-29 07:23:35 -0400] mohits: geekyogi, i believe you can checkout opscode's youtube channel for a super-fast start
[2012-05-29 07:52:41 -0400] BryanWB_: geekyogi: the definitive book is coming from O'Reilly but it is not here yet :(
[2012-05-29 07:52:57 -0400] BryanWB_: geekyogi: i wrote a quickstart guide but there are many
[2012-05-29 07:53:22 -0400] BryanWB_: http://devopsanywhere.blogspot.it/2011/10/stupid-simple-chef-tutorial-for-dirty.html
[2012-05-29 07:53:31 -0400] BryanWB_: not sure mine is the best
[2012-05-29 07:55:09 -0400] coderanger: Anyone online that is familiar with haproxy?
[2012-05-29 07:55:30 -0400] BryanWB_: coderanger: i am somewhat familiar
[2012-05-29 07:56:02 -0400] BryanWB_: what u need?
[2012-05-29 07:56:16 -0400] coderanger: It seems like the common syntax when setting up a proxy is something like "listen <name> <ip>:<port> \n <opts>"
[2012-05-29 07:56:23 -0400] coderanger: but the docs don't mention that as valid
[2012-05-29 07:56:37 -0400] coderanger: is the ip+port just sugar for the bind option?
[2012-05-29 07:57:17 -0400] BryanWB_: hmm, i have never put the ip, just the port
[2012-05-29 07:57:27 -0400] BryanWB_: the port is required for bind
[2012-05-29 07:57:28 -0400] coderanger: same thing
[2012-05-29 07:58:00 -0400] coderanger: you could either (it seems) do "listen foo \n bind :80" or just "listen foo :80"
[2012-05-29 07:58:09 -0400] coderanger: I just can't find anything in the docs about the latter
[2012-05-29 07:58:27 -0400] coderanger: but the opscode templates and most of the examples not on the official site use the latter
[2012-05-29 07:59:53 -0400] BryanWB_: coderanger: i c an example in section 2.3
[2012-05-29 08:00:07 -0400] BryanWB_: http://cbonte.github.com/haproxy-dconv/configuration-1.5.html#2.3
[2012-05-29 08:00:42 -0400] coderanger: None of those are using the shorter syntax, unless I'm missing something
[2012-05-29 08:01:10 -0400] coderanger: they both use the bind option explicitly
[2012-05-29 08:01:24 -0400] BryanWB_: true
[2012-05-29 08:28:14 -0400] geekyogi: @BryanWB_ thanks :)
[2012-05-29 08:44:24 -0400] coderanger: The output of my nights insanity
[2012-05-29 08:44:25 -0400] coderanger: http://hastebin.com/rujudivedi.rb
[2012-05-29 08:44:43 -0400] coderanger: Drop that in a resource file and you get instant subresource-ish DSL :)
[2012-05-29 08:52:48 -0400] geekyogi: I get the error HTTP Request Returned 401 Unauthorized: failed to authenticate. Please synchroize the clock on your client..
[2012-05-29 08:53:47 -0400] geekyogi: do I have to change the timezone
[2012-05-29 08:53:57 -0400] geekyogi: on both client and the Chef server to be same?
[2012-05-29 08:54:07 -0400] geekyogi: could that be the issue ?
[2012-05-29 08:57:44 -0400] coderanger: No
[2012-05-29 08:57:54 -0400] coderanger: The clock just needs to be correct
[2012-05-29 08:58:29 -0400] geekyogi: verified.. both the clock are exactly same.. synchronized
[2012-05-29 08:58:32 -0400] geekyogi: to NTP server
[2012-05-29 08:59:14 -0400] coderanger: Are you using FOSS server or Hosted?
[2012-05-29 08:59:39 -0400] geekyogi: FOSS server
[2012-05-29 09:00:33 -0400] BryanWB_: coderanger: sweet! very nice
[2012-05-29 09:01:02 -0400] BryanWB_: geekyogi: are u using vmware?
[2012-05-29 09:01:18 -0400] geekyogi: @BryanWB_ yes
[2012-05-29 09:01:33 -0400] BryanWB_: geekyogi: vsphere?
[2012-05-29 09:01:50 -0400] geekyogi: BryanWB_ yes.. VMware vSphere
[2012-05-29 09:01:53 -0400] geekyogi: 5.0
[2012-05-29 09:02:45 -0400] BryanWB_: geekyogi: here is what i do to 100% ensure that the time is synced https://gist.github.com/2823423
[2012-05-29 09:03:20 -0400] geekyogi: cool.. and on Windows machine ?
[2012-05-29 09:03:32 -0400] BryanWB_: geekyogi:  i found that on first bootstrap, vms still using hw clock despite having ntp configured
[2012-05-29 09:03:41 -0400] BryanWB_: umm, no idea about windows ;(
[2012-05-29 09:03:57 -0400] geekyogi: oh.. I get it now.. cool guys.. let me try
[2012-05-29 09:05:12 -0400] ee07b577: anyone knows whether ubuntu 12.04 supports chef ?
[2012-05-29 09:05:29 -0400] coderanger: ee07b577: Given that I'm using it at this moment, yes :)
[2012-05-29 09:06:53 -0400] ee07b577: error occurs when I exwcut " apt-get upgrade"
[2012-05-29 09:07:50 -0400] coderanger: What error?
[2012-05-29 09:08:10 -0400] ee07b577: says : Setting up chef-solr (0.10.10-1) ... Creating user "chef" ... Error: {user_already_exists,<<"chef">>} dpkg: error processing chef-solr (--configure):  subprocess installed post-installation script returned error exit status 2 dpkg: dependency problems prevent configuration of chef-expander:  chef-expander depends on chef-solr (>= 0.10.10); however:   Package chef-solr is not configured yet. dpkg: error processing chef-expander
[2012-05-29 09:08:24 -0400] ee07b577: I don't know how to recover it
[2012-05-29 09:08:25 -0400] geekyogi: @BryanWB_ it didn't work.. :( clocks are synced
[2012-05-29 09:08:41 -0400] zebers: Am I able to upload cookbook's to the community via the web interface @ community, or should I do a pull request against opscode-cookbooks ?
[2012-05-29 09:09:56 -0400] coderanger: zebers: Either the webui or knife
[2012-05-29 09:10:08 -0400] zebers: Alrighty thanks
[2012-05-29 09:10:11 -0400] coderanger: opscode-cookbooks is only for ours, not community stuff :)
[2012-05-29 09:10:23 -0400] zebers: Ooo, sorry got confused :D
[2012-05-29 09:10:33 -0400] coderanger: ee07b577: Are you trying to use the old apt packages?
[2012-05-29 09:10:40 -0400] coderanger: ee07b577: Grab the new omnibus installer
[2012-05-29 09:10:55 -0400] coderanger: Oh right, the server hasn't been released yet
[2012-05-29 09:11:21 -0400] coderanger: ee07b577: Probably want to either install via solo or drop back to 11.04 for installing a server
[2012-05-29 09:11:51 -0400] ee07b577: U mean I should wait until chef server for ubuntu 12.04 to be released ?
[2012-05-29 09:11:53 -0400] coderanger: omnibus server debs are Soon
[2012-05-29 09:12:15 -0400] coderanger: ee07b577: We are changing the way the debs are setup, chef server itself works fine on 12.04
[2012-05-29 09:12:22 -0400] coderanger: but the 11.04 debs do not
[2012-05-29 09:12:23 -0400] coderanger: :)
[2012-05-29 09:12:35 -0400] drrk: Hi, what do peopl use for managing chef users?  ie not system ueerts on hosts, but the  sysadmin user credential for chef
[2012-05-29 09:12:36 -0400] coderanger: so either install another way, such as chef-solo
[2012-05-29 09:12:42 -0400] drrk: this is for the opensource chef server
[2012-05-29 09:12:55 -0400] drrk: hmm typing fail there, sorry
[2012-05-29 09:14:01 -0400] ee07b577: OK, thank you coderanger
[2012-05-29 09:18:41 -0400] zebers: trying to upload this cookbook to community it says I need a metadata.json but I created one via knife from the metadata.rb; anything Im missing?
[2012-05-29 09:18:59 -0400] coderanger: How are you uploading?
[2012-05-29 09:20:34 -0400] zebers: coderanger: through the webui with a tar ball
[2012-05-29 09:21:00 -0400] coderanger: Triple check the metadata,json is actually in the archive
[2012-05-29 09:21:04 -0400] coderanger: and in the right place
[2012-05-29 09:21:27 -0400] coderanger: Alternatively, just use knife to do it
[2012-05-29 09:21:45 -0400] coderanger: knife cookbook site share --help
[2012-05-29 09:22:55 -0400] coderanger: okay, 2:30, need to sleep about an hour ago
[2012-05-29 09:22:57 -0400] coderanger: gnite all
[2012-05-29 09:23:25 -0400] zebers: Thanks
[2012-05-29 09:36:49 -0400] BryanWB_: drrk: i use users cookbook and the lwrp for it
[2012-05-29 09:37:12 -0400] BryanWB_: manage_users
[2012-05-29 09:37:59 -0400] drrk: http://community.opscode.com/cookbooks/users <- this one?
[2012-05-29 09:38:36 -0400] BryanWB_: drrk: y
[2012-05-29 09:39:27 -0400] drrk: not that sort of user I think, I mean users than than add cookbooks, edit runlists etc with knife
[2012-05-29 09:43:11 -0400] BryanWB_: oh!
[2012-05-29 09:44:00 -0400] drrk: I thikn it's over looked as so many people just use hosted chef
[2012-05-29 09:50:56 -0400] zebers: drrk, not as many as you'd think, although it has serious advantage. But what do you mean managing users? Do you mean like just adding other users?
[2012-05-29 09:51:51 -0400] BryanWB_: bet there's knife plugin somewhere that makes it easier
[2012-05-29 09:54:00 -0400] zebers: Well, I'm just trying to figure out if he is referring to like the ACL's that hosted/private chef have
[2012-05-29 10:01:21 -0400] itwasntandy: hey
[2012-05-29 10:01:33 -0400] itwasntandy: https://manage.opscode.com/ returns http 500 for me
[2012-05-29 10:01:36 -0400] itwasntandy: is that expected?
[2012-05-29 10:13:04 -0400] ashb: itwasntandy: working for me now
[2012-05-29 10:32:26 -0400] itwasntandy: yep, it works now.
[2012-05-29 11:08:08 -0400] jeekl: Getting an argument error for a definition I wrote, ArgumentError: wrong number of arguments (5 for 2), http://hastebin.com/jelekuwipu.css, what am I doing wrong?
[2012-05-29 11:20:15 -0400] zts: jeekl: should be "define :app_user, :username => nil, :homedir => nil, ..."
[2012-05-29 11:20:19 -0400] zts: jeekl: (or something other than nil, if you would like different defaults)
[2012-05-29 11:20:58 -0400] iroller: Ohai Chefs. Why Chef search can not work on fresh installation? I see chef-server node in `knife node show` and nothing in `knife search node "*:*"`. `knife index rebuild` doesn't help. All the daemons are running
[2012-05-29 11:21:13 -0400] jeekl: zts: Ah, so I need to define defaults for all parameters? Gotcha, the docs weren't really clear on that.
[2012-05-29 11:22:13 -0400] zts: jeekl: I'm not sure that you do, but the second argument to 'define' has to be a hash - it just doesn't stand out in the examples, as Ruby is being a bit magic there
[2012-05-29 11:23:11 -0400] zts: jeekl: in fairness, http://wiki.opscode.com/display/chef/Definitions does say "If no default value is specified, use nil"
[2012-05-29 11:23:35 -0400] zts: But I'm pretty sure things will end up in the params hash even if you haven't listed them out in that way
[2012-05-29 11:24:22 -0400] jeekl: zts: Ah, all right. Yeah, I guess I could have figured that out. Seems to work now though. Thanks!
[2012-05-29 11:24:30 -0400] zts: jeekl: no problem!
[2012-05-29 11:26:54 -0400] zts: iroller: I have seen people in here have that problem when chef server and/or expander fail to connect to rabbitmq, so I'd suggest checking their logs
[2012-05-29 11:28:11 -0400] zts: iroller: however I haven't run into the problem myself, so I'm not sure exactly what to look for
[2012-05-29 12:02:07 -0400] rweng: hi guys. can I run a recipe twice?
[2012-05-29 12:03:39 -0400] tomoj: why?
[2012-05-29 12:03:55 -0400] atomic-penguin: rweng, yes
[2012-05-29 12:04:42 -0400] rweng: atomic-penguin: how? include_recipe and require_recipe only run it once
[2012-05-29 12:05:50 -0400] atomic-penguin: Say once from a run_list, once by include
[2012-05-29 12:06:58 -0400] rweng: atomic-penguin: ok, but can I run it mutliple times in a cookbook, each time with different settings?
[2012-05-29 12:07:22 -0400] atomic-penguin: rweng, this is typically the use case for running something multiple times
[2012-05-29 12:07:31 -0400] atomic-penguin: rweng, the last time you run it will win
[2012-05-29 12:08:59 -0400] atomic-penguin: rweng, usually you'll set your defaults in a baseline role.  Then override an attribute by another role, and call that recipe again for edge cases outside of your baseline
[2012-05-29 12:09:39 -0400] rweng: hm, ok, m scenario is a bit different: I would like to use https://github.com/fnichol/chef-rvm from two different recipes, each time for a different user.
[2012-05-29 12:10:06 -0400] atomic-penguin: rweng, just use two different roles
[2012-05-29 12:10:18 -0400] atomic-penguin: rweng, one for user a, one for user b
[2012-05-29 12:11:27 -0400] rweng: well, user b is not really to be configured but is a side product for an application. so I configure the application in a role already. It does not seem right to move user b in s separate role, since the application depends on it and should require it in the recipe
[2012-05-29 12:12:23 -0400] atomic-penguin: rweng, you know best what your environment looks like.
[2012-05-29 12:13:06 -0400] atomic-penguin: rweng, you can use node.override in a recipe for user b
[2012-05-29 12:13:29 -0400] vegardx: So, I set an attributte on override, runs chef-client on the node and somehow it dissapers? Am I missing something?
[2012-05-29 12:14:41 -0400] vegardx: Also, the output of knife node edit changes for every time i issue it.
[2012-05-29 12:14:44 -0400] yfeldblum: you can use ruby trickery to run a recipe twice, but chef tries hard to make sure any recipe is run only once
[2012-05-29 12:20:57 -0400] atomic-penguin: yfeldblum, if all you're trying to do is override an attribute in a secondary role, you wouldn't have to force a second run with trickery.
[2012-05-29 12:28:00 -0400] drrk: zebers: sorry my computer crashed earlier and I forgot to re-attach to my irc screen, yes I mean creating chef admin users.  It seems the process is to create an admin account on the chef server, with knife configure -i which is some sort of master admin account, and then create new users with knife client create user -n -a -f /tmp/user.pem and then copy down the pem
[2012-05-29 12:29:36 -0400] drrk: I was wondering if I could handle that in a sligtly more automated fashion, so I provide a list of users, and their ssh public key, and the kinfe cleint stuff is handlede automatically and they user can then just scp down the .pem using their ssh key
[2012-05-29 13:00:30 -0400] rweng: so do I am not sure how to do this jet. my scenario: I have a data-bag of users and a role in which I specify which users to create. For each user rvm should be installed, and after rvm is installed some other stuff is done for each user. I though I'd iterate over the data-bag users and do this: http://pastie.org/3988588 - this is not possible because I cannot include the recipe multiple times. So the advice is to split it up in roles. How woul
[2012-05-29 13:00:31 -0400] rweng: do this?
[2012-05-29 13:01:48 -0400] eherot: rweng: Do you want the behavior to be exactly the same for each user?
[2012-05-29 13:01:54 -0400] eherot: or do you want to specify different things per user?
[2012-05-29 13:03:31 -0400] rweng: eherot: the same
[2012-05-29 13:04:24 -0400] rweng: eherot: or rather, almost the same. I planed to specify some variable thing through the data-bag
[2012-05-29 13:04:57 -0400] eherot: So what I do is something like this:
[2012-05-29 13:04:58 -0400] eherot: all_users = data_bag_item('auth', 'users')
[2012-05-29 13:05:14 -0400] eherot: users_for_this_box = node[:users]
[2012-05-29 13:05:59 -0400] eherot: users_for_this_box.each do |user|
[2012-05-29 13:06:00 -0400] eherot:   user all_users[user] do
[2012-05-29 13:06:00 -0400] eherot:     etc, etc
[2012-05-29 13:06:00 -0400] eherot:   end
[2012-05-29 13:06:00 -0400] eherot: end
[2012-05-29 13:06:12 -0400] eherot: not exactly like that but you get the idea
[2012-05-29 13:06:18 -0400] rweng: eherot: yes, thats the same what I do. however, when I have this with one user I include_recipe rvm::user. But this works only for the first user
[2012-05-29 13:06:33 -0400] rweng: all other users do not include rvm::user and thus do not install rvm
[2012-05-29 13:06:48 -0400] eherot: is the recipe actually called "rvm::user"
[2012-05-29 13:06:56 -0400] eherot: as opposed to rvm::USER'S NAME?
[2012-05-29 13:07:15 -0400] rweng: eherot: its this cookbook: https://github.com/fnichol/chef-rvm
[2012-05-29 13:07:45 -0400] eherot: so according to the docs on the page you just sent me
[2012-05-29 13:07:54 -0400] eherot: you include "recipe[rvm::user]" once at the beginning
[2012-05-29 13:08:16 -0400] eherot: then you need to specify in the role which users will get it
[2012-05-29 13:08:22 -0400] eherot: using a specific key
[2012-05-29 13:09:34 -0400] rweng: eherot: jup and there is the problem: I can only do this for users already created and I want to do stuff after rvm is installed. so I iterated over the databag users and did this for each one of them: http://pastie.org/3988588
[2012-05-29 13:09:55 -0400] rweng: so that I could run resources before and after rvm is installed
[2012-05-29 13:11:16 -0400] eherot: problem is that this leaves node["rvm"]["user_installs"] containing only one user when this recipe finishes.
[2012-05-29 13:11:21 -0400] eherot: only the last user, that is
[2012-05-29 13:11:52 -0400] eherot: it's not the act of requiring the recipe that causes the install to occur
[2012-05-29 13:12:04 -0400] eherot: and chef will do its best not to repeat actions unless forced
[2012-05-29 13:12:15 -0400] eherot: like including the same recipe multiple times, that is.
[2012-05-29 13:12:39 -0400] eherot: seems to me it would make more sense to install all of the users first, then install RVM for all of them, then go back and do the needed post processing
[2012-05-29 13:12:44 -0400] eherot: would that work?
[2012-05-29 13:14:08 -0400] rweng: eherot: yes but I would have to refactor my cookbooks almost completely. especially since I planed to automatically install rvm for users that are created by my applications. It would be far easier if I could just force chef to run the included recipe right now, independent whether it has been run before
[2012-05-29 13:15:22 -0400] rweng: for the refactoring I would need to have one complete list of users that require rvm, then run the rvm recipe, and then continue at each cookbooks position, like for my applications run bundle install, for my normal users continue their installation
[2012-05-29 13:15:53 -0400] eherot: well you'd already have that list by iterating through node["rvm"]["user_installs"]
[2012-05-29 13:17:33 -0400] eherot: There might be some way of doing this that I'm not aware of but as far as I understand it, the practice of forcing a recipe to be run many times over is kind of fundamentally antithetical to Chef's design.
[2012-05-29 13:17:54 -0400] eherot: (Not to mention Foodcritic will probably chastise you for it)
[2012-05-29 13:19:09 -0400] rweng: eherot: yeah, but it would be very redundant. I would have to specify the applications user and put that user in the rvm_user_installs list, although all application users need rvm. additionally, it doesn't solve the problem that some code should be run before and some code should be run after rvm install. Is there no way of forcing chef to run a recipe?
[2012-05-29 13:19:36 -0400] yfeldblum: rweng, why do you need an rvm per user?
[2012-05-29 13:20:01 -0400] yfeldblum: rweng, not asking why you need a *ruby* per user ... why do you need an *rvm* per user?
[2012-05-29 13:20:17 -0400] eherot: yfeldblum: if you look at the chef-rvm cookbook, it's not strictly setting up "one rvm per user" so much as it is setting up each user's rvm environment, which makes sense.
[2012-05-29 13:20:45 -0400] atomic-penguin: https://github.com/fnichol/chef-rvm#-user_installs
[2012-05-29 13:21:02 -0400] atomic-penguin: You can mash it all together, actually
[2012-05-29 13:21:03 -0400] rweng: yfeldblum: i probably dont really need one, just would like to have rvm in each users home since I have bad experiance with system wide rvm. But thats not really the point here
[2012-05-29 13:21:04 -0400] geekbri: yfeldblum: I think one argument for an RVM per user is the sometimes wonky issues with using RVM in a multiuser environment
[2012-05-29 13:21:20 -0400] yfeldblum: eherot, it sets up an rvm per user plus also sets up each user's rvm
[2012-05-29 13:21:51 -0400] rweng: I would like avoiding installing things globally only because my configuration management tool forces me to
[2012-05-29 13:21:54 -0400] atomic-penguin: eherot, you're assuming foodcritic is smarter than you in all cases, then
[2012-05-29 13:22:09 -0400] eherot: rweng: in the docs for chef-rvm, it looks like independently specifying each application's user in the rvm:user_installs list is exactly the intended setup
[2012-05-29 13:22:38 -0400] eherot: atomic-penguin: In this case it just happens to agree with me ;-)
[2012-05-29 13:23:14 -0400] rweng: eherot: nope
[2012-05-29 13:23:35 -0400] yfeldblum: rweng, it is the point: you're using someone else's cookbook out of convenience but are running into issues with it, so i'm trying to help you find various possible ways to work around it without having you rewrite the cookbook :P
[2012-05-29 13:24:02 -0400] eherot: rweng: errok.
[2012-05-29 13:24:51 -0400] rweng: the main question remains: is there a way to force a recipe to be run multiple times
[2012-05-29 13:26:09 -0400] ashb: yes
[2012-05-29 13:26:28 -0400] ashb: node.run_state[:seen_recipes].delete "application::#{thing}"
[2012-05-29 13:26:41 -0400] ashb: might not be supported but it does work
[2012-05-29 13:26:47 -0400] rweng: ashb: great, thank you!
[2012-05-29 13:26:47 -0400] eherot: it's not a good practice
[2012-05-29 13:27:08 -0400] ashb: i use that so that I can have multiple apps using the same cookbooks (but with different databags) on the same box
[2012-05-29 13:27:16 -0400] ashb: apps = Application cookbook
[2012-05-29 13:27:22 -0400] eherot: and in the case of this particular recipe, you're going to run the check to see if the rvm packages are installed and do a whole bunch of downloading (or at least checksum checking) for every user.
[2012-05-29 13:28:04 -0400] eherot: you guys are making the programmer in me cry!
[2012-05-29 13:30:36 -0400] drrk: isn't that the purpose of sysadmins?
[2012-05-29 13:30:46 -0400] yfeldblum: not in devops
[2012-05-29 13:31:52 -0400] drrk: :) That's the theory
[2012-05-29 13:32:25 -0400] drrk: I havn't had a chance to work in a proper devops envroment though
[2012-05-29 13:32:30 -0400] atomic-penguin: What is so hard about using the big ugly data structure for all your rvm user installs?
[2012-05-29 13:32:57 -0400] eherot: rweng: What you're doing may seem easier than refactoring right now, but I strongly suspect it is going to make your setup less extensible in the future (and not to mention likely to cause confusion if anything changes even slightly).
[2012-05-29 13:33:04 -0400] atomic-penguin: Why does the recipe need to run twice?
[2012-05-29 13:33:26 -0400] eherot: atomic-penguin: seems odd to me given that the recipe is, itself, mainly just a loop.
[2012-05-29 13:34:04 -0400] rweng: eherot: I am trying to avoid splitting my recipes up in a before_rvm install, after_rvm_install
[2012-05-29 13:34:30 -0400] eherot: but I mean, they are already split internally
[2012-05-29 13:34:46 -0400] eherot: making two recipes and adding them both to a role would not be that hard
[2012-05-29 13:35:55 -0400] geekyogi: Has anyone tried chef server installation using RVM ?
[2012-05-29 13:39:12 -0400] BryanWB_: geekyogi: u tried omnibus? should be much easier
[2012-05-29 13:39:53 -0400] geekbri: my style feels cramped!
[2012-05-29 13:40:16 -0400] geekyogi: @BryanWB_ nope.. will try omnibus
[2012-05-29 13:40:20 -0400] geekyogi: thanks.
[2012-05-29 13:40:53 -0400] yfeldblum: BryanWB_, good morning
[2012-05-29 13:41:00 -0400] BryanWB_: yfeldblum: morning homez
[2012-05-29 13:45:39 -0400] jordan_c: having issues authenticating to my chef-server - knife works from my workstation, but I can't validate new clients - bootstrapping worked, I can telnet from the client to the chef server on 4000 and I've tried regenerating validation.pem but I'm still getting 401 unauthorized when trying to run chef-client - any ideas?
[2012-05-29 13:46:02 -0400] makerbreaker: rm /etc/chef/client.pem and re-run chef-client
[2012-05-29 13:46:15 -0400] makerbreaker: * or wherever you have client.pem
[2012-05-29 13:46:27 -0400] jordan_c: there is no client pem
[2012-05-29 13:46:34 -0400] masterkorp: hey, is there any chef handbook you recomend ?
[2012-05-29 13:46:44 -0400] jordan_c: and it fails when trying to re-register
[2012-05-29 13:46:57 -0400] jordan_c: it's a freshly bootstrapped node, but running chef-client on it has always failed
[2012-05-29 13:47:18 -0400] makerbreaker: can you gist the error
[2012-05-29 13:47:38 -0400] jordan_c: https://gist.github.com/2828467
[2012-05-29 13:48:04 -0400] resno: mattray: ive waited day and night for your return
[2012-05-29 13:48:17 -0400] makerbreaker: rodan_c, delete the client, and the client.pem
[2012-05-29 13:48:21 -0400] makerbreaker: then re-run chef-client
[2012-05-29 13:48:23 -0400] caaakeeey: hi, at our establishment we currently have a mammoth unmaintainable 'create dev machine' script, we were looking to migrate to chef/puppet, how would i do things like checking ips resolved, checking nis server, checking ntp time settings, check iptable rules are not blocking things, check network connectivity to other hosts?
[2012-05-29 13:48:49 -0400] mattray: resno: yikes
[2012-05-29 13:48:51 -0400] jordan_c: here's the stacktrace https://gist.github.com/2828471 - there is no client/node registered on my chef-server and no client.pem locally on the client
[2012-05-29 13:49:49 -0400] jordan_c: knife client list shows, the validator, webui and my user
[2012-05-29 13:50:07 -0400] makerbreaker: do you have the correct validation.pem?
[2012-05-29 13:50:52 -0400] mattray: resno: what's up?
[2012-05-29 13:50:52 -0400] makerbreaker: caaakeeey, chef takes care of most of that for you, and if not, you can write a custom attribute to get that info
[2012-05-29 13:51:20 -0400] jordan_c: yes, and I've even tried regenerating the validation.pem file
[2012-05-29 13:51:41 -0400] makerbreaker: and then compying it to the client machine ?
[2012-05-29 13:51:46 -0400] jordan_c: yep
[2012-05-29 13:51:48 -0400] makerbreaker: are you sure its using the right one
[2012-05-29 13:52:34 -0400] makerbreaker: after you regenerate it you have to copy it to the client machien
[2012-05-29 13:52:54 -0400] jordan_c: yep, doing it again just for good measure
[2012-05-29 13:53:04 -0400] jordan_c: same error
[2012-05-29 13:53:17 -0400] resno: mattray: not really, just wanted to poke at you after heading out early on friday to do stuff
[2012-05-29 13:54:24 -0400] mattray: yeah, 3 day weekend :)
[2012-05-29 13:54:30 -0400] jordan_c: any idea if there's a way I can test the validation.pem file against the chef server using curl or openssl or something like that?
[2012-05-29 13:56:10 -0400] makerbreaker: jordan_c post your conf files also
[2012-05-29 13:56:33 -0400] caaakeeey: makerbreaker, can you point me in the direction of docs to use in discussion :P
[2012-05-29 13:57:45 -0400] makerbreaker: http://wiki.opscode.com/display/chef/Home
[2012-05-29 13:58:04 -0400] jordan_c: I'm kinda stumped
[2012-05-29 13:59:22 -0400] makerbreaker: joddan_c, post your client.rb
[2012-05-29 14:00:04 -0400] jordan_c: https://gist.github.com/2828522
[2012-05-29 14:00:38 -0400] makerbreaker: is that the whole thing?
[2012-05-29 14:00:43 -0400] jordan_c: yep
[2012-05-29 14:01:54 -0400] jordan_c: I wondered if it needed an attribute for the validation.pem, but I moved /etc/chef/validation.pem to validation.pem.old and tried re-running chef client and it complained that there was no private key
[2012-05-29 14:02:38 -0400] atomic-penguin: BryanWB_, nathenharvey, when is ep14 coming out then?
[2012-05-29 14:02:44 -0400] jespada: jordan_c, seems like you already have a node with regitered.. with that name, just to be sure, delete the client and the node from the chef-server with knife
[2012-05-29 14:02:46 -0400] riceo: Hi everyone, just wondered if anyone could help me quickly? I'm using hosted chef and ironfan, having just set up knife on a new machine. I've copied over all org/personal keys, however, I'm unable to sync cluster changes. `knife cluster show <name>` reports 'WARNING: No nodes to sync, exiting' even though I have a node within the specified cluster running. It's as if knife isn't aware of the existence of my AWS node. Have I missed something really obvious?
[2012-05-29 14:02:50 -0400] BryanWB_: atomic-penguin: tomorrow
[2012-05-29 14:03:09 -0400] BryanWB_: or this evening, depending on my productivity
[2012-05-29 14:03:11 -0400] atomic-penguin: BryanWB_, sweet!
[2012-05-29 14:03:16 -0400] jordan_c: jespada: there are no clients on the server other than chef-validator, chef-webui and jconway
[2012-05-29 14:03:56 -0400] makerbreaker: jordan_c, are you sure you delete the client and the node?
[2012-05-29 14:04:03 -0400] makerbreaker: deleted*
[2012-05-29 14:04:08 -0400] jespada: jordan_c, what's the output of `knife node list`  ?
[2012-05-29 14:04:09 -0400] makerbreaker: 2 seperate things to delete
[2012-05-29 14:04:11 -0400] jordan_c: they never got registered in the first place
[2012-05-29 14:04:47 -0400] jordan_c: https://gist.github.com/2828608
[2012-05-29 14:07:08 -0400] jespada: jordan_c, ok, and you already copied the validation.pem to your server (node) under /etc/chef/
[2012-05-29 14:07:09 -0400] jespada: ?
[2012-05-29 14:08:43 -0400] UForgotten: is there a way to get chef to converge everything on the runlist but not perform everything on the runlist?
[2012-05-29 14:08:54 -0400] jespada: jordan_c, also run the chef-client in debug: `chef-client -l debug`
[2012-05-29 14:09:10 -0400] jordan_c: I regenerated the private key for chef-validator from the webui and copied it to /etc/chef/validation.pem on the node
[2012-05-29 14:09:13 -0400] UForgotten: I need all the attributes from the rulist but only need one recipe to be run.
[2012-05-29 14:09:29 -0400] riceo: Can someone tell me how ironfan identifies if nodes are online or not when running `knife cluster sync`?
[2012-05-29 14:11:26 -0400] jespada: UForgotten, i think with shef you can.. not sure..
[2012-05-29 14:12:41 -0400] jespada: jordan_c, why you regenerated it?, you can grab it from the chef-server (i'm talking about open source chef)
[2012-05-29 14:12:52 -0400] jordan_c: ahh
[2012-05-29 14:12:54 -0400] jordan_c: I'll try that
[2012-05-29 14:15:35 -0400] jordan_c: same deal =\
[2012-05-29 14:15:36 -0400] jespada: jordan_c, i never use the webui.. so i don't know .. but i can tell you that from chef-server you can copy  it:  /etc/chef/validation.pem
[2012-05-29 14:16:00 -0400] jordan_c: yeah, grabbed that, same issue
[2012-05-29 14:17:00 -0400] jespada: jordan_c, you are running 0.10.6 version of chef client and server?
[2012-05-29 14:17:07 -0400] jordan_c: yes
[2012-05-29 14:17:31 -0400] jespada: hmm , os?
[2012-05-29 14:17:51 -0400] jordan_c: centos 5.8 using the rbel server install and bootstrap
[2012-05-29 14:19:19 -0400] jespada: did you check what I said, running: chef-client -l debug
[2012-05-29 14:21:17 -0400] jordan_c: yep, hang on
[2012-05-29 14:22:05 -0400] jordan_c: https://gist.github.com/2828711
[2012-05-29 14:22:27 -0400] jordan_c: there's a bunch of exceptions for ohai plugins, but I think it's just because of things I'm not running on the client
[2012-05-29 14:22:59 -0400] atomic-penguin: Is there any documentation on the new_resource.updated_by_last_action?
[2012-05-29 14:23:09 -0400] atomic-penguin: I'm a little confused, when and when not to use this
[2012-05-29 14:23:21 -0400] jordan_c: hmm
[2012-05-29 14:23:30 -0400] jordan_c: it's not finding the fqdn - I wonder if that could do it
[2012-05-29 14:23:52 -0400] atomic-penguin: Like say an LWRP touches several resources.  Does each resource within the LWRP need this updated method, or just the overall LWRP
[2012-05-29 14:27:52 -0400] jordan_c: same issue with the fqdn set
[2012-05-29 14:28:49 -0400] jespada: jordan_c, fqdn is not the problem..
[2012-05-29 14:29:25 -0400] jespada: the validation.pem is the problem..
[2012-05-29 14:29:51 -0400] jordan_c: what permissions should it have? would it matter since I'm running chef-client as root?
[2012-05-29 14:30:43 -0400] jespada: jordan_c, no prob with that.. you can run as root, 644 should work
[2012-05-29 14:30:59 -0400] jordan_c: yeah, that's what is it now
[2012-05-29 14:34:16 -0400] jespada: just to be sure , compared the md5sum of the copy of the validation.pem.. cause as per the chef-client log.. the Signed request is not valid : .."Signing the request as chef-validator"...
[2012-05-29 14:37:51 -0400] jordan_c: l
[2012-05-29 14:38:08 -0400] jordan_c: so /etc/chef/validation.pem on the server and client have the same md5sum
[2012-05-29 14:38:51 -0400] jordan_c: I may scrap the server and start again from scratch
[2012-05-29 14:39:14 -0400] jordan_c: I've wasted enough time trying to figure this out, that said - I'd really like to understand why it's not cooperating
[2012-05-29 14:39:33 -0400] jespada: jordan_c, ok sorry I couldn't help you
[2012-05-29 14:39:56 -0400] jordan_c: thanks for the time
[2012-05-29 14:41:58 -0400] knuckolls: atomic-penguin: i think the updated_by_last_resource is just how you want it to show up in the notification handlers at the end of the run
[2012-05-29 14:42:35 -0400] knuckolls: i had to fix some of the lwrp's i've made because when i finally wrote our chef->hipchat notification handler cookbook there were some lwrps that were firing that wouldn't show up in the report
[2012-05-29 14:43:46 -0400] nacer: hey there is some problems ? : ruby_block[save node data] (mysql::server line 84) had an error: Net::HTTPServerException: 403 "Forbidden"
[2012-05-29 14:44:27 -0400] atomic-penguin: knuckolls, so with this for example: https://github.com/atomic-penguin/cookbook-certificate/blob/master/providers/manage.rb.  Would one updated_... method at line #66 be sufficient?
[2012-05-29 14:45:49 -0400] atomic-penguin: knuckolls, or would it be best if each resource had an updated_by_last_action method?
[2012-05-29 14:46:12 -0400] knuckolls: i think that's largely up to how you want to see "what's run?" in the output report
[2012-05-29 14:46:30 -0400] knuckolls: if you're using notification handlers, which i think you should. especially if you daemonize the chef_client
[2012-05-29 14:46:47 -0400] knuckolls: personally, i think one updated_by method at the end of the lwrp would suffice
[2012-05-29 14:46:52 -0400] knuckolls: for my purposes
[2012-05-29 14:47:06 -0400] knuckolls: because it's likely that you'll know what's going on inside the lwrp, and you just want to see that it was run
[2012-05-29 14:48:23 -0400] yfeldblum: atomic-penguin, any provider which, given a declared resource and the current state of the system, changes the system to bring it into line with the declared resource, should mark the resource as having been updated using `new_resource.updated_by_last_action(true)` (this method is essentially a setter)
[2012-05-29 14:49:08 -0400] yfeldblum: atomic-penguin, this is how notifications & subscriptions know which resources have been updated & therefore which other resources to notify
[2012-05-29 14:49:26 -0400] knuckolls: ah i didn't think that the notification stuff could be tied to it
[2012-05-29 14:51:36 -0400] yfeldblum: atomic-penguin, however, this only works if the actions that the provider needs to perform are actually performed *in the provider's action method*
[2012-05-29 14:52:26 -0400] yfeldblum: atomic-penguin, if you declare resources in the provider's action method, then that assumption is violated, because the resources declared in the provider's action method are *added to the calling context's resources collection* and are not converged in the provider's action method
[2012-05-29 14:54:28 -0400] yfeldblum: atomic-penguin, so for example, just declaring a `file "/etc/asdf"` resource in the provider's action method violates that assumption and does not create the file as part of the provider's action method; using either `File.open("wb") { |f| f.write(content) }` will work for that, but you may want to do some inspection & idempotency there
[2012-05-29 14:55:32 -0400] yfeldblum: atomic-penguin, additionally, you can use resources and have them converge in the provider's action method by using `action(:create) { recipe_eval { file "/etc/asdf" } }`
[2012-05-29 14:56:04 -0400] yfeldblum: atomic-penguin, but then you will need to ask each resource declared & converged that way if it was updated, and if any were, then subsequently mark the provider's new_resource as updated too
[2012-05-29 15:01:57 -0400] jordan_c: jespada: I ended up deleting all validation.pem on the chef server, restarting the server to regenerate the validation.pem and then coping it over to my workstation, re-bootstrapping and it worked
[2012-05-29 15:02:23 -0400] jespada: jordan_c, cool :)
[2012-05-29 15:02:38 -0400] jordan_c: I realized that there's an issue because this chef-server was also managed by another chef-server which caused some issues with the validation.pem that kept getting replaced
[2012-05-29 15:03:20 -0400] jordan_c: need to figure out now to mitigate that, but in the mean time, I just dropped it from the other chef-server
[2012-05-29 15:04:22 -0400] jespada: jordan_c, so the validation.pem was the problem after all
[2012-05-29 15:04:29 -0400] yfeldblum: something like: new_resource.updated_by_last_action(true) if [my_resource_1, my_resource_2].any?(&:updated_by_last_action?)
[2012-05-29 15:04:32 -0400] gabrielciuloaica: Hi guys, I'm new to chef and I'm blocked by a small issue
[2012-05-29 15:04:51 -0400] gabrielciuloaica: I'm trying to call a template from a loop
[2012-05-29 15:04:57 -0400] gabrielciuloaica: in the recipe
[2012-05-29 15:05:03 -0400] atomic-penguin: yfeldblum, so any resource that could have potentially updated needs to be tested to see if it actually updated?
[2012-05-29 15:05:16 -0400] gabrielciuloaica: is this possible
[2012-05-29 15:05:19 -0400] gabrielciuloaica: ?
[2012-05-29 15:05:45 -0400] gabrielciuloaica: it seems that chef-client is not applying change in the file for second item from loop...
[2012-05-29 15:07:35 -0400] yfeldblum: atomic-penguin, yes, if you're using "sub-resources" ... that's how resources are supposed to be used, and how all the providers delivered with chef-client/chef-solo work
[2012-05-29 15:09:12 -0400] jeffg: are there any limits on the length of a role name?
[2012-05-29 15:25:42 -0400] magoo: does anyone have a chef-client recipe modified for irc snitch?
[2012-05-29 15:31:19 -0400] monvillalon: Im trying to debug a recipe with vagrant , i set vagrant to show :debug, but when in the recipe I use log it doesn't show on the console, anybody has an idea why?
[2012-05-29 15:38:01 -0400] knuckolls: monvillalon: i've encountered that, and i haven't really delved deep to figure out why. my workaround is just using Chef::Log.info statements littered throughout my recipe, and in ruby_block statements if I want logs to run at convergence
[2012-05-29 15:38:33 -0400] monvillalon: knuckolls: thanks, you've experiences this with vagrant?
[2012-05-29 15:38:52 -0400] knuckolls: good point, no I haven't
[2012-05-29 15:38:59 -0400] knuckolls: but it sounds like the exact problem i was having elsewhere
[2012-05-29 15:39:02 -0400] knuckolls: worth a shot
[2012-05-29 15:44:56 -0400] jordan_c: can I just blame oracle for not being able to download http://download.oracle.com/otn-pub/java/jdk/6u30-b12/jdk-6u30-linux-x64.bin via chef?
[2012-05-29 15:47:17 -0400] mosez: how can i get the node environment within recipes?
[2012-05-29 15:47:29 -0400] knuckolls: node.chef_environment
[2012-05-29 15:47:38 -0400] mosez: knuckolls: thx
[2012-05-29 15:47:43 -0400] knuckolls: i'm 99% sure that's right, i can confirm
[2012-05-29 15:47:58 -0400] knuckolls: yeah that ought to do it
[2012-05-29 15:49:19 -0400] monvillalon: knuckolls: thanks, that worked ..:)
[2012-05-29 15:56:57 -0400] qurve: OK, dumb question, how do you tell chef-client what roles to execute in? There's a -e for the env, but I must be blind, I can't figure out how to tell chef-client what roles to bootstrap with...
[2012-05-29 15:57:25 -0400] knuckolls: qurve: something like this
[2012-05-29 15:57:30 -0400] knuckolls: knife ec2 server create -r "role[base],role[graphite]" -f m1.medium ...
[2012-05-29 15:57:37 -0400] qurve: I'm not using knife to create instances.
[2012-05-29 15:57:47 -0400] qurve: They are created via autoscaling groups from a CloudFormation template.
[2012-05-29 15:58:03 -0400] knuckolls: hm
[2012-05-29 15:58:16 -0400] qurve: I have the user data set up to install chef client, configure my keys, etc.
[2012-05-29 15:58:38 -0400] knuckolls: i think the chef-server has to have the run_list set in some manner
[2012-05-29 15:58:42 -0400] qurve: I've gotten to the point where chef-client runs and registers itself as a node, but then it just says there's nothing to do since the node doesn't have any roles or run lists.
[2012-05-29 15:59:02 -0400] qurve: If I then log into the manage interface and set a role, I can run chef-client again and everything is fine, but that defeats the purpose of auto-scaling :)
[2012-05-29 15:59:03 -0400] knuckolls: you can script knife locally to add the correct run_list to thenode
[2012-05-29 15:59:10 -0400] knuckolls: knife node run_list add
[2012-05-29 15:59:14 -0400] knuckolls: something like that
[2012-05-29 15:59:17 -0400] qurve: That works.
[2012-05-29 15:59:26 -0400] qurve: Not sure why I didn't think of that.
[2012-05-29 15:59:34 -0400] knuckolls: heh, that's what this room is for ;)
[2012-05-29 16:01:59 -0400] qurve: Yesterday and today have been quite a crash course.
[2012-05-29 16:02:11 -0400] qurve: I've worked on a project that used chef before, but never set up an entire infrastructure myself.
[2012-05-29 16:04:50 -0400] qurve: Hrm, it seems to want a knife config file.
[2012-05-29 16:05:05 -0400] qurve: Would this server need to be set up as a management console to use knife to add itself to a role?
[2012-05-29 16:05:43 -0400] yfeldblum: qurve, knife is a command-line tool you can use from your own workstation to interact with the chef-server-api
[2012-05-29 16:05:49 -0400] qurve: Yeah, I know.
[2012-05-29 16:06:06 -0400] qurve: I'm trying to figure out how to get an auto-scaled instance to put itself into a role before it runs chef-client and bootstraps itself.
[2012-05-29 16:06:14 -0400] qurve: Since I'm not creating the ec2 instances manually.
[2012-05-29 16:06:32 -0400] qurve: I figured chef-client would have an argument, but I didn't see one :(
[2012-05-29 16:07:34 -0400] qurve: I have this whole thing working except this...
[2012-05-29 16:07:35 -0400] yfeldblum: qurve, i believe you can use the -j argument in first chef-client run to pass a filename, where the file contains the initial node data including normal-level attributes and the starting run-list
[2012-05-29 16:07:47 -0400] qurve: Ah, clever.
[2012-05-29 16:07:57 -0400] yfeldblum: qurve, or, how `knife bootstrap` works ...
[2012-05-29 16:08:10 -0400] qurve: so I can just have a .json with {'run_list': 'webserver'}
[2012-05-29 16:08:24 -0400] yfeldblum: qurve, right
[2012-05-29 16:08:43 -0400] yfeldblum: qurve, check out the code for `knife bootstrap` to get more specific details
[2012-05-29 16:09:18 -0400] yfeldblum: qurve, and don't use knife on servers ... :P
[2012-05-29 16:09:25 -0400] qurve: Yeah, I didn't want to :)
[2012-05-29 16:09:42 -0400] qurve: But I'm pretty sure everyone here knows more than me, so I do what I'm told!
[2012-05-29 16:10:50 -0400] jeffg: 2
[2012-05-29 16:11:21 -0400] gmcinnes: Hi y'all.
[2012-05-29 16:12:43 -0400] knuckolls: qurve: you can run knife with the -c command and point to /etc/chef/client.rb
[2012-05-29 16:12:46 -0400] knuckolls: i think
[2012-05-29 16:12:49 -0400] knuckolls: didn't test it
[2012-05-29 16:12:52 -0400] gmcinnes: I have an issue with a bootstrap script I'm writing. I think it's running into an issue because it's exceeding the maximum command line length. Any pointers to work arounds?
[2012-05-29 16:13:05 -0400] qurve: This json attributes argument to chef-client seems to be the key, if I can figure out why it doesn't like the format of my .json file.
[2012-05-29 16:14:01 -0400] knuckolls: qurve this ought to do it: knife node list -c /etc/chef/client.rb
[2012-05-29 16:14:10 -0400] qurve: single quotes will fuck it up :)
[2012-05-29 16:14:15 -0400] qurve: yfeldblum: That worked perfectly, thank you.
[2012-05-29 16:14:22 -0400] yfeldblum: qurve, no probs
[2012-05-29 16:15:41 -0400] qurve: I know there's knife tools to work with ec2 instances directly, but are there any for managing cloudformation stacks?
[2012-05-29 16:16:39 -0400] yfeldblum: knuckolls, it will, kind of, but IMO knife is not itself a tool that should really be automated; if you want to automate, don't shell out to knife; instead, just use the chef API directly
[2012-05-29 16:16:59 -0400] gmcinnes: Can anyone point me to example bootstrap scripts?
[2012-05-29 16:17:58 -0400] knuckolls: yfeldblum: sounds good :)
[2012-05-29 16:20:02 -0400] yfeldblum: gmcinnes, https://github.com/opscode/chef/tree/master/chef/lib/chef/knife/bootstrap
[2012-05-29 16:22:03 -0400] gmcinnes: yfeldblum: I think I'm doing something back-asswards.  I'm trying to provision an ec2 machine by checking out my chef-repo and then running chef-solo
[2012-05-29 16:22:25 -0400] yfeldblum: gmcinnes, that's fine
[2012-05-29 16:22:30 -0400] yfeldblum: gmcinnes, why do you think that's backwards?
[2012-05-29 16:22:45 -0400] yfeldblum: gmcinnes, the bootstrap scripts i linked to were for knife/chef-client
[2012-05-29 16:24:03 -0400] gmcinnes: yfeldblum: So, in order to do that I have to get my github deploy key, an encrypted data bag secret etc up to the node. But doing that seems to result in a command line that is too long to be executed by the node.
[2012-05-29 16:24:07 -0400] yfeldblum: gmcinnes, for chef-solo, you can scp a script to the server which installs ruby, ohai, chef, and clones your repo
[2012-05-29 16:24:29 -0400] yfeldblum: gmcinnes, and then finally runs chef-solo with the right args
[2012-05-29 16:24:55 -0400] gmcinnes: yfeldblum: ok. I'll try that.
[2012-05-29 16:25:25 -0400] yfeldblum: gmcinnes, that's essentially what `knife bootstrap` automates for you, but for chef-client
[2012-05-29 16:26:25 -0400] gmcinnes: yfeldblum: What's the best way to get chef dependencies installed?  Right now I'm building ruby, but it takes *forever*
[2012-05-29 16:26:41 -0400] monvillalon: I need some advice with the yum recipe, it keeps failing because the version ( and hence the url ) of the epel repo keep changing keeps changing, any ideas
[2012-05-29 16:29:54 -0400] yfeldblum: gmcinnes, right, 5 to 10 mins ... feel free to install a packaged ruby if you like, or package it yourself, or use the isolated chef-full installer
[2012-05-29 16:30:10 -0400] qurve: Do you guys experience instability in chef-client at all? Specifically on Ubuntu 12.04?
[2012-05-29 16:30:16 -0400] qurve: I get random segfaults when I run it
[2012-05-29 16:30:22 -0400] qurve: Just now it died with [Tue, 29 May 2012 16:28:35 +0000] FATAL: IOError: Cannot open or read /var/cache/chef/cookbooks/bluepill/providers/service.rb!
[2012-05-29 16:30:29 -0400] qurve: Then I ran it again and it worked fine.
[2012-05-29 16:30:44 -0400] qurve: It's weird, I'll run it, it'll blow up for some reason, I run it again and it goes fine.
[2012-05-29 16:32:01 -0400] btm: qurve: That's almost always a bad ruby, not Chef itself. It is usually the garbage collector, which is part of why it happens at different times.
[2012-05-29 16:32:17 -0400] qurve: Any suggestions on what to do about it?
[2012-05-29 16:32:30 -0400] qurve: I'm bootstrapping with the chef gem directly from the opscode apt
[2012-05-29 16:32:39 -0400] btm: qurve: what version of Ruby are you using? What version of Chef?
[2012-05-29 16:32:41 -0400] qurve: So that's installing ruby and whatnot
[2012-05-29 16:32:53 -0400] btm: qurve: http://tickets.opscode.com/browse/CHEF-3094
[2012-05-29 16:33:10 -0400] btm: qurve: and then where is the segfault?
[2012-05-29 16:33:27 -0400] qurve: Ruby 1.8.7 chef 0.10
[2012-05-29 16:33:35 -0400] qurve: Segfaults were happening yesterday, haven't seen any yet today.
[2012-05-29 16:33:43 -0400] qurve: But the segfaults would happen almost immediately as chef-client ran.
[2012-05-29 16:33:58 -0400] qurve: That ticket is the problem I was having.
[2012-05-29 16:34:22 -0400] qurve: It's either that mixin/command/unix.rb or a file in ohai
[2012-05-29 16:34:53 -0400] qurve: Strangely it would often be exactly 3 segfaults, then a proper run (while I was testing in a local VM)
[2012-05-29 16:35:27 -0400] jeffg: qurve, read the bug about what seems to cause it: a GC in ruby during select()
[2012-05-29 16:35:35 -0400] btm: qurve: it's probably OHAI-330 which is fixed in the upcoming release. If you're using debs, it isn't simple to get a prerelease.
[2012-05-29 16:35:52 -0400] qurve: Ah, ok.
[2012-05-29 16:35:59 -0400] jeffg: so it'll be intermittent by nature
[2012-05-29 16:36:37 -0400] qurve: Fun, trying to move an infrastructure onto this this week.
[2012-05-29 16:36:40 -0400] qurve: That could be problematic.
[2012-05-29 16:37:33 -0400] btm: qurve: you can build a deb with the prerelease yourself and put it on your apt server.
[2012-05-29 16:37:52 -0400] btm: qurve: our packaging is at http://github.com/opscode/opscode-packages
[2012-05-29 16:37:57 -0400] qurve: The question is whether the PR has other instability.
[2012-05-29 16:37:58 -0400] hoover_damm: btm, GC still dogging us?
[2012-05-29 16:38:02 -0400] hoover_damm: btm, damn
[2012-05-29 16:39:02 -0400] btm: hoover_damm: just the lingering version of run_command/popen in Ohai. shellout all the things soon.
[2012-05-29 16:39:16 -0400] qurve: Out of curiosity, btm, do you work for opscode?
[2012-05-29 16:39:23 -0400] btm: qurve: I do.
[2012-05-29 16:39:30 -0400] hoover_damm: btm, :(
[2012-05-29 16:39:37 -0400] hoover_damm: btm, makes me even more thankful to not have to care about that now
[2012-05-29 16:39:49 -0400] qurve: Off-topic and you may not know this, but how do node limits work with hosted chef with ec2 auto-scaling?
[2012-05-29 16:39:51 -0400] gmcinnes: yfeldblum: I assume the chef-full installer is going to be supported going forward? As far as you know?
[2012-05-29 16:40:11 -0400] qurve: Like, if a node boots up to handle load then is later killed, will it stick around in the node list using up a slot of available nodes for the subscription?
[2012-05-29 16:40:39 -0400] yfeldblum: gmcinnes, yes
[2012-05-29 16:40:48 -0400] hoover_damm: qurve, I believe that's more something you have to build as the cleanup is more manual
[2012-05-29 16:40:57 -0400] btm: qurve: Hosted Chef doesn't have node limits, we audit your current nodes to your subscription nodes periodically. you should clean up nodes that no longer exist on a regular basis.
[2012-05-29 16:41:17 -0400] hoover_damm: qurve, additionally with autoscaling it boots an instance based on cpu usage and not the knife command
[2012-05-29 16:41:20 -0400] qurve: OK, so it's not a hard limit where stuff is going to come crashing to a halt, but I need to work out a way to clear out dead nodes.
[2012-05-29 16:41:27 -0400] hoover_damm: so you may need to ensure that autoscaling 'booting' works as you need it to
[2012-05-29 16:41:31 -0400] hoover_damm: afaik
[2012-05-29 16:41:36 -0400] Mithrandir: btm: 6.14, that's ohai, I assume?
[2012-05-29 16:41:41 -0400] qurve: hoover_damm: Yeah that's the problem I just solved.
[2012-05-29 16:41:55 -0400] qurve: I have ec2 instances booting and bootstrapping purely from user-data.
[2012-05-29 16:41:59 -0400] hoover_damm: then basically what btm said comes into play
[2012-05-29 16:42:13 -0400] qurve: My concern was just that after a month or two of nodes scaling up/down I could have a few dozen nodes registered with hosted chef.
[2012-05-29 16:42:25 -0400] qurve: And I have to figure out how to clean that up.
[2012-05-29 16:42:54 -0400] hoover_damm: totally
[2012-05-29 16:42:56 -0400] btm: Mithrandir: yup.
[2012-05-29 16:43:16 -0400] hoover_damm: qurve, having a cron script that periodically polls what servers are running and matches them against the chef-server
[2012-05-29 16:43:23 -0400] hoover_damm: and emails you what's not running
[2012-05-29 16:43:25 -0400] hoover_damm: should work
[2012-05-29 16:43:34 -0400] qurve: Add that to my TODO list :)
[2012-05-29 16:43:49 -0400] erikh: qurve: we wrote a rc0.d script that kills the node+client
[2012-05-29 16:43:50 -0400] hoover_damm: once your comfortable with it, automate more
[2012-05-29 16:44:05 -0400] hoover_damm: erikh, that runs on reboot no?
[2012-05-29 16:44:08 -0400] erikh: no.
[2012-05-29 16:44:12 -0400] erikh: that's rc6.
[2012-05-29 16:44:20 -0400] qurve: I basically need something that runs when an instance is about to be killed.
[2012-05-29 16:44:30 -0400] qurve: And with it's last dying breath deletes it from hosted chef
[2012-05-29 16:44:34 -0400] btm: Mithrandir: going to fix the versioning so we can start to do patch releases.
[2012-05-29 16:44:42 -0400] erikh: qurve: that's how we made it work.
[2012-05-29 16:44:46 -0400] hoover_damm: erikh, excellent
[2012-05-29 16:44:51 -0400] qurve: Rad, I'll have to look into that.
[2012-05-29 16:45:00 -0400] hoover_damm: I never thought of init 0
[2012-05-29 16:45:12 -0400] Mithrandir: btm: nod, your mail just didn't say anything about ohai, just the version number
[2012-05-29 16:45:20 -0400] erikh: now, keep in mind aws doesn't *always* send the shutdown signal
[2012-05-29 16:45:23 -0400] erikh: just more often than not
[2012-05-29 16:45:43 -0400] hoover_damm: erikh, that's more the host controller being bad I think
[2012-05-29 16:45:47 -0400] btm: Mithrandir: yeah, I sucked there.
[2012-05-29 16:46:41 -0400] erikh: qurve: just got approved to share it, sec.
[2012-05-29 16:46:51 -0400] qurve: Thank you very much erikh.
[2012-05-29 16:47:29 -0400] qurve: I run a non-profit org that currently has it's stuff hosted on a crappy colo that I'm terrified is going to crap out on me. I took the week off of work to move the whole thing to amazon with a completely automated infrastructure, this week has been a crash course so far :)
[2012-05-29 16:47:42 -0400] qurve: (We run a very large, high-traffic vBulletin forum)
[2012-05-29 16:48:12 -0400] gmcinnes: qurve: you have my sympathies.
[2012-05-29 16:48:41 -0400] erikh: qurve: https://gist.github.com/c4133da90105b36ad4cf
[2012-05-29 16:49:12 -0400] dwhsix: any gotchas going from 0.10.8 to 0.10.10?  suddenly I get client key not authenticating when I'm creating a server
[2012-05-29 16:49:15 -0400] qurve: Thanks a million erikh
[2012-05-29 16:49:16 -0400] erikh: it's one of the first things that happens in the shutdown procedure, and we don't bank on it working all of the time, just often enough to make life easy enough on us
[2012-05-29 16:49:29 -0400] qurve: gmcinnes: It's actually going pretty well so far.
[2012-05-29 16:49:30 -0400] erikh: dwhsix: link resource is busted
[2012-05-29 16:49:38 -0400] qurve: Yesterday was the 'bang head against wall while learning chef' day.
[2012-05-29 16:49:39 -0400] erikh: that's all I know about bugs in 0.10.10
[2012-05-29 16:49:53 -0400] dwhsix: erikh: thx
[2012-05-29 16:50:12 -0400] dwhsix: actually, it may also be because I'm switching from ubuntu 10.04 to 12.04?
[2012-05-29 16:50:29 -0400] erikh: oh yeah, qurve, you'll need to establish that link manually with chef 0.10.10 -- the link resource used there will likely not work right
[2012-05-29 16:50:45 -0400] erikh: e.g., with the bash resource and ln -sf
[2012-05-29 16:51:01 -0400] erikh: dwhsix: we haven't had any extra issues moving from 10.04 to 12.04
[2012-05-29 16:51:51 -0400] qurve: erik, thanks for the heads up.
[2012-05-29 16:52:02 -0400] btm: dwhsix: did your version of couchdb change? do you have multiple directories in /var/lib/couchdb?
[2012-05-29 16:52:52 -0400] dwhsix: btm: er, not to my knowledge
[2012-05-29 16:53:11 -0400] dwhsix: I only changed chef version on my workstation
[2012-05-29 16:53:20 -0400] dwhsix: our chef server is unchanged
[2012-05-29 16:54:15 -0400] btm: dwhsix: try putting 'node_name foo' in /etc/chef/client.rb, replacing foo with the name of your node on the chef server.
[2012-05-29 16:54:57 -0400] qurve: Now to see if this cloudformation bootstrap works...
[2012-05-29 16:55:37 -0400] dwhsix: btm: yeah, suspecting chef server doesn't know about this node, for some reason not sure why
[2012-05-29 16:56:34 -0400] dwhsix: yeah, it doesn't wtf...
[2012-05-29 16:57:24 -0400] qurve: Should I even bother with deploy resources for non-rails web apps?
[2012-05-29 16:57:37 -0400] qurve: What I'm depliying is PHP web apps, about 5 of them to each webserver node.
[2012-05-29 16:57:47 -0400] qurve: (Basically a network of one-off PHP sites that don't share code bases)
[2012-05-29 16:57:58 -0400] qurve: Right now I'm just using git resources to check out the code and point nginx at it.
[2012-05-29 16:58:08 -0400] qurve: nginx/php-fpm rather.
[2012-05-29 17:08:23 -0400] hoover_damm: the deploy resource is perfectly fine no matter what your app is in
[2012-05-29 17:08:46 -0400] hoover_damm: flexible enough to do more then enough
[2012-05-29 17:08:51 -0400] qurve: OK, it seemed pretty geared towards rails apps, wasn't sure how much current I'd be fighting against to do something else.
[2012-05-29 17:09:26 -0400] qurve: Once you have the deploy resource set up, all the servers are then able to update code and restart the necessary servers, but by what method do the servers find out they need to update the codebase?
[2012-05-29 17:09:39 -0400] qurve: I assume that's an exercise left for me to figure out?
[2012-05-29 17:11:29 -0400] dwhsix: btm:
[2012-05-29 17:11:33 -0400] dwhsix: oops
[2012-05-29 17:11:38 -0400] dwhsix: btm: figured out the issue
[2012-05-29 17:11:57 -0400] dwhsix: I'd created an AMI, but had left  client.pem on it
[2012-05-29 17:12:07 -0400] dwhsix: so that caused probelsm when I tried to create a new node w/ it
[2012-05-29 17:12:44 -0400] hoover_damm: qurve, you deploy a branch
[2012-05-29 17:13:04 -0400] hoover_damm: qurve, or a reference... such a master, or some hash, or some tag
[2012-05-29 17:13:09 -0400] hoover_damm: qurve, such as 'production'
[2012-05-29 17:13:10 -0400] qurve: Yeah, just trying to wrap my head around how nodes know there has been updated code to that branch
[2012-05-29 17:13:25 -0400] hoover_damm: qurve, it looks at the local revision, looks at the remote revision
[2012-05-29 17:13:26 -0400] hoover_damm: and does the math
[2012-05-29 17:13:44 -0400] qurve: Does chef-client just check on a schedule for updates?
[2012-05-29 17:13:52 -0400] hoover_damm: chef-client doesn't run all the time
[2012-05-29 17:13:53 -0400] qurve: Or do you have to go to the node and be like 'yo, check for updated code'
[2012-05-29 17:13:58 -0400] hoover_damm: it runs only when you tell it to, or have it setup to
[2012-05-29 17:14:02 -0400] qurve: I saw something about chef-client running as a daemon.
[2012-05-29 17:14:02 -0400] btm: dwhsix: ah yeah. chef-client assumes it is registered already if that file exists.
[2012-05-29 17:14:18 -0400] hoover_damm: right, if you have the chef-client cookbook or install via debian packags it'll daemonize
[2012-05-29 17:14:24 -0400] hoover_damm: and default to running every 30minutes
[2012-05-29 17:14:31 -0400] qurve: Gotcha/
[2012-05-29 17:14:48 -0400] hoover_damm: you can use the chef-client cookbook and change the behavior of when to run
[2012-05-29 17:15:21 -0400] hoover_damm: I wouldn't hammer the server unneccesarily... if you need a way to deploy or a way to get chef when you need to... there's other ways to do that
[2012-05-29 17:15:33 -0400] hoover_damm: such a Rundeck and Opscode has provided a pretty neat way to integrate into rundeck
[2012-05-29 17:15:36 -0400] qurve: Yeah, just gotta figure out the new way to think. Currently I deploy code with capistrano, and if I have to make server changes I just build a new instance and move over the elastic IP
[2012-05-29 17:15:47 -0400] qurve: What I'm working on now is much more automated.
[2012-05-29 17:15:51 -0400] hoover_damm: https://github.com/opscode/chef-rundeck
[2012-05-29 17:16:14 -0400] dwhsix: btm: yeah, figured that out but pleased w/ myself, I think a month or so ago it would've taken me all day to figure that out ;-)
[2012-05-29 17:16:31 -0400] knuckolls: qurve: i've found this model of cookbook management to be the best for our environment. https://github.com/jonlives/knife-spork
[2012-05-29 17:16:32 -0400] qurve: I'll have to read up on rundeck, not familiar with that.
[2012-05-29 17:17:19 -0400] qurve: That's pretty cool knuckolls however it's just me :)
[2012-05-29 17:17:35 -0400] qurve: When I get hit by a car, my org is fucked. Yay for SPOFs
[2012-05-29 17:18:36 -0400] hoover_damm: the only way around that is documentation and automation
[2012-05-29 17:18:42 -0400] hoover_damm: or learning how to live forever
[2012-05-29 17:19:10 -0400] hoover_damm: and to a lot of orgs that is still a SPOF, and the only answer to that is to rotate people in and out to ensure that everyone knows what's going on
[2012-05-29 17:19:15 -0400] hoover_damm: and can pull yourself out of a fire
[2012-05-29 17:19:31 -0400] knuckolls: qurve, i'm mostly managing chef myself as well, it's for more than just multiple people, the cookbook versioning and enviroments are a plus for me. helps me have a structured development process around production
[2012-05-29 17:19:51 -0400] hoover_damm: knuckolls, totally without having to bend over backwards not to break production
[2012-05-29 17:19:52 -0400] qurve: My problem is that I started a non-profit that uses a lot of technology to serve the needs of an older demographic.
[2012-05-29 17:20:14 -0400] qurve: Not exactly lots of volunteers among the membership that can help with automated cloud infrastructure, haha.
[2012-05-29 17:20:54 -0400] qurve: Also not lots of money to hire people who can.
[2012-05-29 17:21:12 -0400] daaaan: holy shit, qurve lives
[2012-05-29 17:21:52 -0400] qurve: I do live.
[2012-05-29 17:28:17 -0400] jcran: anyone have a cookbook for unrealircd on ubuntu (or any irc server on ubuntu for that matter)?
[2012-05-29 17:35:38 -0400] szaydel: Hi all. I am fairly new to chef and am just starting to get some plumbing figured out. I have a question about roles and attributes set in a role definition.
[2012-05-29 17:36:07 -0400] szaydel: I created this role def:
[2012-05-29 17:36:24 -0400] szaydel:       cubs
[2012-05-29 17:36:24 -0400] szaydel:   virtual:     yes
[2012-05-29 17:36:24 -0400] szaydel: chef_type:            role
[2012-05-29 17:36:24 -0400] szaydel: default_attributes:
[2012-05-29 17:36:24 -0400] szaydel:   admin_team:
[2012-05-29 17:36:24 -0400] szaydel:       tigers
[2012-05-29 17:36:25 -0400] szaydel:   volatile:    yes
[2012-05-29 17:36:25 -0400] szaydel: description:          First semi-functional Role
[2012-05-29 17:36:25 -0400] szaydel: env_run_lists:
[2012-05-29 17:36:26 -0400] szaydel: json_class:           Chef::Role
[2012-05-29 17:36:26 -0400] szaydel: name:                 demo-env
[2012-05-29 17:36:27 -0400] szaydel: override_attributes:
[2012-05-29 17:36:46 -0400] coderanger: szaydel: Use a pastebin next time
[2012-05-29 17:36:59 -0400] szaydel: OK, sorry will do.
[2012-05-29 17:37:06 -0400] szaydel: I am trying to figure out how I could access the virtual attribute from a recipe.
[2012-05-29 17:37:48 -0400] magoo: what's the best way to do bool values in chef? attributes doesn't take true/false. I've done "true" or "false" strings in the past but what's recommended?
[2012-05-29 17:38:07 -0400] coderanger: magoo: true and false work fine
[2012-05-29 17:38:19 -0400] coderanger: szaydel: role attrs are merged into the node
[2012-05-29 17:38:26 -0400] coderanger: as are environment attrs
[2012-05-29 17:38:32 -0400] qurve: node[:admin_team][:virtual] I believe szaydel
[2012-05-29 17:38:47 -0400] szaydel: qurve : Thank you!
[2012-05-29 17:39:41 -0400] magoo: can role or environment json map to a ruby true/false though?
[2012-05-29 17:39:57 -0400] magoo: i think that's why I didn't use them originally
[2012-05-29 17:41:22 -0400] coderanger: Yes
[2012-05-29 17:42:34 -0400] magoo: ha, well that certainly simplifies things
[2012-05-29 17:42:36 -0400] magoo: thanks
[2012-05-29 17:42:55 -0400] hoover_damm: magoo, json pretty much magically infaltes / deflates proper in ruby
[2012-05-29 17:42:56 -0400] hoover_damm: inflates*
[2012-05-29 17:43:01 -0400] hoover_damm: short of yaml it's pretty awesome
[2012-05-29 17:43:23 -0400] magoo: so "false" will end up as a bool?
[2012-05-29 17:43:58 -0400] coderanger: No, false will end up as a bool
[2012-05-29 17:44:01 -0400] coderanger: "false" will end up a string
[2012-05-29 17:44:10 -0400] UForgotten: heh
[2012-05-29 17:44:15 -0400] UForgotten: let's be precise :)
[2012-05-29 17:44:26 -0400] coderanger: When discussing encoding formats, it helps :)
[2012-05-29 17:46:08 -0400] hoover_damm: irb(main):006:0> bill.to_json
[2012-05-29 17:46:08 -0400] hoover_damm: => "{\"blue\":false,\"red\":true}"
[2012-05-29 17:46:08 -0400] hoover_damm: ends up as false, and then ruby should pull it back in as such
[2012-05-29 17:46:09 -0400] magoo: I actually didn't realize json had a bool type until just now.
[2012-05-29 17:46:28 -0400] magoo: so i appreciate the precision :)
[2012-05-29 17:54:03 -0400] hoover_damm: coderanger, false ends up as 'false' in json... when you re-load json it's imported as bool
[2012-05-29 17:54:10 -0400] hoover_damm: or enumerated
[2012-05-29 17:54:17 -0400] coderanger: huh?
[2012-05-29 17:54:30 -0400] coderanger: JSON has true, false, and (now) null as literals
[2012-05-29 17:55:02 -0400] kallistec: http://www.ietf.org/rfc/rfc4627
[2012-05-29 17:55:07 -0400] hoover_damm: i think we're on the same page, but both confused
[2012-05-29 17:55:12 -0400] hoover_damm: at what we're saying
[2012-05-29 17:55:35 -0400] coderanger: Probably, given that 'false' isn't valid in JSON :)
[2012-05-29 17:55:53 -0400] coderanger: I think you are using Ruby literal notation on top of JSON
[2012-05-29 17:56:16 -0400] erikh: does hosted chef have proper certs? sorry, being lazy
[2012-05-29 17:56:21 -0400] hoover_damm: I believe I am
[2012-05-29 17:56:23 -0400] coderanger: erikh: Yes
[2012-05-29 17:56:37 -0400] erikh: thanks. just wanted to know if I could use :verify_peer
[2012-05-29 18:01:07 -0400] jtimberman: erikh: You can, and should.
[2012-05-29 18:01:39 -0400] resno: should i manaully install an app then let chef manageit?
[2012-05-29 18:01:48 -0400] resno: im about to setup redmine
[2012-05-29 18:01:49 -0400] jtimberman: resno: why not have chef install it?
[2012-05-29 18:02:06 -0400] jtimberman: erikh: and by "should" I mean "thats a damn fine idea and it will work" :)
[2012-05-29 18:02:16 -0400] resno: jtimberman: im not sure, thats why iask... im still learning chef
[2012-05-29 18:02:30 -0400] resno: jtimberman: and i can manually install it faster then using chef :\
[2012-05-29 18:03:49 -0400] jtimberman: there's a redmine cookbook
[2012-05-29 18:04:14 -0400] resno: jtimberman: my lack of chef knowledge scares me away though
[2012-05-29 18:04:42 -0400] resno: jtimberman: can you explain something?
[2012-05-29 18:05:46 -0400] coderanger: He can explain many things :)
[2012-05-29 18:07:04 -0400] magoo: resno: fwiw, there are a lot of good introductions and ideas here: http://www.slideshare.net/flankerfc/chef-introduction-8737820
[2012-05-29 18:07:32 -0400] kisoku: you can always install one thing by hand once faster that you can with chef, that rarely holds true once you need to install the same thing more than once
[2012-05-29 18:08:03 -0400] resno: kisoku: i just dont want tolol
[2012-05-29 18:08:25 -0400] resno: my question: what importance does the site have? if the server manages the node
[2012-05-29 18:08:47 -0400] coderanger: What site?
[2012-05-29 18:09:07 -0400] resno: ops code manger
[2012-05-29 18:09:21 -0400] coderanger: I'm not sure what you mean
[2012-05-29 18:10:03 -0400] paulmooring: resno: do you mean manage.opscode.com ?
[2012-05-29 18:10:06 -0400] resno: mange.opscode.com
[2012-05-29 18:10:07 -0400] resno: paulmooring: yes
[2012-05-29 18:10:17 -0400] paulmooring: It doesn't really provide any functionality that knife doesn't
[2012-05-29 18:10:24 -0400] paulmooring: it's more of a convince thing
[2012-05-29 18:10:26 -0400] cwj: spheromak: i am using your hosts cookbook and i am kind of at a loss as to why the two hosts resources in my recipe seem to be getting conflated
[2012-05-29 18:10:33 -0400] drrk: kisoku: except chef-server - much quicker using the chef-solo trick to install it :)
[2012-05-29 18:10:36 -0400] cwj: spheromak: gist here https://gist.github.com/efd17e94de18b048347b
[2012-05-29 18:10:39 -0400] cwj: any ideas?
[2012-05-29 18:10:44 -0400] coderanger: Knife vs WebUI is a matter of personal taste
[2012-05-29 18:11:04 -0400] cwj: or am i holding it wrong
[2012-05-29 18:11:05 -0400] geekbri: woo! theres now a chef-boston meetup group!
[2012-05-29 18:12:45 -0400] resno: can you add a reciepe through manage?
[2012-05-29 18:13:42 -0400] coderanger: No, cookbook uploads are done via knife
[2012-05-29 18:13:53 -0400] erikh: jtimberman: yeah I know why it's a good idea :)
[2012-05-29 18:13:53 -0400] coderanger: but you can edit run lists via either
[2012-05-29 18:19:10 -0400] kisoku: drrk: couldn't agree with you more :-)
[2012-05-29 18:20:36 -0400] miah: herp
[2012-05-29 18:20:40 -0400] miah: i am kinda alive again
[2012-05-29 18:21:43 -0400] miah: or really. kinda able to deal with people again
[2012-05-29 18:22:48 -0400] geekbri: dealing with people is the pits
[2012-05-29 18:23:31 -0400] yfeldblum: that's odd, the next full moon isn't for another week
[2012-05-29 18:24:37 -0400] miah: lols
[2012-05-29 18:25:12 -0400] coderanger: miah: halp! haproxy is confusing me >_<
[2012-05-29 18:25:22 -0400] qurve: Know what's fun? Trying to figure out the proper amount of quote escaping for a Cloud Formation template => ubuntu could-config YML => command line cmd
[2012-05-29 18:25:47 -0400] qurve: So, SH embedded in YMl embedded in JSON
[2012-05-29 18:25:54 -0400] hoover_damm: coderanger, it can be
[2012-05-29 18:26:00 -0400] hoover_damm: coderanger, specially once you get into halog and more
[2012-05-29 18:26:20 -0400] miah: coderanger: oh? whats going on?
[2012-05-29 18:26:28 -0400] coderanger: much simpler, what is this "listen <name> <ip>:<port>" syntax? The docs don't mention it
[2012-05-29 18:26:47 -0400] coderanger: The official way seems to be "listen <name> \n bind <ip>:<port>"
[2012-05-29 18:27:01 -0400] coderanger: should I just avoid the former entirely?
[2012-05-29 18:27:31 -0400] miah: 'listen' is defined in the 'proxies' section of the docs
[2012-05-29 18:27:33 -0400] miah: http://haproxy.1wt.eu/download/1.5/doc/configuration.txt
[2012-05-29 18:27:39 -0400] hoover_damm: coderanger, listen, and then bind
[2012-05-29 18:27:42 -0400] miah: '4. Proxies'
[2012-05-29 18:28:09 -0400] coderanger: miah: Yes, an nowhere does it mention it can magically take a second argument as syntax sugar for bind :)
[2012-05-29 18:28:36 -0400] hoover_damm: listen someting :port
[2012-05-29 18:28:41 -0400] hoover_damm: mode tcp
[2012-05-29 18:28:45 -0400] hoover_damm: bind :8443 accept-proxy
[2012-05-29 18:28:52 -0400] miah: ah you are load balancing dns?
[2012-05-29 18:28:57 -0400] miah: er. sorry
[2012-05-29 18:29:05 -0400] hoover_damm: coderanger, :) I think miah's cookbook makes it easier
[2012-05-29 18:29:15 -0400] miah: coderanger: it does
[2012-05-29 18:29:16 -0400] coderanger: No, just comparing the current opscode cookbook examples vs the haproxy docs
[2012-05-29 18:29:27 -0400] hoover_damm: oh
[2012-05-29 18:29:29 -0400] coderanger: hoover_damm: mine will make it even easier :)
[2012-05-29 18:29:35 -0400] miah: bind is a proxy keyword
[2012-05-29 18:29:48 -0400] hoover_damm: coderanger, I'd suggest pulling from miah to start with or bemu
[2012-05-29 18:29:55 -0400] miah: bind [<address>]:<port_range> [, ...]
[2012-05-29 18:30:05 -0400] hoover_damm: unless you intentionally want to reinvent the wheel
[2012-05-29 18:30:11 -0400] hoover_damm: they have learned a great deal you shouldn't ignore
[2012-05-29 18:30:14 -0400] miah: i'll gladly work with you on it as well
[2012-05-29 18:30:16 -0400] oddover: Ohai Chefs. Does chef automatically make backup of files that it's going to change? If so, where does it store them?
[2012-05-29 18:30:28 -0400] coderanger: I'm working on a full DSL/LWRP extension for haproxy
[2012-05-29 18:30:36 -0400] hoover_damm: i bet miah would love that
[2012-05-29 18:30:51 -0400] coderanger: oddover: Yes, usually in /var/chef/cache or /var/cache/chef depending on the install method
[2012-05-29 18:31:48 -0400] coderanger: https://github.com/coderanger/haproxy/blob/master/resources/proxy.rb
[2012-05-29 18:32:00 -0400] oddover: coderanger: thanks!
[2012-05-29 18:32:03 -0400] coderanger: Just starting alphabetically :)
[2012-05-29 18:32:05 -0400] cwj: oddover: yes by default they are stored in /var/chef/backup
[2012-05-29 18:32:16 -0400] miah: coderanger: nice
[2012-05-29 18:33:40 -0400] coderanger: miah: So the two-argument proxy definition is just legacy or something? Just seems odd that so many people use a 100% undocumented feature :)
[2012-05-29 18:33:54 -0400] miah: its not undocumented
[2012-05-29 18:34:03 -0400] miah: http://haproxy.1wt.eu/download/1.5/doc/configuration.txt
[2012-05-29 18:34:10 -0400] miah: search for "bind [<address>]:<port_range> [, ...]
[2012-05-29 18:34:20 -0400] miah: there are several paragraphs outlining it
[2012-05-29 18:34:58 -0400] coderanger: Huh?
[2012-05-29 18:35:16 -0400] coderanger: That doesn't mention anywhere that this is legal "listen foo *:80"
[2012-05-29 18:35:26 -0400] coderanger: it is just the same as "listen foo \n bind *:80"
[2012-05-29 18:36:04 -0400] miah: yes
[2012-05-29 18:36:12 -0400] miah: listen <nameofproxy>
[2012-05-29 18:36:16 -0400] miah: OPTIONS
[2012-05-29 18:36:31 -0400] miah: 'listen' is a keyword that starts a new section
[2012-05-29 18:38:26 -0400] coderanger: Right so is "listen foo *:80" a two-argument form of listen or is "*:80" a bare option something special that is recognized as a bind option
[2012-05-29 18:38:36 -0400] coderanger: I can't figure out how their parser works :)
[2012-05-29 18:39:39 -0400] coderanger: In general the parser doesn't seem to do variable argument statements very much, so the first explanation seems unlikely unless it is legacy junk that people just keep using
[2012-05-29 18:40:11 -0400] miah: its a bare option
[2012-05-29 18:40:27 -0400] miah: eg
[2012-05-29 18:40:28 -0400] miah:    listen http-in
[2012-05-29 18:40:28 -0400] miah:         bind *:80
[2012-05-29 18:40:29 -0400] miah:         server server1 127.0.0.1:8000 maxconn 32
[2012-05-29 18:40:53 -0400] miah: ... when in doubt. USE THE SOURCE LUKE
[2012-05-29 18:41:17 -0400] coderanger: In that case "bind *:80" is a thing
[2012-05-29 18:41:38 -0400] coderanger: As opposed to "listen http-in *:80"
[2012-05-29 18:41:52 -0400] miah: i personally don't use 'listen'
[2012-05-29 18:42:01 -0400] miah: just 'frontend' and 'backend'
[2012-05-29 18:42:15 -0400] miketheman: how is there no 'ebs to raid' cookbook/provider/resource out there yet?
[2012-05-29 18:42:33 -0400] coderanger: It seems to work on frontend proxy defs as well
[2012-05-29 18:42:46 -0400] miah: because there is a aws/ebs cookbook and there is a mdadm resource already.
[2012-05-29 18:43:08 -0400] miah: coderanger: yes, 'bind' is a proxy keyword. listen, frontend, backend, are all proxies
[2012-05-29 18:43:19 -0400] miketheman: miah: very true, but no method exists to auto-build a raid array of ebs volumes, correct?
[2012-05-29 18:43:26 -0400] coderanger: I'm not talking about bind, I'm talking about _not having "bind"_
[2012-05-29 18:43:35 -0400] coderanger: Which is supported, but totally undocumented
[2012-05-29 18:43:40 -0400] miketheman: miah: also, there's no filesystem formatting - that's also left to your imagination
[2012-05-29 18:43:42 -0400] coderanger: but everyone uses it
[2012-05-29 18:44:32 -0400] miah: coderanger: i'm a little confused. you dont want to use the 'bind' keyword at all? or.. ?
[2012-05-29 18:44:45 -0400] miah: miketheman: yes. that is chef. its a api/framework to build shit.
[2012-05-29 18:44:58 -0400] coderanger: I don't want anything, just trying to understand the haproxy config parser
[2012-05-29 18:46:12 -0400] geekbri: i use a pair of cookbooks called "lvm" and "volumes" by some guy on github named kohder... there is however no documentation at all
[2012-05-29 18:46:19 -0400] geekbri: (this is for raiding ephemeral and ebs volumes"
[2012-05-29 18:46:37 -0400] geekbri: I keep meaning to write a readme.md for him and do a pull request... but no time.
[2012-05-29 18:47:18 -0400] miah: coderanger: ah ok. well i'm around if you want to discuss more.
[2012-05-29 18:47:29 -0400] coderanger: miah: I think I found the relevant C code
[2012-05-29 18:47:45 -0400] miah: o
[2012-05-29 18:47:52 -0400] coderanger: Yeah, listen and frontend both allow an optional second argument
[2012-05-29 18:48:05 -0400] coderanger: which is 100% just syntactic sugar for bind
[2012-05-29 18:48:08 -0400] coderanger: runs the same code
[2012-05-29 18:48:18 -0400] avishai: hi
[2012-05-29 18:48:28 -0400] miah: ah interesting
[2012-05-29 18:48:54 -0400] avishai: anyone had "/usr/lib/ruby/vendor_ruby/1.8/rubygems/custom_require.rb:53:in `gem_original_require': no such file to load -- mixlib/shellout/exceptions (LoadError)"
[2012-05-29 18:49:02 -0400] avishai: on ubuntu installing from gem?
[2012-05-29 18:55:18 -0400] btm: avishai: just you on the mailing list. could you file a bug and provide the usual data like output of 'gem list'? What version of mixlib-shellout is installed?
[2012-05-29 18:55:59 -0400] avishai: cool
[2012-05-29 18:58:33 -0400] btm: avishai: If I can repro it i'll help. also, version of: ruby, rubygems, ubuntu. (is ruby from deb, source, or omnibus)
[2012-05-29 18:59:49 -0400] avishai: ruby 1.8.7, installation from gem
[2012-05-29 19:00:16 -0400] avishai: ubuntu 11.10
[2012-05-29 19:10:20 -0400] resno: im tryig to installtheredmine cookbook but it doesnt work
[2012-05-29 19:21:26 -0400] patcon: anyone know why all the database cookbook "depends" on all the other database-specific cookbook instead of using "suggests": https://github.com/opscode-cookbooks/database/blob/master/metadata.rb
[2012-05-29 19:22:46 -0400] patcon: seems a little overboard, but maybe I'm missing something. perhaps due to having the providers and resources in libraries?
[2012-05-29 19:24:23 -0400] btm: patcon: I think for ease of use. There isn't another mechanism for making things not go totally haywire if you're missing other cookbooks.
[2012-05-29 19:24:32 -0400] btm: patcon: like suggests is nothing more than a line in metadata.
[2012-05-29 19:26:38 -0400] patcon: ah ok, just seems that cookbooks like mysql remain intentionally agnostic, so just seemed counter: https://github.com/opscode-cookbooks/apache2#cookbooks
[2012-05-29 19:26:47 -0400] patcon: but yeah, if it borks eveything, that makes sense :)
[2012-05-29 19:26:51 -0400] patcon: thanks btm
[2012-05-29 19:30:16 -0400] resno: btm: can you help a noobie?
[2012-05-29 19:30:45 -0400] btm: resno: You should just ask your question, and if someone is around who can help they will.
[2012-05-29 19:31:08 -0400] resno: btm: i did such thing and my question remains un-answered
[2012-05-29 19:31:31 -0400] geekbri: it may be nobody knows the answer, or it may be that your question was too vague.
[2012-05-29 19:31:35 -0400] btm: resno: I suppose nobody knew the answer to your question then. :)
[2012-05-29 19:31:50 -0400] resno: it was likely to vague, but why go on with no one around?
[2012-05-29 19:31:53 -0400] knuckolls: resno: yeah helps if you put what's wrong in a pastebin or a gist or something. something specific
[2012-05-29 19:32:13 -0400] resno: i hate talking to myself :)
[2012-05-29 19:32:26 -0400] btm: resno: you may want to review this guide, http://www.catb.org/~esr/faqs/smart-questions.html and if you still don't get an answer here you can try the mailing list http://lists.opscode.com/sympa/arc/chef
[2012-05-29 19:32:34 -0400] resno: knuckolls: its more a misunderstanding of the process then a bug
[2012-05-29 19:32:50 -0400] knuckolls: resno: k, we can help with that. what's wrong?
[2012-05-29 19:33:21 -0400] resno: ok, so i pulled the redmine code and i need to setup the "bag"?
[2012-05-29 19:33:56 -0400] resno: argh, i closed the tab i was following
[2012-05-29 19:34:12 -0400] knuckolls: btm, that smart questions document is great. i'm glad someone wrote this up
[2012-05-29 19:35:06 -0400] btm: resno: that is probably referring to 'data bags' where are objects where you can store data in JSON format and retrieve them to change how cookbooks act. http://wiki.opscode.com/display/chef/Data+Bags
[2012-05-29 19:35:37 -0400] resno: btm: i wasnt there.. i was following a guide to do it
[2012-05-29 19:43:05 -0400] btm: resno: that's the page that explains what data bags are. Since you put quotes around bag, it sounded like you weren't sure what a data bag is.
[2012-05-29 19:46:44 -0400] resno: btm: fair enough. ill take a look and see if i can get to thebottom
[2012-05-29 19:48:16 -0400] simonjj: was there a change in the way ShellOut behaves, because looking at this: https://github.com/opscode/cookbooks/blob/master/python/providers/pip.rb#L129 tells me we don't really want to abort in the case were our shell command fails... that is what happens however
[2012-05-29 19:49:35 -0400] simonjj: I am using the recipe to deploy python. pip etc.... and upon an attempted install of virtualenv my chef run stops because "pip freeze | grep -i virtualenv" returns a 1 since it's not installed yet
[2012-05-29 19:49:56 -0400] simonjj: so I am assuming this work at one point, but now the Shellout exception changed ?
[2012-05-29 19:49:57 -0400] knuckolls: simonjj: i was fighting that error with the python cookbook on friday before i left. just +1 on it being a bug.
[2012-05-29 19:50:27 -0400] knuckolls: i tried downgrading the python cookbook to the previous version as well, no luck.
[2012-05-29 19:52:05 -0400] oddover: cwj: That path you gave me for where it store's backups...is that the same for chef-solo?
[2012-05-29 19:52:38 -0400] resno: well, then i found something tohelpme along :)
[2012-05-29 19:52:40 -0400] simonjj: knuckolls at least I am not the only one
[2012-05-29 19:53:44 -0400] hoover_damm: knuckolls, what bug with the python cookbook do you have?
[2012-05-29 19:53:49 -0400] hoover_damm: the virtualenv change?
[2012-05-29 19:54:12 -0400] knuckolls: pretty much that exact same error, let me replicate it or find the gist from last friday
[2012-05-29 19:54:19 -0400] hoover_damm: https://github.com/opscode-cookbooks/python/pull/7
[2012-05-29 19:54:22 -0400] hoover_damm: related to that pull?
[2012-05-29 19:54:42 -0400] hoover_damm: do remember to check the github repo for issues/pull requests as those sometimes can give you the +1 on your bug
[2012-05-29 19:54:44 -0400] hoover_damm: and give you an answer
[2012-05-29 19:54:53 -0400] simonjj: yup
[2012-05-29 19:55:09 -0400] simonjj: hoover_damm: that's the one
[2012-05-29 19:55:12 -0400] knuckolls: i'll try that fix here shortly.
[2012-05-29 19:55:17 -0400] knuckolls: thanks :)
[2012-05-29 19:55:26 -0400] hoover_damm: yep, a few people hit it up
[2012-05-29 19:55:32 -0400] hoover_damm: maybe someone at opscode can merge it in soon
[2012-05-29 19:55:44 -0400] geekbri: does the pull request say there is an associated jira ticket?
[2012-05-29 19:55:47 -0400] geekbri: with a signed CLA?
[2012-05-29 19:56:47 -0400] knuckolls: looks like no.
[2012-05-29 19:56:58 -0400] SplasPood: hrm.. has anyone used knife-lastrun in conjunction with the chef_handler cookbook?
[2012-05-29 19:57:05 -0400] geekbri: well then thats probably not going to get merged soon :)
[2012-05-29 19:57:19 -0400] hoover_damm: then someone should update the pull request stating that :)
[2012-05-29 19:57:26 -0400] hoover_damm: communication is required for people to know what's up or down
[2012-05-29 19:57:33 -0400] geekbri: I dont work for ops code, but i'll do it  anyway!
[2012-05-29 19:58:07 -0400] geekbri: done.
[2012-05-29 19:59:19 -0400] knuckolls: linked to the relevant contribution pages in the wiki
[2012-05-29 19:59:46 -0400] simonjj: so I just saw the repo per cookbook setup (glad it was done).... does that mean that github.com/opscode/cookbooks isn't maintained anymore ?
[2012-05-29 19:59:57 -0400] knuckolls: github.com/opscode-cookbooks/
[2012-05-29 20:00:36 -0400] knuckolls: new standard is one repo per cookbook
[2012-05-29 20:00:41 -0400] knuckolls: https://github.com/opscode/cookbooks/commits/master
[2012-05-29 20:02:43 -0400] jespada: guys anyone having problems with including a recipe, ie:  include_recipe "ohai" then I use a template to create a custom ohai plugin and the notify :reload  fail..
[2012-05-29 20:03:12 -0400] jespada: with something like : Cannot find a resource matching ohai[..
[2012-05-29 20:04:01 -0400] jespada: basically i'm using this: https://github.com/yuilop/chef-repo/blob/master/cookbooks/nginx/recipes/ohai_plugin.rb
[2012-05-29 20:04:41 -0400] hoover_damm: btm, you should put that smart questions guide in the topic :)
[2012-05-29 20:04:56 -0400] hoover_damm: btm, and thank whomever wrote that darn thing because :) they put a lot of effort into it
[2012-05-29 20:06:24 -0400] asmedrano: Greetings!
[2012-05-29 20:06:24 -0400] gmcinnes: has anyone had trouble with the database cookbook on Ubuntu 12.04? (mysql 5.5) ?
[2012-05-29 20:06:41 -0400] resno: i am trying tomodify the redmine cookbook. I am reading from here, http://wiki.opscode.com/display/chef/Working+with+Git+and+Cookbooks to modify default.rb, but this file is looking for parameters to be passed. so, ive google for modify cookbook and imnot sure how pass it the arguments or edit the cookbook itself
[2012-05-29 20:10:27 -0400] btm: hoover_damm: that's Eric S. Raymond of multiple fames. (Open Source Initiative, fetchmail and others)
[2012-05-29 20:12:25 -0400] btm: resno: what 'parameters' are you trying to pass?
[2012-05-29 20:12:50 -0400] resno: btm: like i want to say, use mysql database and not sqlite.
[2012-05-29 20:13:07 -0400] hcastro: atomic-penguin: what kind of sorcery did you use to convince university administrators to adopt chef?
[2012-05-29 20:13:09 -0400] hoover_damm: btm, *nod* I was suprised to see you sharing it
[2012-05-29 20:13:27 -0400] hoover_damm: darn good guide
[2012-05-29 20:13:29 -0400] resno: btm: in the default.rb it says, "when sqlite",
[2012-05-29 20:13:29 -0400] btm: resno: Then what you mean is you want to set the node[:redmine][:db][:type] node attribute.
[2012-05-29 20:14:36 -0400] resno: btm: is this what ineed? http://wiki.opscode.com/display/chef/Attributes
[2012-05-29 20:14:43 -0400] btm: resno: there are a few ways to set node attributes, the simplest place for you to start is to create a role called 'redmine' that contains 'recipe[redmine]' in its run list and sets an override_attribute for that value.
[2012-05-29 20:14:58 -0400] mattray: gmci: I think there are a few patches for the mysql cookbook for 12.04
[2012-05-29 20:15:00 -0400] btm: resno: yes, that page contains a lot of really essential information.
[2012-05-29 20:15:32 -0400] gmcinnes: mattray: where would I find them? I'm trying to grep stuff out of jira, but I'm too thick :)
[2012-05-29 20:16:29 -0400] atomic-penguin: hcastro, you mean executives?
[2012-05-29 20:16:33 -0400] atomic-penguin: hcastro, I didn't
[2012-05-29 20:16:46 -0400] mattray: gmcinnes: http://tickets.opscode.com/browse/COOK/component/10142
[2012-05-29 20:16:53 -0400] atomic-penguin: hcastro, started using it, bragged about it in a case study, then had the CIO sign off on the case study
[2012-05-29 20:17:07 -0400] mattray: gmcinnes: I clicked COOK->then Components->then MySQL
[2012-05-29 20:17:11 -0400] atomic-penguin: hcastro, she was like "you guys are awesome"
[2012-05-29 20:17:13 -0400] knuckolls: gmcinnes: and https://github.com/opscode-cookbooks/mysql/pulls
[2012-05-29 20:17:13 -0400] hcastro: atomic-penguin: are you guys paying for it in any way?
[2012-05-29 20:17:39 -0400] hcastro: atomic-penguin: you much have a different breed of executives that we do
[2012-05-29 20:17:45 -0400] mattray: gmcinnes: https://github.com/opscode-cookbooks/mysql has a number of pulls to it
[2012-05-29 20:18:15 -0400] gmcinnes: mattray: ah. fsck. I forgot you guys had changed the cookbook layout.
[2012-05-29 20:18:30 -0400] hoover_damm: hcastro, where are you at now? that your execs are happy with?
[2012-05-29 20:18:44 -0400] hoover_damm: 0 cm? some? puppet?
[2012-05-29 20:19:05 -0400] SplasPood: bah, why can't chef_handler find the lastrun_update.rb :(
[2012-05-29 20:19:33 -0400] bflad: hoover_damm: +1
[2012-05-29 20:19:41 -0400] hoover_damm: hitting enter and random badly documented text files really didn't work
[2012-05-29 20:19:50 -0400] hcastro: hoover_damm: cfengine2 and it barely gets used
[2012-05-29 20:19:52 -0400] hoover_damm: thankfully I didn't start those policies
[2012-05-29 20:20:21 -0400] hoover_damm: hcastro, so it's possible the executives don't understand why you don't use it?
[2012-05-29 20:21:56 -0400] hcastro: hoover_damm: more senior admins send the message that hand crafting is good enough
[2012-05-29 20:21:57 -0400] hoover_damm: hcastro, if you can get everyone into the 'style' of chef and automate your whole infrastructure you can tout that as the reason.
[2012-05-29 20:22:26 -0400] hoover_damm: hcastro, so you'll have to teach those sernior admins new tricks and make them realize that we're not making them outdated.  We're letting their brain cells work on things that need it more
[2012-05-29 20:23:02 -0400] hcastro: hoover_damm: much easier said than done, but i agree with your point
[2012-05-29 20:23:07 -0400] hoover_damm: hcastro, there's only 24 hours in the day.  The speed of light is only as fast as it is.  The only way to get more done is to organize
[2012-05-29 20:23:32 -0400] hoover_damm: and start automating everything so you personally don't have to copy and paste a 50 line shell script that breaks every 3 runs
[2012-05-29 20:23:45 -0400] qurve: This error is killing me
[2012-05-29 20:23:46 -0400] qurve: [Tue, 29 May 2012 20:23:09 +0000] FATAL: IOError: Cannot open or read /var/cache/chef/cookbooks/nginx/recipes/default.rb!
[2012-05-29 20:23:53 -0400] qurve: 2/3 EC2 instances have failed to bootstrap because of that.
[2012-05-29 20:24:01 -0400] hoover_damm: hcastro, totally easier said then done.  It's why Rails developers joke that the easiest way to upgrade rails is to quit jobs
[2012-05-29 20:24:01 -0400] knuckolls: qurve: are you running the chef-client as root? or something with sudo privleges?
[2012-05-29 20:24:03 -0400] qurve: Waiting to see how many instances my auto-scaling group has to go through
[2012-05-29 20:24:09 -0400] qurve: It runs as root, yes.
[2012-05-29 20:24:21 -0400] qurve: It's not a permission issue, 1 machine boot-strapped properly so far.
[2012-05-29 20:24:24 -0400] qurve: 2 failures.
[2012-05-29 20:24:54 -0400] knuckolls: hmm. yeah you got me. http://www.itisamystery.com/itisamystery.gif
[2012-05-29 20:24:55 -0400] qurve: It is however making me wonder if this is stable enough to use in a production env :(
[2012-05-29 20:25:10 -0400] qurve: Based on talking to guys before I think it's a known problem with the RUby GC.
[2012-05-29 20:25:19 -0400] knuckolls: SplasPood: I use it, and live by it. I wrote a hipchat handler.
[2012-05-29 20:26:33 -0400] qurve: I'd just really hate to have built all this machinery to not be able to use it effectively.
[2012-05-29 20:26:34 -0400] SplasPood: knuckolls: ahh maybe you could help me with what I'm sure is a n00bish problem.   I'm trying to setup knife-lastrun...  and I wanna use chef_handler vs just editting client.rb everywhere (where this works fine) ...  In a client.rb setup i'd be doing a require 'lastrun_update' when I say source 'lastrun_update' in the provider from chef_handler it complains it can't find lastrun_update.rb ... what am I doing wrong? ;)
[2012-05-29 20:27:13 -0400] knuckolls: hm, hold on let me refamiliarize myself with the code i wrote.
[2012-05-29 20:27:37 -0400] SplasPood: knuckolls: :)  thanks
[2012-05-29 20:29:11 -0400] SplasPood: knuckolls: hrm, just found some updated docs re lastrun in a github fork, I think this might hold the solution to my problem
[2012-05-29 20:29:39 -0400] knuckolls: SplasPood: should be nothing more than this
[2012-05-29 20:29:40 -0400] knuckolls: https://gist.github.com/2830513
[2012-05-29 20:30:12 -0400] SplasPood: knuckolls: difference here is that the handler is from an installed gem and not just dropped in my handler dir
[2012-05-29 20:30:13 -0400] knuckolls: i installed the chef_handler cookbook, run that first in the run list, then i have another cookbook with my handler as a template and the code in that gist as the default.rb
[2012-05-29 20:30:51 -0400] knuckolls: well. link `which my_command` do to 'handler_dir' end
[2012-05-29 20:31:59 -0400] SplasPood: hrm, seems hosted chef is having some problems
[2012-05-29 20:32:08 -0400] qurve: OK, 4th server installed fine
[2012-05-29 20:32:18 -0400] qurve: Still not very pleased with 50% of servers failing to bootstrap though :(
[2012-05-29 20:32:53 -0400] SplasPood: knuckolls: this is some unholy combo of omnibus chef (and thus ruby), this being installed via a gem and... blah
[2012-05-29 20:33:44 -0400] knuckolls: SplasPood: if you don't get a more elegant answer, pull in the code from the gem into a template and deploy the way I did.
[2012-05-29 20:33:58 -0400] SplasPood: knuckolls: yea, been trying to avoid that ;)
[2012-05-29 20:34:25 -0400] qurve: btm: If you're still here, you were saying before that there was an edge version of chef that fixes some of these bugs?
[2012-05-29 20:34:37 -0400] SplasPood: Gem.all_load_paths.grep(/lastrun_update/)  <-- for some reason that's not finding it
[2012-05-29 20:35:02 -0400] SplasPood: (trying to avoid hard coding the actual path to the .rb)
[2012-05-29 20:35:45 -0400] yfeldblum: qurve, you said you were using ruby-1.8.7?
[2012-05-29 20:35:54 -0400] qurve: Yes.
[2012-05-29 20:36:07 -0400] qurve: Basically whatever gets installed when I apt-get install chef from the opscode debian source
[2012-05-29 20:36:29 -0400] qurve: So far 50% of my auto-scaled instances have failed with FATAL: IOError: Cannot open or read /var/cache/chef/cookbooks/nginx/recipes/default.rb!
[2012-05-29 20:36:36 -0400] qurve: (This is still in testing, not an emergency)
[2012-05-29 20:36:39 -0400] yfeldblum: qurve, on a debianoid?
[2012-05-29 20:37:18 -0400] qurve: I'm just going from the opscode guide about setting up a client node
[2012-05-29 20:37:29 -0400] qurve: added http://apt.opscode.com/ to sources.list.d/opscode.list, installed the gpg key, etc.
[2012-05-29 20:37:32 -0400] SplasPood: yea there's too many guides and they're all too outdated/wrong :P
[2012-05-29 20:37:50 -0400] qurve: it works, 3/5 have now bootstrapped properly.
[2012-05-29 20:37:57 -0400] qurve: But randomly some will just fail with that IOError
[2012-05-29 20:38:13 -0400] qurve: At which point the auto-scaling-group kills them and another one starts up. Eventually it will work :)
[2012-05-29 20:38:18 -0400] SplasPood: when you get that error... can YOU open or read that file?
[2012-05-29 20:38:27 -0400] qurve: Yes, the file is fine.
[2012-05-29 20:38:32 -0400] yfeldblum: qurve, what happens if you use opscode's chef-full installer?
[2012-05-29 20:38:42 -0400] qurve: Not familiar with that.
[2012-05-29 20:38:53 -0400] qurve: My apologies, I started using chef for the first time yesterday, so I may be ignorant of a lot.
[2012-05-29 20:39:10 -0400] qurve: But I do have cloudformation bootstrapping auto-scaled instances from hosted chef.
[2012-05-29 20:39:14 -0400] qurve: So I got that far :)
[2012-05-29 20:40:19 -0400] yfeldblum: qurve, it installs an isolated copy of ruby, rubygems, and the chef gems into /opt/chef/, and it includes ruby-1.9.2; it's a replacement for using chef with the base system's outdated ruby/rubygems
[2012-05-29 20:40:29 -0400] qurve: Interesting.
[2012-05-29 20:40:37 -0400] qurve: Is that just an apt-package from the apt.opscode?
[2012-05-29 20:41:41 -0400] qurve: Right now my UserData is just doing: echo 'chef chef/chef_server_url string https://api.opscode.com/organizations/ORG' | debconf-set-selections && apt-get install -y chef
[2012-05-29 20:41:44 -0400] btm: qurve: you should provide the output of 'chef-client -l debug' in a pastebin when it comes to errors. it's hard to tell from that error why the file isn't there.
[2012-05-29 20:42:04 -0400] qurve: OK, I just killed both my instances, so I'll see if one of them fails again.
[2012-05-29 20:42:15 -0400] qurve: The main problem is that 99% of the time if the bootstrap fails and I just run it again, it works.
[2012-05-29 20:42:40 -0400] btm: qurve: the omnibus installers are full stack installers that come with a version of Ruby embedded in them. They're still in beta for another week or two and described here: http://lists.opscode.com/sympa/arc/chef-dev/2011-08/msg00055.html
[2012-05-29 20:42:58 -0400] qurve: Ah, OK , I'll look into that.
[2012-05-29 20:43:11 -0400] qurve: Unfortunately I have to have this stack production ready by the end of the week :(
[2012-05-29 20:43:11 -0400] btm: qurve: you could be having a network issue, I could only guess.
[2012-05-29 20:43:25 -0400] qurve: ill get the full stack trace/dump next time it fails.
[2012-05-29 20:45:16 -0400] qurve: Omnibus looks pretty cool though :)
[2012-05-29 20:46:11 -0400] qurve: I appreciate you guys being so helpful.
[2012-05-29 20:47:00 -0400] miah: helpful is what the H in chef stands for
[2012-05-29 20:47:26 -0400] qurve: Yep, looks like this time that file actually isn't there.
[2012-05-29 20:48:12 -0400] qurve: http://pastebin.com/qFEMAVwD
[2012-05-29 20:48:13 -0400] cwj: oddover: not sure re: solo backup path
[2012-05-29 20:49:16 -0400] qurve: This time I killed both instances, only one made it back up.
[2012-05-29 20:49:39 -0400] thehar: oh chefspec
[2012-05-29 20:49:40 -0400] thehar: you so cray
[2012-05-29 20:50:03 -0400] qurve: So am I just unlucky? Or is this a problem other people have seen?
[2012-05-29 20:50:14 -0400] cwj: thehar: ohai :D
[2012-05-29 20:50:20 -0400] qurve: It's ubuntu 12.04 LTS + ruby 1.8.7 + chef 0.10
[2012-05-29 20:50:23 -0400] thehar: cwj: ohai!
[2012-05-29 20:53:31 -0400] qurve: OK, I think this calls for a game of ping pong, that will be more fun than watching instances cycle :)
[2012-05-29 20:53:35 -0400] qurve: Thanks again for all your help guys.
[2012-05-29 20:54:19 -0400] mconigliaro: is there a known issue with the service provider on centos not being able to correctly determine the status of a service?
[2012-05-29 20:54:35 -0400] mconigliaro: i keep seeing " supports status, running" in my logs
[2012-05-29 20:54:54 -0400] mconigliaro: but i have "supports :status => false" in my service definition
[2012-05-29 20:55:48 -0400] mconigliaro: I'm not sure why that's happening
[2012-05-29 20:55:59 -0400] jeffg: jtimberman, thanks for fix0ring the open training slides zip.  works great now!
[2012-05-29 21:00:28 -0400] mconigliaro: i think the problem is that "supports :status => false" doesn't work
[2012-05-29 21:00:48 -0400] mconigliaro: i see "supports status, running" in my logs no matter what i do
[2012-05-29 21:02:11 -0400] pwf: is there any way to define an attribute in hosted chef that's a subkey of another default attribute, without overriding the parent attribute?
[2012-05-29 21:02:17 -0400] mconigliaro: oh http://tickets.opscode.com/browse/CHEF-2345
[2012-05-29 21:03:12 -0400] pwf: like if i have default[:foo][:bar] = "something" and my node's json includes {"foo": {"baz": "something"}
[2012-05-29 21:03:27 -0400] pwf: node[:foo][:bar] will be gone, no?
[2012-05-29 21:03:48 -0400] eherot: hmm.anyone have a thought on why node["chef_environment"] might not be defined on this one node of mine?
[2012-05-29 21:04:11 -0400] cwj: eherot: you need to use node.chef_environment
[2012-05-29 21:04:20 -0400] eherot: hmm
[2012-05-29 21:04:27 -0400] eherot: guess that would do it
[2012-05-29 21:04:35 -0400] cwj: it is how it is done :)
[2012-05-29 21:05:22 -0400] eherot: glad I asked :-)
[2012-05-29 21:05:47 -0400] eherot: I thought all of the node objects were supposed to be able to use that notation and node['blah'] notation interchangeably
[2012-05-29 21:06:46 -0400] mconigliaro: i think chef_environment is special
[2012-05-29 21:06:58 -0400] mconigliaro: because its not actually an attribute?
[2012-05-29 21:07:53 -0400] pwf: am i just setting up my attributes in a dumb way since i'm running into this problem
[2012-05-29 21:08:26 -0400] pwf: like i should be doing default[:foo_bar] instead of default[:foo][:bar] to avoid overriding the whole dict when i use json attributes
[2012-05-29 21:08:39 -0400] yfeldblum: pwf, no, chef merges the attributes structure
[2012-05-29 21:08:41 -0400] mconigliaro: pwf: i thought some sort of merging happened
[2012-05-29 21:09:13 -0400] yfeldblum: pwf, when chef-client reads the node["foo"] key, there will be both "bar" and "baz" subkeys
[2012-05-29 21:09:14 -0400] pwf: i've definitely run into this before...
[2012-05-29 21:09:18 -0400] pwf: but it was using vagrant chef
[2012-05-29 21:10:18 -0400] yfeldblum: pwf, however, with chef-current, unfortunately you are not allowed to save a reference to `node["foo"]`; you have to traverse the whole chain down to the atomic value you're looking for, or you have to save a reference to `node["foo"].to_hash`
[2012-05-29 21:10:59 -0400] yfeldblum: #chef_environment is a *method* of class Chef::Node
[2012-05-29 21:11:05 -0400] pwf: i don't quite understand that, but i don't think that's what i'm trying to do
[2012-05-29 21:11:18 -0400] pwf: i just want to override one sub-key without losing the whole dict
[2012-05-29 21:11:22 -0400] pwf: which apparently is possible
[2012-05-29 21:11:24 -0400] yfeldblum: you access node attributes with the [] syntax, and you call methods using the . syntax
[2012-05-29 21:37:36 -0400] btm: Ohai 6.14.0.rc.1 is up on Rubygems, any testing that can be done is appreciated. (gem install ohai --pre)
[2012-05-29 22:01:21 -0400] SplasPood: anyone else notice hosted chef flaking out today?
[2012-05-29 22:07:33 -0400] cwj: SplasPood: no real problems that i've seen
[2012-05-29 22:08:09 -0400] SplasPood: cwj: just occasional issues hitting the servers.. always gets in within it's 5 retries
[2012-05-29 22:08:26 -0400] cwj: oh yeah thats kind of the norm lately
[2012-05-29 22:08:47 -0400] cwj: dunno why but it hasnt bothered me enough to open a support request about it
[2012-05-29 22:27:43 -0400] silk: I seem to be running up against a bug in 0.10.10 to do with symlinks and ownership (CHEF-3102). Does the knife-ec2 plugin honour the bootstrap-version option to nominate an older release?
[2012-05-29 22:30:41 -0400] qurve: Ugh, 7 minutes to bootstrap a server :(
[2012-05-29 22:31:12 -0400] erikh: btm: what's the state of os x support on the latest ohai?
[2012-05-29 22:31:17 -0400] erikh: I was thinking of making de patchez
[2012-05-29 22:31:53 -0400] mattray: qurve: rackspace?
[2012-05-29 22:31:57 -0400] qurve: ec2
[2012-05-29 22:32:14 -0400] qurve: That's the highest I've seen, so it may be a fluke.
[2012-05-29 22:32:15 -0400] mattray: long run list, or just slow API response?
[2012-05-29 22:32:25 -0400] qurve: No idea what the root cause is.
[2012-05-29 22:32:28 -0400] qurve: My run list is pretty small
[2012-05-29 22:32:35 -0400] qurve: nginx, php-fpm and a code drop.
[2012-05-29 22:32:37 -0400] mattray: micro?
[2012-05-29 22:32:40 -0400] qurve: m1.small
[2012-05-29 22:32:47 -0400] mattray: odd
[2012-05-29 22:32:57 -0400] qurve: Still trying to decide whether to use lots of m1.small or fewer m1.large once I put this into production.
[2012-05-29 22:33:01 -0400] qurve: Anyone have any opinions on that?
[2012-05-29 22:33:03 -0400] qurve: (It's in an ASG)
[2012-05-29 22:34:01 -0400] mattray: I like larges since you'll get put on an over-subscribed box anyway
[2012-05-29 22:34:08 -0400] mattray: at least more of it will be assigned to you
[2012-05-29 22:34:43 -0400] qurve: CloudFormation is very neat, but I keep running into annoying limitations.
[2012-05-29 22:34:45 -0400] silk: provided you can still populate enough AZ's
[2012-05-29 22:35:02 -0400] qurve: Well, I'm running this in a single az for the time being.
[2012-05-29 22:35:18 -0400] qurve: It's for a non-profit I run that has a much higher technology need than it has a budget sadly.
[2012-05-29 22:36:38 -0400] silk: i didnt think non-profit was meant to mean loss making :)
[2012-05-29 23:09:02 -0400] valdezjoelt: hi miah :) are you there?
[2012-05-29 23:09:10 -0400] valdezjoelt: are you here?
[2012-05-29 23:14:41 -0400] valdezjoelt: help: im having error NameError: uninitialized constant Chef::Win32::Service, the recipe perfectly with some of the nodes, but for some reason im getting this error on one node. is this something to do with the gem library?
[2012-05-29 23:16:10 -0400] erikh: gem list --local on that box?
[2012-05-29 23:19:00 -0400] qurve: Can attributes go multiple levels deep or just one?
[2012-05-29 23:19:15 -0400] qurve: eg, can I do: defaults['my-cookbook']['database']['hostname'] = "xxx"
[2012-05-29 23:19:31 -0400] qurve: Or should be by default['my-cookbook']['database_hostname']
[2012-05-29 23:22:03 -0400] ssd7__: valdezjoelt: I believe that is a known bug that will be fixed in the next release.
[2012-05-29 23:22:33 -0400] ssd7__: valdezjoelt: http://tickets.opscode.com/browse/CHEF-3155
[2012-05-29 23:38:47 -0400] hoover_damm: qurve, hashes can be hashes of hashes
[2012-05-29 23:38:51 -0400] hoover_damm: qurve, so yes
[2012-05-29 23:38:55 -0400] qurve: Rad, thanks.
[2012-05-29 23:39:16 -0400] qurve: Still need to figure out why it seems to the mysql package seems to be ignoring what i set in an environment though
[2012-05-29 23:39:17 -0400] hoover_damm: fire up pry or irb, or shef and basically have some basic ruby foo fun
[2012-05-29 23:39:27 -0400] qurve: a default from an environment will override a default from a cookbook/recipe right?
[2012-05-29 23:40:15 -0400] hoover_damm: qurve, http://wiki.opscode.com/display/chef/Deep+Merge
[2012-05-29 23:40:40 -0400] qurve: I've read that, just wanted to make sure I didn't misunderstand it.
[2012-05-29 23:41:16 -0400] qurve: I'll take a gander at it again.
[2012-05-29 23:41:58 -0400] hoover_damm: interesting part is the subtractions on that
[2012-05-29 23:42:56 -0400] hoover_damm: qurve, anywho the answer is in http://wiki.opscode.com/display/chef/Attributes
[2012-05-29 23:43:14 -0400] qurve: Do you guys use chef to bootstrap developer machines?
[2012-05-29 23:43:19 -0400] hoover_damm: qurve, http://wiki.opscode.com/display/chef/Attributes#Attributes-SettingAttributes is zoned in on it
[2012-05-29 23:43:21 -0400] qurve: Wondering if I'm taking this too far..
[2012-05-29 23:43:35 -0400] hoover_damm: some do
[2012-05-29 23:43:44 -0400] erikh: pivotal does
[2012-05-29 23:43:48 -0400] hoover_damm: your aware that chef is starting to automate windows too right qurve?
[2012-05-29 23:43:52 -0400] erikh: and @bleything has some stuff along that vein
[2012-05-29 23:43:54 -0400] erikh: (os x stuff)
[2012-05-29 23:43:56 -0400] hoover_damm: s/starting/is
[2012-05-29 23:43:56 -0400] qurve: OK, so env should override recipe.
[2012-05-29 23:44:06 -0400] qurve: Will need to figure out what I'm doing wrong then.
[2012-05-29 23:44:19 -0400] qurve: hoover_damm: I've seen that, but I don't do any windows development.
[2012-05-29 23:44:30 -0400] hoover_damm: qurve, https://github.com/atmos/cinderella is one example
[2012-05-29 23:44:32 -0400] qurve: I use VMs for all my development that match whatever the production OS IS.
[2012-05-29 23:44:48 -0400] hoover_damm: it's a gem wrapped around chef-solo to bootstrap OS X
[2012-05-29 23:44:52 -0400] qurve: So in theory it's very easy to just create a 'development' env
[2012-05-29 23:45:09 -0400] qurve: I don't code on my MBP. I keep the code there but it's always executed in a VM.
[2012-05-29 23:45:11 -0400] hoover_damm: Chef is a configuration management 'framework'.  What you manage, and how you manage it
[2012-05-29 23:45:14 -0400] hoover_damm: is up to you
[2012-05-29 23:45:21 -0400] qurve: Yeah, it seems to work perfectly for it.
[2012-05-29 23:45:49 -0400] hoover_damm: more is being added, and really the only limitation is ruby perhaps? and perhaps that isn't a limitation at all
[2012-05-29 23:46:30 -0400] qurve: For this particular project the ruby kind of sucks, since I'm managing a PHP environment.
[2012-05-29 23:46:42 -0400] qurve: All my company's apps are written in rails so it's nothing I don't already need.
[2012-05-29 23:51:44 -0400] hoover_damm: I wonder if not knowing Ruby in 2 years will make you not-hireable
[2012-05-29 23:51:55 -0400] hoover_damm: We need more polyglots
[2012-05-29 23:56:21 -0400] erikh: polyglot can and always will be a bonus skill
[2012-05-29 23:56:45 -0400] erikh: there are more advantages to knowing more languages than just being able to code in them.
