[2012-02-10 09:13:00 -0500] nacer: ohai
[2012-02-10 09:18:00 -0500] renchap: is it a way to tell chef to use 2 addresses as amqp server ?
[2012-02-10 09:18:00 -0500] renchap: (2 nodes of the same rabbitmq cluster)
[2012-02-10 10:04:00 -0500] BryanWB_: ohai chefs!
[2012-02-10 10:24:00 -0500] simon_d: is anyone here using chef knife on mac os x?
[2012-02-10 11:18:00 -0500] BryanWB_: can the deploy resource only deploy from an scm or can it also unpack tarball taken from a url?
[2012-02-10 11:20:00 -0500] ashb: BryanWB_: fairly sure it can do both
[2012-02-10 11:20:00 -0500] BryanWB_: ashb, looks like not
[2012-02-10 11:22:00 -0500] BryanWB_: only providers for it are git and svn
[2012-02-10 11:24:00 -0500] ashb: tbf a lot of what the deploy resource does I don't get
[2012-02-10 11:25:00 -0500] ashb: like why does it check out to one directory, cache that, and then copy it all to somewhere else and then link that to current/ ?
[2012-02-10 11:26:00 -0500] BryanWB_: tbf, that's a great acronym!
[2012-02-10 11:44:00 -0500] tightwork: Anyone able to confirm the state of OpenStack Diablo recipies? Ideally... multinode
[2012-02-10 11:50:00 -0500] BryanWB_: need some recipe naming help, what would u name a recipe that installs the tomcat from the tarball at tomcat.apache.org?
[2012-02-10 11:51:00 -0500] BryanWB_: it is not a package, not source, it holds java bytecode + text config files
[2012-02-10 11:51:00 -0500] BryanWB_: tomcat_bin.rb ? tomcat_binary? or  binary.rb    or source.rb ?
[2012-02-10 12:03:00 -0500] ranjibd: BryanWB_, tomcat::tarball
[2012-02-10 12:03:00 -0500] BryanWB_: ranjibd, hmm, that might work
[2012-02-10 12:03:00 -0500] ranjibd: have you seen the passenger cookbook?
[2012-02-10 12:03:00 -0500] BryanWB_: ranjibd, or should i call it ark like my java_ark lwrp
[2012-02-10 12:03:00 -0500] BryanWB_: ranjibd, i will look passenger
[2012-02-10 12:04:00 -0500] BryanWB_: i didnt make my java_ark resource java_tarball because jtimberman had a good argument for not using it, tho i can't recall it right now
[2012-02-10 12:04:00 -0500] ranjibd: BryanWB_, ark, is it descriptive enough ?
[2012-02-10 12:05:00 -0500] BryanWB_: ranjibd, it isn't , but it is kind of unique
[2012-02-10 12:05:00 -0500] ranjibd: :-)
[2012-02-10 12:05:00 -0500] BryanWB_: naming is hard :(
[2012-02-10 12:11:00 -0500] zefer: I'm getting this error when bootstrapping an EC2 server: "Failed to authenticate ubuntu - trying password auth". My command is "knife ec2 server create -r "role[hydra_proxy]" -I ami-d1a671b8 --flavor m1.small -G hydra_proxy,default -x ubuntu --node-name hydra_proxy1" - Is this a problem with the AMI, or me?!
[2012-02-10 12:12:00 -0500] zefer: The AMI is the official Ubuntu Oneirc i386 instance-store. http://cloud.ubuntu.com/ami/
[2012-02-10 12:12:00 -0500] theozaurus: Hi, just working on a LWRP for creating / retrieving SSL certificates. If they don't already exist I'm trying to generate it on the server and then upload to the data bag. However, I'm getting a "403 Forbidden" when I attempt to save. I assume this is because the client does not have write access to the data bag. How can I give it write access? Is it a good idea to do this?
[2012-02-10 12:15:00 -0500] theozaurus: zefer: It looks to me like the SSH key on the server is not correct.
[2012-02-10 12:15:00 -0500] zts: theozaurus: for the open-source Chef server, only admin clients can write to databags, and giving all of your nodes "admin" access isn't a great idea
[2012-02-10 12:15:00 -0500] zts: if you're using Hosted or Private Chef, you should be able to use the ACLs to allow write access to only some databags (I believe)
[2012-02-10 12:15:00 -0500] theozaurus: zts: I'm on the hosted chef service. Is there any difference?
[2012-02-10 12:15:00 -0500] theozaurus: zts: Beat me to it!
[2012-02-10 12:15:00 -0500] zts: :)
[2012-02-10 12:15:00 -0500] theozaurus: zts: I'll have a play. Thanks
[2012-02-10 12:16:00 -0500] zts: no problem
[2012-02-10 12:17:00 -0500] zts: we've taken a different approach with our SSL certificate cookbook.  Nodes generating certs store them as node attributes, and a separate tool is responsible for collecting them and storing them in databags
[2012-02-10 12:17:00 -0500] zefer: thanks theozaurus. Any ideas what I need to change, to fix it?
[2012-02-10 12:18:00 -0500] zts: (The separate tool is attached to our internal CA, so it's also responsible for signing CSRs generated on the nodes and giving them back certificates to install)
[2012-02-10 12:18:00 -0500] theozaurus: zts: That sounds like an interesting solution. Why did you shy away from having the node put it straight into the databag? Is it around the access control?
[2012-02-10 12:19:00 -0500] theozaurus: Ah okay
[2012-02-10 12:19:00 -0500] theozaurus: zefer: Figure out what key the server is being generated with
[2012-02-10 12:19:00 -0500] zts: theozaurus: yeah, we're using the open-source server so that constraint had a big influence on our design
[2012-02-10 12:20:00 -0500] theozaurus: zefer: Then user ssh ubuntu@YOURSERVER -v to see what key is being used to try and connect. Adjust .ssh/config as necessary
[2012-02-10 12:21:00 -0500] zts: theozaurus: also, we wanted nodes to generate a self-signed cert initially, but also a CSR - so that a CA-signed cert could be installed on a subsequent run.  We needed to have the extra moving part anyway, so we were okay with having a separate tool responsible for updating databags
[2012-02-10 12:21:00 -0500] zefer: theozaurus: Thanks. I'll give that a shot.
[2012-02-10 12:23:00 -0500] theozaurus: zts: Hahah, and there was me feeling clever about generating the self-signed cert on the server
[2012-02-10 12:24:00 -0500] zts: theozaurus: I like to think we were clever too, and it gives me some confidence that you've gone down the same road :)
[2012-02-10 12:24:00 -0500] zts: we do mean to release our work, but that hasn't happened yet
[2012-02-10 12:27:00 -0500] theozaurus: zts: The management for us was becoming a real PITA. With multiple recipes using different ways to access the certs. Then I spotted this ticket: http://tickets.opscode.com/browse/COOK-883 and thought I'd try something out with data bags.
[2012-02-10 12:27:00 -0500] theozaurus: Just tried adding create permissions to our clients, but still no luck :-/
[2012-02-10 12:27:00 -0500] theozaurus: Probably wasn't smart anyway
[2012-02-10 12:28:00 -0500] theozaurus: What I might do is store it in the node like you guys are doing, but the databag is authoritive. So if I want to use a proper SSL cert then upload it to the data bag, however if I just want self signed it'll fall back to the node
[2012-02-10 12:29:00 -0500] zts: yeah, that's basically the approach we take
[2012-02-10 12:30:00 -0500] zts: of course, if you're only concerned with self-signed certs, it's worth asking how important it is that you persist them somewhere
[2012-02-10 12:30:00 -0500] zts: if a node dies and needs to be reprovisioned, does it matter if the new one has a new self-signed cert (even if it's for the same DN)
[2012-02-10 12:32:00 -0500] zts: so perhaps a first pass at COOK-883 could just take care of that case, and then extend that to deal with signed certs from databags as a next step
[2012-02-10 12:37:00 -0500] theozaurus: zts: Yeah that's a good point. I'm just thinking that several services could share the same certificate and use exactly the same mechanism (I'm assuming this isn't against best practice), so storing it in the node makes that convenient.
[2012-02-10 12:40:00 -0500] leifmadsen: morning all!  I've got an issue where a recipe of mine is referencing some files that need to be installed, but the path is a symlink. I get something like, "FileNotFound: cookbook asterisk has no directory files/default/common" -- the common directory definitely exists in files/default/, but 'common' is a symlink. Is there a way to support that?
[2012-02-10 12:40:00 -0500] zts: theozaurus: using the same cert for several services is okay (I believe), although you need to be careful about how you store the key.  It might not be a big deal for self-signed certs, though you probably shouldn't be storing keys for real certs as node attributes
[2012-02-10 12:42:00 -0500] theozaurus: zts: Real certs would be in data bags, although I guess I should use encrypted data bags for that
[2012-02-10 12:43:00 -0500] zts: ah yes, that's fair
[2012-02-10 12:44:00 -0500] theozaurus: Where's the best place to stick up code to get a good critique on it? Is it a good idea to do a pull request when you know your solution is half baked at the moment?
[2012-02-10 12:44:00 -0500] BryanWB_: i didnt make my java_ark resource java_tarball because jtimberman had a good argument for not using it, tho i can't recall it right now
[2012-02-10 12:44:00 -0500] BryanWB_: sorry, accidentally hit enter there
[2012-02-10 12:50:00 -0500] leifmadsen: maybe I can ask my question in a different way; if you have several recipes that share a set of "common" files, how do you manage that single set of files for multiple recipes? It appears I can't (and shouldn't?) symlink from the default/files/ directory, so maybe there is a better way I haven't found yet?
[2012-02-10 12:57:00 -0500] leifmadsen: aha, looks like I may just be looking for the data here: http://wiki.opscode.com/display/chef/Deploy+Resource -- essentially the answer being, "put it into a separate repository and check it out when you go to deploy"
[2012-02-10 13:07:00 -0500] BryanWB_: leifmadsen, u can use the link resource
[2012-02-10 13:08:00 -0500] leifmadsen: BryanWB_: that's to create the link on the node though isn't it?
[2012-02-10 13:08:00 -0500] BryanWB_: leifmadsen, put those files in files/default/foo   and use link resource to make it  asterisk/common/
[2012-02-10 13:08:00 -0500] BryanWB_: but am not sure i entirely understand your issue
[2012-02-10 13:10:00 -0500] leifmadsen: BryanWB_: our recipe is in a git repo, and when I try to install files via the recipe, the files it wants to copy to /etc/asterisk/ are located in a symlink called common/ located within the files/default/ directory of the recipe. It appears I can't use symlinks there as a source file/directory. It appears I should really be using an SCM and pulling those files out of the SCM when I want to use them.
[2012-02-10 13:10:00 -0500] leifmadsen: I ran into this before with chef-solo, but didn't know how to "fix it". It appears using an SCM as the source of those common files is what I should be doing, not symlinking to files located elsewhere in the same repo.
[2012-02-10 13:13:00 -0500] BryanWB_: leifmadsen, i would go the scm way, or just have duplicate copies, or have a tarball of them that u grab and unpack to a given directory using ruby
[2012-02-10 13:14:00 -0500] leifmadsen: ya, it'll be the scm way :)
[2012-02-10 13:14:00 -0500] leifmadsen: the other 2 are bad methods
[2012-02-10 13:14:00 -0500] BryanWB_: i use the tarball method frequently :p
[2012-02-10 13:14:00 -0500] leifmadsen: it's a good thing we reviewed our git repo layout the other day, and the new layout fits nicely with this scm model
[2012-02-10 13:14:00 -0500] leifmadsen: ya, I dislike having code or configs that are not managed or are duplicated in multiple locations
[2012-02-10 13:15:00 -0500] BryanWB_: ah, my tarballs are for 3rd party stuff, like tomcat, the java jdk
[2012-02-10 13:15:00 -0500] leifmadsen: I hate anything duplicated, as I learned when writing books using docbook and subversion
[2012-02-10 13:15:00 -0500] leifmadsen: BryanWB_: ah well that makes sense, yes
[2012-02-10 13:15:00 -0500] leifmadsen: that's someone elses management problem :)
[2012-02-10 14:20:00 -0500] bdha: I really hate CouchDB.
[2012-02-10 14:24:00 -0500] lusis: I like it sometimes
[2012-02-10 14:25:00 -0500] lusis: not in Chef per se
[2012-02-10 14:42:00 -0500] bdha: lusis: It eats itself constantly.
[2012-02-10 14:43:00 -0500] bdha: Where "constantly" is every few months.
[2012-02-10 14:43:00 -0500] bdha: mutter mutter.
[2012-02-10 14:46:00 -0500] lusis: define "eat"
[2012-02-10 14:46:00 -0500] lusis: heh
[2012-02-10 14:48:00 -0500] bdha: lusis: http://dpaste.com/700974/
[2012-02-10 14:48:00 -0500] lusis: ouch
[2012-02-10 14:48:00 -0500] bdha: "The view could not be compacted: missing"
[2012-02-10 14:48:00 -0500] lusis: that's pretty nasty
[2012-02-10 14:48:00 -0500] bdha: lulz
[2012-02-10 14:51:00 -0500] lusis: is that 1.0.1?
[2012-02-10 14:51:00 -0500] bdha: Yeah.
[2012-02-10 14:52:00 -0500] lusis: wow
[2012-02-10 14:53:00 -0500] bdha: Hopefully Chef's MySQL backend support will be seeing the light of day. :\
[2012-02-10 14:55:00 -0500] mattray: bdha: someday
[2012-02-10 14:57:00 -0500] bdha: mattray: http://www.youtube.com/watch?v=wZGFthZLznk
[2012-02-10 14:58:00 -0500] mattray: bdha: :)
[2012-02-10 14:58:00 -0500] mattray: my understanding is Chef 11
[2012-02-10 15:08:00 -0500] jtimberman: bdha: its already seeing the light of day!
[2012-02-10 15:08:00 -0500] jtimberman: .... in hosted chef :)
[2012-02-10 15:11:00 -0500] siezer: lusis
[2012-02-10 15:11:00 -0500] siezer: your tshirt design is killing me
[2012-02-10 15:11:00 -0500] bdha: jtimberman: Yeah, just told me boss I feel like _real_ manager now. I just want to throw money at the problem. :)
[2012-02-10 15:12:00 -0500] lusis: siezer: it wasn't mine!
[2012-02-10 15:12:00 -0500] lusis: I just made the comment
[2012-02-10 15:13:00 -0500] siezer: who made it?
[2012-02-10 15:13:00 -0500] lusis: No one yet. Nathan over at CustomInk offered to make me one for ChefConf
[2012-02-10 15:14:00 -0500] siezer: rock that shit kile a hurricane
[2012-02-10 15:14:00 -0500] siezer: s/kile/like/
[2012-02-10 15:15:00 -0500] siezer: oh wait I use emacs now, I meant M-x replace-string ENTER kile ENTER like
[2012-02-10 15:15:00 -0500] lusis: heh
[2012-02-10 15:16:00 -0500] thom: do they graft on two extra hands when you join opscode?
[2012-02-10 15:16:00 -0500] efilingual: Is there a standard way to get a databag key onto a new node? Do you just ssh it up manually, or is there a way to automate copying it from the workstation to the nodes?
[2012-02-10 15:16:00 -0500] efilingual: a standard practice I mean
[2012-02-10 15:17:00 -0500] lusis: the bootstrap templates will copy it
[2012-02-10 15:17:00 -0500] lusis: but I store mine at a url
[2012-02-10 15:17:00 -0500] lusis: well
[2012-02-10 15:18:00 -0500] lusis: I use an http path instead of a file path
[2012-02-10 15:18:00 -0500] siezer: yes. they do.
[2012-02-10 15:23:00 -0500] jtimberman: thom: Vibram 5 fingers are standard issue.
[2012-02-10 15:24:00 -0500] jtimberman: https://twitter.com/#!/jtimberman/status/167836428250779648
[2012-02-10 15:24:00 -0500] efilingual: lusis: Oh I think I see, you mean the encrypted_data_bag_secret setting? Thanks.
[2012-02-10 15:24:00 -0500] lusis: efilingual: yep
[2012-02-10 15:31:00 -0500] ssd7: Ohai Chefs
[2012-02-10 15:32:00 -0500] yfeldblum: ohai ssd7
[2012-02-10 15:35:00 -0500] flashmanbahadur: has anyone else with hosted chef had a problem today where you get 401 unauthorized errors when trying to register a new node during bootstrapping?
[2012-02-10 15:36:00 -0500] jtimberman: flashmanbahadur: did someone regenerate your validation client?
[2012-02-10 15:37:00 -0500] flashmanbahadur: ill check
[2012-02-10 15:37:00 -0500] flashmanbahadur: but not as far as I know
[2012-02-10 15:37:00 -0500] Brad_K: flashmanbahadur: the only time i recall getting that error was when i had munged the validation key or accidentally deleted the special validation client.
[2012-02-10 15:37:00 -0500] flashmanbahadur: hmm, strange, Ill check in to it.
[2012-02-10 15:37:00 -0500] flashmanbahadur: thanks
[2012-02-10 15:37:00 -0500] Brad_K: or, when i was in the wrong directory when doing knife commands and it couldn't find the right knife.rb which had the necessary keys, etc defined.
[2012-02-10 15:38:00 -0500] jtimberman: Brad_K: i never do that
[2012-02-10 15:38:00 -0500] jtimberman: :)
[2012-02-10 15:41:00 -0500] ssd7: flashmanbahadur: There are a number of cuases for 401s.  Is it definitely your validator client getting 401d or is the new client getting a 401 right after creation?  An easy way to check if you have the right validator key from your local workstation is: knife client list -k .chef/ORGNAME-valiator.pem -u ORGNAME-validator
[2012-02-10 15:42:00 -0500] ssd7: Fixing typos is left as an exercise for the reader. :(
[2012-02-10 15:42:00 -0500] flashmanbahadur: haha
[2012-02-10 15:48:00 -0500] flashmanbahadur: very weird, getting the same thing across my staging and production accounts
[2012-02-10 15:53:00 -0500] flashmanbahadur: i am able to list clients/nodes etc using my knife config which specifies those key files
[2012-02-10 15:53:00 -0500] flashmanbahadur: but on new nodes it fails as soon as it attempts to register itself
[2012-02-10 15:55:00 -0500] flashmanbahadur: existing nodes are able to connect
[2012-02-10 15:56:00 -0500] flashmanbahadur: will do on a new node
[2012-02-10 15:56:00 -0500] jtimberman: lol
[2012-02-10 15:56:00 -0500] jtimberman: !botsnack
[2012-02-10 15:56:00 -0500] bawt: jtimberman: =D
[2012-02-10 15:56:00 -0500] jtimberman: i love when bawt gives an actually helpful answer :)
[2012-02-10 15:56:00 -0500] ssd7: flashmanbahadur: mind running with -l debug and posting the meat of the chef-client run somehwere?
[2012-02-10 15:56:00 -0500] flashmanbahadur: chef-client -l debug   ?
[2012-02-10 15:56:00 -0500] bawt: chef-client -l debug is usually more help
[2012-02-10 15:56:00 -0500] flashmanbahadur: ok
[2012-02-10 16:02:00 -0500] ssd7: flashmanbahadur: I am headed out soon and will be offline for a bit.  If someone here can't spot something from the log, feel free to email support@opscode.com or open a ticket on help.opscode.com.
[2012-02-10 16:02:00 -0500] flashmanbahadur: thanks
[2012-02-10 16:02:00 -0500] flashmanbahadur: Im guessing its just something stupid, just not coming to mind since it was fine yesterday and not today
[2012-02-10 16:03:00 -0500] flashmanbahadur: http://pastie.org/private/byyt4ycup0hgsgi73bn3w
[2012-02-10 16:05:00 -0500] flashmanbahadur: my creation script just sets the params for `knife ec2 server create` picking an appropriate account/key for setting it up
[2012-02-10 16:05:00 -0500] Brad_K: that definitely looks like a munged validator, or the wrong validator.  are you sure that my_company_name_staging-validator is correct on both sides?
[2012-02-10 16:08:00 -0500] flashmanbahadur: so /etc/chef/validation.pem is the same on my new 'failing' servers as an existing working server, and is the same as my local my_company_name_staging-validator
[2012-02-10 16:10:00 -0500] AntonZ: Hello, any chance someone can help me clarify a few points with this guide: http://blog.ibd.com/scalable-deployment/using-the-opscode-aws-cookbook-to-attach-an-ec2-ebs-volume/
[2012-02-10 16:11:00 -0500] Brad_K: flashmanbahadur: can you log into the webui and compare the validator client contents?
[2012-02-10 16:11:00 -0500] flashmanbahadur: After launching the server when I look at the node list I do not see it, should it only appear after it registers itself?
[2012-02-10 16:11:00 -0500] flashmanbahadur: Brad_K: sure
[2012-02-10 16:12:00 -0500] Brad_K: the client.pem will only show up once the client has authenticated itself to the server.  but the validator.pem should be there to being with, and should match what is on the server side.
[2012-02-10 16:13:00 -0500] flashmanbahadur: sec trying to navigate the managemnet console, dont spend much time here
[2012-02-10 16:13:00 -0500] Brad_K: once the server has authenticated itself, you don't need the validation.pem file on the client any more.  in fact, i believe that it is best practice to go ahead and remove it once the client.pem has been created.
[2012-02-10 16:14:00 -0500] flashmanbahadur: interesting
[2012-02-10 16:14:00 -0500] flashmanbahadur: good to know
[2012-02-10 16:15:00 -0500] Brad_K: i'm sure that mattray or one of the other more experienced chefs will correct me, if i'm wrong.
[2012-02-10 16:16:00 -0500] jtimberman: Brad_K: correct. we have chef-client::delete_validation recipe for exactly that purpose
[2012-02-10 16:17:00 -0500] kallistec: plu: I understand your concern, and we'll definitely consider it when we look at how the resource cloning might be redesigned
[2012-02-10 16:17:00 -0500] atomic-penguin: deleting the validation on the chef-server however, will cause a new validation key to be generated
[2012-02-10 16:17:00 -0500] Brad_K: AntonZ: unfortunately, i don't use Amazon, so i can't speak for how EC2, etc work.
[2012-02-10 16:18:00 -0500] kallistec: plu: for the near and medium term, we can't change it too much, because notifications depend on looking up resources by type+name
[2012-02-10 16:22:00 -0500] AntonZ: Brad, thanks, i had rather generic chef questions, i wanted to see where should i be putting those bits of code, for example the guide says to put first piece of code to role file, where does role file go? i have the following structure: Cookbook folder -> metadata.json file in the root; recipes folder
[2012-02-10 16:22:00 -0500] flashmanbahadur: Brad_K:  cant seem to find where in the web ui where I could compare the validator client contents, all I can see is where to regenerate, or look at the public key
[2012-02-10 16:23:00 -0500] Brad_K: flashmanbahadur: hmm.  it doesn't give you a download link?
[2012-02-10 16:23:00 -0500] Urocyon: AntonZ, in my repository I keep my roles in a separate directory from my cookbook.  in ~/chef/roles
[2012-02-10 16:23:00 -0500] flashmanbahadur: Brad_K: Where would I find that, not seeing it
[2012-02-10 16:24:00 -0500] Brad_K: AntonZ: on my chef workstation, i've also got a "roles" directory that is at the same level as "cookbooks", and that's where i store all my roles.  i also have "data_bags" and "environments" at that same level.
[2012-02-10 16:26:00 -0500] AntonZ: interesting, i thought roles folder should be within the same folder as the cookbook you are using it with
[2012-02-10 16:26:00 -0500] Brad_K: flashmanbahadur: hmm.  okay, i'm not seeing a download link, either.  i may have steered you wrong.  ;-(
[2012-02-10 16:26:00 -0500] Urocyon: AntonZ: if you are running chef-solo, you tell it where you keep your roles. See roles section at http://wiki.opscode.com/display/chef/Chef+Solo#ChefSolo-Roles
[2012-02-10 16:27:00 -0500] Brad_K: AntonZ: the roles i've used have sometimes crossed boundaries across multiple cookbooks, so i wouldn't want to store them in the same directory.
[2012-02-10 16:27:00 -0500] Urocyon: AntonZ: if you are using chef server, then your roles are really on your server.  I just collect mine together in my repo in one directory.
[2012-02-10 16:28:00 -0500] Urocyon: AntonZ: and like brad, my roles, generally include multiple cookbooks in their run lists, so keeping them separate makes more sense to me.   To me they are about server roles, not cookbook roles.
[2012-02-10 16:29:00 -0500] AntonZ: from the guide i posted earlier it sounds like my role folder has to be on the same level as cookbooks as it has erefrences to multiple cookbooks
[2012-02-10 16:29:00 -0500] AntonZ: http://blog.ibd.com/scalable-deployment/using-the-opscode-aws-cookbook-to-attach-an-ec2-ebs-volume/
[2012-02-10 16:31:00 -0500] Brad_K: AntonZ: a roles subdirectory is not a standard subdirectory normally created for a chef cookbook.  you can create one if you want, but doing a "knife cookbook create" won't create one for you.
[2012-02-10 16:33:00 -0500] Brad_K: AntonZ: if you look at the management interface for your account, you should see a number of tabs across the top of the screen, named "Environments", "Search", "Status", "Roles", "Nodes", "Cookbooks", "Data bags", "Clients", "Groups", and "Users".  Now, not all those same categories make sense in a chef repo, but several of them do  and it makes sense to create them in largely the same manner of organization.  so, "Roles" would be a directory that is
[2012-02-10 16:33:00 -0500] yfeldblum: AntonZ, roles should reference cookbooks & recipes; cookbooks & recipes should not have roles, should not know about roles, should not define roles, should not expect roles
[2012-02-10 16:34:00 -0500] AntonZ: gotcha, good explanation!
[2012-02-10 16:34:00 -0500] AntonZ: Thanks
[2012-02-10 16:35:00 -0500] flashmanbahadur: Hey, if for some reason my validator keys are now bad, regenerating them should not break any existing machines because they already have their client keys right?
[2012-02-10 16:35:00 -0500] flashmanbahadur: or will those be invalidated as well?
[2012-02-10 16:35:00 -0500] BArry: Hi. Im trying to use the application cookbook, but have created my own cookbook in order to try and use an encrypted databag for passwords. It looks like this http://pastie.org/3355486, but the ['databases']['production']['password'] value is blank during the chef run. Can someone help a noob?
[2012-02-10 16:35:00 -0500] Brad_K: flashmanbahadur: correct.  you can regenerate your validator key without breaking any existing clients.  been there, done that.
[2012-02-10 16:36:00 -0500] flashmanbahadur: Brad_K: alright, I guess I will have to try that since it seems to be hosed for some reason
[2012-02-10 16:36:00 -0500] flashmanbahadur: very strange
[2012-02-10 16:36:00 -0500] Brad_K: now, whatever you do, make sure that you DO NOT EVER DELETE THE SPECIAL CLIENT THAT WAS CREATED TO HOLD THE VALIDATION KEY.  that way lies much pain.  trust me.
[2012-02-10 16:36:00 -0500] |shad0w|: did you check the time on the server and client?
[2012-02-10 16:37:00 -0500] jtimberman: Brad_K: eh.. its not that bad :)
[2012-02-10 16:37:00 -0500] flashmanbahadur: |shad0w|: using hosted chef, so hard for me to check theirs, my side is a fresh EC2 11.10 Ubuntu AMI
[2012-02-10 16:37:00 -0500] |shad0w|: ah
[2012-02-10 16:37:00 -0500] flashmanbahadur: but ill check for sanity on my end
[2012-02-10 16:38:00 -0500] savant: hi all
[2012-02-10 16:38:00 -0500] savant: do I get access to the node attributes when setting default attributes?
[2012-02-10 16:38:00 -0500] savant: for example, if I set node[:box_name], can I use that value in attributes/default.rb
[2012-02-10 16:39:00 -0500] flashmanbahadur: Brad_K: what do you mean by the special client
[2012-02-10 16:39:00 -0500] jtimberman: savant: you *can* but you probably shouldn't
[2012-02-10 16:40:00 -0500] Brad_K: when you do a "knife client list", one of the clients that shows up will be your "validator" client.  it will have the same name as your validator key.
[2012-02-10 16:40:00 -0500] jtimberman: savant: that is, don't use attributes that might come from another cookbook
[2012-02-10 16:40:00 -0500] flashmanbahadur: Brad_K: because I did some stale client cleanup yesterday, which seems suspiciously like what you siad not to do
[2012-02-10 16:40:00 -0500] jtimberman: or that might be calculated
[2012-02-10 16:40:00 -0500] jtimberman: if they're node attributes from ohai, thats cool
[2012-02-10 16:40:00 -0500] Brad_K: flashmanbahadur: yeah, stale client cleanup is what bit me, too.
[2012-02-10 16:40:00 -0500] flashmanbahadur: Brad_K: good to know, at least I know what I have to do now, thanks
[2012-02-10 16:40:00 -0500] savant: jtimberman: these are basically stuff like "is this box staging or production?" since im using chef-solo
[2012-02-10 16:40:00 -0500] flashmanbahadur: at least it wasnt a real bug, and just my stupidity
[2012-02-10 16:41:00 -0500] savant: i just set that in the dna.json/role.json (whenever I have time to futz with roles again that is)
[2012-02-10 16:41:00 -0500] jtimberman: ah
[2012-02-10 16:41:00 -0500] jtimberman: i mean, if you know the values will be available, rock it
[2012-02-10 16:41:00 -0500] savant: yeah
[2012-02-10 16:41:00 -0500] savant: every node has a box_name, it's identifier
[2012-02-10 16:42:00 -0500] savant: basically the group name, with some extra data as to where it is in the datacenter.
[2012-02-10 16:46:00 -0500] flashmanbahadur: yfeldblum: Is there a special reason that the validation key isnt automatically deleted after a successful client registration?
[2012-02-10 16:50:00 -0500] tolland_: are there recomendations for managing the attributes, via some sort of integration with other systems with some dash board
[2012-02-10 16:56:00 -0500] yfeldblum: flashmanbahadur, because a successful client registration isn't supposed to delete it; it's placed there by the admin (or by the bootstrap process initiated by the admin) and it's deleted by the admin (or, if the admin decides to delete it in a recipe, it's deleted in a recipe)
[2012-02-10 16:56:00 -0500] flashmanbahadur: yfeldblum: fair enough
[2012-02-10 16:57:00 -0500] yfeldblum: flashmanbahadur, i believe the recipe you're looking for is here: https://github.com/opscode/cookbooks/blob/master/chef-client/recipes/delete_validation.rb
[2012-02-10 16:57:00 -0500] slyphon: argh, defaults are not merging grrr...
[2012-02-10 16:57:00 -0500] flashmanbahadur: thanks yfeldblum
[2012-02-10 16:57:00 -0500] flashmanbahadur: Having an issue regenerating my validation key
[2012-02-10 16:58:00 -0500] flashmanbahadur: nm, found a blog post on it
[2012-02-10 17:00:00 -0500] BArry: You dont need to explicitly do anything in a recipe to get files in the attributes directory of a cookbook to load do you?
[2012-02-10 17:04:00 -0500] cap10morgan: who would be a good person to answer a question about chef conf? i didn't see any links or emails on the site.
[2012-02-10 17:06:00 -0500] flashmanbahadur: is it even possible to add the create/list permissions to a client in the management console, not seeing any way to do that
[2012-02-10 17:06:00 -0500] yfeldblum: flashmanbahadur, not with oss-chef-server, only with hosted-chef
[2012-02-10 17:07:00 -0500] flashmanbahadur: thats what I am using
[2012-02-10 17:08:00 -0500] yfeldblum: flashmanbahadur, if you really really want that, you bug opscode, or you can build a separate mgmt interface & put a client-authorizing proxy in front of the oss-chef-server
[2012-02-10 17:08:00 -0500] flashmanbahadur: sorry yfeldblum I mean I am on hosted chef,
[2012-02-10 17:09:00 -0500] jtimberman: cap10morgan: chefconf.opscode.com ?
[2012-02-10 17:09:00 -0500] yfeldblum: flashmanbahadur, ah
[2012-02-10 17:09:00 -0500] cap10morgan: jtimberman: looked there, didn't see any info about who to contact w/ questions. did i not look hard enough? :)
[2012-02-10 17:09:00 -0500] yfeldblum: flashmanbahadur, ah
[2012-02-10 17:09:00 -0500] flashmanbahadur: I see
[2012-02-10 17:10:00 -0500] flashmanbahadur: I have to change my env to "None"
[2012-02-10 17:10:00 -0500] cap10morgan: jtimberman: maybe marketing@opscode.com ?
[2012-02-10 17:12:00 -0500] jtimberman: cap10morgan: chefconf@opscode.com
[2012-02-10 17:12:00 -0500] jtimberman: :)
[2012-02-10 17:12:00 -0500] cap10morgan: ah, great. thanks jtimberman
[2012-02-10 17:12:00 -0500] flashmanbahadur: awesome, works now
[2012-02-10 17:12:00 -0500] flashmanbahadur: thanks for the help everyone
[2012-02-10 17:43:00 -0500] BArry: Is it possible to nest encrypted databag items, e.g. databases['production']['password']: 'pwd' ?
[2012-02-10 17:44:00 -0500] JasonBoxLaptop: Doesn't it encrypt the entire data_bag anyway?
[2012-02-10 17:46:00 -0500] JasonBoxLaptop: wow, no ifconfig in arch linux
[2012-02-10 17:46:00 -0500] BArry: JasonBoxLaptop: Sorry. Hangon. I was being extra dumb I think...
[2012-02-10 17:47:00 -0500] spicyWith: jtimberman or coderanger, you around? There's seems to be a problem with gunicorn. In the out of the box setting the worker threads are dying and respawning constantly. Not sure what's wrong, maybe not finding the settings file?
[2012-02-10 17:48:00 -0500] miah: moin
[2012-02-10 17:48:00 -0500] miah: JasonBoxLaptop: use 'ip', else you can install ifconfig
[2012-02-10 17:48:00 -0500] miah: its funny how 95% of the linux user base doesn't realize that ifconfig has been deprecated for the past 10 years
[2012-02-10 17:49:00 -0500] JasonBoxLaptop: Yeah, I use `ip` on occasion
[2012-02-10 17:49:00 -0500] JasonBoxLaptop: miah: Probably because it seems foundational
[2012-02-10 17:49:00 -0500] JasonBoxLaptop: It's like suddenly finding out `df` is deprecated
[2012-02-10 17:49:00 -0500] miah: ya
[2012-02-10 17:49:00 -0500] JasonBoxLaptop: Or `fdisk`
[2012-02-10 17:49:00 -0500] miah: also because other os's use ifconfig still
[2012-02-10 17:50:00 -0500] miah: ip is more functional though
[2012-02-10 17:50:00 -0500] JasonBoxLaptop: But I like `ip`, so it's all good
[2012-02-10 17:50:00 -0500] yfeldblum: or 2.6 isn't the latest anymore
[2012-02-10 17:50:00 -0500] miah: dude i just installed 2.0.26
[2012-02-10 17:50:00 -0500] miah: WTF
[2012-02-10 17:50:00 -0500] JasonBoxLaptop: whut, of?
[2012-02-10 17:50:00 -0500] miah: linux kernel!
[2012-02-10 17:50:00 -0500] JasonBoxLaptop: Oh, congratulations?
[2012-02-10 17:50:00 -0500] miah: i was making a joke
[2012-02-10 17:50:00 -0500] JasonBoxLaptop: Oh ;)
[2012-02-10 17:50:00 -0500] ranjibd: miah, strange its been marked as obsolete in fedora  man pages , but no mention in rel or centos
[2012-02-10 17:51:00 -0500] JasonBoxLaptop: ranjibd: There's an entire thread as part of the new ohai release where it was mentioned
[2012-02-10 17:51:00 -0500] miah: http://en.wikipedia.org/wiki/Ifconfig#Current_status
[2012-02-10 17:51:00 -0500] JasonBoxLaptop: Amazing what I learn on chef list
[2012-02-10 17:52:00 -0500] JasonBoxLaptop: Tomorrow, I expect to learn the world is round!
[2012-02-10 17:52:00 -0500] yfeldblum: according to the latest greek science, the sky is a sphere and debts can continue on indefinitely
[2012-02-10 17:53:00 -0500] miah: not only is the earth round, but its hollow and there is another world inside!
[2012-02-10 17:54:00 -0500] miah: http://en.wikipedia.org/wiki/Hollow_Earth
[2012-02-10 17:55:00 -0500] ranjibd: JasonBoxLaptop, yeah just went through that.. its very informative
[2012-02-10 17:56:00 -0500] JasonBoxLaptop: Yeah, it is indeed!
[2012-02-10 17:56:00 -0500] ranjibd: what earth.. there are worm holes man... and you can teleport through them ..
[2012-02-10 17:56:00 -0500] JasonBoxLaptop: heh
[2012-02-10 17:56:00 -0500] miah: yes, but only if you have the subtle knife or can locate a tear
[2012-02-10 17:57:00 -0500] tightwork: broccoli
[2012-02-10 17:57:00 -0500] miah: broccoli is delicious
[2012-02-10 18:00:00 -0500] jschneiderhan: hi everyone - i'm trying to figure out how to setup multiple workstations within my dev team - i'm wondering if what I say here is on the right track http://jschneiderhan.posterous.com/multiple-developers-one-chef-server
[2012-02-10 18:01:00 -0500] jschneiderhan: if not i definitely want to update the post to help anyone searching in the future (either a better solution in the post or links to a better solution)
[2012-02-10 18:02:00 -0500] tightwork: Is your team using cook books based from a git repo? I'd start there
[2012-02-10 18:03:00 -0500] tightwork: you could post hook a git commit to knife upload? I could be talking out loud here
[2012-02-10 18:05:00 -0500] jschneiderhan: yes - we're using a git repo
[2012-02-10 18:05:00 -0500] jschneiderhan: i'm thinking each team member uses vagrant locally, or a separate AWS account
[2012-02-10 18:06:00 -0500] jschneiderhan: then uses chef to setup their own private nodes, and since they are in different organizations their search results only return their nodes
[2012-02-10 18:06:00 -0500] jschneiderhan: and they re free to update their cookbooks while they are still mid-development without screwing up everyone else's environments
[2012-02-10 18:07:00 -0500] tightwork: ah, yeah prob orgs is key.. could be how hosted chef is working
[2012-02-10 18:12:00 -0500] jschneiderhan: cool, thanks for taking a look tight work - wanted to make sure i wasn't totally off base before posting something publicly
[2012-02-10 18:14:00 -0500] yfeldblum: always assume you're totally off-base: when you turn out to be on-base, you will be pleasantly surprised, and when others correct you, you will be pleasantly surprised by learning interesting new things
[2012-02-10 18:15:00 -0500] yfeldblum: that applies only to things you are exploring, of course, not necessarily things that you have already grasped deeply
[2012-02-10 18:17:00 -0500] l1x: hey folks, where can i store a cookbook variable what i would like to reference in every recipe in that cookbook
[2012-02-10 18:20:00 -0500] miah: default attributes
[2012-02-10 18:20:00 -0500] miah: attributes?
[2012-02-10 18:20:00 -0500] bawt: attributes is http://wiki.opscode.com/display/chef/Attributes
[2012-02-10 18:20:00 -0500] Brad_K: jschneiderhan: one thing you can do is to explicitly freeze cookbooks on upload, which will prevent anyone else from being able to upload the same version of the same cookbook, at least not without going through some pain.  then you can specify certain frozen cookbook versions for your environments.  the "spork" plugin for knife helps a lot in cases like this.
[2012-02-10 18:21:00 -0500] miah: i version pin cookbooks in environments
[2012-02-10 18:22:00 -0500] Brad_K: we're not big enough yet to need different organizations for each developer.  but we might have to go that way at some point in the future.  for now, we're freezing cookbooks when they're ready to move up to production, and then using only specific versions of specific cookbooks in production.
[2012-02-10 18:22:00 -0500] miah: i feel like 'freeze' doesnt stick. so once you do upload a new version of the cookbook you have to freeze it again
[2012-02-10 18:22:00 -0500] Brad_K: that version is frozen.  if you upload a new version, then it would have to be frozen again, that's true.
[2012-02-10 18:22:00 -0500] miah: ya, i kinda hate that
[2012-02-10 18:22:00 -0500] bdha: Heh.. so the solaris2/filesystem.rb ohai provider does a zfs get all (I've mentioned this before).
[2012-02-10 18:23:00 -0500] bdha: I had something like 30k snaps at some point. And it was grabbing them from both global and non-global zones.
[2012-02-10 18:23:00 -0500] miah: awesome
[2012-02-10 18:23:00 -0500] bdha: After a lot of chickenblood, I managed to delete the three nodes with the most snapshots.
[2012-02-10 18:23:00 -0500] bdha: My CouchDB went from 80MB to 40MB.
[2012-02-10 18:26:00 -0500] miah: wow
[2012-02-10 18:27:00 -0500] spicyWith: anyone here use gunicorn?
[2012-02-10 18:27:00 -0500] jschneiderhan: Brad_K - thanks for the info on cookbook freezing - how do you ensure that search results only include the appropriate nodes
[2012-02-10 18:27:00 -0500] jschneiderhan: are all devs working on the same set of machines when developing cookbooks?
[2012-02-10 18:30:00 -0500] savant: is there an example somewhere on using ohai within chef?
[2012-02-10 18:30:00 -0500] savant: like, do I have to create an ohai object?
[2012-02-10 18:30:00 -0500] savant: or is there a global object somewhere?
[2012-02-10 18:31:00 -0500] bdha: savant: node[:foo][:bar], generally, unless you mean something more than using ohai attributes.
[2012-02-10 18:32:00 -0500] savant: so I want to see what version of ubuntu is installed on an instance
[2012-02-10 18:32:00 -0500] savant: which is available as o.platform_version when creating a new Ohai::System object in irb
[2012-02-10 18:32:00 -0500] savant: would that be populated somewhere?
[2012-02-10 18:33:00 -0500] jtimberman: savant: node['platform_version']
[2012-02-10 18:34:00 -0500] spicyWith: jtimberman: any knowledge of the gunicorn cookbook or should I be looking for coderanger
[2012-02-10 18:34:00 -0500] spicyWith: ?
[2012-02-10 18:34:00 -0500] jtimberman: spicyWith: i have not worked directly w/ gunicorn
[2012-02-10 18:34:00 -0500] bdha: jtimberman: CouchDB-- (ohai zfs)--
[2012-02-10 18:34:00 -0500] savant: ah cool
[2012-02-10 18:34:00 -0500] savant: thanks
[2012-02-10 18:35:00 -0500] jtimberman: bdha: wot?
[2012-02-10 18:35:00 -0500] jtimberman: bdha: using zfs tomfoolery to manage replication and whatnot for couch?
[2012-02-10 18:35:00 -0500] jtimberman: seems useful :)
[2012-02-10 18:36:00 -0500] bdha: jtimberman: No.
[2012-02-10 18:36:00 -0500] bdha: jtimberman: The ohai "zfs get all" bug when you have many snapshots.
[2012-02-10 18:37:00 -0500] bdha: Like, say, 100k across all the hosts Chef is managing.
[2012-02-10 18:37:00 -0500] bdha: Eventually CouchDB falls over.
[2012-02-10 18:37:00 -0500] coderanger: spicyWith: That cookbook does almost nothing, not sure what your question is
[2012-02-10 18:37:00 -0500] coderanger: gunicorn has sane defaults for all settings
[2012-02-10 18:37:00 -0500] jtimberman: bdha: oooh...
[2012-02-10 18:37:00 -0500] jtimberman: bdha: stop that
[2012-02-10 18:37:00 -0500] spicyWith: I'm using the application cookbook that sets up gunicorn for you. The workers are dying and respawning constantly
[2012-02-10 18:37:00 -0500] jtimberman: :D
[2012-02-10 18:37:00 -0500] spicyWith: ^^ coderanger
[2012-02-10 18:38:00 -0500] jtimberman: bdha: i think we had a conversation about this before though
[2012-02-10 18:38:00 -0500] coderanger: spicyWith: I'm just saying thats probably an issue with gunicorn, not with the cookbook :)
[2012-02-10 18:38:00 -0500] bdha: jtimberman: The next time I see you I'm going to stick dried monkey penises through your ear studs. :)
[2012-02-10 18:38:00 -0500] bdha: jtimberman: Yeah, pretty sure. I think I let it drop due to lack of cycles.
[2012-02-10 18:38:00 -0500] bdha: Need to make a bug.
[2012-02-10 18:39:00 -0500] bdha: I ran into someone else using "zfs get all" incorrectly recently...
[2012-02-10 18:39:00 -0500] bdha: oh. SmartOS. vmadm's VM.js.
[2012-02-10 18:39:00 -0500] bdha: Everyone loves ZFS but no one seems to actually _use_ it. ;-)
[2012-02-10 18:40:00 -0500] spicyWith: coderanger: probably. What is the cookbook using to keep gunicorn alive sv? Given that the cookbook sets up a /etc/gunicorn/projecname.py config file, I'm not sure how it's specifying where the django settings file is, and I fear it's not finding it. Here's what the log is saying: http://pastebin.com/XmiGyjsF
[2012-02-10 18:41:00 -0500] l1x: bawt: miah thx
[2012-02-10 18:41:00 -0500] l1x: bdha: this is not true about zfs
[2012-02-10 18:42:00 -0500] coderanger: spicyWith: Yeah, runit https://github.com/opscode/cookbooks/blob/master/application/recipes/gunicorn.rb#L42
[2012-02-10 18:42:00 -0500] l1x: i know entire corporations running only on zfs
[2012-02-10 18:42:00 -0500] spicyWith: turning up the log level, was using the wrong flag...
[2012-02-10 18:43:00 -0500] bdha: l1x: I was being facetious.
[2012-02-10 18:43:00 -0500] bdha: l1x: I run the illumos.org infrastructure.
[2012-02-10 18:43:00 -0500] l1x: i know :)
[2012-02-10 18:43:00 -0500] l1x: wooot
[2012-02-10 18:43:00 -0500] bdha: Heh.
[2012-02-10 18:43:00 -0500] l1x: wow
[2012-02-10 18:44:00 -0500] l1x: i have met with few of you in LA at Scale
[2012-02-10 18:44:00 -0500] siezer: ohai
[2012-02-10 18:44:00 -0500] siezer: that would have been mattray and I
[2012-02-10 18:44:00 -0500] spicyWith: coderanger: gotta go to a meeting, but will you be here later? I'll keep trying stuff
[2012-02-10 18:45:00 -0500] l1x: och btw. zfs, the linux community just released a laughable doc about brtfs https://db.usenix.org/publications/login/2012-02/openpdfs/Bacik.pdf
[2012-02-10 18:45:00 -0500] l1x: i could not stop laughing for an hour
[2012-02-10 18:45:00 -0500] bdha: uh oh.
[2012-02-10 18:45:00 -0500] bdha: l1x: Yeah, fair number of illumos folks at SCALE this year. A few talks. :)
[2012-02-10 18:45:00 -0500] bdha: rm's talk was especially good.
[2012-02-10 18:46:00 -0500] l1x: i haven't seen that one, unfortunately my employer is using linux only
[2012-02-10 18:48:00 -0500] bdha: l1x: http://smartos.org/2012/01/24/using-smartos-as-a-hypervisor/
[2012-02-10 18:49:00 -0500] bdha: bdha: bmc's "Fork Year!" is also required viewing. :)
[2012-02-10 18:49:00 -0500] l1x: thanks
[2012-02-10 18:49:00 -0500] bdha: er, "Fork Yeah!" rather.
[2012-02-10 18:49:00 -0500] l1x: bdha: do you know any good hybrid cloud solution?
[2012-02-10 18:49:00 -0500] bdha: http://smartos.org/2011/12/15/fork-yeah-the-rise-and-development-of-illumos-2/
[2012-02-10 18:49:00 -0500] l1x: we need something inhouse
[2012-02-10 18:49:00 -0500] bdha: l1x: I'm deploying SmartDatacenter from Joyent.
[2012-02-10 18:49:00 -0500] l1x: so what is that
[2012-02-10 18:49:00 -0500] bdha: If not, I'd have built something with SmartOS.
[2012-02-10 18:49:00 -0500] l1x: i need to read up on that
[2012-02-10 18:50:00 -0500] Mithrandir: I love how people talk about "the linux community" as if it's anywhere near a cohesive entity. :-P
[2012-02-10 18:50:00 -0500] bdha: Heh.
[2012-02-10 18:50:00 -0500] bdha: Amorphous doom!
[2012-02-10 18:51:00 -0500] miah: Mithrandir: it is!
[2012-02-10 18:52:00 -0500] Mithrandir: miah: you're either trolling, misinformed or trying to be funny. :-)
[2012-02-10 18:52:00 -0500] l1x: ahahah
[2012-02-10 18:52:00 -0500] Brad_K: jschneiderhan: sorry, i was afk.  at this point, if a node is in our staging environment, then all searches that are across all environments, and all searches that are specifically limited to the staging environment, would show that node.  same with all our other environments.  we do not have any nodes in any environment that we would want to hide from any other nodes in that same environment.
[2012-02-10 18:52:00 -0500] l1x: bdha: is there any technical detail about this smart datacenter? how are you deploying it?
[2012-02-10 18:53:00 -0500] miah: Mithrandir: yes!
[2012-02-10 18:53:00 -0500] bdha: l1x: http://sdcdoc.joyent.com/sdcdoc/display/sdc/SmartDataCenter+Home
[2012-02-10 18:53:00 -0500] bdha: l1x: rm's talk will explain most of it.
[2012-02-10 18:53:00 -0500] bdha: The technical bits.
[2012-02-10 18:53:00 -0500] bdha: The other pieces are accounting, billing, quotas, etc.
[2012-02-10 18:55:00 -0500] jschneiderhan: Brad_K ok i see - i'm trying to get things setup so that each dev has their own mini environment (i.e. vagrant or separate AWS accounts), and each dev will be using the same "development" chef environment
[2012-02-10 18:56:00 -0500] jschneiderhan: it may be overkill, but it seems like a good idea to have the developer workstations configured with chef
[2012-02-10 18:56:00 -0500] jschneiderhan: makes getting a new hire up and running that much easier
[2012-02-10 18:58:00 -0500] jschneiderhan: so the problem with using a single organization (in my use case) is that if a developer searches for nodes within a particular role they would get all the nodes in the development environment, which would include nodes located on the other devs machines
[2012-02-10 18:58:00 -0500] jschneiderhan: so i'm thinking separate organizations may help isolate the different devs nodes
[2012-02-10 18:58:00 -0500] jschneiderhan: *i'm sure I'm way over thinking this*
[2012-02-10 18:58:00 -0500] jbz: jschneiderhan: Can you use Environments for each dev?
[2012-02-10 18:59:00 -0500] jschneiderhan: i could but that would lead to duplication of all the environment specific attributes and run lists, wouldn't it
[2012-02-10 18:59:00 -0500] jbz: jschneiderhan: We use separate orgs for a different reason, but I'm here to say the effort involved and the resulting complexity make it something to be avoided if possible given the current state of the tools.
[2012-02-10 18:59:00 -0500] l1x: bdha: thanks
[2012-02-10 18:59:00 -0500] jbz: jschneiderhan: Hm.  True.
[2012-02-10 19:00:00 -0500] jschneiderhan: jbz agreed, although it seams like it solves my problem I can't help but feel that I may be overlooking a simpler approach
[2012-02-10 19:00:00 -0500] jbz: Can you find another attribute to tag nodes with and issue a 'Thou Shalt Always' command for devs to use it when searching?
[2012-02-10 19:00:00 -0500] jschneiderhan: jbz and using organizations for something they were not intended for
[2012-02-10 19:00:00 -0500] jschneiderhan: jbz that's an interesting idea
[2012-02-10 19:01:00 -0500] jbz: We use multiple orgs because we need to tell regulatory auditors that developers *cannot* access running production nodes with client data on them
[2012-02-10 19:02:00 -0500] jbz: jschneiderhan: The application deployment cookbook 'tags' nodes.  We do much the same thing - we have an attribute namespace for our company, and in that we ensure that every node has a triplet tag - project, customer, environment.  You could have one that includes the developer name or ID.
[2012-02-10 19:03:00 -0500] jschneiderhan: jbz very cool - I'll think on that a bit - sounds promising
[2012-02-10 19:03:00 -0500] jschneiderhan: jbz the way you are using organizations fits much better with my idea of their intended purpose
[2012-02-10 19:04:00 -0500] jbz: jschneiderhan: Only piece of advice I have  don't get too hung up on finding 'best answer' or 'best practice' - most of what gets done in Chef seems to be new enough that there isn't a consensus on those yet, so trying to hold out for them risks paralysis.
[2012-02-10 19:04:00 -0500] Brad_K: l1x: so, tell me about this document about btrfs and why it's laughable.
[2012-02-10 19:04:00 -0500] l1x: Brad_K: first the title
[2012-02-10 19:05:00 -0500] jschneiderhan: jbz understood - and i've definitely hit that a bit already here
[2012-02-10 19:05:00 -0500] jschneiderhan: thank you for sharing your thoughts
[2012-02-10 19:05:00 -0500] Brad_K: l1x: yeah, and?
[2012-02-10 19:05:00 -0500] l1x: next step, there is no fsck for the FS yet
[2012-02-10 19:06:00 -0500] l1x: but they are working on the production ready version already :)
[2012-02-10 19:06:00 -0500] Brad_K: i'm assuming you're comparing btrfs to zfs, and finding a great deal lacking.  i've been a fan of zfs for a long time, but i'm not a deep filesystem guy, so i'm not immediately grok'ing the differences.
[2012-02-10 19:06:00 -0500] bdha: [Fri, 10 Feb 2012 19:06:47 GMT] [info] [<0.540.0>] OS Process #Port<0.1962> Log :: function raised exception (new TypeError("doc.attributes is undefined", "", 3)) with doc._id 38cc867c-3470-4494-bdc6-c7b9cda0c60b
[2012-02-10 19:07:00 -0500] bdha: ergh.
[2012-02-10 19:07:00 -0500] l1x: the guy do not mention ZFS anywhere, he just talks about how great is brtfa compare to ext3
[2012-02-10 19:07:00 -0500] l1x: Brad_K: i see
[2012-02-10 19:07:00 -0500] Mithrandir: zfs isn't particularly good on linux, is it? ;-)
[2012-02-10 19:07:00 -0500] l1x: i dont know never used it on linux :)
[2012-02-10 19:08:00 -0500] jbz: jschneiderhan: most welcome.  Good luck. :-)
[2012-02-10 19:08:00 -0500] bdha: It works ok.
[2012-02-10 19:08:00 -0500] Brad_K: i keep waiting to be able to have real deal zfs on my mac.  and on my storage device at home.
[2012-02-10 19:09:00 -0500] mlei: the guy who worked on it at apple started his own company and has a commercial release
[2012-02-10 19:09:00 -0500] mlei: but only for storage, not boot
[2012-02-10 19:09:00 -0500] l1x: yeah
[2012-02-10 19:10:00 -0500] mlei: zevo
[2012-02-10 19:10:00 -0500] l1x: i just dont store anything on ext{3,4}|brtfs what is important to me
[2012-02-10 19:10:00 -0500] mlei: what's so bad about ext3
[2012-02-10 19:11:00 -0500] mlei: other than it's old
[2012-02-10 19:11:00 -0500] atomic-penguin: At least its not NTFS
[2012-02-10 19:11:00 -0500] l1x: agagagsgda
[2012-02-10 19:11:00 -0500] atomic-penguin: Don't know what is so bad about ext3
[2012-02-10 19:12:00 -0500] l1x: atomic-penguin: ntfs is reliable
[2012-02-10 19:12:00 -0500] l1x: it is proven and stable
[2012-02-10 19:12:00 -0500] Mithrandir: extN is generally solid IME.  Never done anything very exciting for me, but I like my file systems boring.
[2012-02-10 19:12:00 -0500] l1x: unlike ext4 for example :)
[2012-02-10 19:12:00 -0500] mlei: ntfs is pretty good for what it does
[2012-02-10 19:12:00 -0500] l1x: exactly
[2012-02-10 19:12:00 -0500] atomic-penguin: l1x, and ext3 isn't, that is what you're saying?
[2012-02-10 19:12:00 -0500] l1x: cause i know how it works...
[2012-02-10 19:12:00 -0500] l1x: this might be the reason
[2012-02-10 19:13:00 -0500] mlei: but i think ext3 is fine
[2012-02-10 19:13:00 -0500] mlei: ext3, ntfs and hfs+ are all comparable
[2012-02-10 19:13:00 -0500] mlei: imo
[2012-02-10 19:13:00 -0500] l1x: yeah
[2012-02-10 19:13:00 -0500] miah: ext3 is good until you get lots of little files in a directory
[2012-02-10 19:13:00 -0500] l1x: at least at some extent
[2012-02-10 19:13:00 -0500] l1x: miah: or you hit the 32.000 link/directory limit
[2012-02-10 19:14:00 -0500] l1x: or other limits
[2012-02-10 19:14:00 -0500] miah: yup
[2012-02-10 19:14:00 -0500] l1x: but it is usually okish
[2012-02-10 19:14:00 -0500] Mithrandir: miah: with btree, it scales pretty well, IME.
[2012-02-10 19:14:00 -0500] atomic-penguin: If you store a lots of little files on any filesystem with a largish block size you'll have problems.  That is not filesystem specific
[2012-02-10 19:14:00 -0500] Mithrandir: but then, I don't tend to put hundreds of thousands of files in a directory, if nothing else because readdir ends up taking a while.
[2012-02-10 19:15:00 -0500] Mithrandir: atomic-penguin: you can do crazy things like the tail packing reiser does, but urgh
[2012-02-10 19:15:00 -0500] RobbieAB: Or you can use smaller blocksize...
[2012-02-10 19:18:00 -0500] l1x: back to chef,   if i have  default[:java_home] = "/usr", in the attributes/default.rb i can use it in recipe/random.rb  in a resource block like environment { JAVA_HOME => :java_home }
[2012-02-10 19:18:00 -0500] l1x: question mark
[2012-02-10 19:19:00 -0500] Mithrandir: l1x: iirc, it'd be environment({"JAVA_HOME" => node[:java_home]}) ?
[2012-02-10 19:20:00 -0500] l1x: Mithrandir: i am a total chef noob
[2012-02-10 19:20:00 -0500] l1x: so might be
[2012-02-10 19:21:00 -0500] Mithrandir: but yes, you can do that
[2012-02-10 19:21:00 -0500] Mithrandir: though usually you'd put it somewhere not directly on the node, bug node[:languages][:java][:java_home] or similar, but that's mostly just convention
[2012-02-10 19:22:00 -0500] jbz: Can a node delete itself from the chef server?  I ask because I'm trying to figure out how to keep the Opscode platform org 'current' when using AWS Autoscaling so that 'stale' node records don't hang around.
[2012-02-10 19:23:00 -0500] jbz: I'm hoping to find a way to have the node remove itself when terminated by the AWS AS system.
[2012-02-10 19:23:00 -0500] Mithrandir: jbz: afaik, no, not unless you give them access to it.
[2012-02-10 19:23:00 -0500] jbz: hmmmm.
[2012-02-10 19:23:00 -0500] Mithrandir: jbz: but you can run a cron job that nukes anything that hasn't been seen for X seconds?
[2012-02-10 19:23:00 -0500] jbz: Mithrandir: I could, but then I have to have a 'manager' node running somewhere.
[2012-02-10 19:23:00 -0500] Mithrandir: sure
[2012-02-10 19:24:00 -0500] jbz: And I need somewhat better resolution than that - some of our apps have to coordinate who-does-what across the cluster
[2012-02-10 19:24:00 -0500] jbz: so I need to be *sure* that the node records don't get stale. :-/
[2012-02-10 19:25:00 -0500] Mithrandir: if you're using the platform, you can give nodes permission to delete themselves, iirc
[2012-02-10 19:25:00 -0500] jbz: ahhh hmmm
[2012-02-10 19:25:00 -0500] jbz: thanks that makes sense
[2012-02-10 19:25:00 -0500] jbz: so then I'd just have to find a way to have the manager node grant that permission to new nodes...
[2012-02-10 19:26:00 -0500] Mithrandir: I think you can set the default too
[2012-02-10 19:26:00 -0500] jbz: Ah?  Sweet.
[2012-02-10 19:26:00 -0500] jbz: Thanks!
[2012-02-10 19:43:00 -0500] ablerman: does anyone use the 37signals users cookbook? ( I'm a newb having some issues )
[2012-02-10 19:46:00 -0500] AntonZ: does anyone have recipe/cookbook for EXT3 filesys ?
[2012-02-10 19:48:00 -0500] l1x: hmmmm service resource has no environment attribute
[2012-02-10 20:01:00 -0500] jbz: How do I use a library defined by a cookbook from a report handler installed/enabled by that cookbook?  Can anyone point me to an example?
[2012-02-10 20:02:00 -0500] flashmanbahadur: jbz: does it expose it as a provider?
[2012-02-10 20:02:00 -0500] jbz: flashmanbahadur: er, no, as a library.
[2012-02-10 20:02:00 -0500] flashmanbahadur: hmm, not sure
[2012-02-10 20:03:00 -0500] jbz: I just have some Ruby I will probably end up using in a bunch of places (including a handler or three) and I wanted to abstract it
[2012-02-10 20:03:00 -0500] jbz: (essentially, the node needs to determine if it is the 'reporting node' amongst all nodes which share a set of tags)
[2012-02-10 20:04:00 -0500] flashmanbahadur: not something you can enforce with a role?
[2012-02-10 20:08:00 -0500] jbz: no, they'll all share the same roles/runlist
[2012-02-10 20:08:00 -0500] jbz: I want a report to fire, but I only want to get it from *one* node in the cluster.
[2012-02-10 20:08:00 -0500] jbz: (they share the roles/runlist because they're in the same AWS autoscaling group).
[2012-02-10 20:09:00 -0500] miah: zookeeper, noah?
[2012-02-10 20:12:00 -0500] l1x: i am crying
[2012-02-10 20:12:00 -0500] l1x: it is not possible to pass the JAVA_HOME to the service as an attribute
[2012-02-10 20:12:00 -0500] l1x: so i need to import all the init scripts to the cookbook and add that line
[2012-02-10 20:12:00 -0500] l1x: it is like :(
[2012-02-10 20:14:00 -0500] mlei: l1x: is it hardcoded into the init script?
[2012-02-10 20:14:00 -0500] mlei: or is it in a config somewhere
[2012-02-10 20:17:00 -0500] AntonZ: does anyone know if my instance has ext3 FS and ebs mount is xfs, can i read/write to such mount ?
[2012-02-10 20:20:00 -0500] jbz: miah: noah has a library example but it's only used in recipes, not handlers...
[2012-02-10 20:20:00 -0500] jbz: (in fact I ended up using the noah example to do my recipe call :-) )
[2012-02-10 20:26:00 -0500] mlei: one of my developers accidentally uploaded a data bag with no "id" attribute
[2012-02-10 20:26:00 -0500] mlei: so now i have a databag with no name
[2012-02-10 20:26:00 -0500] mlei: how do i get rid of that?
[2012-02-10 20:27:00 -0500] mattray: mlei: when you say "knife data bag show blah", is there an empty id listed?
[2012-02-10 20:27:00 -0500] mlei: yep.
[2012-02-10 20:27:00 -0500] mlei: mattray: do you mean knife data bag list?
[2012-02-10 20:27:00 -0500] mlei: i have one entry that's called nothing
[2012-02-10 20:28:00 -0500] mattray: 'list' lists the data bags, 'show' would be for the individual bag you want to look at
[2012-02-10 20:28:00 -0500] mattray: ie. knife data bag show foo
[2012-02-10 20:28:00 -0500] mattray: would be the 'foo' data bag
[2012-02-10 20:28:00 -0500] mattray: and "knife data bag show foo bar" would show the "bar" id in the "foo" data bag
[2012-02-10 20:29:00 -0500] mattray: I bet you could fix it with shef
[2012-02-10 20:29:00 -0500] mattray: does it show up in the web UI?
[2012-02-10 20:34:00 -0500] bdha: woop. Found another host with many snapshots... removed, and down from 40MB to .. 17MB.
[2012-02-10 20:35:00 -0500] miah: i hate importing initscripts into the cookbook, but at the same time i <3 runit so i do it anyways =)
[2012-02-10 20:35:00 -0500] mlei: mattray: it shows up but because the name of it is blank, you can't actually click on it to do anything
[2012-02-10 20:36:00 -0500] mlei: trying to delete it gives you a 404
[2012-02-10 20:37:00 -0500] mlei: seems like there should be some validation to prevent you from making a databag with a blank name, i don't know what happened
[2012-02-10 20:38:00 -0500] mattray: mlei: open source or hosted?
[2012-02-10 20:38:00 -0500] mlei: running own server
[2012-02-10 20:38:00 -0500] mlei: 0.10.8
[2012-02-10 20:38:00 -0500] mattray: sounds like a legit bug, want to open a ticket on tickets.opscode.com?
[2012-02-10 20:38:00 -0500] mlei: let me see if i can make it reproducible
[2012-02-10 20:38:00 -0500] mlei: i want to know how to fix it first though /-:
[2012-02-10 20:39:00 -0500] miah: find the entry in couch?
[2012-02-10 20:39:00 -0500] mattray: mlei: I bet you could fix it in shef
[2012-02-10 20:40:00 -0500] yfeldblum: mlei, heh, had to deal with a similar issue myself in librarian ... https://github.com/applicationsonline/librarian/commit/ca44acfdcfc12248a99d69242d0a0d503def35a8
[2012-02-10 20:40:00 -0500] mattray: mlei: get the list of cookbook items, then delete it by position
[2012-02-10 20:41:00 -0500] mlei: mattray: can you point me to some doco on that?
[2012-02-10 20:41:00 -0500] mattray: shef?
[2012-02-10 20:41:00 -0500] bawt: shef is the interactive shell version of chef.
[2012-02-10 20:41:00 -0500] mattray: dang, I hoped bawt had the url :)
[2012-02-10 20:41:00 -0500] mattray: 1 sec
[2012-02-10 20:41:00 -0500] mlei: i know what shef is, but specifically on listing by position
[2012-02-10 20:41:00 -0500] lusis: shef is chef with an s
[2012-02-10 20:41:00 -0500] yfeldblum: shef?
[2012-02-10 20:41:00 -0500] bawt: shef is the interactive shell version of chef.
[2012-02-10 20:42:00 -0500] lusis: .
[2012-02-10 20:42:00 -0500] lusis: HORRIBLE NAME
[2012-02-10 20:42:00 -0500] lusis: totally kicking kallistec's ass for it
[2012-02-10 20:42:00 -0500] lusis: some day
[2012-02-10 20:42:00 -0500] lusis: I vote for 'chirb'
[2012-02-10 20:42:00 -0500] mattray: http://wiki.opscode.com/display/chef/Shef and http://wiki.opscode.com/display/chef/Data+Bags
[2012-02-10 20:42:00 -0500] lusis: out of spite
[2012-02-10 20:42:00 -0500] yfeldblum: shef is like a cook but only knows how to make shteak
[2012-02-10 20:42:00 -0500] mlei: yeah having a tool pronounced the same as something else is BAD.
[2012-02-10 20:42:00 -0500] lusis: especially when the something else is your own tool
[2012-02-10 20:42:00 -0500] mattray: I vote we pronounce it "sef"
[2012-02-10 20:42:00 -0500] flashmanbahadur: I vote for "shiv"
[2012-02-10 20:43:00 -0500] yfeldblum: i vote for "chef console"
[2012-02-10 20:43:00 -0500] lusis: I vote we pronounce it chef-console
[2012-02-10 20:43:00 -0500] flashmanbahadur: already have knife
[2012-02-10 20:43:00 -0500] lusis: yfeldblum: +1
[2012-02-10 20:43:00 -0500] lusis: pan
[2012-02-10 20:43:00 -0500] lusis: knife chef pan
[2012-02-10 20:43:00 -0500] lusis: heh
[2012-02-10 20:43:00 -0500] mattray: ovenmitt
[2012-02-10 20:43:00 -0500] flashmanbahadur: sous-chef?
[2012-02-10 20:43:00 -0500] lusis: already taken
[2012-02-10 20:43:00 -0500] c_t: that_thingy_you_squeeze_garlic_with
[2012-02-10 20:43:00 -0500] mlei: lolz.
[2012-02-10 20:43:00 -0500] lusis: spatula
[2012-02-10 20:43:00 -0500] mattray: lusis: taken
[2012-02-10 20:43:00 -0500] yfeldblum: lulz enough with the punnery
[2012-02-10 20:43:00 -0500] flashmanbahadur: as long as it is named something that makes my google searches even harder, its fine
[2012-02-10 20:43:00 -0500] lusis: oh duh
[2012-02-10 20:43:00 -0500] lusis: forgot about the ETL stuff
[2012-02-10 20:44:00 -0500] c_t: if it's a cutesy name, some ruby project has taken it
[2012-02-10 20:44:00 -0500] lusis: I still think 'wibblefuck' is a great name for a project
[2012-02-10 20:44:00 -0500] mattray: saladtongs
[2012-02-10 20:44:00 -0500] c_t: flashmanbahadur: ooh, like the libmemcached gem for ruby conveniently named "memcached"
[2012-02-10 20:44:00 -0500] c_t: that's a fun one to google
[2012-02-10 20:44:00 -0500] flashmanbahadur: hah
[2012-02-10 20:44:00 -0500] c_t: I like "windowless_van" for a project name
[2012-02-10 20:44:00 -0500] mattray: spiceweasel is #2 in the googlez
[2012-02-10 20:44:00 -0500] lusis: hahah
[2012-02-10 20:44:00 -0500] yfeldblum: c_t, platform package maintainers routinely name their packages after the underlying software they package
[2012-02-10 20:44:00 -0500] c_t: ideally it would work well with handlebars.js
[2012-02-10 20:45:00 -0500] lusis: c_t: that's rough
[2012-02-10 20:45:00 -0500] lusis: ouch
[2012-02-10 20:45:00 -0500] lusis: heh
[2012-02-10 20:45:00 -0500] c_t: yfeldblum: I understand the reasoning, it's just a bitch to google is all
[2012-02-10 20:46:00 -0500] mattray: mlei: try something like http://wiki.opscode.com/display/chef/Data+Bags#DataBags-AMoreCompleteExample
[2012-02-10 20:46:00 -0500] jtimberman: yfeldblum, lusis: http://tickets.opscode.com/browse/CHEF-2925
[2012-02-10 20:47:00 -0500] lusis: jtimberman: I saw
[2012-02-10 20:47:00 -0500] lusis: but no chirb
[2012-02-10 20:47:00 -0500] mattray: jtimberman: could you please add all the helpful suggestions we all just made as well?
[2012-02-10 20:47:00 -0500] lusis: I was hurt
[2012-02-10 20:47:00 -0500] lusis: just tongs
[2012-02-10 20:47:00 -0500] mattray: probably taken
[2012-02-10 20:47:00 -0500] lusis: I'm not typing saladtongs all the effing time
[2012-02-10 20:48:00 -0500] lusis: alias to st
[2012-02-10 20:48:00 -0500] yfeldblum: mattray, "windowless_van" is not one of those "helpful suggestions we all just made"
[2012-02-10 20:48:00 -0500] cwj: rewrite shef on top of pry kthx
[2012-02-10 20:48:00 -0500] lusis: nyet
[2012-02-10 20:48:00 -0500] mattray: lusis: tab-complete is your friend
[2012-02-10 20:48:00 -0500] lusis: mattray: What is this thing you speak of
[2012-02-10 20:48:00 -0500] xdg: I'm confused by the effect of "*.updated_by_last_action(true)" in LWRPs; what does it actually do?  Where is it documented?
[2012-02-10 20:48:00 -0500] lusis: does it sit near my newly relocated conrol key?
[2012-02-10 20:48:00 -0500] lusis: s/conrol/control
[2012-02-10 20:49:00 -0500] jtimberman: mattray: comment on the ticket :)
[2012-02-10 20:49:00 -0500] jtimberman: vote it up
[2012-02-10 20:49:00 -0500] jtimberman: and make btm stop laughing at me for filing that ticket.
[2012-02-10 20:49:00 -0500] jtimberman: he's mean.
[2012-02-10 20:49:00 -0500] mattray: xdg: when you use notifications with LWRPs, that's how you flag if something changed or not
[2012-02-10 20:49:00 -0500] jtimberman: cwj: require 'pry'
[2012-02-10 20:49:00 -0500] jtimberman: cwj: in shef
[2012-02-10 20:49:00 -0500] cwj: orly
[2012-02-10 20:49:00 -0500] jtimberman: rly
[2012-02-10 20:49:00 -0500] cwj: kewl
[2012-02-10 20:49:00 -0500] jtimberman: i had a gist with some cool shit somewhere.
[2012-02-10 20:50:00 -0500] jtimberman: https://gist.github.com/1585062
[2012-02-10 20:51:00 -0500] jtimberman: i had another one but i think it was a private gist from august and no way would i be able to find that as easily :)
[2012-02-10 20:51:00 -0500] xdg: mattray, I'm having an issue where a notification to my LWRP doesn't seem to be doing anything.  I see "Processing ..." for the action on my LWRP, but I don't see a corresponding message when that code calls an action on another resource
[2012-02-10 20:51:00 -0500] xdg: (if that makes any sense)
[2012-02-10 20:51:00 -0500] mattray: xdg: have a gist of the recipe and the output?
[2012-02-10 20:56:00 -0500] xdg: output: https://gist.github.com/1792819
[2012-02-10 20:56:00 -0500] xdg: LWRP: https://github.com/dagolden/perl-chef/blob/master/cookbooks/carton/providers/app.rb
[2012-02-10 20:57:00 -0500] xdg: I see the "git sending restart, then I see the LWRP action restart, but that should be triggering a runit_service restart, I would think
[2012-02-10 20:58:00 -0500] xdg: note: I'm using the runit_service LWRP from jtimberman's githup repo branch CHEF-154
[2012-02-10 20:59:00 -0500] xdg: https://github.com/jtimberman/cookbooks/tree/CHEF-154/runit
[2012-02-10 21:02:00 -0500] bluenemo: hi guys, i'm getting this error on my workstation for 'knife client list' (just startet setting up everything): Exception: NoMethodError: undefined method `gsub' for nil:NilClass
[2012-02-10 21:02:00 -0500] xdg: jtimberman, fwiw, I'd love to see CHEF-154 get released finally.  (nudge, nudge)
[2012-02-10 21:02:00 -0500] bluenemo: i have ubuntu 10.04 on server workstation and client
[2012-02-10 21:06:00 -0500] bluenemo: was leaving out the http in client server adress in knife.rb
[2012-02-10 21:17:00 -0500] jtimberman: xdg: me too
[2012-02-10 21:17:00 -0500] jtimberman: xdg: it has slipped due to other priorities.
[2012-02-10 21:17:00 -0500] xdg: I gave it a vote on the tracker.  :-)
[2012-02-10 21:18:00 -0500] yfeldblum: for shame, jtimberman, for shame
[2012-02-10 21:21:00 -0500] kallistec: heh. the word shef looks great on irc
[2012-02-10 21:21:00 -0500] kallistec: and you totally get it right away
[2012-02-10 21:28:00 -0500] xdg: mattray, any thoughts on what I pasted?
[2012-02-10 21:28:00 -0500] xdg: I'm finding LWRPs to be easy to start writing but hard to get just right
[2012-02-10 21:30:00 -0500] mattray: xdg: what notifications are you using with the carton_app[hello-world] :enable?
[2012-02-10 21:31:00 -0500] xdg: I don't understand the question, sorry.
[2012-02-10 21:32:00 -0500] mattray: where's the recipe?
[2012-02-10 21:32:00 -0500] xdg: https://gist.github.com/1793038
[2012-02-10 21:33:00 -0500] xdg: carton_app has a default action of "enable" set in the resources file
[2012-02-10 21:33:00 -0500] xdg: https://github.com/dagolden/perl-chef/blob/master/cookbooks/carton/resources/app.rb
[2012-02-10 21:33:00 -0500] mattray: that was going to be my next question
[2012-02-10 21:34:00 -0500] xdg: what I don't get is why I can trigger carton_app start and that triggers runit_service start, but the notification to carton_app to restart doesn't likewise trigger runit_service restart
[2012-02-10 21:34:00 -0500] mattray: line #9 in https://gist.github.com/1792819 looks like it was triggered
[2012-02-10 21:36:00 -0500] xdg: right, but that's just a wrapper around runit_service new_resource.name do action :restart end
[2012-02-10 21:37:00 -0500] xdg: i.e. in https://gist.github.com/1792819 I see that line 6 is followed by line 7 (start -> start), but line 9 doesn't have a corresponding runit_service restart
[2012-02-10 21:37:00 -0500] leifmadsen: I have a script that is being executed via my recipe through chef server, and I'm not sure how I can enable more debugging so I can see what the commadn that was actually run was during the configuration via knife
[2012-02-10 21:37:00 -0500] mattray: does running chef-client -l debug show anything?
[2012-02-10 21:38:00 -0500] mattray: xdg and leifmadsen that works for both of you
[2012-02-10 21:38:00 -0500] leifmadsen: mattray: ok, looking into that
[2012-02-10 21:38:00 -0500] xdg: mattray, I'm running chef-solo over ssh
[2012-02-10 21:39:00 -0500] xdg: same flag should work?
[2012-02-10 21:39:00 -0500] leifmadsen: mattray: aha ya that makes sense thanks :)
[2012-02-10 21:39:00 -0500] mattray: probably
[2012-02-10 21:39:00 -0500] mattray: xdg: I don't use solo though
[2012-02-10 21:39:00 -0500] mattray: but that'll get you copious debugging
[2012-02-10 21:39:00 -0500] xdg: I'll dig into my scripts and hack that in.
[2012-02-10 21:39:00 -0500] xdg: give me a few minutes  :-)
[2012-02-10 21:39:00 -0500] mattray: throw some logging messages in there too
[2012-02-10 21:43:00 -0500] l1x: mlei: JAVA_HOME is set in /etc/profile for interactive sessions
[2012-02-10 21:43:00 -0500] l1x: but /sbin/service blah restart is not reading that
[2012-02-10 21:44:00 -0500] l1x: so we need to put it to the init script
[2012-02-10 21:44:00 -0500] werdnativ: my php_pear resources don't seem to be installing (no visible errors). Is there a way to get the actual exec commands that were run?
[2012-02-10 21:44:00 -0500] werdnativ: I tried setting log_level :debug
[2012-02-10 21:45:00 -0500] werdnativ: I guess I could dig in with rdebug, but I'd rather not!
[2012-02-10 21:46:00 -0500] xdg: mattray, c.f. https://gist.github.com/1793174 -- and line 38 looks suspiciously like the culprit
[2012-02-10 21:46:00 -0500] xdg: though I'm not sure how to deal with it
[2012-02-10 21:46:00 -0500] jtimberman: yfeldblum: i know
[2012-02-10 22:05:00 -0500] xdg: jtimberman, I see that runit_service doesn't use updated_by_last_action at all. Could that be related to my problem?
[2012-02-10 22:05:00 -0500] xdg: I see that http://wiki.opscode.com/display/chef/Cookbook+Style+Guide+Draft suggests using them in providers
[2012-02-10 22:19:00 -0500] mlei: mattray: i tried this in shef: blankbag = data_bag('')
[2012-02-10 22:19:00 -0500] mlei: Chef::Exceptions::InvalidDataBagName: DataBags must have a name matching /^[\-[:alnum:]_]+$/, you gave ""
[2012-02-10 22:20:00 -0500] mlei: how do i just list the data bags instead of referring to a particular one by name?
[2012-02-10 22:20:00 -0500] mattray: lemme go dig into knife and see what it does
[2012-02-10 22:21:00 -0500] yfeldblum: mlei, https://github.com/opscode/chef/blob/0.10.8/chef/lib/chef/data_bag.rb#L138
[2012-02-10 22:23:00 -0500] yfeldblum: http://rubydoc.info/gems/chef/0.10.8/Chef/DataBag:list
[2012-02-10 22:24:00 -0500] yfeldblum: https://github.com/opscode/chef/blob/0.10.8/chef/lib/chef/data_bag.rb#L212
[2012-02-10 22:24:00 -0500] yfeldblum: hmm, Chef::DataBag.list is defined twice ...
[2012-02-10 22:24:00 -0500] yfeldblum: gj
[2012-02-10 22:24:00 -0500] yfeldblum: oh wait nvm
[2012-02-10 22:24:00 -0500] yfeldblum: http://rubydoc.info/gems/chef/0.10.8/Chef/DataBag.list
[2012-02-10 22:25:00 -0500] mlei: ok, so i got this: rs=couchdb.list("data_bags")
[2012-02-10 22:25:00 -0500] yfeldblum: wow my linkfu is fail
[2012-02-10 22:25:00 -0500] mlei:  => {"total_rows"=>3, "rows"=>[{"id"=>"7dc7a465-031c-4ad1-8f75-ad2e1aacf081", "value"=>"", "key"=>""}, {"id"=>"b3031a6b-992d-4f0e-80cc-a9370c4328f8", "value"=>"test1", "key"=>"test1"}, {"id"=>"aa7dc7fe-99d0-40d7-afdd-eb77adf2bb19", "value"=>"test2-from-ui", "key"=>"test2-from-ui"}], "offset"=>0}
[2012-02-10 22:25:00 -0500] mlei: i can see the id for the one i want... now how do i delete that or get that into an object
[2012-02-10 22:26:00 -0500] yfeldblum: @couchdb.delete("data_bag", @name, @couchdb_rev)
[2012-02-10 22:26:00 -0500] yfeldblum: maybe `couchdb.delete("data_bag", "", REV)`
[2012-02-10 22:28:00 -0500] xdg: mattray, I've tracked things down to the "execute" in runit_service :restart not executing. WTF?
[2012-02-10 22:28:00 -0500] mlei: what's that @couchdb_rev mean
[2012-02-10 22:28:00 -0500] yfeldblum: couchdb documents are versioned
[2012-02-10 22:29:00 -0500] xdg: mattray, I also had to explicitly run_action(:restart) on the runit_service resource in my LWRP that uses it
[2012-02-10 22:29:00 -0500] mattray: xdg: you may need jtimberman or someone more familiar with it to help
[2012-02-10 22:29:00 -0500] yfeldblum: trace thru how the class works
[2012-02-10 22:29:00 -0500] mlei: yfeldblum: how do i know what revision it is?
[2012-02-10 22:29:00 -0500] xdg: jtimberman, ^^ see mattry's response and my earlier diagnosis
[2012-02-10 22:29:00 -0500] yfeldblum: dunno
[2012-02-10 22:29:00 -0500] yfeldblum: read thru the code to find out how it gets set?
[2012-02-10 22:30:00 -0500] mlei: Chef::DataBag.list doesn't help me
[2012-02-10 22:30:00 -0500] mlei: it returns API endpoints
[2012-02-10 22:31:00 -0500] yfeldblum: look at the .cdb_* methods
[2012-02-10 22:32:00 -0500] yfeldblum: those are the methods that the chef-server-api uses to interact with the couchdb directly
[2012-02-10 22:32:00 -0500] yfeldblum: those methods are used inside the chef-server, not from the chef-client
[2012-02-10 22:32:00 -0500] yfeldblum: latez
[2012-02-10 22:32:00 -0500] xdg: mattray, thanks for your help.  It's end of day here on east coast, so I'll follow up again next week
[2012-02-10 22:33:00 -0500] mattray: good luck
[2012-02-10 22:34:00 -0500] mlei: yfeldblum: I was able to find it in the couchdb web interface and hit delete there
[2012-02-10 22:34:00 -0500] mlei: thanks for your help, mattray too
[2012-02-10 22:34:00 -0500] mattray: mlei: you're welcome
[2012-02-10 22:35:00 -0500] mlei: i'll see if my developer can reproduce it
[2012-02-10 22:35:00 -0500] mlei: if so i'll file a bug
[2012-02-10 22:35:00 -0500] l1x: i cant believe there is no better way to manage this init scrip JAVA_HOME problem
[2012-02-10 22:36:00 -0500] bkmontgomery: I'm trying to install postgresql 9.1 on ubuntu 10.04, and the installation seems to work, but for some reason, chef things postgres config files are in /etc/postgresql/8.4/main/.  Any idea why this might be happening?   My recipes/roles are here: https://gist.github.com/1793609
[2012-02-10 22:37:00 -0500] bkmontgomery: s/things/thinks/
[2012-02-10 22:39:00 -0500] savant: hmmm
[2012-02-10 22:39:00 -0500] savant: I dont think I have an arbiter in my current setup.
[2012-02-10 22:49:00 -0500] j-v-e: hey guys
[2012-02-10 22:50:00 -0500] j-v-e: I'm trying to create a data bag item from a recipe
[2012-02-10 22:50:00 -0500] j-v-e: and I get a 403 unauthorize
[2012-02-10 22:50:00 -0500] j-v-e: how do I change the permissions on the data bag ?
[2012-02-10 22:51:00 -0500] jessicab: j-v-e - it depends on the permission thats missing, check out this page on the wiki: http://wiki.opscode.com/display/chef/Common+Errors#CommonErrors-403Forbidden
[2012-02-10 22:54:00 -0500] j-v-e: I'm using a local chef installation, can I fix that in the chef web interface ?
[2012-02-10 22:54:00 -0500] j-v-e: reading the wiki page right now
[2012-02-10 22:56:00 -0500] j-v-e: jessicab: I can't find any permission tab on my local chef admin interface
[2012-02-10 22:56:00 -0500] j-v-e: I'm guessing that's a hosted chef feature ?
[2012-02-10 22:57:00 -0500] jessicab: ah yea, im not sure how you could run into that issue on oss honestly, i thought it didnt have a permissions system
[2012-02-10 22:58:00 -0500] j-v-e: funny thing is that it works from the knife command line
[2012-02-10 22:58:00 -0500] j-v-e: it's when I try to create an item in my databag from a recipe that it doesn't work
[2012-02-10 22:59:00 -0500] mattray: j-v-e: different permissions between the CLI and the recipe
[2012-02-10 23:00:00 -0500] mattray: the CLI is an admin, the recipe is just the node
[2012-02-10 23:00:00 -0500] j-v-e: mattray: how do I manage that ?
[2012-02-10 23:00:00 -0500] mattray: but like jessicab said, I'm not sure
[2012-02-10 23:02:00 -0500] j-v-e: :/
[2012-02-10 23:02:00 -0500] j-v-e: I guess I'll ask the guy who set up my chef server on monday then :)
[2012-02-10 23:18:00 -0500] cwj: anyone using per-environment keys for encrypted data bags?
[2012-02-10 23:18:00 -0500] cwj: i am working on transitioning away from lusis' pre-0.10 encrypted data bag implementation and i might be overthinking things
[2012-02-10 23:22:00 -0500] bkmontgomery: So, if you try to override for [:postgresql][:version] in a role, the postgresql cookbook will ignore that when setting the [:postgresql][:dir] value.  Is this intended?  Or is this worthy of a ticket?
[2012-02-10 23:24:00 -0500] Brad_K: cwj: no, all the encrypted data bags we have are ones that we would want available in all environments.  we do pull out different things from them based on the environment, however.
[2012-02-10 23:27:00 -0500] cwj: Brad_K: im in the process of moving from "id": "staging_secret_thing_pass", "data": "bar" to something like "id": "secret_thing", "production": { "user": "foo", "pass":bar" }. "staging": { "user": "baz", "pass": "derp" }
[2012-02-10 23:27:00 -0500] cwj: just wondering if i should get more paranoid
[2012-02-10 23:27:00 -0500] cwj: i recognize however that the real use for encrypted data bags is for securing secrets on the chef server, not on the node
[2012-02-10 23:28:00 -0500] Brad_K: i hadn't thought about it, but i guess you could use it for securing stuff on the node.  you'd have to make sure that it didn't get expanded in any template, and was only accessed via a recipe, but that should work.
[2012-02-10 23:29:00 -0500] Brad_K: for certain types of system-type users, i can see where that would be useful.
[2012-02-10 23:29:00 -0500] cwj: almost all of my secrets will get populated into templates, so no real dice there
[2012-02-10 23:30:00 -0500] Brad_K: but, for example, with a database, if you want to password protect access to it, you're going to have to make that password available to the database client somehow, and that will presumably need to be made in the clear.
[2012-02-10 23:30:00 -0500] cwj: yeah
[2012-02-10 23:31:00 -0500] cwj: mostly thinking that if a sufficiently clueful attacker reads through the cached cookbooks on a node in staging they would have enough information to suss out how to access secrets for production from the same data bag
[2012-02-10 23:31:00 -0500] Brad_K: but i can see that there might be some other edge cases where you could keep the data encrypted in the data bag until it actually needs to be used by the recipe and never stored anywhere in an unencrypted format.
[2012-02-10 23:31:00 -0500] Brad_K: yup, that's a risk.
[2012-02-10 23:32:00 -0500] Brad_K: and if they know that much more about chef than i do, then we're well and truly screwed anyway.
[2012-02-10 23:33:00 -0500] Brad_K: you've got to decide on your threat model, who it is that you're trying to protect your systems from, and what you're willing to put up with in order to make that more difficult.
[2012-02-10 23:33:00 -0500] cwj: yeah
[2012-02-10 23:33:00 -0500] cwj: trying to figure that out
[2012-02-10 23:34:00 -0500] Brad_K: hmm.  java must still be om nomming too much memory.  which seems to be the raison d'etre for java.  ;-)
[2012-02-10 23:40:00 -0500] ssd7_: hmm j-v-e seems to be gone now, but writing to data bags on an open source server requires the client to be an admin client (typically a node's client won't be)
[2012-02-10 23:40:00 -0500] ssd7_: it works from the workstation because your perosnal api client you use with knife is an admin client
[2012-02-10 23:42:00 -0500] Brad_K: ahh, that's interesting to know.  thanks, ssd7_!
[2012-02-10 23:42:00 -0500] mlei: interesting. that actually applies to what i'm doing
[2012-02-10 23:42:00 -0500] mlei: cool.
[2012-02-10 23:49:00 -0500] ssd7_: np :).  I should note that making all of those API clients is likely not the best idea from a security standpoint.
