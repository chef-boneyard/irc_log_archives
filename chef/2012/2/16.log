[2012-02-16 08:40:00 -0500] BryanWB: ohai chefs!
[2012-02-16 10:49:00 -0500] serjs: Hi guys, anyone can help me with error ERROR: EOFError: end of file reached I'm trying to upload apache cookbook to server, but it hanged. -VV output here http://pastebin.com/REkpumDj
[2012-02-16 10:59:00 -0500] serjs: hm i find my problem, metadata long desc is wrong
[2012-02-16 12:53:00 -0500] eamelink: I'm trying to run chef-solo 0.10.8 on Mac OS X Lion, with just recipe[bluepill] in the run list, and I get the error:
[2012-02-16 12:53:00 -0500] eamelink: FATAL: ArgumentError: directory[/etc/bluepill] (bluepill::default line 28) had an error: ArgumentError: can't find group for root
[2012-02-16 12:53:00 -0500] yatesy: is there a group called root?
[2012-02-16 12:54:00 -0500] eamelink: Nope
[2012-02-16 12:55:00 -0500] eamelink: That must make me look stupid :P
[2012-02-16 12:56:00 -0500] eamelink: So I guess that cookbook needs an attribute (?) override (?) for OS X to use wheel instead of root? (Not sure about terminology here)
[2012-02-16 13:00:00 -0500] eamelink: Is it a coincidence that one of the first cookbooks I try doesn't work well on OS X or am I bound to run into many more issues? Aka: How many people use chef on OS X?
[2012-02-16 13:02:00 -0500] yatesy: i don't personally but i'm sure there's plenty who do
[2012-02-16 13:03:00 -0500] eamelink: Ah well, I better just fix it. I see that jtimberman already made a platform exception for freebsd to use the 'wheel' group instead of 'root'
[2012-02-16 13:05:00 -0500] nico: eamelink: using 0 makes your cookbook portable
[2012-02-16 13:05:00 -0500] nico: instead of "root" or "wheel"
[2012-02-16 13:05:00 -0500] eamelink: That's a great tip. But it's not my cookbook but Opscode's :)
[2012-02-16 13:06:00 -0500] nico: almost all of our 50 cookbooks run on freebsd & linux flawlessly
[2012-02-16 13:06:00 -0500] yatesy: doesn't stop you contributing something back :)
[2012-02-16 13:06:00 -0500] nico: eamelink: fork it and  PR :)
[2012-02-16 13:06:00 -0500] eamelink: It surely doesn't, but as I'm just getting started with Chef I don't have too much confidence yet :P
[2012-02-16 13:06:00 -0500] eamelink: But I'm not afraid to fork
[2012-02-16 13:08:00 -0500] yatesy: nico: nice!
[2012-02-16 13:09:00 -0500] yatesy: eamelink: i know that feeling, i've only been using chef properly for just over a month now
[2012-02-16 13:09:00 -0500] nico: yatesy: ?
[2012-02-16 13:09:00 -0500] yatesy: nico: the t-shirt :)
[2012-02-16 13:10:00 -0500] nico: it's the github one : http://shop.github.com/products/fork-you-shirt-mens-medium
[2012-02-16 13:32:00 -0500] eamelink: nico: yatesy: https://github.com/opscode/cookbooks/pull/338 :)
[2012-02-16 13:32:00 -0500] yatesy: if you're not familiar with the process you need to open a jira ticket too
[2012-02-16 13:33:00 -0500] nico: nice !
[2012-02-16 13:33:00 -0500] eamelink: Thanks yatesy, I'll do that.
[2012-02-16 13:34:00 -0500] yatesy: eamelink: check out http://wiki.opscode.com/display/chef/How+to+Contribute
[2012-02-16 14:18:00 -0500] bluenemo: when i'm executing knife bootstrap via knife bootstrap --template-file=/home/bluenemo/chef/ubuntu10.04-gems.erb -x nemo --sudo 192.168.122.40 it asks me for the sudo password but throws me to a newline (http://pastebin.com/pzmqZ2t5) how do i disable this?
[2012-02-16 14:19:00 -0500] bluenemo: (so i cant enter the sudo password..)
[2012-02-16 14:22:00 -0500] sivy: mornin
[2012-02-16 14:27:00 -0500] hcastro: bluenemo: you may need to add the -i argument that points to your key
[2012-02-16 14:35:00 -0500] mattdawson: i'm having some chef problems when using vagrant that are *really* stumping me. i'm using the default lucid box from the vagrant demo. on first chef run, i'm installing the libshadow-ruby1.8 apt package. on the next run, chef is saying that ruby-shadow needs to be installed.
[2012-02-16 14:35:00 -0500] mattdawson: does anyone know what the problem might be? outside of vagrant, i've never seen this before.
[2012-02-16 14:37:00 -0500] yatesy: have you tried running the same underlying commands outside of chef to see if the problem isn't chef specific?
[2012-02-16 14:39:00 -0500] hcastro: mattdawson: depending on how you install ruby, installing the shadow apt package may not make it available to the ruby chef runs under
[2012-02-16 14:41:00 -0500] auduny: What do people here use to trigger chef runs to deploy code or other stuff?
[2012-02-16 14:41:00 -0500] auduny: Instead of waiting  ~15 minutes.
[2012-02-16 14:41:00 -0500] yatesy: I'm having that dilema too
[2012-02-16 14:41:00 -0500] mattray: auduny: I've seen people use Jenkins to kick it off
[2012-02-16 14:41:00 -0500] yatesy: i guess knife ssh is an option
[2012-02-16 14:41:00 -0500] mattdawson: yatesy: so if i do a gem install ruby-shadow, everything's fine.
[2012-02-16 14:42:00 -0500] auduny: mattray: Yes. We use jenkins and want jenkins to start it off.
[2012-02-16 14:42:00 -0500] auduny: But how?
[2012-02-16 14:42:00 -0500] bawt: But how is that different than an attribute who has multiple_values set to true/
[2012-02-16 14:42:00 -0500] yatesy: lol say what
[2012-02-16 14:42:00 -0500] mattdawson: hcastro: i *did* note that the ruby on the vagrant box is in /opt
[2012-02-16 14:43:00 -0500] auduny: knife ssh is an option to then run chef-client. But it's a bit.. icky...
[2012-02-16 14:43:00 -0500] yatesy: indeed
[2012-02-16 14:43:00 -0500] hcastro: mattdawson: shadow apt package probably isn't installing the ruby-shadow gem inside of rubygems used by your /opt ruby
[2012-02-16 14:44:00 -0500] mattdawson: at least, the root user's ruby. so that's likely the problem, huh? gah.
[2012-02-16 14:44:00 -0500] yatesy: did you come from puppet by chance? :)
[2012-02-16 14:44:00 -0500] hcastro: mattdawson: just replace your installation of the shadow apt package with sudo gem install ruby-shadow
[2012-02-16 14:49:00 -0500] jtimberman: of interest to anyone using vmware fusion for their test systems, the fission gem by thbishop, and I wrote some words about it: http://bit.ly/testing-with-fission
[2012-02-16 14:50:00 -0500] jtimberman: mattdawson: iirc, the lucid vagrant box installs ruby in /opt, which is not going to be treated the same as if you install ruby from packages.
[2012-02-16 14:50:00 -0500] geekbri: auduny: you could use something like mcollective.
[2012-02-16 14:50:00 -0500] jtimberman: mattdawson: shadow is in the ruby stdlib in 1.8, but it was removed in 1.9, hence the 'ruby-shadow' gem.
[2012-02-16 14:50:00 -0500] geekbri: auduny: if knife ssh isn't doing the job.
[2012-02-16 14:51:00 -0500] jtimberman: auduny: i believe there's even an mcollective cookbook for getting it set up for your systems.
[2012-02-16 14:51:00 -0500] jschneiderhan: does anyone happen to use a multi-vm setup with vagrant (using chef-client/server to configure each vm)?
[2012-02-16 14:52:00 -0500] auduny: SO that is the weapon of choice is knife ssh isn't cool enough?
[2012-02-16 14:52:00 -0500] auduny: I've heard stuff about rundeck as well.
[2012-02-16 14:54:00 -0500] jschneiderhan: i ask because I'm not really sure how to setup the networking correctly, the ip addresses seem to be the same on each node if I use the default networking settings, and host-only networking doesn't seem to help
[2012-02-16 14:54:00 -0500] jtimberman: auduny: dunno, knife ssh is what we (opscode) use :)
[2012-02-16 14:54:00 -0500] auduny: Ok.
[2012-02-16 14:55:00 -0500] auduny: Thanks.
[2012-02-16 14:55:00 -0500] yatesy: jtimberman: as an example, say you want to push out to logical groups of servers in waves, would you just run knife ssh multiple times with an appropiate search to match each group?
[2012-02-16 14:56:00 -0500] mattdawson: jtimberman: so is my best bet to build my own vagrant box? or is there an easy way to work around this?
[2012-02-16 14:56:00 -0500] bluenemo: hcastro, it still does so with ssh key files: http://pastebin.com/hGX0r4kb
[2012-02-16 14:57:00 -0500] yatesy: bluenemo: your username needs to have NOPASSWD in the sudoers file
[2012-02-16 14:57:00 -0500] yatesy: otherwise default behaviour is of course to prompt for the users password when running sudo
[2012-02-16 14:57:00 -0500] bluenemo: yatesy, i
[2012-02-16 14:58:00 -0500] bluenemo: 'm ok with prompting for the pw, the problem is that it doesnt continue
[2012-02-16 14:58:00 -0500] bluenemo: and its no kind of password read just a 'waiting newline or so'
[2012-02-16 14:58:00 -0500] bluenemo: (as you can see what you type)
[2012-02-16 14:58:00 -0500] yatesy: i *suspect* it wasn't designed in that way to allow keyboard input
[2012-02-16 14:59:00 -0500] auduny: jtimberman: I featurerequest would be to be able to trigger chefruns with knife without using knife ssh. When chef is in deamon mode and talks to the server anyways. Just connect to the server and stay connected, waiting for a trigger, or checking for a trigger every second or so.
[2012-02-16 14:59:00 -0500] auduny: s/I/A/
[2012-02-16 14:59:00 -0500] bluenemo: yatesy, can i pipe it somehow? how do you guys deal with this?
[2012-02-16 15:00:00 -0500] auduny: WOuld be cool to be able to se what clients that are connected, alive and good as well.
[2012-02-16 15:00:00 -0500] yatesy: bluenemo: i use the rackspace cloud which gives you root credentials by default so no need for sudo
[2012-02-16 15:00:00 -0500] bluenemo: ... hardcoded sudo into the bootstrap config file m)
[2012-02-16 15:00:00 -0500] bluenemo: sorry.. thank you for helping anyway
[2012-02-16 15:01:00 -0500] yatesy: no worries
[2012-02-16 15:01:00 -0500] bluenemo: when i start it with --sudo all commands are executed as sudo right?
[2012-02-16 15:02:00 -0500] yatesy: auduny: that sounds like a pretty big change, and perhaps undesirable in some circumstances to have constantly nailed up connections to the chef server
[2012-02-16 15:02:00 -0500] yatesy: auduny: i can see how it could be useful tho
[2012-02-16 15:02:00 -0500] jtimberman: mattdawson: *I* build my own vagrant base boxes anyway, because I want to use the Opscode chef-full package.
[2012-02-16 15:03:00 -0500] jtimberman: mattdawson: And I recommend veewee by patrick debois if you are looking to build baseboxes.
[2012-02-16 15:03:00 -0500] jtimberman: yatesy: yes
[2012-02-16 15:04:00 -0500] jtimberman: bluenemo: when you use `knife bootstrap` with --sudo, the bootstrap template script is executed with sudo
[2012-02-16 15:04:00 -0500] jtimberman: bluenemo: the bootstrap command takes the template and renders it as a "single line command" executed a la "ssh you@ipaddress sh -c 'bootstrap template script here'"
[2012-02-16 15:05:00 -0500] bluenemo: ah ok thank you jtimberman
[2012-02-16 15:05:00 -0500] bluenemo: "ssh you@ipaddress sh -c 'bootstrap template script here'" where is the suod in there?
[2012-02-16 15:05:00 -0500] bluenemo: s/uod/udo
[2012-02-16 15:06:00 -0500] jtimberman: well
[2012-02-16 15:06:00 -0500] mattdawson: jtimberman: ahh, so *that's* what veewee is.
[2012-02-16 15:06:00 -0500] jtimberman: it would be ssh you@ipaddress sudo sh -c '...'
[2012-02-16 15:06:00 -0500] mattdawson: jtimberman: your boxes aren't public, are they?
[2012-02-16 15:06:00 -0500] bluenemo: ok
[2012-02-16 15:06:00 -0500] jtimberman: mattdawson: basebox building for great justice
[2012-02-16 15:06:00 -0500] jtimberman: mattdawson: my boxes aren't
[2012-02-16 15:06:00 -0500] jtimberman: my veewee repo is
[2012-02-16 15:06:00 -0500] mattdawson: jtimberman: oh, hot!
[2012-02-16 15:06:00 -0500] jtimberman: https://github.com/jtimberman/veewee-templates
[2012-02-16 15:07:00 -0500] jtimberman: i'll probably ignore pull requests and issues, as i like them how they are. unless you have a fix for centos5 because my current box is brokn :)
[2012-02-16 15:26:00 -0500] till_: jtimberman: is there a way to manipulate node from within a ruby_block so i can use an attribute in the same recipe?
[2012-02-16 15:27:00 -0500] jtimberman: till_: what do you mean? You can access the node and its attributes anywhere in a recipe
[2012-02-16 15:27:00 -0500] jtimberman: node?
[2012-02-16 15:27:00 -0500] bawt: node is the abstraction of a system to be configured by chef. nodes contain a run list (recipes and/or roles to apply) and attributes (data about the node). See http://wiki.opscode.com/display/chef/Nodes
[2012-02-16 15:29:00 -0500] till_: jtimberman: basically this:
[2012-02-16 15:29:00 -0500] till_: i am installing php in one recipe
[2012-02-16 15:30:00 -0500] till_: in another i am trying to get a config var, so at first i did var = `php -r 'echo ini_get("foo");'`
[2012-02-16 15:30:00 -0500] till_: which fails during evaluation ;)
[2012-02-16 15:30:00 -0500] till_: so, i tried to wrap this var = `...` into ruby_block
[2012-02-16 15:30:00 -0500] till_: and write the result to node[:foo]
[2012-02-16 15:30:00 -0500] till_: but node[:foo] is not 'set' later in the recipe
[2012-02-16 15:30:00 -0500] till_: if this makes sense
[2012-02-16 15:30:00 -0500] till_: i basically do ruby_block where i set node[:foo]
[2012-02-16 15:31:00 -0500] till_: and after the ruby_block, i do, execute "blah node[:foo]"
[2012-02-16 15:31:00 -0500] till_: i checked node.to_so in and outside the ruby_block
[2012-02-16 15:31:00 -0500] till_: they seem to be different objects
[2012-02-16 15:33:00 -0500] yfeldblum: till_, it's awkward because it's fighting how chef is trying to work
[2012-02-16 15:33:00 -0500] yfeldblum: till_, chef says, you put into chef what you want the server to look like, and chef fashions the server in its image
[2012-02-16 15:34:00 -0500] yfeldblum: till_, chef doesn't ask the server how it's doing - instead, ohai asks the server how it's doing
[2012-02-16 15:34:00 -0500] till_: i am guessing the chef-way is writing a plugin for ohai and reloading ohai during the run?
[2012-02-16 15:34:00 -0500] yfeldblum: till_, so one approach is to make an ohai plugin
[2012-02-16 15:34:00 -0500] yfeldblum: till_, right
[2012-02-16 15:34:00 -0500] till_: it sounds painful and a little expensive (in terms of resources)
[2012-02-16 15:35:00 -0500] yfeldblum: till_, but that's just a general approach that may not apply to your case
[2012-02-16 15:35:00 -0500] till_: yfeldblum: https://github.com/till/easybib-cookbooks/blob/master/php-phar/recipes/default.rb#L39-L46
[2012-02-16 15:36:00 -0500] till_: i solved it with this now
[2012-02-16 15:36:00 -0500] timurs: Hi there
[2012-02-16 15:36:00 -0500] timurs: need some newbie help with chef/opscode
[2012-02-16 15:37:00 -0500] ssd7: "compile time" vs "run time" with node attrs is definitely "A Thing"
[2012-02-16 15:37:00 -0500] timurs: I've changed settings in cookbook and uploaded it to opscode
[2012-02-16 15:38:00 -0500] timurs: how can I implement that changes to server?
[2012-02-16 15:38:00 -0500] till_: ssd7: yeah, that's exactly my 'issue'
[2012-02-16 15:38:00 -0500] till_: or the wall i ran into
[2012-02-16 15:39:00 -0500] jtimberman: ohai is relatively lightweight, its just running the command to retrieve information
[2012-02-16 15:40:00 -0500] jtimberman: if it costs too many system cycles to invoke php, it probably isn't ohai :)
[2012-02-16 15:42:00 -0500] till_: jtimberman: my highscore for chef-solo runs is 2.4 GB
[2012-02-16 15:42:00 -0500] till_: are there any more 'complex' examples?
[2012-02-16 15:42:00 -0500] till_: for plugins
[2012-02-16 15:43:00 -0500] jtimberman: till_: memory usage?
[2012-02-16 15:43:00 -0500] till_: yeah
[2012-02-16 15:43:00 -0500] till_: hehe
[2012-02-16 15:43:00 -0500] jtimberman: what about for just "ohai"
[2012-02-16 15:43:00 -0500] yatesy: that's nuts!
[2012-02-16 15:43:00 -0500] till_: i meant, complex examples for ohai plugins
[2012-02-16 15:43:00 -0500] till_: more complex than the lolcode one
[2012-02-16 15:45:00 -0500] ssd7: till_: All of ohai works off teh same plugin system, so you can check out the ohai source for examples of more complex plugins
[2012-02-16 15:46:00 -0500] jtimberman: till_: sure
[2012-02-16 15:46:00 -0500] till_: https://github.com/opscode/ohai/tree/master/lib/ohai/plugins < this right?
[2012-02-16 15:46:00 -0500] jtimberman: https://gist.github.com/126f226b4868739d94bd
[2012-02-16 15:46:00 -0500] ssd7: till_: Yup.  Also, here is one I wrote recently, for pulling information from R: https://github.com/stevendanna/ohai-plugins/blob/master/r.rb
[2012-02-16 15:47:00 -0500] jtimberman: there's an example of a custom ohai plugin I use
[2012-02-16 15:47:00 -0500] ssd7: jtimberman: this is relevant to my interests, thanks :)
[2012-02-16 15:47:00 -0500] till_: mine too
[2012-02-16 15:47:00 -0500] till_: haha
[2012-02-16 15:47:00 -0500] till_: nice
[2012-02-16 15:47:00 -0500] till_: :)
[2012-02-16 15:48:00 -0500] jtimberman: oh snap i even did exception handling in that :)
[2012-02-16 15:53:00 -0500] kbader: ohai, any solaris cooks out there? I managed to get everything installed but when I run chef-client it seems to be stuck. Tracing chef-client with truss shows it  getting stuck doing this over and over: http://pastebin.com/gB0BkkCU
[2012-02-16 15:53:00 -0500] daschel: I'm not a vegetarian, but my wife is.  can anyone recommend a dish that i could surprise her with?
[2012-02-16 15:53:00 -0500] jtimberman: here's another one: https://gist.github.com/1040853
[2012-02-16 15:54:00 -0500] flashmanbahadur: daschel:  Sausage
[2012-02-16 15:54:00 -0500] flashmanbahadur: She'd never expect it
[2012-02-16 15:54:00 -0500] yatesy: daschel: i think you've misunderstood what this channel is for :)
[2012-02-16 15:54:00 -0500] daschel: flashmandahadur: im a dude and she's a lesbian
[2012-02-16 15:54:00 -0500] daschel: yatesy: maybe so.  what is this channel for?
[2012-02-16 15:55:00 -0500] jtimberman: daschel: depends on what she likes, and if she has any allergies or sensitivities.
[2012-02-16 15:55:00 -0500] flashmanbahadur: I'm so confused now too
[2012-02-16 15:55:00 -0500] daschel: jtimberman: well, she's a bitch and is allergic to nuts
[2012-02-16 15:56:00 -0500] jtimberman: daschel: this channel is about the Open Source software, "Chef" by Opscode. http://opscode.com/chef
[2012-02-16 15:56:00 -0500] daschel: holy shit
[2012-02-16 15:57:00 -0500] daschel: im entirely in the wrong place
[2012-02-16 15:57:00 -0500] jtimberman: But, I'm vegetarian and my wife is as well, and I'm happy to offer ideas :)
[2012-02-16 15:57:00 -0500] yatesy: heh
[2012-02-16 15:57:00 -0500] daschel: i was surprise that an irc channel was dedicated to cooking
[2012-02-16 15:57:00 -0500] daschel: i guess that's what beer does
[2012-02-16 15:57:00 -0500] jtimberman: probably not on irc.freenode.net
[2012-02-16 15:57:00 -0500] lflux: what about grilled eggplants with cheese
[2012-02-16 15:57:00 -0500] flashmanbahadur: jtimberman is always read to help
[2012-02-16 15:57:00 -0500] jtimberman: my favorite is black beans with brown rice or quinoa
[2012-02-16 15:57:00 -0500] jinnko: daschel: i guess nut roast is outta the question then
[2012-02-16 15:58:00 -0500] ssd7: daschel: I recently made sweet potatoe gnocci and chocolate suffle for my vegetarian wife
[2012-02-16 15:58:00 -0500] ssd7: came out very well
[2012-02-16 15:58:00 -0500] jtimberman: lather with salsa, maybe some good bbq sauce (Stone Brewing makes a great one that is available at like, Costco sometimes)
[2012-02-16 15:58:00 -0500] bobw: daschel: http://www.earth.li/~kake/cookery/recipes/caponata.html
[2012-02-16 15:58:00 -0500] jtimberman: wrap it all up in a bowl of lettuce
[2012-02-16 15:58:00 -0500] gmcinnes: arggh. anyone else find that chef-client sometimes wedges?
[2012-02-16 15:58:00 -0500] jtimberman: with grilled peppers and onions.
[2012-02-16 15:58:00 -0500] kbader: mm
[2012-02-16 15:59:00 -0500] flashmanbahadur: wedges?
[2012-02-16 15:59:00 -0500] gmcinnes: not potato wedges. or bbq sauce.
[2012-02-16 15:59:00 -0500] jtimberman: gmcinnes: like wedge salad
[2012-02-16 15:59:00 -0500] daschel: ssd7: i was actually thinking a pan-fried crispy gnocchi.  what do you know about that?
[2012-02-16 15:59:00 -0500] ssd7: daschel: I am a fan
[2012-02-16 16:00:00 -0500] ssd7: the dough can be hard to get right.
[2012-02-16 16:00:00 -0500] gmcinnes: wedges like it just gets stuck.  I look in client.log and I see the start of a run like: "[Wed, 15 Feb 2012 23:29:44 -0500] INFO: *** Chef 0.10.8 ***"
[2012-02-16 16:00:00 -0500] gmcinnes: and nothing after that. And it hasn't checked in to chef server since then.
[2012-02-16 16:00:00 -0500] ssd7: gmcinnes: Is that with debug logging on?
[2012-02-16 16:00:00 -0500] ssd7: Maybe something in Ohai is hanging?
[2012-02-16 16:00:00 -0500] gmcinnes: no. I think its only at info level.
[2012-02-16 16:00:00 -0500] daschel: i have to say, this is ridiculous.  i came into the wrong channel for cooking advice, but I'm getting plenty
[2012-02-16 16:00:00 -0500] gmcinnes: yeah. only info level.
[2012-02-16 16:01:00 -0500] daschel: ssd7, well, what do you know>
[2012-02-16 16:01:00 -0500] daschel: ?
[2012-02-16 16:01:00 -0500] gmcinnes: but I'm seeing the behaviour on centos 6.1 and ubuntu 10.04. As well, I'm seeing it against ruby 1.9.2 p290 and p180
[2012-02-16 16:02:00 -0500] jtimberman: daschel: oh, pan fried gnocci is awesome too
[2012-02-16 16:02:00 -0500] gmcinnes: will restart with chef client on debug level and see if I can get more info.
[2012-02-16 16:02:00 -0500] jtimberman: i've no knowledge how to make it though, but i've had it in NYC :)
[2012-02-16 16:02:00 -0500] ssd7: gmcinnes: great :)
[2012-02-16 16:02:00 -0500] daschel: i've made gnocchi several times, but i have no basis for pan frying it
[2012-02-16 16:03:00 -0500] daschel: wait a sec, why are you running 10.04?
[2012-02-16 16:03:00 -0500] gmcinnes: In the space of 24 hrs it's affected about 1/2 my machines, so it shouldn't be long to get more info :)
[2012-02-16 16:03:00 -0500] gmcinnes: LTS
[2012-02-16 16:04:00 -0500] daschel: man...you guys are drunk
[2012-02-16 16:04:00 -0500] gmcinnes: I wish.
[2012-02-16 16:05:00 -0500] ssd7: daschel: 10.04 is pretty common on servers.  People like running LTSes
[2012-02-16 16:05:00 -0500] ssd7: At least that is the impression I get.
[2012-02-16 16:05:00 -0500] daschel: to respond to gmcinnes and ssd7, i was talking about me
[2012-02-16 16:05:00 -0500] daschel: but yes, the new long term support won't come out for a couple more months
[2012-02-16 16:05:00 -0500] gmcinnes: slows down the hamster wheel of breakage a bit.
[2012-02-16 16:06:00 -0500] daschel: april i believe
[2012-02-16 16:07:00 -0500] gmcinnes: hmm. wait a minute. what would happen if the chef-client was already dameonized and running and then I ran it at the cmd line.
[2012-02-16 16:07:00 -0500] gmcinnes: Would that give it a reason to wedge?
[2012-02-16 16:08:00 -0500] kbader: gmcinnes: shouldn't
[2012-02-16 16:09:00 -0500] yatesy: should be ok, although i have no idea if fun things happen if the daemonized version happened to be in the middle of a run at the same time
[2012-02-16 16:09:00 -0500] gmcinnes: yeah :)
[2012-02-16 16:10:00 -0500] gmcinnes: awww. knife ssh ftw.
[2012-02-16 16:10:00 -0500] gmcinnes: awesome
[2012-02-16 16:11:00 -0500] ssd7: Yeah if the two runs are moving concurrently, you can get wierdness, mostly relate to underlying tools (apt locks, other locks, etc (but mostly locks))
[2012-02-16 16:12:00 -0500] yatesy: would almost make sense to have a lock file somewhere that's active during a run to make sure that behaviour doesn't happen
[2012-02-16 16:12:00 -0500] BryanWB: any java kings around? where can I get I persistence.jar w/out having to agree to some license agreement ?
[2012-02-16 16:12:00 -0500] gerardc: Is there some abstraction out there for generating shadow hashes? Id like to put a password in an encrypted databag, but then my recipe must compute the shadow hash before passing it to the user resource (resource is right term?)
[2012-02-16 16:12:00 -0500] BryanWB: there he is -> lusis , any idea?
[2012-02-16 16:13:00 -0500] BryanWB: u r a java mastermind after all ;)
[2012-02-16 16:18:00 -0500] jtimberman: BryanWB: trollin' lusis with java is a great way to get him riled up ;)
[2012-02-16 16:19:00 -0500] BryanWB: jtimberman: i love riling him up! so much fun :)
[2012-02-16 16:28:00 -0500] jtimberman: actually, a better version of the ohai plugin for semantic attribute naming for interface IP addresses: https://gist.github.com/1040543
[2012-02-16 16:29:00 -0500] KarlHungus: i git clone a repo to /tmp or somewhere like that in a recipe, then i want to copy a file from that repo to /usr/local/bin. i only want to trigger a service to restart if the file changes. is there a clean way to do this?
[2012-02-16 16:29:00 -0500] KarlHungus: can i source a file using the file resource from a local path?
[2012-02-16 16:34:00 -0500] till_: jtimberman: so whatever is last, is then put into node[] ?
[2012-02-16 17:12:00 -0500] lxhunter: Hello everyone! I got a question: I am trying to set an attribute to an dynamic value, lets say for mysql::server the innodb_buffer_pool_size to 3/4 of the total memory. Is there a way i can do that? And if so, how and if not is it a stupid idea?
[2012-02-16 17:14:00 -0500] lxhunter: doing something like node['memory']['total'] * 0.75 in the attributes
[2012-02-16 17:15:00 -0500] mlei: lxhunter: that ought to work but you need to do node['memory']['total'].to_i
[2012-02-16 17:15:00 -0500] mlei: before you can do arithmetic on it
[2012-02-16 17:16:00 -0500] lxhunter: thanks, the operation does work but not in ruby dsl for the attributes
[2012-02-16 17:16:00 -0500] lxhunter: like in the role
[2012-02-16 17:16:00 -0500] lxhunter: where i would like to set it
[2012-02-16 17:16:00 -0500] mlei: oh, i see. i was thinking you were doing it in a cookbook...
[2012-02-16 17:17:00 -0500] lxhunter: i should have put that more clearly ;)
[2012-02-16 17:17:00 -0500] mlei: but actually i'm not positive that would work either, haven't tried it
[2012-02-16 17:18:00 -0500] lxhunter: where would you do such a calculation? recipe?
[2012-02-16 17:20:00 -0500] jbz: Is there a way to set a particular node attribute with knife?  WIthout having to upload a full json of the node state?
[2012-02-16 17:20:00 -0500] jbz: Or is there a way to set an 'ablative' attribute using a file or something so that it will only load once?
[2012-02-16 17:39:00 -0500] geekbri: yfeldblum: I'm loving librarian by the way
[2012-02-16 17:43:00 -0500] gmcinnes: Hmm. Chef-client processes still wedging.  I don't see anything immediately interesting in the client.log even at debug level. ssd7 yfeldblum can one of you help?
[2012-02-16 17:44:00 -0500] jbz: gmcinnes: Are they wedging at the same point?
[2012-02-16 17:44:00 -0500] gmcinnes: unfortunately not.
[2012-02-16 17:44:00 -0500] jbz: gmcinnes:  Are you on linux?
[2012-02-16 17:45:00 -0500] gmcinnes: yes. Ubutntu 10.04 and Centos 6.1
[2012-02-16 17:45:00 -0500] itwasntandy: hrm
[2012-02-16 17:45:00 -0500] jbz: gmcinnes: If you're at all unsure of RAM, check system log for OOM-killer messages.  I've had chef-client runs killed due to resource starvation
[2012-02-16 17:45:00 -0500] gmcinnes: ruby 1.9.2 p290 and rugy 1.9.2 p180 respectively
[2012-02-16 17:45:00 -0500] gmcinnes: ah. good idea
[2012-02-16 17:46:00 -0500] itwasntandy: with remote_file is there a way to tell it to source a file from another mount point on the node? (e.g. a nfs mount)
[2012-02-16 17:46:00 -0500] itwasntandy: if I just give the path, it thinks its a cookbook book file seemingly
[2012-02-16 17:46:00 -0500] gmcinnes: no. nothing like that mentioned. Also, the chef-client process is still running.  Doesn't the oom monster usually just slay the whole process?
[2012-02-16 17:47:00 -0500] jbz: gmcinnes: Yes, it does.  So the chef-client daemon (are you running daemon?) is still there?  Is it Zombied, or just 'Running' and consuming cycles?
[2012-02-16 17:48:00 -0500] gmcinnes: looks fine to me. Not zombied
[2012-02-16 17:49:00 -0500] jbz: Is it running or sleeping?
[2012-02-16 17:49:00 -0500] gmcinnes: sleeping
[2012-02-16 17:49:00 -0500] jbz: hmmmm
[2012-02-16 17:49:00 -0500] gmcinnes: Sl
[2012-02-16 17:49:00 -0500] jbz: so when it wedges, what's the symptom?  It just stops in the middle of a run with no warning?
[2012-02-16 17:49:00 -0500] gmcinnes: yup.
[2012-02-16 17:49:00 -0500] jbz: ...ouch.
[2012-02-16 17:50:00 -0500] gmcinnes: I can pastie. Do you want the debug level output of the whole dead chef run?
[2012-02-16 17:50:00 -0500] jbz: sure
[2012-02-16 17:50:00 -0500] jbz: Happy to have a look, FWIW
[2012-02-16 17:50:00 -0500] gmcinnes: or just the last call?
[2012-02-16 17:50:00 -0500] jbz: drop the ton
[2012-02-16 17:50:00 -0500] jbz: let's see it all
[2012-02-16 17:51:00 -0500] gmcinnes: when you're done with this, I have some hot salty forks to stick in your eyes
[2012-02-16 17:51:00 -0500] gmcinnes: should be less painful :)
[2012-02-16 17:53:00 -0500] jbz: hahaha
[2012-02-16 17:55:00 -0500] AntonZ: goodmorning
[2012-02-16 17:56:00 -0500] AntonZ: any chance someone can have a quick pick at this error message and give me a hint what could possibly cause this: https://gist.github.com/1839310
[2012-02-16 17:56:00 -0500] jbz: Damn Safari.  Now the 'Back' button reverts not to the last state of the previous page, but the initial state - so if you'd been sitting on a page doing AJAX transforms, you're hosed.
[2012-02-16 17:58:00 -0500] AntonZ: i run my cookbook that has two dependencies, first of them is aws
[2012-02-16 17:58:00 -0500] AntonZ: added more info to the gist
[2012-02-16 17:59:00 -0500] jbz: AntonZ:  Wait, it says you're missing that gem.  Is it being installed?
[2012-02-16 18:00:00 -0500] AntonZ: the gem is part of aws - thats my understanding
[2012-02-16 18:00:00 -0500] AntonZ: if the gem is part of something else, im curious what it is
[2012-02-16 18:01:00 -0500] gmcinnes: jbz: ok. I restarted all my chef-clients an hour and 50 minutes ago. Out of my 13 nodes, 4 are wedged already.  Here's the chef-client logs of the 4 that got wedged https://gist.github.com/1846747
[2012-02-16 18:01:00 -0500] gmcinnes: I don't see anything interesting in them, other than the fact that they stopped halfway through a run.
[2012-02-16 18:01:00 -0500] gmcinnes: They all stopped at different places.
[2012-02-16 18:02:00 -0500] jbz: gmcinnes: perusing.
[2012-02-16 18:02:00 -0500] itwasntandy: anyone got any ideas on my remote_file condundrum?
[2012-02-16 18:03:00 -0500] gmcinnes: itwasntandy: I must have missed it.
[2012-02-16 18:03:00 -0500] itwasntandy: (i.e. when trying to source a file from another mount point (nfs mounted) on the node... )
[2012-02-16 18:03:00 -0500] itwasntandy: I assumed I could just give the path - but remote file takes that to mean path within the cookbook
[2012-02-16 18:04:00 -0500] itwasntandy: and it doesn't seem to like a file:// uri either.
[2012-02-16 18:05:00 -0500] jbz: itwasntandy:  remote_file is intended to install a file that is not presently on the node onto the node.  If you want to move a file around that is in fact already there, you may have to use an execute resource with a not_if, AFAIK.
[2012-02-16 18:05:00 -0500] itwasntandy: this is going to cause some messyness
[2012-02-16 18:06:00 -0500] itwasntandy: (in dev envs, we pull from artifactory, hence already using remote_file.. the case statements for environments will be interesting if I have to do it someother way
[2012-02-16 18:06:00 -0500] itwasntandy: in prod - where we have nfs)
[2012-02-16 18:07:00 -0500] jbz: AntonZ:  Do you have the option of installing chef >= 0.10?
[2012-02-16 18:07:00 -0500] jbz: I found a question about a similar error online and the 'answer' was 'obsolete chef version.'
[2012-02-16 18:08:00 -0500] jbz: gmcinnes: Er, wow.  I can't see any common problem therethey're not all failing on network access, e.g....
[2012-02-16 18:08:00 -0500] AntonZ: jbz - i dont have such option as chef is a hosted solution by RightScale
[2012-02-16 18:09:00 -0500] jbz: AntonZ:  Ah.
[2012-02-16 18:09:00 -0500] AntonZ: any cnace you can send me the link to what you found ?
[2012-02-16 18:09:00 -0500] jbz: AntonZ:  If you get onto the node and do gem list right-aws --remote what do you get?
[2012-02-16 18:10:00 -0500] jbz: AntonZ: link: http://community.opscode.com/questions/28
[2012-02-16 18:10:00 -0500] gmcinnes: jbz: I know. It's giving me the fear.
[2012-02-16 18:10:00 -0500] AntonZ: [root@ip-10-0-0-10 ~]# gem list right-aws --remote
[2012-02-16 18:10:00 -0500] AntonZ: *** REMOTE GEMS ***
[2012-02-16 18:10:00 -0500] AntonZ: [root@ip-10-0-0-10 ~]#
[2012-02-16 18:10:00 -0500] jbz: gmcinnes: Yeah.  Not cool at all. :-/
[2012-02-16 18:10:00 -0500] gmcinnes: And they're not even the same ruby version or OS.
[2012-02-16 18:10:00 -0500] jbz: AntonZ:  Hm.how about local?  gem list right-aws?
[2012-02-16 18:11:00 -0500] jbz: wait I screwed that up
[2012-02-16 18:11:00 -0500] jbz: right_aws with an underscore
[2012-02-16 18:11:00 -0500] AntonZ: local is emty as well
[2012-02-16 18:11:00 -0500] AntonZ: oh let me do it again :)
[2012-02-16 18:11:00 -0500] jbz: gmcinnes: Are these nodes acting wacky any other way, or is it just chef?
[2012-02-16 18:11:00 -0500] AntonZ: [root@ip-10-0-0-10 ~]# gem list right_aws --remote
[2012-02-16 18:11:00 -0500] AntonZ: *** REMOTE GEMS ***
[2012-02-16 18:11:00 -0500] AntonZ: right_aws (2.1.0)
[2012-02-16 18:11:00 -0500] AntonZ: right_aws-yodal (1.10.11)
[2012-02-16 18:11:00 -0500] AntonZ: [root@ip-10-0-0-10 ~]#
[2012-02-16 18:11:00 -0500] AntonZ: local is empty
[2012-02-16 18:12:00 -0500] jbz: AntonZ: Ahhh!
[2012-02-16 18:12:00 -0500] gmcinnes: they seem totally fine.
[2012-02-16 18:12:00 -0500] jbz: AntonZ:  Just as an experiment, try installing that gem and seeing if the run completes. If it does, then you'll probably have to put that gem install into your runlist and maybe do the gem.path clear magic.
[2012-02-16 18:12:00 -0500] leifmadsen: quick question: is the Execute resource the only method of modifying/copying files on a node? (I'm talking files on the file system itself of the node, not via the cookbook_file resource, etc from Chef recipe)
[2012-02-16 18:12:00 -0500] gmcinnes: and given long enough it seems it will afffect every node.
[2012-02-16 18:13:00 -0500] dasickis: when does the following arise: "ArgumentError: Attribute deploy is not defined!"?
[2012-02-16 18:13:00 -0500] jbz: leifmadsen: If you just want to put stuff *into* a file, you can use the 'content' attribute on the 'file' resource
[2012-02-16 18:13:00 -0500] dasickis: i've tried to google it but was unable to find anything
[2012-02-16 18:13:00 -0500] jbz: (I think)
[2012-02-16 18:13:00 -0500] gmcinnes: since the nodes that were affected now are a different set from the ones that were affected previously.  I restarted them all at 11:10 to turn the log level up to debug
[2012-02-16 18:13:00 -0500] AntonZ: jbz - let me try and figure out how to do that, this is all new to me :)
[2012-02-16 18:14:00 -0500] AntonZ: thanks for the help!
[2012-02-16 18:14:00 -0500] leifmadsen: jbz: thanks I'm going to look at that; can I do the equivalent of a 'cat foo.txt > bar.txt' with it?
[2012-02-16 18:14:00 -0500] jbz: AntonZ: yw.  Look into just putting 'gem_package' into the recipes somewhere, probably into the AWS default recipe.
[2012-02-16 18:15:00 -0500] jbz: leifmadsen: I don't see why notyou might need to do it in Ruby, but should work.  Be warned - any code you use to create the content will run at compile phase, not execute phase, so if you're doing other resources and depending on their results being available, you might have a problem.
[2012-02-16 18:16:00 -0500] AntonZ: jbz - interestngly that aws already has this package defined:
[2012-02-16 18:16:00 -0500] jbz: dasickis: Can you pastie or gist the full error?
[2012-02-16 18:16:00 -0500] AntonZ: r = gem_package "right_aws" do
[2012-02-16 18:16:00 -0500] AntonZ:   version node['aws']['right_aws_version']
[2012-02-16 18:16:00 -0500] AntonZ:   action :nothing
[2012-02-16 18:16:00 -0500] AntonZ: end
[2012-02-16 18:16:00 -0500] leifmadsen: jbz: ah gotcha, then ya that could be a problem perhaps. I'm basically using the git resource to checkout the configuration of a service, then using execute resource to copy the files from the checkout to their specific locations that the service is going to read from
[2012-02-16 18:16:00 -0500] jbz: AntonZ: Well, action :nothing means it's not installing, unless something else is calling that resource with :install
[2012-02-16 18:17:00 -0500] jbz: AntonZ:  is there an r.install or something right after that?
[2012-02-16 18:17:00 -0500] AntonZ: what is the right action for install? do i just changed nothing to :install ?
[2012-02-16 18:17:00 -0500] jbz: Well, before you try that, see if it's trying to install somewhere else
[2012-02-16 18:17:00 -0500] AntonZ: r = gem_package "right_aws" do
[2012-02-16 18:17:00 -0500] AntonZ:   version node['aws']['right_aws_version']
[2012-02-16 18:17:00 -0500] AntonZ:   action :nothing
[2012-02-16 18:17:00 -0500] AntonZ: end
[2012-02-16 18:17:00 -0500] AntonZ: r.run_action(:install)
[2012-02-16 18:17:00 -0500] AntonZ: require 'rubygems'
[2012-02-16 18:17:00 -0500] AntonZ: Gem.clear_paths
[2012-02-16 18:17:00 -0500] AntonZ: require 'right_aws'
[2012-02-16 18:17:00 -0500] jbz: Oh, no, that's supposed to be installing it
[2012-02-16 18:17:00 -0500] AntonZ: this is full default.rb
[2012-02-16 18:17:00 -0500] AntonZ: right
[2012-02-16 18:18:00 -0500] jbz: ah, but if your run is failing during compile phase, it won't have reached that point. :-P
[2012-02-16 18:18:00 -0500] jbz: Hm
[2012-02-16 18:18:00 -0500] jbz: chicken/egg.
[2012-02-16 18:18:00 -0500] jbz: Is that cookbook earlier in the runlist than the one that's throwing the error?
[2012-02-16 18:18:00 -0500] AntonZ: aws is the very first dependecy in my cookbook
[2012-02-16 18:19:00 -0500] jbz: leifmadsen: Yeah, you're going to have issues then, I think - the compile phase will determine what the content is (I THINK, not positive) and then the execute will write it outso if the content isn't available yet, might be an issue...
[2012-02-16 18:19:00 -0500] jbz: AntonZ: Not dependency, is it in the *runlist*?
[2012-02-16 18:20:00 -0500] jbz: Dependency just means it has to be available.  It won't run unless it's in the runlist.
[2012-02-16 18:20:00 -0500] AntonZ: https://gist.github.com/1846841
[2012-02-16 18:20:00 -0500] AntonZ: oh hmmm
[2012-02-16 18:20:00 -0500] AntonZ: i didnt think about that... where do i denfine runlist for a cookbook ?
[2012-02-16 18:20:00 -0500] jbz: You don't, runlist is for a node
[2012-02-16 18:20:00 -0500] jbz: or for a role
[2012-02-16 18:21:00 -0500] jbz: Using bootstrap or knife or the server interface or API you need to define a runlist.  Where did you tell the node to run your cookbook?
[2012-02-16 18:21:00 -0500] AntonZ: and is that something that controlled from chef server or can be defined from withthin my cvookbook ?
[2012-02-16 18:21:00 -0500] dasickis: hey jbz: it was a weird hostname issue turns when i was configuring vagrant
[2012-02-16 18:21:00 -0500] jbz: The runlist can be modified from within a cookbook but it should only be done in very special circumstances
[2012-02-16 18:22:00 -0500] jbz: dasickis: Ahhh!
[2012-02-16 18:22:00 -0500] AntonZ: through rightScale interface, they have interface for that, but i dont want to use their interface, i want to do it independanly if possible
[2012-02-16 18:22:00 -0500] leifmadsen: jbz: where can I read about the order of phases and what is done at each phase? if the git resource is used prior to the file resource, then ya it could work potentially
[2012-02-16 18:22:00 -0500] jbz: Anatomy of a Chef Run?
[2012-02-16 18:22:00 -0500] jbz: hm
[2012-02-16 18:22:00 -0500] jbz: bawt no listen to me, one sec, leif
[2012-02-16 18:23:00 -0500] jbz: leifmadsen: http://wiki.opscode.com/display/chef/Anatomy+of+a+Chef+Run
[2012-02-16 18:23:00 -0500] leifmadsen: jbz: :D
[2012-02-16 18:23:00 -0500] leifmadsen: jbz: thanks, much obliged
[2012-02-16 18:23:00 -0500] jbz: AntonZ: The runlist is pretty much the core of how you control a node
[2012-02-16 18:23:00 -0500] jbz: AntonZ: If Rightscale gives you an interface to modify the runlist, that's pretty much what you should use.
[2012-02-16 18:23:00 -0500] jbz: leifmadsen: yw!
[2012-02-16 18:24:00 -0500] AntonZ: can i invoke it from cookbook or it will be too much pain in the butt ?
[2012-02-16 18:24:00 -0500] leifmadsen: jbz: ok ya, with further thought that might not necessary work either with what I'm thinking; the way I'm thinking of doing it would make more sense with a template. But thanks for the thought experiment.
[2012-02-16 18:24:00 -0500] jbz: AntonZ:  You can put an 'include' into your cookbook.
[2012-02-16 18:24:00 -0500] AntonZ: does it go to metadata.json file ?
[2012-02-16 18:25:00 -0500] jbz: AntonZ: No, includes go into recipes, they happen in order
[2012-02-16 18:25:00 -0500] AntonZ: oh
[2012-02-16 18:25:00 -0500] AntonZ: okay
[2012-02-16 18:25:00 -0500] jbz: AntonZ: So in the ebs_mount::default recipe, e.g., at the top you'd put include 'aws'
[2012-02-16 18:25:00 -0500] jbz: that would cause the AWS::Default recipe to be executed at that point.
[2012-02-16 18:26:00 -0500] AntonZ: what if i have more dependencies to run, do i list them with comma? include aws, xfs ?
[2012-02-16 18:26:00 -0500] jbz: Antonz:  No, they should each be given an include statement.
[2012-02-16 18:27:00 -0500] gmcinnes: Anyone else feeling particularly masochistic today? yfeldblum?
[2012-02-16 18:27:00 -0500] jbz: Antonz: But remember:  this isn't really 'dependencies', this is shortcut for including that whole recipe into the run at that point.
[2012-02-16 18:27:00 -0500] jbz: gmcinnes: Sorry I couldn't be more helpful
[2012-02-16 18:27:00 -0500] AntonZ: understood, adding include to my recipe and re-running :), will be back in 10 with news :)
[2012-02-16 18:27:00 -0500] jbz: :-)
[2012-02-16 18:28:00 -0500] AntonZ: oh last question, if i do include in my recipe, do i need to define dependencies in my metada file or it's not needed anymore ?
[2012-02-16 18:28:00 -0500] jbz: leifmadsen:  If you have the information available when the run starts, I'd *always* use a template, it's cleaner...
[2012-02-16 18:28:00 -0500] jbz: AntonZ:  Yes, you need them. The dependencies tell Chef to load that cookbook to the node, and the include actually calls it.
[2012-02-16 18:29:00 -0500] jbz: If you don't have the dependency, the cookbook you call won't be there and you'll get an error.
[2012-02-16 18:29:00 -0500] gmcinnes: jbz: don't sweat it at all.  It's a doozie.
[2012-02-16 18:30:00 -0500] jbz: gmcinnes: did jive.staging really die immediately after the run start log statement? :-P
[2012-02-16 18:30:00 -0500] leifmadsen: jbz: ya the problem is that the configuration is going to live in a separate repository and not be part of the chef-recipe
[2012-02-16 18:31:00 -0500] miah: moin
[2012-02-16 18:31:00 -0500] jbz: leifmadsen: There's a hack
[2012-02-16 18:31:00 -0500] jbz: leifmadsen: You could 'create' the template resource inside an execute block (I think) and then call the execute block *after* the git checkout
[2012-02-16 18:31:00 -0500] jbz: I'm not positive but I *think* that resources defined inside execute blocks don't get defined until the execute phase
[2012-02-16 18:32:00 -0500] gmcinnes: jbz:  yes, as far as I can tell.
[2012-02-16 18:32:00 -0500] leifmadsen: jbz: how would I create the template resource... I mostly follow
[2012-02-16 18:32:00 -0500] jbz: leifmadsen: So you have an 'execute' block, and inside the code block you put the template resource.  Then you have the git checkout 'notify' that execute block to run.
[2012-02-16 18:33:00 -0500] jbz: I am not 100% positive this will work :-{
[2012-02-16 18:33:00 -0500] jbz: but I think it will.
[2012-02-16 18:33:00 -0500] jbz: If it does work as I expect, then the template resource (or the file resource, whatever) won't get 'built' until the execute phase, which means that any code which sets the contents of the file won't be evaluated until *after* the git checkout happened.
[2012-02-16 18:34:00 -0500] jbz: Note:  This seems hackish even to me :-) but I can't think of a better option at the moment.
[2012-02-16 18:34:00 -0500] jbz: bbiab, bio
[2012-02-16 18:34:00 -0500] leifmadsen: jbz: interesting... if not perhaps more complicated than I need :)
[2012-02-16 18:35:00 -0500] leifmadsen: I think I'm going to just copy the files around using execute resource, then write a separate script to run at the end to control how the files are actually reloaded on the node
[2012-02-16 18:35:00 -0500] leifmadsen: it feels like I need to build my own resource method...
[2012-02-16 18:35:00 -0500] leifmadsen: anyways, back to some php stuffz
[2012-02-16 18:38:00 -0500] tmichael: trying to do gem_package install. chef installs in diff installation directory than if i gem install via CLI.  what's the best way to get chef to emulate command line gem install?  or is that not what i want to do?  i'm a gem newbie so appreciate any advice.
[2012-02-16 18:45:00 -0500] miah: would anybody have a handy pointer to how you would copy a directory (say, a cookbook) to its own git repository with all of that directories history?
[2012-02-16 18:48:00 -0500] AntonZ: jbz - it still failed, here it is: https://gist.github.com/1839310
[2012-02-16 18:50:00 -0500] AntonZ: also here is how my recipe looks like now: https://gist.github.com/1846841
[2012-02-16 18:52:00 -0500] AntonZ: looks like the runlist didnt grab my include statements
[2012-02-16 18:55:00 -0500] miah: include_recipe
[2012-02-16 18:56:00 -0500] AntonZ: is that what im missing :) ?
[2012-02-16 18:56:00 -0500] miah: yes
[2012-02-16 18:56:00 -0500] AntonZ: ahh-ha! thanks you kindly!
[2012-02-16 18:56:00 -0500] jbz: AntonZ:  Oh, indeed, my bad.
[2012-02-16 18:56:00 -0500] AntonZ: :0, no worries
[2012-02-16 18:57:00 -0500] kallistec: tmichael: by default, chef installs gems to the rubygems repo it runs out of
[2012-02-16 18:57:00 -0500] kallistec: there's an option to set which copy of the gem command to use
[2012-02-16 19:04:00 -0500] dwhsix: not sure if this is really a chef issue, or rvm, or...
[2012-02-16 19:04:00 -0500] dwhsix: anyone using rvm to handle ruby on their chef ec2 instances?
[2012-02-16 19:04:00 -0500] dwhsix: I'm having trouble in taht root doesn't use the rvm ruby
[2012-02-16 19:04:00 -0500] jbz: dwhsix: We tried, but never got it to work.
[2012-02-16 19:04:00 -0500] jbz: Yeah, that was part of it.
[2012-02-16 19:04:00 -0500] dwhsix: jbz: ugh
[2012-02-16 19:05:00 -0500] dwhsix: not what I wanted to hear ;-)
[2012-02-16 19:05:00 -0500] jbz: We ended up having to install ruby versions prior to the first Chef run, during bootstrap.
[2012-02-16 19:05:00 -0500] jbz: Sorry. :-/  We're not the brightest bears out there, though.
[2012-02-16 19:05:00 -0500] dwhsix: yeah, that's sort of what I do at the moment.
[2012-02-16 19:05:00 -0500] dwhsix: have an AMI I built, where I pre-installed ruby 1.9.2
[2012-02-16 19:06:00 -0500] dwhsix: was trying to avoid having to re-do that for 1.9.3
[2012-02-16 19:06:00 -0500] dwhsix: since I'll then have to migrate servers
[2012-02-16 19:06:00 -0500] jbz: We built ruby packages (apt, using Ubuntu) and then rip out the system ruby in the bootstrap and install the one our users selected (we have a console to handle infrastructure).
[2012-02-16 19:06:00 -0500] dwhsix: nice
[2012-02-16 19:07:00 -0500] dwhsix: are your ruby packages publicly available?
[2012-02-16 19:07:00 -0500] jbz: Yeah, it's easier for us - we explicitly always use the current Canonical AMIs to avoid having to manage them.
[2012-02-16 19:07:00 -0500] jbz: They may be, but I strongly recommend you just build your ownjtimberman had an excellent blog post about doing it quickly and simply, lemme see if I can find it.
[2012-02-16 19:07:00 -0500] dwhsix: cool
[2012-02-16 19:09:00 -0500] dwhsix: seems to me if you did go the rvm route, if yuo could change all 'sudo's to 'rvmsudo' you'd be all set
[2012-02-16 19:09:00 -0500] jbz: dwhsix: here http://jtimberman.posterous.com/debianubuntu-package-for-ruby-192-with-fpm
[2012-02-16 19:09:00 -0500] dwhsix: jbz: did you guys look at that?
[2012-02-16 19:09:00 -0500] jbz: dwhsix: We couldn't get rvm to behave consistently, so we never even got to the 'how to fix it' stage.
[2012-02-16 19:09:00 -0500] dwhsix: oof
[2012-02-16 19:09:00 -0500] dwhsix: ok - thx for the link
[2012-02-16 19:09:00 -0500] jbz: Our problem involved having Chef running in one ruby, having to pivot to another - that just made things all wacky.
[2012-02-16 19:10:00 -0500] dwhsix: ah
[2012-02-16 19:10:00 -0500] dwhsix: my case might be simpler if I can use 1.9.3 globally, I'd be fine
[2012-02-16 19:11:00 -0500] jbz: If we didn't pivot, then the ruby/gems stuff done in chef weren't applicable properly.
[2012-02-16 19:17:00 -0500] AntonZ: well, not sure what's up: https://gist.github.com/1839310
[2012-02-16 19:18:00 -0500] AntonZ: thats my recipe now: https://gist.github.com/1846841
[2012-02-16 19:18:00 -0500] AntonZ: it's almost like runlist gets ignored, or rather the include statements
[2012-02-16 19:20:00 -0500] jbz: AntonZ: In the bash resource, shouldn't the 'user' attribute be *outside* the code block?
[2012-02-16 19:21:00 -0500] jbz: AntonZ: Also, not sure this is an issue, but I'd try naming the bash resouce something much simpler, without a colon in it.  Just because I'm paranois.
[2012-02-16 19:21:00 -0500] jbz: *paranoid.
[2012-02-16 19:22:00 -0500] AntonZ: jbz, im sorry im not 100% clear what you are referring to ?
[2012-02-16 19:22:00 -0500] jbz: In your recipe, you have a bash resource named "Changing the owner:group for repositories"
[2012-02-16 19:22:00 -0500] AntonZ: oh oh
[2012-02-16 19:22:00 -0500] jbz: I'd try changing that to something like "repo-ownership" as a test
[2012-02-16 19:22:00 -0500] jbz: also
[2012-02-16 19:23:00 -0500] jbz: the 'user = "root"' statement isn't part of the bash code, right?  It's part of the resource?
[2012-02-16 19:23:00 -0500] AntonZ: i mean for test purposes i could just comment those whole thing out
[2012-02-16 19:24:00 -0500] AntonZ: but how does it effect the run list
[2012-02-16 19:24:00 -0500] AntonZ: affect
[2012-02-16 19:24:00 -0500] jbz: That error doesn't look runlist related.
[2012-02-16 19:24:00 -0500] mlei: AntonZ: shouldn't the recipe name be in quotes
[2012-02-16 19:24:00 -0500] AntonZ: it still says right_aws is missing
[2012-02-16 19:25:00 -0500] jbz: But if there are other errors in your recipes, then the run won't succeed
[2012-02-16 19:25:00 -0500] jbz: oh yeah
[2012-02-16 19:25:00 -0500] jbz: AntonZ: Yes, because it's never getting to the point where it installs it.
[2012-02-16 19:25:00 -0500] mlei: i think it's looking for a variable called "aws"
[2012-02-16 19:25:00 -0500] mlei: and not finding it
[2012-02-16 19:25:00 -0500] jbz: It's breaking before that.
[2012-02-16 19:25:00 -0500] jbz: mlei ftw
[2012-02-16 19:25:00 -0500] AntonZ: well, the thing is i know if i define my run list in rightScale interface everything works like a charm
[2012-02-16 19:25:00 -0500] mlei: should be: include_recipe "mycookbookname::aws"
[2012-02-16 19:26:00 -0500] AntonZ: include_recipe "mycookbookname::aws" - i havent tried that yet
[2012-02-16 19:26:00 -0500] mlei: obviously replace mycookbookname with your actual cookbook's name
[2012-02-16 19:27:00 -0500] AntonZ: mlei - aws is a cookbook, so id change my coookbook name to "include ebs_mount::aws" ?
[2012-02-16 19:28:00 -0500] mlei: oh, i see. perhaps "aws::default"?
[2012-02-16 19:28:00 -0500] AntonZ: ebs_mount is the name of my cookbook that im working with and trying to include aws cookbook in its runlist
[2012-02-16 19:28:00 -0500] mlei: you could also try just "aws"
[2012-02-16 19:28:00 -0500] mlei: that would probably work
[2012-02-16 19:28:00 -0500] mlei: i was thinking aws was a recipe in your cookbook.
[2012-02-16 19:29:00 -0500] AntonZ: no, aws is a cookbook that has to run first thing, it's a dependency for my cookbook
[2012-02-16 19:29:00 -0500] mlei: ah. i think try: include_recipe "aws"
[2012-02-16 19:29:00 -0500] mlei: if that doesn't work then "aws::default"
[2012-02-16 19:29:00 -0500] AntonZ: thats what i have right now: include_recipe aws
[2012-02-16 19:29:00 -0500] AntonZ: include_recipe xfs
[2012-02-16 19:29:00 -0500] AntonZ: i dont have quotes
[2012-02-16 19:29:00 -0500] mlei: you need quotes
[2012-02-16 19:29:00 -0500] AntonZ: okay, trying
[2012-02-16 19:30:00 -0500] mlei: otherwise it will try to process it as a variable
[2012-02-16 19:30:00 -0500] LawrenceSeattle: I have a problem where the client sticks around after killing an EC2.  Any way to make the second boot take over the client?  Or wipe it if it exists?
[2012-02-16 19:31:00 -0500] mlei: you mean, the second boot tries to generate a client with the same name? or what?
[2012-02-16 19:33:00 -0500] LawrenceSeattle: miel: Yea, same name
[2012-02-16 19:34:00 -0500] mlei: hmm. you'd have to get rid of it beforehand... or find some way of keeping the client.pem around and sticking it on the second box.
[2012-02-16 19:34:00 -0500] LawrenceSeattle: I'm using cluster_chef and it isn't removing it :(
[2012-02-16 19:35:00 -0500] mlei: removing the client is probably easier, could script a knife command for that which would execute around when you bring up the box again.
[2012-02-16 19:35:00 -0500] mlei: no idea about cluster_chef, sorry /-:
[2012-02-16 19:36:00 -0500] LawrenceSeattle: thx.  Yea this thing is almost what I want but a lot of usability issues
[2012-02-16 19:37:00 -0500] geekbri: LawrenceSeattle: I also had issues with cluster-chef and gave up on it for that reason :)
[2012-02-16 19:39:00 -0500] LawrenceSeattle: it's almost like this stuff wasn't ever tested in a normal environment
[2012-02-16 19:40:00 -0500] LawrenceSeattle: what do people use to configure clusters?
[2012-02-16 19:47:00 -0500] AntonZ: interesngtly, even though i still get failures and errors, the volume got mounted
[2012-02-16 19:48:00 -0500] AntonZ: somehow, i got two volumes mounted, smae volume ID, two difefrent devices on the node
[2012-02-16 19:50:00 -0500] yfeldblum: gmcinnes, what's up?
[2012-02-16 19:50:00 -0500] mlei: antonz: pastie/gist the output of mount
[2012-02-16 19:50:00 -0500] mlei: and your chef run output
[2012-02-16 19:50:00 -0500] gmcinnes: yfeldblum: I don't think you wanna know :)
[2012-02-16 19:51:00 -0500] gmcinnes: you are entering a world of pain, donnie
[2012-02-16 19:51:00 -0500] mlei: LawrenceSeattle: or perhaps they tested with ebs, not instance-store
[2012-02-16 19:52:00 -0500] AntonZ: mlei, im actually trying include_recipe "aws::default" now, see if its gonna make nay difference
[2012-02-16 19:52:00 -0500] mlei: doubt it.
[2012-02-16 19:52:00 -0500] mlei: if including "aws" works then it is including aws::default already
[2012-02-16 19:52:00 -0500] AntonZ: ah okay, let me spin up the instance then and see what it says, ill put it in gist ina  amoment
[2012-02-16 19:53:00 -0500] miah: also make sure that any recipe you include is specified as a depends in the metadata.rb
[2012-02-16 19:53:00 -0500] miah: when in doubt, run foodcritic and fix errors
[2012-02-16 19:53:00 -0500] gmcinnes: yfeldblum: My chef-client instances are wedging for no apparent reason.
[2012-02-16 19:54:00 -0500] AntonZ: miah, i dont have recipes dependenies, only cookbooks
[2012-02-16 19:54:00 -0500] gmcinnes: yfeldblum: Its happening the same (random) way on different platforms with different ruby 1.9.2 versions
[2012-02-16 19:55:00 -0500] gmcinnes: yfeldblum: see the gist from hell here: https://gist.github.com/1846747  That is the output of the last chef run where the clients became wedged from 4 different machines.
[2012-02-16 20:01:00 -0500] Urocyon: how have I managed to not hear the term "wedging" before.
[2012-02-16 20:01:00 -0500] jbz: heh
[2012-02-16 20:02:00 -0500] gmcinnes: dude, that goes all the way back to the original jargon file
[2012-02-16 20:02:00 -0500] gmcinnes: http://catb.org/jargon/html/W/wedged.html
[2012-02-16 20:02:00 -0500] dwhsix: hell yeah, I was using it in the 80s ;-)
[2012-02-16 20:03:00 -0500] Urocyon: I didn't really start programming until mid 90s.
[2012-02-16 20:03:00 -0500] Urocyon: well, seriously anyway... things besides a few basic programs.
[2012-02-16 20:03:00 -0500] spicyWith: 'ternoon cooks
[2012-02-16 20:03:00 -0500] AntonZ: so adding aws::default made a difference
[2012-02-16 20:03:00 -0500] Urocyon: some c, a little lisp.
[2012-02-16 20:04:00 -0500] spicyWith: is anyone using nginx as a load balancer for their app servers?
[2012-02-16 20:04:00 -0500] gmcinnes: well, when you were using c, you probably wedged quite a few things :)
[2012-02-16 20:04:00 -0500] AntonZ: but i still have to mounts ha
[2012-02-16 20:04:00 -0500] gmcinnes: anyway, the jargon file is always a good time waster on a rainy afternoon.
[2012-02-16 20:04:00 -0500] mlei: AntonZ: made what kind of difference
[2012-02-16 20:05:00 -0500] Urocyon: heh, I still managed to learn kluge though.
[2012-02-16 20:05:00 -0500] AntonZ: there are no more errors, right_aws gem gets installed
[2012-02-16 20:06:00 -0500] AntonZ: i dont get why i get two mounts though:
[2012-02-16 20:06:00 -0500] AntonZ: [root@ip-10-0-0-10 ~]# df -h
[2012-02-16 20:06:00 -0500] AntonZ: Filesystem            Size  Used Avail Use% Mounted on
[2012-02-16 20:06:00 -0500] AntonZ: none                  851M     0  851M   0% /dev/shm
[2012-02-16 20:06:00 -0500] AntonZ: https://gist.github.com/1839310
[2012-02-16 20:07:00 -0500] gmcinnes: that looks non optimal
[2012-02-16 20:07:00 -0500] mlei: looks like the system mounted /dev/sdb
[2012-02-16 20:07:00 -0500] mlei: then you told it to mount /dev/sdj1 over it with your cookbook
[2012-02-16 20:07:00 -0500] AntonZ: exactly
[2012-02-16 20:07:00 -0500] jbz: Anyone who wants the Real Original Jargon needs to read Soul of a New Machine :-)
[2012-02-16 20:07:00 -0500] AntonZ: i dont understand where /dev/sdb comes from
[2012-02-16 20:08:00 -0500] mlei: do you have an ebs volume assigned to that instance in your instance configuration?
[2012-02-16 20:08:00 -0500] AntonZ: i assign/mount my 60GB volume using chef cookbook
[2012-02-16 20:08:00 -0500] AntonZ: and in my recipe i say to mount it as /dev/sdj1
[2012-02-16 20:08:00 -0500] mlei: is there an sdb in /etc/fstab?
[2012-02-16 20:08:00 -0500] AntonZ: let me see
[2012-02-16 20:09:00 -0500] AntonZ: yes there is, updated gist
[2012-02-16 20:09:00 -0500] AntonZ: https://gist.github.com/1839310
[2012-02-16 20:09:00 -0500] mlei: well, not much of a mystery there, it's mounting it on boot
[2012-02-16 20:09:00 -0500] mlei: get rid of that line and you're done
[2012-02-16 20:10:00 -0500] yfeldblum: gmcinnes, wedged how?
[2012-02-16 20:10:00 -0500] AntonZ: but what dictates to mount my volume as that device ?
[2012-02-16 20:10:00 -0500] AntonZ: the instances are brand new, i terminate and spin ne ones, but mount the same volume
[2012-02-16 20:11:00 -0500] AntonZ: ne-new
[2012-02-16 20:11:00 -0500] gmcinnes: yfeldblum: like, stuck. They don't finish their chef run I assume.  They don't output anything else to the log, and don't contact the chef server to say they're finished.  They also are in Sl state and still in the proc table, so they're not zombied or slayed or stuck running.
[2012-02-16 20:12:00 -0500] AntonZ: im curious if that image provider mounts something in there
[2012-02-16 20:12:00 -0500] mlei: check your ebs volumes list?
[2012-02-16 20:12:00 -0500] AntonZ: i have only one spare volume to mount
[2012-02-16 20:13:00 -0500] AntonZ: and it's expclicitly specified in my recipe, volume id
[2012-02-16 20:13:00 -0500] mlei: check the data on the volume and look at its attachment information
[2012-02-16 20:13:00 -0500] gmcinnes: yfeldblum: I had this problem a few days ago, and someone suggested it was a problem with ruby 1.8.7 on Centos 6.  So I rebuilt all of my machines to use 1.9.2
[2012-02-16 20:13:00 -0500] AntonZ: if i go to /mnt it has my data in there
[2012-02-16 20:13:00 -0500] AntonZ: so it does mount proper volume
[2012-02-16 20:13:00 -0500] mlei: it's possible the image already has some aws logic that hooks up the devices
[2012-02-16 20:13:00 -0500] mlei: in an init script somewhere
[2012-02-16 20:14:00 -0500] AntonZ: possible... weird though
[2012-02-16 20:14:00 -0500] gmcinnes: yfeldblum: I have Centos 6 machines with 1.9.2 p 180  and Ubuntu 10.04 machines with 1.9.2 p 290.  Same thing happens on both
[2012-02-16 20:14:00 -0500] mlei: it will only show the newest mount... what if you unmount /dev/sdj1
[2012-02-16 20:14:00 -0500] mlei: then what's in /mnt
[2012-02-16 20:14:00 -0500] AntonZ: ha, good point, let me try
[2012-02-16 20:14:00 -0500] rgsteele: Is it possible and/or recommended to use arrays in attributes.rb?  I have a config value in a file that is not unique (subnets, as it were), which I want to loop over to populate the template.
[2012-02-16 20:16:00 -0500] AntonZ: i unmounted sdj1 and went to sdb under /mnt and there is only lost+found
[2012-02-16 20:16:00 -0500] AntonZ: so it's empty
[2012-02-16 20:16:00 -0500] mlei: sounds like a different ebs volume to me.
[2012-02-16 20:17:00 -0500] AntonZ: okay, i got it, once i umounted my volume from /mnt, i see another volume sdb and that volume gets mounted by image provbider, what happened was i mounted on top of them
[2012-02-16 20:17:00 -0500] rgsteele: Er, maybe I should rephrase that more clearly - I want the value of an attribute to be an array.
[2012-02-16 20:18:00 -0500] jbz: rgsteele: using arrays in attributes is completely kosher.
[2012-02-16 20:19:00 -0500] AntonZ: thank you much for the help jbz, mia and mlei!
[2012-02-16 20:19:00 -0500] dwhsix: jbz: if you're still around where do you then host your packages?
[2012-02-16 20:19:00 -0500] jbz: dwhsix: We host the pkgs on S3 using 'open' buckets.
[2012-02-16 20:19:00 -0500] dwhsix: ha - was just thinking that's what I would do
[2012-02-16 20:19:00 -0500] jbz: dwhsix: So we can just curl/wget or remote_file them.
[2012-02-16 20:20:00 -0500] dwhsix: got it, and then just install from local pkg
[2012-02-16 20:20:00 -0500] rgsteele: jbz: So, something like default[:foo][:bar] = ['alpha', 'bravo', 'charlie']?
[2012-02-16 20:20:00 -0500] jbz: yep.  Since we do that prior to chef starting, we just wget it and do a dpkg install.
[2012-02-16 20:20:00 -0500] yfeldblum: gmcinnes, how are you running the chef-client?
[2012-02-16 20:20:00 -0500] jbz: rgsteele: That should work fine.
[2012-02-16 20:21:00 -0500] geekbri: is anybody here using fnichols user cookbook?  I suspect create_user_group is busted
[2012-02-16 20:21:00 -0500] gmcinnes: yfeldblum: as an init script. /etc/init.c/chef-client start
[2012-02-16 20:21:00 -0500] gmcinnes: yfeldblum: those scripts come from the chef-client cookbook
[2012-02-16 20:22:00 -0500] yfeldblum: gmcinnes, what happens if you stop the daemon and run the chef-client manually?
[2012-02-16 20:24:00 -0500] gmcinnes: works fine.
[2012-02-16 20:24:00 -0500] gmcinnes: yfeldblum: In fact, even if I *don't* stop the chef-client and run another instance manually, it works fine.
[2012-02-16 20:25:00 -0500] rgsteele: jbz: Thanks, 'preciate it.
[2012-02-16 20:25:00 -0500] jbz: rgsteele: yw!
[2012-02-16 20:25:00 -0500] yfeldblum: init.c? i assume init.d right?
[2012-02-16 20:26:00 -0500] gmcinnes: yeah. sorry.
[2012-02-16 20:26:00 -0500] yfeldblum: so what's different about how `/etc/init.c/chef-client start` launches the chef-client?
[2012-02-16 20:28:00 -0500] gmcinnes: well the process it starts is: /usr/local/bin/ruby /usr/bin/chef-client -d -P /var/run/chef/client.pid -L /var/log/chef/client.log -c /etc/chef/client.rb -i 300 -s 60
[2012-02-16 20:28:00 -0500] gmcinnes: so its daemonized, writes a pid, writes a log file, uses the client.rb in /etc/chef contacts every 300 seconds with a skew of 60
[2012-02-16 20:29:00 -0500] gmcinnes: when I run it manually I just do "chef-client -l debug"
[2012-02-16 20:30:00 -0500] jbz: gmcinnes: heh so the one that wedged right after the first chef line could just have been waiting 60 secs for splay
[2012-02-16 20:30:00 -0500] jbz: And *nothing* happens in the syslog when they die?  Arrrrrgh.
[2012-02-16 20:30:00 -0500] gmcinnes: jbz: possibly
[2012-02-16 20:31:00 -0500] jbz: Are you sure that they use the same ruby in those two cases?
[2012-02-16 20:31:00 -0500] spicyWith: is haproxy something that can be used instead of nginx or should it be used behind it?
[2012-02-16 20:31:00 -0500] jbz: (I know, you probably are, I'm down to checking novice stuff)
[2012-02-16 20:32:00 -0500] jbz: spicyWith: nginx should be used as a webserver *behind* haproxy; nginx and haproxy can both be used as load balancers.
[2012-02-16 20:33:00 -0500] spicyWith: jbz: thanks. Is nginx as good a load balancer as haproxy?
[2012-02-16 20:33:00 -0500] yfeldblum: /usr/local/bin/ruby, that's the system ruby & is returned by `which ruby`?
[2012-02-16 20:33:00 -0500] gmcinnes: yeah. definitely the same rubies.
[2012-02-16 20:33:00 -0500] gmcinnes: yes
[2012-02-16 20:33:00 -0500] jbz: spicyWith: Heh.  Religious wars have arisen over that.  I don't want to give an opinion, i don't know enough.
[2012-02-16 20:34:00 -0500] jbz: spicyWith: haproxy is easier to cluster for failover.  I will say that.
[2012-02-16 20:34:00 -0500] jbz: spicyWith: If you are load balancing for availability (as opposed to just load balancing) then I would say use haproxy on 2 nodes with heartbeat.
[2012-02-16 20:34:00 -0500] brandoma: whats wrong with a good old tyme religious war?
[2012-02-16 20:35:00 -0500] jbz: brandoma: I prefer they not start until I have my ammo franchise open for business
[2012-02-16 20:35:00 -0500] spicyWith: trying to deploy django+gunicorn and figure out what the nginx setup should be. So would having haproxy and then N servers running nginx+gunicorn+django seem like overkill? Should I have a single instance of nginx for the whole cluster?
[2012-02-16 20:36:00 -0500] jbz: You can have a single instance of nginx so long as it doesn't matter if that instance dies and the whole cluster drops off the net. :-P
[2012-02-16 20:36:00 -0500] brandoma: good plan but on the internet we fight with strawmen, overly rigid opinions, and ad hominem attacks
[2012-02-16 20:36:00 -0500] jbz: If you use haproxy and config a pair of them right, they will play arp games in the event of failure and the network won't notice
[2012-02-16 20:37:00 -0500] spicyWith: jbz: just trying to figure out what type of stuff people do. So I probably want one nginx per node?
[2012-02-16 20:37:00 -0500] jbz: brandoma: Indeed, which is why my ammo franchise offers paywalled propaganda.
[2012-02-16 20:37:00 -0500] jbz: brandoma:  Heartland Research Institute or whatever their name is.  That business model.
[2012-02-16 20:37:00 -0500] jbz: spicyWith: I've never deployed unicorn, so I'm not the best person to answer that.
[2012-02-16 20:38:00 -0500] yfeldblum: gmcinnes, heh definitely out of my element here
[2012-02-16 20:38:00 -0500] gmcinnes: Would there be any weird behaviour associated with ntp changing the system clock during a chef run?
[2012-02-16 20:39:00 -0500] gmcinnes: Or close to a chef run?
[2012-02-16 20:39:00 -0500] jbz: gmcinnes: shouldn't be, that should just cause logging timestamps to skip around
[2012-02-16 20:39:00 -0500] jbz: (our systems do ntp twiddling during chef runs all the time)
[2012-02-16 20:40:00 -0500] gmcinnes: yeah. and its only microsecond resolution jumps anyway, I'd expect. I don't think the clock skew is that bad.
[2012-02-16 20:41:00 -0500] gmcinnes: fsck.
[2012-02-16 20:41:00 -0500] jbz: gmcinnes: Have you tried hitting a 'wedged' chef-client with a RELOAD message?
[2012-02-16 20:41:00 -0500] jbz: or a kill message other than -9?
[2012-02-16 20:41:00 -0500] atomic-penguin: fsck -y
[2012-02-16 20:41:00 -0500] jbz: (just for s---s and giggles)
[2012-02-16 20:41:00 -0500] jtimberman: fwiw
[2012-02-16 20:41:00 -0500] jtimberman: api.opscode.com uses nginx :)
[2012-02-16 20:41:00 -0500] jtimberman: .... because we need SSL.
[2012-02-16 20:42:00 -0500] jbz: jtimberman: What's your load balancing?  nginx itself?
[2012-02-16 20:42:00 -0500] jtimberman: internal LB uses nginx as well, for simplicity in having the same software
[2012-02-16 20:42:00 -0500] jbz: ah
[2012-02-16 20:42:00 -0500] jtimberman: jbz: load balances the chef api servers.
[2012-02-16 20:42:00 -0500] jbz: Do you have a HA solution at the front?
[2012-02-16 20:42:00 -0500] jtimberman: and the internal one, all the various services inside doing the real work
[2012-02-16 20:42:00 -0500] jtimberman: yfeldblum: true story
[2012-02-16 20:42:00 -0500] jtimberman: ;)
[2012-02-16 20:43:00 -0500] erikh: yeah, he's sitting there with a switchboard connecting all the tubes
[2012-02-16 20:43:00 -0500] jtimberman: son! i am disappoint
[2012-02-16 20:43:00 -0500] jtimberman: anyway
[2012-02-16 20:43:00 -0500] jtimberman: jbz: we have HA across the stack
[2012-02-16 20:43:00 -0500] jtimberman: i don't know the details thoguh :)
[2012-02-16 20:43:00 -0500] jbz: ah
[2012-02-16 20:44:00 -0500] yfeldblum: gmcinnes, have you tried attaching a debugger?
[2012-02-16 20:45:00 -0500] gmcinnes: ok. it responds to SIGHUP: [Thu, 16 Feb 2012 15:44:07 -0500] INFO: SIGHUP received, reconfiguring
[2012-02-16 20:45:00 -0500] gmcinnes: my debugger foo is weak to non-existant.
[2012-02-16 20:45:00 -0500] gmcinnes: If someone wants to walk me through it, I'd welcome it, but that's a lot to ask.
[2012-02-16 20:46:00 -0500] jbz: gmcinnes: Does it start to run again?
[2012-02-16 20:47:00 -0500] gmcinnes: jbz: not so far. I'll have to wait 4-6 minutes to know for sure :)
[2012-02-16 20:47:00 -0500] jbz: ah right
[2012-02-16 20:48:00 -0500] yfeldblum: gmcinnes, start off with `sudo gem install ruby-debug19`
[2012-02-16 20:50:00 -0500] gmcinnes: oh, I can get somwhere with ruby-debug. It's gdb foo that's lacking
[2012-02-16 20:50:00 -0500] miah: stud + haproxy = awesome load balancing + ssl
[2012-02-16 20:50:00 -0500] yfeldblum: gmcinnes, hmm wait i'm not sure how to attach to a ruby process
[2012-02-16 20:50:00 -0500] miah: if nginx could do streaming i'd be more interested...
[2012-02-16 20:52:00 -0500] gmcinnes: ah. balls. hijack gem will do it.
[2012-02-16 20:53:00 -0500] gmcinnes: but I need readline, and it looks like my ruby built without it.
[2012-02-16 20:53:00 -0500] gmcinnes: Further down the rabbit hole we go.
[2012-02-16 21:17:00 -0500] gmcinnes: In the name of the FSM, this is enough to make me switch to puppet! :)
[2012-02-16 21:18:00 -0500] yfeldblum: gmcinnes, have you installed all the dependencies ruby needs?
[2012-02-16 21:18:00 -0500] gmcinnes: yeah.
[2012-02-16 21:19:00 -0500] gmcinnes: hijack doesnt' seem to be hijacking though. IT JUST SITS THERE!
[2012-02-16 21:19:00 -0500] gmcinnes: I can connect with gdb though.
[2012-02-16 21:20:00 -0500] gmcinnes: I can get the c backtrace
[2012-02-16 21:21:00 -0500] yfeldblum: gmcinnes, on another machine if you install rvm and run `rvm notes` then that will list all the prerequisite packages
[2012-02-16 21:22:00 -0500] gmcinnes: wait. I'm not sure what you're asking
[2012-02-16 21:23:00 -0500] gmcinnes: are you asking if I have the dependencies for ruby? Or for all of the bits of ruby? Or for enough bits to get readline support so I can run hijack?
[2012-02-16 21:24:00 -0500] yfeldblum: gmcinnes, so you can run hijack too, i guess, but also just in case there's some part that daemonization requires that you haven't installed the dependencies to
[2012-02-16 21:24:00 -0500] yfeldblum: when you compile ruby, it will only compile those bits of it for which you have installed the dependencies
[2012-02-16 21:25:00 -0500] yfeldblum: which you can usually get as platform packages
[2012-02-16 21:25:00 -0500] gmcinnes: understood.
[2012-02-16 21:25:00 -0500] mlei: you could just, you know, cron chef-client (-;
[2012-02-16 21:26:00 -0500] gmcinnes: oh, I know. mlei.
[2012-02-16 21:26:00 -0500] mlei: i say that tongue-in-cheek. (-:
[2012-02-16 21:26:00 -0500] gmcinnes: I'm digging so deep to partly because eventually a cron chef client will probably fail, but also to get at the root cause in case its something serious.
[2012-02-16 21:27:00 -0500] mlei: gmcinnes: no, definitely, i applaud that
[2012-02-16 21:28:00 -0500] yfeldblum: and `rvm notes` is one place that i know of that has a list of all those platform packages ... i'm sure there are dozens of other places, but this is one that i know of off the top of my head
[2012-02-16 21:28:00 -0500] gmcinnes: yfeldblum: are you suggesting that perhaps somethign is falling over because some parts of ruby are "missing" ?  Its certainly possible, but I would have expected a large explosion of requirement errors etc if that was the case.
[2012-02-16 21:31:00 -0500] mofabo: Hello, Had a question how I can use node roles in my recipie and attribute files
[2012-02-16 21:31:00 -0500] mofabo: is there a way to do something like if node role = this then run this part of the file?
[2012-02-16 21:33:00 -0500] yfeldblum: gmcinnes, i am suggesting that i am out of my element here, and maybe
[2012-02-16 21:33:00 -0500] gmcinnes: I certainly am :)
[2012-02-16 21:33:00 -0500] yfeldblum: gmcinnes, usually, when i need to do remote debugging, i have a debugger
[2012-02-16 21:34:00 -0500] yfeldblum: :P
[2012-02-16 21:34:00 -0500] gmcinnes: so, fwiw, I know where everything is stuck.
[2012-02-16 21:34:00 -0500] yfeldblum: gmcinnes, this process, however, is best known as "eliminate all the stupid things it could have been"
[2012-02-16 21:35:00 -0500] jbz: mofabo: you can examine the runlist (which roles are included into) and determine which roles have been applied to the node, yes
[2012-02-16 21:36:00 -0500] gmcinnes: http://pastie.org/3397298
[2012-02-16 21:36:00 -0500] AntonZ: what would be command set for chef recipe to create a folder ?
[2012-02-16 21:36:00 -0500] gmcinnes: They're all stuck in a select coming from ossl_ssl.c
[2012-02-16 21:37:00 -0500] AntonZ: such as before i excute this: mount "/mnt" do
[2012-02-16 21:37:00 -0500] AntonZ:   device "/dev/sdj1"
[2012-02-16 21:37:00 -0500] AntonZ:   options "rw,noatime"
[2012-02-16 21:37:00 -0500] AntonZ:   fstype "xfs"
[2012-02-16 21:37:00 -0500] AntonZ:   action [ :enable, :mount ]
[2012-02-16 21:37:00 -0500] AntonZ:   # Do not execute if its already mounted
[2012-02-16 21:37:00 -0500] AntonZ:   # not_if "cat /proc/mounts | grep /mnt"
[2012-02-16 21:37:00 -0500] AntonZ: end
[2012-02-16 21:37:00 -0500] AntonZ: i want to create a folder
[2012-02-16 21:38:00 -0500] yfeldblum: gmcinnes, interesting, so are all the reqs for ruby's openssl installed?
[2012-02-16 21:38:00 -0500] jbz: AntonZ: You want the Directory resource.
[2012-02-16 21:38:00 -0500] AntonZ: lets see if it's part of aws
[2012-02-16 21:38:00 -0500] mofabo: @jbz what would be the sytaxs for something like that? I have nodes and have gave them there role variable via the UI. I have my recipie file kinda split into two seperate configs for each role. What would the sytaxs look like, I have something like this if node.attribute?('rols')==marketplace
[2012-02-16 21:38:00 -0500] yfeldblum: gmcinnes, i assume yes, since "require 'openssl'" seems to have worked
[2012-02-16 21:39:00 -0500] jbz: AntonZ: http://wiki.opscode.com/display/chef/Resources#Resources-Directory
[2012-02-16 21:39:00 -0500] AntonZ: cheers jbz! reading now
[2012-02-16 21:39:00 -0500] yfeldblum: gmcinnes, so it's probably not that ...
[2012-02-16 21:39:00 -0500] jbz: mofabo: Are you talking about Chef roles?  Or are you talking about an attribute named 'role'?
[2012-02-16 21:40:00 -0500] mofabo: when you give a node a role does it set its attribute to that role as well?
[2012-02-16 21:40:00 -0500] jbz: mofabo: Oh, ok, you're talking about an attribute.  Be warned, 'role' means something specific.
[2012-02-16 21:40:00 -0500] jbz: No.
[2012-02-16 21:40:00 -0500] jbz: If you just have an attribute named 'role' that you are setting somewhere, you can test that, sure
[2012-02-16 21:40:00 -0500] yfeldblum: gmcinnes, so you're waiting on the ssl handshake to complete? ... wonder why that happens only with chef-client daemonized ...
[2012-02-16 21:40:00 -0500] jbz: mofabo: a Chef role is a runlist entity.  You 'assign' a node to a role by putting that role in its runlist.
[2012-02-16 21:41:00 -0500] jbz: The role itself might set certain attributes, that's one thing a role can do.
[2012-02-16 21:42:00 -0500] jbz: So in order to answer your question, I need to know how you are defining 'role.' :-)
[2012-02-16 21:42:00 -0500] mofabo: but can I use that attribute in my recipice. Something like If you marketplace role run these 5 lines and if your scoring run these other 4 lines. executing the templates wise.
[2012-02-16 21:42:00 -0500] jbz: mofabo:  Yes.  IF by 'role' you mean 'something outside of Chef that you are representing by setting an attribute value.'
[2012-02-16 21:43:00 -0500] AntonZ: jbz - i need to specify provider for resource directory, what's the provider ?
[2012-02-16 21:46:00 -0500] gmcinnes: yfeldblum: also, sometimes it freezes after many many successful openssl connections. So I assume the dependencies must be there.
[2012-02-16 21:47:00 -0500] chip_: Has anybody worked out managing ssl certificate files via encrypted data bags?
[2012-02-16 21:47:00 -0500] jbz: AntonZ:  Uh, no, you shouldn't have toit's a core chef resource.
[2012-02-16 21:47:00 -0500] chip_: Seems like the kind of problem someone would have solved / pushed a cookbook on by now
[2012-02-16 21:47:00 -0500] jbz: The provider is Chef::Provider::Directory.
[2012-02-16 21:47:00 -0500] AntonZ: understood, so i just stick directory "/tmp/something" do
[2012-02-16 21:47:00 -0500] chip_: Thought I'd check before I go inventing wheels.
[2012-02-16 21:47:00 -0500] AntonZ:   owner "root"
[2012-02-16 21:47:00 -0500] AntonZ:   group "root"
[2012-02-16 21:47:00 -0500] AntonZ:   mode "0755"
[2012-02-16 21:47:00 -0500] AntonZ:   action :create
[2012-02-16 21:47:00 -0500] AntonZ: end
[2012-02-16 21:47:00 -0500] mofabo: little confused but thanks so much for the help! So there is no varible(or something I can pull from the chef server) that I can use in my recipie to divy up different roles getting different templats? like if node.role=marketplace run these templates......
[2012-02-16 21:47:00 -0500] gmcinnes: yfeldblum: It may happen even when I run it manually, but It gets run automatically much more often than manually, so I may just not have seen it yet.
[2012-02-16 21:47:00 -0500] AntonZ: and modify to my needs
[2012-02-16 21:48:00 -0500] gmcinnes: yfeldblum: or have seen it, contributed it to the phase of the moon, ctrl-c'ed it and retried.
[2012-02-16 21:48:00 -0500] miah: mofabo: just make different roles run different recipes
[2012-02-16 21:48:00 -0500] jbz: mofabo:  I think you're misunderstanding.  There *is* something called 'role' in Chef.  But it does a particular thing.  I recommend reading up on it on the WIki: http://wiki.opscode.com/display/chef/Roles
[2012-02-16 21:49:00 -0500] yfeldblum: is it an old or recent libssl?
[2012-02-16 21:49:00 -0500] miah: but you can do different things if a specific role is set
[2012-02-16 21:49:00 -0500] jbz: AntonZ: Yep.
[2012-02-16 21:49:00 -0500] AntonZ: thank you Sir, trying now
[2012-02-16 21:49:00 -0500] miah: eg, https://github.com/opscode/cookbooks/blob/master/chef-client/recipes/delete_validation.rb
[2012-02-16 21:50:00 -0500] mofabo: I under stand roles. But in my recipie how do I set for this role run these template and this role run this template. So i can use the same cookbook just give it another role for another system.
[2012-02-16 21:51:00 -0500] jbz: mofabo: Oh, OK. What miah just said then. :-)  The first line of that recipe, the 'unless' line, tests to see if the runlist contains a named role.
[2012-02-16 21:52:00 -0500] miah: you can do similar with a case statement
[2012-02-16 21:54:00 -0500] mofabo: could you supply me with sytaxs for that first line? or point me in the right direction? Thanks so much!
[2012-02-16 21:54:00 -0500] miah: for an example
[2012-02-16 21:54:00 -0500] miah: https://github.com/opscode/cookbooks/blob/master/runit/recipes/default.rb#L20
[2012-02-16 21:54:00 -0500] miah: mofabo: its ruby.
[2012-02-16 21:56:00 -0500] mofabo: thanks so much guys. I really apreciate it!
[2012-02-16 21:58:00 -0500] Viral: hey, with a custom bootstrap template can you set additional node attributes? like inside first-boot.json?
[2012-02-16 22:04:00 -0500] fujin: :o
[2012-02-16 22:04:00 -0500] fujin: maybe I was on a split server
[2012-02-16 22:04:00 -0500] fujin: I haven't seen any chat in here for days
[2012-02-16 22:04:00 -0500] fujin: #chef, ya dead mon?
[2012-02-16 22:04:00 -0500] cwj: wut wut
[2012-02-16 22:05:00 -0500] thehar: watwat
[2012-02-16 22:05:00 -0500] mattray: fujin: you missed out on some serious cooking discussions
[2012-02-16 22:06:00 -0500] fujin: man thats fucked up
[2012-02-16 22:06:00 -0500] fujin: i thought i was going crazy, channel was dead for days
[2012-02-16 22:06:00 -0500] mattray: here's some backlog for you: https://gist.github.com/4ec5417b652b877990e0
[2012-02-16 22:07:00 -0500] miah: awww
[2012-02-16 22:07:00 -0500] fujin: lol
[2012-02-16 22:07:00 -0500] fujin: saw that :P
[2012-02-16 22:08:00 -0500] fujin: that is what prompted me to recycle the connection
[2012-02-16 22:08:00 -0500] fujin: "wtfhax people are talking ON THE INTERNET!"
[2012-02-16 22:10:00 -0500] jtimberman: its okay man
[2012-02-16 22:25:00 -0500] spicyWith: what would be the proper way of setting up nginx so that it reverse proxies to a gunicorn server running on the same node?
[2012-02-16 22:26:00 -0500] statix: Would it be bad practice to have a cookbook/recipe that checks out a directory directly from subversion?
[2012-02-16 22:27:00 -0500] mlei: if you have to ask, it's bad practice (-; no, seriously, depends on what you're doing, but it sounds like a bad idea.
[2012-02-16 22:28:00 -0500] statix: The alternative is to build release packages that the client would install, but that would make deployment of changes very complex
[2012-02-16 22:28:00 -0500] mlei: why would it make it complex?
[2012-02-16 22:29:00 -0500] mlei: cookbooks are supposed to make deployments simple...
[2012-02-16 22:30:00 -0500] statix: It would just be an involved process to commit the code change, build the package, update the cookbook itself. This is an "operations scripts" directory that may need to be updated very quickly
[2012-02-16 22:31:00 -0500] mlei: building and updating the environment or data bag (probably not the cookbook) can be automated easily by something like jenkins
[2012-02-16 22:32:00 -0500] mlei: alternatively you could build a package and just have the cookbook ask for that package
[2012-02-16 22:32:00 -0500] statix: You mean not a specific version?
[2012-02-16 22:32:00 -0500] mlei: do you just need the latest version, or you need a specific version on specific boxes?
[2012-02-16 22:32:00 -0500] statix: (otherwise, I'd have to update the cookbook/attributes to point to the new package version)
[2012-02-16 22:32:00 -0500] mlei: with svn you'd have the same problem, no?
[2012-02-16 22:33:00 -0500] statix: I generally would just need the latest version of everything
[2012-02-16 22:34:00 -0500] mlei: cookbook could do a check of the current version vs available version and install the new one if there is a new one
[2012-02-16 22:34:00 -0500] mlei: sounds like for your limited use case, svn wouldn't be awful. rsync would be a little safer
[2012-02-16 22:34:00 -0500] mlei: or remote_directory
[2012-02-16 22:34:00 -0500] statix: Don't think "wouldn't be awful" is a great solution then :)
[2012-02-16 22:35:00 -0500] mlei: you just don't want svn bombing out with conflicts and such
[2012-02-16 22:35:00 -0500] mlei: kinda fragile
[2012-02-16 22:35:00 -0500] gmcinnes: sheeee-it
[2012-02-16 22:35:00 -0500] mlei: svn export could be okay
[2012-02-16 22:36:00 -0500] gmcinnes: I am learning how to extract info from this process: https://gist.github.com/919470005fcc0fff18ae
[2012-02-16 22:36:00 -0500] statix: I guess I'll have to go with built packages... thanks a lot for the input
[2012-02-16 22:37:00 -0500] jbz: wait, is there an svn provider for the deploy resource?
[2012-02-16 22:37:00 -0500] sascha_d: anyone here have experience implementing the sql_server recipe on Windows?  I'm using chef-solo and running into a snag where it's not creating the MSSQL$SQLEXPRESS service
[2012-02-16 22:38:00 -0500] jbz: I mean the SCM resource.
[2012-02-16 22:38:00 -0500] jbz: That would basically deploy a directory from an SVN repo, right?
[2012-02-16 22:38:00 -0500] jbz: statix:  Would SCM do what you want?
[2012-02-16 22:39:00 -0500] statix: It looks like it.. I have never seen that before
[2012-02-16 22:40:00 -0500] jbz: SCM is usually wrapped by deploy :-)
[2012-02-16 22:40:00 -0500] jbz: but if you just want the checkout part, I think it's what you want
[2012-02-16 22:41:00 -0500] mlei: statix: that actually looks good, but i think you want either export or force_export
[2012-02-16 22:41:00 -0500] mlei: checkout looks like it doesn't do anything if a checkout's already there
[2012-02-16 22:42:00 -0500] mlei: i'd probably still do packages
[2012-02-16 22:42:00 -0500] jbz: so use sync
[2012-02-16 22:43:00 -0500] mlei: well what you don't want is for the thing to fail if there's a conflict
[2012-02-16 22:43:00 -0500] mlei: like someone modified the local copy
[2012-02-16 22:43:00 -0500] jbz: oh.  Why would someone modify the local? ;-P
[2012-02-16 22:44:00 -0500] statix: jbz: it's basically just a scripts directory to do server admin tasks. It wouldn't need to be updated regularly, but if there's a problem it would need to be updated quickly
[2012-02-16 22:44:00 -0500] jbz: statix:  If you had it running 'sync' then every time someone checked in a new rev to the repo, it would automatically track.
[2012-02-16 22:45:00 -0500] statix: That sounds pretty good
[2012-02-16 22:45:00 -0500] kallistec: statix: http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-02-16 22:45:00 -0500] mlei: just warn people not to edit the files on pain of losing sudo rights (=
[2012-02-16 22:46:00 -0500] statix: And since it's built-in, I guess I wouldn't be "not doing it the Chef way"
[2012-02-16 22:46:00 -0500] statix: Which was the primary concern
[2012-02-16 22:46:00 -0500] mlei: imo sync is fragile whether it's from a resource or it's from running svn up
[2012-02-16 22:46:00 -0500] kallistec: statix: yeah, I think it's fine. do it that way until something about it sucks and makes you want to do something different
[2012-02-16 22:47:00 -0500] statix: Alright, I'm gonna give that a try then, thanks everyone for the info
[2012-02-16 22:48:00 -0500] kallistec: with git, chef can do a bunch of magic so that it gets the right code even if ppl make local mods
[2012-02-16 22:48:00 -0500] statix: (I'm using svn)
[2012-02-16 22:48:00 -0500] kallistec: but looks like there's no way to make svn that resilient
[2012-02-16 22:48:00 -0500] kallistec: https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/subversion.rb
[2012-02-16 22:49:00 -0500] mlei: kallistec and statix: hence why i would recommend doing export
[2012-02-16 22:49:00 -0500] statix: I think you're right that export would be the proper way to deploy the files
[2012-02-16 22:49:00 -0500] kallistec: yeah, but chef can't track trunk (or whatever) on export since it doesn't know the rev id
[2012-02-16 22:50:00 -0500] statix: but this ^
[2012-02-16 22:50:00 -0500] kbader: is there a LWRP way to disable ohai plugins, I'm not a big fan of modifying the client.rb (http://wiki.opscode.com/display/chef/Disabling+Ohai+Plugins)
[2012-02-16 22:51:00 -0500] kbader: similar to how chef_handler LWRP works
[2012-02-16 22:51:00 -0500] AntonZ: is there a cookbook to create linux users?
[2012-02-16 22:51:00 -0500] kbader: "users"
[2012-02-16 22:52:00 -0500] AntonZ: somwhere on opscode ?
[2012-02-16 22:52:00 -0500] kbader: https://github.com/opscode/cookbooks/tree/master/users
[2012-02-16 22:52:00 -0500] kallistec: also http://community.opscode.com/search?query=users&scope=home
[2012-02-16 22:52:00 -0500] AntonZ: thank you
[2012-02-16 22:53:00 -0500] AntonZ: whats better :)
[2012-02-16 22:53:00 -0500] kallistec: kbader: you know, you could make your own chef.d and then just edit files in there
[2012-02-16 22:54:00 -0500] kbader: kallistec: should've thought of that, thanks :)
[2012-02-16 22:54:00 -0500] kallistec: Dir["/etc/chef.d/*rb"].each { |f| eval( IO.read(f) ) } in your client.rb
[2012-02-16 22:54:00 -0500] kbader: awesome
[2012-02-16 22:55:00 -0500] kallistec: I haven't tested that btw
[2012-02-16 22:55:00 -0500] kallistec: but it should work. otherwise, you might need instance_eval instead of eval
[2012-02-16 22:57:00 -0500] sascha_d: I'm looking for some help implementing the sql_server recipe on Windows?  I'm using chef-solo and running into a snag where it's not creating the MSSQL$SQLEXPRESS service.  Looking for guidance.  I've checked and the service doesn't appear to exist, there are no errors in the debug prior to attempting to restart a nonexistent service.
[2012-02-16 23:00:00 -0500] AntonZ: guys, if i used this cookbook to create users: http://community.opscode.com/cookbooks/users - where would i define user names ? i dont understand dababag search ?
[2012-02-16 23:01:00 -0500] jbz: AntonZ: http://wiki.opscode.com/display/chef/Data+Bags
[2012-02-16 23:01:00 -0500] kallistec: AntonZ: view source on that, and look at the README.md
[2012-02-16 23:02:00 -0500] AntonZ: reading, thank you
[2012-02-16 23:04:00 -0500] kbader: kallistec: okie, I'll rejigger the eval if that doesn't do it
[2012-02-16 23:04:00 -0500] kallistec: kbader: tested in irb, I think regular eval should work fine
[2012-02-16 23:06:00 -0500] kbader: great, appreciate it
[2012-02-16 23:06:00 -0500] gmcinnes: If anyone is still following my travails, I managed to get some ruby objects outta my wedged processes: https://gist.github.com/919470005fcc0fff18ae
[2012-02-16 23:14:00 -0500] fujin: whats happening there gmcinnes ?
[2012-02-16 23:17:00 -0500] gmcinnes: fujin: nightmare.
[2012-02-16 23:18:00 -0500] gmcinnes: Lots of my chef-client processes are getting wedged. Just stopping working. Not crashing, not spinning in a run state. Just going to sleep halfway through the run, getting stuck in a select() from openssl
[2012-02-16 23:24:00 -0500] savant: hi all
[2012-02-16 23:24:00 -0500] savant: I'm all of a sudden getting the following error
[2012-02-16 23:25:00 -0500] savant:  /usr/local/lib/ruby/gems/1.8/gems/chef-0.9.8/bin/../lib/chef/mixin/recipe_definition_dsl_core.rb:56:in `method_missing': undefined method `command' for #<Chef::Recipe:0xb1e926c> (NoMethodError)
[2012-02-16 23:25:00 -0500] savant: upon running chef-solo
[2012-02-16 23:25:00 -0500] savant: everything was fine on every instance yesterday
[2012-02-16 23:25:00 -0500] savant: now im suddenly getting that error today
[2012-02-16 23:26:00 -0500] savant: any ideas as to what could be occuring?
[2012-02-16 23:28:00 -0500] savant: hmm
[2012-02-16 23:29:00 -0500] savant: looks like an issue in one of my recipes...
[2012-02-16 23:29:00 -0500] fujin: looks like a recipe typo
[2012-02-16 23:31:00 -0500] savant: found it
[2012-02-16 23:31:00 -0500] savant: trolls mucking about in my cookbooks
[2012-02-16 23:32:00 -0500] mlei: those trolls, always causing trouble
[2012-02-16 23:45:00 -0500] sivy: i am very confused about ubuntu's mysql server preseeding
[2012-02-16 23:49:00 -0500] sivy: does anyone have a good recommendation for how to manage mysql users from chef?
[2012-02-16 23:49:00 -0500] sivy: I did find this: https://gist.github.com/769365
[2012-02-16 23:50:00 -0500] fujin: the database cookbook has an lwrp for it i think
[2012-02-16 23:51:00 -0500] sivy: but not sure what the accepted way to do it is
[2012-02-16 23:54:00 -0500] kbader: any solaris cooks out there, I'm getting close but still having some trouble
[2012-02-16 23:54:00 -0500] sivy: it seems that the mysql_database requires you to have [mysql][server_root_passowrd], but ubuntu (my platform) uses the preseed
[2012-02-16 23:54:00 -0500] kbader: (yeah I know it's not officially supported yet)
[2012-02-16 23:55:00 -0500] sivy: as does the mysql_database_user recipe
[2012-02-16 23:55:00 -0500] fujin: sivy: what ?
[2012-02-16 23:56:00 -0500] fujin: if you're using chef client those passwords should be generated the first ime it is installed and persisted to the chef server for use in the future
[2012-02-16 23:57:00 -0500] fujin: if you're using solo it will be random each time so you have to hardcode it to be passed into the preseed
[2012-02-16 23:57:00 -0500] fujin: hth
[2012-02-16 23:57:00 -0500] sivy: hm.
[2012-02-16 23:57:00 -0500] sivy: i'm using server
[2012-02-16 23:57:00 -0500] fujin: https://github.com/opscode/cookbooks/blob/master/mysql/recipes/server.rb#L25-27
[2012-02-16 23:59:00 -0500] sivy: fujin: I've got a value for each of those in mynode attributes
[2012-02-16 23:59:00 -0500] sivy: so they should not be randomized
[2012-02-16 23:59:00 -0500] dwhsix: hmm if I have a custom bootstrap script, where do I put it so knife will find it?
[2012-02-16 23:59:00 -0500] fujin: sivy: no, they should not. you are correct. if you have specified those values, they should be passed through into the preseed when mysql is installed
[2012-02-16 23:59:00 -0500] fujin: dwhsix: .chef/knife/bootstrap/
