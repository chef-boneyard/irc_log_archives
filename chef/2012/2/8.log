[2012-02-08 08:22:00 -0500] context: whats the point of this validation-client if every machine has the private key
[2012-02-08 08:24:00 -0500] context: nm i should read more
[2012-02-08 09:10:00 -0500] m4rcu5: the maintainer and maintainer_email, how would you fill those if you are working on a book with 2 people?
[2012-02-08 09:11:00 -0500] m4rcu5: i guess the only option would be to set it to the company name.
[2012-02-08 09:51:00 -0500] solars: hey, is there a list of companies that use chef? if it is used in large production setups etc? need to convince someone..
[2012-02-08 09:52:00 -0500] jonlives: solars: well, we use it extensively at Etsy, if that helps :)
[2012-02-08 09:52:00 -0500] jonlives: solars: there are also some here: http://www.opscode.com/customers/
[2012-02-08 09:53:00 -0500] solars: ah nice
[2012-02-08 09:53:00 -0500] solars: thanks a lot
[2012-02-08 09:53:00 -0500] solars: :)
[2012-02-08 09:54:00 -0500] jonlives: np :)
[2012-02-08 10:56:00 -0500] m4rcu5: i would like to notify a log on log entrys when a package is installed. How would i do this? i was thinking of a bunch of log("") entrys in a ruby block and notify that, but i get a NoMethodError: undefined method `log'
[2012-02-08 10:57:00 -0500] labria: You may try Chef.log
[2012-02-08 11:02:00 -0500] m4rcu5: labria: labria still i get a  NoMethodError: undefined method `log' for Chef:Class, still struggeling a bit with the way functions are  called in ruby it seems
[2012-02-08 11:06:00 -0500] labria: or was it Chef::Logger.log... don't really remember where this method was, check the sources
[2012-02-08 11:10:00 -0500] m4rcu5: labria: thanks, ill look into that, seems i just need to find out how to call chef functions from within a ruby block
[2012-02-08 11:28:00 -0500] m4rcu5: and for anyone else who wounders, what is log("") in a recipe is Chef::Log.info("") in a ruby block :)
[2012-02-08 12:44:00 -0500] Guest50765: Can anyone provide an example of a chef setup that they use for setting up servers to host a Rails app? Preferably not using the application cookbook (want to use cap instead). I think Ive figured out the basics of Chef, but am going round and round in circles trying to figure out the best way to approach this.
[2012-02-08 13:03:00 -0500] syeats: anyone installed and configured apf using chef?
[2012-02-08 13:06:00 -0500] `brendan: morning
[2012-02-08 13:10:00 -0500] syeats: morning
[2012-02-08 13:36:00 -0500] Guest50765: The mysql cookbook doesnt seem to support encrypted databags. Assuming good chef users use encrypted databags, does it follow that everyone is writing their own wrapper recipes for mysql which read the databag and then send the data to the official recipe?
[2012-02-08 14:00:00 -0500] lflux_: ohai
[2012-02-08 14:01:00 -0500] lflux_: is there a way to notify a resource on a different node easily?
[2012-02-08 14:07:00 -0500] erkules: moin, is there something like storeconfig (puppet) for chef too?
[2012-02-08 14:30:00 -0500] thom: erkules: all nodes are stored by default
[2012-02-08 14:31:00 -0500] labria: lflux_ no
[2012-02-08 14:31:00 -0500] thom: erkules: see the documentation for attributes ( http://wiki.opscode.com/display/chef/Attributes ) and search ( http://wiki.opscode.com/display/chef/Search )
[2012-02-08 14:37:00 -0500] renchap: iam looking for pointer about an HA chef-server setup
[2012-02-08 14:37:00 -0500] renchap: couchdb replication seems ok, running chef-server on both servers works
[2012-02-08 14:38:00 -0500] renchap: clustered rabbitmq
[2012-02-08 14:38:00 -0500] renchap: but how to do with solr ?
[2012-02-08 14:39:00 -0500] thom: renchap: master/slave as per http://wiki.apache.org/solr/SolrReplication , then some form of heartbeat to promote the slave
[2012-02-08 14:40:00 -0500] renchap: iam wondering if i will not go with rebuilding solr when needed :)
[2012-02-08 14:42:00 -0500] erkules: thom: thx. with storeconfig (to my knowledge) you can store the configs in a database. From the linke I don't see a database.
[2012-02-08 14:42:00 -0500] laurent\: i've just discovered elasticsearch, i agree with renchap ! :)
[2012-02-08 14:42:00 -0500] lflux_: erkules: they're stored in couchdb iirc
[2012-02-08 14:42:00 -0500] renchap: opscode seems to want to stick with solr ;)
[2012-02-08 14:43:00 -0500] laurent\: i know
[2012-02-08 14:43:00 -0500] thom: erkules: chef runs on top of couchdb
[2012-02-08 14:43:00 -0500] erkules: lflux_, thom hmm thx, a way to change that? Or does it rely on the document-store-thing?
[2012-02-08 14:43:00 -0500] laurent\: renchap: and they will use mysql instead of couchdb :) you're going to like clustering mysql again ! -:)
[2012-02-08 14:43:00 -0500] thom: erkules: http://wiki.opscode.com/display/chef/Architecture
[2012-02-08 14:44:00 -0500] renchap: never
[2012-02-08 14:44:00 -0500] renchap: no mysql here
[2012-02-08 14:44:00 -0500] renchap: but iam ok with postgresql, and the last time i talked about it, postgresql support was planned
[2012-02-08 14:47:00 -0500] renchap: laurent\: https://github.com/mattweber/elasticsearch-mocksolrplugin
[2012-02-08 14:47:00 -0500] renchap: my lead dev just showed this
[2012-02-08 14:47:00 -0500] renchap: i might try :D
[2012-02-08 14:50:00 -0500] laurent\: renchap: oh nice ! :)
[2012-02-08 14:50:00 -0500] lusis: indeed
[2012-02-08 14:50:00 -0500] lusis: tweeted that one
[2012-02-08 14:50:00 -0500] laurent\: keep me informed if you try it, especially if it's successful and as straightforward as it looks
[2012-02-08 14:51:00 -0500] laurent\: gosh, i should really use twitter more ! :-)
[2012-02-08 14:51:00 -0500] laurent\: s/ more//
[2012-02-08 14:51:00 -0500] lusis: hah
[2012-02-08 14:51:00 -0500] lusis: well I only tweeted it just now ;)
[2012-02-08 14:51:00 -0500] laurent\: ah ok :)
[2012-02-08 15:01:00 -0500] BryanWB: hey renchap missed u at fosdem!
[2012-02-08 15:08:00 -0500] jtimberman: erkules: http://wiki.opscode.com/display/chef/Opscode+Chef+Short-Term+Roadmap+and+Performance+Improvements
[2012-02-08 15:09:00 -0500] jtimberman: erkules: short version: we (opscode) are moving to an SQL based storage engine on the Hosted and Private Chef products, and that will make its way to the open source Chef Server as well.
[2012-02-08 15:10:00 -0500] erkules: jtimberman: great thx!
[2012-02-08 15:10:00 -0500] jtimberman: I don't have an ETA on when that will happen for Open Source Chef :)
[2012-02-08 15:11:00 -0500] erkules: hehe
[2012-02-08 15:12:00 -0500] erkules: in which way does chef explicit depends on rabbitmq? I.e. 0mq exists also
[2012-02-08 15:13:00 -0500] jtimberman: erkules: rabbitmq is used for the search indexer.
[2012-02-08 15:13:00 -0500] jtimberman: erkules: And 0mq was not in a usable state when we picked rabbitmq :)
[2012-02-08 15:14:00 -0500] jtimberman: also, the software stack of the open source server is the same as our original stack for the hosted service, so it was built for massive scale.
[2012-02-08 15:14:00 -0500] jtimberman: (though the open source version came first :))
[2012-02-08 15:15:00 -0500] erkules: jtimberman: great thx for the info
[2012-02-08 15:15:00 -0500] jtimberman: erkules: Sure :)
[2012-02-08 15:15:00 -0500] jtimberman: You can read all about it in Hogwarts, a History.
[2012-02-08 15:16:00 -0500] erkules: ?
[2012-02-08 15:16:00 -0500] erkules: :)
[2012-02-08 15:23:00 -0500] zts: ohai Opscoders - who do I have to sweet-talk to get a conversation about Private Chef pricing?
[2012-02-08 15:24:00 -0500] geekbri: Has anybody here used Librarian::Chef for managing their cookbooks?
[2012-02-08 15:25:00 -0500] jtimberman: zts: sales@opscode.com :)
[2012-02-08 15:25:00 -0500] yfeldblum: geekbri, yes
[2012-02-08 15:25:00 -0500] jtimberman: yfeldblum: you don't count.
[2012-02-08 15:25:00 -0500] jtimberman: hehehehehe
[2012-02-08 15:26:00 -0500] zts: jtimberman: I shall email.  I'm hoping that will work better than the contact form on the Private Chef page... which redirects to an invalid URL, and hasn't resulted in any contact :)
[2012-02-08 15:26:00 -0500] geekbri: yfeldblum: how was your experience with it?  I'm looking to potentially use it.
[2012-02-08 15:27:00 -0500] yfeldblum: geekbri, pretty good, seeing as i wrote it
[2012-02-08 15:28:00 -0500] geekbri: yfeldblum: haha, well you are a biased opinion then aren't you :-P
[2012-02-08 15:28:00 -0500] yfeldblum: geekbri, you may get more balanced points of view from others
[2012-02-08 15:28:00 -0500] geekbri: yfeldblum: appreciate the hard work by the way.  Looks like this might be the solution I need for managing my cookbook hell :)
[2012-02-08 15:28:00 -0500] yfeldblum: geekbri, however, i can answer questions about how it works and such :P
[2012-02-08 15:30:00 -0500] geekbri: yfeldblum: you'll regret that ;)
[2012-02-08 15:30:00 -0500] yfeldblum: geekbri, it can help, depending on your workflow; it's not a panacea
[2012-02-08 15:40:00 -0500] jtimberman: zts: oh, its an invalid URL?
[2012-02-08 15:41:00 -0500] zts: jtimberman: tries to send the browser to http://http//www.opscode.com/private-chef/thank-you
[2012-02-08 15:42:00 -0500] zts: though I'd assumed the form submission went okay, so I kind of expected someone to get in touch despite that :)
[2012-02-08 15:42:00 -0500] zts: (Sorry, I snarked about that in here at the time, but it's possible no Opscode staff were around)
[2012-02-08 15:43:00 -0500] jtimberman: oh ho!
[2012-02-08 15:43:00 -0500] jtimberman: zts: thanks :)
[2012-02-08 15:43:00 -0500] zts: np :)
[2012-02-08 15:43:00 -0500] jtimberman: zts: you can always email problems to support@opscode.com
[2012-02-08 15:43:00 -0500] zts: duly noted for next time!
[2012-02-08 15:44:00 -0500] Brad_K: yfeldblum: so, i read the information at https://github.com/applicationsonline/librarian#readme and i'm still not quite understanding what the motivation is behind librarian.  can you help me understand?
[2012-02-08 15:47:00 -0500] yfeldblum: Brad_K, in the scenario where: you're using a lot of third-party well-maintained cookbooks, you don't necessarily want to vendor them in your own chef-repo, you want an automated way to ensure their versions/dependencies are consistent before uploading them to the chef-server, you want an automated way to update them all if there are new versions, you want an automated way to write down what your chef-repo's constraints are on the
[2012-02-08 15:47:00 -0500] yfeldblum: allowed cookbooks
[2012-02-08 15:48:00 -0500] Brad_K: hmm.
[2012-02-08 15:48:00 -0500] yfeldblum: the chef-server already does some of this, but when your workflow is more git-oriented, test with vagrant, etc., the chef-server doing it doesn't fit as well
[2012-02-08 15:49:00 -0500] Brad_K: there are very few cookbooks that i've used that i haven't had to modify in order to make them work the way i wanted.  of course, all the ones i've modified are ones that i wouldn't want to have kept in sync with any upstream changes.
[2012-02-08 15:49:00 -0500] mattray: spiceweasel does validation and downloading as well.
[2012-02-08 15:50:00 -0500] Brad_K: and we're not using git, at least not yet.
[2012-02-08 15:51:00 -0500] geekbri: yfeldblum: Well it also becomes useful if you want to make a fix to a cookbook that you suspect they will eventually change as well, but temporarily you want to use your own version.  The issue is that opscode has their cookbooks all as one giant repo.
[2012-02-08 15:51:00 -0500] yfeldblum: librarian can also fetch cookbooks from whatever sources you specify, whether community site, git repository, local filesystem path, or (unwritten as of yet) hg, svn, etc
[2012-02-08 15:51:00 -0500] jtimberman: geekbri: working on splitting that (slowly)
[2012-02-08 15:51:00 -0500] jtgiri_: I was wondering if there was a ruby equivalent  of clusto : https://github.com/clusto/clusto/wiki , it sounds like clusto only integrates with chef
[2012-02-08 15:52:00 -0500] jtgiri_: i mean puppet
[2012-02-08 15:52:00 -0500] geekbri: jtimberman: Always good news... But my cookbook repo is becoming a horrible mess :(
[2012-02-08 15:52:00 -0500] yfeldblum: geekbri, in that case you can fork the cookbook, make the fix in your fork, submit a pull request, and until the pull request is integrated, switch the reference in your Cheffile to your fork, and then once the pull request is integrated and a new version released, switch the reference in your Cheffile back to the upstream
[2012-02-08 15:52:00 -0500] geekbri: yfeldblum: exactly what I planned on doing ;)
[2012-02-08 15:53:00 -0500] mattray: jtgiri_: spiceweasel documents your chef deployments, not so much on the hardware side
[2012-02-08 15:53:00 -0500] yfeldblum: geekbri, you will still have to `librarian-chef update $COOKBOOK_YOU_SWITCHED ; knife cookbook upload $COOKBOOk_YOU_SWITCHED`
[2012-02-08 15:53:00 -0500] mattray: jtgiri_: crowbar may approach that eventually
[2012-02-08 15:53:00 -0500] geekbri: yfeldblum: Yeah, I'm ok with that.  It just makes managing the differences a bit easier.
[2012-02-08 15:54:00 -0500] jtgiri_: Okay thanks
[2012-02-08 15:56:00 -0500] yfeldblum: Brad_K, librarian-chef in and of itself doesn't need to be used in a git repository, although it is capable of fetching cookbooks from any git source
[2012-02-08 16:02:00 -0500] jtimberman: librarian is definitely neat :)
[2012-02-08 16:42:00 -0500] jtimberman: ohai ezmobius
[2012-02-08 16:42:00 -0500] ezmobius: ohai
[2012-02-08 16:44:00 -0500] lusis: btm: you win
[2012-02-08 16:44:00 -0500] lusis: btm: I'm going to give you +K for snark
[2012-02-08 16:45:00 -0500] Brad_K: i thought they broke up?
[2012-02-08 16:46:00 -0500] Brad_K: and besides, if i had to choose, i think i'd choose A over +K.
[2012-02-08 16:49:00 -0500] lusis: A+K
[2012-02-08 16:49:00 -0500] lusis: know you've got an actor
[2012-02-08 16:49:00 -0500] lusis: er now
[2012-02-08 16:57:00 -0500] jtimberman: lusis: what queue is that listening on?
[2012-02-08 17:02:00 -0500] akarasulu: Hi ... I just wanted to commend you all, especially the OpsCode team. I've been a long time member of the Apache Software Foundation and I have yet to read a better explanation of why the ASL fits an open source business model than this link here: http://www.opscode.com/blog/2009/08/11/why-we-chose-the-apache-license/ ... Kudos!
[2012-02-08 17:02:00 -0500] btm: lusis: I work alone in a hovel in a warehouse in Maine now, so the snark is set on full to compensate for a lack of coffee-pot banter.
[2012-02-08 17:02:00 -0500] btm: akarasulu: I'll pass that on to holoway, thanks!
[2012-02-08 17:03:00 -0500] akarasulu: If you guys are ever interested in taking Chef to the ASF let me know.
[2012-02-08 17:03:00 -0500] akarasulu: I think your community fits incredibly well.
[2012-02-08 17:05:00 -0500] yfeldblum: akarasulu, git?
[2012-02-08 17:05:00 -0500] akarasulu: yfeldblum: I'm sure you can stick to github
[2012-02-08 17:06:00 -0500] akarasulu: yfeldblum: The ASF is not about what VCS or DVCS you use but rather the kind of community dynamics you're interested in.
[2012-02-08 17:11:00 -0500] yfeldblum: akarasulu, tools are enablers - or constrictors - of community dynamics
[2012-02-08 17:11:00 -0500] akarasulu: yfeldblum: sure they do impact interactions
[2012-02-08 17:12:00 -0500] akarasulu: yfeldblum: git should not be a problem ... again its not about where you host the code
[2012-02-08 17:12:00 -0500] thom: akarasulu: this apparent assumption that people can't have decent community without the ASF is unfortunate
[2012-02-08 17:13:00 -0500] akarasulu: thom: not at all stating that
[2012-02-08 17:13:00 -0500] akarasulu: thom, yfeldblum: regardless I was impressed by your community ... you can teach some of us at the ASF about why the ASL is great for the OS business model :-). Good luck to you guys.
[2012-02-08 17:14:00 -0500] akarasulu: thom, yfeldblum: I think you guys don't need us and we don't need you it's just nice to see you guys putting the community before the code
[2012-02-08 17:15:00 -0500] akarasulu: thom, yfeldblum: I did not come here to say come to Apache ... I came to just let you know how impressed I was with your community and your product.
[2012-02-08 17:15:00 -0500] akarasulu: thom, yfeldblum: Forgive me if I came off the wrong way.
[2012-02-08 17:16:00 -0500] Brad_K: akarasulu: on behalf of the rest of the community, i would like to say thank you very much for the compliments!
[2012-02-08 17:16:00 -0500] Brad_K: the community is a big part of the reason why i'm here.
[2012-02-08 17:16:00 -0500] akarasulu: koolio
[2012-02-08 17:16:00 -0500] itwasntandy: I'm just here for the beer
[2012-02-08 17:16:00 -0500] akarasulu: :-D
[2012-02-08 17:18:00 -0500] Brad_K: in fact, i owe my job to this community, and especially to Matt Ray.
[2012-02-08 17:18:00 -0500] thom: opscode have worked incredibly hard to foster the community, and while the license is a part of that -- it is just a part, i think
[2012-02-08 17:19:00 -0500] yfeldblum: akarasulu, not at all
[2012-02-08 17:19:00 -0500] yfeldblum: akarasulu, thanks for popping in
[2012-02-08 17:20:00 -0500] btm: itwasntandy: wait, there is beer?
[2012-02-08 17:20:00 -0500] dajia: Hooray, beer!
[2012-02-08 17:20:00 -0500] yfeldblum: akarasulu, not sure why chef would need a new umbrella org since it has active commercial backing already, but hey this is a love-fest so why not
[2012-02-08 17:20:00 -0500] akarasulu: yfeldblum: my pleasure ... I think I might stick around here especially when there's free beer :-D
[2012-02-08 17:22:00 -0500] itwasntandy: btm: There was here. I drank it though :)
[2012-02-08 17:22:00 -0500] Brad_K: btm  yeah, i'm told that we're supposed to send all of our bar tabs to the technical program manager.  he has apparently agreed to pay all beer-related expenses for the community out of his own pocket.  however, i haven't heard his name yet.
[2012-02-08 17:23:00 -0500] btm: Brad_K: that is jtimberman =D
[2012-02-08 17:23:00 -0500] Brad_K: oh, okay.  makes sense.
[2012-02-08 17:24:00 -0500] jtimberman: Hmmm?
[2012-02-08 17:25:00 -0500] Brad_K: itwasntandy: i gotz you a beer, but i drunked it?
[2012-02-08 17:25:00 -0500] Brad_K: thanks, jtimberman!
[2012-02-08 17:25:00 -0500] thom: jtimberman: beer on you, apparently! (mines a fat tyre)
[2012-02-08 17:27:00 -0500] jtimberman: thom: i won't buy shit beer for my friends sir. :)
[2012-02-08 17:27:00 -0500] jtimberman: (okay, Fat Tire isn't *shit*, but New Belgium Brewing makes MUCH better beer than that)
[2012-02-08 17:28:00 -0500] Brad_K: jtimberman: if you want to talk quality beer, let's talk about real Belgian beer, and not that fake stuff.  Orval, Chimay, Westvleteren, Achel, or one of those maybe.
[2012-02-08 17:28:00 -0500] jtimberman: Brad_K: If you can *get* Westvleteren
[2012-02-08 17:28:00 -0500] siezer: we talkin about beer in here?
[2012-02-08 17:28:00 -0500] jtimberman: Isn't that the one that comes out "when they feel like it"
[2012-02-08 17:28:00 -0500] rweng: hm, i can't find include_role (documentation). Is this or a similar command available?
[2012-02-08 17:29:00 -0500] jtimberman: Westmalle is one of my favorites.
[2012-02-08 17:29:00 -0500] jtimberman: rweng: I do not believe such a method exists.
[2012-02-08 17:29:00 -0500] rweng: would be awkward to move my role in a recipe
[2012-02-08 17:29:00 -0500] rweng: damn
[2012-02-08 17:29:00 -0500] itwasntandy: if you want to talk about real beer, you want a nice british ale...
[2012-02-08 17:29:00 -0500] jtimberman: Roles contain a run list, which can contain roles or recipes.
[2012-02-08 17:29:00 -0500] Brad_K: it's easy to have a role include another role.
[2012-02-08 17:30:00 -0500] itwasntandy: am going down to the hall & woodhouse  brewry on saturday to buy some of the badger beers :)
[2012-02-08 17:30:00 -0500] thom: jtimberman: i love that i can troll you on beer quite so easily :)
[2012-02-08 17:30:00 -0500] jtimberman: thom: Yes indeed!
[2012-02-08 17:31:00 -0500] thom: you'll have to get over this side of the pond again soon so we can get some more variety of beers on the go
[2012-02-08 17:31:00 -0500] Brad_K: itwasntandy: hmm.  i guess it depends on where you are.  for example, if i'm in Dublin, then it would be Guiness.  In Scotland, i don't know if they have any good beers, but i can always count on Lagavulin or Laphroaig or one of those others.
[2012-02-08 17:31:00 -0500] c_t: for extra fun, suggest to jtimberman that he try making PBR at home
[2012-02-08 17:31:00 -0500] jtimberman: c_t: homebrew supply stores won't sell ingredients to make such things.
[2012-02-08 17:32:00 -0500] thom: jtimberman: http://www.brewdog.com/blog-article/brewdog-camden0 or http://www.eustontap.com/ or indeed http://thecraftbeerco.com/
[2012-02-08 17:32:00 -0500] c_t: or homemade malt liquor
[2012-02-08 17:32:00 -0500] rweng: jtimberman: alright, thanks (for all you work in the chef community)
[2012-02-08 17:33:00 -0500] jtimberman: rweng: you're welcome, though to be fair i work for opscode :)
[2012-02-08 17:33:00 -0500] c_t: jtimberman: you could start making this too: http://en.wikipedia.org/wiki/Kilju
[2012-02-08 17:33:00 -0500] rweng: jtimberman: i know, but your blog helped me out quite a lot too (especially the post about configuring your os x machine with chef)
[2012-02-08 17:34:00 -0500] jtimberman: :D
[2012-02-08 17:34:00 -0500] jtimberman: glad thats helpful to folks.
[2012-02-08 17:35:00 -0500] Brad_K: yeah, he's generally a very helpful guy.  especially when he agrees to pay all beer related expenses for everyone in the community.  ;-)
[2012-02-08 17:36:00 -0500] jtimberman: happens all the time.
[2012-02-08 17:46:00 -0500] j-v-e: hey guys
[2012-02-08 17:46:00 -0500] j-v-e: I'm written a recipe for ossec agents
[2012-02-08 17:47:00 -0500] j-v-e: and at some point in the provisioning of the agent, I want to connect to the ossec server and launch a command
[2012-02-08 17:47:00 -0500] j-v-e: what's the proper to do that in the agent's recipe ?
[2012-02-08 17:50:00 -0500] jesserobbins: jtimberman: is that what the "community liquidity fund" was for...
[2012-02-08 17:51:00 -0500] jslatts: is it a bad idea to use a cookbook to deploy certs/keys on webservers? i have chef server set up for SSL... but I don't know if I should be concerned about having the cookbook stored on the chef server with the private keys
[2012-02-08 17:52:00 -0500] j-v-e: I should add that I know how to run the command, and even collect stdout using SHellOut
[2012-02-08 17:53:00 -0500] j-v-e: What I'm missing is how to launch a command on a specific node, and not the current one
[2012-02-08 17:53:00 -0500] Brad_K: jslatts: that's when you use encrypted databags.  just for the certs & keys that need to remain encrypted until they're actually put on the machine where they have to be stored unencrypted.
[2012-02-08 17:55:00 -0500] jslatts: Brad_K: I was considering that. I'll give it a shot
[2012-02-08 17:56:00 -0500] Brad_K: we've recently implemented that sort of thing.  it sounds scary, and it may seem complex, until you've done it a few times.  in reality, it's just a couple extra lines of code in your recipe and using the "knife data bag create" command.
[2012-02-08 17:56:00 -0500] yfeldblum: jslatts, is your chef-server as locked-down as the servers on which the certs/keys will be deployed
[2012-02-08 17:57:00 -0500] jslatts: Brad_K: I am already using databags to make the node-name -> certificate name mapping
[2012-02-08 17:57:00 -0500] jslatts: Brad_K: so it's just one more step and a template to serialize the cert i suppose
[2012-02-08 17:58:00 -0500] jslatts: yfeldblum: Its maybe slightly less. Our chef server is on EC2 and has a public IP. our web servers on behind NAT/load balancer and cannot be reached directly
[2012-02-08 17:58:00 -0500] Brad_K: jslatts: yfeldblum has a good point  if your chef-server is as secure and well locked down as the server where the certs/keys will be used, then maybe you don't need encrypted data bags.
[2012-02-08 17:58:00 -0500] Brad_K: anyway, that's something for you to investigate and make your own decision.
[2012-02-08 17:58:00 -0500] jslatts: yfeldblum: But the chef server ignores all traffic from non-recognized sources
[2012-02-08 17:58:00 -0500] Brad_K: kl;'
[2012-02-08 17:59:00 -0500] ssd7__: I always blame emacs for random characters appearing in IRC.
[2012-02-08 17:59:00 -0500] jslatts: Brad_K, yfeldblum: thanks to both of you. I'll think it through and see which way makes sense for us
[2012-02-08 18:01:00 -0500] yfeldblum: jslatts, make things exactly as complicated as the needs require, but not more complicated than that
[2012-02-08 18:02:00 -0500] Brad_K: that's a good rule.  i like that.  thanks, yfeldblum!
[2012-02-08 18:20:00 -0500] vhogemann: hi there... got a problem and don't know how to proceed. I have two recipes that need to generate content for the same file... how can I make chef include content inside a file instead of overwriting it?
[2012-02-08 18:21:00 -0500] vhogemann: there's anything ready to do that... or I'll have to write some custom code?
[2012-02-08 18:21:00 -0500] flashmanbahadur: vhogemann: may have to do a custom thing for that
[2012-02-08 18:21:00 -0500] flashmanbahadur: atm there is no way I know of to use ERB templates to include other templates (ala Rails view sttyles)
[2012-02-08 18:21:00 -0500] jbz: vhogemann: If the order doesn't matter, you can just append the info to the file using a block and use a grep in a not_if
[2012-02-08 18:22:00 -0500] flashmanbahadur: Thats I have proceed
[2012-02-08 18:22:00 -0500] flashmanbahadur: check for my string, and append if not there
[2012-02-08 18:22:00 -0500] vhogemann: jbz, I guess appending will work
[2012-02-08 18:22:00 -0500] flashmanbahadur: can someone help me decode this search query from a mongoDB cookbook?
[2012-02-08 18:22:00 -0500] jbz: vhogemann: I'm not saying it's pretty, but it's much easier to implement than doing actual random access content frobbing. :-)
[2012-02-08 18:22:00 -0500] flashmanbahadur: configsrv = search(
[2012-02-08 18:22:00 -0500] flashmanbahadur:   :node,
[2012-02-08 18:22:00 -0500] flashmanbahadur:   "mongodb_cluster_name:#{node['mongodb']['cluster_name']} AND \
[2012-02-08 18:22:00 -0500] flashmanbahadur:    recipes:mongodb\\:\\:configserver AND \
[2012-02-08 18:22:00 -0500] flashmanbahadur:    chef_environment:#{node.chef_environment}"
[2012-02-08 18:22:00 -0500] flashmanbahadur: )
[2012-02-08 18:22:00 -0500] vhogemann: thanks for the help guys... I'll hack something
[2012-02-08 18:23:00 -0500] flashmanbahadur: I know it is searching the node, but not sure how the AND sections work
[2012-02-08 18:23:00 -0500] flashmanbahadur: has to satisfy all 3?
[2012-02-08 18:23:00 -0500] jbz: flashmanbahadur: It is searching for a node with all three conditions
[2012-02-08 18:23:00 -0500] jbz: Yep.
[2012-02-08 18:23:00 -0500] flashmanbahadur: ok, at is will return a node
[2012-02-08 18:23:00 -0500] Brad_K: flashmanbahadur: we're using the edelight mongodb cookbook too.
[2012-02-08 18:23:00 -0500] Brad_K: it will return as many nodes as it finds that meet all the criteria.
[2012-02-08 18:24:00 -0500] jbz: It will return an *array* of nodes, even if there's only one.
[2012-02-08 18:24:00 -0500] flashmanbahadur: ok thanks, I have seen that before
[2012-02-08 18:24:00 -0500] flashmanbahadur: just wansnt sure what the return type was
[2012-02-08 18:24:00 -0500] Brad_K: for config servers, your options are to have just one, or to have three.  MongoDB doesn't allow any other possibilities.
[2012-02-08 18:24:00 -0500] flashmanbahadur: i get that
[2012-02-08 18:24:00 -0500] Brad_K: of course, that search doesn't care how many it finds.
[2012-02-08 18:24:00 -0500] flashmanbahadur: atm I use ec2 dns, but want my servers to have usable hostnames
[2012-02-08 18:25:00 -0500] flashmanbahadur: the problem is, from that search, MongoDB tries to set the config servers to hostname:port
[2012-02-08 18:25:00 -0500] flashmanbahadur: which fails, because EC2 obviously doesnt have DNS for my custom hostnames
[2012-02-08 18:25:00 -0500] Brad_K: we're on rackspace, so the situation is slightly different for us  we have two interfaces per machine.
[2012-02-08 18:25:00 -0500] flashmanbahadur: attempting to tweak it to node.ipaddress
[2012-02-08 18:25:00 -0500] Brad_K: or, you could just use another cookbook that maintains the DNS for you with regards to your chef nodes.  that's what we do.
[2012-02-08 18:26:00 -0500] flashmanbahadur: i could, although it would be better to just run our own DNS or increase our Route 53 usage at that point
[2012-02-08 18:26:00 -0500] flashmanbahadur: for now, going with something quick
[2012-02-08 18:26:00 -0500] Brad_K: we have found a lot of advantages having all our machines in the DNS.
[2012-02-08 18:27:00 -0500] flashmanbahadur: i agree
[2012-02-08 18:27:00 -0500] flashmanbahadur: its on the list
[2012-02-08 18:27:00 -0500] flashmanbahadur: but not yet
[2012-02-08 18:27:00 -0500] Brad_K: 'k
[2012-02-08 18:27:00 -0500] senthilr: Brad_K: do you run your own dns
[2012-02-08 18:27:00 -0500] Brad_K: no, we use the REST API of a service.
[2012-02-08 18:28:00 -0500] flashmanbahadur: ok, I think I found it, thanks for the help
[2012-02-08 18:28:00 -0500] Brad_K: but the existing solutions that have chef cookbooks didn't work for us, so we had to make our own.
[2012-02-08 18:29:00 -0500] ubercore: newbie question. I'm writing a cookbook to set up a service that needs an access key. I want to require that key be set, but I don't want to set a default
[2012-02-08 18:29:00 -0500] ubercore: From my recipe, how do I trigger a failure?
[2012-02-08 18:30:00 -0500] ubercore: I see how to check for the attribute's existence, but not fail in its absence
[2012-02-08 18:30:00 -0500] Brad_K: else raise?
[2012-02-08 18:30:00 -0500] ubercore: oh ok, just raise a standard exception. makes sense
[2012-02-08 18:31:00 -0500] ubercore: thanks :)
[2012-02-08 18:31:00 -0500] Brad_K: i'm just guessing.  i don't know for sure.
[2012-02-08 18:31:00 -0500] ubercore: seems logical
[2012-02-08 18:31:00 -0500] senthilr: Brad_K: is that service something you developed
[2012-02-08 18:32:00 -0500] Brad_K: senthilr: no, we're using Zerigo.  they have a RESTful API that we're hooking into.
[2012-02-08 18:33:00 -0500] senthilr: cool, will look into that
[2012-02-08 18:33:00 -0500] senthilr: thanks
[2012-02-08 18:33:00 -0500] Brad_K: they supposedly also have support for Fog, with both Ruby and Python bindings.  but we could never get those to work.  and we hated their chef cookbook.  so, we rolled our own, and we use curl to hit their API.
[2012-02-08 18:34:00 -0500] Brad_K: but other than that, they seem to be a good provider and less expensive than the other alternatives we had looked at.
[2012-02-08 18:34:00 -0500] senthilr: is that similar to route 53 from amazon
[2012-02-08 18:35:00 -0500] jbz: We use Dynect, it has a decent API.
[2012-02-08 18:35:00 -0500] Brad_K: we don't use Amazon, so i can't say how it compares.
[2012-02-08 18:35:00 -0500] Brad_K: i would have preferred Dynect for their API and good existing cookbook support.
[2012-02-08 18:36:00 -0500] Brad_K: but i'm not paying the bills around here, and the boss already had an account with Zerigo and he liked them from his previous experiences.  except for having to write our own cookbook, i've been satisfied with Zerigo.
[2012-02-08 18:37:00 -0500] Brad_K: so, today, even if Dynect were the same price or somewhat lower than Zerigo, i don't think i'd be interested in switching.
[2012-02-08 18:44:00 -0500] yfeldblum: zerigo dns seems like a fine service
[2012-02-08 18:44:00 -0500] yfeldblum: for public dns anyway; your servers don't need fast resolves for their own external names, only for their internal names and for the rest of the internet's external names
[2012-02-08 18:45:00 -0500] yfeldblum: by "fast" i mean LAN-speed, supposing route53 is on the same LANs as EC2
[2012-02-08 18:55:00 -0500] j-v-e: is there a way to run a recipe on a specific node, different from the node being currently provisionned ?
[2012-02-08 18:57:00 -0500] jbz: j-v-e: Not sure I understand your question.  The only way to run a recipe on a node is for the chef client to be run on that node.  If by 'being currently provisioned' you mean 'the node running chef-client' thennot really, no.  You might be able to edit the other node's runlist so that the next time chef-client is run there it runs the recipe, but that will involve permissions frobbing on the server.
[2012-02-08 19:01:00 -0500] ranjibd: fujin, im facing dbd issues while installing rbot .. any idea from where i can grab it, i installed dbd4 gem.. still its not working
[2012-02-08 19:17:00 -0500] j-v-e: jbz: newbie here, I just understood how the whole recipe process would work in my case, thanks to a coworker of mine
[2012-02-08 19:18:00 -0500] jtimberman: j-v-e: "Yes" - in that recipes are ruby and anything you can do in ruby you can do in a recipe.
[2012-02-08 19:18:00 -0500] j-v-e: or do I need to wait for that other node to re-run ?
[2012-02-08 19:18:00 -0500] j-v-e: but one question remains
[2012-02-08 19:18:00 -0500] j-v-e: one my recipe is done, can I trigger a run on another node ?
[2012-02-08 19:19:00 -0500] jtimberman: but there isn't anything built into chef for doing that.
[2012-02-08 19:19:00 -0500] j-v-e: jtimberman: so I'm running my recipe on agent1, and I would have to ssh into the chef-server to trigger a run of chef-client on agent2 via knife ?
[2012-02-08 19:20:00 -0500] jtimberman: j-v-e: generally that is what folks are doing.
[2012-02-08 19:20:00 -0500] jtimberman: there are projects like lusis's "noah" that can do multi-node coordination.
[2012-02-08 19:20:00 -0500] geekbri: Is there a way with knife to list every recipe in use by all nodes and all those recipes dependancies ?
[2012-02-08 19:20:00 -0500] j-v-e: I don't like the idea of having a ssh key that can issue knife command on every single node
[2012-02-08 19:21:00 -0500] jtimberman: you ssh as yourself.
[2012-02-08 19:21:00 -0500] jtimberman: and run chef-client, not knife
[2012-02-08 19:21:00 -0500] lusis: heh. Just proposed a Noah talk for chefconf
[2012-02-08 19:21:00 -0500] jtimberman: knife is used for interacting with the local repository and the chef server, like uploading cookbooks
[2012-02-08 19:21:00 -0500] lusis: because people keep asking ;)
[2012-02-08 19:21:00 -0500] j-v-e: so node1 would ssh into node2 to run chef-client ?
[2012-02-08 19:22:00 -0500] jtimberman: lusis: :)
[2012-02-08 19:22:00 -0500] jtimberman: no
[2012-02-08 19:23:00 -0500] jtimberman: j-v-e: Chef is convergent, in that it takes care of the node it runs on.
[2012-02-08 19:24:00 -0500] j-v-e: jtimberman: I need a 3 steps setup: node1 install ossec-agent, node2 (ossec-server) generates a key for node1, node1 takes the key and install it
[2012-02-08 19:24:00 -0500] jtimberman: j-v-e: you can run chef in parallel on multiple systems with the "knife ssh" command, which will ssh from your local system to a number of systems based on a search query
[2012-02-08 19:25:00 -0500] j-v-e: I'm thinking of using a data bags to transport the key between the nodes, but regardless the whole process would have to wait for each node to run its part
[2012-02-08 19:25:00 -0500] jtimberman: j-v-e: you might have a look at http://ckbk.it/ossec
[2012-02-08 19:25:00 -0500] j-v-e: I'm wondering if there's a way to make it faster
[2012-02-08 19:25:00 -0500] jtimberman: yes
[2012-02-08 19:25:00 -0500] jtimberman: each node would have to wait
[2012-02-08 19:25:00 -0500] jtimberman: it doesn't generally take long to run chef, depending on what the recipes are doing.
[2012-02-08 19:25:00 -0500] j-v-e: jtimberman: yet, it's asynchronous
[2012-02-08 19:26:00 -0500] jtimberman: however some services have multi-node dependencies.
[2012-02-08 19:26:00 -0500] jtimberman: as you mention, ossec server vs ossec clients.
[2012-02-08 19:26:00 -0500] jtimberman: chef doesn't have a built in way to do multi-node coordination.
[2012-02-08 19:26:00 -0500] jtimberman: however, its ruby, so you could write your own into a cookbook.
[2012-02-08 19:26:00 -0500] jtimberman: such as lusis did with noah
[2012-02-08 19:26:00 -0500] lusis: j-v-e: Jesse Newland did it with using databags as a mutex
[2012-02-08 19:27:00 -0500] j-v-e: I was looking at noah after you mentionned it
[2012-02-08 19:27:00 -0500] lusis: heh
[2012-02-08 19:27:00 -0500] lusis: https://github.com/websterclay/chef-dominodes
[2012-02-08 19:27:00 -0500] j-v-e: the ossec cookbook realizes an installation from the source. we have our own deb packages here
[2012-02-08 19:28:00 -0500] jbz: geekbri:  knife-audit doesn't do what you want?
[2012-02-08 19:28:00 -0500] j-v-e: lusis: thanks, I'm looking at that now
[2012-02-08 19:28:00 -0500] jtimberman: j-v-e: sure, i didn't want to build and host packages :)
[2012-02-08 19:28:00 -0500] geekbri: jbz, whoops, forgot all about it!
[2012-02-08 19:29:00 -0500] jbz: geekbri: It won't list all dependencies, it'll only list those deps which are actually called via include
[2012-02-08 19:29:00 -0500] geekbri: jbz: mmm right i see.
[2012-02-08 19:30:00 -0500] knightorc: I've tickled this but on CentOS5.7 with Chef 0.10.8  http://tickets.opscode.com/browse/CHEF-2728?focusedCommentId=21805#comment-21805  ..  ERROR: knife encountered an unexpected error
[2012-02-08 19:30:00 -0500] knightorc: This may be a bug in the 'cookbook site install' knife command or plugin
[2012-02-08 19:30:00 -0500] knightorc: Please collect the output of this command with the `-VV` option before filing a bug report.
[2012-02-08 19:30:00 -0500] knightorc: Exception: NameError: uninitialized constant Chef::Knife::CookbookSiteDownload::FileUtils
[2012-02-08 19:30:00 -0500] knightorc: the bug ticket is quiet. has anyone solved this challenge?
[2012-02-08 19:30:00 -0500] jtimberman: j-v-e: http://tickets.opscode.com/browse/COOK-1031 - :)
[2012-02-08 19:31:00 -0500] Willejs: hi can anyone help me with some simple ruby and search and data bag stuff?
[2012-02-08 19:31:00 -0500] Willejs: http://stackoverflow.com/questions/9187435/ruby-and-chef-resolve-and-replace-values-in-a-hash
[2012-02-08 19:31:00 -0500] siezer: I have never been so thourgly defeated by anything in my entire life as weblogic.
[2012-02-08 19:31:00 -0500] siezer: holy shitballs
[2012-02-08 19:31:00 -0500] siezer: thoroughly even
[2012-02-08 19:32:00 -0500] Willejs: oracle haha, at least it isn't apex.
[2012-02-08 19:32:00 -0500] j-v-e: jtimberman: ah !
[2012-02-08 19:32:00 -0500] j-v-e: fyi there's a RPM package for ossec
[2012-02-08 19:32:00 -0500] j-v-e: the deb we use internally doesn't follow the debian guideline though
[2012-02-08 19:33:00 -0500] j-v-e: debian imposes all the conf to live in /etc, stuff like that
[2012-02-08 19:33:00 -0500] jtimberman: oh, i ignore that for any packages i create for myself :)
[2012-02-08 19:34:00 -0500] JasonBoxLaptop: Indeed
[2012-02-08 19:34:00 -0500] lusis: it's impossible to build a sane package and follow debian guidelines
[2012-02-08 19:35:00 -0500] lusis: service must autostart
[2012-02-08 19:35:00 -0500] lusis: really?
[2012-02-08 19:35:00 -0500] Willejs: would someone be so nice as to look at my stack overflow question?
[2012-02-08 19:35:00 -0500] Willejs: http://stackoverflow.com/questions/9187435/ruby-and-chef-resolve-and-replace-values-in-a-hash
[2012-02-08 19:35:00 -0500] mahrtian: lusis: just spent a while fighting that using the jenkins package
[2012-02-08 19:36:00 -0500] lusis: jenkins is easy enough to repackage ;)
[2012-02-08 19:37:00 -0500] lusis: but yeah
[2012-02-08 19:37:00 -0500] mahrtian: I considered it
[2012-02-08 19:38:00 -0500] jtimberman: lusis: iirc, thats not an actual policy requirement, but a suggestion
[2012-02-08 19:38:00 -0500] lusis: jtimberman: ah
[2012-02-08 19:38:00 -0500] lusis: jtimberman: the line between requirement and recommendation gets thin sometimes
[2012-02-08 19:38:00 -0500] jtimberman: a strong suggestion :)
[2012-02-08 19:38:00 -0500] jtimberman: but i'm not an expert on debian package policy, its been months since i've really dug in
[2012-02-08 19:38:00 -0500] lusis: jtimberman: "we require 128MB of memory. We recommend 2GB"
[2012-02-08 19:42:00 -0500] coderanger: Willejs: Are you literally searching for "name:value"?
[2012-02-08 19:42:00 -0500] Willejs: no one can help me? no one on the ruby or ruby-lang channel is active :(
[2012-02-08 19:42:00 -0500] Mithrandir: lusis: if you don't want that, just use policy-rc.d.  Really, not hard.
[2012-02-08 19:42:00 -0500] Willejs: ahh cheers coderanger
[2012-02-08 19:42:00 -0500] coderanger: I think you mean "name:#{value}"
[2012-02-08 19:42:00 -0500] Willejs: sorry, what do you mean?
[2012-02-08 19:43:00 -0500] coderanger: What languages are you familiar with so I can translate :)
[2012-02-08 19:43:00 -0500] Willejs: haha, supposedly ruby (none) ;)
[2012-02-08 19:43:00 -0500] Mithrandir: lusis: also, where does it say you must autostart?
[2012-02-08 19:43:00 -0500] coderanger: Willejs: Okay, so "name:value" is just a static string
[2012-02-08 19:44:00 -0500] coderanger: "name:#{value}" is interpolating the variable :value into the string
[2012-02-08 19:44:00 -0500] coderanger: Also, #map on a hash doesn't do what you expect
[2012-02-08 19:44:00 -0500] lusis: Mithrandir: policy-rc.d is entirely the wrong answer imho
[2012-02-08 19:44:00 -0500] coderanger: You want to use #collect probably
[2012-02-08 19:44:00 -0500] lusis: because it's to fix a problem that shouldn't exist in the first place
[2012-02-08 19:44:00 -0500] coderanger: Or edit in place
[2012-02-08 19:47:00 -0500] Willejs: ahh okay.
[2012-02-08 19:47:00 -0500] spicyWith: jtimberman: is it possible to create postgresql users with the database recipe?
[2012-02-08 19:47:00 -0500] spicyWith: there doesn't seem to be a provider for it
[2012-02-08 19:49:00 -0500] Willejs: coderanger: thanks
[2012-02-08 19:49:00 -0500] Willejs: i will look into collect
[2012-02-08 19:49:00 -0500] coderanger: Willejs: data_bag_item("dbclstr", "dbclstr")["nodes"].inject({}) { |memo, (key, value)| memo[key] = search(:node, "name:#{value}").first[:cloud][:private_ips]; memo }
[2012-02-08 19:49:00 -0500] coderanger: Willejs: That code should do what you want
[2012-02-08 19:50:00 -0500] Willejs: thanks very much
[2012-02-08 19:50:00 -0500] geekbri: Is there a simple way with knife to simply print the dependencies of a cookbook ?
[2012-02-08 19:52:00 -0500] coderanger: geekbri: hmm, `knife cookbook show opscode-community-site 0.0.2 -Fjson` dumps the data
[2012-02-08 19:52:00 -0500] coderanger: but to filter just that sub-dict might be harder
[2012-02-08 19:53:00 -0500] coderanger: knife exec can probably do it
[2012-02-08 19:54:00 -0500] geekbri: coderanger: thanks... ill poke around
[2012-02-08 20:01:00 -0500] ssd7_: geekbri: So, something like this will make chef-server figure out the dpendencies for you if you want: knife exec -E 'puts api.post("environments/_default/cookbook_versions", {:run_list => ["application"]}).keys'
[2012-02-08 20:01:00 -0500] Willejs: coderanger: got it to work! going to figure out exactly how you did it now. thanks!
[2012-02-08 20:04:00 -0500] geekbri: ssd7_: hrmm, i ran that command but this doesnt seem to me like the list of all cookbooks and their deps.  I ran it on an ENV where I have my own cookbook that is being used and its not showed in the list that results from that comand.
[2012-02-08 20:06:00 -0500] ssd7_: geekbri: Hmm.  So did you change "application" to the name of the cookbook you want the dependencies for?
[2012-02-08 20:07:00 -0500] geekbri: ssd7_: oh well der on me... that would be the issue.
[2012-02-08 20:07:00 -0500] ssd7_: geekbri: Should been more clear, sorry about that. :)
[2012-02-08 20:08:00 -0500] brettweavnet: Anyone have any recommendations on how to enforce only a single chef-solo process is running?
[2012-02-08 20:10:00 -0500] thbar: brettweavnet: I've not tried that, but maybe having a first recipe that raises an error if a ps grep returns something with chef-solo apart from the current pid would work?
[2012-02-08 20:10:00 -0500] thbar: (quick idea, didn't give it too much thought)
[2012-02-08 20:11:00 -0500] thbar: does anyone know who manages the .msi install for chef on windows?
[2012-02-08 20:11:00 -0500] brettweavnet: was thinking of that or doing something with an exclusive file lock... might be overcomplicating something simple.
[2012-02-08 20:11:00 -0500] thbar: I thought about the exclusive file lock first too (there are maybe gems for that in ruby btw), but then this idea popped out :)
[2012-02-08 20:12:00 -0500] brettweavnet: yeah, actually think I might start with a ps, no need to overcomplicate things...
[2012-02-08 20:12:00 -0500] brettweavnet: thanks!
[2012-02-08 20:12:00 -0500] thbar: you welcome
[2012-02-08 20:23:00 -0500] spicyWith: I'm trying to connect to postgresql running on vagrant (installed by chef), I'm forwarding port 5432 in the vm to 54320 on the host. Connection is getting rejected. Anything I have to add to the standard postgresql recipe?
[2012-02-08 20:25:00 -0500] yfeldblum: my understanding is that postgresql by default denies all connections except connections from loopback by the user "postgres", and that you have to configure it to accept connections of additional types
[2012-02-08 20:27:00 -0500] fujin: tried something like this brettweavnet  ? https://gist.github.com/80075ea3af3b909399ca
[2012-02-08 20:27:00 -0500] spicyWith: yfeldblum: yes, I think that's correct. does this look right for opening up connections: host all all 0.0.0.0/0 md5
[2012-02-08 20:28:00 -0500] yfeldblum: i guess ... try it?
[2012-02-08 20:29:00 -0500] spicyWith: yfeldblum: trying :)
[2012-02-08 20:29:00 -0500] brettweavnet: @fujin, thanks.. testing now
[2012-02-08 20:32:00 -0500] moos3: is there away to add overrides for network infaces when you issue knife bootstrap ?
[2012-02-08 20:32:00 -0500] brettweavnet: that works, except it appears to wait for the lock to be released, I might modify it to raise an error to prevent a log jam
[2012-02-08 20:35:00 -0500] fujin: you might have to unlock the file before closing it or something. :)
[2012-02-08 20:35:00 -0500] fujin: oh, you mean the second process? yeah, it would do :)
[2012-02-08 20:36:00 -0500] brettweavnet: yeah, which should be ok as long as it's not a regular occurance...
[2012-02-08 20:37:00 -0500] brettweavnet: which should work fine for me, thanks!
[2012-02-08 20:44:00 -0500] spicyWith: is there a reason there is no provider to create users for postgresql in the database cookbook?
[2012-02-08 20:47:00 -0500] AmishGeek: is there a simple way to get chef-client to log via rsyslog?  i'm not that familiar with rsyslog (I just got it activated and default forwarding all logs to my spunk server)
[2012-02-08 20:48:00 -0500] AmishGeek: possibly adding something to /etc/rsyslog.d/?
[2012-02-08 20:48:00 -0500] yfeldblum: spicyWith, just that nobody's written it ...
[2012-02-08 20:49:00 -0500] fujin: require 'syslogger';  Chef::Log.logger = Syslogger.new(..)
[2012-02-08 20:49:00 -0500] spicyWith: yfeldblum: fun times :D
[2012-02-08 20:49:00 -0500] fujin: AmishGeek: ^^
[2012-02-08 20:50:00 -0500] AmishGeek: fujin: where do i put that?
[2012-02-08 20:51:00 -0500] fujin: print it out and stick it in your hat
[2012-02-08 20:51:00 -0500] fujin: you could even make a hat out of the paper
[2012-02-08 20:51:00 -0500] fujin: if you don't already have a hat
[2012-02-08 20:51:00 -0500] AmishGeek: i mean, does that go in rsyslog.conf? or in a cookbook?
[2012-02-08 20:51:00 -0500] danryan: what if I don't have paper??
[2012-02-08 20:52:00 -0500] fujin: AmishGeek: it goes in the config file for chef
[2012-02-08 20:52:00 -0500] fujin: solo or client.rb in /etc/chef
[2012-02-08 20:52:00 -0500] AmishGeek: ahh
[2012-02-08 20:52:00 -0500] fujin: "ahh! the painfully obvious option. of course!"
[2012-02-08 20:52:00 -0500] fujin: often wonder if chef should support syslog by default
[2012-02-08 20:53:00 -0500] fujin: mixlog-log ** rather
[2012-02-08 20:54:00 -0500] AmishGeek: WARN: compile error
[2012-02-08 20:54:00 -0500] AmishGeek: syntax error, unexpected tDOT2, expecting ')'
[2012-02-08 20:54:00 -0500] fujin: oh ok
[2012-02-08 20:54:00 -0500] AmishGeek: put it in my /etc/chef/client.rb
[2012-02-08 20:54:00 -0500] fujin: you actually copy pasted my code directly instead of reading it
[2012-02-08 20:54:00 -0500] fujin: it has errors in it for fun
[2012-02-08 20:54:00 -0500] fujin: go read the docs https://github.com/crohr/syslogger
[2012-02-08 20:55:00 -0500] fujin: there are probably other gems too. http://rubygems.org/search?query=syslog
[2012-02-08 20:55:00 -0500] fujin: i think SyslogLogger you can't specify the facility.
[2012-02-08 20:56:00 -0500] AmishGeek: ok, so once i get this working on one node, what needs to happen so it's part of each bootstrapped node by default?
[2012-02-08 20:56:00 -0500] AmishGeek: i've never customized the client.rb on any of my nodes before
[2012-02-08 20:59:00 -0500] fujin: you can create your own bootstrap template by copying the default one
[2012-02-08 21:00:00 -0500] spicyWith: could someone explain when data should go into a data_bag and when it should go into the attributes file?
[2012-02-08 21:01:00 -0500] fujin: i put non node specific attributes, that aren't environment-wide, e.g. only loaded for specific tasks
[2012-02-08 21:01:00 -0500] fujin: into databags
[2012-02-08 21:01:00 -0500] AmishGeek: spicyWith: it really depends on personal preference if you have a bunch of nodes needing the same data (i.e. a database user/pass, then a data bag is easier)
[2012-02-08 21:01:00 -0500] fujin: such as credentials for external services
[2012-02-08 21:01:00 -0500] geekbri: I like to put things in databags that change frequently as well, so I dont have to update a role or cookbook anytime a certain attribute changes.
[2012-02-08 21:01:00 -0500] AmishGeek: also, if you need non-chef users to update things
[2012-02-08 21:02:00 -0500] AmishGeek: i keep the current revision for SVN to be checked out stored in a data bag, so our devs can update the data bag, rather than me having to update/upload/re-run a cookbook because the code went from revision 33614 to 33616
[2012-02-08 21:03:00 -0500] JasonBoxLaptop: AmishGeek: Yeah, I like that idea
[2012-02-08 21:04:00 -0500] hippiehacker: AmishGeek: we do something similar, and I just put a simple sinatra front end for choosing a rev based on a list of 'known good' revs
[2012-02-08 21:04:00 -0500] hippiehacker: users don't access any chef, they just select a role and a version
[2012-02-08 21:11:00 -0500] spicyWith: AmishGeek: ah, I think that just gave me a great way to only deploy the version of code I want. I would like to deploy from github using chef, but only on to a revision I want. Was just about to ask if there is a way do this, but I think that should work with github, right?
[2012-02-08 21:12:00 -0500] AmishGeek: if you can specify the revision number, and pull that from a data bag, then ye
[2012-02-08 21:12:00 -0500] AmishGeek: yes
[2012-02-08 21:12:00 -0500] spicyWith: AmishGeek: awesome :)
[2012-02-08 21:13:00 -0500] jtimberman: spicyWith: what kind of application are you deploying?
[2012-02-08 21:13:00 -0500] spicyWith: jtimberman: django :(
[2012-02-08 21:13:00 -0500] spicyWith: I almost got it going with coderanger 's new method, but it didn't support github private repos :(
[2012-02-08 21:14:00 -0500] jtimberman: spicyWith: ah
[2012-02-08 21:14:00 -0500] spicyWith: jtimberman: why do you ask?
[2012-02-08 21:14:00 -0500] jtimberman: spicyWith: i was going to suggest the application cookbook w/ the django deploy style
[2012-02-08 21:14:00 -0500] jtimberman: :)
[2012-02-08 21:15:00 -0500] spicyWith: jtimberman: I've been looking at the official one you guys have
[2012-02-08 21:15:00 -0500] miah: i have some really hacky cookbooks that do initial deployments from github private repos.
[2012-02-08 21:15:00 -0500] jtimberman: s/official//
[2012-02-08 21:16:00 -0500] spicyWith: jtimberman: well, the django-quickstart? not official?
[2012-02-08 21:16:00 -0500] miah: nice
[2012-02-08 21:18:00 -0500] jtimberman: spicyWith: i put the term "official" in the "things that are rather nefarious and used incorrectly most of the time" like "best practice" :)
[2012-02-08 21:18:00 -0500] fujin: i think deploying from source control is a bad idea
[2012-02-08 21:18:00 -0500] fujin: not to mention bundling or virtualenv on the edge, having to build and install stuff is weak as fuck.
[2012-02-08 21:18:00 -0500] fujin: you really want that shit to be all binary artifacts
[2012-02-08 21:18:00 -0500] fujin: drop and go. boom
[2012-02-08 21:18:00 -0500] spicyWith: fujin: better option?
[2012-02-08 21:19:00 -0500] spicyWith: jtimberman: this is just an odd recipe and not very representative of a django app: https://github.com/opscode/django-quick-start/blob/master/cookbooks/django_cms/recipes/status.rb
[2012-02-08 21:19:00 -0500] fujin: I use jenkins to build binary assets for the dependency chain for a given application, packaged with .deb (or .rpm for centos clients), hosted in a distro specific repository (like reprepro, etc)
[2012-02-08 21:19:00 -0500] fujin: pennyworth?
[2012-02-08 21:19:00 -0500] bawt: pennyworth is https://github.com/heavywater/pennyworth
[2012-02-08 21:19:00 -0500] fujin: pennyworth is databag -> jenkins integration for that whole dance ^^
[2012-02-08 21:20:00 -0500] fujin: http://junglist.gen.nz/blog/2011/11/16/pennyworth-quick-start/
[2012-02-08 21:20:00 -0500] spicyWith: fujin: looks badass
[2012-02-08 21:20:00 -0500] jtimberman: spicyWith: yeah. that recipe is not required.
[2012-02-08 21:20:00 -0500] jtimberman: spicyWith: its used by default
[2012-02-08 21:20:00 -0500] jtimberman: we have a feature of the management console in Opscode Hosted Chef that uses that
[2012-02-08 21:21:00 -0500] jtimberman: and by default i mean in the django-quick-start relevant role
[2012-02-08 21:22:00 -0500] spicyWith: jtimberman: I'm trying to get it to work, but it ain't happy right now
[2012-02-08 21:22:00 -0500] spicyWith: jtimberman: I'm on my own if I want to create postgresql users, right?
[2012-02-08 21:23:00 -0500] jtimberman: spicyWith: postgresql users are just users on the system, you give them access to the database in hba.conf iirc.
[2012-02-08 21:24:00 -0500] fujin: ours is lame: https://github.com/heavywater/chef-app/blob/master/recipes/db_postgres.rb
[2012-02-08 21:24:00 -0500] spicyWith: jtimberman: that would make sense
[2012-02-08 21:24:00 -0500] fujin: spicyWith: ^^
[2012-02-08 21:25:00 -0500] thbar: for those on windows + solo: https://github.com/thbar/knife-solo/commit/7e246bdea803f08a3de2bb69328ce01e5a95b852 (preliminary Windows support for knife-solo)
[2012-02-08 21:25:00 -0500] yfeldblum: jtimberman, postgresql users are not os users
[2012-02-08 21:26:00 -0500] spicyWith: yfeldblum: how does it work then?
[2012-02-08 21:26:00 -0500] jtimberman: I'm sorry.
[2012-02-08 21:26:00 -0500] thbar: @jtimberman do you know who currently packages the chef windows msi installer? I'd like to suggest adding rsync to the pack (https://github.com/thbar/rsync-windows)
[2012-02-08 21:26:00 -0500] jtimberman: I should not be consulted for questions on postgresql :)
[2012-02-08 21:27:00 -0500] jtimberman: yfeldblum: so the postgres user is special beans then?
[2012-02-08 21:27:00 -0500] jtimberman: thbar: we package the Chef Windows MSI with our omnibus tool.
[2012-02-08 21:27:00 -0500] jtimberman: thbar: open a ticket in the CHEF project, use the packages component an the omnibus label
[2012-02-08 21:28:00 -0500] coderanger: jtimberman: In most setups there is a local ident authorization for system user postgres to access db user postgres
[2012-02-08 21:28:00 -0500] thbar: jtimberman: thanks! will do that
[2012-02-08 21:29:00 -0500] jtimberman: databases, why do you make things hard.
[2012-02-08 21:29:00 -0500] moos3: how can i easly tell if a node is centos 5 or centos 6 in a recipe ?
[2012-02-08 21:29:00 -0500] spicyWith: jtimberman: seriously...
[2012-02-08 21:29:00 -0500] yfeldblum: jtimberman, yes, the local postgres user, which the postgres daemon runs as anyway, is permitted root-level access to the stuff in the postgres instance
[2012-02-08 21:29:00 -0500] jtimberman: moos3: node['platform_version']
[2012-02-08 21:30:00 -0500] jtimberman: moos3: will be 5.x or 6.x depending on the release version that is listed in /etc/redhat-release
[2012-02-08 21:30:00 -0500] yfeldblum: jtimberman, but that's special beans, since most of the time you'll want to create users within postgres
[2012-02-08 21:31:00 -0500] jtimberman: indeed.
[2012-02-08 21:31:00 -0500] jtimberman: I'll go back to writing about a topic I know about, Chef :)
[2012-02-08 21:33:00 -0500] hippiehacker: is there been any thought to how we approach making cookbooks cross platfrom?
[2012-02-08 21:33:00 -0500] hippiehacker: I'm thinking about making chef_handler work on windows: https://github.com/opscode/cookbooks/blob/master/chef_handler/recipes/default.rb#L25
[2012-02-08 21:34:00 -0500] spicyWith: fujin: what's the deploy_key.rb about in that repo
[2012-02-08 21:34:00 -0500] spicyWith: ?
[2012-02-08 21:34:00 -0500] fujin: spicyWith: it's so you can use it with github
[2012-02-08 21:34:00 -0500] fujin: if you don't ship a known hosts, git will prompt if you want to accept the damn fingerprint
[2012-02-08 21:34:00 -0500] fujin: IIRC, anyway :)
[2012-02-08 21:35:00 -0500] Drewzar: http://help.github.com/deploy-keys/
[2012-02-08 21:36:00 -0500] moos3: k
[2012-02-08 21:38:00 -0500] spicyWith: fujin: looks pretty good, thanks, although I'll take it you don't use this
[2012-02-08 21:38:00 -0500] fujin: for some clients not using pennyworth we do, yeah
[2012-02-08 21:38:00 -0500] fujin: of course
[2012-02-08 21:38:00 -0500] fujin: it's often useful for more rapid development environments too, like if you wanted an app server per developer
[2012-02-08 21:38:00 -0500] spicyWith: pennyworth?
[2012-02-08 21:38:00 -0500] bawt: pennyworth is https://github.com/heavywater/pennyworth
[2012-02-08 21:38:00 -0500] fujin: that developer might want to have that app server track a remote branch instead of having to build packages
[2012-02-08 21:38:00 -0500] fujin: for faster cycles
[2012-02-08 21:39:00 -0500] thbar: jtimberman: added the rsync issue at http://tickets.opscode.com/browse/CHEF-2918
[2012-02-08 21:39:00 -0500] jtimberman: thbar: thanks!
[2012-02-08 21:39:00 -0500] thbar: you welcome :) I can work on an automated process if you'd like for that
[2012-02-08 21:40:00 -0500] spicyWith: general q, when a new version of chef server comes out, how would I migrate my current installation?
[2012-02-08 21:41:00 -0500] bdha: Install the new gems, restart the server.
[2012-02-08 21:41:00 -0500] bdha: For minor versions, I've had no issues.
[2012-02-08 21:44:00 -0500] and311: Does anyone out there have suggestions for best practices involving "helper" resources/libraries? I find myself repeating a lot of small things in my cookbooks, and want to role up these common elements into one cookbook, but something about it feels off.
[2012-02-08 21:45:00 -0500] fujin: not really sure what you are looking for here man
[2012-02-08 21:45:00 -0500] fujin: libraries?
[2012-02-08 21:45:00 -0500] bawt: libraries is http://wiki.opscode.com/display/chef/Libraries
[2012-02-08 21:45:00 -0500] fujin: lwrps?
[2012-02-08 21:45:00 -0500] bawt: lwrps is Lightweight Resources and Providers, a simple DSL to write custom resources in cookbooks, main documentation at http://wiki.opscode.com/display/chef/Light-weight+Resources+and+Providers+%28LWRP%29 and Opscode's open source cookbooks with LWRPs are documented at http://wiki.opscode.com/display/chef/Opscode+LWRP+Resources
[2012-02-08 21:46:00 -0500] and311: Yeah I know all about that stuff.
[2012-02-08 21:46:00 -0500] fujin: if you have code you are repeating all the time, abstract it to a library and model the components as parameters to a resource, invoke the library from the provider.
[2012-02-08 21:46:00 -0500] fujin: and311: I think the answer you are looking for is "yes"
[2012-02-08 21:46:00 -0500] and311: I mean more generally from a best practice standpoint, if I repeat a similar set of logic in several disparate cookbooks, is it normal to roll up those common things into a "common" cookbook and have everything depend on it.
[2012-02-08 21:46:00 -0500] fujin: I regularly release cookbooks all the time that just contain libraries and spec code
[2012-02-08 21:47:00 -0500] fujin: kind of? I guess a few of my cookbooks depend on my discovery cookbook, which has search + ipaddress helpers.
[2012-02-08 21:47:00 -0500] fujin: discovery?
[2012-02-08 21:47:00 -0500] fujin: http://ckbk.it/discovery
[2012-02-08 21:47:00 -0500] fujin: discovery is http://ckbk.it/discovery
[2012-02-08 21:47:00 -0500] and311: K, I'll check out discovery.
[2012-02-08 21:47:00 -0500] and311: I only ask because many cookbooks out there are pretty self-contained.
[2012-02-08 21:48:00 -0500] fujin: I think most of my cookbooks depend on iptables, and ship a firewall rule
[2012-02-08 21:49:00 -0500] fujin: so that's another common pattern like that
[2012-02-08 21:49:00 -0500] and311: So basically then, from looking at the code, discovery is an example of something that really just is meant to help other cookbooks.
[2012-02-08 21:49:00 -0500] fujin: absolutely
[2012-02-08 21:49:00 -0500] fujin: It abstracts a lot of common logic related to Searching for nodes and reacting to search response away to the library
[2012-02-08 21:49:00 -0500] fujin: e.g., finding the most recent node, finding nodes in or outside of the environment
[2012-02-08 21:49:00 -0500] fujin: finding a particular ip address for a given node based on network locality with the current node
[2012-02-08 21:50:00 -0500] fujin: all basically achievable with oneliners
[2012-02-08 21:50:00 -0500] fujin: I think that is desired behavior, but I don't really know if it is "best practice" :)
[2012-02-08 21:51:00 -0500] and311: Yeah, the struggle I'm having is that I find myself modifying official cookbooks a lot to do more things, and then those modifications contain a lot of common code.
[2012-02-08 21:51:00 -0500] and311: Putting that common code into another cookbook would then make it a bit harder to share the changes (if I ever want to) to the other cookbooks.
[2012-02-08 21:52:00 -0500] and311: This is helpful though, just seeing how other people think about it.
[2012-02-08 21:57:00 -0500] hippiehacker: chef-handler-mail depends on pony->mail which uses sendmail 8( hard to do on windows
[2012-02-08 21:57:00 -0500] hippiehacker: any thoughts on a chef-handler that runs on windows to generate an email?
[2012-02-08 21:58:00 -0500] kallistec: hippiehacker: IIRC, pony will talk smtp if you ask nicely
[2012-02-08 21:59:00 -0500] hippiehacker: kallistec: I'll prompt the pony to do tricks and see if it responds. Perhaps I should use a carrot.
[2012-02-08 21:59:00 -0500] kallistec: I think it just uses sendmail so that everything will hopefully be already configured and there for easy
[2012-02-08 21:59:00 -0500] KarlHungus: whats a good tactic for letting the "root" group be platform independant?
[2012-02-08 22:00:00 -0500] kallistec: hippiehacker: https://github.com/benprew/pony
[2012-02-08 22:00:00 -0500] hippiehacker: I had the following on STDERR 'which: no sendmail in (c:\utils\u'
[2012-02-08 22:00:00 -0500] KarlHungus: often root isn't a group, and wheel is
[2012-02-08 22:00:00 -0500] kallistec: hippiehacker: yeah, you'll need more config, which may or may not be exposed by the handler
[2012-02-08 22:00:00 -0500] kallistec: but it shouldn't be hard to add
[2012-02-08 22:01:00 -0500] fujin: KarlHungus: you can use value_for_platform
[2012-02-08 22:02:00 -0500] KarlHungus: fujin: interesting, ty
[2012-02-08 22:08:00 -0500] Willejs: hi, I've got a problem with variables in a template file
[2012-02-08 22:08:00 -0500] Willejs: in my default.rb i define the same variable from the same data source in two separate templates, but it only works in the first template
[2012-02-08 22:13:00 -0500] spicyWith: fujin: that chef-app repo assumes everything is running on the same machine, correct?
[2012-02-08 22:13:00 -0500] fujin: no, usually have components across multiple machines
[2012-02-08 22:13:00 -0500] fujin: i think that version is a little outdated. one sec
[2012-02-08 22:14:00 -0500] j-v-e: data bag quesiton
[2012-02-08 22:15:00 -0500] j-v-e: I have this databag that contains the key of my ossec agents
[2012-02-08 22:15:00 -0500] j-v-e: so plenty of agents, each containing a name, ip and key
[2012-02-08 22:15:00 -0500] j-v-e: is there a way to pass that databag to my template directly, and iterate through it in the template ?
[2012-02-08 22:16:00 -0500] jtimberman: j-v-e: you should retrieve it in the recipe and pass to the template via the variables parameter.
[2012-02-08 22:17:00 -0500] j-v-e: jtimberman: I have something like that http://pastebin.com/y5qWKi8J
[2012-02-08 22:18:00 -0500] savant: hi all
[2012-02-08 22:18:00 -0500] j-v-e: problem is: my template syntax is obviously wrong, and I'm not sure how I should iterate throught the keys in the template
[2012-02-08 22:18:00 -0500] savant: is there a way to output debug info when running chef
[2012-02-08 22:18:00 -0500] fujin: spicyWith: which recipe you referring to?
[2012-02-08 22:18:00 -0500] |shad0w|: you need @agents to reference the passed var I believe
[2012-02-08 22:18:00 -0500] silk: -l debug
[2012-02-08 22:19:00 -0500] spicyWith: fujin: https://github.com/heavywater/chef-app/blob/master/recipes/db_postgres.rb
[2012-02-08 22:19:00 -0500] fujin: yeh that one looks like it is setup for localhost
[2012-02-08 22:19:00 -0500] fujin: spicyWith: the cliient I recently used the cookbook at uses mysql, and we used percona
[2012-02-08 22:19:00 -0500] fujin: spicyWith: so the version I have here that I'm about to set up on a branch with a pull request has discovery & mysql client
[2012-02-08 22:20:00 -0500] spicyWith: fujin: so I should store that db info on a data bag
[2012-02-08 22:20:00 -0500] fujin: I don't, no
[2012-02-08 22:20:00 -0500] fujin: here, one sec
[2012-02-08 22:20:00 -0500] fujin: i'll show you waht I do for mysql
[2012-02-08 22:24:00 -0500] savant: so ubuntu removed java from their repos - thank you oracle - and i need to install elastic search
[2012-02-08 22:24:00 -0500] savant: anyone know if the solution here is valid: http://tickets.opscode.com/browse/COOK-980
[2012-02-08 22:26:00 -0500] monkeymike: is there anyway to get the Amazon availability zone of an EC2 server behind the VPC in Chef?
[2012-02-08 22:27:00 -0500] j-v-e: is there a more efficient way to poke around the syntax of my template than reuploading it every time and running chef-client every time ?
[2012-02-08 22:29:00 -0500] asgmo: savant: the open-jdk has been working fine for me fwiw
[2012-02-08 22:29:00 -0500] coderanger: monkeymike: We just dump everything fog knows about into the ohai data IIRC
[2012-02-08 22:29:00 -0500] jtimberman: j-v-e: the erb syntax or the config file output syntax?
[2012-02-08 22:29:00 -0500] savant: i hear that open-jdk doesn't play as nicely as the oracle one
[2012-02-08 22:29:00 -0500] ssd7_: monkeymike: I am unsure about the availbility zone, but the first hoop you need to jump through is getting teh ec2 ohai plugin to work on VPC
[2012-02-08 22:30:00 -0500] j-v-e: jtimberman: the erb syntax
[2012-02-08 22:30:00 -0500] ssd7_: monkeymike: It currently fails to detect VPC nodes as on EC2
[2012-02-08 22:30:00 -0500] jtimberman: j-v-e: "knife cookbook test COOKBOOKNAME" will perform a syntax check on the .rb and .erb files in the cookbook itself to make sure the Ruby syntax is valid
[2012-02-08 22:30:00 -0500] ssd7_: monkeymike: One sec.  Link incoming.
[2012-02-08 22:30:00 -0500] monkeymike: ok
[2012-02-08 22:30:00 -0500] j-v-e: jtimberman: that's useful, thanks
[2012-02-08 22:31:00 -0500] fujin: spicyWith: https://github.com/heavywater/chef-app/pull/1
[2012-02-08 22:31:00 -0500] fujin: spicyWith: that's basically what I did for mysql. :)
[2012-02-08 22:31:00 -0500] stphung: does anyone know if it is possible to use definitions from within definitions?  is there anything special we need to do to have that happen? like an include or anything
[2012-02-08 22:31:00 -0500] fujin: stphung: you probably want to use lwrps
[2012-02-08 22:31:00 -0500] ssd7_: monkeymike: http://tickets.opscode.com/browse/OHAI-310 <- the last comment there points to a support ticket with some details about how you can ship a custom ec2 plugin to your nodes.
[2012-02-08 22:32:00 -0500] monkeymike: okay thanks i'll read through it
[2012-02-08 22:32:00 -0500] stphung: fujin: I'll check it out, thanks
[2012-02-08 22:42:00 -0500] Willejs: can anyone help me with chefs template variables?
[2012-02-08 22:43:00 -0500] ssd7_: Willejs: probably, what's up?
[2012-02-08 22:43:00 -0500] Willejs: i am successfully using them, then i added another template to the same recipe file, and set the same variables and the second ones don't work
[2012-02-08 22:44:00 -0500] Willejs: http://pastebin.com/4ARLyXRx
[2012-02-08 22:45:00 -0500] Willejs: i changed the name of the symbol in the second variable just to see if it made a difference, it didnt.
[2012-02-08 22:45:00 -0500] Willejs: .
[2012-02-08 22:45:00 -0500] Locutus233: Is it possible to read attributes from a role ?
[2012-02-08 22:46:00 -0500] ssd7_: Willejs: Hmm.  What error are you getting and are you doing anything destructive in that first template?
[2012-02-08 22:46:00 -0500] Willejs: nope the template just asks to display that one variable
[2012-02-08 22:46:00 -0500] Willejs: @mgmt
[2012-02-08 22:46:00 -0500] Willejs: encapsulated in <> and stuff
[2012-02-08 22:47:00 -0500] fujin: show the templates and debug output from chef
[2012-02-08 22:48:00 -0500] Willejs:  <% if node.roles.include?("dbcluster-data") == true -%>
[2012-02-08 22:48:00 -0500] Willejs: ndbcluster
[2012-02-08 22:48:00 -0500] Willejs: ndb-connectstring= <% @mgmt -%>  #This is the management node
[2012-02-08 22:48:00 -0500] Willejs: <% end -%>
[2012-02-08 22:48:00 -0500] fujin: on a pastebin, dude
[2012-02-08 22:48:00 -0500] Willejs: sorry.
[2012-02-08 22:49:00 -0500] fujin: so yeah, the source of the templates, the debug output from chef
[2012-02-08 22:49:00 -0500] fujin: the contents of the rendered templates
[2012-02-08 22:49:00 -0500] fujin: all on pastebins or gists
[2012-02-08 22:50:00 -0500] Willejs: the debug output from chef doesn't mention it not displaying the variable
[2012-02-08 22:50:00 -0500] Willejs: i wondered if there was something wrong i have done in the recipe?
[2012-02-08 22:51:00 -0500] Willejs: http://pastebin.com/30kYiiu2        http://pastebin.com/1xaEV5tv
[2012-02-08 22:52:00 -0500] erikh: is opscode plat down?
[2012-02-08 22:52:00 -0500] erikh: my machines are timing out during converge runs
[2012-02-08 22:54:00 -0500] grantr: question about knife ec2
[2012-02-08 22:55:00 -0500] grantr: what is the difference between --distro and --template-file
[2012-02-08 22:55:00 -0500] fujin: knife status seems to be taking an awfully long time erikh
[2012-02-08 22:55:00 -0500] grantr: do they both ultimately select the bootstrap template to use?
[2012-02-08 22:55:00 -0500] fujin: i got a response though
[2012-02-08 22:55:00 -0500] fujin: grantr: yeh distro is just a shortcut to it, you don't have to specify the full path
[2012-02-08 22:55:00 -0500] erikh: hrm
[2012-02-08 22:55:00 -0500] erikh: maybe it was just down temporarily
[2012-02-08 22:55:00 -0500] erikh: I'll try again
[2012-02-08 22:56:00 -0500] grantr: fujin, so distro lets you specify just the template name, while --template-file is the full path to the template file
[2012-02-08 22:56:00 -0500] fujin: yahuh
[2012-02-08 22:56:00 -0500] grantr: -d ubuntu10.04-gems OR --template-file /path/to/ubuntu10.04-gems.erb
[2012-02-08 22:56:00 -0500] fujin: right
[2012-02-08 22:56:00 -0500] grantr: thanks
[2012-02-08 22:58:00 -0500] erikh: fujin: yeah, it finally converged on the two nodes I was testing on -- thanks for verifying
[2012-02-08 22:58:00 -0500] Willejs: fujin: here are the links. recipe: http://pastebin.com/4ARLyXRx   templates: http://pastebin.com/30kYiiu2        http://pastebin.com/1xaEV5tv
[2012-02-08 22:59:00 -0500] fujin: Willejs: so what is ending up in those files?
[2012-02-08 22:59:00 -0500] fujin: doe the node include that role that you are testing for?
[2012-02-08 22:59:00 -0500] Willejs: the nbd_mgmt.cnf works
[2012-02-08 22:59:00 -0500] fujin: you don't need the == true on a .include? call btw, it is already true/false
[2012-02-08 22:59:00 -0500] Willejs: but the my.cnf doesent
[2012-02-08 22:59:00 -0500] Willejs: ahh cheers.
[2012-02-08 22:59:00 -0500] Willejs: the my.cnf.erb template is second, and doesn't seem to assign the value?
[2012-02-08 23:00:00 -0500] fujin: could be because there is already a template for my.cnf in the mysql cookbook? not sure. what ends up in the file?
[2012-02-08 23:00:00 -0500] fujin: you could put something like
[2012-02-08 23:00:00 -0500] fujin: <% Chef::Log.info "something is #{someting}" %> in the template
[2012-02-08 23:00:00 -0500] fujin: to test that it is being passed through. :)
[2012-02-08 23:00:00 -0500] fujin: it sounds like you have something funny going on though
[2012-02-08 23:01:00 -0500] fujin: https://github.com/opscode/cookbooks/blob/master/mysql/recipes/server.rb#L91
[2012-02-08 23:01:00 -0500] fujin: the mysql cookbook defines that template as well
[2012-02-08 23:02:00 -0500] Willejs: ahh!
[2012-02-08 23:02:00 -0500] Willejs: that makes sence
[2012-02-08 23:03:00 -0500] Willejs: its making the my.cnf, and my recipe isnt
[2012-02-08 23:03:00 -0500] Willejs: my recipe calls it too tho?
[2012-02-08 23:04:00 -0500] Willejs: basically i made a recipe for mysqlcluster and i wanted to add the ndbstring into my.cnf, and am calling the template from my recipie
[2012-02-08 23:04:00 -0500] Willejs: but it would seem that my recipe isn't running it because its not inserting the value
[2012-02-08 23:05:00 -0500] spicyWith: fujin: thanks :). How does this apply to postgres? Tried the recipe. Should I be able to log in from an external client using the user I created or does it not have enough privileges?
[2012-02-08 23:09:00 -0500] fujin: spicyWith: you could almost do the exact same thing with postgres, I guess :)
[2012-02-08 23:10:00 -0500] fujin: should be able to login with the mysql cli, yes, of course
[2012-02-08 23:12:00 -0500] j-v-e: when using data bags, each item must be in a separate json file ?
[2012-02-08 23:12:00 -0500] Willejs: fujin: sorry, any ideas?
[2012-02-08 23:20:00 -0500] Guest14019: anyone aware of any tools for using cucumber with chef that /don't/ rely on EC2?
[2012-02-08 23:21:00 -0500] spicyWith: fujin: the pass variable in the chef-app repo is an md5 checksum?
[2012-02-08 23:21:00 -0500] fujin: Guest14019: that was what I thought when I looked at cucumber-chef too
[2012-02-08 23:22:00 -0500] fujin: i wrote the minitest cookbook for chef, you could bolt cucumber into that (probably)
[2012-02-08 23:22:00 -0500] fujin: minitest?
[2012-02-08 23:22:00 -0500] bawt: minitest is fun :D
[2012-02-08 23:22:00 -0500] fujin: !forget minitest
[2012-02-08 23:22:00 -0500] bawt: fine
[2012-02-08 23:22:00 -0500] Guest14019: cool, I'll take a look- thanks :)
[2012-02-08 23:22:00 -0500] fujin: chef-minitest is https://github.com/fujin/chef-minitest
[2012-02-08 23:22:00 -0500] fujin: it has some bugs
[2012-02-08 23:22:00 -0500] Guest14019: I seem to remember jedi4ever mentioning work on getting cucumber-chef to support vagrant, but that was a while ago
[2012-02-08 23:22:00 -0500] fujin: but that's half the fun, or whatever!
[2012-02-08 23:24:00 -0500] Willejs: fujin: do you think it could be because i am calling the template from two recipes? is there a way for two recipes to work with the same template?
[2012-02-08 23:26:00 -0500] fujin: can my.cnf include other files?
[2012-02-08 23:27:00 -0500] fujin: https://github.com/opscode/cookbooks/blob/master/mysql/templates/default/my.cnf.erb#L175
[2012-02-08 23:27:00 -0500] fujin: yes. it can
[2012-02-08 23:27:00 -0500] fujin: Willejs: so just put a file into that directory and profit
[2012-02-08 23:27:00 -0500] miah: there is chefspec too
[2012-02-08 23:27:00 -0500] fujin:  /etc/mysql/conf.d/whatever.cnf
[2012-02-08 23:27:00 -0500] miah: https://github.com/acrmp/chefspec
[2012-02-08 23:27:00 -0500] fujin: miah: yeh, been meaning to look at that. i have been doing a bit of rspec lately instead of minitest
[2012-02-08 23:28:00 -0500] Willejs: ah ha! cheers fujin, i was thinking a crafty include would work
[2012-02-08 23:28:00 -0500] Willejs: *could
[2012-02-08 23:29:00 -0500] fujin: chefspec is much more feature rich than minitest
[2012-02-08 23:29:00 -0500] fujin: lol
[2012-02-08 23:30:00 -0500] miah: it looks pretty good, i'm fairly new to actually writing tests though.
[2012-02-08 23:30:00 -0500] Guest14019: cool, I'll check that out, too; thanks, miah
[2012-02-08 23:30:00 -0500] miah: you're welcome
[2012-02-08 23:33:00 -0500] jhowarth: ohai is reporting my node's ipaddress as 127.0.0.1, even though when I run ifconfig eth0 has the correct ip.  Any idea why that might be?
[2012-02-08 23:38:00 -0500] mlei: hi guys. i've got chef 0.10.8 up and running and everything is fine except that search isn't working
[2012-02-08 23:38:00 -0500] mlei: any search i try returns 0 results
[2012-02-08 23:38:00 -0500] mlei: i wasn't able to find a troubleshooting page about search specifically... can anyone point me to one, or tell me where to look first?
[2012-02-08 23:39:00 -0500] |shad0w|: did you start the chef expander service?
[2012-02-08 23:40:00 -0500] mlei: yes, all the chef server services are running. i even restarted them all a few times for superstition's sake
[2012-02-08 23:40:00 -0500] |shad0w|: rabbitmq is running?
[2012-02-08 23:40:00 -0500] mlei: yep.
[2012-02-08 23:40:00 -0500] |shad0w|: and the passwords for it set properly?
[2012-02-08 23:40:00 -0500] miketheman: just wanted to briefly say that local vs global vars in erb can drive one nuts
[2012-02-08 23:40:00 -0500] mlei: yes. didn't change the defaults
[2012-02-08 23:41:00 -0500] |shad0w|: rabbitmqctl list_vhosts ?
[2012-02-08 23:42:00 -0500] mlei: it shows / and /chef
[2012-02-08 23:43:00 -0500] |shad0w|: rabbitmqctl list_users
[2012-02-08 23:43:00 -0500] mlei: chef - false; guest - true
[2012-02-08 23:43:00 -0500] mlei: what does the false mean
[2012-02-08 23:45:00 -0500] |shad0w|: what options did you start chef-expander with?
[2012-02-08 23:46:00 -0500] mlei: i can check; it's started from the init script. this is rubygems install on a centos 5.7 box
[2012-02-08 23:46:00 -0500] mlei: OPTIONS="-n 1 -i 1" is what it says in /etc/sysconfig/chef-expander
[2012-02-08 23:47:00 -0500] mlei: this is what ps says:
[2012-02-08 23:47:00 -0500] mlei:  /usr/bin/ruby /usr/sbin/chef-expander -d -c /etc/chef/expander.rb -L /var/log/chef/expander.log -P /var/run/chef/expander.pid -n 1 -i 1
[2012-02-08 23:47:00 -0500] |shad0w|: and solr is running?
[2012-02-08 23:47:00 -0500] mlei: yes
[2012-02-08 23:47:00 -0500] mlei: i can see requests being handled in solr
[2012-02-08 23:47:00 -0500] mlei: this is an example of a request
[2012-02-08 23:47:00 -0500] mlei: INFO: [] webapp=/solr path=/select params={sort=X_CHEF_id_CHEF_X+asc&indent=off&start=0&q=*:*&wt=json&fq=%2BX_CHEF_type_CHEF_X:node+%2BX_CHEF_database_CHEF_X:chef&rows=1000} hits=0 status=0 QTime=1
[2012-02-08 23:48:00 -0500] mlei: they are just all returning 0 hits
[2012-02-08 23:48:00 -0500] |shad0w|: and you've had a client do a sucessful run?
[2012-02-08 23:48:00 -0500] mlei: i've tried a bunch of different searches, they all return 0 hits. knife node list shows 2 nodes
[2012-02-08 23:48:00 -0500] mlei: two clients.
[2012-02-08 23:48:00 -0500] mlei: the server itself and one other
[2012-02-08 23:49:00 -0500] judd7: mlei and you can knife node show <your node> -l
[2012-02-08 23:49:00 -0500] judd7: :)
[2012-02-08 23:50:00 -0500] judd7: paste your wildcard search syntax.
[2012-02-08 23:50:00 -0500] mlei: i'm simply pushing the buttons in the search in chef webui
[2012-02-08 23:50:00 -0500] judd7: knife search node 'name:*' ?
[2012-02-08 23:50:00 -0500] mlei: with no arguments
[2012-02-08 23:50:00 -0500] mlei: none of them will give me any hits
[2012-02-08 23:51:00 -0500] mlei: let me try knife search
[2012-02-08 23:51:00 -0500] mlei: yeah same thing: 0 items found
[2012-02-08 23:51:00 -0500] judd7: your bootstraps ran to completion?
[2012-02-08 23:52:00 -0500] mlei: yeah as far as i know
[2012-02-08 23:52:00 -0500] judd7: that is, chef-client runs on the nodes without error?
[2012-02-08 23:52:00 -0500] mlei: yes
[2012-02-08 23:52:00 -0500] mlei: as i said, the nodes are there
[2012-02-08 23:52:00 -0500] mlei: knife node list shows them
[2012-02-08 23:52:00 -0500] mlei: only search is broken
[2012-02-08 23:52:00 -0500] judd7: Then it's mostly likely the server.
[2012-02-08 23:53:00 -0500] |shad0w|: what os did you install this on?
[2012-02-08 23:53:00 -0500] mlei: yeah that's what i thought, but i'm at a loss as to where to look to see where the problem might be. it's centos 5.7
[2012-02-08 23:53:00 -0500] mlei: installed via rubygems.
[2012-02-08 23:53:00 -0500] |shad0w|: i'd make sure the rabbitmq pass is correct
[2012-02-08 23:53:00 -0500] |shad0w|: does /etc/chef/amqp_passwd exist?
[2012-02-08 23:54:00 -0500] mlei: no
[2012-02-08 23:54:00 -0500] mlei: what's supposed to create that?
[2012-02-08 23:55:00 -0500] mlei: only place i see the password is in /etc/chef/expander.rb
[2012-02-08 23:55:00 -0500] Willejs: fujin: making a new .cnf file in conf.d/ didn't work, the value was still not inserted there.
[2012-02-08 23:57:00 -0500] |shad0w|: mlei, I don't remember. I created it manually iirc. My conf has this
[2012-02-08 23:57:00 -0500] |shad0w|: chefdal0501# grep -i amqp /etc/chef/server.rb
[2012-02-08 23:57:00 -0500] |shad0w|: amqp_pass File.read('/etc/chef/amqp_passwd').chomp
[2012-02-08 23:57:00 -0500] |shad0w|: and I have the same in /etc/chef/solr.rb
[2012-02-08 23:57:00 -0500] mlei: i don't have amqp_pass in server.rb
[2012-02-08 23:57:00 -0500] mlei: why do i need it there?
[2012-02-08 23:58:00 -0500] mlei: i have amqp_pass as a literal in both expander.rb and solr.rb
[2012-02-08 23:58:00 -0500] mlei: it's the same in both places
[2012-02-08 23:58:00 -0500] mlei: (i.e. "testing")
[2012-02-08 23:58:00 -0500] |shad0w|: and that is the pass you set when you added the chef user to rabbitmq ?
[2012-02-08 23:58:00 -0500] |shad0w|: I can't remeber if something else attempts to load that file
[2012-02-08 23:58:00 -0500] mlei: i didn't add the chef user manually
[2012-02-08 23:58:00 -0500] mlei: the install did it
[2012-02-08 23:59:00 -0500] |shad0w|: you could just reset it
[2012-02-08 23:59:00 -0500] mlei: how do i check the password in rabbitmq?
