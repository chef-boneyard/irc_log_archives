[2012-02-17 08:01:00 -0500] BryanWB: quazimodo: it can do deployment  or u can use a deployment manager like capistrano, rundeck
[2012-02-17 08:12:00 -0500] quazimodo: BryanWB: ive seen people complaining about capistrano
[2012-02-17 08:12:00 -0500] quazimodo: never used it
[2012-02-17 08:13:00 -0500] BryanWB: quazimodo: i haven't used it a lot, but I like it
[2012-02-17 08:13:00 -0500] BryanWB: quazimodo: checkout chef-deploy on github
[2012-02-17 08:15:00 -0500] quazimodo: cheers BryanWB
[2012-02-17 08:15:00 -0500] fujin: chef deploy is built in now. the one on github is ancient
[2012-02-17 08:15:00 -0500] fujin: for like chef 0.7
[2012-02-17 08:15:00 -0500] fujin: deploy?
[2012-02-17 08:15:00 -0500] bawt: deploy is http://wiki.opscode.com/display/chef/Deploy+Resource
[2012-02-17 08:15:00 -0500] fujin: check that shit out ^
[2012-02-17 08:17:00 -0500] royh: fujin: that's nice and dandy.. but how can you trigger chef to run simultanously to deploy code among multiple boxes at the same time?
[2012-02-17 08:17:00 -0500] fujin: most people use ssh.
[2012-02-17 08:18:00 -0500] royh: well.. lets say you have 50 boxes and you want them all to have the same code with a margin of say 5 seconds
[2012-02-17 08:19:00 -0500] royh: should whatever user is triggering the deployment become root and then run knife ssh?
[2012-02-17 08:19:00 -0500] fujin: dunno. if you like
[2012-02-17 08:19:00 -0500] fujin: i wouldn't
[2012-02-17 08:19:00 -0500] fujin: I don't use the deploy provider to deploy my shit
[2012-02-17 08:19:00 -0500] royh: how would you do it?
[2012-02-17 08:19:00 -0500] fujin: I build binary assets of the code I'm going to roll out during the continuous test system
[2012-02-17 08:20:00 -0500] fujin: I've been working on some stuff in this area, for coordinated deployment between a few nodes
[2012-02-17 08:20:00 -0500] fujin: but it's technical stuff, distributed systems shit
[2012-02-17 08:20:00 -0500] fujin: start small I guess would be my recommendation get something slow that works when you run chef
[2012-02-17 08:38:00 -0500] nico: royh: you can use mcollective
[2012-02-17 08:38:00 -0500] nico: I trigger chef runs with it
[2012-02-17 08:52:00 -0500] frank_: all, is there any plans to make knife cookbook more intelligent, more git like?
[2012-02-17 08:52:00 -0500] frank_: eg i'd want a "knife cookbook status" which tells you what cookbooks you have, that are newer than the one on the server
[2012-02-17 08:53:00 -0500] frank_: and a more intelligent "knife cookbook upload -a" that uploads all cookbooks, if the local version is newer than the current one
[2012-02-17 08:53:00 -0500] frank_: or do you guys use git post-commit hooks to knife cookbook upload?
[2012-02-17 08:53:00 -0500] royh: nico: i hear a lot of fuzz about it. how is it different from running knife ssh?
[2012-02-17 08:55:00 -0500] nico: royh: does not relies on ssh, all runs will be triggered at the same time, you can filter your output. We use it because we use the mcollective framework for other stuff too. scales damn well
[2012-02-17 08:57:00 -0500] fujin: it's kind of like a message bus rpc system. great really
[2012-02-17 08:57:00 -0500] fujin: some of the stuff I was hinting at earlier, you can achieve some distributed coordination with it
[2012-02-17 08:57:00 -0500] fujin: I don't know that he offers any locking primitives, watches, or anything like that
[2012-02-17 08:57:00 -0500] fujin: but you can definitely trigger chef w/ it =_+
[2012-02-17 09:02:00 -0500] royh: okies
[2012-02-17 09:02:00 -0500] royh: thanks guys! :)
[2012-02-17 09:20:00 -0500] tolland: hi is there is a quick way to get the webui onto some other webroot path like :4040/webui ?
[2012-02-17 09:45:00 -0500] lflux: I proxy mine behind nginx
[2012-02-17 09:52:00 -0500] eamelink: I have a question about the deploy resource with git, where I want to use a deployment key. I've added it to a databag as per the instructions on the deploy resource wiki page, but it looks like the key is not used.
[2012-02-17 09:53:00 -0500] eamelink: I guess I have to reference it somehow from the recipe, but it's not documented it seems.
[2012-02-17 09:53:00 -0500] eamelink: Any advice?
[2012-02-17 09:59:00 -0500] eamelink: I guess I'll have to use ssh_wrapper?
[2012-02-17 10:00:00 -0500] tolland: lflux: yeah im trying to proxy it at the moment, but its sharing an external URL so id like to put it on /chef so i can protect it with a httpd Location directive
[2012-02-17 10:33:00 -0500] auduny: Do people here also have their code within the chef-repository? or do you keep it seperate?
[2012-02-17 10:33:00 -0500] auduny: code as in web code..
[2012-02-17 10:35:00 -0500] zefer: auduny: definitely separate
[2012-02-17 10:36:00 -0500] auduny: So you don't deploy code with chef at all. Or do you use chef to get it from another repository etc..?
[2012-02-17 10:41:00 -0500] linuxboy: I've got an attribute which is a list "normal[:deploy]['available_applications'] = ['thing', 'blah']"
[2012-02-17 10:41:00 -0500] linuxboy: I've got this in a few cookbooks
[2012-02-17 10:41:00 -0500] linuxboy: when I include 2 cookbooks with this attribute, then it doesn't combine them
[2012-02-17 10:41:00 -0500] linuxboy: how do I do that?
[2012-02-17 11:19:00 -0500] BryanWB: linuxboy: maybe use  normal[:deploy]['available_applications'] << ['thisapp'']  in the attributes file
[2012-02-17 11:32:00 -0500] linuxboy: BryanWB: what does that do?
[2012-02-17 11:37:00 -0500] linuxboy: BryanWB: I get this in my node config now: "available_applications": { "<<": [ "deploy", "blog" ] } },
[2012-02-17 11:37:00 -0500] linuxboy: BryanWB: which doesn't include the other list that I want added
[2012-02-17 11:43:00 -0500] mlei: linuxboy: you probably need to use two attributes and then combine the lists in the cookbook when you need it
[2012-02-17 11:43:00 -0500] linuxboy: mlei: I have multiple attributes
[2012-02-17 11:43:00 -0500] mlei: what i mean is, you most likely need two differently named ones
[2012-02-17 11:43:00 -0500] linuxboy: yeah
[2012-02-17 11:44:00 -0500] linuxboy: I can't have a unique name for each one
[2012-02-17 11:44:00 -0500] mlei: what about normal[:deploy]['available_applications'][cookbookname]
[2012-02-17 11:45:00 -0500] mlei: then do some logic to merge the lists when you need to use it
[2012-02-17 11:45:00 -0500] linuxboy: let me explain a little more
[2012-02-17 11:45:00 -0500] linuxboy: we have a bunch of roles
[2012-02-17 11:45:00 -0500] linuxboy: all teh role does is include a cookbook of the same name
[2012-02-17 11:45:00 -0500] linuxboy: each cookbook adds an available_applications entry depending on the role
[2012-02-17 11:45:00 -0500] linuxboy: (web adds our web services, etc)
[2012-02-17 11:45:00 -0500] linuxboy: I'm looking at combining some boxes
[2012-02-17 11:46:00 -0500] linuxboy: so I'll have web + services for example
[2012-02-17 11:47:00 -0500] mlei: right. unfortunately if you set the same attribute twice it'll always end up the second one
[2012-02-17 11:47:00 -0500] linuxboy: yeah
[2012-02-17 11:47:00 -0500] linuxboy: is there a way I can make the attribute a list
[2012-02-17 11:47:00 -0500] linuxboy: and add to that list each time?
[2012-02-17 11:48:00 -0500] mlei: there's really no "adding" in setting attributes
[2012-02-17 11:48:00 -0500] mlei: you could accomplish something similar
[2012-02-17 11:49:00 -0500] mlei: by instead of setting the actual list, set the key for each service to some value, i.e. set normal[:deploy]['available_applications']['servicename'] for each service
[2012-02-17 11:50:00 -0500] mlei: then you end up with a hash with the keys being the service names
[2012-02-17 11:50:00 -0500] linuxboy: Oh, I see what you're getting at
[2012-02-17 11:50:00 -0500] linuxboy: how can I call a list later on in a template?
[2012-02-17 11:51:00 -0500] mlei: afraid i have to head out, best of luck linuxboy
[2012-02-17 12:02:00 -0500] BryanWB: linuxboy: there should be some way to merge the lists, i have heard of people doing it
[2012-02-17 12:02:00 -0500] linuxboy: BryanWB: yeah, thats what I'm looking for
[2012-02-17 12:25:00 -0500] tolland: is it reasonable to have multiple customers on the same chef server, with different environements, or is that fighting against the current in terms of keeping them isolated?
[2012-02-17 13:02:00 -0500] `brendan: morning
[2012-02-17 13:05:00 -0500] leifmadsen: ohai
[2012-02-17 14:25:00 -0500] Andorbal: Does anyone know of any examples of using the Powershell provider (or any script script resource, I guess) from another provider?
[2012-02-17 14:26:00 -0500] Andorbal: I'm looking to modify the IIS resource to use Powershell instead of 'appcmd' because 'appcmd' cannot set up ssl bindings with a specified certificate
[2012-02-17 14:41:00 -0500] quazimodo: so
[2012-02-17 14:41:00 -0500] quazimodo: i am seeing a lot of chef commands that are being executed by ssh'ing into a node
[2012-02-17 14:41:00 -0500] quazimodo: what if i want to spin up say 600 new ec2 instances
[2012-02-17 14:42:00 -0500] quazimodo: whats the typical way to deal with that
[2012-02-17 14:42:00 -0500] quazimodo: create an image for the instances that already has a chef daemonL
[2012-02-17 14:42:00 -0500] quazimodo: ?
[2012-02-17 14:43:00 -0500] Andorbal: can't you bootstrap an amazon instance where chef will install the client on a bare instance?
[2012-02-17 14:44:00 -0500] quazimodo: i dno?
[2012-02-17 14:44:00 -0500] quazimodo: im learning
[2012-02-17 14:45:00 -0500] Andorbal: Unfortunately, so am I ;)
[2012-02-17 14:46:00 -0500] Andorbal: But what I did is create an AMI that has the absolute minimum on it to allow Chef to bootstrap it.  I'm using Windows, so this involves setting up WinRM and an SSL certificate
[2012-02-17 14:46:00 -0500] quazimodo: im still not sure what the workflow is from "i want to make x instances and configure them to do bla" to "wow i now hav x instance, all of them are reporting that they are doing well and if any die or i need to add more it happens automatically"
[2012-02-17 14:46:00 -0500] yatesy: quazimodo: I suggest having a look at the ec2 knife plugin, it integrates the creation of an instance and bootstrapping
[2012-02-17 14:47:00 -0500] quazimodo: incidentally, when you do spin up say several hundred or thousand instances, and they all need to fetch some files, that could be hundreds of gigs of transfer right there :/
[2012-02-17 14:47:00 -0500] quazimodo: which youd have to pay for
[2012-02-17 14:48:00 -0500] quazimodo: i guess store the data in buckets at the same data centres as hwere the instances are
[2012-02-17 14:48:00 -0500] yatesy: indeed
[2012-02-17 14:48:00 -0500] quazimodo: yatesy: i learn well, but this is a procedure that i know little about :P
[2012-02-17 14:49:00 -0500] quazimodo: this morning i didnt know puppet and chef exist
[2012-02-17 14:49:00 -0500] quazimodo: i was going to bash script and run monit
[2012-02-17 14:49:00 -0500] yatesy: wow that's early! welcome :) I'm in the early stages of learning myself
[2012-02-17 14:50:00 -0500] quazimodo: here I am making machines play nice :/
[2012-02-17 14:50:00 -0500] quazimodo: its funny
[2012-02-17 14:50:00 -0500] quazimodo: my education is in biomedical engineering
[2012-02-17 14:51:00 -0500] quazimodo: i really wish i had the opportunity to chat with someone who is experienced at having a customer ask for x instances (with scaling as necessary), and implementing the ~things~ needed to make it happen automatically without wasted resources and costs
[2012-02-17 14:52:00 -0500] quazimodo: cos atm im thinking, AMI with chef precofigured to run, some bash scripts to hook into the aws api's to spin up servers, db's etc, and then to call the chef configs
[2012-02-17 14:54:00 -0500] jtimberman: quazimodo: yeah, so, you can totally bake an AMI with chef already installed on it
[2012-02-17 14:54:00 -0500] jtimberman: quazimodo: and give it instance metadata that tells it what to be
[2012-02-17 14:54:00 -0500] jtimberman: quazimodo: in the pre built AMI you have your base OS that you'd normally use
[2012-02-17 14:55:00 -0500] jtimberman: quazimodo: and then chef installed and ready to start on boot, and a client.rb that reads the instance data.
[2012-02-17 14:55:00 -0500] quazimodo: lol bake
[2012-02-17 14:56:00 -0500] jtimberman: apparently we don't have the page w/ the config file
[2012-02-17 14:56:00 -0500] jtimberman: one moment i'll get one
[2012-02-17 14:57:00 -0500] quazimodo: jtimberman: is it reasonable to have an instance that is generic, with chef preconfigured to be running, then as we spin these up we message them to grab config file abcd.whatever from a server to then configure them exactly as we need them?
[2012-02-17 14:57:00 -0500] jtimberman: here's a gist: https://gist.github.com/319106
[2012-02-17 14:57:00 -0500] jtimberman: the documentation on the wiki is from when we used to publish an AMI for folks, but we stopped doing that because it was Yet Another Thing to update for new releses
[2012-02-17 14:57:00 -0500] willejs: Hi, is there a way to trigger the chef-client to run on a node from the server?
[2012-02-17 14:57:00 -0500] jtimberman: willejs: no
[2012-02-17 14:57:00 -0500] jtimberman: willejs: the server is a file server and API service
[2012-02-17 14:58:00 -0500] yatesy: & a search engine :)
[2012-02-17 14:58:00 -0500] willejs: msgpack to the rescue.
[2012-02-17 14:58:00 -0500] jtimberman: willejs: trigger chef-client via knife ssh, or rig up another system such as rundeck or similar.
[2012-02-17 14:58:00 -0500] quazimodo: jtimberman: chef runs as a daemon and keeps up to date with the server right?
[2012-02-17 14:59:00 -0500] yatesy: quazimodo: chef can run in a server mode whereby each instance periodically contacts a central server to ask for it's configuration, so it's centralised rather than per-instance and therefore easier to maintain when you scale
[2012-02-17 14:59:00 -0500] jtimberman: quazimodo: yes, it can be configured to do so
[2012-02-17 14:59:00 -0500] quazimodo: that makes more sense to me
[2012-02-17 14:59:00 -0500] jtimberman: quazimodo: the 'chef-client' cookbook sets up the service with a variety of options.
[2012-02-17 14:59:00 -0500] quazimodo: hrm i see
[2012-02-17 15:00:00 -0500] quazimodo: so upon the 1st call it then configures itself too
[2012-02-17 15:00:00 -0500] quazimodo: thats neat
[2012-02-17 15:00:00 -0500] willejs: cheers for the help. Rundeck looks interesting!
[2012-02-17 15:00:00 -0500] jtimberman: quazimodo: you can use init scripts, runit, daemontools, bluepill or cron
[2012-02-17 15:00:00 -0500] quazimodo: that means all i need is an up to date ami with only chef installed, and a decent file cache for when the instances mass download stuff with apt or whatever
[2012-02-17 15:01:00 -0500] jtimberman: :)
[2012-02-17 15:01:00 -0500] yatesy: it's worth noting that you don't *need* to bake an AMI with chef pre-installed, but that's a perfectly valid option
[2012-02-17 15:01:00 -0500] jtimberman: its needed if you want to do autoscaling on ec2
[2012-02-17 15:01:00 -0500] jtimberman: or use cloudformation
[2012-02-17 15:02:00 -0500] quazimodo: thats another thing
[2012-02-17 15:02:00 -0500] jtimberman: the advantage of those is you can use the instance user data option
[2012-02-17 15:02:00 -0500] quazimodo: i am now getting the feeling that chef is for configuration on a per machine basis
[2012-02-17 15:02:00 -0500] quazimodo: its not about monitoring or controlling a cluster
[2012-02-17 15:02:00 -0500] jtimberman: but you'll need a way for chef to retrieve that information at launch
[2012-02-17 15:02:00 -0500] jtimberman: quazimodo: that is primarily correct.
[2012-02-17 15:03:00 -0500] jtimberman: chef gives you a framework that you can use to power those things
[2012-02-17 15:03:00 -0500] jtimberman: but the job of "chef-client" is to converge the node to be in the desired state.
[2012-02-17 15:03:00 -0500] quazimodo: an alternative to chef being having lots of amis each built for their purpose (a silly method but true?)
[2012-02-17 15:03:00 -0500] jtimberman: ugh
[2012-02-17 15:03:00 -0500] jtimberman: golden images
[2012-02-17 15:03:00 -0500] jtimberman: image sprawl
[2012-02-17 15:03:00 -0500] yatesy: you'll quickly find that isn't scalable :)
[2012-02-17 15:03:00 -0500] jtimberman: or maintainable.
[2012-02-17 15:03:00 -0500] yatesy: and the management overhead will be huge
[2012-02-17 15:03:00 -0500] quazimodo: yeah my engineering brain knows that
[2012-02-17 15:03:00 -0500] jtimberman: :D
[2012-02-17 15:03:00 -0500] quazimodo: i just want to make sure my mental model of whats going on is true
[2012-02-17 15:04:00 -0500] jtimberman: sure
[2012-02-17 15:04:00 -0500] itwasntandy: I agree... however netflix argue that it is - as they use jenkins/hudson to bake up their AMIs
[2012-02-17 15:04:00 -0500] quazimodo: yeah i have yet to explore what that does
[2012-02-17 15:04:00 -0500] BryanWB: jonath0n Timberlake, should I implement my 'ark' resource in core chef or just do it as a lwrp?
[2012-02-17 15:04:00 -0500] jtimberman: ew
[2012-02-17 15:05:00 -0500] yatesy: rofl
[2012-02-17 15:05:00 -0500] jtimberman: itwasntandy: they also argue that they don't need an operations team, yet they're hiring for "Site Reliability Engineers"
[2012-02-17 15:05:00 -0500] quazimodo: all the explanations for these services/programs are too complicated and abstract
[2012-02-17 15:05:00 -0500] itwasntandy: jtimberman: yep, I know
[2012-02-17 15:05:00 -0500] itwasntandy: we have an ops team.
[2012-02-17 15:05:00 -0500] jtimberman: So I would take their advice on how to run a complex infrastructure with a grain of salt :)
[2012-02-17 15:05:00 -0500] itwasntandy: its kinda useful
[2012-02-17 15:05:00 -0500] itwasntandy: also keeps me employed
[2012-02-17 15:05:00 -0500] quazimodo: how hard is it to write "chef primarily automatically updates all the stuff in an instance via chef config files stored on a central server"
[2012-02-17 15:06:00 -0500] jtimberman: quazimodo: easy
[2012-02-17 15:06:00 -0500] quazimodo: i havent found that anywhere
[2012-02-17 15:06:00 -0500] jtimberman: quazimodo: if your OS has a package manager that can update packages like yum or apt
[2012-02-17 15:06:00 -0500] jtimberman: you put "action :upgrade" on the package resources.
[2012-02-17 15:06:00 -0500] jtimberman: instead of :install
[2012-02-17 15:07:00 -0500] jtimberman: *I* don't do "apt-get upgrade" or the like in a recipe though
[2012-02-17 15:07:00 -0500] quazimodo: ok replace update with "installs, updgrades or updates"
[2012-02-17 15:07:00 -0500] jtimberman: sure
[2012-02-17 15:07:00 -0500] quazimodo: so
[2012-02-17 15:07:00 -0500] quazimodo: in similar terminology
[2012-02-17 15:07:00 -0500] quazimodo: what does jenkins/hudson do?
[2012-02-17 15:07:00 -0500] jtimberman: with the upgrade action, chef will have the provider install the latest version of the package if a new one is available
[2012-02-17 15:08:00 -0500] quazimodo: its funny to me, its like when I speak to marketing or law students, etc, they over complicate stuff for the sake of complicating it
[2012-02-17 15:08:00 -0500] quazimodo: haha
[2012-02-17 15:09:00 -0500] quazimodo: explain it with the least abstract language so you communicate easily and clearly
[2012-02-17 15:09:00 -0500] quazimodo: jtimberman: you are very helpful, thank you :D
[2012-02-17 15:10:00 -0500] Andorbal: Does anyone know of any examples of using the Powershell provider (or any script script resource, I guess) from another provider?
[2012-02-17 15:11:00 -0500] Andorbal: I'm looking to modify the IIS resource to use Powershell instead of 'appcmd' because 'appcmd' cannot set up ssl bindings with a specified certificate
[2012-02-17 15:13:00 -0500] jtimberman: quazimodo: its my job :)
[2012-02-17 15:13:00 -0500] jtimberman: jtimberman?
[2012-02-17 15:13:00 -0500] bawt: jtimberman is an Opscode employee, likes cookbooks and Chef training, and long walks on the beach.
[2012-02-17 15:15:00 -0500] royh: can i set a variable based on a host?
[2012-02-17 15:15:00 -0500] quazimodo: so, you *have* to listen to me and all my problems then
[2012-02-17 15:15:00 -0500] quazimodo: it all started when i was six
[2012-02-17 15:15:00 -0500] quazimodo: i remember when my mother and I used to go to the lake
[2012-02-17 15:16:00 -0500] quazimodo: i so adored the lake, and mamaa (as i so affectionately referred to her)
[2012-02-17 15:18:00 -0500] gondoi: jtimberman: hey, looking at your article on encrypted data bags.. in the article it shows 2 ways to access the bag... is one preffered and do both work?
[2012-02-17 15:18:00 -0500] gondoi: https://jtimberman.posterous.com/64227128
[2012-02-17 15:20:00 -0500] atomic-penguin: gondoi, the file method is probably preferred by most people
[2012-02-17 15:20:00 -0500] atomic-penguin: gondoi, because using a shared secret, you still have to get the secret into recipe code
[2012-02-17 15:20:00 -0500] gondoi: so use Chef::EncryptedDataBagItem.load?
[2012-02-17 15:21:00 -0500] gondoi: i plan to use a secret in file, but i'm curious about the call to load the bag
[2012-02-17 15:21:00 -0500] gondoi: there is that one ^ and then encrypted_data_bag_item(
[2012-02-17 15:21:00 -0500] gondoi: both the same?
[2012-02-17 15:22:00 -0500] atomic-penguin: postfix_creds = Chef::EncryptedDataBagItem.load("secrets","postfix")
[2012-02-17 15:22:00 -0500] jtimberman: gondoi: that encrypted_data_bag_item() method is one I created in a cookbook library
[2012-02-17 15:22:00 -0500] atomic-penguin: postfix_creds["user"]
[2012-02-17 15:22:00 -0500] gondoi: ahh
[2012-02-17 15:22:00 -0500] gondoi: okay
[2012-02-17 15:22:00 -0500] gondoi: thanks jtimberman that's what I needed to know :D
[2012-02-17 15:27:00 -0500] BryanWB: anybody written a maven lwrp yet?
[2012-02-17 15:27:00 -0500] geekbri: If you specify a secret_file in your knife.rb will it automatically encrypt all data bags?
[2012-02-17 15:28:00 -0500] BryanWB: geekbri: no
[2012-02-17 15:29:00 -0500] geekbri: BryanWB: So then you just tack on --secret at the end of knife data bag from file <bag> <file_name> --secret ?
[2012-02-17 15:29:00 -0500] BryanWB: geekbri: can't remember exactly, but u have to use and additional switch
[2012-02-17 15:31:00 -0500] jtimberman: BryanWB: no one wants a maven lwrp.
[2012-02-17 15:31:00 -0500] jtimberman: BryanWB: :)
[2012-02-17 15:31:00 -0500] BryanWB: jtimberman: hahah Timberlake
[2012-02-17 15:33:00 -0500] BryanWB: if i understand correctly, i could use maven to grab an arbitrary jar from repo1.maven.org, but have to figure it out if i can put it where tomcat, jboss can see it, and not deep in maven's guts
[2012-02-17 15:33:00 -0500] erikh: anyone playing with precise yet?
[2012-02-17 15:33:00 -0500] erikh: just wondering what I'm in for here
[2012-02-17 15:34:00 -0500] jtimberman: O.o
[2012-02-17 15:34:00 -0500] jtimberman: erikh: i learned from the past about using alpha ubuntu releases :)
[2012-02-17 15:34:00 -0500] geekbri: Is there an easy way to find out which of your databags are encrypted and which arent ?
[2012-02-17 15:35:00 -0500] BryanWB: geekbri: u could use another data_bag to track them ;)
[2012-02-17 15:36:00 -0500] bobw: erikh: dock things in windowmaaker started bouncing
[2012-02-17 15:36:00 -0500] geekbri: BryanWB: How meta of you
[2012-02-17 15:37:00 -0500] BryanWB: geekbri: though honestly, that's the easiest thing i can thing of
[2012-02-17 15:37:00 -0500] geekbri: BryanWB: sounds reasonable to me.
[2012-02-17 15:38:00 -0500] bobw: erikh: unity was still hateful. i was seeing graphics problems with gdm
[2012-02-17 15:40:00 -0500] erikh: oh I'm not talking about the desktop
[2012-02-17 15:41:00 -0500] erikh: jtimberman: yeah, I'm not using it anywhere where it counts -- just checking out the changes more or less
[2012-02-17 15:41:00 -0500] matti: bobw: :)
[2012-02-17 15:41:00 -0500] matti: jtimberman: :)
[2012-02-17 15:42:00 -0500] BryanWB: if I define additional resources w/in a lwrp, how can recipe using that lwrp notify those resources? i keep getting ResourceNotFound error
[2012-02-17 15:43:00 -0500] BryanWB: i am referring to resources like template, service
[2012-02-17 15:44:00 -0500] erikh: you're having trouble in a lwrp? can you paste the code?
[2012-02-17 15:44:00 -0500] erikh: never seen that before.
[2012-02-17 15:44:00 -0500] geekbri: Is there a search() available for encrypted data bags?
[2012-02-17 15:46:00 -0500] jtimberman: BryanWB: i don't think you can notify those resources, but instead notify the resource that is the lwrp
[2012-02-17 15:47:00 -0500] BryanWB: erikh: https://github.com/bryanwb/cookbooks/blob/master/tomcat/providers/default.rb#L120
[2012-02-17 15:47:00 -0500] BryanWB: jtimberman: then i have to define an additional action for it?
[2012-02-17 15:48:00 -0500] erikh: maybe just defining a ruby block that operates over a closure would work
[2012-02-17 15:48:00 -0500] jtimberman: maybe?
[2012-02-17 15:48:00 -0500] erikh: then notifying that -- it should do nothing by default
[2012-02-17 15:48:00 -0500] erikh: dunno.
[2012-02-17 15:50:00 -0500] quazimodo: chef sets up windows machines too riht
[2012-02-17 15:50:00 -0500] BryanWB: erikh: here is the recipe where it fails https://github.com/bryanwb/cookbooks/blob/master/liferay/recipes/default.rb#L114
[2012-02-17 15:50:00 -0500] Andorbal: Yup
[2012-02-17 15:50:00 -0500] Andorbal: My infrastructure is all Windows and so far it seems to work ok
[2012-02-17 15:51:00 -0500] quazimodo: Andorbal: how do you control windows without a monitor
[2012-02-17 15:51:00 -0500] erikh: https://gist.github.com/c7a0b1daf8a4543e6ffd
[2012-02-17 15:51:00 -0500] kbader: quazimodo: powershell is one way
[2012-02-17 15:51:00 -0500] erikh: something like that
[2012-02-17 15:51:00 -0500] quazimodo: you don't have to use batch files do you?
[2012-02-17 15:51:00 -0500] erikh: a little convoluted but may work
[2012-02-17 15:51:00 -0500] Andorbal: Chef takes care of managing the configuration
[2012-02-17 15:52:00 -0500] Andorbal: Unfortunately, I'm running into problems configuring IIS with an SSL binding
[2012-02-17 15:52:00 -0500] quazimodo: ahh IIS, my old nemesis
[2012-02-17 15:52:00 -0500] quazimodo: back when i tried to run an asp site off my pc IIS was a wanker
[2012-02-17 15:52:00 -0500] BryanWB: erikh: i think that is for a different problem, i have a scope issue i believe
[2012-02-17 15:53:00 -0500] Andorbal: Well, in this case, the IIS provider is using 'appcmd' to configure IIS, but this tool doesn't support SSL bindings
[2012-02-17 15:53:00 -0500] erikh: also I don't think you want to use new_resource all the time?
[2012-02-17 15:53:00 -0500] jtimberman: quazimodo: http://www.google.com/url?sa=t&rct=j&q=&esrc=s&source=web&cd=3&ved=0CDAQFjAC&url=http%3A%2F%2Fwww.opscode.com%2Fpress-releases%2Fopscode-delivers-cloud-infrastructure-automation-to-windows-environments%2F&ei=Ang-T6HDLoX6tgeqyIixCg&usg=AFQjCNFfoyrTB65YZJDWiO4iP2_TpHhIZw
[2012-02-17 15:53:00 -0500] jtimberman: wow
[2012-02-17 15:53:00 -0500] jtimberman: stupid google
[2012-02-17 15:53:00 -0500] erikh: could be wrong there -- but I think you want to store it and work with it as a variable
[2012-02-17 15:54:00 -0500] jtimberman: try
[2012-02-17 15:54:00 -0500] jtimberman: http://www.opscode.com/press-releases/opscode-delivers-cloud-infrastructure-automation-to-windows-environments/
[2012-02-17 15:54:00 -0500] jtimberman: lots of links and info here: http://www.opscode.com/blog/2011/12/15/chef-client-installer-for-windows/
[2012-02-17 15:55:00 -0500] quazimodo: oh man if I can have this stuff together and up by end of next week we can finally start pushing clients into the pipeline
[2012-02-17 15:55:00 -0500] BryanWB: erikh: had trouble turning new_resource into a regular hash
[2012-02-17 15:56:00 -0500] BryanWB: to use in the template for server.xml
[2012-02-17 15:56:00 -0500] erikh: use it like an object
[2012-02-17 15:56:00 -0500] erikh: @res = new_resource; @res.my_attribute()
[2012-02-17 15:56:00 -0500] erikh: anyhow I gtg -- best of luck
[2012-02-17 15:56:00 -0500] BryanWB: erikh: tks
[2012-02-17 16:05:00 -0500] quazimodo: hrm
[2012-02-17 16:06:00 -0500] quazimodo: how does chef configure things like exchange server
[2012-02-17 16:06:00 -0500] quazimodo: what if you want a cluster of them
[2012-02-17 16:06:00 -0500] quazimodo: does it talk directly to exchange or does it copy premade config files or?
[2012-02-17 16:06:00 -0500] quazimodo: because everything in unix is pretty much just config files
[2012-02-17 16:07:00 -0500] Andorbal: If something *needs* clicks to configure, then I'm guessing Chef can't manage it.
[2012-02-17 16:07:00 -0500] jtimberman: quazimodo: for chef, code needs to be written to talk to the windows API to manage the underlying OS objects, registry, group policy objects and such
[2012-02-17 16:07:00 -0500] Andorbal: But you can do a lot with Powershell and other tools
[2012-02-17 16:07:00 -0500] BryanWB: Andorbal: i am sure there is registry setting somewhere that accomplish the needed ;)
[2012-02-17 16:08:00 -0500] jtimberman: the 'windows' cookbook has some lightweight resources/providers for interacting with Windows parts and bits.
[2012-02-17 16:08:00 -0500] Andorbal: BryanWB: :eek:  LOL
[2012-02-17 16:08:00 -0500] BryanWB: Andorbal: i know, terrifying
[2012-02-17 16:08:00 -0500] quazimodo: bleh what a pain in the ass
[2012-02-17 16:08:00 -0500] quazimodo: ok guys i think im gonna head off to sleep
[2012-02-17 16:08:00 -0500] quazimodo: it was wonderful to talk to you all
[2012-02-17 16:09:00 -0500] quazimodo: good night :D
[2012-02-17 16:09:00 -0500] Andorbal: I know, the more I try to automate in Windows, the more I wish I were using LInux
[2012-02-17 16:09:00 -0500] jtimberman: we have customers/users that are managing complex sql server installations with Chef :)
[2012-02-17 16:09:00 -0500] jtimberman: I don't know about Exchange specifically.
[2012-02-17 16:09:00 -0500] jtimberman: but they may be out there.
[2012-02-17 16:09:00 -0500] quazimodo: jtimberman: please send them my condolences
[2012-02-17 16:10:00 -0500] quazimodo: bye
[2012-02-17 16:10:00 -0500] jtimberman: hah
[2012-02-17 16:10:00 -0500] jtimberman: to the cloud!
[2012-02-17 16:10:00 -0500] jtimberman: http://www.microsoft.com/exchange/en-us/exchange-online-hosted-email.aspx
[2012-02-17 16:10:00 -0500] jtimberman: :)
[2012-02-17 16:11:00 -0500] quazimodo: ps id rofl if i saw http://www.microsoft.com/foo/bar/*.php
[2012-02-17 16:12:00 -0500] lflux: I go to great pains to not make it obvious that we use php at work
[2012-02-17 16:12:00 -0500] lflux: to the users that is
[2012-02-17 16:14:00 -0500] jtimberman: facebook, etsy, and flickr all use php.
[2012-02-17 16:14:00 -0500] jtimberman: as far as i am aware anyway.
[2012-02-17 16:14:00 -0500] lflux: wordpress, mediawiki
[2012-02-17 16:15:00 -0500] lflux: facebook outgrew PHP and then built a goddamned PHP to C++ compiler
[2012-02-17 16:15:00 -0500] lflux: that's a warning sign right there
[2012-02-17 16:18:00 -0500] erikh: yahoo used to do something similar to facebook with php as well
[2012-02-17 16:23:00 -0500] lflux: we moved to building own template language that compiles to C instead of trying to build C++ of PHP
[2012-02-17 16:55:00 -0500] sivy: hello chefs
[2012-02-17 17:07:00 -0500] AntonZ: Hello, does anyone have a link handy for "user node" parameters, such as uid, guid, password, etc ?
[2012-02-17 17:11:00 -0500] AntonZ: an example : user node[:john][:user] do
[2012-02-17 17:11:00 -0500] AntonZ:   shell "/bin/bash"
[2012-02-17 17:11:00 -0500] AntonZ:   home "/home/john"
[2012-02-17 17:11:00 -0500] AntonZ:   uid "501"
[2012-02-17 17:11:00 -0500] AntonZ:   gid "501"
[2012-02-17 17:11:00 -0500] AntonZ: end
[2012-02-17 17:11:00 -0500] AntonZ: i need to pre-define the password
[2012-02-17 17:14:00 -0500] cwj: AntonZ: provide a password parameter for the user resource with a hashed password as the value
[2012-02-17 17:14:00 -0500] AntonZ: yes, but whats the command :) ?
[2012-02-17 17:14:00 -0500] cwj: what do you mean?
[2012-02-17 17:14:00 -0500] AntonZ: is it something like - password bla$%$%$ or somthing else ?
[2012-02-17 17:14:00 -0500] cwj: are you asking how to generate the password hash?
[2012-02-17 17:14:00 -0500] AntonZ: no, what do i put in the recipe
[2012-02-17 17:15:00 -0500] AntonZ: i specify my UID "501" then gid "501" and then do i type password "hashed password" ?
[2012-02-17 17:15:00 -0500] cwj: yes
[2012-02-17 17:16:00 -0500] AntonZ: got it, so it as simple as typing -  password "hashed password" - thank you :)
[2012-02-17 17:21:00 -0500] jtimberman: resources?
[2012-02-17 17:21:00 -0500] bawt: resources is http://wiki.opscode.com/display/chef/Resources
[2012-02-17 17:21:00 -0500] jtimberman: user resource documentation is there.
[2012-02-17 17:21:00 -0500] jtimberman: you need shadow password support in your ruby to set passwords with user resources.
[2012-02-17 17:23:00 -0500] AntonZ: ah interesting
[2012-02-17 17:23:00 -0500] AntonZ: what if i specify password in an explicit form ?
[2012-02-17 17:28:00 -0500] nacer: hey hey
[2012-02-17 17:28:00 -0500] jbz: Cheers.
[2012-02-17 17:32:00 -0500] dwhsix: there's no resource to unpack a tar?
[2012-02-17 17:36:00 -0500] miah: there is a install_from cookbook, as well as the execute resource =)
[2012-02-17 17:43:00 -0500] sascha_d: can anyone speak to when 10.10 might be available?  is there a way to bootstrap a windows server with that specific version?
[2012-02-17 17:46:00 -0500] AntonZ: guys, it says in order for me to use password paramter, i have to install  the debian package "libshadow-ruby1.8", what if i work in CEntOS ?
[2012-02-17 17:46:00 -0500] BryanWB: AntonZ: i think it is "ruby-shadow" on centos
[2012-02-17 17:47:00 -0500] AntonZ: let me check
[2012-02-17 17:47:00 -0500] BryanWB: yup ruby-shadow, may be in the epel repo
[2012-02-17 17:47:00 -0500] jbz: It's def. ruby-shadow on fedora, dunno about CentOS
[2012-02-17 17:48:00 -0500] AntonZ: yes, just yum listed and it's ruby shadow.. now i need to figure out how to stick that ruby shadow install in my recipe :), im not a develper :(
[2012-02-17 17:48:00 -0500] BryanWB: package "ruby-shadow"
[2012-02-17 17:48:00 -0500] AntonZ: that one command will install that package ?
[2012-02-17 17:49:00 -0500] jbz: AntonZ:  that's what chef is *for*.
[2012-02-17 17:49:00 -0500] AntonZ: i love chef :)
[2012-02-17 18:01:00 -0500] BryanWB: good night chefs!
[2012-02-17 18:11:00 -0500] AntonZ: what does this code do: directory "/home/john" do
[2012-02-17 18:11:00 -0500] AntonZ:   recursive true
[2012-02-17 18:11:00 -0500] AntonZ:   owner node[:john][:user]
[2012-02-17 18:11:00 -0500] AntonZ:   mode 0700
[2012-02-17 18:11:00 -0500] AntonZ: end
[2012-02-17 18:12:00 -0500] AntonZ: i know its random
[2012-02-17 18:12:00 -0500] jbz: sets the dir owner to whatever is in node[:john][:user]
[2012-02-17 18:12:00 -0500] jbz: and sets the mode to 0700.
[2012-02-17 18:12:00 -0500] jbz: Uh
[2012-02-17 18:12:00 -0500] jbz: That creates the directory /home/john, and if necessary creates /home
[2012-02-17 18:13:00 -0500] AntonZ: thats what i thought, thank you Sir
[2012-02-17 18:13:00 -0500] jbz: np
[2012-02-17 18:41:00 -0500] gondoi: is it possible to search on a nested attribute? for example search(:node, 'cookbook:attribute:lowerattribute')
[2012-02-17 18:42:00 -0500] gondoi: basically i want to set an attribute on a node as the "primary" or "active" node
[2012-02-17 18:43:00 -0500] ssd7: gondoi: nested attributes can be searched by seperating keys with _
[2012-02-17 18:43:00 -0500] gondoi: ah
[2012-02-17 18:43:00 -0500] gondoi: cool
[2012-02-17 18:43:00 -0500] gondoi: i'll give that a shot
[2012-02-17 18:44:00 -0500] gondoi: so like this? search(:node, 'cookbook:attribute_lowerattribute')?
[2012-02-17 18:45:00 -0500] ssd7: Hmm.  So, say I had an attribute node['mpi']['role'], I would search search(:node, 'mpi_role:master')
[2012-02-17 18:45:00 -0500] gondoi: ahhhh
[2012-02-17 18:45:00 -0500] gondoi: cool
[2012-02-17 18:54:00 -0500] pauldale: Hey guys,
[2012-02-17 18:55:00 -0500] pauldale: We've been having a bunch of weird issues with ec2 + chef the last couple days. Is anyone seeing anything strange?
[2012-02-17 18:55:00 -0500] cwj: no, but maybe it would be helpful if you could be more specific
[2012-02-17 18:55:00 -0500] pauldale: Example:   knife ec2 server create -r "role[]" -I ami-c15994a8 -f m1.small -S elemica2 -i ~/.ssh/elemica2.pem -x ubuntu  -G "group"
[2012-02-17 18:56:00 -0500] pauldale: then ssh authentication fails ( ubuntu user is not created with ssh authentication, as it always was )
[2012-02-17 18:56:00 -0500] pauldale: then press return, and it installs the base chef-client
[2012-02-17 18:56:00 -0500] pauldale: but then chef-client fails to find cookbooks which are definitely installed on the hosted chef instance
[2012-02-17 18:57:00 -0500] cwj: hm no such problems here
[2012-02-17 18:57:00 -0500] pauldale: also: having many more cases of knife ec2 commands not completing
[2012-02-17 18:58:00 -0500] pauldale: What would you do to debug something like this popping up suddenly? :ec2-50-17-77-18.compute-1.amazonaws.com [Fri, 17 Feb 2012 18:52:28 +0000] FATAL: Chef::Exceptions::CookbookNotFound: Cookbook apt not found. If you're loading apt from another cookbook, make sure you configure the dependency in your metadata
[2012-02-17 18:58:00 -0500] pauldale: we didn't change recipes, and apt is definitely in our hosted chef account
[2012-02-17 18:58:00 -0500] pauldale: but now chef-client isn't finding it
[2012-02-17 18:59:00 -0500] cwj: well that sounds like some recipe is trying to "include_recipe 'apt'" without listing apt in its dependency metadata
[2012-02-17 19:00:00 -0500] cwj: running chef-client with '-l debug' should help you determine where that is coming from
[2012-02-17 19:03:00 -0500] pauldale: thanks
[2012-02-17 19:04:00 -0500] AntonZ: folks, i have a challenge, i have to modify sshd_config file during instance bootup, how should i approach such task ?
[2012-02-17 19:06:00 -0500] mlei: AntonZ: are you strictly set on "modify" or is "replace" okay?
[2012-02-17 19:06:00 -0500] arthur_kalm: Hi everyone, I'm trying to install the git cookbook but I'm getting the following: https://gist.github.com/1854933
[2012-02-17 19:07:00 -0500] arthur_kalm: Has anyone seen that before?
[2012-02-17 19:08:00 -0500] AntonZ: mlei, replace is okay
[2012-02-17 19:09:00 -0500] AntonZ: i'll just replace the existing config with my own
[2012-02-17 19:09:00 -0500] Brad_K: AntonZ: that's what i do.
[2012-02-17 19:09:00 -0500] mlei: use a template resource
[2012-02-17 19:10:00 -0500] AntonZ: hmm okay, where do i find that :) ?
[2012-02-17 19:11:00 -0500] mlei: http://wiki.opscode.com/display/chef/Templates
[2012-02-17 19:11:00 -0500] mlei: there's also an openssh cookbook which you could look at
[2012-02-17 19:12:00 -0500] AntonZ: does openssh cookbook have a portion where it replaces the config file ?
[2012-02-17 19:13:00 -0500] mlei: on a quick read, no
[2012-02-17 19:13:00 -0500] mlei: but you could easily add one
[2012-02-17 19:13:00 -0500] jtimberman: AntonZ: not yet
[2012-02-17 19:13:00 -0500] jtimberman: there's a contribution to do so
[2012-02-17 19:13:00 -0500] jtimberman: but we haven't merged it yet
[2012-02-17 19:13:00 -0500] jtimberman: i don't know the ticket offhand
[2012-02-17 19:14:00 -0500] AntonZ: im asking all these questions as im super green to chef and ruby and all that, so it's hard for me to navigate through all these stuff, but if i'll be pointed to the resouce that can even remotely do what i need i can try and make it work for me ;)
[2012-02-17 19:14:00 -0500] mlei: AntonZ: template would be the way to go
[2012-02-17 19:15:00 -0500] AntonZ: okay, ill start poking around, thank you
[2012-02-17 19:15:00 -0500] mlei: either roll your own cookbook with just the package install and the template
[2012-02-17 19:15:00 -0500] mlei: or modify the openssh cookbook
[2012-02-17 19:16:00 -0500] AntonZ: let me look through them carefully, ill be back with more later :)
[2012-02-17 19:16:00 -0500] arthurkalm: I actually
[2012-02-17 19:17:00 -0500] doki_pen_: does anyone have a good way to add admin users to a django app via chef?
[2012-02-17 19:18:00 -0500] arthurkalm: I actually got that IO error before when I was installing another cookbook. It seems the only way to get it to work is to just site download it.
[2012-02-17 19:19:00 -0500] coderanger: doki_pen_: Heh, can't say I've tried, but it should be easy enough to do with some trickery
[2012-02-17 19:19:00 -0500] mlei: arthurkalm: perhaps knife -V would help? could be permissions issues on trying to unpack the new one?
[2012-02-17 19:19:00 -0500] coderanger: doki_pen_: Does it have to handle passwords?
[2012-02-17 19:19:00 -0500] doki_pen_: coderanger: hashed passwords, of course
[2012-02-17 19:19:00 -0500] doki_pen_: i know I can just insert into the DB, that'd work
[2012-02-17 19:20:00 -0500] coderanger: As long as they are prehashed, just connect to the DB
[2012-02-17 19:20:00 -0500] doki_pen_: but wondering if anyone has a better way
[2012-02-17 19:20:00 -0500] coderanger: I would make a mgmt command that handles the idempotence
[2012-02-17 19:20:00 -0500] coderanger: and wrap it in an LWRP :)
[2012-02-17 19:20:00 -0500] doki_pen_: coderanger: that's what I was thinking.. but I have to make sure they don't already exist.
[2012-02-17 19:20:00 -0500] doki_pen_: is that what idempotence means?
[2012-02-17 19:20:00 -0500] coderanger: Yes
[2012-02-17 19:20:00 -0500] doki_pen_: awesome, vocab lessons too
[2012-02-17 19:20:00 -0500] doki_pen_: thanks man
[2012-02-17 19:21:00 -0500] doki_pen_: any examples? i haven't done much LWRP
[2012-02-17 19:21:00 -0500] arthurkalm: mlei ok, tried it
[2012-02-17 19:21:00 -0500] coderanger: doki_pen_: Check the wiki
[2012-02-17 19:21:00 -0500] arthurkalm: It didn't give any more info ...
[2012-02-17 19:21:00 -0500] doki_pen_: k, thanks
[2012-02-17 19:22:00 -0500] arthurkalm: I updated the gist: https://gist.github.com/1854933
[2012-02-17 19:22:00 -0500] arthurkalm: I don't have the git cookbook installed yet
[2012-02-17 19:23:00 -0500] mlei: huh. what happens if you untarball that tarball manually into that location?
[2012-02-17 19:24:00 -0500] arthurkalm: And then upload it?
[2012-02-17 19:25:00 -0500] mattdawson: jtimberman: i'm back to hacking on veewee stuff. with your templates, how do you go about getting chef on a new box? are you installing manually after you vagrant up?
[2012-02-17 19:25:00 -0500] mlei: uploading doesn't matter
[2012-02-17 19:25:00 -0500] jtimberman: mattdawson: the postinstall.sh does it
[2012-02-17 19:25:00 -0500] mlei: it's just having trouble unpacking the cookbook, arthurkalm
[2012-02-17 19:25:00 -0500] jtimberman: mattdawson: in my templates
[2012-02-17 19:25:00 -0500] mlei: at least, that's what it looks like to me.
[2012-02-17 19:26:00 -0500] mattdawson: jtimberman: hrm. then it would seem that the post install isn't working.
[2012-02-17 19:26:00 -0500] mattdawson: jtimberman: thanks!
[2012-02-17 19:27:00 -0500] arthurkalm: mlei when I do a site download of the git cookbook and untar that file, it untars filr
[2012-02-17 19:27:00 -0500] arthurkalm: Fine
[2012-02-17 19:27:00 -0500] geekbri: if i create a local .json file that I want to be an encrypted data bag entry.. is it as simple as knife data bag from file <databag> <file.json> --secret ?
[2012-02-17 19:27:00 -0500] geekbri: (assuming i have my secretfile set in my knife.rb)
[2012-02-17 19:28:00 -0500] arthurkalm: Ok, i got it
[2012-02-17 19:28:00 -0500] mattdawson: jtimberman: oh wait - no, it is running - sorry. that's what i mean, though - at least on the current github head. https://github.com/jtimberman/veewee-templates/blob/master/definitions/lucid/postinstall.sh
[2012-02-17 19:28:00 -0500] arthurkalm: Looks like the first time i tried to install the git cookbook, it checked out into the chef-vendor-git branch and something messed up there
[2012-02-17 19:29:00 -0500] mattdawson: i was curious because i'm trying to decide if i should do a gem install or apt package.
[2012-02-17 19:29:00 -0500] jtimberman: hrm looks like that got lost somewhere.
[2012-02-17 19:29:00 -0500] arthurkalm: When i tried installing again, it kept switching to that branch and trying to install from there and failed. Once i removed that branch and tried again, it worked
[2012-02-17 19:30:00 -0500] mlei: nice.
[2012-02-17 19:30:00 -0500] jtimberman: mattdawson: i don't have time to fix it up all proper right now, but you can stick: curl -L http://opscode.com/chef/install.sh | bash
[2012-02-17 19:31:00 -0500] jtimberman: in there before the vagrant key stuff
[2012-02-17 19:31:00 -0500] mattdawson: jtimberman: oh, excellent! that's exactly what i was hoping for.
[2012-02-17 19:40:00 -0500] arthurkalm: mlei this seems like a bug, i should probably open an issue on it
[2012-02-17 19:43:00 -0500] arthurkalm: Anyway, thanks for the help
[2012-02-17 20:25:00 -0500] MBravo: hello
[2012-02-17 20:25:00 -0500] MBravo: am having trouble with chef-server not starting on a fresh debian squeeze install
[2012-02-17 20:26:00 -0500] MBravo: on startup it prints a pid, waits, says failed
[2012-02-17 20:26:00 -0500] MBravo: upon investigation the process with such pid does exist but soon exits
[2012-02-17 20:26:00 -0500] MBravo: I suspect something fishy around the creation of pid files with %s in them in /var/run/chef
[2012-02-17 20:27:00 -0500] MBravo: probably something well known, but was unable to google anything helpful
[2012-02-17 20:27:00 -0500] MBravo: would anyone have a clue what could be wrong?
[2012-02-17 20:33:00 -0500] zuhaib: Hey anyone seen issues with the new java::oracle recipe deploying openjdk on Ubuntu?
[2012-02-17 20:33:00 -0500] zuhaib: I am getting some odd behaviors with it.  I am actually debating about reverting back as we use oracle/sun java in development for now have have not made the cut over
[2012-02-17 20:38:00 -0500] AntonZ: during user creation, any way to allow that user to sudo ?
[2012-02-17 20:40:00 -0500] MBravo: you can have a rule in sudoers file for a group, and craete user in that group
[2012-02-17 20:40:00 -0500] MBravo: create*
[2012-02-17 20:43:00 -0500] AntonZ: well, the rule is already there, it's just commented out, my users part of wheel group, now i need to modify sudo file to allow wheel group
[2012-02-17 20:44:00 -0500] AntonZ: so the question is how do i modify the file
[2012-02-17 20:47:00 -0500] MBravo: Anton, I would expect to uncomment the rule before doing the user creation
[2012-02-17 20:47:00 -0500] MBravo: a simple sed command would do that, no?
[2012-02-17 20:55:00 -0500] AntonZ: whats sed command ? is it chef ?
[2012-02-17 20:59:00 -0500] miah: use a template
[2012-02-17 21:00:00 -0500] miah: and make your template add or do nothing depending on specific conditions
[2012-02-17 21:01:00 -0500] AntonZ: im abit confused about what it means to use a template
[2012-02-17 21:01:00 -0500] miah: templates?
[2012-02-17 21:01:00 -0500] bawt: templates is http://wiki.opscode.com/display/chef/Templates
[2012-02-17 21:02:00 -0500] AntonZ: waht if i added this to my recipe - would that do what i need in terms of modifying the file:
[2012-02-17 21:02:00 -0500] AntonZ: sed -e "s/#PasswordAuthentication yes/PasswordAuthentication yes/g" -i /etc/ssh/sshd_config
[2012-02-17 21:02:00 -0500] mlei: no
[2012-02-17 21:02:00 -0500] mlei: wait, maybe
[2012-02-17 21:02:00 -0500] miah: you dont modify the file, you rewrite the file based on conditions. go read that document that was just linked.
[2012-02-17 21:03:00 -0500] AntonZ: reading
[2012-02-17 21:03:00 -0500] mlei: AntonZ: i thought you were talking about sudo?
[2012-02-17 21:05:00 -0500] hoover_damm: sounds more like just bad practices of enabling/disabling things easily in plaintext files instead of using ruby_block or template
[2012-02-17 21:05:00 -0500] AntonZ: i need both, i need to modify sudoer file to add my freshly created users to suoders
[2012-02-17 21:05:00 -0500] hoover_damm: it can be done using sed, it can be done using a ruby_block to rewrite that bit of the file... using a template is going to be the least error prone route
[2012-02-17 21:05:00 -0500] mlei: yeah, doing a sed command is pretty fragile
[2012-02-17 21:06:00 -0500] hoover_damm: as it will allow you to ensure that your changes are actually there
[2012-02-17 21:06:00 -0500] AntonZ: why do you say that mlei ?
[2012-02-17 21:06:00 -0500] hoover_damm: sed and other methods are going to eventually fail (+1 mlei)
[2012-02-17 21:06:00 -0500] mlei: AntonZ: because it doesn't guard against someone just modifying the file and breaking your changes
[2012-02-17 21:07:00 -0500] hoover_damm: or upstream changing the command, so your sed command doesn't work any longer
[2012-02-17 21:07:00 -0500] mlei: what if someone put a space between the # and the P? then your command won't work anymore
[2012-02-17 21:07:00 -0500] hoover_damm: and you assume it still works; so a issue
[2012-02-17 21:07:00 -0500] mlei: better to use a template and write an entire file that you know is good
[2012-02-17 21:07:00 -0500] hoover_damm: mlei, you can do ^ to check the beginning of the line (fwiw)
[2012-02-17 21:08:00 -0500] AntonZ: understood, i will try to do that, thank you both!
[2012-02-17 21:08:00 -0500] mlei: hoover_damm: sure, you can make your regex better, but as we both just said, better not to, eh?
[2012-02-17 21:10:00 -0500] miah: just use a template
[2012-02-17 21:10:00 -0500] miah: using sed in a ruby block is jsut stupid
[2012-02-17 21:10:00 -0500] miah: look at the sudoers cookbook, it does most of this already
[2012-02-17 21:11:00 -0500] miah: but read up on templates until you understand them
[2012-02-17 21:11:00 -0500] miah: if you're doing black magic to edit files you are going to end up with broken shit and un-needed stress
[2012-02-17 21:11:00 -0500] Gearbox: That's the cfengine way, black magic edits.  *does not want*
[2012-02-17 21:12:00 -0500] miah: ya
[2012-02-17 21:12:00 -0500] miah: i stopped doing that 7 years ago, not going back
[2012-02-17 21:13:00 -0500] hoover_damm: black magic edits look good to newbies who don't know better
[2012-02-17 21:13:00 -0500] hoover_damm: they often go 'ooh how cool'
[2012-02-17 21:14:00 -0500] mlei: black magic is good for stuff you need to do on the fly
[2012-02-17 21:14:00 -0500] mlei: not stuff you need to happen consistently
[2012-02-17 21:14:00 -0500] hoover_damm: mlei, i'd rather just make the template and do it consistently
[2012-02-17 21:15:00 -0500] hoover_damm: otherwise you can forget
[2012-02-17 21:16:00 -0500] mlei: sure, generally that's true. but there are one off things like, we need to rename a box in 20 config files just for one day, etc.
[2012-02-17 21:16:00 -0500] AntonZ: yes, looks like tempalte already does what i need, just will need to modify to my needs
[2012-02-17 21:17:00 -0500] mlei: it's good for if you need to do something fast and probably only once, then you can leave chef to get things back to normal once you don't need them anymore
[2012-02-17 21:34:00 -0500] AntonZ: out of curiocity - sed or not sed, how does one plug a command into a recipe, doesnt look like chef likes a simple statement such as sed -e "bla bla"
[2012-02-17 21:39:00 -0500] JasonBox: depends on how you did it
[2012-02-17 21:39:00 -0500] AntonZ: i jjust plugged the command in
[2012-02-17 21:40:00 -0500] JasonBox: to what?
[2012-02-17 21:40:00 -0500] AntonZ: user "john" do
[2012-02-17 21:40:00 -0500] AntonZ:   comment "John"
[2012-02-17 21:40:00 -0500] AntonZ:   shell "/bin/bash"
[2012-02-17 21:40:00 -0500] AntonZ:   home "/home/swarren"
[2012-02-17 21:40:00 -0500] AntonZ:   uid "502"
[2012-02-17 21:40:00 -0500] AntonZ:   gid "10"
[2012-02-17 21:40:00 -0500] AntonZ:   password "0UiuT5EB1"
[2012-02-17 21:40:00 -0500] AntonZ: end
[2012-02-17 21:40:00 -0500] AntonZ: sed -e " blabla
[2012-02-17 21:40:00 -0500] AntonZ: thats lets say my recipe
[2012-02-17 21:41:00 -0500] JasonBox: oh my
[2012-02-17 21:41:00 -0500] JasonBox: Use pastie!
[2012-02-17 21:42:00 -0500] AntonZ: sec :)
[2012-02-17 21:42:00 -0500] JasonBox: there can't be a sed -e hanging in there
[2012-02-17 21:42:00 -0500] JasonBox: You need to wrap it inside an execute resource
[2012-02-17 21:42:00 -0500] JasonBox: Or possibly a not_if only_if block, although user is aware if the user exists
[2012-02-17 21:43:00 -0500] AntonZ: whats execute resource ?
[2012-02-17 21:43:00 -0500] AntonZ: care to give a small example ?
[2012-02-17 21:45:00 -0500] JasonBox: Oh
[2012-02-17 21:46:00 -0500] JasonBox: http://wiki.opscode.com/display/chef/Resources
[2012-02-17 21:46:00 -0500] JasonBox: It includes examples for the execute resource
[2012-02-17 21:46:00 -0500] JasonBox: All of them, actually
[2012-02-17 21:46:00 -0500] mlei: good to read through that entire page
[2012-02-17 21:46:00 -0500] AntonZ: fair enough
[2012-02-17 21:54:00 -0500] nect: has there been any reports of knife ec2 not assigning security groups and node name with the latest version of chef? I have an old machine running 0.10.4 and it works, but if I downgrade my json/chef and it still doesn't work
[2012-02-17 21:54:00 -0500] nect: the output from the command shows all valid info, but the machine never boots with the security group within a VPC nor the node name
[2012-02-17 22:16:00 -0500] ssd7: nect: Are you saying that the instance isn't actually in the correct security group or that the data in the 'ec2' attribute is incorrect?
[2012-02-17 22:17:00 -0500] nect: ssd7: the instance gets no assigned security groups. when I remove the subnet flag for the vpc and make it on the open network, it will assign the security group, but doesn't assign the node-name properly
[2012-02-17 22:19:00 -0500] nect: for the non vpc launch, I tried both the --node-name and -N flags to set the instance name, both didn't work
[2012-02-17 22:19:00 -0500] nect: but on my old server it all works fine
[2012-02-17 22:19:00 -0500] nect: I even downgraded every gem I had to match the old server completely.. still didn't fix it
[2012-02-17 22:19:00 -0500] nect: one is a CentOS 5.7 machine, the other a fedora 15
[2012-02-17 22:19:00 -0500] nect: centos is having the problem
[2012-02-17 22:19:00 -0500] nect: as well as my mac
[2012-02-17 22:20:00 -0500] nect: I wrote a line in the fog/lib/compute/aws.rb file, and output the attributes it sends to AWS, and it seems they get stripped
[2012-02-17 22:21:00 -0500] jhowarth: Any reason why search on a node wouldn't work for anything except "name"?  e.g. if I do a "knife node show some_node" it will list several roles.  Then if I do a 'knife search node "role:some_role"' it won't find the node even though the node has the role according to the knife node show.
[2012-02-17 22:21:00 -0500] ssd7: nect: Well, at least one person has seen this before: http://tickets.opscode.com/browse/KNIFE_EC2-45
[2012-02-17 22:22:00 -0500] jhowarth: If I do 'knife search node "name:node_name"', that works, but search doesn't work for anything else.  e.g. ipaddress, recipes, roles, run_list.
[2012-02-17 22:22:00 -0500] ssd7: jhowarth: Are you on Hosted Chef or your own chef server?
[2012-02-17 22:22:00 -0500] jhowarth: own server
[2012-02-17 22:22:00 -0500] nect: ssd7: I did come across that code in Fog and it that claim looks legit
[2012-02-17 22:22:00 -0500] nect: but it works fine on the old server
[2012-02-17 22:23:00 -0500] nect: lemme check the last changed dates.. see if someone else edited the files
[2012-02-17 22:24:00 -0500] ssd7: jhowarth: Well, my default guess these days for "search doesn't work" is http://tickets.opscode.com/browse/CHEF-2346
[2012-02-17 22:24:00 -0500] ssd7: jhowarth: Did search every work correctly for tehse nodes?
[2012-02-17 22:24:00 -0500] jhowarth: Search is working for some nodes
[2012-02-17 22:25:00 -0500] jhowarth: ssd7: thanks for the link I'll chef that out
[2012-02-17 22:25:00 -0500] jhowarth: check*
[2012-02-17 22:31:00 -0500] nect: ssd7: aha, looks like someone else modified the gem directly
[2012-02-17 22:31:00 -0500] nect: doesn't solve the other question about the name not getting assigned
[2012-02-17 22:40:00 -0500] jdeamattson: I have an interesting situation. I have a Recipe where I am running through a set services (these are represented by separate service scripts in /etc/init.d) and using the Chef service LWRP to start them (they have been previously enabled). Only one of them is starting. Nothing in the debug logs. Here is a gist of the code: https://gist.github.com/1855882. Any thoughts?
[2012-02-17 22:41:00 -0500] jdeamattson: If I go to the command line on the box and perform a service foo start, I can start any of them.
[2012-02-17 22:50:00 -0500] fujin: jdeamattson: you haven't got supports :status => true or anything like that, so it's doing a basic 'ps -ef | grep <name>' to determine if the proc is running
[2012-02-17 22:50:00 -0500] fujin: I'm guessing something is probably matching that, making chef think the service is running.
[2012-02-17 22:51:00 -0500] jdeamattson: Ah, ok.
[2012-02-17 22:51:00 -0500] fujin: if the service does in fact support status, you should add that hint so chef can query the status instead of trying to parse the process table
[2012-02-17 22:53:00 -0500] jdeamattson: Fujin - here is the definition of the service and where I enable it. https://gist.github.com/1855952. Do I need to state what is supported each and every time?
[2012-02-17 22:54:00 -0500] Axsuul: If I'm using RVM to install Ruby, is it recommended to install RVM manually and then install Chef, or install ruby, then chef, then use chef to install RVM
[2012-02-17 22:54:00 -0500] fujin: jdeamattson: yes, chef doesn't guess. yuou dont'need to say it supports start, stop, etc
[2012-02-17 22:55:00 -0500] jdeamattson: So, each and every time I reference the service, I have to state what it does support? (With respect to status) - is this correct? fujin ?
[2012-02-17 22:56:00 -0500] |shad0w|: jdeamattson, if you already have them defined you should probably send a notice
[2012-02-17 22:56:00 -0500] jhowarth: ssd7: The search problem was indeed the maxFieldLength value.  Windows nodes send way more data than Unix nodes do, it seems.  That was the first windows node we registered with a new chef server.  Thanks again!
[2012-02-17 22:56:00 -0500] fujin: jdeamattson: no, only when you define it..
[2012-02-17 22:56:00 -0500] |shad0w|: s/notice/notify
[2012-02-17 22:57:00 -0500] jdeamattson: |shad0w|: Unclear on what you mean by Notify....
[2012-02-17 22:57:00 -0500] jdeamattson: |shad0w|: Unclear on what you mean by Notify.
[2012-02-17 22:57:00 -0500] |shad0w|: notify?
[2012-02-17 22:57:00 -0500] bawt: notify is http://wiki.opscode.com/display/chef/Resources#Resources-Meta
[2012-02-17 22:57:00 -0500] jdeamattson: fujin: In my second gist, did I define it correctly?
[2012-02-17 22:57:00 -0500] jdeamattson: bawt: Thnk you....
[2012-02-17 22:59:00 -0500] |shad0w|: jdeamattson, basics are you define a service resource, then you act it on later with notify when you want things to happen
[2012-02-17 22:59:00 -0500] LawrenceSeattle: I want to make a new function for a recipe.  How do I do that?  Looks like def doesn't work...
[2012-02-17 23:00:00 -0500] |shad0w|: like another resource changing like a template
[2012-02-17 23:00:00 -0500] |shad0w|: s/^like/as in
[2012-02-17 23:00:00 -0500] jdeamattson: |shad0w|: Ok, that wasn't the pattern I saw in other places.
[2012-02-17 23:03:00 -0500] jdeamattson: |shad0w|: Thanks for the pointer. I will dig into it.
[2012-02-17 23:03:00 -0500] ssd7: jhowarth: np!
[2012-02-17 23:04:00 -0500] |shad0w|: jdeamattson, np
[2012-02-17 23:04:00 -0500] tolland: what is the use case for TAGs?
[2012-02-17 23:04:00 -0500] ssd7: nect: When you say instance name do you mean the node name in hosted chef or the instances name according to AWS
[2012-02-17 23:04:00 -0500] nect: instance name
[2012-02-17 23:04:00 -0500] jdeamattson: Went digging into the service script is written and i believe I found an issue there.
[2012-02-17 23:05:00 -0500] nect: Action=CreateTags that action never gets performed on my local machine
[2012-02-17 23:05:00 -0500] nect: it does the DescribeInstance multiple times waiting for it to launch.. but when it finds the server, it never performs the tagging
[2012-02-17 23:12:00 -0500] David_Miller: I have a custom package (.deb) I want to install on a bunch of servers, I see that I can use the source option for the package resource to install from a file, but how do I get the file onto the machine
[2012-02-17 23:12:00 -0500] fujin: David_Miller: deploy an apt repository
[2012-02-17 23:12:00 -0500] fujin: use apt bittorrent?
[2012-02-17 23:12:00 -0500] fujin: https://github.com/heavywater/chef-graphiti
[2012-02-17 23:13:00 -0500] fujin: put the debs on s3 and generate public URLS and use those with remote_file
[2012-02-17 23:13:00 -0500] fujin: I would deploy an apt repository
[2012-02-17 23:13:00 -0500] fujin: see this:
[2012-02-17 23:13:00 -0500] fujin: pennyworth?
[2012-02-17 23:13:00 -0500] bawt: pennyworth is https://github.com/heavywater/pennyworth
[2012-02-17 23:13:00 -0500] David_Miller: I am going to need my own apt repo soon for sure
[2012-02-17 23:13:00 -0500] fujin: jenkins + fpm + apt repository + ... + magic databags per build
[2012-02-17 23:13:00 -0500] David_Miller: I was just going to stick the deb in the cookbook file distribution directory
[2012-02-17 23:14:00 -0500] fujin: how big is the deb
[2012-02-17 23:14:00 -0500] David_Miller: 3 megs
[2012-02-17 23:14:00 -0500] fujin: i try to avoid sticking giant ass shit in cookbooks, since you store it in git
[2012-02-17 23:14:00 -0500] David_Miller: yeah good point
[2012-02-17 23:15:00 -0500] fujin: you could set up a ppa on launchpad ?
[2012-02-17 23:15:00 -0500] fujin: another option
[2012-02-17 23:15:00 -0500] fujin: then you don't have to host the repo yourself.
[2012-02-17 23:15:00 -0500] |shad0w|: or use remote file to grab it if you don't want to build an apt repo
[2012-02-17 23:18:00 -0500] David_Miller: Yeah that would be the easiest way
[2012-02-17 23:18:00 -0500] ssd7: nect: As far as I know, knife-ec2 never dealt with tags.  We have a patch to make that possible, but it isn't merged yet.
[2012-02-17 23:19:00 -0500] ssd7: the instance name just being a tag
[2012-02-17 23:19:00 -0500] Axsuul: Is it not recommended to use rvm with chef?
[2012-02-17 23:20:00 -0500] nect: ssd7: there is a --node-name attribute that you can pass
[2012-02-17 23:20:00 -0500] nect: that executes the tag command in fog
[2012-02-17 23:22:00 -0500] ssd7: nect: Hrm.  It doesn't in the version of code I have checked out, unless I'm just missing soemthing.
[2012-02-17 23:22:00 -0500] nect: ssd7: you're right, there's another manual edit in here for the tag
[2012-02-17 23:23:00 -0500] jdeamattson: If you tell service to start a service and status is not supported, what does service do?
[2012-02-17 23:23:00 -0500] nect: 196: > connection.create_tags(server.id,{"Name"=>config[:chef_node_name]})
[2012-02-17 23:23:00 -0500] nect: ./lib/chef/knife/ec2_server_create.rb
[2012-02-17 23:24:00 -0500] nect: well thanks for all your help ssd7
[2012-02-17 23:24:00 -0500] nect: seems they have been manual changes all along
[2012-02-17 23:25:00 -0500] nect: any idea when we can expect to see fog upgraded for knife-ec2 so it supports the us-west-2?
[2012-02-17 23:25:00 -0500] nect: there's already a ticket in the tracker for it
[2012-02-17 23:28:00 -0500] nect: strange that theres a --node-name param to pass the ec2 command, yet it does nothing
[2012-02-17 23:30:00 -0500] Axsuul: Do you guys all use knife when first bootstrapping a server?
[2012-02-17 23:34:00 -0500] ssd7: nect: It changes the name of the node from the persective of chef (node.name).  Glad to have helped!
[2012-02-17 23:35:00 -0500] nect: ahh I see.. so they match in chef vs aws
[2012-02-17 23:35:00 -0500] nect: thx
[2012-02-17 23:41:00 -0500] nect: this is more of a ruby/gem question..
[2012-02-17 23:41:00 -0500] nect: within the knife-ec2 it requires 'fog' but doesn't specify a version
[2012-02-17 23:42:00 -0500] nect: the only version info I could find was in the gemspec, but without rebuilding and installing a new gem with an updated gemspec, I wasn't able to get knife-ec2 to require a new version of fog
[2012-02-17 23:43:00 -0500] nect: is there somewhere else a gem goes to get what version to include other than the gemspec? or is the gemspec put somewhere else on the system once installed?
[2012-02-17 23:47:00 -0500] nect: ahh there is, /opt/local/lib/ruby/gems/1.8/specifications
[2012-02-17 23:47:00 -0500] nect: seems it copies it there on install
[2012-02-17 23:55:00 -0500] pedahzur: Could someone point out if I'm missing something obvious?  I installed chef on RHEL5 via 'yum -y install rubygem-chef' and it installed without error. But when I try to run it, I get: /usr/bin/chef-solo:9:in `require': no such file to load -- rubygems (LoadError)  from /usr/bin/chef-solo:9  Is chef missing a dependency?
[2012-02-17 23:57:00 -0500] Axsuul: Does anyone have a good bootstrap template for installing ruby 1.9+ on ubuntu?
[2012-02-17 23:57:00 -0500] Axsuul: or is there a standard way of doing this, or do I need to create my own template?
[2012-02-17 23:57:00 -0500] Axsuul: (for use with knife)
