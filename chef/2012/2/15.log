[2012-02-15 08:20:00 -0500] Mithrandir: I utterly hate and despise that sometimes using foo[:key] works, sometimes you need foo["key"] and sometimes you can use either.
[2012-02-15 08:30:00 -0500] nico: morning chef-ers
[2012-02-15 08:33:00 -0500] nico: I want chef-client to log by syslog, I did the following : http://pastie.org/3386185 which works fine, when running chef client by hand from console, but when daemonized it still logs to /var/log/chef-client.log
[2012-02-15 08:33:00 -0500] nico: any hint ?
[2012-02-15 08:33:00 -0500] bawt: any hint is most welcome :)
[2012-02-15 08:34:00 -0500] Mithrandir: bawt: forget any hint
[2012-02-15 08:34:00 -0500] bawt: aight
[2012-02-15 08:35:00 -0500] nico: 04:13 <@jtimberman> flashmanbahadur1: We are actively working on a reporting feature as a part of the  Hosted Chef management console and such.
[2012-02-15 08:35:00 -0500] nico: kewl
[2012-02-15 08:50:00 -0500] BryanWB: nico: good morning!
[2012-02-15 08:50:00 -0500] BryanWB: bonjour
[2012-02-15 08:51:00 -0500] BryanWB: how can I add accessors to an lwrp?
[2012-02-15 08:51:00 -0500] nico: hey BryanWB
[2012-02-15 08:51:00 -0500] BryanWB: I have an lwrp for creating a tomcat instance, later in a recipe that uses that instance, i want to access properties of that lwrp
[2012-02-15 08:51:00 -0500] nacer: hi BryanWB
[2012-02-15 08:52:00 -0500] BryanWB: nacer: hey !
[2012-02-15 08:53:00 -0500] nacer: BryanWB: perhaps @new_resource ?
[2012-02-15 08:56:00 -0500] nacer: BryanWB: your making multiple tomcat instance on the same host ?
[2012-02-15 08:56:00 -0500] BryanWB: nacer: exactly
[2012-02-15 08:56:00 -0500] BryanWB: w/ a shared set of the tomcat install files
[2012-02-15 08:57:00 -0500] BryanWB: fuck, is still know so little about ruby
[2012-02-15 08:57:00 -0500] nacer: BryanWB: the @new_resource don't work ?
[2012-02-15 08:57:00 -0500] nacer: BryanWB: i'am not that good with  LWRP
[2012-02-15 08:58:00 -0500] thbar_: hi folks
[2012-02-15 09:13:00 -0500] ssd7: Ohai Chef
[2012-02-15 09:13:00 -0500] ssd7: s
[2012-02-15 09:19:00 -0500] BryanWB: ssd7: how can i add a public variable to an lwrp?
[2012-02-15 09:20:00 -0500] BryanWB: ssd7: here is what I am trying to do http://pastie.org/3386355
[2012-02-15 09:20:00 -0500] BryanWB: where tomcat is an lwrp I have created
[2012-02-15 09:22:00 -0500] m4rcu5: it is probably because the coffee machine is broken, can anyone spot the problem in this search query? http://pastebin.com/D24dURHu
[2012-02-15 09:23:00 -0500] ssd7: m4rcu5: You need to escape the :: in the recipe name
[2012-02-15 09:23:00 -0500] ssd7: BryanWB: Looking
[2012-02-15 09:23:00 -0500] gadolin: m4rcu5: escape ::
[2012-02-15 09:24:00 -0500] gadolin: m4rcu5: :: => \:\:
[2012-02-15 09:24:00 -0500] m4rcu5: gadolin: no joy, same thing
[2012-02-15 09:26:00 -0500] ssd7: BryanWB: Well, you could make base a resource attribute, but I /think/ you should be able to just do something like attr_accessor :base in your provider
[2012-02-15 09:27:00 -0500] gadolin: m4rcu5: can you pastebin the output after applying the change
[2012-02-15 09:27:00 -0500] BryanWB: ssd7: hmm,  i did   put attr_accessor :base  in my provider and  have `@base = "foobar" ` inside the :install action but no joy
[2012-02-15 09:28:00 -0500] ssd7: m4rcu5: I think you are actually going to have to "double-espcape" it : "recipes:#{cookbook_name}\\:\\:server AND chef_environment:#{node.chef_environment}"
[2012-02-15 09:29:00 -0500] m4rcu5: ssd7: ah, double escaping works, never tought of that!
[2012-02-15 09:29:00 -0500] BryanWB: m4rcu5: i would use single quotes to avoid bash param expansion
[2012-02-15 09:29:00 -0500] gadolin: m4rcu5: also if you use single quiote ... as pointer by BryanWB
[2012-02-15 09:30:00 -0500] m4rcu5: BryanWB: but single qoutes will not work with the variable right?
[2012-02-15 09:33:00 -0500] nacer: BryanWB: i have just seen cluster_chef
[2012-02-15 09:33:00 -0500] nacer: BryanWB: that's a lot of work
[2012-02-15 09:33:00 -0500] BryanWB: nacer: fuckin' awesome, the cluster part is neat, but the cookbooks inside are fucking incredible
[2012-02-15 09:34:00 -0500] ssd7: BryanWB: Hmm.  Haven't tried it myself but one thing to look out for is that log statement is happenign at compile time, so your :install action hasn't run yet when you call that log Chef::Log.info line
[2012-02-15 09:34:00 -0500] BryanWB: kind of makes me feel stupid because i have reimplemented by accident some of those
[2012-02-15 09:34:00 -0500] nacer: BryanWB: yeah, i will look to merge theyr LWRP zabbix part in the zabbix cookbooks
[2012-02-15 09:34:00 -0500] BryanWB: ssd7: tks, will try a ruby block
[2012-02-15 09:35:00 -0500] BryanWB: man these little things trip me up
[2012-02-15 09:37:00 -0500] m4rcu5: gadolin: the single qoutes gives me RuntimeError: Query recipes:ntp::server AND chef_environment:#{node.chef_environment} :-/
[2012-02-15 09:39:00 -0500] gadolin: m4rcu5: did you escape : with single slash?
[2012-02-15 09:40:00 -0500] m4rcu5: gadolin: no, i used single qoutes this time around, now it will not expand the node.chef_environment variable
[2012-02-15 09:42:00 -0500] ssd7: BryanWB: So based on a quick experiment, I think that attr_accessor is going to need to be in the resource not the provider, btw.
[2012-02-15 09:42:00 -0500] nacer: BryanWB: you ask what opscode think about this in a foodfight
[2012-02-15 09:43:00 -0500] BryanWB: ssd7: kewl, will try it
[2012-02-15 09:43:00 -0500] BryanWB: ssd7: tks
[2012-02-15 09:43:00 -0500] BryanWB: nacer: Questions welcome
[2012-02-15 09:44:00 -0500] ssd7: BryanWB: np.  To be completely honest, I think your best bet is to just make it a full-fledged attribute of the resource.  You can then access it easily in your provide via new_resource.
[2012-02-15 09:45:00 -0500] BryanWB: ssd7: yeah, i think that will work, tks
[2012-02-15 10:05:00 -0500] thbar_: anyone here working with chef on windows?
[2012-02-15 10:05:00 -0500] thbar_: I'm having a "Errno::EACCES: Permission denied - CreateProcess() failed: Access is denied." while using a git resource
[2012-02-15 10:13:00 -0500] nico: feels like syslog-ing chef client is definitely a PITA
[2012-02-15 10:16:00 -0500] flaccid: can chef log to syslog directly?
[2012-02-15 10:26:00 -0500] thbar_: opened a ticket on git + windows resource: http://tickets.opscode.com/browse/CHEF-2931
[2012-02-15 10:26:00 -0500] nico: flaccid: no
[2012-02-15 10:26:00 -0500] nico: and this sucks
[2012-02-15 10:27:00 -0500] flaccid: nico: pretty easy to do source though with syslog-ng or similar
[2012-02-15 10:27:00 -0500] flaccid: nico: http://support.rightscale.com/06-FAQs/FAQ_0146_-_How_do_I_add_an_arbitrary_log_file_to_syslog%3F
[2012-02-15 10:29:00 -0500] nico: this is a crappy hack, moreover, it will not help rotating the local file
[2012-02-15 10:29:00 -0500] nico: working with freebsd, when the file is rotated chef lose the associated fd and does not log anymore
[2012-02-15 10:36:00 -0500] flaccid: nico: this is not a crappy hack. this is just normal configuration
[2012-02-15 10:36:00 -0500] flaccid: a syslog server does not do rotation necessarily, this is what logrotate is for
[2012-02-15 10:38:00 -0500] nico: flaccid: I disagree here : I don't want to have to "slurp" files with syslog-ng (or rsyslog). Using a modern language as ruby should permit to log to syslog directly, without to have to modify the local syslog config
[2012-02-15 10:38:00 -0500] flaccid: sure, but its not possible atm right? so its a feature request
[2012-02-15 10:39:00 -0500] flaccid: http://support.rightscale.com/06-FAQs/FAQ_0174_-_How_do_I_configure_log_rotation_on_my_instances%3F
[2012-02-15 10:39:00 -0500] nico: I know how to use logrotate and stuff...
[2012-02-15 10:40:00 -0500] nico: that's not the point here
[2012-02-15 10:40:00 -0500] flaccid: the point is reality
[2012-02-15 10:40:00 -0500] flaccid: deal with it :)
[2012-02-15 10:41:00 -0500] thbar_: giving up on using the git resource on windows for now; I'll do the clone manually instead
[2012-02-15 10:42:00 -0500] flaccid: nico: we can see this already requested a few times http://tickets.opscode.com/secure/IssueNavigator.jspa?
[2012-02-15 10:42:00 -0500] flaccid: http://tickets.opscode.com/browse/CHEF-273 looks like it is committed http://tickets.opscode.com/browse/CHEF-273
[2012-02-15 10:43:00 -0500] flaccid:  17/Mar/11
[2012-02-15 10:43:00 -0500] nico: and it doesn't work
[2012-02-15 10:43:00 -0500] flaccid: did you lodge a bug for that?
[2012-02-15 10:44:00 -0500] nico: trying to find out why it doesn't work
[2012-02-15 10:44:00 -0500] flaccid: i see http://tickets.opscode.com/browse/CHEF-2560
[2012-02-15 10:44:00 -0500] nico: neither
[2012-02-15 10:45:00 -0500] flaccid: comment
[2012-02-15 10:45:00 -0500] flaccid: and wait for the bug to be fixed :)
[2012-02-15 10:45:00 -0500] nico: It works when you run the daemon from your console invocating chef-client
[2012-02-15 10:45:00 -0500] nico: but once it's daemonized, nothing goes to syslog
[2012-02-15 10:46:00 -0500] flaccid: that may be a diff bug or something wrong in your local config. either way use the bug tracker.
[2012-02-15 10:46:00 -0500] laurent\: nico: t'as l'air grognon aujourd'hui :)
[2012-02-15 10:46:00 -0500] nico: :)
[2012-02-15 10:48:00 -0500] nico: not grumpy, just fed up searching for the root cause. Once I'll know why this fail, I'll push a patch
[2012-02-15 10:48:00 -0500] flaccid: i found that in about 5 seconds by searching heh
[2012-02-15 10:49:00 -0500] nico: I went by those tickets days ago
[2012-02-15 10:49:00 -0500] flaccid: and neither describe the problem you have in daemonizing, thus adivising you to lodge another bug.
[2012-02-15 11:14:00 -0500] m4rcu5: hhmm, im running into a conflict i guess, i have a ntp::server and ntp::client, but the ntp::client is part of my basline role, but that will conflict with th server recipe if it also has the role ntp... is there a way to exclude a specific recipe from a node or have the client recipe check the runlist and exit if there is already a server recipe?
[2012-02-15 11:19:00 -0500] theozaurus: Could anyone help solve this attribute mystery? https://gist.github.com/1835138 . It used to work well in 0.9.14, but now expand! does not seem to behave it's self
[2012-02-15 11:19:00 -0500] |shad0w|: m4rcu5, I just wrapped my client ntp recipe in a conditional and I set an attrib in a role for the ntp servers
[2012-02-15 11:23:00 -0500] m4rcu5: |shad0w|: that sounds sane, but isnt there an function like exit? else an if (! node[:recipes].index("ntp::server")) statement has to do :-/
[2012-02-15 11:23:00 -0500] |shad0w|: probably I was in a hurry when I did mine
[2012-02-15 11:23:00 -0500] |shad0w|: and my ntp recipe was short so I just did if !node[:service][:ntp].attribute?("no_config") || ( node[:service][:ntp].attribute?("no_config") && node[:service][:ntp][:no_config] == "false" )
[2012-02-15 11:28:00 -0500] m4rcu5: |shad0w|: let me test one thing out, maybe i have a real nice solution :)
[2012-02-15 11:28:00 -0500] thbar_: work-around for my git issues on windows: https://gist.github.com/1835161
[2012-02-15 11:28:00 -0500] thbar_: it seems that maybe shell_out doesn't catch git.exe while it's on the path
[2012-02-15 11:39:00 -0500] m4rcu5: hhm just doing an "exit" in the recipe will cause an exeption :-/
[2012-02-15 11:59:00 -0500] missus: Do any of you have public chef repos that you use to deploy or set up servers for rails apps? I could use some pointers.
[2012-02-15 12:07:00 -0500] BryanWB: nacer: lwrps is where the magic happens
[2012-02-15 12:10:00 -0500] nacer: BryanWB: yup :)
[2012-02-15 12:12:00 -0500] m4rcu5: |shad0w|: i gave in, i wrapped mine also :-/
[2012-02-15 12:13:00 -0500] m4rcu5: lol BryanWB i just found out that i was looking at your nagios cookbook all the time for hints on using the search function :-)
[2012-02-15 12:14:00 -0500] BryanWB: m4rcu5: I only patched it
[2012-02-15 12:28:00 -0500] auduny: Hm. How do people do deploys from svn+ssh (or ssh in general)
[2012-02-15 12:28:00 -0500] auduny: DO you give a password or do you use passwordless keys?
[2012-02-15 12:29:00 -0500] auduny: And if you do? Where do you store the key and how do you use the key when checking out from say svn?
[2012-02-15 12:31:00 -0500] auduny: Seems like you can use a ssh-wrapper for git
[2012-02-15 12:31:00 -0500] auduny: But we use svn...
[2012-02-15 13:13:00 -0500] `brendan: moring
[2012-02-15 13:18:00 -0500] BryanWB: morning!
[2012-02-15 13:20:00 -0500] BryanWB: it's alive! my basic lwrp for a tomcat instance works https://github.com/bryanwb/cookbooks/tree/master/tomcat
[2012-02-15 13:20:00 -0500] sivy: mornin
[2012-02-15 14:02:00 -0500] auduny: Hm. Is the svn deply examples only for http(s) or does it handle over ssh as well?
[2012-02-15 14:03:00 -0500] auduny: I'm asked for a password even though i send svn_password
[2012-02-15 14:16:00 -0500] auduny: Hm. Looks like subversion uses user and group instead of svn_username and svn_password when checking out from svn+ssh.
[2012-02-15 14:16:00 -0500] auduny: And then I can't send password.
[2012-02-15 14:16:00 -0500] auduny: HMpf.
[2012-02-15 14:17:00 -0500] auduny: Need to deploy using certificates then. Hm.
[2012-02-15 14:28:00 -0500] thbar_: auduny: I never used svn with chef so far; but I'd be curious; please share your findings
[2012-02-15 14:37:00 -0500] auduny: Is deploy_key in databags only for git?
[2012-02-15 14:38:00 -0500] auduny: Or can it be used for svn as well?
[2012-02-15 14:39:00 -0500] thbar_: auduny: I have no idea really
[2012-02-15 14:39:00 -0500] thbar_: auduny: but I'll check the source to know that
[2012-02-15 14:39:00 -0500] thbar_: give me a sec
[2012-02-15 14:41:00 -0500] sivy: any tried to use the redis cookbook and gotten as "user redis is already logged in" error?
[2012-02-15 14:41:00 -0500] auduny: subversion seems to be a bit of a second citizen in chef :-)
[2012-02-15 14:41:00 -0500] auduny: thbar_: That would be cool if you could.
[2012-02-15 14:41:00 -0500] auduny: Alternative is to make a ugly receipy to distribute the private key.
[2012-02-15 14:42:00 -0500] thbar_: auduny: you know I'm already doing a custom recipe to deploy the same private/public key for deployment actually
[2012-02-15 14:42:00 -0500] thbar_: auduny: svn - maybe, just as much as windows ? :)
[2012-02-15 14:42:00 -0500] thbar_: but well this will get better :)
[2012-02-15 14:43:00 -0500] auduny: Heh. But how do you do it. Have the private key directly in the recipy, or to you extract it from (encrypted) databags and store it in a file?
[2012-02-15 14:43:00 -0500] thbar_: currently:
[2012-02-15 14:44:00 -0500] thbar_: I have two git repos; one for developers, one for infrastructure deployers
[2012-02-15 14:44:00 -0500] thbar_: and sensible things are symlinked between both
[2012-02-15 14:44:00 -0500] thbar_: (to get started)
[2012-02-15 14:44:00 -0500] thbar_: I'm investigating how to use encrypted databags with knife-solo
[2012-02-15 14:44:00 -0500] thbar_: (but not done yet)
[2012-02-15 14:45:00 -0500] thbar_: I'm only using chef-solo btw
[2012-02-15 14:45:00 -0500] thbar_: (https://github.com/opscode/chef/blob/master/chef/lib/chef/provider/subversion.rb
[2012-02-15 14:45:00 -0500] thbar_: https://github.com/opscode/chef/blob/master/chef/lib/chef/resource/subversion.rb
[2012-02-15 14:46:00 -0500] thbar_: auduny: recommended readings :)
[2012-02-15 14:46:00 -0500] thbar_: I don't think keys are supported in there (quick look)
[2012-02-15 14:47:00 -0500] thbar_: but well unless
[2012-02-15 14:47:00 -0500] thbar_: these are supported by svn without a param
[2012-02-15 14:47:00 -0500] thbar_: (I have never used svn with keys so I can't tell)
[2012-02-15 14:48:00 -0500] thbar_: if svn expects keys somewhere, then I would just create a resource for that before (using encrypted data bags or plain stuff if it's not sensitive), or stick with username/password
[2012-02-15 14:49:00 -0500] thbar_: auduny: voil - hope this helps!
[2012-02-15 14:50:00 -0500] auduny: thbar_: Thanks. unfortunaltly passwords don't work with svn+ssh. So im' now distributing a private key from a encrypted databag
[2012-02-15 14:53:00 -0500] yfeldblum: auduny, why do you need svn+ssh? why not svn+https?
[2012-02-15 14:55:00 -0500] thbar_: auduny: ah didn't know you were going svn+ssh. I'd have the same question as yfeldblum then!
[2012-02-15 15:47:00 -0500] till_: i am in an applications loop (during deploy), and include_recipe to load another recipe (inside the loop, in a conditional). but in that recipe, 'deploy' is not set anymore. at least it seems.
[2012-02-15 15:47:00 -0500] till_: is that something ruby does - scope related? or am i just using it wrong
[2012-02-15 15:47:00 -0500] till_: or both :D
[2012-02-15 15:52:00 -0500] j-v-e: I have a small block of ruby code that I want to trigger using a notification.
[2012-02-15 15:52:00 -0500] j-v-e: Should I wrap the ruby block in a "script" block and call it using notifies ?
[2012-02-15 15:54:00 -0500] ssd7_: j-v-e: There is a ruby_block resource you can use.
[2012-02-15 15:54:00 -0500] j-v-e: Ha nice ! thanks ssd7_ !
[2012-02-15 15:55:00 -0500] ssd7: j-v-e: no problem. :)
[2012-02-15 15:56:00 -0500] ssd7: till_: Can you paste the relevant snippet of recipe code somewhere like gist?
[2012-02-15 15:58:00 -0500] sivy: ssd7: hey Steve
[2012-02-15 15:59:00 -0500] sivy: good morning!
[2012-02-15 16:01:00 -0500] ssd7: morning'
[2012-02-15 16:05:00 -0500] j-v-e: is there a way to pass a parameter during a notification ?
[2012-02-15 16:05:00 -0500] j-v-e: something variable like an ip address
[2012-02-15 16:08:00 -0500] ssd7: j-v-e: I don't believe so.  Well, since it is all "just ruby" you likely can work up some way, but if you find yourself working hard to do soemthing it typically means that either there is a better way to be doing it or that Chef could use another feature.
[2012-02-15 16:11:00 -0500] flashmanbahadur: whats the syntax for doing multiple notifications off of a template block?
[2012-02-15 16:11:00 -0500] flashmanbahadur: nm
[2012-02-15 16:11:00 -0500] flashmanbahadur: just need to read farther down the page
[2012-02-15 16:13:00 -0500] vhogemann: hi there, I' m having some troubles with the aws recipe. I need to create and attach two different volumes from two separated snapshots... the first one runs fine, but the second fails... every time
[2012-02-15 16:14:00 -0500] vhogemann: the order doesn't matter... the second one always fails
[2012-02-15 16:14:00 -0500] vhogemann: any insight on what could be happening?
[2012-02-15 16:20:00 -0500] flashmanbahadur: vhogemann: can you paste your code you are using to do it?
[2012-02-15 16:21:00 -0500] vhogemann: ok... wait a sec
[2012-02-15 16:22:00 -0500] vhogemann: pastebin.com/HFg4bnQs
[2012-02-15 16:23:00 -0500] vhogemann: the code is inside a define
[2012-02-15 16:24:00 -0500] vhogemann: it works well the first time, but when it's called again from another recipe it fails at the mount, complaining about the device
[2012-02-15 16:25:00 -0500] vhogemann: the volume isn't being created from the snapshot
[2012-02-15 16:26:00 -0500] vhogemann: I'm running it from chef-solo btw
[2012-02-15 16:26:00 -0500] sivy: ssd7: got my git setup working
[2012-02-15 16:26:00 -0500] geekbri: Has anybody here used the jenkins community cookbook?
[2012-02-15 16:26:00 -0500] sivy: once i s/(bitbucket)\.com/$1.org/g
[2012-02-15 16:29:00 -0500] ssd7: sivy: great! :)  Yeah, I took a look with fresh eyes this morning and as like "wait a second..."
[2012-02-15 16:30:00 -0500] sivy: yeah, my eyes weren't fresh, but i was all "heeeyy..."
[2012-02-15 16:30:00 -0500] sivy: now on to mysql issues.
[2012-02-15 16:30:00 -0500] sivy: grr.
[2012-02-15 16:34:00 -0500] sivy: ssd7: "[Wed, 15 Feb 2012 08:26:00 -0800] DEBUG: Re-raising exception: LoadError - no such file to load -- mysql" -- i'm interpreting that as a missing gem?
[2012-02-15 16:36:00 -0500] ssd7: sivy: Yes.  Is this in a recipe you are writing yourself or one of the community site recipes.  When you insall a gem for immediate use within a recipe there is currently some magic that you need to do.
[2012-02-15 16:37:00 -0500] sivy: it's in my app's default.rb
[2012-02-15 16:37:00 -0500] sivy: mysql_database node['mysql']['db_name'] do
[2012-02-15 16:37:00 -0500] sivy:   Chef::Log.debug "Db is #{node['mysql']['db_name']}"
[2012-02-15 16:37:00 -0500] sivy:   Chef::Log.debug "database is #{node['pushcode']['database']}"
[2012-02-15 16:37:00 -0500] sivy:   host "localhost"
[2012-02-15 16:37:00 -0500] sivy:   username "root"
[2012-02-15 16:37:00 -0500] sivy:   #password node['mysql']['server_root_password']
[2012-02-15 16:37:00 -0500] sivy:   password "oh no i dint"
[2012-02-15 16:37:00 -0500] sivy:   #database node['pushcode']['database']
[2012-02-15 16:37:00 -0500] sivy:   database "pushcode"
[2012-02-15 16:37:00 -0500] sivy:   action :create_db
[2012-02-15 16:37:00 -0500] sivy: end
[2012-02-15 16:37:00 -0500] sivy: oh frak
[2012-02-15 16:37:00 -0500] sivy: *facepalm*
[2012-02-15 16:38:00 -0500] sivy: sorry folks
[2012-02-15 16:39:00 -0500] sivy: ssd7: i'm using it from the community mysql cookbook
[2012-02-15 16:39:00 -0500] sivy: so i'd expect gems and stuff to be available
[2012-02-15 16:47:00 -0500] bluenemo: hi guys, i'm having some issues configuring my .erb file for bootstraping, it seems like it doesnt like the bash -c ''. is there anything known about this? is this script executed like "ruby ubuntu-foo.erb"?
[2012-02-15 16:47:00 -0500] geekbri: Is it valid in chef to take the results of a search(:node) and compare it to node?  so results = search(:node,"role:whatever")    then   not_if results.first == node  or something like that?
[2012-02-15 16:47:00 -0500] ssd7: sivy: In your log do you see "Missing gem 'mysql'" anywhere?
[2012-02-15 16:51:00 -0500] bluenemo: should ruby -c ubuntu-foo.erb give syntax ok? i dont get syntax ok for the default files
[2012-02-15 17:02:00 -0500] dasickis: i've tried to google around but i'm unable to find what's going on
[2012-02-15 17:02:00 -0500] dasickis: my couchdb keeps dying when i run chef-client
[2012-02-15 17:03:00 -0500] dasickis: and then chef errors out with `401: "Unauthorized"`
[2012-02-15 17:23:00 -0500] j-v-e: does somebody have an example of how "subscribes" on a template would work ?
[2012-02-15 17:24:00 -0500] j-v-e: I'm trying to trigger a ruby_block when a template is modified
[2012-02-15 17:24:00 -0500] j-v-e: I get this error NoMethodError: undefined method `notifies' for "template['/var/ossec/etc/client.keys']"
[2012-02-15 17:24:00 -0500] j-v-e: this is my subscribes
[2012-02-15 17:24:00 -0500] j-v-e: subscribes :reload, "template['/var/ossec/etc/client.keys']"
[2012-02-15 17:27:00 -0500] j-v-e: ok I have to use the old syntax for that
[2012-02-15 17:27:00 -0500] j-v-e: subscribes :create, resources(:template => "/var/ossec/etc/client.keys")
[2012-02-15 17:28:00 -0500] j-v-e: what I don't get is why my ruby_block gets executed all the time
[2012-02-15 17:28:00 -0500] j-v-e: shouldn't it be processed only when the template is modified ??
[2012-02-15 17:28:00 -0500] jbz: It *should*, yes
[2012-02-15 17:28:00 -0500] jbz: although are you sure it's executing, and not just processing?
[2012-02-15 17:29:00 -0500] jbz: Logging is a bit confused on this subject
[2012-02-15 17:29:00 -0500] j-v-e: this ruby block modified the value of an attribute
[2012-02-15 17:29:00 -0500] j-v-e: and I see it being modified constantly
[2012-02-15 17:29:00 -0500] j-v-e: but my template is the same, no change there
[2012-02-15 17:30:00 -0500] j-v-e: here's my recipe http://pastebin.com/hUitd8tJ
[2012-02-15 17:34:00 -0500] j-v-e: Ha, I should set the "action" in the ruby block to "nothing" ?
[2012-02-15 17:36:00 -0500] j-v-e: that's a bit of a monologue, but I figured it out ! action needed to be set to nothing :)
[2012-02-15 17:46:00 -0500] miah: moin
[2012-02-15 17:49:00 -0500] AntonZ: Hello, im running my cookbook/recipe and get this error message:
[2012-02-15 17:49:00 -0500] AntonZ: *ERROR> An error occurred during the execution of Chef. The error message was:
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]:
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: undefined method `ebs_mount' for #<Chef::Recipe:0xb7722380>
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]:
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: The error occurred line 56 of /opt/rightscale/sandbox/lib/ruby/gems/1.8/gems/chef-0.9.14.4/lib/chef/mixin/recipe_definition_dsl_core.rb in method 'method_missing' while executing:
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]:
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: 54           rname = convert_to_class_name(method_name)
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: 55
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: **           super unless Chef::Resource.const_defined?(rname)
[2012-02-15 17:49:00 -0500] AntonZ: Feb 15 12:08:18 ip-10-0-0-10 RightLink[2132]: 57           raise ArgumentError, "You must supply a name when declaring a #{method_name} resource" unless args.size > 0
[2012-02-15 17:50:00 -0500] AntonZ: any ideas what's not right? i cna post my jason file
[2012-02-15 17:58:00 -0500] miah: you are calling ebs_mount from your cookbook but not giving it an argument
[2012-02-15 18:04:00 -0500] AntonZ: how do i give it an argument? i was actually following this guide, i modified it to my requirements though: http://blog.ibd.com/scalable-deployment/using-the-opscode-aws-cookbook-to-attach-an-ec2-ebs-volume/
[2012-02-15 18:04:00 -0500] AntonZ: when you say im calling ebs_mount from my cookbook, do you mean i call it from my .jason file?
[2012-02-15 18:06:00 -0500] mattdawson: i'm using vagrant to bootstrap some chef client boxes. i have ruby in my run list, and i can watch libshadow-ruby1.8 being installed.
[2012-02-15 18:07:00 -0500] mattdawson: but when one of my cookbooks tries to install users, i get a message that the ruby-shadow gem isn't installed.
[2012-02-15 18:07:00 -0500] mattdawson: has anyone seen something like this before?
[2012-02-15 18:09:00 -0500] jbz: mattdawson:  If you install a gem during a chef-client run, in order for it to be available for use later in the same run you have to do Magic
[2012-02-15 18:10:00 -0500] jbz: As per jtimberman (I think) here it is:  https://gist.github.com/42334a26f71212df055c
[2012-02-15 18:18:00 -0500] mattdawson: jbz: sohmmhow come i've never run into this outside of vagrant.
[2012-02-15 18:18:00 -0500] mattdawson: ohhhh
[2012-02-15 18:18:00 -0500] mattdawson: wait. it's because in vagrant i'm not doing a bootstrap.
[2012-02-15 18:18:00 -0500] jbz: yep that would do it
[2012-02-15 18:19:00 -0500] jbz: ruby-shadow likely gets pulled in during a bootstrap install
[2012-02-15 18:20:00 -0500] mattdawson: hmm.
[2012-02-15 18:21:00 -0500] mattdawson: so i wonder what my best bet is. i'd rather not go through the magic of trying to refresh the gem paths.
[2012-02-15 18:28:00 -0500] jbz: In that case, I dunno what to tell you.  Why not?  If you set it up as per 'version 2', it'll only do that if the gem package install fires.
[2012-02-15 18:38:00 -0500] spheromak: good
[2012-02-15 18:38:00 -0500] spheromak: mt
[2012-02-15 18:42:00 -0500] spheromak: sup miah
[2012-02-15 18:42:00 -0500] miah: worky worky
[2012-02-15 18:42:00 -0500] spheromak: indeed
[2012-02-15 18:44:00 -0500] AntonZ: miah: what does this porition of the code do? aws_ebs_volume "mysql_data_volume" do
[2012-02-15 18:44:00 -0500] AntonZ:   provider "aws_ebs_volume" - is that where it expects an argument ?
[2012-02-15 18:44:00 -0500] AntonZ: or rather mysql_data_volume should have a value defined somewhere ?
[2012-02-15 18:45:00 -0500] spheromak: aws_ebs_volume is the lwrp
[2012-02-15 18:45:00 -0500] spheromak: for volumes
[2012-02-15 18:45:00 -0500] spheromak: mysql_data_volume is the resource name. i.e. what you are gonna name this volume in yer recipe
[2012-02-15 18:48:00 -0500] AntonZ: do i have to have lwrp cookbook initizilized prior to calling my cookbook to mount the volume ?
[2012-02-15 18:50:00 -0500] AntonZ: ah okay, that was invalid question :)
[2012-02-15 18:51:00 -0500] spheromak: yea call out the lwrp cook in your cookbooks metadata and all should be resolved
[2012-02-15 18:51:00 -0500] spheromak: via depends in metadata
[2012-02-15 18:52:00 -0500] AntonZ: looking for that cookbook now
[2012-02-15 18:52:00 -0500] spheromak: should be the aws cook
[2012-02-15 18:52:00 -0500] AntonZ: got it, thank you
[2012-02-15 18:52:00 -0500] spheromak: https://github.com/opscode/cookbooks/tree/master/aws
[2012-02-15 18:53:00 -0500] spheromak: documentation there on the ebs_volume  provider
[2012-02-15 18:53:00 -0500] spheromak: https://github.com/ripienaar/gdash
[2012-02-15 18:53:00 -0500] spheromak: ack
[2012-02-15 19:00:00 -0500] spheromak: but its teh tasty kind
[2012-02-15 19:24:00 -0500] mikeg: knife bootstrap has -r to pass a run_list.  Does anyone know if I can also pass attributes with it?
[2012-02-15 19:34:00 -0500] edelschaedel_: is knife broken when trying to print out an environment in pp format?
[2012-02-15 19:34:00 -0500] edelschaedel_: this doesn't work for me.    knife environment show test -Fpp
[2012-02-15 19:34:00 -0500] edelschaedel_: but knife environment show test -Fj does
[2012-02-15 19:36:00 -0500] ssd7_: edelschaedel_: Just confirmed that is is broken for me too.  Mind filing a bug at tickets.opscode.com if it doesn't already exist?
[2012-02-15 19:36:00 -0500] edelschaedel_: sure thing
[2012-02-15 19:37:00 -0500] edelschaedel_: any workaround?
[2012-02-15 19:43:00 -0500] ssd7: edelschaedel_: Unfortunately not one I can easily see.  Other than using another output format
[2012-02-15 19:46:00 -0500] jtimberman: btw, we have a release candidate for the next version of ohai, install with gem install --pre ohai
[2012-02-15 19:46:00 -0500] jtimberman: :)
[2012-02-15 19:46:00 -0500] jtimberman: kallistec said you should deploy it in anger
[2012-02-15 19:47:00 -0500] kallistec: OR WITH JOY
[2012-02-15 19:50:00 -0500] jaimef: so I am saving ohai.all_plugins to json to track changes on a server over time. IS there a recommended way to compare json data structures to find differences? would yaml work better?
[2012-02-15 20:03:00 -0500] rrichardsr3: howdy - if you are using chef-deploy i assume that stays with the check-repo and not in the application codebase? (like capistrano)
[2012-02-15 20:26:00 -0500] dyer: Hey guys, question.. If I use remote file and dont give it a URL where does that file actually download?  remote "http://awesome.com/file.tar" vs remote "file.tar"  ?
[2012-02-15 20:36:00 -0500] ssd7: dyer: For compatability reasons I believe it will grab the file with that name from the files/ directory in your cookbook
[2012-02-15 20:36:00 -0500] ssd7: files/default files/ubuntu-10.10 etc
[2012-02-15 20:42:00 -0500] flu-: did the AWS tagging support patch ever get pulled in by opscode?
[2012-02-15 20:43:00 -0500] flu-: i.e., let's you name instances when you create them, rather than everyone rolling their own solution (since Fog has supported it for a long time now)
[2012-02-15 20:44:00 -0500] Otterley: does Chef ever use the Upstart provider by default under any circumstance?
[2012-02-15 20:49:00 -0500] Brad_K: dyer: depends on your settings for #{Chef::Config[:file_cache_path]}, which depends on your OS and what you may have set in your knife.rb or client.rb, etc.  By default, I think that will probably go somewhere like /var/cache/chef/.
[2012-02-15 20:50:00 -0500] btm: flu-: we got a good contribution recently, I think we reviewed it last week (see the ticket triage email to chef-dev mailing list)  and I updated the ticket earlier today http://tickets.opscode.com/browse/KNIFE_EC2-18 - I expect we will merge it within a couple weeks. We're doing an Ohai release right now.
[2012-02-15 20:50:00 -0500] flu-: btm: excellent :)
[2012-02-15 20:50:00 -0500] btm: Otterley: No, but Ubuntu is getting close.
[2012-02-15 20:50:00 -0500] Otterley: please, for the love of god, don't btm
[2012-02-15 20:50:00 -0500] ssd7: Brad_K: *facepalm* thatnks for the assist seems I got the wrong preposition when reading backscroll
[2012-02-15 20:51:00 -0500] Brad_K: flu-: i'm confused  how is this different from "knife ec2 node create  -S name -N name"?
[2012-02-15 20:51:00 -0500] Brad_K: ssd7: np.  ;-)
[2012-02-15 20:51:00 -0500] flu-: Brad_K: AWS uses a specific tag to associate a name in their web interface
[2012-02-15 20:52:00 -0500] flu-: so you have to set that tag in order to avoid nameless nodes in the aws web console
[2012-02-15 20:52:00 -0500] btm: Otterley: I think if you want to prevent that from happening you need to convince Ubuntu to not make it their init replacement.
[2012-02-15 20:52:00 -0500] btm: Otterley: Which is the only reason it would become the default provider in Chef.
[2012-02-15 20:52:00 -0500] Otterley: gah
[2012-02-15 20:52:00 -0500] LawrenceSeattle: I booted an ec2 and it looks like chef-client depends on runit.. which wasnt by default in my 10.04 image (doing the cluster_client demo)
[2012-02-15 20:52:00 -0500] Otterley: Ubuntu is totally clueless when it comes to these matters :(
[2012-02-15 20:53:00 -0500] Otterley: but yeah, I realize that Chef has to play the hand it's dealt
[2012-02-15 20:53:00 -0500] Brad_K: flu-: so, the current version of the ec2 plugin doesn't do that for you when you use -S and -N?
[2012-02-15 20:53:00 -0500] xdg: jtimberman, looking at CHEF-154, I think use of "execute" in actions means they won't run under notifications.  Should those be direct system calls instead?
[2012-02-15 20:53:00 -0500] xdg: jtimberman, (that's for the runit_service LWRP, btw)
[2012-02-15 20:53:00 -0500] Otterley: I know RHEL 6 uses Upstart too :(
[2012-02-15 20:53:00 -0500] Brad_K: oh, crap.  :(
[2012-02-15 20:54:00 -0500] flu-: Brad_K: Haven't used it since September, so I don't recall specifically :/
[2012-02-15 20:54:00 -0500] LawrenceSeattle: shouldn't chef-client know it needs runit and install that by default?
[2012-02-15 20:54:00 -0500] Brad_K: flu-: we're on rackspace, and i've never dealt with ec2 before.  but i do try to keep up on ec2, in case we might need to make a switch.
[2012-02-15 20:55:00 -0500] Brad_K: LawrenceSeattle: there are so many startup options for different platforms that it can be impossible to tell what should be used.
[2012-02-15 20:55:00 -0500] Otterley: LawrenceSeattle: are you installing chef-client via a package?  It should take care of the dependencies for you.  if not, that's a bug
[2012-02-15 20:55:00 -0500] flu-: Brad_K: Yeah, so I think the difference is ec2's 'unique' way of naming their nodes through their proprietary tagging system
[2012-02-15 20:56:00 -0500] Otterley: if you're installing from source, the pieces are yours to assemble
[2012-02-15 20:56:00 -0500] LawrenceSeattle: I dunno... just using the cluster_chef demo
[2012-02-15 20:56:00 -0500] flu-: it's not the hostname of anything, just arbitrary key-value data that you can associate with an ec2 instance
[2012-02-15 20:56:00 -0500] LawrenceSeattle: seems like they are just using role[chef-client]
[2012-02-15 20:56:00 -0500] jbz: flu-: Are you talking about the instance ID?
[2012-02-15 20:56:00 -0500] LawrenceSeattle: so that should bring in packages right?
[2012-02-15 20:57:00 -0500] flu-: jbz: Nope, not that either. The instance ID isn't settable
[2012-02-15 20:57:00 -0500] Brad_K: LawrenceSeattle: depends on how the role is set and which other roles and recipes it specifies.
[2012-02-15 20:57:00 -0500] flu-: jbz: that's the i-29843 type string
[2012-02-15 20:57:00 -0500] jbz: Yeah.  Oh, you mean tags.  Sorry, my bad.
[2012-02-15 21:00:00 -0500] geekbri: When knife launches an instance, does it automatically attach the ephemeral drives ?
[2012-02-15 21:00:00 -0500] LawrenceSeattle: Brad_K: odd.. the chef_client role doesn't specify any recipies...  I wonder how this works.   https://github.com/infochimps-labs/cluster_chef/blob/master/roles/chef_client.rb
[2012-02-15 21:01:00 -0500] btm: Otterley: Why Upstart sometimes doesn't make sense, from its primary developer: https://bugs.launchpad.net/upstart/+bug/94065/comments/27
[2012-02-15 21:02:00 -0500] Otterley: btm: not sure of the relevance of that comment...
[2012-02-15 21:03:00 -0500] Otterley: upstart solves a problem I didn't have, and replaced it with 99 new problems.
[2012-02-15 21:03:00 -0500] btm: Otterley: It is being developed from the perspective of the desktop. That thread is about adding a way to make upstart not start a service without removing the upstart config entirely, which the developer was reluctant to add.
[2012-02-15 21:04:00 -0500] dyer: Brad_K, thanks
[2012-02-15 21:04:00 -0500] Otterley: the Canonical folks are apparently still deluding themselves that Linux will ever be viable on the desktop, but I digress
[2012-02-15 21:04:00 -0500] flu-: lol
[2012-02-15 21:04:00 -0500] flu-: Otterley: are you using viable to mean popular? I rock fluxbox on debian or *bsd exclusively when possible
[2012-02-15 21:05:00 -0500] flu-: totally viable, never popular
[2012-02-15 21:05:00 -0500] Otterley: the real problem is that Upstart is way too naive, especially when it comes to reloads.  with traditional init scripts I could condition reload on a config file test; upstart just blindly HUPs the daemon on reload
[2012-02-15 21:06:00 -0500] Otterley: I can't wait till people start locking themselves out of their boxes because they put a typo in their sshd_config file and then did a reload via Chef
[2012-02-15 21:06:00 -0500] yatesy: that's not an upstart issue tho
[2012-02-15 21:07:00 -0500] Otterley: o rly?
[2012-02-15 21:07:00 -0500] atomic-penguin: /etc/init.d/foo status
[2012-02-15 21:07:00 -0500] atomic-penguin: foo: is an upstart job, you have to say service foo status, because I'm retarded
[2012-02-15 21:08:00 -0500] atomic-penguin: pretty sure that is the actual error message
[2012-02-15 21:08:00 -0500] Otterley: hahaha
[2012-02-15 21:08:00 -0500] flu-: for the record, I love the sys V init system. Tried and true, well documented, and transparent
[2012-02-15 21:09:00 -0500] flu-: upstart... well, it has a fitting name
[2012-02-15 21:09:00 -0500] Otterley: I have 99 problems, but SysV init wasn't one of them
[2012-02-15 21:09:00 -0500] Otterley: it's the standard open-sores software problem - nobody wants to work on the hard problems, they just want to redo the stuff that already works, and replace it with a less-working version
[2012-02-15 21:10:00 -0500] yatesy: that's a pretty wide sweeping statement
[2012-02-15 21:10:00 -0500] geekbri: Is there no way to have knife attach ephemeral drives to an instance when it creates it ?
[2012-02-15 21:11:00 -0500] Otterley: yatesy: influenced by 15 years in the industr
[2012-02-15 21:11:00 -0500] Otterley: +y
[2012-02-15 21:11:00 -0500] mattray: geekbri: make that part of the bootstrap?
[2012-02-15 21:11:00 -0500] Otterley: Linux still has no unified graphics model, even though Windows and Mac have had them since the '80s
[2012-02-15 21:12:00 -0500] geekbri: mattray: it needs to be done before user data scripts run.  Normally it is something I do with ec2-run-instances
[2012-02-15 21:12:00 -0500] jaimef: anyway to force an Ohai::system object into hash?
[2012-02-15 21:13:00 -0500] mattray: geekbri: put it in the first-boot.json?
[2012-02-15 21:13:00 -0500] mattray: geekbri: so it gets run before you do anything else with the nodes
[2012-02-15 21:14:00 -0500] geekbri: mattray: attaching ephemeral drives needs to be a command that is passed in when the nodes are launching it isn't something that is run after the node is up
[2012-02-15 21:14:00 -0500] mattray: ahh.
[2012-02-15 21:15:00 -0500] mattray: seems there must be something, perhaps an extension to knife-ec2?
[2012-02-15 21:15:00 -0500] mattray: since Fog supports it
[2012-02-15 21:16:00 -0500] geekbri: mattray: ill look into that... since fog supports it, hopefully it gets into knife :)
[2012-02-15 21:17:00 -0500] mattray: geekbri: check http://tickets.opscode.com/browse/KNIFE_EC2
[2012-02-15 21:17:00 -0500] mattray: and feel free to open a ticket to add it if it isn't there
[2012-02-15 21:17:00 -0500] jtimberman: xdg: you may be thinking of definitions, no?
[2012-02-15 21:17:00 -0500] hcastro: geekbri: http://tickets.opscode.com/browse/KNIFE_EC2-28
[2012-02-15 21:18:00 -0500] geekbri: mattray: http://tickets.opscode.com/browse/KNIFE_EC2-28
[2012-02-15 21:18:00 -0500] geekbri: oh beat me to it :)
[2012-02-15 21:19:00 -0500] hcastro: dialog in the pull requests claim that it can be done via user-data, but i'm not sure
[2012-02-15 21:20:00 -0500] geekbri: I don't think that is true.... as user data is run after a node is launched and to map ephemerals you have to specify block device mappings
[2012-02-15 21:21:00 -0500] jtimberman: (runit|daemontools) > upstart
[2012-02-15 21:21:00 -0500] jtimberman: and largely solve the problem that upstart tries to solve
[2012-02-15 21:22:00 -0500] Otterley: does runit manage service dependencies?  that's largely upstart's value AFAICT
[2012-02-15 21:25:00 -0500] xdg: jtimberman, no.  the CHEF-154 branch has "execute ..." lines in the actions.  those don't run as notifications
[2012-02-15 21:25:00 -0500] atomic-penguin: (anything) > (upstart|BSD style init)
[2012-02-15 21:26:00 -0500] xdg: jtimberman, see https://gist.github.com/1839091
[2012-02-15 21:26:00 -0500] xdg: jtimberman, first example is your code; second is my modified version; only the second one works because it executes immediately with run_action
[2012-02-15 21:26:00 -0500] senthilr: there is also https://github.com/ytoolshed/upkeeper
[2012-02-15 21:26:00 -0500] xdg: or, maybe replace those "execute" resources with direct invocation of the commands
[2012-02-15 21:27:00 -0500] AntonZ: Hello, guys, im getting this error message while executing my ebs_mount cookbook, any hints on what's wrong?
[2012-02-15 21:27:00 -0500] AntonZ: *ERROR> An error occurred during the execution of Chef. The error message was:
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]:
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: undefined method `ebs_mount' for #<Chef::Recipe:0xb774d378>
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]:
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: The error occurred line 56 of /opt/rightscale/sandbox/lib/ruby/gems/1.8/gems/chef-0.9.14.4/lib/chef/mixin/recipe_definition_dsl_core.rb in method 'method_missing' while executing:
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]:
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: 54           rname = convert_to_class_name(method_name)
[2012-02-15 21:27:00 -0500] xdg: jtimberman, note -- this is specific to notifications.  If the actions are specified in the recipe directly, they work.  If they are triggered as notifications, they don't
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: 55
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: **           super unless Chef::Resource.const_defined?(rname)
[2012-02-15 21:27:00 -0500] AntonZ: Feb 15 15:02:18 ip-10-0-0-10 RightLink[2265]: 57           raise ArgumentError, "You must supply a name when declaring a #{method_name} resource" unless args.size > 0
[2012-02-15 21:27:00 -0500] Otterley: AntonZ: use gist, srsly
[2012-02-15 21:27:00 -0500] Otterley: don't paste in here please
[2012-02-15 21:28:00 -0500] AntonZ: sorry
[2012-02-15 21:28:00 -0500] hoover_damm: AntonZ, is the lwrp in your runlist?
[2012-02-15 21:28:00 -0500] hoover_damm: sounds like the the cookbook with ebs_mount wasn't loaded
[2012-02-15 21:28:00 -0500] sivy: hey folks: any ideas on why a simple role with a single recipe[apt] would fail? https://gist.github.com/0c10e1c20e802f6d0210
[2012-02-15 21:29:00 -0500] sivy: error is a 412 "Run list contains invalid items: no such cookbook apt."
[2012-02-15 21:29:00 -0500] AntonZ: yes it is, lwrp ran first as dependency
[2012-02-15 21:29:00 -0500] hoover_damm: sivy, stack trace is required
[2012-02-15 21:29:00 -0500] hoover_damm: sivy, you have everything except the actual stack trace
[2012-02-15 21:29:00 -0500] jdeamattson: What is the recommended way for setting environment variables for a Linux host?
[2012-02-15 21:30:00 -0500] Otterley: jdeamattson: environment variables are scoped to a process and its children, not a "host"
[2012-02-15 21:30:00 -0500] sivy: hoover_damm:  https://gist.github.com/f0b109035fa4a83a9831
[2012-02-15 21:30:00 -0500] jdeamattson: I should have said,
[2012-02-15 21:30:00 -0500] AntonZ: ah hmm, loking ruther chance it didnt run
[2012-02-15 21:30:00 -0500] jdeamattson: on a Linux host.
[2012-02-15 21:30:00 -0500] hoover_damm: sivy, that looks like a problem with just regular rest calls
[2012-02-15 21:30:00 -0500] hoover_damm: sivy, not even the recipe
[2012-02-15 21:31:00 -0500] Otterley: jdeamattson: see above
[2012-02-15 21:31:00 -0500] hoover_damm: HTTP Request Returned 412 Precondition Failed: {"non_existent_cookbooks":["apt"],"cookbooks_with_no_versions":[],"message":"Run list contains invalid items: no such cookbook apt."}
[2012-02-15 21:31:00 -0500] hoover_damm: sivy, anywho that's the actual reason why that failed
[2012-02-15 21:31:00 -0500] hoover_damm: stack traces are neat
[2012-02-15 21:32:00 -0500] sivy: yeah, i get that it's a REST error, from the platform servers
[2012-02-15 21:32:00 -0500] sivy: I'm trying to figure out why it's saying that the cookbook doesn't exist.
[2012-02-15 21:32:00 -0500] sivy: the cookbook is just the community apt cokbook, and it's in my repo
[2012-02-15 21:32:00 -0500] hoover_damm: you dind't upload it
[2012-02-15 21:33:00 -0500] sivy: hoover_damm: 20 seconds ago i'd have sworn up and down that i did.
[2012-02-15 21:33:00 -0500] sivy: but apprently, i dint
[2012-02-15 21:33:00 -0500] sivy: (looking on manage.opscode.com now)
[2012-02-15 21:33:00 -0500] sivy: d'oh
[2012-02-15 21:34:00 -0500] jdeamattson: Otterley: The situation is that I need to define a path to be used by a given process. This would be defined in .bashrc if handled manually. Should I just create the appropriate .bashrc?
[2012-02-15 21:34:00 -0500] Otterley: jdeamattson: put it in the process's start script
[2012-02-15 21:34:00 -0500] xdg: jtimberman, do you want a patch that changes it all to run_command_with_systems_locale(...)
[2012-02-15 21:34:00 -0500] Otterley: e.g. init script or whatever, depending on how the process is managed...
[2012-02-15 21:35:00 -0500] Otterley: daemons are rarely descendants of shells, so putting it in a bash config is rarely the right thing to do
[2012-02-15 21:35:00 -0500] jdeamattson: Ok, that makes sense. WOuld be nice if there was a way to define ENV variables when starting a process via Chef.
[2012-02-15 21:35:00 -0500] hoover_damm: why not use god? or bluepill?
[2012-02-15 21:36:00 -0500] hoover_damm: set the environment variables in god as the command starts
[2012-02-15 21:36:00 -0500] Otterley: many daemon start scripts toss out the environment for security reasons
[2012-02-15 21:36:00 -0500] aslan: is opscode still maintaining mixlib-cli?
[2012-02-15 21:36:00 -0500] hoover_damm: env variables are a pita, and trying to get them right is hard
[2012-02-15 21:36:00 -0500] hoover_damm: tossing them in god and having god control the process
[2012-02-15 21:36:00 -0500] aslan: it seems to be very buggy
[2012-02-15 21:36:00 -0500] hoover_damm: is easier then trying to modify the init.d to add your environment variables
[2012-02-15 21:36:00 -0500] hoover_damm: and then restart the process
[2012-02-15 21:37:00 -0500] Otterley: same difference hoover_damm
[2012-02-15 21:37:00 -0500] hoover_damm: which is ugly and not easy to change, modify a god file
[2012-02-15 21:37:00 -0500] hoover_damm: and win
[2012-02-15 21:37:00 -0500] hoover_damm: Otterley, control it with god... and if you do it right  you shouldn't loose it
[2012-02-15 21:37:00 -0500] hoover_damm: Otterley, monit can diaf because I don't wanna hear about it's spartan ass no more
[2012-02-15 21:37:00 -0500] Otterley: I've never used god; it doesn't solve a problem I have
[2012-02-15 21:37:00 -0500] hoover_damm: then likely your solving all your problems
[2012-02-15 21:38:00 -0500] hoover_damm: using god or bluepill or monit or runit :) 
[2012-02-15 21:38:00 -0500] Otterley: also, the author is an idiot for calling it god because apparently he didn't want it to be found ;)
[2012-02-15 21:38:00 -0500] hoover_damm: tuning a environment variable in a runit job is :) easy
[2012-02-15 21:38:00 -0500] hoover_damm: if you wanna go ot about how monitoring sucks.. please /j ##monitoringsucks
[2012-02-15 21:44:00 -0500] jtimberman: xdg: can you drop off more information in a comment on that ticket please?
[2012-02-15 21:44:00 -0500] aslan: is opscode still maintaining mixlib-cli gem?
[2012-02-15 21:44:00 -0500] jtimberman: aslan: yes
[2012-02-15 21:44:00 -0500] aslan: jtimberman: looks like the conditions sometimes dont work
[2012-02-15 21:44:00 -0500] aslan: i had :require set to true and it kept giving me the message that you didn't provide the option
[2012-02-15 21:44:00 -0500] xdg: jtimberman, will do
[2012-02-15 21:45:00 -0500] aslan: but when i took it out and i was still passing the option it worked fine
[2012-02-15 21:45:00 -0500] aslan: jtimberman: :boolean also seems to be buggy
[2012-02-15 21:45:00 -0500] jtimberman: open tickets against it in the CHEF project.
[2012-02-15 21:45:00 -0500] jtimberman: xdg: thanks!
[2012-02-15 21:45:00 -0500] jtimberman: xdg: I hope to get back to hacking on that soon
[2012-02-15 21:45:00 -0500] aslan: jtimberman: ok :)
[2012-02-15 21:45:00 -0500] jtimberman: xdg: and it would be Chef::Mixin::ShellOut
[2012-02-15 21:46:00 -0500] jtimberman: but execute is using that. i'll investigate tho
[2012-02-15 21:46:00 -0500] xdg: jtimberman, it's a timing issue.  "execute" is a resource that runs during converge. It's not a shell call that runs synchronously, which it needs to during notification.
[2012-02-15 21:48:00 -0500] jtimberman: xdg: sure. There's also compile-phase execute.
[2012-02-15 21:48:00 -0500] jtimberman: execute("foo") { action :nothing }.run_action(:run)
[2012-02-15 21:49:00 -0500] xdg: yes, but notifications are *last* and thus "execute" doesn't have it's :run called unless you do it manually (as I did)
[2012-02-15 21:49:00 -0500] xdg: It's just like compile-phase execution.
[2012-02-15 21:49:00 -0500] xdg: But it needs to be done like that for notification-phase execution.
[2012-02-15 21:49:00 -0500] xdg: In short -- I think the idea of "execute" as a resource is a flawed concept, but oh, well, we can work around it.  :-)
[2012-02-15 21:55:00 -0500] xdg: http://tickets.opscode.com/browse/CHEF-154?focusedCommentId=21998&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-21998
[2012-02-15 21:55:00 -0500] geekbri: Strange.  I'm getting a INFO: HTTP Request Returned 403 Forbidden: Merb::ControllerExceptions::Forbidden when I try to launch an instance with knife.  Any idea what could be causing something like that? (hosted chef)
[2012-02-15 21:58:00 -0500] aslan: jtimberman: do i have to make an account to post a ticket?
[2012-02-15 21:58:00 -0500] geekbri: Nevermind I solved it.  It seems that when i did a knife node delete it didn't destroy the old client API key.  I delete it manually
[2012-02-15 22:03:00 -0500] jtimberman: aslan: yes
[2012-02-15 22:04:00 -0500] jtimberman: geekbri: yeah, the theory is you could use a single api client to manage multiple nodes, though the chef-client program doesn't do that.
[2012-02-15 22:05:00 -0500] geekbri: jtimberman: ah i see.
[2012-02-15 22:08:00 -0500] jtimberman: and when you delete the node and recreate it when running chef-client, the new api client doesn't have permissions on the node
[2012-02-15 22:22:00 -0500] RoboTeddy: is it possible for a recipe to use a template from a different cookbook? (or am I doing it wrong?)
[2012-02-15 22:23:00 -0500] cwj: RoboTeddy: yes, provide the 'cookbook "foo"' parameter in the template resource definition
[2012-02-15 22:24:00 -0500] RoboTeddy: cwj: thank you
[2012-02-15 22:25:00 -0500] cwj: np
[2012-02-15 22:38:00 -0500] AntonZ: Hello, im installing aws cookbook for lwrp, does anyone know how to confirm if the book was installed sucessfully?
[2012-02-15 22:39:00 -0500] AntonZ: the reason im asking is even though i think it installed fine, i still get this erro message: git://gist.github.com/1839310.git
[2012-02-15 22:40:00 -0500] jbz: AntonZ: You probably want to check that URL, it's not http-readable
[2012-02-15 22:42:00 -0500] AntonZ: https://gist.github.com/1839310
[2012-02-15 22:42:00 -0500] AntonZ: hope this one works :)
[2012-02-15 22:49:00 -0500] jbz: That looks like the aws cookbook is installed or it would have pitched an error about a missing cookbook
[2012-02-15 22:51:00 -0500] AntonZ: roger that, thanks jbz, so if aws is installed, why do i get that error then, someone mentioned that it was due to abcense of aws
[2012-02-15 22:51:00 -0500] jbz: Is one of your recipes calling  ebs_mount?
[2012-02-15 22:51:00 -0500] jbz: Are you perhaps calling the ebs_mount recipe as a function and not with "include"?
[2012-02-15 22:52:00 -0500] AntonZ: honestly i woulndt know, would it be in metadata.jason or in the actual recipe ?
[2012-02-15 22:53:00 -0500] jbz: It would be in the actual recipe.  Did you write any of these?
[2012-02-15 22:53:00 -0500] AntonZ: i used one fo the guides i found online and modified to my needs http://blog.ibd.com/scalable-deployment/using-the-opscode-aws-cookbook-to-attach-an-ec2-ebs-volume/
[2012-02-15 22:53:00 -0500] AntonZ: here is my recipe
[2012-02-15 22:53:00 -0500] dasickis: hey
[2012-02-15 22:54:00 -0500] AntonZ: https://gist.github.com/1839310
[2012-02-15 22:54:00 -0500] dasickis: I keep getting this error: "HTTP Request Returned 500 Internal Server Error: Connection refused" and googling hasn't proved fruitful in fixing the error
[2012-02-15 22:54:00 -0500] AntonZ: or just refresh same gist
[2012-02-15 22:54:00 -0500] dasickis: i'll post the debug dump
[2012-02-15 22:55:00 -0500] RoboTeddy: chef-solo is treating one of my template resources as if its action were set to "create_if_missing" instead of the default "create". the owner/group/mode attributes on the template resource are set to root/root/0644 respectively; anyone know what could be going on?
[2012-02-15 22:55:00 -0500] jbz: AntonZ:  Is ebs_mount the name of the provider in the AWS cookbook?
[2012-02-15 22:56:00 -0500] AntonZ: oh, i see how it is, most likely not, let me see, not sure where it would be though
[2012-02-15 22:56:00 -0500] AntonZ: i eman what file
[2012-02-15 22:57:00 -0500] jbz: it's called 'ebs_volume'
[2012-02-15 22:57:00 -0500] jbz: https://github.com/opscode/cookbooks/tree/master/aws/providers
[2012-02-15 22:57:00 -0500] AntonZ: no, i gave it that name
[2012-02-15 22:57:00 -0500] AntonZ: so i have to go to the aws cookbook and modify provider name
[2012-02-15 22:58:00 -0500] jbz: NO, don't do that.
[2012-02-15 22:58:00 -0500] AntonZ: okay
[2012-02-15 22:58:00 -0500] jbz: Providers are meant to be used as is.  If you touch them, you have to make sure all their internal structure understands that.
[2012-02-15 22:58:00 -0500] jbz: Instead, call them as they were meant to be called.
[2012-02-15 22:58:00 -0500] AntonZ: roger that, let me see what it was called originally
[2012-02-15 22:59:00 -0500] jbz: I recommend re-downloading the AWS cookbook.  The link I posted shows the current version of the cookbook has a lwrp named 'ebs_volume' which I think is what you're looking for.
[2012-02-15 22:59:00 -0500] AntonZ: oh hmm
[2012-02-15 22:59:00 -0500] AntonZ: yes, i see it now
[2012-02-15 22:59:00 -0500] AntonZ: so my provider mataches aws cookbook's provider
[2012-02-15 23:00:00 -0500] AntonZ: i have the latest aws
[2012-02-15 23:02:00 -0500] AntonZ: so if it matches, then it's not the issue, it's something else ?
[2012-02-15 23:03:00 -0500] jbz: It doesn't match. :-)  I'm looking at the AWS cookbook now, and what you pasted doesn't call an existing provider.  Fix the provider call first.
[2012-02-15 23:04:00 -0500] AntonZ: so aws provider is ebs_volume.rb - right ?
[2012-02-15 23:04:00 -0500] jbz: Yes.
[2012-02-15 23:04:00 -0500] AntonZ: oh and i have ebs_mount - duh
[2012-02-15 23:04:00 -0500] jbz: Yep.
[2012-02-15 23:05:00 -0500] AntonZ: trying! will let you know in a few mins :) - thank you
[2012-02-15 23:05:00 -0500] jbz: Cool!  g'luck.
[2012-02-15 23:05:00 -0500] dasickis: https://raw.github.com/gist/1839882/e0d786c2086e938f2f672b4abdd790411490c894/gistfile1.txt
[2012-02-15 23:06:00 -0500] dasickis: i keep getting a 500 server error that I've been unable to resolve
[2012-02-15 23:06:00 -0500] dasickis: i've tried to google it but unsure what's going on
[2012-02-15 23:09:00 -0500] jbz: dasickis: Are you reusing a node name? It's possible your node has permission to download cookbooks but not to write the node state because it's using an incorrect pem
[2012-02-15 23:09:00 -0500] jbz: dasickis: To check this, go to the server and delete the node entirelyit should just re-register next time chef runs.  If it works then, then bob's yer uncle.
[2012-02-15 23:09:00 -0500] dasickis: no but i just came across something indicating something about rabbitmq
[2012-02-15 23:10:00 -0500] dasickis: so i'm restarting rabbit to see if that's the issue
[2012-02-15 23:10:00 -0500] AntonZ: interesntgly, this guide says i have to append cookbook name to the resource and provider names: The first line starts with the resource name. I wanted to use the ebs_volume resource. I originally thought it would be just ebs_volume. It turns out that you have to specify the cookbook it is in by prepending the resource with the cookbook. I.E. aws_ebs_volume.
[2012-02-15 23:10:00 -0500] jbz: hm, yeah, I just realized you'd be getting a 403 if that was the problem.
[2012-02-15 23:12:00 -0500] dasickis: hmm seems that was the issue
[2012-02-15 23:12:00 -0500] dasickis: ok but now it hangs at Report handlers complete
[2012-02-15 23:13:00 -0500] dasickis: does rabbit get restarted if we do /etc/init.d/chef-server restart?
[2012-02-15 23:14:00 -0500] jbz: That I don't know, I don't use the open-source server.
[2012-02-15 23:14:00 -0500] jbz: Wait, it prints 'Report handler's complete'?
[2012-02-15 23:14:00 -0500] dasickis: yeah
[2012-02-15 23:14:00 -0500] jbz: That means the run is finished. :-)
[2012-02-15 23:14:00 -0500] dasickis: and then just hangs there
[2012-02-15 23:14:00 -0500] dasickis: doesn't it return to the shell ?
[2012-02-15 23:14:00 -0500] jbz: If you're running it in daemon mode, it'll print that, wait the interval, and then run again.
[2012-02-15 23:14:00 -0500] dasickis: oh i see
[2012-02-15 23:15:00 -0500] dasickis: sorry for the silly questions just getting started and there's been tons of issues on both ends of vagrant and the server
[2012-02-15 23:16:00 -0500] jbz: nope nope no worry
[2012-02-15 23:18:00 -0500] laurent\: Does Dir.entries("/dir") also includes "." and ".." on windows ?
[2012-02-15 23:20:00 -0500] laurent\: looks like it ! :)
[2012-02-15 23:30:00 -0500] jason_b_: Hello all, I'm having a slight issue with my clients not being able to retrieve a file (a metadata.json file for a cookbook). Any ideas what might cause this to happen?
[2012-02-15 23:31:00 -0500] jason_b_: I tried deleting the cookbook and re-uploading it but with no luck.
[2012-02-15 23:31:00 -0500] jbz: jason_b_: metadata should be in a metadata.rb AFAIK
[2012-02-15 23:31:00 -0500] jbz: can you put it in JSON?  I live and learn. :-)
[2012-02-15 23:32:00 -0500] jason_b_: doesn't the json file get generated from the .rb file?
[2012-02-15 23:32:00 -0500] mlei: jason_b_: what is the error message?
[2012-02-15 23:33:00 -0500] jason_b_: Server returned error for http://chef:4000/cookbooks/ops/0.0.1/files/8e54b2a22ebc4b04ca9032801994b84, retrying 3/5 in 15s
[2012-02-15 23:34:00 -0500] mlei: what about in server.log
[2012-02-15 23:34:00 -0500] jason_b_: I looked up the checksum in couchdb and found for that file to be for a specific cookbook's metadata file.
[2012-02-15 23:34:00 -0500] LawrenceSeattle: anyone using cluster_chef?
[2012-02-15 23:35:00 -0500] LawrenceSeattle: really struggling with this thing.  Maybe it's just not well baked enough
[2012-02-15 23:35:00 -0500] jason_b_: I've got this error: worker (port 4000) ~ File with checksum 8e54b2a22ebc4b04ca9032801994b84 not found in the repository (this should not happen) - (Merb::ControllerExceptions::InternalServerError)
[2012-02-15 23:35:00 -0500] jason_b_: I was thinking perhaps it could be a communication issue between the chef server and couchdb?
[2012-02-15 23:36:00 -0500] mlei: don't think so unless you can't download anything
[2012-02-15 23:37:00 -0500] jason_b_: yea, I'm quite stumped on why this is happening.
[2012-02-15 23:40:00 -0500] jason_b_: anyone have any hints how i could debug this further?
[2012-02-15 23:42:00 -0500] mlei: could try deleting the cookbook with the --purge option
[2012-02-15 23:42:00 -0500] mlei: then reuploading it
[2012-02-15 23:42:00 -0500] mlei: any chance chef-server died while you were uploading at some point?
[2012-02-15 23:43:00 -0500] mlei: or you ran out of disk space?
[2012-02-15 23:44:00 -0500] jason_b_: disk space is good... chef server was running smoothly too... no errors or anything out of the ordinary in the logs from what i could see.
[2012-02-15 23:45:00 -0500] jason_b_: going to try and deleting the cookbook with purge option and re-upload it now.
[2012-02-15 23:49:00 -0500] jason_b_: huh, cool - that worked!
[2012-02-15 23:49:00 -0500] jason_b_: Thanks mlei!
[2012-02-15 23:50:00 -0500] jaimef: Ohai::System.data.diff() nice!
[2012-02-15 23:52:00 -0500] mlei: np jason_b_
