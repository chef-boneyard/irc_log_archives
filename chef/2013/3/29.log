[2013-03-29 00:05:20 -0400] lal00: what does it mean for a node to have a role?
[2013-03-29 00:05:29 -0400] lal00: i'm looking specifically at the munin cookbook which looks for a node that has de "monitoring" role.
[2013-03-29 00:05:49 -0400] lal00: s/de/the
[2013-03-29 00:06:03 -0400] maek: lal00: a role is something applied to a node or group of nodes
[2013-03-29 00:06:14 -0400] maek: that can contain a run_list of recipes or other nodes
[2013-03-29 00:06:18 -0400] maek: and node attributes
[2013-03-29 00:06:36 -0400] lal00: one of my nodes has a "roles" as a key in the attributes, the other doesn't
[2013-03-29 00:06:40 -0400] maek: so whats that saying is in the run_list of that node its looking to see role['monitoring']
[2013-03-29 00:06:59 -0400] lal00: well, I added that to the run list. It didn't make a difference.
[2013-03-29 00:07:06 -0400] maek: http://docs.opscode.com/essentials_roles.html
[2013-03-29 00:07:12 -0400] lal00: munin_servers = search(:node, "role:#{node['munin']['server_role']}")
[2013-03-29 00:07:15 -0400] lal00: thats the code
[2013-03-29 00:07:32 -0400] maek: yeah
[2013-03-29 00:07:47 -0400] maek: that confuses me
[2013-03-29 00:07:52 -0400] maek: ah
[2013-03-29 00:07:54 -0400] maek: so you set an attribute
[2013-03-29 00:08:06 -0400] maek: or it is set
[2013-03-29 00:08:18 -0400] maek: default['munin']['server_role']
[2013-03-29 00:08:27 -0400] maek: that contains the name of the role you have defined for server
[2013-03-29 00:08:31 -0400] maek: and that search will find it
[2013-03-29 00:08:34 -0400] maek: so
[2013-03-29 00:08:40 -0400] lal00: attributes/default.rb has -> default['munin']['server_role'] = 'monitoring'
[2013-03-29 00:08:47 -0400] maek: k
[2013-03-29 00:08:49 -0400] maek: so
[2013-03-29 00:08:59 -0400] maek: if you put a role['monitoring'] in a nodes run_list
[2013-03-29 00:09:04 -0400] maek: that search will pick it up
[2013-03-29 00:09:36 -0400] maek: munin_servers will be a search object that contains the node object of each node found from that search
[2013-03-29 00:11:46 -0400] lal00: you are correct. I could swear I had already done that.
[2013-03-29 00:11:55 -0400] lal00: I ran it again and it worekd
[2013-03-29 00:11:57 -0400] lal00: worked*
[2013-03-29 00:12:12 -0400] maek: may not have had the run_list saved to the server?
[2013-03-29 00:12:50 -0400] hatchetation: i may be going about this wrong -- but is there a way to import a deprecated cookbook's attributes into another recipe?
[2013-03-29 00:13:28 -0400] hatchetation: making a cookbook to remove some old recipe reminents from a system after that recipe is removed.
[2013-03-29 00:14:29 -0400] hatchetation: as I understand it, default node attributes aren't persisted, so i don't have access to them, eg node['foo']['basedir'] , once the foo cookbook is removed from the runlist
[2013-03-29 00:25:14 -0400] maek: hatchetation: you can do include_attributes
[2013-03-29 00:32:02 -0400] hatchetation: maek: thanks, that seems to be undocumented? a quick grep doesn't even turn it up in the source.
[2013-03-29 00:33:07 -0400] hatchetation: fwiw, I'm getting a NameError "Cannot find a resource for include_attributes on ubuntu version 12.04", tried including "cookbook::default" and "cookbook"
[2013-03-29 00:34:08 -0400] maek: hatchetation: https://github.com/search?l=Ruby&q=include_attribute&ref=searchresults&type=Code
[2013-03-29 00:34:11 -0400] maek: thats about all I know about it
[2013-03-29 00:34:26 -0400] maek: oh
[2013-03-29 00:34:27 -0400] maek: s
[2013-03-29 00:34:28 -0400] maek: sorry
[2013-03-29 00:34:32 -0400] maek: include_attribute
[2013-03-29 00:34:36 -0400] maek: my bad
[2013-03-29 00:35:05 -0400] maek: hatchetation: ^
[2013-03-29 00:36:07 -0400] jclark__: Anyone have any experience with openstack?  Maybe: Ubuntu/MAAS/juju.  I'd love to clean up our internal deployment.
[2013-03-29 00:43:15 -0400] hatchetation: maek: thanks for that. singular, and in the _attributes_ file (not recipe, doh!) and I'm good to go.
[2013-03-29 01:06:58 -0400] lal00: if I create a definition for a cookbook, can I use that definition in the default recipe?
[2013-03-29 01:07:16 -0400] lal00: or am I misunderstanding things?
[2013-03-29 01:49:53 -0400] miah: you should be able to. definitions are loaded before recipes.
[2013-03-29 02:09:42 -0400] chrisz: hi -- i'm getting an error when trying to upload a single role using `knife role from file roles/myrole.json`
[2013-03-29 02:10:07 -0400] chrisz: RROR: Server returned error for http://example.com:4000/roles/myrole
[2013-03-29 02:10:25 -0400] chrisz: all other roles work fine
[2013-03-29 02:10:41 -0400] Litex: Is there any hack day stuff the day before ChefConf this year? Or just workshops?
[2013-03-29 02:10:42 -0400] chrisz: i tried deleting the role in the webui
[2013-03-29 02:15:18 -0400] chrisz: ah it was due to a typo
[2013-03-29 02:15:33 -0400] chrisz: run list had an empty entry: ""
[2013-03-29 03:27:11 -0400] gchristensen: is there any guide to applying omnibus-ruby to other projects? I'm having a hard time following the readme while referencing the omnibus-chef repository.
[2013-03-29 06:23:21 -0400] gad0lin: hey, I want to make an exercise and download all latest cookbooks from opscode site (and check how they where compressed), I read that opscode site has chef server api, so should be heard, where to start?
[2013-03-29 06:25:07 -0400] sawanoboly: join #chef-haking
[2013-03-29 06:26:33 -0400] gad0lin: sawanoboly: thx, will give it a  try
[2013-03-29 06:28:17 -0400] sawanoboly: Solly, I typed wrong command...
[2013-03-29 06:52:04 -0400] wdpro_kevin: ohai chefs
[2013-03-29 06:56:51 -0400] wdpro_kevin: anyone have any idea why include? would be picking up the wrong thing here?   https://gist.github.com/crackmac/1f6919fb160ea3758e2d
[2013-03-29 07:08:15 -0400] gad0lin: wdpro_kevin: you are missing brackets
[2013-03-29 07:09:36 -0400] gad0lin: wdpro_kevin: (node[..].include? "jdk") ? ...
[2013-03-29 07:10:56 -0400] gad0lin: wdpro_kevin: also ? operator is to be use like that: RUNTIME = (node['wdpro_java']['jvm_dir'].include? "jdk") ? "jdk" : "jre"
[2013-03-29 07:23:36 -0400] wdpro_kevin: hmm let me try
[2013-03-29 07:27:34 -0400] gad0lin: wdpro_kevin: sure, you can quickly spot such issues with IRB
[2013-03-29 07:29:00 -0400] wdpro_kevin: awesome gad0lin I love replacing 10 lines with 2
[2013-03-29 07:29:19 -0400] gad0lin: is there nice ruby lib that I cook use to get lastest versions of cookbooks from opscode site (I want to parse/naviage over api http://cookbooks.opscode.com/api/v1/cookbooks/...
[2013-03-29 07:29:51 -0400] wdpro_kevin: I wasn't sure if it was my syntax (which it was) or my element and the warning wasn't enough for me to go on
[2013-03-29 08:05:50 -0400] chefnoob: hi
[2013-03-29 08:05:52 -0400] chefnoob: anyone here
[2013-03-29 08:06:04 -0400] chefnoob: anyone knows how to change chef server ip/port
[2013-03-29 08:09:55 -0400] chefnoob: i installed the  The full stack of chef-server   .. the chef-server 11.06 deb package .. .. and the config file is in /etc/chef-server/chef-server-running.json  .. but changing the ip to public ip there does not seem to work
[2013-03-29 09:01:11 -0400] gray--: hi all, i'd like to have a play with chef, i have 2 AWS micro instances, i'm looking for a guide that will help me turn one into a server and a client.  will add a node later
[2013-03-29 09:01:43 -0400] gray--: i don't know if i'm speaking out of turn, there seem to be very few, or no good beginners tutorials
[2013-03-29 09:02:12 -0400] gray--: i'm installing the server via the learnchef.opscode site, and suddenly it's asking me to sign up. do i really need to?
[2013-03-29 09:02:46 -0400] gray--: the next tutorial tells me half way through to now download the .msi.
[2013-03-29 09:02:50 -0400] gray--: 'grrr'
[2013-03-29 09:03:53 -0400] m4rcu5: quick question, are there plans to get chef-server 11 into the apt.opscode.com repo?
[2013-03-29 09:42:16 -0400] sileht: hi,
[2013-03-29 09:48:35 -0400] m4rcu5: hi'
[2013-03-29 09:50:33 -0400] chefnoob: hello
[2013-03-29 09:50:41 -0400] sileht: I have a issue with chef configuration, I follow this guide: http://wiki.opscode.com/display/chef/Installing+Chef+Server+on+Debian+or+Ubuntu+using+Packages, and I have this error:http://pastebin.com/hfKnFpy9
[2013-03-29 09:51:30 -0400] sileht: The chef version is 10.18.2-1 in the opscode repository
[2013-03-29 09:59:30 -0400] m4rcu5: those "push" client run features, will they also be implemented in the open source edition?
[2013-03-29 13:36:30 -0400] Litex: Greetings kitchen-mates.  Happy Friday.
[2013-03-29 14:28:25 -0400] kesor: every time I get back to the same question  how can I rewind something that was creating inside a providers/foobar.rb of another cookbook?  does anyone have the answer please?
[2013-03-29 14:46:04 -0400] kesor: any way to monkey patch LWRPs of other cookbooks?
[2013-03-29 15:04:27 -0400] geekbri: Anybody here at monitorama?
[2013-03-29 15:04:36 -0400] geekbri: and doing any interesting chef related hacking?
[2013-03-29 15:06:10 -0400] glennpratt: anyone given any thought on how to map the chef data model to multi-tenent hosting... I feel like environments would be useful, but I might have one node serving multiple "environments"
[2013-03-29 15:06:42 -0400] blueben: chef server per tenant
[2013-03-29 15:07:11 -0400] glennpratt: but one node may host multiple tenants
[2013-03-29 15:08:07 -0400] dillyjay: glennpratt: i'm brand new at chef, but what i'm doing is just handling each tenant through resources
[2013-03-29 15:08:14 -0400] glennpratt: and that would mean we'd need to wrap all these chef servers around some other tool for ops and support
[2013-03-29 15:09:29 -0400] dillyjay: and i'm using chef-solo
[2013-03-29 15:10:00 -0400] glennpratt: for example, I have a shared db server... how can I map that it should be available for tenants a, b, c... same with all roles really
[2013-03-29 15:25:20 -0400] blueben: multi-tenant, but shared instance?
[2013-03-29 15:25:54 -0400] blueben: and clients have access to write the chef recipes?
[2013-03-29 15:30:37 -0400] kesor: does anyone has any experience in using a caching proxy before a chef server?
[2013-03-29 15:39:31 -0400] qhartman: Anyone have any links to more detailed docs on using vagrant machines with a chef server? Particularly ways to tweak the bootstrapping process? It seems like kind of a black box to me at this point, and the docs I've found so far are sparse.
[2013-03-29 15:39:54 -0400] kesor: qhartman: you want to have a chef-server in vagrant?
[2013-03-29 15:40:34 -0400] qhartman: kesor, I have a chef server, and I want to build vagrant VMs that work with it for developing cookbooks, and ultimately creating dev sandboxes that are chef-cmanaged.
[2013-03-29 15:41:10 -0400] kesor: qhartman: I use this Vagrantfile in my development, https://gist.github.com/kesor/5192456  it has a chef server and a test server where I run the cookbooks and test them.
[2013-03-29 15:41:28 -0400] qhartman: cool, I'll check it out, thanks
[2013-03-29 15:41:59 -0400] qhartman: specifically, I want to tweak the bootstrapping process so it installs a particular version of chef in the VM and copies up my encrypted databag, etc, etc
[2013-03-29 15:42:06 -0400] kesor: qhartman: once you have used "knife bootstrap" on your vagrant test server, you can just run "chef-client" on it  which is exactly what "vagrant provision testserver" does.
[2013-03-29 15:42:24 -0400] kesor: qhartman: all of that needs to be done on the server  not in a test server.
[2013-03-29 15:42:51 -0400] kesor: qhartman: but, look at the link I sent. it has a shell provisioner that installs the chef client, etc.
[2013-03-29 15:43:09 -0400] qhartman: cool
[2013-03-29 15:47:08 -0400] qhartman: kesor, cool, that Vagrantfile gives me some good ideas, thanks. Not all my questions are answered, but I can start making progress now.
[2013-03-29 15:47:18 -0400] kesor: cool
[2013-03-29 15:49:06 -0400] souschefhobbes: What would be the appropriate way to send JSON attributes via knife bootstrap -j option and to read the attributes in a recipe?
[2013-03-29 15:50:58 -0400] souschefhobbes: I'm having trouble loading in the JSON, chef shows that the attribute passed doesn't exist on the node, nor does node.keys show the JSON I wanted to pass!
[2013-03-29 15:58:42 -0400] souschefhobbes: If an 'my_attr' doesn't exist as an attribute, why does @@somevar = node.override['my_attr'] create an empty attribute?
[2013-03-29 16:01:16 -0400] qhartman: kesor, I was able to integrate some pieces from your vagrant file already and it's working well. Thanks Again!
[2013-03-29 16:01:34 -0400] kesor: qhartman: glad it helped. enjoy.
[2013-03-29 16:06:10 -0400] MattStratton: anyone been able to use test kitchen with windows systems? really would like use to use tdd on our cookbooks but we have a lot of Windows...
[2013-03-29 16:07:14 -0400] kesor: MattStratton: did you try the chef minitest handler?
[2013-03-29 16:08:25 -0400] MattStratton: kesor: That's probably a good place to start
[2013-03-29 16:12:41 -0400] kindsol: lal00: true. definitions are global and can be called by any recipe in the cookbook path
[2013-03-29 16:13:01 -0400] kindsol: but why use a definition instead of a LWRP?
[2013-03-29 16:20:00 -0400] kesor: anyone has any idea how I can use chef-rewrite with a template that is defined in side LWRP action?
[2013-03-29 16:22:24 -0400] yfeldblum: kesor, why?
[2013-03-29 16:22:44 -0400] kesor: yfeldblum: because I don't want to use a fork while waiting for the author to accept my pull request ...
[2013-03-29 16:23:20 -0400] yfeldblum: kesor, it's not really possible
[2013-03-29 16:23:48 -0400] kesor: can't I monkey patch like, general ruby monkey patch, something that is defined in another cookbook?
[2013-03-29 16:26:40 -0400] yfeldblum: kesor, yes, you can ruby-monkey-patch, but not really chef-rewrite
[2013-03-29 16:27:15 -0400] kesor: yfeldblum: can you give me some pointers to which APIs I need to take a look at? where is the action object is stored after its read from providers/foobar.rb ?
[2013-03-29 16:27:56 -0400] yfeldblum: kesor, provider actions are simply normal ruby methods on the provider class, which is a normal class that inherits Chef::Provider
[2013-03-29 16:28:20 -0400] kesor: yfeldblum: so the collection "resources" should contain those somewhere?
[2013-03-29 16:28:36 -0400] yfeldblum: kesor, what?
[2013-03-29 16:28:57 -0400] kesor: yfeldblum: in another recipe, how can I access these?
[2013-03-29 16:29:20 -0400] yfeldblum: kesor, methods? you can just make an instance of the class and call the method
[2013-03-29 16:30:52 -0400] kesor: yfeldblum: mm let me explain it differently. Say I have the redisio cookbook, and I used "include_recipe redisio::install", now this file gets evaluated by ruby https://github.com/brianbianco/redisio/blob/master/providers/install.rb  after its in-memory so to speak, I want to monkey-patch the "configure" method. Where would I find it? where is it stored?
[2013-03-29 16:33:03 -0400] spox: Chef::Provider::RedisioInstall#configure
[2013-03-29 16:36:19 -0400] kesor: spox: thanks, I'll try that.
[2013-03-29 16:38:19 -0400] kesor: spox: oh  it has recipe_eval in there :(
[2013-03-29 16:41:12 -0400] yfeldblum: kesor, heh that provider seems to be doing everything out-of-order
[2013-03-29 16:41:38 -0400] kesor: yfeldblum: i'm going and try to alias_method and then stick a chef-rewind into a new recipe_eval 
[2013-03-29 16:42:10 -0400] yfeldblum: kesor, not going to work
[2013-03-29 16:42:17 -0400] yfeldblum: kesor, or it imight, who knows
[2013-03-29 16:42:22 -0400] kesor: i'll try ...
[2013-03-29 16:43:02 -0400] dillyjay: test kitchen broke my vagrant
[2013-03-29 16:43:19 -0400] yfeldblum: kesor, but configuring happens before downloading & unpacking?
[2013-03-29 16:43:42 -0400] kesor: yfeldblum: after, its in the " action :run " at the very end of it
[2013-03-29 16:44:12 -0400] yfeldblum: kesor, the other methods declare resources to be run later
[2013-03-29 16:44:44 -0400] yfeldblum: kesor, e.g. the #download method declares a remote_file resource, but does not converge it
[2013-03-29 16:45:14 -0400] kesor: yfeldblum: yeah, the same for resources created during #configure. thats why I want to rewind it before its converged.
[2013-03-29 16:46:01 -0400] dillyjay: how do you prevent gems that require older versions of vagrant, and consequently the vagrant gem (i.e. test-kitchen), from breaking vagrant? just not install test-kitchen?
[2013-03-29 16:46:10 -0400] yfeldblum: kesor, no, all the resources declared within #configure are declared inside a recipe_eval block, which converges them immediately (and before any of the resources declared in #download get converged)
[2013-03-29 16:46:36 -0400] kesor: yfeldblum: oh. guess its not great :/
[2013-03-29 16:53:19 -0400] kesor: yet another cookbook I'll need to fork :(
[2013-03-29 16:53:37 -0400] version2beta: Best practice question: when installing packages, should retries be set to more than one? The standard postgresql cookbook doesn't do that, and often craps out on me. Wondering if retries is not preferred for some reason.
[2013-03-29 16:57:14 -0400] yfeldblum: version2beta, it ought generally to be safe to retry the `chef-client` command as a whole
[2013-03-29 16:57:32 -0400] yfeldblum: version2beta, the individual resources do not individually need to be retried since, if a run fails, you can just retry the whole run
[2013-03-29 16:59:07 -0400] version2beta: yfeldblum, and it typically will rerun. But I'm also setting up dev environments and the devs are supposed to run it when they see fit. They're bothered by failures. I guess I could rescue the call to the postgresql cookbook.
[2013-03-29 16:59:14 -0400] yfeldblum: version2beta, this works well if everything is actually convergent and idempotent, which is how cookbooks should be (some aren't, which can be problematic)
[2013-03-29 16:59:33 -0400] version2beta: yfeldblum, trying to make sure ours are.
[2013-03-29 16:59:47 -0400] yfeldblum: version2beta, don't be bothered by failures then ... ?
[2013-03-29 17:00:12 -0400] yfeldblum: version2beta, anyway you can certainly inject a retry for the one package resource if you like
[2013-03-29 17:00:31 -0400] version2beta: yfeldblum, hah! two of the devs own the company. they'll get over it, but right now they still expect to run a script and have a dev environment relatively quickly.
[2013-03-29 17:01:04 -0400] yfeldblum: version2beta, r = resources("package[postgresql]") ; r.retries = 1_000_000 # just in case
[2013-03-29 17:01:07 -0400] version2beta: yfeldblum, thank you, I expect I'll need to do that. Not sure how yet, but I know I've seen something about catching exceptions within a recipe.
[2013-03-29 17:01:11 -0400] yfeldblum: version2beta, r = resources("package[postgresql]") ; r.retries(1_000_000) # just in case
[2013-03-29 17:01:33 -0400] version2beta: yfeldblum, oh! that'll do it too :-)
[2013-03-29 17:01:34 -0400] yfeldblum: version2beta, catching exceptions in the recipe works real well for exceptions that happen during the recipe
[2013-03-29 17:02:00 -0400] version2beta: yfeldblum, you can't trap an exception in an include_recipe?
[2013-03-29 17:02:02 -0400] yfeldblum: version2beta, but ... resource convergence happens *after* all your recipe code is run ... not during ...
[2013-03-29 17:02:20 -0400] version2beta: yfeldblum, I learned that the hard way ;-)
[2013-03-29 17:02:35 -0400] yfeldblum: version2beta, it's documented everywhere ... but yes most people learn that the hard way :D
[2013-03-29 17:02:51 -0400] version2beta: yfeldblum, and that's how I learned what they meant!
[2013-03-29 17:02:52 -0400] yfeldblum: version2beta, ALL recipe code is run first, and then ALL resources are only converged after that
[2013-03-29 17:03:29 -0400] yfeldblum: version2beta, include_recipe runs the code in a recipe, sure, but the resources it declares are still converged only after ALL the recipes are run
[2013-03-29 17:04:21 -0400] version2beta: yfeldblum, thank you. This has been very helpful. :-)
[2013-03-29 17:05:14 -0400] yfeldblum: version2beta, i have that effect :D
[2013-03-29 17:06:11 -0400] version2beta: yfeldblum, now I just need to make the node['postgresql']['pg_hba'] hash work. I tried it earlier this week and it kept failing, but it occurs to me I probably need an array of hashes even if I'm adding only one.
[2013-03-29 17:06:28 -0400] spox: version2beta: that is correct
[2013-03-29 17:06:29 -0400] yfeldblum: version2beta, that's right
[2013-03-29 17:07:09 -0400] version2beta: spox, yfeldblum thanks for the confirmation. It's not show that way in the recipe (although it does say "As an array...")
[2013-03-29 17:07:33 -0400] gchristensen: has anyone successfully used Omnibus for packaging other projects? I'm having an issue with installing a gem, but then not being recognized later on.
[2013-03-29 17:07:49 -0400] yfeldblum: version2beta, https://github.com/opscode-cookbooks/postgresql/blob/master/attributes/default.rb#L175-L180
[2013-03-29 17:09:17 -0400] version2beta: yfeldblum, so I should append if I don't wish to lose what's there.
[2013-03-29 17:09:35 -0400] version2beta: or no, those are on default, not node.
[2013-03-29 17:10:04 -0400] yfeldblum: version2beta, the node attributes is a merged combination of the default, normal, override, and automatic attributes
[2013-03-29 17:10:33 -0400] yfeldblum: version2beta, you can't change "node" attributes directly; you must change the attributes at one of these four levels, and the default level is recommended (by me) unless you've got a specific need for another level
[2013-03-29 17:10:56 -0400] yfeldblum: version2beta, in an attributes file only, `default` refers to `node.default`
[2013-03-29 17:11:09 -0400] version2beta: yfeldblum, so setting node[:postgresql][:pg_hba] = [{...}] in my configuration cookbook should be fine.
[2013-03-29 17:11:23 -0400] yfeldblum: version2beta, not allowed
[2013-03-29 17:11:37 -0400] yfeldblum: version2beta, you must set it at one of the precedence levels
[2013-03-29 17:12:08 -0400] yfeldblum: version2beta, like `node.default["postgresql"]["pg_hba"] << { some data }`
[2013-03-29 17:12:56 -0400] version2beta: yfeldblum, okay. I've missed that before. I have to look through some of my configuration cookbooks and see what I've done. Perhaps breaking stuff.
[2013-03-29 17:13:21 -0400] yfeldblum: version2beta, this is true in chef-11, but `node["asdf"] = something` worked in chef-10
[2013-03-29 17:13:43 -0400] yfeldblum: version2beta, it is deprecated in chef-10.24 and warned about in the logging, though
[2013-03-29 17:13:56 -0400] version2beta: yfeldblum, I'm on 11.4.0.
[2013-03-29 17:14:30 -0400] version2beta: I think the only dprecation warnings I get are from python_pip and Chef::Exceptions::ShellCommandFailed
[2013-03-29 17:14:37 -0400] yfeldblum: version2beta, then you've got some broken cookbooks :D
[2013-03-29 17:15:01 -0400] version2beta: yfeldblum, because of the python_pip deprecation warning?
[2013-03-29 17:15:17 -0400] yfeldblum: version2beta, because of `node["asdf"] = something`
[2013-03-29 17:15:18 -0400] dillyjay: i'm trying to include test-kitchen in my project, but it's breaking vagrant (v1.1.2). ruby gems.org shows v0.7.0 for test-kitchen, and gemspec for that version adds a dependency on the vagrant gem. vagrant 1.1 no longer supports gem installation, and installing the gem breaks vagrant. what's the best way to handle this? specifying a the opscode/test-kitchen git repo in my project's Gemfile? Pre-install the test-kitchen gem with 
[2013-03-29 17:15:18 -0400] dillyjay: "ignore dependencies" directive (seems hacky and likely to cause recurring probs)?
[2013-03-29 17:15:58 -0400] version2beta: yfeldblum, I may very well, but going to check. Might be one of the "i don't understand why it doesn't work" fixes I'
[2013-03-29 17:16:00 -0400] version2beta: ve made
[2013-03-29 17:26:09 -0400] Majost: Does anyone know it is possible to nest attributes a layer deeper when defining attributes from a resource; instead of having the values automatically get tossed into the top level of the cookbook's attributes?
[2013-03-29 17:26:50 -0400] Majost: ack
[2013-03-29 17:26:52 -0400] Majost: heh
[2013-03-29 17:27:10 -0400] Majost: hopefully I didn't miss a reply to my question.
[2013-03-29 17:27:30 -0400] yfeldblum: Majost, i don't know what that means
[2013-03-29 17:28:45 -0400] Majost: I might be asking the wrong question -- so lets start with the following instead. Are are attributes defined for a resource transient to a chef run, or are the values set to the node data?
[2013-03-29 17:29:09 -0400] yfeldblum: Majost, they are in-memory-only
[2013-03-29 17:29:35 -0400] Majost: Is it possible to commit some of these to the node data?
[2013-03-29 17:29:54 -0400] Majost: is that just a matter of adding something in the resource to do this?
[2013-03-29 17:31:01 -0400] Guest91967: Hi, I am trying to do my very first bootstrap from the workstation (CentOS5.6) to a future client (CentOS5.6) and I am getting the following error: http://pastebin.com/3j0pHv2i
[2013-03-29 17:31:05 -0400] yfeldblum: Majost, your resources & providers should not be writing to the node data
[2013-03-29 17:31:11 -0400] yfeldblum: Majost, instead, your recipe should do that
[2013-03-29 17:31:39 -0400] Guest91967: ./nick denuevo
[2013-03-29 17:32:46 -0400] Guest91967: As a result the system is not auto-registering on the server.
[2013-03-29 17:32:46 -0400] Majost: I am doing something kinda funky -- where I have an application which has it's configuration done via an xml file -- but one of the configurable options has a about 12 parameters which make it a pita to configure with an array of hashes -- however a LWRP would present a simple interface to have sane defaults for each entry in the array.
[2013-03-29 17:33:15 -0400] blackstar257: #ccdcrt
[2013-03-29 17:34:22 -0400] dillyjay: Guest91967: looks like you don't have a gem that you need called "format"
[2013-03-29 17:34:25 -0400] Majost: Guest91967: I have had issues with Ruby 1.8 running chef.
[2013-03-29 17:34:46 -0400] Guest91967: dillyjay: wouldn't the bootstrap do this?
[2013-03-29 17:35:04 -0400] Majost: Guest91967: you might want to consider using either RVM or the omnibus install for the machine you are running your knife bootstrap on
[2013-03-29 17:36:30 -0400] Guest91967: Majost: sorry I am not very familiar with terms, but you are saying that I should login the target client and run omnibus install on it directly?
[2013-03-29 17:37:57 -0400] Majost: Guest91967: Did you pass  -d or --distro to your bootstrap initially?
[2013-03-29 17:38:13 -0400] Majost: its using the system ruby for some reason or another
[2013-03-29 17:38:14 -0400] Guest91967: Yes - I did
[2013-03-29 17:38:16 -0400] Majost: ahh
[2013-03-29 17:38:17 -0400] Majost: yeah
[2013-03-29 17:38:20 -0400] Majost: so that is why
[2013-03-29 17:38:31 -0400] Guest91967: Then I tried without
[2013-03-29 17:38:35 -0400] Majost: it installed chef, but not the omnibus version
[2013-03-29 17:38:44 -0400] Majost: right, but the second time chef was already installed
[2013-03-29 17:39:04 -0400] Majost: Guest91967: If this is a VM you can revert
[2013-03-29 17:39:14 -0400] Guest91967: Sure
[2013-03-29 17:39:27 -0400] Majost: then you should be able to just revert to a clean state and run without the -d/--distro option
[2013-03-29 17:39:36 -0400] Guest91967: OK - without the distro
[2013-03-29 17:39:40 -0400] Majost: yup
[2013-03-29 17:39:44 -0400] Guest91967: Why would the distro present a problem?
[2013-03-29 17:39:59 -0400] Majost: it forces it to use the system ruby
[2013-03-29 17:40:31 -0400] Guest91967: OK - I see
[2013-03-29 17:40:37 -0400] Guest91967: OK -let me try again :)
[2013-03-29 17:40:40 -0400] Guest91967: I'll be back...
[2013-03-29 17:40:42 -0400] Majost: np
[2013-03-29 17:41:54 -0400] dillyjay: Majost: might you be able to help me with my dependency conflict problem? new to chef and ruby and vagrant
[2013-03-29 17:42:14 -0400] Majost: I can try -- I don't use vagrant as much as I should though.
[2013-03-29 17:42:25 -0400] Majost: dillyjay: whats the issue?
[2013-03-29 17:42:27 -0400] dillyjay: it's more to do with chef/ruby gems than vagrant
[2013-03-29 17:42:49 -0400] dillyjay: i want to use test-kitchen in my project. i'm using bundler to handle my local dependencies
[2013-03-29 17:43:20 -0400] dillyjay: but test-kitchen has a dependency on the rubygem version of vagrant, which is no longer used in vagrant 1.1
[2013-03-29 17:43:40 -0400] dillyjay: so when i install test-kitchen, in short, it breaks vagrant
[2013-03-29 17:44:16 -0400] dillyjay: test-kitchen 1.0 resolves this issue, but right now using rubygems.org only test-kitchen 0.7 is available
[2013-03-29 17:44:37 -0400] Majost: hrm, that is a pickle
[2013-03-29 17:44:46 -0400] dillyjay: my two ideas were: 1) use the `:git` option in my Gemfile to specify test-kitchen 1.0 from the opscode git repo
[2013-03-29 17:45:34 -0400] dillyjay: 2) install test-kitchen using `gem install` with the ignore dependencies option before i run bundle install (seems like a bad choice; would ignore other deps of test kitchen too)
[2013-03-29 17:46:36 -0400] Majost: This is probably not the solution you are looking for -- but you could run test-kitchen in another vm or from jenkins or something
[2013-03-29 17:47:35 -0400] dillyjay: hm. will add that as option 3). but i hope to publish the environment to github so collaborators on this project can simply pull down the git repo, run `vagrant up`, and have a fully provisioned VM rady to go
[2013-03-29 17:48:16 -0400] version2beta: yfeldblum, all good now. Thanks for your help!
[2013-03-29 17:48:16 -0400] Majost: ahh, yeah
[2013-03-29 17:48:36 -0400] yfeldblum: version2beta, no probs
[2013-03-29 17:49:06 -0400] dillyjay: other designer and developers like me, who also have no clue what they're doing with sysadmin stuff :)
[2013-03-29 17:49:21 -0400] Majost: hah
[2013-03-29 17:49:47 -0400] jasherai: hola, could I get some help with attribute precedence? (waits for the groaning to stop ;> )
[2013-03-29 17:50:02 -0400] miah: what about it
[2013-03-29 17:50:46 -0400] jasherai: I have a recipe default recipe that seems to be loading the attributes for another recipe ("authd")
[2013-03-29 17:51:40 -0400] jasherai: https://github.com/phatforge/chef-pureftpd/blob/master/attributes/authd.rb
[2013-03-29 17:53:12 -0400] jasherai: authd attributes /should/ only override the default attributes when that recipe is called. The attribute in question is default['pureftpd']['service']
[2013-03-29 17:53:29 -0400] jasherai: should I be setting the override differently in the authd attributes file?
[2013-03-29 17:57:12 -0400] Majost: dillyjay: I honestly don't know how to go about fixing this... you might be able to monkey patch the requires
[2013-03-29 17:57:53 -0400] log1kal: jasherai: I was under the impression that loading a cookbook loaded all dependenciy files, regardless of which recipe is called
[2013-03-29 17:57:53 -0400] Majost: Its definitely an ugly hack, if it works at all.
[2013-03-29 17:59:19 -0400] dillyjay: Majost: i'm going to try using `:git` in the Gemfile, but i'm concerned that i'll have to check whether every gem i want to use is going to install vagrant gem
[2013-03-29 17:59:19 -0400] miah: log1kal: you are correct
[2013-03-29 17:59:27 -0400] log1kal: When a cookbook is run against a node, the attributes contained in all attribute files are evaluated in the context of the node object. http://docs.opscode.com/essentials_cookbook_attribute_files.html
[2013-03-29 17:59:35 -0400] miah: all attributes included with a cookbook are loaded when a cookbook is added to the runlist
[2013-03-29 18:00:40 -0400] jasherai: log1kal: How do you have recipe specific attributes? do I need to check for the recipe name in the attributes file? or override the attributes in the recipe itself?
[2013-03-29 18:01:13 -0400] log1kal: It sounds like a bad idea, but you could do a conditional in the authd attribute file to make sure the recipe is in the runlist before applying the attributes
[2013-03-29 18:01:33 -0400] log1kal: or just set them in the cookbook
[2013-03-29 18:03:00 -0400] jasherai: log1kal: it does smell a bit doesn't it.
[2013-03-29 18:03:06 -0400] log1kal: Little bit, yeah.
[2013-03-29 18:03:24 -0400] log1kal: (understatement)
[2013-03-29 18:04:06 -0400] log1kal: Hrmm
[2013-03-29 18:04:34 -0400] jasherai: thanks for talking it out... i'm gonna look at a couple of other cookbooks to see if I see anything similar. I think I'm gonna end up overriding in the recipe tho.
[2013-03-29 18:04:59 -0400] log1kal: Also, smelly, but less so: have a _recipe_ with the attribute changes needed, and include_recipe it from the authd recipe.
[2013-03-29 18:05:22 -0400] log1kal: That's a bit roundabout, though. Might as well jsut put it in the authd recipe
[2013-03-29 18:05:25 -0400] jasherai: thats an interesting idea..
[2013-03-29 18:05:33 -0400] jasherai: agreed
[2013-03-29 18:06:07 -0400] miah: write less recipes, write more resources =)
[2013-03-29 18:07:02 -0400] jasherai: miah: thats step 2 :) I'm just getting my feet wet with the recipes for the mo! :D
[2013-03-29 18:07:14 -0400] log1kal: ^
[2013-03-29 18:07:52 -0400] dillyjay: Majost: meh, whatever, getting late and frustrated, i'm just going to package a shell script with the repo that runs `bundle install`, then checks if the vagrant gem has been installed, and if so, uninstalls it
[2013-03-29 18:08:41 -0400] Majost: dillyjay: I think no matter what you are going to have to hack around the issue until 1.0 of test-kitchen is available.
[2013-03-29 18:09:18 -0400] modcloth_dev: hello
[2013-03-29 18:09:42 -0400] log1kal: I enjoy your nick, modcloth_dev
[2013-03-29 18:09:57 -0400] log1kal: Also, your marketing works fantastically on my wife.
[2013-03-29 18:10:02 -0400] modcloth_dev: I am a developer at ModCloth...trying to be accurate lol
[2013-03-29 18:10:14 -0400] miah: modcloth_dev: awesome
[2013-03-29 18:10:21 -0400] miah: i met some people from  modcloth at a women who code event
[2013-03-29 18:10:31 -0400] modcloth_dev: we have those here too
[2013-03-29 18:10:36 -0400] miah: cool
[2013-03-29 18:10:45 -0400] modcloth_dev: who did you meet?
[2013-03-29 18:10:49 -0400] miah: uh.
[2013-03-29 18:11:11 -0400] miah: give me a minute :P
[2013-03-29 18:11:16 -0400] modcloth_dev: no worries haha
[2013-03-29 18:11:24 -0400] modcloth_dev: in the meanwhile, we have some chef-related issues
[2013-03-29 18:11:50 -0400] modcloth_dev: we are trying to use an rbenv resource provider on top of the opscode one
[2013-03-29 18:11:57 -0400] c_t: wait, you're from modcloth?
[2013-03-29 18:12:02 -0400] c_t: Do you know Jeff?
[2013-03-29 18:12:15 -0400] modcloth_dev: we have added a default provider for it that we are attempting to use, but it says it cannot find the associated resource
[2013-03-29 18:12:21 -0400] modcloth_dev: Jeff <lastname?>
[2013-03-29 18:12:36 -0400] c_t: (* I don't actually know anyone from modcloth; this is merely a variant of the "You're from Canada? Do you know Jeff?" joke)
[2013-03-29 18:12:38 -0400] miah: the opscode one?
[2013-03-29 18:12:43 -0400] modcloth_dev: ah
[2013-03-29 18:13:02 -0400] modcloth_dev: @miah we are using our own special sauce
[2013-03-29 18:13:08 -0400] miah: c_t: eh. well modcloth is based in SF, and i live in SF. so always interesting to meet people :P
[2013-03-29 18:13:17 -0400] modcloth_dev: methinks chef is trying to use the opscode one though
[2013-03-29 18:13:26 -0400] miah: modcloth_dev: ok. just confused about th is: use an rbenv resource provider on top of the opscode one
[2013-03-29 18:13:28 -0400] c_t: I live off in the hinterlands, and hardly ever see anyone
[2013-03-29 18:13:33 -0400] miah: i dont know what you mean by opscode one
[2013-03-29 18:13:53 -0400] modcloth_dev: http://community.opscode.com/cookbooks/rbenv
[2013-03-29 18:14:03 -0400] miah: ok
[2013-03-29 18:14:19 -0400] miah: so, what error are you seeing exactly?
[2013-03-29 18:14:31 -0400] modcloth_dev: Cannot find a resource for rbenv on smartos version 5.11
[2013-03-29 18:14:48 -0400] miah: ok. does your cookbook contain a resource, and a provider?
[2013-03-29 18:14:56 -0400] modcloth_dev: yes
[2013-03-29 18:14:58 -0400] modcloth_dev: default for each
[2013-03-29 18:15:06 -0400] modcloth_dev: and this particular recipe is also default
[2013-03-29 18:15:07 -0400] miah: and your cookbook is named 'rbenv'
[2013-03-29 18:15:11 -0400] modcloth_dev: yes
[2013-03-29 18:15:19 -0400] miah: its a lightweight resource?
[2013-03-29 18:15:22 -0400] modcloth_dev: er
[2013-03-29 18:15:37 -0400] modcloth_dev: might be modcloth-rbenv
[2013-03-29 18:15:40 -0400] modcloth_dev: yes it's a lwrp
[2013-03-29 18:15:43 -0400] miah: ok
[2013-03-29 18:15:48 -0400] modcloth_dev: *an
[2013-03-29 18:15:54 -0400] miah: so, ya. verify that the naming is correct and you are calling the correct name
[2013-03-29 18:16:05 -0400] miah: if its resource/default it should just be named after the cookbook's name
[2013-03-29 18:16:06 -0400] modcloth_dev: well so that's a question
[2013-03-29 18:16:16 -0400] modcloth_dev: if there are two different cookbooks that have resources with the same name
[2013-03-29 18:16:18 -0400] miah: cookbook names are defined by metadata.rb 'name'
[2013-03-29 18:16:21 -0400] modcloth_dev: how do we specify which we are using
[2013-03-29 18:16:24 -0400] modcloth_dev: ohhh
[2013-03-29 18:16:28 -0400] modcloth_dev: ok, sec, let me check that
[2013-03-29 18:16:58 -0400] miah: if a cookbook doesn't have metadata.rb, its usually uploaded to the chef server with the name of recipes directory, so if its in 'modcloth-rbenv' thats the name it will get
[2013-03-29 18:17:05 -0400] miah: implicitly setting it is good stuffs though
[2013-03-29 18:17:22 -0400] modcloth_dev: the metadata file does not appear to define a name - could that be the issue?
[2013-03-29 18:17:28 -0400] miah: yes
[2013-03-29 18:17:33 -0400] modcloth_dev: and is it <cookbook_name>_<provider> ?
[2013-03-29 18:17:42 -0400] miah: cookbookname_resource
[2013-03-29 18:17:46 -0400] modcloth_dev: to invoke the provider
[2013-03-29 18:17:51 -0400] modcloth_dev: ok
[2013-03-29 18:17:53 -0400] miah: so long as _resource is something other than .default.rb
[2013-03-29 18:18:01 -0400] modcloth_dev: it is default
[2013-03-29 18:18:07 -0400] miah: but if its in default.rb then it will just be cookbookname
[2013-03-29 18:18:21 -0400] modcloth_dev: kk let's see if that fixes it
[2013-03-29 18:19:03 -0400] miah: if you have two different cookbooks with the same name, the last one uploaded would take precedence since that would be the newest version, unless they have explicit versions defined
[2013-03-29 18:19:22 -0400] miah: but still, you should give things unique names.
[2013-03-29 18:20:03 -0400] modcloth_dev: if the cookbook name is modcloth-rbenv
[2013-03-29 18:20:11 -0400] modcloth_dev: and we want to use the default provider
[2013-03-29 18:20:15 -0400] modcloth_dev: what is the function call?
[2013-03-29 18:20:23 -0400] modcloth_dev: (i.e. is the dash valid?)
[2013-03-29 18:20:44 -0400] kaerast: you shouldn't use dashes in cookbook names
[2013-03-29 18:21:29 -0400] kaerast: it'll work for basic recipes, but not when you start creating LWRPs
[2013-03-29 18:21:47 -0400] spox: kaerast: yes it will
[2013-03-29 18:21:58 -0400] spox: the dashes will be automatically converted to underscores
[2013-03-29 18:22:08 -0400] spox: my-cookbook -> my_cookbook_resource
[2013-03-29 18:22:19 -0400] miah: right
[2013-03-29 18:22:19 -0400] kaerast: not in the version of Chef we're using, we had to convert them all to use underscores
[2013-03-29 18:22:32 -0400] miah: but you should name cookbooks as if they were valid ruby methods, so snake_case
[2013-03-29 18:22:33 -0400] modcloth_dev: seems like if they are supposed to be underscores, they should probably be underscores
[2013-03-29 18:22:54 -0400] miah: kaerast: you must be running anciety chef =)
[2013-03-29 18:22:58 -0400] miah: ancient
[2013-03-29 18:24:26 -0400] miah: i'm porting some chef 0.6 cookbooks to chef 10. so.. =)
[2013-03-29 18:24:47 -0400] kaerast: it was six months ago we came across this, we're just not finding the time to upgrade all our chef servers
[2013-03-29 18:25:04 -0400] kaerast: most nodes are running a recent chef-client though now
[2013-03-29 18:25:05 -0400] miah: interesting
[2013-03-29 18:25:22 -0400] miah: i suspect it must have been a old chef 0.10, or 0.9 then
[2013-03-29 18:25:56 -0400] kaerast: probably somewhere between 0.10.2 and 0.10.6
[2013-03-29 18:26:09 -0400] miah: ok that helps.
[2013-03-29 18:26:14 -0400] miah: good to be aware of those things
[2013-03-29 18:33:10 -0400] joenuspl: For knife exec scripts, I would like to just make them executable and add "#! /usr/bin/env knife"  I could write my own knife-exec invoker.  How are others dealing with this?
[2013-03-29 18:34:08 -0400] Chris_Woods: Hey all, does anyone have any experience setting up nagios with chef?
[2013-03-29 18:37:28 -0400] kaerast: Chris_Woods, not per se, but it should be as simple as a package install and then templated configuration files
[2013-03-29 18:37:40 -0400] kaerast: or are you wanting to automatically add new nodes to nagios monitoring?
[2013-03-29 18:38:56 -0400] Chris_Woods: kaerast, Yeah, I had hoped.  I followed everything to the letter, but when I chef-client a new workstation with the nagios::client recipe it fails with a 403 Forbidden.  I can't seem to figure out what is failing, though.
[2013-03-29 18:39:01 -0400] modcloth_dev: @miah it looks like that is working, but we have another question for you
[2013-03-29 18:39:27 -0400] modcloth_dev: if we are using two cookbooks with the same name, how do we instruct chef to use one instead of teh other
[2013-03-29 18:40:36 -0400] kaerast: ah I've never used the community nagios cookbook, I just wrote my own.
[2013-03-29 18:40:55 -0400] HarvesterOfBeer: ohai! I'm needing a bit of help on how to call a cookbook resource from a ruby_block
[2013-03-29 18:44:06 -0400] kindsol: HarvesterOfBeer: not sure I understand. Do you meant calling a *chef* resource from a ruby_block, or ?
[2013-03-29 18:46:01 -0400] HarvesterOfBeer: kindsol: sorry, yes. Specifically trying to call 'service' to stop/start windows services
[2013-03-29 18:49:04 -0400] kindsol: do you just want to notify an existing service resource conditionally from a ruby_block? or something different?
[2013-03-29 18:52:37 -0400] yfeldblum: HarvesterOfBeer, notify the service
[2013-03-29 18:52:56 -0400] modcloth_dev: hi guys - have another question for all of you out there - I have a provider that cannot seem to find its corresponding resource and I cannot figure out why
[2013-03-29 18:53:16 -0400] HarvesterOfBeer: kindsol: I have a sequence of steps that need to happen with stopping a service, make some adjustments, start service
[2013-03-29 18:53:23 -0400] yfeldblum: HarvesterOfBeer, some_resource "some-name" do ; notify :restart, "service[the-service]", :immediately ; end
[2013-03-29 18:54:30 -0400] chadoh: ok, irssi with tmux, let's see how this goes.
[2013-03-29 18:54:54 -0400] HarvesterOfBeer: yfeldblum: some of the stuff I need to do when the service is stopped, I'm doing in a ruby block
[2013-03-29 18:54:57 -0400] chadoh: ugh. it doesn't. I see one line of conversation history. I guess I'll use a gui.
[2013-03-29 18:55:01 -0400] kindsol: HarvesterOfBeer: gotcha.  You want to lookup the service from the resource_collection and then call an action on it
[2013-03-29 18:59:03 -0400] HarvesterOfBeer: kindsol: ok. Can you hit me with the clue stick again. I'm not sure how to "look up the service from the resource_collection"
[2013-03-29 19:02:08 -0400] kindsol: looking at the chef code, I am not sure if you have access to the resource_collection in the code block of a ruby_block
[2013-03-29 19:02:37 -0400] HarvesterOfBeer: hmm
[2013-03-29 19:02:40 -0400] kindsol: some more advanced Chefs might know off the top of their heads
[2013-03-29 19:02:46 -0400] kindsol: but I would have to experiment
[2013-03-29 19:03:07 -0400] HarvesterOfBeer: kindsol: the reason I wrapepd it all in a ruby block was that it needs to be conditional on the service existing on the node
[2013-03-29 19:03:33 -0400] HarvesterOfBeer: kindsol: the only way I could find to do that was with a native ruby call
[2013-03-29 19:03:59 -0400] kindsol: the not_if/only_if resource params won't work for you?
[2013-03-29 19:04:19 -0400] kindsol: http://docs.opscode.com/resource_common_conditionals.html
[2013-03-29 19:04:31 -0400] Guest91967: Is it required for the clients to be bootstrapped to be part of DNS?
[2013-03-29 19:04:58 -0400] Guest91967: I am getting: " FATAL: Chef::Exceptions::CannotDetermineNodeName: Unable to determine node name: configure node_name or configure the system's hostname and fqdn"
[2013-03-29 19:05:07 -0400] Guest91967: Could it not used the IP?
[2013-03-29 19:05:08 -0400] kindsol: HarvesterOfBeer: what you are trying to do in a ruby_block is fairly unnatural for a chef reecipe
[2013-03-29 19:05:34 -0400] HarvesterOfBeer: kindsol: hmm. I'll have to look at that again. I was under the impression that you couldn't use native ruby in those blocks
[2013-03-29 19:05:36 -0400] kindsol: But doable, if that is the only option
[2013-03-29 19:06:11 -0400] kindsol: HarvesterOfBeer: you can use ruby if you pass a block
[2013-03-29 19:06:22 -0400] kindsol: e.g. {  }  or do  end
[2013-03-29 19:06:41 -0400] HarvesterOfBeer: kindsol: Yeah, I know it's not the way, but I'm a newb and that was th eonly path through the woods I found
[2013-03-29 19:06:44 -0400] HarvesterOfBeer: ok, yeah
[2013-03-29 19:06:54 -0400] HarvesterOfBeer: I'll check that. Thanks!
[2013-03-29 19:07:13 -0400] kindsol: no worries.  does it look like only_if will work for ya?
[2013-03-29 19:07:39 -0400] HarvesterOfBeer: kindsol: smells that way
[2013-03-29 19:09:24 -0400] kindsol: nice
[2013-03-29 19:13:00 -0400] lal00: is it possible to export a method in a cookbook so that other cookbooks can use it?
[2013-03-29 19:13:34 -0400] gad0lin_: lal00: sure
[2013-03-29 19:13:38 -0400] lal00: I would like to have a method so that other cookbooks can create files to open a port in the firewall using a template that is in the firewall cookbook.
[2013-03-29 19:13:53 -0400] gad0lin_: lal00: put it in libraries within your cookbook
[2013-03-29 19:14:17 -0400] lal00: gad0lin_: is a library the same thing as a definition? I've been reading about those
[2013-03-29 19:14:50 -0400] gad0lin_: lal00: ok, you dont want to create method, what you want is to create resource
[2013-03-29 19:15:54 -0400] lal00: I would like to be able to write "firehol_rule(name, port)" in my recipe, and that would create the file "/etc/firehol.d/rule_#{name}"
[2013-03-29 19:16:14 -0400] lal00: is that a resource?
[2013-03-29 19:22:04 -0400] gad0lin_: lal00:  that is how I would do that: http://pastebin.com/U0dntjZ2
[2013-03-29 19:22:59 -0400] lal00: gad0lin_: let me see
[2013-03-29 19:24:50 -0400] lal00: do they get loaded by default?
[2013-03-29 19:29:01 -0400] gad0lin_: yes, just add dependency to cookbook in metadata.rb
[2013-03-29 19:40:33 -0400] lal00: gad0lin_: awesome, it worked!
[2013-03-29 19:41:06 -0400] lal00: any reason why the resource had to be split in providers/ and resources/ ?
[2013-03-29 19:51:08 -0400] gad0lin_: lal00:  havent asked that question myself, I think that the idea is that resources - contains just definitions(like interfaces) and providers - implemenations
[2013-03-29 19:57:59 -0400] Majost: As a cookbook developer, I would like to have a way  to create LWRP-like interfaces for defining complex node attributes used in template files.
[2013-03-29 20:01:43 -0400] chadoh: Hey, all. New to chef, went to a training on Tuesday but blew the sudoers file on the training EC2 instance I was gifted with. I'm trying to bootstrap a new one. I set up my own EC2 instance (ubuntu 12.04) that uses ssh auth. I can ssh into the box using `IdentityFile ~/.ssh/2013.pem`, but when I `knife bootstrap IPADDRESS -i ~/.ssh/2013.pem`, I get `Bootstrapping Chef on IPADDRESS
[2013-03-29 20:01:43 -0400] chadoh: ERROR: Network Error: Connection refused - connect(2)
[2013-03-29 20:01:43 -0400] chadoh: Check your knife configuration and network settings`
[2013-03-29 20:02:08 -0400] chadoh: What did I forget?
[2013-03-29 20:04:29 -0400] Urocyon: If I want to create several catalina base directory structures on a node (a directory with sub directories.)  Is there a good way to abstract this into a single repeatable call, or maybe into a catalina_base directory structure resource?
[2013-03-29 20:04:30 -0400] gchristensen: anyone around who has used omnibus-ruby to build the omnibus installer?
[2013-03-29 20:06:53 -0400] gad0lin_: #join chef-hacking
[2013-03-29 20:07:13 -0400] Urocyon: chadoh you probably don't have access to the root user shoudn't you pass in a different user to go along with that identity file maybe "-x ubuntu --sudo"
[2013-03-29 20:07:22 -0400] gchristensen: thank you, gad0lin_
[2013-03-29 20:07:27 -0400] chadoh: I tried that, too.
[2013-03-29 20:07:37 -0400] gad0lin_: gchristensen: no, its my type
[2013-03-29 20:07:40 -0400] gad0lin_: gchristensen: no, its my typo
[2013-03-29 20:08:04 -0400] gchristensen: oh, haha
[2013-03-29 20:08:07 -0400] gchristensen: damn :)
[2013-03-29 20:08:43 -0400] Urocyon: chadoh - can you log into the machine with ssh?
[2013-03-29 20:08:56 -0400] chadoh: yes.
[2013-03-29 20:09:05 -0400] Urocyon: using that identity file?
[2013-03-29 20:09:09 -0400] chadoh: indeed.
[2013-03-29 20:09:22 -0400] Urocyon: chadoh is that as the ubuntu user?
[2013-03-29 20:09:27 -0400] chadoh: yes.
[2013-03-29 20:10:29 -0400] Urocyon: ok probably not the identity file or user then as long as you are using -x ubuntu --sudo -i <identitiy file>
[2013-03-29 20:11:25 -0400] chadoh: I used `-i [identity file] -x ubuntu --sudo
[2013-03-29 20:11:27 -0400] chadoh: `
[2013-03-29 20:12:10 -0400] Urocyon: chadoh I think that connection error is actually an http connection error.
[2013-03-29 20:16:08 -0400] chadoh: The teacher of the class gifted me a new EC2 instance set up the same as the one I used in class on Tuesday. It's working with that one.
[2013-03-29 20:16:35 -0400] chadoh: it uses password auth.
[2013-03-29 20:18:47 -0400] Urocyon: chadoh: I was trying to recreate the error, but haven't managed yet.  I can say that ssh connection errors do look different, resulting in a Net::SSH error of some kind.
[2013-03-29 20:20:08 -0400] dan|el: Are my attributes not supposde to be accessible in the recipe? seems weird but none of them are.
[2013-03-29 20:20:28 -0400] chadoh: huh. Now it worked.
[2013-03-29 20:20:41 -0400] chadoh: I didn't do anything different, I don't think
[2013-03-29 20:21:07 -0400] Urocyon: chadoh: that seems pretty strange
[2013-03-29 20:22:22 -0400] kesor: anyone familiar with a script or something that will upload knife cookbooks when they are pushed to git/github/bitbucket? optionally with foodcritic or something?
[2013-03-29 20:22:34 -0400] chadoh: I'm terribly sorry that I'm not using your username; I'm using Adium and I had it set up sensibly for 1 on 1 convos (no usernames shown), but that setting ended up being absolutely stupid for group chats (I don't even know why they allow it, really)
[2013-03-29 20:23:19 -0400] dan|el: i tried loading the attribute file manually from the recipe: http://docs.opscode.com/essentials_cookbook_attribute_files_ordering.html  using include_attribute "name_of_cookbook"
[2013-03-29 20:23:33 -0400] dan|el: but i get an error saying Cannot find a resource for include_attribute on fedora version 18
[2013-03-29 20:23:43 -0400] dan|el: is include_attribute not supposed to be accessible in the recipe?
[2013-03-29 20:26:19 -0400] dan|el: "An attribute can be defined in a cookbook (or a recipe)"  in the recipe it's defined in attributes/default.rb for example. where is it defined in the cookbook? What file?
[2013-03-29 20:26:54 -0400] siezer: dan all files in the attributes directory are loaded by chef-client
[2013-03-29 20:27:50 -0400] siezer: for every recipe in the run_list, an expanded run_list if you're using roles, and for all cookbooks that are dependencies in metadata
[2013-03-29 20:27:52 -0400] dan|el: i'm using chef-solo, but I don't seem to have accss to any attributes in the recipe which were defined in the attributes file
[2013-03-29 20:28:14 -0400] siezer: use "depends othercookbook"
[2013-03-29 20:28:28 -0400] dan|el: well, the problem is. I have a recipe called "user"
[2013-03-29 20:28:31 -0400] siezer: cookbookA/metadata.rb : "depends cookbookB"
[2013-03-29 20:28:54 -0400] dan|el: recipe/default.rb.   I'm using node.default.user.name in default.rb
[2013-03-29 20:29:13 -0400] dan|el: I'm setting that in attributes.default.rb  as node.default.user.name = 'username'
[2013-03-29 20:29:21 -0400] dan|el: but in default.rb it is not set
[2013-03-29 20:30:32 -0400] siezer: first off
[2013-03-29 20:30:54 -0400] siezer: cookbookA/attributes/default.rb
[2013-03-29 20:30:58 -0400] siezer: should contain
[2013-03-29 20:31:41 -0400] siezer: default['cookbookA']['user']['name'] = "username"
[2013-03-29 20:31:50 -0400] siezer: or even better
[2013-03-29 20:32:07 -0400] dan|el: well, this is what I have default['user']['name'] = 'app'
[2013-03-29 20:32:08 -0400] siezer: default['cookbookA']['recipename']['user']['name']
[2013-03-29 20:32:13 -0400] siezer: purely as a convention
[2013-03-29 20:32:27 -0400] dan|el: where user is the cookbook name
[2013-03-29 20:33:13 -0400] siezer: the node object is build up by chef-client when it "synchronizes" all the cookbooks
[2013-03-29 20:33:20 -0400] siezer: and loads the attributes files
[2013-03-29 20:33:38 -0400] siezer: so attributes loaded from cookbookA will definitely be available to any recipes in cookbookB
[2013-03-29 20:34:18 -0400] dan|el: so I figured it out
[2013-03-29 20:34:46 -0400] dan|el: user was not in the run list. I was compiling nginx, and it had an include_recipe
[2013-03-29 20:34:58 -0400] dan|el: but the attributes didn't get loaded
[2013-03-29 20:35:05 -0400] siezer: using default['cookbook-name']['key']['subkey']['subkey'] = "value" is a convention to keep namespacing sane
[2013-03-29 20:35:05 -0400] dan|el: and I only had nginx in the runlist
[2013-03-29 20:35:12 -0400] siezer: aha
[2013-03-29 20:35:34 -0400] siezer: does your nginx cookbook "depend 'user'" in its metadata?
[2013-03-29 20:35:49 -0400] dan|el: yes. and this worked in an earlier version of chef-solo I was using
[2013-03-29 20:35:58 -0400] dan|el: I upgraded to the latst version, and it stopped working
[2013-03-29 20:36:05 -0400] dan|el: so I was confused
[2013-03-29 20:36:11 -0400] siezer: weird. that's a bug
[2013-03-29 20:36:29 -0400] siezer: what version of chef?
[2013-03-29 20:36:46 -0400] dan|el: I don't have depend 'user' in the metdata, but I do have include_recipe 'user' in the nginx recipe
[2013-03-29 20:36:52 -0400] dan|el: 11.4.0
[2013-03-29 20:36:56 -0400] siezer: ah. yea you need the metadata
[2013-03-29 20:37:22 -0400] dan|el: so I should do depend 'user' in the nginx metadata file?
[2013-03-29 20:37:28 -0400] siezer: yep
[2013-03-29 20:37:33 -0400] dan|el: ok, great. thanks
[2013-03-29 20:37:44 -0400] dan|el: is the other behavior a bug now, or was it a bug in the previous version?
[2013-03-29 20:38:44 -0400] siezer: include_recipe "cookbookB::recipefoo" should not have worked from recipeA without "depends cookbookB" in its metadata
[2013-03-29 20:39:05 -0400] siezer: nor accessing its attributes
[2013-03-29 20:39:50 -0400] siezer: unless you happened to include it in the run_list, which is a side effect
[2013-03-29 20:40:30 -0400] dan|el: yes, it works great now with depends
[2013-03-29 20:40:31 -0400] mattray: spox: spheromak: about to push the 2.1 branch of spiceweasel as the new release.
[2013-03-29 20:40:35 -0400] dan|el: thank you much :)
[2013-03-29 20:41:46 -0400] dan|el: finding the documentation kind of confusing
[2013-03-29 20:50:05 -0400] spheromak: mattray: great news
[2013-03-29 20:50:09 -0400] dan|el: since i'm using depends now, do I need to use include_recipe across cookbooks now?
[2013-03-29 20:50:18 -0400] spheromak: kisoku_: you round ?
[2013-03-29 20:52:19 -0400] spox: mattray: \o/
[2013-03-29 20:52:36 -0400] mattray: spox: I added one new bit to the Berkshelf support
[2013-03-29 20:53:02 -0400] siezer: dan|el nope, the depends alone will load all the attributes files, libraries, resources, and providers
[2013-03-29 20:53:12 -0400] mattray: spox: if you just put "berksfile:" in your manifest, it looks for the Berksfile
[2013-03-29 20:53:34 -0400] hatchetation: I think I may not understand chef's permissions correctly -- is it possible for a node to modify its own role memberships?
[2013-03-29 20:53:42 -0400] mattray: so the .rb file could have "berksfile" => nil
[2013-03-29 20:54:48 -0400] spheromak: hatchetation: yes
[2013-03-29 20:55:20 -0400] hatchetation: spheromak: excellent. pointers to documentation or examples?
[2013-03-29 20:55:40 -0400] spox: mattray: i had thought that was already there with a 'true' value, but it looks like that's not the case
[2013-03-29 20:56:03 -0400] hatchetation: essentialy, I'm trying to use something like this (https://gist.github.com/jtimberman/883522) -- but want to remove a role that installs a deprecated package. so, the role would be modified to use the removal recipe, then remove the role when done
[2013-03-29 20:56:04 -0400] spox: mattray: this is super awesome. :D
[2013-03-29 20:56:05 -0400] mattray: spox: that works for the .rb files, but unnecessary for yaml or jsaon
[2013-03-29 20:56:11 -0400] siezer: hatchetation a node can modify its own node object including its run_list. "role membership" has no meaning
[2013-03-29 20:56:22 -0400] spheromak: hatchetation: you should be able to set the node.run_list
[2013-03-29 20:57:21 -0400] hatchetation: yeah, I tried that using the example in that gist, but it doesn't seem to persist to the server. eg, next run, that same role is still there
[2013-03-29 20:58:02 -0400] dan|el: siezer: thanks ;)
[2013-03-29 20:59:08 -0400] radamant: Hello humans, I know this has been asked many times before as I've seen it in google results, but we are getting "no such file to load 'mysql'" errors with this recipe: https://gist.github.com/5273611
[2013-03-29 20:59:20 -0400] hatchetation: good to know it's possible though, I'll try and hunt down what's going on.
[2013-03-29 20:59:21 -0400] radamant: Looks like our server has the 'mysql' gem installed
[2013-03-29 21:00:19 -0400] radamant: The error happens in line #3 in the above gist
[2013-03-29 21:04:43 -0400] spheromak: It's prob too early to enforce a change thats chef11 only on a public cook eh ?
[2013-03-29 21:04:50 -0400] spheromak: really want to use partials in this jenkins patch
[2013-03-29 21:06:34 -0400] a13x212: the chef bookshelf seems to use the server shortname, how would i make it use the fqdn?
[2013-03-29 21:06:41 -0400] siezer: partial_search all the things!
[2013-03-29 21:07:17 -0400] siezer: a13x212 set your server's hostname to its FQDN like god intended
[2013-03-29 21:07:20 -0400] spheromak: siezer: partial templates :D
[2013-03-29 21:07:24 -0400] siezer: that too
[2013-03-29 21:07:36 -0400] spheromak: gonna do it anyhow since im chef11 :P
[2013-03-29 21:07:44 -0400] spheromak: and someone else can make it backwards compat
[2013-03-29 21:07:48 -0400] spheromak: if they ned it
[2013-03-29 21:15:55 -0400] a13x212: siezer, i did but now i can't figure out what config file needs to changed
[2013-03-29 21:17:47 -0400] siezer: try chef-server-ctl reconfigure
[2013-03-29 21:23:33 -0400] a13x212: no go, keeps trying to use shortname
[2013-03-29 21:24:43 -0400] spheromak: a13x212: https://gist.github.com/spheromak/5017833
[2013-03-29 21:24:58 -0400] spheromak: this should go on wiki someplace :D
[2013-03-29 21:25:12 -0400] spheromak: i.e. how to force names on chef-server11
[2013-03-29 21:29:15 -0400] siezer: we should make a docs project in jira
[2013-03-29 21:29:27 -0400] siezer: so you guys can write down these suggestions in a trackable format =)
[2013-03-29 21:42:19 -0400] a13x212: my install seems to run from chef-server-running.json, i don't have a chef-server.rb
[2013-03-29 21:42:59 -0400] a13x212: and i changed all those options to fqdn and restarted all chef services
[2013-03-29 21:44:09 -0400] a13x212: still no luck
[2013-03-29 21:55:35 -0400] spheromak: a13x212: make it
[2013-03-29 21:55:54 -0400] spheromak: make the chef-server.rb with those values then run chef-serverctl reconfigure
[2013-03-29 21:56:08 -0400] spheromak: *chef-server-ctl
[2013-03-29 22:03:24 -0400] a13x212: ding! ding! that worked
[2013-03-29 22:03:29 -0400] a13x212: thanks
